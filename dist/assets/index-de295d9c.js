var nie=Object.defineProperty;var aie=(e,t,r)=>t in e?nie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var lo=(e,t,r)=>(aie(e,typeof t!="symbol"?t+"":t,r),r);function oie(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const o in n)if(o!=="default"&&!(o in e)){const s=Object.getOwnPropertyDescriptor(n,o);s&&Object.defineProperty(e,o,s.get?s:{enumerable:!0,get:()=>n[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();var Gi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ga(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function sie(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var iV={exports:{}},TS={},lV={exports:{}},Da={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zw=Symbol.for("react.element"),iie=Symbol.for("react.portal"),lie=Symbol.for("react.fragment"),cie=Symbol.for("react.strict_mode"),die=Symbol.for("react.profiler"),uie=Symbol.for("react.provider"),fie=Symbol.for("react.context"),mie=Symbol.for("react.forward_ref"),hie=Symbol.for("react.suspense"),pie=Symbol.for("react.memo"),gie=Symbol.for("react.lazy"),cL=Symbol.iterator;function vie(e){return e===null||typeof e!="object"?null:(e=cL&&e[cL]||e["@@iterator"],typeof e=="function"?e:null)}var cV={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dV=Object.assign,uV={};function r0(e,t,r){this.props=e,this.context=t,this.refs=uV,this.updater=r||cV}r0.prototype.isReactComponent={};r0.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};r0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function fV(){}fV.prototype=r0.prototype;function o3(e,t,r){this.props=e,this.context=t,this.refs=uV,this.updater=r||cV}var s3=o3.prototype=new fV;s3.constructor=o3;dV(s3,r0.prototype);s3.isPureReactComponent=!0;var dL=Array.isArray,mV=Object.prototype.hasOwnProperty,i3={current:null},hV={key:!0,ref:!0,__self:!0,__source:!0};function pV(e,t,r){var n,o={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)mV.call(t,n)&&!hV.hasOwnProperty(n)&&(o[n]=t[n]);var l=arguments.length-2;if(l===1)o.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];o.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)o[n]===void 0&&(o[n]=l[n]);return{$$typeof:Zw,type:e,key:s,ref:i,props:o,_owner:i3.current}}function xie(e,t){return{$$typeof:Zw,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function l3(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zw}function yie(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var uL=/\/+/g;function mP(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yie(""+e.key):t.toString(36)}function Sj(e,t,r,n,o){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Zw:case iie:i=!0}}if(i)return i=e,o=o(i),e=n===""?"."+mP(i,0):n,dL(o)?(r="",e!=null&&(r=e.replace(uL,"$&/")+"/"),Sj(o,t,r,"",function(d){return d})):o!=null&&(l3(o)&&(o=xie(o,r+(!o.key||i&&i.key===o.key?"":(""+o.key).replace(uL,"$&/")+"/")+e)),t.push(o)),1;if(i=0,n=n===""?".":n+":",dL(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+mP(s,l);i+=Sj(s,t,r,c,o)}else if(c=vie(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+mP(s,l++),i+=Sj(s,t,r,c,o);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function o2(e,t,r){if(e==null)return e;var n=[],o=0;return Sj(e,n,"","",function(s){return t.call(r,s,o++)}),n}function bie(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var wl={current:null},Cj={transition:null},wie={ReactCurrentDispatcher:wl,ReactCurrentBatchConfig:Cj,ReactCurrentOwner:i3};function gV(){throw Error("act(...) is not supported in production builds of React.")}Da.Children={map:o2,forEach:function(e,t,r){o2(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return o2(e,function(){t++}),t},toArray:function(e){return o2(e,function(t){return t})||[]},only:function(e){if(!l3(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Da.Component=r0;Da.Fragment=lie;Da.Profiler=die;Da.PureComponent=o3;Da.StrictMode=cie;Da.Suspense=hie;Da.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wie;Da.act=gV;Da.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=dV({},e.props),o=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=i3.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)mV.call(t,c)&&!hV.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:Zw,type:e.type,key:o,ref:s,props:n,_owner:i}};Da.createContext=function(e){return e={$$typeof:fie,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:uie,_context:e},e.Consumer=e};Da.createElement=pV;Da.createFactory=function(e){var t=pV.bind(null,e);return t.type=e,t};Da.createRef=function(){return{current:null}};Da.forwardRef=function(e){return{$$typeof:mie,render:e}};Da.isValidElement=l3;Da.lazy=function(e){return{$$typeof:gie,_payload:{_status:-1,_result:e},_init:bie}};Da.memo=function(e,t){return{$$typeof:pie,type:e,compare:t===void 0?null:t}};Da.startTransition=function(e){var t=Cj.transition;Cj.transition={};try{e()}finally{Cj.transition=t}};Da.unstable_act=gV;Da.useCallback=function(e,t){return wl.current.useCallback(e,t)};Da.useContext=function(e){return wl.current.useContext(e)};Da.useDebugValue=function(){};Da.useDeferredValue=function(e){return wl.current.useDeferredValue(e)};Da.useEffect=function(e,t){return wl.current.useEffect(e,t)};Da.useId=function(){return wl.current.useId()};Da.useImperativeHandle=function(e,t,r){return wl.current.useImperativeHandle(e,t,r)};Da.useInsertionEffect=function(e,t){return wl.current.useInsertionEffect(e,t)};Da.useLayoutEffect=function(e,t){return wl.current.useLayoutEffect(e,t)};Da.useMemo=function(e,t){return wl.current.useMemo(e,t)};Da.useReducer=function(e,t,r){return wl.current.useReducer(e,t,r)};Da.useRef=function(e){return wl.current.useRef(e)};Da.useState=function(e){return wl.current.useState(e)};Da.useSyncExternalStore=function(e,t,r){return wl.current.useSyncExternalStore(e,t,r)};Da.useTransition=function(){return wl.current.useTransition()};Da.version="18.3.1";lV.exports=Da;var p=lV.exports;const _e=Ga(p),c3=oie({__proto__:null,default:_e},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jie=p,_ie=Symbol.for("react.element"),Nie=Symbol.for("react.fragment"),Sie=Object.prototype.hasOwnProperty,Cie=jie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Pie={key:!0,ref:!0,__self:!0,__source:!0};function vV(e,t,r){var n,o={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)Sie.call(t,n)&&!Pie.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:_ie,type:e,key:s,ref:i,props:o,_owner:Cie.current}}TS.Fragment=Nie;TS.jsx=vV;TS.jsxs=vV;iV.exports=TS;var a=iV.exports,ek={},xV={exports:{}},Fc={},yV={exports:{}},bV={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(q,Q){var pe=q.length;q.push(Q);e:for(;0<pe;){var be=pe-1>>>1,V=q[be];if(0<o(V,Q))q[be]=Q,q[pe]=V,pe=be;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var Q=q[0],pe=q.pop();if(pe!==Q){q[0]=pe;e:for(var be=0,V=q.length,B=V>>>1;be<B;){var J=2*(be+1)-1,ue=q[J],Ne=J+1,Z=q[Ne];if(0>o(ue,pe))Ne<V&&0>o(Z,ue)?(q[be]=Z,q[Ne]=pe,be=Ne):(q[be]=ue,q[J]=pe,be=J);else if(Ne<V&&0>o(Z,pe))q[be]=Z,q[Ne]=pe,be=Ne;else break e}}return Q}function o(q,Q){var pe=q.sortIndex-Q.sortIndex;return pe!==0?pe:q.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,f=null,h=3,m=!1,v=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(q){for(var Q=r(d);Q!==null;){if(Q.callback===null)n(d);else if(Q.startTime<=q)n(d),Q.sortIndex=Q.expirationTime,t(c,Q);else break;Q=r(d)}}function j(q){if(g=!1,w(q),!v)if(r(c)!==null)v=!0,z(_);else{var Q=r(d);Q!==null&&H(j,Q.startTime-q)}}function _(q,Q){v=!1,g&&(g=!1,x(A),A=-1),m=!0;var pe=h;try{for(w(Q),f=r(c);f!==null&&(!(f.expirationTime>Q)||q&&!M());){var be=f.callback;if(typeof be=="function"){f.callback=null,h=f.priorityLevel;var V=be(f.expirationTime<=Q);Q=e.unstable_now(),typeof V=="function"?f.callback=V:f===r(c)&&n(c),w(Q)}else n(c);f=r(c)}if(f!==null)var B=!0;else{var J=r(d);J!==null&&H(j,J.startTime-Q),B=!1}return B}finally{f=null,h=pe,m=!1}}var C=!1,E=null,A=-1,P=5,F=-1;function M(){return!(e.unstable_now()-F<P)}function I(){if(E!==null){var q=e.unstable_now();F=q;var Q=!0;try{Q=E(!0,q)}finally{Q?R():(C=!1,E=null)}}else C=!1}var R;if(typeof b=="function")R=function(){b(I)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,U=D.port2;D.port1.onmessage=I,R=function(){U.postMessage(null)}}else R=function(){y(I,0)};function z(q){E=q,C||(C=!0,R())}function H(q,Q){A=y(function(){q(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,z(_))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(q){switch(h){case 1:case 2:case 3:var Q=3;break;default:Q=h}var pe=h;h=Q;try{return q()}finally{h=pe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,Q){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var pe=h;h=q;try{return Q()}finally{h=pe}},e.unstable_scheduleCallback=function(q,Q,pe){var be=e.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?be+pe:be):pe=be,q){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=pe+V,q={id:u++,callback:Q,priorityLevel:q,startTime:pe,expirationTime:V,sortIndex:-1},pe>be?(q.sortIndex=pe,t(d,q),r(c)===null&&q===r(d)&&(g?(x(A),A=-1):g=!0,H(j,pe-be))):(q.sortIndex=V,t(c,q),v||m||(v=!0,z(_))),q},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(q){var Q=h;return function(){var pe=h;h=Q;try{return q.apply(this,arguments)}finally{h=pe}}}})(bV);yV.exports=bV;var Aie=yV.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eie=p,Rc=Aie;function tn(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wV=new Set,wb={};function vg(e,t){lx(e,t),lx(e+"Capture",t)}function lx(e,t){for(wb[e]=t,e=0;e<t.length;e++)wV.add(t[e])}var Lf=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tk=Object.prototype.hasOwnProperty,kie=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fL={},mL={};function Iie(e){return tk.call(mL,e)?!0:tk.call(fL,e)?!1:kie.test(e)?mL[e]=!0:(fL[e]=!0,!1)}function Oie(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Tie(e,t,r,n){if(t===null||typeof t>"u"||Oie(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function jl(e,t,r,n,o,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var ki={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ki[e]=new jl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ki[t]=new jl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ki[e]=new jl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ki[e]=new jl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ki[e]=new jl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ki[e]=new jl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ki[e]=new jl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ki[e]=new jl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ki[e]=new jl(e,5,!1,e.toLowerCase(),null,!1,!1)});var d3=/[\-:]([a-z])/g;function u3(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(d3,u3);ki[t]=new jl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(d3,u3);ki[t]=new jl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(d3,u3);ki[t]=new jl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ki[e]=new jl(e,1,!1,e.toLowerCase(),null,!1,!1)});ki.xlinkHref=new jl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ki[e]=new jl(e,1,!1,e.toLowerCase(),null,!0,!0)});function f3(e,t,r,n){var o=ki.hasOwnProperty(t)?ki[t]:null;(o!==null?o.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Tie(t,r,o,n)&&(r=null),n||o===null?Iie(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=r===null?o.type===3?!1:"":r:(t=o.attributeName,n=o.attributeNamespace,r===null?e.removeAttribute(t):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Jf=Eie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,s2=Symbol.for("react.element"),vv=Symbol.for("react.portal"),xv=Symbol.for("react.fragment"),m3=Symbol.for("react.strict_mode"),rk=Symbol.for("react.profiler"),jV=Symbol.for("react.provider"),_V=Symbol.for("react.context"),h3=Symbol.for("react.forward_ref"),nk=Symbol.for("react.suspense"),ak=Symbol.for("react.suspense_list"),p3=Symbol.for("react.memo"),Cm=Symbol.for("react.lazy"),NV=Symbol.for("react.offscreen"),hL=Symbol.iterator;function z0(e){return e===null||typeof e!="object"?null:(e=hL&&e[hL]||e["@@iterator"],typeof e=="function"?e:null)}var os=Object.assign,hP;function wy(e){if(hP===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);hP=t&&t[1]||""}return`
`+hP+e}var pP=!1;function gP(e,t){if(!e||pP)return"";pP=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var o=d.stack.split(`
`),s=n.stack.split(`
`),i=o.length-1,l=s.length-1;1<=i&&0<=l&&o[i]!==s[l];)l--;for(;1<=i&&0<=l;i--,l--)if(o[i]!==s[l]){if(i!==1||l!==1)do if(i--,l--,0>l||o[i]!==s[l]){var c=`
`+o[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{pP=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?wy(e):""}function Die(e){switch(e.tag){case 5:return wy(e.type);case 16:return wy("Lazy");case 13:return wy("Suspense");case 19:return wy("SuspenseList");case 0:case 2:case 15:return e=gP(e.type,!1),e;case 11:return e=gP(e.type.render,!1),e;case 1:return e=gP(e.type,!0),e;default:return""}}function ok(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xv:return"Fragment";case vv:return"Portal";case rk:return"Profiler";case m3:return"StrictMode";case nk:return"Suspense";case ak:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case _V:return(e.displayName||"Context")+".Consumer";case jV:return(e._context.displayName||"Context")+".Provider";case h3:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case p3:return t=e.displayName||null,t!==null?t:ok(e.type)||"Memo";case Cm:t=e._payload,e=e._init;try{return ok(e(t))}catch{}}return null}function Mie(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ok(t);case 8:return t===m3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function yh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function SV(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Rie(e){var t=SV(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function i2(e){e._valueTracker||(e._valueTracker=Rie(e))}function CV(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=SV(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function a_(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sk(e,t){var r=t.checked;return os({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function pL(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=yh(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function PV(e,t){t=t.checked,t!=null&&f3(e,"checked",t,!1)}function ik(e,t){PV(e,t);var r=yh(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?lk(e,t.type,r):t.hasOwnProperty("defaultValue")&&lk(e,t.type,yh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function gL(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function lk(e,t,r){(t!=="number"||a_(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var jy=Array.isArray;function qv(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(r=""+yh(r),t=null,o=0;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,n&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function ck(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(tn(91));return os({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function vL(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(tn(92));if(jy(r)){if(1<r.length)throw Error(tn(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:yh(r)}}function AV(e,t){var r=yh(t.value),n=yh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function xL(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function EV(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dk(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?EV(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var l2,kV=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(l2=l2||document.createElement("div"),l2.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=l2.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function jb(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Oy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Lie=["Webkit","ms","Moz","O"];Object.keys(Oy).forEach(function(e){Lie.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Oy[t]=Oy[e]})});function IV(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Oy.hasOwnProperty(e)&&Oy[e]?(""+t).trim():t+"px"}function OV(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,o=IV(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}var Fie=os({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uk(e,t){if(t){if(Fie[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(tn(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(tn(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(tn(61))}if(t.style!=null&&typeof t.style!="object")throw Error(tn(62))}}function fk(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mk=null;function g3(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hk=null,zv=null,Uv=null;function yL(e){if(e=r1(e)){if(typeof hk!="function")throw Error(tn(280));var t=e.stateNode;t&&(t=FS(t),hk(e.stateNode,e.type,t))}}function TV(e){zv?Uv?Uv.push(e):Uv=[e]:zv=e}function DV(){if(zv){var e=zv,t=Uv;if(Uv=zv=null,yL(e),t)for(e=0;e<t.length;e++)yL(t[e])}}function MV(e,t){return e(t)}function RV(){}var vP=!1;function LV(e,t,r){if(vP)return e(t,r);vP=!0;try{return MV(e,t,r)}finally{vP=!1,(zv!==null||Uv!==null)&&(RV(),DV())}}function _b(e,t){var r=e.stateNode;if(r===null)return null;var n=FS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(tn(231,t,typeof r));return r}var pk=!1;if(Lf)try{var U0={};Object.defineProperty(U0,"passive",{get:function(){pk=!0}}),window.addEventListener("test",U0,U0),window.removeEventListener("test",U0,U0)}catch{pk=!1}function $ie(e,t,r,n,o,s,i,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var Ty=!1,o_=null,s_=!1,gk=null,Bie={onError:function(e){Ty=!0,o_=e}};function qie(e,t,r,n,o,s,i,l,c){Ty=!1,o_=null,$ie.apply(Bie,arguments)}function zie(e,t,r,n,o,s,i,l,c){if(qie.apply(this,arguments),Ty){if(Ty){var d=o_;Ty=!1,o_=null}else throw Error(tn(198));s_||(s_=!0,gk=d)}}function xg(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function FV(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bL(e){if(xg(e)!==e)throw Error(tn(188))}function Uie(e){var t=e.alternate;if(!t){if(t=xg(e),t===null)throw Error(tn(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(o===null)break;var s=o.alternate;if(s===null){if(n=o.return,n!==null){r=n;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===r)return bL(o),e;if(s===n)return bL(o),t;s=s.sibling}throw Error(tn(188))}if(r.return!==n.return)r=o,n=s;else{for(var i=!1,l=o.child;l;){if(l===r){i=!0,r=o,n=s;break}if(l===n){i=!0,n=o,r=s;break}l=l.sibling}if(!i){for(l=s.child;l;){if(l===r){i=!0,r=s,n=o;break}if(l===n){i=!0,n=s,r=o;break}l=l.sibling}if(!i)throw Error(tn(189))}}if(r.alternate!==n)throw Error(tn(190))}if(r.tag!==3)throw Error(tn(188));return r.stateNode.current===r?e:t}function $V(e){return e=Uie(e),e!==null?BV(e):null}function BV(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=BV(e);if(t!==null)return t;e=e.sibling}return null}var qV=Rc.unstable_scheduleCallback,wL=Rc.unstable_cancelCallback,Vie=Rc.unstable_shouldYield,Wie=Rc.unstable_requestPaint,ys=Rc.unstable_now,Hie=Rc.unstable_getCurrentPriorityLevel,v3=Rc.unstable_ImmediatePriority,zV=Rc.unstable_UserBlockingPriority,i_=Rc.unstable_NormalPriority,Gie=Rc.unstable_LowPriority,UV=Rc.unstable_IdlePriority,DS=null,Fu=null;function Kie(e){if(Fu&&typeof Fu.onCommitFiberRoot=="function")try{Fu.onCommitFiberRoot(DS,e,void 0,(e.current.flags&128)===128)}catch{}}var tu=Math.clz32?Math.clz32:Jie,Xie=Math.log,Yie=Math.LN2;function Jie(e){return e>>>=0,e===0?32:31-(Xie(e)/Yie|0)|0}var c2=64,d2=4194304;function _y(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function l_(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,o=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var l=i&~o;l!==0?n=_y(l):(s&=i,s!==0&&(n=_y(s)))}else i=r&~o,i!==0?n=_y(i):s!==0&&(n=_y(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&o)&&(o=n&-n,s=t&-t,o>=s||o===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-tu(t),o=1<<r,n|=e[r],t&=~o;return n}function Qie(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zie(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-tu(s),l=1<<i,c=o[i];c===-1?(!(l&r)||l&n)&&(o[i]=Qie(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function vk(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function VV(){var e=c2;return c2<<=1,!(c2&4194240)&&(c2=64),e}function xP(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function e1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-tu(t),e[t]=r}function ele(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-tu(r),s=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~s}}function x3(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-tu(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var fo=0;function WV(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var HV,y3,GV,KV,XV,xk=!1,u2=[],Ym=null,Jm=null,Qm=null,Nb=new Map,Sb=new Map,Im=[],tle="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jL(e,t){switch(e){case"focusin":case"focusout":Ym=null;break;case"dragenter":case"dragleave":Jm=null;break;case"mouseover":case"mouseout":Qm=null;break;case"pointerover":case"pointerout":Nb.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sb.delete(t.pointerId)}}function V0(e,t,r,n,o,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[o]},t!==null&&(t=r1(t),t!==null&&y3(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function rle(e,t,r,n,o){switch(t){case"focusin":return Ym=V0(Ym,e,t,r,n,o),!0;case"dragenter":return Jm=V0(Jm,e,t,r,n,o),!0;case"mouseover":return Qm=V0(Qm,e,t,r,n,o),!0;case"pointerover":var s=o.pointerId;return Nb.set(s,V0(Nb.get(s)||null,e,t,r,n,o)),!0;case"gotpointercapture":return s=o.pointerId,Sb.set(s,V0(Sb.get(s)||null,e,t,r,n,o)),!0}return!1}function YV(e){var t=vp(e.target);if(t!==null){var r=xg(t);if(r!==null){if(t=r.tag,t===13){if(t=FV(r),t!==null){e.blockedOn=t,XV(e.priority,function(){GV(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Pj(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=yk(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);mk=n,r.target.dispatchEvent(n),mk=null}else return t=r1(r),t!==null&&y3(t),e.blockedOn=r,!1;t.shift()}return!0}function _L(e,t,r){Pj(e)&&r.delete(t)}function nle(){xk=!1,Ym!==null&&Pj(Ym)&&(Ym=null),Jm!==null&&Pj(Jm)&&(Jm=null),Qm!==null&&Pj(Qm)&&(Qm=null),Nb.forEach(_L),Sb.forEach(_L)}function W0(e,t){e.blockedOn===t&&(e.blockedOn=null,xk||(xk=!0,Rc.unstable_scheduleCallback(Rc.unstable_NormalPriority,nle)))}function Cb(e){function t(o){return W0(o,e)}if(0<u2.length){W0(u2[0],e);for(var r=1;r<u2.length;r++){var n=u2[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ym!==null&&W0(Ym,e),Jm!==null&&W0(Jm,e),Qm!==null&&W0(Qm,e),Nb.forEach(t),Sb.forEach(t),r=0;r<Im.length;r++)n=Im[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Im.length&&(r=Im[0],r.blockedOn===null);)YV(r),r.blockedOn===null&&Im.shift()}var Vv=Jf.ReactCurrentBatchConfig,c_=!0;function ale(e,t,r,n){var o=fo,s=Vv.transition;Vv.transition=null;try{fo=1,b3(e,t,r,n)}finally{fo=o,Vv.transition=s}}function ole(e,t,r,n){var o=fo,s=Vv.transition;Vv.transition=null;try{fo=4,b3(e,t,r,n)}finally{fo=o,Vv.transition=s}}function b3(e,t,r,n){if(c_){var o=yk(e,t,r,n);if(o===null)AP(e,t,n,d_,r),jL(e,n);else if(rle(o,e,t,r,n))n.stopPropagation();else if(jL(e,n),t&4&&-1<tle.indexOf(e)){for(;o!==null;){var s=r1(o);if(s!==null&&HV(s),s=yk(e,t,r,n),s===null&&AP(e,t,n,d_,r),s===o)break;o=s}o!==null&&n.stopPropagation()}else AP(e,t,n,null,r)}}var d_=null;function yk(e,t,r,n){if(d_=null,e=g3(n),e=vp(e),e!==null)if(t=xg(e),t===null)e=null;else if(r=t.tag,r===13){if(e=FV(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return d_=e,null}function JV(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hie()){case v3:return 1;case zV:return 4;case i_:case Gie:return 16;case UV:return 536870912;default:return 16}default:return 16}}var Fm=null,w3=null,Aj=null;function QV(){if(Aj)return Aj;var e,t=w3,r=t.length,n,o="value"in Fm?Fm.value:Fm.textContent,s=o.length;for(e=0;e<r&&t[e]===o[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===o[s-n];n++);return Aj=o.slice(e,1<n?1-n:void 0)}function Ej(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function f2(){return!0}function NL(){return!1}function $c(e){function t(r,n,o,s,i){this._reactName=r,this._targetInst=o,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?f2:NL,this.isPropagationStopped=NL,this}return os(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=f2)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=f2)},persist:function(){},isPersistent:f2}),t}var n0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},j3=$c(n0),t1=os({},n0,{view:0,detail:0}),sle=$c(t1),yP,bP,H0,MS=os({},t1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_3,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==H0&&(H0&&e.type==="mousemove"?(yP=e.screenX-H0.screenX,bP=e.screenY-H0.screenY):bP=yP=0,H0=e),yP)},movementY:function(e){return"movementY"in e?e.movementY:bP}}),SL=$c(MS),ile=os({},MS,{dataTransfer:0}),lle=$c(ile),cle=os({},t1,{relatedTarget:0}),wP=$c(cle),dle=os({},n0,{animationName:0,elapsedTime:0,pseudoElement:0}),ule=$c(dle),fle=os({},n0,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),mle=$c(fle),hle=os({},n0,{data:0}),CL=$c(hle),ple={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gle={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vle={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xle(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=vle[e])?!!t[e]:!1}function _3(){return xle}var yle=os({},t1,{key:function(e){if(e.key){var t=ple[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ej(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gle[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_3,charCode:function(e){return e.type==="keypress"?Ej(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ej(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ble=$c(yle),wle=os({},MS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),PL=$c(wle),jle=os({},t1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_3}),_le=$c(jle),Nle=os({},n0,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sle=$c(Nle),Cle=os({},MS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ple=$c(Cle),Ale=[9,13,27,32],N3=Lf&&"CompositionEvent"in window,Dy=null;Lf&&"documentMode"in document&&(Dy=document.documentMode);var Ele=Lf&&"TextEvent"in window&&!Dy,ZV=Lf&&(!N3||Dy&&8<Dy&&11>=Dy),AL=String.fromCharCode(32),EL=!1;function eW(e,t){switch(e){case"keyup":return Ale.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tW(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yv=!1;function kle(e,t){switch(e){case"compositionend":return tW(t);case"keypress":return t.which!==32?null:(EL=!0,AL);case"textInput":return e=t.data,e===AL&&EL?null:e;default:return null}}function Ile(e,t){if(yv)return e==="compositionend"||!N3&&eW(e,t)?(e=QV(),Aj=w3=Fm=null,yv=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ZV&&t.locale!=="ko"?null:t.data;default:return null}}var Ole={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kL(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ole[e.type]:t==="textarea"}function rW(e,t,r,n){TV(n),t=u_(t,"onChange"),0<t.length&&(r=new j3("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var My=null,Pb=null;function Tle(e){mW(e,0)}function RS(e){var t=jv(e);if(CV(t))return e}function Dle(e,t){if(e==="change")return t}var nW=!1;if(Lf){var jP;if(Lf){var _P="oninput"in document;if(!_P){var IL=document.createElement("div");IL.setAttribute("oninput","return;"),_P=typeof IL.oninput=="function"}jP=_P}else jP=!1;nW=jP&&(!document.documentMode||9<document.documentMode)}function OL(){My&&(My.detachEvent("onpropertychange",aW),Pb=My=null)}function aW(e){if(e.propertyName==="value"&&RS(Pb)){var t=[];rW(t,Pb,e,g3(e)),LV(Tle,t)}}function Mle(e,t,r){e==="focusin"?(OL(),My=t,Pb=r,My.attachEvent("onpropertychange",aW)):e==="focusout"&&OL()}function Rle(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return RS(Pb)}function Lle(e,t){if(e==="click")return RS(t)}function Fle(e,t){if(e==="input"||e==="change")return RS(t)}function $le(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var su=typeof Object.is=="function"?Object.is:$le;function Ab(e,t){if(su(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!tk.call(t,o)||!su(e[o],t[o]))return!1}return!0}function TL(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function DL(e,t){var r=TL(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=TL(r)}}function oW(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?oW(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function sW(){for(var e=window,t=a_();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=a_(e.document)}return t}function S3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ble(e){var t=sW(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&oW(r.ownerDocument.documentElement,r)){if(n!==null&&S3(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=r.textContent.length,s=Math.min(n.start,o);n=n.end===void 0?s:Math.min(n.end,o),!e.extend&&s>n&&(o=n,n=s,s=o),o=DL(r,s);var i=DL(r,n);o&&i&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var qle=Lf&&"documentMode"in document&&11>=document.documentMode,bv=null,bk=null,Ry=null,wk=!1;function ML(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;wk||bv==null||bv!==a_(n)||(n=bv,"selectionStart"in n&&S3(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ry&&Ab(Ry,n)||(Ry=n,n=u_(bk,"onSelect"),0<n.length&&(t=new j3("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=bv)))}function m2(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var wv={animationend:m2("Animation","AnimationEnd"),animationiteration:m2("Animation","AnimationIteration"),animationstart:m2("Animation","AnimationStart"),transitionend:m2("Transition","TransitionEnd")},NP={},iW={};Lf&&(iW=document.createElement("div").style,"AnimationEvent"in window||(delete wv.animationend.animation,delete wv.animationiteration.animation,delete wv.animationstart.animation),"TransitionEvent"in window||delete wv.transitionend.transition);function LS(e){if(NP[e])return NP[e];if(!wv[e])return e;var t=wv[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in iW)return NP[e]=t[r];return e}var lW=LS("animationend"),cW=LS("animationiteration"),dW=LS("animationstart"),uW=LS("transitionend"),fW=new Map,RL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kh(e,t){fW.set(e,t),vg(t,[e])}for(var SP=0;SP<RL.length;SP++){var CP=RL[SP],zle=CP.toLowerCase(),Ule=CP[0].toUpperCase()+CP.slice(1);kh(zle,"on"+Ule)}kh(lW,"onAnimationEnd");kh(cW,"onAnimationIteration");kh(dW,"onAnimationStart");kh("dblclick","onDoubleClick");kh("focusin","onFocus");kh("focusout","onBlur");kh(uW,"onTransitionEnd");lx("onMouseEnter",["mouseout","mouseover"]);lx("onMouseLeave",["mouseout","mouseover"]);lx("onPointerEnter",["pointerout","pointerover"]);lx("onPointerLeave",["pointerout","pointerover"]);vg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vg("onBeforeInput",["compositionend","keypress","textInput","paste"]);vg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ny="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vle=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ny));function LL(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,zie(n,t,void 0,e),e.currentTarget=null}function mW(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var l=n[i],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&o.isPropagationStopped())break e;LL(o,l,d),s=c}else for(i=0;i<n.length;i++){if(l=n[i],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&o.isPropagationStopped())break e;LL(o,l,d),s=c}}}if(s_)throw e=gk,s_=!1,gk=null,e}function Bo(e,t){var r=t[Ck];r===void 0&&(r=t[Ck]=new Set);var n=e+"__bubble";r.has(n)||(hW(t,e,2,!1),r.add(n))}function PP(e,t,r){var n=0;t&&(n|=4),hW(r,e,n,t)}var h2="_reactListening"+Math.random().toString(36).slice(2);function Eb(e){if(!e[h2]){e[h2]=!0,wV.forEach(function(r){r!=="selectionchange"&&(Vle.has(r)||PP(r,!1,e),PP(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[h2]||(t[h2]=!0,PP("selectionchange",!1,t))}}function hW(e,t,r,n){switch(JV(t)){case 1:var o=ale;break;case 4:o=ole;break;default:o=b3}r=o.bind(null,t,r,e),o=void 0,!pk||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),n?o!==void 0?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):o!==void 0?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function AP(e,t,r,n,o){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var l=n.stateNode.containerInfo;if(l===o||l.nodeType===8&&l.parentNode===o)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===o||c.nodeType===8&&c.parentNode===o))return;i=i.return}for(;l!==null;){if(i=vp(l),i===null)return;if(c=i.tag,c===5||c===6){n=s=i;continue e}l=l.parentNode}}n=n.return}LV(function(){var d=s,u=g3(r),f=[];e:{var h=fW.get(e);if(h!==void 0){var m=j3,v=e;switch(e){case"keypress":if(Ej(r)===0)break e;case"keydown":case"keyup":m=ble;break;case"focusin":v="focus",m=wP;break;case"focusout":v="blur",m=wP;break;case"beforeblur":case"afterblur":m=wP;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=SL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=lle;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=_le;break;case lW:case cW:case dW:m=ule;break;case uW:m=Sle;break;case"scroll":m=sle;break;case"wheel":m=Ple;break;case"copy":case"cut":case"paste":m=mle;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=PL}var g=(t&4)!==0,y=!g&&e==="scroll",x=g?h!==null?h+"Capture":null:h;g=[];for(var b=d,w;b!==null;){w=b;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,x!==null&&(j=_b(b,x),j!=null&&g.push(kb(b,j,w)))),y)break;b=b.return}0<g.length&&(h=new m(h,v,null,r,u),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==mk&&(v=r.relatedTarget||r.fromElement)&&(vp(v)||v[Ff]))break e;if((m||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=d,v=v?vp(v):null,v!==null&&(y=xg(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=d),m!==v)){if(g=SL,j="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=PL,j="onPointerLeave",x="onPointerEnter",b="pointer"),y=m==null?h:jv(m),w=v==null?h:jv(v),h=new g(j,b+"leave",m,r,u),h.target=y,h.relatedTarget=w,j=null,vp(u)===d&&(g=new g(x,b+"enter",v,r,u),g.target=w,g.relatedTarget=y,j=g),y=j,m&&v)t:{for(g=m,x=v,b=0,w=g;w;w=Rg(w))b++;for(w=0,j=x;j;j=Rg(j))w++;for(;0<b-w;)g=Rg(g),b--;for(;0<w-b;)x=Rg(x),w--;for(;b--;){if(g===x||x!==null&&g===x.alternate)break t;g=Rg(g),x=Rg(x)}g=null}else g=null;m!==null&&FL(f,h,m,g,!1),v!==null&&y!==null&&FL(f,y,v,g,!0)}}e:{if(h=d?jv(d):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var _=Dle;else if(kL(h))if(nW)_=Fle;else{_=Rle;var C=Mle}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=Lle);if(_&&(_=_(e,d))){rW(f,_,r,u);break e}C&&C(e,h,d),e==="focusout"&&(C=h._wrapperState)&&C.controlled&&h.type==="number"&&lk(h,"number",h.value)}switch(C=d?jv(d):window,e){case"focusin":(kL(C)||C.contentEditable==="true")&&(bv=C,bk=d,Ry=null);break;case"focusout":Ry=bk=bv=null;break;case"mousedown":wk=!0;break;case"contextmenu":case"mouseup":case"dragend":wk=!1,ML(f,r,u);break;case"selectionchange":if(qle)break;case"keydown":case"keyup":ML(f,r,u)}var E;if(N3)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else yv?eW(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(ZV&&r.locale!=="ko"&&(yv||A!=="onCompositionStart"?A==="onCompositionEnd"&&yv&&(E=QV()):(Fm=u,w3="value"in Fm?Fm.value:Fm.textContent,yv=!0)),C=u_(d,A),0<C.length&&(A=new CL(A,e,null,r,u),f.push({event:A,listeners:C}),E?A.data=E:(E=tW(r),E!==null&&(A.data=E)))),(E=Ele?kle(e,r):Ile(e,r))&&(d=u_(d,"onBeforeInput"),0<d.length&&(u=new CL("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=E))}mW(f,t)})}function kb(e,t,r){return{instance:e,listener:t,currentTarget:r}}function u_(e,t){for(var r=t+"Capture",n=[];e!==null;){var o=e,s=o.stateNode;o.tag===5&&s!==null&&(o=s,s=_b(e,r),s!=null&&n.unshift(kb(e,s,o)),s=_b(e,t),s!=null&&n.push(kb(e,s,o))),e=e.return}return n}function Rg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function FL(e,t,r,n,o){for(var s=t._reactName,i=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,o?(c=_b(r,s),c!=null&&i.unshift(kb(r,c,l))):o||(c=_b(r,s),c!=null&&i.push(kb(r,c,l)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Wle=/\r\n?/g,Hle=/\u0000|\uFFFD/g;function $L(e){return(typeof e=="string"?e:""+e).replace(Wle,`
`).replace(Hle,"")}function p2(e,t,r){if(t=$L(t),$L(e)!==t&&r)throw Error(tn(425))}function f_(){}var jk=null,_k=null;function Nk(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Sk=typeof setTimeout=="function"?setTimeout:void 0,Gle=typeof clearTimeout=="function"?clearTimeout:void 0,BL=typeof Promise=="function"?Promise:void 0,Kle=typeof queueMicrotask=="function"?queueMicrotask:typeof BL<"u"?function(e){return BL.resolve(null).then(e).catch(Xle)}:Sk;function Xle(e){setTimeout(function(){throw e})}function EP(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(n===0){e.removeChild(o),Cb(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=o}while(r);Cb(t)}function Zm(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qL(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var a0=Math.random().toString(36).slice(2),Pu="__reactFiber$"+a0,Ib="__reactProps$"+a0,Ff="__reactContainer$"+a0,Ck="__reactEvents$"+a0,Yle="__reactListeners$"+a0,Jle="__reactHandles$"+a0;function vp(e){var t=e[Pu];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ff]||r[Pu]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=qL(e);e!==null;){if(r=e[Pu])return r;e=qL(e)}return t}e=r,r=e.parentNode}return null}function r1(e){return e=e[Pu]||e[Ff],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function jv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(tn(33))}function FS(e){return e[Ib]||null}var Pk=[],_v=-1;function Ih(e){return{current:e}}function Vo(e){0>_v||(e.current=Pk[_v],Pk[_v]=null,_v--)}function Oo(e,t){_v++,Pk[_v]=e.current,e.current=t}var bh={},Xi=Ih(bh),Ul=Ih(!1),Gp=bh;function cx(e,t){var r=e.type.contextTypes;if(!r)return bh;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o={},s;for(s in r)o[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Vl(e){return e=e.childContextTypes,e!=null}function m_(){Vo(Ul),Vo(Xi)}function zL(e,t,r){if(Xi.current!==bh)throw Error(tn(168));Oo(Xi,t),Oo(Ul,r)}function pW(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var o in n)if(!(o in t))throw Error(tn(108,Mie(e)||"Unknown",o));return os({},r,n)}function h_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bh,Gp=Xi.current,Oo(Xi,e),Oo(Ul,Ul.current),!0}function UL(e,t,r){var n=e.stateNode;if(!n)throw Error(tn(169));r?(e=pW(e,t,Gp),n.__reactInternalMemoizedMergedChildContext=e,Vo(Ul),Vo(Xi),Oo(Xi,e)):Vo(Ul),Oo(Ul,r)}var bf=null,$S=!1,kP=!1;function gW(e){bf===null?bf=[e]:bf.push(e)}function Qle(e){$S=!0,gW(e)}function Oh(){if(!kP&&bf!==null){kP=!0;var e=0,t=fo;try{var r=bf;for(fo=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}bf=null,$S=!1}catch(o){throw bf!==null&&(bf=bf.slice(e+1)),qV(v3,Oh),o}finally{fo=t,kP=!1}}return null}var Nv=[],Sv=0,p_=null,g_=0,td=[],rd=0,Kp=null,Nf=1,Sf="";function tp(e,t){Nv[Sv++]=g_,Nv[Sv++]=p_,p_=e,g_=t}function vW(e,t,r){td[rd++]=Nf,td[rd++]=Sf,td[rd++]=Kp,Kp=e;var n=Nf;e=Sf;var o=32-tu(n)-1;n&=~(1<<o),r+=1;var s=32-tu(t)+o;if(30<s){var i=o-o%5;s=(n&(1<<i)-1).toString(32),n>>=i,o-=i,Nf=1<<32-tu(t)+o|r<<o|n,Sf=s+e}else Nf=1<<s|r<<o|n,Sf=e}function C3(e){e.return!==null&&(tp(e,1),vW(e,1,0))}function P3(e){for(;e===p_;)p_=Nv[--Sv],Nv[Sv]=null,g_=Nv[--Sv],Nv[Sv]=null;for(;e===Kp;)Kp=td[--rd],td[rd]=null,Sf=td[--rd],td[rd]=null,Nf=td[--rd],td[rd]=null}var Pc=null,wc=null,Ko=!1,Xd=null;function xW(e,t){var r=ud(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function VL(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Pc=e,wc=Zm(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Pc=e,wc=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Kp!==null?{id:Nf,overflow:Sf}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ud(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Pc=e,wc=null,!0):!1;default:return!1}}function Ak(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ek(e){if(Ko){var t=wc;if(t){var r=t;if(!VL(e,t)){if(Ak(e))throw Error(tn(418));t=Zm(r.nextSibling);var n=Pc;t&&VL(e,t)?xW(n,r):(e.flags=e.flags&-4097|2,Ko=!1,Pc=e)}}else{if(Ak(e))throw Error(tn(418));e.flags=e.flags&-4097|2,Ko=!1,Pc=e}}}function WL(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Pc=e}function g2(e){if(e!==Pc)return!1;if(!Ko)return WL(e),Ko=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Nk(e.type,e.memoizedProps)),t&&(t=wc)){if(Ak(e))throw yW(),Error(tn(418));for(;t;)xW(e,t),t=Zm(t.nextSibling)}if(WL(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(tn(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){wc=Zm(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}wc=null}}else wc=Pc?Zm(e.stateNode.nextSibling):null;return!0}function yW(){for(var e=wc;e;)e=Zm(e.nextSibling)}function dx(){wc=Pc=null,Ko=!1}function A3(e){Xd===null?Xd=[e]:Xd.push(e)}var Zle=Jf.ReactCurrentBatchConfig;function G0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(tn(309));var n=r.stateNode}if(!n)throw Error(tn(147,e));var o=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var l=o.refs;i===null?delete l[s]:l[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(tn(284));if(!r._owner)throw Error(tn(290,e))}return e}function v2(e,t){throw e=Object.prototype.toString.call(t),Error(tn(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function HL(e){var t=e._init;return t(e._payload)}function bW(e){function t(x,b){if(e){var w=x.deletions;w===null?(x.deletions=[b],x.flags|=16):w.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function o(x,b){return x=nh(x,b),x.index=0,x.sibling=null,x}function s(x,b,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<b?(x.flags|=2,b):w):(x.flags|=2,b)):(x.flags|=1048576,b)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,b,w,j){return b===null||b.tag!==6?(b=LP(w,x.mode,j),b.return=x,b):(b=o(b,w),b.return=x,b)}function c(x,b,w,j){var _=w.type;return _===xv?u(x,b,w.props.children,j,w.key):b!==null&&(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Cm&&HL(_)===b.type)?(j=o(b,w.props),j.ref=G0(x,b,w),j.return=x,j):(j=Rj(w.type,w.key,w.props,null,x.mode,j),j.ref=G0(x,b,w),j.return=x,j)}function d(x,b,w,j){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=FP(w,x.mode,j),b.return=x,b):(b=o(b,w.children||[]),b.return=x,b)}function u(x,b,w,j,_){return b===null||b.tag!==7?(b=Dp(w,x.mode,j,_),b.return=x,b):(b=o(b,w),b.return=x,b)}function f(x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=LP(""+b,x.mode,w),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case s2:return w=Rj(b.type,b.key,b.props,null,x.mode,w),w.ref=G0(x,null,b),w.return=x,w;case vv:return b=FP(b,x.mode,w),b.return=x,b;case Cm:var j=b._init;return f(x,j(b._payload),w)}if(jy(b)||z0(b))return b=Dp(b,x.mode,w,null),b.return=x,b;v2(x,b)}return null}function h(x,b,w,j){var _=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:l(x,b,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case s2:return w.key===_?c(x,b,w,j):null;case vv:return w.key===_?d(x,b,w,j):null;case Cm:return _=w._init,h(x,b,_(w._payload),j)}if(jy(w)||z0(w))return _!==null?null:u(x,b,w,j,null);v2(x,w)}return null}function m(x,b,w,j,_){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(w)||null,l(b,x,""+j,_);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case s2:return x=x.get(j.key===null?w:j.key)||null,c(b,x,j,_);case vv:return x=x.get(j.key===null?w:j.key)||null,d(b,x,j,_);case Cm:var C=j._init;return m(x,b,w,C(j._payload),_)}if(jy(j)||z0(j))return x=x.get(w)||null,u(b,x,j,_,null);v2(b,j)}return null}function v(x,b,w,j){for(var _=null,C=null,E=b,A=b=0,P=null;E!==null&&A<w.length;A++){E.index>A?(P=E,E=null):P=E.sibling;var F=h(x,E,w[A],j);if(F===null){E===null&&(E=P);break}e&&E&&F.alternate===null&&t(x,E),b=s(F,b,A),C===null?_=F:C.sibling=F,C=F,E=P}if(A===w.length)return r(x,E),Ko&&tp(x,A),_;if(E===null){for(;A<w.length;A++)E=f(x,w[A],j),E!==null&&(b=s(E,b,A),C===null?_=E:C.sibling=E,C=E);return Ko&&tp(x,A),_}for(E=n(x,E);A<w.length;A++)P=m(E,x,A,w[A],j),P!==null&&(e&&P.alternate!==null&&E.delete(P.key===null?A:P.key),b=s(P,b,A),C===null?_=P:C.sibling=P,C=P);return e&&E.forEach(function(M){return t(x,M)}),Ko&&tp(x,A),_}function g(x,b,w,j){var _=z0(w);if(typeof _!="function")throw Error(tn(150));if(w=_.call(w),w==null)throw Error(tn(151));for(var C=_=null,E=b,A=b=0,P=null,F=w.next();E!==null&&!F.done;A++,F=w.next()){E.index>A?(P=E,E=null):P=E.sibling;var M=h(x,E,F.value,j);if(M===null){E===null&&(E=P);break}e&&E&&M.alternate===null&&t(x,E),b=s(M,b,A),C===null?_=M:C.sibling=M,C=M,E=P}if(F.done)return r(x,E),Ko&&tp(x,A),_;if(E===null){for(;!F.done;A++,F=w.next())F=f(x,F.value,j),F!==null&&(b=s(F,b,A),C===null?_=F:C.sibling=F,C=F);return Ko&&tp(x,A),_}for(E=n(x,E);!F.done;A++,F=w.next())F=m(E,x,A,F.value,j),F!==null&&(e&&F.alternate!==null&&E.delete(F.key===null?A:F.key),b=s(F,b,A),C===null?_=F:C.sibling=F,C=F);return e&&E.forEach(function(I){return t(x,I)}),Ko&&tp(x,A),_}function y(x,b,w,j){if(typeof w=="object"&&w!==null&&w.type===xv&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case s2:e:{for(var _=w.key,C=b;C!==null;){if(C.key===_){if(_=w.type,_===xv){if(C.tag===7){r(x,C.sibling),b=o(C,w.props.children),b.return=x,x=b;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Cm&&HL(_)===C.type){r(x,C.sibling),b=o(C,w.props),b.ref=G0(x,C,w),b.return=x,x=b;break e}r(x,C);break}else t(x,C);C=C.sibling}w.type===xv?(b=Dp(w.props.children,x.mode,j,w.key),b.return=x,x=b):(j=Rj(w.type,w.key,w.props,null,x.mode,j),j.ref=G0(x,b,w),j.return=x,x=j)}return i(x);case vv:e:{for(C=w.key;b!==null;){if(b.key===C)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(x,b.sibling),b=o(b,w.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=FP(w,x.mode,j),b.return=x,x=b}return i(x);case Cm:return C=w._init,y(x,b,C(w._payload),j)}if(jy(w))return v(x,b,w,j);if(z0(w))return g(x,b,w,j);v2(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(x,b.sibling),b=o(b,w),b.return=x,x=b):(r(x,b),b=LP(w,x.mode,j),b.return=x,x=b),i(x)):r(x,b)}return y}var ux=bW(!0),wW=bW(!1),v_=Ih(null),x_=null,Cv=null,E3=null;function k3(){E3=Cv=x_=null}function I3(e){var t=v_.current;Vo(v_),e._currentValue=t}function kk(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Wv(e,t){x_=e,E3=Cv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&($l=!0),e.firstContext=null)}function wd(e){var t=e._currentValue;if(E3!==e)if(e={context:e,memoizedValue:t,next:null},Cv===null){if(x_===null)throw Error(tn(308));Cv=e,x_.dependencies={lanes:0,firstContext:e}}else Cv=Cv.next=e;return t}var xp=null;function O3(e){xp===null?xp=[e]:xp.push(e)}function jW(e,t,r,n){var o=t.interleaved;return o===null?(r.next=r,O3(t)):(r.next=o.next,o.next=r),t.interleaved=r,$f(e,n)}function $f(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Pm=!1;function T3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _W(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function If(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function eh(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ya&2){var o=n.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),n.pending=t,$f(e,r)}return o=n.interleaved,o===null?(t.next=t,O3(n)):(t.next=o.next,o.next=t),n.interleaved=t,$f(e,r)}function kj(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,x3(e,r)}}function GL(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var o=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?o=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?o=s=t:s=s.next=t}else o=s=t;r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function y_(e,t,r,n){var o=e.updateQueue;Pm=!1;var s=o.firstBaseUpdate,i=o.lastBaseUpdate,l=o.shared.pending;if(l!==null){o.shared.pending=null;var c=l,d=c.next;c.next=null,i===null?s=d:i.next=d,i=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==i&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var f=o.baseState;i=0,u=d=c=null,l=s;do{var h=l.lane,m=l.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(h=t,m=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){f=v.call(m,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,h=typeof v=="function"?v.call(m,f,h):v,h==null)break e;f=os({},f,h);break e;case 2:Pm=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=o.effects,h===null?o.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=m,c=f):u=u.next=m,i|=h;if(l=l.next,l===null){if(l=o.shared.pending,l===null)break;h=l,l=h.next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}while(1);if(u===null&&(c=f),o.baseState=c,o.firstBaseUpdate=d,o.lastBaseUpdate=u,t=o.shared.interleaved,t!==null){o=t;do i|=o.lane,o=o.next;while(o!==t)}else s===null&&(o.shared.lanes=0);Yp|=i,e.lanes=i,e.memoizedState=f}}function KL(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(o!==null){if(n.callback=null,n=r,typeof o!="function")throw Error(tn(191,o));o.call(n)}}}var n1={},$u=Ih(n1),Ob=Ih(n1),Tb=Ih(n1);function yp(e){if(e===n1)throw Error(tn(174));return e}function D3(e,t){switch(Oo(Tb,t),Oo(Ob,e),Oo($u,n1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dk(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dk(t,e)}Vo($u),Oo($u,t)}function fx(){Vo($u),Vo(Ob),Vo(Tb)}function NW(e){yp(Tb.current);var t=yp($u.current),r=dk(t,e.type);t!==r&&(Oo(Ob,e),Oo($u,r))}function M3(e){Ob.current===e&&(Vo($u),Vo(Ob))}var es=Ih(0);function b_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var IP=[];function R3(){for(var e=0;e<IP.length;e++)IP[e]._workInProgressVersionPrimary=null;IP.length=0}var Ij=Jf.ReactCurrentDispatcher,OP=Jf.ReactCurrentBatchConfig,Xp=0,ns=null,Ws=null,si=null,w_=!1,Ly=!1,Db=0,ece=0;function Li(){throw Error(tn(321))}function L3(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!su(e[r],t[r]))return!1;return!0}function F3(e,t,r,n,o,s){if(Xp=s,ns=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ij.current=e===null||e.memoizedState===null?ace:oce,e=r(n,o),Ly){s=0;do{if(Ly=!1,Db=0,25<=s)throw Error(tn(301));s+=1,si=Ws=null,t.updateQueue=null,Ij.current=sce,e=r(n,o)}while(Ly)}if(Ij.current=j_,t=Ws!==null&&Ws.next!==null,Xp=0,si=Ws=ns=null,w_=!1,t)throw Error(tn(300));return e}function $3(){var e=Db!==0;return Db=0,e}function Su(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return si===null?ns.memoizedState=si=e:si=si.next=e,si}function jd(){if(Ws===null){var e=ns.alternate;e=e!==null?e.memoizedState:null}else e=Ws.next;var t=si===null?ns.memoizedState:si.next;if(t!==null)si=t,Ws=e;else{if(e===null)throw Error(tn(310));Ws=e,e={memoizedState:Ws.memoizedState,baseState:Ws.baseState,baseQueue:Ws.baseQueue,queue:Ws.queue,next:null},si===null?ns.memoizedState=si=e:si=si.next=e}return si}function Mb(e,t){return typeof t=="function"?t(e):t}function TP(e){var t=jd(),r=t.queue;if(r===null)throw Error(tn(311));r.lastRenderedReducer=e;var n=Ws,o=n.baseQueue,s=r.pending;if(s!==null){if(o!==null){var i=o.next;o.next=s.next,s.next=i}n.baseQueue=o=s,r.pending=null}if(o!==null){s=o.next,n=n.baseState;var l=i=null,c=null,d=s;do{var u=d.lane;if((Xp&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,i=n):c=c.next=f,ns.lanes|=u,Yp|=u}d=d.next}while(d!==null&&d!==s);c===null?i=n:c.next=l,su(n,t.memoizedState)||($l=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){o=e;do s=o.lane,ns.lanes|=s,Yp|=s,o=o.next;while(o!==e)}else o===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function DP(e){var t=jd(),r=t.queue;if(r===null)throw Error(tn(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,s=t.memoizedState;if(o!==null){r.pending=null;var i=o=o.next;do s=e(s,i.action),i=i.next;while(i!==o);su(s,t.memoizedState)||($l=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function SW(){}function CW(e,t){var r=ns,n=jd(),o=t(),s=!su(n.memoizedState,o);if(s&&(n.memoizedState=o,$l=!0),n=n.queue,B3(EW.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||si!==null&&si.memoizedState.tag&1){if(r.flags|=2048,Rb(9,AW.bind(null,r,n,o,t),void 0,null),li===null)throw Error(tn(349));Xp&30||PW(r,t,o)}return o}function PW(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ns.updateQueue,t===null?(t={lastEffect:null,stores:null},ns.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function AW(e,t,r,n){t.value=r,t.getSnapshot=n,kW(t)&&IW(e)}function EW(e,t,r){return r(function(){kW(t)&&IW(e)})}function kW(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!su(e,r)}catch{return!0}}function IW(e){var t=$f(e,1);t!==null&&ru(t,e,1,-1)}function XL(e){var t=Su();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mb,lastRenderedState:e},t.queue=e,e=e.dispatch=nce.bind(null,ns,e),[t.memoizedState,e]}function Rb(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ns.updateQueue,t===null?(t={lastEffect:null,stores:null},ns.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function OW(){return jd().memoizedState}function Oj(e,t,r,n){var o=Su();ns.flags|=e,o.memoizedState=Rb(1|t,r,void 0,n===void 0?null:n)}function BS(e,t,r,n){var o=jd();n=n===void 0?null:n;var s=void 0;if(Ws!==null){var i=Ws.memoizedState;if(s=i.destroy,n!==null&&L3(n,i.deps)){o.memoizedState=Rb(t,r,s,n);return}}ns.flags|=e,o.memoizedState=Rb(1|t,r,s,n)}function YL(e,t){return Oj(8390656,8,e,t)}function B3(e,t){return BS(2048,8,e,t)}function TW(e,t){return BS(4,2,e,t)}function DW(e,t){return BS(4,4,e,t)}function MW(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function RW(e,t,r){return r=r!=null?r.concat([e]):null,BS(4,4,MW.bind(null,t,e),r)}function q3(){}function LW(e,t){var r=jd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&L3(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function FW(e,t){var r=jd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&L3(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function $W(e,t,r){return Xp&21?(su(r,t)||(r=VV(),ns.lanes|=r,Yp|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,$l=!0),e.memoizedState=r)}function tce(e,t){var r=fo;fo=r!==0&&4>r?r:4,e(!0);var n=OP.transition;OP.transition={};try{e(!1),t()}finally{fo=r,OP.transition=n}}function BW(){return jd().memoizedState}function rce(e,t,r){var n=rh(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},qW(e))zW(t,r);else if(r=jW(e,t,r,n),r!==null){var o=xl();ru(r,e,n,o),UW(r,t,n)}}function nce(e,t,r){var n=rh(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(qW(e))zW(t,o);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,l=s(i,r);if(o.hasEagerState=!0,o.eagerState=l,su(l,i)){var c=t.interleaved;c===null?(o.next=o,O3(t)):(o.next=c.next,c.next=o),t.interleaved=o;return}}catch{}finally{}r=jW(e,t,o,n),r!==null&&(o=xl(),ru(r,e,n,o),UW(r,t,n))}}function qW(e){var t=e.alternate;return e===ns||t!==null&&t===ns}function zW(e,t){Ly=w_=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function UW(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,x3(e,r)}}var j_={readContext:wd,useCallback:Li,useContext:Li,useEffect:Li,useImperativeHandle:Li,useInsertionEffect:Li,useLayoutEffect:Li,useMemo:Li,useReducer:Li,useRef:Li,useState:Li,useDebugValue:Li,useDeferredValue:Li,useTransition:Li,useMutableSource:Li,useSyncExternalStore:Li,useId:Li,unstable_isNewReconciler:!1},ace={readContext:wd,useCallback:function(e,t){return Su().memoizedState=[e,t===void 0?null:t],e},useContext:wd,useEffect:YL,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Oj(4194308,4,MW.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Oj(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oj(4,2,e,t)},useMemo:function(e,t){var r=Su();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Su();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=rce.bind(null,ns,e),[n.memoizedState,e]},useRef:function(e){var t=Su();return e={current:e},t.memoizedState=e},useState:XL,useDebugValue:q3,useDeferredValue:function(e){return Su().memoizedState=e},useTransition:function(){var e=XL(!1),t=e[0];return e=tce.bind(null,e[1]),Su().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ns,o=Su();if(Ko){if(r===void 0)throw Error(tn(407));r=r()}else{if(r=t(),li===null)throw Error(tn(349));Xp&30||PW(n,t,r)}o.memoizedState=r;var s={value:r,getSnapshot:t};return o.queue=s,YL(EW.bind(null,n,s,e),[e]),n.flags|=2048,Rb(9,AW.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Su(),t=li.identifierPrefix;if(Ko){var r=Sf,n=Nf;r=(n&~(1<<32-tu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Db++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ece++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oce={readContext:wd,useCallback:LW,useContext:wd,useEffect:B3,useImperativeHandle:RW,useInsertionEffect:TW,useLayoutEffect:DW,useMemo:FW,useReducer:TP,useRef:OW,useState:function(){return TP(Mb)},useDebugValue:q3,useDeferredValue:function(e){var t=jd();return $W(t,Ws.memoizedState,e)},useTransition:function(){var e=TP(Mb)[0],t=jd().memoizedState;return[e,t]},useMutableSource:SW,useSyncExternalStore:CW,useId:BW,unstable_isNewReconciler:!1},sce={readContext:wd,useCallback:LW,useContext:wd,useEffect:B3,useImperativeHandle:RW,useInsertionEffect:TW,useLayoutEffect:DW,useMemo:FW,useReducer:DP,useRef:OW,useState:function(){return DP(Mb)},useDebugValue:q3,useDeferredValue:function(e){var t=jd();return Ws===null?t.memoizedState=e:$W(t,Ws.memoizedState,e)},useTransition:function(){var e=DP(Mb)[0],t=jd().memoizedState;return[e,t]},useMutableSource:SW,useSyncExternalStore:CW,useId:BW,unstable_isNewReconciler:!1};function Vd(e,t){if(e&&e.defaultProps){t=os({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Ik(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:os({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var qS={isMounted:function(e){return(e=e._reactInternals)?xg(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=xl(),o=rh(e),s=If(n,o);s.payload=t,r!=null&&(s.callback=r),t=eh(e,s,o),t!==null&&(ru(t,e,o,n),kj(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=xl(),o=rh(e),s=If(n,o);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=eh(e,s,o),t!==null&&(ru(t,e,o,n),kj(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=xl(),n=rh(e),o=If(r,n);o.tag=2,t!=null&&(o.callback=t),t=eh(e,o,n),t!==null&&(ru(t,e,n,r),kj(t,e,n))}};function JL(e,t,r,n,o,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Ab(r,n)||!Ab(o,s):!0}function VW(e,t,r){var n=!1,o=bh,s=t.contextType;return typeof s=="object"&&s!==null?s=wd(s):(o=Vl(t)?Gp:Xi.current,n=t.contextTypes,s=(n=n!=null)?cx(e,o):bh),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=qS,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=s),t}function QL(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&qS.enqueueReplaceState(t,t.state,null)}function Ok(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs={},T3(e);var s=t.contextType;typeof s=="object"&&s!==null?o.context=wd(s):(s=Vl(t)?Gp:Xi.current,o.context=cx(e,s)),o.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Ik(e,t,s,r),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&qS.enqueueReplaceState(o,o.state,null),y_(e,r,o,n),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function mx(e,t){try{var r="",n=t;do r+=Die(n),n=n.return;while(n);var o=r}catch(s){o=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:o,digest:null}}function MP(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Tk(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ice=typeof WeakMap=="function"?WeakMap:Map;function WW(e,t,r){r=If(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){N_||(N_=!0,Uk=n),Tk(e,t)},r}function HW(e,t,r){r=If(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){Tk(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Tk(e,t),typeof n!="function"&&(th===null?th=new Set([this]):th.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function ZL(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new ice;var o=new Set;n.set(t,o)}else o=n.get(t),o===void 0&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=wce.bind(null,e,t,r),t.then(e,e))}function eF(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function tF(e,t,r,n,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=If(-1,1),t.tag=2,eh(r,t,1))),r.lanes|=1),e)}var lce=Jf.ReactCurrentOwner,$l=!1;function ul(e,t,r,n){t.child=e===null?wW(t,null,r,n):ux(t,e.child,r,n)}function rF(e,t,r,n,o){r=r.render;var s=t.ref;return Wv(t,o),n=F3(e,t,r,n,s,o),r=$3(),e!==null&&!$l?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Bf(e,t,o)):(Ko&&r&&C3(t),t.flags|=1,ul(e,t,n,o),t.child)}function nF(e,t,r,n,o){if(e===null){var s=r.type;return typeof s=="function"&&!X3(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,GW(e,t,s,n,o)):(e=Rj(r.type,null,n,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&o)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ab,r(i,n)&&e.ref===t.ref)return Bf(e,t,o)}return t.flags|=1,e=nh(s,n),e.ref=t.ref,e.return=t,t.child=e}function GW(e,t,r,n,o){if(e!==null){var s=e.memoizedProps;if(Ab(s,n)&&e.ref===t.ref)if($l=!1,t.pendingProps=n=s,(e.lanes&o)!==0)e.flags&131072&&($l=!0);else return t.lanes=e.lanes,Bf(e,t,o)}return Dk(e,t,r,n,o)}function KW(e,t,r){var n=t.pendingProps,o=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oo(Av,pc),pc|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Oo(Av,pc),pc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Oo(Av,pc),pc|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Oo(Av,pc),pc|=n;return ul(e,t,o,r),t.child}function XW(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Dk(e,t,r,n,o){var s=Vl(r)?Gp:Xi.current;return s=cx(t,s),Wv(t,o),r=F3(e,t,r,n,s,o),n=$3(),e!==null&&!$l?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Bf(e,t,o)):(Ko&&n&&C3(t),t.flags|=1,ul(e,t,r,o),t.child)}function aF(e,t,r,n,o){if(Vl(r)){var s=!0;h_(t)}else s=!1;if(Wv(t,o),t.stateNode===null)Tj(e,t),VW(t,r,n),Ok(t,r,n,o),n=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,d=r.contextType;typeof d=="object"&&d!==null?d=wd(d):(d=Vl(r)?Gp:Xi.current,d=cx(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==n||c!==d)&&QL(t,i,n,d),Pm=!1;var h=t.memoizedState;i.state=h,y_(t,n,i,o),c=t.memoizedState,l!==n||h!==c||Ul.current||Pm?(typeof u=="function"&&(Ik(t,r,u,n),c=t.memoizedState),(l=Pm||JL(t,r,l,n,h,c,d))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=d,n=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,_W(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Vd(t.type,l),i.props=d,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=wd(c):(c=Vl(r)?Gp:Xi.current,c=cx(t,c));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==f||h!==c)&&QL(t,i,n,c),Pm=!1,h=t.memoizedState,i.state=h,y_(t,n,i,o);var v=t.memoizedState;l!==f||h!==v||Ul.current||Pm?(typeof m=="function"&&(Ik(t,r,m,n),v=t.memoizedState),(d=Pm||JL(t,r,d,n,h,v,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),i.props=n,i.state=v,i.context=c,n=d):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Mk(e,t,r,n,s,o)}function Mk(e,t,r,n,o,s){XW(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return o&&UL(t,r,!1),Bf(e,t,s);n=t.stateNode,lce.current=t;var l=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=ux(t,e.child,null,s),t.child=ux(t,null,l,s)):ul(e,t,l,s),t.memoizedState=n.state,o&&UL(t,r,!0),t.child}function YW(e){var t=e.stateNode;t.pendingContext?zL(e,t.pendingContext,t.pendingContext!==t.context):t.context&&zL(e,t.context,!1),D3(e,t.containerInfo)}function oF(e,t,r,n,o){return dx(),A3(o),t.flags|=256,ul(e,t,r,n),t.child}var Rk={dehydrated:null,treeContext:null,retryLane:0};function Lk(e){return{baseLanes:e,cachePool:null,transitions:null}}function JW(e,t,r){var n=t.pendingProps,o=es.current,s=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(o&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Oo(es,o&1),e===null)return Ek(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=VS(i,n,0,null),e=Dp(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Lk(r),t.memoizedState=Rk,e):z3(t,i));if(o=e.memoizedState,o!==null&&(l=o.dehydrated,l!==null))return cce(e,t,i,n,l,o,r);if(s){s=n.fallback,i=t.mode,o=e.child,l=o.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==o?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=nh(o,c),n.subtreeFlags=o.subtreeFlags&14680064),l!==null?s=nh(l,s):(s=Dp(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?Lk(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=Rk,n}return s=e.child,e=s.sibling,n=nh(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function z3(e,t){return t=VS({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function x2(e,t,r,n){return n!==null&&A3(n),ux(t,e.child,null,r),e=z3(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function cce(e,t,r,n,o,s,i){if(r)return t.flags&256?(t.flags&=-257,n=MP(Error(tn(422))),x2(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,o=t.mode,n=VS({mode:"visible",children:n.children},o,0,null),s=Dp(s,o,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&ux(t,e.child,null,i),t.child.memoizedState=Lk(i),t.memoizedState=Rk,s);if(!(t.mode&1))return x2(e,t,i,null);if(o.data==="$!"){if(n=o.nextSibling&&o.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(tn(419)),n=MP(s,n,void 0),x2(e,t,i,n)}if(l=(i&e.childLanes)!==0,$l||l){if(n=li,n!==null){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(n.suspendedLanes|i)?0:o,o!==0&&o!==s.retryLane&&(s.retryLane=o,$f(e,o),ru(n,e,o,-1))}return K3(),n=MP(Error(tn(421))),x2(e,t,i,n)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=jce.bind(null,e),o._reactRetry=t,null):(e=s.treeContext,wc=Zm(o.nextSibling),Pc=t,Ko=!0,Xd=null,e!==null&&(td[rd++]=Nf,td[rd++]=Sf,td[rd++]=Kp,Nf=e.id,Sf=e.overflow,Kp=t),t=z3(t,n.children),t.flags|=4096,t)}function sF(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),kk(e.return,t,r)}function RP(e,t,r,n,o){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=o)}function QW(e,t,r){var n=t.pendingProps,o=n.revealOrder,s=n.tail;if(ul(e,t,n.children,r),n=es.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&sF(e,r,t);else if(e.tag===19)sF(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Oo(es,n),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;r!==null;)e=r.alternate,e!==null&&b_(e)===null&&(o=r),r=r.sibling;r=o,r===null?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),RP(t,!1,o,r,s);break;case"backwards":for(r=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&b_(e)===null){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}RP(t,!0,r,null,s);break;case"together":RP(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Tj(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Bf(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Yp|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(tn(153));if(t.child!==null){for(e=t.child,r=nh(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=nh(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function dce(e,t,r){switch(t.tag){case 3:YW(t),dx();break;case 5:NW(t);break;case 1:Vl(t.type)&&h_(t);break;case 4:D3(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;Oo(v_,n._currentValue),n._currentValue=o;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Oo(es,es.current&1),t.flags|=128,null):r&t.child.childLanes?JW(e,t,r):(Oo(es,es.current&1),e=Bf(e,t,r),e!==null?e.sibling:null);Oo(es,es.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return QW(e,t,r);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Oo(es,es.current),n)break;return null;case 22:case 23:return t.lanes=0,KW(e,t,r)}return Bf(e,t,r)}var ZW,Fk,eH,tH;ZW=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Fk=function(){};eH=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,yp($u.current);var s=null;switch(r){case"input":o=sk(e,o),n=sk(e,n),s=[];break;case"select":o=os({},o,{value:void 0}),n=os({},n,{value:void 0}),s=[];break;case"textarea":o=ck(e,o),n=ck(e,n),s=[];break;default:typeof o.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=f_)}uk(r,n);var i;r=null;for(d in o)if(!n.hasOwnProperty(d)&&o.hasOwnProperty(d)&&o[d]!=null)if(d==="style"){var l=o[d];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(wb.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var c=n[d];if(l=o?.[d],n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(s||(s=[]),s.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(wb.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Bo("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}r&&(s=s||[]).push("style",r);var d=s;(t.updateQueue=d)&&(t.flags|=4)}};tH=function(e,t,r,n){r!==n&&(t.flags|=4)};function K0(e,t){if(!Ko)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Fi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags&14680064,n|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function uce(e,t,r){var n=t.pendingProps;switch(P3(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fi(t),null;case 1:return Vl(t.type)&&m_(),Fi(t),null;case 3:return n=t.stateNode,fx(),Vo(Ul),Vo(Xi),R3(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(g2(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Xd!==null&&(Hk(Xd),Xd=null))),Fk(e,t),Fi(t),null;case 5:M3(t);var o=yp(Tb.current);if(r=t.type,e!==null&&t.stateNode!=null)eH(e,t,r,n,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(tn(166));return Fi(t),null}if(e=yp($u.current),g2(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Pu]=t,n[Ib]=s,e=(t.mode&1)!==0,r){case"dialog":Bo("cancel",n),Bo("close",n);break;case"iframe":case"object":case"embed":Bo("load",n);break;case"video":case"audio":for(o=0;o<Ny.length;o++)Bo(Ny[o],n);break;case"source":Bo("error",n);break;case"img":case"image":case"link":Bo("error",n),Bo("load",n);break;case"details":Bo("toggle",n);break;case"input":pL(n,s),Bo("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Bo("invalid",n);break;case"textarea":vL(n,s),Bo("invalid",n)}uk(r,s),o=null;for(var i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&p2(n.textContent,l,e),o=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&p2(n.textContent,l,e),o=["children",""+l]):wb.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Bo("scroll",n)}switch(r){case"input":i2(n),gL(n,s,!0);break;case"textarea":i2(n),xL(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=f_)}n=o,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=EV(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Pu]=t,e[Ib]=n,ZW(e,t,!1,!1),t.stateNode=e;e:{switch(i=fk(r,n),r){case"dialog":Bo("cancel",e),Bo("close",e),o=n;break;case"iframe":case"object":case"embed":Bo("load",e),o=n;break;case"video":case"audio":for(o=0;o<Ny.length;o++)Bo(Ny[o],e);o=n;break;case"source":Bo("error",e),o=n;break;case"img":case"image":case"link":Bo("error",e),Bo("load",e),o=n;break;case"details":Bo("toggle",e),o=n;break;case"input":pL(e,n),o=sk(e,n),Bo("invalid",e);break;case"option":o=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=os({},n,{value:void 0}),Bo("invalid",e);break;case"textarea":vL(e,n),o=ck(e,n),Bo("invalid",e);break;default:o=n}uk(r,o),l=o;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?OV(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&kV(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&jb(e,c):typeof c=="number"&&jb(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(wb.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Bo("scroll",e):c!=null&&f3(e,s,c,i))}switch(r){case"input":i2(e),gL(e,n,!1);break;case"textarea":i2(e),xL(e);break;case"option":n.value!=null&&e.setAttribute("value",""+yh(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?qv(e,!!n.multiple,s,!1):n.defaultValue!=null&&qv(e,!!n.multiple,n.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=f_)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Fi(t),null;case 6:if(e&&t.stateNode!=null)tH(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(tn(166));if(r=yp(Tb.current),yp($u.current),g2(t)){if(n=t.stateNode,r=t.memoizedProps,n[Pu]=t,(s=n.nodeValue!==r)&&(e=Pc,e!==null))switch(e.tag){case 3:p2(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&p2(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Pu]=t,t.stateNode=n}return Fi(t),null;case 13:if(Vo(es),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ko&&wc!==null&&t.mode&1&&!(t.flags&128))yW(),dx(),t.flags|=98560,s=!1;else if(s=g2(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(tn(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(tn(317));s[Pu]=t}else dx(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Fi(t),s=!1}else Xd!==null&&(Hk(Xd),Xd=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||es.current&1?Ys===0&&(Ys=3):K3())),t.updateQueue!==null&&(t.flags|=4),Fi(t),null);case 4:return fx(),Fk(e,t),e===null&&Eb(t.stateNode.containerInfo),Fi(t),null;case 10:return I3(t.type._context),Fi(t),null;case 17:return Vl(t.type)&&m_(),Fi(t),null;case 19:if(Vo(es),s=t.memoizedState,s===null)return Fi(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)K0(s,!1);else{if(Ys!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=b_(e),i!==null){for(t.flags|=128,K0(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Oo(es,es.current&1|2),t.child}e=e.sibling}s.tail!==null&&ys()>hx&&(t.flags|=128,n=!0,K0(s,!1),t.lanes=4194304)}else{if(!n)if(e=b_(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),K0(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Ko)return Fi(t),null}else 2*ys()-s.renderingStartTime>hx&&r!==1073741824&&(t.flags|=128,n=!0,K0(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ys(),t.sibling=null,r=es.current,Oo(es,n?r&1|2:r&1),t):(Fi(t),null);case 22:case 23:return G3(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?pc&1073741824&&(Fi(t),t.subtreeFlags&6&&(t.flags|=8192)):Fi(t),null;case 24:return null;case 25:return null}throw Error(tn(156,t.tag))}function fce(e,t){switch(P3(t),t.tag){case 1:return Vl(t.type)&&m_(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fx(),Vo(Ul),Vo(Xi),R3(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return M3(t),null;case 13:if(Vo(es),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(tn(340));dx()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Vo(es),null;case 4:return fx(),null;case 10:return I3(t.type._context),null;case 22:case 23:return G3(),null;case 24:return null;default:return null}}var y2=!1,Wi=!1,mce=typeof WeakSet=="function"?WeakSet:Set,Tn=null;function Pv(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){fs(e,t,n)}else r.current=null}function $k(e,t,r){try{r()}catch(n){fs(e,t,n)}}var iF=!1;function hce(e,t){if(jk=c_,e=sW(),S3(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var o=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var m;f!==r||o!==0&&f.nodeType!==3||(l=i+o),f!==s||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++d===o&&(l=i),h===s&&++u===n&&(c=i),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(_k={focusedElem:e,selectionRange:r},c_=!1,Tn=t;Tn!==null;)if(t=Tn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Tn=e;else for(;Tn!==null;){t=Tn;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,y=v.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:Vd(t.type,g),y);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(tn(163))}}catch(j){fs(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,Tn=e;break}Tn=t.return}return v=iF,iF=!1,v}function Fy(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var s=o.destroy;o.destroy=void 0,s!==void 0&&$k(t,r,s)}o=o.next}while(o!==n)}}function zS(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Bk(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function rH(e){var t=e.alternate;t!==null&&(e.alternate=null,rH(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Pu],delete t[Ib],delete t[Ck],delete t[Yle],delete t[Jle])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function nH(e){return e.tag===5||e.tag===3||e.tag===4}function lF(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||nH(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function qk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=f_));else if(n!==4&&(e=e.child,e!==null))for(qk(e,t,r),e=e.sibling;e!==null;)qk(e,t,r),e=e.sibling}function zk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(zk(e,t,r),e=e.sibling;e!==null;)zk(e,t,r),e=e.sibling}var Ci=null,Wd=!1;function mm(e,t,r){for(r=r.child;r!==null;)aH(e,t,r),r=r.sibling}function aH(e,t,r){if(Fu&&typeof Fu.onCommitFiberUnmount=="function")try{Fu.onCommitFiberUnmount(DS,r)}catch{}switch(r.tag){case 5:Wi||Pv(r,t);case 6:var n=Ci,o=Wd;Ci=null,mm(e,t,r),Ci=n,Wd=o,Ci!==null&&(Wd?(e=Ci,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ci.removeChild(r.stateNode));break;case 18:Ci!==null&&(Wd?(e=Ci,r=r.stateNode,e.nodeType===8?EP(e.parentNode,r):e.nodeType===1&&EP(e,r),Cb(e)):EP(Ci,r.stateNode));break;case 4:n=Ci,o=Wd,Ci=r.stateNode.containerInfo,Wd=!0,mm(e,t,r),Ci=n,Wd=o;break;case 0:case 11:case 14:case 15:if(!Wi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){o=n=n.next;do{var s=o,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&$k(r,t,i),o=o.next}while(o!==n)}mm(e,t,r);break;case 1:if(!Wi&&(Pv(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){fs(r,t,l)}mm(e,t,r);break;case 21:mm(e,t,r);break;case 22:r.mode&1?(Wi=(n=Wi)||r.memoizedState!==null,mm(e,t,r),Wi=n):mm(e,t,r);break;default:mm(e,t,r)}}function cF(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new mce),t.forEach(function(n){var o=_ce.bind(null,e,n);r.has(n)||(r.add(n),n.then(o,o))})}}function Ld(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var o=r[n];try{var s=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:Ci=l.stateNode,Wd=!1;break e;case 3:Ci=l.stateNode.containerInfo,Wd=!0;break e;case 4:Ci=l.stateNode.containerInfo,Wd=!0;break e}l=l.return}if(Ci===null)throw Error(tn(160));aH(s,i,o),Ci=null,Wd=!1;var c=o.alternate;c!==null&&(c.return=null),o.return=null}catch(d){fs(o,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)oH(t,e),t=t.sibling}function oH(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ld(t,e),yu(e),n&4){try{Fy(3,e,e.return),zS(3,e)}catch(g){fs(e,e.return,g)}try{Fy(5,e,e.return)}catch(g){fs(e,e.return,g)}}break;case 1:Ld(t,e),yu(e),n&512&&r!==null&&Pv(r,r.return);break;case 5:if(Ld(t,e),yu(e),n&512&&r!==null&&Pv(r,r.return),e.flags&32){var o=e.stateNode;try{jb(o,"")}catch(g){fs(e,e.return,g)}}if(n&4&&(o=e.stateNode,o!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&PV(o,s),fk(l,i);var d=fk(l,s);for(i=0;i<c.length;i+=2){var u=c[i],f=c[i+1];u==="style"?OV(o,f):u==="dangerouslySetInnerHTML"?kV(o,f):u==="children"?jb(o,f):f3(o,u,f,d)}switch(l){case"input":ik(o,s);break;case"textarea":AV(o,s);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?qv(o,!!s.multiple,m,!1):h!==!!s.multiple&&(s.defaultValue!=null?qv(o,!!s.multiple,s.defaultValue,!0):qv(o,!!s.multiple,s.multiple?[]:"",!1))}o[Ib]=s}catch(g){fs(e,e.return,g)}}break;case 6:if(Ld(t,e),yu(e),n&4){if(e.stateNode===null)throw Error(tn(162));o=e.stateNode,s=e.memoizedProps;try{o.nodeValue=s}catch(g){fs(e,e.return,g)}}break;case 3:if(Ld(t,e),yu(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Cb(t.containerInfo)}catch(g){fs(e,e.return,g)}break;case 4:Ld(t,e),yu(e);break;case 13:Ld(t,e),yu(e),o=e.child,o.flags&8192&&(s=o.memoizedState!==null,o.stateNode.isHidden=s,!s||o.alternate!==null&&o.alternate.memoizedState!==null||(W3=ys())),n&4&&cF(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Wi=(d=Wi)||u,Ld(t,e),Wi=d):Ld(t,e),yu(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(Tn=e,u=e.child;u!==null;){for(f=Tn=u;Tn!==null;){switch(h=Tn,m=h.child,h.tag){case 0:case 11:case 14:case 15:Fy(4,h,h.return);break;case 1:Pv(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){fs(n,r,g)}}break;case 5:Pv(h,h.return);break;case 22:if(h.memoizedState!==null){uF(f);continue}}m!==null?(m.return=h,Tn=m):uF(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{o=f.stateNode,d?(s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=IV("display",i))}catch(g){fs(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){fs(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ld(t,e),yu(e),n&4&&cF(e);break;case 21:break;default:Ld(t,e),yu(e)}}function yu(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(nH(r)){var n=r;break e}r=r.return}throw Error(tn(160))}switch(n.tag){case 5:var o=n.stateNode;n.flags&32&&(jb(o,""),n.flags&=-33);var s=lF(e);zk(e,s,o);break;case 3:case 4:var i=n.stateNode.containerInfo,l=lF(e);qk(e,l,i);break;default:throw Error(tn(161))}}catch(c){fs(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pce(e,t,r){Tn=e,sH(e)}function sH(e,t,r){for(var n=(e.mode&1)!==0;Tn!==null;){var o=Tn,s=o.child;if(o.tag===22&&n){var i=o.memoizedState!==null||y2;if(!i){var l=o.alternate,c=l!==null&&l.memoizedState!==null||Wi;l=y2;var d=Wi;if(y2=i,(Wi=c)&&!d)for(Tn=o;Tn!==null;)i=Tn,c=i.child,i.tag===22&&i.memoizedState!==null?fF(o):c!==null?(c.return=i,Tn=c):fF(o);for(;s!==null;)Tn=s,sH(s),s=s.sibling;Tn=o,y2=l,Wi=d}dF(e)}else o.subtreeFlags&8772&&s!==null?(s.return=o,Tn=s):dF(e)}}function dF(e){for(;Tn!==null;){var t=Tn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Wi||zS(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Wi)if(r===null)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:Vd(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&KL(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}KL(t,i,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Cb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(tn(163))}Wi||t.flags&512&&Bk(t)}catch(h){fs(t,t.return,h)}}if(t===e){Tn=null;break}if(r=t.sibling,r!==null){r.return=t.return,Tn=r;break}Tn=t.return}}function uF(e){for(;Tn!==null;){var t=Tn;if(t===e){Tn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Tn=r;break}Tn=t.return}}function fF(e){for(;Tn!==null;){var t=Tn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{zS(4,t)}catch(c){fs(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var o=t.return;try{n.componentDidMount()}catch(c){fs(t,o,c)}}var s=t.return;try{Bk(t)}catch(c){fs(t,s,c)}break;case 5:var i=t.return;try{Bk(t)}catch(c){fs(t,i,c)}}}catch(c){fs(t,t.return,c)}if(t===e){Tn=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Tn=l;break}Tn=t.return}}var gce=Math.ceil,__=Jf.ReactCurrentDispatcher,U3=Jf.ReactCurrentOwner,gd=Jf.ReactCurrentBatchConfig,Ya=0,li=null,Ts=null,Ei=0,pc=0,Av=Ih(0),Ys=0,Lb=null,Yp=0,US=0,V3=0,$y=null,Ml=null,W3=0,hx=1/0,vf=null,N_=!1,Uk=null,th=null,b2=!1,$m=null,S_=0,By=0,Vk=null,Dj=-1,Mj=0;function xl(){return Ya&6?ys():Dj!==-1?Dj:Dj=ys()}function rh(e){return e.mode&1?Ya&2&&Ei!==0?Ei&-Ei:Zle.transition!==null?(Mj===0&&(Mj=VV()),Mj):(e=fo,e!==0||(e=window.event,e=e===void 0?16:JV(e.type)),e):1}function ru(e,t,r,n){if(50<By)throw By=0,Vk=null,Error(tn(185));e1(e,r,n),(!(Ya&2)||e!==li)&&(e===li&&(!(Ya&2)&&(US|=r),Ys===4&&Om(e,Ei)),Wl(e,n),r===1&&Ya===0&&!(t.mode&1)&&(hx=ys()+500,$S&&Oh()))}function Wl(e,t){var r=e.callbackNode;Zie(e,t);var n=l_(e,e===li?Ei:0);if(n===0)r!==null&&wL(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&wL(r),t===1)e.tag===0?Qle(mF.bind(null,e)):gW(mF.bind(null,e)),Kle(function(){!(Ya&6)&&Oh()}),r=null;else{switch(WV(n)){case 1:r=v3;break;case 4:r=zV;break;case 16:r=i_;break;case 536870912:r=UV;break;default:r=i_}r=hH(r,iH.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function iH(e,t){if(Dj=-1,Mj=0,Ya&6)throw Error(tn(327));var r=e.callbackNode;if(Hv()&&e.callbackNode!==r)return null;var n=l_(e,e===li?Ei:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=C_(e,n);else{t=n;var o=Ya;Ya|=2;var s=cH();(li!==e||Ei!==t)&&(vf=null,hx=ys()+500,Tp(e,t));do try{yce();break}catch(l){lH(e,l)}while(1);k3(),__.current=s,Ya=o,Ts!==null?t=0:(li=null,Ei=0,t=Ys)}if(t!==0){if(t===2&&(o=vk(e),o!==0&&(n=o,t=Wk(e,o))),t===1)throw r=Lb,Tp(e,0),Om(e,n),Wl(e,ys()),r;if(t===6)Om(e,n);else{if(o=e.current.alternate,!(n&30)&&!vce(o)&&(t=C_(e,n),t===2&&(s=vk(e),s!==0&&(n=s,t=Wk(e,s))),t===1))throw r=Lb,Tp(e,0),Om(e,n),Wl(e,ys()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(tn(345));case 2:rp(e,Ml,vf);break;case 3:if(Om(e,n),(n&130023424)===n&&(t=W3+500-ys(),10<t)){if(l_(e,0)!==0)break;if(o=e.suspendedLanes,(o&n)!==n){xl(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Sk(rp.bind(null,e,Ml,vf),t);break}rp(e,Ml,vf);break;case 4:if(Om(e,n),(n&4194240)===n)break;for(t=e.eventTimes,o=-1;0<n;){var i=31-tu(n);s=1<<i,i=t[i],i>o&&(o=i),n&=~s}if(n=o,n=ys()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gce(n/1960))-n,10<n){e.timeoutHandle=Sk(rp.bind(null,e,Ml,vf),n);break}rp(e,Ml,vf);break;case 5:rp(e,Ml,vf);break;default:throw Error(tn(329))}}}return Wl(e,ys()),e.callbackNode===r?iH.bind(null,e):null}function Wk(e,t){var r=$y;return e.current.memoizedState.isDehydrated&&(Tp(e,t).flags|=256),e=C_(e,t),e!==2&&(t=Ml,Ml=r,t!==null&&Hk(t)),e}function Hk(e){Ml===null?Ml=e:Ml.push.apply(Ml,e)}function vce(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var o=r[n],s=o.getSnapshot;o=o.value;try{if(!su(s(),o))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Om(e,t){for(t&=~V3,t&=~US,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-tu(t),n=1<<r;e[r]=-1,t&=~n}}function mF(e){if(Ya&6)throw Error(tn(327));Hv();var t=l_(e,0);if(!(t&1))return Wl(e,ys()),null;var r=C_(e,t);if(e.tag!==0&&r===2){var n=vk(e);n!==0&&(t=n,r=Wk(e,n))}if(r===1)throw r=Lb,Tp(e,0),Om(e,t),Wl(e,ys()),r;if(r===6)throw Error(tn(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,rp(e,Ml,vf),Wl(e,ys()),null}function H3(e,t){var r=Ya;Ya|=1;try{return e(t)}finally{Ya=r,Ya===0&&(hx=ys()+500,$S&&Oh())}}function Jp(e){$m!==null&&$m.tag===0&&!(Ya&6)&&Hv();var t=Ya;Ya|=1;var r=gd.transition,n=fo;try{if(gd.transition=null,fo=1,e)return e()}finally{fo=n,gd.transition=r,Ya=t,!(Ya&6)&&Oh()}}function G3(){pc=Av.current,Vo(Av)}function Tp(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Gle(r)),Ts!==null)for(r=Ts.return;r!==null;){var n=r;switch(P3(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&m_();break;case 3:fx(),Vo(Ul),Vo(Xi),R3();break;case 5:M3(n);break;case 4:fx();break;case 13:Vo(es);break;case 19:Vo(es);break;case 10:I3(n.type._context);break;case 22:case 23:G3()}r=r.return}if(li=e,Ts=e=nh(e.current,null),Ei=pc=t,Ys=0,Lb=null,V3=US=Yp=0,Ml=$y=null,xp!==null){for(t=0;t<xp.length;t++)if(r=xp[t],n=r.interleaved,n!==null){r.interleaved=null;var o=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=o,n.next=i}r.pending=n}xp=null}return e}function lH(e,t){do{var r=Ts;try{if(k3(),Ij.current=j_,w_){for(var n=ns.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}w_=!1}if(Xp=0,si=Ws=ns=null,Ly=!1,Db=0,U3.current=null,r===null||r.return===null){Ys=1,Lb=t,Ts=null;break}e:{var s=e,i=r.return,l=r,c=t;if(t=Ei,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=eF(i);if(m!==null){m.flags&=-257,tF(m,i,l,s,t),m.mode&1&&ZL(s,d,t),t=m,c=d;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){ZL(s,d,t),K3();break e}c=Error(tn(426))}}else if(Ko&&l.mode&1){var y=eF(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),tF(y,i,l,s,t),A3(mx(c,l));break e}}s=c=mx(c,l),Ys!==4&&(Ys=2),$y===null?$y=[s]:$y.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=WW(s,c,t);GL(s,x);break e;case 1:l=c;var b=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(th===null||!th.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var j=HW(s,l,t);GL(s,j);break e}}s=s.return}while(s!==null)}uH(r)}catch(_){t=_,Ts===r&&r!==null&&(Ts=r=r.return);continue}break}while(1)}function cH(){var e=__.current;return __.current=j_,e===null?j_:e}function K3(){(Ys===0||Ys===3||Ys===2)&&(Ys=4),li===null||!(Yp&268435455)&&!(US&268435455)||Om(li,Ei)}function C_(e,t){var r=Ya;Ya|=2;var n=cH();(li!==e||Ei!==t)&&(vf=null,Tp(e,t));do try{xce();break}catch(o){lH(e,o)}while(1);if(k3(),Ya=r,__.current=n,Ts!==null)throw Error(tn(261));return li=null,Ei=0,Ys}function xce(){for(;Ts!==null;)dH(Ts)}function yce(){for(;Ts!==null&&!Vie();)dH(Ts)}function dH(e){var t=mH(e.alternate,e,pc);e.memoizedProps=e.pendingProps,t===null?uH(e):Ts=t,U3.current=null}function uH(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=fce(r,t),r!==null){r.flags&=32767,Ts=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ys=6,Ts=null;return}}else if(r=uce(r,t,pc),r!==null){Ts=r;return}if(t=t.sibling,t!==null){Ts=t;return}Ts=t=e}while(t!==null);Ys===0&&(Ys=5)}function rp(e,t,r){var n=fo,o=gd.transition;try{gd.transition=null,fo=1,bce(e,t,r,n)}finally{gd.transition=o,fo=n}return null}function bce(e,t,r,n){do Hv();while($m!==null);if(Ya&6)throw Error(tn(327));r=e.finishedWork;var o=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(tn(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(ele(e,s),e===li&&(Ts=li=null,Ei=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||b2||(b2=!0,hH(i_,function(){return Hv(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=gd.transition,gd.transition=null;var i=fo;fo=1;var l=Ya;Ya|=4,U3.current=null,hce(e,r),oH(r,e),Ble(_k),c_=!!jk,_k=jk=null,e.current=r,pce(r),Wie(),Ya=l,fo=i,gd.transition=s}else e.current=r;if(b2&&(b2=!1,$m=e,S_=o),s=e.pendingLanes,s===0&&(th=null),Kie(r.stateNode),Wl(e,ys()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],n(o.value,{componentStack:o.stack,digest:o.digest});if(N_)throw N_=!1,e=Uk,Uk=null,e;return S_&1&&e.tag!==0&&Hv(),s=e.pendingLanes,s&1?e===Vk?By++:(By=0,Vk=e):By=0,Oh(),null}function Hv(){if($m!==null){var e=WV(S_),t=gd.transition,r=fo;try{if(gd.transition=null,fo=16>e?16:e,$m===null)var n=!1;else{if(e=$m,$m=null,S_=0,Ya&6)throw Error(tn(331));var o=Ya;for(Ya|=4,Tn=e.current;Tn!==null;){var s=Tn,i=s.child;if(Tn.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Tn=d;Tn!==null;){var u=Tn;switch(u.tag){case 0:case 11:case 15:Fy(8,u,s)}var f=u.child;if(f!==null)f.return=u,Tn=f;else for(;Tn!==null;){u=Tn;var h=u.sibling,m=u.return;if(rH(u),u===d){Tn=null;break}if(h!==null){h.return=m,Tn=h;break}Tn=m}}}var v=s.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Tn=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Tn=i;else e:for(;Tn!==null;){if(s=Tn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Fy(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,Tn=x;break e}Tn=s.return}}var b=e.current;for(Tn=b;Tn!==null;){i=Tn;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Tn=w;else e:for(i=b;Tn!==null;){if(l=Tn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:zS(9,l)}}catch(_){fs(l,l.return,_)}if(l===i){Tn=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,Tn=j;break e}Tn=l.return}}if(Ya=o,Oh(),Fu&&typeof Fu.onPostCommitFiberRoot=="function")try{Fu.onPostCommitFiberRoot(DS,e)}catch{}n=!0}return n}finally{fo=r,gd.transition=t}}return!1}function hF(e,t,r){t=mx(r,t),t=WW(e,t,1),e=eh(e,t,1),t=xl(),e!==null&&(e1(e,1,t),Wl(e,t))}function fs(e,t,r){if(e.tag===3)hF(e,e,r);else for(;t!==null;){if(t.tag===3){hF(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(th===null||!th.has(n))){e=mx(r,e),e=HW(t,e,1),t=eh(t,e,1),e=xl(),t!==null&&(e1(t,1,e),Wl(t,e));break}}t=t.return}}function wce(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=xl(),e.pingedLanes|=e.suspendedLanes&r,li===e&&(Ei&r)===r&&(Ys===4||Ys===3&&(Ei&130023424)===Ei&&500>ys()-W3?Tp(e,0):V3|=r),Wl(e,t)}function fH(e,t){t===0&&(e.mode&1?(t=d2,d2<<=1,!(d2&130023424)&&(d2=4194304)):t=1);var r=xl();e=$f(e,t),e!==null&&(e1(e,t,r),Wl(e,r))}function jce(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),fH(e,r)}function _ce(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;o!==null&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(tn(314))}n!==null&&n.delete(t),fH(e,r)}var mH;mH=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ul.current)$l=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return $l=!1,dce(e,t,r);$l=!!(e.flags&131072)}else $l=!1,Ko&&t.flags&1048576&&vW(t,g_,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Tj(e,t),e=t.pendingProps;var o=cx(t,Xi.current);Wv(t,r),o=F3(null,t,n,e,o,r);var s=$3();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vl(n)?(s=!0,h_(t)):s=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,T3(t),o.updater=qS,t.stateNode=o,o._reactInternals=t,Ok(t,n,e,r),t=Mk(null,t,n,!0,s,r)):(t.tag=0,Ko&&s&&C3(t),ul(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Tj(e,t),e=t.pendingProps,o=n._init,n=o(n._payload),t.type=n,o=t.tag=Sce(n),e=Vd(n,e),o){case 0:t=Dk(null,t,n,e,r);break e;case 1:t=aF(null,t,n,e,r);break e;case 11:t=rF(null,t,n,e,r);break e;case 14:t=nF(null,t,n,Vd(n.type,e),r);break e}throw Error(tn(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Vd(n,o),Dk(e,t,n,o,r);case 1:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Vd(n,o),aF(e,t,n,o,r);case 3:e:{if(YW(t),e===null)throw Error(tn(387));n=t.pendingProps,s=t.memoizedState,o=s.element,_W(e,t),y_(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){o=mx(Error(tn(423)),t),t=oF(e,t,n,r,o);break e}else if(n!==o){o=mx(Error(tn(424)),t),t=oF(e,t,n,r,o);break e}else for(wc=Zm(t.stateNode.containerInfo.firstChild),Pc=t,Ko=!0,Xd=null,r=wW(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(dx(),n===o){t=Bf(e,t,r);break e}ul(e,t,n,r)}t=t.child}return t;case 5:return NW(t),e===null&&Ek(t),n=t.type,o=t.pendingProps,s=e!==null?e.memoizedProps:null,i=o.children,Nk(n,o)?i=null:s!==null&&Nk(n,s)&&(t.flags|=32),XW(e,t),ul(e,t,i,r),t.child;case 6:return e===null&&Ek(t),null;case 13:return JW(e,t,r);case 4:return D3(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ux(t,null,n,r):ul(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Vd(n,o),rF(e,t,n,o,r);case 7:return ul(e,t,t.pendingProps,r),t.child;case 8:return ul(e,t,t.pendingProps.children,r),t.child;case 12:return ul(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,s=t.memoizedProps,i=o.value,Oo(v_,n._currentValue),n._currentValue=i,s!==null)if(su(s.value,i)){if(s.children===o.children&&!Ul.current){t=Bf(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){i=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=If(-1,r&-r),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),kk(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(tn(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),kk(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}ul(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,Wv(t,r),o=wd(o),n=n(o),t.flags|=1,ul(e,t,n,r),t.child;case 14:return n=t.type,o=Vd(n,t.pendingProps),o=Vd(n.type,o),nF(e,t,n,o,r);case 15:return GW(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Vd(n,o),Tj(e,t),t.tag=1,Vl(n)?(e=!0,h_(t)):e=!1,Wv(t,r),VW(t,n,o),Ok(t,n,o,r),Mk(null,t,n,!0,e,r);case 19:return QW(e,t,r);case 22:return KW(e,t,r)}throw Error(tn(156,t.tag))};function hH(e,t){return qV(e,t)}function Nce(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ud(e,t,r,n){return new Nce(e,t,r,n)}function X3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Sce(e){if(typeof e=="function")return X3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===h3)return 11;if(e===p3)return 14}return 2}function nh(e,t){var r=e.alternate;return r===null?(r=ud(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Rj(e,t,r,n,o,s){var i=2;if(n=e,typeof e=="function")X3(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case xv:return Dp(r.children,o,s,t);case m3:i=8,o|=8;break;case rk:return e=ud(12,r,t,o|2),e.elementType=rk,e.lanes=s,e;case nk:return e=ud(13,r,t,o),e.elementType=nk,e.lanes=s,e;case ak:return e=ud(19,r,t,o),e.elementType=ak,e.lanes=s,e;case NV:return VS(r,o,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case jV:i=10;break e;case _V:i=9;break e;case h3:i=11;break e;case p3:i=14;break e;case Cm:i=16,n=null;break e}throw Error(tn(130,e==null?e:typeof e,""))}return t=ud(i,r,t,o),t.elementType=e,t.type=n,t.lanes=s,t}function Dp(e,t,r,n){return e=ud(7,e,n,t),e.lanes=r,e}function VS(e,t,r,n){return e=ud(22,e,n,t),e.elementType=NV,e.lanes=r,e.stateNode={isHidden:!1},e}function LP(e,t,r){return e=ud(6,e,null,t),e.lanes=r,e}function FP(e,t,r){return t=ud(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Cce(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xP(0),this.expirationTimes=xP(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xP(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Y3(e,t,r,n,o,s,i,l,c){return e=new Cce(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=ud(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},T3(s),e}function Pce(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vv,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function pH(e){if(!e)return bh;e=e._reactInternals;e:{if(xg(e)!==e||e.tag!==1)throw Error(tn(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(tn(171))}if(e.tag===1){var r=e.type;if(Vl(r))return pW(e,r,t)}return t}function gH(e,t,r,n,o,s,i,l,c){return e=Y3(r,n,!0,e,o,s,i,l,c),e.context=pH(null),r=e.current,n=xl(),o=rh(r),s=If(n,o),s.callback=t??null,eh(r,s,o),e.current.lanes=o,e1(e,o,n),Wl(e,n),e}function WS(e,t,r,n){var o=t.current,s=xl(),i=rh(o);return r=pH(r),t.context===null?t.context=r:t.pendingContext=r,t=If(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=eh(o,t,i),e!==null&&(ru(e,o,i,s),kj(e,o,i)),i}function P_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function pF(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function J3(e,t){pF(e,t),(e=e.alternate)&&pF(e,t)}function Ace(){return null}var vH=typeof reportError=="function"?reportError:function(e){console.error(e)};function Q3(e){this._internalRoot=e}HS.prototype.render=Q3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(tn(409));WS(e,t,null,null)};HS.prototype.unmount=Q3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Jp(function(){WS(null,e,null,null)}),t[Ff]=null}};function HS(e){this._internalRoot=e}HS.prototype.unstable_scheduleHydration=function(e){if(e){var t=KV();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Im.length&&t!==0&&t<Im[r].priority;r++);Im.splice(r,0,e),r===0&&YV(e)}};function Z3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function GS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function gF(){}function Ece(e,t,r,n,o){if(o){if(typeof n=="function"){var s=n;n=function(){var d=P_(i);s.call(d)}}var i=gH(t,n,e,0,null,!1,!1,"",gF);return e._reactRootContainer=i,e[Ff]=i.current,Eb(e.nodeType===8?e.parentNode:e),Jp(),i}for(;o=e.lastChild;)e.removeChild(o);if(typeof n=="function"){var l=n;n=function(){var d=P_(c);l.call(d)}}var c=Y3(e,0,!1,null,null,!1,!1,"",gF);return e._reactRootContainer=c,e[Ff]=c.current,Eb(e.nodeType===8?e.parentNode:e),Jp(function(){WS(t,c,r,n)}),c}function KS(e,t,r,n,o){var s=r._reactRootContainer;if(s){var i=s;if(typeof o=="function"){var l=o;o=function(){var c=P_(i);l.call(c)}}WS(t,i,e,o)}else i=Ece(r,t,e,o,n);return P_(i)}HV=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=_y(t.pendingLanes);r!==0&&(x3(t,r|1),Wl(t,ys()),!(Ya&6)&&(hx=ys()+500,Oh()))}break;case 13:Jp(function(){var n=$f(e,1);if(n!==null){var o=xl();ru(n,e,1,o)}}),J3(e,1)}};y3=function(e){if(e.tag===13){var t=$f(e,134217728);if(t!==null){var r=xl();ru(t,e,134217728,r)}J3(e,134217728)}};GV=function(e){if(e.tag===13){var t=rh(e),r=$f(e,t);if(r!==null){var n=xl();ru(r,e,t,n)}J3(e,t)}};KV=function(){return fo};XV=function(e,t){var r=fo;try{return fo=e,t()}finally{fo=r}};hk=function(e,t,r){switch(t){case"input":if(ik(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=FS(n);if(!o)throw Error(tn(90));CV(n),ik(n,o)}}}break;case"textarea":AV(e,r);break;case"select":t=r.value,t!=null&&qv(e,!!r.multiple,t,!1)}};MV=H3;RV=Jp;var kce={usingClientEntryPoint:!1,Events:[r1,jv,FS,TV,DV,H3]},X0={findFiberByHostInstance:vp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ice={bundleType:X0.bundleType,version:X0.version,rendererPackageName:X0.rendererPackageName,rendererConfig:X0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=$V(e),e===null?null:e.stateNode},findFiberByHostInstance:X0.findFiberByHostInstance||Ace,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var w2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!w2.isDisabled&&w2.supportsFiber)try{DS=w2.inject(Ice),Fu=w2}catch{}}Fc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kce;Fc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Z3(t))throw Error(tn(200));return Pce(e,t,null,r)};Fc.createRoot=function(e,t){if(!Z3(e))throw Error(tn(299));var r=!1,n="",o=vH;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Y3(e,1,!1,null,null,r,!1,n,o),e[Ff]=t.current,Eb(e.nodeType===8?e.parentNode:e),new Q3(t)};Fc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(tn(188)):(e=Object.keys(e).join(","),Error(tn(268,e)));return e=$V(t),e=e===null?null:e.stateNode,e};Fc.flushSync=function(e){return Jp(e)};Fc.hydrate=function(e,t,r){if(!GS(t))throw Error(tn(200));return KS(null,e,t,!0,r)};Fc.hydrateRoot=function(e,t,r){if(!Z3(e))throw Error(tn(405));var n=r!=null&&r.hydratedSources||null,o=!1,s="",i=vH;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=gH(t,null,e,1,r??null,o,!1,s,i),e[Ff]=t.current,Eb(e),n)for(e=0;e<n.length;e++)r=n[e],o=r._getVersion,o=o(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new HS(t)};Fc.render=function(e,t,r){if(!GS(t))throw Error(tn(200));return KS(null,e,t,!1,r)};Fc.unmountComponentAtNode=function(e){if(!GS(e))throw Error(tn(40));return e._reactRootContainer?(Jp(function(){KS(null,null,e,!1,function(){e._reactRootContainer=null,e[Ff]=null})}),!0):!1};Fc.unstable_batchedUpdates=H3;Fc.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!GS(r))throw Error(tn(200));if(e==null||e._reactInternals===void 0)throw Error(tn(38));return KS(e,t,r,!1,n)};Fc.version="18.3.1-next-f1338f8080-20240426";function xH(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xH)}catch(e){console.error(e)}}xH(),xV.exports=Fc;var Qf=xV.exports;const e4=Ga(Qf);var vF=Qf;ek.createRoot=vF.createRoot,ek.hydrateRoot=vF.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fb(){return Fb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fb.apply(this,arguments)}var Bm;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Bm||(Bm={}));const xF="popstate";function Oce(e){e===void 0&&(e={});function t(n,o){let{pathname:s,search:i,hash:l}=n.location;return Gk("",{pathname:s,search:i,hash:l},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(n,o){return typeof o=="string"?o:A_(o)}return Dce(t,r,null,e)}function as(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function yH(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Tce(){return Math.random().toString(36).substr(2,8)}function yF(e,t){return{usr:e.state,key:e.key,idx:t}}function Gk(e,t,r,n){return r===void 0&&(r=null),Fb({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?o0(t):t,{state:r,key:t&&t.key||n||Tce()})}function A_(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function o0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Dce(e,t,r,n){n===void 0&&(n={});let{window:o=document.defaultView,v5Compat:s=!1}=n,i=o.history,l=Bm.Pop,c=null,d=u();d==null&&(d=0,i.replaceState(Fb({},i.state,{idx:d}),""));function u(){return(i.state||{idx:null}).idx}function f(){l=Bm.Pop;let y=u(),x=y==null?null:y-d;d=y,c&&c({action:l,location:g.location,delta:x})}function h(y,x){l=Bm.Push;let b=Gk(g.location,y,x);r&&r(b,y),d=u()+1;let w=yF(b,d),j=g.createHref(b);try{i.pushState(w,"",j)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;o.location.assign(j)}s&&c&&c({action:l,location:g.location,delta:1})}function m(y,x){l=Bm.Replace;let b=Gk(g.location,y,x);r&&r(b,y),d=u();let w=yF(b,d),j=g.createHref(b);i.replaceState(w,"",j),s&&c&&c({action:l,location:g.location,delta:0})}function v(y){let x=o.location.origin!=="null"?o.location.origin:o.location.href,b=typeof y=="string"?y:A_(y);return b=b.replace(/ $/,"%20"),as(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let g={get action(){return l},get location(){return e(o,i)},listen(y){if(c)throw new Error("A history only accepts one active listener");return o.addEventListener(xF,f),c=y,()=>{o.removeEventListener(xF,f),c=null}},createHref(y){return t(o,y)},createURL:v,encodeLocation(y){let x=v(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:m,go(y){return i.go(y)}};return g}var bF;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(bF||(bF={}));function Mce(e,t,r){return r===void 0&&(r="/"),Rce(e,t,r,!1)}function Rce(e,t,r,n){let o=typeof t=="string"?o0(t):t,s=px(o.pathname||"/",r);if(s==null)return null;let i=bH(e);Lce(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let d=Kce(s);l=Hce(i[c],d,n)}return l}function bH(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let o=(s,i,l)=>{let c={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};c.relativePath.startsWith("/")&&(as(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=ah([n,c.relativePath]),u=r.concat(c);s.children&&s.children.length>0&&(as(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),bH(s.children,t,u,d)),!(s.path==null&&!s.index)&&t.push({path:d,score:Vce(d,s.index),routesMeta:u})};return e.forEach((s,i)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))o(s,i);else for(let c of wH(s.path))o(s,i,c)}),t}function wH(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,o=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return o?[s,""]:[s];let i=wH(n.join("/")),l=[];return l.push(...i.map(c=>c===""?s:[s,c].join("/"))),o&&l.push(...i),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function Lce(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Wce(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Fce=/^:[\w-]+$/,$ce=3,Bce=2,qce=1,zce=10,Uce=-2,wF=e=>e==="*";function Vce(e,t){let r=e.split("/"),n=r.length;return r.some(wF)&&(n+=Uce),t&&(n+=Bce),r.filter(o=>!wF(o)).reduce((o,s)=>o+(Fce.test(s)?$ce:s===""?qce:zce),n)}function Wce(e,t){return e.length===t.length&&e.slice(0,-1).every((n,o)=>n===t[o])?e[e.length-1]-t[t.length-1]:0}function Hce(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,o={},s="/",i=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=s==="/"?t:t.slice(s.length)||"/",f=E_({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),h=c.route;if(!f&&d&&r&&!n[n.length-1].route.index&&(f=E_({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!f)return null;Object.assign(o,f.params),i.push({params:o,pathname:ah([s,f.pathname]),pathnameBase:Qce(ah([s,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(s=ah([s,f.pathnameBase]))}return i}function E_(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Gce(e.path,e.caseSensitive,e.end),o=t.match(r);if(!o)return null;let s=o[0],i=s.replace(/(.)\/+$/,"$1"),l=o.slice(1);return{params:n.reduce((d,u,f)=>{let{paramName:h,isOptional:m}=u;if(h==="*"){let g=l[f]||"";i=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const v=l[f];return m&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:i,pattern:e}}function Gce(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),yH(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),n]}function Kce(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return yH(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function px(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Xce(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:o=""}=typeof e=="string"?o0(e):e;return{pathname:r?r.startsWith("/")?r:Yce(r,t):t,search:Zce(n),hash:ede(o)}}function Yce(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?r.length>1&&r.pop():o!=="."&&r.push(o)}),r.length>1?r.join("/"):"/"}function $P(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Jce(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function t4(e,t){let r=Jce(e);return t?r.map((n,o)=>o===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function r4(e,t,r,n){n===void 0&&(n=!1);let o;typeof e=="string"?o=o0(e):(o=Fb({},e),as(!o.pathname||!o.pathname.includes("?"),$P("?","pathname","search",o)),as(!o.pathname||!o.pathname.includes("#"),$P("#","pathname","hash",o)),as(!o.search||!o.search.includes("#"),$P("#","search","hash",o)));let s=e===""||o.pathname==="",i=s?"/":o.pathname,l;if(i==null)l=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),f-=1;o.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=Xce(o,l),d=i&&i!=="/"&&i.endsWith("/"),u=(s||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const ah=e=>e.join("/").replace(/\/\/+/g,"/"),Qce=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Zce=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ede=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function tde(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const jH=["post","put","patch","delete"];new Set(jH);const rde=["get",...jH];new Set(rde);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $b(){return $b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$b.apply(this,arguments)}const XS=p.createContext(null),_H=p.createContext(null),Zf=p.createContext(null),YS=p.createContext(null),em=p.createContext({outlet:null,matches:[],isDataRoute:!1}),NH=p.createContext(null);function nde(e,t){let{relative:r}=t===void 0?{}:t;s0()||as(!1);let{basename:n,navigator:o}=p.useContext(Zf),{hash:s,pathname:i,search:l}=JS(e,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:ah([n,i])),o.createHref({pathname:c,search:l,hash:s})}function s0(){return p.useContext(YS)!=null}function Ls(){return s0()||as(!1),p.useContext(YS).location}function SH(e){p.useContext(Zf).static||p.useLayoutEffect(e)}function Yi(){let{isDataRoute:e}=p.useContext(em);return e?vde():ade()}function ade(){s0()||as(!1);let e=p.useContext(XS),{basename:t,future:r,navigator:n}=p.useContext(Zf),{matches:o}=p.useContext(em),{pathname:s}=Ls(),i=JSON.stringify(t4(o,r.v7_relativeSplatPath)),l=p.useRef(!1);return SH(()=>{l.current=!0}),p.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let f=r4(d,JSON.parse(i),s,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:ah([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,i,s,e])}function ode(){let{matches:e}=p.useContext(em),t=e[e.length-1];return t?t.params:{}}function JS(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=p.useContext(Zf),{matches:o}=p.useContext(em),{pathname:s}=Ls(),i=JSON.stringify(t4(o,n.v7_relativeSplatPath));return p.useMemo(()=>r4(e,JSON.parse(i),s,r==="path"),[e,i,s,r])}function sde(e,t){return ide(e,t)}function ide(e,t,r,n){s0()||as(!1);let{navigator:o}=p.useContext(Zf),{matches:s}=p.useContext(em),i=s[s.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=Ls(),u;if(t){var f;let y=typeof t=="string"?o0(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||as(!1),u=y}else u=d;let h=u.pathname||"/",m=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=Mce(e,{pathname:m}),g=fde(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:ah([c,o.encodeLocation?o.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:ah([c,o.encodeLocation?o.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return t&&g?p.createElement(YS.Provider,{value:{location:$b({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Bm.Pop}},g):g}function lde(){let e=gde(),t=tde(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),r?p.createElement("pre",{style:o},r):null,s)}const cde=p.createElement(lde,null);class dde extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?p.createElement(em.Provider,{value:this.props.routeContext},p.createElement(NH.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ude(e){let{routeContext:t,match:r,children:n}=e,o=p.useContext(XS);return o&&o.static&&o.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=r.route.id),p.createElement(em.Provider,{value:t},n)}function fde(e,t,r,n){var o;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,l=(o=r)==null?void 0:o.errors;if(l!=null){let u=i.findIndex(f=>f.route.id&&l?.[f.route.id]!==void 0);u>=0||as(!1),i=i.slice(0,Math.min(i.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<i.length;u++){let f=i[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=u),f.route.id){let{loaderData:h,errors:m}=r,v=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||v){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((u,f,h)=>{let m,v=!1,g=null,y=null;r&&(m=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||cde,c&&(d<0&&h===0?(xde("route-fallback",!1),v=!0,y=null):d===h&&(v=!0,y=f.route.hydrateFallbackElement||null)));let x=t.concat(i.slice(0,h+1)),b=()=>{let w;return m?w=g:v?w=y:f.route.Component?w=p.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,p.createElement(ude,{match:f,routeContext:{outlet:u,matches:x,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?p.createElement(dde,{location:r.location,revalidation:r.revalidation,component:g,error:m,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var CH=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(CH||{}),k_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(k_||{});function mde(e){let t=p.useContext(XS);return t||as(!1),t}function hde(e){let t=p.useContext(_H);return t||as(!1),t}function pde(e){let t=p.useContext(em);return t||as(!1),t}function PH(e){let t=pde(),r=t.matches[t.matches.length-1];return r.route.id||as(!1),r.route.id}function gde(){var e;let t=p.useContext(NH),r=hde(k_.UseRouteError),n=PH(k_.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function vde(){let{router:e}=mde(CH.UseNavigateStable),t=PH(k_.UseNavigateStable),r=p.useRef(!1);return SH(()=>{r.current=!0}),p.useCallback(function(o,s){s===void 0&&(s={}),r.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,$b({fromRouteId:t},s)))},[e,t])}const jF={};function xde(e,t,r){!t&&!jF[e]&&(jF[e]=!0)}function yde(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function AH(e){let{to:t,replace:r,state:n,relative:o}=e;s0()||as(!1);let{future:s,static:i}=p.useContext(Zf),{matches:l}=p.useContext(em),{pathname:c}=Ls(),d=Yi(),u=r4(t,t4(l,s.v7_relativeSplatPath),c,o==="path"),f=JSON.stringify(u);return p.useEffect(()=>d(JSON.parse(f),{replace:r,state:n,relative:o}),[d,f,o,r,n]),null}function oo(e){as(!1)}function bde(e){let{basename:t="/",children:r=null,location:n,navigationType:o=Bm.Pop,navigator:s,static:i=!1,future:l}=e;s0()&&as(!1);let c=t.replace(/^\/*/,"/"),d=p.useMemo(()=>({basename:c,navigator:s,static:i,future:$b({v7_relativeSplatPath:!1},l)}),[c,l,s,i]);typeof n=="string"&&(n=o0(n));let{pathname:u="/",search:f="",hash:h="",state:m=null,key:v="default"}=n,g=p.useMemo(()=>{let y=px(u,c);return y==null?null:{location:{pathname:y,search:f,hash:h,state:m,key:v},navigationType:o}},[c,u,f,h,m,v,o]);return g==null?null:p.createElement(Zf.Provider,{value:d},p.createElement(YS.Provider,{children:r,value:g}))}function Lj(e){let{children:t,location:r}=e;return sde(Kk(t),r)}new Promise(()=>{});function Kk(e,t){t===void 0&&(t=[]);let r=[];return p.Children.forEach(e,(n,o)=>{if(!p.isValidElement(n))return;let s=[...t,o];if(n.type===p.Fragment){r.push.apply(r,Kk(n.props.children,s));return}n.type!==oo&&as(!1),!n.props.index||!n.props.children||as(!1);let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Kk(n.props.children,s)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function I_(){return I_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I_.apply(this,arguments)}function EH(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,s;for(s=0;s<n.length;s++)o=n[s],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function wde(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jde(e,t){return e.button===0&&(!t||t==="_self")&&!wde(e)}function Xk(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(o=>[r,o]):[[r,n]])},[]))}function _de(e,t){let r=Xk(e);return t&&t.forEach((n,o)=>{r.has(o)||t.getAll(o).forEach(s=>{r.append(o,s)})}),r}const Nde=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Sde=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Cde="6";try{window.__reactRouterVersion=Cde}catch{}const Pde=p.createContext({isTransitioning:!1}),Ade="startTransition",_F=c3[Ade];function Ede(e){let{basename:t,children:r,future:n,window:o}=e,s=p.useRef();s.current==null&&(s.current=Oce({window:o,v5Compat:!0}));let i=s.current,[l,c]=p.useState({action:i.action,location:i.location}),{v7_startTransition:d}=n||{},u=p.useCallback(f=>{d&&_F?_F(()=>c(f)):c(f)},[c,d]);return p.useLayoutEffect(()=>i.listen(u),[i,u]),p.useEffect(()=>yde(n),[n]),p.createElement(bde,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:i,future:n})}const kde=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ide=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,n4=p.forwardRef(function(t,r){let{onClick:n,relative:o,reloadDocument:s,replace:i,state:l,target:c,to:d,preventScrollReset:u,viewTransition:f}=t,h=EH(t,Nde),{basename:m}=p.useContext(Zf),v,g=!1;if(typeof d=="string"&&Ide.test(d)&&(v=d,kde))try{let w=new URL(window.location.href),j=d.startsWith("//")?new URL(w.protocol+d):new URL(d),_=px(j.pathname,m);j.origin===w.origin&&_!=null?d=_+j.search+j.hash:g=!0}catch{}let y=nde(d,{relative:o}),x=Tde(d,{replace:i,state:l,target:c,preventScrollReset:u,relative:o,viewTransition:f});function b(w){n&&n(w),w.defaultPrevented||x(w)}return p.createElement("a",I_({},h,{href:v||y,onClick:g||s?n:b,ref:r,target:c}))}),_u=p.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:o=!1,className:s="",end:i=!1,style:l,to:c,viewTransition:d,children:u}=t,f=EH(t,Sde),h=JS(c,{relative:f.relative}),m=Ls(),v=p.useContext(_H),{navigator:g,basename:y}=p.useContext(Zf),x=v!=null&&Dde(h)&&d===!0,b=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,w=m.pathname,j=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;o||(w=w.toLowerCase(),j=j?j.toLowerCase():null,b=b.toLowerCase()),j&&y&&(j=px(j,y)||j);const _=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let C=w===b||!i&&w.startsWith(b)&&w.charAt(_)==="/",E=j!=null&&(j===b||!i&&j.startsWith(b)&&j.charAt(b.length)==="/"),A={isActive:C,isPending:E,isTransitioning:x},P=C?n:void 0,F;typeof s=="function"?F=s(A):F=[s,C?"active":null,E?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let M=typeof l=="function"?l(A):l;return p.createElement(n4,I_({},f,{"aria-current":P,className:F,ref:r,style:M,to:c,viewTransition:d}),typeof u=="function"?u(A):u)});var Yk;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Yk||(Yk={}));var NF;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(NF||(NF={}));function Ode(e){let t=p.useContext(XS);return t||as(!1),t}function Tde(e,t){let{target:r,replace:n,state:o,preventScrollReset:s,relative:i,viewTransition:l}=t===void 0?{}:t,c=Yi(),d=Ls(),u=JS(e,{relative:i});return p.useCallback(f=>{if(jde(f,r)){f.preventDefault();let h=n!==void 0?n:A_(d)===A_(u);c(e,{replace:h,state:o,preventScrollReset:s,relative:i,viewTransition:l})}},[d,c,u,n,o,r,e,s,i,l])}function QS(e){let t=p.useRef(Xk(e)),r=p.useRef(!1),n=Ls(),o=p.useMemo(()=>_de(n.search,r.current?null:t.current),[n.search]),s=Yi(),i=p.useCallback((l,c)=>{const d=Xk(typeof l=="function"?l(o):l);r.current=!0,s("?"+d,c)},[s,o]);return[o,i]}function Dde(e,t){t===void 0&&(t={});let r=p.useContext(Pde);r==null&&as(!1);let{basename:n}=Ode(Yk.useViewTransitionState),o=JS(e,{relative:t.relative});if(!r.isTransitioning)return!1;let s=px(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=px(r.nextLocation.pathname,n)||r.nextLocation.pathname;return E_(o.pathname,i)!=null||E_(o.pathname,s)!=null}function kH(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=kH(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function pa(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=kH(e))&&(n&&(n+=" "),n+=t);return n}function Mde(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=IH(t))&&(n&&(n+=" "),n+=r);return n}function IH(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=IH(e[n]))&&(r&&(r+=" "),r+=t);return r}var a4="-";function Rde(e){var t=Fde(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,o=n===void 0?{}:n;function s(l){var c=l.split(a4);return c[0]===""&&c.length!==1&&c.shift(),OH(c,t)||Lde(l)}function i(l,c){var d=r[l]||[];return c&&o[l]?[].concat(d,o[l]):d}return{getClassGroupId:s,getConflictingClassGroupIds:i}}function OH(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),o=n?OH(e.slice(1),n):void 0;if(o)return o;if(t.validators.length!==0){var s=e.join(a4);return t.validators.find(function(i){var l=i.validator;return l(s)})?.classGroupId}}var SF=/^\[(.+)\]$/;function Lde(e){if(SF.test(e)){var t=SF.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function Fde(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},o=Bde(Object.entries(e.classGroups),r);return o.forEach(function(s){var i=s[0],l=s[1];Jk(l,n,i,t)}),n}function Jk(e,t,r,n){e.forEach(function(o){if(typeof o=="string"){var s=o===""?t:CF(t,o);s.classGroupId=r;return}if(typeof o=="function"){if($de(o)){Jk(o(n),t,r,n);return}t.validators.push({validator:o,classGroupId:r});return}Object.entries(o).forEach(function(i){var l=i[0],c=i[1];Jk(c,CF(t,l),r,n)})})}function CF(e,t){var r=e;return t.split(a4).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function $de(e){return e.isThemeGetter}function Bde(e,t){return t?e.map(function(r){var n=r[0],o=r[1],s=o.map(function(i){return typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(function(l){var c=l[0],d=l[1];return[t+c,d]})):i});return[n,s]}):e}function qde(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function o(s,i){r.set(s,i),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(i){var l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return o(i,l),l},set:function(i,l){r.has(i)?r.set(i,l):o(i,l)}}}var TH="!";function zde(e){var t=e.separator||":",r=t.length===1,n=t[0],o=t.length;return function(i){for(var l=[],c=0,d=0,u,f=0;f<i.length;f++){var h=i[f];if(c===0){if(h===n&&(r||i.slice(f,f+o)===t)){l.push(i.slice(d,f)),d=f+o;continue}if(h==="/"){u=f;continue}}h==="["?c++:h==="]"&&c--}var m=l.length===0?i:i.substring(d),v=m.startsWith(TH),g=v?m.substring(1):m,y=u&&u>d?u-d:void 0;return{modifiers:l,hasImportantModifier:v,baseClassName:g,maybePostfixModifierPosition:y}}}function Ude(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var o=n[0]==="[";o?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function Vde(e){return{cache:qde(e.cacheSize),splitModifiers:zde(e),...Rde(e)}}var Wde=/\s+/;function Hde(e,t){var r=t.splitModifiers,n=t.getClassGroupId,o=t.getConflictingClassGroupIds,s=new Set;return e.trim().split(Wde).map(function(i){var l=r(i),c=l.modifiers,d=l.hasImportantModifier,u=l.baseClassName,f=l.maybePostfixModifierPosition,h=n(f?u.substring(0,f):u),m=!!f;if(!h){if(!f)return{isTailwindClass:!1,originalClassName:i};if(h=n(u),!h)return{isTailwindClass:!1,originalClassName:i};m=!1}var v=Ude(c).join(":"),g=d?v+TH:v;return{isTailwindClass:!0,modifierId:g,classGroupId:h,originalClassName:i,hasPostfixModifier:m}}).reverse().filter(function(i){if(!i.isTailwindClass)return!0;var l=i.modifierId,c=i.classGroupId,d=i.hasPostfixModifier,u=l+c;return s.has(u)?!1:(s.add(u),o(c,d).forEach(function(f){return s.add(l+f)}),!0)}).reverse().map(function(i){return i.originalClassName}).join(" ")}function Gde(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,o,s,i=l;function l(d){var u=t[0],f=t.slice(1),h=f.reduce(function(m,v){return v(m)},u());return n=Vde(h),o=n.cache.get,s=n.cache.set,i=c,c(d)}function c(d){var u=o(d);if(u)return u;var f=Hde(d,n);return s(d,f),f}return function(){return i(Mde.apply(null,arguments))}}function $o(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var DH=/^\[(?:([a-z-]+):)?(.+)\]$/i,Kde=/^\d+\/\d+$/,Xde=new Set(["px","full","screen"]),Yde=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Jde=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Qde=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Fd(e){return bp(e)||Xde.has(e)||Kde.test(e)||Qk(e)}function Qk(e){return yg(e,"length",aue)}function Zde(e){return yg(e,"size",MH)}function eue(e){return yg(e,"position",MH)}function tue(e){return yg(e,"url",oue)}function j2(e){return yg(e,"number",bp)}function bp(e){return!Number.isNaN(Number(e))}function rue(e){return e.endsWith("%")&&bp(e.slice(0,-1))}function Y0(e){return PF(e)||yg(e,"number",PF)}function Ra(e){return DH.test(e)}function J0(){return!0}function hm(e){return Yde.test(e)}function nue(e){return yg(e,"",sue)}function yg(e,t,r){var n=DH.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function aue(e){return Jde.test(e)}function MH(){return!1}function oue(e){return e.startsWith("url(")}function PF(e){return Number.isInteger(Number(e))}function sue(e){return Qde.test(e)}function iue(){var e=$o("colors"),t=$o("spacing"),r=$o("blur"),n=$o("brightness"),o=$o("borderColor"),s=$o("borderRadius"),i=$o("borderSpacing"),l=$o("borderWidth"),c=$o("contrast"),d=$o("grayscale"),u=$o("hueRotate"),f=$o("invert"),h=$o("gap"),m=$o("gradientColorStops"),v=$o("gradientColorStopPositions"),g=$o("inset"),y=$o("margin"),x=$o("opacity"),b=$o("padding"),w=$o("saturate"),j=$o("scale"),_=$o("sepia"),C=$o("skew"),E=$o("space"),A=$o("translate"),P=function(){return["auto","contain","none"]},F=function(){return["auto","hidden","clip","visible","scroll"]},M=function(){return["auto",Ra,t]},I=function(){return[Ra,t]},R=function(){return["",Fd]},D=function(){return["auto",bp,Ra]},U=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},z=function(){return["solid","dashed","dotted","double","none"]},H=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},q=function(){return["start","end","center","between","around","evenly","stretch"]},Q=function(){return["","0",Ra]},pe=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},be=function(){return[bp,j2]},V=function(){return[bp,Ra]};return{cacheSize:500,theme:{colors:[J0],spacing:[Fd],blur:["none","",hm,Ra],brightness:be(),borderColor:[e],borderRadius:["none","","full",hm,Ra],borderSpacing:I(),borderWidth:R(),contrast:be(),grayscale:Q(),hueRotate:V(),invert:Q(),gap:I(),gradientColorStops:[e],gradientColorStopPositions:[rue,Qk],inset:M(),margin:M(),opacity:be(),padding:I(),saturate:be(),scale:be(),sepia:Q(),skew:V(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",Ra]}],container:["container"],columns:[{columns:[hm]}],"break-after":[{"break-after":pe()}],"break-before":[{"break-before":pe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(U(),[Ra])}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Y0]}],basis:[{basis:M()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ra]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",Y0]}],"grid-cols":[{"grid-cols":[J0]}],"col-start-end":[{col:["auto",{span:["full",Y0]},Ra]}],"col-start":[{"col-start":D()}],"col-end":[{"col-end":D()}],"grid-rows":[{"grid-rows":[J0]}],"row-start-end":[{row:["auto",{span:[Y0]},Ra]}],"row-start":[{"row-start":D()}],"row-end":[{"row-end":D()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ra]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ra]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat(q())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(q(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(q(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Ra,t]}],"min-w":[{"min-w":["min","max","fit",Ra,Fd]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[hm]},hm,Ra]}],h:[{h:[Ra,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Ra,Fd]}],"max-h":[{"max-h":[Ra,t,"min","max","fit"]}],"font-size":[{text:["base",hm,Qk]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",j2]}],"font-family":[{font:[J0]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ra]}],"line-clamp":[{"line-clamp":["none",bp,j2]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ra,Fd]}],"list-image":[{"list-image":["none",Ra]}],"list-style-type":[{list:["none","disc","decimal",Ra]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(z(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Fd]}],"underline-offset":[{"underline-offset":["auto",Ra,Fd]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ra]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ra]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(U(),[eue])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Zde]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},tue]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[].concat(z(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:z()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:[""].concat(z())}],"outline-offset":[{"outline-offset":[Ra,Fd]}],"outline-w":[{outline:[Fd]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:R()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Fd]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",hm,nue]}],"shadow-color":[{shadow:[J0]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":H()}],"bg-blend":[{"bg-blend":H()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",hm,Ra]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ra]}],duration:[{duration:V()}],ease:[{ease:["linear","in","out","in-out",Ra]}],delay:[{delay:V()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ra]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[Y0,Ra]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ra]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ra]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ra]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Fd,j2]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var lue=Gde(iue);function mr(...e){return lue(pa(e))}const AF=["#3B82F6","#22C55E","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F43F5E","#10B981","#A855F7","#EAB308"];function cue(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return Math.abs(t)}function Am(e){if(!e)return"#94A3B8";const t=cue(String(e))%AF.length;return AF[t]}var due={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const uue=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Wr=(e,t)=>{const r=p.forwardRef(({color:n="currentColor",size:o=24,strokeWidth:s=2,absoluteStrokeWidth:i,children:l,...c},d)=>p.createElement("svg",{ref:d,...due,width:o,height:o,stroke:n,strokeWidth:i?Number(s)*24/Number(o):s,className:`lucide lucide-${uue(e)}`,...c},[...t.map(([u,f])=>p.createElement(u,f)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${e}`,r},Ac=Wr("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),qf=Wr("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),fue=Wr("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),qy=Wr("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),_2=Wr("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),o4=Wr("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),s4=Wr("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),i4=Wr("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),BP=Wr("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),O_=Wr("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),RH=Wr("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),mue=Wr("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]),T_=Wr("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),hue=Wr("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),l4=Wr("CalendarCheck",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),pue=Wr("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),c4=Wr("CalendarPlus",[["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"19",x2:"19",y1:"16",y2:"22",key:"1ttwzi"}],["line",{x1:"16",x2:"22",y1:"19",y2:"19",key:"1g9955"}]]),Fj=Wr("CalendarX",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"10",x2:"14",y1:"14",y2:"18",key:"1g3qc0"}],["line",{x1:"14",x2:"10",y1:"14",y2:"18",key:"1az83m"}]]),Ns=Wr("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),N2=Wr("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ds=Wr("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),zf=Wr("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),i0=Wr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),LH=Wr("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),l0=Wr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),gue=Wr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),vue=Wr("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]),xue=Wr("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),yue=Wr("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]),vd=Wr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),FH=Wr("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),qm=Wr("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Ks=Wr("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ms=Wr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Mp=Wr("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Qp=Wr("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Lg=Wr("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),Gs=Wr("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Zk=Wr("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),bue=Wr("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),wue=Wr("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),jue=Wr("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),_ue=Wr("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),Nue=Wr("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Sue=Wr("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),Cue=Wr("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),$H=Wr("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Pue=Wr("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",key:"1kog09"}]]),Aue=Wr("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),Eue=Wr("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),BH=Wr("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),qH=Wr("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),kue=Wr("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),zm=Wr("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),gx=Wr("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Iue=Wr("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),Oue=Wr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),vx=Wr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),EF=Wr("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Tue=Wr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),qP=Wr("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Due=Wr("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),kF=Wr("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Ev=Wr("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Mue=Wr("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),IF=Wr("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),_d=Wr("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),fl=Wr("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Bb=Wr("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),zH=Wr("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),ro=Wr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),UH=Wr("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Rp=Wr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),OF=Wr("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Rue=Wr("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),ts=Wr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),d4=Wr("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Of=Wr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),TF=Wr("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),Lue=Wr("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Gv=Wr("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),a1=Wr("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),DF=Wr("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),zP=Wr("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),eI=Wr("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Fue=Wr("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),u4=Wr("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),S2=Wr("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Bu=Wr("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),$ue=Wr("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Zp=Wr("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),jc=Wr("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Bue=Wr("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),VH=Wr("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),f4=Wr("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),que=Wr("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),zue=Wr("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),Uue=Wr("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),WH=Wr("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Ou=Wr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ml=Wr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),HH=Wr("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),zy=Wr("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),yl=Wr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),xd=({size:e="md",variant:t="header",className:r=""})=>{const n={xs:"w-8 h-8",sm:"w-10 h-10",md:"w-14 h-14",lg:"w-20 h-20",xl:"w-24 h-24"},o={header:"/isis-profile.png",message:"/isis-profile-baloon.png"},s=o[t]||o.header,i=e==="lg"?"scale-125":e==="md"?"scale-110":"scale-100";return a.jsx("div",{className:`${n[e]||n.md} rounded-full overflow-hidden flex-shrink-0 ring-2 ring-brand ring-offset-0 ${r}`,children:a.jsx("img",{src:s,alt:"Assistente Virtual",className:`w-full h-full object-cover ${i}`,onError:l=>{l.target.style.display="none",l.target.parentElement.innerHTML=`
            <div class="w-full h-full bg-brand flex items-center justify-center">
              <span class="text-bg font-bold text-lg">A</span>
            </div>
          `}})})},GH=p.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),ZS=p.createContext({}),eC=p.createContext(null),tC=typeof document<"u",m4=tC?p.useLayoutEffect:p.useEffect,KH=p.createContext({strict:!1}),h4=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Vue="framerAppearId",XH="data-"+h4(Vue);function Wue(e,t,r,n){const{visualElement:o}=p.useContext(ZS),s=p.useContext(KH),i=p.useContext(eC),l=p.useContext(GH).reducedMotion,c=p.useRef();n=n||s.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:o,props:r,presenceContext:i,blockInitialAnimation:i?i.initial===!1:!1,reducedMotionConfig:l}));const d=c.current;p.useInsertionEffect(()=>{d&&d.update(r,i)});const u=p.useRef(!!(r[XH]&&!window.HandoffComplete));return m4(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),p.useEffect(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}function kv(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Hue(e,t,r){return p.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):kv(r)&&(r.current=n))},[t])}function qb(e){return typeof e=="string"||Array.isArray(e)}function rC(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const p4=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],g4=["initial",...p4];function nC(e){return rC(e.animate)||g4.some(t=>qb(e[t]))}function YH(e){return!!(nC(e)||e.variants)}function Gue(e,t){if(nC(e)){const{initial:r,animate:n}=e;return{initial:r===!1||qb(r)?r:void 0,animate:qb(n)?n:void 0}}return e.inherit!==!1?t:{}}function Kue(e){const{initial:t,animate:r}=Gue(e,p.useContext(ZS));return p.useMemo(()=>({initial:t,animate:r}),[MF(t),MF(r)])}function MF(e){return Array.isArray(e)?e.join(" "):e}const RF={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},zb={};for(const e in RF)zb[e]={isEnabled:t=>RF[e].some(r=>!!t[r])};function Xue(e){for(const t in e)zb[t]={...zb[t],...e[t]}}const v4=p.createContext({}),JH=p.createContext({}),Yue=Symbol.for("motionComponentSymbol");function Jue({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:o}){e&&Xue(e);function s(l,c){let d;const u={...p.useContext(GH),...l,layoutId:Que(l)},{isStatic:f}=u,h=Kue(l),m=n(l,f);if(!f&&tC){h.visualElement=Wue(o,m,u,t);const v=p.useContext(JH),g=p.useContext(KH).strict;h.visualElement&&(d=h.visualElement.loadFeatures(u,g,e,v))}return p.createElement(ZS.Provider,{value:h},d&&h.visualElement?p.createElement(d,{visualElement:h.visualElement,...u}):null,r(o,l,Hue(m,h.visualElement,c),m,f,h.visualElement))}const i=p.forwardRef(s);return i[Yue]=o,i}function Que({layoutId:e}){const t=p.useContext(v4).id;return t&&e!==void 0?t+"-"+e:e}function Zue(e){function t(n,o={}){return Jue(e(n,o))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,o)=>(r.has(o)||r.set(o,t(o)),r.get(o))})}const efe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function x4(e){return typeof e!="string"||e.includes("-")?!1:!!(efe.indexOf(e)>-1||/[A-Z]/.test(e))}const D_={};function tfe(e){Object.assign(D_,e)}const o1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],bg=new Set(o1);function QH(e,{layout:t,layoutId:r}){return bg.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!D_[e]||e==="opacity")}const Xl=e=>!!(e&&e.getVelocity),rfe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},nfe=o1.length;function afe(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,o){let s="";for(let i=0;i<nfe;i++){const l=o1[i];if(e[l]!==void 0){const c=rfe[l]||l;s+=`${c}(${e[l]}) `}}return t&&!e.z&&(s+="translateZ(0)"),s=s.trim(),o?s=o(e,n?"":s):r&&n&&(s="none"),s}const ZH=e=>t=>typeof t=="string"&&t.startsWith(e),eG=ZH("--"),tI=ZH("var(--"),ofe=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,sfe=(e,t)=>t&&typeof e=="number"?t.transform(e):e,wh=(e,t,r)=>Math.min(Math.max(r,e),t),wg={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Uy={...wg,transform:e=>wh(0,1,e)},C2={...wg,default:1},Vy=e=>Math.round(e*1e5)/1e5,aC=/(-)?([\d]*\.?[\d])+/g,tG=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,ife=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function s1(e){return typeof e=="string"}const i1=e=>({test:t=>s1(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),jm=i1("deg"),qu=i1("%"),ia=i1("px"),lfe=i1("vh"),cfe=i1("vw"),LF={...qu,parse:e=>qu.parse(e)/100,transform:e=>qu.transform(e*100)},FF={...wg,transform:Math.round},rG={borderWidth:ia,borderTopWidth:ia,borderRightWidth:ia,borderBottomWidth:ia,borderLeftWidth:ia,borderRadius:ia,radius:ia,borderTopLeftRadius:ia,borderTopRightRadius:ia,borderBottomRightRadius:ia,borderBottomLeftRadius:ia,width:ia,maxWidth:ia,height:ia,maxHeight:ia,size:ia,top:ia,right:ia,bottom:ia,left:ia,padding:ia,paddingTop:ia,paddingRight:ia,paddingBottom:ia,paddingLeft:ia,margin:ia,marginTop:ia,marginRight:ia,marginBottom:ia,marginLeft:ia,rotate:jm,rotateX:jm,rotateY:jm,rotateZ:jm,scale:C2,scaleX:C2,scaleY:C2,scaleZ:C2,skew:jm,skewX:jm,skewY:jm,distance:ia,translateX:ia,translateY:ia,translateZ:ia,x:ia,y:ia,z:ia,perspective:ia,transformPerspective:ia,opacity:Uy,originX:LF,originY:LF,originZ:ia,zIndex:FF,fillOpacity:Uy,strokeOpacity:Uy,numOctaves:FF};function y4(e,t,r,n){const{style:o,vars:s,transform:i,transformOrigin:l}=e;let c=!1,d=!1,u=!0;for(const f in t){const h=t[f];if(eG(f)){s[f]=h;continue}const m=rG[f],v=sfe(h,m);if(bg.has(f)){if(c=!0,i[f]=v,!u)continue;h!==(m.default||0)&&(u=!1)}else f.startsWith("origin")?(d=!0,l[f]=v):o[f]=v}if(t.transform||(c||n?o.transform=afe(e.transform,r,u,n):o.transform&&(o.transform="none")),d){const{originX:f="50%",originY:h="50%",originZ:m=0}=l;o.transformOrigin=`${f} ${h} ${m}`}}const b4=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function nG(e,t,r){for(const n in t)!Xl(t[n])&&!QH(n,r)&&(e[n]=t[n])}function dfe({transformTemplate:e},t,r){return p.useMemo(()=>{const n=b4();return y4(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function ufe(e,t,r){const n=e.style||{},o={};return nG(o,n,e),Object.assign(o,dfe(e,t,r)),e.transformValues?e.transformValues(o):o}function ffe(e,t,r){const n={},o=ufe(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=o,n}const mfe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function M_(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||mfe.has(e)}let aG=e=>!M_(e);function hfe(e){e&&(aG=t=>t.startsWith("on")?!M_(t):e(t))}try{hfe(require("@emotion/is-prop-valid").default)}catch{}function pfe(e,t,r){const n={};for(const o in e)o==="values"&&typeof e.values=="object"||(aG(o)||r===!0&&M_(o)||!t&&!M_(o)||e.draggable&&o.startsWith("onDrag"))&&(n[o]=e[o]);return n}function $F(e,t,r){return typeof e=="string"?e:ia.transform(t+r*e)}function gfe(e,t,r){const n=$F(t,e.x,e.width),o=$F(r,e.y,e.height);return`${n} ${o}`}const vfe={offset:"stroke-dashoffset",array:"stroke-dasharray"},xfe={offset:"strokeDashoffset",array:"strokeDasharray"};function yfe(e,t,r=1,n=0,o=!0){e.pathLength=1;const s=o?vfe:xfe;e[s.offset]=ia.transform(-n);const i=ia.transform(t),l=ia.transform(r);e[s.array]=`${i} ${l}`}function w4(e,{attrX:t,attrY:r,attrScale:n,originX:o,originY:s,pathLength:i,pathSpacing:l=1,pathOffset:c=0,...d},u,f,h){if(y4(e,d,u,h),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:m,style:v,dimensions:g}=e;m.transform&&(g&&(v.transform=m.transform),delete m.transform),g&&(o!==void 0||s!==void 0||v.transform)&&(v.transformOrigin=gfe(g,o!==void 0?o:.5,s!==void 0?s:.5)),t!==void 0&&(m.x=t),r!==void 0&&(m.y=r),n!==void 0&&(m.scale=n),i!==void 0&&yfe(m,i,l,c,!1)}const oG=()=>({...b4(),attrs:{}}),j4=e=>typeof e=="string"&&e.toLowerCase()==="svg";function bfe(e,t,r,n){const o=p.useMemo(()=>{const s=oG();return w4(s,t,{enableHardwareAcceleration:!1},j4(n),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};nG(s,e.style,e),o.style={...s,...o.style}}return o}function wfe(e=!1){return(r,n,o,{latestValues:s},i)=>{const c=(x4(r)?bfe:ffe)(n,s,i,r),u={...pfe(n,typeof r=="string",e),...c,ref:o},{children:f}=n,h=p.useMemo(()=>Xl(f)?f.get():f,[f]);return p.createElement(r,{...u,children:h})}}function sG(e,{style:t,vars:r},n,o){Object.assign(e.style,t,o&&o.getProjectionStyles(n));for(const s in r)e.style.setProperty(s,r[s])}const iG=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function lG(e,t,r,n){sG(e,t,void 0,n);for(const o in t.attrs)e.setAttribute(iG.has(o)?o:h4(o),t.attrs[o])}function _4(e,t){const{style:r}=e,n={};for(const o in r)(Xl(r[o])||t.style&&Xl(t.style[o])||QH(o,e))&&(n[o]=r[o]);return n}function cG(e,t){const r=_4(e,t);for(const n in e)if(Xl(e[n])||Xl(t[n])){const o=o1.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[o]=e[n]}return r}function N4(e,t,r,n={},o={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,o)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,o)),t}function dG(e){const t=p.useRef(null);return t.current===null&&(t.current=e()),t.current}const R_=e=>Array.isArray(e),jfe=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),_fe=e=>R_(e)?e[e.length-1]||0:e;function $j(e){const t=Xl(e)?e.get():e;return jfe(t)?t.toValue():t}function Nfe({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,o,s){const i={latestValues:Sfe(n,o,s,e),renderState:t()};return r&&(i.mount=l=>r(n,l,i)),i}const uG=e=>(t,r)=>{const n=p.useContext(ZS),o=p.useContext(eC),s=()=>Nfe(e,t,n,o);return r?s():dG(s)};function Sfe(e,t,r,n){const o={},s=n(e,{});for(const h in s)o[h]=$j(s[h]);let{initial:i,animate:l}=e;const c=nC(e),d=YH(e);t&&d&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),l===void 0&&(l=t.animate));let u=r?r.initial===!1:!1;u=u||i===!1;const f=u?l:i;return f&&typeof f!="boolean"&&!rC(f)&&(Array.isArray(f)?f:[f]).forEach(m=>{const v=N4(e,m);if(!v)return;const{transitionEnd:g,transition:y,...x}=v;for(const b in x){let w=x[b];if(Array.isArray(w)){const j=u?w.length-1:0;w=w[j]}w!==null&&(o[b]=w)}for(const b in g)o[b]=g[b]}),o}const ps=e=>e;class BF{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function Cfe(e){let t=new BF,r=new BF,n=0,o=!1,s=!1;const i=new WeakSet,l={schedule:(c,d=!1,u=!1)=>{const f=u&&o,h=f?t:r;return d&&i.add(c),h.add(c)&&f&&o&&(n=t.order.length),c},cancel:c=>{r.remove(c),i.delete(c)},process:c=>{if(o){s=!0;return}if(o=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let d=0;d<n;d++){const u=t.order[d];u(c),i.has(u)&&(l.schedule(u),e())}o=!1,s&&(s=!1,l.process(c))}};return l}const P2=["prepare","read","update","preRender","render","postRender"],Pfe=40;function Afe(e,t){let r=!1,n=!0;const o={delta:0,timestamp:0,isProcessing:!1},s=P2.reduce((f,h)=>(f[h]=Cfe(()=>r=!0),f),{}),i=f=>s[f].process(o),l=()=>{const f=performance.now();r=!1,o.delta=n?1e3/60:Math.max(Math.min(f-o.timestamp,Pfe),1),o.timestamp=f,o.isProcessing=!0,P2.forEach(i),o.isProcessing=!1,r&&t&&(n=!1,e(l))},c=()=>{r=!0,n=!0,o.isProcessing||e(l)};return{schedule:P2.reduce((f,h)=>{const m=s[h];return f[h]=(v,g=!1,y=!1)=>(r||c(),m.schedule(v,g,y)),f},{}),cancel:f=>P2.forEach(h=>s[h].cancel(f)),state:o,steps:s}}const{schedule:To,cancel:Uf,state:Ui,steps:UP}=Afe(typeof requestAnimationFrame<"u"?requestAnimationFrame:ps,!0),Efe={useVisualState:uG({scrapeMotionValuesFromProps:cG,createRenderState:oG,onMount:(e,t,{renderState:r,latestValues:n})=>{To.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),To.render(()=>{w4(r,n,{enableHardwareAcceleration:!1},j4(t.tagName),e.transformTemplate),lG(t,r)})}})},kfe={useVisualState:uG({scrapeMotionValuesFromProps:_4,createRenderState:b4})};function Ife(e,{forwardMotionProps:t=!1},r,n){return{...x4(e)?Efe:kfe,preloadedFeatures:r,useRender:wfe(t),createVisualElement:n,Component:e}}function Cf(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const fG=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function oC(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const Ofe=e=>t=>fG(t)&&e(t,oC(t));function Tf(e,t,r,n){return Cf(e,t,Ofe(r),n)}const Tfe=(e,t)=>r=>t(e(r)),oh=(...e)=>e.reduce(Tfe);function mG(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const qF=mG("dragHorizontal"),zF=mG("dragVertical");function hG(e){let t=!1;if(e==="y")t=zF();else if(e==="x")t=qF();else{const r=qF(),n=zF();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function pG(){const e=hG(!0);return e?(e(),!1):!0}class Th{constructor(t){this.isMounted=!1,this.node=t}update(){}}function UF(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),o=(s,i)=>{if(s.pointerType==="touch"||pG())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&To.update(()=>l[n](s,i))};return Tf(e.current,r,o,{passive:!e.getProps()[n]})}class Dfe extends Th{mount(){this.unmount=oh(UF(this.node,!0),UF(this.node,!1))}unmount(){}}class Mfe extends Th{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=oh(Cf(this.node.current,"focus",()=>this.onFocus()),Cf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const gG=(e,t)=>t?e===t?!0:gG(e,t.parentElement):!1;function VP(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,oC(r))}class Rfe extends Th{constructor(){super(...arguments),this.removeStartListeners=ps,this.removeEndListeners=ps,this.removeAccessibleListeners=ps,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),s=Tf(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:f}=this.node.getProps();To.update(()=>{!f&&!gG(this.node.current,l.target)?u&&u(l,c):d&&d(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),i=Tf(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=oh(s,i),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=s=>{if(s.key!=="Enter"||this.isPressing)return;const i=l=>{l.key!=="Enter"||!this.checkPressEnd()||VP("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&To.update(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=Cf(this.node.current,"keyup",i),VP("down",(l,c)=>{this.startPress(l,c)})},r=Cf(this.node.current,"keydown",t),n=()=>{this.isPressing&&VP("cancel",(s,i)=>this.cancelPress(s,i))},o=Cf(this.node.current,"blur",n);this.removeAccessibleListeners=oh(r,o)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:o}=this.node.getProps();o&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&To.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!pG()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&To.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=Tf(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Cf(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=oh(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const rI=new WeakMap,WP=new WeakMap,Lfe=e=>{const t=rI.get(e.target);t&&t(e)},Ffe=e=>{e.forEach(Lfe)};function $fe({root:e,...t}){const r=e||document;WP.has(r)||WP.set(r,{});const n=WP.get(r),o=JSON.stringify(t);return n[o]||(n[o]=new IntersectionObserver(Ffe,{root:e,...t})),n[o]}function Bfe(e,t,r){const n=$fe(t);return rI.set(e,r),n.observe(e),()=>{rI.delete(e),n.unobserve(e)}}const qfe={some:0,all:1};class zfe extends Th{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:o="some",once:s}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof o=="number"?o:qfe[o]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,s&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),h=d?u:f;h&&h(c)};return Bfe(this.node.current,i,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(Ufe(t,r))&&this.startObserver()}unmount(){}}function Ufe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const Vfe={inView:{Feature:zfe},tap:{Feature:Rfe},focus:{Feature:Mfe},hover:{Feature:Dfe}};function vG(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Wfe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function Hfe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function sC(e,t,r){const n=e.getProps();return N4(n,t,r!==void 0?r:n.custom,Wfe(e),Hfe(e))}let Gfe=ps,S4=ps;const sh=e=>e*1e3,Df=e=>e/1e3,Kfe={current:!1},xG=e=>Array.isArray(e)&&typeof e[0]=="number";function yG(e){return!!(!e||typeof e=="string"&&bG[e]||xG(e)||Array.isArray(e)&&e.every(yG))}const Sy=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,bG={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Sy([0,.65,.55,1]),circOut:Sy([.55,0,1,.45]),backIn:Sy([.31,.01,.66,-.59]),backOut:Sy([.33,1.53,.69,.99])};function wG(e){if(e)return xG(e)?Sy(e):Array.isArray(e)?e.map(wG):bG[e]}function Xfe(e,t,r,{delay:n=0,duration:o,repeat:s=0,repeatType:i="loop",ease:l,times:c}={}){const d={[t]:r};c&&(d.offset=c);const u=wG(l);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:o,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:i==="reverse"?"alternate":"normal"})}function Yfe(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const jG=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Jfe=1e-7,Qfe=12;function Zfe(e,t,r,n,o){let s,i,l=0;do i=t+(r-t)/2,s=jG(i,n,o)-e,s>0?r=i:t=i;while(Math.abs(s)>Jfe&&++l<Qfe);return i}function l1(e,t,r,n){if(e===t&&r===n)return ps;const o=s=>Zfe(s,0,1,e,r);return s=>s===0||s===1?s:jG(o(s),t,n)}const eme=l1(.42,0,1,1),tme=l1(0,0,.58,1),_G=l1(.42,0,.58,1),rme=e=>Array.isArray(e)&&typeof e[0]!="number",NG=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,SG=e=>t=>1-e(1-t),C4=e=>1-Math.sin(Math.acos(e)),CG=SG(C4),nme=NG(C4),PG=l1(.33,1.53,.69,.99),P4=SG(PG),ame=NG(P4),ome=e=>(e*=2)<1?.5*P4(e):.5*(2-Math.pow(2,-10*(e-1))),sme={linear:ps,easeIn:eme,easeInOut:_G,easeOut:tme,circIn:C4,circInOut:nme,circOut:CG,backIn:P4,backInOut:ame,backOut:PG,anticipate:ome},VF=e=>{if(Array.isArray(e)){S4(e.length===4);const[t,r,n,o]=e;return l1(t,r,n,o)}else if(typeof e=="string")return sme[e];return e},A4=(e,t)=>r=>!!(s1(r)&&ife.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),AG=(e,t,r)=>n=>{if(!s1(n))return n;const[o,s,i,l]=n.match(aC);return{[e]:parseFloat(o),[t]:parseFloat(s),[r]:parseFloat(i),alpha:l!==void 0?parseFloat(l):1}},ime=e=>wh(0,255,e),HP={...wg,transform:e=>Math.round(ime(e))},wp={test:A4("rgb","red"),parse:AG("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+HP.transform(e)+", "+HP.transform(t)+", "+HP.transform(r)+", "+Vy(Uy.transform(n))+")"};function lme(e){let t="",r="",n="",o="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),o=e.substring(4,5),t+=t,r+=r,n+=n,o+=o),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:o?parseInt(o,16)/255:1}}const nI={test:A4("#"),parse:lme,transform:wp.transform},Iv={test:A4("hsl","hue"),parse:AG("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+qu.transform(Vy(t))+", "+qu.transform(Vy(r))+", "+Vy(Uy.transform(n))+")"},ll={test:e=>wp.test(e)||nI.test(e)||Iv.test(e),parse:e=>wp.test(e)?wp.parse(e):Iv.test(e)?Iv.parse(e):nI.parse(e),transform:e=>s1(e)?e:e.hasOwnProperty("red")?wp.transform(e):Iv.transform(e)},rs=(e,t,r)=>-r*e+r*t+e;function GP(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function cme({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let o=0,s=0,i=0;if(!t)o=s=i=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;o=GP(c,l,e+1/3),s=GP(c,l,e),i=GP(c,l,e-1/3)}return{red:Math.round(o*255),green:Math.round(s*255),blue:Math.round(i*255),alpha:n}}const KP=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},dme=[nI,wp,Iv],ume=e=>dme.find(t=>t.test(e));function WF(e){const t=ume(e);let r=t.parse(e);return t===Iv&&(r=cme(r)),r}const EG=(e,t)=>{const r=WF(e),n=WF(t),o={...r};return s=>(o.red=KP(r.red,n.red,s),o.green=KP(r.green,n.green,s),o.blue=KP(r.blue,n.blue,s),o.alpha=rs(r.alpha,n.alpha,s),wp.transform(o))};function fme(e){var t,r;return isNaN(e)&&s1(e)&&(((t=e.match(aC))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(tG))===null||r===void 0?void 0:r.length)||0)>0}const kG={regex:ofe,countKey:"Vars",token:"${v}",parse:ps},IG={regex:tG,countKey:"Colors",token:"${c}",parse:ll.parse},OG={regex:aC,countKey:"Numbers",token:"${n}",parse:wg.parse};function XP(e,{regex:t,countKey:r,token:n,parse:o}){const s=e.tokenised.match(t);s&&(e["num"+r]=s.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...s.map(o)))}function L_(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&XP(r,kG),XP(r,IG),XP(r,OG),r}function TG(e){return L_(e).values}function DG(e){const{values:t,numColors:r,numVars:n,tokenised:o}=L_(e),s=t.length;return i=>{let l=o;for(let c=0;c<s;c++)c<n?l=l.replace(kG.token,i[c]):c<n+r?l=l.replace(IG.token,ll.transform(i[c])):l=l.replace(OG.token,Vy(i[c]));return l}}const mme=e=>typeof e=="number"?0:e;function hme(e){const t=TG(e);return DG(e)(t.map(mme))}const jh={test:fme,parse:TG,createTransformer:DG,getAnimatableNone:hme},MG=(e,t)=>r=>`${r>0?t:e}`;function RG(e,t){return typeof e=="number"?r=>rs(e,t,r):ll.test(e)?EG(e,t):e.startsWith("var(")?MG(e,t):FG(e,t)}const LG=(e,t)=>{const r=[...e],n=r.length,o=e.map((s,i)=>RG(s,t[i]));return s=>{for(let i=0;i<n;i++)r[i]=o[i](s);return r}},pme=(e,t)=>{const r={...e,...t},n={};for(const o in r)e[o]!==void 0&&t[o]!==void 0&&(n[o]=RG(e[o],t[o]));return o=>{for(const s in n)r[s]=n[s](o);return r}},FG=(e,t)=>{const r=jh.createTransformer(t),n=L_(e),o=L_(t);return n.numVars===o.numVars&&n.numColors===o.numColors&&n.numNumbers>=o.numNumbers?oh(LG(n.values,o.values),r):MG(e,t)},Ub=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},HF=(e,t)=>r=>rs(e,t,r);function gme(e){return typeof e=="number"?HF:typeof e=="string"?ll.test(e)?EG:FG:Array.isArray(e)?LG:typeof e=="object"?pme:HF}function vme(e,t,r){const n=[],o=r||gme(e[0]),s=e.length-1;for(let i=0;i<s;i++){let l=o(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||ps:t;l=oh(c,l)}n.push(l)}return n}function $G(e,t,{clamp:r=!0,ease:n,mixer:o}={}){const s=e.length;if(S4(s===t.length),s===1)return()=>t[0];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=vme(t,n,o),l=i.length,c=d=>{let u=0;if(l>1)for(;u<e.length-2&&!(d<e[u+1]);u++);const f=Ub(e[u],e[u+1],d);return i[u](f)};return r?d=>c(wh(e[0],e[s-1],d)):c}function xme(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const o=Ub(0,t,n);e.push(rs(r,1,o))}}function yme(e){const t=[0];return xme(t,e.length-1),t}function bme(e,t){return e.map(r=>r*t)}function wme(e,t){return e.map(()=>t||_G).splice(0,e.length-1)}function F_({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const o=rme(n)?n.map(VF):VF(n),s={done:!1,value:t[0]},i=bme(r&&r.length===t.length?r:yme(t),e),l=$G(i,t,{ease:Array.isArray(o)?o:wme(t,o)});return{calculatedDuration:e,next:c=>(s.value=l(c),s.done=c>=e,s)}}function BG(e,t){return t?e*(1e3/t):0}const jme=5;function qG(e,t,r){const n=Math.max(t-jme,0);return BG(r-e(n),t-n)}const YP=.001,_me=.01,GF=10,Nme=.05,Sme=1;function Cme({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let o,s;Gfe(e<=sh(GF));let i=1-t;i=wh(Nme,Sme,i),e=wh(_me,GF,Df(e)),i<1?(o=d=>{const u=d*i,f=u*e,h=u-r,m=aI(d,i),v=Math.exp(-f);return YP-h/m*v},s=d=>{const f=d*i*e,h=f*r+r,m=Math.pow(i,2)*Math.pow(d,2)*e,v=Math.exp(-f),g=aI(Math.pow(d,2),i);return(-o(d)+YP>0?-1:1)*((h-m)*v)/g}):(o=d=>{const u=Math.exp(-d*e),f=(d-r)*e+1;return-YP+u*f},s=d=>{const u=Math.exp(-d*e),f=(r-d)*(e*e);return u*f});const l=5/e,c=Ame(o,s,l);if(e=sh(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:i*2*Math.sqrt(n*d),duration:e}}}const Pme=12;function Ame(e,t,r){let n=r;for(let o=1;o<Pme;o++)n=n-e(n)/t(n);return n}function aI(e,t){return e*Math.sqrt(1-t*t)}const Eme=["duration","bounce"],kme=["stiffness","damping","mass"];function KF(e,t){return t.some(r=>e[r]!==void 0)}function Ime(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!KF(e,kme)&&KF(e,Eme)){const r=Cme(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function zG({keyframes:e,restDelta:t,restSpeed:r,...n}){const o=e[0],s=e[e.length-1],i={done:!1,value:o},{stiffness:l,damping:c,mass:d,duration:u,velocity:f,isResolvedFromDuration:h}=Ime({...n,velocity:-Df(n.velocity||0)}),m=f||0,v=c/(2*Math.sqrt(l*d)),g=s-o,y=Df(Math.sqrt(l/d)),x=Math.abs(g)<5;r||(r=x?.01:2),t||(t=x?.005:.5);let b;if(v<1){const w=aI(y,v);b=j=>{const _=Math.exp(-v*y*j);return s-_*((m+v*y*g)/w*Math.sin(w*j)+g*Math.cos(w*j))}}else if(v===1)b=w=>s-Math.exp(-y*w)*(g+(m+y*g)*w);else{const w=y*Math.sqrt(v*v-1);b=j=>{const _=Math.exp(-v*y*j),C=Math.min(w*j,300);return s-_*((m+v*y*g)*Math.sinh(C)+w*g*Math.cosh(C))/w}}return{calculatedDuration:h&&u||null,next:w=>{const j=b(w);if(h)i.done=w>=u;else{let _=m;w!==0&&(v<1?_=qG(b,w,j):_=0);const C=Math.abs(_)<=r,E=Math.abs(s-j)<=t;i.done=C&&E}return i.value=i.done?s:j,i}}}function XF({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:o=10,bounceStiffness:s=500,modifyTarget:i,min:l,max:c,restDelta:d=.5,restSpeed:u}){const f=e[0],h={done:!1,value:f},m=A=>l!==void 0&&A<l||c!==void 0&&A>c,v=A=>l===void 0?c:c===void 0||Math.abs(l-A)<Math.abs(c-A)?l:c;let g=r*t;const y=f+g,x=i===void 0?y:i(y);x!==y&&(g=x-f);const b=A=>-g*Math.exp(-A/n),w=A=>x+b(A),j=A=>{const P=b(A),F=w(A);h.done=Math.abs(P)<=d,h.value=h.done?x:F};let _,C;const E=A=>{m(h.value)&&(_=A,C=zG({keyframes:[h.value,v(h.value)],velocity:qG(w,A,h.value),damping:o,stiffness:s,restDelta:d,restSpeed:u}))};return E(0),{calculatedDuration:null,next:A=>{let P=!1;return!C&&_===void 0&&(P=!0,j(A),E(A)),_!==void 0&&A>_?C.next(A-_):(!P&&j(A),h)}}}const Ome=e=>{const t=({timestamp:r})=>e(r);return{start:()=>To.update(t,!0),stop:()=>Uf(t),now:()=>Ui.isProcessing?Ui.timestamp:performance.now()}},YF=2e4;function JF(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<YF;)t+=r,n=e.next(t);return t>=YF?1/0:t}const Tme={decay:XF,inertia:XF,tween:F_,keyframes:F_,spring:zG};function $_({autoplay:e=!0,delay:t=0,driver:r=Ome,keyframes:n,type:o="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:l="loop",onPlay:c,onStop:d,onComplete:u,onUpdate:f,...h}){let m=1,v=!1,g,y;const x=()=>{y=new Promise(be=>{g=be})};x();let b;const w=Tme[o]||F_;let j;w!==F_&&typeof n[0]!="number"&&(j=$G([0,100],n,{clamp:!1}),n=[0,100]);const _=w({...h,keyframes:n});let C;l==="mirror"&&(C=w({...h,keyframes:[...n].reverse(),velocity:-(h.velocity||0)}));let E="idle",A=null,P=null,F=null;_.calculatedDuration===null&&s&&(_.calculatedDuration=JF(_));const{calculatedDuration:M}=_;let I=1/0,R=1/0;M!==null&&(I=M+i,R=I*(s+1)-i);let D=0;const U=be=>{if(P===null)return;m>0&&(P=Math.min(P,be)),m<0&&(P=Math.min(be-R/m,P)),A!==null?D=A:D=Math.round(be-P)*m;const V=D-t*(m>=0?1:-1),B=m>=0?V<0:V>R;D=Math.max(V,0),E==="finished"&&A===null&&(D=R);let J=D,ue=_;if(s){const le=Math.min(D,R)/I;let se=Math.floor(le),ee=le%1;!ee&&le>=1&&(ee=1),ee===1&&se--,se=Math.min(se,s+1),!!(se%2)&&(l==="reverse"?(ee=1-ee,i&&(ee-=i/I)):l==="mirror"&&(ue=C)),J=wh(0,1,ee)*I}const Ne=B?{done:!1,value:n[0]}:ue.next(J);j&&(Ne.value=j(Ne.value));let{done:Z}=Ne;!B&&M!==null&&(Z=m>=0?D>=R:D<=0);const ge=A===null&&(E==="finished"||E==="running"&&Z);return f&&f(Ne.value),ge&&q(),Ne},z=()=>{b&&b.stop(),b=void 0},H=()=>{E="idle",z(),g(),x(),P=F=null},q=()=>{E="finished",u&&u(),z(),g()},Q=()=>{if(v)return;b||(b=r(U));const be=b.now();c&&c(),A!==null?P=be-A:(!P||E==="finished")&&(P=be),E==="finished"&&x(),F=P,A=null,E="running",b.start()};e&&Q();const pe={then(be,V){return y.then(be,V)},get time(){return Df(D)},set time(be){be=sh(be),D=be,A!==null||!b||m===0?A=be:P=b.now()-be/m},get duration(){const be=_.calculatedDuration===null?JF(_):_.calculatedDuration;return Df(be)},get speed(){return m},set speed(be){be===m||!b||(m=be,pe.time=Df(D))},get state(){return E},play:Q,pause:()=>{E="paused",A=D},stop:()=>{v=!0,E!=="idle"&&(E="idle",d&&d(),H())},cancel:()=>{F!==null&&U(F),H()},complete:()=>{E="finished"},sample:be=>(P=0,U(be))};return pe}function Dme(e){let t;return()=>(t===void 0&&(t=e()),t)}const Mme=Dme(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Rme=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),A2=10,Lme=2e4,Fme=(e,t)=>t.type==="spring"||e==="backgroundColor"||!yG(t.ease);function $me(e,t,{onUpdate:r,onComplete:n,...o}){if(!(Mme()&&Rme.has(t)&&!o.repeatDelay&&o.repeatType!=="mirror"&&o.damping!==0&&o.type!=="inertia"))return!1;let i=!1,l,c,d=!1;const u=()=>{c=new Promise(w=>{l=w})};u();let{keyframes:f,duration:h=300,ease:m,times:v}=o;if(Fme(t,o)){const w=$_({...o,repeat:0,delay:0});let j={done:!1,value:f[0]};const _=[];let C=0;for(;!j.done&&C<Lme;)j=w.sample(C),_.push(j.value),C+=A2;v=void 0,f=_,h=C-A2,m="linear"}const g=Xfe(e.owner.current,t,f,{...o,duration:h,ease:m,times:v}),y=()=>{d=!1,g.cancel()},x=()=>{d=!0,To.update(y),l(),u()};return g.onfinish=()=>{d||(e.set(Yfe(f,o)),n&&n(),x())},{then(w,j){return c.then(w,j)},attachTimeline(w){return g.timeline=w,g.onfinish=null,ps},get time(){return Df(g.currentTime||0)},set time(w){g.currentTime=sh(w)},get speed(){return g.playbackRate},set speed(w){g.playbackRate=w},get duration(){return Df(h)},play:()=>{i||(g.play(),Uf(y))},pause:()=>g.pause(),stop:()=>{if(i=!0,g.playState==="idle")return;const{currentTime:w}=g;if(w){const j=$_({...o,autoplay:!1});e.setWithVelocity(j.sample(w-A2).value,j.sample(w).value,A2)}x()},complete:()=>{d||g.finish()},cancel:x}}function Bme({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const o=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:ps,pause:ps,stop:ps,then:s=>(s(),Promise.resolve()),cancel:ps,complete:ps});return t?$_({keyframes:[0,1],duration:0,delay:t,onComplete:o}):o()}const qme={type:"spring",stiffness:500,damping:25,restSpeed:10},zme=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Ume={type:"keyframes",duration:.8},Vme={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Wme=(e,{keyframes:t})=>t.length>2?Ume:bg.has(e)?e.startsWith("scale")?zme(t[1]):qme:Vme,oI=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(jh.test(t)||t==="0")&&!t.startsWith("url(")),Hme=new Set(["brightness","contrast","saturate","opacity"]);function Gme(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(aC)||[];if(!n)return e;const o=r.replace(n,"");let s=Hme.has(t)?1:0;return n!==r&&(s*=100),t+"("+s+o+")"}const Kme=/([a-z-]*)\(.*?\)/g,sI={...jh,getAnimatableNone:e=>{const t=e.match(Kme);return t?t.map(Gme).join(" "):e}},Xme={...rG,color:ll,backgroundColor:ll,outlineColor:ll,fill:ll,stroke:ll,borderColor:ll,borderTopColor:ll,borderRightColor:ll,borderBottomColor:ll,borderLeftColor:ll,filter:sI,WebkitFilter:sI},E4=e=>Xme[e];function UG(e,t){let r=E4(e);return r!==sI&&(r=jh),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const VG=e=>/^0[^.\s]+$/.test(e);function Yme(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||VG(e)}function Jme(e,t,r,n){const o=oI(t,r);let s;Array.isArray(r)?s=[...r]:s=[null,r];const i=n.from!==void 0?n.from:e.get();let l;const c=[];for(let d=0;d<s.length;d++)s[d]===null&&(s[d]=d===0?i:s[d-1]),Yme(s[d])&&c.push(d),typeof s[d]=="string"&&s[d]!=="none"&&s[d]!=="0"&&(l=s[d]);if(o&&c.length&&l)for(let d=0;d<c.length;d++){const u=c[d];s[u]=UG(t,l)}return s}function Qme({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:o,repeat:s,repeatType:i,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}function k4(e,t){return e[t]||e.default||e}const Zme={skipAnimations:!1},I4=(e,t,r,n={})=>o=>{const s=k4(n,e)||{},i=s.delay||n.delay||0;let{elapsed:l=0}=n;l=l-sh(i);const c=Jme(t,e,r,s),d=c[0],u=c[c.length-1],f=oI(e,d),h=oI(e,u);let m={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...s,delay:-l,onUpdate:v=>{t.set(v),s.onUpdate&&s.onUpdate(v)},onComplete:()=>{o(),s.onComplete&&s.onComplete()}};if(Qme(s)||(m={...m,...Wme(e,m)}),m.duration&&(m.duration=sh(m.duration)),m.repeatDelay&&(m.repeatDelay=sh(m.repeatDelay)),!f||!h||Kfe.current||s.type===!1||Zme.skipAnimations)return Bme(m);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const v=$me(t,e,m);if(v)return v}return $_(m)};function B_(e){return!!(Xl(e)&&e.add)}const WG=e=>/^\-?\d*\.?\d+$/.test(e);function O4(e,t){e.indexOf(t)===-1&&e.push(t)}function T4(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class D4{constructor(){this.subscriptions=[]}add(t){return O4(this.subscriptions,t),()=>T4(this.subscriptions,t)}notify(t,r,n){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](t,r,n);else for(let s=0;s<o;s++){const i=this.subscriptions[s];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ehe=e=>!isNaN(parseFloat(e));class the{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,o=!0)=>{this.prev=this.current,this.current=n;const{delta:s,timestamp:i}=Ui;this.lastUpdated!==i&&(this.timeDelta=s,this.lastUpdated=i,To.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),o&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>To.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=ehe(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new D4);const n=this.events[t].add(r);return t==="change"?()=>{n(),To.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?BG(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function xx(e,t){return new the(e,t)}const HG=e=>t=>t.test(e),rhe={test:e=>e==="auto",parse:e=>e},GG=[wg,ia,qu,jm,cfe,lfe,rhe],Q0=e=>GG.find(HG(e)),nhe=[...GG,ll,jh],ahe=e=>nhe.find(HG(e));function ohe(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,xx(r))}function she(e,t){const r=sC(e,t);let{transitionEnd:n={},transition:o={},...s}=r?e.makeTargetAnimatable(r,!1):{};s={...s,...n};for(const i in s){const l=_fe(s[i]);ohe(e,i,l)}}function ihe(e,t,r){var n,o;const s=Object.keys(t).filter(l=>!e.hasValue(l)),i=s.length;if(i)for(let l=0;l<i;l++){const c=s[l],d=t[c];let u=null;Array.isArray(d)&&(u=d[0]),u===null&&(u=(o=(n=r[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&o!==void 0?o:t[c]),u!=null&&(typeof u=="string"&&(WG(u)||VG(u))?u=parseFloat(u):!ahe(u)&&jh.test(d)&&(u=UG(c,d)),e.addValue(c,xx(u,{owner:e})),r[c]===void 0&&(r[c]=u),u!==null&&e.setBaseTarget(c,u))}}function lhe(e,t){return t?(t[e]||t.default||t).from:void 0}function che(e,t,r){const n={};for(const o in e){const s=lhe(o,t);if(s!==void 0)n[o]=s;else{const i=r.getValue(o);i&&(n[o]=i.get())}}return n}function dhe({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function uhe(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function KG(e,t,{delay:r=0,transitionOverride:n,type:o}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:i,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(s=n);const d=[],u=o&&e.animationState&&e.animationState.getState()[o];for(const f in l){const h=e.getValue(f),m=l[f];if(!h||m===void 0||u&&dhe(u,f))continue;const v={delay:r,elapsed:0,...k4(s||{},f)};if(window.HandoffAppearAnimations){const x=e.getProps()[XH];if(x){const b=window.HandoffAppearAnimations(x,f,h,To);b!==null&&(v.elapsed=b,v.isHandoff=!0)}}let g=!v.isHandoff&&!uhe(h,m);if(v.type==="spring"&&(h.getVelocity()||v.velocity)&&(g=!1),h.animation&&(g=!1),g)continue;h.start(I4(f,h,m,e.shouldReduceMotion&&bg.has(f)?{type:!1}:v));const y=h.animation;B_(c)&&(c.add(f),y.then(()=>c.remove(f))),d.push(y)}return i&&Promise.all(d).then(()=>{i&&she(e,i)}),d}function iI(e,t,r={}){const n=sC(e,t,r.custom);let{transition:o=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(o=r.transitionOverride);const s=n?()=>Promise.all(KG(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:f}=o;return fhe(e,t,d+c,u,f,r)}:()=>Promise.resolve(),{when:l}=o;if(l){const[c,d]=l==="beforeChildren"?[s,i]:[i,s];return c().then(()=>d())}else return Promise.all([s(),i(r.delay)])}function fhe(e,t,r=0,n=0,o=1,s){const i=[],l=(e.variantChildren.size-1)*n,c=o===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(mhe).forEach((d,u)=>{d.notify("AnimationStart",t),i.push(iI(d,t,{...s,delay:r+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(i)}function mhe(e,t){return e.sortNodePosition(t)}function hhe(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const o=t.map(s=>iI(e,s,r));n=Promise.all(o)}else if(typeof t=="string")n=iI(e,t,r);else{const o=typeof t=="function"?sC(e,t,r.custom):t;n=Promise.all(KG(e,o,r))}return n.then(()=>e.notify("AnimationComplete",t))}const phe=[...p4].reverse(),ghe=p4.length;function vhe(e){return t=>Promise.all(t.map(({animation:r,options:n})=>hhe(e,r,n)))}function xhe(e){let t=vhe(e);const r=bhe();let n=!0;const o=(c,d)=>{const u=sC(e,d);if(u){const{transition:f,transitionEnd:h,...m}=u;c={...c,...m,...h}}return c};function s(c){t=c(e)}function i(c,d){const u=e.getProps(),f=e.getVariantContext(!0)||{},h=[],m=new Set;let v={},g=1/0;for(let x=0;x<ghe;x++){const b=phe[x],w=r[b],j=u[b]!==void 0?u[b]:f[b],_=qb(j),C=b===d?w.isActive:null;C===!1&&(g=x);let E=j===f[b]&&j!==u[b]&&_;if(E&&n&&e.manuallyAnimateOnMount&&(E=!1),w.protectedKeys={...v},!w.isActive&&C===null||!j&&!w.prevProp||rC(j)||typeof j=="boolean")continue;let P=yhe(w.prevProp,j)||b===d&&w.isActive&&!E&&_||x>g&&_,F=!1;const M=Array.isArray(j)?j:[j];let I=M.reduce(o,{});C===!1&&(I={});const{prevResolvedValues:R={}}=w,D={...R,...I},U=z=>{P=!0,m.has(z)&&(F=!0,m.delete(z)),w.needsAnimating[z]=!0};for(const z in D){const H=I[z],q=R[z];if(v.hasOwnProperty(z))continue;let Q=!1;R_(H)&&R_(q)?Q=!vG(H,q):Q=H!==q,Q?H!==void 0?U(z):m.add(z):H!==void 0&&m.has(z)?U(z):w.protectedKeys[z]=!0}w.prevProp=j,w.prevResolvedValues=I,w.isActive&&(v={...v,...I}),n&&e.blockInitialAnimation&&(P=!1),P&&(!E||F)&&h.push(...M.map(z=>({animation:z,options:{type:b,...c}})))}if(m.size){const x={};m.forEach(b=>{const w=e.getBaseTarget(b);w!==void 0&&(x[b]=w)}),h.push({animation:x})}let y=!!h.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(y=!1),n=!1,y?t(h):Promise.resolve()}function l(c,d,u){var f;if(r[c].isActive===d)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(m=>{var v;return(v=m.animationState)===null||v===void 0?void 0:v.setActive(c,d)}),r[c].isActive=d;const h=i(u,c);for(const m in r)r[m].protectedKeys={};return h}return{animateChanges:i,setActive:l,setAnimateFunction:s,getState:()=>r}}function yhe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!vG(t,e):!1}function Gh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function bhe(){return{animate:Gh(!0),whileInView:Gh(),whileHover:Gh(),whileTap:Gh(),whileDrag:Gh(),whileFocus:Gh(),exit:Gh()}}class whe extends Th{constructor(t){super(t),t.animationState||(t.animationState=xhe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),rC(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let jhe=0;class _he extends Th{constructor(){super(...arguments),this.id=jhe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===o)return;const s=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&s.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const Nhe={animation:{Feature:whe},exit:{Feature:_he}},QF=(e,t)=>Math.abs(e-t);function She(e,t){const r=QF(e.x,t.x),n=QF(e.y,t.y);return Math.sqrt(r**2+n**2)}class XG{constructor(t,r,{transformPagePoint:n,contextWindow:o,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=QP(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=She(f.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:v}=f,{timestamp:g}=Ui;this.history.push({...v,timestamp:g});const{onStart:y,onMove:x}=this.handlers;h||(y&&y(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=JP(h,this.transformPagePoint),To.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:m,onSessionEnd:v,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=QP(f.type==="pointercancel"?this.lastMoveEventInfo:JP(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,y),v&&v(f,y)},!fG(t))return;this.dragSnapToOrigin=s,this.handlers=r,this.transformPagePoint=n,this.contextWindow=o||window;const i=oC(t),l=JP(i,this.transformPagePoint),{point:c}=l,{timestamp:d}=Ui;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=r;u&&u(t,QP(l,this.history)),this.removeListeners=oh(Tf(this.contextWindow,"pointermove",this.handlePointerMove),Tf(this.contextWindow,"pointerup",this.handlePointerUp),Tf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Uf(this.updatePoint)}}function JP(e,t){return t?{point:t(e.point)}:e}function ZF(e,t){return{x:e.x-t.x,y:e.y-t.y}}function QP({point:e},t){return{point:e,delta:ZF(e,YG(t)),offset:ZF(e,Che(t)),velocity:Phe(t,.1)}}function Che(e){return e[0]}function YG(e){return e[e.length-1]}function Phe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const o=YG(e);for(;r>=0&&(n=e[r],!(o.timestamp-n.timestamp>sh(t)));)r--;if(!n)return{x:0,y:0};const s=Df(o.timestamp-n.timestamp);if(s===0)return{x:0,y:0};const i={x:(o.x-n.x)/s,y:(o.y-n.y)/s};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function Lc(e){return e.max-e.min}function lI(e,t=0,r=.01){return Math.abs(e-t)<=r}function e$(e,t,r,n=.5){e.origin=n,e.originPoint=rs(t.min,t.max,e.origin),e.scale=Lc(r)/Lc(t),(lI(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=rs(r.min,r.max,e.origin)-e.originPoint,(lI(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Wy(e,t,r,n){e$(e.x,t.x,r.x,n?n.originX:void 0),e$(e.y,t.y,r.y,n?n.originY:void 0)}function t$(e,t,r){e.min=r.min+t.min,e.max=e.min+Lc(t)}function Ahe(e,t,r){t$(e.x,t.x,r.x),t$(e.y,t.y,r.y)}function r$(e,t,r){e.min=t.min-r.min,e.max=e.min+Lc(t)}function Hy(e,t,r){r$(e.x,t.x,r.x),r$(e.y,t.y,r.y)}function Ehe(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?rs(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?rs(r,e,n.max):Math.min(e,r)),e}function n$(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function khe(e,{top:t,left:r,bottom:n,right:o}){return{x:n$(e.x,r,o),y:n$(e.y,t,n)}}function a$(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function Ihe(e,t){return{x:a$(e.x,t.x),y:a$(e.y,t.y)}}function Ohe(e,t){let r=.5;const n=Lc(e),o=Lc(t);return o>n?r=Ub(t.min,t.max-n,e.min):n>o&&(r=Ub(e.min,e.max-o,t.min)),wh(0,1,r)}function The(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const cI=.35;function Dhe(e=cI){return e===!1?e=0:e===!0&&(e=cI),{x:o$(e,"left","right"),y:o$(e,"top","bottom")}}function o$(e,t,r){return{min:s$(e,t),max:s$(e,r)}}function s$(e,t){return typeof e=="number"?e:e[t]||0}const i$=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ov=()=>({x:i$(),y:i$()}),l$=()=>({min:0,max:0}),Es=()=>({x:l$(),y:l$()});function Zc(e){return[e("x"),e("y")]}function JG({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function Mhe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Rhe(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function ZP(e){return e===void 0||e===1}function dI({scale:e,scaleX:t,scaleY:r}){return!ZP(e)||!ZP(t)||!ZP(r)}function np(e){return dI(e)||QG(e)||e.z||e.rotate||e.rotateX||e.rotateY}function QG(e){return c$(e.x)||c$(e.y)}function c$(e){return e&&e!=="0%"}function q_(e,t,r){const n=e-r,o=t*n;return r+o}function d$(e,t,r,n,o){return o!==void 0&&(e=q_(e,o,n)),q_(e,r,n)+t}function uI(e,t=0,r=1,n,o){e.min=d$(e.min,t,r,n,o),e.max=d$(e.max,t,r,n,o)}function ZG(e,{x:t,y:r}){uI(e.x,t.translate,t.scale,t.originPoint),uI(e.y,r.translate,r.scale,r.originPoint)}function Lhe(e,t,r,n=!1){const o=r.length;if(!o)return;t.x=t.y=1;let s,i;for(let l=0;l<o;l++){s=r[l],i=s.projectionDelta;const c=s.instance;c&&c.style&&c.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Tv(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,ZG(e,i)),n&&np(s.latestValues)&&Tv(e,s.latestValues))}t.x=u$(t.x),t.y=u$(t.y)}function u$(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Em(e,t){e.min=e.min+t,e.max=e.max+t}function f$(e,t,[r,n,o]){const s=t[o]!==void 0?t[o]:.5,i=rs(e.min,e.max,s);uI(e,t[r],t[n],i,t.scale)}const Fhe=["x","scaleX","originX"],$he=["y","scaleY","originY"];function Tv(e,t){f$(e.x,t,Fhe),f$(e.y,t,$he)}function eK(e,t){return JG(Rhe(e.getBoundingClientRect(),t))}function Bhe(e,t,r){const n=eK(e,r),{scroll:o}=t;return o&&(Em(n.x,o.offset.x),Em(n.y,o.offset.y)),n}const tK=({current:e})=>e?e.ownerDocument.defaultView:null,qhe=new WeakMap;class zhe{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Es(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const o=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(oC(u,"page").point)},s=(u,f)=>{const{drag:h,dragPropagation:m,onDragStart:v}=this.getProps();if(h&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=hG(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Zc(y=>{let x=this.getAxisMotionValue(y).get()||0;if(qu.test(x)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[y];w&&(x=Lc(w)*(parseFloat(x)/100))}}this.originPoint[y]=x}),v&&To.update(()=>v(u,f),!1,!0);const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},i=(u,f)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:v,onDrag:g}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:y}=f;if(m&&this.currentDirection===null){this.currentDirection=Uhe(y),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,y),this.updateAxis("y",f.point,y),this.visualElement.render(),g&&g(u,f)},l=(u,f)=>this.stop(u,f),c=()=>Zc(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new XG(t,{onSessionStart:o,onStart:s,onMove:i,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:tK(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:s}=this.getProps();s&&To.update(()=>s(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:o}=this.getProps();if(!n||!E2(t,o,this.currentDirection))return;const s=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=Ehe(i,this.constraints[t],this.elastic[t])),s.set(i)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,s=this.constraints;r&&kv(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&o?this.constraints=khe(o.layoutBox,r):this.constraints=!1,this.elastic=Dhe(n),s!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&Zc(i=>{this.getAxisMotionValue(i)&&(this.constraints[i]=The(o.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!kv(t))return!1;const n=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const s=Bhe(n,o.root,this.visualElement.getTransformPagePoint());let i=Ihe(o.layout.layoutBox,s);if(r){const l=r(Mhe(i));this.hasMutatedConstraints=!!l,l&&(i=JG(l))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:o,dragTransition:s,dragSnapToOrigin:i,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Zc(u=>{if(!E2(u,r,this.currentDirection))return;let f=c&&c[u]||{};i&&(f={min:0,max:0});const h=o?200:1e6,m=o?40:1e7,v={type:"inertia",velocity:n?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(u,v)});return Promise.all(d).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(I4(t,n,0,r))}stopAnimation(){Zc(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Zc(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),o=n[r];return o||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Zc(r=>{const{drag:n}=this.getProps();if(!E2(r,n,this.currentDirection))return;const{projection:o}=this.visualElement,s=this.getAxisMotionValue(r);if(o&&o.layout){const{min:i,max:l}=o.layout.layoutBox[r];s.set(t[r]-rs(i,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!kv(r)||!n||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Zc(i=>{const l=this.getAxisMotionValue(i);if(l){const c=l.get();o[i]=Ohe({min:c,max:c},this.constraints[i])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Zc(i=>{if(!E2(i,t,null))return;const l=this.getAxisMotionValue(i),{min:c,max:d}=this.constraints[i];l.set(rs(c,d,o[i]))})}addListeners(){if(!this.visualElement.current)return;qhe.set(this.visualElement,this);const t=this.visualElement.current,r=Tf(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();kv(c)&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,s=o.addEventListener("measure",n);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),n();const i=Cf(window,"resize",()=>this.scalePositionWithinConstraints()),l=o.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Zc(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=c[u].translate,f.set(f.get()+c[u].translate))}),this.visualElement.render())});return()=>{i(),r(),s(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:o=!1,dragConstraints:s=!1,dragElastic:i=cI,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:o,dragConstraints:s,dragElastic:i,dragMomentum:l}}}function E2(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function Uhe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Vhe extends Th{constructor(t){super(t),this.removeGroupControls=ps,this.removeListeners=ps,this.controls=new zhe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ps}unmount(){this.removeGroupControls(),this.removeListeners()}}const m$=e=>(t,r)=>{e&&To.update(()=>e(t,r))};class Whe extends Th{constructor(){super(...arguments),this.removePointerDownListener=ps}onPointerDown(t){this.session=new XG(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:tK(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:o}=this.node.getProps();return{onSessionStart:m$(t),onStart:m$(r),onMove:n,onEnd:(s,i)=>{delete this.session,o&&To.update(()=>o(s,i))}}}mount(){this.removePointerDownListener=Tf(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Hhe(){const e=p.useContext(eC);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,o=p.useId();return p.useEffect(()=>n(o),[]),!t&&r?[!1,()=>r&&r(o)]:[!0]}const Bj={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function h$(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Z0={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ia.test(e))e=parseFloat(e);else return e;const r=h$(e,t.target.x),n=h$(e,t.target.y);return`${r}% ${n}%`}},Ghe={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,o=jh.parse(e);if(o.length>5)return n;const s=jh.createTransformer(e),i=typeof o[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;o[0+i]/=l,o[1+i]/=c;const d=rs(l,c,.5);return typeof o[2+i]=="number"&&(o[2+i]/=d),typeof o[3+i]=="number"&&(o[3+i]/=d),s(o)}};class Khe extends _e.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:o}=this.props,{projection:s}=t;tfe(Xhe),s&&(r.group&&r.group.add(s),n&&n.register&&o&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Bj.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:o,isPresent:s}=this.props,i=n.projection;return i&&(i.isPresent=s,o||t.layoutDependency!==r||r===void 0?i.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?i.promote():i.relegate()||To.postRender(()=>{const l=i.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:o}=t;o&&(o.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(o),n&&n.deregister&&n.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function rK(e){const[t,r]=Hhe(),n=p.useContext(v4);return _e.createElement(Khe,{...e,layoutGroup:n,switchLayoutGroup:p.useContext(JH),isPresent:t,safeToRemove:r})}const Xhe={borderRadius:{...Z0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Z0,borderTopRightRadius:Z0,borderBottomLeftRadius:Z0,borderBottomRightRadius:Z0,boxShadow:Ghe},nK=["TopLeft","TopRight","BottomLeft","BottomRight"],Yhe=nK.length,p$=e=>typeof e=="string"?parseFloat(e):e,g$=e=>typeof e=="number"||ia.test(e);function Jhe(e,t,r,n,o,s){o?(e.opacity=rs(0,r.opacity!==void 0?r.opacity:1,Qhe(n)),e.opacityExit=rs(t.opacity!==void 0?t.opacity:1,0,Zhe(n))):s&&(e.opacity=rs(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let i=0;i<Yhe;i++){const l=`border${nK[i]}Radius`;let c=v$(t,l),d=v$(r,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||g$(c)===g$(d)?(e[l]=Math.max(rs(p$(c),p$(d),n),0),(qu.test(d)||qu.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||r.rotate)&&(e.rotate=rs(t.rotate||0,r.rotate||0,n))}function v$(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Qhe=aK(0,.5,CG),Zhe=aK(.5,.95,ps);function aK(e,t,r){return n=>n<e?0:n>t?1:r(Ub(e,t,n))}function x$(e,t){e.min=t.min,e.max=t.max}function Gc(e,t){x$(e.x,t.x),x$(e.y,t.y)}function y$(e,t,r,n,o){return e-=t,e=q_(e,1/r,n),o!==void 0&&(e=q_(e,1/o,n)),e}function epe(e,t=0,r=1,n=.5,o,s=e,i=e){if(qu.test(t)&&(t=parseFloat(t),t=rs(i.min,i.max,t/100)-i.min),typeof t!="number")return;let l=rs(s.min,s.max,n);e===s&&(l-=t),e.min=y$(e.min,t,r,l,o),e.max=y$(e.max,t,r,l,o)}function b$(e,t,[r,n,o],s,i){epe(e,t[r],t[n],t[o],t.scale,s,i)}const tpe=["x","scaleX","originX"],rpe=["y","scaleY","originY"];function w$(e,t,r,n){b$(e.x,t,tpe,r?r.x:void 0,n?n.x:void 0),b$(e.y,t,rpe,r?r.y:void 0,n?n.y:void 0)}function j$(e){return e.translate===0&&e.scale===1}function oK(e){return j$(e.x)&&j$(e.y)}function npe(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function sK(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function _$(e){return Lc(e.x)/Lc(e.y)}class ape{constructor(){this.members=[]}add(t){O4(this.members,t),t.scheduleRender()}remove(t){if(T4(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(o=>t===o);if(r===0)return!1;let n;for(let o=r;o>=0;o--){const s=this.members[o];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:o}=t.options;o===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function N$(e,t,r){let n="";const o=e.x.translate/t.x,s=e.y.translate/t.y;if((o||s)&&(n=`translate3d(${o}px, ${s}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:d,rotateY:u}=r;c&&(n+=`rotate(${c}deg) `),d&&(n+=`rotateX(${d}deg) `),u&&(n+=`rotateY(${u}deg) `)}const i=e.x.scale*t.x,l=e.y.scale*t.y;return(i!==1||l!==1)&&(n+=`scale(${i}, ${l})`),n||"none"}const ope=(e,t)=>e.depth-t.depth;class spe{constructor(){this.children=[],this.isDirty=!1}add(t){O4(this.children,t),this.isDirty=!0}remove(t){T4(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(ope),this.isDirty=!1,this.children.forEach(t)}}function ipe(e,t){const r=performance.now(),n=({timestamp:o})=>{const s=o-r;s>=t&&(Uf(n),e(s-t))};return To.read(n,!0),()=>Uf(n)}function lpe(e){window.MotionDebug&&window.MotionDebug.record(e)}function cpe(e){return e instanceof SVGElement&&e.tagName!=="svg"}function dpe(e,t,r){const n=Xl(e)?e:xx(e);return n.start(I4("",n,t,r)),n.animation}const S$=["","X","Y","Z"],upe={visibility:"hidden"},C$=1e3;let fpe=0;const ap={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function iK({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:o}){return class{constructor(i={},l=t?.()){this.id=fpe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ap.totalNodes=ap.resolvedTargetDeltas=ap.recalculatedProjection=0,this.nodes.forEach(ppe),this.nodes.forEach(bpe),this.nodes.forEach(wpe),this.nodes.forEach(gpe),lpe(ap)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new spe)}addEventListener(i,l){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new D4),this.eventHandlers.get(i).add(l)}notifyListeners(i,...l){const c=this.eventHandlers.get(i);c&&c.notify(...l)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=cpe(i),this.instance=i;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let f;const h=()=>this.root.updateBlockedByResize=!1;e(i,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=ipe(h,250),Bj.hasAnimatedSinceResize&&(Bj.hasAnimatedSinceResize=!1,this.nodes.forEach(A$))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:h,hasRelativeTargetChanged:m,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||Cpe,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=u.getProps(),b=!this.targetLayout||!sK(this.targetLayout,v)||m,w=!h&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||h&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,w);const j={...k4(g,"layout"),onPlay:y,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j)}else h||A$(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Uf(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(jpe),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(P$);return}this.isUpdating||this.nodes.forEach(xpe),this.isUpdating=!1,this.nodes.forEach(ype),this.nodes.forEach(mpe),this.nodes.forEach(hpe),this.clearAllSnapshots();const l=performance.now();Ui.delta=wh(0,1e3/60,l-Ui.timestamp),Ui.timestamp=l,Ui.isProcessing=!0,UP.update.process(Ui),UP.preRender.process(Ui),UP.render.process(Ui),Ui.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(vpe),this.sharedNodes.forEach(_pe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,To.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){To.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Es(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:i,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!o)return;const i=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!oK(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;i&&(l||np(this.latestValues)||u)&&(o(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return i&&(c=this.removeTransform(c)),Ppe(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return Es();const l=i.measureViewportBox(),{scroll:c}=this.root;return c&&(Em(l.x,c.offset.x),Em(l.y,c.offset.y)),l}removeElementScroll(i){const l=Es();Gc(l,i);for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:f}=d;if(d!==this.root&&u&&f.layoutScroll){if(u.isRoot){Gc(l,i);const{scroll:h}=this.root;h&&(Em(l.x,-h.offset.x),Em(l.y,-h.offset.y))}Em(l.x,u.offset.x),Em(l.y,u.offset.y)}}return l}applyTransform(i,l=!1){const c=Es();Gc(c,i);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Tv(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),np(u.latestValues)&&Tv(c,u.latestValues)}return np(this.latestValues)&&Tv(c,this.latestValues),c}removeTransform(i){const l=Es();Gc(l,i);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!np(d.latestValues))continue;dI(d.latestValues)&&d.updateSnapshot();const u=Es(),f=d.measurePageBox();Gc(u,f),w$(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return np(this.latestValues)&&w$(l,this.latestValues),l}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ui.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(i||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:h}=this.options;if(!(!this.layout||!(f||h))){if(this.resolvedRelativeTargetAt=Ui.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Es(),this.relativeTargetOrigin=Es(),Hy(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Gc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Es(),this.targetWithTransforms=Es()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Ahe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Gc(this.target,this.layout.layoutBox),ZG(this.target,this.targetDelta)):Gc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Es(),this.relativeTargetOrigin=Es(),Hy(this.relativeTargetOrigin,this.target,m.target),Gc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ap.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||dI(this.parent.latestValues)||QG(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Ui.timestamp&&(d=!1),d)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;Gc(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;Lhe(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:v}=l;if(!v){this.projectionTransform&&(this.projectionDelta=Ov(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Ov(),this.projectionDeltaWithTransform=Ov());const g=this.projectionTransform;Wy(this.projectionDelta,this.layoutCorrected,v,this.latestValues),this.projectionTransform=N$(this.projectionDelta,this.treeScale),(this.projectionTransform!==g||this.treeScale.x!==h||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),ap.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(i,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},f=Ov();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=Es(),m=c?c.source:void 0,v=this.layout?this.layout.source:void 0,g=m!==v,y=this.getStack(),x=!y||y.members.length<=1,b=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(Spe));this.animationProgress=0;let w;this.mixTargetDelta=j=>{const _=j/1e3;E$(f.x,i.x,_),E$(f.y,i.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Hy(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Npe(this.relativeTarget,this.relativeTargetOrigin,h,_),w&&npe(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=Es()),Gc(w,this.relativeTarget)),g&&(this.animationValues=u,Jhe(u,d,this.latestValues,_,b,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Uf(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=To.update(()=>{Bj.hasAnimatedSinceResize=!0,this.currentAnimation=dpe(0,C$,{...i,onUpdate:l=>{this.mixTargetDelta(l),i.onUpdate&&i.onUpdate(l)},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(C$),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=i;if(!(!l||!c||!d)){if(this!==i&&this.layout&&d&&lK(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||Es();const f=Lc(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const h=Lc(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}Gc(l,c),Tv(l,u),Wy(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(i,l){this.sharedNodes.has(i)||this.sharedNodes.set(i,new ape),this.sharedNodes.get(i).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:l}=this.options;return l?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:l}=this.options;return l?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetRotation(){const{visualElement:i}=this.options;if(!i)return;let l=!1;const{latestValues:c}=i;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const d={};for(let u=0;u<S$.length;u++){const f="rotate"+S$[u];c[f]&&(d[f]=c[f],i.setStaticValue(f,0))}i.render();for(const u in d)i.setStaticValue(u,d[u]);i.scheduleRender()}getProjectionStyles(i){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return upe;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=$j(i?.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=$j(i?.pointerEvents)||""),this.hasProjected&&!np(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const h=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=N$(this.projectionDeltaWithTransform,this.treeScale,h),u&&(d.transform=u(h,d.transform));const{x:m,y:v}=this.projectionDelta;d.transformOrigin=`${m.origin*100}% ${v.origin*100}% 0`,f.animationValues?d.opacity=f===this?(c=(l=h.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:d.opacity=f===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const g in D_){if(h[g]===void 0)continue;const{correct:y,applyTo:x}=D_[g],b=d.transform==="none"?h[g]:y(h[g],f);if(x){const w=x.length;for(let j=0;j<w;j++)d[x[j]]=b}else d[g]=b}return this.options.layoutId&&(d.pointerEvents=f===this?$j(i?.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var l;return(l=i.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(P$),this.root.sharedNodes.clear()}}}function mpe(e){e.updateLayout()}function hpe(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:o}=e.layout,{animationType:s}=e.options,i=r.source!==e.layout.source;s==="size"?Zc(f=>{const h=i?r.measuredBox[f]:r.layoutBox[f],m=Lc(h);h.min=n[f].min,h.max=h.min+m}):lK(s,r.layoutBox,n)&&Zc(f=>{const h=i?r.measuredBox[f]:r.layoutBox[f],m=Lc(n[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const l=Ov();Wy(l,n,r.layoutBox);const c=Ov();i?Wy(c,e.applyTransform(o,!0),r.measuredBox):Wy(c,n,r.layoutBox);const d=!oK(l);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const v=Es();Hy(v,r.layoutBox,h.layoutBox);const g=Es();Hy(g,n,m.layoutBox),sK(v,g)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=v,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function ppe(e){ap.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function gpe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function vpe(e){e.clearSnapshot()}function P$(e){e.clearMeasurements()}function xpe(e){e.isLayoutDirty=!1}function ype(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function A$(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function bpe(e){e.resolveTargetDelta()}function wpe(e){e.calcProjection()}function jpe(e){e.resetRotation()}function _pe(e){e.removeLeadSnapshot()}function E$(e,t,r){e.translate=rs(t.translate,0,r),e.scale=rs(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function k$(e,t,r,n){e.min=rs(t.min,r.min,n),e.max=rs(t.max,r.max,n)}function Npe(e,t,r,n){k$(e.x,t.x,r.x,n),k$(e.y,t.y,r.y,n)}function Spe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Cpe={duration:.45,ease:[.4,0,.1,1]},I$=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),O$=I$("applewebkit/")&&!I$("chrome/")?Math.round:ps;function T$(e){e.min=O$(e.min),e.max=O$(e.max)}function Ppe(e){T$(e.x),T$(e.y)}function lK(e,t,r){return e==="position"||e==="preserve-aspect"&&!lI(_$(t),_$(r),.2)}const Ape=iK({attachResizeListener:(e,t)=>Cf(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),eA={current:void 0},cK=iK({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!eA.current){const e=new Ape({});e.mount(window),e.setOptions({layoutScroll:!0}),eA.current=e}return eA.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Epe={pan:{Feature:Whe},drag:{Feature:Vhe,ProjectionNode:cK,MeasureLayout:rK}},kpe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Ipe(e){const t=kpe.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function fI(e,t,r=1){const[n,o]=Ipe(e);if(!n)return;const s=window.getComputedStyle(t).getPropertyValue(n);if(s){const i=s.trim();return WG(i)?parseFloat(i):i}else return tI(o)?fI(o,t,r+1):o}function Ope(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(o=>{const s=o.get();if(!tI(s))return;const i=fI(s,n);i&&o.set(i)});for(const o in t){const s=t[o];if(!tI(s))continue;const i=fI(s,n);i&&(t[o]=i,r||(r={}),r[o]===void 0&&(r[o]=s))}return{target:t,transitionEnd:r}}const Tpe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),dK=e=>Tpe.has(e),Dpe=e=>Object.keys(e).some(dK),D$=e=>e===wg||e===ia,M$=(e,t)=>parseFloat(e.split(", ")[t]),R$=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const o=n.match(/^matrix3d\((.+)\)$/);if(o)return M$(o[1],t);{const s=n.match(/^matrix\((.+)\)$/);return s?M$(s[1],e):0}},Mpe=new Set(["x","y","z"]),Rpe=o1.filter(e=>!Mpe.has(e));function Lpe(e){const t=[];return Rpe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const yx={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:R$(4,13),y:R$(5,14)};yx.translateX=yx.x;yx.translateY=yx.y;const Fpe=(e,t,r)=>{const n=t.measureViewportBox(),o=t.current,s=getComputedStyle(o),{display:i}=s,l={};i==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(d=>{l[d]=yx[d](n,s)}),t.render();const c=t.measureViewportBox();return r.forEach(d=>{const u=t.getValue(d);u&&u.jump(l[d]),e[d]=yx[d](c,s)}),e},$pe=(e,t,r={},n={})=>{t={...t},n={...n};const o=Object.keys(t).filter(dK);let s=[],i=!1;const l=[];if(o.forEach(c=>{const d=e.getValue(c);if(!e.hasValue(c))return;let u=r[c],f=Q0(u);const h=t[c];let m;if(R_(h)){const v=h.length,g=h[0]===null?1:0;u=h[g],f=Q0(u);for(let y=g;y<v&&h[y]!==null;y++)m?S4(Q0(h[y])===m):m=Q0(h[y])}else m=Q0(h);if(f!==m)if(D$(f)&&D$(m)){const v=d.get();typeof v=="string"&&d.set(parseFloat(v)),typeof h=="string"?t[c]=parseFloat(h):Array.isArray(h)&&m===ia&&(t[c]=h.map(parseFloat))}else f?.transform&&m?.transform&&(u===0||h===0)?u===0?d.set(m.transform(u)):t[c]=f.transform(h):(i||(s=Lpe(e),i=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],d.jump(h))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,d=Fpe(t,e,l);return s.length&&s.forEach(([u,f])=>{e.getValue(u).set(f)}),e.render(),tC&&c!==null&&window.scrollTo({top:c}),{target:d,transitionEnd:n}}else return{target:t,transitionEnd:n}};function Bpe(e,t,r,n){return Dpe(t)?$pe(e,t,r,n):{target:t,transitionEnd:n}}const qpe=(e,t,r,n)=>{const o=Ope(e,t,n);return t=o.target,n=o.transitionEnd,Bpe(e,t,r,n)},mI={current:null},uK={current:!1};function zpe(){if(uK.current=!0,!!tC)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>mI.current=e.matches;e.addListener(t),t()}else mI.current=!1}function Upe(e,t,r){const{willChange:n}=t;for(const o in t){const s=t[o],i=r[o];if(Xl(s))e.addValue(o,s),B_(n)&&n.add(o);else if(Xl(i))e.addValue(o,xx(s,{owner:e})),B_(n)&&n.remove(o);else if(i!==s)if(e.hasValue(o)){const l=e.getValue(o);!l.hasAnimated&&l.set(s)}else{const l=e.getStaticValue(o);e.addValue(o,xx(l!==void 0?l:s,{owner:e}))}}for(const o in r)t[o]===void 0&&e.removeValue(o);return t}const L$=new WeakMap,fK=Object.keys(zb),Vpe=fK.length,F$=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Wpe=g4.length;class Hpe{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:o,visualState:s},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>To.render(this.render,!1,!0);const{latestValues:l,renderState:c}=s;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=i,this.isControllingVariants=nC(r),this.isVariantNode=YH(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(r,{});for(const f in u){const h=u[f];l[f]!==void 0&&Xl(h)&&(h.set(l[f],!1),B_(d)&&d.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,L$.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),uK.current||zpe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:mI.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){L$.delete(this.current),this.projection&&this.projection.unmount(),Uf(this.notifyUpdate),Uf(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=bg.has(t),o=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&To.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{o(),s()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,o,s){let i,l;for(let c=0;c<Vpe;c++){const d=fK[c],{isEnabled:u,Feature:f,ProjectionNode:h,MeasureLayout:m}=zb[d];h&&(i=h),u(r)&&(!this.features[d]&&f&&(this.features[d]=new f(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&i){this.projection=new i(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:d,drag:u,dragConstraints:f,layoutScroll:h,layoutRoot:m}=r;this.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!u||f&&kv(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:s,layoutScroll:h,layoutRoot:m})}return l}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Es()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<F$.length;n++){const o=F$[n];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const s=t["on"+o];s&&(this.propEventSubscriptions[o]=this.on(o,s))}this.prevMotionValues=Upe(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<Wpe;n++){const o=g4[n],s=this.props[o];(qb(s)||s===!1)&&(r[o]=s)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=xx(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,o=typeof n=="string"||typeof n=="object"?(r=N4(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&o!==void 0)return o;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Xl(s)?s:this.initialValues[t]!==void 0&&o===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new D4),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class mK extends Hpe{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:o},s){let i=che(n,t||{},this);if(o&&(r&&(r=o(r)),n&&(n=o(n)),i&&(i=o(i))),s){ihe(this,n,i);const l=qpe(this,n,i,r);r=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:r,...n}}}function Gpe(e){return window.getComputedStyle(e)}class Kpe extends mK{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(bg.has(r)){const n=E4(r);return n&&n.default||0}else{const n=Gpe(t),o=(eG(r)?n.getPropertyValue(r):n[r])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(t,{transformPagePoint:r}){return eK(t,r)}build(t,r,n,o){y4(t,r,n,o.transformTemplate)}scrapeMotionValuesFromProps(t,r){return _4(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Xl(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,o){sG(t,r,n,o)}}class Xpe extends mK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(bg.has(r)){const n=E4(r);return n&&n.default||0}return r=iG.has(r)?r:h4(r),t.getAttribute(r)}measureInstanceViewportBox(){return Es()}scrapeMotionValuesFromProps(t,r){return cG(t,r)}build(t,r,n,o){w4(t,r,n,this.isSVGTag,o.transformTemplate)}renderInstance(t,r,n,o){lG(t,r,n,o)}mount(t){this.isSVGTag=j4(t.tagName),super.mount(t)}}const Ype=(e,t)=>x4(e)?new Xpe(t,{enableHardwareAcceleration:!1}):new Kpe(t,{enableHardwareAcceleration:!0}),Jpe={layout:{ProjectionNode:cK,MeasureLayout:rK}},Qpe={...Nhe,...Vfe,...Epe,...Jpe},Pr=Zue((e,t)=>Ife(e,t,Qpe,Ype));function hK(){const e=p.useRef(!1);return m4(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Zpe(){const e=hK(),[t,r]=p.useState(0),n=p.useCallback(()=>{e.current&&r(t+1)},[t]);return[p.useCallback(()=>To.postRender(n),[n]),t]}class ege extends p.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function tge({children:e,isPresent:t}){const r=p.useId(),n=p.useRef(null),o=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:s,height:i,top:l,left:c}=o.current;if(t||!n.current||!s||!i)return;n.current.dataset.motionPopId=r;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${i}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),p.createElement(ege,{isPresent:t,childRef:n,sizeRef:o},p.cloneElement(e,{ref:n}))}const tA=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:o,presenceAffectsLayout:s,mode:i})=>{const l=dG(rge),c=p.useId(),d=p.useMemo(()=>({id:c,initial:t,isPresent:r,custom:o,onExitComplete:u=>{l.set(u,!0);for(const f of l.values())if(!f)return;n&&n()},register:u=>(l.set(u,!1),()=>l.delete(u))}),s?void 0:[r]);return p.useMemo(()=>{l.forEach((u,f)=>l.set(f,!1))},[r]),p.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),i==="popLayout"&&(e=p.createElement(tge,{isPresent:r},e)),p.createElement(eC.Provider,{value:d},e)};function rge(){return new Map}function nge(e){return p.useEffect(()=>()=>e(),[])}const op=e=>e.key||"";function age(e,t){e.forEach(r=>{const n=op(r);t.set(n,r)})}function oge(e){const t=[];return p.Children.forEach(e,r=>{p.isValidElement(r)&&t.push(r)}),t}const sge=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:o,presenceAffectsLayout:s=!0,mode:i="sync"})=>{const l=p.useContext(v4).forceRender||Zpe()[0],c=hK(),d=oge(e);let u=d;const f=p.useRef(new Map).current,h=p.useRef(u),m=p.useRef(new Map).current,v=p.useRef(!0);if(m4(()=>{v.current=!1,age(d,m),h.current=u}),nge(()=>{v.current=!0,m.clear(),f.clear()}),v.current)return p.createElement(p.Fragment,null,u.map(b=>p.createElement(tA,{key:op(b),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:s,mode:i},b)));u=[...u];const g=h.current.map(op),y=d.map(op),x=g.length;for(let b=0;b<x;b++){const w=g[b];y.indexOf(w)===-1&&!f.has(w)&&f.set(w,void 0)}return i==="wait"&&f.size&&(u=[]),f.forEach((b,w)=>{if(y.indexOf(w)!==-1)return;const j=m.get(w);if(!j)return;const _=g.indexOf(w);let C=b;if(!C){const E=()=>{f.delete(w);const A=Array.from(m.keys()).filter(P=>!y.includes(P));if(A.forEach(P=>m.delete(P)),h.current=d.filter(P=>{const F=op(P);return F===w||A.includes(F)}),!f.size){if(c.current===!1)return;l(),n&&n()}};C=p.createElement(tA,{key:op(j),isPresent:!1,onExitComplete:E,custom:t,presenceAffectsLayout:s,mode:i},j),f.set(w,C)}u.splice(_,0,C)}),u=u.map(b=>{const w=b.key;return f.has(w)?b:p.createElement(tA,{key:op(b),isPresent:!0,presenceAffectsLayout:s,mode:i},b)}),p.createElement(p.Fragment,null,f.size?u:u.map(b=>p.cloneElement(b)))};function $$(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function iC(...e){return t=>{let r=!1;const n=e.map(o=>{const s=$$(o,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let o=0;o<n.length;o++){const s=n[o];typeof s=="function"?s():$$(e[o],null)}}}}function za(...e){return p.useCallback(iC(...e),e)}function _h(e){const t=lge(e),r=p.forwardRef((n,o)=>{const{children:s,...i}=n,l=p.Children.toArray(s),c=l.find(dge);if(c){const d=c.props.children,u=l.map(f=>f===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:f);return a.jsx(t,{...i,ref:o,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...i,ref:o,children:s})});return r.displayName=`${e}.Slot`,r}var ige=_h("Slot");function lge(e){const t=p.forwardRef((r,n)=>{const{children:o,...s}=r;if(p.isValidElement(o)){const i=fge(o),l=uge(s,o.props);return o.type!==p.Fragment&&(l.ref=n?iC(n,i):i),p.cloneElement(o,l)}return p.Children.count(o)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var pK=Symbol("radix.slottable");function cge(e){const t=({children:r})=>a.jsx(a.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=pK,t}function dge(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===pK}function uge(e,t){const r={...t};for(const n in t){const o=e[n],s=t[n];/^on[A-Z]/.test(n)?o&&s?r[n]=(...l)=>{const c=s(...l);return o(...l),c}:o&&(r[n]=o):n==="style"?r[n]={...o,...s}:n==="className"&&(r[n]=[o,s].filter(Boolean).join(" "))}return{...e,...r}}function fge(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const B$=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,q$=pa,M4=(e,t)=>r=>{var n;if(t?.variants==null)return q$(e,r?.class,r?.className);const{variants:o,defaultVariants:s}=t,i=Object.keys(o).map(d=>{const u=r?.[d],f=s?.[d];if(u===null)return null;const h=B$(u)||B$(f);return o[d][h]}),l=r&&Object.entries(r).reduce((d,u)=>{let[f,h]=u;return h===void 0||(d[f]=h),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let{class:f,className:h,...m}=u;return Object.entries(m).every(v=>{let[g,y]=v;return Array.isArray(y)?y.includes({...s,...l}[g]):{...s,...l}[g]===y})?[...d,f,h]:d},[]);return q$(e,i,c,r?.class,r?.className)},Vb=M4("inline-flex items-center justify-center rounded-sm text-sm font-bold tracking-wide transition-all duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background active:scale-[0.98] disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-brand text-primary-foreground hover:bg-brand/90 shadow-lg shadow-brand/15",destructive:"bg-danger text-white hover:bg-danger/90 shadow-lg shadow-danger/15",outline:"border border-border bg-transparent hover:bg-accent hover:text-accent-foreground",secondary:"bg-surface-2 text-secondary-foreground hover:bg-surface-2/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-brand underline-offset-4 hover:underline",success:"bg-success text-white hover:bg-success/90 shadow-lg shadow-success/15"},size:{default:"h-10 px-5 py-2 gap-2",sm:"h-9 rounded-sm px-3 gap-1.5",lg:"h-12 rounded-md px-8 gap-2.5 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ce=_e.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...o},s)=>{const i=n?ige:"button";return a.jsx(i,{className:mr(Vb({variant:t,size:r,className:e})),ref:s,...o})});ce.displayName="Button";const k2=[{to:"/",icon:Eue,label:"Painel Principal"},{to:"/agenda",icon:Ns,label:"Agenda"},{to:"/vendas",icon:a1,label:"Loja"},{to:"/financeiro",icon:HH,label:"Financeiro"},{to:"/fiscal",icon:i4,label:"Central Fiscal"}],qj={hidden:{opacity:0,x:-20},visible:e=>({opacity:1,x:0,transition:{delay:e*.05+.3,duration:.3,ease:"easeOut"}})},mge=({to:e,icon:t,label:r,index:n,onNavigate:o})=>{const s="flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand w-full",i="flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent w-full";return a.jsx(Pr.li,{custom:n,variants:qj,initial:"hidden",animate:"visible",whileHover:{x:4},transition:{type:"spring",stiffness:300,damping:15},children:a.jsxs(_u,{to:e,onClick:o,className:({isActive:l})=>e==="/isis"&&l?"flex items-center h-[52px] px-4 rounded-sm font-bold text-white shadow-lg shadow-emerald-500/10 border-l-4 border-transparent bg-gradient-to-r from-fuchsia-600 via-violet-600 to-emerald-600 ring-1 ring-white/10":l?s:i,children:[e==="/isis"?a.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(xd,{size:"sm"})})}):a.jsx(t,{className:"h-5 w-5 mr-4 flex-shrink-0"}),a.jsx("span",{className:"text-base flex items-center gap-2",children:r})]})})};function hge({onNavigate:e,isVisible:t,setIsVisible:r,sidebarPinned:n}){const o=Ls(),s=["/produtos","/compras","/clientes","/equipe","/quadras","/empresas","/finalizadoras"],i=p.useMemo(()=>s.includes(o.pathname),[o.pathname]),[l,c]=p.useState(i),d=p.useRef(null);p.useRef(null);const u=p.useRef(0),f=p.useRef(0),h=()=>{window.innerWidth<768&&r(!1)};return p.useEffect(()=>{const m=y=>{window.innerWidth>=768||(u.current=y.touches[0].clientX,f.current=y.touches[0].clientY)},v=y=>{if(window.innerWidth>=768)return;const x=y.touches[0].clientX,b=y.touches[0].clientY,w=x-u.current,j=Math.abs(b-f.current);u.current<50&&w>50&&j<50&&r(!0)},g=()=>{u.current=0,f.current=0};return window.addEventListener("touchstart",m,{passive:!0}),window.addEventListener("touchmove",v,{passive:!0}),window.addEventListener("touchend",g,{passive:!0}),()=>{window.removeEventListener("touchstart",m),window.removeEventListener("touchmove",v),window.removeEventListener("touchend",g)}},[t]),a.jsx(a.Fragment,{children:a.jsxs(Pr.aside,{ref:d,initial:!1,animate:{width:n||t?280:0},className:`h-screen bg-surface flex flex-col border-r border-border shadow-xl shadow-black/20 overflow-hidden\r
                   fixed inset-y-0 left-0 z-40 md:static md:flex-shrink-0`,children:[a.jsxs(Pr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"flex items-center px-6 pt-8 pb-6 h-[120px] flex-shrink-0",children:[a.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center mr-4",children:a.jsx(jc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),a.jsx("nav",{className:"flex-1 overflow-y-auto px-6 py-2 scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent hover:scrollbar-thumb-border-hover",children:a.jsxs("ul",{className:"space-y-3",children:[k2.map((m,v)=>a.jsx(mge,{...m,index:v,onNavigate:h},m.to)),a.jsxs(Pr.li,{custom:k2.length,variants:qj,initial:"hidden",animate:"visible",children:[a.jsxs("button",{type:"button",onClick:()=>c(m=>!m),className:`w-full flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 ${i?"bg-brand text-primary-foreground font-bold border-brand":"border-transparent"}`,children:[a.jsx(wue,{className:"h-5 w-5 mr-4 flex-shrink-0"}),a.jsx("span",{className:"text-base flex-1 text-left",children:"Cadastros"}),a.jsx(i0,{className:`h-4 w-4 transition-transform ${l?"rotate-180":""}`})]}),l&&a.jsxs("ul",{className:"mt-2 ml-8 space-y-2",children:[a.jsx("li",{children:a.jsxs(_u,{to:"/clientes",onClick:h,className:({isActive:m})=>m?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(ml,{className:"h-4 w-4 mr-3"})," Clientes & Fornecedores"]})}),a.jsx("li",{children:a.jsxs(_u,{to:"/finalizadoras",onClick:h,className:({isActive:m})=>m?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(qm,{className:"h-4 w-4 mr-3"})," Finalizadoras"]})}),a.jsx("li",{children:a.jsxs(_u,{to:"/produtos",onClick:h,className:({isActive:m})=>m?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(_d,{className:"h-4 w-4 mr-3"})," Produtos"]})}),a.jsx("li",{children:a.jsxs(_u,{to:"/compras",onClick:h,className:({isActive:m})=>m?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Gv,{className:"h-4 w-4 mr-3"})," Compras"]})}),a.jsx("li",{children:a.jsxs(_u,{to:"/equipe",onClick:h,className:({isActive:m})=>m?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(zue,{className:"h-4 w-4 mr-3"})," Equipe"]})}),a.jsx("li",{children:a.jsxs(_u,{to:"/quadras",onClick:h,className:({isActive:m})=>m?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Aue,{className:"h-4 w-4 mr-3"})," Quadras"]})}),a.jsx("li",{children:a.jsxs(_u,{to:"/empresas",onClick:h,className:({isActive:m})=>m?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(T_,{className:"h-4 w-4 mr-3"})," Empresa"]})})]})]}),a.jsx(Pr.li,{custom:k2.length+1,variants:qj,initial:"hidden",animate:"visible",className:"pt-4 border-t border-border/50 mt-4",children:a.jsxs(_u,{to:"/suporte",onClick:h,className:({isActive:m})=>m?"flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand":"flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent",children:[a.jsx(BH,{className:"h-5 w-5 mr-4 flex-shrink-0"}),a.jsx("span",{className:"text-base",children:"Suporte"})]})}),a.jsx(Pr.li,{custom:k2.length+2,variants:qj,initial:"hidden",animate:"visible",children:a.jsxs(_u,{to:"/isis",onClick:h,className:({isActive:m})=>m?"flex items-center h-[56px] px-4 rounded-sm font-extrabold text-text-primary bg-surface-2/80 border border-white/20 shadow-[inset_0_0_0_1px_rgba(255,255,255,0.06)]":"flex items-center h-[56px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border border-white/15",children:[a.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(xd,{size:"sm"})})}),a.jsx("span",{className:"text-lg font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300",children:"sis"})]})})]})})]})})}function bn(e,t,{checkForDefaultPrevented:r=!0}={}){return function(o){if(e?.(o),r===!1||!o.defaultPrevented)return t?.(o)}}function pge(e,t){const r=p.createContext(t),n=s=>{const{children:i,...l}=s,c=p.useMemo(()=>l,Object.values(l));return a.jsx(r.Provider,{value:c,children:i})};n.displayName=e+"Provider";function o(s){const i=p.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[n,o]}function Pd(e,t=[]){let r=[];function n(s,i){const l=p.createContext(i),c=r.length;r=[...r,i];const d=f=>{const{scope:h,children:m,...v}=f,g=h?.[e]?.[c]||l,y=p.useMemo(()=>v,Object.values(v));return a.jsx(g.Provider,{value:y,children:m})};d.displayName=s+"Provider";function u(f,h){const m=h?.[e]?.[c]||l,v=p.useContext(m);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${s}\``)}return[d,u]}const o=()=>{const s=r.map(i=>p.createContext(i));return function(l){const c=l?.[e]||s;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return o.scopeName=e,[n,gge(o,...t)]}function gge(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=n.reduce((l,{useScope:c,scopeName:d})=>{const f=c(s)[`__scope${d}`];return{...l,...f}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}var Ii=globalThis?.document?p.useLayoutEffect:()=>{},vge=c3[" useId ".trim().toString()]||(()=>{}),xge=0;function nu(e){const[t,r]=p.useState(vge());return Ii(()=>{e||r(n=>n??String(xge++))},[e]),e||(t?`radix-${t}`:"")}var yge=c3[" useInsertionEffect ".trim().toString()]||Ii;function Vf({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[o,s,i]=bge({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:o;{const u=p.useRef(e!==void 0);p.useEffect(()=>{const f=u.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,n])}const d=p.useCallback(u=>{if(l){const f=wge(u)?u(e):u;f!==e&&i.current?.(f)}else s(u)},[l,e,s,i]);return[c,d]}function bge({defaultProp:e,onChange:t}){const[r,n]=p.useState(e),o=p.useRef(r),s=p.useRef(t);return yge(()=>{s.current=t},[t]),p.useEffect(()=>{o.current!==r&&(s.current?.(r),o.current=r)},[r,o]),[r,n,s]}function wge(e){return typeof e=="function"}var jge=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],oa=jge.reduce((e,t)=>{const r=_h(`Primitive.${t}`),n=p.forwardRef((o,s)=>{const{asChild:i,...l}=o,c=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function R4(e,t){e&&Qf.flushSync(()=>e.dispatchEvent(t))}function Yl(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...r)=>t.current?.(...r),[])}function _ge(e,t=globalThis?.document){const r=Yl(e);p.useEffect(()=>{const n=o=>{o.key==="Escape"&&r(o)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var Nge="DismissableLayer",hI="dismissableLayer.update",Sge="dismissableLayer.pointerDownOutside",Cge="dismissableLayer.focusOutside",z$,gK=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),c0=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:i,onDismiss:l,...c}=e,d=p.useContext(gK),[u,f]=p.useState(null),h=u?.ownerDocument??globalThis?.document,[,m]=p.useState({}),v=za(t,E=>f(E)),g=Array.from(d.layers),[y]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),x=g.indexOf(y),b=u?g.indexOf(u):-1,w=d.layersWithOutsidePointerEventsDisabled.size>0,j=b>=x,_=Age(E=>{const A=E.target,P=[...d.branches].some(F=>F.contains(A));!j||P||(o?.(E),i?.(E),E.defaultPrevented||l?.())},h),C=Ege(E=>{const A=E.target;[...d.branches].some(F=>F.contains(A))||(s?.(E),i?.(E),E.defaultPrevented||l?.())},h);return _ge(E=>{b===d.layers.size-1&&(n?.(E),!E.defaultPrevented&&l&&(E.preventDefault(),l()))},h),p.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(z$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),U$(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=z$)}},[u,h,r,d]),p.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),U$())},[u,d]),p.useEffect(()=>{const E=()=>m({});return document.addEventListener(hI,E),()=>document.removeEventListener(hI,E)},[]),a.jsx(oa.div,{...c,ref:v,style:{pointerEvents:w?j?"auto":"none":void 0,...e.style},onFocusCapture:bn(e.onFocusCapture,C.onFocusCapture),onBlurCapture:bn(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:bn(e.onPointerDownCapture,_.onPointerDownCapture)})});c0.displayName=Nge;var Pge="DismissableLayerBranch",vK=p.forwardRef((e,t)=>{const r=p.useContext(gK),n=p.useRef(null),o=za(t,n);return p.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),a.jsx(oa.div,{...e,ref:o})});vK.displayName=Pge;function Age(e,t=globalThis?.document){const r=Yl(e),n=p.useRef(!1),o=p.useRef(()=>{});return p.useEffect(()=>{const s=l=>{if(l.target&&!n.current){let c=function(){xK(Sge,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=c,t.addEventListener("click",o.current,{once:!0})):c()}else t.removeEventListener("click",o.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",s),t.removeEventListener("click",o.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Ege(e,t=globalThis?.document){const r=Yl(e),n=p.useRef(!1);return p.useEffect(()=>{const o=s=>{s.target&&!n.current&&xK(Cge,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function U$(){const e=new CustomEvent(hI);document.dispatchEvent(e)}function xK(e,t,r,{discrete:n}){const o=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&o.addEventListener(e,t,{once:!0}),n?R4(o,s):o.dispatchEvent(s)}var kge=c0,Ige=vK,rA="focusScope.autoFocusOnMount",nA="focusScope.autoFocusOnUnmount",V$={bubbles:!1,cancelable:!0},Oge="FocusScope",c1=p.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...i}=e,[l,c]=p.useState(null),d=Yl(o),u=Yl(s),f=p.useRef(null),h=za(t,g=>c(g)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(n){let g=function(w){if(m.paused||!l)return;const j=w.target;l.contains(j)?f.current=j:_m(f.current,{select:!0})},y=function(w){if(m.paused||!l)return;const j=w.relatedTarget;j!==null&&(l.contains(j)||_m(f.current,{select:!0}))},x=function(w){if(document.activeElement===document.body)for(const _ of w)_.removedNodes.length>0&&_m(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const b=new MutationObserver(x);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),b.disconnect()}}},[n,l,m.paused]),p.useEffect(()=>{if(l){H$.add(m);const g=document.activeElement;if(!l.contains(g)){const x=new CustomEvent(rA,V$);l.addEventListener(rA,d),l.dispatchEvent(x),x.defaultPrevented||(Tge(Fge(yK(l)),{select:!0}),document.activeElement===g&&_m(l))}return()=>{l.removeEventListener(rA,d),setTimeout(()=>{const x=new CustomEvent(nA,V$);l.addEventListener(nA,u),l.dispatchEvent(x),x.defaultPrevented||_m(g??document.body,{select:!0}),l.removeEventListener(nA,u),H$.remove(m)},0)}}},[l,d,u,m]);const v=p.useCallback(g=>{if(!r&&!n||m.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,x=document.activeElement;if(y&&x){const b=g.currentTarget,[w,j]=Dge(b);w&&j?!g.shiftKey&&x===j?(g.preventDefault(),r&&_m(w,{select:!0})):g.shiftKey&&x===w&&(g.preventDefault(),r&&_m(j,{select:!0})):x===b&&g.preventDefault()}},[r,n,m.paused]);return a.jsx(oa.div,{tabIndex:-1,...i,ref:h,onKeyDown:v})});c1.displayName=Oge;function Tge(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(_m(n,{select:t}),document.activeElement!==r)return}function Dge(e){const t=yK(e),r=W$(t,e),n=W$(t.reverse(),e);return[r,n]}function yK(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function W$(e,t){for(const r of e)if(!Mge(r,{upTo:t}))return r}function Mge(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Rge(e){return e instanceof HTMLInputElement&&"select"in e}function _m(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Rge(e)&&t&&e.select()}}var H$=Lge();function Lge(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=G$(e,t),e.unshift(t)},remove(t){e=G$(e,t),e[0]?.resume()}}}function G$(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function Fge(e){return e.filter(t=>t.tagName!=="A")}var $ge="Portal",d0=p.forwardRef((e,t)=>{const{container:r,...n}=e,[o,s]=p.useState(!1);Ii(()=>s(!0),[]);const i=r||o&&globalThis?.document?.body;return i?e4.createPortal(a.jsx(oa.div,{...n,ref:t}),i):null});d0.displayName=$ge;function Bge(e,t){return p.useReducer((r,n)=>t[r][n]??r,e)}var Bc=e=>{const{present:t,children:r}=e,n=qge(t),o=typeof r=="function"?r({present:n.isPresent}):p.Children.only(r),s=za(n.ref,zge(o));return typeof r=="function"||n.isPresent?p.cloneElement(o,{ref:s}):null};Bc.displayName="Presence";function qge(e){const[t,r]=p.useState(),n=p.useRef(null),o=p.useRef(e),s=p.useRef("none"),i=e?"mounted":"unmounted",[l,c]=Bge(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const d=I2(n.current);s.current=l==="mounted"?d:"none"},[l]),Ii(()=>{const d=n.current,u=o.current;if(u!==e){const h=s.current,m=I2(d);e?c("MOUNT"):m==="none"||d?.display==="none"?c("UNMOUNT"):c(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,c]),Ii(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,f=m=>{const g=I2(n.current).includes(CSS.escape(m.animationName));if(m.target===t&&g&&(c("ANIMATION_END"),!o.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},h=m=>{m.target===t&&(s.current=I2(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function I2(e){return e?.animationName||"none"}function zge(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var aA=0;function lC(){p.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??K$()),document.body.insertAdjacentElement("beforeend",e[1]??K$()),aA++,()=>{aA===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),aA--}},[])}function K$(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Au=function(){return Au=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Au.apply(this,arguments)};function bK(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function Uge(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var zj="right-scroll-bar-position",Uj="width-before-scroll-bar",Vge="with-scroll-bars-hidden",Wge="--removed-body-scroll-bar-size";function oA(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Hge(e,t){var r=p.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var o=r.value;o!==n&&(r.value=n,r.callback(n,o))}}}})[0];return r.callback=t,r.facade}var Gge=typeof window<"u"?p.useLayoutEffect:p.useEffect,X$=new WeakMap;function Kge(e,t){var r=Hge(t||null,function(n){return e.forEach(function(o){return oA(o,n)})});return Gge(function(){var n=X$.get(r);if(n){var o=new Set(n),s=new Set(e),i=r.current;o.forEach(function(l){s.has(l)||oA(l,null)}),s.forEach(function(l){o.has(l)||oA(l,i)})}X$.set(r,e)},[e]),r}function Xge(e){return e}function Yge(e,t){t===void 0&&(t=Xge);var r=[],n=!1,o={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var i=t(s,n);return r.push(i),function(){r=r.filter(function(l){return l!==i})}},assignSyncMedium:function(s){for(n=!0;r.length;){var i=r;r=[],i.forEach(s)}r={push:function(l){return s(l)},filter:function(){return r}}},assignMedium:function(s){n=!0;var i=[];if(r.length){var l=r;r=[],l.forEach(s),i=r}var c=function(){var u=i;i=[],u.forEach(s)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(u){i.push(u),d()},filter:function(u){return i=i.filter(u),r}}}};return o}function Jge(e){e===void 0&&(e={});var t=Yge(null);return t.options=Au({async:!0,ssr:!1},e),t}var wK=function(e){var t=e.sideCar,r=bK(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return p.createElement(n,Au({},r))};wK.isSideCarExport=!0;function Qge(e,t){return e.useMedium(t),wK}var jK=Jge(),sA=function(){},cC=p.forwardRef(function(e,t){var r=p.useRef(null),n=p.useState({onScrollCapture:sA,onWheelCapture:sA,onTouchMoveCapture:sA}),o=n[0],s=n[1],i=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,u=e.enabled,f=e.shards,h=e.sideCar,m=e.noRelative,v=e.noIsolation,g=e.inert,y=e.allowPinchZoom,x=e.as,b=x===void 0?"div":x,w=e.gapMode,j=bK(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=h,C=Kge([r,t]),E=Au(Au({},j),o);return p.createElement(p.Fragment,null,u&&p.createElement(_,{sideCar:jK,removeScrollBar:d,shards:f,noRelative:m,noIsolation:v,inert:g,setCallbacks:s,allowPinchZoom:!!y,lockRef:r,gapMode:w}),i?p.cloneElement(p.Children.only(l),Au(Au({},E),{ref:C})):p.createElement(b,Au({},E,{className:c,ref:C}),l))});cC.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};cC.classNames={fullWidth:Uj,zeroRight:zj};var Y$,Zge=function(){if(Y$)return Y$;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function eve(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Zge();return t&&e.setAttribute("nonce",t),e}function tve(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function rve(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var nve=function(){var e=0,t=null;return{add:function(r){e==0&&(t=eve())&&(tve(t,r),rve(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},ave=function(){var e=nve();return function(t,r){p.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},_K=function(){var e=ave(),t=function(r){var n=r.styles,o=r.dynamic;return e(n,o),null};return t},ove={left:0,top:0,right:0,gap:0},iA=function(e){return parseInt(e||"",10)||0},sve=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[iA(r),iA(n),iA(o)]},ive=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return ove;var t=sve(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},lve=_K(),Kv="data-scroll-locked",cve=function(e,t,r,n){var o=e.left,s=e.top,i=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Vge,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Kv,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zj,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Uj,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(zj," .").concat(zj,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Uj," .").concat(Uj,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Kv,`] {
    `).concat(Wge,": ").concat(l,`px;
  }
`)},J$=function(){var e=parseInt(document.body.getAttribute(Kv)||"0",10);return isFinite(e)?e:0},dve=function(){p.useEffect(function(){return document.body.setAttribute(Kv,(J$()+1).toString()),function(){var e=J$()-1;e<=0?document.body.removeAttribute(Kv):document.body.setAttribute(Kv,e.toString())}},[])},uve=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,o=n===void 0?"margin":n;dve();var s=p.useMemo(function(){return ive(o)},[o]);return p.createElement(lve,{styles:cve(s,!t,o,r?"":"!important")})},pI=!1;if(typeof window<"u")try{var O2=Object.defineProperty({},"passive",{get:function(){return pI=!0,!0}});window.addEventListener("test",O2,O2),window.removeEventListener("test",O2,O2)}catch{pI=!1}var Fg=pI?{passive:!1}:!1,fve=function(e){return e.tagName==="TEXTAREA"},NK=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!fve(e)&&r[t]==="visible")},mve=function(e){return NK(e,"overflowY")},hve=function(e){return NK(e,"overflowX")},Q$=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=SK(e,n);if(o){var s=CK(e,n),i=s[1],l=s[2];if(i>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},pve=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},gve=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},SK=function(e,t){return e==="v"?mve(t):hve(t)},CK=function(e,t){return e==="v"?pve(t):gve(t)},vve=function(e,t){return e==="h"&&t==="rtl"?-1:1},xve=function(e,t,r,n,o){var s=vve(e,window.getComputedStyle(t).direction),i=s*n,l=r.target,c=t.contains(l),d=!1,u=i>0,f=0,h=0;do{if(!l)break;var m=CK(e,l),v=m[0],g=m[1],y=m[2],x=g-y-s*v;(v||x)&&SK(e,l)&&(f+=x,h+=v);var b=l.parentNode;l=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&(o&&Math.abs(f)<1||!o&&i>f)||!u&&(o&&Math.abs(h)<1||!o&&-i>h))&&(d=!0),d},T2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Z$=function(e){return[e.deltaX,e.deltaY]},e6=function(e){return e&&"current"in e?e.current:e},yve=function(e,t){return e[0]===t[0]&&e[1]===t[1]},bve=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},wve=0,$g=[];function jve(e){var t=p.useRef([]),r=p.useRef([0,0]),n=p.useRef(),o=p.useState(wve++)[0],s=p.useState(_K)[0],i=p.useRef(e);p.useEffect(function(){i.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var g=Uge([e.lockRef.current],(e.shards||[]).map(e6),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!i.current.allowPinchZoom;var x=T2(g),b=r.current,w="deltaX"in g?g.deltaX:b[0]-x[0],j="deltaY"in g?g.deltaY:b[1]-x[1],_,C=g.target,E=Math.abs(w)>Math.abs(j)?"h":"v";if("touches"in g&&E==="h"&&C.type==="range")return!1;var A=Q$(E,C);if(!A)return!0;if(A?_=E:(_=E==="v"?"h":"v",A=Q$(E,C)),!A)return!1;if(!n.current&&"changedTouches"in g&&(w||j)&&(n.current=_),!_)return!0;var P=n.current||_;return xve(P,y,g,P==="h"?w:j,!0)},[]),c=p.useCallback(function(g){var y=g;if(!(!$g.length||$g[$g.length-1]!==s)){var x="deltaY"in y?Z$(y):T2(y),b=t.current.filter(function(_){return _.name===y.type&&(_.target===y.target||y.target===_.shadowParent)&&yve(_.delta,x)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var w=(i.current.shards||[]).map(e6).filter(Boolean).filter(function(_){return _.contains(y.target)}),j=w.length>0?l(y,w[0]):!i.current.noIsolation;j&&y.cancelable&&y.preventDefault()}}},[]),d=p.useCallback(function(g,y,x,b){var w={name:g,delta:y,target:x,should:b,shadowParent:_ve(x)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(j){return j!==w})},1)},[]),u=p.useCallback(function(g){r.current=T2(g),n.current=void 0},[]),f=p.useCallback(function(g){d(g.type,Z$(g),g.target,l(g,e.lockRef.current))},[]),h=p.useCallback(function(g){d(g.type,T2(g),g.target,l(g,e.lockRef.current))},[]);p.useEffect(function(){return $g.push(s),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener("wheel",c,Fg),document.addEventListener("touchmove",c,Fg),document.addEventListener("touchstart",u,Fg),function(){$g=$g.filter(function(g){return g!==s}),document.removeEventListener("wheel",c,Fg),document.removeEventListener("touchmove",c,Fg),document.removeEventListener("touchstart",u,Fg)}},[]);var m=e.removeScrollBar,v=e.inert;return p.createElement(p.Fragment,null,v?p.createElement(s,{styles:bve(o)}):null,m?p.createElement(uve,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function _ve(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Nve=Qge(jK,jve);var PK=p.forwardRef(function(e,t){return p.createElement(cC,Au({},e,{ref:t,sideCar:Nve}))});PK.classNames=cC.classNames;const dC=PK;var Sve=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Bg=new WeakMap,D2=new WeakMap,M2={},lA=0,AK=function(e){return e&&(e.host||AK(e.parentNode))},Cve=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=AK(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Pve=function(e,t,r,n){var o=Cve(t,Array.isArray(e)?e:[e]);M2[r]||(M2[r]=new WeakMap);var s=M2[r],i=[],l=new Set,c=new Set(o),d=function(f){!f||l.has(f)||(l.add(f),d(f.parentNode))};o.forEach(d);var u=function(f){!f||c.has(f)||Array.prototype.forEach.call(f.children,function(h){if(l.has(h))u(h);else try{var m=h.getAttribute(n),v=m!==null&&m!=="false",g=(Bg.get(h)||0)+1,y=(s.get(h)||0)+1;Bg.set(h,g),s.set(h,y),i.push(h),g===1&&v&&D2.set(h,!0),y===1&&h.setAttribute(r,"true"),v||h.setAttribute(n,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),l.clear(),lA++,function(){i.forEach(function(f){var h=Bg.get(f)-1,m=s.get(f)-1;Bg.set(f,h),s.set(f,m),h||(D2.has(f)||f.removeAttribute(n),D2.delete(f)),m||f.removeAttribute(r)}),lA--,lA||(Bg=new WeakMap,Bg=new WeakMap,D2=new WeakMap,M2={})}},uC=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),o=t||Sve(e);return o?(n.push.apply(n,Array.from(o.querySelectorAll("[aria-live], script"))),Pve(n,o,r,"aria-hidden")):function(){return null}},fC="Dialog",[EK,kK]=Pd(fC),[Ave,mu]=EK(fC),IK=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:o,onOpenChange:s,modal:i=!0}=e,l=p.useRef(null),c=p.useRef(null),[d,u]=Vf({prop:n,defaultProp:o??!1,onChange:s,caller:fC});return a.jsx(Ave,{scope:t,triggerRef:l,contentRef:c,contentId:nu(),titleId:nu(),descriptionId:nu(),open:d,onOpenChange:u,onOpenToggle:p.useCallback(()=>u(f=>!f),[u]),modal:i,children:r})};IK.displayName=fC;var OK="DialogTrigger",TK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=mu(OK,r),s=za(t,o.triggerRef);return a.jsx(oa.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":$4(o.open),...n,ref:s,onClick:bn(e.onClick,o.onOpenToggle)})});TK.displayName=OK;var L4="DialogPortal",[Eve,DK]=EK(L4,{forceMount:void 0}),MK=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:o}=e,s=mu(L4,t);return a.jsx(Eve,{scope:t,forceMount:r,children:p.Children.map(n,i=>a.jsx(Bc,{present:r||s.open,children:a.jsx(d0,{asChild:!0,container:o,children:i})}))})};MK.displayName=L4;var z_="DialogOverlay",RK=p.forwardRef((e,t)=>{const r=DK(z_,e.__scopeDialog),{forceMount:n=r.forceMount,...o}=e,s=mu(z_,e.__scopeDialog);return s.modal?a.jsx(Bc,{present:n||s.open,children:a.jsx(Ive,{...o,ref:t})}):null});RK.displayName=z_;var kve=_h("DialogOverlay.RemoveScroll"),Ive=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=mu(z_,r);return a.jsx(dC,{as:kve,allowPinchZoom:!0,shards:[o.contentRef],children:a.jsx(oa.div,{"data-state":$4(o.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),eg="DialogContent",LK=p.forwardRef((e,t)=>{const r=DK(eg,e.__scopeDialog),{forceMount:n=r.forceMount,...o}=e,s=mu(eg,e.__scopeDialog);return a.jsx(Bc,{present:n||s.open,children:s.modal?a.jsx(Ove,{...o,ref:t}):a.jsx(Tve,{...o,ref:t})})});LK.displayName=eg;var Ove=p.forwardRef((e,t)=>{const r=mu(eg,e.__scopeDialog),n=p.useRef(null),o=za(t,r.contentRef,n);return p.useEffect(()=>{const s=n.current;if(s)return uC(s)},[]),a.jsx(FK,{...e,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:bn(e.onCloseAutoFocus,s=>{s.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:bn(e.onPointerDownOutside,s=>{const i=s.detail.originalEvent,l=i.button===0&&i.ctrlKey===!0;(i.button===2||l)&&s.preventDefault()}),onFocusOutside:bn(e.onFocusOutside,s=>s.preventDefault())})}),Tve=p.forwardRef((e,t)=>{const r=mu(eg,e.__scopeDialog),n=p.useRef(!1),o=p.useRef(!1);return a.jsx(FK,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{e.onCloseAutoFocus?.(s),s.defaultPrevented||(n.current||r.triggerRef.current?.focus(),s.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:s=>{e.onInteractOutside?.(s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=s.target;r.triggerRef.current?.contains(i)&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}})}),FK=p.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:s,...i}=e,l=mu(eg,r),c=p.useRef(null),d=za(t,c);return lC(),a.jsxs(a.Fragment,{children:[a.jsx(c1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:s,children:a.jsx(c0,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":$4(l.open),...i,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(Mve,{titleId:l.titleId}),a.jsx(Lve,{contentRef:c,descriptionId:l.descriptionId})]})]})}),F4="DialogTitle",$K=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=mu(F4,r);return a.jsx(oa.h2,{id:o.titleId,...n,ref:t})});$K.displayName=F4;var BK="DialogDescription",qK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=mu(BK,r);return a.jsx(oa.p,{id:o.descriptionId,...n,ref:t})});qK.displayName=BK;var zK="DialogClose",UK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,o=mu(zK,r);return a.jsx(oa.button,{type:"button",...n,ref:t,onClick:bn(e.onClick,()=>o.onOpenChange(!1))})});UK.displayName=zK;function $4(e){return e?"open":"closed"}var VK="DialogTitleWarning",[Dve,WK]=pge(VK,{contentName:eg,titleName:F4,docsSlug:"dialog"}),Mve=({titleId:e})=>{const t=WK(VK),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return p.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Rve="DialogDescriptionWarning",Lve=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${WK(Rve).contentName}}.`;return p.useEffect(()=>{const o=e.current?.getAttribute("aria-describedby");t&&o&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},HK=IK,Fve=TK,GK=MK,B4=RK,q4=LK,z4=$K,U4=qK,mC=UK;const xn=HK,$ve=GK,ih=mC,KK=_e.forwardRef(({className:e,disableAnimations:t,...r},n)=>{const o=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),s=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,i=(t??!1)||o||s;return a.jsx(B4,{ref:n,className:mr("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",i?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r})});KK.displayName=B4.displayName;const vn=_e.forwardRef(({className:e,children:t,overlayClassName:r,disableAnimations:n,alignTop:o,...s},i)=>{const l=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),c=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,d=(n??!1)||l||c;return a.jsxs($ve,{children:[a.jsx(KK,{disableAnimations:d,className:r}),a.jsxs(q4,{ref:i,className:mr("fixed z-50 grid w-full max-w-lg gap-4 border border-border bg-surface p-6 shadow-lg duration-200 sm:rounded-lg",o?"left-1/2 top-[10%] -translate-x-1/2":"left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",d?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,children:[t,a.jsxs(mC,{className:"absolute right-3 top-3 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground p-1",children:[a.jsx(yl,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]})});vn.displayName=q4.displayName;const pn=({className:e,...t})=>a.jsx("div",{className:mr("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});pn.displayName="DialogHeader";const ra=({className:e,...t})=>a.jsx("div",{className:mr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});ra.displayName="DialogFooter";const fn=_e.forwardRef(({className:e,...t},r)=>a.jsx(z4,{ref:r,className:mr("text-lg font-semibold leading-none tracking-tight",e),...t}));fn.displayName=z4.displayName;const On=_e.forwardRef(({className:e,...t},r)=>a.jsx(U4,{ref:r,className:mr("text-sm text-text-secondary",e),...t}));On.displayName=U4.displayName;const Bve=1;let cA=0;function qve(){return cA=(cA+1)%Number.MAX_VALUE,cA.toString()}const cl={state:{toasts:[]},listeners:[],getState:()=>cl.state,setState:e=>{typeof e=="function"?cl.state=e(cl.state):cl.state={...cl.state,...e},cl.listeners.forEach(t=>t(cl.state))},subscribe:e=>(cl.listeners.push(e),()=>{cl.listeners=cl.listeners.filter(t=>t!==e)})},Vj=({...e})=>{const t=qve(),r=o=>cl.setState(s=>({...s,toasts:s.toasts.map(i=>i.id===t?{...i,...o}:i)})),n=()=>cl.setState(o=>({...o,toasts:o.toasts.filter(s=>s.id!==t)}));return cl.setState(o=>({...o,toasts:[{...e,id:t,dismiss:n},...o.toasts].slice(0,Bve)})),{id:t,dismiss:n,update:r}};function no(){const[e,t]=p.useState(cl.getState());return p.useEffect(()=>cl.subscribe(n=>{t(n)}),[]),p.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const o=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(o)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:Vj,toasts:e.toasts}}const zve="main",Uve={dev:{supabaseUrl:"https://xlbgopcindcsteymtwjp.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhsYmdvcGNpbmRjc3RleW10d2pwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3MDAwMTQsImV4cCI6MjA4MDI3NjAxNH0.0ydvsFW8j5ZKCyHalAlFWHjjK8QbcDC6mZQzVJ0lSnA"},main:{supabaseUrl:"https://dlfryxtyxqoacuunswuc.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY"}},Vve=Object.freeze(Object.defineProperty({__proto__:null,ACTIVE_TARGET:zve,TARGETS:Uve},Symbol.toStringTag,{value:"Module"})),Wve=void 0,Hve=void 0,Gve=Object.freeze(Object.defineProperty({__proto__:null,ACTIVE_TARGET:Wve,TARGETS:Hve},Symbol.toStringTag,{value:"Module"})),Kve="modulepreload",Xve=function(e){return"/"+e},t6={},zu=function(t,r,n){if(!r||r.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=Xve(s),s in t6)return;t6[s]=!0;const i=s.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!n)for(let u=o.length-1;u>=0;u--){const f=o[u];if(f.href===s&&(!i||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${l}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":Kve,i||(d.as="script",d.crossOrigin=""),d.href=s,document.head.appendChild(d),i)return new Promise((u,f)=>{d.addEventListener("load",u),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s})},Yve=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>zu(()=>Promise.resolve().then(()=>u0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class V4 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class r6 extends V4{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class n6 extends V4{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class a6 extends V4{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var gI;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(gI||(gI={}));var Jve=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Qve{constructor(t,{headers:r={},customFetch:n,region:o=gI.Any}={}){this.url=t,this.headers=r,this.region=o,this.fetch=Yve(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Jve(this,arguments,void 0,function*(r,n={}){var o;try{const{headers:s,method:i,body:l,signal:c}=n;let d={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let h;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(d["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(d["Content-Type"]="application/json",h=JSON.stringify(l)));const m=yield this.fetch(f.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),s),body:h,signal:c}).catch(x=>{throw x.name==="AbortError"?x:new r6(x)}),v=m.headers.get("x-relay-error");if(v&&v==="true")throw new n6(m);if(!m.ok)throw new a6(m);let g=((o=m.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),y;return g==="application/json"?y=yield m.json():g==="application/octet-stream"?y=yield m.blob():g==="text/event-stream"?y=m:g==="multipart/form-data"?y=yield m.formData():y=yield m.text(),{data:y,error:null,response:m}}catch(s){return s instanceof Error&&s.name==="AbortError"?{data:null,error:new r6(s)}:{data:null,error:s,response:s instanceof a6||s instanceof n6?s.context:void 0}}})}}var Rl={},W4={},hC={},d1={},pC={},gC={},Zve=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},bx=Zve();const exe=bx.fetch,XK=bx.fetch.bind(bx),YK=bx.Headers,txe=bx.Request,rxe=bx.Response,u0=Object.freeze(Object.defineProperty({__proto__:null,Headers:YK,Request:txe,Response:rxe,default:XK,fetch:exe},Symbol.toStringTag,{value:"Module"})),nxe=sie(u0);var vC={};Object.defineProperty(vC,"__esModule",{value:!0});let axe=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};vC.default=axe;var JK=Gi&&Gi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gC,"__esModule",{value:!0});const oxe=JK(nxe),sxe=JK(vC);let ixe=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=oxe.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let o=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,l,c,d;let u=null,f=null,h=null,m=s.status,v=s.statusText;if(s.ok){if(this.method!=="HEAD"){const b=await s.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?f=b:f=JSON.parse(b))}const y=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),x=(c=s.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");y&&x&&x.length>1&&(h=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,h=null,m=406,v="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const y=await s.text();try{u=JSON.parse(y),Array.isArray(u)&&s.status===404&&(f=[],u=null,m=200,v="OK")}catch{s.status===404&&y===""?(m=204,v="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((d=u?.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,m=200,v="OK"),u&&this.shouldThrowOnError)throw new sxe.default(u)}return{error:u,data:f,count:h,status:m,statusText:v}});return this.shouldThrowOnError||(o=o.catch(s=>{var i,l,c;return{error:{message:`${(i=s?.name)!==null&&i!==void 0?i:"FetchError"}: ${s?.message}`,details:`${(l=s?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=s?.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),o.then(t,r)}returns(){return this}overrideTypes(){return this}};gC.default=ixe;var lxe=Gi&&Gi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pC,"__esModule",{value:!0});const cxe=lxe(gC);let dxe=class extends cxe.default{select(t){let r=!1;const n=(t??"*").split("").map(o=>/\s/.test(o)&&!r?"":(o==='"'&&(r=!r),o)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:o,referencedTable:s=o}={}){const i=s?`${s}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(o,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:o=n}={}){const s=typeof o>"u"?"offset":`${o}.offset`,i=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:o=!1,wal:s=!1,format:i="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,o?"buffers":null,s?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${d}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};pC.default=dxe;var uxe=Gi&&Gi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(d1,"__esModule",{value:!0});const fxe=uxe(pC);let mxe=class extends fxe.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:o}={}){let s="";o==="plain"?s="pl":o==="phrase"?s="ph":o==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const o=n?`${n}.or`:"or";return this.url.searchParams.append(o,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};d1.default=mxe;var hxe=Gi&&Gi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hC,"__esModule",{value:!0});const ey=hxe(d1);let pxe=class{constructor(t,{headers:r={},schema:n,fetch:o}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=o}select(t,r){const{head:n=!1,count:o}=r??{},s=n?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",l),o&&this.headers.append("Prefer",`count=${o}`),new ey.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var o;const s="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(i.length>0){const l=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ey.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:o,defaultToNull:s=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),o&&this.headers.append("Prefer",`count=${o}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new ey.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const o="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new ey.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new ey.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};hC.default=pxe;var QK=Gi&&Gi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(W4,"__esModule",{value:!0});const gxe=QK(hC),vxe=QK(d1);let xxe=class ZK{constructor(t,{headers:r={},schema:n,fetch:o}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=o}from(t){const r=new URL(`${this.url}/${t}`);return new gxe.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new ZK(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:o=!1,count:s}={}){var i;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;n||o?(l=n?"HEAD":"GET",Object.entries(r).filter(([f,h])=>h!==void 0).map(([f,h])=>[f,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([f,h])=>{c.searchParams.append(f,h)})):(l="POST",d=r);const u=new Headers(this.headers);return s&&u.set("Prefer",`count=${s}`),new vxe.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};W4.default=xxe;var f0=Gi&&Gi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rl,"__esModule",{value:!0});Rl.PostgrestError=Rl.PostgrestBuilder=Rl.PostgrestTransformBuilder=Rl.PostgrestFilterBuilder=Rl.PostgrestQueryBuilder=Rl.PostgrestClient=void 0;const eX=f0(W4);Rl.PostgrestClient=eX.default;const tX=f0(hC);Rl.PostgrestQueryBuilder=tX.default;const rX=f0(d1);Rl.PostgrestFilterBuilder=rX.default;const nX=f0(pC);Rl.PostgrestTransformBuilder=nX.default;const aX=f0(gC);Rl.PostgrestBuilder=aX.default;const oX=f0(vC);Rl.PostgrestError=oX.default;var yxe=Rl.default={PostgrestClient:eX.default,PostgrestQueryBuilder:tX.default,PostgrestFilterBuilder:rX.default,PostgrestTransformBuilder:nX.default,PostgrestBuilder:aX.default,PostgrestError:oX.default};const{PostgrestClient:bxe,PostgrestQueryBuilder:Blt,PostgrestFilterBuilder:qlt,PostgrestTransformBuilder:zlt,PostgrestBuilder:Ult,PostgrestError:Vlt}=yxe;class wxe{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,o=parseInt(n.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const jxe="2.75.0",_xe=`realtime-js/${jxe}`,Nxe="1.0.0",vI=1e4,Sxe=1e3,Cxe=100;var Gy;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Gy||(Gy={}));var Vs;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Vs||(Vs={}));var Hd;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Hd||(Hd={}));var xI;(function(e){e.websocket="websocket"})(xI||(xI={}));var hp;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(hp||(hp={}));class Pxe{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const o=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const l=n.decode(t.slice(i,i+o));i=i+o;const c=n.decode(t.slice(i,i+s));i=i+s;const d=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class sX{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ao;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ao||(Ao={}));const o6=(e,t,r={})=>{var n;const o=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,i)=>(s[i]=Axe(i,e,t,o),s),{}):{}},Axe=(e,t,r,n)=>{const o=t.find(l=>l.name===e),s=o?.type,i=r[e];return s&&!n.includes(s)?iX(s,i):yI(i)},iX=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Oxe(t,r)}switch(e){case Ao.bool:return Exe(t);case Ao.float4:case Ao.float8:case Ao.int2:case Ao.int4:case Ao.int8:case Ao.numeric:case Ao.oid:return kxe(t);case Ao.json:case Ao.jsonb:return Ixe(t);case Ao.timestamp:return Txe(t);case Ao.abstime:case Ao.date:case Ao.daterange:case Ao.int4range:case Ao.int8range:case Ao.money:case Ao.reltime:case Ao.text:case Ao.time:case Ao.timestamptz:case Ao.timetz:case Ao.tsrange:case Ao.tstzrange:return yI(t);default:return yI(t)}},yI=e=>e,Exe=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},kxe=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Ixe=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Oxe=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(l=>iX(t,l))}return e},Txe=e=>typeof e=="string"?e.replace(" ","T"):e,lX=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class dA{constructor(t,r,n={},o=vI){this.channel=t,this.event=r,this.payload=n,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var s6;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(s6||(s6={}));class Ky{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},o=>{const{onJoin:s,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ky.syncState(this.state,o,s,i),this.pendingDiffs.forEach(c=>{this.state=Ky.syncDiff(this.state,c,s,i)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},o=>{const{onJoin:s,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Ky.syncDiff(this.state,o,s,i),l())}),this.onJoin((o,s,i)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:s,newPresences:i})}),this.onLeave((o,s,i)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,o){const s=this.cloneDeep(t),i=this.transformState(r),l={},c={};return this.map(s,(d,u)=>{i[d]||(c[d]=u)}),this.map(i,(d,u)=>{const f=s[d];if(f){const h=u.map(y=>y.presence_ref),m=f.map(y=>y.presence_ref),v=u.filter(y=>m.indexOf(y.presence_ref)<0),g=f.filter(y=>h.indexOf(y.presence_ref)<0);v.length>0&&(l[d]=v),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(s,{joins:l,leaves:c},n,o)}static syncDiff(t,r,n,o){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),o||(o=()=>{}),this.map(s,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const f=t[l].map(m=>m.presence_ref),h=u.filter(m=>f.indexOf(m.presence_ref)<0);t[l].unshift(...h)}n(l,u,c)}),this.map(i,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[l]=d,o(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const o=t[n];return"metas"in o?r[n]=o.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=o,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var i6;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(i6||(i6={}));var Xy;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Xy||(Xy={}));var xf;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(xf||(xf={}));class H4{constructor(t,r={config:{}},n){var o,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Vs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new dA(this,Hd.join,this.params,this.timeout),this.rejoinTimer=new sX(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Vs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Vs.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Vs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Vs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Vs.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Hd.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new Ky(this),this.broadcastEndpointURL=lX(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(o=this.params.config)===null||o===void 0?void 0:o.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,o,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Vs.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,d=(o=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&o!==void 0?o:[],u=!!this.bindings[Xy.PRESENCE]&&this.bindings[Xy.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>t?.(xf.CHANNEL_ERROR,m)),this._onClose(()=>t?.(xf.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var v;if(this.socket.setAuth(),m===void 0){t?.(xf.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(v=g?.length)!==null&&v!==void 0?v:0,x=[];for(let b=0;b<y;b++){const w=g[b],{filter:{event:j,schema:_,table:C,filter:E}}=w,A=m&&m[b];if(A&&A.event===j&&A.schema===_&&A.table===C&&A.filter===E)x.push(Object.assign(Object.assign({},w),{id:A.id}));else{this.unsubscribe(),this.state=Vs.errored,t?.(xf.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(xf.SUBSCRIBED);return}}).receive("error",m=>{this.state=Vs.errored,t?.(xf.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t?.(xf.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Vs.joined&&t===Xy.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,o;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((o=d.body)===null||o===void 0?void 0:o.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Vs.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Hd.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(o=>{n=new dA(this,Hd.leave,{},t),n.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Vs.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const o=new AbortController,s=setTimeout(()=>o.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new dA(this,t,r,n);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Cxe){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var o,s;const i=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Hd;if(n&&[l,c,d,u].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(m=>{var v,g,y;return((v=m.filter)===null||v===void 0?void 0:v.event)==="*"||((y=(g=m.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(m=>m.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(m=>{var v,g,y,x,b,w;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const j=m.id,_=(v=m.filter)===null||v===void 0?void 0:v.event;return j&&((g=r.ids)===null||g===void 0?void 0:g.includes(j))&&(_==="*"||_?.toLocaleLowerCase()===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const j=(b=(x=m?.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return j==="*"||j===((w=r?.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:g,table:y,commit_timestamp:x,type:b,errors:w}=v;h=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:x,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(v))}m.callback(h,n)})}_isClosed(){return this.state===Vs.closed}_isJoined(){return this.state===Vs.joined}_isJoining(){return this.state===Vs.joining}_isLeaving(){return this.state===Vs.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const o=t.toLocaleLowerCase(),s={type:o,filter:r,callback:n};return this.bindings[o]?this.bindings[o].push(s):this.bindings[o]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(o=>{var s;return!(((s=o.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&H4.isEqual(o.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Hd.close,{},t)}_onError(t){this._on(Hd.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Vs.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=o6(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=o6(t.columns,t.old_record)),r}}const uA=()=>{},R2={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Dxe=[1e3,2e3,5e3,1e4],Mxe=1e4,Rxe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Lxe{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=vI,this.transport=null,this.heartbeatIntervalMs=R2.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=uA,this.ref=0,this.reconnectTimer=null,this.logger=uA,this.conn=null,this.sendBuffer=[],this.serializer=new Pxe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let s;return o?s=o:typeof fetch>"u"?s=(...i)=>zu(()=>Promise.resolve().then(()=>u0),void 0).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${xI.websocket}`,this.httpEndpoint=lX(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=wxe.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Nxe}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Gy.connecting:return hp.Connecting;case Gy.open:return hp.Open;case Gy.closing:return hp.Closing;default:return hp.Closed}}isConnected(){return this.connectionState()===hp.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,o=this.getChannels().find(s=>s.topic===n);if(o)return o;{const s=new H4(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:o,ref:s}=t,i=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${s})`,o),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Sxe,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},R2.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:o,payload:s,ref:i}=r,l=i?`(${i})`:"",c=s.status||"";this.log("receive",`${c} ${n} ${o} ${l}`.trim(),s),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(o,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Hd.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${t}${n}${o}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Rxe],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const o={access_token:r,version:_xe};r&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(Hd.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(o){this.log("error",`error in ${t} callback`,o)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new sX(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},R2.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,o,s,i,l,c,d,u;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:vI,this.heartbeatIntervalMs=(o=t?.heartbeatIntervalMs)!==null&&o!==void 0?o:R2.HEARTBEAT_INTERVAL,this.worker=(s=t?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t?.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=t?.heartbeatCallback)!==null&&l!==void 0?l:uA,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:f=>Dxe[f-1]||Mxe,this.encode=(d=t?.encode)!==null&&d!==void 0?d:(f,h)=>h(JSON.stringify(f)),this.decode=(u=t?.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class G4 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Os(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Fxe extends G4{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class bI extends G4{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var $xe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const cX=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>zu(()=>Promise.resolve().then(()=>u0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Bxe=()=>$xe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield zu(()=>Promise.resolve().then(()=>u0),void 0)).Response:Response}),wI=e=>{if(Array.isArray(e))return e.map(r=>wI(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const o=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[o]=wI(n)}),t},qxe=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var jg=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const fA=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),zxe=(e,t,r)=>jg(void 0,void 0,void 0,function*(){const n=yield Bxe();e instanceof n&&!r?.noResolveJson?e.json().then(o=>{const s=e.status||500,i=o?.statusCode||s+"";t(new Fxe(fA(o),s,i))}).catch(o=>{t(new bI(fA(o),o))}):t(new bI(fA(e),e))}),Uxe=(e,t,r,n)=>{const o={method:e,headers:t?.headers||{}};return e==="GET"||!n?o:(qxe(n)?(o.headers=Object.assign({"Content-Type":"application/json"},t?.headers),o.body=JSON.stringify(n)):o.body=n,t?.duplex&&(o.duplex=t.duplex),Object.assign(Object.assign({},o),r))};function u1(e,t,r,n,o,s){return jg(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(r,Uxe(t,n,o,s)).then(c=>{if(!c.ok)throw c;return n?.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>zxe(c,l,n))})})}function U_(e,t,r,n){return jg(this,void 0,void 0,function*(){return u1(e,"GET",t,r,n)})}function Cu(e,t,r,n,o){return jg(this,void 0,void 0,function*(){return u1(e,"POST",t,n,o,r)})}function jI(e,t,r,n,o){return jg(this,void 0,void 0,function*(){return u1(e,"PUT",t,n,o,r)})}function Vxe(e,t,r,n){return jg(this,void 0,void 0,function*(){return u1(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function dX(e,t,r,n,o){return jg(this,void 0,void 0,function*(){return u1(e,"DELETE",t,n,o,r)})}var Wxe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Hxe{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Wxe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Os(t))return{data:null,error:t};throw t}})}}var Gxe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Kxe{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}asStream(){return new Hxe(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.execute().then(t,r)}execute(){return Gxe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Os(t))return{data:null,error:t};throw t}})}}var Il=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Xxe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},l6={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Yxe{constructor(t,r={},n,o){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=cX(o)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,o){return Il(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},l6),o);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c))):(s=n,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),o?.headers&&(l=Object.assign(Object.assign({},l),o.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield(t=="PUT"?jI:Cu)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:l},i?.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Os(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Il(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,o){return Il(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:l6.upsert},o),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield jI(this.fetch,l.toString(),c,{headers:u});return{data:{path:s,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Os(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Il(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const o=Object.assign({},this.headers);r?.upsert&&(o["x-upsert"]="true");const s=yield Cu(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:o}),i=new URL(this.url+s.url),l=i.searchParams.get("token");if(!l)throw new G4("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Os(n))return{data:null,error:n};throw n}})}update(t,r,n){return Il(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Il(this,void 0,void 0,function*(){try{return{data:yield Cu(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Os(o))return{data:null,error:o};throw o}})}copy(t,r,n){return Il(this,void 0,void 0,function*(){try{return{data:{path:(yield Cu(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Os(o))return{data:null,error:o};throw o}})}createSignedUrl(t,r,n){return Il(this,void 0,void 0,function*(){try{let o=this._getFinalPath(t),s=yield Cu(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Os(o))return{data:null,error:o};throw o}})}createSignedUrls(t,r,n){return Il(this,void 0,void 0,function*(){try{const o=yield Cu(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:o.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Os(o))return{data:null,error:o};throw o}})}download(t,r){const o=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),i=s?`?${s}`:"",l=this._getFinalPath(t),c=()=>U_(this.fetch,`${this.url}/${o}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new Kxe(c,this.shouldThrowOnError)}info(t){return Il(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield U_(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:wI(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Os(n))return{data:null,error:n};throw n}})}exists(t){return Il(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Vxe(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Os(n)&&n instanceof bI){const o=n.originalError;if([400,404].includes(o?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),o=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&o.push(s);const l=typeof r?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(r?.transform||{});c!==""&&o.push(c);let d=o.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return Il(this,void 0,void 0,function*(){try{return{data:yield dX(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Os(r))return{data:null,error:r};throw r}})}list(t,r,n){return Il(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},Xxe),r),{prefix:t||""});return{data:yield Cu(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},n),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Os(o))return{data:null,error:o};throw o}})}listV2(t,r){return Il(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Cu(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Os(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Jxe="2.75.0",Qxe={"X-Client-Info":`storage-js/${Jxe}`};var qg=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Zxe{constructor(t,r={},n,o){this.shouldThrowOnError=!1;const s=new URL(t);o?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qxe),r),this.fetch=cX(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return qg(this,void 0,void 0,function*(){try{return{data:yield U_(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Os(t))return{data:null,error:t};throw t}})}getBucket(t){return qg(this,void 0,void 0,function*(){try{return{data:yield U_(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Os(r))return{data:null,error:r};throw r}})}createBucket(t){return qg(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Cu(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Os(o))return{data:null,error:o};throw o}})}updateBucket(t,r){return qg(this,void 0,void 0,function*(){try{return{data:yield jI(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Os(n))return{data:null,error:n};throw n}})}emptyBucket(t){return qg(this,void 0,void 0,function*(){try{return{data:yield Cu(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Os(r))return{data:null,error:r};throw r}})}deleteBucket(t){return qg(this,void 0,void 0,function*(){try{return{data:yield dX(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Os(r))return{data:null,error:r};throw r}})}}class e0e extends Zxe{constructor(t,r={},n,o){super(t,r,n,o)}from(t){return new Yxe(this.url,this.headers,t,this.fetch)}}const t0e="2.75.0";let Cy="";typeof Deno<"u"?Cy="deno":typeof document<"u"?Cy="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Cy="react-native":Cy="node";const r0e={"X-Client-Info":`supabase-js-${Cy}/${t0e}`},n0e={headers:r0e},a0e={schema:"public"},o0e={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},s0e={};var i0e=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const l0e=e=>{let t;return e?t=e:typeof fetch>"u"?t=XK:t=fetch,(...r)=>t(...r)},c0e=()=>typeof Headers>"u"?YK:Headers,d0e=(e,t,r)=>{const n=l0e(r),o=c0e();return(s,i)=>i0e(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new o(i?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(s,Object.assign(Object.assign({},i),{headers:d}))})};var u0e=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function f0e(e){return e.endsWith("/")?e:e+"/"}function m0e(e,t){var r,n;const{db:o,auth:s,realtime:i,global:l}=e,{db:c,auth:d,realtime:u,global:f}=t,h={db:Object.assign(Object.assign({},c),o),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f?.headers)!==null&&r!==void 0?r:{}),(n=l?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>u0e(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function h0e(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(f0e(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const uX="2.75.0",fv=30*1e3,_I=3,mA=_I*fv,p0e="http://localhost:9999",g0e="supabase.auth.token",v0e={"X-Client-Info":`gotrue-js/${uX}`},NI="X-Supabase-Api-Version",fX={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},x0e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,y0e=10*60*1e3;class Wb extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Zn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class b0e extends Wb{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function w0e(e){return Zn(e)&&e.name==="AuthApiError"}class pp extends Wb{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Dh extends Wb{constructor(t,r,n,o){super(t,n,o),this.name=r,this.status=n}}class Nm extends Dh{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function j0e(e){return Zn(e)&&e.name==="AuthSessionMissingError"}class zg extends Dh{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class L2 extends Dh{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class F2 extends Dh{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function _0e(e){return Zn(e)&&e.name==="AuthImplicitGrantRedirectError"}class c6 extends Dh{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class SI extends Dh{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function hA(e){return Zn(e)&&e.name==="AuthRetryableFetchError"}class d6 extends Dh{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class CI extends Dh{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const V_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),u6=` 	
\r=`.split(""),N0e=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<u6.length;t+=1)e[u6[t].charCodeAt(0)]=-2;for(let t=0;t<V_.length;t+=1)e[V_[t].charCodeAt(0)]=t;return e})();function f6(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(V_[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(V_[n]),t.queuedBits-=6}}function mX(e,t,r){const n=N0e[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function m6(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},s=i=>{P0e(i,n,r)};for(let i=0;i<e.length;i+=1)mX(e.charCodeAt(i),o,s);return t.join("")}function S0e(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function C0e(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const o=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}S0e(n,t)}}function P0e(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Xv(e){const t=[],r={queue:0,queuedBits:0},n=o=>{t.push(o)};for(let o=0;o<e.length;o+=1)mX(e.charCodeAt(o),r,n);return new Uint8Array(t)}function A0e(e){const t=[];return C0e(e,r=>t.push(r)),new Uint8Array(t)}function jp(e){const t=[],r={queue:0,queuedBits:0},n=o=>{t.push(o)};return e.forEach(o=>f6(o,r,n)),f6(null,r,n),t.join("")}function E0e(e){return Math.round(Date.now()/1e3)+e}function k0e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const uc=()=>typeof window<"u"&&typeof document<"u",Kh={tested:!1,writable:!1},hX=()=>{if(!uc())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Kh.tested)return Kh.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Kh.tested=!0,Kh.writable=!0}catch{Kh.tested=!0,Kh.writable=!1}return Kh.writable};function I0e(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,s)=>{t[s]=o})}catch{}return r.searchParams.forEach((n,o)=>{t[o]=n}),t}const pX=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>zu(()=>Promise.resolve().then(()=>u0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},O0e=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",mv=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Xh=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},pm=async(e,t)=>{await e.removeItem(t)};class xC{constructor(){this.promise=new xC.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}xC.promiseConstructor=Promise;function pA(e){const t=e.split(".");if(t.length!==3)throw new CI("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!x0e.test(t[n]))throw new CI("JWT not in base64url format");return{header:JSON.parse(m6(t[0])),payload:JSON.parse(m6(t[1])),signature:Xv(t[2]),raw:{header:t[0],payload:t[1]}}}async function T0e(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function D0e(e,t){return new Promise((n,o)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){o(i);return}}})()})}function M0e(e){return("0"+e.toString(16)).substr(-2)}function R0e(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let o="";for(let s=0;s<56;s++)o+=r.charAt(Math.floor(Math.random()*n));return o}return crypto.getRandomValues(t),Array.from(t,M0e).join("")}async function L0e(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(n);return Array.from(o).map(s=>String.fromCharCode(s)).join("")}async function F0e(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await L0e(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ug(e,t,r=!1){const n=R0e();let o=n;r&&(o+="/PASSWORD_RECOVERY"),await mv(e,`${t}-code-verifier`,o);const s=await F0e(n);return[s,n===s?"plain":"s256"]}const $0e=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function B0e(e){const t=e.headers.get(NI);if(!t||!t.match($0e))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function q0e(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function z0e(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const U0e=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Vg(e){if(!U0e.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gA(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function h6(e){return JSON.parse(JSON.stringify(e))}var V0e=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const sp=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),W0e=[502,503,504];async function p6(e){var t;if(!O0e(e))throw new SI(sp(e),0);if(W0e.includes(e.status))throw new SI(sp(e),e.status);let r;try{r=await e.json()}catch(s){throw new pp(sp(s),s)}let n;const o=B0e(e);if(o&&o.getTime()>=fX["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new d6(sp(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Nm}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new d6(sp(r),e.status,r.weak_password.reasons);throw new b0e(sp(r),e.status||500,n)}const H0e=(e,t,r,n)=>{const o={method:e,headers:t?.headers||{}};return e==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),r))};async function ba(e,t,r,n){var o;const s=Object.assign({},n?.headers);s[NI]||(s[NI]=fX["2024-01-01"].name),n?.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(o=n?.query)!==null&&o!==void 0?o:{};n?.redirectTo&&(i.redirect_to=n.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await G0e(e,t,r+l,{headers:s,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(c):{data:Object.assign({},c),error:null}}async function G0e(e,t,r,n,o,s){const i=H0e(t,n,o,s);let l;try{l=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new SI(sp(c),0)}if(l.ok||await p6(l),n?.noResolveJson)return l;try{return await l.json()}catch(c){await p6(c)}}function qd(e){var t;let r=null;Y0e(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=E0e(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function g6(e){const t=qd(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Tm(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function K0e(e){return{data:e,error:null}}function X0e(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:o,verification_type:s}=e,i=V0e(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:o,verification_type:s},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function v6(e){return e}function Y0e(e){return e.access_token&&e.refresh_token&&e.expires_in}const vA=["global","local","others"];var J0e=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};class Q0e{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=pX(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=vA[0]){if(vA.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${vA.join(", ")}`);try{return await ba(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Zn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await ba(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Tm})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=J0e(t,["options"]),o=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(o.new_email=n?.newEmail,delete o.newEmail),await ba(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:X0e,redirectTo:r?.redirectTo})}catch(r){if(Zn(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ba(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Tm})}catch(r){if(Zn(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,o,s,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await ba(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(o=t?.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:v6});if(u.error)throw u.error;const f=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Zn(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Vg(t);try{return await ba(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Tm})}catch(r){if(Zn(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Vg(t);try{return await ba(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Tm})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Vg(t);try{return await ba(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Tm})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Vg(t.userId);try{const{data:r,error:n}=await ba(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:n}}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Vg(t.userId),Vg(t.id);try{return{data:await ba(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,o,s,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await ba(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(o=t?.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:v6});if(u.error)throw u.error;const f=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Zn(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await ba(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ba(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await ba(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ba(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}}function x6(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Wg={debug:!!(globalThis&&hX()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class gX extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Z0e extends gX{}async function eye(e,t,r){Wg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Wg.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async o=>{if(o){Wg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,o.name);try{return await r()}finally{Wg.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,o.name)}}else{if(t===0)throw Wg.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Z0e(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Wg.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function tye(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function vX(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function rye(e){return parseInt(e,16)}function nye(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function aye(e){var t;const{chainId:r,domain:n,expirationTime:o,issuedAt:s=new Date,nonce:i,notBefore:l,requestId:c,resources:d,scheme:u,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=vX(e.address),v=u?`${u}://${n}`:n,g=e.statement?`${e.statement}
`:"",y=`${v} wants you to sign in with your Ethereum account:
${m}

${g}`;let x=`URI: ${f}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${s.toISOString()}`;if(o&&(x+=`
Expiration Time: ${o.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),d){let b=`
Resources:`;for(const w of d){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);b+=`
- ${w}`}x+=b}return`${y}
${x}`}class Is extends Error{constructor({message:t,code:r,cause:n,name:o}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=o??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class W_ extends Is{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function oye({error:e,options:t}){var r,n,o;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Is({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Is({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Is({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((o=s.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new Is({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Is({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Is({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Is({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Is({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(yX(i)){if(s.rp.id!==i)return new Is({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Is({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Is({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Is({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Is({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function sye({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Is({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Is({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(yX(n)){if(r.rpId!==n)return new Is({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Is({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Is({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Is({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}var xX=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};class iye{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const lye=new iye;function cye(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,o=xX(e,["challenge","user","excludeCredentials"]),s=Xv(t).buffer,i=Object.assign(Object.assign({},r),{id:Xv(r.id).buffer}),l=Object.assign(Object.assign({},o),{challenge:s,user:i});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Xv(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function dye(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=xX(e,["challenge","allowCredentials"]),o=Xv(t).buffer,s=Object.assign(Object.assign({},n),{challenge:o});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];s.allowCredentials[i]=Object.assign(Object.assign({},l),{id:Xv(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return s}function uye(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:jp(new Uint8Array(e.response.attestationObject)),clientDataJSON:jp(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function fye(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),o=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:jp(new Uint8Array(o.authenticatorData)),clientDataJSON:jp(new Uint8Array(o.clientDataJSON)),signature:jp(new Uint8Array(o.signature)),userHandle:o.userHandle?jp(new Uint8Array(o.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function yX(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function y6(){var e,t;return!!(uc()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function mye(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new W_("Browser returned unexpected credential type",t)}:{data:null,error:new W_("Empty credential response",t)}}catch(t){return{data:null,error:oye({error:t,options:e})}}}async function hye(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new W_("Browser returned unexpected credential type",t)}:{data:null,error:new W_("Empty credential response",t)}}catch(t){return{data:null,error:sye({error:t,options:e})}}}const pye={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},gye={userVerification:"preferred",hints:["security-key"]};function H_(...e){const t=o=>o!==null&&typeof o=="object"&&!Array.isArray(o),r=o=>o instanceof ArrayBuffer||ArrayBuffer.isView(o),n={};for(const o of e)if(o)for(const s in o){const i=o[s];if(i!==void 0)if(Array.isArray(i))n[s]=i;else if(r(i))n[s]=i;else if(t(i)){const l=n[s];t(l)?n[s]=H_(l,i):n[s]=H_(i)}else n[s]=i}return n}function vye(e,t){return H_(pye,e,t||{})}function xye(e,t){return H_(gye,e,t||{})}class yye{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:o},s){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:l};const c=o??lye.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=vye(i.webauthn.credential_options.publicKey,s?.create),{data:u,error:f}=await mye({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const d=xye(i.webauthn.credential_options.publicKey,s?.request),{data:u,error:f}=await hye(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(i){return Zn(i)?{data:null,error:i}:{data:null,error:new pp("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:o}},s){if(!r)return{data:null,error:new Wb("rpId is required for WebAuthn authentication")};try{if(!y6())return{data:null,error:new pp("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:o},{request:s});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(i){return Zn(i)?{data:null,error:i}:{data:null,error:new pp("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:o},s){if(!r)return{data:null,error:new Wb("rpId is required for WebAuthn registration")};try{if(!y6())return{data:null,error:new pp("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:o},{create:s});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return Zn(i)?{data:null,error:i}:{data:null,error:new pp("Unexpected error in register",i)}}}}tye();const bye={url:p0e,storageKey:g0e,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:v0e,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function b6(e,t,r){return await r()}const Hg={};class Hb{get jwks(){var t,r;return(r=(t=Hg[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Hg[this.storageKey]=Object.assign(Object.assign({},Hg[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Hg[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Hg[this.storageKey]=Object.assign(Object.assign({},Hg[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Hb.nextInstanceID,Hb.nextInstanceID+=1,this.instanceID>0&&uc()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},bye),t);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Q0e({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=pX(o.fetch),this.lock=o.lock||b6,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:uc()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=eye:this.lock=b6,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new yye(this)},this.persistSession?(o.storage?this.storage=o.storage:hX()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=x6(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=x6(this.memoryStorage)),uc()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${uX}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=I0e(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),uc()&&this.detectSessionInUrl&&n!=="none"){const{data:o,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),_0e(s)){const c=(t=s.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:l}=o;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Zn(r)?{error:r}:{error:new pp("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,o;try{const s=await ba(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(o=t?.options)===null||o===void 0?void 0:o.captchaToken}},xform:qd}),{data:i,error:l}=s;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(s){if(Zn(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,o;try{let s;if("email"in t){const{email:u,password:f,options:h}=t;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Ug(this.storage,this.storageKey)),s=await ba(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:u,password:f,data:(r=h?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:m,code_challenge_method:v},xform:qd})}else if("phone"in t){const{phone:u,password:f,options:h}=t;s=await ba(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h?.data)!==null&&n!==void 0?n:{},channel:(o=h?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:qd})}else throw new L2("You must provide either an email or phone number and a password");const{data:i,error:l}=s;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(s){if(Zn(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:l}=t;r=await ba(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:g6})}else if("phone"in t){const{phone:s,password:i,options:l}=t;r=await ba(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:g6})}else throw new L2("You must provide either an email or phone number and a password");const{data:n,error:o}=r;return o?{data:{user:null,session:null},error:o}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new zg}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:o})}catch(r){if(Zn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,o,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,o,s,i,l,c,d,u,f,h;let m,v;if("message"in t)m=t.message,v=t.signature;else{const{chain:g,wallet:y,statement:x,options:b}=t;let w;if(uc())if(typeof y=="object")w=y;else{const P=window;if("ethereum"in P&&typeof P.ethereum=="object"&&"request"in P.ethereum&&typeof P.ethereum.request=="function")w=P.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const j=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href),_=await w.request({method:"eth_requestAccounts"}).then(P=>P).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=vX(_[0]);let E=(n=b?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!E){const P=await w.request({method:"eth_chainId"});E=rye(P)}const A={domain:j.host,address:C,statement:x,uri:j.href,version:"1",chainId:E,nonce:(o=b?.signInWithEthereum)===null||o===void 0?void 0:o.nonce,issuedAt:(i=(s=b?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=b?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=b?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=b?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=b?.signInWithEthereum)===null||u===void 0?void 0:u.resources};m=aye(A),v=await w.request({method:"personal_sign",params:[nye(m),C]})}try{const{data:g,error:y}=await ba(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:v},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:qd});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new zg}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(Zn(g))return{data:{user:null,session:null},error:g};throw g}}async signInWithSolana(t){var r,n,o,s,i,l,c,d,u,f,h,m;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:y,wallet:x,statement:b,options:w}=t;let j;if(uc())if(typeof x=="object")j=x;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))j=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=x}const _=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const C=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),b?{statement:b}:null));let E;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")E=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)E=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)v=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),g=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${_.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(o=(n=w?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((s=w?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((i=w?.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(u=w?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const C=await j.signMessage(new TextEncoder().encode(v),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=C}}try{const{data:y,error:x}=await ba(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:jp(g)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:qd});if(x)throw x;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new zg}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:x})}catch(y){if(Zn(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(t){const r=await Xh(this.storage,`${this.storageKey}-code-verifier`),[n,o]=(r??"").split("/");try{const{data:s,error:i}=await ba(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:qd});if(await pm(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new zg}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:i})}catch(s){if(Zn(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:o,access_token:s,nonce:i}=t,l=await ba(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:o,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:qd}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new zg}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Zn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,o,s,i;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Ug(this.storage,this.storageKey));const{error:f}=await ba(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await ba(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(o=c?.data)!==null&&o!==void 0?o:{},create_user:(s=c?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(i=c?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:u}}throw new L2("You must provide either an email or phone number.")}catch(l){if(Zn(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let o,s;"options"in t&&(o=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:l}=await ba(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:qd});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(o){if(Zn(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(t){var r,n,o;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Ug(this.storage,this.storageKey)),await ba(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((o=t?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:K0e})}catch(s){if(Zn(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Nm;const{error:o}=await ba(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:o}})}catch(t){if(Zn(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:o,options:s}=t,{error:i}=await ba(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:o,options:s}=t,{data:i,error:l}=await ba(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:l}}throw new L2("You must provide either an email or phone number and a type")}catch(r){if(Zn(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Xh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<mA:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await Xh(this.userStorage,this.storageKey+"-user");i?.user?t.user=i.user:t.user=gA()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!i&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{data:o,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ba(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Tm}):await this._useSession(async r=>{var n,o,s;const{data:i,error:l}=r;if(l)throw l;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Nm}:await ba(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=i.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:Tm})})}catch(r){if(Zn(r))return j0e(r)&&(await this._removeSession(),await pm(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:o,error:s}=n;if(s)throw s;if(!o.session)throw new Nm;const i=o.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Ug(this.storage,this.storageKey));const{data:d,error:u}=await ba(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Tm});if(u)throw u;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Nm;const r=Date.now()/1e3;let n=r,o=!0,s=null;const{payload:i}=pA(t.access_token);if(i.exp&&(n=i.exp,o=n<=r),o){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;s={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Zn(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:l}=r;if(l)throw l;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Nm;const{data:o,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Zn(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!uc())throw new F2("No browser detected.");if(t.error||t.error_description||t.error_code)throw new F2(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new c6("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new F2("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new c6("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:o,access_token:s,refresh_token:i,expires_in:l,expires_at:c,token_type:d}=t;if(!s||!l||!i||!d)throw new F2("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let h=u+f;c&&(h=parseInt(c));const m=h-u;m*1e3<=fv&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const v=h-f;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,u);const{data:g,error:y}=await this._getUser(s);if(y)throw y;const x={provider_token:n,provider_refresh_token:o,access_token:s,expires_in:f,expires_at:h,refresh_token:i,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Zn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Xh(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:o,error:s}=r;if(s)return{error:s};const i=(n=o.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:l}=await this.admin.signOut(i,t);if(l&&!(w0e(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await pm(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=k0e(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,o;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((o=this.stateChangeEmitters.get(t))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,o=null;this.flowType==="pkce"&&([n,o]=await Ug(this.storage,this.storageKey,!0));try{return await ba(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Zn(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:o}=await this._useSession(async s=>{var i,l,c,d,u;const{data:f,error:h}=s;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ba(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(o)throw o;return uc()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(Zn(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:o,data:{session:s}}=r;if(o)throw o;const{options:i,provider:l,token:c,access_token:d,nonce:u}=t,f=await ba(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:qd}),{data:h,error:m}=f;return m?{data:{user:null,session:null},error:m}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new zg}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),{data:h,error:m})}catch(o){if(Zn(o))return{data:{user:null,session:null},error:o};throw o}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,o;const{data:s,error:i}=r;if(i)throw i;return await ba(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(o=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await D0e(async o=>(o>0&&await T0e(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await ba(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:qd})),(o,s)=>{const i=200*Math.pow(2,o);return s&&hA(s)&&Date.now()+i-n<fv})}catch(n){if(this._debug(r,"error",n),Zn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),uc()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const o=await Xh(this.storage,this.storageKey);if(o&&this.userStorage){let i=await Xh(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:o.user},await mv(this.userStorage,this.storageKey+"-user",i)),o.user=(t=i?.user)!==null&&t!==void 0?t:gA()}else if(o&&!o.user&&!o.user){const i=await Xh(this.storage,this.storageKey+"-user");i&&i?.user?(o.user=i.user,await pm(this.storage,this.storageKey+"-user"),await mv(this.storage,this.storageKey,o)):o.user=gA()}if(this._debug(n,"session from storage",o),!this._isValidSession(o)){this._debug(n,"session is not valid"),o!==null&&await this._removeSession();return}const s=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<mA;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${mA}s`),s){if(this.autoRefreshToken&&o.refresh_token){const{error:i}=await this._callRefreshToken(o.refresh_token);i&&(console.error(i),hA(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(o.access_token);!l&&i?.user?(o.user=i.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(n,"error",o),console.error(o);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Nm;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new xC;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Nm;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={data:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(o,"error",s),Zn(s)){const i={data:null,error:s};return hA(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(t,r,n=!0){const o=`#_notifyAllSubscribers(${t})`;this._debug(o,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){s.push(c)}});if(await Promise.all(i),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(o,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await mv(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const s=h6(o);await mv(this.storage,this.storageKey,s)}else{const o=h6(r);await mv(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await pm(this.storage,this.storageKey),await pm(this.storage,this.storageKey+"-code-verifier"),await pm(this.storage,this.storageKey+"-user"),this.userStorage&&await pm(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&uc()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),fv);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((n.expires_at*1e3-t)/fv);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${fv}ms, refresh threshold is ${_I} ticks`),o<=_I&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof gX)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!uc()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const o=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&o.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Ug(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});o.push(l.toString())}if(n?.queryParams){const s=new URLSearchParams(n.queryParams);o.push(s.toString())}return n?.skipBrowserRedirect&&o.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${o.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;return s?{data:null,error:s}:await ba(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,o;const{data:s,error:i}=r;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await ba(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&c.type==="totp"&&(!((o=c?.totp)===null||o===void 0)&&o.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;if(s)return{data:null,error:s};const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?uye(t.webauthn.credential_response):fye(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await ba(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:s}=r;if(s)return{data:null,error:s};const i=await ba(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:cye(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:dye(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Zn(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const o={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r?.factors)!==null&&t!==void 0?t:[])o.all.push(s),s.status==="verified"&&o[s.factor_type].push(s);return{data:o,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:o},error:s}=t;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=pA(o.access_token);let l=null;i.aal&&(l=i.aal);let c=l;((n=(r=o.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=i.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const o=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+y0e>o)return n;const{data:s,error:i}=await ba(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=o,n=s.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:v}=await this.getSession();if(v||!m.session)return{data:null,error:v};n=m.session.access_token}const{header:o,payload:s,signature:i,raw:{header:l,payload:c}}=pA(n);r?.allowExpired||q0e(s.exp);const d=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:s,header:o,signature:i},error:null}}const u=z0e(o.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,i,A0e(`${l}.${c}`)))throw new CI("Invalid JWT signature");return{data:{claims:s,header:o,signature:i},error:null}}catch(n){if(Zn(n))return{data:null,error:n};throw n}}}Hb.nextInstanceID=0;const wye=Hb;class jye extends wye{constructor(t){super(t)}}var _ye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?s(u.value):o(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Nye{constructor(t,r,n){var o,s,i;this.supabaseUrl=t,this.supabaseKey=r;const l=h0e(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:a0e,realtime:s0e,auth:Object.assign(Object.assign({},o0e),{storageKey:c}),global:n0e},u=m0e(n??{},d);this.storageKey=(o=u.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=d0e(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new bxe(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new e0e(this.storageUrl.href,this.headers,this.fetch,n?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Qve(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return _ye(this,void 0,void 0,function*(){var t,r;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:o,userStorage:s,storageKey:i,flowType:l,lock:c,debug:d},u,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jye({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:o,userStorage:s,flowType:l,lock:c,debug:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Lxe(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const bX=(e,t,r)=>new Nye(e,t,r);function Sye(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Sye()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Cye="https://dlfryxtyxqoacuunswuc.supabase.co",Pye="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY";function K4(){try{if(typeof window<"u"&&window.__SUPABASE_URL)return window.__SUPABASE_URL}catch{}return Cye}function wX(){try{if(typeof window<"u"&&window.__SUPABASE_KEY)return window.__SUPABASE_KEY}catch{}return Pye}function Aye(){try{return(new URL(K4()).host||"").split(".")[0]||""}catch{return""}}function Eye(){const e=Aye();return e?`sb-${e}-auth-token`:"sb-auth-token"}async function kye(){try{const e=localStorage.getItem("custom-auth-token");if(e&&e.trim())return e.trim()}catch{}try{if(typeof lh<"u"&&lh?.auth?.getSession){const e=new Promise((o,s)=>setTimeout(()=>s(new Error("getSession timeout")),1e3)),t=lh.auth.getSession(),{data:r}=await Promise.race([t,e]),n=r?.session?.access_token;if(n)return console.debug("[Supabase Wrapper] Token obtido via getSession"),n}}catch(e){console.debug("[Supabase Wrapper] getSession falhou ou timeout:",e.message)}try{const e=Eye(),t=localStorage.getItem(e);if(t){const r=JSON.parse(t);if(r?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage"),r.access_token;if(r?.currentSession?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage (currentSession)"),r.currentSession.access_token}}catch(e){console.warn("[Supabase Wrapper] Erro ao ler localStorage:",e)}return console.warn("[Supabase Wrapper]  Nenhum token encontrado - usando anon key"),null}const Iye=e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([r,n])=>{n!=null&&(Array.isArray(n)?n.forEach(o=>t.append(r,String(o))):t.append(r,String(n)))}),t.toString()},jX=async(e,t={})=>{const{method:r="GET",body:n,headers:o={},params:s={},signal:i,timeoutMs:l=2e4}=t,c=Iye(s),u=`${K4()}/rest/v1/${e}${c?`?${c}`:""}`,h={apikey:wX(),"Content-Type":"application/json",Prefer:"return=representation",...o};try{const _=await kye();_&&(h.Authorization=`Bearer ${_}`)}catch(_){console.warn("[Supabase Wrapper] Erro ao obter token de sesso:",_)}const m={method:r,headers:h};n&&(m.body=JSON.stringify(n)),i&&(m.signal=i);const v=new AbortController,g=setTimeout(()=>{console.warn(`[Supabase Wrapper]  Timeout (${l}ms) para ${e}`);try{v.abort("timeout")}catch{}},Math.max(5e3,l)),y=(()=>{if(!i)return v.signal;try{i.addEventListener("abort",()=>{try{v.abort("upstream-abort")}catch{}})}catch{}return v.signal})();m.signal=y;const x=Date.now();let b;try{b=await fetch(u,m)}finally{clearTimeout(g)}if(!b.ok){let _="";try{_=await b.text()}catch{}const C=Date.now()-x;let E=!1;try{const A=JSON.parse(_);E=b.status===401&&(A?.code==="PGRST303"||/jwt expired/i.test(A?.message||""))}catch{}if(E){try{window.dispatchEvent(new CustomEvent("auth:jwt-expired"))}catch{}try{localStorage.removeItem("custom-auth-token"),Object.keys(localStorage).filter(A=>A.startsWith("sb-")).forEach(A=>localStorage.removeItem(A)),Object.keys(sessionStorage).filter(A=>A.startsWith("sb-")).forEach(A=>sessionStorage.removeItem(A)),sessionStorage.setItem("auth:forceLogout","1"),window.location.replace("/")}catch{}}throw new Error(`[Supabase Wrapper] HTTP ${b.status} (${C}ms) - ${_||"unknown error"}`)}const w=Date.now()-x;let j;try{j=await b.json()}catch(_){throw console.error(`[Supabase Wrapper] Erro ao parsear JSON de ${e}:`,_),new Error(`[Supabase Wrapper] JSON parse error: ${_.message}`)}return w>3e3?console.warn(`[Supabase Wrapper]  fetch ${e} LENTO (${w}ms)`):console.debug(`[Supabase Wrapper] fetch ${e} OK (${w}ms)`),{data:j,error:null}};class Oye{constructor(t){this.table=t,this.params={},this.multiFilters={},this.selectColumns="*",this.signal=null}select(t="*"){return this.selectColumns=t,this.params.select=t,this}eq(t,r){return this._addFilter(t,`eq.${r}`),this}neq(t,r){return this.params[t]=`neq.${r}`,this}gt(t,r){return this.params[t]=`gt.${r}`,this}gte(t,r){return this._addFilter(t,`gte.${r}`),this}lt(t,r){return this.params[t]=`lt.${r}`,this}lte(t,r){return this._addFilter(t,`lte.${r}`),this}like(t,r){return this.params[t]=`like.${r}`,this}ilike(t,r){return this.params[t]=`ilike.${r}`,this}is(t,r){return this.params[t]=`is.${r}`,this}in(t,r){return this.params[t]=`in.(${r.join(",")})`,this}not(t,r,n){return this.params[t]=`not.${r}.${n}`,this}or(t){return this.params.or=`(${t})`,this}contains(t,r){return this.params[t]=`cs.{${r}}`,this}containedBy(t,r){return this.params[t]=`cd.{${r}}`,this}filter(t,r,n){return this._addFilter(t,`${r}.${n}`),this}order(t,r={}){const n=r.ascending===!1?"desc":"asc";return this.params.order=`${t}.${n}`,this}limit(t){return this.params.limit=t,this}range(t,r){return this.params.offset=t,this.params.limit=r-t+1,this}single(){return this.params.limit=1,this.isSingle=!0,this}maybeSingle(){return this.params.limit=1,this.isMaybeSingle=!0,this}abortSignal(t){return this.signal=t,this}_addFilter(t,r){this.multiFilters[t]||(this.multiFilters[t]=[]),this.multiFilters[t].push(r)}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([s,i])=>{i.length===1?n[s]=i[0]:i.length>1&&(n[s]=i)});const o=await jX(this.table,{method:"GET",params:n,signal:this.signal});this.isSingle&&o.data&&(o.data=o.data[0]||null),this.isMaybeSingle&&o.data&&(o.data=o.data[0]||null),t(o)}catch(n){r(n)}}}class Tye extends Oye{insert(t){return this.method="POST",this.body=Array.isArray(t)?t:[t],this}update(t){return this.method="PATCH",this.body=t,this}upsert(t,r={}){this.method="POST",this.body=Array.isArray(t)?t:[t];const n=r.ignoreDuplicates?"resolution=ignore-duplicates":"resolution=merge-duplicates",o=r.returning==="minimal"?"return=minimal":"return=representation";return this.headers={...this.headers||{},Prefer:`${n},${o}`},r.onConflict&&(this.params.on_conflict=r.onConflict),this}delete(){return this.method="DELETE",this}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([s,i])=>{i.length===1?n[s]=i[0]:i.length>1&&(n[s]=i)});const o=await jX(this.table,{method:this.method||"GET",body:this.body,params:n,signal:this.signal,headers:this.headers||{}});this.isSingle&&o.data&&(o.data=o.data[0]||null),this.isMaybeSingle&&o.data&&(o.data=o.data[0]||null),t(o)}catch(n){r(n)}}}const lh={from(e){return new Tye(e)},auth:null,supabaseUrl:K4(),supabaseKey:wX()};typeof window<"u"&&lh.from("empresas").select("id").limit(1).then(({data:e,error:t})=>{t&&console.error("[Supabase Wrapper]  ERRO:",t)}).catch(e=>{console.error("[Supabase Wrapper]  EXCEPTION:",e)});const w6="main";let Yv,Yy;try{const e=Object.assign({"./backendTargets.js":Vve,"./backendTargets.local.js":Gve}),t=e["./backendTargets.js"]||null,r=e["./backendTargets.local.js"]||null;t?.TARGETS&&(Yy=t.TARGETS),t?.ACTIVE_TARGET&&(Yv=t.ACTIVE_TARGET),r?.TARGETS&&(Yy=r.TARGETS),r?.ACTIVE_TARGET&&(Yv=r.ACTIVE_TARGET)}catch{}let fd=Yy&&Yv&&Yy[Yv]?Yy[Yv]:null,X4=Yv;!fd&&w6&&(X4=w6);let Ll=fd&&fd.supabaseUrl&&fd.supabaseUrl.trim()?fd.supabaseUrl:"",Fl=fd&&fd.supabaseAnonKey&&fd.supabaseAnonKey.trim()?fd.supabaseAnonKey:"";if(!Ll||!Fl){const e=(X4||"dev").toLowerCase(),t=e==="main"?{}.VITE_SUPABASE_URL_MAIN:{}.VITE_SUPABASE_URL_DEV,r=e==="main"?{}.VITE_SUPABASE_ANON_KEY_MAIN:{}.VITE_SUPABASE_ANON_KEY_DEV;Ll=Ll&&Ll.trim()?Ll:t,Fl=Fl&&Fl.trim()?Fl:r}(!Ll||!Fl)&&(Ll=Ll||"https://dlfryxtyxqoacuunswuc.supabase.co",Fl=Fl||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY");try{try{const e=X4||"dev";console.log(`[Target] Branch ativa: ${e}`);try{typeof window<"u"&&(window.__ACTIVE_TARGET=e)}catch{}const t=!!fd&&!!(fd.supabaseUrl||"").trim()&&!!(fd.supabaseAnonKey||"").trim(),r=!t&&(!!{}.VITE_SUPABASE_URL_DEV||!!{}.VITE_SUPABASE_URL_MAIN);console.info(`[Supabase] Backend target mode: ${t?"static config":r?"per-target env":"generic env"}`)}catch{}}catch{}if(!Ll||!Fl)throw console.error("[Supabase]  ERRO CRTICO: Variveis de ambiente ausentes!"),new Error("Supabase: Variveis de ambiente no configuradas!");const PI=Ll,AI=Fl,zd=bX(Ll,Fl,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:typeof window<"u"?window.localStorage:void 0},global:{headers:{"X-Client-Info":"fluxo7arena-web",apikey:Fl}}});try{typeof window<"u"&&lh&&(lh.auth=zd.auth)}catch{}const fe={from:e=>lh.from(e),auth:zd.auth,storage:zd.storage,functions:zd.functions,rpc:(...e)=>zd.rpc(...e),realtime:zd.realtime,channel:(...e)=>zd.channel(...e),removeChannel:(...e)=>zd.removeChannel(...e),removeAllChannels:()=>zd.removeAllChannels(),getChannels:()=>zd.getChannels(),supabaseUrl:Ll,supabaseKey:Fl};if(typeof window<"u"){window.__supabase=fe,window.__supabase_original=zd,window.__supabase_wrapper=lh;try{window.__SUPABASE_URL=Ll}catch{}try{window.__SUPABASE_KEY=Fl}catch{}}try{if(typeof window<"u"){const e=()=>{try{const t=localStorage.getItem("custom-auth-token");if(t&&t.trim()){fe.realtime.setAuth(t.trim());return}let r="";try{r=(new URL(Ll).host||"").split(".")[0]||""}catch{}const n=r?`sb-${r}-auth-token`:"sb-auth-token",o=localStorage.getItem(n);if(o){const s=JSON.parse(o),i=s?.access_token||s?.currentSession?.access_token;i&&fe.realtime.setAuth(i)}}catch{}};e();try{window.addEventListener("storage",t=>{try{const r=t?.key||"";(r==="custom-auth-token"||r.startsWith("sb-"))&&e()}catch{}})}catch{}}}catch{}const _X=p.createContext({}),So=()=>{const e=p.useContext(_X);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},Dye=({children:e})=>{const[t,r]=p.useState(null),[n,o]=p.useState(null),[s,i]=p.useState(null),[l,c]=p.useState(!0),[d,u]=p.useState(!1),f=p.useRef(null),h=p.useRef(!1),m=(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}})();p.useEffect(()=>{if((()=>{try{return sessionStorage.getItem("auth:forceLogout")==="1"}catch{return!1}})()){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),o(null),i(null),u(!0),c(!1);try{sessionStorage.removeItem("auth:forceLogout")}catch{}try{fe.auth.signOut({scope:"global"}).catch(()=>{})}catch{}return}try{const A=localStorage.getItem("auth:userProfile"),P=localStorage.getItem("auth:company");A&&o(JSON.parse(A)),P&&i(JSON.parse(P)),(A||P)&&u(!0)}catch(A){console.warn("AuthContext: falha ao hidratar cache local:",A)}(async()=>{try{if(m)try{const F=localStorage.getItem("custom-auth-token");if(F&&F.trim()){const I=JSON.parse(atob(F.split(".")[1].replace(/-/g,"+").replace(/_/g,"/")))?.sub||null;if(I){r({id:I}),u(!0),await v(I),f.current=I,c(!1);return}}}catch{}const{data:{session:A},error:P}=await fe.auth.getSession();P&&console.error("supabase.auth.getSession error:",P),A?.user?(r(A.user),u(!0),await v(A.user.id),f.current=A.user.id):u(!0)}catch(A){console.error("getSession exception:",A)}finally{c(!1)}})();const{data:C}=fe.auth.onAuthStateChange(async(A,P)=>{console.log("[AuthContext] onAuthStateChange",{event:A,userId:P?.user?.id||null});try{if(A==="SIGNED_OUT"){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),o(null),i(null),f.current=null,h.current=!1,c(!1),u(!0);return}if(m){u(!0),c(!1);return}const F=P?.user||null;r(F),u(!0),F?.id&&(await v(F.id),f.current=F.id,c(!1))}catch(F){console.error("onAuthStateChange handler error:",F),c(!1),u(!0)}}),E=setTimeout(()=>{c(A=>A&&!1),u(A=>A||!0)},12e3);return()=>{clearTimeout(E),C.subscription.unsubscribe()}},[]),p.useEffect(()=>{(async()=>{try{if(!d||!t)return;const _=!n,C=!!n&&!s&&!!n.codigo_empresa;(_||C)&&(await v(t.id),f.current=t.id)}catch{}})()},[d,t?.id,!!n,n?.codigo_empresa,!!s]),p.useEffect(()=>{const j=()=>{try{const E=localStorage.getItem("auth:userProfile"),A=localStorage.getItem("auth:company");if(E){const P=JSON.parse(E);(!n||!n.codigo_empresa)&&o(P)}if(A){const P=JSON.parse(A);(!s||!s.codigo_empresa)&&i(P)}}catch{}},_=()=>{j(),t?.id&&v(t.id).catch(()=>{})},C=()=>{document.visibilityState==="visible"&&_()};return window.addEventListener("focus",_),document.addEventListener("visibilitychange",C),()=>{window.removeEventListener("focus",_),document.removeEventListener("visibilitychange",C)}},[t?.id]);const v=async j=>{if(h.current){console.log("[AuthDebug] loadUserProfile:skip (already running)");return}h.current=!0;try{const _=[300,800,1600,3e3],C=P=>new Promise(F=>setTimeout(F,P)),E=async(P,F)=>{let M;try{const I=new Promise(D=>{M=setTimeout(()=>D({__timeout:!0}),F)});return await Promise.race([P,I])}finally{clearTimeout(M)}},A=1200;for(let P=0;P<=_.length;P++){console.log("[AuthDebug] loadUserProfile:start",{userId:j,attempt:P});try{console.log("[AuthDebug] querying colaboradores",{userId:j});const F=fe.from("colaboradores").select("*").eq("id",j).single(),M=await E(F,A);if(M&&M.__timeout){console.warn("[AuthDebug] colaboradores:timeout, using usuarios fallback (inline)");try{console.log("[AuthDebug] fallback-inline: querying usuarios by id");const{data:D,error:U}=await fe.from("usuarios").select("*").eq("id",j).maybeSingle();if(!U&&D){let z=null;if(D.codigo_empresa){console.log("[AuthDebug] fallback-inline: querying empresas by codigo",{codigo_empresa:D.codigo_empresa});const{data:q,error:Q}=await fe.from("empresas").select("*").eq("codigo_empresa",D.codigo_empresa).single();Q?console.warn("[AuthDebug] fallback-inline: empresa error",{status:Q.status,code:Q.code,message:Q.message}):(z=q,console.log("[AuthDebug] fallback-inline: empresa loaded"))}const H={id:j,nome:D.nome||null,cargo:D.papel||"user",codigo_empresa:D.codigo_empresa||null,_source:"usuarios"};o(H);try{localStorage.setItem("auth:userProfile",JSON.stringify(H))}catch{}if(z){i(z);try{localStorage.setItem("auth:company",JSON.stringify(z))}catch{}console.log("[AuthDebug] fallback-inline: set company from usuarios path")}else console.warn("[AuthDebug] fallback-inline: no company resolved; preserving previous company");return}U&&console.warn("[AuthDebug] fallback-inline: usuarios error",{status:U.status,code:U.code,message:U.message})}catch(D){console.warn("[AuthDebug] fallback-inline: unexpected error",D?.message||D)}if(P<_.length){await C(_[P]);continue}return}const{data:I,error:R}=M||{};if(console.log("[AuthDebug] colaboradores:success",{hasProfile:!!I,codigo_empresa:I?.codigo_empresa||null}),R){if(console.warn("[AuthDebug] colaboradores:error",{code:R.code,status:R.status,message:R.message}),R.code==="42P17"){if(P<_.length){await C(_[P]);continue}console.warn("RLS recursion (42P17) persistente ao carregar perfil. Prosseguindo sem alterar cache.");return}if([401,403].includes(Number(R.status))&&(console.warn("[AuthDebug] Erro de autorizao detectado, tentando fallback"),P<_.length)){await C(_[P]);continue}if(R.code==="PGRST116"){try{console.log("[AuthDebug] fallback: querying usuarios by id");const{data:U,error:z}=await fe.from("usuarios").select("*").eq("id",j).maybeSingle();if(!z&&U){let H=null;if(U.codigo_empresa){console.log("[AuthDebug] fallback: querying empresas by codigo",{codigo_empresa:U.codigo_empresa});const{data:Q,error:pe}=await fe.from("empresas").select("*").eq("codigo_empresa",U.codigo_empresa).single();pe?console.warn("[AuthDebug] fallback: empresa error",{status:pe.status,code:pe.code,message:pe.message}):(H=Q,console.log("[AuthDebug] fallback: empresa loaded"))}const q={id:j,nome:U.nome||null,cargo:U.papel||"user",codigo_empresa:U.codigo_empresa||null,_source:"usuarios"};o(q);try{localStorage.setItem("auth:userProfile",JSON.stringify(q))}catch{}if(H){i(H);try{localStorage.setItem("auth:company",JSON.stringify(H))}catch{}console.log("[AuthDebug] fallback: set company from usuarios path")}else console.warn("[AuthDebug] fallback: no company resolved; preserving previous company");return}z&&console.warn("[AuthDebug] fallback: usuarios error",{status:z.status,code:z.code,message:z.message})}catch{}console.warn("AuthContext: perfil no encontrado (PGRST116) e fallback falhou; mantendo cache atual.");return}if([401,403,406].includes(Number(R.status))&&P<_.length){await C(_[P]);continue}throw R}if(!I){if(P<_.length){await C(_[P]);continue}return}o(I);try{localStorage.setItem("auth:userProfile",JSON.stringify(I))}catch{}if(I?.codigo_empresa){console.log("[AuthDebug] company: querying empresas by codigo from colaboradores",{codigo_empresa:I.codigo_empresa});const{data:D,error:U}=await fe.from("empresas").select("*").eq("codigo_empresa",I.codigo_empresa).single();if(U){if([401,403,406].includes(Number(U.status))&&P<_.length){await C(_[P]);continue}console.warn("[AuthDebug] company: load error; preserving previous company",{status:U.status,code:U.code,message:U.message});return}else{i(D);try{localStorage.setItem("auth:company",JSON.stringify(D))}catch{}console.log("[AuthDebug] company: set from colaboradores path")}}else console.warn("[AuthDebug] company: no codigo_empresa available on profile; preserving previous company");return}catch(F){if(console.error("[AuthDebug] loadUserProfile:unexpected error",{message:F?.message,code:F?.code,status:F?.status}),P<_.length){await C(_[P]);continue}console.error("Error loading user profile:",F);return}}}finally{h.current=!1}},w={user:t,userProfile:n,company:s,loading:l,authReady:d,signUp:async(j,_,C,E=null)=>{try{const{data:A,error:P}=await fe.auth.signUp({email:j,password:_});if(P)throw P;if(A?.user&&E){const{data:F,error:M}=await fe.from("empresas").select("id, codigo_empresa").eq("codigo_empresa",E).single();if(M)throw new Error("Cdigo de empresa invlido. Verifique o cdigo informado.");const{error:I}=await fe.from("colaboradores").insert({id:A.user.id,codigo_empresa:F.codigo_empresa,nome:C,cargo:"user",ativo:!0});if(I)throw I}return{data:A,error:null}}catch(A){let P="No foi possvel cadastrar. Verifique os dados e tente novamente.";const F=(A?.message||"").toLowerCase();return F.includes("user already registered")||F.includes("already registered")||F.includes("user already exists")?P="Email j cadastrado. Tente entrar ou redefinir a senha.":F.includes("password")&&F.includes("length")&&(P="Senha muito curta. Use ao menos 6 caracteres."),{data:null,error:new Error(P)}}},signIn:async(j,_)=>{try{if(m){const A=PI,P=AI,F=await fetch(`${A}/rest/v1/rpc/auth_login_dev`,{method:"POST",headers:{"Content-Type":"application/json",apikey:P,Authorization:`Bearer ${P}`},body:JSON.stringify({p_email:j,p_password:_})});if(!F.ok){const D=await F.text().catch(()=>"");let U="No foi possvel entrar. Tente novamente.";return F.status===401&&(U="Email ou senha invlidos."),F.status===423&&(U="Usurio bloqueado temporariamente."),{data:null,error:new Error(U+(D?` (${D})`:""))}}const I=(await F.json())?.access_token||"",R=(()=>{try{return JSON.parse(atob(I.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"))).sub}catch{return null}})();try{localStorage.setItem("custom-auth-token",I)}catch{}return R&&(r({id:R}),u(!0),await v(R),f.current=R),{data:{user:R?{id:R}:null},error:null}}const{data:C,error:E}=await fe.auth.signInWithPassword({email:j,password:_});if(E){let A="No foi possvel entrar. Tente novamente.";const P=(E.message||"").toLowerCase(),F=E.status;return P.includes("invalid login")||P.includes("invalid credentials")||F===400?A="Email ou senha invlidos.":P.includes("email not confirmed")||P.includes("not confirmed")?A="Email no confirmado. Verifique sua caixa de entrada.":F===429?A="Muitas tentativas. Aguarde alguns minutos e tente novamente.":F>=500&&(A="Servio indisponvel no momento. Tente novamente mais tarde."),{data:null,error:new Error(A)}}return C.user&&await fe.from("colaboradores").select("id").eq("id",C.user.id).single(),{data:C,error:null}}catch(C){return{data:null,error:C}}},signOut:async()=>{try{localStorage.removeItem("custom-auth-token")}catch{}try{const j=fe.auth.signOut({scope:"global"}),_=new Promise(C=>setTimeout(C,700));await Promise.race([j,_])}catch(j){console.warn("[AuthContext] signOut(): error during signOut",j?.message||j)}f.current=null,r(null),o(null),i(null),c(!1),u(!0);try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company"),localStorage.removeItem("clientes:list"),localStorage.removeItem("quadras:list"),localStorage.removeItem("agenda:courts"),localStorage.removeItem("agenda:selectedCourts"),localStorage.removeItem("agenda:viewFilter"),Object.keys(localStorage).filter(j=>j.startsWith("agenda:bookings:")).forEach(j=>localStorage.removeItem(j)),Object.keys(localStorage).filter(j=>j.startsWith("sb-")).forEach(j=>localStorage.removeItem(j)),Object.keys(sessionStorage).filter(j=>j.startsWith("sb-")).forEach(j=>sessionStorage.removeItem(j))}catch{}try{sessionStorage.setItem("auth:forceLogout","1")}catch{}try{window.location.replace("/")}catch{}return{error:null}},reloadCompany:async()=>{try{const j=n&&n.codigo_empresa?n.codigo_empresa:null;if(!j)return;const{data:_,error:C}=await fe.from("empresas").select("*").eq("codigo_empresa",j).single();if(!C&&_){i(_);try{localStorage.setItem("auth:company",JSON.stringify(_))}catch{}}}catch{}}};return a.jsx(_X.Provider,{value:w,children:e})};function Fa(e){"@babel/helpers - typeof";return Fa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fa(e)}function gs(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Wn(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function fa(e){Wn(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||Fa(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function La(e,t){Wn(2,arguments);var r=fa(e),n=gs(t);return isNaN(n)?new Date(NaN):(n&&r.setDate(r.getDate()+n),r)}function iu(e,t){Wn(2,arguments);var r=fa(e),n=gs(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var o=r.getDate(),s=new Date(r.getTime());s.setMonth(r.getMonth()+n+1,0);var i=s.getDate();return o>=i?s:(r.setFullYear(s.getFullYear(),s.getMonth(),o),r)}function NX(e,t){Wn(2,arguments);var r=fa(e).getTime(),n=gs(t);return new Date(r+n)}var Mye={};function Mh(){return Mye}function Nd(e,t){var r,n,o,s,i,l,c,d;Wn(1,arguments);var u=Mh(),f=gs((r=(n=(o=(s=t?.weekStartsOn)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&o!==void 0?o:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=fa(e),m=h.getDay(),v=(m<f?7:0)+m-f;return h.setDate(h.getDate()-v),h.setHours(0,0,0,0),h}function tg(e){return Wn(1,arguments),Nd(e,{weekStartsOn:1})}function Rye(e){Wn(1,arguments);var t=fa(e),r=t.getFullYear(),n=new Date(0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);var o=tg(n),s=new Date(0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);var i=tg(s);return t.getTime()>=o.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function Lye(e){Wn(1,arguments);var t=Rye(e),r=new Date(0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);var n=tg(r);return n}function Gb(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function ko(e){Wn(1,arguments);var t=fa(e);return t.setHours(0,0,0,0),t}var Fye=864e5;function Tu(e,t){Wn(2,arguments);var r=ko(e),n=ko(t),o=r.getTime()-Gb(r),s=n.getTime()-Gb(n);return Math.round((o-s)/Fye)}var $ye=6e4;function Bye(e,t){Wn(2,arguments);var r=gs(t);return NX(e,r*$ye)}function EI(e,t){Wn(2,arguments);var r=gs(t),n=r*7;return La(e,n)}function qye(e,t){Wn(2,arguments);var r=gs(t);return iu(e,r*12)}function zye(e){Wn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Fa(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var o=fa(n);(r===void 0||r<o||isNaN(Number(o)))&&(r=o)}),r||new Date(NaN)}function Uye(e){Wn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Fa(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var o=fa(n);(r===void 0||r>o||isNaN(o.getDate()))&&(r=o)}),r||new Date(NaN)}var SX=6e4,CX=36e5;function Ki(e,t){Wn(2,arguments);var r=ko(e),n=ko(t);return r.getTime()===n.getTime()}function Y4(e){return Wn(1,arguments),e instanceof Date||Fa(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Vye(e){if(Wn(1,arguments),!Y4(e)&&typeof e!="number")return!1;var t=fa(e);return!isNaN(Number(t))}function Kb(e,t){Wn(2,arguments);var r=fa(e),n=fa(t),o=r.getFullYear()-n.getFullYear(),s=r.getMonth()-n.getMonth();return o*12+s}var Wye=6048e5;function Hye(e,t,r){Wn(2,arguments);var n=Nd(e,r),o=Nd(t,r),s=n.getTime()-Gb(n),i=o.getTime()-Gb(o);return Math.round((s-i)/Wye)}function j6(e,t){var r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function Gye(e,t){Wn(2,arguments);var r=fa(e),n=fa(t),o=j6(r,n),s=Math.abs(Tu(r,n));r.setDate(r.getDate()-o*s);var i=+(j6(r,n)===-o),l=o*(s-i);return l===0?0:l}function Wj(e){Wn(1,arguments);var t=fa(e);return t.setHours(23,59,59,999),t}function yC(e){Wn(1,arguments);var t=fa(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function bl(e){Wn(1,arguments);var t=fa(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Kye(e){Wn(1,arguments);var t=fa(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function J4(e,t){var r,n,o,s,i,l,c,d;Wn(1,arguments);var u=Mh(),f=gs((r=(n=(o=(s=t?.weekStartsOn)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&o!==void 0?o:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=fa(e),m=h.getDay(),v=(m<f?-7:0)+6-(m-f);return h.setDate(h.getDate()+v),h.setHours(23,59,59,999),h}function PX(e){return Wn(1,arguments),J4(e,{weekStartsOn:1})}function Xye(e,t){Wn(2,arguments);var r=gs(t);return NX(e,-r)}var Yye=864e5;function Jye(e){Wn(1,arguments);var t=fa(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),o=r-n;return Math.floor(o/Yye)+1}function G_(e){Wn(1,arguments);var t=1,r=fa(e),n=r.getUTCDay(),o=(n<t?7:0)+n-t;return r.setUTCDate(r.getUTCDate()-o),r.setUTCHours(0,0,0,0),r}function AX(e){Wn(1,arguments);var t=fa(e),r=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var o=G_(n),s=new Date(0);s.setUTCFullYear(r,0,4),s.setUTCHours(0,0,0,0);var i=G_(s);return t.getTime()>=o.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function Qye(e){Wn(1,arguments);var t=AX(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var n=G_(r);return n}var Zye=6048e5;function ebe(e){Wn(1,arguments);var t=fa(e),r=G_(t).getTime()-Qye(t).getTime();return Math.round(r/Zye)+1}function K_(e,t){var r,n,o,s,i,l,c,d;Wn(1,arguments);var u=Mh(),f=gs((r=(n=(o=(s=t?.weekStartsOn)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&o!==void 0?o:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=fa(e),m=h.getUTCDay(),v=(m<f?7:0)+m-f;return h.setUTCDate(h.getUTCDate()-v),h.setUTCHours(0,0,0,0),h}function EX(e,t){var r,n,o,s,i,l,c,d;Wn(1,arguments);var u=fa(e),f=u.getUTCFullYear(),h=Mh(),m=gs((r=(n=(o=(s=t?.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&o!==void 0?o:h.firstWeekContainsDate)!==null&&n!==void 0?n:(c=h.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setUTCFullYear(f+1,0,m),v.setUTCHours(0,0,0,0);var g=K_(v,t),y=new Date(0);y.setUTCFullYear(f,0,m),y.setUTCHours(0,0,0,0);var x=K_(y,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=x.getTime()?f:f-1}function tbe(e,t){var r,n,o,s,i,l,c,d;Wn(1,arguments);var u=Mh(),f=gs((r=(n=(o=(s=t?.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&o!==void 0?o:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),h=EX(e,t),m=new Date(0);m.setUTCFullYear(h,0,f),m.setUTCHours(0,0,0,0);var v=K_(m,t);return v}var rbe=6048e5;function nbe(e,t){Wn(1,arguments);var r=fa(e),n=K_(r,t).getTime()-tbe(r,t).getTime();return Math.round(n/rbe)+1}function co(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var abe={y:function(t,r){var n=t.getUTCFullYear(),o=n>0?n:1-n;return co(r==="yy"?o%100:o,r.length)},M:function(t,r){var n=t.getUTCMonth();return r==="M"?String(n+1):co(n+1,2)},d:function(t,r){return co(t.getUTCDate(),r.length)},a:function(t,r){var n=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(t,r){return co(t.getUTCHours()%12||12,r.length)},H:function(t,r){return co(t.getUTCHours(),r.length)},m:function(t,r){return co(t.getUTCMinutes(),r.length)},s:function(t,r){return co(t.getUTCSeconds(),r.length)},S:function(t,r){var n=r.length,o=t.getUTCMilliseconds(),s=Math.floor(o*Math.pow(10,n-3));return co(s,r.length)}};const gm=abe;var Gg={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},obe={G:function(t,r,n){var o=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(o,{width:"abbreviated"});case"GGGGG":return n.era(o,{width:"narrow"});case"GGGG":default:return n.era(o,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){var o=t.getUTCFullYear(),s=o>0?o:1-o;return n.ordinalNumber(s,{unit:"year"})}return gm.y(t,r)},Y:function(t,r,n,o){var s=EX(t,o),i=s>0?s:1-s;if(r==="YY"){var l=i%100;return co(l,2)}return r==="Yo"?n.ordinalNumber(i,{unit:"year"}):co(i,r.length)},R:function(t,r){var n=AX(t);return co(n,r.length)},u:function(t,r){var n=t.getUTCFullYear();return co(n,r.length)},Q:function(t,r,n){var o=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(o);case"QQ":return co(o,2);case"Qo":return n.ordinalNumber(o,{unit:"quarter"});case"QQQ":return n.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(o,{width:"wide",context:"formatting"})}},q:function(t,r,n){var o=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(o);case"qq":return co(o,2);case"qo":return n.ordinalNumber(o,{unit:"quarter"});case"qqq":return n.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(o,{width:"wide",context:"standalone"})}},M:function(t,r,n){var o=t.getUTCMonth();switch(r){case"M":case"MM":return gm.M(t,r);case"Mo":return n.ordinalNumber(o+1,{unit:"month"});case"MMM":return n.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(o,{width:"wide",context:"formatting"})}},L:function(t,r,n){var o=t.getUTCMonth();switch(r){case"L":return String(o+1);case"LL":return co(o+1,2);case"Lo":return n.ordinalNumber(o+1,{unit:"month"});case"LLL":return n.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(o,{width:"wide",context:"standalone"})}},w:function(t,r,n,o){var s=nbe(t,o);return r==="wo"?n.ordinalNumber(s,{unit:"week"}):co(s,r.length)},I:function(t,r,n){var o=ebe(t);return r==="Io"?n.ordinalNumber(o,{unit:"week"}):co(o,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):gm.d(t,r)},D:function(t,r,n){var o=Jye(t);return r==="Do"?n.ordinalNumber(o,{unit:"dayOfYear"}):co(o,r.length)},E:function(t,r,n){var o=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(o,{width:"short",context:"formatting"});case"EEEE":default:return n.day(o,{width:"wide",context:"formatting"})}},e:function(t,r,n,o){var s=t.getUTCDay(),i=(s-o.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return co(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,r,n,o){var s=t.getUTCDay(),i=(s-o.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return co(i,r.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,r,n){var o=t.getUTCDay(),s=o===0?7:o;switch(r){case"i":return String(s);case"ii":return co(s,r.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(o,{width:"short",context:"formatting"});case"iiii":default:return n.day(o,{width:"wide",context:"formatting"})}},a:function(t,r,n){var o=t.getUTCHours(),s=o/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,r,n){var o=t.getUTCHours(),s;switch(o===12?s=Gg.noon:o===0?s=Gg.midnight:s=o/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,r,n){var o=t.getUTCHours(),s;switch(o>=17?s=Gg.evening:o>=12?s=Gg.afternoon:o>=4?s=Gg.morning:s=Gg.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){var o=t.getUTCHours()%12;return o===0&&(o=12),n.ordinalNumber(o,{unit:"hour"})}return gm.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):gm.H(t,r)},K:function(t,r,n){var o=t.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(o,{unit:"hour"}):co(o,r.length)},k:function(t,r,n){var o=t.getUTCHours();return o===0&&(o=24),r==="ko"?n.ordinalNumber(o,{unit:"hour"}):co(o,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):gm.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):gm.s(t,r)},S:function(t,r){return gm.S(t,r)},X:function(t,r,n,o){var s=o._originalDate||t,i=s.getTimezoneOffset();if(i===0)return"Z";switch(r){case"X":return N6(i);case"XXXX":case"XX":return ip(i);case"XXXXX":case"XXX":default:return ip(i,":")}},x:function(t,r,n,o){var s=o._originalDate||t,i=s.getTimezoneOffset();switch(r){case"x":return N6(i);case"xxxx":case"xx":return ip(i);case"xxxxx":case"xxx":default:return ip(i,":")}},O:function(t,r,n,o){var s=o._originalDate||t,i=s.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+_6(i,":");case"OOOO":default:return"GMT"+ip(i,":")}},z:function(t,r,n,o){var s=o._originalDate||t,i=s.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+_6(i,":");case"zzzz":default:return"GMT"+ip(i,":")}},t:function(t,r,n,o){var s=o._originalDate||t,i=Math.floor(s.getTime()/1e3);return co(i,r.length)},T:function(t,r,n,o){var s=o._originalDate||t,i=s.getTime();return co(i,r.length)}};function _6(e,t){var r=e>0?"-":"+",n=Math.abs(e),o=Math.floor(n/60),s=n%60;if(s===0)return r+String(o);var i=t||"";return r+String(o)+i+co(s,2)}function N6(e,t){if(e%60===0){var r=e>0?"-":"+";return r+co(Math.abs(e)/60,2)}return ip(e,t)}function ip(e,t){var r=t||"",n=e>0?"-":"+",o=Math.abs(e),s=co(Math.floor(o/60),2),i=co(o%60,2);return n+s+r+i}const sbe=obe;var S6=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},kX=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},ibe=function(t,r){var n=t.match(/(P+)(p+)?/)||[],o=n[1],s=n[2];if(!s)return S6(t,r);var i;switch(o){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",S6(o,r)).replace("{{time}}",kX(s,r))},lbe={p:kX,P:ibe};const cbe=lbe;var dbe=["D","DD"],ube=["YY","YYYY"];function fbe(e){return dbe.indexOf(e)!==-1}function mbe(e){return ube.indexOf(e)!==-1}function C6(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var hbe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},pbe=function(t,r,n){var o,s=hbe[t];return typeof s=="string"?o=s:r===1?o=s.one:o=s.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+o:o+" ago":o};const gbe=pbe;function Jv(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var vbe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xbe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ybe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bbe={date:Jv({formats:vbe,defaultWidth:"full"}),time:Jv({formats:xbe,defaultWidth:"full"}),dateTime:Jv({formats:ybe,defaultWidth:"full"})};const wbe=bbe;var jbe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},_be=function(t,r,n,o){return jbe[t]};const Nbe=_be;function Eu(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",o;if(n==="formatting"&&e.formattingValues){var s=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):s;o=e.formattingValues[i]||e.formattingValues[s]}else{var l=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;o=e.values[c]||e.values[l]}var d=e.argumentCallback?e.argumentCallback(t):t;return o[d]}}var Sbe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Cbe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Pbe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Abe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ebe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},kbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Ibe=function(t,r){var n=Number(t),o=n%100;if(o>20||o<10)switch(o%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Obe={ordinalNumber:Ibe,era:Eu({values:Sbe,defaultWidth:"wide"}),quarter:Eu({values:Cbe,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Eu({values:Pbe,defaultWidth:"wide"}),day:Eu({values:Abe,defaultWidth:"wide"}),dayPeriod:Eu({values:Ebe,defaultWidth:"wide",formattingValues:kbe,defaultFormattingWidth:"wide"})};const Tbe=Obe;function ku(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,o=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(o);if(!s)return null;var i=s[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?Mbe(l,function(f){return f.test(i)}):Dbe(l,function(f){return f.test(i)}),d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;var u=t.slice(i.length);return{value:d,rest:u}}}function Dbe(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function Mbe(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function IX(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var o=n[0],s=t.match(e.parsePattern);if(!s)return null;var i=e.valueCallback?e.valueCallback(s[0]):s[0];i=r.valueCallback?r.valueCallback(i):i;var l=t.slice(o.length);return{value:i,rest:l}}}var Rbe=/^(\d+)(th|st|nd|rd)?/i,Lbe=/\d+/i,Fbe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$be={any:[/^b/i,/^(a|c)/i]},Bbe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},qbe={any:[/1/i,/2/i,/3/i,/4/i]},zbe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ube={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Vbe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Wbe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Hbe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Gbe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Kbe={ordinalNumber:IX({matchPattern:Rbe,parsePattern:Lbe,valueCallback:function(t){return parseInt(t,10)}}),era:ku({matchPatterns:Fbe,defaultMatchWidth:"wide",parsePatterns:$be,defaultParseWidth:"any"}),quarter:ku({matchPatterns:Bbe,defaultMatchWidth:"wide",parsePatterns:qbe,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:ku({matchPatterns:zbe,defaultMatchWidth:"wide",parsePatterns:Ube,defaultParseWidth:"any"}),day:ku({matchPatterns:Vbe,defaultMatchWidth:"wide",parsePatterns:Wbe,defaultParseWidth:"any"}),dayPeriod:ku({matchPatterns:Hbe,defaultMatchWidth:"any",parsePatterns:Gbe,defaultParseWidth:"any"})};const Xbe=Kbe;var Ybe={code:"en-US",formatDistance:gbe,formatLong:wbe,formatRelative:Nbe,localize:Tbe,match:Xbe,options:{weekStartsOn:0,firstWeekContainsDate:1}};const OX=Ybe;var Jbe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Qbe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Zbe=/^'([^]*?)'?$/,ewe=/''/g,twe=/[a-zA-Z]/;function dr(e,t,r){var n,o,s,i,l,c,d,u,f,h,m,v,g,y,x,b,w,j;Wn(2,arguments);var _=String(t),C=Mh(),E=(n=(o=r?.locale)!==null&&o!==void 0?o:C.locale)!==null&&n!==void 0?n:OX,A=gs((s=(i=(l=(c=r?.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&l!==void 0?l:C.firstWeekContainsDate)!==null&&i!==void 0?i:(f=C.locale)===null||f===void 0||(h=f.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(A>=1&&A<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var P=gs((m=(v=(g=(y=r?.weekStartsOn)!==null&&y!==void 0?y:r==null||(x=r.locale)===null||x===void 0||(b=x.options)===null||b===void 0?void 0:b.weekStartsOn)!==null&&g!==void 0?g:C.weekStartsOn)!==null&&v!==void 0?v:(w=C.locale)===null||w===void 0||(j=w.options)===null||j===void 0?void 0:j.weekStartsOn)!==null&&m!==void 0?m:0);if(!(P>=0&&P<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!E.localize)throw new RangeError("locale must contain localize property");if(!E.formatLong)throw new RangeError("locale must contain formatLong property");var F=fa(e);if(!Vye(F))throw new RangeError("Invalid time value");var M=Gb(F),I=Xye(F,M),R={firstWeekContainsDate:A,weekStartsOn:P,locale:E,_originalDate:F},D=_.match(Qbe).map(function(U){var z=U[0];if(z==="p"||z==="P"){var H=cbe[z];return H(U,E.formatLong)}return U}).join("").match(Jbe).map(function(U){if(U==="''")return"'";var z=U[0];if(z==="'")return rwe(U);var H=sbe[z];if(H)return!(r!=null&&r.useAdditionalWeekYearTokens)&&mbe(U)&&C6(U,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&fbe(U)&&C6(U,t,String(e)),H(I,U,E.localize,R);if(z.match(twe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+z+"`");return U}).join("");return D}function rwe(e){var t=e.match(Zbe);return t?t[1].replace(ewe,"'"):e}function nwe(e){Wn(1,arguments);var t=fa(e),r=t.getFullYear(),n=t.getMonth(),o=new Date(0);return o.setFullYear(r,n+1,0),o.setHours(0,0,0,0),o.getDate()}function bu(e){Wn(1,arguments);var t=fa(e),r=t.getHours();return r}var awe=6048e5;function owe(e){Wn(1,arguments);var t=fa(e),r=tg(t).getTime()-Lye(t).getTime();return Math.round(r/awe)+1}function wu(e){Wn(1,arguments);var t=fa(e),r=t.getMinutes();return r}function swe(e){Wn(1,arguments);var t=fa(e),r=t.getTime();return r}function iwe(e){return Wn(1,arguments),Math.floor(swe(e)/1e3)}function lwe(e,t){var r,n,o,s,i,l,c,d;Wn(1,arguments);var u=fa(e),f=u.getFullYear(),h=Mh(),m=gs((r=(n=(o=(s=t?.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&o!==void 0?o:h.firstWeekContainsDate)!==null&&n!==void 0?n:(c=h.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setFullYear(f+1,0,m),v.setHours(0,0,0,0);var g=Nd(v,t),y=new Date(0);y.setFullYear(f,0,m),y.setHours(0,0,0,0);var x=Nd(y,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=x.getTime()?f:f-1}function cwe(e,t){var r,n,o,s,i,l,c,d;Wn(1,arguments);var u=Mh(),f=gs((r=(n=(o=(s=t?.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&o!==void 0?o:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),h=lwe(e,t),m=new Date(0);m.setFullYear(h,0,f),m.setHours(0,0,0,0);var v=Nd(m,t);return v}var dwe=6048e5;function uwe(e,t){Wn(1,arguments);var r=fa(e),n=Nd(r,t).getTime()-cwe(r,t).getTime();return Math.round(n/dwe)+1}function fwe(e){Wn(1,arguments);var t=fa(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function mwe(e,t){return Wn(1,arguments),Hye(fwe(e),bl(e),t)+1}function kI(e,t){Wn(2,arguments);var r=fa(e),n=fa(t);return r.getTime()>n.getTime()}function TX(e,t){Wn(2,arguments);var r=fa(e),n=fa(t);return r.getTime()<n.getTime()}function P6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function hwe(e,t){if(e){if(typeof e=="string")return P6(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P6(e,t):void 0}}function II(e,t){return II=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},II(e,t)}function pwe(e,t){if(Fa(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fa(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gwe(e){var t=pwe(e,"string");return Fa(t)=="symbol"?t:t+""}function vwe(e,t,r){return(t=gwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q4(e,t){Wn(2,arguments);var r=fa(e),n=fa(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function xwe(e,t){Wn(2,arguments);var r=fa(e),n=fa(t);return r.getFullYear()===n.getFullYear()}function Jy(e,t){Wn(2,arguments);var r=gs(t);return La(e,-r)}function A6(e,t){var r;Wn(1,arguments);var n=gs((r=t?.additionalDigits)!==null&&r!==void 0?r:2);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var o=jwe(e),s;if(o.date){var i=_we(o.date,n);s=Nwe(i.restDateString,i.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);var l=s.getTime(),c=0,d;if(o.time&&(c=Swe(o.time),isNaN(c)))return new Date(NaN);if(o.timezone){if(d=Cwe(o.timezone),isNaN(d))return new Date(NaN)}else{var u=new Date(l+c),f=new Date(0);return f.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),f.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),f}return new Date(l+c+d)}var $2={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ywe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,bwe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,wwe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function jwe(e){var t={},r=e.split($2.dateTimeDelimiter),n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],$2.timeZoneDelimiter.test(t.date)&&(t.date=e.split($2.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){var o=$2.timezone.exec(n);o?(t.time=n.replace(o[1],""),t.timezone=o[1]):t.time=n}return t}function _we(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};var o=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?o:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function Nwe(e,t){if(t===null)return new Date(NaN);var r=e.match(ywe);if(!r)return new Date(NaN);var n=!!r[4],o=ty(r[1]),s=ty(r[2])-1,i=ty(r[3]),l=ty(r[4]),c=ty(r[5])-1;if(n)return Iwe(t,l,c)?Pwe(t,l,c):new Date(NaN);var d=new Date(0);return!Ewe(t,s,i)||!kwe(t,o)?new Date(NaN):(d.setUTCFullYear(t,s,Math.max(o,i)),d)}function ty(e){return e?parseInt(e):1}function Swe(e){var t=e.match(bwe);if(!t)return NaN;var r=xA(t[1]),n=xA(t[2]),o=xA(t[3]);return Owe(r,n,o)?r*CX+n*SX+o*1e3:NaN}function xA(e){return e&&parseFloat(e.replace(",","."))||0}function Cwe(e){if(e==="Z")return 0;var t=e.match(wwe);if(!t)return 0;var r=t[1]==="+"?-1:1,n=parseInt(t[2]),o=t[3]&&parseInt(t[3])||0;return Twe(n,o)?r*(n*CX+o*SX):NaN}function Pwe(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var o=n.getUTCDay()||7,s=(t-1)*7+r+1-o;return n.setUTCDate(n.getUTCDate()+s),n}var Awe=[31,null,31,30,31,30,31,31,30,31,30,31];function DX(e){return e%400===0||e%4===0&&e%100!==0}function Ewe(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(Awe[t]||(DX(e)?29:28))}function kwe(e,t){return t>=1&&t<=(DX(e)?366:365)}function Iwe(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function Owe(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function Twe(e,t){return t>=0&&t<=59}function yA(e,t){Wn(2,arguments);var r=fa(e),n=gs(t),o=r.getFullYear(),s=r.getDate(),i=new Date(0);i.setFullYear(o,n,15),i.setHours(0,0,0,0);var l=nwe(i);return r.setMonth(n,Math.min(s,l)),r}function B2(e,t){Wn(2,arguments);var r=fa(e),n=gs(t);return r.setHours(n),r}function q2(e,t){Wn(2,arguments);var r=fa(e),n=gs(t);return r.setMinutes(n),r}function E6(e,t){Wn(2,arguments);var r=fa(e),n=gs(t);return isNaN(r.getTime())?new Date(NaN):(r.setFullYear(n),r)}const MX=p.createContext(),Dwe=({children:e})=>{const{userProfile:t}=So(),r=Ls(),[n,o]=p.useState([]),[s,i]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(!1),f=p.useRef(r.pathname),h=p.useCallback(()=>document.querySelectorAll('[role="dialog"]').length>0,[]),m=p.useCallback(async()=>{if(t?.codigo_empresa)try{u(!0);const v=t.codigo_empresa,g=new Date,y=ko(g).toISOString(),x=Wj(g).toISOString(),b=[],{data:w}=await fe.from("produtos").select("nome, estoque, estoque_minimo, status").eq("codigo_empresa",v).not("estoque_minimo","is",null),j=(w||[]).filter(z=>{const H=Number(z.estoque||0),q=Number(z.estoque_minimo||0);return H<=q&&q>0});j.length>0&&b.push({tipo:"estoque",icone:"Package",cor:"danger",mensagem:`${j.length} produto${j.length>1?"s":""} com estoque baixo`,link:"/produtos"});const{data:_}=await fe.from("agendamento_participantes").select("id, agendamento_id").eq("codigo_empresa",v).eq("status_pagamento","Pendente");if(_&&_.length>0){const z=[...new Set(_.map(pe=>pe.agendamento_id))],{data:H}=await fe.from("agendamentos").select("id, inicio, status").in("id",z).not("status","in","(canceled,absent)").order("inicio",{ascending:!0}),q=new Set((H||[]).map(pe=>pe.id)),Q=_.filter(pe=>q.has(pe.agendamento_id));if(Q.length>0){const pe=H?.[0],be=dr(pe?new Date(pe.inicio):g,"yyyy-MM-dd");b.push({tipo:"pagamento",icone:"DollarSign",cor:"warning",mensagem:`${Q.length} pagamento${Q.length>1?"s":""} pendente${Q.length>1?"s":""} em agendamentos`,link:`/agenda?date=${be}`})}}const C=new Date;C.setHours(C.getHours()-3);const{data:E}=await fe.from("comandas").select("id, aberto_em, status").eq("codigo_empresa",v).eq("status","open").is("fechado_em",null).lte("aberto_em",C.toISOString());E&&E.length>0&&b.push({tipo:"comanda",icone:"Clock",cor:"warning",mensagem:`${E.length} comanda${E.length>1?"s":""} aberta${E.length>1?"s":""} h mais de 3 horas`,link:"/vendas"});const A=new Date;A.setHours(A.getHours()-12);const{data:P}=await fe.from("caixa_sessoes").select("id, aberto_em").eq("codigo_empresa",v).eq("status","open").lte("aberto_em",A.toISOString()).limit(1);P&&P.length>0&&b.push({tipo:"caixa",icone:"ShoppingCart",cor:"danger",mensagem:"Caixa aberto h mais de 12 horas",link:"/vendas"});const{data:F}=await fe.from("mesas").select("id, nome, numero").eq("codigo_empresa",v).eq("status","awaiting-payment");if(F&&F.length>0){const z=F.map(q=>q.id),{data:H}=await fe.from("comandas").select("id, mesa_id").eq("codigo_empresa",v).in("mesa_id",z).eq("status","open");if(H&&H.length>0){const q=H.map(V=>V.id),{data:Q}=await fe.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",q),pe={};(Q||[]).forEach(V=>{const B=(Number(V.quantidade)||0)*(Number(V.preco_unitario)||0),J=Number(V.desconto)||0,ue=B-J;pe[V.comanda_id]=(pe[V.comanda_id]||0)+ue});const be=Object.values(pe).filter(V=>V>100).length;be>0&&b.push({tipo:"mesa",icone:"Store",cor:"info",mensagem:`${be} mesa${be>1?"s":""} com saldo alto aguardando pagamento`,link:"/vendas"})}}const{data:M}=await fe.from("clientes").select("id, nome, aniversario").eq("codigo_empresa",v).eq("status","Ativo").not("aniversario","is",null),I=dr(g,"MM-dd"),R=(M||[]).filter(z=>z.aniversario?dr(new Date(z.aniversario),"MM-dd")===I:!1);R.length>0&&b.push({tipo:"aniversario",icone:"Users",cor:"success",mensagem:` ${R.length} aniversariante${R.length>1?"s":""} hoje!`,link:"/clientes"});const D=[];for(let z=1;z<=7;z++){const H=new Date(g);H.setDate(H.getDate()+z),D.push(dr(H,"MM-dd"))}const U=(M||[]).filter(z=>{if(!z.aniversario)return!1;const H=dr(new Date(z.aniversario),"MM-dd");return D.includes(H)});U.length>0&&b.push({tipo:"aniversario-semana",icone:"CalendarPlus",cor:"purple",mensagem:` ${U.length} aniversariante${U.length>1?"s":""} esta semana`,link:"/clientes"}),o(b)}catch(v){console.error("[AlertsContext] Erro ao carregar alertas:",v)}finally{u(!1)}},[t?.codigo_empresa]);return p.useEffect(()=>{if(t?.codigo_empresa){m();const v=setInterval(()=>{m()},5*60*1e3);return()=>clearInterval(v)}},[t?.codigo_empresa,m]),p.useEffect(()=>{if(!t?.codigo_empresa)return;const v=()=>{if(document.visibilityState==="visible"){if(h())return;m()}},g=()=>{h()||m()};return document.addEventListener("visibilitychange",v),window.addEventListener("focus",g),()=>{document.removeEventListener("visibilitychange",v),window.removeEventListener("focus",g)}},[t?.codigo_empresa,m,h]),p.useEffect(()=>{if(t?.codigo_empresa){if(f.current===r.pathname)return;if(f.current=r.pathname,h()){console.log("[AlertsContext] Mudana de rota detectada, mas h modais abertos - ignorando recarga");return}console.log("[AlertsContext] Mudana de rota detectada - recarregando alertas"),m()}},[r.pathname,t?.codigo_empresa,m,h]),a.jsx(MX.Provider,{value:{alerts:n,setAlerts:o,showModal:s,setShowModal:i,showBalloon:l,setShowBalloon:c,loading:d,loadAlerts:m},children:e})},bC=()=>{const e=p.useContext(MX);if(!e)throw new Error("useAlerts must be used within AlertsProvider");return e};function Mwe({onToggleSidebar:e,sidebarVisible:t,sidebarPinned:r}){const{toast:n}=no(),{signOut:o,userProfile:s,company:i,user:l}=So(),{alerts:c,showModal:d,setShowModal:u}=bC(),f=Yi(),h=s?.nome||"Usurio",m=_e.useMemo(()=>{const R=h.trim().split(/\s+/);return R.length>=2?`${R[0]} ${R[1]}`:h},[h]),v=s?.cargo||s?.papel||"";let g="";try{const R=localStorage.getItem("auth:company");if(R){const D=JSON.parse(R);g=D?.nome_fantasia||D?.razao_social||D?.nome||D?.codigoEmpresa||"";var y=D?.logo_url||""}}catch{}const x=i?.nome_fantasia||i?.razao_social||i?.nome||i?.codigoEmpresa||g||"Empresa no vinculada",b=i?.logo_url||(typeof y<"u"?y:""),w=_e.useMemo(()=>i?.logo_url?`${i.logo_url}?v=${Date.now()}`:b||"",[i?.logo_url]),j=_e.useMemo(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}},[]),_=R=>({Package:_d,DollarSign:Ks,CalendarCheck:l4,Clock:vd,ShoppingCart:a1,Store:u4,Users:ml,CalendarPlus:c4,AlertTriangle:qf,Info:$H})[R]||qf,C=R=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[R]||"text-warning",E=({alert:R,onClick:D})=>{const U=_(R.icone),z=C(R.cor);return a.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:D,children:[a.jsx(U,{className:`w-4 h-4 flex-shrink-0 ${z}`}),a.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:R.mensagem}),R.link&&a.jsx(o4,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})},A=async()=>{console.log("[Header] Logout button clicked",{at:new Date().toISOString(),userBefore:!!l});const{error:R}=await o();console.log("[Header] Logout completed",{error:R,userAfter:!!l}),n(R?{title:"Erro ao sair",description:"Ocorreu um erro ao fazer logout. Tente novamente.",variant:"destructive"}:{title:"Logout realizado",description:"Voc foi desconectado com sucesso.",variant:"default"})};new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"});const P=Ls(),F=_e.useMemo(()=>{try{const R=String(P?.pathname||"");if(R==="/"||R.startsWith("/dashboard"))return"";const U=[{key:"/agenda",label:"Agenda"},{key:"/isis",label:"sis"},{key:"/clientes",label:"Clientes & Fornecedores"},{key:"/produtos",label:"Produtos"},{key:"/vendas",label:"Vendas"},{key:"/financeiro",label:"Financeiro"},{key:"/balcao",label:"Balco"},{key:"/cadastros",label:"Cadastros"},{key:"/quadras",label:"Quadras"},{key:"/equipe",label:"Equipe"},{key:"/finalizadoras",label:"Finalizadoras"},{key:"/empresas",label:"Empresas"},{key:"/configuracoes",label:"Configuraes"},{key:"/login",label:"Login"}].find(z=>R.startsWith(z.key));if(U)return U.label;if(typeof document<"u"){const z=String(document.title||"");return(z.includes(" - ")?z.split(" - ")[0]:z)||""}}catch{}return""},[P?.pathname]),M=_e.useMemo(()=>String(P?.pathname||"").startsWith("/isis"),[P?.pathname]),I=_e.useMemo(()=>{const R=i?.nome_fantasia||i?.nome||i?.razao_social||i?.codigoEmpresa||g||"";return String(R).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"").trim()},[i?.nome_fantasia,i?.nome,i?.razao_social,i?.codigoEmpresa,g]);return _e.useMemo(()=>I?`https://${I}.f7arena.com`:"",[I]),a.jsxs(Pr.header,{animate:{opacity:1,y:0},transition:{duration:.6,ease:[.22,1,.36,1]},className:"relative bg-surface/80 backdrop-blur-sm text-text-primary h-14 md:h-[72px] flex-shrink-0 flex items-center justify-between px-3 md:px-8 border-b border-border shadow-[0_1px_0_RGBA(255,255,255,0.04)]",children:[a.jsxs("div",{className:"flex items-center gap-2 md:gap-4 min-w-0 flex-1",children:[a.jsx(ce,{variant:"ghost",size:"icon",onClick:e,"aria-label":t?"Ocultar barra lateral":"Mostrar barra lateral",className:"h-10 w-10 md:h-12 md:w-12 hover:bg-surface-2/60 transition-colors",children:a.jsx(Tue,{className:`w-6 h-6 md:w-7 md:h-7 transition-colors ${t?"text-brand":"text-text-primary"}`})}),a.jsxs("div",{className:"group mx-auto md:mx-0 pl-2 pr-3 md:pl-3 md:pr-5 py-1 md:py-1.5 border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary flex items-center gap-2 md:gap-4 shadow-sm hover:border-white/20 transition-colors overflow-hidden max-w-[60vw] md:max-w-[30vw] lg:max-w-[24vw]",title:x,children:[a.jsx("div",{className:"relative w-9 h-9 md:w-11 md:h-11 shrink-0 overflow-hidden border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)]",children:w?a.jsx("img",{src:w,alt:"Logo",className:"w-full h-full object-cover"}):a.jsx(hue,{className:"w-6 h-6 opacity-80"})}),a.jsx("span",{className:"tracking-tight truncate text-base leading-8 md:text-base md:leading-[44px] text-text-primary font-semibold flex-1 min-w-0 text-center md:text-left",children:x}),j&&a.jsx("span",{className:"ml-2 hidden md:inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-extrabold uppercase tracking-wider bg-red-600 text-white shadow animate-pulse",children:"Dev"})]})]}),M?a.jsx("div",{className:"pointer-events-none absolute z-10 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)] w-8 h-8",children:a.jsx("div",{className:"rounded-full overflow-hidden bg-background w-full h-full",children:a.jsx(xd,{size:"xs",className:"w-8 h-8"})})}),a.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:"sis"})]})}):F?a.jsx("div",{className:"pointer-events-none absolute z-10 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:a.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:F})}):null,a.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[!M&&a.jsxs(ce,{variant:"ghost",onClick:()=>f("/isis"),className:"hidden md:inline-flex items-center gap-2 px-2.5 py-1.5 rounded-full border border-white/10 bg-surface/60 hover:bg-surface-2/70 hover:border-white/20 transition-all duration-200 hover:-translate-y-px hover:shadow-[0_4px_16px_rgba(0,0,0,0.25)]",children:[a.jsx("span",{className:"inline-flex items-center justify-center rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400",children:a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(xd,{size:"xs"})})}),a.jsx("span",{className:"text-sm font-semibold text-text-primary",children:"sis"})]}),a.jsxs(ce,{variant:"ghost",size:"icon",onClick:()=>u(!0),className:"relative text-text-secondary hover:text-text-primary transition-colors duration-200",children:[a.jsx(O_,{className:"h-5 w-5"}),c.length>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-danger text-white text-[10px] font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:c.length})]}),a.jsx(ce,{variant:"ghost",size:"icon",onClick:A,className:"text-text-secondary hover:text-brand hover:bg-brand/10 transition-colors duration-200 shrink-0",children:a.jsx(Oue,{className:"h-5 w-5"})}),a.jsx("div",{className:"hidden md:block w-px h-8 bg-border mx-1 md:mx-2"}),a.jsxs("div",{className:"hidden md:flex group pl-2 pr-3 md:pl-4 md:pr-4 py-1.5 rounded-full border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary items-center gap-2 md:gap-3 shadow-sm hover:border-white/20 transition-colors",title:`${m}  ${v}`,children:[a.jsx("span",{className:"text-xs md:text-sm font-semibold truncate max-w-[120px] md:max-w-[180px]",children:m}),a.jsx("span",{className:"text-[10px] md:text-[11px] px-1.5 md:px-2 py-0.5 rounded-full bg-brand/15 text-brand font-medium tracking-wide",children:v})]})]}),a.jsx(xn,{open:d,onOpenChange:u,children:a.jsxs(vn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[a.jsx(pn,{children:a.jsxs(fn,{className:"flex items-center gap-2",children:[a.jsx(O_,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",c.length,")"]})}),a.jsx("div",{className:"mt-4",children:c.length===0?a.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):a.jsx("ul",{className:"space-y-2 text-sm",children:c.map((R,D)=>a.jsx(E,{alert:R,onClick:()=>{R.link&&(f(R.link),u(!1))}},D))})})]})})]})}const Je=_e.forwardRef(({className:e,type:t,...r},n)=>a.jsx("input",{type:t,className:mr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));Je.displayName="Input";var Rwe="Label",RX=p.forwardRef((e,t)=>a.jsx(oa.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));RX.displayName=Rwe;var LX=RX;const Lwe=M4("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),De=_e.forwardRef(({className:e,...t},r)=>a.jsx(LX,{ref:r,className:mr(Lwe(),e),...t}));De.displayName=LX.displayName;const Fwe=e=>{const t={"Invalid login credentials":"Email ou senha incorretos","Email not confirmed":"Email no confirmado","User not found":"Usurio no encontrado","Invalid email":"Email invlido","Password should be at least 6 characters":"A senha deve ter pelo menos 6 caracteres","Unable to validate email address: invalid format":"Formato de email invlido","Email rate limit exceeded":"Muitas tentativas. Aguarde alguns minutos","Network request failed":"Erro de conexo. Verifique sua internet","Failed to fetch":"Erro de conexo. Verifique sua internet"};if(t[e])return t[e];for(const[r,n]of Object.entries(t))if(e.includes(r))return n;return"Erro ao fazer login. Verifique suas credenciais e tente novamente."},$we=()=>{const[e,t]=p.useState(!1),[r,n]=p.useState(!1),[o,s]=p.useState(""),[i,l]=p.useState({email:"",password:""}),{signIn:c,user:d,authReady:u}=So(),{toast:f}=no();p.useEffect(()=>{if(u&&d)try{const y=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const x=y||"/";console.log("[LoginPage] Redirecionando para:",x),window.location.replace(x)}catch{}},[u,!!d]);const h=y=>{l({...i,[y.target.name]:y.target.value}),o&&s("")},m=async y=>{y.preventDefault(),n(!0),s("");try{const x=await c(i.email,i.password);if(x.error)throw x.error;f({title:"Login realizado!",description:"Bem-vindo de volta!",variant:"default"});try{const b=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const w=b||"/";console.log("[LoginPage] Redirecionando aps login para:",w),window.location.replace(w)}catch{}}catch(x){const b=x.message||"Ocorreu um erro. Tente novamente.",w=Fwe(b);s(w),f({title:"Erro",description:w,variant:"destructive"})}finally{n(!1)}},v={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}},g=(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}})();return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 sm:p-6 relative",children:[g&&a.jsx("div",{className:"pointer-events-none select-none absolute top-4 right-4 z-20",children:a.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-extrabold uppercase tracking-wider bg-red-600 text-white shadow animate-pulse",children:"Dev"})}),a.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.02] mix-blend-overlay"}),a.jsxs(Pr.div,{variants:v,initial:"hidden",animate:"visible",className:"relative z-10 w-full max-w-md pb-20 sm:pb-0",children:[a.jsxs("div",{className:"fx-card",children:[a.jsx("div",{className:"text-center mb-6",children:a.jsxs("div",{className:"flex items-center justify-center mb-4",children:[a.jsx("div",{className:"w-16 h-16 bg-brand rounded-xl flex items-center justify-center mr-4",children:a.jsx(jc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-5xl font-extrabold",children:[a.jsx("span",{style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{style:{color:"#FFAA33"},children:"7"})]}),a.jsx("p",{className:"text-2xl font-semibold",style:{color:"#B0B0B0"},children:"Arena"})]})]})}),a.jsxs("form",{onSubmit:m,className:"space-y-5 sm:space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(De,{htmlFor:"email",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[a.jsx(vx,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Email"]}),a.jsx(Je,{id:"email",name:"email",type:"email",placeholder:"seu@email.com",value:i.email,onChange:h,required:!0,className:"placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(De,{htmlFor:"password",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[a.jsx(gx,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Senha"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Je,{id:"password",name:"password",type:e?"text":"password",placeholder:"Sua senha",value:i.password,onChange:h,required:!0,className:"pr-10 placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"}),a.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary transition-colors",children:e?a.jsx(Mp,{className:"w-5 h-5 sm:w-4 sm:h-4"}):a.jsx(Qp,{className:"w-5 h-5 sm:w-4 sm:h-4"})})]})]}),o&&a.jsx(Pr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 rounded-lg bg-destructive/10 border border-destructive/30 text-destructive text-sm",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:"flex-1",children:o})]})}),a.jsx(ce,{type:"submit",className:"w-full h-12 sm:h-10 text-base sm:text-sm",disabled:r,children:r?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-primary-foreground border-t-transparent rounded-full animate-spin"}),"Entrando..."]}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Iue,{className:"w-4 h-4"}),"Entrar"]})})]})]}),a.jsx("p",{className:"mt-4 text-center text-xs text-text-muted opacity-70",children:" 2025 Fluxo7 Arena  Todos os direitos reservados."})]})]})})},k6=({children:e})=>{const{user:t,authReady:r}=So(),n=Ls();return p.useEffect(()=>{if(r&&!t&&n.pathname!=="/login")try{sessionStorage.setItem("auth:returnUrl",n.pathname+n.search),console.log("[ProtectedRoute] Salvando rota de retorno:",n.pathname+n.search)}catch(o){console.warn("[ProtectedRoute] Erro ao salvar rota de retorno:",o)}},[r,t,n.pathname,n.search]),r?t?e:a.jsx($we,{}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-brand border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-text-primary font-medium",children:"Carregando..."})]})})},Bwe=p.createContext(),qwe=({children:e})=>{const[t,r]=p.useState({payment:{open:!1,data:null},editParticipant:{open:!1,data:null}}),[n,o]=p.useState(new Set),s=p.useCallback((f,h=null)=>{console.log(" [MODALS] Abrindo modal:",f,h),r(m=>({...m,[f]:{open:!0,data:h}}))},[]),i=p.useCallback(f=>{if(n.has(f)){console.log(` [ModalsContext] Modal "${f}" est protegido, ignorando fechamento`);return}r(h=>({...h,[f]:{open:!1,data:{}}}))},[n]),l=p.useCallback(f=>t[f]?.open||!1,[t]),c=p.useCallback(f=>t[f]?.data||{},[t]),d=p.useCallback(f=>{console.log(` [ModalsContext] Protegendo modal "${f}"`),o(h=>new Set([...h,f]))},[]),u=p.useCallback(f=>{console.log(` [ModalsContext] Desprotegendo modal "${f}"`),o(h=>{const m=new Set(h);return m.delete(f),m})},[]);return a.jsx(Bwe.Provider,{value:{openModal:s,closeModal:i,isModalOpen:l,getModalData:c,protectModal:d,unprotectModal:u},children:e})},FX=p.createContext(),X_=()=>{const e=p.useContext(FX);if(!e)throw new Error("useAgenda must be used within AgendaProvider");return e},zwe=({children:e})=>{const[t,r]=p.useState(!1),[n,o]=p.useState(!1),[s,i]=p.useState(!1),[l,c]=p.useState({participantId:null,participantName:""}),[d,u]=p.useState(null),[f,h]=p.useState([]),[m,v]=p.useState(""),[g,y]=p.useState([]),[x,b]=p.useState(null),[w,j]=p.useState([]),_=p.useRef({isProtected:!1,protectedUntil:0}),C=p.useRef(Date.now()),E=p.useRef(null),A=Ls(),P=p.useCallback((U=2e3)=>{const z=Date.now()+U;if(z>_.current.protectedUntil)_.current.isProtected=!0,_.current.protectedUntil=z;else return;setTimeout(()=>{Date.now()>=_.current.protectedUntil&&(_.current.isProtected=!1)},U)},[]),F=p.useCallback(()=>{r(!0)},[]),M=p.useCallback(()=>{const U=Date.now();if(_.current.isProtected&&U<_.current.protectedUntil){const H=_.current.protectedUntil-U;try{localStorage.getItem("debug:agenda")==="1"&&console.log(` [PaymentModal] Fechamento bloqueado por proteo (${H}ms restantes)`)}catch{}return!1}if(Date.now()-C.current<500){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechamento bloqueado por mudana de visibilidade recente")}catch{}return!1}try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechando modal (no protegido)")}catch{}return r(!1),!0},[]),I=p.useCallback((U,z)=>{c({participantId:U,participantName:z}),o(!0),P(3e3)},[P]),R=p.useCallback(()=>{o(!1),c({participantId:null,participantName:""})},[]);p.useEffect(()=>{if(!(A?.pathname||"").startsWith("/agenda"))return()=>{};const H=()=>{const Q=Date.now(),pe=document.hidden;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] visibilitychange:",{hidden:pe,timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(C.current=Q,!pe&&t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Aba restaurada com modal aberto - protegendo por 3s")}catch{}const be=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=be}},q=()=>{const Q=Date.now();try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] window focus:",{timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(C.current=Q,t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Janela ganhou foco com modal aberto - protegendo por 3s")}catch{}const pe=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=pe}};return document.addEventListener("visibilitychange",H),window.addEventListener("focus",q),()=>{document.removeEventListener("visibilitychange",H),window.removeEventListener("focus",q)}},[t,A?.pathname]);const D={isPaymentModalOpen:t,isEditParticipantModalOpen:n,isAddBookingModalOpen:s,openPaymentModal:F,closePaymentModal:M,openEditParticipantModal:I,closeEditParticipantModal:R,setIsAddBookingModalOpen:i,editParticipantData:l,editingBooking:d,setEditingBooking:u,participantsForm:f,setParticipantsForm:h,paymentTotal:m,setPaymentTotal:v,payMethods:g,setPayMethods:y,bookingForm:x,setBookingForm:b,localCustomers:w,setLocalCustomers:j,protectPaymentModal:P,onParticipantReplacedRef:E,get lastVisibilityChangeTime(){return C.current},get isModalProtected(){const U=Date.now();return _.current.isProtected&&U<_.current.protectedUntil}};return a.jsx(FX.Provider,{value:D,children:e})},Uwe="https://guildthlqkfubbqoybys.supabase.co",Vwe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1aWxkdGhscWtmdWJicW95YnlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3NTY2NjksImV4cCI6MjA4MTMzMjY2OX0.9--rqgkuDVLiwhU93RLV1YwEYVW6aRe9Qf5Mh80aVCg",$X=bX(Uwe,Vwe,{auth:{persistSession:!1,storageKey:"isis-auth",storage:void 0},global:{headers:{"X-Client-Info":"fluxo7-isis-web"}}}),BX=p.createContext(),Z4=()=>{const e=p.useContext(BX);if(!e)throw new Error("useIsis deve ser usado dentro de IsisProvider");return e},qX=({children:e})=>{const[t,r]=p.useState("greeting"),[n,o]=p.useState([]),s=p.useRef((()=>{try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const ee=[...Array(36)].map(()=>"x");return ee[8]=ee[13]=ee[18]=ee[23]="-",ee[14]="4",ee.map((de,Le)=>{if(de!=="x")return de;const ae=Math.random()*16|0;return(Le===19?ae&3|8:ae).toString(16)}).join("")}catch{return"00000000-0000-4000-8000-000000000000"}})()),[i,l]=p.useState(s.current),[c,d]=p.useState({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),[u,f]=p.useState(!1),[h,m]=p.useState(!1),v=p.useRef(null),y=[["VITE_KEY_CHAT_ISIS",{}.VITE_KEY_CHAT_ISIS],["VITE-KEY-CHAT-ISIS",{VITE_JSONBIN_BIN_ID:"690605e5ae596e708f3c7bc5",VITE_JSONBIN_ISIS_BIN_ID:"6939b808ae596e708f90b843",VITE_JSONBIN_API_KEY:"$/XmOGvx8./SZzV3qMzQ5i.6FjBjS4toNbeaEFzX2D8QPUddyM6VR2",VITE_SUPABASE_URL:"https://dlfryxtyxqoacuunswuc.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY",VITE_SUPABASE_URL_ISIS:"https://guildthlqkfubbqoybys.supabase.co",VITE_SUPABASE_ANON_KEY_ISIS:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1aWxkdGhscWtmdWJicW95YnlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3NTY2NjksImV4cCI6MjA4MTMzMjY2OX0.9--rqgkuDVLiwhU93RLV1YwEYVW6aRe9Qf5Mh80aVCg",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}["VITE-KEY-CHAT-ISIS"]],["KEY_CHAT_ISIS",{}.KEY_CHAT_ISIS],["KEY-CHAT-ISIS",{VITE_JSONBIN_BIN_ID:"690605e5ae596e708f3c7bc5",VITE_JSONBIN_ISIS_BIN_ID:"6939b808ae596e708f90b843",VITE_JSONBIN_API_KEY:"$/XmOGvx8./SZzV3qMzQ5i.6FjBjS4toNbeaEFzX2D8QPUddyM6VR2",VITE_SUPABASE_URL:"https://dlfryxtyxqoacuunswuc.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY",VITE_SUPABASE_URL_ISIS:"https://guildthlqkfubbqoybys.supabase.co",VITE_SUPABASE_ANON_KEY_ISIS:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1aWxkdGhscWtmdWJicW95YnlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3NTY2NjksImV4cCI6MjA4MTMzMjY2OX0.9--rqgkuDVLiwhU93RLV1YwEYVW6aRe9Qf5Mh80aVCg",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}["KEY-CHAT-ISIS"]]].find(([ee,de])=>!!de),x=y?.[1],b=y?.[0]||"none",w={}.VITE_JSONBIN_COLLECTION_ID||null,j="6939b808ae596e708f90b843",_="https://api.jsonbin.io/v3/b",C={}.VITE_ISIS_EDGE_SYNC==="1",[E,A]=p.useState(C?j:null);if(C&&typeof window<"u")try{console.info("[Isis][JSONBin] keySource=%s binId=%s",b,j||window.localStorage.getItem("ISIS_JSONBIN_BIN_ID")||"none")}catch{}const P=p.useCallback(async ee=>{if(!C)return{ok:!1,data:null};if(!x){try{console.debug("[Isis][Edge] skipped (no JSONBIN key) mode=%s",ee?.mode)}catch{}return{ok:!1,data:null}}try{const{data:de,error:Le}=await fe.functions.invoke("isis-chat",{body:ee});if(Le){try{console.debug("[Isis][Edge] %s error=%o",ee?.mode,Le)}catch{}return{ok:!1,data:null}}try{console.debug("[Isis][Edge] %s ok resp=%o",ee?.mode,de)}catch{}return{ok:!0,data:de}}catch(de){try{console.debug("[Isis][Edge] invoke exception:",de)}catch{}return{ok:!1,data:null}}},[x,C]),F=p.useCallback(async ee=>{if(!x)return null;const de={"X-Master-Key":x,"X-Access-Key":x,"Content-Type":"application/json"};w&&(de["X-Collection-Id"]=w);const Le=await fetch(`${_}`,{method:"POST",headers:de,body:JSON.stringify(ee||{projects:[{name:"F7 Arena"}],chat_sessions:[]})});if(!Le.ok)return null;const ae=await Le.json().catch(()=>null),ie=ae?.metadata?.id||ae?.id||null;if(ie){A(ie);try{window?.localStorage?.setItem("ISIS_JSONBIN_BIN_ID",ie)}catch{}}return ie},[x]),M=p.useCallback(async()=>{if(!x||!E)return null;try{console.debug("[Isis][JSONBin] loadBin: GET %s/%s",_,E)}catch{}const ee={"X-Master-Key":x,"X-Access-Key":x,"X-Bin-Meta":"false","Content-Type":"application/json"};w&&(ee["X-Collection-Id"]=w);const de=await fetch(`${_}/${E}`,{method:"GET",headers:ee});try{console.debug("[Isis][JSONBin] loadBin: status=%s",de?.status)}catch{}if(de.status===401||de.status===404){try{console.error("[Isis][JSONBin] GET unauthorized or not found. keySource=%s binId=%s status=%s",b,E,de.status)}catch{}return await F()?{projects:[{name:"F7 Arena"}],chat_sessions:[]}:null}if(!de.ok)return null;try{return await de.json()}catch{return null}},[x,E,F]),I=p.useCallback(async ee=>{if(!x||!E&&!await F(ee))return!1;const de=E||(typeof window<"u"?window.localStorage.getItem("ISIS_JSONBIN_BIN_ID"):null);try{console.debug("[Isis][JSONBin] saveBin: PUT %s/%s",_,de)}catch{}const Le={"X-Master-Key":x,"X-Access-Key":x,"Content-Type":"application/json"};w&&(Le["X-Collection-Id"]=w);const ae=await fetch(`${_}/${de}`,{method:"PUT",headers:Le,body:JSON.stringify(ee)});try{console.debug("[Isis][JSONBin] saveBin: status=%s",ae?.status)}catch{}if(ae.status===401||ae.status===404){try{console.error("[Isis][JSONBin] PUT unauthorized or not found. keySource=%s binId=%s status=%s",b,de,ae.status)}catch{}return!!await F(ee)}return ae.ok},[x,E,F]),R=ee=>!ee||typeof ee!="object"?{projects:[{name:"F7 Arena"}],chat_sessions:[]}:(Array.isArray(ee.chat_sessions)||(ee.chat_sessions=[]),ee),D=(ee,de)=>(Array.isArray(ee?.chat_sessions)?ee.chat_sessions:[]).findIndex(ae=>(ae?.project||"").toString()===(de.project||"").toString()&&(ae?.company?.code||"").toString()===(de.companyCode||"").toString()&&(ae?.client_code||"").toString()===(de.clientCode||"").toString()),U=p.useCallback(async()=>{if(i)return i;try{try{console.info("[Isis][Chat] ensureSession: start")}catch{}const ee=c?.empresa||null,de=ee?{code:ee.codigo_empresa||ee.codigoEmpresa,name:ee.nome_fantasia||ee.nome}:null,Le=c?.cliente||null;let ae=await M();ae=R(ae),Array.isArray(ae.projects)||(ae.projects=[{name:"F7 Arena"}]);const ie={project:"F7 Arena",companyCode:de?.code||null,clientCode:Le?.id?String(Le.id):null};try{console.debug("[Isis][Chat] ensureSession: criteria=%o",ie)}catch{}if(ie.companyCode&&ie.clientCode){const dt=D(ae,ie);try{console.debug("[Isis][Chat] ensureSession: existingIndex=%s",dt)}catch{}dt===-1&&ae.chat_sessions.push({client_code:ie.clientCode,client_name:Le?.nome||Le?.name||"",company:de,project:ie.project,conversation:[]})}await I(ae);try{console.info("[Isis][Chat] ensureSession: sessionId=%s",i)}catch{}return i}catch(ee){try{console.error("[Isis][Chat] ensureSession: failed",ee)}catch{}return null}},[i,c?.empresa,c?.cliente,M,I]),z=p.useCallback(async ee=>{if(ee)try{const de=c?.empresa||null,Le=de?{code:de.codigo_empresa||de.codigoEmpresa,name:de.nome_fantasia||de.nome}:null,ae=c?.cliente||null;let ie=await M();if(!ie)return;ie=R(ie);const dt={project:"F7 Arena",companyCode:Le?.code||null,clientCode:ae?.id?String(ae.id):null};try{console.debug("[Isis][Chat] tryUpdateSessionMeta: criteria=%o",dt)}catch{}if(!dt.companyCode&&!dt.clientCode)return;let At=D(ie,dt);if(At===-1){ie.chat_sessions.push({client_code:dt.clientCode,client_name:ae?.nome||ae?.name||"",company:Le,project:dt.project,conversation:[]}),At=ie.chat_sessions.length-1;try{console.debug("[Isis][Chat] tryUpdateSessionMeta: created index=%s",At)}catch{}}else{ae?.id&&!ie.chat_sessions[At].client_code&&(ie.chat_sessions[At].client_code=String(ae.id)),ae?.nome&&!ie.chat_sessions[At].client_name&&(ie.chat_sessions[At].client_name=ae.nome),Le&&!ie.chat_sessions[At].company&&(ie.chat_sessions[At].company=Le);try{console.debug("[Isis][Chat] tryUpdateSessionMeta: updated index=%s",At)}catch{}}await I(ie),Le?.name&&ae?.id&&await P({mode:"set_meta",cod_cliente:ae?.id?String(ae.id):"",nome_cliente:ae?.nome||ae?.name||"",empresa:Le.name,software:"F7 Arena"})}catch{}},[c?.empresa,c?.cliente,M,I,P]),H=p.useCallback(async ee=>{try{try{console.info("[Isis][Chat] persistMessage: incoming=%o",{from:ee.from,text:ee.text})}catch{}const de=c?.empresa||null,Le=de?{code:de.codigo_empresa||de.codigoEmpresa,name:de.nome_fantasia||de.nome}:null,ae=c?.cliente||null;try{const ie=ee.from==="isis"?"assistant":"user",dt=Le?.name||de?.nome_fantasia||de?.nome||de?.razao_social||"Desconhecida",At={id:`${Date.now()}${Math.random().toString(36).slice(2,10)}`,cod_cliente:ae?.id?String(ae.id):null,nome_cliente:ae?.nome||ae?.name||null,empresa:dt,projeto:"fluxo7arena",nota:null,comentario:null,conversa:JSON.stringify({session_id:i,from:ie,text:String(ee.text??"")}),timestamp:new Date().toISOString()},{error:st}=await $X.from("isis").insert(At);if(st)try{console.error("[Isis][Chat] supabase-isis insert error:",st)}catch{}else try{console.debug("[Isis][Chat] supabase-isis inserted")}catch{}}catch(ie){try{console.error("[Isis][Chat] supabase-isis exception:",ie)}catch{}}if(C&&await P({mode:"append_message",cod_cliente:ae?.id?String(ae.id):"_unknown",nome_cliente:ae?.nome||ae?.name||"",empresa:Le?.name||"",software:"F7 Arena",session_id:i,message:{from:ee.from==="isis"?"assistant":"user",text:String(ee.text??"")}}),C)try{const ie=await U();if(!ie)return;const dt=ee.from==="isis"?"assistant":"user",At={ts:new Date().toISOString(),from:dt,text:String(ee.text??"")};let st=await M();if(!st)return;st=R(st);const ut=c?.empresa||null,Rt=ut?{code:ut.codigo_empresa||ut.codigoEmpresa,name:ut.nome_fantasia||ut.nome}:null,Nt=c?.cliente||null,tt={project:"F7 Arena",companyCode:Rt?.code||null,clientCode:Nt?.id?String(Nt.id):null};let he=D(st,tt);he===-1?st.chat_sessions.push({client_code:tt.clientCode,client_name:Nt?.nome||Nt?.name||"",company:Rt,project:tt.project,conversation:[At]}):(Array.isArray(st.chat_sessions[he].conversation)||(st.chat_sessions[he].conversation=[]),st.chat_sessions[he].conversation.push(At)),await I(st),z(ie)}catch{}}catch{}},[U,z,M,I,P,c?.empresa,c?.cliente,i]),q=p.useCallback(ee=>{o(de=>[...de,{id:Date.now()+Math.random(),timestamp:new Date,...ee}]),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth"})},100);try{H(ee)}catch{}},[]),Q=p.useCallback((ee,de=2e3,Le=null)=>{m(!0),setTimeout(()=>{m(!1);const ae=ee&&typeof ee=="object"&&ee.text?ee:{text:ee};q({from:"isis",text:ae.text,type:"text",color:ae.color??Le,copyable:!!ae.copyable,copyText:ae.copyText})},de)},[q]),pe=p.useCallback((ee,de,Le=2e3)=>{m(!0),setTimeout(()=>{m(!1),o(ae=>ae.map(ie=>ie.type==="buttons"&&ie.buttons&&ie.buttons.length>0?{...ie,disabled:!0}:ie)),q({from:"isis",text:ee,type:"buttons",buttons:de,disabled:!1})},Le)},[q]),be=p.useCallback(()=>{o(ee=>ee.map(de=>de.type==="buttons"&&de.buttons&&de.buttons.length>0&&!de.disabled?{...de,disabled:!0}:de))},[]),V=p.useCallback(ee=>{o(de=>de.filter(Le=>Le.id!==ee))},[]),B=p.useCallback(ee=>{o(de=>de.map(Le=>Le.id===ee&&Le.type==="buttons"?{...Le,buttonsHidden:!0,disabled:!0}:Le))},[]),J=p.useCallback(ee=>{q({from:"user",text:ee,type:"text"})},[q]),ue=p.useCallback((ee,de)=>{if(d(Le=>({...Le,[ee]:de})),(ee==="cliente"||ee==="empresa")&&i)try{z(i)}catch{}},[]),Ne=p.useCallback((ee,de)=>{d(Le=>({...Le,contato:{...Le.contato,[ee]:de}}))},[]),Z=p.useCallback(ee=>{r(ee)},[]),ge=p.useCallback(()=>{const ee=["greeting","quadra","data","horario","modalidade","quantidade","nomes","contato","review","confirmation","avaliacao"],de=ee.indexOf(t);de>0&&r(ee[de-1])},[t]),le=p.useCallback(()=>{r("greeting"),o([]),d({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),f(!1),m(!1),l(null)},[]),se={currentStep:t,messages:n,selections:c,sessionId:i,isLoading:u,isTyping:h,chatEndRef:v,addMessage:q,addIsisMessage:Q,addIsisMessageWithButtons:pe,addUserMessage:J,disableAllButtons:be,removeMessageById:V,hideButtonsInMessage:B,updateSelection:ue,updateContact:Ne,nextStep:Z,previousStep:ge,resetConversation:le,setIsLoading:f,setIsTyping:m};return a.jsx(BX.Provider,{value:se,children:e})};var Wwe=Array.isArray,Jl=Wwe,Hwe=typeof Gi=="object"&&Gi&&Gi.Object===Object&&Gi,zX=Hwe,Gwe=zX,Kwe=typeof self=="object"&&self&&self.Object===Object&&self,Xwe=Gwe||Kwe||Function("return this")(),Qu=Xwe,Ywe=Qu,Jwe=Ywe.Symbol,f1=Jwe,I6=f1,UX=Object.prototype,Qwe=UX.hasOwnProperty,Zwe=UX.toString,ry=I6?I6.toStringTag:void 0;function e1e(e){var t=Qwe.call(e,ry),r=e[ry];try{e[ry]=void 0;var n=!0}catch{}var o=Zwe.call(e);return n&&(t?e[ry]=r:delete e[ry]),o}var t1e=e1e,r1e=Object.prototype,n1e=r1e.toString;function a1e(e){return n1e.call(e)}var o1e=a1e,O6=f1,s1e=t1e,i1e=o1e,l1e="[object Null]",c1e="[object Undefined]",T6=O6?O6.toStringTag:void 0;function d1e(e){return e==null?e===void 0?c1e:l1e:T6&&T6 in Object(e)?s1e(e):i1e(e)}var tm=d1e;function u1e(e){return e!=null&&typeof e=="object"}var rm=u1e,f1e=tm,m1e=rm,h1e="[object Symbol]";function p1e(e){return typeof e=="symbol"||m1e(e)&&f1e(e)==h1e}var m0=p1e,g1e=Jl,v1e=m0,x1e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,y1e=/^\w*$/;function b1e(e,t){if(g1e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||v1e(e)?!0:y1e.test(e)||!x1e.test(e)||t!=null&&e in Object(t)}var eD=b1e;function w1e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Rh=w1e;const h0=Ga(Rh);var j1e=tm,_1e=Rh,N1e="[object AsyncFunction]",S1e="[object Function]",C1e="[object GeneratorFunction]",P1e="[object Proxy]";function A1e(e){if(!_1e(e))return!1;var t=j1e(e);return t==S1e||t==C1e||t==N1e||t==P1e}var tD=A1e;const na=Ga(tD);var E1e=Qu,k1e=E1e["__core-js_shared__"],I1e=k1e,bA=I1e,D6=function(){var e=/[^.]+$/.exec(bA&&bA.keys&&bA.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function O1e(e){return!!D6&&D6 in e}var T1e=O1e,D1e=Function.prototype,M1e=D1e.toString;function R1e(e){if(e!=null){try{return M1e.call(e)}catch{}try{return e+""}catch{}}return""}var VX=R1e,L1e=tD,F1e=T1e,$1e=Rh,B1e=VX,q1e=/[\\^$.*+?()[\]{}|]/g,z1e=/^\[object .+?Constructor\]$/,U1e=Function.prototype,V1e=Object.prototype,W1e=U1e.toString,H1e=V1e.hasOwnProperty,G1e=RegExp("^"+W1e.call(H1e).replace(q1e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function K1e(e){if(!$1e(e)||F1e(e))return!1;var t=L1e(e)?G1e:z1e;return t.test(B1e(e))}var X1e=K1e;function Y1e(e,t){return e?.[t]}var J1e=Y1e,Q1e=X1e,Z1e=J1e;function e2e(e,t){var r=Z1e(e,t);return Q1e(r)?r:void 0}var _g=e2e,t2e=_g,r2e=t2e(Object,"create"),wC=r2e,M6=wC;function n2e(){this.__data__=M6?M6(null):{},this.size=0}var a2e=n2e;function o2e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var s2e=o2e,i2e=wC,l2e="__lodash_hash_undefined__",c2e=Object.prototype,d2e=c2e.hasOwnProperty;function u2e(e){var t=this.__data__;if(i2e){var r=t[e];return r===l2e?void 0:r}return d2e.call(t,e)?t[e]:void 0}var f2e=u2e,m2e=wC,h2e=Object.prototype,p2e=h2e.hasOwnProperty;function g2e(e){var t=this.__data__;return m2e?t[e]!==void 0:p2e.call(t,e)}var v2e=g2e,x2e=wC,y2e="__lodash_hash_undefined__";function b2e(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=x2e&&t===void 0?y2e:t,this}var w2e=b2e,j2e=a2e,_2e=s2e,N2e=f2e,S2e=v2e,C2e=w2e;function p0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}p0.prototype.clear=j2e;p0.prototype.delete=_2e;p0.prototype.get=N2e;p0.prototype.has=S2e;p0.prototype.set=C2e;var P2e=p0;function A2e(){this.__data__=[],this.size=0}var E2e=A2e;function k2e(e,t){return e===t||e!==e&&t!==t}var rD=k2e,I2e=rD;function O2e(e,t){for(var r=e.length;r--;)if(I2e(e[r][0],t))return r;return-1}var jC=O2e,T2e=jC,D2e=Array.prototype,M2e=D2e.splice;function R2e(e){var t=this.__data__,r=T2e(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():M2e.call(t,r,1),--this.size,!0}var L2e=R2e,F2e=jC;function $2e(e){var t=this.__data__,r=F2e(t,e);return r<0?void 0:t[r][1]}var B2e=$2e,q2e=jC;function z2e(e){return q2e(this.__data__,e)>-1}var U2e=z2e,V2e=jC;function W2e(e,t){var r=this.__data__,n=V2e(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var H2e=W2e,G2e=E2e,K2e=L2e,X2e=B2e,Y2e=U2e,J2e=H2e;function g0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}g0.prototype.clear=G2e;g0.prototype.delete=K2e;g0.prototype.get=X2e;g0.prototype.has=Y2e;g0.prototype.set=J2e;var _C=g0,Q2e=_g,Z2e=Qu,eje=Q2e(Z2e,"Map"),nD=eje,R6=P2e,tje=_C,rje=nD;function nje(){this.size=0,this.__data__={hash:new R6,map:new(rje||tje),string:new R6}}var aje=nje;function oje(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var sje=oje,ije=sje;function lje(e,t){var r=e.__data__;return ije(t)?r[typeof t=="string"?"string":"hash"]:r.map}var NC=lje,cje=NC;function dje(e){var t=cje(this,e).delete(e);return this.size-=t?1:0,t}var uje=dje,fje=NC;function mje(e){return fje(this,e).get(e)}var hje=mje,pje=NC;function gje(e){return pje(this,e).has(e)}var vje=gje,xje=NC;function yje(e,t){var r=xje(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var bje=yje,wje=aje,jje=uje,_je=hje,Nje=vje,Sje=bje;function v0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}v0.prototype.clear=wje;v0.prototype.delete=jje;v0.prototype.get=_je;v0.prototype.has=Nje;v0.prototype.set=Sje;var aD=v0,WX=aD,Cje="Expected a function";function oD(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Cje);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],s=r.cache;if(s.has(o))return s.get(o);var i=e.apply(this,n);return r.cache=s.set(o,i)||s,i};return r.cache=new(oD.Cache||WX),r}oD.Cache=WX;var HX=oD;const Pje=Ga(HX);var Aje=HX,Eje=500;function kje(e){var t=Aje(e,function(n){return r.size===Eje&&r.clear(),n}),r=t.cache;return t}var Ije=kje,Oje=Ije,Tje=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dje=/\\(\\)?/g,Mje=Oje(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Tje,function(r,n,o,s){t.push(o?s.replace(Dje,"$1"):n||r)}),t}),Rje=Mje;function Lje(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var sD=Lje,L6=f1,Fje=sD,$je=Jl,Bje=m0,qje=1/0,F6=L6?L6.prototype:void 0,$6=F6?F6.toString:void 0;function GX(e){if(typeof e=="string")return e;if($je(e))return Fje(e,GX)+"";if(Bje(e))return $6?$6.call(e):"";var t=e+"";return t=="0"&&1/e==-qje?"-0":t}var zje=GX,Uje=zje;function Vje(e){return e==null?"":Uje(e)}var KX=Vje,Wje=Jl,Hje=eD,Gje=Rje,Kje=KX;function Xje(e,t){return Wje(e)?e:Hje(e,t)?[e]:Gje(Kje(e))}var XX=Xje,Yje=m0,Jje=1/0;function Qje(e){if(typeof e=="string"||Yje(e))return e;var t=e+"";return t=="0"&&1/e==-Jje?"-0":t}var SC=Qje,Zje=XX,e_e=SC;function t_e(e,t){t=Zje(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[e_e(t[r++])];return r&&r==n?e:void 0}var iD=t_e,r_e=iD;function n_e(e,t,r){var n=e==null?void 0:r_e(e,t);return n===void 0?r:n}var YX=n_e;const Ec=Ga(YX);function a_e(e){return e==null}var o_e=a_e;const ua=Ga(o_e);var s_e=tm,i_e=Jl,l_e=rm,c_e="[object String]";function d_e(e){return typeof e=="string"||!i_e(e)&&l_e(e)&&s_e(e)==c_e}var u_e=d_e;const rg=Ga(u_e);var JX={exports:{}},mo={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lD=Symbol.for("react.element"),cD=Symbol.for("react.portal"),CC=Symbol.for("react.fragment"),PC=Symbol.for("react.strict_mode"),AC=Symbol.for("react.profiler"),EC=Symbol.for("react.provider"),kC=Symbol.for("react.context"),f_e=Symbol.for("react.server_context"),IC=Symbol.for("react.forward_ref"),OC=Symbol.for("react.suspense"),TC=Symbol.for("react.suspense_list"),DC=Symbol.for("react.memo"),MC=Symbol.for("react.lazy"),m_e=Symbol.for("react.offscreen"),QX;QX=Symbol.for("react.module.reference");function Ad(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case lD:switch(e=e.type,e){case CC:case AC:case PC:case OC:case TC:return e;default:switch(e=e&&e.$$typeof,e){case f_e:case kC:case IC:case MC:case DC:case EC:return e;default:return t}}case cD:return t}}}mo.ContextConsumer=kC;mo.ContextProvider=EC;mo.Element=lD;mo.ForwardRef=IC;mo.Fragment=CC;mo.Lazy=MC;mo.Memo=DC;mo.Portal=cD;mo.Profiler=AC;mo.StrictMode=PC;mo.Suspense=OC;mo.SuspenseList=TC;mo.isAsyncMode=function(){return!1};mo.isConcurrentMode=function(){return!1};mo.isContextConsumer=function(e){return Ad(e)===kC};mo.isContextProvider=function(e){return Ad(e)===EC};mo.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===lD};mo.isForwardRef=function(e){return Ad(e)===IC};mo.isFragment=function(e){return Ad(e)===CC};mo.isLazy=function(e){return Ad(e)===MC};mo.isMemo=function(e){return Ad(e)===DC};mo.isPortal=function(e){return Ad(e)===cD};mo.isProfiler=function(e){return Ad(e)===AC};mo.isStrictMode=function(e){return Ad(e)===PC};mo.isSuspense=function(e){return Ad(e)===OC};mo.isSuspenseList=function(e){return Ad(e)===TC};mo.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===CC||e===AC||e===PC||e===OC||e===TC||e===m_e||typeof e=="object"&&e!==null&&(e.$$typeof===MC||e.$$typeof===DC||e.$$typeof===EC||e.$$typeof===kC||e.$$typeof===IC||e.$$typeof===QX||e.getModuleId!==void 0)};mo.typeOf=Ad;JX.exports=mo;var h_e=JX.exports,p_e=tm,g_e=rm,v_e="[object Number]";function x_e(e){return typeof e=="number"||g_e(e)&&p_e(e)==v_e}var ZX=x_e;const y_e=Ga(ZX);var b_e=ZX;function w_e(e){return b_e(e)&&e!=+e}var j_e=w_e;const x0=Ga(j_e);var hl=function(t){return t===0?0:t>0?1:-1},_p=function(t){return rg(t)&&t.indexOf("%")===t.length-1},en=function(t){return y_e(t)&&!x0(t)},__e=function(t){return ua(t)},Js=function(t){return en(t)||rg(t)},N_e=0,Ng=function(t){var r=++N_e;return"".concat(t||"").concat(r)},pl=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!en(t)&&!rg(t))return n;var s;if(_p(t)){var i=t.indexOf("%");s=r*parseFloat(t.slice(0,i))/100}else s=+t;return x0(s)&&(s=n),o&&s>r&&(s=r),s},Dm=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},S_e=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},o=0;o<r;o++)if(!n[t[o]])n[t[o]]=!0;else return!0;return!1},Xs=function(t,r){return en(t)&&en(r)?function(n){return t+n*(r-t)}:function(){return r}};function Y_(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Ec(n,t))===r})}var C_e=function(t,r){return en(t)&&en(r)?t-r:rg(t)&&rg(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Qv(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function OI(e){"@babel/helpers - typeof";return OI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OI(e)}var P_e=["viewBox","children"],A_e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],B6=["points","pathLength"],wA={svg:P_e,polygon:B6,polyline:B6},dD=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],J_=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(p.isValidElement(t)&&(n=t.props),!h0(n))return null;var o={};return Object.keys(n).forEach(function(s){dD.includes(s)&&(o[s]=r||function(i){return n[s](n,i)})}),o},E_e=function(t,r,n){return function(o){return t(r,n,o),null}},ng=function(t,r,n){if(!h0(t)||OI(t)!=="object")return null;var o=null;return Object.keys(t).forEach(function(s){var i=t[s];dD.includes(s)&&typeof i=="function"&&(o||(o={}),o[s]=E_e(i,r,n))}),o},k_e=["children"],I_e=["children"];function q6(e,t){if(e==null)return{};var r=O_e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function O_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function TI(e){"@babel/helpers - typeof";return TI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TI(e)}var z6={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Mf=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},U6=null,jA=null,uD=function e(t){if(t===U6&&Array.isArray(jA))return jA;var r=[];return p.Children.forEach(t,function(n){ua(n)||(h_e.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),jA=r,U6=t,r};function kc(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(o){return Mf(o)}):n=[Mf(t)],uD(e).forEach(function(o){var s=Ec(o,"type.displayName")||Ec(o,"type.name");n.indexOf(s)!==-1&&r.push(o)}),r}function gc(e,t){var r=kc(e,t);return r&&r[0]}var V6=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,o=r.height;return!(!en(n)||n<=0||!en(o)||o<=0)},T_e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],D_e=function(t){return t&&t.type&&rg(t.type)&&T_e.indexOf(t.type)>=0},eY=function(t){return t&&TI(t)==="object"&&"clipDot"in t},M_e=function(t,r,n,o){var s,i=(s=wA?.[o])!==null&&s!==void 0?s:[];return r.startsWith("data-")||!na(t)&&(o&&i.includes(r)||A_e.includes(r))||n&&dD.includes(r)},Kn=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(p.isValidElement(t)&&(o=t.props),!h0(o))return null;var s={};return Object.keys(o).forEach(function(i){var l;M_e((l=o)===null||l===void 0?void 0:l[i],i,r,n)&&(s[i]=o[i])}),s},DI=function e(t,r){if(t===r)return!0;var n=p.Children.count(t);if(n!==p.Children.count(r))return!1;if(n===0)return!0;if(n===1)return W6(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var o=0;o<n;o++){var s=t[o],i=r[o];if(Array.isArray(s)||Array.isArray(i)){if(!e(s,i))return!1}else if(!W6(s,i))return!1}return!0},W6=function(t,r){if(ua(t)&&ua(r))return!0;if(!ua(t)&&!ua(r)){var n=t.props||{},o=n.children,s=q6(n,k_e),i=r.props||{},l=i.children,c=q6(i,I_e);return o&&l?Qv(s,c)&&DI(o,l):!o&&!l?Qv(s,c):!1}return!1},H6=function(t,r){var n=[],o={};return uD(t).forEach(function(s,i){if(D_e(s))n.push(s);else if(s){var l=Mf(s.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!o[l])){var f=d(s,l,i);n.push(f),o[l]=!0}}}),n},R_e=function(t){var r=t&&t.type;return r&&z6[r]?z6[r]:null},L_e=function(t,r){return uD(r).indexOf(t)},F_e=["children","width","height","viewBox","className","style","title","desc"];function MI(){return MI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MI.apply(this,arguments)}function $_e(e,t){if(e==null)return{};var r=B_e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function B_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function RI(e){var t=e.children,r=e.width,n=e.height,o=e.viewBox,s=e.className,i=e.style,l=e.title,c=e.desc,d=$_e(e,F_e),u=o||{width:r,height:n,x:0,y:0},f=pa("recharts-surface",s);return _e.createElement("svg",MI({},Kn(d,!0,"svg"),{className:f,width:r,height:n,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),_e.createElement("title",null,l),_e.createElement("desc",null,c),t)}var q_e=["children","className"];function LI(){return LI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LI.apply(this,arguments)}function z_e(e,t){if(e==null)return{};var r=U_e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function U_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Ta=_e.forwardRef(function(e,t){var r=e.children,n=e.className,o=z_e(e,q_e),s=pa("recharts-layer",n);return _e.createElement("g",LI({className:s},Kn(o,!0),{ref:t}),r)}),au=function(t,r){for(var n=arguments.length,o=new Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s]};function V_e(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),r=r>o?o:r,r<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(o);++n<o;)s[n]=e[n+t];return s}var W_e=V_e,H_e=W_e;function G_e(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:H_e(e,t,r)}var K_e=G_e,X_e="\\ud800-\\udfff",Y_e="\\u0300-\\u036f",J_e="\\ufe20-\\ufe2f",Q_e="\\u20d0-\\u20ff",Z_e=Y_e+J_e+Q_e,eNe="\\ufe0e\\ufe0f",tNe="\\u200d",rNe=RegExp("["+tNe+X_e+Z_e+eNe+"]");function nNe(e){return rNe.test(e)}var tY=nNe;function aNe(e){return e.split("")}var oNe=aNe,rY="\\ud800-\\udfff",sNe="\\u0300-\\u036f",iNe="\\ufe20-\\ufe2f",lNe="\\u20d0-\\u20ff",cNe=sNe+iNe+lNe,dNe="\\ufe0e\\ufe0f",uNe="["+rY+"]",FI="["+cNe+"]",$I="\\ud83c[\\udffb-\\udfff]",fNe="(?:"+FI+"|"+$I+")",nY="[^"+rY+"]",aY="(?:\\ud83c[\\udde6-\\uddff]){2}",oY="[\\ud800-\\udbff][\\udc00-\\udfff]",mNe="\\u200d",sY=fNe+"?",iY="["+dNe+"]?",hNe="(?:"+mNe+"(?:"+[nY,aY,oY].join("|")+")"+iY+sY+")*",pNe=iY+sY+hNe,gNe="(?:"+[nY+FI+"?",FI,aY,oY,uNe].join("|")+")",vNe=RegExp($I+"(?="+$I+")|"+gNe+pNe,"g");function xNe(e){return e.match(vNe)||[]}var yNe=xNe,bNe=oNe,wNe=tY,jNe=yNe;function _Ne(e){return wNe(e)?jNe(e):bNe(e)}var NNe=_Ne,SNe=K_e,CNe=tY,PNe=NNe,ANe=KX;function ENe(e){return function(t){t=ANe(t);var r=CNe(t)?PNe(t):void 0,n=r?r[0]:t.charAt(0),o=r?SNe(r,1).join(""):t.slice(1);return n[e]()+o}}var kNe=ENe,INe=kNe,ONe=INe("toUpperCase"),TNe=ONe;const RC=Ga(TNe);function Io(e){return function(){return e}}const lY=Math.cos,Q_=Math.sin,hu=Math.sqrt,Z_=Math.PI,LC=2*Z_,BI=Math.PI,qI=2*BI,lp=1e-6,DNe=qI-lp;function cY(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function MNe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return cY;const r=10**t;return function(n){this._+=n[0];for(let o=1,s=n.length;o<s;++o)this._+=Math.round(arguments[o]*r)/r+n[o]}}class RNe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?cY:MNe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,o){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+o}`}bezierCurveTo(t,r,n,o,s,i){this._append`C${+t},${+r},${+n},${+o},${this._x1=+s},${this._y1=+i}`}arcTo(t,r,n,o,s){if(t=+t,r=+r,n=+n,o=+o,s=+s,s<0)throw new Error(`negative radius: ${s}`);let i=this._x1,l=this._y1,c=n-t,d=o-r,u=i-t,f=l-r,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>lp)if(!(Math.abs(f*c-d*u)>lp)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-i,v=o-l,g=c*c+d*d,y=m*m+v*v,x=Math.sqrt(g),b=Math.sqrt(h),w=s*Math.tan((BI-Math.acos((g+h-y)/(2*x*b)))/2),j=w/b,_=w/x;Math.abs(j-1)>lp&&this._append`L${t+j*u},${r+j*f}`,this._append`A${s},${s},0,0,${+(f*m>u*v)},${this._x1=t+_*c},${this._y1=r+_*d}`}}arc(t,r,n,o,s,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(o),c=n*Math.sin(o),d=t+l,u=r+c,f=1^i,h=i?o-s:s-o;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>lp||Math.abs(this._y1-u)>lp)&&this._append`L${d},${u}`,n&&(h<0&&(h=h%qI+qI),h>DNe?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:h>lp&&this._append`A${n},${n},0,${+(h>=BI)},${f},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+o}h${-n}Z`}toString(){return this._}}function fD(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new RNe(t)}function mD(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dY(e){this._context=e}dY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function FC(e){return new dY(e)}function uY(e){return e[0]}function fY(e){return e[1]}function mY(e,t){var r=Io(!0),n=null,o=FC,s=null,i=fD(l);e=typeof e=="function"?e:e===void 0?uY:Io(e),t=typeof t=="function"?t:t===void 0?fY:Io(t);function l(c){var d,u=(c=mD(c)).length,f,h=!1,m;for(n==null&&(s=o(m=i())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(f,d,c),+t(f,d,c));if(m)return s=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Io(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Io(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Io(!!c),l):r},l.curve=function(c){return arguments.length?(o=c,n!=null&&(s=o(n)),l):o},l.context=function(c){return arguments.length?(c==null?n=s=null:s=o(n=c),l):n},l}function z2(e,t,r){var n=null,o=Io(!0),s=null,i=FC,l=null,c=fD(d);e=typeof e=="function"?e:e===void 0?uY:Io(+e),t=typeof t=="function"?t:Io(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?fY:Io(+r);function d(f){var h,m,v,g=(f=mD(f)).length,y,x=!1,b,w=new Array(g),j=new Array(g);for(s==null&&(l=i(b=c())),h=0;h<=g;++h){if(!(h<g&&o(y=f[h],h,f))===x)if(x=!x)m=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),v=h-1;v>=m;--v)l.point(w[v],j[v]);l.lineEnd(),l.areaEnd()}x&&(w[h]=+e(y,h,f),j[h]=+t(y,h,f),l.point(n?+n(y,h,f):w[h],r?+r(y,h,f):j[h]))}if(b)return l=null,b+""||null}function u(){return mY().defined(o).curve(i).context(s)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:Io(+f),n=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Io(+f),d):e},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Io(+f),d):n},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:Io(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Io(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Io(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(f){return arguments.length?(o=typeof f=="function"?f:Io(!!f),d):o},d.curve=function(f){return arguments.length?(i=f,s!=null&&(l=i(s)),d):i},d.context=function(f){return arguments.length?(f==null?s=l=null:l=i(s=f),d):s},d}class hY{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function LNe(e){return new hY(e,!0)}function FNe(e){return new hY(e,!1)}const hD={draw(e,t){const r=hu(t/Z_);e.moveTo(r,0),e.arc(0,0,r,0,LC)}},$Ne={draw(e,t){const r=hu(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},pY=hu(1/3),BNe=pY*2,qNe={draw(e,t){const r=hu(t/BNe),n=r*pY;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},zNe={draw(e,t){const r=hu(t),n=-r/2;e.rect(n,n,r,r)}},UNe=.8908130915292852,gY=Q_(Z_/10)/Q_(7*Z_/10),VNe=Q_(LC/10)*gY,WNe=-lY(LC/10)*gY,HNe={draw(e,t){const r=hu(t*UNe),n=VNe*r,o=WNe*r;e.moveTo(0,-r),e.lineTo(n,o);for(let s=1;s<5;++s){const i=LC*s/5,l=lY(i),c=Q_(i);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*o,c*n+l*o)}e.closePath()}},_A=hu(3),GNe={draw(e,t){const r=-hu(t/(_A*3));e.moveTo(0,r*2),e.lineTo(-_A*r,-r),e.lineTo(_A*r,-r),e.closePath()}},Kc=-.5,Xc=hu(3)/2,zI=1/hu(12),KNe=(zI/2+1)*3,XNe={draw(e,t){const r=hu(t/KNe),n=r/2,o=r*zI,s=n,i=r*zI+r,l=-s,c=i;e.moveTo(n,o),e.lineTo(s,i),e.lineTo(l,c),e.lineTo(Kc*n-Xc*o,Xc*n+Kc*o),e.lineTo(Kc*s-Xc*i,Xc*s+Kc*i),e.lineTo(Kc*l-Xc*c,Xc*l+Kc*c),e.lineTo(Kc*n+Xc*o,Kc*o-Xc*n),e.lineTo(Kc*s+Xc*i,Kc*i-Xc*s),e.lineTo(Kc*l+Xc*c,Kc*c-Xc*l),e.closePath()}};function YNe(e,t){let r=null,n=fD(o);e=typeof e=="function"?e:Io(e||hD),t=typeof t=="function"?t:Io(t===void 0?64:+t);function o(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return o.type=function(s){return arguments.length?(e=typeof s=="function"?s:Io(s),o):e},o.size=function(s){return arguments.length?(t=typeof s=="function"?s:Io(+s),o):t},o.context=function(s){return arguments.length?(r=s??null,o):r},o}function eN(){}function tN(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function vY(e){this._context=e}vY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:tN(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:tN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function JNe(e){return new vY(e)}function xY(e){this._context=e}xY.prototype={areaStart:eN,areaEnd:eN,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:tN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function QNe(e){return new xY(e)}function yY(e){this._context=e}yY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:tN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ZNe(e){return new yY(e)}function bY(e){this._context=e}bY.prototype={areaStart:eN,areaEnd:eN,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function eSe(e){return new bY(e)}function G6(e){return e<0?-1:1}function K6(e,t,r){var n=e._x1-e._x0,o=t-e._x1,s=(e._y1-e._y0)/(n||o<0&&-0),i=(r-e._y1)/(o||n<0&&-0),l=(s*o+i*n)/(n+o);return(G6(s)+G6(i))*Math.min(Math.abs(s),Math.abs(i),.5*Math.abs(l))||0}function X6(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function NA(e,t,r){var n=e._x0,o=e._y0,s=e._x1,i=e._y1,l=(s-n)/3;e._context.bezierCurveTo(n+l,o+l*t,s-l,i-l*r,s,i)}function rN(e){this._context=e}rN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:NA(this,this._t0,X6(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,NA(this,X6(this,r=K6(this,e,t)),r);break;default:NA(this,this._t0,r=K6(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function wY(e){this._context=new jY(e)}(wY.prototype=Object.create(rN.prototype)).point=function(e,t){rN.prototype.point.call(this,t,e)};function jY(e){this._context=e}jY.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,o,s){this._context.bezierCurveTo(t,e,n,r,s,o)}};function tSe(e){return new rN(e)}function rSe(e){return new wY(e)}function _Y(e){this._context=e}_Y.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=Y6(e),o=Y6(t),s=0,i=1;i<r;++s,++i)this._context.bezierCurveTo(n[0][s],o[0][s],n[1][s],o[1][s],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Y6(e){var t,r=e.length-1,n,o=new Array(r),s=new Array(r),i=new Array(r);for(o[0]=0,s[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)o[t]=1,s[t]=4,i[t]=4*e[t]+2*e[t+1];for(o[r-1]=2,s[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=o[t]/s[t-1],s[t]-=n,i[t]-=n*i[t-1];for(o[r-1]=i[r-1]/s[r-1],t=r-2;t>=0;--t)o[t]=(i[t]-o[t+1])/s[t];for(s[r-1]=(e[r]+o[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-o[t+1];return[o,s]}function nSe(e){return new _Y(e)}function $C(e,t){this._context=e,this._t=t}$C.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function aSe(e){return new $C(e,.5)}function oSe(e){return new $C(e,0)}function sSe(e){return new $C(e,1)}function wx(e,t){if((i=e.length)>1)for(var r=1,n,o,s=e[t[0]],i,l=s.length;r<i;++r)for(o=s,s=e[t[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(o[n][1])?o[n][0]:o[n][1]}function UI(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function iSe(e,t){return e[t]}function lSe(e){const t=[];return t.key=e,t}function cSe(){var e=Io([]),t=UI,r=wx,n=iSe;function o(s){var i=Array.from(e.apply(this,arguments),lSe),l,c=i.length,d=-1,u;for(const f of s)for(l=0,++d;l<c;++l)(i[l][d]=[0,+n(f,i[l].key,d,s)]).data=f;for(l=0,u=mD(t(i));l<c;++l)i[u[l]].index=l;return r(i,u),i}return o.keys=function(s){return arguments.length?(e=typeof s=="function"?s:Io(Array.from(s)),o):e},o.value=function(s){return arguments.length?(n=typeof s=="function"?s:Io(+s),o):n},o.order=function(s){return arguments.length?(t=s==null?UI:typeof s=="function"?s:Io(Array.from(s)),o):t},o.offset=function(s){return arguments.length?(r=s??wx,o):r},o}function dSe(e,t){if((n=e.length)>0){for(var r,n,o=0,s=e[0].length,i;o<s;++o){for(i=r=0;r<n;++r)i+=e[r][o][1]||0;if(i)for(r=0;r<n;++r)e[r][o][1]/=i}wx(e,t)}}function uSe(e,t){if((o=e.length)>0){for(var r=0,n=e[t[0]],o,s=n.length;r<s;++r){for(var i=0,l=0;i<o;++i)l+=e[i][r][1]||0;n[r][1]+=n[r][0]=-l/2}wx(e,t)}}function fSe(e,t){if(!(!((i=e.length)>0)||!((s=(o=e[t[0]]).length)>0))){for(var r=0,n=1,o,s,i;n<s;++n){for(var l=0,c=0,d=0;l<i;++l){for(var u=e[t[l]],f=u[n][1]||0,h=u[n-1][1]||0,m=(f-h)/2,v=0;v<l;++v){var g=e[t[v]],y=g[n][1]||0,x=g[n-1][1]||0;m+=y-x}c+=f,d+=m*f}o[n-1][1]+=o[n-1][0]=r,c&&(r-=d/c)}o[n-1][1]+=o[n-1][0]=r,wx(e,t)}}function Xb(e){"@babel/helpers - typeof";return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(e)}var mSe=["type","size","sizeType"];function VI(){return VI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VI.apply(this,arguments)}function J6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Q6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J6(Object(r),!0).forEach(function(n){hSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hSe(e,t,r){return t=pSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pSe(e){var t=gSe(e,"string");return Xb(t)=="symbol"?t:t+""}function gSe(e,t){if(Xb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vSe(e,t){if(e==null)return{};var r=xSe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var NY={symbolCircle:hD,symbolCross:$Ne,symbolDiamond:qNe,symbolSquare:zNe,symbolStar:HNe,symbolTriangle:GNe,symbolWye:XNe},ySe=Math.PI/180,bSe=function(t){var r="symbol".concat(RC(t));return NY[r]||hD},wSe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var o=18*ySe;return 1.25*t*t*(Math.tan(o)-Math.tan(o*2)*Math.pow(Math.tan(o),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},jSe=function(t,r){NY["symbol".concat(RC(t))]=r},pD=function(t){var r=t.type,n=r===void 0?"circle":r,o=t.size,s=o===void 0?64:o,i=t.sizeType,l=i===void 0?"area":i,c=vSe(t,mSe),d=Q6(Q6({},c),{},{type:n,size:s,sizeType:l}),u=function(){var y=bSe(n),x=YNe().type(y).size(wSe(s,l,n));return x()},f=d.className,h=d.cx,m=d.cy,v=Kn(d,!0);return h===+h&&m===+m&&s===+s?_e.createElement("path",VI({},v,{className:pa("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(m,")"),d:u()})):null};pD.registerSymbol=jSe;function jx(e){"@babel/helpers - typeof";return jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jx(e)}function WI(){return WI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WI.apply(this,arguments)}function Z6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _Se(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z6(Object(r),!0).forEach(function(n){Yb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function e8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CY(n.key),n)}}function SSe(e,t,r){return t&&e8(e.prototype,t),r&&e8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CSe(e,t,r){return t=nN(t),PSe(e,SY()?Reflect.construct(t,r||[],nN(e).constructor):t.apply(e,r))}function PSe(e,t){if(t&&(jx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ASe(e)}function ASe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SY=function(){return!!e})()}function nN(e){return nN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nN(e)}function ESe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HI(e,t)}function HI(e,t){return HI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HI(e,t)}function Yb(e,t,r){return t=CY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CY(e){var t=kSe(e,"string");return jx(t)=="symbol"?t:t+""}function kSe(e,t){if(jx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yc=32,gD=function(e){function t(){return NSe(this,t),CSe(this,t,arguments)}return ESe(t,e),SSe(t,[{key:"renderIcon",value:function(n){var o=this.props.inactiveColor,s=Yc/2,i=Yc/6,l=Yc/3,c=n.inactive?o:n.color;if(n.type==="plainline")return _e.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:s,x2:Yc,y2:s,className:"recharts-legend-icon"});if(n.type==="line")return _e.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(s,"h").concat(l,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*l,",").concat(s,`
            H`).concat(Yc,"M").concat(2*l,",").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(l,",").concat(s),className:"recharts-legend-icon"});if(n.type==="rect")return _e.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Yc/8,"h").concat(Yc,"v").concat(Yc*3/4,"h").concat(-Yc,"z"),className:"recharts-legend-icon"});if(_e.isValidElement(n.legendIcon)){var d=_Se({},n);return delete d.legendIcon,_e.cloneElement(n.legendIcon,d)}return _e.createElement(pD,{fill:c,cx:s,cy:s,size:Yc,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,o=this.props,s=o.payload,i=o.iconSize,l=o.layout,c=o.formatter,d=o.inactiveColor,u={x:0,y:0,width:Yc,height:Yc},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return s.map(function(m,v){var g=m.formatter||c,y=pa(Yb(Yb({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",m.inactive));if(m.type==="none")return null;var x=na(m.value)?null:m.value;au(!na(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=m.inactive?d:m.color;return _e.createElement("li",WI({className:y,style:f,key:"legend-item-".concat(v)},ng(n.props,m,v)),_e.createElement(RI,{width:i,height:i,viewBox:u,style:h},n.renderIcon(m)),_e.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},g?g(x,m,v):x))})}},{key:"render",value:function(){var n=this.props,o=n.payload,s=n.layout,i=n.align;if(!o||!o.length)return null;var l={padding:0,margin:0,textAlign:s==="horizontal"?i:"left"};return _e.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(p.PureComponent);Yb(gD,"displayName","Legend");Yb(gD,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var ISe=_C;function OSe(){this.__data__=new ISe,this.size=0}var TSe=OSe;function DSe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var MSe=DSe;function RSe(e){return this.__data__.get(e)}var LSe=RSe;function FSe(e){return this.__data__.has(e)}var $Se=FSe,BSe=_C,qSe=nD,zSe=aD,USe=200;function VSe(e,t){var r=this.__data__;if(r instanceof BSe){var n=r.__data__;if(!qSe||n.length<USe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new zSe(n)}return r.set(e,t),this.size=r.size,this}var WSe=VSe,HSe=_C,GSe=TSe,KSe=MSe,XSe=LSe,YSe=$Se,JSe=WSe;function y0(e){var t=this.__data__=new HSe(e);this.size=t.size}y0.prototype.clear=GSe;y0.prototype.delete=KSe;y0.prototype.get=XSe;y0.prototype.has=YSe;y0.prototype.set=JSe;var PY=y0,QSe="__lodash_hash_undefined__";function ZSe(e){return this.__data__.set(e,QSe),this}var eCe=ZSe;function tCe(e){return this.__data__.has(e)}var rCe=tCe,nCe=aD,aCe=eCe,oCe=rCe;function aN(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new nCe;++t<r;)this.add(e[t])}aN.prototype.add=aN.prototype.push=aCe;aN.prototype.has=oCe;var AY=aN;function sCe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var EY=sCe;function iCe(e,t){return e.has(t)}var kY=iCe,lCe=AY,cCe=EY,dCe=kY,uCe=1,fCe=2;function mCe(e,t,r,n,o,s){var i=r&uCe,l=e.length,c=t.length;if(l!=c&&!(i&&c>l))return!1;var d=s.get(e),u=s.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,m=r&fCe?new lCe:void 0;for(s.set(e,t),s.set(t,e);++f<l;){var v=e[f],g=t[f];if(n)var y=i?n(g,v,f,t,e,s):n(v,g,f,e,t,s);if(y!==void 0){if(y)continue;h=!1;break}if(m){if(!cCe(t,function(x,b){if(!dCe(m,b)&&(v===x||o(v,x,r,n,s)))return m.push(b)})){h=!1;break}}else if(!(v===g||o(v,g,r,n,s))){h=!1;break}}return s.delete(e),s.delete(t),h}var IY=mCe,hCe=Qu,pCe=hCe.Uint8Array,gCe=pCe;function vCe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,o){r[++t]=[o,n]}),r}var xCe=vCe;function yCe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var vD=yCe,t8=f1,r8=gCe,bCe=rD,wCe=IY,jCe=xCe,_Ce=vD,NCe=1,SCe=2,CCe="[object Boolean]",PCe="[object Date]",ACe="[object Error]",ECe="[object Map]",kCe="[object Number]",ICe="[object RegExp]",OCe="[object Set]",TCe="[object String]",DCe="[object Symbol]",MCe="[object ArrayBuffer]",RCe="[object DataView]",n8=t8?t8.prototype:void 0,SA=n8?n8.valueOf:void 0;function LCe(e,t,r,n,o,s,i){switch(r){case RCe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case MCe:return!(e.byteLength!=t.byteLength||!s(new r8(e),new r8(t)));case CCe:case PCe:case kCe:return bCe(+e,+t);case ACe:return e.name==t.name&&e.message==t.message;case ICe:case TCe:return e==t+"";case ECe:var l=jCe;case OCe:var c=n&NCe;if(l||(l=_Ce),e.size!=t.size&&!c)return!1;var d=i.get(e);if(d)return d==t;n|=SCe,i.set(e,t);var u=wCe(l(e),l(t),n,o,s,i);return i.delete(e),u;case DCe:if(SA)return SA.call(e)==SA.call(t)}return!1}var FCe=LCe;function $Ce(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var OY=$Ce,BCe=OY,qCe=Jl;function zCe(e,t,r){var n=t(e);return qCe(e)?n:BCe(n,r(e))}var UCe=zCe;function VCe(e,t){for(var r=-1,n=e==null?0:e.length,o=0,s=[];++r<n;){var i=e[r];t(i,r,e)&&(s[o++]=i)}return s}var WCe=VCe;function HCe(){return[]}var GCe=HCe,KCe=WCe,XCe=GCe,YCe=Object.prototype,JCe=YCe.propertyIsEnumerable,a8=Object.getOwnPropertySymbols,QCe=a8?function(e){return e==null?[]:(e=Object(e),KCe(a8(e),function(t){return JCe.call(e,t)}))}:XCe,ZCe=QCe;function e5e(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var t5e=e5e,r5e=tm,n5e=rm,a5e="[object Arguments]";function o5e(e){return n5e(e)&&r5e(e)==a5e}var s5e=o5e,o8=s5e,i5e=rm,TY=Object.prototype,l5e=TY.hasOwnProperty,c5e=TY.propertyIsEnumerable,d5e=o8(function(){return arguments}())?o8:function(e){return i5e(e)&&l5e.call(e,"callee")&&!c5e.call(e,"callee")},xD=d5e,oN={exports:{}};function u5e(){return!1}var f5e=u5e;oN.exports;(function(e,t){var r=Qu,n=f5e,o=t&&!t.nodeType&&t,s=o&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===o,l=i?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(oN,oN.exports);var DY=oN.exports,m5e=9007199254740991,h5e=/^(?:0|[1-9]\d*)$/;function p5e(e,t){var r=typeof e;return t=t??m5e,!!t&&(r=="number"||r!="symbol"&&h5e.test(e))&&e>-1&&e%1==0&&e<t}var yD=p5e,g5e=9007199254740991;function v5e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=g5e}var bD=v5e,x5e=tm,y5e=bD,b5e=rm,w5e="[object Arguments]",j5e="[object Array]",_5e="[object Boolean]",N5e="[object Date]",S5e="[object Error]",C5e="[object Function]",P5e="[object Map]",A5e="[object Number]",E5e="[object Object]",k5e="[object RegExp]",I5e="[object Set]",O5e="[object String]",T5e="[object WeakMap]",D5e="[object ArrayBuffer]",M5e="[object DataView]",R5e="[object Float32Array]",L5e="[object Float64Array]",F5e="[object Int8Array]",$5e="[object Int16Array]",B5e="[object Int32Array]",q5e="[object Uint8Array]",z5e="[object Uint8ClampedArray]",U5e="[object Uint16Array]",V5e="[object Uint32Array]",qo={};qo[R5e]=qo[L5e]=qo[F5e]=qo[$5e]=qo[B5e]=qo[q5e]=qo[z5e]=qo[U5e]=qo[V5e]=!0;qo[w5e]=qo[j5e]=qo[D5e]=qo[_5e]=qo[M5e]=qo[N5e]=qo[S5e]=qo[C5e]=qo[P5e]=qo[A5e]=qo[E5e]=qo[k5e]=qo[I5e]=qo[O5e]=qo[T5e]=!1;function W5e(e){return b5e(e)&&y5e(e.length)&&!!qo[x5e(e)]}var H5e=W5e;function G5e(e){return function(t){return e(t)}}var MY=G5e,sN={exports:{}};sN.exports;(function(e,t){var r=zX,n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,s=o&&o.exports===n,i=s&&r.process,l=function(){try{var c=o&&o.require&&o.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=l})(sN,sN.exports);var K5e=sN.exports,X5e=H5e,Y5e=MY,s8=K5e,i8=s8&&s8.isTypedArray,J5e=i8?Y5e(i8):X5e,RY=J5e,Q5e=t5e,Z5e=xD,ePe=Jl,tPe=DY,rPe=yD,nPe=RY,aPe=Object.prototype,oPe=aPe.hasOwnProperty;function sPe(e,t){var r=ePe(e),n=!r&&Z5e(e),o=!r&&!n&&tPe(e),s=!r&&!n&&!o&&nPe(e),i=r||n||o||s,l=i?Q5e(e.length,String):[],c=l.length;for(var d in e)(t||oPe.call(e,d))&&!(i&&(d=="length"||o&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||rPe(d,c)))&&l.push(d);return l}var iPe=sPe,lPe=Object.prototype;function cPe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||lPe;return e===r}var dPe=cPe;function uPe(e,t){return function(r){return e(t(r))}}var LY=uPe,fPe=LY,mPe=fPe(Object.keys,Object),hPe=mPe,pPe=dPe,gPe=hPe,vPe=Object.prototype,xPe=vPe.hasOwnProperty;function yPe(e){if(!pPe(e))return gPe(e);var t=[];for(var r in Object(e))xPe.call(e,r)&&r!="constructor"&&t.push(r);return t}var bPe=yPe,wPe=tD,jPe=bD;function _Pe(e){return e!=null&&jPe(e.length)&&!wPe(e)}var m1=_Pe,NPe=iPe,SPe=bPe,CPe=m1;function PPe(e){return CPe(e)?NPe(e):SPe(e)}var BC=PPe,APe=UCe,EPe=ZCe,kPe=BC;function IPe(e){return APe(e,kPe,EPe)}var OPe=IPe,l8=OPe,TPe=1,DPe=Object.prototype,MPe=DPe.hasOwnProperty;function RPe(e,t,r,n,o,s){var i=r&TPe,l=l8(e),c=l.length,d=l8(t),u=d.length;if(c!=u&&!i)return!1;for(var f=c;f--;){var h=l[f];if(!(i?h in t:MPe.call(t,h)))return!1}var m=s.get(e),v=s.get(t);if(m&&v)return m==t&&v==e;var g=!0;s.set(e,t),s.set(t,e);for(var y=i;++f<c;){h=l[f];var x=e[h],b=t[h];if(n)var w=i?n(b,x,h,t,e,s):n(x,b,h,e,t,s);if(!(w===void 0?x===b||o(x,b,r,n,s):w)){g=!1;break}y||(y=h=="constructor")}if(g&&!y){var j=e.constructor,_=t.constructor;j!=_&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof _=="function"&&_ instanceof _)&&(g=!1)}return s.delete(e),s.delete(t),g}var LPe=RPe,FPe=_g,$Pe=Qu,BPe=FPe($Pe,"DataView"),qPe=BPe,zPe=_g,UPe=Qu,VPe=zPe(UPe,"Promise"),WPe=VPe,HPe=_g,GPe=Qu,KPe=HPe(GPe,"Set"),FY=KPe,XPe=_g,YPe=Qu,JPe=XPe(YPe,"WeakMap"),QPe=JPe,GI=qPe,KI=nD,XI=WPe,YI=FY,JI=QPe,$Y=tm,b0=VX,c8="[object Map]",ZPe="[object Object]",d8="[object Promise]",u8="[object Set]",f8="[object WeakMap]",m8="[object DataView]",eAe=b0(GI),tAe=b0(KI),rAe=b0(XI),nAe=b0(YI),aAe=b0(JI),cp=$Y;(GI&&cp(new GI(new ArrayBuffer(1)))!=m8||KI&&cp(new KI)!=c8||XI&&cp(XI.resolve())!=d8||YI&&cp(new YI)!=u8||JI&&cp(new JI)!=f8)&&(cp=function(e){var t=$Y(e),r=t==ZPe?e.constructor:void 0,n=r?b0(r):"";if(n)switch(n){case eAe:return m8;case tAe:return c8;case rAe:return d8;case nAe:return u8;case aAe:return f8}return t});var oAe=cp,CA=PY,sAe=IY,iAe=FCe,lAe=LPe,h8=oAe,p8=Jl,g8=DY,cAe=RY,dAe=1,v8="[object Arguments]",x8="[object Array]",U2="[object Object]",uAe=Object.prototype,y8=uAe.hasOwnProperty;function fAe(e,t,r,n,o,s){var i=p8(e),l=p8(t),c=i?x8:h8(e),d=l?x8:h8(t);c=c==v8?U2:c,d=d==v8?U2:d;var u=c==U2,f=d==U2,h=c==d;if(h&&g8(e)){if(!g8(t))return!1;i=!0,u=!1}if(h&&!u)return s||(s=new CA),i||cAe(e)?sAe(e,t,r,n,o,s):iAe(e,t,c,r,n,o,s);if(!(r&dAe)){var m=u&&y8.call(e,"__wrapped__"),v=f&&y8.call(t,"__wrapped__");if(m||v){var g=m?e.value():e,y=v?t.value():t;return s||(s=new CA),o(g,y,r,n,s)}}return h?(s||(s=new CA),lAe(e,t,r,n,o,s)):!1}var mAe=fAe,hAe=mAe,b8=rm;function BY(e,t,r,n,o){return e===t?!0:e==null||t==null||!b8(e)&&!b8(t)?e!==e&&t!==t:hAe(e,t,r,n,BY,o)}var wD=BY,pAe=PY,gAe=wD,vAe=1,xAe=2;function yAe(e,t,r,n){var o=r.length,s=o,i=!n;if(e==null)return!s;for(e=Object(e);o--;){var l=r[o];if(i&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<s;){l=r[o];var c=l[0],d=e[c],u=l[1];if(i&&l[2]){if(d===void 0&&!(c in e))return!1}else{var f=new pAe;if(n)var h=n(d,u,c,e,t,f);if(!(h===void 0?gAe(u,d,vAe|xAe,n,f):h))return!1}}return!0}var bAe=yAe,wAe=Rh;function jAe(e){return e===e&&!wAe(e)}var qY=jAe,_Ae=qY,NAe=BC;function SAe(e){for(var t=NAe(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,_Ae(o)]}return t}var CAe=SAe;function PAe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var zY=PAe,AAe=bAe,EAe=CAe,kAe=zY;function IAe(e){var t=EAe(e);return t.length==1&&t[0][2]?kAe(t[0][0],t[0][1]):function(r){return r===e||AAe(r,e,t)}}var OAe=IAe;function TAe(e,t){return e!=null&&t in Object(e)}var DAe=TAe,MAe=XX,RAe=xD,LAe=Jl,FAe=yD,$Ae=bD,BAe=SC;function qAe(e,t,r){t=MAe(t,e);for(var n=-1,o=t.length,s=!1;++n<o;){var i=BAe(t[n]);if(!(s=e!=null&&r(e,i)))break;e=e[i]}return s||++n!=o?s:(o=e==null?0:e.length,!!o&&$Ae(o)&&FAe(i,o)&&(LAe(e)||RAe(e)))}var zAe=qAe,UAe=DAe,VAe=zAe;function WAe(e,t){return e!=null&&VAe(e,t,UAe)}var HAe=WAe,GAe=wD,KAe=YX,XAe=HAe,YAe=eD,JAe=qY,QAe=zY,ZAe=SC,eEe=1,tEe=2;function rEe(e,t){return YAe(e)&&JAe(t)?QAe(ZAe(e),t):function(r){var n=KAe(r,e);return n===void 0&&n===t?XAe(r,e):GAe(t,n,eEe|tEe)}}var nEe=rEe;function aEe(e){return e}var w0=aEe;function oEe(e){return function(t){return t?.[e]}}var sEe=oEe,iEe=iD;function lEe(e){return function(t){return iEe(t,e)}}var cEe=lEe,dEe=sEe,uEe=cEe,fEe=eD,mEe=SC;function hEe(e){return fEe(e)?dEe(mEe(e)):uEe(e)}var pEe=hEe,gEe=OAe,vEe=nEe,xEe=w0,yEe=Jl,bEe=pEe;function wEe(e){return typeof e=="function"?e:e==null?xEe:typeof e=="object"?yEe(e)?vEe(e[0],e[1]):gEe(e):bEe(e)}var Zu=wEe;function jEe(e,t,r,n){for(var o=e.length,s=r+(n?1:-1);n?s--:++s<o;)if(t(e[s],s,e))return s;return-1}var UY=jEe;function _Ee(e){return e!==e}var NEe=_Ee;function SEe(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}var CEe=SEe,PEe=UY,AEe=NEe,EEe=CEe;function kEe(e,t,r){return t===t?EEe(e,t,r):PEe(e,AEe,r)}var IEe=kEe,OEe=IEe;function TEe(e,t){var r=e==null?0:e.length;return!!r&&OEe(e,t,0)>-1}var DEe=TEe;function MEe(e,t,r){for(var n=-1,o=e==null?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1}var REe=MEe;function LEe(){}var FEe=LEe,PA=FY,$Ee=FEe,BEe=vD,qEe=1/0,zEe=PA&&1/BEe(new PA([,-0]))[1]==qEe?function(e){return new PA(e)}:$Ee,UEe=zEe,VEe=AY,WEe=DEe,HEe=REe,GEe=kY,KEe=UEe,XEe=vD,YEe=200;function JEe(e,t,r){var n=-1,o=WEe,s=e.length,i=!0,l=[],c=l;if(r)i=!1,o=HEe;else if(s>=YEe){var d=t?null:KEe(e);if(d)return XEe(d);i=!1,o=GEe,c=new VEe}else c=t?[]:l;e:for(;++n<s;){var u=e[n],f=t?t(u):u;if(u=r||u!==0?u:0,i&&f===f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),l.push(u)}else o(c,f,r)||(c!==l&&c.push(f),l.push(u))}return l}var QEe=JEe,ZEe=Zu,eke=QEe;function tke(e,t){return e&&e.length?eke(e,ZEe(t)):[]}var rke=tke;const w8=Ga(rke);function VY(e,t,r){return t===!0?w8(e,r):na(t)?w8(e,t):e}function _x(e){"@babel/helpers - typeof";return _x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_x(e)}var nke=["ref"];function j8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function df(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j8(Object(r),!0).forEach(function(n){qC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ake(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HY(n.key),n)}}function oke(e,t,r){return t&&_8(e.prototype,t),r&&_8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ske(e,t,r){return t=iN(t),ike(e,WY()?Reflect.construct(t,r||[],iN(e).constructor):t.apply(e,r))}function ike(e,t){if(t&&(_x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lke(e)}function lke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WY=function(){return!!e})()}function iN(e){return iN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iN(e)}function cke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QI(e,t)}function QI(e,t){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QI(e,t)}function qC(e,t,r){return t=HY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HY(e){var t=dke(e,"string");return _x(t)=="symbol"?t:t+""}function dke(e,t){if(_x(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_x(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uke(e,t){if(e==null)return{};var r=fke(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function fke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function mke(e){return e.value}function hke(e,t){if(_e.isValidElement(e))return _e.cloneElement(e,t);if(typeof e=="function")return _e.createElement(e,t);t.ref;var r=uke(t,nke);return _e.createElement(gD,r)}var N8=1,Lp=function(e){function t(){var r;ake(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r=ske(this,t,[].concat(o)),qC(r,"lastBoundingBox",{width:-1,height:-1}),r}return cke(t,e),oke(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,o=this.getBBox();o?(Math.abs(o.width-this.lastBoundingBox.width)>N8||Math.abs(o.height-this.lastBoundingBox.height)>N8)&&(this.lastBoundingBox.width=o.width,this.lastBoundingBox.height=o.height,n&&n(o)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?df({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var o=this.props,s=o.layout,i=o.align,l=o.verticalAlign,c=o.margin,d=o.chartWidth,u=o.chartHeight,f,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(i==="center"&&s==="vertical"){var m=this.getBBoxSnapshot();f={left:((d||0)-m.width)/2}}else f=i==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var v=this.getBBoxSnapshot();h={top:((u||0)-v.height)/2}}else h=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return df(df({},f),h)}},{key:"render",value:function(){var n=this,o=this.props,s=o.content,i=o.width,l=o.height,c=o.wrapperStyle,d=o.payloadUniqBy,u=o.payload,f=df(df({position:"absolute",width:i||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return _e.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(m){n.wrapperNode=m}},hke(s,df(df({},this.props),{},{payload:VY(u,d,mke)})))}}],[{key:"getWithHeight",value:function(n,o){var s=df(df({},this.defaultProps),n.props),i=s.layout;return i==="vertical"&&en(n.props.height)?{height:n.props.height}:i==="horizontal"?{width:n.props.width||o}:null}}])}(p.PureComponent);qC(Lp,"displayName","Legend");qC(Lp,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var S8=f1,pke=xD,gke=Jl,C8=S8?S8.isConcatSpreadable:void 0;function vke(e){return gke(e)||pke(e)||!!(C8&&e&&e[C8])}var xke=vke,yke=OY,bke=xke;function GY(e,t,r,n,o){var s=-1,i=e.length;for(r||(r=bke),o||(o=[]);++s<i;){var l=e[s];t>0&&r(l)?t>1?GY(l,t-1,r,n,o):yke(o,l):n||(o[o.length]=l)}return o}var KY=GY;function wke(e){return function(t,r,n){for(var o=-1,s=Object(t),i=n(t),l=i.length;l--;){var c=i[e?l:++o];if(r(s[c],c,s)===!1)break}return t}}var jke=wke,_ke=jke,Nke=_ke(),Ske=Nke,Cke=Ske,Pke=BC;function Ake(e,t){return e&&Cke(e,t,Pke)}var XY=Ake,Eke=m1;function kke(e,t){return function(r,n){if(r==null)return r;if(!Eke(r))return e(r,n);for(var o=r.length,s=t?o:-1,i=Object(r);(t?s--:++s<o)&&n(i[s],s,i)!==!1;);return r}}var Ike=kke,Oke=XY,Tke=Ike,Dke=Tke(Oke),jD=Dke,Mke=jD,Rke=m1;function Lke(e,t){var r=-1,n=Rke(e)?Array(e.length):[];return Mke(e,function(o,s,i){n[++r]=t(o,s,i)}),n}var YY=Lke;function Fke(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var $ke=Fke,P8=m0;function Bke(e,t){if(e!==t){var r=e!==void 0,n=e===null,o=e===e,s=P8(e),i=t!==void 0,l=t===null,c=t===t,d=P8(t);if(!l&&!d&&!s&&e>t||s&&i&&c&&!l&&!d||n&&i&&c||!r&&c||!o)return 1;if(!n&&!s&&!d&&e<t||d&&r&&o&&!n&&!s||l&&r&&o||!i&&o||!c)return-1}return 0}var qke=Bke,zke=qke;function Uke(e,t,r){for(var n=-1,o=e.criteria,s=t.criteria,i=o.length,l=r.length;++n<i;){var c=zke(o[n],s[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return e.index-t.index}var Vke=Uke,AA=sD,Wke=iD,Hke=Zu,Gke=YY,Kke=$ke,Xke=MY,Yke=Vke,Jke=w0,Qke=Jl;function Zke(e,t,r){t.length?t=AA(t,function(s){return Qke(s)?function(i){return Wke(i,s.length===1?s[0]:s)}:s}):t=[Jke];var n=-1;t=AA(t,Xke(Hke));var o=Gke(e,function(s,i,l){var c=AA(t,function(d){return d(s)});return{criteria:c,index:++n,value:s}});return Kke(o,function(s,i){return Yke(s,i,r)})}var eIe=Zke;function tIe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var rIe=tIe,nIe=rIe,A8=Math.max;function aIe(e,t,r){return t=A8(t===void 0?e.length-1:t,0),function(){for(var n=arguments,o=-1,s=A8(n.length-t,0),i=Array(s);++o<s;)i[o]=n[t+o];o=-1;for(var l=Array(t+1);++o<t;)l[o]=n[o];return l[t]=r(i),nIe(e,this,l)}}var oIe=aIe;function sIe(e){return function(){return e}}var iIe=sIe,lIe=_g,cIe=function(){try{var e=lIe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),JY=cIe,dIe=iIe,E8=JY,uIe=w0,fIe=E8?function(e,t){return E8(e,"toString",{configurable:!0,enumerable:!1,value:dIe(t),writable:!0})}:uIe,mIe=fIe,hIe=800,pIe=16,gIe=Date.now;function vIe(e){var t=0,r=0;return function(){var n=gIe(),o=pIe-(n-r);if(r=n,o>0){if(++t>=hIe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var xIe=vIe,yIe=mIe,bIe=xIe,wIe=bIe(yIe),jIe=wIe,_Ie=w0,NIe=oIe,SIe=jIe;function CIe(e,t){return SIe(NIe(e,t,_Ie),e+"")}var PIe=CIe,AIe=rD,EIe=m1,kIe=yD,IIe=Rh;function OIe(e,t,r){if(!IIe(r))return!1;var n=typeof t;return(n=="number"?EIe(r)&&kIe(t,r.length):n=="string"&&t in r)?AIe(r[t],e):!1}var zC=OIe,TIe=KY,DIe=eIe,MIe=PIe,k8=zC,RIe=MIe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&k8(e,t[0],t[1])?t=[]:r>2&&k8(t[0],t[1],t[2])&&(t=[t[0]]),DIe(e,TIe(t,1),[])}),LIe=RIe;const _D=Ga(LIe);function Jb(e){"@babel/helpers - typeof";return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jb(e)}function ZI(){return ZI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ZI.apply(this,arguments)}function FIe(e,t){return zIe(e)||qIe(e,t)||BIe(e,t)||$Ie()}function $Ie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BIe(e,t){if(e){if(typeof e=="string")return I8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I8(e,t)}}function I8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function zIe(e){if(Array.isArray(e))return e}function O8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function EA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O8(Object(r),!0).forEach(function(n){UIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UIe(e,t,r){return t=VIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VIe(e){var t=WIe(e,"string");return Jb(t)=="symbol"?t:t+""}function WIe(e,t){if(Jb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HIe(e){return Array.isArray(e)&&Js(e[0])&&Js(e[1])?e.join(" ~ "):e}var GIe=function(t){var r=t.separator,n=r===void 0?" : ":r,o=t.contentStyle,s=o===void 0?{}:o,i=t.itemStyle,l=i===void 0?{}:i,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,f=t.formatter,h=t.itemSorter,m=t.wrapperClassName,v=t.labelClassName,g=t.label,y=t.labelFormatter,x=t.accessibilityLayer,b=x===void 0?!1:x,w=function(){if(u&&u.length){var I={padding:0,margin:0},R=(h?_D(u,h):u).map(function(D,U){if(D.type==="none")return null;var z=EA({display:"block",paddingTop:4,paddingBottom:4,color:D.color||"#000"},l),H=D.formatter||f||HIe,q=D.value,Q=D.name,pe=q,be=Q;if(H&&pe!=null&&be!=null){var V=H(q,Q,D,U,u);if(Array.isArray(V)){var B=FIe(V,2);pe=B[0],be=B[1]}else pe=V}return _e.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(U),style:z},Js(be)?_e.createElement("span",{className:"recharts-tooltip-item-name"},be):null,Js(be)?_e.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,_e.createElement("span",{className:"recharts-tooltip-item-value"},pe),_e.createElement("span",{className:"recharts-tooltip-item-unit"},D.unit||""))});return _e.createElement("ul",{className:"recharts-tooltip-item-list",style:I},R)}return null},j=EA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},s),_=EA({margin:0},d),C=!ua(g),E=C?g:"",A=pa("recharts-default-tooltip",m),P=pa("recharts-tooltip-label",v);C&&y&&u!==void 0&&u!==null&&(E=y(g,u));var F=b?{role:"status","aria-live":"assertive"}:{};return _e.createElement("div",ZI({className:A,style:j},F),_e.createElement("p",{className:P,style:_},_e.isValidElement(E)?E:"".concat(E)),w())};function Qb(e){"@babel/helpers - typeof";return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(e)}function V2(e,t,r){return t=KIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KIe(e){var t=XIe(e,"string");return Qb(t)=="symbol"?t:t+""}function XIe(e,t){if(Qb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ny="recharts-tooltip-wrapper",YIe={visibility:"hidden"};function JIe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return pa(ny,V2(V2(V2(V2({},"".concat(ny,"-right"),en(r)&&t&&en(t.x)&&r>=t.x),"".concat(ny,"-left"),en(r)&&t&&en(t.x)&&r<t.x),"".concat(ny,"-bottom"),en(n)&&t&&en(t.y)&&n>=t.y),"".concat(ny,"-top"),en(n)&&t&&en(t.y)&&n<t.y))}function T8(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,o=e.offsetTopLeft,s=e.position,i=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(s&&en(s[n]))return s[n];var u=r[n]-l-o,f=r[n]+o;if(t[n])return i[n]?u:f;if(i[n]){var h=u,m=c[n];return h<m?Math.max(f,c[n]):Math.max(u,c[n])}var v=f+l,g=c[n]+d;return v>g?Math.max(u,c[n]):Math.max(f,c[n])}function QIe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function ZIe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,o=e.position,s=e.reverseDirection,i=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,u,f;return i.height>0&&i.width>0&&r?(u=T8({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:o,reverseDirection:s,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),f=T8({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:o,reverseDirection:s,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),d=QIe({translateX:u,translateY:f,useTranslate3d:l})):d=YIe,{cssProperties:d,cssClasses:JIe({translateX:u,translateY:f,coordinate:r})}}function Nx(e){"@babel/helpers - typeof";return Nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nx(e)}function D8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function M8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D8(Object(r),!0).forEach(function(n){tO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZY(n.key),n)}}function tOe(e,t,r){return t&&R8(e.prototype,t),r&&R8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rOe(e,t,r){return t=lN(t),nOe(e,QY()?Reflect.construct(t,r||[],lN(e).constructor):t.apply(e,r))}function nOe(e,t){if(t&&(Nx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aOe(e)}function aOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QY=function(){return!!e})()}function lN(e){return lN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lN(e)}function oOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eO(e,t)}function eO(e,t){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eO(e,t)}function tO(e,t,r){return t=ZY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZY(e){var t=sOe(e,"string");return Nx(t)=="symbol"?t:t+""}function sOe(e,t){if(Nx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L8=1,iOe=function(e){function t(){var r;eOe(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r=rOe(this,t,[].concat(o)),tO(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),tO(r,"handleKeyDown",function(i){if(i.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return oOe(t,e),tOe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>L8||Math.abs(n.height-this.state.lastBoundingBox.height)>L8)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,o;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,o=this.props,s=o.active,i=o.allowEscapeViewBox,l=o.animationDuration,c=o.animationEasing,d=o.children,u=o.coordinate,f=o.hasPayload,h=o.isAnimationActive,m=o.offset,v=o.position,g=o.reverseDirection,y=o.useTranslate3d,x=o.viewBox,b=o.wrapperStyle,w=ZIe({allowEscapeViewBox:i,coordinate:u,offsetTopLeft:m,position:v,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:x}),j=w.cssClasses,_=w.cssProperties,C=M8(M8({transition:h&&s?"transform ".concat(l,"ms ").concat(c):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&f?"visible":"hidden",position:"absolute",top:0,left:0},b);return _e.createElement("div",{tabIndex:-1,className:j,style:C,ref:function(A){n.wrapperNode=A}},d)}}])}(p.PureComponent),lOe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},ou={isSsr:lOe(),get:function(t){return ou[t]},set:function(t,r){if(typeof t=="string")ou[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(o){ou[o]=t[o]})}}};function Sx(e){"@babel/helpers - typeof";return Sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sx(e)}function F8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F8(Object(r),!0).forEach(function(n){ND(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tJ(n.key),n)}}function dOe(e,t,r){return t&&B8(e.prototype,t),r&&B8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uOe(e,t,r){return t=cN(t),fOe(e,eJ()?Reflect.construct(t,r||[],cN(e).constructor):t.apply(e,r))}function fOe(e,t){if(t&&(Sx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mOe(e)}function mOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eJ=function(){return!!e})()}function cN(e){return cN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cN(e)}function hOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rO(e,t)}function rO(e,t){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rO(e,t)}function ND(e,t,r){return t=tJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tJ(e){var t=pOe(e,"string");return Sx(t)=="symbol"?t:t+""}function pOe(e,t){if(Sx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gOe(e){return e.dataKey}function vOe(e,t){return _e.isValidElement(e)?_e.cloneElement(e,t):typeof e=="function"?_e.createElement(e,t):_e.createElement(GIe,t)}var vc=function(e){function t(){return cOe(this,t),uOe(this,t,arguments)}return hOe(t,e),dOe(t,[{key:"render",value:function(){var n=this,o=this.props,s=o.active,i=o.allowEscapeViewBox,l=o.animationDuration,c=o.animationEasing,d=o.content,u=o.coordinate,f=o.filterNull,h=o.isAnimationActive,m=o.offset,v=o.payload,g=o.payloadUniqBy,y=o.position,x=o.reverseDirection,b=o.useTranslate3d,w=o.viewBox,j=o.wrapperStyle,_=v??[];f&&_.length&&(_=VY(v.filter(function(E){return E.value!=null&&(E.hide!==!0||n.props.includeHidden)}),g,gOe));var C=_.length>0;return _e.createElement(iOe,{allowEscapeViewBox:i,animationDuration:l,animationEasing:c,isAnimationActive:h,active:s,coordinate:u,hasPayload:C,offset:m,position:y,reverseDirection:x,useTranslate3d:b,viewBox:w,wrapperStyle:j},vOe(d,$8($8({},this.props),{},{payload:_})))}}])}(p.PureComponent);ND(vc,"displayName","Tooltip");ND(vc,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!ou.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var xOe=Qu,yOe=function(){return xOe.Date.now()},bOe=yOe,wOe=/\s/;function jOe(e){for(var t=e.length;t--&&wOe.test(e.charAt(t)););return t}var _Oe=jOe,NOe=_Oe,SOe=/^\s+/;function COe(e){return e&&e.slice(0,NOe(e)+1).replace(SOe,"")}var POe=COe,AOe=POe,q8=Rh,EOe=m0,z8=0/0,kOe=/^[-+]0x[0-9a-f]+$/i,IOe=/^0b[01]+$/i,OOe=/^0o[0-7]+$/i,TOe=parseInt;function DOe(e){if(typeof e=="number")return e;if(EOe(e))return z8;if(q8(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=q8(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=AOe(e);var r=IOe.test(e);return r||OOe.test(e)?TOe(e.slice(2),r?2:8):kOe.test(e)?z8:+e}var rJ=DOe,MOe=Rh,kA=bOe,U8=rJ,ROe="Expected a function",LOe=Math.max,FOe=Math.min;function $Oe(e,t,r){var n,o,s,i,l,c,d=0,u=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(ROe);t=U8(t)||0,MOe(r)&&(u=!!r.leading,f="maxWait"in r,s=f?LOe(U8(r.maxWait)||0,t):s,h="trailing"in r?!!r.trailing:h);function m(C){var E=n,A=o;return n=o=void 0,d=C,i=e.apply(A,E),i}function v(C){return d=C,l=setTimeout(x,t),u?m(C):i}function g(C){var E=C-c,A=C-d,P=t-E;return f?FOe(P,s-A):P}function y(C){var E=C-c,A=C-d;return c===void 0||E>=t||E<0||f&&A>=s}function x(){var C=kA();if(y(C))return b(C);l=setTimeout(x,g(C))}function b(C){return l=void 0,h&&n?m(C):(n=o=void 0,i)}function w(){l!==void 0&&clearTimeout(l),d=0,n=c=o=l=void 0}function j(){return l===void 0?i:b(kA())}function _(){var C=kA(),E=y(C);if(n=arguments,o=this,c=C,E){if(l===void 0)return v(c);if(f)return clearTimeout(l),l=setTimeout(x,t),m(c)}return l===void 0&&(l=setTimeout(x,t)),i}return _.cancel=w,_.flush=j,_}var BOe=$Oe,qOe=BOe,zOe=Rh,UOe="Expected a function";function VOe(e,t,r){var n=!0,o=!0;if(typeof e!="function")throw new TypeError(UOe);return zOe(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),qOe(e,t,{leading:n,maxWait:t,trailing:o})}var WOe=VOe;const nJ=Ga(WOe);function Zb(e){"@babel/helpers - typeof";return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zb(e)}function V8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function W2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V8(Object(r),!0).forEach(function(n){HOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HOe(e,t,r){return t=GOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GOe(e){var t=KOe(e,"string");return Zb(t)=="symbol"?t:t+""}function KOe(e,t){if(Zb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XOe(e,t){return ZOe(e)||QOe(e,t)||JOe(e,t)||YOe()}function YOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JOe(e,t){if(e){if(typeof e=="string")return W8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W8(e,t)}}function W8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function ZOe(e){if(Array.isArray(e))return e}var Hj=p.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,o=n===void 0?{width:-1,height:-1}:n,s=e.width,i=s===void 0?"100%":s,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,f=e.minHeight,h=e.maxHeight,m=e.children,v=e.debounce,g=v===void 0?0:v,y=e.id,x=e.className,b=e.onResize,w=e.style,j=w===void 0?{}:w,_=p.useRef(null),C=p.useRef();C.current=b,p.useImperativeHandle(t,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var E=p.useState({containerWidth:o.width,containerHeight:o.height}),A=XOe(E,2),P=A[0],F=A[1],M=p.useCallback(function(R,D){F(function(U){var z=Math.round(R),H=Math.round(D);return U.containerWidth===z&&U.containerHeight===H?U:{containerWidth:z,containerHeight:H}})},[]);p.useEffect(function(){var R=function(Q){var pe,be=Q[0].contentRect,V=be.width,B=be.height;M(V,B),(pe=C.current)===null||pe===void 0||pe.call(C,V,B)};g>0&&(R=nJ(R,g,{trailing:!0,leading:!1}));var D=new ResizeObserver(R),U=_.current.getBoundingClientRect(),z=U.width,H=U.height;return M(z,H),D.observe(_.current),function(){D.disconnect()}},[M,g]);var I=p.useMemo(function(){var R=P.containerWidth,D=P.containerHeight;if(R<0||D<0)return null;au(_p(i)||_p(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),au(!r||r>0,"The aspect(%s) must be greater than zero.",r);var U=_p(i)?R:i,z=_p(c)?D:c;r&&r>0&&(U?z=U/r:z&&(U=z*r),h&&z>h&&(z=h)),au(U>0||z>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,U,z,i,c,u,f,r);var H=!Array.isArray(m)&&Mf(m.type).endsWith("Chart");return _e.Children.map(m,function(q){return _e.isValidElement(q)?p.cloneElement(q,W2({width:U,height:z},H?{style:W2({height:"100%",width:"100%",maxHeight:z,maxWidth:U},q.props.style)}:{})):q})},[r,m,c,h,f,u,P,i]);return _e.createElement("div",{id:y?"".concat(y):void 0,className:pa("recharts-responsive-container",x),style:W2(W2({},j),{},{width:i,height:c,minWidth:u,minHeight:f,maxHeight:h}),ref:_},I)}),ew=function(t){return null};ew.displayName="Cell";function tw(e){"@babel/helpers - typeof";return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tw(e)}function H8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H8(Object(r),!0).forEach(function(n){eTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eTe(e,t,r){return t=tTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tTe(e){var t=rTe(e,"string");return tw(t)=="symbol"?t:t+""}function rTe(e,t){if(tw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kg={widthCache:{},cacheCount:0},nTe=2e3,aTe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},G8="recharts_measurement_span";function oTe(e){var t=nO({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var Qy=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||ou.isSsr)return{width:0,height:0};var n=oTe(r),o=JSON.stringify({text:t,copyStyle:n});if(Kg.widthCache[o])return Kg.widthCache[o];try{var s=document.getElementById(G8);s||(s=document.createElement("span"),s.setAttribute("id",G8),s.setAttribute("aria-hidden","true"),document.body.appendChild(s));var i=nO(nO({},aTe),n);Object.assign(s.style,i),s.textContent="".concat(t);var l=s.getBoundingClientRect(),c={width:l.width,height:l.height};return Kg.widthCache[o]=c,++Kg.cacheCount>nTe&&(Kg.cacheCount=0,Kg.widthCache={}),c}catch{return{width:0,height:0}}},sTe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function rw(e){"@babel/helpers - typeof";return rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rw(e)}function dN(e,t){return dTe(e)||cTe(e,t)||lTe(e,t)||iTe()}function iTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lTe(e,t){if(e){if(typeof e=="string")return K8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K8(e,t)}}function K8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function dTe(e){if(Array.isArray(e))return e}function uTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mTe(n.key),n)}}function fTe(e,t,r){return t&&X8(e.prototype,t),r&&X8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mTe(e){var t=hTe(e,"string");return rw(t)=="symbol"?t:t+""}function hTe(e,t){if(rw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,J8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,pTe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,gTe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,aJ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},vTe=Object.keys(aJ),Dv="NaN";function xTe(e,t){return e*aJ[t]}var H2=function(){function e(t,r){uTe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!pTe.test(r)&&(this.num=NaN,this.unit=""),vTe.includes(r)&&(this.num=xTe(t,r),this.unit="px")}return fTe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,o=(n=gTe.exec(r))!==null&&n!==void 0?n:[],s=dN(o,3),i=s[1],l=s[2];return new e(parseFloat(i),l??"")}}])}();function oJ(e){if(e.includes(Dv))return Dv;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=Y8.exec(t))!==null&&r!==void 0?r:[],o=dN(n,4),s=o[1],i=o[2],l=o[3],c=H2.parse(s??""),d=H2.parse(l??""),u=i==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return Dv;t=t.replace(Y8,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=J8.exec(t))!==null&&f!==void 0?f:[],m=dN(h,4),v=m[1],g=m[2],y=m[3],x=H2.parse(v??""),b=H2.parse(y??""),w=g==="+"?x.add(b):x.subtract(b);if(w.isNaN())return Dv;t=t.replace(J8,w.toString())}return t}var Q8=/\(([^()]*)\)/;function yTe(e){for(var t=e;t.includes("(");){var r=Q8.exec(t),n=dN(r,2),o=n[1];t=t.replace(Q8,oJ(o))}return t}function bTe(e){var t=e.replace(/\s+/g,"");return t=yTe(t),t=oJ(t),t}function wTe(e){try{return bTe(e)}catch{return Dv}}function IA(e){var t=wTe(e.slice(5,-1));return t===Dv?"":t}var jTe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],_Te=["dx","dy","angle","className","breakAll"];function aO(){return aO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aO.apply(this,arguments)}function Z8(e,t){if(e==null)return{};var r=NTe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function NTe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function eB(e,t){return ATe(e)||PTe(e,t)||CTe(e,t)||STe()}function STe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CTe(e,t){if(e){if(typeof e=="string")return tB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tB(e,t)}}function tB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function ATe(e){if(Array.isArray(e))return e}var sJ=/[ \f\n\r\t\v\u2028\u2029]+/,iJ=function(t){var r=t.children,n=t.breakAll,o=t.style;try{var s=[];ua(r)||(n?s=r.toString().split(""):s=r.toString().split(sJ));var i=s.map(function(c){return{word:c,width:Qy(c,o).width}}),l=n?0:Qy("",o).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}},ETe=function(t,r,n,o,s){var i=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=en(i),f=l,h=function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U.reduce(function(z,H){var q=H.word,Q=H.width,pe=z[z.length-1];if(pe&&(o==null||s||pe.width+Q+n<Number(o)))pe.words.push(q),pe.width+=Q+n;else{var be={words:[q],width:Q};z.push(be)}return z},[])},m=h(r),v=function(U){return U.reduce(function(z,H){return z.width>H.width?z:H})};if(!u)return m;for(var g="",y=function(U){var z=f.slice(0,U),H=iJ({breakAll:d,style:c,children:z+g}).wordsWithComputedWidth,q=h(H),Q=q.length>i||v(q).width>Number(o);return[Q,q]},x=0,b=f.length-1,w=0,j;x<=b&&w<=f.length-1;){var _=Math.floor((x+b)/2),C=_-1,E=y(C),A=eB(E,2),P=A[0],F=A[1],M=y(_),I=eB(M,1),R=I[0];if(!P&&!R&&(x=_+1),P&&R&&(b=_-1),!P&&R){j=F;break}w++}return j||m},rB=function(t){var r=ua(t)?[]:t.toString().split(sJ);return[{words:r}]},kTe=function(t){var r=t.width,n=t.scaleToFit,o=t.children,s=t.style,i=t.breakAll,l=t.maxLines;if((r||n)&&!ou.isSsr){var c,d,u=iJ({breakAll:i,children:o,style:s});if(u){var f=u.wordsWithComputedWidth,h=u.spaceWidth;c=f,d=h}else return rB(o);return ETe({breakAll:i,children:o,maxLines:l,style:s},c,d,r,n)}return rB(o)},nB="#808080",ag=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,s=o===void 0?0:o,i=t.lineHeight,l=i===void 0?"1em":i,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,f=u===void 0?!1:u,h=t.textAnchor,m=h===void 0?"start":h,v=t.verticalAnchor,g=v===void 0?"end":v,y=t.fill,x=y===void 0?nB:y,b=Z8(t,jTe),w=p.useMemo(function(){return kTe({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:f,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,f,b.style,b.width]),j=b.dx,_=b.dy,C=b.angle,E=b.className,A=b.breakAll,P=Z8(b,_Te);if(!Js(n)||!Js(s))return null;var F=n+(en(j)?j:0),M=s+(en(_)?_:0),I;switch(g){case"start":I=IA("calc(".concat(d,")"));break;case"middle":I=IA("calc(".concat((w.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:I=IA("calc(".concat(w.length-1," * -").concat(l,")"));break}var R=[];if(f){var D=w[0].width,U=b.width;R.push("scale(".concat((en(U)?U/D:1)/D,")"))}return C&&R.push("rotate(".concat(C,", ").concat(F,", ").concat(M,")")),R.length&&(P.transform=R.join(" ")),_e.createElement("text",aO({},Kn(P,!0),{x:F,y:M,className:pa("recharts-text",E),textAnchor:m,fill:x.includes("url")?nB:x}),w.map(function(z,H){var q=z.words.join(A?"":" ");return _e.createElement("tspan",{x:F,dy:H===0?I:l,key:"".concat(q,"-").concat(H)},q)}))};function ch(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ITe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function SD(e){let t,r,n;e.length!==2?(t=ch,r=(l,c)=>ch(e(l),c),n=(l,c)=>e(l)-c):(t=e===ch||e===ITe?e:OTe,r=e,n=e);function o(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function s(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){const f=o(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:o,center:i,right:s}}function OTe(){return 0}function lJ(e){return e===null?NaN:+e}function*TTe(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const DTe=SD(ch),MTe=DTe.right;SD(lJ).center;const h1=MTe;class aB extends Map{constructor(t,r=FTe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,o]of t)this.set(n,o)}get(t){return super.get(oB(this,t))}has(t){return super.has(oB(this,t))}set(t,r){return super.set(RTe(this,t),r)}delete(t){return super.delete(LTe(this,t))}}function oB({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function RTe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function LTe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function FTe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function $Te(e=ch){if(e===ch)return cJ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function cJ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const BTe=Math.sqrt(50),qTe=Math.sqrt(10),zTe=Math.sqrt(2);function uN(e,t,r){const n=(t-e)/Math.max(0,r),o=Math.floor(Math.log10(n)),s=n/Math.pow(10,o),i=s>=BTe?10:s>=qTe?5:s>=zTe?2:1;let l,c,d;return o<0?(d=Math.pow(10,-o)/i,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,o)*i,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?uN(e,t,r*2):[l,c,d]}function oO(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[o,s,i]=n?uN(t,e,r):uN(e,t,r);if(!(s>=o))return[];const l=s-o+1,c=new Array(l);if(n)if(i<0)for(let d=0;d<l;++d)c[d]=(s-d)/-i;else for(let d=0;d<l;++d)c[d]=(s-d)*i;else if(i<0)for(let d=0;d<l;++d)c[d]=(o+d)/-i;else for(let d=0;d<l;++d)c[d]=(o+d)*i;return c}function sO(e,t,r){return t=+t,e=+e,r=+r,uN(e,t,r)[2]}function iO(e,t,r){t=+t,e=+e,r=+r;const n=t<e,o=n?sO(t,e,r):sO(e,t,r);return(n?-1:1)*(o<0?1/-o:o)}function sB(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r<o||r===void 0&&o>=o)&&(r=o)}return r}function iB(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r>o||r===void 0&&o>=o)&&(r=o)}return r}function dJ(e,t,r=0,n=1/0,o){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(o=o===void 0?cJ:$Te(o);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*f/c+h)),v=Math.min(n,Math.floor(t+(c-d)*f/c+h));dJ(e,t,m,v,o)}const s=e[t];let i=r,l=n;for(ay(e,r,t),o(e[n],s)>0&&ay(e,r,n);i<l;){for(ay(e,i,l),++i,--l;o(e[i],s)<0;)++i;for(;o(e[l],s)>0;)--l}o(e[r],s)===0?ay(e,r,l):(++l,ay(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function ay(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function UTe(e,t,r){if(e=Float64Array.from(TTe(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return iB(e);if(t>=1)return sB(e);var n,o=(n-1)*t,s=Math.floor(o),i=sB(dJ(e,s).subarray(0,s+1)),l=iB(e.subarray(s+1));return i+(l-i)*(o-s)}}function VTe(e,t,r=lJ){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,o=(n-1)*t,s=Math.floor(o),i=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return i+(l-i)*(o-s)}}function WTe(e,t,r){e=+e,t=+t,r=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+r;for(var n=-1,o=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(o);++n<o;)s[n]=e+n*r;return s}function Ed(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function nm(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const lO=Symbol("implicit");function CD(){var e=new aB,t=[],r=[],n=lO;function o(s){let i=e.get(s);if(i===void 0){if(n!==lO)return n;e.set(s,i=t.push(s)-1)}return r[i%r.length]}return o.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new aB;for(const i of s)e.has(i)||e.set(i,t.push(i)-1);return o},o.range=function(s){return arguments.length?(r=Array.from(s),o):r.slice()},o.unknown=function(s){return arguments.length?(n=s,o):n},o.copy=function(){return CD(t,r).unknown(n)},Ed.apply(o,arguments),o}function nw(){var e=CD().unknown(void 0),t=e.domain,r=e.range,n=0,o=1,s,i,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var h=t().length,m=o<n,v=m?o:n,g=m?n:o;s=(g-v)/Math.max(1,h-c+d*2),l&&(s=Math.floor(s)),v+=(g-v-s*(h-c))*u,i=s*(1-c),l&&(v=Math.round(v),i=Math.round(i));var y=WTe(h).map(function(x){return v+s*x});return r(m?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,o]=h,n=+n,o=+o,f()):[n,o]},e.rangeRound=function(h){return[n,o]=h,n=+n,o=+o,l=!0,f()},e.bandwidth=function(){return i},e.step=function(){return s},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,f()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.copy=function(){return nw(t(),[n,o]).round(l).paddingInner(c).paddingOuter(d).align(u)},Ed.apply(f(),arguments)}function uJ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return uJ(t())},e}function Zy(){return uJ(nw.apply(null,arguments).paddingInner(1))}function PD(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function fJ(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function p1(){}var aw=.7,fN=1/aw,Zv="\\s*([+-]?\\d+)\\s*",ow="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Uu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",HTe=/^#([0-9a-f]{3,8})$/,GTe=new RegExp(`^rgb\\(${Zv},${Zv},${Zv}\\)$`),KTe=new RegExp(`^rgb\\(${Uu},${Uu},${Uu}\\)$`),XTe=new RegExp(`^rgba\\(${Zv},${Zv},${Zv},${ow}\\)$`),YTe=new RegExp(`^rgba\\(${Uu},${Uu},${Uu},${ow}\\)$`),JTe=new RegExp(`^hsl\\(${ow},${Uu},${Uu}\\)$`),QTe=new RegExp(`^hsla\\(${ow},${Uu},${Uu},${ow}\\)$`),lB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};PD(p1,sw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:cB,formatHex:cB,formatHex8:ZTe,formatHsl:e3e,formatRgb:dB,toString:dB});function cB(){return this.rgb().formatHex()}function ZTe(){return this.rgb().formatHex8()}function e3e(){return mJ(this).formatHsl()}function dB(){return this.rgb().formatRgb()}function sw(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=HTe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?uB(t):r===3?new Bl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?G2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?G2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=GTe.exec(e))?new Bl(t[1],t[2],t[3],1):(t=KTe.exec(e))?new Bl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=XTe.exec(e))?G2(t[1],t[2],t[3],t[4]):(t=YTe.exec(e))?G2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=JTe.exec(e))?hB(t[1],t[2]/100,t[3]/100,1):(t=QTe.exec(e))?hB(t[1],t[2]/100,t[3]/100,t[4]):lB.hasOwnProperty(e)?uB(lB[e]):e==="transparent"?new Bl(NaN,NaN,NaN,0):null}function uB(e){return new Bl(e>>16&255,e>>8&255,e&255,1)}function G2(e,t,r,n){return n<=0&&(e=t=r=NaN),new Bl(e,t,r,n)}function t3e(e){return e instanceof p1||(e=sw(e)),e?(e=e.rgb(),new Bl(e.r,e.g,e.b,e.opacity)):new Bl}function cO(e,t,r,n){return arguments.length===1?t3e(e):new Bl(e,t,r,n??1)}function Bl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}PD(Bl,cO,fJ(p1,{brighter(e){return e=e==null?fN:Math.pow(fN,e),new Bl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?aw:Math.pow(aw,e),new Bl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Bl(Fp(this.r),Fp(this.g),Fp(this.b),mN(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fB,formatHex:fB,formatHex8:r3e,formatRgb:mB,toString:mB}));function fB(){return`#${Np(this.r)}${Np(this.g)}${Np(this.b)}`}function r3e(){return`#${Np(this.r)}${Np(this.g)}${Np(this.b)}${Np((isNaN(this.opacity)?1:this.opacity)*255)}`}function mB(){const e=mN(this.opacity);return`${e===1?"rgb(":"rgba("}${Fp(this.r)}, ${Fp(this.g)}, ${Fp(this.b)}${e===1?")":`, ${e})`}`}function mN(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Fp(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Np(e){return e=Fp(e),(e<16?"0":"")+e.toString(16)}function hB(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Qd(e,t,r,n)}function mJ(e){if(e instanceof Qd)return new Qd(e.h,e.s,e.l,e.opacity);if(e instanceof p1||(e=sw(e)),!e)return new Qd;if(e instanceof Qd)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,o=Math.min(t,r,n),s=Math.max(t,r,n),i=NaN,l=s-o,c=(s+o)/2;return l?(t===s?i=(r-n)/l+(r<n)*6:r===s?i=(n-t)/l+2:i=(t-r)/l+4,l/=c<.5?s+o:2-s-o,i*=60):l=c>0&&c<1?0:i,new Qd(i,l,c,e.opacity)}function n3e(e,t,r,n){return arguments.length===1?mJ(e):new Qd(e,t,r,n??1)}function Qd(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}PD(Qd,n3e,fJ(p1,{brighter(e){return e=e==null?fN:Math.pow(fN,e),new Qd(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?aw:Math.pow(aw,e),new Qd(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,o=2*r-n;return new Bl(OA(e>=240?e-240:e+120,o,n),OA(e,o,n),OA(e<120?e+240:e-120,o,n),this.opacity)},clamp(){return new Qd(pB(this.h),K2(this.s),K2(this.l),mN(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=mN(this.opacity);return`${e===1?"hsl(":"hsla("}${pB(this.h)}, ${K2(this.s)*100}%, ${K2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function pB(e){return e=(e||0)%360,e<0?e+360:e}function K2(e){return Math.max(0,Math.min(1,e||0))}function OA(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const AD=e=>()=>e;function a3e(e,t){return function(r){return e+r*t}}function o3e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function s3e(e){return(e=+e)==1?hJ:function(t,r){return r-t?o3e(t,r,e):AD(isNaN(t)?r:t)}}function hJ(e,t){var r=t-e;return r?a3e(e,r):AD(isNaN(e)?t:e)}const gB=function e(t){var r=s3e(t);function n(o,s){var i=r((o=cO(o)).r,(s=cO(s)).r),l=r(o.g,s.g),c=r(o.b,s.b),d=hJ(o.opacity,s.opacity);return function(u){return o.r=i(u),o.g=l(u),o.b=c(u),o.opacity=d(u),o+""}}return n.gamma=e,n}(1);function i3e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),o;return function(s){for(o=0;o<r;++o)n[o]=e[o]*(1-s)+t[o]*s;return n}}function l3e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function c3e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,o=new Array(n),s=new Array(r),i;for(i=0;i<n;++i)o[i]=j0(e[i],t[i]);for(;i<r;++i)s[i]=t[i];return function(l){for(i=0;i<n;++i)s[i]=o[i](l);return s}}function d3e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function hN(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function u3e(e,t){var r={},n={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?r[o]=j0(e[o],t[o]):n[o]=t[o];return function(s){for(o in r)n[o]=r[o](s);return n}}var dO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,TA=new RegExp(dO.source,"g");function f3e(e){return function(){return e}}function m3e(e){return function(t){return e(t)+""}}function h3e(e,t){var r=dO.lastIndex=TA.lastIndex=0,n,o,s,i=-1,l=[],c=[];for(e=e+"",t=t+"";(n=dO.exec(e))&&(o=TA.exec(t));)(s=o.index)>r&&(s=t.slice(r,s),l[i]?l[i]+=s:l[++i]=s),(n=n[0])===(o=o[0])?l[i]?l[i]+=o:l[++i]=o:(l[++i]=null,c.push({i,x:hN(n,o)})),r=TA.lastIndex;return r<t.length&&(s=t.slice(r),l[i]?l[i]+=s:l[++i]=s),l.length<2?c[0]?m3e(c[0].x):f3e(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function j0(e,t){var r=typeof t,n;return t==null||r==="boolean"?AD(t):(r==="number"?hN:r==="string"?(n=sw(t))?(t=n,gB):h3e:t instanceof sw?gB:t instanceof Date?d3e:l3e(t)?i3e:Array.isArray(t)?c3e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?u3e:hN)(e,t)}function ED(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function p3e(e,t){t===void 0&&(t=e,e=j0);for(var r=0,n=t.length-1,o=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(o,o=t[++r]);return function(i){var l=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return s[l](i-l)}}function g3e(e){return function(){return e}}function pN(e){return+e}var vB=[0,1];function gl(e){return e}function uO(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:g3e(isNaN(t)?NaN:.5)}function v3e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function x3e(e,t,r){var n=e[0],o=e[1],s=t[0],i=t[1];return o<n?(n=uO(o,n),s=r(i,s)):(n=uO(n,o),s=r(s,i)),function(l){return s(n(l))}}function y3e(e,t,r){var n=Math.min(e.length,t.length)-1,o=new Array(n),s=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)o[i]=uO(e[i],e[i+1]),s[i]=r(t[i],t[i+1]);return function(l){var c=h1(e,l,1,n)-1;return s[c](o[c](l))}}function g1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function UC(){var e=vB,t=vB,r=j0,n,o,s,i=gl,l,c,d;function u(){var h=Math.min(e.length,t.length);return i!==gl&&(i=v3e(e[0],e[h-1])),l=h>2?y3e:x3e,c=d=null,f}function f(h){return h==null||isNaN(h=+h)?s:(c||(c=l(e.map(n),t,r)))(n(i(h)))}return f.invert=function(h){return i(o((d||(d=l(t,e.map(n),hN)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,pN),u()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),u()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=ED,u()},f.clamp=function(h){return arguments.length?(i=h?!0:gl,u()):i!==gl},f.interpolate=function(h){return arguments.length?(r=h,u()):r},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,m){return n=h,o=m,u()}}function kD(){return UC()(gl,gl)}function b3e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function gN(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Cx(e){return e=gN(Math.abs(e)),e?e[1]:NaN}function w3e(e,t){return function(r,n){for(var o=r.length,s=[],i=0,l=e[0],c=0;o>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(o-=l,o+l)),!((c+=l+1)>n));)l=e[i=(i+1)%e.length];return s.reverse().join(t)}}function j3e(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var _3e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function iw(e){if(!(t=_3e.exec(e)))throw new Error("invalid format: "+e);var t;return new ID({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}iw.prototype=ID.prototype;function ID(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ID.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function N3e(e){e:for(var t=e.length,r=1,n=-1,o;r<t;++r)switch(e[r]){case".":n=o=r;break;case"0":n===0&&(n=r),o=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(o+1):e}var pJ;function S3e(e,t){var r=gN(e,t);if(!r)return e+"";var n=r[0],o=r[1],s=o-(pJ=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,i=n.length;return s===i?n:s>i?n+new Array(s-i+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+gN(e,Math.max(0,t+s-1))[0]}function xB(e,t){var r=gN(e,t);if(!r)return e+"";var n=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}const yB={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:b3e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>xB(e*100,t),r:xB,s:S3e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function bB(e){return e}var wB=Array.prototype.map,jB=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function C3e(e){var t=e.grouping===void 0||e.thousands===void 0?bB:w3e(wB.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?bB:j3e(wB.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=iw(f);var h=f.fill,m=f.align,v=f.sign,g=f.symbol,y=f.zero,x=f.width,b=f.comma,w=f.precision,j=f.trim,_=f.type;_==="n"?(b=!0,_="g"):yB[_]||(w===void 0&&(w=12),j=!0,_="g"),(y||h==="0"&&m==="=")&&(y=!0,h="0",m="=");var C=g==="$"?r:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",E=g==="$"?n:/[%p]/.test(_)?i:"",A=yB[_],P=/[defgprs%]/.test(_);w=w===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function F(M){var I=C,R=E,D,U,z;if(_==="c")R=A(M)+R,M="";else{M=+M;var H=M<0||1/M<0;if(M=isNaN(M)?c:A(Math.abs(M),w),j&&(M=N3e(M)),H&&+M==0&&v!=="+"&&(H=!1),I=(H?v==="("?v:l:v==="-"||v==="("?"":v)+I,R=(_==="s"?jB[8+pJ/3]:"")+R+(H&&v==="("?")":""),P){for(D=-1,U=M.length;++D<U;)if(z=M.charCodeAt(D),48>z||z>57){R=(z===46?o+M.slice(D+1):M.slice(D))+R,M=M.slice(0,D);break}}}b&&!y&&(M=t(M,1/0));var q=I.length+M.length+R.length,Q=q<x?new Array(x-q+1).join(h):"";switch(b&&y&&(M=t(Q+M,Q.length?x-R.length:1/0),Q=""),m){case"<":M=I+M+R+Q;break;case"=":M=I+Q+M+R;break;case"^":M=Q.slice(0,q=Q.length>>1)+I+M+R+Q.slice(q);break;default:M=Q+I+M+R;break}return s(M)}return F.toString=function(){return f+""},F}function u(f,h){var m=d((f=iw(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(Cx(h)/3)))*3,g=Math.pow(10,-v),y=jB[8+v/3];return function(x){return m(g*x)+y}}return{format:d,formatPrefix:u}}var X2,OD,gJ;P3e({thousands:",",grouping:[3],currency:["$",""]});function P3e(e){return X2=C3e(e),OD=X2.format,gJ=X2.formatPrefix,X2}function A3e(e){return Math.max(0,-Cx(Math.abs(e)))}function E3e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Cx(t)/3)))*3-Cx(Math.abs(e)))}function k3e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Cx(t)-Cx(e))+1}function vJ(e,t,r,n){var o=iO(e,t,r),s;switch(n=iw(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=E3e(o,i))&&(n.precision=s),gJ(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=k3e(o,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=A3e(o))&&(n.precision=s-(n.type==="%")*2);break}}return OD(n)}function Lh(e){var t=e.domain;return e.ticks=function(r){var n=t();return oO(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var o=t();return vJ(o[0],o[o.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),o=0,s=n.length-1,i=n[o],l=n[s],c,d,u=10;for(l<i&&(d=i,i=l,l=d,d=o,o=s,s=d);u-- >0;){if(d=sO(i,l,r),d===c)return n[o]=i,n[s]=l,t(n);if(d>0)i=Math.floor(i/d)*d,l=Math.ceil(l/d)*d;else if(d<0)i=Math.ceil(i*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function vN(){var e=kD();return e.copy=function(){return g1(e,vN())},Ed.apply(e,arguments),Lh(e)}function xJ(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,pN),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return xJ(e).unknown(t)},e=arguments.length?Array.from(e,pN):[0,1],Lh(r)}function yJ(e,t){e=e.slice();var r=0,n=e.length-1,o=e[r],s=e[n],i;return s<o&&(i=r,r=n,n=i,i=o,o=s,s=i),e[r]=t.floor(o),e[n]=t.ceil(s),e}function _B(e){return Math.log(e)}function NB(e){return Math.exp(e)}function I3e(e){return-Math.log(-e)}function O3e(e){return-Math.exp(-e)}function T3e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function D3e(e){return e===10?T3e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function M3e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function SB(e){return(t,r)=>-e(-t,r)}function TD(e){const t=e(_B,NB),r=t.domain;let n=10,o,s;function i(){return o=M3e(n),s=D3e(n),r()[0]<0?(o=SB(o),s=SB(s),e(I3e,O3e)):e(_B,NB),t}return t.base=function(l){return arguments.length?(n=+l,i()):n},t.domain=function(l){return arguments.length?(r(l),i()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let h=o(d),m=o(u),v,g;const y=l==null?10:+l;let x=[];if(!(n%1)&&m-h<y){if(h=Math.floor(h),m=Math.ceil(m),d>0){for(;h<=m;++h)for(v=1;v<n;++v)if(g=h<0?v/s(-h):v*s(h),!(g<d)){if(g>u)break;x.push(g)}}else for(;h<=m;++h)for(v=n-1;v>=1;--v)if(g=h>0?v/s(-h):v*s(h),!(g<d)){if(g>u)break;x.push(g)}x.length*2<y&&(x=oO(d,u,y))}else x=oO(h,m,Math.min(m-h,y)).map(s);return f?x.reverse():x},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=iw(c)).precision==null&&(c.trim=!0),c=OD(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let f=u/s(Math.round(o(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},t.nice=()=>r(yJ(r(),{floor:l=>s(Math.floor(o(l))),ceil:l=>s(Math.ceil(o(l)))})),t}function bJ(){const e=TD(UC()).domain([1,10]);return e.copy=()=>g1(e,bJ()).base(e.base()),Ed.apply(e,arguments),e}function CB(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function PB(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function DD(e){var t=1,r=e(CB(t),PB(t));return r.constant=function(n){return arguments.length?e(CB(t=+n),PB(t)):t},Lh(r)}function wJ(){var e=DD(UC());return e.copy=function(){return g1(e,wJ()).constant(e.constant())},Ed.apply(e,arguments)}function AB(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function R3e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function L3e(e){return e<0?-e*e:e*e}function MD(e){var t=e(gl,gl),r=1;function n(){return r===1?e(gl,gl):r===.5?e(R3e,L3e):e(AB(r),AB(1/r))}return t.exponent=function(o){return arguments.length?(r=+o,n()):r},Lh(t)}function RD(){var e=MD(UC());return e.copy=function(){return g1(e,RD()).exponent(e.exponent())},Ed.apply(e,arguments),e}function F3e(){return RD.apply(null,arguments).exponent(.5)}function EB(e){return Math.sign(e)*e*e}function $3e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function jJ(){var e=kD(),t=[0,1],r=!1,n;function o(s){var i=$3e(e(s));return isNaN(i)?n:r?Math.round(i):i}return o.invert=function(s){return e.invert(EB(s))},o.domain=function(s){return arguments.length?(e.domain(s),o):e.domain()},o.range=function(s){return arguments.length?(e.range((t=Array.from(s,pN)).map(EB)),o):t.slice()},o.rangeRound=function(s){return o.range(s).round(!0)},o.round=function(s){return arguments.length?(r=!!s,o):r},o.clamp=function(s){return arguments.length?(e.clamp(s),o):e.clamp()},o.unknown=function(s){return arguments.length?(n=s,o):n},o.copy=function(){return jJ(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ed.apply(o,arguments),Lh(o)}function _J(){var e=[],t=[],r=[],n;function o(){var i=0,l=Math.max(1,t.length);for(r=new Array(l-1);++i<l;)r[i-1]=VTe(e,i/l);return s}function s(i){return i==null||isNaN(i=+i)?n:t[h1(r,i)]}return s.invertExtent=function(i){var l=t.indexOf(i);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let l of i)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(ch),o()},s.range=function(i){return arguments.length?(t=Array.from(i),o()):t.slice()},s.unknown=function(i){return arguments.length?(n=i,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return _J().domain(e).range(t).unknown(n)},Ed.apply(s,arguments)}function NJ(){var e=0,t=1,r=1,n=[.5],o=[0,1],s;function i(c){return c!=null&&c<=c?o[h1(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},i.range=function(c){return arguments.length?(r=(o=Array.from(c)).length-1,l()):o.slice()},i.invertExtent=function(c){var d=o.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},i.unknown=function(c){return arguments.length&&(s=c),i},i.thresholds=function(){return n.slice()},i.copy=function(){return NJ().domain([e,t]).range(o).unknown(s)},Ed.apply(Lh(i),arguments)}function SJ(){var e=[.5],t=[0,1],r,n=1;function o(s){return s!=null&&s<=s?t[h1(e,s,0,n)]:r}return o.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(s){var i=t.indexOf(s);return[e[i-1],e[i]]},o.unknown=function(s){return arguments.length?(r=s,o):r},o.copy=function(){return SJ().domain(e).range(t).unknown(r)},Ed.apply(o,arguments)}const DA=new Date,MA=new Date;function Qs(e,t,r,n){function o(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return o.floor=s=>(e(s=new Date(+s)),s),o.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),o.round=s=>{const i=o(s),l=o.ceil(s);return s-i<l-s?i:l},o.offset=(s,i)=>(t(s=new Date(+s),i==null?1:Math.floor(i)),s),o.range=(s,i,l)=>{const c=[];if(s=o.ceil(s),l=l==null?1:Math.floor(l),!(s<i)||!(l>0))return c;let d;do c.push(d=new Date(+s)),t(s,l),e(s);while(d<s&&s<i);return c},o.filter=s=>Qs(i=>{if(i>=i)for(;e(i),!s(i);)i.setTime(i-1)},(i,l)=>{if(i>=i)if(l<0)for(;++l<=0;)for(;t(i,-1),!s(i););else for(;--l>=0;)for(;t(i,1),!s(i););}),r&&(o.count=(s,i)=>(DA.setTime(+s),MA.setTime(+i),e(DA),e(MA),Math.floor(r(DA,MA))),o.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?o.filter(n?i=>n(i)%s===0:i=>o.count(0,i)%s===0):o)),o}const xN=Qs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);xN.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Qs(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):xN);xN.range;const Pf=1e3,md=Pf*60,Af=md*60,Wf=Af*24,LD=Wf*7,kB=Wf*30,RA=Wf*365,Sp=Qs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Pf)},(e,t)=>(t-e)/Pf,e=>e.getUTCSeconds());Sp.range;const FD=Qs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Pf)},(e,t)=>{e.setTime(+e+t*md)},(e,t)=>(t-e)/md,e=>e.getMinutes());FD.range;const $D=Qs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*md)},(e,t)=>(t-e)/md,e=>e.getUTCMinutes());$D.range;const BD=Qs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Pf-e.getMinutes()*md)},(e,t)=>{e.setTime(+e+t*Af)},(e,t)=>(t-e)/Af,e=>e.getHours());BD.range;const qD=Qs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Af)},(e,t)=>(t-e)/Af,e=>e.getUTCHours());qD.range;const v1=Qs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*md)/Wf,e=>e.getDate()-1);v1.range;const VC=Qs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Wf,e=>e.getUTCDate()-1);VC.range;const CJ=Qs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Wf,e=>Math.floor(e/Wf));CJ.range;function Sg(e){return Qs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*md)/LD)}const WC=Sg(0),yN=Sg(1),B3e=Sg(2),q3e=Sg(3),Px=Sg(4),z3e=Sg(5),U3e=Sg(6);WC.range;yN.range;B3e.range;q3e.range;Px.range;z3e.range;U3e.range;function Cg(e){return Qs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/LD)}const HC=Cg(0),bN=Cg(1),V3e=Cg(2),W3e=Cg(3),Ax=Cg(4),H3e=Cg(5),G3e=Cg(6);HC.range;bN.range;V3e.range;W3e.range;Ax.range;H3e.range;G3e.range;const zD=Qs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());zD.range;const UD=Qs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());UD.range;const Hf=Qs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Hf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Qs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Hf.range;const Gf=Qs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Gf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Qs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Gf.range;function PJ(e,t,r,n,o,s){const i=[[Sp,1,Pf],[Sp,5,5*Pf],[Sp,15,15*Pf],[Sp,30,30*Pf],[s,1,md],[s,5,5*md],[s,15,15*md],[s,30,30*md],[o,1,Af],[o,3,3*Af],[o,6,6*Af],[o,12,12*Af],[n,1,Wf],[n,2,2*Wf],[r,1,LD],[t,1,kB],[t,3,3*kB],[e,1,RA]];function l(d,u,f){const h=u<d;h&&([d,u]=[u,d]);const m=f&&typeof f.range=="function"?f:c(d,u,f),v=m?m.range(d,+u+1):[];return h?v.reverse():v}function c(d,u,f){const h=Math.abs(u-d)/f,m=SD(([,,y])=>y).right(i,h);if(m===i.length)return e.every(iO(d/RA,u/RA,f));if(m===0)return xN.every(Math.max(iO(d,u,f),1));const[v,g]=i[h/i[m-1][2]<i[m][2]/h?m-1:m];return v.every(g)}return[l,c]}const[K3e,X3e]=PJ(Gf,UD,HC,CJ,qD,$D),[Y3e,J3e]=PJ(Hf,zD,WC,v1,BD,FD);function LA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function FA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function oy(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Q3e(e){var t=e.dateTime,r=e.date,n=e.time,o=e.periods,s=e.days,i=e.shortDays,l=e.months,c=e.shortMonths,d=sy(o),u=iy(o),f=sy(s),h=iy(s),m=sy(i),v=iy(i),g=sy(l),y=iy(l),x=sy(c),b=iy(c),w={a:H,A:q,b:Q,B:pe,c:null,d:RB,e:RB,f:w4e,g:I4e,G:T4e,H:x4e,I:y4e,j:b4e,L:AJ,m:j4e,M:_4e,p:be,q:V,Q:$B,s:BB,S:N4e,u:S4e,U:C4e,V:P4e,w:A4e,W:E4e,x:null,X:null,y:k4e,Y:O4e,Z:D4e,"%":FB},j={a:B,A:J,b:ue,B:Ne,c:null,d:LB,e:LB,f:F4e,g:K4e,G:Y4e,H:M4e,I:R4e,j:L4e,L:kJ,m:$4e,M:B4e,p:Z,q:ge,Q:$B,s:BB,S:q4e,u:z4e,U:U4e,V:V4e,w:W4e,W:H4e,x:null,X:null,y:G4e,Y:X4e,Z:J4e,"%":FB},_={a:F,A:M,b:I,B:R,c:D,d:DB,e:DB,f:h4e,g:TB,G:OB,H:MB,I:MB,j:d4e,L:m4e,m:c4e,M:u4e,p:P,q:l4e,Q:g4e,s:v4e,S:f4e,u:n4e,U:a4e,V:o4e,w:r4e,W:s4e,x:U,X:z,y:TB,Y:OB,Z:i4e,"%":p4e};w.x=C(r,w),w.X=C(n,w),w.c=C(t,w),j.x=C(r,j),j.X=C(n,j),j.c=C(t,j);function C(le,se){return function(ee){var de=[],Le=-1,ae=0,ie=le.length,dt,At,st;for(ee instanceof Date||(ee=new Date(+ee));++Le<ie;)le.charCodeAt(Le)===37&&(de.push(le.slice(ae,Le)),(At=IB[dt=le.charAt(++Le)])!=null?dt=le.charAt(++Le):At=dt==="e"?" ":"0",(st=se[dt])&&(dt=st(ee,At)),de.push(dt),ae=Le+1);return de.push(le.slice(ae,Le)),de.join("")}}function E(le,se){return function(ee){var de=oy(1900,void 0,1),Le=A(de,le,ee+="",0),ae,ie;if(Le!=ee.length)return null;if("Q"in de)return new Date(de.Q);if("s"in de)return new Date(de.s*1e3+("L"in de?de.L:0));if(se&&!("Z"in de)&&(de.Z=0),"p"in de&&(de.H=de.H%12+de.p*12),de.m===void 0&&(de.m="q"in de?de.q:0),"V"in de){if(de.V<1||de.V>53)return null;"w"in de||(de.w=1),"Z"in de?(ae=FA(oy(de.y,0,1)),ie=ae.getUTCDay(),ae=ie>4||ie===0?bN.ceil(ae):bN(ae),ae=VC.offset(ae,(de.V-1)*7),de.y=ae.getUTCFullYear(),de.m=ae.getUTCMonth(),de.d=ae.getUTCDate()+(de.w+6)%7):(ae=LA(oy(de.y,0,1)),ie=ae.getDay(),ae=ie>4||ie===0?yN.ceil(ae):yN(ae),ae=v1.offset(ae,(de.V-1)*7),de.y=ae.getFullYear(),de.m=ae.getMonth(),de.d=ae.getDate()+(de.w+6)%7)}else("W"in de||"U"in de)&&("w"in de||(de.w="u"in de?de.u%7:"W"in de?1:0),ie="Z"in de?FA(oy(de.y,0,1)).getUTCDay():LA(oy(de.y,0,1)).getDay(),de.m=0,de.d="W"in de?(de.w+6)%7+de.W*7-(ie+5)%7:de.w+de.U*7-(ie+6)%7);return"Z"in de?(de.H+=de.Z/100|0,de.M+=de.Z%100,FA(de)):LA(de)}}function A(le,se,ee,de){for(var Le=0,ae=se.length,ie=ee.length,dt,At;Le<ae;){if(de>=ie)return-1;if(dt=se.charCodeAt(Le++),dt===37){if(dt=se.charAt(Le++),At=_[dt in IB?se.charAt(Le++):dt],!At||(de=At(le,ee,de))<0)return-1}else if(dt!=ee.charCodeAt(de++))return-1}return de}function P(le,se,ee){var de=d.exec(se.slice(ee));return de?(le.p=u.get(de[0].toLowerCase()),ee+de[0].length):-1}function F(le,se,ee){var de=m.exec(se.slice(ee));return de?(le.w=v.get(de[0].toLowerCase()),ee+de[0].length):-1}function M(le,se,ee){var de=f.exec(se.slice(ee));return de?(le.w=h.get(de[0].toLowerCase()),ee+de[0].length):-1}function I(le,se,ee){var de=x.exec(se.slice(ee));return de?(le.m=b.get(de[0].toLowerCase()),ee+de[0].length):-1}function R(le,se,ee){var de=g.exec(se.slice(ee));return de?(le.m=y.get(de[0].toLowerCase()),ee+de[0].length):-1}function D(le,se,ee){return A(le,t,se,ee)}function U(le,se,ee){return A(le,r,se,ee)}function z(le,se,ee){return A(le,n,se,ee)}function H(le){return i[le.getDay()]}function q(le){return s[le.getDay()]}function Q(le){return c[le.getMonth()]}function pe(le){return l[le.getMonth()]}function be(le){return o[+(le.getHours()>=12)]}function V(le){return 1+~~(le.getMonth()/3)}function B(le){return i[le.getUTCDay()]}function J(le){return s[le.getUTCDay()]}function ue(le){return c[le.getUTCMonth()]}function Ne(le){return l[le.getUTCMonth()]}function Z(le){return o[+(le.getUTCHours()>=12)]}function ge(le){return 1+~~(le.getUTCMonth()/3)}return{format:function(le){var se=C(le+="",w);return se.toString=function(){return le},se},parse:function(le){var se=E(le+="",!1);return se.toString=function(){return le},se},utcFormat:function(le){var se=C(le+="",j);return se.toString=function(){return le},se},utcParse:function(le){var se=E(le+="",!0);return se.toString=function(){return le},se}}}var IB={"-":"",_:" ",0:"0"},ui=/^\s*\d+/,Z3e=/^%/,e4e=/[\\^$*+?|[\]().{}]/g;function Qa(e,t,r){var n=e<0?"-":"",o=(n?-e:e)+"",s=o.length;return n+(s<r?new Array(r-s+1).join(t)+o:o)}function t4e(e){return e.replace(e4e,"\\$&")}function sy(e){return new RegExp("^(?:"+e.map(t4e).join("|")+")","i")}function iy(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function r4e(e,t,r){var n=ui.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function n4e(e,t,r){var n=ui.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function a4e(e,t,r){var n=ui.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function o4e(e,t,r){var n=ui.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function s4e(e,t,r){var n=ui.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function OB(e,t,r){var n=ui.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function TB(e,t,r){var n=ui.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function i4e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function l4e(e,t,r){var n=ui.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function c4e(e,t,r){var n=ui.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function DB(e,t,r){var n=ui.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function d4e(e,t,r){var n=ui.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function MB(e,t,r){var n=ui.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function u4e(e,t,r){var n=ui.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function f4e(e,t,r){var n=ui.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function m4e(e,t,r){var n=ui.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function h4e(e,t,r){var n=ui.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function p4e(e,t,r){var n=Z3e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function g4e(e,t,r){var n=ui.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function v4e(e,t,r){var n=ui.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function RB(e,t){return Qa(e.getDate(),t,2)}function x4e(e,t){return Qa(e.getHours(),t,2)}function y4e(e,t){return Qa(e.getHours()%12||12,t,2)}function b4e(e,t){return Qa(1+v1.count(Hf(e),e),t,3)}function AJ(e,t){return Qa(e.getMilliseconds(),t,3)}function w4e(e,t){return AJ(e,t)+"000"}function j4e(e,t){return Qa(e.getMonth()+1,t,2)}function _4e(e,t){return Qa(e.getMinutes(),t,2)}function N4e(e,t){return Qa(e.getSeconds(),t,2)}function S4e(e){var t=e.getDay();return t===0?7:t}function C4e(e,t){return Qa(WC.count(Hf(e)-1,e),t,2)}function EJ(e){var t=e.getDay();return t>=4||t===0?Px(e):Px.ceil(e)}function P4e(e,t){return e=EJ(e),Qa(Px.count(Hf(e),e)+(Hf(e).getDay()===4),t,2)}function A4e(e){return e.getDay()}function E4e(e,t){return Qa(yN.count(Hf(e)-1,e),t,2)}function k4e(e,t){return Qa(e.getFullYear()%100,t,2)}function I4e(e,t){return e=EJ(e),Qa(e.getFullYear()%100,t,2)}function O4e(e,t){return Qa(e.getFullYear()%1e4,t,4)}function T4e(e,t){var r=e.getDay();return e=r>=4||r===0?Px(e):Px.ceil(e),Qa(e.getFullYear()%1e4,t,4)}function D4e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Qa(t/60|0,"0",2)+Qa(t%60,"0",2)}function LB(e,t){return Qa(e.getUTCDate(),t,2)}function M4e(e,t){return Qa(e.getUTCHours(),t,2)}function R4e(e,t){return Qa(e.getUTCHours()%12||12,t,2)}function L4e(e,t){return Qa(1+VC.count(Gf(e),e),t,3)}function kJ(e,t){return Qa(e.getUTCMilliseconds(),t,3)}function F4e(e,t){return kJ(e,t)+"000"}function $4e(e,t){return Qa(e.getUTCMonth()+1,t,2)}function B4e(e,t){return Qa(e.getUTCMinutes(),t,2)}function q4e(e,t){return Qa(e.getUTCSeconds(),t,2)}function z4e(e){var t=e.getUTCDay();return t===0?7:t}function U4e(e,t){return Qa(HC.count(Gf(e)-1,e),t,2)}function IJ(e){var t=e.getUTCDay();return t>=4||t===0?Ax(e):Ax.ceil(e)}function V4e(e,t){return e=IJ(e),Qa(Ax.count(Gf(e),e)+(Gf(e).getUTCDay()===4),t,2)}function W4e(e){return e.getUTCDay()}function H4e(e,t){return Qa(bN.count(Gf(e)-1,e),t,2)}function G4e(e,t){return Qa(e.getUTCFullYear()%100,t,2)}function K4e(e,t){return e=IJ(e),Qa(e.getUTCFullYear()%100,t,2)}function X4e(e,t){return Qa(e.getUTCFullYear()%1e4,t,4)}function Y4e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Ax(e):Ax.ceil(e),Qa(e.getUTCFullYear()%1e4,t,4)}function J4e(){return"+0000"}function FB(){return"%"}function $B(e){return+e}function BB(e){return Math.floor(+e/1e3)}var Xg,OJ,TJ;Q4e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Q4e(e){return Xg=Q3e(e),OJ=Xg.format,Xg.parse,TJ=Xg.utcFormat,Xg.utcParse,Xg}function Z4e(e){return new Date(e)}function eDe(e){return e instanceof Date?+e:+new Date(+e)}function VD(e,t,r,n,o,s,i,l,c,d){var u=kD(),f=u.invert,h=u.domain,m=d(".%L"),v=d(":%S"),g=d("%I:%M"),y=d("%I %p"),x=d("%a %d"),b=d("%b %d"),w=d("%B"),j=d("%Y");function _(C){return(c(C)<C?m:l(C)<C?v:i(C)<C?g:s(C)<C?y:n(C)<C?o(C)<C?x:b:r(C)<C?w:j)(C)}return u.invert=function(C){return new Date(f(C))},u.domain=function(C){return arguments.length?h(Array.from(C,eDe)):h().map(Z4e)},u.ticks=function(C){var E=h();return e(E[0],E[E.length-1],C??10)},u.tickFormat=function(C,E){return E==null?_:d(E)},u.nice=function(C){var E=h();return(!C||typeof C.range!="function")&&(C=t(E[0],E[E.length-1],C??10)),C?h(yJ(E,C)):u},u.copy=function(){return g1(u,VD(e,t,r,n,o,s,i,l,c,d))},u}function tDe(){return Ed.apply(VD(Y3e,J3e,Hf,zD,WC,v1,BD,FD,Sp,OJ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function rDe(){return Ed.apply(VD(K3e,X3e,Gf,UD,HC,VC,qD,$D,Sp,TJ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function GC(){var e=0,t=1,r,n,o,s,i=gl,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:i(o===0?.5:(f=(s(f)-r)*o,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),n=s(t=+t),o=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(i=f,d):i};function u(f){return function(h){var m,v;return arguments.length?([m,v]=h,i=f(m,v),d):[i(0),i(1)]}}return d.range=u(j0),d.rangeRound=u(ED),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return s=f,r=f(e),n=f(t),o=r===n?0:1/(n-r),d}}function Fh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function DJ(){var e=Lh(GC()(gl));return e.copy=function(){return Fh(e,DJ())},nm.apply(e,arguments)}function MJ(){var e=TD(GC()).domain([1,10]);return e.copy=function(){return Fh(e,MJ()).base(e.base())},nm.apply(e,arguments)}function RJ(){var e=DD(GC());return e.copy=function(){return Fh(e,RJ()).constant(e.constant())},nm.apply(e,arguments)}function WD(){var e=MD(GC());return e.copy=function(){return Fh(e,WD()).exponent(e.exponent())},nm.apply(e,arguments)}function nDe(){return WD.apply(null,arguments).exponent(.5)}function LJ(){var e=[],t=gl;function r(n){if(n!=null&&!isNaN(n=+n))return t((h1(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let o of n)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(ch),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,o)=>t(o/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(o,s)=>UTe(e,s/n))},r.copy=function(){return LJ(t).domain(e)},nm.apply(r,arguments)}function KC(){var e=0,t=.5,r=1,n=1,o,s,i,l,c,d=gl,u,f=!1,h;function m(g){return isNaN(g=+g)?h:(g=.5+((g=+u(g))-s)*(n*g<n*s?l:c),d(f?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([e,t,r]=g,o=u(e=+e),s=u(t=+t),i=u(r=+r),l=o===s?0:.5/(s-o),c=s===i?0:.5/(i-s),n=s<o?-1:1,m):[e,t,r]},m.clamp=function(g){return arguments.length?(f=!!g,m):f},m.interpolator=function(g){return arguments.length?(d=g,m):d};function v(g){return function(y){var x,b,w;return arguments.length?([x,b,w]=y,d=p3e(g,[x,b,w]),m):[d(0),d(.5),d(1)]}}return m.range=v(j0),m.rangeRound=v(ED),m.unknown=function(g){return arguments.length?(h=g,m):h},function(g){return u=g,o=g(e),s=g(t),i=g(r),l=o===s?0:.5/(s-o),c=s===i?0:.5/(i-s),n=s<o?-1:1,m}}function FJ(){var e=Lh(KC()(gl));return e.copy=function(){return Fh(e,FJ())},nm.apply(e,arguments)}function $J(){var e=TD(KC()).domain([.1,1,10]);return e.copy=function(){return Fh(e,$J()).base(e.base())},nm.apply(e,arguments)}function BJ(){var e=DD(KC());return e.copy=function(){return Fh(e,BJ()).constant(e.constant())},nm.apply(e,arguments)}function HD(){var e=MD(KC());return e.copy=function(){return Fh(e,HD()).exponent(e.exponent())},nm.apply(e,arguments)}function aDe(){return HD.apply(null,arguments).exponent(.5)}const qB=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:nw,scaleDiverging:FJ,scaleDivergingLog:$J,scaleDivergingPow:HD,scaleDivergingSqrt:aDe,scaleDivergingSymlog:BJ,scaleIdentity:xJ,scaleImplicit:lO,scaleLinear:vN,scaleLog:bJ,scaleOrdinal:CD,scalePoint:Zy,scalePow:RD,scaleQuantile:_J,scaleQuantize:NJ,scaleRadial:jJ,scaleSequential:DJ,scaleSequentialLog:MJ,scaleSequentialPow:WD,scaleSequentialQuantile:LJ,scaleSequentialSqrt:nDe,scaleSequentialSymlog:RJ,scaleSqrt:F3e,scaleSymlog:wJ,scaleThreshold:SJ,scaleTime:tDe,scaleUtc:rDe,tickFormat:vJ},Symbol.toStringTag,{value:"Module"}));var oDe=m0;function sDe(e,t,r){for(var n=-1,o=e.length;++n<o;){var s=e[n],i=t(s);if(i!=null&&(l===void 0?i===i&&!oDe(i):r(i,l)))var l=i,c=s}return c}var XC=sDe;function iDe(e,t){return e>t}var qJ=iDe,lDe=XC,cDe=qJ,dDe=w0;function uDe(e){return e&&e.length?lDe(e,dDe,cDe):void 0}var fDe=uDe;const Um=Ga(fDe);function mDe(e,t){return e<t}var zJ=mDe,hDe=XC,pDe=zJ,gDe=w0;function vDe(e){return e&&e.length?hDe(e,gDe,pDe):void 0}var xDe=vDe;const YC=Ga(xDe);var yDe=sD,bDe=Zu,wDe=YY,jDe=Jl;function _De(e,t){var r=jDe(e)?yDe:wDe;return r(e,bDe(t))}var NDe=_De,SDe=KY,CDe=NDe;function PDe(e,t){return SDe(CDe(e,t),1)}var ADe=PDe;const EDe=Ga(ADe);var kDe=wD;function IDe(e,t){return kDe(e,t)}var ODe=IDe;const og=Ga(ODe);var _0=1e9,TDe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},KD,Xo=!0,Sd="[DecimalError] ",$p=Sd+"Invalid argument: ",GD=Sd+"Exponent out of range: ",N0=Math.floor,dp=Math.pow,DDe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,bc,oi=1e7,zo=7,UJ=9007199254740991,wN=N0(UJ/zo),Dn={};Dn.absoluteValue=Dn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Dn.comparedTo=Dn.cmp=function(e){var t,r,n,o,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,o=e.d.length,t=0,r=n<o?n:o;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===o?0:n>o^s.s<0?1:-1};Dn.decimalPlaces=Dn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*zo;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Dn.dividedBy=Dn.div=function(e){return Rf(this,new this.constructor(e))};Dn.dividedToIntegerBy=Dn.idiv=function(e){var t=this,r=t.constructor;return No(Rf(t,new r(e),0,1),r.precision)};Dn.equals=Dn.eq=function(e){return!this.cmp(e)};Dn.exponent=function(){return Ms(this)};Dn.greaterThan=Dn.gt=function(e){return this.cmp(e)>0};Dn.greaterThanOrEqualTo=Dn.gte=function(e){return this.cmp(e)>=0};Dn.isInteger=Dn.isint=function(){return this.e>this.d.length-2};Dn.isNegative=Dn.isneg=function(){return this.s<0};Dn.isPositive=Dn.ispos=function(){return this.s>0};Dn.isZero=function(){return this.s===0};Dn.lessThan=Dn.lt=function(e){return this.cmp(e)<0};Dn.lessThanOrEqualTo=Dn.lte=function(e){return this.cmp(e)<1};Dn.logarithm=Dn.log=function(e){var t,r=this,n=r.constructor,o=n.precision,s=o+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(bc))throw Error(Sd+"NaN");if(r.s<1)throw Error(Sd+(r.s?"NaN":"-Infinity"));return r.eq(bc)?new n(0):(Xo=!1,t=Rf(lw(r,s),lw(e,s),s),Xo=!0,No(t,o))};Dn.minus=Dn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?HJ(t,e):VJ(t,(e.s=-e.s,e))};Dn.modulo=Dn.mod=function(e){var t,r=this,n=r.constructor,o=n.precision;if(e=new n(e),!e.s)throw Error(Sd+"NaN");return r.s?(Xo=!1,t=Rf(r,e,0,1).times(e),Xo=!0,r.minus(t)):No(new n(r),o)};Dn.naturalExponential=Dn.exp=function(){return WJ(this)};Dn.naturalLogarithm=Dn.ln=function(){return lw(this)};Dn.negated=Dn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Dn.plus=Dn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?VJ(t,e):HJ(t,(e.s=-e.s,e))};Dn.precision=Dn.sd=function(e){var t,r,n,o=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error($p+e);if(t=Ms(o)+1,n=o.d.length-1,r=n*zo+1,n=o.d[n],n){for(;n%10==0;n/=10)r--;for(n=o.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Dn.squareRoot=Dn.sqrt=function(){var e,t,r,n,o,s,i,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Sd+"NaN")}for(e=Ms(l),Xo=!1,o=Math.sqrt(+l),o==0||o==1/0?(t=Du(l.d),(t.length+e)%2==0&&(t+="0"),o=Math.sqrt(t),e=N0((e+1)/2)-(e<0||e%2),o==1/0?t="5e"+e:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(o.toString()),r=c.precision,o=i=r+3;;)if(s=n,n=s.plus(Rf(l,s,i+2)).times(.5),Du(s.d).slice(0,i)===(t=Du(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),o==i&&t=="4999"){if(No(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(t!="9999")break;i+=4}return Xo=!0,No(n,r)};Dn.times=Dn.mul=function(e){var t,r,n,o,s,i,l,c,d,u=this,f=u.constructor,h=u.d,m=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=h.length,d=m.length,c<d&&(s=h,h=m,m=s,i=c,c=d,d=i),s=[],i=c+d,n=i;n--;)s.push(0);for(n=d;--n>=0;){for(t=0,o=c+n;o>n;)l=s[o]+m[n]*h[o-n-1]+t,s[o--]=l%oi|0,t=l/oi|0;s[o]=(s[o]+t)%oi|0}for(;!s[--i];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,Xo?No(e,f.precision):e};Dn.toDecimalPlaces=Dn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Xu(e,0,_0),t===void 0?t=n.rounding:Xu(t,0,8),No(r,e+Ms(r)+1,t))};Dn.toExponential=function(e,t){var r,n=this,o=n.constructor;return e===void 0?r=sg(n,!0):(Xu(e,0,_0),t===void 0?t=o.rounding:Xu(t,0,8),n=No(new o(n),e+1,t),r=sg(n,!0,e+1)),r};Dn.toFixed=function(e,t){var r,n,o=this,s=o.constructor;return e===void 0?sg(o):(Xu(e,0,_0),t===void 0?t=s.rounding:Xu(t,0,8),n=No(new s(o),e+Ms(o)+1,t),r=sg(n.abs(),!1,e+Ms(n)+1),o.isneg()&&!o.isZero()?"-"+r:r)};Dn.toInteger=Dn.toint=function(){var e=this,t=e.constructor;return No(new t(e),Ms(e)+1,t.rounding)};Dn.toNumber=function(){return+this};Dn.toPower=Dn.pow=function(e){var t,r,n,o,s,i,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(bc);if(l=new c(l),!l.s){if(e.s<1)throw Error(Sd+"Infinity");return l}if(l.eq(bc))return l;if(n=c.precision,e.eq(bc))return No(l,n);if(t=e.e,r=e.d.length-1,i=t>=r,s=l.s,i){if((r=u<0?-u:u)<=UJ){for(o=new c(bc),t=Math.ceil(n/zo+4),Xo=!1;r%2&&(o=o.times(l),UB(o.d,t)),r=N0(r/2),r!==0;)l=l.times(l),UB(l.d,t);return Xo=!0,e.s<0?new c(bc).div(o):No(o,n)}}else if(s<0)throw Error(Sd+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Xo=!1,o=e.times(lw(l,n+d)),Xo=!0,o=WJ(o),o.s=s,o};Dn.toPrecision=function(e,t){var r,n,o=this,s=o.constructor;return e===void 0?(r=Ms(o),n=sg(o,r<=s.toExpNeg||r>=s.toExpPos)):(Xu(e,1,_0),t===void 0?t=s.rounding:Xu(t,0,8),o=No(new s(o),e,t),r=Ms(o),n=sg(o,e<=r||r<=s.toExpNeg,e)),n};Dn.toSignificantDigits=Dn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Xu(e,1,_0),t===void 0?t=n.rounding:Xu(t,0,8)),No(new n(r),e,t)};Dn.toString=Dn.valueOf=Dn.val=Dn.toJSON=Dn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ms(e),r=e.constructor;return sg(e,t<=r.toExpNeg||t>=r.toExpPos)};function VJ(e,t){var r,n,o,s,i,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Xo?No(t,f):t;if(c=e.d,d=t.d,i=e.e,o=t.e,c=c.slice(),s=i-o,s){for(s<0?(n=c,s=-s,l=d.length):(n=d,o=i,l=c.length),i=Math.ceil(f/zo),l=i>l?i+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=d.length,l-s<0&&(s=l,n=d,d=c,c=n),r=0;s;)r=(c[--s]=c[s]+d[s]+r)/oi|0,c[s]%=oi;for(r&&(c.unshift(r),++o),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=o,Xo?No(t,f):t}function Xu(e,t,r){if(e!==~~e||e<t||e>r)throw Error($p+e)}function Du(e){var t,r,n,o=e.length-1,s="",i=e[0];if(o>0){for(s+=i,t=1;t<o;t++)n=e[t]+"",r=zo-n.length,r&&(s+=km(r)),s+=n;i=e[t],n=i+"",r=zo-n.length,r&&(s+=km(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return s+i}var Rf=function(){function e(n,o){var s,i=0,l=n.length;for(n=n.slice();l--;)s=n[l]*o+i,n[l]=s%oi|0,i=s/oi|0;return i&&n.unshift(i),n}function t(n,o,s,i){var l,c;if(s!=i)c=s>i?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=o[l]){c=n[l]>o[l]?1:-1;break}return c}function r(n,o,s){for(var i=0;s--;)n[s]-=i,i=n[s]<o[s]?1:0,n[s]=i*oi+n[s]-o[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,o,s,i){var l,c,d,u,f,h,m,v,g,y,x,b,w,j,_,C,E,A,P=n.constructor,F=n.s==o.s?1:-1,M=n.d,I=o.d;if(!n.s)return new P(n);if(!o.s)throw Error(Sd+"Division by zero");for(c=n.e-o.e,E=I.length,_=M.length,m=new P(F),v=m.d=[],d=0;I[d]==(M[d]||0);)++d;if(I[d]>(M[d]||0)&&--c,s==null?b=s=P.precision:i?b=s+(Ms(n)-Ms(o))+1:b=s,b<0)return new P(0);if(b=b/zo+2|0,d=0,E==1)for(u=0,I=I[0],b++;(d<_||u)&&b--;d++)w=u*oi+(M[d]||0),v[d]=w/I|0,u=w%I|0;else{for(u=oi/(I[0]+1)|0,u>1&&(I=e(I,u),M=e(M,u),E=I.length,_=M.length),j=E,g=M.slice(0,E),y=g.length;y<E;)g[y++]=0;A=I.slice(),A.unshift(0),C=I[0],I[1]>=oi/2&&++C;do u=0,l=t(I,g,E,y),l<0?(x=g[0],E!=y&&(x=x*oi+(g[1]||0)),u=x/C|0,u>1?(u>=oi&&(u=oi-1),f=e(I,u),h=f.length,y=g.length,l=t(f,g,h,y),l==1&&(u--,r(f,E<h?A:I,h))):(u==0&&(l=u=1),f=I.slice()),h=f.length,h<y&&f.unshift(0),r(g,f,y),l==-1&&(y=g.length,l=t(I,g,E,y),l<1&&(u++,r(g,E<y?A:I,y))),y=g.length):l===0&&(u++,g=[0]),v[d++]=u,l&&g[0]?g[y++]=M[j]||0:(g=[M[j]],y=1);while((j++<_||g[0]!==void 0)&&b--)}return v[0]||v.shift(),m.e=c,No(m,i?s+Ms(m)+1:s)}}();function WJ(e,t){var r,n,o,s,i,l,c=0,d=0,u=e.constructor,f=u.precision;if(Ms(e)>16)throw Error(GD+Ms(e));if(!e.s)return new u(bc);for(t==null?(Xo=!1,l=f):l=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),d+=5;for(n=Math.log(dp(2,d))/Math.LN10*2+5|0,l+=n,r=o=s=new u(bc),u.precision=l;;){if(o=No(o.times(e),l),r=r.times(++c),i=s.plus(Rf(o,r,l)),Du(i.d).slice(0,l)===Du(s.d).slice(0,l)){for(;d--;)s=No(s.times(s),l);return u.precision=f,t==null?(Xo=!0,No(s,f)):s}s=i}}function Ms(e){for(var t=e.e*zo,r=e.d[0];r>=10;r/=10)t++;return t}function $A(e,t,r){if(t>e.LN10.sd())throw Xo=!0,r&&(e.precision=r),Error(Sd+"LN10 precision limit exceeded");return No(new e(e.LN10),t)}function km(e){for(var t="";e--;)t+="0";return t}function lw(e,t){var r,n,o,s,i,l,c,d,u,f=1,h=10,m=e,v=m.d,g=m.constructor,y=g.precision;if(m.s<1)throw Error(Sd+(m.s?"NaN":"-Infinity"));if(m.eq(bc))return new g(0);if(t==null?(Xo=!1,d=y):d=t,m.eq(10))return t==null&&(Xo=!0),$A(g,d);if(d+=h,g.precision=d,r=Du(v),n=r.charAt(0),s=Ms(m),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=Du(m.d),n=r.charAt(0),f++;s=Ms(m),n>1?(m=new g("0."+r),s++):m=new g(n+"."+r.slice(1))}else return c=$A(g,d+2,y).times(s+""),m=lw(new g(n+"."+r.slice(1)),d-h).plus(c),g.precision=y,t==null?(Xo=!0,No(m,y)):m;for(l=i=m=Rf(m.minus(bc),m.plus(bc),d),u=No(m.times(m),d),o=3;;){if(i=No(i.times(u),d),c=l.plus(Rf(i,new g(o),d)),Du(c.d).slice(0,d)===Du(l.d).slice(0,d))return l=l.times(2),s!==0&&(l=l.plus($A(g,d+2,y).times(s+""))),l=Rf(l,new g(f),d),g.precision=y,t==null?(Xo=!0,No(l,y)):l;l=c,o+=2}}function zB(e,t){var r,n,o;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(o=t.length;t.charCodeAt(o-1)===48;)--o;if(t=t.slice(n,o),t){if(o-=n,r=r-n-1,e.e=N0(r/zo),e.d=[],n=(r+1)%zo,r<0&&(n+=zo),n<o){for(n&&e.d.push(+t.slice(0,n)),o-=zo;n<o;)e.d.push(+t.slice(n,n+=zo));t=t.slice(n),n=zo-t.length}else n-=o;for(;n--;)t+="0";if(e.d.push(+t),Xo&&(e.e>wN||e.e<-wN))throw Error(GD+r)}else e.s=0,e.e=0,e.d=[0];return e}function No(e,t,r){var n,o,s,i,l,c,d,u,f=e.d;for(i=1,s=f[0];s>=10;s/=10)i++;if(n=t-i,n<0)n+=zo,o=t,d=f[u=0];else{if(u=Math.ceil((n+1)/zo),s=f.length,u>=s)return e;for(d=s=f[u],i=1;s>=10;s/=10)i++;n%=zo,o=n-zo+i}if(r!==void 0&&(s=dp(10,i-o-1),l=d/s%10|0,c=t<0||f[u+1]!==void 0||d%s,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?o>0?d/dp(10,i-o):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(s=Ms(e),f.length=1,t=t-s-1,f[0]=dp(10,(zo-t%zo)%zo),e.e=N0(-t/zo)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,s=1,u--):(f.length=u+1,s=dp(10,zo-n),f[u]=o>0?(d/dp(10,i-o)%dp(10,o)|0)*s:0),c)for(;;)if(u==0){(f[0]+=s)==oi&&(f[0]=1,++e.e);break}else{if(f[u]+=s,f[u]!=oi)break;f[u--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(Xo&&(e.e>wN||e.e<-wN))throw Error(GD+Ms(e));return e}function HJ(e,t){var r,n,o,s,i,l,c,d,u,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Xo?No(t,m):t;if(c=e.d,f=t.d,n=t.e,d=e.e,c=c.slice(),i=d-n,i){for(u=i<0,u?(r=c,i=-i,l=f.length):(r=f,n=d,l=c.length),o=Math.max(Math.ceil(m/zo),l)+2,i>o&&(i=o,r.length=1),r.reverse(),o=i;o--;)r.push(0);r.reverse()}else{for(o=c.length,l=f.length,u=o<l,u&&(l=o),o=0;o<l;o++)if(c[o]!=f[o]){u=c[o]<f[o];break}i=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,o=f.length-l;o>0;--o)c[l++]=0;for(o=f.length;o>i;){if(c[--o]<f[o]){for(s=o;s&&c[--s]===0;)c[s]=oi-1;--c[s],c[o]+=oi}c[o]-=f[o]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Xo?No(t,m):t):new h(0)}function sg(e,t,r){var n,o=Ms(e),s=Du(e.d),i=s.length;return t?(r&&(n=r-i)>0?s=s.charAt(0)+"."+s.slice(1)+km(n):i>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(o<0?"e":"e+")+o):o<0?(s="0."+km(-o-1)+s,r&&(n=r-i)>0&&(s+=km(n))):o>=i?(s+=km(o+1-i),r&&(n=r-o-1)>0&&(s=s+"."+km(n))):((n=o+1)<i&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-i)>0&&(o+1===i&&(s+="."),s+=km(n))),e.s<0?"-"+s:s}function UB(e,t){if(e.length>t)return e.length=t,!0}function GJ(e){var t,r,n;function o(s){var i=this;if(!(i instanceof o))return new o(s);if(i.constructor=o,s instanceof o){i.s=s.s,i.e=s.e,i.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error($p+s);if(s>0)i.s=1;else if(s<0)s=-s,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(s===~~s&&s<1e7){i.e=0,i.d=[s];return}return zB(i,s.toString())}else if(typeof s!="string")throw Error($p+s);if(s.charCodeAt(0)===45?(s=s.slice(1),i.s=-1):i.s=1,DDe.test(s))zB(i,s);else throw Error($p+s)}if(o.prototype=Dn,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=GJ,o.config=o.set=MDe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return o.config(e),o}function MDe(e){if(!e||typeof e!="object")throw Error(Sd+"Object expected");var t,r,n,o=["precision",1,_0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<o.length;t+=3)if((n=e[r=o[t]])!==void 0)if(N0(n)===n&&n>=o[t+1]&&n<=o[t+2])this[r]=n;else throw Error($p+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error($p+r+": "+n);return this}var KD=GJ(TDe);bc=new KD(1);const vo=KD;function RDe(e){return BDe(e)||$De(e)||FDe(e)||LDe()}function LDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FDe(e,t){if(e){if(typeof e=="string")return fO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fO(e,t)}}function $De(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function BDe(e){if(Array.isArray(e))return fO(e)}function fO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qDe=function(t){return t},KJ={"@@functional/placeholder":!0},XJ=function(t){return t===KJ},VB=function(t){return function r(){return arguments.length===0||arguments.length===1&&XJ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},zDe=function e(t,r){return t===1?r:VB(function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];var i=o.filter(function(l){return l!==KJ}).length;return i>=t?r.apply(void 0,o):e(t-i,VB(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=o.map(function(f){return XJ(f)?c.shift():f});return r.apply(void 0,RDe(u).concat(c))}))})},JC=function(t){return zDe(t.length,t)},mO=function(t,r){for(var n=[],o=t;o<r;++o)n[o-t]=o;return n},UDe=JC(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),VDe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return qDe;var o=r.reverse(),s=o[0],i=o.slice(1);return function(){return i.reduce(function(l,c){return c(l)},s.apply(void 0,arguments))}},hO=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},YJ=function(t){var r=null,n=null;return function(){for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r&&s.every(function(l,c){return l===r[c]})||(r=s,n=t.apply(void 0,s)),n}};function WDe(e){var t;return e===0?t=1:t=Math.floor(new vo(e).abs().log(10).toNumber())+1,t}function HDe(e,t,r){for(var n=new vo(e),o=0,s=[];n.lt(t)&&o<1e5;)s.push(n.toNumber()),n=n.add(r),o++;return s}var GDe=JC(function(e,t,r){var n=+e,o=+t;return n+r*(o-n)}),KDe=JC(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),XDe=JC(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const QC={rangeStep:HDe,getDigitCount:WDe,interpolateNumber:GDe,uninterpolateNumber:KDe,uninterpolateTruncation:XDe};function pO(e){return QDe(e)||JDe(e)||JJ(e)||YDe()}function YDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JDe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function QDe(e){if(Array.isArray(e))return gO(e)}function cw(e,t){return tMe(e)||eMe(e,t)||JJ(e,t)||ZDe()}function ZDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JJ(e,t){if(e){if(typeof e=="string")return gO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gO(e,t)}}function gO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eMe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,o=!1,s=void 0;try{for(var i=e[Symbol.iterator](),l;!(n=(l=i.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){o=!0,s=c}finally{try{!n&&i.return!=null&&i.return()}finally{if(o)throw s}}return r}}function tMe(e){if(Array.isArray(e))return e}function QJ(e){var t=cw(e,2),r=t[0],n=t[1],o=r,s=n;return r>n&&(o=n,s=r),[o,s]}function ZJ(e,t,r){if(e.lte(0))return new vo(0);var n=QC.getDigitCount(e.toNumber()),o=new vo(10).pow(n),s=e.div(o),i=n!==1?.05:.1,l=new vo(Math.ceil(s.div(i).toNumber())).add(r).mul(i),c=l.mul(o);return t?c:new vo(Math.ceil(c))}function rMe(e,t,r){var n=1,o=new vo(e);if(!o.isint()&&r){var s=Math.abs(e);s<1?(n=new vo(10).pow(QC.getDigitCount(e)-1),o=new vo(Math.floor(o.div(n).toNumber())).mul(n)):s>1&&(o=new vo(Math.floor(e)))}else e===0?o=new vo(Math.floor((t-1)/2)):r||(o=new vo(Math.floor(e)));var i=Math.floor((t-1)/2),l=VDe(UDe(function(c){return o.add(new vo(c-i).mul(n)).toNumber()}),mO);return l(0,t)}function eQ(e,t,r,n){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new vo(0),tickMin:new vo(0),tickMax:new vo(0)};var s=ZJ(new vo(t).sub(e).div(r-1),n,o),i;e<=0&&t>=0?i=new vo(0):(i=new vo(e).add(t).div(2),i=i.sub(new vo(i).mod(s)));var l=Math.ceil(i.sub(e).div(s).toNumber()),c=Math.ceil(new vo(t).sub(i).div(s).toNumber()),d=l+c+1;return d>r?eQ(e,t,r,n,o+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:s,tickMin:i.sub(new vo(l).mul(s)),tickMax:i.add(new vo(c).mul(s))})}function nMe(e){var t=cw(e,2),r=t[0],n=t[1],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(o,2),l=QJ([r,n]),c=cw(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var f=u===1/0?[d].concat(pO(mO(0,o-1).map(function(){return 1/0}))):[].concat(pO(mO(0,o-1).map(function(){return-1/0})),[u]);return r>n?hO(f):f}if(d===u)return rMe(d,o,s);var h=eQ(d,u,i,s),m=h.step,v=h.tickMin,g=h.tickMax,y=QC.rangeStep(v,g.add(new vo(.1).mul(m)),m);return r>n?hO(y):y}function aMe(e,t){var r=cw(e,2),n=r[0],o=r[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=QJ([n,o]),l=cw(i,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[n,o];if(c===d)return[c];var u=Math.max(t,2),f=ZJ(new vo(d).sub(c).div(u-1),s,0),h=[].concat(pO(QC.rangeStep(new vo(c),new vo(d).sub(new vo(.99).mul(f)),f)),[d]);return n>o?hO(h):h}var oMe=YJ(nMe),sMe=YJ(aMe),iMe=!0,BA="Invariant failed";function Nh(e,t){if(!e){if(iMe)throw new Error(BA);var r=typeof t=="function"?t():t,n=r?"".concat(BA,": ").concat(r):BA;throw new Error(n)}}var lMe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ex(e){"@babel/helpers - typeof";return Ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ex(e)}function jN(){return jN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jN.apply(this,arguments)}function cMe(e,t){return mMe(e)||fMe(e,t)||uMe(e,t)||dMe()}function dMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uMe(e,t){if(e){if(typeof e=="string")return WB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WB(e,t)}}function WB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function mMe(e){if(Array.isArray(e))return e}function hMe(e,t){if(e==null)return{};var r=pMe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pMe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function gMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nQ(n.key),n)}}function vMe(e,t,r){return t&&HB(e.prototype,t),r&&HB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xMe(e,t,r){return t=_N(t),yMe(e,tQ()?Reflect.construct(t,r||[],_N(e).constructor):t.apply(e,r))}function yMe(e,t){if(t&&(Ex(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bMe(e)}function bMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tQ=function(){return!!e})()}function _N(e){return _N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_N(e)}function wMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vO(e,t)}function vO(e,t){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vO(e,t)}function rQ(e,t,r){return t=nQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nQ(e){var t=jMe(e,"string");return Ex(t)=="symbol"?t:t+""}function jMe(e,t){if(Ex(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ex(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x1=function(e){function t(){return gMe(this,t),xMe(this,t,arguments)}return wMe(t,e),vMe(t,[{key:"render",value:function(){var n=this.props,o=n.offset,s=n.layout,i=n.width,l=n.dataKey,c=n.data,d=n.dataPointFormatter,u=n.xAxis,f=n.yAxis,h=hMe(n,lMe),m=Kn(h,!1);this.props.direction==="x"&&u.type!=="number"&&Nh(!1);var v=c.map(function(g){var y=d(g,l),x=y.x,b=y.y,w=y.value,j=y.errorVal;if(!j)return null;var _=[],C,E;if(Array.isArray(j)){var A=cMe(j,2);C=A[0],E=A[1]}else C=E=j;if(s==="vertical"){var P=u.scale,F=b+o,M=F+i,I=F-i,R=P(w-C),D=P(w+E);_.push({x1:D,y1:M,x2:D,y2:I}),_.push({x1:R,y1:F,x2:D,y2:F}),_.push({x1:R,y1:M,x2:R,y2:I})}else if(s==="horizontal"){var U=f.scale,z=x+o,H=z-i,q=z+i,Q=U(w-C),pe=U(w+E);_.push({x1:H,y1:pe,x2:q,y2:pe}),_.push({x1:z,y1:Q,x2:z,y2:pe}),_.push({x1:H,y1:Q,x2:q,y2:Q})}return _e.createElement(Ta,jN({className:"recharts-errorBar",key:"bar-".concat(_.map(function(be){return"".concat(be.x1,"-").concat(be.x2,"-").concat(be.y1,"-").concat(be.y2)}))},m),_.map(function(be){return _e.createElement("line",jN({},be,{key:"line-".concat(be.x1,"-").concat(be.x2,"-").concat(be.y1,"-").concat(be.y2)}))}))});return _e.createElement(Ta,{className:"recharts-errorBars"},v)}}])}(_e.Component);rQ(x1,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});rQ(x1,"displayName","ErrorBar");function dw(e){"@babel/helpers - typeof";return dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dw(e)}function GB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Yh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GB(Object(r),!0).forEach(function(n){_Me(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Me(e,t,r){return t=NMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NMe(e){var t=SMe(e,"string");return dw(t)=="symbol"?t:t+""}function SMe(e,t){if(dw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aQ=function(t){var r=t.children,n=t.formattedGraphicalItems,o=t.legendWidth,s=t.legendContent,i=gc(r,Lp);if(!i)return null;var l=Lp.defaultProps,c=l!==void 0?Yh(Yh({},l),i.props):{},d;return i.props&&i.props.payload?d=i.props&&i.props.payload:s==="children"?d=(n||[]).reduce(function(u,f){var h=f.item,m=f.props,v=m.sectors||m.data||[];return u.concat(v.map(function(g){return{type:i.props.iconType||h.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):d=(n||[]).map(function(u){var f=u.item,h=f.type.defaultProps,m=h!==void 0?Yh(Yh({},h),f.props):{},v=m.dataKey,g=m.name,y=m.legendType,x=m.hide;return{inactive:x,dataKey:v,type:c.iconType||y||"square",color:XD(f),value:g||v,payload:m}}),Yh(Yh(Yh({},c),Lp.getWithHeight(i,o)),{},{payload:d,item:i})};function uw(e){"@babel/helpers - typeof";return uw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uw(e)}function KB(e){return EMe(e)||AMe(e)||PMe(e)||CMe()}function CMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PMe(e,t){if(e){if(typeof e=="string")return xO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(e,t)}}function AMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EMe(e){if(Array.isArray(e))return xO(e)}function xO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function hs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XB(Object(r),!0).forEach(function(n){ex(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ex(e,t,r){return t=kMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kMe(e){var t=IMe(e,"string");return uw(t)=="symbol"?t:t+""}function IMe(e,t){if(uw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _s(e,t,r){return ua(e)||ua(t)?r:Js(t)?Ec(e,t,r):na(t)?t(e):r}function eb(e,t,r,n){var o=EDe(e,function(l){return _s(l,t)});if(r==="number"){var s=o.filter(function(l){return en(l)||parseFloat(l)});return s.length?[YC(s),Um(s)]:[1/0,-1/0]}var i=n?o.filter(function(l){return!ua(l)}):o;return i.map(function(l){return Js(l)||l instanceof Date?l:""})}var OMe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,i=-1,l=(r=n?.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(s&&s.axisType==="angleAxis"&&Math.abs(Math.abs(s.range[1]-s.range[0])-360)<=1e-6)for(var c=s.range,d=0;d<l;d++){var u=d>0?o[d-1].coordinate:o[l-1].coordinate,f=o[d].coordinate,h=d>=l-1?o[0].coordinate:o[d+1].coordinate,m=void 0;if(hl(f-u)!==hl(h-f)){var v=[];if(hl(h-f)===hl(c[1]-c[0])){m=h;var g=f+c[1]-c[0];v[0]=Math.min(g,(g+u)/2),v[1]=Math.max(g,(g+u)/2)}else{m=u;var y=h+c[1]-c[0];v[0]=Math.min(f,(y+f)/2),v[1]=Math.max(f,(y+f)/2)}var x=[Math.min(f,(m+f)/2),Math.max(f,(m+f)/2)];if(t>x[0]&&t<=x[1]||t>=v[0]&&t<=v[1]){i=o[d].index;break}}else{var b=Math.min(u,h),w=Math.max(u,h);if(t>(b+f)/2&&t<=(w+f)/2){i=o[d].index;break}}}else for(var j=0;j<l;j++)if(j===0&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j>0&&j<l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j===l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2){i=n[j].index;break}return i},XD=function(t){var r,n=t,o=n.type.displayName,s=(r=t.type)!==null&&r!==void 0&&r.defaultProps?hs(hs({},t.type.defaultProps),t.props):t.props,i=s.stroke,l=s.fill,c;switch(o){case"Line":c=i;break;case"Area":case"Radar":c=i&&i!=="none"?i:l;break;default:c=l;break}return c},TMe=function(t){var r=t.barSize,n=t.totalSize,o=t.stackGroups,s=o===void 0?{}:o;if(!s)return{};for(var i={},l=Object.keys(s),c=0,d=l.length;c<d;c++)for(var u=s[l[c]].stackGroups,f=Object.keys(u),h=0,m=f.length;h<m;h++){var v=u[f[h]],g=v.items,y=v.cateAxisId,x=g.filter(function(E){return Mf(E.type).indexOf("Bar")>=0});if(x&&x.length){var b=x[0].type.defaultProps,w=b!==void 0?hs(hs({},b),x[0].props):x[0].props,j=w.barSize,_=w[y];i[_]||(i[_]=[]);var C=ua(j)?r:j;i[_].push({item:x[0],stackList:x.slice(1),barSize:ua(C)?void 0:pl(C,n,0)})}}return i},DMe=function(t){var r=t.barGap,n=t.barCategoryGap,o=t.bandSize,s=t.sizeList,i=s===void 0?[]:s,l=t.maxBarSize,c=i.length;if(c<1)return null;var d=pl(r,o,0,!0),u,f=[];if(i[0].barSize===+i[0].barSize){var h=!1,m=o/c,v=i.reduce(function(j,_){return j+_.barSize||0},0);v+=(c-1)*d,v>=o&&(v-=(c-1)*d,d=0),v>=o&&m>0&&(h=!0,m*=.9,v=c*m);var g=(o-v)/2>>0,y={offset:g-d,size:0};u=i.reduce(function(j,_){var C={item:_.item,position:{offset:y.offset+y.size+d,size:h?m:_.barSize}},E=[].concat(KB(j),[C]);return y=E[E.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(A){E.push({item:A,position:y})}),E},f)}else{var x=pl(n,o,0,!0);o-2*x-(c-1)*d<=0&&(d=0);var b=(o-2*x-(c-1)*d)/c;b>1&&(b>>=0);var w=l===+l?Math.min(b,l):b;u=i.reduce(function(j,_,C){var E=[].concat(KB(j),[{item:_.item,position:{offset:x+(b+d)*C+(b-w)/2,size:w}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(A){E.push({item:A,position:E[E.length-1].position})}),E},f)}return u},MMe=function(t,r,n,o){var s=n.children,i=n.width,l=n.margin,c=i-(l.left||0)-(l.right||0),d=aQ({children:s,legendWidth:c});if(d){var u=o||{},f=u.width,h=u.height,m=d.align,v=d.verticalAlign,g=d.layout;if((g==="vertical"||g==="horizontal"&&v==="middle")&&m!=="center"&&en(t[m]))return hs(hs({},t),{},ex({},m,t[m]+(f||0)));if((g==="horizontal"||g==="vertical"&&m==="center")&&v!=="middle"&&en(t[v]))return hs(hs({},t),{},ex({},v,t[v]+(h||0)))}return t},RMe=function(t,r,n){return ua(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},oQ=function(t,r,n,o,s){var i=r.props.children,l=kc(i,x1).filter(function(d){return RMe(o,s,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var f=_s(u,n);if(ua(f))return d;var h=Array.isArray(f)?[YC(f),Um(f)]:[f,f],m=c.reduce(function(v,g){var y=_s(u,g,0),x=h[0]-Math.abs(Array.isArray(y)?y[0]:y),b=h[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(x,v[0]),Math.max(b,v[1])]},[1/0,-1/0]);return[Math.min(m[0],d[0]),Math.max(m[1],d[1])]},[1/0,-1/0])}return null},LMe=function(t,r,n,o,s){var i=r.map(function(l){return oQ(t,l,n,s,o)}).filter(function(l){return!ua(l)});return i&&i.length?i.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},sQ=function(t,r,n,o,s){var i=r.map(function(c){var d=c.props.dataKey;return n==="number"&&d&&oQ(t,c,d,o)||eb(t,d,n,s)});if(n==="number")return i.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return i.reduce(function(c,d){for(var u=0,f=d.length;u<f;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},iQ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},lQ=function(t,r,n,o){if(o)return t.map(function(c){return c.coordinate});var s,i,l=t.map(function(c){return c.coordinate===r&&(s=!0),c.coordinate===n&&(i=!0),c.coordinate});return s||l.push(r),i||l.push(n),l},Ef=function(t,r,n){if(!t)return null;var o=t.scale,s=t.duplicateDomain,i=t.type,l=t.range,c=t.realScaleType==="scaleBand"?o.bandwidth()/2:2,d=(r||n)&&i==="category"&&o.bandwidth?o.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&l?.length>=2?hl(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var h=s?s.indexOf(f):f;return{coordinate:o(h)+d,value:f,offset:d}});return u.filter(function(f){return!x0(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:o(f)+d,value:f,index:h,offset:d}}):o.ticks&&!n?o.ticks(t.tickCount).map(function(f){return{coordinate:o(f)+d,value:f,offset:d}}):o.domain().map(function(f,h){return{coordinate:o(f)+d,value:s?s[f]:f,index:h,offset:d}})},qA=new WeakMap,Y2=function(t,r){if(typeof r!="function")return t;qA.has(t)||qA.set(t,new WeakMap);var n=qA.get(t);if(n.has(r))return n.get(r);var o=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,o),o},cQ=function(t,r,n){var o=t.scale,s=t.type,i=t.layout,l=t.axisType;if(o==="auto")return i==="radial"&&l==="radiusAxis"?{scale:nw(),realScaleType:"band"}:i==="radial"&&l==="angleAxis"?{scale:vN(),realScaleType:"linear"}:s==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Zy(),realScaleType:"point"}:s==="category"?{scale:nw(),realScaleType:"band"}:{scale:vN(),realScaleType:"linear"};if(rg(o)){var c="scale".concat(RC(o));return{scale:(qB[c]||Zy)(),realScaleType:qB[c]?c:"point"}}return na(o)?{scale:o}:{scale:Zy(),realScaleType:"point"}},YB=1e-4,dQ=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,o=t.range(),s=Math.min(o[0],o[1])-YB,i=Math.max(o[0],o[1])+YB,l=t(r[0]),c=t(r[n-1]);(l<s||l>i||c<s||c>i)&&t.domain([r[0],r[n-1]])}},FMe=function(t,r){if(!t)return null;for(var n=0,o=t.length;n<o;n++)if(t[n].item===r)return t[n].position;return null},$Me=function(t,r){if(!r||r.length!==2||!en(r[0])||!en(r[1]))return t;var n=Math.min(r[0],r[1]),o=Math.max(r[0],r[1]),s=[t[0],t[1]];return(!en(t[0])||t[0]<n)&&(s[0]=n),(!en(t[1])||t[1]>o)&&(s[1]=o),s[0]>o&&(s[0]=o),s[1]<n&&(s[1]=n),s},BMe=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var s=0,i=0,l=0;l<r;++l){var c=x0(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=s,t[l][n][1]=s+c,s=t[l][n][1]):(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1])}},qMe=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var s=0,i=0;i<r;++i){var l=x0(t[i][n][1])?t[i][n][0]:t[i][n][1];l>=0?(t[i][n][0]=s,t[i][n][1]=s+l,s=t[i][n][1]):(t[i][n][0]=0,t[i][n][1]=0)}},zMe={sign:BMe,expand:dSe,none:wx,silhouette:uSe,wiggle:fSe,positive:qMe},UMe=function(t,r,n){var o=r.map(function(l){return l.props.dataKey}),s=zMe[n],i=cSe().keys(o).value(function(l,c){return+_s(l,c,0)}).order(UI).offset(s);return i(t)},VMe=function(t,r,n,o,s,i){if(!t)return null;var l=i?r.reverse():r,c={},d=l.reduce(function(f,h){var m,v=(m=h.type)!==null&&m!==void 0&&m.defaultProps?hs(hs({},h.type.defaultProps),h.props):h.props,g=v.stackId,y=v.hide;if(y)return f;var x=v[n],b=f[x]||{hasStack:!1,stackGroups:{}};if(Js(g)){var w=b.stackGroups[g]||{numericAxisId:n,cateAxisId:o,items:[]};w.items.push(h),b.hasStack=!0,b.stackGroups[g]=w}else b.stackGroups[Ng("_stackId_")]={numericAxisId:n,cateAxisId:o,items:[h]};return hs(hs({},f),{},ex({},x,b))},c),u={};return Object.keys(d).reduce(function(f,h){var m=d[h];if(m.hasStack){var v={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(g,y){var x=m.stackGroups[y];return hs(hs({},g),{},ex({},y,{numericAxisId:n,cateAxisId:o,items:x.items,stackedData:UMe(t,x.items,s)}))},v)}return hs(hs({},f),{},ex({},h,m))},u)},uQ=function(t,r){var n=r.realScaleType,o=r.type,s=r.tickCount,i=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(s&&o==="number"&&i&&(i[0]==="auto"||i[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=oMe(d,s,l);return t.domain([YC(u),Um(u)]),{niceTicks:u}}if(s&&o==="number"){var f=t.domain(),h=sMe(f,s,l);return{niceTicks:h}}return null};function NN(e){var t=e.axis,r=e.ticks,n=e.bandSize,o=e.entry,s=e.index,i=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!ua(o[t.dataKey])){var l=Y_(r,"value",o[t.dataKey]);if(l)return l.coordinate+n/2}return r[s]?r[s].coordinate+n/2:null}var c=_s(o,ua(i)?t.dataKey:i);return ua(c)?null:t.scale(c)}var JB=function(t){var r=t.axis,n=t.ticks,o=t.offset,s=t.bandSize,i=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+o:null;var c=_s(i,r.dataKey,r.domain[l]);return ua(c)?null:r.scale(c)-s/2+o},WMe=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var o=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]);return o<=0&&s>=0?0:s<0?s:o}return n[0]},HMe=function(t,r){var n,o=(n=t.type)!==null&&n!==void 0&&n.defaultProps?hs(hs({},t.type.defaultProps),t.props):t.props,s=o.stackId;if(Js(s)){var i=r[s];if(i){var l=i.items.indexOf(t);return l>=0?i.stackedData[l]:null}}return null},GMe=function(t){return t.reduce(function(r,n){return[YC(n.concat([r[0]]).filter(en)),Um(n.concat([r[1]]).filter(en))]},[1/0,-1/0])},fQ=function(t,r,n){return Object.keys(t).reduce(function(o,s){var i=t[s],l=i.stackedData,c=l.reduce(function(d,u){var f=GMe(u.slice(r,n+1));return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],o[0]),Math.max(c[1],o[1])]},[1/0,-1/0]).map(function(o){return o===1/0||o===-1/0?0:o})},QB=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ZB=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,yO=function(t,r,n){if(na(t))return t(r,n);if(!Array.isArray(t))return r;var o=[];if(en(t[0]))o[0]=n?t[0]:Math.min(t[0],r[0]);else if(QB.test(t[0])){var s=+QB.exec(t[0])[1];o[0]=r[0]-s}else na(t[0])?o[0]=t[0](r[0]):o[0]=r[0];if(en(t[1]))o[1]=n?t[1]:Math.max(t[1],r[1]);else if(ZB.test(t[1])){var i=+ZB.exec(t[1])[1];o[1]=r[1]+i}else na(t[1])?o[1]=t[1](r[1]):o[1]=r[1];return o},SN=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var o=t.scale.bandwidth();if(!n||o>0)return o}if(t&&r&&r.length>=2){for(var s=_D(r,function(f){return f.coordinate}),i=1/0,l=1,c=s.length;l<c;l++){var d=s[l],u=s[l-1];i=Math.min((d.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0},e7=function(t,r,n){return!t||!t.length||og(t,Ec(n,"type.defaultProps.domain"))?r:t},mQ=function(t,r){var n=t.type.defaultProps?hs(hs({},t.type.defaultProps),t.props):t.props,o=n.dataKey,s=n.name,i=n.unit,l=n.formatter,c=n.tooltipType,d=n.chartType,u=n.hide;return hs(hs({},Kn(t,!1)),{},{dataKey:o,unit:i,formatter:l,name:s||o,color:XD(t),value:_s(r,o),type:c,payload:r,chartType:d,hide:u})};function fw(e){"@babel/helpers - typeof";return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(e)}function t7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t7(Object(r),!0).forEach(function(n){hQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hQ(e,t,r){return t=KMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KMe(e){var t=XMe(e,"string");return fw(t)=="symbol"?t:t+""}function XMe(e,t){if(fw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YMe(e,t){return eRe(e)||ZMe(e,t)||QMe(e,t)||JMe()}function JMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QMe(e,t){if(e){if(typeof e=="string")return r7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r7(e,t)}}function r7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function eRe(e){if(Array.isArray(e))return e}var CN=Math.PI/180,tRe=function(t){return t*180/Math.PI},Do=function(t,r,n,o){return{x:t+Math.cos(-CN*o)*n,y:r+Math.sin(-CN*o)*n}},pQ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},rRe=function(t,r,n,o,s){var i=t.width,l=t.height,c=t.startAngle,d=t.endAngle,u=pl(t.cx,i,i/2),f=pl(t.cy,l,l/2),h=pQ(i,l,n),m=pl(t.innerRadius,h,0),v=pl(t.outerRadius,h,h*.8),g=Object.keys(r);return g.reduce(function(y,x){var b=r[x],w=b.domain,j=b.reversed,_;if(ua(b.range))o==="angleAxis"?_=[c,d]:o==="radiusAxis"&&(_=[m,v]),j&&(_=[_[1],_[0]]);else{_=b.range;var C=_,E=YMe(C,2);c=E[0],d=E[1]}var A=cQ(b,s),P=A.realScaleType,F=A.scale;F.domain(w).range(_),dQ(F);var M=uQ(F,yf(yf({},b),{},{realScaleType:P})),I=yf(yf(yf({},b),M),{},{range:_,radius:v,realScaleType:P,scale:F,cx:u,cy:f,innerRadius:m,outerRadius:v,startAngle:c,endAngle:d});return yf(yf({},y),{},hQ({},x,I))},{})},nRe=function(t,r){var n=t.x,o=t.y,s=r.x,i=r.y;return Math.sqrt(Math.pow(n-s,2)+Math.pow(o-i,2))},aRe=function(t,r){var n=t.x,o=t.y,s=r.cx,i=r.cy,l=nRe({x:n,y:o},{x:s,y:i});if(l<=0)return{radius:l};var c=(n-s)/l,d=Math.acos(c);return o>i&&(d=2*Math.PI-d),{radius:l,angle:tRe(d),angleInRadian:d}},oRe=function(t){var r=t.startAngle,n=t.endAngle,o=Math.floor(r/360),s=Math.floor(n/360),i=Math.min(o,s);return{startAngle:r-i*360,endAngle:n-i*360}},sRe=function(t,r){var n=r.startAngle,o=r.endAngle,s=Math.floor(n/360),i=Math.floor(o/360),l=Math.min(s,i);return t+l*360},n7=function(t,r){var n=t.x,o=t.y,s=aRe({x:n,y:o},r),i=s.radius,l=s.angle,c=r.innerRadius,d=r.outerRadius;if(i<c||i>d)return!1;if(i===0)return!0;var u=oRe(r),f=u.startAngle,h=u.endAngle,m=l,v;if(f<=h){for(;m>h;)m-=360;for(;m<f;)m+=360;v=m>=f&&m<=h}else{for(;m>f;)m-=360;for(;m<h;)m+=360;v=m>=h&&m<=f}return v?yf(yf({},r),{},{radius:i,angle:sRe(m,r)}):null},gQ=function(t){return!p.isValidElement(t)&&!na(t)&&typeof t!="boolean"?t.className:""};function mw(e){"@babel/helpers - typeof";return mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mw(e)}var iRe=["offset"];function lRe(e){return fRe(e)||uRe(e)||dRe(e)||cRe()}function cRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dRe(e,t){if(e){if(typeof e=="string")return bO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bO(e,t)}}function uRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fRe(e){if(Array.isArray(e))return bO(e)}function bO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mRe(e,t){if(e==null)return{};var r=hRe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function a7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Us(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a7(Object(r),!0).forEach(function(n){pRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pRe(e,t,r){return t=gRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gRe(e){var t=vRe(e,"string");return mw(t)=="symbol"?t:t+""}function vRe(e,t){if(mw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hw(){return hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hw.apply(this,arguments)}var xRe=function(t){var r=t.value,n=t.formatter,o=ua(t.children)?r:t.children;return na(n)?n(o):o},yRe=function(t,r){var n=hl(r-t),o=Math.min(Math.abs(r-t),360);return n*o},bRe=function(t,r,n){var o=t.position,s=t.viewBox,i=t.offset,l=t.className,c=s,d=c.cx,u=c.cy,f=c.innerRadius,h=c.outerRadius,m=c.startAngle,v=c.endAngle,g=c.clockWise,y=(f+h)/2,x=yRe(m,v),b=x>=0?1:-1,w,j;o==="insideStart"?(w=m+b*i,j=g):o==="insideEnd"?(w=v-b*i,j=!g):o==="end"&&(w=v+b*i,j=g),j=x<=0?j:!j;var _=Do(d,u,y,w),C=Do(d,u,y,w+(j?1:-1)*359),E="M".concat(_.x,",").concat(_.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(j?0:1,`,
    `).concat(C.x,",").concat(C.y),A=ua(t.id)?Ng("recharts-radial-line-"):t.id;return _e.createElement("text",hw({},n,{dominantBaseline:"central",className:pa("recharts-radial-bar-label",l)}),_e.createElement("defs",null,_e.createElement("path",{id:A,d:E})),_e.createElement("textPath",{xlinkHref:"#".concat(A)},r))},wRe=function(t){var r=t.viewBox,n=t.offset,o=t.position,s=r,i=s.cx,l=s.cy,c=s.innerRadius,d=s.outerRadius,u=s.startAngle,f=s.endAngle,h=(u+f)/2;if(o==="outside"){var m=Do(i,l,d+n,h),v=m.x,g=m.y;return{x:v,y:g,textAnchor:v>=i?"start":"end",verticalAnchor:"middle"}}if(o==="center")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(o==="centerTop")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"start"};if(o==="centerBottom")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"end"};var y=(c+d)/2,x=Do(i,l,y,h),b=x.x,w=x.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},jRe=function(t){var r=t.viewBox,n=t.parentViewBox,o=t.offset,s=t.position,i=r,l=i.x,c=i.y,d=i.width,u=i.height,f=u>=0?1:-1,h=f*o,m=f>0?"end":"start",v=f>0?"start":"end",g=d>=0?1:-1,y=g*o,x=g>0?"end":"start",b=g>0?"start":"end";if(s==="top"){var w={x:l+d/2,y:c-f*o,textAnchor:"middle",verticalAnchor:m};return Us(Us({},w),n?{height:Math.max(c-n.y,0),width:d}:{})}if(s==="bottom"){var j={x:l+d/2,y:c+u+h,textAnchor:"middle",verticalAnchor:v};return Us(Us({},j),n?{height:Math.max(n.y+n.height-(c+u),0),width:d}:{})}if(s==="left"){var _={x:l-y,y:c+u/2,textAnchor:x,verticalAnchor:"middle"};return Us(Us({},_),n?{width:Math.max(_.x-n.x,0),height:u}:{})}if(s==="right"){var C={x:l+d+y,y:c+u/2,textAnchor:b,verticalAnchor:"middle"};return Us(Us({},C),n?{width:Math.max(n.x+n.width-C.x,0),height:u}:{})}var E=n?{width:d,height:u}:{};return s==="insideLeft"?Us({x:l+y,y:c+u/2,textAnchor:b,verticalAnchor:"middle"},E):s==="insideRight"?Us({x:l+d-y,y:c+u/2,textAnchor:x,verticalAnchor:"middle"},E):s==="insideTop"?Us({x:l+d/2,y:c+h,textAnchor:"middle",verticalAnchor:v},E):s==="insideBottom"?Us({x:l+d/2,y:c+u-h,textAnchor:"middle",verticalAnchor:m},E):s==="insideTopLeft"?Us({x:l+y,y:c+h,textAnchor:b,verticalAnchor:v},E):s==="insideTopRight"?Us({x:l+d-y,y:c+h,textAnchor:x,verticalAnchor:v},E):s==="insideBottomLeft"?Us({x:l+y,y:c+u-h,textAnchor:b,verticalAnchor:m},E):s==="insideBottomRight"?Us({x:l+d-y,y:c+u-h,textAnchor:x,verticalAnchor:m},E):h0(s)&&(en(s.x)||_p(s.x))&&(en(s.y)||_p(s.y))?Us({x:l+pl(s.x,d),y:c+pl(s.y,u),textAnchor:"end",verticalAnchor:"end"},E):Us({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},E)},_Re=function(t){return"cx"in t&&en(t.cx)};function ii(e){var t=e.offset,r=t===void 0?5:t,n=mRe(e,iRe),o=Us({offset:r},n),s=o.viewBox,i=o.position,l=o.value,c=o.children,d=o.content,u=o.className,f=u===void 0?"":u,h=o.textBreakAll;if(!s||ua(l)&&ua(c)&&!p.isValidElement(d)&&!na(d))return null;if(p.isValidElement(d))return p.cloneElement(d,o);var m;if(na(d)){if(m=p.createElement(d,o),p.isValidElement(m))return m}else m=xRe(o);var v=_Re(s),g=Kn(o,!0);if(v&&(i==="insideStart"||i==="insideEnd"||i==="end"))return bRe(o,m,g);var y=v?wRe(o):jRe(o);return _e.createElement(ag,hw({className:pa("recharts-label",f)},g,y,{breakAll:h}),m)}ii.displayName="Label";var vQ=function(t){var r=t.cx,n=t.cy,o=t.angle,s=t.startAngle,i=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,f=t.x,h=t.y,m=t.top,v=t.left,g=t.width,y=t.height,x=t.clockWise,b=t.labelViewBox;if(b)return b;if(en(g)&&en(y)){if(en(f)&&en(h))return{x:f,y:h,width:g,height:y};if(en(m)&&en(v))return{x:m,y:v,width:g,height:y}}return en(f)&&en(h)?{x:f,y:h,width:0,height:0}:en(r)&&en(n)?{cx:r,cy:n,startAngle:s||o||0,endAngle:i||o||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:x}:t.viewBox?t.viewBox:{}},NRe=function(t,r){return t?t===!0?_e.createElement(ii,{key:"label-implicit",viewBox:r}):Js(t)?_e.createElement(ii,{key:"label-implicit",viewBox:r,value:t}):p.isValidElement(t)?t.type===ii?p.cloneElement(t,{key:"label-implicit",viewBox:r}):_e.createElement(ii,{key:"label-implicit",content:t,viewBox:r}):na(t)?_e.createElement(ii,{key:"label-implicit",content:t,viewBox:r}):h0(t)?_e.createElement(ii,hw({viewBox:r},t,{key:"label-implicit"})):null:null},SRe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var o=t.children,s=vQ(t),i=kc(o,ii).map(function(c,d){return p.cloneElement(c,{viewBox:r||s,key:"label-".concat(d)})});if(!n)return i;var l=NRe(t.label,r||s);return[l].concat(lRe(i))};ii.parseViewBox=vQ;ii.renderCallByParent=SRe;function CRe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var PRe=CRe;const ARe=Ga(PRe);function pw(e){"@babel/helpers - typeof";return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}var ERe=["valueAccessor"],kRe=["data","dataKey","clockWise","id","textBreakAll"];function IRe(e){return MRe(e)||DRe(e)||TRe(e)||ORe()}function ORe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TRe(e,t){if(e){if(typeof e=="string")return wO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wO(e,t)}}function DRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MRe(e){if(Array.isArray(e))return wO(e)}function wO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PN(){return PN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PN.apply(this,arguments)}function o7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function s7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o7(Object(r),!0).forEach(function(n){RRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RRe(e,t,r){return t=LRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LRe(e){var t=FRe(e,"string");return pw(t)=="symbol"?t:t+""}function FRe(e,t){if(pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i7(e,t){if(e==null)return{};var r=$Re(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $Re(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var BRe=function(t){return Array.isArray(t.value)?ARe(t.value):t.value};function Vu(e){var t=e.valueAccessor,r=t===void 0?BRe:t,n=i7(e,ERe),o=n.data,s=n.dataKey,i=n.clockWise,l=n.id,c=n.textBreakAll,d=i7(n,kRe);return!o||!o.length?null:_e.createElement(Ta,{className:"recharts-label-list"},o.map(function(u,f){var h=ua(s)?r(u,f):_s(u&&u.payload,s),m=ua(l)?{}:{id:"".concat(l,"-").concat(f)};return _e.createElement(ii,PN({},Kn(u,!0),d,m,{parentViewBox:u.parentViewBox,value:h,textBreakAll:c,viewBox:ii.parseViewBox(ua(i)?u:s7(s7({},u),{},{clockWise:i})),key:"label-".concat(f),index:f}))}))}Vu.displayName="LabelList";function qRe(e,t){return e?e===!0?_e.createElement(Vu,{key:"labelList-implicit",data:t}):_e.isValidElement(e)||na(e)?_e.createElement(Vu,{key:"labelList-implicit",data:t,content:e}):h0(e)?_e.createElement(Vu,PN({data:t},e,{key:"labelList-implicit"})):null:null}function zRe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,o=kc(n,Vu).map(function(i,l){return p.cloneElement(i,{data:t,key:"labelList-".concat(l)})});if(!r)return o;var s=qRe(e.label,t);return[s].concat(IRe(o))}Vu.renderCallByParent=zRe;function gw(e){"@babel/helpers - typeof";return gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gw(e)}function jO(){return jO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jO.apply(this,arguments)}function l7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function c7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l7(Object(r),!0).forEach(function(n){URe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function URe(e,t,r){return t=VRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VRe(e){var t=WRe(e,"string");return gw(t)=="symbol"?t:t+""}function WRe(e,t){if(gw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HRe=function(t,r){var n=hl(r-t),o=Math.min(Math.abs(r-t),359.999);return n*o},J2=function(t){var r=t.cx,n=t.cy,o=t.radius,s=t.angle,i=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+o,f=Math.asin(c/u)/CN,h=d?s:s+i*f,m=Do(r,n,u,h),v=Do(r,n,o,h),g=d?s-i*f:s,y=Do(r,n,u*Math.cos(f*CN),g);return{center:m,circleTangency:v,lineTangency:y,theta:f}},xQ=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,s=t.outerRadius,i=t.startAngle,l=t.endAngle,c=HRe(i,l),d=i+c,u=Do(r,n,s,i),f=Do(r,n,s,d),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(i>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(o>0){var m=Do(r,n,o,i),v=Do(r,n,o,d);h+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(o,",").concat(o,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(i<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},GRe=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,s=t.outerRadius,i=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,f=hl(u-d),h=J2({cx:r,cy:n,radius:s,angle:d,sign:f,cornerRadius:i,cornerIsExternal:c}),m=h.circleTangency,v=h.lineTangency,g=h.theta,y=J2({cx:r,cy:n,radius:s,angle:u,sign:-f,cornerRadius:i,cornerIsExternal:c}),x=y.circleTangency,b=y.lineTangency,w=y.theta,j=c?Math.abs(d-u):Math.abs(d-u)-g-w;if(j<0)return l?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):xQ({cx:r,cy:n,innerRadius:o,outerRadius:s,startAngle:d,endAngle:u});var _="M ".concat(v.x,",").concat(v.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(j>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
  `);if(o>0){var C=J2({cx:r,cy:n,radius:o,angle:d,sign:f,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),E=C.circleTangency,A=C.lineTangency,P=C.theta,F=J2({cx:r,cy:n,radius:o,angle:u,sign:-f,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),M=F.circleTangency,I=F.lineTangency,R=F.theta,D=c?Math.abs(d-u):Math.abs(d-u)-P-R;if(D<0&&i===0)return"".concat(_,"L").concat(r,",").concat(n,"Z");_+="L".concat(I.x,",").concat(I.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(M.x,",").concat(M.y,`
      A`).concat(o,",").concat(o,",0,").concat(+(D>180),",").concat(+(f>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(A.x,",").concat(A.y,"Z")}else _+="L".concat(r,",").concat(n,"Z");return _},KRe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},YD=function(t){var r=c7(c7({},KRe),t),n=r.cx,o=r.cy,s=r.innerRadius,i=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,h=r.className;if(i<s||u===f)return null;var m=pa("recharts-sector",h),v=i-s,g=pl(l,v,0,!0),y;return g>0&&Math.abs(u-f)<360?y=GRe({cx:n,cy:o,innerRadius:s,outerRadius:i,cornerRadius:Math.min(g,v/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):y=xQ({cx:n,cy:o,innerRadius:s,outerRadius:i,startAngle:u,endAngle:f}),_e.createElement("path",jO({},Kn(r,!0),{className:m,d:y,role:"img"}))};function vw(e){"@babel/helpers - typeof";return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(e)}function _O(){return _O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_O.apply(this,arguments)}function d7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function u7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d7(Object(r),!0).forEach(function(n){XRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XRe(e,t,r){return t=YRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YRe(e){var t=JRe(e,"string");return vw(t)=="symbol"?t:t+""}function JRe(e,t){if(vw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f7={curveBasisClosed:QNe,curveBasisOpen:ZNe,curveBasis:JNe,curveBumpX:LNe,curveBumpY:FNe,curveLinearClosed:eSe,curveLinear:FC,curveMonotoneX:tSe,curveMonotoneY:rSe,curveNatural:nSe,curveStep:aSe,curveStepAfter:sSe,curveStepBefore:oSe},Q2=function(t){return t.x===+t.x&&t.y===+t.y},ly=function(t){return t.x},cy=function(t){return t.y},QRe=function(t,r){if(na(t))return t;var n="curve".concat(RC(t));return(n==="curveMonotone"||n==="curveBump")&&r?f7["".concat(n).concat(r==="vertical"?"Y":"X")]:f7[n]||FC},ZRe=function(t){var r=t.type,n=r===void 0?"linear":r,o=t.points,s=o===void 0?[]:o,i=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=QRe(n,l),f=d?s.filter(function(g){return Q2(g)}):s,h;if(Array.isArray(i)){var m=d?i.filter(function(g){return Q2(g)}):i,v=f.map(function(g,y){return u7(u7({},g),{},{base:m[y]})});return l==="vertical"?h=z2().y(cy).x1(ly).x0(function(g){return g.base.x}):h=z2().x(ly).y1(cy).y0(function(g){return g.base.y}),h.defined(Q2).curve(u),h(v)}return l==="vertical"&&en(i)?h=z2().y(cy).x1(ly).x0(i):en(i)?h=z2().x(ly).y1(cy).y0(i):h=mY().x(ly).y(cy),h.defined(Q2).curve(u),h(f)},Bp=function(t){var r=t.className,n=t.points,o=t.path,s=t.pathRef;if((!n||!n.length)&&!o)return null;var i=n&&n.length?ZRe(t):o;return p.createElement("path",_O({},Kn(t,!1),J_(t),{className:pa("recharts-curve",r),d:i,ref:s}))},yQ={exports:{}},eLe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",tLe=eLe,rLe=tLe;function bQ(){}function wQ(){}wQ.resetWarningCache=bQ;var nLe=function(){function e(n,o,s,i,l,c){if(c!==rLe){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:wQ,resetWarningCache:bQ};return r.PropTypes=r,r};yQ.exports=nLe();var aLe=yQ.exports;const Jn=Ga(aLe);var oLe=Object.getOwnPropertyNames,sLe=Object.getOwnPropertySymbols,iLe=Object.prototype.hasOwnProperty;function m7(e,t){return function(n,o,s){return e(n,o,s)&&t(n,o,s)}}function Z2(e){return function(r,n,o){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,o);var s=o.cache,i=s.get(r),l=s.get(n);if(i&&l)return i===n&&l===r;s.set(r,n),s.set(n,r);var c=e(r,n,o);return s.delete(r),s.delete(n),c}}function h7(e){return oLe(e).concat(sLe(e))}var lLe=Object.hasOwn||function(e,t){return iLe.call(e,t)};function Pg(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var cLe="__v",dLe="__o",uLe="_owner",p7=Object.getOwnPropertyDescriptor,g7=Object.keys;function fLe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function mLe(e,t){return Pg(e.getTime(),t.getTime())}function hLe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function pLe(e,t){return e===t}function v7(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),s=e.entries(),i,l,c=0;(i=s.next())&&!i.done;){for(var d=t.entries(),u=!1,f=0;(l=d.next())&&!l.done;){if(o[f]){f++;continue}var h=i.value,m=l.value;if(r.equals(h[0],m[0],c,f,e,t,r)&&r.equals(h[1],m[1],h[0],m[0],e,t,r)){u=o[f]=!0;break}f++}if(!u)return!1;c++}return!0}var gLe=Pg;function vLe(e,t,r){var n=g7(e),o=n.length;if(g7(t).length!==o)return!1;for(;o-- >0;)if(!jQ(e,t,r,n[o]))return!1;return!0}function dy(e,t,r){var n=h7(e),o=n.length;if(h7(t).length!==o)return!1;for(var s,i,l;o-- >0;)if(s=n[o],!jQ(e,t,r,s)||(i=p7(e,s),l=p7(t,s),(i||l)&&(!i||!l||i.configurable!==l.configurable||i.enumerable!==l.enumerable||i.writable!==l.writable)))return!1;return!0}function xLe(e,t){return Pg(e.valueOf(),t.valueOf())}function yLe(e,t){return e.source===t.source&&e.flags===t.flags}function x7(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),s=e.values(),i,l;(i=s.next())&&!i.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!o[u]&&r.equals(i.value,l.value,i.value,l.value,e,t,r)){d=o[u]=!0;break}u++}if(!d)return!1}return!0}function bLe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function wLe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function jQ(e,t,r,n){return(n===uLe||n===dLe||n===cLe)&&(e.$$typeof||t.$$typeof)?!0:lLe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var jLe="[object Arguments]",_Le="[object Boolean]",NLe="[object Date]",SLe="[object Error]",CLe="[object Map]",PLe="[object Number]",ALe="[object Object]",ELe="[object RegExp]",kLe="[object Set]",ILe="[object String]",OLe="[object URL]",TLe=Array.isArray,y7=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,b7=Object.assign,DLe=Object.prototype.toString.call.bind(Object.prototype.toString);function MLe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,o=e.areFunctionsEqual,s=e.areMapsEqual,i=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(v,g,y){if(v===g)return!0;if(v==null||g==null)return!1;var x=typeof v;if(x!==typeof g)return!1;if(x!=="object")return x==="number"?i(v,g,y):x==="function"?o(v,g,y):!1;var b=v.constructor;if(b!==g.constructor)return!1;if(b===Object)return l(v,g,y);if(TLe(v))return t(v,g,y);if(y7!=null&&y7(v))return f(v,g,y);if(b===Date)return r(v,g,y);if(b===RegExp)return d(v,g,y);if(b===Map)return s(v,g,y);if(b===Set)return u(v,g,y);var w=DLe(v);return w===NLe?r(v,g,y):w===ELe?d(v,g,y):w===CLe?s(v,g,y):w===kLe?u(v,g,y):w===ALe?typeof v.then!="function"&&typeof g.then!="function"&&l(v,g,y):w===OLe?h(v,g,y):w===SLe?n(v,g,y):w===jLe?l(v,g,y):w===_Le||w===PLe||w===ILe?c(v,g,y):!1}}function RLe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,o={areArraysEqual:n?dy:fLe,areDatesEqual:mLe,areErrorsEqual:hLe,areFunctionsEqual:pLe,areMapsEqual:n?m7(v7,dy):v7,areNumbersEqual:gLe,areObjectsEqual:n?dy:vLe,arePrimitiveWrappersEqual:xLe,areRegExpsEqual:yLe,areSetsEqual:n?m7(x7,dy):x7,areTypedArraysEqual:n?dy:bLe,areUrlsEqual:wLe};if(r&&(o=b7({},o,r(o))),t){var s=Z2(o.areArraysEqual),i=Z2(o.areMapsEqual),l=Z2(o.areObjectsEqual),c=Z2(o.areSetsEqual);o=b7({},o,{areArraysEqual:s,areMapsEqual:i,areObjectsEqual:l,areSetsEqual:c})}return o}function LLe(e){return function(t,r,n,o,s,i,l){return e(t,r,l)}}function FLe(e){var t=e.circular,r=e.comparator,n=e.createState,o=e.equals,s=e.strict;if(n)return function(c,d){var u=n(),f=u.cache,h=f===void 0?t?new WeakMap:void 0:f,m=u.meta;return r(c,d,{cache:h,equals:o,meta:m,strict:s})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:o,meta:void 0,strict:s})};var i={cache:void 0,equals:o,meta:void 0,strict:s};return function(c,d){return r(c,d,i)}}var $Le=$h();$h({strict:!0});$h({circular:!0});$h({circular:!0,strict:!0});$h({createInternalComparator:function(){return Pg}});$h({strict:!0,createInternalComparator:function(){return Pg}});$h({circular:!0,createInternalComparator:function(){return Pg}});$h({circular:!0,createInternalComparator:function(){return Pg},strict:!0});function $h(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,o=e.createState,s=e.strict,i=s===void 0?!1:s,l=RLe(e),c=MLe(l),d=n?n(c):LLe(c);return FLe({circular:r,comparator:c,createState:o,equals:d,strict:i})}function BLe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function w7(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function o(s){r<0&&(r=s),s-r>t?(e(s),r=-1):BLe(o)};requestAnimationFrame(n)}function NO(e){"@babel/helpers - typeof";return NO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NO(e)}function qLe(e){return WLe(e)||VLe(e)||ULe(e)||zLe()}function zLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ULe(e,t){if(e){if(typeof e=="string")return j7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j7(e,t)}}function j7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WLe(e){if(Array.isArray(e))return e}function HLe(){var e={},t=function(){return null},r=!1,n=function o(s){if(!r){if(Array.isArray(s)){if(!s.length)return;var i=s,l=qLe(i),c=l[0],d=l.slice(1);if(typeof c=="number"){w7(o.bind(null,d),c);return}o(c),w7(o.bind(null,d));return}NO(s)==="object"&&(e=s,t(e)),typeof s=="function"&&s()}};return{stop:function(){r=!0},start:function(s){r=!1,n(s)},subscribe:function(s){return t=s,function(){t=function(){return null}}}}}function xw(e){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(e)}function _7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function N7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_7(Object(r),!0).forEach(function(n){_Q(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Q(e,t,r){return t=GLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GLe(e){var t=KLe(e,"string");return xw(t)==="symbol"?t:String(t)}function KLe(e,t){if(xw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XLe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,o){return n.filter(function(s){return o.includes(s)})})},YLe=function(t){return t},JLe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},tb=function(t,r){return Object.keys(r).reduce(function(n,o){return N7(N7({},n),{},_Q({},o,t(o,r[o])))},{})},S7=function(t,r,n){return t.map(function(o){return"".concat(JLe(o)," ").concat(r,"ms ").concat(n)}).join(",")};function QLe(e,t){return tFe(e)||eFe(e,t)||NQ(e,t)||ZLe()}function ZLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function tFe(e){if(Array.isArray(e))return e}function rFe(e){return oFe(e)||aFe(e)||NQ(e)||nFe()}function nFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NQ(e,t){if(e){if(typeof e=="string")return SO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SO(e,t)}}function aFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oFe(e){if(Array.isArray(e))return SO(e)}function SO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var AN=1e-4,SQ=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},CQ=function(t,r){return t.map(function(n,o){return n*Math.pow(r,o)}).reduce(function(n,o){return n+o})},C7=function(t,r){return function(n){var o=SQ(t,r);return CQ(o,n)}},sFe=function(t,r){return function(n){var o=SQ(t,r),s=[].concat(rFe(o.map(function(i,l){return i*l}).slice(1)),[0]);return CQ(s,n)}},P7=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0],s=r[1],i=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":o=0,s=0,i=1,l=1;break;case"ease":o=.25,s=.1,i=.25,l=1;break;case"ease-in":o=.42,s=0,i=1,l=1;break;case"ease-out":o=.42,s=0,i=.58,l=1;break;case"ease-in-out":o=0,s=0,i=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),u=QLe(d,4);o=u[0],s=u[1],i=u[2],l=u[3]}}}var f=C7(o,i),h=C7(s,l),m=sFe(o,i),v=function(x){return x>1?1:x<0?0:x},g=function(x){for(var b=x>1?1:x,w=b,j=0;j<8;++j){var _=f(w)-b,C=m(w);if(Math.abs(_-b)<AN||C<AN)return h(w);w=v(w-_/C)}return h(w)};return g.isStepper=!1,g},iFe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,o=t.damping,s=o===void 0?8:o,i=t.dt,l=i===void 0?17:i,c=function(u,f,h){var m=-(u-f)*n,v=h*s,g=h+(m-v)*l/1e3,y=h*l/1e3+u;return Math.abs(y-f)<AN&&Math.abs(g)<AN?[f,0]:[y,g]};return c.isStepper=!0,c.dt=l,c},lFe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0];if(typeof o=="string")switch(o){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return P7(o);case"spring":return iFe();default:if(o.split("(")[0]==="cubic-bezier")return P7(o)}return typeof o=="function"?o:null};function yw(e){"@babel/helpers - typeof";return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yw(e)}function A7(e){return uFe(e)||dFe(e)||PQ(e)||cFe()}function cFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uFe(e){if(Array.isArray(e))return PO(e)}function E7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Si(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E7(Object(r),!0).forEach(function(n){CO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CO(e,t,r){return t=fFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fFe(e){var t=mFe(e,"string");return yw(t)==="symbol"?t:String(t)}function mFe(e,t){if(yw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hFe(e,t){return vFe(e)||gFe(e,t)||PQ(e,t)||pFe()}function pFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PQ(e,t){if(e){if(typeof e=="string")return PO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PO(e,t)}}function PO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function vFe(e){if(Array.isArray(e))return e}var EN=function(t,r,n){return t+(r-t)*n},AO=function(t){var r=t.from,n=t.to;return r!==n},xFe=function e(t,r,n){var o=tb(function(s,i){if(AO(i)){var l=t(i.from,i.to,i.velocity),c=hFe(l,2),d=c[0],u=c[1];return Si(Si({},i),{},{from:d,velocity:u})}return i},r);return n<1?tb(function(s,i){return AO(i)?Si(Si({},i),{},{velocity:EN(i.velocity,o[s].velocity,n),from:EN(i.from,o[s].from,n)}):i},r):e(t,o,n-1)};const yFe=function(e,t,r,n,o){var s=XLe(e,t),i=s.reduce(function(y,x){return Si(Si({},y),{},CO({},x,[e[x],t[x]]))},{}),l=s.reduce(function(y,x){return Si(Si({},y),{},CO({},x,{from:e[x],velocity:0,to:t[x]}))},{}),c=-1,d,u,f=function(){return null},h=function(){return tb(function(x,b){return b.from},l)},m=function(){return!Object.values(l).filter(AO).length},v=function(x){d||(d=x);var b=x-d,w=b/r.dt;l=xFe(r,l,w),o(Si(Si(Si({},e),t),h())),d=x,m()||(c=requestAnimationFrame(f))},g=function(x){u||(u=x);var b=(x-u)/n,w=tb(function(_,C){return EN.apply(void 0,A7(C).concat([r(b)]))},i);if(o(Si(Si(Si({},e),t),w)),b<1)c=requestAnimationFrame(f);else{var j=tb(function(_,C){return EN.apply(void 0,A7(C).concat([r(1)]))},i);o(Si(Si(Si({},e),t),j))}};return f=r.isStepper?v:g,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function kx(e){"@babel/helpers - typeof";return kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kx(e)}var bFe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function wFe(e,t){if(e==null)return{};var r=jFe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jFe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,s;for(s=0;s<n.length;s++)o=n[s],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function zA(e){return CFe(e)||SFe(e)||NFe(e)||_Fe()}function _Fe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NFe(e,t){if(e){if(typeof e=="string")return EO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EO(e,t)}}function SFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CFe(e){if(Array.isArray(e))return EO(e)}function EO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function k7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $d(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(r),!0).forEach(function(n){Py(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Py(e,t,r){return t=AQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AQ(n.key),n)}}function AFe(e,t,r){return t&&I7(e.prototype,t),r&&I7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AQ(e){var t=EFe(e,"string");return kx(t)==="symbol"?t:String(t)}function EFe(e,t){if(kx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kO(e,t)}function kO(e,t){return kO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kO(e,t)}function IFe(e){var t=OFe();return function(){var n=kN(e),o;if(t){var s=kN(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return IO(this,o)}}function IO(e,t){if(t&&(kx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OO(e)}function OO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kN(e){return kN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kN(e)}var ZC=function(e){kFe(r,e);var t=IFe(r);function r(n,o){var s;PFe(this,r),s=t.call(this,n,o);var i=s.props,l=i.isActive,c=i.attributeName,d=i.from,u=i.to,f=i.steps,h=i.children,m=i.duration;if(s.handleStyleChange=s.handleStyleChange.bind(OO(s)),s.changeStyle=s.changeStyle.bind(OO(s)),!l||m<=0)return s.state={style:{}},typeof h=="function"&&(s.state={style:u}),IO(s);if(f&&f.length)s.state={style:f[0].style};else if(d){if(typeof h=="function")return s.state={style:d},IO(s);s.state={style:c?Py({},c,d):d}}else s.state={style:{}};return s}return AFe(r,[{key:"componentDidMount",value:function(){var o=this.props,s=o.isActive,i=o.canBegin;this.mounted=!0,!(!s||!i)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(o){var s=this.props,i=s.isActive,l=s.canBegin,c=s.attributeName,d=s.shouldReAnimate,u=s.to,f=s.from,h=this.state.style;if(l){if(!i){var m={style:c?Py({},c,u):u};this.state&&h&&(c&&h[c]!==u||!c&&h!==u)&&this.setState(m);return}if(!($Le(o.to,u)&&o.canBegin&&o.isActive)){var v=!o.canBegin||!o.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=v||d?f:o.to;if(this.state&&h){var y={style:c?Py({},c,g):g};(c&&h[c]!==g||!c&&h!==g)&&this.setState(y)}this.runAnimation($d($d({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var o=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),o&&o()}},{key:"handleStyleChange",value:function(o){this.changeStyle(o)}},{key:"changeStyle",value:function(o){this.mounted&&this.setState({style:o})}},{key:"runJSAnimation",value:function(o){var s=this,i=o.from,l=o.to,c=o.duration,d=o.easing,u=o.begin,f=o.onAnimationEnd,h=o.onAnimationStart,m=yFe(i,l,lFe(d),c,this.changeStyle),v=function(){s.stopJSAnimation=m()};this.manager.start([h,u,v,c,f])}},{key:"runStepAnimation",value:function(o){var s=this,i=o.steps,l=o.begin,c=o.onAnimationStart,d=i[0],u=d.style,f=d.duration,h=f===void 0?0:f,m=function(g,y,x){if(x===0)return g;var b=y.duration,w=y.easing,j=w===void 0?"ease":w,_=y.style,C=y.properties,E=y.onAnimationEnd,A=x>0?i[x-1]:y,P=C||Object.keys(_);if(typeof j=="function"||j==="spring")return[].concat(zA(g),[s.runJSAnimation.bind(s,{from:A.style,to:_,duration:b,easing:j}),b]);var F=S7(P,b,j),M=$d($d($d({},A.style),_),{},{transition:F});return[].concat(zA(g),[M,b,E]).filter(YLe)};return this.manager.start([c].concat(zA(i.reduce(m,[u,Math.max(h,l)])),[o.onAnimationEnd]))}},{key:"runAnimation",value:function(o){this.manager||(this.manager=HLe());var s=o.begin,i=o.duration,l=o.attributeName,c=o.to,d=o.easing,u=o.onAnimationStart,f=o.onAnimationEnd,h=o.steps,m=o.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof d=="function"||typeof m=="function"||d==="spring"){this.runJSAnimation(o);return}if(h.length>1){this.runStepAnimation(o);return}var g=l?Py({},l,c):c,y=S7(Object.keys(g),i,d);v.start([u,s,$d($d({},g),{},{transition:y}),i,f])}},{key:"render",value:function(){var o=this.props,s=o.children;o.begin;var i=o.duration;o.attributeName,o.easing;var l=o.isActive;o.steps,o.from,o.to,o.canBegin,o.onAnimationEnd,o.shouldReAnimate,o.onAnimationReStart;var c=wFe(o,bFe),d=p.Children.count(s),u=this.state.style;if(typeof s=="function")return s(u);if(!l||d===0||i<=0)return s;var f=function(m){var v=m.props,g=v.style,y=g===void 0?{}:g,x=v.className,b=p.cloneElement(m,$d($d({},c),{},{style:$d($d({},y),u),className:x}));return b};return d===1?f(p.Children.only(s)):_e.createElement("div",null,p.Children.map(s,function(h){return f(h)}))}}]),r}(p.PureComponent);ZC.displayName="Animate";ZC.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ZC.propTypes={from:Jn.oneOfType([Jn.object,Jn.string]),to:Jn.oneOfType([Jn.object,Jn.string]),attributeName:Jn.string,duration:Jn.number,begin:Jn.number,easing:Jn.oneOfType([Jn.string,Jn.func]),steps:Jn.arrayOf(Jn.shape({duration:Jn.number.isRequired,style:Jn.object.isRequired,easing:Jn.oneOfType([Jn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Jn.func]),properties:Jn.arrayOf("string"),onAnimationEnd:Jn.func})),children:Jn.oneOfType([Jn.node,Jn.func]),isActive:Jn.bool,canBegin:Jn.bool,onAnimationEnd:Jn.func,shouldReAnimate:Jn.bool,onAnimationStart:Jn.func,onAnimationReStart:Jn.func};const Sh=ZC;function ea(){return ea=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ea.apply(null,arguments)}function IN(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function EQ(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,II(e,t)}function bw(e){"@babel/helpers - typeof";return bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bw(e)}function ON(){return ON=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ON.apply(this,arguments)}function TFe(e,t){return LFe(e)||RFe(e,t)||MFe(e,t)||DFe()}function DFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MFe(e,t){if(e){if(typeof e=="string")return O7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O7(e,t)}}function O7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function LFe(e){if(Array.isArray(e))return e}function T7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function D7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T7(Object(r),!0).forEach(function(n){FFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FFe(e,t,r){return t=$Fe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Fe(e){var t=BFe(e,"string");return bw(t)=="symbol"?t:t+""}function BFe(e,t){if(bw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M7=function(t,r,n,o,s){var i=Math.min(Math.abs(n)/2,Math.abs(o)/2),l=o>=0?1:-1,c=n>=0?1:-1,d=o>=0&&n>=0||o<0&&n<0?1:0,u;if(i>0&&s instanceof Array){for(var f=[0,0,0,0],h=0,m=4;h<m;h++)f[h]=s[h]>i?i:s[h];u="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(r)),u+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+l*f[1])),u+="L ".concat(t+n,",").concat(r+o-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+n-c*f[2],",").concat(r+o)),u+="L ".concat(t+c*f[3],",").concat(r+o),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+o-l*f[3])),u+="Z"}else if(i>0&&s===+s&&s>0){var v=Math.min(i,s);u="M ".concat(t,",").concat(r+l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+c*v,",").concat(r,`
            L `).concat(t+n-c*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n,",").concat(r+l*v,`
            L `).concat(t+n,",").concat(r+o-l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n-c*v,",").concat(r+o,`
            L `).concat(t+c*v,",").concat(r+o,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t,",").concat(r+o-l*v," Z")}else u="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(o," h ").concat(-n," Z");return u},qFe=function(t,r){if(!t||!r)return!1;var n=t.x,o=t.y,s=r.x,i=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(s,s+l),u=Math.max(s,s+l),f=Math.min(i,i+c),h=Math.max(i,i+c);return n>=d&&n<=u&&o>=f&&o<=h}return!1},zFe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},JD=function(t){var r=D7(D7({},zFe),t),n=p.useRef(),o=p.useState(-1),s=TFe(o,2),i=s[0],l=s[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var j=n.current.getTotalLength();j&&l(j)}catch{}},[]);var c=r.x,d=r.y,u=r.width,f=r.height,h=r.radius,m=r.className,v=r.animationEasing,g=r.animationDuration,y=r.animationBegin,x=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||u===0||f===0)return null;var w=pa("recharts-rectangle",m);return b?_e.createElement(Sh,{canBegin:i>0,from:{width:u,height:f,x:c,y:d},to:{width:u,height:f,x:c,y:d},duration:g,animationEasing:v,isActive:b},function(j){var _=j.width,C=j.height,E=j.x,A=j.y;return _e.createElement(Sh,{canBegin:i>0,from:"0px ".concat(i===-1?1:i,"px"),to:"".concat(i,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,isActive:x,easing:v},_e.createElement("path",ON({},Kn(r,!0),{className:w,d:M7(E,A,_,C,h),ref:n})))}):_e.createElement("path",ON({},Kn(r,!0),{className:w,d:M7(c,d,u,f,h)}))},UFe=["points","className","baseLinePoints","connectNulls"];function Mv(){return Mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mv.apply(this,arguments)}function VFe(e,t){if(e==null)return{};var r=WFe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function R7(e){return XFe(e)||KFe(e)||GFe(e)||HFe()}function HFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GFe(e,t){if(e){if(typeof e=="string")return TO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TO(e,t)}}function KFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XFe(e){if(Array.isArray(e))return TO(e)}function TO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L7=function(t){return t&&t.x===+t.x&&t.y===+t.y},YFe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){L7(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),L7(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},rb=function(t,r){var n=YFe(t);r&&(n=[n.reduce(function(s,i){return[].concat(R7(s),R7(i))},[])]);var o=n.map(function(s){return s.reduce(function(i,l,c){return"".concat(i).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(o,"Z"):o},JFe=function(t,r,n){var o=rb(t,n);return"".concat(o.slice(-1)==="Z"?o.slice(0,-1):o,"L").concat(rb(r.reverse(),n).slice(1))},QFe=function(t){var r=t.points,n=t.className,o=t.baseLinePoints,s=t.connectNulls,i=VFe(t,UFe);if(!r||!r.length)return null;var l=pa("recharts-polygon",n);if(o&&o.length){var c=i.stroke&&i.stroke!=="none",d=JFe(r,o,s);return _e.createElement("g",{className:l},_e.createElement("path",Mv({},Kn(i,!0),{fill:d.slice(-1)==="Z"?i.fill:"none",stroke:"none",d})),c?_e.createElement("path",Mv({},Kn(i,!0),{fill:"none",d:rb(r,s)})):null,c?_e.createElement("path",Mv({},Kn(i,!0),{fill:"none",d:rb(o,s)})):null)}var u=rb(r,s);return _e.createElement("path",Mv({},Kn(i,!0),{fill:u.slice(-1)==="Z"?i.fill:"none",className:l,d:u}))};function DO(){return DO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},DO.apply(this,arguments)}var y1=function(t){var r=t.cx,n=t.cy,o=t.r,s=t.className,i=pa("recharts-dot",s);return r===+r&&n===+n&&o===+o?p.createElement("circle",DO({},Kn(t,!1),J_(t),{className:i,cx:r,cy:n,r:o})):null};function ww(e){"@babel/helpers - typeof";return ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ww(e)}var ZFe=["x","y","top","left","width","height","className"];function MO(){return MO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MO.apply(this,arguments)}function F7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function e$e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F7(Object(r),!0).forEach(function(n){t$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function t$e(e,t,r){return t=r$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r$e(e){var t=n$e(e,"string");return ww(t)=="symbol"?t:t+""}function n$e(e,t){if(ww(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ww(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function a$e(e,t){if(e==null)return{};var r=o$e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var s$e=function(t,r,n,o,s,i){return"M".concat(t,",").concat(s,"v").concat(o,"M").concat(i,",").concat(r,"h").concat(n)},i$e=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,s=o===void 0?0:o,i=t.top,l=i===void 0?0:i,c=t.left,d=c===void 0?0:c,u=t.width,f=u===void 0?0:u,h=t.height,m=h===void 0?0:h,v=t.className,g=a$e(t,ZFe),y=e$e({x:n,y:s,top:l,left:d,width:f,height:m},g);return!en(n)||!en(s)||!en(f)||!en(m)||!en(l)||!en(d)?null:_e.createElement("path",MO({},Kn(y,!0),{className:pa("recharts-cross",v),d:s$e(n,s,f,m,l,d)}))},l$e=XC,c$e=qJ,d$e=Zu;function u$e(e,t){return e&&e.length?l$e(e,d$e(t),c$e):void 0}var f$e=u$e;const m$e=Ga(f$e);var h$e=XC,p$e=Zu,g$e=zJ;function v$e(e,t){return e&&e.length?h$e(e,p$e(t),g$e):void 0}var x$e=v$e;const y$e=Ga(x$e);var b$e=["cx","cy","angle","ticks","axisLine"],w$e=["ticks","tick","angle","tickFormatter","stroke"];function Ix(e){"@babel/helpers - typeof";return Ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ix(e)}function nb(){return nb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nb.apply(this,arguments)}function $7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Jh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$7(Object(r),!0).forEach(function(n){e5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B7(e,t){if(e==null)return{};var r=j$e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function j$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function _$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IQ(n.key),n)}}function N$e(e,t,r){return t&&q7(e.prototype,t),r&&q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S$e(e,t,r){return t=TN(t),C$e(e,kQ()?Reflect.construct(t,r||[],TN(e).constructor):t.apply(e,r))}function C$e(e,t){if(t&&(Ix(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P$e(e)}function P$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kQ=function(){return!!e})()}function TN(e){return TN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},TN(e)}function A$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RO(e,t)}function RO(e,t){return RO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RO(e,t)}function e5(e,t,r){return t=IQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IQ(e){var t=E$e(e,"string");return Ix(t)=="symbol"?t:t+""}function E$e(e,t){if(Ix(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ix(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t5=function(e){function t(){return _$e(this,t),S$e(this,t,arguments)}return A$e(t,e),N$e(t,[{key:"getTickValueCoord",value:function(n){var o=n.coordinate,s=this.props,i=s.angle,l=s.cx,c=s.cy;return Do(l,c,o,i)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,o;switch(n){case"left":o="end";break;case"right":o="start";break;default:o="middle";break}return o}},{key:"getViewBox",value:function(){var n=this.props,o=n.cx,s=n.cy,i=n.angle,l=n.ticks,c=m$e(l,function(u){return u.coordinate||0}),d=y$e(l,function(u){return u.coordinate||0});return{cx:o,cy:s,startAngle:i,endAngle:i,innerRadius:d.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,o=n.cx,s=n.cy,i=n.angle,l=n.ticks,c=n.axisLine,d=B7(n,b$e),u=l.reduce(function(v,g){return[Math.min(v[0],g.coordinate),Math.max(v[1],g.coordinate)]},[1/0,-1/0]),f=Do(o,s,u[0],i),h=Do(o,s,u[1],i),m=Jh(Jh(Jh({},Kn(d,!1)),{},{fill:"none"},Kn(c,!1)),{},{x1:f.x,y1:f.y,x2:h.x,y2:h.y});return _e.createElement("line",nb({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var n=this,o=this.props,s=o.ticks,i=o.tick,l=o.angle,c=o.tickFormatter,d=o.stroke,u=B7(o,w$e),f=this.getTickTextAnchor(),h=Kn(u,!1),m=Kn(i,!1),v=s.map(function(g,y){var x=n.getTickValueCoord(g),b=Jh(Jh(Jh(Jh({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(x.x,", ").concat(x.y,")")},h),{},{stroke:"none",fill:d},m),{},{index:y},x),{},{payload:g});return _e.createElement(Ta,nb({className:pa("recharts-polar-radius-axis-tick",gQ(i)),key:"tick-".concat(g.coordinate)},ng(n.props,g,y)),t.renderTickItem(i,b,c?c(g.value,y):g.value))});return _e.createElement(Ta,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var n=this.props,o=n.ticks,s=n.axisLine,i=n.tick;return!o||!o.length?null:_e.createElement(Ta,{className:pa("recharts-polar-radius-axis",this.props.className)},s&&this.renderAxisLine(),i&&this.renderTicks(),ii.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,o,s){var i;return _e.isValidElement(n)?i=_e.cloneElement(n,o):na(n)?i=n(o):i=_e.createElement(ag,nb({},o,{className:"recharts-polar-radius-axis-tick-value"}),s),i}}])}(p.PureComponent);e5(t5,"displayName","PolarRadiusAxis");e5(t5,"axisType","radiusAxis");e5(t5,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Ox(e){"@babel/helpers - typeof";return Ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ox(e)}function gp(){return gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gp.apply(this,arguments)}function z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Qh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z7(Object(r),!0).forEach(function(n){r5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TQ(n.key),n)}}function I$e(e,t,r){return t&&U7(e.prototype,t),r&&U7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O$e(e,t,r){return t=DN(t),T$e(e,OQ()?Reflect.construct(t,r||[],DN(e).constructor):t.apply(e,r))}function T$e(e,t){if(t&&(Ox(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D$e(e)}function D$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OQ=function(){return!!e})()}function DN(e){return DN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},DN(e)}function M$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LO(e,t)}function LO(e,t){return LO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LO(e,t)}function r5(e,t,r){return t=TQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TQ(e){var t=R$e(e,"string");return Ox(t)=="symbol"?t:t+""}function R$e(e,t){if(Ox(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ox(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L$e=Math.PI/180,V7=1e-5,n5=function(e){function t(){return k$e(this,t),O$e(this,t,arguments)}return M$e(t,e),I$e(t,[{key:"getTickLineCoord",value:function(n){var o=this.props,s=o.cx,i=o.cy,l=o.radius,c=o.orientation,d=o.tickSize,u=d||8,f=Do(s,i,l,n.coordinate),h=Do(s,i,l+(c==="inner"?-1:1)*u,n.coordinate);return{x1:f.x,y1:f.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(n){var o=this.props.orientation,s=Math.cos(-n.coordinate*L$e),i;return s>V7?i=o==="outer"?"start":"end":s<-V7?i=o==="outer"?"end":"start":i="middle",i}},{key:"renderAxisLine",value:function(){var n=this.props,o=n.cx,s=n.cy,i=n.radius,l=n.axisLine,c=n.axisLineType,d=Qh(Qh({},Kn(this.props,!1)),{},{fill:"none"},Kn(l,!1));if(c==="circle")return _e.createElement(y1,gp({className:"recharts-polar-angle-axis-line"},d,{cx:o,cy:s,r:i}));var u=this.props.ticks,f=u.map(function(h){return Do(o,s,i,h.coordinate)});return _e.createElement(QFe,gp({className:"recharts-polar-angle-axis-line"},d,{points:f}))}},{key:"renderTicks",value:function(){var n=this,o=this.props,s=o.ticks,i=o.tick,l=o.tickLine,c=o.tickFormatter,d=o.stroke,u=Kn(this.props,!1),f=Kn(i,!1),h=Qh(Qh({},u),{},{fill:"none"},Kn(l,!1)),m=s.map(function(v,g){var y=n.getTickLineCoord(v),x=n.getTickTextAnchor(v),b=Qh(Qh(Qh({textAnchor:x},u),{},{stroke:"none",fill:d},f),{},{index:g,payload:v,x:y.x2,y:y.y2});return _e.createElement(Ta,gp({className:pa("recharts-polar-angle-axis-tick",gQ(i)),key:"tick-".concat(v.coordinate)},ng(n.props,v,g)),l&&_e.createElement("line",gp({className:"recharts-polar-angle-axis-tick-line"},h,y)),i&&t.renderTickItem(i,b,c?c(v.value,g):v.value))});return _e.createElement(Ta,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var n=this.props,o=n.ticks,s=n.radius,i=n.axisLine;return s<=0||!o||!o.length?null:_e.createElement(Ta,{className:pa("recharts-polar-angle-axis",this.props.className)},i&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,o,s){var i;return _e.isValidElement(n)?i=_e.cloneElement(n,o):na(n)?i=n(o):i=_e.createElement(ag,gp({},o,{className:"recharts-polar-angle-axis-tick-value"}),s),i}}])}(p.PureComponent);r5(n5,"displayName","PolarAngleAxis");r5(n5,"axisType","angleAxis");r5(n5,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var F$e=LY,$$e=F$e(Object.getPrototypeOf,Object),B$e=$$e,q$e=tm,z$e=B$e,U$e=rm,V$e="[object Object]",W$e=Function.prototype,H$e=Object.prototype,DQ=W$e.toString,G$e=H$e.hasOwnProperty,K$e=DQ.call(Object);function X$e(e){if(!U$e(e)||q$e(e)!=V$e)return!1;var t=z$e(e);if(t===null)return!0;var r=G$e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&DQ.call(r)==K$e}var Y$e=X$e;const J$e=Ga(Y$e);var Q$e=tm,Z$e=rm,e6e="[object Boolean]";function t6e(e){return e===!0||e===!1||Z$e(e)&&Q$e(e)==e6e}var r6e=t6e;const n6e=Ga(r6e);function jw(e){"@babel/helpers - typeof";return jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jw(e)}function MN(){return MN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MN.apply(this,arguments)}function a6e(e,t){return l6e(e)||i6e(e,t)||s6e(e,t)||o6e()}function o6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s6e(e,t){if(e){if(typeof e=="string")return W7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W7(e,t)}}function W7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i6e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function l6e(e){if(Array.isArray(e))return e}function H7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function G7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H7(Object(r),!0).forEach(function(n){c6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c6e(e,t,r){return t=d6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d6e(e){var t=u6e(e,"string");return jw(t)=="symbol"?t:t+""}function u6e(e,t){if(jw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K7=function(t,r,n,o,s){var i=n-o,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-i/2,",").concat(r+s),l+="L ".concat(t+n-i/2-o,",").concat(r+s),l+="L ".concat(t,",").concat(r," Z"),l},f6e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},m6e=function(t){var r=G7(G7({},f6e),t),n=p.useRef(),o=p.useState(-1),s=a6e(o,2),i=s[0],l=s[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&l(w)}catch{}},[]);var c=r.x,d=r.y,u=r.upperWidth,f=r.lowerWidth,h=r.height,m=r.className,v=r.animationEasing,g=r.animationDuration,y=r.animationBegin,x=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||h!==+h||u===0&&f===0||h===0)return null;var b=pa("recharts-trapezoid",m);return x?_e.createElement(Sh,{canBegin:i>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:d},to:{upperWidth:u,lowerWidth:f,height:h,x:c,y:d},duration:g,animationEasing:v,isActive:x},function(w){var j=w.upperWidth,_=w.lowerWidth,C=w.height,E=w.x,A=w.y;return _e.createElement(Sh,{canBegin:i>0,from:"0px ".concat(i===-1?1:i,"px"),to:"".concat(i,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,easing:v},_e.createElement("path",MN({},Kn(r,!0),{className:b,d:K7(E,A,j,_,C),ref:n})))}):_e.createElement("g",null,_e.createElement("path",MN({},Kn(r,!0),{className:b,d:K7(c,d,u,f,h)})))},h6e=["option","shapeType","propTransformer","activeClassName","isActive"];function _w(e){"@babel/helpers - typeof";return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}function p6e(e,t){if(e==null)return{};var r=g6e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function X7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function RN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X7(Object(r),!0).forEach(function(n){v6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v6e(e,t,r){return t=x6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x6e(e){var t=y6e(e,"string");return _w(t)=="symbol"?t:t+""}function y6e(e,t){if(_w(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_w(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function b6e(e,t){return RN(RN({},t),e)}function w6e(e,t){return e==="symbols"}function Y7(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return _e.createElement(JD,r);case"trapezoid":return _e.createElement(m6e,r);case"sector":return _e.createElement(YD,r);case"symbols":if(w6e(t))return _e.createElement(pD,r);break;default:return null}}function j6e(e){return p.isValidElement(e)?e.props:e}function MQ(e){var t=e.option,r=e.shapeType,n=e.propTransformer,o=n===void 0?b6e:n,s=e.activeClassName,i=s===void 0?"recharts-active-shape":s,l=e.isActive,c=p6e(e,h6e),d;if(p.isValidElement(t))d=p.cloneElement(t,RN(RN({},c),j6e(t)));else if(na(t))d=t(c);else if(J$e(t)&&!n6e(t)){var u=o(t,c);d=_e.createElement(Y7,{shapeType:r,elementProps:u})}else{var f=c;d=_e.createElement(Y7,{shapeType:r,elementProps:f})}return l?_e.createElement(Ta,{className:i},d):d}function a5(e,t){return t!=null&&"trapezoids"in e.props}function o5(e,t){return t!=null&&"sectors"in e.props}function Nw(e,t){return t!=null&&"points"in e.props}function _6e(e,t){var r,n,o=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,s=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return o&&s}function N6e(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function S6e(e,t){var r=e.x===t.x,n=e.y===t.y,o=e.z===t.z;return r&&n&&o}function C6e(e,t){var r;return a5(e,t)?r=_6e:o5(e,t)?r=N6e:Nw(e,t)&&(r=S6e),r}function P6e(e,t){var r;return a5(e,t)?r="trapezoids":o5(e,t)?r="sectors":Nw(e,t)&&(r="points"),r}function A6e(e,t){if(a5(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(o5(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Nw(e,t)?t.payload:{}}function E6e(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,o=P6e(r,t),s=A6e(r,t),i=n.filter(function(c,d){var u=og(s,c),f=r.props[o].filter(function(v){var g=C6e(r,t);return g(v,t)}),h=r.props[o].indexOf(f[f.length-1]),m=d===h;return u&&m}),l=n.indexOf(i[i.length-1]);return l}var Gj;function Tx(e){"@babel/helpers - typeof";return Tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tx(e)}function Rv(){return Rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rv.apply(this,arguments)}function J7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Eo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J7(Object(r),!0).forEach(function(n){cd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LQ(n.key),n)}}function I6e(e,t,r){return t&&Q7(e.prototype,t),r&&Q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O6e(e,t,r){return t=LN(t),T6e(e,RQ()?Reflect.construct(t,r||[],LN(e).constructor):t.apply(e,r))}function T6e(e,t){if(t&&(Tx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D6e(e)}function D6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RQ=function(){return!!e})()}function LN(e){return LN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LN(e)}function M6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FO(e,t)}function FO(e,t){return FO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FO(e,t)}function cd(e,t,r){return t=LQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LQ(e){var t=R6e(e,"string");return Tx(t)=="symbol"?t:t+""}function R6e(e,t){if(Tx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yu=function(e){function t(r){var n;return k6e(this,t),n=O6e(this,t,[r]),cd(n,"pieRef",null),cd(n,"sectorRefs",[]),cd(n,"id",Ng("recharts-pie-")),cd(n,"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),na(o)&&o()}),cd(n,"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),na(o)&&o()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return M6e(t,e),I6e(t,[{key:"isActiveIndex",value:function(n){var o=this.props.activeIndex;return Array.isArray(o)?o.indexOf(n)!==-1:n===o}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var s=this.props,i=s.label,l=s.labelLine,c=s.dataKey,d=s.valueKey,u=Kn(this.props,!1),f=Kn(i,!1),h=Kn(l,!1),m=i&&i.offsetRadius||20,v=n.map(function(g,y){var x=(g.startAngle+g.endAngle)/2,b=Do(g.cx,g.cy,g.outerRadius+m,x),w=Eo(Eo(Eo(Eo({},u),g),{},{stroke:"none"},f),{},{index:y,textAnchor:t.getTextAnchor(b.x,g.cx)},b),j=Eo(Eo(Eo(Eo({},u),g),{},{fill:"none",stroke:g.fill},h),{},{index:y,points:[Do(g.cx,g.cy,g.outerRadius,x),b]}),_=c;return ua(c)&&ua(d)?_="value":ua(c)&&(_=d),_e.createElement(Ta,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(y)},l&&t.renderLabelLineItem(l,j,"line"),t.renderLabelItem(i,w,_s(g,_)))});return _e.createElement(Ta,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(n){var o=this,s=this.props,i=s.activeShape,l=s.blendStroke,c=s.inactiveShape;return n.map(function(d,u){if(d?.startAngle===0&&d?.endAngle===0&&n.length!==1)return null;var f=o.isActiveIndex(u),h=c&&o.hasActiveIndex()?c:null,m=f?i:h,v=Eo(Eo({},d),{},{stroke:l?d.fill:d.stroke,tabIndex:-1});return _e.createElement(Ta,Rv({ref:function(y){y&&!o.sectorRefs.includes(y)&&o.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},ng(o.props,d,u),{key:"sector-".concat(d?.startAngle,"-").concat(d?.endAngle,"-").concat(d.midAngle,"-").concat(u)}),_e.createElement(MQ,Rv({option:m,isActive:f,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,o=this.props,s=o.sectors,i=o.isAnimationActive,l=o.animationBegin,c=o.animationDuration,d=o.animationEasing,u=o.animationId,f=this.state,h=f.prevSectors,m=f.prevIsAnimationActive;return _e.createElement(Sh,{begin:l,duration:c,isActive:i,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var g=v.t,y=[],x=s&&s[0],b=x.startAngle;return s.forEach(function(w,j){var _=h&&h[j],C=j>0?Ec(w,"paddingAngle",0):0;if(_){var E=Xs(_.endAngle-_.startAngle,w.endAngle-w.startAngle),A=Eo(Eo({},w),{},{startAngle:b+C,endAngle:b+E(g)+C});y.push(A),b=A.endAngle}else{var P=w.endAngle,F=w.startAngle,M=Xs(0,P-F),I=M(g),R=Eo(Eo({},w),{},{startAngle:b+C,endAngle:b+I+C});y.push(R),b=R.endAngle}}),_e.createElement(Ta,null,n.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(n){var o=this;n.onkeydown=function(s){if(!s.altKey)switch(s.key){case"ArrowLeft":{var i=++o.state.sectorToFocus%o.sectorRefs.length;o.sectorRefs[i].focus(),o.setState({sectorToFocus:i});break}case"ArrowRight":{var l=--o.state.sectorToFocus<0?o.sectorRefs.length-1:o.state.sectorToFocus%o.sectorRefs.length;o.sectorRefs[l].focus(),o.setState({sectorToFocus:l});break}case"Escape":{o.sectorRefs[o.state.sectorToFocus].blur(),o.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,o=n.sectors,s=n.isAnimationActive,i=this.state.prevSectors;return s&&o&&o.length&&(!i||!og(i,o))?this.renderSectorsWithAnimation():this.renderSectorsStatically(o)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,o=this.props,s=o.hide,i=o.sectors,l=o.className,c=o.label,d=o.cx,u=o.cy,f=o.innerRadius,h=o.outerRadius,m=o.isAnimationActive,v=this.state.isAnimationFinished;if(s||!i||!i.length||!en(d)||!en(u)||!en(f)||!en(h))return null;var g=pa("recharts-pie",l);return _e.createElement(Ta,{tabIndex:this.props.rootTabIndex,className:g,ref:function(x){n.pieRef=x}},this.renderSectors(),c&&this.renderLabels(i),ii.renderCallByParent(this.props,null,!1),(!m||v)&&Vu.renderCallByParent(this.props,i,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return o.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:o.curSectors,isAnimationFinished:!0}:n.sectors!==o.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,o){return n>o?"start":n<o?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,o,s){if(_e.isValidElement(n))return _e.cloneElement(n,o);if(na(n))return n(o);var i=pa("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return _e.createElement(Bp,Rv({},o,{key:s,type:"linear",className:i}))}},{key:"renderLabelItem",value:function(n,o,s){if(_e.isValidElement(n))return _e.cloneElement(n,o);var i=s;if(na(n)&&(i=n(o),_e.isValidElement(i)))return i;var l=pa("recharts-pie-label-text",typeof n!="boolean"&&!na(n)?n.className:"");return _e.createElement(ag,Rv({},o,{alignmentBaseline:"middle",className:l}),i)}}])}(p.PureComponent);Gj=Yu;cd(Yu,"displayName","Pie");cd(Yu,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!ou.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});cd(Yu,"parseDeltaAngle",function(e,t){var r=hl(t-e),n=Math.min(Math.abs(t-e),360);return r*n});cd(Yu,"getRealPieData",function(e){var t=e.data,r=e.children,n=Kn(e,!1),o=kc(r,ew);return t&&t.length?t.map(function(s,i){return Eo(Eo(Eo({payload:s},n),s),o&&o[i]&&o[i].props)}):o&&o.length?o.map(function(s){return Eo(Eo({},n),s.props)}):[]});cd(Yu,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,o=t.width,s=t.height,i=pQ(o,s),l=n+pl(e.cx,o,o/2),c=r+pl(e.cy,s,s/2),d=pl(e.innerRadius,i,0),u=pl(e.outerRadius,i,i*.8),f=e.maxRadius||Math.sqrt(o*o+s*s)/2;return{cx:l,cy:c,innerRadius:d,outerRadius:u,maxRadius:f}});cd(Yu,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?Eo(Eo({},t.type.defaultProps),t.props):t.props,o=Gj.getRealPieData(n);if(!o||!o.length)return null;var s=n.cornerRadius,i=n.startAngle,l=n.endAngle,c=n.paddingAngle,d=n.dataKey,u=n.nameKey,f=n.valueKey,h=n.tooltipType,m=Math.abs(n.minAngle),v=Gj.parseCoordinateOfPie(n,r),g=Gj.parseDeltaAngle(i,l),y=Math.abs(g),x=d;ua(d)&&ua(f)?(au(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x="value"):ua(d)&&(au(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x=f);var b=o.filter(function(A){return _s(A,x,0)!==0}).length,w=(y>=360?b:b-1)*c,j=y-b*m-w,_=o.reduce(function(A,P){var F=_s(P,x,0);return A+(en(F)?F:0)},0),C;if(_>0){var E;C=o.map(function(A,P){var F=_s(A,x,0),M=_s(A,u,P),I=(en(F)?F:0)/_,R;P?R=E.endAngle+hl(g)*c*(F!==0?1:0):R=i;var D=R+hl(g)*((F!==0?m:0)+I*j),U=(R+D)/2,z=(v.innerRadius+v.outerRadius)/2,H=[{name:M,value:F,payload:A,dataKey:x,type:h}],q=Do(v.cx,v.cy,z,U);return E=Eo(Eo(Eo({percent:I,cornerRadius:s,name:M,tooltipPayload:H,midAngle:U,middleRadius:z,tooltipPosition:q},A),v),{},{value:_s(A,x),startAngle:R,endAngle:D,payload:A,paddingAngle:hl(g)*c}),E})}return Eo(Eo({},v),{},{sectors:C,data:o})});var L6e=Math.ceil,F6e=Math.max;function $6e(e,t,r,n){for(var o=-1,s=F6e(L6e((t-e)/(r||1)),0),i=Array(s);s--;)i[n?s:++o]=e,e+=r;return i}var B6e=$6e,q6e=rJ,Z7=1/0,z6e=17976931348623157e292;function U6e(e){if(!e)return e===0?e:0;if(e=q6e(e),e===Z7||e===-Z7){var t=e<0?-1:1;return t*z6e}return e===e?e:0}var FQ=U6e,V6e=B6e,W6e=zC,UA=FQ;function H6e(e){return function(t,r,n){return n&&typeof n!="number"&&W6e(t,r,n)&&(r=n=void 0),t=UA(t),r===void 0?(r=t,t=0):r=UA(r),n=n===void 0?t<r?1:-1:UA(n),V6e(t,r,n,e)}}var G6e=H6e,K6e=G6e,X6e=K6e(),Y6e=X6e;const FN=Ga(Y6e);function Sw(e){"@babel/helpers - typeof";return Sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sw(e)}function eq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function tq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eq(Object(r),!0).forEach(function(n){$Q(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $Q(e,t,r){return t=J6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J6e(e){var t=Q6e(e,"string");return Sw(t)=="symbol"?t:t+""}function Q6e(e,t){if(Sw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z6e=["Webkit","Moz","O","ms"],e8e=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(s){return s.toUpperCase()}),o=Z6e.reduce(function(s,i){return tq(tq({},s),{},$Q({},i+n,r))},{});return o[t]=r,o};function Dx(e){"@babel/helpers - typeof";return Dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dx(e)}function $N(){return $N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$N.apply(this,arguments)}function rq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function VA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rq(Object(r),!0).forEach(function(n){fc(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function t8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qQ(n.key),n)}}function r8e(e,t,r){return t&&nq(e.prototype,t),r&&nq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n8e(e,t,r){return t=BN(t),a8e(e,BQ()?Reflect.construct(t,r||[],BN(e).constructor):t.apply(e,r))}function a8e(e,t){if(t&&(Dx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o8e(e)}function o8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BQ=function(){return!!e})()}function BN(e){return BN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},BN(e)}function s8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$O(e,t)}function $O(e,t){return $O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$O(e,t)}function fc(e,t,r){return t=qQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qQ(e){var t=i8e(e,"string");return Dx(t)=="symbol"?t:t+""}function i8e(e,t){if(Dx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l8e=function(t){var r=t.data,n=t.startIndex,o=t.endIndex,s=t.x,i=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=Zy().domain(FN(0,c)).range([s,s+i-l]),u=d.domain().map(function(f){return d(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(o),scale:d,scaleValues:u}},aq=function(t){return t.changedTouches&&!!t.changedTouches.length},Mx=function(e){function t(r){var n;return t8e(this,t),n=n8e(this,t,[r]),fc(n,"handleDrag",function(o){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(o):n.state.isSlideMoving&&n.handleSlideDrag(o)}),fc(n,"handleTouchMove",function(o){o.changedTouches!=null&&o.changedTouches.length>0&&n.handleDrag(o.changedTouches[0])}),fc(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var o=n.props,s=o.endIndex,i=o.onDragEnd,l=o.startIndex;i?.({endIndex:s,startIndex:l})}),n.detachDragEndListener()}),fc(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),fc(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),fc(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),fc(n,"handleSlideDragStart",function(o){var s=aq(o)?o.changedTouches[0]:o;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:s.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return s8e(t,e),r8e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var o=n.startX,s=n.endX,i=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,f=Math.min(o,s),h=Math.max(o,s),m=t.getIndexInRange(i,f),v=t.getIndexInRange(i,h);return{startIndex:m-m%c,endIndex:v===u?u:v-v%c}}},{key:"getTextOfTick",value:function(n){var o=this.props,s=o.data,i=o.tickFormatter,l=o.dataKey,c=_s(s[n],l,n);return na(i)?i(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var o=this.state,s=o.slideMoveStartX,i=o.startX,l=o.endX,c=this.props,d=c.x,u=c.width,f=c.travellerWidth,h=c.startIndex,m=c.endIndex,v=c.onChange,g=n.pageX-s;g>0?g=Math.min(g,d+u-f-l,d+u-f-i):g<0&&(g=Math.max(g,d-i,d-l));var y=this.getIndex({startX:i+g,endX:l+g});(y.startIndex!==h||y.endIndex!==m)&&v&&v(y),this.setState({startX:i+g,endX:l+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,o){var s=aq(o)?o.changedTouches[0]:o;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:s.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var o=this.state,s=o.brushMoveStartX,i=o.movingTravellerId,l=o.endX,c=o.startX,d=this.state[i],u=this.props,f=u.x,h=u.width,m=u.travellerWidth,v=u.onChange,g=u.gap,y=u.data,x={startX:this.state.startX,endX:this.state.endX},b=n.pageX-s;b>0?b=Math.min(b,f+h-m-d):b<0&&(b=Math.max(b,f-d)),x[i]=d+b;var w=this.getIndex(x),j=w.startIndex,_=w.endIndex,C=function(){var A=y.length-1;return i==="startX"&&(l>c?j%g===0:_%g===0)||l<c&&_===A||i==="endX"&&(l>c?_%g===0:j%g===0)||l>c&&_===A};this.setState(fc(fc({},i,d+b),"brushMoveStartX",n.pageX),function(){v&&C()&&v(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,o){var s=this,i=this.state,l=i.scaleValues,c=i.startX,d=i.endX,u=this.state[o],f=l.indexOf(u);if(f!==-1){var h=f+n;if(!(h===-1||h>=l.length)){var m=l[h];o==="startX"&&m>=d||o==="endX"&&m<=c||this.setState(fc({},o,m),function(){s.props.onChange(s.getIndex({startX:s.state.startX,endX:s.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,o=n.x,s=n.y,i=n.width,l=n.height,c=n.fill,d=n.stroke;return _e.createElement("rect",{stroke:d,fill:c,x:o,y:s,width:i,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,o=n.x,s=n.y,i=n.width,l=n.height,c=n.data,d=n.children,u=n.padding,f=p.Children.only(d);return f?_e.cloneElement(f,{x:o,y:s,width:i,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,o){var s,i,l=this,c=this.props,d=c.y,u=c.travellerWidth,f=c.height,h=c.traveller,m=c.ariaLabel,v=c.data,g=c.startIndex,y=c.endIndex,x=Math.max(n,this.props.x),b=VA(VA({},Kn(this.props,!1)),{},{x,y:d,width:u,height:f}),w=m||"Min value: ".concat((s=v[g])===null||s===void 0?void 0:s.name,", Max value: ").concat((i=v[y])===null||i===void 0?void 0:i.name);return _e.createElement(Ta,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[o],onTouchStart:this.travellerDragStartHandlers[o],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),l.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,o))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,b))}},{key:"renderSlide",value:function(n,o){var s=this.props,i=s.y,l=s.height,c=s.stroke,d=s.travellerWidth,u=Math.min(n,o)+d,f=Math.max(Math.abs(o-n)-d,0);return _e.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:i,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,o=n.startIndex,s=n.endIndex,i=n.y,l=n.height,c=n.travellerWidth,d=n.stroke,u=this.state,f=u.startX,h=u.endX,m=5,v={pointerEvents:"none",fill:d};return _e.createElement(Ta,{className:"recharts-brush-texts"},_e.createElement(ag,$N({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-m,y:i+l/2},v),this.getTextOfTick(o)),_e.createElement(ag,$N({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+c+m,y:i+l/2},v),this.getTextOfTick(s)))}},{key:"render",value:function(){var n=this.props,o=n.data,s=n.className,i=n.children,l=n.x,c=n.y,d=n.width,u=n.height,f=n.alwaysShowText,h=this.state,m=h.startX,v=h.endX,g=h.isTextActive,y=h.isSlideMoving,x=h.isTravellerMoving,b=h.isTravellerFocused;if(!o||!o.length||!en(l)||!en(c)||!en(d)||!en(u)||d<=0||u<=0)return null;var w=pa("recharts-brush",s),j=_e.Children.count(i)===1,_=e8e("userSelect","none");return _e.createElement(Ta,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(m,v),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(v,"endX"),(g||y||x||b||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var o=n.x,s=n.y,i=n.width,l=n.height,c=n.stroke,d=Math.floor(s+l/2)-1;return _e.createElement(_e.Fragment,null,_e.createElement("rect",{x:o,y:s,width:i,height:l,fill:c,stroke:"none"}),_e.createElement("line",{x1:o+1,y1:d,x2:o+i-1,y2:d,fill:"none",stroke:"#fff"}),_e.createElement("line",{x1:o+1,y1:d+2,x2:o+i-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,o){var s;return _e.isValidElement(n)?s=_e.cloneElement(n,o):na(n)?s=n(o):s=t.renderDefaultTraveller(o),s}},{key:"getDerivedStateFromProps",value:function(n,o){var s=n.data,i=n.width,l=n.x,c=n.travellerWidth,d=n.updateId,u=n.startIndex,f=n.endIndex;if(s!==o.prevData||d!==o.prevUpdateId)return VA({prevData:s,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:i},s&&s.length?l8e({data:s,width:i,x:l,travellerWidth:c,startIndex:u,endIndex:f}):{scale:null,scaleValues:null});if(o.scale&&(i!==o.prevWidth||l!==o.prevX||c!==o.prevTravellerWidth)){o.scale.range([l,l+i-c]);var h=o.scale.domain().map(function(m){return o.scale(m)});return{prevData:s,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:i,startX:o.scale(n.startIndex),endX:o.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,o){for(var s=n.length,i=0,l=s-1;l-i>1;){var c=Math.floor((i+l)/2);n[c]>o?l=c:i=c}return o>=n[l]?l:i}}])}(p.PureComponent);fc(Mx,"displayName","Brush");fc(Mx,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var c8e=jD;function d8e(e,t){var r;return c8e(e,function(n,o,s){return r=t(n,o,s),!r}),!!r}var u8e=d8e,f8e=EY,m8e=Zu,h8e=u8e,p8e=Jl,g8e=zC;function v8e(e,t,r){var n=p8e(e)?f8e:h8e;return r&&g8e(e,t,r)&&(t=void 0),n(e,m8e(t))}var x8e=v8e;const y8e=Ga(x8e);var Wu=function(t,r){var n=t.alwaysShow,o=t.ifOverflow;return n&&(o="extendDomain"),o===r},oq=JY;function b8e(e,t,r){t=="__proto__"&&oq?oq(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var w8e=b8e,j8e=w8e,_8e=XY,N8e=Zu;function S8e(e,t){var r={};return t=N8e(t),_8e(e,function(n,o,s){j8e(r,o,t(n,o,s))}),r}var C8e=S8e;const P8e=Ga(C8e);function A8e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var E8e=A8e,k8e=jD;function I8e(e,t){var r=!0;return k8e(e,function(n,o,s){return r=!!t(n,o,s),r}),r}var O8e=I8e,T8e=E8e,D8e=O8e,M8e=Zu,R8e=Jl,L8e=zC;function F8e(e,t,r){var n=R8e(e)?T8e:D8e;return r&&L8e(e,t,r)&&(t=void 0),n(e,M8e(t))}var $8e=F8e;const zQ=Ga($8e);var B8e=["x","y"];function Cw(e){"@babel/helpers - typeof";return Cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cw(e)}function BO(){return BO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BO.apply(this,arguments)}function sq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sq(Object(r),!0).forEach(function(n){q8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q8e(e,t,r){return t=z8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z8e(e){var t=U8e(e,"string");return Cw(t)=="symbol"?t:t+""}function U8e(e,t){if(Cw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V8e(e,t){if(e==null)return{};var r=W8e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function W8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function H8e(e,t){var r=e.x,n=e.y,o=V8e(e,B8e),s="".concat(r),i=parseInt(s,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||o.height),u=parseInt(d,10),f="".concat(t.width||o.width),h=parseInt(f,10);return uy(uy(uy(uy(uy({},t),o),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function iq(e){return _e.createElement(MQ,BO({shapeType:"rectangle",propTransformer:H8e,activeClassName:"recharts-active-bar"},e))}var G8e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,o){if(typeof t=="number")return t;var s=en(n)||__e(n);return s?t(n,o):(s||Nh(!1),r)}},K8e=["value","background"],UQ;function Rx(e){"@babel/helpers - typeof";return Rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rx(e)}function X8e(e,t){if(e==null)return{};var r=Y8e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Y8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function qN(){return qN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qN.apply(this,arguments)}function lq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ks(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lq(Object(r),!0).forEach(function(n){Vm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WQ(n.key),n)}}function Q8e(e,t,r){return t&&cq(e.prototype,t),r&&cq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z8e(e,t,r){return t=zN(t),eBe(e,VQ()?Reflect.construct(t,r||[],zN(e).constructor):t.apply(e,r))}function eBe(e,t){if(t&&(Rx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tBe(e)}function tBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(VQ=function(){return!!e})()}function zN(e){return zN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zN(e)}function rBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qO(e,t)}function qO(e,t){return qO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qO(e,t)}function Vm(e,t,r){return t=WQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WQ(e){var t=nBe(e,"string");return Rx(t)=="symbol"?t:t+""}function nBe(e,t){if(Rx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ag=function(e){function t(){var r;J8e(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r=Z8e(this,t,[].concat(o)),Vm(r,"state",{isAnimationFinished:!1}),Vm(r,"id",Ng("recharts-bar-")),Vm(r,"handleAnimationEnd",function(){var i=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),i&&i()}),Vm(r,"handleAnimationStart",function(){var i=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),i&&i()}),r}return rBe(t,e),Q8e(t,[{key:"renderRectanglesStatically",value:function(n){var o=this,s=this.props,i=s.shape,l=s.dataKey,c=s.activeIndex,d=s.activeBar,u=Kn(this.props,!1);return n&&n.map(function(f,h){var m=h===c,v=m?d:i,g=ks(ks(ks({},u),f),{},{isActive:m,option:v,index:h,dataKey:l,onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd});return _e.createElement(Ta,qN({className:"recharts-bar-rectangle"},ng(o.props,f,h),{key:"rectangle-".concat(f?.x,"-").concat(f?.y,"-").concat(f?.value,"-").concat(h)}),_e.createElement(iq,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,o=this.props,s=o.data,i=o.layout,l=o.isAnimationActive,c=o.animationBegin,d=o.animationDuration,u=o.animationEasing,f=o.animationId,h=this.state.prevData;return _e.createElement(Sh,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var v=m.t,g=s.map(function(y,x){var b=h&&h[x];if(b){var w=Xs(b.x,y.x),j=Xs(b.y,y.y),_=Xs(b.width,y.width),C=Xs(b.height,y.height);return ks(ks({},y),{},{x:w(v),y:j(v),width:_(v),height:C(v)})}if(i==="horizontal"){var E=Xs(0,y.height),A=E(v);return ks(ks({},y),{},{y:y.y+y.height-A,height:A})}var P=Xs(0,y.width),F=P(v);return ks(ks({},y),{},{width:F})});return _e.createElement(Ta,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,o=n.data,s=n.isAnimationActive,i=this.state.prevData;return s&&o&&o.length&&(!i||!og(i,o))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(o)}},{key:"renderBackground",value:function(){var n=this,o=this.props,s=o.data,i=o.dataKey,l=o.activeIndex,c=Kn(this.props.background,!1);return s.map(function(d,u){d.value;var f=d.background,h=X8e(d,K8e);if(!f)return null;var m=ks(ks(ks(ks(ks({},h),{},{fill:"#eee"},f),c),ng(n.props,d,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:i,index:u,className:"recharts-bar-background-rectangle"});return _e.createElement(iq,qN({key:"background-bar-".concat(u),option:n.props.background,isActive:u===l},m))})}},{key:"renderErrorBar",value:function(n,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,i=s.data,l=s.xAxis,c=s.yAxis,d=s.layout,u=s.children,f=kc(u,x1);if(!f)return null;var h=d==="vertical"?i[0].height/2:i[0].width/2,m=function(y,x){var b=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:b,errorVal:_s(y,x)}},v={clipPath:n?"url(#clipPath-".concat(o,")"):null};return _e.createElement(Ta,v,f.map(function(g){return _e.cloneElement(g,{key:"error-bar-".concat(o,"-").concat(g.props.dataKey),data:i,xAxis:l,yAxis:c,layout:d,offset:h,dataPointFormatter:m})}))}},{key:"render",value:function(){var n=this.props,o=n.hide,s=n.data,i=n.className,l=n.xAxis,c=n.yAxis,d=n.left,u=n.top,f=n.width,h=n.height,m=n.isAnimationActive,v=n.background,g=n.id;if(o||!s||!s.length)return null;var y=this.state.isAnimationFinished,x=pa("recharts-bar",i),b=l&&l.allowDataOverflow,w=c&&c.allowDataOverflow,j=b||w,_=ua(g)?this.id:g;return _e.createElement(Ta,{className:x},b||w?_e.createElement("defs",null,_e.createElement("clipPath",{id:"clipPath-".concat(_)},_e.createElement("rect",{x:b?d:d-f/2,y:w?u:u-h/2,width:b?f:f*2,height:w?h:h*2}))):null,_e.createElement(Ta,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(_,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,_),(!m||y)&&Vu.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:o.curData}:n.data!==o.curData?{curData:n.data}:null}}])}(p.PureComponent);UQ=Ag;Vm(Ag,"displayName","Bar");Vm(Ag,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!ou.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Vm(Ag,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,o=e.bandSize,s=e.xAxis,i=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=FMe(n,r);if(!m)return null;var v=t.layout,g=r.type.defaultProps,y=g!==void 0?ks(ks({},g),r.props):r.props,x=y.dataKey,b=y.children,w=y.minPointSize,j=v==="horizontal"?i:s,_=d?j.scale.domain():null,C=WMe({numericAxis:j}),E=kc(b,ew),A=f.map(function(P,F){var M,I,R,D,U,z;d?M=$Me(d[u+F],_):(M=_s(P,x),Array.isArray(M)||(M=[C,M]));var H=G8e(w,UQ.defaultProps.minPointSize)(M[1],F);if(v==="horizontal"){var q,Q=[i.scale(M[0]),i.scale(M[1])],pe=Q[0],be=Q[1];I=JB({axis:s,ticks:l,bandSize:o,offset:m.offset,entry:P,index:F}),R=(q=be??pe)!==null&&q!==void 0?q:void 0,D=m.size;var V=pe-be;if(U=Number.isNaN(V)?0:V,z={x:I,y:i.y,width:D,height:i.height},Math.abs(H)>0&&Math.abs(U)<Math.abs(H)){var B=hl(U||H)*(Math.abs(H)-Math.abs(U));R-=B,U+=B}}else{var J=[s.scale(M[0]),s.scale(M[1])],ue=J[0],Ne=J[1];if(I=ue,R=JB({axis:i,ticks:c,bandSize:o,offset:m.offset,entry:P,index:F}),D=Ne-ue,U=m.size,z={x:s.x,y:R,width:s.width,height:U},Math.abs(H)>0&&Math.abs(D)<Math.abs(H)){var Z=hl(D||H)*(Math.abs(H)-Math.abs(D));D+=Z}}return ks(ks(ks({},P),{},{x:I,y:R,width:D,height:U,value:d?M:M[1],payload:P,background:z},E&&E[F]&&E[F].props),{},{tooltipPayload:[mQ(r,P)],tooltipPosition:{x:I+D/2,y:R+U/2}})});return ks({data:A,layout:v},h)});function Pw(e){"@babel/helpers - typeof";return Pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pw(e)}function aBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HQ(n.key),n)}}function oBe(e,t,r){return t&&dq(e.prototype,t),r&&dq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Gd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uq(Object(r),!0).forEach(function(n){s5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s5(e,t,r){return t=HQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HQ(e){var t=sBe(e,"string");return Pw(t)=="symbol"?t:t+""}function sBe(e,t){if(Pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QD=function(t,r,n,o,s){var i=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),f={left:n.left,leftMirror:n.left,right:i-n.right,rightMirror:i-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},h=!!gc(d,Ag);return u.reduce(function(m,v){var g=r[v],y=g.orientation,x=g.domain,b=g.padding,w=b===void 0?{}:b,j=g.mirror,_=g.reversed,C="".concat(y).concat(j?"Mirror":""),E,A,P,F,M;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var I=x[1]-x[0],R=1/0,D=g.categoricalDomain.sort(C_e);if(D.forEach(function(J,ue){ue>0&&(R=Math.min((J||0)-(D[ue-1]||0),R))}),Number.isFinite(R)){var U=R/I,z=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(E=U*z/2),g.padding==="no-gap"){var H=pl(t.barCategoryGap,U*z),q=U*z/2;E=q-H-(q-H)/z*H}}}o==="xAxis"?A=[n.left+(w.left||0)+(E||0),n.left+n.width-(w.right||0)-(E||0)]:o==="yAxis"?A=c==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(E||0),n.top+n.height-(w.bottom||0)-(E||0)]:A=g.range,_&&(A=[A[1],A[0]]);var Q=cQ(g,s,h),pe=Q.scale,be=Q.realScaleType;pe.domain(x).range(A),dQ(pe);var V=uQ(pe,Gd(Gd({},g),{},{realScaleType:be}));o==="xAxis"?(M=y==="top"&&!j||y==="bottom"&&j,P=n.left,F=f[C]-M*g.height):o==="yAxis"&&(M=y==="left"&&!j||y==="right"&&j,P=f[C]-M*g.width,F=n.top);var B=Gd(Gd(Gd({},g),V),{},{realScaleType:be,x:P,y:F,scale:pe,width:o==="xAxis"?n.width:g.width,height:o==="yAxis"?n.height:g.height});return B.bandSize=SN(B,V),!g.hide&&o==="xAxis"?f[C]+=(M?-1:1)*B.height:g.hide||(f[C]+=(M?-1:1)*B.width),Gd(Gd({},m),{},s5({},v,B))},{})},GQ=function(t,r){var n=t.x,o=t.y,s=r.x,i=r.y;return{x:Math.min(n,s),y:Math.min(o,i),width:Math.abs(s-n),height:Math.abs(i-o)}},iBe=function(t){var r=t.x1,n=t.y1,o=t.x2,s=t.y2;return GQ({x:r,y:n},{x:o,y:s})},KQ=function(){function e(t){aBe(this,e),this.scale=t}return oBe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.bandAware,s=n.position;if(r!==void 0){if(s)switch(s){case"start":return this.scale(r);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+i}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(o){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),o=n[0],s=n[n.length-1];return o<=s?r>=o&&r<=s:r>=s&&r<=o}}],[{key:"create",value:function(r){return new e(r)}}])}();s5(KQ,"EPS",1e-4);var ZD=function(t){var r=Object.keys(t).reduce(function(n,o){return Gd(Gd({},n),{},s5({},o,KQ.create(t[o])))},{});return Gd(Gd({},r),{},{apply:function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=s.bandAware,l=s.position;return P8e(o,function(c,d){return r[d].apply(c,{bandAware:i,position:l})})},isInRange:function(o){return zQ(o,function(s,i){return r[i].isInRange(s)})}})};function lBe(e){return(e%180+180)%180}var cBe=function(t){var r=t.width,n=t.height,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=lBe(o),i=s*Math.PI/180,l=Math.atan(n/r),c=i>l&&i<Math.PI-l?n/Math.sin(i):r/Math.cos(i);return Math.abs(c)},dBe=Zu,uBe=m1,fBe=BC;function mBe(e){return function(t,r,n){var o=Object(t);if(!uBe(t)){var s=dBe(r);t=fBe(t),r=function(l){return s(o[l],l,o)}}var i=e(t,r,n);return i>-1?o[s?t[i]:i]:void 0}}var hBe=mBe,pBe=FQ;function gBe(e){var t=pBe(e),r=t%1;return t===t?r?t-r:t:0}var vBe=gBe,xBe=UY,yBe=Zu,bBe=vBe,wBe=Math.max;function jBe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var o=r==null?0:bBe(r);return o<0&&(o=wBe(n+o,0)),xBe(e,yBe(t),o)}var _Be=jBe,NBe=hBe,SBe=_Be,CBe=NBe(SBe),PBe=CBe;const ABe=Ga(PBe);var EBe=Pje(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),eM=p.createContext(void 0),tM=p.createContext(void 0),XQ=p.createContext(void 0),YQ=p.createContext({}),JQ=p.createContext(void 0),QQ=p.createContext(0),ZQ=p.createContext(0),fq=function(t){var r=t.state,n=r.xAxisMap,o=r.yAxisMap,s=r.offset,i=t.clipPathId,l=t.children,c=t.width,d=t.height,u=EBe(s);return _e.createElement(eM.Provider,{value:n},_e.createElement(tM.Provider,{value:o},_e.createElement(YQ.Provider,{value:s},_e.createElement(XQ.Provider,{value:u},_e.createElement(JQ.Provider,{value:i},_e.createElement(QQ.Provider,{value:d},_e.createElement(ZQ.Provider,{value:c},l)))))))},kBe=function(){return p.useContext(JQ)},eZ=function(t){var r=p.useContext(eM);r==null&&Nh(!1);var n=r[t];return n==null&&Nh(!1),n},IBe=function(){var t=p.useContext(eM);return Dm(t)},OBe=function(){var t=p.useContext(tM),r=ABe(t,function(n){return zQ(n.domain,Number.isFinite)});return r||Dm(t)},tZ=function(t){var r=p.useContext(tM);r==null&&Nh(!1);var n=r[t];return n==null&&Nh(!1),n},TBe=function(){var t=p.useContext(XQ);return t},DBe=function(){return p.useContext(YQ)},rM=function(){return p.useContext(ZQ)},nM=function(){return p.useContext(QQ)};function Lx(e){"@babel/helpers - typeof";return Lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lx(e)}function MBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nZ(n.key),n)}}function RBe(e,t,r){return t&&mq(e.prototype,t),r&&mq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LBe(e,t,r){return t=UN(t),FBe(e,rZ()?Reflect.construct(t,r||[],UN(e).constructor):t.apply(e,r))}function FBe(e,t){if(t&&(Lx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Be(e)}function $Be(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rZ=function(){return!!e})()}function UN(e){return UN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},UN(e)}function BBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zO(e,t)}function hq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function pq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hq(Object(r),!0).forEach(function(n){aM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aM(e,t,r){return t=nZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nZ(e){var t=qBe(e,"string");return Lx(t)=="symbol"?t:t+""}function qBe(e,t){if(Lx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zBe(e,t){return HBe(e)||WBe(e,t)||VBe(e,t)||UBe()}function UBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VBe(e,t){if(e){if(typeof e=="string")return gq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gq(e,t)}}function gq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function HBe(e){if(Array.isArray(e))return e}function UO(){return UO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UO.apply(this,arguments)}var GBe=function(t,r){var n;return _e.isValidElement(t)?n=_e.cloneElement(t,r):na(t)?n=t(r):n=_e.createElement("line",UO({},r,{className:"recharts-reference-line-line"})),n},KBe=function(t,r,n,o,s,i,l,c,d){var u=s.x,f=s.y,h=s.width,m=s.height;if(n){var v=d.y,g=t.y.apply(v,{position:i});if(Wu(d,"discard")&&!t.y.isInRange(g))return null;var y=[{x:u+h,y:g},{x:u,y:g}];return c==="left"?y.reverse():y}if(r){var x=d.x,b=t.x.apply(x,{position:i});if(Wu(d,"discard")&&!t.x.isInRange(b))return null;var w=[{x:b,y:f+m},{x:b,y:f}];return l==="top"?w.reverse():w}if(o){var j=d.segment,_=j.map(function(C){return t.apply(C,{position:i})});return Wu(d,"discard")&&y8e(_,function(C){return!t.isInRange(C)})?null:_}return null};function XBe(e){var t=e.x,r=e.y,n=e.segment,o=e.xAxisId,s=e.yAxisId,i=e.shape,l=e.className,c=e.alwaysShow,d=kBe(),u=eZ(o),f=tZ(s),h=TBe();if(!d||!h)return null;au(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=ZD({x:u.scale,y:f.scale}),v=Js(t),g=Js(r),y=n&&n.length===2,x=KBe(m,v,g,y,h,e.position,u.orientation,f.orientation,e);if(!x)return null;var b=zBe(x,2),w=b[0],j=w.x,_=w.y,C=b[1],E=C.x,A=C.y,P=Wu(e,"hidden")?"url(#".concat(d,")"):void 0,F=pq(pq({clipPath:P},Kn(e,!0)),{},{x1:j,y1:_,x2:E,y2:A});return _e.createElement(Ta,{className:pa("recharts-reference-line",l)},GBe(i,F),ii.renderCallByParent(e,iBe({x1:j,y1:_,x2:E,y2:A})))}var oM=function(e){function t(){return MBe(this,t),LBe(this,t,arguments)}return BBe(t,e),RBe(t,[{key:"render",value:function(){return _e.createElement(XBe,this.props)}}])}(_e.Component);aM(oM,"displayName","ReferenceLine");aM(oM,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function VO(){return VO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VO.apply(this,arguments)}function Fx(e){"@babel/helpers - typeof";return Fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fx(e)}function vq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function xq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vq(Object(r),!0).forEach(function(n){i5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oZ(n.key),n)}}function JBe(e,t,r){return t&&yq(e.prototype,t),r&&yq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QBe(e,t,r){return t=VN(t),ZBe(e,aZ()?Reflect.construct(t,r||[],VN(e).constructor):t.apply(e,r))}function ZBe(e,t){if(t&&(Fx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e7e(e)}function e7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aZ=function(){return!!e})()}function VN(e){return VN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},VN(e)}function t7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WO(e,t)}function WO(e,t){return WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WO(e,t)}function i5(e,t,r){return t=oZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oZ(e){var t=r7e(e,"string");return Fx(t)=="symbol"?t:t+""}function r7e(e,t){if(Fx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n7e=function(t){var r=t.x,n=t.y,o=t.xAxis,s=t.yAxis,i=ZD({x:o.scale,y:s.scale}),l=i.apply({x:r,y:n},{bandAware:!0});return Wu(t,"discard")&&!i.isInRange(l)?null:l},l5=function(e){function t(){return YBe(this,t),QBe(this,t,arguments)}return t7e(t,e),JBe(t,[{key:"render",value:function(){var n=this.props,o=n.x,s=n.y,i=n.r,l=n.alwaysShow,c=n.clipPathId,d=Js(o),u=Js(s);if(au(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var f=n7e(this.props);if(!f)return null;var h=f.x,m=f.y,v=this.props,g=v.shape,y=v.className,x=Wu(this.props,"hidden")?"url(#".concat(c,")"):void 0,b=xq(xq({clipPath:x},Kn(this.props,!0)),{},{cx:h,cy:m});return _e.createElement(Ta,{className:pa("recharts-reference-dot",y)},t.renderDot(g,b),ii.renderCallByParent(this.props,{x:h-i,y:m-i,width:2*i,height:2*i}))}}])}(_e.Component);i5(l5,"displayName","ReferenceDot");i5(l5,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});i5(l5,"renderDot",function(e,t){var r;return _e.isValidElement(e)?r=_e.cloneElement(e,t):na(e)?r=e(t):r=_e.createElement(y1,VO({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function HO(){return HO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HO.apply(this,arguments)}function $x(e){"@babel/helpers - typeof";return $x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$x(e)}function bq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bq(Object(r),!0).forEach(function(n){c5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iZ(n.key),n)}}function o7e(e,t,r){return t&&jq(e.prototype,t),r&&jq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s7e(e,t,r){return t=WN(t),i7e(e,sZ()?Reflect.construct(t,r||[],WN(e).constructor):t.apply(e,r))}function i7e(e,t){if(t&&($x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l7e(e)}function l7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sZ=function(){return!!e})()}function WN(e){return WN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WN(e)}function c7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GO(e,t)}function c5(e,t,r){return t=iZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iZ(e){var t=d7e(e,"string");return $x(t)=="symbol"?t:t+""}function d7e(e,t){if($x(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($x(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u7e=function(t,r,n,o,s){var i=s.x1,l=s.x2,c=s.y1,d=s.y2,u=s.xAxis,f=s.yAxis;if(!u||!f)return null;var h=ZD({x:u.scale,y:f.scale}),m={x:t?h.x.apply(i,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(c,{position:"start"}):h.y.rangeMin},v={x:r?h.x.apply(l,{position:"end"}):h.x.rangeMax,y:o?h.y.apply(d,{position:"end"}):h.y.rangeMax};return Wu(s,"discard")&&(!h.isInRange(m)||!h.isInRange(v))?null:GQ(m,v)},d5=function(e){function t(){return a7e(this,t),s7e(this,t,arguments)}return c7e(t,e),o7e(t,[{key:"render",value:function(){var n=this.props,o=n.x1,s=n.x2,i=n.y1,l=n.y2,c=n.className,d=n.alwaysShow,u=n.clipPathId;au(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Js(o),h=Js(s),m=Js(i),v=Js(l),g=this.props.shape;if(!f&&!h&&!m&&!v&&!g)return null;var y=u7e(f,h,m,v,this.props);if(!y&&!g)return null;var x=Wu(this.props,"hidden")?"url(#".concat(u,")"):void 0;return _e.createElement(Ta,{className:pa("recharts-reference-area",c)},t.renderRect(g,wq(wq({clipPath:x},Kn(this.props,!0)),y)),ii.renderCallByParent(this.props,y))}}])}(_e.Component);c5(d5,"displayName","ReferenceArea");c5(d5,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});c5(d5,"renderRect",function(e,t){var r;return _e.isValidElement(e)?r=_e.cloneElement(e,t):na(e)?r=e(t):r=_e.createElement(JD,HO({},t,{className:"recharts-reference-area-rect"})),r});function lZ(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],o=0;o<e.length;o+=t)if(r===void 0||r(e[o])===!0)n.push(e[o]);else return;return n}function f7e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return cBe(n,r)}function m7e(e,t,r){var n=r==="width",o=e.x,s=e.y,i=e.width,l=e.height;return t===1?{start:n?o:s,end:n?o+i:s+l}:{start:n?o+i:s+l,end:n?o:s}}function HN(e,t,r,n,o){if(e*t<e*n||e*t>e*o)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-o)<=0}function h7e(e,t){return lZ(e,t+1)}function p7e(e,t,r,n,o){for(var s=(n||[]).slice(),i=t.start,l=t.end,c=0,d=1,u=i,f=function(){var v=n?.[c];if(v===void 0)return{v:lZ(n,d)};var g=c,y,x=function(){return y===void 0&&(y=r(v,g)),y},b=v.coordinate,w=c===0||HN(e,b,x,u,l);w||(c=0,u=i,d+=1),w&&(u=b+e*(x()/2+o),c+=d)},h;d<=s.length;)if(h=f(),h)return h.v;return[]}function Aw(e){"@babel/helpers - typeof";return Aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aw(e)}function _q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Vi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_q(Object(r),!0).forEach(function(n){g7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_q(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g7e(e,t,r){return t=v7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v7e(e){var t=x7e(e,"string");return Aw(t)=="symbol"?t:t+""}function x7e(e,t){if(Aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function y7e(e,t,r,n,o){for(var s=(n||[]).slice(),i=s.length,l=t.start,c=t.end,d=function(h){var m=s[h],v,g=function(){return v===void 0&&(v=r(m,h)),v};if(h===i-1){var y=e*(m.coordinate+e*g()/2-c);s[h]=m=Vi(Vi({},m),{},{tickCoord:y>0?m.coordinate-y*e:m.coordinate})}else s[h]=m=Vi(Vi({},m),{},{tickCoord:m.coordinate});var x=HN(e,m.tickCoord,g,l,c);x&&(c=m.tickCoord-e*(g()/2+o),s[h]=Vi(Vi({},m),{},{isShow:!0}))},u=i-1;u>=0;u--)d(u);return s}function b7e(e,t,r,n,o,s){var i=(n||[]).slice(),l=i.length,c=t.start,d=t.end;if(s){var u=n[l-1],f=r(u,l-1),h=e*(u.coordinate+e*f/2-d);i[l-1]=u=Vi(Vi({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate});var m=HN(e,u.tickCoord,function(){return f},c,d);m&&(d=u.tickCoord-e*(f/2+o),i[l-1]=Vi(Vi({},u),{},{isShow:!0}))}for(var v=s?l-1:l,g=function(b){var w=i[b],j,_=function(){return j===void 0&&(j=r(w,b)),j};if(b===0){var C=e*(w.coordinate-e*_()/2-c);i[b]=w=Vi(Vi({},w),{},{tickCoord:C<0?w.coordinate-C*e:w.coordinate})}else i[b]=w=Vi(Vi({},w),{},{tickCoord:w.coordinate});var E=HN(e,w.tickCoord,_,c,d);E&&(c=w.tickCoord+e*(_()/2+o),i[b]=Vi(Vi({},w),{},{isShow:!0}))},y=0;y<v;y++)g(y);return i}function sM(e,t,r){var n=e.tick,o=e.ticks,s=e.viewBox,i=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,f=e.angle;if(!o||!o.length||!n)return[];if(en(c)||ou.isSsr)return h7e(o,typeof c=="number"&&en(c)?c:0);var h=[],m=l==="top"||l==="bottom"?"width":"height",v=u&&m==="width"?Qy(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(w,j){var _=na(d)?d(w.value,j):w.value;return m==="width"?f7e(Qy(_,{fontSize:t,letterSpacing:r}),v,f):Qy(_,{fontSize:t,letterSpacing:r})[m]},y=o.length>=2?hl(o[1].coordinate-o[0].coordinate):1,x=m7e(s,y,m);return c==="equidistantPreserveStart"?p7e(y,x,g,o,i):(c==="preserveStart"||c==="preserveStartEnd"?h=b7e(y,x,g,o,i,c==="preserveStartEnd"):h=y7e(y,x,g,o,i),h.filter(function(b){return b.isShow}))}var w7e=["viewBox"],j7e=["viewBox"],_7e=["ticks"];function Bx(e){"@babel/helpers - typeof";return Bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bx(e)}function Lv(){return Lv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lv.apply(this,arguments)}function Nq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function zs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nq(Object(r),!0).forEach(function(n){iM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WA(e,t){if(e==null)return{};var r=N7e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function N7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function S7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dZ(n.key),n)}}function C7e(e,t,r){return t&&Sq(e.prototype,t),r&&Sq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P7e(e,t,r){return t=GN(t),A7e(e,cZ()?Reflect.construct(t,r||[],GN(e).constructor):t.apply(e,r))}function A7e(e,t){if(t&&(Bx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E7e(e)}function E7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cZ=function(){return!!e})()}function GN(e){return GN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},GN(e)}function k7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KO(e,t)}function KO(e,t){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KO(e,t)}function iM(e,t,r){return t=dZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dZ(e){var t=I7e(e,"string");return Bx(t)=="symbol"?t:t+""}function I7e(e,t){if(Bx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S0=function(e){function t(r){var n;return S7e(this,t),n=P7e(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return k7e(t,e),C7e(t,[{key:"shouldComponentUpdate",value:function(n,o){var s=n.viewBox,i=WA(n,w7e),l=this.props,c=l.viewBox,d=WA(l,j7e);return!Qv(s,c)||!Qv(i,d)||!Qv(o,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var o=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];o&&this.setState({fontSize:window.getComputedStyle(o).fontSize,letterSpacing:window.getComputedStyle(o).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var o=this.props,s=o.x,i=o.y,l=o.width,c=o.height,d=o.orientation,u=o.tickSize,f=o.mirror,h=o.tickMargin,m,v,g,y,x,b,w=f?-1:1,j=n.tickSize||u,_=en(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":m=v=n.coordinate,y=i+ +!f*c,g=y-w*j,b=g-w*h,x=_;break;case"left":g=y=n.coordinate,v=s+ +!f*l,m=v-w*j,x=m-w*h,b=_;break;case"right":g=y=n.coordinate,v=s+ +f*l,m=v+w*j,x=m+w*h,b=_;break;default:m=v=n.coordinate,y=i+ +f*c,g=y+w*j,b=g+w*h,x=_;break}return{line:{x1:m,y1:g,x2:v,y2:y},tick:{x,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,o=n.orientation,s=n.mirror,i;switch(o){case"left":i=s?"start":"end";break;case"right":i=s?"end":"start";break;default:i="middle";break}return i}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,o=n.orientation,s=n.mirror,i="end";switch(o){case"left":case"right":i="middle";break;case"top":i=s?"start":"end";break;default:i=s?"end":"start";break}return i}},{key:"renderAxisLine",value:function(){var n=this.props,o=n.x,s=n.y,i=n.width,l=n.height,c=n.orientation,d=n.mirror,u=n.axisLine,f=zs(zs(zs({},Kn(this.props,!1)),Kn(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var h=+(c==="top"&&!d||c==="bottom"&&d);f=zs(zs({},f),{},{x1:o,y1:s+h*l,x2:o+i,y2:s+h*l})}else{var m=+(c==="left"&&!d||c==="right"&&d);f=zs(zs({},f),{},{x1:o+m*i,y1:s,x2:o+m*i,y2:s+l})}return _e.createElement("line",Lv({},f,{className:pa("recharts-cartesian-axis-line",Ec(u,"className"))}))}},{key:"renderTicks",value:function(n,o,s){var i=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,f=l.tickFormatter,h=l.unit,m=sM(zs(zs({},this.props),{},{ticks:n}),o,s),v=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),y=Kn(this.props,!1),x=Kn(u,!1),b=zs(zs({},y),{},{fill:"none"},Kn(c,!1)),w=m.map(function(j,_){var C=i.getTickLineCoord(j),E=C.line,A=C.tick,P=zs(zs(zs(zs({textAnchor:v,verticalAnchor:g},y),{},{stroke:"none",fill:d},x),A),{},{index:_,payload:j,visibleTicksCount:m.length,tickFormatter:f});return _e.createElement(Ta,Lv({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},ng(i.props,j,_)),c&&_e.createElement("line",Lv({},b,E,{className:pa("recharts-cartesian-axis-tick-line",Ec(c,"className"))})),u&&t.renderTickItem(u,P,"".concat(na(f)?f(j.value,_):j.value).concat(h||"")))});return _e.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,o=this.props,s=o.axisLine,i=o.width,l=o.height,c=o.ticksGenerator,d=o.className,u=o.hide;if(u)return null;var f=this.props,h=f.ticks,m=WA(f,_7e),v=h;return na(c)&&(v=h&&h.length>0?c(this.props):c(m)),i<=0||l<=0||!v||!v.length?null:_e.createElement(Ta,{className:pa("recharts-cartesian-axis",d),ref:function(y){n.layerReference=y}},s&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),ii.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,o,s){var i,l=pa(o.className,"recharts-cartesian-axis-tick-value");return _e.isValidElement(n)?i=_e.cloneElement(n,zs(zs({},o),{},{className:l})):na(n)?i=n(zs(zs({},o),{},{className:l})):i=_e.createElement(ag,Lv({},o,{className:"recharts-cartesian-axis-tick-value"}),s),i}}])}(p.Component);iM(S0,"displayName","CartesianAxis");iM(S0,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var O7e=["x1","y1","x2","y2","key"],T7e=["offset"];function ig(e){"@babel/helpers - typeof";return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ig(e)}function Cq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Hi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cq(Object(r),!0).forEach(function(n){D7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D7e(e,t,r){return t=M7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M7e(e){var t=R7e(e,"string");return ig(t)=="symbol"?t:t+""}function R7e(e,t){if(ig(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ig(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cp.apply(this,arguments)}function Pq(e,t){if(e==null)return{};var r=L7e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function L7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var F7e=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,o=t.x,s=t.y,i=t.width,l=t.height,c=t.ry;return _e.createElement("rect",{x:o,y:s,ry:c,width:i,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function uZ(e,t){var r;if(_e.isValidElement(e))r=_e.cloneElement(e,t);else if(na(e))r=e(t);else{var n=t.x1,o=t.y1,s=t.x2,i=t.y2,l=t.key,c=Pq(t,O7e),d=Kn(c,!1);d.offset;var u=Pq(d,T7e);r=_e.createElement("line",Cp({},u,{x1:n,y1:o,x2:s,y2:i,fill:"none",key:l}))}return r}function $7e(e){var t=e.x,r=e.width,n=e.horizontal,o=n===void 0?!0:n,s=e.horizontalPoints;if(!o||!s||!s.length)return null;var i=s.map(function(l,c){var d=Hi(Hi({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return uZ(o,d)});return _e.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function B7e(e){var t=e.y,r=e.height,n=e.vertical,o=n===void 0?!0:n,s=e.verticalPoints;if(!o||!s||!s.length)return null;var i=s.map(function(l,c){var d=Hi(Hi({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return uZ(o,d)});return _e.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function q7e(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,o=e.y,s=e.width,i=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(h){return Math.round(h+o-o)}).sort(function(h,m){return h-m});o!==u[0]&&u.unshift(0);var f=u.map(function(h,m){var v=!u[m+1],g=v?o+i-h:u[m+1]-h;if(g<=0)return null;var y=m%t.length;return _e.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:g,width:s,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return _e.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function z7e(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,o=e.fillOpacity,s=e.x,i=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var u=d.map(function(h){return Math.round(h+s-s)}).sort(function(h,m){return h-m});s!==u[0]&&u.unshift(0);var f=u.map(function(h,m){var v=!u[m+1],g=v?s+l-h:u[m+1]-h;if(g<=0)return null;var y=m%n.length;return _e.createElement("rect",{key:"react-".concat(m),x:h,y:i,width:g,height:c,stroke:"none",fill:n[y],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return _e.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var U7e=function(t,r){var n=t.xAxis,o=t.width,s=t.height,i=t.offset;return lQ(sM(Hi(Hi(Hi({},S0.defaultProps),n),{},{ticks:Ef(n,!0),viewBox:{x:0,y:0,width:o,height:s}})),i.left,i.left+i.width,r)},V7e=function(t,r){var n=t.yAxis,o=t.width,s=t.height,i=t.offset;return lQ(sM(Hi(Hi(Hi({},S0.defaultProps),n),{},{ticks:Ef(n,!0),viewBox:{x:0,y:0,width:o,height:s}})),i.top,i.top+i.height,r)},Yg={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function XO(e){var t,r,n,o,s,i,l=rM(),c=nM(),d=DBe(),u=Hi(Hi({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Yg.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Yg.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Yg.horizontal,horizontalFill:(o=e.horizontalFill)!==null&&o!==void 0?o:Yg.horizontalFill,vertical:(s=e.vertical)!==null&&s!==void 0?s:Yg.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:Yg.verticalFill,x:en(e.x)?e.x:d.left,y:en(e.y)?e.y:d.top,width:en(e.width)?e.width:d.width,height:en(e.height)?e.height:d.height}),f=u.x,h=u.y,m=u.width,v=u.height,g=u.syncWithTicks,y=u.horizontalValues,x=u.verticalValues,b=IBe(),w=OBe();if(!en(m)||m<=0||!en(v)||v<=0||!en(f)||f!==+f||!en(h)||h!==+h)return null;var j=u.verticalCoordinatesGenerator||U7e,_=u.horizontalCoordinatesGenerator||V7e,C=u.horizontalPoints,E=u.verticalPoints;if((!C||!C.length)&&na(_)){var A=y&&y.length,P=_({yAxis:w?Hi(Hi({},w),{},{ticks:A?y:w.ticks}):void 0,width:l,height:c,offset:d},A?!0:g);au(Array.isArray(P),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(ig(P),"]")),Array.isArray(P)&&(C=P)}if((!E||!E.length)&&na(j)){var F=x&&x.length,M=j({xAxis:b?Hi(Hi({},b),{},{ticks:F?x:b.ticks}):void 0,width:l,height:c,offset:d},F?!0:g);au(Array.isArray(M),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(ig(M),"]")),Array.isArray(M)&&(E=M)}return _e.createElement("g",{className:"recharts-cartesian-grid"},_e.createElement(F7e,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),_e.createElement($7e,Cp({},u,{offset:d,horizontalPoints:C,xAxis:b,yAxis:w})),_e.createElement(B7e,Cp({},u,{offset:d,verticalPoints:E,xAxis:b,yAxis:w})),_e.createElement(q7e,Cp({},u,{horizontalPoints:C})),_e.createElement(z7e,Cp({},u,{verticalPoints:E})))}XO.displayName="CartesianGrid";var W7e=["type","layout","connectNulls","ref"],H7e=["key"];function qx(e){"@babel/helpers - typeof";return qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qx(e)}function Aq(e,t){if(e==null)return{};var r=G7e(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function G7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ab(){return ab=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ab.apply(this,arguments)}function Eq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Eq(Object(r),!0).forEach(function(n){Kd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Eq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jg(e){return J7e(e)||Y7e(e)||X7e(e)||K7e()}function K7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X7e(e,t){if(e){if(typeof e=="string")return YO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YO(e,t)}}function Y7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function J7e(e){if(Array.isArray(e))return YO(e)}function YO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mZ(n.key),n)}}function Z7e(e,t,r){return t&&kq(e.prototype,t),r&&kq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eqe(e,t,r){return t=KN(t),tqe(e,fZ()?Reflect.construct(t,r||[],KN(e).constructor):t.apply(e,r))}function tqe(e,t){if(t&&(qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rqe(e)}function rqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fZ=function(){return!!e})()}function KN(e){return KN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},KN(e)}function nqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JO(e,t)}function Kd(e,t,r){return t=mZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mZ(e){var t=aqe(e,"string");return qx(t)=="symbol"?t:t+""}function aqe(e,t){if(qx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b1=function(e){function t(){var r;Q7e(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r=eqe(this,t,[].concat(o)),Kd(r,"state",{isAnimationFinished:!0,totalLength:0}),Kd(r,"generateSimpleStrokeDasharray",function(i,l){return"".concat(l,"px ").concat(i-l,"px")}),Kd(r,"getStrokeDasharray",function(i,l,c){var d=c.reduce(function(x,b){return x+b});if(!d)return r.generateSimpleStrokeDasharray(l,i);for(var u=Math.floor(i/d),f=i%d,h=l-i,m=[],v=0,g=0;v<c.length;g+=c[v],++v)if(g+c[v]>f){m=[].concat(Jg(c.slice(0,v)),[f-g]);break}var y=m.length%2===0?[0,h]:[h];return[].concat(Jg(t.repeat(c,u)),Jg(m),y).map(function(x){return"".concat(x,"px")}).join(", ")}),Kd(r,"id",Ng("recharts-line-")),Kd(r,"pathRef",function(i){r.mainCurve=i}),Kd(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Kd(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return nqe(t,e),Z7e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,i=s.points,l=s.xAxis,c=s.yAxis,d=s.layout,u=s.children,f=kc(u,x1);if(!f)return null;var h=function(g,y){return{x:g.x,y:g.y,value:g.value,errorVal:_s(g.payload,y)}},m={clipPath:n?"url(#clipPath-".concat(o,")"):null};return _e.createElement(Ta,m,f.map(function(v){return _e.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:i,xAxis:l,yAxis:c,layout:d,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,o,s){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,u=l.dataKey,f=Kn(this.props,!1),h=Kn(c,!0),m=d.map(function(g,y){var x=dc(dc(dc({key:"dot-".concat(y),r:3},f),h),{},{index:y,cx:g.x,cy:g.y,value:g.value,dataKey:u,payload:g.payload,points:d});return t.renderDotItem(c,x)}),v={clipPath:n?"url(#clipPath-".concat(o?"":"dots-").concat(s,")"):null};return _e.createElement(Ta,ab({className:"recharts-line-dots",key:"dots"},v),m)}},{key:"renderCurveStatically",value:function(n,o,s,i){var l=this.props,c=l.type,d=l.layout,u=l.connectNulls;l.ref;var f=Aq(l,W7e),h=dc(dc(dc({},Kn(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:o?"url(#clipPath-".concat(s,")"):null,points:n},i),{},{type:c,layout:d,connectNulls:u});return _e.createElement(Bp,ab({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,o){var s=this,i=this.props,l=i.points,c=i.strokeDasharray,d=i.isAnimationActive,u=i.animationBegin,f=i.animationDuration,h=i.animationEasing,m=i.animationId,v=i.animateNewValues,g=i.width,y=i.height,x=this.state,b=x.prevPoints,w=x.totalLength;return _e.createElement(Sh,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var _=j.t;if(b){var C=b.length/l.length,E=l.map(function(I,R){var D=Math.floor(R*C);if(b[D]){var U=b[D],z=Xs(U.x,I.x),H=Xs(U.y,I.y);return dc(dc({},I),{},{x:z(_),y:H(_)})}if(v){var q=Xs(g*2,I.x),Q=Xs(y/2,I.y);return dc(dc({},I),{},{x:q(_),y:Q(_)})}return dc(dc({},I),{},{x:I.x,y:I.y})});return s.renderCurveStatically(E,n,o)}var A=Xs(0,w),P=A(_),F;if(c){var M="".concat(c).split(/[,\s]+/gim).map(function(I){return parseFloat(I)});F=s.getStrokeDasharray(P,w,M)}else F=s.generateSimpleStrokeDasharray(w,P);return s.renderCurveStatically(l,n,o,{strokeDasharray:F})})}},{key:"renderCurve",value:function(n,o){var s=this.props,i=s.points,l=s.isAnimationActive,c=this.state,d=c.prevPoints,u=c.totalLength;return l&&i&&i.length&&(!d&&u>0||!og(d,i))?this.renderCurveWithAnimation(n,o):this.renderCurveStatically(i,n,o)}},{key:"render",value:function(){var n,o=this.props,s=o.hide,i=o.dot,l=o.points,c=o.className,d=o.xAxis,u=o.yAxis,f=o.top,h=o.left,m=o.width,v=o.height,g=o.isAnimationActive,y=o.id;if(s||!l||!l.length)return null;var x=this.state.isAnimationFinished,b=l.length===1,w=pa("recharts-line",c),j=d&&d.allowDataOverflow,_=u&&u.allowDataOverflow,C=j||_,E=ua(y)?this.id:y,A=(n=Kn(i,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},P=A.r,F=P===void 0?3:P,M=A.strokeWidth,I=M===void 0?2:M,R=eY(i)?i:{},D=R.clipDot,U=D===void 0?!0:D,z=F*2+I;return _e.createElement(Ta,{className:w},j||_?_e.createElement("defs",null,_e.createElement("clipPath",{id:"clipPath-".concat(E)},_e.createElement("rect",{x:j?h:h-m/2,y:_?f:f-v/2,width:j?m:m*2,height:_?v:v*2})),!U&&_e.createElement("clipPath",{id:"clipPath-dots-".concat(E)},_e.createElement("rect",{x:h-z/2,y:f-z/2,width:m+z,height:v+z}))):null,!b&&this.renderCurve(C,E),this.renderErrorBar(C,E),(b||i)&&this.renderDots(C,U,E),(!g||x)&&Vu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:o.curPoints}:n.points!==o.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,o){for(var s=n.length%2!==0?[].concat(Jg(n),[0]):n,i=[],l=0;l<o;++l)i=[].concat(Jg(i),Jg(s));return i}},{key:"renderDotItem",value:function(n,o){var s;if(_e.isValidElement(n))s=_e.cloneElement(n,o);else if(na(n))s=n(o);else{var i=o.key,l=Aq(o,H7e),c=pa("recharts-line-dot",typeof n!="boolean"?n.className:"");s=_e.createElement(y1,ab({key:i},l,{className:c}))}return s}}])}(p.PureComponent);Kd(b1,"displayName","Line");Kd(b1,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!ou.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Kd(b1,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,o=e.xAxisTicks,s=e.yAxisTicks,i=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,u=t.layout,f=c.map(function(h,m){var v=_s(h,i);return u==="horizontal"?{x:NN({axis:r,ticks:o,bandSize:l,entry:h,index:m}),y:ua(v)?null:n.scale(v),value:v,payload:h}:{x:ua(v)?null:r.scale(v),y:NN({axis:n,ticks:s,bandSize:l,entry:h,index:m}),value:v,payload:h}});return dc({points:f,layout:u},d)});var oqe=["layout","type","stroke","connectNulls","isRange","ref"],sqe=["key"],hZ;function zx(e){"@babel/helpers - typeof";return zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zx(e)}function pZ(e,t){if(e==null)return{};var r=iqe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iqe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Pp(){return Pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pp.apply(this,arguments)}function Iq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Sm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Iq(Object(r),!0).forEach(function(n){Mu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vZ(n.key),n)}}function cqe(e,t,r){return t&&Oq(e.prototype,t),r&&Oq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dqe(e,t,r){return t=XN(t),uqe(e,gZ()?Reflect.construct(t,r||[],XN(e).constructor):t.apply(e,r))}function uqe(e,t){if(t&&(zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fqe(e)}function fqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gZ=function(){return!!e})()}function XN(e){return XN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},XN(e)}function mqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QO(e,t)}function QO(e,t){return QO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QO(e,t)}function Mu(e,t,r){return t=vZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vZ(e){var t=hqe(e,"string");return zx(t)=="symbol"?t:t+""}function hqe(e,t){if(zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bh=function(e){function t(){var r;lqe(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r=dqe(this,t,[].concat(o)),Mu(r,"state",{isAnimationFinished:!0}),Mu(r,"id",Ng("recharts-area-")),Mu(r,"handleAnimationEnd",function(){var i=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),na(i)&&i()}),Mu(r,"handleAnimationStart",function(){var i=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),na(i)&&i()}),r}return mqe(t,e),cqe(t,[{key:"renderDots",value:function(n,o,s){var i=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(i&&!l)return null;var c=this.props,d=c.dot,u=c.points,f=c.dataKey,h=Kn(this.props,!1),m=Kn(d,!0),v=u.map(function(y,x){var b=Sm(Sm(Sm({key:"dot-".concat(x),r:3},h),m),{},{index:x,cx:y.x,cy:y.y,dataKey:f,value:y.value,payload:y.payload,points:u});return t.renderDotItem(d,b)}),g={clipPath:n?"url(#clipPath-".concat(o?"":"dots-").concat(s,")"):null};return _e.createElement(Ta,Pp({className:"recharts-area-dots"},g),v)}},{key:"renderHorizontalRect",value:function(n){var o=this.props,s=o.baseLine,i=o.points,l=o.strokeWidth,c=i[0].x,d=i[i.length-1].x,u=n*Math.abs(c-d),f=Um(i.map(function(h){return h.y||0}));return en(s)&&typeof s=="number"?f=Math.max(s,f):s&&Array.isArray(s)&&s.length&&(f=Math.max(Um(s.map(function(h){return h.y||0})),f)),en(f)?_e.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(f+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var o=this.props,s=o.baseLine,i=o.points,l=o.strokeWidth,c=i[0].y,d=i[i.length-1].y,u=n*Math.abs(c-d),f=Um(i.map(function(h){return h.x||0}));return en(s)&&typeof s=="number"?f=Math.max(s,f):s&&Array.isArray(s)&&s.length&&(f=Math.max(Um(s.map(function(h){return h.x||0})),f)),en(f)?_e.createElement("rect",{x:0,y:c<d?c:c-u,width:f+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(n){var o=this.props.layout;return o==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,o,s,i){var l=this.props,c=l.layout,d=l.type,u=l.stroke,f=l.connectNulls,h=l.isRange;l.ref;var m=pZ(l,oqe);return _e.createElement(Ta,{clipPath:s?"url(#clipPath-".concat(i,")"):null},_e.createElement(Bp,Pp({},Kn(m,!0),{points:n,connectNulls:f,type:d,baseLine:o,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&_e.createElement(Bp,Pp({},Kn(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:n})),u!=="none"&&h&&_e.createElement(Bp,Pp({},Kn(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:o})))}},{key:"renderAreaWithAnimation",value:function(n,o){var s=this,i=this.props,l=i.points,c=i.baseLine,d=i.isAnimationActive,u=i.animationBegin,f=i.animationDuration,h=i.animationEasing,m=i.animationId,v=this.state,g=v.prevPoints,y=v.prevBaseLine;return _e.createElement(Sh,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var b=x.t;if(g){var w=g.length/l.length,j=l.map(function(A,P){var F=Math.floor(P*w);if(g[F]){var M=g[F],I=Xs(M.x,A.x),R=Xs(M.y,A.y);return Sm(Sm({},A),{},{x:I(b),y:R(b)})}return A}),_;if(en(c)&&typeof c=="number"){var C=Xs(y,c);_=C(b)}else if(ua(c)||x0(c)){var E=Xs(y,0);_=E(b)}else _=c.map(function(A,P){var F=Math.floor(P*w);if(y[F]){var M=y[F],I=Xs(M.x,A.x),R=Xs(M.y,A.y);return Sm(Sm({},A),{},{x:I(b),y:R(b)})}return A});return s.renderAreaStatically(j,_,n,o)}return _e.createElement(Ta,null,_e.createElement("defs",null,_e.createElement("clipPath",{id:"animationClipPath-".concat(o)},s.renderClipRect(b))),_e.createElement(Ta,{clipPath:"url(#animationClipPath-".concat(o,")")},s.renderAreaStatically(l,c,n,o)))})}},{key:"renderArea",value:function(n,o){var s=this.props,i=s.points,l=s.baseLine,c=s.isAnimationActive,d=this.state,u=d.prevPoints,f=d.prevBaseLine,h=d.totalLength;return c&&i&&i.length&&(!u&&h>0||!og(u,i)||!og(f,l))?this.renderAreaWithAnimation(n,o):this.renderAreaStatically(i,l,n,o)}},{key:"render",value:function(){var n,o=this.props,s=o.hide,i=o.dot,l=o.points,c=o.className,d=o.top,u=o.left,f=o.xAxis,h=o.yAxis,m=o.width,v=o.height,g=o.isAnimationActive,y=o.id;if(s||!l||!l.length)return null;var x=this.state.isAnimationFinished,b=l.length===1,w=pa("recharts-area",c),j=f&&f.allowDataOverflow,_=h&&h.allowDataOverflow,C=j||_,E=ua(y)?this.id:y,A=(n=Kn(i,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},P=A.r,F=P===void 0?3:P,M=A.strokeWidth,I=M===void 0?2:M,R=eY(i)?i:{},D=R.clipDot,U=D===void 0?!0:D,z=F*2+I;return _e.createElement(Ta,{className:w},j||_?_e.createElement("defs",null,_e.createElement("clipPath",{id:"clipPath-".concat(E)},_e.createElement("rect",{x:j?u:u-m/2,y:_?d:d-v/2,width:j?m:m*2,height:_?v:v*2})),!U&&_e.createElement("clipPath",{id:"clipPath-dots-".concat(E)},_e.createElement("rect",{x:u-z/2,y:d-z/2,width:m+z,height:v+z}))):null,b?null:this.renderArea(C,E),(i||b)&&this.renderDots(C,U,E),(!g||x)&&Vu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:o.curPoints,prevBaseLine:o.curBaseLine}:n.points!==o.curPoints||n.baseLine!==o.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(p.PureComponent);hZ=Bh;Mu(Bh,"displayName","Area");Mu(Bh,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!ou.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Mu(Bh,"getBaseValue",function(e,t,r,n){var o=e.layout,s=e.baseValue,i=t.props.baseValue,l=i??s;if(en(l)&&typeof l=="number")return l;var c=o==="horizontal"?n:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return l==="dataMin"?f:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});Mu(Bh,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,o=e.yAxis,s=e.xAxisTicks,i=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=t.layout,v=d&&d.length,g=hZ.getBaseValue(t,r,n,o),y=m==="horizontal",x=!1,b=f.map(function(j,_){var C;v?C=d[u+_]:(C=_s(j,c),Array.isArray(C)?x=!0:C=[g,C]);var E=C[1]==null||v&&_s(j,c)==null;return y?{x:NN({axis:n,ticks:s,bandSize:l,entry:j,index:_}),y:E?null:o.scale(C[1]),value:C,payload:j}:{x:E?null:n.scale(C[1]),y:NN({axis:o,ticks:i,bandSize:l,entry:j,index:_}),value:C,payload:j}}),w;return v||x?w=b.map(function(j){var _=Array.isArray(j.value)?j.value[0]:null;return y?{x:j.x,y:_!=null&&j.y!=null?o.scale(_):null}:{x:_!=null?n.scale(_):null,y:j.y}}):w=y?o.scale(g):n.scale(g),Sm({points:b,baseLine:w,layout:m,isRange:x},h)});Mu(Bh,"renderDotItem",function(e,t){var r;if(_e.isValidElement(e))r=_e.cloneElement(e,t);else if(na(e))r=e(t);else{var n=pa("recharts-area-dot",typeof e!="boolean"?e.className:""),o=t.key,s=pZ(t,sqe);r=_e.createElement(y1,Pp({},s,{key:o,className:n}))}return r});function Ux(e){"@babel/helpers - typeof";return Ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ux(e)}function pqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bZ(n.key),n)}}function gqe(e,t,r){return t&&Tq(e.prototype,t),r&&Tq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vqe(e,t,r){return t=YN(t),xqe(e,xZ()?Reflect.construct(t,r||[],YN(e).constructor):t.apply(e,r))}function xqe(e,t){if(t&&(Ux(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yqe(e)}function yqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xZ=function(){return!!e})()}function YN(e){return YN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},YN(e)}function bqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZO(e,t)}function yZ(e,t,r){return t=bZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bZ(e){var t=wqe(e,"string");return Ux(t)=="symbol"?t:t+""}function wqe(e,t){if(Ux(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ux(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eT(){return eT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eT.apply(this,arguments)}function jqe(e){var t=e.xAxisId,r=rM(),n=nM(),o=eZ(t);return o==null?null:p.createElement(S0,eT({},o,{className:pa("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(i){return Ef(i,!0)}}))}var lg=function(e){function t(){return pqe(this,t),vqe(this,t,arguments)}return bqe(t,e),gqe(t,[{key:"render",value:function(){return p.createElement(jqe,this.props)}}])}(p.Component);yZ(lg,"displayName","XAxis");yZ(lg,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Vx(e){"@babel/helpers - typeof";return Vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vx(e)}function _qe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Z(n.key),n)}}function Nqe(e,t,r){return t&&Dq(e.prototype,t),r&&Dq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sqe(e,t,r){return t=JN(t),Cqe(e,wZ()?Reflect.construct(t,r||[],JN(e).constructor):t.apply(e,r))}function Cqe(e,t){if(t&&(Vx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pqe(e)}function Pqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wZ=function(){return!!e})()}function JN(e){return JN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},JN(e)}function Aqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tT(e,t)}function tT(e,t){return tT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tT(e,t)}function jZ(e,t,r){return t=_Z(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Z(e){var t=Eqe(e,"string");return Vx(t)=="symbol"?t:t+""}function Eqe(e,t){if(Vx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rT(){return rT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rT.apply(this,arguments)}var kqe=function(t){var r=t.yAxisId,n=rM(),o=nM(),s=tZ(r);return s==null?null:p.createElement(S0,rT({},s,{className:pa("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:n,height:o},ticksGenerator:function(l){return Ef(l,!0)}}))},cg=function(e){function t(){return _qe(this,t),Sqe(this,t,arguments)}return Aqe(t,e),Nqe(t,[{key:"render",value:function(){return p.createElement(kqe,this.props)}}])}(p.Component);jZ(cg,"displayName","YAxis");jZ(cg,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function Mq(e){return Dqe(e)||Tqe(e)||Oqe(e)||Iqe()}function Iqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oqe(e,t){if(e){if(typeof e=="string")return nT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nT(e,t)}}function Tqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dqe(e){if(Array.isArray(e))return nT(e)}function nT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var aT=function(t,r,n,o,s){var i=kc(t,oM),l=kc(t,l5),c=[].concat(Mq(i),Mq(l)),d=kc(t,d5),u="".concat(o,"Id"),f=o[0],h=r;if(c.length&&(h=c.reduce(function(g,y){if(y.props[u]===n&&Wu(y.props,"extendDomain")&&en(y.props[f])){var x=y.props[f];return[Math.min(g[0],x),Math.max(g[1],x)]}return g},h)),d.length){var m="".concat(f,"1"),v="".concat(f,"2");h=d.reduce(function(g,y){if(y.props[u]===n&&Wu(y.props,"extendDomain")&&en(y.props[m])&&en(y.props[v])){var x=y.props[m],b=y.props[v];return[Math.min(g[0],x,b),Math.max(g[1],x,b)]}return g},h)}return s&&s.length&&(h=s.reduce(function(g,y){return en(y)?[Math.min(g[0],y),Math.max(g[1],y)]:g},h)),h},NZ={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function o(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function s(c,d,u,f,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new o(u,f||c,h),v=r?r+d:d;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],m]:c._events[v].push(m):(c._events[v]=m,c._eventsCount++),c}function i(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,v=new Array(m);h<m;h++)v[h]=f[h].fn;return v},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,h,m,v){var g=r?r+d:d;if(!this._events[g])return!1;var y=this._events[g],x=arguments.length,b,w;if(y.fn){switch(y.once&&this.removeListener(d,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,f),!0;case 4:return y.fn.call(y.context,u,f,h),!0;case 5:return y.fn.call(y.context,u,f,h,m),!0;case 6:return y.fn.call(y.context,u,f,h,m,v),!0}for(w=1,b=new Array(x-1);w<x;w++)b[w-1]=arguments[w];y.fn.apply(y.context,b)}else{var j=y.length,_;for(w=0;w<j;w++)switch(y[w].once&&this.removeListener(d,y[w].fn,void 0,!0),x){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,u);break;case 3:y[w].fn.call(y[w].context,u,f);break;case 4:y[w].fn.call(y[w].context,u,f,h);break;default:if(!b)for(_=1,b=new Array(x-1);_<x;_++)b[_-1]=arguments[_];y[w].fn.apply(y[w].context,b)}}return!0},l.prototype.on=function(d,u,f){return s(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return s(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,h){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return i(this,m),this;var v=this._events[m];if(v.fn)v.fn===u&&(!h||v.once)&&(!f||v.context===f)&&i(this,m);else{for(var g=0,y=[],x=v.length;g<x;g++)(v[g].fn!==u||h&&!v[g].once||f&&v[g].context!==f)&&y.push(v[g]);y.length?this._events[m]=y.length===1?y[0]:y:i(this,m)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&i(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(NZ);var Mqe=NZ.exports;const Rqe=Ga(Mqe);var HA=new Rqe,GA="recharts.syncMouseEvents";function Ew(e){"@babel/helpers - typeof";return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(e)}function Lqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SZ(n.key),n)}}function Fqe(e,t,r){return t&&Rq(e.prototype,t),r&&Rq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KA(e,t,r){return t=SZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SZ(e){var t=$qe(e,"string");return Ew(t)=="symbol"?t:t+""}function $qe(e,t){if(Ew(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ew(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bqe=function(){function e(){Lqe(this,e),KA(this,"activeIndex",0),KA(this,"coordinateList",[]),KA(this,"layout","horizontal")}return Fqe(e,[{key:"setDetails",value:function(r){var n,o=r.coordinateList,s=o===void 0?null:o,i=r.container,l=i===void 0?null:i,c=r.layout,d=c===void 0?null:c,u=r.offset,f=u===void 0?null:u,h=r.mouseHandlerCallback,m=h===void 0?null:h;this.coordinateList=(n=s??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=d??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var o=this.container.getBoundingClientRect(),s=o.x,i=o.y,l=o.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=s+c+d,h=i+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function qqe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e?.[0],o=e?.[1];if(n&&o&&en(n)&&en(o))return!0}return!1}function zqe(e,t,r,n){var o=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-o:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-o,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function CZ(e){var t=e.cx,r=e.cy,n=e.radius,o=e.startAngle,s=e.endAngle,i=Do(t,r,n,o),l=Do(t,r,n,s);return{points:[i,l],cx:t,cy:r,radius:n,startAngle:o,endAngle:s}}function Uqe(e,t,r){var n,o,s,i;if(e==="horizontal")n=t.x,s=n,o=r.top,i=r.top+r.height;else if(e==="vertical")o=t.y,i=o,n=r.left,s=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,f=t.angle,h=Do(l,c,d,f),m=Do(l,c,u,f);n=h.x,o=h.y,s=m.x,i=m.y}else return CZ(t);return[{x:n,y:o},{x:s,y:i}]}function kw(e){"@babel/helpers - typeof";return kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kw(e)}function Lq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ej(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lq(Object(r),!0).forEach(function(n){Vqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vqe(e,t,r){return t=Wqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wqe(e){var t=Hqe(e,"string");return kw(t)=="symbol"?t:t+""}function Hqe(e,t){if(kw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gqe(e){var t,r,n=e.element,o=e.tooltipEventType,s=e.isActive,i=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,u=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,m=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!m||!s||!i||h!=="ScatterChart"&&o!=="axis")return null;var v,g=Bp;if(h==="ScatterChart")v=i,g=i$e;else if(h==="BarChart")v=zqe(f,i,c,u),g=JD;else if(f==="radial"){var y=CZ(i),x=y.cx,b=y.cy,w=y.radius,j=y.startAngle,_=y.endAngle;v={cx:x,cy:b,startAngle:j,endAngle:_,innerRadius:w,outerRadius:w},g=YD}else v={points:Uqe(f,i,c)},g=Bp;var C=ej(ej(ej(ej({stroke:"#ccc",pointerEvents:"none"},c),v),Kn(m,!1)),{},{payload:l,payloadIndex:d,className:pa("recharts-tooltip-cursor",m.className)});return p.isValidElement(m)?p.cloneElement(m,C):p.createElement(g,C)}var Kqe=["item"],Xqe=["children","className","width","height","style","compact","title","desc"];function Wx(e){"@babel/helpers - typeof";return Wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wx(e)}function Fv(){return Fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fv.apply(this,arguments)}function Fq(e,t){return Qqe(e)||Jqe(e,t)||AZ(e,t)||Yqe()}function Yqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function Qqe(e){if(Array.isArray(e))return e}function $q(e,t){if(e==null)return{};var r=Zqe(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Zqe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function eze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EZ(n.key),n)}}function tze(e,t,r){return t&&Bq(e.prototype,t),r&&Bq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rze(e,t,r){return t=QN(t),nze(e,PZ()?Reflect.construct(t,r||[],QN(e).constructor):t.apply(e,r))}function nze(e,t){if(t&&(Wx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aze(e)}function aze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(PZ=function(){return!!e})()}function QN(e){return QN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QN(e)}function oze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oT(e,t)}function oT(e,t){return oT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oT(e,t)}function Hx(e){return lze(e)||ize(e)||AZ(e)||sze()}function sze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AZ(e,t){if(e){if(typeof e=="string")return sT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sT(e,t)}}function ize(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lze(e){if(Array.isArray(e))return sT(e)}function sT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ir(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qq(Object(r),!0).forEach(function(n){ta(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ta(e,t,r){return t=EZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EZ(e){var t=cze(e,"string");return Wx(t)=="symbol"?t:t+""}function cze(e,t){if(Wx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dze={xAxis:["bottom","top"],yAxis:["left","right"]},uze={width:"100%",height:"100%"},kZ={x:0,y:0};function tj(e){return e}var fze=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},mze=function(t,r,n,o){var s=r.find(function(u){return u&&u.index===n});if(s){if(t==="horizontal")return{x:s.coordinate,y:o.y};if(t==="vertical")return{x:o.x,y:s.coordinate};if(t==="centric"){var i=s.coordinate,l=o.radius;return Ir(Ir(Ir({},o),Do(o.cx,o.cy,l,i)),{},{angle:i,radius:l})}var c=s.coordinate,d=o.angle;return Ir(Ir(Ir({},o),Do(o.cx,o.cy,c,d)),{},{angle:d,radius:c})}return kZ},u5=function(t,r){var n=r.graphicalItems,o=r.dataStartIndex,s=r.dataEndIndex,i=(n??[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(Hx(l),Hx(d)):l},[]);return i.length>0?i:t&&t.length&&en(o)&&en(s)?t.slice(o,s+1):[]};function IZ(e){return e==="number"?[0,"auto"]:void 0}var iT=function(t,r,n,o){var s=t.graphicalItems,i=t.tooltipAxis,l=u5(r,t);return n<0||!s||!s.length||n>=l.length?null:s.reduce(function(c,d){var u,f=(u=d.props.data)!==null&&u!==void 0?u:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(i.dataKey&&!i.allowDuplicatedCategory){var m=f===void 0?l:f;h=Y_(m,i.dataKey,o)}else h=f&&f[n]||l[n];return h?[].concat(Hx(c),[mQ(d,h)]):c},[])},zq=function(t,r,n,o){var s=o||{x:t.chartX,y:t.chartY},i=fze(s,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=OMe(i,l,d,c);if(u>=0&&d){var f=d[u]&&d[u].value,h=iT(t,r,u,f),m=mze(n,l,u,s);return{activeTooltipIndex:u,activeLabel:f,activePayload:h,activeCoordinate:m}}return null},hze=function(t,r){var n=r.axes,o=r.graphicalItems,s=r.axisType,i=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=t.stackOffset,m=iQ(u,s);return n.reduce(function(v,g){var y,x=g.type.defaultProps!==void 0?Ir(Ir({},g.type.defaultProps),g.props):g.props,b=x.type,w=x.dataKey,j=x.allowDataOverflow,_=x.allowDuplicatedCategory,C=x.scale,E=x.ticks,A=x.includeHidden,P=x[i];if(v[P])return v;var F=u5(t.data,{graphicalItems:o.filter(function(V){var B,J=i in V.props?V.props[i]:(B=V.type.defaultProps)===null||B===void 0?void 0:B[i];return J===P}),dataStartIndex:c,dataEndIndex:d}),M=F.length,I,R,D;qqe(x.domain,j,b)&&(I=yO(x.domain,null,j),m&&(b==="number"||C!=="auto")&&(D=eb(F,w,"category")));var U=IZ(b);if(!I||I.length===0){var z,H=(z=x.domain)!==null&&z!==void 0?z:U;if(w){if(I=eb(F,w,b),b==="category"&&m){var q=S_e(I);_&&q?(R=I,I=FN(0,M)):_||(I=e7(H,I,g).reduce(function(V,B){return V.indexOf(B)>=0?V:[].concat(Hx(V),[B])},[]))}else if(b==="category")_?I=I.filter(function(V){return V!==""&&!ua(V)}):I=e7(H,I,g).reduce(function(V,B){return V.indexOf(B)>=0||B===""||ua(B)?V:[].concat(Hx(V),[B])},[]);else if(b==="number"){var Q=LMe(F,o.filter(function(V){var B,J,ue=i in V.props?V.props[i]:(B=V.type.defaultProps)===null||B===void 0?void 0:B[i],Ne="hide"in V.props?V.props.hide:(J=V.type.defaultProps)===null||J===void 0?void 0:J.hide;return ue===P&&(A||!Ne)}),w,s,u);Q&&(I=Q)}m&&(b==="number"||C!=="auto")&&(D=eb(F,w,"category"))}else m?I=FN(0,M):l&&l[P]&&l[P].hasStack&&b==="number"?I=h==="expand"?[0,1]:fQ(l[P].stackGroups,c,d):I=sQ(F,o.filter(function(V){var B=i in V.props?V.props[i]:V.type.defaultProps[i],J="hide"in V.props?V.props.hide:V.type.defaultProps.hide;return B===P&&(A||!J)}),b,u,!0);if(b==="number")I=aT(f,I,P,s,E),H&&(I=yO(H,I,j));else if(b==="category"&&H){var pe=H,be=I.every(function(V){return pe.indexOf(V)>=0});be&&(I=pe)}}return Ir(Ir({},v),{},ta({},P,Ir(Ir({},x),{},{axisType:s,domain:I,categoricalDomain:D,duplicateDomain:R,originalDomain:(y=x.domain)!==null&&y!==void 0?y:U,isCategorical:m,layout:u})))},{})},pze=function(t,r){var n=r.graphicalItems,o=r.Axis,s=r.axisType,i=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=u5(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),m=h.length,v=iQ(u,s),g=-1;return n.reduce(function(y,x){var b=x.type.defaultProps!==void 0?Ir(Ir({},x.type.defaultProps),x.props):x.props,w=b[i],j=IZ("number");if(!y[w]){g++;var _;return v?_=FN(0,m):l&&l[w]&&l[w].hasStack?(_=fQ(l[w].stackGroups,c,d),_=aT(f,_,w,s)):(_=yO(j,sQ(h,n.filter(function(C){var E,A,P=i in C.props?C.props[i]:(E=C.type.defaultProps)===null||E===void 0?void 0:E[i],F="hide"in C.props?C.props.hide:(A=C.type.defaultProps)===null||A===void 0?void 0:A.hide;return P===w&&!F}),"number",u),o.defaultProps.allowDataOverflow),_=aT(f,_,w,s)),Ir(Ir({},y),{},ta({},w,Ir(Ir({axisType:s},o.defaultProps),{},{hide:!0,orientation:Ec(dze,"".concat(s,".").concat(g%2),null),domain:_,originalDomain:j,isCategorical:v,layout:u})))}return y},{})},gze=function(t,r){var n=r.axisType,o=n===void 0?"xAxis":n,s=r.AxisComp,i=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,f="".concat(o,"Id"),h=kc(u,s),m={};return h&&h.length?m=hze(t,{axes:h,graphicalItems:i,axisType:o,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):i&&i.length&&(m=pze(t,{Axis:s,graphicalItems:i,axisType:o,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),m},vze=function(t){var r=Dm(t),n=Ef(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:_D(n,function(o){return o.coordinate}),tooltipAxis:r,tooltipAxisBandSize:SN(r,n)}},Uq=function(t){var r=t.children,n=t.defaultShowTooltip,o=gc(r,Mx),s=0,i=0;return t.data&&t.data.length!==0&&(i=t.data.length-1),o&&o.props&&(o.props.startIndex>=0&&(s=o.props.startIndex),o.props.endIndex>=0&&(i=o.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:i,activeTooltipIndex:-1,isTooltipActive:!!n}},xze=function(t){return!t||!t.length?!1:t.some(function(r){var n=Mf(r&&r.type);return n&&n.indexOf("Bar")>=0})},Vq=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},yze=function(t,r){var n=t.props,o=t.graphicalItems,s=t.xAxisMap,i=s===void 0?{}:s,l=t.yAxisMap,c=l===void 0?{}:l,d=n.width,u=n.height,f=n.children,h=n.margin||{},m=gc(f,Mx),v=gc(f,Lp),g=Object.keys(c).reduce(function(_,C){var E=c[C],A=E.orientation;return!E.mirror&&!E.hide?Ir(Ir({},_),{},ta({},A,_[A]+E.width)):_},{left:h.left||0,right:h.right||0}),y=Object.keys(i).reduce(function(_,C){var E=i[C],A=E.orientation;return!E.mirror&&!E.hide?Ir(Ir({},_),{},ta({},A,Ec(_,"".concat(A))+E.height)):_},{top:h.top||0,bottom:h.bottom||0}),x=Ir(Ir({},y),g),b=x.bottom;m&&(x.bottom+=m.props.height||Mx.defaultProps.height),v&&r&&(x=MMe(x,o,n,r));var w=d-x.left-x.right,j=u-x.top-x.bottom;return Ir(Ir({brushBottom:b},x),{},{width:Math.max(w,0),height:Math.max(j,0)})},bze=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},f5=function(t){var r=t.chartName,n=t.GraphicalChild,o=t.defaultTooltipEventType,s=o===void 0?"axis":o,i=t.validateTooltipEventTypes,l=i===void 0?["axis"]:i,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,f=t.defaultProps,h=function(x,b){var w=b.graphicalItems,j=b.stackGroups,_=b.offset,C=b.updateId,E=b.dataStartIndex,A=b.dataEndIndex,P=x.barSize,F=x.layout,M=x.barGap,I=x.barCategoryGap,R=x.maxBarSize,D=Vq(F),U=D.numericAxisName,z=D.cateAxisName,H=xze(w),q=[];return w.forEach(function(Q,pe){var be=u5(x.data,{graphicalItems:[Q],dataStartIndex:E,dataEndIndex:A}),V=Q.type.defaultProps!==void 0?Ir(Ir({},Q.type.defaultProps),Q.props):Q.props,B=V.dataKey,J=V.maxBarSize,ue=V["".concat(U,"Id")],Ne=V["".concat(z,"Id")],Z={},ge=c.reduce(function(Nt,tt){var he=b["".concat(tt.axisType,"Map")],ke=V["".concat(tt.axisType,"Id")];he&&he[ke]||tt.axisType==="zAxis"||Nh(!1);var et=he[ke];return Ir(Ir({},Nt),{},ta(ta({},tt.axisType,et),"".concat(tt.axisType,"Ticks"),Ef(et)))},Z),le=ge[z],se=ge["".concat(z,"Ticks")],ee=j&&j[ue]&&j[ue].hasStack&&HMe(Q,j[ue].stackGroups),de=Mf(Q.type).indexOf("Bar")>=0,Le=SN(le,se),ae=[],ie=H&&TMe({barSize:P,stackGroups:j,totalSize:bze(ge,z)});if(de){var dt,At,st=ua(J)?R:J,ut=(dt=(At=SN(le,se,!0))!==null&&At!==void 0?At:st)!==null&&dt!==void 0?dt:0;ae=DMe({barGap:M,barCategoryGap:I,bandSize:ut!==Le?ut:Le,sizeList:ie[Ne],maxBarSize:st}),ut!==Le&&(ae=ae.map(function(Nt){return Ir(Ir({},Nt),{},{position:Ir(Ir({},Nt.position),{},{offset:Nt.position.offset-ut/2})})}))}var Rt=Q&&Q.type&&Q.type.getComposedData;Rt&&q.push({props:Ir(Ir({},Rt(Ir(Ir({},ge),{},{displayedData:be,props:x,dataKey:B,item:Q,bandSize:Le,barPosition:ae,offset:_,stackedData:ee,layout:F,dataStartIndex:E,dataEndIndex:A}))),{},ta(ta(ta({key:Q.key||"item-".concat(pe)},U,ge[U]),z,ge[z]),"animationId",C)),childIndex:L_e(Q,x.children),item:Q})}),q},m=function(x,b){var w=x.props,j=x.dataStartIndex,_=x.dataEndIndex,C=x.updateId;if(!V6({props:w}))return null;var E=w.children,A=w.layout,P=w.stackOffset,F=w.data,M=w.reverseStackOrder,I=Vq(A),R=I.numericAxisName,D=I.cateAxisName,U=kc(E,n),z=VMe(F,U,"".concat(R,"Id"),"".concat(D,"Id"),P,M),H=c.reduce(function(V,B){var J="".concat(B.axisType,"Map");return Ir(Ir({},V),{},ta({},J,gze(w,Ir(Ir({},B),{},{graphicalItems:U,stackGroups:B.axisType===R&&z,dataStartIndex:j,dataEndIndex:_}))))},{}),q=yze(Ir(Ir({},H),{},{props:w,graphicalItems:U}),b?.legendBBox);Object.keys(H).forEach(function(V){H[V]=u(w,H[V],q,V.replace("Map",""),r)});var Q=H["".concat(D,"Map")],pe=vze(Q),be=h(w,Ir(Ir({},H),{},{dataStartIndex:j,dataEndIndex:_,updateId:C,graphicalItems:U,stackGroups:z,offset:q}));return Ir(Ir({formattedGraphicalItems:be,graphicalItems:U,offset:q,stackGroups:z},pe),H)},v=function(y){function x(b){var w,j,_;return eze(this,x),_=rze(this,x,[b]),ta(_,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ta(_,"accessibilityManager",new Bqe),ta(_,"handleLegendBBoxUpdate",function(C){if(C){var E=_.state,A=E.dataStartIndex,P=E.dataEndIndex,F=E.updateId;_.setState(Ir({legendBBox:C},m({props:_.props,dataStartIndex:A,dataEndIndex:P,updateId:F},Ir(Ir({},_.state),{},{legendBBox:C}))))}}),ta(_,"handleReceiveSyncEvent",function(C,E,A){if(_.props.syncId===C){if(A===_.eventEmitterSymbol&&typeof _.props.syncMethod!="function")return;_.applySyncEvent(E)}}),ta(_,"handleBrushChange",function(C){var E=C.startIndex,A=C.endIndex;if(E!==_.state.dataStartIndex||A!==_.state.dataEndIndex){var P=_.state.updateId;_.setState(function(){return Ir({dataStartIndex:E,dataEndIndex:A},m({props:_.props,dataStartIndex:E,dataEndIndex:A,updateId:P},_.state))}),_.triggerSyncEvent({dataStartIndex:E,dataEndIndex:A})}}),ta(_,"handleMouseEnter",function(C){var E=_.getMouseInfo(C);if(E){var A=Ir(Ir({},E),{},{isTooltipActive:!0});_.setState(A),_.triggerSyncEvent(A);var P=_.props.onMouseEnter;na(P)&&P(A,C)}}),ta(_,"triggeredAfterMouseMove",function(C){var E=_.getMouseInfo(C),A=E?Ir(Ir({},E),{},{isTooltipActive:!0}):{isTooltipActive:!1};_.setState(A),_.triggerSyncEvent(A);var P=_.props.onMouseMove;na(P)&&P(A,C)}),ta(_,"handleItemMouseEnter",function(C){_.setState(function(){return{isTooltipActive:!0,activeItem:C,activePayload:C.tooltipPayload,activeCoordinate:C.tooltipPosition||{x:C.cx,y:C.cy}}})}),ta(_,"handleItemMouseLeave",function(){_.setState(function(){return{isTooltipActive:!1}})}),ta(_,"handleMouseMove",function(C){C.persist(),_.throttleTriggeredAfterMouseMove(C)}),ta(_,"handleMouseLeave",function(C){_.throttleTriggeredAfterMouseMove.cancel();var E={isTooltipActive:!1};_.setState(E),_.triggerSyncEvent(E);var A=_.props.onMouseLeave;na(A)&&A(E,C)}),ta(_,"handleOuterEvent",function(C){var E=R_e(C),A=Ec(_.props,"".concat(E));if(E&&na(A)){var P,F;/.*touch.*/i.test(E)?F=_.getMouseInfo(C.changedTouches[0]):F=_.getMouseInfo(C),A((P=F)!==null&&P!==void 0?P:{},C)}}),ta(_,"handleClick",function(C){var E=_.getMouseInfo(C);if(E){var A=Ir(Ir({},E),{},{isTooltipActive:!0});_.setState(A),_.triggerSyncEvent(A);var P=_.props.onClick;na(P)&&P(A,C)}}),ta(_,"handleMouseDown",function(C){var E=_.props.onMouseDown;if(na(E)){var A=_.getMouseInfo(C);E(A,C)}}),ta(_,"handleMouseUp",function(C){var E=_.props.onMouseUp;if(na(E)){var A=_.getMouseInfo(C);E(A,C)}}),ta(_,"handleTouchMove",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.throttleTriggeredAfterMouseMove(C.changedTouches[0])}),ta(_,"handleTouchStart",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.handleMouseDown(C.changedTouches[0])}),ta(_,"handleTouchEnd",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.handleMouseUp(C.changedTouches[0])}),ta(_,"handleDoubleClick",function(C){var E=_.props.onDoubleClick;if(na(E)){var A=_.getMouseInfo(C);E(A,C)}}),ta(_,"handleContextMenu",function(C){var E=_.props.onContextMenu;if(na(E)){var A=_.getMouseInfo(C);E(A,C)}}),ta(_,"triggerSyncEvent",function(C){_.props.syncId!==void 0&&HA.emit(GA,_.props.syncId,C,_.eventEmitterSymbol)}),ta(_,"applySyncEvent",function(C){var E=_.props,A=E.layout,P=E.syncMethod,F=_.state.updateId,M=C.dataStartIndex,I=C.dataEndIndex;if(C.dataStartIndex!==void 0||C.dataEndIndex!==void 0)_.setState(Ir({dataStartIndex:M,dataEndIndex:I},m({props:_.props,dataStartIndex:M,dataEndIndex:I,updateId:F},_.state)));else if(C.activeTooltipIndex!==void 0){var R=C.chartX,D=C.chartY,U=C.activeTooltipIndex,z=_.state,H=z.offset,q=z.tooltipTicks;if(!H)return;if(typeof P=="function")U=P(q,C);else if(P==="value"){U=-1;for(var Q=0;Q<q.length;Q++)if(q[Q].value===C.activeLabel){U=Q;break}}var pe=Ir(Ir({},H),{},{x:H.left,y:H.top}),be=Math.min(R,pe.x+pe.width),V=Math.min(D,pe.y+pe.height),B=q[U]&&q[U].value,J=iT(_.state,_.props.data,U),ue=q[U]?{x:A==="horizontal"?q[U].coordinate:be,y:A==="horizontal"?V:q[U].coordinate}:kZ;_.setState(Ir(Ir({},C),{},{activeLabel:B,activeCoordinate:ue,activePayload:J,activeTooltipIndex:U}))}else _.setState(C)}),ta(_,"renderCursor",function(C){var E,A=_.state,P=A.isTooltipActive,F=A.activeCoordinate,M=A.activePayload,I=A.offset,R=A.activeTooltipIndex,D=A.tooltipAxisBandSize,U=_.getTooltipEventType(),z=(E=C.props.active)!==null&&E!==void 0?E:P,H=_.props.layout,q=C.key||"_recharts-cursor";return _e.createElement(Gqe,{key:q,activeCoordinate:F,activePayload:M,activeTooltipIndex:R,chartName:r,element:C,isActive:z,layout:H,offset:I,tooltipAxisBandSize:D,tooltipEventType:U})}),ta(_,"renderPolarAxis",function(C,E,A){var P=Ec(C,"type.axisType"),F=Ec(_.state,"".concat(P,"Map")),M=C.type.defaultProps,I=M!==void 0?Ir(Ir({},M),C.props):C.props,R=F&&F[I["".concat(P,"Id")]];return p.cloneElement(C,Ir(Ir({},R),{},{className:pa(P,R.className),key:C.key||"".concat(E,"-").concat(A),ticks:Ef(R,!0)}))}),ta(_,"renderPolarGrid",function(C){var E=C.props,A=E.radialLines,P=E.polarAngles,F=E.polarRadius,M=_.state,I=M.radiusAxisMap,R=M.angleAxisMap,D=Dm(I),U=Dm(R),z=U.cx,H=U.cy,q=U.innerRadius,Q=U.outerRadius;return p.cloneElement(C,{polarAngles:Array.isArray(P)?P:Ef(U,!0).map(function(pe){return pe.coordinate}),polarRadius:Array.isArray(F)?F:Ef(D,!0).map(function(pe){return pe.coordinate}),cx:z,cy:H,innerRadius:q,outerRadius:Q,key:C.key||"polar-grid",radialLines:A})}),ta(_,"renderLegend",function(){var C=_.state.formattedGraphicalItems,E=_.props,A=E.children,P=E.width,F=E.height,M=_.props.margin||{},I=P-(M.left||0)-(M.right||0),R=aQ({children:A,formattedGraphicalItems:C,legendWidth:I,legendContent:d});if(!R)return null;var D=R.item,U=$q(R,Kqe);return p.cloneElement(D,Ir(Ir({},U),{},{chartWidth:P,chartHeight:F,margin:M,onBBoxUpdate:_.handleLegendBBoxUpdate}))}),ta(_,"renderTooltip",function(){var C,E=_.props,A=E.children,P=E.accessibilityLayer,F=gc(A,vc);if(!F)return null;var M=_.state,I=M.isTooltipActive,R=M.activeCoordinate,D=M.activePayload,U=M.activeLabel,z=M.offset,H=(C=F.props.active)!==null&&C!==void 0?C:I;return p.cloneElement(F,{viewBox:Ir(Ir({},z),{},{x:z.left,y:z.top}),active:H,label:U,payload:H?D:[],coordinate:R,accessibilityLayer:P})}),ta(_,"renderBrush",function(C){var E=_.props,A=E.margin,P=E.data,F=_.state,M=F.offset,I=F.dataStartIndex,R=F.dataEndIndex,D=F.updateId;return p.cloneElement(C,{key:C.key||"_recharts-brush",onChange:Y2(_.handleBrushChange,C.props.onChange),data:P,x:en(C.props.x)?C.props.x:M.left,y:en(C.props.y)?C.props.y:M.top+M.height+M.brushBottom-(A.bottom||0),width:en(C.props.width)?C.props.width:M.width,startIndex:I,endIndex:R,updateId:"brush-".concat(D)})}),ta(_,"renderReferenceElement",function(C,E,A){if(!C)return null;var P=_,F=P.clipPathId,M=_.state,I=M.xAxisMap,R=M.yAxisMap,D=M.offset,U=C.type.defaultProps||{},z=C.props,H=z.xAxisId,q=H===void 0?U.xAxisId:H,Q=z.yAxisId,pe=Q===void 0?U.yAxisId:Q;return p.cloneElement(C,{key:C.key||"".concat(E,"-").concat(A),xAxis:I[q],yAxis:R[pe],viewBox:{x:D.left,y:D.top,width:D.width,height:D.height},clipPathId:F})}),ta(_,"renderActivePoints",function(C){var E=C.item,A=C.activePoint,P=C.basePoint,F=C.childIndex,M=C.isRange,I=[],R=E.props.key,D=E.item.type.defaultProps!==void 0?Ir(Ir({},E.item.type.defaultProps),E.item.props):E.item.props,U=D.activeDot,z=D.dataKey,H=Ir(Ir({index:F,dataKey:z,cx:A.x,cy:A.y,r:4,fill:XD(E.item),strokeWidth:2,stroke:"#fff",payload:A.payload,value:A.value},Kn(U,!1)),J_(U));return I.push(x.renderActiveDot(U,H,"".concat(R,"-activePoint-").concat(F))),P?I.push(x.renderActiveDot(U,Ir(Ir({},H),{},{cx:P.x,cy:P.y}),"".concat(R,"-basePoint-").concat(F))):M&&I.push(null),I}),ta(_,"renderGraphicChild",function(C,E,A){var P=_.filterFormatItem(C,E,A);if(!P)return null;var F=_.getTooltipEventType(),M=_.state,I=M.isTooltipActive,R=M.tooltipAxis,D=M.activeTooltipIndex,U=M.activeLabel,z=_.props.children,H=gc(z,vc),q=P.props,Q=q.points,pe=q.isRange,be=q.baseLine,V=P.item.type.defaultProps!==void 0?Ir(Ir({},P.item.type.defaultProps),P.item.props):P.item.props,B=V.activeDot,J=V.hide,ue=V.activeBar,Ne=V.activeShape,Z=!!(!J&&I&&H&&(B||ue||Ne)),ge={};F!=="axis"&&H&&H.props.trigger==="click"?ge={onClick:Y2(_.handleItemMouseEnter,C.props.onClick)}:F!=="axis"&&(ge={onMouseLeave:Y2(_.handleItemMouseLeave,C.props.onMouseLeave),onMouseEnter:Y2(_.handleItemMouseEnter,C.props.onMouseEnter)});var le=p.cloneElement(C,Ir(Ir({},P.props),ge));function se(tt){return typeof R.dataKey=="function"?R.dataKey(tt.payload):null}if(Z)if(D>=0){var ee,de;if(R.dataKey&&!R.allowDuplicatedCategory){var Le=typeof R.dataKey=="function"?se:"payload.".concat(R.dataKey.toString());ee=Y_(Q,Le,U),de=pe&&be&&Y_(be,Le,U)}else ee=Q?.[D],de=pe&&be&&be[D];if(Ne||ue){var ae=C.props.activeIndex!==void 0?C.props.activeIndex:D;return[p.cloneElement(C,Ir(Ir(Ir({},P.props),ge),{},{activeIndex:ae})),null,null]}if(!ua(ee))return[le].concat(Hx(_.renderActivePoints({item:P,activePoint:ee,basePoint:de,childIndex:D,isRange:pe})))}else{var ie,dt=(ie=_.getItemByXY(_.state.activeCoordinate))!==null&&ie!==void 0?ie:{graphicalItem:le},At=dt.graphicalItem,st=At.item,ut=st===void 0?C:st,Rt=At.childIndex,Nt=Ir(Ir(Ir({},P.props),ge),{},{activeIndex:Rt});return[p.cloneElement(ut,Nt),null,null]}return pe?[le,null,null]:[le,null]}),ta(_,"renderCustomized",function(C,E,A){return p.cloneElement(C,Ir(Ir({key:"recharts-customized-".concat(A)},_.props),_.state))}),ta(_,"renderMap",{CartesianGrid:{handler:tj,once:!0},ReferenceArea:{handler:_.renderReferenceElement},ReferenceLine:{handler:tj},ReferenceDot:{handler:_.renderReferenceElement},XAxis:{handler:tj},YAxis:{handler:tj},Brush:{handler:_.renderBrush,once:!0},Bar:{handler:_.renderGraphicChild},Line:{handler:_.renderGraphicChild},Area:{handler:_.renderGraphicChild},Radar:{handler:_.renderGraphicChild},RadialBar:{handler:_.renderGraphicChild},Scatter:{handler:_.renderGraphicChild},Pie:{handler:_.renderGraphicChild},Funnel:{handler:_.renderGraphicChild},Tooltip:{handler:_.renderCursor,once:!0},PolarGrid:{handler:_.renderPolarGrid,once:!0},PolarAngleAxis:{handler:_.renderPolarAxis},PolarRadiusAxis:{handler:_.renderPolarAxis},Customized:{handler:_.renderCustomized}}),_.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:Ng("recharts"),"-clip"),_.throttleTriggeredAfterMouseMove=nJ(_.triggeredAfterMouseMove,(j=b.throttleDelay)!==null&&j!==void 0?j:1e3/60),_.state={},_}return oze(x,y),tze(x,[{key:"componentDidMount",value:function(){var w,j;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var w=this.props,j=w.children,_=w.data,C=w.height,E=w.layout,A=gc(j,vc);if(A){var P=A.props.defaultIndex;if(!(typeof P!="number"||P<0||P>this.state.tooltipTicks.length-1)){var F=this.state.tooltipTicks[P]&&this.state.tooltipTicks[P].value,M=iT(this.state,_,P,F),I=this.state.tooltipTicks[P].coordinate,R=(this.state.offset.top+C)/2,D=E==="horizontal",U=D?{x:I,y:R}:{y:I,x:R},z=this.state.formattedGraphicalItems.find(function(q){var Q=q.item;return Q.type.name==="Scatter"});z&&(U=Ir(Ir({},U),z.props.points[P].tooltipPosition),M=z.props.points[P].tooltipPayload);var H={activeTooltipIndex:P,isTooltipActive:!0,activeLabel:F,activePayload:M,activeCoordinate:U};this.setState(H),this.renderCursor(A),this.accessibilityManager.setIndex(P)}}}},{key:"getSnapshotBeforeUpdate",value:function(w,j){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==j.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==w.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==w.margin){var _,C;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0}})}return null}},{key:"componentDidUpdate",value:function(w){DI([gc(w.children,vc)],[gc(this.props.children,vc)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var w=gc(this.props.children,vc);if(w&&typeof w.props.shared=="boolean"){var j=w.props.shared?"axis":"item";return l.indexOf(j)>=0?j:s}return s}},{key:"getMouseInfo",value:function(w){if(!this.container)return null;var j=this.container,_=j.getBoundingClientRect(),C=sTe(_),E={chartX:Math.round(w.pageX-C.left),chartY:Math.round(w.pageY-C.top)},A=_.width/j.offsetWidth||1,P=this.inRange(E.chartX,E.chartY,A);if(!P)return null;var F=this.state,M=F.xAxisMap,I=F.yAxisMap,R=this.getTooltipEventType(),D=zq(this.state,this.props.data,this.props.layout,P);if(R!=="axis"&&M&&I){var U=Dm(M).scale,z=Dm(I).scale,H=U&&U.invert?U.invert(E.chartX):null,q=z&&z.invert?z.invert(E.chartY):null;return Ir(Ir({},E),{},{xValue:H,yValue:q},D)}return D?Ir(Ir({},E),D):null}},{key:"inRange",value:function(w,j){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=this.props.layout,E=w/_,A=j/_;if(C==="horizontal"||C==="vertical"){var P=this.state.offset,F=E>=P.left&&E<=P.left+P.width&&A>=P.top&&A<=P.top+P.height;return F?{x:E,y:A}:null}var M=this.state,I=M.angleAxisMap,R=M.radiusAxisMap;if(I&&R){var D=Dm(I);return n7({x:E,y:A},D)}return null}},{key:"parseEventsOfWrapper",value:function(){var w=this.props.children,j=this.getTooltipEventType(),_=gc(w,vc),C={};_&&j==="axis"&&(_.props.trigger==="click"?C={onClick:this.handleClick}:C={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var E=J_(this.props,this.handleOuterEvent);return Ir(Ir({},E),C)}},{key:"addListener",value:function(){HA.on(GA,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){HA.removeListener(GA,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(w,j,_){for(var C=this.state.formattedGraphicalItems,E=0,A=C.length;E<A;E++){var P=C[E];if(P.item===w||P.props.key===w.key||j===Mf(P.item.type)&&_===P.childIndex)return P}return null}},{key:"renderClipPath",value:function(){var w=this.clipPathId,j=this.state.offset,_=j.left,C=j.top,E=j.height,A=j.width;return _e.createElement("defs",null,_e.createElement("clipPath",{id:w},_e.createElement("rect",{x:_,y:C,height:E,width:A})))}},{key:"getXScales",value:function(){var w=this.state.xAxisMap;return w?Object.entries(w).reduce(function(j,_){var C=Fq(_,2),E=C[0],A=C[1];return Ir(Ir({},j),{},ta({},E,A.scale))},{}):null}},{key:"getYScales",value:function(){var w=this.state.yAxisMap;return w?Object.entries(w).reduce(function(j,_){var C=Fq(_,2),E=C[0],A=C[1];return Ir(Ir({},j),{},ta({},E,A.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(w){var j;return(j=this.state.xAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getYScaleByAxisId",value:function(w){var j;return(j=this.state.yAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getItemByXY",value:function(w){var j=this.state,_=j.formattedGraphicalItems,C=j.activeItem;if(_&&_.length)for(var E=0,A=_.length;E<A;E++){var P=_[E],F=P.props,M=P.item,I=M.type.defaultProps!==void 0?Ir(Ir({},M.type.defaultProps),M.props):M.props,R=Mf(M.type);if(R==="Bar"){var D=(F.data||[]).find(function(q){return qFe(w,q)});if(D)return{graphicalItem:P,payload:D}}else if(R==="RadialBar"){var U=(F.data||[]).find(function(q){return n7(w,q)});if(U)return{graphicalItem:P,payload:U}}else if(a5(P,C)||o5(P,C)||Nw(P,C)){var z=E6e({graphicalItem:P,activeTooltipItem:C,itemData:I.data}),H=I.activeIndex===void 0?z:I.activeIndex;return{graphicalItem:Ir(Ir({},P),{},{childIndex:H}),payload:Nw(P,C)?I.data[z]:P.props.data[z]}}}return null}},{key:"render",value:function(){var w=this;if(!V6(this))return null;var j=this.props,_=j.children,C=j.className,E=j.width,A=j.height,P=j.style,F=j.compact,M=j.title,I=j.desc,R=$q(j,Xqe),D=Kn(R,!1);if(F)return _e.createElement(fq,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},_e.createElement(RI,Fv({},D,{width:E,height:A,title:M,desc:I}),this.renderClipPath(),H6(_,this.renderMap)));if(this.props.accessibilityLayer){var U,z;D.tabIndex=(U=this.props.tabIndex)!==null&&U!==void 0?U:0,D.role=(z=this.props.role)!==null&&z!==void 0?z:"application",D.onKeyDown=function(q){w.accessibilityManager.keyboardEvent(q)},D.onFocus=function(){w.accessibilityManager.focus()}}var H=this.parseEventsOfWrapper();return _e.createElement(fq,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},_e.createElement("div",Fv({className:pa("recharts-wrapper",C),style:Ir({position:"relative",cursor:"default",width:E,height:A},P)},H,{ref:function(Q){w.container=Q}}),_e.createElement(RI,Fv({},D,{width:E,height:A,title:M,desc:I,style:uze}),this.renderClipPath(),H6(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(p.Component);ta(v,"displayName",r),ta(v,"defaultProps",Ir({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),ta(v,"getDerivedStateFromProps",function(y,x){var b=y.dataKey,w=y.data,j=y.children,_=y.width,C=y.height,E=y.layout,A=y.stackOffset,P=y.margin,F=x.dataStartIndex,M=x.dataEndIndex;if(x.updateId===void 0){var I=Uq(y);return Ir(Ir(Ir({},I),{},{updateId:0},m(Ir(Ir({props:y},I),{},{updateId:0}),x)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:C,prevLayout:E,prevStackOffset:A,prevMargin:P,prevChildren:j})}if(b!==x.prevDataKey||w!==x.prevData||_!==x.prevWidth||C!==x.prevHeight||E!==x.prevLayout||A!==x.prevStackOffset||!Qv(P,x.prevMargin)){var R=Uq(y),D={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},U=Ir(Ir({},zq(x,w,E)),{},{updateId:x.updateId+1}),z=Ir(Ir(Ir({},R),D),U);return Ir(Ir(Ir({},z),m(Ir({props:y},z),x)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:C,prevLayout:E,prevStackOffset:A,prevMargin:P,prevChildren:j})}if(!DI(j,x.prevChildren)){var H,q,Q,pe,be=gc(j,Mx),V=be&&(H=(q=be.props)===null||q===void 0?void 0:q.startIndex)!==null&&H!==void 0?H:F,B=be&&(Q=(pe=be.props)===null||pe===void 0?void 0:pe.endIndex)!==null&&Q!==void 0?Q:M,J=V!==F||B!==M,ue=!ua(w),Ne=ue&&!J?x.updateId:x.updateId+1;return Ir(Ir({updateId:Ne},m(Ir(Ir({props:y},x),{},{updateId:Ne,dataStartIndex:V,dataEndIndex:B}),x)),{},{prevChildren:j,dataStartIndex:V,dataEndIndex:B})}return null}),ta(v,"renderActiveDot",function(y,x,b){var w;return p.isValidElement(y)?w=p.cloneElement(y,x):na(y)?w=y(x):w=_e.createElement(y1,x),_e.createElement(Ta,{className:"recharts-active-dot",key:b},w)});var g=p.forwardRef(function(x,b){return _e.createElement(v,Fv({},x,{ref:b}))});return g.displayName=v.displayName,g},wze=f5({chartName:"LineChart",GraphicalChild:b1,axisComponents:[{axisType:"xAxis",AxisComp:lg},{axisType:"yAxis",AxisComp:cg}],formatAxisMap:QD}),jze=f5({chartName:"BarChart",GraphicalChild:Ag,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:lg},{axisType:"yAxis",AxisComp:cg}],formatAxisMap:QD}),_ze=f5({chartName:"PieChart",GraphicalChild:Yu,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:n5},{axisType:"radiusAxis",AxisComp:t5}],formatAxisMap:rRe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),Nze=f5({chartName:"AreaChart",GraphicalChild:Bh,axisComponents:[{axisType:"xAxis",AxisComp:lg},{axisType:"yAxis",AxisComp:cg}],formatAxisMap:QD});const Wq=({icon:e,title:t,value:r,trend:n,trendValue:o,color:s,className:i,loading:l})=>{const c=n==="up"?o4:fue,d=n==="up"?"text-success":"text-danger";return a.jsx(Pr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col justify-between ${i}`,children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10",style:{color:`var(--${s})`},children:a.jsx(e,{className:"h-5 w-5"})}),!l&&n&&o&&a.jsxs("div",{className:`flex items-center text-xs font-bold ${d}`,children:[a.jsx(c,{className:"w-3.5 h-3.5 mr-1"}),a.jsx("span",{children:o})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-2",children:t}),l?a.jsx("div",{className:"h-9 bg-white/5 rounded animate-pulse"}):a.jsx("p",{className:"text-3xl font-bold text-text-primary tabular-nums tracking-tight",children:r})]})]})})},Sze=({alerts:e,className:t})=>{const r=Yi(),[n,o]=p.useState(!1),s=u=>({Package:_d,DollarSign:Ks,CalendarCheck:l4,Clock:vd,ShoppingCart:a1,Store:u4,Users:ml,CalendarPlus:c4,AlertTriangle:qf,Info:$H})[u]||qf,i=u=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[u]||"text-warning",l=e.length>2?e.slice(0,2):e,c=e.length>2,d=({alert:u,onClick:f})=>{const h=s(u.icone),m=i(u.cor);return a.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:f,children:[a.jsx(h,{className:`w-4 h-4 flex-shrink-0 ${m}`}),a.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:u.mensagem}),u.link&&a.jsx(o4,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})};return a.jsxs(a.Fragment,{children:[a.jsxs(Pr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card ${t||""}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h2",{className:"text-lg font-bold text-text-primary flex items-center",children:[a.jsx(O_,{className:"mr-2 h-5 w-5 text-brand"})," Alertas do Dia"]}),c&&a.jsx(ce,{variant:"ghost",size:"sm",className:"text-xs text-brand hover:text-brand/80",onClick:()=>o(!0),children:"Ver todos"})]}),e.length===0?a.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum alerta no momento! "}):a.jsx("ul",{className:"space-y-2 text-sm",children:l.map((u,f)=>a.jsx(d,{alert:u,onClick:()=>u.link&&r(u.link)},f))})]}),a.jsx(xn,{open:n,onOpenChange:o,children:a.jsxs(vn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[a.jsx(pn,{children:a.jsxs(fn,{className:"flex items-center gap-2",children:[a.jsx(O_,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",e.length,")"]})}),a.jsx("div",{className:"mt-4",children:e.length===0?a.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):a.jsx("ul",{className:"space-y-2 text-sm",children:e.map((u,f)=>a.jsx(d,{alert:u,onClick:()=>{u.link&&(r(u.link),o(!1))}},f))})})]})})]})},Cze=({title:e,icon:t,data:r,color:n,className:o,loading:s})=>{const i=r.reduce((d,u)=>d+(u.receita||0),0),l=r.reduce((d,u)=>d+(u.despesa||0),0),c=i-l;return a.jsxs(Pr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group ${o||""}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:a.jsx(t,{className:"h-5 w-5"})}),a.jsx("h3",{className:"text-base font-bold text-text-primary flex-1",children:e}),a.jsx("div",{className:"text-xs font-semibold text-text-muted",children:"ltimos 14 dias"})]}),a.jsx("div",{className:"mb-2",children:a.jsx(Hj,{width:"100%",height:90,children:a.jsxs(Nze,{data:r,margin:{top:4,right:0,left:0,bottom:0},children:[a.jsx(vc,{cursor:{stroke:"var(--border)",strokeDasharray:"3 3"},contentStyle:{background:"rgba(10, 10, 10, 0.85)",borderColor:"var(--border)",color:"var(--text-primary)",borderRadius:"var(--radius-sm)"},formatter:(d,u)=>u==="saldo"?[`R$ ${d.toLocaleString("pt-BR")}`,"Saldo"]:d,labelFormatter:d=>d}),a.jsx(Bh,{type:"monotone",dataKey:"saldo",stroke:"var(--brand)",strokeWidth:2,fill:"var(--brand)",fillOpacity:.15})]})})}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary",children:"Receita"}),s?a.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):a.jsxs("p",{className:"font-bold text-success tabular-nums",children:["R$ ",i.toLocaleString("pt-BR")]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary",children:"Despesa"}),s?a.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):a.jsxs("p",{className:"font-bold text-danger tabular-nums",children:["R$ ",l.toLocaleString("pt-BR")]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary",children:"Saldo"}),s?a.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):a.jsxs("p",{className:"font-bold text-text-primary tabular-nums",children:["R$ ",c.toLocaleString("pt-BR")]})]})]})]})},Pze=({title:e,icon:t,data:r,color:n,className:o,loading:s})=>a.jsxs(Pr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col ${o||""}`,children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:a.jsx(t,{className:"h-5 w-5"})}),a.jsx("h3",{className:"text-base font-bold text-text-primary",children:e})]}),a.jsx("div",{className:"space-y-3 mt-auto",children:s?Array.from({length:3}).map((i,l)=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("div",{className:"h-4 w-24 bg-white/5 rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-12 bg-white/5 rounded animate-pulse"})]},l)):r.map((i,l)=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:i.name}),a.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:i.value})]},l))})]}),Aze={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.1,delayChildren:.2}}},XA={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}};function Eze(){const{toast:e}=no(),{userProfile:t}=So(),n=bC()?.alerts||[],o=Yi(),[s,i]=p.useState(!0),[l,c]=p.useState(0),[d,u]=p.useState({finalizados:0,total:0}),[f,h]=p.useState(0),[m,v]=p.useState(0),[g,y]=p.useState(0),[x,b]=p.useState(0),[w,j]=p.useState(0),[_,C]=p.useState(0),[E,A]=p.useState([]);p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa){console.log("[DashboardPage] Aguardando autenticao..."),i(!1);return}console.log("[DashboardPage] Iniciando carregamento de dados...");try{i(!0);const I=t.codigo_empresa,R=new Date,D=ko(R).toISOString(),U=Wj(R).toISOString();console.log("[Dashboard] 1. Buscando pagamentos...");const{data:z}=await fe.from("pagamentos").select("valor, status").eq("codigo_empresa",I).gte("recebido_em",D).lte("recebido_em",U);console.log("[Dashboard]  Pagamentos carregados:",z?.length||0);const H=(z||[]).filter(he=>!["Cancelado","Estornado"].includes(he.status)).reduce((he,ke)=>he+Number(ke.valor||0),0);console.log("[Dashboard] 2. Buscando agendamentos de hoje...");const{data:q}=await fe.from("agendamentos").select("id").eq("codigo_empresa",I).gte("inicio",D).lte("inicio",U);console.log("[Dashboard]  Agendamentos de hoje:",q?.length||0);let Q=0;if(q&&q.length>0){console.log("[Dashboard] 3. Buscando participantes pagos...");const he=q.map(et=>et.id),{data:ke}=await fe.from("agendamento_participantes").select("valor_cota, status_pagamento, aplicar_taxa, finalizadora_id, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",I).in("agendamento_id",he).eq("status_pagamento","Pago");console.log("[Dashboard]  Participantes pagos:",ke?.length||0),Q=(ke||[]).reduce((et,Me)=>{let $e=Number(Me.valor_cota||0);if(Me.aplicar_taxa===!0){const Be=Number(Me.finalizadoras?.taxa_percentual||0);Be>0&&($e=$e/(1+Be/100))}return et+$e},0)}const pe=H+Q;c(pe),console.log("[Dashboard] 4. Buscando agendamentos completos...");const{data:be}=await fe.from("agendamentos").select("id, status, inicio, fim").eq("codigo_empresa",I).gte("inicio",D).lte("inicio",U);console.log("[Dashboard]  Agendamentos completos:",be?.length||0);const V=(be||[]).filter(he=>he.status==="finished").length;u({finalizados:V,total:be?.length||0});const B=new Date().toISOString(),J=(be||[]).filter(he=>he.inicio>B&&!["canceled","finished"].includes(he.status)).length;h(J);const ue=(be||[]).filter(he=>he.status==="in_progress").length;v(ue),console.log("[Dashboard] 5. Buscando quadras...");const{data:Ne}=await fe.from("quadras").select("id").eq("codigo_empresa",I);console.log("[Dashboard]  Quadras:",Ne?.length||0);const le=(Ne?.length||0)*17;let se=0;for(const he of be||[])if(!["canceled","no_show"].includes(he.status))if(he.inicio&&he.fim){const ke=new Date(he.inicio),$e=(new Date(he.fim)-ke)/(1e3*60*60);se+=$e}else se+=1;const ee=le>0?Math.round(se/le*100):0;y(ee),console.log("[Dashboard] 6. Buscando comandas abertas...");const{data:de}=await fe.from("comandas").select("id").eq("codigo_empresa",I).eq("status","open");console.log("[Dashboard]  Comandas abertas:",de?.length||0),b(de?.length||0),console.log("[Dashboard] 7. Buscando mesas...");const{data:Le}=await fe.from("mesas").select("id, status").eq("codigo_empresa",I);console.log("[Dashboard]  Mesas:",Le?.length||0);const ae=(Le||[]).filter(he=>["in-use","awaiting-payment"].includes(he.status)).length;j(ae),console.log("[Dashboard] 8. Buscando vendas da loja...");const{data:ie}=await fe.from("comandas").select("id").eq("codigo_empresa",I).eq("status","closed").gte("fechado_em",D).lte("fechado_em",U);console.log("[Dashboard]  Vendas da loja:",ie?.length||0),C(ie?.length||0),console.log("[Dashboard] 9. Buscando dados dos ltimos 14 dias...");const dt=new Date;dt.setDate(dt.getDate()-13);const At=ko(dt).toISOString(),st=Wj(R).toISOString(),{data:ut}=await fe.from("pagamentos").select("valor, status, recebido_em").eq("codigo_empresa",I).gte("recebido_em",At).lte("recebido_em",st);console.log("[Dashboard]  Pagamentos 14 dias:",ut?.length||0);const{data:Rt}=await fe.from("agendamentos").select("id, inicio").eq("codigo_empresa",I).gte("inicio",At).lte("inicio",st);console.log("[Dashboard]  Agendamentos 14 dias:",Rt?.length||0);let Nt=[];if(Rt&&Rt.length>0){const he=Rt.map(et=>et.id),{data:ke}=await fe.from("agendamento_participantes").select("valor_cota, agendamento_id").eq("codigo_empresa",I).in("agendamento_id",he).eq("status_pagamento","Pago");Nt=ke||[],console.log("[Dashboard]  Participantes pagos 14 dias:",Nt.length)}const tt=[];for(let he=13;he>=0;he--){const ke=new Date;ke.setDate(ke.getDate()-he);const et=ko(ke),Me=Wj(ke),$e=(ut||[]).filter(ht=>{const zt=new Date(ht.recebido_em);return zt>=et&&zt<=Me&&!["Cancelado","Estornado"].includes(ht.status)}).reduce((ht,zt)=>ht+Number(zt.valor||0),0),Be=(Rt||[]).filter(ht=>{const zt=new Date(ht.inicio);return zt>=et&&zt<=Me}).map(ht=>ht.id),we=Nt.filter(ht=>Be.includes(ht.agendamento_id)).reduce((ht,zt)=>ht+Number(zt.valor_cota||0),0),He=$e+we;tt.push({name:he===0?"Hoje":`${he}d`,saldo:Math.round(He),receita:Math.round(He),despesa:0})}console.log("[Dashboard]  Dados de 14 dias carregados"),A(tt)}catch(I){console.error("[DashboardPage]  Erro ao carregar dashboard:",I),e({title:"Erro ao carregar dashboard",description:I?.message||"Tente recarregar a pgina",variant:"destructive"})}finally{console.log("[DashboardPage]  Carregamento concludo"),i(!1)}})()},[t?.codigo_empresa]);const P=M=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(M||0)),F=[{name:"Comandas Abertas",value:x},{name:"Mesas Ocupadas",value:w},{name:"Vendas Hoje",value:_}];return a.jsx(a.Fragment,{children:a.jsxs(Pr.div,{variants:Aze,initial:"hidden",animate:"visible",className:"space-y-4",children:[a.jsxs(Pr.div,{variants:XA,className:"relative grid grid-cols-1 xl:grid-cols-12 gap-4 items-start",children:[a.jsx("div",{className:"xl:col-span-8",children:a.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm relative p-4 rounded-xl border border-white/10 overflow-hidden shadow-1",children:[a.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.03] mix-blend-overlay"}),a.jsxs("div",{className:"relative z-10 max-w-[720px]",children:[a.jsxs("h1",{className:"text-3xl font-black mb-2 text-text-primary tracking-tighter",children:["Bem-vindo de volta, ",a.jsxs("span",{className:"text-brand",children:[(t?.nome_exibicao||t?.nome||t?.email?.split("@")[0]||"Admin").split(" ")[0],"!"]})]}),a.jsx("p",{className:"text-text-secondary mb-3 max-w-[60ch] text-sm md:text-base font-normal",children:"Sua central de comando para uma gesto de sucesso. Monitore agendamentos, faturamento e clientes em um s lugar."}),a.jsxs("div",{className:"flex flex-wrap gap-2.5",children:[a.jsxs(ce,{onClick:()=>o("/agenda",{state:{openModal:!0}}),size:"default",children:[a.jsx(c4,{className:"mr-2 h-4 w-4"}),"+ Agendamento"]}),a.jsxs(ce,{onClick:()=>o("/clientes",{state:{openModal:!0}}),variant:"outline",size:"default",children:[a.jsx(ml,{className:"mr-2 h-4 w-4"}),"Adicionar Cliente"]})]})]})]})}),a.jsx("div",{className:"xl:col-span-4",children:a.jsxs("div",{className:"fx-card",children:[a.jsxs("h2",{className:"text-lg font-bold text-text-primary mb-3 flex items-center",children:[a.jsx(vd,{className:"mr-2 h-5 w-5 text-brand"})," Resumo do Dia"]}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Prximas Reservas"}),s?a.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):a.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:f})]}),a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Quadras em Uso"}),s?a.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):a.jsx("span",{className:"font-bold text-success tabular-nums",children:m})]}),a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Taxa de Ocupao"}),s?a.jsx("div",{className:"h-6 w-16 bg-white/5 rounded animate-pulse"}):a.jsxs("span",{className:`font-bold tabular-nums ${g>=70?"text-success":g>=40?"text-warning":"text-danger"}`,children:[g,"%"]})]})]})]})})]}),a.jsxs(Pr.div,{variants:XA,className:"relative grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-12 gap-4 items-stretch",children:[a.jsx("div",{className:"xl:col-span-3",children:a.jsx(Wq,{icon:Ks,title:"Faturamento do Dia",value:P(l),color:"success",className:"h-full",loading:s})}),a.jsx("div",{className:"xl:col-span-3",children:a.jsx(Wq,{icon:l4,title:"Agend. Finalizados",value:`${d.finalizados} de ${d.total}`,color:"info",className:"h-full",loading:s})}),a.jsx("div",{className:"xl:col-span-3",children:a.jsx(Sze,{className:"h-full",alerts:n})}),a.jsx("div",{className:"xl:col-span-3",children:a.jsx(Pze,{icon:u4,title:"Informaes da Loja",data:F,color:"purple",className:"h-full",loading:s})})]}),a.jsx(Pr.div,{variants:XA,className:"grid grid-cols-1 gap-4",children:a.jsx(Cze,{icon:Zp,title:"Resumo Financeiro",data:E,color:"brand",loading:s})})]})})}var kze={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},Ize=function(t,r,n){var o,s=kze[t];return typeof s=="string"?o=s:r===1?o=s.one:o=s.other.replace("{{count}}",String(r)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"em "+o:"h "+o:o};const Oze=Ize;var Tze={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},Dze={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Mze={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Rze={date:Jv({formats:Tze,defaultWidth:"full"}),time:Jv({formats:Dze,defaultWidth:"full"}),dateTime:Jv({formats:Mze,defaultWidth:"full"})};const Lze=Rze;var Fze={lastWeek:function(t){var r=t.getUTCDay(),n=r===0||r===6?"ltimo":"ltima";return"'"+n+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},$ze=function(t,r,n,o){var s=Fze[t];return typeof s=="function"?s(r):s};const Bze=$ze;var qze={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},zze={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},Uze={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},Vze={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},Wze={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},Hze={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},Gze=function(t,r){var n=Number(t);return r?.unit==="week"?n+"":n+""},Kze={ordinalNumber:Gze,era:Eu({values:qze,defaultWidth:"wide"}),quarter:Eu({values:zze,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Eu({values:Uze,defaultWidth:"wide"}),day:Eu({values:Vze,defaultWidth:"wide"}),dayPeriod:Eu({values:Wze,defaultWidth:"wide",formattingValues:Hze,defaultFormattingWidth:"wide"})};const Xze=Kze;var Yze=/^(\d+)[o]?/i,Jze=/\d+/i,Qze={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},Zze={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},e9e={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},t9e={any:[/1/i,/2/i,/3/i,/4/i]},r9e={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},n9e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},a9e={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},o9e={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},s9e={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},i9e={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},l9e={ordinalNumber:IX({matchPattern:Yze,parsePattern:Jze,valueCallback:function(t){return parseInt(t,10)}}),era:ku({matchPatterns:Qze,defaultMatchWidth:"wide",parsePatterns:Zze,defaultParseWidth:"any"}),quarter:ku({matchPatterns:e9e,defaultMatchWidth:"wide",parsePatterns:t9e,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:ku({matchPatterns:r9e,defaultMatchWidth:"wide",parsePatterns:n9e,defaultParseWidth:"any"}),day:ku({matchPatterns:a9e,defaultMatchWidth:"wide",parsePatterns:o9e,defaultParseWidth:"any"}),dayPeriod:ku({matchPatterns:s9e,defaultMatchWidth:"any",parsePatterns:i9e,defaultParseWidth:"any"})};const c9e=l9e;var d9e={code:"pt-BR",formatDistance:Oze,formatLong:Lze,formatRelative:Bze,localize:Xze,match:c9e,options:{weekStartsOn:0,firstWeekContainsDate:1}};const wa=d9e,u9e=["top","right","bottom","left"],Ch=Math.min,xc=Math.max,ZN=Math.round,rj=Math.floor,Hu=e=>({x:e,y:e}),f9e={left:"right",right:"left",bottom:"top",top:"bottom"},m9e={start:"end",end:"start"};function lT(e,t,r){return xc(e,Ch(t,r))}function Kf(e,t){return typeof e=="function"?e(t):e}function Xf(e){return e.split("-")[0]}function C0(e){return e.split("-")[1]}function lM(e){return e==="x"?"y":"x"}function cM(e){return e==="y"?"height":"width"}const h9e=new Set(["top","bottom"]);function Ru(e){return h9e.has(Xf(e))?"y":"x"}function dM(e){return lM(Ru(e))}function p9e(e,t,r){r===void 0&&(r=!1);const n=C0(e),o=dM(e),s=cM(o);let i=o==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=eS(i)),[i,eS(i)]}function g9e(e){const t=eS(e);return[cT(e),t,cT(t)]}function cT(e){return e.replace(/start|end/g,t=>m9e[t])}const Hq=["left","right"],Gq=["right","left"],v9e=["top","bottom"],x9e=["bottom","top"];function y9e(e,t,r){switch(e){case"top":case"bottom":return r?t?Gq:Hq:t?Hq:Gq;case"left":case"right":return t?v9e:x9e;default:return[]}}function b9e(e,t,r,n){const o=C0(e);let s=y9e(Xf(e),r==="start",n);return o&&(s=s.map(i=>i+"-"+o),t&&(s=s.concat(s.map(cT)))),s}function eS(e){return e.replace(/left|right|bottom|top/g,t=>f9e[t])}function w9e(e){return{top:0,right:0,bottom:0,left:0,...e}}function OZ(e){return typeof e!="number"?w9e(e):{top:e,right:e,bottom:e,left:e}}function tS(e){const{x:t,y:r,width:n,height:o}=e;return{width:n,height:o,top:r,left:t,right:t+n,bottom:r+o,x:t,y:r}}function Kq(e,t,r){let{reference:n,floating:o}=e;const s=Ru(t),i=dM(t),l=cM(i),c=Xf(t),d=s==="y",u=n.x+n.width/2-o.width/2,f=n.y+n.height/2-o.height/2,h=n[l]/2-o[l]/2;let m;switch(c){case"top":m={x:u,y:n.y-o.height};break;case"bottom":m={x:u,y:n.y+n.height};break;case"right":m={x:n.x+n.width,y:f};break;case"left":m={x:n.x-o.width,y:f};break;default:m={x:n.x,y:n.y}}switch(C0(t)){case"start":m[i]-=h*(r&&d?-1:1);break;case"end":m[i]+=h*(r&&d?-1:1);break}return m}const j9e=async(e,t,r)=>{const{placement:n="bottom",strategy:o="absolute",middleware:s=[],platform:i}=r,l=s.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let d=await i.getElementRects({reference:e,floating:t,strategy:o}),{x:u,y:f}=Kq(d,n,c),h=n,m={},v=0;for(let g=0;g<l.length;g++){const{name:y,fn:x}=l[g],{x:b,y:w,data:j,reset:_}=await x({x:u,y:f,initialPlacement:n,placement:h,strategy:o,middlewareData:m,rects:d,platform:i,elements:{reference:e,floating:t}});u=b??u,f=w??f,m={...m,[y]:{...m[y],...j}},_&&v<=50&&(v++,typeof _=="object"&&(_.placement&&(h=_.placement),_.rects&&(d=_.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:o}):_.rects),{x:u,y:f}=Kq(d,h,c)),g=-1)}return{x:u,y:f,placement:h,strategy:o,middlewareData:m}};async function Iw(e,t){var r;t===void 0&&(t={});const{x:n,y:o,platform:s,rects:i,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:h=!1,padding:m=0}=Kf(t,e),v=OZ(m),y=l[h?f==="floating"?"reference":"floating":f],x=tS(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(y)))==null||r?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),b=f==="floating"?{x:n,y:o,width:i.floating.width,height:i.floating.height}:i.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l.floating)),j=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},_=tS(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:w,strategy:c}):b);return{top:(x.top-_.top+v.top)/j.y,bottom:(_.bottom-x.bottom+v.bottom)/j.y,left:(x.left-_.left+v.left)/j.x,right:(_.right-x.right+v.right)/j.x}}const _9e=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:o,rects:s,platform:i,elements:l,middlewareData:c}=t,{element:d,padding:u=0}=Kf(e,t)||{};if(d==null)return{};const f=OZ(u),h={x:r,y:n},m=dM(o),v=cM(m),g=await i.getDimensions(d),y=m==="y",x=y?"top":"left",b=y?"bottom":"right",w=y?"clientHeight":"clientWidth",j=s.reference[v]+s.reference[m]-h[m]-s.floating[v],_=h[m]-s.reference[m],C=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d));let E=C?C[w]:0;(!E||!await(i.isElement==null?void 0:i.isElement(C)))&&(E=l.floating[w]||s.floating[v]);const A=j/2-_/2,P=E/2-g[v]/2-1,F=Ch(f[x],P),M=Ch(f[b],P),I=F,R=E-g[v]-M,D=E/2-g[v]/2+A,U=lT(I,D,R),z=!c.arrow&&C0(o)!=null&&D!==U&&s.reference[v]/2-(D<I?F:M)-g[v]/2<0,H=z?D<I?D-I:D-R:0;return{[m]:h[m]+H,data:{[m]:U,centerOffset:D-U-H,...z&&{alignmentOffset:H}},reset:z}}}),N9e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:o,middlewareData:s,rects:i,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...y}=Kf(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const x=Xf(o),b=Ru(l),w=Xf(l)===l,j=await(c.isRTL==null?void 0:c.isRTL(d.floating)),_=h||(w||!g?[eS(l)]:g9e(l)),C=v!=="none";!h&&C&&_.push(...b9e(l,g,v,j));const E=[l,..._],A=await Iw(t,y),P=[];let F=((n=s.flip)==null?void 0:n.overflows)||[];if(u&&P.push(A[x]),f){const D=p9e(o,i,j);P.push(A[D[0]],A[D[1]])}if(F=[...F,{placement:o,overflows:P}],!P.every(D=>D<=0)){var M,I;const D=(((M=s.flip)==null?void 0:M.index)||0)+1,U=E[D];if(U&&(!(f==="alignment"?b!==Ru(U):!1)||F.every(q=>Ru(q.placement)===b?q.overflows[0]>0:!0)))return{data:{index:D,overflows:F},reset:{placement:U}};let z=(I=F.filter(H=>H.overflows[0]<=0).sort((H,q)=>H.overflows[1]-q.overflows[1])[0])==null?void 0:I.placement;if(!z)switch(m){case"bestFit":{var R;const H=(R=F.filter(q=>{if(C){const Q=Ru(q.placement);return Q===b||Q==="y"}return!0}).map(q=>[q.placement,q.overflows.filter(Q=>Q>0).reduce((Q,pe)=>Q+pe,0)]).sort((q,Q)=>q[1]-Q[1])[0])==null?void 0:R[0];H&&(z=H);break}case"initialPlacement":z=l;break}if(o!==z)return{reset:{placement:z}}}return{}}}};function Xq(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Yq(e){return u9e.some(t=>e[t]>=0)}const S9e=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...o}=Kf(e,t);switch(n){case"referenceHidden":{const s=await Iw(t,{...o,elementContext:"reference"}),i=Xq(s,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Yq(i)}}}case"escaped":{const s=await Iw(t,{...o,altBoundary:!0}),i=Xq(s,r.floating);return{data:{escapedOffsets:i,escaped:Yq(i)}}}default:return{}}}}},TZ=new Set(["left","top"]);async function C9e(e,t){const{placement:r,platform:n,elements:o}=e,s=await(n.isRTL==null?void 0:n.isRTL(o.floating)),i=Xf(r),l=C0(r),c=Ru(r)==="y",d=TZ.has(i)?-1:1,u=s&&c?-1:1,f=Kf(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof v=="number"&&(m=l==="end"?v*-1:v),c?{x:m*u,y:h*d}:{x:h*d,y:m*u}}const P9e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:o,y:s,placement:i,middlewareData:l}=t,c=await C9e(t,e);return i===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:o+c.x,y:s+c.y,data:{...c,placement:i}}}}},A9e=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:o}=t,{mainAxis:s=!0,crossAxis:i=!1,limiter:l={fn:y=>{let{x,y:b}=y;return{x,y:b}}},...c}=Kf(e,t),d={x:r,y:n},u=await Iw(t,c),f=Ru(Xf(o)),h=lM(f);let m=d[h],v=d[f];if(s){const y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",b=m+u[y],w=m-u[x];m=lT(b,m,w)}if(i){const y=f==="y"?"top":"left",x=f==="y"?"bottom":"right",b=v+u[y],w=v-u[x];v=lT(b,v,w)}const g=l.fn({...t,[h]:m,[f]:v});return{...g,data:{x:g.x-r,y:g.y-n,enabled:{[h]:s,[f]:i}}}}}},E9e=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:o,rects:s,middlewareData:i}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Kf(e,t),u={x:r,y:n},f=Ru(o),h=lM(f);let m=u[h],v=u[f];const g=Kf(l,t),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const w=h==="y"?"height":"width",j=s.reference[h]-s.floating[w]+y.mainAxis,_=s.reference[h]+s.reference[w]-y.mainAxis;m<j?m=j:m>_&&(m=_)}if(d){var x,b;const w=h==="y"?"width":"height",j=TZ.has(Xf(o)),_=s.reference[f]-s.floating[w]+(j&&((x=i.offset)==null?void 0:x[f])||0)+(j?0:y.crossAxis),C=s.reference[f]+s.reference[w]+(j?0:((b=i.offset)==null?void 0:b[f])||0)-(j?y.crossAxis:0);v<_?v=_:v>C&&(v=C)}return{[h]:m,[f]:v}}}},k9e=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:o,rects:s,platform:i,elements:l}=t,{apply:c=()=>{},...d}=Kf(e,t),u=await Iw(t,d),f=Xf(o),h=C0(o),m=Ru(o)==="y",{width:v,height:g}=s.floating;let y,x;f==="top"||f==="bottom"?(y=f,x=h===(await(i.isRTL==null?void 0:i.isRTL(l.floating))?"start":"end")?"left":"right"):(x=f,y=h==="end"?"top":"bottom");const b=g-u.top-u.bottom,w=v-u.left-u.right,j=Ch(g-u[y],b),_=Ch(v-u[x],w),C=!t.middlewareData.shift;let E=j,A=_;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(A=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(E=b),C&&!h){const F=xc(u.left,0),M=xc(u.right,0),I=xc(u.top,0),R=xc(u.bottom,0);m?A=v-2*(F!==0||M!==0?F+M:xc(u.left,u.right)):E=g-2*(I!==0||R!==0?I+R:xc(u.top,u.bottom))}await c({...t,availableWidth:A,availableHeight:E});const P=await i.getDimensions(l.floating);return v!==P.width||g!==P.height?{reset:{rects:!0}}:{}}}};function m5(){return typeof window<"u"}function P0(e){return DZ(e)?(e.nodeName||"").toLowerCase():"#document"}function Ic(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ef(e){var t;return(t=(DZ(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function DZ(e){return m5()?e instanceof Node||e instanceof Ic(e).Node:!1}function lu(e){return m5()?e instanceof Element||e instanceof Ic(e).Element:!1}function Ju(e){return m5()?e instanceof HTMLElement||e instanceof Ic(e).HTMLElement:!1}function Jq(e){return!m5()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ic(e).ShadowRoot}const I9e=new Set(["inline","contents"]);function w1(e){const{overflow:t,overflowX:r,overflowY:n,display:o}=cu(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!I9e.has(o)}const O9e=new Set(["table","td","th"]);function T9e(e){return O9e.has(P0(e))}const D9e=[":popover-open",":modal"];function h5(e){return D9e.some(t=>{try{return e.matches(t)}catch{return!1}})}const M9e=["transform","translate","scale","rotate","perspective"],R9e=["transform","translate","scale","rotate","perspective","filter"],L9e=["paint","layout","strict","content"];function uM(e){const t=fM(),r=lu(e)?cu(e):e;return M9e.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||R9e.some(n=>(r.willChange||"").includes(n))||L9e.some(n=>(r.contain||"").includes(n))}function F9e(e){let t=Ph(e);for(;Ju(t)&&!Gx(t);){if(uM(t))return t;if(h5(t))return null;t=Ph(t)}return null}function fM(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const $9e=new Set(["html","body","#document"]);function Gx(e){return $9e.has(P0(e))}function cu(e){return Ic(e).getComputedStyle(e)}function p5(e){return lu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ph(e){if(P0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Jq(e)&&e.host||ef(e);return Jq(t)?t.host:t}function MZ(e){const t=Ph(e);return Gx(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ju(t)&&w1(t)?t:MZ(t)}function Ow(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const o=MZ(e),s=o===((n=e.ownerDocument)==null?void 0:n.body),i=Ic(o);if(s){const l=dT(i);return t.concat(i,i.visualViewport||[],w1(o)?o:[],l&&r?Ow(l):[])}return t.concat(o,Ow(o,[],r))}function dT(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function RZ(e){const t=cu(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const o=Ju(e),s=o?e.offsetWidth:r,i=o?e.offsetHeight:n,l=ZN(r)!==s||ZN(n)!==i;return l&&(r=s,n=i),{width:r,height:n,$:l}}function mM(e){return lu(e)?e:e.contextElement}function tx(e){const t=mM(e);if(!Ju(t))return Hu(1);const r=t.getBoundingClientRect(),{width:n,height:o,$:s}=RZ(t);let i=(s?ZN(r.width):r.width)/n,l=(s?ZN(r.height):r.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!l||!Number.isFinite(l))&&(l=1),{x:i,y:l}}const B9e=Hu(0);function LZ(e){const t=Ic(e);return!fM()||!t.visualViewport?B9e:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function q9e(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ic(e)?!1:t}function dg(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const o=e.getBoundingClientRect(),s=mM(e);let i=Hu(1);t&&(n?lu(n)&&(i=tx(n)):i=tx(e));const l=q9e(s,r,n)?LZ(s):Hu(0);let c=(o.left+l.x)/i.x,d=(o.top+l.y)/i.y,u=o.width/i.x,f=o.height/i.y;if(s){const h=Ic(s),m=n&&lu(n)?Ic(n):n;let v=h,g=dT(v);for(;g&&n&&m!==v;){const y=tx(g),x=g.getBoundingClientRect(),b=cu(g),w=x.left+(g.clientLeft+parseFloat(b.paddingLeft))*y.x,j=x.top+(g.clientTop+parseFloat(b.paddingTop))*y.y;c*=y.x,d*=y.y,u*=y.x,f*=y.y,c+=w,d+=j,v=Ic(g),g=dT(v)}}return tS({width:u,height:f,x:c,y:d})}function hM(e,t){const r=p5(e).scrollLeft;return t?t.left+r:dg(ef(e)).left+r}function FZ(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),o=n.left+t.scrollLeft-(r?0:hM(e,n)),s=n.top+t.scrollTop;return{x:o,y:s}}function z9e(e){let{elements:t,rect:r,offsetParent:n,strategy:o}=e;const s=o==="fixed",i=ef(n),l=t?h5(t.floating):!1;if(n===i||l&&s)return r;let c={scrollLeft:0,scrollTop:0},d=Hu(1);const u=Hu(0),f=Ju(n);if((f||!f&&!s)&&((P0(n)!=="body"||w1(i))&&(c=p5(n)),Ju(n))){const m=dg(n);d=tx(n),u.x=m.x+n.clientLeft,u.y=m.y+n.clientTop}const h=i&&!f&&!s?FZ(i,c,!0):Hu(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+u.x+h.x,y:r.y*d.y-c.scrollTop*d.y+u.y+h.y}}function U9e(e){return Array.from(e.getClientRects())}function V9e(e){const t=ef(e),r=p5(e),n=e.ownerDocument.body,o=xc(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=xc(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+hM(e);const l=-r.scrollTop;return cu(n).direction==="rtl"&&(i+=xc(t.clientWidth,n.clientWidth)-o),{width:o,height:s,x:i,y:l}}function W9e(e,t){const r=Ic(e),n=ef(e),o=r.visualViewport;let s=n.clientWidth,i=n.clientHeight,l=0,c=0;if(o){s=o.width,i=o.height;const d=fM();(!d||d&&t==="fixed")&&(l=o.offsetLeft,c=o.offsetTop)}return{width:s,height:i,x:l,y:c}}const H9e=new Set(["absolute","fixed"]);function G9e(e,t){const r=dg(e,!0,t==="fixed"),n=r.top+e.clientTop,o=r.left+e.clientLeft,s=Ju(e)?tx(e):Hu(1),i=e.clientWidth*s.x,l=e.clientHeight*s.y,c=o*s.x,d=n*s.y;return{width:i,height:l,x:c,y:d}}function Qq(e,t,r){let n;if(t==="viewport")n=W9e(e,r);else if(t==="document")n=V9e(ef(e));else if(lu(t))n=G9e(t,r);else{const o=LZ(e);n={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return tS(n)}function $Z(e,t){const r=Ph(e);return r===t||!lu(r)||Gx(r)?!1:cu(r).position==="fixed"||$Z(r,t)}function K9e(e,t){const r=t.get(e);if(r)return r;let n=Ow(e,[],!1).filter(l=>lu(l)&&P0(l)!=="body"),o=null;const s=cu(e).position==="fixed";let i=s?Ph(e):e;for(;lu(i)&&!Gx(i);){const l=cu(i),c=uM(i);!c&&l.position==="fixed"&&(o=null),(s?!c&&!o:!c&&l.position==="static"&&!!o&&H9e.has(o.position)||w1(i)&&!c&&$Z(e,i))?n=n.filter(u=>u!==i):o=l,i=Ph(i)}return t.set(e,n),n}function X9e(e){let{element:t,boundary:r,rootBoundary:n,strategy:o}=e;const i=[...r==="clippingAncestors"?h5(t)?[]:K9e(t,this._c):[].concat(r),n],l=i[0],c=i.reduce((d,u)=>{const f=Qq(t,u,o);return d.top=xc(f.top,d.top),d.right=Ch(f.right,d.right),d.bottom=Ch(f.bottom,d.bottom),d.left=xc(f.left,d.left),d},Qq(t,l,o));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Y9e(e){const{width:t,height:r}=RZ(e);return{width:t,height:r}}function J9e(e,t,r){const n=Ju(t),o=ef(t),s=r==="fixed",i=dg(e,!0,s,t);let l={scrollLeft:0,scrollTop:0};const c=Hu(0);function d(){c.x=hM(o)}if(n||!n&&!s)if((P0(t)!=="body"||w1(o))&&(l=p5(t)),n){const m=dg(t,!0,s,t);c.x=m.x+t.clientLeft,c.y=m.y+t.clientTop}else o&&d();s&&!n&&o&&d();const u=o&&!n&&!s?FZ(o,l):Hu(0),f=i.left+l.scrollLeft-c.x-u.x,h=i.top+l.scrollTop-c.y-u.y;return{x:f,y:h,width:i.width,height:i.height}}function YA(e){return cu(e).position==="static"}function Zq(e,t){if(!Ju(e)||cu(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return ef(e)===r&&(r=r.ownerDocument.body),r}function BZ(e,t){const r=Ic(e);if(h5(e))return r;if(!Ju(e)){let o=Ph(e);for(;o&&!Gx(o);){if(lu(o)&&!YA(o))return o;o=Ph(o)}return r}let n=Zq(e,t);for(;n&&T9e(n)&&YA(n);)n=Zq(n,t);return n&&Gx(n)&&YA(n)&&!uM(n)?r:n||F9e(e)||r}const Q9e=async function(e){const t=this.getOffsetParent||BZ,r=this.getDimensions,n=await r(e.floating);return{reference:J9e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Z9e(e){return cu(e).direction==="rtl"}const eUe={convertOffsetParentRelativeRectToViewportRelativeRect:z9e,getDocumentElement:ef,getClippingRect:X9e,getOffsetParent:BZ,getElementRects:Q9e,getClientRects:U9e,getDimensions:Y9e,getScale:tx,isElement:lu,isRTL:Z9e};function qZ(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function tUe(e,t){let r=null,n;const o=ef(e);function s(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function i(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),s();const d=e.getBoundingClientRect(),{left:u,top:f,width:h,height:m}=d;if(l||t(),!h||!m)return;const v=rj(f),g=rj(o.clientWidth-(u+h)),y=rj(o.clientHeight-(f+m)),x=rj(u),w={rootMargin:-v+"px "+-g+"px "+-y+"px "+-x+"px",threshold:xc(0,Ch(1,c))||1};let j=!0;function _(C){const E=C[0].intersectionRatio;if(E!==c){if(!j)return i();E?i(!1,E):n=setTimeout(()=>{i(!1,1e-7)},1e3)}E===1&&!qZ(d,e.getBoundingClientRect())&&i(),j=!1}try{r=new IntersectionObserver(_,{...w,root:o.ownerDocument})}catch{r=new IntersectionObserver(_,w)}r.observe(e)}return i(!0),s}function rUe(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=mM(e),u=o||s?[...d?Ow(d):[],...Ow(t)]:[];u.forEach(x=>{o&&x.addEventListener("scroll",r,{passive:!0}),s&&x.addEventListener("resize",r)});const f=d&&l?tUe(d,r):null;let h=-1,m=null;i&&(m=new ResizeObserver(x=>{let[b]=x;b&&b.target===d&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var w;(w=m)==null||w.observe(t)})),r()}),d&&!c&&m.observe(d),m.observe(t));let v,g=c?dg(e):null;c&&y();function y(){const x=dg(e);g&&!qZ(g,x)&&r(),g=x,v=requestAnimationFrame(y)}return r(),()=>{var x;u.forEach(b=>{o&&b.removeEventListener("scroll",r),s&&b.removeEventListener("resize",r)}),f?.(),(x=m)==null||x.disconnect(),m=null,c&&cancelAnimationFrame(v)}}const nUe=P9e,aUe=A9e,oUe=N9e,sUe=k9e,iUe=S9e,ez=_9e,lUe=E9e,cUe=(e,t,r)=>{const n=new Map,o={platform:eUe,...r},s={...o.platform,_c:n};return j9e(e,t,{...o,platform:s})};var dUe=typeof document<"u",uUe=function(){},Kj=dUe?p.useLayoutEffect:uUe;function rS(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!rS(e[n],t[n]))return!1;return!0}if(o=Object.keys(e),r=o.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,o[n]))return!1;for(n=r;n--!==0;){const s=o[n];if(!(s==="_owner"&&e.$$typeof)&&!rS(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function zZ(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function tz(e,t){const r=zZ(e);return Math.round(t*r)/r}function JA(e){const t=p.useRef(e);return Kj(()=>{t.current=e}),t}function fUe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:o,elements:{reference:s,floating:i}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,f]=p.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=p.useState(n);rS(h,n)||m(n);const[v,g]=p.useState(null),[y,x]=p.useState(null),b=p.useCallback(q=>{q!==C.current&&(C.current=q,g(q))},[]),w=p.useCallback(q=>{q!==E.current&&(E.current=q,x(q))},[]),j=s||v,_=i||y,C=p.useRef(null),E=p.useRef(null),A=p.useRef(u),P=c!=null,F=JA(c),M=JA(o),I=JA(d),R=p.useCallback(()=>{if(!C.current||!E.current)return;const q={placement:t,strategy:r,middleware:h};M.current&&(q.platform=M.current),cUe(C.current,E.current,q).then(Q=>{const pe={...Q,isPositioned:I.current!==!1};D.current&&!rS(A.current,pe)&&(A.current=pe,Qf.flushSync(()=>{f(pe)}))})},[h,t,r,M,I]);Kj(()=>{d===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,f(q=>({...q,isPositioned:!1})))},[d]);const D=p.useRef(!1);Kj(()=>(D.current=!0,()=>{D.current=!1}),[]),Kj(()=>{if(j&&(C.current=j),_&&(E.current=_),j&&_){if(F.current)return F.current(j,_,R);R()}},[j,_,R,F,P]);const U=p.useMemo(()=>({reference:C,floating:E,setReference:b,setFloating:w}),[b,w]),z=p.useMemo(()=>({reference:j,floating:_}),[j,_]),H=p.useMemo(()=>{const q={position:r,left:0,top:0};if(!z.floating)return q;const Q=tz(z.floating,u.x),pe=tz(z.floating,u.y);return l?{...q,transform:"translate("+Q+"px, "+pe+"px)",...zZ(z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Q,top:pe}},[r,l,z.floating,u.x,u.y]);return p.useMemo(()=>({...u,update:R,refs:U,elements:z,floatingStyles:H}),[u,R,U,z,H])}const mUe=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:o}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?ez({element:n.current,padding:o}).fn(r):{}:n?ez({element:n,padding:o}).fn(r):{}}}},hUe=(e,t)=>({...nUe(e),options:[e,t]}),pUe=(e,t)=>({...aUe(e),options:[e,t]}),gUe=(e,t)=>({...lUe(e),options:[e,t]}),vUe=(e,t)=>({...oUe(e),options:[e,t]}),xUe=(e,t)=>({...sUe(e),options:[e,t]}),yUe=(e,t)=>({...iUe(e),options:[e,t]}),bUe=(e,t)=>({...mUe(e),options:[e,t]});var wUe="Arrow",UZ=p.forwardRef((e,t)=>{const{children:r,width:n=10,height:o=5,...s}=e;return a.jsx(oa.svg,{...s,ref:t,width:n,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});UZ.displayName=wUe;var jUe=UZ;function VZ(e){const[t,r]=p.useState(void 0);return Ii(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let i,l;if("borderBoxSize"in s){const c=s.borderBoxSize,d=Array.isArray(c)?c[0]:c;i=d.inlineSize,l=d.blockSize}else i=e.offsetWidth,l=e.offsetHeight;r({width:i,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var pM="Popper",[WZ,A0]=Pd(pM),[_Ue,HZ]=WZ(pM),GZ=e=>{const{__scopePopper:t,children:r}=e,[n,o]=p.useState(null);return a.jsx(_Ue,{scope:t,anchor:n,onAnchorChange:o,children:r})};GZ.displayName=pM;var KZ="PopperAnchor",XZ=p.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...o}=e,s=HZ(KZ,r),i=p.useRef(null),l=za(t,i),c=p.useRef(null);return p.useEffect(()=>{const d=c.current;c.current=n?.current||i.current,d!==c.current&&s.onAnchorChange(c.current)}),n?null:a.jsx(oa.div,{...o,ref:l})});XZ.displayName=KZ;var gM="PopperContent",[NUe,SUe]=WZ(gM),YZ=p.forwardRef((e,t)=>{const{__scopePopper:r,side:n="bottom",sideOffset:o=0,align:s="center",alignOffset:i=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:v,...g}=e,y=HZ(gM,r),[x,b]=p.useState(null),w=za(t,Z=>b(Z)),[j,_]=p.useState(null),C=VZ(j),E=C?.width??0,A=C?.height??0,P=n+(s!=="center"?"-"+s:""),F=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},M=Array.isArray(d)?d:[d],I=M.length>0,R={padding:F,boundary:M.filter(PUe),altBoundary:I},{refs:D,floatingStyles:U,placement:z,isPositioned:H,middlewareData:q}=fUe({strategy:"fixed",placement:P,whileElementsMounted:(...Z)=>rUe(...Z,{animationFrame:m==="always"}),elements:{reference:y.anchor},middleware:[hUe({mainAxis:o+A,alignmentAxis:i}),c&&pUe({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?gUe():void 0,...R}),c&&vUe({...R}),xUe({...R,apply:({elements:Z,rects:ge,availableWidth:le,availableHeight:se})=>{const{width:ee,height:de}=ge.reference,Le=Z.floating.style;Le.setProperty("--radix-popper-available-width",`${le}px`),Le.setProperty("--radix-popper-available-height",`${se}px`),Le.setProperty("--radix-popper-anchor-width",`${ee}px`),Le.setProperty("--radix-popper-anchor-height",`${de}px`)}}),j&&bUe({element:j,padding:l}),AUe({arrowWidth:E,arrowHeight:A}),h&&yUe({strategy:"referenceHidden",...R})]}),[Q,pe]=ZZ(z),be=Yl(v);Ii(()=>{H&&be?.()},[H,be]);const V=q.arrow?.x,B=q.arrow?.y,J=q.arrow?.centerOffset!==0,[ue,Ne]=p.useState();return Ii(()=>{x&&Ne(window.getComputedStyle(x).zIndex)},[x]),a.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:H?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ue,"--radix-popper-transform-origin":[q.transformOrigin?.x,q.transformOrigin?.y].join(" "),...q.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:a.jsx(NUe,{scope:r,placedSide:Q,onArrowChange:_,arrowX:V,arrowY:B,shouldHideArrow:J,children:a.jsx(oa.div,{"data-side":Q,"data-align":pe,...g,ref:w,style:{...g.style,animation:H?void 0:"none"}})})})});YZ.displayName=gM;var JZ="PopperArrow",CUe={top:"bottom",right:"left",bottom:"top",left:"right"},QZ=p.forwardRef(function(t,r){const{__scopePopper:n,...o}=t,s=SUe(JZ,n),i=CUe[s.placedSide];return a.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:a.jsx(jUe,{...o,ref:r,style:{...o.style,display:"block"}})})});QZ.displayName=JZ;function PUe(e){return e!==null}var AUe=e=>({name:"transformOrigin",options:e,fn(t){const{placement:r,rects:n,middlewareData:o}=t,i=o.arrow?.centerOffset!==0,l=i?0:e.arrowWidth,c=i?0:e.arrowHeight,[d,u]=ZZ(r),f={start:"0%",center:"50%",end:"100%"}[u],h=(o.arrow?.x??0)+l/2,m=(o.arrow?.y??0)+c/2;let v="",g="";return d==="bottom"?(v=i?f:`${h}px`,g=`${-c}px`):d==="top"?(v=i?f:`${h}px`,g=`${n.floating.height+c}px`):d==="right"?(v=`${-c}px`,g=i?f:`${m}px`):d==="left"&&(v=`${n.floating.width+c}px`,g=i?f:`${m}px`),{data:{x:v,y:g}}}});function ZZ(e){const[t,r="center"]=e.split("-");return[t,r]}var vM=GZ,g5=XZ,xM=YZ,yM=QZ,v5="Popover",[eee,Wlt]=Pd(v5,[A0]),j1=A0(),[EUe,qh]=eee(v5),tee=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:o,onOpenChange:s,modal:i=!1}=e,l=j1(t),c=p.useRef(null),[d,u]=p.useState(!1),[f,h]=Vf({prop:n,defaultProp:o??!1,onChange:s,caller:v5});return a.jsx(vM,{...l,children:a.jsx(EUe,{scope:t,contentId:nu(),triggerRef:c,open:f,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:d,onCustomAnchorAdd:p.useCallback(()=>u(!0),[]),onCustomAnchorRemove:p.useCallback(()=>u(!1),[]),modal:i,children:r})})};tee.displayName=v5;var ree="PopoverAnchor",kUe=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,o=qh(ree,r),s=j1(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:l}=o;return p.useEffect(()=>(i(),()=>l()),[i,l]),a.jsx(g5,{...s,...n,ref:t})});kUe.displayName=ree;var nee="PopoverTrigger",aee=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,o=qh(nee,r),s=j1(r),i=za(t,o.triggerRef),l=a.jsx(oa.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":cee(o.open),...n,ref:i,onClick:bn(e.onClick,o.onOpenToggle)});return o.hasCustomAnchor?l:a.jsx(g5,{asChild:!0,...s,children:l})});aee.displayName=nee;var bM="PopoverPortal",[IUe,OUe]=eee(bM,{forceMount:void 0}),oee=e=>{const{__scopePopover:t,forceMount:r,children:n,container:o}=e,s=qh(bM,t);return a.jsx(IUe,{scope:t,forceMount:r,children:a.jsx(Bc,{present:r||s.open,children:a.jsx(d0,{asChild:!0,container:o,children:n})})})};oee.displayName=bM;var Kx="PopoverContent",see=p.forwardRef((e,t)=>{const r=OUe(Kx,e.__scopePopover),{forceMount:n=r.forceMount,...o}=e,s=qh(Kx,e.__scopePopover);return a.jsx(Bc,{present:n||s.open,children:s.modal?a.jsx(DUe,{...o,ref:t}):a.jsx(MUe,{...o,ref:t})})});see.displayName=Kx;var TUe=_h("PopoverContent.RemoveScroll"),DUe=p.forwardRef((e,t)=>{const r=qh(Kx,e.__scopePopover),n=p.useRef(null),o=za(t,n),s=p.useRef(!1);return p.useEffect(()=>{const i=n.current;if(i)return uC(i)},[]),a.jsx(dC,{as:TUe,allowPinchZoom:!0,children:a.jsx(iee,{...e,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:bn(e.onCloseAutoFocus,i=>{i.preventDefault(),s.current||r.triggerRef.current?.focus()}),onPointerDownOutside:bn(e.onPointerDownOutside,i=>{const l=i.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;s.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:bn(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),MUe=p.forwardRef((e,t)=>{const r=qh(Kx,e.__scopePopover),n=p.useRef(!1),o=p.useRef(!1);return a.jsx(iee,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{e.onCloseAutoFocus?.(s),s.defaultPrevented||(n.current||r.triggerRef.current?.focus(),s.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:s=>{e.onInteractOutside?.(s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=s.target;r.triggerRef.current?.contains(i)&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}})}),iee=p.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...f}=e,h=qh(Kx,r),m=j1(r);return lC(),a.jsx(c1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:s,children:a.jsx(c0,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>h.onOpenChange(!1),children:a.jsx(xM,{"data-state":cee(h.open),role:"dialog",id:h.contentId,...m,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),lee="PopoverClose",RUe=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,o=qh(lee,r);return a.jsx(oa.button,{type:"button",...n,ref:t,onClick:bn(e.onClick,()=>o.onOpenChange(!1))})});RUe.displayName=lee;var LUe="PopoverArrow",FUe=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,o=j1(r);return a.jsx(yM,{...o,...n,ref:t})});FUe.displayName=LUe;function cee(e){return e?"open":"closed"}var $Ue=tee,BUe=aee,qUe=oee,dee=see;const Oc=$Ue,Tc=BUe,Hl=_e.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},o)=>a.jsx(qUe,{container:document.body,children:a.jsx(dee,{ref:o,align:t,sideOffset:r,className:mr("z-[9999] w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Hl.displayName=dee.displayName;var la=function(){return la=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},la.apply(this,arguments)};function zUe(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function uee(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function _1(e){return e.mode==="multiple"}function N1(e){return e.mode==="range"}function x5(e){return e.mode==="single"}var UUe={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function VUe(e,t){return dr(e,"LLLL y",t)}function WUe(e,t){return dr(e,"d",t)}function HUe(e,t){return dr(e,"LLLL",t)}function GUe(e){return"".concat(e)}function KUe(e,t){return dr(e,"cccccc",t)}function XUe(e,t){return dr(e,"yyyy",t)}var YUe=Object.freeze({__proto__:null,formatCaption:VUe,formatDay:WUe,formatMonthCaption:HUe,formatWeekNumber:GUe,formatWeekdayName:KUe,formatYearCaption:XUe}),JUe=function(e,t,r){return dr(e,"do MMMM (EEEE)",r)},QUe=function(){return"Month: "},ZUe=function(){return"Go to next month"},eVe=function(){return"Go to previous month"},tVe=function(e,t){return dr(e,"cccc",t)},rVe=function(e){return"Week n. ".concat(e)},nVe=function(){return"Year: "},aVe=Object.freeze({__proto__:null,labelDay:JUe,labelMonthDropdown:QUe,labelNext:ZUe,labelPrevious:eVe,labelWeekNumber:rVe,labelWeekday:tVe,labelYearDropdown:nVe});function oVe(){var e="buttons",t=UUe,r=OX,n={},o={},s=1,i={},l=new Date;return{captionLayout:e,classNames:t,formatters:YUe,labels:aVe,locale:r,modifiersClassNames:n,modifiers:o,numberOfMonths:s,styles:i,today:l,mode:"default"}}function sVe(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,o=e.toMonth,s=e.fromDate,i=e.toDate;return n?s=bl(n):t&&(s=new Date(t,0,1)),o?i=yC(o):r&&(i=new Date(r,11,31)),{fromDate:s?ko(s):void 0,toDate:i?ko(i):void 0}}var fee=p.createContext(void 0);function iVe(e){var t,r=e.initialProps,n=oVe(),o=sVe(r),s=o.fromDate,i=o.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;l!=="buttons"&&(!s||!i)&&(l="buttons");var c;(x5(r)||_1(r)||N1(r))&&(c=r.onSelect);var d=la(la(la({},n),r),{captionLayout:l,classNames:la(la({},n.classNames),r.classNames),components:la({},r.components),formatters:la(la({},n.formatters),r.formatters),fromDate:s,labels:la(la({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:la(la({},n.modifiers),r.modifiers),modifiersClassNames:la(la({},n.modifiersClassNames),r.modifiersClassNames),onSelect:c,styles:la(la({},n.styles),r.styles),toDate:i});return a.jsx(fee.Provider,{value:d,children:e.children})}function Mo(){var e=p.useContext(fee);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function mee(e){var t=Mo(),r=t.locale,n=t.classNames,o=t.styles,s=t.formatters.formatCaption;return a.jsx("div",{className:n.caption_label,style:o.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:s(e.displayMonth,{locale:r})})}function lVe(e){return a.jsx("svg",la({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:a.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function hee(e){var t,r,n=e.onChange,o=e.value,s=e.children,i=e.caption,l=e.className,c=e.style,d=Mo(),u=(r=(t=d.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:lVe;return a.jsxs("div",{className:l,style:c,children:[a.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),a.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:o,onChange:n,children:s}),a.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[i,a.jsx(u,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function cVe(e){var t,r=Mo(),n=r.fromDate,o=r.toDate,s=r.styles,i=r.locale,l=r.formatters.formatMonthCaption,c=r.classNames,d=r.components,u=r.labels.labelMonthDropdown;if(!n)return a.jsx(a.Fragment,{});if(!o)return a.jsx(a.Fragment,{});var f=[];if(xwe(n,o))for(var h=bl(n),m=n.getMonth();m<=o.getMonth();m++)f.push(yA(h,m));else for(var h=bl(new Date),m=0;m<=11;m++)f.push(yA(h,m));var v=function(y){var x=Number(y.target.value),b=yA(bl(e.displayMonth),x);e.onChange(b)},g=(t=d?.Dropdown)!==null&&t!==void 0?t:hee;return a.jsx(g,{name:"months","aria-label":u(),className:c.dropdown_month,style:s.dropdown_month,onChange:v,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:i}),children:f.map(function(y){return a.jsx("option",{value:y.getMonth(),children:l(y,{locale:i})},y.getMonth())})})}function dVe(e){var t,r=e.displayMonth,n=Mo(),o=n.fromDate,s=n.toDate,i=n.locale,l=n.styles,c=n.classNames,d=n.components,u=n.formatters.formatYearCaption,f=n.labels.labelYearDropdown,h=[];if(!o)return a.jsx(a.Fragment,{});if(!s)return a.jsx(a.Fragment,{});for(var m=o.getFullYear(),v=s.getFullYear(),g=m;g<=v;g++)h.push(E6(Kye(new Date),g));var y=function(b){var w=E6(bl(r),Number(b.target.value));e.onChange(w)},x=(t=d?.Dropdown)!==null&&t!==void 0?t:hee;return a.jsx(x,{name:"years","aria-label":f(),className:c.dropdown_year,style:l.dropdown_year,onChange:y,value:r.getFullYear(),caption:u(r,{locale:i}),children:h.map(function(b){return a.jsx("option",{value:b.getFullYear(),children:u(b,{locale:i})},b.getFullYear())})})}function uVe(e,t){var r=p.useState(e),n=r[0],o=r[1],s=t===void 0?n:t;return[s,o]}function fVe(e){var t=e.month,r=e.defaultMonth,n=e.today,o=t||r||n||new Date,s=e.toDate,i=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(s&&Kb(s,o)<0){var d=-1*(c-1);o=iu(s,d)}return i&&Kb(o,i)<0&&(o=i),bl(o)}function mVe(){var e=Mo(),t=fVe(e),r=uVe(t,e.month),n=r[0],o=r[1],s=function(i){var l;if(!e.disableNavigation){var c=bl(i);o(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[n,s]}function hVe(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,o=bl(e),s=bl(iu(o,n)),i=Kb(s,o),l=[],c=0;c<i;c++){var d=iu(o,c);l.push(d)}return r&&(l=l.reverse()),l}function pVe(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,o=t.numberOfMonths,s=o===void 0?1:o,i=n?s:1,l=bl(e);if(!r)return iu(l,i);var c=Kb(r,e);if(!(c<s))return iu(l,i)}}function gVe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,o=t.numberOfMonths,s=o===void 0?1:o,i=n?s:1,l=bl(e);if(!r)return iu(l,-i);var c=Kb(l,r);if(!(c<=0))return iu(l,-i)}}var pee=p.createContext(void 0);function vVe(e){var t=Mo(),r=mVe(),n=r[0],o=r[1],s=hVe(n,t),i=pVe(n,t),l=gVe(n,t),c=function(f){return s.some(function(h){return Q4(f,h)})},d=function(f,h){c(f)||(h&&TX(f,h)?o(iu(f,1+t.numberOfMonths*-1)):o(f))},u={currentMonth:n,displayMonths:s,goToMonth:o,goToDate:d,previousMonth:l,nextMonth:i,isDateDisplayed:c};return a.jsx(pee.Provider,{value:u,children:e.children})}function S1(){var e=p.useContext(pee);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function rz(e){var t,r=Mo(),n=r.classNames,o=r.styles,s=r.components,i=S1().goToMonth,l=function(u){i(iu(u,e.displayIndex?-e.displayIndex:0))},c=(t=s?.CaptionLabel)!==null&&t!==void 0?t:mee,d=a.jsx(c,{id:e.id,displayMonth:e.displayMonth});return a.jsxs("div",{className:n.caption_dropdowns,style:o.caption_dropdowns,children:[a.jsx("div",{className:n.vhidden,children:d}),a.jsx(cVe,{onChange:l,displayMonth:e.displayMonth}),a.jsx(dVe,{onChange:l,displayMonth:e.displayMonth})]})}function xVe(e){return a.jsx("svg",la({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function yVe(e){return a.jsx("svg",la({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var nS=p.forwardRef(function(e,t){var r=Mo(),n=r.classNames,o=r.styles,s=[n.button_reset,n.button];e.className&&s.push(e.className);var i=s.join(" "),l=la(la({},o.button_reset),o.button);return e.style&&Object.assign(l,e.style),a.jsx("button",la({},e,{ref:t,type:"button",className:i,style:l}))});function bVe(e){var t,r,n=Mo(),o=n.dir,s=n.locale,i=n.classNames,l=n.styles,c=n.labels,d=c.labelPrevious,u=c.labelNext,f=n.components;if(!e.nextMonth&&!e.previousMonth)return a.jsx(a.Fragment,{});var h=d(e.previousMonth,{locale:s}),m=[i.nav_button,i.nav_button_previous].join(" "),v=u(e.nextMonth,{locale:s}),g=[i.nav_button,i.nav_button_next].join(" "),y=(t=f?.IconRight)!==null&&t!==void 0?t:yVe,x=(r=f?.IconLeft)!==null&&r!==void 0?r:xVe;return a.jsxs("div",{className:i.nav,style:l.nav,children:[!e.hidePrevious&&a.jsx(nS,{name:"previous-month","aria-label":h,className:m,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:o==="rtl"?a.jsx(y,{className:i.nav_icon,style:l.nav_icon}):a.jsx(x,{className:i.nav_icon,style:l.nav_icon})}),!e.hideNext&&a.jsx(nS,{name:"next-month","aria-label":v,className:g,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:o==="rtl"?a.jsx(x,{className:i.nav_icon,style:l.nav_icon}):a.jsx(y,{className:i.nav_icon,style:l.nav_icon})})]})}function nz(e){var t=Mo().numberOfMonths,r=S1(),n=r.previousMonth,o=r.nextMonth,s=r.goToMonth,i=r.displayMonths,l=i.findIndex(function(v){return Q4(e.displayMonth,v)}),c=l===0,d=l===i.length-1,u=t>1&&(c||!d),f=t>1&&(d||!c),h=function(){n&&s(n)},m=function(){o&&s(o)};return a.jsx(bVe,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:f,nextMonth:o,previousMonth:n,onPreviousClick:h,onNextClick:m})}function wVe(e){var t,r=Mo(),n=r.classNames,o=r.disableNavigation,s=r.styles,i=r.captionLayout,l=r.components,c=(t=l?.CaptionLabel)!==null&&t!==void 0?t:mee,d;return o?d=a.jsx(c,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?d=a.jsx(rz,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?d=a.jsxs(a.Fragment,{children:[a.jsx(rz,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),a.jsx(nz,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):d=a.jsxs(a.Fragment,{children:[a.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(nz,{displayMonth:e.displayMonth,id:e.id})]}),a.jsx("div",{className:n.caption,style:s.caption,children:d})}function jVe(e){var t=Mo(),r=t.footer,n=t.styles,o=t.classNames.tfoot;return r?a.jsx("tfoot",{className:o,style:n.tfoot,children:a.jsx("tr",{children:a.jsx("td",{colSpan:8,children:r})})}):a.jsx(a.Fragment,{})}function _Ve(e,t,r){for(var n=r?tg(new Date):Nd(new Date,{locale:e,weekStartsOn:t}),o=[],s=0;s<7;s++){var i=La(n,s);o.push(i)}return o}function NVe(){var e=Mo(),t=e.classNames,r=e.styles,n=e.showWeekNumber,o=e.locale,s=e.weekStartsOn,i=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,d=_Ve(o,s,i);return a.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&a.jsx("td",{style:r.head_cell,className:t.head_cell}),d.map(function(u,f){return a.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":c(u,{locale:o}),children:l(u,{locale:o})},f)})]})}function SVe(){var e,t=Mo(),r=t.classNames,n=t.styles,o=t.components,s=(e=o?.HeadRow)!==null&&e!==void 0?e:NVe;return a.jsx("thead",{style:n.head,className:r.head,children:a.jsx(s,{})})}function CVe(e){var t=Mo(),r=t.locale,n=t.formatters.formatDay;return a.jsx(a.Fragment,{children:n(e.date,{locale:r})})}var wM=p.createContext(void 0);function PVe(e){if(!_1(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return a.jsx(wM.Provider,{value:t,children:e.children})}return a.jsx(AVe,{initialProps:e.initialProps,children:e.children})}function AVe(e){var t=e.initialProps,r=e.children,n=t.selected,o=t.min,s=t.max,i=function(d,u,f){var h,m;(h=t.onDayClick)===null||h===void 0||h.call(t,d,u,f);var v=!!(u.selected&&o&&n?.length===o);if(!v){var g=!!(!u.selected&&s&&n?.length===s);if(!g){var y=n?uee([],n,!0):[];if(u.selected){var x=y.findIndex(function(b){return Ki(d,b)});y.splice(x,1)}else y.push(d);(m=t.onSelect)===null||m===void 0||m.call(t,y,d,u,f)}}},l={disabled:[]};n&&l.disabled.push(function(d){var u=s&&n.length>s-1,f=n.some(function(h){return Ki(h,d)});return!!(u&&!f)});var c={selected:n,onDayClick:i,modifiers:l};return a.jsx(wM.Provider,{value:c,children:r})}function jM(){var e=p.useContext(wM);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function EVe(e,t){var r=t||{},n=r.from,o=r.to;return n&&o?Ki(o,e)&&Ki(n,e)?void 0:Ki(o,e)?{from:o,to:void 0}:Ki(n,e)?void 0:kI(n,e)?{from:e,to:o}:{from:n,to:e}:o?kI(e,o)?{from:o,to:e}:{from:e,to:o}:n?TX(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var _M=p.createContext(void 0);function kVe(e){if(!N1(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return a.jsx(_M.Provider,{value:t,children:e.children})}return a.jsx(IVe,{initialProps:e.initialProps,children:e.children})}function IVe(e){var t=e.initialProps,r=e.children,n=t.selected,o=n||{},s=o.from,i=o.to,l=t.min,c=t.max,d=function(m,v,g){var y,x;(y=t.onDayClick)===null||y===void 0||y.call(t,m,v,g);var b=EVe(m,n);(x=t.onSelect)===null||x===void 0||x.call(t,b,m,v,g)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(s?(u.range_start=[s],i?(u.range_end=[i],Ki(s,i)||(u.range_middle=[{after:s,before:i}])):u.range_end=[s]):i&&(u.range_start=[i],u.range_end=[i]),l&&(s&&!i&&u.disabled.push({after:Jy(s,l-1),before:La(s,l-1)}),s&&i&&u.disabled.push({after:s,before:La(s,l-1)}),!s&&i&&u.disabled.push({after:Jy(i,l-1),before:La(i,l-1)})),c){if(s&&!i&&(u.disabled.push({before:La(s,-c+1)}),u.disabled.push({after:La(s,c-1)})),s&&i){var f=Tu(i,s)+1,h=c-f;u.disabled.push({before:Jy(s,h)}),u.disabled.push({after:La(i,h)})}!s&&i&&(u.disabled.push({before:La(i,-c+1)}),u.disabled.push({after:La(i,c-1)}))}return a.jsx(_M.Provider,{value:{selected:n,onDayClick:d,modifiers:u},children:r})}function NM(){var e=p.useContext(_M);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function Xj(e){return Array.isArray(e)?uee([],e,!0):e!==void 0?[e]:[]}function OVe(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],o=r[1];t[n]=Xj(o)}),t}var du;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(du||(du={}));var TVe=du.Selected,uf=du.Disabled,DVe=du.Hidden,MVe=du.Today,QA=du.RangeEnd,ZA=du.RangeMiddle,eE=du.RangeStart,RVe=du.Outside;function LVe(e,t,r){var n,o=(n={},n[TVe]=Xj(e.selected),n[uf]=Xj(e.disabled),n[DVe]=Xj(e.hidden),n[MVe]=[e.today],n[QA]=[],n[ZA]=[],n[eE]=[],n[RVe]=[],n);return e.fromDate&&o[uf].push({before:e.fromDate}),e.toDate&&o[uf].push({after:e.toDate}),_1(e)?o[uf]=o[uf].concat(t.modifiers[uf]):N1(e)&&(o[uf]=o[uf].concat(r.modifiers[uf]),o[eE]=r.modifiers[eE],o[ZA]=r.modifiers[ZA],o[QA]=r.modifiers[QA]),o}var gee=p.createContext(void 0);function FVe(e){var t=Mo(),r=jM(),n=NM(),o=LVe(t,r,n),s=OVe(t.modifiers),i=la(la({},o),s);return a.jsx(gee.Provider,{value:i,children:e.children})}function vee(){var e=p.useContext(gee);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function $Ve(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function BVe(e){return!!(e&&typeof e=="object"&&"from"in e)}function qVe(e){return!!(e&&typeof e=="object"&&"after"in e)}function zVe(e){return!!(e&&typeof e=="object"&&"before"in e)}function UVe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function VVe(e,t){var r,n=t.from,o=t.to;if(n&&o){var s=Tu(o,n)<0;s&&(r=[o,n],n=r[0],o=r[1]);var i=Tu(e,n)>=0&&Tu(o,e)>=0;return i}return o?Ki(o,e):n?Ki(n,e):!1}function WVe(e){return Y4(e)}function HVe(e){return Array.isArray(e)&&e.every(Y4)}function GVe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(WVe(r))return Ki(e,r);if(HVe(r))return r.includes(e);if(BVe(r))return VVe(e,r);if(UVe(r))return r.dayOfWeek.includes(e.getDay());if($Ve(r)){var n=Tu(r.before,e),o=Tu(r.after,e),s=n>0,i=o<0,l=kI(r.before,r.after);return l?i&&s:s||i}return qVe(r)?Tu(e,r.after)>0:zVe(r)?Tu(r.before,e)>0:typeof r=="function"?r(e):!1})}function SM(e,t,r){var n=Object.keys(t).reduce(function(s,i){var l=t[i];return GVe(e,l)&&s.push(i),s},[]),o={};return n.forEach(function(s){return o[s]=!0}),r&&!Q4(e,r)&&(o.outside=!0),o}function KVe(e,t){for(var r=bl(e[0]),n=yC(e[e.length-1]),o,s,i=r;i<=n;){var l=SM(i,t),c=!l.disabled&&!l.hidden;if(!c){i=La(i,1);continue}if(l.selected)return i;l.today&&!s&&(s=i),o||(o=i),i=La(i,1)}return s||o}var XVe=365;function xee(e,t){var r=t.moveBy,n=t.direction,o=t.context,s=t.modifiers,i=t.retry,l=i===void 0?{count:0,lastFocused:e}:i,c=o.weekStartsOn,d=o.fromDate,u=o.toDate,f=o.locale,h={day:La,week:EI,month:iu,year:qye,startOfWeek:function(y){return o.ISOWeek?tg(y):Nd(y,{locale:f,weekStartsOn:c})},endOfWeek:function(y){return o.ISOWeek?PX(y):J4(y,{locale:f,weekStartsOn:c})}},m=h[r](e,n==="after"?1:-1);n==="before"&&d?m=zye([d,m]):n==="after"&&u&&(m=Uye([u,m]));var v=!0;if(s){var g=SM(m,s);v=!g.disabled&&!g.hidden}return v?m:l.count>XVe?l.lastFocused:xee(m,{moveBy:r,direction:n,context:o,modifiers:s,retry:la(la({},l),{count:l.count+1})})}var yee=p.createContext(void 0);function YVe(e){var t=S1(),r=vee(),n=p.useState(),o=n[0],s=n[1],i=p.useState(),l=i[0],c=i[1],d=KVe(t.displayMonths,r),u=o??(l&&t.isDateDisplayed(l))?l:d,f=function(){c(o),s(void 0)},h=function(y){s(y)},m=Mo(),v=function(y,x){if(o){var b=xee(o,{moveBy:y,direction:x,context:m,modifiers:r});Ki(o,b)||(t.goToDate(b,o),h(b))}},g={focusedDay:o,focusTarget:u,blur:f,focus:h,focusDayAfter:function(){return v("day","after")},focusDayBefore:function(){return v("day","before")},focusWeekAfter:function(){return v("week","after")},focusWeekBefore:function(){return v("week","before")},focusMonthBefore:function(){return v("month","before")},focusMonthAfter:function(){return v("month","after")},focusYearBefore:function(){return v("year","before")},focusYearAfter:function(){return v("year","after")},focusStartOfWeek:function(){return v("startOfWeek","before")},focusEndOfWeek:function(){return v("endOfWeek","after")}};return a.jsx(yee.Provider,{value:g,children:e.children})}function CM(){var e=p.useContext(yee);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function JVe(e,t){var r=vee(),n=SM(e,r,t);return n}var PM=p.createContext(void 0);function QVe(e){if(!x5(e.initialProps)){var t={selected:void 0};return a.jsx(PM.Provider,{value:t,children:e.children})}return a.jsx(ZVe,{initialProps:e.initialProps,children:e.children})}function ZVe(e){var t=e.initialProps,r=e.children,n=function(s,i,l){var c,d,u;if((c=t.onDayClick)===null||c===void 0||c.call(t,s,i,l),i.selected&&!t.required){(d=t.onSelect)===null||d===void 0||d.call(t,void 0,s,i,l);return}(u=t.onSelect)===null||u===void 0||u.call(t,s,s,i,l)},o={selected:t.selected,onDayClick:n};return a.jsx(PM.Provider,{value:o,children:r})}function bee(){var e=p.useContext(PM);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function eWe(e,t){var r=Mo(),n=bee(),o=jM(),s=NM(),i=CM(),l=i.focusDayAfter,c=i.focusDayBefore,d=i.focusWeekAfter,u=i.focusWeekBefore,f=i.blur,h=i.focus,m=i.focusMonthBefore,v=i.focusMonthAfter,g=i.focusYearBefore,y=i.focusYearAfter,x=i.focusStartOfWeek,b=i.focusEndOfWeek,w=function(H){var q,Q,pe,be;x5(r)?(q=n.onDayClick)===null||q===void 0||q.call(n,e,t,H):_1(r)?(Q=o.onDayClick)===null||Q===void 0||Q.call(o,e,t,H):N1(r)?(pe=s.onDayClick)===null||pe===void 0||pe.call(s,e,t,H):(be=r.onDayClick)===null||be===void 0||be.call(r,e,t,H)},j=function(H){var q;h(e),(q=r.onDayFocus)===null||q===void 0||q.call(r,e,t,H)},_=function(H){var q;f(),(q=r.onDayBlur)===null||q===void 0||q.call(r,e,t,H)},C=function(H){var q;(q=r.onDayMouseEnter)===null||q===void 0||q.call(r,e,t,H)},E=function(H){var q;(q=r.onDayMouseLeave)===null||q===void 0||q.call(r,e,t,H)},A=function(H){var q;(q=r.onDayPointerEnter)===null||q===void 0||q.call(r,e,t,H)},P=function(H){var q;(q=r.onDayPointerLeave)===null||q===void 0||q.call(r,e,t,H)},F=function(H){var q;(q=r.onDayTouchCancel)===null||q===void 0||q.call(r,e,t,H)},M=function(H){var q;(q=r.onDayTouchEnd)===null||q===void 0||q.call(r,e,t,H)},I=function(H){var q;(q=r.onDayTouchMove)===null||q===void 0||q.call(r,e,t,H)},R=function(H){var q;(q=r.onDayTouchStart)===null||q===void 0||q.call(r,e,t,H)},D=function(H){var q;(q=r.onDayKeyUp)===null||q===void 0||q.call(r,e,t,H)},U=function(H){var q;switch(H.key){case"ArrowLeft":H.preventDefault(),H.stopPropagation(),r.dir==="rtl"?l():c();break;case"ArrowRight":H.preventDefault(),H.stopPropagation(),r.dir==="rtl"?c():l();break;case"ArrowDown":H.preventDefault(),H.stopPropagation(),d();break;case"ArrowUp":H.preventDefault(),H.stopPropagation(),u();break;case"PageUp":H.preventDefault(),H.stopPropagation(),H.shiftKey?g():m();break;case"PageDown":H.preventDefault(),H.stopPropagation(),H.shiftKey?y():v();break;case"Home":H.preventDefault(),H.stopPropagation(),x();break;case"End":H.preventDefault(),H.stopPropagation(),b();break}(q=r.onDayKeyDown)===null||q===void 0||q.call(r,e,t,H)},z={onClick:w,onFocus:j,onBlur:_,onKeyDown:U,onKeyUp:D,onMouseEnter:C,onMouseLeave:E,onPointerEnter:A,onPointerLeave:P,onTouchCancel:F,onTouchEnd:M,onTouchMove:I,onTouchStart:R};return z}function tWe(){var e=Mo(),t=bee(),r=jM(),n=NM(),o=x5(e)?t.selected:_1(e)?r.selected:N1(e)?n.selected:void 0;return o}function rWe(e){return Object.values(du).includes(e)}function nWe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var o=e.modifiersClassNames[n];if(o)r.push(o);else if(rWe(n)){var s=e.classNames["day_".concat(n)];s&&r.push(s)}}),r}function aWe(e,t){var r=la({},e.styles.day);return Object.keys(t).forEach(function(n){var o;r=la(la({},r),(o=e.modifiersStyles)===null||o===void 0?void 0:o[n])}),r}function oWe(e,t,r){var n,o,s,i=Mo(),l=CM(),c=JVe(e,t),d=eWe(e,c),u=tWe(),f=!!(i.onDayClick||i.mode!=="default");p.useEffect(function(){var C;c.outside||l.focusedDay&&f&&Ki(l.focusedDay,e)&&((C=r.current)===null||C===void 0||C.focus())},[l.focusedDay,e,r,f,c.outside]);var h=nWe(i,c).join(" "),m=aWe(i,c),v=!!(c.outside&&!i.showOutsideDays||c.hidden),g=(s=(o=i.components)===null||o===void 0?void 0:o.DayContent)!==null&&s!==void 0?s:CVe,y=a.jsx(g,{date:e,displayMonth:t,activeModifiers:c}),x={style:m,className:h,children:y,role:"gridcell"},b=l.focusTarget&&Ki(l.focusTarget,e)&&!c.outside,w=l.focusedDay&&Ki(l.focusedDay,e),j=la(la(la({},x),(n={disabled:c.disabled,role:"gridcell"},n["aria-selected"]=c.selected,n.tabIndex=w||b?0:-1,n)),d),_={isButton:f,isHidden:v,activeModifiers:c,selectedDays:u,buttonProps:j,divProps:x};return _}function sWe(e){var t=p.useRef(null),r=oWe(e.date,e.displayMonth,t);return r.isHidden?a.jsx("div",{role:"gridcell"}):r.isButton?a.jsx(nS,la({name:"day",ref:t},r.buttonProps)):a.jsx("div",la({},r.divProps))}function iWe(e){var t=e.number,r=e.dates,n=Mo(),o=n.onWeekNumberClick,s=n.styles,i=n.classNames,l=n.locale,c=n.labels.labelWeekNumber,d=n.formatters.formatWeekNumber,u=d(Number(t),{locale:l});if(!o)return a.jsx("span",{className:i.weeknumber,style:s.weeknumber,children:u});var f=c(Number(t),{locale:l}),h=function(m){o(t,r,m)};return a.jsx(nS,{name:"week-number","aria-label":f,className:i.weeknumber,style:s.weeknumber,onClick:h,children:u})}function lWe(e){var t,r,n=Mo(),o=n.styles,s=n.classNames,i=n.showWeekNumber,l=n.components,c=(t=l?.Day)!==null&&t!==void 0?t:sWe,d=(r=l?.WeekNumber)!==null&&r!==void 0?r:iWe,u;return i&&(u=a.jsx("td",{className:s.cell,style:o.cell,children:a.jsx(d,{number:e.weekNumber,dates:e.dates})})),a.jsxs("tr",{className:s.row,style:o.row,children:[u,e.dates.map(function(f){return a.jsx("td",{className:s.cell,style:o.cell,role:"presentation",children:a.jsx(c,{displayMonth:e.displayMonth,date:f})},iwe(f))})]})}function az(e,t,r){for(var n=r?.ISOWeek?PX(t):J4(t,r),o=r?.ISOWeek?tg(e):Nd(e,r),s=Tu(n,o),i=[],l=0;l<=s;l++)i.push(La(o,l));var c=i.reduce(function(d,u){var f=r?.ISOWeek?owe(u):uwe(u,r),h=d.find(function(m){return m.weekNumber===f});return h?(h.dates.push(u),d):(d.push({weekNumber:f,dates:[u]}),d)},[]);return c}function cWe(e,t){var r=az(bl(e),yC(e),t);if(t?.useFixedWeeks){var n=mwe(e,t);if(n<6){var o=r[r.length-1],s=o.dates[o.dates.length-1],i=EI(s,6-n),l=az(EI(s,1),i,t);r.push.apply(r,l)}}return r}function dWe(e){var t,r,n,o=Mo(),s=o.locale,i=o.classNames,l=o.styles,c=o.hideHead,d=o.fixedWeeks,u=o.components,f=o.weekStartsOn,h=o.firstWeekContainsDate,m=o.ISOWeek,v=cWe(e.displayMonth,{useFixedWeeks:!!d,ISOWeek:m,locale:s,weekStartsOn:f,firstWeekContainsDate:h}),g=(t=u?.Head)!==null&&t!==void 0?t:SVe,y=(r=u?.Row)!==null&&r!==void 0?r:lWe,x=(n=u?.Footer)!==null&&n!==void 0?n:jVe;return a.jsxs("table",{id:e.id,className:i.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&a.jsx(g,{}),a.jsx("tbody",{className:i.tbody,style:l.tbody,children:v.map(function(b){return a.jsx(y,{displayMonth:e.displayMonth,dates:b.dates,weekNumber:b.weekNumber},b.weekNumber)})}),a.jsx(x,{displayMonth:e.displayMonth})]})}function uWe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var fWe=uWe()?p.useLayoutEffect:p.useEffect,tE=!1,mWe=0;function oz(){return"react-day-picker-".concat(++mWe)}function hWe(e){var t,r=e??(tE?oz():null),n=p.useState(r),o=n[0],s=n[1];return fWe(function(){o===null&&s(oz())},[]),p.useEffect(function(){tE===!1&&(tE=!0)},[]),(t=e??o)!==null&&t!==void 0?t:void 0}function pWe(e){var t,r,n=Mo(),o=n.dir,s=n.classNames,i=n.styles,l=n.components,c=S1().displayMonths,d=hWe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),u=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,f=[s.month],h=i.month,m=e.displayIndex===0,v=e.displayIndex===c.length-1,g=!m&&!v;o==="rtl"&&(t=[m,v],v=t[0],m=t[1]),m&&(f.push(s.caption_start),h=la(la({},h),i.caption_start)),v&&(f.push(s.caption_end),h=la(la({},h),i.caption_end)),g&&(f.push(s.caption_between),h=la(la({},h),i.caption_between));var y=(r=l?.Caption)!==null&&r!==void 0?r:wVe;return a.jsxs("div",{className:f.join(" "),style:h,children:[a.jsx(y,{id:d,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(dWe,{id:u,"aria-labelledby":d,displayMonth:e.displayMonth})]},e.displayIndex)}function gWe(e){var t=Mo(),r=t.classNames,n=t.styles;return a.jsx("div",{className:r.months,style:n.months,children:e.children})}function vWe(e){var t,r,n=e.initialProps,o=Mo(),s=CM(),i=S1(),l=p.useState(!1),c=l[0],d=l[1];p.useEffect(function(){o.initialFocus&&s.focusTarget&&(c||(s.focus(s.focusTarget),d(!0)))},[o.initialFocus,c,s.focus,s.focusTarget,s]);var u=[o.classNames.root,o.className];o.numberOfMonths>1&&u.push(o.classNames.multiple_months),o.showWeekNumber&&u.push(o.classNames.with_weeknumber);var f=la(la({},o.styles.root),o.style),h=Object.keys(n).filter(function(v){return v.startsWith("data-")}).reduce(function(v,g){var y;return la(la({},v),(y={},y[g]=n[g],y))},{}),m=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:gWe;return a.jsx("div",la({className:u.join(" "),style:f,dir:o.dir,id:o.id,nonce:n.nonce,title:n.title,lang:n.lang},h,{children:a.jsx(m,{children:i.displayMonths.map(function(v,g){return a.jsx(pWe,{displayIndex:g,displayMonth:v},g)})})}))}function xWe(e){var t=e.children,r=zUe(e,["children"]);return a.jsx(iVe,{initialProps:r,children:a.jsx(vVe,{children:a.jsx(QVe,{initialProps:r,children:a.jsx(PVe,{initialProps:r,children:a.jsx(kVe,{initialProps:r,children:a.jsx(FVe,{children:a.jsx(YVe,{children:t})})})})})})})}function uT(e){return a.jsx(xWe,la({},e,{children:a.jsx(vWe,{initialProps:e})}))}function Gl({className:e,classNames:t,showOutsideDays:r=!0,weekStartsOn:n=1,locale:o=wa,...s}){const i=["dom","seg","ter","qua","qui","sex","sb"];return a.jsx(uT,{showOutsideDays:r,weekStartsOn:n,locale:o,className:mr("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:mr(Vb({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:mr(Vb({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"text-muted-foreground opacity-50",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},formatters:{formatWeekdayName:(l,c)=>i[l.getDay()]},components:{IconLeft:({...l})=>a.jsx(LH,{className:"h-4 w-4"}),IconRight:({...l})=>a.jsx(l0,{className:"h-4 w-4"})},...s})}Gl.displayName="Calendar";var wee="AlertDialog",[yWe,Hlt]=Pd(wee,[kK]),am=kK(),jee=e=>{const{__scopeAlertDialog:t,...r}=e,n=am(t);return a.jsx(HK,{...n,...r,modal:!0})};jee.displayName=wee;var bWe="AlertDialogTrigger",_ee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,o=am(r);return a.jsx(Fve,{...o,...n,ref:t})});_ee.displayName=bWe;var wWe="AlertDialogPortal",Nee=e=>{const{__scopeAlertDialog:t,...r}=e,n=am(t);return a.jsx(GK,{...n,...r})};Nee.displayName=wWe;var jWe="AlertDialogOverlay",See=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,o=am(r);return a.jsx(B4,{...o,...n,ref:t})});See.displayName=jWe;var rx="AlertDialogContent",[_We,NWe]=yWe(rx),SWe=cge("AlertDialogContent"),Cee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...o}=e,s=am(r),i=p.useRef(null),l=za(t,i),c=p.useRef(null);return a.jsx(Dve,{contentName:rx,titleName:Pee,docsSlug:"alert-dialog",children:a.jsx(_We,{scope:r,cancelRef:c,children:a.jsxs(q4,{role:"alertdialog",...s,...o,ref:l,onOpenAutoFocus:bn(o.onOpenAutoFocus,d=>{d.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[a.jsx(SWe,{children:n}),a.jsx(PWe,{contentRef:i})]})})})});Cee.displayName=rx;var Pee="AlertDialogTitle",Aee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,o=am(r);return a.jsx(z4,{...o,...n,ref:t})});Aee.displayName=Pee;var Eee="AlertDialogDescription",kee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,o=am(r);return a.jsx(U4,{...o,...n,ref:t})});kee.displayName=Eee;var CWe="AlertDialogAction",Iee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,o=am(r);return a.jsx(mC,{...o,...n,ref:t})});Iee.displayName=CWe;var Oee="AlertDialogCancel",Tee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:o}=NWe(Oee,r),s=am(r),i=za(t,o);return a.jsx(mC,{...s,...n,ref:i})});Tee.displayName=Oee;var PWe=({contentRef:e})=>{const t=`\`${rx}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${rx}\` by passing a \`${Eee}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${rx}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},AWe=jee,EWe=_ee,kWe=Nee,Dee=See,Mee=Cee,Ree=Iee,Lee=Tee,Fee=Aee,$ee=kee;const Yd=AWe,Ap=EWe,IWe=kWe,Bee=_e.forwardRef(({className:e,...t},r)=>a.jsx(Dee,{className:mr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Bee.displayName=Dee.displayName;const nd=_e.forwardRef(({className:e,...t},r)=>a.jsxs(IWe,{children:[a.jsx(Bee,{}),a.jsx(Mee,{ref:r,className:mr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));nd.displayName=Mee.displayName;const ad=({className:e,...t})=>a.jsx("div",{className:mr("flex flex-col space-y-2 text-center sm:text-left",e),...t});ad.displayName="AlertDialogHeader";const od=({className:e,...t})=>a.jsx("div",{className:mr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});od.displayName="AlertDialogFooter";const sd=_e.forwardRef(({className:e,...t},r)=>a.jsx(Fee,{ref:r,className:mr("text-lg font-semibold",e),...t}));sd.displayName=Fee.displayName;const id=_e.forwardRef(({className:e,...t},r)=>a.jsx($ee,{ref:r,className:mr("text-sm text-muted-foreground",e),...t}));id.displayName=$ee.displayName;const Jd=_e.forwardRef(({className:e,...t},r)=>a.jsx(Ree,{ref:r,className:mr(Vb(),e),...t}));Jd.displayName=Ree.displayName;const ld=_e.forwardRef(({className:e,...t},r)=>a.jsx(Lee,{ref:r,className:mr(Vb({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));ld.displayName=Lee.displayName;function sz(e,[t,r]){return Math.min(r,Math.max(t,e))}function y5(e){const t=e+"CollectionProvider",[r,n]=Pd(t),[o,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=g=>{const{scope:y,children:x}=g,b=_e.useRef(null),w=_e.useRef(new Map).current;return a.jsx(o,{scope:y,itemMap:w,collectionRef:b,children:x})};i.displayName=t;const l=e+"CollectionSlot",c=_h(l),d=_e.forwardRef((g,y)=>{const{scope:x,children:b}=g,w=s(l,x),j=za(y,w.collectionRef);return a.jsx(c,{ref:j,children:b})});d.displayName=l;const u=e+"CollectionItemSlot",f="data-radix-collection-item",h=_h(u),m=_e.forwardRef((g,y)=>{const{scope:x,children:b,...w}=g,j=_e.useRef(null),_=za(y,j),C=s(u,x);return _e.useEffect(()=>(C.itemMap.set(j,{ref:j,...w}),()=>void C.itemMap.delete(j))),a.jsx(h,{[f]:"",ref:_,children:b})});m.displayName=u;function v(g){const y=s(e+"CollectionConsumer",g);return _e.useCallback(()=>{const b=y.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${f}]`));return Array.from(y.itemMap.values()).sort((C,E)=>w.indexOf(C.ref.current)-w.indexOf(E.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:i,Slot:d,ItemSlot:m},v,n]}var OWe=p.createContext(void 0);function b5(e){const t=p.useContext(OWe);return e||t||"ltr"}function qee(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var zee=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),TWe="VisuallyHidden",AM=p.forwardRef((e,t)=>a.jsx(oa.span,{...e,ref:t,style:{...zee,...e.style}}));AM.displayName=TWe;var DWe=[" ","Enter","ArrowUp","ArrowDown"],MWe=[" ","Enter"],ug="Select",[w5,j5,RWe]=y5(ug),[E0,Glt]=Pd(ug,[RWe,A0]),_5=A0(),[LWe,zh]=E0(ug),[FWe,$We]=E0(ug),Uee=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:o,onOpenChange:s,value:i,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:f,disabled:h,required:m,form:v}=e,g=_5(t),[y,x]=p.useState(null),[b,w]=p.useState(null),[j,_]=p.useState(!1),C=b5(d),[E,A]=Vf({prop:n,defaultProp:o??!1,onChange:s,caller:ug}),[P,F]=Vf({prop:i,defaultProp:l,onChange:c,caller:ug}),M=p.useRef(null),I=y?v||!!y.closest("form"):!0,[R,D]=p.useState(new Set),U=Array.from(R).map(z=>z.props.value).join(";");return a.jsx(vM,{...g,children:a.jsxs(LWe,{required:m,scope:t,trigger:y,onTriggerChange:x,valueNode:b,onValueNodeChange:w,valueNodeHasChildren:j,onValueNodeHasChildrenChange:_,contentId:nu(),value:P,onValueChange:F,open:E,onOpenChange:A,dir:C,triggerPointerDownPosRef:M,disabled:h,children:[a.jsx(w5.Provider,{scope:t,children:a.jsx(FWe,{scope:e.__scopeSelect,onNativeOptionAdd:p.useCallback(z=>{D(H=>new Set(H).add(z))},[]),onNativeOptionRemove:p.useCallback(z=>{D(H=>{const q=new Set(H);return q.delete(z),q})},[]),children:r})}),I?a.jsxs(ute,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:f,value:P,onChange:z=>F(z.target.value),disabled:h,form:v,children:[P===void 0?a.jsx("option",{value:""}):null,Array.from(R)]},U):null]})})};Uee.displayName=ug;var Vee="SelectTrigger",Wee=p.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...o}=e,s=_5(r),i=zh(Vee,r),l=i.disabled||n,c=za(t,i.onTriggerChange),d=j5(r),u=p.useRef("touch"),[f,h,m]=mte(g=>{const y=d().filter(w=>!w.disabled),x=y.find(w=>w.value===i.value),b=hte(y,g,x);b!==void 0&&i.onValueChange(b.value)}),v=g=>{l||(i.onOpenChange(!0),m()),g&&(i.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return a.jsx(g5,{asChild:!0,...s,children:a.jsx(oa.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":fte(i.value)?"":void 0,...o,ref:c,onClick:bn(o.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&v(g)}),onPointerDown:bn(o.onPointerDown,g=>{u.current=g.pointerType;const y=g.target;y.hasPointerCapture(g.pointerId)&&y.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(v(g),g.preventDefault())}),onKeyDown:bn(o.onKeyDown,g=>{const y=f.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(y&&g.key===" ")&&DWe.includes(g.key)&&(v(),g.preventDefault())})})})});Wee.displayName=Vee;var Hee="SelectValue",Gee=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:o,children:s,placeholder:i="",...l}=e,c=zh(Hee,r),{onValueNodeHasChildrenChange:d}=c,u=s!==void 0,f=za(t,c.onValueNodeChange);return Ii(()=>{d(u)},[d,u]),a.jsx(oa.span,{...l,ref:f,style:{pointerEvents:"none"},children:fte(c.value)?a.jsx(a.Fragment,{children:i}):s})});Gee.displayName=Hee;var BWe="SelectIcon",Kee=p.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...o}=e;return a.jsx(oa.span,{"aria-hidden":!0,...o,ref:t,children:n||""})});Kee.displayName=BWe;var qWe="SelectPortal",Xee=e=>a.jsx(d0,{asChild:!0,...e});Xee.displayName=qWe;var fg="SelectContent",Yee=p.forwardRef((e,t)=>{const r=zh(fg,e.__scopeSelect),[n,o]=p.useState();if(Ii(()=>{o(new DocumentFragment)},[]),!r.open){const s=n;return s?Qf.createPortal(a.jsx(Jee,{scope:e.__scopeSelect,children:a.jsx(w5.Slot,{scope:e.__scopeSelect,children:a.jsx("div",{children:e.children})})}),s):null}return a.jsx(Qee,{...e,ref:t})});Yee.displayName=fg;var Ud=10,[Jee,Uh]=E0(fg),zWe="SelectContentImpl",UWe=_h("SelectContent.RemoveScroll"),Qee=p.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:s,onPointerDownOutside:i,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:m,sticky:v,hideWhenDetached:g,avoidCollisions:y,...x}=e,b=zh(fg,r),[w,j]=p.useState(null),[_,C]=p.useState(null),E=za(t,Z=>j(Z)),[A,P]=p.useState(null),[F,M]=p.useState(null),I=j5(r),[R,D]=p.useState(!1),U=p.useRef(!1);p.useEffect(()=>{if(w)return uC(w)},[w]),lC();const z=p.useCallback(Z=>{const[ge,...le]=I().map(de=>de.ref.current),[se]=le.slice(-1),ee=document.activeElement;for(const de of Z)if(de===ee||(de?.scrollIntoView({block:"nearest"}),de===ge&&_&&(_.scrollTop=0),de===se&&_&&(_.scrollTop=_.scrollHeight),de?.focus(),document.activeElement!==ee))return},[I,_]),H=p.useCallback(()=>z([A,w]),[z,A,w]);p.useEffect(()=>{R&&H()},[R,H]);const{onOpenChange:q,triggerPointerDownPosRef:Q}=b;p.useEffect(()=>{if(w){let Z={x:0,y:0};const ge=se=>{Z={x:Math.abs(Math.round(se.pageX)-(Q.current?.x??0)),y:Math.abs(Math.round(se.pageY)-(Q.current?.y??0))}},le=se=>{Z.x<=10&&Z.y<=10?se.preventDefault():w.contains(se.target)||q(!1),document.removeEventListener("pointermove",ge),Q.current=null};return Q.current!==null&&(document.addEventListener("pointermove",ge),document.addEventListener("pointerup",le,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ge),document.removeEventListener("pointerup",le,{capture:!0})}}},[w,q,Q]),p.useEffect(()=>{const Z=()=>q(!1);return window.addEventListener("blur",Z),window.addEventListener("resize",Z),()=>{window.removeEventListener("blur",Z),window.removeEventListener("resize",Z)}},[q]);const[pe,be]=mte(Z=>{const ge=I().filter(ee=>!ee.disabled),le=ge.find(ee=>ee.ref.current===document.activeElement),se=hte(ge,Z,le);se&&setTimeout(()=>se.ref.current.focus())}),V=p.useCallback((Z,ge,le)=>{const se=!U.current&&!le;(b.value!==void 0&&b.value===ge||se)&&(P(Z),se&&(U.current=!0))},[b.value]),B=p.useCallback(()=>w?.focus(),[w]),J=p.useCallback((Z,ge,le)=>{const se=!U.current&&!le;(b.value!==void 0&&b.value===ge||se)&&M(Z)},[b.value]),ue=n==="popper"?fT:Zee,Ne=ue===fT?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:m,sticky:v,hideWhenDetached:g,avoidCollisions:y}:{};return a.jsx(Jee,{scope:r,content:w,viewport:_,onViewportChange:C,itemRefCallback:V,selectedItem:A,onItemLeave:B,itemTextRefCallback:J,focusSelectedItem:H,selectedItemText:F,position:n,isPositioned:R,searchRef:pe,children:a.jsx(dC,{as:UWe,allowPinchZoom:!0,children:a.jsx(c1,{asChild:!0,trapped:b.open,onMountAutoFocus:Z=>{Z.preventDefault()},onUnmountAutoFocus:bn(o,Z=>{b.trigger?.focus({preventScroll:!0}),Z.preventDefault()}),children:a.jsx(c0,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:Z=>Z.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:a.jsx(ue,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:Z=>Z.preventDefault(),...x,...Ne,onPlaced:()=>D(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:bn(x.onKeyDown,Z=>{const ge=Z.ctrlKey||Z.altKey||Z.metaKey;if(Z.key==="Tab"&&Z.preventDefault(),!ge&&Z.key.length===1&&be(Z.key),["ArrowUp","ArrowDown","Home","End"].includes(Z.key)){let se=I().filter(ee=>!ee.disabled).map(ee=>ee.ref.current);if(["ArrowUp","End"].includes(Z.key)&&(se=se.slice().reverse()),["ArrowUp","ArrowDown"].includes(Z.key)){const ee=Z.target,de=se.indexOf(ee);se=se.slice(de+1)}setTimeout(()=>z(se)),Z.preventDefault()}})})})})})})});Qee.displayName=zWe;var VWe="SelectItemAlignedPosition",Zee=p.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...o}=e,s=zh(fg,r),i=Uh(fg,r),[l,c]=p.useState(null),[d,u]=p.useState(null),f=za(t,E=>u(E)),h=j5(r),m=p.useRef(!1),v=p.useRef(!0),{viewport:g,selectedItem:y,selectedItemText:x,focusSelectedItem:b}=i,w=p.useCallback(()=>{if(s.trigger&&s.valueNode&&l&&d&&g&&y&&x){const E=s.trigger.getBoundingClientRect(),A=d.getBoundingClientRect(),P=s.valueNode.getBoundingClientRect(),F=x.getBoundingClientRect();if(s.dir!=="rtl"){const ee=F.left-A.left,de=P.left-ee,Le=E.left-de,ae=E.width+Le,ie=Math.max(ae,A.width),dt=window.innerWidth-Ud,At=sz(de,[Ud,Math.max(Ud,dt-ie)]);l.style.minWidth=ae+"px",l.style.left=At+"px"}else{const ee=A.right-F.right,de=window.innerWidth-P.right-ee,Le=window.innerWidth-E.right-de,ae=E.width+Le,ie=Math.max(ae,A.width),dt=window.innerWidth-Ud,At=sz(de,[Ud,Math.max(Ud,dt-ie)]);l.style.minWidth=ae+"px",l.style.right=At+"px"}const M=h(),I=window.innerHeight-Ud*2,R=g.scrollHeight,D=window.getComputedStyle(d),U=parseInt(D.borderTopWidth,10),z=parseInt(D.paddingTop,10),H=parseInt(D.borderBottomWidth,10),q=parseInt(D.paddingBottom,10),Q=U+z+R+q+H,pe=Math.min(y.offsetHeight*5,Q),be=window.getComputedStyle(g),V=parseInt(be.paddingTop,10),B=parseInt(be.paddingBottom,10),J=E.top+E.height/2-Ud,ue=I-J,Ne=y.offsetHeight/2,Z=y.offsetTop+Ne,ge=U+z+Z,le=Q-ge;if(ge<=J){const ee=M.length>0&&y===M[M.length-1].ref.current;l.style.bottom="0px";const de=d.clientHeight-g.offsetTop-g.offsetHeight,Le=Math.max(ue,Ne+(ee?B:0)+de+H),ae=ge+Le;l.style.height=ae+"px"}else{const ee=M.length>0&&y===M[0].ref.current;l.style.top="0px";const Le=Math.max(J,U+g.offsetTop+(ee?V:0)+Ne)+le;l.style.height=Le+"px",g.scrollTop=ge-J+g.offsetTop}l.style.margin=`${Ud}px 0`,l.style.minHeight=pe+"px",l.style.maxHeight=I+"px",n?.(),requestAnimationFrame(()=>m.current=!0)}},[h,s.trigger,s.valueNode,l,d,g,y,x,s.dir,n]);Ii(()=>w(),[w]);const[j,_]=p.useState();Ii(()=>{d&&_(window.getComputedStyle(d).zIndex)},[d]);const C=p.useCallback(E=>{E&&v.current===!0&&(w(),b?.(),v.current=!1)},[w,b]);return a.jsx(HWe,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:C,children:a.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:a.jsx(oa.div,{...o,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});Zee.displayName=VWe;var WWe="SelectPopperPosition",fT=p.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:o=Ud,...s}=e,i=_5(r);return a.jsx(xM,{...i,...s,ref:t,align:n,collisionPadding:o,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});fT.displayName=WWe;var[HWe,EM]=E0(fg,{}),mT="SelectViewport",ete=p.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...o}=e,s=Uh(mT,r),i=EM(mT,r),l=za(t,s.onViewportChange),c=p.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),a.jsx(w5.Slot,{scope:r,children:a.jsx(oa.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:bn(o.onScroll,d=>{const u=d.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:h}=i;if(h?.current&&f){const m=Math.abs(c.current-u.scrollTop);if(m>0){const v=window.innerHeight-Ud*2,g=parseFloat(f.style.minHeight),y=parseFloat(f.style.height),x=Math.max(g,y);if(x<v){const b=x+m,w=Math.min(v,b),j=b-w;f.style.height=w+"px",f.style.bottom==="0px"&&(u.scrollTop=j>0?j:0,f.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});ete.displayName=mT;var tte="SelectGroup",[GWe,KWe]=E0(tte),XWe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,o=nu();return a.jsx(GWe,{scope:r,id:o,children:a.jsx(oa.div,{role:"group","aria-labelledby":o,...n,ref:t})})});XWe.displayName=tte;var rte="SelectLabel",nte=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,o=KWe(rte,r);return a.jsx(oa.div,{id:o.id,...n,ref:t})});nte.displayName=rte;var aS="SelectItem",[YWe,ate]=E0(aS),ote=p.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:o=!1,textValue:s,...i}=e,l=zh(aS,r),c=Uh(aS,r),d=l.value===n,[u,f]=p.useState(s??""),[h,m]=p.useState(!1),v=za(t,b=>c.itemRefCallback?.(b,n,o)),g=nu(),y=p.useRef("touch"),x=()=>{o||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(YWe,{scope:r,value:n,disabled:o,textId:g,isSelected:d,onItemTextChange:p.useCallback(b=>{f(w=>w||(b?.textContent??"").trim())},[]),children:a.jsx(w5.ItemSlot,{scope:r,value:n,disabled:o,textValue:u,children:a.jsx(oa.div,{role:"option","aria-labelledby":g,"data-highlighted":h?"":void 0,"aria-selected":d&&h,"data-state":d?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...i,ref:v,onFocus:bn(i.onFocus,()=>m(!0)),onBlur:bn(i.onBlur,()=>m(!1)),onClick:bn(i.onClick,()=>{y.current!=="mouse"&&x()}),onPointerUp:bn(i.onPointerUp,()=>{y.current==="mouse"&&x()}),onPointerDown:bn(i.onPointerDown,b=>{y.current=b.pointerType}),onPointerMove:bn(i.onPointerMove,b=>{y.current=b.pointerType,o?c.onItemLeave?.():y.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:bn(i.onPointerLeave,b=>{b.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:bn(i.onKeyDown,b=>{c.searchRef?.current!==""&&b.key===" "||(MWe.includes(b.key)&&x(),b.key===" "&&b.preventDefault())})})})})});ote.displayName=aS;var Ay="SelectItemText",ste=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:o,...s}=e,i=zh(Ay,r),l=Uh(Ay,r),c=ate(Ay,r),d=$We(Ay,r),[u,f]=p.useState(null),h=za(t,x=>f(x),c.onItemTextChange,x=>l.itemTextRefCallback?.(x,c.value,c.disabled)),m=u?.textContent,v=p.useMemo(()=>a.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:g,onNativeOptionRemove:y}=d;return Ii(()=>(g(v),()=>y(v)),[g,y,v]),a.jsxs(a.Fragment,{children:[a.jsx(oa.span,{id:c.textId,...s,ref:h}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Qf.createPortal(s.children,i.valueNode):null]})});ste.displayName=Ay;var ite="SelectItemIndicator",lte=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return ate(ite,r).isSelected?a.jsx(oa.span,{"aria-hidden":!0,...n,ref:t}):null});lte.displayName=ite;var hT="SelectScrollUpButton",JWe=p.forwardRef((e,t)=>{const r=Uh(hT,e.__scopeSelect),n=EM(hT,e.__scopeSelect),[o,s]=p.useState(!1),i=za(t,n.onScrollButtonChange);return Ii(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;s(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),o?a.jsx(cte,{...e,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});JWe.displayName=hT;var pT="SelectScrollDownButton",QWe=p.forwardRef((e,t)=>{const r=Uh(pT,e.__scopeSelect),n=EM(pT,e.__scopeSelect),[o,s]=p.useState(!1),i=za(t,n.onScrollButtonChange);return Ii(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;s(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),o?a.jsx(cte,{...e,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});QWe.displayName=pT;var cte=p.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...o}=e,s=Uh("SelectScrollButton",r),i=p.useRef(null),l=j5(r),c=p.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),Ii(()=>{l().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),a.jsx(oa.div,{"aria-hidden":!0,...o,ref:t,style:{flexShrink:0,...o.style},onPointerDown:bn(o.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:bn(o.onPointerMove,()=>{s.onItemLeave?.(),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:bn(o.onPointerLeave,()=>{c()})})}),ZWe="SelectSeparator",dte=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return a.jsx(oa.div,{"aria-hidden":!0,...n,ref:t})});dte.displayName=ZWe;var gT="SelectArrow",eHe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,o=_5(r),s=zh(gT,r),i=Uh(gT,r);return s.open&&i.position==="popper"?a.jsx(yM,{...o,...n,ref:t}):null});eHe.displayName=gT;var tHe="SelectBubbleInput",ute=p.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const o=p.useRef(null),s=za(n,o),i=qee(t);return p.useEffect(()=>{const l=o.current;if(!l)return;const c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==t&&u){const f=new Event("change",{bubbles:!0});u.call(l,t),l.dispatchEvent(f)}},[i,t]),a.jsx(oa.select,{...r,style:{...zee,...r.style},ref:s,defaultValue:t})});ute.displayName=tHe;function fte(e){return e===""||e===void 0}function mte(e){const t=Yl(e),r=p.useRef(""),n=p.useRef(0),o=p.useCallback(i=>{const l=r.current+i;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),s=p.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,o,s]}function hte(e,t,r){const o=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let i=rHe(e,Math.max(s,0));o.length===1&&(i=i.filter(d=>d!==r));const c=i.find(d=>d.textValue.toLowerCase().startsWith(o.toLowerCase()));return c!==r?c:void 0}function rHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var nHe=Uee,pte=Wee,aHe=Gee,oHe=Kee,sHe=Xee,gte=Yee,iHe=ete,vte=nte,xte=ote,lHe=ste,cHe=lte,yte=dte;const Cn=nHe,An=aHe,jn=_e.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(pte,{ref:n,className:mr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground hover:bg-surface-2/30 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-150",e),...r,children:[t,a.jsx(oHe,{asChild:!0,children:a.jsx(i0,{className:"h-4 w-4 opacity-50"})})]}));jn.displayName=pte.displayName;const _n=_e.forwardRef(({className:e,children:t,position:r="popper",...n},o)=>a.jsx(sHe,{children:a.jsx(gte,{ref:o,className:mr("relative z-50 min-w-[8rem] max-h-[340px] overflow-auto fx-scroll rounded-md border bg-popover text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:a.jsx(iHe,{className:mr("p-1",r==="popper"&&"w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));_n.displayName=gte.displayName;const dHe=_e.forwardRef(({className:e,...t},r)=>a.jsx(vte,{ref:r,className:mr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));dHe.displayName=vte.displayName;const nt=_e.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(xte,{ref:n,className:mr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-surface-2/50 focus:bg-surface-2/50 data-[state=checked]:bg-surface-2/50 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 transition-colors",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(cHe,{children:a.jsx(zf,{className:"h-4 w-4"})})}),a.jsx(lHe,{children:t})]}));nt.displayName=xte.displayName;const uHe=_e.forwardRef(({className:e,...t},r)=>a.jsx(yte,{ref:r,className:mr("-mx-1 my-1 h-px bg-muted",e),...t}));uHe.displayName=yte.displayName;var N5="Checkbox",[fHe,Klt]=Pd(N5),[mHe,kM]=fHe(N5);function hHe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:o,disabled:s,form:i,name:l,onCheckedChange:c,required:d,value:u="on",internal_do_not_use_render:f}=e,[h,m]=Vf({prop:r,defaultProp:o??!1,onChange:c,caller:N5}),[v,g]=p.useState(null),[y,x]=p.useState(null),b=p.useRef(!1),w=v?!!i||!!v.closest("form"):!0,j={checked:h,disabled:s,setChecked:m,control:v,setControl:g,name:l,form:i,value:u,hasConsumerStoppedPropagationRef:b,required:d,defaultChecked:dh(o)?!1:o,isFormControl:w,bubbleInput:y,setBubbleInput:x};return a.jsx(mHe,{scope:t,...j,children:pHe(f)?f(j):n})}var bte="CheckboxTrigger",wte=p.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},o)=>{const{control:s,value:i,disabled:l,checked:c,required:d,setControl:u,setChecked:f,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:v}=kM(bte,e),g=za(o,u),y=p.useRef(c);return p.useEffect(()=>{const x=s?.form;if(x){const b=()=>f(y.current);return x.addEventListener("reset",b),()=>x.removeEventListener("reset",b)}},[s,f]),a.jsx(oa.button,{type:"button",role:"checkbox","aria-checked":dh(c)?"mixed":c,"aria-required":d,"data-state":Cte(c),"data-disabled":l?"":void 0,disabled:l,value:i,...n,ref:g,onKeyDown:bn(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:bn(r,x=>{f(b=>dh(b)?!0:!b),v&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});wte.displayName=bte;var IM=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:o,defaultChecked:s,required:i,disabled:l,value:c,onCheckedChange:d,form:u,...f}=e;return a.jsx(hHe,{__scopeCheckbox:r,checked:o,defaultChecked:s,disabled:l,required:i,onCheckedChange:d,name:n,form:u,value:c,internal_do_not_use_render:({isFormControl:h})=>a.jsxs(a.Fragment,{children:[a.jsx(wte,{...f,ref:t,__scopeCheckbox:r}),h&&a.jsx(Ste,{__scopeCheckbox:r})]})})});IM.displayName=N5;var jte="CheckboxIndicator",_te=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...o}=e,s=kM(jte,r);return a.jsx(Bc,{present:n||dh(s.checked)||s.checked===!0,children:a.jsx(oa.span,{"data-state":Cte(s.checked),"data-disabled":s.disabled?"":void 0,...o,ref:t,style:{pointerEvents:"none",...e.style}})})});_te.displayName=jte;var Nte="CheckboxBubbleInput",Ste=p.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:o,checked:s,defaultChecked:i,required:l,disabled:c,name:d,value:u,form:f,bubbleInput:h,setBubbleInput:m}=kM(Nte,e),v=za(r,m),g=qee(s),y=VZ(n);p.useEffect(()=>{const b=h;if(!b)return;const w=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(w,"checked").set,C=!o.current;if(g!==s&&_){const E=new Event("click",{bubbles:C});b.indeterminate=dh(s),_.call(b,dh(s)?!1:s),b.dispatchEvent(E)}},[h,g,s,o]);const x=p.useRef(dh(s)?!1:s);return a.jsx(oa.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??x.current,required:l,disabled:c,name:d,value:u,form:f,...t,tabIndex:-1,ref:v,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Ste.displayName=Nte;function pHe(e){return typeof e=="function"}function dh(e){return e==="indeterminate"}function Cte(e){return dh(e)?"indeterminate":e?"checked":"unchecked"}const Ha=_e.forwardRef(({className:e,...t},r)=>a.jsx(IM,{ref:r,className:mr("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:a.jsx(_te,{className:mr("flex items-center justify-center text-current"),children:a.jsx(zf,{className:"h-4 w-4"})})}));Ha.displayName=IM.displayName;var rE="rovingFocusGroup.onEntryFocus",gHe={bubbles:!1,cancelable:!0},C1="RovingFocusGroup",[vT,Pte,vHe]=y5(C1),[xHe,S5]=Pd(C1,[vHe]),[yHe,bHe]=xHe(C1),Ate=p.forwardRef((e,t)=>a.jsx(vT.Provider,{scope:e.__scopeRovingFocusGroup,children:a.jsx(vT.Slot,{scope:e.__scopeRovingFocusGroup,children:a.jsx(wHe,{...e,ref:t})})}));Ate.displayName=C1;var wHe=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:o=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...f}=e,h=p.useRef(null),m=za(t,h),v=b5(s),[g,y]=Vf({prop:i,defaultProp:l??null,onChange:c,caller:C1}),[x,b]=p.useState(!1),w=Yl(d),j=Pte(r),_=p.useRef(!1),[C,E]=p.useState(0);return p.useEffect(()=>{const A=h.current;if(A)return A.addEventListener(rE,w),()=>A.removeEventListener(rE,w)},[w]),a.jsx(yHe,{scope:r,orientation:n,dir:v,loop:o,currentTabStopId:g,onItemFocus:p.useCallback(A=>y(A),[y]),onItemShiftTab:p.useCallback(()=>b(!0),[]),onFocusableItemAdd:p.useCallback(()=>E(A=>A+1),[]),onFocusableItemRemove:p.useCallback(()=>E(A=>A-1),[]),children:a.jsx(oa.div,{tabIndex:x||C===0?-1:0,"data-orientation":n,...f,ref:m,style:{outline:"none",...e.style},onMouseDown:bn(e.onMouseDown,()=>{_.current=!0}),onFocus:bn(e.onFocus,A=>{const P=!_.current;if(A.target===A.currentTarget&&P&&!x){const F=new CustomEvent(rE,gHe);if(A.currentTarget.dispatchEvent(F),!F.defaultPrevented){const M=j().filter(z=>z.focusable),I=M.find(z=>z.active),R=M.find(z=>z.id===g),U=[I,R,...M].filter(Boolean).map(z=>z.ref.current);Ite(U,u)}}_.current=!1}),onBlur:bn(e.onBlur,()=>b(!1))})})}),Ete="RovingFocusGroupItem",kte=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:o=!1,tabStopId:s,children:i,...l}=e,c=nu(),d=s||c,u=bHe(Ete,r),f=u.currentTabStopId===d,h=Pte(r),{onFocusableItemAdd:m,onFocusableItemRemove:v,currentTabStopId:g}=u;return p.useEffect(()=>{if(n)return m(),()=>v()},[n,m,v]),a.jsx(vT.ItemSlot,{scope:r,id:d,focusable:n,active:o,children:a.jsx(oa.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...l,ref:t,onMouseDown:bn(e.onMouseDown,y=>{n?u.onItemFocus(d):y.preventDefault()}),onFocus:bn(e.onFocus,()=>u.onItemFocus(d)),onKeyDown:bn(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const x=NHe(y,u.orientation,u.dir);if(x!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=h().filter(j=>j.focusable).map(j=>j.ref.current);if(x==="last")w.reverse();else if(x==="prev"||x==="next"){x==="prev"&&w.reverse();const j=w.indexOf(y.currentTarget);w=u.loop?SHe(w,j+1):w.slice(j+1)}setTimeout(()=>Ite(w))}}),children:typeof i=="function"?i({isCurrentTabStop:f,hasTabStop:g!=null}):i})})});kte.displayName=Ete;var jHe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function _He(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function NHe(e,t,r){const n=_He(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return jHe[n]}function Ite(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function SHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Ote=Ate,Tte=kte,xT=["Enter"," "],CHe=["ArrowDown","PageUp","Home"],Dte=["ArrowUp","PageDown","End"],PHe=[...CHe,...Dte],AHe={ltr:[...xT,"ArrowRight"],rtl:[...xT,"ArrowLeft"]},EHe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},P1="Menu",[Tw,kHe,IHe]=y5(P1),[Eg,Mte]=Pd(P1,[IHe,A0,S5]),C5=A0(),Rte=S5(),[OHe,kg]=Eg(P1),[THe,A1]=Eg(P1),Lte=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:o,onOpenChange:s,modal:i=!0}=e,l=C5(t),[c,d]=p.useState(null),u=p.useRef(!1),f=Yl(s),h=b5(o);return p.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),a.jsx(vM,{...l,children:a.jsx(OHe,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:d,children:a.jsx(THe,{scope:t,onClose:p.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:h,modal:i,children:n})})})};Lte.displayName=P1;var DHe="MenuAnchor",OM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,o=C5(r);return a.jsx(g5,{...o,...n,ref:t})});OM.displayName=DHe;var TM="MenuPortal",[MHe,Fte]=Eg(TM,{forceMount:void 0}),$te=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:o}=e,s=kg(TM,t);return a.jsx(MHe,{scope:t,forceMount:r,children:a.jsx(Bc,{present:r||s.open,children:a.jsx(d0,{asChild:!0,container:o,children:n})})})};$te.displayName=TM;var yd="MenuContent",[RHe,DM]=Eg(yd),Bte=p.forwardRef((e,t)=>{const r=Fte(yd,e.__scopeMenu),{forceMount:n=r.forceMount,...o}=e,s=kg(yd,e.__scopeMenu),i=A1(yd,e.__scopeMenu);return a.jsx(Tw.Provider,{scope:e.__scopeMenu,children:a.jsx(Bc,{present:n||s.open,children:a.jsx(Tw.Slot,{scope:e.__scopeMenu,children:i.modal?a.jsx(LHe,{...o,ref:t}):a.jsx(FHe,{...o,ref:t})})})})}),LHe=p.forwardRef((e,t)=>{const r=kg(yd,e.__scopeMenu),n=p.useRef(null),o=za(t,n);return p.useEffect(()=>{const s=n.current;if(s)return uC(s)},[]),a.jsx(MM,{...e,ref:o,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:bn(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),FHe=p.forwardRef((e,t)=>{const r=kg(yd,e.__scopeMenu);return a.jsx(MM,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),$He=_h("MenuContent.ScrollLock"),MM=p.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:o,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:m,disableOutsideScroll:v,...g}=e,y=kg(yd,r),x=A1(yd,r),b=C5(r),w=Rte(r),j=kHe(r),[_,C]=p.useState(null),E=p.useRef(null),A=za(t,E,y.onContentChange),P=p.useRef(0),F=p.useRef(""),M=p.useRef(0),I=p.useRef(null),R=p.useRef("right"),D=p.useRef(0),U=v?dC:p.Fragment,z=v?{as:$He,allowPinchZoom:!0}:void 0,H=Q=>{const pe=F.current+Q,be=j().filter(Z=>!Z.disabled),V=document.activeElement,B=be.find(Z=>Z.ref.current===V)?.textValue,J=be.map(Z=>Z.textValue),ue=JHe(J,pe,B),Ne=be.find(Z=>Z.textValue===ue)?.ref.current;(function Z(ge){F.current=ge,window.clearTimeout(P.current),ge!==""&&(P.current=window.setTimeout(()=>Z(""),1e3))})(pe),Ne&&setTimeout(()=>Ne.focus())};p.useEffect(()=>()=>window.clearTimeout(P.current),[]),lC();const q=p.useCallback(Q=>R.current===I.current?.side&&ZHe(Q,I.current?.area),[]);return a.jsx(RHe,{scope:r,searchRef:F,onItemEnter:p.useCallback(Q=>{q(Q)&&Q.preventDefault()},[q]),onItemLeave:p.useCallback(Q=>{q(Q)||(E.current?.focus(),C(null))},[q]),onTriggerLeave:p.useCallback(Q=>{q(Q)&&Q.preventDefault()},[q]),pointerGraceTimerRef:M,onPointerGraceIntentChange:p.useCallback(Q=>{I.current=Q},[]),children:a.jsx(U,{...z,children:a.jsx(c1,{asChild:!0,trapped:o,onMountAutoFocus:bn(s,Q=>{Q.preventDefault(),E.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:a.jsx(c0,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:m,children:a.jsx(Ote,{asChild:!0,...w,dir:x.dir,orientation:"vertical",loop:n,currentTabStopId:_,onCurrentTabStopIdChange:C,onEntryFocus:bn(c,Q=>{x.isUsingKeyboardRef.current||Q.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(xM,{role:"menu","aria-orientation":"vertical","data-state":rre(y.open),"data-radix-menu-content":"",dir:x.dir,...b,...g,ref:A,style:{outline:"none",...g.style},onKeyDown:bn(g.onKeyDown,Q=>{const be=Q.target.closest("[data-radix-menu-content]")===Q.currentTarget,V=Q.ctrlKey||Q.altKey||Q.metaKey,B=Q.key.length===1;be&&(Q.key==="Tab"&&Q.preventDefault(),!V&&B&&H(Q.key));const J=E.current;if(Q.target!==J||!PHe.includes(Q.key))return;Q.preventDefault();const Ne=j().filter(Z=>!Z.disabled).map(Z=>Z.ref.current);Dte.includes(Q.key)&&Ne.reverse(),XHe(Ne)}),onBlur:bn(e.onBlur,Q=>{Q.currentTarget.contains(Q.target)||(window.clearTimeout(P.current),F.current="")}),onPointerMove:bn(e.onPointerMove,Dw(Q=>{const pe=Q.target,be=D.current!==Q.clientX;if(Q.currentTarget.contains(pe)&&be){const V=Q.clientX>D.current?"right":"left";R.current=V,D.current=Q.clientX}}))})})})})})})});Bte.displayName=yd;var BHe="MenuGroup",RM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return a.jsx(oa.div,{role:"group",...n,ref:t})});RM.displayName=BHe;var qHe="MenuLabel",qte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return a.jsx(oa.div,{...n,ref:t})});qte.displayName=qHe;var oS="MenuItem",iz="menu.itemSelect",P5=p.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...o}=e,s=p.useRef(null),i=A1(oS,e.__scopeMenu),l=DM(oS,e.__scopeMenu),c=za(t,s),d=p.useRef(!1),u=()=>{const f=s.current;if(!r&&f){const h=new CustomEvent(iz,{bubbles:!0,cancelable:!0});f.addEventListener(iz,m=>n?.(m),{once:!0}),R4(f,h),h.defaultPrevented?d.current=!1:i.onClose()}};return a.jsx(zte,{...o,ref:c,disabled:r,onClick:bn(e.onClick,u),onPointerDown:f=>{e.onPointerDown?.(f),d.current=!0},onPointerUp:bn(e.onPointerUp,f=>{d.current||f.currentTarget?.click()}),onKeyDown:bn(e.onKeyDown,f=>{const h=l.searchRef.current!=="";r||h&&f.key===" "||xT.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});P5.displayName=oS;var zte=p.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:o,...s}=e,i=DM(oS,r),l=Rte(r),c=p.useRef(null),d=za(t,c),[u,f]=p.useState(!1),[h,m]=p.useState("");return p.useEffect(()=>{const v=c.current;v&&m((v.textContent??"").trim())},[s.children]),a.jsx(Tw.ItemSlot,{scope:r,disabled:n,textValue:o??h,children:a.jsx(Tte,{asChild:!0,...l,focusable:!n,children:a.jsx(oa.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...s,ref:d,onPointerMove:bn(e.onPointerMove,Dw(v=>{n?i.onItemLeave(v):(i.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:bn(e.onPointerLeave,Dw(v=>i.onItemLeave(v))),onFocus:bn(e.onFocus,()=>f(!0)),onBlur:bn(e.onBlur,()=>f(!1))})})})}),zHe="MenuCheckboxItem",Ute=p.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...o}=e;return a.jsx(Kte,{scope:e.__scopeMenu,checked:r,children:a.jsx(P5,{role:"menuitemcheckbox","aria-checked":sS(r)?"mixed":r,...o,ref:t,"data-state":FM(r),onSelect:bn(o.onSelect,()=>n?.(sS(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Ute.displayName=zHe;var Vte="MenuRadioGroup",[UHe,VHe]=Eg(Vte,{value:void 0,onValueChange:()=>{}}),Wte=p.forwardRef((e,t)=>{const{value:r,onValueChange:n,...o}=e,s=Yl(n);return a.jsx(UHe,{scope:e.__scopeMenu,value:r,onValueChange:s,children:a.jsx(RM,{...o,ref:t})})});Wte.displayName=Vte;var Hte="MenuRadioItem",Gte=p.forwardRef((e,t)=>{const{value:r,...n}=e,o=VHe(Hte,e.__scopeMenu),s=r===o.value;return a.jsx(Kte,{scope:e.__scopeMenu,checked:s,children:a.jsx(P5,{role:"menuitemradio","aria-checked":s,...n,ref:t,"data-state":FM(s),onSelect:bn(n.onSelect,()=>o.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});Gte.displayName=Hte;var LM="MenuItemIndicator",[Kte,WHe]=Eg(LM,{checked:!1}),Xte=p.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...o}=e,s=WHe(LM,r);return a.jsx(Bc,{present:n||sS(s.checked)||s.checked===!0,children:a.jsx(oa.span,{...o,ref:t,"data-state":FM(s.checked)})})});Xte.displayName=LM;var HHe="MenuSeparator",Yte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return a.jsx(oa.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});Yte.displayName=HHe;var GHe="MenuArrow",Jte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,o=C5(r);return a.jsx(yM,{...o,...n,ref:t})});Jte.displayName=GHe;var KHe="MenuSub",[Xlt,Qte]=Eg(KHe),Ey="MenuSubTrigger",Zte=p.forwardRef((e,t)=>{const r=kg(Ey,e.__scopeMenu),n=A1(Ey,e.__scopeMenu),o=Qte(Ey,e.__scopeMenu),s=DM(Ey,e.__scopeMenu),i=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=s,d={__scopeMenu:e.__scopeMenu},u=p.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return p.useEffect(()=>u,[u]),p.useEffect(()=>{const f=l.current;return()=>{window.clearTimeout(f),c(null)}},[l,c]),a.jsx(OM,{asChild:!0,...d,children:a.jsx(zte,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":o.contentId,"data-state":rre(r.open),...e,ref:iC(t,o.onTriggerChange),onClick:f=>{e.onClick?.(f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:bn(e.onPointerMove,Dw(f=>{s.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!i.current&&(s.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:bn(e.onPointerLeave,Dw(f=>{u();const h=r.content?.getBoundingClientRect();if(h){const m=r.content?.dataset.side,v=m==="right",g=v?-5:5,y=h[v?"left":"right"],x=h[v?"right":"left"];s.onPointerGraceIntentChange({area:[{x:f.clientX+g,y:f.clientY},{x:y,y:h.top},{x,y:h.top},{x,y:h.bottom},{x:y,y:h.bottom}],side:m}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(f),f.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:bn(e.onKeyDown,f=>{const h=s.searchRef.current!=="";e.disabled||h&&f.key===" "||AHe[n.dir].includes(f.key)&&(r.onOpenChange(!0),r.content?.focus(),f.preventDefault())})})})});Zte.displayName=Ey;var ere="MenuSubContent",tre=p.forwardRef((e,t)=>{const r=Fte(yd,e.__scopeMenu),{forceMount:n=r.forceMount,...o}=e,s=kg(yd,e.__scopeMenu),i=A1(yd,e.__scopeMenu),l=Qte(ere,e.__scopeMenu),c=p.useRef(null),d=za(t,c);return a.jsx(Tw.Provider,{scope:e.__scopeMenu,children:a.jsx(Bc,{present:n||s.open,children:a.jsx(Tw.Slot,{scope:e.__scopeMenu,children:a.jsx(MM,{id:l.contentId,"aria-labelledby":l.triggerId,...o,ref:d,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{i.isUsingKeyboardRef.current&&c.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:bn(e.onFocusOutside,u=>{u.target!==l.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:bn(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:bn(e.onKeyDown,u=>{const f=u.currentTarget.contains(u.target),h=EHe[i.dir].includes(u.key);f&&h&&(s.onOpenChange(!1),l.trigger?.focus(),u.preventDefault())})})})})})});tre.displayName=ere;function rre(e){return e?"open":"closed"}function sS(e){return e==="indeterminate"}function FM(e){return sS(e)?"indeterminate":e?"checked":"unchecked"}function XHe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function YHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function JHe(e,t,r){const o=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let i=YHe(e,Math.max(s,0));o.length===1&&(i=i.filter(d=>d!==r));const c=i.find(d=>d.toLowerCase().startsWith(o.toLowerCase()));return c!==r?c:void 0}function QHe(e,t){const{x:r,y:n}=e;let o=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const l=t[s],c=t[i],d=l.x,u=l.y,f=c.x,h=c.y;u>n!=h>n&&r<(f-d)*(n-u)/(h-u)+d&&(o=!o)}return o}function ZHe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return QHe(r,t)}function Dw(e){return t=>t.pointerType==="mouse"?e(t):void 0}var eGe=Lte,tGe=OM,rGe=$te,nGe=Bte,aGe=RM,oGe=qte,sGe=P5,iGe=Ute,lGe=Wte,cGe=Gte,dGe=Xte,uGe=Yte,fGe=Jte,mGe=Zte,hGe=tre,A5="DropdownMenu",[pGe,Ylt]=Pd(A5,[Mte]),_l=Mte(),[gGe,nre]=pGe(A5),are=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:o,defaultOpen:s,onOpenChange:i,modal:l=!0}=e,c=_l(t),d=p.useRef(null),[u,f]=Vf({prop:o,defaultProp:s??!1,onChange:i,caller:A5});return a.jsx(gGe,{scope:t,triggerId:nu(),triggerRef:d,contentId:nu(),open:u,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(h=>!h),[f]),modal:l,children:a.jsx(eGe,{...c,open:u,onOpenChange:f,dir:n,modal:l,children:r})})};are.displayName=A5;var ore="DropdownMenuTrigger",sre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...o}=e,s=nre(ore,r),i=_l(r);return a.jsx(tGe,{asChild:!0,...i,children:a.jsx(oa.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...o,ref:iC(t,s.triggerRef),onPointerDown:bn(e.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(s.onOpenToggle(),s.open||l.preventDefault())}),onKeyDown:bn(e.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&s.onOpenToggle(),l.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});sre.displayName=ore;var vGe="DropdownMenuPortal",ire=e=>{const{__scopeDropdownMenu:t,...r}=e,n=_l(t);return a.jsx(rGe,{...n,...r})};ire.displayName=vGe;var lre="DropdownMenuContent",cre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=nre(lre,r),s=_l(r),i=p.useRef(!1);return a.jsx(nGe,{id:o.contentId,"aria-labelledby":o.triggerId,...s,...n,ref:t,onCloseAutoFocus:bn(e.onCloseAutoFocus,l=>{i.current||o.triggerRef.current?.focus(),i.current=!1,l.preventDefault()}),onInteractOutside:bn(e.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;(!o.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});cre.displayName=lre;var xGe="DropdownMenuGroup",yGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(aGe,{...o,...n,ref:t})});yGe.displayName=xGe;var bGe="DropdownMenuLabel",dre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(oGe,{...o,...n,ref:t})});dre.displayName=bGe;var wGe="DropdownMenuItem",ure=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(sGe,{...o,...n,ref:t})});ure.displayName=wGe;var jGe="DropdownMenuCheckboxItem",fre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(iGe,{...o,...n,ref:t})});fre.displayName=jGe;var _Ge="DropdownMenuRadioGroup",NGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(lGe,{...o,...n,ref:t})});NGe.displayName=_Ge;var SGe="DropdownMenuRadioItem",mre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(cGe,{...o,...n,ref:t})});mre.displayName=SGe;var CGe="DropdownMenuItemIndicator",hre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(dGe,{...o,...n,ref:t})});hre.displayName=CGe;var PGe="DropdownMenuSeparator",pre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(uGe,{...o,...n,ref:t})});pre.displayName=PGe;var AGe="DropdownMenuArrow",EGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(fGe,{...o,...n,ref:t})});EGe.displayName=AGe;var kGe="DropdownMenuSubTrigger",gre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(mGe,{...o,...n,ref:t})});gre.displayName=kGe;var IGe="DropdownMenuSubContent",vre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,o=_l(r);return a.jsx(hGe,{...o,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});vre.displayName=IGe;var OGe=are,TGe=sre,DGe=ire,xre=cre,yre=dre,bre=ure,wre=fre,jre=mre,_re=hre,Nre=pre,Sre=gre,Cre=vre;const ob=OGe,sb=TGe,MGe=_e.forwardRef(({className:e,inset:t,children:r,...n},o)=>a.jsxs(Sre,{ref:o,className:mr("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,a.jsx(l0,{className:"ml-auto h-4 w-4"})]}));MGe.displayName=Sre.displayName;const RGe=_e.forwardRef(({className:e,...t},r)=>a.jsx(Cre,{ref:r,className:mr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));RGe.displayName=Cre.displayName;const nx=_e.forwardRef(({className:e,sideOffset:t=4,...r},n)=>a.jsx(DGe,{children:a.jsx(xre,{ref:n,sideOffset:t,className:mr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));nx.displayName=xre.displayName;const dl=_e.forwardRef(({className:e,inset:t,...r},n)=>a.jsx(bre,{ref:n,className:mr("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));dl.displayName=bre.displayName;const LGe=_e.forwardRef(({className:e,children:t,checked:r,...n},o)=>a.jsxs(wre,{ref:o,className:mr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(_re,{children:a.jsx(zf,{className:"h-4 w-4"})})}),t]}));LGe.displayName=wre.displayName;const FGe=_e.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(jre,{ref:n,className:mr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(_re,{children:a.jsx(xue,{className:"h-2 w-2 fill-current"})})}),t]}));FGe.displayName=jre.displayName;const yT=_e.forwardRef(({className:e,inset:t,...r},n)=>a.jsx(yre,{ref:n,className:mr("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));yT.displayName=yre.displayName;const Yj=_e.forwardRef(({className:e,...t},r)=>a.jsx(Nre,{ref:r,className:mr("-mx-1 my-1 h-px bg-muted",e),...t}));Yj.displayName=Nre.displayName;function aa(){try{const e=localStorage.getItem("auth:userProfile");if(e){const r=JSON.parse(e);if(r?.codigo_empresa)return r.codigo_empresa}const t=localStorage.getItem("auth:company");if(t){const r=JSON.parse(t);if(r?.codigo_empresa)return r.codigo_empresa;if(r?.codigo)return r.codigo}return typeof window<"u"&&window.__authProfile&&window.__authProfile.codigo_empresa?window.__authProfile.codigo_empresa:null}catch{return null}}async function Wm({somenteAtivas:e=!0,codigoEmpresa:t}={}){const r=t||aa();let n=fe.from("finalizadoras").select("*").order("codigo_interno",{ascending:!0,nullsFirst:!1}).order("nome",{ascending:!0});r&&(n=n.eq("codigo_empresa",r)),e&&(n=n.eq("ativo",!0));const{data:o,error:s}=await n;if(s)throw s;const i=o||[];return i.sort((l,c)=>{const d=parseInt(l?.codigo_interno)||0,u=parseInt(c?.codigo_interno)||0;if(d!==u)return d-u;const f=(l?.nome||"").toLowerCase(),h=(c?.nome||"").toLowerCase();return f.localeCompare(h)}),i}async function $Ge(e,t){const r=t||aa(),n={codigo_interno:e?.codigo_interno||null,codigo_sefaz:e?.codigo_sefaz||null,nome:(e?.nome||"").trim(),tipo:e?.tipo||"outros",ativo:e?.ativo??!0,taxa_percentual:e?.taxa_percentual==null?null:Number(e.taxa_percentual)};if(!n.nome)throw new Error("Nome  obrigatrio");r&&(n.codigo_empresa=r);const{data:o,error:s}=await fe.from("finalizadoras").insert(n).select("*").single();if(s)throw s;return o}async function iS({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||aa();let n=fe.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n;if(s)throw s;const i=Array.isArray(o)?o[0]:o;if(!i)throw new Error("Sesso no encontrada");const l=i.aberto_em,c=i.fechado_em||new Date().toISOString(),d=await hd({from:l,to:c,codigoEmpresa:r});let u=0,f=0,h=0,m=0;try{let g=fe.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",e);r&&(g=g.eq("codigo_empresa",r));const{data:y}=await g;for(const x of y||[]){const b=Number(x?.valor||0),w=String(x?.tipo||"").toLowerCase();w==="suprimento"?u+=b:w==="sangria"?f+=b:w==="ajuste"?h+=b:w==="troco"&&(m+=b)}}catch{}const v=u+h-f-m;return{...d,saldoInicial:Number(i.saldo_inicial||0),saldoFinal:i.saldo_final!=null?Number(i.saldo_final):null,movimentos:{suprimentos:u,sangrias:f,ajustes:h,troco:m,totalMovimentos:v}}}async function BGe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||aa(),o={codigo_interno:t?.codigo_interno||null,codigo_sefaz:t?.codigo_sefaz||null,nome:(t?.nome||"").trim(),tipo:t?.tipo||"outros",ativo:t?.ativo??!0,taxa_percentual:t?.taxa_percentual==null?null:Number(t.taxa_percentual)};if(!o.nome)throw new Error("Nome  obrigatrio");let s=fe.from("finalizadoras").update(o).eq("id",e);n&&(s=s.eq("codigo_empresa",n));const{data:i,error:l}=await s.select("*").single();if(l)throw l;return i}async function qGe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||aa();let o=fe.from("finalizadoras").update({ativo:!!t}).eq("id",e);n&&(o=o.eq("codigo_empresa",n));const{data:s,error:i}=await o.select("*").single();if(i)throw i;return s}async function $M({codigoEmpresa:e}={}){const t=e||aa();let r=fe.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:o}=await r;if(o)throw o;if(!(Array.isArray(n)&&n.length>0)){const i=new Error(" necessrio abrir o caixa antes de criar comandas.");throw i.code="NO_OPEN_CASH_SESSION",i}return!0}async function bT(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||aa(),n=async i=>{let l=fe.from("comanda_clientes").select(`comanda_id, cliente_id, nome_livre, clientes:clientes${i}(id, nome)`).in("comanda_id",e);return r&&(l=l.eq("codigo_empresa",r)),l};let o=[];try{const{data:i,error:l}=await n("!comanda_clientes_cliente_id_fkey");if(l)throw l;o=i||[]}catch{try{const{data:i,error:l}=await n("!fk_comanda_clientes_cliente");if(l)throw l;o=i||[]}catch{let i=fe.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",e);r&&(i=i.eq("codigo_empresa",r));const{data:l}=await i;o=l||[]}}const s={};for(const i of o){const l=i.comanda_id,c=i.clientes?.nome||i.nome_livre||"";s[l]||(s[l]=[]),c&&s[l].push(c)}for(const i of Object.keys(s))s[i]=Array.from(new Set(s[i])).join(", ");return s}async function wT(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||aa();let n=fe.from("pagamentos").select("comanda_id, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n;if(s)throw s;const i={};for(const c of o||[]){if(!((c.status||"Pago")!=="Cancelado"&&(c.status||"Pago")!=="Estornado"))continue;const u=c.comanda_id,f=c?.finalizadoras?.nome||c.metodo||"Outros";i[u]||(i[u]=[]),i[u].push(f)}const l={};for(const[c,d]of Object.entries(i))d.length===0?l[c]="":d.length===1?l[c]=d[0]:l[c]=`${d[0]} +${d.length-1}`;return l}async function zGe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||aa();let n=fe.from("comanda_itens").select("produto_id, quantidade").eq("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n;if(s)throw s;const i=new Map;for(const m of o||[]){const v=m.produto_id,g=Number(m.quantidade||0);i.set(v,(i.get(v)||0)+g)}if(i.size===0)return!0;const l=Array.from(i.keys());let c=fe.from("produtos").select("id, nome, estoque");c=c.in("id",l),r&&(c=c.eq("codigo_empresa",r));const{data:d,error:u}=await c;if(u)throw u;const f=new Map((d||[]).map(m=>[m.id,{nome:m.nome,estoque:Number(m.estoque||0)}])),h=[];for(const[m,v]of i.entries()){const g=f.get(m)||{nome:`Produto ${m}`,estoque:0};v>g.estoque&&h.push({id:m,name:g.nome,solicitado:v,estoque:g.estoque})}if(h.length>0){const m=h.map(g=>`${g.name}: solicitado ${g.solicitado}, estoque ${g.estoque}`).join("; "),v=new Error(`Estoque insuficiente para finalizar: ${m}`);throw v.code="INSUFFICIENT_STOCK_COMANDA",v.items=h,v}return!0}async function $v({codigoEmpresa:e}={}){const t=e||aa();let r=fe.from("comandas").select("id,status,aberto_em").is("mesa_id",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:o}=await r;if(o)throw o;return n?.[0]||null}async function Jj({codigoEmpresa:e}={}){const t=e||aa();console.log("[getOrCreateComandaBalcao] Iniciando com codigo_empresa:",t),await $M({codigoEmpresa:t});const r=await $v({codigoEmpresa:t});if(r)return console.log("[getOrCreateComandaBalcao] Comanda existente encontrada:",r),r;const n={status:"open",mesa_id:null,aberto_em:new Date().toISOString()};console.log("[getOrCreateComandaBalcao] Criando nova comanda (codigo_empresa via DEFAULT):",n);const{data:o,error:s}=await fe.from("comandas").insert(n).select("id,status,aberto_em,tipo,codigo_empresa").single();if(s)throw console.error("[getOrCreateComandaBalcao] ERRO ao criar comanda:",s),s;return console.log("[getOrCreateComandaBalcao] Comanda criada com sucesso:",o),console.log("[getOrCreateComandaBalcao] Codigo da comanda criada:",o?.codigo_empresa,"vs esperado:",t),await new Promise(i=>setTimeout(i,100)),o}async function lz({status:e,from:t,to:r,search:n="",limit:o=50,offset:s=0,codigoEmpresa:i}={}){const l=i||aa();let c=fe.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").order("fechado_em",{ascending:!1,nullsFirst:!1}).order("aberto_em",{ascending:!1}).range(s,s+o-1);l&&(c=c.eq("codigo_empresa",l)),e&&Array.isArray(e)&&e.length?c=c.in("status",e):typeof e=="string"&&e!=="all"&&(e==="closed"?c=c.or("status.eq.closed,fechado_em.not.is.null").neq("status","cancelled"):c=c.eq("status",e));const d=y=>{if(!y)return null;if(typeof y=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(y)){const[x,b,w]=y.split("-").map(Number);return new Date(x,b-1,w,0,0,0,0)}return new Date(y)},u=y=>{if(!y)return null;if(typeof y=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(y)){const[x,b,w]=y.split("-").map(Number);return new Date(x,b-1,w,23,59,59,999)}return new Date(y)},f=d(t),h=u(r);f&&(c=c.gte("aberto_em",f.toISOString())),h&&(c=c.lte("aberto_em",h.toISOString()));const m=(n||"").trim();if(m){const y=/^\d+$/.test(m);if(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(m)){const b=fe.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("id",m).eq("codigo_empresa",l),w=fe.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("mesa_id",m).eq("codigo_empresa",l),[j,_]=await Promise.all([b,w]),C=j.data||[],E=_.data||[],A=[...C,...E];return Array.from(new Map(A.map(F=>[F.id,F])).values()).sort((F,M)=>new Date(M.fechado_em||M.aberto_em)-new Date(F.fechado_em||F.aberto_em))}else y?c=c.or(`id.eq.${m},status.ilike.%${m}%`):c=c.or(`status.ilike.%${m}%`)}const{data:v,error:g}=await c;if(g)throw g;return v||[]}async function hd({from:e,to:t,codigoEmpresa:r}={}){const n="[listarResumoPeriodo]",o=r||aa();console.log(`${n} Iniciando consulta`),console.log(`${n} Perodo: ${e||"SEM from"} at ${t||"SEM to"}`),console.log(`${n} codigo_empresa: ${o}`);let s=[];try{let h=fe.from("comandas").select("id, fechado_em").eq("status","closed");o&&(h=h.eq("codigo_empresa",o)),e&&(h=h.gte("fechado_em",new Date(e).toISOString())),t&&(h=h.lte("fechado_em",new Date(t).toISOString()));const{data:m,error:v}=await h;if(v)throw v;s=m||[]}catch{s=[]}const i=(s||[]).map(h=>h.id);let l=0,c=0;if(i.length>0)try{let h=fe.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",i);o&&(h=h.eq("codigo_empresa",o));const{data:m,error:v}=await h;if(v)throw v;for(const g of m||[]){const y=Number(g.quantidade||0)*Number(g.preco_unitario||0),x=Number(g.desconto||0);l+=y,c+=x}}catch{}const d=Math.max(0,l-c),u={};let f=0;try{let h=fe.from("pagamentos").select("metodo, valor, recebido_em, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)");o&&(h=h.eq("codigo_empresa",o)),e&&(h=h.gte("recebido_em",new Date(e).toISOString())),t&&(h=h.lte("recebido_em",new Date(t).toISOString())),console.log(`${n} Consultando pagamentos de comandas...`);const{data:m,error:v}=await h;if(v)throw console.error(`${n}  Erro ao buscar pagamentos:`,v),v;console.log(`${n} Total de pagamentos de comandas encontrados: ${(m||[]).length}`);for(const g of m||[]){if(!((g.status||"Pago")!=="Cancelado"&&(g.status||"Pago")!=="Estornado"))continue;const x=g.finalizadoras?.nome||g.metodo||"outros",b=Number(g.valor||0);u[x]=(u[x]||0)+b,f+=b}console.log(`${n}  Resumo comandas por finalizadora:`,u)}catch(h){console.error(`${n}  Exception ao processar pagamentos de comandas:`,h)}try{let h=fe.from("agendamentos").select("id, inicio");o&&(h=h.eq("codigo_empresa",o)),e&&(h=h.gte("inicio",new Date(e).toISOString())),t&&(h=h.lte("inicio",new Date(t).toISOString())),console.log(`${n} Consultando agendamentos no perodo...`);const{data:m,error:v}=await h;if(v)throw console.error(`${n}  Erro ao buscar agendamentos:`,v),v;if(console.log(`${n} Total de agendamentos encontrados: ${(m||[]).length}`),m&&m.length>0){const g=m.map(w=>w.id);let y=fe.from("agendamento_participantes").select("valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(nome, taxa_percentual)").in("agendamento_id",g).eq("status_pagamento","Pago");o&&(y=y.eq("codigo_empresa",o)),console.log(`${n} Consultando participantes pagos...`);const{data:x,error:b}=await y;if(b)throw console.error(`${n}  Erro ao buscar participantes:`,b),b;console.log(`${n} Total de participantes pagos encontrados: ${(x||[]).length}`);for(const w of x||[]){const j=w.finalizadoras?.nome||"Outros";let _=Number(w.valor_cota||0);if(w.aplicar_taxa===!0){const C=Number(w.finalizadoras?.taxa_percentual||0);C>0&&(_=_/(1+C/100),console.log(`${n}  Participante com taxa: valor_cota=${w.valor_cota}, taxa=${C}%, valor_real=${_.toFixed(2)}`))}u[j]=(u[j]||0)+_,f+=_}console.log(`${n}  Resumo agendamentos por finalizadora:`,u)}}catch(h){console.error(`${n}  Exception ao processar pagamentos de agendamentos:`,h)}return console.log(`${n}  RESUMO FINAL por finalizadora:`,u),console.log(`${n} Total de entradas: R$ ${f.toFixed(2)}`),{from:e?new Date(e).toISOString():null,to:t?new Date(t).toISOString():null,totalPorFinalizadora:u,totalEntradas:f,totalVendasBrutas:l,totalDescontos:c,totalVendasLiquidas:d}}async function Mw({codigoEmpresa:e}={}){const t=e||aa();let r=null;try{let o=fe.from("caixa_sessoes").select("aberto_em").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(o=o.eq("codigo_empresa",t));const{data:s,error:i}=await o;if(i)throw i;r=s?.[0]?.aberto_em||null}catch{}if(!r)return null;const n=new Date().toISOString();return hd({from:r,to:n,codigoEmpresa:t})}async function Pre({comandaId:e,codigoEmpresa:t}={}){const r=t||aa();let n=fe.from("pagamentos").select("*, finalizadoras!pagamentos_finalizadora_id_fkey(id, nome, codigo_sefaz, codigo_interno)").order("recebido_em",{ascending:!0});e&&(n=n.eq("comanda_id",e)),r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n;if(s)throw s;return o||[]}async function ib({searchTerm:e="",limit:t=20,codigoEmpresa:r}={}){const n=r||aa();let o=fe.from("clientes").select("*").eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0}).limit(t);n&&(o=o.eq("codigo_empresa",n));const s=(e||"").trim();s&&(/^\d+$/.test(s)?o=o.or(`codigo.eq.${s},nome.ilike.%${s}%,email.ilike.%${s}%,telefone.ilike.%${s}%`):o=o.or(`nome.ilike.%${s}%,email.ilike.%${s}%,telefone.ilike.%${s}%`));const{data:i,error:l}=await o;if(l)throw l;return i||[]}async function yc({codigoEmpresa:e}={}){const t="[listarComandasAbertas]",r=e||aa(),n=async()=>{const o=new Promise((c,d)=>setTimeout(()=>d(new Error("listarComandasAbertas timeout aps 30s")),3e4));let s=fe.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, observacoes, observacoes_atualizadas_em").is("fechado_em",null).neq("status","cancelled").order("aberto_em",{ascending:!1}).limit(500);r&&(s=s.eq("codigo_empresa",r));const{data:i,error:l}=await Promise.race([s,o]);if(l)throw l;return i||[]};try{try{return await n()}catch(o){if(String(o?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw o}}catch(o){return console.error(`${t}  EXCEPTION:`,o?.message||o),[]}}async function lS(e=[],t){if(!e||e.length===0)return{};const r=t||aa();let n=fe.from("comanda_itens").select("comanda_id, quantidade, preco_unitario").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n;if(s)throw s;const i={};for(const l of o||[]){const c=l.comanda_id,d=Number(l.quantidade||0)*Number(l.preco_unitario||0);i[c]=(i[c]||0)+d}return i}async function Hm(e){const t="[listMesas]",r=e||aa(),n=async()=>{const o=new Promise((c,d)=>setTimeout(()=>d(new Error("listMesas timeout aps 30s")),3e4));let s=fe.from("mesas").select("id, numero, nome, status").order("numero",{ascending:!0}).limit(200);r&&(s=s.eq("codigo_empresa",r));const{data:i,error:l}=await Promise.race([s,o]);if(l)throw l;return i||[]};try{try{return await n()}catch(o){if(String(o?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw o}}catch(o){return console.error(`${t}  EXCEPTION:`,o?.message||o),[]}}async function UGe({comandaId:e,status:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");let n=fe.from("pagamentos").select("*").eq("comanda_id",e);t&&(n=n.eq("status",t)),n=n.order("created_at",{ascending:!0});const{data:o,error:s}=await n;if(s)throw s;return o||[]}async function nj({comandaId:e,linhas:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const n=r||aa();if(Array.isArray(t)){await fe.from("pagamentos").delete().eq("comanda_id",e).eq("status","Pendente");for(const o of t){const s=Number(o?.valor||0);if(s<=0)continue;const i=o?.metodo||o?.metodoNome||"outros";await BM({comandaId:e,finalizadoraId:o?.finalizadoraId||o?.methodId||null,metodo:i,valor:s,status:"Pendente",codigoEmpresa:n,clienteId:o?.clienteId||o?.clientId||null})}}}async function VGe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||aa();let n=fe.from("pagamentos").update({status:"Pago",recebido_em:new Date().toISOString()}).eq("comanda_id",e).eq("status","Pendente");r&&(n=n.eq("codigo_empresa",r));const{error:o}=await n;if(o)throw o;return!0}async function WGe({numero:e,nome:t,codigoEmpresa:r}={}){const n=r||aa();let o=e;if(!o){let i=fe.from("mesas").select("numero").order("numero",{ascending:!1}).limit(1);n&&(i=i.eq("codigo_empresa",n));const{data:l,error:c}=await i;if(c)throw c;o=(l?.[0]?.numero||0)+1}const s={numero:o,status:"available"};t&&typeof t=="string"&&t.trim()&&(s.nome=t.trim()),n&&(s.codigo_empresa=n);try{const{data:i,error:l}=await fe.from("mesas").insert(s).select("*").single();if(l)throw l;return i}catch(i){const l=String(i?.message||i||"");if(/column\s+\"?nome\"?\s+of\s+relation/i.test(l)||/column\s+\"?nome\"?\s+does not exist/i.test(l)){const c={numero:o,status:"available"};n&&(c.codigo_empresa=n);const{data:d,error:u}=await fe.from("mesas").insert(c).select("*").single();if(u)throw u;return d}throw i}}async function _f({saldoInicial:e=0,codigoEmpresa:t}={}){const r=t||aa();let n=fe.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n;if(s)throw s;if(o&&o.length>0){const d=o[0];try{const u=new Date(d.aberto_em),f=new Date;if(u.toDateString()!==f.toDateString()){try{const b=await yc({codigoEmpresa:r});if(Array.isArray(b)&&b.length>0)return console.warn("[ensureCaixaAberto] Sesso de dia anterior detectada, mas h comandas abertas. No fechar automaticamente."),d}catch{}const m=f.toISOString();let v=0,g=0;try{const b=await hd({from:d.aberto_em,to:m,codigoEmpresa:r});v=Number(b?.totalEntradas||0)}catch{}try{let b=fe.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",d.id);r&&(b=b.eq("codigo_empresa",r));const{data:w}=await b;for(const j of w||[]){const _=Number(j?.valor||0),C=String(j?.tipo||"").toLowerCase();C==="suprimento"||C==="ajuste"?g+=_:(C==="sangria"||C==="troco")&&(g-=_)}}catch{}const y=Number(d?.saldo_inicial||0)+v+g;let x=fe.from("caixa_sessoes").update({status:"closed",saldo_final:y,fechado_em:m}).eq("id",d.id).eq("status","open");r&&(x=x.eq("codigo_empresa",r)),await x;try{const b=await iS({caixaSessaoId:d.id,codigoEmpresa:r}).catch(async()=>await hd({from:d.aberto_em,to:m,codigoEmpresa:r})),w={codigo_empresa:r||aa(),caixa_sessao_id:d.id,periodo_de:b?.from||d.aberto_em,periodo_ate:b?.to||m,total_bruto:Number(b?.totalVendasBrutas||0),total_descontos:Number(b?.totalDescontos||0),total_liquido:Number(b?.totalVendasLiquidas||0),total_entradas:Number(b?.totalEntradas||0),por_finalizadora:b?.totalPorFinalizadora||{}},j=w.por_finalizadora;await fe.from("caixa_resumos").insert({...w,por_finalizadora:j&&typeof j!="string"?JSON.stringify(j):j})}catch{}}else{try{if(d?.saldo_inicial==null&&e!=null){let m=fe.from("caixa_sessoes").update({saldo_inicial:Number(e)||0}).eq("id",d.id);return r&&(m=m.eq("codigo_empresa",r)),await m,{...d,saldo_inicial:Number(e)||0}}}catch{}return d}}catch{}return d}const i={status:"open",saldo_inicial:e};r&&(i.codigo_empresa=r);const{data:l,error:c}=await fe.from("caixa_sessoes").insert(i).select("id,status,aberto_em").single();if(c)throw c;return l}async function Gm({codigoEmpresa:e}={}){const t=e||aa();let r=fe.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:o}=await r;if(o)throw o;return n?.[0]||null}async function Are({saldoFinal:e=null,valorFinalDinheiro:t=null,codigoEmpresa:r}={}){console.log("[fecharCaixa] Iniciando fechamento:",{valorFinalDinheiro:t,saldoFinal:e,codigoEmpresa:r});const n=r||aa();try{console.log("[fecharCaixa]  Limpeza preventiva: ajustando apenas comandas cancelled/closed sem fechado_em...");const{data:x}=await fe.from("comandas").select("id, status, fechado_em").eq("codigo_empresa",n).is("fechado_em",null).in("status",["cancelled","closed"]);if(x&&x.length>0){console.log(`[fecharCaixa]  Encontradas ${x.length} comandas (cancelled/closed) sem fechado_em, ajustando...`);const b=new Date().toISOString();for(const w of x)try{await fe.from("comandas").update({fechado_em:b}).eq("id",w.id).eq("codigo_empresa",n),console.log(`[fecharCaixa]  Comanda ${w.id} (status: ${w.status}) ajustada com fechado_em`)}catch{}}else console.log("[fecharCaixa]  Nenhuma comanda cancelled/closed sem fechado_em encontrada")}catch(x){console.warn("[fecharCaixa]  Erro na limpeza preventiva:",x?.message)}try{let x=await yc({codigoEmpresa:n});if(x=x||[],console.log(`[fecharCaixa]  Comandas abertas encontradas: ${x.length}`,x.map(w=>({id:w.id,status:w.status,mesa:w.mesa_id}))),x&&x.length>0){const w=x.map(j=>`${j.id}${j.mesa_id?`@mesa:${j.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${x.length} comanda(s) aberta(s). Feche todas as comandas antes de encerrar o caixa.`)}let b=0;for(;b<12&&(x=await yc({codigoEmpresa:n}),!(!x||x.length===0));)await new Promise(w=>setTimeout(w,250)),b++;if(x&&x.length>0){const w=x.map(E=>E.id);let j=new Map,_=new Map;try{if(w.length>0){let E=fe.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",w);n&&(E=E.eq("codigo_empresa",n));const{data:A}=await E;j=new Map;for(const P of A||[]){const F=P.comanda_id,M=Number(P.quantidade||0);j.set(F,(j.get(F)||0)+M)}}}catch{}try{if(w.length>0){let E=fe.from("pagamentos").select("comanda_id, status").in("comanda_id",w);n&&(E=E.eq("codigo_empresa",n));const{data:A}=await E;_=new Map;for(const P of A||[]){const F=String(P?.status||"Pago");if(F==="Cancelado"||F==="Estornado")continue;const M=P.comanda_id;_.set(M,(_.get(M)||0)+1)}}}catch{}for(const E of x){const A=Number(j.get(E.id)||0)>0,P=Number(_.get(E.id)||0)>0;if(!A&&!P)try{await Xx({comandaId:E.id,codigoEmpresa:n})}catch{}}let C=await yc({codigoEmpresa:n});if(C=C||[],C.length>0){const E=C.map(M=>M.id);let A=new Map,P=new Map;try{if(E.length>0){let M=fe.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",E);n&&(M=M.eq("codigo_empresa",n));const{data:I}=await M;A=new Map;for(const R of I||[]){const D=R.comanda_id,U=Number(R.quantidade||0);A.set(D,(A.get(D)||0)+U)}}}catch{}try{if(E.length>0){let M=fe.from("pagamentos").select("comanda_id, status").in("comanda_id",E);n&&(M=M.eq("codigo_empresa",n));const{data:I}=await M;P=new Map;for(const R of I||[]){const D=String(R?.status||"Pago");if(D==="Cancelado"||D==="Estornado")continue;const U=R.comanda_id;P.set(U,(P.get(U)||0)+1)}}}catch{}const F=C.filter(M=>Number(A.get(M.id)||0)>0||Number(P.get(M.id)||0)>0);if(F.length>0){const M=F.map(I=>`${I.id}${I.mesa_id?`@mesa:${I.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${F.length} comandas abertas. IDs: ${M}. Feche todas antes de encerrar o caixa.`)}}}}catch(x){if(x&&/Existem \d+ comandas/.test(x.message||""))throw x;const b=new Error("Falha ao validar comandas abertas. Tente novamente e verifique sua conexo.");throw b.code="CASH_CLOSE_VALIDATION_FAILED",b}let o=fe.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);n&&(o=o.eq("codigo_empresa",n));const{data:s,error:i}=await o;if(i)throw i;const l=s?.[0]?.id||null,c=s?.[0]?.aberto_em||null,d=Number(s?.[0]?.saldo_inicial||0);if(!l)throw new Error("Nenhuma sesso de caixa aberta encontrada.");const u=new Date().toISOString();let f=0,h=0;try{const x=await hd({from:c,to:u,codigoEmpresa:n});f=Number(x?.totalEntradas||0)}catch{}try{let x=fe.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",l);n&&(x=x.eq("codigo_empresa",n));const{data:b}=await x;for(const w of b||[]){const j=Number(w?.valor||0),_=String(w?.tipo||"").toLowerCase();_==="suprimento"||_==="ajuste"?h+=j:(_==="sangria"||_==="troco")&&(h-=j)}}catch{}const m=e!=null?Number(e):d+f+h;try{let x=await yc({codigoEmpresa:n});if(x=x||[],x.length>0){const b=x.map(C=>C.id);let w=new Map,j=new Map;try{if(b.length>0){let C=fe.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",b);n&&(C=C.eq("codigo_empresa",n));const{data:E}=await C;w=new Map;for(const A of E||[]){const P=A.comanda_id,F=Number(A.quantidade||0);w.set(P,(w.get(P)||0)+F)}}}catch{}try{if(b.length>0){let C=fe.from("pagamentos").select("comanda_id, status").in("comanda_id",b);n&&(C=C.eq("codigo_empresa",n));const{data:E}=await C;j=new Map;for(const A of E||[]){const P=String(A?.status||"Pago");if(P==="Cancelado"||P==="Estornado")continue;const F=A.comanda_id;j.set(F,(j.get(F)||0)+1)}}}catch{}for(const C of x){const E=Number(w.get(C.id)||0)>0,A=Number(j.get(C.id)||0)>0;if(!E&&!A)try{await Xx({comandaId:C.id,codigoEmpresa:n})}catch{}}let _=await yc({codigoEmpresa:n});if(_=_||[],_.length>0){const C=_.map(E=>`${E.id}${E.mesa_id?`@mesa:${E.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${_.length} comandas abertas. IDs: ${C}. Feche todas antes de encerrar o caixa.`)}}}catch(x){if(!(x&&x.message)){const b=new Error("Falha ao validar comandas abertas no momento do fechamento. Tente novamente.");throw b.code="CASH_CLOSE_FINAL_CHECK_FAILED",b}throw x}let v=fe.from("caixa_sessoes").update({status:"closed",saldo_final:m,fechado_em:u}).eq("id",l).eq("status","open");n&&(v=v.eq("codigo_empresa",n));const{data:g,error:y}=await v.select("id,status,fechado_em,saldo_final").single();if(y){const x=String(y.message||"");if(x.toLowerCase().includes("row")||x.toLowerCase().includes("single")){let b=fe.from("caixa_sessoes").select("id,status,fechado_em,saldo_final").eq("id",l).limit(1);n&&(b=b.eq("codigo_empresa",n));const{data:w}=await b;if(w&&w[0])return w[0]}throw y}try{if(c&&u&&g?.status==="closed"){let x;try{x=await iS({caixaSessaoId:l,codigoEmpresa:n})}catch{x=await hd({from:c,to:u,codigoEmpresa:n})}const b={codigo_empresa:n||aa(),caixa_sessao_id:l,periodo_de:x?.from||c,periodo_ate:x?.to||u,total_bruto:Number(x?.totalVendasBrutas||0),total_descontos:Number(x?.totalDescontos||0),total_liquido:Number(x?.totalVendasLiquidas||0),total_entradas:Number(x?.totalEntradas||0),por_finalizadora:x?.totalPorFinalizadora||{}},w=t!=null?Number(t):null,j=w!=null?w-Number(m||0):null;console.log("[fecharCaixa] Valores para snapshot:",{contado:w,diferenca:j,efetivoSaldoFinal:m,valorFinalDinheiroOriginal:t});const C=await(async E=>{const A={...E},P=A.por_finalizadora;P&&typeof P!="string"&&(A.por_finalizadora=JSON.stringify(P));let F=!0,M=!0;try{const H=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),q=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");H==="no"&&(F=!1),q==="no"&&(M=!1)}catch{}if(!F||!M)try{let H=fe.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:q}=await H;if(!q){F=!0,M=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}if(!F&&!M)return await fe.from("caixa_resumos").insert(A);let I={...A};F&&w!=null&&(I.valor_final_dinheiro=w),M&&j!=null&&(I.diferenca_dinheiro=j),console.log("[fecharCaixa] Tentando inserir snapshot com:",{supportValor:F,supportDif:M,contado:w,diferenca:j,hasValorFinalDinheiro:"valor_final_dinheiro"in I});const R=await fe.from("caixa_resumos").insert(I);if(!R.error)return R;const D=`${R.error?.message||""} ${R.error?.details||""}`.toLowerCase(),U=R.error?.code;if(U==="42703"||U==="PGRST204"||D.includes("column")||D.includes("schema cache")){try{I.valor_final_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),I.diferenca_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}return await fe.from("caixa_resumos").insert(A)}return R})(b);if(C.error)throw console.error("[fecharCaixa] Erro ao inserir snapshot:",C.error),C.error;console.log("[fecharCaixa]  Snapshot inserido com sucesso");try{const{data:E}=await fe.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").eq("caixa_sessao_id",l).order("criado_em",{ascending:!1}).limit(1).single();console.log("[fecharCaixa] Verificao ps-insert:",E)}catch(E){console.warn("[fecharCaixa] Falha ao verificar snapshot:",E?.message)}}}catch(x){console.warn("[fecharCaixa] Falha ao gravar snapshot de fechamento:",x)}try{let x=fe.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open");n&&(x=x.eq("codigo_empresa",n));const{data:b}=await x;if(Array.isArray(b)&&b.length>0)for(const w of b)try{const j=w?.aberto_em,_=Number(w?.saldo_inicial||0),C=new Date().toISOString();let E=0,A=0;try{const F=await hd({from:j,to:C,codigoEmpresa:n});E=Number(F?.totalEntradas||0)}catch{}try{let F=fe.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",w.id);n&&(F=F.eq("codigo_empresa",n));const{data:M}=await F;for(const I of M||[]){const R=Number(I?.valor||0),D=String(I?.tipo||"").toLowerCase();D==="suprimento"||D==="ajuste"?A+=R:(D==="sangria"||D==="troco")&&(A-=R)}}catch{}const P=_+E+A;await fe.from("caixa_sessoes").update({status:"closed",saldo_final:P,fechado_em:C}).eq("id",w.id).eq("status","open").eq(n?"codigo_empresa":"id",n||w.id);try{const F=await iS({caixaSessaoId:w.id,codigoEmpresa:n}).catch(async()=>await hd({from:j,to:C,codigoEmpresa:n})),M={codigo_empresa:n||aa(),caixa_sessao_id:w.id,periodo_de:F?.from||j,periodo_ate:F?.to||C,total_bruto:Number(F?.totalVendasBrutas||0),total_descontos:Number(F?.totalDescontos||0),total_liquido:Number(F?.totalVendasLiquidas||0),total_entradas:Number(F?.totalEntradas||0),por_finalizadora:F?.totalPorFinalizadora||{}},I=M.por_finalizadora;await fe.from("caixa_resumos").insert({...M,por_finalizadora:I&&typeof I!="string"?JSON.stringify(I):I})}catch{}}catch(j){try{console.warn("[fecharCaixa] Saneamento: falhou ao fechar sesso remanescente",w?.id,j?.message||j)}catch{}}}catch{}return g}async function Ere({from:e,to:t,limit:r=50,codigoEmpresa:n}={}){console.log("[listarFechamentosCaixa] Iniciando busca de fechamentos",{from:e,to:t,limit:r});const o=n||aa();let s=fe.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final, status").eq("status","closed").order("fechado_em",{ascending:!1}).limit(r);o&&(s=s.eq("codigo_empresa",o)),e&&(s=s.gte("fechado_em",`${e}T00:00:00`)),t&&(s=s.lte("fechado_em",`${t}T23:59:59`));const{data:i,error:l}=await s;if(l)throw l;const c=Array.isArray(i)?i:[];if(console.log("[listarFechamentosCaixa] Sesses fechadas encontradas:",c.length),c.length===0)return[];const d=c.map(m=>m.id);let u=[];try{let m=!0,v=!0;try{const j=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),_=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");j==="no"&&(m=!1),_==="no"&&(v=!1)}catch{}if(!m||!v)try{let j=fe.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:_}=await j;if(!_){m=!0,v=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const g=["caixa_sessao_id"];m&&g.push("valor_final_dinheiro"),v&&g.push("diferenca_dinheiro");const y=g.join(", ");let x=fe.from("caixa_resumos").select(y).in("caixa_sessao_id",d).order("criado_em",{ascending:!1});o&&(x=x.eq("codigo_empresa",o));let{data:b,error:w}=await x;if(w){const j=w?.code,_=`${w?.message||""} ${w?.details||""}`.toLowerCase();if(j==="42703"||j==="PGRST204"||_.includes("column")||_.includes("schema cache")){try{m&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),v&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let E=fe.from("caixa_resumos").select("caixa_sessao_id").in("caixa_sessao_id",d).order("criado_em",{ascending:!1});o&&(E=E.eq("codigo_empresa",o));const{data:A}=await E;u=A||[]}else throw w}else u=b||[]}catch(m){console.warn("[listarFechamentosCaixa] Erro ao buscar snapshots:",m?.message),u=[]}console.log("[listarFechamentosCaixa] Snapshots encontrados:",u.length,u);const f=new Map(u.map(m=>[m.caixa_sessao_id,m])),h=c.map(m=>{const v=f.get(m.id),g={...m,valor_final_dinheiro:v?.valor_final_dinheiro??null,diferenca_dinheiro:v?.diferenca_dinheiro??null};return v&&console.log(`[listarFechamentosCaixa] Sesso ${m.id} enriquecida com snapshot:`,{valor_final_dinheiro:v.valor_final_dinheiro,diferenca_dinheiro:v.diferenca_dinheiro}),g});return console.log("[listarFechamentosCaixa] Resultado final:",h.length,"sesses com dados enriquecidos"),h}async function cS({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||aa();let n=null;try{let o=!0,s=!0;try{const f=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),h=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");f==="no"&&(o=!1),h==="no"&&(s=!1)}catch{}if(!o||!s)try{let f=fe.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:h}=await f;if(!h){o=!0,s=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const i=["caixa_sessao_id","periodo_de","periodo_ate","total_bruto","total_descontos","total_liquido","total_entradas","por_finalizadora"];o&&i.push("valor_final_dinheiro"),s&&i.push("diferenca_dinheiro");const l=i.join(", ");let c=fe.from("caixa_resumos").select(l).eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(c=c.eq("codigo_empresa",r));let{data:d,error:u}=await c;if(u){const f=u?.code,h=`${u?.message||""} ${u?.details||""}`.toLowerCase();if(f==="42703"||f==="PGRST204"||h.includes("column")||h.includes("schema cache")){try{o&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),s&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let v=fe.from("caixa_resumos").select("caixa_sessao_id, periodo_de, periodo_ate, total_bruto, total_descontos, total_liquido, total_entradas, por_finalizadora").eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(v=v.eq("codigo_empresa",r));const{data:g}=await v;n=g?.[0]||null}else throw u}else n=d?.[0]||null}catch(o){try{console.warn("[getCaixaResumo] Snapshot select falhou, usando fallback dinmico:",o?.message||o)}catch{}}if(!n||typeof n.saldo_inicial>"u"||typeof n.saldo_final>"u"){const o=await iS({caixaSessaoId:e,codigoEmpresa:r});let s=null;try{let i=fe.from("caixa_sessoes").select("saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(i=i.eq("codigo_empresa",r));const{data:l}=await i;s=l?.[0]||null}catch{}n={codigo_empresa:r,caixa_sessao_id:e,periodo_de:o?.from||null,periodo_ate:o?.to||null,total_bruto:Number(o?.totalVendasBrutas||0),total_descontos:Number(o?.totalDescontos||0),total_liquido:Number(o?.totalVendasLiquidas||0),total_entradas:Number(o?.totalEntradas||0),por_finalizadora:o?.totalPorFinalizadora||{},saldo_inicial:Number(s?.saldo_inicial??o?.saldoInicial??0),saldo_final:s?.saldo_final!=null?Number(s.saldo_final):null,movimentos:o?.movimentos||{suprimentos:0,sangrias:0,ajustes:0,troco:0,totalMovimentos:0}}}else if(typeof n.por_finalizadora=="string")try{n.por_finalizadora=JSON.parse(n.por_finalizadora)}catch{n.por_finalizadora={}}return n}async function jT({tipo:e,valor:t,observacao:r="",caixaSessaoId:n,codigoEmpresa:o}={}){const s=o||aa();if(!e||!["sangria","suprimento","troco","ajuste"].includes(e))throw new Error("Tipo invlido de movimentao");let i=n;if(!i){let u=fe.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);s&&(u=u.eq("codigo_empresa",s));const{data:f,error:h}=await u;if(h)throw h;i=f?.[0]?.id||null}if(!i)throw new Error("Sesso de caixa no encontrada para registrar movimentao");const l={codigo_empresa:s,caixa_sessao_id:i,tipo:e,valor:Math.max(0,Number(t)||0),observacao:(r||"").trim()||null},{data:c,error:d}=await fe.from("caixa_movimentacoes").insert(l).select("*").single();if(d)throw d;return c}async function qp({caixaSessaoId:e,codigoEmpresa:t}={}){const r=t||aa();if(!e)throw new Error("caixaSessaoId  obrigatrio");let n=fe.from("caixa_movimentacoes").select("*").eq("caixa_sessao_id",e).order("criado_em",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n;if(s)throw s;return o||[]}async function HGe({mesaId:e,codigoEmpresa:t}={}){const r=t||aa();await $M({codigoEmpresa:r}),console.log(`[abrirComandaParaMesa] Iniciando para mesaId: ${e}, codigo_empresa: ${r}`);try{const n={status:"open",aberto_em:new Date().toISOString()};e&&(n.mesa_id=e),console.log("[abrirComandaParaMesa] Payload (codigo_empresa via DEFAULT):",n);const{data:o,error:s}=await fe.from("comandas").insert(n).select("*").single();if(s)throw console.error("[abrirComandaParaMesa] ERRO ao criar comanda:",s),s;return console.log("[abrirComandaParaMesa]  Comanda criada:",o),await new Promise(i=>setTimeout(i,100)),o}catch(n){throw console.error("[abrirComandaParaMesa] ERRO:",n),n}}async function GGe({mesaId:e,codigoEmpresa:t}){const r=t||aa();let n=fe.from("comandas").select("id,status,aberto_em,fechado_em").eq("mesa_id",e).is("fechado_em",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n;if(s)throw s;return o?.[0]||null}async function ds({comandaId:e,codigoEmpresa:t}){const r=t||aa();let n=fe.from("comanda_itens").select("*").eq("comanda_id",e).order("created_at",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n;if(s)throw s;return o||[]}async function Mm({codigoEmpresa:e}){const t=e||aa();let r=fe.from("comandas").select("id").is("fechado_em",null);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:o}=await r;if(o)throw o;if(console.log("[listarItensDeTodasComandasAbertas] Comandas abertas:",n?.length||0,"IDs:",n?.map(d=>d.id)),!n||n.length===0)return console.log("[listarItensDeTodasComandasAbertas] Nenhuma comanda aberta encontrada"),[];const s=n.map(d=>d.id);let i=fe.from("comanda_itens").select("produto_id, quantidade").in("comanda_id",s);t&&(i=i.eq("codigo_empresa",t));const{data:l,error:c}=await i;if(c)throw c;return console.log("[listarItensDeTodasComandasAbertas] Itens encontrados:",l?.length||0),l&&l.length>0&&console.log("[listarItensDeTodasComandasAbertas] Detalhes dos itens:",l),l||[]}const aj=new Map;async function KGe({mesaId:e,codigoEmpresa:t}={}){const r=`${e}:${t||aa()}`;if(aj.has(r))return console.log(`[getOrCreateComandaForMesa]  Operao j em andamento para mesa ${e}, aguardando...`),aj.get(r);const n=t||aa(),o=(async()=>{try{await $M({codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Criando nova comanda para mesa ${e}`);const s=await GGe({mesaId:e,codigoEmpresa:n});if(s){console.log(`[getOrCreateComandaForMesa]  Comanda existente ${s.id} encontrada, verificando se est vazia...`);let l=!1,c=!1;try{l=(await ds({comandaId:s.id,codigoEmpresa:n})||[]).length>0}catch{}try{const{data:d}=await fe.from("pagamentos").select("id, status").eq("comanda_id",s.id).eq("codigo_empresa",n);c=(d||[]).filter(f=>{const h=String(f?.status||"Pago");return h!=="Cancelado"&&h!=="Estornado"}).length>0}catch{}if(!l&&!c){console.log(`[getOrCreateComandaForMesa]  Comanda ${s.id} est vazia, fechando automaticamente...`);try{await Xx({comandaId:s.id,codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Comanda ${s.id} fechada com sucesso`)}catch(d){console.warn(`[getOrCreateComandaForMesa]  Erro ao fechar comanda ${s.id}:`,d?.message)}}else console.log(`[getOrCreateComandaForMesa]  Comanda ${s.id} tem dados (itens: ${l}, pagamentos: ${c}), no ser fechada automaticamente`)}console.log(`[getOrCreateComandaForMesa]  Criando comanda zerada para mesa ${e}`);const i=await HGe({mesaId:e,codigoEmpresa:n});return console.log(`[getOrCreateComandaForMesa]  Comanda ${i.id} criada com sucesso`),i}finally{aj.delete(r),console.log(`[getOrCreateComandaForMesa]  Lock liberado para mesa ${e}`)}})();return aj.set(r,o),o}async function lb({comandaId:e,clienteIds:t=[],nomesLivres:r=[],codigoEmpresa:n,replace:o=!1}={}){const s=n||aa();if(!e)throw new Error("comandaId  obrigatrio");let i=[],l=[];try{i=Array.isArray(t)?t:t?[t]:[]}catch(m){console.warn("[adicionarClientesAComanda] Erro ao processar clienteIds:",m),i=[]}try{l=Array.isArray(r)?r:r?[r]:[]}catch(m){console.warn("[adicionarClientesAComanda] Erro ao processar nomesLivres:",m),l=[]}const c=i.map(m=>m&&typeof m=="object"?m.id||m.cliente_id||m.value:m).filter(Boolean),d=l.map(m=>m&&typeof m=="object"?m.nome||m.name||m.label:m).map(m=>String(m||"").trim()).filter(Boolean);if(console.log(`[adicionarClientesAComanda] Adicionando clientes  comanda ${e}:`,{clienteIds:c,nomesLivres:d,codigo:s,replace:o}),o){const{error:m}=await fe.from("comanda_clientes").delete().eq("comanda_id",e);m&&console.warn("[adicionarClientesAComanda] Erro ao limpar clientes existentes:",m)}const u=[];if(Array.isArray(c)){let m=[];if(!o)try{const{data:g}=await fe.from("comanda_clientes").select("cliente_id, nome_livre").eq("comanda_id",e);m=Array.isArray(g)?g:[]}catch{}const v=new Set((m||[]).map(g=>g.cliente_id).filter(Boolean));for(let g=0;g<c.length;g++){const y=c[g];y&&(!o&&v.has(y)||u.push({comanda_id:e,cliente_id:y}))}}if(Array.isArray(d))for(let m=0;m<d.length;m++){const g=(d[m]||"").trim();g&&u.push({comanda_id:e,nome_livre:g})}if(u.length===0)return console.log("[adicionarClientesAComanda] Nenhum cliente para adicionar"),!0;let f=[];Array.isArray(u)&&(f=u.map(m=>s?{...m,codigo_empresa:s}:m)),console.log("[adicionarClientesAComanda] Payload para insero:",f);const{error:h}=await fe.from("comanda_clientes").insert(f);if(h)throw console.error("[adicionarClientesAComanda] ERRO ao inserir clientes:",h),h;return console.log("[adicionarClientesAComanda] Clientes adicionados com sucesso"),!0}async function ni({comandaId:e,codigoEmpresa:t}={}){if(t||aa(),!e)throw new Error("comandaId  obrigatrio");try{const{data:r,error:n}=await fe.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!comanda_clientes_cliente_id_fkey(id, codigo, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(n)throw n;return(r||[]).map(o=>({id:o.id,tipo:o.cliente_id?"cadastrado":"livre",nome:o.clientes?.nome||o.nome_livre,cliente_id:o.cliente_id}))}catch{try{const{data:n,error:o}=await fe.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!fk_comanda_clientes_cliente(id, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(o)throw o;return(n||[]).map(s=>({id:s.id,tipo:s.cliente_id?"cadastrado":"livre",nome:s.clientes?.nome||s.nome_livre,cliente_id:s.cliente_id}))}catch{const{data:o,error:s}=await fe.from("comanda_clientes").select("id, cliente_id, nome_livre").eq("comanda_id",e).order("created_at",{ascending:!0});if(s)throw s;return(o||[]).map(i=>({id:i.id,tipo:i.cliente_id?"cadastrado":"livre",nome:i.nome_livre||"",cliente_id:i.cliente_id}))}}}async function _T({comandaId:e,produtoId:t,descricao:r,quantidade:n,precoUnitario:o,desconto:s=0,codigoEmpresa:i}){const l=i||aa();console.log(`[adicionarItem] Adicionando item  comanda ${e}:`,{produtoId:t,descricao:r,quantidade:n,precoUnitario:o,codigo:l});try{let f=fe.from("produtos").select("id, estoque, estoque_minimo, nome").eq("id",t).limit(1);l&&(f=f.eq("codigo_empresa",l));const{data:h,error:m}=await f;if(m)throw m;const v=Array.isArray(h)?h[0]:h;if(v){const g=Number(v.estoque??0),y=Number(v.estoque_minimo??0),x=Number(n??1);if(g<=0){const E=new Error(`Produto sem estoque: ${v.nome||""}`.trim());throw E.code="OUT_OF_STOCK",E}let b=fe.from("comanda_itens").select("quantidade").eq("comanda_id",e).eq("produto_id",t);l&&(b=b.eq("codigo_empresa",l));const{data:w,error:j}=await b;if(j)throw j;const _=Array.isArray(w)&&w.length?w.reduce((E,A)=>E+Number(A?.quantidade||0),0):0;if(_+x>g){const E=new Error(`Estoque insuficiente. Em comanda: ${_}, solicitado: +${x}, disponvel: ${g}`);throw E.code="INSUFFICIENT_STOCK",E}if(g<=y&&g>0)try{console.warn(`[adicionarItem] Aviso: estoque baixo para produto '${v.nome}' (estoque=${g}, minimo=${y})`)}catch{}}}catch(f){throw f}const c={comanda_id:e,produto_id:t,descricao:r,quantidade:n,preco_unitario:o,desconto:s};l&&(c.codigo_empresa=l);const{data:d,error:u}=await fe.from("comanda_itens").insert(c).select("*").single();if(u)throw u;return d}async function ed({itemId:e,quantidade:t,codigoEmpresa:r}){const n=r||aa();let o=fe.from("comanda_itens").select("id, quantidade, produto_id, comanda_id").eq("id",e).limit(1);n&&(o=o.eq("codigo_empresa",n));const{data:s,error:i}=await o;if(i)throw i;const l=Array.isArray(s)?s[0]:s,c=Number(t||0);if(!l)throw new Error("Item no encontrado");const d=Number(l.quantidade||0);if(c-d>0){let v=fe.from("produtos").select("id, estoque, nome, estoque_minimo").eq("id",l.produto_id).limit(1);n&&(v=v.eq("codigo_empresa",n));const{data:g,error:y}=await v;if(y)throw y;const x=Array.isArray(g)?g[0]:g;if(x){const b=Number(x.estoque??0);let w=fe.from("comanda_itens").select("quantidade").eq("comanda_id",l.comanda_id).eq("produto_id",l.produto_id).neq("id",l.id);n&&(w=w.eq("codigo_empresa",n));const{data:j,error:_}=await w;if(_)throw _;const C=Array.isArray(j)&&j.length?j.reduce((F,M)=>F+Number(M?.quantidade||0),0):0;if(C+c>b){const F=new Error(`Estoque insuficiente. Em comanda (outros itens): ${C}, novo para este item: ${c}, disponvel: ${b}`);throw F.code="INSUFFICIENT_STOCK",F}const A=Number(x.estoque_minimo??0),P=b-(C+c);if(P<=A&&P>=0)try{console.warn(`[atualizarQuantidadeItem] Aviso: produto '${x.nome}' atingiu nvel de estoque baixo (restante=${P}, minimo=${A})`)}catch{}}}let f=fe.from("comanda_itens").update({quantidade:c}).eq("id",e);n&&(f=f.eq("codigo_empresa",n));const{data:h,error:m}=await f.select("*").single();if(m)throw m;return h}async function Bv({itemId:e,codigoEmpresa:t}){const r=t||aa();let n=fe.from("comanda_itens").delete().eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n.select("id");if(s&&s.code!=="PGRST116")throw s;return Array.isArray(o)&&o.length>0}function XGe(e){if(!e)return!1;const t=e.code?String(e.code):"",r=[e.message,e.details,e.hint].filter(Boolean).join(" ").toLowerCase();return t==="22P02"||r.includes("invalid input value for enum")}async function BM({comandaId:e,finalizadoraId:t,metodo:r,valor:n,status:o="Pago",codigoEmpresa:s,clienteId:i=null}){const l=s||aa();if(!l)throw new Error("Empresa no identificada (codigo_empresa ausente).");const c=o&&["Pendente","Pago","Estornado","Cancelado"].includes(o)?o:"Pago",d=["dinheiro","credito","debito","pix","voucher","outros"],f=(m=>{if(!m)return"outros";const v=String(m).toLowerCase().trim(),y={"cartao credito":"credito","carto credito":"credito","cartao debito":"debito","carto debito":"debito","carto de credito":"credito","carto de dbito":"debito","cartao de credito":"credito","cartao de debito":"debito"}[v]||v;return d.includes(y)?y:"outros"})(r),h={comanda_id:e,finalizadora_id:t||null,metodo:f,valor:Math.max(0,Number(n)||0),status:c,recebido_em:new Date().toISOString(),codigo_empresa:l};i&&(h.cliente_id=i),console.log("[registrarPagamento] Iniciando registro de pagamento:",{comandaId:e,finalizadoraId:t,metodo:f,valor:h.valor,status:h.status,codigoEmpresa:l,payload:h});try{const{data:m,error:v}=await fe.from("pagamentos").insert(h).select().single();if(v){console.warn("[registrarPagamento] Primeira tentativa falhou:",{code:v.code,message:v.message});const g=`${v?.message||""} ${v?.details||""}`.toLowerCase();if(v?.code==="42703"||g.includes("column")&&g.includes("cliente_id")){const{cliente_id:x,...b}=h;try{localStorage.setItem("schema:pagamentos:cliente_id","no")}catch{}const{data:w,error:j}=await fe.from("pagamentos").insert(b).select().single();if(j)throw j;return console.log("[registrarPagamento] Pagamento registrado sem cliente_id:",w),w}if(XGe(v)){console.log("[registrarPagamento] Tentando abordagem alternativa sem status...");try{const x={...h};delete x.status;const{data:b,error:w}=await fe.from("pagamentos").insert(x).select().single();if(w)throw w;return console.log("[registrarPagamento] Pagamento registrado com sucesso (abordagem alternativa):",b),b}catch(x){throw console.error("[registrarPagamento] Falha na abordagem alternativa:",x),new Error(`Falha ao processar pagamento: ${x.message}`)}}throw v}return console.log("[registrarPagamento] Pagamento registrado com sucesso:",m),m}catch(m){throw console.error("[registrarPagamento] Erro ao registrar pagamento:",{error:{message:m.message,code:m.code,details:m.details,hint:m.hint},comandaId:e,finalizadoraId:t,valor:h.valor,status:h.status,codigoEmpresa:l}),m}}async function Xx({comandaId:e,codigoEmpresa:t,diferencaPagamento:r}){const n=t||aa(),o="[fecharComandaEMesa]";try{console.group(o)}catch{}try{console.time?.(o)}catch{}try{console.log(`${o} Iniciando fechamento da comanda ${e}`),console.log(`${o} Obtendo dados da comanda...`);const{data:s,error:i}=await fe.from("comandas").select("id, mesa_id, status, fechado_em").eq("id",e).single();if(i||!s)throw console.error(`${o} Erro ao buscar comanda:`,i?.message||"Comanda no encontrada"),i||new Error("Comanda no encontrada");if(s.fechado_em)return console.log(`${o} Comanda ${e} j est fechada em ${s.fechado_em}`),!0;const l=new Date().toISOString();console.log(`${o} Atualizando comanda...`);const c={status:"closed",fechado_em:l};typeof r=="number"&&Number.isFinite(r)&&(c.diferenca_pagamento=r),console.log(`${o} Fechando comanda com status closed + fechado_em${c.diferenca_pagamento!=null?" + diferenca_pagamento":""}...`);let{error:d}=await fe.from("comandas").update(c).eq("id",e).eq("codigo_empresa",n);if(d&&d.code==="42703"){console.warn(`${o} Coluna diferenca_pagamento ausente no schema, tentando novamente sem ela...`);const u={status:"closed",fechado_em:l};({error:d}=await fe.from("comandas").update(u).eq("id",e).eq("codigo_empresa",n))}if(d)throw console.error(`${o} Erro ao fechar comanda:`,d),d;if(console.log(`${o} Comanda ${e} fechada com sucesso`),s.mesa_id){console.log(`${o} Atualizando status da mesa ${s.mesa_id} para disponvel...`);try{const{error:u}=await fe.from("mesas").update({status:"available"}).eq("id",s.mesa_id).select("id").single();u?console.error(`${o} Erro ao atualizar status da mesa:`,u):console.log(`${o} Mesa ${s.mesa_id} marcada como disponvel`)}catch(u){console.error(`${o} Exceo ao atualizar mesa:`,u)}}else console.log(`${o} Nenhuma mesa associada para liberar`);return console.log(`${o} Fechamento da comanda ${e} concludo com sucesso`),!0}catch(s){throw console.error(`${o} Erro fatal ao fechar comanda:`,s),s}finally{try{console.timeEnd?.(o)}catch{}try{console.groupEnd()}catch{}}}async function cz({comandaId:e,codigoEmpresa:t}){const r=t||aa(),n="[cancelarComandaEMesa]";try{console.group(n)}catch{}try{console.time?.(n)}catch{}try{if(!e)throw new Error("comandaId obrigatrio");if(!r)throw new Error("codigo_empresa obrigatrio");console.log(`${n} Cancelando comanda ${e}`);const{data:o}=await fe.from("comandas").select("id, mesa_id").eq("id",e).single();try{await fe.from("comanda_itens").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}try{await fe.from("comanda_clientes").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}const s=new Date().toISOString(),{data:i,error:l}=await fe.from("comandas").update({status:"cancelled",fechado_em:s}).eq("id",e).eq("codigo_empresa",r).select();if(l)throw console.error(`${n} Erro ao atualizar comanda:`,l),l;if(!i||i.length===0)throw console.error(`${n}  UPDATE no afetou nenhuma linha! Comanda ${e} no foi encontrada ou RLS bloqueou`),new Error("Comanda no encontrada ou sem permisso para cancelar");if(console.log(`${n}  Comanda atualizada:`,i[0]),o?.mesa_id){console.log(`${n} Liberando mesa ${o.mesa_id}`);try{await fe.from("mesas").update({status:"available"}).eq("id",o.mesa_id)}catch(c){console.error(`${n} Erro ao liberar mesa:`,c)}}return console.log(`${n} Comanda ${e} cancelada com sucesso`),!0}catch(o){throw console.error(`${n} Falha:`,o),o}finally{try{console.timeEnd?.(n)}catch{}try{console.groupEnd?.(n)}catch{}}}async function YGe({itemId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:o}={}){const s=o||aa();if(!e)throw new Error("itemId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let i=fe.from("comanda_itens").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);s&&(i=i.eq("codigo_empresa",s));const{data:l,error:c}=await i.select("*").single();if(c)throw c;return l}async function JGe({comandaId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:o}={}){const s=o||aa();if(!e)throw new Error("comandaId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let i=fe.from("comandas").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);s&&(i=i.eq("codigo_empresa",s));const{data:l,error:c}=await i.select("*").single();if(c)throw c;return l}async function QGe({itemId:e,codigoEmpresa:t}={}){const r=t||aa();if(!e)throw new Error("itemId  obrigatrio");let n=fe.from("comanda_itens").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n.select("*").single();if(s)throw s;return o}async function ZGe({comandaId:e,codigoEmpresa:t}={}){const r=t||aa();if(!e)throw new Error("comandaId  obrigatrio");let n=fe.from("comandas").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:o,error:s}=await n.select("*").single();if(s)throw s;return o}async function eKe({comandaId:e,observacoes:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const{error:n}=await fe.from("comandas").update({observacoes:(t||"").trim()||null,observacoes_atualizadas_em:new Date().toISOString()}).eq("id",e);if(n)throw n;return{id:e}}var E5="Tabs",[tKe,Jlt]=Pd(E5,[S5]),kre=S5(),[rKe,qM]=tKe(E5),Ire=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:o,defaultValue:s,orientation:i="horizontal",dir:l,activationMode:c="automatic",...d}=e,u=b5(l),[f,h]=Vf({prop:n,onChange:o,defaultProp:s??"",caller:E5});return a.jsx(rKe,{scope:r,baseId:nu(),value:f,onValueChange:h,orientation:i,dir:u,activationMode:c,children:a.jsx(oa.div,{dir:u,"data-orientation":i,...d,ref:t})})});Ire.displayName=E5;var Ore="TabsList",Tre=p.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...o}=e,s=qM(Ore,r),i=kre(r);return a.jsx(Ote,{asChild:!0,...i,orientation:s.orientation,dir:s.dir,loop:n,children:a.jsx(oa.div,{role:"tablist","aria-orientation":s.orientation,...o,ref:t})})});Tre.displayName=Ore;var Dre="TabsTrigger",Mre=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:o=!1,...s}=e,i=qM(Dre,r),l=kre(r),c=Fre(i.baseId,n),d=$re(i.baseId,n),u=n===i.value;return a.jsx(Tte,{asChild:!0,...l,focusable:!o,active:u,children:a.jsx(oa.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:c,...s,ref:t,onMouseDown:bn(e.onMouseDown,f=>{!o&&f.button===0&&f.ctrlKey===!1?i.onValueChange(n):f.preventDefault()}),onKeyDown:bn(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&i.onValueChange(n)}),onFocus:bn(e.onFocus,()=>{const f=i.activationMode!=="manual";!u&&!o&&f&&i.onValueChange(n)})})})});Mre.displayName=Dre;var Rre="TabsContent",Lre=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:o,children:s,...i}=e,l=qM(Rre,r),c=Fre(l.baseId,n),d=$re(l.baseId,n),u=n===l.value,f=p.useRef(u);return p.useEffect(()=>{const h=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(h)},[]),a.jsx(Bc,{present:o||u,children:({present:h})=>a.jsx(oa.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!h,id:d,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:h&&s})})});Lre.displayName=Rre;function Fre(e,t){return`${e}-trigger-${t}`}function $re(e,t){return`${e}-content-${t}`}var nKe=Ire,Bre=Tre,qre=Mre,zre=Lre;const _c=nKe,ql=_e.forwardRef(({className:e,...t},r)=>a.jsx(Bre,{ref:r,className:mr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));ql.displayName=Bre.displayName;const ca=_e.forwardRef(({className:e,...t},r)=>a.jsx(qre,{ref:r,className:mr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));ca.displayName=qre.displayName;const uo=_e.forwardRef(({className:e,...t},r)=>a.jsx(zre,{ref:r,className:mr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));uo.displayName=zre.displayName;function Ure({open:e,onOpenChange:t,client:r,onSaved:n}){const{toast:o}=no(),{userProfile:s}=So(),i=I=>({tipo_pessoa:I?.tipo_pessoa||"PF",tipo_cadastro:I?.tipo_cadastro||"cliente",nome:I?.nome||"",apelido:I?.apelido||"",cpf:I?.cpf||"",cnpj:I?.cnpj||"",rg:I?.rg||"",ie:I?.ie||"",email:I?.email||"",telefone:I?.telefone||"",fone2:I?.fone2||"",celular1:I?.celular1||"",celular2:I?.celular2||"",whatsapp:I?.whatsapp||"",cep:I?.cep||"",endereco:I?.endereco||"",numero:I?.numero||"",complemento:I?.complemento||"",bairro:I?.bairro||"",cidade:I?.cidade||"",uf:I?.uf||"",cidade_ibge:I?.cidade_ibge||"",limite_credito:I?.limite_credito??"",tipo_recebimento:I?.tipo_recebimento||"",regime_tributario:I?.regime_tributario||"",tipo_contribuinte:I?.tipo_contribuinte||"",aniversario:I?.aniversario?String(I.aniversario).slice(0,10):"",sexo:I?.sexo||"",estado_civil:I?.estado_civil||"",nome_mae:I?.nome_mae||"",nome_pai:I?.nome_pai||"",observacoes:I?.observacoes||"",status:I?.status||"active"}),[l,c]=p.useState(i(r)),[d,u]=p.useState("basicos"),[f,h]=p.useState(!1);p.useEffect(()=>{let I="cliente";r?.flag_cliente&&r?.flag_fornecedor?I="ambos":r?.flag_fornecedor&&(I="fornecedor"),c({tipo_pessoa:r?.tipo_pessoa||"PF",tipo_cadastro:I,nome:r?.nome||"",apelido:r?.apelido||"",cpf:r?.cpf||"",cnpj:r?.cnpj||"",rg:r?.rg||"",ie:r?.ie||"",email:r?.email||"",telefone:r?.telefone||"",fone2:r?.fone2||"",celular1:r?.celular1||"",celular2:r?.celular2||"",whatsapp:r?.whatsapp||"",cep:r?.cep||"",endereco:r?.endereco||"",numero:r?.numero||"",complemento:r?.complemento||"",bairro:r?.bairro||"",cidade:r?.cidade||"",uf:r?.uf||"",cidade_ibge:r?.cidade_ibge||"",limite_credito:r?.limite_credito??"",tipo_recebimento:r?.tipo_recebimento||"",regime_tributario:r?.regime_tributario||"",tipo_contribuinte:r?.tipo_contribuinte||"",aniversario:r?.aniversario?String(r.aniversario).slice(0,10):"",sexo:r?.sexo||"",estado_civil:r?.estado_civil||"",nome_mae:r?.nome_mae||"",nome_pai:r?.nome_pai||"",observacoes:r?.observacoes||"",status:r?.status||"active"})},[r]),p.useEffect(()=>{e?c(i(r||null)):r||c(i(null))},[e,!!r]);const m=I=>{const{id:R,value:D}=I.target;c(U=>({...U,[R]:D}))},v=async()=>{try{const I=x.digits(l.cnpj);if(!I||I.length!==14){o({title:"CNPJ invlido",description:"Informe 14 dgitos para buscar.",variant:"destructive"});return}const R=await fetch(`https://brasilapi.com.br/api/cnpj/v1/${I}`);if(!R.ok){let ue="Falha ao consultar CNPJ";try{const Ne=await R.json();Ne?.message&&(ue=Ne.message)}catch{}throw new Error(ue)}const D=await R.json();try{console.info("[clientes] BuscarCNPJ:payload",D)}catch{}const U=D.razao_social||D.nome||"",z=D.nome_fantasia||"",H=D.logradouro||"",q=String(D.numero||""),Q=D.complemento||"",pe=D.bairro||"",be=D.municipio||D.localidade||"",V=D.uf||"",B=x.digits(D.cep||"");let J="";try{if(be&&V){const ue=await fetch(`https://brasilapi.com.br/api/ibge/municipios/v1/${V}`);if(ue.ok){const Ne=await ue.json(),Z=se=>String(se||"").normalize("NFD").replace(/\p{Diacritic}/gu,"").toLowerCase().trim(),ge=Z(be),le=(Ne||[]).find(se=>Z(se.nome)===ge);(le?.codigo_ibge||le?.codigo)&&(J=String(le.codigo_ibge||le.codigo))}}}catch{}c(ue=>({...ue,nome:U,apelido:z||U,endereco:H,numero:q,complemento:Q,bairro:pe,cidade:be,uf:V,cep:B,cidade_ibge:J||ue.cidade_ibge}));try{console.info("[clientes] BuscarCNPJ:setForm",{razao:U,fantasia:z,logradouro:H,numero:q,complemento:Q,bairro:pe,cidade:be,uf:V,cep:B,codigoIBGE:J})}catch{}o({title:"CNPJ carregado",description:"Dados preenchidos."})}catch(I){o({title:"Falha ao buscar CNPJ",description:I.message||"Tente novamente.",variant:"destructive"})}},g=I=>I===""?null:I,y=I=>{if(I==null)return null;if(typeof I=="number")return I;const R=String(I).trim();if(!R)return null;const D=R.replace(/\s+/g,"").replace(/\.(?=\d{3}(?:\D|$))/g,"").replace(/,/g,"."),U=Number(D);return Number.isFinite(U)?U:null},x=p.useMemo(()=>({digits:I=>(I||"").replace(/\D+/g,"")}),[]),b=I=>x.digits(I).slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),w=I=>x.digits(I).slice(0,14).replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d{1,2})$/,"$1-$2"),j=I=>x.digits(I).slice(0,8).replace(/(\d{5})(\d)/,"$1-$2"),_=I=>{const R=x.digits(I).slice(0,11);return R.length<=10?R.replace(/(\d{2})(\d{4})(\d{0,4})/,"($1) $2-$3").trim():R.replace(/(\d{2})(\d{5})(\d{0,4})/,"($1) $2-$3").trim()},C=I=>String(I||"").replace(/[^a-z]/gi,"").toUpperCase().slice(0,2),E=(I,R=6)=>x.digits(I).slice(0,R),A=I=>{const R=x.digits(I);return R?(Number(R)/100).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},P=(I,R)=>{let D=R;I==="cpf"&&(D=b(R)),I==="cnpj"&&(D=w(R)),I==="cep"&&(D=j(R)),["telefone","fone2","celular1","celular2","whatsapp"].includes(I)&&(D=_(R)),I==="uf"&&(D=C(R)),I==="numero"&&(D=E(R,8)),I==="cidade_ibge"&&(D=E(R,7)),I==="limite_credito"&&(D=A(R)),c(U=>({...U,[I]:D}))},F=async()=>{const I=x.digits(l.cep);if(!I||I.length!==8){o({title:"CEP invlido",description:"Informe 8 dgitos.",variant:"destructive"});return}try{h(!0),c(U=>({...U,endereco:"Buscando...",bairro:"Buscando...",cidade:"Buscando...",uf:""}));const D=await(await fetch(`https://viacep.com.br/ws/${I}/json/`)).json();if(D.erro)throw new Error("CEP no encontrado");c(U=>({...U,endereco:D.logradouro||"",bairro:D.bairro||"",cidade:D.localidade||"",uf:D.uf||"",cidade_ibge:D.ibge||""})),o({title:"CEP encontrado!",description:"Endereo preenchido automaticamente.",variant:"success"})}catch(R){c(D=>({...D,endereco:"",bairro:"",cidade:"",uf:""})),o({title:"Falha ao buscar CEP",description:R.message||"Tente novamente.",variant:"destructive"})}finally{h(!1)}},M=async I=>{I?.preventDefault?.(),window.__protectPaymentModal&&window.__protectPaymentModal(5e3);try{if(!l.nome||l.nome.trim().length<2)throw new Error("Informe o nome/razo social do cliente.");const R={tipo_pessoa:g(l.tipo_pessoa),nome:l.nome,apelido:g(l.apelido),cpf:g(l.cpf),cnpj:g(l.cnpj),rg:g(l.rg),ie:g(l.ie),email:g(l.email),telefone:g(l.telefone),fone2:g(l.fone2),celular1:g(l.celular1),celular2:g(l.celular2),whatsapp:g(l.whatsapp),cep:g(l.cep),endereco:g(l.endereco),numero:g(l.numero),complemento:g(l.complemento),bairro:g(l.bairro),cidade:g(l.cidade),uf:g(l.uf),cidade_ibge:g(l.cidade_ibge),limite_credito:y(l.limite_credito),tipo_recebimento:g(l.tipo_recebimento),regime_tributario:g(l.regime_tributario),tipo_contribuinte:g(l.tipo_contribuinte),aniversario:g(l.aniversario),sexo:g(l.sexo),estado_civil:g(l.estado_civil),nome_mae:g(l.nome_mae),nome_pai:g(l.nome_pai),observacoes:g(l.observacoes),flag_cliente:l.tipo_cadastro==="cliente"||l.tipo_cadastro==="ambos",flag_fornecedor:l.tipo_cadastro==="fornecedor"||l.tipo_cadastro==="ambos",flag_funcionario:!1,flag_administradora:!1,flag_parceiro:!1,flag_ccf_spc:!1,status:l.status};let D,U=null;if(r?.id){const{data:z,error:H}=await fe.from("clientes").update(R).eq("id",r.id).select().single();D=H,U=z??null}else{const z=s?.codigo_empresa||null;if(!z)throw new Error("No foi possvel identificar a empresa do usurio (codigo_empresa). Tente recarregar a pgina ou entrar novamente.");const H={...R,codigo_empresa:z},{data:q,error:Q}=await fe.from("clientes").insert(H).select().single();D=Q,U=q??null}if(D)throw D;o({title:"Cliente salvo!",description:"As informaes do cliente foram atualizadas.",variant:"success"}),n?.(U),setTimeout(()=>{t?.(!1)},50)}catch(R){const D=(R?.message||"").toLowerCase(),U=R?.code||"";let z="Erro ao salvar cliente",H=R.message;U==="23505"||D.includes("duplicate key")&&D.includes("uq_clientes_empresa_codigo")?(z="Cdigo j cadastrado",H="J existe um cliente com este cdigo na sua empresa. Deixe o campo cdigo em branco para gerar automaticamente ou escolha outro nmero."):D.includes("column")&&D.includes("does not exist")&&(H="Seu banco pode no estar migrado para os novos campos. Atualize o schema conforme estrutura_bd."),o({title:z,description:H,variant:"destructive"})}};return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto w-full",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:r?"Editar Cliente":"Novo Cliente"}),a.jsx(On,{children:"Preencha os dados cadastrais do cliente."})]}),a.jsx("form",{onSubmit:M,className:"grid gap-4 sm:gap-6 py-2",children:a.jsxs(_c,{value:d,onValueChange:u,className:"w-full",children:[a.jsx("div",{className:"sm:hidden mb-4",children:a.jsxs(Cn,{value:d,onValueChange:u,children:[a.jsx(jn,{className:"w-full",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"basicos",children:"Dados Bsicos"}),a.jsx(nt,{value:"endereco",children:"Endereo"}),a.jsx(nt,{value:"financeiro",children:"Financeiro"}),a.jsx(nt,{value:"adicionais",children:"Adicionais"})]})]})}),a.jsxs(ql,{className:"hidden sm:grid grid-cols-4 gap-2",children:[a.jsx(ca,{value:"basicos",children:"Dados Bsicos"}),a.jsx(ca,{value:"endereco",children:"Endereo"}),a.jsx(ca,{value:"financeiro",children:"Financeiro"}),a.jsx(ca,{value:"adicionais",children:"Adicionais"})]}),a.jsx(uo,{value:"basicos",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{children:"Tipo de Pessoa"}),a.jsxs(Cn,{value:l.tipo_pessoa,onValueChange:I=>c(R=>({...R,tipo_pessoa:I})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Pessoa"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"PF",children:"Fsica"}),a.jsx(nt,{value:"PJ",children:"Jurdica"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{children:"Tipo de Cadastro *"}),a.jsxs(Cn,{value:l.tipo_cadastro,onValueChange:I=>c(R=>({...R,tipo_cadastro:I})),required:!0,children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"cliente",children:"Cliente"}),a.jsx(nt,{value:"fornecedor",children:"Fornecedor"}),a.jsx(nt,{value:"ambos",children:"Cliente e Fornecedor"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(De,{htmlFor:"nome",children:l.tipo_pessoa==="PJ"?"Razo Social":"Nome"}),a.jsx(Je,{id:"nome",value:l.nome,onChange:m,required:!0})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(De,{htmlFor:"apelido",children:l.tipo_pessoa==="PJ"?"Nome Fantasia":"Apelido"}),a.jsx(Je,{id:"apelido",value:l.apelido,onChange:m})]}),l.tipo_pessoa==="PF"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"cpf",children:"CPF"}),a.jsx(Je,{id:"cpf",value:l.cpf,onChange:I=>P("cpf",I.target.value),placeholder:"000.000.000-00"})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"rg",children:"RG"}),a.jsx(Je,{id:"rg",value:l.rg,onChange:m})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"cnpj",children:"CNPJ"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"cnpj",value:l.cnpj,onChange:I=>P("cnpj",I.target.value),placeholder:"00.000.000/0000-00"}),a.jsx(ce,{type:"button",variant:"outline",onClick:v,children:"Buscar"})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"ie",children:"Inscrio Estadual (IE)"}),a.jsx(Je,{id:"ie",value:l.ie,onChange:m})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(De,{htmlFor:"email",children:"Email"}),a.jsx(Je,{id:"email",type:"email",value:l.email,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"telefone",children:"Telefone"}),a.jsx(Je,{id:"telefone",value:l.telefone,onChange:I=>P("telefone",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"celular1",children:"Celular"}),a.jsx(Je,{id:"celular1",value:l.celular1,onChange:I=>P("celular1",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"whatsapp",children:"WhatsApp"}),a.jsx(Je,{id:"whatsapp",value:l.whatsapp,onChange:I=>P("whatsapp",I.target.value),placeholder:"(DDD) 9...."})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"fone2",children:"Fone 2"}),a.jsx(Je,{id:"fone2",value:l.fone2,onChange:I=>P("fone2",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"celular2",children:"Celular 2"}),a.jsx(Je,{id:"celular2",value:l.celular2,onChange:I=>P("celular2",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"aniversario",children:"Nascimento"}),a.jsx(Je,{id:"aniversario",type:"date",value:l.aniversario||"",onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{children:"Status"}),a.jsxs(Cn,{value:l.status,onValueChange:I=>c(R=>({...R,status:I})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Status"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"active",children:"Ativo"}),a.jsx(nt,{value:"inactive",children:"Inativo"})]})]})]})]})}),a.jsx(uo,{value:"endereco",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"cep",children:"CEP"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"cep",value:l.cep,onChange:I=>P("cep",I.target.value),placeholder:"00000-000"}),a.jsx(ce,{type:"button",variant:"outline",onClick:F,disabled:f,children:f?"Buscando...":"Buscar"})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(De,{htmlFor:"endereco",children:"Endereo"}),a.jsx(Je,{id:"endereco",value:l.endereco,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"numero",children:"Nmero"}),a.jsx(Je,{id:"numero",value:l.numero,onChange:I=>P("numero",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(De,{htmlFor:"complemento",children:"Complemento"}),a.jsx(Je,{id:"complemento",value:l.complemento,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(De,{htmlFor:"bairro",children:"Bairro"}),a.jsx(Je,{id:"bairro",value:l.bairro,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"cidade",children:"Cidade"}),a.jsx(Je,{id:"cidade",value:l.cidade,onChange:m})]}),a.jsxs("div",{className:"col-span-6 sm:col-span-1",children:[a.jsx(De,{htmlFor:"uf",children:"UF"}),a.jsx(Je,{id:"uf",value:l.uf,onChange:I=>P("uf",I.target.value),placeholder:"UF"})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"cidade_ibge",children:"Cd. IBGE"}),a.jsx(Je,{id:"cidade_ibge",value:l.cidade_ibge,onChange:I=>P("cidade_ibge",I.target.value)})]})]})}),a.jsx(uo,{value:"financeiro",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{htmlFor:"limite_credito",children:"Limite de Crdito"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary text-sm",children:"R$"}),a.jsx(Je,{id:"limite_credito",value:l.limite_credito,onChange:I=>P("limite_credito",I.target.value),placeholder:"0,00",className:"pl-10"})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{children:"Tipo de Recebimento"}),a.jsxs(Cn,{value:l.tipo_recebimento||"",onValueChange:I=>c(R=>({...R,tipo_recebimento:I})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"avista",children:" vista"}),a.jsx(nt,{value:"aprazo",children:"A prazo"}),a.jsx(nt,{value:"misto",children:"Misto"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{children:"Regime Tributrio"}),a.jsxs(Cn,{value:l.regime_tributario||"",onValueChange:I=>c(R=>({...R,regime_tributario:I})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"simples",children:"Simples"}),a.jsx(nt,{value:"lucro_presumido",children:"Lucro Presumido"}),a.jsx(nt,{value:"lucro_real",children:"Lucro Real"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(De,{children:"Tipo de Contribuinte"}),a.jsxs(Cn,{value:l.tipo_contribuinte||"",onValueChange:I=>c(R=>({...R,tipo_contribuinte:I})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"nao_contribuinte",children:"No Contribuinte"}),a.jsx(nt,{value:"contribuinte",children:"Contribuinte"}),a.jsx(nt,{value:"isento",children:"Isento"})]})]})]})]})}),a.jsx(uo,{value:"adicionais",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(De,{htmlFor:"sexo",children:"Sexo"}),a.jsxs(Cn,{value:l.sexo||"",onValueChange:I=>c(R=>({...R,sexo:I})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"m",children:"Masculino"}),a.jsx(nt,{value:"f",children:"Feminino"}),a.jsx(nt,{value:"o",children:"Outro"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(De,{htmlFor:"estado_civil",children:"Estado Civil"}),a.jsxs(Cn,{value:l.estado_civil||"",onValueChange:I=>c(R=>({...R,estado_civil:I})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"solteiro",children:"Solteiro(a)"}),a.jsx(nt,{value:"casado",children:"Casado(a)"}),a.jsx(nt,{value:"divorciado",children:"Divorciado(a)"}),a.jsx(nt,{value:"viuvo",children:"Vivo(a)"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(De,{htmlFor:"nome_mae",children:"Nome da Me"}),a.jsx(Je,{id:"nome_mae",value:l.nome_mae,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(De,{htmlFor:"nome_pai",children:"Nome do Pai"}),a.jsx(Je,{id:"nome_pai",value:l.nome_pai,onChange:m})]}),a.jsxs("div",{className:"col-span-12",children:[a.jsx(De,{htmlFor:"observacoes",children:"Observaes"}),a.jsx("textarea",{id:"observacoes",value:l.observacoes,onChange:m,rows:4,className:"w-full rounded-md border border-border bg-background p-2 text-sm"})]})]})})]})}),a.jsxs(ra,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[a.jsx(ih,{asChild:!0,children:a.jsx(ce,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),a.jsx(ce,{type:"submit",onClick:M,className:"w-full sm:w-auto",children:"Salvar Cliente"})]})]})})}function aKe(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),o=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(o),t&&(n.href=t),o.href=e,o.href}const oKe=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function uh(e){const t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}let Qg=null;function Vre(e={}){return Qg||(e.includeStyleProperties?(Qg=e.includeStyleProperties,Qg):(Qg=uh(window.getComputedStyle(document.documentElement)),Qg))}function dS(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function sKe(e){const t=dS(e,"border-left-width"),r=dS(e,"border-right-width");return e.clientWidth+t+r}function iKe(e){const t=dS(e,"border-top-width"),r=dS(e,"border-bottom-width");return e.clientHeight+t+r}function Wre(e,t={}){const r=t.width||sKe(e),n=t.height||iKe(e);return{width:r,height:n}}function lKe(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const lc=16384;function cKe(e){(e.width>lc||e.height>lc)&&(e.width>lc&&e.height>lc?e.width>e.height?(e.height*=lc/e.width,e.width=lc):(e.width*=lc/e.height,e.height=lc):e.width>lc?(e.height*=lc/e.width,e.width=lc):(e.width*=lc/e.height,e.height=lc))}function uS(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>t(n))})},n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function dKe(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function uKe(e,t,r){const n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"svg"),s=document.createElementNS(n,"foreignObject");return o.setAttribute("width",`${t}`),o.setAttribute("height",`${r}`),o.setAttribute("viewBox",`0 0 ${t} ${r}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),o.appendChild(s),s.appendChild(e),dKe(o)}const Kl=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||Kl(r,t)};function fKe(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function mKe(e,t){return Vre(t).map(r=>{const n=e.getPropertyValue(r),o=e.getPropertyPriority(r);return`${r}: ${n}${o?" !important":""};`}).join(" ")}function hKe(e,t,r,n){const o=`.${e}:${t}`,s=r.cssText?fKe(r):mKe(r,n);return document.createTextNode(`${o}{${s}}`)}function dz(e,t,r,n){const o=window.getComputedStyle(e,r),s=o.getPropertyValue("content");if(s===""||s==="none")return;const i=oKe();try{t.className=`${t.className} ${i}`}catch{return}const l=document.createElement("style");l.appendChild(hKe(i,r,o,n)),t.appendChild(l)}function pKe(e,t,r){dz(e,t,":before",r),dz(e,t,":after",r)}const uz="application/font-woff",fz="image/jpeg",gKe={woff:uz,woff2:uz,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:fz,jpeg:fz,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function vKe(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function zM(e){const t=vKe(e).toLowerCase();return gKe[t]||""}function xKe(e){return e.split(/,/)[1]}function NT(e){return e.search(/^(data:)/)!==-1}function Hre(e,t){return`data:${t};base64,${e}`}async function Gre(e,t,r){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const o=await n.blob();return new Promise((s,i)=>{const l=new FileReader;l.onerror=i,l.onloadend=()=>{try{s(r({res:n,result:l.result}))}catch(c){i(c)}},l.readAsDataURL(o)})}const nE={};function yKe(e,t,r){let n=e.replace(/\?.*/,"");return r&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function UM(e,t,r){const n=yKe(e,t,r.includeQueryParams);if(nE[n]!=null)return nE[n];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let o;try{const s=await Gre(e,r.fetchRequestInit,({res:i,result:l})=>(t||(t=i.headers.get("Content-Type")||""),xKe(l)));o=Hre(s,t)}catch(s){o=r.imagePlaceholder||"";let i=`Failed to fetch resource: ${e}`;s&&(i=typeof s=="string"?s:s.message),i&&console.warn(i)}return nE[n]=o,o}async function bKe(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):uS(t)}async function wKe(e,t){if(e.currentSrc){const s=document.createElement("canvas"),i=s.getContext("2d");s.width=e.clientWidth,s.height=e.clientHeight,i?.drawImage(e,0,0,s.width,s.height);const l=s.toDataURL();return uS(l)}const r=e.poster,n=zM(r),o=await UM(r,n,t);return uS(o)}async function jKe(e,t){var r;try{if(!((r=e?.contentDocument)===null||r===void 0)&&r.body)return await k5(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function _Ke(e,t){return Kl(e,HTMLCanvasElement)?bKe(e):Kl(e,HTMLVideoElement)?wKe(e,t):Kl(e,HTMLIFrameElement)?jKe(e,t):e.cloneNode(Kre(e))}const NKe=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",Kre=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function SKe(e,t,r){var n,o;if(Kre(t))return t;let s=[];return NKe(e)&&e.assignedNodes?s=uh(e.assignedNodes()):Kl(e,HTMLIFrameElement)&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?s=uh(e.contentDocument.body.childNodes):s=uh(((o=e.shadowRoot)!==null&&o!==void 0?o:e).childNodes),s.length===0||Kl(e,HTMLVideoElement)||await s.reduce((i,l)=>i.then(()=>k5(l,r)).then(c=>{c&&t.appendChild(c)}),Promise.resolve()),t}function CKe(e,t,r){const n=t.style;if(!n)return;const o=window.getComputedStyle(e);o.cssText?(n.cssText=o.cssText,n.transformOrigin=o.transformOrigin):Vre(r).forEach(s=>{let i=o.getPropertyValue(s);s==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),Kl(e,HTMLIFrameElement)&&s==="display"&&i==="inline"&&(i="block"),s==="d"&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),n.setProperty(s,i,o.getPropertyPriority(s))})}function PKe(e,t){Kl(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),Kl(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function AKe(e,t){if(Kl(e,HTMLSelectElement)){const r=t,n=Array.from(r.children).find(o=>e.value===o.getAttribute("value"));n&&n.setAttribute("selected","")}}function EKe(e,t,r){return Kl(t,Element)&&(CKe(e,t,r),pKe(e,t,r),PKe(e,t),AKe(e,t)),t}async function kKe(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const n={};for(let s=0;s<r.length;s++){const l=r[s].getAttribute("xlink:href");if(l){const c=e.querySelector(l),d=document.querySelector(l);!c&&d&&!n[l]&&(n[l]=await k5(d,t,!0))}}const o=Object.values(n);if(o.length){const s="http://www.w3.org/1999/xhtml",i=document.createElementNS(s,"svg");i.setAttribute("xmlns",s),i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.display="none";const l=document.createElementNS(s,"defs");i.appendChild(l);for(let c=0;c<o.length;c++)l.appendChild(o[c]);e.appendChild(i)}return e}async function k5(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>_Ke(n,t)).then(n=>SKe(e,n,t)).then(n=>EKe(e,n,t)).then(n=>kKe(n,t))}const Xre=/url\((['"]?)([^'"]+?)\1\)/g,IKe=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,OKe=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function TKe(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function DKe(e){const t=[];return e.replace(Xre,(r,n,o)=>(t.push(o),r)),t.filter(r=>!NT(r))}async function MKe(e,t,r,n,o){try{const s=r?aKe(t,r):t,i=zM(t);let l;if(o){const c=await o(s);l=Hre(c,i)}else l=await UM(s,i,n);return e.replace(TKe(t),`$1${l}$3`)}catch{}return e}function RKe(e,{preferredFontFormat:t}){return t?e.replace(OKe,r=>{for(;;){const[n,,o]=IKe.exec(r)||[];if(!o)return"";if(o===t)return`src: ${n};`}}):e}function Yre(e){return e.search(Xre)!==-1}async function Jre(e,t,r){if(!Yre(e))return e;const n=RKe(e,r);return DKe(n).reduce((s,i)=>s.then(l=>MKe(l,i,t,r)),Promise.resolve(n))}async function Zg(e,t,r){var n;const o=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(o){const s=await Jre(o,null,r);return t.style.setProperty(e,s,t.style.getPropertyPriority(e)),!0}return!1}async function LKe(e,t){await Zg("background",e,t)||await Zg("background-image",e,t),await Zg("mask",e,t)||await Zg("-webkit-mask",e,t)||await Zg("mask-image",e,t)||await Zg("-webkit-mask-image",e,t)}async function FKe(e,t){const r=Kl(e,HTMLImageElement);if(!(r&&!NT(e.src))&&!(Kl(e,SVGImageElement)&&!NT(e.href.baseVal)))return;const n=r?e.src:e.href.baseVal,o=await UM(n,zM(n),t);await new Promise((s,i)=>{e.onload=s,e.onerror=t.onImageErrorHandler?(...c)=>{try{s(t.onImageErrorHandler(...c))}catch(d){i(d)}}:i;const l=e;l.decode&&(l.decode=s),l.loading==="lazy"&&(l.loading="eager"),r?(e.srcset="",e.src=o):e.href.baseVal=o})}async function $Ke(e,t){const n=uh(e.childNodes).map(o=>Qre(o,t));await Promise.all(n).then(()=>e)}async function Qre(e,t){Kl(e,Element)&&(await LKe(e,t),await FKe(e,t),await $Ke(e,t))}function BKe(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(o=>{r[o]=n[o]}),e}const mz={};async function hz(e){let t=mz[e];if(t!=null)return t;const n=await(await fetch(e)).text();return t={url:e,cssText:n},mz[e]=t,t}async function pz(e,t){let r=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,s=(r.match(/url\([^)]+\)/g)||[]).map(async i=>{let l=i.replace(n,"$1");return l.startsWith("https://")||(l=new URL(l,e.url).href),Gre(l,t.fetchRequestInit,({result:c})=>(r=r.replace(i,`url(${c})`),[i,c]))});return Promise.all(s).then(()=>r)}function gz(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(r,"");const o=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=o.exec(n);if(c===null)break;t.push(c[0])}n=n.replace(o,"");const s=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",l=new RegExp(i,"gi");for(;;){let c=s.exec(n);if(c===null){if(c=l.exec(n),c===null)break;s.lastIndex=l.lastIndex}else l.lastIndex=s.lastIndex;t.push(c[0])}return t}async function qKe(e,t){const r=[],n=[];return e.forEach(o=>{if("cssRules"in o)try{uh(o.cssRules||[]).forEach((s,i)=>{if(s.type===CSSRule.IMPORT_RULE){let l=i+1;const c=s.href,d=hz(c).then(u=>pz(u,t)).then(u=>gz(u).forEach(f=>{try{o.insertRule(f,f.startsWith("@import")?l+=1:o.cssRules.length)}catch(h){console.error("Error inserting rule from remote css",{rule:f,error:h})}})).catch(u=>{console.error("Error loading remote css",u.toString())});n.push(d)}})}catch(s){const i=e.find(l=>l.href==null)||document.styleSheets[0];o.href!=null&&n.push(hz(o.href).then(l=>pz(l,t)).then(l=>gz(l).forEach(c=>{i.insertRule(c,i.cssRules.length)})).catch(l=>{console.error("Error loading remote stylesheet",l)})),console.error("Error inlining remote css file",s)}}),Promise.all(n).then(()=>(e.forEach(o=>{if("cssRules"in o)try{uh(o.cssRules||[]).forEach(s=>{r.push(s)})}catch(s){console.error(`Error while reading CSS rules from ${o.href}`,s)}}),r))}function zKe(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>Yre(t.style.getPropertyValue("src")))}async function UKe(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=uh(e.ownerDocument.styleSheets),n=await qKe(r,t);return zKe(n)}function Zre(e){return e.trim().replace(/["']/g,"")}function VKe(e){const t=new Set;function r(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(s=>{t.add(Zre(s))}),Array.from(n.children).forEach(s=>{s instanceof HTMLElement&&r(s)})}return r(e),t}async function WKe(e,t){const r=await UKe(e,t),n=VKe(e);return(await Promise.all(r.filter(s=>n.has(Zre(s.style.fontFamily))).map(s=>{const i=s.parentStyleSheet?s.parentStyleSheet.href:null;return Jre(s.cssText,i,t)}))).join(`
`)}async function HKe(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await WKe(e,t);if(r){const n=document.createElement("style"),o=document.createTextNode(r);n.appendChild(o),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function GKe(e,t={}){const{width:r,height:n}=Wre(e,t),o=await k5(e,t,!0);return await HKe(o,t),await Qre(o,t),BKe(o,t),await uKe(o,r,n)}async function KKe(e,t={}){const{width:r,height:n}=Wre(e,t),o=await GKe(e,t),s=await uS(o),i=document.createElement("canvas"),l=i.getContext("2d"),c=t.pixelRatio||lKe(),d=t.canvasWidth||r,u=t.canvasHeight||n;return i.width=d*c,i.height=u*c,t.skipAutoScale||cKe(i),i.style.width=`${d}`,i.style.height=`${u}`,t.backgroundColor&&(l.fillStyle=t.backgroundColor,l.fillRect(0,0,i.width,i.height)),l.drawImage(s,0,0,i.width,i.height),i}async function XKe(e,t={}){return(await KKe(e,t)).toDataURL()}var uu=Uint8Array,Nc=Uint16Array,VM=Int32Array,WM=new uu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),HM=new uu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),vz=new uu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ene=function(e,t){for(var r=new Nc(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var o=new VM(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},tne=ene(WM,2),YKe=tne.b,ST=tne.r;YKe[28]=258,ST[258]=28;var JKe=ene(HM,0),xz=JKe.r,CT=new Nc(32768);for(var Uo=0;Uo<32768;++Uo){var vm=(Uo&43690)>>1|(Uo&21845)<<1;vm=(vm&52428)>>2|(vm&13107)<<2,vm=(vm&61680)>>4|(vm&3855)<<4,CT[Uo]=((vm&65280)>>8|(vm&255)<<8)>>1}var cb=function(e,t,r){for(var n=e.length,o=0,s=new Nc(t);o<n;++o)e[o]&&++s[e[o]-1];var i=new Nc(t);for(o=1;o<t;++o)i[o]=i[o-1]+s[o-1]<<1;var l;if(r){l=new Nc(1<<t);var c=15-t;for(o=0;o<n;++o)if(e[o])for(var d=o<<4|e[o],u=t-e[o],f=i[e[o]-1]++<<u,h=f|(1<<u)-1;f<=h;++f)l[CT[f]>>c]=d}else for(l=new Nc(n),o=0;o<n;++o)e[o]&&(l[o]=CT[i[e[o]-1]++]>>15-e[o]);return l},mg=new uu(288);for(var Uo=0;Uo<144;++Uo)mg[Uo]=8;for(var Uo=144;Uo<256;++Uo)mg[Uo]=9;for(var Uo=256;Uo<280;++Uo)mg[Uo]=7;for(var Uo=280;Uo<288;++Uo)mg[Uo]=8;var fS=new uu(32);for(var Uo=0;Uo<32;++Uo)fS[Uo]=5;var QKe=cb(mg,9,0),ZKe=cb(fS,5,0),rne=function(e){return(e+7)/8|0},eXe=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new uu(e.subarray(t,r))},ff=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},fy=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},aE=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var o=r.length,s=r.slice();if(!o)return{t:ane,l:0};if(o==1){var i=new uu(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(_,C){return _.f-C.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=o-1;)l=r[r[d].f<r[f].f?d++:f++],c=r[d!=u&&r[d].f<r[f].f?d++:f++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var h=s[0].s,n=1;n<o;++n)s[n].s>h&&(h=s[n].s);var m=new Nc(h+1),v=PT(r[u-1],m,0);if(v>t){var n=0,g=0,y=v-t,x=1<<y;for(s.sort(function(C,E){return m[E.s]-m[C.s]||C.f-E.f});n<o;++n){var b=s[n].s;if(m[b]>t)g+=x-(1<<v-m[b]),m[b]=t;else break}for(g>>=y;g>0;){var w=s[n].s;m[w]<t?g-=1<<t-m[w]++-1:++n}for(;n>=0&&g;--n){var j=s[n].s;m[j]==t&&(--m[j],++g)}v=t}return{t:new uu(m),l:v}},PT=function(e,t,r){return e.s==-1?Math.max(PT(e.l,t,r+1),PT(e.r,t,r+1)):t[e.s]=r},yz=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Nc(++t),n=0,o=e[0],s=1,i=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==o&&l!=t)++s;else{if(!o&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(o),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(o);s=1,o=e[l]}return{c:r.subarray(0,n),n:t}},my=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},nne=function(e,t,r){var n=r.length,o=rne(t+2);e[o]=n&255,e[o+1]=n>>8,e[o+2]=e[o]^255,e[o+3]=e[o+1]^255;for(var s=0;s<n;++s)e[o+s+4]=r[s];return(o+4+n)*8},bz=function(e,t,r,n,o,s,i,l,c,d,u){ff(t,u++,r),++o[256];for(var f=aE(o,15),h=f.t,m=f.l,v=aE(s,15),g=v.t,y=v.l,x=yz(h),b=x.c,w=x.n,j=yz(g),_=j.c,C=j.n,E=new Nc(19),A=0;A<b.length;++A)++E[b[A]&31];for(var A=0;A<_.length;++A)++E[_[A]&31];for(var P=aE(E,7),F=P.t,M=P.l,I=19;I>4&&!F[vz[I-1]];--I);var R=d+5<<3,D=my(o,mg)+my(s,fS)+i,U=my(o,h)+my(s,g)+i+14+3*I+my(E,F)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&R<=D&&R<=U)return nne(t,u,e.subarray(c,c+d));var z,H,q,Q;if(ff(t,u,1+(U<D)),u+=2,U<D){z=cb(h,m,0),H=h,q=cb(g,y,0),Q=g;var pe=cb(F,M,0);ff(t,u,w-257),ff(t,u+5,C-1),ff(t,u+10,I-4),u+=14;for(var A=0;A<I;++A)ff(t,u+3*A,F[vz[A]]);u+=3*I;for(var be=[b,_],V=0;V<2;++V)for(var B=be[V],A=0;A<B.length;++A){var J=B[A]&31;ff(t,u,pe[J]),u+=F[J],J>15&&(ff(t,u,B[A]>>5&127),u+=B[A]>>12)}}else z=QKe,H=mg,q=ZKe,Q=fS;for(var A=0;A<l;++A){var ue=n[A];if(ue>255){var J=ue>>18&31;fy(t,u,z[J+257]),u+=H[J+257],J>7&&(ff(t,u,ue>>23&31),u+=WM[J]);var Ne=ue&31;fy(t,u,q[Ne]),u+=Q[Ne],Ne>3&&(fy(t,u,ue>>5&8191),u+=HM[Ne])}else fy(t,u,z[ue]),u+=H[ue]}return fy(t,u,z[256]),u+H[256]},tXe=new VM([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ane=new uu(0),rXe=function(e,t,r,n,o,s){var i=s.z||e.length,l=new uu(n+i+5*(1+Math.ceil(i/7e3))+o),c=l.subarray(n,l.length-o),d=s.l,u=(s.r||0)&7;if(t){u&&(c[0]=s.r>>3);for(var f=tXe[t-1],h=f>>13,m=f&8191,v=(1<<r)-1,g=s.p||new Nc(32768),y=s.h||new Nc(v+1),x=Math.ceil(r/3),b=2*x,w=function(ae){return(e[ae]^e[ae+1]<<x^e[ae+2]<<b)&v},j=new VM(25e3),_=new Nc(288),C=new Nc(32),E=0,A=0,P=s.i||0,F=0,M=s.w||0,I=0;P+2<i;++P){var R=w(P),D=P&32767,U=y[R];if(g[D]=U,y[R]=D,M<=P){var z=i-P;if((E>7e3||F>24576)&&(z>423||!d)){u=bz(e,c,0,j,_,C,A,F,I,P-I,u),F=E=A=0,I=P;for(var H=0;H<286;++H)_[H]=0;for(var H=0;H<30;++H)C[H]=0}var q=2,Q=0,pe=m,be=D-U&32767;if(z>2&&R==w(P-be))for(var V=Math.min(h,z)-1,B=Math.min(32767,P),J=Math.min(258,z);be<=B&&--pe&&D!=U;){if(e[P+q]==e[P+q-be]){for(var ue=0;ue<J&&e[P+ue]==e[P+ue-be];++ue);if(ue>q){if(q=ue,Q=be,ue>V)break;for(var Ne=Math.min(be,ue-2),Z=0,H=0;H<Ne;++H){var ge=P-be+H&32767,le=g[ge],se=ge-le&32767;se>Z&&(Z=se,U=ge)}}}D=U,U=g[D],be+=D-U&32767}if(Q){j[F++]=268435456|ST[q]<<18|xz[Q];var ee=ST[q]&31,de=xz[Q]&31;A+=WM[ee]+HM[de],++_[257+ee],++C[de],M=P+q,++E}else j[F++]=e[P],++_[e[P]]}}for(P=Math.max(P,M);P<i;++P)j[F++]=e[P],++_[e[P]];u=bz(e,c,d,j,_,C,A,F,I,P-I,u),d||(s.r=u&7|c[u/8|0]<<3,u-=7,s.h=y,s.p=g,s.i=P,s.w=M)}else{for(var P=s.w||0;P<i+d;P+=65535){var Le=P+65535;Le>=i&&(c[u/8|0]=d,Le=i),u=nne(c,u+1,e.subarray(P,Le))}s.i=i}return eXe(l,0,n+rne(u)+o)},one=function(){var e=1,t=0;return{p:function(r){for(var n=e,o=t,s=r.length|0,i=0;i!=s;){for(var l=Math.min(i+2655,s);i<l;++i)o+=n+=r[i];n=(n&65535)+15*(n>>16),o=(o&65535)+15*(o>>16)}e=n,t=o},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},nXe=function(e,t,r,n,o){if(!o&&(o={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),i=new uu(s.length+e.length);i.set(s),i.set(e,s.length),e=i,o.w=s.length}return rXe(e,t.level==null?6:t.level,t.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,o)},sne=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},aXe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var o=one();o.p(t.dictionary),sne(e,2,o.d())}};function AT(e,t){t||(t={});var r=one();r.p(e);var n=nXe(e,t,t.dictionary?6:2,4);return aXe(n,t),sne(n,n.length-4,r.d()),n}var oXe=typeof TextDecoder<"u"&&new TextDecoder,sXe=0;try{oXe.decode(ane,{stream:!0}),sXe=1}catch{}function iXe(e){if(Array.isArray(e))return e}function lXe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,i,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,o=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw o}}return l}}function cXe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wz(e,t){return iXe(e)||lXe(e,t)||hwe(e,t)||cXe()}function jz(e,t="utf8"){return new TextDecoder(t).decode(e)}const dXe=new TextEncoder;function uXe(e){return dXe.encode(e)}const fXe=1024*8,mXe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),oE={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class GM{constructor(t=fXe,r={}){lo(this,"buffer");lo(this,"byteLength");lo(this,"byteOffset");lo(this,"length");lo(this,"offset");lo(this,"lastWrittenByte");lo(this,"littleEndian");lo(this,"_data");lo(this,"_mark");lo(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const o=r.offset?r.offset>>>0:0,s=t.byteLength-o;let i=o;(ArrayBuffer.isView(t)||t instanceof GM)&&(t.byteLength!==t.buffer.byteLength&&(i=t.byteOffset+o),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,o=new Uint8Array(n);o.set(new Uint8Array(this.buffer)),this.buffer=o.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=oE[r].BYTES_PER_ELEMENT*t,o=this.byteOffset+this.offset,s=this.buffer.slice(o,o+n);if(this.littleEndian===mXe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(o,o+n));l.reverse();const c=new oE[r](l.buffer);return this.offset+=n,c.reverse(),c}const i=new oE[r](s);return this.offset+=n,i}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return jz(this.readBytes(t))}decodeText(t=1,r="utf8"){return jz(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(uXe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const hXe=4,_z=0,Nz=1,pXe=2;function k0(e){let t=e.length;for(;--t>=0;)e[t]=0}const gXe=0,ine=1,vXe=2,xXe=3,yXe=258,KM=29,E1=256,Rw=E1+1+KM,ax=30,XM=19,lne=2*Rw+1,Ep=15,sE=16,bXe=7,YM=256,cne=16,dne=17,une=18,ET=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Qj=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),wXe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),fne=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jXe=512,wf=new Array((Rw+2)*2);k0(wf);const db=new Array(ax*2);k0(db);const Lw=new Array(jXe);k0(Lw);const Fw=new Array(yXe-xXe+1);k0(Fw);const JM=new Array(KM);k0(JM);const mS=new Array(ax);k0(mS);function iE(e,t,r,n,o){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=o,this.has_stree=e&&e.length}let mne,hne,pne;function lE(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const gne=e=>e<256?Lw[e]:Lw[256+(e>>>7)],$w=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},zl=(e,t,r)=>{e.bi_valid>sE-r?(e.bi_buf|=t<<e.bi_valid&65535,$w(e,e.bi_buf),e.bi_buf=t>>sE-e.bi_valid,e.bi_valid+=r-sE):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Iu=(e,t,r)=>{zl(e,r[t*2],r[t*2+1])},vne=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},_Xe=e=>{e.bi_valid===16?($w(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},NXe=(e,t)=>{const r=t.dyn_tree,n=t.max_code,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let d,u,f,h,m,v,g=0;for(h=0;h<=Ep;h++)e.bl_count[h]=0;for(r[e.heap[e.heap_max]*2+1]=0,d=e.heap_max+1;d<lne;d++)u=e.heap[d],h=r[r[u*2+1]*2+1]+1,h>c&&(h=c,g++),r[u*2+1]=h,!(u>n)&&(e.bl_count[h]++,m=0,u>=l&&(m=i[u-l]),v=r[u*2],e.opt_len+=v*(h+m),s&&(e.static_len+=v*(o[u*2+1]+m)));if(g!==0){do{for(h=c-1;e.bl_count[h]===0;)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,g-=2}while(g>0);for(h=c;h!==0;h--)for(u=e.bl_count[h];u!==0;)f=e.heap[--d],!(f>n)&&(r[f*2+1]!==h&&(e.opt_len+=(h-r[f*2+1])*r[f*2],r[f*2+1]=h),u--)}},xne=(e,t,r)=>{const n=new Array(Ep+1);let o=0,s,i;for(s=1;s<=Ep;s++)o=o+r[s-1]<<1,n[s]=o;for(i=0;i<=t;i++){let l=e[i*2+1];l!==0&&(e[i*2]=vne(n[l]++,l))}},SXe=()=>{let e,t,r,n,o;const s=new Array(Ep+1);for(r=0,n=0;n<KM-1;n++)for(JM[n]=r,e=0;e<1<<ET[n];e++)Fw[r++]=n;for(Fw[r-1]=n,o=0,n=0;n<16;n++)for(mS[n]=o,e=0;e<1<<Qj[n];e++)Lw[o++]=n;for(o>>=7;n<ax;n++)for(mS[n]=o<<7,e=0;e<1<<Qj[n]-7;e++)Lw[256+o++]=n;for(t=0;t<=Ep;t++)s[t]=0;for(e=0;e<=143;)wf[e*2+1]=8,e++,s[8]++;for(;e<=255;)wf[e*2+1]=9,e++,s[9]++;for(;e<=279;)wf[e*2+1]=7,e++,s[7]++;for(;e<=287;)wf[e*2+1]=8,e++,s[8]++;for(xne(wf,Rw+1,s),e=0;e<ax;e++)db[e*2+1]=5,db[e*2]=vne(e,5);mne=new iE(wf,ET,E1+1,Rw,Ep),hne=new iE(db,Qj,0,ax,Ep),pne=new iE(new Array(0),wXe,0,XM,bXe)},yne=e=>{let t;for(t=0;t<Rw;t++)e.dyn_ltree[t*2]=0;for(t=0;t<ax;t++)e.dyn_dtree[t*2]=0;for(t=0;t<XM;t++)e.bl_tree[t*2]=0;e.dyn_ltree[YM*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},bne=e=>{e.bi_valid>8?$w(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Sz=(e,t,r,n)=>{const o=t*2,s=r*2;return e[o]<e[s]||e[o]===e[s]&&n[t]<=n[r]},cE=(e,t,r)=>{const n=e.heap[r];let o=r<<1;for(;o<=e.heap_len&&(o<e.heap_len&&Sz(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!Sz(t,n,e.heap[o],e.depth));)e.heap[r]=e.heap[o],r=o,o<<=1;e.heap[r]=n},Cz=(e,t,r)=>{let n,o,s=0,i,l;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+s++]&255,n+=(e.pending_buf[e.sym_buf+s++]&255)<<8,o=e.pending_buf[e.sym_buf+s++],n===0?Iu(e,o,t):(i=Fw[o],Iu(e,i+E1+1,t),l=ET[i],l!==0&&(o-=JM[i],zl(e,o,l)),n--,i=gne(n),Iu(e,i,r),l=Qj[i],l!==0&&(n-=mS[i],zl(e,n,l)));while(s<e.sym_next);Iu(e,YM,t)},kT=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.elems;let i,l,c=-1,d;for(e.heap_len=0,e.heap_max=lne,i=0;i<s;i++)r[i*2]!==0?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):r[i*2+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=c<2?++c:0,r[d*2]=1,e.depth[d]=0,e.opt_len--,o&&(e.static_len-=n[d*2+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)cE(e,r,i);d=s;do i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],cE(e,r,1),l=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=l,r[d*2]=r[i*2]+r[l*2],e.depth[d]=(e.depth[i]>=e.depth[l]?e.depth[i]:e.depth[l])+1,r[i*2+1]=r[l*2+1]=d,e.heap[1]=d++,cE(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],NXe(e,t),xne(r,c,e.bl_count)},Pz=(e,t,r)=>{let n,o=-1,s,i=t[0*2+1],l=0,c=7,d=4;for(i===0&&(c=138,d=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)s=i,i=t[(n+1)*2+1],!(++l<c&&s===i)&&(l<d?e.bl_tree[s*2]+=l:s!==0?(s!==o&&e.bl_tree[s*2]++,e.bl_tree[cne*2]++):l<=10?e.bl_tree[dne*2]++:e.bl_tree[une*2]++,l=0,o=s,i===0?(c=138,d=3):s===i?(c=6,d=3):(c=7,d=4))},Az=(e,t,r)=>{let n,o=-1,s,i=t[0*2+1],l=0,c=7,d=4;for(i===0&&(c=138,d=3),n=0;n<=r;n++)if(s=i,i=t[(n+1)*2+1],!(++l<c&&s===i)){if(l<d)do Iu(e,s,e.bl_tree);while(--l!==0);else s!==0?(s!==o&&(Iu(e,s,e.bl_tree),l--),Iu(e,cne,e.bl_tree),zl(e,l-3,2)):l<=10?(Iu(e,dne,e.bl_tree),zl(e,l-3,3)):(Iu(e,une,e.bl_tree),zl(e,l-11,7));l=0,o=s,i===0?(c=138,d=3):s===i?(c=6,d=3):(c=7,d=4)}},CXe=e=>{let t;for(Pz(e,e.dyn_ltree,e.l_desc.max_code),Pz(e,e.dyn_dtree,e.d_desc.max_code),kT(e,e.bl_desc),t=XM-1;t>=3&&e.bl_tree[fne[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},PXe=(e,t,r,n)=>{let o;for(zl(e,t-257,5),zl(e,r-1,5),zl(e,n-4,4),o=0;o<n;o++)zl(e,e.bl_tree[fne[o]*2+1],3);Az(e,e.dyn_ltree,t-1),Az(e,e.dyn_dtree,r-1)},AXe=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return _z;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Nz;for(r=32;r<E1;r++)if(e.dyn_ltree[r*2]!==0)return Nz;return _z};let Ez=!1;const EXe=e=>{Ez||(SXe(),Ez=!0),e.l_desc=new lE(e.dyn_ltree,mne),e.d_desc=new lE(e.dyn_dtree,hne),e.bl_desc=new lE(e.bl_tree,pne),e.bi_buf=0,e.bi_valid=0,yne(e)},wne=(e,t,r,n)=>{zl(e,(gXe<<1)+(n?1:0),3),bne(e),$w(e,r),$w(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},kXe=e=>{zl(e,ine<<1,3),Iu(e,YM,wf),_Xe(e)},IXe=(e,t,r,n)=>{let o,s,i=0;e.level>0?(e.strm.data_type===pXe&&(e.strm.data_type=AXe(e)),kT(e,e.l_desc),kT(e,e.d_desc),i=CXe(e),o=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=o&&(o=s)):o=s=r+5,r+4<=o&&t!==-1?wne(e,t,r,n):e.strategy===hXe||s===o?(zl(e,(ine<<1)+(n?1:0),3),Cz(e,wf,db)):(zl(e,(vXe<<1)+(n?1:0),3),PXe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),Cz(e,e.dyn_ltree,e.dyn_dtree)),yne(e),n&&bne(e)},OXe=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(Fw[r]+E1+1)*2]++,e.dyn_dtree[gne(t)*2]++),e.sym_next===e.sym_end);var TXe=EXe,DXe=wne,MXe=IXe,RXe=OXe,LXe=kXe,FXe={_tr_init:TXe,_tr_stored_block:DXe,_tr_flush_block:MXe,_tr_tally:RXe,_tr_align:LXe};const $Xe=(e,t,r,n)=>{let o=e&65535|0,s=e>>>16&65535|0,i=0;for(;r!==0;){i=r>2e3?2e3:r,r-=i;do o=o+t[n++]|0,s=s+o|0;while(--i);o%=65521,s%=65521}return o|s<<16|0};var Bw=$Xe;const BXe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},qXe=new Uint32Array(BXe()),zXe=(e,t,r,n)=>{const o=qXe,s=n+r;e^=-1;for(let i=n;i<s;i++)e=e>>>8^o[(e^t[i])&255];return e^-1};var ai=zXe,Yx={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},k1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:UXe,_tr_stored_block:IT,_tr_flush_block:VXe,_tr_tally:fh,_tr_align:WXe}=FXe,{Z_NO_FLUSH:mh,Z_PARTIAL_FLUSH:HXe,Z_FULL_FLUSH:GXe,Z_FINISH:dd,Z_BLOCK:kz,Z_OK:Pi,Z_STREAM_END:Iz,Z_STREAM_ERROR:Gu,Z_DATA_ERROR:KXe,Z_BUF_ERROR:dE,Z_DEFAULT_COMPRESSION:XXe,Z_FILTERED:YXe,Z_HUFFMAN_ONLY:oj,Z_RLE:JXe,Z_FIXED:QXe,Z_DEFAULT_STRATEGY:ZXe,Z_UNKNOWN:eYe,Z_DEFLATED:I5}=k1,tYe=9,rYe=15,nYe=8,aYe=29,oYe=256,OT=oYe+1+aYe,sYe=30,iYe=19,lYe=2*OT+1,cYe=15,qa=3,Km=258,Ku=Km+qa+1,dYe=32,Jx=42,QM=57,TT=69,DT=73,MT=91,RT=103,kp=113,ky=666,vl=1,I0=2,hg=3,O0=4,uYe=3,Ip=(e,t)=>(e.msg=Yx[t],t),Oz=e=>e*2-(e>4?9:0),Rm=e=>{let t=e.length;for(;--t>=0;)e[t]=0},fYe=e=>{let t,r,n,o=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=o?r-o:0;while(--t);t=o,n=t;do r=e.prev[--n],e.prev[n]=r>=o?r-o:0;while(--t)};let mYe=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,hh=mYe;const mc=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Sc=(e,t)=>{VXe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,mc(e.strm)},to=(e,t)=>{e.pending_buf[e.pending++]=t},hy=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},LT=(e,t,r,n)=>{let o=e.avail_in;return o>n&&(o=n),o===0?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),r),e.state.wrap===1?e.adler=Bw(e.adler,t,o,r):e.state.wrap===2&&(e.adler=ai(e.adler,t,o,r)),e.next_in+=o,e.total_in+=o,o)},jne=(e,t)=>{let r=e.max_chain_length,n=e.strstart,o,s,i=e.prev_length,l=e.nice_match;const c=e.strstart>e.w_size-Ku?e.strstart-(e.w_size-Ku):0,d=e.window,u=e.w_mask,f=e.prev,h=e.strstart+Km;let m=d[n+i-1],v=d[n+i];e.prev_length>=e.good_match&&(r>>=2),l>e.lookahead&&(l=e.lookahead);do if(o=t,!(d[o+i]!==v||d[o+i-1]!==m||d[o]!==d[n]||d[++o]!==d[n+1])){n+=2,o++;do;while(d[++n]===d[++o]&&d[++n]===d[++o]&&d[++n]===d[++o]&&d[++n]===d[++o]&&d[++n]===d[++o]&&d[++n]===d[++o]&&d[++n]===d[++o]&&d[++n]===d[++o]&&n<h);if(s=Km-(h-n),n=h-Km,s>i){if(e.match_start=t,i=s,s>=l)break;m=d[n+i-1],v=d[n+i]}}while((t=f[t&u])>c&&--r!==0);return i<=e.lookahead?i:e.lookahead},Qx=e=>{const t=e.w_size;let r,n,o;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Ku)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),fYe(e),n+=t),e.strm.avail_in===0)break;if(r=LT(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=qa)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=hh(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=hh(e,e.ins_h,e.window[o+qa-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<qa)););}while(e.lookahead<Ku&&e.strm.avail_in!==0)},_ne=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,o,s,i=0,l=e.strm.avail_in;do{if(n=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s||(s=e.strm.avail_out-s,o=e.strstart-e.block_start,n>o+e.strm.avail_in&&(n=o+e.strm.avail_in),n>s&&(n=s),n<r&&(n===0&&t!==dd||t===mh||n!==o+e.strm.avail_in)))break;i=t===dd&&n===o+e.strm.avail_in?1:0,IT(e,0,0,i),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,mc(e.strm),o&&(o>n&&(o=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+o),e.strm.next_out),e.strm.next_out+=o,e.strm.avail_out-=o,e.strm.total_out+=o,e.block_start+=o,n-=o),n&&(LT(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(i===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?O0:t!==mh&&t!==dd&&e.strm.avail_in===0&&e.strstart===e.block_start?I0:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(LT(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s,r=s>e.w_size?e.w_size:s,o=e.strstart-e.block_start,(o>=r||(o||t===dd)&&t!==mh&&e.strm.avail_in===0&&o<=s)&&(n=o>s?s:o,i=t===dd&&e.strm.avail_in===0&&n===o?1:0,IT(e,e.block_start,n,i),e.block_start+=n,mc(e.strm)),i?hg:vl)},uE=(e,t)=>{let r,n;for(;;){if(e.lookahead<Ku){if(Qx(e),e.lookahead<Ku&&t===mh)return vl;if(e.lookahead===0)break}if(r=0,e.lookahead>=qa&&(e.ins_h=hh(e,e.ins_h,e.window[e.strstart+qa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Ku&&(e.match_length=jne(e,r)),e.match_length>=qa)if(n=fh(e,e.strstart-e.match_start,e.match_length-qa),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=qa){e.match_length--;do e.strstart++,e.ins_h=hh(e,e.ins_h,e.window[e.strstart+qa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=hh(e,e.ins_h,e.window[e.strstart+1]);else n=fh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Sc(e,!1),e.strm.avail_out===0))return vl}return e.insert=e.strstart<qa-1?e.strstart:qa-1,t===dd?(Sc(e,!0),e.strm.avail_out===0?hg:O0):e.sym_next&&(Sc(e,!1),e.strm.avail_out===0)?vl:I0},ev=(e,t)=>{let r,n,o;for(;;){if(e.lookahead<Ku){if(Qx(e),e.lookahead<Ku&&t===mh)return vl;if(e.lookahead===0)break}if(r=0,e.lookahead>=qa&&(e.ins_h=hh(e,e.ins_h,e.window[e.strstart+qa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=qa-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Ku&&(e.match_length=jne(e,r),e.match_length<=5&&(e.strategy===YXe||e.match_length===qa&&e.strstart-e.match_start>4096)&&(e.match_length=qa-1)),e.prev_length>=qa&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-qa,n=fh(e,e.strstart-1-e.prev_match,e.prev_length-qa),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=hh(e,e.ins_h,e.window[e.strstart+qa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=qa-1,e.strstart++,n&&(Sc(e,!1),e.strm.avail_out===0))return vl}else if(e.match_available){if(n=fh(e,0,e.window[e.strstart-1]),n&&Sc(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return vl}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=fh(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<qa-1?e.strstart:qa-1,t===dd?(Sc(e,!0),e.strm.avail_out===0?hg:O0):e.sym_next&&(Sc(e,!1),e.strm.avail_out===0)?vl:I0},hYe=(e,t)=>{let r,n,o,s;const i=e.window;for(;;){if(e.lookahead<=Km){if(Qx(e),e.lookahead<=Km&&t===mh)return vl;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=qa&&e.strstart>0&&(o=e.strstart-1,n=i[o],n===i[++o]&&n===i[++o]&&n===i[++o])){s=e.strstart+Km;do;while(n===i[++o]&&n===i[++o]&&n===i[++o]&&n===i[++o]&&n===i[++o]&&n===i[++o]&&n===i[++o]&&n===i[++o]&&o<s);e.match_length=Km-(s-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=qa?(r=fh(e,1,e.match_length-qa),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=fh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Sc(e,!1),e.strm.avail_out===0))return vl}return e.insert=0,t===dd?(Sc(e,!0),e.strm.avail_out===0?hg:O0):e.sym_next&&(Sc(e,!1),e.strm.avail_out===0)?vl:I0},pYe=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(Qx(e),e.lookahead===0)){if(t===mh)return vl;break}if(e.match_length=0,r=fh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Sc(e,!1),e.strm.avail_out===0))return vl}return e.insert=0,t===dd?(Sc(e,!0),e.strm.avail_out===0?hg:O0):e.sym_next&&(Sc(e,!1),e.strm.avail_out===0)?vl:I0};function ju(e,t,r,n,o){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=o}const Iy=[new ju(0,0,0,0,_ne),new ju(4,4,8,4,uE),new ju(4,5,16,8,uE),new ju(4,6,32,32,uE),new ju(4,4,16,16,ev),new ju(8,16,32,32,ev),new ju(8,16,128,128,ev),new ju(8,32,128,256,ev),new ju(32,128,258,1024,ev),new ju(32,258,258,4096,ev)],gYe=e=>{e.window_size=2*e.w_size,Rm(e.head),e.max_lazy_match=Iy[e.level].max_lazy,e.good_match=Iy[e.level].good_length,e.nice_match=Iy[e.level].nice_length,e.max_chain_length=Iy[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=qa-1,e.match_available=0,e.ins_h=0};function vYe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I5,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(lYe*2),this.dyn_dtree=new Uint16Array((2*sYe+1)*2),this.bl_tree=new Uint16Array((2*iYe+1)*2),Rm(this.dyn_ltree),Rm(this.dyn_dtree),Rm(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(cYe+1),this.heap=new Uint16Array(2*OT+1),Rm(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*OT+1),Rm(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const I1=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Jx&&t.status!==QM&&t.status!==TT&&t.status!==DT&&t.status!==MT&&t.status!==RT&&t.status!==kp&&t.status!==ky?1:0},Nne=e=>{if(I1(e))return Ip(e,Gu);e.total_in=e.total_out=0,e.data_type=eYe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?QM:t.wrap?Jx:kp,e.adler=t.wrap===2?0:1,t.last_flush=-2,UXe(t),Pi},Sne=e=>{const t=Nne(e);return t===Pi&&gYe(e.state),t},xYe=(e,t)=>I1(e)||e.state.wrap!==2?Gu:(e.state.gzhead=t,Pi),Cne=(e,t,r,n,o,s)=>{if(!e)return Gu;let i=1;if(t===XXe&&(t=6),n<0?(i=0,n=-n):n>15&&(i=2,n-=16),o<1||o>tYe||r!==I5||n<8||n>15||t<0||t>9||s<0||s>QXe||n===8&&i!==1)return Ip(e,Gu);n===8&&(n=9);const l=new vYe;return e.state=l,l.strm=e,l.status=Jx,l.wrap=i,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+qa-1)/qa),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=t,l.strategy=s,l.method=r,Sne(e)},yYe=(e,t)=>Cne(e,t,I5,rYe,nYe,ZXe),bYe=(e,t)=>{if(I1(e)||t>kz||t<0)return e?Ip(e,Gu):Gu;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===ky&&t!==dd)return Ip(e,e.avail_out===0?dE:Gu);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(mc(e),e.avail_out===0)return r.last_flush=-1,Pi}else if(e.avail_in===0&&Oz(t)<=Oz(n)&&t!==dd)return Ip(e,dE);if(r.status===ky&&e.avail_in!==0)return Ip(e,dE);if(r.status===Jx&&r.wrap===0&&(r.status=kp),r.status===Jx){let o=I5+(r.w_bits-8<<4)<<8,s=-1;if(r.strategy>=oj||r.level<2?s=0:r.level<6?s=1:r.level===6?s=2:s=3,o|=s<<6,r.strstart!==0&&(o|=dYe),o+=31-o%31,hy(r,o),r.strstart!==0&&(hy(r,e.adler>>>16),hy(r,e.adler&65535)),e.adler=1,r.status=kp,mc(e),r.pending!==0)return r.last_flush=-1,Pi}if(r.status===QM){if(e.adler=0,to(r,31),to(r,139),to(r,8),r.gzhead)to(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),to(r,r.gzhead.time&255),to(r,r.gzhead.time>>8&255),to(r,r.gzhead.time>>16&255),to(r,r.gzhead.time>>24&255),to(r,r.level===9?2:r.strategy>=oj||r.level<2?4:0),to(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(to(r,r.gzhead.extra.length&255),to(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=ai(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=TT;else if(to(r,0),to(r,0),to(r,0),to(r,0),to(r,0),to(r,r.level===9?2:r.strategy>=oj||r.level<2?4:0),to(r,uYe),r.status=kp,mc(e),r.pending!==0)return r.last_flush=-1,Pi}if(r.status===TT){if(r.gzhead.extra){let o=r.pending,s=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+s>r.pending_buf_size;){let l=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+l),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>o&&(e.adler=ai(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex+=l,mc(e),r.pending!==0)return r.last_flush=-1,Pi;o=0,s-=l}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+s),r.pending),r.pending+=s,r.gzhead.hcrc&&r.pending>o&&(e.adler=ai(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex=0}r.status=DT}if(r.status===DT){if(r.gzhead.name){let o=r.pending,s;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>o&&(e.adler=ai(e.adler,r.pending_buf,r.pending-o,o)),mc(e),r.pending!==0)return r.last_flush=-1,Pi;o=0}r.gzindex<r.gzhead.name.length?s=r.gzhead.name.charCodeAt(r.gzindex++)&255:s=0,to(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>o&&(e.adler=ai(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex=0}r.status=MT}if(r.status===MT){if(r.gzhead.comment){let o=r.pending,s;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>o&&(e.adler=ai(e.adler,r.pending_buf,r.pending-o,o)),mc(e),r.pending!==0)return r.last_flush=-1,Pi;o=0}r.gzindex<r.gzhead.comment.length?s=r.gzhead.comment.charCodeAt(r.gzindex++)&255:s=0,to(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>o&&(e.adler=ai(e.adler,r.pending_buf,r.pending-o,o))}r.status=RT}if(r.status===RT){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(mc(e),r.pending!==0))return r.last_flush=-1,Pi;to(r,e.adler&255),to(r,e.adler>>8&255),e.adler=0}if(r.status=kp,mc(e),r.pending!==0)return r.last_flush=-1,Pi}if(e.avail_in!==0||r.lookahead!==0||t!==mh&&r.status!==ky){let o=r.level===0?_ne(r,t):r.strategy===oj?pYe(r,t):r.strategy===JXe?hYe(r,t):Iy[r.level].func(r,t);if((o===hg||o===O0)&&(r.status=ky),o===vl||o===hg)return e.avail_out===0&&(r.last_flush=-1),Pi;if(o===I0&&(t===HXe?WXe(r):t!==kz&&(IT(r,0,0,!1),t===GXe&&(Rm(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),mc(e),e.avail_out===0))return r.last_flush=-1,Pi}return t!==dd?Pi:r.wrap<=0?Iz:(r.wrap===2?(to(r,e.adler&255),to(r,e.adler>>8&255),to(r,e.adler>>16&255),to(r,e.adler>>24&255),to(r,e.total_in&255),to(r,e.total_in>>8&255),to(r,e.total_in>>16&255),to(r,e.total_in>>24&255)):(hy(r,e.adler>>>16),hy(r,e.adler&65535)),mc(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Pi:Iz)},wYe=e=>{if(I1(e))return Gu;const t=e.state.status;return e.state=null,t===kp?Ip(e,KXe):Pi},jYe=(e,t)=>{let r=t.length;if(I1(e))return Gu;const n=e.state,o=n.wrap;if(o===2||o===1&&n.status!==Jx||n.lookahead)return Gu;if(o===1&&(e.adler=Bw(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){o===0&&(Rm(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(t.subarray(r-n.w_size,r),0),t=c,r=n.w_size}const s=e.avail_in,i=e.next_in,l=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Qx(n);n.lookahead>=qa;){let c=n.strstart,d=n.lookahead-(qa-1);do n.ins_h=hh(n,n.ins_h,n.window[c+qa-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--d);n.strstart=c,n.lookahead=qa-1,Qx(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=qa-1,n.match_available=0,e.next_in=i,e.input=l,e.avail_in=s,n.wrap=o,Pi};var _Ye=yYe,NYe=Cne,SYe=Sne,CYe=Nne,PYe=xYe,AYe=bYe,EYe=wYe,kYe=jYe,IYe="pako deflate (from Nodeca project)",ub={deflateInit:_Ye,deflateInit2:NYe,deflateReset:SYe,deflateResetKeep:CYe,deflateSetHeader:PYe,deflate:AYe,deflateEnd:EYe,deflateSetDictionary:kYe,deflateInfo:IYe};const OYe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var TYe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)OYe(r,n)&&(e[n]=r[n])}}return e},DYe=e=>{let t=0;for(let n=0,o=e.length;n<o;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,o=0,s=e.length;n<s;n++){let i=e[n];r.set(i,o),o+=i.length}return r},O5={assign:TYe,flattenChunks:DYe};let Pne=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Pne=!1}const qw=new Uint8Array(256);for(let e=0;e<256;e++)qw[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;qw[254]=qw[254]=1;var MYe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,o,s,i=e.length,l=0;for(o=0;o<i;o++)r=e.charCodeAt(o),(r&64512)===55296&&o+1<i&&(n=e.charCodeAt(o+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),o++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),s=0,o=0;s<l;o++)r=e.charCodeAt(o),(r&64512)===55296&&o+1<i&&(n=e.charCodeAt(o+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),o++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const RYe=(e,t)=>{if(t<65534&&e.subarray&&Pne)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var LYe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,o;const s=new Array(r*2);for(o=0,n=0;n<r;){let i=e[n++];if(i<128){s[o++]=i;continue}let l=qw[i];if(l>4){s[o++]=65533,n+=l-1;continue}for(i&=l===2?31:l===3?15:7;l>1&&n<r;)i=i<<6|e[n++]&63,l--;if(l>1){s[o++]=65533;continue}i<65536?s[o++]=i:(i-=65536,s[o++]=55296|i>>10&1023,s[o++]=56320|i&1023)}return RYe(s,o)},FYe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+qw[e[r]]>t?r:t},zw={string2buf:MYe,buf2string:LYe,utf8border:FYe};function $Ye(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ane=$Ye;const Ene=Object.prototype.toString,{Z_NO_FLUSH:BYe,Z_SYNC_FLUSH:qYe,Z_FULL_FLUSH:zYe,Z_FINISH:UYe,Z_OK:hS,Z_STREAM_END:VYe,Z_DEFAULT_COMPRESSION:WYe,Z_DEFAULT_STRATEGY:HYe,Z_DEFLATED:GYe}=k1;function ZM(e){this.options=O5.assign({level:WYe,method:GYe,chunkSize:16384,windowBits:15,memLevel:8,strategy:HYe},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ane,this.strm.avail_out=0;let r=ub.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==hS)throw new Error(Yx[r]);if(t.header&&ub.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=zw.string2buf(t.dictionary):Ene.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=ub.deflateSetDictionary(this.strm,n),r!==hS)throw new Error(Yx[r]);this._dict_set=!0}}ZM.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let o,s;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?UYe:BYe,typeof e=="string"?r.input=zw.string2buf(e):Ene.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(s===qYe||s===zYe)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(o=ub.deflate(r,s),o===VYe)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),o=ub.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===hS;if(r.avail_out===0){this.onData(r.output);continue}if(s>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};ZM.prototype.onData=function(e){this.chunks.push(e)};ZM.prototype.onEnd=function(e){e===hS&&(this.result=O5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const sj=16209,KYe=16191;var XYe=function(t,r){let n,o,s,i,l,c,d,u,f,h,m,v,g,y,x,b,w,j,_,C,E,A,P,F;const M=t.state;n=t.next_in,P=t.input,o=n+(t.avail_in-5),s=t.next_out,F=t.output,i=s-(r-t.avail_out),l=s+(t.avail_out-257),c=M.dmax,d=M.wsize,u=M.whave,f=M.wnext,h=M.window,m=M.hold,v=M.bits,g=M.lencode,y=M.distcode,x=(1<<M.lenbits)-1,b=(1<<M.distbits)-1;e:do{v<15&&(m+=P[n++]<<v,v+=8,m+=P[n++]<<v,v+=8),w=g[m&x];t:for(;;){if(j=w>>>24,m>>>=j,v-=j,j=w>>>16&255,j===0)F[s++]=w&65535;else if(j&16){_=w&65535,j&=15,j&&(v<j&&(m+=P[n++]<<v,v+=8),_+=m&(1<<j)-1,m>>>=j,v-=j),v<15&&(m+=P[n++]<<v,v+=8,m+=P[n++]<<v,v+=8),w=y[m&b];r:for(;;){if(j=w>>>24,m>>>=j,v-=j,j=w>>>16&255,j&16){if(C=w&65535,j&=15,v<j&&(m+=P[n++]<<v,v+=8,v<j&&(m+=P[n++]<<v,v+=8)),C+=m&(1<<j)-1,C>c){t.msg="invalid distance too far back",M.mode=sj;break e}if(m>>>=j,v-=j,j=s-i,C>j){if(j=C-j,j>u&&M.sane){t.msg="invalid distance too far back",M.mode=sj;break e}if(E=0,A=h,f===0){if(E+=d-j,j<_){_-=j;do F[s++]=h[E++];while(--j);E=s-C,A=F}}else if(f<j){if(E+=d+f-j,j-=f,j<_){_-=j;do F[s++]=h[E++];while(--j);if(E=0,f<_){j=f,_-=j;do F[s++]=h[E++];while(--j);E=s-C,A=F}}}else if(E+=f-j,j<_){_-=j;do F[s++]=h[E++];while(--j);E=s-C,A=F}for(;_>2;)F[s++]=A[E++],F[s++]=A[E++],F[s++]=A[E++],_-=3;_&&(F[s++]=A[E++],_>1&&(F[s++]=A[E++]))}else{E=s-C;do F[s++]=F[E++],F[s++]=F[E++],F[s++]=F[E++],_-=3;while(_>2);_&&(F[s++]=F[E++],_>1&&(F[s++]=F[E++]))}}else if(j&64){t.msg="invalid distance code",M.mode=sj;break e}else{w=y[(w&65535)+(m&(1<<j)-1)];continue r}break}}else if(j&64)if(j&32){M.mode=KYe;break e}else{t.msg="invalid literal/length code",M.mode=sj;break e}else{w=g[(w&65535)+(m&(1<<j)-1)];continue t}break}}while(n<o&&s<l);_=v>>3,n-=_,v-=_<<3,m&=(1<<v)-1,t.next_in=n,t.next_out=s,t.avail_in=n<o?5+(o-n):5-(n-o),t.avail_out=s<l?257+(l-s):257-(s-l),M.hold=m,M.bits=v};const tv=15,Tz=852,Dz=592,Mz=0,fE=1,Rz=2,YYe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),JYe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),QYe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ZYe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),eJe=(e,t,r,n,o,s,i,l)=>{const c=l.bits;let d=0,u=0,f=0,h=0,m=0,v=0,g=0,y=0,x=0,b=0,w,j,_,C,E,A=null,P;const F=new Uint16Array(tv+1),M=new Uint16Array(tv+1);let I=null,R,D,U;for(d=0;d<=tv;d++)F[d]=0;for(u=0;u<n;u++)F[t[r+u]]++;for(m=c,h=tv;h>=1&&F[h]===0;h--);if(m>h&&(m=h),h===0)return o[s++]=1<<24|64<<16|0,o[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<h&&F[f]===0;f++);for(m<f&&(m=f),y=1,d=1;d<=tv;d++)if(y<<=1,y-=F[d],y<0)return-1;if(y>0&&(e===Mz||h!==1))return-1;for(M[1]=0,d=1;d<tv;d++)M[d+1]=M[d]+F[d];for(u=0;u<n;u++)t[r+u]!==0&&(i[M[t[r+u]]++]=u);if(e===Mz?(A=I=i,P=20):e===fE?(A=YYe,I=JYe,P=257):(A=QYe,I=ZYe,P=0),b=0,u=0,d=f,E=s,v=m,g=0,_=-1,x=1<<m,C=x-1,e===fE&&x>Tz||e===Rz&&x>Dz)return 1;for(;;){R=d-g,i[u]+1<P?(D=0,U=i[u]):i[u]>=P?(D=I[i[u]-P],U=A[i[u]-P]):(D=32+64,U=0),w=1<<d-g,j=1<<v,f=j;do j-=w,o[E+(b>>g)+j]=R<<24|D<<16|U|0;while(j!==0);for(w=1<<d-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,u++,--F[d]===0){if(d===h)break;d=t[r+i[u]]}if(d>m&&(b&C)!==_){for(g===0&&(g=m),E+=f,v=d-g,y=1<<v;v+g<h&&(y-=F[v+g],!(y<=0));)v++,y<<=1;if(x+=1<<v,e===fE&&x>Tz||e===Rz&&x>Dz)return 1;_=b&C,o[_]=m<<24|v<<16|E-s|0}}return b!==0&&(o[E+b]=d-g<<24|64<<16|0),l.bits=m,0};var fb=eJe;const tJe=0,kne=1,Ine=2,{Z_FINISH:Lz,Z_BLOCK:rJe,Z_TREES:ij,Z_OK:pg,Z_STREAM_END:nJe,Z_NEED_DICT:aJe,Z_STREAM_ERROR:Cd,Z_DATA_ERROR:One,Z_MEM_ERROR:Tne,Z_BUF_ERROR:oJe,Z_DEFLATED:Fz}=k1,T5=16180,$z=16181,Bz=16182,qz=16183,zz=16184,Uz=16185,Vz=16186,Wz=16187,Hz=16188,Gz=16189,pS=16190,mf=16191,mE=16192,Kz=16193,hE=16194,Xz=16195,Yz=16196,Jz=16197,Qz=16198,lj=16199,cj=16200,Zz=16201,e9=16202,t9=16203,r9=16204,n9=16205,pE=16206,a9=16207,o9=16208,Ho=16209,Dne=16210,Mne=16211,sJe=852,iJe=592,lJe=15,cJe=lJe,s9=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function dJe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ig=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<T5||t.mode>Mne?1:0},Rne=e=>{if(Ig(e))return Cd;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=T5,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(sJe),t.distcode=t.distdyn=new Int32Array(iJe),t.sane=1,t.back=-1,pg},Lne=e=>{if(Ig(e))return Cd;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Rne(e)},Fne=(e,t)=>{let r;if(Ig(e))return Cd;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Cd:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Lne(e))},$ne=(e,t)=>{if(!e)return Cd;const r=new dJe;e.state=r,r.strm=e,r.window=null,r.mode=T5;const n=Fne(e,t);return n!==pg&&(e.state=null),n},uJe=e=>$ne(e,cJe);let i9=!0,gE,vE;const fJe=e=>{if(i9){gE=new Int32Array(512),vE=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(fb(kne,e.lens,0,288,gE,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;fb(Ine,e.lens,0,32,vE,0,e.work,{bits:5}),i9=!1}e.lencode=gE,e.lenbits=9,e.distcode=vE,e.distbits=5},Bne=(e,t,r,n)=>{let o;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(o=s.wsize-s.wnext,o>n&&(o=n),s.window.set(t.subarray(r-n,r-n+o),s.wnext),n-=o,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0},mJe=(e,t)=>{let r,n,o,s,i,l,c,d,u,f,h,m,v,g,y=0,x,b,w,j,_,C,E,A;const P=new Uint8Array(4);let F,M;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ig(e)||!e.output||!e.input&&e.avail_in!==0)return Cd;r=e.state,r.mode===mf&&(r.mode=mE),i=e.next_out,o=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,f=l,h=c,A=pg;e:for(;;)switch(r.mode){case T5:if(r.wrap===0){r.mode=mE;break}for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,P[0]=d&255,P[1]=d>>>8&255,r.check=ai(r.check,P,2,0),d=0,u=0,r.mode=$z;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=Ho;break}if((d&15)!==Fz){e.msg="unknown compression method",r.mode=Ho;break}if(d>>>=4,u-=4,E=(d&15)+8,r.wbits===0&&(r.wbits=E),E>15||E>r.wbits){e.msg="invalid window size",r.mode=Ho;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?Gz:mf,d=0,u=0;break;case $z:for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.flags=d,(r.flags&255)!==Fz){e.msg="unknown compression method",r.mode=Ho;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Ho;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(P[0]=d&255,P[1]=d>>>8&255,r.check=ai(r.check,P,2,0)),d=0,u=0,r.mode=Bz;case Bz:for(;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(P[0]=d&255,P[1]=d>>>8&255,P[2]=d>>>16&255,P[3]=d>>>24&255,r.check=ai(r.check,P,4,0)),d=0,u=0,r.mode=qz;case qz:for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(P[0]=d&255,P[1]=d>>>8&255,r.check=ai(r.check,P,2,0)),d=0,u=0,r.mode=zz;case zz:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(P[0]=d&255,P[1]=d>>>8&255,r.check=ai(r.check,P,2,0)),d=0,u=0}else r.head&&(r.head.extra=null);r.mode=Uz;case Uz:if(r.flags&1024&&(m=r.length,m>l&&(m=l),m&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+m),E)),r.flags&512&&r.wrap&4&&(r.check=ai(r.check,n,m,s)),l-=m,s+=m,r.length-=m),r.length))break e;r.length=0,r.mode=Vz;case Vz:if(r.flags&2048){if(l===0)break e;m=0;do E=n[s+m++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E));while(E&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=ai(r.check,n,m,s)),l-=m,s+=m,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Wz;case Wz:if(r.flags&4096){if(l===0)break e;m=0;do E=n[s+m++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E));while(E&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=ai(r.check,n,m,s)),l-=m,s+=m,E)break e}else r.head&&(r.head.comment=null);r.mode=Hz;case Hz:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Ho;break}d=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=mf;break;case Gz:for(;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}e.adler=r.check=s9(d),d=0,u=0,r.mode=pS;case pS:if(r.havedict===0)return e.next_out=i,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=d,r.bits=u,aJe;e.adler=r.check=1,r.mode=mf;case mf:if(t===rJe||t===ij)break e;case mE:if(r.last){d>>>=u&7,u-=u&7,r.mode=pE;break}for(;u<3;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}switch(r.last=d&1,d>>>=1,u-=1,d&3){case 0:r.mode=Kz;break;case 1:if(fJe(r),r.mode=lj,t===ij){d>>>=2,u-=2;break e}break;case 2:r.mode=Yz;break;case 3:e.msg="invalid block type",r.mode=Ho}d>>>=2,u-=2;break;case Kz:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Ho;break}if(r.length=d&65535,d=0,u=0,r.mode=hE,t===ij)break e;case hE:r.mode=Xz;case Xz:if(m=r.length,m){if(m>l&&(m=l),m>c&&(m=c),m===0)break e;o.set(n.subarray(s,s+m),i),l-=m,s+=m,c-=m,i+=m,r.length-=m;break}r.mode=mf;break;case Yz:for(;u<14;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.nlen=(d&31)+257,d>>>=5,u-=5,r.ndist=(d&31)+1,d>>>=5,u-=5,r.ncode=(d&15)+4,d>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Ho;break}r.have=0,r.mode=Jz;case Jz:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.lens[I[r.have++]]=d&7,d>>>=3,u-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,F={bits:r.lenbits},A=fb(tJe,r.lens,0,19,r.lencode,0,r.work,F),r.lenbits=F.bits,A){e.msg="invalid code lengths set",r.mode=Ho;break}r.have=0,r.mode=Qz;case Qz:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[d&(1<<r.lenbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(w<16)d>>>=x,u-=x,r.lens[r.have++]=w;else{if(w===16){for(M=x+2;u<M;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(d>>>=x,u-=x,r.have===0){e.msg="invalid bit length repeat",r.mode=Ho;break}E=r.lens[r.have-1],m=3+(d&3),d>>>=2,u-=2}else if(w===17){for(M=x+3;u<M;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=x,u-=x,E=0,m=3+(d&7),d>>>=3,u-=3}else{for(M=x+7;u<M;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=x,u-=x,E=0,m=11+(d&127),d>>>=7,u-=7}if(r.have+m>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Ho;break}for(;m--;)r.lens[r.have++]=E}}if(r.mode===Ho)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Ho;break}if(r.lenbits=9,F={bits:r.lenbits},A=fb(kne,r.lens,0,r.nlen,r.lencode,0,r.work,F),r.lenbits=F.bits,A){e.msg="invalid literal/lengths set",r.mode=Ho;break}if(r.distbits=6,r.distcode=r.distdyn,F={bits:r.distbits},A=fb(Ine,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,F),r.distbits=F.bits,A){e.msg="invalid distances set",r.mode=Ho;break}if(r.mode=lj,t===ij)break e;case lj:r.mode=cj;case cj:if(l>=6&&c>=258){e.next_out=i,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=d,r.bits=u,XYe(e,h),i=e.next_out,o=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,r.mode===mf&&(r.back=-1);break}for(r.back=0;y=r.lencode[d&(1<<r.lenbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(b&&!(b&240)){for(j=x,_=b,C=w;y=r.lencode[C+((d&(1<<j+_)-1)>>j)],x=y>>>24,b=y>>>16&255,w=y&65535,!(j+x<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=x,u-=x,r.back+=x,r.length=w,b===0){r.mode=n9;break}if(b&32){r.back=-1,r.mode=mf;break}if(b&64){e.msg="invalid literal/length code",r.mode=Ho;break}r.extra=b&15,r.mode=Zz;case Zz:if(r.extra){for(M=r.extra;u<M;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=e9;case e9:for(;y=r.distcode[d&(1<<r.distbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(!(b&240)){for(j=x,_=b,C=w;y=r.distcode[C+((d&(1<<j+_)-1)>>j)],x=y>>>24,b=y>>>16&255,w=y&65535,!(j+x<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=x,u-=x,r.back+=x,b&64){e.msg="invalid distance code",r.mode=Ho;break}r.offset=w,r.extra=b&15,r.mode=t9;case t9:if(r.extra){for(M=r.extra;u<M;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Ho;break}r.mode=r9;case r9:if(c===0)break e;if(m=h-c,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Ho;break}m>r.wnext?(m-=r.wnext,v=r.wsize-m):v=r.wnext-m,m>r.length&&(m=r.length),g=r.window}else g=o,v=i-r.offset,m=r.length;m>c&&(m=c),c-=m,r.length-=m;do o[i++]=g[v++];while(--m);r.length===0&&(r.mode=cj);break;case n9:if(c===0)break e;o[i++]=r.length,c--,r.mode=cj;break;case pE:if(r.wrap){for(;u<32;){if(l===0)break e;l--,d|=n[s++]<<u,u+=8}if(h-=c,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?ai(r.check,o,h,i-h):Bw(r.check,o,h,i-h)),h=c,r.wrap&4&&(r.flags?d:s9(d))!==r.check){e.msg="incorrect data check",r.mode=Ho;break}d=0,u=0}r.mode=a9;case a9:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Ho;break}d=0,u=0}r.mode=o9;case o9:A=nJe;break e;case Ho:A=One;break e;case Dne:return Tne;case Mne:default:return Cd}return e.next_out=i,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=d,r.bits=u,(r.wsize||h!==e.avail_out&&r.mode<Ho&&(r.mode<pE||t!==Lz))&&Bne(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?ai(r.check,o,h,e.next_out-h):Bw(r.check,o,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===mf?128:0)+(r.mode===lj||r.mode===hE?256:0),(f===0&&h===0||t===Lz)&&A===pg&&(A=oJe),A},hJe=e=>{if(Ig(e))return Cd;let t=e.state;return t.window&&(t.window=null),e.state=null,pg},pJe=(e,t)=>{if(Ig(e))return Cd;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,pg):Cd},gJe=(e,t)=>{const r=t.length;let n,o,s;return Ig(e)||(n=e.state,n.wrap!==0&&n.mode!==pS)?Cd:n.mode===pS&&(o=1,o=Bw(o,t,r,0),o!==n.check)?One:(s=Bne(e,t,r,r),s?(n.mode=Dne,Tne):(n.havedict=1,pg))};var vJe=Lne,xJe=Fne,yJe=Rne,bJe=uJe,wJe=$ne,jJe=mJe,_Je=hJe,NJe=pJe,SJe=gJe,CJe="pako inflate (from Nodeca project)",jf={inflateReset:vJe,inflateReset2:xJe,inflateResetKeep:yJe,inflateInit:bJe,inflateInit2:wJe,inflate:jJe,inflateEnd:_Je,inflateGetHeader:NJe,inflateSetDictionary:SJe,inflateInfo:CJe};function PJe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var AJe=PJe;const qne=Object.prototype.toString,{Z_NO_FLUSH:EJe,Z_FINISH:kJe,Z_OK:Uw,Z_STREAM_END:xE,Z_NEED_DICT:yE,Z_STREAM_ERROR:IJe,Z_DATA_ERROR:l9,Z_MEM_ERROR:OJe}=k1;function O1(e){this.options=O5.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ane,this.strm.avail_out=0;let r=jf.inflateInit2(this.strm,t.windowBits);if(r!==Uw)throw new Error(Yx[r]);if(this.header=new AJe,jf.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=zw.string2buf(t.dictionary):qne.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=jf.inflateSetDictionary(this.strm,t.dictionary),r!==Uw)))throw new Error(Yx[r])}O1.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,o=this.options.dictionary;let s,i,l;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?kJe:EJe,qne.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=jf.inflate(r,i),s===yE&&o&&(s=jf.inflateSetDictionary(r,o),s===Uw?s=jf.inflate(r,i):s===l9&&(s=yE));r.avail_in>0&&s===xE&&r.state.wrap>0&&e[r.next_in]!==0;)jf.inflateReset(r),s=jf.inflate(r,i);switch(s){case IJe:case l9:case yE:case OJe:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===xE))if(this.options.to==="string"){let c=zw.utf8border(r.output,r.next_out),d=r.next_out-c,u=zw.buf2string(r.output,c);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===Uw&&l===0)){if(s===xE)return s=jf.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};O1.prototype.onData=function(e){this.chunks.push(e)};O1.prototype.onEnd=function(e){e===Uw&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=O5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function eR(e,t){const r=new O1(t);if(r.push(e),r.err)throw r.msg||Yx[r.err];return r.result}function TJe(e,t){return t=t||{},t.raw=!0,eR(e,t)}var DJe=O1,MJe=eR,RJe=TJe,LJe=eR,FJe=k1,$Je={Inflate:DJe,inflate:MJe,inflateRaw:RJe,ungzip:LJe,constants:FJe};const{Inflate:BJe,inflate:qJe,inflateRaw:Qlt,ungzip:Zlt}=$Je;var c9=BJe,zJe=qJe;const zne=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;zne[e]=t}const d9=4294967295;function UJe(e,t,r){let n=e;for(let o=0;o<r;o++)n=zne[(n^t[o])&255]^n>>>8;return n}function VJe(e,t){return(UJe(d9,e,t)^d9)>>>0}function u9(e,t,r){const n=e.readUint32(),o=VJe(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(o!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${o}`)}function Une(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function Vne(e,t,r,n){let o=0;for(;o<n;o++)t[o]=e[o];for(;o<r;o++)t[o]=e[o]+t[o-n]&255}function Wne(e,t,r,n){let o=0;if(r.length===0)for(;o<n;o++)t[o]=e[o];else for(;o<n;o++)t[o]=e[o]+r[o]&255}function Hne(e,t,r,n,o){let s=0;if(r.length===0){for(;s<o;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-o]>>1)&255}else{for(;s<o;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-o]+r[s]>>1)&255}}function Gne(e,t,r,n,o){let s=0;if(r.length===0){for(;s<o;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-o]&255}else{for(;s<o;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+WJe(t[s-o],r[s],r[s-o])&255}}function WJe(e,t,r){const n=e+t-r,o=Math.abs(n-e),s=Math.abs(n-t),i=Math.abs(n-r);return o<=s&&o<=i?e:s<=i?t:r}function HJe(e,t,r,n,o,s){switch(e){case 0:Une(t,r,o);break;case 1:Vne(t,r,o,s);break;case 2:Wne(t,r,n,o);break;case 3:Hne(t,r,n,o,s);break;case 4:Gne(t,r,n,o,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const GJe=new Uint16Array([255]),KJe=new Uint8Array(GJe.buffer),XJe=KJe[0]===255;function YJe(e){const{data:t,width:r,height:n,channels:o,depth:s}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*o,c=new Uint8Array(n*r*l);let d=0;for(let u=0;u<7;u++){const f=i[u],h=Math.ceil((r-f.x)/f.xStep),m=Math.ceil((n-f.y)/f.yStep);if(h<=0||m<=0)continue;const v=h*l,g=new Uint8Array(v);for(let y=0;y<m;y++){const x=t[d++],b=t.subarray(d,d+v);d+=v;const w=new Uint8Array(v);HJe(x,b,w,g,v,l),g.set(w);for(let j=0;j<h;j++){const _=f.x+j*f.xStep,C=f.y+y*f.yStep;if(!(_>=r||C>=n))for(let E=0;E<l;E++)c[(C*r+_)*l+E]=w[j*l+E]}}}if(s===16){const u=new Uint16Array(c.buffer);if(XJe)for(let f=0;f<u.length;f++)u[f]=JJe(u[f]);return u}else return c}function JJe(e){return(e&255)<<8|e>>8&255}const QJe=new Uint16Array([255]),ZJe=new Uint8Array(QJe.buffer),eQe=ZJe[0]===255,tQe=new Uint8Array(0);function f9(e){const{data:t,width:r,height:n,channels:o,depth:s}=e,i=Math.ceil(s/8)*o,l=Math.ceil(s/8*o*r),c=new Uint8Array(n*l);let d=tQe,u=0,f,h;for(let m=0;m<n;m++){switch(f=t.subarray(u+1,u+1+l),h=c.subarray(m*l,(m+1)*l),t[u]){case 0:Une(f,h,l);break;case 1:Vne(f,h,l,i);break;case 2:Wne(f,h,d,l);break;case 3:Hne(f,h,d,l,i);break;case 4:Gne(f,h,d,l,i);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}d=h,u+=l+1}if(s===16){const m=new Uint16Array(c.buffer);if(eQe)for(let v=0;v<m.length;v++)m[v]=rQe(m[v]);return m}else return c}function rQe(e){return(e&255)<<8|e>>8&255}const Zj=Uint8Array.of(137,80,78,71,13,10,26,10);function m9(e){if(!nQe(e.readBytes(Zj.length)))throw new Error("wrong PNG signature")}function nQe(e){if(e.length<Zj.length)return!1;for(let t=0;t<Zj.length;t++)if(e[t]!==Zj[t])return!1;return!0}const aQe="tEXt",oQe=0,Kne=new TextDecoder("latin1");function sQe(e){if(lQe(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const iQe=/^[\u0000-\u00FF]*$/;function lQe(e){if(!iQe.test(e))throw new Error("invalid latin1 text")}function cQe(e,t,r){const n=Xne(t);e[n]=dQe(t,r-n.length-1)}function Xne(e){for(e.mark();e.readByte()!==oQe;);const t=e.offset;e.reset();const r=Kne.decode(e.readBytes(t-e.offset-1));return e.skip(1),sQe(r),r}function dQe(e,t){return Kne.decode(e.readBytes(t))}const cc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},bE={UNKNOWN:-1,DEFLATE:0},h9={UNKNOWN:-1,ADAPTIVE:0},wE={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},dj={NONE:0,BACKGROUND:1,PREVIOUS:2},jE={SOURCE:0,OVER:1};class uQe extends GM{constructor(r,n={}){super(r);lo(this,"_checkCrc");lo(this,"_inflator");lo(this,"_png");lo(this,"_apng");lo(this,"_end");lo(this,"_hasPalette");lo(this,"_palette");lo(this,"_hasTransparency");lo(this,"_transparency");lo(this,"_compressionMethod");lo(this,"_filterMethod");lo(this,"_interlaceMethod");lo(this,"_colorType");lo(this,"_isAnimated");lo(this,"_numberOfFrames");lo(this,"_numberOfPlays");lo(this,"_frames");lo(this,"_writingDataChunks");const{checkCrc:o=!1}=n;this._checkCrc=o,this._inflator=new c9,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=bE.UNKNOWN,this._filterMethod=h9.UNKNOWN,this._interlaceMethod=wE.UNKNOWN,this._colorType=cc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(m9(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(m9(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const o=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case aQe:cQe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-o!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?u9(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const o=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=o+r;break}if(this.offset-o!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?u9(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=fQe(this.readUint8());const n=this.readUint8();this._colorType=n;let o;switch(n){case cc.GREYSCALE:o=1;break;case cc.TRUECOLOUR:o=3;break;case cc.INDEXED_COLOUR:o=1;break;case cc.GREYSCALE_ALPHA:o=2;break;case cc.TRUECOLOUR_ALPHA:o=4;break;case cc.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=o,this._compressionMethod=this.readUint8(),this._compressionMethod!==bE.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const o=[];this._palette=o;for(let s=0;s<n;s++)o.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,o=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,o,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,o=this.offset+this.byteOffset;if(o+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,o,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case cc.GREYSCALE:case cc.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case cc.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const o=this.readByte();this._palette[n].push(o)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case cc.UNKNOWN:case cc.GREYSCALE_ALPHA:case cc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Xne(this),o=this.readUint8();if(o!==bE.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${o}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:zJe(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),o=this.readByte();this._png.resolution={x:r,y:n,unit:o}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},o=this._frames.at(r);if(o){if(o.data=f9({data:o.data,width:o.width,height:o.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||o.xOffset===0&&o.yOffset===0&&o.width===this._png.width&&o.height===this._png.height)n.data=o.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(o,s,n),this.addFrameDataToCanvas(n,o)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,o){switch(r.disposeOp){case dj.NONE:break;case dj.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let i=0;i<this._png.width;i++){const l=(s*r.width+i)*this._png.channels;for(let c=0;c<this._png.channels;c++)o.data[l+c]=0}break;case dj.PREVIOUS:o.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const o=1<<this._png.depth,s=(i,l)=>{const c=((i+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,d=(i*n.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(n.blendOp){case jE.SOURCE:for(let i=0;i<n.height;i++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=s(i,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[d+u]}break;case jE.OVER:for(let i=0;i<n.height;i++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=s(i,l);for(let u=0;u<this._png.channels;u++){const f=n.data[d+this._png.channels-1]/o,h=u%(this._png.channels-1)===0?1:n.data[d+u],m=Math.floor(f*h+(1-f)*r.data[c+u]);r.data[c+u]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==h9.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===wE.NO_INTERLACE)this._png.data=f9({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===wE.ADAM7)this._png.data=YJe({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:dj.NONE,blendOp:jE.SOURCE,data:r}),this._inflator=new c9,this._writingDataChunks=!1}}function fQe(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var p9;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(p9||(p9={}));function mQe(e,t){return new uQe(e,t).decode()}var da=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function _E(){da.console&&typeof da.console.log=="function"&&da.console.log.apply(da.console,arguments)}var _o={log:_E,warn:function(e){da.console&&(typeof da.console.warn=="function"?da.console.warn.apply(da.console,arguments):_E.call(null,arguments))},error:function(e){da.console&&(typeof da.console.error=="function"?da.console.error.apply(da.console,arguments):_E(e))}};function NE(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){up(n.response,t,r)},n.onerror=function(){_o.error("could not download file")},n.send()}function g9(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function uj(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var up=da.saveAs||((typeof window>"u"?"undefined":Fa(window))!=="object"||window!==da?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=da.URL||da.webkitURL,o=document.createElement("a");t=t||e.name||"download",o.download=t,o.rel="noopener",typeof e=="string"?(o.href=e,o.origin!==location.origin?g9(o.href)?NE(e,t,r):uj(o,o.target="_blank"):uj(o)):(o.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(o.href)},4e4),setTimeout(function(){uj(o)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(g9(e))NE(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){uj(n)})}else navigator.msSaveOrOpenBlob(function(o,s){return s===void 0?s={autoBom:!1}:Fa(s)!=="object"&&(_o.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob([String.fromCharCode(65279),o],{type:o.type}):o}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return NE(e,t,r);var o=e.type==="application/octet-stream",s=/constructor/i.test(da.HTMLElement)||da.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||o&&s)&&(typeof FileReader>"u"?"undefined":Fa(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=i?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(e)}else{var c=da.URL||da.webkitURL,d=c.createObjectURL(e);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Yne(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var o=r[n].re,s=r[n].process,i=o.exec(e);i&&(t=s(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var e_=da.atob.bind(da),v9=da.btoa.bind(da);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function SE(e,t){var r=e[0],n=e[1],o=e[2],s=e[3];r=$i(r,n,o,s,t[0],7,-680876936),s=$i(s,r,n,o,t[1],12,-389564586),o=$i(o,s,r,n,t[2],17,606105819),n=$i(n,o,s,r,t[3],22,-1044525330),r=$i(r,n,o,s,t[4],7,-176418897),s=$i(s,r,n,o,t[5],12,1200080426),o=$i(o,s,r,n,t[6],17,-1473231341),n=$i(n,o,s,r,t[7],22,-45705983),r=$i(r,n,o,s,t[8],7,1770035416),s=$i(s,r,n,o,t[9],12,-1958414417),o=$i(o,s,r,n,t[10],17,-42063),n=$i(n,o,s,r,t[11],22,-1990404162),r=$i(r,n,o,s,t[12],7,1804603682),s=$i(s,r,n,o,t[13],12,-40341101),o=$i(o,s,r,n,t[14],17,-1502002290),r=Bi(r,n=$i(n,o,s,r,t[15],22,1236535329),o,s,t[1],5,-165796510),s=Bi(s,r,n,o,t[6],9,-1069501632),o=Bi(o,s,r,n,t[11],14,643717713),n=Bi(n,o,s,r,t[0],20,-373897302),r=Bi(r,n,o,s,t[5],5,-701558691),s=Bi(s,r,n,o,t[10],9,38016083),o=Bi(o,s,r,n,t[15],14,-660478335),n=Bi(n,o,s,r,t[4],20,-405537848),r=Bi(r,n,o,s,t[9],5,568446438),s=Bi(s,r,n,o,t[14],9,-1019803690),o=Bi(o,s,r,n,t[3],14,-187363961),n=Bi(n,o,s,r,t[8],20,1163531501),r=Bi(r,n,o,s,t[13],5,-1444681467),s=Bi(s,r,n,o,t[2],9,-51403784),o=Bi(o,s,r,n,t[7],14,1735328473),r=qi(r,n=Bi(n,o,s,r,t[12],20,-1926607734),o,s,t[5],4,-378558),s=qi(s,r,n,o,t[8],11,-2022574463),o=qi(o,s,r,n,t[11],16,1839030562),n=qi(n,o,s,r,t[14],23,-35309556),r=qi(r,n,o,s,t[1],4,-1530992060),s=qi(s,r,n,o,t[4],11,1272893353),o=qi(o,s,r,n,t[7],16,-155497632),n=qi(n,o,s,r,t[10],23,-1094730640),r=qi(r,n,o,s,t[13],4,681279174),s=qi(s,r,n,o,t[0],11,-358537222),o=qi(o,s,r,n,t[3],16,-722521979),n=qi(n,o,s,r,t[6],23,76029189),r=qi(r,n,o,s,t[9],4,-640364487),s=qi(s,r,n,o,t[12],11,-421815835),o=qi(o,s,r,n,t[15],16,530742520),r=zi(r,n=qi(n,o,s,r,t[2],23,-995338651),o,s,t[0],6,-198630844),s=zi(s,r,n,o,t[7],10,1126891415),o=zi(o,s,r,n,t[14],15,-1416354905),n=zi(n,o,s,r,t[5],21,-57434055),r=zi(r,n,o,s,t[12],6,1700485571),s=zi(s,r,n,o,t[3],10,-1894986606),o=zi(o,s,r,n,t[10],15,-1051523),n=zi(n,o,s,r,t[1],21,-2054922799),r=zi(r,n,o,s,t[8],6,1873313359),s=zi(s,r,n,o,t[15],10,-30611744),o=zi(o,s,r,n,t[6],15,-1560198380),n=zi(n,o,s,r,t[13],21,1309151649),r=zi(r,n,o,s,t[4],6,-145523070),s=zi(s,r,n,o,t[11],10,-1120210379),o=zi(o,s,r,n,t[2],15,718787259),n=zi(n,o,s,r,t[9],21,-343485551),e[0]=Xm(r,e[0]),e[1]=Xm(n,e[1]),e[2]=Xm(o,e[2]),e[3]=Xm(s,e[3])}function D5(e,t,r,n,o,s){return t=Xm(Xm(t,e),Xm(n,s)),Xm(t<<o|t>>>32-o,r)}function $i(e,t,r,n,o,s,i){return D5(t&r|~t&n,e,t,o,s,i)}function Bi(e,t,r,n,o,s,i){return D5(t&n|r&~n,e,t,o,s,i)}function qi(e,t,r,n,o,s,i){return D5(t^r^n,e,t,o,s,i)}function zi(e,t,r,n,o,s,i){return D5(r^(t|~n),e,t,o,s,i)}function Jne(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)SE(n,hQe(e.substring(t-64,t)));e=e.substring(t-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(SE(n,o),t=0;t<16;t++)o[t]=0;return o[14]=8*r,SE(n,o),n}function hQe(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var x9="0123456789abcdef".split("");function pQe(e){for(var t="",r=0;r<4;r++)t+=x9[e>>8*r+4&15]+x9[e>>8*r&15];return t}function gQe(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function FT(e){return Jne(e).map(gQe).join("")}var vQe=function(e){for(var t=0;t<e.length;t++)e[t]=pQe(e[t]);return e.join("")}(Jne("hello"))!="5d41402abc4b2a76b9719d911017c592";function Xm(e,t){if(vQe){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function $T(e,t){var r,n,o,s;if(e!==r){for(var i=(o=e,s=1+(256/e.length|0),new Array(s+1).join(o)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+i.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=e,n=l}else l=n;var f=t.length,h=0,m=0,v="";for(c=0;c<f;c++)m=(m+(u=l[h=(h+1)%256]))%256,l[h]=l[m],l[m]=u,i=l[(l[h]+l[m])%256],v+=String.fromCharCode(t.charCodeAt(c)^i);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var y9={print:4,modify:8,copy:16,"annot-forms":32};function hv(e,t,r,n){this.v=1,this.r=2;var o=192;e.forEach(function(l){if(y9.perm!==void 0)throw new Error("Invalid permission: "+l);o+=y9[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,i),this.P=-(1+(255^o)),this.encryptionKey=FT(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=$T(this.encryptionKey,this.padding)}function pv(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var o=e.charCodeAt(n);t+=o<33||o===35||o===37||o===40||o===41||o===47||o===60||o===62||o===91||o===93||o===123||o===125||o>126?"#"+("0"+o.toString(16)).slice(-2):e[n]}return t}function b9(e){if(Fa(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,o){if(o=o||!1,typeof r!="string"||typeof n!="function"||typeof o!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!o],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),o=[];for(var s in t[r]){var i=t[r][s];try{i[0].apply(e,n)}catch(l){da.console&&_o.error("jsPDF PubSub Error",l.message,l)}i[1]&&o.push(s)}o.length&&o.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Vw(e){if(!(this instanceof Vw))return new Vw(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Qne(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Lm(e,t,r,n,o){if(!(this instanceof Lm))return new Lm(e,t,r,n,o);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Qne.call(this,n,o)}function Op(e,t,r,n,o){if(!(this instanceof Op))return new Op(e,t,r,n,o);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Qne.call(this,n,o)}function Vn(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],o=arguments[2],s=arguments[3],i=[],l=1,c=16,d="S",u=null;Fa(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,o=e.format||o,s=e.compress||e.compressPdf||s,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),i=e.filters||(s===!0?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,h={},m={internal:{},__private__:{}};m.__private__.PubSub=b9;var v="1.3",g=m.__private__.getPdfVersion=function(){return v};m.__private__.setPdfVersion=function(S){v=S};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return y};var x=m.__private__.getPageFormat=function(S){return y[S]};o=o||"a4";var b="compat",w="advanced",j=b;function _(){this.saveGraphicsState(),ie(new pt(He,0,0,-He,0,Ut()*He).toString()+" cm"),this.setFontSize(this.getFontSize()/He),d="n",j=w}function C(){this.restoreGraphicsState(),d="S",j=b}var E=m.__private__.combineFontStyleAndFontWeight=function(S,K){if(S=="bold"&&K=="normal"||S=="bold"&&K==400||S=="normal"&&K=="italic"||S=="bold"&&K=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return K&&(S=K==400||K==="normal"?S==="italic"?"italic":"normal":K!=700&&K!=="bold"||S!=="normal"?(K==700?"bold":K)+""+S:"bold"),S};m.advancedAPI=function(S){var K=j===b;return K&&_.call(this),typeof S!="function"||(S(this),K&&C.call(this)),this},m.compatAPI=function(S){var K=j===w;return K&&C.call(this),typeof S!="function"||(S(this),K&&_.call(this)),this},m.isAdvancedAPI=function(){return j===w};var A,P=function(S){if(j!==w)throw new Error(S+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=m.roundToPrecision=m.__private__.roundToPrecision=function(S,K){var ne=t||K;if(isNaN(S)||isNaN(ne))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return S.toFixed(ne).replace(/0+$/,"")};A=m.hpf=m.__private__.hpf=typeof c=="number"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return F(S,c)}:c==="smart"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return F(S,S>-1&&S<1?16:5)}:function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return F(S,16)};var M=m.f2=m.__private__.f2=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f2");return F(S,2)},I=m.__private__.f3=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f3");return F(S,3)},R=m.scale=m.__private__.scale=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.scale");return j===b?S*He:j===w?S:void 0},D=function(S){return R(function(K){return j===b?Ut()-K:j===w?K:void 0}(S))};m.__private__.setPrecision=m.setPrecision=function(S){typeof parseInt(S,10)=="number"&&(t=parseInt(S,10))};var U,z="00000000000000000000000000000000",H=m.__private__.getFileId=function(){return z},q=m.__private__.setFileId=function(S){return z=S!==void 0&&/^[a-fA-F0-9]{32}$/.test(S)?S.toUpperCase():z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(T=new hv(u.userPermissions,u.userPassword,u.ownerPassword,z)),z};m.setFileId=function(S){return q(S),this},m.getFileId=function(){return H()};var Q=m.__private__.convertDateToPDFDate=function(S){var K=S.getTimezoneOffset(),ne=K<0?"+":"-",Ce=Math.floor(Math.abs(K/60)),W=Math.abs(K%60),oe=[ne,J(Ce),"'",J(W),"'"].join("");return["D:",S.getFullYear(),J(S.getMonth()+1),J(S.getDate()),J(S.getHours()),J(S.getMinutes()),J(S.getSeconds()),oe].join("")},pe=m.__private__.convertPDFDateToDate=function(S){var K=parseInt(S.substr(2,4),10),ne=parseInt(S.substr(6,2),10)-1,Ce=parseInt(S.substr(8,2),10),W=parseInt(S.substr(10,2),10),oe=parseInt(S.substr(12,2),10),Pe=parseInt(S.substr(14,2),10);return new Date(K,ne,Ce,W,oe,Pe,0)},be=m.__private__.setCreationDate=function(S){var K;if(S===void 0&&(S=new Date),S instanceof Date)K=Q(S);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(S))throw new Error("Invalid argument passed to jsPDF.setCreationDate");K=S}return U=K},V=m.__private__.getCreationDate=function(S){var K=U;return S==="jsDate"&&(K=pe(U)),K};m.setCreationDate=function(S){return be(S),this},m.getCreationDate=function(S){return V(S)};var B,J=m.__private__.padd2=function(S){return("0"+parseInt(S)).slice(-2)},ue=m.__private__.padd2Hex=function(S){return("00"+(S=S.toString())).substr(S.length)},Ne=0,Z=[],ge=[],le=0,se=[],ee=[],de=!1,Le=ge;m.__private__.setCustomOutputDestination=function(S){de=!0,Le=S};var ae=function(S){de||(Le=S)};m.__private__.resetCustomOutputDestination=function(){de=!1,Le=ge};var ie=m.__private__.out=function(S){return S=S.toString(),le+=S.length+1,Le.push(S),Le},dt=m.__private__.write=function(S){return ie(arguments.length===1?S.toString():Array.prototype.join.call(arguments," "))},At=m.__private__.getArrayBuffer=function(S){for(var K=S.length,ne=new ArrayBuffer(K),Ce=new Uint8Array(ne);K--;)Ce[K]=S.charCodeAt(K);return ne},st=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return st};var ut=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(S){return ut=j===w?S/He:S,this};var Rt,Nt=m.__private__.getFontSize=m.getFontSize=function(){return j===b?ut:ut*He},tt=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(S){return tt=S,this},m.__private__.getR2L=m.getR2L=function(){return tt};var he,ke=m.__private__.setZoomMode=function(S){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(S))Rt=S;else if(isNaN(S)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(S)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+S+'" is not recognized.');Rt=S}else Rt=parseInt(S,10)};m.__private__.getZoomMode=function(){return Rt};var et,Me=m.__private__.setPageMode=function(S){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(S)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+S+'" is not recognized.');he=S};m.__private__.getPageMode=function(){return he};var $e=m.__private__.setLayoutMode=function(S){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(S)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+S+'" is not recognized.');et=S};m.__private__.getLayoutMode=function(){return et},m.__private__.setDisplayMode=m.setDisplayMode=function(S,K,ne){return ke(S),$e(K),Me(ne),this};var Be={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(S){if(Object.keys(Be).indexOf(S)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Be[S]},m.__private__.getDocumentProperties=function(){return Be},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(S){for(var K in Be)Be.hasOwnProperty(K)&&S[K]&&(Be[K]=S[K]);return this},m.__private__.setDocumentProperty=function(S,K){if(Object.keys(Be).indexOf(S)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Be[S]=K};var we,He,ht,zt,hr,Mt={},Qt={},Se=[],kt={},Lt={},fr={},yr={},Xt=null,nr=0,ir=[],Ee=new b9(m),qe=e.hotfixes||[],Ge={},Qe={},St=[],pt=function S(K,ne,Ce,W,oe,Pe){if(!(this instanceof S))return new S(K,ne,Ce,W,oe,Pe);isNaN(K)&&(K=1),isNaN(ne)&&(ne=0),isNaN(Ce)&&(Ce=0),isNaN(W)&&(W=1),isNaN(oe)&&(oe=0),isNaN(Pe)&&(Pe=0),this._matrix=[K,ne,Ce,W,oe,Pe]};Object.defineProperty(pt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(pt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(pt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(pt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(pt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(pt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(pt.prototype,"a",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(pt.prototype,"b",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(pt.prototype,"c",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(pt.prototype,"d",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(pt.prototype,"e",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(pt.prototype,"f",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(pt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(pt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(pt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(pt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),pt.prototype.join=function(S){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(A).join(S)},pt.prototype.multiply=function(S){var K=S.sx*this.sx+S.shy*this.shx,ne=S.sx*this.shy+S.shy*this.sy,Ce=S.shx*this.sx+S.sy*this.shx,W=S.shx*this.shy+S.sy*this.sy,oe=S.tx*this.sx+S.ty*this.shx+this.tx,Pe=S.tx*this.shy+S.ty*this.sy+this.ty;return new pt(K,ne,Ce,W,oe,Pe)},pt.prototype.decompose=function(){var S=this.sx,K=this.shy,ne=this.shx,Ce=this.sy,W=this.tx,oe=this.ty,Pe=Math.sqrt(S*S+K*K),ze=(S/=Pe)*ne+(K/=Pe)*Ce;ne-=S*ze,Ce-=K*ze;var Ke=Math.sqrt(ne*ne+Ce*Ce);return ze/=Ke,S*(Ce/=Ke)<K*(ne/=Ke)&&(S=-S,K=-K,ze=-ze,Pe=-Pe),{scale:new pt(Pe,0,0,Ke,0,0),translate:new pt(1,0,0,1,W,oe),rotate:new pt(S,K,-K,S,0,0),skew:new pt(1,0,ze,1,0,0)}},pt.prototype.toString=function(S){return this.join(" ")},pt.prototype.inversed=function(){var S=this.sx,K=this.shy,ne=this.shx,Ce=this.sy,W=this.tx,oe=this.ty,Pe=1/(S*Ce-K*ne),ze=Ce*Pe,Ke=-K*Pe,Tt=-ne*Pe,it=S*Pe;return new pt(ze,Ke,Tt,it,-ze*W-Tt*oe,-Ke*W-it*oe)},pt.prototype.applyToPoint=function(S){var K=S.x*this.sx+S.y*this.shx+this.tx,ne=S.x*this.shy+S.y*this.sy+this.ty;return new yo(K,ne)},pt.prototype.applyToRectangle=function(S){var K=this.applyToPoint(S),ne=this.applyToPoint(new yo(S.x+S.w,S.y+S.h));return new nf(K.x,K.y,ne.x-K.x,ne.y-K.y)},pt.prototype.clone=function(){var S=this.sx,K=this.shy,ne=this.shx,Ce=this.sy,W=this.tx,oe=this.ty;return new pt(S,K,ne,Ce,W,oe)},m.Matrix=pt;var Et=m.matrixMult=function(S,K){return K.multiply(S)},mt=new pt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=mt;var gt=function(S,K){if(!Lt[S]){var ne=(K instanceof Lm?"Sh":"P")+(Object.keys(kt).length+1).toString(10);K.id=ne,Lt[S]=ne,kt[ne]=K,Ee.publish("addPattern",K)}};m.ShadingPattern=Lm,m.TilingPattern=Op,m.addShadingPattern=function(S,K){return P("addShadingPattern()"),gt(S,K),this},m.beginTilingPattern=function(S){P("beginTilingPattern()"),Fs(S.boundingBox[0],S.boundingBox[1],S.boundingBox[2]-S.boundingBox[0],S.boundingBox[3]-S.boundingBox[1],S.matrix)},m.endTilingPattern=function(S,K){P("endTilingPattern()"),K.stream=ee[B].join(`
`),gt(S,K),Ee.publish("endTilingPattern",K),St.pop().restore()};var ft,Dt=m.__private__.newObject=function(){var S=Ft();return ye(S,!0),S},Ft=m.__private__.newObjectDeferred=function(){return Ne++,Z[Ne]=function(){return le},Ne},ye=function(S,K){return K=typeof K=="boolean"&&K,Z[S]=le,K&&ie(S+" 0 obj"),S},wt=m.__private__.newAdditionalObject=function(){var S={objId:Ft(),content:""};return se.push(S),S},Yt=Ft(),br=Ft(),Mr=m.__private__.decodeColorString=function(S){var K=S.split(" ");if(K.length!==2||K[1]!=="g"&&K[1]!=="G")K.length!==5||K[4]!=="k"&&K[4]!=="K"||(K=[(1-K[0])*(1-K[3]),(1-K[1])*(1-K[3]),(1-K[2])*(1-K[3]),"r"]);else{var ne=parseFloat(K[0]);K=[ne,ne,ne,"r"]}for(var Ce="#",W=0;W<3;W++)Ce+=("0"+Math.floor(255*parseFloat(K[W])).toString(16)).slice(-2);return Ce},Nr=m.__private__.encodeColorString=function(S){var K;typeof S=="string"&&(S={ch1:S});var ne=S.ch1,Ce=S.ch2,W=S.ch3,oe=S.ch4,Pe=S.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ne=="string"&&ne.charAt(0)!=="#"){var ze=new Yne(ne);if(ze.ok)ne=ze.toHex();else if(!/^\d*\.?\d*$/.test(ne))throw new Error('Invalid color "'+ne+'" passed to jsPDF.encodeColorString.')}if(typeof ne=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ne)&&(ne="#"+ne[1]+ne[1]+ne[2]+ne[2]+ne[3]+ne[3]),typeof ne=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ne)){var Ke=parseInt(ne.substr(1),16);ne=Ke>>16&255,Ce=Ke>>8&255,W=255&Ke}if(Ce===void 0||oe===void 0&&ne===Ce&&Ce===W)K=typeof ne=="string"?ne+" "+Pe[0]:S.precision===2?M(ne/255)+" "+Pe[0]:I(ne/255)+" "+Pe[0];else if(oe===void 0||Fa(oe)==="object"){if(oe&&!isNaN(oe.a)&&oe.a===0)return["1.","1.","1.",Pe[1]].join(" ");K=typeof ne=="string"?[ne,Ce,W,Pe[1]].join(" "):S.precision===2?[M(ne/255),M(Ce/255),M(W/255),Pe[1]].join(" "):[I(ne/255),I(Ce/255),I(W/255),Pe[1]].join(" ")}else K=typeof ne=="string"?[ne,Ce,W,oe,Pe[2]].join(" "):S.precision===2?[M(ne),M(Ce),M(W),M(oe),Pe[2]].join(" "):[I(ne),I(Ce),I(W),I(oe),Pe[2]].join(" ");return K},Rr=m.__private__.getFilters=function(){return i},Er=m.__private__.putStream=function(S){var K=(S=S||{}).data||"",ne=S.filters||Rr(),Ce=S.alreadyAppliedFilters||[],W=S.addLength1||!1,oe=K.length,Pe=S.objectId,ze=function(jr){return jr};if(u!==null&&Pe===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(ze=T.encryptor(Pe,0));var Ke={};ne===!0&&(ne=["FlateEncode"]);var Tt=S.additionalKeyValues||[],it=(Ke=Vn.API.processDataByFilters!==void 0?Vn.API.processDataByFilters(K,ne):{data:K,reverseChain:[]}).reverseChain+(Array.isArray(Ce)?Ce.join(" "):Ce.toString());if(Ke.data.length!==0&&(Tt.push({key:"Length",value:Ke.data.length}),W===!0&&Tt.push({key:"Length1",value:oe})),it.length!=0)if(it.split("/").length-1==1)Tt.push({key:"Filter",value:it});else{Tt.push({key:"Filter",value:"["+it+"]"});for(var Bt=0;Bt<Tt.length;Bt+=1)if(Tt[Bt].key==="DecodeParms"){for(var Kt=[],Ct=0;Ct<Ke.reverseChain.split("/").length-1;Ct+=1)Kt.push("null");Kt.push(Tt[Bt].value),Tt[Bt].value="["+Kt.join(" ")+"]"}}ie("<<");for(var Or=0;Or<Tt.length;Or++)ie("/"+Tt[Or].key+" "+Tt[Or].value);ie(">>"),Ke.data.length!==0&&(ie("stream"),ie(ze(Ke.data)),ie("endstream"))},ln=m.__private__.putPage=function(S){var K=S.number,ne=S.data,Ce=S.objId,W=S.contentsObjId;ye(Ce,!0),ie("<</Type /Page"),ie("/Parent "+S.rootDictionaryObjId+" 0 R"),ie("/Resources "+S.resourceDictionaryObjId+" 0 R"),ie("/MediaBox ["+parseFloat(A(S.mediaBox.bottomLeftX))+" "+parseFloat(A(S.mediaBox.bottomLeftY))+" "+A(S.mediaBox.topRightX)+" "+A(S.mediaBox.topRightY)+"]"),S.cropBox!==null&&ie("/CropBox ["+A(S.cropBox.bottomLeftX)+" "+A(S.cropBox.bottomLeftY)+" "+A(S.cropBox.topRightX)+" "+A(S.cropBox.topRightY)+"]"),S.bleedBox!==null&&ie("/BleedBox ["+A(S.bleedBox.bottomLeftX)+" "+A(S.bleedBox.bottomLeftY)+" "+A(S.bleedBox.topRightX)+" "+A(S.bleedBox.topRightY)+"]"),S.trimBox!==null&&ie("/TrimBox ["+A(S.trimBox.bottomLeftX)+" "+A(S.trimBox.bottomLeftY)+" "+A(S.trimBox.topRightX)+" "+A(S.trimBox.topRightY)+"]"),S.artBox!==null&&ie("/ArtBox ["+A(S.artBox.bottomLeftX)+" "+A(S.artBox.bottomLeftY)+" "+A(S.artBox.topRightX)+" "+A(S.artBox.topRightY)+"]"),typeof S.userUnit=="number"&&S.userUnit!==1&&ie("/UserUnit "+S.userUnit),Ee.publish("putPage",{objId:Ce,pageContext:ir[K],pageNumber:K,page:ne}),ie("/Contents "+W+" 0 R"),ie(">>"),ie("endobj");var oe=ne.join(`
`);return j===w&&(oe+=`
Q`),ye(W,!0),Er({data:oe,filters:Rr(),objectId:W}),ie("endobj"),Ce},Fn=m.__private__.putPages=function(){var S,K,ne=[];for(S=1;S<=nr;S++)ir[S].objId=Ft(),ir[S].contentsObjId=Ft();for(S=1;S<=nr;S++)ne.push(ln({number:S,data:ee[S],objId:ir[S].objId,contentsObjId:ir[S].contentsObjId,mediaBox:ir[S].mediaBox,cropBox:ir[S].cropBox,bleedBox:ir[S].bleedBox,trimBox:ir[S].trimBox,artBox:ir[S].artBox,userUnit:ir[S].userUnit,rootDictionaryObjId:Yt,resourceDictionaryObjId:br}));ye(Yt,!0),ie("<</Type /Pages");var Ce="/Kids [";for(K=0;K<nr;K++)Ce+=ne[K]+" 0 R ";ie(Ce+"]"),ie("/Count "+nr),ie(">>"),ie("endobj"),Ee.publish("postPutPages")},Hn=function(S){Ee.publish("putFont",{font:S,out:ie,newObject:Dt,putStream:Er}),S.isAlreadyPutted!==!0&&(S.objectNumber=Dt(),ie("<<"),ie("/Type /Font"),ie("/BaseFont /"+pv(S.postScriptName)),ie("/Subtype /Type1"),typeof S.encoding=="string"&&ie("/Encoding /"+S.encoding),ie("/FirstChar 32"),ie("/LastChar 255"),ie(">>"),ie("endobj"))},$n=function(S){S.objectNumber=Dt();var K=[];K.push({key:"Type",value:"/XObject"}),K.push({key:"Subtype",value:"/Form"}),K.push({key:"BBox",value:"["+[A(S.x),A(S.y),A(S.x+S.width),A(S.y+S.height)].join(" ")+"]"}),K.push({key:"Matrix",value:"["+S.matrix.toString()+"]"});var ne=S.pages[1].join(`
`);Er({data:ne,additionalKeyValues:K,objectId:S.objectNumber}),ie("endobj")},at=function(S,K){K||(K=21);var ne=Dt(),Ce=function(Pe,ze){var Ke,Tt=[],it=1/(ze-1);for(Ke=0;Ke<1;Ke+=it)Tt.push(Ke);if(Tt.push(1),Pe[0].offset!=0){var Bt={offset:0,color:Pe[0].color};Pe.unshift(Bt)}if(Pe[Pe.length-1].offset!=1){var Kt={offset:1,color:Pe[Pe.length-1].color};Pe.push(Kt)}for(var Ct="",Or=0,jr=0;jr<Tt.length;jr++){for(Ke=Tt[jr];Ke>Pe[Or+1].offset;)Or++;var or=Pe[Or].offset,Hr=(Ke-or)/(Pe[Or+1].offset-or),Cr=Pe[Or].color,Yr=Pe[Or+1].color;Ct+=ue(Math.round((1-Hr)*Cr[0]+Hr*Yr[0]).toString(16))+ue(Math.round((1-Hr)*Cr[1]+Hr*Yr[1]).toString(16))+ue(Math.round((1-Hr)*Cr[2]+Hr*Yr[2]).toString(16))}return Ct.trim()}(S.colors,K),W=[];W.push({key:"FunctionType",value:"0"}),W.push({key:"Domain",value:"[0.0 1.0]"}),W.push({key:"Size",value:"["+K+"]"}),W.push({key:"BitsPerSample",value:"8"}),W.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),W.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Er({data:Ce,additionalKeyValues:W,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ne}),ie("endobj"),S.objectNumber=Dt(),ie("<< /ShadingType "+S.type),ie("/ColorSpace /DeviceRGB");var oe="/Coords ["+A(parseFloat(S.coords[0]))+" "+A(parseFloat(S.coords[1]))+" ";S.type===2?oe+=A(parseFloat(S.coords[2]))+" "+A(parseFloat(S.coords[3])):oe+=A(parseFloat(S.coords[2]))+" "+A(parseFloat(S.coords[3]))+" "+A(parseFloat(S.coords[4]))+" "+A(parseFloat(S.coords[5])),ie(oe+="]"),S.matrix&&ie("/Matrix ["+S.matrix.toString()+"]"),ie("/Function "+ne+" 0 R"),ie("/Extend [true true]"),ie(">>"),ie("endobj")},Vt=function(S,K){var ne=Ft(),Ce=Dt();K.push({resourcesOid:ne,objectOid:Ce}),S.objectNumber=Ce;var W=[];W.push({key:"Type",value:"/Pattern"}),W.push({key:"PatternType",value:"1"}),W.push({key:"PaintType",value:"1"}),W.push({key:"TilingType",value:"1"}),W.push({key:"BBox",value:"["+S.boundingBox.map(A).join(" ")+"]"}),W.push({key:"XStep",value:A(S.xStep)}),W.push({key:"YStep",value:A(S.yStep)}),W.push({key:"Resources",value:ne+" 0 R"}),S.matrix&&W.push({key:"Matrix",value:"["+S.matrix.toString()+"]"}),Er({data:S.stream,additionalKeyValues:W,objectId:S.objectNumber}),ie("endobj")},wr=function(S){for(var K in S.objectNumber=Dt(),ie("<<"),S)switch(K){case"opacity":ie("/ca "+M(S[K]));break;case"stroke-opacity":ie("/CA "+M(S[K]))}ie(">>"),ie("endobj")},er=function(S){ye(S.resourcesOid,!0),ie("<<"),ie("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var K in ie("/Font <<"),Mt)Mt.hasOwnProperty(K)&&(f===!1||f===!0&&h.hasOwnProperty(K))&&ie("/"+K+" "+Mt[K].objectNumber+" 0 R");ie(">>")}(),function(){if(Object.keys(kt).length>0){for(var K in ie("/Shading <<"),kt)kt.hasOwnProperty(K)&&kt[K]instanceof Lm&&kt[K].objectNumber>=0&&ie("/"+K+" "+kt[K].objectNumber+" 0 R");Ee.publish("putShadingPatternDict"),ie(">>")}}(),function(K){if(Object.keys(kt).length>0){for(var ne in ie("/Pattern <<"),kt)kt.hasOwnProperty(ne)&&kt[ne]instanceof m.TilingPattern&&kt[ne].objectNumber>=0&&kt[ne].objectNumber<K&&ie("/"+ne+" "+kt[ne].objectNumber+" 0 R");Ee.publish("putTilingPatternDict"),ie(">>")}}(S.objectOid),function(){if(Object.keys(fr).length>0){var K;for(K in ie("/ExtGState <<"),fr)fr.hasOwnProperty(K)&&fr[K].objectNumber>=0&&ie("/"+K+" "+fr[K].objectNumber+" 0 R");Ee.publish("putGStateDict"),ie(">>")}}(),function(){for(var K in ie("/XObject <<"),Ge)Ge.hasOwnProperty(K)&&Ge[K].objectNumber>=0&&ie("/"+K+" "+Ge[K].objectNumber+" 0 R");Ee.publish("putXobjectDict"),ie(">>")}(),ie(">>"),ie("endobj")},Ze=function(S){Qt[S.fontName]=Qt[S.fontName]||{},Qt[S.fontName][S.fontStyle]=S.id},Fr=function(S,K,ne,Ce,W){var oe={id:"F"+(Object.keys(Mt).length+1).toString(10),postScriptName:S,fontName:K,fontStyle:ne,encoding:Ce,isStandardFont:W||!1,metadata:{}};return Ee.publish("addFont",{font:oe,instance:this}),Mt[oe.id]=oe,Ze(oe),oe.id},jt=m.__private__.pdfEscape=m.pdfEscape=function(S,K){return function(ne,Ce){var W,oe,Pe,ze,Ke,Tt,it,Bt,Kt;if(Pe=(Ce=Ce||{}).sourceEncoding||"Unicode",Ke=Ce.outputEncoding,(Ce.autoencode||Ke)&&Mt[we].metadata&&Mt[we].metadata[Pe]&&Mt[we].metadata[Pe].encoding&&(ze=Mt[we].metadata[Pe].encoding,!Ke&&Mt[we].encoding&&(Ke=Mt[we].encoding),!Ke&&ze.codePages&&(Ke=ze.codePages[0]),typeof Ke=="string"&&(Ke=ze[Ke]),Ke)){for(it=!1,Tt=[],W=0,oe=ne.length;W<oe;W++)(Bt=Ke[ne.charCodeAt(W)])?Tt.push(String.fromCharCode(Bt)):Tt.push(ne[W]),Tt[W].charCodeAt(0)>>8&&(it=!0);ne=Tt.join("")}for(W=ne.length;it===void 0&&W!==0;)ne.charCodeAt(W-1)>>8&&(it=!0),W--;if(!it)return ne;for(Tt=Ce.noBOM?[]:[254,255],W=0,oe=ne.length;W<oe;W++){if((Kt=(Bt=ne.charCodeAt(W))>>8)>>8)throw new Error("Character at position "+W+" of string '"+ne+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Tt.push(Kt),Tt.push(Bt-(Kt<<8))}return String.fromCharCode.apply(void 0,Tt)}(S,K).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},_r=m.__private__.beginPage=function(S){ee[++nr]=[],ir[nr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(S[0]),topRightY:Number(S[1])}},Zt(nr),ae(ee[B])},bt=function(S,K){var ne,Ce,W;switch(r=K||r,typeof S=="string"&&(ne=x(S.toLowerCase()),Array.isArray(ne)&&(Ce=ne[0],W=ne[1])),Array.isArray(S)&&(Ce=S[0]*He,W=S[1]*He),isNaN(Ce)&&(Ce=o[0],W=o[1]),(Ce>14400||W>14400)&&(_o.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ce=Math.min(14400,Ce),W=Math.min(14400,W)),o=[Ce,W],r.substr(0,1)){case"l":W>Ce&&(o=[W,Ce]);break;case"p":Ce>W&&(o=[W,Ce])}_r(o),ga(dn),ie(mi),rf!==0&&ie(rf+" J"),Zl!==0&&ie(Zl+" j"),Ee.publish("addPage",{pageNumber:nr})},Wt=function(S){S>0&&S<=nr&&(ee.splice(S,1),ir.splice(S,1),nr--,B>nr&&(B=nr),this.setPage(B))},Zt=function(S){S>0&&S<=nr&&(B=S)},Br=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return ee.length-1},zr=function(S,K,ne){var Ce,W=void 0;return ne=ne||{},S=S!==void 0?S:Mt[we].fontName,K=K!==void 0?K:Mt[we].fontStyle,Ce=S.toLowerCase(),Qt[Ce]!==void 0&&Qt[Ce][K]!==void 0?W=Qt[Ce][K]:Qt[S]!==void 0&&Qt[S][K]!==void 0?W=Qt[S][K]:ne.disableWarning===!1&&_o.warn("Unable to look up font label for font '"+S+"', '"+K+"'. Refer to getFontList() for available fonts."),W||ne.noFallback||(W=Qt.times[K])==null&&(W=Qt.times.normal),W},_t=m.__private__.putInfo=function(){var S=Dt(),K=function(Ce){return Ce};for(var ne in u!==null&&(K=T.encryptor(S,0)),ie("<<"),ie("/Producer ("+jt(K("jsPDF "+Vn.version))+")"),Be)Be.hasOwnProperty(ne)&&Be[ne]&&ie("/"+ne.substr(0,1).toUpperCase()+ne.substr(1)+" ("+jt(K(Be[ne]))+")");ie("/CreationDate ("+jt(K(U))+")"),ie(">>"),ie("endobj")},Jr=m.__private__.putCatalog=function(S){var K=(S=S||{}).rootDictionaryObjId||Yt;switch(Dt(),ie("<<"),ie("/Type /Catalog"),ie("/Pages "+K+" 0 R"),Rt||(Rt="fullwidth"),Rt){case"fullwidth":ie("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ie("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ie("/OpenAction [3 0 R /Fit]");break;case"original":ie("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ne=""+Rt;ne.substr(ne.length-1)==="%"&&(Rt=parseInt(Rt)/100),typeof Rt=="number"&&ie("/OpenAction [3 0 R /XYZ null null "+M(Rt)+"]")}switch(et||(et="continuous"),et){case"continuous":ie("/PageLayout /OneColumn");break;case"single":ie("/PageLayout /SinglePage");break;case"two":case"twoleft":ie("/PageLayout /TwoColumnLeft");break;case"tworight":ie("/PageLayout /TwoColumnRight")}he&&ie("/PageMode /"+he),Ee.publish("putCatalog"),ie(">>"),ie("endobj")},mn=m.__private__.putTrailer=function(){ie("trailer"),ie("<<"),ie("/Size "+(Ne+1)),ie("/Root "+Ne+" 0 R"),ie("/Info "+(Ne-1)+" 0 R"),u!==null&&ie("/Encrypt "+T.oid+" 0 R"),ie("/ID [ <"+z+"> <"+z+"> ]"),ie(">>")},ma=m.__private__.putHeader=function(){ie("%PDF-"+v),ie("%")},Nn=m.__private__.putXRef=function(){var S="0000000000";ie("xref"),ie("0 "+(Ne+1)),ie("0000000000 65535 f ");for(var K=1;K<=Ne;K++)typeof Z[K]=="function"?ie((S+Z[K]()).slice(-10)+" 00000 n "):Z[K]!==void 0?ie((S+Z[K]).slice(-10)+" 00000 n "):ie("0000000000 00000 n ")},re=m.__private__.buildDocument=function(){var S;Ne=0,le=0,ge=[],Z=[],se=[],Yt=Ft(),br=Ft(),ae(ge),Ee.publish("buildDocument"),ma(),Fn(),function(){Ee.publish("putAdditionalObjects");for(var ne=0;ne<se.length;ne++){var Ce=se[ne];ye(Ce.objId,!0),ie(Ce.content),ie("endobj")}Ee.publish("postPutAdditionalObjects")}(),S=[],function(){for(var ne in Mt)Mt.hasOwnProperty(ne)&&(f===!1||f===!0&&h.hasOwnProperty(ne))&&Hn(Mt[ne])}(),function(){var ne;for(ne in fr)fr.hasOwnProperty(ne)&&wr(fr[ne])}(),function(){for(var ne in Ge)Ge.hasOwnProperty(ne)&&$n(Ge[ne])}(),function(ne){var Ce;for(Ce in kt)kt.hasOwnProperty(Ce)&&(kt[Ce]instanceof Lm?at(kt[Ce]):kt[Ce]instanceof Op&&Vt(kt[Ce],ne))}(S),Ee.publish("putResources"),S.forEach(er),er({resourcesOid:br,objectOid:Number.MAX_SAFE_INTEGER}),Ee.publish("postPutResources"),u!==null&&(T.oid=Dt(),ie("<<"),ie("/Filter /Standard"),ie("/V "+T.v),ie("/R "+T.r),ie("/U <"+T.toHexString(T.U)+">"),ie("/O <"+T.toHexString(T.O)+">"),ie("/P "+T.P),ie(">>"),ie("endobj")),_t(),Jr();var K=le;return Nn(),mn(),ie("startxref"),ie(""+K),ie("%%EOF"),ae(ee[B]),ge.join(`
`)},Te=m.__private__.getBlob=function(S){return new Blob([At(S)],{type:"application/pdf"})},ot=m.output=m.__private__.output=(ft=function(S,K){switch(typeof(K=K||{})=="string"?K={filename:K}:K.filename=K.filename||"generated.pdf",S){case void 0:return re();case"save":m.save(K.filename);break;case"arraybuffer":return At(re());case"blob":return Te(re());case"bloburi":case"bloburl":if(da.URL!==void 0&&typeof da.URL.createObjectURL=="function")return da.URL&&da.URL.createObjectURL(Te(re()))||void 0;_o.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ne="",Ce=re();try{ne=v9(Ce)}catch{ne=v9(unescape(encodeURIComponent(Ce)))}return"data:application/pdf;filename="+K.filename+";base64,"+ne;case"pdfobjectnewwindow":if(Object.prototype.toString.call(da)==="[object Window]"){var W="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",oe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';K.pdfObjectUrl&&(W=K.pdfObjectUrl,oe="");var Pe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+W+'"'+oe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(K)+");<\/script></body></html>",ze=da.open();return ze!==null&&ze.document.write(Pe),ze}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(da)==="[object Window]"){var Ke='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(K.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+K.filename+'" width="500px" height="400px" /></body></html>',Tt=da.open();if(Tt!==null){Tt.document.write(Ke);var it=this;Tt.document.documentElement.querySelector("#pdfViewer").onload=function(){Tt.document.title=K.filename,Tt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(it.output("bloburl"))}}return Tt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(da)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Bt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",K)+'"></iframe></body></html>',Kt=da.open();if(Kt!==null&&(Kt.document.write(Bt),Kt.document.title=K.filename),Kt||typeof safari>"u")return Kt;break;case"datauri":case"dataurl":return da.document.location.href=this.output("datauristring",K);default:return null}},ft.foo=function(){try{return ft.apply(this,arguments)}catch(ne){var S=ne.stack||"";~S.indexOf(" at ")&&(S=S.split(" at ")[1]);var K="Error in function "+S.split(`
`)[0].split("<")[0]+": "+ne.message;if(!da.console)throw new Error(K);da.console.error(K,ne),da.alert&&alert(K)}},ft.foo.bar=ft,ft.foo),te=function(S){return Array.isArray(qe)===!0&&qe.indexOf(S)>-1};switch(n){case"pt":He=1;break;case"mm":He=72/25.4;break;case"cm":He=72/2.54;break;case"in":He=72;break;case"px":He=te("px_scaling")==1?.75:96/72;break;case"pc":case"em":He=12;break;case"ex":He=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);He=n}var T=null;be(),q();var O=m.__private__.getPageInfo=m.getPageInfo=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ir[S].objId,pageNumber:S,pageContext:ir[S]}},X=m.__private__.getPageInfoByObjId=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var K in ir)if(ir[K].objId===S)break;return O(K)},G=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:ir[B].objId,pageNumber:B,pageContext:ir[B]}};m.addPage=function(){return bt.apply(this,arguments),this},m.setPage=function(){return Zt.apply(this,arguments),ae.call(this,ee[B]),this},m.insertPage=function(S){return this.addPage(),this.movePage(B,S),this},m.movePage=function(S,K){var ne,Ce;if(S>K){ne=ee[S],Ce=ir[S];for(var W=S;W>K;W--)ee[W]=ee[W-1],ir[W]=ir[W-1];ee[K]=ne,ir[K]=Ce,this.setPage(K)}else if(S<K){ne=ee[S],Ce=ir[S];for(var oe=S;oe<K;oe++)ee[oe]=ee[oe+1],ir[oe]=ir[oe+1];ee[K]=ne,ir[K]=Ce,this.setPage(K)}return this},m.deletePage=function(){return Wt.apply(this,arguments),this},m.__private__.text=m.text=function(S,K,ne,Ce,W){var oe,Pe,ze,Ke,Tt,it,Bt,Kt,Ct,Or=(Ce=Ce||{}).scope||this;if(typeof S=="number"&&typeof K=="number"&&(typeof ne=="string"||Array.isArray(ne))){var jr=ne;ne=K,K=S,S=jr}if(arguments[3]instanceof pt==0?(ze=arguments[4],Ke=arguments[5],Fa(Bt=arguments[3])==="object"&&Bt!==null||(typeof ze=="string"&&(Ke=ze,ze=null),typeof Bt=="string"&&(Ke=Bt,Bt=null),typeof Bt=="number"&&(ze=Bt,Bt=null),Ce={flags:Bt,angle:ze,align:Ke})):(P("The transform parameter of text() with a Matrix value"),Ct=W),isNaN(K)||isNaN(ne)||S==null)throw new Error("Invalid arguments passed to jsPDF.text");if(S.length===0)return Or;var or,Hr="",Cr=typeof Ce.lineHeightFactor=="number"?Ce.lineHeightFactor:En,Yr=Or.internal.scaleFactor;function vr(Ua){return Ua=Ua.split("	").join(Array(Ce.TabLen||9).join(" ")),jt(Ua,Bt)}function lr(Ua){for(var Za,Lo=Ua.concat(),bo=[],Yo=Lo.length;Yo--;)typeof(Za=Lo.shift())=="string"?bo.push(Za):Array.isArray(Ua)&&(Za.length===1||Za[1]===void 0&&Za[2]===void 0)?bo.push(Za[0]):bo.push([Za[0],Za[1],Za[2]]);return bo}function ct(Ua,Za){var Lo;if(typeof Ua=="string")Lo=Za(Ua)[0];else if(Array.isArray(Ua)){for(var bo,Yo,ei=Ua.concat(),Td=[],Tg=ei.length;Tg--;)typeof(bo=ei.shift())=="string"?Td.push(Za(bo)[0]):Array.isArray(bo)&&typeof bo[0]=="string"&&(Yo=Za(bo[0],bo[1],bo[2]),Td.push([Yo[0],Yo[1],Yo[2]]));Lo=Td}return Lo}var Zr=!1,cn=!0;if(typeof S=="string")Zr=!0;else if(Array.isArray(S)){var Ia=S.concat();Pe=[];for(var Ca,cr=Ia.length;cr--;)(typeof(Ca=Ia.shift())!="string"||Array.isArray(Ca)&&typeof Ca[0]!="string")&&(cn=!1);Zr=cn}if(Zr===!1)throw new Error('Type of text must be string or Array. "'+S+'" is not recognized.');typeof S=="string"&&(S=S.match(/[\r?\n]/)?S.split(/\r\n|\r|\n/g):[S]);var xr=ut/Or.internal.scaleFactor,qr=xr*(Cr-1);switch(Ce.baseline){case"bottom":ne-=qr;break;case"top":ne+=xr-qr;break;case"hanging":ne+=xr-2*qr;break;case"middle":ne+=xr/2-qr}if((it=Ce.maxWidth||0)>0&&(typeof S=="string"?S=Or.splitTextToSize(S,it):Object.prototype.toString.call(S)==="[object Array]"&&(S=S.reduce(function(Ua,Za){return Ua.concat(Or.splitTextToSize(Za,it))},[]))),oe={text:S,x:K,y:ne,options:Ce,mutex:{pdfEscape:jt,activeFontKey:we,fonts:Mt,activeFontSize:ut}},Ee.publish("preProcessText",oe),S=oe.text,ze=(Ce=oe.options).angle,Ct instanceof pt==0&&ze&&typeof ze=="number"){ze*=Math.PI/180,Ce.rotationDirection===0&&(ze=-ze),j===w&&(ze=-ze);var Kr=Math.cos(ze),un=Math.sin(ze);Ct=new pt(Kr,un,-un,Kr,0,0)}else ze&&ze instanceof pt&&(Ct=ze);j!==w||Ct||(Ct=mt),(Tt=Ce.charSpace||Oi)!==void 0&&(Hr+=A(R(Tt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Kt=Ce.horizontalScale)!==void 0&&(Hr+=A(100*Kt)+` Tz
`),Ce.lang;var on=-1,sr=Ce.renderingMode!==void 0?Ce.renderingMode:Ce.stroke,nn=Or.internal.getCurrentPageInfo().pageContext;switch(sr){case 0:case!1:case"fill":on=0;break;case 1:case!0:case"stroke":on=1;break;case 2:case"fillThenStroke":on=2;break;case 3:case"invisible":on=3;break;case 4:case"fillAndAddForClipping":on=4;break;case 5:case"strokeAndAddPathForClipping":on=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":on=6;break;case 7:case"addToPathForClipping":on=7}var ur=nn.usedRenderingMode!==void 0?nn.usedRenderingMode:-1;on!==-1?Hr+=on+` Tr
`:ur!==-1&&(Hr+=`0 Tr
`),on!==-1&&(nn.usedRenderingMode=on),Ke=Ce.align||"left";var gr,Vr=ut*Cr,rn=Or.internal.pageSize.getWidth(),$r=Mt[we];Tt=Ce.charSpace||Oi,it=Ce.maxWidth||0,Bt=Object.assign({autoencode:!0,noBOM:!0},Ce.flags);var Pn=[],Ln=function(Ua){return Or.getStringUnitWidth(Ua,{font:$r,charSpace:Tt,fontSize:ut,doKerning:!1})*ut/Yr};if(Object.prototype.toString.call(S)==="[object Array]"){var Qr;Pe=lr(S),Ke!=="left"&&(gr=Pe.map(Ln));var Bn,Pa=0;if(Ke==="right"){K-=gr[0],S=[],cr=Pe.length;for(var Ja=0;Ja<cr;Ja++)Ja===0?(Bn=ss(K),Qr=ao(ne)):(Bn=R(Pa-gr[Ja]),Qr=-Vr),S.push([Pe[Ja],Bn,Qr]),Pa=gr[Ja]}else if(Ke==="center"){K-=gr[0]/2,S=[],cr=Pe.length;for(var po=0;po<cr;po++)po===0?(Bn=ss(K),Qr=ao(ne)):(Bn=R((Pa-gr[po])/2),Qr=-Vr),S.push([Pe[po],Bn,Qr]),Pa=gr[po]}else if(Ke==="left"){S=[],cr=Pe.length;for(var Id=0;Id<cr;Id++)S.push(Pe[Id])}else if(Ke==="justify"&&$r.encoding==="Identity-H"){S=[],cr=Pe.length,it=it!==0?it:rn;for(var Uc=0,go=0;go<cr;go++)if(Qr=go===0?ao(ne):-Vr,Bn=go===0?ss(K):Uc,go<cr-1){var of=R((it-gr[go])/(Pe[go].split(" ").length-1)),Sl=Pe[go].split(" ");S.push([Sl[0]+" ",Bn,Qr]),Uc=0;for(var is=1;is<Sl.length;is++){var Zs=(Ln(Sl[is-1]+" "+Sl[is])-Ln(Sl[is]))*Yr+of;is==Sl.length-1?S.push([Sl[is],Zs,0]):S.push([Sl[is]+" ",Zs,0]),Uc-=Zs}}else S.push([Pe[go],Bn,Qr]);S.push(["",Uc,0])}else{if(Ke!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(S=[],cr=Pe.length,it=it!==0?it:rn,go=0;go<cr;go++){Qr=go===0?ao(ne):-Vr,Bn=go===0?ss(K):0;var Wh=Pe[go].split(" ").length-1,Vc=Wh>0?(it-gr[go])/Wh:0;go<cr-1?Pn.push(A(R(Vc))):Pn.push(0),S.push([Pe[go],Bn,Qr])}}}(typeof Ce.R2L=="boolean"?Ce.R2L:tt)===!0&&(S=ct(S,function(Ua,Za,Lo){return[Ua.split("").reverse().join(""),Za,Lo]})),oe={text:S,x:K,y:ne,options:Ce,mutex:{pdfEscape:jt,activeFontKey:we,fonts:Mt,activeFontSize:ut}},Ee.publish("postProcessText",oe),S=oe.text,or=oe.mutex.isHex||!1;var Od=Mt[we].encoding;Od!=="WinAnsiEncoding"&&Od!=="StandardEncoding"||(S=ct(S,function(Ua,Za,Lo){return[vr(Ua),Za,Lo]})),Pe=lr(S),S=[];for(var Qi,gi,Wo,ec=Array.isArray(Pe[0])?1:0,Wc="",Cl=function(Ua,Za,Lo){var bo="";return Lo instanceof pt?(Lo=typeof Ce.angle=="number"?Et(Lo,new pt(1,0,0,1,Ua,Za)):Et(new pt(1,0,0,1,Ua,Za),Lo),j===w&&(Lo=Et(new pt(1,0,0,-1,0,0),Lo)),bo=Lo.join(" ")+` Tm
`):bo=A(Ua)+" "+A(Za)+` Td
`,bo},Pl=0;Pl<Pe.length;Pl++){switch(Wc="",ec){case 1:Wo=(or?"<":"(")+Pe[Pl][0]+(or?">":")"),Qi=parseFloat(Pe[Pl][1]),gi=parseFloat(Pe[Pl][2]);break;case 0:Wo=(or?"<":"(")+Pe[Pl]+(or?">":")"),Qi=ss(K),gi=ao(ne)}Pn!==void 0&&Pn[Pl]!==void 0&&(Wc=Pn[Pl]+` Tw
`),Pl===0?S.push(Wc+Cl(Qi,gi,Ct)+Wo):ec===0?S.push(Wc+Wo):ec===1&&S.push(Wc+Cl(Qi,gi,Ct)+Wo)}S=ec===0?S.join(` Tj
T* `):S.join(` Tj
`),S+=` Tj
`;var tc=`BT
/`;return tc+=we+" "+ut+` Tf
`,tc+=A(ut*Cr)+` TL
`,tc+=hi+`
`,tc+=Hr,tc+=S,ie(tc+="ET"),h[we]=!0,Or};var L=m.__private__.clip=m.clip=function(S){return ie(S==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return L("evenodd")},m.__private__.discardPath=m.discardPath=function(){return ie("n"),this};var Re=m.__private__.isValidStyle=function(S){var K=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(S)!==-1&&(K=!0),K};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(S){return Re(S)&&(d=S),this};var rt=m.__private__.getStyle=m.getStyle=function(S){var K=d;switch(S){case"D":case"S":K="S";break;case"F":K="f";break;case"FD":case"DF":K="B";break;case"f":case"f*":case"B":case"B*":K=S}return K},lt=m.close=function(){return ie("h"),this};m.stroke=function(){return ie("S"),this},m.fill=function(S){return $t("f",S),this},m.fillEvenOdd=function(S){return $t("f*",S),this},m.fillStroke=function(S){return $t("B",S),this},m.fillStrokeEvenOdd=function(S){return $t("B*",S),this};var $t=function(S,K){Fa(K)==="object"?Sr(K,S):ie(S)},Fe=function(S){S===null||j===w&&S===void 0||(S=rt(S),ie(S))};function It(S,K,ne,Ce,W){var oe=new Op(K||this.boundingBox,ne||this.xStep,Ce||this.yStep,this.gState,W||this.matrix);oe.stream=this.stream;var Pe=S+"$$"+this.cloneIndex+++"$$";return gt(Pe,oe),oe}var Sr=function(S,K){var ne=Lt[S.key],Ce=kt[ne];if(Ce instanceof Lm)ie("q"),ie(kr(K)),Ce.gState&&m.setGState(Ce.gState),ie(S.matrix.toString()+" cm"),ie("/"+ne+" sh"),ie("Q");else if(Ce instanceof Op){var W=new pt(1,0,0,-1,0,Ut());S.matrix&&(W=W.multiply(S.matrix||mt),ne=It.call(Ce,S.key,S.boundingBox,S.xStep,S.yStep,W).id),ie("q"),ie("/Pattern cs"),ie("/"+ne+" scn"),Ce.gState&&m.setGState(Ce.gState),ie(K),ie("Q")}},kr=function(S){switch(S){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},pr=m.moveTo=function(S,K){return ie(A(R(S))+" "+A(D(K))+" m"),this},yn=m.lineTo=function(S,K){return ie(A(R(S))+" "+A(D(K))+" l"),this},In=m.curveTo=function(S,K,ne,Ce,W,oe){return ie([A(R(S)),A(D(K)),A(R(ne)),A(D(Ce)),A(R(W)),A(D(oe)),"c"].join(" ")),this};m.__private__.line=m.line=function(S,K,ne,Ce,W){if(isNaN(S)||isNaN(K)||isNaN(ne)||isNaN(Ce)||!Re(W))throw new Error("Invalid arguments passed to jsPDF.line");return j===b?this.lines([[ne-S,Ce-K]],S,K,[1,1],W||"S"):this.lines([[ne-S,Ce-K]],S,K,[1,1]).stroke()},m.__private__.lines=m.lines=function(S,K,ne,Ce,W,oe){var Pe,ze,Ke,Tt,it,Bt,Kt,Ct,Or,jr,or,Hr;if(typeof S=="number"&&(Hr=ne,ne=K,K=S,S=Hr),Ce=Ce||[1,1],oe=oe||!1,isNaN(K)||isNaN(ne)||!Array.isArray(S)||!Array.isArray(Ce)||!Re(W)||typeof oe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(pr(K,ne),Pe=Ce[0],ze=Ce[1],Tt=S.length,jr=K,or=ne,Ke=0;Ke<Tt;Ke++)(it=S[Ke]).length===2?(jr=it[0]*Pe+jr,or=it[1]*ze+or,yn(jr,or)):(Bt=it[0]*Pe+jr,Kt=it[1]*ze+or,Ct=it[2]*Pe+jr,Or=it[3]*ze+or,jr=it[4]*Pe+jr,or=it[5]*ze+or,In(Bt,Kt,Ct,Or,jr,or));return oe&&lt(),Fe(W),this},m.path=function(S){for(var K=0;K<S.length;K++){var ne=S[K],Ce=ne.c;switch(ne.op){case"m":pr(Ce[0],Ce[1]);break;case"l":yn(Ce[0],Ce[1]);break;case"c":In.apply(this,Ce);break;case"h":lt()}}return this},m.__private__.rect=m.rect=function(S,K,ne,Ce,W){if(isNaN(S)||isNaN(K)||isNaN(ne)||isNaN(Ce)||!Re(W))throw new Error("Invalid arguments passed to jsPDF.rect");return j===b&&(Ce=-Ce),ie([A(R(S)),A(D(K)),A(R(ne)),A(R(Ce)),"re"].join(" ")),Fe(W),this},m.__private__.triangle=m.triangle=function(S,K,ne,Ce,W,oe,Pe){if(isNaN(S)||isNaN(K)||isNaN(ne)||isNaN(Ce)||isNaN(W)||isNaN(oe)||!Re(Pe))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ne-S,Ce-K],[W-ne,oe-Ce],[S-W,K-oe]],S,K,[1,1],Pe,!0),this},m.__private__.roundedRect=m.roundedRect=function(S,K,ne,Ce,W,oe,Pe){if(isNaN(S)||isNaN(K)||isNaN(ne)||isNaN(Ce)||isNaN(W)||isNaN(oe)||!Re(Pe))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ze=4/3*(Math.SQRT2-1);return W=Math.min(W,.5*ne),oe=Math.min(oe,.5*Ce),this.lines([[ne-2*W,0],[W*ze,0,W,oe-oe*ze,W,oe],[0,Ce-2*oe],[0,oe*ze,-W*ze,oe,-W,oe],[2*W-ne,0],[-W*ze,0,-W,-oe*ze,-W,-oe],[0,2*oe-Ce],[0,-oe*ze,W*ze,-oe,W,-oe]],S+W,K,[1,1],Pe,!0),this},m.__private__.ellipse=m.ellipse=function(S,K,ne,Ce,W){if(isNaN(S)||isNaN(K)||isNaN(ne)||isNaN(Ce)||!Re(W))throw new Error("Invalid arguments passed to jsPDF.ellipse");var oe=4/3*(Math.SQRT2-1)*ne,Pe=4/3*(Math.SQRT2-1)*Ce;return pr(S+ne,K),In(S+ne,K-Pe,S+oe,K-Ce,S,K-Ce),In(S-oe,K-Ce,S-ne,K-Pe,S-ne,K),In(S-ne,K+Pe,S-oe,K+Ce,S,K+Ce),In(S+oe,K+Ce,S+ne,K+Pe,S+ne,K),Fe(W),this},m.__private__.circle=m.circle=function(S,K,ne,Ce){if(isNaN(S)||isNaN(K)||isNaN(ne)||!Re(Ce))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(S,K,ne,ne,Ce)},m.setFont=function(S,K,ne){return ne&&(K=E(K,ne)),we=zr(S,K,{disableWarning:!1}),this};var Xn=m.__private__.getFont=m.getFont=function(){return Mt[zr.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var S,K,ne={};for(S in Qt)if(Qt.hasOwnProperty(S))for(K in ne[S]=[],Qt[S])Qt[S].hasOwnProperty(K)&&ne[S].push(K);return ne},m.addFont=function(S,K,ne,Ce,W){var oe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&oe.indexOf(arguments[3])!==-1?W=arguments[3]:arguments[3]&&oe.indexOf(arguments[3])==-1&&(ne=E(ne,Ce)),Fr.call(this,S,K,ne,W=W||"Identity-H")};var En,dn=e.lineWidth||.200025,Gr=m.__private__.getLineWidth=m.getLineWidth=function(){return dn},ga=m.__private__.setLineWidth=m.setLineWidth=function(S){return dn=S,ie(A(R(S))+" w"),this};m.__private__.setLineDash=Vn.API.setLineDash=Vn.API.setLineDashPattern=function(S,K){if(S=S||[],K=K||0,isNaN(K)||!Array.isArray(S))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return S=S.map(function(ne){return A(R(ne))}).join(" "),K=A(R(K)),ie("["+S+"] "+K+" d"),this};var Ma=m.__private__.getLineHeight=m.getLineHeight=function(){return ut*En};m.__private__.getLineHeight=m.getLineHeight=function(){return ut*En};var va=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(S){return typeof(S=S||1.15)=="number"&&(En=S),this},$a=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return En};va(e.lineHeight);var ss=m.__private__.getHorizontalCoordinate=function(S){return R(S)},ao=m.__private__.getVerticalCoordinate=function(S){return j===w?S:ir[B].mediaBox.topRightY-ir[B].mediaBox.bottomLeftY-R(S)},xo=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(S){return A(ss(S))},Ss=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(S){return A(ao(S))},mi=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Mr(mi)},m.__private__.setStrokeColor=m.setDrawColor=function(S,K,ne,Ce){return mi=Nr({ch1:S,ch2:K,ch3:ne,ch4:Ce,pdfColorType:"draw",precision:2}),ie(mi),this};var kd=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Mr(kd)},m.__private__.setFillColor=m.setFillColor=function(S,K,ne,Ce){return kd=Nr({ch1:S,ch2:K,ch3:ne,ch4:Ce,pdfColorType:"fill",precision:2}),ie(kd),this};var hi=e.textColor||"0 g",zc=m.__private__.getTextColor=m.getTextColor=function(){return Mr(hi)};m.__private__.setTextColor=m.setTextColor=function(S,K,ne,Ce){return hi=Nr({ch1:S,ch2:K,ch3:ne,ch4:Ce,pdfColorType:"text",precision:3}),this};var Oi=e.charSpace,Nl=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Oi||0)};m.__private__.setCharSpace=m.setCharSpace=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Oi=S,this};var rf=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(S){var K=m.CapJoinStyles[S];if(K===void 0)throw new Error("Line cap style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return rf=K,ie(K+" J"),this};var Zl=0;m.__private__.setLineJoin=m.setLineJoin=function(S){var K=m.CapJoinStyles[S];if(K===void 0)throw new Error("Line join style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zl=K,ie(K+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(S){if(S=S||0,isNaN(S))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ie(A(R(S))+" M"),this},m.GState=Vw,m.setGState=function(S){(S=typeof S=="string"?fr[yr[S]]:Ro(null,S)).equals(Xt)||(ie("/"+S.id+" gs"),Xt=S)};var Ro=function(S,K){if(!S||!yr[S]){var ne=!1;for(var Ce in fr)if(fr.hasOwnProperty(Ce)&&fr[Ce].equals(K)){ne=!0;break}if(ne)K=fr[Ce];else{var W="GS"+(Object.keys(fr).length+1).toString(10);fr[W]=K,K.id=W}return S&&(yr[S]=K.id),Ee.publish("addGState",K),K}};m.addGState=function(S,K){return Ro(S,K),this},m.saveGraphicsState=function(){return ie("q"),Se.push({key:we,size:ut,color:hi}),this},m.restoreGraphicsState=function(){ie("Q");var S=Se.pop();return we=S.key,ut=S.size,hi=S.color,Xt=null,this},m.setCurrentTransformationMatrix=function(S){return ie(S.toString()+" cm"),this},m.comment=function(S){return ie("#"+S),this};var yo=function(S,K){var ne=S||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ne},set:function(oe){isNaN(oe)||(ne=parseFloat(oe))}});var Ce=K||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ce},set:function(oe){isNaN(oe)||(Ce=parseFloat(oe))}});var W="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return W},set:function(oe){W=oe.toString()}}),this},nf=function(S,K,ne,Ce){yo.call(this,S,K),this.type="rect";var W=ne||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return W},set:function(Pe){isNaN(Pe)||(W=parseFloat(Pe))}});var oe=Ce||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return oe},set:function(Pe){isNaN(Pe)||(oe=parseFloat(Pe))}}),this},xu=function(){this.page=nr,this.currentPage=B,this.pages=ee.slice(0),this.pagesContext=ir.slice(0),this.x=ht,this.y=zt,this.matrix=hr,this.width=af(B),this.height=Ie(B),this.outputDestination=Le,this.id="",this.objectNumber=-1};xu.prototype.restore=function(){nr=this.page,B=this.currentPage,ir=this.pagesContext,ee=this.pages,ht=this.x,zt=this.y,hr=this.matrix,Ji(B,this.width),Ye(B,this.height),Le=this.outputDestination};var Fs=function(S,K,ne,Ce,W){St.push(new xu),nr=B=0,ee=[],ht=S,zt=K,hr=W,_r([ne,Ce])};for(var pi in m.beginFormObject=function(S,K,ne,Ce,W){return Fs(S,K,ne,Ce,W),this},m.endFormObject=function(S){return function(K){if(Qe[K])St.pop().restore();else{var ne=new xu,Ce="Xo"+(Object.keys(Ge).length+1).toString(10);ne.id=Ce,Qe[K]=Ce,Ge[Ce]=ne,Ee.publish("addFormObject",ne),St.pop().restore()}}(S),this},m.doFormObject=function(S,K){var ne=Ge[Qe[S]];return ie("q"),ie(K.toString()+" cm"),ie("/"+ne.id+" Do"),ie("Q"),this},m.getFormObject=function(S){var K=Ge[Qe[S]];return{x:K.x,y:K.y,width:K.width,height:K.height,matrix:K.matrix}},m.save=function(S,K){return S=S||"generated.pdf",(K=K||{}).returnPromise=K.returnPromise||!1,K.returnPromise===!1?(up(Te(re()),S),typeof up.unload=="function"&&da.setTimeout&&setTimeout(up.unload,911),this):new Promise(function(ne,Ce){try{var W=up(Te(re()),S);typeof up.unload=="function"&&da.setTimeout&&setTimeout(up.unload,911),ne(W)}catch(oe){Ce(oe.message)}})},Vn.API)Vn.API.hasOwnProperty(pi)&&(pi==="events"&&Vn.API.events.length?function(S,K){var ne,Ce,W;for(W=K.length-1;W!==-1;W--)ne=K[W][0],Ce=K[W][1],S.subscribe.apply(S,[ne].concat(typeof Ce=="function"?[Ce]:Ce))}(Ee,Vn.API.events):m[pi]=Vn.API[pi]);function af(S){return ir[S].mediaBox.topRightX-ir[S].mediaBox.bottomLeftX}function Ji(S,K){ir[S].mediaBox.topRightX=K+ir[S].mediaBox.bottomLeftX}function Ie(S){return ir[S].mediaBox.topRightY-ir[S].mediaBox.bottomLeftY}function Ye(S,K){ir[S].mediaBox.topRightY=K+ir[S].mediaBox.bottomLeftY}var ar=m.getPageWidth=function(S){return af(S=S||B)/He},Gt=m.setPageWidth=function(S,K){Ji(S,K*He)},Ut=m.getPageHeight=function(S){return Ie(S=S||B)/He},Ot=m.setPageHeight=function(S,K){Ye(S,K*He)};return m.internal={pdfEscape:jt,getStyle:rt,getFont:Xn,getFontSize:Nt,getCharSpace:Nl,getTextColor:zc,getLineHeight:Ma,getLineHeightFactor:$a,getLineWidth:Gr,write:dt,getHorizontalCoordinate:ss,getVerticalCoordinate:ao,getCoordinateString:xo,getVerticalCoordinateString:Ss,collections:{},newObject:Dt,newAdditionalObject:wt,newObjectDeferred:Ft,newObjectDeferredBegin:ye,getFilters:Rr,putStream:Er,events:Ee,scaleFactor:He,pageSize:{getWidth:function(){return ar(B)},setWidth:function(S){Gt(B,S)},getHeight:function(){return Ut(B)},setHeight:function(S){Ot(B,S)}},encryptionOptions:u,encryption:T,getEncryptor:function(S){return u!==null?T.encryptor(S,0):function(K){return K}},output:ot,getNumberOfPages:Br,pages:ee,out:ie,f2:M,f3:I,getPageInfo:O,getPageInfoByObjId:X,getCurrentPageInfo:G,getPDFVersion:g,Point:yo,Rectangle:nf,Matrix:pt,hasHotfix:te},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return ar(B)},set:function(S){Gt(B,S)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Ut(B)},set:function(S){Ot(B,S)},enumerable:!0,configurable:!0}),function(S){for(var K=0,ne=st.length;K<ne;K++){var Ce=Fr.call(this,S[K][0],S[K][1],S[K][2],st[K][3],!0);f===!1&&(h[Ce]=!0);var W=S[K][0].split("-");Ze({id:Ce,fontName:W[0],fontStyle:W[1]||""})}Ee.publish("addFonts",{fonts:Mt,dictionary:Qt})}.call(m,st),we="F1",bt(o,r),Ee.publish("initialized"),m}hv.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},hv.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},hv.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},hv.prototype.processOwnerPassword=function(e,t){return $T(FT(t).substr(0,5),e)},hv.prototype.encryptor=function(e,t){var r=FT(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return $T(r,n)}},Vw.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Fa(e)!==Fa(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Vn.API={events:[]},Vn.version="3.0.3";var us=Vn.API,tR=1,Og=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},rv=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ya=function(e){return e.toFixed(2)},xm=function(e){return e.toFixed(5)};us.__acroform__={};var Ql=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},w9=function(e){return e*tR},Nu=function(e){var t=new eae,r=Rn.internal.getHeight(e)||0,n=Rn.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ya(n)),Number(ya(r))],t},xQe=us.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},yQe=us.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},bQe=us.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},bs=us.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return bQe(e,t-1)},ws=us.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return xQe(e,t-1)},js=us.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return yQe(e,t-1)},wQe=us.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,o=e[0],s=e[1],i=e[2],l=e[3],c={};return c.lowerLeft_X=r(o)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(o+i)||0,c.upperRight_Y=n(s)||0,[Number(ya(c.lowerLeft_X)),Number(ya(c.lowerLeft_Y)),Number(ya(c.upperRight_X)),Number(ya(c.upperRight_Y))]},jQe=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=BT(e,r),o=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+o+" "+ya(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Nu(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},BT=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},o=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");o=e.multiline?o.map(function(M){return M.split(`
`)}):o.map(function(M){return[M]});var s=r,i=Rn.internal.getHeight(e)||0;i=i<0?-i:i;var l=Rn.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(M,I,R){if(M+1<o.length){var D=I+" "+o[M+1][0];return fj(D,e,R).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var d,u,f=fj("3",e,s).height,h=e.multiline?i-s:(i-f)/2,m=h+=2,v=0,g=0,y=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+fj(t,e,s=12).width+", FieldWidth:"+l+`
`;break}for(var x="",b=0,w=0;w<o.length;w++)if(o.hasOwnProperty(w)){var j=!1;if(o[w].length!==1&&y!==o[w].length-1){if((f+2)*(b+2)+2>i)continue e;x+=o[w][y],j=!0,g=w,w--}else{x=(x+=o[w][y]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var _=parseInt(w),C=c(_,x,s),E=w>=o.length-1;if(C&&!E){x+=" ",y=0;continue}if(C||E){if(E)g=_;else if(e.multiline&&(f+2)*(b+2)+2>i)continue e}else{if(!e.multiline||(f+2)*(b+2)+2>i)continue e;g=_}}for(var A="",P=v;P<=g;P++){var F=o[P];if(e.multiline){if(P===g){A+=F[y]+" ",y=(y+1)%F.length;continue}if(P===v){A+=F[F.length-1]+" ";continue}}A+=F[0]+" "}switch(A=A.substr(A.length-1)==" "?A.substr(0,A.length-1):A,u=fj(A,e,s).width,e.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}t+=ya(d)+" "+ya(m)+` Td
`,t+="("+Og(A)+`) Tj
`,t+=-ya(d)+` 0 Td
`,m=-(s+2),u=0,v=j?g:g+1,b++,x=""}break}return n.text=t,n.fontSize=s,n},fj=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),o=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:o}},_Qe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},NQe=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},SQe=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(pu.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(_Qe)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");tR=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new tae,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var o in n)if(n.hasOwnProperty(o)){var s=n[o];s.objId=void 0,s.hasAnnotation&&NQe(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,o){var s=!n;for(var i in n||(o.internal.newObjectDeferredBegin(o.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),o.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||o.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var l=n[i],c=[],d=l.Rect;if(l.Rect&&(l.Rect=wQe(l.Rect,o)),o.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Rn.createDefaultAppearanceStream(l),Fa(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=jQe(l);c.push({key:"AP",value:"<</N "+u+">>"}),o.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var f="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var m=l.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var i in m)if(m.hasOwnProperty(i)){var v=m[i];typeof v=="function"&&(v=v.call(o,l)),f+="/"+i+" "+v+" ",o.internal.acroformPlugin.xForms.indexOf(v)>=0||o.internal.acroformPlugin.xForms.push(v)}}else typeof(v=m)=="function"&&(v=v.call(o,l)),f+="/"+i+" "+v,o.internal.acroformPlugin.xForms.indexOf(v)>=0||o.internal.acroformPlugin.xForms.push(v);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}o.internal.putStream({additionalKeyValues:c,objectId:l.objId}),o.internal.out("endobj")}s&&function(g,y){for(var x in g)if(g.hasOwnProperty(x)){var b=x,w=g[x];y.internal.newObjectDeferredBegin(w.objId,!0),Fa(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[b]}}(o.internal.acroformPlugin.xForms,o)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},Zne=us.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(i){return i};if(Array.isArray(e)){for(var o="[",s=0;s<e.length;s++)switch(s!==0&&(o+=" "),Fa(e[s])){case"boolean":case"number":case"object":o+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),o+="("+Og(n(e[s].toString()))+")"):o+=e[s].toString()}return o+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},CE=function(e,t,r){var n=function(o){return o};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Og(n(e))+")"},Lu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Lu.prototype.toString=function(){return this.objId+" 0 R"},Lu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Lu.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],o=this[n];o&&(Array.isArray(o)?e.push({key:n,value:Zne(o,this.objId,this.scope)}):o instanceof Lu?(o.scope=this.scope,e.push({key:n,value:o.objId+" 0 R"})):typeof o!="function"&&e.push({key:n,value:o}))}return e};var eae=function(){Lu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ql(eae,Lu);var tae=function(){Lu.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Og(r(e))+")"}},set:function(r){e=r}})};Ql(tae,Lu);var pu=function e(){Lu.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!bs(t,3)},set:function(x){x?this.F=ws(t,3):this.F=js(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var o="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return o},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":o=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof gS)return;s="FieldObject"+e.FieldNum++}var x=function(b){return b};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Og(x(s))+")"},set:function(x){s=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(x){s=x}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(x){i=x}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/tR:d},set:function(x){d=x}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(x){u=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof gS||this instanceof ph))return CE(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Hs==0?CE(h,this.objId,this.scope):h},set:function(x){x=x.toString(),h=this instanceof Hs==0?x.substr(0,1)==="("?rv(x.substr(1,x.length-2)):rv(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Hs==1?rv(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof Hs==1?"/"+x:x}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Hs==0?CE(m,this.objId,this.scope):m},set:function(x){x=x.toString(),m=this instanceof Hs==0?x.substr(0,1)==="("?rv(x.substr(1,x.length-2)):rv(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Hs==1?rv(m.substr(1,m.length-1)):m},set:function(x){x=x.toString(),m=this instanceof Hs==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(x){x=!!x,g=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(x){v=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,1)},set:function(x){x?this.Ff=ws(this.Ff,1):this.Ff=js(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,2)},set:function(x){x?this.Ff=ws(this.Ff,2):this.Ff=js(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,3)},set:function(x){x?this.Ff=ws(this.Ff,3):this.Ff=js(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');y=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(y){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Ql(pu,Lu);var zp=function(){pu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Zne(t,this.objId,this.scope)},set:function(r){var n,o;o=[],typeof(n=r)=="string"&&(o=function(s,i,l){l||(l=1);for(var c,d=[];c=i.exec(s);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),t=o}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,18)},set:function(r){r?this.Ff=ws(this.Ff,18):this.Ff=js(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=ws(this.Ff,19):this.Ff=js(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,20)},set:function(r){r?(this.Ff=ws(this.Ff,20),t.sort()):this.Ff=js(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,22)},set:function(r){r?this.Ff=ws(this.Ff,22):this.Ff=js(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,23)},set:function(r){r?this.Ff=ws(this.Ff,23):this.Ff=js(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,27)},set:function(r){r?this.Ff=ws(this.Ff,27):this.Ff=js(this.Ff,27)}}),this.hasAppearanceStream=!1};Ql(zp,pu);var Up=function(){zp.call(this),this.fontName="helvetica",this.combo=!1};Ql(Up,zp);var Vp=function(){Up.call(this),this.combo=!0};Ql(Vp,Up);var mb=function(){Vp.call(this),this.edit=!0};Ql(mb,Vp);var Hs=function(){pu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,15)},set:function(r){r?this.Ff=ws(this.Ff,15):this.Ff=js(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,16)},set:function(r){r?this.Ff=ws(this.Ff,16):this.Ff=js(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,17)},set:function(r){r?this.Ff=ws(this.Ff,17):this.Ff=js(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,26)},set:function(r){r?this.Ff=ws(this.Ff,26):this.Ff=js(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,o=[];for(n in o.push("<<"),t)o.push("/"+n+" ("+Og(r(t[n]))+")");return o.push(">>"),o.join(`
`)}},set:function(r){Fa(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Ql(Hs,pu);var hb=function(){Hs.call(this),this.pushButton=!0};Ql(hb,Hs);var Wp=function(){Hs.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ql(Wp,Hs);var gS=function(){var e,t;pu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(o){e=o}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(o){t=o}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(l){return l};this.scope&&(o=this.scope.internal.getEncryptor(this.objId));var s,i=[];for(s in i.push("<<"),n)i.push("/"+s+" ("+Og(o(n[s]))+")");return i.push(">>"),i.join(`
`)},set:function(o){Fa(o)==="object"&&(n=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(o){typeof o=="string"&&(n.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(o){r=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(o){r="/"+o}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Rn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ql(gS,pu),Wp.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Wp.prototype.createOption=function(e){var t=new gS;return t.Parent=this,t.optionName=e,this.Kids.push(t),CQe.call(this.scope,t),t};var pb=function(){Hs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Rn.CheckBox.createAppearanceStream()};Ql(pb,Hs);var ph=function(){pu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,13)},set:function(t){t?this.Ff=ws(this.Ff,13):this.Ff=js(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,21)},set:function(t){t?this.Ff=ws(this.Ff,21):this.Ff=js(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,23)},set:function(t){t?this.Ff=ws(this.Ff,23):this.Ff=js(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,24)},set:function(t){t?this.Ff=ws(this.Ff,24):this.Ff=js(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,25)},set:function(t){t?this.Ff=ws(this.Ff,25):this.Ff=js(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,26)},set:function(t){t?this.Ff=ws(this.Ff,26):this.Ff=js(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ql(ph,pu);var gb=function(){ph.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,14)},set:function(e){e?this.Ff=ws(this.Ff,14):this.Ff=js(this.Ff,14)}}),this.password=!0};Ql(gb,ph);var Rn={CheckBox:{createAppearanceStream:function(){return{N:{On:Rn.CheckBox.YesNormal},D:{On:Rn.CheckBox.YesPushDown,Off:Rn.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Nu(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,o=e.scope.__private__.encodeColorString(e.color),s=BT(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+ya(Rn.internal.getWidth(e))+" "+ya(Rn.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+ya(s.fontSize)+" Tf "+o),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Nu(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),o=[],s=Rn.internal.getHeight(e),i=Rn.internal.getWidth(e),l=BT(e,e.caption);return o.push("1 g"),o.push("0 0 "+ya(i)+" "+ya(s)+" re"),o.push("f"),o.push("q"),o.push("0 0 1 rg"),o.push("0 0 "+ya(i-1)+" "+ya(s-1)+" re"),o.push("W"),o.push("n"),o.push("0 g"),o.push("BT"),o.push("/"+r+" "+ya(l.fontSize)+" Tf "+n),o.push(l.text),o.push("ET"),o.push("Q"),t.stream=o.join(`
`),t},OffPushDown:function(e){var t=Nu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ya(Rn.internal.getWidth(e))+" "+ya(Rn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Rn.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Rn.RadioButton.Circle.YesNormal,t.D[e]=Rn.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Nu(e);t.scope=e.scope;var r=[],n=Rn.internal.getWidth(e)<=Rn.internal.getHeight(e)?Rn.internal.getWidth(e)/4:Rn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var o=Rn.internal.Bezier_C,s=Number((n*o).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+xm(Rn.internal.getWidth(e)/2)+" "+xm(Rn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Nu(e);t.scope=e.scope;var r=[],n=Rn.internal.getWidth(e)<=Rn.internal.getHeight(e)?Rn.internal.getWidth(e)/4:Rn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var o=Number((2*n).toFixed(5)),s=Number((o*Rn.internal.Bezier_C).toFixed(5)),i=Number((n*Rn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+xm(Rn.internal.getWidth(e)/2)+" "+xm(Rn.internal.getHeight(e)/2)+" cm"),r.push(o+" 0 m"),r.push(o+" "+s+" "+s+" "+o+" 0 "+o+" c"),r.push("-"+s+" "+o+" -"+o+" "+s+" -"+o+" 0 c"),r.push("-"+o+" -"+s+" -"+s+" -"+o+" 0 -"+o+" c"),r.push(s+" -"+o+" "+o+" -"+s+" "+o+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+xm(Rn.internal.getWidth(e)/2)+" "+xm(Rn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Nu(e);t.scope=e.scope;var r=[],n=Rn.internal.getWidth(e)<=Rn.internal.getHeight(e)?Rn.internal.getWidth(e)/4:Rn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var o=Number((2*n).toFixed(5)),s=Number((o*Rn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+xm(Rn.internal.getWidth(e)/2)+" "+xm(Rn.internal.getHeight(e)/2)+" cm"),r.push(o+" 0 m"),r.push(o+" "+s+" "+s+" "+o+" 0 "+o+" c"),r.push("-"+s+" "+o+" -"+o+" "+s+" -"+o+" 0 c"),r.push("-"+o+" -"+s+" -"+s+" -"+o+" 0 -"+o+" c"),r.push(s+" -"+o+" "+o+" -"+s+" "+o+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Rn.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Rn.RadioButton.Cross.YesNormal,t.D[e]=Rn.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Nu(e);t.scope=e.scope;var r=[],n=Rn.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+ya(Rn.internal.getWidth(e)-2)+" "+ya(Rn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ya(n.x1.x)+" "+ya(n.x1.y)+" m"),r.push(ya(n.x2.x)+" "+ya(n.x2.y)+" l"),r.push(ya(n.x4.x)+" "+ya(n.x4.y)+" m"),r.push(ya(n.x3.x)+" "+ya(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Nu(e);t.scope=e.scope;var r=Rn.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+ya(Rn.internal.getWidth(e))+" "+ya(Rn.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ya(Rn.internal.getWidth(e)-2)+" "+ya(Rn.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(ya(r.x1.x)+" "+ya(r.x1.y)+" m"),n.push(ya(r.x2.x)+" "+ya(r.x2.y)+" l"),n.push(ya(r.x4.x)+" "+ya(r.x4.y)+" m"),n.push(ya(r.x3.x)+" "+ya(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Nu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ya(Rn.internal.getWidth(e))+" "+ya(Rn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Rn.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Rn.internal.getWidth(e),r=Rn.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},Rn.internal.getWidth=function(e){var t=0;return Fa(e)==="object"&&(t=w9(e.Rect[2])),t},Rn.internal.getHeight=function(e){var t=0;return Fa(e)==="object"&&(t=w9(e.Rect[3])),t};var CQe=us.addField=function(e){if(SQe(this,e),!(e instanceof pu))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};us.AcroFormChoiceField=zp,us.AcroFormListBox=Up,us.AcroFormComboBox=Vp,us.AcroFormEditBox=mb,us.AcroFormButton=Hs,us.AcroFormPushButton=hb,us.AcroFormRadioButton=Wp,us.AcroFormCheckBox=pb,us.AcroFormTextField=ph,us.AcroFormPasswordField=gb,us.AcroFormAppearance=Rn,us.AcroForm={ChoiceField:zp,ListBox:Up,ComboBox:Vp,EditBox:mb,Button:Hs,PushButton:hb,RadioButton:Wp,CheckBox:pb,TextField:ph,PasswordField:gb,Appearance:Rn},Vn.AcroForm={ChoiceField:zp,ListBox:Up,ComboBox:Vp,EditBox:mb,Button:Hs,PushButton:hb,RadioButton:Wp,CheckBox:pb,TextField:ph,PasswordField:gb,Appearance:Rn};var PQe=Vn.AcroForm;function rae(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},o=e.__addimage__.getImageFileTypeByImageData=function(M,I){var R,D,U,z,H,q=r;if((I=I||r)==="RGBA"||M.data!==void 0&&M.data instanceof Uint8ClampedArray&&"height"in M&&"width"in M)return"RGBA";if(C(M))for(H in n)for(U=n[H],R=0;R<U.length;R+=1){for(z=!0,D=0;D<U[R].length;D+=1)if(U[R][D]!==void 0&&U[R][D]!==M[D]){z=!1;break}if(z===!0){q=H;break}}else for(H in n)for(U=n[H],R=0;R<U.length;R+=1){for(z=!0,D=0;D<U[R].length;D+=1)if(U[R][D]!==void 0&&U[R][D]!==M.charCodeAt(D)){z=!1;break}if(z===!0){q=H;break}}return q===r&&I!==r&&(q=I),q},s=function M(I){for(var R=this.internal.write,D=this.internal.putStream,U=(0,this.internal.getFilters)();U.indexOf("FlateEncode")!==-1;)U.splice(U.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var z=[];if(z.push({key:"Type",value:"/XObject"}),z.push({key:"Subtype",value:"/Image"}),z.push({key:"Width",value:I.width}),z.push({key:"Height",value:I.height}),I.colorSpace===x.INDEXED?z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(z.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===x.DEVICE_CMYK&&z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),z.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&z.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)&&I.transparency.length>0){for(var H="",q=0,Q=I.transparency.length;q<Q;q++)H+=I.transparency[q]+" "+I.transparency[q]+" ";z.push({key:"Mask",value:"["+H+"]"})}I.sMask!==void 0&&z.push({key:"SMask",value:I.objectId+1+" 0 R"});var pe=I.filter!==void 0?["/"+I.filter]:void 0;if(D({data:I.data,additionalKeyValues:z,alreadyAppliedFilters:pe,objectId:I.objectId}),R("endobj"),"sMask"in I&&I.sMask!==void 0){var be,V=(be=I.sMaskBitsPerComponent)!==null&&be!==void 0?be:I.bitsPerComponent,B={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:V,data:I.sMask};"filter"in I&&(B.decodeParameters="/Predictor ".concat(I.predictor," /Colors 1 /BitsPerComponent ").concat(V," /Columns ").concat(I.width),B.filter=I.filter),M.call(this,B)}if(I.colorSpace===x.INDEXED){var J=this.internal.newObject();D({data:A(new Uint8Array(I.palette)),objectId:J}),R("endobj")}},i=function(){var M=this.internal.collections[t+"images"];for(var I in M)s.call(this,M[I])},l=function(){var M,I=this.internal.collections[t+"images"],R=this.internal.write;for(var D in I)R("/I"+(M=I[D]).index,M.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var M=this.internal.collections[t+"images"];return c.call(this),M},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(M){return typeof e["process"+M.toUpperCase()]=="function"},h=function(M){return Fa(M)==="object"&&M.nodeType===1},m=function(M,I){if(M.nodeName==="IMG"&&M.hasAttribute("src")){var R=""+M.getAttribute("src");if(R.indexOf("data:image/")===0)return e_(unescape(R).split("base64,").pop());var D=e.loadFile(R,!0);if(D!==void 0)return D}if(M.nodeName==="CANVAS"){if(M.width===0||M.height===0)throw new Error("Given canvas must have data. Canvas width: "+M.width+", height: "+M.height);var U;switch(I){case"PNG":U="image/png";break;case"WEBP":U="image/webp";break;default:U="image/jpeg"}return e_(M.toDataURL(U,1).split("base64,").pop())}},v=function(M){var I=this.internal.collections[t+"images"];if(I){for(var R in I)if(M===I[R].alias)return I[R]}},g=function(M,I,R){return M||I||(M=-96,I=-96),M<0&&(M=-1*R.width*72/M/this.internal.scaleFactor),I<0&&(I=-1*R.height*72/I/this.internal.scaleFactor),M===0&&(M=I*R.width/R.height),I===0&&(I=M*R.height/R.width),[M,I]},y=function(M,I,R,D,U,z){var H=g.call(this,R,D,U),q=this.internal.getCoordinateString,Q=this.internal.getVerticalCoordinateString,pe=d.call(this);if(R=H[0],D=H[1],pe[U.index]=U,z){z*=Math.PI/180;var be=Math.cos(z),V=Math.sin(z),B=function(ue){return ue.toFixed(4)},J=[B(be),B(V),B(-1*V),B(be),0,0,"cm"]}this.internal.write("q"),z?(this.internal.write([1,"0","0",1,q(M),Q(I+D),"cm"].join(" ")),this.internal.write(J.join(" ")),this.internal.write([q(R),"0","0",q(D),"0","0","cm"].join(" "))):this.internal.write([q(R),"0","0",q(D),q(M),Q(I+D),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+U.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(M){var I,R,D=0;if(typeof M=="string")for(R=M.length,I=0;I<R;I++)D=(D<<5)-D+M.charCodeAt(I),D|=0;else if(C(M))for(R=M.byteLength/2,I=0;I<R;I++)D=(D<<5)-D+M[I],D|=0;return D},j=e.__addimage__.validateStringAsBase64=function(M){(M=M||"").toString().trim();var I=!0;return M.length===0&&(I=!1),M.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(M.substr(0,M.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(M.substr(-2))===!1&&(I=!1),I},_=e.__addimage__.extractImageFromDataUrl=function(M){if(M==null||!(M=M.trim()).startsWith("data:"))return null;var I=M.indexOf(",");return I<0?null:M.substring(0,I).trim().endsWith("base64")?M.substring(I+1):null};e.__addimage__.isArrayBuffer=function(M){return M instanceof ArrayBuffer};var C=e.__addimage__.isArrayBufferView=function(M){return M instanceof Int8Array||M instanceof Uint8Array||M instanceof Uint8ClampedArray||M instanceof Int16Array||M instanceof Uint16Array||M instanceof Int32Array||M instanceof Uint32Array||M instanceof Float32Array||M instanceof Float64Array},E=e.__addimage__.binaryStringToUint8Array=function(M){for(var I=M.length,R=new Uint8Array(I),D=0;D<I;D++)R[D]=M.charCodeAt(D);return R},A=e.__addimage__.arrayBufferToBinaryString=function(M){for(var I="",R=C(M)?M:new Uint8Array(M),D=0;D<R.length;D+=8192)I+=String.fromCharCode.apply(null,R.subarray(D,D+8192));return I};e.addImage=function(){var M,I,R,D,U,z,H,q,Q;if(typeof arguments[1]=="number"?(I=r,R=arguments[1],D=arguments[2],U=arguments[3],z=arguments[4],H=arguments[5],q=arguments[6],Q=arguments[7]):(I=arguments[1],R=arguments[2],D=arguments[3],U=arguments[4],z=arguments[5],H=arguments[6],q=arguments[7],Q=arguments[8]),Fa(M=arguments[0])==="object"&&!h(M)&&"imageData"in M){var pe=M;M=pe.imageData,I=pe.format||I||r,R=pe.x||R||0,D=pe.y||D||0,U=pe.w||pe.width||U,z=pe.h||pe.height||z,H=pe.alias||H,q=pe.compression||q,Q=pe.rotation||pe.angle||Q}var be=this.internal.getFilters();if(q===void 0&&be.indexOf("FlateEncode")!==-1&&(q="SLOW"),isNaN(R)||isNaN(D))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var V=P.call(this,M,I,H,q);return y.call(this,R,D,U,z,V,Q),this};var P=function(M,I,R,D){var U,z,H;if(typeof M=="string"&&o(M)===r){M=unescape(M);var q=F(M,!1);(q!==""||(q=e.loadFile(M,!0))!==void 0)&&(M=q)}if(h(M)&&(M=m(M,I)),I=o(M,I),!f(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((H=R)==null||H.length===0)&&(R=function(Q){return typeof Q=="string"||C(Q)?w(Q):C(Q.data)?w(Q.data):null}(M)),(U=v.call(this,R))||(M instanceof Uint8Array||I==="RGBA"||(z=M,M=E(M)),U=this["process"+I.toUpperCase()](M,u.call(this),R,function(Q){return Q&&typeof Q=="string"&&(Q=Q.toUpperCase()),Q in e.image_compression?Q:b.NONE}(D),z)),!U)throw new Error("An unknown error occurred whilst processing the image.");return U},F=e.__addimage__.convertBase64ToBinaryString=function(M,I){I=typeof I!="boolean"||I;var R,D="";if(typeof M=="string"){var U;R=(U=_(M))!==null&&U!==void 0?U:M;try{D=e_(R)}catch(z){if(I)throw j(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return D};e.getImageProperties=function(M){var I,R,D="";if(h(M)&&(M=m(M)),typeof M=="string"&&o(M)===r&&((D=F(M,!1))===""&&(D=e.loadFile(M)||""),M=D),R=o(M),!f(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(M instanceof Uint8Array||(M=E(M)),!(I=this["process"+R.toUpperCase()](M)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=R,I}})(Vn.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Vn.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,o,s,i=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,f=0;f<d.length&&!u;f++)switch((n=d[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var h=0;h<d.length;h++){n=d[h];var m=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(g.objId),b=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(o="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(x(n.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+m(x(b))+") >>",g.content=s;var w=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(o="/Rect ["+i(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":o="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+o+"/Contents ("+m(v(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var _=this.annotations._nameMap[n.options.name];n.options.pageNumber=_.page,n.options.top=_.y}else n.options.top||(n.options.top=0);if(o="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /A <</S /URI /URI ("+m(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var C=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+C+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,o,s,i){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+o),h:d(n+s)},options:i,type:"link"})},e.textWithLink=function(r,n,o,s){var i,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var u=this.splitTextToSize(r,l).length;i=Math.ceil(d*u)}else l=c,i=d;return this.text(r,n,o,s),o+=.2*d,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,o-d,l,i,s),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Vn.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},o=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},i=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return i(g)&&o.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,x=r,b="",w=0;for(y=0;y<g.length;y+=1)x[g.charCodeAt(y)]!==void 0?(w++,typeof(x=x[g.charCodeAt(y)])=="number"&&(b+=String.fromCharCode(x),x=r,w=0),y===g.length-1&&(x=r,b+=g.charAt(y-(w-1)),y-=w-1,w=0)):(x=r,b+=g.charAt(y-w),y-=w,w=0);return b};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var h=e.__arabicParser__.getCorrectForm=function(g,y,x){return i(g)?s(g)===!1?-1:!d(g)||!i(y)&&!i(x)||!i(x)&&l(y)||l(g)&&!i(y)||l(g)&&c(y)||l(g)&&l(y)?0:u(g)&&i(y)&&!l(y)&&i(x)&&d(x)?3:l(g)||!i(x)?1:2:-1},m=function(g){var y=0,x=0,b=0,w="",j="",_="",C=(g=g||"").split("\\s+"),E=[];for(y=0;y<C.length;y+=1){for(E.push(""),x=0;x<C[y].length;x+=1)w=C[y][x],j=C[y][x-1],_=C[y][x+1],i(w)?(b=h(w,j,_),E[y]+=b!==-1?String.fromCharCode(t[w.charCodeAt(0)][b]):w):E[y]+=w;E[y]=f(E[y])}return E.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(y)){var b=0;for(x=[],b=0;b<y.length;b+=1)Array.isArray(y[b])?x.push([m(y[b][0]),y[b][1],y[b][2]]):x.push([m(y[b])]);g=x}else g=m(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",v])}(Vn.API),Vn.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var o=300;Object.defineProperty(this,"height",{get:function(){return o},set:function(l){o=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=o+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(l){i=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var o;if((r=r||"2d")!=="2d")return null;for(o in n)this.pdf.context2d.hasOwnProperty(o)&&(this.pdf.context2d[o]=n[o]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Vn.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),o.call(this))},o=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(g){v=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),f=d.font||this.getFont(),h=d.scaleFactor||this.internal.scaleFactor,m=0,v=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=d.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,j){return w.concat(y.splitTextToSize(j,x))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)m<(g=this.getStringUnitWidth(c[b],{font:f})*u)&&(m=g);return m!==0&&(v=c.length),{w:m/=h,h:Math.max((v*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/h,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,h=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,m&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,d,u,f,h){if(n.call(this),!u)throw new Error("No data for PDF table.");var m,v,g,y,x=[],b=[],w=[],j={},_={},C=[],E=[],A=(h=h||{}).autoSize||!1,P=h.printHeaders!==!1,F=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,M=h.margins||Object.assign({width:this.getPageWidth()},t),I=typeof h.padding=="number"?h.padding:3,R=h.headerBackgroundColor||"#c8c8c8",D=h.headerTextColor||"#000";if(o.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=M,this.internal.__cell__.table_font_size=F,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=D,this.setFontSize(F),f==null)b=x=Object.keys(u[0]),w=x.map(function(){return"left"});else if(Array.isArray(f)&&Fa(f[0])==="object")for(x=f.map(function(pe){return pe.name}),b=f.map(function(pe){return pe.prompt||pe.name||""}),w=f.map(function(pe){return pe.align||"left"}),m=0;m<f.length;m+=1)_[f[m].name]=.7499990551181103*f[m].width;else Array.isArray(f)&&typeof f[0]=="string"&&(b=x=f,w=x.map(function(){return"left"}));if(A||Array.isArray(f)&&typeof f[0]=="string")for(m=0;m<x.length;m+=1){for(j[y=x[m]]=u.map(function(pe){return pe[y]}),this.setFont(void 0,"bold"),C.push(this.getTextDimensions(b[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=j[y],this.setFont(void 0,"normal"),g=0;g<v.length;g+=1)C.push(this.getTextDimensions(v[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);_[y]=Math.max.apply(null,C)+I+I,C=[]}if(P){var U={};for(m=0;m<x.length;m+=1)U[x[m]]={},U[x[m]].text=b[m],U[x[m]].align=w[m];var z=l.call(this,U,_);E=x.map(function(pe){return new s(c,d,_[pe],z,U[pe].text,void 0,U[pe].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var H=f.reduce(function(pe,be){return pe[be.name]=be.align,pe},{});for(m=0;m<u.length;m+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:m,data:u[m]},this);var q=l.call(this,u[m],_);for(g=0;g<x.length;g+=1){var Q=u[m][x[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:m,col:g,data:Q},this),i.call(this,new s(c,d,_[x[g]],q,Q,m+2,H[x[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(m){var v=c[m];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,d[m]-u-u)},this).map(function(m){return this.getLineHeightFactor()*m.length*f/h+u+u},this).reduce(function(m,v){return Math.max(m,v)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){u=this.internal.__cell__.tableHeaderRow[m].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,h.push(u)),u.lineNumber=c;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,u),this.setTextColor(v)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(Vn.API);var nae={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},aae=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],qT=rae(aae),oae=[100,200,300,400,500,600,700,800,900],AQe=rae(oae);function PE(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return nae[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),o=function(s){return typeof qT[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:o,src:e.src||[],ref:e.ref||{name:t,style:[o,r,n].join(" ")}}}function j9(e,t,r,n){var o;for(o=r;o>=0&&o<t.length;o+=n)if(e[t[o]])return e[t[o]];for(o=r;o>=0&&o<t.length;o-=n)if(e[t[o]])return e[t[o]]}var EQe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},_9={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function N9(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function S9(e){return e.trimLeft()}function kQe(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function IQe(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var mj,C9,P9,nv,hj,A9,E9,k9,AE=["times"];function I9(e,t,r,n,o){var s=4,i=T9;switch(o){case Vn.API.image_compression.FAST:s=1,i=O9;break;case Vn.API.image_compression.MEDIUM:s=6,i=D9;break;case Vn.API.image_compression.SLOW:s=9,i=M9}e=function(c,d,u,f){for(var h,m=c.length/d,v=new Uint8Array(c.length+m),g=[OQe,O9,T9,D9,M9],y=0;y<m;y+=1){var x=y*d,b=c.subarray(x,x+d);if(f)v.set(f(b,u,h),x+y);else{for(var w=g.length,j=[],_=0;_<w;_+=1)j[_]=g[_](b,u,h);var C=DQe(j.concat());v.set(j[C],x+y)}h=b}return v}(e,t,Math.ceil(r*n/8),i);var l=AT(e,{level:s});return Vn.API.__addimage__.arrayBufferToBinaryString(l)}function OQe(e){var t=Array.apply([],e);return t.unshift(0),t}function O9(e,t){var r=e.length,n=[];n[0]=1;for(var o=0;o<r;o+=1){var s=e[o-t]||0;n[o+1]=e[o]-s+256&255}return n}function T9(e,t,r){var n=e.length,o=[];o[0]=2;for(var s=0;s<n;s+=1){var i=r&&r[s]||0;o[s+1]=e[s]-i+256&255}return o}function D9(e,t,r){var n=e.length,o=[];o[0]=3;for(var s=0;s<n;s+=1){var i=e[s-t]||0,l=r&&r[s]||0;o[s+1]=e[s]+256-(i+l>>>1)&255}return o}function M9(e,t,r){var n=e.length,o=[];o[0]=4;for(var s=0;s<n;s+=1){var i=TQe(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);o[s+1]=e[s]-i+256&255}return o}function TQe(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),o=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=o&&n<=s?e:o<=s?t:r}function DQe(e){var t=e.map(function(r){return r.reduce(function(n,o){return n+Math.abs(o)},0)});return t.indexOf(Math.min.apply(null,t))}function EE(e,t,r){var n=t*r,o=Math.floor(n/8),s=16-(n-8*o+r),i=(1<<r)-1;return sae(e,o)>>s&i}function R9(e,t,r,n){var o=r*n,s=Math.floor(o/8),i=16-(o-8*s+n),l=(1<<n)-1,c=(t&l)<<i;(function(d,u,f){if(u+1<d.byteLength)d.setUint16(u,f,!1);else{var h=f>>8&255;d.setUint8(u,h)}})(e,s,sae(e,s)&~(l<<i)&65535|c)}function sae(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function MQe(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,o=e[t++],s=o>>7,i=1<<1+(7&o);e[t++],e[t++];var l=null,c=null;s&&(l=t,c=i,t+=3*i);var d=!0,u=[],f=0,h=null,m=0,v=null;for(this.width=r,this.height=n;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((M=e[t++])>=0))throw Error("Invalid block size");if(M===0)break;t+=M}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,h=e[t++],1&g||(h=null),m=g>>2&7,t++;break;case 254:for(;;){if(!((M=e[t++])>=0))throw Error("Invalid block size");if(M===0)break;t+=M}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,j=e[t++],_=j>>6&1,C=1<<1+(7&j),E=l,A=c,P=!1;j>>7&&(P=!0,E=t,A=C,t+=3*C);var F=t;for(t++;;){var M;if(!((M=e[t++])>=0))throw Error("Invalid block size");if(M===0)break;t+=M}u.push({x:y,y:x,width:b,height:w,has_local_palette:P,palette_offset:E,palette_size:A,data_offset:F,data_length:t-F,transparent_index:h,interlaced:!!_,delay:f,disposal:m});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return v},this.frameInfo=function(I){if(I<0||I>=u.length)throw new Error("Frame index out of range.");return u[I]},this.decodeAndBlitFrameBGRA=function(I,R){var D=this.frameInfo(I),U=D.width*D.height,z=new Uint8Array(U);L9(e,D.data_offset,z,U);var H=D.palette_offset,q=D.transparent_index;q===null&&(q=256);var Q=D.width,pe=r-Q,be=Q,V=4*(D.y*r+D.x),B=4*((D.y+D.height)*r+D.x),J=V,ue=4*pe;D.interlaced===!0&&(ue+=4*r*7);for(var Ne=8,Z=0,ge=z.length;Z<ge;++Z){var le=z[Z];if(be===0&&(be=Q,(J+=ue)>=B&&(ue=4*pe+4*r*(Ne-1),J=V+(Q+pe)*(Ne<<1),Ne>>=1)),le===q)J+=4;else{var se=e[H+3*le],ee=e[H+3*le+1],de=e[H+3*le+2];R[J++]=de,R[J++]=ee,R[J++]=se,R[J++]=255}--be}},this.decodeAndBlitFrameRGBA=function(I,R){var D=this.frameInfo(I),U=D.width*D.height,z=new Uint8Array(U);L9(e,D.data_offset,z,U);var H=D.palette_offset,q=D.transparent_index;q===null&&(q=256);var Q=D.width,pe=r-Q,be=Q,V=4*(D.y*r+D.x),B=4*((D.y+D.height)*r+D.x),J=V,ue=4*pe;D.interlaced===!0&&(ue+=4*r*7);for(var Ne=8,Z=0,ge=z.length;Z<ge;++Z){var le=z[Z];if(be===0&&(be=Q,(J+=ue)>=B&&(ue=4*pe+4*r*(Ne-1),J=V+(Q+pe)*(Ne<<1),Ne>>=1)),le===q)J+=4;else{var se=e[H+3*le],ee=e[H+3*le+1],de=e[H+3*le+2];R[J++]=se,R[J++]=ee,R[J++]=de,R[J++]=255}--be}}}function L9(e,t,r,n){for(var o=e[t++],s=1<<o,i=s+1,l=i+1,c=o+1,d=(1<<c)-1,u=0,f=0,h=0,m=e[t++],v=new Int32Array(4096),g=null;;){for(;u<16&&m!==0;)f|=e[t++]<<u,u+=8,m===1?m=e[t++]:--m;if(u<c)break;var y=f&d;if(f>>=c,u-=c,y!==s){if(y===i)break;for(var x=y<l?y:g,b=0,w=x;w>s;)w=v[w]>>8,++b;var j=w;if(h+b+(x!==y?1:0)>n)return void _o.log("Warning, gif stream longer than expected.");r[h++]=j;var _=h+=b;for(x!==y&&(r[h++]=j),w=x;b--;)w=v[w],r[--_]=255&w,w>>=8;g!==null&&l<4096&&(v[l++]=g<<8|j,l>=d+1&&c<12&&(++c,d=d<<1|1)),g=y}else l=i+1,d=(1<<(c=o+1))-1,g=null}return h!==n&&_o.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function kE(e){var t,r,n,o,s,i=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),f=new Array(65535),h=new Array(65535),m=new Array(64),v=new Array(64),g=[],y=0,x=7,b=new Array(64),w=new Array(64),j=new Array(64),_=new Array(256),C=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],M=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function z(V,B){for(var J=0,ue=0,Ne=new Array,Z=1;Z<=16;Z++){for(var ge=1;ge<=V[Z];ge++)Ne[B[ue]]=[],Ne[B[ue]][0]=J,Ne[B[ue]][1]=Z,ue++,J++;J*=2}return Ne}function H(V){for(var B=V[0],J=V[1]-1;J>=0;)B&1<<J&&(y|=1<<x),J--,--x<0&&(y==255?(q(255),q(0)):q(y),x=7,y=0)}function q(V){g.push(V)}function Q(V){q(V>>8&255),q(255&V)}function pe(V,B,J,ue,Ne){for(var Z,ge=Ne[0],le=Ne[240],se=function(ut,Rt){var Nt,tt,he,ke,et,Me,$e,Be,we,He,ht=0;for(we=0;we<8;++we){Nt=ut[ht],tt=ut[ht+1],he=ut[ht+2],ke=ut[ht+3],et=ut[ht+4],Me=ut[ht+5],$e=ut[ht+6];var zt=Nt+(Be=ut[ht+7]),hr=Nt-Be,Mt=tt+$e,Qt=tt-$e,Se=he+Me,kt=he-Me,Lt=ke+et,fr=ke-et,yr=zt+Lt,Xt=zt-Lt,nr=Mt+Se,ir=Mt-Se;ut[ht]=yr+nr,ut[ht+4]=yr-nr;var Ee=.707106781*(ir+Xt);ut[ht+2]=Xt+Ee,ut[ht+6]=Xt-Ee;var qe=.382683433*((yr=fr+kt)-(ir=Qt+hr)),Ge=.5411961*yr+qe,Qe=1.306562965*ir+qe,St=.707106781*(nr=kt+Qt),pt=hr+St,Et=hr-St;ut[ht+5]=Et+Ge,ut[ht+3]=Et-Ge,ut[ht+1]=pt+Qe,ut[ht+7]=pt-Qe,ht+=8}for(ht=0,we=0;we<8;++we){Nt=ut[ht],tt=ut[ht+8],he=ut[ht+16],ke=ut[ht+24],et=ut[ht+32],Me=ut[ht+40],$e=ut[ht+48];var mt=Nt+(Be=ut[ht+56]),gt=Nt-Be,ft=tt+$e,Dt=tt-$e,Ft=he+Me,ye=he-Me,wt=ke+et,Yt=ke-et,br=mt+wt,Mr=mt-wt,Nr=ft+Ft,Rr=ft-Ft;ut[ht]=br+Nr,ut[ht+32]=br-Nr;var Er=.707106781*(Rr+Mr);ut[ht+16]=Mr+Er,ut[ht+48]=Mr-Er;var ln=.382683433*((br=Yt+ye)-(Rr=Dt+gt)),Fn=.5411961*br+ln,Hn=1.306562965*Rr+ln,$n=.707106781*(Nr=ye+Dt),at=gt+$n,Vt=gt-$n;ut[ht+40]=Vt+Fn,ut[ht+24]=Vt-Fn,ut[ht+8]=at+Hn,ut[ht+56]=at-Hn,ht++}for(we=0;we<64;++we)He=ut[we]*Rt[we],m[we]=He>0?He+.5|0:He-.5|0;return m}(V,B),ee=0;ee<64;++ee)v[E[ee]]=se[ee];var de=v[0]-J;J=v[0],de==0?H(ue[0]):(H(ue[h[Z=32767+de]]),H(f[Z]));for(var Le=63;Le>0&&v[Le]==0;)Le--;if(Le==0)return H(ge),J;for(var ae,ie=1;ie<=Le;){for(var dt=ie;v[ie]==0&&ie<=Le;)++ie;var At=ie-dt;if(At>=16){ae=At>>4;for(var st=1;st<=ae;++st)H(le);At&=15}Z=32767+v[ie],H(Ne[(At<<4)+h[Z]]),H(f[Z]),ie++}return Le!=63&&H(ge),J}function be(V){V=Math.min(Math.max(V,1),100),s!=V&&(function(B){for(var J=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ue=0;ue<64;ue++){var Ne=i((J[ue]*B+50)/100);Ne=Math.min(Math.max(Ne,1),255),l[E[ue]]=Ne}for(var Z=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ge=0;ge<64;ge++){var le=i((Z[ge]*B+50)/100);le=Math.min(Math.max(le,1),255),c[E[ge]]=le}for(var se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ee=0,de=0;de<8;de++)for(var Le=0;Le<8;Le++)d[ee]=1/(l[E[ee]]*se[de]*se[Le]*8),u[ee]=1/(c[E[ee]]*se[de]*se[Le]*8),ee++}(V<50?Math.floor(5e3/V):Math.floor(200-2*V)),s=V)}this.encode=function(V,B){B&&be(B),g=new Array,y=0,x=7,Q(65496),Q(65504),Q(16),q(74),q(70),q(73),q(70),q(0),q(1),q(1),q(0),Q(1),Q(1),q(0),q(0),function(){Q(65499),Q(132),q(0);for(var tt=0;tt<64;tt++)q(l[tt]);q(1);for(var he=0;he<64;he++)q(c[he])}(),function(tt,he){Q(65472),Q(17),q(8),Q(he),Q(tt),q(3),q(1),q(17),q(0),q(2),q(17),q(1),q(3),q(17),q(1)}(V.width,V.height),function(){Q(65476),Q(418),q(0);for(var tt=0;tt<16;tt++)q(A[tt+1]);for(var he=0;he<=11;he++)q(P[he]);q(16);for(var ke=0;ke<16;ke++)q(F[ke+1]);for(var et=0;et<=161;et++)q(M[et]);q(1);for(var Me=0;Me<16;Me++)q(I[Me+1]);for(var $e=0;$e<=11;$e++)q(R[$e]);q(17);for(var Be=0;Be<16;Be++)q(D[Be+1]);for(var we=0;we<=161;we++)q(U[we])}(),Q(65498),Q(12),q(3),q(1),q(0),q(2),q(17),q(3),q(17),q(0),q(63),q(0);var J=0,ue=0,Ne=0;y=0,x=7,this.encode.displayName="_encode_";for(var Z,ge,le,se,ee,de,Le,ae,ie,dt=V.data,At=V.width,st=V.height,ut=4*At,Rt=0;Rt<st;){for(Z=0;Z<ut;){for(ee=ut*Rt+Z,Le=-1,ae=0,ie=0;ie<64;ie++)de=ee+(ae=ie>>3)*ut+(Le=4*(7&ie)),Rt+ae>=st&&(de-=ut*(Rt+1+ae-st)),Z+Le>=ut&&(de-=Z+Le-ut+4),ge=dt[de++],le=dt[de++],se=dt[de++],b[ie]=(C[ge]+C[le+256|0]+C[se+512|0]>>16)-128,w[ie]=(C[ge+768|0]+C[le+1024|0]+C[se+1280|0]>>16)-128,j[ie]=(C[ge+1280|0]+C[le+1536|0]+C[se+1792|0]>>16)-128;J=pe(b,d,J,t,n),ue=pe(w,u,ue,r,o),Ne=pe(j,u,Ne,r,o),Z+=32}Rt+=8}if(x>=0){var Nt=[];Nt[1]=x+1,Nt[0]=(1<<x+1)-1,H(Nt)}return Q(65497),new Uint8Array(g)},e=e||50,function(){for(var V=String.fromCharCode,B=0;B<256;B++)_[B]=V(B)}(),t=z(A,P),r=z(I,R),n=z(F,M),o=z(D,U),function(){for(var V=1,B=2,J=1;J<=15;J++){for(var ue=V;ue<B;ue++)h[32767+ue]=J,f[32767+ue]=[],f[32767+ue][1]=J,f[32767+ue][0]=ue;for(var Ne=-(B-1);Ne<=-V;Ne++)h[32767+Ne]=J,f[32767+Ne]=[],f[32767+Ne][1]=J,f[32767+Ne][0]=B-1+Ne;V<<=1,B<<=1}}(),function(){for(var V=0;V<256;V++)C[V]=19595*V,C[V+256|0]=38470*V,C[V+512|0]=7471*V+32768,C[V+768|0]=-11059*V,C[V+1024|0]=-21709*V,C[V+1280|0]=32768*V+8421375,C[V+1536|0]=-27439*V,C[V+1792|0]=-5329*V}(),be(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Bd(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function F9(e){function t(P){if(!P)throw Error("assert :P")}function r(P,F,M){for(var I=0;4>I;I++)if(P[F+I]!=M.charCodeAt(I))return!0;return!1}function n(P,F,M,I,R){for(var D=0;D<R;D++)P[F+D]=M[I+D]}function o(P,F,M,I){for(var R=0;R<I;R++)P[F+R]=M}function s(P){return new Int32Array(P)}function i(P,F){for(var M=[],I=0;I<P;I++)M.push(new F);return M}function l(P,F){var M=[];return function I(R,D,U){for(var z=U[D],H=0;H<z&&(R.push(U.length>D+1?[]:new F),!(U.length<D+1));H++)I(R[H],D+1,U)}(M,0,P),M}var c=function(){var P=this;function F(N,k){for(var $=1<<k-1>>>0;N&$;)$>>>=1;return $?(N&$-1)+$:N}function M(N,k,$,Y,me){t(!(Y%$));do N[k+(Y-=$)]=me;while(0<Y)}function I(N,k,$,Y,me){if(t(2328>=me),512>=me)var xe=s(512);else if((xe=s(me))==null)return 0;return function(je,Ae,Oe,Ue,yt,tr){var Ve,Pt,qt=Ae,Ar=1<<Oe,Jt=s(16),Tr=s(16);for(t(yt!=0),t(Ue!=null),t(je!=null),t(0<Oe),Pt=0;Pt<yt;++Pt){if(15<Ue[Pt])return 0;++Jt[Ue[Pt]]}if(Jt[0]==yt)return 0;for(Tr[1]=0,Ve=1;15>Ve;++Ve){if(Jt[Ve]>1<<Ve)return 0;Tr[Ve+1]=Tr[Ve]+Jt[Ve]}for(Pt=0;Pt<yt;++Pt)Ve=Ue[Pt],0<Ue[Pt]&&(tr[Tr[Ve]++]=Pt);if(Tr[15]==1)return(Ue=new R).g=0,Ue.value=tr[0],M(je,qt,1,Ar,Ue),Ar;var Dr,Xr=-1,Ur=Ar-1,Gn=0,Mn=1,Na=1,zn=1<<Oe;for(Pt=0,Ve=1,yt=2;Ve<=Oe;++Ve,yt<<=1){if(Mn+=Na<<=1,0>(Na-=Jt[Ve]))return 0;for(;0<Jt[Ve];--Jt[Ve])(Ue=new R).g=Ve,Ue.value=tr[Pt++],M(je,qt+Gn,yt,zn,Ue),Gn=F(Gn,Ve)}for(Ve=Oe+1,yt=2;15>=Ve;++Ve,yt<<=1){if(Mn+=Na<<=1,0>(Na-=Jt[Ve]))return 0;for(;0<Jt[Ve];--Jt[Ve]){if(Ue=new R,(Gn&Ur)!=Xr){for(qt+=zn,Dr=1<<(Xr=Ve)-Oe;15>Xr&&!(0>=(Dr-=Jt[Xr]));)++Xr,Dr<<=1;Ar+=zn=1<<(Dr=Xr-Oe),je[Ae+(Xr=Gn&Ur)].g=Dr+Oe,je[Ae+Xr].value=qt-Ae-Xr}Ue.g=Ve-Oe,Ue.value=tr[Pt++],M(je,qt+(Gn>>Oe),yt,zn,Ue),Gn=F(Gn,Ve)}}return Mn!=2*Tr[15]-1?0:Ar}(N,k,$,Y,me,xe)}function R(){this.value=this.g=0}function D(){this.value=this.g=0}function U(){this.G=i(5,R),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Ln,D)}function z(N,k,$,Y){t(N!=null),t(k!=null),t(2147483648>Y),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=k,N.pa=$,N.Jd=k,N.Yc=$+Y,N.Zc=4<=Y?$+Y-4+1:$,ge(N)}function H(N,k){for(var $=0;0<k--;)$|=se(N,128)<<k;return $}function q(N,k){var $=H(N,k);return le(N)?-$:$}function Q(N,k,$,Y){var me,xe=0;for(t(N!=null),t(k!=null),t(4294967288>Y),N.Sb=Y,N.Ra=0,N.u=0,N.h=0,4<Y&&(Y=4),me=0;me<Y;++me)xe+=k[$+me]<<8*me;N.Ra=xe,N.bb=Y,N.oa=k,N.pa=$}function pe(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<Pa-8>>>0,++N.bb,N.u-=8;ue(N)&&(N.h=1,N.u=0)}function be(N,k){if(t(0<=k),!N.h&&k<=Bn){var $=J(N)&Qr[k];return N.u+=k,pe(N),$}return N.h=1,N.u=0}function V(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function B(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function J(N){return N.Ra>>>(N.u&Pa-1)>>>0}function ue(N){return t(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>Pa}function Ne(N,k){N.u=k,N.h=ue(N)}function Z(N){N.u>=Ja&&(t(N.u>=Ja),pe(N))}function ge(N){t(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(t(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function le(N){return H(N,1)}function se(N,k){var $=N.Ca;0>N.b&&ge(N);var Y=N.b,me=$*k>>>8,xe=(N.I>>>Y>me)+0;for(xe?($-=me,N.I-=me+1<<Y>>>0):$=me+1,Y=$,me=0;256<=Y;)me+=8,Y>>=8;return Y=7^me+po[Y],N.b-=Y,N.Ca=($<<Y)-1,xe}function ee(N,k,$){N[k+0]=$>>24&255,N[k+1]=$>>16&255,N[k+2]=$>>8&255,N[k+3]=255&$}function de(N,k){return N[k+0]|N[k+1]<<8}function Le(N,k){return de(N,k)|N[k+2]<<16}function ae(N,k){return de(N,k)|de(N,k+2)<<16}function ie(N,k){var $=1<<k;return t(N!=null),t(0<k),N.X=s($),N.X==null?0:(N.Mb=32-k,N.Xa=k,1)}function dt(N,k){t(N!=null),t(k!=null),t(N.Xa==k.Xa),n(k.X,0,N.X,0,1<<k.Xa)}function At(){this.X=[],this.Xa=this.Mb=0}function st(N,k,$,Y){t($!=null),t(Y!=null);var me=$[0],xe=Y[0];return me==0&&(me=(N*xe+k/2)/k),xe==0&&(xe=(k*me+N/2)/N),0>=me||0>=xe?0:($[0]=me,Y[0]=xe,1)}function ut(N,k){return N+(1<<k)-1>>>k}function Rt(N,k){return((4278255360&N)+(4278255360&k)>>>0&4278255360)+((16711935&N)+(16711935&k)>>>0&16711935)>>>0}function Nt(N,k){P[k]=function($,Y,me,xe,je,Ae,Oe){var Ue;for(Ue=0;Ue<je;++Ue){var yt=P[N](Ae[Oe+Ue-1],me,xe+Ue);Ae[Oe+Ue]=Rt($[Y+Ue],yt)}}}function tt(){this.ud=this.hd=this.jd=0}function he(N,k){return((4278124286&(N^k))>>>1)+(N&k)>>>0}function ke(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function et(N,k){return ke(N+(N-k+.5>>1))}function Me(N,k,$){return Math.abs(k-$)-Math.abs(N-$)}function $e(N,k,$,Y,me,xe,je){for(Y=xe[je-1],$=0;$<me;++$)xe[je+$]=Y=Rt(N[k+$],Y)}function Be(N,k,$,Y,me){var xe;for(xe=0;xe<$;++xe){var je=N[k+xe],Ae=je>>8&255,Oe=16711935&(Oe=(Oe=16711935&je)+((Ae<<16)+Ae));Y[me+xe]=(4278255360&je)+Oe>>>0}}function we(N,k){k.jd=255&N,k.hd=N>>8&255,k.ud=N>>16&255}function He(N,k,$,Y,me,xe){var je;for(je=0;je<Y;++je){var Ae=k[$+je],Oe=Ae>>>8,Ue=Ae,yt=255&(yt=(yt=Ae>>>16)+((N.jd<<24>>24)*(Oe<<24>>24)>>>5));Ue=255&(Ue=(Ue+=(N.hd<<24>>24)*(Oe<<24>>24)>>>5)+((N.ud<<24>>24)*(yt<<24>>24)>>>5)),me[xe+je]=(4278255360&Ae)+(yt<<16)+Ue}}function ht(N,k,$,Y,me){P[k]=function(xe,je,Ae,Oe,Ue,yt,tr,Ve,Pt){for(Oe=tr;Oe<Ve;++Oe)for(tr=0;tr<Pt;++tr)Ue[yt++]=me(Ae[Y(xe[je++])])},P[N]=function(xe,je,Ae,Oe,Ue,yt,tr){var Ve=8>>xe.b,Pt=xe.Ea,qt=xe.K[0],Ar=xe.w;if(8>Ve)for(xe=(1<<xe.b)-1,Ar=(1<<Ve)-1;je<Ae;++je){var Jt,Tr=0;for(Jt=0;Jt<Pt;++Jt)Jt&xe||(Tr=Y(Oe[Ue++])),yt[tr++]=me(qt[Tr&Ar]),Tr>>=Ve}else P["VP8LMapColor"+$](Oe,Ue,qt,Ar,yt,tr,je,Ae,Pt)}}function zt(N,k,$,Y,me){for($=k+$;k<$;){var xe=N[k++];Y[me++]=xe>>16&255,Y[me++]=xe>>8&255,Y[me++]=255&xe}}function hr(N,k,$,Y,me){for($=k+$;k<$;){var xe=N[k++];Y[me++]=xe>>16&255,Y[me++]=xe>>8&255,Y[me++]=255&xe,Y[me++]=xe>>24&255}}function Mt(N,k,$,Y,me){for($=k+$;k<$;){var xe=(je=N[k++])>>16&240|je>>12&15,je=240&je|je>>28&15;Y[me++]=xe,Y[me++]=je}}function Qt(N,k,$,Y,me){for($=k+$;k<$;){var xe=(je=N[k++])>>16&248|je>>13&7,je=je>>5&224|je>>3&31;Y[me++]=xe,Y[me++]=je}}function Se(N,k,$,Y,me){for($=k+$;k<$;){var xe=N[k++];Y[me++]=255&xe,Y[me++]=xe>>8&255,Y[me++]=xe>>16&255}}function kt(N,k,$,Y,me,xe){if(xe==0)for($=k+$;k<$;)ee(Y,((xe=N[k++])[0]>>24|xe[1]>>8&65280|xe[2]<<8&16711680|xe[3]<<24)>>>0),me+=32;else n(Y,me,N,k,$)}function Lt(N,k){P[k][0]=P[N+"0"],P[k][1]=P[N+"1"],P[k][2]=P[N+"2"],P[k][3]=P[N+"3"],P[k][4]=P[N+"4"],P[k][5]=P[N+"5"],P[k][6]=P[N+"6"],P[k][7]=P[N+"7"],P[k][8]=P[N+"8"],P[k][9]=P[N+"9"],P[k][10]=P[N+"10"],P[k][11]=P[N+"11"],P[k][12]=P[N+"12"],P[k][13]=P[N+"13"],P[k][14]=P[N+"0"],P[k][15]=P[N+"0"]}function fr(N){return N==ha||N==Ea||N==Ti||N==eo}function yr(){this.eb=[],this.size=this.A=this.fb=0}function Xt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function nr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new yr,this.f.kb=new Xt,this.sd=null}function ir(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ee(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function qe(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function Ge(N,k){var $=N.T,Y=k.ba.f.RGBA,me=Y.eb,xe=Y.fb+N.ka*Y.A,je=Hc[k.ba.S],Ae=N.y,Oe=N.O,Ue=N.f,yt=N.N,tr=N.ea,Ve=N.W,Pt=k.cc,qt=k.dc,Ar=k.Mc,Jt=k.Nc,Tr=N.ka,Dr=N.ka+N.T,Xr=N.U,Ur=Xr+1>>1;for(Tr==0?je(Ae,Oe,null,null,Ue,yt,tr,Ve,Ue,yt,tr,Ve,me,xe,null,null,Xr):(je(k.ec,k.fc,Ae,Oe,Pt,qt,Ar,Jt,Ue,yt,tr,Ve,me,xe-Y.A,me,xe,Xr),++$);Tr+2<Dr;Tr+=2)Pt=Ue,qt=yt,Ar=tr,Jt=Ve,yt+=N.Rc,Ve+=N.Rc,xe+=2*Y.A,je(Ae,(Oe+=2*N.fa)-N.fa,Ae,Oe,Pt,qt,Ar,Jt,Ue,yt,tr,Ve,me,xe-Y.A,me,xe,Xr);return Oe+=N.fa,N.j+Dr<N.o?(n(k.ec,k.fc,Ae,Oe,Xr),n(k.cc,k.dc,Ue,yt,Ur),n(k.Mc,k.Nc,tr,Ve,Ur),$--):1&Dr||je(Ae,Oe,null,null,Ue,yt,tr,Ve,Ue,yt,tr,Ve,me,xe+Y.A,null,null,Xr),$}function Qe(N,k,$){var Y=N.F,me=[N.J];if(Y!=null){var xe=N.U,je=k.ba.S,Ae=je==xa||je==Ti;k=k.ba.f.RGBA;var Oe=[0],Ue=N.ka;Oe[0]=N.T,N.Kb&&(Ue==0?--Oe[0]:(--Ue,me[0]-=N.width),N.j+N.ka+N.T==N.o&&(Oe[0]=N.o-N.j-Ue));var yt=k.eb;Ue=k.fb+Ue*k.A,N=Dg(Y,me[0],N.width,xe,Oe,yt,Ue+(Ae?0:3),k.A),t($==Oe),N&&fr(je)&&om(yt,Ue,Ae,xe,Oe,k.A)}return 0}function St(N){var k=N.ma,$=k.ba.S,Y=11>$,me=$==wn||$==sa||$==xa||$==Aa||$==12||fr($);if(k.memory=null,k.Ib=null,k.Jb=null,k.Nd=null,!rn(k.Oa,N,me?11:12))return 0;if(me&&fr($)&&vr(),N.da)alert("todo:use_scaling");else{if(Y){if(k.Ib=qe,N.Kb){if($=N.U+1>>1,k.memory=s(N.U+2*$),k.memory==null)return 0;k.ec=k.memory,k.fc=0,k.cc=k.ec,k.dc=k.fc+N.U,k.Mc=k.cc,k.Nc=k.dc+$,k.Ib=Ge,vr()}}else alert("todo:EmitYUV");me&&(k.Jb=Qe,Y&&Cr())}if(Y&&!XR){for(N=0;256>N;++N)Fse[N]=89858*(N-128)+Y1>>X1,qse[N]=-22014*(N-128)+Y1,Bse[N]=-45773*(N-128),$se[N]=113618*(N-128)+Y1>>X1;for(N=F0;N<aP;++N)k=76283*(N-16)+Y1>>X1,zse[N-F0]=on(k,255),Use[N-F0]=on(k+8>>4,15);XR=1}return 1}function pt(N){var k=N.ma,$=N.U,Y=N.T;return t(!(1&N.ka)),0>=$||0>=Y?0:($=k.Ib(N,k),k.Jb!=null&&k.Jb(N,k,$),k.Dc+=$,1)}function Et(N){N.ma.memory=null}function mt(N,k,$,Y){return be(N,8)!=47?0:(k[0]=be(N,14)+1,$[0]=be(N,14)+1,Y[0]=be(N,1),be(N,3)!=0?0:!N.h)}function gt(N,k){if(4>N)return N+1;var $=N-2>>1;return(2+(1&N)<<$)+be(k,$)+1}function ft(N,k){return 120<k?k-120:1<=($=(($=ka[k-1])>>4)*N+(8-(15&$)))?$:1;var $}function Dt(N,k,$){var Y=J($),me=N[k+=255&Y].g-8;return 0<me&&(Ne($,$.u+8),Y=J($),k+=N[k].value,k+=Y&(1<<me)-1),Ne($,$.u+N[k].g),N[k].value}function Ft(N,k,$){return $.g+=N.g,$.value+=N.value<<k>>>0,t(8>=$.g),N.g}function ye(N,k,$){var Y=N.xc;return t((k=Y==0?0:N.vc[N.md*($>>Y)+(k>>Y)])<N.Wb),N.Ya[k]}function wt(N,k,$,Y){var me=N.ab,xe=N.c*k,je=N.C;k=je+k;var Ae=$,Oe=Y;for(Y=N.Ta,$=N.Ua;0<me--;){var Ue=N.gc[me],yt=je,tr=k,Ve=Ae,Pt=Oe,qt=(Oe=Y,Ae=$,Ue.Ea);switch(t(yt<tr),t(tr<=Ue.nc),Ue.hc){case 2:go(Ve,Pt,(tr-yt)*qt,Oe,Ae);break;case 0:var Ar=yt,Jt=tr,Tr=Oe,Dr=Ae,Xr=(zn=Ue).Ea;Ar==0&&(Id(Ve,Pt,null,null,1,Tr,Dr),$e(Ve,Pt+1,0,0,Xr-1,Tr,Dr+1),Pt+=Xr,Dr+=Xr,++Ar);for(var Ur=1<<zn.b,Gn=Ur-1,Mn=ut(Xr,zn.b),Na=zn.K,zn=zn.w+(Ar>>zn.b)*Mn;Ar<Jt;){var Ba=Na,$s=zn,Sa=1;for(Uc(Ve,Pt,Tr,Dr-Xr,1,Tr,Dr);Sa<Xr;){var Un=(Sa&~Gn)+Ur;Un>Xr&&(Un=Xr),(0,Wh[Ba[$s++]>>8&15])(Ve,Pt+ +Sa,Tr,Dr+Sa-Xr,Un-Sa,Tr,Dr+Sa),Sa=Un}Pt+=Xr,Dr+=Xr,++Ar&Gn||(zn+=Mn)}tr!=Ue.nc&&n(Oe,Ae-qt,Oe,Ae+(tr-yt-1)*qt,qt);break;case 1:for(qt=Ve,Jt=Pt,Xr=(Ve=Ue.Ea)-(Dr=Ve&~(Tr=(Pt=1<<Ue.b)-1)),Ar=ut(Ve,Ue.b),Ur=Ue.K,Ue=Ue.w+(yt>>Ue.b)*Ar;yt<tr;){for(Gn=Ur,Mn=Ue,Na=new tt,zn=Jt+Dr,Ba=Jt+Ve;Jt<zn;)we(Gn[Mn++],Na),Vc(Na,qt,Jt,Pt,Oe,Ae),Jt+=Pt,Ae+=Pt;Jt<Ba&&(we(Gn[Mn++],Na),Vc(Na,qt,Jt,Xr,Oe,Ae),Jt+=Xr,Ae+=Xr),++yt&Tr||(Ue+=Ar)}break;case 3:if(Ve==Oe&&Pt==Ae&&0<Ue.b){for(Jt=Oe,Ve=qt=Ae+(tr-yt)*qt-(Dr=(tr-yt)*ut(Ue.Ea,Ue.b)),Pt=Oe,Tr=Ae,Ar=[],Dr=(Xr=Dr)-1;0<=Dr;--Dr)Ar[Dr]=Pt[Tr+Dr];for(Dr=Xr-1;0<=Dr;--Dr)Jt[Ve+Dr]=Ar[Dr];of(Ue,yt,tr,Oe,qt,Oe,Ae)}else of(Ue,yt,tr,Ve,Pt,Oe,Ae)}Ae=Y,Oe=$}Oe!=$&&n(Y,$,Ae,Oe,xe)}function Yt(N,k){var $=N.V,Y=N.Ba+N.c*N.C,me=k-N.C;if(t(k<=N.l.o),t(16>=me),0<me){var xe=N.l,je=N.Ta,Ae=N.Ua,Oe=xe.width;if(wt(N,me,$,Y),me=Ae=[Ae],t(($=N.C)<(Y=k)),t(xe.v<xe.va),Y>xe.o&&(Y=xe.o),$<xe.j){var Ue=xe.j-$;$=xe.j,me[0]+=Ue*Oe}if($>=Y?$=0:(me[0]+=4*xe.v,xe.ka=$-xe.j,xe.U=xe.va-xe.v,xe.T=Y-$,$=1),$){if(Ae=Ae[0],11>($=N.ca).S){var yt=$.f.RGBA,tr=(Y=$.S,me=xe.U,xe=xe.T,Ue=yt.eb,yt.A),Ve=xe;for(yt=yt.fb+N.Ma*yt.A;0<Ve--;){var Pt=je,qt=Ae,Ar=me,Jt=Ue,Tr=yt;switch(Y){case kn:Od(Pt,qt,Ar,Jt,Tr);break;case wn:Qi(Pt,qt,Ar,Jt,Tr);break;case ha:Qi(Pt,qt,Ar,Jt,Tr),om(Jt,Tr,0,Ar,1,0);break;case an:ec(Pt,qt,Ar,Jt,Tr);break;case sa:kt(Pt,qt,Ar,Jt,Tr,1);break;case Ea:kt(Pt,qt,Ar,Jt,Tr,1),om(Jt,Tr,0,Ar,1,0);break;case xa:kt(Pt,qt,Ar,Jt,Tr,0);break;case Ti:kt(Pt,qt,Ar,Jt,Tr,0),om(Jt,Tr,1,Ar,1,0);break;case Aa:gi(Pt,qt,Ar,Jt,Tr);break;case eo:gi(Pt,qt,Ar,Jt,Tr),L0(Jt,Tr,Ar,1,0);break;case Jo:Wo(Pt,qt,Ar,Jt,Tr);break;default:t(0)}Ae+=Oe,yt+=tr}N.Ma+=xe}else alert("todo:EmitRescaledRowsYUVA");t(N.Ma<=$.height)}}N.C=k,t(N.C<=N.i)}function br(N){var k;if(0<N.ua)return 0;for(k=0;k<N.Wb;++k){var $=N.Ya[k].G,Y=N.Ya[k].H;if(0<$[1][Y[1]+0].g||0<$[2][Y[2]+0].g||0<$[3][Y[3]+0].g)return 0}return 1}function Mr(N,k,$,Y,me,xe){if(N.Z!=0){var je=N.qd,Ae=N.rd;for(t(lm[N.Z]!=null);k<$;++k)lm[N.Z](je,Ae,Y,me,Y,me,xe),je=Y,Ae=me,me+=xe;N.qd=je,N.rd=Ae}}function Nr(N,k){var $=N.l.ma,Y=$.Z==0||$.Z==1?N.l.j:N.C;if(Y=N.C<Y?Y:N.C,t(k<=N.l.o),k>Y){var me=N.l.width,xe=$.ca,je=$.tb+me*Y,Ae=N.V,Oe=N.Ba+N.c*Y,Ue=N.gc;t(N.ab==1),t(Ue[0].hc==3),is(Ue[0],Y,k,Ae,Oe,xe,je),Mr($,Y,k,xe,je,me)}N.C=N.Ma=k}function Rr(N,k,$,Y,me,xe,je){var Ae=N.$/Y,Oe=N.$%Y,Ue=N.m,yt=N.s,tr=$+N.$,Ve=tr;me=$+Y*me;var Pt=$+Y*xe,qt=280+yt.ua,Ar=N.Pb?Ae:16777216,Jt=0<yt.ua?yt.Wa:null,Tr=yt.wc,Dr=tr<Pt?ye(yt,Oe,Ae):null;t(N.C<xe),t(Pt<=me);var Xr=!1;e:for(;;){for(;Xr||tr<Pt;){var Ur=0;if(Ae>=Ar){var Gn=tr-$;t((Ar=N).Pb),Ar.wd=Ar.m,Ar.xd=Gn,0<Ar.s.ua&&dt(Ar.s.Wa,Ar.s.vb),Ar=Ae+Zo}if(Oe&Tr||(Dr=ye(yt,Oe,Ae)),t(Dr!=null),Dr.Qb&&(k[tr]=Dr.qb,Xr=!0),!Xr)if(Z(Ue),Dr.jc){Ur=Ue,Gn=k;var Mn=tr,Na=Dr.pd[J(Ur)&Ln-1];t(Dr.jc),256>Na.g?(Ne(Ur,Ur.u+Na.g),Gn[Mn]=Na.value,Ur=0):(Ne(Ur,Ur.u+Na.g-256),t(256<=Na.value),Ur=Na.value),Ur==0&&(Xr=!0)}else Ur=Dt(Dr.G[0],Dr.H[0],Ue);if(Ue.h)break;if(Xr||256>Ur){if(!Xr)if(Dr.nd)k[tr]=(Dr.qb|Ur<<8)>>>0;else{if(Z(Ue),Xr=Dt(Dr.G[1],Dr.H[1],Ue),Z(Ue),Gn=Dt(Dr.G[2],Dr.H[2],Ue),Mn=Dt(Dr.G[3],Dr.H[3],Ue),Ue.h)break;k[tr]=(Mn<<24|Xr<<16|Ur<<8|Gn)>>>0}if(Xr=!1,++tr,++Oe>=Y&&(Oe=0,++Ae,je!=null&&Ae<=xe&&!(Ae%16)&&je(N,Ae),Jt!=null))for(;Ve<tr;)Ur=k[Ve++],Jt.X[(506832829*Ur&4294967295)>>>Jt.Mb]=Ur}else if(280>Ur){if(Ur=gt(Ur-256,Ue),Gn=Dt(Dr.G[4],Dr.H[4],Ue),Z(Ue),Gn=ft(Y,Gn=gt(Gn,Ue)),Ue.h)break;if(tr-$<Gn||me-tr<Ur)break e;for(Mn=0;Mn<Ur;++Mn)k[tr+Mn]=k[tr+Mn-Gn];for(tr+=Ur,Oe+=Ur;Oe>=Y;)Oe-=Y,++Ae,je!=null&&Ae<=xe&&!(Ae%16)&&je(N,Ae);if(t(tr<=me),Oe&Tr&&(Dr=ye(yt,Oe,Ae)),Jt!=null)for(;Ve<tr;)Ur=k[Ve++],Jt.X[(506832829*Ur&4294967295)>>>Jt.Mb]=Ur}else{if(!(Ur<qt))break e;for(Xr=Ur-280,t(Jt!=null);Ve<tr;)Ur=k[Ve++],Jt.X[(506832829*Ur&4294967295)>>>Jt.Mb]=Ur;Ur=tr,t(!(Xr>>>(Gn=Jt).Xa)),k[Ur]=Gn.X[Xr],Xr=!0}Xr||t(Ue.h==ue(Ue))}if(N.Pb&&Ue.h&&tr<me)t(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&dt(N.s.vb,N.s.Wa);else{if(Ue.h)break e;je?.(N,Ae>xe?xe:Ae),N.a=0,N.$=tr-$}return 1}return N.a=3,0}function Er(N){t(N!=null),N.vc=null,N.yc=null,N.Ya=null;var k=N.Wa;k!=null&&(k.X=null),N.vb=null,t(N!=null)}function ln(){var N=new Ke;return N==null?null:(N.a=0,N.xb=UR,Lt("Predictor","VP8LPredictors"),Lt("Predictor","VP8LPredictors_C"),Lt("PredictorAdd","VP8LPredictorsAdd"),Lt("PredictorAdd","VP8LPredictorsAdd_C"),go=Be,Vc=He,Od=zt,Qi=hr,gi=Mt,Wo=Qt,ec=Se,P.VP8LMapColor32b=Sl,P.VP8LMapColor8b=Zs,N)}function Fn(N,k,$,Y,me){var xe=1,je=[N],Ae=[k],Oe=Y.m,Ue=Y.s,yt=null,tr=0;e:for(;;){if($)for(;xe&&be(Oe,1);){var Ve=je,Pt=Ae,qt=Y,Ar=1,Jt=qt.m,Tr=qt.gc[qt.ab],Dr=be(Jt,2);if(qt.Oc&1<<Dr)xe=0;else{switch(qt.Oc|=1<<Dr,Tr.hc=Dr,Tr.Ea=Ve[0],Tr.nc=Pt[0],Tr.K=[null],++qt.ab,t(4>=qt.ab),Dr){case 0:case 1:Tr.b=be(Jt,3)+2,Ar=Fn(ut(Tr.Ea,Tr.b),ut(Tr.nc,Tr.b),0,qt,Tr.K),Tr.K=Tr.K[0];break;case 3:var Xr,Ur=be(Jt,8)+1,Gn=16<Ur?0:4<Ur?1:2<Ur?2:3;if(Ve[0]=ut(Tr.Ea,Gn),Tr.b=Gn,Xr=Ar=Fn(Ur,1,0,qt,Tr.K)){var Mn,Na=Ur,zn=Tr,Ba=1<<(8>>zn.b),$s=s(Ba);if($s==null)Xr=0;else{var Sa=zn.K[0],Un=zn.w;for($s[0]=zn.K[0][0],Mn=1;Mn<1*Na;++Mn)$s[Mn]=Rt(Sa[Un+Mn],$s[Mn-1]);for(;Mn<4*Ba;++Mn)$s[Mn]=0;zn.K[0]=null,zn.K[0]=$s,Xr=1}}Ar=Xr;break;case 2:break;default:t(0)}xe=Ar}}if(je=je[0],Ae=Ae[0],xe&&be(Oe,1)&&!(xe=1<=(tr=be(Oe,4))&&11>=tr)){Y.a=3;break e}var gn;if(gn=xe)t:{var vs,ja,Va,Fo=Y,yi=je,Zi=Ae,ls=tr,Ri=$,el=Fo.m,Bs=Fo.s,Ka=[null],so=1,cs=0,io=ti[ls];r:for(;;){if(Ri&&be(el,1)){var bi=be(el,3)+2,Md=ut(yi,bi),xs=ut(Zi,bi),El=Md*xs;if(!Fn(Md,xs,0,Fo,Ka))break r;for(Ka=Ka[0],Bs.xc=bi,vs=0;vs<El;++vs){var jo=Ka[vs]>>8&65535;Ka[vs]=jo,jo>=so&&(so=jo+1)}}if(el.h)break r;for(ja=0;5>ja;++ja){var qs=Qo[ja];!ja&&0<ls&&(qs+=1<<ls),cs<qs&&(cs=qs)}var nc=i(so*io,R),tl=so,ac=i(tl,U);if(ac==null)var oc=null;else t(65536>=tl),oc=ac;var kl=s(cs);if(oc==null||kl==null||nc==null){Fo.a=1;break r}var sc=nc;for(vs=Va=0;vs<so;++vs){var Po=oc[vs],ic=Po.G,Rd=Po.H,Hh=0,lf=1,wi=0;for(ja=0;5>ja;++ja){qs=Qo[ja],ic[ja]=sc,Rd[ja]=Va,!ja&&0<ls&&(qs+=1<<ls);a:{var Q1,oP=qs,Z1=Fo,$0=kl,Hse=sc,Gse=Va,sP=0,cm=Z1.m,Kse=be(cm,1);if(o($0,0,0,oP),Kse){var Xse=be(cm,1)+1,Yse=be(cm,1),QR=be(cm,Yse==0?1:8);$0[QR]=1,Xse==2&&($0[QR=be(cm,8)]=1);var e2=1}else{var ZR=s(19),eL=be(cm,4)+4;if(19<eL){Z1.a=3;var t2=0;break a}for(Q1=0;Q1<eL;++Q1)ZR[vi[Q1]]=be(cm,3);var iP=void 0,B0=void 0,tL=Z1,Jse=ZR,r2=oP,rL=$0,lP=0,dm=tL.m,nL=8,aL=i(128,R);n:for(;I(aL,0,7,Jse,19);){if(be(dm,1)){var Qse=2+2*be(dm,3);if((iP=2+be(dm,Qse))>r2)break n}else iP=r2;for(B0=0;B0<r2&&iP--;){Z(dm);var oL=aL[0+(127&J(dm))];Ne(dm,dm.u+oL.g);var Mg=oL.value;if(16>Mg)rL[B0++]=Mg,Mg!=0&&(nL=Mg);else{var Zse=Mg==16,sL=Mg-16,eie=wo[sL],iL=be(dm,Di[sL])+eie;if(B0+iL>r2)break n;for(var tie=Zse?nL:0;0<iL--;)rL[B0++]=tie}}lP=1;break n}lP||(tL.a=3),e2=lP}(e2=e2&&!cm.h)&&(sP=I(Hse,Gse,8,$0,oP)),e2&&sP!=0?t2=sP:(Z1.a=3,t2=0)}if(t2==0)break r;if(lf&&Mi[ja]==1&&(lf=sc[Va].g==0),Hh+=sc[Va].g,Va+=t2,3>=ja){var q0,cP=kl[0];for(q0=1;q0<qs;++q0)kl[q0]>cP&&(cP=kl[q0]);wi+=cP}}if(Po.nd=lf,Po.Qb=0,lf&&(Po.qb=(ic[3][Rd[3]+0].value<<24|ic[1][Rd[1]+0].value<<16|ic[2][Rd[2]+0].value)>>>0,Hh==0&&256>ic[0][Rd[0]+0].value&&(Po.Qb=1,Po.qb+=ic[0][Rd[0]+0].value<<8)),Po.jc=!Po.Qb&&6>wi,Po.jc){var n2,cf=Po;for(n2=0;n2<Ln;++n2){var um=n2,fm=cf.pd[um],a2=cf.G[0][cf.H[0]+um];256<=a2.value?(fm.g=a2.g+256,fm.value=a2.value):(fm.g=0,fm.value=0,um>>=Ft(a2,8,fm),um>>=Ft(cf.G[1][cf.H[1]+um],16,fm),um>>=Ft(cf.G[2][cf.H[2]+um],0,fm),Ft(cf.G[3][cf.H[3]+um],24,fm))}}}Bs.vc=Ka,Bs.Wb=so,Bs.Ya=oc,Bs.yc=nc,gn=1;break t}gn=0}if(!(xe=gn)){Y.a=3;break e}if(0<tr){if(Ue.ua=1<<tr,!ie(Ue.Wa,tr)){Y.a=1,xe=0;break e}}else Ue.ua=0;var dP=Y,lL=je,rie=Ae,uP=dP.s,fP=uP.xc;if(dP.c=lL,dP.i=rie,uP.md=ut(lL,fP),uP.wc=fP==0?-1:(1<<fP)-1,$){Y.xb=Tse;break e}if((yt=s(je*Ae))==null){Y.a=1,xe=0;break e}xe=(xe=Rr(Y,yt,0,je,Ae,Ae,null))&&!Oe.h;break e}return xe?(me!=null?me[0]=yt:(t(yt==null),t($)),Y.$=0,$||Er(Ue)):Er(Ue),xe}function Hn(N,k){var $=N.c*N.i,Y=$+k+16*k;return t(N.c<=k),N.V=s(Y),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+$+k,1)}function $n(N,k){var $=N.C,Y=k-$,me=N.V,xe=N.Ba+N.c*$;for(t(k<=N.l.o);0<Y;){var je=16<Y?16:Y,Ae=N.l.ma,Oe=N.l.width,Ue=Oe*je,yt=Ae.ca,tr=Ae.tb+Oe*$,Ve=N.Ta,Pt=N.Ua;wt(N,je,me,xe),sm(Ve,Pt,yt,tr,Ue),Mr(Ae,$,$+je,yt,tr,Oe),Y-=je,me+=je*N.c,$+=je}t($==k),N.C=N.Ma=k}function at(){this.ub=this.yd=this.td=this.Rb=0}function Vt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function wr(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function er(){this.Yb=function(){var N=[];return function k($,Y,me){for(var xe=me[Y],je=0;je<xe&&($.push(me.length>Y+1?[]:0),!(me.length<Y+1));je++)k($[je],Y+1,me)}(N,0,[3,11]),N}()}function Ze(){this.jb=s(3),this.Wc=l([4,8],er),this.Xc=l([4,17],er)}function Fr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function jt(){this.ld=this.La=this.dd=this.tc=0}function _r(){this.Na=this.la=0}function bt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Wt(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Zt(){this.uc=this.M=this.Nb=0,this.wa=Array(new jt),this.Y=0,this.ya=Array(new Wt),this.aa=0,this.l=new _t}function Br(){this.y=s(16),this.f=s(8),this.ea=s(8)}function zr(){this.cb=this.a=0,this.sc="",this.m=new V,this.Od=new at,this.Kc=new Vt,this.ed=new Fr,this.Qa=new wr,this.Ic=this.$c=this.Aa=0,this.D=new Zt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,V),this.ia=0,this.pb=i(4,bt),this.Pa=new Ze,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Br),this.Hd=0,this.rb=Array(new _r),this.sb=0,this.wa=Array(new jt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Wt),this.L=this.aa=0,this.gd=l([4,2],jt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function _t(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Jr(){var N=new zr;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,Al||(Al=re)),N}function mn(N,k,$){return N.a==0&&(N.a=k,N.sc=$,N.cb=0),0}function ma(N,k,$){return 3<=$&&N[k+0]==157&&N[k+1]==1&&N[k+2]==42}function Nn(N,k){if(N==null)return 0;if(N.a=0,N.sc="OK",k==null)return mn(N,2,"null VP8Io passed to VP8GetHeaders()");var $=k.data,Y=k.w,me=k.ha;if(4>me)return mn(N,7,"Truncated header.");var xe=$[Y+0]|$[Y+1]<<8|$[Y+2]<<16,je=N.Od;if(je.Rb=!(1&xe),je.td=xe>>1&7,je.yd=xe>>4&1,je.ub=xe>>5,3<je.td)return mn(N,3,"Incorrect keyframe parameters.");if(!je.yd)return mn(N,4,"Frame not displayable.");Y+=3,me-=3;var Ae=N.Kc;if(je.Rb){if(7>me)return mn(N,7,"cannot parse picture header");if(!ma($,Y,me))return mn(N,3,"Bad code word");Ae.c=16383&($[Y+4]<<8|$[Y+3]),Ae.Td=$[Y+4]>>6,Ae.i=16383&($[Y+6]<<8|$[Y+5]),Ae.Ud=$[Y+6]>>6,Y+=7,me-=7,N.za=Ae.c+15>>4,N.Ub=Ae.i+15>>4,k.width=Ae.c,k.height=Ae.i,k.Da=0,k.j=0,k.v=0,k.va=k.width,k.o=k.height,k.da=0,k.ib=k.width,k.hb=k.height,k.U=k.width,k.T=k.height,o((xe=N.Pa).jb,0,255,xe.jb.length),t((xe=N.Qa)!=null),xe.Cb=0,xe.Bb=0,xe.Fb=1,o(xe.Zb,0,0,xe.Zb.length),o(xe.Lb,0,0,xe.Lb)}if(je.ub>me)return mn(N,7,"bad partition length");z(xe=N.m,$,Y,je.ub),Y+=je.ub,me-=je.ub,je.Rb&&(Ae.Ld=le(xe),Ae.Kd=le(xe)),Ae=N.Qa;var Oe,Ue=N.Pa;if(t(xe!=null),t(Ae!=null),Ae.Cb=le(xe),Ae.Cb){if(Ae.Bb=le(xe),le(xe)){for(Ae.Fb=le(xe),Oe=0;4>Oe;++Oe)Ae.Zb[Oe]=le(xe)?q(xe,7):0;for(Oe=0;4>Oe;++Oe)Ae.Lb[Oe]=le(xe)?q(xe,6):0}if(Ae.Bb)for(Oe=0;3>Oe;++Oe)Ue.jb[Oe]=le(xe)?H(xe,8):255}else Ae.Bb=0;if(xe.Ka)return mn(N,3,"cannot parse segment header");if((Ae=N.ed).zd=le(xe),Ae.Tb=H(xe,6),Ae.wb=H(xe,3),Ae.Pc=le(xe),Ae.Pc&&le(xe)){for(Ue=0;4>Ue;++Ue)le(xe)&&(Ae.vd[Ue]=q(xe,6));for(Ue=0;4>Ue;++Ue)le(xe)&&(Ae.od[Ue]=q(xe,6))}if(N.L=Ae.Tb==0?0:Ae.zd?1:2,xe.Ka)return mn(N,3,"cannot parse filter header");var yt=me;if(me=Oe=Y,Y=Oe+yt,Ae=yt,N.Xb=(1<<H(N.m,2))-1,yt<3*(Ue=N.Xb))$=7;else{for(Oe+=3*Ue,Ae-=3*Ue,yt=0;yt<Ue;++yt){var tr=$[me+0]|$[me+1]<<8|$[me+2]<<16;tr>Ae&&(tr=Ae),z(N.Jc[+yt],$,Oe,tr),Oe+=tr,Ae-=tr,me+=3}z(N.Jc[+Ue],$,Oe,Ae),$=Oe<Y?0:5}if($!=0)return mn(N,$,"cannot parse partitions");for($=H(Oe=N.m,7),me=le(Oe)?q(Oe,4):0,Y=le(Oe)?q(Oe,4):0,Ae=le(Oe)?q(Oe,4):0,Ue=le(Oe)?q(Oe,4):0,Oe=le(Oe)?q(Oe,4):0,yt=N.Qa,tr=0;4>tr;++tr){if(yt.Cb){var Ve=yt.Zb[tr];yt.Fb||(Ve+=$)}else{if(0<tr){N.pb[tr]=N.pb[0];continue}Ve=$}var Pt=N.pb[tr];Pt.Sc[0]=Cs[on(Ve+me,127)],Pt.Sc[1]=xi[on(Ve+0,127)],Pt.Eb[0]=2*Cs[on(Ve+Y,127)],Pt.Eb[1]=101581*xi[on(Ve+Ae,127)]>>16,8>Pt.Eb[1]&&(Pt.Eb[1]=8),Pt.Qc[0]=Cs[on(Ve+Ue,117)],Pt.Qc[1]=xi[on(Ve+Oe,127)],Pt.lc=Ve+Oe}if(!je.Rb)return mn(N,4,"Not a key frame.");for(le(xe),je=N.Pa,$=0;4>$;++$){for(me=0;8>me;++me)for(Y=0;3>Y;++Y)for(Ae=0;11>Ae;++Ae)Ue=se(xe,Ise[$][me][Y][Ae])?H(xe,8):Ese[$][me][Y][Ae],je.Wc[$][me].Yb[Y][Ae]=Ue;for(me=0;17>me;++me)je.Xc[$][me]=je.Wc[$][Ose[me]]}return N.kc=le(xe),N.kc&&(N.Bd=H(xe,8)),N.cb=1}function re(N,k,$,Y,me,xe,je){var Ae=k[me].Yb[$];for($=0;16>me;++me){if(!se(N,Ae[$+0]))return me;for(;!se(N,Ae[$+1]);)if(Ae=k[++me].Yb[0],$=0,me==16)return 16;var Oe=k[me+1].Yb;if(se(N,Ae[$+2])){var Ue=N,yt=0;if(se(Ue,(Ve=Ae)[(tr=$)+3]))if(se(Ue,Ve[tr+6])){for(Ae=0,tr=2*(yt=se(Ue,Ve[tr+8]))+(Ve=se(Ue,Ve[tr+9+yt])),yt=0,Ve=Pse[tr];Ve[Ae];++Ae)yt+=yt+se(Ue,Ve[Ae]);yt+=3+(8<<tr)}else se(Ue,Ve[tr+7])?(yt=7+2*se(Ue,165),yt+=se(Ue,145)):yt=5+se(Ue,159);else yt=se(Ue,Ve[tr+4])?3+se(Ue,Ve[tr+5]):2;Ae=Oe[2]}else yt=1,Ae=Oe[1];Oe=je+Ase[me],0>(Ue=N).b&&ge(Ue);var tr,Ve=Ue.b,Pt=(tr=Ue.Ca>>1)-(Ue.I>>Ve)>>31;--Ue.b,Ue.Ca+=Pt,Ue.Ca|=1,Ue.I-=(tr+1&Pt)<<Ve,xe[Oe]=((yt^Pt)-Pt)*Y[(0<me)+0]}return 16}function Te(N){var k=N.rb[N.sb-1];k.la=0,k.Na=0,o(N.zc,0,0,N.zc.length),N.ja=0}function ot(N,k,$,Y,me){me=N[k+$+32*Y]+(me>>3),N[k+$+32*Y]=-256&me?0>me?0:255:me}function te(N,k,$,Y,me,xe){ot(N,k,0,$,Y+me),ot(N,k,1,$,Y+xe),ot(N,k,2,$,Y-xe),ot(N,k,3,$,Y-me)}function T(N){return(20091*N>>16)+N}function O(N,k,$,Y){var me,xe=0,je=s(16);for(me=0;4>me;++me){var Ae=N[k+0]+N[k+8],Oe=N[k+0]-N[k+8],Ue=(35468*N[k+4]>>16)-T(N[k+12]),yt=T(N[k+4])+(35468*N[k+12]>>16);je[xe+0]=Ae+yt,je[xe+1]=Oe+Ue,je[xe+2]=Oe-Ue,je[xe+3]=Ae-yt,xe+=4,k++}for(me=xe=0;4>me;++me)Ae=(N=je[xe+0]+4)+je[xe+8],Oe=N-je[xe+8],Ue=(35468*je[xe+4]>>16)-T(je[xe+12]),ot($,Y,0,0,Ae+(yt=T(je[xe+4])+(35468*je[xe+12]>>16))),ot($,Y,1,0,Oe+Ue),ot($,Y,2,0,Oe-Ue),ot($,Y,3,0,Ae-yt),xe++,Y+=32}function X(N,k,$,Y){var me=N[k+0]+4,xe=35468*N[k+4]>>16,je=T(N[k+4]),Ae=35468*N[k+1]>>16;te($,Y,0,me+je,N=T(N[k+1]),Ae),te($,Y,1,me+xe,N,Ae),te($,Y,2,me-xe,N,Ae),te($,Y,3,me-je,N,Ae)}function G(N,k,$,Y,me){O(N,k,$,Y),me&&O(N,k+16,$,Y+4)}function L(N,k,$,Y){Cl(N,k+0,$,Y,1),Cl(N,k+32,$,Y+128,1)}function Re(N,k,$,Y){var me;for(N=N[k+0]+4,me=0;4>me;++me)for(k=0;4>k;++k)ot($,Y,k,me,N)}function rt(N,k,$,Y){N[k+0]&&Ua(N,k+0,$,Y),N[k+16]&&Ua(N,k+16,$,Y+4),N[k+32]&&Ua(N,k+32,$,Y+128),N[k+48]&&Ua(N,k+48,$,Y+128+4)}function lt(N,k,$,Y){var me,xe=s(16);for(me=0;4>me;++me){var je=N[k+0+me]+N[k+12+me],Ae=N[k+4+me]+N[k+8+me],Oe=N[k+4+me]-N[k+8+me],Ue=N[k+0+me]-N[k+12+me];xe[0+me]=je+Ae,xe[8+me]=je-Ae,xe[4+me]=Ue+Oe,xe[12+me]=Ue-Oe}for(me=0;4>me;++me)je=(N=xe[0+4*me]+3)+xe[3+4*me],Ae=xe[1+4*me]+xe[2+4*me],Oe=xe[1+4*me]-xe[2+4*me],Ue=N-xe[3+4*me],$[Y+0]=je+Ae>>3,$[Y+16]=Ue+Oe>>3,$[Y+32]=je-Ae>>3,$[Y+48]=Ue-Oe>>3,Y+=64}function $t(N,k,$){var Y,me=k-32,xe=rr,je=255-N[me-1];for(Y=0;Y<$;++Y){var Ae,Oe=xe,Ue=je+N[k-1];for(Ae=0;Ae<$;++Ae)N[k+Ae]=Oe[Ue+N[me+Ae]];k+=32}}function Fe(N,k){$t(N,k,4)}function It(N,k){$t(N,k,8)}function Sr(N,k){$t(N,k,16)}function kr(N,k){var $;for($=0;16>$;++$)n(N,k+32*$,N,k-32,16)}function pr(N,k){var $;for($=16;0<$;--$)o(N,k,N[k-1],16),k+=32}function yn(N,k,$){var Y;for(Y=0;16>Y;++Y)o(k,$+32*Y,N,16)}function In(N,k){var $,Y=16;for($=0;16>$;++$)Y+=N[k-1+32*$]+N[k+$-32];yn(Y>>5,N,k)}function Xn(N,k){var $,Y=8;for($=0;16>$;++$)Y+=N[k-1+32*$];yn(Y>>4,N,k)}function En(N,k){var $,Y=8;for($=0;16>$;++$)Y+=N[k+$-32];yn(Y>>4,N,k)}function dn(N,k){yn(128,N,k)}function Gr(N,k,$){return N+2*k+$+2>>2}function ga(N,k){var $,Y=k-32;for(Y=new Uint8Array([Gr(N[Y-1],N[Y+0],N[Y+1]),Gr(N[Y+0],N[Y+1],N[Y+2]),Gr(N[Y+1],N[Y+2],N[Y+3]),Gr(N[Y+2],N[Y+3],N[Y+4])]),$=0;4>$;++$)n(N,k+32*$,Y,0,Y.length)}function Ma(N,k){var $=N[k-1],Y=N[k-1+32],me=N[k-1+64],xe=N[k-1+96];ee(N,k+0,16843009*Gr(N[k-1-32],$,Y)),ee(N,k+32,16843009*Gr($,Y,me)),ee(N,k+64,16843009*Gr(Y,me,xe)),ee(N,k+96,16843009*Gr(me,xe,xe))}function va(N,k){var $,Y=4;for($=0;4>$;++$)Y+=N[k+$-32]+N[k-1+32*$];for(Y>>=3,$=0;4>$;++$)o(N,k+32*$,Y,4)}function $a(N,k){var $=N[k-1+0],Y=N[k-1+32],me=N[k-1+64],xe=N[k-1-32],je=N[k+0-32],Ae=N[k+1-32],Oe=N[k+2-32],Ue=N[k+3-32];N[k+0+96]=Gr(Y,me,N[k-1+96]),N[k+1+96]=N[k+0+64]=Gr($,Y,me),N[k+2+96]=N[k+1+64]=N[k+0+32]=Gr(xe,$,Y),N[k+3+96]=N[k+2+64]=N[k+1+32]=N[k+0+0]=Gr(je,xe,$),N[k+3+64]=N[k+2+32]=N[k+1+0]=Gr(Ae,je,xe),N[k+3+32]=N[k+2+0]=Gr(Oe,Ae,je),N[k+3+0]=Gr(Ue,Oe,Ae)}function ss(N,k){var $=N[k+1-32],Y=N[k+2-32],me=N[k+3-32],xe=N[k+4-32],je=N[k+5-32],Ae=N[k+6-32],Oe=N[k+7-32];N[k+0+0]=Gr(N[k+0-32],$,Y),N[k+1+0]=N[k+0+32]=Gr($,Y,me),N[k+2+0]=N[k+1+32]=N[k+0+64]=Gr(Y,me,xe),N[k+3+0]=N[k+2+32]=N[k+1+64]=N[k+0+96]=Gr(me,xe,je),N[k+3+32]=N[k+2+64]=N[k+1+96]=Gr(xe,je,Ae),N[k+3+64]=N[k+2+96]=Gr(je,Ae,Oe),N[k+3+96]=Gr(Ae,Oe,Oe)}function ao(N,k){var $=N[k-1+0],Y=N[k-1+32],me=N[k-1+64],xe=N[k-1-32],je=N[k+0-32],Ae=N[k+1-32],Oe=N[k+2-32],Ue=N[k+3-32];N[k+0+0]=N[k+1+64]=xe+je+1>>1,N[k+1+0]=N[k+2+64]=je+Ae+1>>1,N[k+2+0]=N[k+3+64]=Ae+Oe+1>>1,N[k+3+0]=Oe+Ue+1>>1,N[k+0+96]=Gr(me,Y,$),N[k+0+64]=Gr(Y,$,xe),N[k+0+32]=N[k+1+96]=Gr($,xe,je),N[k+1+32]=N[k+2+96]=Gr(xe,je,Ae),N[k+2+32]=N[k+3+96]=Gr(je,Ae,Oe),N[k+3+32]=Gr(Ae,Oe,Ue)}function xo(N,k){var $=N[k+0-32],Y=N[k+1-32],me=N[k+2-32],xe=N[k+3-32],je=N[k+4-32],Ae=N[k+5-32],Oe=N[k+6-32],Ue=N[k+7-32];N[k+0+0]=$+Y+1>>1,N[k+1+0]=N[k+0+64]=Y+me+1>>1,N[k+2+0]=N[k+1+64]=me+xe+1>>1,N[k+3+0]=N[k+2+64]=xe+je+1>>1,N[k+0+32]=Gr($,Y,me),N[k+1+32]=N[k+0+96]=Gr(Y,me,xe),N[k+2+32]=N[k+1+96]=Gr(me,xe,je),N[k+3+32]=N[k+2+96]=Gr(xe,je,Ae),N[k+3+64]=Gr(je,Ae,Oe),N[k+3+96]=Gr(Ae,Oe,Ue)}function Ss(N,k){var $=N[k-1+0],Y=N[k-1+32],me=N[k-1+64],xe=N[k-1+96];N[k+0+0]=$+Y+1>>1,N[k+2+0]=N[k+0+32]=Y+me+1>>1,N[k+2+32]=N[k+0+64]=me+xe+1>>1,N[k+1+0]=Gr($,Y,me),N[k+3+0]=N[k+1+32]=Gr(Y,me,xe),N[k+3+32]=N[k+1+64]=Gr(me,xe,xe),N[k+3+64]=N[k+2+64]=N[k+0+96]=N[k+1+96]=N[k+2+96]=N[k+3+96]=xe}function mi(N,k){var $=N[k-1+0],Y=N[k-1+32],me=N[k-1+64],xe=N[k-1+96],je=N[k-1-32],Ae=N[k+0-32],Oe=N[k+1-32],Ue=N[k+2-32];N[k+0+0]=N[k+2+32]=$+je+1>>1,N[k+0+32]=N[k+2+64]=Y+$+1>>1,N[k+0+64]=N[k+2+96]=me+Y+1>>1,N[k+0+96]=xe+me+1>>1,N[k+3+0]=Gr(Ae,Oe,Ue),N[k+2+0]=Gr(je,Ae,Oe),N[k+1+0]=N[k+3+32]=Gr($,je,Ae),N[k+1+32]=N[k+3+64]=Gr(Y,$,je),N[k+1+64]=N[k+3+96]=Gr(me,Y,$),N[k+1+96]=Gr(xe,me,Y)}function kd(N,k){var $;for($=0;8>$;++$)n(N,k+32*$,N,k-32,8)}function hi(N,k){var $;for($=0;8>$;++$)o(N,k,N[k-1],8),k+=32}function zc(N,k,$){var Y;for(Y=0;8>Y;++Y)o(k,$+32*Y,N,8)}function Oi(N,k){var $,Y=8;for($=0;8>$;++$)Y+=N[k+$-32]+N[k-1+32*$];zc(Y>>4,N,k)}function Nl(N,k){var $,Y=4;for($=0;8>$;++$)Y+=N[k+$-32];zc(Y>>3,N,k)}function rf(N,k){var $,Y=4;for($=0;8>$;++$)Y+=N[k-1+32*$];zc(Y>>3,N,k)}function Zl(N,k){zc(128,N,k)}function Ro(N,k,$){var Y=N[k-$],me=N[k+0],xe=3*(me-Y)+Lr[1020+N[k-2*$]-N[k+$]],je=Ht[112+(xe+4>>3)];N[k-$]=rr[255+Y+Ht[112+(xe+3>>3)]],N[k+0]=rr[255+me-je]}function yo(N,k,$,Y){var me=N[k+0],xe=N[k+$];return hn[255+N[k-2*$]-N[k-$]]>Y||hn[255+xe-me]>Y}function nf(N,k,$,Y){return 4*hn[255+N[k-$]-N[k+0]]+hn[255+N[k-2*$]-N[k+$]]<=Y}function xu(N,k,$,Y,me){var xe=N[k-3*$],je=N[k-2*$],Ae=N[k-$],Oe=N[k+0],Ue=N[k+$],yt=N[k+2*$],tr=N[k+3*$];return 4*hn[255+Ae-Oe]+hn[255+je-Ue]>Y?0:hn[255+N[k-4*$]-xe]<=me&&hn[255+xe-je]<=me&&hn[255+je-Ae]<=me&&hn[255+tr-yt]<=me&&hn[255+yt-Ue]<=me&&hn[255+Ue-Oe]<=me}function Fs(N,k,$,Y){var me=2*Y+1;for(Y=0;16>Y;++Y)nf(N,k+Y,$,me)&&Ro(N,k+Y,$)}function pi(N,k,$,Y){var me=2*Y+1;for(Y=0;16>Y;++Y)nf(N,k+Y*$,1,me)&&Ro(N,k+Y*$,1)}function af(N,k,$,Y){var me;for(me=3;0<me;--me)Fs(N,k+=4*$,$,Y)}function Ji(N,k,$,Y){var me;for(me=3;0<me;--me)pi(N,k+=4,$,Y)}function Ie(N,k,$,Y,me,xe,je,Ae){for(xe=2*xe+1;0<me--;){if(xu(N,k,$,xe,je))if(yo(N,k,$,Ae))Ro(N,k,$);else{var Oe=N,Ue=k,yt=$,tr=Oe[Ue-2*yt],Ve=Oe[Ue-yt],Pt=Oe[Ue+0],qt=Oe[Ue+yt],Ar=Oe[Ue+2*yt],Jt=27*(Dr=Lr[1020+3*(Pt-Ve)+Lr[1020+tr-qt]])+63>>7,Tr=18*Dr+63>>7,Dr=9*Dr+63>>7;Oe[Ue-3*yt]=rr[255+Oe[Ue-3*yt]+Dr],Oe[Ue-2*yt]=rr[255+tr+Tr],Oe[Ue-yt]=rr[255+Ve+Jt],Oe[Ue+0]=rr[255+Pt-Jt],Oe[Ue+yt]=rr[255+qt-Tr],Oe[Ue+2*yt]=rr[255+Ar-Dr]}k+=Y}}function Ye(N,k,$,Y,me,xe,je,Ae){for(xe=2*xe+1;0<me--;){if(xu(N,k,$,xe,je))if(yo(N,k,$,Ae))Ro(N,k,$);else{var Oe=N,Ue=k,yt=$,tr=Oe[Ue-yt],Ve=Oe[Ue+0],Pt=Oe[Ue+yt],qt=Ht[112+(4+(Ar=3*(Ve-tr))>>3)],Ar=Ht[112+(Ar+3>>3)],Jt=qt+1>>1;Oe[Ue-2*yt]=rr[255+Oe[Ue-2*yt]+Jt],Oe[Ue-yt]=rr[255+tr+Ar],Oe[Ue+0]=rr[255+Ve-qt],Oe[Ue+yt]=rr[255+Pt-Jt]}k+=Y}}function ar(N,k,$,Y,me,xe){Ie(N,k,$,1,16,Y,me,xe)}function Gt(N,k,$,Y,me,xe){Ie(N,k,1,$,16,Y,me,xe)}function Ut(N,k,$,Y,me,xe){var je;for(je=3;0<je;--je)Ye(N,k+=4*$,$,1,16,Y,me,xe)}function Ot(N,k,$,Y,me,xe){var je;for(je=3;0<je;--je)Ye(N,k+=4,1,$,16,Y,me,xe)}function S(N,k,$,Y,me,xe,je,Ae){Ie(N,k,me,1,8,xe,je,Ae),Ie($,Y,me,1,8,xe,je,Ae)}function K(N,k,$,Y,me,xe,je,Ae){Ie(N,k,1,me,8,xe,je,Ae),Ie($,Y,1,me,8,xe,je,Ae)}function ne(N,k,$,Y,me,xe,je,Ae){Ye(N,k+4*me,me,1,8,xe,je,Ae),Ye($,Y+4*me,me,1,8,xe,je,Ae)}function Ce(N,k,$,Y,me,xe,je,Ae){Ye(N,k+4,1,me,8,xe,je,Ae),Ye($,Y+4,1,me,8,xe,je,Ae)}function W(){this.ba=new nr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ee,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function oe(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Pe(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ze(){this.ua=0,this.Wa=new At,this.vb=new At,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new U,this.yc=new R}function Ke(){this.xb=this.a=0,this.l=new _t,this.ca=new nr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new B,this.Pb=0,this.wd=new B,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ze,this.ab=0,this.gc=i(4,Pe),this.Oc=0}function Tt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new _t,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function it(N,k,$,Y,me,xe,je){for(N=N==null?0:N[k+0],k=0;k<je;++k)me[xe+k]=N+$[Y+k]&255,N=me[xe+k]}function Bt(N,k,$,Y,me,xe,je){var Ae;if(N==null)it(null,null,$,Y,me,xe,je);else for(Ae=0;Ae<je;++Ae)me[xe+Ae]=N[k+Ae]+$[Y+Ae]&255}function Kt(N,k,$,Y,me,xe,je){if(N==null)it(null,null,$,Y,me,xe,je);else{var Ae,Oe=N[k+0],Ue=Oe,yt=Oe;for(Ae=0;Ae<je;++Ae)Ue=yt+(Oe=N[k+Ae])-Ue,yt=$[Y+Ae]+(-256&Ue?0>Ue?0:255:Ue)&255,Ue=Oe,me[xe+Ae]=yt}}function Ct(N,k,$,Y){var me=k.width,xe=k.o;if(t(N!=null&&k!=null),0>$||0>=Y||$+Y>xe)return null;if(!N.Cc){if(N.ga==null){var je;if(N.ga=new Tt,(je=N.ga==null)||(je=k.width*k.o,t(N.Gb.length==0),N.Gb=s(je),N.Uc=0,N.Gb==null?je=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,je=1),je=!je),!je){je=N.ga;var Ae=N.Fa,Oe=N.P,Ue=N.qc,yt=N.mb,tr=N.nb,Ve=Oe+1,Pt=Ue-1,qt=je.l;if(t(Ae!=null&&yt!=null&&k!=null),lm[0]=null,lm[1]=it,lm[2]=Bt,lm[3]=Kt,je.ca=yt,je.tb=tr,je.c=k.width,je.i=k.height,t(0<je.c&&0<je.i),1>=Ue)k=0;else if(je.$a=3&Ae[Oe+0],je.Z=Ae[Oe+0]>>2&3,je.Lc=Ae[Oe+0]>>4&3,Oe=Ae[Oe+0]>>6&3,0>je.$a||1<je.$a||4<=je.Z||1<je.Lc||Oe)k=0;else if(qt.put=pt,qt.ac=St,qt.bc=Et,qt.ma=je,qt.width=k.width,qt.height=k.height,qt.Da=k.Da,qt.v=k.v,qt.va=k.va,qt.j=k.j,qt.o=k.o,je.$a)e:{t(je.$a==1),k=ln();t:for(;;){if(k==null){k=0;break e}if(t(je!=null),je.mc=k,k.c=je.c,k.i=je.i,k.l=je.l,k.l.ma=je,k.l.width=je.c,k.l.height=je.i,k.a=0,Q(k.m,Ae,Ve,Pt),!Fn(je.c,je.i,1,k,null)||(k.ab==1&&k.gc[0].hc==3&&br(k.s)?(je.ic=1,Ae=k.c*k.i,k.Ta=null,k.Ua=0,k.V=s(Ae),k.Ba=0,k.V==null?(k.a=1,k=0):k=1):(je.ic=0,k=Hn(k,je.c)),!k))break t;k=1;break e}je.mc=null,k=0}else k=Pt>=je.c*je.i;je=!k}if(je)return null;N.ga.Lc!=1?N.Ga=0:Y=xe-$}t(N.ga!=null),t($+Y<=xe);e:{if(k=(Ae=N.ga).c,xe=Ae.l.o,Ae.$a==0){if(Ve=N.rc,Pt=N.Vc,qt=N.Fa,Oe=N.P+1+$*k,Ue=N.mb,yt=N.nb+$*k,t(Oe<=N.P+N.qc),Ae.Z!=0)for(t(lm[Ae.Z]!=null),je=0;je<Y;++je)lm[Ae.Z](Ve,Pt,qt,Oe,Ue,yt,k),Ve=Ue,Pt=yt,yt+=k,Oe+=k;else for(je=0;je<Y;++je)n(Ue,yt,qt,Oe,k),Ve=Ue,Pt=yt,yt+=k,Oe+=k;N.rc=Ve,N.Vc=Pt}else{if(t(Ae.mc!=null),k=$+Y,t((je=Ae.mc)!=null),t(k<=je.i),je.C>=k)k=1;else if(Ae.ic||Cr(),Ae.ic){Ae=je.V,Ve=je.Ba,Pt=je.c;var Ar=je.i,Jt=(qt=1,Oe=je.$/Pt,Ue=je.$%Pt,yt=je.m,tr=je.s,je.$),Tr=Pt*Ar,Dr=Pt*k,Xr=tr.wc,Ur=Jt<Dr?ye(tr,Ue,Oe):null;t(Jt<=Tr),t(k<=Ar),t(br(tr));t:for(;;){for(;!yt.h&&Jt<Dr;){if(Ue&Xr||(Ur=ye(tr,Ue,Oe)),t(Ur!=null),Z(yt),256>(Ar=Dt(Ur.G[0],Ur.H[0],yt)))Ae[Ve+Jt]=Ar,++Jt,++Ue>=Pt&&(Ue=0,++Oe<=k&&!(Oe%16)&&Nr(je,Oe));else{if(!(280>Ar)){qt=0;break t}Ar=gt(Ar-256,yt);var Gn,Mn=Dt(Ur.G[4],Ur.H[4],yt);if(Z(yt),!(Jt>=(Mn=ft(Pt,Mn=gt(Mn,yt)))&&Tr-Jt>=Ar)){qt=0;break t}for(Gn=0;Gn<Ar;++Gn)Ae[Ve+Jt+Gn]=Ae[Ve+Jt+Gn-Mn];for(Jt+=Ar,Ue+=Ar;Ue>=Pt;)Ue-=Pt,++Oe<=k&&!(Oe%16)&&Nr(je,Oe);Jt<Dr&&Ue&Xr&&(Ur=ye(tr,Ue,Oe))}t(yt.h==ue(yt))}Nr(je,Oe>k?k:Oe);break t}!qt||yt.h&&Jt<Tr?(qt=0,je.a=yt.h?5:3):je.$=Jt,k=qt}else k=Rr(je,je.V,je.Ba,je.c,je.i,k,$n);if(!k){Y=0;break e}}$+Y>=xe&&(N.Cc=1),Y=1}if(!Y)return null;if(N.Cc&&((Y=N.ga)!=null&&(Y.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+$*me}function Or(N,k,$,Y,me,xe){for(;0<me--;){var je,Ae=N,Oe=k+($?1:0),Ue=N,yt=k+($?0:3);for(je=0;je<Y;++je){var tr=Ue[yt+4*je];tr!=255&&(tr*=32897,Ae[Oe+4*je+0]=Ae[Oe+4*je+0]*tr>>23,Ae[Oe+4*je+1]=Ae[Oe+4*je+1]*tr>>23,Ae[Oe+4*je+2]=Ae[Oe+4*je+2]*tr>>23)}k+=xe}}function jr(N,k,$,Y,me){for(;0<Y--;){var xe;for(xe=0;xe<$;++xe){var je=N[k+2*xe+0],Ae=15&(Ue=N[k+2*xe+1]),Oe=4369*Ae,Ue=(240&Ue|Ue>>4)*Oe>>16;N[k+2*xe+0]=(240&je|je>>4)*Oe>>16&240|(15&je|je<<4)*Oe>>16>>4&15,N[k+2*xe+1]=240&Ue|Ae}k+=me}}function or(N,k,$,Y,me,xe,je,Ae){var Oe,Ue,yt=255;for(Ue=0;Ue<me;++Ue){for(Oe=0;Oe<Y;++Oe){var tr=N[k+Oe];xe[je+4*Oe]=tr,yt&=tr}k+=$,je+=Ae}return yt!=255}function Hr(N,k,$,Y,me){var xe;for(xe=0;xe<me;++xe)$[Y+xe]=N[k+xe]>>8}function Cr(){om=Or,L0=jr,Dg=or,sm=Hr}function Yr(N,k,$){P[N]=function(Y,me,xe,je,Ae,Oe,Ue,yt,tr,Ve,Pt,qt,Ar,Jt,Tr,Dr,Xr){var Ur,Gn=Xr-1>>1,Mn=Ae[Oe+0]|Ue[yt+0]<<16,Na=tr[Ve+0]|Pt[qt+0]<<16;t(Y!=null);var zn=3*Mn+Na+131074>>2;for(k(Y[me+0],255&zn,zn>>16,Ar,Jt),xe!=null&&(zn=3*Na+Mn+131074>>2,k(xe[je+0],255&zn,zn>>16,Tr,Dr)),Ur=1;Ur<=Gn;++Ur){var Ba=Ae[Oe+Ur]|Ue[yt+Ur]<<16,$s=tr[Ve+Ur]|Pt[qt+Ur]<<16,Sa=Mn+Ba+Na+$s+524296,Un=Sa+2*(Ba+Na)>>3;zn=Un+Mn>>1,Mn=(Sa=Sa+2*(Mn+$s)>>3)+Ba>>1,k(Y[me+2*Ur-1],255&zn,zn>>16,Ar,Jt+(2*Ur-1)*$),k(Y[me+2*Ur-0],255&Mn,Mn>>16,Ar,Jt+(2*Ur-0)*$),xe!=null&&(zn=Sa+Na>>1,Mn=Un+$s>>1,k(xe[je+2*Ur-1],255&zn,zn>>16,Tr,Dr+(2*Ur-1)*$),k(xe[je+2*Ur+0],255&Mn,Mn>>16,Tr,Dr+(2*Ur+0)*$)),Mn=Ba,Na=$s}1&Xr||(zn=3*Mn+Na+131074>>2,k(Y[me+Xr-1],255&zn,zn>>16,Ar,Jt+(Xr-1)*$),xe!=null&&(zn=3*Na+Mn+131074>>2,k(xe[je+Xr-1],255&zn,zn>>16,Tr,Dr+(Xr-1)*$)))}}function vr(){Hc[kn]=Dse,Hc[wn]=VR,Hc[an]=Mse,Hc[sa]=WR,Hc[xa]=HR,Hc[Aa]=GR,Hc[Jo]=Rse,Hc[ha]=VR,Hc[Ea]=WR,Hc[Ti]=HR,Hc[eo]=GR}function lr(N){return N&~Lse?0>N?0:255:N>>KR}function ct(N,k){return lr((19077*N>>8)+(26149*k>>8)-14234)}function Zr(N,k,$){return lr((19077*N>>8)-(6419*k>>8)-(13320*$>>8)+8708)}function cn(N,k){return lr((19077*N>>8)+(33050*k>>8)-17685)}function Ia(N,k,$,Y,me){Y[me+0]=ct(N,$),Y[me+1]=Zr(N,k,$),Y[me+2]=cn(N,k)}function Ca(N,k,$,Y,me){Y[me+0]=cn(N,k),Y[me+1]=Zr(N,k,$),Y[me+2]=ct(N,$)}function cr(N,k,$,Y,me){var xe=Zr(N,k,$);k=xe<<3&224|cn(N,k)>>3,Y[me+0]=248&ct(N,$)|xe>>5,Y[me+1]=k}function xr(N,k,$,Y,me){var xe=240&cn(N,k)|15;Y[me+0]=240&ct(N,$)|Zr(N,k,$)>>4,Y[me+1]=xe}function qr(N,k,$,Y,me){Y[me+0]=255,Ia(N,k,$,Y,me+1)}function Kr(N,k,$,Y,me){Ca(N,k,$,Y,me),Y[me+3]=255}function un(N,k,$,Y,me){Ia(N,k,$,Y,me),Y[me+3]=255}function on(N,k){return 0>N?0:N>k?k:N}function sr(N,k,$){P[N]=function(Y,me,xe,je,Ae,Oe,Ue,yt,tr){for(var Ve=yt+(-2&tr)*$;yt!=Ve;)k(Y[me+0],xe[je+0],Ae[Oe+0],Ue,yt),k(Y[me+1],xe[je+0],Ae[Oe+0],Ue,yt+$),me+=2,++je,++Oe,yt+=2*$;1&tr&&k(Y[me+0],xe[je+0],Ae[Oe+0],Ue,yt)}}function nn(N,k,$){return $==0?N==0?k==0?6:5:k==0?4:0:$}function ur(N,k,$,Y,me){switch(N>>>30){case 3:Cl(k,$,Y,me,0);break;case 2:Pl(k,$,Y,me);break;case 1:Ua(k,$,Y,me)}}function gr(N,k){var $,Y,me=k.M,xe=k.Nb,je=N.oc,Ae=N.pc+40,Oe=N.oc,Ue=N.pc+584,yt=N.oc,tr=N.pc+600;for($=0;16>$;++$)je[Ae+32*$-1]=129;for($=0;8>$;++$)Oe[Ue+32*$-1]=129,yt[tr+32*$-1]=129;for(0<me?je[Ae-1-32]=Oe[Ue-1-32]=yt[tr-1-32]=129:(o(je,Ae-32-1,127,21),o(Oe,Ue-32-1,127,9),o(yt,tr-32-1,127,9)),Y=0;Y<N.za;++Y){var Ve=k.ya[k.aa+Y];if(0<Y){for($=-1;16>$;++$)n(je,Ae+32*$-4,je,Ae+32*$+12,4);for($=-1;8>$;++$)n(Oe,Ue+32*$-4,Oe,Ue+32*$+4,4),n(yt,tr+32*$-4,yt,tr+32*$+4,4)}var Pt=N.Gd,qt=N.Hd+Y,Ar=Ve.ad,Jt=Ve.Hc;if(0<me&&(n(je,Ae-32,Pt[qt].y,0,16),n(Oe,Ue-32,Pt[qt].f,0,8),n(yt,tr-32,Pt[qt].ea,0,8)),Ve.Za){var Tr=je,Dr=Ae-32+16;for(0<me&&(Y>=N.za-1?o(Tr,Dr,Pt[qt].y[15],4):n(Tr,Dr,Pt[qt+1].y,0,4)),$=0;4>$;$++)Tr[Dr+128+$]=Tr[Dr+256+$]=Tr[Dr+384+$]=Tr[Dr+0+$];for($=0;16>$;++$,Jt<<=2)Tr=je,Dr=Ae+YR[$],Dd[Ve.Ob[$]](Tr,Dr),ur(Jt,Ar,16*+$,Tr,Dr)}else if(Tr=nn(Y,me,Ve.Ob[0]),im[Tr](je,Ae),Jt!=0)for($=0;16>$;++$,Jt<<=2)ur(Jt,Ar,16*+$,je,Ae+YR[$]);for($=Ve.Gc,Tr=nn(Y,me,Ve.Dd),sf[Tr](Oe,Ue),sf[Tr](yt,tr),Jt=Ar,Tr=Oe,Dr=Ue,255&(Ve=0|$)&&(170&Ve?tc(Jt,256,Tr,Dr):Za(Jt,256,Tr,Dr)),Ve=yt,Jt=tr,255&($>>=8)&&(170&$?tc(Ar,320,Ve,Jt):Za(Ar,320,Ve,Jt)),me<N.Ub-1&&(n(Pt[qt].y,0,je,Ae+480,16),n(Pt[qt].f,0,Oe,Ue+224,8),n(Pt[qt].ea,0,yt,tr+224,8)),$=8*xe*N.B,Pt=N.sa,qt=N.ta+16*Y+16*xe*N.R,Ar=N.qa,Ve=N.ra+8*Y+$,Jt=N.Ha,Tr=N.Ia+8*Y+$,$=0;16>$;++$)n(Pt,qt+$*N.R,je,Ae+32*$,16);for($=0;8>$;++$)n(Ar,Ve+$*N.B,Oe,Ue+32*$,8),n(Jt,Tr+$*N.B,yt,tr+32*$,8)}}function Vr(N,k,$,Y,me,xe,je,Ae,Oe){var Ue=[0],yt=[0],tr=0,Ve=Oe!=null?Oe.kd:0,Pt=Oe??new oe;if(N==null||12>$)return 7;Pt.data=N,Pt.w=k,Pt.ha=$,k=[k],$=[$],Pt.gb=[Pt.gb];e:{var qt=k,Ar=$,Jt=Pt.gb;if(t(N!=null),t(Ar!=null),t(Jt!=null),Jt[0]=0,12<=Ar[0]&&!r(N,qt[0],"RIFF")){if(r(N,qt[0]+8,"WEBP")){Jt=3;break e}var Tr=ae(N,qt[0]+4);if(12>Tr||4294967286<Tr){Jt=3;break e}if(Ve&&Tr>Ar[0]-8){Jt=7;break e}Jt[0]=Tr,qt[0]+=12,Ar[0]-=12}Jt=0}if(Jt!=0)return Jt;for(Tr=0<Pt.gb[0],$=$[0];;){e:{var Dr=N;Ar=k,Jt=$;var Xr=Ue,Ur=yt,Gn=qt=[0];if((zn=tr=[tr])[0]=0,8>Jt[0])Jt=7;else{if(!r(Dr,Ar[0],"VP8X")){if(ae(Dr,Ar[0]+4)!=10){Jt=3;break e}if(18>Jt[0]){Jt=7;break e}var Mn=ae(Dr,Ar[0]+8),Na=1+Le(Dr,Ar[0]+12);if(2147483648<=Na*(Dr=1+Le(Dr,Ar[0]+15))){Jt=3;break e}Gn!=null&&(Gn[0]=Mn),Xr!=null&&(Xr[0]=Na),Ur!=null&&(Ur[0]=Dr),Ar[0]+=18,Jt[0]-=18,zn[0]=1}Jt=0}}if(tr=tr[0],qt=qt[0],Jt!=0)return Jt;if(Ar=!!(2&qt),!Tr&&tr)return 3;if(xe!=null&&(xe[0]=!!(16&qt)),je!=null&&(je[0]=Ar),Ae!=null&&(Ae[0]=0),je=Ue[0],qt=yt[0],tr&&Ar&&Oe==null){Jt=0;break}if(4>$){Jt=7;break}if(Tr&&tr||!Tr&&!tr&&!r(N,k[0],"ALPH")){$=[$],Pt.na=[Pt.na],Pt.P=[Pt.P],Pt.Sa=[Pt.Sa];e:{Mn=N,Jt=k,Tr=$;var zn=Pt.gb;Xr=Pt.na,Ur=Pt.P,Gn=Pt.Sa,Na=22,t(Mn!=null),t(Tr!=null),Dr=Jt[0];var Ba=Tr[0];for(t(Xr!=null),t(Gn!=null),Xr[0]=null,Ur[0]=null,Gn[0]=0;;){if(Jt[0]=Dr,Tr[0]=Ba,8>Ba){Jt=7;break e}var $s=ae(Mn,Dr+4);if(4294967286<$s){Jt=3;break e}var Sa=8+$s+1&-2;if(Na+=Sa,0<zn&&Na>zn){Jt=3;break e}if(!r(Mn,Dr,"VP8 ")||!r(Mn,Dr,"VP8L")){Jt=0;break e}if(Ba[0]<Sa){Jt=7;break e}r(Mn,Dr,"ALPH")||(Xr[0]=Mn,Ur[0]=Dr+8,Gn[0]=$s),Dr+=Sa,Ba-=Sa}}if($=$[0],Pt.na=Pt.na[0],Pt.P=Pt.P[0],Pt.Sa=Pt.Sa[0],Jt!=0)break}$=[$],Pt.Ja=[Pt.Ja],Pt.xa=[Pt.xa];e:if(zn=N,Jt=k,Tr=$,Xr=Pt.gb[0],Ur=Pt.Ja,Gn=Pt.xa,Mn=Jt[0],Dr=!r(zn,Mn,"VP8 "),Na=!r(zn,Mn,"VP8L"),t(zn!=null),t(Tr!=null),t(Ur!=null),t(Gn!=null),8>Tr[0])Jt=7;else{if(Dr||Na){if(zn=ae(zn,Mn+4),12<=Xr&&zn>Xr-12){Jt=3;break e}if(Ve&&zn>Tr[0]-8){Jt=7;break e}Ur[0]=zn,Jt[0]+=8,Tr[0]-=8,Gn[0]=Na}else Gn[0]=5<=Tr[0]&&zn[Mn+0]==47&&!(zn[Mn+4]>>5),Ur[0]=Tr[0];Jt=0}if($=$[0],Pt.Ja=Pt.Ja[0],Pt.xa=Pt.xa[0],k=k[0],Jt!=0)break;if(4294967286<Pt.Ja)return 3;if(Ae==null||Ar||(Ae[0]=Pt.xa?2:1),je=[je],qt=[qt],Pt.xa){if(5>$){Jt=7;break}Ae=je,Ve=qt,Ar=xe,N==null||5>$?N=0:5<=$&&N[k+0]==47&&!(N[k+4]>>5)?(Tr=[0],zn=[0],Xr=[0],Q(Ur=new B,N,k,$),mt(Ur,Tr,zn,Xr)?(Ae!=null&&(Ae[0]=Tr[0]),Ve!=null&&(Ve[0]=zn[0]),Ar!=null&&(Ar[0]=Xr[0]),N=1):N=0):N=0}else{if(10>$){Jt=7;break}Ae=qt,N==null||10>$||!ma(N,k+3,$-3)?N=0:(Ve=N[k+0]|N[k+1]<<8|N[k+2]<<16,Ar=16383&(N[k+7]<<8|N[k+6]),N=16383&(N[k+9]<<8|N[k+8]),1&Ve||3<(Ve>>1&7)||!(Ve>>4&1)||Ve>>5>=Pt.Ja||!Ar||!N?N=0:(je&&(je[0]=Ar),Ae&&(Ae[0]=N),N=1))}if(!N||(je=je[0],qt=qt[0],tr&&(Ue[0]!=je||yt[0]!=qt)))return 3;Oe!=null&&(Oe[0]=Pt,Oe.offset=k-Oe.w,t(4294967286>k-Oe.w),t(Oe.offset==Oe.ha-$));break}return Jt==0||Jt==7&&tr&&Oe==null?(xe!=null&&(xe[0]|=Pt.na!=null&&0<Pt.na.length),Y!=null&&(Y[0]=je),me!=null&&(me[0]=qt),0):Jt}function rn(N,k,$){var Y=k.width,me=k.height,xe=0,je=0,Ae=Y,Oe=me;if(k.Da=N!=null&&0<N.Da,k.Da&&(Ae=N.cd,Oe=N.bd,xe=N.v,je=N.j,11>$||(xe&=-2,je&=-2),0>xe||0>je||0>=Ae||0>=Oe||xe+Ae>Y||je+Oe>me))return 0;if(k.v=xe,k.j=je,k.va=xe+Ae,k.o=je+Oe,k.U=Ae,k.T=Oe,k.da=N!=null&&0<N.da,k.da){if(!st(Ae,Oe,$=[N.ib],xe=[N.hb]))return 0;k.ib=$[0],k.hb=xe[0]}return k.ob=N!=null&&N.ob,k.Kb=N==null||!N.Sd,k.da&&(k.ob=k.ib<3*Y/4&&k.hb<3*me/4,k.Kb=0),1}function $r(N){if(N==null)return 2;if(11>N.S){var k=N.f.RGBA;k.fb+=(N.height-1)*k.A,k.A=-k.A}else k=N.f.kb,N=N.height,k.O+=(N-1)*k.fa,k.fa=-k.fa,k.N+=(N-1>>1)*k.Ab,k.Ab=-k.Ab,k.W+=(N-1>>1)*k.Db,k.Db=-k.Db,k.F!=null&&(k.J+=(N-1)*k.lb,k.lb=-k.lb);return 0}function Pn(N,k,$,Y){if(Y==null||0>=N||0>=k)return 2;if($!=null){if($.Da){var me=$.cd,xe=$.bd,je=-2&$.v,Ae=-2&$.j;if(0>je||0>Ae||0>=me||0>=xe||je+me>N||Ae+xe>k)return 2;N=me,k=xe}if($.da){if(!st(N,k,me=[$.ib],xe=[$.hb]))return 2;N=me[0],k=xe[0]}}Y.width=N,Y.height=k;e:{var Oe=Y.width,Ue=Y.height;if(N=Y.S,0>=Oe||0>=Ue||!(N>=kn&&13>N))N=2;else{if(0>=Y.Rd&&Y.sd==null){je=xe=me=k=0;var yt=(Ae=Oe*JR[N])*Ue;if(11>N||(xe=(Ue+1)/2*(k=(Oe+1)/2),N==12&&(je=(me=Oe)*Ue)),(Ue=s(yt+2*xe+je))==null){N=1;break e}Y.sd=Ue,11>N?((Oe=Y.f.RGBA).eb=Ue,Oe.fb=0,Oe.A=Ae,Oe.size=yt):((Oe=Y.f.kb).y=Ue,Oe.O=0,Oe.fa=Ae,Oe.Fd=yt,Oe.f=Ue,Oe.N=0+yt,Oe.Ab=k,Oe.Cd=xe,Oe.ea=Ue,Oe.W=0+yt+xe,Oe.Db=k,Oe.Ed=xe,N==12&&(Oe.F=Ue,Oe.J=0+yt+2*xe),Oe.Tc=je,Oe.lb=me)}if(k=1,me=Y.S,xe=Y.width,je=Y.height,me>=kn&&13>me)if(11>me)N=Y.f.RGBA,k&=(Ae=Math.abs(N.A))*(je-1)+xe<=N.size,k&=Ae>=xe*JR[me],k&=N.eb!=null;else{N=Y.f.kb,Ae=(xe+1)/2,yt=(je+1)/2,Oe=Math.abs(N.fa),Ue=Math.abs(N.Ab);var tr=Math.abs(N.Db),Ve=Math.abs(N.lb),Pt=Ve*(je-1)+xe;k&=Oe*(je-1)+xe<=N.Fd,k&=Ue*(yt-1)+Ae<=N.Cd,k=(k&=tr*(yt-1)+Ae<=N.Ed)&Oe>=xe&Ue>=Ae&tr>=Ae,k&=N.y!=null,k&=N.f!=null,k&=N.ea!=null,me==12&&(k&=Ve>=xe,k&=Pt<=N.Tc,k&=N.F!=null)}else k=0;N=k?0:2}}return N!=0||$!=null&&$.fd&&(N=$r(Y)),N}var Ln=64,Qr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Bn=24,Pa=32,Ja=8,po=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Nt("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(N){return N},P.Predictor2=function(N,k,$){return k[$+0]},P.Predictor3=function(N,k,$){return k[$+1]},P.Predictor4=function(N,k,$){return k[$-1]},P.Predictor5=function(N,k,$){return he(he(N,k[$+1]),k[$+0])},P.Predictor6=function(N,k,$){return he(N,k[$-1])},P.Predictor7=function(N,k,$){return he(N,k[$+0])},P.Predictor8=function(N,k,$){return he(k[$-1],k[$+0])},P.Predictor9=function(N,k,$){return he(k[$+0],k[$+1])},P.Predictor10=function(N,k,$){return he(he(N,k[$-1]),he(k[$+0],k[$+1]))},P.Predictor11=function(N,k,$){var Y=k[$+0];return 0>=Me(Y>>24&255,N>>24&255,(k=k[$-1])>>24&255)+Me(Y>>16&255,N>>16&255,k>>16&255)+Me(Y>>8&255,N>>8&255,k>>8&255)+Me(255&Y,255&N,255&k)?Y:N},P.Predictor12=function(N,k,$){var Y=k[$+0];return(ke((N>>24&255)+(Y>>24&255)-((k=k[$-1])>>24&255))<<24|ke((N>>16&255)+(Y>>16&255)-(k>>16&255))<<16|ke((N>>8&255)+(Y>>8&255)-(k>>8&255))<<8|ke((255&N)+(255&Y)-(255&k)))>>>0},P.Predictor13=function(N,k,$){var Y=k[$-1];return(et((N=he(N,k[$+0]))>>24&255,Y>>24&255)<<24|et(N>>16&255,Y>>16&255)<<16|et(N>>8&255,Y>>8&255)<<8|et(255&N,255&Y))>>>0};var Id=P.PredictorAdd0;P.PredictorAdd1=$e,Nt("Predictor2","PredictorAdd2"),Nt("Predictor3","PredictorAdd3"),Nt("Predictor4","PredictorAdd4"),Nt("Predictor5","PredictorAdd5"),Nt("Predictor6","PredictorAdd6"),Nt("Predictor7","PredictorAdd7"),Nt("Predictor8","PredictorAdd8"),Nt("Predictor9","PredictorAdd9"),Nt("Predictor10","PredictorAdd10"),Nt("Predictor11","PredictorAdd11"),Nt("Predictor12","PredictorAdd12"),Nt("Predictor13","PredictorAdd13");var Uc=P.PredictorAdd2;ht("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),ht("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var go,of=P.ColorIndexInverseTransform,Sl=P.MapARGB,is=P.VP8LColorIndexInverseTransformAlpha,Zs=P.MapAlpha,Wh=P.VP8LPredictorsAdd=[];Wh.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var Vc,Od,Qi,gi,Wo,ec,Wc,Cl,Pl,tc,Ua,Za,Lo,bo,Yo,ei,Td,Tg,rc,R0,W1,H1,G1,K1,om,L0,Dg,sm,ve=s(511),We=s(2041),Xe=s(225),xt=s(767),vt=0,Lr=We,Ht=Xe,rr=xt,hn=ve,kn=0,wn=1,an=2,sa=3,xa=4,Aa=5,Jo=6,ha=7,Ea=8,Ti=9,eo=10,Di=[2,3,7],wo=[3,3,11],Qo=[280,256,256,256,40],Mi=[0,1,1,1,0],vi=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ka=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ti=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Zo=8,Cs=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],xi=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Al=null,Pse=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Ase=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],zR=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Ese=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],kse=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ise=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ose=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],im=[],Dd=[],sf=[],Tse=1,UR=2,lm=[],Hc=[];Yr("UpsampleRgbLinePair",Ia,3),Yr("UpsampleBgrLinePair",Ca,3),Yr("UpsampleRgbaLinePair",un,4),Yr("UpsampleBgraLinePair",Kr,4),Yr("UpsampleArgbLinePair",qr,4),Yr("UpsampleRgba4444LinePair",xr,2),Yr("UpsampleRgb565LinePair",cr,2);var Dse=P.UpsampleRgbLinePair,Mse=P.UpsampleBgrLinePair,VR=P.UpsampleRgbaLinePair,WR=P.UpsampleBgraLinePair,HR=P.UpsampleArgbLinePair,GR=P.UpsampleRgba4444LinePair,Rse=P.UpsampleRgb565LinePair,X1=16,Y1=1<<X1-1,F0=-227,aP=482,KR=6,Lse=(256<<KR)-1,XR=0,Fse=s(256),$se=s(256),Bse=s(256),qse=s(256),zse=s(aP-F0),Use=s(aP-F0);sr("YuvToRgbRow",Ia,3),sr("YuvToBgrRow",Ca,3),sr("YuvToRgbaRow",un,4),sr("YuvToBgraRow",Kr,4),sr("YuvToArgbRow",qr,4),sr("YuvToRgba4444Row",xr,2),sr("YuvToRgb565Row",cr,2);var YR=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],J1=[0,2,8],Vse=[8,7,6,4,4,2,2,2,1,1,1,1],Wse=1;this.WebPDecodeRGBA=function(N,k,$,Y,me){var xe=wn,je=new W,Ae=new nr;je.ba=Ae,Ae.S=xe,Ae.width=[Ae.width],Ae.height=[Ae.height];var Oe=Ae.width,Ue=Ae.height,yt=new ir;if(yt==null||N==null)var tr=2;else t(yt!=null),tr=Vr(N,k,$,yt.width,yt.height,yt.Pd,yt.Qd,yt.format,null);if(tr!=0?Oe=0:(Oe!=null&&(Oe[0]=yt.width[0]),Ue!=null&&(Ue[0]=yt.height[0]),Oe=1),Oe){Ae.width=Ae.width[0],Ae.height=Ae.height[0],Y!=null&&(Y[0]=Ae.width),me!=null&&(me[0]=Ae.height);e:{if(Y=new _t,(me=new oe).data=N,me.w=k,me.ha=$,me.kd=1,k=[0],t(me!=null),((N=Vr(me.data,me.w,me.ha,null,null,null,k,null,me))==0||N==7)&&k[0]&&(N=4),(k=N)==0){if(t(je!=null),Y.data=me.data,Y.w=me.w+me.offset,Y.ha=me.ha-me.offset,Y.put=pt,Y.ac=St,Y.bc=Et,Y.ma=je,me.xa){if((N=ln())==null){je=1;break e}if(function(Ve,Pt){var qt=[0],Ar=[0],Jt=[0];t:for(;;){if(Ve==null)return 0;if(Pt==null)return Ve.a=2,0;if(Ve.l=Pt,Ve.a=0,Q(Ve.m,Pt.data,Pt.w,Pt.ha),!mt(Ve.m,qt,Ar,Jt)){Ve.a=3;break t}if(Ve.xb=UR,Pt.width=qt[0],Pt.height=Ar[0],!Fn(qt[0],Ar[0],1,Ve,null))break t;return 1}return t(Ve.a!=0),0}(N,Y)){if(Y=(k=Pn(Y.width,Y.height,je.Oa,je.ba))==0){t:{Y=N;r:for(;;){if(Y==null){Y=0;break t}if(t(Y.s.yc!=null),t(Y.s.Ya!=null),t(0<Y.s.Wb),t(($=Y.l)!=null),t((me=$.ma)!=null),Y.xb!=0){if(Y.ca=me.ba,Y.tb=me.tb,t(Y.ca!=null),!rn(me.Oa,$,sa)){Y.a=2;break r}if(!Hn(Y,$.width)||$.da)break r;if(($.da||fr(Y.ca.S))&&Cr(),11>Y.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Y.ca.f.kb.F!=null&&Cr()),Y.Pb&&0<Y.s.ua&&Y.s.vb.X==null&&!ie(Y.s.vb,Y.s.Wa.Xa)){Y.a=1;break r}Y.xb=0}if(!Rr(Y,Y.V,Y.Ba,Y.c,Y.i,$.o,Yt))break r;me.Dc=Y.Ma,Y=1;break t}t(Y.a!=0),Y=0}Y=!Y}Y&&(k=N.a)}else k=N.a}else{if((N=new Jr)==null){je=1;break e}if(N.Fa=me.na,N.P=me.P,N.qc=me.Sa,Nn(N,Y)){if((k=Pn(Y.width,Y.height,je.Oa,je.ba))==0){if(N.Aa=0,$=je.Oa,t((me=N)!=null),$!=null){if(0<(Oe=0>(Oe=$.Md)?0:100<Oe?255:255*Oe/100)){for(Ue=yt=0;4>Ue;++Ue)12>(tr=me.pb[Ue]).lc&&(tr.ia=Oe*Vse[0>tr.lc?0:tr.lc]>>3),yt|=tr.ia;yt&&(alert("todo:VP8InitRandom"),me.ia=1)}me.Ga=$.Id,100<me.Ga?me.Ga=100:0>me.Ga&&(me.Ga=0)}(function(Ve,Pt){if(Ve==null)return 0;if(Pt==null)return mn(Ve,2,"NULL VP8Io parameter in VP8Decode().");if(!Ve.cb&&!Nn(Ve,Pt))return 0;if(t(Ve.cb),Pt.ac==null||Pt.ac(Pt)){Pt.ob&&(Ve.L=0);var qt=J1[Ve.L];if(Ve.L==2?(Ve.yb=0,Ve.zb=0):(Ve.yb=Pt.v-qt>>4,Ve.zb=Pt.j-qt>>4,0>Ve.yb&&(Ve.yb=0),0>Ve.zb&&(Ve.zb=0)),Ve.Va=Pt.o+15+qt>>4,Ve.Hb=Pt.va+15+qt>>4,Ve.Hb>Ve.za&&(Ve.Hb=Ve.za),Ve.Va>Ve.Ub&&(Ve.Va=Ve.Ub),0<Ve.L){var Ar=Ve.ed;for(qt=0;4>qt;++qt){var Jt;if(Ve.Qa.Cb){var Tr=Ve.Qa.Lb[qt];Ve.Qa.Fb||(Tr+=Ar.Tb)}else Tr=Ar.Tb;for(Jt=0;1>=Jt;++Jt){var Dr=Ve.gd[qt][Jt],Xr=Tr;if(Ar.Pc&&(Xr+=Ar.vd[0],Jt&&(Xr+=Ar.od[0])),0<(Xr=0>Xr?0:63<Xr?63:Xr)){var Ur=Xr;0<Ar.wb&&(Ur=4<Ar.wb?Ur>>2:Ur>>1)>9-Ar.wb&&(Ur=9-Ar.wb),1>Ur&&(Ur=1),Dr.dd=Ur,Dr.tc=2*Xr+Ur,Dr.ld=40<=Xr?2:15<=Xr?1:0}else Dr.tc=0;Dr.La=Jt}}}qt=0}else mn(Ve,6,"Frame setup failed"),qt=Ve.a;if(qt=qt==0){if(qt){Ve.$c=0,0<Ve.Aa||(Ve.Ic=Wse);t:{qt=Ve.Ic,Ar=4*(Ur=Ve.za);var Gn=32*Ur,Mn=Ur+1,Na=0<Ve.L?Ur*(0<Ve.Aa?2:1):0,zn=(Ve.Aa==2?2:1)*Ur;if((Dr=Ar+832+(Jt=3*(16*qt+J1[Ve.L])/2*Gn)+(Tr=Ve.Fa!=null&&0<Ve.Fa.length?Ve.Kc.c*Ve.Kc.i:0))!=Dr)qt=0;else{if(Dr>Ve.Vb){if(Ve.Vb=0,Ve.Ec=s(Dr),Ve.Fc=0,Ve.Ec==null){qt=mn(Ve,1,"no memory during frame initialization.");break t}Ve.Vb=Dr}Dr=Ve.Ec,Xr=Ve.Fc,Ve.Ac=Dr,Ve.Bc=Xr,Xr+=Ar,Ve.Gd=i(Gn,Br),Ve.Hd=0,Ve.rb=i(Mn+1,_r),Ve.sb=1,Ve.wa=Na?i(Na,jt):null,Ve.Y=0,Ve.D.Nb=0,Ve.D.wa=Ve.wa,Ve.D.Y=Ve.Y,0<Ve.Aa&&(Ve.D.Y+=Ur),t(!0),Ve.oc=Dr,Ve.pc=Xr,Xr+=832,Ve.ya=i(zn,Wt),Ve.aa=0,Ve.D.ya=Ve.ya,Ve.D.aa=Ve.aa,Ve.Aa==2&&(Ve.D.aa+=Ur),Ve.R=16*Ur,Ve.B=8*Ur,Ur=(Gn=J1[Ve.L])*Ve.R,Gn=Gn/2*Ve.B,Ve.sa=Dr,Ve.ta=Xr+Ur,Ve.qa=Ve.sa,Ve.ra=Ve.ta+16*qt*Ve.R+Gn,Ve.Ha=Ve.qa,Ve.Ia=Ve.ra+8*qt*Ve.B+Gn,Ve.$c=0,Xr+=Jt,Ve.mb=Tr?Dr:null,Ve.nb=Tr?Xr:null,t(Xr+Tr<=Ve.Fc+Ve.Vb),Te(Ve),o(Ve.Ac,Ve.Bc,0,Ar),qt=1}}if(qt){if(Pt.ka=0,Pt.y=Ve.sa,Pt.O=Ve.ta,Pt.f=Ve.qa,Pt.N=Ve.ra,Pt.ea=Ve.Ha,Pt.Vd=Ve.Ia,Pt.fa=Ve.R,Pt.Rc=Ve.B,Pt.F=null,Pt.J=0,!vt){for(qt=-255;255>=qt;++qt)ve[255+qt]=0>qt?-qt:qt;for(qt=-1020;1020>=qt;++qt)We[1020+qt]=-128>qt?-128:127<qt?127:qt;for(qt=-112;112>=qt;++qt)Xe[112+qt]=-16>qt?-16:15<qt?15:qt;for(qt=-255;510>=qt;++qt)xt[255+qt]=0>qt?0:255<qt?255:qt;vt=1}Wc=lt,Cl=G,tc=L,Ua=Re,Za=rt,Pl=X,Lo=ar,bo=Gt,Yo=S,ei=K,Td=Ut,Tg=Ot,rc=ne,R0=Ce,W1=Fs,H1=pi,G1=af,K1=Ji,Dd[0]=va,Dd[1]=Fe,Dd[2]=ga,Dd[3]=Ma,Dd[4]=$a,Dd[5]=ao,Dd[6]=ss,Dd[7]=xo,Dd[8]=mi,Dd[9]=Ss,im[0]=In,im[1]=Sr,im[2]=kr,im[3]=pr,im[4]=Xn,im[5]=En,im[6]=dn,sf[0]=Oi,sf[1]=It,sf[2]=kd,sf[3]=hi,sf[4]=rf,sf[5]=Nl,sf[6]=Zl,qt=1}else qt=0}qt&&(qt=function(Ba,$s){for(Ba.M=0;Ba.M<Ba.Va;++Ba.M){var Sa,Un=Ba.Jc[Ba.M&Ba.Xb],gn=Ba.m,vs=Ba;for(Sa=0;Sa<vs.za;++Sa){var ja=gn,Va=vs,Fo=Va.Ac,yi=Va.Bc+4*Sa,Zi=Va.zc,ls=Va.ya[Va.aa+Sa];if(Va.Qa.Bb?ls.$b=se(ja,Va.Pa.jb[0])?2+se(ja,Va.Pa.jb[2]):se(ja,Va.Pa.jb[1]):ls.$b=0,Va.kc&&(ls.Ad=se(ja,Va.Bd)),ls.Za=!se(ja,145)+0,ls.Za){var Ri=ls.Ob,el=0;for(Va=0;4>Va;++Va){var Bs,Ka=Zi[0+Va];for(Bs=0;4>Bs;++Bs){Ka=kse[Fo[yi+Bs]][Ka];for(var so=zR[se(ja,Ka[0])];0<so;)so=zR[2*so+se(ja,Ka[so])];Ka=-so,Fo[yi+Bs]=Ka}n(Ri,el,Fo,yi,4),el+=4,Zi[0+Va]=Ka}}else Ka=se(ja,156)?se(ja,128)?1:3:se(ja,163)?2:0,ls.Ob[0]=Ka,o(Fo,yi,Ka,4),o(Zi,0,Ka,4);ls.Dd=se(ja,142)?se(ja,114)?se(ja,183)?1:3:2:0}if(vs.m.Ka)return mn(Ba,7,"Premature end-of-partition0 encountered.");for(;Ba.ja<Ba.za;++Ba.ja){if(vs=Un,ja=(gn=Ba).rb[gn.sb-1],Fo=gn.rb[gn.sb+gn.ja],Sa=gn.ya[gn.aa+gn.ja],yi=gn.kc?Sa.Ad:0)ja.la=Fo.la=0,Sa.Za||(ja.Na=Fo.Na=0),Sa.Hc=0,Sa.Gc=0,Sa.ia=0;else{var cs,io;if(ja=Fo,Fo=vs,yi=gn.Pa.Xc,Zi=gn.ya[gn.aa+gn.ja],ls=gn.pb[Zi.$b],Va=Zi.ad,Ri=0,el=gn.rb[gn.sb-1],Ka=Bs=0,o(Va,Ri,0,384),Zi.Za)var bi=0,Md=yi[3];else{so=s(16);var xs=ja.Na+el.Na;if(xs=Al(Fo,yi[1],xs,ls.Eb,0,so,0),ja.Na=el.Na=(0<xs)+0,1<xs)Wc(so,0,Va,Ri);else{var El=so[0]+3>>3;for(so=0;256>so;so+=16)Va[Ri+so]=El}bi=1,Md=yi[0]}var jo=15&ja.la,qs=15&el.la;for(so=0;4>so;++so){var nc=1&qs;for(El=io=0;4>El;++El)jo=jo>>1|(nc=(xs=Al(Fo,Md,xs=nc+(1&jo),ls.Sc,bi,Va,Ri))>bi)<<7,io=io<<2|(3<xs?3:1<xs?2:Va[Ri+0]!=0),Ri+=16;jo>>=4,qs=qs>>1|nc<<7,Bs=(Bs<<8|io)>>>0}for(Md=jo,bi=qs>>4,cs=0;4>cs;cs+=2){for(io=0,jo=ja.la>>4+cs,qs=el.la>>4+cs,so=0;2>so;++so){for(nc=1&qs,El=0;2>El;++El)xs=nc+(1&jo),jo=jo>>1|(nc=0<(xs=Al(Fo,yi[2],xs,ls.Qc,0,Va,Ri)))<<3,io=io<<2|(3<xs?3:1<xs?2:Va[Ri+0]!=0),Ri+=16;jo>>=2,qs=qs>>1|nc<<5}Ka|=io<<4*cs,Md|=jo<<4<<cs,bi|=(240&qs)<<cs}ja.la=Md,el.la=bi,Zi.Hc=Bs,Zi.Gc=Ka,Zi.ia=43690&Ka?0:ls.ia,yi=!(Bs|Ka)}if(0<gn.L&&(gn.wa[gn.Y+gn.ja]=gn.gd[Sa.$b][Sa.Za],gn.wa[gn.Y+gn.ja].La|=!yi),vs.Ka)return mn(Ba,7,"Premature end-of-file encountered.")}if(Te(Ba),gn=$s,vs=1,Sa=(Un=Ba).D,ja=0<Un.L&&Un.M>=Un.zb&&Un.M<=Un.Va,Un.Aa==0)t:{if(Sa.M=Un.M,Sa.uc=ja,gr(Un,Sa),vs=1,Sa=(io=Un.D).Nb,ja=(Ka=J1[Un.L])*Un.R,Fo=Ka/2*Un.B,so=16*Sa*Un.R,El=8*Sa*Un.B,yi=Un.sa,Zi=Un.ta-ja+so,ls=Un.qa,Va=Un.ra-Fo+El,Ri=Un.Ha,el=Un.Ia-Fo+El,qs=(jo=io.M)==0,Bs=jo>=Un.Va-1,Un.Aa==2&&gr(Un,io),io.uc)for(nc=(xs=Un).D.M,t(xs.D.uc),io=xs.yb;io<xs.Hb;++io){bi=io,Md=nc;var tl=(ac=(wi=xs).D).Nb;cs=wi.R;var ac=ac.wa[ac.Y+bi],oc=wi.sa,kl=wi.ta+16*tl*cs+16*bi,sc=ac.dd,Po=ac.tc;if(Po!=0)if(t(3<=Po),wi.L==1)0<bi&&H1(oc,kl,cs,Po+4),ac.La&&K1(oc,kl,cs,Po),0<Md&&W1(oc,kl,cs,Po+4),ac.La&&G1(oc,kl,cs,Po);else{var ic=wi.B,Rd=wi.qa,Hh=wi.ra+8*tl*ic+8*bi,lf=wi.Ha,wi=wi.Ia+8*tl*ic+8*bi;tl=ac.ld,0<bi&&(bo(oc,kl,cs,Po+4,sc,tl),ei(Rd,Hh,lf,wi,ic,Po+4,sc,tl)),ac.La&&(Tg(oc,kl,cs,Po,sc,tl),R0(Rd,Hh,lf,wi,ic,Po,sc,tl)),0<Md&&(Lo(oc,kl,cs,Po+4,sc,tl),Yo(Rd,Hh,lf,wi,ic,Po+4,sc,tl)),ac.La&&(Td(oc,kl,cs,Po,sc,tl),rc(Rd,Hh,lf,wi,ic,Po,sc,tl))}}if(Un.ia&&alert("todo:DitherRow"),gn.put!=null){if(io=16*jo,jo=16*(jo+1),qs?(gn.y=Un.sa,gn.O=Un.ta+so,gn.f=Un.qa,gn.N=Un.ra+El,gn.ea=Un.Ha,gn.W=Un.Ia+El):(io-=Ka,gn.y=yi,gn.O=Zi,gn.f=ls,gn.N=Va,gn.ea=Ri,gn.W=el),Bs||(jo-=Ka),jo>gn.o&&(jo=gn.o),gn.F=null,gn.J=null,Un.Fa!=null&&0<Un.Fa.length&&io<jo&&(gn.J=Ct(Un,gn,io,jo-io),gn.F=Un.mb,gn.F==null&&gn.F.length==0)){vs=mn(Un,3,"Could not decode alpha data.");break t}io<gn.j&&(Ka=gn.j-io,io=gn.j,t(!(1&Ka)),gn.O+=Un.R*Ka,gn.N+=Un.B*(Ka>>1),gn.W+=Un.B*(Ka>>1),gn.F!=null&&(gn.J+=gn.width*Ka)),io<jo&&(gn.O+=gn.v,gn.N+=gn.v>>1,gn.W+=gn.v>>1,gn.F!=null&&(gn.J+=gn.v),gn.ka=io-gn.j,gn.U=gn.va-gn.v,gn.T=jo-io,vs=gn.put(gn))}Sa+1!=Un.Ic||Bs||(n(Un.sa,Un.ta-ja,yi,Zi+16*Un.R,ja),n(Un.qa,Un.ra-Fo,ls,Va+8*Un.B,Fo),n(Un.Ha,Un.Ia-Fo,Ri,el+8*Un.B,Fo))}if(!vs)return mn(Ba,6,"Output aborted.")}return 1}(Ve,Pt)),Pt.bc!=null&&Pt.bc(Pt),qt&=1}return qt?(Ve.cb=0,qt):0})(N,Y)||(k=N.a)}}else k=N.a}k==0&&je.Oa!=null&&je.Oa.fd&&(k=$r(je.ba))}je=k}xe=je!=0?null:11>xe?Ae.f.RGBA.eb:Ae.f.kb.y}else xe=null;return xe};var JR=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(P,F){for(var M="",I=0;I<4;I++)M+=String.fromCharCode(P[F++]);return M}function u(P,F){return P[F+0]|P[F+1]<<8}function f(P,F){return(P[F+0]|P[F+1]<<8|P[F+2]<<16)>>>0}function h(P,F){return(P[F+0]|P[F+1]<<8|P[F+2]<<16|P[F+3]<<24)>>>0}new c;var m=[0],v=[0],g=[],y=new c,x=e,b=function(P,F){var M={},I=0,R=!1,D=0,U=0;if(M.frames=[],!function(V,B){for(var J=0;J<4;J++)if(V[B+J]!="RIFF".charCodeAt(J))return!0;return!1}(P,F)){for(h(P,F+=4),F+=8;F<P.length;){var z=d(P,F),H=h(P,F+=4);F+=4;var q=H+(1&H);switch(z){case"VP8 ":case"VP8L":M.frames[I]===void 0&&(M.frames[I]={}),(be=M.frames[I]).src_off=R?U:F-8,be.src_size=D+H+8,I++,R&&(R=!1,D=0,U=0);break;case"VP8X":(be=M.header={}).feature_flags=P[F];var Q=F+4;be.canvas_width=1+f(P,Q),Q+=3,be.canvas_height=1+f(P,Q),Q+=3;break;case"ALPH":R=!0,D=q+8,U=F-8;break;case"ANIM":(be=M.header).bgcolor=h(P,F),Q=F+4,be.loop_count=u(P,Q),Q+=2;break;case"ANMF":var pe,be;(be=M.frames[I]={}).offset_x=2*f(P,F),F+=3,be.offset_y=2*f(P,F),F+=3,be.width=1+f(P,F),F+=3,be.height=1+f(P,F),F+=3,be.duration=f(P,F),F+=3,pe=P[F++],be.dispose=1&pe,be.blend=pe>>1&1}z!="ANMF"&&(F+=q)}return M}}(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var w=b.header?b.header:null,j=b.frames?b.frames:null;if(w){w.loop_counter=w.loop_count,m=[w.canvas_height],v=[w.canvas_width];for(var _=0;_<j.length&&j[_].blend!=0;_++);}var C=j[0],E=y.WebPDecodeRGBA(x,C.src_off,C.src_size,v,m);C.rgba=E,C.imgwidth=v[0],C.imgheight=m[0];for(var A=0;A<v[0]*m[0]*4;A++)g[A]=E[A];return this.width=v,this.height=m,this.data=g,this}(function(e){var t,r,n,o,s,i,l,c,d,u=function(V){return V=V||{},this.isStrokeTransparent=V.isStrokeTransparent||!1,this.strokeOpacity=V.strokeOpacity||1,this.strokeStyle=V.strokeStyle||"#000000",this.fillStyle=V.fillStyle||"#000000",this.isFillTransparent=V.isFillTransparent||!1,this.fillOpacity=V.fillOpacity||1,this.font=V.font||"10px sans-serif",this.textBaseline=V.textBaseline||"alphabetic",this.textAlign=V.textAlign||"left",this.lineWidth=V.lineWidth||1,this.lineJoin=V.lineJoin||"miter",this.lineCap=V.lineCap||"butt",this.path=V.path||[],this.transform=V.transform!==void 0?V.transform.clone():new c,this.globalCompositeOperation=V.globalCompositeOperation||"normal",this.globalAlpha=V.globalAlpha||1,this.clip_path=V.clip_path||[],this.currentPoint=V.currentPoint||new i,this.miterLimit=V.miterLimit||10,this.lastPoint=V.lastPoint||new i,this.lineDashOffset=V.lineDashOffset||0,this.lineDash=V.lineDash||[],this.margin=V.margin||[0,0,0,0],this.prevPageLastElemOffset=V.prevPageLastElemOffset||0,this.ignoreClearRect=typeof V.ignoreClearRect!="boolean"||V.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,o=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,i=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var f=function(V){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var B=V;Object.defineProperty(this,"pdf",{get:function(){return B}});var J=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return J},set:function(ae){J=!!ae}});var ue=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ue},set:function(ae){ue=!!ae}});var Ne=0;Object.defineProperty(this,"posX",{get:function(){return Ne},set:function(ae){isNaN(ae)||(Ne=ae)}});var Z=0;Object.defineProperty(this,"posY",{get:function(){return Z},set:function(ae){isNaN(ae)||(Z=ae)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(ae){var ie;typeof ae=="number"?ie=[ae,ae,ae,ae]:((ie=new Array(4))[0]=ae[0],ie[1]=ae.length>=2?ae[1]:ie[0],ie[2]=ae.length>=3?ae[2]:ie[0],ie[3]=ae.length>=4?ae[3]:ie[1]),d.margin=ie}});var ge=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ge},set:function(ae){ge=ae}});var le=0;Object.defineProperty(this,"lastBreak",{get:function(){return le},set:function(ae){le=ae}});var se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return se},set:function(ae){se=ae}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(ae){ae instanceof u&&(d=ae)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(ae){d.path=ae}});var ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return ee},set:function(ae){ee=ae}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ae){var ie;ie=h(ae),this.ctx.fillStyle=ie.style,this.ctx.isFillTransparent=ie.a===0,this.ctx.fillOpacity=ie.a,this.pdf.setFillColor(ie.r,ie.g,ie.b,{a:ie.a}),this.pdf.setTextColor(ie.r,ie.g,ie.b,{a:ie.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ae){var ie=h(ae);this.ctx.strokeStyle=ie.style,this.ctx.isStrokeTransparent=ie.a===0,this.ctx.strokeOpacity=ie.a,ie.a===0?this.pdf.setDrawColor(255,255,255):(ie.a,this.pdf.setDrawColor(ie.r,ie.g,ie.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ae){["butt","round","square"].indexOf(ae)!==-1&&(this.ctx.lineCap=ae,this.pdf.setLineCap(ae))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ae){isNaN(ae)||(this.ctx.lineWidth=ae,this.pdf.setLineWidth(ae))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ae){["bevel","round","miter"].indexOf(ae)!==-1&&(this.ctx.lineJoin=ae,this.pdf.setLineJoin(ae))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ae){isNaN(ae)||(this.ctx.miterLimit=ae,this.pdf.setMiterLimit(ae))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ae){this.ctx.textBaseline=ae}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ae){["right","end","center","left","start"].indexOf(ae)!==-1&&(this.ctx.textAlign=ae)}});var de=null,Le=null;Object.defineProperty(this,"fontFaces",{get:function(){return Le},set:function(ae){de=null,Le=ae}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ae){var ie;if(this.ctx.font=ae,(ie=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ae))!==null){var dt=ie[1];ie[2];var At=ie[3],st=ie[4];ie[5];var ut=ie[6],Rt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(st)[2];st=Math.floor(Rt==="px"?parseFloat(st)*this.pdf.internal.scaleFactor:Rt==="em"?parseFloat(st)*this.pdf.getFontSize():parseFloat(st)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(st);var Nt=function(He){var ht,zt,hr=[],Mt=He.trim();if(Mt==="")return AE;if(Mt in _9)return[_9[Mt]];for(;Mt!=="";){switch(zt=null,ht=(Mt=S9(Mt)).charAt(0)){case'"':case"'":zt=kQe(Mt.substring(1),ht);break;default:zt=IQe(Mt)}if(zt===null||(hr.push(zt[0]),(Mt=S9(zt[1]))!==""&&Mt.charAt(0)!==","))return AE;Mt=Mt.replace(/^,/,"")}return hr}(ut);if(this.fontFaces){var tt=function(He,ht){if(de===null){var zt=function(hr){var Mt=[];return Object.keys(hr).forEach(function(Qt){hr[Qt].forEach(function(Se){var kt=null;switch(Se){case"bold":kt={family:Qt,weight:"bold"};break;case"italic":kt={family:Qt,style:"italic"};break;case"bolditalic":kt={family:Qt,weight:"bold",style:"italic"};break;case"":case"normal":kt={family:Qt}}kt!==null&&(kt.ref={name:Qt,style:Se},Mt.push(kt))})}),Mt}(He.getFontList());de=function(hr){for(var Mt={},Qt=0;Qt<hr.length;++Qt){var Se=PE(hr[Qt]),kt=Se.family,Lt=Se.stretch,fr=Se.style,yr=Se.weight;Mt[kt]=Mt[kt]||{},Mt[kt][Lt]=Mt[kt][Lt]||{},Mt[kt][Lt][fr]=Mt[kt][Lt][fr]||{},Mt[kt][Lt][fr][yr]=Se}return Mt}(zt.concat(ht))}return de}(this.pdf,this.fontFaces),he=Nt.map(function(He){return{family:He,stretch:"normal",weight:At,style:dt}}),ke=function(He,ht,zt){for(var hr=(zt=zt||{}).defaultFontFamily||"times",Mt=Object.assign({},EQe,zt.genericFontFamilies||{}),Qt=null,Se=null,kt=0;kt<ht.length;++kt)if(Mt[(Qt=PE(ht[kt])).family]&&(Qt.family=Mt[Qt.family]),He.hasOwnProperty(Qt.family)){Se=He[Qt.family];break}if(!(Se=Se||He[hr]))throw new Error("Could not find a font-family for the rule '"+N9(Qt)+"' and default family '"+hr+"'.");if(Se=function(Lt,fr){if(fr[Lt])return fr[Lt];var yr=qT[Lt],Xt=yr<=qT.normal?-1:1,nr=j9(fr,aae,yr,Xt);if(!nr)throw new Error("Could not find a matching font-stretch value for "+Lt);return nr}(Qt.stretch,Se),Se=function(Lt,fr){if(fr[Lt])return fr[Lt];for(var yr=nae[Lt],Xt=0;Xt<yr.length;++Xt)if(fr[yr[Xt]])return fr[yr[Xt]];throw new Error("Could not find a matching font-style for "+Lt)}(Qt.style,Se),!(Se=function(Lt,fr){if(fr[Lt])return fr[Lt];if(Lt===400&&fr[500])return fr[500];if(Lt===500&&fr[400])return fr[400];var yr=AQe[Lt],Xt=j9(fr,oae,yr,Lt<400?-1:1);if(!Xt)throw new Error("Could not find a matching font-weight for value "+Lt);return Xt}(Qt.weight,Se)))throw new Error("Failed to resolve a font for the rule '"+N9(Qt)+"'.");return Se}(tt,he);this.pdf.setFont(ke.ref.name,ke.ref.style)}else{var et="";(At==="bold"||parseInt(At,10)>=700||dt==="bold")&&(et="bold"),dt==="italic"&&(et+="italic"),et.length===0&&(et="normal");for(var Me="",$e={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Be=0;Be<Nt.length;Be++){if(this.pdf.internal.getFont(Nt[Be],et,{noFallback:!0,disableWarning:!0})!==void 0){Me=Nt[Be];break}if(et==="bolditalic"&&this.pdf.internal.getFont(Nt[Be],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Me=Nt[Be],et="bold";else if(this.pdf.internal.getFont(Nt[Be],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Me=Nt[Be],et="normal";break}}if(Me===""){for(var we=0;we<Nt.length;we++)if($e[Nt[we]]){Me=$e[Nt[we]];break}}Me=Me===""?"Times":Me,this.pdf.setFont(Me,et)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ae){this.ctx.globalCompositeOperation=ae}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ae){this.ctx.globalAlpha=ae}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ae){this.ctx.lineDashOffset=ae,be.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ae){this.ctx.lineDash=ae,be.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ae){this.ctx.ignoreClearRect=!!ae}})};f.prototype.setLineDash=function(V){this.lineDash=V},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){j.call(this,"fill",!1)},f.prototype.stroke=function(){j.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(V,B){if(isNaN(V)||isNaN(B))throw _o.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var J=this.ctx.transform.applyToPoint(new i(V,B));this.path.push({type:"mt",x:J.x,y:J.y}),this.ctx.lastPoint=new i(V,B)},f.prototype.closePath=function(){var V=new i(0,0),B=0;for(B=this.path.length-1;B!==-1;B--)if(this.path[B].type==="begin"&&Fa(this.path[B+1])==="object"&&typeof this.path[B+1].x=="number"){V=new i(this.path[B+1].x,this.path[B+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(V.x,V.y)},f.prototype.lineTo=function(V,B){if(isNaN(V)||isNaN(B))throw _o.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var J=this.ctx.transform.applyToPoint(new i(V,B));this.path.push({type:"lt",x:J.x,y:J.y}),this.ctx.lastPoint=new i(J.x,J.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},f.prototype.quadraticCurveTo=function(V,B,J,ue){if(isNaN(J)||isNaN(ue)||isNaN(V)||isNaN(B))throw _o.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ne=this.ctx.transform.applyToPoint(new i(J,ue)),Z=this.ctx.transform.applyToPoint(new i(V,B));this.path.push({type:"qct",x1:Z.x,y1:Z.y,x:Ne.x,y:Ne.y}),this.ctx.lastPoint=new i(Ne.x,Ne.y)},f.prototype.bezierCurveTo=function(V,B,J,ue,Ne,Z){if(isNaN(Ne)||isNaN(Z)||isNaN(V)||isNaN(B)||isNaN(J)||isNaN(ue))throw _o.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ge=this.ctx.transform.applyToPoint(new i(Ne,Z)),le=this.ctx.transform.applyToPoint(new i(V,B)),se=this.ctx.transform.applyToPoint(new i(J,ue));this.path.push({type:"bct",x1:le.x,y1:le.y,x2:se.x,y2:se.y,x:ge.x,y:ge.y}),this.ctx.lastPoint=new i(ge.x,ge.y)},f.prototype.arc=function(V,B,J,ue,Ne,Z){if(isNaN(V)||isNaN(B)||isNaN(J)||isNaN(ue)||isNaN(Ne))throw _o.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Z=!!Z,!this.ctx.transform.isIdentity){var ge=this.ctx.transform.applyToPoint(new i(V,B));V=ge.x,B=ge.y;var le=this.ctx.transform.applyToPoint(new i(0,J)),se=this.ctx.transform.applyToPoint(new i(0,0));J=Math.sqrt(Math.pow(le.x-se.x,2)+Math.pow(le.y-se.y,2))}Math.abs(Ne-ue)>=2*Math.PI&&(ue=0,Ne=2*Math.PI),this.path.push({type:"arc",x:V,y:B,radius:J,startAngle:ue,endAngle:Ne,counterclockwise:Z})},f.prototype.arcTo=function(V,B,J,ue,Ne){throw new Error("arcTo not implemented.")},f.prototype.rect=function(V,B,J,ue){if(isNaN(V)||isNaN(B)||isNaN(J)||isNaN(ue))throw _o.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(V,B),this.lineTo(V+J,B),this.lineTo(V+J,B+ue),this.lineTo(V,B+ue),this.lineTo(V,B),this.lineTo(V+J,B),this.lineTo(V,B)},f.prototype.fillRect=function(V,B,J,ue){if(isNaN(V)||isNaN(B)||isNaN(J)||isNaN(ue))throw _o.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var Ne={};this.lineCap!=="butt"&&(Ne.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ne.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(V,B,J,ue),this.fill(),Ne.hasOwnProperty("lineCap")&&(this.lineCap=Ne.lineCap),Ne.hasOwnProperty("lineJoin")&&(this.lineJoin=Ne.lineJoin)}},f.prototype.strokeRect=function(V,B,J,ue){if(isNaN(V)||isNaN(B)||isNaN(J)||isNaN(ue))throw _o.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(V,B,J,ue),this.stroke())},f.prototype.clearRect=function(V,B,J,ue){if(isNaN(V)||isNaN(B)||isNaN(J)||isNaN(ue))throw _o.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(V,B,J,ue))},f.prototype.save=function(V){V=typeof V!="boolean"||V;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,J=0;J<this.pdf.internal.getNumberOfPages();J++)this.pdf.setPage(J+1),this.pdf.internal.out("q");if(this.pdf.setPage(B),V){this.ctx.fontSize=this.pdf.internal.getFontSize();var ue=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ue}},f.prototype.restore=function(V){V=typeof V!="boolean"||V;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,J=0;J<this.pdf.internal.getNumberOfPages();J++)this.pdf.setPage(J+1),this.pdf.internal.out("Q");this.pdf.setPage(B),V&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(V){var B,J,ue,Ne;if(V.isCanvasGradient===!0&&(V=V.getColor()),!V)return{r:0,g:0,b:0,a:0,style:V};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(V))B=0,J=0,ue=0,Ne=0;else{var Z=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(V);if(Z!==null)B=parseInt(Z[1]),J=parseInt(Z[2]),ue=parseInt(Z[3]),Ne=1;else if((Z=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(V))!==null)B=parseInt(Z[1]),J=parseInt(Z[2]),ue=parseInt(Z[3]),Ne=parseFloat(Z[4]);else{if(Ne=1,typeof V=="string"&&V.charAt(0)!=="#"){var ge=new Yne(V);V=ge.ok?ge.toHex():"#000000"}V.length===4?(B=V.substring(1,2),B+=B,J=V.substring(2,3),J+=J,ue=V.substring(3,4),ue+=ue):(B=V.substring(1,3),J=V.substring(3,5),ue=V.substring(5,7)),B=parseInt(B,16),J=parseInt(J,16),ue=parseInt(ue,16)}}return{r:B,g:J,b:ue,a:Ne,style:V}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(V,B,J,ue){if(isNaN(B)||isNaN(J)||typeof V!="string")throw _o.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ue=isNaN(ue)?void 0:ue,!m.call(this)){var Ne=q(this.ctx.transform.rotation),Z=this.ctx.transform.scaleX;I.call(this,{text:V,x:B,y:J,scale:Z,angle:Ne,align:this.textAlign,maxWidth:ue})}},f.prototype.strokeText=function(V,B,J,ue){if(isNaN(B)||isNaN(J)||typeof V!="string")throw _o.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){ue=isNaN(ue)?void 0:ue;var Ne=q(this.ctx.transform.rotation),Z=this.ctx.transform.scaleX;I.call(this,{text:V,x:B,y:J,scale:Z,renderingMode:"stroke",angle:Ne,align:this.textAlign,maxWidth:ue})}},f.prototype.measureText=function(V){if(typeof V!="string")throw _o.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var B=this.pdf,J=this.pdf.internal.scaleFactor,ue=B.internal.getFontSize(),Ne=B.getStringUnitWidth(V)*ue/B.internal.scaleFactor;return new function(Z){var ge=(Z=Z||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ge}}),this}({width:Ne*=Math.round(96*J/72*1e4)/1e4})},f.prototype.scale=function(V,B){if(isNaN(V)||isNaN(B))throw _o.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var J=new c(V,0,0,B,0,0);this.ctx.transform=this.ctx.transform.multiply(J)},f.prototype.rotate=function(V){if(isNaN(V))throw _o.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var B=new c(Math.cos(V),Math.sin(V),-Math.sin(V),Math.cos(V),0,0);this.ctx.transform=this.ctx.transform.multiply(B)},f.prototype.translate=function(V,B){if(isNaN(V)||isNaN(B))throw _o.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var J=new c(1,0,0,1,V,B);this.ctx.transform=this.ctx.transform.multiply(J)},f.prototype.transform=function(V,B,J,ue,Ne,Z){if(isNaN(V)||isNaN(B)||isNaN(J)||isNaN(ue)||isNaN(Ne)||isNaN(Z))throw _o.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ge=new c(V,B,J,ue,Ne,Z);this.ctx.transform=this.ctx.transform.multiply(ge)},f.prototype.setTransform=function(V,B,J,ue,Ne,Z){V=isNaN(V)?1:V,B=isNaN(B)?0:B,J=isNaN(J)?0:J,ue=isNaN(ue)?1:ue,Ne=isNaN(Ne)?0:Ne,Z=isNaN(Z)?0:Z,this.ctx.transform=new c(V,B,J,ue,Ne,Z)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(V,B,J,ue,Ne,Z,ge,le,se){var ee=this.pdf.getImageProperties(V),de=1,Le=1,ae=1,ie=1;ue!==void 0&&le!==void 0&&(ae=le/ue,ie=se/Ne,de=ee.width/ue*le/ue,Le=ee.height/Ne*se/Ne),Z===void 0&&(Z=B,ge=J,B=0,J=0),ue!==void 0&&le===void 0&&(le=ue,se=Ne),ue===void 0&&le===void 0&&(le=ee.width,se=ee.height);for(var dt,At=this.ctx.transform.decompose(),st=q(At.rotate.shx),ut=new c,Rt=(ut=(ut=(ut=ut.multiply(At.translate)).multiply(At.skew)).multiply(At.scale)).applyToRectangle(new l(Z-B*ae,ge-J*ie,ue*de,Ne*Le)),Nt=y.call(this,Rt),tt=[],he=0;he<Nt.length;he+=1)tt.indexOf(Nt[he])===-1&&tt.push(Nt[he]);if(w(tt),this.autoPaging)for(var ke=tt[0],et=tt[tt.length-1],Me=ke;Me<et+1;Me++){this.pdf.setPage(Me);var $e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Be=Me===1?this.posY+this.margin[0]:this.margin[0],we=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],He=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ht=Me===1?0:we+(Me-2)*He;if(this.ctx.clip_path.length!==0){var zt=this.path;dt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(dt,this.posX+this.margin[3],-ht+Be+this.ctx.prevPageLastElemOffset),_.call(this,"fill",!0),this.path=zt}var hr=JSON.parse(JSON.stringify(Rt));hr=b([hr],this.posX+this.margin[3],-ht+Be+this.ctx.prevPageLastElemOffset)[0];var Mt=(Me>ke||Me<et)&&g.call(this);Mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$e,He,null).clip().discardPath()),this.pdf.addImage(V,"JPEG",hr.x,hr.y,hr.w,hr.h,null,null,st),Mt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(V,"JPEG",Rt.x,Rt.y,Rt.w,Rt.h,null,null,st)};var y=function(V,B,J){var ue=[];B=B||this.pdf.internal.pageSize.width,J=J||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ne=this.posY+this.ctx.prevPageLastElemOffset;switch(V.type){default:case"mt":case"lt":ue.push(Math.floor((V.y+Ne)/J)+1);break;case"arc":ue.push(Math.floor((V.y+Ne-V.radius)/J)+1),ue.push(Math.floor((V.y+Ne+V.radius)/J)+1);break;case"qct":var Z=Q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,V.x1,V.y1,V.x,V.y);ue.push(Math.floor((Z.y+Ne)/J)+1),ue.push(Math.floor((Z.y+Z.h+Ne)/J)+1);break;case"bct":var ge=pe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,V.x1,V.y1,V.x2,V.y2,V.x,V.y);ue.push(Math.floor((ge.y+Ne)/J)+1),ue.push(Math.floor((ge.y+ge.h+Ne)/J)+1);break;case"rect":ue.push(Math.floor((V.y+Ne)/J)+1),ue.push(Math.floor((V.y+V.h+Ne)/J)+1)}for(var le=0;le<ue.length;le+=1)for(;this.pdf.internal.getNumberOfPages()<ue[le];)x.call(this);return ue},x=function(){var V=this.fillStyle,B=this.strokeStyle,J=this.font,ue=this.lineCap,Ne=this.lineWidth,Z=this.lineJoin;this.pdf.addPage(),this.fillStyle=V,this.strokeStyle=B,this.font=J,this.lineCap=ue,this.lineWidth=Ne,this.lineJoin=Z},b=function(V,B,J){for(var ue=0;ue<V.length;ue++)switch(V[ue].type){case"bct":V[ue].x2+=B,V[ue].y2+=J;case"qct":V[ue].x1+=B,V[ue].y1+=J;default:V[ue].x+=B,V[ue].y+=J}return V},w=function(V){return V.sort(function(B,J){return B-J})},j=function(V,B){for(var J,ue,Ne=this.fillStyle,Z=this.strokeStyle,ge=this.lineCap,le=this.lineWidth,se=Math.abs(le*this.ctx.transform.scaleX),ee=this.lineJoin,de=JSON.parse(JSON.stringify(this.path)),Le=JSON.parse(JSON.stringify(this.path)),ae=[],ie=0;ie<Le.length;ie++)if(Le[ie].x!==void 0)for(var dt=y.call(this,Le[ie]),At=0;At<dt.length;At+=1)ae.indexOf(dt[At])===-1&&ae.push(dt[At]);for(var st=0;st<ae.length;st++)for(;this.pdf.internal.getNumberOfPages()<ae[st];)x.call(this);if(w(ae),this.autoPaging)for(var ut=ae[0],Rt=ae[ae.length-1],Nt=ut;Nt<Rt+1;Nt++){this.pdf.setPage(Nt),this.fillStyle=Ne,this.strokeStyle=Z,this.lineCap=ge,this.lineWidth=se,this.lineJoin=ee;var tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],he=Nt===1?this.posY+this.margin[0]:this.margin[0],ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Me=Nt===1?0:ke+(Nt-2)*et;if(this.ctx.clip_path.length!==0){var $e=this.path;J=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(J,this.posX+this.margin[3],-Me+he+this.ctx.prevPageLastElemOffset),_.call(this,V,!0),this.path=$e}if(ue=JSON.parse(JSON.stringify(de)),this.path=b(ue,this.posX+this.margin[3],-Me+he+this.ctx.prevPageLastElemOffset),B===!1||Nt===0){var Be=(Nt>ut||Nt<Rt)&&g.call(this);Be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,et,null).clip().discardPath()),_.call(this,V,B),Be&&this.pdf.restoreGraphicsState()}this.lineWidth=le}else this.lineWidth=se,_.call(this,V,B),this.lineWidth=le;this.path=de},_=function(V,B){if((V!=="stroke"||B||!v.call(this))&&(V==="stroke"||B||!m.call(this))){for(var J,ue,Ne=[],Z=this.path,ge=0;ge<Z.length;ge++){var le=Z[ge];switch(le.type){case"begin":Ne.push({begin:!0});break;case"close":Ne.push({close:!0});break;case"mt":Ne.push({start:le,deltas:[],abs:[]});break;case"lt":var se=Ne.length;if(Z[ge-1]&&!isNaN(Z[ge-1].x)&&(J=[le.x-Z[ge-1].x,le.y-Z[ge-1].y],se>0)){for(;se>=0;se--)if(Ne[se-1].close!==!0&&Ne[se-1].begin!==!0){Ne[se-1].deltas.push(J),Ne[se-1].abs.push(le);break}}break;case"bct":J=[le.x1-Z[ge-1].x,le.y1-Z[ge-1].y,le.x2-Z[ge-1].x,le.y2-Z[ge-1].y,le.x-Z[ge-1].x,le.y-Z[ge-1].y],Ne[Ne.length-1].deltas.push(J);break;case"qct":var ee=Z[ge-1].x+2/3*(le.x1-Z[ge-1].x),de=Z[ge-1].y+2/3*(le.y1-Z[ge-1].y),Le=le.x+2/3*(le.x1-le.x),ae=le.y+2/3*(le.y1-le.y),ie=le.x,dt=le.y;J=[ee-Z[ge-1].x,de-Z[ge-1].y,Le-Z[ge-1].x,ae-Z[ge-1].y,ie-Z[ge-1].x,dt-Z[ge-1].y],Ne[Ne.length-1].deltas.push(J);break;case"arc":Ne.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ne[Ne.length-1].abs)&&Ne[Ne.length-1].abs.push(le)}}ue=B?null:V==="stroke"?"stroke":"fill";for(var At=!1,st=0;st<Ne.length;st++)if(Ne[st].arc)for(var ut=Ne[st].abs,Rt=0;Rt<ut.length;Rt++){var Nt=ut[Rt];Nt.type==="arc"?A.call(this,Nt.x,Nt.y,Nt.radius,Nt.startAngle,Nt.endAngle,Nt.counterclockwise,void 0,B,!At):R.call(this,Nt.x,Nt.y),At=!0}else if(Ne[st].close===!0)this.pdf.internal.out("h"),At=!1;else if(Ne[st].begin!==!0){var tt=Ne[st].start.x,he=Ne[st].start.y;D.call(this,Ne[st].deltas,tt,he),At=!0}ue&&P.call(this,ue),B&&F.call(this)}},C=function(V){var B=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,J=B*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return V-J;case"top":return V+B-J;case"hanging":return V+B-2*J;case"middle":return V+B/2-J;default:return V}},E=function(V){return V+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var V=function(){};return V.colorStops=[],V.addColorStop=function(B,J){this.colorStops.push([B,J])},V.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},V.isCanvasGradient=!0,V},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var A=function(V,B,J,ue,Ne,Z,ge,le,se){for(var ee=z.call(this,J,ue,Ne,Z),de=0;de<ee.length;de++){var Le=ee[de];de===0&&(se?M.call(this,Le.x1+V,Le.y1+B):R.call(this,Le.x1+V,Le.y1+B)),U.call(this,V,B,Le.x2,Le.y2,Le.x3,Le.y3,Le.x4,Le.y4)}le?F.call(this):P.call(this,ge)},P=function(V){switch(V){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F=function(){this.pdf.clip(),this.pdf.discardPath()},M=function(V,B){this.pdf.internal.out(r(V)+" "+n(B)+" m")},I=function(V){var B;switch(V.align){case"right":case"end":B="right";break;case"center":B="center";break;default:B="left"}var J=this.pdf.getTextDimensions(V.text),ue=C.call(this,V.y),Ne=E.call(this,ue)-J.h,Z=this.ctx.transform.applyToPoint(new i(V.x,ue)),ge=this.ctx.transform.decompose(),le=new c;le=(le=(le=le.multiply(ge.translate)).multiply(ge.skew)).multiply(ge.scale);for(var se,ee,de,Le=this.ctx.transform.applyToRectangle(new l(V.x,ue,J.w,J.h)),ae=le.applyToRectangle(new l(V.x,Ne,J.w,J.h)),ie=y.call(this,ae),dt=[],At=0;At<ie.length;At+=1)dt.indexOf(ie[At])===-1&&dt.push(ie[At]);if(w(dt),this.autoPaging)for(var st=dt[0],ut=dt[dt.length-1],Rt=st;Rt<ut+1;Rt++){this.pdf.setPage(Rt);var Nt=Rt===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],he=this.pdf.internal.pageSize.height-this.margin[2],ke=he-this.margin[0],et=this.pdf.internal.pageSize.width-this.margin[1],Me=et-this.margin[3],$e=Rt===1?0:tt+(Rt-2)*ke;if(this.ctx.clip_path.length!==0){var Be=this.path;se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(se,this.posX+this.margin[3],-1*$e+Nt),_.call(this,"fill",!0),this.path=Be}var we=b([JSON.parse(JSON.stringify(ae))],this.posX+this.margin[3],-$e+Nt+this.ctx.prevPageLastElemOffset)[0];V.scale>=.01&&(ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ee*V.scale),de=this.lineWidth,this.lineWidth=de*V.scale);var He=this.autoPaging!=="text";if(He||we.y+we.h<=he){if(He||we.y>=Nt&&we.x<=et){var ht=He?V.text:this.pdf.splitTextToSize(V.text,V.maxWidth||et-we.x)[0],zt=b([JSON.parse(JSON.stringify(Le))],this.posX+this.margin[3],-$e+Nt+this.ctx.prevPageLastElemOffset)[0],hr=He&&(Rt>st||Rt<ut)&&g.call(this);hr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Me,ke,null).clip().discardPath()),this.pdf.text(ht,zt.x,zt.y,{angle:V.angle,align:B,renderingMode:V.renderingMode}),hr&&this.pdf.restoreGraphicsState()}}else we.y<he&&(this.ctx.prevPageLastElemOffset+=he-we.y);V.scale>=.01&&(this.pdf.setFontSize(ee),this.lineWidth=de)}else V.scale>=.01&&(ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ee*V.scale),de=this.lineWidth,this.lineWidth=de*V.scale),this.pdf.text(V.text,Z.x+this.posX,Z.y+this.posY,{angle:V.angle,align:B,renderingMode:V.renderingMode,maxWidth:V.maxWidth}),V.scale>=.01&&(this.pdf.setFontSize(ee),this.lineWidth=de)},R=function(V,B,J,ue){J=J||0,ue=ue||0,this.pdf.internal.out(r(V+J)+" "+n(B+ue)+" l")},D=function(V,B,J){return this.pdf.lines(V,B,J,null,null)},U=function(V,B,J,ue,Ne,Z,ge,le){this.pdf.internal.out([t(o(J+V)),t(s(ue+B)),t(o(Ne+V)),t(s(Z+B)),t(o(ge+V)),t(s(le+B)),"c"].join(" "))},z=function(V,B,J,ue){for(var Ne=2*Math.PI,Z=Math.PI/2;B>J;)B-=Ne;var ge=Math.abs(J-B);ge<Ne&&ue&&(ge=Ne-ge);for(var le=[],se=ue?-1:1,ee=B;ge>1e-5;){var de=ee+se*Math.min(ge,Z);le.push(H.call(this,V,ee,de)),ge-=Math.abs(de-ee),ee=de}return le},H=function(V,B,J){var ue=(J-B)/2,Ne=V*Math.cos(ue),Z=V*Math.sin(ue),ge=Ne,le=-Z,se=ge*ge+le*le,ee=se+ge*Ne+le*Z,de=4/3*(Math.sqrt(2*se*ee)-ee)/(ge*Z-le*Ne),Le=ge-de*le,ae=le+de*ge,ie=Le,dt=-ae,At=ue+B,st=Math.cos(At),ut=Math.sin(At);return{x1:V*Math.cos(B),y1:V*Math.sin(B),x2:Le*st-ae*ut,y2:Le*ut+ae*st,x3:ie*st-dt*ut,y3:ie*ut+dt*st,x4:V*Math.cos(J),y4:V*Math.sin(J)}},q=function(V){return 180*V/Math.PI},Q=function(V,B,J,ue,Ne,Z){var ge=V+.5*(J-V),le=B+.5*(ue-B),se=Ne+.5*(J-Ne),ee=Z+.5*(ue-Z),de=Math.min(V,Ne,ge,se),Le=Math.max(V,Ne,ge,se),ae=Math.min(B,Z,le,ee),ie=Math.max(B,Z,le,ee);return new l(de,ae,Le-de,ie-ae)},pe=function(V,B,J,ue,Ne,Z,ge,le){var se,ee,de,Le,ae,ie,dt,At,st,ut,Rt,Nt,tt,he,ke=J-V,et=ue-B,Me=Ne-J,$e=Z-ue,Be=ge-Ne,we=le-Z;for(ee=0;ee<41;ee++)st=(dt=(de=V+(se=ee/40)*ke)+se*((ae=J+se*Me)-de))+se*(ae+se*(Ne+se*Be-ae)-dt),ut=(At=(Le=B+se*et)+se*((ie=ue+se*$e)-Le))+se*(ie+se*(Z+se*we-ie)-At),ee==0?(Rt=st,Nt=ut,tt=st,he=ut):(Rt=Math.min(Rt,st),Nt=Math.min(Nt,ut),tt=Math.max(tt,st),he=Math.max(he,ut));return new l(Math.round(Rt),Math.round(Nt),Math.round(tt-Rt),Math.round(he-Nt))},be=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var V,B,J=(V=this.ctx.lineDash,B=this.ctx.lineDashOffset,JSON.stringify({lineDash:V,lineDashOffset:B}));this.prevLineDash!==J&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=J)}}})(Vn.API),function(e){var t=function(i){var l,c,d,u,f,h,m,v,g,y;for(c=[],d=0,u=(i+=l="\0\0\0\0".slice(i.length%4||4)).length;u>d;d+=4)(f=(i.charCodeAt(d)<<24)+(i.charCodeAt(d+1)<<16)+(i.charCodeAt(d+2)<<8)+i.charCodeAt(d+3))!==0?(h=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(v=f%85))/85)-(m=f%85))/85)%85,c.push(h+33,m+33,v+33,g+33,y+33)):c.push(122);return function(x,b){for(var w=b;w>0;w--)x.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(i){var l,c,d,u,f,h=String,m="length",v=255,g="charCodeAt",y="slice",x="replace";for(i[y](-2),i=i[y](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),d=[],u=0,f=(i+=l="uuuuu"[y](i[m]%5||5))[m];f>u;u+=5)c=52200625*(i[g](u)-33)+614125*(i[g](u+1)-33)+7225*(i[g](u+2)-33)+85*(i[g](u+3)-33)+(i[g](u+4)-33),d.push(v&c>>24,v&c>>16,v&c>>8,v&c);return function(b,w){for(var j=w;j>0;j--)b.pop()}(d,l[m]),h.fromCharCode.apply(h,d)},n=function(i){return i.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},o=function(i){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),l.test(i)===!1)return"";for(var c="",d=0;d<i.length;d+=2)c+=String.fromCharCode("0x"+(i[d]+i[d+1]));return c},s=function(i){for(var l=new Uint8Array(i.length),c=i.length;c--;)l[c]=i.charCodeAt(c);return(l=AT(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};e.processDataByFilters=function(i,l){var c=0,d=i||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=o(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(Vn.API),function(e){e.loadFile=function(t,r,n){return function(o,s,i){s=s!==!1,i=typeof i=="function"?i:function(){};var l=void 0;try{l=function(c,d,u){var f=new XMLHttpRequest,h=0,m=function(v){var g=v.length,y=[],x=String.fromCharCode;for(h=0;h<g;h+=1)y.push(x(255&v.charCodeAt(h)));return y.join("")};if(f.open("GET",c,!d),f.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(f.onload=function(){f.status===200?u(m(this.responseText)):u(void 0)}),f.send(null),d&&f.status===200)return m(f.responseText)}(o,s,i)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Vn.API),function(e){function t(){return(da.html2canvas?Promise.resolve(da.html2canvas):zu(()=>import("./html2canvas.esm-f16e60ff.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(da.DOMPurify?Promise.resolve(da.DOMPurify):zu(()=>import("./purify.es-fd086bfc.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Fa(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},o=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},s=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(l(f,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},i=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(l,c){return l.__proto__=c||i.prototype,l},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:o("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},i.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var m=0;m<u.length;++m){var v=u[m],g=v.src.find(function(y){return y.format==="truetype"});g&&d.addFont(g.url,v.ref.name,v.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,d.context2d.save(!0),c(this.prop.container,h)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},i.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},i.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},i.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in i.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},i.prototype.get=function(l,c){return this.then(function(){var d=l in i.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},i.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},i.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||Vn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},i.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,f){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(h){return d.updateProgress(null,u),h}).then(u,f).then(function(h){return d.updateProgress(1),h})})},i.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:i.convert(Object.assign({},u),Promise.prototype),h=d.call(f,l,c);return i.convert(h,u.__proto__)},i.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},i.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},i.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return i.convert(c,this)},i.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},i.prototype.error=function(l){return this.then(function(){throw new Error(l)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Vn.getPageSize=function(l,c,d){if(Fa(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var f,h=(""+d).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var v,g=0,y=0;if(m.hasOwnProperty(h))g=m[h][1]/f,y=m[h][0]/f;else try{g=d[1],y=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",y>g&&(v=y,y=g,g=v);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(v=y,y=g,g=v)}return{width:y,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(PE):null;var d=new i(c);return c.worker?d:d.from(l).doCallback()}}(Vn.API),Vn.API.addJS=function(e){return P9=e,this.internal.events.subscribe("postPutResources",function(){mj=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(mj+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),C9=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+P9+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){mj!==void 0&&C9!==void 0&&this.internal.out("/Names <</JavaScript "+mj+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var o=r.outline.render().split(/\r\n/),s=0;s<o.length;s++){var i=o[s],l=n.exec(i);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(i)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(s=0;s<d;s++){var f=r.internal.newObject();u.push(f);var h=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<u.length;s++)r.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,o,s){var i={title:o,options:s,children:[]};return n==null&&(n=this.root),n.children.push(i),i},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var o=0;o<n.children.length;o++)this.genIds_r(n.children[o])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var o=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var i=n.children[s];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var l=this.count=this.count_r({count:0},i);if(l>0&&this.line("/Count "+l),i.options&&i.options.pageNumber){var c=r.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+o(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,o){for(var s=0;s<o.children.length;s++)n.count++,this.count_r(n,o.children[s]);return n.count}}])}(Vn.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,o,s,i,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=i||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var h,m=256*f.charCodeAt(4)+f.charCodeAt(5),v=f.length,g={width:0,height:0,numcomponents:1},y=4;y<v;y+=2){if(y+=m,t.indexOf(f.charCodeAt(y+1))!==-1){h=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:h,numcomponents:f.charCodeAt(y+9)};break}m=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:o}}return u}}(Vn.API),Vn.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var o,s=mQe(e,{checkCrc:!0}),i=s.width,l=s.height,c=s.channels,d=s.palette,u=s.depth;o=d&&c===1?function(A){for(var P=A.width,F=A.height,M=A.data,I=A.palette,R=A.depth,D=!1,U=[],z=[],H=void 0,q=!1,Q=0,pe=0;pe<I.length;pe++){var be=wz(I[pe],4),V=be[0],B=be[1],J=be[2],ue=be[3];U.push(V,B,J),ue!=null&&(ue===0?(Q++,z.length<1&&z.push(pe)):ue<255&&(q=!0))}if(q||Q>1){D=!0,z=void 0;var Ne=P*F;H=new Uint8Array(Ne);for(var Z=new DataView(M.buffer),ge=0;ge<Ne;ge++){var le=EE(Z,ge,R),se=wz(I[le],4)[3];H[ge]=se}}else Q===0&&(z=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:D?8:void 0,colorBytes:M,alphaBytes:H,needSMask:D,palette:U,mask:z}}(s):c===2||c===4?function(A){for(var P=A.data,F=A.width,M=A.height,I=A.channels,R=A.depth,D=I===2?"DeviceGray":"DeviceRGB",U=I-1,z=F*M,H=U,q=z*H,Q=1*z,pe=Math.ceil(q*R/8),be=Math.ceil(Q*R/8),V=new Uint8Array(pe),B=new Uint8Array(be),J=new DataView(P.buffer),ue=new DataView(V.buffer),Ne=new DataView(B.buffer),Z=!1,ge=0;ge<z;ge++){for(var le=ge*I,se=0;se<H;se++)R9(ue,EE(J,le+se,R),ge*H+se,R);var ee=EE(J,le+H,R);ee<(1<<R)-1&&(Z=!0),R9(Ne,ee,1*ge,R)}return{colorSpace:D,colorsPerPixel:U,sMaskBitsPerComponent:Z?R:void 0,colorBytes:V,alphaBytes:B,needSMask:Z}}(s):function(A){var P=A.data,F=A.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:F,colorsPerPixel:F==="DeviceGray"?1:3,colorBytes:P instanceof Uint16Array?function(M){for(var I=M.length,R=new Uint8Array(2*I),D=new DataView(R.buffer,R.byteOffset,R.byteLength),U=0;U<I;U++)D.setUint16(2*U,M[U],!1);return R}(P):P,needSMask:!1}}(s);var f,h,m,v=o,g=v.colorSpace,y=v.colorsPerPixel,x=v.sMaskBitsPerComponent,b=v.colorBytes,w=v.alphaBytes,j=v.needSMask,_=v.palette,C=v.mask,E=null;return n!==Vn.API.image_compression.NONE&&typeof AT=="function"?(E=function(A){var P;switch(A){case Vn.API.image_compression.FAST:P=11;break;case Vn.API.image_compression.MEDIUM:P=13;break;case Vn.API.image_compression.SLOW:P=14;break;default:P=12}return P}(n),f=this.decode.FLATE_DECODE,h="/Predictor ".concat(E," /Colors ").concat(y," /BitsPerComponent ").concat(u," /Columns ").concat(i),e=I9(b,Math.ceil(i*y*u/8),y,u,n),j&&(m=I9(w,Math.ceil(i*x/8),1,x,n))):(f=void 0,h=void 0,e=b,j&&(m=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:r,data:e,index:t,filter:f,decodeParameters:h,transparency:C,palette:_,sMask:m,predictor:E,width:i,height:l,bitsPerComponent:u,sMaskBitsPerComponent:x,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,o){var s=new MQe(t),i=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:i,height:l},u=new kE(100).encode(d,100);return e.processJPEG.call(this,u,r,n,o)},e.processGIF87A=e.processGIF89A}(Vn.API),Bd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:o,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Bd.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){_o.log("bit decode error:"+r)}},Bd.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,o=0;o<t;o++)for(var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*o*4,l=0;l<8&&8*o+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[i+4*l]=c.blue,this.data[i+4*l+1]=c.green,this.data[i+4*l+2]=c.red,this.data[i+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Bd.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,o=0;o<e;o++){var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*o*4,l=s>>4,c=15&s,d=this.palette[l];if(this.data[i]=d.blue,this.data[i+1]=d.green,this.data[i+2]=d.red,this.data[i+3]=255,2*o+1>=this.width)break;d=this.palette[c],this.data[i+4]=d.blue,this.data[i+4+1]=d.green,this.data[i+4+2]=d.red,this.data[i+4+3]=255}t!==0&&(this.pos+=4-t)}},Bd.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(o<this.palette.length){var i=this.palette[o];this.data[s]=i.red,this.data[s+1]=i.green,this.data[s+2]=i.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},Bd.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,d=s>>15?255:0,u=n*this.width*4+4*o;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=i,this.data[u+3]=d}this.pos+=e}},Bd.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var o=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&t)/t*255|0,c=(i>>5&r)/r*255|0,d=(i>>11)/t*255|0,u=o*this.width*4+4*s;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=e}},Bd.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=s,this.data[i+1]=o,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},Bd.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=o,this.data[l+2]=n,this.data[l+3]=i}},Bd.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,o){var s=new Bd(t,!1),i=s.width,l=s.height,c={data:s.getData(),width:i,height:l},d=new kE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,o)}}(Vn.API),F9.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,o){var s=new F9(t),i=s.width,l=s.height,c={data:s.getData(),width:i,height:l},d=new kE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,o)}}(Vn.API),Vn.API.processRGBA=function(e,t,r){for(var n=e.data,o=n.length,s=new Uint8Array(o/4*3),i=new Uint8Array(o/4),l=0,c=0,d=0;d<o;d+=4){var u=n[d],f=n[d+1],h=n[d+2],m=n[d+3];s[l++]=u,s[l++]=f,s[l++]=h,i[c++]=m}var v=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Vn.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},nv=Vn.API,hj=nv.getCharWidthsArray=function(e,t){var r,n,o=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:o.metadata.Unicode.widths,c=l.fof?l.fof:1,d=t.kerning?t.kerning:o.metadata.Unicode.kerning,u=d.fof?d.fof:1,f=t.doKerning!==!1,h=0,m=e.length,v=0,g=l[0]||c,y=[];for(r=0;r<m;r++)n=e.charCodeAt(r),typeof o.metadata.widthOfString=="function"?y.push((o.metadata.widthOfGlyph(o.metadata.characterToGlyph(n))+i*(1e3/s)||0)/1e3):(h=f&&Fa(d[n])==="object"&&!isNaN(parseInt(d[n][v],10))?d[n][v]/u:0,y.push((l[n]||g)/c+h)),v=n;return y},A9=nv.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),o=t.charSpace||this.internal.getCharSpace();return nv.processArabic&&(e=nv.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,o)/r:hj.apply(this,arguments).reduce(function(s,i){return s+i},0)},E9=function(e,t,r,n){for(var o=[],s=0,i=e.length,l=0;s!==i&&l+t[s]<r;)l+=t[s],s++;o.push(e.slice(0,s));var c=s;for(l=0;s!==i;)l+t[s]>n&&(o.push(e.slice(c,s)),l=0,c=s),l+=t[s],s++;return c!==s&&o.push(e.slice(c,s)),o},k9=function(e,t,r){r||(r={});var n,o,s,i,l,c,d,u=[],f=[u],h=r.textIndent||0,m=0,v=0,g=e.split(" "),y=hj.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var x=Array(c).join(" "),b=[];g.map(function(j){(j=j.split(/\s*\n/)).length>1?b=b.concat(j.map(function(_,C){return(C&&_.length?`
`:"")+_})):b.push(j[0])}),g=b,c=A9.apply(this,[x,r])}for(s=0,i=g.length;s<i;s++){var w=0;if(n=g[s],c&&n[0]==`
`&&(n=n.substr(1),w=1),h+m+(v=(o=hj.apply(this,[n,r])).reduce(function(j,_){return j+_},0))>t||w){if(v>t){for(l=E9.apply(this,[n,o,t-(h+m),t]),u.push(l.shift()),u=[l.pop()];l.length;)f.push([l.shift()]);v=o.slice(n.length-(u[0]?u[0].length:0)).reduce(function(j,_){return j+_},0)}else u=[n];f.push(u),h=v+c,m=y}else u.push(n),h+=m+v,m=y}return d=c?function(j,_){return(_?x:"")+j.join(" ")}:function(j){return j.join(" ")},f.map(d)},nv.splitTextToSize=function(e,t,r){var n,o=(r=r||{}).fontSize||this.internal.getFontSize(),s=function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),h="Unicode";return f.metadata[h]?{widths:f.metadata[h].widths||{0:1},kerning:f.metadata[h].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/o;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/o:0,s.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(k9.apply(this,[n[l],i,s]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},o={},s=0;s<16;s++)n[r[s]]=t[s],o[t[s]]=r[s];var i=function(h){return"0x"+parseInt(h,10).toString(16)},l=e.__fontmetrics__.compress=function(h){var m,v,g,y,x=["{"];for(var b in h){if(m=h[b],isNaN(parseInt(b,10))?v="'"+b+"'":(b=parseInt(b,10),v=(v=i(b).slice(2)).slice(0,-1)+o[v.slice(-1)]),typeof m=="number")m<0?(g=i(m).slice(3),y="-"):(g=i(m).slice(2),y=""),g=y+g.slice(0,-1)+o[g.slice(-1)];else{if(Fa(m)!=="object")throw new Error("Don't know what to do with value type "+Fa(m)+".");g=l(m)}x.push(v+g)}return x.push("}"),x.join("")},c=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,v,g,y,x={},b=1,w=x,j=[],_="",C="",E=h.length-1,A=1;A<E;A+=1)(y=h[A])=="'"?m?(g=m.join(""),m=void 0):m=[]:m?m.push(y):y=="{"?(j.push([w,g]),w={},g=void 0):y=="}"?((v=j.pop())[0][v[1]]=w,g=void 0,w=v[0]):y=="-"?b=-1:g===void 0?n.hasOwnProperty(y)?(_+=n[y],g=parseInt(_,16)*b,b=1,_=""):_+=y:n.hasOwnProperty(y)?(C+=n[y],w[g]=parseInt(C,16)*b,b=1,g=void 0,C=""):C+=y;return x},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var m=h.font,v=f.Unicode[m.postScriptName];v&&(m.metadata.Unicode={},m.metadata.Unicode.widths=v.widths,m.metadata.Unicode.kerning=v.kerning);var g=u.Unicode[m.postScriptName];g&&(m.metadata.Unicode.encoding=g,m.encoding=g.codePages[0])}])}(Vn.API),function(e){var t=function(r){for(var n=r.length,o=new Uint8Array(n),s=0;s<n;s++)o[s]=r.charCodeAt(s);return o};e.API.events.push(["addFont",function(r){var n=void 0,o=r.font,s=r.instance;if(!o.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");if(typeof(n=s.existsFileInVFS(o.postScriptName)===!1?s.loadFile(o.postScriptName):s.getFileFromVFS(o.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");(function(i,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(e_(l)),i.metadata=e.API.TTFFont.open(l),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(o,n)}}])}(Vn),Vn.API.addSvgAsImage=function(e,t,r,n,o,s,i,l){if(isNaN(t)||isNaN(r))throw _o.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(o))throw _o.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=o;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(da.canvg?Promise.resolve(da.canvg):zu(()=>import("./index.es-e9a3b819.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(u)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,o,i,l)})},Vn.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var o=0;o<this.internal.pages[n].length;o++)this.internal.pages[n][o]=this.internal.pages[n][o].replace(t,r);return this},Vn.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,o,s,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(i),c=[],d=0,u=0,f=0;function h(v,g){var y,x=!1;for(y=0;y<v.length;y+=1)v[y]===g&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var m=l.length;for(f=0;f<m;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Fa(e)==="object"){for(o in e)if(s=e[o],h(l,o)&&s!==void 0){if(r[o].type==="boolean"&&typeof s=="boolean")r[o].value=s;else if(r[o].type==="name"&&h(r[o].valueSet,s))r[o].value=s;else if(r[o].type==="integer"&&Number.isInteger(s))r[o].value=s;else if(r[o].type==="array"){for(d=0;d<s.length;d+=1)if(n=!0,s[d].length===1&&typeof s[d][0]=="number")c.push(String(s[d]-1));else if(s[d].length>1){for(u=0;u<s[d].length;u+=1)typeof s[d][u]!="number"&&(n=!1);n===!0&&c.push([s[d][0]-1,s[d][1]-1].join(" "))}r[o].value="["+c.join(" ")+"]"}else r[o].value=r[o].defaultValue;r[o].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,g=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?g.push("/"+v+" /"+r[v].value):g.push("/"+v+" "+r[v].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',o=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+i.length+l.length+o.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(o+s+i+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,o){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:o||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Vn.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,i){for(var l,c=i.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],f=0,h=s.length;f<h;++f){if(l=i.metadata.characterToGlyph(s.charCodeAt(f)),i.metadata.glyIdsUsed.push(l),i.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(i.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(s){var i,l,c,d,u,f,h;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,h=(l=Object.keys(s).sort(function(m,v){return m-v})).length;f<h;f++)i=l[f],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[i]!==void 0&&s[i]!==null&&typeof s[i].toString=="function"&&(d=("0000"+s[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),c.push("<"+i+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(i){var l=i.font,c=i.out,d=i.newObject,u=i.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",v=0;v<h.length;v++)m+=String.fromCharCode(h[v]);var g=d();u({data:m,addLength1:!0,objectId:g}),c("endobj");var y=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var x=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+pv(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+pv(l.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+pv(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(i){var l=i.font,c=i.out,d=i.newObject,u=i.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,h="",m=0;m<f.length;m++)h+=String.fromCharCode(f[m]);var v=d();u({data:h,addLength1:!0,objectId:v}),c("endobj");var g=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+v+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+pv(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var x=0;x<l.metadata.hmtx.widths.length;x++)l.metadata.hmtx.widths[x]=parseInt(l.metadata.hmtx.widths[x]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+pv(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var o=function(s){var i,l=s.text||"",c=s.x,d=s.y,u=s.options||{},f=s.mutex||{},h=f.pdfEscape,m=f.activeFontKey,v=f.fonts,g=m,y="",x=0,b="",w=v[g].encoding;if(v[g].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:f};for(b=l,g=m,Array.isArray(l)&&(b=l[0]),x=0;x<b.length;x+=1)v[g].metadata.hasOwnProperty("cmap")&&(i=v[g].metadata.cmap.unicode.codeMap[b[x].charCodeAt(0)]),i||b[x].charCodeAt(0)<256&&v[g].metadata.hasOwnProperty("Unicode")?y+=b[x]:y+="";var j="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?j=h(y,g).split("").map(function(_){return _.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(j=r(y,v[g])),f.isHex=!0,{text:j,x:c,y:d,options:u,mutex:f}};t.events.push(["postProcessText",function(s){var i=s.text||"",l=[],c={text:i,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(i)){var d=0;for(d=0;d<i.length;d+=1)Array.isArray(i[d])&&i[d].length===3?l.push([o(Object.assign({},c,{text:i[d][0]})).text,i[d][1],i[d][2]]):l.push(o(Object.assign({},c,{text:i[d]})).text);s.text=l}else s.text=o(Object.assign({},c,{text:i})).text}])}(Vn),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Vn.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var o,s,i,l,c,d,u,f=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var j=function(M){var I=M.charCodeAt(),R=I>>8,D=g[R];return D!==void 0?f[256*D+(255&I)]:R===252||R===253?"AL":x.test(R)?"L":R===8?"R":"N"},_=function(M){for(var I,R=0;R<M.length;R++){if((I=j(M.charAt(R)))==="L")return!1;if(I==="R")return!0}return!1},C=function(M,I,R,D){var U,z,H,q,Q=I[D];switch(Q){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"N":case"AN":break;case"EN":b&&(Q="AN");break;case"AL":b=!0,Q="R";break;case"WS":case"BN":Q="N";break;case"CS":D<1||D+1>=I.length||(U=R[D-1])!=="EN"&&U!=="AN"||(z=I[D+1])!=="EN"&&z!=="AN"?Q="N":b&&(z="AN"),Q=z===U?z:"N";break;case"ES":Q=(U=D>0?R[D-1]:"B")==="EN"&&D+1<I.length&&I[D+1]==="EN"?"EN":"N";break;case"ET":if(D>0&&R[D-1]==="EN"){Q="EN";break}if(b){Q="N";break}for(H=D+1,q=I.length;H<q&&I[H]==="ET";)H++;Q=H<q&&I[H]==="EN"?"EN":"N";break;case"NSM":if(i&&!l){for(q=I.length,H=D+1;H<q&&I[H]==="NSM";)H++;if(H<q){var pe=M[D],be=pe>=1425&&pe<=2303||pe===64286;if(U=I[H],be&&(U==="R"||U==="AL")){Q="R";break}}}Q=D<1||(U=I[D-1])==="B"?"N":R[D-1];break;case"B":b=!1,o=!0,Q=w;break;case"S":s=!0,Q="N"}return Q},E=function(M,I,R){var D=M.split("");return R&&A(D,R,{hiLevel:w}),D.reverse(),I&&I.reverse(),D.join("")},A=function(M,I,R){var D,U,z,H,q,Q=-1,pe=M.length,be=0,V=[],B=w?m:h,J=[];for(b=!1,o=!1,s=!1,U=0;U<pe;U++)J[U]=j(M[U]);for(z=0;z<pe;z++){if(q=be,V[z]=C(M,J,V,z),D=240&(be=B[q][v[V[z]]]),be&=15,I[z]=H=B[be][5],D>0)if(D===16){for(U=Q;U<z;U++)I[U]=1;Q=-1}else Q=-1;if(B[be][6])Q===-1&&(Q=z);else if(Q>-1){for(U=Q;U<z;U++)I[U]=H;Q=-1}J[z]==="B"&&(I[z]=0),R.hiLevel|=H}s&&function(ue,Ne,Z){for(var ge=0;ge<Z;ge++)if(ue[ge]==="S"){Ne[ge]=w;for(var le=ge-1;le>=0&&ue[le]==="WS";le--)Ne[le]=w}}(J,I,pe)},P=function(M,I,R,D,U){if(!(U.hiLevel<M)){if(M===1&&w===1&&!o)return I.reverse(),void(R&&R.reverse());for(var z,H,q,Q,pe=I.length,be=0;be<pe;){if(D[be]>=M){for(q=be+1;q<pe&&D[q]>=M;)q++;for(Q=be,H=q-1;Q<H;Q++,H--)z=I[Q],I[Q]=I[H],I[H]=z,R&&(z=R[Q],R[Q]=R[H],R[H]=z);be=q}be++}}},F=function(M,I,R){var D=M.split(""),U={hiLevel:w};return R||(R=[]),A(D,R,U),function(z,H,q){if(q.hiLevel!==0&&u)for(var Q,pe=0;pe<z.length;pe++)H[pe]===1&&(Q=y.indexOf(z[pe]))>=0&&(z[pe]=y[Q+1])}(D,R,U),P(2,D,I,R,U),P(1,D,I,R,U),D.join("")};return this.__bidiEngine__.doBidiReorder=function(M,I,R){if(function(U,z){if(z)for(var H=0;H<U.length;H++)z[H]=H;l===void 0&&(l=_(U)),d===void 0&&(d=_(U))}(M,I),i||!c||d)if(i&&c&&l^d)w=l?1:0,M=E(M,I,R);else if(!i&&c&&d)w=l?1:0,M=F(M,I,R),M=E(M,I);else if(!i||l||c||d){if(i&&!c&&l^d)M=E(M,I),l?(w=0,M=F(M,I,R)):(w=1,M=F(M,I,R),M=E(M,I));else if(i&&l&&!c&&d)w=1,M=F(M,I,R),M=E(M,I);else if(!i&&!c&&l^d){var D=u;l?(w=1,M=F(M,I,R),w=0,u=!1,M=F(M,I,R),u=D):(w=0,M=F(M,I,R),M=E(M,I),w=1,u=!1,M=F(M,I,R),u=D,M=E(M,I))}}else w=0,M=F(M,I,R);else w=l?1:0,M=F(M,I,R);return M},this.__bidiEngine__.setOptions=function(M){M&&(i=M.isInputVisual,c=M.isOutputVisual,l=M.isInputRtl,d=M.isOutputRtl,u=M.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var o=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var i=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(o)==="[object Array]"){var l=0;for(i=[],l=0;l<o.length;l+=1)Object.prototype.toString.call(o[l])==="[object Array]"?i.push([r.doBidiReorder(o[l][0]),o[l][1],o[l][2]]):i.push([r.doBidiReorder(o[l])]);n.text=i}else n.text=r.doBidiReorder(o);r.setOptions({isInputVisual:!0})}])}(Vn),Vn.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Ah(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new YQe(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new RQe(this.contents),this.head=new FQe(this),this.name=new UQe(this),this.cmap=new iae(this),this.toUnicode={},this.hhea=new $Qe(this),this.maxp=new VQe(this),this.hmtx=new WQe(this),this.post=new qQe(this),this.os2=new BQe(this),this.loca=new XQe(this),this.glyf=new HQe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,o,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var i,l,c,d;for(d=[],i=0,l=(c=this.bbox).length;i<l;i++)t=c[i],d.push(Math.round(t*this.scaleFactor));return d}.call(this),this.stemV=0,this.post.exists?(n=255&(o=this.post.italic_angle),32768&(r=o>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var o,s,i,l;for(i=0,s=0,l=(t=""+t).length;0<=l?s<l:s>l;s=0<=l?++s:--s)o=t.charCodeAt(s),i+=this.widthOfGlyph(this.characterToGlyph(o))+n*(1e3/r)||0;return i*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var gu,Ah=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,o;for(o=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)o.push(this.writeByte(t.charCodeAt(r)));return o},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,o,s,i,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),o=this.readByte(),s=this.readByte(),i=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^o)+16777216*(255^s)+65536*(255^i)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*o+16777216*s+65536*i+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,o,s;for(s=[],n=0,o=t.length;n<o;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),RQe=function(){var e;function t(r){var n,o,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},o=0,s=this.tableCount;0<=s?o<s:o>s;o=0<=s?++o:--o)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,o,s,i,l,c,d,u,f,h,m,v,g;for(g in m=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(m)/c),i=Math.floor(f/c),u=16*m-f,(o=new Ah).writeInt(this.scalarType),o.writeShort(m),o.writeShort(f),o.writeShort(i),o.writeShort(u),s=16*m,d=o.pos+s,l=null,v=[],r)for(h=r[g],o.writeString(g),o.writeInt(e(h)),o.writeInt(d),o.writeInt(h.length),v=v.concat(h),g==="head"&&(l=d),d+=h.length;d%4;)v.push(0),d++;return o.write(v),n=2981146554-e(o.data),o.pos=l+8,o.writeUInt32(n),o.data},e=function(r){var n,o,s,i;for(r=lae.call(r);r.length%4;)r.push(0);for(s=new Ah(r),o=0,n=0,i=r.length;n<i;n=n+=4)o+=s.readUInt32();return 4294967295&o},t}(),LQe={}.hasOwnProperty,tf=function(e,t){for(var r in t)LQe.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};gu=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var FQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Ah).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),$9=function(){function e(t,r){var n,o,s,i,l,c,d,u,f,h,m,v,g,y,x,b,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(m=t.readUInt16(),h=m/2,t.pos+=6,s=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),t.pos+=2,g=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),d=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),u=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),o=(this.length-t.pos+this.offset)/2,l=function(){var j,_;for(_=[],c=j=0;0<=o?j<o:j>o;c=0<=o?++j:--j)_.push(t.readUInt16());return _}(),c=x=0,w=s.length;x<w;c=++x)for(y=s[c],n=b=v=g[c];v<=y?b<=y:b>=y;n=v<=y?++b:--b)u[c]===0?i=n+d[c]:(i=l[u[c]/2+(n-v)-(h-c)]||0)!==0&&(i+=d[c]),this.codeMap[n]=65535&i}t.pos=f}return e.encode=function(t,r){var n,o,s,i,l,c,d,u,f,h,m,v,g,y,x,b,w,j,_,C,E,A,P,F,M,I,R,D,U,z,H,q,Q,pe,be,V,B,J,ue,Ne,Z,ge,le,se,ee,de;switch(D=new Ah,i=Object.keys(t).sort(function(Le,ae){return Le-ae}),r){case"macroman":for(g=0,y=function(){var Le=[];for(v=0;v<256;++v)Le.push(0);return Le}(),b={0:0},s={},U=0,Q=i.length;U<Q;U++)b[le=t[o=i[U]]]==null&&(b[le]=++g),s[o]={old:t[o],new:b[t[o]]},y[o]=b[t[o]];return D.writeUInt16(1),D.writeUInt16(0),D.writeUInt32(12),D.writeUInt16(0),D.writeUInt16(262),D.writeUInt16(0),D.write(y),{charMap:s,subtable:D.data,maxGlyphID:g+1};case"unicode":for(I=[],f=[],w=0,b={},n={},x=d=null,z=0,pe=i.length;z<pe;z++)b[_=t[o=i[z]]]==null&&(b[_]=++w),n[o]={old:_,new:b[_]},l=b[_]-o,x!=null&&l===d||(x&&f.push(x),I.push(o),d=l),x=o;for(x&&f.push(x),f.push(65535),I.push(65535),F=2*(P=I.length),A=2*Math.pow(Math.log(P)/Math.LN2,2),h=Math.log(A/2)/Math.LN2,E=2*P-A,c=[],C=[],m=[],v=H=0,be=I.length;H<be;v=++H){if(M=I[v],u=f[v],M===65535){c.push(0),C.push(0);break}if(M-(R=n[M].new)>=32768)for(c.push(0),C.push(2*(m.length+P-v)),o=q=M;M<=u?q<=u:q>=u;o=M<=u?++q:--q)m.push(n[o].new);else c.push(R-M),C.push(0)}for(D.writeUInt16(3),D.writeUInt16(1),D.writeUInt32(12),D.writeUInt16(4),D.writeUInt16(16+8*P+2*m.length),D.writeUInt16(0),D.writeUInt16(F),D.writeUInt16(A),D.writeUInt16(h),D.writeUInt16(E),Z=0,V=f.length;Z<V;Z++)o=f[Z],D.writeUInt16(o);for(D.writeUInt16(0),ge=0,B=I.length;ge<B;ge++)o=I[ge],D.writeUInt16(o);for(se=0,J=c.length;se<J;se++)l=c[se],D.writeUInt16(l);for(ee=0,ue=C.length;ee<ue;ee++)j=C[ee],D.writeUInt16(j);for(de=0,Ne=m.length;de<Ne;de++)g=m[de],D.writeUInt16(g);return{charMap:n,subtable:D.data,maxGlyphID:w+1}}},e}(),iae=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,o;for(t.pos=this.offset,this.version=t.readUInt16(),o=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=o?n<o:n>o;n=0<=o?++n:--n)r=new $9(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,o;return r==null&&(r="macroman"),n=$9.encode(t,r),(o=new Ah).writeUInt16(0),o.writeUInt16(1),n.table=o.data.concat(n.subtable),n},e}(),$Qe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),BQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),qQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,o;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],o=[];t.pos<this.offset+this.length;)r=t.readByte(),o.push(this.names.push(t.readString(r)));return o;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=function(){var i,l,c;for(c=[],s=i=0,l=this.file.maxp.numGlyphs;0<=l?i<l:i>l;s=0<=l?++i:--i)c.push(t.readUInt32());return c}.call(this)}},e}(),zQe=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},UQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,o,s,i,l,c,d,u,f,h;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},s=u=0,f=n.length;u<f;s=++u)o=n[s],t.pos=o.offset,d=t.readString(o.length),i=new zQe(d,o),c[h=o.nameID]==null&&(c[h]=[]),c[o.nameID].push(i);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),VQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),WQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,o,s,i,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],r=d=0;0<=o?d<o:d>o;r=0<=o?++d:--d)u.push(t.readInt16());return u}(),this.widths=function(){var d,u,f,h;for(h=[],d=0,u=(f=this.metrics).length;d<u;d++)s=f[d],h.push(s.advance);return h}.call(this),n=this.widths[this.widths.length-1],c=[],r=i=0;0<=o?i<o:i>o;r=0<=o?++i:--i)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),lae=[].slice,HQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,o,s,i,l,c,d,u,f;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(o=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,i=(l=new Ah(r.read(o))).readShort(),d=l.readShort(),f=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[t]=i===-1?new KQe(l,d,f,c,u):new GQe(l,i,d,f,c,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var o,s,i,l,c;for(i=[],s=[],l=0,c=r.length;l<c;l++)o=t[r[l]],s.push(i.length),o&&(i=i.concat(o.encode(n)));return s.push(i.length),{table:i,offsets:s}},e}(),GQe=function(){function e(t,r,n,o,s,i){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=o,this.xMax=s,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),KQe=function(){function e(t,r,n,o,s){var i,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=o,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;l=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&l;)i.pos+=1&l?4:2,128&l?i.pos+=8:64&l?i.pos+=4:8&l&&(i.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Ah(lae.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),XQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return tf(e,gu),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?function(){var o,s;for(s=[],n=0,o=this.length;n<o;n+=2)s.push(2*t.readUInt16());return s}.call(this):function(){var o,s;for(s=[],n=0,o=this.length;n<o;n+=4)s.push(t.readUInt32());return s}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),o=0,s=0,i=0;i<n.length;++i)if(n[i]=o,s<r.length&&r[s]==i){++s,n[i]=o;var l=this.offsets[i],c=this.offsets[i+1]-l;c>0&&(o+=c)}for(var d=new Array(4*n.length),u=0;u<n.length;++u)d[4*u+3]=255&n[u],d[4*u+2]=(65280&n[u])>>8,d[4*u+1]=(16711680&n[u])>>16,d[4*u]=(4278190080&n[u])>>24;return d},e}(),YQe=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,o,s;for(r in o=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=o[n];return t},e.prototype.glyphsFor=function(t){var r,n,o,s,i,l,c;for(o={},i=0,l=t.length;i<l;i++)o[s=t[i]]=this.font.glyf.glyphFor(s);for(s in r=[],o)(n=o[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],o[s]=n;return o},e.prototype.encode=function(t,r){var n,o,s,i,l,c,d,u,f,h,m,v,g,y,x;for(o in n=iae.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(t),m={0:0},x=n.charMap)m[(c=x[o]).old]=c.new;for(v in h=n.maxGlyphID,i)v in m||(m[v]=h++);return u=function(b){var w,j;for(w in j={},b)j[b[w]]=w;return j}(m),f=Object.keys(u).sort(function(b,w){return b-w}),g=function(){var b,w,j;for(j=[],b=0,w=f.length;b<w;b++)l=f[b],j.push(u[l]);return j}(),s=this.font.glyf.encode(i,g,m),d=this.font.loca.encode(s.offsets,g),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Vn.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,o,s,i;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(t.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(o in s=["<<"],r)i=r[o],s.push("/"+o+" "+t.convert(i));return s.push(">>"),s.join(`
`)}return""+r},t}();const JQe=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:PQe,AcroFormAppearance:Rn,AcroFormButton:Hs,AcroFormCheckBox:pb,AcroFormChoiceField:zp,AcroFormComboBox:Vp,AcroFormEditBox:mb,AcroFormListBox:Up,AcroFormPasswordField:gb,AcroFormPushButton:hb,AcroFormRadioButton:Wp,AcroFormTextField:ph,GState:Vw,ShadingPattern:Lm,TilingPattern:Op,default:Vn,jsPDF:Vn},Symbol.toStringTag,{value:"Module"})),Ps=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,o]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${o}`},ji=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function QQe({setIsModalOpen:e,setBookings:t,form:r,setForm:n,localCustomers:o,onOpenClientModal:s,onClientModalSuccess:i}){const{toast:l}=no(),{userProfile:c}=So(),{loadAlerts:d}=bC(),{isPaymentModalOpen:u,closePaymentModal:f,editingBooking:h,paymentTotal:m,setPaymentTotal:v,participantsForm:g,setParticipantsForm:y,payMethods:x,openEditParticipantModal:b,protectPaymentModal:w,onParticipantReplacedRef:j,lastVisibilityChangeTime:_,isModalProtected:C}=X_();window.__protectPaymentModal=w,p.useEffect(()=>(u&&(document.body.style.overflow="auto",document.body.style.pointerEvents="auto"),()=>{document.body.style.overflow="",document.body.style.pointerEvents=""}),[u]);const[E,A]=p.useState(""),[P,F]=p.useState([]);p.useState(null);const[M,I]=p.useState(null),[R,D]=p.useState(!1),[U,z]=p.useState(""),[H,q]=p.useState(!1),[Q,pe]=p.useState([]);p.useState(null);const[be,V]=p.useState(0),[B,J]=p.useState(!1),[ue,Ne]=p.useState(""),[Z,ge]=p.useState([]),[le,se]=p.useState([]),ee=p.useRef({}),de=p.useRef({}),Le=p.useRef({}),[ae,ie]=p.useState(null),[dt,At]=p.useState(null),[st,ut]=p.useState(!1),[Rt,Nt]=p.useState("downloading"),[tt,he]=p.useState(0),[ke,et]=p.useState(null),[Me,$e]=p.useState(""),[Be,we]=p.useState(null),He=p.useRef(null),ht=p.useRef(null),zt=p.useRef(null),hr=p.useRef(null),Mt=p.useRef([]),Qt=p.useRef(null),Se=p.useRef(null),kt=p.useRef(null),Lt=p.useRef(!1),[fr,yr]=p.useState(!1),Xt=p.useRef(null),nr=p.useRef([]),[ir,Ee]=p.useState({isOpen:!1,participantIndex:null,currentStatus:null}),qe=p.useRef(!1),Ge=p.useCallback((at,Vt)=>{se(wr=>{const er=[...wr];return at>=0&&at<er.length&&(Vt===""&&er[at].nome?Le.current[at]=er[at].nome:Vt!==""&&delete Le.current[at],er[at]={...er[at],nome:Vt}),y(er),er})},[y]),Qe=p.useCallback(at=>{const Vt=Le.current[at];Vt&&(se(wr=>{const er=[...wr];return at>=0&&at<er.length&&(er[at]={...er[at],nome:Vt}),delete Le.current[at],y(er),er}),setTimeout(()=>{ee.current[at]?.focus()},0))},[y]),St=p.useCallback((at,Vt,wr)=>{if(Vt==="Pago"){const er=ji(wr);if(Number.isFinite(er)&&er>0)return}qe.current=!0,console.log(" [StatusConfirmation] Modal protegido por 3 segundos"),setTimeout(()=>{qe.current=!1,console.log(" [StatusConfirmation] Proteo removida")},3e3),Ee({isOpen:!0,participantIndex:at,currentStatus:Vt})},[]),pt=p.useCallback(at=>{const{participantIndex:Vt}=ir;Vt!==null&&(se(wr=>{const er=[...wr];return Vt>=0&&Vt<er.length&&(er[Vt]={...er[Vt],status_pagamento:at}),y(er),er}),Lt.current=!0,Se.current&&clearTimeout(Se.current),Se.current=setTimeout(()=>{console.log(" [StatusChange] Salvando mudana de status...")},100),setTimeout(()=>{console.log(" [StatusChange] Recarregando alertas..."),d().catch(wr=>{console.error(" [StatusChange] Erro ao recarregar alertas:",wr)})},500)),Ee({isOpen:!1,participantIndex:null,currentStatus:null})},[ir,y,d]),Et=p.useCallback(at=>!o||!Array.isArray(o)?!1:o.find(wr=>wr.id===at)?.is_consumidor_final===!0,[o]),mt=p.useCallback(()=>{const at=P||[],Vt=(le||[]).map((Ze,Fr)=>({...Ze,_originalIndex:Fr})).filter(Ze=>!at.includes(Ze._originalIndex)),wr=Vt.find(Ze=>Et(Ze.cliente_id)&&Ze.nome&&Ze.nome.toLowerCase().includes("cliente consumidor"));return wr?wr._originalIndex:Vt.find(Ze=>Et(Ze.cliente_id)&&Ze.nome)?._originalIndex??null},[le,P,Et]),gt=p.useCallback(at=>{const Vt=P||[],er=(le||[]).map((Fr,jt)=>({...Fr,_originalIndex:jt})).filter(Fr=>!Vt.includes(Fr._originalIndex)).filter(Fr=>Et(Fr.cliente_id));if(er.length===0)return null;const Ze=er.findIndex(Fr=>Fr._originalIndex===at);return Ze!==-1?Ze<er.length-1?er[Ze+1]._originalIndex:er[0]._originalIndex:null},[le,P,Et]),ft=p.useCallback(at=>{const Vt=P||[],er=(le||[]).map((Fr,jt)=>({...Fr,_originalIndex:jt})).filter(Fr=>!Vt.includes(Fr._originalIndex)).filter(Fr=>Et(Fr.cliente_id)),Ze=er.findIndex(Fr=>Fr._originalIndex===at);return Ze>0?er[Ze-1]._originalIndex:null},[le,P,Et]),Dt=p.useCallback(()=>{if(!x||x.length===0)return null;const at=x.find(Vt=>Vt.codigo_interno==="01");return at||x[0]},[x]),Ft=p.useMemo(()=>{const at=le||[],Vt=P||[];return at.filter((wr,er)=>!Vt.includes(er)).length},[le,P]),ye=p.useMemo(()=>{const at=le||[],Vt=P||[],wr=at.filter((Wt,Zt)=>!Vt.includes(Zt)),er=ji(m);let Ze=0,Fr=0,jt=0,_r=!1;wr.forEach(Wt=>{let Zt=ji(Wt?.valor_cota);if(Wt?.aplicar_taxa===!0&&Number.isFinite(Zt)){const zr=x.find(Jr=>String(Jr.id)===String(Wt.finalizadora_id)),_t=Number(zr?.taxa_percentual||0);_t>0&&(Zt=Zt/(1+_t/100),_r=!0)}Number.isFinite(Zt)&&(Ze+=Zt),(Wt?.status_pagamento||"Pendente")==="Pago"?Fr++:jt++});const bt=Number.isFinite(er)?Ze-er:0;return{totalTarget:er,totalAssigned:Ze,diff:bt,paid:Fr,pending:jt,temTaxaAplicada:_r}},[le,P,m,x]),wt=()=>{const at=ji(m);if(!Number.isFinite(at)||Ft===0)return;const Vt=at/Ft,wr=Ps(String(Vt.toFixed(2)));se(er=>{const Ze=[...er];return Ze.forEach((Fr,jt)=>{Ze[jt]={...Ze[jt],valor_cota:wr,status_pagamento:"Pago",aplicar_taxa:!1}}),Ze})},Yt=()=>{se(at=>{const Vt=[...at];return Vt.forEach((wr,er)=>{Vt[er]={...Vt[er],valor_cota:"",status_pagamento:"Pendente",aplicar_taxa:!1}}),Vt})},br=()=>{se(at=>{const Vt=[...at];return Vt.forEach((wr,er)=>{const Ze=ji(wr.valor_cota);if(Ze>0){const jt=x.find(bt=>String(bt.id)===String(wr.finalizadora_id)),_r=Number(jt?.taxa_percentual||0);if(_r>0&&!wr.aplicar_taxa){const bt=Ze*(1+_r/100);Vt[er]={...Vt[er],aplicar_taxa:!0,valor_cota:Ps(bt.toFixed(2))}}}}),Vt})},Mr=(at,Vt)=>{b(at,Vt)},Nr=()=>{Ne(m||""),J(!0)},Rr=()=>{v(ue),J(!1)},Er=()=>{Ne(""),J(!1)},ln=async(at={})=>{const{autoSave:Vt=!1}=at;try{if(R)return;D(!0);const wr=h?.id,er=c?.codigo_empresa;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [SAVE-PAYMENTS] Iniciando salvamento",{autoSave:Vt,agendamentoId:wr,timestamp:new Date().toISOString()})}catch{}if(!wr||!er){l({title:"Erro ao salvar pagamentos",description:"Agendamento ou empresa indisponvel.",variant:"destructive"});return}const Ze=(le||[]).filter((_t,Jr)=>!(P||[]).includes(Jr)),Fr=Ze.reduce((_t,Jr)=>{const mn=Jr.status_pagamento||"Pendente";return _t+(mn!=="Pago"?1:0)},0);try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Dados a salvar:",{totalParticipantes:Ze.length,pendentes:Fr}),console.log("[ORDER-SAVE] savingIds:",Ze.map(_t=>_t.cliente_id)))}catch{}const jt=new Date().toISOString();try{localStorage.getItem("debug:agenda")==="1"&&console.log(`

========== SALVAMENTO INICIADO ${jt} ==========`)}catch{}const{data:_r,error:bt}=await fe.from("agendamento_participantes").select("*").eq("codigo_empresa",er).eq("agendamento_id",wr).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(bt)throw console.error(" Erro ao buscar participantes originais:",bt),bt;try{localStorage.getItem("debug:agenda")==="1"&&(console.log(` Participantes originais no banco: ${_r?.length||0}`),console.log("[ORDER-SAVE] originalIds:",(_r||[]).map(_t=>_t.cliente_id)))}catch{}Ze.forEach((_t,Jr)=>{console.log(`  #${Jr+1} (novo): ${_t.nome}`)}),console.log(" Fazendo substituio inteligente por posio");for(let _t=0;_t<_r.length;_t++){const Jr=_r[_t],mn=Ze[_t];if(!mn){console.log(` Posio #${_t+1}: Sem participante novo, pulando update`);continue}const ma=ji(mn.valor_cota),Nn=Dt(),re=mn.finalizadora_id||(Nn?.id?String(Nn.id):null);console.log(` Atualizando posio #${_t+1}: ${Jr.nome}  ${mn.nome}`);const{error:Te}=await fe.from("agendamento_participantes").update({cliente_id:mn.cliente_id,nome:mn.nome,valor_cota:Number.isFinite(ma)?ma:0,status_pagamento:mn.status_pagamento||"Pendente",finalizadora_id:re,aplicar_taxa:mn.aplicar_taxa||!1,ordem:_t+1}).eq("id",Jr.id);if(Te)throw console.error(` Erro ao atualizar posio #${_t+1}:`,Te),Te}const Wt=_r.length;if(Ze.length<Wt){const _t=_r.slice(Ze.length).map(Jr=>Jr.id);if(_t.length>0){console.log(" Removendo participantes excedentes:",_t.length);const{error:Jr}=await fe.from("agendamento_participantes").delete().in("id",_t).eq("codigo_empresa",er).eq("agendamento_id",wr);if(Jr)throw console.error(" Erro ao remover participantes excedentes:",Jr),Jr}}if(Ze.length>Wt){console.log(" Inserindo participantes adicionais:",Ze.length-Wt);const _t=Ze.slice(Wt).map((mn,ma)=>{const Nn=ji(mn.valor_cota),re=Dt(),Te=mn.finalizadora_id||(re?.id?String(re.id):null);return{codigo_empresa:er,agendamento_id:wr,cliente_id:mn.cliente_id,nome:mn.nome,valor_cota:Number.isFinite(Nn)?Nn:0,status_pagamento:mn.status_pagamento||"Pendente",finalizadora_id:Te,aplicar_taxa:mn.aplicar_taxa||!1,ordem:Wt+ma+1}}),{error:Jr}=await fe.from("agendamento_participantes").insert(_t);if(Jr)throw console.error(" Erro ao inserir novos participantes:",Jr),Jr}console.log(" Substituio inteligente concluda"),console.log(`========== SALVAMENTO CONCLUDO ==========

`);const Zt=Ze.map(_t=>({id:_t.cliente_id,nome:_t.nome,codigo:_t.codigo!==null&&_t.codigo!==void 0?_t.codigo:null})),Br=Zt[0]||null,zr=Zt.map(_t=>_t?.nome).filter(Boolean);await fe.from("agendamentos").update({cliente_id:Br?.id??null,clientes:zr}).eq("codigo_empresa",er).eq("id",wr),n(_t=>({..._t,selectedClients:Zt})),t(_t=>_t.map(Jr=>Jr.id===wr?{...Jr,customer:Br?.nome||Jr.customer,cliente_id:Br?.id??null,clientes:zr}:Jr)),se(Ze),F([]),Vt||(Fr>0?l({title:"Pagamentos salvos",description:`${Fr} ${Fr===1?"pendente":"pendentes"}`,variant:"warning"}):l({title:"Pagamentos salvos",variant:"success"})),I(null),y(Ze);try{window.dispatchEvent(new CustomEvent("payments:saved",{detail:{agendamentoId:wr,participants:Ze}}))}catch{}d().catch(_t=>{console.error("[PaymentModal] Erro ao recarregar alertas:",_t)});try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Salvamento concludo com sucesso"),console.log(" [SAVE-PAYMENTS] Contagem final de pendentes:",Fr))}catch{}console.log(" [LOG 2 - FECHAR PAYMENT MODAL] Dados salvos no banco:"),console.log("   Total:",Ze.length),console.log("   Pendentes:",Fr),Ze.forEach((_t,Jr)=>{console.log(`   #${Jr+1}: ${_t.nome} | Status: ${_t.status_pagamento} | Valor: ${_t.valor_cota}`)}),Vt?console.log(" [SAVE-PAYMENTS] Auto-save concludo - modal permanece aberto"):(console.log(" [SAVE-PAYMENTS] Fechando modal de pagamentos (no  auto-save)"),f(),e(!1))}catch(wr){console.error(" [SAVE-PAYMENTS] Erro ao salvar:",wr),l({title:"Erro ao salvar pagamentos",description:"Tente novamente.",variant:"destructive"})}finally{D(!1)}};p.useEffect(()=>{const at=Vt=>{if(u&&!H&&!st&&(Vt.key==="Escape"&&(Vt.preventDefault(),console.log(" [Auto-save Payments] Salvando ao fechar modal (ESC)..."),Se.current&&clearTimeout(Se.current),ln({autoSave:!0}).then(()=>{console.log(" [Auto-save Payments] Salvo ao fechar (ESC)!"),f()}).catch(wr=>{console.error(" [Auto-save Payments] Erro ao salvar ao fechar (ESC):",wr),f()})),Vt.key==="F8"&&(Vt.preventDefault(),m&&Ft>0&&wt()),Vt.key==="F9"&&(Vt.preventDefault(),Ft>0&&br()),Vt.key==="F10"&&(Vt.preventDefault(),Ft>0&&Yt()),Vt.key==="Delete")){const wr=document.activeElement;if(!(wr&&wr.tagName==="INPUT")){Vt.preventDefault();const Ze=mt();Ze!==null&&(Ge(Ze,""),setTimeout(()=>{ee.current[Ze]?.focus()},0))}}};return window.addEventListener("keydown",at),()=>window.removeEventListener("keydown",at)},[u,H,st,m,Ft,wt,br,Yt,R,ln,f,le,P,Et,Ge,mt]),p.useEffect(()=>{if(u){const at=mt();ie(at)}},[u,le,P,mt]),p.useEffect(()=>{if(u){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Modal aberto - payMethods:",x?.length||0,"initializedRef:",ht.current)}catch{}zt.current=setTimeout(()=>{try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Timeout de 3s acionado - initializedRef:",ht.current,"payMethods:",x?.length||0)}catch{}if(!ht.current&&(!x||x.length===0)){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Inicializando com timeout (sem finalizadoras)")}catch{}const at=(r?.selectedClients||[]).map(Vt=>{let wr=Vt.codigo;if(wr==null&&o&&Array.isArray(o)){const er=o.find(Ze=>Ze.id===Vt.id);wr=er?.codigo!==null&&er?.codigo!==void 0?er.codigo:null}return{cliente_id:Vt.id,nome:Vt.nome,codigo:wr,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:null,aplicar_taxa:!1}});se(at),ht.current=Date.now()}},3e3),!ht.current&&x&&x.length>0&&(zt.current&&(clearTimeout(zt.current),zt.current=null),(async()=>{const{defaultMethod:Vt,defaultFinalizadoraId:wr,defaultAplicarTaxa:er}=(()=>{const _r=Dt(),bt=_r?.id?String(_r.id):null,Wt=Number(_r?.taxa_percentual||0)>0;return{defaultMethod:_r,defaultFinalizadoraId:bt,defaultAplicarTaxa:Wt}})();let Ze=[],Fr="nenhuma";if(h?.id)try{const{data:_r,error:bt}=await fe.from("agendamento_participantes").select("*").eq("agendamento_id",h.id).eq("codigo_empresa",c?.codigo_empresa).order("ordem",{ascending:!0}).order("id",{ascending:!0});bt?console.error(" Erro ao buscar participantes:",bt):_r&&_r.length>0?(Ze=_r.map(Wt=>({cliente_id:Wt.cliente_id,nome:Wt.nome,codigo:null,valor_cota:Wt.valor_cota?Ps(String(Number(Wt.valor_cota).toFixed(2))):"0,00",status_pagamento:Wt.status_pagamento||"Pendente",finalizadora_id:Wt.finalizadora_id?String(Wt.finalizadora_id):wr,aplicar_taxa:Wt.aplicar_taxa||!1})),Fr="banco de dados"):Fr="banco vazio"}catch(_r){console.error(" Erro ao buscar participantes:",_r)}Ze.length===0&&g&&g.length>0?(Ze=g,Fr="participantsForm (contexto)"):Ze.length===0&&r?.selectedClients&&r.selectedClients.length>0&&(Ze=(r?.selectedClients||[]).map(_r=>{let bt=_r.codigo;if(bt==null&&o&&Array.isArray(o)){const Wt=o.find(Zt=>Zt.id===_r.id);bt=Wt?.codigo!==null&&Wt?.codigo!==void 0?Wt.codigo:null}return{cliente_id:_r.id,nome:_r.nome,codigo:bt,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:wr,aplicar_taxa:er}}),Fr="form.selectedClients");let jt=Ze.map(_r=>{let bt=_r.codigo;if(bt==null&&o&&Array.isArray(o)){const Zt=o.find(Br=>Br.id===_r.cliente_id);bt=Zt?.codigo!==null&&Zt?.codigo!==void 0?Zt.codigo:null}let Wt=_r.finalizadora_id;if(!Wt){const Zt=Dt();Wt=Zt?.id?String(Zt.id):null}return{..._r,codigo:bt??_r.codigo,finalizadora_id:Wt}});try{const _r=(r?.selectedClients||[]).slice();if(_r.length>0&&jt.length>0){const bt=new Map;jt.forEach(_t=>{const Jr=bt.get(_t.cliente_id)||[];Jr.push(_t),bt.set(_t.cliente_id,Jr)});const Wt=new Map,Zt=[];for(const _t of _r){const Jr=Wt.get(_t.id)||0,ma=(bt.get(_t.id)||[])[Jr];if(ma)Zt.push(ma),Wt.set(_t.id,Jr+1);else{const Nn=Dt(),re=Nn?.id?String(Nn.id):null;Zt.push({cliente_id:_t.id,nome:_t.nome,codigo:_t.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:re,aplicar_taxa:Number(Nn?.taxa_percentual||0)>0})}}const Br=new Map(Wt),zr=[];bt.forEach((_t,Jr)=>{const mn=Br.get(Jr)||0;for(let ma=mn;ma<_t.length;ma++)zr.push(_t[ma])}),Ze=Zt.concat(zr);try{const _t=Ze.findIndex(Jr=>String(Jr?.nome||"").toLowerCase()!=="cliente consumidor");if(_t>0){const Jr=Ze.splice(_t,1)[0];Ze.unshift(Jr),localStorage.getItem("debug:agenda")==="1"&&console.log("[REP] Promovido a representante:",Jr?.nome)}}catch{}Fr=Fr+" (reordenado pelos chips)"}}catch(_r){console.error("[PaymentModal] Falha ao reordenar por chips:",_r)}if(jt=Ze.map(_r=>{let bt=_r.codigo;if(bt==null&&o&&Array.isArray(o)){const Wt=o.find(Zt=>Zt.id===_r.cliente_id);bt=Wt?.codigo!==null&&Wt?.codigo!==void 0?Wt.codigo:null}return{..._r,codigo:bt??_r.codigo,finalizadora_id:_r.finalizadora_id||(()=>{const Wt=Dt();return Wt?.id?String(Wt.id):null})()}}),jt.length===0&&h?.id){console.error(" ALERTA CRTICO: Nenhum participante encontrado em NENHUMA fonte!"),console.error(" Agendamento ID:",h.id),console.error(" Empresa:",c?.codigo_empresa),console.error(" Isso pode indicar perda de dados!");try{const{data:_r,error:bt}=await fe.from("agendamento_participantes").select("*").eq("agendamento_id",h.id);console.error(" Busca sem filtro de empresa:",{encontrados:_r?.length||0,dados:_r,erro:bt})}catch(_r){console.error(" Erro na busca de debug:",_r)}}if(jt.length>0||!h?.id){se(jt),ht.current=Date.now();try{if(localStorage.getItem("debug:agenda")==="1"){console.log(" [LOG 1 - ABRIR PAYMENT MODAL] Participantes carregados:"),console.log("   Total:",jt.length),console.log("   Fonte:",Fr),jt.forEach((Wt,Zt)=>{console.log(`   #${Zt+1}: ${Wt.nome} | Status: ${Wt.status_pagamento} | Valor: ${Wt.valor_cota}`)});const _r=(r?.selectedClients||[]).map(Wt=>Wt.id),bt=jt.map(Wt=>Wt.cliente_id);console.log("[ORDER] chipsIds:",_r),console.log("[ORDER] finalIds:",bt)}}catch{}}else console.error(" BLOQUEADO: No vou sobrescrever com array vazio!"),console.error(" Mantendo dados anteriores para evitar perda.")})())}else zt.current&&(clearTimeout(zt.current),zt.current=null),A(""),I(null),F([]),se([]);return()=>{zt.current&&clearTimeout(zt.current)}},[u,x,Dt,g,r?.selectedClients,o]),p.useEffect(()=>{if(!u)return;const at=(le||[]).length;if(Xt.current==null){Xt.current=at,nr.current=Array.isArray(le)?le:[];return}const Vt=at<Xt.current;let wr=[];try{const er=Array.isArray(nr.current)?nr.current:[],Ze=Array.isArray(le)?le:[],Fr=_r=>`${_r?.cliente_id??""}|${(_r?.nome??"").toLowerCase()}`,jt=new Set(Ze.map(Fr));wr=er.filter(_r=>!jt.has(Fr(_r)))}catch{}Xt.current=at,nr.current=Array.isArray(le)?le:[],Vt&&h?.id&&(Se.current&&(clearTimeout(Se.current),Se.current=null),Lt.current=!0,(async()=>{try{const er=wr.map(Fr=>Fr?.nome).filter(Boolean),Ze=wr.length;console.log(" [PaymentModal] Participante(s) removido(s):",er),console.log(" [Auto-save imediato] Remoo detectada, salvando agora...");try{window.dispatchEvent(new CustomEvent("payments:participant-removed",{detail:{agendamentoId:h?.id,removed:wr}}))}catch{}await ln({autoSave:!0}),console.log(" [Auto-save imediato] Remoo salva")}catch(er){console.error(" [Auto-save imediato] Erro ao salvar aps remoo:",er)}})())},[u,le,h?.id,ln]),p.useEffect(()=>{if(!u)return;const at=p.useRef.__prevHidden=p.useRef.__prevHidden||{len:0},Vt=(P||[]).length,wr=Vt>(at.len||0);if(at.len=Vt,wr&&h?.id){try{console.log(" [PaymentModal] ndices ocultados (remoo lgica):",P)}catch{}Se.current&&(clearTimeout(Se.current),Se.current=null),Lt.current=!0,ln({autoSave:!0}).catch(er=>console.error(" [PaymentModal] Erro ao salvar remoo imediata:",er))}},[P,u,h?.id,ln]),p.useEffect(()=>{ht.current=null},[h?.id]),p.useEffect(()=>(j.current=at=>{ge([at]),setTimeout(()=>{ge([])},1e3)},()=>{j.current=null}),[j]);const Fn=p.useCallback(at=>{se(at)},[]);p.useEffect(()=>(u&&(y.updateLocal=Fn,y.getLocal=()=>le),()=>{y.updateLocal&&(delete y.updateLocal,delete y.getLocal)}),[u,Fn,le]),p.useLayoutEffect(()=>{if(!u)return;const at=(r?.selectedClients||[]).slice();if(at.length!==0&&!(!le||le.length===0))try{const Vt=new Map;le.forEach(bt=>{const Wt=Vt.get(bt.cliente_id)||[];Wt.push(bt),Vt.set(bt.cliente_id,Wt)});const wr=new Map,er=[];for(const bt of at){const Wt=wr.get(bt.id)||0,Br=(Vt.get(bt.id)||[])[Wt];Br?(er.push(Br),wr.set(bt.id,Wt+1)):er.push({cliente_id:bt.id,nome:bt.nome,codigo:bt.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:Dt()?.id?String(Dt().id):null,aplicar_taxa:Number(Dt()?.taxa_percentual||0)>0})}const Ze=new Map(wr),Fr=[];Vt.forEach((bt,Wt)=>{const Zt=Ze.get(Wt)||0;for(let Br=Zt;Br<bt.length;Br++)Fr.push(bt[Br])});const jt=er.concat(Fr);if(jt.length!==le.length||jt.some((bt,Wt)=>bt.cliente_id!==le[Wt]?.cliente_id||bt.nome!==le[Wt]?.nome)){try{if(localStorage.getItem("debug:agenda")==="1"){const bt=at.map(Zt=>Zt.nome),Wt=jt.map(Zt=>Zt.nome);console.log("[ORDER] chipsNames:",bt),console.log("[ORDER] finalNames (next):",Wt)}}catch{}se(jt)}}catch(Vt){console.error("[PaymentModal] Falha ao reordenar aps mudana de chips:",Vt)}},[u,r?.selectedClients]),p.useEffect(()=>{H||(pe([]),z("")),V(0)},[H]),p.useEffect(()=>{H&&Mt.current[be]&&Mt.current[be]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[be,H]),p.useEffect(()=>{const at=Vt=>{if(H&&(Vt.key==="Escape"&&(Vt.preventDefault(),q(!1),z(""),pe([])),Vt.key==="Enter"&&Vt.target.tagName!=="INPUT"&&Q.length>0)){Vt.preventDefault();const wr=Q.map(er=>({cliente_id:er.id,nome:er.nome,codigo:er.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const Ze=Dt();return Ze?.id?String(Ze.id):null})(),aplicar_taxa:(()=>{const Ze=Dt();return Number(Ze?.taxa_percentual||0)>0})()}));se(er=>{const Ze=er.length,Fr=wr.map((jt,_r)=>Ze+_r);return ge(Fr),setTimeout(()=>{ge([])},1e3),[...er,...wr]}),q(!1),pe([]),z("")}};return window.addEventListener("keydown",at),()=>window.removeEventListener("keydown",at)},[H,Q,Dt,se,l,z,q,pe]),p.useEffect(()=>{const at=async()=>{try{if(!u)return;Se.current&&(clearTimeout(Se.current),Se.current=null),R||await ln({autoSave:!0})}catch(Vt){console.error("[PaymentModal] save-and-close erro:",Vt)}finally{f();try{window.dispatchEvent(new Event("paymentmodal:closed"))}catch{}}};return window.addEventListener("paymentmodal:save-and-close",at),()=>window.removeEventListener("paymentmodal:save-and-close",at)},[u,ln,f]),p.useEffect(()=>{if(!u){console.log(" [AUTO-SAVE] Modal de pagamentos fechado - desabilitando auto-save"),console.log(" [AUTO-SAVE] Estado final ao fechar:",{localParticipantsForm:le.map(Vt=>({nome:Vt.nome,status:Vt.status_pagamento,valor:Vt.valor_cota})),timestamp:new Date().toISOString()}),Lt.current=!1,kt.current=null;return}if(!Lt.current){console.log(" [AUTO-SAVE] Inicializando auto-save (aguardando 500ms)");const Vt=setTimeout(()=>{Lt.current=!0,kt.current=JSON.stringify(le),console.log(" [AUTO-SAVE] Auto-save habilitado")},500);return()=>clearTimeout(Vt)}const at=JSON.stringify(le);if(at!==kt.current)return console.log(" [AUTO-SAVE] Mudana detectada - agendando salvamento em 1.5s"),Se.current&&(console.log(" [AUTO-SAVE] Cancelando auto-save anterior"),clearTimeout(Se.current)),Se.current=setTimeout(async()=>{console.log(" [AUTO-SAVE] Iniciando auto-save AGORA"),console.log(" [AUTO-SAVE] Participantes a salvar:",le.length),yr(!0);try{await ln({autoSave:!0}),kt.current=at,console.log(" [AUTO-SAVE] Salvo com sucesso!")}catch(Vt){console.error(" [AUTO-SAVE] Erro ao salvar:",Vt)}finally{yr(!1)}},1500),()=>{Se.current&&clearTimeout(Se.current)}},[u,le,ln]),p.useEffect(()=>{!st&&Be&&(console.log(" [PDF] Revogando URL do blob ao fechar modal"),URL.revokeObjectURL(Be),we(null))},[st,Be]);const Hn=p.useRef(null),$n=async()=>{try{if(console.log(" [PDF] Iniciando gerao do PDF"),!Hn.current)throw new Error("Elemento do relatrio no encontrado");console.log(" [PDF] Abrindo modal de download"),Be&&URL.revokeObjectURL(Be),ut(!0),Nt("downloading"),he(0),et(null),we(null),$e("");const at=(le||[]).filter((re,Te)=>!(P||[]).includes(Te)),Vt=20,wr=Math.ceil(at.length/Vt);he(5);const er=new Vn({orientation:"landscape",unit:"mm",format:"a4",compress:!0}),Ze=297,Fr=210;for(let re=0;re<wr;re++){const Te=re*Vt,ot=Math.min(Te+Vt,at.length),te=at.slice(Te,ot),T=10+Math.floor(re/wr*80);he(T);const O=Hn.current;if(!O)throw new Error("Elemento do relatrio no encontrado durante a gerao");console.log(` [PDF] Capturando pgina ${re+1}/${wr} (participantes ${Te+1}-${ot})`);const X={visibility:O.style.visibility,opacity:O.style.opacity};O.style.visibility="visible",O.style.opacity="1",console.log(` [PDF] Elemento innerHTML length: ${O.innerHTML.length}`),console.log(` [PDF] Elemento scrollHeight: ${O.scrollHeight}`),console.log(` [PDF] Elemento scrollWidth: ${O.scrollWidth}`);const G=O.querySelector('div[style*="borderBottom"]'),L=O.querySelectorAll('div[style*="borderBottom"]')[1];re>0?(G&&(G.style.display="none"),L&&(L.style.display="none")):(G&&(G.style.display="block"),L&&(L.style.display="flex"));const Re=O.querySelectorAll("tbody tr");console.log(` [PDF] Total de linhas na tabela: ${Re.length}`),Re.forEach((Sr,kr)=>{Sr.style.display=kr>=Te&&kr<ot?"table-row":"none"});const rt=O.querySelector("#page-indicator");rt&&(rt.textContent=`Pgina ${re+1} de ${wr}`),console.log(" [PDF] Forando reflow..."),O.offsetHeight,O.getBoundingClientRect(),O.scrollHeight,O.offsetWidth,O.clientHeight,console.log(" [PDF] Aguardando renderizao..."),await new Promise(Sr=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(Sr,2e3)})})})}),console.log(" [PDF] Renderizao completa, iniciando captura...");const lt=O.querySelectorAll("tbody tr");if(console.log(` [PDF] Linhas da tabela encontradas: ${lt.length}`),lt.forEach((Sr,kr)=>{const pr=Sr.querySelectorAll("td"),yn=Array.from(pr).map(In=>In.textContent.trim()).join(" | ");console.log(` [PDF] Linha ${kr+1}: ${yn}`)}),lt.length===0){console.warn(" [PDF] AVISO: Nenhuma linha de tabela encontrada! Verificando estrutura...");const Sr=O.querySelector("tbody");console.log(" [PDF] tbody existe:",!!Sr),Sr&&console.log(" [PDF] innerHTML do tbody:",Sr.innerHTML.substring(0,500))}let $t;try{const Sr=O.scrollHeight,kr=O.scrollWidth;if(console.log(` [PDF] Dimenses reais: width=${kr}px, height=${Sr}px`),$t=await XKe(O,{pixelRatio:2,backgroundColor:"#ffffff",cacheBust:!0,skipFonts:!1}),!$t||$t.length===0)throw new Error("Canvas vazio retornado pela captura");console.log(` [PDF] Pgina ${re+1} capturada (${$t.length} bytes, ${Sr}px altura, ${lt.length} linhas)`)}catch(Sr){throw console.error(` [PDF] Erro ao capturar pgina ${re+1}:`,Sr),O.style.visibility=X.visibility,O.style.opacity=X.opacity,new Error(`Falha ao capturar pgina ${re+1}: ${Sr.message}`)}O.style.visibility=X.visibility,O.style.opacity=X.opacity,re>0&&er.addPage();const Fe=Ze,It=O.scrollHeight/O.scrollWidth*Ze;er.addImage($t,"PNG",0,0,Fe,It,"","MEDIUM"),console.log(` [PDF] Pgina ${re+1} adicionada ao PDF (${Fe}mm x ${It}mm)`)}if(Hn.current){Hn.current.querySelectorAll("tbody tr").forEach(ot=>{ot.style.display="table-row"});const Te=Hn.current.querySelector("#page-indicator");Te&&(Te.textContent="")}he(95);const jt=wr>1?` (${wr} pginas)`:"",_r=(le||[]).filter((re,Te)=>!(P||[]).includes(Te));let bt=_r.find(re=>!o?.find(ot=>ot.id===re.cliente_id)?.is_consumidor_final);!bt&&_r.length>0&&(bt=_r[0]);const Zt=(bt?.nome||"sem-nome").trim().split(/\s+/),Br=Zt[0]||"sem",zr=Zt.length>1?Zt[Zt.length-1]:"nome",Jr=`rel-${`${Br}-${zr}`.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+|-+$/g,"")}-${h?.code||"0"}${jt}.pdf`,mn=er.output("blob"),ma=URL.createObjectURL(mn);et(mn),we(ma),$e(Jr),he(100);const Nn=document.createElement("a");Nn.href=ma,Nn.download=Jr,Nn.click(),await new Promise(re=>setTimeout(re,500)),console.log(" [PDF] PDF gerado com sucesso! Modal de download deve permanecer aberto."),console.log(" [PDF] isPaymentModalOpen deve continuar true"),Nt("success"),console.log(" [PDF] Status atualizado para success")}catch(at){console.error(" [PDF] Erro ao gerar PDF:",at),ut(!1),l({title:"Erro ao gerar PDF",description:at?.message||"No foi possvel gerar o PDF.",variant:"destructive"})}};return a.jsxs(a.Fragment,{children:[a.jsx(xn,{open:u,onOpenChange:at=>{if(console.log(" [PaymentModal] onOpenChange chamado:",{open:at,isDownloadModalOpen:st}),!at){if(console.log(" [PaymentModal] Tentando fechar modal de pagamentos"),st){console.log(" [PaymentModal] BLOQUEADO: Modal de download est aberto");return}console.log(" [PaymentModal] Fechando modal de pagamentos"),f()}},children:a.jsx(vn,{forceMount:!0,className:"w-full max-w-[95vw] sm:max-w-[1100px] max-h-[90vh] overflow-y-auto overflow-x-hidden",onOpenAutoFocus:at=>at.preventDefault(),onInteractOutside:async at=>{const Vt=Date.now(),wr=ht.current?Vt-ht.current:0,er=Vt-_;if(console.log(" [PaymentModal] onInteractOutside disparado:",{target:at.target?.tagName,className:at.target?.className?.substring?.(0,50),timeSinceInit:`${wr}ms`,timeSinceVisibility:`${er}ms`,isAddParticipantOpen:H,isDownloadModalOpen:st,statusConfirmationOpen:ir.isOpen,isModalProtected:C,timestamp:new Date().toISOString()}),ir.isOpen){console.log(" [PaymentModal] Bloqueado: modal de confirmao de status est aberto"),at.preventDefault();return}if(st){console.log(" [PaymentModal] Bloqueado: modal de download est aberto"),at.preventDefault();return}if(C){console.log(" [PaymentModal] Bloqueado: modal protegido (protectPaymentModal ativo)"),at.preventDefault();return}if(H){console.log(" [PaymentModal] Bloqueado: modal de adicionar participante aberto"),at.preventDefault();return}if(ht.current&&wr<500){console.log(" [PaymentModal] Bloqueado: modal abriu recentemente"),at.preventDefault();return}if(er<3e3){console.log(` [PaymentModal] Bloqueado: mudana de visibilidade recente (${er}ms atrs)`),at.preventDefault();return}at.preventDefault(),console.log(" [Auto-save Payments] Salvando ao clicar fora do modal...");try{if(Se.current&&(console.log(" [Auto-save Payments] Cancelando auto-save pendente antes de salvar ao clicar fora"),clearTimeout(Se.current),Se.current=null),R){console.log(" [Auto-save Payments] J est salvando - ignorando novo salvamento ao clicar fora"),f();return}await ln({autoSave:!0}),console.log(" [Auto-save Payments] Salvo ao clicar fora!")}catch(Ze){console.error(" [Auto-save Payments] Erro ao salvar ao clicar fora:",Ze)}finally{f()}},onEscapeKeyDown:at=>{at.preventDefault()},children:!x||x.length===0?ht.current?a.jsxs(a.Fragment,{children:[a.jsxs(pn,{className:"sr-only",children:[a.jsx(fn,{children:"Aviso"}),a.jsx(On,{children:"Nenhuma forma de pagamento cadastrada"})]}),a.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[a.jsx(qf,{className:"w-12 h-12 text-amber-500"}),a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("p",{className:"font-semibold text-amber-500",children:"Nenhuma forma de pagamento cadastrada"}),a.jsx("p",{className:"text-sm text-text-muted",children:"Cadastre pelo menos uma finalizadora para gerenciar pagamentos."})]}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsx(ce,{type:"button",variant:"outline",onClick:f,children:"Fechar"}),a.jsx(n4,{to:"/finalizadoras",children:a.jsx(ce,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:f,children:"Cadastrar Finalizadora"})})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs(pn,{className:"sr-only",children:[a.jsx(fn,{children:"Carregando"}),a.jsx(On,{children:"Carregando formas de pagamento"})]}),a.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"}),a.jsx("p",{className:"text-sm text-text-muted",children:"Carregando formas de pagamento..."})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(pn,{className:"relative pb-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-3 sm:gap-4",children:[a.jsxs("div",{className:"flex-1 w-full sm:w-auto",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(fn,{children:"Registrar pagamento"}),fr&&a.jsxs("span",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs bg-blue-600/10 text-blue-400 border-blue-700/30",children:[a.jsxs("svg",{className:"w-3 h-3 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]})]}),a.jsx(On,{children:"As alteraes so salvas automaticamente enquanto voc edita."})]}),a.jsxs(ce,{type:"button",variant:"outline",size:"sm",onClick:$n,className:"flex-shrink-0 gap-2 w-full sm:w-auto mt-2 sm:mt-0",title:"Baixar relatrio como imagem",children:[a.jsx(ms,{className:"w-4 h-4"}),a.jsx("span",{children:"Baixar Relatrio"})]})]})}),a.jsxs("div",{className:"space-y-3 sm:space-y-6",children:[a.jsxs("div",{className:"sm:hidden space-y-2 max-w-md mx-auto",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"p-2 rounded-lg bg-emerald-600/10 border border-emerald-500/30 min-w-0 relative group",children:[a.jsx("div",{className:"text-[10px] text-emerald-300/80 mb-1 truncate",children:"Total"}),B?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Je,{type:"text",value:ue,onChange:at=>Ne(Ps(at.target.value)),className:"w-full h-6 text-xs text-center font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300 px-1",placeholder:"0,00",autoFocus:!0,onKeyDown:at=>{at.key==="Enter"&&ue!==m?Rr():at.key==="Escape"&&Er()},onBlur:()=>{ue!==m?Rr():Er()}}),ue!==m&&a.jsx("button",{onMouseDown:at=>at.preventDefault(),onClick:Rr,className:"p-0.5 rounded hover:bg-emerald-500/20 transition-colors flex-shrink-0",title:"Confirmar",children:a.jsx(zf,{className:"w-3 h-3 text-emerald-400"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-bold text-emerald-400 truncate",children:Ps(m)||"R$ 0,00"}),a.jsx("button",{onClick:Nr,className:"absolute right-1 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-emerald-500/20 transition-colors",title:"Editar",children:a.jsx(fl,{className:"w-3 h-3 text-emerald-400"})})]})]}),a.jsxs("div",{className:`p-2 rounded-lg border min-w-0 ${ye.diff===0?"bg-emerald-600/10 border-emerald-500/30":ye.diff>0?"bg-amber-600/10 border-amber-500/30":"bg-rose-600/10 border-rose-500/30"}`,children:[a.jsx("div",{className:`text-[10px] mb-1 truncate ${ye.diff===0?"text-emerald-300/80":ye.diff>0?"text-amber-300/80":"text-rose-300/80"}`,children:"Diferena"}),a.jsxs("div",{className:`text-sm font-bold truncate ${ye.diff===0?"text-emerald-400":ye.diff>0?"text-amber-400":"text-rose-400"}`,children:[ye.diff>0?"+":"",Ps(String(Math.abs(ye.diff).toFixed(2)))]})]})]}),a.jsxs("div",{className:"flex gap-1.5 text-xs justify-center",children:[a.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[a.jsx("span",{className:"text-text-secondary",children:"Participantes:"})," ",a.jsx("strong",{children:Ft})]}),a.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[a.jsx("span",{className:"text-text-secondary",children:"Atribudo:"})," ",a.jsxs("strong",{children:["R$ ",ye.totalAssigned.toFixed(2)]})]}),a.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[a.jsx("span",{className:"text-text-secondary",children:"Alvo:"})," ",a.jsxs("strong",{children:["R$ ",ye.totalTarget.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx(ce,{type:"button",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white text-xs h-8 px-3",onClick:wt,disabled:!m||Ft===0,children:(()=>{const at=ji(m);if(Number.isFinite(at)&&Ft>0){const Vt=at/Ft;return`Dividir (${Ps(String(Vt.toFixed(2)))})`}return"Dividir"})()}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 text-xs h-8 px-3 flex-1",onClick:br,disabled:Ft===0,children:"Aplicar taxas"}),a.jsx(ce,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 text-xs h-8 px-3 flex-1",onClick:Yt,disabled:Ft===0,children:"Zerar"})]})]})]}),a.jsx("div",{className:"hidden sm:block p-4 rounded-lg border border-border bg-gradient-to-br from-surface-2 to-surface shadow-md",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-start gap-3 w-full",children:[a.jsxs("div",{className:"flex flex-row gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(De,{className:"font-bold text-base text-white",children:"Valor total a receber"}),a.jsx("div",{className:"w-[180px] px-3 py-2 rounded-md bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-2 border-emerald-500/40 shadow-lg flex items-center justify-center gap-2 relative group",children:B?a.jsxs(a.Fragment,{children:[a.jsx(Je,{type:"text",value:ue,onChange:at=>Ne(Ps(at.target.value)),className:"w-full h-8 text-center text-lg font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300",placeholder:"0,00",autoFocus:!0,onKeyDown:at=>{at.key==="Enter"&&ue!==m?Rr():at.key==="Escape"&&Er()},onBlur:()=>{ue!==m?Rr():Er()}}),ue!==m&&a.jsx("button",{onMouseDown:at=>at.preventDefault(),onClick:Rr,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors",title:"Confirmar (Enter)",children:a.jsx(zf,{className:"w-4 h-4 text-emerald-400"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-xl font-bold text-emerald-400",children:Ps(m)||"R$ 0,00"}),a.jsx("button",{onClick:Nr,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors opacity-0 group-hover:opacity-100",title:"Editar valor total",children:a.jsx(fl,{className:"w-4 h-4 text-emerald-400"})})]})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(De,{className:"font-bold text-base text-white",children:"Diferena"}),a.jsx("div",{className:`w-[180px] px-3 py-2 rounded-md border-2 shadow-lg flex items-center justify-center ${ye.diff===0?"bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-emerald-500/40":ye.diff>0?"bg-gradient-to-br from-amber-600/20 to-amber-700/20 border-amber-500/40":"bg-gradient-to-br from-rose-600/20 to-rose-700/20 border-rose-500/40"}`,children:a.jsxs("span",{className:`text-xl font-bold ${ye.diff===0?"text-emerald-400":ye.diff>0?"text-amber-400":"text-rose-400"}`,children:[ye.diff>0?"+":"",Ps(String(Math.abs(ye.diff).toFixed(2)))]})})]})]}),a.jsxs("div",{className:"ml-auto flex flex-col gap-3 items-end",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[a.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),a.jsx("strong",{children:Ft})]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[a.jsx("span",{className:"text-text-secondary",children:"Atribudo:"}),a.jsxs("strong",{children:["R$ ",ye.totalAssigned.toFixed(2)]})]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[a.jsx("span",{className:"text-text-secondary",children:"Alvo:"}),a.jsxs("strong",{children:["R$ ",ye.totalTarget.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsx(ce,{type:"button",variant:"secondary",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white flex-shrink-0",onClick:wt,disabled:!m||Ft===0,children:(()=>{const at=ji(m);if(Number.isFinite(at)&&Ft>0){const Vt=at/Ft;return a.jsxs(a.Fragment,{children:["Dividir igualmente (",Ps(String(Vt.toFixed(2)))," cada)",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})}return a.jsxs(a.Fragment,{children:["Dividir igualmente",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})})()}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ce,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 flex-1 sm:flex-initial whitespace-nowrap",onClick:br,disabled:Ft===0,children:["Aplicar taxas",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-amber-700/50 rounded border border-amber-500/30",children:"F9"})]}),a.jsxs(ce,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 flex-1 sm:flex-initial",onClick:Yt,disabled:Ft===0,children:["Zerar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"F10"})]})]})]})]})]})}),(r.selectedClients||[]).length===0?a.jsx("div",{className:"text-xs text-text-muted italic",children:'Nenhum participante neste agendamento. Adicione participantes no campo "Clientes" do modal principal.'}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs("div",{className:"relative flex-1 min-w-0",children:[a.jsx(Je,{ref:He,type:"text",placeholder:"Buscar participante...",value:E,onChange:at=>A(at.target.value),className:"pr-16"}),a.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-amber-400 hover:text-amber-300",onClick:()=>{A(""),He.current?.focus()},children:"limpar"})]}),a.jsxs(ce,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md flex-shrink-0",onClick:at=>{at.preventDefault(),at.stopPropagation(),w(2e3),q(!0)},children:[a.jsx("span",{className:"hidden sm:inline",children:"Adicionar participante +"}),a.jsx("span",{className:"sm:hidden",children:"Participante +"})]})]}),M?.type==="pending"&&a.jsxs("div",{role:"alert",className:"mb-2 rounded-md border border-amber-600/40 bg-amber-500/10 px-3 py-2 text-amber-200 flex items-start gap-3",children:[a.jsx(qf,{className:"w-4 h-4 text-amber-300 mt-0.5"}),a.jsxs("div",{className:"flex-1 text-sm",children:[a.jsx("strong",{children:"Ateno:"})," Existem ",a.jsx("strong",{children:M.count})," participante(s) com status ",a.jsx("strong",{children:"Pendente"}),"."]}),a.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded bg-amber-500/20 hover:bg-amber-500/30 border border-amber-600/40",onClick:()=>I(null),children:"Entendi"})]}),a.jsx("div",{className:"border border-border rounded-md overflow-hidden",children:a.jsx("div",{className:"divide-y divide-border max-h-[50vh] overflow-y-scroll",children:(()=>{const at=E.trim().toLowerCase(),Vt=P||[],er=(le||[]).map((Ze,Fr)=>({...Ze,_originalIndex:Fr})).filter(Ze=>!Vt.includes(Ze._originalIndex)).filter(Ze=>!at||String(Ze?.nome||"").toLowerCase().includes(at));return er.length===0?a.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum participante com esse nome"}):er.map(Ze=>{const Fr=`participant-${Ze._originalIndex}`,jt=Ze._originalIndex,_r=Z.includes(jt);return a.jsxs("div",{className:`p-2 sm:p-3 border-b last:border-b-0 transition-all duration-500 ease-out ${_r?"bg-white/10":""}`,children:[a.jsxs("div",{className:"sm:hidden space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[Ze.codigo!==null&&Ze.codigo!==void 0&&a.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${Ze.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",Ze.codigo]}),Et(Ze.cliente_id)?a.jsxs("div",{className:"relative flex-1 min-w-0",children:[a.jsx("input",{ref:bt=>{bt&&(ee.current[jt]=bt)},type:"text",value:Ze.nome||"",onChange:bt=>Ge(jt,bt.target.value),onFocus:()=>At(jt),onKeyDown:bt=>{if(bt.key==="Enter"){bt.preventDefault();const Wt=gt(jt);Wt!==null&&setTimeout(()=>{ee.current[Wt]?.focus()},0)}else if(bt.key==="Delete"&&Ze.nome&&bt.target===document.activeElement)bt.preventDefault(),bt.stopPropagation(),Ge(jt,""),setTimeout(()=>{ee.current[jt]?.focus()},0);else if(bt.key==="ArrowDown"){bt.preventDefault();const Wt=gt(jt);Wt!==null&&setTimeout(()=>{ee.current[Wt]?.focus()},0)}else if(bt.key==="ArrowUp"){bt.preventDefault();const Wt=ft(jt);Wt!==null&&setTimeout(()=>{ee.current[Wt]?.focus()},0)}},onBlur:async()=>{At(null),!Ze.nome&&Le.current[jt]&&Qe(jt);try{Se.current&&clearTimeout(Se.current),await ln({autoSave:!0})}catch(bt){console.error("[PaymentModal] Erro ao salvar ao sair do nome consumidor (compacto):",bt)}},placeholder:"Nome do cliente...",className:"font-medium text-sm bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded px-2 py-0.5 pr-11 focus:border-white/30 focus:outline-none focus:ring-1 focus:ring-white/20 w-full",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),Ze.nome?a.jsx("button",{type:"button",onClick:()=>{Ge(jt,""),setTimeout(()=>{ee.current[jt]?.focus()},0)},className:`absolute right-1 top-1/2 -translate-y-1/2 px-1.5 py-0.5 text-[10px] font-bold border rounded transition-all ${dt===jt||!dt&&ae===jt?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/20":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20"}`,title:dt===jt||!dt&&ae===jt?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):Le.current[jt]?a.jsx("button",{type:"button",onClick:()=>Qe(jt),className:"absolute right-1 top-1/2 -translate-y-1/2 p-1 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all",title:"Restaurar ltimo nome",children:a.jsx(OF,{className:"w-3 h-3"})}):null]}):a.jsx("span",{className:"font-medium text-sm truncate",children:Ze.nome})]}),a.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[a.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>Mr(jt,Ze.nome),title:"Trocar",children:a.jsx(fl,{className:"w-4 h-4"})}),a.jsx(ce,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400 h-6 w-6 p-0",onClick:()=>{F(bt=>[...bt,jt])},children:""})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{children:[a.jsx(De,{className:"text-[10px] text-text-muted",children:"Mtodo"}),a.jsxs(Cn,{value:String(Ze.finalizadora_id||""),onValueChange:bt=>{se(Wt=>{const Zt=[...Wt];if(jt>=0&&jt<Zt.length){const Br=x.find(_t=>String(_t.id)===String(bt)),zr=Number(Br?.taxa_percentual||0)>0;Zt[jt]={...Zt[jt],finalizadora_id:bt,aplicar_taxa:zr?Zt[jt].aplicar_taxa??!0:!1}}return Zt})},children:[a.jsx(jn,{className:"h-8 text-xs",children:a.jsx(An,{placeholder:"Mtodo"})}),a.jsx(_n,{children:x.map(bt=>a.jsx(nt,{value:String(bt.id),children:bt.nome||bt.tipo||"Outros"},bt.id))})]}),(()=>{const bt=x.find(zr=>String(zr.id)===String(Ze.finalizadora_id)),Wt=Number(bt?.taxa_percentual||0);if(Wt<=0)return a.jsx("div",{className:"h-4 mt-1"});const Zt=ji(Ze.valor_cota),Br=Number.isFinite(Zt)&&Zt>0;return a.jsxs("label",{className:`flex items-center gap-1.5 mt-1 text-[11px] ${Br?"cursor-pointer":"cursor-not-allowed opacity-50"}`,title:Br?`Taxa de ${Wt.toFixed(2)}%`:"Informe o valor primeiro",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:!!Ze.aplicar_taxa,disabled:!Br,onChange:zr=>{if(!Br){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}se(_t=>{const Jr=[..._t];if(jt>=0&&jt<Jr.length){const mn=zr.target.checked;let ma=Zt;mn?ma=Zt*(1+Wt/100):ma=Zt/(1+Wt/100),Jr[jt]={...Jr[jt],aplicar_taxa:mn,valor_cota:Ps(ma.toFixed(2))}}return Jr})},style:{accentColor:"#f59e0b"}}),a.jsxs("span",{className:"text-amber-500 font-medium",children:["Taxa (",Wt.toFixed(2),"%)"]})]})})()]}),a.jsxs("div",{className:"isolate",children:[a.jsx(De,{className:"text-[10px] text-text-muted",children:"Valor"}),a.jsx(Je,{ref:bt=>{bt&&(de.current[jt]=bt)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:Ps(Ze.valor_cota),onChange:bt=>{const Wt=Ps(bt.target.value),Zt=ji(Wt),Br=Number.isFinite(Zt)&&Zt>0?"Pago":"Pendente";se(zr=>{const _t=[...zr];return jt>=0&&jt<_t.length&&(_t[jt]={..._t[jt],valor_cota:Wt,status_pagamento:Br,aplicar_taxa:Wt===""||Zt<=0?!1:_t[jt].aplicar_taxa}),_t})},className:"h-8 text-xs text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})]})]}),a.jsx("div",{className:"flex justify-end",children:(()=>{const bt=Ze.status_pagamento==="Pago",Wt=Number.isFinite(ji(Ze.valor_cota))&&ji(Ze.valor_cota)>0,Zt=bt&&Wt;return a.jsx("button",{type:"button",onClick:()=>St(jt,Ze.status_pagamento,Ze.valor_cota),disabled:Zt,className:`inline-flex items-center justify-center px-3 py-0.5 rounded text-xs font-medium border transition-all ${bt&&Wt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":bt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:Zt?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:bt?"Pago":"Pendente"})})()})]}),a.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex items-center gap-2",children:[Ze.codigo!==null&&Ze.codigo!==void 0&&a.jsxs("span",{className:`text-sm font-bold rounded-md px-2.5 py-1 shadow-sm ${Ze.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",Ze.codigo]}),Et(Ze.cliente_id)?a.jsxs("div",{className:"relative",children:[a.jsx("input",{ref:bt=>{bt&&(ee.current[jt]=bt)},type:"text",value:Ze.nome||"",onChange:bt=>Ge(jt,bt.target.value),onFocus:()=>At(jt),onKeyDown:bt=>{if(bt.key==="Enter"){bt.preventDefault();const Wt=gt(jt);Wt!==null&&setTimeout(()=>{ee.current[Wt]?.focus()},0)}else if(bt.key==="Delete"&&Ze.nome&&bt.target===document.activeElement)bt.preventDefault(),bt.stopPropagation(),Ge(jt,""),setTimeout(()=>{ee.current[jt]?.focus()},0);else if(bt.key==="ArrowDown"){bt.preventDefault();const Wt=gt(jt);Wt!==null&&setTimeout(()=>{ee.current[Wt]?.focus()},0)}else if(bt.key==="ArrowUp"){bt.preventDefault();const Wt=ft(jt);Wt!==null&&setTimeout(()=>{ee.current[Wt]?.focus()},0)}},onBlur:async()=>{At(null),!Ze.nome&&Le.current[jt]&&Qe(jt);try{Se.current&&clearTimeout(Se.current),await ln({autoSave:!0})}catch(bt){console.error("[PaymentModal] Erro ao salvar ao sair do nome consumidor (normal):",bt)}},placeholder:"Nome do cliente...",className:"font-medium text-base bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded-md px-3 py-1.5 pr-14 focus:border-white/30 focus:outline-none focus:ring-2 focus:ring-white/20 min-w-[200px] max-w-[300px]",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),Ze.nome?a.jsx("button",{type:"button",onClick:()=>{Ge(jt,""),setTimeout(()=>{ee.current[jt]?.focus()},0)},className:`absolute right-2 top-1/2 -translate-y-1/2 px-2 py-1 text-xs font-bold border rounded transition-all ${dt===jt||!dt&&ae===jt?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/30":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20 shadow-sm"}`,title:dt===jt||!dt&&ae===jt?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):Le.current[jt]?a.jsx("button",{type:"button",onClick:()=>Qe(jt),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all shadow-sm",title:"Restaurar ltimo nome",children:a.jsx(OF,{className:"w-4 h-4"})}):null]}):a.jsx("span",{className:"font-medium text-base",children:Ze.nome}),a.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>Mr(jt,Ze.nome),title:"Trocar participante",children:a.jsx(fl,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"isolate",children:a.jsx(Je,{ref:bt=>{bt&&(de.current[jt]=bt)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:Ps(Ze.valor_cota),onChange:bt=>{const Wt=Ps(bt.target.value),Zt=ji(Wt),Br=Number.isFinite(Zt)&&Zt>0?"Pago":"Pendente";se(zr=>{const _t=[...zr];return jt>=0&&jt<_t.length&&(_t[jt]={..._t[jt],valor_cota:Wt,status_pagamento:Br,aplicar_taxa:Wt===""||Zt<=0?!1:_t[jt].aplicar_taxa}),_t})},className:"w-28 text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})}),a.jsxs("div",{className:"flex items-center gap-2 min-w-[240px] isolate",children:[a.jsxs(Cn,{value:String(Ze.finalizadora_id||""),onValueChange:bt=>{se(Wt=>{const Zt=[...Wt];if(jt>=0&&jt<Zt.length){const Br=x.find(_t=>String(_t.id)===String(bt)),zr=Number(Br?.taxa_percentual||0)>0;Zt[jt]={...Zt[jt],finalizadora_id:bt,aplicar_taxa:zr?Zt[jt].aplicar_taxa??!0:!1}}return Zt})},children:[a.jsx(jn,{className:"w-[140px] flex-shrink-0",children:a.jsx(An,{placeholder:"Selecione"})}),a.jsx(_n,{children:x.map(bt=>a.jsx(nt,{value:String(bt.id),children:bt.nome||bt.tipo||"Outros"},bt.id))})]}),a.jsx("div",{className:"flex-1 min-w-0 isolate",children:(()=>{const bt=x.find(zr=>String(zr.id)===String(Ze.finalizadora_id)),Wt=Number(bt?.taxa_percentual||0);if(Wt<=0)return a.jsx("div",{className:"h-5"});const Zt=ji(Ze.valor_cota),Br=Zt>0;return a.jsxs("label",{className:`flex items-center gap-1.5 text-xs transition-colors ${Br?"cursor-pointer hover:text-text-primary":"cursor-not-allowed opacity-50"}`,title:Br?`Taxa de ${Wt.toFixed(2)}%`:"Informe o valor primeiro",children:[a.jsx("input",{type:"checkbox",checked:!!Ze.aplicar_taxa,disabled:!Br,onChange:zr=>{if(!Br){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}se(_t=>{const Jr=[..._t];if(jt>=0&&jt<Jr.length){const mn=zr.target.checked;let ma=Zt;mn?ma=Zt*(1+Wt/100):ma=Zt/(1+Wt/100),Jr[jt]={...Jr[jt],aplicar_taxa:mn,valor_cota:Ps(ma.toFixed(2))}}return Jr})},className:`w-4 h-4 rounded border-2 border-amber-500 checked:bg-amber-500 checked:border-amber-500 focus:ring-2 focus:ring-amber-500 focus:ring-offset-1 ${Br?"cursor-pointer":"cursor-not-allowed"}`,style:{accentColor:"#f59e0b"}}),a.jsxs("span",{className:"whitespace-nowrap text-amber-500 font-medium",children:["Taxa (",Wt.toFixed(2),"%)"]})]})})()})]}),(()=>{const bt=Ze.status_pagamento==="Pago",Wt=Number.isFinite(ji(Ze.valor_cota))&&ji(Ze.valor_cota)>0,Zt=bt&&Wt;return a.jsx("button",{type:"button",onClick:()=>St(jt,Ze.status_pagamento,Ze.valor_cota),disabled:Zt,className:`inline-flex items-center justify-center w-[90px] px-3 py-1 rounded text-sm font-medium border transition-all ${bt&&Wt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":bt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:Zt?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:bt?"Pago":"Pendente"})})(),a.jsx(ce,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400",onClick:()=>{F(bt=>[...bt,jt])},children:"Remover"})]})]},Fr)})})()})})]})]}),a.jsx(ra,{className:"gap-2",children:a.jsxs(ce,{type:"button",variant:"ghost",className:"border border-white/10",onClick:async()=>{console.log(" [Auto-save Payments] Salvando ao fechar modal...");try{Se.current&&clearTimeout(Se.current),await ln({autoSave:!0}),console.log(" [Auto-save Payments] Salvo ao fechar!")}catch(at){console.error(" [Auto-save Payments] Erro ao salvar ao fechar:",at)}f()},children:["Fechar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]})})]})})}),a.jsxs("div",{ref:Hn,style:{position:"fixed",left:"0",top:"0",width:"900px",minHeight:"auto",padding:"30px",backgroundColor:"#ffffff !important",color:"#000000 !important",fontFamily:"Arial, sans-serif",opacity:"0",visibility:"hidden",zIndex:"-9999",pointerEvents:"none",overflow:"hidden"},children:[a.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"6px",borderBottom:"2px solid #000",backgroundColor:"#fff",color:"#000"},children:[a.jsx("h1",{style:{fontSize:"18px",fontWeight:"bold",margin:"0 0 6px 0",color:"#000",letterSpacing:"0.5px",textAlign:"center"},children:"RELATRIO DE PAGAMENTOS"}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"10px",color:"#000",fontWeight:"600"},children:[a.jsxs("div",{style:{display:"flex",gap:"20px",flex:1},children:[a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Data:"}),a.jsx("span",{style:{marginLeft:"4px"},children:h?.start?new Date(h.start).toLocaleDateString("pt-BR"):"-"})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Quadra:"}),a.jsx("span",{style:{marginLeft:"4px"},children:h?.court||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Cdigo:"}),a.jsx("span",{style:{marginLeft:"4px"},children:h?.code?`#${h.code}`:"-"})]})]}),a.jsxs("div",{style:{display:"flex",gap:"30px",textAlign:"right"},children:[a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Total:"}),a.jsxs("strong",{style:{marginLeft:"4px",color:"#000",fontSize:"11px",display:"inline"},children:["R$ ",Ps(m||0)]})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Diferena:"}),a.jsxs("strong",{style:{marginLeft:"4px",color:ye.diff<0?"#dc2626":"#16a34a",fontSize:"11px",display:"inline"},children:[ye.diff<0?"-":"","R$ ",Ps(Math.abs(ye.diff).toFixed(2))]})]})]})]})]}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"8px",fontSize:"10px",backgroundColor:"#fff",fontFamily:"Arial, sans-serif",border:"1px solid #000",tableLayout:"fixed"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#cccccc",borderBottom:"1px solid #000"},children:[a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"5%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"N"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"35%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Nome"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"10%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Cdigo"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Valor"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"20%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Forma"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Status"})]})}),a.jsx("tbody",{children:(()=>(le||[]).filter((Vt,wr)=>!(P||[]).includes(wr)).map((Vt,wr)=>{const er=x?.find(Zt=>String(Zt.id)===String(Vt.finalizadora_id)),Ze=Vt.status_pagamento==="Pago",jt=o?.find(Zt=>Zt.id===Vt.cliente_id)?.is_consumidor_final,bt=(Vt.nome||"Sem nome").trim().split(/\s+/).slice(0,2).join(" "),Wt=jt?"0":Vt.codigo||"N/A";return a.jsxs("tr",{"data-participant-index":wr,style:{backgroundColor:"#fff"},children:[a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:wr+1}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"left",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word",overflow:"hidden"},children:bt}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Wt}),a.jsxs("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:["R$ ",Ps(Vt.valor_cota||0)]}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:er?.nome||"N/D"}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:Ze?"#16a34a":"#ca8a04",fontSize:"10px",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Ze?" Pago":" Pendente"})]},`participant-${wr}-${Vt.cliente_id}`)}))()})]}),a.jsx("div",{style:{height:"2px",backgroundColor:"#fff"}}),a.jsxs("div",{style:{marginTop:"2px",textAlign:"center",fontSize:"10px",color:"#000",borderTop:"1px solid #000",paddingTop:"2px",display:"flex",justifyContent:"space-between",backgroundColor:"#fff"},children:[a.jsxs("div",{style:{color:"#000",fontWeight:"500"},children:["Gerado em: ",new Date().toLocaleString("pt-BR")]}),a.jsx("div",{id:"page-indicator",style:{fontSize:"10px",fontWeight:"bold",color:"#000"}})]})]}),a.jsx(xn,{open:H,onOpenChange:at=>{at||(pe([]),z("")),q(at)},children:a.jsxs(vn,{className:"sm:max-w-[500px]",onInteractOutside:at=>{at.preventDefault(),w(2e3),q(!1)},children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Adicionar Participante"}),a.jsx(On,{children:"Selecione um cliente para adicionar aos pagamentos."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{ref:hr,placeholder:"Buscar por cdigo ou nome...",value:U,onChange:at=>{z(at.target.value),V(0)},onKeyDown:at=>{const Vt=U.toLowerCase().trim(),wr=(o||[]).filter(_r=>{if(!Vt)return!0;const bt=String(_r.codigo||""),Wt=(_r.nome||"").toLowerCase();return bt.includes(Vt)||Wt.includes(Vt)}),er=wr.find(_r=>_r?.is_consumidor_final===!0),Fr=wr.filter(_r=>_r?.is_consumidor_final!==!0).sort((_r,bt)=>{const Wt=_r.codigo||0,Zt=bt.codigo||0;return Wt-Zt}),jt=er?[er,...Fr]:Fr;if(at.key==="ArrowDown")at.preventDefault(),V(_r=>Math.min(_r+1,jt.length-1));else if(at.key==="ArrowUp")at.preventDefault(),V(_r=>Math.max(_r-1,0));else if(at.key==="Enter"&&jt[be]){at.preventDefault();const bt={...jt[be],timestamp:Date.now()};pe(Wt=>[...Wt,bt])}},className:"pl-10 pr-10"}),U&&a.jsx("button",{type:"button",onClick:()=>z(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text",children:a.jsx(yl,{className:"h-4 w-4"})})]}),a.jsx(ce,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md",onClick:()=>{s&&(w(15e3),s(()=>{q(!0)}),q(!1),z(""))},children:"+Novo"})]}),a.jsx("div",{ref:Qt,className:"border rounded-md max-h-[400px] overflow-y-auto",children:(()=>{const at=U.toLowerCase().trim(),Vt=(o||[]).filter(jt=>{if(!at)return!0;const _r=String(jt.codigo||""),bt=(jt.nome||"").toLowerCase();return _r.includes(at)||bt.includes(at)}),wr=Vt.find(jt=>jt?.is_consumidor_final===!0),Ze=Vt.filter(jt=>jt?.is_consumidor_final!==!0).sort((jt,_r)=>{const bt=jt.codigo||0,Wt=_r.codigo||0;return bt-Wt}),Fr=wr?[wr,...Ze]:Ze;return Fr.length===0?a.jsx("div",{className:"p-8 text-center text-text-muted",children:"Nenhum cliente encontrado."}):Fr.map((jt,_r)=>{const bt=jt?.is_consumidor_final===!0,Wt=Q.filter(Br=>Br.id===jt.id).length,Zt=_r===be;return a.jsxs("div",{ref:Br=>{Mt.current[_r]=Br},role:"button",tabIndex:0,className:`w-full px-4 py-3 text-left transition-all border-b border-border last:border-0 flex items-center gap-3 cursor-pointer ${Zt?"ring-2 ring-blue-500 ring-inset z-10":""} ${bt?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":Wt>0?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>V(_r),onClick:Br=>{Br.preventDefault(),Br.stopPropagation();const zr={...jt,timestamp:Date.now()};pe(_t=>[..._t,zr])},onKeyDown:Br=>{if(Br.key==="Enter"||Br.key===" "){Br.preventDefault();const zr={...jt,timestamp:Date.now()};pe(_t=>[..._t,zr])}},children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[(()=>jt.codigo!==null&&jt.codigo!==void 0?a.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${bt?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",jt.codigo]}):null)(),a.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[a.jsx("span",{className:`font-medium ${bt?"text-amber-100/90":""}`,children:jt.nome}),bt&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),Wt>0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:Br=>{Br.preventDefault(),Br.stopPropagation(),pe(zr=>{const _t=zr.findIndex(Jr=>Jr.id===jt.id);if(_t!==-1){const Jr=[...zr];return Jr.splice(_t,1),Jr}return zr})},children:"-"}),a.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:Wt}),a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:Br=>{Br.preventDefault(),Br.stopPropagation();const zr={...jt,timestamp:Date.now()};pe(_t=>[..._t,zr])},children:"+"})]})]},jt.id)})})()})]}),a.jsxs(ra,{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-sm text-text-muted",children:Q.length>0&&a.jsxs("span",{className:"font-medium",children:[Q.length," ",Q.length===1?"participante selecionado":"participantes selecionados"]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ce,{type:"button",variant:"ghost",className:"border border-border",onClick:at=>{at.preventDefault(),at.stopPropagation(),w(1e3),q(!1),z(""),pe([])},children:["Cancelar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),a.jsxs(ce,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",disabled:Q.length===0,onClick:at=>{console.log("[AddParticipant] Boto Salvar clicado"),at.preventDefault(),at.stopPropagation(),console.log("[AddParticipant] Protegendo modal de pagamentos (3000ms)"),w(3e3),console.log("[AddParticipant] Adicionando participantes:",Q.length);const Vt=Q.map(wr=>({cliente_id:wr.id,nome:wr.nome,codigo:wr.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const er=Dt();return er?.id?String(er.id):null})(),aplicar_taxa:(()=>{const er=Dt();return Number(er?.taxa_percentual||0)>0})()}));se(wr=>{const er=wr.length,Ze=Vt.map((Fr,jt)=>er+jt);return ge(Ze),setTimeout(()=>{ge([])},1e3),[...wr,...Vt]}),console.log("[AddParticipant] Fechando modal de adicionar participante"),q(!1),z(""),pe([]),console.log("[AddParticipant] Concludo")},children:["Confirmar (",Q.length,")",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})]})}),a.jsx(xn,{open:st,onOpenChange:at=>{console.log(" [DownloadModal] onOpenChange chamado:",{open:at,downloadStatus:Rt}),!at&&Rt==="success"?(console.log(" [DownloadModal] Fechando modal de download (sucesso)"),ut(!1)):at||console.log(" [DownloadModal] BLOQUEADO: Ainda baixando")},children:a.jsxs(vn,{className:"sm:max-w-md",onPointerDownOutside:at=>{Rt==="downloading"&&at.preventDefault()},onEscapeKeyDown:at=>{Rt==="downloading"&&at.preventDefault()},children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-center",children:Rt==="downloading"?"Gerando PDF...":"PDF Gerado com Sucesso!"}),a.jsx(On,{className:"sr-only",children:Rt==="downloading"?"Aguarde enquanto o relatrio de pagamentos est sendo gerado":"Relatrio de pagamentos gerado e baixado com sucesso"})]}),a.jsx("div",{className:"flex flex-col items-center justify-center py-6 space-y-4",children:Rt==="downloading"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-500"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Gerando seu relatrio..."}),a.jsxs("div",{className:"w-full max-w-xs",children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[a.jsx("span",{children:"Progresso"}),a.jsxs("span",{children:[tt,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:a.jsx("div",{className:"bg-green-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${tt}%`}})})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"rounded-full bg-green-100 p-3",children:a.jsx("svg",{className:"w-12 h-12 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Relatrio baixado com sucesso!"}),a.jsx("p",{className:"text-xs text-gray-400 text-center",children:Me})]})}),Rt==="success"&&a.jsxs("div",{className:"flex flex-col gap-2",children:[navigator.share&&navigator.canShare&&navigator.canShare({files:[]})&&a.jsxs(ce,{onClick:async()=>{if(!ke){l({title:"Arquivo no disponvel",description:"Tente gerar o PDF novamente.",variant:"destructive"});return}try{console.log(" [PDF] Compartilhando via Web Share API...");const at=new File([ke],Me,{type:"application/pdf"});await navigator.share({files:[at],title:"Relatrio de Pagamentos",text:"Confira o relatrio de pagamentos"}),console.log(" [PDF] Compartilhado com sucesso"),l({title:"Compartilhado com sucesso!",variant:"success"})}catch(at){if(at.name==="AbortError"){console.log(" [PDF] Compartilhamento cancelado");return}console.error(" [PDF] Erro ao compartilhar:",at),l({title:"Erro ao compartilhar",description:at.message,variant:"destructive"})}},className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Compartilhar"]}),a.jsxs(ce,{onClick:()=>{Be?(console.log(" [PDF] Abrindo PDF em nova aba:",Be),window.open(Be,"_blank")):(console.error(" [PDF] URL do blob no disponvel"),l({title:"Erro ao abrir PDF",description:"URL do PDF no est disponvel.",variant:"destructive"}))},className:"w-full bg-green-600 hover:bg-green-700",children:[a.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Abrir PDF"]}),a.jsx("p",{className:"text-xs text-center text-gray-500 px-2",children:"O PDF foi baixado. Abra-o para visualizar, imprimir ou compartilhar."}),a.jsx(ce,{onClick:()=>ut(!1),variant:"ghost",className:"w-full",children:"Fechar"})]})]})}),a.jsx(xn,{open:ir.isOpen,onOpenChange:at=>{if(!at&&qe.current){console.log(" [StatusConfirmation] Bloqueado onOpenChange (protegido)");return}at||(console.log(" [StatusConfirmation] Fechando modal via onOpenChange"),Ee({isOpen:!1,participantIndex:null,currentStatus:null}))},children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[400px]",onInteractOutside:at=>{qe.current&&(console.log(" [StatusConfirmation] Bloqueado clique fora"),at.preventDefault())},onEscapeKeyDown:at=>{qe.current&&(console.log(" [StatusConfirmation] Bloqueado ESC"),at.preventDefault())},children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Alterar Status de Pagamento"}),a.jsx(On,{children:ir.currentStatus==="Pago"?a.jsxs(a.Fragment,{children:["Tem certeza que deseja marcar este participante como ",a.jsx("strong",{children:"Pendente"}),"?"]}):a.jsxs(a.Fragment,{children:["Tem certeza que deseja marcar este participante como ",a.jsx("strong",{children:"Pago"})," mesmo sem valor registrado?"]})})]}),a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"p-3 rounded-lg bg-amber-500/10 border border-amber-500/30",children:a.jsx("p",{className:"text-sm text-amber-400",children:ir.currentStatus==="Pago"?a.jsx(a.Fragment,{children:" Esta ao marcar o participante como pendente novamente para refazer o pagamento."}):a.jsx(a.Fragment,{children:" Esta ao marcar o participante como pago sem um valor especfico."})})})}),a.jsxs(ra,{className:"gap-2",children:[a.jsx(ce,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{Ee({isOpen:!1,participantIndex:null,currentStatus:null})},children:"Cancelar"}),a.jsx(ce,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>pt(ir.currentStatus==="Pago"?"Pendente":"Pago"),children:"Confirmar"})]})]})})]})}function ZQe({form:e,setForm:t,localCustomers:r}){no(),So();const{isEditParticipantModalOpen:n,closeEditParticipantModal:o,editParticipantData:s,participantsForm:i,setParticipantsForm:l,payMethods:c,protectPaymentModal:d,onParticipantReplacedRef:u}=X_(),[f,h]=p.useState(""),[m,v]=p.useState(!1),[g,y]=p.useState(0),x=_e.useRef(null),b=_e.useRef([]),w=_e.useRef(null),j=M=>{const I=s.participantId;if(i[I]?.cliente_id===M.id)return;console.log(" [EditParticipantModal] Substituindo participante:",{de:s.participantName,para:M.nome,indice:I,id_para:M.id});const R=i[I];if(l.updateLocal&&l.getLocal){const D=l.getLocal();if(I>=0&&I<D.length){const U={cliente_id:M.id,nome:M.nome,codigo:M.codigo,valor_cota:R?.valor_cota||"",status_pagamento:R?.status_pagamento||"Pendente",finalizadora_id:R?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:R?.aplicar_taxa||!1},z=[...D];z[I]=U,l.updateLocal(z)}}else l(D=>{if(I<0||I>=D.length)return D;const U={cliente_id:M.id,nome:M.nome,codigo:M.codigo,valor_cota:R?.valor_cota||"",status_pagamento:R?.status_pagamento||"Pendente",finalizadora_id:R?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:R?.aplicar_taxa||!1},z=[...D];return z[I]=U,z});d(3e3),o(),h(""),u?.current&&u.current(I)};if(p.useEffect(()=>{n&&(h(""),v(!1),y(0))},[n]),p.useEffect(()=>{n&&b.current[g]&&b.current[g]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[g,n]),!n)return null;const _=f.trim().toLowerCase(),C=(r||[]).filter(M=>_?String(M?.nome||"").toLowerCase().includes(_):!0),E=C.find(M=>M?.is_consumidor_final===!0),P=C.filter(M=>M?.is_consumidor_final!==!0).sort((M,I)=>{const R=Number(M?.codigo),D=Number(I?.codigo);return Number.isFinite(R)&&Number.isFinite(D)?R-D:String(M?.nome||"").localeCompare(String(I?.nome||""))}),F=E?[E,...P]:P;return a.jsx(xn,{open:n,onOpenChange:M=>{console.log("[EditParticipantModal] onOpenChange:",M),M||(console.log("[EditParticipantModal] Protegendo modal de pagamentos"),d(2e3),o(),h(""))},modal:!0,children:a.jsxs(vn,{className:"sm:max-w-[500px]",onPointerDownOutside:M=>{console.log(" [EditParticipantModal] onPointerDownOutside - prevenindo"),M.preventDefault(),M.stopPropagation()},onInteractOutside:M=>{console.log(" [EditParticipantModal] onInteractOutside - prevenindo"),M.preventDefault(),M.stopPropagation(),d(2e3)},children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Trocar Participante"}),a.jsxs(On,{children:["Substituindo: ",a.jsx("strong",{children:s.participantName})]})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"edit-participant-search",children:"Buscar cliente"}),a.jsx(Je,{ref:x,id:"edit-participant-search",type:"text",placeholder:"Digite o nome do cliente...",value:f,onChange:M=>{h(M.target.value),y(0)},onKeyDown:M=>{if(M.key==="ArrowDown")M.preventDefault(),y(I=>Math.min(I+1,F.length-1));else if(M.key==="ArrowUp")M.preventDefault(),y(I=>Math.max(I-1,0));else if(M.key==="Enter"&&F[g]){M.preventDefault();const I=F[g],R=s.participantId;i[R]?.cliente_id===I.id||(d(2e3),j(I))}},className:"mt-1",autoFocus:!0})]}),a.jsx("div",{ref:w,className:"border border-border rounded-md max-h-[300px] overflow-y-auto",children:m?a.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Carregando clientes..."}):F.length===0?a.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:_?"Nenhum cliente encontrado":"Nenhum cliente cadastrado"}):F.map((M,I)=>{const R=s.participantId,D=i[R]?.cliente_id===M.id,U=M?.is_consumidor_final===!0,z=I===g;return a.jsxs("button",{ref:H=>{b.current[I]=H},type:"button",className:mr(z&&"ring-2 ring-blue-500 ring-inset z-10","w-full px-4 py-3 text-left transition-all","border-b border-border last:border-b-0","flex items-center gap-3",D&&"bg-brand/10 cursor-not-allowed opacity-60",!D&&U&&"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40",!D&&!U&&"hover:bg-surface-2"),disabled:D,onMouseEnter:()=>y(I),onClick:H=>{H.preventDefault(),H.stopPropagation(),console.log("[EditParticipantModal] Cliente selecionado - protegendo modal"),d(2e3),j(M)},children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[M.codigo!==null&&M.codigo!==void 0&&a.jsxs("span",{className:mr("inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors",U&&"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20",!U&&"bg-emerald-600/20 text-emerald-400"),children:["#",M.codigo]}),a.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[a.jsx("span",{className:mr("font-medium",U&&"text-amber-100/90"),children:M.nome}),U&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),D&&a.jsx("span",{className:"text-xs text-brand font-medium",children:"Atual"})]},M.id)})})]}),a.jsx(ra,{children:a.jsx(ce,{type:"button",variant:"ghost",className:"border border-white/10",onClick:M=>{console.log(" [EditParticipantModal] ========== BOTO CANCELAR CLICADO =========="),console.log(" [EditParticipantModal] preventDefault()"),M.preventDefault(),console.log(" [EditParticipantModal] stopPropagation()"),M.stopPropagation(),console.log(" [EditParticipantModal] Protegendo modal de pagamentos (2000ms)"),d(2e3),console.log(" [EditParticipantModal] Fechando modal de editar participante"),o(),console.log(" [EditParticipantModal] Limpando busca"),h(""),console.log(" [EditParticipantModal] ========== CANCELAR CONCLUDO ==========")},children:"Cancelar"})})]})})}const eZe=e=>e?e.trim().split(/\s+/).slice(0,2).join(" "):"",ym=56,IE=30,tZe=6,rZe=24;function nZe({weekStart:e,weekBookings:t,activeCourtFilter:r,courtsMap:n,participantsByAgendamento:o,onBookingClick:s,onSlotClick:i,statusConfig:l,dayStartHour:c=tZe,dayEndHourExclusive:d=rZe,weekDiasFuncionamento:u={},sidebarVisible:f=!1}){const h=p.useRef(null),m=p.useRef(null),[v,g]=_e.useState(0),[y,x]=_e.useState(window.innerWidth<768);_e.useEffect(()=>{const A=()=>{x(window.innerWidth<768)};return window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)},[]);const b=p.useMemo(()=>Array.from({length:7},(A,P)=>La(e,P)),[e]);p.useEffect(()=>{const A=()=>{m.current&&h.current&&(h.current.scrollLeft=m.current.scrollLeft)},P=()=>{h.current&&m.current&&(m.current.scrollLeft=h.current.scrollLeft)},F=()=>{if(m.current){const R=m.current.scrollHeight>m.current.clientHeight;g(R?17:0)}},M=m.current,I=h.current;return M&&M.addEventListener("scroll",A),I&&I.addEventListener("scroll",P),F(),window.addEventListener("resize",F),()=>{M&&M.removeEventListener("scroll",A),I&&I.removeEventListener("scroll",P),window.removeEventListener("resize",F)}},[]);const w=p.useMemo(()=>{if(r&&n[r]){const A=n[r],P=A.hora_inicio||`${c}:00:00`,F=A.hora_fim||`${d}:00:00`,[M]=String(P).split(":").map(Number),[I,R]=String(F).split(":").map(Number);let D=I===0&&R===0?24:I;return R>0&&D<24&&(D+=1),{start:M||c,end:D||d}}return{start:c,end:d}},[r,n,c,d]),j=p.useMemo(()=>Array.from({length:Math.max(0,w.end-w.start)},(A,P)=>w.start+P),[w]),_=p.useMemo(()=>Math.max(0,w.end-w.start)*(60/IE)*ym,[w]),C=p.useMemo(()=>{const A={};return b.forEach(P=>{A[dr(P,"yyyy-MM-dd")]=[]}),t.forEach(P=>{const F=dr(ko(P.start),"yyyy-MM-dd");A[F]&&A[F].push(P)}),A},[b,t]),E=(A,P)=>{const F=A.start.getHours()*60+A.start.getMinutes(),I=A.end.getHours()*60+A.end.getMinutes()-F,R=w.start*60,D=(F-R)/IE*ym,U=I/IE*ym,H=l[A.status]||{hex:"#888",text:"text-gray-400",label:"Unknown",icon:null},q=H.icon,Q=40,pe=Math.max(Q,U-4),be=Math.min(1.3,pe/55),V=Math.max(11,Math.round(13*be)),B=Math.max(10,Math.round(11*be)),J=Math.max(9,Math.round(10*be)),ue=Math.max(14,Math.round(16*be)),Ne=P?.[A.id]||[],Z=Ne.filter(se=>String(se.status_pagamento||"").toLowerCase()==="pago").length,ge=Ne.length,le=I===30;return a.jsx("div",{id:`booking-${A.id}`,className:"absolute left-0.5 right-0.5 rounded-md border-2 bg-surface cursor-pointer transition-all hover:bg-surface-2 hover:shadow-md overflow-hidden",style:{top:`${D}px`,height:`${Math.max(Q,U)}px`,borderColor:H.hex||"#888",borderLeftWidth:"3px",zIndex:5},onClick:()=>s(A),children:a.jsxs("div",{className:"h-full flex flex-col justify-center px-2 py-1",children:[a.jsx("div",{className:"flex items-center gap-1.5 mb-0.5",children:a.jsx("p",{className:"font-semibold truncate",style:{fontSize:`${V}px`,lineHeight:1.1,color:"#e2e8f0"},children:eZe(A.customer)})}),le&&(A.modality||ge>0)&&a.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",style:{lineHeight:1},children:[A.modality&&a.jsx("span",{className:"text-xs font-bold text-white bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm flex-shrink-0",style:{fontSize:Math.max(7,J-1)},children:A.modality}),ge>0&&a.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${Z===ge?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,J-1)},children:[a.jsx(Ks,{style:{width:Math.max(10,J-1),height:Math.max(10,J-1)}}),a.jsxs("span",{children:[Z,"/",ge]})]})]}),le&&a.jsxs("div",{className:"flex items-center gap-1.5 justify-between",children:[a.jsxs("span",{className:"font-semibold whitespace-nowrap",style:{fontSize:`${B}px`,color:"#999",lineHeight:1},children:[dr(A.start,"HH:mm"),"",dr(A.end,"HH:mm")]}),q&&a.jsxs("div",{className:"flex items-center gap-0.5",children:[!f&&!y&&a.jsx(q,{style:{width:Math.max(12,ue-2),height:Math.max(12,ue-2),color:H.hex}}),a.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${B}px`,color:H.hex,lineHeight:1},children:H.label})]})]}),!le&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"truncate",style:{fontSize:`${B}px`,color:"#999",lineHeight:1,marginBottom:"2px"},children:[dr(A.start,"HH:mm"),"",dr(A.end,"HH:mm")]}),A.modality&&a.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm mb-0.5",style:{fontSize:Math.max(7,J-1),display:"inline-block",width:"fit-content"},children:A.modality}),a.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",children:[q&&a.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[!f&&!y&&a.jsx(q,{style:{width:ue,height:ue,color:H.hex}}),a.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${J}px`,color:H.hex,lineHeight:1},children:A.status==="in_progress"?"Andamento":H.label})]}),ge>0&&a.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${Z===ge?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,J-1)},children:[a.jsx(Ks,{style:{width:Math.max(12,J),height:Math.max(12,J)}}),a.jsxs("span",{children:[Z,"/",ge]})]})]})]})]})},A.id)};return a.jsxs("div",{className:"flex-1 bg-surface rounded-lg border border-border flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex sticky top-0 z-20 bg-surface border-b border-border",children:[a.jsx("div",{className:"w-20 flex-shrink-0 flex items-center justify-center font-semibold text-sm border-r border-border bg-surface",children:"Horrios"}),a.jsxs("div",{ref:h,"data-header-scroll":!0,className:"flex flex-1 overflow-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none",paddingRight:`${v}px`,minWidth:0},children:[a.jsx("style",{children:`
            [data-header-scroll]::-webkit-scrollbar {
              display: none;
            }
          `}),b.map(A=>a.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] flex flex-col items-center justify-center py-3 border-r border-border bg-surface-2/50 text-center",children:[a.jsx("div",{className:"text-xs font-semibold text-text-muted",children:dr(A,"EEE",{locale:wa}).toUpperCase()}),a.jsx("div",{className:"text-sm font-bold text-text-primary",children:dr(A,"dd")})]},dr(A,"yyyy-MM-dd")))]})]}),a.jsxs("div",{ref:m,className:"flex flex-1 overflow-auto",style:{minWidth:0},children:[a.jsxs("div",{className:"w-20 flex-shrink-0 bg-surface sticky left-0 z-10 flex flex-col relative",style:{borderRight:"1px solid var(--color-border)",minHeight:`${_}px`},children:[j.map(A=>a.jsxs(_e.Fragment,{children:[a.jsx("div",{className:mr("relative border-b border-border/60",A%2===1&&"bg-surface-2/30"),style:{height:ym},children:a.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(A).padStart(2,"0"),":00"]})}),a.jsx("div",{className:mr("relative border-b border-border/60",A%2===1&&"bg-surface-2/30"),style:{height:ym},children:a.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(A).padStart(2,"0"),":30"]})})]},`time-${A}`)),a.jsx("div",{className:"absolute right-0 top-0 w-px bg-border pointer-events-none",style:{height:`${_}px`}})]}),b.map(A=>{const P=dr(A,"yyyy-MM-dd"),F=C[P]||[],M=u[P]||{},I=r&&M[r]&&!M[r].funciona;return a.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] relative border-r border-border bg-surface-2/10",style:{minHeight:`${_}px`},children:[j.map(R=>a.jsx("div",{className:mr("border-b border-border/60",R%2===1&&"bg-surface-2/5"),style:{height:ym*2},children:I?a.jsx("div",{className:"w-full h-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/60 transition-colors",onClick:D=>D.preventDefault(),children:a.jsxs("div",{className:"text-center pointer-events-none",children:[a.jsx(s4,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),a.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),M[r]?.observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:M[r].observacao})]})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:ym},onClick:()=>{const D=new Date(A.getTime());D.setHours(R,0,0,0),console.log("Slot :00 clicked",{day:A,hour:R,slotDate:D,activeCourtFilter:r}),i?.(D,r)}}),a.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:ym},onClick:()=>{const D=new Date(A.getTime());D.setHours(R,30,0,0),console.log("Slot :30 clicked",{day:A,hour:R,slotDate:D,activeCourtFilter:r}),i?.(D,r)}})]})},`${P}-${R}`)),F.map(R=>E(R,o))]},P)})]})]})}const Oa=30,av=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,o]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${o}`},hf=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function B9(e){const t=String(e||"").trim().split(/\s+/).filter(Boolean);return t.length===0?"":t.length===1?t[0]:`${t[0]} ${t[1]}`}const _i=56,aZe=6,zT=6,cae=24;Array.from({length:(cae-zT)*(60/Oa)},(e,t)=>{const r=zT*60+t*Oa,n=Math.floor(r/60),o=r%60;return{time:`${String(n).padStart(2,"0")}:${String(o).padStart(2,"0")}`,isHourMark:o===0}});const Zh=["Futebol","Beach Tennis","Futevlei","Treino"];function fp(e){return Nd(e,{weekStartsOn:1})}function oZe(e){const t=fp(e),r=La(t,6);return t.getMonth()===r.getMonth()?`${dr(t,"dd")}-${dr(r,"dd")} de ${dr(r,"MMMM",{locale:wa})} de ${dr(r,"yyyy")}`:`${dr(t,"dd")} de ${dr(t,"MMMM",{locale:wa})} - ${dr(r,"dd")} de ${dr(r,"MMMM",{locale:wa})} de ${dr(r,"yyyy")}`}const ri={scheduled:{label:"Agendado",accent:"bg-[#3B82F6]",text:"text-[#3B82F6]",border:"border-[#3B82F6]",hex:"#3B82F6",icon:Ns},confirmed:{label:"Confirmado",accent:"bg-[#22C55E]",text:"text-[#22C55E]",border:"border-[#22C55E]",hex:"#22C55E",icon:Ds},in_progress:{label:"Em andamento",accent:"bg-[#FACC15]",text:"text-[#FACC15]",border:"border-[#FACC15]",hex:"#FACC15",icon:zH},finished:{label:"Finalizado",accent:"bg-[#6B7280]",text:"text-[#6B7280]",border:"border-[#6B7280]",hex:"#6B7280",icon:bue},canceled:{label:"Cancelado",accent:"bg-[#EF4444]",text:"text-[#EF4444]",border:"border-[#EF4444]",hex:"#EF4444",icon:zy},absent:{label:"Ausente",accent:"bg-[#F97316]",text:"text-[#F97316]",border:"border-[#F97316]",hex:"#F97316",icon:WH}},sZe={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},q9={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},z9=e=>{let t=Math.floor(e/60);const r=e%60;return t>=24&&(t=t%24),`${String(t).padStart(2,"0")}:${String(r).padStart(2,"0")}`};function iZe({sidebarVisible:e=!1}){const{toast:t}=no(),{loadAlerts:r}=bC(),n=Ls(),{isPaymentModalOpen:o,openPaymentModal:s,closePaymentModal:i,isEditParticipantModalOpen:l,openEditParticipantModal:c,closeEditParticipantModal:d,editParticipantData:u,editingBooking:f,setEditingBooking:h,participantsForm:m,setParticipantsForm:v,paymentTotal:g,setPaymentTotal:y,payMethods:x,setPayMethods:b}=X_(),w=p.useMemo(()=>{try{return typeof window<"u"&&localStorage.getItem("debug:agenda")==="1"}catch{return!1}},[]),j=p.useCallback((...Ie)=>{if(w)try{console.log("[AgendaDbg]",...Ie)}catch{}},[w]);p.useEffect(()=>{try{nr.current=Date.now()+2500,j("runAutomation:startup grace set",{until:nr.current}),setTimeout(()=>{try{$a()}catch{}},2500+200)}catch{}const Ie=console.log,Ye=console.info,ar=console.debug,Gt=console.warn,Ut=console.error,Ot=S=>{const K=String(S||"");return K.startsWith("[AgendaDbg]")||!1||K.startsWith("[PulseDump]")||K.startsWith("[Clientes:load]")||K.startsWith("[AgendaSettings]")||K.startsWith("[Auto]")||K.startsWith("[DEBUG-PaymentModal]")||K.startsWith(" EditGuard")};return console.log=(...S)=>{try{if(Ot(S[0]))return}catch{}return Ie(...S)},console.info=(...S)=>{try{if(Ot(S[0]))return}catch{}return Ye(...S)},console.debug=(...S)=>{try{if(Ot(S[0]))return}catch{}return ar(...S)},console.warn=(...S)=>{try{if(Ot(S[0]))return}catch{}return Gt(...S)},console.error=(...S)=>{try{if(Ot(S[0]))return}catch{}return Ut(...S)},()=>{console.log=Ie,console.info=Ye,console.debug=ar,console.warn=Gt,console.error=Ut}},[]);const _=p.useRef({active:!1,tag:"",start:0,timer:null,events:[]}),C=p.useCallback((Ie,Ye)=>{if(w)try{const ar=Date.now(),Gt=_.current&&_.current.active?ar-(_.current.start||ar):0;_.current.events.push({t:ar,ms:Gt,event:Ie,data:Ye})}catch{}},[w]),E=p.useCallback(Ie=>{if(w){try{if(!_.current.active)return;const{tag:Ye,start:ar,events:Gt}=_.current,Ut=`[PulseDump] tag=${Ye} dur=${Date.now()-ar}ms reason=${Ie}`;console.groupCollapsed(Ut);for(const Ot of Gt)console.log(` +${String(Ot.ms).padStart(4," ")}ms`,Ot.event,Ot.data||{});console.groupEnd()}catch{}try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!1,tag:"",start:0,timer:null,events:[]}}},[w]),A=p.useCallback((Ie,Ye=5e3)=>{if(w){try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!0,tag:Ie,start:Date.now(),timer:null,events:[]},_.current.timer=setTimeout(()=>E("timeout"),Ye),j("PulseStart",{tag:Ie,timeoutMs:Ye})}},[w,E,j]),{userProfile:P,authReady:F,company:M}=So(),[I,R]=QS(),[D,U]=p.useState(new Date),[z,H]=p.useState("day"),[q,Q]=p.useState(!1),[pe,be]=p.useState({}),[V,B]=p.useState(!1),[J,ue]=p.useState({}),Ne=p.useMemo(()=>{const Ie=M?.nome_fantasia||M?.nome||M?.razao_social||M?.codigoEmpresa||"";return String(Ie).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"").trim()},[M?.nome_fantasia,M?.nome,M?.razao_social,M?.codigoEmpresa]),Z=p.useMemo(()=>Ne?`https://${Ne}.f7arena.com`:"",[Ne]),ge=p.useCallback(async Ie=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(Ie);else{const Ye=document.createElement("textarea");Ye.value=Ie,Ye.style.position="fixed",Ye.style.top="0",Ye.style.left="0",Ye.style.opacity="0",document.body.appendChild(Ye),Ye.focus(),Ye.select(),document.execCommand("copy"),document.body.removeChild(Ye)}return!0}catch{return!1}},[]);p.useEffect(()=>{const Ie=Ye=>{if(Ye.key==="Escape"&&q){Q(!1);return}if(Ye.key==="F10"){try{Ye.preventDefault()}catch{}Q(ar=>!ar)}};return window.addEventListener("keydown",Ie),()=>window.removeEventListener("keydown",Ie)},[q]),p.useEffect(()=>{if(q&&window.innerWidth<768)if(screen.orientation&&screen.orientation.lock)screen.orientation.lock("landscape").catch(()=>{const Ie=document.getElementById("screen-orientation-meta");Ie&&Ie.setAttribute("content","landscape")});else{const Ie=document.getElementById("screen-orientation-meta");Ie&&Ie.setAttribute("content","landscape")}else if(!q&&window.innerWidth<768){screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock();const Ie=document.getElementById("screen-orientation-meta");Ie&&Ie.setAttribute("content","portrait-primary")}},[q]),p.useEffect(()=>{const Ie=I.get("date");if(Ie)try{const Ye=new Date(Ie+"T00:00:00");isNaN(Ye.getTime())||(U(Ye),I.delete("date"),R(I,{replace:!0}))}catch(Ye){console.error("[AgendaPage] Erro ao parsear date da URL:",Ye)}},[I,R]);const[le,se]=p.useState([]),[ee,de]=p.useState(!1),[Le,ae]=p.useState(!1),ie=p.useRef(!1);p.useEffect(()=>{ie.current||!F||!P?.codigo_empresa||D&&(ie.current=!0,(async()=>{try{const Ie=ko(D),Ye=La(Ie,1),{data:ar,error:Gt}=await fe.from("agendamentos").select("id, codigo, inicio, fim, status, modalidade, quadra_id, cliente_id, auto_disabled, clientes").eq("codigo_empresa",P.codigo_empresa).gte("inicio",Ie.toISOString()).lt("inicio",Ye.toISOString()).order("inicio",{ascending:!0});if(Gt)return;const Ut=(ar||[]).map(Ot=>({id:Ot.id,code:Ot.codigo,start:new Date(Ot.inicio),end:new Date(Ot.fim),status:Ot.status||"scheduled",modality:Ot.modalidade||"",customer:Array.isArray(Ot.clientes)&&Ot.clientes.length>0?Ot.clientes[0]:"",court:String(Ot.quadra_id||""),court_id:Ot.quadra_id,auto_disabled:!!Ot.auto_disabled}));se(Ot=>Array.isArray(Ot)&&Ot.length>0?Ot:Ut)}catch{}})())},[F,P?.codigo_empresa,D,fe]);const[dt,At]=p.useState(4),[st,ut]=p.useState(!1),[Rt,Nt]=p.useState(!1),tt=f,he=h,[ke,et]=p.useState({}),Me=p.useRef(0),$e=p.useRef("");p.useEffect(()=>{const Ie=Ye=>{try{const ar=Ye?.detail||{},Gt=ar.agendamentoId,Ut=ar.participants;if(!Gt||!Array.isArray(Ut))return;et(Ot=>{const S=Ot[Gt]||[],K=Ut.map((ne,Ce)=>{const W=S[Ce]||{};return{...W,cliente_id:ne.cliente_id,nome:ne.nome,codigo:W.codigo!==void 0?W.codigo:ne.codigo??null,valor_cota:typeof ne.valor_cota=="string"?ne.valor_cota:W.valor_cota??"",status_pagamento:ne.status_pagamento||W.status_pagamento||"Pendente",finalizadora_id:ne.finalizadora_id??W.finalizadora_id??null,aplicar_taxa:ne.aplicar_taxa??W.aplicar_taxa??!1,ordem:W.ordem??Ce+1}});return{...Ot,[Gt]:K}})}catch{}};return window.addEventListener("payments:saved",Ie),()=>window.removeEventListener("payments:saved",Ie)},[]);const Be=p.useRef(!1);p.useEffect(()=>{Be.current=ee,j("Modal state change:",{isModalOpen:ee}),C("modal",{open:ee})},[ee,j]);const we=p.useRef("init"),He=p.useRef(0),ht=p.useRef(!1),zt=p.useRef(0),hr=p.useRef(!1),Mt=p.useRef(0),[Qt,Se]=p.useState(!1),kt=p.useRef(0),Lt=p.useRef(!1),fr=p.useRef(0),yr=p.useCallback((Ie=800)=>{fr.current=Date.now()+Ie,j("UI:busy set",{ms:Ie})},[j]),Xt=p.useCallback(()=>Date.now()<fr.current,[]),nr=p.useRef(0),ir=p.useRef(0),Ee=p.useRef(!1),qe=p.useCallback(()=>{const Ie=Date.now();ee||Ie-ir.current<350||(ir.current=Ie,de(!0),Ee.current=!0)},[ee]),Ge=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!ee&&!Ge.current&&(Ge.current=!0,qe(),window.history.replaceState({},document.title))},[n.state?.openModal,ee,qe]);const[Qe,St]=p.useState({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),[pt,Et]=p.useState(null),[mt,gt]=p.useState(!0),ft=p.useMemo(()=>Object.fromEntries((pt??[]).map(Ie=>[Ie.nome,Ie])),[pt]),Dt=p.useMemo(()=>(pt??[]).map(Ie=>Ie.nome),[pt]),[Ft,ye]=p.useState([]),wt=P?.codigo_empresa,Yt=p.useMemo(()=>wt?`quadras:list:${wt}`:"quadras:list",[wt]),br=p.useMemo(()=>wt?`agenda:selectedCourts:${wt}`:"agenda:selectedCourts",[wt]),Mr=p.useMemo(()=>wt?`agenda:viewFilter:${wt}`:"agenda:viewFilter",[wt]),[Nr,Rr]=p.useState(null),[Er,ln]=p.useState(0);p.useEffect(()=>{Ft.length>0&&Nr===null&&Rr(Ft[0])},[Ft,Nr]);const[Fn,Hn]=p.useState([]),$n=p.useRef(null),at=p.useRef({scheduled:!0,canceledOnly:!1}),[Vt,wr]=p.useState(null),[er,Ze]=p.useState(""),Fr=p.useRef(0),jt=p.useRef(!1),_r=p.useRef(!1),[bt,Wt]=p.useState(!1),[Zt,Br]=p.useState(()=>{try{return localStorage.getItem("agenda:hideCanceledInfo")==="1"}catch{return!1}});p.useEffect(()=>{try{localStorage.setItem("agenda:hideCanceledInfo",Zt?"1":"0")}catch{}},[Zt]);const zr=p.useMemo(()=>{if(!P?.codigo_empresa)return null;const Ie=dr(z==="week"?fp(D):D,"yyyy-MM-dd"),Ye=z==="week"?"week":"day";return`agenda:bookings:${P.codigo_empresa}:${Ye}:${Ie}`},[P?.codigo_empresa,D,z]),_t=p.useMemo(()=>{if(!P?.codigo_empresa)return null;const Ie=dr(D,"yyyy-MM-dd");return`agenda:participants:${P.codigo_empresa}:${Ie}`},[P?.codigo_empresa,D]),[Jr,mn]=p.useState(!1),ma=p.useMemo(()=>({autoConfirmEnabled:!1,autoConfirmMinutesBefore:120,autoStartEnabled:!0,autoFinishEnabled:!0}),[]),[Nn,re]=p.useState(ma),[Te,ot]=p.useState(ma),[te,T]=p.useState(!1),[O,X]=p.useState(0),G=p.useCallback(()=>Date.now()+(Number.isFinite(O)?O:0),[O]),[L,Re]=p.useState(null);p.useEffect(()=>{(async()=>{if(console.log("[AgendaSettings][LOAD] Iniciando carregamento...",{authReady:F,company_id:M?.id}),!F||!M?.id){console.warn("[AgendaSettings][LOAD] Aguardando autenticao...");return}try{console.log("[AgendaSettings][LOAD] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][LOAD] Buscando para empresa_id:",M.id);const{data:Ye,error:ar}=await fe.from("agenda_settings").select("*").eq("empresa_id",M.id).maybeSingle();if(console.log("[AgendaSettings][LOAD] Resultado da query:",{data:Ye,error:ar}),console.log("[AgendaSettings][LOAD] Data type:",Ye===null?"null":typeof Ye),ar){console.error("[AgendaSettings][LOAD] ERRO ao carregar:",ar);return}if(!Ye){console.warn("[AgendaSettings][LOAD] Nenhum registro encontrado (ainda no criado)");return}console.log("[AgendaSettings][LOAD]  Registro encontrado:",Ye);const Gt={autoConfirmEnabled:!!Ye.auto_confirm_enabled,autoConfirmMinutesBefore:Ye.auto_confirm_enabled&&Number.isFinite(Number(Ye.auto_confirm_hours))?Number(Ye.auto_confirm_hours)*60:ma.autoConfirmMinutesBefore,autoStartEnabled:!!Ye.auto_start_enabled,autoFinishEnabled:!!Ye.auto_finish_enabled};console.log("[AgendaSettings][LOAD]  Estado mapeado:",Gt),re(Ut=>({...Ut,...Gt})),ot(Gt),console.log("[AgendaSettings][LOAD]  Estados atualizados com sucesso!")}catch(Ye){console.warn("[AgendaSettings] unexpected load error",Ye)}})()},[F,M?.id]),p.useEffect(()=>{let Ie=!0,Ye=null,ar=!1;const Gt=async()=>{try{const{data:Ut,error:Ot}=await fe.functions.invoke("time-br",{body:{}});if(!Ot&&Ut&&Ie){const S=Number(Ut.nowMs);if(Number.isFinite(S)){const K=S-Date.now();X(K),Re(Date.now());return}}if(!ar){ar=!0;try{console.warn("[TimeSync] time-br sem dados vlidos; usando relgio local.")}catch{}}}catch{if(!ar){ar=!0;try{console.warn("[TimeSync] time-br falhou; usando relgio local.")}catch{}}}};return Gt(),Ye=setInterval(Gt,5*60*1e3),()=>{Ie=!1,Ye&&clearInterval(Ye)}},[]);const[rt,lt]=p.useState({}),$t=2*60*60*1e3,Fe=p.useCallback(Ie=>{lt(Ye=>({...Ye,[Ie]:Date.now()}))},[]),It=p.useCallback(Ie=>{lt(Ye=>{if(!Ye||!(Ie in Ye))return Ye;const ar={...Ye};return delete ar[Ie],ar})},[]),Sr=p.useCallback(Ie=>{const Ye=rt?.[Ie];return typeof Ye=="number"&&Date.now()-Ye<$t},[rt]),[kr,pr]=p.useState(null),yn=p.useCallback(()=>new Promise(Ie=>{pr({resolve:Ie})}),[]),In=p.useRef(new Map),Xn=async()=>{console.log(" [AgendaSettings][SAVE] FUNO CHAMADA! "),console.log("[AgendaSettings][SAVE] Linha 509 - Antes do try");try{if(console.log("[AgendaSettings][SAVE] Linha 511 - Dentro do try"),console.log("[AgendaSettings][SAVE] authReady:",F),console.log("[AgendaSettings][SAVE] company:",M),!F||!M?.id){console.error("[AgendaSettings][SAVE] ERRO: No autenticado",{authReady:F,company:M}),t({title:"No autenticado",description:"Faa login para salvar as configuraes.",variant:"destructive"});return}console.log("[AgendaSettings][SAVE]  Autenticado! Preparando payload..."),console.log("[AgendaSettings][SAVE] automation atual:",Nn),T(!0);const Ie={empresa_id:M.id,auto_confirm_enabled:!!Nn.autoConfirmEnabled,auto_confirm_hours:Nn.autoConfirmEnabled?Math.max(0,Math.round(Number(Nn.autoConfirmMinutesBefore||0)/60)):null,auto_start_enabled:!!Nn.autoStartEnabled,auto_finish_enabled:!!Nn.autoFinishEnabled};console.log("[AgendaSettings][SAVE] Payload preparado:",Ie),console.log("[AgendaSettings][SAVE] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][SAVE] Supabase client type:",typeof fe.from);const{data:Ye,error:ar}=await fe.from("agenda_settings").upsert(Ie,{onConflict:"empresa_id"}).select();if(console.log("[AgendaSettings][SAVE] Resultado do upsert:",{data:Ye,error:ar}),console.log("[AgendaSettings][SAVE] Data type:",Array.isArray(Ye)?"array":typeof Ye),console.log("[AgendaSettings][SAVE] Data length:",Ye?.length),ar)throw console.error("[AgendaSettings][SAVE]  ERRO no upsert:",ar),ar;!Ye||Ye.length===0?console.error("[AgendaSettings][SAVE]  AVISO: Upsert no retornou dados!"):console.log("[AgendaSettings][SAVE]  Dados salvos com sucesso:",Ye[0]),ot(Nn),console.log("[AgendaSettings][SAVE]  savedAutomation atualizado:",Nn),t({title:"Configuraes salvas",description:"As automaes da agenda foram atualizadas com sucesso."}),mn(!1),console.log("[AgendaSettings][SAVE]  Salvamento concludo!")}catch(Ie){console.error(" [AgendaSettings][SAVE] ERRO CAPTURADO:",Ie),console.error("[AgendaSettings][SAVE] Stack:",Ie?.stack),console.error("[AgendaSettings][SAVE] Message:",Ie?.message);const Ye=Ie?.message||"Falha ao salvar as configuraes.";t({title:"Erro ao salvar",description:Ye,variant:"destructive"})}finally{console.log("[AgendaSettings][SAVE] Finally executado"),T(!1)}},En=p.useCallback(async(Ie,Ye,ar="user")=>{try{const Gt=["canceled","finished","absent"],Ut=["scheduled","confirmed","in_progress"],Ot=Gt.includes(Ye);let S=!1;if(ar==="user"&&Ut.includes(Ye)){const Ce=(le||[]).find(Pe=>Pe.id===Ie),W=Ce?Gt.includes(Ce.status):!1,oe=Ce?!!Ce.auto_disabled:!1;(W||oe)&&(S=!!await yn())}const K=Ot?{status:Ye,auto_disabled:!0}:S?{status:Ye,auto_disabled:!1}:{status:Ye},{error:ne}=await fe.from("agendamentos").update(K).eq("codigo_empresa",P.codigo_empresa).eq("id",Ie).select("id");if(ne)throw ne;se(Ce=>Ce.map(W=>{if(W.id!==Ie)return W;const oe={...W,status:Ye,customer:W.customer||""};return Ot?oe.auto_disabled=!0:S&&(oe.auto_disabled=!1),oe}));try{In.current.set(Ie,{status:Ye,ts:Date.now(),src:ar})}catch{}try{const Ce=JSON.parse(localStorage.getItem(zr)||"[]");if(Array.isArray(Ce)&&Ce.length>0){const W=Array.isArray(Ce)?Ce.map(oe=>{if(oe.id!==Ie)return oe;const Pe={...oe,status:Ye,customer:oe.customer||""};return Ot?Pe.auto_disabled=!0:S&&(Pe.auto_disabled=!1),Pe}):Ce;localStorage.setItem(zr,JSON.stringify(W))}}catch{}if(ar==="user")try{S?It(Ie):Fe(Ie)}catch{}}catch(Gt){console.error("Auto-status: falha ao atualizar",Ie,Ye,Gt)}},[le,zr,Fe,It,yn,Qe]),dn=p.useRef(!1),Gr=p.useRef(null),ga=p.useRef(null),Ma=p.useRef(!1),va=p.useCallback(()=>{try{Gr.current&&(clearTimeout(Gr.current),Gr.current=null)}catch{}},[]),$a=p.useCallback(()=>{if(!F||!P?.codigo_empresa)return;if(Date.now()<(nr.current||0)){console.log("[AutoDiag] scheduleNextAutomation:deferred returning-from-hidden"),setTimeout(()=>$a(),1500);return}if(!Ma.current){j("scheduleNextAutomation:skipped (initial data not ready)"),setTimeout(()=>$a(),800);return}if(Be.current){j("scheduleNextAutomation:skipped (modal open)");return}C("auto:schedule"),va();const Ye=G();let ar=1/0;const Gt=Ut=>{Number.isFinite(Ut)&&Ut>Ye&&Ut<ar&&(ar=Ut)};try{for(const Ut of le||[]){if(!Ut||Ut.auto_disabled||Sr(Ut.id))continue;const Ot=Ut.start instanceof Date?Ut.start.getTime():new Date(Ut.start).getTime(),S=Ut.end instanceof Date?Ut.end.getTime():new Date(Ut.end).getTime();if(Ut.status==="scheduled"&&Te.autoConfirmEnabled){const K=Number(Te.autoConfirmMinutesBefore||0)*6e4;Gt(Ot-K),Te.autoFinishEnabled&&Gt(S)}Ut.status==="confirmed"&&(Te.autoStartEnabled&&Gt(Ot),Te.autoFinishEnabled&&Gt(S)),Ut.status==="in_progress"&&Te.autoFinishEnabled&&Gt(S)}}catch{}if(ar!==1/0){const Ut=Math.max(0,Math.min(ar-Ye+250,6e5));try{console.debug("[Auto] next schedule in ms",Ut)}catch{}try{rf(ar)}catch{}Gr.current=setTimeout(()=>{try{ga.current&&ga.current()}catch{}},Ut)}},[F,P?.codigo_empresa,le,Te,Sr,va,G]),ss=p.useCallback(async Ie=>{try{if(!(typeof L=="number"&&Date.now()-L<6e5))try{const{data:Gt}=await fe.functions.invoke("time-br",{body:{}}),Ut=Number(Gt?.nowMs);Number.isFinite(Ut)&&(X(Ut-Date.now()),Re(Date.now()))}catch{}try{$a()}catch{}let ar=null;if(Ie?.id&&P?.codigo_empresa){const{data:Gt}=await fe.from("agendamentos").select("id, inicio, fim, status, modalidade, quadra_id, cliente_id, auto_disabled").eq("codigo_empresa",P.codigo_empresa).eq("id",Ie.id).single();if(Gt){const Ut={...Ie,start:new Date(Gt.inicio),end:new Date(Gt.fim),status:Gt.status||Ie.status,modality:Gt.modalidade||Ie.modality,auto_disabled:!!Gt.auto_disabled,customer:Ie.customer||""};ar=Ut,se(Ot=>Ot.map(S=>S.id===Ie.id?Ut:S))}}try{const Gt=ar||Ie;if(Gt&&Gt.id){const Ut=G(),Ot=Gt.start instanceof Date?Gt.start.getTime():new Date(Gt.start).getTime(),S=Gt.end instanceof Date?Gt.end.getTime():new Date(Gt.end).getTime();if(!Gt.auto_disabled&&!Sr(Gt.id))if(Gt.status==="in_progress"&&Te.autoFinishEnabled&&Number.isFinite(S)&&Ut>=S)await En(Gt.id,"finished","automation");else if(Gt.status==="scheduled"&&Te.autoStartEnabled&&Number.isFinite(Ot)&&Ut>=Ot)await En(Gt.id,"in_progress","automation");else if(Gt.status==="confirmed"&&Te.autoStartEnabled&&Number.isFinite(Ot)&&Ut>=Ot)await En(Gt.id,"in_progress","automation");else if(Gt.status==="scheduled"&&Te.autoConfirmEnabled&&Number.isFinite(Ot)){const ne=Number(Te.autoConfirmMinutesBefore||0)*6e4;Ut>=Ot-ne&&await En(Gt.id,"confirmed","automation")}else(Gt.status==="scheduled"||Gt.status==="confirmed")&&Te.autoFinishEnabled&&Number.isFinite(S)&&Ut>=S&&await En(Gt.id,"finished","automation")}}catch{}try{ga.current&&ga.current()}catch{}try{console.log(" EditGuard | ok | tempo=",typeof L=="number"?"Servidor":"Local")}catch{}return{booking:ar}}catch(Ye){try{console.warn(" EditGuard | falha leve",Ye?.message||Ye)}catch{}return{booking:null}}},[L,fe,P,se,$a,G,Nn,Sr,En]);p.useEffect(()=>{if(!(!F||!P?.codigo_empresa)&&L&&!Ma.current){Ma.current=!0,j("initial-data:ready",{at:L});try{$a()}catch{}}},[L,F,P,$a,j]);const ao=p.useCallback(async()=>{if(!(!F||!P?.codigo_empresa)){if(Be.current){j("runAutomation:skipped (modal open)");return}if(Date.now()<(nr.current||0)){j("runAutomation:skipped (returning-from-hidden grace)");try{$a()}catch{}return}if(!Ma.current){j("runAutomation:skipped (initial data not ready)");try{$a()}catch{}return}if(!dn.current){dn.current=!0;try{try{console.debug("[Auto] tick")}catch{}C("auto:tick");const Ie=G(),Ye=new Date(Ie),ar=dr(Ye,"yyyy-MM-dd");let Gt=(le||[]).filter(Ot=>dr(Ot.start,"yyyy-MM-dd")===ar);if(Gt.length===0)try{const Ot=ko(Ye),S=La(Ot,1),{data:K,error:ne}=await fe.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",P.codigo_empresa).gte("inicio",Ot.toISOString()).lt("inicio",S.toISOString());!ne&&Array.isArray(K)&&(Gt=K.map(Ce=>({id:Ce.id,start:new Date(Ce.inicio),end:new Date(Ce.fim),status:Ce.status||"scheduled",auto_disabled:!!Ce.auto_disabled})))}catch{}try{const{data:Ot,error:S}=await fe.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",P.codigo_empresa).lt("fim",Ye.toISOString()).in("status",["scheduled","confirmed","in_progress"]);if(!S&&Array.isArray(Ot)&&Ot.length>0){const K=Ot.map(Ce=>({id:Ce.id,start:new Date(Ce.inicio),end:new Date(Ce.fim),status:Ce.status||"scheduled",auto_disabled:!!Ce.auto_disabled})),ne=new Map(Gt.map(Ce=>[Ce.id,Ce]));for(const Ce of K)ne.has(Ce.id)||ne.set(Ce.id,Ce);Gt=Array.from(ne.values())}}catch{}let Ut=!1;for(const Ot of Gt){if(Ot.auto_disabled||Sr(Ot.id))continue;const S=Ot.start instanceof Date?Ot.start.getTime():new Date(Ot.start).getTime(),K=Ot.end instanceof Date?Ot.end.getTime():new Date(Ot.end).getTime();if(Ot.status==="in_progress"&&Te.autoFinishEnabled&&Ie>=K){try{console.debug("[Auto] finish",{id:Ot.id})}catch{}await En(Ot.id,"finished","automation"),Ut=!0;continue}if(Ot.status==="scheduled"&&Te.autoStartEnabled&&Ie>=S){try{console.debug("[Auto] start-direct (skip confirm)",{id:Ot.id})}catch{}await En(Ot.id,"in_progress","automation"),Ut=!0;continue}if(Ot.status==="confirmed"&&Te.autoStartEnabled&&Ie>=S){try{console.debug("[Auto] start",{id:Ot.id})}catch{}await En(Ot.id,"in_progress","automation"),Ut=!0;continue}if(Ot.status==="scheduled"&&Te.autoConfirmEnabled){const ne=Number(Te.autoConfirmMinutesBefore||0)*6e4;if(Ie>=S-ne){try{console.debug("[Auto] confirm",{id:Ot.id})}catch{}await En(Ot.id,"confirmed","automation"),Ut=!0;continue}}if((Ot.status==="scheduled"||Ot.status==="confirmed")&&Te.autoFinishEnabled&&Ie>=K){try{console.debug("[Auto] catchup-finish",{id:Ot.id})}catch{}await En(Ot.id,"finished","automation"),Ut=!0;continue}}if(Ut)try{setTimeout(()=>{try{xo()}catch{}},800)}catch{}try{$a()}catch{}}finally{dn.current=!1}}}},[F,P?.codigo_empresa,le,Te,En,Sr,$a,G]);p.useEffect(()=>{ga.current=ao},[ao]),p.useEffect(()=>{const Ie=setInterval(ao,1e4);try{ga.current&&ga.current()}catch{}try{$a()}catch{}return()=>clearInterval(Ie)},[ao]),p.useEffect(()=>{const Ie=setInterval(()=>{try{if(!!!(Te?.autoConfirmEnabled||Te?.autoStartEnabled||Te?.autoFinishEnabled))return;ga.current&&(console.debug("[Auto][Watchdog] forcing periodic automation run"),ga.current())}catch{}},18e5);return()=>clearInterval(Ie)},[Te]),p.useEffect(()=>{if(zr)try{const Ie=JSON.parse(localStorage.getItem(zr)||"[]");if(Array.isArray(Ie)&&Ie.length>0){const Ye=Ie.map(ar=>({...ar,start:new Date(ar.start),end:new Date(ar.end),customer:ar.customer||""}));j("cache:bookings:hydrate",{count:Ye.length,sample:Ye[0]}),C("cache:hydrate",{count:Ye.length}),se(ar=>ar&&ar.length>0?ar:Ye),yr(1200)}}catch{}},[zr,j]),p.useEffect(()=>{const Ie=()=>{try{const Gt=new Date().toISOString();if(document.visibilityState==="visible"){const Ut=Date.now();nr.current=Ut+800}}catch{}},Ye=()=>{try{const Gt=new Date().toISOString()}catch{}},ar=()=>{try{const Gt=new Date().toISOString()}catch{}};return document.addEventListener("visibilitychange",Ie),window.addEventListener("focus",Ye),window.addEventListener("blur",ar),()=>{document.removeEventListener("visibilitychange",Ie),window.removeEventListener("focus",Ye),window.removeEventListener("blur",ar)}},[ee,le]),p.useEffect(()=>{try{$a()}catch{}return()=>{try{va()}catch{}}},[le,Nn,$a,va]),p.useEffect(()=>{if(_t)try{const Ie=JSON.parse(localStorage.getItem(_t)||"{}");Ie&&typeof Ie=="object"&&(et(Ie),$e.current=dr(D,"yyyy-MM-dd"))}catch{}},[_t]);const xo=p.useCallback(async()=>{if(!F||!P?.codigo_empresa||ee)return;j("fetchBookings:start",{date:dr(D,"yyyy-MM-dd"),empresa:P?.codigo_empresa}),C("fetch:start",{day:dr(D,"yyyy-MM-dd")});const Ie=ko(D),Ye=z==="week"?fp(D):Ie,ar=z==="week"?La(Ye,7):La(Ye,1),{data:Gt,error:Ut}=await fe.from("agendamentos").select(`
        id, codigo, codigo_empresa, quadra_id, cliente_id, clientes, inicio, fim, modalidade, status, auto_disabled,
        quadra:quadra_id ( nome )
      `).eq("codigo_empresa",P.codigo_empresa).gte("inicio",Ye.toISOString()).lt("inicio",ar.toISOString()).order("inicio",{ascending:!0});if(Ut){j("fetchBookings:error",{message:Ut?.message,code:Ut?.code,status:Ut?.status}),C("fetch:error",{message:Ut?.message,code:Ut?.code,status:Ut?.status}),t({title:"Erro ao carregar agendamentos",description:Ut.message,variant:"destructive"}),jt.current||(jt.current=!0,setTimeout(xo,900));return}if(!Gt||Gt.length===0){j("fetchBookings:empty-first-hit"),C("fetch:empty-first");let K=!1;try{const ne=zr?JSON.parse(localStorage.getItem(zr)||"[]"):[];K=Array.isArray(ne)&&ne.length>0}catch{}if(!jt.current&&(jt.current=!0,K)){setTimeout(xo,700);return}}jt.current=!1;const Ot=Date.now(),S=(Gt||[]).map(K=>{const ne=new Date(K.inicio),Ce=new Date(K.fim),W=K.quadra?.[0]?.nome||K.quadra?.nome||Object.values(ft).find(Ke=>Ke.id===K.quadra_id)?.nome||"";let oe="";if(ke[K.id]){const Ke=ke[K.id];Array.isArray(Ke)&&Ke.length>0&&(oe=Ke[0]?.nome||"")}if(!oe&&K.clientes)try{const Ke=typeof K.clientes=="string"?JSON.parse(K.clientes):K.clientes;Array.isArray(Ke)&&Ke.length>0&&(oe=Ke[0]?.nome||Ke[0]||"")}catch{}const Pe=In.current.get(K.id),ze=Pe&&Ot-Pe.ts<4e3;return{id:K.id,code:K.codigo,court:W,customer:oe,start:ne,end:Ce,status:ze?Pe.status:K.status||"scheduled",modality:K.modalidade||"",auto_disabled:!!K.auto_disabled}});se(S);try{if(zr){const K=S.map(ne=>({id:ne.id,code:ne.code,court:ne.court,customer:ne.customer,start:ne.start.toISOString(),end:ne.end.toISOString(),status:ne.status,modality:ne.modality,auto_disabled:ne.auto_disabled}));localStorage.setItem(zr,JSON.stringify(K))}}catch{}},[F,P?.codigo_empresa,D,ft,zr,t,j,w,ke]);p.useEffect(()=>{if(w)try{const Ie=(le||[]).map(Ye=>`${Ye.id}:${dr(Ye.start,"HH:mm")}-${dr(Ye.end,"HH:mm")}:${Ye.status}`).join(" | ");console.log("[AgendaDbg] bookings:changed",{count:Array.isArray(le)?le.length:0,summary:Ie})}catch{}},[le,w]),p.useEffect(()=>{try{const Ie=Date.now()+1800;zt.current=Ie,j("Picker:suppressClose window set",{until:Ie})}catch{}},[le]),p.useEffect(()=>{F&&P?.codigo_empresa&&xo()},[F,P?.codigo_empresa,D,ft,zr]);const Ss=p.useRef(null),[mi,kd]=p.useState("idle"),[hi,zc]=p.useState(null),Oi=p.useRef(!1);p.useEffect(()=>{if(!F||!P?.codigo_empresa)return;const Ie=ko(D),Ye=La(Ie,1),ar=ne=>{try{const Ce=new Date(ne);return Ce>=Ie&&Ce<Ye}catch{return!1}},Gt=ne=>{const Ce=ne?.new||ne?.old;if(Ce&&Ce.codigo_empresa===P.codigo_empresa&&(ar(Ce.inicio)||ar(Ce.fim))){try{console.debug("[Realtime] agendamentos change",{event:ne.eventType,id:Ce.id})}catch{}Ss.current&&clearTimeout(Ss.current);try{zc(Date.now())}catch{}if(Be.current){j("Realtime:onChange deferred due to modal open"),Oi.current=!0,C("rt:change:deferred",{id:Ce.id,event:ne.eventType});return}j("Realtime:onChange scheduling fetchBookings"),C("rt:change",{id:Ce.id,event:ne.eventType}),Ss.current=setTimeout(()=>{try{j("Realtime:debounced fetchBookings fire"),C("rt:debounced:fire"),yr(300),xo()}catch{}},400)}},Ut=ne=>{const Ce=ne?.new||ne?.old;if(Ce&&Ce.codigo_empresa===P.codigo_empresa){try{console.debug("[Realtime] agendamento_participantes change",{event:ne.eventType,agendamento_id:Ce.agendamento_id})}catch{}Ss.current&&clearTimeout(Ss.current);try{zc(Date.now())}catch{}if(Be.current){j("Realtime:onParticipantsChange deferred due to modal open"),Oi.current=!0,C("rt:participants:deferred",{agendamento_id:Ce.agendamento_id,event:ne.eventType});return}j("Realtime:onParticipantsChange scheduling fetchBookings"),C("rt:participants",{agendamento_id:Ce.agendamento_id,event:ne.eventType}),Ss.current=setTimeout(()=>{try{j("Realtime:participants debounced fetchBookings fire"),C("rt:participants:debounced:fire"),yr(300),xo()}catch{}},400)}},Ot=fe.channel(`agendamentos:${P.codigo_empresa}`).on("postgres_changes",{event:"*",schema:"public",table:"agendamentos",filter:`codigo_empresa=eq.${P.codigo_empresa}`},Gt).subscribe(ne=>{try{console.debug("[Realtime] channel status",ne)}catch{}try{kd(String(ne||"unknown"))}catch{}}),S=fe.channel(`agendamento_participantes:${P.codigo_empresa}`).on("postgres_changes",{event:"*",schema:"public",table:"agendamento_participantes",filter:`codigo_empresa=eq.${P.codigo_empresa}`},Ut).subscribe(),K=setInterval(()=>{Be.current||xo()},3e4);return()=>{try{Ss.current&&clearTimeout(Ss.current)}catch{}try{fe.removeChannel(Ot)}catch{}try{fe.removeChannel(S)}catch{}try{clearInterval(K)}catch{}try{kd("polling")}catch{}}},[F,P?.codigo_empresa,D,xo]),p.useEffect(()=>{if(!ee&&Oi.current){Oi.current=!1;try{j("Modal closed: flushing pending realtime refresh"),C("rt:flushAfterModalClose"),xo()}catch{}}},[ee,xo,j]);const[Nl,rf]=p.useState(null),Zl=p.useRef("");p.useEffect(()=>{try{const Ie=typeof L=="number"&&Date.now()-L<6e5,Ye=Ce=>typeof Ce=="number"?dr(new Date(Ce),"HH:mm:ss",{locale:wa}):"",ar=Ce=>typeof Ce=="number"?dr(new Date(Ce),"HH:mm",{locale:wa}):"",Gt=Ie?"":"",Ot=String(mi).toUpperCase()==="SUBSCRIBED"||String(mi).toLowerCase()==="polling"?"":"",S=typeof Nl=="number"?"":"",K=Array.isArray(le)?le.length:0,ne=` Agenda | ${Gt} Tempo=${Ie?"Servidor":"Local"} (${Math.round(O)}ms, sync ${Ye(L)}) |  Realtime=${Ot} ${mi}${hi?` (${Ye(hi)})`:""} | ${S} Prximo=${ar(Nl)} |  Agendamentos=${K}`;Zl.current!==ne&&(Zl.current=ne,console.log(ne)),typeof window<"u"&&(window.__AgendaConn={usingServer:Ie,serverOffsetMs:O,lastTimeSyncAtMs:L,realtimeStatus:mi,lastRealtimeEventAtMs:hi,nextAutoAtMs:Nl})}catch{}},[O,L,mi,hi,Nn,Nl,P?.codigo_empresa,D,Array.isArray(le)?le.length:0]),p.useEffect(()=>{const Ie=setInterval(()=>{try{const Ye=Date.now();if(Ye<(nr.current||0)){console.log("[AutoDiag] reconcile:skipped returning-from-hidden");return}if(ee){console.log("[AutoDiag] reconcile:skipped modal-open");return}const ar=String(mi||"").toUpperCase()==="SUBSCRIBED",Gt=typeof hi=="number"?Ye-hi:1/0,Ut=!ar||Gt>7*60*1e3,Ot=typeof Nl=="number"?Ye>Nl+60*1e3:!1;if(Ut||Ot){console.debug("[Reconcile] forcing fetchBookings (stale=",Ut," tickDue=",Ot,")"),xo();try{$a()}catch{}}}catch{}},3e5);return()=>clearInterval(Ie)},[mi,hi,Nl,xo,$a]),p.useEffect(()=>{(async()=>{if(!F||!P?.codigo_empresa||Date.now()<(nr.current||0))return;if(Be.current){j("Participants:skipped (modal open)");return}j("Participants:load start"),C("parts:start");const Ye=(le||[]).map(K=>K.id).filter(Boolean),ar=dr(D,"yyyy-MM-dd");if(!Ye.length){if($e.current!==ar){et({});try{_t&&localStorage.setItem(_t,"{}")}catch{}}$e.current=ar;return}const Gt=++Me.current,{data:Ut,error:Ot}=await fe.from("agendamento_participantes").select("id, agendamento_id, codigo_empresa, cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, ordem, cliente:clientes!agendamento_participantes_cliente_id_fkey(nome, codigo)").in("agendamento_id",Ye).order("ordem",{ascending:!0});if(Me.current!==Gt)return;if(Ot){console.warn("[Participants] load error",Ot),j("Participants:error",{message:Ot?.message,code:Ot?.code,status:Ot?.status}),C("parts:error",{code:Ot?.code});return}const S={};for(const K of Ut||[]){const ne=K.agendamento_id;S[ne]||(S[ne]=[]);const Ce=K.nome||(Array.isArray(K.cliente)?K.cliente[0]?.nome:K.cliente?.nome)||"",W=(Array.isArray(K.cliente)?K.cliente[0]?.codigo:K.cliente?.codigo)||null;S[ne].push({...K,nome:Ce,codigo:W})}j("Participants:loaded",{bookings:Ye.length,rows:(Ut||[]).length}),C("parts:loaded",{rows:(Ut||[]).length}),$e.current=ar,et(K=>{const ne={...K};for(const Ce of Ye)ne[Ce]=S[Ce]||[];try{_t&&localStorage.setItem(_t,JSON.stringify(ne))}catch{}return j("Participants:set state for ids",{ids:Ye}),C("parts:set",{idsCount:Ye.length}),ne})})()},[F,P?.codigo_empresa,le,D,_t,j]),p.useEffect(()=>{(async()=>{if(!(!F||!P?.codigo_empresa||!Dt.length)){B(!0);try{const Ye=dr(D,"yyyy-MM-dd"),ar=D.getDay(),{data:Gt,error:Ut}=await fe.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",P.codigo_empresa).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${Ye}),and(tipo.eq.dia_semana,dia_semana.eq.${ar})`);if(Ut){console.error("Erro ao carregar dias de funcionamento:",Ut);return}const Ot={};Dt.forEach(S=>{const K=ft[S];if(!K)return;const ne=Gt?.find(W=>W.quadra_id===K.id&&W.tipo==="data_fechamento"&&W.data_fechamento===Ye);if(ne&&!ne.funciona){Ot[S]={funciona:!1,motivo:"data_especifica",observacao:ne.observacao||"Fechamento especial"};return}const Ce=Gt?.find(W=>W.quadra_id===K.id&&W.tipo==="dia_semana"&&W.dia_semana===ar);Ce?Ot[S]={funciona:Ce.funciona,motivo:Ce.funciona?"normal":"dia_semana",observacao:Ce.funciona?null:"Fechado neste dia da semana"}:Ot[S]={funciona:!0,motivo:"normal",observacao:null}}),be(Ot)}catch(Ye){console.error("Erro ao verificar dias de funcionamento:",Ye)}finally{B(!1)}}})()},[F,P?.codigo_empresa,D,Dt,ft]),p.useEffect(()=>{if(!F||!P?.codigo_empresa||Dt.length===0)return;(async()=>{try{const Ye=new Date(D);Ye.setDate(Ye.getDate()-Ye.getDay());const{data:ar,error:Gt}=await fe.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",P.codigo_empresa);if(Gt){console.error("Erro ao carregar funcionamento da semana:",Gt);return}const Ut={};for(let Ot=0;Ot<7;Ot++){const S=new Date(Ye);S.setDate(S.getDate()+Ot);const K=dr(S,"yyyy-MM-dd"),ne=S.getDay(),Ce={};Dt.forEach(W=>{const oe=ft[W];if(!oe)return;const Pe=ar?.find(Ke=>Ke.quadra_id===oe.id&&Ke.tipo==="data_fechamento"&&Ke.data_fechamento===K);if(Pe&&!Pe.funciona){Ce[W]={funciona:!1,motivo:"data_especifica",observacao:Pe.observacao||"Fechamento especial"};return}const ze=ar?.find(Ke=>Ke.quadra_id===oe.id&&Ke.tipo==="dia_semana"&&Ke.dia_semana===ne);ze?Ce[W]={funciona:ze.funciona,motivo:ze.funciona?"normal":"dia_semana",observacao:ze.funciona?null:"Fechado neste dia da semana"}:Ce[W]={funciona:!0,motivo:"normal",observacao:null}}),Ut[K]=Ce}ue(Ut)}catch(Ye){console.error("Erro ao carregar funcionamento da semana:",Ye)}})()},[F,P?.codigo_empresa,D,Dt,ft]),p.useEffect(()=>{Object.values(pe).some(Ye=>!Ye.funciona)&&$n.current},[pe]),p.useEffect(()=>{if(wt)try{const Ie=JSON.parse(localStorage.getItem(Yt)||"[]");Array.isArray(Ie)&&Ie.length&&(!pt||pt.length===0)&&(Et(Ie),gt(!1))}catch{}},[wt,Yt]),p.useEffect(()=>{const Ie=async()=>{if(!P?.codigo_empresa)return;try{const Ut=JSON.parse(localStorage.getItem(Yt)||"[]");if(Array.isArray(Ut)&&Ut.length>0){const Ot=Ut[0]?.codigo_empresa;if(Ot&&Ot!==P.codigo_empresa){console.warn(" [Cache Limpo] Quadras de outra empresa detectadas e removidas"),localStorage.removeItem(Yt),localStorage.removeItem(br),Et([]);try{ye([])}catch{}try{Rr(null)}catch{}try{setForm(S=>({...S,court:""}))}catch{}}}}catch{}(!pt||pt.length===0)&&gt(!0);const{data:Ye,error:ar}=await fe.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status").eq("codigo_empresa",P.codigo_empresa).eq("status","Ativa").order("nome",{ascending:!0});if(ar){t({title:"Erro ao carregar quadras",description:ar.message}),_r.current?gt(!1):(_r.current=!0,setTimeout(Ie,900));return}const Gt=Ye||[];if(Gt.length===0){let Ut=0;try{const Ot=JSON.parse(localStorage.getItem("quadras:list")||"[]");Ut=Array.isArray(Ot)?Ot.length:0}catch{}if(Ut>0&&!_r.current){_r.current=!0,gt(!1),setTimeout(Ie,700);return}}_r.current=!1,Et(Gt);try{localStorage.setItem(Yt,JSON.stringify(Gt))}catch{}gt(!1)};F&&P?.codigo_empresa&&Ie()},[F,P?.codigo_empresa,Yt,br]),p.useEffect(()=>{try{if(mt)return;const Ie=Dt||[];form?.court&&!Ie.includes(form.court)&&setForm(Ye=>({...Ye,court:Ie[0]||""})),(!form?.court||form.court==="")&&Ie.length>0&&setForm(Ye=>({...Ye,court:Ie[0]}))}catch{}},[mt,Dt,P?.codigo_empresa]),p.useEffect(()=>{if(mt)return;const Ie=(()=>{try{return JSON.parse(localStorage.getItem(br)||"[]")}catch{return[]}})(),Ye=(()=>{try{return JSON.parse(localStorage.getItem(Mr)||"{}")}catch{return{}}})(),ar=Ie.filter(Gt=>Dt.includes(Gt));ar.length>0?ye(ar):Ft.length===0&&ye(Dt),Ye&&typeof Ye=="object"&&St(Gt=>({...Gt,canceledOnly:!1,...Ye}))},[mt,Dt.length]),p.useEffect(()=>{try{localStorage.setItem(br,JSON.stringify(Ft))}catch{}},[Ft,br]),p.useEffect(()=>{try{localStorage.setItem(Mr,JSON.stringify(Qe))}catch{}},[Qe,Mr]);const Ro=p.useMemo(()=>{const Ie=Ft.map(ar=>ft[ar]?.hora_inicio||"06:00:00").map(ar=>{const[Gt,Ut]=String(ar).split(":").map(Number);return(Gt||0)*60+(Ut||0)});if(!Ie.length)return zT;const Ye=Math.min(...Ie);return Math.floor(Ye/60)},[Ft,ft]),yo=p.useMemo(()=>{const Ie=Ft.map(ar=>ft[ar]?.hora_fim||"24:00:00").map(ar=>{const[Gt,Ut]=String(ar).split(":").map(Number);return(Gt===0&&Ut===0?24:Gt||0)*60+(Ut||0)});if(!Ie.length)return cae;const Ye=Math.max(...Ie);return Math.ceil(Ye/60)},[Ft,ft]);p.useEffect(()=>{const Ie=new Date,Ye=bu(Ie),ar=wu(Ie);setTimeout(()=>{if(!$n.current)return;const Ut=Math.max(0,(Ye-Ro)*60+ar)/Oa;$n.current.scrollTop=Math.max(0,Ut*_i-120)},150)},[Ro]);const nf=({booking:Ie,courtGridStart:Ye,courtGridEnd:ar})=>{const Gt=_i,Ut=Vr=>{const rn=bu(Vr),$r=wu(Vr);return rn===0&&$r===0?1440:rn*60+$r},Ot=Ut(Ie.start),S=Ut(Ie.end),K=Ye!==void 0?Ye:Nr?Ji.start*60:Ro*60,ne=ar!==void 0?ar:Nr?Ji.end*60:yo*60,Ce=Ot-K,W=(ne-K)/Oa;let oe=Math.floor(Ce/Oa);const Pe=Math.max(0,S-Ot),ze=Math.max(1,Math.ceil(Pe/Oa));let Ke=oe+ze;oe=Math.max(0,Math.min(oe,W-1)),Ke=Math.max(0,Math.min(Ke,W)),Ke<=oe&&(Ke=oe+1),Ke=Math.min(Ke,W);const Tt=oe*Gt;let it=(Ke-oe)*Gt;const Bt=ri[Ie.status]||ri.confirmed,Kt=Bt.icon,Ct=Bt.border,Or=ze===1,or=Or?4:aZe,Hr=Tt+or,Cr=Math.max(Or?40:32,it-or*2),Yr=Pe>=90,vr=2,lr=1.15,ct=Yr?(()=>{const Vr=Math.min(Math.max((Pe-90)/90,0),1);return Math.min(lr+Vr*(vr-lr),vr)})():1,Zr=16,cn=14,Ia=Or?16:24,Ca=Math.round(Zr*(Yr?ct:1)),cr=Math.round(cn*(Yr?ct:1)),xr=Math.round(Ia*(Yr?ct:1)),qr=Or?12:16,Kr=Or?12:16,un=Yr?Math.min(ct,1.3):1,on=Math.round(qr*un),sr=Math.round(Kr*un),nn=ke[Ie.id]||[],ur=nn.filter(Vr=>String(Vr.status_pagamento||"").toLowerCase()==="pago").length,gr=nn.length;return a.jsxs(Pr.div,{layout:ee?!1:"position",initial:ee?!1:{opacity:0,y:6},animate:ee?!1:{opacity:1,y:0},exit:ee?!1:{opacity:0,y:6},id:`booking-${Ie.id}`,className:mr("absolute left-2 right-2 rounded-md border-2 bg-surface text-sm shadow-sm z-0 cursor-pointer",Ct,"overflow-hidden transition-all duration-150 hover:bg-surface-2 hover:shadow-md"),style:{top:`${Hr}px`,height:`${Cr}px`},onClick:async()=>{const Vr=ss(Ie),rn=new Promise(Ln=>setTimeout(Ln,600));let $r=null;try{$r=await Promise.race([Vr,rn])}catch{}const Pn=$r&&$r.booking||le.find(Ln=>Ln.id===Ie.id)||Ie;try{const Ln=ke[Ie.id]||[];console.log("[ORDER:CLICK] booking",{id:Ie.id,customer:Pn?.customer||Ie.customer,partsCount:Ln.length}),Ln.length>0&&console.table(Ln.map((Qr,Bn)=>({idx:Bn+1,ordem:Qr?.ordem,nome:Qr?.nome,cliente_id:Qr?.cliente_id}))),console.log("[ORDER:CLICK] agendamento.clientes",Pn?.clientes??"(sem campo clientes)")}catch{}he(Pn),qe()},children:[a.jsx("div",{className:mr("absolute left-0 top-0 h-full w-[6px] rounded-l-md",Bt.accent)}),a.jsx("div",{className:mr("h-full flex",Or?"px-3 py-3":"px-4 py-4"),style:{paddingLeft:on,paddingRight:on,paddingTop:sr,paddingBottom:sr},children:a.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("p",{className:"font-semibold text-text-primary truncate text-base",style:{fontSize:Ca,lineHeight:1.15},children:B9(Ie.customer)}),Or&&a.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2 py-0.5 whitespace-nowrap shadow-md",style:{fontSize:cr},children:Ie.modality})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:mr("text-text-muted font-semibold text-base whitespace-nowrap"),style:{fontSize:Ca},children:[dr(Ie.start,"HH:mm"),"",dr(Ie.end,"HH:mm")]}),Or&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Kt,{className:mr(Bt.text),style:{width:xr,height:xr}}),a.jsx("span",{className:mr("truncate font-semibold",Bt.text,"text-base"),style:{fontSize:Ca},children:Bt.label})]}),Or&&gr>0&&a.jsxs("span",{className:`text-xs font-semibold rounded-full px-2 py-0.5 border ${ur===gr?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(11,Math.round(11*(Yr?ct:1)))},children:[ur,"/",gr]})]}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2 flex-wrap",children:[!Or&&a.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2.5 py-1 shadow-md",style:{fontSize:cr},children:Ie.modality}),!Or&&a.jsxs("div",{className:"flex items-center gap-1.5 text-base flex-wrap justify-end",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Kt,{className:mr(Bt.text),style:{width:xr,height:xr}}),a.jsx("span",{className:mr("truncate font-semibold",Bt.text),style:{fontSize:Ca},children:(()=>typeof window<"u"&&window.innerWidth<768&&Ie.status==="in_progress"?"Andamento":Bt.label)()})]}),gr>0&&(()=>{const Vr=typeof window<"u"&&window.innerWidth<768;return a.jsxs("span",{className:mr("font-bold rounded-full border flex items-center gap-1 whitespace-nowrap",Or?"px-2 py-0.5 text-xs":"px-2.5 py-1 text-sm",ur===gr?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"),style:{fontSize:Math.max(Or?11:13,Math.round((Or?11:13)*(Yr?ct:1)))},children:[a.jsx(Ks,{className:"w-3 h-3 flex-shrink-0"}),a.jsxs("span",{className:"whitespace-nowrap",children:[ur,"/",gr,Vr?"":" pagos"]})]})})()]})]})]})})]})},xu=()=>{p.useRef(Math.random().toString(36).slice(2)),X_();const Ie=p.useRef(0),Ye=p.useRef(""),ar=ve=>{if(!ve)return"";if(typeof ve=="string")return ve;const We=ve.nome||ve.name||"",Xe=ve.codigo??ve.code;return Xe!=null?`[${Xe}] ${We}`:We},Gt=ve=>ve?typeof ve=="string"?ve:ve.nome||ve.name||"":"",Ut=ve=>{const We=ft[ve];if(!We)return{start:Ro*60,end:yo*60};const[Xe,xt]=String(We.hora_inicio||"06:00:00").split(":").map(Number),[vt,Lr]=String(We.hora_fim||"24:00:00").split(":").map(Number),Ht=vt===0&&Lr===0?24:vt;return{start:Xe*60+(xt||0),end:Ht*60+(Lr||0)}},Ot=()=>{const ve=bu(new Date),We=wu(new Date),Xe=ve*60+We,xt=Dt[0]||"",vt=Ut(xt);return Math.max(vt.start,Math.min(vt.end-Oa,Math.round(Xe/Oa)*Oa))},[S,K]=p.useState(()=>{let ve=[];try{const Xe=sessionStorage.getItem("agenda:customerPicker:closingAt"),xt=Xe?Number(Xe):0,vt=xt&&Date.now()-xt<1e4,Lr=sessionStorage.getItem(cn),Ht=Lr?JSON.parse(Lr):[];if(vt&&Array.isArray(Ht)&&Ht.length>0?ve=Ht:Array.isArray(xr)&&xr.length>0?ve=xr:Array.isArray(ct.current)&&ct.current.length>0&&(ve=ct.current),ve.length>0)try{Ce.current=!0}catch{}}catch{}return{selectedClients:ve,court:(()=>Dt.find(xt=>!pe[xt]||pe[xt].funciona)||Dt[0]||"")(),modality:Zh[0],status:"scheduled",date:D,startMinutes:Ot(),endMinutes:Ot()+60}}),ne=p.useRef([]),Ce=p.useRef(!1),W=p.useRef(null);p.useEffect(()=>{ne.current=Array.isArray(S.selectedClients)?S.selectedClients:[];try{(ne.current||[]).length>0&&(Ce.current=!0)}catch{}},[S.selectedClients]);const[oe,Pe]=p.useState(!1),[ze,Ke]=p.useState(""),Tt=p.useRef(!1);p.useEffect(()=>{try{if(!ee||!tt?.id||Tt.current)return;const ve=ke[tt.id]||[];if(!Array.isArray(ve)||ve.length===0)return;const We=ve.map(vt=>({id:vt.cliente_id,nome:vt.nome,codigo:vt.codigo??null})),Xe=Array.isArray(S.selectedClients)?S.selectedClients:[];if(!(Xe.length===We.length&&Xe.every((vt,Lr)=>vt&&We[Lr]&&vt.id===We[Lr].id))){K(vt=>({...vt,selectedClients:We}));try{ct.current=We}catch{}try{Kr(We)}catch{}try{Ce.current=!0}catch{}try{sessionStorage.setItem(cn,JSON.stringify(We))}catch{}try{kt.current=Date.now()+1500}catch{}try{console.log("[ORDER:OPEN_MODAL] chips (aplicados)",We.map(vt=>vt.nome)),console.table(ve.map((vt,Lr)=>({idx:Lr+1,ordem:vt?.ordem,nome:vt?.nome,cliente_id:vt?.cliente_id})))}catch{}}Tt.current=!0}catch{}},[ee,tt?.id,ke]),p.useEffect(()=>{try{if(!ee||!tt?.id)return;const ve=ke[tt.id]||[];if(!Array.isArray(ve)||ve.length===0)return;const We=ve.map(Ht=>Ht.cliente_id),Xe=Array.isArray(S.selectedClients)?S.selectedClients:[];if(Xe.length===0)return;const xt=new Map(We.map((Ht,rr)=>[Ht,rr])),vt=[...Xe].sort((Ht,rr)=>{const hn=xt.has(Ht.id)?xt.get(Ht.id):Number.MAX_SAFE_INTEGER,kn=xt.has(rr.id)?xt.get(rr.id):Number.MAX_SAFE_INTEGER;return hn-kn});if(vt.length===Xe.length&&vt.some((Ht,rr)=>Ht?.id!==Xe[rr]?.id)){console.log("[ORDER:ENFORCE] Ajustando chips ->",vt.map(Ht=>Ht.nome)),K(Ht=>({...Ht,selectedClients:vt}));try{ct.current=vt}catch{}try{Kr(vt)}catch{}try{sessionStorage.setItem(cn,JSON.stringify(vt))}catch{}}}catch{}},[ee,tt?.id,ke,S.selectedClients]),p.useEffect(()=>{try{if(!ee)return;const ve=Array.isArray(S.selectedClients)?S.selectedClients:[];ve.length>0&&console.log("[ORDER:CHIPS] atual:",ve.map(We=>We.nome))}catch{}},[ee,S.selectedClients]);const[it,Bt]=p.useState(0),Kt=p.useRef(0),Ct=p.useRef(!1);p.useEffect(()=>{const ve=()=>{try{if(document.visibilityState==="hidden"){Ct.current=!!(Qt||oe);const We=Date.now();try{kt.current=We+1200}catch{}try{zt.current=We+1200}catch{}try{Kt.current=We+800}catch{}}else if(document.visibilityState==="visible"){const We=Ct.current;Ct.current=!1;const Xe=Date.now();try{kt.current=Math.max(kt.current||0,Xe+600)}catch{}try{zt.current=Math.max(zt.current||0,Xe+600)}catch{}try{Kt.current=Math.max(Kt.current||0,Xe+400)}catch{}We&&!Be.current&&setTimeout(()=>{Be.current||(Pe(!0),Se(!0))},60)}}catch{}};return document.addEventListener("visibilitychange",ve),()=>document.removeEventListener("visibilitychange",ve)},[Qt,oe,ee]),p.useEffect(()=>{},[oe,Qt]);const Or=p.useRef(0);p.useEffect(()=>{const ve=Array.isArray(S.selectedClients)?S.selectedClients.length:-1,We=Or.current;ve!==We&&(Or.current=ve)},[S.selectedClients,oe,Qt]);const[jr,or]=p.useState(!1),[Hr,Cr]=p.useState(null),[Yr,vr]=p.useState(!1),lr=p.useRef(!1),ct=p.useRef([]),Zr=p.useRef("init"),cn=p.useMemo(()=>{try{return`agenda:lastSelection:${P?.codigo_empresa||"no-company"}`}catch{return"agenda:lastSelection:no-company"}},[P?.codigo_empresa]),Ia=p.useCallback(ve=>{try{sessionStorage.setItem(cn,JSON.stringify(ve||[]))}catch{}},[cn]),Ca=p.useCallback(()=>{try{const ve=sessionStorage.getItem(cn);if(ve){const We=JSON.parse(ve);Array.isArray(We)&&(ct.current=We)}}catch{}},[cn]),cr=p.useRef(!1),[xr,qr]=p.useState([]),Kr=p.useCallback(ve=>{qr(ve)},[]),un=p.useRef(null),on=p.useRef(null),sr=p.useRef([]);p.useEffect(()=>{Qt&&sr.current[it]&&sr.current[it]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[it,Qt]),p.useEffect(()=>{Qt&&Bt(0)},[Qt]);const[nn,ur]=p.useState(!1),[gr,Vr]=p.useState(!1);p.useState(!1);const[rn,$r]=p.useState(!1),[Pn,Ln]=p.useState(!1),Qr=p.useRef(null),Bn=p.useRef(null),Pa=p.useRef(!1);p.useEffect(()=>{if(!o)return;let ve=!1;return(async()=>{try{if(!F||!P?.codigo_empresa)return;const We=await Wm({somenteAtivas:!0,codigoEmpresa:P.codigo_empresa});ve||b(Array.isArray(We)?We:[])}catch{}})(),()=>{ve=!0}},[o,F,P?.codigo_empresa]),p.useEffect(()=>{if(!o||!Array.isArray(x)||x.length===0)return;const ve=String(x[0].id);v(We=>We.length===0&&Array.isArray(S.selectedClients)&&S.selectedClients.length>0?S.selectedClients.map(vt=>({cliente_id:vt.id,nome:vt.nome,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:ve})):We.map(xt=>({...xt,finalizadora_id:xt.finalizadora_id&&xt.finalizadora_id!==""?xt.finalizadora_id:ve})))},[o,x]);const Ja=p.useCallback((ve,We)=>{try{const Xe=Date.now(),xt=Xe<(Fr.current||0)||Xe<(zt.current||0),vt=!Qt,Lr=!!cr.current;let Ht=Array.isArray(We)?We:[];if(Ht.length===0&&vt&&xt&&!Lr){const rr=Array.isArray(ct.current)?ct.current:[];rr.length>0&&(Ht=rr)}try{if(!tt&&Array.isArray(Ht)&&Ht.length>0&&W.current){const rr=Ht.findIndex(hn=>hn&&hn.id===W.current);rr>0&&(Ht=[Ht[rr],...Ht.filter((kn,wn)=>wn!==rr)])}}catch{}try{if(tt?.id){const rr=ke[tt.id]||[];if(Array.isArray(rr)&&rr.length>0){const hn=rr.map(wn=>wn.cliente_id),kn=new Map(hn.map((wn,an)=>[wn,an]));Ht=[...Ht].sort((wn,an)=>{const sa=kn.has(wn.id)?kn.get(wn.id):Number.MAX_SAFE_INTEGER,xa=kn.has(an.id)?kn.get(an.id):Number.MAX_SAFE_INTEGER;return sa-xa}),console.log("[ORDER:APPLY] Ajustado por ordem persistida ->",Ht.map(wn=>wn.nome))}}}catch{}if(K(rr=>({...rr,selectedClients:Ht})),Array.isArray(Ht)&&Ht.length>0){ct.current=Ht,Kr(Ht);try{sessionStorage.setItem(cn,JSON.stringify(Ht))}catch{}cr.current=!1}try{Zr.current=ve}catch{}}catch{}},[Qt,K,Kr,cn]);p.useState(""),p.useRef(null),p.useEffect(()=>{try{He.current=Date.now()}catch{}},[oe,gr]),p.useEffect(()=>{if(w){if(ht.current=oe,oe)A("customer-picker",6e3),C("picker:open"),hr.current=!0,Se(!0);else if(C("picker:close"),E("picker-close"),Oi.current){Oi.current=!1;try{j("Picker closed: flushing pending refresh"),C("picker:flush"),xo()}catch{}}}},[oe]);const po=p.useCallback((ve,We={})=>{if(w)try{const Xe=new Date().toISOString(),xt=we.current,vt=!!hr.current,Lr=!!lr.current}catch{}},[w,ee,oe,Qt,gr,jr]);p.useEffect(()=>{w&&po("state-change",{isCustomerPickerOpen:oe,effectiveCustomerPickerOpen:Qt})},[w,oe,Qt]),p.useEffect(()=>{if(!ee||Qt)return;const ve=Array.isArray(S.selectedClients)?S.selectedClients:[],We=Array.isArray(ct.current)?ct.current:[],Xe=Date.now()<(kt.current||0);if(ve.length===0&&We.length>0&&!cr.current&&Xe)Zr.current="global:restore",K(xt=>({...xt,selectedClients:We}));else if(ve.length===0&&We.length>0&&cr.current&&!Xe)try{ct.current=[]}catch{}},[ee,Qt,S.selectedClients]),p.useEffect(()=>{if(!ee)return;let ve=hr.current;try{const Xe=localStorage.getItem("agenda:customerPicker:desiredAt");if(Xe){const xt=Number(Xe);Number.isFinite(xt)&&Date.now()-xt<3e3&&(ve=!0)}}catch{}if(!ve||oe||Date.now()<zt.current||Xt())return;const We=Date.now();We-Mt.current<800||(Mt.current=We,we.current="open",Pe(!0),Se(!0))},[oe,ee]),p.useEffect(()=>{const ve=Array.isArray(S.selectedClients)?S.selectedClients:[];ve.length>0&&(ct.current=ve,Ia(ve),Kr(ve))},[S.selectedClients,Ia]);const Id=p.useRef(""),Uc=p.useRef(!1);p.useEffect(()=>{try{if(!ee||!tt?.id)return;const ve=Array.isArray(S.selectedClients)?S.selectedClients:[],We=JSON.stringify(ve.map(Xe=>({id:Xe?.id,nome:Xe?.nome||null,codigo:Xe?.codigo??null})));if(We===Id.current)return;Id.current=We,(async()=>{if(!Uc.current){Uc.current=!0;try{const Xe=tt.id,xt=P?.codigo_empresa;if(!Xe||!xt)return;if(ve.length===0){console.log(" [EDIT-MODAL] seleo vazia detectada (skip persist)");return}try{const kn=Array.isArray(ke?.[Xe])?ke[Xe]:[];if(kn.length===ve.length&&kn.every((sa,xa)=>String(sa?.cliente_id)===String(ve[xa]?.id))){console.log(" [EDIT-MODAL] seleo igual ao banco (skip persist)");return}}catch{}console.log(" [EDIT-MODAL] Mudana em selectedClients detectada. Salvando participantes...");const{data:vt}=await fe.from("agendamento_participantes").select("*").eq("codigo_empresa",xt).eq("agendamento_id",Xe).order("ordem",{ascending:!0}).order("id",{ascending:!0}),Lr=vt||[];if(await fe.from("agendamento_participantes").delete().eq("codigo_empresa",xt).eq("agendamento_id",Xe),ve.length>0){const kn=ve.map((wn,an)=>{const sa=Lr[an],xa=sa&&sa.cliente_id===wn.id;return{codigo_empresa:xt,agendamento_id:Xe,cliente_id:wn.id,nome:wn.nome,ordem:an+1,valor_cota:xa?sa.valor_cota??0:0,status_pagamento:xa?sa.status_pagamento??"Pendente":"Pendente",finalizadora_id:xa?sa.finalizadora_id??null:null,aplicar_taxa:xa?sa.aplicar_taxa??!1:!1}});await fe.from("agendamento_participantes").insert(kn)}const Ht=ve[0]||null,rr=ve.map(kn=>kn?.nome).filter(Boolean);await fe.from("agendamentos").update({cliente_id:Ht?.id??null,clientes:rr}).eq("codigo_empresa",xt).eq("id",Xe),se(kn=>kn.map(wn=>wn.id===Xe?{...wn,customer:Ht?.nome||wn.customer,cliente_id:Ht?.id??null,clientes:rr}:wn));const hn=ve.map((kn,wn)=>{const an=Lr[wn],sa=an&&an.cliente_id===kn.id;return{cliente_id:kn.id,nome:kn.nome,codigo:kn.codigo??null,valor_cota:sa?an.valor_cota??0:0,status_pagamento:sa?an.status_pagamento??"Pendente":"Pendente",finalizadora_id:sa?an.finalizadora_id??null:null,aplicar_taxa:sa?an.aplicar_taxa??!1:!1,ordem:wn+1}});et(kn=>({...kn,[Xe]:hn})),v(hn),console.log(" [EDIT-MODAL] Participantes salvos imediatamente")}catch(Xe){console.error(" [EDIT-MODAL] Falha ao salvar mudana de chips:",Xe)}finally{Uc.current=!1}}})()}catch{}},[ee,tt?.id,S.selectedClients]),p.useEffect(()=>{if(!ee||(Ca(),Qt)||hr.current)return;const ve=Array.isArray(S.selectedClients)?S.selectedClients:[],We=(()=>{const Xe=Array.isArray(ct.current)?ct.current:[];if(Xe&&Xe.length>0)return Xe;try{const xt=sessionStorage.getItem(cn),vt=xt?JSON.parse(xt):[];return Array.isArray(vt)?vt:[]}catch{return[]}})();ve.length===0&&We.length>0&&!cr.current&&(K(Xe=>({...Xe,selectedClients:We})),lr.current=!1)},[Qt,ee,Ca,cn]);const go=p.useRef(0);p.useEffect(()=>{try{const ve=Date.now(),We=Array.isArray(ne.current)?ne.current:[],Xe=Array.isArray(ct.current)?ct.current:[];if(ve-go.current>300&&(go.current=ve),ee&&!Qt&&We.length===0&&Xe.length>0&&!cr.current){try{Fr.current=Date.now()+2e3}catch{}try{const xt=zt?.current||0,vt={ts:new Date().toISOString(),reason:"empty-after-close",modalOpen:ee,pickerOpen:Qt,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:We.length,lastLen:Xe.length,clearedByUser:!!cr?.current,lastAction:Zr?.current,chipsLen:Array.isArray(xr)?xr.length:NaN,clientsLoading:!!gr,suppressUntil:xt}}catch{}Kr(Xe);try{sessionStorage.setItem(cn,JSON.stringify(Xe))}catch{}K(xt=>({...xt,selectedClients:[...Xe]}));try{Promise.resolve().then(()=>{K(xt=>({...xt,selectedClients:[...ct.current]}))})}catch{}try{requestAnimationFrame(()=>{K(xt=>({...xt,selectedClients:[...ct.current||[]]}))})}catch{}setTimeout(()=>{const xt=Array.isArray(ne.current)?ne.current:[],vt=Array.isArray(ct.current)?ct.current:[];xt.length===0&&vt.length>0&&K(Lr=>({...Lr,selectedClients:[...vt]}))},25),setTimeout(()=>{const xt=Array.isArray(ne.current)?ne.current:[],vt=Array.isArray(ct.current)?ct.current:[];xt.length===0&&vt.length>0&&K(Lr=>({...Lr,selectedClients:[...vt]}))},120),setTimeout(()=>{const xt=Array.isArray(ne.current)?ne.current:[],vt=Array.isArray(ct.current)?ct.current:[];xt.length===0&&vt.length>0&&K(Lr=>({...Lr,selectedClients:[...vt]}))},240)}}catch{}},[S.selectedClients,Qt,ee]),p.useEffect(()=>{try{const ve=now<(Fr.current||0),We=Array.isArray(ne.current)?ne.current:[],Xe=Array.isArray(ct.current)?ct.current:[],xt=now<(kt.current||0);if(ee&&!Qt&&(ve||xt)&&We.length===0&&Xe.length>0&&!cr.current){qr(Xe);try{sessionStorage.setItem(cn,JSON.stringify(Xe))}catch{}K(vt=>({...vt,selectedClients:[...Xe]}));try{requestAnimationFrame(()=>K(vt=>({...vt,selectedClients:[...ct.current||[]]})))}catch{}setTimeout(()=>K(vt=>({...vt,selectedClients:[...ct.current||[]]})),32),setTimeout(()=>K(vt=>({...vt,selectedClients:[...ct.current||[]]})),96)}}catch{}},[S.selectedClients,Qt,ee]),p.useEffect(()=>{const ve=Date.now();if(ve<(nr.current||0)||!ee||Qt||ve>=(kt.current||0))return;const We=Array.isArray(S.selectedClients)?S.selectedClients:[],Xe=Array.isArray(ct.current)?ct.current:[];if(We.length===0&&Xe.length>0){qr(Xe);try{sessionStorage.setItem(cn,JSON.stringify(Xe))}catch{}K(xt=>({...xt,selectedClients:[...Xe]})),Promise.resolve().then(()=>K(xt=>({...xt,selectedClients:[...ct.current||[]]}))),setTimeout(()=>K(xt=>({...xt,selectedClients:[...ct.current||[]]})),24),setTimeout(()=>K(xt=>({...xt,selectedClients:[...ct.current||[]]})),80),setTimeout(()=>K(xt=>({...xt,selectedClients:[...ct.current||[]]})),240)}},[S.selectedClients,ee,Qt]);const[of,Sl]=p.useState([]);p.useEffect(()=>{o&&Sl([])},[o]);const is=p.useRef(!1),Zs=p.useRef(!1),[Wh,Vc]=p.useState(null);p.useState(null);const Od=p.useRef(!1);p.useEffect(()=>{const ve=Array.isArray(S.selectedClients)?S.selectedClients:[],We=Wh,Xe=We&&ve.some(xt=>xt&&xt.id===We);ve.length>0&&!Xe?Vc(ve[0]?.id||null):ve.length===0&&We&&Vc(null)},[S.selectedClients,ee,tt]);const Qi=p.useRef(!1),gi=p.useRef(!1),[Wo,ec]=p.useState(Fn),Wc=p.useRef(0);p.useEffect(()=>{if(!(Date.now()<(nr.current||0)))if(gr){Wc.current||(Wc.current=Date.now());const We=setTimeout(()=>{gr&&(!Array.isArray(Wo)||Wo.length===0)&&Vr(!1)},2e3);return()=>clearTimeout(We)}else Wc.current=0},[gr,Wo]);const Cl=p.useMemo(()=>Array.isArray(S.selectedClients)?S.selectedClients:[],[S.selectedClients]),Pl=p.useMemo(()=>{const ve=Cl||[];if(ve.length===0)return"Adicionar clientes";const We=ve[0]?.nome||"Cliente",Xe=ve.length-1;return Xe>0?`${We} +${Xe}`:We},[Cl]),tc=p.useMemo(()=>{const ve=Array.isArray(S.selectedClients)?S.selectedClients:[],We=Array.isArray(ne.current)?ne.current:[],Xe=Array.isArray(ct.current)?ct.current:[],xt=Array.isArray(xr)?xr:[];return ve.length>0&&ve.every(vt=>vt?.nome)?ve:ve.length>0?ve.map(vt=>{if(vt?.nome)return vt;const Lr=We.find(kn=>kn?.id===vt?.id),Ht=Xe.find(kn=>kn?.id===vt?.id),rr=xt.find(kn=>kn?.id===vt?.id),hn=(Wo||[]).find(kn=>kn?.id===vt?.id);return{...vt,nome:Lr?.nome||Ht?.nome||rr?.nome||hn?.nome||vt?.nome||"Cliente"}}):We.length>0&&We.every(vt=>vt?.nome)?We:xt.length>0&&xt.every(vt=>vt?.nome)?xt:Xe.length>0&&Xe.every(vt=>vt?.nome)?Xe:ve},[S.selectedClients,xr,Wo]);p.useEffect(()=>{if(!(Date.now()<(nr.current||0)))try{j("Chips:effective change",{effectiveLen:Array.isArray(Cl)?Cl.length:0,formLen:Array.isArray(S.selectedClients)?S.selectedClients.length:0,lastLen:Array.isArray(ct.current)?ct.current.length:0,pickerOpen:oe})}catch{}},[Cl,S.selectedClients,oe]);const Ua=p.useRef(null),Za=p.useRef(!1);p.useEffect(()=>{if(ee){Array.isArray(Fn)&&Fn.length>0&&ec(Fn);try{if(!Wo||Wo.length===0){const ve=P?.codigo_empresa?`clientes:list:${P.codigo_empresa}`:null;if(ve){const We=JSON.parse(localStorage.getItem(ve)||"[]");Array.isArray(We)&&We.length>0&&ec(We)}}}catch{}}},[ee,Fn]),p.useEffect(()=>{ee||(Ua.current=null,Vr(!1))},[ee]),p.useEffect(()=>{ee||(is.current=!1,Zs.current=!1,$r(!1),gi.current=!1)},[ee]);const Lo=p.useRef(!1);p.useEffect(()=>{if(ee&&!Lo.current){Lo.current=!0;try{const ve=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",We=sessionStorage.getItem("agenda:customerPicker:closingAt"),Xe=We?Number(We):0,xt=Xe&&Date.now()-Xe<1e4;ve&&xt?Ye.current=ve:Ye.current||(Ye.current=`${Date.now()}-${Math.random().toString(36).slice(2)}`),sessionStorage.setItem("agenda:modal:sessionId",Ye.current)}catch{}if(!tt){try{const ve=sessionStorage.getItem("agenda:customerPicker:closingAt"),We=ve?Number(ve):0,Xe=We&&Date.now()-We<1e4,xt=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",vt=sessionStorage.getItem("agenda:modal:sessionId")||"",Lr=sessionStorage.getItem(cn),Ht=Lr?JSON.parse(Lr):[];if(Xe&&Array.isArray(Ht)&&Ht.length>0&&xt&&vt&&xt===vt){try{Ce.current=!0}catch{}K(rr=>({...rr,selectedClients:Ht})),ct.current=Ht,Kr(Ht);try{cr.current=!1}catch{}try{Promise.resolve().then(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})))}catch{}try{requestAnimationFrame(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})))}catch{}setTimeout(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})),24),setTimeout(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})),96);return}if(Xe&&Array.isArray(Ht)&&Ht.length>0){try{Ce.current=!0}catch{}K(rr=>({...rr,selectedClients:Ht})),ct.current=Ht,Kr(Ht);try{cr.current=!1}catch{}try{Promise.resolve().then(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})))}catch{}try{requestAnimationFrame(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})))}catch{}setTimeout(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})),24),setTimeout(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})),96);return}}catch{}try{if(Date.now()<(Ie.current||0))return}catch{}try{hr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{const ve=sessionStorage.getItem(cn),We=ve?JSON.parse(ve):[],Xe=Array.isArray(ct.current)?ct.current:[];if(!(Array.isArray(We)&&We.length>0||Array.isArray(Xe)&&Xe.length>0)){try{ct.current=[]}catch{}try{qr([])}catch{}try{cr.current=!1}catch{}K(xt=>({...xt,selectedClients:[]}))}}catch{try{ct.current=[]}catch{}try{qr([])}catch{}try{cr.current=!1}catch{}K(ve=>({...ve,selectedClients:[]}))}}}else!ee&&Lo.current;if(tt)bo.current=!1;else{if(bo.current)return;bo.current=!0;try{const ve=sessionStorage.getItem("agenda:customerPicker:closingAt"),We=ve?Number(ve):0,Xe=We&&Date.now()-We<5e3,xt=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",vt=sessionStorage.getItem("agenda:modal:sessionId")||"",Lr=sessionStorage.getItem(cn),Ht=Lr?JSON.parse(Lr):[];if(Xe&&Array.isArray(Ht)&&Ht.length>0&&xt&&vt&&xt===vt){try{Ce.current=!0}catch{}K(rr=>({...rr,selectedClients:Ht})),ct.current=Ht,Kr(Ht);try{cr.current=!1}catch{}try{Promise.resolve().then(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})))}catch{}try{requestAnimationFrame(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})))}catch{}setTimeout(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})),24),setTimeout(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})),96);return}if(Xe&&Array.isArray(Ht)&&Ht.length>0){try{Ce.current=!0}catch{}K(rr=>({...rr,selectedClients:Ht})),ct.current=Ht,Kr(Ht);try{cr.current=!1}catch{}try{Promise.resolve().then(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})))}catch{}try{requestAnimationFrame(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})))}catch{}setTimeout(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})),24),setTimeout(()=>K(rr=>({...rr,selectedClients:[...ct.current||[]]})),96);return}}catch{}try{if(Date.now()<(Ie.current||0))return}catch{}try{hr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{cr.current=!1}catch{}try{const ve=sessionStorage.getItem(cn),We=ve?JSON.parse(ve):[],Xe=Array.isArray(ct.current)?ct.current:[];if(!(Array.isArray(We)&&We.length>0||Array.isArray(Xe)&&Xe.length>0)){try{ct.current=[]}catch{}try{qr([])}catch{}K(xt=>({...xt,selectedClients:[]}))}}catch{try{ct.current=[]}catch{}try{qr([])}catch{}K(ve=>({...ve,selectedClients:[]}))}}},[ee,tt]);const bo=p.useRef(!1);p.useEffect(()=>{if(!ee){bo.current=!1;try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt"),sessionStorage.removeItem("agenda:customerPicker:sessionId"),sessionStorage.removeItem("agenda:modal:sessionId"),Ye.current="",sessionStorage.removeItem(cn);try{ct.current=[]}catch{}try{qr([])}catch{}try{Ce.current=!1}catch{}try{Ie.current=0}catch{}try{kt.current=0}catch{}ae(!1),At(4);try{zt.current=0}catch{}try{we.current=null}catch{}try{hr.current=!1}catch{}K(ve=>({...ve,selectedClients:[]})),Vc(null)}catch{}return}if(tt)bo.current=!1;else{if(bo.current)return;bo.current=!0;try{if(Date.now()<(Ie.current||0))return}catch{}try{hr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{cr.current=!1}catch{}try{const ve=sessionStorage.getItem(cn),We=ve?JSON.parse(ve):[],Xe=Array.isArray(ct.current)?ct.current:[];if(!(Array.isArray(We)&&We.length>0||Array.isArray(Xe)&&Xe.length>0)){try{ct.current=[]}catch{}try{qr([])}catch{}K(xt=>({...xt,selectedClients:[]}))}}catch{try{ct.current=[]}catch{}try{qr([])}catch{}K(ve=>({...ve,selectedClients:[]}))}}},[ee,tt]);const Yo=p.useCallback(async(ve={})=>{const{autoSave:We=!1}=ve;if(!rn){$r(!0);try{const Xe=ft[S.court];if(!Xe){t({title:"Selecione uma quadra",variant:"destructive"}),is.current=!1,Zs.current=!1;return}const xt=S.startMinutes,vt=S.endMinutes;if(!(Number.isFinite(xt)&&Number.isFinite(vt)&&vt>xt)){t({title:"Horrio invlido",variant:"destructive"}),is.current=!1,Zs.current=!1;return}if(!rc(xt,vt)){t({title:"Conflito de horrio",description:"O horrio selecionado est ocupado.",variant:"destructive"}),is.current=!1,Zs.current=!1;return}const Ht=(ha,Ea)=>new Date(ha.getFullYear(),ha.getMonth(),ha.getDate(),Math.floor(Ea/60),Ea%60,0,0),rr=Ht(S.date,xt),hn=Ht(S.date,vt);let kn=Array.isArray(S.selectedClients)&&S.selectedClients.length>0?S.selectedClients:Array.isArray(ne.current)?ne.current:[];if((!kn||kn.length===0)&&tt?.id)try{const ha=Array.isArray(ct.current)?ct.current:[];ha&&ha.length>0&&(kn=ha,K(Ea=>({...Ea,selectedClients:ha})))}catch{}const wn=[...kn];console.log(" [FIX] selNowSnapshot criado:",wn.length,"participantes"),console.log(" [FIX] form.selectedClients:",S.selectedClients?.length||0),console.log(" [FIX] editingBooking.id:",tt?.id),console.log(" [LOG 3 - FECHAR MODAL AGENDAMENTO] Estado ao salvar:"),console.log("   Participantes selecionados:",wn.length),wn.forEach((ha,Ea)=>{console.log(`   #${Ea+1}: ${ha.nome}`)}),console.log("   participantsForm (contexto):",(m||[]).length),(m||[]).forEach((ha,Ea)=>{console.log(`   #${Ea+1}: ${ha.nome} | Status: ${ha.status_pagamento} | Valor: ${ha.valor_cota}`)});let an=wn,sa=!1;if(tt?.id){const ha=wn.map(eo=>eo.nome).sort().join("|");let Ea="";const Ti=ke[tt.id]||[];if(Ti.length>0&&(Ea=Ti.map(eo=>eo.nome).sort().join("|")),sa=ha!==Ea,console.log(" [DEBUG] Comparao de nomes:"),console.log("   nomesAtuais:",ha),console.log("   nomesOriginais:",Ea),console.log("   editingBooking.clientes:",tt.clientes),console.log("   houveMudancaDeParticipantes:",sa),!sa){let eo=[];if(tt.clientes)try{eo=Array.isArray(tt.clientes)?tt.clientes:JSON.parse(tt.clientes)}catch{eo=(ke[tt.id]||[]).map(wo=>wo.nome)}else eo=(ke[tt.id]||[]).map(wo=>wo.nome);eo.length>0&&(an=[...kn].sort((Di,wo)=>{const Qo=eo.findIndex(vi=>vi===Di.nome),Mi=eo.findIndex(vi=>vi===wo.nome);return Qo!==-1&&Mi!==-1?Qo-Mi:Qo!==-1?-1:Mi!==-1?1:0}))}}const xa=an[0],Aa=an.map(Gt).filter(Boolean);if(!tt?.id&&!xa?.id){t({title:"Selecione um cliente",description:"Para criar um agendamento, selecione pelo menos um cliente.",variant:"destructive"});return}if(tt?.id){const ha=tt.status,Ea=S.status!==ha,Ti={quadra_id:Xe.id,cliente_id:xa?.id??null,clientes:Aa,inicio:rr.toISOString(),fim:hn.toISOString(),modalidade:S.modality};if(!Ea){let ka=S.status;try{const ti=G(),Zo=rr.getTime();if(!!Nn?.autoConfirmEnabled&&Number.isFinite(Number(Nn?.autoConfirmMinutesBefore))){const xi=Number(Nn.autoConfirmMinutesBefore)*6e4,Al=Zo-xi;ka==="confirmed"&&ti<Al?ka="scheduled":ka==="scheduled"&&ti>=Al&&(ka="confirmed")}}catch{}Ti.status=ka}const{error:eo}=await fe.from("agendamentos").update(Ti).eq("codigo_empresa",P.codigo_empresa).eq("id",tt.id);if(eo)throw eo;const{data:Di}=await fe.from("agendamento_participantes").select("*").eq("codigo_empresa",P.codigo_empresa).eq("agendamento_id",tt.id).order("ordem",{ascending:!0}).order("id",{ascending:!0}),wo=Di||[];if(console.log(" [SAVE-BOOKING] houveMudancaDeParticipantes:",sa),console.log(" [SAVE-BOOKING] currentArray.length:",wo.length),console.log(" [SAVE-BOOKING] selNowFinal.length:",an.length),sa){if(!an||an.length===0)console.error(" [SAVE-BOOKING] PROTEO ACIONADA: No vou deletar participantes com selNowFinal vazio!"),console.error(" [SAVE-BOOKING] Isso evita perda de dados. Verifique por que selNowFinal est vazio.");else{console.log(" [SAVE-BOOKING] Deletando e recriando participantes...");const{error:ka}=await fe.from("agendamento_participantes").delete().eq("codigo_empresa",P.codigo_empresa).eq("agendamento_id",tt.id);ka&&console.error("Erro ao deletar participantes:",ka)}if(an&&an.length>0){const ka=an.map((Zo,Cs)=>{const xi=wo[Cs],Al=xi&&xi.cliente_id===Zo.id;return{codigo_empresa:P.codigo_empresa,agendamento_id:tt.id,cliente_id:Zo.id,nome:Zo.nome,ordem:Cs+1,valor_cota:Al?xi.valor_cota??0:0,status_pagamento:Al?xi.status_pagamento??"Pendente":"Pendente",finalizadora_id:Al?xi.finalizadora_id??null:null,aplicar_taxa:Al?xi.aplicar_taxa??!1:!1,pago_em:Al?xi.pago_em??null:null}}),{error:ti}=await fe.from("agendamento_participantes").insert(ka);ti&&console.error("Erro ao inserir participantes:",ti)}}const Qo=xa?.nome||xa?.name||Gt(xa)||Aa[0]||tt.customer,Mi={...tt,court:S.court,customer:Qo,start:rr,end:hn,modality:S.modality,...Ea?{}:{status:Ti.status??S.status}};if(se(ka=>ka.map(ti=>ti.id===tt.id?Mi:ti)),he(Mi),Ea)try{de(!1),await En(tt.id,S.status,"user")}catch{}We||t({title:"Agendamento atualizado"}),Zs.current=!0,is.current=!1;const vi=kn.map((ka,ti)=>{const Zo=wo.find(xi=>xi.cliente_id===ka.id),Cs=!!Zo;return{cliente_id:ka.id,nome:ka.nome,codigo:ka.codigo||null,valor_cota:Cs?Zo.valor_cota??0:0,status_pagamento:Cs?Zo.status_pagamento??"Pendente":"Pendente",finalizadora_id:Cs?Zo.finalizadora_id??null:null,aplicar_taxa:Cs?Zo.aplicar_taxa??!1:!1,ordem:ti+1}});if(et(ka=>({...ka,[tt.id]:vi})),console.log(" [FIX] houveMudancaDeParticipantes =",sa),sa?(console.log(" [FIX] Mudana de participantes detectada - reconstruindo participantsForm"),v(vi.map(ka=>({cliente_id:ka.cliente_id,nome:ka.nome,codigo:ka.codigo,valor_cota:ka.valor_cota?av(String(Number(ka.valor_cota).toFixed(2))):"",status_pagamento:ka.status_pagamento,finalizadora_id:ka.finalizadora_id?String(ka.finalizadora_id):x?.[0]?.id?String(x[0].id):null,aplicar_taxa:ka.aplicar_taxa})))):(console.log(" [FIX] Sem mudana de participantes - preservando dados de pagamento do contexto"),v(ka=>{const ti=(ka||[]).map(Zo=>{const Cs=vi.find(xi=>xi.cliente_id===Zo.cliente_id);return Cs?{cliente_id:Zo.cliente_id,nome:Zo.nome||Cs.nome,codigo:Zo.codigo??Cs.codigo,valor_cota:Zo.valor_cota||Cs.valor_cota,status_pagamento:Zo.status_pagamento||Cs.status_pagamento,finalizadora_id:Zo.finalizadora_id??Cs.finalizadora_id,aplicar_taxa:Zo.aplicar_taxa??Cs.aplicar_taxa}:Zo});return console.log(" [FIX] Dados de pagamento preservados:",ti),ti.length>0?ti:vi})),console.log(" [LOG 3 - RESULTADO FINAL] participantsForm aps atualizao:"),console.log("   Total:",vi.length),vi.forEach((ka,ti)=>{console.log(`   #${ti+1}: ${ka.nome} | Status: ${ka.status_pagamento} | Valor: ${ka.valor_cota}`)}),r().catch(ka=>{console.error("[AgendaPage] Erro ao recarregar alertas:",ka)}),!We){try{ct.current=[]}catch{}try{qr([])}catch{}try{sessionStorage.removeItem(cn)}catch{}de(!1)}return}let Jo=null;try{const{data:ha}=await fe.from("agendamentos").select("id, status, codigo").eq("codigo_empresa",P.codigo_empresa).eq("quadra_id",Xe.id).eq("inicio",rr.toISOString()).eq("fim",hn.toISOString()).limit(1);Array.isArray(ha)&&ha.length>0&&(Jo=ha[0])}catch{}if(Jo?.id&&Jo.status!=="canceled"){const ha={id:Jo.id,code:Jo.codigo,court:S.court,customer:xa?.nome||Aa[0]||"",start:rr,end:hn,status:S.status,modality:S.modality};se(Ea=>Ea.some(eo=>eo.id===Jo.id)?Ea:[...Ea,ha]),t({title:"Agendamento confirmado"}),Zs.current=!0,de(!1);return}if(Le&&dt>1){const ha=[],Ea=[];for(let wo=0;wo<dt;wo++){const Qo=La(S.date,wo*7),Mi=new Date(Qo);Mi.setHours(Math.floor(S.startMinutes/60),S.startMinutes%60,0,0);const vi=new Date(Qo);vi.setHours(Math.floor(S.endMinutes/60),S.endMinutes%60,0,0),ha.push({codigo_empresa:P.codigo_empresa,quadra_id:Xe.id,cliente_id:xa?.id??null,clientes:Aa,inicio:Mi.toISOString(),fim:vi.toISOString(),modalidade:S.modality,status:S.status})}const{data:Ti,error:eo}=await fe.from("agendamentos").insert(ha).select("id, codigo, inicio, fim");if(eo)throw eo;const Di=[];for(const wo of Ti){const Qo=an.map((Mi,vi)=>({codigo_empresa:P.codigo_empresa,agendamento_id:wo.id,cliente_id:Mi.id,nome:Mi.nome,valor_cota:0,status_pagamento:"Pendente",ordem:vi+1}));Di.push(...Qo),Ea.push({id:wo.id,code:wo.codigo,court:S.court,customer:xa?.nome||Aa[0]||"",start:new Date(wo.inicio),end:new Date(wo.fim),status:S.status,modality:S.modality})}Di.length>0&&await fe.from("agendamento_participantes").insert(Di),se(wo=>[...wo,...Ea]),t({title:`${dt} Agendamentos criados!`,description:"Agendamentos recorrentes criados com sucesso.",variant:"success"}),ae(!1),At(4)}else{const{data:ha,error:Ea}=await fe.from("agendamentos").insert({codigo_empresa:P.codigo_empresa,quadra_id:Xe.id,cliente_id:xa?.id??null,clientes:Aa,inicio:rr.toISOString(),fim:hn.toISOString(),modalidade:S.modality,status:S.status}).select("id, codigo").single();if(Ea)throw Ea;const Ti={id:ha.id,code:ha.codigo,court:S.court,customer:xa?.nome||Aa[0]||"",start:rr,end:hn,status:S.status,modality:S.modality};se(eo=>[...eo,Ti]),t({title:"Agendamento criado",variant:"success",duration:2e3}),r().catch(eo=>{console.error("[AgendaPage] Erro ao recarregar alertas:",eo)});try{const eo=an.map((Di,wo)=>({codigo_empresa:P.codigo_empresa,agendamento_id:ha.id,cliente_id:Di.id,nome:Di.nome,valor_cota:0,status_pagamento:"Pendente",ordem:wo+1}));if(eo.length>0){const{error:Di}=await fe.from("agendamento_participantes").insert(eo);if(!Di){const wo=eo.map(Qo=>({agendamento_id:Qo.agendamento_id,cliente_id:Qo.cliente_id,nome:Qo.nome,codigo:an.find(Mi=>Mi.id===Qo.cliente_id)?.codigo||null,valor_cota:Qo.valor_cota,status_pagamento:Qo.status_pagamento,ordem:Qo.ordem}));et(Qo=>({...Qo,[ha.id]:wo}))}}}catch{}}Zs.current=!0,is.current=!1;try{ct.current=[]}catch{}try{qr([])}catch{}try{sessionStorage.removeItem(cn)}catch{}de(!1)}catch(Xe){t({title:"Erro ao salvar agendamento",description:Xe?.message||"Tentando novamente automaticamente",variant:"destructive"})}finally{$r(!1)}}},[rn,ft,S,tt,P,rc,se,t,de,En]);p.useEffect(()=>{if(!tt?.id){Pa.current=!1,Bn.current=null;return}if(!gi.current||!Pa.current){const We=setTimeout(()=>{gi.current&&(Pa.current=!0,Bn.current=JSON.stringify({court:S.court,startMinutes:S.startMinutes,endMinutes:S.endMinutes,modality:S.modality,status:S.status,selectedClients:S.selectedClients}))},500);return()=>clearTimeout(We)}const ve=JSON.stringify({court:S.court,startMinutes:S.startMinutes,endMinutes:S.endMinutes,modality:S.modality,status:S.status,selectedClients:S.selectedClients});if(ve!==Bn.current)return Qr.current&&clearTimeout(Qr.current),Qr.current=setTimeout(async()=>{if(!ft[S.court])return;const Xe=S.startMinutes,xt=S.endMinutes;if(!(Number.isFinite(Xe)&&Number.isFinite(xt)&&xt>Xe)||!rc(Xe,xt))return;const Lr=Bn.current?JSON.parse(Bn.current).selectedClients:[],Ht=S.selectedClients||[],rr=JSON.stringify(Lr)!==JSON.stringify(Ht);console.log(rr?" [Auto-save] Salvando alteraes (participantes modificados)...":" [Auto-save] Salvando alteraes..."),Ln(!0);try{await Yo({autoSave:!0}),Bn.current=ve,console.log(rr?" [Auto-save] Participantes salvos no banco! Disponveis no modal de pagamentos.":" [Auto-save] Salvo com sucesso!")}catch(hn){console.error(" [Auto-save] Erro ao salvar:",hn)}finally{Ln(!1)}},1500),()=>{Qr.current&&clearTimeout(Qr.current)}},[tt?.id,S.court,S.startMinutes,S.endMinutes,S.modality,S.status,S.selectedClients,ft,rc,Yo]),p.useEffect(()=>{const ve=async()=>{if(!ee||!P?.codigo_empresa)return;const We=String(P.codigo_empresa);if(Ua.current!==We)try{Vr(!0);try{const vt=`clientes:list:${P.codigo_empresa}`,Lr=JSON.parse(localStorage.getItem(vt)||"[]");if(Array.isArray(Lr)&&Lr.length>0){ec(Lr);try{Hn(Ht=>JSON.stringify(Ht)===JSON.stringify(Lr)?Ht:Lr)}catch{}}}catch{}const{data:Xe,error:xt}=await fe.from("clientes").select("id, nome, codigo, email, telefone, status, codigo_empresa, is_consumidor_final").eq("codigo_empresa",P.codigo_empresa).eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0});if(xt){console.error("Falha ao carregar clientes:",xt);return}if(Array.isArray(Xe)){if(Xe.length===0){let vt=0;try{const Lr=`clientes:list:${P.codigo_empresa}`,Ht=JSON.parse(localStorage.getItem(Lr)||"[]");vt=Array.isArray(Ht)?Ht.length:0}catch{}if(vt>0&&!Za.current){Za.current=!0,setTimeout(ve,700);return}}Za.current=!1,Ua.current=We,ec(Xe);try{const vt=`clientes:list:${P.codigo_empresa}`;localStorage.setItem(vt,JSON.stringify(Xe))}catch{}try{Hn(vt=>JSON.stringify(vt)===JSON.stringify(Xe)?vt:Xe)}catch{}}}catch{}finally{Vr(!1)}};ve()},[ee,P?.codigo_empresa]),p.useEffect(()=>{const ve=ft[S.court];if(!ve)return;const We=Number(ve.valor||0);if(!Number.isFinite(We)||We<=0)return;const Xe=Math.max(0,S.endMinutes-S.startMinutes);if(Xe<=0)return;const xt=Xe/Oa,vt=Math.round(We*xt*100)/100;y(av(String(vt.toFixed(2))))},[ft,S.court,S.startMinutes,S.endMinutes]),p.useEffect(()=>{if(ee&&!gi.current)if(tt){const ve=bu(tt.start)*60+wu(tt.start),We=bu(tt.end)*60+wu(tt.end),Xe=ke[tt.id]||[],xt=Xe.filter(Ht=>Ht&&Ht.cliente_id).map(Ht=>({id:Ht.cliente_id,nome:Ht.nome,codigo:Ht.codigo||null})),vt=ft[tt.court]?.modalidades||Zh,Lr=vt.includes(tt.modality)?tt.modality:vt[0]||"";K({selectedClients:xt,court:tt.court,modality:Lr,status:tt.status,date:ko(tt.start),startMinutes:ve,endMinutes:We}),Qi.current=!0,v(Xe.map(Ht=>({cliente_id:Ht.cliente_id,nome:Ht.nome,codigo:Ht.codigo,valor_cota:(()=>{const rr=Number.isFinite(Number(Ht.valor_cota))?Number(Ht.valor_cota):hf(Ht.valor_cota);return av(String((Number.isFinite(rr)?rr:0).toFixed(2)))})(),status_pagamento:Ht.status_pagamento||"Pendente",finalizadora_id:Ht.finalizadora_id?String(Ht.finalizadora_id):null,aplicar_taxa:Ht.aplicar_taxa||!1}))),Vc(xt[0]?.id||null),(async()=>{try{const{data:Ht,error:rr}=await fe.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, cliente:clientes!agendamento_participantes_cliente_id_fkey ( nome, codigo )").eq("codigo_empresa",P.codigo_empresa).eq("agendamento_id",tt.id).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(!rr&&Array.isArray(Ht)){const hn=(S?.selectedClients||[]).slice();let kn=Ht.slice();if(hn.length>0){const an=new Map;Ht.forEach(Aa=>{const Jo=an.get(Aa.cliente_id)||[];Jo.push(Aa),an.set(Aa.cliente_id,Jo)});const sa=new Map,xa=[];for(const Aa of hn){const Jo=sa.get(Aa.id)||0,Ea=(an.get(Aa.id)||[])[Jo];Ea&&(xa.push(Ea),sa.set(Aa.id,Jo+1))}xa.length===hn.length&&(kn=xa)}else if(Array.isArray(tt?.clientes)&&tt.clientes.length>0){const an=new Map;Ht.forEach(Aa=>{const Jo=Aa.nome||Aa.cliente?.nome||"",ha=an.get(Jo)||[];ha.push(Aa),an.set(Jo,ha)});const sa=new Map,xa=[];for(const Aa of tt.clientes){const Jo=sa.get(Aa)||0,Ea=(an.get(Aa)||[])[Jo];Ea&&(xa.push(Ea),sa.set(Aa,Jo+1))}xa.length===Ht.length&&(kn=xa)}try{const an=kn.findIndex(sa=>String(sa?.nome||"").toLowerCase()!=="cliente consumidor");if(an>0){const sa=kn.splice(an,1)[0];kn.unshift(sa)}}catch{}const wn=kn.filter(an=>an&&an.cliente_id).map(an=>({id:an.cliente_id,nome:an.nome||an.cliente?.nome||"",codigo:an.cliente?.codigo||null}));K(an=>({...an,selectedClients:wn})),v(kn.map(an=>({cliente_id:an.cliente_id,nome:an.nome||an.cliente?.nome||"",codigo:an.cliente?.codigo||null,valor_cota:(()=>{const sa=Number.isFinite(Number(an.valor_cota))?Number(an.valor_cota):hf(an.valor_cota);return av(String((Number.isFinite(sa)?sa:0).toFixed(2)))})(),status_pagamento:an.status_pagamento||"Pendente",finalizadora_id:an.finalizadora_id?String(an.finalizadora_id):null,aplicar_taxa:an.aplicar_taxa||!1}))),Vc(wn[0]?.id||null)}}catch(Ht){console.error("Falha ao carregar participantes (refresh)",Ht)}})(),gi.current=!0,Bn.current=JSON.stringify({court:tt.court,startMinutes:ve,endMinutes:We,modality:Lr,status:tt.status,selectedClients:xt})}else if(Vt){const ve=(Dt||[]).includes(Vt.court)?Vt.court:(Dt||[])[0]||"",We={selectedClients:Ce.current?Array.isArray(S.selectedClients)?S.selectedClients:[]:[],court:ve,modality:(()=>(ft[ve]?.modalidades||Zh)[0]||"")(),status:"scheduled",date:Vt.date??D,startMinutes:Vt.startMinutes??Ot(),endMinutes:Vt.endMinutes??Ot()+60};K(We),v([]),Qi.current=!0,gi.current=!0}else{const ve=Dt[0]||"",We=ft[ve]?.modalidades||Zh,Xe=Array.isArray(xr)?xr:[],xt=Ce.current?Array.isArray(S.selectedClients)?S.selectedClients:[]:Xe.length>0?Xe:[];if(!Ce.current&&Xe.length>0)try{Ce.current=!0}catch{}K({selectedClients:xt,court:ve,modality:We[0]||"",status:"scheduled",date:D,startMinutes:Ot(),endMinutes:Ot()+60}),v([]),Qi.current=!0,gi.current=!0}},[ee,tt,D,Vt,Dt,Zh,ke]),p.useEffect(()=>{if(ee&&tt){gi.current=!1,Od.current=!1,Ce.current||K(ve=>({...ve,selectedClients:[]}));try{cr.current=!1}catch{}}},[tt,ee]),p.useEffect(()=>{if(ee)try{Od.current=!1}catch{}},[ee]),p.useEffect(()=>{if(!ee||!tt||Od.current||Pa.current)return;const ve=ke[tt.id]||[];if(!ve.length)return;let We=ve.slice();const Xe=(S?.selectedClients||[]).slice();if(Xe.length>0){const vt=new Map;ve.forEach(rr=>{const hn=vt.get(rr.cliente_id)||[];hn.push(rr),vt.set(rr.cliente_id,hn)});const Lr=new Map,Ht=[];for(const rr of Xe){const hn=Lr.get(rr.id)||0,wn=(vt.get(rr.id)||[])[hn];wn&&(Ht.push(wn),Lr.set(rr.id,hn+1))}Ht.length===Xe.length&&(We=Ht)}else if(Array.isArray(tt?.clientes)&&tt.clientes.length>0){const vt=new Map;ve.forEach(rr=>{const hn=rr.nome||"",kn=vt.get(hn)||[];kn.push(rr),vt.set(hn,kn)});const Lr=new Map,Ht=[];for(const rr of tt.clientes){const hn=Lr.get(rr)||0,wn=(vt.get(rr)||[])[hn];wn&&(Ht.push(wn),Lr.set(rr,hn+1))}Ht.length===ve.length&&(We=Ht)}try{const vt=We.findIndex(Lr=>String(Lr?.nome||"").toLowerCase()!=="cliente consumidor");if(vt>0){const Lr=We.splice(vt,1)[0];We.unshift(Lr)}}catch{}const xt=We.filter(vt=>vt&&vt.cliente_id).map(vt=>({id:vt.cliente_id,nome:vt.nome,codigo:vt.codigo||null}));if(xt.length>0){try{localStorage.getItem("debug:agenda")==="1"&&(console.log("[ORDER-AGENDA] chipsIdsNow:",Xe.map(vt=>vt.id)),console.log("[ORDER-AGENDA] selectedFromPartsIds:",xt.map(vt=>vt.id)))}catch{}K(vt=>({...vt,selectedClients:xt})),v(We.map(vt=>({cliente_id:vt.cliente_id,nome:vt.nome,codigo:vt.codigo||null,valor_cota:(()=>{const Lr=Number.isFinite(Number(vt.valor_cota))?Number(vt.valor_cota):hf(vt.valor_cota);return av(String((Number.isFinite(Lr)?Lr:0).toFixed(2)))})(),status_pagamento:vt.status_pagamento||"Pendente",finalizadora_id:vt.finalizadora_id||null,aplicar_taxa:vt.aplicar_taxa||!1}))),Vc(xt[0]?.id||null),Od.current=!0}},[ee,tt,ke]),p.useEffect(()=>{const ve=We=>{if(ee&&!o){if(We.key==="Escape"){if(We.preventDefault(),tt?.id){console.log(" [Auto-save] Salvando ao fechar modal (ESC)..."),Qr.current&&clearTimeout(Qr.current),Yo({autoSave:!0}).then(()=>{console.log(" [Auto-save] Salvo ao fechar (ESC)!"),de(!1)}).catch(Xe=>{console.error(" [Auto-save] Erro ao salvar ao fechar (ESC):",Xe),de(!1)});return}de(!1)}We.key==="Enter"&&!["INPUT","TEXTAREA"].includes(We.target.tagName)&&(We.preventDefault(),!is.current&&!Zs.current&&(is.current=!0,Zs.current=!1,Yo().catch(()=>{}))),tt&&(We.key==="F3"&&(We.preventDefault(),ur(!0)),We.key==="F4"&&(We.preventDefault(),s()))}};return window.addEventListener("keydown",ve),()=>window.removeEventListener("keydown",ve)},[ee,tt,o,s,ur,Yo,is,Zs,de,S]);const ei=p.useMemo(()=>{const ve=ft[S.court];if(!ve)return{start:Ro*60,end:yo*60};const[We,Xe]=String(ve.hora_inicio||"06:00:00").split(":").map(Number),[xt,vt]=String(ve.hora_fim||"24:00:00").split(":").map(Number),Lr=xt===0&&vt===0?24:xt;return{start:We*60+(Xe||0),end:Lr*60+(vt||0)}},[ft,S.court,Ro,yo]),Td=p.useMemo(()=>{const ve=dr(S.date,"yyyy-MM-dd"),We=Xe=>{const xt=bu(Xe),vt=wu(Xe);return xt===0&&vt===0?1440:xt*60+vt};return le.filter(Xe=>Xe.court===S.court&&dr(Xe.start,"yyyy-MM-dd")===ve&&Xe.status!=="canceled"&&(!tt||Xe.id!==tt.id)).map(Xe=>[We(Xe.start),We(Xe.end)]).sort((Xe,xt)=>Xe[0]-xt[0])},[le,S.court,S.date,tt]),Tg=(ve,We,Xe,xt)=>ve<xt&&Xe<We;function rc(ve,We){if(We<=ve||ve<ei.start||We>ei.end)return!1;for(const[Xe,xt]of Td)if(Tg(ve,We,Xe,xt))return!1;return!0}const R0=ve=>{let We=ve+Oa;if(!rc(ve,We))return null;for(;We+Oa<=ei.end&&rc(ve,We+Oa);)We+=Oa;return We},W1=p.useMemo(()=>{const ve=ei,We=[];for(let Xe=ve.start;Xe<=ve.end;Xe+=Oa){const xt=rc(Xe,Xe+Oa);let vt=Math.floor(Xe/60);const Lr=Xe%60;vt>=24&&Xe===1440&&(vt=0),We.push({value:Xe,label:`${String(vt).padStart(2,"0")}:${String(Lr).padStart(2,"0")}`,available:xt})}return We},[ei,Td]),H1=p.useMemo(()=>{const ve=R0(S.startMinutes),We=[];for(let Xe=S.startMinutes+Oa;Xe<=ei.end;Xe+=Oa){const xt=!!ve&&Xe<=ve;let vt=Math.floor(Xe/60);const Lr=Xe%60;vt>=24&&(vt=vt%24),We.push({value:Xe,label:`${String(vt).padStart(2,"0")}:${String(Lr).padStart(2,"0")}`,available:xt})}return We},[S.startMinutes,Td,ei]);p.useEffect(()=>{if(Qi.current){Qi.current=!1;return}const We=(()=>{if(rc(S.startMinutes,S.startMinutes+Oa))return S.startMinutes;for(let vt=Math.max(ei.start,S.startMinutes);vt<=ei.end-Oa;vt+=Oa)if(rc(vt,vt+Oa))return vt;for(let vt=ei.start;vt<=ei.end-Oa;vt+=Oa)if(rc(vt,vt+Oa))return vt;return S.startMinutes})();if(We!==S.startMinutes){K(vt=>({...vt,startMinutes:We}));return}const Xe=R0(We);if(!Xe)return;let xt=S.endMinutes;(!Number.isFinite(xt)||xt<=We||xt>Xe)&&(xt=Math.min(We+60,Xe),xt<We+Oa&&(xt=We+Oa),K(vt=>({...vt,endMinutes:xt})))},[S.startMinutes,S.court,S.date,Td,ei]);const G1=p.useMemo(()=>ft[S.court]?.modalidades||Zh,[ft,S.court]);p.useEffect(()=>{const ve=ft[S.court]?.modalidades||Zh;ve.includes(S.modality)||K(We=>({...We,modality:ve[0]||""}))},[S.court,ft]),p.useEffect(()=>{if(Qi.current||!Ki(S.date,D))return;if(pe[S.court]&&!pe[S.court].funciona){const Xe=Dt.find(xt=>!pe[xt]||pe[xt].funciona);Xe&&K(xt=>({...xt,court:Xe}))}},[S.court,S.date,pe,Dt,D]);const K1=p.useMemo(()=>{const ve=Math.max(0,S.endMinutes-S.startMinutes),We=Math.floor(ve/60),Xe=ve%60;return We>0&&Xe>0?`${We}h ${Xe}min`:We>0?`${We}h`:`${Xe}min`},[S.startMinutes,S.endMinutes]),om=p.useMemo(()=>{if(!ee)return"";const ve=new Date,We=bu(ve)*60+wu(ve),Xe=Number(S.startMinutes),xt=Number(S.endMinutes),vt=Lr=>{let Ht=Math.floor(Lr/60);const rr=Lr%60;return Ht>=24&&(Ht=Ht%24),`${String(Ht).padStart(2,"0")}:${String(rr).padStart(2,"0")}`};if(Nn.autoConfirmEnabled&&S.status==="scheduled"){const Lr=Math.max(0,Xe-Number(Nn.autoConfirmMinutesBefore||0));if(We<Lr)return`Este agendamento est com automao ativa (Confirmar automaticamente s ${vt(Lr)})`}return Nn.autoStartEnabled&&S.status==="confirmed"&&We<Xe?`Este agendamento est com automao ativa (Iniciar automaticamente s ${vt(Xe)})`:Nn.autoFinishEnabled&&S.status==="in_progress"&&We<xt?`Este agendamento est com automao ativa (Finalizar automaticamente s ${vt(xt)})`:""},[ee,S.startMinutes,S.endMinutes,S.status,Nn]),L0=p.useMemo(()=>(m||[]).length,[m]),Dg=p.useMemo(()=>{const We=(m||[]).map(rr=>{const hn=hf(rr?.valor_cota);return Number.isFinite(hn)?hn:0}).reduce((rr,hn)=>rr+hn,0),Xe=hf(g),xt=Number.isFinite(Xe)?Xe:0,vt=Number((xt-We).toFixed(2));let Lr=0,Ht=0;for(const rr of m||[])(rr?.status_pagamento||"Pendente")==="Pago"?Lr++:Ht++;return{totalAssigned:We,totalTarget:xt,diff:vt,paid:Lr,pending:Ht}},[m,g]);p.useEffect(()=>{const ve=hf(g);if(!Number.isFinite(ve)||ve<=0)return;(m||[]).some(Xe=>hf(Xe?.valor_cota)>=ve)&&(m||[]).some(Xe=>Xe.status_pagamento!=="Pago")&&v(Xe=>Xe.map(xt=>({...xt,status_pagamento:"Pago"})))},[m,g]),p.useCallback(()=>{const ve=(S.selectedClients||[]).length;if(!ve)return;const We=hf(g);if(!Number.isFinite(We)||We<0)return;const Xe=Math.round(We*100),xt=Math.floor(Xe/ve);let vt=Xe-xt*ve;v(Lr=>{const Ht=(S.selectedClients||[]).slice(),rr=new Map,hn=new Map;return(Lr||[]).forEach(wn=>{const an=hn.get(wn.cliente_id)||[];an.push(wn),hn.set(wn.cliente_id,an)}),Ht.map(wn=>{const an=rr.get(wn.id)||0,xa=(hn.get(wn.id)||[])[an];rr.set(wn.id,an+1);const Aa=xt+(vt>0?1:0);vt>0&&vt--;const Jo=(Aa/100).toFixed(2),ha=av(String(Jo)),Ea=hf(ha);return{cliente_id:wn.id,nome:wn.nome,codigo:xa?.codigo??wn.codigo??null,valor_cota:ha,status_pagamento:Number.isFinite(Ea)&&Ea>0?"Pago":"Pendente",finalizadora_id:xa?.finalizadora_id??null,aplicar_taxa:xa?.aplicar_taxa??!1}})})},[S.selectedClients,g,v]),p.useCallback(()=>{v(ve=>ve.map(We=>({...We,valor_cota:"",status_pagamento:"Pendente"})))},[v]);const sm=p.useCallback(async()=>{try{hr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{we.current="close"}catch{}try{Pe(!1),Se(!1)}catch{}if(tt?.id&&Pa.current)try{Qr.current&&clearTimeout(Qr.current),console.log(" [CustomerPicker] Salvando participantes ao fechar..."),await Yo({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(ve){console.error(" [CustomerPicker] Erro ao salvar:",ve)}},[tt?.id,Yo]);return a.jsxs(a.Fragment,{children:[kr&&a.jsx(xn,{open:!0,onOpenChange:ve=>{if(!ve&&kr){try{kr.resolve(!1)}catch{}pr(null)}},children:a.jsxs(vn,{onOpenAutoFocus:ve=>ve.preventDefault(),children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Reativar automao?"}),a.jsx(On,{children:"Ao reativar, este agendamento voltar a ser atualizado automaticamente (incio e trmino) pelas regras da agenda."})]}),a.jsx(ra,{children:a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx(ce,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{try{kr?.resolve(!1)}catch{}pr(null)},children:"Cancelar"}),a.jsx(ce,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>{try{kr?.resolve(!0)}catch{}pr(null)},children:"Reativar"})]})})]})}),ee&&a.jsx(xn,{open:!0,onOpenChange:async ve=>{if(ve)de(!0);else{try{const We=Date.now()<(zt.current||0);if(Qt||jr||We){try{const Xe={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(blocked)",effectiveCustomerPickerOpen:Qt,isClientFormOpen:jr,suppressUntil:zt.current,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(ne.current)?ne.current.length:NaN,lastLen:Array.isArray(ct.current)?ct.current.length:NaN};console.warn("[CustomerPicker][DIALOG:block-close]",Xe)}catch{}return}}catch{}try{const We={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(allow-close)",effectiveCustomerPickerOpen:Qt,isClientFormOpen:jr,suppressUntil:zt.current,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(ne.current)?ne.current.length:NaN,lastLen:Array.isArray(ct.current)?ct.current.length:NaN};console.warn("[CustomerPicker][DIALOG:allow-close]",We)}catch{}if(o&&console.log("[Dialog] Fechamento solicitado com PaymentModal aberto - iniciando coordenao"),console.log(" [FLUXO CRTICO] Solicitao de fechamento do modal de agendamento recebida"),console.log(" Estado atual:",{isPaymentModalOpen:o,editingBooking:tt?.id,timestamp:new Date().toISOString()}),o&&typeof window<"u"){console.log(" [FLUXO CRTICO] PaymentModal aberto - solicitando save-and-close");try{await new Promise(We=>{const Xe=()=>{window.removeEventListener("paymentmodal:closed",Xe),console.log(" [FLUXO CRTICO] PaymentModal confirmou fechamento"),We()},xt=setTimeout(()=>{window.removeEventListener("paymentmodal:closed",Xe),console.warn(" [FLUXO CRTICO] Timeout aguardando PaymentModal fechar"),We()},3e3),vt=()=>{clearTimeout(xt),Xe()};window.addEventListener("paymentmodal:closed",vt,{once:!0}),window.dispatchEvent(new Event("paymentmodal:save-and-close"))})}catch{}}de(!1),he(null),wr(null),Od.current=!1,console.log(" [FLUXO CRTICO] Modal de agendamento fechado"),ae(!1),At(4)}},children:a.jsxs(vn,{forceMount:!0,disableAnimations:!0,alignTop:!0,className:"sm:max-w-[960px] max-h-[85vh] min-h-[360px] flex flex-col p-0",onOpenAutoFocus:ve=>ve.preventDefault(),onInteractOutside:async ve=>{try{const We=Date.now()<(zt.current||0);if(o||Qt||jr||We){try{const Xe={ts:new Date().toISOString(),hook:"DialogContent:onInteractOutside(blocked)",effectiveCustomerPickerOpen:Qt,isClientFormOpen:jr,isPaymentModalOpen:o,suppressUntil:zt.current,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(ne.current)?ne.current.length:NaN,lastLen:Array.isArray(ct.current)?ct.current.length:NaN}}catch{}ve.preventDefault();return}if(tt?.id){ve.preventDefault(),console.log(" [Auto-save] Salvando ao clicar fora do modal...");try{Qr.current&&clearTimeout(Qr.current),await Yo({autoSave:!0}),console.log(" [Auto-save] Salvo ao clicar fora!")}catch(Xe){console.error(" [Auto-save] Erro ao salvar ao clicar fora:",Xe)}finally{de(!1)}return}}catch{}},onEscapeKeyDown:ve=>{try{const We=Date.now()<(zt.current||0);if(o||Qt||jr||We){ve.preventDefault();return}}catch{}},children:[a.jsxs(pn,{className:"px-6 pt-6 pb-4 flex-shrink-0",children:[a.jsxs(fn,{className:"flex items-center justify-between gap-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{children:tt?(()=>{const ve=tt?.code,We=typeof ve=="number"?String(ve).padStart(3,"0"):null;return We?`Editar agendamento - ${We}`:"Editar Agendamento"})():"Novo Agendamento"}),Pn&&a.jsxs("span",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs bg-blue-600/10 text-blue-400 border-blue-700/30",children:[a.jsxs("svg",{className:"w-3 h-3 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]})]}),tt&&(()=>{Dg?.pending===0&&L0>0;const ve=(Dg?.pending||0)>0,We="inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs",Xe="bg-emerald-600/10 text-emerald-400 border-emerald-700/30",xt="bg-amber-600/15 text-amber-400 border-amber-700/30",vt=Lr=>a.jsx("span",{"aria-hidden":!0,className:`inline-block w-2 h-2 rounded-full ${Lr}`});return a.jsxs("span",{className:`${We} ${ve?xt:Xe}`,title:ve?"H pagamentos pendentes":"Todos participantes pagos","aria-live":"polite",children:[vt(ve?"bg-amber-400":"bg-emerald-400"),a.jsx("span",{className:"tracking-wide",children:"Pagos"}),a.jsx("strong",{className:"text-base font-semibold tabular-nums",children:Dg?.paid||0}),a.jsx("span",{className:"opacity-60",children:"/"}),a.jsx("span",{className:"text-base font-semibold tabular-nums",children:L0})]})})(),a.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-md border text-sm bg-white/5 border-white/10 text-text-primary",title:"Data do agendamento",children:[a.jsx(Ns,{className:"w-4 h-4 opacity-80"}),a.jsxs("span",{className:"font-semibold",children:[dr(S.date,"dd/MM/yyyy"),(()=>{const ve=Number(S?.startMinutes),We=Number(S?.endMinutes);if(!(Number.isFinite(ve)&&Number.isFinite(We)&&We>ve))return"";const xt=vt=>{let Lr=Math.floor(vt/60);const Ht=vt%60;return Lr>=24&&(Lr=Lr%24),`${String(Lr).padStart(2,"0")}:${String(Ht).padStart(2,"0")}`};return`  ${xt(ve)}${xt(We)}`})()]})]})]}),a.jsx(On,{children:tt?"As alteraes so salvas automaticamente enquanto voc edita.":"Preencha os detalhes para criar uma nova reserva."})]}),a.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 pb-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"clientes-field",className:"font-bold",children:"Clientes"}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsxs(Oc,{modal:!1,open:Qt,onOpenChange:ve=>{const We=Date.now(),Xe=We<(kt.current||0)||We<(zt.current||0)||We<(Kt.current||0)||Xt();if(!((jr||gr)&&ve===!1)){if(!ve&&Xe){po("onOpenChange:blocked:guard-window");return}if(!ve&&we.current!=="close"){po("onOpenChange:blocked:sticky-close");return}if(ve){hr.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}Se(!0),po("open:accepted")}else{hr.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{const xt=Array.isArray(ne.current)?[...ne.current]:[];if(xt.length>0){Zr.current="onOpenChange:close:preserve";try{sessionStorage.setItem(cn,JSON.stringify(xt))}catch{}Kr(xt),Ja("onOpenChange:close:preserve",xt)}else cr.current||(Zr.current="onOpenChange:close:empty",Ja("onOpenChange:close:empty",[]))}catch{}try{zt.current=Date.now()+1500}catch{}try{const xt={ts:new Date().toISOString(),hook:"onOpenChange(false)",formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(ne.current)?ne.current.length:NaN,lastLen:Array.isArray(ct.current)?ct.current.length:NaN,chipsLen:Array.isArray(xr)?xr.length:NaN,clientsLoading:!!gr,lastAction:Zr?.current,clearedByUser:!!cr?.current,suppressUntil:zt.current};console.warn("[CustomerPicker][CLOSE:onOpenChange]",xt)}catch{}Se(!1),po("close:accepted")}!ve&&lr.current&&(vr(!0),lr.current=!1,setTimeout(()=>vr(!1),1200)),we.current=ve?"open":"close",Pe(ve)}},children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{type:"button",variant:"outline",className:mr("min-w-[180px] justify-between",Yr&&"ring-2 ring-emerald-500/40 ring-offset-2 ring-offset-transparent transition-shadow"),onClick:()=>{po("trigger:click");try{we.current="open"}catch{}try{hr.current=!0,localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}Pe(!0),Se(!0),setTimeout(()=>{Pe(!0),Se(!0),po("trigger:reassert-open")},30),po("trigger:after-set-open")},children:[Pl,a.jsx(i0,{className:"w-4 h-4 ml-2 opacity-60"})]})}),a.jsx(Hl,{forceMount:!0,side:"bottom",align:"start",className:"w-[360px] p-2 z-[9999]",onPointerDownOutside:ve=>{const We=Date.now();if(We<(kt.current||0)||We<(zt.current||0)||We<(Kt.current||0)||Xt()){ve.preventDefault();return}if(jr||gr){ve.preventDefault();return}try{const xt=Array.isArray(ne.current)?[...ne.current]:[];if(xt.length>0){Zr.current="outside:close:snapshot",ct.current=xt;try{sessionStorage.setItem(cn,JSON.stringify(xt))}catch{}Kr(xt),Ja("outside:close:apply",xt),cr.current=!1}else{if(Zr.current="outside:close:empty",cr.current){ct.current=[];try{sessionStorage.removeItem(cn)}catch{}console.warn("[CustomerPicker][outside:close:empty:cleared]",{ts:new Date().toISOString()})}Ja("outside:close:empty",[])}}catch{}try{zt.current=Date.now()+1500}catch{}try{const xt={ts:new Date().toISOString(),hook:"onPointerDownOutside",formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(ne.current)?ne.current.length:NaN,lastLen:Array.isArray(ct.current)?ct.current.length:NaN,chipsLen:Array.isArray(xr)?xr.length:NaN,clientsLoading:!!gr,lastAction:Zr?.current,clearedByUser:!!cr?.current,suppressUntil:zt.current}}catch{}lr.current=!0,we.current="close",hr.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}Pe(!1),Se(!1),tt?.id&&Pa.current&&(async()=>{try{Qr.current&&clearTimeout(Qr.current),console.log(" [CustomerPicker] Salvando participantes (clique fora)..."),await Yo({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(xt){console.error(" [CustomerPicker] Erro ao salvar:",xt)}})()},onFocusOutside:ve=>{po("focusOutside"),(jr||gr)&&ve.preventDefault()},onEscapeKeyDown:ve=>{po("escapeKeyDown"),(jr||gr)&&ve.preventDefault()},children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{ref:un,placeholder:"Buscar por cdigo ou nome...",value:ze,onChange:ve=>{Ke(ve.target.value),Bt(0)},onKeyDown:ve=>{if(ve.key==="ArrowDown"||ve.key==="ArrowUp"){ve.preventDefault();const We=(Wo||[]).filter(Ht=>{const rr=ze.trim().toLowerCase();return rr?String(ar(Ht)||"").toLowerCase().includes(rr):!0}),Xe=We.find(Ht=>Ht?.is_consumidor_final===!0),vt=We.filter(Ht=>Ht?.is_consumidor_final!==!0).slice().sort((Ht,rr)=>{const hn=typeof Ht=="object"&&Number.isFinite(Number(Ht?.codigo))?Number(Ht.codigo):1/0,kn=typeof rr=="object"&&Number.isFinite(Number(rr?.codigo))?Number(rr.codigo):1/0;if(hn!==kn)return hn-kn;const wn=String(Gt(Ht)||"").toLowerCase(),an=String(Gt(rr)||"").toLowerCase();return wn.localeCompare(an)}),Lr=Xe?[Xe,...vt]:vt;ve.key==="ArrowDown"?Bt(Ht=>Math.min(Ht+1,Lr.length-1)):Bt(Ht=>Math.max(Ht-1,0))}if(ve.key==="Enter"){ve.preventDefault();const We=(Wo||[]).filter(rr=>{const hn=ze.trim().toLowerCase();return hn?String(ar(rr)||"").toLowerCase().includes(hn):!0}),Xe=We.find(rr=>rr?.is_consumidor_final===!0),vt=We.filter(rr=>rr?.is_consumidor_final!==!0).slice().sort((rr,hn)=>{const kn=typeof rr=="object"&&Number.isFinite(Number(rr?.codigo))?Number(rr.codigo):1/0,wn=typeof hn=="object"&&Number.isFinite(Number(hn?.codigo))?Number(hn.codigo):1/0;if(kn!==wn)return kn-wn;const an=String(Gt(rr)||"").toLowerCase(),sa=String(Gt(hn)||"").toLowerCase();return an.localeCompare(sa)}),Ht=(Xe?[Xe,...vt]:vt)[it];if(Ht){const rr=Ht.id,hn=Gt(Ht),kn=Ht.codigo,wn={id:rr,nome:hn,codigo:kn},an=[...Array.isArray(ne.current)?ne.current:[],wn];try{(ne.current||[]).length===0&&(W.current=rr||null)}catch{}try{cr.current=!1}catch{}try{an.length>0&&(ct.current=an)}catch{}try{ne.current=an}catch{}Ja("keyboard:enter",an),hr.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}}}},className:"pl-10 pr-10"}),ze&&a.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary p-1 rounded hover:bg-white/10",onClick:()=>{Ke(""),un.current?.focus()},children:a.jsx(yl,{className:"w-4 h-4"})})]}),a.jsxs("div",{ref:on,className:"max-h-[260px] overflow-y-auto divide-y divide-border rounded-md border border-border",onWheel:ve=>{ve.stopPropagation()},onTouchMove:ve=>{ve.stopPropagation()},style:{overscrollBehavior:"contain"},children:[gr&&(Wo||[]).length===0&&a.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Carregando clientes"}),!gr&&(Wo||[]).length===0&&a.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum cliente encontrado"}),!gr&&(()=>{const ve=(Wo||[]).filter(Lr=>{const Ht=ze.trim().toLowerCase();return Ht?String(ar(Lr)||"").toLowerCase().includes(Ht):!0}),We=ve.find(Lr=>Lr?.is_consumidor_final===!0),xt=ve.filter(Lr=>Lr?.is_consumidor_final!==!0).slice().sort((Lr,Ht)=>{const rr=typeof Lr=="object"&&Number.isFinite(Number(Lr?.codigo))?Number(Lr.codigo):1/0,hn=typeof Ht=="object"&&Number.isFinite(Number(Ht?.codigo))?Number(Ht.codigo):1/0;if(rr!==hn)return rr-hn;const kn=String(Gt(Lr)||"").toLowerCase(),wn=String(Gt(Ht)||"").toLowerCase();return kn.localeCompare(wn)});return We?[We,...xt]:xt})().map((ve,We)=>{const Xe=ve?.is_consumidor_final===!0,xt=typeof ve=="object"?ve.id:null,vt=Gt(ve),Lr=typeof ve=="object"?ve.codigo:null,Ht=String(vt||"").toLowerCase(),rr=wn=>wn.id&&xt?wn.id===xt:String(wn.nome||"").toLowerCase()===Ht,hn=(S.selectedClients||[]).some(rr),kn=We===it;return a.jsxs("button",{ref:wn=>{sr.current[We]=wn},type:"button",className:`w-full text-left py-3 px-4 flex items-center gap-3 transition-all border-b border-border last:border-0 ${kn?"ring-2 ring-blue-500 ring-inset z-10":""} ${Xe?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":hn?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>Bt(We),onMouseDown:wn=>{wn.stopPropagation()},role:"option","aria-checked":hn,onClick:()=>{const wn={id:xt,nome:vt,codigo:Lr},an=[...Array.isArray(ne.current)?ne.current:[],wn];try{(ne.current||[]).length===0&&(W.current=xt||null)}catch{}try{cr.current=!1}catch{}try{an.length>0&&(ct.current=an)}catch{}try{ne.current=an}catch{}Ja("list:add",an),hr.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}},children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[Lr!=null&&a.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${Xe?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",Lr]}),a.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[a.jsx("span",{className:`font-medium truncate ${Xe?"text-amber-100/90":""}`,children:vt}),Xe&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),(()=>{const wn=(S.selectedClients||[]).filter(an=>rr(an)).length;return wn>0?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:an=>{an.stopPropagation();const sa=Array.isArray(ne.current)?ne.current:[],xa=sa.findIndex(Aa=>rr(Aa));if(xa!==-1){const Aa=[...sa];Aa.splice(xa,1);try{cr.current=Aa.length===0}catch{}try{Aa.length===0&&(W.current=null)}catch{}try{Aa.length>0&&(ct.current=Aa)}catch{}try{ne.current=Aa}catch{}Ja("list:remove-one",Aa)}},children:"-"}),a.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:wn}),a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:an=>{an.stopPropagation();const sa={id:xt,nome:vt,codigo:Lr},xa=[...Array.isArray(ne.current)?ne.current:[],sa];try{(ne.current||[]).length===0&&(W.current=xt||null)}catch{}try{cr.current=!1}catch{}try{xa.length>0&&(ct.current=xa)}catch{}try{ne.current=xa}catch{}Ja("list:add-one",xa)},children:"+"})]}):null})()]},xt||Ht)})]}),a.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a.jsx(ce,{type:"button",size:"sm",className:"bg-emerald-600 hover:bg-emerald-500 text-white shadow-md ring-2 ring-emerald-400/40 ring-offset-2 ring-offset-transparent",onMouseDown:ve=>{try{zt.current=Date.now()+3e3}catch{}try{kt.current=Date.now()+3500}catch{}try{Ie.current=Date.now()+5e3}catch{}try{we.current="close"}catch{}try{hr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{sessionStorage.setItem("agenda:customerPicker:closing","1"),sessionStorage.setItem("agenda:customerPicker:closingAt",String(Date.now()));const We=Ye.current||sessionStorage.getItem("agenda:modal:sessionId")||"";We&&sessionStorage.setItem("agenda:customerPicker:sessionId",We);const Xe=Array.isArray(ne.current)?ne.current:[];Xe.length>0&&sessionStorage.setItem(cn,JSON.stringify(Xe));try{const xt={ts:new Date().toISOString(),hook:"conclude:mousedown",modalSessionId:We,closingAt:sessionStorage.getItem("agenda:customerPicker:closingAt"),selLen:Array.isArray(Xe)?Xe.length:NaN,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,lockUntil:kt.current,suppressUntil:zt.current,isPickerOpen:!!Qt,isModalOpen:!!ee}}catch{}}catch{}ve.stopPropagation()},onClick:()=>{we.current="close",hr.current=!1;try{Ie.current=Date.now()+5e3}catch{}try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}Lt.current=!0;const We=Array.isArray(ne.current)?[...ne.current]:[];try{We.length>0&&(Zr.current="conclude:close:snapshot",ct.current=We,sessionStorage.setItem(cn,JSON.stringify(We)))}catch{}Kr(We);try{kt.current=Date.now()+3e3}catch{}Ja("conclude:close:apply",We),K(Xe=>({...Xe,selectedClients:[...We]}));try{cr.current=!1}catch{}try{zt.current=Date.now()+2500}catch{}Pe(!1),Se(!1),setTimeout(()=>{try{zt.current=Date.now()+2500}catch{}Pe(!1),Se(!1)},15),setTimeout(()=>{try{zt.current=Date.now()+2500}catch{}Pe(!1),Se(!1)},120),tt?.id&&Pa.current&&(async()=>{try{Qr.current&&clearTimeout(Qr.current),console.log(" [CustomerPicker] Salvando participantes (Concluir)..."),await Yo({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(Xe){console.error(" [CustomerPicker] Erro ao salvar:",Xe)}})();try{zt.current=Date.now()+2500}catch{}try{const Xe={ts:new Date().toISOString(),hook:"conclude:click",formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(ne.current)?ne.current.length:NaN,lastLen:Array.isArray(ct.current)?ct.current.length:NaN,chipsLen:Array.isArray(xr)?xr.length:NaN,clientsLoading:!!gr,lastAction:Zr?.current,clearedByUser:!!cr?.current,suppressUntil:zt.current,selectionLockUntil:kt.current,restoreGuardUntil:Fr.current,modalSessionId:Ye.current||sessionStorage.getItem("agenda:modal:sessionId")||"",closingAt:sessionStorage.getItem("agenda:customerPicker:closingAt"),pickerOpen:!!Qt,modalOpen:!!ee}}catch{}setTimeout(()=>{try{Lt.current=!1}catch{}},3e3)},children:"Concluir"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("span",{className:"text-xs text-text-muted",children:[(Cl||[]).length," selecionado(s)"]})})]})]})})]}),a.jsx(ce,{type:"button",onClick:()=>{try{const ve=Array.isArray(ne.current)?ne.current:[];ve.length>0&&(ct.current=ve,sessionStorage.setItem(cn,JSON.stringify(ve)),Kr(ve),console.warn("[CustomerPicker][+Novo:save-selection]",{savedCount:ve.length}))}catch{}hr.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}we.current="close",Pe(!1),Se(!1),Cr(null),or(!0)},children:"+ Novo"})]}),tc.length>0?a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:tc.map((ve,We)=>{const Xe=String(ve?.nome||"").toLowerCase(),xt=`${ve?.id||Xe}-${We}`,vt=ve?.id||`__name:${Xe}`;return a.jsxs("span",{className:"text-sm font-medium bg-white/5 border border-white/10 rounded px-2 py-1 flex items-center gap-2",children:[B9(ve.nome),a.jsxs("button",{type:"button","aria-label":"Remover cliente",title:"Remover cliente",className:"text-text-muted hover:text-red-400 p-1 rounded hover:bg-red-500/10",onClick:()=>{j("CustomerPicker:chip:remove",{token:vt,chipIdx:We});const Lr=(Array.isArray(ne.current)?ne.current:[]).filter((Ht,rr)=>rr!==We);try{cr.current=Lr.length===0}catch{}try{ct.current=Lr,Lr.length===0&&(sessionStorage.removeItem(cn),console.warn("[CustomerPicker][chip:remove:cleared-all]",{ts:new Date().toISOString()}))}catch{}try{ne.current=Lr}catch{}Ja("chips:remove",Lr)},children:[a.jsx(yl,{className:"w-5 h-5"}),a.jsx("span",{className:"sr-only",children:"Remover"})]})]},xt)})}):null]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"quadra-select",className:"font-bold",children:"Quadra"}),a.jsxs(Cn,{value:S.court,onValueChange:ve=>K(We=>({...We,court:ve})),children:[a.jsx(jn,{className:"mt-1",onMouseDown:()=>{Qt&&setTimeout(sm,0)},children:a.jsx(An,{children:S.court&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:Am(S.court)}}),a.jsx("span",{children:S.court})]})})}),a.jsx(_n,{className:"z-[60]",children:Dt.map(ve=>{const We=dr(S.date,"yyyy-MM-dd"),Xe=J[We]||{},xt=Xe[ve]&&!Xe[ve].funciona;return a.jsx(nt,{value:ve,disabled:xt,className:xt?"opacity-50 cursor-not-allowed":"",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:Am(ve)}}),a.jsx("span",{children:ve}),xt&&a.jsx("span",{className:"text-xs text-text-muted ml-auto",children:"(Fechada)"})]})},ve)})})]})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"modalidade-select",className:"font-bold",children:"Modalidade"}),a.jsxs(Cn,{value:S.modality,onValueChange:ve=>K(We=>({...We,modality:ve})),children:[a.jsx(jn,{className:"mt-1",onMouseDown:()=>{Qt&&setTimeout(sm,0)},children:a.jsx(An,{})}),a.jsx(_n,{children:(G1||[]).map(ve=>a.jsx(nt,{value:ve,children:ve},ve))})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"status-select",className:"font-bold",children:"Status"}),a.jsxs(Cn,{value:S.status,onValueChange:ve=>K(We=>({...We,status:ve})),children:[a.jsx(jn,{className:"mt-1",onMouseDown:()=>{Qt&&setTimeout(sm,0)},children:a.jsx(An,{})}),a.jsx(_n,{children:Object.keys(ri).map(ve=>a.jsx(nt,{value:ve,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{"aria-hidden":!0,className:`inline-block h-4 w-1 rounded ${ri[ve].accent}`}),ri[ve].label]})},ve))})]}),om&&a.jsx("div",{className:"mt-1.5 text-xs text-text-primary font-medium bg-brand/5 border border-brand/20 rounded px-2 py-1.5",children:om})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"horario-inicio",className:"font-bold",children:"Horrio"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsxs(Cn,{value:String(S.startMinutes),onValueChange:ve=>K(We=>({...We,startMinutes:Number(ve)})),children:[a.jsx(jn,{className:"w-32","aria-label":"Hora incio",onMouseDown:()=>{Qt&&setTimeout(sm,0)},children:a.jsx(An,{})}),a.jsx(_n,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:W1.map(ve=>a.jsx(nt,{value:String(ve.value),disabled:!ve.available,className:mr(!ve.available&&"opacity-60"),children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[ve.available?a.jsx(vd,{className:"w-4 h-4 opacity-80"}):a.jsx(gx,{className:"w-4 h-4 opacity-80"}),ve.label]})},ve.value))})]}),a.jsxs(Cn,{value:String(S.endMinutes),onValueChange:ve=>K(We=>({...We,endMinutes:Number(ve)})),children:[a.jsx(jn,{className:"w-32","aria-label":"Hora fim",onMouseDown:()=>{Qt&&setTimeout(sm,0)},children:a.jsx(An,{})}),a.jsx(_n,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:H1.map(ve=>a.jsx(nt,{value:String(ve.value),disabled:!ve.available,className:mr(!ve.available&&"opacity-60"),children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[ve.available?a.jsx(vd,{className:"w-4 h-4 opacity-80"}):a.jsx(gx,{className:"w-4 h-4 opacity-80"}),ve.label]})},ve.value))})]})]}),a.jsxs("div",{className:"mt-1 inline-block text-xs font-semibold text-text-secondary bg-white/5 border border-white/10 rounded px-2 py-0.5",children:["Durao: ",K1]})]}),!tt&&a.jsxs("div",{className:"border-t border-border pt-4 mt-4",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",id:"is-recorrente",checked:Le,onChange:ve=>ae(ve.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-brand focus:ring-brand"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"is-recorrente",className:"font-semibold text-text-primary cursor-pointer",children:"Agendamento Fixo (Recorrente)"}),a.jsx("p",{className:"text-xs text-text-secondary mt-0.5",children:"Criar este agendamento automaticamente nas prximas semanas, no mesmo dia e horrio"})]})]}),Le&&a.jsxs("div",{className:"ml-7 mt-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"quantidade-semanas",className:"text-sm font-medium",children:"Repetir por quantas semanas?"}),a.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[a.jsxs("div",{className:"flex items-center border border-border rounded-md bg-surface-2",children:[a.jsx("button",{type:"button",onClick:()=>At(ve=>Math.max(2,(ve||2)-1)),className:"px-3 py-2 hover:bg-surface-3 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:dt<=2,children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),a.jsx("div",{className:"px-4 py-2 min-w-[60px] text-center font-semibold border-x border-border",children:dt}),a.jsx("button",{type:"button",onClick:()=>At(ve=>(ve||2)+1),className:"px-3 py-2 hover:bg-surface-3 transition-colors",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),a.jsxs("span",{className:"text-sm text-text-secondary",children:["semanas (",dt," agendamentos)"]})]})]}),S.date&&dt>=2&&a.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[a.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:"Datas que sero criadas:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:dt}).map((ve,We)=>{const Xe=La(S.date,We*7);return a.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-slate-700/50 border border-slate-600 rounded px-2 py-1",children:[a.jsx("svg",{className:"w-3.5 h-3.5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("span",{className:"text-xs font-medium text-white",children:dr(Xe,"dd/MM/yyyy '('EEEE')'",{locale:wa})})]},We)})})]}),a.jsx("div",{className:"bg-slate-800/50 border-l-4 border-blue-600 rounded-r-lg p-3",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"text-xs text-gray-300",children:[a.jsx("p",{className:"font-semibold mb-1 text-blue-300",children:"Importante: Revise os dados antes de salvar"}),a.jsxs("p",{children:["Sero criados ",a.jsxs("strong",{className:"text-white",children:[dt," agendamentos"]})," incluindo a data selecionada e as prximas ",dt-1," semanas. Editar ou cancelar depois exigir alterar cada agendamento individualmente."]})]})]})})]})]})]})]})}),a.jsx(ra,{className:"flex-shrink-0 border-t border-border bg-surface px-6 py-3",children:a.jsxs("div",{className:"w-full flex flex-col gap-3 sm:flex-row sm:items-center",children:[tt&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:mr-auto w-full sm:w-auto",children:[a.jsxs(ce,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white border border-red-700 w-full sm:w-auto justify-center",onClick:()=>ur(!0),children:[a.jsx(zy,{className:"w-4 h-4 mr-2 opacity-90"}),"Cancelar agendamento",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-red-700/50 rounded border border-red-500/30",children:"F3"})]}),a.jsxs(ce,{type:"button",variant:"secondary",className:"bg-teal-600 hover:bg-teal-500 text-white border-teal-700 w-full sm:w-auto justify-center",onClick:()=>{s()},children:[a.jsx(Ks,{className:"w-4 h-4 mr-2 opacity-90"}),a.jsx("span",{className:"hidden sm:inline",children:"Gerenciar Pagamentos"}),a.jsx("span",{className:"sm:hidden",children:"Pagamentos"}),a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-teal-700/50 rounded border border-teal-500/30",children:"F4"})]})]}),a.jsx(Yd,{open:nn,onOpenChange:ur,children:a.jsxs(nd,{children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Cancelar agendamento?"}),a.jsx(id,{children:'Ao cancelar, este agendamento deixar de aparecer na agenda padro. Ele s ser visvel ao selecionar o filtro "Cancelados".'})]}),a.jsxs(od,{children:[a.jsx(ld,{children:"Voltar"}),a.jsx(Jd,{className:"bg-red-600 hover:bg-red-500",onClick:async()=>{try{ur(!1),de(!1),await En(tt.id,"canceled","user"),t({title:"Agendamento cancelado"})}catch(ve){t({title:"Erro ao cancelar",description:ve?.message||"Tente novamente."})}},children:"Confirmar cancelamento"})]})]})})]}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[a.jsxs(ce,{type:"button",variant:"ghost",className:"border border-white/10 flex-1 sm:flex-none",onClick:async()=>{if(tt?.id){console.log(" [Auto-save] Salvando ao fechar modal...");try{Qr.current&&clearTimeout(Qr.current),await Yo({autoSave:!0}),console.log(" [Auto-save] Salvo ao fechar!")}catch(ve){console.error(" [Auto-save] Erro ao salvar ao fechar:",ve)}}de(!1)},children:["Fechar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),!tt?.id&&a.jsxs(ce,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white disabled:opacity-60 disabled:cursor-not-allowed flex-1 sm:flex-none",disabled:rn,onClick:async()=>{try{if(rn)return;if(Le&&!tt){ut(!0);return}is.current=!0,Zs.current=!1,await Yo()}catch{}},children:["Salvar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})})]})}),a.jsx(Yd,{open:st,onOpenChange:ut,children:a.jsxs(nd,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(ad,{children:[a.jsxs(sd,{className:"flex items-center gap-3 text-xl",children:[a.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-orange-600/20 border border-orange-600/40",children:a.jsx("svg",{className:"w-6 h-6 text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),"Confirmar Criao de Agendamentos Recorrentes"]}),a.jsxs(id,{className:"space-y-4 mt-4",children:[S.date&&dt>=2&&a.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[a.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:" Datas que sero criadas:"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:Array.from({length:dt}).map((ve,We)=>{const Xe=La(S.date,We*7);return a.jsxs("div",{className:"flex items-center gap-2 bg-slate-700/50 border border-slate-600 rounded px-2 py-1.5",children:[a.jsxs("span",{className:"text-xs font-semibold text-slate-400",children:["#",We+1]}),a.jsx("span",{className:"text-xs font-medium text-white",children:dr(Xe,"dd/MM/yyyy '('EEEE')'",{locale:wa})})]},We)})})]}),a.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-3 uppercase tracking-wide",children:"Resumo do Agendamento"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Quadra"}),a.jsx("span",{className:"font-semibold text-white",children:ft[S.court]?.name||S.court})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Horrio"}),a.jsxs("span",{className:"font-semibold text-white font-mono",children:[z9(S.startMinutes)," - ",z9(S.endMinutes)]})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Modalidade"}),a.jsx("span",{className:"font-semibold text-white",children:S.modality})]}),a.jsxs("div",{className:"flex items-start justify-between py-2",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Participantes"}),a.jsx("div",{className:"text-right max-w-xs",children:S.selectedClients?.length>0?a.jsxs("div",{className:"font-semibold text-white",children:[Rt?S.selectedClients.map(ve=>ve.nome).join(", "):S.selectedClients.slice(0,3).map(ve=>ve.nome).join(", "),!Rt&&S.selectedClients.length>3&&a.jsxs("span",{className:"text-slate-400",children:[" +",S.selectedClients.length-3]}),S.selectedClients.length>3&&a.jsxs(a.Fragment,{children:[" ",a.jsx("button",{type:"button",onClick:()=>Nt(!Rt),className:"text-xs text-blue-400 hover:text-blue-300 underline inline",children:Rt?"Ver menos":"Ver todos"})]})]}):a.jsx("span",{className:"font-semibold text-white",children:"Nenhum participante"})})]})]})]}),a.jsx("div",{className:"bg-red-900/30 border-l-4 border-red-600 rounded-r-lg p-4",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"w-5 h-5 text-red-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsx("div",{children:a.jsxs("p",{className:"text-sm text-gray-300",children:[a.jsx("strong",{className:"text-red-300",children:"Importante:"})," Aps criar, editar ou cancelar exigir alterar cada agendamento individualmente. Certifique-se de que todos os dados esto corretos!"]})})]})})]})]}),a.jsxs(od,{className:"gap-2",children:[a.jsx(ld,{onClick:()=>{ut(!1),Nt(!1)},className:"border-slate-600 hover:bg-slate-800",children:"Cancelar e Revisar"}),a.jsxs(Jd,{className:"bg-emerald-700 hover:bg-emerald-600 text-white font-semibold",onClick:async()=>{ut(!1),Nt(!1),is.current=!0,Zs.current=!1,await Yo()},children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Confirmar e Criar ",dt," Agendamentos"]})]})]})}),jr&&a.jsx(Ure,{open:jr,onOpenChange:ve=>{or(ve),ve||(Cr(null),window.__paymentModalCallback&&(window.__paymentModalCallback=null))},client:Hr,onSaved:ve=>{try{if(ve&&typeof ve=="object"){console.warn("[CustomerPicker][onSaved:START]",{clientId:ve.id,clientName:ve.nome,currentSelection:Array.isArray(ne.current)?ne.current.length:0});try{Ie.current=Date.now()+3e3,kt.current=Date.now()+3e3,Fr.current=Date.now()+3e3}catch{}(Wo||[]).some(Xe=>typeof Xe=="object"?Xe.id===ve.id:!1)||(ec(Xe=>[...Xe||[],ve]),Hn(Xe=>[...Xe||[],ve])),K(Xe=>{const xt=Array.isArray(Xe.selectedClients)?Xe.selectedClients:[],vt={id:ve.id,nome:ve.nome||ve.name||Gt(ve),codigo:ve.codigo},Lr=xt.filter(rr=>rr.id!==ve.id),Ht=[vt,...Lr];try{ne.current=Ht}catch{}try{ct.current=Ht}catch{}try{Kr(Ht)}catch{}try{sessionStorage.setItem(cn,JSON.stringify(Ht))}catch{}try{cr.current=!1}catch{}return console.warn("[CustomerPicker][onSaved:COMPLETE]",{newClientId:ve.id,newClientName:ve.nome,totalSelected:Ht.length,refsSynced:!0,protectionActive:!0}),{...Xe,selectedClients:Ht}}),Promise.resolve().then(()=>{try{const Xe=Array.isArray(ne.current)?ne.current:[];Xe.length>0&&(K(xt=>({...xt,selectedClients:[...Xe]})),console.warn("[CustomerPicker][onSaved:REASSERT]",{count:Xe.length}))}catch{}})}if(window.__paymentModalCallback&&typeof window.__paymentModalCallback=="function")try{window.__protectPaymentModal&&window.__protectPaymentModal(3e3),window.__paymentModalCallback(),window.__paymentModalCallback=null}catch(We){console.error("[PaymentModal][callback:ERROR]",We)}}catch(We){console.error("[CustomerPicker][onSaved:ERROR]",We)}}}),o&&a.jsx(QQe,{setIsModalOpen:de,setBookings:se,form:S,setForm:K,localCustomers:Wo,onOpenClientModal:ve=>{or(!0),window.__paymentModalCallback=ve}}),l&&a.jsx(ZQe,{form:S,setForm:K,localCustomers:Wo})]})},Fs=p.useMemo(()=>{const Ie=dr(D,"yyyy-MM-dd");let Ye=le.filter(Ut=>dr(Ut.start,"yyyy-MM-dd")===Ie);if(!!!L){if(Ye=Ye.filter(Ut=>Ut.status!=="canceled"),er.trim()){const Ut=er.trim().toLowerCase();Ye=Ye.filter(Ot=>(Ot.customer||"").toLowerCase().includes(Ut)||(Ot.court||"").toLowerCase().includes(Ut)||(ri[Ot.status]?.label||"").toLowerCase().includes(Ut))}return Ye}let Gt=Qe.canceledOnly?Ye.filter(Ut=>Ut.status==="canceled"):Ye.filter(Ut=>Ut.status!=="canceled");if(Qe.pendingPayments&&(Gt=Gt.filter(Ut=>{const Ot=ke[Ut.id]||[];return Ot.some(K=>String(K.status_pagamento||"").toLowerCase()!=="pago")&&Ot.length>0})),er.trim()){const Ut=er.trim().toLowerCase();Gt=Gt.filter(Ot=>(Ot.customer||"").toLowerCase().includes(Ut)||(Ot.court||"").toLowerCase().includes(Ut)||(ri[Ot.status]?.label||"").toLowerCase().includes(Ut))}try{const Ut=Date.now(),Ot=(le||[]).filter(K=>dr(K.start,"yyyy-MM-dd")===Ie).filter(K=>K.status!=="canceled").filter(K=>{const ne=In.current.get(K.id);return ne&&ne.src==="automation"&&Ut-ne.ts<2e3}),S=new Map(Gt.map(K=>[K.id,K]));for(const K of Ot)S.has(K.id)||S.set(K.id,K);Gt=Array.from(S.values())}catch{}return Gt},[le,D,Qe.scheduled,Qe.canceledOnly,Qe.pendingPayments,er,ke,L]),pi=p.useMemo(()=>{const Ie=dr(D,"yyyy-MM-dd"),Ye=Nr||Ft[0],ar=le.filter(Ut=>dr(Ut.start,"yyyy-MM-dd")===Ie&&Ut.status!=="canceled"&&Ut.court===Ye);let Gt=0;return ar.forEach(Ut=>{const S=(ke[Ut.id]||[]).filter(K=>String(K.status_pagamento||"").toLowerCase()!=="pago").length;Gt+=S}),{totalBookings:ar.length,totalPendingPayments:Gt}},[le,D,ke,Nr,Ft]),af=p.useMemo(()=>{const Ie=fp(D),Ye=La(Ie,6);let ar=le.filter(Ot=>{const S=ko(Ot.start),K=ko(Ie),ne=ko(Ye);return S>=K&&S<=ne});if(!!!L){if(ar=ar.filter(Ot=>Ot.status!=="canceled"),er.trim()){const Ot=er.trim().toLowerCase();ar=ar.filter(S=>(S.customer||"").toLowerCase().includes(Ot)||(S.court||"").toLowerCase().includes(Ot)||(ri[S.status]?.label||"").toLowerCase().includes(Ot))}return ar}let Ut=Qe.canceledOnly?ar.filter(Ot=>Ot.status==="canceled"):ar.filter(Ot=>Ot.status!=="canceled");if(Qe.pendingPayments&&(Ut=Ut.filter(Ot=>{const S=ke[Ot.id]||[];return S.some(ne=>String(ne.status_pagamento||"").toLowerCase()!=="pago")&&S.length>0})),er.trim()){const Ot=er.trim().toLowerCase();Ut=Ut.filter(S=>(S.customer||"").toLowerCase().includes(Ot)||(S.court||"").toLowerCase().includes(Ot)||(ri[S.status]?.label||"").toLowerCase().includes(Ot))}try{const Ot=Date.now(),S=(le||[]).filter(ne=>{const Ce=ko(ne.start);return Ce>=ko(Ie)&&Ce<=ko(Ye)}).filter(ne=>ne.status!=="canceled").filter(ne=>{const Ce=In.current.get(ne.id);return Ce&&Ce.src==="automation"&&Ot-Ce.ts<2e3}),K=new Map(Ut.map(ne=>[ne.id,ne]));for(const ne of S)K.has(ne.id)||K.set(ne.id,ne);Ut=Array.from(K.values())}catch{}return Ut},[le,D,Qe.scheduled,Qe.canceledOnly,Qe.pendingPayments,er,ke,L]);p.useEffect(()=>{if(!er.trim()||!(Qe.scheduled||Qe.canceledOnly||Qe.pendingPayments)||!Fs||Fs.length===0)return;const Ie=[...Fs].sort((ar,Gt)=>ar.start-Gt.start)[0];if(!Ie?.id)return;const Ye=document.getElementById(`booking-${Ie.id}`);Ye?.scrollIntoView&&Ye.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},[er,Fs,Qe.scheduled,Qe.canceledOnly,Qe.pendingPayments]),p.useEffect(()=>{const Ie=$n.current,Ye=at.current||{},ar=Qe.canceledOnly&&!Ye.canceledOnly,Gt=Qe.scheduled&&!Ye.scheduled&&!Qe.canceledOnly,Ut=Qe.pendingPayments&&!Ye.pendingPayments;if(!Ie||!ar&&!Gt&&!Ut){at.current={scheduled:Qe.scheduled,canceledOnly:Qe.canceledOnly,pendingPayments:Qe.pendingPayments};return}const Ot=Fs||[];if(Ot.length===0){at.current={scheduled:Qe.scheduled,canceledOnly:Qe.canceledOnly,pendingPayments:Qe.pendingPayments};return}const S=Ie.getBoundingClientRect();if(!Ot.some(ne=>{const Ce=document.getElementById(`booking-${ne.id}`);if(!Ce)return!1;const W=Ce.getBoundingClientRect();return W.bottom>S.top&&W.top<S.bottom})){const ne=[...Ot].sort((W,oe)=>W.start-oe.start)[0],Ce=ne&&document.getElementById(`booking-${ne.id}`);Ce?.scrollIntoView&&Ce.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}at.current={scheduled:Qe.scheduled,canceledOnly:Qe.canceledOnly,pendingPayments:Qe.pendingPayments}},[Qe.scheduled,Qe.canceledOnly,Qe.pendingPayments,Fs]);const Ji=p.useMemo(()=>{if(!Nr||!ft[Nr])return{start:Ro,end:yo};const Ie=ft[Nr],Ye=Ie.hora_inicio||`${Ro}:00:00`,ar=Ie.hora_fim||`${yo}:00:00`,[Gt,Ut]=String(Ye).split(":").map(Number),[Ot,S]=String(ar).split(":").map(Number),K=Ot===0&&S===0?24:Ot,ne=K*60+(S||0);return{start:Gt||Ro,end:K||yo,startMinutes:(Gt||0)*60+(Ut||0),endMinutes:ne}},[Nr,ft,Ro,yo]);return p.useMemo(()=>{const Ie=Ji.start,Ye=Ji.end;return Array.from({length:Math.max(0,Ye-Ie)},(ar,Gt)=>Ie+Gt)},[Ji]),p.useMemo(()=>{const Ie=Ji.start,Ye=Ji.end;return Math.max(0,Ye-Ie)*(60/Oa)*_i},[Ji]),a.jsxs(a.Fragment,{children:[a.jsxs(Pr.div,{variants:ee?void 0:sZe,initial:ee?!1:"hidden",animate:ee?!1:"visible",className:mr("h-full w-full flex flex-col md:px-0",q&&"fixed inset-0 z-40 bg-surface"),children:[a.jsx(Pr.div,{variants:q9,className:"p-3 bg-surface mb-6 md:rounded-lg",children:a.jsxs("div",{className:"max-w-[1200px] mx-auto w-full flex flex-col gap-3 md:flex-row md:items-center md:gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ce,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>U(z==="day"?Jy(D,1):Jy(D,7)),children:a.jsx(LH,{className:"h-5 w-5"})}),a.jsxs(Oc,{children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"ghost",className:"w-full sm:w-auto max-w-full justify-center text-base font-semibold whitespace-nowrap truncate",children:[a.jsx(Ns,{className:"mr-2 h-5 w-5"}),z==="day"?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:dr(D,"EEE, dd 'de' MMMM 'de' yyyy",{locale:wa})}),a.jsx("span",{className:"sm:hidden",children:dr(D,"EEE, dd/MM/yyyy",{locale:wa})})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:oZe(D)}),a.jsxs("span",{className:"sm:hidden",children:[dr(fp(D),"dd/MM/yyyy")," - ",dr(La(fp(D),6),"dd/MM/yyyy")]})]})]})}),a.jsx(Hl,{className:"w-auto p-0",children:a.jsx(Gl,{mode:"single",selected:D,onSelect:Ie=>Ie&&U(Ie),initialFocus:!0})})]}),a.jsx(ce,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>U(z==="day"?La(D,1):La(D,7)),children:a.jsx(l0,{className:"h-5 w-5"})})]}),Ft.length>0&&a.jsx("div",{className:"hidden md:flex md:justify-center md:flex-1",children:Ft.length===1?a.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:Am(Ft[0])}}),a.jsx("span",{className:"font-semibold text-sm",children:Ft[0]})]}):a.jsxs(Cn,{value:Nr||Ft[0],onValueChange:Ie=>{Rr(Ie)},children:[a.jsx(jn,{className:"w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:a.jsx(An,{placeholder:"Selecionar quadra"})}),a.jsx(_n,{className:"border-brand/30",children:Ft.map(Ie=>{const Ye=Am(Ie);return a.jsx(nt,{value:Ie,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:Ye}}),a.jsx("span",{className:"font-semibold",children:Ie})]})},Ie)})})]})}),a.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto md:ml-auto",children:[a.jsxs("div",{className:"flex items-center gap-3 justify-center md:hidden",children:[a.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[a.jsx(ce,{variant:z==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>H("day"),children:"Dia"}),a.jsx(ce,{variant:z==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>H("week"),children:"Semana"})]}),a.jsxs(ob,{children:[a.jsx(sb,{asChild:!0,children:a.jsxs(ce,{variant:"outline",size:"sm",className:"gap-2",disabled:Dt.length===0,children:[a.jsx(DF,{className:"h-4 w-4"})," Filtros"]})}),a.jsxs(nx,{align:"end",className:"w-64",children:[a.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[a.jsx(yT,{className:"p-0",children:"Exibio"}),a.jsx(ce,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>St({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),a.jsx(Yj,{}),a.jsx(dl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ns,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Agendados"})]}),a.jsx(Ha,{checked:Qe.scheduled,onCheckedChange:Ie=>St(Ye=>({...Ye,scheduled:!!Ie,canceledOnly:Ie?!1:Ye.canceledOnly}))})]})}),a.jsx(dl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(eI,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Livres"})]}),a.jsx(Ha,{checked:Qe.available,onCheckedChange:Ie=>St(Ye=>({...Ye,available:!!Ie,canceledOnly:Ie?!1:Ye.canceledOnly}))})]})}),a.jsx(dl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(zy,{className:"h-4 w-4 text-rose-400"}),a.jsx("span",{children:"Cancelados"})]}),a.jsx(Ha,{checked:Qe.canceledOnly,onCheckedChange:Ie=>{const Ye=!!Ie;St(ar=>({...ar,canceledOnly:Ye,scheduled:Ye?!1:ar.scheduled,available:Ye?!1:ar.available})),Ye&&!Zt&&Wt(!0)}})]})}),a.jsx(dl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ks,{className:"h-4 w-4 text-warning"}),a.jsx("span",{children:"Pagamentos Pendentes"})]}),a.jsx(Ha,{checked:Qe.pendingPayments,onCheckedChange:Ie=>St(Ye=>({...Ye,pendingPayments:!!Ie}))})]})})]})]}),a.jsxs("div",{className:"relative inline-block group",children:[a.jsx(ce,{variant:q?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Q(!q),"aria-label":q?"Minimizar grid":"Expandir grid",children:q?a.jsx(kF,{className:"h-4 w-4"}):a.jsx(EF,{className:"h-4 w-4"})}),a.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:a.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:q?"Minimizar (F10)":"Expandir (F10)"})})]}),a.jsx(ce,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>mn(!0),disabled:Dt.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:a.jsx(Of,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"flex items-center gap-3 justify-end flex-shrink-0",children:[a.jsxs("div",{className:"relative w-full sm:w-56",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar agendamento...",className:"pl-9",value:er,onChange:Ie=>Ze(Ie.target.value),onBlur:()=>Ze("")}),er&&a.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 px-2 py-0.5 rounded text-xs font-medium text-primary hover:bg-surface-2",onClick:()=>Ze(""),children:"Limpar"})]}),a.jsxs(ce,{size:"sm",onClick:()=>{he(null),wr(null);try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}qe()},"aria-label":"Novo agendamento",className:"gap-2",disabled:Dt.length===0||Ft.every(Ie=>pe[Ie]&&!pe[Ie].funciona),children:[a.jsx(ro,{className:"h-4 w-4"})," Agendar"]})]}),Ft.length>0&&a.jsx("div",{className:"md:hidden flex justify-center",children:Ft.length===1?a.jsxs("div",{className:"inline-flex items-center justify-center gap-3 px-4 py-2 rounded-lg w-auto h-10 max-w-full border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:Am(Ft[0])}}),a.jsx("span",{className:"font-semibold text-sm text-center whitespace-nowrap truncate",children:Ft[0]})]}):a.jsxs(Cn,{value:Ft[Er%Ft.length],onValueChange:Ie=>{const Ye=Ft.indexOf(Ie);Ye!==-1&&ln(Ye)},children:[a.jsx(jn,{className:"w-48 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:a.jsx(An,{placeholder:"Selecionar quadra"})}),a.jsx(_n,{className:"border-brand/30",children:Ft.map(Ie=>{const Ye=Am(Ie);return a.jsx(nt,{value:Ie,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:Ye}}),a.jsx("span",{className:"font-semibold",children:Ie})]})},Ie)})})]})}),a.jsxs("div",{className:"hidden md:flex items-center gap-3 justify-end",children:[a.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[a.jsx(ce,{variant:z==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>H("day"),children:"Dia"}),a.jsx(ce,{variant:z==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>H("week"),children:"Semana"})]}),a.jsxs(ob,{children:[a.jsx(sb,{asChild:!0,children:a.jsxs(ce,{variant:"outline",size:"sm",className:"gap-2",disabled:Dt.length===0,children:[a.jsx(DF,{className:"h-4 w-4"})," Filtros"]})}),a.jsxs(nx,{align:"end",className:"w-64",children:[a.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[a.jsx(yT,{className:"p-0",children:"Exibio"}),a.jsx(ce,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>St({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),a.jsx(Yj,{}),a.jsx(dl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ns,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Agendados"})]}),a.jsx(Ha,{checked:Qe.scheduled,onCheckedChange:Ie=>St(Ye=>({...Ye,scheduled:!!Ie,canceledOnly:Ie?!1:Ye.canceledOnly}))})]})}),a.jsx(dl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(eI,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Livres"})]}),a.jsx(Ha,{checked:Qe.available,onCheckedChange:Ie=>St(Ye=>({...Ye,available:!!Ie,canceledOnly:Ie?!1:Ye.canceledOnly}))})]})}),a.jsx(dl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(zy,{className:"h-4 w-4 text-rose-400"}),a.jsx("span",{children:"Cancelados"})]}),a.jsx(Ha,{checked:Qe.canceledOnly,onCheckedChange:Ie=>{const Ye=!!Ie;St(ar=>({...ar,canceledOnly:Ye,scheduled:Ye?!1:ar.scheduled,available:Ye?!1:ar.available})),Ye&&!Zt&&Wt(!0)}})]})}),a.jsx(dl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ks,{className:"h-4 w-4 text-warning"}),a.jsx("span",{children:"Pagamentos Pendentes"})]}),a.jsx(Ha,{checked:Qe.pendingPayments,onCheckedChange:Ie=>St(Ye=>({...Ye,pendingPayments:!!Ie}))})]})})]})]}),a.jsxs("div",{className:"relative inline-block group",children:[a.jsx(ce,{variant:q?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Q(!q),"aria-label":q?"Minimizar grid":"Expandir grid",children:q?a.jsx(kF,{className:"h-4 w-4"}):a.jsx(EF,{className:"h-4 w-4"})}),a.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:a.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:q?"Minimizar (F10)":"Expandir (F10)"})})]}),a.jsx(ce,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>mn(!0),disabled:Dt.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:a.jsx(Of,{className:"h-5 w-5"})})]})]})]})}),a.jsx(xn,{open:Jr,onOpenChange:Ie=>{Ie||re(Te),mn(Ie)},children:a.jsxs(vn,{className:"sm:max-w-[680px]",onOpenAutoFocus:Ie=>Ie.preventDefault(),children:[a.jsx(pn,{className:"pb-3 border-b border-border bg-surface-2/40 rounded-t-lg px-2 -mx-2 -mt-2",children:a.jsx(fn,{className:"text-base font-semibold tracking-tight",children:"Configuraes da Agenda"})}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[a.jsx(Ds,{className:"h-4 w-4",style:{color:ri.confirmed.hex}}),a.jsx("span",{className:"text-sm font-medium",children:"Confirmao automtica"})]}),a.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-3",style:{borderLeftWidth:3,borderLeftColor:ri.confirmed.hex},children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"autoConfirmEnabled",checked:Nn.autoConfirmEnabled,onCheckedChange:Ie=>re(Ye=>({...Ye,autoConfirmEnabled:!!Ie}))}),a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:ri.confirmed.hex}}),a.jsx(De,{htmlFor:"autoConfirmEnabled",className:"font-medium",children:"Confirmao automtica"})]})]})}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(De,{htmlFor:"autoconfirm-hours",className:"text-sm text-text-muted",children:"Confirmar se faltar"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Cn,{value:String(Math.max(0,Math.round((Nn.autoConfirmMinutesBefore||0)/60))),onValueChange:Ie=>re(Ye=>({...Ye,autoConfirmMinutesBefore:Math.max(0,Number(Ie))*60})),disabled:!Nn.autoConfirmEnabled,children:[a.jsx(jn,{className:"w-32",children:a.jsx(An,{placeholder:"Horas"})}),a.jsxs(_n,{align:"start",children:[a.jsx(nt,{value:"0",children:"Imediato"}),a.jsx(nt,{value:"1",children:"1 h"}),a.jsx(nt,{value:"2",children:"2 h"}),a.jsx(nt,{value:"3",children:"3 h"}),a.jsx(nt,{value:"4",children:"4 h"}),a.jsx(nt,{value:"6",children:"6 h"}),a.jsx(nt,{value:"8",children:"8 h"}),a.jsx(nt,{value:"12",children:"12 h"}),a.jsx(nt,{value:"24",children:"24 h"})]})]}),a.jsx("span",{className:"text-sm text-text-muted",children:"antes"})]})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[a.jsx(zH,{className:"h-4 w-4",style:{color:ri.in_progress.hex}}),a.jsx("span",{className:"text-sm font-medium",children:"Transies automticas"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:ri.in_progress.hex},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"autoStartEnabled",checked:Nn.autoStartEnabled,onCheckedChange:Ie=>re(Ye=>({...Ye,autoStartEnabled:!!Ie}))}),a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:ri.in_progress.hex}}),a.jsx(De,{htmlFor:"autoStartEnabled",className:"font-medium",children:"Iniciar no horrio"})]})]}),a.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Confirmado  Em andamento no horrio de incio."})]}),a.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:ri.finished.hex},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"autoFinishEnabled",checked:Nn.autoFinishEnabled,onCheckedChange:Ie=>re(Ye=>({...Ye,autoFinishEnabled:!!Ie}))}),a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:ri.finished.hex}}),a.jsx(De,{htmlFor:"autoFinishEnabled",className:"font-medium",children:"Finalizar ao trmino"})]})]}),a.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Em andamento  Finalizado no horrio de trmino."})]})]})]})]}),a.jsxs(ra,{className:"mt-2 gap-2",children:[a.jsx(ce,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>mn(!1),children:"Cancelar"}),a.jsx(ce,{type:"button",variant:"default",onClick:()=>{console.log(" BOTO SALVAR CLICADO!"),Xn()},disabled:te,children:te?"Salvando":"Salvar"})]})]})}),a.jsx(xn,{open:bt,onOpenChange:Wt,children:a.jsxs(vn,{className:"sm:max-w-[520px]",onOpenAutoFocus:Ie=>Ie.preventDefault(),children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Sobre agendamentos cancelados"}),a.jsx(On,{children:"Agendamentos cancelados no aparecem na agenda quando o filtro no est selecionado e no ocupam horrio."})]}),a.jsxs("div",{className:"flex items-start gap-3 mt-2",children:[a.jsx(Ha,{id:"hide-canceled-info",checked:Zt,onCheckedChange:Ie=>Br(!!Ie),className:"mt-0.5"}),a.jsx(De,{htmlFor:"hide-canceled-info",className:"text-sm cursor-pointer text-text-secondary",children:"No mostrar novamente"})]}),a.jsx(ra,{className:"mt-4",children:a.jsx(ce,{type:"button",onClick:()=>Wt(!1),children:"Entendi"})})]})}),!mt&&Dt.length===0&&a.jsxs("div",{className:"mb-4 p-4 rounded-lg border border-border bg-surface text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Nenhuma quadra encontrada"}),a.jsx("div",{className:"text-text-muted",children:"Cadastre suas quadras para comear a usar a agenda."})]}),a.jsx(ce,{asChild:!0,className:"w-full sm:w-auto",children:a.jsxs(n4,{to:"/quadras",children:[a.jsx("span",{className:"hidden sm:inline",children:"Ir para Cadastros  Quadras"}),a.jsx("span",{className:"sm:hidden",children:"Adicionar"})]})})]}),Ft.length>0&&z==="week"&&(()=>{const Ie=Nr||Ft[0],Ye=L?af.filter(ar=>{const Gt=ar.court===Ie,Ut=ft?.[Ie]||{},Ot=String(Ut.id||Ut.codigo||""),S=Ot&&String(ar.court_id||"")===Ot;return Gt||S}):af;return a.jsx(a.Fragment,{children:a.jsx(nZe,{weekStart:fp(D),weekBookings:Ye,activeCourtFilter:Ie,courtsMap:ft,participantsByAgendamento:ke,onBookingClick:ar=>{he(ar),de(!0)},onSlotClick:(ar,Gt)=>{he(null);const Ut=ar.getHours()*60+ar.getMinutes(),Ot=Gt||Nr||Ft[0],S=dr(ar,"yyyy-MM-dd"),K=(()=>{try{return(le||[]).filter(Pe=>Pe.court===Ot&&dr(Pe.start,"yyyy-MM-dd")===S&&Pe.status!=="canceled").map(Pe=>bu(Pe.start)*60+wu(Pe.start)).filter(Pe=>Pe>Ut).sort((Pe,ze)=>Pe-ze)[0]}catch{}})(),ne=(()=>{const Pe=ft[Ot]?.hora_fim;if(!Pe)return yo*60;const[ze,Ke]=String(Pe).split(":").map(Number);return(ze===0&&(Ke||0)===0?24:ze)*60+(Ke||0)})(),Ce=typeof K=="number"?K:ne;let W=Math.min(Ut+60,Ce);W-Ut<30&&(Ce-30>=Ut?W=Ce:W=Math.min(ne,Ut+30));const oe={date:ko(ar),court:Ot,startMinutes:Ut,endMinutes:W};console.log("onSlotClick in AgendaPage - BEFORE setPrefill",{slotDate:ar,court:Gt,activeCourtFilter:Nr,selectedCourts:Ft,startMinutes:Ut,endMinutes:W,prefillData:oe}),wr(oe),console.log("onSlotClick in AgendaPage - AFTER setPrefill (state not updated yet)");try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}qe()},statusConfig:ri,dayStartHour:Ro,dayEndHourExclusive:yo,weekDiasFuncionamento:J,sidebarVisible:e},`weekly-${Ie}`)})})(),Ft.length>0&&z==="day"&&(()=>{const Ie=typeof window<"u"&&window.innerWidth<768,Ye=Ie?[Ft[Er%Ft.length]]:Nr?[Nr]:Ft,ar=Ie?Ye[0]:Nr,Gt=(()=>{if(ar&&ft[ar]){const S=ft[ar],K=S.hora_inicio||`${Ro}:00:00`,ne=S.hora_fim||`${yo}:00:00`,[Ce]=String(K).split(":").map(Number),[W,oe]=String(ne).split(":").map(Number);let Pe=W===0&&oe===0?24:W;return oe>0&&Pe<24&&(Pe+=1),{start:Ce||Ro,end:Pe||yo}}return{start:Ro,end:yo}})(),Ut=Array.from({length:Math.max(0,Gt.end-Gt.start)},(S,K)=>Gt.start+K),Ot=Math.max(0,Gt.end-Gt.start)*(60/Oa)*_i;return Ye.some(S=>pe[S]&&!pe[S].funciona),a.jsx(a.Fragment,{children:a.jsx(Pr.div,{variants:ee?void 0:q9,className:mr("bg-surface fx-scroll","overflow-auto",Ie?"":"rounded-lg border border-border"),ref:$n,style:{flex:"1 1 auto",minWidth:0},children:a.jsxs("div",{className:mr("grid",!Ie&&"mx-auto"),style:{gridTemplateColumns:Ie?"60px 1fr":Ye.length===1?"120px 760px":Ye.length===2?"120px repeat(2, 520px)":`120px repeat(${Ye.length}, 1fr)`,width:Ie?"100%":Ye.length<=2?"fit-content":void 0,columnGap:Ie?"4px":"16px"},children:[a.jsxs("div",{className:"sticky left-0 bg-surface z-20",children:[a.jsx("div",{className:"sticky top-0 z-20 h-14 border-b border-r border-border bg-surface flex items-center justify-center px-2",children:a.jsxs(ob,{children:[a.jsx(sb,{asChild:!0,children:a.jsx(ce,{size:"sm",variant:"ghost",className:"hover:bg-surface-2/50 text-lg font-semibold",children:Ki(D,new Date)?"Hoje":dr(D,"EEEE",{locale:wa})})}),a.jsxs(nx,{align:"center",children:[a.jsx(dl,{onClick:()=>U(new Date),children:"Hoje"}),a.jsx(Yj,{}),(()=>{const S=["Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],K=Nd(D,{weekStartsOn:1,locale:wa});return S.map((ne,Ce)=>a.jsx(dl,{onClick:()=>U(La(K,Ce)),children:ne},ne))})()]})]})}),Ut.map(S=>a.jsxs("div",{className:mr("border-r border-border",S%2===1&&"bg-surface-2/30"),children:[a.jsx("div",{className:"relative border-b border-border/80",style:{height:_i},children:a.jsxs("span",{className:mr("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",Ie?"px-1 text-sm":"px-2 text-lg"),children:[String(S).padStart(2,"0"),":00"]})}),a.jsx("div",{className:"relative border-b border-border/80",style:{height:_i},children:a.jsxs("span",{className:mr("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",Ie?"px-1 text-sm":"px-2 text-lg"),children:[String(S).padStart(2,"0"),":30"]})})]},`time-${S}`))]}),Ye.map((S,K)=>a.jsxs("div",{className:"relative border-r border-border",children:[a.jsx("div",{className:"h-14 border-b border-border sticky top-0 bg-surface z-10 flex items-center justify-center",children:K===0&&a.jsxs("div",{className:"flex items-center justify-center gap-4 px-3",children:[pi.totalBookings>0&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[a.jsx("span",{className:"text-lg",children:""}),a.jsx("span",{className:"font-bold text-text-primary",children:pi.totalBookings}),a.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["agendamento",pi.totalBookings!==1?"s":""]})]}),pi.totalPendingPayments>0&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[a.jsx("span",{className:"text-lg",children:""}),a.jsx("span",{className:"font-bold text-text-primary",children:pi.totalPendingPayments}),a.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["pendente",pi.totalPendingPayments!==1?"s":""]})]}),Z&&a.jsxs("button",{type:"button",onClick:async()=>{const ne=await ge(Z),Ce=Z.replace(/^https?:\/\//,"");try{navigator.vibrate&&navigator.vibrate(50)}catch{}if(ne)if(typeof window<"u"&&window.innerWidth<640)try{alert(`Link copiado: ${Ce}`)}catch{}else t({title:"Link copiado",description:Ce});else t({title:"No foi possvel copiar",description:Ce,variant:"destructive"})},className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md text-xs border border-white/10 bg-surface/60 hover:bg-surface-2/70 hover:border-white/20 transition-colors","aria-label":"Copiar link de agendamento",title:"Copiar link de agendamento",children:[a.jsx(kue,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"link Agendamento"}),a.jsx("span",{className:"sm:hidden",children:a.jsx(FH,{className:"w-4 h-4"})})]})]})}),a.jsxs("div",{className:mr("relative"),style:{height:Ot},children:[pe[S]&&!pe[S].funciona?(()=>Ut.map(ne=>a.jsx("div",{className:"absolute w-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/30 transition-colors",style:{height:_i*2,top:Ut.indexOf(ne)*_i*2},children:a.jsxs("div",{className:"text-center pointer-events-none",children:[a.jsx(s4,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),a.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),pe[S].observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:pe[S].observacao})]})},`closed-${S}-${ne}`)))():null,(Qe.scheduled||Qe.canceledOnly||Qe.pendingPayments)&&(()=>{const ne=Gt.start*60,Ce=Gt.end*60,W=(()=>{const Ct=ft[S]?.hora_inicio,Or=ft[S]?.hora_fim,[jr,or]=String(Ct||`${Gt.start}:00:00`).split(":").map(Number),[Hr,Cr]=String(Or||`${Gt.end}:00:00`).split(":").map(Number),Yr=Hr===0&&Cr===0?24:Hr||0;return{start:(jr||0)*60+(or||0),end:Yr*60+(Cr||0)}})(),oe=Math.max(W.start,ne),Pe=Math.min(W.end,Ce),ze=Math.max(0,Math.floor((oe-ne)/Oa)),Ke=Math.max(ze,Math.ceil((Pe-ne)/Oa)),Tt=Math.max(0,(Ce-ne)/Oa),it=ze*_i,Bt=Math.min(Tt,Math.max(0,Ke-ze)),Kt=Math.max(0,(Tt-Ke)*_i);return a.jsxs(a.Fragment,{children:[it>0&&a.jsx("div",{style:{height:it}}),Array.from({length:Bt},(Ct,Or)=>{const jr=ze+Or,Hr=(Math.floor(jr/(60/Oa))+Math.floor(ne/60))%2===1;return a.jsx("div",{className:mr("border-b border-border/80",Hr&&"bg-surface-2/30"),style:{height:_i}},`base-${S}-slot-${jr}`)}),Kt>0&&a.jsx("div",{style:{height:Kt}})]})})(),Fs.filter(ne=>{if(!L)return!0;const Ce=ne.court===S,W=ft?.[S]||{},oe=String(W.id||W.codigo||""),Pe=oe&&String(ne.court_id||"")===oe;return Ce||Pe}).map(ne=>a.jsx(nf,{booking:ne,courtGridStart:Gt.start*60,courtGridEnd:Gt.end*60},ne.id)),Qe.available&&!(pe[S]&&!pe[S].funciona)&&(()=>{const ne=(()=>{const it=ft[S]?.hora_inicio;if(!it)return Ro*60;const[Bt,Kt]=String(it).split(":").map(Number);return Bt*60+(Kt||0)})(),Ce=(()=>{const it=ft[S]?.hora_fim;if(!it)return yo*60;const[Bt,Kt]=String(it).split(":").map(Number);return(Bt===0&&Kt===0?24:Bt)*60+(Kt||0)})(),W=it=>{const Bt=bu(it),Kt=wu(it);return Bt===0&&Kt===0?1440:Bt*60+Kt},oe=dr(D,"yyyy-MM-dd"),Pe=le.filter(it=>it.court===S&&dr(it.start,"yyyy-MM-dd")===oe&&it.status!=="canceled").map(it=>[W(it.start),W(it.end)]).sort((it,Bt)=>it[0]-Bt[0]),ze=[];let Ke=ne;for(const[it,Bt]of Pe)it>Ke&&ze.push([Ke,it]),Ke=Math.max(Ke,Bt);Ke<Ce&&ze.push([Ke,Ce]);const Tt=({startM:it,endM:Bt})=>{const[Kt,Ct]=p.useState(null),Or=Gt.start*60,jr=Math.floor((it-Or)/Oa),or=Math.max(1,Math.ceil((Bt-it)/Oa)),Hr=jr+or,Cr=jr*_i-1,Yr=(Hr-jr)*_i+2;let vr=Math.floor(it/60),lr=Math.floor(Bt/60);vr>=24&&(vr=vr%24),lr>=24&&(lr=lr%24);const ct=`${String(vr).padStart(2,"0")}:${String(it%60).padStart(2,"0")}`,Zr=`${String(lr).padStart(2,"0")}:${String(Bt%60).padStart(2,"0")}`;return a.jsxs("div",{className:mr("absolute left-2 right-2 rounded-md border-2 border-dashed text-sm z-0 cursor-pointer","border-[#10B981]","bg-transparent hover:border-[#10B981]/80 hover:shadow-sm"),style:{top:`${Cr}px`,height:`${Yr}px`},onMouseMove:cn=>{const Ia=cn.currentTarget.getBoundingClientRect(),Ca=Math.min(Math.max(0,cn.clientY-Ia.top),Ia.height);let cr=Math.floor(Ca/_i);cr=Math.max(0,Math.min(cr,or-1)),Ct(cr)},onMouseLeave:()=>Ct(null),onClick:cn=>{const Ia=cn.currentTarget.getBoundingClientRect(),Ca=Math.min(Math.max(0,cn.clientY-Ia.top),Ia.height),cr=Math.floor(Ca/_i);let xr=it+cr*Oa;xr=Math.max(it,Math.min(xr,Bt-Oa));const qr=(()=>le.filter(sr=>sr.court===S&&dr(sr.start,"yyyy-MM-dd")===oe).map(sr=>bu(sr.start)*60+wu(sr.start)).filter(sr=>sr>xr).sort((sr,nn)=>sr-nn)[0])(),Kr=typeof qr=="number"?qr:Ce;let un=Math.min(xr+60,Kr);if(un-xr<30){const on=Kr-30;on>=it?(xr=Math.max(it,Math.min(xr,on)),un=Kr):(xr=it,un=Math.min(Kr,Bt))}he(null);{const on=Dt||[],sr=on.includes(S)?S:on[0]||"";wr({court:sr,date:D,startMinutes:xr,endMinutes:un})}try{lastNonEmptySelectionRef.current=[],setChipsSnapshot([]),sessionStorage.removeItem(persistLastKey),sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}qe()},title:`Livre: ${ct}${Zr}`,children:[Kt!==null&&a.jsx("div",{className:"pointer-events-none absolute left-[6px] right-[6px] rounded-md border border-white/10 bg-white/5",style:{top:`${Kt*_i}px`,height:`${_i}px`}}),a.jsxs("div",{className:"h-full px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"font-medium text-[#10B981]",children:"Livre"}),a.jsxs("span",{className:"text-text-muted",children:[ct,"",Zr]})]})]})};return ze.map(([it,Bt],Kt)=>a.jsx(Tt,{startM:it,endM:Bt},`free-${S}-${Kt}`))})()]})]},S))]})})})})()]}),xu()]})}function U9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function V9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U9(Object(r),!0).forEach(function(n){vwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dl(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var W9=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),OE=function(){return Math.random().toString(36).substring(7).split("").join(".")},H9={INIT:"@@redux/INIT"+OE(),REPLACE:"@@redux/REPLACE"+OE(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+OE()}};function lZe(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function dae(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Dl(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Dl(1));return r(dae)(e,t)}if(typeof e!="function")throw new Error(Dl(2));var o=e,s=t,i=[],l=i,c=!1;function d(){l===i&&(l=i.slice())}function u(){if(c)throw new Error(Dl(3));return s}function f(g){if(typeof g!="function")throw new Error(Dl(4));if(c)throw new Error(Dl(5));var y=!0;return d(),l.push(g),function(){if(y){if(c)throw new Error(Dl(6));y=!1,d();var b=l.indexOf(g);l.splice(b,1),i=null}}}function h(g){if(!lZe(g))throw new Error(Dl(7));if(typeof g.type>"u")throw new Error(Dl(8));if(c)throw new Error(Dl(9));try{c=!0,s=o(s,g)}finally{c=!1}for(var y=i=l,x=0;x<y.length;x++){var b=y[x];b()}return g}function m(g){if(typeof g!="function")throw new Error(Dl(10));o=g,h({type:H9.REPLACE})}function v(){var g,y=f;return g={subscribe:function(b){if(typeof b!="object"||b===null)throw new Error(Dl(11));function w(){b.next&&b.next(u())}w();var j=y(w);return{unsubscribe:j}}},g[W9]=function(){return this},g}return h({type:H9.INIT}),n={dispatch:h,subscribe:f,getState:u,replaceReducer:m},n[W9]=v,n}function G9(e,t){return function(){return t(e.apply(this,arguments))}}function K9(e,t){if(typeof e=="function")return G9(e,t);if(typeof e!="object"||e===null)throw new Error(Dl(16));var r={};for(var n in e){var o=e[n];typeof o=="function"&&(r[n]=G9(o,t))}return r}function uae(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,o){return function(){return n(o.apply(void 0,arguments))}})}function cZe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var o=n.apply(void 0,arguments),s=function(){throw new Error(Dl(15))},i={getState:o.getState,dispatch:function(){return s.apply(void 0,arguments)}},l=t.map(function(c){return c(i)});return s=uae.apply(void 0,l)(o.dispatch),V9(V9({},o),{},{dispatch:s})}}}var fae=_e.createContext(null);function dZe(e){e()}var mae=dZe,uZe=function(t){return mae=t},fZe=function(){return mae};function mZe(){var e=fZe(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var o=t;o;)o.callback(),o=o.next})},get:function(){for(var o=[],s=t;s;)o.push(s),s=s.next;return o},subscribe:function(o){var s=!0,i=r={callback:o,next:null,prev:r};return i.prev?i.prev.next=i:t=i,function(){!s||t===null||(s=!1,i.next?i.next.prev=i.prev:r=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var X9={notify:function(){},get:function(){return[]}};function hae(e,t){var r,n=X9;function o(f){return c(),n.subscribe(f)}function s(){n.notify()}function i(){u.onStateChange&&u.onStateChange()}function l(){return!!r}function c(){r||(r=t?t.addNestedSub(i):e.subscribe(i),n=mZe())}function d(){r&&(r(),r=void 0,n.clear(),n=X9)}var u={addNestedSub:o,notifyNestedSubs:s,handleChangeWrapper:i,isSubscribed:l,trySubscribe:c,tryUnsubscribe:d,getListeners:function(){return n}};return u}var pae=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect;function hZe(e){var t=e.store,r=e.context,n=e.children,o=p.useMemo(function(){var l=hae(t);return{store:t,subscription:l}},[t]),s=p.useMemo(function(){return t.getState()},[t]);pae(function(){var l=o.subscription;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),s!==t.getState()&&l.notifyNestedSubs(),function(){l.tryUnsubscribe(),l.onStateChange=null}},[o,s]);var i=r||fae;return _e.createElement(i.Provider,{value:o},n)}var gae={exports:{}},ho={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fi=typeof Symbol=="function"&&Symbol.for,rR=fi?Symbol.for("react.element"):60103,nR=fi?Symbol.for("react.portal"):60106,M5=fi?Symbol.for("react.fragment"):60107,R5=fi?Symbol.for("react.strict_mode"):60108,L5=fi?Symbol.for("react.profiler"):60114,F5=fi?Symbol.for("react.provider"):60109,$5=fi?Symbol.for("react.context"):60110,aR=fi?Symbol.for("react.async_mode"):60111,B5=fi?Symbol.for("react.concurrent_mode"):60111,q5=fi?Symbol.for("react.forward_ref"):60112,z5=fi?Symbol.for("react.suspense"):60113,pZe=fi?Symbol.for("react.suspense_list"):60120,U5=fi?Symbol.for("react.memo"):60115,V5=fi?Symbol.for("react.lazy"):60116,gZe=fi?Symbol.for("react.block"):60121,vZe=fi?Symbol.for("react.fundamental"):60117,xZe=fi?Symbol.for("react.responder"):60118,yZe=fi?Symbol.for("react.scope"):60119;function qc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case rR:switch(e=e.type,e){case aR:case B5:case M5:case L5:case R5:case z5:return e;default:switch(e=e&&e.$$typeof,e){case $5:case q5:case V5:case U5:case F5:return e;default:return t}}case nR:return t}}}function vae(e){return qc(e)===B5}ho.AsyncMode=aR;ho.ConcurrentMode=B5;ho.ContextConsumer=$5;ho.ContextProvider=F5;ho.Element=rR;ho.ForwardRef=q5;ho.Fragment=M5;ho.Lazy=V5;ho.Memo=U5;ho.Portal=nR;ho.Profiler=L5;ho.StrictMode=R5;ho.Suspense=z5;ho.isAsyncMode=function(e){return vae(e)||qc(e)===aR};ho.isConcurrentMode=vae;ho.isContextConsumer=function(e){return qc(e)===$5};ho.isContextProvider=function(e){return qc(e)===F5};ho.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===rR};ho.isForwardRef=function(e){return qc(e)===q5};ho.isFragment=function(e){return qc(e)===M5};ho.isLazy=function(e){return qc(e)===V5};ho.isMemo=function(e){return qc(e)===U5};ho.isPortal=function(e){return qc(e)===nR};ho.isProfiler=function(e){return qc(e)===L5};ho.isStrictMode=function(e){return qc(e)===R5};ho.isSuspense=function(e){return qc(e)===z5};ho.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===M5||e===B5||e===L5||e===R5||e===z5||e===pZe||typeof e=="object"&&e!==null&&(e.$$typeof===V5||e.$$typeof===U5||e.$$typeof===F5||e.$$typeof===$5||e.$$typeof===q5||e.$$typeof===vZe||e.$$typeof===xZe||e.$$typeof===yZe||e.$$typeof===gZe)};ho.typeOf=qc;gae.exports=ho;var bZe=gae.exports,oR=bZe,wZe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},jZe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},_Ze={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},xae={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},sR={};sR[oR.ForwardRef]=_Ze;sR[oR.Memo]=xae;function Y9(e){return oR.isMemo(e)?xae:sR[e.$$typeof]||wZe}var NZe=Object.defineProperty,SZe=Object.getOwnPropertyNames,J9=Object.getOwnPropertySymbols,CZe=Object.getOwnPropertyDescriptor,PZe=Object.getPrototypeOf,Q9=Object.prototype;function yae(e,t,r){if(typeof t!="string"){if(Q9){var n=PZe(t);n&&n!==Q9&&yae(e,n,r)}var o=SZe(t);J9&&(o=o.concat(J9(t)));for(var s=Y9(e),i=Y9(t),l=0;l<o.length;++l){var c=o[l];if(!jZe[c]&&!(r&&r[c])&&!(i&&i[c])&&!(s&&s[c])){var d=CZe(t,c);try{NZe(e,c,d)}catch{}}}}return e}var AZe=yae;const Z9=Ga(AZe);var bae={exports:{}},Co={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W5=60103,H5=60106,T1=60107,D1=60108,M1=60114,R1=60109,L1=60110,F1=60112,$1=60113,iR=60120,B1=60115,q1=60116,wae=60121,jae=60122,_ae=60117,Nae=60129,Sae=60131;if(typeof Symbol=="function"&&Symbol.for){var Ni=Symbol.for;W5=Ni("react.element"),H5=Ni("react.portal"),T1=Ni("react.fragment"),D1=Ni("react.strict_mode"),M1=Ni("react.profiler"),R1=Ni("react.provider"),L1=Ni("react.context"),F1=Ni("react.forward_ref"),$1=Ni("react.suspense"),iR=Ni("react.suspense_list"),B1=Ni("react.memo"),q1=Ni("react.lazy"),wae=Ni("react.block"),jae=Ni("react.server.block"),_ae=Ni("react.fundamental"),Nae=Ni("react.debug_trace_mode"),Sae=Ni("react.legacy_hidden")}function vu(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case W5:switch(e=e.type,e){case T1:case M1:case D1:case $1:case iR:return e;default:switch(e=e&&e.$$typeof,e){case L1:case F1:case q1:case B1:case R1:return e;default:return t}}case H5:return t}}}var EZe=R1,kZe=W5,IZe=F1,OZe=T1,TZe=q1,DZe=B1,MZe=H5,RZe=M1,LZe=D1,FZe=$1;Co.ContextConsumer=L1;Co.ContextProvider=EZe;Co.Element=kZe;Co.ForwardRef=IZe;Co.Fragment=OZe;Co.Lazy=TZe;Co.Memo=DZe;Co.Portal=MZe;Co.Profiler=RZe;Co.StrictMode=LZe;Co.Suspense=FZe;Co.isAsyncMode=function(){return!1};Co.isConcurrentMode=function(){return!1};Co.isContextConsumer=function(e){return vu(e)===L1};Co.isContextProvider=function(e){return vu(e)===R1};Co.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===W5};Co.isForwardRef=function(e){return vu(e)===F1};Co.isFragment=function(e){return vu(e)===T1};Co.isLazy=function(e){return vu(e)===q1};Co.isMemo=function(e){return vu(e)===B1};Co.isPortal=function(e){return vu(e)===H5};Co.isProfiler=function(e){return vu(e)===M1};Co.isStrictMode=function(e){return vu(e)===D1};Co.isSuspense=function(e){return vu(e)===$1};Co.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===T1||e===M1||e===Nae||e===D1||e===$1||e===iR||e===Sae||typeof e=="object"&&e!==null&&(e.$$typeof===q1||e.$$typeof===B1||e.$$typeof===R1||e.$$typeof===L1||e.$$typeof===F1||e.$$typeof===_ae||e.$$typeof===wae||e[0]===jae)};Co.typeOf=vu;bae.exports=Co;var $Ze=bae.exports,BZe=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],qZe=["reactReduxForwardedRef"],zZe=[],UZe=[null,null];function VZe(e,t){var r=e[1];return[t.payload,r+1]}function eU(e,t,r){pae(function(){return e.apply(void 0,t)},r)}function WZe(e,t,r,n,o,s,i){e.current=n,t.current=o,r.current=!1,s.current&&(s.current=null,i())}function HZe(e,t,r,n,o,s,i,l,c,d){if(e){var u=!1,f=null,h=function(){if(!u){var g=t.getState(),y,x;try{y=n(g,o.current)}catch(b){x=b,f=b}x||(f=null),y===s.current?i.current||c():(s.current=y,l.current=y,i.current=!0,d({type:"STORE_UPDATED",payload:{error:x}}))}};r.onStateChange=h,r.trySubscribe(),h();var m=function(){if(u=!0,r.tryUnsubscribe(),r.onStateChange=null,f)throw f};return m}}var GZe=function(){return[null,0]};function KZe(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,o=n===void 0?function(w){return"ConnectAdvanced("+w+")"}:n,s=r.methodName,i=s===void 0?"connectAdvanced":s,l=r.renderCountProp,c=l===void 0?void 0:l,d=r.shouldHandleStateChanges,u=d===void 0?!0:d,f=r.storeKey,h=f===void 0?"store":f;r.withRef;var m=r.forwardRef,v=m===void 0?!1:m,g=r.context,y=g===void 0?fae:g,x=IN(r,BZe),b=y;return function(j){var _=j.displayName||j.name||"Component",C=o(_),E=ea({},x,{getDisplayName:o,methodName:i,renderCountProp:c,shouldHandleStateChanges:u,storeKey:h,displayName:C,wrappedComponentName:_,WrappedComponent:j}),A=x.pure;function P(D){return e(D.dispatch,E)}var F=A?p.useMemo:function(D){return D()};function M(D){var U=p.useMemo(function(){var ut=D.reactReduxForwardedRef,Rt=IN(D,qZe);return[D.context,ut,Rt]},[D]),z=U[0],H=U[1],q=U[2],Q=p.useMemo(function(){return z&&z.Consumer&&$Ze.isContextConsumer(_e.createElement(z.Consumer,null))?z:b},[z,b]),pe=p.useContext(Q),be=!!D.store&&!!D.store.getState&&!!D.store.dispatch;pe&&pe.store;var V=be?D.store:pe.store,B=p.useMemo(function(){return P(V)},[V]),J=p.useMemo(function(){if(!u)return UZe;var ut=hae(V,be?null:pe.subscription),Rt=ut.notifyNestedSubs.bind(ut);return[ut,Rt]},[V,be,pe]),ue=J[0],Ne=J[1],Z=p.useMemo(function(){return be?pe:ea({},pe,{subscription:ue})},[be,pe,ue]),ge=p.useReducer(VZe,zZe,GZe),le=ge[0],se=le[0],ee=ge[1];if(se&&se.error)throw se.error;var de=p.useRef(),Le=p.useRef(q),ae=p.useRef(),ie=p.useRef(!1),dt=F(function(){return ae.current&&q===Le.current?ae.current:B(V.getState(),q)},[V,se,q]);eU(WZe,[Le,de,ie,q,dt,ae,Ne]),eU(HZe,[u,V,ue,B,Le,de,ie,ae,Ne,ee],[V,ue,B]);var At=p.useMemo(function(){return _e.createElement(j,ea({},dt,{ref:H}))},[H,j,dt]),st=p.useMemo(function(){return u?_e.createElement(Q.Provider,{value:Z},At):At},[Q,At,Z]);return st}var I=A?_e.memo(M):M;if(I.WrappedComponent=j,I.displayName=M.displayName=C,v){var R=_e.forwardRef(function(U,z){return _e.createElement(I,ea({},U,{reactReduxForwardedRef:z}))});return R.displayName=C,R.WrappedComponent=j,Z9(R,j)}return Z9(I,j)}}function tU(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function TE(e,t){if(tU(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=0;o<r.length;o++)if(!Object.prototype.hasOwnProperty.call(t,r[o])||!tU(e[r[o]],t[r[o]]))return!1;return!0}function XZe(e,t){var r={},n=function(i){var l=e[i];typeof l=="function"&&(r[i]=function(){return t(l.apply(void 0,arguments))})};for(var o in e)n(o);return r}function lR(e){return function(r,n){var o=e(r,n);function s(){return o}return s.dependsOnOwnProps=!1,s}}function rU(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function Cae(e,t){return function(n,o){o.displayName;var s=function(l,c){return s.dependsOnOwnProps?s.mapToProps(l,c):s.mapToProps(l)};return s.dependsOnOwnProps=!0,s.mapToProps=function(l,c){s.mapToProps=e,s.dependsOnOwnProps=rU(e);var d=s(l,c);return typeof d=="function"&&(s.mapToProps=d,s.dependsOnOwnProps=rU(d),d=s(l,c)),d},s}}function YZe(e){return typeof e=="function"?Cae(e):void 0}function JZe(e){return e?void 0:lR(function(t){return{dispatch:t}})}function QZe(e){return e&&typeof e=="object"?lR(function(t){return XZe(e,t)}):void 0}const ZZe=[YZe,JZe,QZe];function eet(e){return typeof e=="function"?Cae(e):void 0}function tet(e){return e?void 0:lR(function(){return{}})}const ret=[eet,tet];function net(e,t,r){return ea({},r,e,t)}function aet(e){return function(r,n){n.displayName;var o=n.pure,s=n.areMergedPropsEqual,i=!1,l;return function(d,u,f){var h=e(d,u,f);return i?(!o||!s(h,l))&&(l=h):(i=!0,l=h),l}}}function oet(e){return typeof e=="function"?aet(e):void 0}function set(e){return e?void 0:function(){return net}}const iet=[oet,set];var cet=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function det(e,t,r,n){return function(s,i){return r(e(s,i),t(n,i),i)}}function uet(e,t,r,n,o){var s=o.areStatesEqual,i=o.areOwnPropsEqual,l=o.areStatePropsEqual,c=!1,d,u,f,h,m;function v(w,j){return d=w,u=j,f=e(d,u),h=t(n,u),m=r(f,h,u),c=!0,m}function g(){return f=e(d,u),t.dependsOnOwnProps&&(h=t(n,u)),m=r(f,h,u),m}function y(){return e.dependsOnOwnProps&&(f=e(d,u)),t.dependsOnOwnProps&&(h=t(n,u)),m=r(f,h,u),m}function x(){var w=e(d,u),j=!l(w,f);return f=w,j&&(m=r(f,h,u)),m}function b(w,j){var _=!i(j,u),C=!s(w,d,j,u);return d=w,u=j,_&&C?g():_?y():C?x():m}return function(j,_){return c?b(j,_):v(j,_)}}function fet(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,o=t.initMergeProps,s=IN(t,cet),i=r(e,s),l=n(e,s),c=o(e,s),d=s.pure?uet:det;return d(i,l,c,e,s)}var met=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function DE(e,t,r){for(var n=t.length-1;n>=0;n--){var o=t[n](e);if(o)return o}return function(s,i){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+i.wrappedComponentName+".")}}function het(e,t){return e===t}function pet(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?KZe:r,o=t.mapStateToPropsFactories,s=o===void 0?ret:o,i=t.mapDispatchToPropsFactories,l=i===void 0?ZZe:i,c=t.mergePropsFactories,d=c===void 0?iet:c,u=t.selectorFactory,f=u===void 0?fet:u;return function(m,v,g,y){y===void 0&&(y={});var x=y,b=x.pure,w=b===void 0?!0:b,j=x.areStatesEqual,_=j===void 0?het:j,C=x.areOwnPropsEqual,E=C===void 0?TE:C,A=x.areStatePropsEqual,P=A===void 0?TE:A,F=x.areMergedPropsEqual,M=F===void 0?TE:F,I=IN(x,met),R=DE(m,s,"mapStateToProps"),D=DE(v,l,"mapDispatchToProps"),U=DE(g,d,"mergeProps");return n(f,ea({methodName:"connect",getDisplayName:function(H){return"Connect("+H+")"},shouldHandleStateChanges:!!m,initMapStateToProps:R,initMapDispatchToProps:D,initMergeProps:U,pure:w,areStatesEqual:_,areOwnPropsEqual:E,areStatePropsEqual:P,areMergedPropsEqual:M},I))}}const Pae=pet();uZe(Qf.unstable_batchedUpdates);function get(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Aae(e,t){var r=p.useState(function(){return{inputs:t,result:e()}})[0],n=p.useRef(!0),o=p.useRef(r),s=n.current||!!(t&&o.current.inputs&&get(t,o.current.inputs)),i=s?o.current:{inputs:t,result:e()};return p.useEffect(function(){n.current=!1,o.current=i},[i]),i.result}function vet(e,t){return Aae(function(){return e},t)}var Xa=Aae,Yn=vet,Zd=function(t){var r=t.top,n=t.right,o=t.bottom,s=t.left,i=n-s,l=o-r,c={top:r,right:n,bottom:o,left:s,width:i,height:l,x:s,y:r,center:{x:(n+s)/2,y:(o+r)/2}};return c},cR=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},nU=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},xet=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},ME={top:0,right:0,bottom:0,left:0},dR=function(t){var r=t.borderBox,n=t.margin,o=n===void 0?ME:n,s=t.border,i=s===void 0?ME:s,l=t.padding,c=l===void 0?ME:l,d=Zd(cR(r,o)),u=Zd(nU(r,i)),f=Zd(nU(u,c));return{marginBox:d,borderBox:Zd(r),paddingBox:u,contentBox:f,margin:o,border:i,padding:c}},Jc=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var o=Number(r);return isNaN(o)&&Nh(!1),o},yet=function(){return{x:window.pageXOffset,y:window.pageYOffset}},vS=function(t,r){var n=t.borderBox,o=t.border,s=t.margin,i=t.padding,l=xet(n,r);return dR({borderBox:l,border:o,margin:s,padding:i})},xS=function(t,r){return r===void 0&&(r=yet()),vS(t,r)},Eae=function(t,r){var n={top:Jc(r.marginTop),right:Jc(r.marginRight),bottom:Jc(r.marginBottom),left:Jc(r.marginLeft)},o={top:Jc(r.paddingTop),right:Jc(r.paddingRight),bottom:Jc(r.paddingBottom),left:Jc(r.paddingLeft)},s={top:Jc(r.borderTopWidth),right:Jc(r.borderRightWidth),bottom:Jc(r.borderBottomWidth),left:Jc(r.borderLeftWidth)};return dR({borderBox:t,margin:n,padding:o,border:s})},kae=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return Eae(r,n)},aU=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function bet(e,t){return!!(e===t||aU(e)&&aU(t))}function wet(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!bet(e[r],t[r]))return!1;return!0}function ci(e,t){t===void 0&&(t=wet);var r,n=[],o,s=!1;function i(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return s&&r===this&&t(l,n)||(o=e.apply(this,l),s=!0,r=this,n=l),o}return i}var jet=function(t){var r=[],n=null,o=function(){for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return o.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},o};const Ww=jet;function Iae(e,t){}Iae.bind(null,"warn");Iae.bind(null,"error");function gh(){}function _et(e,t){return ea({},e,{},t)}function pd(e,t,r){var n=t.map(function(o){var s=_et(r,o.options);return e.addEventListener(o.eventName,o.fn,s),function(){e.removeEventListener(o.eventName,o.fn,s)}});return function(){n.forEach(function(s){s()})}}var Net="Invariant failed";function yS(e){this.message=e}yS.prototype.toString=function(){return this.message};function sn(e,t){if(!e)throw new yS(Net)}var Cet=function(e){EQ(t,e);function t(){for(var n,o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return n=e.call.apply(e,[this].concat(s))||this,n.callbacks=null,n.unbind=gh,n.onWindowError=function(l){var c=n.getCallbacks();c.isDragging()&&c.tryAbort();var d=l.error;d instanceof yS&&l.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(l){n.callbacks=l},n}var r=t.prototype;return r.componentDidMount=function(){this.unbind=pd(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(o){if(o instanceof yS){this.setState({});return}throw o},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(_e.Component),Pet=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,bS=function(t){return t+1},Aet=function(t){return`
  You have lifted an item in position `+bS(t.source.index)+`
`},Oae=function(t,r){var n=t.droppableId===r.droppableId,o=bS(t.index),s=bS(r.index);return n?`
      You have moved the item from position `+o+`
      to position `+s+`
    `:`
    You have moved the item from position `+o+`
    in list `+t.droppableId+`
    to list `+r.droppableId+`
    in position `+s+`
  `},Tae=function(t,r,n){var o=r.droppableId===n.droppableId;return o?`
      The item `+t+`
      has been combined with `+n.draggableId:`
      The item `+t+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},Eet=function(t){var r=t.destination;if(r)return Oae(t.source,r);var n=t.combine;return n?Tae(t.draggableId,t.source,n):"You are over an area that cannot be dropped on"},oU=function(t){return`
  The item has returned to its starting position
  of `+bS(t.index)+`
`},ket=function(t){if(t.reason==="CANCEL")return`
      Movement cancelled.
      `+oU(t.source)+`
    `;var r=t.destination,n=t.combine;return r?`
      You have dropped the item.
      `+Oae(t.source,r)+`
    `:n?`
      You have dropped the item.
      `+Tae(t.draggableId,t.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+oU(t.source)+`
  `},t_={dragHandleUsageInstructions:Pet,onDragStart:Aet,onDragUpdate:Eet,onDragEnd:ket},di={x:0,y:0},Ai=function(t,r){return{x:t.x+r.x,y:t.y+r.y}},Cc=function(t,r){return{x:t.x-r.x,y:t.y-r.y}},vh=function(t,r){return t.x===r.x&&t.y===r.y},T0=function(t){return{x:t.x!==0?-t.x:0,y:t.y!==0?-t.y:0}},gg=function(t,r,n){var o;return n===void 0&&(n=0),o={},o[t]=r,o[t==="x"?"y":"x"]=n,o},Hw=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))},sU=function(t,r){return Math.min.apply(Math,r.map(function(n){return Hw(t,n)}))},Dae=function(t){return function(r){return{x:t(r.x),y:t(r.y)}}},Iet=function(e,t){var r=Zd({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r},z1=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},iU=function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}]},Oet={top:0,right:0,bottom:0,left:0},Tet=function(t,r){return r?z1(t,r.scroll.diff.displacement):t},Det=function(t,r,n){if(n&&n.increasedBy){var o;return ea({},t,(o={},o[r.end]=t[r.end]+n.increasedBy[r.line],o))}return t},Met=function(t,r){return r&&r.shouldClipSubject?Iet(r.pageMarginBox,t):Zd(t)},Zx=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,o=e.frame,s=Tet(t.marginBox,o),i=Det(s,n,r),l=Met(i,o);return{page:t,withPlaceholder:r,active:l}},uR=function(e,t){e.frame||sn(!1);var r=e.frame,n=Cc(t,r.scroll.initial),o=T0(n),s=ea({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:o},max:r.scroll.max}}),i=Zx({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:s}),l=ea({},e,{frame:s,subject:i});return l};function wS(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})}function fR(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function Vh(e,t){if(e.find)return e.find(t);var r=fR(e,t);if(r!==-1)return e[r]}function Mae(e){return Array.prototype.slice.call(e)}var Rae=ci(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),Lae=ci(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),G5=ci(function(e){return wS(e)}),Ret=ci(function(e){return wS(e)}),D0=ci(function(e,t){var r=Ret(t).filter(function(n){return e===n.descriptor.droppableId}).sort(function(n,o){return n.descriptor.index-o.descriptor.index});return r});function mR(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function K5(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var X5=ci(function(e,t){return t.filter(function(r){return r.descriptor.id!==e.descriptor.id})}),Let=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,o=e.insideDestination,s=e.previousImpact;if(!n.isCombineEnabled)return null;var i=mR(s);if(!i)return null;function l(g){var y={type:"COMBINE",combine:{draggableId:g,droppableId:n.descriptor.id}};return ea({},s,{at:y})}var c=s.displaced.all,d=c.length?c[0]:null;if(t)return d?l(d):null;var u=X5(r,o);if(!d){if(!u.length)return null;var f=u[u.length-1];return l(f.descriptor.id)}var h=fR(u,function(g){return g.descriptor.id===d});h===-1&&sn(!1);var m=h-1;if(m<0)return null;var v=u[m];return l(v.descriptor.id)},M0=function(e,t){return e.descriptor.droppableId===t.descriptor.id},Fae={point:di,value:0},Gw={invisible:{},visible:{},all:[]},Fet={displaced:Gw,displacedBy:Fae,at:null},bd=function(e,t){return function(r){return e<=r&&r<=t}},$ae=function(e){var t=bd(e.top,e.bottom),r=bd(e.left,e.right);return function(n){var o=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);if(o)return!0;var s=t(n.top)||t(n.bottom),i=r(n.left)||r(n.right),l=s&&i;if(l)return!0;var c=n.top<e.top&&n.bottom>e.bottom,d=n.left<e.left&&n.right>e.right,u=c&&d;if(u)return!0;var f=c&&i||d&&s;return f}},$et=function(e){var t=bd(e.top,e.bottom),r=bd(e.left,e.right);return function(n){var o=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);return o}},hR={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Bae={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},Bet=function(e){return function(t){var r=bd(t.top,t.bottom),n=bd(t.left,t.right);return function(o){return e===hR?r(o.top)&&r(o.bottom):n(o.left)&&n(o.right)}}},qet=function(t,r){var n=r.frame?r.frame.scroll.diff.displacement:di;return z1(t,n)},zet=function(t,r,n){return r.subject.active?n(r.subject.active)(t):!1},Uet=function(t,r,n){return n(r)(t)},pR=function(t){var r=t.target,n=t.destination,o=t.viewport,s=t.withDroppableDisplacement,i=t.isVisibleThroughFrameFn,l=s?qet(r,n):r;return zet(l,n,i)&&Uet(l,o,i)},Vet=function(t){return pR(ea({},t,{isVisibleThroughFrameFn:$ae}))},qae=function(t){return pR(ea({},t,{isVisibleThroughFrameFn:$et}))},Wet=function(t){return pR(ea({},t,{isVisibleThroughFrameFn:Bet(t.destination.axis)}))},Het=function(t,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var o=r.invisible,s=r.visible;if(o[t])return!1;var i=s[t];return i?i.shouldAnimate:!0};function Get(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return Zd(cR(r,n))}function Kw(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,o=e.viewport,s=e.forceShouldAnimate,i=e.last;return t.reduce(function(c,d){var u=Get(d,n),f=d.descriptor.id;c.all.push(f);var h=Vet({target:u,destination:r,viewport:o,withDroppableDisplacement:!0});if(!h)return c.invisible[d.descriptor.id]=!0,c;var m=Het(f,i,s),v={draggableId:f,shouldAnimate:m};return c.visible[f]=v,c},{all:[],visible:{},invisible:{}})}function Ket(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function lU(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,o=e.destination,s=Ket(t,{inHomeList:r});return{displaced:Gw,displacedBy:n,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:s}}}}function jS(e){var t=e.draggable,r=e.insideDestination,n=e.destination,o=e.viewport,s=e.displacedBy,i=e.last,l=e.index,c=e.forceShouldAnimate,d=M0(t,n);if(l==null)return lU({insideDestination:r,inHomeList:d,displacedBy:s,destination:n});var u=Vh(r,function(g){return g.descriptor.index===l});if(!u)return lU({insideDestination:r,inHomeList:d,displacedBy:s,destination:n});var f=X5(t,r),h=r.indexOf(u),m=f.slice(h),v=Kw({afterDragging:m,destination:n,displacedBy:s,last:i,viewport:o.frame,forceShouldAnimate:c});return{displaced:v,displacedBy:s,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function Eh(e,t){return!!t.effected[e]}var Xet=function(e){var t=e.isMovingForward,r=e.destination,n=e.draggables,o=e.combine,s=e.afterCritical;if(!r.isCombineEnabled)return null;var i=o.draggableId,l=n[i],c=l.descriptor.index,d=Eh(i,s);return d?t?c:c-1:t?c+1:c},Yet=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,o=e.location;if(!n.length)return null;var s=o.index,i=t?s+1:s-1,l=n[0].descriptor.index,c=n[n.length-1].descriptor.index,d=r?c:c+1;return i<l||i>d?null:i},Jet=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,o=e.draggables,s=e.destination,i=e.insideDestination,l=e.previousImpact,c=e.viewport,d=e.afterCritical,u=l.at;if(u||sn(!1),u.type==="REORDER"){var f=Yet({isMovingForward:t,isInHomeList:r,location:u.destination,insideDestination:i});return f==null?null:jS({draggable:n,insideDestination:i,destination:s,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:f})}var h=Xet({isMovingForward:t,destination:s,displaced:l.displaced,draggables:o,combine:u.combine,afterCritical:d});return h==null?null:jS({draggable:n,insideDestination:i,destination:s,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:h})},Qet=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,o=e.displacedBy,s=!!(t.visible[n]||t.invisible[n]);return Eh(n,r)?s?di:T0(o.point):s?o.point:di},Zet=function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,o=K5(r);o||sn(!1);var s=o.draggableId,i=n[s].page.borderBox.center,l=Qet({displaced:r.displaced,afterCritical:t,combineWith:s,displacedBy:r.displacedBy});return Ai(i,l)},zae=function(t,r){return r.margin[t.start]+r.borderBox[t.size]/2},ett=function(t,r){return r.margin[t.end]+r.borderBox[t.size]/2},gR=function(t,r,n){return r[t.crossAxisStart]+n.margin[t.crossAxisStart]+n.borderBox[t.crossAxisSize]/2},cU=function(t){var r=t.axis,n=t.moveRelativeTo,o=t.isMoving;return gg(r.line,n.marginBox[r.end]+zae(r,o),gR(r,n.marginBox,o))},dU=function(t){var r=t.axis,n=t.moveRelativeTo,o=t.isMoving;return gg(r.line,n.marginBox[r.start]-ett(r,o),gR(r,n.marginBox,o))},ttt=function(t){var r=t.axis,n=t.moveInto,o=t.isMoving;return gg(r.line,n.contentBox[r.start]+zae(r,o),gR(r,n.contentBox,o))},rtt=function(e){var t=e.impact,r=e.draggable,n=e.draggables,o=e.droppable,s=e.afterCritical,i=D0(o.descriptor.id,n),l=r.page,c=o.axis;if(!i.length)return ttt({axis:c,moveInto:o.page,isMoving:l});var d=t.displaced,u=t.displacedBy,f=d.all[0];if(f){var h=n[f];if(Eh(f,s))return dU({axis:c,moveRelativeTo:h.page,isMoving:l});var m=vS(h.page,u.point);return dU({axis:c,moveRelativeTo:m,isMoving:l})}var v=i[i.length-1];if(v.descriptor.id===r.descriptor.id)return l.borderBox.center;if(Eh(v.descriptor.id,s)){var g=vS(v.page,T0(s.displacedBy.point));return cU({axis:c,moveRelativeTo:g,isMoving:l})}return cU({axis:c,moveRelativeTo:v.page,isMoving:l})},UT=function(e,t){var r=e.frame;return r?Ai(t,r.scroll.diff.displacement):t},ntt=function(t){var r=t.impact,n=t.draggable,o=t.droppable,s=t.draggables,i=t.afterCritical,l=n.page.borderBox.center,c=r.at;return!o||!c?l:c.type==="REORDER"?rtt({impact:r,draggable:n,draggables:s,droppable:o,afterCritical:i}):Zet({impact:r,draggables:s,afterCritical:i})},Y5=function(e){var t=ntt(e),r=e.droppable,n=r?UT(r,t):t;return n},Uae=function(e,t){var r=Cc(t,e.scroll.initial),n=T0(r),o=Zd({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),s={frame:o,scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}};return s};function uU(e,t){return e.map(function(r){return t[r]})}function att(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}var ott=function(e){var t=e.impact,r=e.viewport,n=e.destination,o=e.draggables,s=e.maxScrollChange,i=Uae(r,Ai(r.scroll.current,s)),l=n.frame?uR(n,Ai(n.frame.scroll.current,s)):n,c=t.displaced,d=Kw({afterDragging:uU(c.all,o),destination:n,displacedBy:t.displacedBy,viewport:i.frame,last:c,forceShouldAnimate:!1}),u=Kw({afterDragging:uU(c.all,o),destination:l,displacedBy:t.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),f={},h={},m=[c,d,u];c.all.forEach(function(g){var y=att(g,m);if(y){h[g]=y;return}f[g]=!0});var v=ea({},t,{displaced:{all:c.all,invisible:f,visible:h}});return v},stt=function(e,t){return Ai(e.scroll.diff.displacement,t)},vR=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=e.viewport,o=stt(n,t),s=Cc(o,r.page.borderBox.center);return Ai(r.client.borderBox.center,s)},Vae=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,o=e.viewport,s=e.withDroppableDisplacement,i=e.onlyOnMainAxis,l=i===void 0?!1:i,c=Cc(n,t.page.borderBox.center),d=z1(t.page.borderBox,c),u={target:d,destination:r,withDroppableDisplacement:s,viewport:o};return l?Wet(u):qae(u)},itt=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,o=e.draggables,s=e.previousImpact,i=e.viewport,l=e.previousPageBorderBoxCenter,c=e.previousClientSelection,d=e.afterCritical;if(!n.isEnabled)return null;var u=D0(n.descriptor.id,o),f=M0(r,n),h=Let({isMovingForward:t,draggable:r,destination:n,insideDestination:u,previousImpact:s})||Jet({isMovingForward:t,isInHomeList:f,draggable:r,draggables:o,destination:n,insideDestination:u,previousImpact:s,viewport:i,afterCritical:d});if(!h)return null;var m=Y5({impact:h,draggable:r,droppable:n,draggables:o,afterCritical:d}),v=Vae({draggable:r,destination:n,newPageBorderBoxCenter:m,viewport:i.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(v){var g=vR({pageBorderBoxCenter:m,draggable:r,viewport:i});return{clientSelection:g,impact:h,scrollJumpRequest:null}}var y=Cc(m,l),x=ott({impact:h,viewport:i,destination:n,draggables:o,maxScrollChange:y});return{clientSelection:c,impact:x,scrollJumpRequest:y}},rl=function(t){var r=t.subject.active;return r||sn(!1),r},ltt=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,o=e.droppables,s=e.viewport,i=n.subject.active;if(!i)return null;var l=n.axis,c=bd(i[l.start],i[l.end]),d=G5(o).filter(function(f){return f!==n}).filter(function(f){return f.isEnabled}).filter(function(f){return!!f.subject.active}).filter(function(f){return $ae(s.frame)(rl(f))}).filter(function(f){var h=rl(f);return t?i[l.crossAxisEnd]<h[l.crossAxisEnd]:h[l.crossAxisStart]<i[l.crossAxisStart]}).filter(function(f){var h=rl(f),m=bd(h[l.start],h[l.end]);return c(h[l.start])||c(h[l.end])||m(i[l.start])||m(i[l.end])}).sort(function(f,h){var m=rl(f)[l.crossAxisStart],v=rl(h)[l.crossAxisStart];return t?m-v:v-m}).filter(function(f,h,m){return rl(f)[l.crossAxisStart]===rl(m[0])[l.crossAxisStart]});if(!d.length)return null;if(d.length===1)return d[0];var u=d.filter(function(f){var h=bd(rl(f)[l.start],rl(f)[l.end]);return h(r[l.line])});return u.length===1?u[0]:u.length>1?u.sort(function(f,h){return rl(f)[l.start]-rl(h)[l.start]})[0]:d.sort(function(f,h){var m=sU(r,iU(rl(f))),v=sU(r,iU(rl(h)));return m!==v?m-v:rl(f)[l.start]-rl(h)[l.start]})[0]},fU=function(t,r){var n=t.page.borderBox.center;return Eh(t.descriptor.id,r)?Cc(n,r.displacedBy.point):n},ctt=function(t,r){var n=t.page.borderBox;return Eh(t.descriptor.id,r)?z1(n,T0(r.displacedBy.point)):n},dtt=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,o=e.insideDestination,s=e.afterCritical,i=o.filter(function(l){return qae({target:ctt(l,s),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(l,c){var d=Hw(t,UT(n,fU(l,s))),u=Hw(t,UT(n,fU(c,s)));return d<u?-1:u<d?1:l.descriptor.index-c.descriptor.index});return i[0]||null},U1=ci(function(t,r){var n=r[t.line];return{value:n,point:gg(t.line,n)}}),utt=function(t,r,n){var o=t.axis;if(t.descriptor.mode==="virtual")return gg(o.line,r[o.line]);var s=t.subject.page.contentBox[o.size],i=D0(t.descriptor.id,n),l=i.reduce(function(u,f){return u+f.client.marginBox[o.size]},0),c=l+r[o.line],d=c-s;return d<=0?null:gg(o.line,d)},Wae=function(t,r){return ea({},t,{scroll:ea({},t.scroll,{max:r})})},Hae=function(t,r,n){var o=t.frame;M0(r,t)&&sn(!1),t.subject.withPlaceholder&&sn(!1);var s=U1(t.axis,r.displaceBy).point,i=utt(t,s,n),l={placeholderSize:s,increasedBy:i,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!o){var c=Zx({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:t.frame});return ea({},t,{subject:c})}var d=i?Ai(o.scroll.max,i):o.scroll.max,u=Wae(o,d),f=Zx({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:u});return ea({},t,{subject:f,frame:u})},ftt=function(t){var r=t.subject.withPlaceholder;r||sn(!1);var n=t.frame;if(!n){var o=Zx({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return ea({},t,{subject:o})}var s=r.oldFrameMaxScroll;s||sn(!1);var i=Wae(n,s),l=Zx({page:t.subject.page,axis:t.axis,frame:i,withPlaceholder:null});return ea({},t,{subject:l,frame:i})},mtt=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,o=e.draggable,s=e.draggables,i=e.destination,l=e.viewport,c=e.afterCritical;if(!r){if(n.length)return null;var d={displaced:Gw,displacedBy:Fae,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:0}}},u=Y5({impact:d,draggable:o,droppable:i,draggables:s,afterCritical:c}),f=M0(o,i)?i:Hae(i,o,s),h=Vae({draggable:o,destination:f,newPageBorderBoxCenter:u,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return h?d:null}var m=t[i.axis.line]<=r.page.borderBox.center[i.axis.line],v=function(){var y=r.descriptor.index;return r.descriptor.id===o.descriptor.id||m?y:y+1}(),g=U1(i.axis,o.displaceBy);return jS({draggable:o,insideDestination:n,destination:i,viewport:l,displacedBy:g,last:Gw,index:v})},htt=function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,o=e.isOver,s=e.draggables,i=e.droppables,l=e.viewport,c=e.afterCritical,d=ltt({isMovingForward:t,pageBorderBoxCenter:r,source:o,droppables:i,viewport:l});if(!d)return null;var u=D0(d.descriptor.id,s),f=dtt({pageBorderBoxCenter:r,viewport:l,destination:d,insideDestination:u,afterCritical:c}),h=mtt({previousPageBorderBoxCenter:r,destination:d,draggable:n,draggables:s,moveRelativeTo:f,insideDestination:u,viewport:l,afterCritical:c});if(!h)return null;var m=Y5({impact:h,draggable:n,droppable:d,draggables:s,afterCritical:c}),v=vR({pageBorderBoxCenter:m,draggable:n,viewport:l});return{clientSelection:v,impact:h,scrollJumpRequest:null}},Dc=function(e){var t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null},ptt=function(t,r){var n=Dc(t);return n?r[n]:null},gtt=function(e){var t=e.state,r=e.type,n=ptt(t.impact,t.dimensions.droppables),o=!!n,s=t.dimensions.droppables[t.critical.droppable.id],i=n||s,l=i.axis.direction,c=l==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||l==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(c&&!o)return null;var d=r==="MOVE_DOWN"||r==="MOVE_RIGHT",u=t.dimensions.draggables[t.critical.draggable.id],f=t.current.page.borderBoxCenter,h=t.dimensions,m=h.draggables,v=h.droppables;return c?itt({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,destination:i,draggables:m,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):htt({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,isOver:i,draggables:m,droppables:v,viewport:t.viewport,afterCritical:t.afterCritical})};function mp(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function Gae(e){var t=bd(e.top,e.bottom),r=bd(e.left,e.right);return function(o){return t(o.y)&&r(o.x)}}function vtt(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function xtt(e){var t=e.pageBorderBox,r=e.draggable,n=e.candidates,o=r.page.borderBox.center,s=n.map(function(i){var l=i.axis,c=gg(i.axis.line,t.center[l.line],i.page.borderBox.center[l.crossAxisLine]);return{id:i.descriptor.id,distance:Hw(o,c)}}).sort(function(i,l){return l.distance-i.distance});return s[0]?s[0].id:null}function ytt(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,o=G5(n).filter(function(s){if(!s.isEnabled)return!1;var i=s.subject.active;if(!i||!vtt(t,i))return!1;if(Gae(i)(t.center))return!0;var l=s.axis,c=i.center[l.crossAxisLine],d=t[l.crossAxisStart],u=t[l.crossAxisEnd],f=bd(i[l.crossAxisStart],i[l.crossAxisEnd]),h=f(d),m=f(u);return!h&&!m?!0:h?d<c:u>c});return o.length?o.length===1?o[0].descriptor.id:xtt({pageBorderBox:t,draggable:r,candidates:o}):null}var Kae=function(t,r){return Zd(z1(t,r))},btt=function(e,t){var r=e.frame;return r?Kae(t,r.scroll.diff.value):t};function Xae(e){var t=e.displaced,r=e.id;return!!(t.visible[r]||t.invisible[r])}function wtt(e){var t=e.draggable,r=e.closest,n=e.inHomeList;return r?n&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var jtt=function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,o=e.insideDestination,s=e.last,i=e.viewport,l=e.afterCritical,c=n.axis,d=U1(n.axis,r.displaceBy),u=d.value,f=t[c.start],h=t[c.end],m=X5(r,o),v=Vh(m,function(y){var x=y.descriptor.id,b=y.page.borderBox.center[c.line],w=Eh(x,l),j=Xae({displaced:s,id:x});return w?j?h<=b:f<b-u:j?h<=b+u:f<b}),g=wtt({draggable:r,closest:v,inHomeList:M0(r,n)});return jS({draggable:r,insideDestination:o,destination:n,viewport:i,last:s,displacedBy:d,index:g})},_tt=4,Ntt=function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,o=e.destination,s=e.insideDestination,i=e.afterCritical;if(!o.isCombineEnabled)return null;var l=o.axis,c=U1(o.axis,t.displaceBy),d=c.value,u=r[l.start],f=r[l.end],h=X5(t,s),m=Vh(h,function(g){var y=g.descriptor.id,x=g.page.borderBox,b=x[l.size],w=b/_tt,j=Eh(y,i),_=Xae({displaced:n.displaced,id:y});return j?_?f>x[l.start]+w&&f<x[l.end]-w:u>x[l.start]-d+w&&u<x[l.end]-d-w:_?f>x[l.start]+d+w&&f<x[l.end]+d-w:u>x[l.start]+w&&u<x[l.end]-w});if(!m)return null;var v={displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:o.descriptor.id}}};return v},Yae=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,o=e.droppables,s=e.previousImpact,i=e.viewport,l=e.afterCritical,c=Kae(r.page.borderBox,t),d=ytt({pageBorderBox:c,draggable:r,droppables:o});if(!d)return Fet;var u=o[d],f=D0(u.descriptor.id,n),h=btt(u,c);return Ntt({pageBorderBoxWithDroppableScroll:h,draggable:r,previousImpact:s,destination:u,insideDestination:f,afterCritical:l})||jtt({pageBorderBoxWithDroppableScroll:h,draggable:r,destination:u,insideDestination:f,last:s.displaced,viewport:i,afterCritical:l})},xR=function(e,t){var r;return ea({},e,(r={},r[t.descriptor.id]=t,r))},Stt=function(t){var r=t.previousImpact,n=t.impact,o=t.droppables,s=Dc(r),i=Dc(n);if(!s||s===i)return o;var l=o[s];if(!l.subject.withPlaceholder)return o;var c=ftt(l);return xR(o,c)},Ctt=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,o=e.previousImpact,s=e.impact,i=Stt({previousImpact:o,impact:s,droppables:n}),l=Dc(s);if(!l)return i;var c=n[l];if(M0(t,c)||c.subject.withPlaceholder)return i;var d=Hae(c,t,r);return xR(i,d)},vb=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,o=e.viewport,s=e.impact,i=e.scrollJumpRequest,l=o||t.viewport,c=n||t.dimensions,d=r||t.current.client.selection,u=Cc(d,t.initial.client.selection),f={offset:u,selection:d,borderBoxCenter:Ai(t.initial.client.borderBoxCenter,u)},h={selection:Ai(f.selection,l.scroll.current),borderBoxCenter:Ai(f.borderBoxCenter,l.scroll.current),offset:Ai(f.offset,l.scroll.diff.value)},m={client:f,page:h};if(t.phase==="COLLECTING")return ea({phase:"COLLECTING"},t,{dimensions:c,viewport:l,current:m});var v=c.draggables[t.critical.draggable.id],g=s||Yae({pageOffset:h.offset,draggable:v,draggables:c.draggables,droppables:c.droppables,previousImpact:t.impact,viewport:l,afterCritical:t.afterCritical}),y=Ctt({draggable:v,impact:g,previousImpact:t.impact,draggables:c.draggables,droppables:c.droppables}),x=ea({},t,{current:m,dimensions:{draggables:c.draggables,droppables:y},impact:g,viewport:l,scrollJumpRequest:i||null,forceShouldAnimate:i?!1:null});return x};function Ptt(e,t){return e.map(function(r){return t[r]})}var Jae=function(e){var t=e.impact,r=e.viewport,n=e.draggables,o=e.destination,s=e.forceShouldAnimate,i=t.displaced,l=Ptt(i.all,n),c=Kw({afterDragging:l,destination:o,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:s,last:i});return ea({},t,{displaced:c})},Qae=function(e){var t=e.impact,r=e.draggable,n=e.droppable,o=e.draggables,s=e.viewport,i=e.afterCritical,l=Y5({impact:t,draggable:r,draggables:o,droppable:n,afterCritical:i});return vR({pageBorderBoxCenter:l,draggable:r,viewport:s})},Zae=function(e){var t=e.state,r=e.dimensions,n=e.viewport;t.movementMode!=="SNAP"&&sn(!1);var o=t.impact,s=n||t.viewport,i=r||t.dimensions,l=i.draggables,c=i.droppables,d=l[t.critical.draggable.id],u=Dc(o);u||sn(!1);var f=c[u],h=Jae({impact:o,viewport:s,destination:f,draggables:l}),m=Qae({impact:h,draggable:d,droppable:f,draggables:l,viewport:s,afterCritical:t.afterCritical});return vb({impact:h,clientSelection:m,state:t,dimensions:i,viewport:s})},Att=function(e){return{index:e.index,droppableId:e.droppableId}},eoe=function(e){var t=e.draggable,r=e.home,n=e.draggables,o=e.viewport,s=U1(r.axis,t.displaceBy),i=D0(r.descriptor.id,n),l=i.indexOf(t);l===-1&&sn(!1);var c=i.slice(l+1),d=c.reduce(function(m,v){return m[v.descriptor.id]=!0,m},{}),u={inVirtualList:r.descriptor.mode==="virtual",displacedBy:s,effected:d},f=Kw({afterDragging:c,destination:r,displacedBy:s,last:null,viewport:o.frame,forceShouldAnimate:!1}),h={displaced:f,displacedBy:s,at:{type:"REORDER",destination:Att(t.descriptor)}};return{impact:h,afterCritical:u}},Ett=function(e,t){return{draggables:e.draggables,droppables:xR(e.droppables,t)}},ktt=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,o=vS(t.client,r),s=xS(o,n),i=ea({},t,{placeholder:ea({},t.placeholder,{client:o}),client:o,page:s});return i},Itt=function(e){var t=e.frame;return t||sn(!1),t},Ott=function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,o=n.scroll.diff.value;return t.map(function(s){var i=s.descriptor.droppableId,l=r[i],c=Itt(l),d=c.scroll.diff.value,u=Ai(o,d),f=ktt({draggable:s,offset:u,initialWindowScroll:n.scroll.initial});return f})},Ttt=function(e){var t=e.state,r=e.published,n=r.modified.map(function(w){var j=t.dimensions.droppables[w.droppableId],_=uR(j,w.scroll);return _}),o=ea({},t.dimensions.droppables,{},Rae(n)),s=Lae(Ott({additions:r.additions,updatedDroppables:o,viewport:t.viewport})),i=ea({},t.dimensions.draggables,{},s);r.removals.forEach(function(w){delete i[w]});var l={droppables:o,draggables:i},c=Dc(t.impact),d=c?l.droppables[c]:null,u=l.draggables[t.critical.draggable.id],f=l.droppables[t.critical.droppable.id],h=eoe({draggable:u,home:f,draggables:i,viewport:t.viewport}),m=h.impact,v=h.afterCritical,g=d&&d.isCombineEnabled?t.impact:m,y=Yae({pageOffset:t.current.page.offset,draggable:l.draggables[t.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:g,viewport:t.viewport,afterCritical:v}),x=ea({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:y,onLiftImpact:m,dimensions:l,afterCritical:v,forceShouldAnimate:!1});if(t.phase==="COLLECTING")return x;var b=ea({phase:"DROP_PENDING"},x,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1});return b},VT=function(t){return t.movementMode==="SNAP"},RE=function(t,r,n){var o=Ett(t.dimensions,r);return!VT(t)||n?vb({state:t,dimensions:o}):Zae({state:t,dimensions:o})};function LE(e){return e.isDragging&&e.movementMode==="SNAP"?ea({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var mU={phase:"IDLE",completed:null,shouldFlush:!1},Dtt=function(e,t){if(e===void 0&&(e=mU),t.type==="FLUSH")return ea({},mU,{shouldFlush:!0});if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&sn(!1);var r=t.payload,n=r.critical,o=r.clientSelection,s=r.viewport,i=r.dimensions,l=r.movementMode,c=i.draggables[n.draggable.id],d=i.droppables[n.droppable.id],u={selection:o,borderBoxCenter:c.client.borderBox.center,offset:di},f={client:u,page:{selection:Ai(u.selection,s.scroll.initial),borderBoxCenter:Ai(u.selection,s.scroll.initial),offset:Ai(u.selection,s.scroll.diff.value)}},h=G5(i.droppables).every(function(ee){return!ee.isFixedOnPage}),m=eoe({draggable:c,home:d,draggables:i.draggables,viewport:s}),v=m.impact,g=m.afterCritical,y={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:i,initial:f,current:f,isWindowScrollAllowed:h,impact:v,afterCritical:g,onLiftImpact:v,viewport:s,scrollJumpRequest:null,forceShouldAnimate:null};return y}if(t.type==="COLLECTION_STARTING"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&sn(!1);var x=ea({phase:"COLLECTING"},e,{phase:"COLLECTING"});return x}if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||sn(!1),Ttt({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;mp(e)||sn(!1);var b=t.payload.client;return vh(b,e.current.client.selection)?e:vb({state:e,clientSelection:b,impact:VT(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return LE(e);mp(e)||sn(!1);var w=t.payload,j=w.id,_=w.newScroll,C=e.dimensions.droppables[j];if(!C)return e;var E=uR(C,_);return RE(e,E,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;mp(e)||sn(!1);var A=t.payload,P=A.id,F=A.isEnabled,M=e.dimensions.droppables[P];M||sn(!1),M.isEnabled===F&&sn(!1);var I=ea({},M,{isEnabled:F});return RE(e,I,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;mp(e)||sn(!1);var R=t.payload,D=R.id,U=R.isCombineEnabled,z=e.dimensions.droppables[D];z||sn(!1),z.isCombineEnabled===U&&sn(!1);var H=ea({},z,{isCombineEnabled:U});return RE(e,H,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;mp(e)||sn(!1),e.isWindowScrollAllowed||sn(!1);var q=t.payload.newScroll;if(vh(e.viewport.scroll.current,q))return LE(e);var Q=Uae(e.viewport,q);return VT(e)?Zae({state:e,viewport:Q}):vb({state:e,viewport:Q})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!mp(e))return e;var pe=t.payload.maxScroll;if(vh(pe,e.viewport.scroll.max))return e;var be=ea({},e.viewport,{scroll:ea({},e.viewport.scroll,{max:pe})});return ea({phase:"DRAGGING"},e,{viewport:be})}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&sn(!1);var V=gtt({state:e,type:t.type});return V?vb({state:e,impact:V.impact,clientSelection:V.clientSelection,scrollJumpRequest:V.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){var B=t.payload.reason;e.phase!=="COLLECTING"&&sn(!1);var J=ea({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:B});return J}if(t.type==="DROP_ANIMATE"){var ue=t.payload,Ne=ue.completed,Z=ue.dropDuration,ge=ue.newHomeClientOffset;e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||sn(!1);var le={phase:"DROP_ANIMATING",completed:Ne,dropDuration:Z,newHomeClientOffset:ge,dimensions:e.dimensions};return le}if(t.type==="DROP_COMPLETE"){var se=t.payload.completed;return{phase:"IDLE",completed:se,shouldFlush:!1}}return e},Mtt=function(t){return{type:"BEFORE_INITIAL_CAPTURE",payload:t}},Rtt=function(t){return{type:"LIFT",payload:t}},Ltt=function(t){return{type:"INITIAL_PUBLISH",payload:t}},Ftt=function(t){return{type:"PUBLISH_WHILE_DRAGGING",payload:t}},$tt=function(){return{type:"COLLECTION_STARTING",payload:null}},Btt=function(t){return{type:"UPDATE_DROPPABLE_SCROLL",payload:t}},qtt=function(t){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}},ztt=function(t){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}},toe=function(t){return{type:"MOVE",payload:t}},Utt=function(t){return{type:"MOVE_BY_WINDOW_SCROLL",payload:t}},Vtt=function(t){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}},Wtt=function(){return{type:"MOVE_UP",payload:null}},Htt=function(){return{type:"MOVE_DOWN",payload:null}},Gtt=function(){return{type:"MOVE_RIGHT",payload:null}},Ktt=function(){return{type:"MOVE_LEFT",payload:null}},yR=function(){return{type:"FLUSH",payload:null}},Xtt=function(t){return{type:"DROP_ANIMATE",payload:t}},bR=function(t){return{type:"DROP_COMPLETE",payload:t}},roe=function(t){return{type:"DROP",payload:t}},Ytt=function(t){return{type:"DROP_PENDING",payload:t}},noe=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},Jtt=function(e){return function(t){var r=t.getState,n=t.dispatch;return function(o){return function(s){if(s.type!=="LIFT"){o(s);return}var i=s.payload,l=i.id,c=i.clientSelection,d=i.movementMode,u=r();u.phase==="DROP_ANIMATING"&&n(bR({completed:u.completed})),r().phase!=="IDLE"&&sn(!1),n(yR()),n(Mtt({draggableId:l,movementMode:d}));var f={shouldPublishImmediately:d==="SNAP"},h={draggableId:l,scrollOptions:f},m=e.startPublishing(h),v=m.critical,g=m.dimensions,y=m.viewport;n(Ltt({critical:v,dimensions:g,clientSelection:c,movementMode:d,viewport:y}))}}}},Qtt=function(e){return function(){return function(t){return function(r){r.type==="INITIAL_PUBLISH"&&e.dragging(),r.type==="DROP_ANIMATE"&&e.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&e.resting(),t(r)}}}},wR={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},Xw={opacity:{drop:0,combining:.7},scale:{drop:.75}},jR={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},ep=jR.outOfTheWay+"s "+wR.outOfTheWay,xb={fluid:"opacity "+ep,snap:"transform "+ep+", opacity "+ep,drop:function(t){var r=t+"s "+wR.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+ep,placeholder:"height "+ep+", width "+ep+", margin "+ep},hU=function(t){return vh(t,di)?null:"translate("+t.x+"px, "+t.y+"px)"},WT={moveTo:hU,drop:function(t,r){var n=hU(t);return n?r?n+" scale("+Xw.scale.drop+")":n:null}},HT=jR.minDropTime,aoe=jR.maxDropTime,Ztt=aoe-HT,pU=1500,ert=.6,trt=function(e){var t=e.current,r=e.destination,n=e.reason,o=Hw(t,r);if(o<=0)return HT;if(o>=pU)return aoe;var s=o/pU,i=HT+Ztt*s,l=n==="CANCEL"?i*ert:i;return Number(l.toFixed(2))},rrt=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,o=e.viewport,s=e.afterCritical,i=n.draggables,l=n.droppables,c=Dc(t),d=c?l[c]:null,u=l[r.descriptor.droppableId],f=Qae({impact:t,draggable:r,draggables:i,afterCritical:s,droppable:d||u,viewport:o}),h=Cc(f,r.client.borderBox.center);return h},nrt=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,o=e.home,s=e.viewport,i=e.onLiftImpact;if(!n.at||r!=="DROP"){var l=Jae({draggables:t,impact:i,destination:o,viewport:s,forceShouldAnimate:!0});return{impact:l,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var c=ea({},n,{displaced:Gw});return{impact:c,didDropInsideDroppable:!0}},art=function(e){var t=e.getState,r=e.dispatch;return function(n){return function(o){if(o.type!=="DROP"){n(o);return}var s=t(),i=o.payload.reason;if(s.phase==="COLLECTING"){r(Ytt({reason:i}));return}if(s.phase!=="IDLE"){var l=s.phase==="DROP_PENDING"&&s.isWaiting;l&&sn(!1),s.phase==="DRAGGING"||s.phase==="DROP_PENDING"||sn(!1);var c=s.critical,d=s.dimensions,u=d.draggables[s.critical.draggable.id],f=nrt({reason:i,lastImpact:s.impact,afterCritical:s.afterCritical,onLiftImpact:s.onLiftImpact,home:s.dimensions.droppables[s.critical.droppable.id],viewport:s.viewport,draggables:s.dimensions.draggables}),h=f.impact,m=f.didDropInsideDroppable,v=m?mR(h):null,g=m?K5(h):null,y={index:c.draggable.index,droppableId:c.droppable.id},x={draggableId:u.descriptor.id,type:u.descriptor.type,source:y,reason:i,mode:s.movementMode,destination:v,combine:g},b=rrt({impact:h,draggable:u,dimensions:d,viewport:s.viewport,afterCritical:s.afterCritical}),w={critical:s.critical,afterCritical:s.afterCritical,result:x,impact:h},j=!vh(s.current.client.offset,b)||!!x.combine;if(!j){r(bR({completed:w}));return}var _=trt({current:s.current.client.offset,destination:b,reason:i}),C={newHomeClientOffset:b,dropDuration:_,completed:w};r(Xtt(C))}}}},ooe=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function ort(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||e()}}}function srt(e){var t=e.onWindowScroll;function r(){t(ooe())}var n=Ww(r),o=ort(n),s=gh;function i(){return s!==gh}function l(){i()&&sn(!1),s=pd(window,[o])}function c(){i()||sn(!1),n.cancel(),s(),s=gh}return{start:l,stop:c,isActive:i}}var irt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},lrt=function(e){var t=srt({onWindowScroll:function(n){e.dispatch(Utt({newScroll:n}))}});return function(r){return function(n){!t.isActive()&&n.type==="INITIAL_PUBLISH"&&t.start(),t.isActive()&&irt(n)&&t.stop(),r(n)}}},crt=function(e){var t=!1,r=!1,n=setTimeout(function(){r=!0}),o=function(i){t||r||(t=!0,e(i),clearTimeout(n))};return o.wasCalled=function(){return t},o},drt=function(){var e=[],t=function(s){var i=fR(e,function(d){return d.timerId===s});i===-1&&sn(!1);var l=e.splice(i,1),c=l[0];c.callback()},r=function(s){var i=setTimeout(function(){return t(i)}),l={timerId:i,callback:s};e.push(l)},n=function(){if(e.length){var s=[].concat(e);e.length=0,s.forEach(function(i){clearTimeout(i.timerId),i.callback()})}};return{add:r,flush:n}},urt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.droppableId===r.droppableId&&t.index===r.index},frt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.draggableId===r.draggableId&&t.droppableId===r.droppableId},mrt=function(t,r){if(t===r)return!0;var n=t.draggable.id===r.draggable.id&&t.draggable.droppableId===r.draggable.droppableId&&t.draggable.type===r.draggable.type&&t.draggable.index===r.draggable.index,o=t.droppable.id===r.droppable.id&&t.droppable.type===r.droppable.type;return n&&o},py=function(t,r){r()},pj=function(t,r){return{draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:r}},FE=function(t,r,n,o){if(!t){n(o(r));return}var s=crt(n),i={announce:s};t(r,i),s.wasCalled()||n(o(r))},hrt=function(e,t){var r=drt(),n=null,o=function(h,m){n&&sn(!1),py("onBeforeCapture",function(){var v=e().onBeforeCapture;if(v){var g={draggableId:h,mode:m};v(g)}})},s=function(h,m){n&&sn(!1),py("onBeforeDragStart",function(){var v=e().onBeforeDragStart;v&&v(pj(h,m))})},i=function(h,m){n&&sn(!1);var v=pj(h,m);n={mode:m,lastCritical:h,lastLocation:v.source,lastCombine:null},r.add(function(){py("onDragStart",function(){return FE(e().onDragStart,v,t,t_.onDragStart)})})},l=function(h,m){var v=mR(m),g=K5(m);n||sn(!1);var y=!mrt(h,n.lastCritical);y&&(n.lastCritical=h);var x=!urt(n.lastLocation,v);x&&(n.lastLocation=v);var b=!frt(n.lastCombine,g);if(b&&(n.lastCombine=g),!(!y&&!x&&!b)){var w=ea({},pj(h,n.mode),{combine:g,destination:v});r.add(function(){py("onDragUpdate",function(){return FE(e().onDragUpdate,w,t,t_.onDragUpdate)})})}},c=function(){n||sn(!1),r.flush()},d=function(h){n||sn(!1),n=null,py("onDragEnd",function(){return FE(e().onDragEnd,h,t,t_.onDragEnd)})},u=function(){if(n){var h=ea({},pj(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});d(h)}};return{beforeCapture:o,beforeStart:s,start:i,update:l,flush:c,drop:d,abort:u}},prt=function(e,t){var r=hrt(e,t);return function(n){return function(o){return function(s){if(s.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(s.payload.draggableId,s.payload.movementMode);return}if(s.type==="INITIAL_PUBLISH"){var i=s.payload.critical;r.beforeStart(i,s.payload.movementMode),o(s),r.start(i,s.payload.movementMode);return}if(s.type==="DROP_COMPLETE"){var l=s.payload.completed.result;r.flush(),o(s),r.drop(l);return}if(o(s),s.type==="FLUSH"){r.abort();return}var c=n.getState();c.phase==="DRAGGING"&&r.update(c.critical,c.impact)}}}},grt=function(e){return function(t){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){t(r);return}var n=e.getState();n.phase!=="DROP_ANIMATING"&&sn(!1),e.dispatch(bR({completed:n.completed}))}}},vrt=function(e){var t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return function(o){return function(s){if((s.type==="FLUSH"||s.type==="DROP_COMPLETE"||s.type==="DROP_ANIMATION_FINISHED")&&n(),o(s),s.type==="DROP_ANIMATE"){var i={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var c=e.getState();c.phase==="DROP_ANIMATING"&&e.dispatch(noe())}};r=requestAnimationFrame(function(){r=null,t=pd(window,[i])})}}}},xrt=function(e){return function(){return function(t){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&e.stopPublishing(),t(r)}}}},yrt=function(e){var t=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(n.type==="FLUSH"){t=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){t=!1;var o=n.payload.completed.result;o.combine&&e.tryShiftRecord(o.draggableId,o.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}},brt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},wrt=function(e){return function(t){return function(r){return function(n){if(brt(n)){e.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var o=t.getState();o.phase!=="DRAGGING"&&sn(!1),e.start(o);return}r(n),e.scroll(t.getState())}}}},jrt=function(e){return function(t){return function(r){if(t(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(roe({reason:n.reason})))}}}},_rt=uae,Nrt=function(e){var t=e.dimensionMarshal,r=e.focusMarshal,n=e.styleMarshal,o=e.getResponders,s=e.announce,i=e.autoScroller;return dae(Dtt,_rt(cZe(Qtt(n),xrt(t),Jtt(t),art,grt,vrt,jrt,wrt(i),lrt,yrt(r),prt(o,s))))},$E=function(){return{additions:{},removals:{},modified:{}}};function Srt(e){var t=e.registry,r=e.callbacks,n=$E(),o=null,s=function(){o||(r.collectionStarting(),o=requestAnimationFrame(function(){o=null;var u=n,f=u.additions,h=u.removals,m=u.modified,v=Object.keys(f).map(function(x){return t.draggable.getById(x).getDimension(di)}).sort(function(x,b){return x.descriptor.index-b.descriptor.index}),g=Object.keys(m).map(function(x){var b=t.droppable.getById(x),w=b.callbacks.getScrollWhileDragging();return{droppableId:x,scroll:w}}),y={additions:v,removals:Object.keys(h),modified:g};n=$E(),r.publish(y)}))},i=function(u){var f=u.descriptor.id;n.additions[f]=u,n.modified[u.descriptor.droppableId]=!0,n.removals[f]&&delete n.removals[f],s()},l=function(u){var f=u.descriptor;n.removals[f.id]=!0,n.modified[f.droppableId]=!0,n.additions[f.id]&&delete n.additions[f.id],s()},c=function(){o&&(cancelAnimationFrame(o),o=null,n=$E())};return{add:i,remove:l,stop:c}}var soe=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,o=e.width,s=Cc({x:r,y:t},{x:o,y:n}),i={x:Math.max(0,s.x),y:Math.max(0,s.y)};return i},ioe=function(){var e=document.documentElement;return e||sn(!1),e},loe=function(){var e=ioe(),t=soe({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight});return t},Crt=function(){var e=ooe(),t=loe(),r=e.y,n=e.x,o=ioe(),s=o.clientWidth,i=o.clientHeight,l=n+s,c=r+i,d=Zd({top:r,left:n,right:l,bottom:c}),u={frame:d,scroll:{initial:e,current:e,max:t,diff:{value:di,displacement:di}}};return u},Prt=function(e){var t=e.critical,r=e.scrollOptions,n=e.registry,o=Crt(),s=o.scroll.current,i=t.droppable,l=n.droppable.getAllByType(i.type).map(function(f){return f.callbacks.getDimensionAndWatchScroll(s,r)}),c=n.draggable.getAllByType(t.draggable.type).map(function(f){return f.getDimension(s)}),d={draggables:Lae(c),droppables:Rae(l)},u={dimensions:d,critical:t,viewport:o};return u};function gU(e,t,r){if(r.descriptor.id===t.id||r.descriptor.type!==t.type)return!1;var n=e.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var Art=function(e,t){var r=null,n=Srt({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),o=function(m,v){e.droppable.exists(m)||sn(!1),r&&t.updateDroppableIsEnabled({id:m,isEnabled:v})},s=function(m,v){r&&(e.droppable.exists(m)||sn(!1),t.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:v}))},i=function(m,v){r&&(e.droppable.exists(m)||sn(!1),t.updateDroppableScroll({id:m,newScroll:v}))},l=function(m,v){r&&e.droppable.getById(m).callbacks.scroll(v)},c=function(){if(r){n.stop();var m=r.critical.droppable;e.droppable.getAllByType(m.type).forEach(function(v){return v.callbacks.dragStopped()}),r.unsubscribe(),r=null}},d=function(m){r||sn(!1);var v=r.critical.draggable;m.type==="ADDITION"&&gU(e,v,m.value)&&n.add(m.value),m.type==="REMOVAL"&&gU(e,v,m.value)&&n.remove(m.value)},u=function(m){r&&sn(!1);var v=e.draggable.getById(m.draggableId),g=e.droppable.getById(v.descriptor.droppableId),y={draggable:v.descriptor,droppable:g.descriptor},x=e.subscribe(d);return r={critical:y,unsubscribe:x},Prt({critical:y,registry:e,scrollOptions:m.scrollOptions})},f={updateDroppableIsEnabled:o,updateDroppableIsCombineEnabled:s,scrollDroppable:l,updateDroppableScroll:i,startPublishing:u,stopPublishing:c};return f},coe=function(e,t){return e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP"},Ert=function(e){window.scrollBy(e.x,e.y)},krt=ci(function(e){return G5(e).filter(function(t){return!(!t.isEnabled||!t.frame)})}),Irt=function(t,r){var n=Vh(krt(r),function(o){return o.frame||sn(!1),Gae(o.frame.pageMarginBox)(t)});return n},Ort=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var o=n[r];return o.frame?o:null}var s=Irt(t,n);return s},xh={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(t){return Math.pow(t,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},Trt=function(e,t){var r=e[t.size]*xh.startFromPercentage,n=e[t.size]*xh.maxScrollAtPercentage,o={startScrollingFrom:r,maxScrollValueAt:n};return o},doe=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,o=r-t;if(o===0)return 0;var s=n-t,i=s/o;return i},_R=1,Drt=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return xh.maxPixelScroll;if(e===t.startScrollingFrom)return _R;var r=doe({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=1-r,o=xh.maxPixelScroll*xh.ease(n);return Math.ceil(o)},vU=xh.durationDampening.accelerateAt,xU=xh.durationDampening.stopDampeningAt,Mrt=function(e,t){var r=t,n=xU,o=Date.now(),s=o-r;if(s>=xU)return e;if(s<vU)return _R;var i=doe({startOfRange:vU,endOfRange:n,current:s}),l=e*xh.ease(i);return Math.ceil(l)},yU=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,o=e.shouldUseTimeDampening,s=Drt(t,r);return s===0?0:o?Math.max(Mrt(s,n),_R):s},bU=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,o=e.axis,s=e.shouldUseTimeDampening,i=Trt(t,o),l=r[o.end]<r[o.start];return l?yU({distanceToEdge:r[o.end],thresholds:i,dragStartTime:n,shouldUseTimeDampening:s}):-1*yU({distanceToEdge:r[o.start],thresholds:i,dragStartTime:n,shouldUseTimeDampening:s})},Rrt=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,o=r.height>t.height,s=r.width>t.width;return!s&&!o?n:s&&o?null:{x:s?0:n.x,y:o?0:n.y}},Lrt=Dae(function(e){return e===0?0:e}),uoe=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,o=e.center,s=e.shouldUseTimeDampening,i={top:o.y-r.top,right:r.right-o.x,bottom:r.bottom-o.y,left:o.x-r.left},l=bU({container:r,distanceToEdges:i,dragStartTime:t,axis:hR,shouldUseTimeDampening:s}),c=bU({container:r,distanceToEdges:i,dragStartTime:t,axis:Bae,shouldUseTimeDampening:s}),d=Lrt({x:c,y:l});if(vh(d,di))return null;var u=Rrt({container:r,subject:n,proposedScroll:d});return u?vh(u,di)?null:u:null},Frt=Dae(function(e){return e===0?0:e>0?1:-1}),NR=function(){var e=function(r,n){return r<0?r:r>n?r-n:0};return function(t){var r=t.current,n=t.max,o=t.change,s=Ai(r,o),i={x:e(s.x,n.x),y:e(s.y,n.y)};return vh(i,di)?null:i}}(),foe=function(t){var r=t.max,n=t.current,o=t.change,s={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},i=Frt(o),l=NR({max:s,current:n,change:i});return!l||i.x!==0&&l.x===0||i.y!==0&&l.y===0},SR=function(t,r){return foe({current:t.scroll.current,max:t.scroll.max,change:r})},$rt=function(t,r){if(!SR(t,r))return null;var n=t.scroll.max,o=t.scroll.current;return NR({current:o,max:n,change:r})},CR=function(t,r){var n=t.frame;return n?foe({current:n.scroll.current,max:n.scroll.max,change:r}):!1},Brt=function(t,r){var n=t.frame;return!n||!CR(t,r)?null:NR({current:n.scroll.current,max:n.scroll.max,change:r})},qrt=function(e){var t=e.viewport,r=e.subject,n=e.center,o=e.dragStartTime,s=e.shouldUseTimeDampening,i=uoe({dragStartTime:o,container:t.frame,subject:r,center:n,shouldUseTimeDampening:s});return i&&SR(t,i)?i:null},zrt=function(e){var t=e.droppable,r=e.subject,n=e.center,o=e.dragStartTime,s=e.shouldUseTimeDampening,i=t.frame;if(!i)return null;var l=uoe({dragStartTime:o,container:i.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:s});return l&&CR(t,l)?l:null},wU=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,o=e.scrollWindow,s=e.scrollDroppable,i=t.current.page.borderBoxCenter,l=t.dimensions.draggables[t.critical.draggable.id],c=l.page.marginBox;if(t.isWindowScrollAllowed){var d=t.viewport,u=qrt({dragStartTime:r,viewport:d,subject:c,center:i,shouldUseTimeDampening:n});if(u){o(u);return}}var f=Ort({center:i,destination:Dc(t.impact),droppables:t.dimensions.droppables});if(f){var h=zrt({dragStartTime:r,droppable:f,subject:c,center:i,shouldUseTimeDampening:n});h&&s(f.descriptor.id,h)}},Urt=function(e){var t=e.scrollWindow,r=e.scrollDroppable,n=Ww(t),o=Ww(r),s=null,i=function(u){s||sn(!1);var f=s,h=f.shouldUseTimeDampening,m=f.dragStartTime;wU({state:u,scrollWindow:n,scrollDroppable:o,dragStartTime:m,shouldUseTimeDampening:h})},l=function(u){s&&sn(!1);var f=Date.now(),h=!1,m=function(){h=!0};wU({state:u,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m}),s={dragStartTime:f,shouldUseTimeDampening:h},h&&i(u)},c=function(){s&&(n.cancel(),o.cancel(),s=null)};return{start:l,stop:c,scroll:i}},Vrt=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow,o=function(d,u){var f=Ai(d.current.client.selection,u);t({client:f})},s=function(d,u){if(!CR(d,u))return u;var f=Brt(d,u);if(!f)return r(d.descriptor.id,u),null;var h=Cc(u,f);r(d.descriptor.id,h);var m=Cc(u,h);return m},i=function(d,u,f){if(!d||!SR(u,f))return f;var h=$rt(u,f);if(!h)return n(f),null;var m=Cc(f,h);n(m);var v=Cc(f,m);return v},l=function(d){var u=d.scrollJumpRequest;if(u){var f=Dc(d.impact);f||sn(!1);var h=s(d.dimensions.droppables[f],u);if(h){var m=d.viewport,v=i(d.isWindowScrollAllowed,m,h);v&&o(d,v)}}};return l},Wrt=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,o=Urt({scrollWindow:r,scrollDroppable:t}),s=Vrt({move:n,scrollWindow:r,scrollDroppable:t}),i=function(d){if(d.phase==="DRAGGING"){if(d.movementMode==="FLUID"){o.scroll(d);return}d.scrollJumpRequest&&s(d)}},l={scroll:i,start:o.start,stop:o.stop};return l},e0="data-rbd",t0=function(){var e=e0+"-drag-handle";return{base:e,draggableId:e+"-draggable-id",contextId:e+"-context-id"}}(),GT=function(){var e=e0+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Hrt=function(){var e=e0+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),jU={contextId:e0+"-scroll-container-context-id"},Grt=function(t){return function(r){return"["+r+'="'+t+'"]'}},gy=function(t,r){return t.map(function(n){var o=n.styles[r];return o?n.selector+" { "+o+" }":""}).join(" ")},Krt="pointer-events: none;",Xrt=function(e){var t=Grt(e),r=function(){var l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(t0.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:Krt,dropAnimating:l}}}(),n=function(){var l=`
      transition: `+xb.outOfTheWay+`;
    `;return{selector:t(GT.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}}(),o={selector:t(Hrt.contextId),styles:{always:"overflow-anchor: none;"}},s={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},i=[n,r,o,s];return{always:gy(i,"always"),resting:gy(i,"resting"),dragging:gy(i,"dragging"),dropAnimating:gy(i,"dropAnimating"),userCancel:gy(i,"userCancel")}},Mc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,BE=function(){var t=document.querySelector("head");return t||sn(!1),t},_U=function(t){var r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.type="text/css",r};function Yrt(e,t){var r=Xa(function(){return Xrt(e)},[e]),n=p.useRef(null),o=p.useRef(null),s=Yn(ci(function(f){var h=o.current;h||sn(!1),h.textContent=f}),[]),i=Yn(function(f){var h=n.current;h||sn(!1),h.textContent=f},[]);Mc(function(){!n.current&&!o.current||sn(!1);var f=_U(t),h=_U(t);return n.current=f,o.current=h,f.setAttribute(e0+"-always",e),h.setAttribute(e0+"-dynamic",e),BE().appendChild(f),BE().appendChild(h),i(r.always),s(r.resting),function(){var m=function(g){var y=g.current;y||sn(!1),BE().removeChild(y),g.current=null};m(n),m(o)}},[t,i,s,r.always,r.resting,e]);var l=Yn(function(){return s(r.dragging)},[s,r.dragging]),c=Yn(function(f){if(f==="DROP"){s(r.dropAnimating);return}s(r.userCancel)},[s,r.dropAnimating,r.userCancel]),d=Yn(function(){o.current&&s(r.resting)},[s,r.resting]),u=Xa(function(){return{dragging:l,dropping:c,resting:d}},[l,c,d]);return u}var moe=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function J5(e){return e instanceof moe(e).HTMLElement}function Jrt(e,t){var r="["+t0.contextId+'="'+e+'"]',n=Mae(document.querySelectorAll(r));if(!n.length)return null;var o=Vh(n,function(s){return s.getAttribute(t0.draggableId)===t});return!o||!J5(o)?null:o}function Qrt(e){var t=p.useRef({}),r=p.useRef(null),n=p.useRef(null),o=p.useRef(!1),s=Yn(function(h,m){var v={id:h,focus:m};return t.current[h]=v,function(){var y=t.current,x=y[h];x!==v&&delete y[h]}},[]),i=Yn(function(h){var m=Jrt(e,h);m&&m!==document.activeElement&&m.focus()},[e]),l=Yn(function(h,m){r.current===h&&(r.current=m)},[]),c=Yn(function(){n.current||o.current&&(n.current=requestAnimationFrame(function(){n.current=null;var h=r.current;h&&i(h)}))},[i]),d=Yn(function(h){r.current=null;var m=document.activeElement;m&&m.getAttribute(t0.draggableId)===h&&(r.current=h)},[]);Mc(function(){return o.current=!0,function(){o.current=!1;var h=n.current;h&&cancelAnimationFrame(h)}},[]);var u=Xa(function(){return{register:s,tryRecordFocus:d,tryRestoreFocusRecorded:c,tryShiftRecord:l}},[s,d,c,l]);return u}function Zrt(){var e={draggables:{},droppables:{}},t=[];function r(f){return t.push(f),function(){var m=t.indexOf(f);m!==-1&&t.splice(m,1)}}function n(f){t.length&&t.forEach(function(h){return h(f)})}function o(f){return e.draggables[f]||null}function s(f){var h=o(f);return h||sn(!1),h}var i={register:function(h){e.draggables[h.descriptor.id]=h,n({type:"ADDITION",value:h})},update:function(h,m){var v=e.draggables[m.descriptor.id];v&&v.uniqueId===h.uniqueId&&(delete e.draggables[m.descriptor.id],e.draggables[h.descriptor.id]=h)},unregister:function(h){var m=h.descriptor.id,v=o(m);v&&h.uniqueId===v.uniqueId&&(delete e.draggables[m],n({type:"REMOVAL",value:h}))},getById:s,findById:o,exists:function(h){return!!o(h)},getAllByType:function(h){return wS(e.draggables).filter(function(m){return m.descriptor.type===h})}};function l(f){return e.droppables[f]||null}function c(f){var h=l(f);return h||sn(!1),h}var d={register:function(h){e.droppables[h.descriptor.id]=h},unregister:function(h){var m=l(h.descriptor.id);m&&h.uniqueId===m.uniqueId&&delete e.droppables[h.descriptor.id]},getById:c,findById:l,exists:function(h){return!!l(h)},getAllByType:function(h){return wS(e.droppables).filter(function(m){return m.descriptor.type===h})}};function u(){e.draggables={},e.droppables={},t.length=0}return{draggable:i,droppable:d,subscribe:r,clean:u}}function ent(){var e=Xa(Zrt,[]);return p.useEffect(function(){return function(){requestAnimationFrame(e.clean)}},[e]),e}var PR=_e.createContext(null),_S=function(){var e=document.body;return e||sn(!1),e},tnt={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},rnt=function(t){return"rbd-announcement-"+t};function nnt(e){var t=Xa(function(){return rnt(e)},[e]),r=p.useRef(null);p.useEffect(function(){var s=document.createElement("div");return r.current=s,s.id=t,s.setAttribute("aria-live","assertive"),s.setAttribute("aria-atomic","true"),ea(s.style,tnt),_S().appendChild(s),function(){setTimeout(function(){var c=_S();c.contains(s)&&c.removeChild(s),s===r.current&&(r.current=null)})}},[t]);var n=Yn(function(o){var s=r.current;if(s){s.textContent=o;return}},[]);return n}var ant=0,ont={separator:"::"};function AR(e,t){return t===void 0&&(t=ont),Xa(function(){return""+e+t.separator+ant++},[t.separator,e])}function snt(e){var t=e.contextId,r=e.uniqueId;return"rbd-hidden-text-"+t+"-"+r}function int(e){var t=e.contextId,r=e.text,n=AR("hidden-text",{separator:"-"}),o=Xa(function(){return snt({contextId:t,uniqueId:n})},[n,t]);return p.useEffect(function(){var i=document.createElement("div");return i.id=o,i.textContent=r,i.style.display="none",_S().appendChild(i),function(){var c=_S();c.contains(i)&&c.removeChild(i)}},[o,r]),o}var Q5=_e.createContext(null);function hoe(e){var t=p.useRef(e);return p.useEffect(function(){t.current=e}),t}function lnt(){var e=null;function t(){return!!e}function r(i){return i===e}function n(i){e&&sn(!1);var l={abandon:i};return e=l,l}function o(){e||sn(!1),e=null}function s(){e&&(e.abandon(),o())}return{isClaimed:t,isActive:r,claim:n,release:o,tryAbandon:s}}var cnt=9,dnt=13,ER=27,poe=32,unt=33,fnt=34,mnt=35,hnt=36,pnt=37,gnt=38,vnt=39,xnt=40,gj,ynt=(gj={},gj[dnt]=!0,gj[cnt]=!0,gj),goe=function(e){ynt[e.keyCode]&&e.preventDefault()},Z5=function(){var e="visibilitychange";if(typeof document>"u")return e;var t=[e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],r=Vh(t,function(n){return"on"+n in document});return r||e}(),voe=0,NU=5;function bnt(e,t){return Math.abs(t.x-e.x)>=NU||Math.abs(t.y-e.y)>=NU}var SU={type:"IDLE"};function wnt(e){var t=e.cancel,r=e.completed,n=e.getPhase,o=e.setPhase;return[{eventName:"mousemove",fn:function(i){var l=i.button,c=i.clientX,d=i.clientY;if(l===voe){var u={x:c,y:d},f=n();if(f.type==="DRAGGING"){i.preventDefault(),f.actions.move(u);return}f.type!=="PENDING"&&sn(!1);var h=f.point;if(bnt(h,u)){i.preventDefault();var m=f.actions.fluidLift(u);o({type:"DRAGGING",actions:m})}}}},{eventName:"mouseup",fn:function(i){var l=n();if(l.type!=="DRAGGING"){t();return}i.preventDefault(),l.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(i){n().type==="DRAGGING"&&i.preventDefault(),t()}},{eventName:"keydown",fn:function(i){var l=n();if(l.type==="PENDING"){t();return}if(i.keyCode===ER){i.preventDefault(),t();return}goe(i)}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&t()}},{eventName:"webkitmouseforcedown",fn:function(i){var l=n();if(l.type==="IDLE"&&sn(!1),l.actions.shouldRespectForcePress()){t();return}i.preventDefault()}},{eventName:Z5,fn:t}]}function jnt(e){var t=p.useRef(SU),r=p.useRef(gh),n=Xa(function(){return{eventName:"mousedown",fn:function(f){if(!f.defaultPrevented&&f.button===voe&&!(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)){var h=e.findClosestDraggableId(f);if(h){var m=e.tryGetLock(h,i,{sourceEvent:f});if(m){f.preventDefault();var v={x:f.clientX,y:f.clientY};r.current(),d(m,v)}}}}}},[e]),o=Xa(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(f){if(!f.defaultPrevented){var h=e.findClosestDraggableId(f);if(h){var m=e.findOptionsForDraggable(h);m&&(m.shouldRespectForcePress||e.canGetLock(h)&&f.preventDefault())}}}}},[e]),s=Yn(function(){var f={passive:!1,capture:!0};r.current=pd(window,[o,n],f)},[o,n]),i=Yn(function(){var u=t.current;u.type!=="IDLE"&&(t.current=SU,r.current(),s())},[s]),l=Yn(function(){var u=t.current;i(),u.type==="DRAGGING"&&u.actions.cancel({shouldBlockNextClick:!0}),u.type==="PENDING"&&u.actions.abort()},[i]),c=Yn(function(){var f={capture:!0,passive:!1},h=wnt({cancel:l,completed:i,getPhase:function(){return t.current},setPhase:function(v){t.current=v}});r.current=pd(window,h,f)},[l,i]),d=Yn(function(f,h){t.current.type!=="IDLE"&&sn(!1),t.current={type:"PENDING",point:h,actions:f},c()},[c]);Mc(function(){return s(),function(){r.current()}},[s])}var ov;function _nt(){}var Nnt=(ov={},ov[fnt]=!0,ov[unt]=!0,ov[hnt]=!0,ov[mnt]=!0,ov);function Snt(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:function(s){if(s.keyCode===ER){s.preventDefault(),r();return}if(s.keyCode===poe){s.preventDefault(),n();return}if(s.keyCode===xnt){s.preventDefault(),e.moveDown();return}if(s.keyCode===gnt){s.preventDefault(),e.moveUp();return}if(s.keyCode===vnt){s.preventDefault(),e.moveRight();return}if(s.keyCode===pnt){s.preventDefault(),e.moveLeft();return}if(Nnt[s.keyCode]){s.preventDefault();return}goe(s)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:Z5,fn:r}]}function Cnt(e){var t=p.useRef(_nt),r=Xa(function(){return{eventName:"keydown",fn:function(s){if(s.defaultPrevented||s.keyCode!==poe)return;var i=e.findClosestDraggableId(s);if(!i)return;var l=e.tryGetLock(i,u,{sourceEvent:s});if(!l)return;s.preventDefault();var c=!0,d=l.snapLift();t.current();function u(){c||sn(!1),c=!1,t.current(),n()}t.current=pd(window,Snt(d,u),{capture:!0,passive:!1})}}},[e]),n=Yn(function(){var s={passive:!1,capture:!0};t.current=pd(window,[r],s)},[r]);Mc(function(){return n(),function(){t.current()}},[n])}var qE={type:"IDLE"},Pnt=120,Ant=.15;function Ent(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(o){o.preventDefault()}},{eventName:"keydown",fn:function(o){if(r().type!=="DRAGGING"){t();return}o.keyCode===ER&&o.preventDefault(),t()}},{eventName:Z5,fn:t}]}function knt(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(s){var i=n();if(i.type!=="DRAGGING"){t();return}i.hasMoved=!0;var l=s.touches[0],c=l.clientX,d=l.clientY,u={x:c,y:d};s.preventDefault(),i.actions.move(u)}},{eventName:"touchend",fn:function(s){var i=n();if(i.type!=="DRAGGING"){t();return}s.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(s){if(n().type!=="DRAGGING"){t();return}s.preventDefault(),t()}},{eventName:"touchforcechange",fn:function(s){var i=n();i.type==="IDLE"&&sn(!1);var l=s.touches[0];if(l){var c=l.force>=Ant;if(c){var d=i.actions.shouldRespectForcePress();if(i.type==="PENDING"){d&&t();return}if(d){if(i.hasMoved){s.preventDefault();return}t();return}s.preventDefault()}}}},{eventName:Z5,fn:t}]}function Int(e){var t=p.useRef(qE),r=p.useRef(gh),n=Yn(function(){return t.current},[]),o=Yn(function(m){t.current=m},[]),s=Xa(function(){return{eventName:"touchstart",fn:function(m){if(!m.defaultPrevented){var v=e.findClosestDraggableId(m);if(v){var g=e.tryGetLock(v,l,{sourceEvent:m});if(g){var y=m.touches[0],x=y.clientX,b=y.clientY,w={x,y:b};r.current(),f(g,w)}}}}}},[e]),i=Yn(function(){var m={capture:!0,passive:!1};r.current=pd(window,[s],m)},[s]),l=Yn(function(){var h=t.current;h.type!=="IDLE"&&(h.type==="PENDING"&&clearTimeout(h.longPressTimerId),o(qE),r.current(),i())},[i,o]),c=Yn(function(){var h=t.current;l(),h.type==="DRAGGING"&&h.actions.cancel({shouldBlockNextClick:!0}),h.type==="PENDING"&&h.actions.abort()},[l]),d=Yn(function(){var m={capture:!0,passive:!1},v={cancel:c,completed:l,getPhase:n},g=pd(window,knt(v),m),y=pd(window,Ent(v),m);r.current=function(){g(),y()}},[c,n,l]),u=Yn(function(){var m=n();m.type!=="PENDING"&&sn(!1);var v=m.actions.fluidLift(m.point);o({type:"DRAGGING",actions:v,hasMoved:!1})},[n,o]),f=Yn(function(m,v){n().type!=="IDLE"&&sn(!1);var g=setTimeout(u,Pnt);o({type:"PENDING",point:v,actions:m,longPressTimerId:g}),d()},[d,n,o,u]);Mc(function(){return i(),function(){r.current();var v=n();v.type==="PENDING"&&(clearTimeout(v.longPressTimerId),o(qE))}},[n,i,o]),Mc(function(){var m=pd(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return m},[])}var Ont={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function xoe(e,t){if(t==null)return!1;var r=!!Ont[t.tagName.toLowerCase()];if(r)return!0;var n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:xoe(e,t.parentElement)}function Tnt(e,t){var r=t.target;return J5(r)?xoe(e,r):!1}var Dnt=function(e){return Zd(e.getBoundingClientRect()).center};function Mnt(e){return e instanceof moe(e).Element}var Rnt=function(){var e="matches";if(typeof document>"u")return e;var t=[e,"msMatchesSelector","webkitMatchesSelector"],r=Vh(t,function(n){return n in Element.prototype});return r||e}();function yoe(e,t){return e==null?null:e[Rnt](t)?e:yoe(e.parentElement,t)}function Lnt(e,t){return e.closest?e.closest(t):yoe(e,t)}function Fnt(e){return"["+t0.contextId+'="'+e+'"]'}function $nt(e,t){var r=t.target;if(!Mnt(r))return null;var n=Fnt(e),o=Lnt(r,n);return!o||!J5(o)?null:o}function Bnt(e,t){var r=$nt(e,t);return r?r.getAttribute(t0.draggableId):null}function qnt(e,t){var r="["+GT.contextId+'="'+e+'"]',n=Mae(document.querySelectorAll(r)),o=Vh(n,function(s){return s.getAttribute(GT.id)===t});return!o||!J5(o)?null:o}function znt(e){e.preventDefault()}function vj(e){var t=e.expected,r=e.phase,n=e.isLockActive;return e.shouldWarn,!(!n()||t!==r)}function boe(e){var t=e.lockAPI,r=e.store,n=e.registry,o=e.draggableId;if(t.isClaimed())return!1;var s=n.draggable.findById(o);return!(!s||!s.options.isEnabled||!coe(r.getState(),o))}function Unt(e){var t=e.lockAPI,r=e.contextId,n=e.store,o=e.registry,s=e.draggableId,i=e.forceSensorStop,l=e.sourceEvent,c=boe({lockAPI:t,store:n,registry:o,draggableId:s});if(!c)return null;var d=o.draggable.getById(s),u=qnt(r,d.descriptor.id);if(!u||l&&!d.options.canDragInteractiveElements&&Tnt(u,l))return null;var f=t.claim(i||gh),h="PRE_DRAG";function m(){return d.options.shouldRespectForcePress}function v(){return t.isActive(f)}function g(C,E){vj({expected:C,phase:h,isLockActive:v,shouldWarn:!0})&&n.dispatch(E())}var y=g.bind(null,"DRAGGING");function x(C){function E(){t.release(),h="COMPLETED"}h!=="PRE_DRAG"&&(E(),h!=="PRE_DRAG"&&sn(!1)),n.dispatch(Rtt(C.liftActionArgs)),h="DRAGGING";function A(P,F){if(F===void 0&&(F={shouldBlockNextClick:!1}),C.cleanup(),F.shouldBlockNextClick){var M=pd(window,[{eventName:"click",fn:znt,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(M)}E(),n.dispatch(roe({reason:P}))}return ea({isActive:function(){return vj({expected:"DRAGGING",phase:h,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:m,drop:function(F){return A("DROP",F)},cancel:function(F){return A("CANCEL",F)}},C.actions)}function b(C){var E=Ww(function(P){y(function(){return toe({client:P})})}),A=x({liftActionArgs:{id:s,clientSelection:C,movementMode:"FLUID"},cleanup:function(){return E.cancel()},actions:{move:E}});return ea({},A,{move:E})}function w(){var C={moveUp:function(){return y(Wtt)},moveRight:function(){return y(Gtt)},moveDown:function(){return y(Htt)},moveLeft:function(){return y(Ktt)}};return x({liftActionArgs:{id:s,clientSelection:Dnt(u),movementMode:"SNAP"},cleanup:gh,actions:C})}function j(){var C=vj({expected:"PRE_DRAG",phase:h,isLockActive:v,shouldWarn:!0});C&&t.release()}var _={isActive:function(){return vj({expected:"PRE_DRAG",phase:h,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:m,fluidLift:b,snapLift:w,abort:j};return _}var Vnt=[jnt,Cnt,Int];function Wnt(e){var t=e.contextId,r=e.store,n=e.registry,o=e.customSensors,s=e.enableDefaultSensors,i=[].concat(s?Vnt:[],o||[]),l=p.useState(function(){return lnt()})[0],c=Yn(function(b,w){b.isDragging&&!w.isDragging&&l.tryAbandon()},[l]);Mc(function(){var b=r.getState(),w=r.subscribe(function(){var j=r.getState();c(b,j),b=j});return w},[l,r,c]),Mc(function(){return l.tryAbandon},[l.tryAbandon]);for(var d=Yn(function(x){return boe({lockAPI:l,registry:n,store:r,draggableId:x})},[l,n,r]),u=Yn(function(x,b,w){return Unt({lockAPI:l,registry:n,contextId:t,store:r,draggableId:x,forceSensorStop:b,sourceEvent:w&&w.sourceEvent?w.sourceEvent:null})},[t,l,n,r]),f=Yn(function(x){return Bnt(t,x)},[t]),h=Yn(function(x){var b=n.draggable.findById(x);return b?b.options:null},[n.draggable]),m=Yn(function(){l.isClaimed()&&(l.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(yR()))},[l,r]),v=Yn(l.isClaimed,[l]),g=Xa(function(){return{canGetLock:d,tryGetLock:u,findClosestDraggableId:f,findOptionsForDraggable:h,tryReleaseLock:m,isLockClaimed:v}},[d,u,f,h,m,v]),y=0;y<i.length;y++)i[y](g)}var Hnt=function(t){return{onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}};function vy(e){return e.current||sn(!1),e.current}function Gnt(e){var t=e.contextId,r=e.setCallbacks,n=e.sensors,o=e.nonce,s=e.dragHandleUsageInstructions,i=p.useRef(null),l=hoe(e),c=Yn(function(){return Hnt(l.current)},[l]),d=nnt(t),u=int({contextId:t,text:s}),f=Yrt(t,o),h=Yn(function(P){vy(i).dispatch(P)},[]),m=Xa(function(){return K9({publishWhileDragging:Ftt,updateDroppableScroll:Btt,updateDroppableIsEnabled:qtt,updateDroppableIsCombineEnabled:ztt,collectionStarting:$tt},h)},[h]),v=ent(),g=Xa(function(){return Art(v,m)},[v,m]),y=Xa(function(){return Wrt(ea({scrollWindow:Ert,scrollDroppable:g.scrollDroppable},K9({move:toe},h)))},[g.scrollDroppable,h]),x=Qrt(t),b=Xa(function(){return Nrt({announce:d,autoScroller:y,dimensionMarshal:g,focusMarshal:x,getResponders:c,styleMarshal:f})},[d,y,g,x,c,f]);i.current=b;var w=Yn(function(){var P=vy(i),F=P.getState();F.phase!=="IDLE"&&P.dispatch(yR())},[]),j=Yn(function(){var P=vy(i).getState();return P.isDragging||P.phase==="DROP_ANIMATING"},[]),_=Xa(function(){return{isDragging:j,tryAbort:w}},[j,w]);r(_);var C=Yn(function(P){return coe(vy(i).getState(),P)},[]),E=Yn(function(){return mp(vy(i).getState())},[]),A=Xa(function(){return{marshal:g,focus:x,contextId:t,canLift:C,isMovementAllowed:E,dragHandleUsageInstructionsId:u,registry:v}},[t,g,u,x,C,E,v]);return Wnt({contextId:t,store:b,registry:v,customSensors:n,enableDefaultSensors:e.enableDefaultSensors!==!1}),p.useEffect(function(){return w},[w]),_e.createElement(Q5.Provider,{value:A},_e.createElement(hZe,{context:PR,store:b},e.children))}var Knt=0;function Xnt(){return Xa(function(){return""+Knt++},[])}function Ynt(e){var t=Xnt(),r=e.dragHandleUsageInstructions||t_.dragHandleUsageInstructions;return _e.createElement(Cet,null,function(n){return _e.createElement(Gnt,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)})}var woe=function(t){return function(r){return t===r}},Jnt=woe("scroll"),Qnt=woe("auto"),CU=function(t,r){return r(t.overflowX)||r(t.overflowY)},Znt=function(t){var r=window.getComputedStyle(t),n={overflowX:r.overflowX,overflowY:r.overflowY};return CU(n,Jnt)||CU(n,Qnt)},eat=function(){return!1},tat=function e(t){return t==null?null:t===document.body?eat()?t:null:t===document.documentElement?null:Znt(t)?t:e(t.parentElement)},KT=function(e){return{x:e.scrollLeft,y:e.scrollTop}},rat=function e(t){if(!t)return!1;var r=window.getComputedStyle(t);return r.position==="fixed"?!0:e(t.parentElement)},nat=function(e){var t=tat(e),r=rat(e);return{closestScrollable:t,isFixedOnPage:r}},aat=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,o=e.isFixedOnPage,s=e.direction,i=e.client,l=e.page,c=e.closest,d=function(){if(!c)return null;var m=c.scrollSize,v=c.client,g=soe({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:v.paddingBox.height,width:v.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:v,scrollSize:m,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:g,diff:{value:di,displacement:di}}}}(),u=s==="vertical"?hR:Bae,f=Zx({page:l,withPlaceholder:null,axis:u,frame:d}),h={descriptor:t,isCombineEnabled:n,isFixedOnPage:o,axis:u,isEnabled:r,client:i,page:l,frame:d,subject:f};return h},oat=function(t,r){var n=kae(t);if(!r||t!==r)return n;var o=n.paddingBox.top-r.scrollTop,s=n.paddingBox.left-r.scrollLeft,i=o+r.scrollHeight,l=s+r.scrollWidth,c={top:o,right:l,bottom:i,left:s},d=cR(c,n.border),u=dR({borderBox:d,margin:n.margin,border:n.border,padding:n.padding});return u},sat=function(e){var t=e.ref,r=e.descriptor,n=e.env,o=e.windowScroll,s=e.direction,i=e.isDropDisabled,l=e.isCombineEnabled,c=e.shouldClipSubject,d=n.closestScrollable,u=oat(t,d),f=xS(u,o),h=function(){if(!d)return null;var v=kae(d),g={scrollHeight:d.scrollHeight,scrollWidth:d.scrollWidth};return{client:v,page:xS(v,o),scroll:KT(d),scrollSize:g,shouldClipSubject:c}}(),m=aat({descriptor:r,isEnabled:!i,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:s,client:u,page:f,closest:h});return m},iat={passive:!1},lat={passive:!0},PU=function(e){return e.shouldPublishImmediately?iat:lat};function NS(e){var t=p.useContext(e);return t||sn(!1),t}var xj=function(t){return t&&t.env.closestScrollable||null};function cat(e){var t=p.useRef(null),r=NS(Q5),n=AR("droppable"),o=r.registry,s=r.marshal,i=hoe(e),l=Xa(function(){return{id:e.droppableId,type:e.type,mode:e.mode}},[e.droppableId,e.mode,e.type]),c=p.useRef(l),d=Xa(function(){return ci(function(j,_){t.current||sn(!1);var C={x:j,y:_};s.updateDroppableScroll(l.id,C)})},[l.id,s]),u=Yn(function(){var j=t.current;return!j||!j.env.closestScrollable?di:KT(j.env.closestScrollable)},[]),f=Yn(function(){var j=u();d(j.x,j.y)},[u,d]),h=Xa(function(){return Ww(f)},[f]),m=Yn(function(){var j=t.current,_=xj(j);j&&_||sn(!1);var C=j.scrollOptions;if(C.shouldPublishImmediately){f();return}h()},[h,f]),v=Yn(function(j,_){t.current&&sn(!1);var C=i.current,E=C.getDroppableRef();E||sn(!1);var A=nat(E),P={ref:E,descriptor:l,env:A,scrollOptions:_};t.current=P;var F=sat({ref:E,descriptor:l,env:A,windowScroll:j,direction:C.direction,isDropDisabled:C.isDropDisabled,isCombineEnabled:C.isCombineEnabled,shouldClipSubject:!C.ignoreContainerClipping}),M=A.closestScrollable;return M&&(M.setAttribute(jU.contextId,r.contextId),M.addEventListener("scroll",m,PU(P.scrollOptions))),F},[r.contextId,l,m,i]),g=Yn(function(){var j=t.current,_=xj(j);return j&&_||sn(!1),KT(_)},[]),y=Yn(function(){var j=t.current;j||sn(!1);var _=xj(j);t.current=null,_&&(h.cancel(),_.removeAttribute(jU.contextId),_.removeEventListener("scroll",m,PU(j.scrollOptions)))},[m,h]),x=Yn(function(j){var _=t.current;_||sn(!1);var C=xj(_);C||sn(!1),C.scrollTop+=j.y,C.scrollLeft+=j.x},[]),b=Xa(function(){return{getDimensionAndWatchScroll:v,getScrollWhileDragging:g,dragStopped:y,scroll:x}},[y,v,g,x]),w=Xa(function(){return{uniqueId:n,descriptor:l,callbacks:b}},[b,l,n]);Mc(function(){return c.current=w.descriptor,o.droppable.register(w),function(){t.current&&y(),o.droppable.unregister(w)}},[b,l,y,w,s,o.droppable]),Mc(function(){t.current&&s.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,s]),Mc(function(){t.current&&s.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,s])}function zE(){}var AU={width:0,height:0,margin:Oet},dat=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,o=t.animate;return r||o==="close"?AU:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},uat=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,o=t.animate,s=dat({isAnimatingOpenOnMount:r,placeholder:n,animate:o});return{display:n.display,boxSizing:"border-box",width:s.width,height:s.height,marginTop:s.margin.top,marginRight:s.margin.right,marginBottom:s.margin.bottom,marginLeft:s.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:o!=="none"?xb.placeholder:null}};function fat(e){var t=p.useRef(null),r=Yn(function(){t.current&&(clearTimeout(t.current),t.current=null)},[]),n=e.animate,o=e.onTransitionEnd,s=e.onClose,i=e.contextId,l=p.useState(e.animate==="open"),c=l[0],d=l[1];p.useEffect(function(){return c?n!=="open"?(r(),d(!1),zE):t.current?zE:(t.current=setTimeout(function(){t.current=null,d(!1)}),r):zE},[n,c,r]);var u=Yn(function(h){h.propertyName==="height"&&(o(),n==="close"&&s())},[n,s,o]),f=uat({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return _e.createElement(e.placeholder.tagName,{style:f,"data-rbd-placeholder-context-id":i,onTransitionEnd:u,ref:e.innerRef})}var mat=_e.memo(fat),kR=_e.createContext(null),hat=function(e){EQ(t,e);function t(){for(var n,o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return n=e.call.apply(e,[this].concat(s))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}t.getDerivedStateFromProps=function(o,s){return o.shouldAnimate?o.on?{isVisible:!0,data:o.on,animate:"open"}:s.isVisible?{isVisible:!0,data:s.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!o.on,data:o.on,animate:"none"}};var r=t.prototype;return r.render=function(){if(!this.state.isVisible)return null;var o={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(o)},t}(_e.PureComponent),EU={dragging:5e3,dropAnimating:4500},pat=function(t,r){return r?xb.drop(r.duration):t?xb.snap:xb.fluid},gat=function(t,r){return t?r?Xw.opacity.drop:Xw.opacity.combining:null},vat=function(t){return t.forceShouldAnimate!=null?t.forceShouldAnimate:t.mode==="SNAP"};function xat(e){var t=e.dimension,r=t.client,n=e.offset,o=e.combineWith,s=e.dropping,i=!!o,l=vat(e),c=!!s,d=c?WT.drop(n,i):WT.moveTo(n),u={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:pat(l,s),transform:d,opacity:gat(i,c),zIndex:c?EU.dropAnimating:EU.dragging,pointerEvents:"none"};return u}function yat(e){return{transform:WT.moveTo(e.offset),transition:e.shouldAnimateDisplacement?null:"none"}}function bat(e){return e.type==="DRAGGING"?xat(e):yat(e)}function wat(e,t,r){r===void 0&&(r=di);var n=window.getComputedStyle(t),o=t.getBoundingClientRect(),s=Eae(o,n),i=xS(s,r),l={client:s,tagName:t.tagName.toLowerCase(),display:n.display},c={x:s.marginBox.width,y:s.marginBox.height},d={descriptor:e,placeholder:l,displaceBy:c,client:s,page:i};return d}function jat(e){var t=AR("draggable"),r=e.descriptor,n=e.registry,o=e.getDraggableRef,s=e.canDragInteractiveElements,i=e.shouldRespectForcePress,l=e.isEnabled,c=Xa(function(){return{canDragInteractiveElements:s,shouldRespectForcePress:i,isEnabled:l}},[s,l,i]),d=Yn(function(m){var v=o();return v||sn(!1),wat(r,v,m)},[r,o]),u=Xa(function(){return{uniqueId:t,descriptor:r,options:c,getDimension:d}},[r,d,c,t]),f=p.useRef(u),h=p.useRef(!0);Mc(function(){return n.draggable.register(f.current),function(){return n.draggable.unregister(f.current)}},[n.draggable]),Mc(function(){if(h.current){h.current=!1;return}var m=f.current;f.current=u,n.draggable.update(u,m)},[u,n.draggable])}function _at(e){e.preventDefault()}function Nat(e){var t=p.useRef(null),r=Yn(function(P){t.current=P},[]),n=Yn(function(){return t.current},[]),o=NS(Q5),s=o.contextId,i=o.dragHandleUsageInstructionsId,l=o.registry,c=NS(kR),d=c.type,u=c.droppableId,f=Xa(function(){return{id:e.draggableId,index:e.index,type:d,droppableId:u}},[e.draggableId,e.index,d,u]),h=e.children,m=e.draggableId,v=e.isEnabled,g=e.shouldRespectForcePress,y=e.canDragInteractiveElements,x=e.isClone,b=e.mapped,w=e.dropAnimationFinished;if(!x){var j=Xa(function(){return{descriptor:f,registry:l,getDraggableRef:n,canDragInteractiveElements:y,shouldRespectForcePress:g,isEnabled:v}},[f,l,n,y,g,v]);jat(j)}var _=Xa(function(){return v?{tabIndex:0,role:"button","aria-describedby":i,"data-rbd-drag-handle-draggable-id":m,"data-rbd-drag-handle-context-id":s,draggable:!1,onDragStart:_at}:null},[s,i,m,v]),C=Yn(function(P){b.type==="DRAGGING"&&b.dropping&&P.propertyName==="transform"&&w()},[w,b]),E=Xa(function(){var P=bat(b),F=b.type==="DRAGGING"&&b.dropping?C:null,M={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":s,"data-rbd-draggable-id":m,style:P,onTransitionEnd:F},dragHandleProps:_};return M},[s,_,m,b,C,r]),A=Xa(function(){return{draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}},[f.droppableId,f.id,f.index,f.type]);return h(E,b.snapshot,A)}var joe=function(e,t){return e===t},_oe=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null},Sat=function(t){return t.combine?t.combine.draggableId:null},Cat=function(t){return t.at&&t.at.type==="COMBINE"?t.at.combine.draggableId:null};function Pat(){var e=ci(function(o,s){return{x:o,y:s}}),t=ci(function(o,s,i,l,c){return{isDragging:!0,isClone:s,isDropAnimating:!!c,dropAnimation:c,mode:o,draggingOver:i,combineWith:l,combineTargetFor:null}}),r=ci(function(o,s,i,l,c,d,u){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:d,mode:s,offset:o,dimension:i,forceShouldAnimate:u,snapshot:t(s,l,c,d,null)}}}),n=function(s,i){if(s.isDragging){if(s.critical.draggable.id!==i.draggableId)return null;var l=s.current.client.offset,c=s.dimensions.draggables[i.draggableId],d=Dc(s.impact),u=Cat(s.impact),f=s.forceShouldAnimate;return r(e(l.x,l.y),s.movementMode,c,i.isClone,d,u,f)}if(s.phase==="DROP_ANIMATING"){var h=s.completed;if(h.result.draggableId!==i.draggableId)return null;var m=i.isClone,v=s.dimensions.draggables[i.draggableId],g=h.result,y=g.mode,x=_oe(g),b=Sat(g),w=s.dropDuration,j={duration:w,curve:wR.drop,moveTo:s.newHomeClientOffset,opacity:b?Xw.opacity.drop:null,scale:b?Xw.scale.drop:null};return{mapped:{type:"DRAGGING",offset:s.newHomeClientOffset,dimension:v,dropping:j,draggingOver:x,combineWith:b,mode:y,forceShouldAnimate:null,snapshot:t(y,m,x,b,j)}}}return null};return n}function Noe(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var Aat={mapped:{type:"SECONDARY",offset:di,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:Noe(null)}};function Eat(){var e=ci(function(i,l){return{x:i,y:l}}),t=ci(Noe),r=ci(function(i,l,c){return l===void 0&&(l=null),{mapped:{type:"SECONDARY",offset:i,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:t(l)}}}),n=function(l){return l?r(di,l,!0):null},o=function(l,c,d,u){var f=d.displaced.visible[l],h=!!(u.inVirtualList&&u.effected[l]),m=K5(d),v=m&&m.draggableId===l?c:null;if(!f){if(!h)return n(v);if(d.displaced.invisible[l])return null;var g=T0(u.displacedBy.point),y=e(g.x,g.y);return r(y,v,!0)}if(h)return n(v);var x=d.displacedBy.point,b=e(x.x,x.y);return r(b,v,f.shouldAnimate)},s=function(l,c){if(l.isDragging)return l.critical.draggable.id===c.draggableId?null:o(c.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){var d=l.completed;return d.result.draggableId===c.draggableId?null:o(c.draggableId,d.result.draggableId,d.impact,d.afterCritical)}return null};return s}var kat=function(){var t=Pat(),r=Eat(),n=function(s,i){return t(s,i)||r(s,i)||Aat};return n},Iat={dropAnimationFinished:noe},Oat=Pae(kat,Iat,null,{context:PR,pure:!0,areStatePropsEqual:joe})(Nat);function Soe(e){var t=NS(kR),r=t.isUsingCloneFor;return r===e.draggableId&&!e.isClone?null:_e.createElement(Oat,e)}function Tat(e){var t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return _e.createElement(Soe,ea({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function Dat(e){var t=p.useContext(Q5);t||sn(!1);var r=t.contextId,n=t.isMovementAllowed,o=p.useRef(null),s=p.useRef(null),i=e.children,l=e.droppableId,c=e.type,d=e.mode,u=e.direction,f=e.ignoreContainerClipping,h=e.isDropDisabled,m=e.isCombineEnabled,v=e.snapshot,g=e.useClone,y=e.updateViewportMaxScroll,x=e.getContainerForClone,b=Yn(function(){return o.current},[]),w=Yn(function(M){o.current=M},[]);Yn(function(){return s.current},[]);var j=Yn(function(M){s.current=M},[]),_=Yn(function(){n()&&y({maxScroll:loe()})},[n,y]);cat({droppableId:l,type:c,mode:d,direction:u,isDropDisabled:h,isCombineEnabled:m,ignoreContainerClipping:f,getDroppableRef:b});var C=_e.createElement(hat,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},function(M){var I=M.onClose,R=M.data,D=M.animate;return _e.createElement(mat,{placeholder:R,onClose:I,innerRef:j,animate:D,contextId:r,onTransitionEnd:_})}),E=Xa(function(){return{innerRef:w,placeholder:C,droppableProps:{"data-rbd-droppable-id":l,"data-rbd-droppable-context-id":r}}},[r,l,C,w]),A=g?g.dragging.draggableId:null,P=Xa(function(){return{droppableId:l,type:c,isUsingCloneFor:A}},[l,A,c]);function F(){if(!g)return null;var M=g.dragging,I=g.render,R=_e.createElement(Soe,{draggableId:M.draggableId,index:M.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(D,U){return I(D,U,M)});return e4.createPortal(R,x())}return _e.createElement(kR.Provider,{value:P},i(E,v),F())}var UE=function(t,r){return t===r.droppable.type},kU=function(t,r){return r.draggables[t.draggable.id]},Mat=function(){var t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=ea({},t,{shouldAnimatePlaceholder:!1}),n=ci(function(i){return{draggableId:i.id,type:i.type,source:{index:i.index,droppableId:i.droppableId}}}),o=ci(function(i,l,c,d,u,f){var h=u.descriptor.id,m=u.descriptor.droppableId===i;if(m){var v=f?{render:f,dragging:n(u.descriptor)}:null,g={isDraggingOver:c,draggingOverWith:c?h:null,draggingFromThisWith:h,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!1,snapshot:g,useClone:v}}if(!l)return r;if(!d)return t;var y={isDraggingOver:c,draggingOverWith:h,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!0,snapshot:y,useClone:null}}),s=function(l,c){var d=c.droppableId,u=c.type,f=!c.isDropDisabled,h=c.renderClone;if(l.isDragging){var m=l.critical;if(!UE(u,m))return r;var v=kU(m,l.dimensions),g=Dc(l.impact)===d;return o(d,f,g,g,v,h)}if(l.phase==="DROP_ANIMATING"){var y=l.completed;if(!UE(u,y.critical))return r;var x=kU(y.critical,l.dimensions);return o(d,f,_oe(y.result)===d,Dc(y.impact)===d,x,h)}if(l.phase==="IDLE"&&l.completed&&!l.shouldFlush){var b=l.completed;if(!UE(u,b.critical))return r;var w=Dc(b.impact)===d,j=!!(b.impact.at&&b.impact.at.type==="COMBINE"),_=b.critical.droppable.id===d;return w?j?t:r:_?t:r}return r};return s},Rat={updateViewportMaxScroll:Vtt};function Lat(){return document.body||sn(!1),document.body}var Fat={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Lat},Coe=Pae(Mat,Rat,null,{context:PR,pure:!0,areStatePropsEqual:joe})(Dat);Coe.defaultProps=Fat;function sv({className:e,...t}){return a.jsx("div",{className:mr("animate-pulse rounded-md bg-muted/20",e),...t})}function eP(e){return{id:e.id,code:e.codigo_produto??"",name:e.nome,category:e.categoria??"",type:e.tipo_produto==="uso_interno"?"Uso Interno":"Venda",cost:Number(e.valor_custo??e.preco_custo??0),price:Number(e.valor_venda??e.preco_venda??0),stock:Number(e.estoque??e.estoque_atual??0),minStock:Number(e.estoque_minimo??0),status:e.status??(e.ativo===!1||Number(e.estoque??0)===0?"inactive":Number(e.estoque??0)>0&&Number(e.estoque??0)<=Number(e.estoque_minimo??0)?"low_stock":"active"),validade:e.validade?new Date(e.validade):null,barcode:e.codigo_barras??"",barcodeBox:e.codigo_barras_caixa??"",reference:e.referencia??"",brand:e.marca??"",group:e.grupo??"",unit:e.unidade??"UN",initialStock:Number(e.estoque_inicial??0),currentStock:Number(e.estoque_atual??e.estoque??0),weight:e.peso!=null?Number(e.peso):null,buyPrice:e.preco_compra!=null?Number(e.preco_compra):null,costsPercent:e.custos_percent!=null?Number(e.custos_percent):null,costPrice:e.preco_custo!=null?Number(e.preco_custo):null,marginPercent:e.lucro_percent!=null?Number(e.lucro_percent):null,salePrice:e.preco_venda!=null?Number(e.preco_venda):null,wholesaleQty:e.qtd_atacado!=null?Number(e.qtd_atacado):null,wholesalePrice:e.preco_atacado!=null?Number(e.preco_atacado):null,commissionPercent:e.comissao_percent!=null?Number(e.comissao_percent):null,discountPercent:e.desconto_percent!=null?Number(e.desconto_percent):null,cfopInterno:e.cfop_interno??"",cstIcmsInterno:e.cst_icms_interno??"",csosnInterno:e.csosn_interno??"",aliqIcmsInterno:e.aliquota_icms_interno!=null?Number(e.aliquota_icms_interno):null,cfopExterno:e.cfop_externo??"",cstIcmsExterno:e.cst_icms_externo??"",csosnExterno:e.csosn_externo??"",aliqIcmsExterno:e.aliquota_icms_externo!=null?Number(e.aliquota_icms_externo):null,cstPisEntrada:e.cst_pis_entrada??"",cstPisSaida:e.cst_pis_saida??"",aliqPisPercent:e.aliquota_pis_percent!=null?Number(e.aliquota_pis_percent):null,aliqCofinsPercent:e.aliquota_cofins_percent!=null?Number(e.aliquota_cofins_percent):null,cstIpi:e.cst_ipi??"",aliqIpiPercent:e.aliquota_ipi_percent!=null?Number(e.aliquota_ipi_percent):null,fcpPercent:e.fcp_percent!=null?Number(e.fcp_percent):null,mvaPercent:e.mva_percent!=null?Number(e.mva_percent):null,baseReduzidaPercent:e.base_reduzida_percent!=null?Number(e.base_reduzida_percent):null,ncm:e.ncm??"",ncmDescription:e.descricao_ncm??"",cest:e.cest??"",active:e.ativo??!0,allowSale:e.permite_venda??!0,payCommission:e.paga_comissao??!1,variablePrice:e.preco_variavel??!1,composition:e.composicao??!1,service:e.servico??!1,hasGrid:e.grade??!1,usePriceTable:e.usar_tabela_preco??!1,fuel:e.combustivel??!1,useImei:e.usa_imei??!1,stockByGrid:e.controle_estoque_por_grade??!1,showInApp:e.mostrar_no_app??!1,dataImportacao:e.data_importacao?new Date(e.data_importacao):null,importadoViaXml:e.importado_via_xml??!1}}async function $at({from:e,to:t,codigoEmpresa:r,limit:n=1e3}={}){if(!e||!t)throw new Error("Perodo invlido");const o=(e instanceof Date?e:new Date(e)).toISOString(),s=(t instanceof Date?t:new Date(t)).toISOString(),{data:i,error:l}=await Rs(v=>{let g=fe.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",o).lte("created_at",s).limit(n).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},2e4,"Timeout getSoldProductsByPeriod (20s)");if(l)throw l;const c=new Map;for(const v of i||[]){const g=v.produto_id,y=Number(v.quantidade||0);c.set(g,(c.get(g)||0)+y)}const d=Array.from(c.entries()).sort((v,g)=>g[1]-v[1]);if(d.length===0)return[];const u=d.map(([v])=>v),{data:f,error:h}=await Rs(v=>{let g=fe.from("produtos").select("id, nome").in("id",u).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},15e3,"Timeout getSoldProductsByPeriod:produtos (15s)");if(h)throw h;const m=new Map((f||[]).map(v=>[v.id,v.nome]));return d.map(([v,g])=>({id:v,name:m.get(v)||String(v),total:g}))}async function ox({productId:e,delta:t,codigoEmpresa:r}){const n=Number(t);if(!e||!Number.isFinite(n)||n===0)throw new Error("Parmetros invlidos para ajuste de estoque");const{data:o,error:s}=await Rs(d=>{let u=fe.from("produtos").select("id, estoque, estoque_atual").eq("id",e).single().abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout get current stock (10s)");if(s)throw s;const l=Number(o?.estoque??o?.estoque_atual??0)+n,{error:c}=await Rs(d=>{let u=fe.from("produtos").update({estoque:l,estoque_atual:l}).eq("id",e).abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout update stock (10s)");if(c)throw c;return{id:e,stock:l}}async function Bat({limit:e=5,codigoEmpresa:t}={}){const r=new Date;r.setHours(0,0,0,0);const n=r.toISOString(),{data:o,error:s}=await Rs(h=>{let m=fe.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",n).abortSignal(h);return t&&(m=m.eq("codigo_empresa",t)),m},15e3,"Timeout getMostSoldProductsToday (15s)");if(s)throw s;const i=new Map;for(const h of o||[]){const m=h.produto_id,v=Number(h.quantidade||0);i.set(m,(i.get(m)||0)+v)}const l=Array.from(i.entries()).sort((h,m)=>m[1]-h[1]).slice(0,e);if(l.length===0)return[];const c=l.map(([h])=>h),{data:d,error:u}=await Rs(h=>{let m=fe.from("produtos").select("id, nome").in("id",c).abortSignal(h);return t&&(m=m.eq("codigo_empresa",t)),m},15e3,"Timeout getMostSoldProductsToday:produtos (15s)");if(u)throw u;const f=new Map((d||[]).map(h=>[h.id,h.nome]));return l.map(([h,m])=>({id:h,name:f.get(h)||String(h),total:m}))}async function IU({codigoEmpresa:e}={}){if(!e)throw new Error("codigoEmpresa  obrigatrio");const{data:t,error:r}=await Rs(l=>fe.from("produtos").select("codigo_produto").eq("codigo_empresa",e).order("codigo_produto",{ascending:!0}).abortSignal(l),15e3,"Timeout getNextProductCode (15s)");if(r)throw r;const n=new Set;for(const l of t||[]){const c=(l.codigo_produto||"").trim();if(/^\d+$/.test(c)){const d=parseInt(c,10);Number.isFinite(d)&&d>0&&n.add(d)}}let o=1;const s=(n.size||0)+1e3;let i=0;for(;n.has(o)&&i<s;)o+=1,i+=1;return(!Number.isFinite(o)||o<=0)&&(o=1),String(o).padStart(4,"0")}function Poe(e){return{codigo_produto:e.code||null,nome:e.name,categoria:e.category||null,tipo_produto:e.type==="Uso Interno"?"uso_interno":"venda",valor_custo:e.cost!=null?Number(e.cost):0,valor_venda:e.price!=null?Number(e.price):0,estoque:e.stock!=null?Number(e.stock):0,estoque_minimo:e.minStock!=null?Number(e.minStock):0,status:e.status||null,validade:e.validade?new Date(e.validade).toISOString().slice(0,10):null,codigo_barras:e.barcode||null,codigo_barras_caixa:e.barcodeBox||null,referencia:e.reference||null,marca:e.brand||null,grupo:e.group||null,unidade:e.unit||null,estoque_inicial:e.initialStock!=null?Number(e.initialStock):null,estoque_atual:e.currentStock!=null?Number(e.currentStock):null,peso:e.weight!=null?Number(e.weight):null,preco_compra:e.buyPrice!=null?Number(e.buyPrice):null,custos_percent:e.costsPercent!=null?Number(e.costsPercent):null,preco_custo:e.costPrice!=null?Number(e.costPrice):null,lucro_percent:e.marginPercent!=null?Number(e.marginPercent):null,preco_venda:e.salePrice!=null?Number(e.salePrice):null,qtd_atacado:e.wholesaleQty!=null?Number(e.wholesaleQty):null,preco_atacado:e.wholesalePrice!=null?Number(e.wholesalePrice):null,comissao_percent:e.commissionPercent!=null?Number(e.commissionPercent):null,desconto_percent:e.discountPercent!=null?Number(e.discountPercent):null,cfop_interno:e.cfopInterno||null,cst_icms_interno:e.cstIcmsInterno||null,csosn_interno:e.csosnInterno||null,aliquota_icms_interno:e.aliqIcmsInterno!=null?Number(e.aliqIcmsInterno):null,cfop_externo:e.cfopExterno||null,cst_icms_externo:e.cstIcmsExterno||null,csosn_externo:e.csosnExterno||null,aliquota_icms_externo:e.aliqIcmsExterno!=null?Number(e.aliqIcmsExterno):null,cst_pis_entrada:e.cstPisEntrada||null,cst_pis_saida:e.cstPisSaida||null,aliquota_pis_percent:e.aliqPisPercent!=null?Number(e.aliqPisPercent):null,aliquota_cofins_percent:e.aliqCofinsPercent!=null?Number(e.aliqCofinsPercent):null,cst_ipi:e.cstIpi||null,aliquota_ipi_percent:e.aliqIpiPercent!=null?Number(e.aliqIpiPercent):null,fcp_percent:e.fcpPercent!=null?Number(e.fcpPercent):null,mva_percent:e.mvaPercent!=null?Number(e.mvaPercent):null,base_reduzida_percent:e.baseReduzidaPercent!=null?Number(e.baseReduzidaPercent):null,ncm:e.ncm||null,descricao_ncm:e.ncmDescription||null,cest:e.cest||null,ativo:e.active!=null?!!e.active:!0,permite_venda:e.allowSale!=null?!!e.allowSale:!0,paga_comissao:e.payCommission!=null?!!e.payCommission:!1,preco_variavel:e.variablePrice!=null?!!e.variablePrice:!1,composicao:e.composition!=null?!!e.composition:!1,servico:e.service!=null?!!e.service:!1,grade:e.hasGrid!=null?!!e.hasGrid:!1,usar_tabela_preco:e.usePriceTable!=null?!!e.usePriceTable:!1,combustivel:e.fuel!=null?!!e.fuel:!1,usa_imei:e.useImei!=null?!!e.useImei:!1,controle_estoque_por_grade:e.stockByGrid!=null?!!e.stockByGrid:!1,mostrar_no_app:e.showInApp!=null?!!e.showInApp:!1,importado_via_xml:e.importedViaXML===!0,data_importacao:e.dataImportacao?e.dataImportacao instanceof Date?e.dataImportacao.toISOString():new Date(e.dataImportacao).toISOString():null,xml_chave:e.xmlChave||null,xml_numero:e.xmlNumero||null,xml_serie:e.xmlSerie||null,xml_emissao:e.xmlEmissao?new Date(e.xmlEmissao).toISOString():null}}async function fu(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n}=e;console.log("[products.api] ====== listProducts INICIO ======"),console.log("[products.api] Parametros:",{includeInactive:t,search:r,codigoEmpresa:n});const{data:o,error:s}=await Rs(c=>{let d=fe.from("produtos").select("*").eq("codigo_empresa",n).order("nome",{ascending:!0}).abortSignal(c);if(t||(d=d.neq("status","inactive"),d=d.or("ativo.is.null,ativo.eq.true"),console.log("[products.api] Filtro aplicado: status != inactive AND (ativo IS NULL OR ativo = true)")),r&&r.trim().length>0){const u=r.trim();d=d.or(`nome.ilike.%${u}%,codigo_produto.ilike.%${u}%`)}return d},15e3,"Timeout listProducts (15s)");if(s)throw console.error("[products.api] listProducts:error",s),s;const i=(o||[]).map(eP);console.log("[products.api] listProducts RETORNOU:",i.length,"produtos"),console.log("[products.api] includeInactive:",t),console.log("[products.api] Produtos:",i.map(c=>({id:c.id,name:c.name,code:c.code})));const l=i.filter(c=>!c.code||c.code.trim()==="");return console.log("[products.api] Produtos SEM cdigo:",l.length),l.length>0&&l.forEach(c=>{console.log("  -",c.name,"| active:",c.active,"| status:",c.status,"| code:",c.code||"NULL")}),i}async function qat(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n,page:o=1,pageSize:s=100}=e;if(!n)return{data:[],count:0};const i=o>0?o:1,l=s>0?s:100,c=(i-1)*l,d=c+l-1;console.log("[products.api] ====== listProductsPaged INICIO ======",{includeInactive:t,search:r,codigoEmpresa:n,page:i,pageSize:l});try{const{data:u,error:f,count:h}=await Rs(v=>{let g=fe.from("produtos").select("*",{count:"exact"}).eq("codigo_empresa",n).order("nome",{ascending:!0}).range(c,d).abortSignal(v);if(t||(g=g.neq("status","inactive"),g=g.or("ativo.is.null,ativo.eq.true")),r&&r.trim().length>0){const y=r.trim();g=g.or(`nome.ilike.%${y}%,codigo_produto.ilike.%${y}%`)}return g},2e4,"Timeout listProductsPaged (20s)");if(f)throw console.error("[products.api] listProductsPaged:error",f),f;const m=(u||[]).map(eP);return console.log("[products.api] listProductsPaged RETORNOU:",m.length,"produtos de",h||0),{data:m,count:h||0}}catch(u){return console.error("[products.api] listProductsPaged:exception",u),{data:[],count:0}}}async function SS(e,t={}){const{codigoEmpresa:r}=t,n=Poe(e);r&&(n.codigo_empresa=r),console.info("[products.api] createProduct: payload",n);const o=async()=>Rs(d=>fe.from("produtos").insert(n).select("*").single().abortSignal(d),15e3,"Timeout createProduct (15s)"),s=d=>{if(!d)return!1;if(d.code&&String(d.code)==="23505")return!0;const u=[d.message,d.details,d.hint].filter(Boolean).join(" ").toLowerCase();return u.includes("duplicate key")||u.includes("unique constraint")||u.includes("ux_produtos_empresa_codigo_produto")||u.includes("codigo_produto")};let i,l;if({data:i,error:l}=await o(),l&&s(l)&&n.codigo_produto){console.warn("[products.api] createProduct: duplicate code, trying to free code from inactive product");const{data:d,error:u}=await Rs(h=>fe.from("produtos").select("id,status").eq("codigo_produto",n.codigo_produto).eq("status","inactive").limit(1).abortSignal(h),15e3,"Timeout find duplicate product (15s)"),f=Array.isArray(d)&&d.length>0?d[0]:null;if(!u&&f&&f.status==="inactive"){const{error:h}=await Rs(m=>fe.from("produtos").update({codigo_produto:null}).eq("id",f.id).abortSignal(m),15e3,"Timeout clear duplicate code (15s)");h||({data:i,error:l}=await o())}else{const h=n.codigo_produto;n.codigo_produto=null,console.warn("[products.api] createProduct: no inactive found for duplicate code, retrying with codigo_produto = null (original:",h,")"),{data:i,error:l}=await o()}}if(l)throw console.error("[products.api] createProduct:error",l),l;const c=eP(i);return console.info("[products.api] createProduct: ok",c),c}async function Yw(e,t,r={}){const n=Poe(t);n.data_importacao=null,console.info("[products.api] updateProduct: id",e,"payload",n);const{data:o,error:s}=await Rs(l=>fe.from("produtos").update(n).eq("id",e).select("*").single().abortSignal(l),15e3,"Timeout updateProduct (15s)");if(s)throw console.error("[products.api] updateProduct:error",s),s;const i=eP(o);return console.info("[products.api] updateProduct: ok",i),i}async function Rs(e,t,r){const n=new AbortController,o=setTimeout(()=>n.abort(new Error(r)),t);try{return await e(n.signal)}catch(s){throw s?.name==="AbortError"?new Error(r):s}finally{clearTimeout(o)}}async function IR(e){console.info("[products.api] deleteProduct (soft): id",e);const{error:t}=await Rs(r=>fe.from("produtos").update({status:"inactive",codigo_produto:null}).eq("id",e).abortSignal(r),15e3,"Timeout deleteProduct (15s)");if(t)throw console.error("[products.api] deleteProduct:error",t),t;return console.info("[products.api] deleteProduct: ok (inativado)"),!0}async function zat({ids:e,status:t}){const r=Array.isArray(e)?e.filter(Boolean):[];if(!r.length)throw new Error("Nenhum produto selecionado para atualizao em massa");if(!["active","inactive","low_stock"].includes(t))throw new Error("Status invlido para atualizao em massa");const n=t!=="inactive";console.info("[products.api] bulkUpdateProductStatus:start",{count:r.length,status:t});const{error:o}=await Rs(s=>fe.from("produtos").update({status:t,ativo:n}).in("id",r).abortSignal(s),2e4,"Timeout bulkUpdateProductStatus (20s)");if(o)throw console.error("[products.api] bulkUpdateProductStatus:error",o),o;return console.info("[products.api] bulkUpdateProductStatus:ok",{count:r.length,status:t}),!0}async function Uat({ids:e}){const t=Array.isArray(e)?e.filter(Boolean):[];if(!t.length)throw new Error("Nenhum produto selecionado para limpar flag de novo");console.info("[products.api] bulkClearNewFlag:start",{count:t.length});const{error:r}=await Rs(n=>fe.from("produtos").update({data_importacao:null}).in("id",t).abortSignal(n),2e4,"Timeout bulkClearNewFlag (20s)");if(r)throw console.error("[products.api] bulkClearNewFlag:error",r),r;return console.info("[products.api] bulkClearNewFlag:ok",{count:t.length}),!0}async function OU(e={}){const{codigoEmpresa:t}=e;console.info("[products.api] listCategories: start");const{data:r,error:n}=await Rs(i=>{let l=fe.from("produto_categorias").select("nome").eq("ativa",!0).order("nome",{ascending:!0}).abortSignal(i);return t&&(l=l.eq("codigo_empresa",t)),l},15e3,"Timeout listCategories (15s)");if(n)throw console.error("[products.api] listCategories:error",n),n;const o=[],s=new Set;for(const i of r||[]){const l=(i?.nome||"").trim();if(!l)continue;const c=l.toLowerCase();s.has(c)||(s.add(c),o.push(l))}return console.info("[products.api] listCategories: ok",{count:o.length}),o}async function Vat(e,t={}){const{codigoEmpresa:r}=t,n=String(e||"").trim();if(!n)throw new Error("Nome da categoria invlido");console.info("[products.api] createCategory:",n);const o={nome:n};r&&(o.codigo_empresa=r);const{data:s,error:i}=await Rs(l=>fe.from("produto_categorias").insert(o).select("nome").single().abortSignal(l),15e3,"Timeout createCategory (15s)");if(i)throw console.error("[products.api] createCategory:error",i),i;return s?.nome||n}async function Wat(e,t={}){const{codigoEmpresa:r}=t,n=String(e||"").trim();if(!n)throw new Error("Nome da categoria invlido");console.info("[products.api] removeCategory:",n);const{count:o,error:s}=await Rs(d=>{let u=fe.from("produtos").select("id",{count:"exact",head:!0}).eq("categoria",n).neq("status","inactive").abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},15e3,"Timeout removeCategory:count (15s)");if(s)throw console.error("[products.api] removeCategory:count:error",s),s;if((o??0)>0){const d=new Error("Categoria possui produtos ativos vinculados");throw console.warn("[products.api] removeCategory: blocked by active products",{nome:n,prodCount:o}),d}const{data:i,error:l}=await Rs(d=>{let u=fe.from("produto_categorias").update({ativa:!1}).eq("nome",n).select("nome").abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},15e3,"Timeout removeCategory (15s)");if(l)throw console.error("[products.api] removeCategory:error",l),l;if((Array.isArray(i)?i.length:0)===0){const d=new Error("Categoria no encontrada para desativar");throw console.warn("[products.api] removeCategory: no rows affected",{nome:n}),d}return!0}function Hat({item:e,onApply:t,onClose:r,codigoEmpresa:n}){const{toast:o}=no(),[s,i]=p.useState(e?.desconto_tipo||"percentual"),[l,c]=p.useState(e?.desconto_valor||0),[d,u]=p.useState(e?.desconto_motivo||""),[f,h]=p.useState(!1);if(!e)return null;const m=Number(e.price||e.preco_unitario||0),v=Number(e.quantity||e.quantidade||1),g=m*v,y=s==="percentual"?g*(1-l/100):g-l,x=async()=>{try{if(h(!0),l<0){o({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(s==="percentual"&&l>100){o({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}console.log("Aplicando desconto:",{itemId:e.id,desconto_tipo:s,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});const w=await YGe({itemId:e.id,desconto_tipo:s,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});console.log("Resultado:",w),o({title:"Sucesso",description:"Desconto aplicado!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao aplicar desconto:",w),o({title:"Erro",description:w.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{h(!1)}},b=async()=>{try{h(!0),await QGe({itemId:e.id,codigoEmpresa:n}),o({title:"Sucesso",description:"Desconto removido!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao remover desconto:",w),o({title:"Erro",description:w.message||"Falha ao remover desconto",variant:"destructive"})}finally{h(!1)}};return a.jsx(xn,{open:!0,onOpenChange:r,children:a.jsxs(vn,{overlayClassName:"z-[90]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[91]",children:[a.jsx(pn,{children:a.jsxs(fn,{className:"text-lg font-bold",children:["Desconto - ",e.name]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(De,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{variant:s==="percentual"?"default":"outline",onClick:()=>i("percentual"),disabled:f,className:"flex-1",children:"Percentual (%)"}),a.jsx(ce,{variant:s==="fixo"?"default":"outline",onClick:()=>i("fixo"),disabled:f,className:"flex-1",children:"Fixo (R$)"})]})]}),a.jsxs("div",{children:[a.jsxs(De,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",s==="percentual"?"(%)":"(R$)"]}),a.jsxs("div",{className:"relative mt-1",children:[a.jsx(Je,{id:"desconto-valor",type:"text",value:s==="percentual"?l===0?"":l:l===0?"":`R$ ${l.toFixed(2)}`,onChange:w=>{let j=w.target.value.trim();if(j===""){c(0);return}s==="fixo"&&(j=j.replace(/[^\d.,]/g,"").replace(",","."));let _=Number(j);isNaN(_)&&(_=0),s==="percentual"&&_>100&&(_=100),_<0&&(_=0),c(_)},placeholder:s==="percentual"?"0":"0,00",disabled:f,className:"mt-1"}),s==="percentual"&&a.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),a.jsxs("select",{id:"desconto-motivo",value:d,onChange:w=>u(w.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:f,children:[a.jsx("option",{value:"",children:"Selecione um motivo..."}),a.jsx("option",{value:"Promoo",children:"Promoo"}),a.jsx("option",{value:"Meia entrada",children:"Meia entrada"}),a.jsx("option",{value:"Cortesia",children:"Cortesia"}),a.jsx("option",{value:"Ajuste",children:"Ajuste"}),a.jsx("option",{value:"Outro",children:"Outro"})]})]}),a.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:"Preo Original:"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",g.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[a.jsx("span",{children:"Desconto:"}),a.jsxs("span",{children:["-R$ ",(g-y).toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[a.jsx("span",{children:"Total do Item:"}),a.jsxs("span",{className:"text-brand",children:["R$ ",Math.max(0,y).toFixed(2)]})]})]}),d&&a.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[a.jsx("strong",{children:"Motivo:"})," ",d]})]}),a.jsxs(ra,{className:"flex gap-2",children:[a.jsx(ce,{variant:"outline",onClick:r,disabled:f,children:"Cancelar"}),e.desconto_valor>0&&a.jsxs(ce,{variant:"destructive",onClick:b,disabled:f,size:"sm",className:"gap-2",children:[a.jsx(Bu,{className:"w-4 h-4"}),"Remover"]}),a.jsx(ce,{onClick:x,disabled:f,className:"gap-2",children:f?"Aplicando...":"Aplicar Desconto"})]})]})})}function Gat({comanda:e,subtotal:t,onApply:r,onClose:n,codigoEmpresa:o}){const{toast:s}=no(),[i,l]=p.useState(e?.desconto_tipo||"percentual"),[c,d]=p.useState(e?.desconto_valor||0),[u,f]=p.useState(e?.desconto_motivo||""),[h,m]=p.useState(!1);if(!e)return null;const v=i==="percentual"?t*c/100:c,g=Math.max(0,t-v),y=async()=>{try{if(m(!0),c<0){s({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(i==="percentual"&&c>100){s({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}if(v>t){s({title:"Erro",description:"Desconto no pode ser maior que o subtotal",variant:"destructive"});return}console.log("Aplicando desconto comanda:",{comandaId:e.id,desconto_tipo:i,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:o});const b=await JGe({comandaId:e.id,desconto_tipo:i,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:o});console.log("Resultado comanda:",b),s({title:"Sucesso",description:"Desconto aplicado na comanda!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao aplicar desconto:",b),s({title:"Erro",description:b.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{m(!1)}},x=async()=>{try{m(!0),await ZGe({comandaId:e.id,codigoEmpresa:o}),s({title:"Sucesso",description:"Desconto removido!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao remover desconto:",b),s({title:"Erro",description:b.message||"Falha ao remover desconto",variant:"destructive"})}finally{m(!1)}};return a.jsx(xn,{open:!0,onOpenChange:n,children:a.jsxs(vn,{className:"sm:max-w-[420px]",children:[a.jsx(pn,{children:a.jsx(fn,{className:"text-lg font-bold",children:"Desconto da Comanda"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(De,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{variant:i==="percentual"?"default":"outline",onClick:()=>l("percentual"),disabled:h,className:"flex-1",children:"Percentual (%)"}),a.jsx(ce,{variant:i==="fixo"?"default":"outline",onClick:()=>l("fixo"),disabled:h,className:"flex-1",children:"Fixo (R$)"})]})]}),a.jsxs("div",{children:[a.jsxs(De,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",i==="percentual"?"(%)":"(R$)"]}),a.jsxs("div",{className:"relative mt-1",children:[a.jsx(Je,{id:"desconto-valor",type:"text",name:"desconto-valor",autoComplete:"off",autoCorrect:"off",spellCheck:!1,value:i==="percentual"?c===0?"":c:c===0?"":`R$ ${c.toFixed(2)}`,onChange:b=>{let w=b.target.value.trim();if(w===""){d(0);return}i==="fixo"&&(w=w.replace(/[^\d.,]/g,"").replace(",","."));let j=Number(w);isNaN(j)&&(j=0),i==="percentual"&&j>100&&(j=100),j<0&&(j=0),d(j)},placeholder:i==="percentual"?"0":"0,00",disabled:h,className:"mt-1"}),i==="percentual"&&a.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),a.jsxs("select",{id:"desconto-motivo",value:u,onChange:b=>f(b.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:h,children:[a.jsx("option",{value:"",children:"Selecione um motivo..."}),a.jsx("option",{value:"Promoo",children:"Promoo"}),a.jsx("option",{value:"Cortesia",children:"Cortesia"}),a.jsx("option",{value:"Ajuste",children:"Ajuste"}),a.jsx("option",{value:"Outro",children:"Outro"})]})]}),a.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:"Subtotal:"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",t.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[a.jsx("span",{children:"Desconto:"}),a.jsxs("span",{children:["-R$ ",v.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[a.jsx("span",{children:"Total da Comanda:"}),a.jsxs("span",{className:"text-brand",children:["R$ ",g.toFixed(2)]})]})]}),u&&a.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[a.jsx("strong",{children:"Motivo:"})," ",u]})]}),a.jsxs(ra,{className:"flex gap-2",children:[a.jsx(ce,{variant:"outline",onClick:n,disabled:h,children:"Cancelar"}),e.desconto_valor>0&&a.jsxs(ce,{variant:"destructive",onClick:x,disabled:h,size:"sm",className:"gap-2",children:[a.jsx(Bu,{className:"w-4 h-4"}),"Remover"]}),a.jsx(ce,{onClick:y,disabled:h,className:"gap-2",children:h?"Aplicando...":"Aplicar Desconto"})]})]})})}const Kat={available:{label:"Livre",color:"border-success/50 bg-success/10 text-success",icon:Ds},"in-use":{label:"Em Uso",color:"border-warning/50 bg-warning/10 text-warning",icon:vd},"awaiting-payment":{label:"Pagamento",color:"border-info/50 bg-info/10 text-info",icon:Gs}};function Xat(){const{toast:e}=no(),{userProfile:t,authReady:r}=So(),n=Yi(),[o,s]=p.useState([]),[i,l]=p.useState(null),[c,d]=p.useState(!1),[u,f]=p.useState(0);p.useRef(!1);const[h,m]=p.useState(!1);p.useState([]);const[v,g]=p.useState(!1),[y,x]=p.useState(new Map),[b,w]=p.useState(!1);p.useRef(null),p.useRef(null);const j=p.useRef([]),_=p.useRef(null),[C,E]=p.useState(0),[A,P]=p.useState("tables");p.useRef(null);const[F,M]=p.useState("order");p.useRef(null),p.useRef(null),p.useState(!1);const[I,R]=p.useState(null),[D,U]=p.useState(null),[z,H]=p.useState(!1),[q,Q]=p.useState(!1),[pe,be]=p.useState(!1),[V,B]=p.useState(null),[J,ue]=p.useState(!1),[Ne,Z]=p.useState([]),[ge,le]=p.useState(!1),[se,ee]=p.useState(!1),[de,Le]=p.useState(!1),[ae,ie]=p.useState(!1),[dt,At]=p.useState(!1),[st,ut]=p.useState(!1),[Rt,Nt]=p.useState(!1),[tt,he]=p.useState(null),[ke,et]=p.useState(""),[Me,$e]=p.useState(!1),[Be,we]=p.useState(!1),[He,ht]=p.useState([]),[zt,hr]=p.useState(null),[Mt,Qt]=p.useState(null),[Se,kt]=p.useState(!1),Lt=p.useRef(""),[fr,yr]=p.useState(!1),[Xt,nr]=p.useState(!1),[ir,Ee]=p.useState("order"),[qe,Ge]=p.useState(!1),[Qe,St]=p.useState(""),[pt,Et]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}}),[mt,gt]=p.useState(null),[ft,Dt]=p.useState(null),[Ft,ye]=p.useState(!1);p.useEffect(()=>{const W=t?.codigo_empresa;W&&(async()=>{try{if(Array.isArray(He)&&He.length>0)return;const oe=await Wm({somenteAtivas:!0,codigoEmpresa:W});ht(Array.isArray(oe)?oe:[])}catch{}})()},[t?.codigo_empresa]);const wt=p.useMemo(()=>{const W=new Map,oe=i?.order||[];for(const Pe of oe){const ze=String(Pe.productId);W.set(ze,(W.get(ze)||0)+Number(Pe.quantity||0))}return W},[i?.order]),Yt=async W=>{try{const oe=i?.order||[],Pe=oe.find(or=>String(or.productId)===String(W.id));if(!Pe)return;const ze=Number(Pe.quantity||0)-1;if(String(Pe.id||"").startsWith("tmp-")){const or=ze>0?oe.map(Yr=>Yr.id===Pe.id?{...Yr,quantity:ze}:Yr):oe.filter(Yr=>Yr.id!==Pe.id),Hr=or.reduce((Yr,vr)=>Yr+Number(vr.price||0)*Number(vr.quantity||0),0),Cr={...i,order:or,totalHint:Hr};l(Cr),s(Yr=>Yr.map(vr=>vr.id===Cr.id?{...vr,totalHint:Hr}:vr)),setTimeout(async()=>{try{const vr=(await ds({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Zr=>({id:Zr.id,productId:Zr.produto_id,name:Zr.descricao||"Item",price:Number(Zr.preco_unitario||0),quantity:Number(Zr.quantidade||1)})),lr=(vr||[]).reduce((Zr,cn)=>Zr+Number(cn.price||0)*Number(cn.quantity||0),0),ct={...i,order:vr,totalHint:lr};l(ct),s(Zr=>Zr.map(cn=>cn.id===ct.id?{...cn,totalHint:lr}:cn))}catch{}},300);return}const Tt=i,it=o,Bt=ze>0?oe.map(or=>or.id===Pe.id?{...or,quantity:ze}:or):oe.filter(or=>or.id!==Pe.id),Kt=Bt.reduce((or,Hr)=>or+Number(Hr.price||0)*Number(Hr.quantity||0),0),Ct={...i,order:Bt,totalHint:Kt};l(Ct),s(or=>or.map(Hr=>Hr.id===Ct.id?{...Hr,totalHint:Kt}:Hr));try{ze>0?await ed({itemId:Pe.id,quantidade:ze,codigoEmpresa:t?.codigo_empresa}):await Bv({itemId:Pe.id,codigoEmpresa:t?.codigo_empresa})}catch(or){throw l(Tt),s(it),or}const Or=Math.max(ze,0);let jr=!1;for(let or=0;or<3&&!jr;or++){const Cr=(await ds({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(vr=>({id:vr.id,productId:vr.produto_id,name:vr.descricao||"Item",price:Number(vr.preco_unitario||0),quantity:Number(vr.quantidade||1)}));if((Cr.find(vr=>String(vr.productId)===String(W.id))?.quantity||0)===Or){const vr=Cr.reduce((ct,Zr)=>ct+Number(Zr.price||0)*Number(Zr.quantity||0),0),lr={...i,order:Cr,totalHint:vr};l(lr),s(ct=>ct.map(Zr=>Zr.id===lr.id?lr:Zr)),jr=!0;break}await new Promise(vr=>setTimeout(vr,180*(or+1)))}try{const or=await Mm({codigoEmpresa:t?.codigo_empresa}),Hr=new Map;for(const Cr of or||[]){const Yr=String(Cr.produto_id),vr=Number(Cr.quantidade||0);Hr.set(Yr,(Hr.get(Yr)||0)+vr)}x(Hr)}catch(or){console.error("[decProduct] Erro ao atualizar estoque reservado:",or)}}catch(oe){console.error("[decProduct] Erro:",oe),e({title:"Falha ao alterar quantidade",description:oe?.message||"Tente novamente",variant:"destructive"})}},br=p.useRef(null),Mr=p.useCallback(()=>{try{const W=br.current;if(!W)return 1;const Pe=window.getComputedStyle(W).gridTemplateColumns||"";if(Pe){const Ke=Pe.split(" ").filter(Boolean).length;if(Ke>0)return Ke}const ze=W.querySelector("[data-table-id]");if(ze){const Ke=ze.getBoundingClientRect().width,Tt=W.getBoundingClientRect().width;if(Ke>0)return Math.max(1,Math.floor(Tt/Ke))}return 1}catch{return 1}},[]),[Nr,Rr]=p.useState(!1),Er=p.useRef(!1);p.useEffect(()=>{Er.current=Me},[Me]);const ln=p.useRef(0),Fn=p.useRef(null),Hn=p.useRef(null),$n=p.useRef(null),at=p.useRef(null),Vt=p.useRef([]);p.useRef(null);const wr=p.useRef(!1),er=p.useRef(null),Ze=p.useRef(null);Ls();const Fr=p.useMemo(()=>(o||[]).find(W=>W.status==="available")?.id||null,[o]),jt=se||ae||q||v||Me||Se||h||z||Xt||pe||b||!1,_r=async W=>{try{if(!W)return;if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}if(Be)return;if(we(!0),l(oe=>!oe||oe.id!==W.id?W:oe),W.status==="available"||!W.comandaId){he(W),ie(!0);return}try{await ot(W)}catch{try{const ze=(await ds({comandaId:W.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(it=>({id:it.id,productId:it.produto_id,name:it.descricao||"Item",price:Number(it.preco_unitario||0),quantity:Number(it.quantidade||1)}));let Ke=null;try{const Bt=(await ni({comandaId:W.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Kt=>Kt?.nome).filter(Boolean);Ke=Bt.length?Bt.join(", "):null}catch{}const Tt={...W,order:ze,customer:Ke};l(Tt),s(it=>it.map(Bt=>Bt.id===Tt.id?Tt:Bt))}catch{}}}finally{we(!1)}};p.useEffect(()=>{const W=()=>{try{Et(typeof window<"u"&&window.innerWidth<=640)}catch{Et(!1)}};return W(),window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]),p.useEffect(()=>{const W=async oe=>{try{if(b)return;const Pe=String(oe.target?.tagName||"").toLowerCase();if(["input","textarea","select"].includes(Pe)||oe.target?.isContentEditable||jt)return;if(oe.key==="F1"){oe.preventDefault();try{const Ke=(o||[]).filter(Tt=>Tt.status==="available");Ke.length>0?(l(Ke[0]),he?.(Ke[0])):!i&&Array.isArray(o)&&o.length>0&&(l(o[0]),he?.(o[0]))}catch{}ie(!0);return}if(oe.key==="F2"){oe.preventDefault(),i?.comandaId?await mn():e({title:"Nenhuma comanda selecionada",description:"Selecione uma mesa com comanda aberta antes de fechar.",variant:"warning"});return}if(oe.key==="F10"){oe.preventDefault(),c?e({title:"Caixa j est aberto",description:"Use F11 para ver detalhes do caixa.",variant:"info"}):kt(!0);return}if(oe.key==="F11"){oe.preventDefault(),g(!0);return}if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(oe.key)){if(A!=="tables"||!i||!Array.isArray(o)||o.length===0)return;oe.preventDefault(),oe.stopPropagation();let Ke=Math.max(0,o.findIndex(Ct=>Ct.id===i?.id));Ke<0&&(Ke=0);let Tt=Mr(),it=Ke;oe.key==="ArrowRight"&&(it=Ke+1),oe.key==="ArrowLeft"&&(it=Ke-1),oe.key==="ArrowDown"&&(it=Ke+Tt),oe.key==="ArrowUp"&&(it=Ke-Tt);const Bt=o.length;it=(it%Bt+Bt)%Bt;const Kt=o[it];Kt&&Kt.id!==i?.id&&(l(Kt),setTimeout(()=>{try{document.querySelector(`[data-table-id="${Kt.id}"]`)?.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}catch{}},0));return}if(oe.key==="Enter"){if(A!=="tables")return;oe.preventDefault(),oe.stopPropagation(),i&&!Be&&await _r(i);return}if(oe.key==="Escape"){if(oe.preventDefault(),i&&(F==="products"||ir==="products")){M("order"),Ee("order");return}if(i){l(null);return}return}if(oe.key==="p"||oe.key==="P"){if(oe.preventDefault(),h){setTimeout(()=>{try{_.current?.focus()}catch{}},0);return}if(i){w(!0);try{nr(!1)}catch{}return}m(!0),setTimeout(()=>{try{_.current?.focus()}catch{}},50);return}}catch{}};return window.addEventListener("keydown",W),()=>window.removeEventListener("keydown",W)},[jt,i?.id,o,Mr,b]),p.useEffect(()=>{try{i?.id&&t?.codigo_empresa&&localStorage.setItem(`vendas:selected:${t.codigo_empresa}`,String(i.id))}catch{}},[i?.id,t?.codigo_empresa]),p.useEffect(()=>{(async()=>{try{if(!i&&t?.codigo_empresa&&Array.isArray(o)&&o.length>0){const oe=localStorage.getItem(`vendas:selected:${t.codigo_empresa}`);if(oe){const Pe=o.find(ze=>String(ze.id)===String(oe));if(Pe)if(P("tables"),Pe.comandaId)try{await ot(Pe),P("tables")}catch(ze){console.error("[Restore Selection] Erro ao carregar detalhes:",ze),localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}else localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}}}catch(oe){console.error("[Restore Selection] Erro:",oe)}})()},[o,i,t?.codigo_empresa]);const bt=p.useCallback(async()=>{try{const W=await Gm({codigoEmpresa:t?.codigo_empresa});d(!!(W&&(W.id||W?.length)))}catch{d(!1)}},[t?.codigo_empresa]),Wt=async()=>{const W=t?.codigo_empresa||null;try{if(!W)return;const[oe,Pe]=await Promise.all([Mw({codigoEmpresa:W}).catch(()=>null),Gm({codigoEmpresa:W}).catch(()=>null)]);if(!Pe?.id){R(null);return}let ze=0,Ke=[];try{Ke=await qp({caixaSessaoId:Pe.id,codigoEmpresa:W}),ze=(Ke||[]).filter(it=>(it?.tipo||"")==="sangria").reduce((it,Bt)=>it+Number(Bt?.valor||0),0)}catch{}const Tt={saldo_inicial:Pe.saldo_inicial||0,totalPorFinalizadora:oe?.totalPorFinalizadora||oe?.porFinalizadora||{},totalEntradas:oe?.totalEntradas||oe?.entradas||0,totalSangria:ze,totalSaidas:ze,sessaoId:Pe.id,movimentacoes:Ke};_e.startTransition(()=>{R(Tt)})}catch{_e.startTransition(()=>{R(null)})}finally{}},Zt=p.useRef(!1);p.useEffect(()=>{v&&!Zt.current?(Zt.current=!0,Wt().catch(()=>{})):v||(Zt.current=!1)},[v]);const Br=p.useRef(!0);p.useEffect(()=>(Br.current=!0,()=>{Br.current=!1}),[]);const zr=p.useRef(0),_t=p.useRef(0),Jr=p.useRef(0);p.useEffect(()=>{const W=t?.codigo_empresa||null,oe=W?`vendas:tables:${W}`:null,Pe=()=>{try{if(!oe)return;const Ke=JSON.parse(localStorage.getItem(oe)||"[]");Array.isArray(Ke)&&Ke.length>0&&s(Ke)}catch{}};W&&Pe();const ze=async()=>{try{if(!r||!W)return;const Ke=++Jr.current,Tt=setTimeout(()=>{Br.current&&Pe()},2e3),it=setTimeout(()=>{Br.current&&Jr.current===Ke&&Pe()},1e4),[Bt,Kt]=await Promise.all([Hm(W),Mm({codigoEmpresa:W}).catch(()=>[])]);if(Br.current&&Jr.current===Ke){const lr=new Map;for(const ct of Kt||[]){const Zr=String(ct.produto_id),cn=Number(ct.quantidade||0);lr.set(Zr,(lr.get(Zr)||0)+cn)}x(lr)}let Ct=[];try{Ct=await yc({codigoEmpresa:W})}catch(lr){console.error("[VendasPage:load] Erro ao carregar comandas abertas:",lr)}const Or=await(async()=>{try{return await lS((Ct||[]).map(lr=>lr.id),W)}catch{return{}}})(),jr=await(async()=>{try{const lr=await Promise.all((Ct||[]).map(async ct=>{try{const cn=(await ni({comandaId:ct.id,codigoEmpresa:W})||[]).map(Ia=>Ia?.nome).filter(Boolean);return[ct.id,cn.length?cn.join(", "):null]}catch{return[ct.id,null]}}));return Object.fromEntries(lr)}catch{return{}}})(),or=new Map;(Ct||[]).forEach(lr=>or.set(lr.mesa_id,lr));const Cr=(Bt||[]).map(lr=>{const ct=or.get(lr.id);let Zr,cn=null,Ia=null,Ca=0,cr=null;return ct?(Zr=ct.status==="awaiting-payment"||ct.status==="awaiting_payment"?"awaiting-payment":"in-use",cn=ct.id,Ia=jr[ct.id]||null,Ca=Or[ct.id]||0,cr=ct.aberto_em||null):Zr="available",{id:lr.id,number:lr.numero,name:lr.nome||null,status:Zr,order:[],customer:Ia,comandaId:cn,totalHint:Ca,aberto_em:cr}}).map(lr=>i&&lr.id===i.id?{...lr,order:i.order||[],customer:i.customer||lr.customer}:lr);if(!Br.current||Jr.current!==Ke){clearTimeout(Tt),clearTimeout(it);return}if(s(Cr),(Cr||[]).length===0)try{oe&&localStorage.removeItem(oe)}catch{}else try{oe&&localStorage.setItem(oe,JSON.stringify(Cr))}catch{}const Yr=W?`vendas:selected:${W}`:null;if(Yr)try{const lr=localStorage.getItem(Yr);if(lr){const ct=Cr.find(Zr=>String(Zr.id)===String(lr));ct&&!ct.comandaId&&localStorage.removeItem(Yr)}}catch{}_t.current=Array.isArray(Cr)?Cr.length:0,zr.current=Date.now();let vr=null;try{const lr=W?`vendas:selected:${W}`:null,ct=lr?localStorage.getItem(lr):null;if(ct){const Zr=Cr.find(cn=>String(cn.id)===String(ct));Zr&&(vr=Zr)}}catch{}vr?Me||l(lr=>!lr||lr.id!==vr.id?vr:{...vr,order:lr.order||vr.order||[],customer:lr.customer||vr.customer||null,observacoes:lr.observacoes??vr.observacoes??null,desconto_tipo:lr.desconto_tipo??vr.desconto_tipo??null,desconto_valor:lr.desconto_valor??vr.desconto_valor??0,desconto_motivo:lr.desconto_motivo??vr.desconto_motivo??null}):Me||l(lr=>{const ct=lr?Cr.find(cn=>cn.id===lr.id):null;return ct?{...ct,order:lr.order||ct.order||[],customer:lr.customer||ct.customer||null,observacoes:lr.observacoes??ct.observacoes??null,desconto_tipo:lr.desconto_tipo??ct.desconto_tipo??null,desconto_valor:lr.desconto_valor??ct.desconto_valor??0,desconto_motivo:lr.desconto_motivo??ct.desconto_motivo??null}:Cr[0]||null});try{const lr=await fu({includeInactive:!1,codigoEmpresa:W});Z(lr||[])}catch(lr){console.warn("Falha ao carregar produtos:",lr?.message||lr)}clearTimeout(Tt),clearTimeout(it)}catch(Ke){console.error("Erro ao carregar mesas:",Ke)}};return Pe(),r&&W&&ze(),()=>{}},[r,t?.codigo_empresa,jt]),p.useEffect(()=>{!r||!t?.codigo_empresa||bt()},[r,t?.codigo_empresa,bt]),p.useEffect(()=>{let W=!0;return(async()=>{try{if(!t?.codigo_empresa){W&&f(0);return}const oe=await yc({codigoEmpresa:t?.codigo_empresa});if(!W)return;f(Array.isArray(oe)?oe.length:0)}catch{W&&f(0)}})(),()=>{W=!1}},[t?.codigo_empresa,o.length]),p.useEffect(()=>{const W=t?.codigo_empresa||null,oe=W?`vendas:selected:${W}`:null;try{oe&&i?.id&&localStorage.setItem(oe,String(i.id))}catch{}i?.comandaId&&(!i.order||i.order.length===0)&&ot(i)},[i?.id,i?.comandaId]),p.useEffect(()=>()=>{},[i?.comandaId,jt,pe]);const mn=async()=>{try{if(!i?.comandaId){e({title:"Selecione uma mesa com comanda aberta",variant:"warning"});return}await _f({codigoEmpresa:t?.codigo_empresa});try{const ze=(await ds({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Tt=>({id:Tt.id,productId:Tt.produto_id,name:Tt.descricao||"Item",price:Number(Tt.preco_unitario||0),quantity:Number(Tt.quantidade||1),desconto_tipo:Tt.desconto_tipo||null,desconto_valor:Number(Tt.desconto_valor||0),desconto_motivo:Tt.desconto_motivo||null})),Ke={...i,order:ze};l(Ke),s(Tt=>Tt.map(it=>it.id===Ke.id?Ke:it))}catch{}const W=await Wm({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});ht(W||[]);const oe=W&&W[0]&&W[0].id?W[0].id:null;hr(oe),Qt(oe),$e(!0)}catch(W){e({title:"Falha ao carregar finalizadoras",description:W?.message||"Tente novamente",variant:"destructive"})}},ma=W=>{if(!W.destination)return;const oe=Array.from(o),[Pe]=oe.splice(W.source.index,1);oe.splice(W.destination.index,0,Pe),s(oe),e({title:"Layout das mesas atualizado!",description:"As posies foram salvas temporariamente.",variant:"success"})},Nn=(W,oe)=>{let Pe=0;for(const Ke of W||[]){let Tt=(Ke.price||0)*(Ke.quantity||1);Ke.desconto_tipo==="percentual"&&Ke.desconto_valor>0?Tt*=1-Ke.desconto_valor/100:Ke.desconto_tipo==="fixo"&&Ke.desconto_valor>0&&(Tt-=Ke.desconto_valor),Pe+=Math.max(0,Tt)}let ze=Pe;return oe?.desconto_tipo==="percentual"&&oe?.desconto_valor>0?ze*=1-oe.desconto_valor/100:oe?.desconto_tipo==="fixo"&&oe?.desconto_valor>0&&(ze-=oe.desconto_valor),Math.max(0,ze)},re=W=>{if(!W)return"";const oe=W.trim().split(/\s+/);return oe.length<=2?W:oe.slice(0,2).join(" ")},Te=W=>{if(!W)return"";const oe=ze=>String(ze).replace(/^\s*[\[]+\s*/g,"").replace(/\s*[\]]+\s*$/g,"").trim(),Pe=W.split(",").map(ze=>oe(ze)).filter(Boolean);return Pe.length===0?"":Pe.length===1?re(Pe[0]):`${re(Pe[0])} +${Pe.length-1}`},ot=async W=>{try{if(!W?.comandaId)return;const Pe=(await ds({comandaId:W.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(it=>({id:it.id,productId:it.produto_id,name:it.descricao||"Item",price:Number(it.preco_unitario||0),quantity:Number(it.quantidade||1),desconto_tipo:it.desconto_tipo||null,desconto_valor:Number(it.desconto_valor||0),desconto_motivo:it.desconto_motivo||null}));let ze=W.customer||null;try{const Bt=(await ni({comandaId:W.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Kt=>Kt?.nome).filter(Boolean);ze=Bt.length?Bt.join(", "):null}catch{}let Ke=W;try{const Bt=(await yc({codigoEmpresa:t?.codigo_empresa}))?.find(Kt=>Kt.id===W.comandaId);Bt&&(Ke={...W,desconto_tipo:Bt.desconto_tipo||null,desconto_valor:Number(Bt.desconto_valor||0),desconto_motivo:Bt.desconto_motivo||null,observacoes:Bt.observacoes||null})}catch{}const Tt={...Ke,status:W.status==="awaiting-payment"?"awaiting-payment":"in-use",order:Pe,customer:ze};l(Tt),s(it=>it.map(Bt=>Bt.id===Tt.id?Tt:Bt))}catch(oe){console.warn("[VendasPage] Falha ao recarregar detalhes da mesa selecionada:",oe)}},te=async({showToast:W=!1}={})=>{try{const oe=t?.codigo_empresa;if(!oe)return;const Pe=await Hm(oe);let ze=[];try{ze=await yc({codigoEmpresa:oe})}catch(Ct){console.error("[refreshTablesLight] Erro ao carregar comandas:",Ct)}const Ke=new Map((ze||[]).map(Ct=>[Ct.mesa_id,Ct])),Tt={},it={};try{const Ct=(ze||[]).map(or=>or.id);(await Promise.all(Ct.map(async or=>{try{return{id:or,vinculos:await ni({comandaId:or,codigoEmpresa:oe})}}catch{return{id:or,vinculos:[]}}}))).forEach(({id:or,vinculos:Hr})=>{const Cr=(Hr||[]).map(Yr=>Yr?.nome).filter(Boolean);Tt[or]=Cr.length?Cr.join(", "):null}),(await Promise.all(Ct.map(async or=>{try{const Cr=(await ds({comandaId:or,codigoEmpresa:oe})||[]).reduce((Yr,vr)=>{const lr=(vr.quantidade||0)*(vr.preco_unitario||0)-(vr.desconto||0);return Yr+lr},0);return{comandaId:or,total:Cr}}catch(Hr){return console.error(`[refreshTablesLight] Erro ao buscar itens da comanda ${or}:`,Hr),{comandaId:or,total:0}}}))).forEach(({comandaId:or,total:Hr})=>{it[or]=Hr})}catch(Ct){console.error("[refreshTablesLight] Erro ao carregar clientes/totais:",Ct)}const Kt=(Pe||[]).map(Ct=>{const Or=Ke.get(Ct.id);let jr,or=null,Hr=null,Cr=0;return Or?(jr=Or.status==="awaiting-payment"||Or.status==="awaiting_payment"?"awaiting-payment":"in-use",or=Or.id,Hr=Tt[Or.id]||null,Cr=it[Or.id]||0):jr="available",{id:Ct.id,number:Ct.numero,name:Ct.nome||null,status:jr,order:[],customer:Hr,comandaId:or,totalHint:Cr}}).map(Ct=>{if(i&&Ct.id===i.id)return i.status==="available"?{...Ct,status:"available",comandaId:null,order:[],customer:null,totalHint:0}:Ct.comandaId?{...Ct,order:i.order||[],customer:i.customer||Ct.customer}:{...Ct,order:[],customer:null};try{const Or=L.current.get(Ct.id);if(Or&&Date.now()-Or<3e4)return{...Ct,status:"available",comandaId:null,order:[],customer:null,totalHint:0}}catch{}return Ct});if(s(Kt),i){const Ct=Kt.find(Or=>Or.id===i.id);Ct&&!Ct.comandaId&&l({...Ct,order:[],customer:null})}}catch(oe){console.error("[refreshTablesLight] Erro fatal:",oe),W&&e({title:"Erro ao atualizar mesas",description:"Recarregue a pgina se o problema persistir",variant:"destructive"})}},T=p.useRef(null);p.useEffect(()=>{T.current=i},[i]);const O=p.useRef(null),X=p.useRef(null),G=p.useRef(null),L=p.useRef(new Map);p.useEffect(()=>{const W=t?.codigo_empresa;if(!W)return;try{const ze=typeof window<"u"?window.localStorage.getItem("custom-auth-token"):null;if(ze&&ze.trim())fe.realtime.setAuth(ze.trim());else{let Ke="";try{Ke=(new URL(fe.supabaseUrl||"").host||"").split(".")[0]||""}catch{}const Tt=Ke?`sb-${Ke}-auth-token`:"sb-auth-token",it=typeof window<"u"?window.localStorage.getItem(Tt):null;if(it)try{const Bt=JSON.parse(it),Kt=Bt?.access_token||Bt?.currentSession?.access_token;Kt&&fe.realtime.setAuth(Kt)}catch{}}}catch{}const oe=fe.channel(`loja:${W}`),Pe=ze=>{const Ke=ze?.table||ze?.table_name||"",Tt=ze?.new||ze?.old||{},it=ze?.eventType||ze?.type||ze?.event||"";let Bt=!0;if(Ke!=="comanda_itens"&&Ke!=="comanda_clientes"){const Kt=Tt?.codigo_empresa;Kt!=null&&Kt!==""&&(Bt=String(Kt)===String(W||""))}if(!Bt){try{console.log("[Realtime][Vendas] IGNORADO por empresa",{t:Ke,evt:it,rowEmpresa:Tt?.codigo_empresa,codigoEmpresa:W})}catch{}return}try{console.log("[Realtime][Vendas] payload recebido",{t:Ke,evt:it,row:Tt,codigoEmpresa:W})}catch{}(async()=>{try{await te({showToast:!1})}catch{}})()};if(oe.on("postgres_changes",{event:"*",schema:"public",table:"comandas"},Pe).on("postgres_changes",{event:"*",schema:"public",table:"comanda_itens"},Pe).on("postgres_changes",{event:"*",schema:"public",table:"comanda_clientes"},Pe).on("postgres_changes",{event:"*",schema:"public",table:"pagamentos",filter:`codigo_empresa=eq.${W}`},Pe).on("postgres_changes",{event:"*",schema:"public",table:"mesas"},Pe).subscribe(),O.current=oe,G.current)try{clearInterval(G.current)}catch{}return G.current=setInterval(async()=>{if(!Er.current)try{await te({showToast:!1})}catch{}},6e4),()=>{if(O.current){try{fe.removeChannel(O.current)}catch{}O.current=null}if(X.current){try{clearTimeout(X.current)}catch{}X.current=null}if(G.current){try{clearInterval(G.current)}catch{}G.current=null}}},[t?.codigo_empresa]);const Re=({table:W,provided:oe,isDragging:Pe})=>{const ze=Kat[W.status],Ke=ze.icon,Tt=Array.isArray(W.order)?W.order:[],it=Tt.filter(or=>String(or.id||"").startsWith("tmp-")).reduce((or,Hr)=>or+Number(Hr.quantity||0)*Number(Hr.price||0),0),Bt=Tt.filter(or=>!String(or.id||"").startsWith("tmp-")).reduce((or,Hr)=>or+Number(Hr.quantity||0)*Number(Hr.price||0),0),Kt=Number(W.totalHint||0);Te(W.customer);const Ct=W.status==="available"&&W.id===Fr,Or=W.status==="in-use"||W.status==="awaiting-payment"?(Kt>0?Kt:Bt)+it:0,jr=W.status==="available"?"text-success bg-success/10 border-success/30":W.status==="in-use"?"text-warning bg-warning/10 border-warning/30":"text-info bg-info/10 border-info/30";return a.jsxs("div",{ref:oe?.innerRef,"data-table-id":W.id,...oe?.draggableProps||{},className:mr("p-4 rounded-lg border bg-surface flex flex-col relative h-44 shadow-sm min-w-[240px]",Pe&&"shadow-lg",A==="tables"&&i?.id===W.id&&"ring-2 ring-brand/60 bg-surface-2",c?"cursor-pointer":"cursor-not-allowed opacity-60"),onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}_r(W)},children:[a.jsx("div",{...oe?.dragHandleProps||{},className:"absolute top-2 right-2 text-text-muted opacity-60 hover:opacity-100",children:a.jsx(_ue,{size:14})}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Ke,{className:"w-5 h-5 text-text-secondary"}),a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("span",{className:"text-lg font-semibold text-text-primary truncate",children:W.name?W.name:`Mesa ${W.number}`}),Ct&&a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(W.status==="in-use"||W.status==="awaiting-payment")&&W.aberto_em&&a.jsxs("div",{className:"flex items-center gap-0.5 text-xs text-text-secondary",children:[a.jsx(vd,{className:"w-3.5 h-3.5 text-text-muted"}),a.jsx("span",{className:"font-medium",children:(()=>{try{const or=new Date(W.aberto_em),Cr=new Date-or,Yr=Math.floor(Cr/6e4),vr=Math.floor(Yr/60),lr=Yr%60;return Yr<1?"agora":vr===0?`${lr}m`:vr>0&&lr===0?`${vr}h`:`${vr}h${lr}m`}catch{return""}})()})]}),a.jsx("span",{className:mr("text-[11px] font-medium px-2 py-0.5 rounded-full border flex-shrink-0",jr),children:ze.label})]})]}),a.jsx("div",{className:mr("flex-1 flex items-center justify-center"),children:W.status==="available"?a.jsx("img",{src:"/mesalivre.png",alt:"Mesa livre",className:mr("w-16 h-16 object-contain opacity-80",i?.id===W.id&&"opacity-100")}):W.status==="in-use"?a.jsx("img",{src:"/mesaocupada.png",alt:"Mesa ocupada",className:mr("w-16 h-16 object-contain opacity-80",i?.id===W.id&&"opacity-100")}):a.jsx("div",{className:mr("w-16 h-16 rounded-lg bg-info/20 border-2 border-info/40 flex items-center justify-center",i?.id===W.id&&"bg-info/30 border-info/60"),children:a.jsx(Gs,{className:"w-8 h-8 text-info"})})}),a.jsx("div",{className:"w-full mt-auto",children:W.status==="in-use"||W.status==="awaiting-payment"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[a.jsx(ml,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),a.jsx("div",{className:"text-sm sm:text-base font-medium text-text-primary truncate",title:W.customer||"",children:Te(W.customer)||""})]}),a.jsxs("div",{className:"flex items-center gap-1 justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ks,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),a.jsxs("div",{className:"text-sm font-bold text-text-secondary",children:["R$ ",Or.toFixed(2)]})]}),a.jsx("button",{onClick:or=>{or.stopPropagation(),n(`/historico?mesa=${W.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:a.jsx(Gs,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-xs text-text-muted",children:"Sem comanda"}),a.jsx("button",{onClick:or=>{or.stopPropagation(),n(`/historico?mesa=${W.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:a.jsx(Gs,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})})]})},rt=()=>{const W=i?Nn(i.order,i):0,[oe,Pe]=p.useState(!1),[ze,Ke]=p.useState([]),[Tt,it]=p.useState(1),[Bt,Kt]=p.useState([]),Ct=p.useRef(new Map),Or=typeof window<"u"&&window.innerWidth<=640,jr=p.useRef(!1),or=xr=>{const qr=String(xr||"").replace(/\D/g,"");return qr?Number(qr)/100:0},Hr=xr=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.max(0,Number(xr)||0)),Cr=xr=>{const qr=(He||[]).find(un=>String(un.id)===String(xr.methodId)),Kr=qr&&qr.taxa_percentual!=null?Number(qr.taxa_percentual):0;return Number.isFinite(Kr)?Kr/100:0},Yr=()=>(ze||[]).reduce((xr,qr)=>xr+or(qr.value),0);p.useEffect(()=>(Hn.current=Ke,$n.current=it,at.current=i?.comandaId||null,()=>{Hn.current=null,$n.current=null,at.current=null}),[i?.comandaId]),p.useEffect(()=>{Vt.current=ze||[]},[ze]);const vr=(xr,qr)=>{try{if(Or)return;const Kr=(ze||[]).findIndex(un=>un.id===qr);if(Kr>=0){const un=(ze||[])[Kr+1]||null;if(un&&Ct.current.get(un.id)){const on=Ct.current.get(un.id);setTimeout(()=>{try{on.focus(),on.select?.()}catch{}},0);return}}if(xr&&xr instanceof HTMLElement){const un=Array.from(document.querySelectorAll('input[data-pay-value="1"]')),on=un.indexOf(xr);if(on>=0&&un[on+1]){const sr=un[on+1];setTimeout(()=>{try{sr.focus(),sr.select?.()}catch{}},0);return}}jr.current=!0,Ke(un=>{const on=Bt[0]?.id||"",sr=He&&He[0]&&He[0].id?He[0].id:null,nn=Tt,ur=[...un,{id:nn,clientId:on,methodId:sr,value:"",chargeFee:!0}];return it(gr=>gr+1),Or||setTimeout(()=>{const gr=Ct.current.get(nn);if(gr)try{gr.focus(),gr.select?.()}catch{}},0),ur})}catch{}};p.useEffect(()=>{let xr=!0;return(async()=>{try{if(!Me||!i?.comandaId)return;let Kr=[],un=[];try{const[$r,Pn]=await Promise.all([UGe({comandaId:i.comandaId,status:"Pendente",codigoEmpresa:t?.codigo_empresa}).catch(()=>[]),ni({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa}).catch(()=>[])]);Kr=Array.isArray($r)?$r:[],un=(Array.isArray(Pn)?Pn:[]).map(Qr=>{const Bn=Qr?.cliente_id??Qr?.clientes?.id??Qr?.id??null,Pa=Qr?.clientes?.nome??Qr?.nome??Qr?.nome_livre??"";return!Bn&&Pa?{id:`livre-${Qr?.id||Math.random()}`,nome:Pa}:Bn?{id:Bn,nome:Pa}:null}).filter(Boolean)}catch{}if(!xr)return;if(Kt(un),Array.isArray(Kr)&&Kr.length>0){const $r=Kr.map((Pn,Ln)=>{const Qr=Number(Pn.valor||0),Pa={id:Ln+1,clientId:Pn.cliente_id||null,methodId:Pn.finalizadora_id||null,chargeFee:!0},Ja=Cr(Pa),po=Qr,Id=Pa.chargeFee!==!1?po*(1+Ja):po;return{...Pa,baseValue:po,value:Hr(Id)}});Ke($r),it($r.length+1),jr.current=!1;return}let on=He&&He[0]&&He[0].id?He[0].id:null,sr=un[0]?.id||null,nn="";try{const Pn=(await ds({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).reduce((Ln,Qr)=>Ln+Number(Qr.quantidade||0)*Number(Qr.preco_unitario||0),0);Pn>0&&(nn=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Pn))}catch{}const ur=or(nn),gr={id:1,clientId:sr,methodId:on,baseValue:ur,chargeFee:!0},Vr=Cr(gr),rn=gr.chargeFee?ur*(1+Vr):ur;Ke([{...gr,value:Hr(rn)}]),it(2),jr.current=!1}catch(Kr){console.error(Kr)}})(),()=>{xr=!1}},[Me,i?.comandaId]),p.useEffect(()=>{if(!Me||!i?.comandaId||!Array.isArray(ze)||ze.length===0||!jr.current)return;Fn.current&&clearTimeout(Fn.current);const xr=setTimeout(async()=>{if(jr.current)try{const qr=(ze||[]).map(Kr=>{const un=Number(Kr.baseValue||0),on=(He||[]).find(nn=>String(nn.id)===String(Kr.methodId)),sr=on?.tipo||on?.nome||"outros";return{clienteId:Kr.clientId||null,finalizadoraId:Kr.methodId||null,metodo:sr,valor:un}});ln.current=Date.now(),await nj({comandaId:i.comandaId,linhas:qr,codigoEmpresa:t?.codigo_empresa})}catch(qr){console.warn("[PayDialog] Falha ao salvar rascunho de pagamentos (debounced):",qr)}},400);return Fn.current=xr,()=>{clearTimeout(xr),Fn.current===xr&&(Fn.current=null)}},[Me,i?.comandaId,ze,He,t?.codigo_empresa]),p.useEffect(()=>{let xr=!0;return(async()=>{try{if(!Me||Array.isArray(He)&&He.length>0)return;const Kr=await Wm({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});if(!xr)return;ht(Kr||[])}catch{}})(),()=>{xr=!1}},[Me]),p.useEffect(()=>{Me&&(!Array.isArray(He)||He.length===0||Ke(xr=>{if(!Array.isArray(xr)||xr.length===0)return xr;const qr=He&&He[0]&&He[0].id?He[0].id:null;if(!qr)return xr;let Kr=!1;const un=xr.map(on=>{if(!on.methodId){Kr=!0;const sr={...on,methodId:qr},nn=Cr(sr),ur=sr.chargeFee!==!1?Number(sr.baseValue||0)*(1+nn):Number(sr.baseValue||0);return{...sr,value:Hr(ur)}}return on});return Kr?un:xr}))},[Me,He]);const lr=async()=>{try{if(!i?.comandaId)return;const xr=t?.codigo_empresa;if(!xr){e({title:"Empresa no definida",variant:"destructive"});return}if(!Array.isArray(ze)||ze.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const $r of ze){if(!$r.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(or($r.value)<=0){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}Nt(!0);const qr=W>0?W:0,Kr=(ze||[]).reduce(($r,Pn)=>$r+or(Pn.value),0),un=(ze||[]).reduce(($r,Pn)=>{const Ln=Number(Pn.baseValue||0),Qr=Cr(Pn);return $r+(Pn.chargeFee!==!1&&Qr>0?Ln*Qr:0)},0),on=qr+un,sr=Kr-on,nn=Math.abs(sr),ur=i.comandaId,gr=i.id;s($r=>$r.map(Pn=>Pn.id===gr?{...Pn,status:"available",order:[],comandaId:null,customer:null,totalHint:0}:Pn)),l($r=>$r&&$r.id===gr?null:$r),$e(!1);try{nr(!1)}catch{}let Vr=W;if(Vr<=0)try{Vr=(await ds({comandaId:ur,codigoEmpresa:t?.codigo_empresa})||[]).reduce((Ln,Qr)=>Ln+Number(Qr.quantidade||0)*Number(Qr.preco_unitario||0),0)}catch{}Pe(!0),Nt(!0),await _f({codigoEmpresa:t?.codigo_empresa});try{const $r=(ze||[]).map(Pn=>{const Ln=Number(Pn.baseValue||0),Qr=(He||[]).find(Pa=>String(Pa.id)===String(Pn.methodId)),Bn=Qr?.tipo||Qr?.nome||"outros";return{clienteId:Pn.clientId||null,finalizadoraId:Pn.methodId||null,metodo:Bn,valor:Ln}});await nj({comandaId:ur,linhas:$r,codigoEmpresa:xr})}catch($r){console.warn("[PayDialog] Falha ao salvar rascunho antes de promover:",$r)}await VGe({comandaId:ur,codigoEmpresa:xr}),await Xx({comandaId:ur,codigoEmpresa:t?.codigo_empresa,diferencaPagamento:sr});try{t?.codigo_empresa&&localStorage.removeItem(`vendas:tables:${t.codigo_empresa}`)}catch{}try{const $r=await Hm(t?.codigo_empresa),Pn=await yc({codigoEmpresa:t?.codigo_empresa}),Ln={};await Promise.all((Pn||[]).map(async Bn=>{try{const Ja=(await ni({comandaId:Bn.id,codigoEmpresa:t?.codigo_empresa})||[]).map(po=>po?.nome).filter(Boolean);Ln[Bn.id]=Ja.length?Ja.join(", "):null}catch{Ln[Bn.id]=null}}));const Qr=($r||[]).map(Bn=>{const Pa=(Pn||[]).find(Ja=>Ja.mesa_id===Bn.id);return{id:Bn.id,name:Bn.nome||`Mesa ${Bn.numero}`,status:Pa?"in-use":"available",comandaId:Pa?.id||null,customer:Pa?Ln[Pa.id]:null,order:[],totalHint:0,aberto_em:Pa?.aberto_em||null}});s(Qr)}catch{}const rn=nn>.009?sr>0?` | Diferena cobrada a mais: R$ ${nn.toFixed(2)}`:` | Diferena cobrada a menos: R$ ${nn.toFixed(2)}`:"";e({title:"Pagamento registrado",description:`Total itens R$ ${Vr.toFixed(2)} | Pagamentos R$ ${Kr.toFixed(2)}${rn}`,variant:"success"})}catch(xr){e({title:"Falha ao registrar pagamento",description:xr?.message||"Tente novamente",variant:"destructive"})}finally{Pe(!1),Nt(!1)}};ze&&ze.length>0;const ct=W>0?W:0,Zr=(ze||[]).reduce((xr,qr)=>xr+or(qr.value),0),cn=(ze||[]).reduce((xr,qr)=>{const Kr=Number(qr.baseValue||0),un=Cr(qr);return xr+(qr.chargeFee!==!1&&un>0?Kr*un:0)},0),Ia=ct+cn,Ca=Zr-Ia,cr=Math.abs(Ca);return a.jsx(xn,{open:Me,onOpenChange:$e,children:a.jsxs(vn,{className:"sm:max-w-xl w-[92vw] h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:xr=>xr.stopPropagation(),onKeyDownCapture:xr=>xr.stopPropagation(),onPointerDownOutside:xr=>xr.stopPropagation(),onInteractOutside:xr=>xr.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-2xl font-bold",children:"Fechar Conta"}),a.jsx(On,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),a.jsxs("div",{className:"space-y-2",children:[(()=>{let xr=0,qr=0,Kr=0;for(const sr of i?.order||[]){const nn=(sr.price||0)*(sr.quantity||1);xr+=nn,sr.desconto_tipo==="percentual"&&sr.desconto_valor>0?qr+=nn*(sr.desconto_valor/100):sr.desconto_tipo==="fixo"&&sr.desconto_valor>0&&(qr+=sr.desconto_valor)}const un=xr-qr;i?.desconto_tipo==="percentual"&&i?.desconto_valor>0?Kr=un*(i.desconto_valor/100):i?.desconto_tipo==="fixo"&&i?.desconto_valor>0&&(Kr=i.desconto_valor);const on=qr+Kr;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-8 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-secondary",children:"Subtotal"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",xr.toFixed(2)]})]}),on>0&&a.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[a.jsx("span",{children:"Descontos"}),a.jsxs("span",{className:"font-semibold",children:["-R$ ",on.toFixed(2)]})]})]}),a.jsxs("div",{className:"border-t border-border pt-1 flex items-center justify-between",children:[a.jsx("div",{className:"font-semibold",children:"Total"}),a.jsxs("div",{className:"font-bold text-lg",children:["R$ ",W.toFixed(2)]})]})]})})(),a.jsxs("div",{className:"flex items-center gap-8 text-xs text-text-muted pt-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"Pagamentos"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",Zr.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"Diferena"}),a.jsx("span",{className:cr>.009?Ca>0?"font-semibold text-emerald-600":"font-semibold text-amber-600":"font-semibold",children:cr>.009?`${Ca>0?"+":"-"} R$ ${cr.toFixed(2)}`:"R$ 0,00"})]})]}),a.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1",children:[a.jsx(De,{className:"block",children:"Pagamentos"}),(ze||[]).map((xr,qr)=>{const Kr=sr=>{if(!sr)return"Cliente";const nn=(Bt||[]).find(ur=>String(ur.id)===String(sr));return nn?.nome?nn.nome:"Cliente"},un=(Bt||[]).length>1,on=(Bt||[])[0]||null;return(Bt||[]).filter(sr=>String(sr.id)!==String(on?.id||"")),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-center",children:[a.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:ze.length>1&&qr>0&&a.jsx(ce,{type:"button",variant:"outline",size:"sm",className:"h-8 w-8",onClick:()=>{jr.current=!0,Ke(sr=>{const nn=sr.filter(rn=>rn.id!==xr.id);if(nn.length===0)return[];const ur=W>0?W:0,gr=Math.floor(ur/nn.length*100)/100,Vr=ur-gr*nn.length;return nn.map((rn,$r)=>{const Pn=$r===nn.length-1?gr+Vr:gr,Ln={...rn},Qr=Cr(Ln),Pa=Ln.chargeFee!==!1&&Qr>0?Pn/(1+Qr):Pn;return{...Ln,baseValue:Pa,value:Hr(Pn)}})})},children:""})}),qr===0?a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:Kr(on?.id||xr.clientId)})}):un?a.jsx("div",{className:"sm:col-span-4",children:a.jsxs(Cn,{value:xr.clientId||"",onValueChange:sr=>Ke(nn=>nn.map(ur=>ur.id===xr.id?{...ur,clientId:sr}:ur)),children:[a.jsx(jn,{className:"w-full truncate",children:a.jsx(An,{placeholder:"Cliente"})}),a.jsx(_n,{children:(Bt||[]).map(sr=>a.jsx(nt,{value:sr.id,children:sr.nome},sr.id))})]})}):a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:Kr(on?.id||xr.clientId)})}),a.jsx("div",{className:"sm:col-span-4",children:a.jsxs(Cn,{value:String(xr.methodId||""),onValueChange:sr=>{jr.current=!0;const nn=(ze||[]).map(ur=>{if(ur.id!==xr.id)return ur;const gr=String(sr),Vr={...ur,methodId:gr},rn=Cr(Vr),$r=Vr.chargeFee!==!1?Number(Vr.baseValue||0)*(1+rn):Number(Vr.baseValue||0);return{...Vr,value:Hr($r)}});Ke(nn);try{const ur=i?.comandaId,gr=t?.codigo_empresa;if(ur&&gr){const Vr=nn.map(rn=>{const $r=Number(rn.baseValue||0),Pn=(He||[]).find(Qr=>String(Qr.id)===String(rn.methodId)),Ln=Pn?.tipo||Pn?.nome||"outros";return{clienteId:rn.clientId||null,finalizadoraId:rn.methodId||null,metodo:Ln,valor:$r}});ln.current=Date.now(),nj({comandaId:ur,linhas:Vr,codigoEmpresa:gr}).then(()=>{}).catch(rn=>{console.warn("[PayDialog] Falha ao salvar rascunho aps troca de finalizadora (bg):",rn),jr.current=!0}),jr.current=!1}}catch(ur){console.warn("[PayDialog] Falha ao salvar rascunho aps troca de finalizadora:",ur)}},children:[a.jsx(jn,{className:"w-full truncate",children:a.jsx(An,{placeholder:"Forma de pagamento"})}),a.jsx(_n,{children:(He||[]).map(sr=>a.jsx(nt,{value:String(sr.id),children:sr.nome},String(sr.id)))})]})}),a.jsx("div",{className:"sm:col-span-3",children:a.jsx(Je,{placeholder:"0,00",inputMode:"numeric",value:xr.value,"data-pay-value":"1",ref:sr=>{sr?Ct.current.set(xr.id,sr):Ct.current.delete(xr.id)},onChange:sr=>{jr.current=!0;const nn=(sr.target.value||"").replace(/\D/g,""),ur=nn?Number(nn)/100:0;Ke(gr=>gr.map(Vr=>{if(Vr.id!==xr.id)return Vr;const rn=Cr(Vr),$r=Vr.chargeFee!==!1&&rn>0?ur/(1+rn):ur,Pn=Vr.chargeFee!==!1?$r*(1+rn):$r;return{...Vr,baseValue:$r,value:Hr(Pn)}}))},onKeyDown:sr=>{if(sr.stopPropagation(),sr.key==="Enter"){sr.preventDefault(),vr(sr.currentTarget,xr.id);return}["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(sr.key)||/^[0-9]$/.test(sr.key)||sr.preventDefault()},onBeforeInput:sr=>{const nn=sr.data??"";nn&&/\D/.test(nn)&&sr.preventDefault()}})}),a.jsx("div",{className:"sm:col-span-12 -mt-1 pl-1",children:(()=>{const sr=Cr(xr),nn=sr*100,ur=xr.chargeFee!==!1,gr=xr.baseValue!=null?Number(xr.baseValue):(()=>{const $r=(xr.value||"").toString().replace(/\D/g,""),Pn=$r?Number($r)/100:0;return ur&&sr>0?Pn/(1+sr):Pn})();if(!nn||nn<=0||!Number.isFinite(gr)||gr<=0)return null;const Vr=ur?gr*sr:0;return a.jsxs("button",{type:"button",onClick:async()=>{jr.current=!0;const rn=(ze||[]).map($r=>{if($r.id!==xr.id)return $r;const Pn=Cr($r),Ln=$r.chargeFee!==!1,Qr=$r.baseValue!=null?Number($r.baseValue):or($r.value),Bn=Ln?Qr:Qr*(1+Pn);return{...$r,chargeFee:!Ln,baseValue:Qr,value:Hr(Bn)}});Ke(rn);try{const $r=i?.comandaId,Pn=t?.codigo_empresa;if($r&&Pn){const Ln=rn.map(Qr=>({clienteId:Qr.clientId||null,finalizadoraId:Qr.methodId||null,metodo:(He||[]).find(Bn=>String(Bn.id)===String(Qr.methodId))?.tipo||(He||[]).find(Bn=>String(Bn.id)===String(Qr.methodId))?.nome||"outros",valor:Number(Qr.baseValue||0)}));ln.current=Date.now(),await nj({comandaId:$r,linhas:Ln,codigoEmpresa:Pn}),jr.current=!1}}catch($r){console.warn("[PayDialog] Falha ao salvar rascunho aps alternar taxa:",$r)}},className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",ur?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:ur?"Desmarcar taxa":"Cobrar taxa",children:[a.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",ur?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),a.jsxs("span",{children:["Taxa R$ ",Vr.toFixed(2)]})]})})()})]},xr.id)}),a.jsx("div",{children:a.jsx(ce,{type:"button",variant:"secondary",size:"sm",className:"pointer-events-auto",onPointerUp:xr=>{xr.preventDefault(),xr.stopPropagation(),jr.current=!0,Ke(qr=>{const Kr=Bt[0]?.id||"",un=He&&He[0]&&He[0].id?He[0].id:null,on=[...qr,{id:Tt,clientId:Kr,methodId:un,value:"",chargeFee:!0}],sr=W>0?W:0,nn=Math.floor(sr/on.length*100)/100,ur=sr-nn*on.length;return on.map((gr,Vr)=>{const rn=Vr===on.length-1?nn+ur:nn,$r=Cr(gr),Ln=gr.chargeFee!==!1&&$r>0?rn/(1+$r):rn;return{...gr,baseValue:Ln,value:Hr(rn)}})}),it(qr=>qr+1)},children:"Adicionar forma"})}),(()=>{const xr=Yr(),qr=(ze||[]).reduce((on,sr)=>{const nn=Number(sr.baseValue||0),ur=Cr(sr);return on+(sr.chargeFee!==!1&&ur>0?nn*ur:0)},0),un=(W>0?W:0)+qr-xr;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[a.jsx("span",{children:"Soma"}),a.jsxs("span",{children:["R$ ",xr.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[a.jsx("span",{children:"Restante"}),a.jsxs("span",{className:Math.abs(un)<.005?"text-success":"text-warning",children:["R$ ",un.toFixed(2)]})]})]})})()]})]}),a.jsxs(ra,{className:"sticky bottom-0 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/75",children:[a.jsx(ce,{type:"button",variant:"outline",onClick:()=>$e(!1),disabled:oe,children:"Cancelar"}),a.jsx(ce,{type:"button",onClick:lr,disabled:!(ze&&ze.length>0&&!oe),children:oe?"Processando...":"Confirmar Pagamento"})]})]})})},lt=_e.memo(({open:W,onOpenChange:oe,cashSummary:Pe})=>{const ze=ct=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(ct||0)),[Ke,Tt]=p.useState(!0);p.useEffect(()=>{Tt(!!W)},[W]);const it=p.useMemo(()=>{const ct=Number(Pe?.saldo_inicial??Pe?.saldoInicial??0),Zr=Pe?.totalPorFinalizadora||Pe?.porFinalizadora||{},cn=Number(Pe?.totalEntradas??Pe?.entradas??0),Ia=cn>0?cn:Object.values(Zr||{}).reduce((qr,Kr)=>qr+Number(Kr||0),0),Ca=Number(Pe?.sangria??Pe?.totalSangria??0),cr=Number(Pe?.totalSaidas??Pe?.saidas??Ca),xr=Math.max(0,ct+Ia-cr);return{saldoInicial:ct,porFinalizadora:Zr,entradasInformadas:cn,entradasCalc:Ia,sangriaVal:Ca,saidas:cr,saldoAtual:xr}},[Pe]);p.useEffect(()=>{if(W&&Pe){const ct=setTimeout(()=>Tt(!1),50);return()=>clearTimeout(ct)}},[W,Pe]);const{porFinalizadora:Bt,sangriaVal:Kt}=it,[Ct,Or]=p.useState(!1),[jr,or]=p.useState(""),[Hr,Cr]=p.useState(""),[Yr,vr]=p.useState(!1),lr=async()=>{try{vr(!0);const ct=String(jr||"").replace(/\D/g,""),Zr=ct?Number(ct)/100:0;if(Zr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await _f({codigoEmpresa:t?.codigo_empresa}),await jT({tipo:"sangria",valor:Zr,observacao:Hr,codigoEmpresa:t?.codigo_empresa}),Or(!1),or(""),Cr(""),await Wt(),e({title:"Sangria registrada",variant:"success"})}catch(ct){e({title:"Falha ao registrar sangria",description:ct?.message||"Tente novamente",variant:"destructive"})}finally{vr(!1)}};return a.jsx(xn,{open:W,onOpenChange:oe,children:a.jsxs(vn,{forceMount:!0,className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:ct=>ct.preventDefault(),onKeyDown:ct=>ct.stopPropagation(),onKeyDownCapture:ct=>ct.stopPropagation(),onPointerDownOutside:ct=>ct.stopPropagation(),onInteractOutside:ct=>ct.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),a.jsx(On,{children:"Resumo da sesso atual do caixa."})]}),Ke||!Pe?a.jsxs("div",{className:"px-4 space-y-3",children:[a.jsx(sv,{className:"h-16 w-full"}),a.jsx(sv,{className:"h-16 w-full"}),a.jsx(sv,{className:"h-12 w-full"})]}):a.jsxs("div",{className:"px-1",children:[Object.keys(Bt).length===0?a.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):a.jsxs(a.Fragment,{children:[a.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(Bt).map(([ct,Zr])=>a.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(ct)}),a.jsx("span",{className:"text-sm font-semibold tabular-nums",children:ze(Zr)})]},ct))}),a.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),a.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:ze(Kt)})]})]}),a.jsx("div",{className:"mt-3 text-xs text-text-muted leading-relaxed px-1",children:'Sadas incluem sangrias e ajustes. Use "Registrar Sangria" para lanar uma retirada.'})]}),a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"mr-auto"}),a.jsx(ce,{variant:"destructive",onClick:()=>Or(!0),children:"Registrar Sangria"}),a.jsx(ce,{variant:"secondary",onClick:()=>oe(!1),children:"Fechar"})]}),a.jsx(xn,{open:Ct,onOpenChange:Or,children:a.jsxs(vn,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:ct=>ct.stopPropagation(),onKeyDownCapture:ct=>ct.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-xl font-bold",children:"Registrar Sangria"}),a.jsx(On,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"sangria-valor",children:"Valor"}),a.jsx(Je,{id:"sangria-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:jr,onChange:ct=>{const Zr=(ct.target.value||"").replace(/\D/g,""),cn=Zr?Number(Zr)/100:0,Ia=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(cn);or(Ia)},onKeyDown:ct=>{ct.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(ct.key)&&(/^[0-9]$/.test(ct.key)||ct.preventDefault())},onBeforeInput:ct=>{const Zr=ct.data??"";Zr&&/\D/.test(Zr)&&ct.preventDefault()}})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"sangria-obs",children:"Observao"}),a.jsx(Je,{id:"sangria-obs",placeholder:"Opcional",value:Hr,onChange:ct=>Cr(ct.target.value)})]})]}),a.jsxs(ra,{children:[a.jsx(ce,{variant:"outline",onClick:()=>Or(!1),disabled:Yr,children:"Cancelar"}),a.jsx(ce,{onClick:lr,disabled:Yr,children:Yr?"Registrando...":"Confirmar"})]})]})})]})})}),$t=()=>{const W=async()=>{if(V)try{await Bv({itemId:V.id,codigoEmpresa:t?.codigo_empresa});try{await ot(i)}catch{}e({title:"Item removido",description:V.name,variant:"warning"})}catch(oe){e({title:"Falha ao remover item",description:oe?.message||"Tente novamente",variant:"destructive"})}finally{ue(!1),B(null)}};return a.jsx(Yd,{open:J,onOpenChange:ue,children:a.jsxs(nd,{children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Remover item?"}),a.jsxs(id,{children:['Tem certeza que deseja remover "',V?.name,'" da comanda? Esta ao no pode ser desfeita.']})]}),a.jsxs(od,{children:[a.jsx(ld,{children:"Cancelar"}),a.jsx(Jd,{onClick:W,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})})},Fe=()=>{const W=i,oe=W?.order||[],Pe=W?Nn(oe):0;return a.jsx(xn,{open:q,onOpenChange:Q,children:a.jsxs(vn,{className:"sm:max-w-xl w-[92vw] animate-none",onKeyDown:ze=>ze.stopPropagation(),onKeyDownCapture:ze=>ze.stopPropagation(),onPointerDownOutside:ze=>ze.stopPropagation(),onInteractOutside:ze=>ze.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsxs(fn,{className:"text-2xl font-bold",children:["Comanda da Mesa ",W?.number??""]}),a.jsx(On,{children:W?.customer?`Cliente: ${W.customer}`:"Sem cliente vinculado"})]}),a.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto thin-scroll",children:oe.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhum item na comanda."}):a.jsx("ul",{className:"divide-y divide-border",children:oe.map(ze=>a.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:ze.name}),a.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",ze.quantity,"  Unit: R$ ",Number(ze.price||0).toFixed(2)]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("div",{className:"font-semibold",children:["R$ ",(Number(ze.price||0)*Number(ze.quantity||0)).toFixed(2)]})})]},ze.id))})}),a.jsxs(ra,{children:[a.jsxs("div",{className:"mr-auto text-sm font-semibold",children:["Total: R$ ",Pe.toFixed(2)]}),a.jsx(ce,{variant:"secondary",onClick:()=>Q(!1),children:"Fechar"}),W?.comandaId&&a.jsxs(ce,{variant:"outline",onClick:()=>window.open(`/print-comanda?comanda=${W.comandaId}`,"_blank"),children:[a.jsx(UH,{className:"mr-2 h-4 w-4"})," Imprimir"]}),a.jsxs(ce,{onClick:async()=>{Q(!1),await mn()},disabled:!W||oe.length===0,children:[a.jsx(Ks,{className:"mr-2 h-4 w-4"})," Fechar Conta",a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]})})},It=p.useMemo(()=>Fe,[i?.id,q]),Sr=({table:W})=>{const[oe,Pe]=p.useState(""),[ze,Ke]=p.useState(!1),[Tt,it]=p.useState(!1),Bt=async()=>{if(!(!W?.comandaId||ze))try{Ke(!0),await eKe({comandaId:W.comandaId,observacoes:oe,codigoEmpresa:Number(t?.codigo_empresa)}),e({title:"Observaes salvas",description:"As observaes da comanda foram atualizadas."});try{await ot(W)}catch(Kt){console.error("Erro ao recarregar detalhes da comanda aps salvar observaes:",Kt)}}catch(Kt){Kt?.code!=="42804"&&(console.error("Erro ao salvar observao:",Kt),e({title:"Erro ao salvar observaes",description:"Tente novamente mais tarde.",variant:"destructive"}))}finally{Ke(!1)}};return p.useEffect(()=>{if(!W?.comandaId){Pe("");return}Pe(W.observacoes||"")},[W?.comandaId,W?.observacoes]),W?a.jsxs("div",{className:"flex flex-col h-full p-4 space-y-4 overflow-y-auto thin-scroll",children:[W.order&&W.order.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(De,{className:"text-sm font-semibold",children:"Descontos por Item"}),a.jsx(ce,{size:"xs",variant:"ghost",className:"h-6 px-2 text-[11px]",onClick:()=>it(Kt=>!Kt),children:Tt?"Esconder":`Mostrar (${W.order.length})`})]}),Tt&&a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:W.order.map(Kt=>a.jsx("button",{onClick:()=>Dt(Kt),className:"w-full p-3 rounded border border-border bg-surface hover:bg-surface-2 transition text-left",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-sm font-semibold truncate",children:Kt.name}),a.jsxs("p",{className:"text-xs text-text-secondary",children:["Qtd: ",Kt.quantity,"  R$ ",(Kt.price||0).toFixed(2)]})]}),a.jsx("div",{className:"text-right flex-shrink-0",children:Kt.desconto_valor>0?a.jsxs("span",{className:"text-xs font-bold text-destructive",children:["-",Kt.desconto_tipo==="percentual"?Kt.desconto_valor+"%":"R$"+(Kt.desconto_valor||0).toFixed(2)]}):a.jsx("span",{className:"text-xs text-text-muted",children:"Sem desconto"})})]})},Kt.id))})]}),W.comandaId&&a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx(De,{className:"text-sm font-semibold",children:"Observaes"}),ze&&a.jsx("span",{className:"text-[11px] text-text-secondary",children:"Salvando..."})]}),a.jsx("textarea",{className:"border border-border rounded p-3 text-sm resize-none bg-background min-h-20",placeholder:"Ex: sem cebola, urgente, etc.",value:oe,onChange:Kt=>{const Ct=Kt.target.value;Pe(Ct)},onKeyDown:async Kt=>{Kt.key==="Enter"&&!Kt.shiftKey&&(Kt.preventDefault(),await Bt())}})]}),W.comandaId&&a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{className:"text-sm font-semibold",children:"Desconto da Comanda"}),a.jsx(ce,{size:"sm",variant:W.desconto_valor>0?"default":"outline",onClick:()=>ye(!0),className:"w-full gap-2",children:W.desconto_valor>0?a.jsxs(a.Fragment,{children:[a.jsx("span",{children:"Desconto Ativo:"}),a.jsxs("span",{className:"font-bold",children:["-",W.desconto_tipo==="percentual"?W.desconto_valor+"%":"R$"+W.desconto_valor.toFixed(2)]})]}):"Aplicar Desconto"}),W.desconto_motivo&&a.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded border border-border",children:[a.jsx("strong",{children:"Motivo:"})," ",W.desconto_motivo]})]})]}):a.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Gs,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),a.jsx("p",{children:"Selecione uma mesa"})]})})},kr=({table:W})=>{if(!W)return a.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Gv,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),a.jsx("p",{children:"Selecione uma mesa para ver a comanda"})]})});if(Nr)return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[a.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(ce,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}he(W),ie(!0)},children:"Abrir Mesa"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:[a.jsx(sv,{className:"h-20 w-full"}),a.jsx(sv,{className:"h-20 w-full"}),a.jsx(sv,{className:"h-20 w-full"})]}),a.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[a.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary mb-2",children:[a.jsx("span",{children:"Total"}),a.jsx("span",{children:"R$ 0,00"})]}),a.jsx(ce,{size:"lg",className:"w-full",disabled:!c,children:"Fechar Conta"})]})]});const oe=Nn(W.order,W),Pe=Te(W.customer),ze=async()=>{if(!W?.comandaId)return;const Bt=(await ds({comandaId:W.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(jr=>({id:jr.id,productId:jr.produto_id,name:jr.descricao||"Item",price:Number(jr.preco_unitario||0),quantity:Number(jr.quantidade||1)})),Kt=(Bt||[]).reduce((jr,or)=>jr+Number(or.price||0)*Number(or.quantity||0),0);let Ct=W.customer||null;try{const or=(await ni({comandaId:W.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Hr=>Hr?.nome).filter(Boolean);Ct=or.length?or.join(", "):null}catch{}const Or={...W,order:Bt,customer:Ct,totalHint:Kt};l(Or),s(jr=>jr.map(or=>or.id===Or.id?Or:or))},Ke=async(it,Bt)=>{try{const Ct=Number(it.quantity||1)+Bt;if(Ct<=0){B(it),ue(!0),setTimeout(async()=>{J||await ze()},100);return}const Or=Number(it.price||0)*Number(Bt||0);Or&&(l(jr=>jr&&{...jr,totalHint:Math.max(0,Number(jr.totalHint||0)+Or)}),s(jr=>jr.map(or=>or.id===i?.id?{...or,totalHint:Math.max(0,Number(or.totalHint||0)+Or)}:or))),await ed({itemId:it.id,quantidade:Ct,codigoEmpresa:t?.codigo_empresa}),await ze(),e({title:"Quantidade atualizada",description:`${it.name}: ${Ct}`,variant:"success"})}catch(Kt){e({title:"Falha ao atualizar quantidade",description:Kt?.message||"Tente novamente",variant:"destructive"})}},Tt=async it=>{B(it),ue(!0),setTimeout(async()=>{J||await ze()},100)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col h-full",onMouseDown:it=>{it.target===it.currentTarget&&it.preventDefault()},children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-center md:justify-between gap-2",children:[Pe?a.jsx("div",{className:"hidden sm:block text-sm font-medium text-text-primary leading-none truncate",title:W.customer||"",children:Pe}):a.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),a.jsx("div",{className:"flex items-center gap-2",children:W.comandaId?a.jsxs(a.Fragment,{children:[a.jsxs(ce,{size:"sm",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all flex items-center",onClick:()=>{be(!0);try{w(!1)}catch{}try{H(!1)}catch{}try{$e(!1)}catch{}try{nr(!1)}catch{}try{Q(!1)}catch{}},children:[a.jsx(ml,{size:12,className:"text-white/80 mr-1.5"}),"Clientes"]}),a.jsxs(ce,{size:"sm",variant:"outline",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all",onClick:()=>Q(!0),children:[a.jsx("span",{className:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-black/40 border border-white/10 mr-1.5",children:a.jsx(Gs,{size:12,className:"text-white/80"})}),"Comanda"]}),a.jsxs(Yd,{children:[a.jsx(Ap,{asChild:!0,children:a.jsx(ce,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",children:"Cancelar"})}),a.jsxs(nd,{className:"sm:max-w-[420px] animate-none",onKeyDown:it=>it.stopPropagation(),children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Cancelar comanda?"}),a.jsx(id,{children:"Esta ao no pode ser desfeita. Os itens sero descartados e a mesa voltar a ficar livre."})]}),a.jsxs(od,{children:[a.jsx(ld,{children:"Voltar"}),a.jsx(Jd,{disabled:st,onClick:async it=>{const Bt=it.currentTarget.closest('[role="alertdialog"]');Bt&&Bt.querySelector("[data-radix-collection-item]")?.click();try{ut(!0);const Kt=t?.codigo_empresa;if(Kt)try{localStorage.removeItem(`vendas:selected:${Kt}`),localStorage.removeItem(`vendas:tables:${Kt}`)}catch{}await cz({comandaId:W.comandaId,codigoEmpresa:Kt}),l(null);try{nr(!1)}catch{}await te({showToast:!1}),e({title:"Comanda cancelada",variant:"success"})}catch(Kt){console.error("[Cancelar Comanda] Erro:",Kt),e({title:"Falha ao cancelar comanda",description:Kt?.message||"Tente novamente",variant:"destructive"});try{await te({showToast:!1})}catch(Ct){console.error("[Cancelar Comanda] Erro ao recarregar aps falha:",Ct)}}finally{ut(!1)}},children:"Confirmar Cancelamento"})]})]})]})]}):a.jsx(ce,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}he(W),ie(!0)},children:"Abrir Mesa"})})]}),a.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-3 thin-scroll",children:W.order.length===0?a.jsx("div",{className:"text-center text-text-muted pt-16",children:a.jsx("p",{children:"Comanda vazia. Adicione produtos na aba ao lado."})}):a.jsx("ul",{className:"space-y-3",children:W.order.map(it=>a.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("p",{className:"text-sm font-semibold text-text-primary truncate",title:it.name,children:it.name})}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ce,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>Ke(it,-1),children:a.jsx(Ev,{size:12})}),a.jsx("span",{className:"w-7 text-center font-semibold text-sm",children:it.quantity}),a.jsx(ce,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>Ke(it,1),children:a.jsx(ro,{size:12})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"text-right flex-1",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsxs("span",{className:"font-bold text-text-primary",children:["R$ ",(it.price*it.quantity).toFixed(2)]}),it.desconto_valor>0&&a.jsxs("span",{className:"text-xs font-semibold text-destructive",children:["-",it.desconto_tipo==="percentual"?it.desconto_valor+"%":"R$"+(it.desconto_valor||0).toFixed(2)]})]})}),a.jsx(ce,{variant:"ghost",size:"icon",className:"text-danger/80 hover:text-danger h-7 w-7",onClick:()=>Tt(it),children:a.jsx(Bu,{size:14})})]})]})]},it.id))})}),a.jsxs("div",{className:"p-3 border-t border-border mt-auto space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",oe.toFixed(2)]})]}),a.jsxs(ce,{size:"lg",className:"w-full",onClick:mn,children:[a.jsx(Ks,{className:"mr-2"})," Fechar Conta",a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]}),a.jsx(rt,{})]})},pr=()=>{const[W,oe]=p.useState(""),[Pe,ze]=p.useState(""),Ke=async()=>{try{if(ge)return;le(!0);const Tt=(W??"").toString().trim(),it=Tt?Number(Tt):void 0;if(it!==void 0&&(Number.isNaN(it)||it<=0)){e({title:"Nmero invlido",description:"Informe um nmero positivo.",variant:"warning"});return}const Bt=await WGe({numero:it,nome:(Pe||"").trim()||void 0,codigoEmpresa:t?.codigo_empresa}),Kt={id:Bt.id,number:Bt.numero,name:Bt.nome,status:"available",order:[],customer:null,comandaId:null,totalHint:0};s(Ct=>(Ct.some(or=>or.id===Kt.id)?Ct.map(or=>or.id===Kt.id?Kt:or):[...Ct,Kt]).slice().sort((or,Hr)=>Number(or.number)-Number(Hr.number))),_e.startTransition(()=>{l(Kt),Le(!1)}),e({title:"Mesa criada",description:`Mesa ${Bt.numero} adicionada`,variant:"success"}),oe(""),ze("")}catch(Tt){e({title:"Falha ao criar mesa",description:Tt?.message||"Tente novamente",variant:"destructive"})}finally{le(!1)}};return a.jsx(xn,{open:de,onOpenChange:Tt=>{Le(Tt),Tt||(oe(""),ze(""))},children:a.jsxs(vn,{className:"sm:max-w-md w-[92vw]",children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-2xl font-bold",children:"Nova Mesa"}),a.jsx(On,{children:"Informe o nome da mesa. Se deixar em branco, ser criada com numerao automtica."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(De,{htmlFor:"nova-mesa-nome",children:"Nome da mesa"}),a.jsx(Je,{id:"nova-mesa-nome",type:"text",placeholder:"Ex: Mesa 1, Varanda, etc.",value:Pe,onChange:Tt=>ze(Tt.target.value),onKeyDown:Tt=>{Tt.stopPropagation(),Tt.key==="Enter"&&!ge&&(Tt.preventDefault(),Ke())},onKeyPress:Tt=>Tt.stopPropagation()})]}),a.jsxs(ra,{children:[a.jsx(ce,{type:"button",variant:"outline",onClick:()=>Le(!1),disabled:ge,children:"Cancelar"}),a.jsx(ce,{type:"button",onClick:Ke,disabled:ge,children:ge?"Criando...":"Criar Mesa"})]})]})})},yn=async W=>{try{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}if(!i?.comandaId){e({title:"Selecione uma mesa",description:"Abra a comanda clicando na mesa primeiro.",variant:"destructive"});return}const oe=Number(W.stock??W.currentStock??0),Pe=y.get(String(W.id))||0,ze=Math.max(0,oe-Pe);if(((i?.order||[]).find(Cr=>String(Cr.productId)===String(W.id))?.quantity||0)+1>ze){e({title:"Estoque insuficiente",description:`${W.name} - Estoque disponvel: ${ze} (${oe} total, ${Pe} reservado em outras comandas)`,variant:"destructive"});return}const it=Number(W.salePrice??W.price??0),Kt=(await ds({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).find(Cr=>String(Cr.produto_id)===String(W.id));let Ct;if(Kt){const Cr=Number(Kt.quantidade||0);await ed({itemId:Kt.id,quantidade:Cr+1,codigoEmpresa:t?.codigo_empresa}),Ct={id:Kt.id,productId:Kt.produto_id,name:Kt.descricao||W.name,price:it,quantity:Cr+1}}else Ct=await _T({comandaId:i.comandaId,produtoId:W.id,descricao:W.name,quantidade:1,precoUnitario:it,codigoEmpresa:t?.codigo_empresa});const jr=(await ds({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Cr=>({id:Cr.id,productId:Cr.produto_id,name:Cr.descricao||"Item",price:Number(Cr.preco_unitario||0),quantity:Number(Cr.quantidade||1)})),or=(jr||[]).reduce((Cr,Yr)=>Cr+Number(Yr.price||0)*Number(Yr.quantity||0),0),Hr={...i,order:jr,totalHint:or};l(Hr),s(Cr=>Cr.map(Yr=>Yr.id===Hr.id?Hr:Yr));try{const Cr=await Mm({codigoEmpresa:t?.codigo_empresa}),Yr=new Map;for(const vr of Cr||[]){const lr=String(vr.produto_id),ct=Number(vr.quantidade||0);Yr.set(lr,(Yr.get(lr)||0)+ct)}x(Yr)}catch(Cr){console.error("[addProductToComanda] Erro ao atualizar estoque reservado:",Cr)}gt(W.id),setTimeout(()=>{gt(Cr=>Cr===W.id?null:Cr)},500),e({title:"Produto adicionado",variant:"success"})}catch(oe){console.error("[addProductToComanda] EXCEPTION:",oe),e({title:"Falha ao adicionar produto",description:oe?.message||"Tente novamente",variant:"destructive"})}},In=()=>{const[W,oe]=p.useState(""),[Pe,ze]=p.useState("all"),Ke=p.useRef(null),Tt=p.useRef(0),it=p.useRef(null),Kt=(Ne||[]).slice().sort((Ct,Or)=>{const jr=Ct.code||"",or=Or.code||"";return/^\d+$/.test(jr)&&/^\d+$/.test(or)?parseInt(jr,10)-parseInt(or,10):jr.localeCompare(or)}).filter(Ct=>{const Or=W.trim().toLowerCase(),jr=!Or||(Ct.name||"").toLowerCase().includes(Or)||String(Ct.code||"").toLowerCase().includes(Or);if(Pe==="all")return jr;const or=Number(Ct.stock??Ct.currentStock??0),Hr=y.get(String(Ct.id))||0,Cr=Math.max(0,or-Hr);return Pe==="available"?jr&&Cr>0:Pe==="low"?jr&&Cr>0&&Cr<=5:Pe==="out"?jr&&Cr<=0:jr});return i?a.jsx(xn,{open:b,onOpenChange:Ct=>{if(w(Ct),P(Ct?"panel":"tables"),Ct)try{nr(!1)}catch{}},children:a.jsxs(vn,{overlayClassName:"z-[88]",className:"w-[95vw] sm:max-w-4xl max-h-[80vh] sm:max-h-[85vh] flex flex-col p-0 gap-0 focus:outline-none focus-visible:outline-none !overflow-visible z-[89]",style:{scrollBehavior:"auto"},onOpenAutoFocus:Ct=>{Ct.preventDefault(),P("panel")},onWheel:Ct=>{Ct.stopPropagation()},onKeyDown:Ct=>{const Or=Ct.target,jr=Or&&(Or.tagName==="INPUT"||Or.closest("input")),or=Or&&Or.closest("[data-product-card]");if(!["ArrowDown","ArrowUp","Home","End","Enter","Delete","Escape"].includes(Ct.key)||jr||or)return;Ct.preventDefault(),Ct.stopPropagation();const Hr=C||0,Cr=Kt.length;if(Ct.key==="ArrowDown"){const Yr=Math.min(Hr+1,Cr-1);E(Yr),Tt.current=Yr,requestAnimationFrame(()=>j.current[Yr]?.focus());return}if(Ct.key==="ArrowUp"){const Yr=Math.max(Hr-1,0);E(Yr),Tt.current=Yr,requestAnimationFrame(()=>j.current[Yr]?.focus());return}if(Ct.key==="Home"){E(0),Tt.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(Ct.key==="End"){const Yr=Math.max(0,Cr-1);E(Yr),Tt.current=Yr,requestAnimationFrame(()=>j.current[Yr]?.focus());return}if(Ct.key==="Escape"){w(!1);return}},children:[a.jsxs(pn,{className:"px-6 py-4 border-b border-border",children:[a.jsxs(fn,{className:"text-2xl font-bold flex items-center gap-3",children:[a.jsx(Gv,{className:"w-6 h-6 text-brand"}),"Adicionar Produtos"]}),a.jsxs(On,{className:"text-base mt-2",children:["Mesa ",i.number,"  ",Te(i.customer)||"Sem cliente"]})]}),a.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-border bg-surface/50",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted"}),a.jsx("input",{ref:Ke,type:"text",className:"w-full pl-10 pr-4 py-3 text-base rounded-lg bg-background border-2 border-border focus:border-brand focus:ring-2 focus:ring-brand/20 transition-all outline-none",placeholder:"Digite o nome ou cdigo do produto...",value:W,onChange:Ct=>oe(Ct.target.value),onClick:Ct=>{Ct.stopPropagation(),Ct.currentTarget.focus(),P("panel")},onFocus:Ct=>{Ct.stopPropagation(),P("panel")},onKeyDown:Ct=>{if(Ct.stopPropagation(),Ct.nativeEvent&&typeof Ct.nativeEvent.stopImmediatePropagation=="function"&&Ct.nativeEvent.stopImmediatePropagation(),P("panel"),["ArrowDown","ArrowUp","Home","End","Escape"].includes(Ct.key)){Ct.preventDefault();const Or=C||0,jr=Kt.length;if(Ct.key==="ArrowDown"){E(Math.min(Or+1,jr-1));return}if(Ct.key==="ArrowUp"){E(Math.max(Or-1,0));return}if(Ct.key==="Home"){E(0);return}if(Ct.key==="End"){E(jr-1);return}if(Ct.key==="Escape"){w(!1);return}}}})]}),a.jsxs("div",{className:"flex items-center justify-between gap-4 mt-3",children:[a.jsx("button",{onClick:()=>ze("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${Pe==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),a.jsx("button",{onClick:()=>ze("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${Pe==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),a.jsx("button",{onClick:()=>ze("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${Pe==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),a.jsx("button",{onClick:()=>ze("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${Pe==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"}),a.jsxs("div",{className:"hidden sm:flex items-center gap-2 ml-auto text-xs text-text-muted flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:""}),a.jsx("span",{children:"Navegar"})]}),a.jsx("div",{className:"w-px h-3 bg-border"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:"Esc"}),a.jsx("span",{children:"Fechar"})]})]})]})]}),a.jsx("div",{ref:it,className:"flex-1 overflow-y-auto px-6 py-4 focus:outline-none",tabIndex:-1,onKeyDown:Ct=>{["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(Ct.key)&&(Ct.preventDefault(),Ct.stopPropagation(),Ct.nativeEvent&&typeof Ct.nativeEvent.stopImmediatePropagation=="function"&&Ct.nativeEvent.stopImmediatePropagation()),Ct.stopPropagation();const Or=Ct.target,jr=Or&&(Or.tagName==="INPUT"||Or.closest("input"));if(!["ArrowDown","ArrowUp","Home","End","Escape"].includes(Ct.key)||jr)return;const or=C||0,Hr=Kt.length;if(Ct.key==="ArrowDown"){const Cr=Math.min(or+1,Hr-1);E(Cr),Tt.current=Cr,requestAnimationFrame(()=>j.current[Cr]?.focus());return}if(Ct.key==="ArrowUp"){const Cr=Math.max(or-1,0);E(Cr),Tt.current=Cr,requestAnimationFrame(()=>j.current[Cr]?.focus());return}if(Ct.key==="Home"){E(0),Tt.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(Ct.key==="End"){const Cr=Math.max(0,Hr-1);E(Cr),Tt.current=Cr,requestAnimationFrame(()=>j.current[Cr]?.focus());return}if(Ct.key==="Escape"){w(!1);return}},children:Kt.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[a.jsx(Gv,{className:"w-16 h-16 text-text-muted mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto encontrado"}),a.jsx("p",{className:"text-text-muted mb-4",children:"Tente ajustar sua busca ou cadastre novos produtos"}),a.jsxs(ce,{onClick:()=>{w(!1),n("/produtos")},children:[a.jsx(ro,{className:"w-4 h-4 mr-2"}),"Cadastrar Produtos"]})]}):a.jsx("div",{className:"flex flex-col gap-1.5",children:Kt.map((Ct,Or)=>{const jr=(i?.order||[]).reduce((lr,ct)=>lr+(String(ct.productId)===String(Ct.id)?Number(ct.quantity||0):0),0),or=Number(Ct.stock??Ct.currentStock??0),Hr=y.get(String(Ct.id))||0,Cr=Math.max(0,or-Hr),Yr=Or===C,vr=Ct.id===mt;return a.jsxs("div",{ref:lr=>{j.current[Or]=lr},"data-product-card":!0,className:mr("flex items-center gap-2 sm:gap-4 p-2.5 sm:p-3 rounded-lg border-2 transition-colors duration-500 outline-none focus:outline-none focus-visible:outline-none",Cr===0&&jr===0?"opacity-50 cursor-not-allowed bg-surface-2 border-border":"cursor-pointer",Yr?"border-brand bg-brand/5 shadow-md":Cr>0?"border-border bg-surface hover:border-brand/50 hover:bg-surface-2":jr>0?"border-border bg-surface":"border-border",vr&&"bg-brand/8"),tabIndex:Cr>0||jr>0?0:-1,onKeyDown:lr=>{if(["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(lr.key)&&(lr.preventDefault(),lr.stopPropagation(),lr.nativeEvent&&typeof lr.nativeEvent.stopImmediatePropagation=="function"&&lr.nativeEvent.stopImmediatePropagation()),!["ArrowDown","ArrowUp","Home","End","Escape"].includes(lr.key))return;lr.stopPropagation();const ct=Kt.length;if(lr.key==="ArrowDown"){const Zr=Math.min(Or+1,ct-1);E(Zr),Tt.current=Zr,requestAnimationFrame(()=>j.current[Zr]?.focus());return}if(lr.key==="ArrowUp"){const Zr=Math.max(Or-1,0);E(Zr),Tt.current=Zr,requestAnimationFrame(()=>j.current[Zr]?.focus());return}if(lr.key==="Home"){E(0),Tt.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(lr.key==="End"){const Zr=Math.max(0,ct-1);E(Zr),Tt.current=Zr,requestAnimationFrame(()=>j.current[Zr]?.focus());return}if(lr.key==="Escape"){w(!1);return}},onClick:()=>{Cr===0&&jr===0||(E(Or),Tt.current=Or,requestAnimationFrame(()=>j.current[Or]?.focus()))},onMouseDown:lr=>{if(Cr===0&&jr===0){lr.preventDefault();return}lr.currentTarget.focus()},children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Ct.code&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-mono font-semibold bg-surface-2 border border-border rounded",children:Ct.code}),a.jsx("h4",{className:"font-semibold text-sm sm:text-base text-text-primary truncate",children:Ct.name})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px] sm:text-xs mt-0.5",children:[a.jsx("span",{className:mr("font-bold",Cr===0?"text-text-muted":"text-brand"),children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Ct.salePrice??Ct.price??0))}),a.jsxs("span",{className:"text-text-muted whitespace-nowrap",children:["Estoque: ",a.jsx("span",{className:mr("font-semibold",Cr<=5?"text-destructive":"text-text-secondary"),children:Cr})]}),jr>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-brand/10 text-brand text-[11px] font-semibold rounded whitespace-nowrap",children:[jr,"x na comanda"]})]})]}),a.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[a.jsx(ce,{size:"icon",variant:"outline",onClick:lr=>{lr.stopPropagation(),Yt(Ct)},disabled:jr===0,className:"h-8 w-8 p-0",children:a.jsx(Ev,{className:"w-4 h-4"})}),a.jsx(ce,{size:"icon",onClick:lr=>{lr.stopPropagation(),yn(Ct)},disabled:Cr===0,className:"h-8 w-8 p-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",children:a.jsx(ro,{className:"w-4 h-4"})})]})]},Ct.id)})},(i?.order||[]).map(Ct=>`${String(Ct.productId)}:${Number(Ct.quantity||0)}`).join("|"))}),a.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t border-border bg-surface/50",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2",children:[a.jsxs("div",{className:"hidden sm:block text-sm text-text-muted",children:[Kt.length," produto",Kt.length!==1?"s":"","  ",(i.order||[]).length," ite",(i.order||[]).length!==1?"ns":"m"," na comanda"]}),a.jsxs("div",{className:"flex items-center justify-end gap-3 w-full sm:w-auto",children:[a.jsxs("div",{className:"text-left sm:text-right",children:[a.jsx("div",{className:"text-xs text-text-muted",children:"Total"}),a.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i.totalHint||0)})]}),a.jsx(ce,{onClick:()=>w(!1),className:"px-4 sm:px-6 min-w-[96px] sm:min-w-[120px]",size:"sm",children:"Concluir"})]})]})})]})]})}):null},[Xn,En]=p.useState(null),[dn,Gr]=p.useState([]),[ga,Ma]=p.useState(!1),[va,$a]=p.useState(""),[ss,ao]=p.useState(!1),[xo,Ss]=p.useState([]),[mi,kd]=p.useState(!1),[hi,zc]=p.useState(null),[Oi,Nl]=p.useState([]),[rf,Zl]=p.useState(!1),[Ro,yo]=p.useState(null),nf=p.useRef(null);p.useEffect(()=>{nf.current=Xn},[Xn]);const xu=p.useMemo(()=>{const W=new Map;for(const oe of dn||[]){const Pe=oe.productId,ze=Number(oe.quantity||0);W.set(Pe,(W.get(Pe)||0)+ze)}return W},[dn]),Fs=async W=>{if(!W)return;const Pe=(await ds({comandaId:W,codigoEmpresa:t?.codigo_empresa})||[]).map(ze=>({id:ze.id,productId:ze.produto_id,name:ze.descricao||"Item",price:Number(ze.preco_unitario||0),quantity:Number(ze.quantidade||1)}));Gr(Pe)},pi=async W=>{try{const oe=t?.codigo_empresa;if(!oe){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}let Pe=Xn;if(!Pe){if(Pe=(await Jj({codigoEmpresa:oe}))?.id,!Pe){e({title:"Falha ao iniciar venda no balco",description:"No foi possvel criar ou recuperar a comanda.",variant:"destructive"});return}En(Pe)}const ze=Number(W.salePrice??W.price??0);await _T({comandaId:Pe,produtoId:W.id,descricao:W.name,quantidade:1,precoUnitario:ze,codigoEmpresa:oe}),await Fs(Pe),e({title:"Produto adicionado (balco)",description:W.name,variant:"success"})}catch(oe){e({title:"Falha ao adicionar produto (balco)",description:oe?.message||"Tente novamente",variant:"destructive"})}},af=async W=>{if(!(!Xn||!W)){ao(!1);try{await lb({comandaId:Xn,clienteIds:[W],nomesLivres:[],codigoEmpresa:t?.codigo_empresa}),zc(W),Nl(oe=>{const Pe=new Set((oe||[]).map(ze=>String(ze)));return Pe.add(String(W)),Array.from(Pe)}),$a(""),Ss([]),e({title:"Cliente associado",variant:"success"})}catch(oe){e({title:"Falha ao associar cliente",description:oe?.message||"Tente novamente",variant:"destructive"}),ao(!0)}}},Ji=async()=>{if(Xn)try{const W=Nn(dn,null);if(W<=0){e({title:"Sem itens",description:"Adicione itens antes de pagar.",variant:"warning"});return}Ma(!0),await _f({codigoEmpresa:t?.codigo_empresa});let oe=He;if(!Array.isArray(oe)||oe.length===0)try{oe=await Wm({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa}),ht(oe)}catch{}const Pe=oe?.[0],ze=Pe?.tipo||Pe?.nome||"outros";await BM({comandaId:Xn,finalizadoraId:Pe?.id,metodo:ze,valor:W,codigoEmpresa:t?.codigo_empresa}),await Xx({comandaId:Xn,codigoEmpresa:t?.codigo_empresa}),e({title:"Pagamento registrado (balco)",description:`R$ ${W.toFixed(2)}`,variant:"success"}),Gr([]),En(null),m(!1)}catch(W){e({title:"Falha no pagamento (balco)",description:W?.message||"Tente novamente",variant:"destructive"})}finally{Ma(!1)}},Ie=()=>{p.useEffect(()=>{let oe=!0;return(async()=>{if(h)try{Ma(!0);const ze=t?.codigo_empresa;if(!ze){oe&&e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}const Ke=await $v({codigoEmpresa:ze});if(!oe)return;if(Ke?.id){En(Ke.id),await Fs(Ke.id);try{const Tt=await ni({comandaId:Ke.id,codigoEmpresa:ze}),it=(Tt||[]).map(Kt=>Kt?.cliente_id).filter(Boolean).map(Kt=>String(Kt));Nl(it);const Bt=Array.isArray(Tt)&&Tt.length>0?Tt[0]:null;Bt?.cliente_id&&zc(Bt.cliente_id)}catch{}}else En(null),Gr([])}catch(ze){oe&&e({title:"Falha ao abrir Modo Balco",description:ze?.message||"Tente novamente",variant:"destructive"})}finally{oe&&Ma(!1)}})(),()=>{oe=!1}},[h]),p.useEffect(()=>{if(!ss)return;let oe=!0;const ze=setTimeout(async()=>{try{kd(!0);const Ke=await ib({searchTerm:va,limit:20,codigoEmpresa:t?.codigo_empresa});oe&&Ss(Ke||[])}catch{oe&&Ss([])}finally{oe&&kd(!1)}},250);return()=>{oe=!1,clearTimeout(ze)}},[ss,va]);const W=Nn(dn,null);return a.jsx(xn,{open:h,onOpenChange:m,children:a.jsxs(vn,{className:"max-w-4xl h-[90vh]",onKeyDown:oe=>oe.stopPropagation(),onKeyDownCapture:oe=>oe.stopPropagation(),onPointerDownOutside:oe=>oe.stopPropagation(),onInteractOutside:oe=>oe.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-2xl font-bold",children:"Modo Balco"}),a.jsx(On,{children:"Venda rpida para clientes sem mesa."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-6 h-full overflow-hidden pt-4",children:[a.jsxs("div",{className:"col-span-1 flex flex-col border-r border-border pr-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Catlogo de Produtos"}),a.jsx(ce,{variant:"outline",size:"sm",onClick:()=>ao(!0),children:hi?a.jsxs(a.Fragment,{children:[a.jsx(Ds,{className:"mr-1 h-4 w-4 text-success"})," Cliente"]}):"Cliente"})]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar produto...",className:"pl-9",value:va,onChange:oe=>$a(oe.target.value),ref:_})]}),a.jsx("div",{className:"flex-1 overflow-y-auto -mr-4 pr-4 thin-scroll",children:a.jsxs("ul",{className:"space-y-2",children:[(Ne||[]).filter(oe=>{const Pe=va.trim().toLowerCase();return Pe?(oe.name||"").toLowerCase().includes(Pe)||(oe.code||"").toLowerCase().includes(Pe):!0}).sort((oe,Pe)=>{const ze=oe.code||"",Ke=Pe.code||"";return/^\d+$/.test(ze)&&/^\d+$/.test(Ke)?parseInt(ze,10)-parseInt(Ke,10):ze.localeCompare(Ke)}).map(oe=>{const Pe=(dn||[]).reduce((it,Bt)=>it+(String(Bt.productId)===String(oe.id)?Number(Bt.quantity||0):0),0),ze=Number(oe.stock??oe.currentStock??0),Ke=y.get(String(oe.id))||0,Tt=Math.max(0,ze-Ke);return a.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors",onClick:()=>{yo(oe),Zl(!0)},children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("p",{className:"font-semibold truncate",title:`${oe.code?`[${oe.code}] `:""}${oe.name}`,children:[oe.code&&a.jsxs("span",{className:"text-text-muted",children:["[",oe.code,"]"]})," ",oe.name]}),Pe>0&&a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",Pe]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Number(oe.salePrice??oe.price??0).toFixed(2)]}),a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",Tt]})]})]}),a.jsx(ce,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:it=>{it.stopPropagation(),pi(oe)},"aria-label":`Adicionar ${oe.name}`,children:a.jsx(ro,{size:16})})]},oe.id)}),(!Ne||Ne.length===0)&&a.jsxs("li",{className:"text-center text-text-muted py-8",children:[a.jsx("div",{className:"mb-3",children:"Nenhum produto cadastrado. Cadastre produtos para vender no balco."}),a.jsx(ce,{size:"sm",onClick:()=>n("/produtos"),children:"Cadastrar Produtos"})]})]})})]}),a.jsxs("div",{className:"col-span-1 flex flex-col",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Comanda do Balco"}),a.jsx("div",{className:"flex-1 overflow-y-auto bg-surface-2 rounded-lg p-4 thin-scroll",children:dn.length===0?a.jsx("p",{className:"text-center text-text-muted pt-16",children:"Adicione produtos  comanda."}):a.jsx("ul",{className:"divide-y divide-border",children:dn.map(oe=>a.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:oe.name}),a.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",oe.quantity,"  Unit: R$ ",Number(oe.price||0).toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"font-semibold mr-2",children:["R$ ",(Number(oe.price||0)*Number(oe.quantity||0)).toFixed(2)]}),a.jsx(ce,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{const Pe=Number(oe.quantity||1)-1;if(Pe<=0)B(oe),ue(!0),setTimeout(async()=>{J||await Fs(Xn)},100);else try{await ed({itemId:oe.id,quantidade:Pe,codigoEmpresa:t?.codigo_empresa}),await Fs(Xn)}catch(ze){e({title:"Falha ao atualizar",description:ze?.message||"Tente novamente",variant:"destructive"})}},children:a.jsx(Ev,{size:14})}),a.jsx("span",{className:"w-8 text-center font-semibold",children:oe.quantity}),a.jsx(ce,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{try{await ed({itemId:oe.id,quantidade:Number(oe.quantity||1)+1,codigoEmpresa:t?.codigo_empresa}),await Fs(Xn)}catch(Pe){e({title:"Falha ao atualizar",description:Pe?.message||"Tente novamente",variant:"destructive"})}},children:a.jsx(ro,{size:14})})]})]},oe.id))})}),a.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[a.jsxs("div",{className:"flex justify-between items-center text-xl font-bold mb-4",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",W.toFixed(2)]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(Yd,{children:[a.jsx(Ap,{asChild:!0,children:a.jsx(ce,{size:"lg",className:"flex-1 bg-red-600 hover:bg-red-500 text-white border border-red-600/70",children:"Cancelar"})}),a.jsxs(nd,{className:"sm:max-w-[420px] animate-none",onKeyDown:oe=>oe.stopPropagation(),children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Cancelar comanda do balco?"}),a.jsx(id,{children:"Os itens sero descartados e o balco ser limpo. Esta ao no pode ser desfeita."})]}),a.jsxs(od,{children:[a.jsx(ld,{children:"Voltar"}),a.jsx(Jd,{onClick:async()=>{try{if(!Xn){m(!1);return}await cz({comandaId:Xn,codigoEmpresa:t?.codigo_empresa}),Gr([]),En(null),m(!1),e({title:"Comanda cancelada (balco)",variant:"success"})}catch(oe){e({title:"Falha ao cancelar",description:oe?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Cancelamento"})]})]})]}),a.jsxs(ce,{size:"lg",className:"flex-1",onClick:Ji,disabled:ga||W<=0,children:[a.jsx(Ks,{className:"mr-2"})," Finalizar Pagamento"]})]})]})]})]}),ss&&a.jsx("div",{className:"absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center",onClick:oe=>{oe.target===oe.currentTarget&&ao(!1)},onKeyDown:oe=>{oe.key==="Escape"&&ao(!1)},children:a.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-lg w-full max-w-md p-4",role:"dialog","aria-modal":"true",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Selecionar Cliente"}),a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>ao(!1),children:"Fechar"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:va,onChange:oe=>$a(oe.target.value)})]}),a.jsx("div",{className:"max-h-64 overflow-auto thin-scroll border rounded-md",children:mi?a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Carregando clientes..."}):xo.length>0?a.jsx("ul",{children:xo.map(oe=>{const Pe=Array.isArray(Oi)&&Oi.includes(String(oe.id));return a.jsxs("li",{className:mr("p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2",Pe&&"bg-surface-2"),onClick:()=>af(oe.id),children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium",children:[oe.codigo!=null?String(oe.codigo)+" - ":"",oe.nome]})}),Pe&&a.jsx(Ds,{size:16,className:"text-success"})]},oe.id)})}):a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum cliente encontrado."})})]})})]})})},Ye=()=>{const W=Ro,oe=W&&xu.get(W.id)||0,Pe=W?Number(W.salePrice??W.price??0):0,ze=Ke=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Ke||0));return a.jsx(xn,{open:rf,onOpenChange:Ke=>{Zl(Ke),Ke||yo(null)},children:a.jsxs(vn,{className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[61]",onKeyDown:Ke=>Ke.stopPropagation(),onPointerDownOutside:Ke=>Ke.stopPropagation(),onInteractOutside:Ke=>Ke.stopPropagation(),onEscapeKeyDown:Ke=>{Ke.preventDefault(),Ke.stopPropagation()},children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-xl font-bold break-words",title:W?.name||"",children:W?.name||"Produto"}),a.jsx(On,{children:"Detalhes do produto (Balco)."})]}),W?a.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),a.jsx("span",{className:"text-sm font-semibold",children:ze(Pe)})]}),W.category?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),a.jsx("span",{className:"text-sm font-medium",children:W.category})]}):null,a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof W.stock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),a.jsx("div",{className:"text-base font-semibold",children:W.stock})]}),typeof W.minStock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),a.jsx("div",{className:"text-base font-semibold",children:W.minStock})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),a.jsxs("div",{className:"text-base font-semibold",children:["x",oe]})]})]})]}):null,a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsxs(ce,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{W&&n("/produtos",{state:{productId:W.id,productName:W.name}})},children:[a.jsx(Gs,{className:"w-4 h-4"}),a.jsx("span",{children:"Info"})]}),a.jsx(ce,{variant:"outline",onClick:()=>{Zl(!1),yo(null)},children:"Fechar"}),a.jsx(ce,{onClick:async()=>{W&&(await pi(W),Zl(!1),yo(null))},children:"Adicionar"})]})]})})},ar=()=>{const[W,oe]=p.useState(""),[Pe,ze]=p.useState(!1),[Ke,Tt]=p.useState([]),[it,Bt]=p.useState([]),[Kt,Ct]=p.useState(0),[Or,jr]=p.useState(!1),[or,Hr]=p.useState(0),Cr=p.useRef([]),Yr=p.useRef(null),vr=p.useRef(null),lr=p.useRef(null),ct=p.useRef(null),Zr=p.useRef(0),cn=p.useRef(0);p.useEffect(()=>{let cr=!0;return(async()=>{try{ze(!0);const qr=await ib({searchTerm:W,limit:20});if(!cr)return;const Kr=(qr||[]).slice(),un=String(W||"").trim().toLowerCase(),on=sr=>{const nn=String(sr?.nome||"").toLowerCase();return un?nn.startsWith(un)?0:nn.includes(un)?1:2:2};Kr.sort((sr,nn)=>{const ur=on(sr),gr=on(nn);if(ur!==gr)return ur-gr;const Vr=Number(sr?.codigo||0),rn=Number(nn?.codigo||0);return Vr-rn}),Tt(Kr),Hr(0)}catch{if(!cr)return;Tt([])}finally{cr&&ze(!1)}})(),()=>{cr=!1}},[W]);const Ia=p.useRef(!1);p.useEffect(()=>{try{ae&&!Ia.current&&(Ia.current=!0,lr.current&&(lr.current.scrollTop=0),Yr.current&&(Yr.current.scrollTop=0),vr.current&&(vr.current.scrollTop=0)),ae||(Ia.current=!1)}catch{}},[ae]),p.useEffect(()=>{try{ae&&Array.isArray(Ke)&&Ke.length>0&&(Hr(0),setTimeout(()=>{try{Yr.current?.focus(),vr.current&&(vr.current.scrollTop=0)}catch{}},0))}catch{}},[ae,Ke.length]);const Ca=async(cr=null)=>{try{if(!tt)return;At(!0);const xr=await KGe({mesaId:tt.id,codigoEmpresa:t?.codigo_empresa}),Kr=Array.isArray(cr)?cr:it,un=Array.isArray(Kr)?Array.from(new Set(Kr)):[];let on=[],sr=Math.max(0,Number(Kt||0));un.length===0&&sr===0&&(sr=1);for(let gr=0;gr<sr;gr++)on.push("Consumidor");await lb({comandaId:xr.id,clienteIds:un,nomesLivres:on,codigoEmpresa:t?.codigo_empresa,replace:!0});let nn=null;try{const gr=await ni({comandaId:xr.id,codigoEmpresa:t?.codigo_empresa}),rn=(Array.isArray(gr)?gr:[]).map($r=>$r?.nome).filter(Boolean);nn=rn.length?rn.join(", "):null}catch(gr){console.error("[confirmOpen] Erro ao buscar vnculos:",gr)}if(!nn){const gr=Array.isArray(un)?un:[],Vr=Array.isArray(Ke)?Ke:[];nn=gr.length?gr.map(rn=>Vr.find($r=>$r.id===rn)?.nome).filter(Boolean).join(", "):on.length>0?on.join(", "):""}const ur={...tt,comandaId:xr.id,status:"in-use",customer:nn||null,order:[]};l(ur),s(gr=>gr.map(Vr=>Vr.id===ur.id?ur:Vr)),await new Promise(gr=>setTimeout(gr,500));try{const gr=await Hm(t?.codigo_empresa),Vr=await yc({codigoEmpresa:t?.codigo_empresa}),rn={},$r={},Pn=Array.isArray(Vr)?Vr:[];await Promise.all(Pn.map(async Qr=>{try{const Bn=await ni({comandaId:Qr.id,codigoEmpresa:t?.codigo_empresa}),Ja=(Array.isArray(Bn)?Bn:[]).map(go=>go?.nome).filter(Boolean);rn[Qr.id]=Ja.length?Ja.join(", "):null;const po=await ds({comandaId:Qr.id,codigoEmpresa:t?.codigo_empresa}),Uc=(Array.isArray(po)?po:[]).reduce((go,of)=>{const Sl=(of.quantidade||0)*(of.preco_unitario||0)-(of.desconto||0);return go+Sl},0);$r[Qr.id]=Uc}catch(Bn){console.error("[confirmOpen] Erro ao buscar dados da comanda:",Bn),rn[Qr.id]=null,$r[Qr.id]=0}}));const Ln=(gr||[]).map(Qr=>{const Bn=(Vr||[]).find(Ja=>Ja.mesa_id===Qr.id),Pa=Bn?rn[Bn.id]!==null?rn[Bn.id]:nn:null;return{id:Qr.id,name:Qr.nome||`Mesa ${Qr.numero}`,status:Bn?"in-use":"available",comandaId:Bn?.id||null,customer:Pa,order:[],totalHint:Bn&&$r[Bn.id]||0,aberto_em:Bn?.aberto_em||null}});s(Ln)}catch(gr){console.error("[confirmOpen] Erro ao atualizar mesas:",gr)}ie(!1),he(null),et(""),Bt([]),Ct(0),jr(!1),e({title:"Mesa aberta",description:nn?`Comanda criada para: ${nn}`:"Comanda criada.",variant:"success"})}catch(xr){console.error("[confirmOpen] Falha ao abrir mesa:",xr?.message||xr,xr?.stack),e({title:"Falha ao abrir mesa",description:xr?.message||"Tente novamente",variant:"destructive"})}finally{At(!1)}};return a.jsx(xn,{open:ae,onOpenChange:cr=>{ie(cr),cr||(he(null),et(""),Bt([]),Ct(0),jr(!1))},children:a.jsxs(vn,{className:"w-[95vw] max-w-md h-[560px] max-h-[75vh] flex flex-col animate-none overflow-hidden",onOpenAutoFocus:cr=>cr.preventDefault(),onPointerDownOutside:cr=>{cr.preventDefault(),cr.stopPropagation()},onInteractOutside:cr=>{cr.preventDefault(),cr.stopPropagation()},onEscapeKeyDown:cr=>{cr.preventDefault(),ie(!1)},onKeyDown:cr=>{cr.key==="Escape"&&(cr.preventDefault(),cr.stopPropagation(),ie(!1))},ref:lr,children:[a.jsxs(pn,{className:"flex-shrink-0",children:[a.jsxs(fn,{className:"text-xl font-bold",children:["Abrir Mesa ",tt?`#${tt.number}`:""]}),a.jsx(On,{className:"text-sm",children:"Selecione um ou mais clientes para a mesa."})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto thin-scroll min-h-0 space-y-2 py-2",ref:vr,children:[a.jsxs("div",{children:[a.jsx(De,{className:"text-sm font-medium mb-1.5 block",children:"Buscar cliente"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ts,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Nome, telefone ou cdigo",className:"pl-8 h-9 text-sm",value:W,ref:ct,onChange:cr=>{cn.current=Date.now(),oe(cr.target.value)},onKeyDown:cr=>{if(cr.key==="Enter"){cr.preventDefault();try{if(Array.isArray(Ke)&&Ke.length>0){const xr=Math.min(Math.max(or||0,0),Ke.length-1),qr=Ke[xr];qr?.id&&Bt(Kr=>Kr.includes(qr.id)?Kr.filter(un=>un!==qr.id):[...Kr,qr.id])}}catch{}oe(""),setTimeout(()=>{try{Yr.current?.focus()}catch{}},0)}else cn.current=Date.now()}})]}),a.jsx(ce,{type:"button",size:"icon",title:"Cadastrar cliente",className:"h-9 w-9 flex-shrink-0 bg-brand text-black hover:bg-brand/90",onClick:()=>{window.location.href="/clientes"},children:a.jsx(ro,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mt-1.5 text-[12px] text-text-muted flex items-center gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," seleciona"]}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," desmarca"]}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:"Enter"})," confirma"]}),a.jsx("span",{className:"inline-flex items-center gap-1",children:"Digite para buscar"})]})]}),a.jsx("div",{className:"min-h-[8px]",children:it.length>0&&a.jsxs("div",{className:"bg-success/10 border border-success/30 rounded-md p-2.5",children:[a.jsxs("div",{className:"text-xs font-medium text-success mb-1",children:[it.length," cliente",it.length>1?"s":""," selecionado",it.length>1?"s":""]}),a.jsx("div",{className:"text-sm text-text-primary",children:Ke.filter(cr=>it.includes(cr.id)).map(cr=>cr.nome).join(", ")})]})}),a.jsx("div",{className:"border rounded-md focus:outline-none focus:ring-0 focus-visible:outline-none focus-visible:ring-0",role:"listbox","aria-label":"Clientes","aria-activedescendant":Ke&&Ke.length>0&&Ke[or]&&Ke[or].id?`ot-option-${Ke[or].id}`:void 0,ref:Yr,tabIndex:0,onKeyDown:cr=>{try{if(cr.key&&cr.key.length===1&&!cr.ctrlKey&&!cr.metaKey&&!cr.altKey||cr.key==="Backspace"){cr.preventDefault(),cr.stopPropagation();let qr=String(W||"");cr.key==="Backspace"?qr=qr.slice(0,-1):qr+=cr.key,oe(qr),cn.current=Date.now();try{vr.current&&(vr.current.scrollTop=0)}catch{}setTimeout(()=>{try{if(ct.current){ct.current.focus();const Kr=qr.length;ct.current.setSelectionRange?.(Kr,Kr)}}catch{}},0);return}if(["ArrowDown","ArrowUp","Home","End","ArrowRight","ArrowLeft"," "].includes(cr.key)){let qr=or||0;const Kr=Ke.length;cr.key==="ArrowDown"&&(qr=Math.min(qr+1,Kr-1)),cr.key==="ArrowUp"&&(qr=Math.max(qr-1,0)),cr.key==="Home"&&(qr=0),cr.key==="End"&&(qr=Kr-1),Hr(qr),setTimeout(()=>{try{Cr.current[qr]?.scrollIntoView({block:"nearest"})}catch{}},0);const un=Ke[qr],on=un?.codigo===0;if(cr.key==="ArrowRight"&&un?.id&&(on?(jr(!0),Ct(sr=>sr+1)):(et(""),Bt(sr=>sr.includes(un.id)?sr:[...sr,un.id]))),cr.key==="ArrowLeft"&&un?.id)if(on){const sr=Math.max(0,Kt-1);Ct(sr),sr===0&&jr(!1)}else Bt(sr=>sr.filter(nn=>nn!==un.id));cr.key===" "&&un?.id&&(et(""),Bt(sr=>sr.includes(un.id)?sr.filter(nn=>nn!==un.id):[...sr,un.id]));return}if(cr.key==="Enter"){cr.preventDefault();const qr=Math.min(Math.max(or||0,0),Ke.length-1),Kr=Ke[qr];if(Date.now()-cn.current<600||document.activeElement===ct.current||W&&W.length>0){Kr?.id&&(et(""),Bt(sr=>sr.includes(Kr.id)?sr.filter(nn=>nn!==Kr.id):[...sr,Kr.id])),oe(""),setTimeout(()=>{try{Yr.current?.focus(),vr.current&&(vr.current.scrollTop=0)}catch{}},0);return}if(Kr?.id){const sr=it.includes(Kr.id)?it:[...it,Kr.id];it.includes(Kr.id)||Bt(nn=>[...nn,Kr.id]),setTimeout(()=>{try{Ca(sr)}catch{}},0);return}setTimeout(()=>{try{Ca(it)}catch{}},0);return}}catch{}},children:Pe?a.jsx("div",{className:"p-3 text-center text-sm text-text-muted",children:"Carregando..."}):Ke.length>0?a.jsx("ul",{className:"divide-y divide-border",children:Ke.map((cr,xr)=>{const qr=cr.codigo===0,Kr=it.includes(cr.id),un=xr===(or||0),on=qr?Kt:0;return a.jsxs("li",{id:`ot-option-${cr.id}`,ref:sr=>{Cr.current[xr]=sr},role:"option","aria-selected":un,className:mr("p-2.5 flex items-center gap-2 cursor-pointer transition-colors outline-none focus:outline-none focus-visible:outline-none border border-transparent",qr?"bg-amber-500/5 border-l-2 border-l-amber-500/40":"",Kr&&!qr?"bg-success/10 hover:bg-success/15":"hover:bg-surface-2",Or&&qr?"bg-amber-500/10":"",un?"bg-brand/10":""),onClick:()=>{qr?Or||(jr(!0),Ct(1)):(et(""),Bt(sr=>sr.includes(cr.id)?sr.filter(nn=>nn!==cr.id):[...sr,cr.id]))},onDoubleClick:()=>{if(!qr){const sr=it.includes(cr.id)?it:[...it,cr.id];Bt(sr),setTimeout(()=>{try{Ca(sr)}catch{}},0)}},onMouseEnter:()=>{Date.now()-(Zr.current||0)>300&&Hr(xr)},tabIndex:-1,children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[!qr&&a.jsx("span",{className:mr("w-2 h-2 rounded-full flex-shrink-0",Kr?"bg-success":un?"bg-brand":"bg-border")}),a.jsxs("div",{className:"font-medium text-sm truncate",children:[cr.codigo!=null&&cr.codigo!==0?`${cr.codigo} - `:"",cr.nome,qr&&a.jsx("span",{className:"ml-2 text-xs text-amber-600",children:"Cliente Padro"})]})]}),qr?Or?a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[a.jsx(ce,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-red-500/10",onClick:sr=>{sr.stopPropagation();const nn=Math.max(0,Kt-1);Ct(nn),nn===0&&jr(!1)},children:a.jsx(Ev,{className:"h-4 w-4"})}),a.jsx("div",{className:"w-8 h-7 flex items-center justify-center bg-surface-2 rounded text-sm font-medium",children:on}),a.jsx(ce,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-500/10",onClick:sr=>{sr.stopPropagation(),Ct(nn=>nn+1)},children:a.jsx(ro,{className:"h-4 w-4"})})]}):null:a.jsx("div",{className:"ml-2 flex-shrink-0",children:Kr?a.jsx(Ds,{size:18,className:"text-success"}):a.jsx("div",{className:"w-[18px] h-[18px] rounded-full border-2 border-border"})})]},cr.id)})}):a.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Nenhum cliente encontrado"})})]}),a.jsxs(ra,{className:"flex-shrink-0 pt-3",children:[a.jsx(ce,{type:"button",variant:"outline",onClick:()=>{ie(!1),he(null),et(""),Bt([])},children:"Cancelar"}),a.jsx(ce,{onClick:()=>Ca(),disabled:!tt||dt,children:dt?"Abrindo...":"Confirmar Abertura"})]})]})})},Gt=()=>{const[W,oe]=p.useState("");return p.useEffect(()=>{Lt.current&&oe(Lt.current)},[]),a.jsxs(a.Fragment,{children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Abrir Caixa"}),a.jsx(id,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(De,{htmlFor:"initial-value",children:"Valor Inicial"}),a.jsxs("div",{className:"relative mt-2",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted",children:"R$"}),a.jsx(Je,{id:"initial-value",type:"text",inputMode:"numeric",pattern:"[0-9.,]*",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:!1,name:"cash-open-initial",placeholder:"0,00",className:"pl-9 font-semibold",value:W,onChange:Pe=>{const ze=(Pe.target.value||"").replace(/\D/g,""),Ke=ze?Number(ze)/100:0,Tt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Ke);oe(Tt),Lt.current=Tt},onKeyDown:Pe=>{Pe.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(Pe.key)&&(/^[0-9]$/.test(Pe.key)||Pe.preventDefault())},onBeforeInput:Pe=>{const ze=Pe.data??"";ze&&/\D/.test(ze)&&Pe.preventDefault()},onMouseDown:Pe=>Pe.stopPropagation()})]})]}),a.jsxs(od,{children:[a.jsx(ld,{onClick:()=>kt(!1),children:"Cancelar"}),a.jsx(Jd,{onClick:async()=>{if(!fr){yr(!0);try{const Pe=String(W).replace(/\./g,"").replace(",","."),ze=Number(Pe)||0;try{localStorage.setItem("cash:opening",String(Date.now()))}catch{}await _f({saldoInicial:ze,codigoEmpresa:t?.codigo_empresa}),await bt(),await te({showToast:!1}),kt(!1),e({title:"Caixa aberto com sucesso!",variant:"success"}),Lt.current="",oe("")}catch(Pe){e({title:"Falha ao abrir caixa",description:Pe?.message||"Tente novamente",variant:"destructive"})}finally{try{localStorage.removeItem("cash:opening")}catch{}yr(!1)}}},children:"Confirmar Abertura"})]})]})},Ut=()=>a.jsxs(Yd,{open:Se,onOpenChange:kt,children:[a.jsx(Ap,{asChild:!0,children:a.jsxs(ce,{variant:"success",size:"sm",disabled:c||fr,onClick:()=>kt(!0),className:"px-3",children:[a.jsx(VH,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"}),a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-emerald-700 border border-emerald-800 rounded shadow-sm",children:"F10"})]})}),a.jsx(nd,{className:"sm:max-w-[425px] animate-none",onKeyDown:W=>W.stopPropagation(),onKeyDownCapture:W=>W.stopPropagation(),onEscapeKeyDown:W=>W.preventDefault(),onPointerDownOutside:W=>{W.preventDefault(),W.stopPropagation()},onInteractOutside:W=>{W.preventDefault(),W.stopPropagation()},children:a.jsx(Gt,{})})]}),Ot=()=>{const[W,oe]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[Pe,ze]=p.useState(!1),[Ke,Tt]=p.useState(!1),[it,Bt]=p.useState(!1),[Kt,Ct]=p.useState(!1),[Or,jr]=p.useState(""),or=async()=>{try{oe({loading:!0,saldoInicial:0,resumo:null});const vr=await Gm({codigoEmpresa:t?.codigo_empresa}),lr=await Mw({codigoEmpresa:t?.codigo_empresa});oe({loading:!1,saldoInicial:Number(vr?.saldo_inicial||0),resumo:lr||{totalPorFinalizadora:{}}})}catch{oe({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},Hr=W?.resumo?.totalPorFinalizadora||{},Cr=Object.values(Hr).reduce((vr,lr)=>vr+Number(lr||0),0),Yr=Number(W.saldoInicial||0)+Cr;return a.jsxs(a.Fragment,{children:[a.jsxs(Yd,{open:Pe,onOpenChange:vr=>{ze(vr),vr&&or()},children:[a.jsx(Ap,{asChild:!0,children:a.jsxs(ce,{variant:"destructive",size:"sm",disabled:!c,onClick:()=>ze(!0),className:"px-3",children:[a.jsx(gx,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Fechar"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Fechar Caixa"})]})}),a.jsxs(nd,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:vr=>vr.preventDefault(),onKeyDown:vr=>vr.stopPropagation(),onKeyDownCapture:vr=>vr.stopPropagation(),onPointerDownOutside:vr=>{vr.preventDefault(),vr.stopPropagation()},onInteractOutside:vr=>{vr.preventDefault(),vr.stopPropagation()},children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Fechar Caixa"}),a.jsx(id,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),it&&a.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[a.jsx(Ac,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),W.loading?a.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):a.jsxs("div",{className:"py-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Inicial:"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(W.saldoInicial||0).toFixed(2)]})]}),Object.keys(Hr).length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):Object.entries(Hr).map(([vr,lr])=>a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-text-secondary",children:[String(vr),":"]})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(lr||0).toFixed(2)]})]},vr)),a.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[a.jsx("span",{className:"text-text-primary",children:"Total em Caixa:"})," ",a.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(Yr||0).toFixed(2)]})]})]}),a.jsxs(od,{children:[a.jsx(ld,{onClick:()=>ze(!1),disabled:Kt,children:"Cancelar"}),a.jsx(Jd,{onClick:()=>{Tt(!0)},disabled:Kt,children:"Continuar"})]})]})]}),a.jsx(Yd,{open:Ke,onOpenChange:vr=>{Kt||Tt(vr)},children:a.jsxs(nd,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:vr=>vr.preventDefault(),onEscapeKeyDown:vr=>{Kt||vr.preventDefault()},onKeyDown:vr=>vr.stopPropagation(),onKeyDownCapture:vr=>vr.stopPropagation(),onPointerDownOutside:vr=>{Kt||(vr.preventDefault(),vr.stopPropagation())},onInteractOutside:vr=>{Kt||(vr.preventDefault(),vr.stopPropagation())},children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Confirmar Fechamento do Caixa"}),a.jsx(id,{children:"Informe o saldo final para finalizar o fechamento."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(De,{htmlFor:"valor-contado-final",className:"text-sm font-medium text-text-primary mb-2 block",children:"Saldo Final (opcional)"}),a.jsx("input",{id:"valor-contado-final",type:"text",placeholder:"R$ 0,00",value:Or,onChange:vr=>{let lr=vr.target.value.replace(/\D/g,"");lr.length>0&&(lr=(Number(lr)/100).toFixed(2),lr=lr.replace(".",","),lr="R$ "+lr),jr(lr)},className:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),a.jsxs(od,{children:[a.jsx(ld,{onClick:()=>{Tt(!1)},disabled:Kt,children:"Voltar"}),a.jsx(Jd,{onClick:async()=>{try{if(Kt)return;Ct(!0);const vr=Number(W.saldoInicial||0)+Cr,lr=Or?Number(Or.replace(/[^0-9,]/g,"").replace(",",".")):null;await Are({saldoFinal:vr,valorFinalDinheiro:lr,codigoEmpresa:t?.codigo_empresa}),d(!1),typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{Tt(!1),ze(!1),jr(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${vr.toFixed(2)}`,duration:4e3})}):(Tt(!1),ze(!1),jr(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${vr.toFixed(2)}`,duration:4e3})),setTimeout(async()=>{try{await Gm({codigoEmpresa:t?.codigo_empresa})}catch{}},0)}catch(vr){console.error(vr);const lr=vr?.message||"Tente novamente";if(pt){St(lr.includes("Existem")?lr:`Falha ao fechar caixa: ${lr}`);try{Tt(!1),ze(!1)}catch{}typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{Ge(!0)}):Ge(!0),setTimeout(()=>Ge(!1),2600)}else e({title:"Falha ao fechar caixa",description:lr,variant:"destructive"})}finally{Ct(!1)}},children:"Confirmar Fechamento"})]})]})})]})},S=()=>{const[W,oe]=p.useState(""),[Pe,ze]=p.useState([]),[Ke,Tt]=p.useState([]),[it,Bt]=p.useState(!1),[Kt,Ct]=p.useState(new Set),Or=p.useRef([]),jr=p.useRef(!1),[or,Hr]=p.useState(0);p.useRef([]);const Cr=p.useRef(null);p.useRef(0);const[Yr,vr]=p.useState(!1),[lr,ct]=p.useState(null),[Zr,cn]=p.useState(null),[Ia,Ca]=p.useState("");p.useEffect(()=>{let ur=!0;const gr=async()=>{if(!(!pe||!i?.comandaId)&&!(jr.current&&W===""))try{Bt(!0);const Vr=await ni({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa});if(!ur)return;const rn=(Vr||[]).map(Ln=>({id:Ln.id,cliente_id:Ln.cliente_id,nome:Ln.nome||"",tipo:Ln.tipo||(Ln.cliente_id?"cadastrado":"livre")}));Tt(rn),Or.current=JSON.parse(JSON.stringify(rn)),Ct(new Set);const $r=await ib({searchTerm:W,limit:50,codigoEmpresa:t?.codigo_empresa});if(!ur)return;const Pn=($r||[]).slice().sort((Ln,Qr)=>Number(Ln?.codigo||0)-Number(Qr?.codigo||0));ze(Pn),Hr(0),jr.current=!0}catch(Vr){console.error("Erro ao carregar clientes:",Vr)}finally{ur&&Bt(!1)}};return pe?(gr(),()=>{ur=!1}):(jr.current=!1,oe(""),()=>{ur=!1})},[pe,i?.comandaId]),p.useEffect(()=>{pe&&Array.isArray(Pe)&&Pe.length>0&&(Hr(0),setTimeout(()=>{try{const ur=document.querySelector('[role="dialog"]');if(ur){const gr=ur.querySelector(".overflow-y-auto");gr&&(gr.scrollTop=0)}}catch{}},0))},[pe,Pe.length]),p.useEffect(()=>(pe&&i?.comandaId?(wr.current=!0,er.current=i.comandaId,Ze.current=ur=>{Tt(ur||[]),cr(ur||[])}):pe||wr.current&&er.current===i?.comandaId&&(wr.current=!1,er.current=null,Ze.current=null),()=>{pe||(wr.current=!1,er.current=null,Ze.current=null)}),[pe,i?.comandaId]);const cr=ur=>{try{if(!i?.id)return;const gr=(ur||[]).map(rn=>rn?.nome).filter(Boolean),Vr=gr.length?gr.join(", "):null;l(rn=>rn&&rn.id===i.id?{...rn,customer:Vr}:rn),s(rn=>rn.map($r=>$r.id===i.id?{...$r,customer:Vr}:$r))}catch(gr){console.error("[ManageClientsDialog] Erro ao sincronizar nomes na mesa:",gr)}},xr=()=>{try{console.log("[ManageClientsDialog] addConsumidor clicado")}catch{}i?.comandaId&&(async()=>{try{Bt(!0);const{data:ur,error:gr}=await fe.from("comanda_clientes").insert({comanda_id:i.comandaId,nome_livre:"Consumidor",codigo_empresa:t?.codigo_empresa}).select("id, cliente_id, nome_livre").single();if(gr)throw gr;const Vr={id:ur.id,cliente_id:ur.cliente_id,nome:ur.nome_livre||"Consumidor",tipo:"livre"};Tt(rn=>{const $r=[...rn,Vr];return cr($r),$r}),cn(Vr.id),Ca(Vr.nome||"Consumidor")}catch(ur){console.error("[ManageClientsDialog] Erro ao adicionar consumidor:",ur),e({title:"Falha ao adicionar consumidor",description:ur?.message||"Tente novamente",variant:"destructive"})}finally{Bt(!1)}})()},qr=ur=>{try{console.log("[ManageClientsDialog] addClientFromModal clicado:",ur)}catch{}if(!i?.comandaId)return;const gr=Pe.find(Vr=>Vr.id===ur);gr&&(async()=>{try{Bt(!0);const{data:Vr,error:rn}=await fe.from("comanda_clientes").insert({comanda_id:i.comandaId,cliente_id:ur,codigo_empresa:t?.codigo_empresa}).select("id, cliente_id").single();if(rn)throw rn;const $r={id:Vr.id,cliente_id:Vr.cliente_id,nome:gr.nome,tipo:"cadastrado"};Tt(Pn=>{const Ln=[...Pn,$r];return cr(Ln),Ln}),vr(!1)}catch(Vr){console.error("[ManageClientsDialog] Erro ao adicionar cliente:",Vr),e({title:"Falha ao adicionar cliente",description:Vr?.message||"Tente novamente",variant:"destructive"})}finally{Bt(!1)}})()},Kr=(ur,gr)=>{const Vr=Pe.find($r=>$r.id===gr);!Vr||!Ke.find($r=>$r.id===ur)||(async()=>{try{if(Bt(!0),String(ur).startsWith("temp-")){const{data:$r,error:Pn}=await fe.from("comanda_clientes").insert({comanda_id:i.comandaId,cliente_id:gr,codigo_empresa:t?.codigo_empresa}).select("id, cliente_id").single();if(Pn)throw Pn;const Ln={id:$r.id,cliente_id:$r.cliente_id,nome:Vr.nome,tipo:"cadastrado"};Tt(Qr=>{const Bn=[...Qr.filter(Pa=>Pa.id!==ur),Ln];return cr(Bn),Bn})}else{const{error:$r}=await fe.from("comanda_clientes").update({cliente_id:gr,nome_livre:null}).eq("id",ur).eq("codigo_empresa",t?.codigo_empresa);if($r)throw $r;Tt(Pn=>{const Ln=Pn.map(Qr=>Qr.id===ur?{...Qr,cliente_id:gr,nome:Vr.nome,tipo:"cadastrado"}:Qr);return cr(Ln),Ln})}ct(null),vr(!1)}catch($r){console.error("[ManageClientsDialog] Erro ao trocar cliente:",$r),e({title:"Falha ao trocar cliente",description:$r?.message||"Tente novamente",variant:"destructive"})}finally{Bt(!1)}})()},un=ur=>{if(Ke.find(Vr=>Vr.id===ur)){if(String(ur).startsWith("temp-")||!i?.comandaId){Tt(Vr=>{const rn=Vr.filter($r=>$r.id!==ur);return cr(rn),rn});return}(async()=>{try{Bt(!0);const{error:Vr}=await fe.from("comanda_clientes").delete().eq("id",ur).eq("codigo_empresa",t?.codigo_empresa);if(Vr)throw Vr;Tt(rn=>{const $r=rn.filter(Pn=>Pn.id!==ur);return cr($r),$r})}catch(Vr){console.error("[ManageClientsDialog] Erro ao remover cliente:",Vr),e({title:"Falha ao remover cliente",description:Vr?.message||"Tente novamente",variant:"destructive"})}finally{Bt(!1)}})()}},on=ur=>{try{console.log("[ManageClientsDialog] startEditConsumidor clicado:",ur)}catch{}const gr=Ke.find(Vr=>Vr.id===ur);gr&&(cn(ur),Ca(gr.nome||"Consumidor"))},sr=()=>{if(!Zr||!i?.comandaId)return;const ur=Ia.trim()||"Consumidor";(async()=>{try{if(Bt(!0),!String(Zr).startsWith("temp-")){const{error:gr}=await fe.from("comanda_clientes").update({nome_livre:ur}).eq("id",Zr).eq("codigo_empresa",t?.codigo_empresa);if(gr)throw gr}Tt(gr=>{const Vr=gr.map(rn=>rn.id===Zr?{...rn,nome:ur}:rn);return cr(Vr),Vr})}catch(gr){console.error("[ManageClientsDialog] Erro ao salvar consumidor:",gr),e({title:"Falha ao salvar cliente",description:gr?.message||"Tente novamente",variant:"destructive"})}finally{Bt(!1),cn(null),Ca("")}})()},nn=async()=>{be(!1)};return a.jsxs(xn,{open:pe,onOpenChange:be,children:[a.jsxs(vn,{className:"sm:max-w-[480px] w-[92vw] max-h-[85vh] h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:ur=>ur.preventDefault(),onPointerDownOutside:ur=>{ur.preventDefault(),ur.stopPropagation()},onInteractOutside:ur=>{ur.preventDefault(),ur.stopPropagation()},onEscapeKeyDown:ur=>ur.preventDefault(),children:[a.jsxs(pn,{className:"flex-shrink-0",children:[a.jsx(fn,{children:"Gerenciar Clientes da Mesa"}),a.jsx(On,{children:"Gerencie os clientes vinculados a esta mesa."})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-4 thin-scroll",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"text-sm font-medium text-text-primary",children:["Clientes vinculados (",Ke.length,"):"]}),Ke.length===0?a.jsx("div",{className:"p-4 text-center text-sm text-text-muted border border-dashed rounded-md",children:"Nenhum cliente vinculado ainda"}):a.jsx("div",{className:"space-y-2",children:Ke.map(ur=>{const gr=ur.tipo==="livre",Vr=Zr===ur.id;return a.jsx("div",{className:mr("flex items-center gap-2 p-2 rounded-md border",gr?"bg-amber-500/10 border-amber-500/30":"bg-surface-2 border-border"),children:Vr?a.jsxs(a.Fragment,{children:[a.jsx(Je,{value:Ia,onChange:rn=>Ca(rn.target.value),onKeyDown:rn=>{rn.key==="Enter"&&sr(),rn.key==="Escape"&&(cn(null),Ca("")),rn.stopPropagation()},className:"flex-1 h-8",autoFocus:!0}),a.jsx(ce,{size:"sm",onClick:sr,className:"h-8 px-2",children:a.jsx(Ds,{className:"h-4 w-4"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:mr("flex-1 text-sm truncate p-1 rounded",gr?"cursor-pointer hover:bg-amber-500/10":"cursor-default"),onClick:()=>gr&&on(ur.id),title:gr?"Clique para editar":"",children:[a.jsx("span",{children:ur.nome}),gr&&a.jsx("span",{className:"ml-2 text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30 align-middle",children:"Cliente Padro"})]}),!gr&&a.jsx(ce,{size:"sm",variant:"ghost",onClick:()=>{ct(ur.id),vr(!0)},className:"h-7 px-2",title:"Trocar cliente",children:a.jsx(fl,{className:"h-4 w-4"})}),a.jsx(ce,{size:"sm",variant:"ghost",onClick:()=>un(ur.id),className:"h-7 px-2 text-destructive hover:text-destructive",children:a.jsx(yl,{className:"h-4 w-4"})})]})},ur.id)})})]}),a.jsxs(ce,{onClick:()=>{ct(null),vr(!0)},className:"w-full",size:"sm",children:[a.jsx(ro,{className:"h-4 w-4 mr-2"}),"Adicionar Cliente"]})]}),a.jsxs(ra,{children:[a.jsx(ce,{variant:"outline",onClick:()=>be(!1),disabled:it,children:"Cancelar"}),a.jsx(ce,{onClick:nn,disabled:it,children:it?"Salvando...":`Confirmar ${Kt.size>0?`(${Kt.size} alteraes)`:""}`})]})]}),a.jsx(xn,{open:Yr,onOpenChange:vr,children:a.jsxs(vn,{className:"sm:max-w-[500px] max-h-[80vh] flex flex-col",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:lr?"Trocar Cliente":"Adicionar Cliente"}),a.jsx(On,{children:"Selecione um cliente da lista"})]}),a.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col gap-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar cliente...",className:"pl-9",value:W,onChange:ur=>oe(ur.target.value)})]}),a.jsx("div",{className:"flex-1 border rounded-md overflow-y-auto thin-scroll",role:"listbox","aria-label":"Clientes disponveis",ref:Cr,tabIndex:0,children:it?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Carregando..."}):Pe.length===0?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhum cliente encontrado"}):a.jsx("ul",{className:"divide-y divide-border",children:Pe.map(ur=>{const gr=ur.codigo===0,Vr=Ke.some(rn=>rn.cliente_id===ur.id&&rn.tipo==="cadastrado");return a.jsxs("li",{className:mr("p-3 cursor-pointer transition-colors flex items-center justify-between",gr?"bg-amber-500/5 hover:bg-amber-500/10":"hover:bg-surface-2"),onClick:()=>{gr?lr?(ct(null),vr(!1)):(xr(),vr(!1)):lr?Kr(lr,ur.id):qr(ur.id)},children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"font-medium truncate flex items-center gap-2",children:[gr?"Cliente Consumidor":`${ur?.codigo?`${ur.codigo} - `:""}${ur?.nome||""}`,gr&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30",children:"Cliente Padro"})]}),!gr&&ur.telefone&&a.jsx("div",{className:"text-xs text-text-muted",children:ur.telefone}),gr&&a.jsx("div",{className:"text-xs text-text-muted",children:"Clique para adicionar consumidor"})]}),Vr&&!gr&&a.jsx(Ds,{className:"h-5 w-5 text-success ml-2 flex-shrink-0"})]},ur.id)})})})]}),a.jsx(ra,{children:a.jsx(ce,{variant:"outline",onClick:()=>vr(!1),children:"Cancelar"})})]})})]})},K=()=>{const W=oe=>oe==="available"?"bg-success/10 border-success/30 text-success":oe==="in-use"?"bg-warning/10 border-warning/30 text-warning":oe==="awaiting-payment"?"bg-info/10 border-info/30 text-info":"bg-surface-2 border-border text-text-secondary";return a.jsx("div",{className:"md:hidden space-y-2",children:o.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"text-text-muted mb-4",children:a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),a.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),a.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear"})]}):o.map(oe=>{const Pe=Nn(oe.order||[],oe),ze=oe.totalHint>0?oe.totalHint:Pe;return a.jsx("div",{onClick:async()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}await _r(oe),oe.status!=="available"&&nr(!0)},className:mr("p-3 rounded-lg border-2 bg-surface transition-all active:scale-[0.98]",W(oe.status),i?.id===oe.id&&"ring-2 ring-brand/60",c?"cursor-pointer":"cursor-not-allowed opacity-60"),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex items-center gap-2 mb-1",children:a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("h3",{className:"font-bold text-base truncate",children:oe.name||`Mesa ${oe.number}`}),oe.status==="available"&&oe.id===Fr&&a.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-gray-400 bg-transparent border border-gray-300/50 rounded flex-shrink-0",children:"F1"})]})}),oe.status==="in-use"||oe.status==="awaiting-payment"?a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-text-secondary",children:[a.jsx(ml,{className:"w-3.5 h-3.5 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:Te(oe.customer)||"Sem cliente"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 text-sm font-semibold text-text-primary",children:[a.jsx(Ks,{className:"w-3.5 h-3.5 flex-shrink-0"}),a.jsxs("span",{children:["R$ ",ze.toFixed(2)]})]})]}):a.jsx("div",{className:"text-xs text-text-muted",children:"Mesa disponvel"})]}),a.jsx("div",{className:"w-12 flex items-center justify-center ml-1 mr-1",children:oe.status==="available"?a.jsx("img",{src:"/mesalivre.png",alt:"Mesa livre",className:"w-10 h-10 object-contain opacity-80"}):a.jsx("img",{src:"/mesaocupada.png",alt:"Mesa ocupada",className:"w-10 h-10 object-contain opacity-80"})}),a.jsx(l0,{className:"w-5 h-5 text-text-muted flex-shrink-0 ml-1"})]})},oe.id)})})},ne=()=>i?a.jsx(xn,{open:Xt,modal:!z,onOpenChange:W=>{!W&&z||(nr(W),W||Dt(null),W&&P("tables"))},children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-2xl max-h-[85vh] flex flex-col p-0 gap-0 animate-none",children:[a.jsxs("div",{className:"p-4 border-b border-border bg-surface-2",children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx(fn,{className:"text-xl font-bold",children:i.name||`Mesa ${i.number}`})}),a.jsx(On,{className:"sr-only",children:"Visualizao da comanda e produtos da mesa selecionada"}),(i.status==="in-use"||i.status==="awaiting-payment")&&a.jsxs("div",{className:"flex items-center gap-4 text-sm text-text-secondary",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ml,{className:"w-4 h-4"}),a.jsx("span",{children:Te(i.customer)||"Sem cliente"})]}),i.order&&i.order.length>0&&a.jsxs("div",{className:"flex items-center gap-1 font-semibold text-text-primary",children:[a.jsx(Ks,{className:"w-4 h-4"}),a.jsxs("span",{children:["R$ ",(i.totalHint>0?i.totalHint:Nn(i.order||[])).toFixed(2)]})]})]})]}),a.jsxs(_c,{value:ir,onValueChange:W=>{if(Ee(W),Dt(null),W==="products"&&i){w(!0);try{nr(!1)}catch{}Ee("order")}},className:"flex flex-col flex-1 min-h-0",children:[a.jsxs(ql,{className:"grid w-full grid-cols-3 m-2 rounded-lg",children:[a.jsx(ca,{value:"order",className:"text-sm flex items-center justify-center gap-2",children:"Comanda"}),a.jsx(ca,{value:"details",className:"text-sm flex items-center justify-center gap-2",children:"Detalhes"}),a.jsxs(ca,{value:"products",className:"text-sm flex items-center justify-center gap-2",onClick:()=>{if(i){w(!0);try{nr(!1)}catch{}}},children:["Produtos",a.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),a.jsx(uo,{value:"order",className:"flex-1 overflow-hidden min-h-0 m-0",onKeyDown:W=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(W.key)&&P("tables")},children:a.jsx(kr,{table:i})}),a.jsx(uo,{value:"details",className:"flex-1 overflow-hidden min-h-0 m-0",children:a.jsx(Sr,{table:i})})]})]})}):null,Ce=()=>{const W=D,oe=W&&wt.get(W.id)||0,Pe=W?Number(W.salePrice??W.price??0):0,ze=Ke=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Ke||0));return a.jsx(xn,{open:z,onOpenChange:Ke=>{H(Ke),Ke||U(null)},children:a.jsxs(vn,{overlayClassName:"z-[70]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[71]",onOpenAutoFocus:Ke=>{},onKeyDown:Ke=>Ke.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-xl font-bold break-words",title:W?.name||"",children:W?.name||"Produto"}),a.jsx(On,{children:"Detalhes do produto e aes rpidas."})]}),W?a.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),a.jsx("span",{className:"text-sm font-semibold",children:ze(Pe)})]}),W.category?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),a.jsx("span",{className:"text-sm font-medium",children:W.category})]}):null,a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof W.stock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),a.jsx("div",{className:"text-base font-semibold",children:W.stock})]}),typeof W.minStock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),a.jsx("div",{className:"text-base font-semibold",children:W.minStock})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),a.jsxs("div",{className:"text-base font-semibold",children:["x",oe]})]})]})]}):null,a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsxs(ce,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{W&&n("/produtos",{state:{productId:W.id,productName:W.name}})},children:[a.jsx(Gs,{className:"w-4 h-4"}),a.jsx("span",{children:"Info"})]}),a.jsx(ce,{variant:"outline",onClick:()=>{H(!1),U(null)},children:"Fechar"}),a.jsx(ce,{onClick:async()=>{W&&(await yn(W),H(!1),U(null))},children:"Adicionar"})]})]})})};return a.jsxs(a.Fragment,{children:[a.jsx(Ce,{}),a.jsx(Ye,{}),a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsx("div",{className:"md:hidden mb-2 w-full",children:a.jsx(_c,{value:"mesas",onValueChange:W=>{W==="mesas"&&n("/vendas"),W==="balcao"&&n("/balcao"),W==="historico"&&n("/historico")},children:a.jsxs(ql,{className:"grid w-full grid-cols-3",children:[a.jsx(ca,{value:"mesas",className:"text-xs",title:"Pressione B para alternar",children:"Mesas"}),a.jsx(ca,{value:"balcao",className:"text-xs",title:"Pressione B para alternar",children:"Balco"}),a.jsx(ca,{value:"historico",className:"text-xs",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[a.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:a.jsx(_c,{value:"mesas",onValueChange:W=>{W==="mesas"&&n("/vendas"),W==="balcao"&&n("/balcao"),W==="historico"&&n("/historico")},children:a.jsxs(ql,{className:"inline-flex",children:[a.jsx(ca,{value:"mesas",className:"text-sm",title:"Pressione B para alternar",children:"Mesas"}),a.jsx(ca,{value:"balcao",className:"text-sm",title:"Pressione B para alternar",children:"Balco"}),a.jsx(ca,{value:"historico",className:"text-sm",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 flex-shrink-0",children:[a.jsx(Ut,{}),a.jsx(Ot,{}),a.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>g(!0),className:"px-3",children:[a.jsx(i4,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"}),a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F11"})]}),a.jsx("div",{className:"hidden md:block w-px h-6 bg-border mx-1"}),a.jsxs(ce,{onClick:()=>Le(!0),className:"hidden md:flex",size:"sm",children:[a.jsx(ro,{className:"mr-2 h-4 w-4"})," Nova Mesa",a.jsx("kbd",{className:"ml-2 px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]})]})]}),!c&&u>0&&a.jsxs("div",{className:"md:hidden mb-3 text-[11px] text-warning flex items-center gap-2",children:[a.jsx(Ac,{className:"h-3 w-3"}),"H comandas abertas, mas o caixa parece fechado.",a.jsx(ce,{size:"sm",variant:"outline",className:"h-6 px-2 text-[11px]",onClick:()=>kt(!0),children:"Reabrir sesso"})]}),a.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 overflow-visible min-h-0",children:[a.jsxs("div",{className:"lg:col-span-2 bg-surface rounded-lg border border-border p-4 md:p-6 overflow-y-auto thin-scroll min-h-0",tabIndex:0,onKeyDown:W=>{A==="tables"&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(W.key)&&W.preventDefault()},onClick:W=>{W.stopPropagation(),W.preventDefault(),P("tables"),!i&&o.length>0&&l(o[0]),W.currentTarget.focus()},onFocus:()=>{P("tables"),!i&&o.length>0&&l(o[0])},style:{outline:A==="tables"?"2px solid rgba(148, 163, 184, 0.4)":"none",outlineOffset:"-2px",transition:"outline 0.15s ease"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4 gap-4",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Mapa de Mesas"}),a.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-text-muted flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:""}),a.jsx("span",{children:"Navegar"})]}),a.jsx("div",{className:"w-px h-3 bg-border"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"Enter"}),a.jsx("span",{children:"Selecionar"})]})]}),a.jsx(ce,{type:"button",className:"md:hidden h-9 w-9 p-0 bg-amber-400 text-black hover:bg-amber-300 flex-shrink-0",size:"icon",title:"Nova Mesa",onClick:()=>Le(!0),children:a.jsx(ro,{className:"h-5 w-5"})})]}),a.jsx(K,{}),a.jsx("div",{className:"hidden md:block",children:a.jsx(Ynt,{onDragEnd:ma,children:a.jsx(Coe,{droppableId:"tables",children:W=>a.jsxs("div",{...W.droppableProps,ref:oe=>{W.innerRef(oe),br.current=oe},role:"grid","aria-label":"Lista de mesas",className:"grid gap-5 grid-cols-[repeat(auto-fit,minmax(240px,1fr))]",children:[o.length===0?a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"text-text-muted mb-4",children:a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),a.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),a.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear a receber pedidos"}),a.jsxs(ce,{onClick:()=>Le(!0),className:"flex items-center gap-2",children:[a.jsx(ro,{size:16}),"Criar Nova Mesa"]})]}):o.map((oe,Pe)=>a.jsx(Tat,{draggableId:oe.id,index:Pe,children:(ze,Ke)=>a.jsx(Re,{table:oe,provided:ze,isDragging:Ke.isDragging})},oe.id)),W.placeholder]})})})})]}),a.jsx("div",{className:"hidden md:flex bg-surface rounded-lg border border-border flex-col min-h-0 transition-all overflow-hidden",style:{boxShadow:A==="panel"?"inset 0 0 0 2px rgba(148, 163, 184, 0.4)":"none"},children:a.jsxs(_c,{value:F,onValueChange:W=>{M(W),W==="products"&&i&&(w(!0),M("order"))},className:"flex flex-col h-full",children:[a.jsxs(ql,{className:"grid w-full grid-cols-3 m-2",children:[a.jsx(ca,{value:"order",className:"flex items-center justify-center gap-2 text-xs",children:"Comanda"}),a.jsx(ca,{value:"details",className:"flex items-center justify-center gap-2 text-xs",children:"Detalhes"}),a.jsxs(ca,{value:"products",onClick:()=>{i&&w(!0)},className:"flex items-center justify-center gap-2 text-xs",children:["Produtos",a.jsx("kbd",{className:"hidden md:inline px-1 py-0.5 text-[10px] font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),a.jsx(uo,{value:"order",className:"flex-1 overflow-hidden min-h-0",children:a.jsx(kr,{table:i})}),a.jsx(uo,{value:"details",className:"flex-1 overflow-hidden min-h-0",children:a.jsx(Sr,{table:i})})]})})]})]}),a.jsx(ne,{}),a.jsx(Ie,{}),a.jsx(lt,{open:v,onOpenChange:g,cashSummary:I}),a.jsx(It,{}),a.jsx($t,{}),pe?a.jsx(S,{}):null,a.jsx(ar,{}),a.jsx(pr,{}),qe&&a.jsx("div",{className:"fixed left-3 right-3 z-[9999]",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:a.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[a.jsx(Ac,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),a.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:Qe||"Ateno"})]})}),ft&&a.jsx(Hat,{item:ft,onApply:()=>{i&&ot(i)},onClose:()=>{Dt(null)},codigoEmpresa:t?.codigo_empresa}),i&&Ft&&a.jsx(Gat,{comanda:i,subtotal:Nn(i.order||[],i),onApply:()=>{i&&ot(i)},onClose:()=>ye(!1),codigoEmpresa:t?.codigo_empresa}),(dt||st||Rt)&&a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80",children:a.jsxs("div",{className:"px-8 py-6 rounded-xl bg-surface border border-border shadow-2xl flex flex-col items-center gap-4 max-w-sm w-[85vw] text-center",children:[a.jsx("div",{className:"w-8 h-8 rounded-full border-4 border-brand border-t-transparent animate-spin","aria-hidden":"true"}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block text-base font-semibold text-text-primary",children:dt?"Abrindo mesa...":st?"Cancelando comanda...":"Fechando conta..."}),a.jsx("span",{className:"block text-xs text-text-muted",children:dt?"Aguarde, estamos criando a comanda e sincronizando com os outros dispositivos.":st?"Aguarde, estamos cancelando a comanda e liberando a mesa em todos os dispositivos.":"Aguarde, estamos registrando os pagamentos e liberando a mesa em todos os dispositivos."})]})]})}),p.useMemo(()=>a.jsx(In,{},(i?.order||[]).map(W=>`${String(W.productId)}:${Number(W.quantity||0)}`).join("|")),[b,i?.id,i?.order])]})}function Yat(){const{toast:e}=no(),t=Yi(),{userProfile:r}=So(),[n,o]=p.useState(null),[s,i]=p.useState([]),[l,c]=p.useState([]),[d,u]=p.useState(!0),[f,h]=p.useState(!1),[m,v]=p.useState(!1),[g,y]=p.useState(!1),[x,b]=p.useState(""),[w,j]=p.useState(""),[_,C]=p.useState(null),[E,A]=p.useState(null),[P,F]=p.useState(!1),M=p.useRef(!1),[I,R]=p.useState(new Map),[D,U]=p.useState(!1),[z,H]=p.useState(!1),[q,Q]=p.useState(!1),[pe,be]=p.useState(!1),[V,B]=p.useState(null),[J,ue]=p.useState(!1),[Ne,Z]=p.useState(!1),[ge,le]=p.useState([]);p.useState(null);const[se,ee]=p.useState(!1),[de,Le]=p.useState([]),[ae,ie]=p.useState(1),[dt,At]=p.useState([]),[st,ut]=p.useState(null),[Rt,Nt]=p.useState(!1),[tt,he]=p.useState(null),[ke,et]=p.useState(!1),[Me,$e]=p.useState(""),[Be,we]=p.useState(!1),[He,ht]=p.useState(""),[zt,hr]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}});p.useEffect(()=>{const te=()=>{try{hr(typeof window<"u"&&window.innerWidth<=640)}catch{hr(!1)}};return te(),window.addEventListener("resize",te),()=>window.removeEventListener("resize",te)},[]),p.useState("cadastrado");const[Mt,Qt]=p.useState(""),[Se,kt]=p.useState([]),[Lt,fr]=p.useState([]);p.useState(!1),p.useState(!1);const[yr,Xt]=p.useState(!1),[nr,ir]=p.useState(!1),[Ee,qe]=p.useState(0),[Ge,Qe]=p.useState("all"),[St,pt]=p.useState(()=>{try{return localStorage.getItem("balcao_sort_order")||"code"}catch{return"code"}}),Et=p.useRef([]),mt=p.useRef(null),[gt,ft]=p.useState(()=>{try{const te=localStorage.getItem("balcao_left_panel_width");return te?parseFloat(te):50}catch{return 50}}),[Dt,Ft]=p.useState(!1),ye=p.useRef(null),wt=p.useRef(0),Yt=p.useRef([]);p.useEffect(()=>{Yt.current=l},[l]);const br=p.useRef(!1);p.useEffect(()=>(br.current=!0,()=>{br.current=!1}),[]);const Mr=p.useRef(null),Nr=p.useRef(null),Rr=p.useRef(null),Er=p.useRef(null);p.useEffect(()=>{Er.current=n},[n]),p.useEffect(()=>{const te=r?.codigo_empresa;if(!te)return;try{const X=typeof window<"u"?window.localStorage.getItem("custom-auth-token"):null;if(X&&X.trim())fe.realtime.setAuth(X.trim());else{let G="";try{G=(new URL(fe.supabaseUrl||"").host||"").split(".")[0]||""}catch{}const L=G?`sb-${G}-auth-token`:"sb-auth-token",Re=typeof window<"u"?window.localStorage.getItem(L):null;if(Re)try{const rt=JSON.parse(Re),lt=rt?.access_token||rt?.currentSession?.access_token;lt&&fe.realtime.setAuth(lt)}catch{}}}catch{}const T=fe.channel(`loja:${te}`),O=async X=>{const G=X?.table||X?.table_name||"",L=X?.new||X?.old||{},Re=X?.eventType||X?.type||X?.event||"";try{if(G==="comanda_itens"){const rt=X?.new?.comanda_id||X?.old?.comanda_id||L?.comanda_id||null;if(rt){const lt=Er.current;if(lt&&String(lt)===String(rt)){try{await Jr(lt,2)}catch{}try{const $t=await Mm({codigoEmpresa:te}),Fe=new Map;for(const It of $t||[])Fe.set(It.produto_id,(Fe.get(It.produto_id)||0)+Number(It.quantidade||0));R(Fe)}catch{}return}try{const $t=await $v({codigoEmpresa:te});if($t?.id&&String($t.id)===String(rt)){o($t.id);try{await Jr($t.id,2)}catch{}try{const Fe=await Mm({codigoEmpresa:te}),It=new Map;for(const Sr of Fe||[])It.set(Sr.produto_id,(It.get(Sr.produto_id)||0)+Number(Sr.quantidade||0));R(It)}catch{}return}}catch{}}}if(G==="comanda_clientes"){const rt=X?.new?.comanda_id||X?.old?.comanda_id||L?.comanda_id||null;if(rt&&Er.current&&String(Er.current)===String(rt)){try{await Jr(rt,2)}catch{}return}}if(G==="comandas"){const rt=L?.mesa_id,lt=L?.id||X?.old?.id||null,$t=String(L?.status||"").toLowerCase(),Fe=String(Re||"").toUpperCase()==="DELETE"||$t.includes("fechad")||$t.includes("closed")||$t.includes("encerr"),It=String(Re||"").toUpperCase()==="INSERT";if(Fe&&rt==null&&Er.current&&lt&&String(Er.current)===String(lt)){c([]),o(null),fr([]),b(""),ir(!1);try{localStorage.removeItem(_t.comandaId),localStorage.removeItem(_t.items),localStorage.removeItem(_t.customerName),localStorage.removeItem(_t.pendingClientIds),localStorage.removeItem(_t.clientChosen)}catch{}}if(It&&rt==null&&["open","awaiting-payment","awaiting_payment"].includes($t)){o(lt);try{await Jr(lt,2)}catch{}}}}catch{}if(Nr.current)try{clearTimeout(Nr.current)}catch{}Nr.current=setTimeout(async()=>{const rt=Er.current;if(rt)try{await Jr(rt,2)}catch{}else try{const lt=await $v({codigoEmpresa:te});if(lt?.id){o(lt.id);try{await Jr(lt.id,2)}catch{}}}catch{}},250)};if(T.on("postgres_changes",{event:"*",schema:"public",table:"comandas",filter:`codigo_empresa=eq.${te}`},O).on("postgres_changes",{event:"*",schema:"public",table:"comanda_itens"},O).on("postgres_changes",{event:"*",schema:"public",table:"comanda_clientes"},O).subscribe(),Mr.current=T,Rr.current)try{clearInterval(Rr.current)}catch{}return Rr.current=setInterval(async()=>{const X=Er.current;if(X)try{await Jr(X,1)}catch{}else try{const G=await $v({codigoEmpresa:te});if(G?.id){o(G.id);try{await Jr(G.id,1)}catch{}}}catch{}},6e4),()=>{if(Mr.current){try{fe.removeChannel(Mr.current)}catch{}Mr.current=null}if(Nr.current){try{clearTimeout(Nr.current)}catch{}Nr.current=null}if(Rr.current){try{clearInterval(Rr.current)}catch{}Rr.current=null}}},[r?.codigo_empresa]),p.useEffect(()=>{(l||[]).length>0&&(M.current=!0)},[l]),p.useEffect(()=>{n&&M.current&&(l||[]).length===0&&Jr(n,2)},[n,l?.length]),p.useEffect(()=>{if(J)return;let te=!0;return(async()=>{try{const T=await Gm({codigoEmpresa:r?.codigo_empresa});te&&U(!!T)}catch{te&&U(!1)}})(),()=>{te=!1}},[r?.codigo_empresa,J]);const ln=async()=>{const te=r?.codigo_empresa||null;try{if(!te)return;be(!0);const[T,O]=await Promise.all([Mw({codigoEmpresa:te}).catch(()=>null),Gm({codigoEmpresa:te}).catch(()=>null)]);if(!O?.id){B(null);return}let X=0,G=0,L=[];try{L=await qp({caixaSessaoId:O.id,codigoEmpresa:te}),X=(L||[]).filter(rt=>String(rt?.tipo||"").toLowerCase()==="sangria").reduce((rt,lt)=>rt+Number(lt?.valor||0),0),G=(L||[]).filter(rt=>String(rt?.tipo||"").toLowerCase()==="suprimento").reduce((rt,lt)=>rt+Number(lt?.valor||0),0)}catch{}const Re={saldo_inicial:O.saldo_inicial||0,totalPorFinalizadora:T?.totalPorFinalizadora||T?.porFinalizadora||{},totalEntradas:T?.totalEntradas||T?.entradas||0,totalSangria:X,totalSuprimento:G,totalSaidas:X,sessaoId:O.id,movimentacoes:L};B(Re)}catch{B(null)}finally{be(!1)}};p.useEffect(()=>{let te=!0;return(async()=>{try{if(!Ne||!n)return;const O=r?.codigo_empresa;let X=[];try{const Re=await ni({comandaId:n,codigoEmpresa:O});X=(Array.isArray(Re)?Re:[]).map(lt=>{const $t=lt?.clientes?.id??lt?.cliente_id??lt?.id??null,Fe=lt?.clientes?.nome??lt?.nome??lt?.nome_livre??"";return $t?{id:$t,nome:Fe}:null}).filter(Boolean)}catch{X=[]}if(!te)return;At(X);const L=Array.isArray(Lt)&&Lt.length>0?Lt:X.map(Re=>Re.id);if(!Array.isArray(L)||L.length===0)return;Le(Re=>{let rt=Re&&Re.length?[...Re]:[{id:1,clientId:L[0],methodId:ge[0]?.id||"",value:""}];rt[0]||(rt[0]={id:1,clientId:L[0],methodId:ge[0]?.id||"",value:""}),rt[0].clientId=L[0];const lt=new Set([rt[0].clientId].filter(Boolean));for(let $t=1;$t<rt.length;$t++){if(!rt[$t].clientId||lt.has(rt[$t].clientId)){const Fe=(L||[]).find(It=>!lt.has(It));rt[$t].clientId=Fe||L[0]}lt.add(rt[$t].clientId)}return rt})}catch{}})(),()=>{te=!1}},[Ne,Lt,n,r?.codigo_empresa]);const Fn=te=>{const T=String(te||"").replace(/\D/g,"");return T?Number(T)/100:0},Hn=te=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(te),$n=te=>(ge||[]).find(T=>String(T.id)===String(te)),at=te=>Number($n(te.methodId)?.taxa_percentual||0),Vt=te=>{const T=Fn(te.value),O=at(te);return!te.chargeFee||!O?T:T/(1+O/100)},wr=te=>{const T=Vt(te),O=at(te);return!te.chargeFee||!O||T<=0?0:T*(O/100)},er=(te,T)=>{const O=at(te);if(te.chargeFee&&O>0){const X=T*(1+O/100);return{...te,value:Hn(X)}}return{...te,value:Hn(T)}},Ze=()=>(de||[]).reduce((te,T)=>te+Vt(T),0),Fr=()=>(de||[]).reduce((te,T)=>te+wr(T),0),jt=()=>Ze()+Fr();p.useEffect(()=>{try{if(!Ne)return;let te=0;try{te=(l||[]).reduce((X,G)=>X+Number(G.quantity||0)*Number(G.price||0),0)}catch{}const T=Ze(),O=te-T;Math.abs(O)>.009&&Math.abs(O)<=.05&&Array.isArray(de)&&de.length>0&&Le(X=>X.map((G,L,Re)=>{if(L!==Re.length-1)return G;const rt=Vt(G)+O;return er(G,rt)}))}catch{}},[de,Ne]);const _r=async()=>{try{if(y(!0),!n){e({title:"Nenhuma comanda aberta",description:"Adicione itens para abrir uma comanda.",variant:"warning"});return}const te=r?.codigo_empresa;if(!te){e({title:"Empresa no definida",variant:"destructive"});return}try{const{data:G,error:L}=await fe.from("comandas").select("id").eq("id",n).eq("codigo_empresa",te).single();if(L||!G){console.error("[confirmPay] Comanda no encontrada no banco:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Criando nova comanda...",variant:"warning"}),o(null),c([]);try{localStorage.removeItem(_t.comandaId),localStorage.removeItem(_t.items)}catch{}await mn();return}}catch(G){console.error("[confirmPay] Erro ao validar comanda:",G),e({title:"Erro de validao",description:"No foi possvel validar a comanda.",variant:"destructive"});return}if(!Array.isArray(de)||de.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const G of de){if(!G.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(!String(G.value||"").replace(/\D/g,"")){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}let T=0;try{T=(await ds({comandaId:n,codigoEmpresa:te})||[]).reduce((L,Re)=>L+Number(Re.quantidade||0)*Number(Re.preco_unitario||0),0)}catch{}const O=Ze(),X=Math.abs(O-T);if(X>.009&&X<=.05){const G=T-O;Le(L=>L.map((Re,rt,lt)=>{if(rt!==lt.length-1)return Re;const $t=Vt(Re)+G;return er(Re,$t)}))}else if(X>.05){const G=T-O;G>0?e({title:"Valor insuficiente",description:`Faltam R$ ${G.toFixed(2)} para fechar o total.`,variant:"warning"}):e({title:"Valor excedente",description:`Excedeu em R$ ${Math.abs(G).toFixed(2)}. Ajuste os valores.`,variant:"warning"});return}ee(!0),await _f({codigoEmpresa:te});for(const G of de){const L=Fn(G.value),Re=ge.find(lt=>String(lt.id)===String(G.methodId)),rt=Re?.nome||Re?.tipo||"outros";await BM({comandaId:n,finalizadoraId:G.methodId,metodo:rt,valor:L,status:"Pago",codigoEmpresa:te,clienteId:G.clientId||null})}await Xx({comandaId:n,codigoEmpresa:te}),o(null),c([]),fr([]),b(""),ir(!1),Le([]);try{localStorage.removeItem(_t.comandaId),localStorage.removeItem(_t.items),localStorage.removeItem(_t.customerName)}catch{}e({title:"Pagamento concludo",description:`Total R$ ${T.toFixed(2)}`,variant:"success"}),Z(!1)}catch(te){e({title:"Falha ao concluir",description:te?.message||"Tente novamente",variant:"destructive"})}finally{ee(!1),y(!1)}};p.useEffect(()=>{(async()=>{try{if(!z)return;await ln()}catch{}})()},[z,r?.codigo_empresa]);const bt=()=>{const[te,T]=p.useState(""),O=p.useRef(null);return p.useEffect(()=>{if(typeof window<"u"&&window.innerWidth<=640)return;const G=setTimeout(()=>{try{O.current?.focus()}catch{}},0);return()=>clearTimeout(G)},[]),a.jsxs(a.Fragment,{children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Abrir Caixa"}),a.jsx(id,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(De,{className:"mb-2 block",htmlFor:"open-cash-initial",children:"Saldo inicial"}),a.jsx(Je,{id:"open-cash-initial",ref:O,type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:te,onChange:X=>{const G=(X.target.value||"").replace(/\D/g,""),L=G?Number(G)/100:0,Re=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(L);T(Re)},onKeyDown:X=>{X.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(X.key)&&(/^[0-9]$/.test(X.key)||X.preventDefault())},onBeforeInput:X=>{const G=X.data??"";G&&/\D/.test(G)&&X.preventDefault()}}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Digite nmeros; a mscara formata em reais automaticamente."})]}),a.jsxs(od,{children:[a.jsx(ld,{onClick:()=>Q(!1),children:"Cancelar"}),a.jsx(Jd,{onClick:async()=>{try{const X=String(te||"").replace(/\D/g,""),G=X?Number(X)/100:0;await _f({saldoInicial:G,codigoEmpresa:r?.codigo_empresa}),U(!0),Q(!1),e({title:"Caixa aberto com sucesso!",variant:"success"})}catch(X){e({title:"Falha ao abrir caixa",description:X?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Abertura"})]})]})},Wt=()=>a.jsxs(Yd,{open:q,onOpenChange:Q,children:[a.jsx(Ap,{asChild:!0,children:a.jsxs(ce,{variant:"success",size:"sm",disabled:D,onClick:()=>Q(!0),className:"px-3",children:[a.jsx(VH,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"})]})}),a.jsx(nd,{className:"sm:max-w-[425px] w-[92vw] animate-none",onKeyDown:te=>te.stopPropagation(),onEscapeKeyDown:te=>{te.preventDefault(),te.stopPropagation()},onPointerDownOutside:te=>{te.preventDefault(),te.stopPropagation()},onFocusOutside:te=>{te.preventDefault(),te.stopPropagation()},onInteractOutside:te=>{te.preventDefault(),te.stopPropagation()},onOpenAutoFocus:te=>{te.preventDefault()},onCloseAutoFocus:te=>{te.preventDefault()},children:a.jsx(bt,{})})]}),Zt=()=>{const[te,T]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[O,X]=p.useState(!1),[G,L]=p.useState(""),[Re,rt]=p.useState(!1),lt=async()=>{try{T({loading:!0,saldoInicial:0,resumo:null});const pr=await Gm({codigoEmpresa:r?.codigo_empresa}),yn=await Mw({codigoEmpresa:r?.codigo_empresa});T({loading:!1,saldoInicial:Number(pr?.saldo_inicial||0),resumo:yn||{totalPorFinalizadora:{}}})}catch{T({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},$t=te?.resumo?.totalPorFinalizadora||{},Fe=Object.values($t).reduce((pr,yn)=>pr+Number(yn||0),0),It=Number(te.saldoInicial||0)+Fe,Sr=Number(V?.totalSuprimento||0),kr=Number(V?.totalSangria||0);return a.jsxs(Yd,{open:J,onOpenChange:pr=>{pr&&(ue(!0),rt(!1),lt())},children:[a.jsx(Ap,{asChild:!0,children:a.jsxs(ce,{variant:"destructive",size:"sm",disabled:!D,onClick:()=>{ue(!0)},className:"px-3",children:[a.jsx(gx,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2",children:"Fechar Caixa"})]})}),a.jsxs(nd,{className:"sm-max-w-[425px] animate-none",onKeyDown:pr=>pr.stopPropagation(),onEscapeKeyDown:pr=>{pr.preventDefault(),pr.stopPropagation()},onPointerDownOutside:pr=>{pr.preventDefault(),pr.stopPropagation()},onFocusOutside:pr=>{pr.preventDefault(),pr.stopPropagation()},onInteractOutside:pr=>{pr.preventDefault(),pr.stopPropagation()},onOpenAutoFocus:pr=>{pr.preventDefault()},onCloseAutoFocus:pr=>{pr.preventDefault()},children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Fechar Caixa"}),a.jsx(id,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),O&&a.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[a.jsx(Ac,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),te.loading?a.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):a.jsx("div",{className:"py-4 space-y-2",children:Re?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(te.saldoInicial||0).toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Final"})," ",a.jsx("span",{className:"font-mono",children:(()=>{const pr=String(G||"").replace(/\D/g,""),yn=pr?Number(pr)/100:0;return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(yn)})()})]})]}),a.jsxs("div",{className:"mt-2",children:[a.jsx(De,{className:"mb-1 block",children:"Saldo Final (opcional)"}),a.jsx(Je,{type:"text",inputMode:"numeric",placeholder:"0,00",value:G,onChange:pr=>{const yn=(pr.target.value||"").replace(/\D/g,""),In=yn?Number(yn)/100:0,Xn=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(In);L(Xn)},onKeyDown:pr=>{pr.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(pr.key)&&(/^[0-9]$/.test(pr.key)||pr.preventDefault())},onBeforeInput:pr=>{const yn=pr.data??"";yn&&/\D/.test(yn)&&pr.preventDefault()}})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Resumo"}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(te.saldoInicial||0).toFixed(2)]})]}),Object.keys($t).length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):a.jsx("div",{className:"space-y-1",children:Object.entries($t).map(([pr,yn])=>a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:String(pr)})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(yn||0).toFixed(2)]})]},pr))}),a.jsx("div",{className:"my-2 h-px bg-border"}),a.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Conferncia"}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Suprimentos"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Sr.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Sangrias"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",kr.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between font-medium text-base",children:[a.jsx("span",{className:"text-text-secondary",children:"Total em Caixa"})," ",a.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(It||0).toFixed(2)]})]})]})}),a.jsx(od,{children:Re?a.jsxs(a.Fragment,{children:[a.jsx(ce,{variant:"outline",onClick:()=>rt(!1),children:"Voltar"}),a.jsx(ce,{onClick:async()=>{try{try{const In=await yc({codigoEmpresa:r?.codigo_empresa});if(Array.isArray(In)&&In.length>0){zt?(X(!0),e({title:"Fechamento bloqueado",description:`Existem ${In.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning"})):e({title:"Fechamento bloqueado",description:`Existem ${In.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning",duration:2500});return}}catch{}const pr=String(G||"").replace(/\D/g,""),yn=pr?Number(pr)/100:0;await Are({codigoEmpresa:r?.codigo_empresa,valorFinalDinheiro:yn}),U(!1),ue(!1),e({title:"Caixa fechado!",description:"Fechamento registrado com sucesso.",variant:"success"})}catch(pr){e({title:"Falha ao fechar caixa",description:pr?.message||"Tente novamente",variant:"destructive"})}},children:"Fechar Caixa"})]}):a.jsxs(a.Fragment,{children:[a.jsx(ld,{onClick:()=>ue(!1),children:"Cancelar"}),a.jsx(ce,{onClick:()=>rt(!0),children:"Confirmar Fechamento"})]})})]})]})},Br=()=>{const te=dn=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(dn||0)),[T,O]=p.useState(!1),[X,G]=p.useState(!1),[L,Re]=p.useState(""),[rt,lt]=p.useState(""),[$t,Fe]=p.useState(!1),It=async()=>{try{Fe(!0);const dn=String(L||"").replace(/\D/g,""),Gr=dn?Number(dn)/100:0;if(Gr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await _f({codigoEmpresa:r?.codigo_empresa}),await jT({tipo:"sangria",valor:Gr,observacao:rt,codigoEmpresa:r?.codigo_empresa}),O(!1),Re(""),lt(""),await ln(),e({title:"Sangria registrada",variant:"success"})}catch(dn){e({title:"Falha ao registrar sangria",description:dn?.message||"Tente novamente",variant:"destructive"})}finally{Fe(!1)}},[Sr,kr]=p.useState(""),[pr,yn]=p.useState(""),[In,Xn]=p.useState(!1),En=async()=>{try{Xn(!0);const dn=String(Sr||"").replace(/\D/g,""),Gr=dn?Number(dn)/100:0;if(Gr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await _f({codigoEmpresa:r?.codigo_empresa}),await jT({tipo:"suprimento",valor:Gr,observacao:pr,codigoEmpresa:r?.codigo_empresa}),G(!1),kr(""),yn(""),await ln(),e({title:"Suprimento registrado",variant:"success"})}catch(dn){e({title:"Falha ao registrar suprimento",description:dn?.message||"Tente novamente",variant:"destructive"})}finally{Xn(!1)}};return a.jsx(xn,{open:z,onOpenChange:H,children:a.jsxs(vn,{className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:dn=>dn.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),a.jsx(On,{children:pe?"Carregando resumo...":V?"Resumo da sesso atual do caixa.":"Nenhuma sesso de caixa aberta."})]}),V?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-1 overflow-y-auto pr-1",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Inicial"}),a.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:te(V.saldo_inicial)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Entradas"}),a.jsx("div",{className:"text-base md:text-lg font-bold text-success tabular-nums leading-tight",children:te(V.totalEntradas)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Sadas"}),a.jsx("div",{className:"text-base md:text-lg font-bold text-danger tabular-nums leading-tight",children:te(V.totalSangria)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Atual"}),a.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:te((V.saldo_inicial||0)+(V.totalEntradas||0)-(V.totalSangria||0))})]})]}),a.jsxs("div",{className:"mt-5",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("h4",{className:"text-sm font-semibold text-text-secondary",children:"Totais por Finalizadora"})}),Object.keys(V.totalPorFinalizadora||{}).length===0?a.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):a.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(V.totalPorFinalizadora||{}).map(([dn,Gr])=>a.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(dn)}),a.jsx("span",{className:"text-sm font-semibold tabular-nums",children:te(Gr)})]},dn))}),a.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Suprimentos"}),a.jsx("span",{className:"text-sm font-semibold tabular-nums text-success",children:te(V.totalSuprimento||0)})]}),a.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),a.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:te(V.totalSangria||0)})]})]})]}),a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"mr-auto"}),a.jsx(ce,{variant:"outline",onClick:()=>G(!0),children:"Registrar Suprimento"}),a.jsx(ce,{variant:"destructive",onClick:()=>O(!0),children:"Registrar Sangria"}),a.jsx(ce,{variant:"secondary",onClick:()=>H(!1),children:"Fechar"})]}),a.jsx(xn,{open:X,onOpenChange:G,children:a.jsxs(vn,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:dn=>dn.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-xl font-bold",children:"Registrar Suprimento"}),a.jsx(On,{children:"Informe o valor de entrada no caixa e, opcionalmente, uma observao."})]}),a.jsxs("div",{className:"flex-1 flex flex-col space-y-3",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"r-valor",children:"Valor"}),a.jsx(Je,{id:"r-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:Sr,onChange:dn=>{const Gr=(dn.target.value||"").replace(/\D/g,""),ga=Gr?Number(Gr)/100:0,Ma=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(ga);kr(Ma)},onKeyDown:dn=>{dn.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(dn.key)&&(/^[0-9]$/.test(dn.key)||dn.preventDefault())},onBeforeInput:dn=>{const Gr=dn.data??"";Gr&&/\D/.test(Gr)&&dn.preventDefault()}})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"r-obs",children:"Observao"}),a.jsx(Je,{id:"r-obs",placeholder:"Opcional",value:pr,onChange:dn=>yn(dn.target.value)})]})]}),a.jsxs(ra,{children:[a.jsx(ce,{variant:"outline",onClick:()=>G(!1),disabled:In,children:"Cancelar"}),a.jsx(ce,{onClick:En,disabled:In,children:In?"Registrando...":"Confirmar"})]})]})}),a.jsx(xn,{open:T,onOpenChange:O,children:a.jsxs(vn,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:dn=>dn.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-xl font-bold",children:"Registrar Sangria"}),a.jsx(On,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"s-valor",children:"Valor"}),a.jsx(Je,{id:"s-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:L,onChange:dn=>{const Gr=(dn.target.value||"").replace(/\D/g,""),ga=Gr?Number(Gr)/100:0,Ma=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(ga);Re(Ma)},onKeyDown:dn=>{dn.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(dn.key)&&(/^[0-9]$/.test(dn.key)||dn.preventDefault())},onBeforeInput:dn=>{const Gr=dn.data??"";Gr&&/\D/.test(Gr)&&dn.preventDefault()}})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"s-obs",children:"Observao"}),a.jsx(Je,{id:"s-obs",placeholder:"Opcional",value:rt,onChange:dn=>lt(dn.target.value)})]})]}),a.jsxs(ra,{children:[a.jsx(ce,{variant:"outline",onClick:()=>O(!1),disabled:$t,children:"Cancelar"}),a.jsx(ce,{onClick:It,disabled:$t,children:$t?"Registrando...":"Confirmar"})]})]})})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma sesso de caixa aberta."})]})})},zr=r?.codigo_empresa||"anon",_t={comandaId:`balcao:comandaId:${zr}`,items:`balcao:items:${zr}`,customerName:`balcao:customer:${zr}`,clientChosen:`balcao:clientChosen:${zr}`,pendingClientIds:`balcao:pendingClientIds:${zr}`,missCount:`balcao:missCount:${zr}`,lastMissTs:`balcao:lastMissTs:${zr}`},Jr=async(te,T=3)=>{if(!te)return;const O=r?.codigo_empresa,X=++wt.current;for(let G=0;G<T;G++)try{const L=await ds({comandaId:te,codigoEmpresa:O});if(X!==wt.current)return;const Re=(L||[]).map(rt=>({id:rt.id,productId:rt.produto_id,name:rt.descricao||"Item",price:Number(rt.preco_unitario||0),quantity:Number(rt.quantidade||1)}));c(Re);try{const rt=await ni({comandaId:te,codigoEmpresa:O});if(X!==wt.current)return;const lt=(rt||[]).map(It=>It?.nome).filter(Boolean),$t=lt.length?lt.join(", "):"";b($t),ir(!!$t);const Fe=Array.from(new Set((rt||[]).map(It=>It?.cliente_id).filter(Boolean)));Fe.length>0&&fr(Fe)}catch{b(""),ir(!1)}break}catch(L){if(G===T-1)e({title:"Falha ao atualizar itens",description:L?.message||"Tente novamente",variant:"destructive"});else{const Re=350*(G+1),rt=Math.floor(Math.random()*120);await new Promise(lt=>setTimeout(lt,Re+rt))}}},mn=async()=>{try{u(!0);let te=setTimeout(()=>{br.current&&u(!1)},1e4);const T=r?.codigo_empresa;if(!T){br.current&&u(!1);return}try{const L=localStorage.getItem(_t.comandaId),Re=JSON.parse(localStorage.getItem(_t.items)||"[]"),rt=localStorage.getItem(_t.customerName)||"",lt=localStorage.getItem(_t.clientChosen),$t=JSON.parse(localStorage.getItem(_t.pendingClientIds)||"[]");L&&o(Number.isNaN(+L)?L:Number(L)),Array.isArray(Re)&&Re.length>0&&c(Re),rt&&b(rt),lt==="true"&&ir(!0),Array.isArray($t)&&$t.length>0&&fr($t)}catch{}const O=localStorage.getItem(_t.comandaId),X=O?Number.isNaN(+O)?O:Number(O):null,G=await $v({codigoEmpresa:T}).catch(()=>null);if(G?.id)o(G.id),await Jr(G.id);else if(X)o(X),await Jr(X,3);else{let L=0,Re=0;try{L=Number(localStorage.getItem(_t.missCount)||"0"),Re=Number(localStorage.getItem(_t.lastMissTs)||"0")}catch{}const rt=Date.now(),$t=rt-Re<9e4?L+1:1;try{localStorage.setItem(_t.missCount,String($t)),localStorage.setItem(_t.lastMissTs,String(rt))}catch{}try{const Fe=localStorage.getItem(_t.customerName)||"",It=localStorage.getItem(_t.clientChosen)==="true",Sr=JSON.parse(localStorage.getItem(_t.pendingClientIds)||"[]");b(Fe||""),ir(!!It),fr(Array.isArray(Sr)?Sr:[])}catch{}if(o(null),$t>=2){c([]);try{localStorage.removeItem(_t.comandaId),localStorage.removeItem(_t.items)}catch{}}else try{const Fe=JSON.parse(localStorage.getItem(_t.items)||"[]");Array.isArray(Fe)&&Fe.length>0&&c(Fe)}catch{}}try{const L=await fu({includeInactive:!1,search:w?.trim()||void 0,codigoEmpresa:T});br.current&&i(L||[])}catch{i([])}clearTimeout(te)}catch(te){e({title:"Falha ao carregar Modo Balco",description:te?.message||"Tente novamente",variant:"destructive"})}finally{br.current&&u(!1)}},ma=async()=>{try{F(!0),v(!0);const te=r?.codigo_empresa;if(n&&te)try{try{await fe.from("comanda_itens").delete().eq("comanda_id",n).eq("codigo_empresa",te)}catch{}try{await fe.from("comanda_clientes").delete().eq("comanda_id",n).eq("codigo_empresa",te)}catch{}await fe.from("comandas").delete().eq("id",n).eq("codigo_empresa",te)}catch{}}finally{o(null),c([]),fr([]),b(""),ir(!1),A(null);try{localStorage.removeItem(_t.comandaId),localStorage.removeItem(_t.items),localStorage.removeItem(_t.customerName)}catch{}F(!1),e({title:"Venda cancelada",variant:"success"}),v(!1)}};p.useEffect(()=>{let te=!1;(async()=>{await mn(),!te&&br.current&&!n&&(Yt.current||[]).length===0&&(te=!0,setTimeout(()=>{br.current&&mn()},700))})()},[r?.codigo_empresa]),p.useEffect(()=>{try{n&&localStorage.setItem(_t.comandaId,String(n)),localStorage.setItem(_t.items,JSON.stringify(l||[])),localStorage.setItem(_t.customerName,x||""),localStorage.setItem(_t.clientChosen,nr?"true":"false"),n?localStorage.removeItem(_t.pendingClientIds):localStorage.setItem(_t.pendingClientIds,JSON.stringify(Lt||[]))}catch{}},[n,l,x,nr,Lt]),p.useEffect(()=>{const te=()=>{n&&Jr(n,2)},T=()=>{document.visibilityState==="visible"&&n&&Jr(n,2)};return window.addEventListener("focus",te),document.addEventListener("visibilitychange",T),()=>{window.removeEventListener("focus",te),document.removeEventListener("visibilitychange",T)}},[n]),p.useEffect(()=>{const te=T=>{const O=T.target;if(!(O&&(O.tagName==="INPUT"||O.tagName==="TEXTAREA"))){if(T.key==="p"||T.key==="P"){T.preventDefault(),mt.current?.focus();return}if((T.key==="c"||T.key==="C")&&D&&nr){T.preventDefault(),Xt(!0);return}if(T.key==="Escape"){if(ke){et(!1);return}if(yr){Xt(!1);return}if(Ne){Z(!1);return}if(Rt){Nt(!1);return}}}};return window.addEventListener("keydown",te),()=>window.removeEventListener("keydown",te)},[D,nr,ke,yr,Ne,Rt]),p.useEffect(()=>{const te=O=>{if(!Dt||!ye.current)return;const G=ye.current.getBoundingClientRect(),L=18;G.width-L;const rt=(O.clientX-G.left)/G.width*100;rt>=20&&rt<=80&&ft(rt)},T=()=>{if(Dt){Ft(!1);try{localStorage.setItem("balcao_left_panel_width",String(gt))}catch{}}};return Dt&&(document.addEventListener("mousemove",te),document.addEventListener("mouseup",T),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",te),document.removeEventListener("mouseup",T),document.body.style.cursor="",document.body.style.userSelect=""}},[Dt,gt]),p.useEffect(()=>{let te=!0;const T=setTimeout(async()=>{try{const O=await fu({includeInactive:!1,search:w?.trim()||void 0,codigoEmpresa:r?.codigo_empresa});if(!te)return;let X=O||[];if(w?.trim()){const G=w.trim().toLowerCase();X=X.filter(L=>(L.name||"").toLowerCase().includes(G)||(L.code||"").toLowerCase().includes(G))}X.sort((G,L)=>{const Re=G.code||"",rt=L.code||"";return/^\d+$/.test(Re)&&/^\d+$/.test(rt)?parseInt(Re,10)-parseInt(rt,10):Re.localeCompare(rt)}),i(X)}catch{te&&i([])}},300);return()=>{te=!1,clearTimeout(T)}},[w]),p.useEffect(()=>{if(J)return;let te=!0;const T=async()=>{try{const X=r?.codigo_empresa;if(!X)return;const G=await Mm({codigoEmpresa:X});if(!te)return;const L=new Map;for(const Re of G||[]){const rt=Re.produto_id,lt=Number(Re.quantidade||0);L.set(rt,(L.get(rt)||0)+lt)}R(L)}catch(X){console.error("[BalcaoPage] Erro ao buscar estoque reservado:",X),te&&R(new Map)}};T();const O=setInterval(T,5e3);return()=>{te=!1,clearInterval(O)}},[r?.codigo_empresa,l,J]),p.useEffect(()=>{if(J)return;let te=!0;const T=setTimeout(async()=>{try{const O=await ib({searchTerm:Mt,limit:20,codigoEmpresa:r?.codigo_empresa});if(!te)return;const X=(O||[]).slice().sort((G,L)=>Number(G?.codigo||0)-Number(L?.codigo||0));if(kt(X),!n&&!nr&&yr&&(!Lt||Lt.length===0)){const G=X?.find(L=>L?.codigo===0);if(G){fr([G.id]);try{localStorage.setItem(_t.pendingClientIds,JSON.stringify([G.id]))}catch{}}}}catch{te&&kt([])}},250);return()=>{te=!1,clearTimeout(T)}},[Mt,yr,J]);const Nn=p.useMemo(()=>l.reduce((te,T)=>te+Number(T.price||0)*Number(T.quantity||0),0),[l]),re=p.useMemo(()=>{const te=new Map;for(const T of l||[]){const O=T.productId;if(!O)continue;const X=Number(T.quantity||0);te.set(O,(te.get(O)||0)+X)}return te},[l]),Te=async(te,T={})=>{try{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}if(!nr&&!T.skipClientCheck){A(te),Xt(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de vender.",variant:"warning"});return}const O=r?.codigo_empresa;if(!O){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}if(_)return;const X=Number(te.stock??te.currentStock??0),G=I.get(te.id)||0,L=Math.max(0,X-G),Re=Number(te.minStock??0);if(L<=0){e({title:"Sem estoque disponvel",description:`Produto "${te.name}" est sem estoque (${X} total, ${G} reservado em outras comandas).`,variant:"destructive"});return}C(te.id);let rt=n;const lt=!rt;if(!rt)try{h(!0);const It=await Jj({codigoEmpresa:O});rt=It.id,o(It.id),await new Promise(kr=>setTimeout(kr,300));const{data:Sr}=await fe.from("comandas").select("id").eq("id",rt).eq("codigo_empresa",O).single();if(!Sr)throw new Error("Comanda criada mas no acessvel via RLS")}catch(It){if(It?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para vender",description:"Voc precisa abrir o caixa antes de iniciar uma comanda no Balco.",variant:"warning"});return}throw It}finally{h(!1)}const $t=Number(te.salePrice??te.price??0),Fe=(Yt.current||[]).find(It=>It.productId===te.id);Fe?await ed({itemId:Fe.id,quantidade:Number(Fe.quantity||0)+1,codigoEmpresa:O}):await _T({comandaId:rt,produtoId:te.id,descricao:te.name,quantidade:1,precoUnitario:$t,codigoEmpresa:O}),await Jr(rt);try{const It=await Mm({codigoEmpresa:O}),Sr=new Map;for(const kr of It||[]){const pr=kr.produto_id,yn=Number(kr.quantidade||0);Sr.set(pr,(Sr.get(pr)||0)+yn)}R(Sr)}catch(It){console.error("[BalcaoPage:addProduct] Erro ao atualizar estoque reservado:",It)}if(lt)try{const It=Array.from(new Set(Lt||[]));if(It.length>0){await lb({comandaId:rt,clienteIds:It,nomesLivres:[],codigoEmpresa:O,replace:!0}),await Jr(rt);const kr=(await ni({comandaId:rt,codigoEmpresa:O})||[]).map(pr=>pr?.nome).filter(Boolean);b(kr.length?kr.join(", "):""),ir(!0);try{localStorage.removeItem(_t.pendingClientIds),localStorage.setItem(_t.customerName,kr.length?kr.join(", "):""),localStorage.setItem(_t.clientChosen,"true")}catch(pr){console.error("Erro ao atualizar cache local:",pr)}}}catch(It){console.error("Erro ao associar clientes:",It)}X-1<=0?e({title:"ltima unidade vendida",description:`"${te.name}" esgotou aps esta venda.`,variant:"warning"}):X-1<=Re?e({title:"Estoque baixo",description:`"${te.name}" atingiu nvel de estoque baixo.`,variant:"warning"}):e({title:"Produto adicionado",description:te.name,variant:"success"})}catch(O){const X=String(O?.message||"").toLowerCase();O?.code==="OUT_OF_STOCK"||X.includes("sem estoque")?e({title:"Sem estoque",description:"Este produto est sem estoque.",variant:"destructive"}):O?.code==="INSUFFICIENT_STOCK"||X.includes("insuficiente")?e({title:"Estoque insuficiente",description:O?.message||"Quantidade maior que o disponvel.",variant:"destructive"}):e({title:"Falha ao adicionar",description:O?.message||"Tente novamente",variant:"destructive"})}finally{C(null)}},ot=async()=>{try{if(ee(!0),!nr){Xt(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de pagar.",variant:"warning"}),ee(!1);return}const te=r?.codigo_empresa;if(!te){e({title:"Empresa no definida",variant:"destructive"});return}if(!n)try{h(!0);const It=await Jj({codigoEmpresa:te});if(!It?.id){e({title:"Comanda no encontrada",description:"Abra uma comanda antes de pagar.",variant:"destructive"}),ee(!1);return}o(It.id)}catch(It){if(It?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),ee(!1);return}throw It}finally{h(!1)}try{await zGe({comandaId:n,codigoEmpresa:te})}catch(It){const Sr=Array.isArray(It?.items)&&It.items.length?It.items.map(kr=>`${kr.name} (solicitado ${kr.solicitado}, estoque ${kr.estoque})`).join("; "):It?.message||"Estoque insuficiente na comanda";e({title:"Estoque insuficiente",description:Sr,variant:"destructive",duration:7e3}),ee(!1);return}const T=await Wm({somenteAtivas:!0,codigoEmpresa:te});le(T||[]);let O=[];try{const It=await ni({comandaId:n,codigoEmpresa:te});O=(Array.isArray(It)?It:[]).map(kr=>{const pr=kr?.cliente_id??kr?.clientes?.id??null,yn=kr?.clientes?.nome??kr?.nome??kr?.nome_livre??"";return pr?{id:pr,nome:yn}:null}).filter(Boolean)}catch{O=[]}At(O);const X=T&&T[0]&&T[0].id?T[0].id:null,G=Lt&&Lt.length>0?Lt[0]:O[0]?.id||null;let L=0;try{L=(await ds({comandaId:n,codigoEmpresa:te})||[]).reduce((Sr,kr)=>Sr+Number(kr.quantidade||0)*Number(kr.preco_unitario||0),0)}catch{}const Re=(T||[]).find(It=>String(It.id)===String(X)),rt=Number(Re?.taxa_percentual||0),lt=rt>0,$t=lt?L*(1+rt/100):L,Fe=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format($t);Le([{id:1,clientId:G,methodId:X,value:Fe,chargeFee:lt}]),ie(2),Z(!0),ee(!1);return}catch(te){if(te?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),ee(!1);return}e({title:"Falha ao iniciar pagamento",description:te?.message||"Tente novamente",variant:"destructive"})}finally{ee(!1)}};return a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsx("div",{className:"md:hidden mb-2 w-full",children:a.jsx(_c,{value:"balcao",onValueChange:te=>{te==="mesas"&&t("/vendas"),te==="balcao"&&t("/balcao"),te==="historico"&&t("/historico")},children:a.jsxs(ql,{className:"grid w-full grid-cols-3",children:[a.jsx(ca,{value:"mesas",className:"text-xs",children:"Mesas"}),a.jsx(ca,{value:"balcao",className:"text-xs",children:"Balco"}),a.jsx(ca,{value:"historico",className:"text-xs",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[a.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:a.jsx(_c,{value:"balcao",onValueChange:te=>{te==="mesas"&&t("/vendas"),te==="balcao"&&t("/balcao"),te==="historico"&&t("/historico")},children:a.jsxs(ql,{className:"inline-flex",children:[a.jsx(ca,{value:"mesas",className:"text-sm",children:"Mesas"}),a.jsx(ca,{value:"balcao",className:"text-sm",children:"Balco"}),a.jsx(ca,{value:"historico",className:"text-sm",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 md:ml-auto",children:[a.jsx(Wt,{}),a.jsx(Zt,{}),a.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>H(!0),className:"px-3",children:[a.jsx(i4,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"})]})]})]}),a.jsx("div",{className:"md:hidden flex-1 flex flex-col",children:a.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden bg-surface flex-1 min-h-0",children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),a.jsx("div",{className:"text-base font-bold truncate",children:"Balco"}),nr&&x&&a.jsx("div",{className:"text-[11px] text-text-muted truncate mt-0.5",children:x})]}),a.jsx("div",{className:"flex flex-col items-end gap-1",children:nr?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(ce,{size:"sm",className:"h-8 px-2 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}et(!0)},children:[a.jsx(ro,{className:"h-4 w-4 mr-1"})," Produto"]}),a.jsx(ce,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs",onClick:()=>Xt(!0),children:"+ Cliente"})]}),a.jsxs("span",{className:"text-xs text-text-muted whitespace-nowrap",children:["Total: R$ ",Nn.toFixed(2)]})]}):a.jsx(ce,{size:"sm",className:"h-8 px-3 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Xt(!0)},children:"Iniciar venda"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-3 thin-scroll min-h-0",children:nr?l.length===0?a.jsxs("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:[a.jsx("div",{children:"Comanda criada para o cliente."}),a.jsxs("div",{children:["Use o boto ",a.jsx("span",{className:"font-semibold",children:"Produto"})," para adicionar itens."]})]}):a.jsx("ul",{className:"space-y-2",children:l.map(te=>a.jsxs("li",{className:"p-2 rounded-md border border-border/40 bg-surface-2",children:[a.jsx("div",{className:"text-sm font-medium truncate",title:te.name,children:te.name}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ce,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async T=>{T.stopPropagation();const O=r?.codigo_empresa;if(!O){e({title:"Empresa no definida",variant:"destructive"});return}const X=Number(te.quantity||1)-1;try{X<=0?(await Bv({itemId:te.id,codigoEmpresa:O}),c(G=>G.filter(L=>L.id!==te.id))):(await ed({itemId:te.id,quantidade:X,codigoEmpresa:O}),c(G=>G.map(L=>L.id===te.id?{...L,quantity:X}:L)))}catch(G){e({title:"Falha ao atualizar item",description:G?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),a.jsx("span",{className:"w-7 text-center text-sm font-semibold",children:te.quantity}),a.jsx(ce,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async T=>{T.stopPropagation();const O=r?.codigo_empresa;if(!O){e({title:"Empresa no definida",variant:"destructive"});return}const X=Number(te.quantity||1)+1;try{await ed({itemId:te.id,quantidade:X,codigoEmpresa:O}),c(G=>G.map(L=>L.id===te.id?{...L,quantity:X}:L))}catch(G){e({title:"Falha ao atualizar item",description:G?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),a.jsxs("span",{className:"text-sm font-semibold whitespace-nowrap",children:["R$ ",(Number(te.quantity)*Number(te.price)).toFixed(2)]})]})]},te.id))}):a.jsx("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:a.jsxs("div",{children:["Para comear, toque em ",a.jsx("span",{className:"font-semibold",children:"Iniciar venda"})," e selecione o cliente."]})})}),a.jsx("div",{className:"p-3 border-t border-border flex gap-2",children:nr?a.jsxs(a.Fragment,{children:[a.jsx(ce,{className:"flex-1",variant:"outline",size:"sm",onClick:ma,disabled:P,children:"Cancelar"}),a.jsx(ce,{className:"flex-1",size:"sm",disabled:Nn<=0,onClick:ot,children:"Finalizar"})]}):a.jsx(ce,{className:"flex-1",size:"sm",variant:"outline",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Xt(!0)},children:"Iniciar venda"})})]})}),a.jsx(Br,{}),a.jsx(xn,{open:Rt,onOpenChange:te=>{Nt(te),te||ut(null)},children:a.jsxs(vn,{className:"sm:max-w-[420px] w-full max-h-[85vh] flex flex-col animate-none",onKeyDown:te=>te.stopPropagation(),onPointerDownOutside:te=>te.stopPropagation(),onInteractOutside:te=>te.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-xl font-bold break-words",title:st?.name||"",children:st?.name||"Produto"}),a.jsx(On,{children:"Detalhes do produto e aes rpidas."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),a.jsx("span",{className:"text-sm font-semibold",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(st?.price??st?.salePrice??0))})]}),st?.category?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),a.jsx("span",{className:"text-sm font-medium",children:st.category})]}):null,a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof st?.stock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),a.jsx("div",{className:"text-base font-semibold",children:st.stock})]}),typeof st?.minStock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),a.jsx("div",{className:"text-base font-semibold",children:st.minStock})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),a.jsxs("div",{className:"text-base font-semibold",children:["x",re.get(st?.id)||0]})]})]})]}),a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsxs(ce,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{st&&t("/produtos",{state:{productId:st.id,productName:st.name}})},children:[a.jsx(Gs,{className:"w-4 h-4"}),a.jsx("span",{children:"Info"})]}),a.jsx(ce,{variant:"outline",onClick:()=>{Nt(!1),ut(null)},children:"Fechar"}),a.jsx(ce,{onClick:async()=>{st&&(await Te(st,{skipClientCheck:!1}),Nt(!1),ut(null))},children:"Adicionar"})]})]})}),(f||m||g)&&a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80",children:a.jsxs("div",{className:"px-8 py-6 rounded-xl bg-surface border border-border shadow-2xl flex flex-col items-center gap-4 max-w-sm w-[85vw] text-center",children:[a.jsx("div",{className:"w-8 h-8 rounded-full border-4 border-brand border-t-transparent animate-spin","aria-hidden":"true"}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block text-base font-semibold text-text-primary",children:f?"Abrindo venda...":m?"Cancelando venda...":"Fechando conta..."}),a.jsx("span",{className:"block text-xs text-text-muted",children:f?"Aguarde, estamos iniciando a venda e sincronizando com os dispositivos.":m?"Aguarde, estamos cancelando a venda e limpando os itens.":"Aguarde, estamos registrando o pagamento e encerrando a venda."})]})]})}),a.jsx(xn,{open:ke,onOpenChange:et,children:a.jsxs(vn,{className:"sm:max-w-xl w-[92vw] max-h-[85vh] flex flex-col overflow-hidden animate-none",onOpenAutoFocus:te=>te.preventDefault(),onKeyDown:te=>te.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-xl font-bold",children:"Adicionar Produtos"}),a.jsx(On,{children:"Busque e adicione produtos  comanda do balco."})]}),a.jsx("div",{className:"p-4 pt-0",children:a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar produto...",className:"pl-9",value:Me,onChange:te=>$e(te.target.value)})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4 thin-scroll",children:[a.jsx("ul",{className:"space-y-2",children:(s||[]).filter(te=>{const T=(Me||"").toLowerCase();if(!T)return!0;const O=String(te.name||te.descricao||"").toLowerCase(),X=String(te.code||te.codigo||"").toLowerCase();return O.includes(T)||X.includes(T)}).sort((te,T)=>{const O=te.code?parseInt(te.code,10):999999,X=T.code?parseInt(T.code,10):999999;return O-X}).map(te=>{const T=re.get(te.id)||0,O=Number(te.stock??te.currentStock??0),X=Math.max(0,O-T),G=Number(te.salePrice??te.price??0);return a.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors border border-border/40",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("p",{className:"font-semibold truncate max-w-[200px]",title:`${te.code?`[${te.code}] `:""}${te.name}`,children:[te.code&&a.jsxs("span",{className:"text-text-muted",children:["[",te.code,"]"]})," ",te.name]}),T>0&&a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",T]}),a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",X]})]}),a.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",G.toFixed(2)]})]}),a.jsx(ce,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:async()=>{await Te(te)},"aria-label":`Adicionar ${te.name}`,children:a.jsx(ro,{className:"h-4 w-4"})})]},te.id)})}),Array.isArray(s)&&s.length===0&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(Gv,{className:"w-16 h-16 text-text-muted mb-4"}),a.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum produto encontrado."})]})]}),a.jsx(ra,{children:a.jsx(ce,{variant:"outline",onClick:()=>et(!1),children:"Fechar"})})]})}),a.jsxs("div",{ref:ye,className:"hidden md:flex gap-0 h-full overflow-hidden relative",children:[a.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${gt}%`},children:[a.jsxs("div",{className:"p-4 border-b border-border space-y-3 cursor-pointer",onClick:te=>{te.target.tagName==="INPUT"||te.target.tagName==="BUTTON"||te.target.closest("button")||mt.current?.focus()},children:[a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar produto...",className:"pl-9",value:w,onChange:te=>j(te.target.value),onKeyDown:te=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(te.key)&&te.stopPropagation()}})]}),a.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("button",{onClick:()=>Qe("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Ge==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),a.jsx("button",{onClick:()=>Qe("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Ge==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),a.jsx("button",{onClick:()=>Qe("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Ge==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),a.jsx("button",{onClick:()=>Qe("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Ge==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{pt("code");try{localStorage.setItem("balcao_sort_order","code")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${St==="code"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por cdigo",children:"Cdigo"}),a.jsx("button",{onClick:()=>{pt("name");try{localStorage.setItem("balcao_sort_order","name")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${St==="name"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por nome",children:"A-Z"})]})]}),a.jsx("div",{className:"flex items-center gap-4 text-sm text-text-muted cursor-pointer",onClick:()=>mt.current?.focus(),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("kbd",{className:"px-2 py-1 bg-surface border border-border rounded text-xs font-mono",children:""}),a.jsx("span",{children:"Navegar"})]})})]}),a.jsx("div",{ref:mt,className:"flex-1 overflow-y-auto p-4 thin-scroll focus:outline-none focus:ring-2 focus:ring-brand/20",tabIndex:0,onClick:()=>mt.current?.focus(),onKeyDown:te=>{const T=s.filter(G=>{const L=w.trim().toLowerCase(),Re=!L||(G.name||"").toLowerCase().includes(L)||String(G.code||"").toLowerCase().includes(L);if(Ge==="all")return Re;const rt=I.get(G.id)||0,lt=Number(G.stock??G.currentStock??0),$t=Math.max(0,lt-rt);return Ge==="available"?Re&&$t>0:Ge==="low"?Re&&$t>0&&$t<=5:Ge==="out"?Re&&$t<=0:Re}).sort((G,L)=>{if(St==="name"){const Re=(G.name||"").toLowerCase(),rt=(L.name||"").toLowerCase();return Re.localeCompare(rt)}else{const Re=G.code?parseInt(G.code,10):999999,rt=L.code?parseInt(L.code,10):999999;return Re-rt}});if(!["ArrowDown","ArrowUp","Home","End"].includes(te.key))return;te.preventDefault();const O=Ee||0,X=T.length;if(te.key==="ArrowDown"){const G=Math.min(O+1,X-1);qe(G),requestAnimationFrame(()=>Et.current[G]?.scrollIntoView({block:"nearest"}))}if(te.key==="ArrowUp"){const G=Math.max(O-1,0);qe(G),requestAnimationFrame(()=>Et.current[G]?.scrollIntoView({block:"nearest"}))}if(te.key==="Home"&&(qe(0),requestAnimationFrame(()=>Et.current[0]?.scrollIntoView({block:"nearest"}))),te.key==="End"){const G=Math.max(0,X-1);qe(G),requestAnimationFrame(()=>Et.current[G]?.scrollIntoView({block:"nearest"}))}},children:(s||[]).length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12",children:[a.jsx(Gv,{className:"w-16 h-16 text-text-muted mb-4"}),a.jsx("p",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto cadastrado"}),a.jsx("p",{className:"text-sm text-text-muted mb-6 text-center",children:"Cadastre produtos para comear a vender"}),a.jsxs(ce,{onClick:()=>t("/produtos"),children:[a.jsx(ro,{className:"mr-2 h-4 w-4"}),"Cadastrar Produto"]})]}):a.jsx("ul",{className:"space-y-2",children:s.filter(te=>{const T=w.trim().toLowerCase(),O=!T||(te.name||"").toLowerCase().includes(T)||String(te.code||"").toLowerCase().includes(T);if(Ge==="all")return O;const X=I.get(te.id)||0,G=Number(te.stock??te.currentStock??0),L=Math.max(0,G-X);return Ge==="available"?O&&L>0:Ge==="low"?O&&L>0&&L<=5:Ge==="out"?O&&L<=0:O}).sort((te,T)=>{if(St==="name"){const O=(te.name||"").toLowerCase(),X=(T.name||"").toLowerCase();return O.localeCompare(X)}else{const O=te.code?parseInt(te.code,10):999999,X=T.code?parseInt(T.code,10):999999;return O-X}}).map((te,T)=>{const O=re.get(te.id)||0,X=I.get(te.id)||0,G=Number(te.stock??te.currentStock??0),L=Math.max(0,G-X),Re=Number(te.salePrice??te.price??0),rt=T===Ee;return a.jsx(_e.Fragment,{children:a.jsxs("li",{ref:lt=>{Et.current[T]=lt},className:`flex items-center gap-3 p-2 rounded-md transition-colors border-2 ${rt?"border-brand bg-brand/5":"border-transparent hover:bg-surface-2"} ${L===0&&O===0?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{qe(T),mt.current?.focus()},children:[a.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:lt=>{lt.stopPropagation(),ut({...te,qty:O,remaining:L,price:Re}),Nt(!0)},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsxs("p",{className:"font-semibold truncate",title:`${te.code?`[${te.code}] `:""}${te.name}`,children:[te.code&&a.jsxs("span",{className:"text-text-muted",children:["[",te.code,"]"]})," ",te.name]}),O>0&&a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",O]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Re.toFixed(2)]}),a.jsxs("span",{className:`text-xs font-medium whitespace-nowrap ${L<=0?"text-destructive":L<=5?"text-warning":"text-text-secondary"}`,children:["Estoque: ",L]})]})]}),a.jsx(ce,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:lt=>{lt.stopPropagation(),Te(te)},disabled:L===0,"aria-label":`Adicionar ${te.name}`,children:a.jsx(ro,{className:"h-4 w-4"})})]})},te.id)})})})]}),a.jsx("div",{className:"w-2 bg-border hover:bg-brand cursor-col-resize transition-colors flex-shrink-0 mx-2",onMouseDown:()=>Ft(!0),title:"Arraste para redimensionar"}),a.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${100-gt}%`},children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2 flex-wrap",children:[a.jsxs("div",{className:"min-w-0 flex-shrink",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"text-base font-bold whitespace-nowrap",children:"Balco"}),x?a.jsx("span",{className:"truncate text-[11px] px-2 py-0.5 rounded-full border border-border bg-surface-2 text-text-secondary",children:x}):null]})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap",children:[a.jsxs(ce,{size:"sm",className:"md:hidden h-8 px-2 text-xs whitespace-nowrap bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}et(!0)},title:"Adicionar produto",children:[a.jsx(ro,{className:"h-4 w-4 mr-1"}),"Produto"]}),nr&&a.jsx(ce,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs whitespace-nowrap",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar clientes.",variant:"warning"});return}Xt(!0)},children:"+ Cliente"}),nr?a.jsxs(Yd,{children:[a.jsx(Ap,{asChild:!0,children:a.jsx(ce,{size:"sm",className:"h-8 px-2 text-xs whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",disabled:P,children:P?"Cancelando...":"Cancelar"})}),a.jsxs(nd,{className:"sm:max-w-[420px] animate-none",onKeyDown:te=>te.stopPropagation(),children:[a.jsxs(ad,{children:[a.jsx(sd,{children:"Cancelar venda do balco?"}),a.jsx(id,{children:"Os itens sero descartados e a venda ser limpa. Esta ao no pode ser desfeita."})]}),a.jsxs(od,{children:[a.jsx(ld,{children:"Voltar"}),a.jsx(Jd,{onClick:ma,children:"Confirmar Cancelamento"})]})]})]}):a.jsx(ce,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs opacity-60 cursor-not-allowed whitespace-nowrap",disabled:!0,children:"Cancelar"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:nr?l.length===0?a.jsx("div",{className:"text-center text-text-muted pt-16",children:'Comanda vazia. Use o boto "+" para adicionar produtos.'}):a.jsx("ul",{className:"space-y-3 pr-1",children:l.map(te=>a.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface hover:bg-surface-2 transition-colors",children:[a.jsx("div",{className:"min-w-0 flex-1",children:a.jsx("div",{className:"font-medium truncate",title:te.name,children:te.name})}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ce,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async T=>{T.stopPropagation();const O=r?.codigo_empresa;if(!O){e({title:"Empresa no definida",variant:"destructive"});return}const X=Number(te.quantity||1)-1;try{X<=0?(await Bv({itemId:te.id,codigoEmpresa:O}),c(G=>G.filter(L=>L.id!==te.id))):(await ed({itemId:te.id,quantidade:X,codigoEmpresa:O}),c(G=>G.map(L=>L.id===te.id?{...L,quantity:X}:L)));try{const G=await Mm({codigoEmpresa:O}),L=new Map;for(const Re of G||[]){const rt=Re.produto_id,lt=Number(Re.quantidade||0);L.set(rt,(L.get(rt)||0)+lt)}R(L)}catch(G){console.error("[BalcaoPage:removeItem] Erro ao atualizar estoque reservado:",G)}}catch(G){const L=String(G?.message||"").toLowerCase();G?.code==="INSUFFICIENT_STOCK"||L.includes("insuficiente")?e({title:"Estoque insuficiente",description:G?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:G?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),a.jsx("span",{className:"w-7 text-center font-semibold",children:te.quantity}),a.jsx(ce,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async T=>{T.stopPropagation();const O=r?.codigo_empresa;if(!O){e({title:"Empresa no definida",variant:"destructive"});return}const X=Number(te.quantity||1)+1;try{await ed({itemId:te.id,quantidade:X,codigoEmpresa:O}),c(G=>G.map(L=>L.id===te.id?{...L,quantity:X}:L))}catch(G){const L=String(G?.message||"").toLowerCase();G?.code==="INSUFFICIENT_STOCK"||L.includes("insuficiente")?e({title:"Estoque insuficiente",description:G?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:G?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"font-semibold whitespace-nowrap",children:["R$ ",(Number(te.quantity)*Number(te.price)).toFixed(2)]}),a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface text-text-secondary border border-border",children:["x",te.quantity]})]})]})]},te.id))}):a.jsxs("div",{className:"text-center pt-12",children:[a.jsx("div",{className:"text-sm text-text-secondary mb-3",children:"Para comear, inicie uma nova venda e selecione o cliente."}),a.jsx(ce,{disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Xt(!0)},children:"Iniciar nova venda"})]})}),a.jsxs("div",{className:"p-4 border-t border-border",children:[a.jsxs("div",{className:"flex justify-between items-center text-lg font-bold mb-3",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",Nn.toFixed(2)]})]}),a.jsx(ce,{size:"lg",className:"w-full",onClick:ot,disabled:Nn<=0,children:"Finalizar Pagamento"})]})]})]}),a.jsx(xn,{open:Ne,onOpenChange:Z,children:a.jsxs(vn,{className:"sm:max-w-xl w-[92vw] max-h-[90vh] flex flex-col overflow-hidden animate-none",onKeyDown:te=>te.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-2xl font-bold",children:"Fechar Conta"}),a.jsx(On,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",Nn.toFixed(2)]})]}),a.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1",children:[a.jsx(De,{className:"block",children:"Pagamentos"}),(()=>null)(),(()=>null)(),(de||[]).map((te,T)=>{const O=L=>{if(!L)return x||"Cliente";const Re=String(L),rt=(dt||[]).find($t=>String($t.id)===Re);if(rt?.nome)return rt.nome;const lt=(Se||[]).find($t=>String($t.id)===Re);return lt?.nome?lt.nome:x||"Cliente"},X=(dt||[]).length>1,G=(dt||[])[0]||null;return(dt||[]).filter(L=>String(L.id)!==String(G?.id||"")),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-start",children:[a.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:de.length>1&&T>0&&a.jsx(ce,{type:"button",variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{Le(L=>{const Re=L.filter(Fe=>Fe.id!==te.id);if(Re.length===0)return[];const rt=(l||[]).reduce((Fe,It)=>Fe+Number(It.quantity||0)*Number(It.price||0),0),lt=Math.floor(rt/Re.length*100)/100,$t=rt-lt*Re.length;return Re.map((Fe,It)=>{const Sr=It===Re.length-1?lt+$t:lt;return er(Fe,Sr)})})},children:a.jsx(yl,{className:"h-4 w-4"})})}),T===0?a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:O(G?.id||te.clientId)})}):X?a.jsx("div",{className:"sm:col-span-4",children:a.jsxs(Cn,{value:te.clientId||"",onValueChange:L=>Le(Re=>Re.map(rt=>rt.id===te.id?{...rt,clientId:L}:rt)),children:[a.jsx(jn,{className:"w-full truncate",children:a.jsx(An,{placeholder:"Cliente"})}),a.jsx(_n,{children:(dt||[]).map(L=>a.jsx(nt,{value:L.id,children:L.nome},L.id))})]})}):a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:O(G?.id||te.clientId)})}),a.jsxs("div",{className:"sm:col-span-4",children:[a.jsxs(Cn,{value:te.methodId||"",onValueChange:L=>Le(Re=>Re.map(rt=>{if(rt.id!==te.id)return rt;const lt=$n(L),$t=Number(lt?.taxa_percentual||0);if($t>0){const It=Vt(rt)*(1+$t/100);return{...rt,methodId:L,chargeFee:!0,value:Hn(It)}}else{const Fe=Vt(rt);return{...rt,methodId:L,chargeFee:!1,value:Hn(Fe)}}})),children:[a.jsx(jn,{className:"w-full h-9 truncate",children:a.jsx(An,{placeholder:"Forma de pagamento"})}),a.jsx(_n,{children:(ge||[]).map(L=>a.jsx(nt,{value:L.id,children:L.nome},L.id))})]}),(()=>{const L=at(te);if(!L)return null;const Re=wr(te),rt=!!te.chargeFee;return a.jsx("div",{className:"mt-1",children:a.jsxs("button",{type:"button",onClick:()=>Le(lt=>lt.map($t=>{if($t.id!==te.id)return $t;const Fe=Vt($t);if(!rt){const It=Fe*(1+L/100);return{...$t,chargeFee:!0,value:Hn(It)}}return{...$t,chargeFee:!1,value:Hn(Fe)}})),className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",rt?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:rt?"Desmarcar taxa":"Cobrar taxa",children:[a.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",rt?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),a.jsxs("span",{children:["Taxa R$ ",Re.toFixed(2)]})]})})})()]}),a.jsx("div",{className:"sm:col-span-3",children:a.jsx(Je,{placeholder:"0,00",inputMode:"numeric",value:te.value,className:"h-9",onChange:L=>{const Re=(L.target.value||"").replace(/\D/g,""),rt=Re?Number(Re)/100:0,lt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(rt);Le($t=>$t.map(Fe=>Fe.id===te.id?{...Fe,value:lt}:Fe))},onKeyDown:L=>{L.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(L.key)&&(/^[0-9]$/.test(L.key)||L.preventDefault())},onBeforeInput:L=>{const Re=L.data??"";Re&&/\D/.test(Re)&&L.preventDefault()}})})]},te.id)}),a.jsx("div",{children:a.jsx(ce,{type:"button",variant:"secondary",size:"sm",onClick:()=>{Le(te=>{const O=Array.isArray(Lt)&&Lt.length>0?Lt:(dt||[]).map(kr=>kr.id),X=new Set(te.map(kr=>kr.clientId).filter(Boolean)),L=(O||[]).filter(kr=>!X.has(kr))[0]||O[0]||"",Re=ge[0]?.id||"",rt=$n(Re),lt=Number(rt?.taxa_percentual||0)>0,$t=[...te,{id:ae,clientId:L,methodId:Re,value:"",chargeFee:lt}],Fe=(l||[]).reduce((kr,pr)=>kr+Number(pr.quantity||0)*Number(pr.price||0),0),It=Math.floor(Fe/$t.length*100)/100,Sr=Fe-It*$t.length;return $t.map((kr,pr)=>{const yn=pr===$t.length-1?It+Sr:It;return er(kr,yn)})}),ie(te=>te+1)},children:"Adicionar forma"})}),(()=>{const te=jt(),T=Fr(),G=(l||[]).reduce((L,Re)=>L+Number(Re.quantity||0)*Number(Re.price||0),0)+T-te;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[a.jsx("span",{children:"Soma"}),a.jsxs("span",{children:["R$ ",te.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[a.jsx("span",{children:"Taxas"}),a.jsxs("span",{children:["R$ ",T.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[a.jsx("span",{children:"Restante"}),a.jsxs("span",{className:Math.abs(G)<.005?"text-success":"text-warning",children:["R$ ",G.toFixed(2)]})]})]})})()]})]}),a.jsxs(ra,{children:[a.jsx(ce,{variant:"outline",onClick:()=>Z(!1),disabled:se,children:"Cancelar"}),a.jsx(ce,{onClick:_r,disabled:se,children:se?"Processando...":"Confirmar Pagamento"})]})]})}),a.jsx(xn,{open:yr,onOpenChange:te=>Xt(te),children:a.jsxs(vn,{className:"max-w-lg",onOpenAutoFocus:te=>te.preventDefault(),onKeyDown:te=>te.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-2xl font-bold",children:"Identificar Cliente"}),a.jsx(On,{children:"Selecione um cliente cadastrado para esta venda."})]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"w-full",children:[a.jsx(De,{className:"mb-1 block",children:"Buscar cliente"}),a.jsxs("div",{className:"flex items-center gap-2 justify-between",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:Mt,onChange:te=>Qt(te.target.value),onKeyDown:te=>te.stopPropagation()})]}),a.jsx(ce,{type:"button",size:"icon",title:"Cadastrar cliente",className:"ml-2 bg-brand text-black hover:bg-brand/90 border border-brand",onClick:()=>{window.location.href="/clientes"},children:a.jsx(ro,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"mt-2 max-h-48 overflow-auto border rounded-md thin-scroll",children:a.jsxs("ul",{children:[(Se||[]).map(te=>{const T=(Lt||[]).includes(te.id);return a.jsxs("li",{className:`p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2 ${te?.codigo===0?"bg-warning/10 border-l-4 border-warning":""} ${T?"bg-surface-2":""}`,onClick:()=>{fr(O=>{const X=new Set(O||[]);X.has(te.id)?X.delete(te.id):X.add(te.id);const G=Array.from(X);try{localStorage.setItem(_t.pendingClientIds,JSON.stringify(G))}catch{}return G})},children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium",children:[te.codigo!=null?String(te.codigo)+" - ":"",te.nome,te?.codigo===0&&a.jsx("span",{className:"ml-2 text-xs text-warning",children:"(Padro)"})]})}),a.jsx(Ds,{size:16,className:T?"text-success":"text-text-muted opacity-40"})]},te.id)}),(!Se||Se.length===0)&&a.jsx("li",{className:"p-2 text-sm text-text-muted",children:"Nenhum cliente encontrado."})]})})]})}),a.jsxs(ra,{children:[a.jsx(ce,{variant:"outline",onClick:()=>Xt(!1),children:"Fechar"}),a.jsx(ce,{onClick:async()=>{try{const te=Array.from(new Set(Lt||[]));if(te.length===0){e({title:"Selecione pelo menos um cliente",variant:"warning"});return}const T=r?.codigo_empresa;if(n){try{const{data:G,error:L}=await fe.from("comandas").select("id").eq("id",n).eq("codigo_empresa",T).single();if(L||!G){console.error("[ClientWizard] Comanda no encontrada:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Reiniciando...",variant:"warning"}),o(null),c([]),ir(!1),b("");try{localStorage.removeItem(_t.comandaId),localStorage.removeItem(_t.items),localStorage.removeItem(_t.customerName),localStorage.removeItem(_t.clientChosen)}catch{}Xt(!1);return}}catch(G){console.error("[ClientWizard] Erro ao validar comanda:",G),e({title:"Erro de validao",variant:"destructive"});return}try{await lb({comandaId:n,clienteIds:te,nomesLivres:[],codigoEmpresa:T,replace:!0})}catch(G){if(G?.message?.includes("violates foreign key")){console.error("[ClientWizard] Foreign key error, limpando cache:",G),o(null),c([]);try{localStorage.removeItem(_t.comandaId),localStorage.removeItem(_t.items)}catch{}e({title:"Comanda invlida",description:"Reinicie a venda.",variant:"destructive"}),Xt(!1);return}if(!G?.message?.includes("duplicate"))throw G}const X=(await ni({comandaId:n,codigoEmpresa:T})||[]).map(G=>G?.nome).filter(Boolean);b(X.length?X.join(", "):""),ir(!0),Xt(!1)}else{if(!T){e({title:"Empresa no definida",variant:"destructive"});return}try{h(!0);const O=await Jj({codigoEmpresa:T});if(!O?.id){e({title:"Falha ao abrir venda",description:"No foi possvel criar a comanda.",variant:"destructive"});return}const X=O.id;await lb({comandaId:X,clienteIds:te,nomesLivres:[],codigoEmpresa:T,replace:!0}),o(X);const G=(Se||[]).filter(Re=>te.includes(Re.id)).map(Re=>Re?.nome).filter(Boolean),L=G.length?G.join(", "):"";b(L),ir(!0);try{localStorage.setItem(_t.comandaId,String(X)),localStorage.setItem(_t.customerName,L||""),localStorage.setItem(_t.clientChosen,"true"),localStorage.removeItem(_t.pendingClientIds)}catch{}try{await Jr(X,2)}catch{}Xt(!1)}catch(O){console.error("[ClientWizard] Erro ao criar comanda de balco:",O),e({title:"Falha ao iniciar venda",description:O?.message||"Tente novamente.",variant:"destructive"});return}finally{h(!1)}}if(E){const O=E;A(null),await Te(O,{skipClientCheck:!0})}}catch(te){e({title:"Falha ao iniciar venda",description:te?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar"})]})]})}),a.jsx(xn,{open:!!tt,onOpenChange:te=>!te&&he(null),children:a.jsx(vn,{className:"sm:max-w-[425px]",children:tt&&a.jsxs(a.Fragment,{children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-lg",children:tt.name}),a.jsx(On,{className:"text-sm",children:"Detalhes do item"})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Preo Unitrio"}),a.jsxs("p",{className:"text-lg font-bold",children:["R$ ",Number(tt.price).toFixed(2)]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Quantidade"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ce,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async te=>{te.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const O=Math.max(0,tt.quantity-1);try{O<=0?(await Bv({itemId:tt.id,codigoEmpresa:T}),he(null)):(await ed({itemId:tt.id,quantidade:O,codigoEmpresa:T}),he({...tt,quantity:O}));const X=await ds({comandaId:n,codigoEmpresa:T});c((X||[]).map(G=>({id:G.id,productId:G.produto_id,name:G.descricao||"Item",price:Number(G.preco_unitario||0),quantity:Number(G.quantidade||1)})))}catch(X){e({title:"Erro ao atualizar quantidade",description:X?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),a.jsx("span",{className:"w-8 text-center font-semibold",children:tt.quantity}),a.jsx(ce,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async te=>{te.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const O=tt.quantity+1;try{await ed({itemId:tt.id,quantidade:O,codigoEmpresa:T}),he({...tt,quantity:O});const X=await ds({comandaId:n,codigoEmpresa:T});c((X||[]).map(G=>({id:G.id,productId:G.produto_id,name:G.descricao||"Item",price:Number(G.preco_unitario||0),quantity:Number(G.quantidade||1)})))}catch(X){e({title:"Erro ao atualizar quantidade",description:X?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Subtotal"}),a.jsxs("p",{className:"text-lg font-bold",children:["R$ ",(tt.quantity*tt.price).toFixed(2)]})]})]}),a.jsx(ra,{children:a.jsx(ce,{variant:"destructive",onClick:async()=>{try{const te=r?.codigo_empresa;if(!te){e({title:"Empresa no definida",variant:"destructive"});return}await Bv({itemId:tt.id,codigoEmpresa:te});const T=await ds({comandaId:n,codigoEmpresa:te});c((T||[]).map(O=>({id:O.id,productId:O.produto_id,name:O.descricao||"Item",price:Number(O.preco_unitario||0),quantity:Number(O.quantidade||1)}))),he(null),e({title:"Item removido",variant:"success"})}catch(te){e({title:"Falha ao remover item",description:te?.message||"Tente novamente",variant:"destructive"})}},children:"Remover Item"})})]})})}),Be&&a.jsx("div",{className:"fixed left-3 right-3 z-[9999] md:hidden",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:a.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[a.jsx(Ac,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),a.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:He||"Ateno"})]})})]})}async function Aoe({userId:e,scope:t}){if(!e||!t)return null;try{const{data:r,error:n}=await fe.from("user_ui_settings").select("settings").eq("user_id",e).eq("scope",t).maybeSingle();return n?(console.error("[user_ui_settings] getUserUISettings:error",n),null):r?.settings||null}catch(r){return console.error("[user_ui_settings] getUserUISettings:exception",r),null}}async function Eoe({userId:e,scope:t,settings:r}){if(!(!e||!t))try{const n={user_id:e,scope:t,settings:r||{},updated_at:new Date().toISOString()},{error:o}=await fe.from("user_ui_settings").upsert(n,{onConflict:"user_id,scope"});o&&console.error("[user_ui_settings] saveUserUISettings:error",o)}catch(n){console.error("[user_ui_settings] saveUserUISettings:exception",n)}}function CS(e){try{const r=new DOMParser().parseFromString(e,"text/xml"),n=r.querySelector("parsererror");if(n)throw new Error("XML invlido: "+n.textContent);const o=Jat(r),s=Qat(r),i=Zat(r),l=eot(r),c=i.reduce((u,f)=>u+(f.valorTotal||0),0),d={produtos:i,fornecedor:s,pagamentos:l,nfe:{...o,totalNota:c},success:!0};return console.log("[XMLParser] Resultado final:",d),{data:d,success:!0}}catch(t){return console.error("[XMLParser] Erro ao fazer parse do XML:",t),{produtos:[],fornecedor:null,nfe:null,success:!1,error:t.message}}}function Jat(e){const t=e.querySelector("ide");if(!t)return null;let r="";const n=e.querySelector("chNFe");if(n&&(r=n.textContent.trim()),!r){const o=e.querySelector("infNFe");if(o){const s=o.getAttribute("Id");s&&(r=s.replace("NFe",""))}}return{numero:Qn(t,"nNF"),serie:Qn(t,"serie"),dataEmissao:Qn(t,"dhEmi"),chaveAcesso:r,tipo:Qn(t,"tpNF")==="0"?"Entrada":"Sada",naturezaOperacao:Qn(t,"natOp"),modelo:Qn(t,"mod")||null}}function Qat(e){const t=e.querySelector("emit");return t?{cnpj:Qn(t,"CNPJ"),razaoSocial:Qn(t,"xNome"),nomeFantasia:Qn(t,"xFant"),endereco:{logradouro:Qn(t,"xLgr"),numero:Qn(t,"nro"),bairro:Qn(t,"xBairro"),cidade:Qn(t,"xMun"),uf:Qn(t,"UF"),cep:Qn(t,"CEP"),codigoIBGE:Qn(t,"cMun"),fone:Qn(t,"fone")},ie:Qn(t,"IE"),iest:Qn(t,"IEST"),im:Qn(t,"IM"),crt:Qn(t,"CRT")}:null}function Zat(e){const t=e.querySelectorAll("det"),r=new Map;return t.forEach((n,o)=>{const s=n.querySelector("prod"),i=n.querySelector("imposto");if(!s)return;const l=Qn(s,"cProd"),c=Qn(s,"cEAN"),d=Qn(s,"xProd"),u=parseFloat(Qn(s,"qCom")||"0"),f=c&&c!=="SEM GTIN"?`ean:${c}`:l?`cod:${l}`:`nome:${d.toLowerCase().trim()}`;if(r.has(f)){const h=r.get(f);h.quantidade+=u,h.valorTotal+=parseFloat(Qn(s,"vProd")||"0")}else{const h={codigo:l,ean:c,nome:d,ncm:Qn(s,"NCM"),cest:Qn(s,"CEST"),cfop:Qn(s,"CFOP"),unidade:Qn(s,"uCom"),quantidade:u,valorUnitario:parseFloat(Qn(s,"vUnCom")||"0"),precoVenda:parseFloat(Qn(s,"vUnCom")||"0"),valorTotal:parseFloat(Qn(s,"vProd")||"0"),desconto:parseFloat(Qn(s,"vDesc")||"0"),impostos:rot(i),descricao:d,origem:o+1};r.set(f,h)}}),Array.from(r.values())}function eot(e){const t=e.querySelectorAll("pag"),r=[];return t.forEach(n=>{const o=Qn(n,"tPag"),s=parseFloat(Qn(n,"vPag")||"0");o&&r.push({codigoSefaz:o,valor:s,nome:tot(o)})}),console.log("[XMLParser] Pagamentos extrados:",r),r}function tot(e){return{"01":"Dinheiro","02":"Cheque","03":"Carto de Crdito","04":"Carto de Dbito","05":"Carto da Loja",10:"Vale Alimentao",11:"Vale Refeio",12:"Vale Presente",13:"Vale Combustvel",14:"Duplicata Mercantil",15:"Boleto Bancrio",16:"Depsito Bancrio",17:"PIX Dinmico",18:"Transferncia Bancria",19:"Programa de Fidelidade",20:"PIX Esttico",21:"Crdito em Loja",22:"Pagamento Eletrnico",90:"Sem Pagamento",99:"Outros"}[e]||"Outros"}function rot(e){if(!e)return{};const t={},r=e.querySelector("ICMS");if(r){const i=r.children[0];i&&(t.icms={cst:Qn(i,"CST"),csosn:Qn(i,"CSOSN"),aliquota:parseFloat(Qn(i,"pICMS")||"0"),valor:parseFloat(Qn(i,"vICMS")||"0"),orig:Qn(i,"orig"),fcpAliquota:parseFloat(Qn(i,"pFCP")||"0"),mva:parseFloat(Qn(i,"pMVAST")||"0"),pRedBC:parseFloat(Qn(i,"pRedBC")||"0")})}const n=e.querySelector("PIS");if(n){const i=n.children[0];i&&(t.pis={cst:Qn(i,"CST"),aliquota:parseFloat(Qn(i,"pPIS")||"0"),valor:parseFloat(Qn(i,"vPIS")||"0")})}const o=e.querySelector("COFINS");if(o){const i=o.children[0];i&&(t.cofins={cst:Qn(i,"CST"),aliquota:parseFloat(Qn(i,"pCOFINS")||"0"),valor:parseFloat(Qn(i,"vCOFINS")||"0")})}const s=e.querySelector("IPI");if(s){const i=s.querySelector("IPITrib");i&&(t.ipi={cst:Qn(i,"CST"),aliquota:parseFloat(Qn(i,"pIPI")||"0"),valor:parseFloat(Qn(i,"vIPI")||"0")})}return t}function Qn(e,t){if(!e)return"";const r=e.querySelector(t);return r?r.textContent.trim():""}function PS(e,t){const r=e.unidade?.toUpperCase().trim()||"";if(e.ean&&e.ean!=="SEM GTIN"){const o=t.find(i=>{const l=i.unit?.toUpperCase().trim()||"";return i.barcode===e.ean&&l===r});if(o)return o;const s=t.find(i=>i.barcode===e.ean);s&&console.log("[xmlParser] EAN igual mas unidade diferente (no considerar o mesmo produto):",{ean:e.ean,unidadeXML:r,unidadeSistema:(s.unit||"").toUpperCase()})}if(e.codigo){const o=t.find(i=>{const l=i.unit?.toUpperCase().trim()||"";return i.code===e.codigo&&l===r});if(o)return o;const s=t.find(i=>i.code===e.codigo);s&&console.log("[xmlParser] Cdigo igual mas unidade diferente (no considerar o mesmo produto):",{codigo:e.codigo,unidadeXML:r,unidadeSistema:(s.unit||"").toUpperCase()})}const n=e.nome?.toLowerCase().trim()||"";if(n){const o=t.find(s=>{const i=s.name?.toLowerCase().trim()||"",l=s.unit?.toUpperCase().trim()||"",c=i===n,d=l===r,u=c&&d;return c&&!d&&(console.log("[xmlParser] Nome igual mas UNIDADE diferente - NO  o mesmo produto:"),console.log("  Nome XML:",n,"| Unidade XML:",r),console.log("  Nome Sistema:",i,"| Unidade Sistema:",l)),u&&(console.log("[xmlParser] MATCH ENCONTRADO (nome + unidade):"),console.log("  XML:",n,"| Unidade:",r),console.log("  Sistema:",i,"| Unidade:",l),console.log("  Produto:",s)),u});if(o)return console.log("[xmlParser] Produto existente encontrado por nome + unidade:",o.name,o.unit),o}return console.log("[xmlParser] Nenhum produto encontrado para:",n,"| Unidade:",r),null}function XT(e,t){const r=e.valorUnitario||0,n=30,o=r>0?r/(1-n/100):0;return{code:e.codigo||"",name:e.nome||"",barcode:e.ean&&e.ean!=="SEM GTIN"?e.ean:"",ncm:e.ncm||"",cest:e.cest||"",unit:e.unidade||"UN",costPrice:r,salePrice:o,price:o,stock:0,minStock:0,status:"active",active:!0,type:"Venda",category:"Importados",cfopInterno:e.cfop||"",cstIcmsInterno:e.impostos?.icms?.cst||"",csosnInterno:e.impostos?.icms?.csosn||"",aliqIcmsInterno:e.impostos?.icms?.aliquota||0,fcpPercent:e.impostos?.icms?.fcpAliquota||0,mvaPercent:e.impostos?.icms?.mva||0,baseReduzidaPercent:e.impostos?.icms?.pRedBC||0,cstPisEntrada:e.impostos?.pis?.cst||"",aliqPisPercent:e.impostos?.pis?.aliquota||0,aliqCofinsPercent:e.impostos?.cofins?.aliquota||0,cstIpi:e.impostos?.ipi?.cst||"",aliqIpiPercent:e.impostos?.ipi?.aliquota||0,codigo_empresa:t,importedViaXML:!0,dataImportacao:new Date,xmlChave:e?.xmlChave||null,xmlNumero:e?.xmlNumero||null,xmlSerie:e?.xmlSerie||null,xmlEmissao:e?.xmlEmissao||null}}async function not(e,t){if(!e||!t)return null;const r=e.replace(/\D/g,"");try{const{data:n,error:o}=await fe.from("clientes").select("*").eq("codigo_empresa",t).eq("cnpj",r).eq("flag_fornecedor",!0).maybeSingle();if(o)throw o;return n}catch(n){throw console.error("[Suppliers] Erro ao buscar fornecedor:",n),n}}async function aot(e,t){if(!e||!t)throw new Error("Dados do fornecedor e cdigo da empresa so obrigatrios");const r=e.cnpj?.replace(/\D/g,"")||"";if(!r)throw new Error("CNPJ do fornecedor no encontrado no XML");const n={codigo_empresa:t,tipo_pessoa:"PJ",cnpj:r,nome:e.razaoSocial||"Fornecedor Importado",apelido:e.nomeFantasia||e.razaoSocial,flag_fornecedor:!0,flag_cliente:!1,status:"active",endereco:e.endereco?.logradouro||null,numero:e.endereco?.numero||null,complemento:e.endereco?.complemento||null,bairro:e.endereco?.bairro||null,cidade:e.endereco?.cidade||null,uf:e.endereco?.uf||null,cep:e.endereco?.cep?.replace(/\D/g,"")||null,cidade_ibge:e.endereco?.codigoIBGE||null,telefone:e.endereco?.fone||null,ie:e.ie||null,iest:e.iest||null,im:e.im||null};try{const{data:o,error:s}=await fe.from("clientes").insert(n).select().single();if(s)throw s;return console.log("[Suppliers] Fornecedor criado:",o),o}catch(o){throw console.error("[Suppliers] Erro ao criar fornecedor:",o),o}}async function oot(e,t){if(!e?.cnpj)throw new Error("CNPJ do fornecedor no encontrado no XML");try{const r=await not(e.cnpj,t);if(r){console.log("[Suppliers] Fornecedor encontrado:",r.razao_social||r.nome);const o={},s=e.endereco||{},i=l=>l==null||String(l).trim()===""?null:l;return!i(r.ie)&&i(e.ie)&&(o.ie=e.ie),!i(r.iest)&&i(e.iest)&&(o.iest=e.iest),!i(r.im)&&i(e.im)&&(o.im=e.im),!i(r.endereco)&&i(s.logradouro)&&(o.endereco=s.logradouro),!i(r.numero)&&i(s.numero)&&(o.numero=s.numero),!i(r.complemento)&&i(s.complemento)&&(o.complemento=s.complemento),!i(r.bairro)&&i(s.bairro)&&(o.bairro=s.bairro),!i(r.cidade)&&i(s.cidade)&&(o.cidade=s.cidade),!i(r.uf)&&i(s.uf)&&(o.uf=s.uf),!i(r.cep)&&i(s.cep)&&(o.cep=String(s.cep).replace(/\D/g,"")),!i(r.cidade_ibge)&&i(s.codigoIBGE)&&(o.cidade_ibge=s.codigoIBGE),!i(r.telefone)&&i(s.fone)&&(o.telefone=s.fone),!i(r.nome)&&i(e.razaoSocial)&&(o.nome=e.razaoSocial),!i(r.apelido)&&(i(e.nomeFantasia)||i(e.razaoSocial))&&(o.apelido=e.nomeFantasia||e.razaoSocial),Object.keys(o).length>0?(await fe.from("clientes").update(o).eq("id",r.id),console.log("[Suppliers] Fornecedor atualizado com campos faltantes:",o),{...r,...o}):r}return console.log("[Suppliers] Criando novo fornecedor:",e.razaoSocial),await aot(e,t)}catch(r){throw console.error("[Suppliers] Erro ao buscar/criar fornecedor:",r),r}}async function sot(e){if(!e)return[];try{const{data:t,error:r}=await fe.from("clientes").select("*").eq("codigo_empresa",e).eq("flag_fornecedor",!0).order("nome",{ascending:!0});if(r)throw r;return t||[]}catch(t){return console.error("[Suppliers] Erro ao listar fornecedores:",t),[]}}async function iot(e,t){if(!e||!t)return null;try{const{data:r,error:n}=await fe.from("compras").select("*").eq("codigo_empresa",t).eq("chave_nfe",e).order("ativo",{ascending:!1}).maybeSingle();if(n)throw n;return r}catch(r){throw console.error("[Purchases] Erro ao buscar compra:",r),r}}async function lot(e){const t={codigo_empresa:e.codigoEmpresa,fornecedor_id:e.fornecedorId,chave_nfe:e.chaveNfe,numero_nfe:e.numeroNfe,serie_nfe:e.serieNfe,data_emissao:e.dataEmissao,tipo_operacao:e.tipoOperacao,natureza_operacao:e.naturezaOperacao,valor_produtos:e.valorProdutos,valor_total:e.valorTotal,forma_pagamento:e.formaPagamento||null,status:"processada",observacoes:e.observacoes||null,xml_completo:e.xmlCompleto||null};try{const{data:r,error:n}=await fe.from("compras").insert(t).select().single();if(n)throw n;return console.log("[Purchases] Compra criada:",r.numero_nfe,"ID:",r.id),r}catch(r){throw console.error("[Purchases] Erro ao criar compra:",r),r}}async function koe(e,t){if(!e||!t||t.length===0)throw new Error("ID da compra e itens so obrigatrios");const r=t.map(n=>({compra_id:e,produto_id:n.produtoId||null,codigo_produto_xml:n.codigoProdutoXML||null,nome_produto_xml:n.nomeProdutoXML,ean_xml:n.eanXML||null,ncm_xml:n.ncmXML||null,cfop_xml:n.cfopXML||null,unidade_xml:n.unidadeXML||null,quantidade:n.quantidade,valor_unitario:n.valorUnitario,valor_total:n.valorTotal,valor_desconto:n.valorDesconto||0,valor_frete:n.valorFrete||0,valor_seguro:n.valorSeguro||0,valor_outras_despesas:n.valorOutrasDespesas||0,icms_aliquota:n.icmsAliquota||null,icms_valor:n.icmsValor||null,ipi_aliquota:n.ipiAliquota||null,ipi_valor:n.ipiValor||null,pis_aliquota:n.pisAliquota||null,pis_valor:n.pisValor||null,cofins_aliquota:n.cofinsAliquota||null,cofins_valor:n.cofinsValor||null,vinculado_manualmente:n.vinculadoManualmente||!1,observacoes:n.observacoes||null,selecionado_na_importacao:n.selecionadoNaImportacao||!1}));try{const{data:n,error:o}=await fe.from("compras_itens").insert(r).select();if(o)throw o;return console.log("[Purchases] Itens criados:",n.length),n}catch(n){throw console.error("[Purchases] Erro ao criar itens:",n),n}}async function cot(e,t={}){if(!e)return{data:[],count:0};try{const r=t.page&&t.page>0?t.page:1,n=t.pageSize&&t.pageSize>0?t.pageSize:100,o=(r-1)*n,s=o+n-1;let i=fe.from("compras").select("*,fornecedor:clientes!compras_fornecedor_id_fkey(id,nome,cnpj)",{count:"exact"}).eq("codigo_empresa",e);t.apenasInativas?i=i.eq("ativo",!1):t.incluirInativas||(i=i.eq("ativo",!0)),t.status&&(i=i.eq("status",t.status)),t.fornecedorId&&(i=i.eq("fornecedor_id",t.fornecedorId)),t.dataInicio&&(i=i.gte("data_emissao",t.dataInicio)),t.dataFim&&(i=i.lte("data_emissao",t.dataFim)),i=i.order("data_emissao",{ascending:!1}).range(o,s);const{data:l,error:c,count:d}=await i;if(c)throw c;return{data:l||[],count:d??0}}catch(r){return console.error("[Purchases] Erro ao listar compras:",r),{data:[],count:0}}}async function Ioe(e){try{const{data:t,error:r}=await fe.from("compras_itens").select(`
        *,
        produto:produto_id(id, nome, codigo_produto, codigo_barras, data_importacao)
      `).eq("compra_id",e).order("criado_em",{ascending:!0});if(r)throw console.error("[Purchases] Erro ao buscar itens:",r),r;return t}catch(t){throw console.error("[Purchases] Erro ao buscar itens:",t),t}}async function dot(e,t,r){if(!e||!t)throw new Error("ID da compra e motivo so obrigatrios");try{const{data:n,error:o}=await fe.from("compras").update({ativo:!1,motivo_inativacao:t,inativado_em:new Date().toISOString(),inativado_por:r}).eq("id",e).select().single();if(o)throw o;return console.log("[Purchases] Compra inativada:",e),n}catch(n){throw console.error("[Purchases] Erro ao inativar compra:",n),n}}async function uot(e){try{console.log("[Purchases] Deletando itens da compra:",e);const{error:t}=await fe.from("compras_itens").delete().eq("compra_id",e);if(t)throw console.error("[Purchases] Erro ao deletar itens:",t),t;return console.log("[Purchases] Itens deletados com sucesso"),!0}catch(t){throw console.error("[Purchases] Erro ao deletar itens:",t),t}}async function fot(e,t){try{return console.log("[Purchases] Reprocessando XML da compra:",e),await uot(e),await koe(e,t),console.log("[Purchases] XML reprocessado com sucesso"),!0}catch(r){throw console.error("[Purchases] Erro ao reprocessar XML:",r),r}}async function mot(e,t){try{console.log("[Purchases] Atualizando compra:",e,t);const{data:r,error:n}=await fe.from("compras").update({fornecedor_id:t.fornecedorId,numero_nfe:t.numeroNfe,serie_nfe:t.serieNfe,data_emissao:t.dataEmissao,tipo_operacao:t.tipoOperacao,natureza_operacao:t.naturezaOperacao,valor_produtos:t.valorProdutos,valor_total:t.valorTotal,forma_pagamento:t.formaPagamento,observacoes:t.observacoes,atualizado_em:new Date().toISOString()}).eq("id",e).select().single();if(n)throw console.error("[Purchases] Erro ao atualizar compra:",n),n;return console.log("[Purchases] Compra atualizada:",r),r}catch(r){throw console.error("[Purchases] Erro ao atualizar compra:",r),r}}function Ooe({isOpen:e,onClose:t,onSelect:r,currentProduct:n}){const{userProfile:o}=So(),[s,i]=p.useState([]),[l,c]=p.useState(!0),[d,u]=p.useState(""),[f,h]=p.useState(null);p.useEffect(()=>{e&&o?.codigo_empresa&&m()},[e,o?.codigo_empresa]);const m=async()=>{try{c(!0),console.log("[ProductSelectionModal] Carregando produtos para empresa:",o.codigo_empresa);const x=await fu({codigoEmpresa:o.codigo_empresa,includeInactive:!1,search:""});console.log("[ProductSelectionModal] Produtos carregados:",x?.length||0),console.log("[ProductSelectionModal] Primeiro produto:",x?.[0]),console.log("[ProductSelectionModal] Estrutura do produto:",Object.keys(x?.[0]||{})),i(x||[])}catch(x){console.error("[ProductSelectionModal] Erro ao carregar produtos:",x),i([])}finally{c(!1)}},v=p.useMemo(()=>{if(console.log("[ProductSelectionModal] Filtrando produtos. Total:",s.length,"Busca:",d),!d.trim())return s;const x=d.toLowerCase().trim(),b=s.filter(w=>(w.name||w.nome)?.toLowerCase().includes(x)||(w.code||w.codigo_produto)?.toLowerCase().includes(x)||(w.barcode||w.codigo_barras)?.toLowerCase().includes(x));return console.log("[ProductSelectionModal] Produtos filtrados:",b.length),b},[s,d]),g=()=>{f?(console.log("[ProductSelectionModal] Produto selecionado para vinculao:",f),console.log("[ProductSelectionModal] ID do produto:",f.id),console.log("[ProductSelectionModal] Nome do produto:",f.name),r(f),y()):console.log("[ProductSelectionModal] ERRO: Nenhum produto selecionado")},y=()=>{u(""),h(null),t()};return a.jsx(xn,{open:e,onOpenChange:y,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-3xl max-h-[80vh] overflow-hidden flex flex-col bg-black text-white border border-neutral-700",children:[a.jsxs(pn,{className:"bg-neutral-900 -mx-6 -mt-6 mb-4 px-6 py-4 border-b border-neutral-600",children:[a.jsxs(fn,{className:"flex items-center gap-2 text-white",children:[a.jsx(_d,{className:"h-5 w-5 text-yellow-500"}),"Selecionar Produto para Vinculao"]}),a.jsx(On,{className:"text-neutral-300",children:"Busque e selecione um produto cadastrado para vincular ao item do XML"})]}),a.jsx("div",{className:"px-6 pb-4",children:a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400"}),a.jsx(Je,{placeholder:"Buscar por nome, cdigo do produto ou cdigo de barras...",value:d,onChange:x=>u(x.target.value),className:"pl-10 bg-neutral-900 border-neutral-600 text-white placeholder-neutral-400 focus:border-yellow-500",autoFocus:!0})]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex flex-col px-6",children:l?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500 mb-4"}),a.jsx("p",{className:"text-neutral-400",children:"Carregando produtos..."})]})}):v.length===0?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(_d,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),a.jsx("p",{className:"text-neutral-400",children:d?"Nenhum produto encontrado":"Nenhum produto cadastrado"}),d&&a.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"Tente buscar por nome, cdigo ou cdigo de barras"})]})}):a.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:a.jsx("ul",{className:"space-y-2",children:v.map(x=>{const b=x.code||x.codigo_produto,w=x.name||x.nome||"Produto sem nome",j=x.stock||x.estoque||0,_=Number(x.salePrice||x.preco_venda||0),C=f?.id===x.id;return a.jsxs("li",{className:`flex items-center gap-3 p-3 rounded-lg transition-all cursor-pointer border-2 ${C?"border-yellow-500 bg-yellow-500/10":"border-neutral-600 bg-black hover:border-yellow-400 hover:bg-neutral-900"}`,onClick:()=>h(x),children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex items-center gap-2 mb-1",children:a.jsxs("p",{className:"font-semibold text-white truncate",title:`${b?`[${b}] `:""}${w}`,children:[b&&a.jsxs("span",{className:"text-neutral-400",children:["[",b,"]"]})," ",w]})}),a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("p",{className:"text-sm text-neutral-300",children:["R$ ",_.toFixed(2)]}),a.jsxs("span",{className:"text-xs font-medium text-neutral-400 whitespace-nowrap",children:["Estoque: ",j]})]})]}),C&&a.jsx(zf,{className:"h-5 w-5 text-yellow-500 flex-shrink-0"})]},x.id)})})})}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-neutral-600 px-6 pb-6",children:[a.jsxs("div",{className:"text-sm text-neutral-400",children:[v.length," produto",v.length!==1?"s":"",d&&` encontrado${v.length!==1?"s":""}`]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{variant:"outline",onClick:y,className:"border-neutral-600 text-neutral-300 hover:bg-neutral-700",children:"Cancelar"}),a.jsxs(ce,{onClick:g,disabled:!f,className:"gap-2 bg-yellow-600 hover:bg-yellow-700 text-black",children:[a.jsx(zf,{className:"h-4 w-4"}),"Vincular Produto"]})]})]})]})})}function Toe({isOpen:e,onClose:t,onConfirm:r,products:n,editedProducts:o,isReprocess:s=!1,allProducts:i=[]}){if(!e||!n)return null;const l=n.filter(d=>d.selected),c=l.reduce((d,u,f)=>{const h=u.originalIndex!==void 0?u.originalIndex:f,m=o[h]||{},v=m.linkedProductId,g=m.updatePrice,y=Number(m.quantity||m.qty||u.xml?.quantidade||0);let x=0;if(m.salePrice!=null?x=Number(m.salePrice):m.margin!=null&&u.xml?.valorUnitario?x=Number(u.xml.valorUnitario)*(1+m.margin/100):u.xml?.precoVenda&&(x=Number(u.xml.precoVenda)),u.isNew&&!v)d.newProducts.push({name:m.name||u.xml?.nome,quantity:y,price:x,total:y*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome});else if(v||u.existing){const b=v&&i.find(E=>E.id===v)||u.existing,w=Number(b?.stock||0),j=Number(b?.preco_venda||b?.salePrice||b?.price||0),_=s?0:y,C=s?w:w+y;d.updatedProducts.push({name:b?.name||m.name||u.xml?.nome,currentStock:w,newStock:C,stockChange:_,currentPrice:j,newPrice:g?x:j,priceChange:g?x-j:0,willUpdatePrice:g,total:y*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome,isLinked:!!v,linkedProductId:v,linkedProductName:v?b?.name:null})}else v&&d.linkedProducts.push({xmlName:u.xml?.nome,linkedName:m.name||u.xml?.nome,quantity:y,total:y*(u.xml?.valorUnitario||0),linkedProductId:v});return d.totalValue+=y*(u.xml?.valorUnitario||0),d.totalItems+=y,d},{newProducts:[],updatedProducts:[],linkedProducts:[],totalValue:0,totalItems:0});return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsx(pn,{children:a.jsxs(fn,{className:"flex items-center gap-2",children:[a.jsx(qf,{className:"h-5 w-5 text-warning"}),"Confirmar ",s?"Reprocessamento":"Importao"]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[a.jsx(_d,{className:"h-4 w-4 text-warning"}),a.jsx("span",{className:"font-medium",children:"Total de Produtos"})]}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:l.length})]}),a.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[a.jsx(Nue,{className:"h-4 w-4 text-warning"}),a.jsx("span",{className:"font-medium",children:"Total de Itens"})]}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:c.totalItems})]}),a.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[a.jsx(Ks,{className:"h-4 w-4 text-warning"}),a.jsx("span",{className:"font-medium",children:"Valor Total"})]}),a.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:["R$ ",c.totalValue.toFixed(2)]})]})]}),!s&&c.newProducts.length>0&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(ro,{className:"h-4 w-4 text-success"}),"Produtos que sero criados (",c.newProducts.length,")"]})}),a.jsx("div",{className:"p-4 space-y-3",children:c.newProducts.map((d,u)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-text-primary",children:d.name}),a.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",d.quantity,"  Preo unit.: R$ ",(d.total/d.quantity).toFixed(2),"  Total: R$ ",d.total.toFixed(2)]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})})]},u))})]}),!s&&c.updatedProducts.length>0&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(Rp,{className:"h-4 w-4 text-info"}),"Produtos que sero atualizados (",c.updatedProducts.length,")"]})}),a.jsx("div",{className:"p-4 space-y-3",children:c.updatedProducts.map((d,u)=>a.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[d.isLinked?a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(qH,{className:"h-4 w-4 text-warning"}),a.jsxs("p",{className:"font-medium text-text-primary",children:[d.xmlName,"  ",d.linkedProductName||d.name]})]}):a.jsx("p",{className:"font-medium text-text-primary",children:d.name}),a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[s?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Estoque:"}),a.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),a.jsx("span",{className:"text-text-muted",children:"(sem alterao no reprocesso)"})]}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Estoque:"}),a.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),a.jsx(Zp,{className:"h-3 w-3 text-success"}),a.jsx("span",{className:"font-medium text-success",children:d.newStock}),a.jsxs("span",{className:"text-success",children:["(+",d.stockChange,")"]})]}),d.willUpdatePrice&&d.priceChange!==0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Preo:"}),a.jsxs("span",{className:"font-medium text-text-primary",children:["R$ ",d.currentPrice.toFixed(2)]}),d.priceChange>0?a.jsx(Zp,{className:"h-3 w-3 text-success"}):a.jsx($ue,{className:"h-3 w-3 text-destructive"}),a.jsxs("span",{className:`font-medium ${d.priceChange>0?"text-success":"text-destructive"}`,children:["R$ ",d.newPrice.toFixed(2)]}),a.jsxs("span",{className:d.priceChange>0?"text-success":"text-destructive",children:["(",d.priceChange>0?"+":"","R$ ",d.priceChange.toFixed(2),")"]})]})]})]}),a.jsxs("div",{className:"text-right",children:[s?a.jsxs("p",{className:"text-xs text-text-muted",children:["Total NF-e (custo): R$ ",d.total.toFixed(2)]}):a.jsxs("p",{className:"text-xs text-text-muted",children:["Unit.: R$ ",(d.total/d.stockChange).toFixed(2)]}),a.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})]})]})},u))})]}),s&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(Rp,{className:"h-4 w-4 text-info"}),"Itens da NF-e que sero reprocessados (",l.length,")"]})}),a.jsx("div",{className:"p-4 space-y-3",children:l.map((d,u)=>{const f=d.originalIndex!==void 0?d.originalIndex:u,h=o[f]||{},m=Number(h.quantity||h.qty||d.xml?.quantidade||0),v=Number(d.xml?.valorUnitario||0),g=m*v;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-text-primary",children:d.xml?.nome}),a.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",m,"  Valor unit.: R$ ",v.toFixed(2),"  Total: R$ ",g.toFixed(2)]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"font-medium text-warning",children:["R$ ",g.toFixed(2)]})})]},u)})})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(qf,{className:"h-5 w-5 text-warning flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-warning mb-2",children:s?"Ateno - Reprocessamento":"Ateno - Importao"}),a.jsxs("ul",{className:"text-sm text-text-muted space-y-1",children:[s?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:" Os itens atuais da compra sero substitudos pelos selecionados"}),a.jsx("li",{children:" As quantidades de estoque sero ajustadas conforme as mudanas"}),a.jsx("li",{children:" Esta ao no pode ser desfeita automaticamente"})]}):a.jsxs(a.Fragment,{children:[a.jsx("li",{children:" Os produtos selecionados sero criados ou atualizados no sistema"}),a.jsx("li",{children:" As quantidades sero adicionadas ao estoque atual"}),a.jsx("li",{children:" Uma nova compra ser registrada no histrico"})]}),a.jsx("li",{children:" Verifique cuidadosamente as informaes antes de confirmar"})]})]})]})})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[a.jsxs("div",{className:"text-sm text-text-muted",children:[l.length," produto",l.length!==1?"s":""," selecionado",l.length!==1?"s":""]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{variant:"outline",onClick:t,children:"Cancelar"}),a.jsxs(ce,{onClick:r,className:"gap-2",children:[a.jsx(Rp,{className:"h-4 w-4"}),"Confirmar ",s?"Reprocessamento":"Importao"]})]})]})]})})}function hot({open:e,onOpenChange:t,products:r,codigoEmpresa:n,onSuccess:o}){const{toast:s}=no(),[i,l]=p.useState("upload"),[c,d]=p.useState(null),[u,f]=p.useState(null),[h,m]=p.useState([]),[v,g]=p.useState(!1),[y,x]=p.useState({created:0,updated:0,errors:0,details:[]}),[b,w]=p.useState({}),[j,_]=p.useState({}),[C,E]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[A,P]=p.useState({isOpen:!1}),F=()=>{const B=u?.nfe?.modelo;return B==="55"?"NF-e":B==="65"?"NFC-e":"NF-e / NFC-e"},M=async B=>{const J=B.target.files?.[0];if(!J){console.log("[XMLImport] Nenhum arquivo selecionado");return}if(console.log("[XMLImport] Arquivo selecionado:",J.name),!J.name.endsWith(".xml")){s({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}d(J);try{console.log("[XMLImport] Lendo contedo do arquivo...");const ue=await J.text();console.log("[XMLImport] Arquivo lido, parseando XML...");const Ne=CS(ue);if(console.log("[XMLImport] XML parseado:",Ne),!Ne.success){s({title:"Erro ao ler XML",description:Ne.error||"XML invlido",variant:"destructive"});return}if(!Ne.data?.produtos||Ne.data.produtos.length===0){s({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}f(Ne.data);let Z=r;try{Z=await fu({search:"",codigoEmpresa:n,includeInactive:!0})||r,console.log("[XMLImport] Produtos carregados para validao:",Z.length),console.log("[XMLImport] Nomes dos produtos:",Z.map(ee=>ee.name))}catch(se){console.warn("[XMLImport] No foi possvel carregar lista completa, usando cache:",se)}const ge=Ne.data.produtos.map((se,ee)=>{const de=PS(se,Z),Le={...se};if(se.impostos){const{icms:ae,pis:ie,cofins:dt,ipi:At}=se.impostos;ae&&(Le.icmsAliquota=ae.aliquota??Le.icmsAliquota,Le.icmsValor=ae.valor??Le.icmsValor),At&&(Le.ipiAliquota=At.aliquota??Le.ipiAliquota,Le.ipiValor=At.valor??Le.ipiValor),ie&&(Le.pisAliquota=ie.aliquota??Le.pisAliquota,Le.pisValor=ie.valor??Le.pisValor),dt&&(Le.cofinsAliquota=dt.aliquota??Le.cofinsAliquota,Le.cofinsValor=dt.valor??Le.cofinsValor)}return{xml:Le,existing:de,isNew:!de,willCreate:!de,willUpdate:!!de,selected:!0,index:ee}});m(ge);const le={};ge.forEach((se,ee)=>{se.xml.precoVenda&&(le[ee]={salePrice:Number(se.xml.precoVenda)})}),console.log("[XMLImport] Pr-populando editedProducts:",le),w(le),console.log("[XMLImport] Preview preparado, mudando para step preview. Total produtos:",ge.length),l("preview")}catch(ue){console.error("[XMLImport] Erro ao processar arquivo:",ue),s({title:"Erro ao processar XML",description:ue.message,variant:"destructive"})}},I=()=>{P({isOpen:!0})},R=async()=>{P({isOpen:!1});let B="";if(c)try{B=await c.text()}catch(Z){console.error("[XMLImport] Erro ao ler XML:",Z),s({title:"Erro ao ler XML",description:"No foi possvel ler o arquivo XML.",variant:"destructive"});return}l("processing"),g(!0);const J={created:0,updated:0,errors:0,skipped:0,details:[],supplierId:null},ue=h.filter(Z=>Z.selected);if(ue.length===0){s({title:"Nenhum produto selecionado",description:"Selecione ao menos um produto para importar.",variant:"warning"}),g(!1),l("preview");return}let Ne=null;if(u?.fornecedor)try{Ne=await oot(u.fornecedor,n),J.supplierId=Ne.id,console.log("[XMLImport] Fornecedor processado:",Ne.razao_social,"ID:",Ne.id)}catch(Z){console.error("[XMLImport] Erro ao processar fornecedor:",Z),s({title:"Aviso",description:"No foi possvel criar/vincular o fornecedor, mas os produtos sero importados.",variant:"warning"})}console.log("[XMLImport] Processando apenas produtos selecionados:",ue.length);for(const Z of ue){const ge=b[Z.index]||{},le=ge.name||Z.xml.nome,se=ge.qty!==void 0?ge.qty:Number(Z.xml.quantidade),ee=ge.margin,de=ge.salePrice,Le=ge.linkedProductId;try{if(Le&&Le!=="force-new"){se>0&&await ox({productId:Le,delta:se,codigoEmpresa:n}),J.updated++,J.details.push({produto:le,acao:`Vinculado - Estoque atualizado (+${se})`,status:"success"});continue}if(Z.isNew||Le==="force-new"){const ae=XT(Z.xml,n);if(ge.name&&(ae.name=ge.name),de!=null)ae.salePrice=de,ae.price=de;else if(ee!=null&&ee>0){const ie=ae.costPrice||0;if(ie>0){const dt=ie*(1+ee/100);ae.salePrice=dt,ae.price=dt}}else ae.salePrice!=null&&ae.price==null&&(ae.price=ae.salePrice);ae.stock=se,ae.initialStock=se,ae.currentStock=se,ae.importedViaXML=!0,ae.category="Importados",u?.nfe&&(ae.xmlChave=u.nfe.chaveAcesso||null,ae.xmlNumero=u.nfe.numero||null,ae.xmlSerie=u.nfe.serie||null,ae.xmlEmissao=u.nfe.dataEmissao||null);try{await SS(ae,{codigoEmpresa:n}),J.created++,J.details.push({produto:le,acao:"Criado",status:"success"})}catch(ie){if(ie.message?.includes("duplicate")||ie.message?.includes("unique constraint")){console.warn("[XMLImport] Produto j existe, tentando atualizar estoque:",Z.xml.nome);const At=(await fu({search:Z.xml.nome,codigoEmpresa:n,includeInactive:!0})).find(st=>{const ut=(st.name||"").toLowerCase().trim()===(Z.xml.nome||"").toLowerCase().trim(),Rt=(st.unit||"").toUpperCase().trim()===(Z.xml.unidade||"").toUpperCase().trim(),Nt=(st.barcode||"")===(Z.xml.ean||""),tt=(st.code||"")===(Z.xml.codigo||""),he=ut&&Rt||Nt&&Rt||tt&&Rt;return!he&&(Nt||tt)&&!Rt&&console.log("[XMLImport] Encontrado mesmo EAN/Cdigo porm unidade diferente. NO unir:",{nomeSistema:st.name,unidadeSistema:st.unit,nomeXML:Z.xml.nome,unidadeXML:Z.xml.unidade,ean:Z.xml.ean,codigo:Z.xml.codigo}),he});if(At&&Number(Z.xml.quantidade)>0)await ox({productId:At.id,delta:Number(Z.xml.quantidade)||0,codigoEmpresa:n}),J.updated++,J.details.push({produto:Z.xml.nome,acao:"J existe - Estoque atualizado",status:"success"});else if(At)J.skipped++,J.details.push({produto:Z.xml.nome,acao:"Sem quantidade para ajustar",status:"warning"});else try{console.log("[XMLImport] Duplicate report mas no encontrou por nome+unidade/EAN+unidade/cdigo+unidade. Tentando criar novo produto.");const st=XT(Z.xml,n);st.salePrice!=null&&st.price==null&&(st.price=st.salePrice);const ut=Number(Z.xml.quantidade)||0;st.stock=ut,st.initialStock=ut,st.currentStock=ut,await SS(st,{codigoEmpresa:n}),J.created++,J.details.push({produto:Z.xml.nome,acao:"Criado aps checagem",status:"success"})}catch(st){console.warn("[XMLImport] Falhou ao criar aps duplicate:",st),J.skipped++,J.details.push({produto:Z.xml.nome,acao:"Falha ao criar aps duplicate",status:"warning"})}}else throw ie}}else{const ae=Number(Z.xml.quantidade)||0;if(ae>0&&await ox({productId:Z.existing.id,delta:ae,codigoEmpresa:n}),ge.updatePrice===!0){const dt=Number(Z.xml.valorUnitario)||0;if(dt>0)try{const At={costPrice:dt};if(de!=null)At.salePrice=de,At.price=de;else if(ee!=null&&ee>0){const st=dt*(1+ee/100);At.salePrice=st,At.price=st}await Yw(Z.existing.id,At)}catch(At){console.warn("[XMLImport] Falha ao atualizar preo do produto existente",At)}}try{const dt=Z.existing||{},At=Z.xml.impostos||{},st=At.icms||{},ut=At.pis||{},Rt=At.cofins||{},Nt=At.ipi||{},tt={},he=ke=>ke==null||typeof ke=="string"&&ke.trim()==="";he(dt.ncm)&&Z.xml.ncm&&(tt.ncm=Z.xml.ncm),he(dt.cfopInterno)&&Z.xml.cfop&&(tt.cfopInterno=Z.xml.cfop),he(dt.cstIcmsInterno)&&st.cst&&(tt.cstIcmsInterno=st.cst),he(dt.csosnInterno)&&st.csosn&&(tt.csosnInterno=st.csosn),he(dt.cstIpi)&&Nt.cst&&(tt.cstIpi=Nt.cst),he(dt.cstPisEntrada)&&ut.cst&&(tt.cstPisEntrada=ut.cst),dt.aliqIcmsInterno==null&&Number(st.aliquota||0)>0&&(tt.aliqIcmsInterno=Number(st.aliquota)),dt.aliqIpiPercent==null&&Number(Nt.aliquota||0)>=0&&(tt.aliqIpiPercent=Number(Nt.aliquota)),dt.aliqPisPercent==null&&Number(ut.aliquota||0)>=0&&(tt.aliqPisPercent=Number(ut.aliquota)),dt.aliqCofinsPercent==null&&Number(Rt.aliquota||0)>=0&&(tt.aliqCofinsPercent=Number(Rt.aliquota)),dt.fcpPercent==null&&Number(st.fcpAliquota||0)>0&&(tt.fcpPercent=Number(st.fcpAliquota)),dt.mvaPercent==null&&Number(st.mva||0)>0&&(tt.mvaPercent=Number(st.mva)),dt.baseReduzidaPercent==null&&Number(st.pRedBC||0)>0&&(tt.baseReduzidaPercent=Number(st.pRedBC)),Object.keys(tt).length>0&&(await Yw(Z.existing.id,tt),console.log("[XMLImport] Produto existente atualizado com fiscais faltantes",{id:Z.existing.id,patch:tt}))}catch(dt){console.warn("[XMLImport] Falha ao completar fiscais no produto existente",dt)}J.updated++,J.details.push({produto:Z.xml.nome,acao:ae>0?`Estoque +${ae} (somado)`:"Verificado",status:"success"})}}catch(ae){console.error("[XMLImport] Erro ao processar produto:",Z.xml.nome,ae),J.errors++,J.details.push({produto:Z.xml.nome,acao:"Erro",status:"error",error:ae.message})}}if(u?.nfe?.chaveAcesso&&Ne)try{const Z=await iot(u.nfe.chaveAcesso,n);let ge=Z;if(!Z||!Z.ativo){const se={codigoEmpresa:n,fornecedorId:Ne.id,chaveNfe:u.nfe.chaveAcesso,numeroNfe:u.nfe.numero,serieNfe:u.nfe.serie,dataEmissao:u.nfe.dataEmissao,tipoOperacao:u.nfe.tipo||"Entrada",naturezaOperacao:u.nfe.naturezaOperacao,valorProdutos:u.nfe.totalNota||0,valorTotal:u.nfe.totalNota||0,xmlCompleto:B,formaPagamento:u.pagamentos&&u.pagamentos.length>0?u.pagamentos.map(ee=>ee.nome).join(", "):null};ge=await lot(se),console.log("[XMLImport] Nova compra registrada:",ge.numero_nfe)}else console.log("[XMLImport] NF-e j existe, adicionando novos itens:",Z.numero_nfe),J.purchaseAlreadyExists=!0;const le=ue.map(se=>{const ee=b[se.index]||{},de=ee.linkedProductId;let Le=null;return de&&de!=="force-new"?Le=de:se.existing&&!de&&(Le=se.existing.id),{produtoId:Le,codigoProdutoXML:se.xml.codigo,nomeProdutoXML:se.xml.nome,eanXML:se.xml.ean,ncmXML:se.xml.ncm,cfopXML:se.xml.cfop,unidadeXML:se.xml.unidade,quantidade:ee.qty!==void 0?ee.qty:Number(se.xml.quantidade),valorUnitario:Number(se.xml.valorUnitario)||0,valorTotal:Number(se.xml.valorTotal)||0,valorDesconto:se.xml.valorDesconto||0,valorFrete:se.xml.valorFrete||0,valorSeguro:se.xml.valorSeguro||0,valorOutrasDespesas:se.xml.valorOutrasDespesas||0,icmsAliquota:se.xml.icmsAliquota,icmsValor:se.xml.icmsValor,ipiAliquota:se.xml.ipiAliquota,ipiValor:se.xml.ipiValor,pisAliquota:se.xml.pisAliquota,pisValor:se.xml.pisValor,cofinsAliquota:se.xml.cofinsAliquota,cofinsValor:se.xml.cofinsValor,vinculadoManualmente:!!ee.linkedProductId,observacoes:ee.observacoes||null,selecionadoNaImportacao:se.selected}});await koe(ge.id,le),console.log("[XMLImport] Itens adicionados  compra:",le.length),J.purchaseId=ge.id}catch(Z){console.error("[XMLImport] Erro ao registrar compra:",Z)}x(J),g(!1),l("done"),J.purchaseAlreadyExists?s({title:"NF-e j importada!",description:`Esta NF-e j existe no sistema. ${J.created} produto(s) criado(s), ${J.updated} atualizado(s).`,variant:"warning"}):J.errors===0?s({title:"Importao concluda!",description:`${J.created} produto(s) criado(s), ${J.updated} atualizado(s).`,variant:"success"}):s({title:"Importao concluda com erros",description:`${J.created} criado(s), ${J.updated} atualizado(s), ${J.errors} erro(s).`,variant:"warning"}),o&&o()},D=()=>{console.log("[XMLImport] Fechando modal"),l("upload"),d(null),f(null),m([]),w({}),_({}),x({created:0,updated:0,errors:0,details:[]}),t(!1)};_e.useEffect(()=>{e&&console.log("[XMLImport] Modal aberto. Step atual:",i)},[e,i]);const U=()=>{l("upload"),d(null),f(null),m([]),w({}),_({})},z=B=>{m(J=>J.map((ue,Ne)=>Ne===B?{...ue,selected:!ue.selected}:ue))},H=()=>{const B=h.every(J=>J.selected);m(J=>J.map(ue=>({...ue,selected:!B})))},q=(B,J,ue)=>{w(Ne=>({...Ne,[B]:{...Ne[B],[J]:ue}}))},Q=(B,J)=>{console.log("[XMLImportModal] handleLinkProduct chamado:",{index:B,productId:J}),console.log("[XMLImportModal] Estado editedProducts completo antes:",b),console.log("[XMLImportModal] Estado editedProducts[index] antes:",b[B]),w(ue=>{console.log("[XMLImportModal] Estado prev no setEditedProducts:",ue);const Ne={...ue,[B]:{...ue[B],linkedProductId:J}};return console.log("[XMLImportModal] Novo estado editedProducts:",Ne),Ne})},pe=(B,J)=>!B||!J?0:B*(1+J/100),be=(B,J,ue)=>b[B]?.[J]??ue,V=B=>{_(J=>({...J,[B]:!J[B]}))};return a.jsxs(xn,{open:e,onOpenChange:D,children:[a.jsxs(vn,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] flex flex-col",children:[a.jsxs(pn,{className:"flex-shrink-0",children:[a.jsxs(fn,{className:"flex items-center gap-2 text-2xl font-bold",children:[a.jsx("span",{children:"Importar XML de Compra"}),u?.nfe&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:F()})]}),a.jsxs(On,{children:[i==="upload"&&"Selecione o arquivo XML da nota fiscal de entrada",i==="preview"&&"Revise os produtos que sero importados",i==="processing"&&"Processando produtos...",i==="done"&&"Importao finalizada"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-2 py-1",children:[i==="upload"&&a.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:a.jsx("div",{className:"w-full max-w-md",children:a.jsxs("label",{htmlFor:"xml-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[a.jsx(f4,{className:"w-12 h-12 mb-4 text-text-muted"}),a.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Arquivo XML de NF-e (Nota Fiscal Eletrnica)"})]}),a.jsx("input",{id:"xml-upload",type:"file",accept:".xml",className:"hidden",onChange:M})]})})}),i==="preview"&&a.jsxs("div",{className:"space-y-4",children:[u?.nfe&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"font-semibold mb-2",children:["Informaes da ",F()]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",a.jsx("span",{className:"font-mono",children:u.nfe.numero})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",a.jsx("span",{className:"font-mono",children:u.nfe.serie})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",a.jsx("span",{children:u.nfe.tipo})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",a.jsx("span",{children:u.fornecedor?.razaoSocial})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-2 min-w-[200px]",children:[a.jsxs("div",{className:"bg-brand/10 rounded-lg p-3 border border-brand/20",children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Valor Total NF-e"}),a.jsxs("p",{className:"text-xl font-bold text-brand",children:["R$ ",Number(u.nfe.totalNota||0).toFixed(2)]})]}),u.pagamentos&&u.pagamentos.length>0&&a.jsxs("div",{className:"bg-success/10 rounded-lg p-2.5 border border-success/20",children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento"}),a.jsx("p",{className:"text-sm font-semibold text-success",children:u.pagamentos.map(B=>B.nome).join(", ")})]})]})]}),u.nfe.chaveAcesso&&a.jsxs("div",{className:"mt-2 pt-2 border-t border-border",children:[a.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),a.jsx("p",{className:"font-mono text-xs break-all",children:u.nfe.chaveAcesso})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-4 px-2",children:[a.jsx(ce,{variant:"outline",size:"sm",onClick:H,children:h.every(B=>B.selected)?"Desmarcar Todos":"Selecionar Todos"}),a.jsxs("span",{className:"text-sm text-text-muted",children:[h.filter(B=>B.selected).length," de ",h.length," selecionados"]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3 text-base",children:"Produtos Encontrados"}),a.jsx("div",{className:"space-y-2",children:h.map((B,J)=>{const ue=be(J,"linkedProductId",null),Ne=be(J,"name",B.xml.nome),Z=be(J,"quantity",B.xml.quantidade),ge=be(J,"margin",B.xml.margem),le=be(J,"salePrice",null),se=B.xml.valorUnitario||0;let ee=le;ee==null&&!B.isNew&&B.existing&&(ee=Number(B.existing.preco_venda||B.existing.salePrice||B.existing.price||0)),ee==null&&ge!=null&&(ee=pe(se,ge)),ee==null&&B.xml.precoVenda&&(ee=Number(B.xml.precoVenda));let de=null;if(ge!=null)de=ge;else if(ee!=null&&se>0&&ee>0){const ae=(ee-se)/se*100;de=Math.max(-999,Math.min(9999,ae))}const Le=j[J];return a.jsxs("div",{className:mr("rounded-lg border transition-all",B.selected?B.isNew?"bg-success/10 border-success/30":"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[a.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("input",{type:"checkbox",checked:B.selected,onChange:()=>z(J),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),a.jsx("button",{onClick:()=>V(J),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:Le?a.jsx(i0,{className:"w-4 h-4 text-text-muted"}):a.jsx(l0,{className:"w-4 h-4 text-text-muted"})}),a.jsx("div",{children:B.isNew?a.jsx(ro,{className:"w-5 h-5 text-success"}):a.jsx(Rp,{className:"w-5 h-5 text-info"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm truncate",children:Ne}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[B.xml.codigo&&a.jsxs("span",{className:"flex-shrink-0",children:["#",B.xml.codigo]}),a.jsxs("span",{children:["Qtd: ",Z]})]})]}),a.jsx("div",{className:"flex-shrink-0 ml-2",children:B.isNew?a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-success/20 text-success font-medium",children:"Novo"}):a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),a.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[a.jsxs("span",{children:["R$ ",Number(se).toFixed(2),ee?`  R$ ${ee.toFixed(2)}`:""]}),de!=null&&a.jsxs("span",{className:"ml-2 "+(de>0?"text-success":de<0?"text-destructive":"text-text-muted"),children:[de.toFixed(1),"%"]})]})]})]}),Le&&a.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),a.jsx("input",{type:"text",value:Ne,onChange:ae=>q(J,"name",ae.target.value),disabled:!B.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{type:"button",onClick:()=>q(J,"qty",Math.max(0,Z-1)),disabled:!B.selected||Z<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:a.jsx(Ev,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",value:Z,onChange:ae=>{const ie=ae.target.value.replace(/\D/g,"");q(J,"qty",ie===""?0:Number(ie))},disabled:!B.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),a.jsx("button",{type:"button",onClick:()=>q(J,"qty",Z+1),disabled:!B.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:a.jsx(ro,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:(()=>{const ae=be(J,"margin",null);if(ae!=null)return String(ae);if(!B.isNew&&B.existing&&se>0){const ie=Number(B.existing.preco_venda||B.existing.salePrice||B.existing.price||0);if(ie>0)return((ie-se)/se*100).toFixed(1)}return""})(),onChange:ae=>{const ie=ae.target.value;if(ie===""){q(J,"margin",null);return}const dt=ie.replace(/[^0-9.,\-]/g,"").replace(",",".");if(dt==="."||dt==="-"||dt==="-.")return;const At=parseFloat(dt);if(!isNaN(At)&&(q(J,"margin",At),se>0)){const st=pe(se,At);q(J,"salePrice",st)}},disabled:!B.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),a.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),a.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:a.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",se.toFixed(2)]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),a.jsx("input",{type:"text",value:(()=>{const ae=be(J,"salePrice",ee);return ae==null?"":Number(ae).toFixed(2).replace(".",",")})(),onChange:ae=>{const ie=ae.target.value.replace(/\D/g,"");if(ie===""){q(J,"salePrice",null);return}const dt=Number(ie)/100;if(q(J,"salePrice",dt),dt>0&&se>0){const At=(dt-se)/se*100;q(J,"margin",Math.round(At*100)/100)}},disabled:!B.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:B.isNew?"Vincular a Produto Existente (Opcional)":"Ao para este Produto"}),a.jsx("div",{className:"flex gap-2",children:a.jsxs(Cn,{value:ue==="force-new"?"force-new":ue||(B.isNew?"new":B.existing?.id||"new"),onValueChange:ae=>{ae==="new"||ae===B.existing?.id?Q(J,null):ae==="search"?E({isOpen:!0,productIndex:J,currentProduct:B}):Q(J,ae)},disabled:!B.selected,children:[a.jsx(jn,{className:"flex-1 hover:bg-white/5 transition-colors text-xs sm:text-sm",children:a.jsx(An,{placeholder:B.isNew?"Criar novo":"Atualizar existente",children:ue&&ue!=="force-new"&&ue!=="new"?(()=>{const ae=r?.find(ie=>ie.id===ue);return ae?`Vinculado: ${ae.name}`:B.isNew?"Criar novo":"Atualizar existente"})():ue==="force-new"?"Criar novo (ignorar)":B.isNew?"Criar novo":"Atualizar existente"})}),a.jsxs(_n,{className:"max-h-[300px] overflow-y-auto text-xs sm:text-sm",children:[B.isNew?a.jsx(nt,{value:"new",children:"Criar novo produto"}):a.jsxs(nt,{value:B.existing?.id||"new",children:["Atualizar: ",B.existing?.name," (Estoque: ",B.existing?.stock||0,")"]}),!B.isNew&&a.jsx(nt,{value:"force-new",children:"Criar novo (ignorar existente)"}),a.jsx(nt,{value:"search",children:"Buscar produto para vincular"})]})]})})]}),!B.isNew&&a.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:be(J,"updatePrice",!1),onChange:ae=>q(J,"updatePrice",ae.target.checked),disabled:!B.selected,className:"w-4 h-4 rounded border-border bg-surface text-brand focus:ring-2 focus:ring-brand/50 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:"text-text-secondary",children:"Atualizar preo de custo e venda deste produto"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[B.xml.codigo&&a.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Cdigo: ",B.xml.codigo]}),B.xml.ean&&B.xml.ean!=="SEM GTIN"&&a.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["EAN: ",B.xml.ean]}),a.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Unidade: ",B.xml.unidade]})]})]})]},J)})})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-success"}),a.jsxs("span",{children:[h.filter(B=>B.isNew&&B.selected).length," novos"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-info"}),a.jsxs("span",{children:[h.filter(B=>!B.isNew&&B.selected).length," existentes"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-warning"}),a.jsxs("span",{children:[h.filter(B=>b[B.index]?.linkedProductId).length," vinculados"]})]})]})]}),i==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(zm,{className:"w-12 h-12 animate-spin text-warning mb-4"}),a.jsx("p",{className:"text-lg font-semibold",children:"Processando produtos..."}),a.jsx("p",{className:"text-sm text-text-muted",children:"Aguarde enquanto importamos os produtos"})]}),i==="done"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:[a.jsx(Ds,{className:"w-16 h-16 text-success mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Importao Concluda!"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-success",children:y.created}),a.jsx("p",{className:"text-sm text-text-muted",children:"Criados"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-info",children:y.updated}),a.jsx("p",{className:"text-sm text-text-muted",children:"Atualizados"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-danger",children:y.errors}),a.jsx("p",{className:"text-sm text-text-muted",children:"Erros"})]})]})]}),y.details.length>0&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Detalhes"}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:y.details.map((B,J)=>a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[B.status==="success"?a.jsx(Ds,{className:"w-4 h-4 text-success flex-shrink-0"}):a.jsx(Ac,{className:"w-4 h-4 text-danger flex-shrink-0"}),a.jsx("span",{className:"flex-1 truncate",children:B.produto}),a.jsx("span",{className:mr("text-xs px-2 py-1 rounded",B.status==="success"?"bg-success/20 text-success":"bg-danger/20 text-danger"),children:B.acao})]},J))})]})]})]}),a.jsxs(ra,{children:[i==="upload"&&a.jsx(ce,{variant:"outline",onClick:D,children:"Cancelar"}),i==="preview"&&a.jsxs(a.Fragment,{children:[a.jsx(ce,{variant:"outline",onClick:U,children:"Voltar"}),a.jsxs(ce,{onClick:I,disabled:h.filter(B=>B.selected).length===0,children:["Confirmar Importao (",h.filter(B=>B.selected).length," de ",h.length," produtos)"]})]}),i==="done"&&a.jsx(ce,{onClick:D,children:"Fechar"})]})]}),a.jsx(Ooe,{isOpen:C.isOpen,onClose:()=>E({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:B=>{console.log("[XMLImportModal] onSelect chamado com produto:",B),console.log("[XMLImportModal] Index do produto:",C.productIndex),Q(C.productIndex,B.id),E({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:C.currentProduct}),a.jsx(Toe,{isOpen:A.isOpen,onClose:()=>P({isOpen:!1}),onConfirm:R,products:h.map((B,J)=>({...B,originalIndex:J})),editedProducts:b,allProducts:r,isReprocess:!1})]})}const pot=[],got=[],vot={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},YT={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},TU="produtosPage:settings";function xot(e){const t=["Cdigo","Produto","Categoria","Tipo","Unidade","Preo Custo","Preo Venda","% Lucro","Estoque","Estoque Mn.","Validade","Status","Ativo","EAN-13","EAN-13 Caixa","Referncia","Marca","Grupo","NCM","Descrio NCM","CEST","Usar CSOSN","CFOP Interno","CST ICMS Interno","CSOSN Interno","Aliq ICMS Interno (%)","CFOP Externo","CST ICMS Externo","CSOSN Externo","Aliq ICMS Externo (%)","CST PIS Entrada","CST PIS Sada","Aliq PIS (%)","Aliq COFINS (%)","CST IPI","Aliq IPI (%)","FCP (%)","MVA (%)","Base Reduzida (%)"],r=";",n=g=>{const y=Number(g??0);return Number.isFinite(y)?y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):"0,00"},o=g=>`R$ ${n(g)}`,s=g=>{const y=Number(g??0);return Number.isFinite(y)?y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},i=g=>{if(!g)return"";try{if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g)){const[x,b,w]=g.split("-");return`${w}/${b}/${x}`}const y=new Date(g);if(!isNaN(y)){const x=String(y.getDate()).padStart(2,"0"),b=String(y.getMonth()+1).padStart(2,"0"),w=y.getFullYear();return`${x}/${b}/${w}`}}catch{}return String(g)},l=g=>g==="active"?"Ativo":g==="low_stock"?"Estoque Baixo":g==="inactive"?"Inativo":"",c=g=>g?"Sim":"No",d=g=>g??"",u=g=>{const y=g==null?"":String(g);return/[";\n]/.test(y)?`"${y.replace(/"/g,'""')}"`:y},f=[];f.push("\uFEFF"+t.join(r));for(const g of e){const y=[d(g.code),d(g.name),d(g.category),d(g.type),d(g.unit),o(g.costPrice),o(g.price??g.salePrice),s(g.marginPercent),Number(g.stock??0),Number(g.minStock??0),i(g.validade),l(g.status),c(g.active!==!1),d(g.barcode),d(g.barcodeBox),d(g.reference),d(g.brand),d(g.group),d(g.ncm),d(g.ncmDescription),d(g.cest),g.useCsosn?"Sim":"",d(g.cfopInterno),d(g.cstIcmsInterno),d(g.csosnInterno),s(g.aliqIcmsInterno),d(g.cfopExterno),d(g.cstIcmsExterno),d(g.csosnExterno),s(g.aliqIcmsExterno),d(g.cstPisEntrada),d(g.cstPisSaida),s(g.aliqPisPercent),s(g.aliqCofinsPercent),d(g.cstIpi),s(g.aliqIpiPercent),s(g.fcpPercent),s(g.mvaPercent),s(g.baseReduzidaPercent)].map(u).join(r);f.push(y)}const h=new Blob([f.join(`
`)],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(h),v=document.createElement("a");v.href=m,v.download="produtos.csv",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(m)}function hc(e,{action:t}={}){const r=String(e?.message||e||"").toLowerCase();if(r.includes("categoria possui produtos ativos vinculados"))return{title:"No  possvel remover",description:"Existem produtos ativos vinculados a esta categoria. Inative ou recategoriz-os antes."};if(r.includes("categoria no encontrada"))return{title:"Categoria no encontrada",description:"No foi possvel localizar a categoria para desativao."};if(r.includes("duplicate key")&&r.includes("ux_produtos_empresa_codigo_produto"))return{title:"Cdigo j cadastrado",description:"J existe um produto com este cdigo na sua empresa. Informe outro cdigo."};if(r.includes("duplicate key")&&r.includes("unique constraint"))return{title:"Registro j existe",description:"J existe um registro com estes dados."};if(r.includes("permission denied")||r.includes("violates row-level security")||r.includes("rls"))return{title:"Sem permisso",description:"Voc no tem permisso para executar esta ao."};const n=r.match(/null value in column "([^"]+)" violates not-null constraint/);return n?{title:"Campo obrigatrio",description:`Preencha o campo "${n[1].replace(/_/g," ")}".`}:r.includes("invalid input syntax")||r.includes("invalid input value")?{title:"Valor invlido",description:"Revise os valores informados (formato invlido)."}:r.includes("violates check constraint")?{title:"Valor invlido",description:"Os dados informados no atendem s regras do sistema."}:r.includes("violates foreign key constraint")?r.includes("update or delete on table")?{title:"No  possvel excluir",description:"Existem registros vinculados que impedem a excluso."}:{title:"Relao invlida",description:"O registro relacionado no foi encontrado ou  invlido."}:r.includes("failed to fetch")||r.includes("networkerror")||r.includes("network error")?{title:"Falha de conexo",description:"Verifique sua internet e tente novamente."}:r.includes("timeout")?{title:"Tempo esgotado",description:"A operao demorou demais. Tente novamente."}:r.includes("rate limit")||r.includes("too many requests")||r.includes("status code 429")?{title:"Muitas solicitaes",description:"Aguarde alguns segundos e tente novamente."}:t==="save"?{title:"Falha ao salvar",description:"No foi possvel salvar o produto. Tente novamente."}:t==="delete"?{title:"Falha ao inativar",description:"No foi possvel inativar o produto."}:t==="fetch"?{title:"Erro ao carregar",description:"No foi possvel atualizar a lista de produtos."}:t==="export"?{title:"Falha ao exportar",description:"No foi possvel gerar o arquivo."}:{title:"Erro",description:e?.message||"Ocorreu um erro."}}const VE=({icon:e,title:t,value:r,subtitle:n,color:o,onClick:s,isActive:i})=>{const l=e;return a.jsxs(Pr.div,{variants:YT,className:mr("bg-surface rounded-2xl border-2 p-3 sm:p-4 flex flex-col justify-between gap-2 cursor-pointer transition-all duration-300",i?`${o}/30 border-${o}`:"border-border hover:border-border-hover"),onClick:s,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 min-w-0",children:[a.jsx("p",{className:"text-text-secondary text-xs sm:text-sm font-semibold leading-snug whitespace-nowrap overflow-hidden text-ellipsis",children:t}),a.jsx(l,{className:mr("w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",o)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold text-text-primary leading-tight whitespace-nowrap overflow-hidden text-ellipsis",children:r}),a.jsx("p",{className:"hidden sm:block text-xs text-text-muted",children:n})]})]})};function yot({open:e,onOpenChange:t,product:r,onSave:n,categories:o,onCreateCategory:s,suggestedCode:i,onRefreshProducts:l,products:c}){const{toast:d}=no(),{userProfile:u}=So(),[f,h]=p.useState("dados"),[m,v]=p.useState(r?.code||""),[g,y]=p.useState(r?.name||""),[x,b]=p.useState(r?.category||""),[w,j]=p.useState(r?.type||"Venda"),[_,C]=p.useState(r?.unit||"UN"),[E,A]=p.useState(r?.active??!0),[P,F]=p.useState(r?.barcode||""),[M,I]=p.useState(r?.barcodeBox||""),[R,D]=p.useState(r?.reference||""),[U,z]=p.useState(r?.brand||""),[H,q]=p.useState(r?.group||""),[Q,pe]=p.useState(!!r?.allowSale),[be,V]=p.useState(!!r?.payCommission),[B,J]=p.useState(!!r?.variablePrice),[ue,Ne]=p.useState(!!r?.composition),[Z,ge]=p.useState(!!r?.service),[le,se]=p.useState(!!r?.hasGrid),[ee,de]=p.useState(!!r?.usePriceTable),[Le,ae]=p.useState(!!r?.fuel),[ie,dt]=p.useState(!!r?.useImei),[At,st]=p.useState(!!r?.stockByGrid),[ut,Rt]=p.useState(!!r?.showInApp),[Nt,tt]=p.useState(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[he,ke]=p.useState(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[et,Me]=p.useState(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),[$e,Be]=p.useState(r?.stock?String(r.stock):""),[we,He]=p.useState(r?.minStock?String(r.minStock):""),[ht,zt]=p.useState(r?.status||"active"),[hr,Mt]=p.useState(r?.validade||null),[Qt,Se]=p.useState(!1),[kt,Lt]=p.useState(!1),[fr,yr]=p.useState(""),[Xt,nr]=p.useState(!0),[ir,Ee]=p.useState(!!(r?.csosnInterno||r?.csosnExterno)),[qe,Ge]=p.useState(r?.cfopInterno||""),[Qe,St]=p.useState(r?.cstIcmsInterno||""),[pt,Et]=p.useState(r?.csosnInterno||""),[mt,gt]=p.useState(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),[ft,Dt]=p.useState(r?.cfopExterno||""),[Ft,ye]=p.useState(r?.cstIcmsExterno||""),[wt,Yt]=p.useState(r?.csosnExterno||""),[br,Mr]=p.useState(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),[Nr,Rr]=p.useState(r?.cstPisEntrada||""),[Er,ln]=p.useState(r?.cstPisSaida||""),[Fn,Hn]=p.useState(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),[$n,at]=p.useState(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),[Vt,wr]=p.useState(r?.cstIpi||""),[er,Ze]=p.useState(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),[Fr,jt]=p.useState(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),[_r,bt]=p.useState(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),[Wt,Zt]=p.useState(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),[Br,zr]=p.useState(r?.ncm||""),[_t,Jr]=p.useState(r?.ncmDescription||""),[mn,ma]=p.useState(r?.cest||""),[Nn,re]=p.useState(!1),[Te,ot]=p.useState(!1),te=Fe=>{const It=String(Fe||"").replace(/\D/g,"");return(It?Number(It)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},T=Fe=>{if(!Fe)return 0;const It=String(Fe).replace(/\./g,"").replace(",","."),Sr=Number(It);return Number.isFinite(Sr)?Sr:0},O=Fe=>{const It=String(Fe||"").replace(/[^\d,]/g,"");return It?`% ${It}`:""},X=Fe=>{if(Fe==null||Fe==="")return 0;const It=String(Fe).replace(/\./g,"").replace(",","."),Sr=Number(It);return Number.isFinite(Sr)?Sr:0},G=Fe=>String(Fe||"").replace(/\D/g,"").slice(0,13),L=Fe=>String(Fe||"").replace(/\D/g,"").slice(0,4),Re=Fe=>String(Fe||"").replace(/\D/g,"").slice(0,8),rt=Fe=>String(Fe||"").replace(/\D/g,"").slice(0,7);p.useEffect(()=>{v(r?.code||""),y(r?.name||""),b(r?.category||""),j(r?.type||"Venda"),C(r?.unit||"UN"),A(r?.active??!0),F(r?.barcode||""),I(r?.barcodeBox||""),D(r?.reference||""),z(r?.brand||""),q(r?.group||""),pe(!!r?.allowSale),V(!!r?.payCommission),J(!!r?.variablePrice),Ne(!!r?.composition),ge(!!r?.service),se(!!r?.hasGrid),de(!!r?.usePriceTable),ae(!!r?.fuel),dt(!!r?.useImei),st(!!r?.stockByGrid),Rt(!!r?.showInApp),tt(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),ke(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),Me(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),Be(r?.stock?String(r.stock):""),He(r?.minStock?String(r.minStock):""),zt(r?.status||"active"),Mt(r?.validade||null),Ee(!!(r?.csosnInterno||r?.csosnExterno)),Ge(r?.cfopInterno||""),St(r?.cstIcmsInterno||""),Et(r?.csosnInterno||""),gt(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),Dt(r?.cfopExterno||""),ye(r?.cstIcmsExterno||""),Yt(r?.csosnExterno||""),Mr(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),Rr(r?.cstPisEntrada||""),ln(r?.cstPisSaida||""),Hn(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),at(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),wr(r?.cstIpi||""),Ze(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),jt(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),bt(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),Zt(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),zr(r?.ncm||""),Jr(r?.ncmDescription||""),ma(r?.cest||""),nr(!0),!r&&i&&!m&&v(i),re(!1),ot(!1)},[r,e]);const lt=p.useRef("salePrice");p.useEffect(()=>{if(lt.current==="salePrice"){const Fe=T(Nt),It=T(he);if(It>0){const Sr=(It-Fe)/It*100;Me(Sr.toFixed(2).replace(".",","))}else Me("")}},[Nt,he]),p.useEffect(()=>{if(lt.current==="marginPercent"){const Fe=setTimeout(()=>{const It=T(Nt),Sr=X(et);if(console.log("[Margem] Custo:",It,"Margem:",Sr),It>0&&Sr>0)if(Sr>=100){const kr=It*(1+Sr/100);console.log("[Margem] Preo calculado (markup):",kr),ke(kr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const kr=It/(1-Sr/100);console.log("[Margem] Preo calculado (margem):",kr),ke(kr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}},500);return()=>clearTimeout(Fe)}},[et,Nt]);const $t=async Fe=>{if(Fe.preventDefault(),Qt)return;const It=[];if(g?.trim()||It.push("Descrio"),_?.trim()||It.push("Unidade"),w||It.push("Tipo de Produto"),T(he)<=0&&It.push("Preo de Venda"),It.length){d({title:"Preencha os campos obrigatrios",description:It.join(", "),variant:"destructive"});return}console.log("[ProdutosPage] handleSave - Estado active antes de salvar:",E);let Sr=ht;E?ht==="inactive"&&E&&(Sr="active"):Sr="inactive",console.log("[ProdutosPage] handleSave - Status ajustado:",Sr);const kr={id:r?.id,code:m?.trim()||"",name:g,category:x,type:w,stock:Number($e||0),minStock:Number(we||0),status:Sr,validade:hr,unit:_,active:E,barcode:G(P),barcodeBox:G(M),reference:R?.trim()||null,brand:U?.trim()||null,group:H?.trim()||null,cost:T(Nt),price:T(he),buyPrice:null,costsPercent:null,costPrice:T(Nt),salePrice:T(he),marginPercent:X(et),allowSale:Q,payCommission:be,variablePrice:B,composition:ue,service:Z,hasGrid:le,usePriceTable:ee,fuel:Le,useImei:ie,stockByGrid:At,showInApp:ut,cfopInterno:L(qe)||null,cstIcmsInterno:ir?null:Qe||null,csosnInterno:ir&&pt||null,aliqIcmsInterno:X(mt),cfopExterno:L(ft)||null,cstIcmsExterno:ir?null:Ft||null,csosnExterno:ir&&wt||null,aliqIcmsExterno:X(br),cstPisEntrada:Nr||null,cstPisSaida:Er||null,aliqPisPercent:X(Fn),aliqCofinsPercent:X($n),cstIpi:Vt||null,aliqIpiPercent:X(er),fcpPercent:X(Fr),mvaPercent:X(_r),baseReduzidaPercent:X(Wt),ncm:Re(Br)||null,ncmDescription:_t||null,cest:rt(mn)||null};try{Se(!0),console.log("[Produtos] Salvando produto",kr);const pr=2e4,yn=new Promise((In,Xn)=>setTimeout(()=>Xn(new Error("Timeout ao salvar produto (20s)")),pr));await Promise.race([n(kr),yn]),d({title:"Produto salvo",description:"O produto foi salvo com sucesso.",variant:"success",duration:4e3,className:"bg-amber-500 text-black shadow-xl"}),t(!1)}catch(pr){console.error("[Produtos] Erro ao salvar",pr);const yn=hc(pr,{action:"save"});d({title:yn.title,description:yn.description,variant:"destructive",duration:6e3})}finally{Se(!1)}};return p.useEffect(()=>{e||Se(!1)},[e]),a.jsxs(xn,{open:e,onOpenChange:t,children:[a.jsxs(vn,{className:"w-[90vw] sm:max-w-[780px] max-h-[80vh] sm:max-h-[85vh] flex flex-col",onKeyDown:Fe=>{Fe.key==="F5"&&(Fe.preventDefault(),$t(Fe)),Fe.key==="Escape"&&(Fe.preventDefault(),t(!1))},children:[a.jsx(pn,{children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx(fn,{className:"text-lg sm:text-xl",children:r?"Detalhes do Produto":"Novo Produto"}),a.jsx(On,{className:"text-xs sm:text-sm",children:"Preencha as informaes e use as abas para navegar."})]})})}),a.jsx("form",{onSubmit:$t,className:"grid gap-4 py-2 flex-1 overflow-y-auto pr-1 fx-scroll",children:a.jsxs(_c,{value:f,onValueChange:h,className:"w-full",children:[a.jsx("div",{className:"sm:hidden mb-4",children:a.jsxs(Cn,{value:f,onValueChange:h,children:[a.jsx(jn,{className:"w-full",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"dados",children:"Dados"}),a.jsx(nt,{value:"estoque",children:"Estoque"}),a.jsx(nt,{value:"preco",children:"Preo e Lucro"}),a.jsx(nt,{value:"impostos",children:"Impostos"}),a.jsx(nt,{value:"outras",children:"Outras Info"})]})]})}),a.jsxs(ql,{className:"hidden sm:grid grid-cols-5 gap-1",children:[a.jsx(ca,{value:"dados",children:"Dados"}),a.jsx(ca,{value:"estoque",children:"Estoque"}),a.jsx(ca,{value:"preco",children:"Preo e Lucro"}),a.jsx(ca,{value:"impostos",children:"Impostos"}),a.jsx(ca,{value:"outras",children:"Outras Info"})]}),a.jsx("div",{className:"mt-2 text-[10px] sm:text-[11px] text-text-muted",children:"* Campo obrigatrio"}),a.jsxs(uo,{value:"dados",className:"space-y-3 mt-2",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(De,{htmlFor:"code",className:"text-left sm:text-right text-xs sm:text-sm",children:["Cdigo ",a.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(auto)"})]}),a.jsx(Je,{id:"code",value:m,onChange:Fe=>v(Fe.target.value.replace(/\D/g,"")),className:"col-span-1 sm:col-span-3 text-sm",placeholder:i||"Ex.: 0001",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(De,{htmlFor:"name",className:"text-left sm:text-right text-xs sm:text-sm",children:["Descrio ",!g?.trim()&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(Je,{id:"name",value:g,onChange:Fe=>y(Fe.target.value),className:"col-span-1 sm:col-span-3 text-sm",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{htmlFor:"category",className:"text-left sm:text-right text-xs sm:text-sm",children:"Categoria"}),a.jsxs("div",{className:"col-span-3 flex gap-2 items-center",children:[a.jsxs(Cn,{value:x,onValueChange:Fe=>Xt&&b(Fe),children:[a.jsx(jn,{className:"w-full",disabled:!Xt,children:a.jsx(An,{placeholder:"Selecione..."})}),a.jsx(_n,{children:o.map(Fe=>a.jsx(nt,{value:Fe,children:Fe},Fe))})]}),a.jsxs(ce,{type:"button",onClick:()=>Lt(Fe=>!Fe),className:"bg-amber-500 hover:bg-amber-400 text-black inline-flex items-center gap-2 whitespace-nowrap px-3",title:kt?"Fechar":"Adicionar nova categoria",disabled:!Xt,children:[a.jsx("span",{className:"font-bold",children:"+"}),a.jsx("span",{children:"Novo"})]})]})]}),kt&&a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-3 flex gap-2",children:[a.jsx(Je,{value:fr,onChange:Fe=>yr(Fe.target.value),placeholder:"Nome da nova categoria"}),a.jsx(ce,{type:"button",onClick:async()=>{const Fe=fr.trim();if(Fe)try{if(o.includes(Fe)){d({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}await s?.(Fe),b(Fe),yr(""),Lt(!1),d({title:"Categoria adicionada",description:"Ela j est selecionada no formulrio.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(It){console.error("[Produto] add category inline:error",It);const Sr=hc(It,{action:"save"});d({title:Sr.title,description:Sr.description,variant:"destructive"})}},children:"Adicionar"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(De,{htmlFor:"unit",className:"text-left sm:text-right text-xs sm:text-sm",children:["Unidade ",!_?.trim()&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(Cn,{value:_,onValueChange:Fe=>Xt&&C(Fe),children:[a.jsx(jn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!Xt,children:a.jsx(An,{placeholder:"Selecione a unidade"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"UN",children:"UN - Unidade"}),a.jsx(nt,{value:"CX",children:"CX - Caixa"}),a.jsx(nt,{value:"PC",children:"PC - Pea"}),a.jsx(nt,{value:"KG",children:"KG - Quilograma"}),a.jsx(nt,{value:"G",children:"G - Grama"}),a.jsx(nt,{value:"L",children:"L - Litro"}),a.jsx(nt,{value:"ML",children:"ML - Mililitro"}),a.jsx(nt,{value:"M",children:"M - Metro"}),a.jsx(nt,{value:"M2",children:"M - Metro Quadrado"}),a.jsx(nt,{value:"M3",children:"M - Metro Cbico"}),a.jsx(nt,{value:"PAR",children:"PAR - Par"}),a.jsx(nt,{value:"DZ",children:"DZ - Dzia"}),a.jsx(nt,{value:"FD",children:"FD - Fardo"}),a.jsx(nt,{value:"SC",children:"SC - Saco"}),a.jsx(nt,{value:"PT",children:"PT - Pacote"}),a.jsx(nt,{value:"SERV",children:"SERV - Servio"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(De,{className:"text-left sm:text-right text-xs sm:text-sm",children:["Tipo ",!w&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(Cn,{value:w,onValueChange:Fe=>Xt&&j(Fe),children:[a.jsx(jn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!Xt,children:a.jsx(An,{placeholder:"Selecione o tipo"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"Venda",children:"Produto para Venda"}),a.jsx(nt,{value:"Uso Interno",children:"Produto de Uso Interno"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-left sm:text-right text-xs sm:text-sm",children:"Ativo"}),a.jsx("div",{className:"col-span-1 sm:col-span-3",children:r?a.jsxs(a.Fragment,{children:[a.jsx(Ha,{checked:E,onCheckedChange:Fe=>{console.log("[ProdutosPage] Checkbox active mudou para:",Fe),A(!!Fe)},disabled:!Xt}),a.jsx("span",{className:"ml-2 text-xs sm:text-sm",children:"Ativo"})]}):a.jsxs(Cn,{value:E?"ativo":"inativo",onValueChange:Fe=>{console.log("[ProdutosPage] Select active mudou para:",Fe),A(Fe==="ativo")},children:[a.jsx(jn,{className:"w-full sm:w-48 text-sm",disabled:!Xt,children:a.jsx(An,{placeholder:"Selecione"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"ativo",children:"Ativo"}),a.jsx(nt,{value:"inativo",children:"Inativo"})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{htmlFor:"barcode",className:"text-left sm:text-right text-xs sm:text-sm",children:"EAN-13"}),a.jsx(Je,{id:"barcode",value:P,onChange:Fe=>F(G(Fe.target.value)),className:"col-span-1 sm:col-span-3 text-sm",placeholder:"789...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(De,{htmlFor:"validade",className:"text-left sm:text-right text-xs sm:text-sm",children:["Validade ",a.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(Opcional)"})]}),a.jsxs(Oc,{children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"outline",className:mr("col-span-1 sm:col-span-3 justify-start text-left font-normal text-xs sm:text-sm",!hr&&"text-muted-foreground"),disabled:!Xt,children:[a.jsx(Fj,{className:"mr-2 h-3 w-3 sm:h-4 sm:w-4"}),hr?dr(hr,"dd/MM/yyyy"):a.jsx("span",{children:"Selecione a data"})]})}),a.jsx(Hl,{className:"p-0 w-[280px] sm:w-[300px]",children:a.jsx("div",{className:"w-[280px] sm:w-[300px] min-h-[300px] sm:min-h-[332px]",children:a.jsx(Gl,{mode:"single",selected:hr,onSelect:Mt,initialFocus:!0,fixedWeeks:!0})})})]})]})]}),a.jsx(uo,{value:"estoque",className:"space-y-3 mt-2",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"grid grid-cols-2 items-center gap-2",children:[a.jsx(De,{htmlFor:"stock",className:"text-right",children:"Estoque"}),a.jsx(Je,{id:"stock",value:$e,onChange:Fe=>Be(Fe.target.value.replace(/[^0-9]/g,"")),disabled:!Xt,className:"col-span-1",inputMode:"numeric"})]}),a.jsxs("div",{className:"grid grid-cols-2 items-center gap-4",children:[a.jsx(De,{htmlFor:"minStock",className:"text-right",children:"Estoque Mn."}),a.jsx(Je,{id:"minStock",value:we,onChange:Fe=>He(Fe.target.value.replace(/[^0-9]/g,"")),disabled:!Xt,inputMode:"numeric"})]})]})}),a.jsxs(uo,{value:"preco",className:"space-y-3 mt-2",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{htmlFor:"costPrice",className:"text-xs sm:text-right",children:"Preo de Custo (R$)"}),a.jsx(Je,{id:"costPrice",inputMode:"numeric",placeholder:"Ex.: 10,00",value:`R$ ${Nt||"0,00"}`,onChange:Fe=>{tt(te(Fe.target.value))},disabled:!Xt,className:"sm:col-span-3 text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(De,{htmlFor:"salePrice",className:"text-xs sm:text-right",children:["Preo de Venda (R$) ",(!he||T(he)<=0)&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(Je,{id:"salePrice",inputMode:"numeric",placeholder:"Ex.: 15,00",value:`R$ ${he||"0,00"}`,onChange:Fe=>{lt.current="salePrice",ke(te(Fe.target.value))},disabled:!Xt,className:"sm:col-span-3 text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{htmlFor:"marginPercent",className:"text-xs sm:text-right",children:"% de Lucro (Margem)"}),a.jsx(Je,{id:"marginPercent",type:"text",placeholder:"Ex.: 40",value:et?`% ${et}`:"",onChange:Fe=>{lt.current="marginPercent";const It=Fe.target.value.replace(/[^\d,]/g,"");Me(It)},onBlur:()=>{if(lt.current==="marginPercent"){const Fe=T(Nt),It=X(et);if(Fe>0&&It>0)if(It>=100){const Sr=Fe*(1+It/100);ke(Sr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const Sr=Fe/(1-It/100);ke(Sr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}}},disabled:!Xt,className:"sm:col-span-3 text-xs sm:text-sm"})]})]}),a.jsxs(uo,{value:"impostos",className:"space-y-4 mt-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ha,{id:"useCsosn",checked:ir,onCheckedChange:Fe=>Ee(!!Fe),disabled:!Xt}),a.jsx(De,{htmlFor:"useCsosn",className:"cursor-pointer text-xs sm:text-sm",children:"Usar CSOSN (Simples Nacional)"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Interna"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CFOP"}),a.jsx(Je,{value:qe,onChange:Fe=>Ge(L(Fe.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"5102",disabled:!Xt})]}),!ir&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CST"}),a.jsx(Je,{value:Qe,onChange:Fe=>St(Fe.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!Xt})]}),ir&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CSOSN"}),a.jsx(Je,{value:pt,onChange:Fe=>Et(Fe.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),a.jsx(Je,{value:`${mt||""}`,onChange:Fe=>gt(O(Fe.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!Xt})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Externa"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CFOP"}),a.jsx(Je,{value:ft,onChange:Fe=>Dt(L(Fe.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"6102",disabled:!Xt})]}),!ir&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CST"}),a.jsx(Je,{value:Ft,onChange:Fe=>ye(Fe.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!Xt})]}),ir&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CSOSN"}),a.jsx(Je,{value:wt,onChange:Fe=>Yt(Fe.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),a.jsx(Je,{value:`${br||""}`,onChange:Fe=>Mr(O(Fe.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!Xt})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"PIS/COFINS"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CST PIS Entrada"}),a.jsx(Je,{value:Nr,onChange:Fe=>Rr(Fe.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 70...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CST PIS Sada"}),a.jsx(Je,{value:Er,onChange:Fe=>ln(Fe.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"01, 04...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"Alquota PIS (%)"}),a.jsx(Je,{value:`${Fn||""}`,onChange:Fe=>Hn(O(Fe.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,65",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"Alquota COFINS (%)"}),a.jsx(Je,{value:`${$n||""}`,onChange:Fe=>at(O(Fe.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"3,00",disabled:!Xt})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"IPI"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CST IPI"}),a.jsx(Je,{value:Vt,onChange:Fe=>wr(Fe.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 99...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"Alquota IPI (%)"}),a.jsx(Je,{value:`${er||""}`,onChange:Fe=>Ze(O(Fe.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!Xt})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"FCP (%)"}),a.jsx(Je,{value:`${Fr||""}`,onChange:Fe=>jt(O(Fe.target.value)),placeholder:"2,00",disabled:!Xt,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"MVA (%)"}),a.jsx(Je,{value:`${_r||""}`,onChange:Fe=>bt(O(Fe.target.value)),placeholder:"40,00",disabled:!Xt,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"Base Reduzida (%)"}),a.jsx(Je,{value:`${Wt||""}`,onChange:Fe=>Zt(O(Fe.target.value)),placeholder:"0,00",disabled:!Xt,className:"text-xs sm:text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"NCM"}),a.jsx(Je,{value:Br,onChange:Fe=>zr(Re(Fe.target.value)),placeholder:"00000000",disabled:!Xt,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"CEST"}),a.jsx(Je,{value:mn,onChange:Fe=>ma(rt(Fe.target.value)),placeholder:"0000000",disabled:!Xt,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4 sm:col-span-1",children:[a.jsx(De,{className:"text-xs sm:text-right",children:"Descrio NCM"}),a.jsx(Je,{value:_t,onChange:Fe=>Jr(Fe.target.value),placeholder:"Descrio do NCM",disabled:!Xt,className:"text-xs sm:text-sm"})]})]})]}),a.jsxs(uo,{value:"outras",className:"space-y-3 mt-2",children:[r&&a.jsxs("div",{className:"pb-4 mb-4 border-b border-border",children:[a.jsx(ce,{type:"button",onClick:()=>re(!0),disabled:!Xt,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:"Desmembrar e Unir Produto"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{htmlFor:"barcode2",className:"text-xs sm:text-right",children:"Cdigo de Barras"}),a.jsx(Je,{id:"barcode2",value:P,onChange:Fe=>F(G(Fe.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{htmlFor:"barcodeBox",className:"text-xs sm:text-right",children:"Cdigo Barras (Caixa)"}),a.jsx(Je,{id:"barcodeBox",value:M,onChange:Fe=>I(G(Fe.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13 da caixa",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{htmlFor:"reference",className:"text-xs sm:text-right",children:"Referncia"}),a.jsx(Je,{id:"reference",value:R,onChange:Fe=>D(Fe.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: REF-123",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{htmlFor:"brand",className:"text-xs sm:text-right",children:"Marca"}),a.jsx(Je,{id:"brand",value:U,onChange:Fe=>z(Fe.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Nike",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(De,{htmlFor:"group",className:"text-xs sm:text-right",children:"Grupo"}),a.jsx(Je,{id:"group",value:H,onChange:Fe=>q(Fe.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Calados",disabled:!Xt})]})]}),!1]})}),a.jsxs(ra,{children:[a.jsx(ih,{asChild:!0,children:a.jsx(ce,{type:"button",variant:"secondary",children:"Cancelar"})}),a.jsx(ce,{type:"button",onClick:$t,disabled:Qt||!Xt,title:"F5 para salvar",children:Qt?"Salvando...":"Salvar Produto"})]})]}),a.jsx(bot,{open:Nn,onOpenChange:re,product:r,currentPrice:he,allProducts:c,userProfile:u,onApply:async(Fe,It,Sr,kr)=>{if(!Sr)ke(Fe),Be(It),re(!1),d({title:"Preo desmembrado!",description:`Preo unitrio: R$ ${T(Fe).toFixed(2)} | Estoque: ${It}`,variant:"success"});else try{const pr=Number(It),yn=await ox({productId:Sr.id,delta:pr,codigoEmpresa:u?.codigo_empresa}),In=Number(yn?.stock??Number(Sr.stock||0)+pr);if(kr){const Xn={...Sr,stock:In,salePrice:T(Fe),price:T(Fe)};await Yw(Sr.id,Xn)}await IR(r.id),d({title:"Produto desmembrado e unido!",description:`${Sr.name}: novo estoque = ${In} | preo unitrio = R$ ${T(Fe).toFixed(2)}`,variant:"success"}),re(!1),t(!1);try{typeof l=="function"&&l()}catch{}}catch(pr){console.error("[Desmembrar e Unir] Erro:",pr),d({title:"Erro ao processar",description:pr?.message||"Tente novamente",variant:"destructive"})}}})]})}function bot({open:e,onOpenChange:t,product:r,currentPrice:n,allProducts:o,userProfile:s,onApply:i}){const[l,c]=p.useState(""),[d,u]=p.useState(""),[f,h]=p.useState(!1),[m,v]=p.useState(""),[g,y]=p.useState(null),[x,b]=p.useState(!1),w=A=>{const P=String(A||"").replace(/\D/g,"");return(P?Number(P)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},j=A=>{if(!A)return 0;const P=String(A).replace(/\./g,"").replace(",","."),F=Number(P);return Number.isFinite(F)?F:0};p.useEffect(()=>{e&&n&&(c(n),u(""),h(!1),v(""),y(null),b(!1))},[e,n]);const _=l&&d&&Number(d)>0?j(l)/Number(d):0,C=(o||[]).filter(A=>{if(!r||A.id===r.id)return!1;if(!m.trim())return!0;const P=m.toLowerCase();return(A.name||"").toLowerCase().includes(P)||(A.code||"").toLowerCase().includes(P)}).slice(0,10),E=g?Number(d||0)+Number(g.stock||0):0;return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[650px] max-h-[85vh] flex flex-col overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Desmembrar e Unir Produto"}),a.jsx(On,{children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"1. Desmembrar Preo"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{children:"Valor Total (R$)"}),a.jsx(Je,{inputMode:"numeric",placeholder:"0,00",value:`R$ ${l||"0,00"}`,onChange:A=>c(w(A.target.value))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{children:"Quantidade de Unidades"}),a.jsx(Je,{type:"text",inputMode:"numeric",placeholder:"0",value:d,onChange:A=>u(A.target.value.replace(/[^0-9]/g,""))})]}),_>0&&a.jsx("div",{className:"bg-muted/50 border border-border p-3 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Preo Unitrio:"}),a.jsxs("span",{className:"text-lg font-bold",children:["R$ ",_.toFixed(2)]})]})})]}),_>0&&a.jsxs("div",{className:"space-y-3 border-t pt-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"wantToMerge",checked:f,onCheckedChange:A=>{h(!!A),A||(y(null),v(""),b(!1))}}),a.jsx(De,{htmlFor:"wantToMerge",className:"cursor-pointer text-sm font-semibold",children:"2. Unir com outro produto (opcional)"})]}),f&&a.jsxs("div",{className:"space-y-3 ml-6",children:[a.jsx("div",{className:"bg-muted/30 border border-border p-3 rounded-lg",children:a.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.jsx("strong",{children:"Produto atual:"})," ",r?.name," (ser inativado aps unio)"]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{children:"Buscar Produto Destino"}),a.jsx(Je,{placeholder:"Digite o nome ou cdigo...",value:m,onChange:A=>v(A.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(De,{className:"text-xs",children:["Produtos Disponveis (",C.length,")"]}),a.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1 border border-border rounded-lg p-2",children:C.length===0?a.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:"Nenhum produto encontrado"}):C.map(A=>a.jsx("div",{onClick:()=>y(A),className:mr("p-2 rounded-md cursor-pointer border transition-colors",g?.id===A.id?"bg-primary/10 border-primary":"bg-background hover:bg-muted/50 border-transparent"),children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:A.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[A.code&&`Cdigo: ${A.code}  `,"Estoque: ",A.stock||0,"  R$ ",Number(A.price||A.salePrice||0).toFixed(2)]})]}),g?.id===A.id&&a.jsx(Ds,{className:"w-4 h-4 text-primary flex-shrink-0"})]})},A.id))})]}),g&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"bg-primary/5 border border-primary/20 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs font-medium mb-1",children:"Resumo da Unio:"}),a.jsxs("div",{className:"text-xs space-y-0.5 text-muted-foreground",children:[a.jsxs("p",{children:[" Destino: ",a.jsx("strong",{children:g.name})]}),a.jsxs("p",{children:[" Estoque atual: ",g.stock||0]}),a.jsxs("p",{children:[" Estoque a somar: +",d]}),a.jsxs("p",{className:"text-primary font-bold",children:[" Novo estoque: ",E]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"updatePrice",checked:x,onCheckedChange:A=>b(!!A)}),a.jsxs(De,{htmlFor:"updatePrice",className:"cursor-pointer text-xs",children:["Atualizar preo do destino para R$ ",_.toFixed(2)]})]})]})]})]})]}),a.jsxs(ra,{children:[a.jsx(ce,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),a.jsx(ce,{onClick:()=>{if(_>0){const A=_.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});i(A,d,f?g:null,x)}},disabled:_<=0||f&&!g,children:f&&g?"Desmembrar e Unir":"Aplicar Desmembramento"})]})]})})}function wot({open:e,onOpenChange:t,categories:r,onAddCategory:n,onRemoveCategory:o}){const{toast:s}=no(),[i,l]=p.useState(""),[c,d]=p.useState(!1),u=async()=>{const h=i.trim();if(h){if(r.includes(h)){s({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}try{d(!0),await n(h),l(""),s({title:"Categoria adicionada",description:"Ela j aparece na lista.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(m){console.error("[Categorias] add:error",m);const v=hc(m,{action:"save"});s({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}}},f=async h=>{try{d(!0),await o(h),s({title:"Categoria desativada",description:"A categoria foi marcada como inativa.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(m){console.error("[Categorias] remove:error",m);const v=hc(m,{action:"save"});s({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}};return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-[480px]",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Gerenciar Categorias"}),a.jsx(On,{children:"Adicione ou remova categorias de produtos."})]}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{value:i,onChange:h=>l(h.target.value),placeholder:"Nome da nova categoria"}),a.jsx(ce,{onClick:u,disabled:c,children:c?"Processando...":"Adicionar"})]}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.map(h=>a.jsxs("div",{className:"flex items-center justify-between bg-surface-2 p-2 rounded-md",children:[a.jsx("span",{className:"font-semibold",children:h}),a.jsx(ce,{variant:"ghost",size:"icon",className:"h-8 w-8 text-danger/80 hover:text-danger",onClick:()=>f(h),disabled:c,children:a.jsx(Bu,{size:14})})]},h))})]})]})})}function jot(){const{toast:e}=no(),{userProfile:t,authReady:r}=So();Ls();const[n,o]=p.useState(pot),[s,i]=p.useState(got),[l,c]=p.useState([]),[d,u]=p.useState("");p.useState("list");const[f,h]=p.useState(!0),[m,v]=p.useState(null),[g,y]=p.useState(!1),[x,b]=p.useState(!1),[w,j]=p.useState("all"),[_,C]=p.useState(""),[E,A]=p.useState({type:"all",category:"all",status:"active",newOnly:!1}),[P,F]=p.useState(!1),[M,I]=p.useState(!1),[R,D]=p.useState(!1),[U,z]=p.useState(null),[H,q]=p.useState({by:"code",dir:"asc"}),Q=p.useRef(!0),pe=p.useRef(0),be=p.useRef(0);p.useRef(!1);const[V,B]=p.useState(!1),[J,ue]=p.useState("paged"),Ne=J==="paged",[Z,ge]=p.useState(1),[le]=p.useState(100),[se,ee]=p.useState(0);p.useEffect(()=>(Q.current=!0,()=>{Q.current=!1}),[]),p.useEffect(()=>{try{const ye=localStorage.getItem(TU);if(!ye)return;const wt=JSON.parse(ye);wt&&typeof wt=="object"&&((wt.listMode==="paged"||wt.listMode==="all")&&ue(wt.listMode),typeof wt.showStats=="boolean"&&h(wt.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa||!t?.id&&!t?.user_id)return;const wt=t.id||t.user_id,Yt=`produtos:${t.codigo_empresa}`,br=await Aoe({userId:wt,scope:Yt});br&&((br.listMode==="paged"||br.listMode==="all")&&ue(br.listMode),typeof br.showStats=="boolean"&&h(br.showStats))})()},[t?.codigo_empresa,t?.id]),p.useEffect(()=>{try{const ye={listMode:J,showStats:f};localStorage.setItem(TU,JSON.stringify(ye))}catch{}if(t?.codigo_empresa&&(t?.id||t?.user_id)){const ye=t.id||t.user_id,wt=`produtos:${t.codigo_empresa}`;Eoe({userId:ye,scope:wt,settings:{listMode:J,showStats:f}})}},[J,f,t?.codigo_empresa,t?.id]);const de=async()=>{const ye=t?.codigo_empresa||null;if(!r||!ye)return;const wt=`produtos:list:${ye}`;F(!0);const Yt=setTimeout(()=>{if(Q.current)try{const br=JSON.parse(localStorage.getItem(wt)||"[]");Array.isArray(br)&&br.length>0&&(console.warn("[Produtos] slow fallback: using cached snapshot"),o(br))}catch{}},2e3);try{const br=E.status==="all"||E.status==="inactive";let Mr=[];if(Ne){console.log("[Produtos] refetchProducts - modo paginado - Filtro status:",E.status,"includeInactive:",br,"page:",Z,"pageSize:",le);const Nr=await qat({includeInactive:br,search:_,codigoEmpresa:ye,page:Z,pageSize:le});if(!Q.current)return;Mr=Nr?.data||[];const Rr=Nr?.count||0;console.log("[Produtos] refetchProducts - Produtos carregados (paginado):",Mr.length,"de",Rr),o(Mr),ee(Rr)}else{if(console.log("[Produtos] refetchProducts - modo TODOS - Filtro status:",E.status,"includeInactive:",br),Mr=await fu({includeInactive:br,search:_,codigoEmpresa:ye}),!Q.current)return;console.log("[Produtos] refetchProducts - Produtos carregados (todos):",Mr.length),o(Mr),ee(Mr.length)}try{localStorage.setItem(wt,JSON.stringify(Mr))}catch{}be.current=Mr.length,pe.current=Date.now()}catch(br){console.error("[Produtos] refetchProducts:error",br);const Mr=hc(br,{action:"fetch"});e({title:Mr.title,description:Mr.description,variant:"destructive"})}finally{clearTimeout(Yt),F(!1)}};p.useEffect(()=>{const ye=(()=>{try{const Nr=localStorage.getItem("auth:userProfile");return Nr&&JSON.parse(Nr)?.codigo_empresa||null}catch{return null}})(),wt=t?.codigo_empresa||ye;if(!wt)return;const Yt=`produtos:list:${wt}`,br=(()=>{try{return JSON.parse(localStorage.getItem(Yt)||"[]")}catch{return[]}})();Array.isArray(br)&&br.length>0&&(o(br),be.current=br.length);const Mr=async(Nr=3)=>{for(let Rr=0;Rr<Nr;Rr++)try{if(Q.current){await de();break}}catch(Er){console.warn(`[ProdutosPage] Tentativa ${Rr+1} falhou:`,Er),Rr===Nr-1?console.error("[ProdutosPage] Todas as tentativas falharam"):await new Promise(ln=>setTimeout(ln,1e3*(Rr+1)))}};try{const Nr=JSON.parse(localStorage.getItem(`produtos:cats:${wt}`)||"[]");Array.isArray(Nr)&&Nr.length>0&&i(Nr)}catch{}if(r&&t?.codigo_empresa){const Nr=setTimeout(()=>Mr(),100);return(async()=>{try{const Rr=await OU({codigoEmpresa:t.codigo_empresa});if(!Q.current)return;i(Rr);try{localStorage.setItem(`produtos:cats:${t.codigo_empresa}`,JSON.stringify(Rr))}catch{}}catch(Rr){console.error("[Categorias] load on mount:error",Rr)}})(),()=>clearTimeout(Nr)}},[r,t?.codigo_empresa]),p.useEffect(()=>{const ye=()=>{(Date.now()-(pe.current||0)>3e4||be.current===0)&&de()},wt=()=>{document.visibilityState==="visible"&&(Date.now()-(pe.current||0)>3e4||be.current===0)&&de()};return window.addEventListener("focus",ye),document.addEventListener("visibilitychange",wt),()=>{window.removeEventListener("focus",ye),document.removeEventListener("visibilitychange",wt)}},[r,t?.codigo_empresa]),p.useEffect(()=>{ge(1),r&&de()},[E.status,r]),p.useEffect(()=>{const ye=setTimeout(()=>{ge(1),r&&de()},300);return()=>clearTimeout(ye)},[_,r]),p.useEffect(()=>{ge(1),r&&de()},[J,r]);const[Le,ae]=p.useState("N/A");p.useEffect(()=>{let ye=!0;return(async()=>{try{const wt=await Bat({limit:1,codigoEmpresa:t?.codigo_empresa});if(!ye)return;if(Array.isArray(wt)&&wt.length>0){const Yt=wt[0];ae(`${Yt.name} (${Yt.total})`)}else ae("")}catch{ye&&ae("N/A")}})(),()=>{ye=!1}},[t?.codigo_empresa]);const[ie,dt]=p.useState(!1),[At,st]=p.useState(()=>{const ye=new Date;return ye.setHours(0,0,0,0),ye}),[ut,Rt]=p.useState(!1),[Nt,tt]=p.useState(()=>new Date),[he,ke]=p.useState(!1),[et,Me]=p.useState([]),[$e,Be]=p.useState(!1),we=async()=>{try{ke(!0);const ye=await $at({from:At,to:Nt,codigoEmpresa:t?.codigo_empresa});Me(ye||[])}catch(ye){e({title:"Falha ao carregar vendas do perodo",description:ye?.message||"Tente novamente",variant:"destructive"})}finally{ke(!1)}},He=p.useMemo(()=>{const ye=new Date;return{mostSold:Le,lowStock:n.filter(wt=>wt.status==="low_stock"||wt.stock>0&&wt.stock<=wt.minStock).length,expired:n.filter(wt=>wt.validade&&wt.validade<ye).length}},[n,Le]),ht=p.useMemo(()=>{const ye=new Date;return n.filter(wt=>{const Yt=w==="all"?!0:w==="low_stock"?wt.status==="low_stock"||wt.stock>0&&wt.stock<=wt.minStock:w==="expired"?wt.validade&&wt.validade<ye:!1,br=E.status==="all"?!0:wt.status===E.status,Mr=E.type==="all"||wt.type===E.type,Nr=E.category==="all"||wt.category===E.category,Rr=!E.newOnly||wt.dataImportacao&&(()=>Math.floor((new Date-wt.dataImportacao)/864e5)<=7)();return Yt&&br&&Mr&&Nr&&Rr})},[n,w,E]),zt=ye=>ye?.dataImportacao?Math.floor((new Date-ye.dataImportacao)/(1e3*60*60*24))<=7:!1,hr=p.useMemo(()=>{const ye=[...ht],wt=H.dir==="asc"?1:-1,Yt=(Mr,Nr)=>Number.isFinite(Mr)?Mr:Nr,br=Mr=>{if(!Mr)return NaN;if(Mr instanceof Date)return Mr.getTime();const Nr=new Date(Mr);return Number.isNaN(Nr.getTime())?NaN:Nr.getTime()};return ye.sort((Mr,Nr)=>{if(H.by==="code"){const Rr=Yt(parseInt((Mr.code||"").trim(),10),1/0),Er=Yt(parseInt((Nr.code||"").trim(),10),1/0);return Rr===Er?0:Rr>Er?wt:-wt}if(H.by==="name"){const Rr=(Mr.name||"").toString(),Er=(Nr.name||"").toString();return Rr.localeCompare(Er,"pt-BR",{sensitivity:"base"})*wt}if(H.by==="validade"){const Rr=Yt(br(Mr.validade),1/0),Er=Yt(br(Nr.validade),1/0);return Rr===Er?0:Rr>Er?wt:-wt}return 0}),ye},[ht,H]),Mt=p.useMemo(()=>{if(!le)return 1;const ye=Math.ceil((se||0)/le);return ye>0?ye:1},[se,le]),Qt=ye=>{q(wt=>wt.by===ye?{by:ye,dir:wt.dir==="asc"?"desc":"asc"}:{by:ye,dir:"asc"})},Se=ye=>{j(wt=>wt===ye?"all":ye)},kt=()=>{st(()=>{const ye=new Date;return ye.setHours(0,0,0,0),ye}),tt(new Date),dt(!0),setTimeout(we,0)},Lt=(ye,wt)=>{A(Yt=>({...Yt,[ye]:wt}))},fr=async()=>{v(null);const ye=t?.codigo_empresa||null;let wt="";if(ye)try{wt=await IU({codigoEmpresa:ye})}catch(Yt){console.error("[Produtos] handleAddNew: falha ao obter prximo cdigo",Yt)}u(wt||""),y(!0)},yr=ye=>{v(ye),y(!0)},Xt=()=>{try{xot(hr),e({title:"Exportao concluda",description:`${hr.length} produto(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(ye){console.error("[Produtos] export:error",ye);const wt=hc(ye,{action:"export"});e({title:wt.title,description:wt.description,variant:"destructive"})}},nr=ye=>{c(wt=>wt.includes(ye)?wt.filter(Yt=>Yt!==ye):[...wt,ye])},ir=()=>{const ye=hr.map(wt=>wt.id);ye.length&&c(ye)},Ee=()=>{c([])},qe=ye=>{ye?ir():Ee()},Ge=p.useMemo(()=>hr.filter(ye=>l.includes(ye.id)),[hr,l]),Qe=p.useMemo(()=>Ge.some(zt),[Ge]),St=async ye=>{if(l.length)try{await zat({ids:l,status:ye}),await de(),Ee(),e({title:ye==="inactive"?"Produtos inativados":"Produtos atualizados",description:`${l.length} produto(s) atualizado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(wt){const Yt=hc(wt,{action:"save"});e({title:Yt.title,description:Yt.description,variant:"destructive"})}},pt=async()=>{if(!(!l.length||!Qe))try{await Uat({ids:l}),await de(),Ee(),e({title:"Novos removidos",description:"A etiqueta de novo foi removida dos produtos selecionados.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(ye){const wt=hc(ye,{action:"save"});e({title:wt.title,description:wt.description,variant:"destructive"})}},Et=async()=>{const ye=t?.codigo_empresa||null;if(!(!r||!ye))try{const wt=await OU({codigoEmpresa:ye});if(!Q.current)return;i(wt);try{localStorage.setItem(`produtos:cats:${ye}`,JSON.stringify(wt))}catch{}}catch(wt){console.error("[Categorias] load on mount:error",wt)}},mt=async ye=>{i(wt=>{if(wt.includes(ye))return wt;const Yt=[...wt,ye];return Yt.sort((br,Mr)=>br.localeCompare(Mr,"pt-BR")),Yt});try{await Vat(ye,{codigoEmpresa:t?.codigo_empresa}),await Et()}catch(wt){i(br=>br.filter(Mr=>Mr!==ye)),console.error("[Categorias] add:error",wt);const Yt=hc(wt,{action:"save"});e({title:Yt.title,description:Yt.description,variant:"destructive"})}},gt=async ye=>{if(n.some(br=>br.category===ye&&br.status!=="inactive"))throw new Error("Categoria possui produtos ativos vinculados");const Yt=s;i(br=>br.filter(Mr=>Mr!==ye));try{await Wat(ye,{codigoEmpresa:t?.codigo_empresa}),await Et()}catch(br){i(Yt),console.error("[Categorias] remove:error",br);const Mr=hc(br,{action:"save"});e({title:Mr.title,description:Mr.description,variant:"destructive"})}},ft=async ye=>{try{if(console.log("[Produtos] handleSaveProduct",ye),!ye||typeof ye!="object"){console.warn("[Produtos] handleSaveProduct chamado sem payload vlido. Ignorando.");return}const wt=t?.codigo_empresa||null;if(!ye.code&&wt)try{const br=await IU({codigoEmpresa:wt});ye.code=br}catch(br){console.error("[Produtos] Falha ao obter prximo cdigo automtico",br)}const Yt=async br=>{const Nr=new Promise((Rr,Er)=>setTimeout(()=>Er(new Error("Timeout update/create (12s)")),12e3));return Promise.race([br,Nr])};if(ye.id){const br=await Yt(Yw(ye.id,ye,{codigoEmpresa:wt}));console.log("[Produtos] Produto atualizado - active:",br.active,"status:",br.status),o(Mr=>Mr.map(Nr=>Nr.id===br.id?br:Nr)),await de(),console.log("[Produtos] Refetch concludo aps update")}else{ye.dataImportacao||(ye.dataImportacao=new Date);const br=await Yt(SS(ye,{codigoEmpresa:wt}));console.log("[Produtos] Produto criado",br),o(Mr=>[br,...Mr]),setTimeout(()=>{de().catch(Mr=>console.error("[Produtos] refetch ps-create falhou",Mr))},0)}}catch(wt){console.error("[Produtos] Erro no handleSaveProduct",wt);const Yt=hc(wt,{action:"save"});throw e({title:Yt.title,description:Yt.description,variant:"destructive"}),wt}},Dt=ye=>{z(ye),I(!0)},Ft=async()=>{if(U?.id)try{D(!0),await IR(U.id),o(wt=>wt.filter(Yt=>Yt.id!==U.id)),await de();const ye=hc(null,{action:"delete"});e({variant:"success",title:ye.title,description:`Produto "${U.name}" foi inativado com sucesso.`})}catch(ye){const wt=hc(ye,{action:"delete"});e({variant:"destructive",...wt})}finally{D(!1),I(!1),z(null)}};return a.jsxs(a.Fragment,{children:[a.jsxs(Pr.div,{variants:vot,initial:"hidden",animate:"visible",className:"flex flex-col",children:[a.jsxs(Pr.div,{variants:YT,className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Produtos"}),a.jsx("p",{className:"text-text-secondary hidden md:block",children:"Controle total sobre seu inventrio e estoque."})]}),a.jsx(ce,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full hidden md:flex items-center justify-center",onClick:()=>B(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:a.jsx(Of,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-wrap",children:[a.jsx(ce,{variant:"outline",size:"icon",onClick:()=>h(ye=>!ye),title:f?"Ocultar resumo":"Mostrar resumo","aria-label":f?"Ocultar resumo":"Mostrar resumo",children:f?a.jsx(Mp,{className:"h-4 w-4"}):a.jsx(Qp,{className:"h-4 w-4"})}),a.jsxs(ce,{variant:"outline",onClick:Xt,children:[a.jsx(ms,{className:"mr-2 h-4 w-4"})," Exportar"]}),a.jsxs(ce,{variant:"secondary",onClick:()=>Rt(!0),children:[a.jsx(Gs,{className:"mr-2 h-4 w-4"})," Importar XML"]}),a.jsxs(ce,{onClick:fr,children:[a.jsx(ro,{className:"mr-2 h-4 w-4"})," Novo Produto"]})]}),a.jsxs("div",{className:"mt-2 flex md:hidden items-center gap-2",children:[a.jsxs(ce,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:Xt,title:"Exportar CSV","aria-label":"Exportar CSV",children:[a.jsx(ms,{className:"h-4 w-4"}),a.jsx("span",{children:"CSV"})]}),a.jsxs(ce,{variant:"secondary",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>Rt(!0),title:"Importar XML","aria-label":"Importar XML",children:[a.jsx(Gs,{className:"h-4 w-4"}),a.jsx("span",{children:"XML"})]}),a.jsxs(ce,{className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:fr,title:"Novo Produto","aria-label":"Novo Produto",children:[a.jsx(ro,{className:"h-4 w-4"}),a.jsx("span",{children:"Prod"})]}),a.jsxs(ce,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>b(!0),title:"Gerenciar categorias","aria-label":"Gerenciar categorias",children:[a.jsx(S2,{className:"h-4 w-4"}),a.jsx("span",{children:"Cat."})]}),a.jsx(ce,{variant:"outline",size:"icon",className:"h-9 w-9 rounded-xl flex items-center justify-center ml-auto",onClick:()=>B(!0),title:"Configuraes da aba","aria-label":"Configuraes da aba",children:a.jsx(Of,{className:"h-4 w-4"})}),a.jsx(ce,{variant:"outline",size:"icon",className:"h-10 w-10 rounded-xl flex items-center justify-center ml-auto",onClick:()=>h(ye=>!ye),title:f?"Ocultar resumo":"Mostrar resumo","aria-label":f?"Ocultar resumo":"Mostrar resumo",children:f?a.jsx(Mp,{className:"h-5 w-5"}):a.jsx(Qp,{className:"h-5 w-5"})})]})]}),f&&a.jsxs("div",{className:"grid grid-cols-3 gap-3 md:gap-6 mb-6",children:[a.jsx(VE,{icon:jc,title:a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden md:inline",children:"Mais Vendido (Dia)"}),a.jsx("span",{className:"md:hidden",children:"+ vendidos"})]}),value:He.mostSold,subtitle:"Produto com mais sadas hoje",color:"text-brand",onClick:kt}),a.jsx(VE,{icon:qf,title:a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden md:inline",children:"Estoque Baixo"}),a.jsx("span",{className:"md:hidden",children:"Est. baixo"})]}),value:He.lowStock,subtitle:"Produtos precisando de reposio",color:"text-warning",onClick:()=>Se("low_stock"),isActive:w==="low_stock"}),a.jsx(VE,{icon:Fj,title:a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden md:inline",children:"Vendidos"}),a.jsx("span",{className:"md:hidden",children:"Vencidos"})]}),value:He.expired,subtitle:"Produtos fora da data de validade",color:"text-danger",onClick:()=>Se("expired"),isActive:w==="expired"})]}),a.jsx(xn,{open:ie,onOpenChange:dt,children:a.jsxs(vn,{className:"max-w-2xl",onKeyDown:ye=>ye.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-xl font-bold",children:"Vendas por Perodo"}),a.jsx(On,{children:"Selecione o intervalo de datas e visualize os produtos vendidos."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[a.jsxs("div",{children:[a.jsx(De,{className:"mb-1 block",children:"Incio"}),a.jsxs(Oc,{children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"outline",className:"w-full justify-start",children:[a.jsx(Fj,{className:"mr-2 h-4 w-4"}),At?dr(At,"dd/MM/yyyy"):"Incio"]})}),a.jsx(Hl,{className:"p-0 w-[300px]",children:a.jsx("div",{className:"w-[300px] min-h-[332px]",children:a.jsx(Gl,{mode:"single",selected:At,onSelect:ye=>ye&&st(ye),initialFocus:!0,fixedWeeks:!0})})})]})]}),a.jsxs("div",{children:[a.jsx(De,{className:"mb-1 block",children:"Fim"}),a.jsxs(Oc,{children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"outline",className:"w-full justify-start",children:[a.jsx(Fj,{className:"mr-2 h-4 w-4"}),Nt?dr(Nt,"dd/MM/yyyy"):"Fim"]})}),a.jsx(Hl,{className:"p-0 w-[300px]",children:a.jsx("div",{className:"w-[300px] min-h-[332px]",children:a.jsx(Gl,{mode:"single",selected:Nt,onSelect:ye=>ye&&tt(ye),initialFocus:!0,fixedWeeks:!0})})})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{type:"button",onClick:we,disabled:he,className:"w-full",children:he?"Carregando...":"Aplicar"}),a.jsx(ce,{type:"button",variant:"secondary",onClick:()=>{try{const ye=et||[],wt=";",Yt=()=>{const Rr=["Produto;Quantidade"];for(const Er of ye)Rr.push(`${(Er.name||"").replace(/;/g,",")}${wt}${Number(Er.total||0)}`);return Rr.join(`
`)},br=new Blob(["\uFEFF"+Yt()],{type:"text/csv;charset=utf-8;"}),Mr=URL.createObjectURL(br),Nr=document.createElement("a");Nr.href=Mr,Nr.download="vendas-periodo.csv",document.body.appendChild(Nr),Nr.click(),document.body.removeChild(Nr),URL.revokeObjectURL(Mr),e({title:"Exportao concluda",description:`${ye.length} linha(s)`,variant:"success"})}catch(ye){e({title:"Falha ao exportar",description:ye?.message||"Tente novamente",variant:"destructive"})}},children:"Exportar CSV"})]})]}),a.jsx("div",{className:"mt-3 border rounded-md max-h-[50vh] overflow-auto thin-scroll",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-surface-2",children:[a.jsx("th",{className:"text-left p-2",children:"Produto"}),a.jsx("th",{className:"text-right p-2",children:"Quantidade"})]})}),a.jsxs("tbody",{children:[(et||[]).length===0&&!he&&a.jsx("tr",{children:a.jsx("td",{colSpan:2,className:"p-3 text-text-muted",children:"Nenhum item no perodo."})}),(et||[]).map(ye=>a.jsxs("tr",{className:"border-t border-border",children:[a.jsx("td",{className:"p-2",children:ye.name}),a.jsx("td",{className:"p-2 text-right font-mono",children:Number(ye.total||0)})]},ye.id))]})]})}),a.jsx(ra,{children:a.jsx(ih,{asChild:!0,children:a.jsx(ce,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),a.jsx(xn,{open:V,onOpenChange:B,children:a.jsxs(vn,{className:"max-w-2xl",children:[a.jsx(pn,{children:a.jsx(fn,{children:"Configuraes da aba"})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-text-muted",children:"Modo de listagem"}),a.jsxs(Cn,{value:J,onValueChange:ue,children:[a.jsx(jn,{className:"w-[200px] h-8 text-xs",children:a.jsx(An,{placeholder:"Paginado"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"paged",children:"Paginado (100 por pgina)"}),a.jsx(nt,{value:"all",children:"Todos (sem paginao)"})]})]})]}),a.jsx("div",{className:"flex items-center justify-between pt-1",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"produtos-show-stats",checked:f,onCheckedChange:h}),a.jsx("label",{htmlFor:"produtos-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de resumo no topo"})]})})]}),a.jsx(ra,{children:a.jsx(ih,{asChild:!0,children:a.jsx(ce,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),a.jsxs(Pr.div,{variants:YT,className:"bg-surface rounded-lg border border-border flex flex-col",children:[a.jsxs("div",{className:"p-3 pb-4 sm:p-4 border-b border-border space-y-3 flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar por nome ou cdigo...",className:"pl-9 text-sm",value:_,onChange:ye=>C(ye.target.value)})]}),a.jsx(ce,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>Be(!0),"aria-label":"Abrir filtros",title:"Filtros",children:a.jsx(Zk,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"hidden md:flex w-full items-center gap-3",children:[a.jsx("div",{className:"flex-1 min-w-[120px]",children:a.jsxs(Cn,{value:E.type,onValueChange:ye=>Lt("type",ye),children:[a.jsx(jn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Tipos"}),a.jsx(nt,{value:"Venda",children:"Venda"}),a.jsx(nt,{value:"Uso Interno",children:"Uso Interno"})]})]})}),a.jsx("div",{className:"flex-1 min-w-[140px]",children:a.jsxs(Cn,{value:E.category,onValueChange:ye=>Lt("category",ye),children:[a.jsx(jn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Categorias"}),s.map(ye=>a.jsx(nt,{value:ye,children:ye},ye))]})]})}),a.jsx("div",{className:"flex-1 max-w-[180px]",children:a.jsxs(Cn,{value:E.status,onValueChange:ye=>Lt("status",ye),children:[a.jsx(jn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Status"}),a.jsx(nt,{value:"active",children:"Ativo"}),a.jsx(nt,{value:"low_stock",children:"Estoque Baixo"}),a.jsx(nt,{value:"inactive",children:"Inativo"})]})]})}),a.jsxs("div",{className:"flex-1 flex justify-end gap-2 min-w-[160px]",children:[a.jsxs(ce,{variant:"outline",onClick:()=>Lt("newOnly",!E.newOnly),className:mr("text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",E.newOnly&&"bg-amber-500 text-black border-amber-500 hover:bg-amber-400"),size:"sm",children:[a.jsx("span",{className:"mr-1",children:""}),a.jsx("span",{children:"Novos"})]}),a.jsxs(ce,{variant:"outline",onClick:()=>b(!0),className:"text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",size:"sm",children:[a.jsx(S2,{className:"h-3 w-3 sm:h-4 sm:w-4"}),a.jsx("span",{children:"Categorias"})]}),a.jsx(ce,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>B(ye=>!ye),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:a.jsx(Of,{className:"h-4 w-4"})})]})]})]}),l.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"px-3 sm:px-4 py-2.5 border-b border-border flex md:hidden items-center gap-2 text-xs",children:[a.jsxs("span",{className:"font-medium mr-2",children:[l.length," sel."]}),a.jsxs("button",{type:"button",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-border bg-surface-2",onClick:()=>{const ye=hr.length>0&&hr.every(wt=>l.includes(wt.id));qe(!ye)},children:[a.jsx(Ha,{checked:hr.length>0&&hr.every(ye=>l.includes(ye.id)),className:"h-4 w-4"}),a.jsx("span",{children:"Todos"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 ml-auto",children:[a.jsx(ce,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>St("active"),children:a.jsx(Ds,{className:"h-4 w-4"})}),a.jsx(ce,{variant:"outline",size:"icon",className:"h-8 w-8 text-danger border-danger/60 hover:bg-danger/10",onClick:()=>St("inactive"),children:a.jsx(Bu,{className:"h-4 w-4"})}),Qe&&a.jsx(ce,{variant:"outline",size:"icon",className:"h-8 w-8 border-amber-500/70 text-amber-700 hover:bg-amber-500/10",onClick:pt,children:a.jsx(S2,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"hidden md:flex px-4 py-2 border-b border-border items-center gap-3 text-xs",children:[a.jsx("span",{className:"font-medium text-text-secondary whitespace-nowrap",children:l.length===0?"Nenhum item selecionado":`${l.length} produto${l.length>1?"s":""} selecionado${l.length>1?"s":""}`}),a.jsxs("div",{className:"flex flex-1 flex-wrap items-center justify-end gap-2",children:[a.jsxs(ce,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:ir,children:[a.jsx(Ds,{className:"h-3 w-3"}),a.jsx("span",{children:"Marcar filtrados"})]}),a.jsxs(ce,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:Ee,children:[a.jsx(Zk,{className:"h-3 w-3"}),a.jsx("span",{children:"Limpar seleo"})]}),a.jsxs(ce,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-emerald-500/70 text-emerald-300 bg-emerald-500/10 hover:bg-emerald-500/20 flex items-center gap-1",onClick:()=>St("active"),children:[a.jsx(Ds,{className:"h-3 w-3"}),a.jsx("span",{children:"Ativar itens"})]}),a.jsxs(ce,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full text-danger border-danger/60 hover:bg-danger/10 flex items-center gap-1",onClick:()=>St("inactive"),children:[a.jsx(Mp,{className:"h-3 w-3"}),a.jsx("span",{children:"Desativar itens"})]}),Qe&&a.jsxs(ce,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-amber-500/70 text-amber-500 hover:bg-amber-500/10 flex items-center gap-1",onClick:pt,children:[a.jsx(S2,{className:"h-3 w-3"}),a.jsx("span",{children:'Limpar tag "Novo"'})]})]})]})]}),a.jsx("div",{children:hr.length===0?a.jsxs("div",{className:"p-10 text-center text-text-secondary",children:[a.jsx("p",{className:"text-lg mb-3",children:"Nenhum produto cadastrado."}),a.jsxs(ce,{onClick:fr,children:[a.jsx(ro,{className:"mr-2 h-4 w-4"}),"Cadastrar primeiro produto"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden p-3 space-y-3",children:hr.map(ye=>{const wt=l.includes(ye.id);return a.jsxs("div",{className:mr("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer",wt?"border-brand/70 bg-brand/5":"border-border"),onClick:()=>yr(ye),children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsx("button",{type:"button",className:"pt-1 pr-2 -ml-1 flex items-center justify-center w-9 h-9",onClick:Yt=>{Yt.stopPropagation(),nr(ye.id)},children:a.jsx(Ha,{checked:wt,className:"h-5 w-5 border-2"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",title:ye.name,children:ye.name}),ye.dataImportacao&&(()=>Math.floor((new Date-ye.dataImportacao)/864e5)<=7?a.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Novo"})]}):null)()]}),a.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:ye.category||"Sem categoria"})]}),a.jsx("span",{className:mr("inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0",ye.status==="active"&&"bg-emerald-50/5 border-emerald-500/30 text-emerald-400",ye.status==="low_stock"&&"bg-amber-50/5 border-amber-500/30 text-amber-400",ye.status==="inactive"&&"bg-surface-2 border-border text-text-muted"),children:ye.status==="active"?"Ativo":ye.status==="low_stock"?"Estoque Baixo":"Inativo"})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-text-muted",children:[ye.code&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"Cd."}),a.jsx("span",{className:"font-mono text-text-primary text-xs",children:ye.code})]}),a.jsx("span",{className:"mx-1 text-text-muted",children:""}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"R$"}),a.jsx("span",{className:"font-semibold text-text-primary",children:ye.price.toFixed(2)})]}),a.jsx("span",{className:"mx-1 text-text-muted",children:""}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"Est."}),a.jsx("span",{className:"font-medium text-text-primary",children:ye.stock})]}),ye.validade&&a.jsx("span",{className:"mx-1 text-text-muted",children:""}),ye.validade&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"Val."}),a.jsx("span",{className:"text-text-primary",children:(()=>{const Yt=ye.validade instanceof Date?ye.validade:A6(String(ye.validade));return isNaN(Yt)?"-":dr(Yt,"dd/MM/yy")})()})]}),a.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[a.jsx(ce,{variant:"outline",size:"icon",onClick:Yt=>{Yt.stopPropagation(),yr(ye)},className:"h-7 w-7",children:a.jsx(fl,{className:"h-3.5 w-3.5"})}),a.jsx(ce,{variant:"outline",size:"icon",onClick:Yt=>{Yt.stopPropagation(),Dt(ye)},className:"h-7 w-7 text-danger hover:text-danger",children:a.jsx(Bu,{className:"h-3.5 w-3.5"})})]})]})]},ye.id)})}),a.jsx("div",{className:"hidden md:block rounded-lg border border-border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm bg-surface table-fixed",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{className:"border-b border-border",children:[a.jsx("th",{className:"p-3 w-10 text-center",children:a.jsx(Ha,{checked:hr.length>0&&hr.every(ye=>l.includes(ye.id)),onCheckedChange:ye=>qe(!!ye)})}),a.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[110px]",onClick:()=>Qt("code"),children:["Cdigo ",H.by==="code"?H.dir==="asc"?"":"":""]}),a.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[40%]",onClick:()=>Qt("name"),children:["Produto ",H.by==="name"?H.dir==="asc"?"":"":""]}),a.jsx("th",{className:"p-3 text-left font-semibold whitespace-nowrap w-[18%]",children:"Categoria"}),a.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[120px]",children:"Preo"}),a.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[110px]",children:"Estoque"}),a.jsxs("th",{className:"p-3 text-center font-semibold select-none cursor-pointer whitespace-nowrap w-[120px]",onClick:()=>Qt("validade"),children:["Validade ",H.by==="validade"?H.dir==="asc"?"":"":""]}),a.jsx("th",{className:"p-3 text-center font-semibold whitespace-nowrap w-[140px]",children:"Status"}),a.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[90px]",children:"Aes"})]})}),a.jsx("tbody",{className:"text-text-primary divide-y divide-border",children:hr.map(ye=>a.jsxs("tr",{className:"hover:bg-surface-2 transition-colors group cursor-pointer align-middle",children:[a.jsx("td",{className:"p-3 text-center align-middle",children:a.jsx(Ha,{checked:l.includes(ye.id),onCheckedChange:()=>nr(ye.id)})}),a.jsx("td",{className:"p-3 font-mono text-sm text-text-secondary align-middle whitespace-nowrap",onClick:()=>yr(ye),children:ye.code||"-"}),a.jsx("td",{className:"p-3 font-semibold align-middle text-text-primary whitespace-nowrap overflow-hidden text-ellipsis",onClick:()=>yr(ye),title:ye.name,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"truncate",children:ye.name}),ye.dataImportacao&&(()=>Math.floor((new Date-ye.dataImportacao)/864e5)<=7?a.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Novo"})]}):null)()]})}),a.jsx("td",{className:"p-3 text-text-secondary align-middle whitespace-nowrap",onClick:()=>yr(ye),children:ye.category}),a.jsxs("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>yr(ye),children:["R$ ",ye.price.toFixed(2)]}),a.jsx("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>yr(ye),children:ye.stock}),a.jsx("td",{className:"p-3 text-center font-mono tabular-nums whitespace-nowrap",onClick:()=>yr(ye),children:(()=>{if(!ye.validade)return"-";const wt=ye.validade instanceof Date?ye.validade:A6(String(ye.validade));return isNaN(wt)?"-":dr(wt,"dd/MM/yy")})()}),a.jsx("td",{className:"p-3 text-center whitespace-nowrap",onClick:()=>yr(ye),children:a.jsx("span",{className:mr("px-2 py-1 text-xs font-bold rounded-full",ye.status==="active"&&"bg-success/10 text-success",ye.status==="low_stock"&&"bg-warning/10 text-warning",ye.status==="inactive"&&"bg-danger/10 text-danger"),children:ye.status==="active"?"Ativo":ye.status==="low_stock"?"Estoque Baixo":"Inativo"})}),a.jsx("td",{className:"p-3 whitespace-nowrap",children:a.jsx("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(ce,{variant:"ghost",size:"icon",className:"h-8 w-8 text-text-muted hover:text-danger",onClick:wt=>{wt.stopPropagation(),Dt(ye)},children:a.jsx(Bu,{size:14})})})})]},ye.id))})]})})]})}),Ne&&a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted px-3 sm:px-4 pb-3",children:[a.jsxs("span",{children:["Pgina ",Z," de ",Mt," (",se," produto(s))"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ce,{type:"button",variant:"outline",size:"sm",onClick:()=>ge(ye=>Math.max(1,ye-1)),disabled:Z<=1,children:"Anterior"}),a.jsx(ce,{type:"button",variant:"outline",size:"sm",onClick:()=>ge(ye=>Math.min(Mt,ye+1)),disabled:Z>=Mt,children:"Prxima"})]})]})]})]}),a.jsx(yot,{open:g,onOpenChange:y,product:m,categories:s,onSave:ft,onCreateCategory:mt,suggestedCode:m?void 0:d,onRefreshProducts:de,products:n}),a.jsx(xn,{open:M,onOpenChange:I,children:a.jsxs(vn,{className:"sm:max-w-[480px]",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Excluir produto"}),a.jsxs(On,{children:["Tem certeza que deseja excluir o produto",U?` "${U.name}"`:"","? Esta ao no pode ser desfeita."]})]}),a.jsxs(ra,{children:[a.jsx(ih,{asChild:!0,children:a.jsx(ce,{type:"button",variant:"secondary",disabled:R,children:"Cancelar"})}),a.jsx(ce,{type:"button",variant:"destructive",onClick:Ft,disabled:R,children:R?"Excluindo...":"Excluir"})]})]})}),a.jsx(hot,{open:ut,onOpenChange:Rt,products:n,codigoEmpresa:t?.codigo_empresa,onSuccess:()=>{de(),Rt(!1)}}),a.jsx(xn,{open:$e,onOpenChange:Be,children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-[420px]",children:[a.jsx(pn,{children:a.jsx(fn,{className:"text-base",children:"Filtros de Produtos"})}),a.jsxs("div",{className:"space-y-3 py-2 text-xs",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(De,{className:"text-xs",children:"Tipo"}),a.jsxs(Cn,{value:E.type,onValueChange:ye=>Lt("type",ye),children:[a.jsx(jn,{className:"text-xs",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Todos"}),a.jsx(nt,{value:"Venda",children:"Venda"}),a.jsx(nt,{value:"Uso Interno",children:"Uso Interno"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(De,{className:"text-xs",children:"Categoria"}),a.jsxs(Cn,{value:E.category,onValueChange:ye=>Lt("category",ye),children:[a.jsx(jn,{className:"text-xs",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Todas"}),s.map(ye=>a.jsx(nt,{value:ye,children:ye},ye))]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(De,{className:"text-xs",children:"Status"}),a.jsxs(Cn,{value:E.status,onValueChange:ye=>Lt("status",ye),children:[a.jsx(jn,{className:"text-xs",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Todos"}),a.jsx(nt,{value:"active",children:"Ativo"}),a.jsx(nt,{value:"low_stock",children:"Estoque Baixo"}),a.jsx(nt,{value:"inactive",children:"Inativo"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[a.jsx(Ha,{id:"mobileNewOnly",checked:!!E.newOnly,onCheckedChange:ye=>Lt("newOnly",!!ye)}),a.jsx(De,{htmlFor:"mobileNewOnly",className:"text-xs flex items-center gap-1",children:a.jsx("span",{children:"Somente Novos"})})]})]}),a.jsxs(ra,{className:"flex justify-between mt-2",children:[a.jsx(ce,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:()=>{A({type:"all",category:"all",status:"active",newOnly:!1}),Be(!1)},children:"Limpar"}),a.jsx(ce,{type:"button",size:"sm",className:"text-xs",onClick:()=>Be(!1),children:"Aplicar"})]})]})}),a.jsx(wot,{open:x,onOpenChange:b,categories:s,onAddCategory:mt,onRemoveCategory:gt})]})}function _ot({purchase:e,items:t,onClose:r,onEdit:n,onReprocess:o,onDownloadXML:s,onInactivate:i}){if(!e)return null;const l=t.reduce((d,u)=>d+Number(u.valor_total||0),0),c=d=>d?.data_importacao?Gye(new Date,new Date(d.data_importacao))<=7:!1;return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-3 py-4 bg-black/60 backdrop-blur-sm",children:a.jsxs("div",{className:"relative w-[95vw] sm:w-full sm:max-w-4xl max-h-[85vh] bg-surface rounded-xl shadow-2xl border border-border overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"relative bg-surface border-b border-border p-4",children:[a.jsx("button",{onClick:r,className:"absolute top-3 right-3 p-1.5 hover:bg-surface-2 rounded-lg transition-colors",children:a.jsx(yl,{className:"h-4 w-4 text-text-muted"})}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4 pr-0 sm:pr-10",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"p-2 bg-brand/10 rounded-lg",children:a.jsx(Gs,{className:"h-5 w-5 text-brand"})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-bold text-text-primary mb-0.5",children:["NF-e ",e.numero_nfe,e.serie_nfe&&` / Srie ${e.serie_nfe}`]}),a.jsx("p",{className:"text-text-muted text-xs",children:e.natureza_operacao||"Nota Fiscal Eletrnica"})]})]}),a.jsxs("div",{className:"mt-3 sm:mt-0 sm:text-right",children:[a.jsx("p",{className:"text-text-muted text-xs mb-0.5",children:"Valor Total"}),a.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-success whitespace-nowrap",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-6",children:a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-surface-2 rounded-lg border border-border p-4",children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.jsx(Ou,{className:"h-4 w-4 text-brand"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs font-medium text-text-muted mb-0.5",children:"Fornecedor"}),a.jsx("p",{className:"font-semibold text-base text-text-primary leading-snug break-words",children:e.fornecedor?.nome||"No identificado"}),e.fornecedor?.cnpj&&a.jsxs("p",{className:"text-xs text-text-muted mt-0.5",children:["CNPJ: ",e.fornecedor.cnpj]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Ns,{className:"h-3.5 w-3.5 text-info"}),a.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Emisso"})]}),a.jsx("p",{className:"font-semibold text-text-primary",children:e.data_emissao?dr(new Date(e.data_emissao),"dd/MM/yyyy",{locale:wa}):"No informada"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Bue,{className:"h-3.5 w-3.5 text-warning"}),a.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Operao"})]}),a.jsx("p",{className:"font-semibold text-text-primary",children:e.tipo_operacao||"Entrada"})]}),e.forma_pagamento&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(qm,{className:"h-3.5 w-3.5 text-success"}),a.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Pagamento"})]}),a.jsx("p",{className:"font-semibold text-text-primary",children:e.forma_pagamento})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor dos Produtos"}),a.jsxs("p",{className:"font-semibold text-text-primary",children:["R$ ",l.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor Total NF-e"}),a.jsxs("p",{className:"font-semibold text-brand",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-base font-semibold text-text-primary flex items-center gap-2 mb-3",children:[a.jsx(_d,{className:"h-4 w-4 text-brand"}),"Produtos da NF-e",a.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-brand/10 text-brand font-medium ml-2",children:t.length})]}),a.jsx("div",{className:"space-y-2",children:t.map((d,u)=>a.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border hover:border-brand/30 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center mt-0.5",children:u+1}),a.jsxs("div",{className:"flex-1",children:[d.produto?.nome?a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"font-medium text-base text-text-primary mb-0.5",children:["Produto atual: ",d.produto.nome]}),d.nome_produto_xml&&a.jsxs("p",{className:"text-xs text-text-muted mb-1",children:["XML original: ",a.jsx("span",{className:"font-medium text-text-primary",children:d.nome_produto_xml})]})]}):a.jsx("p",{className:"font-medium text-sm text-text-primary mb-1",children:d.nome_produto_xml}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-text-muted mb-1.5",children:[(d.produto?.codigo_produto||d.codigo_produto_xml)&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"Cd:"})," ",d.produto?.codigo_produto||d.codigo_produto_xml]}),d.ean_xml&&d.ean_xml!=="SEM GTIN"&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"EAN:"})," ",d.ean_xml]}),d.ncm_xml&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"NCM:"})," ",d.ncm_xml]}),d.unidade_xml&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"Un:"})," ",d.unidade_xml]}),d.produto&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-success/20 text-success font-medium",children:" Cadastrado"}),d.produto&&c(d.produto)&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand font-medium",children:[a.jsx(eI,{className:"h-3 w-3"}),"Novo"]}),d.vinculado_manualmente&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-warning/20 text-warning font-medium",children:" Vinculado"}),!d.produto&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-text-muted/20 text-text-muted font-medium",children:" No importado"})]})]})]})}),a.jsxs("div",{className:"flex-shrink-0 text-right",children:[a.jsxs("div",{className:"mb-1.5",children:[a.jsx("span",{className:"text-xs text-text-muted mr-1",children:"Qtd:"}),a.jsx("span",{className:"font-bold text-base text-warning",children:d.quantidade})]}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: ",a.jsxs("span",{className:"font-semibold text-success",children:["R$ ",Number(d.valor_unitario||0).toFixed(2)]})]}),a.jsxs("p",{className:"text-sm font-bold text-text-primary",children:["Total: R$ ",Number(d.valor_total||0).toFixed(2)]})]})]})]})},u))})]}),e.chave_nfe&&a.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("p",{className:"text-xs font-medium text-text-muted mb-1.5 flex items-center gap-1.5",children:[a.jsx(Gs,{className:"h-3 w-3"}),"Chave de Acesso NF-e:"]}),a.jsx("p",{className:"font-mono text-xs text-text-primary break-all leading-relaxed select-all",children:e.chave_nfe})]})]})}),a.jsxs("div",{className:"p-3 sm:p-4 bg-surface-2 border-t border-border flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[a.jsx("div",{className:"flex flex-wrap gap-2",children:e.ativo&&a.jsxs(a.Fragment,{children:[a.jsxs(ce,{onClick:()=>n?.(e),size:"sm",variant:"outline",className:"gap-2",children:[a.jsx(fl,{className:"h-4 w-4"}),"Editar"]}),a.jsxs(ce,{onClick:()=>o?.(e),size:"sm",variant:"outline",className:"gap-2",disabled:!e.xml_completo,children:[a.jsx(Rp,{className:"h-4 w-4"}),"Reprocessar"]}),e.xml_completo&&a.jsx(a.Fragment,{children:a.jsxs(ce,{onClick:()=>s?.(e),size:"sm",variant:"outline",className:"gap-2",children:[a.jsx(ms,{className:"h-4 w-4"}),"XML"]})}),a.jsxs(ce,{onClick:()=>i?.(e),size:"sm",variant:"outline",className:"gap-2 text-destructive hover:text-destructive",children:[a.jsx(Bu,{className:"h-4 w-4"}),"Inativar"]})]})}),a.jsx(ce,{onClick:r,variant:"outline",className:"w-full sm:w-auto",children:"Fechar"})]})]})})}function Not({open:e,onOpenChange:t,purchase:r,products:n,codigoEmpresa:o,onSuccess:s,autoFile:i}){const{toast:l}=no(),[c,d]=p.useState("upload"),[u,f]=p.useState(null),[h,m]=p.useState(null),[v,g]=p.useState([]),[y,x]=p.useState(!1),[b,w]=p.useState({created:0,updated:0,errors:0,details:[]}),[j,_]=p.useState({}),[C,E]=p.useState({}),[A,P]=p.useState({}),[F,M]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[I,R]=p.useState({isOpen:!1}),D=()=>{const Z=h?.nfe?.modelo||r?.modelo_nfe;return Z==="55"?"NF-e":Z==="65"?"NFC-e":"NF-e / NFC-e"},U=(Z,ge,le)=>j[Z]?.[ge]??le,z=(Z,ge)=>!Z||!ge?0:Z*(1+ge/100),H=Z=>{E(ge=>({...ge,[Z]:!ge[Z]}))},q=(Z,ge,le)=>{console.log("[XMLReprocessModal] handleEditProduct chamado:",{index:Z,field:ge,value:le}),_(se=>{const ee={...se,[Z]:{...se[Z],[ge]:le}};return console.log("[XMLReprocessModal] Novo estado editedProducts:",ee),ee})},Q=Z=>{g(ge=>ge.map((le,se)=>{if(se===Z){const ee=!le.selected;return P(de=>({...de,[Z]:ee})),{...le,selected:ee}}return le}))},pe=(Z,ge)=>{console.log("[XMLReprocessModal] handleLinkProduct chamado:",{index:Z,productId:ge}),console.log("[XMLReprocessModal] Estado editedProducts antes:",j[Z]),q(Z,"linkedProductId",ge),console.log("[XMLReprocessModal] Estado editedProducts depois:",{...j,[Z]:{...j[Z],linkedProductId:ge}})};p.useEffect(()=>{i&&e&&be(i)},[i,e]);const be=async Z=>{f(Z);try{console.log("[XMLReprocess] Processando arquivo automtico..."),console.log("[XMLReprocess] Purchase data:",r);const le=await Z.text();console.log("[XMLReprocess] XML content length:",le.length);const se=CS(le);if(!se.success){l({title:"Erro ao ler XML",description:se.error||"XML invlido",variant:"destructive"});return}console.log("[XMLReprocess] Dados parseados:",se.data),console.log("[XMLReprocess] Produtos encontrados:",se.data?.produtos?.length||0),console.log("[XMLReprocess] Comparando chaves:",{xmlChave:se.data?.nfe?.chaveAcesso,purchaseChave:r?.chave_nfe,match:se.data?.nfe?.chaveAcesso===r?.chave_nfe}),m(se.data);const ee=await Ioe(r.id);console.log("[XMLReprocess] Itens da compra original:",ee.length);const de=se.data?.produtos?.map((ae,ie)=>{const dt=PS(ae,n),At=!dt,st=ee.find(Nt=>ae.codigo&&Nt.codigo_produto_xml?Nt.codigo_produto_xml===ae.codigo:Nt.nome_produto_xml===ae.nome),ut=!!st,Rt=st?.selecionado_na_importacao||!1;return console.log(`[XMLReprocess] Produto ${ie+1}: ${ae.nome}`),console.log(`  - Cdigo XML: ${ae.codigo}`),console.log("  - originalItem encontrado:",st?`${st.nome_produto_xml} (cdigo: ${st.codigo_produto_xml})`:"NO ENCONTRADO"),console.log(`  - wasImported: ${ut}`),console.log(`  - wasSelectedInOriginalImport: ${Rt}`),{index:ie,xml:ae,existing:dt,isNew:At,wasImported:ut,selected:A[ie]!==void 0?A[ie]:ut}})||[];console.log("[XMLReprocess] Preview preparado:",de.length,"produtos"),console.log("[XMLReprocess] Produtos marcados:",de.filter(ae=>ae.selected).length),console.log("[XMLReprocess] Produtos importados originalmente:",de.filter(ae=>ae.wasImported).length),console.log("[XMLReprocess] Items da compra original detalhado:"),ee.forEach((ae,ie)=>{console.log(`  ${ie+1}. ${ae.nome_produto_xml} (cdigo: ${ae.codigo_produto_xml}) - selecionado_na_importacao: ${ae.selecionado_na_importacao}`)}),g(de);const Le={};de.forEach((ae,ie)=>{ae.xml.precoVenda&&(Le[ie]={salePrice:Number(ae.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Le),_(Le),d("preview")}catch(le){console.error("[XMLReprocess] Erro ao processar arquivo automtico:",le),l({title:"Erro",description:"Erro ao processar o XML salvo.",variant:"destructive"})}},V=async Z=>{const ge=Z.target.files?.[0];if(!ge){console.log("[XMLReprocess] Nenhum arquivo selecionado");return}if(console.log("[XMLReprocess] Arquivo selecionado:",ge.name),!ge.name.endsWith(".xml")){l({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}f(ge);try{console.log("[XMLReprocess] Lendo contedo do arquivo...");const le=await ge.text();console.log("[XMLReprocess] Arquivo lido, parseando XML...");const se=CS(le);if(console.log("[XMLReprocess] XML parseado:",se),!se.success){l({title:"Erro ao ler XML",description:se.error||"XML invlido",variant:"destructive"});return}if(!se.data?.produtos||se.data.produtos.length===0){l({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(se.data?.nfe?.chaveAcesso!==r?.chave_nfe){l({title:"XML incompatvel",description:"Este XML no corresponde  NF-e selecionada. Verifique a chave de acesso.",variant:"destructive"});return}m(se.data);let ee=n;try{ee=await fu({search:"",codigoEmpresa:o,includeInactive:!0})||n,console.log("[XMLReprocess] Produtos carregados para validao:",ee.length)}catch(ae){console.warn("[XMLReprocess] No foi possvel carregar lista completa, usando cache:",ae)}const de=se.data.produtos.map((ae,ie)=>{const dt=PS(ae,ee);return{xml:ae,existing:dt,isNew:!dt,willCreate:!dt,willUpdate:!!dt,selected:!0,index:ie}});g(de);const Le={};de.forEach((ae,ie)=>{ae.xml.precoVenda&&(Le[ie]={salePrice:Number(ae.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Le),_(Le),console.log("[XMLReprocess] Preview preparado, mudando para step preview. Total produtos:",de.length),d("preview")}catch(le){console.error("[XMLReprocess] Erro ao processar arquivo:",le),l({title:"Erro",description:"Erro ao processar o arquivo XML.",variant:"destructive"})}},B=()=>{R({isOpen:!0})},J=async()=>{if(R({isOpen:!1}),!h||!r){l({title:"Erro",description:"Dados insuficientes para reprocessamento.",variant:"destructive"});return}x(!0),d("processing");const Z={created:0,updated:0,removed:0,errors:0,details:[]},ge=v.filter(se=>se.selected),le=v.filter(se=>!se.selected);console.log("[XMLReprocess] Iniciando reprocessamento para compra:",r.id),console.log("[XMLReprocess] Produtos selecionados:",ge.length),console.log("[XMLReprocess] Produtos desmarcados:",le.length);try{for(const se of le){const de=(j[se.index]||{}).name||se.xml.nome,Le=Number(se.xml.quantidade);try{if(se.isNew){const ae=se.existing;ae&&(await IR(ae.id),Z.removed++,Z.details.push({produto:de,acao:"Produto removido (era novo e foi desmarcado)",status:"success"}))}else{const ae=se.existing;ae&&Le>0&&(await ox({productId:ae.id,delta:-Le,codigoEmpresa:r.codigo_empresa}),Z.updated++,Z.details.push({produto:de,acao:`Estoque revertido -${Le}`,status:"success"}))}}catch(ae){console.error(`[XMLReprocess] Erro ao processar produto desmarcado: ${de}`,ae),Z.errors++,Z.details.push({produto:de,acao:`Erro ao reverter: ${ae.message}`,status:"error"})}}for(const se of ge){const ee=j[se.index]||{},de=ee.name||se.xml.nome,Le=ee.qty!==void 0?ee.qty:Number(se.xml.quantidade),ae=ee.margin,ie=ee.salePrice,dt=ee.linkedProductId;try{if(se.isNew&&(!dt||dt==="new")){const At=XT(se.xml,r.codigo_empresa);if(de&&(At.name=de),ie!=null)At.salePrice=ie,At.price=ie;else if(ae!=null&&ae>0){const ut=At.costPrice||0;if(ut>0){const Rt=ut*(1+ae/100);At.salePrice=Rt,At.price=Rt}}else At.salePrice!=null&&At.price==null&&(At.price=At.salePrice);const st=await SS(At,{codigoEmpresa:r.codigo_empresa});Le>0&&await ox({productId:st.id,delta:Le,codigoEmpresa:r.codigo_empresa}),Z.created++,Z.details.push({produto:de,acao:Le>0?`Criado com estoque ${Le}`:"Criado",status:"success"})}else{const At=dt&&dt!=="force-new"&&dt!=="new"?n.find(st=>st.id===dt):se.existing;if(ee.updatePrice&&At){const st=Number(se.xml.valorUnitario)||0,ut={};if(st>0&&(ut.costPrice=st),ie!=null)ut.salePrice=ie,ut.price=ie;else if(ae!=null&&ae>0&&st>0){const Rt=st*(1+ae/100);ut.salePrice=Rt,ut.price=Rt}await Yw(At.id,ut)}Z.updated++,Z.details.push({produto:de,acao:ee.updatePrice?"Preo atualizado":"Mantido sem alteraes",status:"success"})}}catch(At){console.error(`[XMLReprocess] Erro ao processar produto: ${de}`,At),Z.errors++,Z.details.push({produto:de,acao:`Erro: ${At.message}`,status:"error"})}}}catch(se){console.error("[XMLReprocess] Erro geral no reprocessamento:",se),Z.errors++,Z.details.push({produto:"Sistema",acao:`Erro geral: ${se.message}`,status:"error",error:se.message})}try{const se=ge.map(ee=>{const de=j[ee.index]||{},Le=de.linkedProductId;let ae=null;return Le&&Le!=="force-new"?ae=Le:!ee.isNew&&Le!=="force-new"&&(ae=ee.existing?.id||null),{produtoId:ae,codigoProdutoXML:ee.xml.codigo,nomeProdutoXML:ee.xml.nome,eanXML:ee.xml.ean,ncmXML:ee.xml.ncm,cfopXML:ee.xml.cfop,unidadeXML:ee.xml.unidade,quantidade:de.qty!==void 0?de.qty:Number(ee.xml.quantidade),valorUnitario:Number(ee.xml.valorUnitario)||0,valorTotal:Number(ee.xml.valorTotal)||0,vinculadoManualmente:!!Le&&Le!=="force-new"}});await fot(r.id,se),console.log("[XMLReprocess] Itens reprocessados:",se.length)}catch(se){console.error("[XMLReprocess] Erro ao reprocessar itens da compra:",se),Z.errors++,Z.details.push({produto:"Itens da NF-e",acao:"Erro ao reprocessar",status:"error",error:se.message})}w(Z),x(!1),d("done"),Z.errors===0?l({title:"Reprocessamento concludo!",description:`${Z.created} produto(s) criado(s), ${Z.updated} atualizado(s).`,variant:"success"}):l({title:"Reprocessamento com erros",description:`${Z.errors} erro(s) encontrado(s). Verifique os detalhes.`,variant:"destructive"}),s&&s()};p.useEffect(()=>{e||(d("upload"),f(null),m(null),g([]),_({}),E({}),w({created:0,updated:0,errors:0,details:[]}),x(!1),P({}))},[e]);const ue=()=>{t(!1)},Ne=v.filter(Z=>Z.selected).length;return a.jsxs(xn,{open:e,onOpenChange:ue,children:[a.jsxs(vn,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] overflow-hidden flex flex-col",children:[a.jsxs(pn,{children:[a.jsxs(fn,{className:"flex items-center gap-2",children:[a.jsx(Rp,{className:"h-5 w-5"}),a.jsx("span",{children:"Reprocessar XML"}),a.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:D()}),a.jsx("span",{className:"text-sm text-text-muted",children:r?.numero_nfe})]}),a.jsx(On,{children:"Reimporte o XML para atualizar os produtos e itens desta NF-e. Os itens atuais sero substitudos pelos novos."})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[c==="upload"&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-8 text-center",children:[a.jsx(f4,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selecione o arquivo XML"}),a.jsxs("p",{className:"text-text-muted mb-4",children:["Faa upload do XML da NF-e ",r?.numero_nfe," para reprocessar os produtos"]}),a.jsx("input",{type:"file",accept:".xml",onChange:V,className:"hidden",id:"xml-reprocess-upload"}),a.jsx("label",{htmlFor:"xml-reprocess-upload",children:a.jsx(ce,{asChild:!0,children:a.jsx("span",{children:"Selecionar XML"})})})]})}),c==="preview"&&h&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Informaes da NF-e"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",h.nfe.numero]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",h.nfe.serie]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Modelo:"})," ",D()]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",h.fornecedor?.nome]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Total:"})," R$ ",Number(h.nfe.totalNota||0).toFixed(2)]})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-semibold text-base",children:"Produtos Encontrados"}),a.jsxs("span",{className:"text-sm text-text-muted",children:[v.filter(Z=>Z.selected).length," de ",v.length," selecionados"]})]}),a.jsx("div",{className:"space-y-2",children:v.map((Z,ge)=>{const le=U(ge,"name",Z.xml.nome),se=U(ge,"qty",Number(Z.xml.quantidade)),ee=U(ge,"linkedProductId",null),de=Z.xml.valorUnitario||0,Le=U(ge,"margin",null);let ie=U(ge,"salePrice",null);ie==null&&!Z.isNew&&Z.existing&&(ie=Number(Z.existing.preco_venda||Z.existing.salePrice||Z.existing.price||0)),ie==null&&Le!=null&&(ie=z(de,Le)),ie==null&&Z.xml.precoVenda&&(ie=Number(Z.xml.precoVenda));let dt=null;if(Le!=null)dt=Le;else if(ie!=null&&de>0&&ie>0){const st=(ie-de)/de*100;dt=Math.max(-999,Math.min(9999,st))}const At=C[ge];return a.jsxs("div",{className:mr("rounded-lg border transition-all",Z.selected?"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[a.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("input",{type:"checkbox",checked:Z.selected,onChange:()=>Q(ge),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),a.jsx("button",{onClick:()=>H(ge),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:At?a.jsx(i0,{className:"w-4 h-4 text-text-muted"}):a.jsx(l0,{className:"w-4 h-4 text-text-muted"})}),a.jsx("div",{children:ee?a.jsx(qH,{className:"w-5 h-5 text-warning"}):a.jsx(Rp,{className:"w-5 h-5 text-info"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm truncate",children:ee&&ee!=="force-new"&&ee!=="new"?(()=>{const st=n.find(ut=>ut.id===ee);return st?st.name:le})():le}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[Z.xml.codigo&&a.jsxs("span",{className:"flex-shrink-0",children:["#",Z.xml.codigo]}),a.jsxs("span",{children:["Qtd: ",se]})]})]}),a.jsx("div",{className:"flex-shrink-0 ml-2",children:ee?a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-warning/20 text-warning font-medium",children:"Vinculado"}):a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),a.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[a.jsxs("span",{children:["R$ ",de.toFixed(2),ie?`  R$ ${ie.toFixed(2)}`:""]}),dt!=null&&a.jsxs("span",{className:"ml-2 "+(dt>0?"text-success":dt<0?"text-destructive":"text-text-muted"),children:[dt.toFixed(1),"%"]})]})]})]}),At&&a.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),a.jsx("input",{type:"text",value:le,onChange:st=>q(ge,"name",st.target.value),disabled:!Z.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{type:"button",onClick:()=>q(ge,"qty",Math.max(0,se-1)),disabled:!Z.selected||se<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:a.jsx(Ev,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",value:se,onChange:st=>{const ut=st.target.value.replace(/\D/g,"");q(ge,"qty",ut===""?0:Number(ut))},disabled:!Z.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),a.jsx("button",{type:"button",onClick:()=>q(ge,"qty",se+1),disabled:!Z.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:a.jsx(ro,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:(()=>{const st=U(ge,"margin",null);return st!=null?String(st):""})(),onChange:st=>{const ut=st.target.value;if(ut===""){q(ge,"margin",null),q(ge,"salePrice",null);return}const Rt=ut.replace(/[^0-9.,\-]/g,"").replace(",",".");if(Rt==="."||Rt==="-"||Rt==="-.")return;const Nt=parseFloat(Rt);if(!isNaN(Nt)&&(q(ge,"margin",Nt),de>0)){const tt=z(de,Nt);q(ge,"salePrice",tt)}},disabled:!Z.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),a.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),a.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:a.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",de.toFixed(2)]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),a.jsx("input",{type:"text",value:(()=>{const st=U(ge,"salePrice",ie);return st==null?"":Number(st).toFixed(2).replace(".",",")})(),onChange:st=>{const ut=st.target.value.replace(/\D/g,"");if(ut===""){q(ge,"salePrice",null);return}const Rt=Number(ut)/100;if(q(ge,"salePrice",Rt),Rt>0&&de>0){const Nt=(Rt-de)/de*100;q(ge,"margin",Math.round(Nt*100)/100)}},disabled:!Z.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[a.jsx("input",{type:"checkbox",id:`update-price-${ge}`,checked:U(ge,"updatePrice",!1),onChange:st=>q(ge,"updatePrice",st.target.checked),disabled:!Z.selected,className:"w-4 h-4 text-brand bg-surface border-border rounded focus:ring-brand focus:ring-2 disabled:opacity-50"}),a.jsx("label",{htmlFor:`update-price-${ge}`,className:"text-sm text-text-primary select-none cursor-pointer",children:"Atualizar preo do produto no sistema"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Vincular a Produto Existente (Opcional)"}),a.jsxs(Cn,{value:ee==="force-new"?"force-new":ee||(Z.isNew?"new":Z.existing?.id||"new"),onValueChange:st=>{st==="new"||st===Z.existing?.id?pe(ge,null):st==="search"?M({isOpen:!0,productIndex:ge,currentProduct:Z}):pe(ge,st)},disabled:!Z.selected,children:[a.jsx(jn,{className:"w-full hover:bg-white/5 transition-colors",children:a.jsx(An,{placeholder:Z.isNew?" Criar como novo produto":" Atualizar produto existente"})}),a.jsxs(_n,{className:"max-h-[300px] overflow-y-auto",children:[Z.isNew?a.jsx(nt,{value:"new",children:" Criar como novo produto"}):a.jsxs(nt,{value:Z.existing?.id||"new",children:[" Atualizar: ",Z.existing?.name," (Estoque atual: ",Z.existing?.stock||0,")"]}),!Z.isNew&&a.jsx(nt,{value:"force-new",children:" Criar como novo produto (ignorar existente)"}),a.jsx(nt,{value:"search",children:" Buscar produto para vincular..."})]})]})]})]})]},ge)})})]})]}),c==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(zm,{className:"h-12 w-12 animate-spin text-brand mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Reprocessando XML..."}),a.jsx("p",{className:"text-text-muted",children:"Atualizando produtos e itens da NF-e"})]}),c==="done"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center py-6",children:[b.errors===0?a.jsx(Ds,{className:"h-12 w-12 text-success mx-auto mb-4"}):a.jsx(Ac,{className:"h-12 w-12 text-warning mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:b.errors===0?"Reprocessamento Concludo!":"Reprocessamento com Erros"}),a.jsxs("div",{className:"text-text-muted",children:[b.created," produto(s) criado(s), ",b.updated," atualizado(s)",b.errors>0&&`, ${b.errors} erro(s)`]})]}),b.details.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-3",children:"Detalhes do Reprocessamento"}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:b.details.map((Z,ge)=>a.jsxs("div",{className:mr("flex items-center gap-3 p-2 rounded",Z.status==="success"?"bg-green-50 text-green-800":Z.status==="error"?"bg-red-50 text-red-800":"bg-gray-50 text-gray-800"),children:[Z.status==="success"?a.jsx(Ds,{className:"h-4 w-4 flex-shrink-0"}):a.jsx(Ac,{className:"h-4 w-4 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:Z.produto}),a.jsx("div",{className:"text-xs",children:Z.acao}),Z.error&&a.jsx("div",{className:"text-xs mt-1 opacity-75",children:Z.error})]})]},ge))})]})]})]}),a.jsxs(ra,{children:[c==="upload"&&a.jsx(ce,{variant:"outline",onClick:ue,children:"Cancelar"}),c==="preview"&&a.jsxs(a.Fragment,{children:[a.jsx(ce,{variant:"outline",onClick:()=>d("upload"),children:"Voltar"}),a.jsxs(ce,{onClick:B,disabled:Ne===0,children:["Reprocessar (",Ne," produtos)"]})]}),c==="done"&&a.jsx(ce,{onClick:ue,children:"Fechar"})]})]}),a.jsx(Ooe,{isOpen:F.isOpen,onClose:()=>M({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:Z=>{console.log("[XMLReprocessModal] onSelect chamado com produto:",Z),console.log("[XMLReprocessModal] Index do produto:",F.productIndex),pe(F.productIndex,Z.id),M({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:F.currentProduct}),a.jsx(Toe,{isOpen:I.isOpen,onClose:()=>R({isOpen:!1}),onConfirm:J,products:v.map((Z,ge)=>({...Z,originalIndex:ge})),editedProducts:j,allProducts:n,isReprocess:!0})]})}const DU="comprasPage:settings";function Sot(){const{user:e,userProfile:t}=So(),[r,n]=p.useState([]),[o,s]=p.useState(!0),[i,l]=p.useState(""),[c,d]=p.useState(null),[u,f]=p.useState([]),[h,m]=p.useState(!1),[v,g]=p.useState(()=>bl(new Date)),[y,x]=p.useState(()=>yC(new Date)),[b,w]=p.useState("all"),[j,_]=p.useState(!0),[C,E]=p.useState(!1),[A,P]=p.useState("active"),[F,M]=p.useState({show:!1,purchase:null}),[I,R]=p.useState(""),[D,U]=p.useState({show:!1,purchase:null}),[z,H]=p.useState({}),[q,Q]=p.useState({show:!1,purchase:null}),[pe,be]=p.useState([]),[V,B]=p.useState(!1),[J,ue]=p.useState(!1),[Ne,Z]=p.useState("paged"),ge=Ne==="paged",[le,se]=p.useState(1),[ee]=p.useState(100),[de,Le]=p.useState(0),ae=we=>{const He=String(we||"").replace(/\D/g,"");return(He?Number(He)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},ie=we=>{if(!we.xml_completo){alert("XML no disponvel para esta NF-e");return}const He=new Blob([we.xml_completo],{type:"text/xml;charset=utf-8"}),ht=URL.createObjectURL(He),zt=document.createElement("a");zt.href=ht,zt.download=`${we.chave_nfe}.xml`,document.body.appendChild(zt),zt.click(),document.body.removeChild(zt),URL.revokeObjectURL(ht)},dt=async we=>{if(!we.xml_completo){alert("XML no disponvel para reprocessamento automtico");return}if(confirm("Deseja reprocessar esta NF-e? Isso substituir todos os itens atuais pelos dados do XML original."))try{console.log("[ComprasPage] Iniciando reprocessamento para purchase:",we),console.log("[ComprasPage] Chave NF-e:",we.chave_nfe),console.log("[ComprasPage] XML disponvel:",!!we.xml_completo);const He=new Blob([we.xml_completo],{type:"text/xml"}),ht=new File([He],`${we.chave_nfe}.xml`,{type:"text/xml"});Q({show:!0,purchase:we,autoFile:ht})}catch(He){console.error("Erro no reprocessamento automtico:",He),alert("Erro ao iniciar reprocessamento automtico")}},At=we=>{if(!we)return 0;const He=String(we).replace(/\./g,"").replace(",",".");return parseFloat(He)||0};p.useEffect(()=>{try{const we=localStorage.getItem(DU);if(!we)return;const He=JSON.parse(we);He&&typeof He=="object"&&((He.listMode==="paged"||He.listMode==="all")&&Z(He.listMode),typeof He.showStats=="boolean"&&_(He.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!e?.id||!t?.codigo_empresa)return;const He=`compras:${t.codigo_empresa}`,ht=await Aoe({userId:e.id,scope:He});ht&&((ht.listMode==="paged"||ht.listMode==="all")&&Z(ht.listMode),typeof ht.showStats=="boolean"&&_(ht.showStats))})()},[e?.id,t?.codigo_empresa]),p.useEffect(()=>{try{const we={listMode:Ne,showStats:j};localStorage.setItem(DU,JSON.stringify(we))}catch{}if(e?.id&&t?.codigo_empresa){const we=`compras:${t.codigo_empresa}`;Eoe({userId:e.id,scope:we,settings:{listMode:Ne,showStats:j}})}},[Ne,j,e?.id,t?.codigo_empresa]),p.useEffect(()=>{t?.codigo_empresa&&(ut(),st())},[t,A,b,v,y,le,Ne]),p.useEffect(()=>{se(1)},[A,b,v,y,Ne]);const st=async()=>{try{const we=await fu({codigoEmpresa:t.codigo_empresa});be(we||[])}catch(we){console.error("[Compras] Erro ao carregar produtos:",we)}},ut=async()=>{try{s(!0);let we=null,He=null;if(v){const Qt=new Date(v);Qt.setHours(0,0,0,0),we=Qt.toISOString()}if(y){const Qt=new Date(y);Qt.setHours(23,59,59,999),He=Qt.toISOString()}const hr={incluirInativas:A==="all"||A==="inactive",apenasInativas:A==="inactive",fornecedorId:b!=="all"?b:void 0,dataInicio:we,dataFim:He,page:ge?le:1,pageSize:ge?ee:1e4},Mt=await cot(t.codigo_empresa,hr);n(Mt?.data||[]),Le(Mt?.count||0)}catch(we){console.error("[Compras] Erro ao carregar compras:",we)}finally{s(!1)}},Rt=async we=>{d(we),m(!0);try{const He=await Ioe(we.id);f(He||[])}catch(He){console.error("[Compras] Erro ao carregar itens:",He),f([])}finally{m(!1)}},Nt=()=>{d(null),f([])},tt=we=>{U({show:!0,purchase:we}),H({numeroNfe:we.numero_nfe||"",serieNfe:we.serie_nfe||"",dataEmissao:we.data_emissao?we.data_emissao.split("T")[0]:"",tipoOperacao:we.tipo_operacao||"",naturezaOperacao:we.natureza_operacao||"",valorProdutos:ae((we.valor_produtos||0)*100),valorTotal:ae((we.valor_total||0)*100),formaPagamento:we.forma_pagamento||"",observacoes:we.observacoes||""})},he=async()=>{try{await mot(D.purchase.id,{...z,valorProdutos:At(z.valorProdutos),valorTotal:At(z.valorTotal),fornecedorId:D.purchase.fornecedor_id}),await ut(),U({show:!1,purchase:null}),H({}),console.log("Compra editada com sucesso!")}catch(we){console.error("Erro ao editar compra:",we)}},ke=p.useMemo(()=>{const we=new Map;return r.forEach(He=>{He.fornecedor?.id&&we.set(He.fornecedor.id,He.fornecedor)}),Array.from(we.values())},[r]),et=p.useMemo(()=>r.filter(we=>{if(i){const He=i.toLowerCase();if(!(we.numero_nfe?.toLowerCase().includes(He)||we.fornecedor?.nome?.toLowerCase().includes(He)||we.chave_nfe?.toLowerCase().includes(He)))return!1}return!0}),[r,i]),Me=p.useMemo(()=>{const we=et.reduce((Mt,Qt)=>Mt+Number(Qt.valor_total||0),0),He=et.length,ht=He>0?we/He:0,zt={};et.forEach(Mt=>{const Qt=Mt.fornecedor?.id||"unknown",Se=Mt.fornecedor?.nome||"No identificado";zt[Qt]||(zt[Qt]={name:Se,total:0,count:0}),zt[Qt].total+=Number(Mt.valor_total||0),zt[Qt].count+=1});const hr=Object.values(zt).sort((Mt,Qt)=>Qt.total-Mt.total).slice(0,5);return{total:we,count:He,avgTicket:ht,topSuppliers:hr}},[et]),$e=p.useMemo(()=>{if(!ee)return 1;const we=Math.ceil((de||0)/ee);return we>0?we:1},[de,ee]),Be=()=>{const we=["NF-e","Serie","Data Emissao","Fornecedor","CNPJ","Tipo","Valor Total","Valor Produtos","Forma Pagamento"],He=et.map(Mt=>[Mt.numero_nfe||"",Mt.serie_nfe||"",Mt.data_emissao?dr(new Date(Mt.data_emissao),"dd/MM/yyyy"):"",(Mt.fornecedor?.nome||"").replace(/,/g," "),Mt.fornecedor?.cnpj||"",Mt.tipo_operacao||"",Number(Mt.valor_total||0).toFixed(2),Number(Mt.valor_produtos||0).toFixed(2),(Mt.forma_pagamento||"").replace(/,/g," ")]),ht=[we,...He].map(Mt=>Mt.join(";")).join(`
`),zt=new Blob(["\uFEFF"+ht],{type:"text/csv;charset=utf-8;"}),hr=document.createElement("a");hr.href=URL.createObjectURL(zt),hr.download=`compras_${dr(new Date,"yyyy-MM-dd")}.csv`,hr.click()};return a.jsxs("div",{className:"px-3 py-4 md:p-6 max-w-7xl mx-auto",children:[a.jsx("div",{className:"mb-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3 md:gap-4 mb-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:"Compras (NF-e)"}),a.jsx(ce,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>ue(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:a.jsx(Of,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex flex-row flex-wrap items-end gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-[140px]",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Inicial"}),a.jsxs(Oc,{modal:!0,children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[a.jsx(Ns,{className:"mr-2 h-4 w-4"}),v?dr(v,"dd/MM/yyyy"):a.jsx("span",{children:"Selecionar"})]})}),a.jsx(Hl,{className:"w-auto p-0 z-50",align:"end",children:a.jsx(Gl,{mode:"single",selected:v,onSelect:g,locale:wa})})]})]}),a.jsxs("div",{className:"flex-1 min-w-[140px]",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Final"}),a.jsxs(Oc,{modal:!0,children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[a.jsx(Ns,{className:"mr-2 h-4 w-4"}),y?dr(y,"dd/MM/yyyy"):a.jsx("span",{children:"Selecionar"})]})}),a.jsx(Hl,{className:"w-auto p-0 z-50",align:"end",children:a.jsx(Gl,{mode:"single",selected:y,onSelect:x,locale:wa})})]})]}),(v||y)&&a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>{g(null),x(null)},className:"h-8 px-3 text-xs",children:"Limpar"})]})]})}),j&&et.length>0&&a.jsxs("div",{className:"mb-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[a.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[a.jsx(Gs,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"NF-es"})]}),a.jsx("p",{className:"text-lg md:text-2xl font-bold text-text-primary leading-none",children:Me.count})]}),a.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[a.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[a.jsx(Ks,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Total"})]}),a.jsxs("p",{className:"text-base md:text-2xl font-bold text-success leading-none whitespace-nowrap",children:["R$ ",Me.total.toFixed(2)]})]}),a.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[a.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[a.jsx(Ou,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Fornec."})]}),a.jsx("p",{className:"text-lg md:text-2xl font-bold text-info leading-none",children:ke.length})]})]}),Me.topSuppliers.length>0&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(BP,{className:"h-4 w-4"}),"Top 5 Fornecedores"]}),a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>E(!0),className:"text-xs",children:"Ver Todos"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Me.topSuppliers.map((we,He)=>{const ht=we.total/Me.total*100;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsx("span",{className:"text-text-primary font-medium truncate flex-1",title:we.name,children:we.name}),a.jsxs("span",{className:"text-text-muted text-xs ml-2 flex-shrink-0",children:["R$ ",we.total.toFixed(2)]})]}),a.jsx("div",{className:"w-full bg-surface-2 rounded-full h-1.5",children:a.jsx("div",{className:"bg-brand rounded-full h-1.5 transition-all",style:{width:`${ht}%`}})})]},He)})})]})]}),a.jsx("div",{className:"mb-6 space-y-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-4 md:flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2 w-full md:flex-1 md:min-w-[250px]",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar por NF-e, fornecedor ou chave...",value:i,onChange:we=>l(we.target.value),className:"pl-10"})]}),a.jsx(ce,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>B(we=>!we),"aria-label":"Filtros",children:a.jsx(Zk,{className:"h-4 w-4"})})]}),V&&a.jsxs("div",{className:"md:hidden mt-1 space-y-3 px-0.5",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Fornecedor"}),a.jsxs(Cn,{value:b,onValueChange:w,children:[a.jsxs(jn,{className:"w-full text-sm",children:[a.jsx(Ou,{className:"h-4 w-4 mr-2 flex-shrink-0"}),a.jsx("div",{className:"truncate",children:a.jsx(An,{placeholder:"Todos"})})]}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Todos"}),ke.map(we=>a.jsx(nt,{value:we.id,children:a.jsx("div",{className:"truncate max-w-[220px]",title:we.nome,children:we.nome})},we.id))]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Status"}),a.jsxs(Cn,{value:A,onValueChange:P,children:[a.jsx(jn,{className:"w-full text-sm",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"active",children:"Apenas ativas"}),a.jsx(nt,{value:"all",children:"Todas"}),a.jsx(nt,{value:"inactive",children:"Apenas inativas"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1 border-t border-border/60",children:[a.jsxs(ce,{type:"button",variant:"ghost",size:"sm",className:"gap-2 text-xs px-2",onClick:()=>_(!j),children:[a.jsx(BP,{className:"h-4 w-4"}),j?"Ocultar estatsticas":"Mostrar estatsticas"]}),a.jsxs(ce,{type:"button",variant:"outline",size:"sm",onClick:Be,disabled:et.length===0,className:"gap-1 text-xs px-3",children:[a.jsx(ms,{className:"h-4 w-4"}),"CSV"]})]})]}),a.jsxs("div",{className:"hidden md:flex md:items-center md:gap-4 md:flex-wrap w-full",children:[a.jsxs(Cn,{value:b,onValueChange:w,children:[a.jsxs(jn,{className:"w-full md:w-[220px]",children:[a.jsx(Ou,{className:"h-4 w-4 mr-2 flex-shrink-0"}),a.jsx("div",{className:"truncate",children:a.jsx(An,{placeholder:"Fornecedor"})})]}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Todos"}),ke.map(we=>a.jsx(nt,{value:we.id,children:a.jsx("div",{className:"truncate max-w-[180px]",title:we.nome,children:we.nome})},we.id))]})]}),a.jsxs(ce,{variant:"outline",onClick:Be,disabled:et.length===0,className:"gap-2 w-full sm:w-auto justify-center",children:[a.jsx(ms,{className:"h-4 w-4"}),"Exportar CSV"]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>_(!j),className:"gap-2",children:[a.jsx(BP,{className:"h-4 w-4"}),j?"Ocultar":"Mostrar"]}),a.jsxs(Cn,{value:A,onValueChange:P,children:[a.jsx(jn,{className:"w-[140px]",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"active",children:"Apenas ativas"}),a.jsx(nt,{value:"all",children:"Todas"}),a.jsx(nt,{value:"inactive",children:"Apenas inativas"})]})]})]})]})]})}),o?a.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-border",children:[a.jsx(_d,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),a.jsx("p",{className:"text-text-muted",children:i?"Nenhuma compra encontrada":"Nenhuma NF-e importada ainda"}),a.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Importe XMLs de NF-e na pgina de Produtos"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid gap-3",children:et.map(we=>a.jsx("div",{className:`rounded-lg border overflow-hidden transition-all hover:shadow-lg ${we.ativo===!1?"bg-gray-900/60 border-red-500 shadow-red-500/20":"bg-surface border-border hover:border-brand/50"}`,onClick:()=>Rt(we),children:a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",children:a.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx(Gs,{className:"h-6 w-6 text-brand mt-0.5 flex-shrink-0"}),a.jsx("div",{className:"min-w-0",children:a.jsxs("h3",{className:`font-semibold text-sm md:text-base leading-snug ${we.ativo===!1?"text-red-600":"text-text-primary"}`,children:["NF-e ",we.numero_nfe," / Srie ",we.serie_nfe,we.ativo===!1&&a.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 bg-red-100 text-red-700 text-[10px] rounded-full font-medium align-middle",children:"INATIVA"})]})})]}),a.jsx("div",{className:"sm:hidden flex items-center",children:a.jsxs("span",{className:"text-success font-semibold text-xs whitespace-nowrap pr-2",children:["R$ ",Number(we.valor_total||0).toFixed(2)]})})]}),a.jsxs("div",{className:"space-y-2.5",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx(Ou,{className:"h-5 w-5 flex-shrink-0 text-brand"}),a.jsx("span",{className:"font-medium text-text-primary text-sm md:text-base overflow-hidden truncate",title:we.fornecedor?.nome||"Fornecedor no identificado",children:we.fornecedor?.nome||"Fornecedor no identificado"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1.5 text-xs md:text-sm text-text-muted",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ns,{className:"h-4 w-4"}),a.jsx("span",{children:we.data_emissao?dr(new Date(we.data_emissao),"dd/MM/yyyy",{locale:wa}):"Data no informada"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(_d,{className:"h-4 w-4"}),a.jsx("span",{children:we.tipo_operacao||"Entrada"})]}),we.chave_nfe&&a.jsxs("div",{className:"text-[10px] md:text-xs max-w-[180px] md:max-w-xs overflow-hidden whitespace-nowrap truncate",children:[a.jsx("span",{className:"font-medium",children:"Chave:"})," ",we.chave_nfe.length>20?we.chave_nfe.slice(0,20)+"...":we.chave_nfe]})]}),we.natureza_operacao&&a.jsx("p",{className:"text-[10px] md:text-xs text-text-muted overflow-hidden whitespace-nowrap truncate",title:we.natureza_operacao,children:we.natureza_operacao})]})]}),a.jsxs("div",{className:"hidden sm:flex sm:flex-col sm:gap-3 sm:mt-0 sm:w-auto",children:[a.jsx("div",{className:"w-full flex justify-end",children:a.jsxs("div",{className:"text-right text-text-muted",children:[a.jsxs("span",{className:"text-success font-semibold text-base md:text-lg whitespace-nowrap",children:["R$ ",Number(we.valor_total||0).toFixed(2)]}),a.jsxs("p",{className:"text-[11px] md:text-xs mt-0.5",children:["Produtos: R$ ",Number(we.valor_produtos||0).toFixed(2)]})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full justify-end",children:[a.jsxs(ce,{onClick:He=>{He.stopPropagation(),Rt(we)},size:"sm",className:"gap-2 w-full justify-center",children:[a.jsx(Qp,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs sm:text-sm",children:"Detalhes"})]}),we.ativo&&a.jsxs(ce,{onClick:He=>{He.stopPropagation(),tt(we)},size:"sm",variant:"outline",className:"gap-2 w-full justify-center",children:[a.jsx(fl,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs sm:text-sm",children:"Editar"})]})]})]})]})})})},we.id))}),ge&&a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted",children:[a.jsxs("span",{children:["Pgina ",le," de ",$e," (",de," NF-es)"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ce,{type:"button",variant:"outline",size:"sm",onClick:()=>se(we=>Math.max(1,we-1)),disabled:le<=1,children:"Anterior"}),a.jsx(ce,{type:"button",variant:"outline",size:"sm",onClick:()=>se(we=>Math.min($e,we+1)),disabled:le>=$e,children:"Prxima"})]})]})]}),a.jsx(xn,{open:J,onOpenChange:ue,children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-md max-h-[80vh] flex flex-col",children:[a.jsx(pn,{children:a.jsx(fn,{children:"Configuraes de Compras"})}),a.jsxs("div",{className:"space-y-4 text-sm",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Modo de listagem"}),a.jsxs(Cn,{value:Ne,onValueChange:Z,children:[a.jsx(jn,{className:"w-full h-9 text-sm",children:a.jsx(An,{placeholder:"Paginado"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"paged",children:"Paginado (100 por pgina)"}),a.jsx(nt,{value:"all",children:"Todos (sem paginao)"})]})]})]}),a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"compras-show-stats",checked:j,onCheckedChange:_}),a.jsx("label",{htmlFor:"compras-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de estatsticas"})]})})]})]})}),a.jsx(xn,{open:F.show,onOpenChange:we=>M({show:we,purchase:null}),children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-md",children:[a.jsx(pn,{children:a.jsx(fn,{children:"Inativar NF-e"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-text-muted",children:["Tem certeza que deseja inativar a NF-e ",a.jsx("strong",{children:F.purchase?.numero_nfe}),"?"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Motivo da inativao:"}),a.jsx(Je,{value:I,onChange:we=>R(we.target.value),placeholder:"Ex: NF-e duplicada, erro na importao...",className:"w-full"})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(ce,{variant:"outline",onClick:()=>{M({show:!1,purchase:null}),R("")},children:"Cancelar"}),a.jsx(ce,{variant:"destructive",onClick:async()=>{if(!I.trim()){alert("Por favor, informe o motivo da inativao");return}try{await dot(F.purchase.id,I.trim(),t.id),M({show:!1,purchase:null}),R(""),ut()}catch(we){console.error("Erro ao inativar compra:",we),alert("Erro ao inativar NF-e. Tente novamente.")}},disabled:!I.trim(),children:"Inativar"})]})]})]})}),c&&a.jsx(_ot,{purchase:c,items:h?[]:u,onClose:Nt,onEdit:tt,onReprocess:dt,onDownloadXML:ie,onInactivate:we=>M({show:!0,purchase:we})}),a.jsx(xn,{open:C,onOpenChange:E,children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[a.jsx(pn,{children:a.jsx(fn,{children:"Todos os Fornecedores"})}),a.jsx("div",{className:"px-6 py-3 bg-surface-2 border-y border-border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-muted",children:"Valor Total Geral"}),a.jsxs("span",{className:"text-2xl font-bold text-success",children:["R$ ",Me.total.toFixed(2)]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsx("div",{className:"space-y-3 pr-2",children:Object.entries(et.reduce((we,He)=>{const ht=He.fornecedor?.id||"unknown",zt=He.fornecedor?.nome||"No identificado";return we[ht]||(we[ht]={name:zt,total:0,count:0}),we[ht].total+=Number(He.valor_total||0),we[ht].count+=1,we},{})).sort(([,we],[,He])=>He.total-we.total).map(([we,He],ht)=>{const zt=He.total/Me.total*100;return a.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center",children:ht+1}),a.jsx("span",{className:"font-medium text-text-primary",children:He.name})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-success",children:["R$ ",He.total.toFixed(2)]}),a.jsxs("p",{className:"text-xs text-text-muted",children:[He.count," NF-es"]})]})]}),a.jsx("div",{className:"w-full bg-surface rounded-full h-2",children:a.jsx("div",{className:"bg-brand rounded-full h-2 transition-all",style:{width:`${zt}%`}})})]},we)})})})]})}),a.jsx(xn,{open:D.show,onOpenChange:we=>U({show:we,purchase:null}),children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] flex flex-col",onOpenAutoFocus:we=>we.preventDefault(),children:[a.jsx(pn,{children:a.jsx(fn,{children:"Editar NF-e"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Nmero NF-e"}),a.jsx(Je,{value:z.numeroNfe||"",onChange:we=>H(He=>({...He,numeroNfe:we.target.value})),placeholder:"Nmero da NF-e"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Srie"}),a.jsx(Je,{value:z.serieNfe||"",onChange:we=>H(He=>({...He,serieNfe:we.target.value})),placeholder:"Srie"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Data de Emisso"}),a.jsx(Je,{type:"date",value:z.dataEmissao||"",onChange:we=>H(He=>({...He,dataEmissao:we.target.value}))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Tipo de Operao"}),a.jsxs(Cn,{value:z.tipoOperacao||"",onValueChange:we=>H(He=>({...He,tipoOperacao:we})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione o tipo"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"Entrada",children:"0 - Entrada"}),a.jsx(nt,{value:"Sada",children:"1 - Sada"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Natureza da Operao"}),a.jsxs(Cn,{value:z.naturezaOperacao||"",onValueChange:we=>H(He=>({...He,naturezaOperacao:we})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione a natureza"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"Compra para comercializao",children:"Compra para comercializao"}),a.jsx(nt,{value:"Compra para industrializao",children:"Compra para industrializao"}),a.jsx(nt,{value:"Compra para uso ou consumo",children:"Compra para uso ou consumo"}),a.jsx(nt,{value:"Compra de ativo imobilizado",children:"Compra de ativo imobilizado"}),a.jsx(nt,{value:"Compra de material para uso ou consumo",children:"Compra de material para uso ou consumo"}),a.jsx(nt,{value:"Devoluo de venda de produo do estabelecimento",children:"Devoluo de venda de produo do estabelecimento"}),a.jsx(nt,{value:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros",children:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros"}),a.jsx(nt,{value:"Remessa de mercadoria por conta e ordem de terceiros",children:"Remessa de mercadoria por conta e ordem de terceiros"}),a.jsx(nt,{value:"Retorno de mercadoria remetida por conta e ordem de terceiros",children:"Retorno de mercadoria remetida por conta e ordem de terceiros"}),a.jsx(nt,{value:"Remessa para industrializao por encomenda",children:"Remessa para industrializao por encomenda"}),a.jsx(nt,{value:"Retorno de mercadoria remetida para industrializao por encomenda",children:"Retorno de mercadoria remetida para industrializao por encomenda"}),a.jsx(nt,{value:"Transferncia de produo do estabelecimento",children:"Transferncia de produo do estabelecimento"}),a.jsx(nt,{value:"Transferncia de mercadoria adquirida ou recebida de terceiros",children:"Transferncia de mercadoria adquirida ou recebida de terceiros"})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Valor dos Produtos"}),a.jsx(Je,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${z.valorProdutos||"0,00"}`,onChange:we=>H(He=>({...He,valorProdutos:ae(we.target.value)}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Valor Total"}),a.jsx(Je,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${z.valorTotal||"0,00"}`,onChange:we=>H(He=>({...He,valorTotal:ae(we.target.value)}))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Forma de Pagamento"}),a.jsxs(Cn,{value:z.formaPagamento||"",onValueChange:we=>H(He=>({...He,formaPagamento:we})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione a forma de pagamento"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"01 - Dinheiro",children:"01 - Dinheiro"}),a.jsx(nt,{value:"02 - Cheque",children:"02 - Cheque"}),a.jsx(nt,{value:"03 - Carto de Crdito",children:"03 - Carto de Crdito"}),a.jsx(nt,{value:"04 - Carto de Dbito",children:"04 - Carto de Dbito"}),a.jsx(nt,{value:"05 - Carto da Loja (Private Label)",children:"05 - Carto da Loja (Private Label)"}),a.jsx(nt,{value:"10 - Vale Alimentao",children:"10 - Vale Alimentao"}),a.jsx(nt,{value:"11 - Vale Refeio",children:"11 - Vale Refeio"}),a.jsx(nt,{value:"12 - Vale Presente",children:"12 - Vale Presente"}),a.jsx(nt,{value:"13 - Vale Combustvel",children:"13 - Vale Combustvel"}),a.jsx(nt,{value:"14 - Duplicata Mercantil",children:"14 - Duplicata Mercantil"}),a.jsx(nt,{value:"15 - Boleto Bancrio",children:"15 - Boleto Bancrio"}),a.jsx(nt,{value:"16 - Depsito Bancrio",children:"16 - Depsito Bancrio"}),a.jsx(nt,{value:"17 - PIX Dinmico (QR-Code)",children:"17 - PIX Dinmico (QR-Code)"}),a.jsx(nt,{value:"18 - Transferncia Bancria / Carteira Digital",children:"18 - Transferncia Bancria / Carteira Digital"}),a.jsx(nt,{value:"19 - Programa de Fidelidade / Cashback",children:"19 - Programa de Fidelidade / Cashback"}),a.jsx(nt,{value:"20 - PIX Esttico",children:"20 - PIX Esttico"}),a.jsx(nt,{value:"21 - Crdito em Loja",children:"21 - Crdito em Loja"}),a.jsx(nt,{value:"22 - Pagamento Eletrnico no Informado",children:"22 - Pagamento Eletrnico no Informado"}),a.jsx(nt,{value:"90 - Sem Pagamento",children:"90 - Sem Pagamento"}),a.jsx(nt,{value:"99 - Outros",children:"99 - Outros"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Observaes"}),a.jsx(Je,{value:z.observacoes||"",onChange:we=>H(He=>({...He,observacoes:we.target.value})),placeholder:"Observaes adicionais"})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(ce,{variant:"outline",onClick:()=>U({show:!1,purchase:null}),children:"Cancelar"}),a.jsx(ce,{onClick:he,children:"Salvar Alteraes"})]})]})]})}),a.jsx(Not,{open:q.show,onOpenChange:we=>Q({show:we,purchase:null}),purchase:q.purchase,products:pe,codigoEmpresa:t?.codigo_empresa,autoFile:q.autoFile,onSuccess:()=>{ut(),Q({show:!1,purchase:null})}})]})}const ol=_e.forwardRef(({className:e,...t},r)=>a.jsx("div",{className:"relative w-full overflow-auto",children:a.jsx("table",{ref:r,className:mr("w-full caption-bottom text-sm",e),...t})}));ol.displayName="Table";const sl=_e.forwardRef(({className:e,...t},r)=>a.jsx("thead",{ref:r,className:mr("[&_tr]:border-b",e),...t}));sl.displayName="TableHeader";const il=_e.forwardRef(({className:e,...t},r)=>a.jsx("tbody",{ref:r,className:mr("[&_tr:last-child]:border-0",e),...t}));il.displayName="TableBody";const Cot=_e.forwardRef(({className:e,...t},r)=>a.jsx("tfoot",{ref:r,className:mr("bg-primary font-medium text-primary-foreground",e),...t}));Cot.displayName="TableFooter";const Wa=_e.forwardRef(({className:e,...t},r)=>a.jsx("tr",{ref:r,className:mr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Wa.displayName="TableRow";const qn=_e.forwardRef(({className:e,...t},r)=>a.jsx("th",{ref:r,className:mr("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));qn.displayName="TableHead";const Sn=_e.forwardRef(({className:e,...t},r)=>a.jsx("td",{ref:r,className:mr("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Sn.displayName="TableCell";const Pot=_e.forwardRef(({className:e,...t},r)=>a.jsx("caption",{ref:r,className:mr("mt-4 text-sm text-muted-foreground",e),...t}));Pot.displayName="TableCaption";const Aot={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Doe={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},yj=({icon:e,title:t,value:r,color:n,onClick:o,isActive:s})=>{const i=e;return a.jsxs(Pr.div,{variants:Doe,className:mr("bg-surface rounded-lg border p-4 flex items-center gap-4 cursor-pointer transition-all duration-200",s?"border-brand ring-2 ring-brand/50":"border-border hover:border-brand/50"),onClick:o,children:[a.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:a.jsx(i,{className:`w-6 h-6 ${n}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function Eot({open:e,onOpenChange:t,client:r,onEdit:n,onInactivate:o,codigoEmpresa:s}){const{toast:i}=no(),l={scheduled:{bg:"bg-[#3B82F6]/10",text:"text-[#3B82F6]",border:"border-[#3B82F6]/30"},confirmed:{bg:"bg-[#22C55E]/10",text:"text-[#22C55E]",border:"border-[#22C55E]/30"},in_progress:{bg:"bg-[#FACC15]/10",text:"text-[#FACC15]",border:"border-[#FACC15]/30"},finished:{bg:"bg-[#6B7280]/10",text:"text-[#6B7280]",border:"border-[#6B7280]/30"},canceled:{bg:"bg-[#EF4444]/10",text:"text-[#EF4444]",border:"border-[#EF4444]/30"},absent:{bg:"bg-[#F97316]/10",text:"text-[#F97316]",border:"border-[#F97316]/30"}},c=({label:R,value:D})=>a.jsxs("div",{className:"grid grid-cols-12 items-start gap-3 py-2 border-b border-border/50",children:[a.jsx("div",{className:"col-span-5 sm:col-span-4",children:a.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-text-muted font-semibold",children:R})}),a.jsx("div",{className:"col-span-7 sm:col-span-8",children:a.jsx("span",{className:"block text-sm font-medium text-text-primary break-words",children:D})})]}),[d,u]=p.useState(!1),[f,h]=p.useState([]),[m,v]=p.useState(!1),[g,y]=p.useState([]),x=p.useRef(!1),b=p.useRef(!1),[w,j]=p.useState(!1),[_,C]=p.useState(null),[E,A]=p.useState(!1),[P,F]=p.useState(null),M=p.useMemo(()=>{try{const R=(f||[]).map(U=>({kind:"comanda",ts:new Date(U.aberto_em||U.created_at||0).getTime(),data:U})),D=(g||[]).map(U=>({kind:"agendamento",ts:new Date(U.inicio||0).getTime(),data:U}));return[...R,...D].sort((U,z)=>z.ts-U.ts).slice(0,10)}catch{return[]}},[f,g]),I=async R=>{try{if(j(!0),C(R?.kind||null),A(!0),F(null),R?.kind==="comanda"){const D=R?.data?.comanda_id;if(!D){A(!1);return}let U=fe.from("comanda_itens").select("id, quantidade, preco_unitario, desconto, produto:produtos!comanda_itens_produto_id_fkey ( nome )").eq("comanda_id",D);s&&(U=U.eq("codigo_empresa",s));const{data:z}=await U,H=(z||[]).map(Z=>({id:Z.id,quantidade:Z.quantidade,preco_unitario:Z.preco_unitario,desconto:Z.desconto,produto_nome:Z.produto?.[0]?.nome||Z.produto?.nome||"Item"}));let q=fe.from("pagamentos").select("id, valor, status, recebido_em, metodo").eq("comanda_id",D);s&&(q=q.eq("codigo_empresa",s));const{data:Q}=await q,pe=Q||[];let be=fe.from("comanda_clientes").select("cliente:clientes!comanda_clientes_cliente_id_fkey ( id, nome, email, telefone )").eq("comanda_id",D);s&&(be=be.eq("codigo_empresa",s));const{data:V}=await be,B=(V||[]).map(Z=>Z.cliente?.[0]||Z.cliente).filter(Boolean),J=(H||[]).reduce((Z,ge)=>Z+(Number(ge.quantidade||0)*Number(ge.preco_unitario||0)-Number(ge.desconto||0)),0),ue=(pe||[]).filter(Z=>(Z.status||"Pago")!=="Cancelado"&&(Z.status||"Pago")!=="Estornado").reduce((Z,ge)=>Z+Number(ge.valor||0),0),Ne=Math.max(0,J-ue);F({comandaId:D,mesa_title:R?.data?.mesa_title||"Balco",status:R?.data?.status||"open",itens:H||[],pagamentos:pe||[],clientes:B,totalItens:J,totalPagos:ue,saldo:Ne,aberto_em:R?.data?.aberto_em||R?.data?.created_at||null,fechado_em:R?.data?.fechado_em||null})}else if(R?.kind==="agendamento"){const D=R?.data?.id;if(!D){A(!1);return}let U=[];try{const{data:q}=await fe.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento").eq("agendamento_id",D).limit(200);U=q||[]}catch{U=[]}const z=Array.from(new Set((U||[]).map(q=>q.cliente_id).filter(Boolean)));let H=[];if(H=(U||[]).map(q=>({id:q.cliente_id,nome:q.nome||null,email:null,telefone:null,codigo:null,valor_cota:q.valor_cota??null,status_pagamento:q.status_pagamento||null})),z.length>0)try{const{data:q}=await fe.from("clientes").select("id,nome,email,telefone,codigo").in("id",z),Q=new Map((q||[]).map(pe=>[String(pe.id),pe]));H=H.map(pe=>{const be=Q.get(String(pe.id));return be?{...pe,nome:pe.nome||be.nome,email:be.email,telefone:be.telefone,codigo:be.codigo}:pe})}catch{}F({id:D,inicio:R?.data?.inicio||null,fim:R?.data?.fim||null,status:R?.data?.status||null,modalidade:R?.data?.modalidade||null,quadra_nome:R?.data?.quadra_nome||null,participantes:H})}}catch{}finally{A(!1)}};return p.useEffect(()=>{let R=!1;if(e&&(x.current=!1,b.current=!1),e&&r?.id&&!s)return u(!1),v(!1),()=>{R=!0};const D=async()=>{if(!e||!r?.id)return;u(!0);const z=Number(r?.codigo??-1)===0;let H=fe.from("comanda_clientes").select("comanda_id, created_at");z?H=H.is("cliente_id",null):H=H.eq("cliente_id",r.id),H=H.order("created_at",{ascending:!1}).limit(50),s&&(H=H.eq("codigo_empresa",s));const{data:q,error:Q}=await H;if(Q)throw Q;const pe=Array.from(new Set((q||[]).map(ue=>ue.comanda_id).filter(Boolean)));let be=[];if(!z){let ue=fe.from("comandas").select("id, status, aberto_em, fechado_em").eq("cliente_id",r.id).order("aberto_em",{ascending:!1}).limit(10);s&&(ue=ue.eq("codigo_empresa",s));const{data:Ne,error:Z}=await ue;if(Z)throw Z;be=Ne||[]}const V=Array.from(new Set((be||[]).map(ue=>ue.id))),B=Array.from(new Set([...pe,...V]));if(B.length===0){h([]),u(!1);return}let J;try{J=setTimeout(()=>u(!1),1e4)}catch{}try{let ue=fe.from("comandas").select("id,status,aberto_em,fechado_em, mesa:mesas!comandas_mesa_id_fkey ( nome, numero )").in("id",B);s&&(ue=ue.eq("codigo_empresa",s));const{data:Ne,error:Z}=await ue;if(Z)throw Z;const ge=new Map((Ne||[]).map(Nt=>[Nt.id,Nt]));let le=fe.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",B);s&&(le=le.eq("codigo_empresa",s));const{data:se,error:ee}=await le;if(ee)throw ee;const de={};for(const Nt of se||[]){const tt=Number(Nt.quantidade||0)*Number(Nt.preco_unitario||0),he=Number(Nt.desconto||0);de[Nt.comanda_id]=(de[Nt.comanda_id]||0)+Math.max(0,tt-he)}let Le=fe.from("pagamentos").select("comanda_id, valor, status, recebido_em, metodo").in("comanda_id",B);s&&(Le=Le.eq("codigo_empresa",s));const{data:ae,error:ie}=await Le;if(ie)throw ie;const dt={};for(const Nt of ae||[])(Nt.status||"Pago")!=="Cancelado"&&(Nt.status||"Pago")!=="Estornado"&&(dt[Nt.comanda_id]=(dt[Nt.comanda_id]||0)+Number(Nt.valor||0));const At=(Nt,tt=null)=>{const he=ge.get(Nt)||{},ke=Number(de[Nt]||0),et=Number(dt[Nt]||0),Me=Math.max(0,ke-et),$e=he.mesa?.[0]?.nome||he.mesa?.nome||null,Be=he.mesa?.[0]?.numero||he.mesa?.numero||null,we=$e||(Be!=null?`Mesa ${Be}`:"Balco");return{comanda_id:Nt,created_at:tt,aberto_em:he.aberto_em||null,fechado_em:he.fechado_em||null,status:he.status||"open",total:ke,pago:et,saldo:Me,mesa_title:we}},st=(q||[]).map(Nt=>At(Nt.comanda_id,Nt.created_at)),ut=(be||[]).filter(Nt=>!(pe||[]).includes(Nt.id)).map(Nt=>At(Nt.id,Nt.aberto_em)),Rt=[...st,...ut].sort((Nt,tt)=>{const he=new Date(Nt.aberto_em||Nt.created_at||0).getTime();return new Date(tt.aberto_em||tt.created_at||0).getTime()-he}).slice(0,10);if(!R&&Rt.length===0&&!x.current){x.current=!0,console.debug("[ClientDetailsModal] loadHistory: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&D()},700);return}R||h(Rt)}catch(ue){i({title:"Falha ao carregar histrico do cliente",description:ue?.message||"Tente novamente",variant:"destructive"})}finally{try{clearTimeout(J)}catch{}R||u(!1)}},U=async()=>{if(!e||!r?.id)return;v(!0);let z;try{z=setTimeout(()=>v(!1),1e4)}catch{}try{console.debug("[ClientDetailsModal] loadBookings: start",{clientId:r.id,codigoEmpresa:s});let H=fe.from("agendamentos").select(`
            id, inicio, fim, status, modalidade,
            quadra:quadra_id ( nome )
          `).eq("cliente_id",r.id).order("inicio",{ascending:!1}).limit(10);s&&(H=H.eq("codigo_empresa",s));const{data:q,error:Q}=await H;if(Q)throw Q;const pe=(q||[]).map(le=>({id:le.id,inicio:le.inicio,fim:le.fim,status:le.status,modalidade:le.modalidade,quadra_nome:le.quadra?.[0]?.nome||le.quadra?.nome||null}));let be=fe.from("v_agendamento_participantes").select("agendamento_id").eq("cliente_id",r.id).limit(30);const{data:V,error:B}=await be;if(B)throw B;const J=Array.from(new Set((V||[]).map(le=>le.agendamento_id).filter(Boolean))),ue=new Set((pe||[]).map(le=>le.id)),Ne=J.filter(le=>!ue.has(le));let Z=[];if(Ne.length>0){let le=fe.from("agendamentos").select(`
              id, inicio, fim, status, modalidade,
              quadra:quadra_id ( nome )
            `).in("id",Ne);s&&(le=le.eq("codigo_empresa",s));const{data:se,error:ee}=await le;if(ee)throw ee;Z=(se||[]).map(de=>({id:de.id,inicio:de.inicio,fim:de.fim,status:de.status,modalidade:de.modalidade,quadra_nome:de.quadra?.[0]?.nome||de.quadra?.nome||null}))}const ge=[...pe,...Z].sort((le,se)=>new Date(se.inicio)-new Date(le.inicio)).slice(0,10);if(!R&&ge.length===0&&!b.current){b.current=!0,console.debug("[ClientDetailsModal] loadBookings: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&U()},700);return}R||y(ge)}catch(H){console.warn("[ClientDetailsModal] Falha ao carregar agendamentos do cliente:",H)}finally{try{clearTimeout(z)}catch{}R||v(!1)}};return D(),U(),()=>{R=!0,e||(u(!1),v(!1))}},[e,r?.id,s]),r?a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto w-full",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Detalhes do Cliente"}),a.jsx(On,{children:"Informaes cadastrais e histrico recente deste cliente."})]}),a.jsxs("div",{className:"p-4 sm:p-6 space-y-6 sm:space-y-8",children:[a.jsx("div",{className:"overflow-hidden",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:a.jsxs("div",{className:"min-w-0",children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-extrabold tracking-tight text-text-primary truncate",children:r.nome}),a.jsxs("div",{className:"mt-2 flex items-center flex-wrap gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",a.jsx("span",{className:"text-text-primary font-mono",children:r.codigo})]}),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold border ${r.status==="active"?"bg-emerald-500/10 text-emerald-400 border-emerald-400/30":"bg-rose-500/10 text-rose-400 border-rose-400/30"}`,children:r.status==="active"?"Ativo":"Inativo"}),r.flag_cliente&&a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),r.flag_fornecedor&&a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),a.jsx("span",{className:"mt-2 block text-sm text-text-secondary truncate",children:r.email||""})]})})}),a.jsx("div",{className:"grid grid-cols-1 gap-8",children:a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-text-secondary mb-2",children:"Informaes Cadastrais"}),a.jsxs("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg space-y-1",children:[a.jsx(c,{label:"Cdigo",value:r.codigo}),a.jsx(c,{label:"CPF/CNPJ",value:r.cpf||r.cnpj||""}),a.jsx(c,{label:"Telefone",value:r.telefone||""}),a.jsx(c,{label:"Aniversrio",value:r.aniversario?new Date(r.aniversario).toLocaleDateString("pt-BR"):""}),a.jsx(c,{label:"Email",value:r.email||""}),a.jsx(c,{label:"Status",value:r.status==="active"?"Ativo":"Inativo"})]})]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary",children:[a.jsx(Sue,{className:"w-5 h-5 text-text-secondary"}),a.jsx("h4",{className:"font-semibold",children:"Histrico Recente"})]}),a.jsx("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg",children:d&&m?a.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Carregando histrico..."}):M&&M.length>0?a.jsx("div",{className:"max-h-64 overflow-y-auto thin-scroll pr-1",children:a.jsx("div",{className:"space-y-3",children:M.map((R,D)=>a.jsxs("div",{className:"group flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3 p-3 rounded-md border border-border/60 bg-background cursor-pointer transition-colors transition-shadow hover:bg-surface-2/60 hover:shadow-md hover:border-brand/30",title:"Clique para ver detalhes",onClick:()=>I(R),children:[a.jsx("div",{className:"min-w-0",children:R.kind==="comanda"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:R.data.mesa_title||"Balco"}),a.jsx("div",{className:"text-xs text-text-secondary truncate",children:(()=>{const U=R.data;return U.aberto_em?new Date(U.aberto_em).toLocaleString("pt-BR"):new Date(U.created_at).toLocaleString("pt-BR")})()})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:R.data.modalidade||"Agendamento"}),a.jsxs("div",{className:"text-xs text-text-secondary truncate",children:[new Date(R.data.inicio).toLocaleString("pt-BR"),"  ",R.data.quadra_nome||"Quadra"]})]})}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:R.kind==="comanda"?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:mr("px-2 py-1 text-[11px] font-semibold rounded-full border",R.data.status==="closed"||R.data.fechado_em?"bg-success/10 text-success border-success/30":R.data.status==="awaiting-payment"?"bg-info/10 text-info border-info/30":"bg-warning/10 text-warning border-warning/30"),children:R.data.status==="closed"||R.data.fechado_em?"Fechada":R.data.status==="awaiting-payment"?"Pagamento":"Em uso"}),a.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:mr("px-2 py-1 text-[11px] font-semibold rounded-full border",(()=>{const U=String(R.data.status||"").toLowerCase(),z=l[U]||l.scheduled;return`${z.bg} ${z.text} ${z.border}`})()),children:(()=>{switch(R.data.status){case"finished":return"Finalizado";case"canceled":return"Cancelado";case"in_progress":return"Em andamento";case"confirmed":return"Confirmado";case"absent":return"Ausente";case"scheduled":default:return"Agendado"}})()}),a.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]})})]},`${R.kind}-${D}`))})}):a.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Sem registros recentes para este cliente."})})]}),a.jsx(xn,{open:w,onOpenChange:j,children:a.jsxs(vn,{className:"sm:max-w-[700px] w-full max-h-[85vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:_==="comanda"?P?.mesa_title||"Detalhes da Comanda":"Detalhes do Agendamento"}),a.jsx(On,{children:_==="comanda"?"Itens e pagamentos desta comanda.":"Informaes do agendamento e participantes."}),a.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"text-xs text-text-secondary",children:"Cliente:"}),a.jsx("span",{className:"text-sm font-medium text-text-primary",children:r?.nome||""}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",a.jsx("span",{className:"text-text-primary font-mono",children:r?.codigo??""})]})]})]}),a.jsx("div",{className:"space-y-4",children:E?a.jsx("div",{className:"text-sm text-text-muted",children:"Carregando detalhes..."}):_==="comanda"&&P?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Status"}),a.jsx("p",{className:"font-semibold",children:(()=>{const R=String(P.status||"").toLowerCase();return R==="closed"||P.fechado_em?"Fechada":R==="awaiting-payment"?"Aguardando pagamento":"Aberta"})()})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Abertura"}),a.jsx("p",{className:"font-semibold",children:P.aberto_em?new Date(P.aberto_em).toLocaleString("pt-BR"):""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Fechamento"}),a.jsx("p",{className:"font-semibold",children:P.fechado_em?new Date(P.fechado_em).toLocaleString("pt-BR"):""})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Itens"}),a.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(P.itens||[]).map(R=>a.jsxs("div",{className:"p-2 flex flex-col sm:grid sm:grid-cols-12 gap-1 sm:gap-2 text-sm",children:[a.jsx("div",{className:"sm:col-span-6 font-medium",children:R.produto_nome||"Item"}),a.jsxs("div",{className:"sm:col-span-2 sm:text-right text-text-muted",children:["Qtd: ",Number(R.quantidade||0)]}),a.jsxs("div",{className:"sm:col-span-2 sm:text-right",children:["R$ ",Number(R.preco_unitario||0).toFixed(2)]}),a.jsx("div",{className:"sm:col-span-2 sm:text-right text-text-secondary",children:Number(R.desconto||0)?`- R$ ${Number(R.desconto||0).toFixed(2)}`:""})]},R.id)),(!P.itens||P.itens.length===0)&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum item."})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Pagamentos"}),a.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(P.pagamentos||[]).map(R=>a.jsxs("div",{className:"p-2 flex items-center justify-between text-sm",children:[a.jsxs("span",{className:"truncate",children:[R.metodo||""," ",R.status?`(${R.status})`:""]}),a.jsxs("span",{className:"font-semibold",children:["R$ ",Number(R.valor||0).toFixed(2)]})]},R.id)),(!P.pagamentos||P.pagamentos.length===0)&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum pagamento registrado."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Total de Itens"}),a.jsxs("p",{className:"font-bold",children:["R$ ",Number(P.totalItens||0).toFixed(2)]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Total Pago"}),a.jsxs("p",{className:"font-bold text-success",children:["R$ ",Number(P.totalPagos||0).toFixed(2)]})]})]})]}):_==="agendamento"&&P?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Modalidade"}),a.jsx("p",{className:"font-semibold",children:P.modalidade||""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Quadra"}),a.jsx("p",{className:"font-semibold",children:P.quadra_nome||""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Incio"}),a.jsx("p",{className:"font-semibold",children:P.inicio?new Date(P.inicio).toLocaleString("pt-BR"):""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Fim"}),a.jsx("p",{className:"font-semibold",children:P.fim?new Date(P.fim).toLocaleString("pt-BR"):""})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Participantes"}),a.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(P.participantes||[]).map((R,D)=>a.jsxs("div",{className:"p-2 text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3",children:[a.jsx("div",{className:"min-w-0",children:a.jsxs("div",{className:"flex items-center gap-2",children:[R.codigo!==null&&R.codigo!==void 0&&a.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${String(R.status_pagamento||"").toLowerCase()==="pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",R.codigo]}),a.jsx("span",{className:"font-medium truncate",children:R.nome||"Participante"})]})}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:[R.valor_cota!=null&&a.jsxs("span",{className:"text-xs font-semibold text-text-secondary",children:["R$ ",Number(R.valor_cota||0).toFixed(2)]}),a.jsx("span",{className:`text-[11px] font-semibold rounded-full px-2 py-0.5 border ${String(R.status_pagamento||"").toLowerCase()==="pago"?"bg-success/10 text-success border-success/30":"bg-warning/10 text-warning border-warning/30"}`,children:String(R.status_pagamento||R.status_pagamento_text||"Pendente")})]})]},`${R.id}-${D}`)),(!P.participantes||P.participantes.length===0)&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum participante encontrado."})]})]})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma informao para exibir."})}),a.jsx(ra,{children:a.jsx(ce,{variant:"outline",onClick:()=>j(!1),children:"Fechar"})})]})})]}),a.jsxs(ra,{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-0 sm:justify-between",children:[!r?.is_consumidor_final&&a.jsx("div",{className:"w-full sm:flex-1",children:a.jsxs(ce,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white w-full sm:w-auto",onClick:()=>o?.(r),children:[a.jsx(WH,{className:"mr-2 h-4 w-4"})," Inativar Cliente"]})}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[a.jsx(ih,{asChild:!0,children:a.jsx(ce,{type:"button",variant:"secondary",className:"flex-1 sm:flex-none",children:"Fechar"})}),!r?.is_consumidor_final&&a.jsxs(ce,{onClick:()=>n(r),className:"flex-1 sm:flex-none",children:[a.jsx(fl,{className:"mr-2 h-4 w-4"})," Editar Cliente"]})]})]})]})}):null}function kot(){const{toast:e}=no(),{userProfile:t,authReady:r}=So(),n=Ls(),[o,s]=p.useState(()=>{try{const B=localStorage.getItem("auth:userProfile"),J=B&&JSON.parse(B)?.codigo_empresa||null,ue=J?`clientes:list:${J}`:"clientes:list",Ne=JSON.parse(localStorage.getItem(ue)||"[]");return Array.isArray(Ne)?Ne:[]}catch{return[]}}),[i,l]=p.useState(!1),[c,d]=p.useState(!0),[u,f]=p.useState(!1),[h,m]=p.useState(!1),[v,g]=p.useState(null),[y,x]=p.useState(null),[b,w]=p.useState({searchTerm:"",status:"all",tipo:"todos"}),j=p.useRef(!1),_=p.useRef(0),C=p.useRef(0),E=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!u&&!E.current&&(E.current=!0,f(!0),window.history.replaceState({},document.title))},[n.state?.openModal,u]);const A=async()=>{try{const B=o&&o.length>0;if(B||l(!0),!t?.codigo_empresa)return;const J=`clientes:list:${t.codigo_empresa}`;let ue=fe.from("clientes").select("*, is_consumidor_final").eq("codigo_empresa",t.codigo_empresa).order("codigo",{ascending:!0});if(b.searchTerm.trim()!==""){const se=b.searchTerm.trim();/^\d+$/.test(se)?ue=ue.or(`codigo.eq.${se},nome.ilike.%${se}%,email.ilike.%${se}%,telefone.ilike.%${se}%`):ue=ue.or(`nome.ilike.%${se}%,email.ilike.%${se}%,telefone.ilike.%${se}%`)}b.status!=="all"&&(ue=ue.eq("status",b.status));const Ne=setTimeout(()=>{try{if(!B){const se=JSON.parse(localStorage.getItem(J)||"[]");Array.isArray(se)&&se.length>0&&(console.warn("[Clientes] slow fallback: using cached snapshot"),s(se),C.current=se.length)}}catch{}},2e3),{data:Z,error:ge}=await ue;if(ge){if(!j.current){j.current=!0,setTimeout(A,900);return}throw ge}const le=Z||[];if(le.length===0&&B&&!j.current){j.current=!0,setTimeout(A,700);return}j.current=!1,s(le);try{localStorage.setItem(J,JSON.stringify(le))}catch{}C.current=le.length,_.current=Date.now()}catch(B){e({title:"Erro ao carregar clientes",description:B.message,variant:"destructive"})}finally{l(!1);try{clearTimeout(slowFallback)}catch{}}};p.useEffect(()=>{try{const B=localStorage.getItem("auth:userProfile"),J=t?.codigo_empresa||B&&JSON.parse(B)?.codigo_empresa||null;if(J){const ue=`clientes:list:${J}`,Ne=JSON.parse(localStorage.getItem(ue)||"[]");Array.isArray(Ne)&&Ne.length&&o.length===0&&(s(Ne),C.current=Ne.length)}}catch{}if(r&&t?.codigo_empresa){const B=setTimeout(A,50);return()=>clearTimeout(B)}return()=>{}},[r,t?.codigo_empresa]),p.useEffect(()=>{if(r&&t?.codigo_empresa){const B=setTimeout(A,200);return()=>clearTimeout(B)}return()=>{}},[b.searchTerm,b.status,r,t?.codigo_empresa]),p.useEffect(()=>{const B=()=>{(Date.now()-(_.current||0)>3e4||C.current===0)&&r&&t?.codigo_empresa&&A()},J=()=>{document.visibilityState==="visible"&&(Date.now()-(_.current||0)>3e4||C.current===0)&&r&&t?.codigo_empresa&&A()};return window.addEventListener("focus",B),document.addEventListener("visibilitychange",J),()=>{window.removeEventListener("focus",B),document.removeEventListener("visibilitychange",J)}},[r,t?.codigo_empresa]);const P=p.useMemo(()=>{const J=new Date().getMonth();return{total:o.length,birthdays:o.filter(ue=>ue.aniversario&&new Date(ue.aniversario).getMonth()===J).length,active:o.filter(ue=>ue.status==="active").length}},[o]);function F(B){const J=["Cdigo","Tipo Pessoa","Nome/Razo Social","Apelido/Nome Fantasia","CPF","CNPJ","RG","IE","Email","Telefone","Fone 2","Celular 1","Celular 2","WhatsApp","CEP","Endereo","Nmero","Complemento","Bairro","Cidade","UF","Cidade IBGE","Limite Crdito","Tipo Recebimento","Regime Tributrio","Tipo Contribuinte","Aniversrio","Sexo","Estado Civil","Nome da Me","Nome do Pai","Observaes"," Cliente"," Fornecedor"," Funcionrio"," Administradora"," Parceiro","CCF/SPC","Status"],ue=";",Ne=ae=>{if(!ae)return"";try{const ie=new Date(ae);if(!isNaN(ie)){const dt=String(ie.getDate()).padStart(2,"0"),At=String(ie.getMonth()+1).padStart(2,"0"),st=ie.getFullYear();return`${dt}/${At}/${st}`}}catch{}return String(ae)},Z=ae=>{const ie=Number(ae??0);return Number.isFinite(ie)?ie.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},ge=ae=>ae?"Sim":"No",le=ae=>{const ie=ae==null?"":String(ae);return/[";\n]/.test(ie)?`"${ie.replace(/"/g,'""')}"`:ie},se=[];se.push("\uFEFF"+J.join(ue));for(const ae of B){const ie=[ae.codigo??"",ae.tipo_pessoa||"",ae.nome||"",ae.apelido||"",ae.cpf||"",ae.cnpj||"",ae.rg||"",ae.ie||"",ae.email||"",ae.telefone||"",ae.fone2||"",ae.celular1||"",ae.celular2||"",ae.whatsapp||"",ae.cep||"",ae.endereco||"",ae.numero||"",ae.complemento||"",ae.bairro||"",ae.cidade||"",ae.uf||"",ae.cidade_ibge||"",Z(ae.limite_credito),ae.tipo_recebimento||"",ae.regime_tributario||"",ae.tipo_contribuinte||"",Ne(ae.aniversario),ae.sexo||"",ae.estado_civil||"",ae.nome_mae||"",ae.nome_pai||"",ae.observacoes||"",ge(!!ae.flag_cliente),ge(!!ae.flag_fornecedor),ge(!!ae.flag_funcionario),ge(!!ae.flag_administradora),ge(!!ae.flag_parceiro),ge(!!ae.flag_ccf_spc),ae.status==="active"?"Ativo":"Inativo"].map(le).join(ue);se.push(ie)}const ee=new Blob([se.join(`
`)],{type:"text/csv;charset=utf-8;"}),de=URL.createObjectURL(ee),Le=document.createElement("a");Le.href=de,Le.download="clientes.csv",document.body.appendChild(Le),Le.click(),document.body.removeChild(Le),URL.revokeObjectURL(de)}const M=()=>{try{F(I),e({title:"Exportao concluda",description:`${I.length} cliente(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(B){e({title:"Falha ao exportar",description:B?.message||"No foi possvel gerar o arquivo.",variant:"destructive"})}},I=p.useMemo(()=>(new Date().getMonth(),o.filter(J=>{const ue=b.searchTerm.toLowerCase()===""||(J.nome||"").toLowerCase().includes(b.searchTerm.toLowerCase())||(J.cpf||"").includes(b.searchTerm)||(J.telefone||"").includes(b.searchTerm),Ne=b.status==="all"||J.status===b.status;let Z=!0;return b.tipo==="clientes"?Z=J.flag_cliente===!0:b.tipo==="fornecedores"?Z=J.flag_fornecedor===!0:b.tipo==="ambos"&&(Z=J.flag_cliente===!0&&J.flag_fornecedor===!0),ue&&Ne&&Z})),[o,b]),[R,D]=p.useState({by:"codigo",dir:"asc"}),U=B=>{D(J=>J.by===B&&J.dir==="asc"?{by:B,dir:"desc"}:{by:B,dir:"asc"})},z=p.useMemo(()=>{const B=I.find(ge=>ge?.is_consumidor_final===!0),ue=[...I.filter(ge=>ge?.is_consumidor_final!==!0)],Ne=R.dir==="asc"?1:-1,Z=(ge,le)=>Number.isFinite(ge)?ge:le;return ue.sort((ge,le)=>{if(R.by==="codigo"){const se=Z(parseInt(String(ge.codigo||"").trim(),10),1/0),ee=Z(parseInt(String(le.codigo||"").trim(),10),1/0);return se===ee?0:se>ee?Ne:-Ne}if(R.by==="nome"){const se=(ge.nome||"").toString(),ee=(le.nome||"").toString();return se.localeCompare(ee,"pt-BR",{sensitivity:"base"})*Ne}return 0}),B?[B,...ue]:ue},[I,R]),H=B=>{g(B),m(!0)},q=()=>{x(null),f(!0)},Q=B=>{m(!1),x(B),f(!0)},pe=async B=>{try{const{error:J}=await fe.from("clientes").update({status:"inactive"}).eq("id",B.id);if(J)throw J;m(!1),e({title:"Cliente inativado",description:`${B.nome} foi marcado como inativo.`}),A()}catch(J){e({title:"Erro ao inativar cliente",description:J.message,variant:"destructive"})}},be=()=>{w({searchTerm:"",status:"all",tipo:"todos"})},V=b.searchTerm!==""||b.status!=="all"||b.tipo!=="todos";return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-full flex flex-col",children:a.jsxs(Pr.div,{variants:Aot,initial:"hidden",animate:"visible",children:[a.jsxs(Pr.div,{variants:Doe,className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Clientes & Fornecedores"}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa de clientes e fornecedores"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[a.jsx(ce,{variant:"outline",size:"icon",onClick:()=>d(B=>!B),title:c?"Ocultar resumo":"Mostrar resumo","aria-label":c?"Ocultar resumo":"Mostrar resumo",className:"flex-shrink-0",children:c?a.jsx(Mp,{className:"h-4 w-4"}):a.jsx(Qp,{className:"h-4 w-4"})}),a.jsxs(ce,{variant:"outline",onClick:M,className:"text-sm",children:[a.jsx(ms,{className:"mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Exportar"}),a.jsx("span",{className:"sm:hidden",children:"CSV"})]}),a.jsxs(ce,{onClick:q,className:"text-sm",children:[a.jsx(ro,{className:"mr-2 h-4 w-4"})," ",a.jsx("span",{className:"hidden xs:inline",children:"Novo"}),a.jsx("span",{className:"xs:hidden",children:"Novo"})]})]})]}),c&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[a.jsx(yj,{icon:ml,title:"Total de Clientes",value:o.filter(B=>B.flag_cliente).length,color:"text-brand",onClick:()=>w(B=>({...B,tipo:"clientes"})),isActive:b.tipo==="clientes"}),a.jsx(yj,{icon:ml,title:"Total de Fornecedores",value:o.filter(B=>B.flag_fornecedor).length,color:"text-purple-500",onClick:()=>w(B=>({...B,tipo:"fornecedores"})),isActive:b.tipo==="fornecedores"}),a.jsx(yj,{icon:jue,title:"Aniversariantes do Ms",value:P.birthdays,color:"text-info",onClick:()=>w(B=>({...B,tipo:"todos"})),isActive:b.tipo==="todos"}),a.jsx(yj,{icon:Zp,title:"Ativos",value:P.active,color:"text-success",onClick:()=>w(B=>({...B,status:"active"})),isActive:b.status==="active"})]}),a.jsx(Pr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsxs("div",{className:"p-4 border-b border-border flex flex-col gap-4",children:[a.jsxs("div",{className:"relative w-full",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar por nome, CPF ou telefone...",className:"pl-9",value:b.searchTerm,onChange:B=>w(J=>({...J,searchTerm:B.target.value}))})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(Cn,{value:b.tipo,onValueChange:B=>w(J=>({...J,tipo:B})),children:[a.jsx(jn,{className:"w-full sm:w-[200px]",children:a.jsx(An,{placeholder:"Tipo"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"todos",children:"Todos"}),a.jsx(nt,{value:"clientes",children:"Apenas Clientes"}),a.jsx(nt,{value:"fornecedores",children:"Apenas Fornecedores"}),a.jsx(nt,{value:"ambos",children:"Clientes e Fornecedores"})]})]}),a.jsxs(Cn,{value:b.status,onValueChange:B=>w(J=>({...J,status:B})),children:[a.jsx(jn,{className:"w-full sm:w-[180px]",children:a.jsx(An,{placeholder:"Status"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Todos os Status"}),a.jsx(nt,{value:"active",children:"Ativos"}),a.jsx(nt,{value:"inactive",children:"Inativos"})]})]}),V&&a.jsxs(ce,{variant:"ghost",onClick:be,className:"w-full sm:w-auto",children:[a.jsx(zy,{className:"mr-2 h-4 w-4"}),"Limpar Filtros"]})]})]}),a.jsx("div",{className:"md:hidden space-y-3 p-4",children:i?a.jsx("div",{className:"text-center py-8 text-text-muted",children:"Carregando..."}):z.length>0?z.map(B=>{const J=B?.is_consumidor_final===!0;return a.jsxs("div",{className:mr("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer transition-all",J?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-4 border-l-amber-500/40 border-t-border border-r-border border-b-border":"border-border hover:border-brand/50"),onClick:()=>H(B),children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx("span",{className:mr("font-mono text-sm font-semibold",J?"text-amber-300/90":"text-text-primary"),children:B.codigo}),a.jsx("span",{className:mr("px-2 py-0.5 text-xs font-semibold rounded-full flex-shrink-0",B.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:B.status==="active"?"Ativo":"Inativo"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:mr("font-semibold text-base mb-1",J?"text-amber-100/90":"text-text-primary"),children:B.nome||""}),J&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium mb-1",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),a.jsx("p",{className:"text-sm text-text-muted",children:B.cpf&&`CPF: ${B.cpf}`||B.cnpj&&`CNPJ: ${B.cnpj}`||(B.apelido?`Apelido: ${B.apelido}`:" ")})]}),a.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[B.flag_cliente&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),B.flag_fornecedor&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),(B.telefone||B.email)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Contato"}),a.jsx("span",{className:"text-sm font-medium",children:B.telefone||B.email})]}),a.jsx("div",{className:"text-xs text-text-muted text-center pt-2 border-t border-border/50",children:"Toque para ver detalhes"})]},B.id)}):a.jsx("div",{className:"text-center py-8 text-text-muted",children:"Nenhum cliente encontrado com os filtros aplicados."})}),a.jsx("div",{className:"hidden md:block",children:a.jsxs(ol,{children:[a.jsx(sl,{className:"sticky top-0 bg-surface-2 z-10",children:a.jsxs(Wa,{className:"border-b border-border",children:[a.jsxs(qn,{className:"select-none cursor-pointer text-text-secondary",onClick:()=>U("codigo"),title:"Ordenar por cdigo",children:["Cdigo ",R.by==="codigo"?R.dir==="asc"?"":"":""]}),a.jsxs(qn,{className:"text-text-secondary select-none cursor-pointer",onClick:()=>U("nome"),title:"Ordenar por nome",children:["Cliente ",R.by==="nome"?R.dir==="asc"?"":"":""]}),a.jsx(qn,{className:"text-text-secondary",children:"Contato"}),a.jsx(qn,{className:"text-text-secondary",children:"Tipo"}),a.jsx(qn,{className:"text-text-secondary",children:"Status"})]})}),a.jsx(il,{children:i?a.jsx(Wa,{children:a.jsx(Sn,{colSpan:5,className:"h-24 text-center",children:"Carregando..."})}):z.length>0?z.map(B=>{const J=B?.is_consumidor_final===!0;return a.jsxs(Wa,{className:mr("cursor-pointer transition-all",J?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":"hover:bg-surface-2"),onClick:()=>H(B),children:[a.jsx(Sn,{className:mr("font-mono text-base font-semibold",J?"text-amber-300/90":"text-text-primary"),children:B.codigo}),a.jsx(Sn,{children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:mr("text-base font-semibold truncate",J?"text-amber-100/90":"text-text-primary"),children:B.nome||""}),J&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),a.jsx("span",{className:"text-xs text-text-muted truncate",children:B.cpf&&`CPF: ${B.cpf}`||B.cnpj&&`CNPJ: ${B.cnpj}`||(B.apelido?`Apelido: ${B.apelido}`:" ")})]})}),a.jsx(Sn,{children:a.jsx("div",{className:"flex flex-col",children:a.jsx("span",{className:"text-sm truncate",children:B.telefone||B.email||""})})}),a.jsx(Sn,{children:a.jsxs("div",{className:"flex flex-wrap gap-1",children:[B.flag_cliente&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),B.flag_fornecedor&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]})}),a.jsx(Sn,{children:a.jsx("span",{className:mr("px-2 py-1 text-xs font-semibold rounded-full",B.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:B.status==="active"?"Ativo":"Inativo"})})]},B.id)}):a.jsx(Wa,{children:a.jsx(Sn,{colSpan:5,className:"h-24 text-center",children:"Nenhum cliente encontrado com os filtros aplicados."})})})]})})]})})]})}),a.jsx(Ure,{open:u,onOpenChange:f,client:y,onSaved:A}),a.jsx(Eot,{open:h,onOpenChange:m,client:v,onEdit:Q,onInactivate:pe,codigoEmpresa:t?.codigo_empresa})]})}const Iot=[],Oot={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Moe={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},WE=({icon:e,title:t,value:r,color:n})=>{const o=e;return a.jsxs(Pr.div,{variants:Moe,className:"bg-surface rounded-lg border border-border p-4 flex items-center gap-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:a.jsx(o,{className:`w-6 h-6 ${n}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function Tot({open:e,onOpenChange:t,member:r,onEdit:n}){return r?a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"sm:max-w-[500px] w-full",children:[a.jsx(pn,{children:a.jsx(fn,{children:"Detalhes do Funcionrio"})}),a.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-bold",children:r.name}),a.jsx("p",{className:"text-brand font-semibold",children:r.role})]}),a.jsxs("div",{className:"bg-surface-2 p-8 rounded-lg text-center border border-border",children:[a.jsx("p",{className:"text-lg font-semibold text-text-secondary",children:" Em desenvolvimento"}),a.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Detalhes completos do funcionrio estaro disponveis em breve."})]})]}),a.jsxs(ra,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[a.jsx(ih,{asChild:!0,children:a.jsx(ce,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Fechar"})}),a.jsxs(ce,{onClick:()=>n(r),className:"w-full sm:w-auto",children:[a.jsx(fl,{className:"mr-2 h-4 w-4"})," Editar"]})]})]})}):null}function Dot({open:e,onOpenChange:t,member:r,onSave:n,loading:o}){const{toast:s}=no(),[i,l]=p.useState(r?.name||""),[c,d]=p.useState(r?.role||"");p.useEffect(()=>{e&&(l(r?.name||""),d(r?.role||""))},[r,e]);const u=async f=>{if(f.preventDefault(),!i.trim()){s({title:"Nome  obrigatrio",variant:"destructive"});return}await n({name:i.trim(),role:c.trim()})};return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"sm:max-w-[700px] w-full",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:r?"Editar Funcionrio":"Novo Funcionrio"}),a.jsx(On,{children:"Informe apenas nome e cargo. O cargo  livre (texto)."})]}),a.jsx("form",{onSubmit:u,className:"py-2",children:a.jsx("div",{className:"bg-surface-2 border border-border rounded-lg p-4 space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"name",children:"Nome"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ou,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{id:"name",value:i,onChange:f=>l(f.target.value),className:"pl-9",placeholder:"Ex.: Maria Silva"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"role",children:"Cargo"}),a.jsxs("div",{className:"relative",children:[a.jsx(Pue,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{id:"role",value:c,onChange:f=>d(f.target.value),className:"pl-9",placeholder:"Ex.: Gerente, Caixa, ..."})]})]})]})})}),a.jsxs(ra,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[a.jsx(ih,{asChild:!0,children:a.jsx(ce,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),a.jsx(ce,{type:"submit",onClick:u,disabled:!!o,className:"w-full sm:w-auto",children:o?"Salvando...":"Salvar"})]})]})})}function Mot(){const{company:e,authReady:t,userProfile:r}=So(),{toast:n}=no(),[o,s]=p.useState(Iot),[i,l]=p.useState(!1),[c,d]=p.useState(!1),[u,f]=p.useState(null),[h,m]=p.useState(null),[v,g]=p.useState(""),[y,x]=p.useState(!1),b=p.useRef(!1),w=p.useRef(!0);p.useEffect(()=>(w.current=!0,()=>{w.current=!1}),[]);const j=async()=>{try{const R=e?.codigo_empresa||null;if(!R&&!e?.id)return;const D=R?`team:list:${R}`:"team:list",U=setTimeout(()=>{if(w.current)try{const V=localStorage.getItem(D),B=V?JSON.parse(V):[];Array.isArray(B)&&B.length>0&&(console.warn("[Equipe] slow fallback: using cached snapshot"),s(B))}catch{}},5e3);let z=fe.from("colaboradores").select("*").order("nome",{ascending:!0});R&&(z=z.eq("codigo_empresa",R));const{data:H,error:q}=await z;if(q){if(!b.current){b.current=!0,setTimeout(j,800);return}throw q}let pe=(H||[]).map(V=>({id:V.id,name:V.nome||"",role:V.cargo||"user",status:V.ativo===!1?"inactive":"active",online:!1,permissions:{}}));const be=r?.codigo_empresa&&e?.codigo_empresa&&r.codigo_empresa===e.codigo_empresa;if(r?.id&&be&&(pe.some(B=>B.id===r.id)||(pe=[{id:r.id,name:r.nome||"Voc",role:r.cargo||"user",status:"active",online:!1,permissions:{}},...pe])),!w.current)return;s(pe);try{localStorage.setItem(D,JSON.stringify(pe))}catch{}}catch(R){console.error("Falha ao carregar equipe:",R);const D=e?.codigo_empresa||null,U=D?`team:list:${D}`:"team:list";try{const z=localStorage.getItem(U);z&&w.current&&s(JSON.parse(z))}catch{}}finally{b.current=!1}};p.useEffect(()=>{const R=e?.codigo_empresa||null;if(!(!t||!R)){try{const D=localStorage.getItem(`team:list:${R}`),U=D?JSON.parse(D):[];Array.isArray(U)&&U.length>0&&s(U)}catch{}j()}},[t,e?.codigo_empresa]),p.useEffect(()=>{const R=()=>{document.visibilityState==="visible"&&t&&(e?.codigo_empresa||e?.id)&&j()},D=()=>{t&&(e?.codigo_empresa||e?.id)&&j()};return document.addEventListener("visibilitychange",R),window.addEventListener("focus",D),()=>{document.removeEventListener("visibilitychange",R),window.removeEventListener("focus",D)}},[t,e?.codigo_empresa,e?.id]);const _=p.useMemo(()=>({total:o.length,active:o.filter(R=>R.status==="active").length,inactive:o.filter(R=>R.status==="inactive").length}),[o]),C=p.useMemo(()=>o.filter(R=>R.name.toLowerCase().includes(v.toLowerCase())||R.role.toLowerCase().includes(v.toLowerCase())),[o,v]),E=R=>{f(R),d(!0)},A=()=>{m(null),l(!0)},P=R=>{d(!1),m(R),l(!0)},F=R=>{m(R),l(!0)},M=async({name:R,role:D})=>{try{if(x(!0),!e?.codigo_empresa&&!e?.id)throw new Error("Empresa no encontrada para o usurio atual.");let U=e?.codigo_empresa||null;if(!U&&e?.id){const{data:z}=await fe.from("empresas").select("codigo_empresa").eq("id",e.id).single();U=z?.codigo_empresa||null}if(!U)throw new Error("Empresa sem cdigo. Defina o cdigo da empresa antes de adicionar colaboradores.");if(h){const{error:z}=await fe.from("colaboradores").update({nome:R,cargo:D}).eq("id",h.id);if(z)throw z;n({title:"Funcionrio atualizado",description:h.name,variant:"default"})}else{const{error:z}=await fe.from("colaboradores").insert({codigo_empresa:U,nome:R,cargo:D,ativo:!0});if(z)throw z;n({title:"Funcionrio criado com sucesso",description:R,variant:"success"})}await j(),l(!1),m(null)}catch(U){n({title:"Erro ao salvar funcionrio",description:U.message||String(U),variant:"destructive"})}finally{x(!1)}},I=async R=>{try{if(!(e?.id||e?.codigo_empresa))return;const D=o[0]?.id;if(R.id===D){n({title:"Ao no permitida",description:"No  possvel desativar o primeiro funcionrio.",variant:"destructive"});return}if(r?.id&&R.id===r.id){n({title:"Ao no permitida",description:"Voc no pode desativar o seu prprio usurio.",variant:"destructive"});return}if(o.filter(z=>z.status==="active").length<=1){n({title:"Ao no permitida",description:"Deve haver pelo menos um funcionrio ativo.",variant:"destructive"});return}const{error:U}=await fe.from("colaboradores").update({ativo:!1}).eq("id",R.id);if(U)throw U;n({title:"Funcionrio desativado",description:R.name}),await j()}catch(D){n({title:"Erro ao desativar",description:D.message||String(D),variant:"destructive"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-full flex flex-col",children:a.jsxs(Pr.div,{variants:Oot,initial:"hidden",animate:"visible",children:[a.jsxs(Pr.div,{variants:Moe,className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Gesto de Equipe"}),a.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"Controle de funcionrios, permisses e logs."})]}),a.jsxs(ce,{onClick:A,disabled:!t||!e?.codigo_empresa,title:t?e?.codigo_empresa?"":"Empresa sem cdigo. Defina o cdigo da empresa antes.":"Aguardando autenticao...",children:[a.jsx(ro,{className:"mr-2 h-4 w-4"})," Novo Funcionrio"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsx(WE,{icon:ml,title:"Total",value:_.total,color:"text-brand"}),a.jsx(WE,{icon:que,title:"Ativos",value:_.active,color:"text-success"}),a.jsx(WE,{icon:Lue,title:"Desativados",value:_.inactive,color:"text-danger"})]}),a.jsx(Pr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar por nome ou cargo...",className:"pl-9",value:v,onChange:R=>g(R.target.value)})]})}),a.jsx("div",{className:"md:hidden p-4 space-y-3",children:C.length===0?a.jsx("div",{className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."}):C.map((R,D)=>a.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",onClick:()=>E(R),children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",children:R.name}),a.jsx("p",{className:"text-sm text-text-muted mt-0.5",children:R.role})]}),a.jsx("span",{className:mr("inline-flex px-2 py-0.5 rounded-full text-xs font-semibold flex-shrink-0",R.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:R.status==="active"?"Ativo":"Inativo"})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx(ce,{variant:"outline",size:"sm",onClick:U=>{U.stopPropagation(),E(R)},className:"flex-1",children:"Ver Detalhes"}),a.jsx(ce,{variant:"outline",size:"sm",onClick:U=>{U.stopPropagation(),F(R)},children:a.jsx(fl,{className:"h-3 w-3"})}),a.jsxs(ob,{children:[a.jsx(sb,{asChild:!0,children:a.jsx(ce,{variant:"outline",size:"sm",onClick:U=>U.stopPropagation(),children:a.jsx(IF,{className:"h-3 w-3"})})}),a.jsx(nx,{align:"end",children:a.jsx(dl,{className:"text-danger",disabled:D===0||o.filter(U=>U.status==="active").length<=1||r?.id&&R.id===r.id,onClick:U=>{U.stopPropagation(),I(R)},children:"Desativar"})})]})]})]},R.id))}),a.jsx("div",{className:"hidden md:block",children:a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Funcionrio"}),a.jsx(qn,{children:"Cargo"}),a.jsx(qn,{children:"Status"}),a.jsx(qn,{className:"w-[80px] text-center",children:"Aes"})]})}),a.jsxs(il,{children:[C.length===0&&a.jsx(Wa,{children:a.jsx(Sn,{colSpan:4,className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."})}),C.map((R,D)=>a.jsxs(Wa,{className:"cursor-pointer",onClick:()=>E(R),children:[a.jsx(Sn,{className:"font-medium",children:a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("span",{children:R.name})})}),a.jsx(Sn,{children:R.role}),a.jsx(Sn,{children:a.jsx("span",{className:mr("px-2 py-1 text-xs font-semibold rounded-full",R.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:R.status==="active"?"Ativo":"Inativo"})}),a.jsx(Sn,{className:"text-center",children:a.jsxs(ob,{children:[a.jsx(sb,{asChild:!0,children:a.jsx(ce,{variant:"ghost",className:"h-8 w-8 p-0 mx-auto",onClick:U=>U.stopPropagation(),children:a.jsx(IF,{className:"h-4 w-4"})})}),a.jsxs(nx,{align:"end",children:[a.jsx(dl,{onClick:U=>{U.stopPropagation(),E(R)},children:"Ver Detalhes"}),a.jsx(dl,{onClick:U=>{U.stopPropagation(),F(R)},children:"Editar"}),a.jsx(dl,{className:"text-danger",disabled:D===0||o.filter(U=>U.status==="active").length<=1||r?.id&&R.id===r.id,onClick:U=>{U.stopPropagation(),I(R)},children:"Desativar"})]})]})})]},R.id))]})]})})]})})]})}),a.jsx(Dot,{open:i,onOpenChange:l,member:h,onSave:M,loading:y}),a.jsx(Tot,{open:c,onOpenChange:d,member:u,onEdit:P})]})}const Rot="v2.0.0";function bm({title:e,icon:t,children:r,className:n="",collapsible:o=!1,defaultOpen:s=!0}){return o?a.jsx("div",{className:`bg-surface rounded-lg border border-border shadow-sm ${n}`,children:a.jsxs("details",{className:"group",open:s,children:[a.jsxs("summary",{className:"list-none cursor-pointer select-none p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t&&a.jsx(t,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"text-base font-semibold",children:e})]}),a.jsx("span",{className:"text-xs text-text-secondary group-open:rotate-180 transition-transform",children:""})]}),a.jsx("div",{className:"px-4 pb-4",children:r})]})}):a.jsxs("div",{className:`bg-surface rounded-lg border border-border shadow-sm p-4 ${n}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t&&a.jsx(t,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"text-base font-semibold",children:e})]}),r]})}function wm({label:e,value:t}){return a.jsxs("div",{className:"flex items-center justify-between gap-3 py-1 text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:e}),a.jsx("span",{className:"font-medium truncate",children:t||""})]})}function Lot(){const{userProfile:e,company:t,authReady:r,loading:n}=So();Ls();const[o,s]=p.useState("Agenda"),[i,l]=p.useState("Mdia"),[c,d]=p.useState(""),[u,f]=p.useState(""),[h,m]=p.useState(!0),[v,g]=p.useState(()=>window.__installPrompt||null),[y,x]=p.useState(!1),[b,w]=p.useState(!1),[j,_]=p.useState(!1),[C,E]=p.useState("unknown"),A="Fluxo7 Arena",P="fluxo7team@gmail.com",F="https://wa.me/5534998936088",M="tel:+5534998936088",I="+55 (34) 99893-6088";p.useEffect(()=>{try{const Q=window.matchMedia("(pointer:fine)"),pe=()=>m(Q.matches);return pe(),Q.addEventListener?.("change",pe),()=>Q.removeEventListener?.("change",pe)}catch{m(!0)}},[]),p.useEffect(()=>{const Q=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;w(Q);const pe=navigator.userAgent;pe.includes("Chrome")&&!pe.includes("Edg")?E("chrome"):pe.includes("Edg")?E("edge"):pe.includes("Firefox")?E("firefox"):pe.includes("Safari")&&!pe.includes("Chrome")?E("safari"):E("other"),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&x(!0),window.__installPrompt&&!v&&g(window.__installPrompt);const be=()=>{x(!0),g(null),_(!1)};return window.addEventListener("appinstalled",be),()=>{window.removeEventListener("appinstalled",be)}},[v]);const R=async()=>{if(v)try{await v.prompt();const{outcome:Q}=await v.userChoice;Q==="accepted"?(x(!0),_(!1)):_(!0),g(null),window.__installPrompt=null}catch(Q){console.error("Erro ao mostrar prompt de instalao:",Q),_(!0)}else _(!0)},D=()=>{navigator.share?navigator.share({title:"F7 Arena",text:"Adicione F7 Arena  sua tela inicial",url:window.location.href}).catch(()=>{alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)}):alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)},U=p.useMemo(()=>{try{return{empresa:t?.nome||t?.fantasia||t?.razao_social||t?.razaoSocial||t?.displayName||t?.codigo_empresa||"",usuario:e?.nome||e?.name||e?.email||"",dataHora:new Date().toLocaleString("pt-BR")}}catch{return{empresa:"",usuario:"",dataHora:new Date().toLocaleString("pt-BR")}}},[t?.nome,t?.fantasia,t?.razao_social,t?.razaoSocial,t?.displayName,t?.codigo_empresa,e?.nome,e?.name,e?.email]),z=p.useMemo(()=>[`[${A} - Suporte]`,`Assunto: ${c||"(sem assunto)"} `,`Categoria: ${o} `,`Severidade: ${i}`,"","Descrio:",(u||"(adicione uma descrio detalhada, passos para reproduzir, prints se possvel)")+`
`," Dados ",`Empresa: ${U.empresa}`,`Usurio: ${U.usuario}`,`Data e Hora: ${U.dataHora}`].join(`
`),[c,o,i,u,U]),H=`${F}?text=${encodeURIComponent(z)}`,q=`mailto:${P}?subject=${encodeURIComponent(`[Suporte] ${c||"Assunto"}`)}&body=${encodeURIComponent(z)}`;return a.jsxs("div",{className:"px-4 md:px-6 lg:px-8 py-4 md:py-6",children:[a.jsxs("div",{className:"bg-surface rounded-xl border border-border p-5 md:p-6 mb-6",children:[a.jsxs("div",{className:"flex items-start md:items-center justify-between gap-4 flex-col md:flex-row",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand/10 border border-brand/30 flex items-center justify-center",children:a.jsx(BH,{className:"w-5 h-5 text-brand"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"Suporte"}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Precisa de ajuda? Fale com a gente ou consulte as respostas rpidas abaixo."})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center",children:a.jsx(jc,{className:"w-6 h-6 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-base md:text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),a.jsxs("div",{className:"text-xs text-text-secondary mt-1",children:["Verso ",Rot]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[a.jsx(bm,{title:"Status",icon:N2,children:a.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[a.jsx(wm,{label:"Empresa",value:U.empresa}),a.jsx(wm,{label:"Usurio",value:`${U.usuario}`})]})}),a.jsx(bm,{title:"Fale com a gente",icon:qP,children:a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("a",{href:F,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[a.jsx(qP,{className:"w-4 h-4"})," WhatsApp"]}),a.jsxs("a",{href:`mailto:${P}`,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(vx,{className:"w-4 h-4"})," E-mail"]}),a.jsxs("a",{href:M,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(Bb,{className:"w-4 h-4"})," ",h?I:"Telefone"]})]})}),!y&&b&&a.jsx(bm,{title:"Adicionar  Tela Inicial",icon:zP,children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-sm text-text-secondary",children:"Crie um atalho do F7 Arena na sua tela inicial para acesso rpido."}),a.jsxs("button",{onClick:D,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[a.jsx(TF,{className:"w-4 h-4"})," Criar Atalho"]}),a.jsxs("details",{className:"text-xs text-text-muted",children:[a.jsx("summary",{className:"cursor-pointer hover:text-text-secondary",children:"Como fazer manualmente?"}),a.jsxs("div",{className:"mt-2 space-y-1 pl-2",children:[a.jsxs("p",{children:["1. Toque no boto ",a.jsx(TF,{className:"inline w-3 h-3"})," (Compartilhar)"]}),a.jsx("p",{children:'2. Role para baixo e toque em "Adicionar  Tela de Incio"'}),a.jsx("p",{children:'3. Toque em "Adicionar"'})]})]})]})}),!y&&!b&&a.jsx(bm,{title:"Instalar Aplicativo",icon:zP,children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm text-text-secondary",children:"Instale o F7 Arena no seu dispositivo para acesso rpido e experincia completa de aplicativo."}),a.jsxs("button",{onClick:R,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[a.jsx(ms,{className:"w-4 h-4"})," Instalar App"]}),a.jsx("p",{className:"text-xs text-text-muted text-center",children:"Pode demorar alguns segundos. Se no aparecer nada, veja as instrues no tutorial."})]})}),y&&a.jsx(bm,{title:"Aplicativo Instalado",icon:N2,children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-success",children:[a.jsx(N2,{className:"w-4 h-4"}),a.jsx("span",{children:"F7 Arena est instalado no seu dispositivo!"})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-2 space-y-3",children:a.jsx(bm,{title:"Perguntas Frequentes (FAQ)",children:a.jsxs("div",{className:"divide-y divide-border/60",children:[a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como abrir comanda de balco?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o caixa antes. A tela de balco utiliza uma comanda sem mesa (mesa_id nulo). Se no existir, o sistema cria ao abrir o balco; caso o caixa esteja fechado, a abertura da comanda  bloqueada."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Por que no consigo fechar o caixa?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"O fechamento  bloqueado se houver comandas com itens em aberto (inclui balco e mesas). Finalize ou feche as comandas pendentes antes de encerrar o caixa."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como adicionar participantes no agendamento?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"No modal de agendamento, selecione um ou mais clientes. Aps salvar, o chip de pagamentos  atualizado imediatamente. Se no visualizar, recarregue os dados da agenda."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ver o histrico completo do cliente?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o cliente e utilize o Histrico Recente, que combina comandas e agendamentos em uma nica timeline com totais e status."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ajustar estoque mnimo e ver mais vendidos?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Na aba de Produtos voc pode gerenciar estoque, preos e relatrios. Utilize filtros e exportaes para anlise."})]})]})})}),a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"space-y-3 lg:sticky lg:top-6",children:[a.jsx(bm,{title:"Reportar um problema",icon:mue,collapsible:!0,defaultOpen:!1,children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Categoria"}),a.jsxs("select",{value:o,onChange:Q=>s(Q.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[a.jsx("option",{children:"Agenda"}),a.jsx("option",{children:"Vendas"}),a.jsx("option",{children:"Clientes"}),a.jsx("option",{children:"Produtos"}),a.jsx("option",{children:"Financeiro"}),a.jsx("option",{children:"Outros"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Severidade"}),a.jsxs("select",{value:i,onChange:Q=>l(Q.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[a.jsx("option",{children:"Baixa"}),a.jsx("option",{children:"Mdia"}),a.jsx("option",{children:"Alta"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Assunto"}),a.jsx("input",{value:c,onChange:Q=>d(Q.target.value),placeholder:"Ex.: Erro ao salvar agendamento",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Descrio"}),a.jsx("textarea",{value:u,onChange:Q=>f(Q.target.value),rows:4,placeholder:"Descreva o que aconteceu, passos para reproduzir, expectativa.",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border resize-y"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 pt-1",children:[a.jsxs("a",{href:H,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[a.jsx(qP,{className:"w-4 h-4"})," Enviar no WhatsApp"]}),a.jsxs("a",{href:q,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(vx,{className:"w-4 h-4"})," Enviar por E-mail"]}),a.jsxs("a",{href:M,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(Bb,{className:"w-4 h-4"})," ",h?I:"Ligar agora"]})]})]})}),a.jsx(bm,{title:"Diagnstico",icon:yue,children:a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsx(wm,{label:"Empresa",value:U.empresa}),a.jsx(wm,{label:"Usurio",value:`${U.usuario}`}),a.jsx(wm,{label:"Data/Hora",value:U.dataHora}),a.jsx(wm,{label:"Canal - WhatsApp",value:"(34) 99893-6088"}),a.jsx(wm,{label:"Canal - E-mail",value:"fluxo7team@gmail.com"}),a.jsx(wm,{label:"Canal - Telefone",value:"(34) 99893-6088"})]})})]})})]}),a.jsx(xn,{open:j,onOpenChange:_,children:a.jsxs(vn,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[a.jsx(pn,{children:a.jsxs(fn,{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-brand/10 border border-brand/30 flex items-center justify-center",children:a.jsx(ms,{className:"w-6 h-6 text-brand"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Como Instalar o F7 Arena"}),a.jsx("p",{className:"text-sm text-text-secondary font-normal",children:"Siga as instrues para o seu navegador"})]})]})}),a.jsxs("div",{className:"mt-6 space-y-6",children:[(C==="chrome"||C==="edge")&&a.jsxs("div",{className:"bg-gradient-to-br from-brand/10 to-brand/5 rounded-xl p-6 border-2 border-brand/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand flex items-center justify-center",children:a.jsx(vue,{className:"w-6 h-6 text-black"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Chrome (Celular)"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"1"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",a.jsx("span",{className:"text-2xl",children:""})]}),a.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"No canto superior direito da tela"}),a.jsx("div",{className:"bg-background/50 rounded-md p-3 border border-border/50",children:a.jsx("p",{className:"text-xs text-text-muted",children:" Os 3 pontinhos ficam ao lado da barra de endereo"})})]})]})}),a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"2"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),a.jsxs("div",{className:"space-y-2 mb-3",children:[a.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar aplicativo"'})}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[a.jsx("div",{className:"h-px bg-border flex-1"}),a.jsx("span",{children:"OU"}),a.jsx("div",{className:"h-px bg-border flex-1"})]}),a.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Toque em qualquer uma dessas opes no menu"})]})]})}),a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"3"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold mb-2",children:"Confirme a instalao"}),a.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Aparecer uma janela perguntando se deseja instalar"}),a.jsx("div",{className:"bg-success/10 rounded-md p-3 border border-success/30",children:a.jsx("p",{className:"text-sm font-medium text-center",children:' Toque em "Instalar"'})})]})]})}),a.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[a.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),a.jsx("p",{className:"text-xs text-text-secondary",children:"O app aparecer na sua tela inicial e voc poder abri-lo como qualquer outro aplicativo!"})]})]})]}),C==="firefox"&&a.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-orange-500/5 rounded-xl p-6 border-2 border-orange-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500 flex items-center justify-center",children:a.jsx(Mue,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Firefox (Celular)"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"1"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",a.jsx("span",{className:"text-2xl",children:""})]}),a.jsx("p",{className:"text-sm text-text-secondary",children:"No canto inferior direito da tela"})]})]})}),a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"2"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar"'})}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[a.jsx("div",{className:"h-px bg-border flex-1"}),a.jsx("span",{children:"OU"}),a.jsx("div",{className:"h-px bg-border flex-1"})]}),a.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]})]})]})}),a.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[a.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),a.jsx("p",{className:"text-xs text-text-secondary",children:"O app ser adicionado  sua tela inicial!"})]})]})]}),(C==="safari"||C==="other")&&a.jsxs("div",{className:"bg-gradient-to-br from-purple-500/10 to-purple-500/5 rounded-xl p-6 border-2 border-purple-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500 flex items-center justify-center",children:a.jsx(zP,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Outros Navegadores"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Instrues gerais"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[a.jsx("p",{className:"font-semibold mb-3",children:"Procure no menu do navegador:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:a.jsx("p",{className:"font-medium",children:' "Instalar aplicativo"'})}),a.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:a.jsx("p",{className:"font-medium",children:' "Adicionar  tela inicial"'})}),a.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:a.jsx("p",{className:"font-medium",children:' "Criar atalho"'})})]})]}),a.jsx("div",{className:"bg-background/50 rounded-lg p-4 border border-border/50",children:a.jsx("p",{className:"text-sm text-text-muted",children:" Geralmente a opo est no menu de 3 pontos ou 3 linhas do navegador"})})]})]}),a.jsxs("div",{className:"bg-brand/5 rounded-lg p-4 border border-brand/20",children:[a.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[a.jsx(N2,{className:"w-5 h-5 text-brand"}),"Benefcios do App Instalado"]}),a.jsxs("ul",{className:"space-y-1.5 text-sm text-text-secondary",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Acesso rpido direto da rea de trabalho ou menu iniciar"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Funciona em tela cheia, sem barras do navegador"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Notificaes e atualizaes automticas"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Melhor desempenho e experincia de uso"]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2.5 rounded-md bg-surface-2 hover:bg-surface text-text-primary font-medium transition",children:"Entendi"})})]})]})})]})}function Roe(e,t,r,n,o){n=n||{};var s=1.15,i=o.internal.scaleFactor,l=o.internal.getFontSize()/i,c=o.getLineHeightFactor?o.getLineHeightFactor():s,d=l*c,u=/\r\n|\r|\n/g,f="",h=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(u):e,h=f.length||1),r+=l*(2-s),n.valign==="middle"?r-=h/2*d:n.valign==="bottom"&&(r-=h*d),n.halign==="center"||n.halign==="right"){var m=l;if(n.halign==="center"&&(m*=.5),f&&h>=1){for(var v=0;v<f.length;v++)o.text(f[v],t-o.getStringUnitWidth(f[v])*m,r),r+=d;return o}t-=o.getStringUnitWidth(e)*m}return n.halign==="justify"?o.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):o.text(e,t,r),o}var MU={},sx=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:MU=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,o,s;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),l=i.fontStyle,c=i.fontName;if(t.font&&(c=t.font),t.fontStyle){l=t.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=e.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=e.unifyColor(t.textColor),u&&(o=this.jsPDFDocument).setTextColor.apply(o,u),u=e.unifyColor(t.lineColor),u&&(s=this.jsPDFDocument).setDrawColor.apply(s,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,o,s){return this.jsPDFDocument.rect(t,r,n,o,s)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return MU||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),JT=function(e,t){return JT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},JT(e,t)};function Loe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");JT(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Foe=function(e){Loe(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function Fot(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function $ot(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function AS(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],o=n.map(function(s){return r.getTextWidth(s)}).reduce(function(s,i){return Math.max(s,i)},0);return o}function $oe(e,t,r,n){var o=t.settings.tableLineWidth,s=t.settings.tableLineColor;e.applyStyles({lineWidth:o,lineColor:s});var i=Boe(o,!1);i&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,i)}function Boe(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function tP(e,t){var r,n,o,s;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(o=e.right)!==null&&o!==void 0?o:t,bottom:(s=e.bottom)!==null&&s!==void 0?s:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function qoe(e,t){var r=tP(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function Bot(e,t,r,n,o){var s={},i=1.3333333333333333,l=HE(t,function(w){return o.getComputedStyle(w).backgroundColor});l!=null&&(s.fillColor=l);var c=HE(t,function(w){return o.getComputedStyle(w).color});c!=null&&(s.textColor=c);var d=zot(n,r);d&&(s.cellPadding=d);var u="borderTopColor",f=i*r,h=n.borderTopWidth;if(n.borderBottomWidth===h&&n.borderRightWidth===h&&n.borderLeftWidth===h){var m=(parseFloat(h)||0)/f;m&&(s.lineWidth=m)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},s.lineWidth.top||(s.lineWidth.right?u="borderRightColor":s.lineWidth.bottom?u="borderBottomColor":s.lineWidth.left&&(u="borderLeftColor"));var v=HE(t,function(w){return o.getComputedStyle(w)[u]});v!=null&&(s.lineColor=v);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(s.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(s.valign=n.verticalAlign);var y=parseInt(n.fontSize||"");isNaN(y)||(s.fontSize=y/i);var x=qot(n);x&&(s.fontStyle=x);var b=(n.fontFamily||"").toLowerCase();return e.indexOf(b)!==-1&&(s.font=b),s}function qot(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function HE(e,t){var r=zoe(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var o=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],s=parseInt(n[4]);return s===0||isNaN(o[0])||isNaN(o[1])||isNaN(o[2])?null:o}function zoe(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:zoe(e.parentElement,t):r}function zot(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),o=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,s=r.map(function(l){return parseInt(l||"0")/n}),i=tP(s,0);return o>i.top&&(i.top=o),o>i.bottom&&(i.bottom=o),i}function Uoe(e,t,r,n,o){var s,i;n===void 0&&(n=!1),o===void 0&&(o=!1);var l;typeof t=="string"?l=r.document.querySelector(t):l=t;var c=Object.keys(e.getFontList()),d=e.scaleFactor(),u=[],f=[],h=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:u,body:f,foot:h};for(var m=0;m<l.rows.length;m++){var v=l.rows[m],g=(i=(s=v?.parentElement)===null||s===void 0?void 0:s.tagName)===null||i===void 0?void 0:i.toLowerCase(),y=Uot(c,d,r,v,n,o);y&&(g==="thead"?u.push(y):g==="tfoot"?h.push(y):f.push(y))}return{head:u,body:f,foot:h}}function Uot(e,t,r,n,o,s){for(var i=new Foe(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(o||d.display!=="none"){var u=void 0;s&&(u=Bot(e,c,t,d,r)),i.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:Vot(c)})}}var f=r.getComputedStyle(n);if(i.length>0&&(o||f.display!=="none"))return i}function Vot(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Wot(e,t,r){for(var n=0,o=[e,t,r];n<o.length;n++){var s=o[n];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function kf(e,t,r,n,o){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),i=1;i<arguments.length;i++){var l=arguments[i];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(s[c]=l[c])}return s}function OR(e,t){var r=new sx(e),n=r.getDocumentOptions(),o=r.getGlobalOptions();Wot(o,n,t);var s=kf({},o,n,t),i;typeof window<"u"&&(i=window);var l=Hot(o,n,t),c=Got(o,n,t),d=Kot(r,s),u=Yot(r,s,i);return{id:t.tableId,content:u,hooks:c,styles:l,settings:d}}function Hot(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},o=function(c){if(c==="columnStyles"){var d=e[c],u=t[c],f=r[c];n.columnStyles=kf({},d,u,f)}else{var h=[e,t,r],m=h.map(function(v){return v[c]||{}});n[c]=kf({},m[0],m[1],m[2])}},s=0,i=Object.keys(n);s<i.length;s++){var l=i[s];o(l)}return n}function Got(e,t,r){for(var n=[e,t,r],o={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,i=n;s<i.length;s++){var l=i[s];l.didParseCell&&o.didParseCell.push(l.didParseCell),l.willDrawCell&&o.willDrawCell.push(l.willDrawCell),l.didDrawCell&&o.didDrawCell.push(l.didDrawCell),l.willDrawPage&&o.willDrawPage.push(l.willDrawPage),l.didDrawPage&&o.didDrawPage.push(l.didDrawPage)}return o}function Kot(e,t){var r,n,o,s,i,l,c,d,u,f,h,m,v=tP(t.margin,40/e.scaleFactor()),g=(r=Xot(e,t.startY))!==null&&r!==void 0?r:v.top,y;t.showFoot===!0?y="everyPage":t.showFoot===!1?y="never":y=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var x;t.showHead===!0?x="everyPage":t.showHead===!1?x="never":x=(o=t.showHead)!==null&&o!==void 0?o:"everyPage";var b=(s=t.useCss)!==null&&s!==void 0?s:!1,w=t.theme||(b?"plain":"striped"),j=!!t.horizontalPageBreak,_=(i=t.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(l=t.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:b,theme:w,startY:g,margin:v,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=t.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:x,showFoot:y,tableLineWidth:(f=t.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(h=t.tableLineColor)!==null&&h!==void 0?h:200,horizontalPageBreak:j,horizontalPageBreakRepeat:_,horizontalPageBreakBehaviour:(m=t.horizontalPageBreakBehaviour)!==null&&m!==void 0?m:"afterAllRows"}}function Xot(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),o=e.pageNumber(),s=!1;if(r&&r.startPageNumber){var i=r.startPageNumber+r.pageNumber-1;s=i===o}return typeof t=="number"?t:(t==null||t===!1)&&s&&r?.finalY!=null?r.finalY+20/n:null}function Yot(e,t,r){var n=t.head||[],o=t.body||[],s=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(r){var l=Uoe(e,t.html,r,i,t.useCss)||{};n=l.head||n,o=l.body||n,s=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||Jot(n,o,s);return{columns:c,head:n,body:o,foot:s}}function Jot(e,t,r){var n=e[0]||t[0]||r[0]||[],o=[];return Object.keys(n).filter(function(s){return s!=="_element"}).forEach(function(s){var i=1,l;Array.isArray(n)?l=n[parseInt(s)]:l=n[s],typeof l=="object"&&!Array.isArray(l)&&(i=l?.colSpan||1);for(var c=0;c<i;c++){var d=void 0;Array.isArray(n)?d=o.length:d=s+(c>0?"_".concat(c):"");var u={dataKey:d};o.push(u)}}),o}var ES=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),Voe=function(e){Loe(t,e);function t(r,n,o,s,i,l){var c=e.call(this,r,n,l)||this;return c.cell=o,c.row=s,c.column=i,c.section=s.section,c}return t}(ES),Woe=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,o,s,i){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new Voe(t,this,n,o,s,i),f=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,o=this.hooks.didDrawPage;n<o.length;n++){var s=o[n];s(new ES(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,o=this.hooks.willDrawPage;n<o.length;n++){var s=o[n];s(new ES(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(o,s){return o+s.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),TR=function(){function e(t,r,n,o,s){s===void 0&&(s=!1),this.height=0,this.raw=t,t instanceof Foe&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=o,this.spansMultiplePages=s}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,o){var s;return Math.max(n,((s=r.cells[o.index])===null||s===void 0?void 0:s.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var o=r.cells[n.index];return o?o.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(o,s){var i=n.cells[s.index];if(!i)return 0;var l=r.getLineHeight(i.styles.fontSize),c=i.padding("vertical"),d=c+l;return d>o?d:o},0)},e}(),DR=function(){function e(t,r,n){var o;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var s=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,s=(o=t.content)!==null&&o!==void 0?o:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var i=s!=null?""+s:"",l=/\r\n|\r|\n/g;this.text=i.split(l)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var o=this.width-this.padding("horizontal");n=this.x+o/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,o=this.styles.fontSize/t*r,s=n*o+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=tP(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),Hoe=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,o=t.allRows();n<o.length;n++){var s=o[n],i=s.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(r=Math.max(r,i.styles.cellWidth))}return r},e}();function Qot(e,t){Zot(e,t);var r=[],n=0;t.columns.forEach(function(s){var i=s.getMaxCustomCellWidth(t);i?s.width=i:(s.width=s.wrappedWidth,r.push(s)),n+=s.width});var o=t.getWidth(e.pageSize().width)-n;o&&(o=QT(r,o,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),o&&(o=QT(r,o,function(s){return s.minWidth})),o=Math.abs(o),!t.settings.horizontalPageBreak&&o>.1/e.scaleFactor()&&(o=o<1?o:Math.round(o),console.warn("Of the table content, ".concat(o," units width could not fit page"))),tst(t),rst(t,e),est(t)}function Zot(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,o=qoe(e,t);t.allRows().forEach(function(s){for(var i=0,l=t.columns;i<l.length;i++){var c=l[i],d=s.cells[c.index];if(d){var u=t.hooks.didParseCell;t.callCellHooks(e,u,d,s,c,null);var f=d.padding("horizontal");d.contentWidth=AS(d.text,d.styles,e)+f;var h=AS(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,e);if(d.minReadableWidth=h+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>o?(d.minWidth=o,d.wrappedWidth=o):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var m=10/r;d.minWidth=d.styles.minCellWidth||m,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),t.allRows().forEach(function(s){for(var i=0,l=t.columns;i<l.length;i++){var c=l[i],d=s.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},f=u.cellWidth||u.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function QT(e,t,r){for(var n=t,o=e.reduce(function(m,v){return m+v.wrappedWidth},0),s=0;s<e.length;s++){var i=e[s],l=i.wrappedWidth/o,c=n*l,d=i.width+c,u=r(i),f=d<u?u:d;t-=f-i.width,i.width=f}if(t=Math.round(t*1e10)/1e10,t){var h=e.filter(function(m){return t<0?m.width>r(m):!0});h.length&&(t=QT(h,t,r))}return t}function est(e){for(var t={},r=1,n=e.allRows(),o=0;o<n.length;o++)for(var s=n[o],i=0,l=e.columns;i<l.length;i++){var c=l[i],d=t[c.index];if(r>1)r--,delete s.cells[c.index];else if(d)d.cell.height+=s.height,r=d.cell.colSpan,delete s.cells[c.index],d.left--,d.left<=1&&delete t[c.index];else{var u=s.cells[c.index];if(!u)continue;if(u.height=s.height,u.rowSpan>1){var f=n.length-o,h=u.rowSpan>f?f:u.rowSpan;t[c.index]={cell:u,left:h,row:s}}}}}function tst(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],o=null,s=0,i=0,l=0;l<e.columns.length;l++){var c=e.columns[l];if(i-=1,i>1&&e.columns[l+1])s+=c.width,delete n.cells[c.index];else if(o){var d=o;delete n.cells[c.index],o=null,d.width=c.width+s}else{var d=n.cells[c.index];if(!d)continue;if(i=d.colSpan,s=0,d.colSpan>1){o=d,s+=c.width;continue}d.width=c.width+s}}}function rst(e,t){for(var r={count:0,height:0},n=0,o=e.allRows();n<o.length;n++){for(var s=o[n],i=0,l=e.columns;i<l.length;i++){var c=l[i],d=s.cells[c.index];if(d){t.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=t.splitTextToSize(d.text,u+1/t.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=RU(d.text,u,d.styles,t,"...");else if(d.styles.overflow==="hidden")d.text=RU(d.text,u,d.styles,t,"");else if(typeof d.styles.overflow=="function"){var f=d.styles.overflow(d.text,u);typeof f=="string"?d.text=[f]:d.text=f}d.contentHeight=d.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var h=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<h*d.rowSpan?r={height:h,count:d.rowSpan}:r&&r.count>0&&r.height>h&&(h=r.height),h>s.height&&(s.height=h)}}r.count--}}function RU(e,t,r,n,o){return e.map(function(s){return nst(s,t,r,n,o)})}function nst(e,t,r,n,o){var s=1e4*n.scaleFactor();if(t=Math.ceil(t*s)/s,t>=AS(e,r,n))return e;for(;t<AS(e+o,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+o}function MR(e,t){var r=new sx(e),n=ast(t,r.scaleFactor()),o=new Woe(t,n);return Qot(r,o),r.applyStyles(r.userStyles),o}function ast(e,t){var r=e.content,n=sst(r.columns);if(r.head.length===0){var o=LU(n,"head");o&&r.head.push(o)}if(r.foot.length===0){var o=LU(n,"foot");o&&r.foot.push(o)}var s=e.settings.theme,i=e.styles;return{columns:n,head:GE("head",r.head,n,i,s,t),body:GE("body",r.body,n,i,s,t),foot:GE("foot",r.foot,n,i,s,t)}}function GE(e,t,r,n,o,s){var i={},l=t.map(function(c,d){for(var u=0,f={},h=0,m=0,v=0,g=r;v<g.length;v++){var y=g[v];if(i[y.index]==null||i[y.index].left===0)if(m===0){var x=void 0;Array.isArray(c)?x=c[y.index-h-u]:x=c[y.dataKey];var b={};typeof x=="object"&&!Array.isArray(x)&&(b=x?.styles||{});var w=ist(e,y,d,o,n,s,b),j=new DR(x,w,e);f[y.dataKey]=j,f[y.index]=j,m=j.colSpan-1,i[y.index]={left:j.rowSpan-1,times:m}}else m--,h++;else i[y.index].left--,m=i[y.index].times,u++}return new TR(c,d,e,f)});return l}function LU(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var o=ost(t,n.raw);o!=null&&(r[n.dataKey]=o)}}),Object.keys(r).length>0?r:null}function ost(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function sst(e){return e.map(function(t,r){var n,o;return typeof t=="object"?o=(n=t.dataKey)!==null&&n!==void 0?n:r:o=r,new Hoe(o,t,r)})}function ist(e,t,r,n,o,s,i){var l=$ot(n),c;e==="head"?c=o.headStyles:e==="body"?c=o.bodyStyles:e==="foot"&&(c=o.footStyles);var d=kf({},l.table,l[e],o.styles,c),u=o.columnStyles[t.dataKey]||o.columnStyles[t.index]||{},f=e==="body"?u:{},h=e==="body"&&r%2===0?kf({},l.alternateRow,o.alternateRowStyles):{},m=Fot(s),v=kf({},m,d,h,f);return kf(v,i)}function lst(e,t,r){var n;r===void 0&&(r={});var o=qoe(e,t),s=new Map,i=[],l=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(h){var m=t.columns.find(function(v){return v.dataKey===h||v.index===h});m&&!s.has(m.index)&&(s.set(m.index,!0),i.push(m.index),l.push(t.columns[m.index]),o-=m.wrappedWidth)});for(var d=!0,u=(n=r?.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(s.has(u)){u++;continue}var f=t.columns[u].wrappedWidth;if(d||o>=f)d=!1,i.push(u),l.push(t.columns[u]),o-=f;else break;u++}return{colIndexes:i,columns:l,lastIndex:u-1}}function cst(e,t){for(var r=[],n=0;n<t.columns.length;n++){var o=lst(e,t,{start:n});o.columns.length&&(r.push(o),n=o.lastIndex)}return r}function RR(e,t){var r=t.settings,n=r.startY,o=r.margin,s={x:o.left,y:n},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=n+o.bottom+i;if(r.pageBreak==="avoid"){var c=t.body,d=c.reduce(function(h,m){return h+m.height},0);l+=d}var u=new sx(e);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(Koe(u),s.y=o.top),t.callWillDrawPageHooks(u,s);var f=kf({},s);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?dst(u,t,f,s):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(h){return Yf(u,t,h,s,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(h,m){var v=m===t.body.length-1;kS(u,t,h,v,f,s,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(h){return Yf(u,t,h,s,t.columns)})),$oe(u,t,f,s),t.callEndPageHooks(u,s),t.finalY=s.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function dst(e,t,r,n){var o=cst(e,t),s=t.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")o.forEach(function(d,u){e.applyStyles(e.userStyles),u>0?yb(e,t,r,n,d.columns,!0):FU(e,t,n,d.columns),ust(e,t,r,n,d.columns),KE(e,t,n,d.columns)});else for(var i=-1,l=o[0],c=function(){var d=i;if(l){e.applyStyles(e.userStyles);var u=l.columns;i>=0?yb(e,t,r,n,u,!0):FU(e,t,n,u),d=$U(e,t,i+1,n,u),KE(e,t,n,u)}var f=d-i;o.slice(1).forEach(function(h){e.applyStyles(e.userStyles),yb(e,t,r,n,h.columns,!0),$U(e,t,i+1,n,h.columns,f),KE(e,t,n,h.columns)}),i=d};i<t.body.length-1;)c()}function FU(e,t,r,n){var o=t.settings;e.applyStyles(e.userStyles),(o.showHead==="firstPage"||o.showHead==="everyPage")&&t.head.forEach(function(s){return Yf(e,t,s,r,n)})}function ust(e,t,r,n,o){e.applyStyles(e.userStyles),t.body.forEach(function(s,i){var l=i===t.body.length-1;kS(e,t,s,l,r,n,o)})}function $U(e,t,r,n,o,s){e.applyStyles(e.userStyles),s=s??t.body.length;var i=Math.min(r+s,t.body.length),l=-1;return t.body.slice(r,i).forEach(function(c,d){var u=r+d===t.body.length-1,f=Goe(e,t,u,n);c.canEntireRowFit(f,o)&&(Yf(e,t,c,n,o),l=r+d)}),l}function KE(e,t,r,n){var o=t.settings;e.applyStyles(e.userStyles),(o.showFoot==="lastPage"||o.showFoot==="everyPage")&&t.foot.forEach(function(s){return Yf(e,t,s,r,n)})}function fst(e,t,r){var n=r.getLineHeight(e.styles.fontSize),o=e.padding("vertical"),s=Math.floor((t-o)/n);return Math.max(0,s)}function mst(e,t,r,n){var o={};e.spansMultiplePages=!0,e.height=0;for(var s=0,i=0,l=r.columns;i<l.length;i++){var c=l[i],d=e.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new DR(d.raw,d.styles,d.section);u=kf(u,d),u.text=[];var f=fst(d,t,n);d.text.length>f&&(u.text=d.text.splice(f,d.text.length));var h=n.scaleFactor(),m=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(h,m),d.contentHeight>=t&&(d.contentHeight=t,u.styles.minCellHeight-=t),d.contentHeight>e.height&&(e.height=d.contentHeight),u.contentHeight=u.getContentHeight(h,m),u.contentHeight>s&&(s=u.contentHeight),o[c.index]=u}}var v=new TR(e.raw,-1,e.section,o,!0);v.height=s;for(var g=0,y=r.columns;g<y.length;g++){var c=y[g],u=v.cells[c.index];u&&(u.height=v.height);var d=e.cells[c.index];d&&(d.height=e.height)}return v}function hst(e,t,r,n){var o=e.pageSize().height,s=n.settings.margin,i=s.top+s.bottom,l=o-i;t.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,e),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=t.hasRowSpan(n.columns),f=t.getMaxCellHeight(n.columns)>l;return f?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function kS(e,t,r,n,o,s,i){var l=Goe(e,t,n,s);if(r.canEntireRowFit(l,i))Yf(e,t,r,s,i);else if(hst(e,r,l,t)){var c=mst(r,l,t,e);Yf(e,t,r,s,i),yb(e,t,o,s,i),kS(e,t,c,n,o,s,i)}else yb(e,t,o,s,i),kS(e,t,r,n,o,s,i)}function Yf(e,t,r,n,o){n.x=t.settings.margin.left;for(var s=0,i=o;s<i.length;s++){var l=i[s],c=r.cells[l.index];if(!c){n.x+=l.width;continue}e.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=t.callCellHooks(e,t.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}pst(e,c,n);var u=c.getTextPos();Roe(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function pst(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var o=Boe(n.lineWidth,n.fillColor);o&&e.rect(t.x,r.y,t.width,t.height,o)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),gst(e,t,r,n.lineWidth))}function gst(e,t,r,n){var o,s,i,l;n.top&&(o=r.x,s=r.y,i=r.x+t.width,l=r.y,n.right&&(i+=.5*n.right),n.left&&(o-=.5*n.left),c(n.top,o,s,i,l)),n.bottom&&(o=r.x,s=r.y+t.height,i=r.x+t.width,l=r.y+t.height,n.right&&(i+=.5*n.right),n.left&&(o-=.5*n.left),c(n.bottom,o,s,i,l)),n.left&&(o=r.x,s=r.y,i=r.x,l=r.y+t.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,o,s,i,l)),n.right&&(o=r.x+t.width,s=r.y,i=r.x+t.width,l=r.y+t.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,o,s,i,l));function c(d,u,f,h,m){e.getDocument().setLineWidth(d),e.getDocument().line(u,f,h,m,"S")}}function Goe(e,t,r,n){var o=t.settings.margin.bottom,s=t.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(o+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-o}function yb(e,t,r,n,o,s){o===void 0&&(o=[]),s===void 0&&(s=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!s&&t.foot.forEach(function(l){return Yf(e,t,l,n,o)}),t.callEndPageHooks(e,n);var i=t.settings.margin;$oe(e,t,r,n),Koe(e),t.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(l){return Yf(e,t,l,n,o)}),e.applyStyles(e.userStyles))}function Koe(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function Xoe(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],o=OR(this,n),s=MR(this,o);return RR(this,s),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,o){Roe(t,r,n,o,this)},e.API.autoTableSetDefaults=function(t){return sx.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){sx.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var o=new sx(this),s=Uoe(o,t,window,r,!1),i=s.head,l=s.body,c=((n=i[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var XE;function BU(e,t){var r=OR(e,t),n=MR(e,r);RR(e,n)}function vst(e,t){var r=OR(e,t);return MR(e,r)}function xst(e,t){RR(e,t)}try{if(typeof window<"u"&&window){var qU=window,zU=qU.jsPDF||((XE=qU.jspdf)===null||XE===void 0?void 0:XE.jsPDF);zU&&Xoe(zU)}}catch(e){console.error("Could not apply autoTable plugin",e)}const yst=Object.freeze(Object.defineProperty({__proto__:null,Cell:DR,CellHookData:Voe,Column:Hoe,HookData:ES,Row:TR,Table:Woe,__createTable:vst,__drawTable:xst,applyPlugin:Xoe,autoTable:BU,default:BU},Symbol.toStringTag,{value:"Module"})),bst={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.08,delayChildren:.1}}},al={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function bj({icon:e,label:t,value:r,delta:n,positive:o=!0,color:s="brand"}){return a.jsxs(Pr.div,{variants:al,className:"fx-card border-0 ring-0 outline-none shadow-none",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[a.jsx(e,{className:`w-4 h-4 text-${s}`}),a.jsx("span",{children:t})]}),n!=null&&a.jsxs("div",{className:`text-xs font-bold ${o?"text-success":"text-danger"}`,children:[o?"+":"",n]})]}),a.jsx("div",{className:"text-3xl font-bold text-text-primary tabular-nums",children:r})]})}function wst(){const{toast:e}=no(),{userProfile:t}=So(),[r,n]=QS(),[o,s]=p.useState(r.get("tab")||"visao-geral"),[i,l]=p.useState(!1),[c,d]=p.useState(()=>{const re=new Date;return new Date(re.getFullYear(),re.getMonth(),1).toISOString().slice(0,10)}),[u,f]=p.useState(()=>new Date().toISOString().slice(0,10)),[h,m]=p.useState(null),[v,g]=p.useState(0),[y,x]=p.useState(0),[b,w]=p.useState([]),[j,_]=p.useState([]),[C,E]=p.useState([]),[A,P]=p.useState([]),[F,M]=p.useState([]),[I,R]=p.useState(0),[D,U]=p.useState(0),[z,H]=p.useState(!1),[q,Q]=p.useState(!1),[pe,be]=p.useState(null),[V,B]=p.useState([]),[J,ue]=p.useState(!1),[Ne,Z]=p.useState(!1),[ge,le]=p.useState(!1),[se,ee]=p.useState(null),[de,Le]=p.useState([]),[ae,ie]=p.useState([]);p.useState({open:!1,tipo:"suprimento",valor:"",observacao:"",loading:!1});const[dt,At]=p.useState(!1),[st,ut]=p.useState(!1),[Rt,Nt]=p.useState(null),[tt,he]=p.useState([]),[ke,et]=p.useState(""),[Me,$e]=p.useState("all"),[Be,we]=p.useState("all"),[He,ht]=p.useState([]),[zt,hr]=p.useState(""),[Mt,Qt]=p.useState("all"),[Se,kt]=p.useState("all"),[Lt,fr]=p.useState(new Set),[yr,Xt]=p.useState(!1),[nr,ir]=p.useState(!1),[Ee,qe]=p.useState(null),[Ge,Qe]=p.useState([]),[St,pt]=p.useState(!1),[Et,mt]=p.useState([]);p.useState("");const gt=re=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(re||0)),ft=re=>Number(re||0).toFixed(2),Dt=async(re,Te,ot,te)=>{try{const{default:T}=await zu(()=>Promise.resolve().then(()=>JQe),void 0);await zu(()=>Promise.resolve().then(()=>yst),void 0);const O=new T("p","mm","a4"),X=O.internal.pageSize.getWidth();if(O.setFontSize(20),O.setTextColor(245,158,11),O.text(re,14,20),O.setDrawColor(245,158,11),O.setLineWidth(.5),O.line(14,23,X-14,23),O.setFontSize(10),O.setTextColor(100,100,100),O.text(`Perodo: ${c||"N/A"} at ${u||"N/A"}`,14,30),O.text(`Gerado em: ${new Date().toLocaleString("pt-BR")}`,14,35),typeof O.autoTable=="function"){O.autoTable({head:[Te],body:ot,startY:42,theme:"striped",headStyles:{fillColor:[245,158,11],textColor:[255,255,255],fontStyle:"bold",fontSize:11},bodyStyles:{fontSize:10,textColor:[50,50,50]},alternateRowStyles:{fillColor:[249,249,249]},margin:{top:42,left:14,right:14}});const G=O.lastAutoTable.finalY||50;O.setFontSize(8),O.setTextColor(150,150,150),O.text("Relatrio gerado por Fluxo7Arena - Sistema de Gesto de Quadras Esportivas",X/2,G+15,{align:"center"})}else{let G=45;O.setFontSize(11),O.setTextColor(0,0,0),Te.forEach((L,Re)=>{const rt=14+Re*60;O.text(L,rt,G)}),G+=7,O.setFontSize(10),ot.forEach(L=>{L.forEach((Re,rt)=>{const lt=14+rt*60;O.text(String(Re),lt,G)}),G+=6})}O.save(`${te}_${dr(new Date,"yyyy-MM-dd")}.pdf`),e({title:"PDF baixado com sucesso!",description:"O arquivo foi salvo na sua pasta de downloads"})}catch(T){console.error("Erro ao gerar PDF:",T),e({title:"Erro ao gerar PDF",description:T.message,variant:"destructive"})}},Ft=async()=>{try{const re=["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"],Te=(ae||[]).map(ot=>[ot?.aberto_em?new Date(ot.aberto_em).toLocaleString("pt-BR"):"-",ot?.fechado_em?new Date(ot.fechado_em).toLocaleString("pt-BR"):"-",gt(ot?.saldo_inicial||0),ot?.saldo_final!=null?gt(ot.saldo_final):gt(0),ot?.valor_final_dinheiro!=null?gt(ot.valor_final_dinheiro):"",ot?.diferenca_dinheiro!=null?gt(ot.diferenca_dinheiro):"",String(ot?.status||"").toUpperCase()]);await Dt("Fechamentos de Caixa",re,Te,"fechamentos_caixa")}catch(re){e({title:"Erro ao exportar PDF",description:re?.message||"Tente novamente",variant:"destructive"})}},ye=()=>{try{const re=";",ot=[["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"].join(re)];(ae||[]).forEach(X=>{const G=X?.aberto_em?new Date(X.aberto_em).toLocaleString("pt-BR"):"-",L=X?.fechado_em?new Date(X.fechado_em).toLocaleString("pt-BR"):"-",Re=Number(X?.saldo_inicial||0).toFixed(2).replace(".",","),rt=(X?.saldo_final!=null?Number(X.saldo_final):0).toFixed(2).replace(".",","),lt=X?.valor_final_dinheiro!=null?Number(X.valor_final_dinheiro):null,$t=X?.diferenca_dinheiro!=null?Number(X.diferenca_dinheiro):null,Fe=String(X?.status||"").toUpperCase();ot.push([G,L,Re,rt,lt!=null?lt.toFixed(2).replace(".",","):"",$t!=null?$t.toFixed(2).replace(".",","):"",Fe].join(re))});const te=new Blob(["\uFEFF"+ot.join(`
`)],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(te),O=document.createElement("a");O.href=T,O.download=`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(T),e({title:"CSV baixado com sucesso!"})}catch(re){e({title:"Erro ao exportar CSV",description:re?.message||"Tente novamente",variant:"destructive"})}},wt=({cx:re,cy:Te,midAngle:ot,outerRadius:te,percent:T})=>{const O=Math.PI/180,X=(te||0)+12,G=re+X*Math.cos(-ot*O),L=Te+X*Math.sin(-ot*O);return a.jsx("text",{x:G,y:L,fill:"#fff",textAnchor:G>re?"start":"end",dominantBaseline:"central",style:{pointerEvents:"none",fontSize:15,fontWeight:700},children:`${Math.round((T||0)*100)}%`})},Yt=re=>{const Te=at!=null&&at!==re;return{transition:"opacity 320ms ease-in-out, filter 320ms ease-in-out",opacity:Te?.25:1,filter:Te?"grayscale(15%)":"none",cursor:"pointer"}};p.useEffect(()=>{(async()=>{if(!nr||!Ee||Ee.origem!=="Comanda"||!Ee.comanda_id){Qe([]),mt([]);return}try{pt(!0);const Te=t?.codigo_empresa;let ot=fe.from("comanda_itens").select("descricao, quantidade, preco_unitario").eq("comanda_id",Ee.comanda_id);Te&&(ot=ot.eq("codigo_empresa",Te));const{data:te}=await ot;Qe(te||[]);let T=fe.from("pagamentos").select("id, valor, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("comanda_id",Ee.comanda_id);Te&&(T=T.eq("codigo_empresa",Te));const{data:O}=await T;mt(O||[])}catch(Te){console.warn("[Financeiro][RecebimentoModal] Falha ao carregar itens da comanda:",Te?.message),Qe([]),mt([])}finally{pt(!1)}})()},[nr,Ee,t?.codigo_empresa]);const br=async()=>{try{l(!0);const re=Er(c)||void 0,Te=ln(u)||void 0,ot=t?.codigo_empresa;console.debug("[Financeiro][VisaoGeral] Carregando com perodo:",{fromISO:re,toISO:Te,codigo:ot});const te=await hd({from:re,to:Te}).catch(()=>null);m(te||{totalPorFinalizadora:{},totalEntradas:0,totalVendasBrutas:0,totalDescontos:0,totalVendasLiquidas:0}),console.debug("[Financeiro][VisaoGeral] Resumo calculado:",te);try{let T=fe.from("pagamentos").select("valor, status").eq("codigo_empresa",ot);re&&(T=T.gte("recebido_em",re)),Te&&(T=T.lte("recebido_em",Te));const{data:O}=await T,X=(O||[]).reduce((rt,lt)=>{const $t=lt.status||"Pago";return $t==="Cancelado"||$t==="Estornado"?rt:rt+Number(lt.valor||0)},0);g(X);let G=fe.from("agendamentos").select("id").eq("codigo_empresa",ot);re&&(G=G.gte("inicio",re)),Te&&(G=G.lte("inicio",Te));const{data:L}=await G;let Re=0;if(L&&L.length>0){const rt=L.map($t=>$t.id),{data:lt}=await fe.from("agendamento_participantes").select("valor_cota, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",ot).in("agendamento_id",rt).eq("status_pagamento","Pago");Re=(lt||[]).reduce(($t,Fe)=>{let It=Number(Fe.valor_cota||0);if(Fe.aplicar_taxa===!0){const Sr=Number(Fe.finalizadoras?.taxa_percentual||0);Sr>0&&(It=It/(1+Sr/100))}return $t+It},0)}x(Re),console.debug("[Financeiro][VisaoGeral] Receitas por origem:",{totalComandas:X,totalAg:Re})}catch(T){console.warn("[Financeiro][VisaoGeral] Falha ao calcular KPIs por origem:",T?.message),g(0),x(0)}try{let T=fe.from("pagamentos").select("valor, status, origem").eq("codigo_empresa",ot).eq("origem","xml");re&&(T=T.gte("recebido_em",re)),Te&&(T=T.lte("recebido_em",Te));const{data:O}=await T,X=(O||[]).reduce((L,Re)=>["Cancelado","Estornado"].includes(Re.status)?L:L+Number(Re.valor||0),0);R(X);const{count:G}=await fe.from("produtos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",ot).or("importado_via_xml.is.true,categoria.ilike.Importados").gte("criado_em",re).lte("criado_em",Te);U(G||0)}catch(T){console.warn("[Financeiro][VisaoGeral] Falha KPIs XML:",T?.message),R(0),U(0)}if(ot){let T=fe.from("comandas").select("id").eq("status","closed");ot&&(T=T.eq("codigo_empresa",ot)),re&&(T=T.gte("fechado_em",re)),Te&&(T=T.lte("fechado_em",Te));const{data:O,error:X}=await T;if(X)throw X;const G=(O||[]).map(lt=>lt.id);console.debug("[Financeiro][VisaoGeral] Comandas fechadas:",G.length);let L=[];if(G.length>0){let lt=fe.from("comanda_itens").select("produto_id, quantidade, preco_unitario, produtos!comanda_itens_produto_id_fkey(nome)").in("comanda_id",G);ot&&(lt=lt.eq("codigo_empresa",ot));const{data:$t}=await lt;L=$t||[]}const Re={};(L||[]).forEach(lt=>{const $t=lt.produtos?.nome||"Produto sem nome",Fe=Number(lt.quantidade||0),It=Fe*Number(lt.preco_unitario||0);Re[$t]||(Re[$t]={quantidade:0,valor:0}),Re[$t].quantidade+=Fe,Re[$t].valor+=It});const rt=Object.entries(Re).map(([lt,$t])=>({nome:lt,quantidade:$t.quantidade,valor:$t.valor})).sort((lt,$t)=>$t.valor-lt.valor);E(rt),w(rt.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Produtos agregados:",{total:rt.length,top5:rt.slice(0,5)})}if(ot)try{let T=fe.from("pagamentos").select("comanda_id, valor, status").eq("codigo_empresa",ot).neq("status","Cancelado").neq("status","Estornado");re&&(T=T.gte("recebido_em",re)),Te&&(T=T.lte("recebido_em",Te));const{data:O}=await T;console.debug("[Financeiro][VisaoGeral] Pagamentos carregados:",(O||[]).length);const X=Array.from(new Set((O||[]).map(Fe=>Fe.comanda_id).filter(Boolean)));let G=[];if(X.length>0){let Fe=fe.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",X).eq("codigo_empresa",ot);const{data:It}=await Fe;G=It||[]}console.debug("[Financeiro][VisaoGeral] Vinculos comanda_clientes:",G.length);const L=Array.from(new Set(G.map(Fe=>Fe.cliente_id).filter(Boolean))),Re={};if(L.length>0){const{data:Fe}=await fe.from("clientes").select("id, nome").in("id",L).eq("codigo_empresa",ot);(Fe||[]).forEach(It=>{Re[It.id]=It.nome})}const rt={};G.forEach(Fe=>{const It=Fe.nome_livre||Re[Fe.cliente_id]||`Cliente ${Fe.cliente_id||""}`;rt[Fe.comanda_id]||(rt[Fe.comanda_id]=new Set),It&&rt[Fe.comanda_id].add(It)});const lt={};(O||[]).forEach(Fe=>{const It=Array.from(rt[Fe.comanda_id]||[]),Sr=Number(Fe.valor||0);if(It.length===0){const kr="Sem cliente";lt[kr]||(lt[kr]={id:null,nome:kr,valor:0}),lt[kr].valor+=Sr}else It.forEach(kr=>{lt[kr]||(lt[kr]={id:null,nome:kr,valor:0}),lt[kr].valor+=Sr})});try{const Fe=new Map(Object.values(Re).map((En,dn)=>[Object.keys(Re)[dn],En]));let It=fe.from("v_agendamento_participantes").select("agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text");ot&&(It=It.eq("codigo_empresa",ot));let{data:Sr}=await It;Sr=Sr||[];const kr=Array.from(new Set(Sr.map(En=>En.agendamento_id).filter(Boolean)));let pr=new Set;if(kr.length>0){let En=fe.from("agendamentos").select("id, inicio").in("id",kr);ot&&(En=En.eq("codigo_empresa",ot));const{data:dn}=await En,Gr=re?new Date(re).getTime():null,ga=Te?new Date(Te).getTime():null;(dn||[]).forEach(Ma=>{const va=Ma?.inicio?new Date(Ma.inicio).getTime():null;va!=null&&(Gr==null||va>=Gr)&&(ga==null||va<=ga)&&pr.add(Ma.id)})}const yn=Sr.filter(En=>pr.has(En.agendamento_id));console.debug("[Financeiro][Agendamentos] participantes no perodo (by agendamento.inicio):",yn.length);const Xn=Array.from(new Set((yn||[]).map(En=>En.cliente_id).filter(Boolean).map(String))).filter(En=>!Fe.has(En));if(Xn.length>0){const{data:En}=await fe.from("clientes").select("id,nome").in("id",Xn);(En||[]).forEach(dn=>Fe.set(String(dn.id),dn.nome))}(yn||[]).forEach(En=>{const dn=String(En.status_pagamento||En.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(dn))return;const Gr=En.cliente_id,ga=Gr?Fe.get(String(Gr))||`Cliente ${Gr}`:null;if(!ga)return;const Ma=Number(En.valor_cota||0);lt[ga]||(lt[ga]={id:Gr||null,nome:ga,valor:0}),lt[ga].valor+=Ma})}catch{}const $t=Object.values(lt).sort((Fe,It)=>It.valor-Fe.valor);P($t),_($t.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Clientes agregados:",{total:$t.length,top5:$t.slice(0,5)})}catch(T){console.error("Erro ao carregar top clientes:",T),_([]),P([])}if(ot&&re&&Te)try{let T=fe.from("pagamentos").select("recebido_em, valor, status").eq("codigo_empresa",ot).gte("recebido_em",re).lte("recebido_em",Te).order("recebido_em",{ascending:!0});const{data:O}=await T;let X=fe.from("v_agendamentos_detalhado").select("inicio, valor_pago, status_pagamento").eq("codigo_empresa",ot).eq("status_pagamento","Pago").gte("inicio",re).lte("inicio",Te).order("inicio",{ascending:!0});const{data:G}=await X,L={};(O||[]).forEach(rt=>{if(["Cancelado","Estornado"].includes(rt.status))return;const lt=new Date(rt.recebido_em).toLocaleDateString("pt-BR");L[lt]=(L[lt]||0)+Number(rt.valor||0)}),(G||[]).forEach(rt=>{const lt=new Date(rt.inicio).toLocaleDateString("pt-BR");L[lt]=(L[lt]||0)+Number(rt.valor_pago||0)});const Re=Object.entries(L).map(([rt,lt])=>({data:rt,valor:lt})).sort((rt,lt)=>{const[$t,Fe,It]=rt.data.split("/").map(Number),[Sr,kr,pr]=lt.data.split("/").map(Number);return new Date(It,Fe-1,$t).getTime()-new Date(pr,kr-1,Sr).getTime()});M(Re),console.debug("[Financeiro][VisaoGeral] Evoluo diria:",Re.length,"dias")}catch(T){console.warn("[Financeiro][VisaoGeral] Falha ao calcular evoluo diria:",T?.message),M([])}else M([])}catch(re){e({title:"Falha ao carregar viso geral",description:re?.message||"Tente novamente",variant:"destructive"})}finally{l(!1)}},Mr=async()=>{try{const re=t?.codigo_empresa,Te=await Gm({codigoEmpresa:re});if(le(!!Te),Te){const[te,T]=await Promise.all([Mw({codigoEmpresa:re}),qp({caixaSessaoId:Te.id,codigoEmpresa:re})]);ee(te||null),Le(T||[])}else ee(null),Le([]);const ot=await Ere({limit:50,codigoEmpresa:re});if(console.log("[FinanceiroPage][loadCaixa] Histrico recebido de listarFechamentosCaixa:",ot?.length,"sesses"),ot&&ot.length>0){console.log("[FinanceiroPage][loadCaixa] Primeira sesso do histrico:",ot[0]);const te=ot.filter(T=>T.valor_final_dinheiro!=null);console.log("[FinanceiroPage][loadCaixa] Sesses com valor_final_dinheiro:",te.length,"/",ot.length)}ie(ot||[])}catch(re){e({title:"Falha ao carregar caixa",description:re?.message,variant:"destructive"})}},Nr=async()=>{try{l(!0);const re=t?.codigo_empresa,Te=Er(c)||void 0,ot=ln(u)||void 0;let te=fe.from("pagamentos").select("id, comanda_id, valor, status, metodo, recebido_em, origem, xml_chave, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("codigo_empresa",re).order("recebido_em",{ascending:!1});Te&&(te=te.gte("recebido_em",Te)),ot&&(te=te.lte("recebido_em",ot));const{data:T}=await te;let O=new Map,X=new Map;try{const lt=Array.from(new Set((T||[]).map($t=>$t.comanda_id).filter(Boolean)));if(lt.length>0){const{data:$t}=await fe.from("comandas").select("id, cliente_id, tipo").in("id",lt).eq("codigo_empresa",re),Fe=Array.from(new Set(($t||[]).map(kr=>kr.cliente_id).filter(Boolean)));let It=new Map;if(Fe.length>0){const{data:kr}=await fe.from("clientes").select("id, nome").in("id",Fe).eq("codigo_empresa",re);It=new Map((kr||[]).map(pr=>[pr.id,pr.nome]))}for(const kr of $t||[]){if(!kr)continue;const pr=It.get(kr.cliente_id)||null;O.set(kr.id,pr),X.set(kr.id,kr.tipo||null)}const Sr=($t||[]).filter(kr=>!kr?.cliente_id).map(kr=>kr.id);if(Sr.length>0)try{const{data:kr}=await fe.from("comanda_clientes").select("comanda_id, cliente_id").in("comanda_id",Sr).eq("codigo_empresa",re),pr=Array.from(new Set((kr||[]).map(yn=>yn.cliente_id).filter(Boolean)));if(pr.length>0){const{data:yn}=await fe.from("clientes").select("id, nome").in("id",pr).eq("codigo_empresa",re),In=new Map((yn||[]).map(Xn=>[Xn.id,Xn.nome]));for(const Xn of kr||[]){const En=In.get(Xn.cliente_id)||null;En&&!O.get(Xn.comanda_id)&&O.set(Xn.comanda_id,En)}}}catch{console.debug("[Financeiro][Recebimentos] comanda_clientes indisponvel (ok)")}}}catch(lt){console.warn("[Financeiro][Recebimentos] Falha ao buscar clientes de comandas:",lt?.message)}let G=fe.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, quadra_nome, participante_nome, valor_cota, status_pagamento, finalizadora_nome").eq("codigo_empresa",re).eq("status_pagamento","Pago").order("inicio",{ascending:!1});Te&&(G=G.gte("inicio",Te)),ot&&(G=G.lte("inicio",ot));const{data:L}=await G,Re=(T||[]).map(lt=>({id:lt.id,origem:X.get(lt.comanda_id||"")==="balcao"?"Balco":"Comanda",comanda_id:lt.comanda_id||null,recebido_em:lt.recebido_em,finalizadoras:lt.finalizadoras,metodo:lt.metodo,valor:lt.valor,status:lt.status,descricao:O.get(lt.comanda_id||"")||null,fonte:lt.origem||"manual",xml_chave:lt.xml_chave||null})),rt=(L||[]).map((lt,$t)=>({id:`ag-${lt.agendamento_id}-${$t}`,origem:"Agendamento",recebido_em:lt.inicio,finalizadoras:lt.finalizadora_nome?{nome:lt.finalizadora_nome}:null,metodo:lt.finalizadora_nome||null,valor:lt.valor_cota,status:lt.status_pagamento,descricao:`#${lt.agendamento_codigo} - ${lt.participante_nome} (${lt.quadra_nome||""})`,agendamento_codigo:lt.agendamento_codigo,quadra_nome:lt.quadra_nome,participante_nome:lt.participante_nome,fonte:null}));he([...Re,...rt])}catch(re){e({title:"Falha ao carregar recebimentos",description:re?.message,variant:"destructive"})}finally{l(!1)}},Rr=async()=>{try{l(!0);const re=t?.codigo_empresa,Te=Er(c)||void 0,ot=ln(u)||void 0;let te=fe.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, fim, quadra_nome, participante_nome, cliente_id, valor_cota, finalizadora_nome, status_pagamento").eq("codigo_empresa",re).order("inicio",{ascending:!1});Te&&(te=te.gte("inicio",Te)),ot&&(te=te.lte("inicio",ot));const{data:T}=await te,O=[...new Set((T||[]).map(L=>L.cliente_id).filter(Boolean))];let X={};if(O.length>0){const{data:L}=await fe.from("clientes").select("id, is_consumidor_final, codigo").in("id",O).eq("codigo_empresa",re);L&&(X=Object.fromEntries(L.map(Re=>[Re.id,Re])))}const G=(T||[]).map(L=>({...L,is_consumidor_final:X[L.cliente_id]?.is_consumidor_final||!1,cliente_codigo:X[L.cliente_id]?.codigo||null}));ht(G)}catch(re){e({title:"Falha ao carregar agendamentos",description:re?.message,variant:"destructive"})}finally{l(!1)}};p.useEffect(()=>{n({tab:o})},[o]);const Er=re=>{if(!re)return null;if(typeof re=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(re)){const[Te,ot,te]=re.split("-").map(Number);return new Date(Te,ot-1,te,0,0,0,0).toISOString()}return new Date(re).toISOString()},ln=re=>{if(!re)return null;if(typeof re=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(re)){const[Te,ot,te]=re.split("-").map(Number);return new Date(Te,ot-1,te,23,59,59,999).toISOString()}return new Date(re).toISOString()};p.useEffect(()=>{t?.codigo_empresa&&(o==="visao-geral"||o==="relatorios"?br():o==="caixa"?Mr():o==="recebimentos"?Nr():o==="agendamentos"&&Rr())},[o,c,u,t?.codigo_empresa]);const Fn=p.useMemo(()=>{const re=h?.totalPorFinalizadora||{},Te=Object.entries(re).map(([ot,te])=>({name:ot,valor:Number(te||0)}));return Te.sort((ot,te)=>te.valor-ot.valor),Te},[h]),[Hn,$n]=p.useState(null),[at,Vt]=p.useState(null),wr={start:90,end:-270},er=(re,Te,ot)=>re+(Te-re)*ot,Ze=re=>re<.5?4*re*re*re:1-Math.pow(-2*re+2,3)/2,Fr=re=>{const Te=Number(v||0),ot=Number(y||0),te=Math.max(1e-4,Te+ot),T=360*(Te/te);return re===0?{a:wr.start,b:wr.start-T}:{a:wr.start-T,b:wr.end}},[jt,_r]=p.useState({from:null,to:null,t:1}),bt=at??Hn;p.useEffect(()=>{if(bt==null)return;const re=Fr(bt);_r(O=>({from:O.to||re,to:re,t:0}));let Te;const ot=performance.now(),te=380,T=O=>{const X=Math.min(1,(O-ot)/te),G=Ze(X);_r(L=>({...L,t:G})),X<1&&(Te=requestAnimationFrame(T))};return Te=requestAnimationFrame(T),()=>Te&&cancelAnimationFrame(Te)},[bt,v,y]);const Wt=86,Zt=94,Br=80,[zr,_t]=p.useState({from:[Wt,Wt],to:[Wt,Wt],t:1});p.useEffect(()=>{const re=bt===0?[Zt,Br]:bt===1?[Br,Zt]:[Wt,Wt];_t(O=>({from:O.to||re,to:re,t:0}));let Te;const ot=performance.now(),te=380,T=O=>{const X=Math.min(1,(O-ot)/te),G=Ze(X);_t(L=>({...L,t:G})),X<1&&(Te=requestAnimationFrame(T))};return Te=requestAnimationFrame(T),()=>Te&&cancelAnimationFrame(Te)},[bt]);const Jr=({cx:re,cy:Te,outerRadius:ot})=>{if(!jt.from||!jt.to)return null;const te=er(jt.from.a,jt.to.a,jt.t),T=er(jt.from.b,jt.to.b,jt.t),O=bt===0?"#22C55E":"#F59E0B";return a.jsx(YD,{cx:re,cy:Te,innerRadius:0,outerRadius:(ot||0)+4,startAngle:te,endAngle:T,fill:O,fillOpacity:.18,stroke:"transparent"})},mn=p.useMemo(()=>{let re=tt;if(ke){const Te=ke.toLowerCase();re=re.filter(ot=>(ot.descricao||"").toLowerCase().includes(Te)||(ot.finalizadoras?.nome||"").toLowerCase().includes(Te)||String(ot.valor||"").includes(Te)||(ot.origem||"").toLowerCase().includes(Te))}return Me!=="all"&&(re=re.filter(Te=>(Te.finalizadoras?.nome||Te.metodo)===Me)),Be!=="all"&&(re=re.filter(Te=>(Te.fonte||"manual")===Be)),re},[tt,ke,Me,Be]),ma=p.useMemo(()=>{const re={};return(He||[]).forEach(Te=>{const ot=Te.agendamento_id||Te.agendamento_codigo;re[ot]||(re[ot]={agendamento_id:Te.agendamento_id,agendamento_codigo:Te.agendamento_codigo,inicio:Te.inicio,fim:Te.fim,quadra_nome:Te.quadra_nome,participantes:[],total:0,totalPago:0,totalPendente:0,statusGeral:"Pendente",representante:"",representanteClienteId:null,representanteCodigo:null,isRepresentanteConsumidor:!1}),re[ot].participantes.push(Te),re[ot].total+=Number(Te.valor_cota||0),Te.status_pagamento==="Pago"?re[ot].totalPago+=Number(Te.valor_cota||0):re[ot].totalPendente+=Number(Te.valor_cota||0)}),Object.values(re).forEach(Te=>{const ot=Te.participantes.every(T=>T.status_pagamento==="Pago");if(Te.participantes.every(T=>T.status_pagamento==="Cancelado")?Te.statusGeral="Cancelado":ot?Te.statusGeral="Pago":Te.statusGeral="Pendente",Te.participantes.length>0){let T=Te.participantes.find(X=>!X.is_consumidor_final);T||(T=Te.participantes[0]);let O=T?.participante_nome||"";T?.is_consumidor_final&&O&&(O.toLowerCase().includes("cliente consumidor")||(O=O)),Te.representante=O,Te.representanteClienteId=T?.cliente_id||null,Te.representanteCodigo=T?.is_consumidor_final?0:T?.cliente_codigo??null,Te.isRepresentanteConsumidor=T?.is_consumidor_final||!1}}),Object.values(re).sort((Te,ot)=>new Date(ot.inicio)-new Date(Te.inicio))},[He]),Nn=p.useMemo(()=>{const re=zt.toLowerCase().trim();return ma.filter(Te=>{if(Mt!=="all"&&(Mt==="Pago"&&Te.statusGeral!=="Pago"||Mt==="Pendente"&&Te.statusGeral!=="Pendente"||Mt==="Cancelado"&&Te.statusGeral!=="Cancelado")||Se!=="all"&&!Te.participantes.some(X=>X.finalizadora_nome===Se))return!1;if(!re)return!0;const ot=String(Te.agendamento_codigo||""),te=String(Te.quadra_nome||"").toLowerCase(),T=Te.participantes.map(O=>String(O.participante_nome||"").toLowerCase()).join(" ");return ot.includes(re)||te.includes(re)||T.includes(re)})},[ma,zt,Mt,Se]);return a.jsx(a.Fragment,{children:a.jsxs(Pr.div,{variants:bst,initial:"hidden",animate:"visible",className:"space-y-6",children:[a.jsx(Pr.div,{variants:al,className:"fx-card p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Financeiro"}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa das finanas da empresa"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap items-stretch sm:items-center gap-3 w-full sm:w-auto",children:[a.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[a.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Incio"}),a.jsxs(Oc,{children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[a.jsx(Ns,{className:"h-5 w-5 text-warning flex-shrink-0"}),a.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:c?dr(new Date(c+"T00:00:00"),"dd/MM/yyyy",{locale:wa}):"Selecione"})]})}),a.jsx(Hl,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:a.jsx(Gl,{mode:"single",selected:c?new Date(c+"T00:00:00"):void 0,onSelect:re=>re&&d(dr(re,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]}),a.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[a.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Fim"}),a.jsxs(Oc,{children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[a.jsx(Ns,{className:"h-5 w-5 text-warning flex-shrink-0"}),a.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:u?dr(new Date(u+"T00:00:00"),"dd/MM/yyyy",{locale:wa}):"Selecione"})]})}),a.jsx(Hl,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:a.jsx(Gl,{mode:"single",selected:u?new Date(u+"T00:00:00"):void 0,onSelect:re=>re&&f(dr(re,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]})]})]})}),a.jsxs(_c,{value:o,onValueChange:s,children:[a.jsx("div",{className:"md:hidden mb-4",children:a.jsxs(Cn,{value:o,onValueChange:s,children:[a.jsx(jn,{className:"w-full h-11 bg-black border-warning/40 text-white",children:a.jsx(An,{placeholder:"Selecione uma aba"})}),a.jsxs(_n,{className:"bg-black text-white border-warning/40",children:[a.jsx(nt,{value:"visao-geral",children:"Viso Geral"}),a.jsx(nt,{value:"caixa",children:"Caixa"}),a.jsx(nt,{value:"recebimentos",children:"Recebimentos"}),a.jsx(nt,{value:"agendamentos",children:"Agendamentos"}),a.jsx(nt,{value:"relatorios",children:"Relatrios"})]})]})}),a.jsxs(ql,{className:"hidden md:grid w-full grid-cols-5",children:[a.jsx(ca,{value:"visao-geral",children:"Viso Geral"}),a.jsx(ca,{value:"caixa",children:"Caixa"}),a.jsx(ca,{value:"recebimentos",children:"Recebimentos"}),a.jsx(ca,{value:"agendamentos",children:"Agendamentos"}),a.jsx(ca,{value:"relatorios",children:"Relatrios"})]}),a.jsxs(uo,{value:"visao-geral",className:"space-y-6 mt-6",children:[a.jsxs(Pr.div,{variants:al,className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[a.jsx(bj,{icon:HH,label:"Total Geral",value:gt(Number(v||0)+Number(y||0)),color:"brand"}),a.jsx(bj,{icon:a1,label:"Comandas",value:gt(v),color:"success"}),a.jsx(bj,{icon:Ns,label:"Agendamentos",value:gt(y),color:"success"}),a.jsx(bj,{icon:qm,label:"XML (Recebimentos)",value:gt(I),color:"success"})]}),a.jsxs(Pr.div,{variants:al,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[a.jsx(qm,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Proporo de Receita"})]})}),Number(v||0)+Number(y||0)===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem receitas no perodo."}):a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[a.jsx("div",{className:"w-full md:flex-1 h-[280px]",children:a.jsx(Hj,{width:"100%",height:"100%",children:a.jsxs(_ze,{children:[a.jsxs(Yu,{data:function(){const re=er(zr.from?.[0]??Wt,zr.to?.[0]??Wt,zr.t),Te=er(zr.from?.[1]??Wt,zr.to?.[1]??Wt,zr.t);return[{name:"Comandas",value:Number(v||0),fill:"#22C55E",outerRadius:re},{name:"Agendamentos",value:Number(y||0),fill:"#F59E0B",outerRadius:Te}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:!1,labelLine:!1,isAnimationActive:!0,animationBegin:50,animationDuration:500,startAngle:wr.start,endAngle:wr.end,activeIndex:bt,activeShape:void 0,onMouseEnter:(re,Te)=>$n(Te),onMouseLeave:()=>$n(null),onClick:(re,Te)=>{Vt(ot=>ot===Te?null:Te),$n(Te)},children:[a.jsx(ew,{fill:"#22C55E",style:Yt(0)},"c"),a.jsx(ew,{fill:"#F59E0B",style:Yt(1)},"a")]}),Jr({cx:"50%",cy:"50%",outerRadius:92}),a.jsx(Yu,{data:function(){const re=er(zr.from?.[0]??Wt,zr.to?.[0]??Wt,zr.t),Te=er(zr.from?.[1]??Wt,zr.to?.[1]??Wt,zr.t);return[{name:"Comandas",value:Number(v||0),fill:"transparent",outerRadius:re},{name:"Agendamentos",value:Number(y||0),fill:"transparent",outerRadius:Te}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:wt,labelLine:!1,isAnimationActive:!1,startAngle:wr.start,endAngle:wr.end}),a.jsx(vc,{formatter:re=>gt(re),contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 10px",color:"#fff"},labelStyle:{color:"#fff"},itemStyle:{color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.06)"}})]})})}),a.jsx("div",{className:"w-full md:w-64 space-y-3 md:pr-2",children:[{name:"Comandas",value:Number(v||0),color:"#22C55E"},{name:"Agendamentos",value:Number(y||0),color:"#F59E0B"}].map((re,Te)=>a.jsxs("div",{className:`flex items-center justify-between px-3 py-2 rounded-md transition-all duration-200 ${Hn===Te?"bg-white/5":"hover:bg-white/5"} cursor-pointer ${at!=null&&at!==Te?"opacity-60":""}`,onMouseEnter:()=>$n(Te),onMouseLeave:()=>$n(null),onClick:()=>Vt(ot=>ot===Te?null:Te),role:"button",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm",style:{backgroundColor:re.color}}),a.jsx("span",{className:"text-sm text-text-secondary",children:re.name})]}),a.jsx("div",{className:`text-sm font-semibold ${at!=null&&at!==Te?"opacity-70":""}`,children:gt(re.value)})]},re.name))})]})]}),a.jsxs(Pr.div,{variants:al,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[a.jsx(qm,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Entradas por Finalizadora"})]})}),Fn.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos no perodo."}):a.jsx("div",{className:"h-[280px]",children:a.jsx(Hj,{width:"100%",height:"100%",children:a.jsxs(jze,{data:Fn,margin:{top:8,right:8,left:8,bottom:8},children:[a.jsx(XO,{strokeDasharray:"3 3",stroke:"#333"}),a.jsx(lg,{dataKey:"name",stroke:"#aaa"}),a.jsx(cg,{stroke:"#aaa",tickFormatter:re=>gt(re),width:80}),a.jsx(vc,{formatter:re=>gt(re),labelFormatter:re=>`Finalizadora: ${re}`,contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 12px",color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.1)"}}),a.jsx(Lp,{}),a.jsx(Ag,{dataKey:"valor",name:"Valor",fill:"#fbbf24"})]})})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[a.jsxs(Pr.div,{variants:al,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>H(!0),children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[a.jsx(_d,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Produtos mais vendidos"}),C.length>5&&a.jsx(ce,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>H(!0),children:"Ver todos"})]}),b.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):a.jsx("div",{className:"space-y-2",children:b.map((re,Te)=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border last:border-0",children:[a.jsxs("span",{className:"text-sm text-text-primary",children:[Te+1,". ",re.nome]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-text-secondary",children:gt(re.valor)}),a.jsxs("span",{className:"text-sm font-bold text-brand",children:["x",re.quantidade]})]})]},Te))})]}),a.jsxs(Pr.div,{variants:al,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>Q(!0),children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[a.jsx(ml,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Clientes (por valor pago)"}),A.length>5&&a.jsx(ce,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>Q(!0),children:"Ver todos"})]}),j.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):a.jsx("div",{className:"space-y-2",children:j.map((re,Te)=>a.jsxs("button",{className:"w-full flex items-center justify-between py-2 border-b border-border last:border-0 hover:bg-surface-2 rounded-sm px-2 text-left",onClick:()=>{be(re),Q(!0)},children:[a.jsxs("span",{className:"text-sm text-text-primary",children:[Te+1,". ",re.nome]}),a.jsx("span",{className:"text-sm font-bold text-success",children:gt(re.valor)})]},Te))})]})]})]}),a.jsx(uo,{value:"agendamentos",className:"space-y-6 mt-6",children:a.jsxs(Pr.div,{variants:al,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:"Agendamentos (Pagamentos por Participante)"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar (#cdigo, participante, quadra)",value:zt,onChange:re=>hr(re.target.value),className:"pl-10 pr-10 w-full md:w-[260px] bg-black border-warning/40 text-white placeholder:text-white/60"}),a.jsxs(Oc,{open:yr,onOpenChange:Xt,children:[a.jsx(Tc,{asChild:!0,children:a.jsx(ce,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7 p-0 hover:bg-warning/20",title:"Selecionar cliente",children:a.jsx("svg",{className:"h-4 w-4 text-warning",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})}),a.jsx(Hl,{className:"w-[280px] p-2 bg-surface border-border",align:"end",children:a.jsxs("div",{className:"space-y-1 max-h-[300px] overflow-y-auto",children:[a.jsx("div",{className:"text-xs font-semibold text-text-secondary px-2 py-1 sticky top-0 bg-surface z-10",children:"Selecionar Cliente"}),(()=>{const re=new Map;He.forEach(ot=>{const te=ot.participante_nome;te&&!re.has(te)&&re.set(te,{nome:te,codigo:ot.cliente_codigo||0,is_consumidor:ot.is_consumidor_final||!1})});const Te=Array.from(re.values()).sort((ot,te)=>ot.is_consumidor!==te.is_consumidor?ot.is_consumidor?1:-1:ot.nome.localeCompare(te.nome));return Te.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-4",children:"Nenhum participante encontrado"}):Te.map((ot,te)=>a.jsxs("button",{onClick:()=>{hr(ot.nome),Xt(!1)},className:"w-full flex items-center gap-2 px-2 py-2 hover:bg-surface-2 rounded text-left transition-colors",children:[a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-5 px-1 rounded text-[10px] font-bold ${ot.codigo===0?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",ot.codigo]}),a.jsx("span",{className:"text-sm text-text-primary flex-1 truncate",children:ot.nome})]},te))})()]})})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[a.jsxs(Cn,{value:Mt,onValueChange:Qt,children:[a.jsx(jn,{className:"w-full md:w-[170px] h-9 bg-black border-warning/40 text-white",children:a.jsx(An,{placeholder:"Todos os Status"})}),a.jsxs(_n,{className:"bg-black text-white border-warning/40",children:[a.jsx(nt,{value:"all",children:"Todos os Status"}),a.jsx(nt,{value:"Pago",children:"Pago"}),a.jsx(nt,{value:"Pendente",children:"Pendente"}),a.jsx(nt,{value:"Cancelado",children:"Cancelado"})]})]}),a.jsxs(Cn,{value:Se,onValueChange:kt,children:[a.jsx(jn,{className:"w-full md:w-[220px] h-9 bg-black border-warning/40 text-white",children:a.jsx(An,{placeholder:"Todas as Finalizadoras"})}),a.jsxs(_n,{className:"bg-black text-white border-warning/40",children:[a.jsx(nt,{value:"all",children:"Todas as Finalizadoras"}),[...new Set((He||[]).map(re=>re.finalizadora_nome).filter(Boolean))].map(re=>a.jsx(nt,{value:re,children:re},re))]})]})]}),a.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>{try{const re=";",ot=[["Data","Horrio","Cdigo","Representante","Quadra","Participantes","Total","Pago","Pendente","Status"].join(re)];Nn.forEach(Re=>{const rt=Re.inicio?new Date(Re.inicio).toLocaleDateString("pt-BR"):"",lt=Re.inicio&&Re.fim?`${new Date(Re.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}-${new Date(Re.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:"",$t=Re.participantes.length,Fe=Re.participantes.filter(pr=>pr.status_pagamento==="Pago").length,It=Re.participantes.filter(pr=>pr.status_pagamento==="Pendente").length,Sr=String(ft(Re.total)).replace(".",","),kr=[rt,lt,Re.agendamento_codigo??"",(Re.representante??"").replace(/"/g,'""'),(Re.quadra_nome??"").replace(/"/g,'""'),$t,Sr,Fe,It,Re.statusGeral??""].map(pr=>`"${pr}"`).join(re);ot.push(kr)});const te="\uFEFF"+ot.join(`
`),T=new Blob([te],{type:"text/csv;charset=utf-8;"}),O=URL.createObjectURL(T),X=document.createElement("a");X.href=O;const G=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"",L=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"";X.download=`agendamentos_${G}_a_${L}.csv`,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(O),e({title:"CSV exportado com sucesso!"})}catch(re){e({title:"Falha ao exportar CSV",description:re?.message,variant:"destructive"})}},children:[a.jsx(ms,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),i?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),a.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):Nn.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"w-12"}),a.jsx(qn,{children:"Data/Hora"}),a.jsx(qn,{children:"Cdigo"}),a.jsx(qn,{children:"Representante"}),a.jsx(qn,{children:"Quadra"}),a.jsx(qn,{className:"text-right",children:"Participantes"}),a.jsx(qn,{className:"text-right",children:"Total"}),a.jsx(qn,{children:"Status"})]})}),a.jsx(il,{children:Nn.map(re=>{const Te=Lt.has(re.agendamento_id||re.agendamento_codigo);return a.jsxs(_e.Fragment,{children:[a.jsxs(Wa,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{const ot=re.agendamento_id||re.agendamento_codigo;fr(te=>{const T=new Set(te);return T.has(ot)?T.delete(ot):T.add(ot),T})},children:[a.jsx(Sn,{children:a.jsx("div",{className:`transition-transform ${Te?"rotate-90":""}`,children:""})}),a.jsx(Sn,{children:re.inicio?a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-text-secondary",children:new Date(re.inicio).toLocaleDateString("pt-BR")}),a.jsxs("span",{className:"font-medium",children:[new Date(re.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),re.fim&&` - ${new Date(re.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`]})]}):""}),a.jsxs(Sn,{className:"font-semibold",children:["#",re.agendamento_codigo||""]}),a.jsx(Sn,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[re.representanteCodigo!==null&&re.representanteCodigo!==void 0&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[32px] h-6 px-1.5 rounded text-xs font-bold ${re.representanteCodigo===0||re.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",re.representanteCodigo]}),a.jsx("span",{className:"text-text-primary",children:re.representante||""})]})}),a.jsx(Sn,{children:re.quadra_nome||""}),a.jsx(Sn,{className:"text-right",children:re.participantes.length}),a.jsx(Sn,{className:"text-right font-semibold",children:gt(re.total)}),a.jsx(Sn,{children:a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${re.statusGeral==="Pago"?"bg-success/20 text-success":re.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:re.statusGeral==="Parcial"?"Pendente":re.statusGeral})})]}),Te&&re.participantes.map((ot,te)=>{const T=ot.is_consumidor_final?0:ot.cliente_codigo??null;return a.jsxs(Wa,{className:"bg-surface-2/30 hover:bg-surface-2/50 transition-colors",children:[a.jsx(Sn,{}),a.jsx(Sn,{colSpan:2}),a.jsx(Sn,{className:"pl-8 text-sm text-text-secondary",children:a.jsxs("div",{className:"flex items-center gap-2",children:[T!=null&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${T===0||T==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",T]}),a.jsx("span",{children:ot.participante_nome||""})]})}),a.jsx(Sn,{className:"text-sm text-text-secondary",children:ot.finalizadora_nome||""}),a.jsx(Sn,{}),a.jsx(Sn,{className:"text-right text-sm font-medium",children:gt(ot.valor_cota)}),a.jsx(Sn,{className:"text-sm",children:a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs ${ot.status_pagamento==="Pago"?"bg-success/20 text-success":ot.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:ot.status_pagamento||"Pendente"})})]},`${re.agendamento_codigo}-${te}`)})]},re.agendamento_id||re.agendamento_codigo)})})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:Nn.map(re=>{const Te=Lt.has(re.agendamento_id||re.agendamento_codigo);return a.jsxs("div",{className:"bg-surface-2 rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"p-4 cursor-pointer",onClick:()=>{const ot=re.agendamento_id||re.agendamento_codigo;fr(te=>{const T=new Set(te);return T.has(ot)?T.delete(ot):T.add(ot),T})},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`transition-transform text-text-secondary ${Te?"rotate-90":""}`,children:""}),a.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["#",re.agendamento_codigo||""]})]}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${re.statusGeral==="Pago"?"bg-success/20 text-success":re.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:re.statusGeral==="Parcial"?"Pendente":re.statusGeral})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Data:"}),a.jsx("span",{className:"text-text-primary",children:re.inicio?new Date(re.inicio).toLocaleDateString("pt-BR"):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Horrio:"}),a.jsx("span",{className:"text-text-primary font-medium",children:re.inicio&&re.fim?`${new Date(re.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})} - ${new Date(re.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:""})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Representante:"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[re.representanteCodigo!==null&&re.representanteCodigo!==void 0&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${re.representanteCodigo===0||re.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",re.representanteCodigo]}),a.jsx("span",{className:"text-text-primary font-medium",children:re.representante||""})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Quadra:"}),a.jsx("span",{className:"text-text-primary font-medium",children:re.quadra_nome||""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),a.jsx("span",{className:"text-text-primary",children:re.participantes.length})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[a.jsx("span",{className:"text-text-secondary",children:"Total:"}),a.jsx("span",{className:"font-bold text-lg text-success",children:gt(re.total)})]})]})]}),Te&&a.jsx("div",{className:"border-t border-border/50 bg-surface-2/20",children:re.participantes.map((ot,te)=>{const T=ot.is_consumidor_final?0:ot.cliente_codigo??null;return a.jsxs("div",{className:"px-4 py-3 border-b border-border/30 last:border-b-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[T!=null&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-4 px-1 rounded text-[9px] font-bold ${T===0||T==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",T]}),a.jsx("div",{className:"font-medium text-sm",children:ot.participante_nome||""})]}),a.jsx("div",{className:`text-xs px-2 py-0.5 rounded-full ${ot.status_pagamento==="Pago"?"bg-success/20 text-success":ot.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:ot.status_pagamento||"Pendente"})]}),a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-text-secondary",children:ot.finalizadora_nome||""}),a.jsx("span",{className:"font-semibold text-success",children:gt(ot.valor_cota)})]})]},te)})})]},re.agendamento_id||re.agendamento_codigo)})})]})]})}),a.jsx(uo,{value:"caixa",className:"space-y-6 mt-6",children:a.jsxs(Pr.div,{variants:al,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[a.jsx("h3",{className:"text-base font-bold",children:"Fechamentos Anteriores"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ce,{variant:"outline",size:"sm",onClick:ye,children:[a.jsx(ms,{className:"h-4 w-4 mr-2"})," CSV"]}),a.jsxs(ce,{variant:"outline",size:"sm",onClick:Ft,children:[a.jsx(Lg,{className:"h-4 w-4 mr-2"})," PDF"]})]})]}),ae.length===0?a.jsx("div",{className:"text-sm text-text-secondary",children:"Nenhum fechamento encontrado."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Aberto em"}),a.jsx(qn,{children:"Fechado em"}),a.jsx(qn,{className:"text-right",children:"Saldo Inicial"}),a.jsx(qn,{className:"text-right",children:"Saldo Final (contado)"}),a.jsx(qn,{children:"Status"})]})}),a.jsxs(il,{children:[(()=>{console.log("[FinanceiroPage][Render] Renderizando histrico, total de sesses:",ae.length);const re=ae.filter(Te=>Te.valor_final_dinheiro!=null);return console.log("[FinanceiroPage][Render] Sesses com valor_final_dinheiro no render:",re.length),ae.length>0&&console.log("[FinanceiroPage][Render] Primeira sesso no array history:",ae[0]),null})(),ae.map(re=>a.jsxs(Wa,{className:"cursor-pointer hover:bg-surface-2",onClick:async()=>{At(!0),ut(!0),Nt(null);try{const Te=t?.codigo_empresa,ot=typeof performance<"u"&&performance.now?performance.now():Date.now();console.log("[Caixa][Fechamento][Open]",{sessaoId:re.id,from:re.aberto_em,to:re.fechado_em,codigo:Te});let te=await cS({caixaSessaoId:re.id,codigoEmpresa:Te}),O=(yn=>{if(!yn)return null;if(yn.total_bruto!=null||yn.por_finalizadora!=null){let In=yn.por_finalizadora;if(In&&typeof In=="string")try{In=JSON.parse(In)}catch{In={}}return{from:yn.periodo_de||null,to:yn.periodo_ate||null,totalPorFinalizadora:In||{},totalEntradas:Number(yn.total_entradas||0),totalVendasBrutas:Number(yn.total_bruto||0),totalDescontos:Number(yn.total_descontos||0),totalVendasLiquidas:Number(yn.total_liquido||0)}}return yn})(te);O||(console.log("[Caixa][Fechamento] Snapshot ausente, calculando resumo por perodo..."),O=await hd({from:re.aberto_em,to:re.fechado_em||new Date().toISOString(),codigoEmpresa:Te}));const X={...re,saldo_inicial:te&&typeof te.saldo_inicial<"u"?Number(te.saldo_inicial):re.saldo_inicial,saldo_final:te&&typeof te.saldo_final<"u"?Number(te.saldo_final):re.saldo_final};if(!O||!O.totalPorFinalizadora||Object.keys(O.totalPorFinalizadora).length===0)try{const yn=re.aberto_em,In=re.fechado_em||new Date().toISOString();let Xn=fe.from("pagamentos").select("metodo, valor, status, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",yn).lte("recebido_em",In);Te&&(Xn=Xn.eq("codigo_empresa",Te));const{data:En}=await Xn,dn={};let Gr=0;for(const ga of En||[]){if(!((ga.status||"Pago")!=="Cancelado"&&(ga.status||"Pago")!=="Estornado"))continue;const va=ga.finalizadoras?.nome||ga.metodo||"Outros",$a=Number(ga.valor||0);dn[va]=(dn[va]||0)+$a,Gr+=$a}O={...O||{},totalPorFinalizadora:dn,totalEntradas:Number(O?.totalEntradas||0)||Gr},console.log("[Caixa][Fechamento][FallbackPF]",{methods:Object.keys(dn).length})}catch{}const L=await qp({caixaSessaoId:re.id,codigoEmpresa:Te}),Re=te&&te.movimentos?te.movimentos:null,rt=re.aberto_em,lt=re.fechado_em||new Date().toISOString();let $t=fe.from("pagamentos").select("id, valor, status, metodo, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",rt).lte("recebido_em",lt).order("recebido_em",{ascending:!1});Te&&($t=$t.eq("codigo_empresa",Te));const{data:Fe}=await $t;console.log("[Caixa][Fechamento][Pays]",{count:(Fe||[]).length});const It=te&&typeof te.valor_final_dinheiro<"u"?Number(te.valor_final_dinheiro):null;Nt({resumo:O,movimentacoes:L,movimentosAgg:Re,pagamentos:Fe||[],sessao:X,valorFinalContado:It});const Sr=typeof performance<"u"&&performance.now?performance.now():Date.now(),kr=Array.isArray(L)?L.length:0,pr=O&&O.totalPorFinalizadora?Object.keys(O.totalPorFinalizadora).length:0;console.log("[Caixa][Fechamento][Loaded]",{sessaoId:re.id,finCount:pr,movCount:kr,ms:Math.round(Sr-ot)})}catch(Te){console.error("[Caixa][Fechamento][Error]",{sessaoId:re.id,message:Te?.message,code:Te?.code}),e({title:"Falha ao carregar fechamento",description:Te?.message||"Tente novamente",variant:"destructive"})}finally{ut(!1)}},children:[a.jsx(Sn,{children:re.aberto_em?new Date(re.aberto_em).toLocaleString("pt-BR"):""}),a.jsx(Sn,{children:re.fechado_em?new Date(re.fechado_em).toLocaleString("pt-BR"):""}),a.jsx(Sn,{className:"text-right",children:gt(re.saldo_inicial)}),a.jsx(Sn,{className:"text-right",children:re.valor_final_dinheiro!=null?gt(re.valor_final_dinheiro):""}),a.jsx(Sn,{children:String(re.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]},re.id))]})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:ae.map(re=>a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:async()=>{At(!0),ut(!0),Nt(null);try{const Te=t?.codigo_empresa;let ot=await cS({caixaSessaoId:re.id,codigoEmpresa:Te}),T=(Re=>{if(!Re)return null;if(Re.total_bruto!=null||Re.por_finalizadora!=null){let rt=Re.por_finalizadora;if(rt&&typeof rt=="string")try{rt=JSON.parse(rt)}catch{rt={}}return{from:Re.periodo_de||null,to:Re.periodo_ate||null,totalPorFinalizadora:rt||{},totalEntradas:Number(Re.total_entradas||0),totalVendasBrutas:Number(Re.total_bruto||0),totalDescontos:Number(Re.total_descontos||0),totalVendasLiquidas:Number(Re.total_liquido||0)}}return Re})(ot);T||(T=await hd({from:re.aberto_em,to:re.fechado_em||new Date().toISOString(),codigoEmpresa:Te}));const O={...re,saldo_inicial:ot&&typeof ot.saldo_inicial<"u"?Number(ot.saldo_inicial):re.saldo_inicial,saldo_final:ot&&typeof ot.saldo_final<"u"?Number(ot.saldo_final):re.saldo_final},X=await qp({caixaSessaoId:re.id,codigoEmpresa:Te}),G=ot&&ot.movimentos?ot.movimentos:null,L=ot&&typeof ot.valor_final_dinheiro<"u"?Number(ot.valor_final_dinheiro):null;Nt({resumo:T,movimentacoes:X,movimentosAgg:G,sessao:O,pagamentos:[],valorFinalContado:L})}catch(Te){console.error("[Caixa][Fechamento][Error]",Te),e({title:"Erro ao carregar detalhes",description:Te?.message,variant:"destructive"})}finally{ut(!1)}},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["Sesso #",re.id]}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${re.status==="fechado"?"bg-success/20 text-success":"bg-warning/20 text-warning"}`,children:String(re.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Aberto em:"}),a.jsx("span",{className:"text-text-primary",children:re.aberto_em?new Date(re.aberto_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Fechado em:"}),a.jsx("span",{className:"text-text-primary",children:re.fechado_em?new Date(re.fechado_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Saldo Inicial:"}),a.jsx("span",{className:"font-semibold text-info",children:gt(re.saldo_inicial)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Saldo Final (contado):"}),a.jsx("span",{className:"font-semibold text-success",children:re.valor_final_dinheiro!=null?gt(re.valor_final_dinheiro):""})]})]}),a.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},re.id))})]})]})}),a.jsx(uo,{value:"recebimentos",className:"space-y-6 mt-6",children:a.jsxs(Pr.div,{variants:al,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:"Todos os Recebimentos"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar...",value:ke,onChange:re=>et(re.target.value),className:"pl-10 w-full md:w-[200px]"})]}),a.jsxs(Cn,{value:Be,onValueChange:we,children:[a.jsx(jn,{className:"w-full md:w-[160px] h-9 bg-black border-warning/40 text-white",children:a.jsx(An,{placeholder:"Todas as Fontes"})}),a.jsxs(_n,{className:"bg-black text-white border-warning/40",children:[a.jsx(nt,{value:"all",children:"Todas as Fontes"}),a.jsx(nt,{value:"manual",children:"Manual"}),a.jsx(nt,{value:"xml",children:"XML"})]})]}),a.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>{try{const re=mn||[],ot=[["Data/Hora","Origem","Fonte","Descrio","Finalizadora","Valor","Status"].join(";")];for(const Re of re){const rt=[Re.recebido_em?new Date(Re.recebido_em).toLocaleString("pt-BR"):"",Re.origem??"",Re.fonte??"",(Re.descricao??"").replaceAll('"','""'),(Re.finalizadoras?.nome||Re.metodo||"").replaceAll('"','""'),String(ft(Re.valor)).replace(".",","),Re.status??""].map(lt=>`"${String(lt)}"`).join(";");ot.push(rt)}const te="\uFEFF"+ot.join(`
`),T=new Blob([te],{type:"text/csv;charset=utf-8;"}),O=URL.createObjectURL(T),X=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR"):"",G=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR"):"",L=document.createElement("a");L.href=O,L.download=`recebimentos_${X}_a_${G}.csv`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(O)}catch(re){e({title:"Falha ao exportar CSV",description:re?.message,variant:"destructive"})}},children:[a.jsx(ms,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),i?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),a.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):mn.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Data/Hora"}),a.jsx(qn,{children:"Origem"}),a.jsx(qn,{children:"Fonte"}),a.jsx(qn,{children:"Descrio"}),a.jsx(qn,{children:"Finalizadora"}),a.jsx(qn,{className:"text-right",children:"Valor"}),a.jsx(qn,{children:"Status"})]})}),a.jsx(il,{children:mn.map(re=>a.jsxs(Wa,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{qe(re),ir(!0)},children:[a.jsx(Sn,{children:re.recebido_em?new Date(re.recebido_em).toLocaleString("pt-BR"):""}),a.jsx(Sn,{children:re.origem||""}),a.jsx(Sn,{children:re.fonte?re.fonte.toUpperCase():""}),a.jsx(Sn,{className:"truncate max-w-[260px]",title:re.descricao||"",children:re.descricao||""}),a.jsx(Sn,{children:re.finalizadoras?.nome||re.metodo||""}),a.jsx(Sn,{className:"text-right font-semibold",children:gt(re.valor)}),a.jsx(Sn,{children:re.status||""})]},re.id))})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:mn.map(re=>a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:()=>{qe(re),ir(!0)},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary",children:re.origem||"Recebimento"}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${re.status==="Pago"?"bg-success/20 text-success":re.status==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:re.status||"Pendente"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Data/Hora:"}),a.jsx("span",{className:"text-text-primary",children:re.recebido_em?new Date(re.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Fonte:"}),a.jsx("span",{className:"text-text-primary font-medium",children:re.fonte?re.fonte.toUpperCase():""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Finalizadora:"}),a.jsx("span",{className:"text-text-primary",children:re.finalizadoras?.nome||re.metodo||""})]}),re.descricao&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:"text-text-secondary",children:"Descrio:"}),a.jsx("span",{className:"text-text-primary text-xs bg-surface/50 p-2 rounded",children:re.descricao})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor:"}),a.jsx("span",{className:"font-bold text-lg text-success",children:gt(re.valor)})]})]}),a.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},re.id))})]})]})}),a.jsxs(uo,{value:"relatorios",className:"space-y-6 mt-6",children:[a.jsxs(Pr.div,{variants:al,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Ks,{className:"w-5 h-5 text-success"}),"Faturamento Consolidado"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Resumo geral das receitas no perodo"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const Te=[["Mtrica","Valor"],["Receita de Comandas",gt(v)],["Receita de Agendamentos",gt(y)],["Receita Total",gt(Number(v||0)+Number(y||0))],["Perodo",`${c||"N/A"} at ${u||"N/A"}`]].map(O=>O.map(X=>`"${X}"`).join(";")).join(`
`),ot=new Blob(["\uFEFF"+Te],{type:"text/csv;charset=utf-8;"}),te=URL.createObjectURL(ot),T=document.createElement("a");T.href=te,T.download=`faturamento_consolidado_${dr(new Date,"yyyy-MM-dd")}.csv`,T.click(),URL.revokeObjectURL(te),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ms,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const re=[["Receita de Comandas",gt(v)],["Receita de Agendamentos",gt(y)],["Receita Total",gt(Number(v||0)+Number(y||0))]];Dt("Faturamento Consolidado",["Mtrica","Valor"],re,"faturamento_consolidado")},children:[a.jsx(Lg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-success/5 border border-success/20 rounded-lg",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Comandas"}),a.jsx("div",{className:"text-2xl font-bold text-success",children:gt(v)}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Vendas no perodo"})]}),a.jsxs("div",{className:"p-4 bg-purple-500/5 border border-purple-500/20 rounded-lg",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Agendamentos"}),a.jsx("div",{className:"text-2xl font-bold text-purple-400",children:gt(y)}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Reservas pagas"})]}),a.jsxs("div",{className:"p-4 bg-brand/5 border border-brand/20 rounded-lg",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Total"}),a.jsx("div",{className:"text-2xl font-bold text-brand",children:gt(Number(v||0)+Number(y||0))}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Perodo selecionado"})]})]})]}),a.jsxs(Pr.div,{variants:al,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(qm,{className:"w-5 h-5 text-info"}),"Pagamentos por Mtodo"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Distribuio por finalizadora"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const re=h?.totalPorFinalizadora||{},Te=Object.entries(re).map(([L,Re])=>[L,gt(Re)]).sort((L,Re)=>{const rt=Number(String(L[1]).replace(/[^\d,]/g,"").replace(",","."));return Number(String(Re[1]).replace(/[^\d,]/g,"").replace(",","."))-rt}),ot=Object.values(re).reduce((L,Re)=>L+Re,0),T=[["Mtodo de Pagamento","Valor","% do Total"],...Te.map(([L,Re])=>{const lt=((Object.entries(re).find(([$t])=>$t===L)?.[1]||0)/ot*100).toFixed(1)+"%";return[L,Re,lt]}),["TOTAL",gt(ot),"100%"]].map(L=>L.map(Re=>`"${Re}"`).join(";")).join(`
`),O=new Blob(["\uFEFF"+T],{type:"text/csv;charset=utf-8;"}),X=URL.createObjectURL(O),G=document.createElement("a");G.href=X,G.download=`pagamentos_por_metodo_${dr(new Date,"yyyy-MM-dd")}.csv`,G.click(),URL.revokeObjectURL(X),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ms,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const re=h?.totalPorFinalizadora||{},Te=Object.values(re).reduce((te,T)=>te+T,0),ot=Object.entries(re).sort(([,te],[,T])=>T-te).map(([te,T])=>[te,gt(T),(T/Te*100).toFixed(1)+"%"]);ot.push(["TOTAL",gt(Te),"100%"]),Dt("Pagamentos por Mtodo",["Mtodo","Valor","% do Total"],ot,"pagamentos_por_metodo")},children:[a.jsx(Lg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),Object.keys(h?.totalPorFinalizadora||{}).length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Mtodo de Pagamento"}),a.jsx(qn,{className:"text-right",children:"Valor"}),a.jsx(qn,{className:"text-right",children:"% do Total"})]})}),a.jsxs(il,{children:[Object.entries(h?.totalPorFinalizadora||{}).sort(([,re],[,Te])=>Te-re).map(([re,Te])=>{const ot=Object.values(h?.totalPorFinalizadora||{}).reduce((T,O)=>T+O,0),te=(Te/ot*100).toFixed(1);return a.jsxs(Wa,{children:[a.jsx(Sn,{className:"font-medium",children:re}),a.jsx(Sn,{className:"text-right font-semibold",children:gt(Te)}),a.jsxs(Sn,{className:"text-right text-text-secondary",children:[te,"%"]})]},re)}),a.jsxs(Wa,{className:"bg-surface-2 font-bold",children:[a.jsx(Sn,{children:"TOTAL"}),a.jsx(Sn,{className:"text-right",children:gt(Object.values(h?.totalPorFinalizadora||{}).reduce((re,Te)=>re+Te,0))}),a.jsx(Sn,{className:"text-right",children:"100%"})]})]})]})})]}),a.jsxs(Pr.div,{variants:al,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(_d,{className:"w-5 h-5 text-purple-400"}),"Produtos Mais Vendidos"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Top produtos por faturamento"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const Te=[["Posio","Produto","Faturamento"],...C.slice(0,50).map((O,X)=>[X+1,O.nome,gt(O.valor)])].map(O=>O.map(X=>`"${X}"`).join(";")).join(`
`),ot=new Blob(["\uFEFF"+Te],{type:"text/csv;charset=utf-8;"}),te=URL.createObjectURL(ot),T=document.createElement("a");T.href=te,T.download=`produtos_vendidos_${dr(new Date,"yyyy-MM-dd")}.csv`,T.click(),URL.revokeObjectURL(te),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ms,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const re=C.slice(0,50).map((Te,ot)=>[ot+1,Te.nome,gt(Te.valor)]);Dt("Produtos Mais Vendidos",["#","Produto","Faturamento"],re,"produtos_vendidos")},children:[a.jsx(Lg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),C.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem produtos vendidos no perodo."}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"w-16",children:"#"}),a.jsx(qn,{children:"Produto"}),a.jsx(qn,{className:"text-right",children:"Faturamento"})]})}),a.jsx(il,{children:C.slice(0,20).map((re,Te)=>a.jsxs(Wa,{children:[a.jsx(Sn,{className:"text-text-secondary font-mono",children:Te+1}),a.jsx(Sn,{className:"font-medium",children:re.nome}),a.jsx(Sn,{className:"text-right font-semibold",children:gt(re.valor)})]},`${re.nome}-${Te}`))})]}),C.length>20&&a.jsx("div",{className:"text-center mt-4",children:a.jsxs(ce,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>H(!0),children:["Ver todos os ",C.length," produtos"]})})]})]}),a.jsxs(Pr.div,{variants:al,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(ml,{className:"w-5 h-5 text-warning"}),"Clientes que Mais Consomem"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Ranking por faturamento total"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const Te=[["Posio","Cliente","Faturamento"],...A.slice(0,50).map((O,X)=>[X+1,O.nome,gt(O.valor)])].map(O=>O.map(X=>`"${X}"`).join(";")).join(`
`),ot=new Blob(["\uFEFF"+Te],{type:"text/csv;charset=utf-8;"}),te=URL.createObjectURL(ot),T=document.createElement("a");T.href=te,T.download=`clientes_top_${dr(new Date,"yyyy-MM-dd")}.csv`,T.click(),URL.revokeObjectURL(te),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ms,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const re=A.slice(0,50).map((Te,ot)=>[ot+1,Te.nome,gt(Te.valor)]);Dt("Clientes que Mais Consomem",["#","Cliente","Total Gasto"],re,"clientes_top")},children:[a.jsx(Lg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),A.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de clientes no perodo."}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"w-16",children:"#"}),a.jsx(qn,{children:"Cliente"}),a.jsx(qn,{className:"text-right",children:"Total Gasto"})]})}),a.jsx(il,{children:A.slice(0,20).map((re,Te)=>a.jsxs(Wa,{children:[a.jsx(Sn,{className:"text-text-secondary font-mono",children:Te+1}),a.jsx(Sn,{className:"font-medium",children:re.nome}),a.jsx(Sn,{className:"text-right font-semibold",children:gt(re.valor)})]},`${re.nome}-${Te}`))})]}),A.length>20&&a.jsx("div",{className:"text-center mt-4",children:a.jsxs(ce,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>Q(!0),children:["Ver todos os ",A.length," clientes"]})})]})]}),a.jsxs(Pr.div,{variants:al,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Zp,{className:"w-5 h-5 text-success"}),"Evoluo Diria de Receitas"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Faturamento dia a dia no perodo"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const Te=[["Data","Receita"],...F.map(O=>[O.data,gt(O.valor)])].map(O=>O.map(X=>`"${X}"`).join(";")).join(`
`),ot=new Blob(["\uFEFF"+Te],{type:"text/csv;charset=utf-8;"}),te=URL.createObjectURL(ot),T=document.createElement("a");T.href=te,T.download=`evolucao_diaria_${dr(new Date,"yyyy-MM-dd")}.csv`,T.click(),URL.revokeObjectURL(te),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ms,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(ce,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const re=F.map(Te=>[Te.data,gt(Te.valor)]);Dt("Evoluo Diria de Receitas",["Data","Receita"],re,"evolucao_diaria")},children:[a.jsx(Lg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),F.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de evoluo no perodo."}):a.jsx("div",{className:"h-80",children:a.jsx(Hj,{width:"100%",height:"100%",children:a.jsxs(wze,{data:F,margin:{top:5,right:20,bottom:5,left:0},children:[a.jsx(XO,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),a.jsx(lg,{dataKey:"data",stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:re=>{const Te=re.split("/");return`${Te[0]}/${Te[1]}`}}),a.jsx(cg,{stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:re=>`R$ ${(re/1e3).toFixed(0)}k`}),a.jsx(vc,{contentStyle:{backgroundColor:"#1a1a1a",border:"1px solid #333",borderRadius:"8px"},labelStyle:{color:"#fff"},itemStyle:{color:"#22C55E"},formatter:re=>[gt(re),"Receita"]}),a.jsx(b1,{type:"monotone",dataKey:"valor",stroke:"#22C55E",strokeWidth:2,dot:{fill:"#22C55E",r:4},activeDot:{r:6}})]})})})]})]})]}),a.jsx(xn,{open:nr,onOpenChange:ir,children:a.jsxs(vn,{className:"max-w-lg",children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-xl font-bold",children:"Detalhes do Recebimento"}),a.jsx(On,{children:Ee?.origem==="Comanda"?"Operao de comanda":Ee?.origem==="Agendamento"?"Operao de agendamento":"Operao"})]}),Ee&&a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Data/Hora"}),a.jsx("div",{className:"font-medium",children:Ee.recebido_em?new Date(Ee.recebido_em).toLocaleString("pt-BR"):""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Valor"}),a.jsx("div",{className:"font-semibold",children:gt(Ee.valor)})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Origem"}),a.jsx("div",{children:Ee.origem||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Fonte"}),a.jsx("div",{children:Ee.fonte?Ee.fonte.toUpperCase():""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Finalizadora"}),a.jsx("div",{children:Ee.finalizadoras?.nome||Ee.metodo||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Status"}),a.jsx("div",{children:Ee.status||""})]})]}),Ee.origem==="Comanda"&&a.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[a.jsx("div",{className:"font-semibold mb-2",children:"Comanda"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Cliente"}),a.jsx("div",{children:Ee.descricao||""})]})}),a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"text-text-muted mb-1",children:"Produtos"}),St?a.jsx("div",{className:"text-xs text-text-muted",children:"Carregando itens..."}):Ge.length===0?a.jsx("div",{className:"text-xs text-text-muted",children:"Sem itens encontrados."}):a.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:Ge.map((re,Te)=>a.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[a.jsxs("div",{className:"truncate",children:[a.jsx("span",{className:"font-mono",children:ft(re.quantidade)}),a.jsx("span",{children:" x "}),a.jsx("span",{className:"font-medium",children:re.descricao})]}),a.jsx("div",{className:"whitespace-nowrap",children:gt(Number(re.preco_unitario||0)*Number(re.quantidade||0))})]},Te))})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{className:"text-text-muted mb-1",children:"Pagamentos"}),Et.length===0?a.jsx("div",{className:"text-xs text-text-muted",children:"Sem pagamentos adicionais."}):a.jsxs("div",{className:"space-y-1",children:[Et.map((re,Te)=>a.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[a.jsx("div",{className:"truncate",children:a.jsx("span",{className:"font-medium",children:re.finalizadoras?.nome||re.metodo||""})}),a.jsx("div",{className:"whitespace-nowrap",children:gt(re.valor)})]},re.id||Te)),a.jsxs("div",{className:"text-xs flex justify-between gap-3 pt-2 border-t border-border",children:[a.jsx("div",{className:"font-semibold",children:"Total"}),a.jsx("div",{className:"font-semibold",children:gt(Et.reduce((re,Te)=>re+Number(Te.valor||0),0))})]})]})]})]}),Ee.origem==="Agendamento"&&a.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[a.jsx("div",{className:"font-semibold mb-2",children:"Agendamento"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Cdigo"}),a.jsxs("div",{className:"font-mono",children:["#",Ee.agendamento_codigo]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Participante"}),a.jsx("div",{children:Ee.participante_nome})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("div",{className:"text-text-muted",children:"Quadra"}),a.jsx("div",{children:Ee.quadra_nome||""})]})]})]})]})]})}),a.jsx(xn,{open:z,onOpenChange:H,children:a.jsxs(vn,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Todos os Produtos"}),a.jsx(On,{children:"Ordenados por valor de vendas"})]}),a.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Produto"}),a.jsx(qn,{className:"text-center",children:"Quantidade"}),a.jsx(qn,{className:"text-right",children:"Valor Total"})]})}),a.jsx(il,{children:C.map((re,Te)=>a.jsxs(Wa,{children:[a.jsxs(Sn,{children:[Te+1,". ",re.nome]}),a.jsxs(Sn,{className:"text-center",children:["x",re.quantidade]}),a.jsx(Sn,{className:"text-right font-semibold",children:gt(re.valor)})]},`${re.nome}-${Te}`))})]})})]})}),a.jsx(xn,{open:dt,onOpenChange:At,children:a.jsxs(vn,{className:"sm:max-w-[900px] w-full max-h-[85vh] overflow-y-auto bg-surface text-text-primary border-0",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Fechamento do Caixa"}),a.jsxs(On,{children:[Rt?.sessao?.aberto_em?`${new Date(Rt.sessao.aberto_em).toLocaleString("pt-BR")}`:"",Rt?.sessao?.fechado_em?`  ${new Date(Rt.sessao.fechado_em).toLocaleString("pt-BR")}`:""]})]}),st?a.jsx("div",{className:"text-sm text-text-muted",children:"Carregando..."}):Rt?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),a.jsx("p",{className:"text-2xl font-bold tabular-nums",children:gt(Rt.sessao?.saldo_inicial)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Total do Dia"}),a.jsx("p",{className:"text-2xl font-bold text-success tabular-nums",children:(()=>{const re=Number(Rt.resumo?.totalEntradas||0),Te=Array.isArray(Rt.movimentacoes)?Rt.movimentacoes:[];let ot=0,te=0,T=0,O=0;for(const G of Te){const L=String(G?.tipo||"").toLowerCase(),Re=Number(G?.valor||0);L==="suprimento"?ot+=Re:L==="sangria"?te+=Re:L==="troco"?T+=Re:L==="ajuste"&&(O+=Re)}const X=re+ot+O-te-T;return gt(X)})()})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),a.jsx("p",{className:"text-2xl font-bold tabular-nums",children:(()=>{const re=Rt&&typeof Rt.valorFinalContado=="number"?Rt.valorFinalContado:null;return re!=null?gt(re):""})()})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),a.jsx("p",{className:"text-2xl font-bold text-warning tabular-nums",children:gt(Rt.resumo?.totalDescontos)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),a.jsx("p",{className:"text-2xl font-bold tabular-nums",children:gt(Rt.resumo?.totalVendasLiquidas)})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Entradas por Finalizadora"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:Rt.resumo?.totalPorFinalizadora&&Object.keys(Rt.resumo.totalPorFinalizadora).length>0?Object.entries(Rt.resumo.totalPorFinalizadora).map(([re,Te])=>a.jsxs("div",{className:"bg-surface-2 rounded-md p-2 border border-border flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate",children:String(re)}),a.jsx("span",{className:"text-sm font-semibold",children:gt(Te)})]},re)):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos."})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Movimentaes"}),!Rt.movimentacoes||Rt.movimentacoes.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes nesta sesso."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Data"}),a.jsx(qn,{children:"Tipo"}),a.jsx(qn,{children:"Obs"}),a.jsx(qn,{className:"text-right",children:"Valor"})]})}),a.jsx(il,{children:Rt.movimentacoes.map(re=>a.jsxs(Wa,{children:[a.jsx(Sn,{children:re.created_at?new Date(re.created_at).toLocaleString("pt-BR"):""}),a.jsx(Sn,{className:"capitalize",children:re.tipo||""}),a.jsx(Sn,{className:"truncate max-w-[280px]",title:re.observacao||"",children:re.observacao||""}),a.jsx(Sn,{className:"text-right font-semibold",children:gt(re.valor)})]},re.id))})]})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Recebimentos"}),!Rt.pagamentos||Rt.pagamentos.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem recebimentos no perodo deste caixa."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Data/Hora"}),a.jsx(qn,{children:"Finalizadora"}),a.jsx(qn,{className:"text-right",children:"Valor"}),a.jsx(qn,{children:"Status"})]})}),a.jsx(il,{children:Rt.pagamentos.map(re=>a.jsxs(Wa,{children:[a.jsx(Sn,{children:re.recebido_em?new Date(re.recebido_em).toLocaleString("pt-BR"):""}),a.jsx(Sn,{children:re.finalizadoras?.nome||re.metodo||""}),a.jsx(Sn,{className:"text-right font-semibold",children:gt(re.valor)}),a.jsx(Sn,{children:re.status||""})]},re.id))})]})})]})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados."})]})}),a.jsx(xn,{open:q,onOpenChange:re=>{Q(re),re||(be(null),B([]))},children:a.jsxs(vn,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Clientes"}),a.jsx(On,{children:"Ordenados por valor pago no perodo selecionado"})]}),a.jsx("div",{className:"max-h-[60vh] overflow-y-auto border border-border rounded-md",children:a.jsxs(ol,{children:[a.jsx(sl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Cliente"}),a.jsx(qn,{className:"text-right",children:"Pago"})]})}),a.jsx(il,{children:A.map((re,Te)=>a.jsxs(Wa,{className:"cursor-pointer hover:bg-brand/10",onClick:async()=>{Z(!0),be(re),ue(!0);try{const ot=Er(c),te=ln(u),T=(re.nome||"").trim(),O=t?.codigo_empresa;let X=fe.from("clientes").select("id, nome").eq("codigo_empresa",O).ilike("nome",`%${T}%`);const{data:G}=await X,L=new Set((G||[]).map(In=>In.id));let Re=fe.from("comanda_clientes").select("comanda_id").eq("codigo_empresa",O).ilike("nome_livre",`%${T}%`);const{data:rt}=await Re;let lt=new Set((rt||[]).map(In=>In.comanda_id));if(L.size>0){let In=fe.from("comanda_clientes").select("comanda_id, cliente_id").eq("codigo_empresa",O).in("cliente_id",Array.from(L));const{data:Xn}=await In;(Xn||[]).forEach(En=>lt.add(En.comanda_id))}const $t=Array.from(lt);let Fe=fe.from("pagamentos").select("id, valor, recebido_em, metodo, finalizadoras!pagamentos_finalizadora_id_fkey(nome), comanda_id, status").in("comanda_id",$t).neq("status","Cancelado").neq("status","Estornado").order("recebido_em",{ascending:!1}).limit(50);ot&&(Fe=Fe.gte("recebido_em",ot)),te&&(Fe=Fe.lte("recebido_em",te));const{data:It}=await Fe,Sr=It||[],kr=Array.from(new Set(Sr.map(In=>In.comanda_id).filter(Boolean))),pr={};if(kr.length>0){let In=fe.from("comandas").select("id, tipo, mesa_id").in("id",kr);const{data:Xn}=await In,En=Array.from(new Set((Xn||[]).map(Gr=>Gr.mesa_id).filter(Boolean))),dn={};if(En.length>0){let Gr=fe.from("mesas").select("id, numero, nome").in("id",En);const{data:ga}=await Gr;(ga||[]).forEach(Ma=>{dn[Ma.id]=(Ma.nome||`Mesa ${Ma.numero||""}`).trim()})}(Xn||[]).forEach(Gr=>{let ga="";const Ma=String(Gr?.tipo||"").toLowerCase();Ma==="balcao"||Ma==="balco"?ga="Balco":Ma==="mesa"||Gr.mesa_id?ga=dn[Gr.mesa_id]||"Mesa":Ma==="agendamento"&&(ga="Agendamento"),pr[Gr.id]=ga})}let yn=Sr.map(In=>({...In,origem:In.comanda_id&&pr[In.comanda_id]||""}));try{const In=t?.codigo_empresa;let Xn=[];if(L&&L.size>0){let va=fe.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(L));In&&(va=va.eq("codigo_empresa",In));const{data:$a}=await va;if(Xn=$a||[],Xn.length===0&&In){let ss=fe.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(L));const{data:ao}=await ss;Xn=ao||[]}}let En=[...Xn];const dn=Array.from(new Set(En.map(va=>va.agendamento_id).filter(Boolean)));let Gr=new Set;const ga={};if(dn.length>0){let va=fe.from("agendamentos").select("id, inicio").in("id",dn);In&&(va=va.eq("codigo_empresa",In));const{data:$a}=await va,ss=ot?new Date(ot).getTime():null,ao=te?new Date(te).getTime():null;($a||[]).forEach(xo=>{const Ss=xo?.inicio?new Date(xo.inicio).getTime():null;Ss!=null&&(ss==null||Ss>=ss)&&(ao==null||Ss<=ao)&&Gr.add(xo.id),xo?.id&&(ga[xo.id]=xo.inicio||null)})}En=En.filter(va=>Gr.has(va.agendamento_id));const Ma=new Set;console.debug("[Financeiro][Agendamentos][Detalhe] encontrados:",En.length),En.forEach(va=>{const $a=`${va.id}`;if(Ma.has($a))return;Ma.add($a);const ss=String(va.status_pagamento||va.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(ss))return;const ao=va.finalizadora_nome||va.metodo||va.metodo_pagamento||va.forma_pagamento||"Agendamento";yn.push({id:`ag-${va.id}`,recebido_em:ga[va.agendamento_id]||null,finalizadoras:ao?{nome:ao}:null,metodo:ao,origem:"Agendamento",valor:va.valor_cota})})}catch{}B(yn)}finally{ue(!1)}},children:[a.jsx(Sn,{children:re.nome}),a.jsx(Sn,{className:"text-right font-semibold",children:gt(re.valor)})]},`${re.nome}-${Te}`))})]})})]})}),a.jsx(xn,{open:Ne,onOpenChange:Z,children:a.jsxs(vn,{className:"max-w-5xl w-[95vw] md:w-[90vw] max-h-[85vh] bg-surface text-text-primary border-0 overflow-hidden flex flex-col",children:[a.jsxs(pn,{className:"flex-shrink-0",children:[a.jsx(fn,{className:"text-lg md:text-xl",children:"Detalhes do Cliente"}),a.jsx(On,{className:"text-sm md:text-base",children:pe?.nome})]}),pe?a.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 bg-surface-2 rounded-lg flex-shrink-0",children:[a.jsx("span",{className:"text-sm md:text-base text-text-secondary",children:"Total Pago no Perodo"}),a.jsx("span",{className:"text-lg md:text-2xl font-bold text-success",children:gt(pe.valor)})]}),J?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Carregando detalhes..."}):V.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo selecionado."}):a.jsx("div",{className:"flex-1 overflow-auto border border-border rounded-md",children:a.jsxs(ol,{children:[a.jsx(sl,{className:"sticky top-0 bg-surface z-10",children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:"Data"}),a.jsx(qn,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:"Finaliz."}),a.jsx(qn,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:"Origem"}),a.jsx(qn,{className:"text-right text-xs md:text-sm w-[70px] md:w-auto",children:"Valor"})]})}),a.jsx(il,{children:V.map(re=>a.jsxs(Wa,{children:[a.jsx(Sn,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:a.jsx("div",{className:"text-[10px] md:text-xs leading-tight",children:re.recebido_em?new Date(re.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):""})}),a.jsx(Sn,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:a.jsx("div",{className:"truncate max-w-[80px] md:max-w-[200px] text-[10px] md:text-xs",title:re.finalizadoras?.nome||re.metodo||"",children:re.finalizadoras?.nome||re.metodo||""})}),a.jsx(Sn,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:a.jsx("div",{className:"truncate max-w-[60px] md:max-w-[150px] text-[10px] md:text-xs",title:re.origem||"",children:re.origem||""})}),a.jsx(Sn,{className:"text-right font-semibold text-xs md:text-sm w-[70px] md:w-auto",children:a.jsx("div",{className:"text-[10px] md:text-xs whitespace-nowrap",children:gt(re.valor)})})]},re.id))})]})})]}):a.jsx("div",{className:"text-sm text-text-muted py-8 text-center",children:"Nenhum cliente selecionado"})]})})]})})}const jst={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},LR={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function _st({children:e,className:t=""}){return a.jsx(Pr.div,{variants:LR,className:`fx-card ${t}`,children:e})}const YE=({icon:e,title:t,value:r,subtitle:n,color:o})=>{const s=e;return a.jsxs(Pr.div,{variants:LR,className:"bg-surface rounded-lg border-2 border-border hover:border-border-hover p-4 flex flex-col justify-between gap-2 transition-all duration-300",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-text-secondary text-sm font-semibold",children:t}),a.jsx(s,{className:`w-5 h-5 ${o}`})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r}),a.jsx("p",{className:"text-xs text-text-muted",children:n})]})]})};function UU({label:e,...t}){return a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:e}),a.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function Nst(){const{toast:e}=no(),{userProfile:t,authReady:r}=So(),n=p.useRef(!1),[o,s]=p.useState(()=>{try{const he=JSON.parse(localStorage.getItem("quadras:list")||"[]");return Array.isArray(he)?he:[]}catch{return[]}}),[i,l]=p.useState(()=>{try{const he=JSON.parse(localStorage.getItem("quadras:list")||"[]");return!(Array.isArray(he)&&he.length>0)}catch{return!0}}),[c,d]=p.useState(!1),[u,f]=p.useState(!1),[h,m]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[v,g]=p.useState(""),[y,x]=p.useState(!1),[b,w]=p.useState(null),[j,_]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[C,E]=p.useState(""),[A,P]=p.useState(!0),[F,M]=p.useState({mostUsed:"-",topClient:"-",totalBookings:"-"}),[I,R]=p.useState(!1),[D,U]=p.useState(null),[z,H]=p.useState({0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0}),[q,Q]=p.useState([]),[pe,be]=p.useState(""),[V,B]=p.useState(""),[J,ue]=p.useState(!1),Ne=he=>{if(!he)return null;const[ke,et]=String(he).split(":");return`${ke.padStart(2,"0")}:${et.padStart(2,"0")}:00`},Z=he=>{const ke=String(he??"").replace(/\D/g,"");if(!ke)return"";const et=(Number(ke)/100).toFixed(2),[Me,$e]=et.split(".");return`${Me.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${$e}`},ge=he=>{if(he==null||he==="")return NaN;const ke=String(he).replace(/\./g,"").replace(",","."),et=parseFloat(ke);return Number.isFinite(et)?et:NaN},le=(he,ke=!1)=>{if(he==null||!Number.isFinite(Number(he)))return"-";const Me=Number(he).toFixed(2).split("."),$e=Me[0],Be=Me[1],He=`${$e.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${Be}`;return ke?`R$ ${He}`:He},se=he=>{if(!he)return"";const[ke,et]=String(he).split(":");return`${String(ke).padStart(2,"0")}:${String(et).padStart(2,"0")}`},ee=he=>{if(!he)return 0;const[ke,et]=String(he).split(":").map(Number);return(ke===0&&et===0?24:ke||0)*60+(et||0)},de=he=>{if(!he)return!1;const ke=String(he).split(":");if(ke.length<2)return!1;const et=Number(ke[1]);return et===0||et===30},Le=he=>{if(!he)return"";const[ke,et]=String(he).split(":");let Me=Math.max(0,Math.min(23,parseInt(ke||"0",10))),$e=Math.max(0,Math.min(59,parseInt(et||"0",10)));const Be=Math.round($e/30);if(Be>=2?(Me+=1,$e=0):$e=Be*30,Me>=24)return"23:59";const we=String(Me).padStart(2,"0"),He=String($e).padStart(2,"0");return`${we}:${He}`};p.useEffect(()=>{if(!c)return;const he=setTimeout(()=>{console.error("[Quadras] add/update stuck >15s",{route:"/quadras",codigo_empresa:t?.codigo_empresa,editingId:b,formQuadra:h,editForm:j})},15e3);return()=>clearTimeout(he)},[c,t?.codigo_empresa,b,h,j]);const ae=async()=>{if(!t?.codigo_empresa)return;const he=o&&o.length>0;he||l(!0);const{data:ke,error:et}=await fe.from("quadras").select("*").eq("codigo_empresa",t.codigo_empresa).order("nome",{ascending:!0});if(et){if(!n.current){n.current=!0,setTimeout(ae,800),he||l(!1);return}e({title:"Erro ao carregar quadras",description:et.message}),he||l(!1);return}const Me=ke||[];if(Me.length===0&&he&&!n.current){n.current=!0,setTimeout(ae,600),he||l(!1);return}n.current=!1,s(Me);try{localStorage.setItem("quadras:list",JSON.stringify(Me))}catch{}he||l(!1)},ie=he=>{w(he.id),_({nome:he.nome||"",descricao:he.descricao||"",modalidades:Array.isArray(he.modalidades)?he.modalidades:he.modalidades?[he.modalidades]:[],tipo:he.tipo||"Descoberta",status:he.status||"Ativa",hora_inicio:se(he.hora_inicio||"06:00:00"),hora_fim:se(he.hora_fim||"24:00:00")||"23:59",valor_hora:he.valor!=null&&he.valor!==""?Z(String((Number(he.valor)*2).toFixed(2))):""}),E(""),x(!0)},dt=async()=>{if(!j.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."});return}if(!j.hora_inicio||!j.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!de(j.hora_inicio)||!de(j.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(ee(j.hora_fim)<=ee(j.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!j.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!t?.codigo_empresa||!b){e({title:"Atualizao indisponvel",description:"Dados insuficientes para atualizar."});return}d(!0);const he={nome:j.nome.trim(),descricao:j.descricao?.trim()||null,modalidades:j.modalidades,tipo:j.tipo,status:j.status,hora_inicio:Ne(j.hora_inicio),hora_fim:Ne(j.hora_fim==="24:00"?"23:59":j.hora_fim)};if(j.valor_hora!=null&&String(j.valor_hora).trim()!==""){const $e=ge(j.valor_hora);!Number.isNaN($e)&&Number.isFinite($e)&&(he.valor=Math.round($e/2*100)/100)}else he.valor=null;const ke=($e,Be)=>Promise.race([$e,new Promise((we,He)=>setTimeout(()=>He(new Error("Timeout ao atualizar quadra (>12s)")),Be))]);let et,Me;try{({data:et,error:Me}=await ke(fe.from("quadras").update(he).eq("codigo_empresa",t.codigo_empresa).eq("id",b).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch($e){console.error("update timeout/error",$e),e({title:"Tempo excedido",description:"Sem resposta do servidor ao atualizar. Verifique conexo e tente novamente."}),d(!1);return}if(d(!1),Me){e({title:"Erro ao atualizar quadra",description:Me.message});return}if(!et){await ae(),e({title:"Quadra atualizada",description:`${he.nome} foi atualizada.`}),x(!1),w(null),E("");return}e({title:"Quadra atualizada",description:`${et.nome} foi atualizada.`}),x(!1),w(null),E(""),s($e=>$e.map(Be=>Be.id===et.id?et:Be).sort((Be,we)=>Be.nome.localeCompare(we.nome)))};p.useEffect(()=>{try{const he=JSON.parse(localStorage.getItem("quadras:list")||"[]");Array.isArray(he)&&he.length&&o.length===0&&(s(he),l(!1))}catch{}},[]),p.useEffect(()=>{r&&t?.codigo_empresa&&(ae(),At())},[r,t?.codigo_empresa]);const At=async()=>{if(t?.codigo_empresa)try{const he=new Date;he.setDate(he.getDate()-30);const{data:ke}=await fe.from("agendamentos").select("quadra_id, cliente_id, quadras!inner(nome), clientes(nome, codigo)").eq("codigo_empresa",t.codigo_empresa).gte("inicio",he.toISOString()).neq("status","canceled");if(!ke||ke.length===0){M({mostUsed:"Sem dados",topClient:"Sem dados",totalBookings:"0"});return}const et={};ke.forEach(we=>{const He=we.quadras?.nome||"Sem nome";et[He]=(et[He]||0)+1});const Me=Object.entries(et).sort((we,He)=>He[1]-we[1])[0],$e={};ke.forEach(we=>{if(we.cliente_id&&we.clientes?.nome){const He=we.clientes?.codigo;if(He===0||He==="0")return;const ht=we.clientes.nome;$e[ht]=($e[ht]||0)+1}});const Be=Object.entries($e).sort((we,He)=>He[1]-we[1])[0];M({mostUsed:Me?`${Me[0]} (${Me[1]})`:"Sem dados",topClient:Be?`${Be[0]} (${Be[1]})`:"Sem dados",totalBookings:ke.length.toString()})}catch(he){console.error("Erro ao carregar stats:",he),M({mostUsed:"Erro",topClient:"Erro",totalBookings:"0"})}},st=async()=>{if(console.groupCollapsed("[Quadras] addQuadra: CLICK"),console.time("[Quadras] addQuadra duration"),console.log("pre-validate",{codigo_empresa:t?.codigo_empresa,formQuadra:h}),!h.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."}),console.warn("validation: missing nome"),console.groupEnd();return}if(!h.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!h.hora_inicio||!h.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!de(h.hora_inicio)||!de(h.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(ee(h.hora_fim)<=ee(h.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!t?.codigo_empresa){e({title:"Empresa no localizada",description:"Associe o usurio a uma empresa para cadastrar quadras."});return}d(!0),console.log("validated, building payload");const he={codigo_empresa:t.codigo_empresa,nome:h.nome.trim(),descricao:h.descricao?.trim()||null,modalidades:h.modalidades,tipo:h.tipo,status:h.status,hora_inicio:Ne(h.hora_inicio),hora_fim:Ne(h.hora_fim==="24:00"?"23:59":h.hora_fim)};if(h.valor_hora!=null&&String(h.valor_hora).trim()!==""){const $e=ge(h.valor_hora);!Number.isNaN($e)&&Number.isFinite($e)&&(he.valor=Math.round($e/2*100)/100)}console.log("payload",he);const ke=($e,Be)=>Promise.race([$e,new Promise((we,He)=>setTimeout(()=>He(new Error("Timeout ao inserir quadra (>12s)")),Be))]);let et,Me;try{({data:et,error:Me}=await ke(fe.from("quadras").insert(he).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch($e){d(!1),console.error("insert timeout/error",$e),e({title:"Tempo excedido",description:"Sem resposta do servidor ao cadastrar. Verifique conexo e tente novamente."}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(d(!1),Me){e({title:"Erro ao cadastrar quadra",description:Me.message}),console.error("insert error",{code:Me.code,message:Me.message,details:Me.details}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(!et){console.warn("insert success sem representao; recarregando lista"),await ae(),e({title:"Quadra adicionada",description:`${he.nome} foi cadastrada.`}),m({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}console.log("insert success",{id:et?.id,nome:et?.nome}),e({title:"Quadra adicionada",description:`${et.nome} foi cadastrada.`}),m({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),s($e=>[et,...$e].sort((Be,we)=>Be.nome.localeCompare(we.nome))),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd()},ut=async he=>{U(he),ue(!0);try{const{data:ke,error:et}=await fe.from("quadras_dias_funcionamento").select("*").eq("quadra_id",he.id).eq("codigo_empresa",t.codigo_empresa);if(et)throw et;const Me={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0},$e=[];ke?.forEach(Be=>{Be.tipo==="dia_semana"?Me[Be.dia_semana]=Be.funciona:Be.tipo==="data_fechamento"&&$e.push(Be)}),H(Me),Q($e),R(!0)}catch(ke){console.error("Erro ao carregar dias de funcionamento:",ke),e({title:"Erro",description:"No foi possvel carregar as configuraes."})}finally{ue(!1)}},Rt=async()=>{if(D){ue(!0);try{await fe.from("quadras_dias_funcionamento").delete().eq("quadra_id",D.id).eq("tipo","dia_semana");const he=Object.entries(z).map(([et,Me])=>({quadra_id:D.id,codigo_empresa:t.codigo_empresa,tipo:"dia_semana",dia_semana:parseInt(et),funciona:Me,observacao:"Configurao de dias da semana"})),{error:ke}=await fe.from("quadras_dias_funcionamento").insert(he);if(ke)throw ke;e({title:"Sucesso",description:"Dias da semana salvos com sucesso!"})}catch(he){console.error("Erro ao salvar dias da semana:",he),e({title:"Erro",description:"No foi possvel salvar as configuraes."})}finally{ue(!1)}}},Nt=async()=>{if(!(!D||!pe)){ue(!0);try{const{data:he,error:ke}=await fe.from("quadras_dias_funcionamento").insert({quadra_id:D.id,codigo_empresa:t.codigo_empresa,tipo:"data_fechamento",data_fechamento:pe,funciona:!1,observacao:V||"Fechamento especial"}).select().single();if(ke)throw ke;Q(et=>[...et,he]),be(""),B(""),e({title:"Sucesso",description:"Data de fechamento adicionada!"})}catch(he){console.error("Erro ao adicionar data de fechamento:",he),e({title:"Erro",description:"No foi possvel adicionar a data de fechamento."})}finally{ue(!1)}}},tt=async he=>{ue(!0);try{const{error:ke}=await fe.from("quadras_dias_funcionamento").delete().eq("id",he);if(ke)throw ke;Q(et=>et.filter(Me=>Me.id!==he)),e({title:"Sucesso",description:"Data de fechamento removida!"})}catch(ke){console.error("Erro ao remover data de fechamento:",ke),e({title:"Erro",description:"No foi possvel remover a data de fechamento."})}finally{ue(!1)}};return a.jsx(a.Fragment,{children:a.jsxs(Pr.div,{variants:jst,initial:"hidden",animate:"visible",className:"space-y-6",children:[a.jsxs(Pr.div,{variants:LR,className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Quadras"}),a.jsx("p",{className:"text-text-secondary",children:"Gerencie as quadras e horrios disponveis."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ce,{variant:"outline",size:"icon",onClick:()=>P(he=>!he),title:A?"Ocultar resumo":"Mostrar resumo","aria-label":A?"Ocultar resumo":"Mostrar resumo",children:A?a.jsx(Mp,{className:"h-4 w-4"}):a.jsx(Qp,{className:"h-4 w-4"})}),a.jsx(ce,{onClick:()=>f(!0),className:"shadow-sm",children:"Adicionar Quadra"})]})]}),A&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsx(YE,{icon:jc,title:"Quadra Mais Usada",value:F.mostUsed,subtitle:"ltimos 30 dias",color:"text-brand"}),a.jsx(YE,{icon:ml,title:"Cliente Top",value:F.topClient,subtitle:"Mais agendamentos no ms",color:"text-purple"}),a.jsx(YE,{icon:Zp,title:"Total de Agendamentos",value:F.totalBookings,subtitle:"ltimos 30 dias",color:"text-success"})]}),a.jsxs(_st,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-text-primary",children:"Quadras"}),a.jsx("div",{className:"text-xs text-text-muted",children:i?"Carregando...":`${o.length} registro(s)`})]}),!i&&o.length===0?a.jsxs("div",{className:"text-sm text-text-muted py-8 text-center",children:[a.jsx("div",{className:"font-medium mb-1",children:"Nenhuma quadra cadastrada"}),a.jsx("div",{className:"mb-4",children:'Clique em "Adicionar Quadra" para cadastrar a primeira.'}),a.jsx(ce,{onClick:()=>f(!0),children:"Adicionar Quadra"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden space-y-3",children:o.map(he=>a.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:Am(he.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),a.jsx("span",{className:"font-semibold text-base text-text-primary truncate",children:he.nome})]}),a.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0 ${he.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":he.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:he.status})]}),Array.isArray(he.modalidades)&&he.modalidades.length>0&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted mb-1 block",children:"Modalidades"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:he.modalidades.map(ke=>a.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-xs",children:ke},ke))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Valor/hora"}),a.jsx("span",{className:"text-sm font-medium",children:he.valor==null||he.valor===""?"-":le(Number(he.valor)*2,!0)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Funcionamento"}),a.jsxs("span",{className:"text-sm font-medium",children:[se(he.hora_inicio)," - ",se(he.hora_fim==="24:00:00"?"23:59:00":he.hora_fim)]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>ut(he),className:"flex items-center gap-1",children:[a.jsx(Ns,{className:"h-3 w-3"}),"Dias"]}),a.jsx(ce,{variant:"outline",size:"sm",onClick:()=>ie(he),children:"Editar"})]})]},he.id))}),a.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-border bg-surface-0",children:a.jsxs(ol,{children:[a.jsx(sl,{className:"bg-surface-2/60 backdrop-blur supports-[backdrop-filter]:bg-surface-2/70",children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Nome"}),a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Modalidades"}),a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Valor por hora"}),a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Funcionamento"}),a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Status"}),a.jsx(qn,{className:"text-right text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Aes"})]})}),a.jsx(il,{children:o.map(he=>a.jsxs(Wa,{className:"hover:bg-surface-2/40 transition-colors",children:[a.jsx(Sn,{className:"font-medium text-sm md:text-base text-text-primary",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:Am(he.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),a.jsx("span",{children:he.nome})]})}),a.jsx(Sn,{className:"text-sm md:text-base",children:Array.isArray(he.modalidades)&&he.modalidades.length>0?a.jsx("div",{className:"flex flex-wrap gap-1",children:he.modalidades.map(ke=>a.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:ke},ke))}):he.modalidades||""}),a.jsx(Sn,{className:"text-sm md:text-base",children:he.valor==null||he.valor===""?"-":a.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:le(Number(he.valor)*2,!0)})}),a.jsxs(Sn,{className:"text-sm md:text-base",children:[se(he.hora_inicio)," - ",se(he.hora_fim==="24:00:00"?"23:59:00":he.hora_fim)]}),a.jsx(Sn,{className:"text-sm md:text-base",children:a.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-[11px] md:text-xs border ${he.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":he.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:he.status})}),a.jsx(Sn,{className:"text-right",children:a.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[a.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>ut(he),className:"text-sm",children:[a.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Dias"]}),a.jsx(ce,{variant:"outline",size:"sm",onClick:()=>ie(he),className:"text-sm",children:"Editar"})]})})]},he.id))})]})})]})]}),a.jsx(xn,{open:u,onOpenChange:f,children:a.jsxs(vn,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Adicionar Quadra"}),a.jsx(On,{children:"Cadastre uma nova quadra da sua empresa."})]}),a.jsxs("div",{className:"grid gap-4 py-2",children:[a.jsx(UU,{label:"Nome",value:h.nome,onChange:he=>m({...h,nome:he.target.value}),placeholder:"Ex.: Quadra Society 2"}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),a.jsx("textarea",{value:h.descricao,onChange:he=>m({...h,descricao:he.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),a.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:v,onChange:he=>g(he.target.value),onKeyDown:he=>{if(he.key==="Enter"){he.preventDefault();const ke=v.trim();if(!ke)return;m(et=>et.modalidades.some($e=>$e.toLowerCase()===ke.toLowerCase())?et:{...et,modalidades:[...et.modalidades,ke]}),g("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),a.jsx(ce,{type:"button",variant:"secondary",className:"bg-amber-500 hover:bg-amber-400 text-black disabled:opacity-50 disabled:cursor-not-allowed",disabled:!v.trim(),onClick:()=>{const he=v.trim();he&&(m(ke=>ke.modalidades.some(Me=>Me.toLowerCase()===he.toLowerCase())?ke:{...ke,modalidades:[...ke.modalidades,he]}),g(""))},"aria-label":"Adicionar modalidade",title:"Adicionar modalidade",children:"+"})]}),h.modalidades.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:h.modalidades.map(he=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[a.jsx("span",{className:"px-0.5",children:he}),a.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>m(ke=>({...ke,modalidades:ke.modalidades.filter(et=>et!==he)})),"aria-label":`Remover ${he}`,title:`Remover ${he}`,children:""})]},he))})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),a.jsxs("select",{value:h.tipo,onChange:he=>m({...h,tipo:he.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Descoberta"}),a.jsx("option",{children:"Coberta"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:h.valor_hora,onChange:he=>m({...h,valor_hora:Z(he.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),a.jsx("input",{type:"time",step:"1800",value:h.hora_inicio,onChange:he=>m({...h,hora_inicio:he.target.value}),onBlur:he=>m(ke=>({...ke,hora_inicio:Le(he.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),a.jsx("input",{type:"time",step:"1800",value:h.hora_fim,onChange:he=>m({...h,hora_fim:he.target.value}),onBlur:he=>m(ke=>({...ke,hora_fim:Le(he.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),a.jsxs("select",{value:h.status,onChange:he=>m({...h,status:he.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Ativa"}),a.jsx("option",{children:"Inativa"}),a.jsx("option",{children:"Manuteno"})]})]})]}),a.jsx(ra,{children:a.jsx(ce,{onClick:st,disabled:c||h.modalidades.length===0,children:c?"Adicionando...":"Salvar"})})]})}),a.jsx(xn,{open:y,onOpenChange:x,children:a.jsxs(vn,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Editar Quadra"}),a.jsx(On,{children:"Atualize os dados da quadra selecionada."})]}),a.jsxs("div",{className:"grid gap-4 py-2",children:[a.jsx(UU,{label:"Nome",value:j.nome,onChange:he=>_({...j,nome:he.target.value}),placeholder:"Ex.: Quadra Society 2"}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),a.jsx("textarea",{value:j.descricao,onChange:he=>_({...j,descricao:he.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),a.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:C,onChange:he=>E(he.target.value),onKeyDown:he=>{if(he.key==="Enter"){he.preventDefault();const ke=C.trim();if(!ke)return;_(et=>et.modalidades.some($e=>$e.toLowerCase()===ke.toLowerCase())?et:{...et,modalidades:[...et.modalidades,ke]}),E("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),a.jsx(ce,{type:"button",variant:"secondary",onClick:()=>{const he=C.trim();he&&(_(ke=>ke.modalidades.some(Me=>Me.toLowerCase()===he.toLowerCase())?ke:{...ke,modalidades:[...ke.modalidades,he]}),E(""))},children:"+"})]}),j.modalidades.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:j.modalidades.map(he=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[a.jsx("span",{className:"px-0.5",children:he}),a.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>_(ke=>({...ke,modalidades:ke.modalidades.filter(et=>et!==he)})),"aria-label":`Remover ${he}`,title:`Remover ${he}`,children:""})]},he))})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),a.jsxs("select",{value:j.tipo,onChange:he=>_({...j,tipo:he.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Descoberta"}),a.jsx("option",{children:"Coberta"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:j.valor_hora,onChange:he=>_({...j,valor_hora:Z(he.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),a.jsx("input",{type:"time",step:"1800",value:j.hora_inicio,onChange:he=>_({...j,hora_inicio:he.target.value}),onBlur:he=>_(ke=>({...ke,hora_inicio:Le(he.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),a.jsx("input",{type:"time",step:"1800",value:j.hora_fim,onChange:he=>_({...j,hora_fim:he.target.value}),onBlur:he=>_(ke=>({...ke,hora_fim:Le(he.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),a.jsxs("select",{value:j.status,onChange:he=>_({...j,status:he.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Ativa"}),a.jsx("option",{children:"Inativa"}),a.jsx("option",{children:"Manuteno"})]})]})]}),a.jsx(ra,{children:a.jsx(ce,{onClick:dt,disabled:c||j.modalidades.length===0,children:c?"Salvando...":"Salvar alteraes"})})]})}),a.jsx(xn,{open:I,onOpenChange:R,children:a.jsxs(vn,{className:"sm:max-w-[600px] max-h-[90vh] overflow-hidden pointer-events-none",children:[a.jsx("div",{className:"fixed inset-0 z-50 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto",children:a.jsx("div",{className:"rounded-2xl border border-white/30 bg-slate-900 shadow-2xl max-w-sm w-full text-center mx-4",children:a.jsxs("div",{className:"px-8 py-10",children:[a.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[a.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(jc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline select-none",children:[a.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-3xl",style:{color:"#FFFFFF"},children:" Arena"})]})]}),a.jsx("div",{className:"text-2xl font-bold text-white mb-3",children:"Em Desenvolvimento"}),a.jsx("p",{className:"text-base text-gray-200",children:"Esta funcionalidade est sendo desenvolvida e em breve estar disponvel."}),a.jsx("div",{className:"mt-8 flex items-center justify-center",children:a.jsx(ce,{variant:"outline",onClick:()=>R(!1),children:"Fechar"})})]})})}),a.jsxs(pn,{children:[a.jsxs(fn,{className:"flex items-center gap-2",children:[a.jsx(Ns,{className:"h-5 w-5"}),"Dias de Funcionamento - ",D?.nome]}),a.jsx(On,{children:"Configure os dias da semana que a quadra funciona e adicione datas especficas de fechamento."})]}),J?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"text-sm text-text-muted",children:"Carregando configuraes..."})}):a.jsxs("div",{className:"space-y-6 py-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Dias da Semana"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[{key:0,label:"Domingo",short:"Dom"},{key:1,label:"Segunda",short:"Seg"},{key:2,label:"Tera",short:"Ter"},{key:3,label:"Quarta",short:"Qua"},{key:4,label:"Quinta",short:"Qui"},{key:5,label:"Sexta",short:"Sex"},{key:6,label:"Sbado",short:"Sb"}].map(he=>a.jsxs("label",{className:"flex items-center gap-2 p-3 rounded-lg border border-border hover:bg-surface-2/50 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:z[he.key],onChange:ke=>H(et=>({...et,[he.key]:ke.target.checked})),className:"w-4 h-4 text-primary bg-surface-2 border-border rounded focus:ring-primary focus:ring-2"}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-sm font-medium text-text-primary",children:he.short}),a.jsx("span",{className:"text-xs text-text-muted hidden sm:block",children:he.label})]})]},he.key))}),a.jsx("div",{className:"mt-4",children:a.jsx(ce,{onClick:Rt,disabled:J,size:"sm",children:J?"Salvando...":"Salvar Dias da Semana"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Datas de Fechamento"}),a.jsx("div",{className:"bg-surface-2/30 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Data"}),a.jsx("input",{type:"date",value:pe,onChange:he=>be(he.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Observao"}),a.jsx("input",{type:"text",placeholder:"Ex: Feriado, Manuteno",value:V,onChange:he=>B(he.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsx("div",{className:"flex items-end",children:a.jsx(ce,{onClick:Nt,disabled:!pe||J,size:"sm",className:"w-full sm:w-auto",children:"Adicionar"})})]})}),q.length>0?a.jsx("div",{className:"space-y-2",children:q.map(he=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2/50 rounded-lg border border-border",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(vd,{className:"h-4 w-4 text-text-muted"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-text-primary",children:new Date(he.data_fechamento+"T00:00:00").toLocaleDateString("pt-BR")}),he.observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:he.observacao})]})]}),a.jsx(ce,{variant:"outline",size:"sm",onClick:()=>tt(he.id),disabled:J,className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:a.jsx(yl,{className:"h-3 w-3"})})]},he.id))}):a.jsx("div",{className:"text-center py-6 text-sm text-text-muted",children:"Nenhuma data de fechamento configurada"})]})]}),a.jsx(ra,{children:a.jsx(ce,{variant:"outline",onClick:()=>R(!1),children:"Fechar"})})]})})]})})}async function FR({url:e,body:t}){const r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await r.text();let o;try{o=n?JSON.parse(n):null}catch{o={raw:n}}if(!r.ok){const s=o?.message||o?.erro||r.statusText||"Erro na API Transmite Nota",i=new Error(s);throw i.status=r.status,i.response=o??n,i}return o}function rP(e,t){const r=String(e||"").replace(/\/$/,""),n=t.startsWith("/")?t:`/${t}`;return`${r}${n}`}async function Sst({baseUrl:e,apiKey:t,cnpj:r}){const n=rP(e,"/ConsultarEmissaoNotaNfce/");try{const o=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ApiKey:t||"",Cnpj:(r||"").replace(/\D/g,""),Dados:{}})}),s=await o.text();let i;try{i=s?JSON.parse(s):null}catch{}const l=o.status;return l===200?{reachable:!0,authorized:!0,status:l,response:i??s}:l===400?{reachable:!0,authorized:!0,status:l,response:i??s}:l===401||l===403?{reachable:!0,authorized:!1,status:l,response:i??s}:l===404?{reachable:!1,authorized:!1,status:l,response:i??s}:{reachable:!0,authorized:null,status:l,response:i??s}}catch(o){return{reachable:!1,authorized:!1,error:o?.message||String(o)}}}async function Cst({baseUrl:e,apiKey:t,cnpj:r,dados:n}){if(!e)throw new Error("baseUrl obrigatrio");if(!t)throw new Error("apiKey obrigatrio");if(!r)throw new Error("cnpj obrigatrio");if(!n)throw new Error("dados obrigatrio");const o=rP(e,"/EnviarNfce/");return FR({url:o,body:{ApiKey:t,Cnpj:r,Dados:n}})}async function VU({baseUrl:e,apiKey:t,cnpj:r,dados:n}){const o=rP(e,"/ConsultarEmissaoNotaNfce/");return FR({url:o,body:{ApiKey:t,Cnpj:r,Dados:n}})}async function Pst({baseUrl:e,apiKey:t,cnpj:r,dados:n}){const o=rP(e,"/CancelarNfce/");return FR({url:o,body:{ApiKey:t,Cnpj:r,Dados:n}})}function wj(e){const r=(e?.ambiente||"homologacao").toLowerCase()==="producao",n=r?e?.transmitenota_base_url_prod||e?.transmitenota_base_url||"":e?.transmitenota_base_url_hml||e?.transmitenota_base_url||"",o=r?e?.transmitenota_apikey_prod||e?.transmitenota_apikey||"":e?.transmitenota_apikey_hml||e?.transmitenota_apikey||"";return{baseUrl:n,apiKey:o,cnpj:(e?.cnpj||"").replace(/\D/g,"")}}const Ast={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},Est={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function WU({children:e,className:t=""}){return a.jsx(Pr.div,{variants:Est,className:`fx-card ${t}`,children:e})}function As({label:e,...t}){return a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:e}),a.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function kst(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function Ist(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,15)}function pf(e){return String(e||"").replace(/\D/g,"")}function Ost(){const{toast:e}=no(),{company:t,userProfile:r,reloadCompany:n}=So(),[o,s]=p.useState(!1),[i,l]=p.useState({razao_social:"",nome_fantasia:"",cnpj:"",email:"",telefone:"",endereco:"",logo_url:"",inscricao_estadual:"",regime_tributario:"",ambiente:"homologacao",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:"",nfce_serie:"1",nfce_numeracao:"1",nfce_itoken:"",nfe_serie:"",nfe_numeracao:"",transmitenota_apikey:"",transmitenota_base_url:"",transmitenota_base_url_hml:"",transmitenota_apikey_hml:"",transmitenota_base_url_prod:"",transmitenota_apikey_prod:""}),c=p.useRef(null),[d,u]=p.useState(""),f=p.useRef(!0);p.useEffect(()=>(f.current=!0,()=>{f.current=!1}),[]),p.useEffect(()=>{(async()=>{try{const x=r?.codigo_empresa||null;if(!x)return;const b=`empresa:form:${x}`;try{const E=localStorage.getItem(b);if(E){const A=JSON.parse(E);A&&typeof A=="object"&&(l(P=>({...P,...A})),A.logo_url&&u(`${A.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}const w=setTimeout(()=>{if(f.current)try{const E=localStorage.getItem(b);if(E){const A=JSON.parse(E);A&&typeof A=="object"&&(console.warn("[Empresas] slow fallback: using cached form"),l(P=>({...P,...A})),A.logo_url&&u(`${A.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}},5e3),{data:j,error:_}=await fe.from("empresas").select("*").eq("codigo_empresa",x).single();if(clearTimeout(w),_)throw _;if(!f.current)return;const C={razao_social:j?.razao_social||"",nome_fantasia:j?.nome_fantasia||j?.nome||"",cnpj:j?.cnpj||"",email:j?.email||"",telefone:j?.telefone||"",endereco:j?.endereco||"",logo_url:j?.logo_url||"",inscricao_estadual:j?.inscricao_estadual||"",regime_tributario:j?.regime_tributario!=null?String(j.regime_tributario):"",ambiente:j?.ambiente||"homologacao",logradouro:j?.logradouro||"",numero:j?.numero||"",complemento:j?.complemento||"",bairro:j?.bairro||"",cidade:j?.cidade||"",uf:j?.uf||"",cep:j?.cep||"",codigo_municipio_ibge:j?.codigo_municipio_ibge||"",nfce_serie:j?.nfce_serie!=null?String(j.nfce_serie):"1",nfce_numeracao:j?.nfce_numeracao!=null?String(j.nfce_numeracao):"1",nfce_itoken:j?.nfce_itoken||"",nfe_serie:j?.nfe_serie!=null?String(j.nfe_serie):"",nfe_numeracao:j?.nfe_numeracao!=null?String(j.nfe_numeracao):"",transmitenota_apikey:j?.transmitenota_apikey||"",transmitenota_base_url:j?.transmitenota_base_url||"",transmitenota_base_url_hml:j?.transmitenota_base_url_hml||"",transmitenota_apikey_hml:j?.transmitenota_apikey_hml||"",transmitenota_base_url_prod:j?.transmitenota_base_url_prod||"",transmitenota_apikey_prod:j?.transmitenota_apikey_prod||""};l(C),u(C.logo_url?`${C.logo_url.split("?")[0]}?v=${Date.now()}`:"");try{localStorage.setItem(b,JSON.stringify(C))}catch{}}catch(x){console.warn("Falha ao carregar empresa:",x)}})()},[r?.codigo_empresa]),p.useEffect(()=>{if(!i.logo_url){u("");return}const y=i.logo_url.split("?")[0];u(`${y}?v=${Date.now()}`)},[i.logo_url]);const h=async y=>{if(y.preventDefault(),!o){if(!i.razao_social?.trim()||!i.cnpj?.trim()){e({title:"Campos obrigatrios",description:"Preencha Razo Social e CNPJ."});return}if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"No foi possvel identificar a empresa do usurio para salvar."});return}try{s(!0);const x={nome:i.nome_fantasia||i.razao_social||"Empresa",razao_social:i.razao_social||null,nome_fantasia:i.nome_fantasia||null,cnpj:i.cnpj?.replace(/\D/g,"")||null,email:i.email||null,telefone:i.telefone||null,endereco:i.endereco||null,logo_url:i.logo_url||null,inscricao_estadual:i.inscricao_estadual?.trim()||null,regime_tributario:i.regime_tributario?Number(i.regime_tributario):null,ambiente:i.ambiente||"homologacao",logradouro:i.logradouro?.trim()||null,numero:i.numero?.trim()||null,complemento:i.complemento?.trim()||null,bairro:i.bairro?.trim()||null,cidade:i.cidade?.trim()||null,uf:(i.uf||"").toUpperCase().slice(0,2)||null,cep:pf(i.cep)||null,codigo_municipio_ibge:i.codigo_municipio_ibge?.trim()||null,nfce_serie:i.nfce_serie?Number(i.nfce_serie):null,nfce_numeracao:i.nfce_numeracao?Number(i.nfce_numeracao):null,nfce_itoken:i.nfce_itoken?.trim()||null,nfe_serie:i.nfe_serie?Number(i.nfe_serie):null,nfe_numeracao:i.nfe_numeracao?Number(i.nfe_numeracao):null,transmitenota_apikey:i.transmitenota_apikey?.trim()||null,transmitenota_base_url:i.transmitenota_base_url?.trim()||null,transmitenota_base_url_hml:i.transmitenota_base_url_hml?.trim()||null,transmitenota_apikey_hml:i.transmitenota_apikey_hml?.trim()||null,transmitenota_base_url_prod:i.transmitenota_base_url_prod?.trim()||null,transmitenota_apikey_prod:i.transmitenota_apikey_prod?.trim()||null},b=async(w,j=1)=>{try{const{error:_}=await fe.from("empresas").upsert({codigo_empresa:r.codigo_empresa,...w},{onConflict:"codigo_empresa"}).select("id").single();if(_)throw _;return!0}catch(_){const E=String(_?.message||"").match(/the '([^']+)' column|column\s+"([^"]+)"\s+of/i),A=E&&(E[1]||E[2])?E[1]||E[2]:null;if(A&&w.hasOwnProperty(A)&&j<=5){console.warn("[Empresas] Removendo coluna inexistente e tentando novamente:",A);const P={...w};return delete P[A],await b(P,j+1)}throw _}};await b(x),await n?.(),e({title:"Dados salvos",description:"As informaes da empresa foram atualizadas."})}catch(x){console.error(x);const b=(x?.message||x?.hint||"").toString()||"No foi possvel salvar os dados. Verifique as permisses e tente novamente.";e({title:"Erro ao salvar",description:b})}finally{s(!1)}}},m=async y=>{try{const x=y.target.files?.[0];if(!x)return;if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"Seu usurio no est associado a uma empresa."});return}const b=x.name.split(".").pop()?.toLowerCase()||"png",w=`${r.codigo_empresa}/logo.${b}`,j=(()=>{try{return(localStorage.getItem("custom-auth-token")||"").trim()}catch{return""}})();if(j){const E=`${PI}/storage/v1/object/logos/${w}`,A=await fetch(E,{method:"POST",headers:{Authorization:`Bearer ${j}`,apikey:AI,"x-upsert":"true","Content-Type":x.type||"application/octet-stream"},body:x});if(!A.ok){const P=await A.text();let F;try{F=P?JSON.parse(P):null}catch{}const M=F?.message||F?.error||A.statusText||"Falha no upload",I=new Error(M);throw I.status=A.status,I.response=F||P,I}}else{const{data:{session:E}}=await fe.auth.getSession(),A=E?.access_token||"";if(A){const P=`${PI}/storage/v1/object/logos/${w}`,F=await fetch(P,{method:"POST",headers:{Authorization:`Bearer ${A}`,apikey:AI,"x-upsert":"true","Content-Type":x.type||"application/octet-stream"},body:x});if(!F.ok){const M=await F.text();let I;try{I=M?JSON.parse(M):null}catch{}const R=I?.message||I?.error||F.statusText||"Falha no upload",D=new Error(R);throw D.status=F.status,D.response=I||M,D}}else{const{error:P}=await fe.storage.from("logos").upload(w,x,{upsert:!0,contentType:x.type||void 0});if(P)throw P}}const{data:_}=fe.storage.from("logos").getPublicUrl(w),C=_?.publicUrl||"";l(E=>({...E,logo_url:C})),u(C?`${C}?v=${Date.now()}`:""),e({title:"Logo enviada",description:"A imagem foi carregada com sucesso. Lembre-se de salvar."})}catch(x){console.error("Falha no upload da logo:",x),e({title:"Erro no upload",description:"No foi possvel enviar a logo. Tente outro arquivo."})}finally{c.current&&(c.current.value="")}};function v(y){return String(y||"").normalize("NFD").replace(/\p{Diacritic}/gu,"").toLowerCase().trim()}async function g(){const y=pf(i.cnpj);if(y.length!==14){e({title:"CNPJ invlido",description:"Informe 14 dgitos para buscar.",variant:"destructive"});return}try{s(!0);const x=await fetch(`https://brasilapi.com.br/api/cnpj/v1/${y}`);if(!x.ok){let D="Falha ao consultar CNPJ";try{const U=await x.json();U?.message&&(D=U.message)}catch{}throw new Error(D)}const b=await x.json();try{console.info("[empresas] BuscarCNPJ:payload",b)}catch{}const w=b.razao_social||b.nome||"",j=b.nome_fantasia||"",_=b.logradouro||"",C=(b.numero||"").toString(),E=b.complemento||"",A=b.bairro||"",P=b.municipio||b.localidade||"",F=b.uf||"",M=pf(b.cep);let I="";try{if(P&&F){const D=await fetch(`https://brasilapi.com.br/api/ibge/municipios/v1/${F}`);if(D.ok){const U=await D.json(),z=v(P),H=(U||[]).find(q=>v(q.nome)===z);(H?.codigo_ibge||H?.codigo)&&(I=String(H.codigo_ibge||H.codigo))}}}catch{}const R=`${_}${C?", "+C:""}${A?" - "+A:""}${P||F?" - "+P+"/"+F:""}`;l(D=>({...D,razao_social:w,nome_fantasia:j||w,logradouro:_,numero:C,complemento:E,bairro:A,cidade:P,uf:F,cep:M,endereco:R||D.endereco,codigo_municipio_ibge:I||""}));try{console.info("[empresas] BuscarCNPJ:setForm",{razao:w,fantasia:j,logradouro:_,numero:C,complemento:E,bairro:A,cidade:P,uf:F,cep:M,codigoIBGE:I,enderecoFull:R})}catch{}e({title:"CNPJ carregado",description:"Dados preenchidos automaticamente."})}catch(x){e({title:"Falha ao buscar CNPJ",description:x.message||"Tente novamente.",variant:"destructive"})}finally{s(!1)}}return a.jsx(a.Fragment,{children:a.jsxs(Pr.div,{variants:Ast,initial:"hidden",animate:"visible",className:"space-y-6",children:[a.jsx(WU,{children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Cadastros  Empresa"})})}),a.jsxs(WU,{children:[a.jsx("h2",{className:"text-lg font-bold text-text-primary mb-4",children:"Dados da Empresa"}),a.jsxs("form",{onSubmit:h,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx(As,{label:"Razo Social",value:i.razao_social,onChange:y=>l({...i,razao_social:y.target.value}),placeholder:"Ex.: Fluxo7 Arena LTDA"}),a.jsx(As,{label:"Nome Fantasia",value:i.nome_fantasia,onChange:y=>l({...i,nome_fantasia:y.target.value}),placeholder:"Ex.: Fluxo7 Arena"}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("div",{className:"flex-1",children:a.jsx(As,{label:"CNPJ",type:"text",inputMode:"numeric",value:i.cnpj,onChange:y=>l({...i,cnpj:kst(y.target.value)}),placeholder:"00.000.000/0000-00"})}),a.jsx(ce,{type:"button",variant:"outline",onClick:g,disabled:o,children:"Buscar CNPJ"})]}),a.jsx(As,{label:"Email",type:"email",value:i.email,onChange:y=>l({...i,email:y.target.value}),placeholder:"contato@empresa.com"}),a.jsx(As,{label:"Telefone",type:"tel",inputMode:"tel",value:i.telefone,onChange:y=>l({...i,telefone:Ist(y.target.value)}),placeholder:"(11) 99999-9999"}),a.jsx(As,{label:"Endereo",value:i.endereco,onChange:y=>l({...i,endereco:y.target.value}),placeholder:"Rua, nmero, bairro, cidade",className:"md:col-span-2 lg:col-span-2"}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(As,{label:"Inscrio Estadual",value:i.inscricao_estadual,onChange:y=>l({...i,inscricao_estadual:y.target.value})}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Regime Tributrio (CRT)"}),a.jsxs("select",{value:i.regime_tributario,onChange:y=>l({...i,regime_tributario:y.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"Selecione"}),a.jsx("option",{value:"1",children:"1 - Simples Nacional"}),a.jsx("option",{value:"2",children:"2 - Simples (excesso sublimite)"}),a.jsx("option",{value:"3",children:"3 - Regime Normal"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Ambiente"}),a.jsxs("select",{value:i.ambiente,onChange:y=>l({...i,ambiente:y.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"homologacao",children:"Homologao"}),a.jsx("option",{value:"producao",children:"Produo"})]})]})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-6 gap-4",children:[a.jsx("div",{className:"md:col-span-3",children:a.jsx(As,{label:"Logradouro",value:i.logradouro,onChange:y=>l({...i,logradouro:y.target.value})})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(As,{label:"Nmero",value:i.numero,onChange:y=>l({...i,numero:y.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(As,{label:"Complemento",value:i.complemento,onChange:y=>l({...i,complemento:y.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(As,{label:"Bairro",value:i.bairro,onChange:y=>l({...i,bairro:y.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(As,{label:"Cidade",value:i.cidade,onChange:y=>l({...i,cidade:y.target.value})})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(As,{label:"UF",value:i.uf,onChange:y=>l({...i,uf:(y.target.value||"").toUpperCase().slice(0,2)}),placeholder:"UF"})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(As,{label:"CEP",value:i.cep,onChange:y=>l({...i,cep:pf(y.target.value).slice(0,8)}),placeholder:"00000000"})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(As,{label:"Cdigo IBGE Municpio (cMun)",value:i.codigo_municipio_ibge,onChange:y=>l({...i,codigo_municipio_ibge:pf(y.target.value).slice(0,7)})})})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(As,{label:"NFC-e Srie",value:i.nfce_serie,onChange:y=>l({...i,nfce_serie:pf(y.target.value).slice(0,3)})}),a.jsx(As,{label:"NFC-e Numerao Inicial",value:i.nfce_numeracao,onChange:y=>l({...i,nfce_numeracao:pf(y.target.value).slice(0,9)})}),a.jsx(As,{label:"NFC-e IToken (CSC)",value:i.nfce_itoken,onChange:y=>l({...i,nfce_itoken:y.target.value})})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(As,{label:"NF-e Srie (opcional)",value:i.nfe_serie,onChange:y=>l({...i,nfe_serie:pf(y.target.value).slice(0,3)})}),a.jsx(As,{label:"NF-e Numerao (opcional)",value:i.nfe_numeracao,onChange:y=>l({...i,nfe_numeracao:pf(y.target.value).slice(0,9)})})]}),!1,a.jsx("div",{className:"md:col-span-2 lg:col-span-2 grid grid-cols-1 gap-3",children:a.jsxs("div",{className:"flex items-center gap-4",children:[d||i.logo_url?a.jsx("img",{src:d||i.logo_url,alt:"Logo da empresa",className:"w-16 h-16 rounded-md object-cover border border-border"}):a.jsx("div",{className:"w-16 h-16 rounded-md border border-dashed border-border/60 bg-surface-2/40 flex items-center justify-center text-xs text-text-muted",children:"Sem logo"}),a.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Upload da Logo"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ce,{type:"button",variant:"outline",onClick:()=>c.current?.click(),className:"px-3",children:"Escolher imagem"}),a.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:m,className:"hidden"}),(d||i.logo_url)&&a.jsx("span",{className:"text-xs text-text-muted truncate max-w-[260px]",title:i.logo_url||d,children:"Logo selecionada"})]}),a.jsx("span",{className:"text-[11px] text-text-muted",children:"Formatos: PNG/JPG. Tamanho recomendado: 256x256."})]})]})}),a.jsx("div",{className:"flex items-end",children:a.jsx(ce,{type:"submit",className:"w-full md:w-auto",disabled:o,children:o?"Salvando...":"Salvar"})})]})]})]})})}const Tst={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},r_={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},HU=[{codigo:"01",nome:"Dinheiro"},{codigo:"02",nome:"Cheque"},{codigo:"03",nome:"Carto de Crdito"},{codigo:"04",nome:"Carto de Dbito"},{codigo:"05",nome:"Carto da Loja (Private Label)"},{codigo:"10",nome:"Vale Alimentao"},{codigo:"11",nome:"Vale Refeio"},{codigo:"12",nome:"Vale Presente"},{codigo:"13",nome:"Vale Combustvel"},{codigo:"14",nome:"Duplicata Mercantil"},{codigo:"15",nome:"Boleto Bancrio"},{codigo:"16",nome:"Depsito Bancrio"},{codigo:"17",nome:"PIX Dinmico (QR-Code)"},{codigo:"18",nome:"Transferncia Bancria / Carteira Digital"},{codigo:"19",nome:"Programa de Fidelidade / Cashback"},{codigo:"20",nome:"PIX Esttico"},{codigo:"21",nome:"Crdito em Loja"},{codigo:"22",nome:"Pagamento Eletrnico no Informado"},{codigo:"90",nome:"Sem Pagamento"},{codigo:"99",nome:"Outros"}],JE=({icon:e,title:t,value:r,subtitle:n,color:o,onClick:s,isActive:i})=>a.jsx(Pr.div,{variants:r_,onClick:s,className:mr("bg-surface rounded-lg border md:border-2 p-3 md:p-4 transition-all text-center h-[90px] md:h-auto",s?"cursor-pointer hover:shadow-md":"",i?`border-${o} bg-${o}/5`:"border-border",s&&!i?"hover:border-border-hover":""),children:a.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 md:flex-row md:items-center md:gap-3 h-full",children:[a.jsx("div",{className:mr("p-1.5 md:p-2 rounded-lg",`bg-${o}/10`),children:a.jsx(e,{className:mr("w-4 h-4 md:w-5 md:h-5",`text-${o}`)})}),a.jsxs("div",{className:"flex-1 md:text-left",children:[a.jsx("p",{className:"text-base md:text-2xl font-bold text-text-primary leading-none",children:r}),a.jsx("p",{className:"text-[10px] md:text-xs font-semibold text-text-secondary md:mt-0.5",children:t}),a.jsx("p",{className:"hidden md:block text-xs text-text-muted",children:n})]})]})});function Dst(){const{toast:e}=no(),{userProfile:t,authReady:r}=So(),[n,o]=p.useState([]),[s,i]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(""),[f,h]=p.useState("all"),[m,v]=p.useState("all"),[g,y]=p.useState(!0),[x,b]=p.useState(null),[w,j]=p.useState(!1),[_,C]=p.useState(null),[E,A]=p.useState({codigo_interno:"",codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),[P,F]=p.useState(!1),[M,I]=p.useState(""),[R,D]=p.useState(!1),[U,z]=p.useState(null),[H,q]=p.useState(null),[Q,pe]=p.useState(!1),[be,V]=p.useState("mes"),[B,J]=p.useState(!1),[ue,Ne]=p.useState([]),[Z,ge]=p.useState("customizado"),[le,se]=p.useState(""),[ee,de]=p.useState(""),[Le,ae]=p.useState(!1),[ie,dt]=p.useState(!1);p.useEffect(()=>{const Be=()=>{try{dt(typeof window<"u"&&window.innerWidth<=640)}catch{}};return Be(),window.addEventListener("resize",Be),()=>window.removeEventListener("resize",Be)},[]);const At=async()=>{try{i(!0);const Be=t?.codigo_empresa;if(!Be)return;const we=await Wm({somenteAtivas:!1,codigoEmpresa:Be});console.log(" Finalizadoras carregadas:",we),console.log(" Primeira finalizadora:",we?.[0]),o(Array.isArray(we)?we:[])}catch(Be){e({title:"Erro ao carregar",description:Be?.message,variant:"destructive"})}finally{i(!1)}},st=p.useMemo(()=>{const Be=n.length,we=n.filter(hr=>hr.ativo).length,He=n.length>0?n.reduce((hr,Mt)=>{const Qt=Mt.nome||"Sem nome";return hr[Qt]=(hr[Qt]||0)+1,hr},{}):{},ht=Object.entries(He).sort((hr,Mt)=>Mt[1]-hr[1])[0],zt=ht?ht[0]:"-";return{total:Be,ativas:we,maisUsada:zt}},[n]),ut=p.useMemo(()=>{let Be=[...n];if(d){const we=d.toLowerCase();Be=Be.filter(He=>{const ht=String(He.tipo||"").toLowerCase(),zt=String(He.nome||"").toLowerCase(),hr=String(He.codigo_interno||"").toLowerCase(),Mt=we.replace(/\D/g,""),Qt=String(He.codigo_interno||"").replace(/\D/g,"");return ht.includes(we)||zt.includes(we)||hr.includes(we)||!!Mt&&Qt===Mt})}return f!=="all"&&(Be=Be.filter(we=>we.tipo===f)),m!=="all"&&(Be=Be.filter(we=>m==="active"?we.ativo:!we.ativo)),x==="ativas"&&(Be=Be.filter(we=>we.ativo)),Be.sort((we,He)=>{const ht=parseInt(we.codigo_interno)||0,zt=parseInt(He.codigo_interno)||0;return ht-zt}),Be},[n,d,f,m,x]),Rt=()=>{C(null);const Be=n.reduce((He,ht)=>{const zt=parseInt(ht.codigo_interno)||0;return zt>He?zt:He},0),we=String(Be+1).padStart(2,"0");A({codigo_interno:we,codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),j(!0)},Nt=Be=>{C(Be),A({codigo_interno:Be.codigo_interno||"",codigo_sefaz:Be.codigo_sefaz||"",nome:Be.nome||"",taxa_percentual:Be.taxa_percentual!=null?String(Be.taxa_percentual):"",ativo:Be.ativo!==!1}),j(!0)},tt=async(Be,we="mes")=>{try{pe(!0);const He=t?.codigo_empresa;if(!He)return;const ht=new Date;let zt,hr=ht.toISOString();switch(we){case"hoje":zt=new Date(ht.setHours(0,0,0,0)).toISOString();break;case"semana":zt=new Date(ht.setDate(ht.getDate()-7)).toISOString();break;case"mes":zt=new Date(ht.setMonth(ht.getMonth()-1)).toISOString();break;default:zt=new Date(ht.setMonth(ht.getMonth()-1)).toISOString()}const{data:Mt,error:Qt}=await fe.from("pagamentos").select("valor, recebido_em, status").eq("finalizadora_id",Be).eq("codigo_empresa",He).gte("recebido_em",zt).lte("recebido_em",hr).neq("status","Cancelado").neq("status","Estornado");if(Qt)throw Qt;const Se=Mt?.length||0,kt=Mt?.reduce((yr,Xt)=>yr+(Number(Xt.valor)||0),0)||0,Lt=Se>0?kt/Se:0,fr=Mt?.[Mt.length-1]?.recebido_em||null;q({transacoes:Se,faturamento:kt,ticketMedio:Lt,ultimaUtilizacao:fr})}catch(He){console.error("Erro ao carregar estatsticas:",He),e({title:"Erro ao carregar estatsticas",description:He?.message,variant:"destructive"})}finally{pe(!1)}},he=async(Be="customizado",we=null,He=null)=>{try{ae(!0);const ht=t?.codigo_empresa;if(!ht)return;let zt,hr;if(Be==="customizado"&&we&&He)zt=new Date(we).toISOString(),hr=new Date(He+"T23:59:59").toISOString();else{const Lt=new Date;switch(hr=Lt.toISOString(),Be){case"hoje":zt=new Date(Lt.setHours(0,0,0,0)).toISOString();break;case"semana":zt=new Date(Lt.setDate(Lt.getDate()-7)).toISOString();break;case"mes":zt=new Date(Lt.setMonth(Lt.getMonth()-1)).toISOString();break;default:zt=new Date(Lt.setMonth(Lt.getMonth()-1)).toISOString()}}const{data:Mt,error:Qt}=await fe.from("pagamentos").select("finalizadora_id, valor, finalizadoras!pagamentos_finalizadora_id_fkey(id, codigo_interno, nome)").eq("codigo_empresa",ht).gte("recebido_em",zt).lte("recebido_em",hr).neq("status","Cancelado").neq("status","Estornado");if(Qt)throw Qt;const Se={};Mt?.forEach(Lt=>{const fr=Lt.finalizadora_id;fr&&(Se[fr]||(Se[fr]={id:fr,codigo:Lt.finalizadoras?.codigo_interno||"-",nome:Lt.finalizadoras?.nome||"Sem nome",total:0,transacoes:0}),Se[fr].total+=Number(Lt.valor)||0,Se[fr].transacoes+=1)});const kt=Object.values(Se).sort((Lt,fr)=>fr.total-Lt.total);Ne(kt)}catch(ht){console.error("Erro ao carregar ranking:",ht),e({title:"Erro ao carregar ranking",description:ht?.message,variant:"destructive"})}finally{ae(!1)}},ke=()=>{J(!0),ge("customizado");const Be=new Date,we=new Date;we.setMonth(we.getMonth()-1),se(we.toISOString().split("T")[0]),de(Be.toISOString().split("T")[0]),he("customizado",we.toISOString().split("T")[0],Be.toISOString().split("T")[0])},et=Be=>{z(Be),D(!0),V("mes"),tt(Be.id,"mes")},Me=async()=>{try{if(!E.nome?.trim()){e({title:"Nome  obrigatrio",variant:"warning"});return}if(!E.codigo_sefaz){e({title:"Cdigo SEFAZ  obrigatrio",variant:"warning"});return}if(E.codigo_interno?.trim()&&n.some(ht=>ht.codigo_interno===E.codigo_interno.trim()&&(!_||ht.id!==_.id))){e({title:"Cdigo j existe",description:"Este cdigo interno j est em uso por outra finalizadora",variant:"warning"});return}c(!0);const Be=t?.codigo_empresa,we={codigo_interno:E.codigo_interno?.trim()||null,codigo_sefaz:E.codigo_sefaz,nome:E.nome.trim(),tipo:"outros",taxa_percentual:E.taxa_percentual===""?null:Number(E.taxa_percentual),ativo:E.ativo};_?(await BGe(_.id,we,Be),e({title:"Finalizadora atualizada!",variant:"success"})):(await $Ge(we,Be),e({title:"Finalizadora criada!",variant:"success"})),j(!1),await At()}catch(Be){e({title:"Erro ao salvar",description:Be?.message,variant:"destructive"})}finally{c(!1)}},$e=async Be=>{try{await qGe(Be.id,!Be.ativo,t?.codigo_empresa),e({title:Be.ativo?"Desativada":"Ativada",variant:"success"}),await At()}catch(we){e({title:"Erro ao alterar status",description:we?.message,variant:"destructive"})}};return p.useEffect(()=>{r&&t?.codigo_empresa&&At()},[r,t?.codigo_empresa]),a.jsxs(a.Fragment,{children:[a.jsxs(Pr.div,{variants:Tst,initial:"hidden",animate:"visible",className:"flex-1 space-y-6 p-4 md:p-6",children:[a.jsxs(Pr.div,{variants:r_,className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"min-w-0",children:a.jsx("h1",{className:"text-2xl md:text-3xl font-black text-text-primary tracking-tight leading-tight",children:"Finalizadoras"})}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(ce,{variant:"ghost",size:"icon",onClick:()=>y(!g),className:"h-9 w-9",children:g?a.jsx(Mp,{className:"h-5 w-5"}):a.jsx(Qp,{className:"h-5 w-5"})}),a.jsxs(ce,{onClick:Rt,className:"gap-2 h-9 px-3 whitespace-nowrap",children:[a.jsx(ro,{className:"h-4 w-4"}),a.jsx("span",{className:"md:hidden",children:"Nova"}),a.jsx("span",{className:"hidden md:inline",children:"Nova Finalizadora"})]})]})]}),g&&a.jsxs("div",{className:"grid grid-cols-3 gap-3 md:grid-cols-3 md:gap-6",children:[a.jsx(JE,{icon:qm,title:"Total",value:st.total,subtitle:"Finalizadoras cadastradas",color:"brand"}),a.jsx(JE,{icon:Ks,title:"Ativas",value:st.ativas,subtitle:"Disponveis para uso",color:"success",onClick:()=>b(x==="ativas"?null:"ativas"),isActive:x==="ativas"}),a.jsx(JE,{icon:Zp,title:"Mais Usada",value:st.maisUsada,subtitle:"Mtodo mais popular",color:"warning",onClick:ke})]}),a.jsx(Pr.div,{variants:r_,className:"bg-surface rounded-lg border border-border p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative min-w-0 basis-0 flex-grow",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar finalizadora...",value:d,onChange:Be=>u(Be.target.value),className:"pl-10 h-11"})]}),a.jsxs(Cn,{value:m,onValueChange:v,children:[a.jsx(jn,{className:"w-[110px] md:w-[180px]",children:a.jsx(An,{placeholder:"Filtrar por status"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Todos"}),a.jsx(nt,{value:"active",children:"Ativas"}),a.jsx(nt,{value:"inactive",children:"Inativas"})]})]})]})}),a.jsx(Pr.div,{variants:r_,className:"bg-surface rounded-lg border border-border overflow-hidden",children:s?a.jsxs("div",{className:"p-12 text-center",children:[a.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),a.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):ut.length===0?a.jsxs("div",{className:"p-12 text-center text-text-muted",children:[a.jsx(qm,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Nenhuma finalizadora encontrada"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden divide-y divide-border",children:ut.map(Be=>a.jsxs("div",{className:"p-3 flex flex-col gap-2 hover:bg-surface-2/50 cursor-pointer",onClick:()=>et(Be),children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"px-2 py-0.5 rounded-md bg-surface-2 border border-border font-mono text-xs text-text-secondary",children:Be.codigo_interno||"-"}),a.jsx("span",{className:"font-semibold text-sm text-text-primary truncate",title:Be.nome,children:Be.nome})]}),a.jsxs("span",{className:mr("inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[11px] font-medium",Be.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[a.jsx("span",{className:mr("w-1.5 h-1.5 rounded-full",Be.ativo?"bg-success":"bg-muted")}),Be.ativo?"Ativa":"Inativa"]})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-text-secondary",children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("span",{children:["Taxa: ",Be.taxa_percentual?`${Be.taxa_percentual}%`:"-"]})}),a.jsxs("div",{className:"flex items-center gap-2",onClick:we=>we.stopPropagation(),children:[a.jsx(ce,{variant:"ghost",size:"sm",className:"h-7 px-2",onClick:()=>Nt(Be),children:a.jsx(fl,{className:"h-4 w-4"})}),a.jsx(ce,{variant:Be.ativo?"ghost":"default",size:"sm",className:"h-7 px-2",onClick:()=>$e(Be),children:Be.ativo?"Desativar":"Ativar"})]})]})]},Be.id))}),a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-surface-2 border-b border-border",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Cdigo"}),a.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Descrio"}),a.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Taxa (%)"}),a.jsx("th",{className:"text-center px-6 py-4 text-sm font-semibold text-text-secondary",children:"Status"}),a.jsx("th",{className:"text-right px-6 py-4 text-sm font-semibold text-text-secondary",children:"Aes"})]})}),a.jsx("tbody",{className:"divide-y divide-border",children:ut.map(Be=>a.jsxs("tr",{className:"hover:bg-surface-2/50 transition-colors cursor-pointer",onClick:()=>et(Be),children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"font-mono text-sm text-text-primary",children:Be.codigo_interno||"-"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"font-semibold text-text-primary",children:Be.nome})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"text-text-secondary",children:Be.taxa_percentual?`${Be.taxa_percentual}%`:"-"})}),a.jsx("td",{className:"px-6 py-4 text-center",children:a.jsxs("span",{className:mr("inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium",Be.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[a.jsx("span",{className:mr("w-2 h-2 rounded-full",Be.ativo?"bg-success":"bg-muted")}),Be.ativo?"Ativa":"Inativa"]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex justify-end gap-2",onClick:we=>we.stopPropagation(),children:[a.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>Nt(Be),children:a.jsx(fl,{className:"h-4 w-4"})}),a.jsx(ce,{variant:Be.ativo?"ghost":"default",size:"sm",onClick:()=>$e(Be),children:Be.ativo?"Desativar":"Ativar"})]})})]},Be.id))})]})})]})})]}),a.jsx(xn,{open:w,onOpenChange:j,children:a.jsxs(vn,{className:"sm:max-w-[500px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:_?"Editar Finalizadora":"Nova Finalizadora"}),a.jsx(On,{children:_?"Atualize as informaes da finalizadora":"Adicione um novo mtodo de pagamento"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"codigo_interno",children:"Cdigo Finalizadora"}),a.jsx(Je,{id:"codigo_interno",type:"text",placeholder:"Ex: 01, 02, 03...",value:E.codigo_interno,onChange:Be=>A({...E,codigo_interno:Be.target.value})}),a.jsx("p",{className:"text-xs text-text-muted",children:"Gerado automaticamente, mas pode ser editado"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"nome",children:"Descrio *"}),a.jsx(Je,{id:"nome",placeholder:"Ex: PIX, Dinheiro, Carto de Crdito...",value:E.nome,onChange:Be=>A({...E,nome:Be.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"codigo_sefaz",children:"Forma de Pagamento NF-e/NFC-e *"}),a.jsx(ce,{type:"button",variant:"outline",className:"justify-between w-full",onClick:()=>F(!0),children:E.codigo_sefaz?`${E.codigo_sefaz} - ${HU.find(Be=>Be.codigo===E.codigo_sefaz)?.nome||""}`:"Selecione a forma de pagamento"}),a.jsx("p",{className:"text-xs text-text-muted",children:"A lista abrir em um modal com rolagem."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"taxa",children:"Taxa"}),a.jsxs("div",{className:"relative",children:[a.jsx(Je,{id:"taxa",inputMode:"decimal",placeholder:"0,00",className:"pr-10",value:E.taxa_percentual,onChange:Be=>{const we=String(Be.target.value).replace(/[^0-9.,]/g,"").replace(/,/g,".");if(we===""){A({...E,taxa_percentual:""});return}const He=Number(we);if(Number.isFinite(He)){const ht=Math.max(0,Math.min(100,He));A({...E,taxa_percentual:String(ht)})}},onBlur:()=>{const Be=String(E.taxa_percentual||"").replace(/,/g,".");if(Be==="")return;const we=Number(Be);if(Number.isFinite(we)){const He=Math.max(0,Math.min(100,we));A(ht=>({...ht,taxa_percentual:He.toFixed(2)}))}}}),a.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-muted text-sm",children:"%"})]}),a.jsx("p",{className:"text-xs text-text-muted",children:"Deixe vazio se no houver taxa"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"ativo",checked:E.ativo,onChange:Be=>A({...E,ativo:Be.target.checked}),className:"h-4 w-4 rounded border-border"}),a.jsx(De,{htmlFor:"ativo",className:"text-sm font-normal cursor-pointer",children:"Finalizadora ativa"})]})]}),a.jsxs(ra,{children:[a.jsx(ce,{variant:"outline",onClick:()=>j(!1),disabled:l,children:"Cancelar"}),a.jsx(ce,{onClick:Me,disabled:l,children:l?"Salvando...":"Salvar"})]})]})}),a.jsx(xn,{open:P,onOpenChange:F,children:a.jsxs(vn,{className:"sm:max-w-[520px] w-[92vw]",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Selecionar Forma de Pagamento (SEFAZ)"}),a.jsx(On,{children:"Busque por cdigo ou nome"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(Je,{placeholder:"Ex.: 03, crdito, pix...",value:M,onChange:Be=>I(Be.target.value)}),a.jsx("div",{className:"max-h-[420px] overflow-auto fx-scroll rounded-md border border-border",children:a.jsx("ul",{className:"divide-y divide-border",children:HU.filter(Be=>{const we=(M||"").toLowerCase();return we?Be.codigo.includes(we)||String(Be.nome).toLowerCase().includes(we):!0}).map(Be=>a.jsx("li",{children:a.jsxs("button",{type:"button",className:`w-full text-left px-3 py-2 hover:bg-surface-2 ${E.codigo_sefaz===Be.codigo?"bg-surface-2":""}`,onClick:()=>{A(we=>({...we,codigo_sefaz:Be.codigo})),F(!1)},children:[a.jsx("span",{className:"font-mono mr-2 text-text-secondary",children:Be.codigo}),a.jsx("span",{children:Be.nome})]})},Be.codigo))})})]})]})}),a.jsx(xn,{open:R,onOpenChange:D,children:a.jsxs(vn,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Detalhes da Finalizadora"}),a.jsx(On,{children:"Estatsticas e informaes completas"})]}),U&&a.jsxs("div",{className:"space-y-6 py-4",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Informaes"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Cdigo Finalizadora"}),a.jsx("p",{className:"font-mono text-sm text-text-primary",children:U.codigo_interno||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento NF-e/NFC-e"}),a.jsx("p",{className:"font-mono text-sm text-text-primary",children:U.codigo_sefaz||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Descrio"}),a.jsx("p",{className:"font-medium text-text-primary",children:U.nome})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Taxa"}),a.jsx("p",{className:"font-medium text-text-primary",children:U.taxa_percentual?`${U.taxa_percentual}%`:"Sem taxa"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Status"}),a.jsxs("span",{className:mr("inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs font-medium",U.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[a.jsx("span",{className:mr("w-2 h-2 rounded-full",U.ativo?"bg-success":"bg-muted")}),U.ativo?"Ativa":"Inativa"]})]})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Perodo de Anlise"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{variant:be==="hoje"?"default":"outline",size:"sm",onClick:()=>{V("hoje"),tt(U.id,"hoje")},children:"Hoje"}),a.jsx(ce,{variant:be==="semana"?"default":"outline",size:"sm",onClick:()=>{V("semana"),tt(U.id,"semana")},children:"7 Dias"}),a.jsx(ce,{variant:be==="mes"?"default":"outline",size:"sm",onClick:()=>{V("mes"),tt(U.id,"mes")},children:"30 Dias"})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Estatsticas de Uso"}),Q?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-brand border-t-transparent"})}):H?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Total de Transaes"}),a.jsx("span",{className:"font-semibold text-text-primary",children:H.transacoes})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Faturamento Total"}),a.jsxs("span",{className:"font-semibold text-success",children:["R$ ",H.faturamento.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Ticket Mdio"}),a.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",H.ticketMedio.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"ltima Utilizao"}),a.jsx("span",{className:"font-medium text-text-muted",children:H.ultimaUtilizacao?new Date(H.ultimaUtilizacao).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Nunca utilizada"})]})]}):a.jsx("div",{className:"text-center py-8 text-text-muted",children:a.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel"})})]})]}),a.jsxs(ra,{children:[a.jsx(ce,{variant:"outline",onClick:()=>D(!1),children:"Fechar"}),a.jsxs(ce,{onClick:()=>{D(!1),Nt(U)},children:[a.jsx(fl,{className:"h-4 w-4 mr-2"}),"Editar"]})]})]})}),a.jsx(xn,{open:B,onOpenChange:J,children:a.jsxs(vn,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Ranking de Finalizadoras"}),a.jsx(On,{children:"Faturamento por forma de pagamento"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx(ce,{variant:Z==="hoje"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{ge("hoje"),he("hoje")},children:"Hoje"}),a.jsx(ce,{variant:Z==="semana"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{ge("semana"),he("semana")},children:"7 Dias"}),a.jsx(ce,{variant:Z==="mes"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{ge("mes"),he("mes")},children:"30 Dias"}),a.jsx(ce,{variant:Z==="customizado"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>ge("customizado"),children:"Perodo"})]}),Z==="customizado"&&(ie?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx(De,{className:"text-xs",children:"Data Inicial"}),a.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:le,onChange:Be=>se(Be.target.value)})]}),a.jsxs("div",{children:[a.jsx(De,{className:"text-xs",children:"Data Final"}),a.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:ee,onChange:Be=>de(Be.target.value)})]})]}),a.jsx(ce,{className:"w-full",onClick:()=>he("customizado",le,ee),disabled:!le||!ee||Le,children:Le?"Buscando...":"Buscar"})]}):a.jsxs("div",{className:"flex gap-3 items-end",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx(De,{children:"Data Inicial"}),a.jsxs(Oc,{children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"outline",className:mr("w-full justify-start text-left font-normal",!le&&"text-text-muted"),children:[a.jsx(Ns,{className:"mr-2 h-4 w-4"}),le?new Date(le+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),a.jsx(Hl,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:a.jsx(uT,{mode:"single",selected:le?new Date(le+"T12:00:00"):void 0,onSelect:Be=>{if(Be){const we=Be.getFullYear(),He=String(Be.getMonth()+1).padStart(2,"0"),ht=String(Be.getDate()).padStart(2,"0");se(`${we}-${He}-${ht}`)}},className:"p-3"})})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx(De,{children:"Data Final"}),a.jsxs(Oc,{children:[a.jsx(Tc,{asChild:!0,children:a.jsxs(ce,{variant:"outline",className:mr("w-full justify-start text-left font-normal",!ee&&"text-text-muted"),children:[a.jsx(Ns,{className:"mr-2 h-4 w-4"}),ee?new Date(ee+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),a.jsx(Hl,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:a.jsx(uT,{mode:"single",selected:ee?new Date(ee+"T12:00:00"):void 0,onSelect:Be=>{if(Be){const we=Be.getFullYear(),He=String(Be.getMonth()+1).padStart(2,"0"),ht=String(Be.getDate()).padStart(2,"0");de(`${we}-${He}-${ht}`)}},className:"p-3"})})]})]}),a.jsx(ce,{onClick:()=>he("customizado",le,ee),disabled:!le||!ee||Le,children:"Buscar"})]}))]}),Le?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand border-t-transparent"})}):ue.length===0?a.jsx("div",{className:"text-center py-12 text-text-muted",children:a.jsx("p",{children:"Nenhuma transao no perodo selecionado"})}):a.jsx("div",{className:"space-y-3",children:ue.map((Be,we)=>a.jsx("div",{className:"bg-surface-2 rounded-lg p-3 md:p-4 border border-border",children:a.jsxs("div",{className:"flex items-start md:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-start md:items-center gap-2 md:gap-3 flex-1 min-w-0",children:[a.jsxs("div",{className:mr("flex items-center justify-center w-7 h-7 md:w-8 md:h-8 rounded-full font-bold text-xs md:text-sm flex-shrink-0",we===0?"bg-warning/20 text-warning":we===1?"bg-info/20 text-info":we===2?"bg-success/20 text-success":"bg-muted/20 text-muted"),children:[we+1,""]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[a.jsx("span",{className:"font-mono text-[10px] md:text-xs text-text-muted",children:Be.codigo}),a.jsx("span",{className:"font-semibold text-sm md:text-base text-text-primary truncate",children:Be.nome})]}),a.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted",children:[Be.transacoes," transaes"]})]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsxs("p",{className:"text-base md:text-lg font-bold text-success whitespace-nowrap",children:["R$ ",Be.total.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),a.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted whitespace-nowrap",children:["Mdia: R$ ",(Be.total/Be.transacoes).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})},Be.id))})]}),a.jsx(ra,{children:a.jsx(ce,{variant:"outline",onClick:()=>J(!1),children:"Fechar"})})]})})]})}function Mst(){return a.jsxs("div",{className:"p-8",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Pgina de Teste"}),a.jsx("p",{children:"Esta  uma pgina de teste para verificar se o roteamento est funcionando corretamente."})]})}function Rst(){const[e,t]=p.useState(!1),[r,n]=p.useState(""),[o,s]=p.useState("Manuteno em andamento. Volte em breve!"),[i,l]=p.useState(!1),[c,d]=p.useState("");p.useEffect(()=>{try{const h=localStorage.getItem("maintenance:active")==="false",m=localStorage.getItem("maintenance:end")||"",v=localStorage.getItem("maintenance:message")||"Manuteno em andamento. Volte em breve!";t(h),n(m),s(v)}catch{}},[]);const u=h=>{if(h?.preventDefault(),e&&!r){alert("Defina uma data de trmino para a manuteno");return}localStorage.setItem("maintenance:active",e),localStorage.setItem("maintenance:end",r),localStorage.setItem("maintenance:message",o),window.dispatchEvent(new Event("storage")),l(!1),d(" Configuraes salvas!"),setTimeout(()=>d(""),3e3)},f=()=>{const h=!e;if(t(h),localStorage.setItem("maintenance:active",String(h)),h&&!r){const m=new Date;m.setDate(m.getDate()+1);const v=m.toISOString().slice(0,16);n(v),localStorage.setItem("maintenance:end",v)}window.dispatchEvent(new Event("storage")),d(h?" Modo manuteno ATIVADO":" Modo manuteno DESATIVADO"),setTimeout(()=>d(""),3e3)};return a.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg mt-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Controle de Manuteno"}),a.jsx("button",{onClick:f,className:`inline-flex items-center px-4 py-2 rounded-md font-medium ${e?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:e?"Manuteno ATIVA":"Manuteno INATIVA"})]}),e&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"font-medium text-lg",children:"Configuraes"}),a.jsxs("button",{onClick:()=>l(!i),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 text-sm",children:[a.jsx(fl,{className:"w-4 h-4"}),i?"Ocultar":"Editar"]})]}),i?a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Trmino"}),a.jsx("div",{className:"relative",children:a.jsx("input",{type:"datetime-local",value:r,onChange:h=>n(h.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:new Date().toISOString().slice(0,16),required:!0})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensagem de Manuteno"}),a.jsx("textarea",{value:o,onChange:h=>s(h.target.value),rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Ex: Estamos em manuteno programada. Volte em breve!",required:!0})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[a.jsx(Rue,{className:"inline w-4 h-4 mr-1"}),"Salvar"]})]})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Trmino:"}),a.jsx("p",{className:"text-gray-900",children:r?new Date(r).toLocaleString():"No definido"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mensagem:"}),a.jsx("p",{className:"text-gray-900 whitespace-pre-line",children:o})]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Como usar:"}),a.jsxs("ol",{className:"list-decimal pl-5 space-y-1",children:[a.jsx("li",{children:"Ative/desative o boto no topo"}),a.jsx("li",{children:"Defina a data de trmino e uma mensagem amigvel"}),a.jsx("li",{children:"Salve as configuraes"}),a.jsx("li",{children:"Para acessar durante a manuteno, use a senha no link"})]})]}),c&&a.jsx("div",{className:"fixed bottom-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded shadow-lg",children:c})]})}function Lst(e){const t=new URLSearchParams(e.startsWith("#")?e.slice(1):e),r=t.get("access_token"),n=t.get("refresh_token");return{access_token:r,refresh_token:n}}const Fst=()=>{const{toast:e}=no(),t=Yi(),[r,n]=p.useState(""),[o,s]=p.useState(""),[i,l]=p.useState(!1),[c,d]=p.useState(!1),u=p.useMemo(()=>Lst(window.location.hash),[]);p.useEffect(()=>{(async()=>{const{data:{session:m}}=await fe.auth.getSession();if(m){d(!0);return}if(u.access_token&&u.refresh_token){const{data:v,error:g}=await fe.auth.setSession({access_token:u.access_token,refresh_token:u.refresh_token});g&&e({title:"Link invlido ou expirado",description:"Abra o link do email novamente.",variant:"destructive"}),d(!!v?.session)}else e({title:"Link invlido",description:"Abra o link de redefinio enviado por email.",variant:"destructive"})})()},[]);const f=async h=>{if(h.preventDefault(),r.length<6){e({title:"Senha muito curta",description:"A senha deve ter pelo menos 6 caracteres.",variant:"destructive"});return}if(r!==o){e({title:"Senhas no conferem",description:"As senhas digitadas so diferentes.",variant:"destructive"});return}l(!0);const{data:m,error:v}=await fe.auth.updateUser({password:r});if(l(!1),v){e({title:"Erro ao redefinir senha",description:v.message||"Tente novamente.",variant:"destructive"});return}e({title:"Senha redefinida",description:"Voc j pode acessar o sistema.",variant:"default"}),t("/")};return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-6",children:a.jsxs("div",{className:"w-full max-w-md bg-surface rounded-xl border border-border p-6 shadow",children:[a.jsx("h1",{className:"text-2xl font-semibold mb-2 text-text-primary",children:"Redefinir senha"}),a.jsx("p",{className:"text-sm text-text-secondary mb-6",children:"Defina uma nova senha para sua conta."}),a.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Nova senha"}),a.jsx(Je,{type:"password",value:r,onChange:h=>n(h.target.value),placeholder:"",disabled:!c||i})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Confirmar nova senha"}),a.jsx(Je,{type:"password",value:o,onChange:h=>s(h.target.value),placeholder:"",disabled:!c||i})]}),a.jsx(ce,{type:"submit",className:"w-full",disabled:!c||i,children:i?"Salvando...":"Salvar nova senha"})]})]})})};function $st(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var Yoe=p,Bst=$st(Yoe);function GU(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qst(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var zst=!!(typeof window<"u"&&window.document&&window.document.createElement);function Ust(e,t,r){if(typeof e!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof t!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof r<"u"&&typeof r!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function n(o){return o.displayName||o.name||"Component"}return function(s){if(typeof s!="function")throw new Error("Expected WrappedComponent to be a React component.");var i=[],l;function c(){l=e(i.map(function(u){return u.props})),d.canUseDOM?t(l):r&&(l=r(l))}var d=function(u){qst(f,u);function f(){return u.apply(this,arguments)||this}f.peek=function(){return l},f.rewind=function(){if(f.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var v=l;return l=void 0,i=[],v};var h=f.prototype;return h.UNSAFE_componentWillMount=function(){i.push(this),c()},h.componentDidUpdate=function(){c()},h.componentWillUnmount=function(){var v=i.indexOf(this);i.splice(v,1),c()},h.render=function(){return Bst.createElement(s,this.props)},f}(Yoe.PureComponent);return GU(d,"displayName","SideEffect("+n(s)+")"),GU(d,"canUseDOM",zst),d}}var Vst=Ust;const Wst=Ga(Vst);var Hst=typeof Element<"u",Gst=typeof Map=="function",Kst=typeof Set=="function",Xst=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function n_(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n,o;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!n_(e[n],t[n]))return!1;return!0}var s;if(Gst&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s=e.entries();!(n=s.next()).done;)if(!t.has(n.value[0]))return!1;for(s=e.entries();!(n=s.next()).done;)if(!n_(n.value[1],t.get(n.value[0])))return!1;return!0}if(Kst&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s=e.entries();!(n=s.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(Xst&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[n]))return!1;if(Hst&&e instanceof Element)return!1;for(n=r;n--!==0;)if(!((o[n]==="_owner"||o[n]==="__v"||o[n]==="__o")&&e.$$typeof)&&!n_(e[o[n]],t[o[n]]))return!1;return!0}return e!==e&&t!==t}var Yst=function(t,r){try{return n_(t,r)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}};const Jst=Ga(Yst);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var KU=Object.getOwnPropertySymbols,Qst=Object.prototype.hasOwnProperty,Zst=Object.prototype.propertyIsEnumerable;function eit(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function tit(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(s){return t[s]});if(n.join("")!=="0123456789")return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(s){o[s]=s}),Object.keys(Object.assign({},o)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var rit=tit()?Object.assign:function(e,t){for(var r,n=eit(e),o,s=1;s<arguments.length;s++){r=Object(arguments[s]);for(var i in r)Qst.call(r,i)&&(n[i]=r[i]);if(KU){o=KU(r);for(var l=0;l<o.length;l++)Zst.call(r,o[l])&&(n[o[l]]=r[o[l]])}}return n};const nit=Ga(rit);var Hp={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"},_a={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(_a).map(function(e){return _a[e]});var Go={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src",TARGET:"target"},IS={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Jw={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},ait=Object.keys(IS).reduce(function(e,t){return e[IS[t]]=t,e},{}),oit=[_a.NOSCRIPT,_a.SCRIPT,_a.STYLE],eu="data-react-helmet",sit=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iit=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},lit=function(){function e(t,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Tl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cit=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},XU=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},dit=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},ZT=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},uit=function(t){var r=ix(t,_a.TITLE),n=ix(t,Jw.TITLE_TEMPLATE);if(n&&r)return n.replace(/%s/g,function(){return Array.isArray(r)?r.join(""):r});var o=ix(t,Jw.DEFAULT_TITLE);return r||o||void 0},fit=function(t){return ix(t,Jw.ON_CHANGE_CLIENT_STATE)||function(){}},QE=function(t,r){return r.filter(function(n){return typeof n[t]<"u"}).map(function(n){return n[t]}).reduce(function(n,o){return Tl({},n,o)},{})},mit=function(t,r){return r.filter(function(n){return typeof n[_a.BASE]<"u"}).map(function(n){return n[_a.BASE]}).reverse().reduce(function(n,o){if(!n.length)for(var s=Object.keys(o),i=0;i<s.length;i++){var l=s[i],c=l.toLowerCase();if(t.indexOf(c)!==-1&&o[c])return n.concat(o)}return n},[])},xy=function(t,r,n){var o={};return n.filter(function(s){return Array.isArray(s[t])?!0:(typeof s[t]<"u"&&vit("Helmet: "+t+' should be of type "Array". Instead found type "'+sit(s[t])+'"'),!1)}).map(function(s){return s[t]}).reverse().reduce(function(s,i){var l={};i.filter(function(h){for(var m=void 0,v=Object.keys(h),g=0;g<v.length;g++){var y=v[g],x=y.toLowerCase();r.indexOf(x)!==-1&&!(m===Go.REL&&h[m].toLowerCase()==="canonical")&&!(x===Go.REL&&h[x].toLowerCase()==="stylesheet")&&(m=x),r.indexOf(y)!==-1&&(y===Go.INNER_HTML||y===Go.CSS_TEXT||y===Go.ITEM_PROP)&&(m=y)}if(!m||!h[m])return!1;var b=h[m].toLowerCase();return o[m]||(o[m]={}),l[m]||(l[m]={}),o[m][b]?!1:(l[m][b]=!0,!0)}).reverse().forEach(function(h){return s.push(h)});for(var c=Object.keys(l),d=0;d<c.length;d++){var u=c[d],f=nit({},o[u],l[u]);o[u]=f}return s},[]).reverse()},ix=function(t,r){for(var n=t.length-1;n>=0;n--){var o=t[n];if(o.hasOwnProperty(r))return o[r]}return null},hit=function(t){return{baseTag:mit([Go.HREF,Go.TARGET],t),bodyAttributes:QE(Hp.BODY,t),defer:ix(t,Jw.DEFER),encode:ix(t,Jw.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:QE(Hp.HTML,t),linkTags:xy(_a.LINK,[Go.REL,Go.HREF],t),metaTags:xy(_a.META,[Go.NAME,Go.CHARSET,Go.HTTPEQUIV,Go.PROPERTY,Go.ITEM_PROP],t),noscriptTags:xy(_a.NOSCRIPT,[Go.INNER_HTML],t),onChangeClientState:fit(t),scriptTags:xy(_a.SCRIPT,[Go.SRC,Go.INNER_HTML],t),styleTags:xy(_a.STYLE,[Go.CSS_TEXT],t),title:uit(t),titleAttributes:QE(Hp.TITLE,t)}},e3=function(){var e=Date.now();return function(t){var r=Date.now();r-e>16?(e=r,t(r)):setTimeout(function(){e3(t)},0)}}(),YU=function(t){return clearTimeout(t)},pit=typeof window<"u"?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||e3:global.requestAnimationFrame||e3,git=typeof window<"u"?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||YU:global.cancelAnimationFrame||YU,vit=function(t){return console&&typeof console.warn=="function"&&console.warn(t)},yy=null,xit=function(t){yy&&git(yy),t.defer?yy=pit(function(){JU(t,function(){yy=null})}):(JU(t),yy=null)},JU=function(t,r){var n=t.baseTag,o=t.bodyAttributes,s=t.htmlAttributes,i=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.onChangeClientState,u=t.scriptTags,f=t.styleTags,h=t.title,m=t.titleAttributes;t3(_a.BODY,o),t3(_a.HTML,s),yit(h,m);var v={baseTag:iv(_a.BASE,n),linkTags:iv(_a.LINK,i),metaTags:iv(_a.META,l),noscriptTags:iv(_a.NOSCRIPT,c),scriptTags:iv(_a.SCRIPT,u),styleTags:iv(_a.STYLE,f)},g={},y={};Object.keys(v).forEach(function(x){var b=v[x],w=b.newTags,j=b.oldTags;w.length&&(g[x]=w),j.length&&(y[x]=v[x].oldTags)}),r&&r(),d(t,g,y)},Joe=function(t){return Array.isArray(t)?t.join(""):t},yit=function(t,r){typeof t<"u"&&document.title!==t&&(document.title=Joe(t)),t3(_a.TITLE,r)},t3=function(t,r){var n=document.getElementsByTagName(t)[0];if(n){for(var o=n.getAttribute(eu),s=o?o.split(","):[],i=[].concat(s),l=Object.keys(r),c=0;c<l.length;c++){var d=l[c],u=r[d]||"";n.getAttribute(d)!==u&&n.setAttribute(d,u),s.indexOf(d)===-1&&s.push(d);var f=i.indexOf(d);f!==-1&&i.splice(f,1)}for(var h=i.length-1;h>=0;h--)n.removeAttribute(i[h]);s.length===i.length?n.removeAttribute(eu):n.getAttribute(eu)!==l.join(",")&&n.setAttribute(eu,l.join(","))}},iv=function(t,r){var n=document.head||document.querySelector(_a.HEAD),o=n.querySelectorAll(t+"["+eu+"]"),s=Array.prototype.slice.call(o),i=[],l=void 0;return r&&r.length&&r.forEach(function(c){var d=document.createElement(t);for(var u in c)if(c.hasOwnProperty(u))if(u===Go.INNER_HTML)d.innerHTML=c.innerHTML;else if(u===Go.CSS_TEXT)d.styleSheet?d.styleSheet.cssText=c.cssText:d.appendChild(document.createTextNode(c.cssText));else{var f=typeof c[u]>"u"?"":c[u];d.setAttribute(u,f)}d.setAttribute(eu,"true"),s.some(function(h,m){return l=m,d.isEqualNode(h)})?s.splice(l,1):i.push(d)}),s.forEach(function(c){return c.parentNode.removeChild(c)}),i.forEach(function(c){return n.appendChild(c)}),{oldTags:s,newTags:i}},Qoe=function(t){return Object.keys(t).reduce(function(r,n){var o=typeof t[n]<"u"?n+'="'+t[n]+'"':""+n;return r?r+" "+o:o},"")},bit=function(t,r,n,o){var s=Qoe(n),i=Joe(r);return s?"<"+t+" "+eu+'="true" '+s+">"+ZT(i,o)+"</"+t+">":"<"+t+" "+eu+'="true">'+ZT(i,o)+"</"+t+">"},wit=function(t,r,n){return r.reduce(function(o,s){var i=Object.keys(s).filter(function(d){return!(d===Go.INNER_HTML||d===Go.CSS_TEXT)}).reduce(function(d,u){var f=typeof s[u]>"u"?u:u+'="'+ZT(s[u],n)+'"';return d?d+" "+f:f},""),l=s.innerHTML||s.cssText||"",c=oit.indexOf(t)===-1;return o+"<"+t+" "+eu+'="true" '+i+(c?"/>":">"+l+"</"+t+">")},"")},Zoe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,o){return n[IS[o]||o]=t[o],n},r)},jit=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,o){return n[ait[o]||o]=t[o],n},r)},_it=function(t,r,n){var o,s=(o={key:r},o[eu]=!0,o),i=Zoe(n,s);return[_e.createElement(_a.TITLE,i,r)]},Nit=function(t,r){return r.map(function(n,o){var s,i=(s={key:o},s[eu]=!0,s);return Object.keys(n).forEach(function(l){var c=IS[l]||l;if(c===Go.INNER_HTML||c===Go.CSS_TEXT){var d=n.innerHTML||n.cssText;i.dangerouslySetInnerHTML={__html:d}}else i[c]=n[l]}),_e.createElement(t,i)})},gf=function(t,r,n){switch(t){case _a.TITLE:return{toComponent:function(){return _it(t,r.title,r.titleAttributes)},toString:function(){return bit(t,r.title,r.titleAttributes,n)}};case Hp.BODY:case Hp.HTML:return{toComponent:function(){return Zoe(r)},toString:function(){return Qoe(r)}};default:return{toComponent:function(){return Nit(t,r)},toString:function(){return wit(t,r,n)}}}},ese=function(t){var r=t.baseTag,n=t.bodyAttributes,o=t.encode,s=t.htmlAttributes,i=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.scriptTags,u=t.styleTags,f=t.title,h=f===void 0?"":f,m=t.titleAttributes;return{base:gf(_a.BASE,r,o),bodyAttributes:gf(Hp.BODY,n,o),htmlAttributes:gf(Hp.HTML,s,o),link:gf(_a.LINK,i,o),meta:gf(_a.META,l,o),noscript:gf(_a.NOSCRIPT,c,o),script:gf(_a.SCRIPT,d,o),style:gf(_a.STYLE,u,o),title:gf(_a.TITLE,{title:h,titleAttributes:m},o)}},Sit=function(t){var r,n;return n=r=function(o){cit(s,o);function s(){return iit(this,s),dit(this,o.apply(this,arguments))}return s.prototype.shouldComponentUpdate=function(l){return!Jst(this.props,l)},s.prototype.mapNestedChildrenToProps=function(l,c){if(!c)return null;switch(l.type){case _a.SCRIPT:case _a.NOSCRIPT:return{innerHTML:c};case _a.STYLE:return{cssText:c}}throw new Error("<"+l.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},s.prototype.flattenArrayTypeChildren=function(l){var c,d=l.child,u=l.arrayTypeChildren,f=l.newChildProps,h=l.nestedChildren;return Tl({},u,(c={},c[d.type]=[].concat(u[d.type]||[],[Tl({},f,this.mapNestedChildrenToProps(d,h))]),c))},s.prototype.mapObjectTypeChildren=function(l){var c,d,u=l.child,f=l.newProps,h=l.newChildProps,m=l.nestedChildren;switch(u.type){case _a.TITLE:return Tl({},f,(c={},c[u.type]=m,c.titleAttributes=Tl({},h),c));case _a.BODY:return Tl({},f,{bodyAttributes:Tl({},h)});case _a.HTML:return Tl({},f,{htmlAttributes:Tl({},h)})}return Tl({},f,(d={},d[u.type]=Tl({},h),d))},s.prototype.mapArrayTypeChildrenToProps=function(l,c){var d=Tl({},c);return Object.keys(l).forEach(function(u){var f;d=Tl({},d,(f={},f[u]=l[u],f))}),d},s.prototype.warnOnInvalidChildren=function(l,c){return!0},s.prototype.mapChildrenToProps=function(l,c){var d=this,u={};return _e.Children.forEach(l,function(f){if(!(!f||!f.props)){var h=f.props,m=h.children,v=XU(h,["children"]),g=jit(v);switch(d.warnOnInvalidChildren(f,m),f.type){case _a.LINK:case _a.META:case _a.NOSCRIPT:case _a.SCRIPT:case _a.STYLE:u=d.flattenArrayTypeChildren({child:f,arrayTypeChildren:u,newChildProps:g,nestedChildren:m});break;default:c=d.mapObjectTypeChildren({child:f,newProps:c,newChildProps:g,nestedChildren:m});break}}}),c=this.mapArrayTypeChildrenToProps(u,c),c},s.prototype.render=function(){var l=this.props,c=l.children,d=XU(l,["children"]),u=Tl({},d);return c&&(u=this.mapChildrenToProps(c,u)),_e.createElement(t,u)},lit(s,null,[{key:"canUseDOM",set:function(l){t.canUseDOM=l}}]),s}(_e.Component),r.propTypes={base:Jn.object,bodyAttributes:Jn.object,children:Jn.oneOfType([Jn.arrayOf(Jn.node),Jn.node]),defaultTitle:Jn.string,defer:Jn.bool,encodeSpecialCharacters:Jn.bool,htmlAttributes:Jn.object,link:Jn.arrayOf(Jn.object),meta:Jn.arrayOf(Jn.object),noscript:Jn.arrayOf(Jn.object),onChangeClientState:Jn.func,script:Jn.arrayOf(Jn.object),style:Jn.arrayOf(Jn.object),title:Jn.string,titleAttributes:Jn.object,titleTemplate:Jn.string},r.defaultProps={defer:!0,encodeSpecialCharacters:!0},r.peek=t.peek,r.rewind=function(){var o=t.rewind();return o||(o=ese({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),o},n},Cit=function(){return null},Pit=Wst(hit,xit,ese)(Cit),Qw=Sit(Pit);Qw.renderStatic=Qw.rewind;function nl(e){return e??""}function jj(e){return String(e||"").replace(/\D/g,"")}function Ait(){const{userProfile:e}=So(),{toast:t}=no(),r=Yi(),[n,o]=p.useState(!0),[s,i]=p.useState(!1),[l,c]=p.useState(null),[d,u]=p.useState({inscricao_estadual:"",regime_tributario:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:"",nfce_serie:"1",nfce_numeracao:"1",nfce_itoken:"",nfe_serie:"",nfe_numeracao:"",ambiente:"homologacao",transmitenota_apikey:"",transmitenota_base_url:"",transmitenota_base_url_hml:"",transmitenota_apikey_hml:"",transmitenota_base_url_prod:"",transmitenota_apikey_prod:""});p.useEffect(()=>{async function v(){if(!e?.codigo_empresa)return;o(!0);const{data:g,error:y}=await fe.from("empresas").select("*").eq("codigo_empresa",e.codigo_empresa).single();y?t({title:"Erro ao carregar",description:y.message,variant:"destructive"}):g&&(c(g),u({inscricao_estadual:nl(g.inscricao_estadual),regime_tributario:g.regime_tributario?String(g.regime_tributario):"",logradouro:nl(g.logradouro),numero:nl(g.numero),complemento:nl(g.complemento),bairro:nl(g.bairro),cidade:nl(g.cidade),uf:nl(g.uf),cep:jj(g.cep),codigo_municipio_ibge:nl(g.codigo_municipio_ibge),nfce_serie:g.nfce_serie!=null?String(g.nfce_serie):"1",nfce_numeracao:g.nfce_numeracao!=null?String(g.nfce_numeracao):"1",nfce_itoken:nl(g.nfce_itoken),nfe_serie:g.nfe_serie!=null?String(g.nfe_serie):"",nfe_numeracao:g.nfe_numeracao!=null?String(g.nfe_numeracao):"",ambiente:g.ambiente||"homologacao",transmitenota_apikey:nl(g.transmitenota_apikey),transmitenota_base_url:nl(g.transmitenota_base_url),transmitenota_base_url_hml:nl(g.transmitenota_base_url_hml),transmitenota_apikey_hml:nl(g.transmitenota_apikey_hml),transmitenota_base_url_prod:nl(g.transmitenota_base_url_prod),transmitenota_apikey_prod:nl(g.transmitenota_apikey_prod)})),o(!1)}v()},[e?.codigo_empresa]);const f=v=>g=>{const y=g?.target?g.target.value:g;u(x=>({...x,[v]:y}))};async function h(v){if(v?.preventDefault?.(),!e?.codigo_empresa)return;const g={inscricao_estadual:d.inscricao_estadual?.trim()||null,regime_tributario:d.regime_tributario?Number(d.regime_tributario):null,logradouro:d.logradouro?.trim()||null,numero:d.numero?.trim()||null,complemento:d.complemento?.trim()||null,bairro:d.bairro?.trim()||null,cidade:d.cidade?.trim()||null,uf:d.uf?.trim().toUpperCase()||null,cep:jj(d.cep)||null,codigo_municipio_ibge:d.codigo_municipio_ibge?.trim()||null,nfce_serie:d.nfce_serie?Number(d.nfce_serie):null,nfce_numeracao:d.nfce_numeracao?Number(d.nfce_numeracao):null,nfce_itoken:d.nfce_itoken?.trim()||null,nfe_serie:d.nfe_serie?Number(d.nfe_serie):null,nfe_numeracao:d.nfe_numeracao?Number(d.nfe_numeracao):null,ambiente:d.ambiente||"homologacao",transmitenota_apikey:d.transmitenota_apikey?.trim()||null,transmitenota_base_url:d.transmitenota_base_url?.trim()||null,transmitenota_base_url_hml:d.transmitenota_base_url_hml?.trim()||null,transmitenota_apikey_hml:d.transmitenota_apikey_hml?.trim()||null,transmitenota_base_url_prod:d.transmitenota_base_url_prod?.trim()||null,transmitenota_apikey_prod:d.transmitenota_apikey_prod?.trim()||null};try{i(!0);const{error:y}=await fe.from("empresas").update(g).eq("codigo_empresa",e.codigo_empresa).select("id").single();if(y)throw y;t({title:"Configuraes salvas",description:"Dados fiscais atualizados."})}catch(y){t({title:"Erro ao salvar",description:y.message,variant:"destructive"})}finally{i(!1)}}async function m(v){const g=jj(l?.cnpj||"");if(g.length!==14){t({title:"CNPJ invlido",description:"Salve um CNPJ vlido (14 dgitos) nos dados da empresa.",variant:"destructive"});return}const y=v==="prod",x=y?d.transmitenota_base_url_prod||"":d.transmitenota_base_url_hml||"",b=y?d.transmitenota_apikey_prod||"":d.transmitenota_apikey_hml||"";if(!x||!b){t({title:"Configurao incompleta",description:"Preencha Base URL e ApiKey do ambiente selecionado.",variant:"destructive"});return}try{const w=await Sst({baseUrl:x,apiKey:b,cnpj:g});if(!w.reachable){t({title:"Sem conexo",description:w.error||`Endpoint inacessvel (${w.status||"sem status"})`,variant:"destructive"});return}if(w.authorized===!1){t({title:"Credenciais invlidas",description:`HTTP ${w.status}. Verifique ApiKey e CNPJ.`,variant:"destructive"});return}const j=w.status===200?"OK":w.status===400?"Conectado (dados mnimos ausentes, mas credenciais e URL vlidas)":`Conectado (HTTP ${w.status})`;t({title:`Conexo ${y?"PROD":"HML"}: sucesso`,description:j})}catch(w){t({title:"Falha no teste",description:w.message||"Erro inesperado",variant:"destructive"})}}return a.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-6",children:[a.jsx(Qw,{children:a.jsx("title",{children:"Configurao Fiscal"})}),a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx(ce,{type:"button",variant:"outline",size:"sm",onClick:()=>r(-1),children:"Voltar"}),a.jsxs("div",{className:"text-right",children:[a.jsx("h1",{className:"text-2xl font-semibold leading-tight",children:"Configurao Fiscal"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Dados que sero usados na emisso de NFC-e/NF-e."})]})]}),a.jsxs("form",{onSubmit:h,className:"grid gap-6 bg-surface border border-border rounded-lg p-4 shadow-sm",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Inscrio Estadual"}),a.jsx(Je,{value:d.inscricao_estadual,onChange:f("inscricao_estadual")})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Regime Tributrio (CRT)"}),a.jsxs(Cn,{value:d.regime_tributario,onValueChange:f("regime_tributario"),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Selecione"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"1",children:"1 - Simples Nacional"}),a.jsx(nt,{value:"2",children:"2 - Simples Nacional (excesso sublimite)"}),a.jsx(nt,{value:"3",children:"3 - Regime Normal"})]})]})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Ambiente"}),a.jsxs(Cn,{value:d.ambiente,onValueChange:f("ambiente"),children:[a.jsx(jn,{children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"homologacao",children:"Homologao"}),a.jsx(nt,{value:"producao",children:"Produo"})]})]})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"sm:col-span-3",children:[a.jsx(De,{children:"Logradouro"}),a.jsx(Je,{value:d.logradouro,onChange:f("logradouro")})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Nmero"}),a.jsx(Je,{value:d.numero,onChange:f("numero")})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx(De,{children:"Complemento"}),a.jsx(Je,{value:d.complemento,onChange:f("complemento")})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Bairro"}),a.jsx(Je,{value:d.bairro,onChange:f("bairro")})]}),a.jsxs("div",{children:[a.jsx(De,{children:"CEP"}),a.jsx(Je,{value:d.cep,onChange:v=>f("cep")({target:{value:jj(v.target.value)}})})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx(De,{children:"Cidade"}),a.jsx(Je,{value:d.cidade,onChange:f("cidade")})]}),a.jsxs("div",{children:[a.jsx(De,{children:"UF"}),a.jsx(Je,{value:d.uf,onChange:v=>f("uf")({target:{value:String(v.target.value||"").toUpperCase().slice(0,2)}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Cdigo IBGE Municpio (cMun)"}),a.jsx(Je,{value:d.codigo_municipio_ibge,onChange:f("codigo_municipio_ibge")})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{children:"NFC-e Srie"}),a.jsx(Je,{value:d.nfce_serie,onChange:f("nfce_serie")})]}),a.jsxs("div",{children:[a.jsx(De,{children:"NFC-e Numerao Inicial"}),a.jsx(Je,{value:d.nfce_numeracao,onChange:f("nfce_numeracao")})]}),a.jsxs("div",{children:[a.jsx(De,{children:"NFC-e IToken (CSC)"}),a.jsx(Je,{value:d.nfce_itoken,onChange:f("nfce_itoken")})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{children:"NF-e Srie (opcional)"}),a.jsx(Je,{value:d.nfe_serie,onChange:f("nfe_serie")})]}),a.jsxs("div",{children:[a.jsx(De,{children:"NF-e Numerao (opcional)"}),a.jsx(Je,{value:d.nfe_numeracao,onChange:f("nfe_numeracao")})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ApiKey Transmite Nota (opcional)"}),a.jsx(Je,{value:d.transmitenota_apikey,onChange:f("transmitenota_apikey")})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"border border-border rounded-md p-3",children:[a.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Transmite Nota  Homologao"}),a.jsx(De,{className:"text-xs",children:"Base URL (HML)"}),a.jsx(Je,{value:d.transmitenota_base_url_hml,onChange:f("transmitenota_base_url_hml"),placeholder:"https://..."}),a.jsx("div",{className:"mt-3"}),a.jsx(De,{className:"text-xs",children:"ApiKey (HML)"}),a.jsx(Je,{value:d.transmitenota_apikey_hml,onChange:f("transmitenota_apikey_hml")}),a.jsx("div",{className:"mt-3",children:a.jsx(ce,{type:"button",variant:"outline",size:"sm",onClick:()=>m("hml"),disabled:s||n,children:n?"Testando...":"Testar conexo HML"})})]}),a.jsxs("div",{className:"border border-border rounded-md p-3",children:[a.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Transmite Nota  Produo"}),a.jsx(De,{className:"text-xs",children:"Base URL (PROD)"}),a.jsx(Je,{value:d.transmitenota_base_url_prod,onChange:f("transmitenota_base_url_prod"),placeholder:"https://..."}),a.jsx("div",{className:"mt-3"}),a.jsx(De,{className:"text-xs",children:"ApiKey (PROD)"}),a.jsx(Je,{value:d.transmitenota_apikey_prod,onChange:f("transmitenota_apikey_prod")}),a.jsx("div",{className:"mt-3",children:a.jsx(ce,{type:"button",variant:"outline",size:"sm",onClick:()=>m("prod"),disabled:s||n,children:n?"Testando...":"Testar conexo PROD"})})]})]}),a.jsx("div",{className:"flex gap-3 mt-4",children:a.jsx(ce,{type:"submit",disabled:s||n,children:s?"Salvando...":"Salvar Configuraes"})})]})]})}function bb(e){return String(e||"").replace(/\D/g,"")}function lv(e){const t=Number(e??0);return Number.isFinite(t)?t.toFixed(2):"0.00"}function Eit(e){return e==null?"":String(e)}function kit(e){return e?.length,0}function Iit(e,t){if(!e?.length)return"90";const r=e[0];return t.find(o=>o.id===r.finalizadora_id)?.codigo_sefaz||"99"}function Oit(e,t){if(t){const r=bb(t.cpf||t.cnpj||t.cpf_cnpj||t.cpf_cnpj_limpo);return{nome:t.nome||t.nome_completo||t.razao_social||"",cpf_cnpj:r||void 0,ie:t.inscricao_estadual||void 0,email:t.email||void 0,telefone:bb(t.telefone)||void 0,endereco:{logradouro:t.logradouro||t.endereco||"",numero:Eit(t.numero||""),complemento:t.complemento||"",bairro:t.bairro||"",municipio:t.municipio||t.cidade||"",uf:t.uf||"",cep:bb(t.cep),codigo_cidade:t.codigo_municipio||t.codigo_municipio_ibge||void 0,pais:t.pais||"Brasil"},indicador_ie_destinatario:t.indicador_ie_destinatario||9}}return null}async function gv({comandaId:e,codigoEmpresa:t}){if(!e)throw new Error("comandaId obrigatrio");if(!t)throw new Error("codigoEmpresa obrigatrio");const{data:r,error:n}=await fe.from("empresas").select("*").eq("codigo_empresa",t).single();if(n)throw n;const{data:o,error:s}=await fe.from("comandas").select("*").eq("codigo_empresa",t).eq("id",e).single();if(s)throw s;let i=null;if(o.cliente_id){const{data:_}=await fe.from("clientes").select("*").eq("id",o.cliente_id).single();i=_||null}else{const{data:_}=await fe.from("comanda_clientes").select("clientes:clientes!comanda_clientes_cliente_id_fkey(*)").eq("comanda_id",o.id).limit(1),C=Array.isArray(_)&&_.length?_[0]:null;C?.clientes&&(i=C.clientes)}const{data:l,error:c}=await fe.from("comanda_itens").select("*").eq("comanda_id",o.id);if(c)throw c;const d=Array.from(new Set(l.map(_=>_.produto_id).filter(Boolean)));let u=new Map;if(d.length){const{data:_}=await fe.from("produtos").select("*").in("id",d);(_||[]).forEach(C=>u.set(C.id,C))}const{data:f}=await fe.from("pagamentos").select("*").eq("comanda_id",o.id),h=Array.from(new Set((f||[]).map(_=>_.finalizadora_id).filter(Boolean)));let m=[];if(h.length){const{data:_}=await fe.from("finalizadoras").select("*").in("id",h);m=_||[]}const v=l.reduce((_,C)=>_+Number(C.quantidade||0)*Number(C.preco_unitario||0),0),g=l.reduce((_,C)=>_+Number(C.desconto||0),0),y=v-g,x=Oit(o,i),b={tipo_operacao:1,natureza_operacao:"Venda de mercadoria",forma_pagamento:kit(f),meio_pagamento:Iit(f,m),data_emissao:new Date(o.fechado_em||o.updated_at||Date.now()).toLocaleDateString("pt-BR"),data_saida_entrada:new Date(o.fechado_em||Date.now()).toLocaleDateString("pt-BR"),hora_saida_entrada:new Date(o.fechado_em||Date.now()).toTimeString().slice(0,8),finalidade_emissao:1,valor_frete:"0",valor_seguro:"0",valor_ipi:"0",valor_total:lv(y),valor_total_sem_desconto:lv(v),...x?{nome_destinatario:x.nome,cnpj_destinatario:x.cpf_cnpj,inscricao_estadual_destinatario:x.ie,email_destinatario:x.email,telefone_destinatario:x.telefone,logradouro_destinatario:x.endereco.logradouro,numero_destinatario:x.endereco.numero,complemento_destinatario:x.endereco.complemento,bairro_destinatario:x.endereco.bairro,municipio_destinatario:x.endereco.municipio,codigo_cidade:x.endereco.codigo_cidade,uf_destinatario:x.endereco.uf,pais_destinatario:x.endereco.pais,cep_destinatario:x.endereco.cep,indicador_ie_destinatario:x.indicador_ie_destinatario}:{},Itens:l.map((_,C)=>{const E=u.get(_.produto_id)||{},A=Number(_.quantidade||0),P=Number(_.preco_unitario||0),F=Number(_.desconto||0),M=A*P-F,I=E.cfop_interno||E.cfop||5102,R=(E.ncm||"").replace(/\D/g,"").slice(0,8)||"",D=E.unidade||E.unit||"UN",U=E.csosn_interno||E.csosn||null;E.cst_icms_interno||E.cstIcmsInterno;const z=E.cst_pis_saida||E.cstPisSaida||"07",H=E.cst_cofins_saida||E.cstCofinsSaida||"07",q=E.icms_origem??0;return{numero_item:C+1,codigo_produto:E.code||E.codigo||E.id,descricao:E.name||E.descricao||_.descricao||"Item",cfop:Number(I),unidade_comercial:D,quantidade_comercial:A,valor_unitario_comercial:lv(P),codigo_ncm:R,valor_desconto:F?lv(F):"",valor_frete:"",valor_seguro:"",valor_outras_despesas:"",valor_total:lv(M),valor_total_sem_desconto:lv(A*P),icms_csosn:U?Number(U):void 0,icms_orig:Number(q)||0,pis_situacao_tributaria:z,base_calculo_pis:"",aliquota_pis:"",valor_pis:"",cofins_situacao_tributaria:H,base_calculo_cofins:"",aliquota_cofins:"",valor_cofins:""}})},w=[];r?.inscricao_estadual||w.push("Inscrio Estadual (empresa)"),r?.regime_tributario||w.push("CRT/Regime Tributrio (empresa)"),(!r?.cidade||!r?.uf)&&w.push("Cidade/UF (empresa)"),r?.codigo_municipio_ibge||w.push("Cdigo IBGE do municpio (empresa)"),r?.nfce_serie||w.push("NFC-e Srie (empresa)"),!r?.nfce_itoken&&r?.ambiente==="producao"&&w.push("NFC-e IToken/CSC (produo)"),bb(r?.cnpj)||w.push("CNPJ da empresa"),l.forEach(_=>{const C=u.get(_.produto_id)||{};C.ncm||w.push(`Produto ${C.name||C.id}: NCM`),!C.cfop_interno&&!C.cfop&&w.push(`Produto ${C.name||C.id}: CFOP interno`)});const j={ApiKey:r?.transmitenota_apikey||"",Cnpj:bb(r?.cnpj),Dados:b};return{empresa:r,comanda:o,cliente:i,itens:l,pagamentos:f,finalizadoras:m,payload:j,missing:w}}async function Tit({comandaId:e,codigoEmpresa:t,modelo:r="65",overrides:n={}}){if(!e)throw new Error("ID da comanda  obrigatrio");if(!t)throw new Error("Cdigo da empresa  obrigatrio");const{data:o,error:s}=await fe.from("vendas").select("*").eq("id",e).eq("codigo_empresa",t).single();if(s)throw new Error(`Erro ao buscar comanda: ${s.message}`);if(!o)throw new Error("Comanda no encontrada");const{data:i,error:l}=await fe.from("itens_venda").select(`
      *,
      produtos!itens_venda_produto_id_fkey (
        id,
        nome,
        codigo,
        ncm,
        cest,
        cfopInterno,
        cfopExterno,
        cstIcmsInterno,
        cstIcmsExterno,
        csosnInterno,
        csosnExterno,
        aliqIcmsInterno,
        aliqIcmsExterno,
        cstPisEntrada,
        cstPisSaida,
        aliqPisPercent,
        aliqCofinsPercent,
        cstIpi,
        aliqIpiPercent
      )
    `).eq("comanda_id",e).eq("codigo_empresa",t);if(l)throw new Error(`Erro ao buscar itens: ${l.message}`);const{data:c,error:d}=await fe.from("pagamentos").select(`
      *,
      finalizadoras!pagamentos_finalizadora_id_fkey (
        id,
        codigo_sefaz,
        nome
      )
    `).eq("comanda_id",e).eq("codigo_empresa",t).neq("status","Cancelado").neq("status","Estornado");if(d)throw new Error(`Erro ao buscar pagamentos: ${d.message}`);const{data:u,error:f}=await fe.from("empresas").select("*").eq("codigo_empresa",t).single();if(f)throw new Error(`Erro ao buscar empresa: ${f.message}`);let h=null;if(o.cliente_id){const{data:m}=await fe.from("clientes").select("*").eq("id",o.cliente_id).eq("codigo_empresa",t).single();h=m}return tse({comanda:o,itens:i||[],pagamentos:c||[],empresa:u,cliente:h,modelo:r,overrides:n})}async function Dit({codigoEmpresa:e,empresa:t,cliente:r,itens:n,pagamentos:o,modelo:s="55",overrides:i={}}){let l=t;if(!l){if(!e)throw new Error("codigoEmpresa obrigatrio quando empresa no for fornecida");const{data:f,error:h}=await fe.from("empresas").select("*").eq("codigo_empresa",e).single();if(h)throw new Error(`Erro ao buscar empresa: ${h.message}`);l=f}const c={numero:i?.nNF||"1",desconto:0},d=Array.isArray(n)?n.map(f=>({preco_unitario:Number(f.preco_unitario)||0,quantidade:Number(f.quantidade)||1,preco_total:Number(f.preco_total!=null?f.preco_total:(Number(f.preco_unitario)||0)*(Number(f.quantidade)||1)),produtos:f.produtos||{id:f.produto_id||f.id,nome:f.nome||f.descricao||"Produto",codigo:f.codigo||String(f.produto_id||f.id||""),ncm:f.ncm||"",cest:f.cest||"",cfopInterno:f.cfop||f.cfopInterno,cstIcmsInterno:f.cstIcmsInterno,csosnInterno:f.csosnInterno,aliqIcmsInterno:f.aliqIcmsInterno,cstPisSaida:f.cstPisSaida,aliqPisPercent:f.aliqPisPercent,aliqCofinsPercent:f.aliqCofinsPercent}})):[],u=Array.isArray(o)&&o.length?o:[{finalizadoras:{codigo_sefaz:"99"},valor:d.reduce((f,h)=>f+(Number(h.preco_total)||0),0)}];return tse({comanda:c,itens:d,pagamentos:u,empresa:l,cliente:r,modelo:s,overrides:i})}function tse({comanda:e,itens:t,pagamentos:r,empresa:n,cliente:o,modelo:s="65",overrides:i={}}){const c=new Date().toISOString(),d=String(i.nNF||e.numero||"1"),u=s==="55"?"55":"65",f=u==="55"?"NF-e":"NFC-e",h=t.reduce((D,U)=>D+(Number(U.preco_total)||0),0),m=Number(e.desconto)||0,v=h-m,g=String(i.natOp||"VENDA"),y=String(i.serie||"1"),x=String(i.tpAmb||(n.ambiente==="producao"?"1":"2")),b=String(i.tpNF||"1"),w=String(i.indFinal||"1"),j=String(i.indPres||"1"),_=o&&o.uf&&n.uf&&o.uf!==n.uf?"2":"1",C=String(i.idDest||_),A=String({AC:"12",AL:"27",AM:"13",AP:"16",BA:"29",CE:"23",DF:"53",ES:"32",GO:"52",MA:"21",MG:"31",MS:"50",MT:"51",PA:"15",PB:"25",PE:"26",PI:"22",PR:"41",RJ:"33",RN:"24",RO:"11",RR:"14",RS:"43",SC:"42",SE:"28",SP:"35",TO:"17"}[(n.uf||"").toUpperCase()]||n.codigo_uf||"35"),P=String(n.codigo_municipio_ibge||n.codigo_municipio||""),F=o?`
    <dest>
      <${o.tipo_pessoa==="PJ"?"CNPJ":"CPF"}>${o.cpf_cnpj||""}</${o.tipo_pessoa==="PJ"?"CNPJ":"CPF"}>
      <xNome>${Ol(o.nome||o.razao_social||"")}</xNome>
      <enderDest>
        <xLgr>${Ol(o.logradouro||"")}</xLgr>
        <nro>${Ol(o.numero||"S/N")}</nro>
        <xBairro>${Ol(o.bairro||"")}</xBairro>
        <cMun>${o.codigo_municipio||o.codigo_municipio_ibge||""}</cMun>
        <xMun>${Ol(o.municipio||o.cidade||"")}</xMun>
        <UF>${o.uf||""}</UF>
        <CEP>${(o.cep||"").replace(/\D/g,"")}</CEP>
        <cPais>1058</cPais>
        <xPais>BRASIL</xPais>
      </enderDest>
      <indIEDest>9</indIEDest>
      ${o.email?`<email>${Ol(o.email)}</email>`:""}
    </dest>`:`
    <dest>
      <indIEDest>9</indIEDest>
    </dest>`,M=t.map((D,U)=>{const z=D.produtos||{},H=Number(D.preco_unitario)||0,q=Number(D.quantidade)||1,Q=Number(D.preco_total)||H*q;return`
    <det nItem="${U+1}">
      <prod>
        <cProd>${Ol(z.codigo||D.produto_id)}</cProd>
        <cEAN>SEM GTIN</cEAN>
        <xProd>${Ol(z.nome||"Produto")}</xProd>
        <NCM>${z.ncm||"00000000"}</NCM>
        ${z.cest?`<CEST>${z.cest}</CEST>`:""}
        <CFOP>${z.cfopInterno||"5102"}</CFOP>
        <uCom>UN</uCom>
        <qCom>${q.toFixed(4)}</qCom>
        <vUnCom>${H.toFixed(10)}</vUnCom>
        <vProd>${Q.toFixed(2)}</vProd>
        <cEANTrib>SEM GTIN</cEANTrib>
        <uTrib>UN</uTrib>
        <qTrib>${q.toFixed(4)}</qTrib>
        <vUnTrib>${H.toFixed(10)}</vUnTrib>
        <indTot>1</indTot>
      </prod>
      <imposto>
        <ICMS>
          ${z.csosnInterno?`
          <ICMSSN102>
            <orig>0</orig>
            <CSOSN>${z.csosnInterno}</CSOSN>
          </ICMSSN102>`:`
          <ICMS00>
            <orig>0</orig>
            <CST>${z.cstIcmsInterno||"00"}</CST>
            <modBC>3</modBC>
            <vBC>${Q.toFixed(2)}</vBC>
            <pICMS>${z.aliqIcmsInterno||"0.00"}</pICMS>
            <vICMS>${(Q*(Number(z.aliqIcmsInterno)||0)/100).toFixed(2)}</vICMS>
          </ICMS00>`}
        </ICMS>
        <PIS>
          <PISAliq>
            <CST>${z.cstPisSaida||"01"}</CST>
            <vBC>${Q.toFixed(2)}</vBC>
            <pPIS>${z.aliqPisPercent||"0.00"}</pPIS>
            <vPIS>${(Q*(Number(z.aliqPisPercent)||0)/100).toFixed(2)}</vPIS>
          </PISAliq>
        </PIS>
        <COFINS>
          <COFINSAliq>
            <CST>${z.cstPisSaida||"01"}</CST>
            <vBC>${Q.toFixed(2)}</vBC>
            <pCOFINS>${z.aliqCofinsPercent||"0.00"}</pCOFINS>
            <vCOFINS>${(Q*(Number(z.aliqCofinsPercent)||0)/100).toFixed(2)}</vCOFINS>
          </COFINSAliq>
        </COFINS>
      </imposto>
    </det>`}).join(""),I=r.map(D=>{const U=D.finalizadoras?.codigo_sefaz||"99",z=Number(D.valor)||0;return`
    <pag>
      <detPag>
        <tPag>${U}</tPag>
        <vPag>${z.toFixed(2)}</vPag>
      </detPag>
    </pag>`}).join("");return`<?xml version="1.0" encoding="UTF-8"?>
<nfeProc versao="4.00" xmlns="http://www.portalfiscal.inf.br/nfe">
  <NFe xmlns="http://www.portalfiscal.inf.br/nfe">
    <infNFe versao="4.00" Id="NFe${n.cnpj||""}${d.padStart(9,"0")}">
      <ide>
        <cUF>${A}</cUF>
        <cNF>${d.padStart(8,"0")}</cNF>
        <natOp>${g}</natOp>
        <mod>${u}</mod>
        <serie>${y}</serie>
        <nNF>${d}</nNF>
        <dhEmi>${c}</dhEmi>
        <tpNF>${b}</tpNF>
        <idDest>${C}</idDest>
        <cMunFG>${P}</cMunFG>
        <tpImp>4</tpImp>
        <tpEmis>1</tpEmis>
        <tpAmb>${x}</tpAmb>
        <finNFe>1</finNFe>
        <indFinal>${w}</indFinal>
        <indPres>${j}</indPres>
        <procEmi>0</procEmi>
        <verProc>1.0.0</verProc>
      </ide>
      <emit>
        <CNPJ>${n.cnpj||""}</CNPJ>
        <xNome>${Ol(n.razao_social||n.nome_fantasia||"")}</xNome>
        <xFant>${Ol(n.nome_fantasia||"")}</xFant>
        <enderEmit>
          <xLgr>${Ol(n.logradouro||"")}</xLgr>
          <nro>${Ol(n.numero||"S/N")}</nro>
          <xBairro>${Ol(n.bairro||"")}</xBairro>
          <cMun>${n.codigo_municipio_ibge||n.codigo_municipio||""}</cMun>
          <xMun>${Ol(n.municipio||n.cidade||"")}</xMun>
          <UF>${n.uf||""}</UF>
          <CEP>${(n.cep||"").replace(/\D/g,"")}</CEP>
          <cPais>1058</cPais>
          <xPais>BRASIL</xPais>
          <fone>${(n.telefone||"").replace(/\D/g,"")}</fone>
        </enderEmit>
        <IE>${n.inscricao_estadual||""}</IE>
        <CRT>${n.regime_tributario||"1"}</CRT>
      </emit>
      ${F}
      ${M}
      <total>
        <ICMSTot>
          <vBC>0.00</vBC>
          <vICMS>0.00</vICMS>
          <vICMSDeson>0.00</vICMSDeson>
          <vFCP>0.00</vFCP>
          <vBCST>0.00</vBCST>
          <vST>0.00</vST>
          <vFCPST>0.00</vFCPST>
          <vFCPSTRet>0.00</vFCPSTRet>
          <vProd>${h.toFixed(2)}</vProd>
          <vFrete>0.00</vFrete>
          <vSeg>0.00</vSeg>
          <vDesc>${m.toFixed(2)}</vDesc>
          <vII>0.00</vII>
          <vIPI>0.00</vIPI>
          <vIPIDevol>0.00</vIPIDevol>
          <vPIS>0.00</vPIS>
          <vCOFINS>0.00</vCOFINS>
          <vOutro>0.00</vOutro>
          <vNF>${v.toFixed(2)}</vNF>
        </ICMSTot>
      </total>
      <transp>
        <modFrete>9</modFrete>
      </transp>
      ${I}
      <infAdic>
        <infCpl>Comanda: ${e.id} | Modelo: ${f}</infCpl>
      </infAdic>
    </infNFe>
  </NFe>
</nfeProc>`}function Ol(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}const QU=[{code:"1102",desc:"Compra para industrializao, comercializao ou prestao de servios"},{code:"5101",desc:"Venda de produo do estabelecimento"},{code:"5102",desc:"Venda de mercadoria adquirida de terceiros"},{code:"5103",desc:"Venda de produo do estabelecimento, efetuada fora do estabelecimento"},{code:"5104",desc:"Venda de mercadoria adquirida de terceiros, efetuada fora do estabelecimento"},{code:"5405",desc:"Venda de mercadoria adquirida de terceiros, sujeita a ST"},{code:"5949",desc:"Outras sadas de mercadorias no especificadas"},{code:"5915",desc:"Remessa em bonificao, doao ou brinde"},{code:"5109",desc:"Venda de produo do estabelecimento, destinada a no contribuinte"},{code:"5110",desc:"Venda de mercadoria adquirida de terceiros, destinada a no contribuinte"},{code:"5401",desc:"Venda de produo do estabelecimento, sujeita a ST"},{code:"5403",desc:"Venda de mercadoria, de terceiros, sujeita a ST, efetuada pelo industrial substituto"},{code:"2102",desc:"Compra para industrializao, comercializao ou prestao de servios (fora do estado)"},{code:"6101",desc:"Venda de produo do estabelecimento (fora do estado)"},{code:"6102",desc:"Venda de mercadoria adquirida de terceiros (fora do estado)"},{code:"6403",desc:"Venda de produo do estabelecimento, sujeita a ST (fora do estado)"},{code:"6915",desc:"Remessa em bonificao, doao ou brinde (fora do estado)"}],OS=!1,Mit="",Rit="Estamos em manuteno no momento. Voltaremos em breve.";function Qc(e){return Number(e||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}function ZU(e){if(!e)return"";try{return new Date(e).toLocaleString("pt-BR")}catch{return""}}function cv({label:e,value:t,onChange:r}){const[n,o]=_e.useState(!1),s=_e.useRef(null),i=_e.useRef(null),[l,c]=_e.useState({top:0,left:0}),d=m=>{try{const[v,g,y]=String(m||"").split("-").map(Number);return v&&g&&y?new Date(v,g-1,y):null}catch{return null}},u=m=>{const v=g=>String(g).padStart(2,"0");return`${m.getFullYear()}-${v(m.getMonth()+1)}-${v(m.getDate())}`},f=_e.useCallback(()=>{if(!i.current)return;const m=i.current.getBoundingClientRect(),v=320,g=Math.min(Math.max(8,m.left),window.innerWidth-v-8),y=Math.min(m.bottom+6,window.innerHeight-8-300);c({top:y,left:g})},[]);_e.useEffect(()=>{const m=v=>{n&&s.current&&!s.current.contains(v.target)&&o(!1)};return window.addEventListener("mousedown",m),()=>window.removeEventListener("mousedown",m)},[n]),_e.useEffect(()=>{if(!n)return;f();const m=()=>f(),v=()=>f();return window.addEventListener("scroll",m,!0),window.addEventListener("resize",v),()=>{window.removeEventListener("scroll",m,!0),window.removeEventListener("resize",v)}},[n,f]);const h=d(t);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"relative",ref:s,children:a.jsx("button",{ref:i,type:"button",className:"h-7 px-2 rounded-md bg-surface border border-border text-xs",onClick:()=>o(m=>!m),children:t?new Date(t+"T00:00:00").toLocaleDateString("pt-BR"):e})}),n&&e4.createPortal(a.jsx("div",{className:"fixed z-[1000] p-2 bg-black text-white border border-warning/40 rounded-md shadow-xl",style:{top:l.top,left:l.left},children:a.jsx(Gl,{mode:"single",selected:h||void 0,onSelect:m=>{m&&(r(u(m)),o(!1))},showOutsideDays:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}),document.body)]})}function Lit(){const{userProfile:e}=So(),t=e?.codigo_empresa,{toast:r}=no(),n=Yi(),[o,s]=p.useState([]),[i,l]=p.useState(!1),[c,d]=p.useState(""),[u,f]=p.useState("all"),h=T=>String(T).padStart(2,"0"),m=new Date,v=m.getFullYear(),g=m.getMonth()+1,y=`${v}-${h(g)}-01`,x=`${v}-${h(g)}-${h(new Date(v,g,0).getDate())}`,[b,w]=p.useState(y),[j,_]=p.useState(x),[C,E]=p.useState(!1),[A,P]=p.useState(null),[F,M]=p.useState("nfce"),[I,R]=p.useState(!1),[D,U]=p.useState(!1);p.useEffect(()=>{try{const T=String({}.VITE_MAINTENANCE_MODE||"").toLowerCase()==="true",O=localStorage.getItem("maintenance:active")==="true",X=localStorage.getItem("maintenance:end"),G=X?new Date>new Date(X):!1,L=(!!OS||T||O)&&!G,Re=(()=>{try{const rt=localStorage.getItem("maintenance:bypass")==="1",lt=sessionStorage.getItem("maintenance:bypass")==="1",$t=document.cookie.split(";").some(Fe=>Fe.trim()==="fx_maint_bypass=1");return rt||lt||$t}catch{return!1}})();R(L),U(Re)}catch{R(!!OS),U(!1)}},[]);const[z,H]=p.useState(!1),[q,Q]=p.useState(!1),[pe,be]=p.useState(null),[V,B]=p.useState([]),[J,ue]=p.useState([]),[Ne,Z]=p.useState(!1),[ge,le]=p.useState(!1),[se,ee]=p.useState(""),[de,Le]=p.useState(null),[ae,ie]=p.useState({natOp:"VENDA",serie:"1",nNF:"",indFinal:"1",indPres:"1",idDest:""}),[dt,At]=p.useState(!1),[st,ut]=p.useState(!1),[Rt,Nt]=p.useState(""),[tt,he]=p.useState(!1),ke=new Date,et=`${ke.getFullYear()}-${h(ke.getMonth()+1)}-${h(ke.getDate())}`,[Me,$e]=p.useState({natOp:"VENDA",serie:"1",nNF:"",indFinal:"1",indPres:"1",idDest:"",finNFe:"1",data_emissao:et,data_saida:et,tipo_nota:"saida",baixar_estoque:!0,destacar_st:!1,cfop_padrao:"5102",indIntermed:"0",intermediador_cnpj:"",intermediador_id:"",parte_tipo:"cliente",party_id:"",party_codigo:"",tipo_pessoa:"PJ",cpf_cnpj:"",nome:"",email:"",telefone:"",inscricao_estadual:"",ie_isento:!1,logradouro:"",numero:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:"",itens:[{descricao:"",codigo:"",cod_barras:"",ncm:"",cest:"",cfop:"5102",unidade:"UN",quantidade:"1",preco_unitario:"0.00",desconto_valor:"0.00",desconto_percent:"",acrescimos_valor:"0.00",frete_valor:"0.00",seguro_valor:"0.00",obs:"",dest_icms:!1,dest_icms_info:!1,benef_fiscal:!1,impostos:{origem:"",icms:{cst:"",csosn:"",base:"",aliquota:"",valor:"",desonerado_valor:"",desoneracao_motivo:"",operacao_valor:"",aliq_diferimento:"",valor_diferido:"",reducao_percent:"",reducao_motivo:"",ad_rem:"",ad_rem_retencao:"",monofasico_bc:"",monofasico_valor:"",mono_retencao_bc:"",mono_retencao_valor:"",mono_cobrado_ant_bc:"",mono_cobrado_ant_valor:"",proprio_devido_valor:""},icmsst:{base:"",aliquota:"",valor:""},fcp:{base:"",aliquota:"",valor:""},fcpst:{base:"",aliquota:"",valor:""},pis:{cst:"",aliquota:"",valor:""},cofins:{cst:"",aliquota:"",valor:""},ipi:{cst:"",aliquota:"",valor:"",tipo_calculo:"nenhum",valor_unit:""},combustivel:{uf:"",perc_origem_uf:"",indicador_importacao:""},cide:{base:"",aliq:"",valor:""},iss:{aliquota:"",valor:""}}}],totais:{desconto_geral:"0.00",frete:"0.00",outras_despesas:"0.00"},pagamentos:[{tipo:"Dinheiro",bandeira:"",cnpj_credenciadora:"",valor:"",parcelas:"",troco:""}],transporte:{tipo_frete:"",transportadora:"",placa:"",volumes:"",peso_liquido:"",peso_bruto:""},adicionais:{obs_gerais:"",info_fisco:"",info_cliente:"",referencia_doc:""}}),[Be,we]=p.useState("cliente"),[He,ht]=p.useState(!1),[zt,hr]=p.useState(""),[Mt,Qt]=p.useState([]),[Se,kt]=p.useState(""),[Lt,fr]=p.useState(null),[yr,Xt]=p.useState(!1),[nr,ir]=p.useState(null),[Ee,qe]=p.useState(!1);p.useState(!1);const[Ge,Qe]=p.useState(""),[St,pt]=p.useState([]),[Et,mt]=p.useState("cliente"),[gt,ft]=p.useState([]),[Dt,Ft]=p.useState(null),[ye,wt]=p.useState(""),[Yt,br]=p.useState(!1);p.useState(!1),p.useState("");const[Mr,Nr]=p.useState(!0),Rr=T=>String(T||"").replace(/\D/g,""),Er=T=>{const O=String(T??"").replace(/\./g,"").replace(",","."),X=Number(O);return Number.isFinite(X)?X:0};p.useEffect(()=>{$e(T=>({...T,baixar_estoque:T.tipo_nota!=="entrada"}))},[Me.tipo_nota]),p.useEffect(()=>{$e(T=>({...T,cfop_padrao:Vt(T.uf)}))},[Me.tipo_nota,zt,Me.uf]);const ln=p.useRef(Me.cfop_padrao);p.useEffect(()=>{const T=ln.current,O=Me.cfop_padrao||"";ln.current=O,!(!Mr||!O)&&$e(X=>{const G=X.itens||[];let L=!1;const Re=G.map(rt=>{const lt=String(rt.cfop||"");return lt===""||T&&lt===T?(L=!0,{...rt,cfop:O}):rt});return L?{...X,itens:Re}:X})},[Me.cfop_padrao,Mr]);const Fn=T=>O=>{const X=String(O?.target?.tagName||"").toLowerCase();["input","select","button","svg","path","textarea"].includes(X)||Ft(Dt===T?null:T)},Hn=T=>{const O=String(T||"").replace(/\D/g,"");if(!O)return"";const X=O.slice(0,Math.max(1,O.length-2)),G=O.slice(-2).padStart(2,"0");return`${Number(X).toLocaleString("pt-BR")},${G}`},$n=Array.isArray(QU)?QU:[];p.useEffect(()=>{let T=!1;async function O(){if(t)try{const{data:X}=await fe.from("empresas").select("uf").eq("codigo_empresa",t).single();T||hr(X?.uf||"")}catch{}}return O(),()=>{T=!0}},[t]),p.useEffect(()=>{let T=!0;async function O(){if(!(!st||!t))try{const X=await fu({includeInactive:!1,codigoEmpresa:t});T&&Qt(X||[])}catch{T&&Qt([])}}return O(),()=>{T=!1}},[st,t]);const at=p.useMemo(()=>{const T=(Se||"").trim().toLowerCase();return T?Mt.filter(O=>(O.name||"").toLowerCase().includes(T)||(O.code||"").toLowerCase().includes(T)).slice(0,100):Mt.slice(0,100)},[Mt,Se]),Vt=(T,O=Me.tipo_nota)=>{const X=String(zt||"").toUpperCase(),G=String(T||"").toUpperCase(),Re=!!X&&!!G?G===X:!0;return O!=="entrada"?Re?"5102":"6102":Re?"1102":"2102"},wr=T=>{const X=($n.find(G=>G.code===T)?.desc||"").toLowerCase();return Me.tipo_nota==="entrada"&&(X.includes("compra")||X.includes("entrada"))?"COMPRA":X.includes("venda")?"VENDA":X.includes("devolu")?"DEVOLUCAO":X.includes("transfer")?"TRANSFERENCIA":X.includes("bonifica")?"BONIFICACAO":X.includes("remessa")?"REMESSA":X.includes("demonstra")?"DEMONSTRACAO":Me.natOp||"VENDA"},er=(T,O)=>{$e(X=>{const G=[...X.itens],L=O?.cfopInterno||O?.cfopExterno||Vt(X.uf),Re=Number(O?.price??O?.salePrice??0)||0,rt=String(X.uf||"").toUpperCase()===String(zt||"").toUpperCase(),lt=rt?O?.cstIcmsInterno||"":O?.cstIcmsExterno||"",$t=rt?O?.csosnInterno||"":O?.csosnExterno||"",Fe=rt?O?.aliqIcmsInterno??null:O?.aliqIcmsExterno??null,It=O?.cstPisSaida||((O?.aliqPisPercent??null)!=null?"01":""),Sr=O?.aliqPisPercent??null,kr=(O?.aliqCofinsPercent??null)!=null?"01":"",pr=O?.aliqCofinsPercent??null,yn=O?.cstIpi||"",In=O?.aliqIpiPercent??null;G[T]={...G[T],descricao:O?.name||G[T].descricao,codigo:O?.code||G[T].codigo,cod_barras:O?.barcode||O?.ean||O?.gtin||O?.bar_code||G[T].cod_barras,unidade:(O?.unit||"UN").toString().toUpperCase(),ncm:O?.ncm||G[T].ncm,cest:O?.cest||G[T].cest,cfop:L||G[T].cfop,preco_unitario:Re?Re.toFixed(2):G[T].preco_unitario,impostos:{...G[T].impostos||{},icms:{...G[T].impostos?.icms||{},cst:lt||G[T].impostos?.icms?.cst||"",csosn:$t||G[T].impostos?.icms?.csosn||"",aliquota:Fe!=null?String(Fe):G[T].impostos?.icms?.aliquota||""},pis:{...G[T].impostos?.pis||{},cst:It||G[T].impostos?.pis?.cst||"",aliquota:Sr!=null?String(Sr):G[T].impostos?.pis?.aliquota||""},cofins:{...G[T].impostos?.cofins||{},cst:kr||G[T].impostos?.cofins?.cst||"",aliquota:pr!=null?String(pr):G[T].impostos?.cofins?.aliquota||""},ipi:{...G[T].impostos?.ipi||{},cst:yn||G[T].impostos?.ipi?.cst||"",aliquota:In!=null?String(In):G[T].impostos?.ipi?.aliquota||""}}};const Xn=wr(L||G[T].cfop);return{...X,itens:G,natOp:Xn}}),fr(null)};p.useEffect(()=>{let T=!0;async function O(){if(Ee)try{if(Et==="fornecedor"){const X=await sot(t);T&&pt(X||[])}else{const X=await ib({searchTerm:Ge,limit:50,codigoEmpresa:t});T&&pt(X||[])}}catch{T&&pt([])}}return O(),()=>{T=!1}},[Ee,Ge,Et,t]);const Ze=p.useMemo(()=>{const T=(Ge||"").trim().toLowerCase();return T?(St||[]).filter(O=>{const X=String(O.codigo||O.codigo_cliente||O.codigo_fornecedor||O.code||"").toLowerCase(),G=String(O.nome||O.razao_social||O.apelido||"").toLowerCase(),L=String(O.cnpj||O.cpf||"").toLowerCase();return X.includes(T)||G.includes(T)||L.includes(T)}):St||[]},[St,Ge]),Fr=async T=>{const O=String(T||"").replace(/\D/g,"");if(!(!O||!t))try{let X=fe.from("clientes").select("*").eq("codigo_empresa",t).eq("codigo",Number(O)).limit(1);Me.tipo_nota==="entrada"&&(X=X.eq("is_fornecedor",!0));const{data:G}=await X.single();G&&jt(G)}catch{}},jt=T=>{if(!T)return;const O=(T.tipo_pessoa||"PJ")==="PJ"||!!T.cnpj;$e(X=>({...X,parte_tipo:Et,party_id:T.id||"",party_codigo:String(T.codigo||T.codigo_cliente||T.codigo_fornecedor||T.code||""),tipo_pessoa:O?"PJ":"PF",cpf_cnpj:(T.cnpj||T.cpf||"").toString(),nome:T.nome||T.razao_social||T.apelido||"",email:T.email||"",telefone:T.telefone||"",logradouro:T.endereco||T.logradouro||"",numero:T.numero||"",bairro:T.bairro||"",cidade:T.cidade||"",uf:T.uf||"",cep:T.cep||"",codigo_municipio_ibge:T.cidade_ibge||T.codigo_municipio_ibge||"",inscricao_estadual:T.ie||T.inscricao_estadual||"",ie_isento:T.ie==="ISENTO"||!1})),qe(!1)};p.useEffect(()=>{let T=!0;async function O(){if(!(!st||Be!=="pagamento"))try{const X=await Wm({somenteAtivas:!0,codigoEmpresa:t});T&&ft(Array.isArray(X)?X:[])}catch{T&&ft([])}}return O(),()=>{T=!1}},[st,Be,t]);const _r=T=>/.+@.+\..+/.test(String(T||"")),bt=async T=>{const O=Rr(T);if(O.length===8)try{ht(!0);let X=null;try{const G=await fetch(`https://brasilapi.com.br/api/cep/v2/${O}`);G.ok&&(X=await G.json())}catch{}if(!X)try{const G=await fetch(`https://viacep.com.br/ws/${O}/json/`);G.ok&&(X=await G.json())}catch{}if(X){const G=X.street||X.logradouro||"",L=X.neighborhood||X.bairro||"",Re=X.city||X.localidade||"",rt=(X.state||X.uf||"").toString().toUpperCase().slice(0,2),lt=X.city_ibge_code||X.ibge||"";$e($t=>({...$t,logradouro:G||$t.logradouro,bairro:L||$t.bairro,cidade:Re||$t.cidade,uf:rt||$t.uf,codigo_municipio_ibge:lt||$t.codigo_municipio_ibge}))}}finally{ht(!1)}},Wt=()=>{try{const T=localStorage.getItem("auth:userProfile");return T&&JSON.parse(T)?.codigo_empresa||null}catch{return null}},Zt=()=>{let T=null,O=null;if(b&&(T=new Date(b+"T00:00:00").toISOString()),j){const X=new Date(j+"T00:00:00");X.setDate(X.getDate()+1),O=X.toISOString()}return{fromISO:T,toISOExclusive:O}},Br=async()=>{if(t){l(!0);try{let T=fe.from("comandas").select("*").eq("codigo_empresa",t).not("fechado_em","is",null).neq("status","cancelled").order("aberto_em",{ascending:!1}).limit(300);const{fromISO:O,toISOExclusive:X}=Zt();O&&(T=T.gte("aberto_em",O)),X&&(T=T.lt("aberto_em",X));const{data:G,error:L}=await T;if(L)throw L;const Re=G||[],rt=Re.map(pr=>pr.id);let lt={};if(rt.length)try{lt=await lS(rt,t)}catch{lt={}}let $t=[];try{$t=await Hm(t)}catch{$t=[]}const Fe=new Map(($t||[]).map(pr=>[pr.id,pr.numero]));let It={},Sr={};try{It=await bT(rt)}catch{It={}}try{Sr=await wT(rt)}catch{Sr={}}const kr=Re.map(pr=>({...pr,total:Number(lt[pr.id]||0),mesaNumero:Fe.get(pr.mesa_id),clientesStr:Array.isArray(It[pr.id])?It[pr.id].join(", "):It[pr.id]||"",finalizadorasStr:Array.isArray(Sr[pr.id])?Sr[pr.id].join(", "):Sr[pr.id]||""}));s(kr)}catch(T){r({title:"Erro ao carregar",description:T.message,variant:"destructive"})}finally{l(!1)}}};p.useEffect(()=>{Br()},[t,b,j]),p.useEffect(()=>{let T=!1;async function O(){if(t)try{const{data:X}=await fe.from("empresas").select("cnpj, inscricao_estadual, regime_tributario, cidade, uf, codigo_municipio_ibge, nfce_serie, nfce_itoken, ambiente, transmitenota_apikey, transmitenota_base_url, transmitenota_apikey_hml, transmitenota_base_url_hml, transmitenota_apikey_prod, transmitenota_base_url_prod").eq("codigo_empresa",t).single();if(T)return;const G=[],L=Fe=>String(Fe||"").replace(/\D/g,"");(!L(X?.cnpj)||L(X?.cnpj).length!==14)&&G.push("CNPJ"),X?.inscricao_estadual||G.push("Inscrio Estadual"),X?.regime_tributario||G.push("CRT"),(!X?.cidade||!X?.uf)&&G.push("Cidade/UF"),X?.codigo_municipio_ibge||G.push("cMun IBGE"),X?.nfce_serie||G.push("Srie NFC-e");const Re=String(X?.ambiente||"homologacao");Re==="producao"&&!X?.nfce_itoken&&G.push("CSC/IToken");const rt=Re==="producao",lt=rt?!!X?.transmitenota_apikey_prod||!!X?.transmitenota_apikey:!!X?.transmitenota_apikey_hml||!!X?.transmitenota_apikey,$t=rt?!!X?.transmitenota_base_url_prod||!!X?.transmitenota_base_url:!!X?.transmitenota_base_url_hml||!!X?.transmitenota_base_url;lt||G.push(rt?"ApiKey (PROD)":"ApiKey (HML)"),$t||G.push(rt?"Base URL (PROD)":"Base URL (HML)"),ue(G)}catch{}}return O(),()=>{T=!0}},[t]),p.useEffect(()=>{if(!t)return;const T=setInterval(()=>{Br()},2e4);return()=>clearInterval(T)},[t,b,j]);const zr=p.useMemo(()=>{const T=(c||"").trim().toLowerCase(),O=X=>{const G=X.nf_status||"pendente";return C?G==="pendente"||G==="rejeitada":u==="all"?!0:G===u};return(o||[]).filter(X=>O(X)).filter(X=>T?(X.xml_chave||"").toLowerCase().includes(T)||String(X.nf_numero||"").includes(T):!0)},[o,c,u,C]),_t=T=>{const O=(T||"pendente").toLowerCase(),X={pendente:"bg-amber-500/15 text-amber-400 border border-amber-400/30",processando:"bg-blue-500/15 text-blue-400 border border-blue-400/30",autorizada:"bg-emerald-500/15 text-emerald-400 border border-emerald-400/30",rejeitada:"bg-red-500/15 text-red-400 border border-red-400/30",cancelada:"bg-gray-500/15 text-gray-400 border border-gray-400/30"};return X[O]||X.pendente},Jr=async T=>{try{Q(!0);const O=t||Wt(),{payload:X,missing:G}=await gv({comandaId:T,codigoEmpresa:O});be(X),B(G||[]),H(!0)}catch(O){r({title:"Falha ao gerar prvia",description:O.message,variant:"destructive"})}finally{Q(!1)}},mn=async(T,O)=>{await fe.from("comandas").update(O).eq("id",T).eq("codigo_empresa",t)},ma=async T=>{Le(T);try{const{data:O}=await fe.from("empresas").select("nfe_serie, ambiente, uf").eq("codigo_empresa",t).single();ie(X=>({...X,serie:String(O?.nfe_serie||"1")}))}catch{}ee(""),Z(!0)},Nn=async()=>{if(de)try{le(!0);const T=await Tit({comandaId:de,codigoEmpresa:t,modelo:"55",overrides:ae});ee(T),r({title:"XML NF-e gerado"})}catch(T){r({title:"Falha ao gerar XML",description:T.message,variant:"destructive"})}finally{le(!1)}},re=async()=>{if(!(!se||!de))try{At(!0);const T=`nfe/${t}/${de}-${Date.now()}.xml`,O=new Blob([se],{type:"text/xml;charset=utf-8"}),{error:X}=await fe.storage.from("fiscal").upload(T,O,{contentType:"text/xml"});if(X)throw X;const{data:G}=await fe.storage.from("fiscal").getPublicUrl(T),L=G?.publicUrl||null;await fe.from("comandas").update({nf_xml_url:L||T,nf_status:"pendente"}).eq("id",de).eq("codigo_empresa",t);try{const Re=o.find(lt=>lt.id===de),rt=Number(Re?.total||0);await fe.from("notas_fiscais").insert({codigo_empresa:t,origem:"comanda",comanda_id:de,modelo:"55",numero:ae.nNF?Number(ae.nNF):null,serie:ae.serie?Number(ae.serie):null,status:"pendente",xml_url:L||T,pdf_url:null,valor_total:isFinite(rt)?rt:null,destinatario:null})}catch{}r({title:"XML salvo",description:L?"Link pblico gerado.":"Arquivo salvo no Storage."}),await Br()}catch(T){r({title:"Falha ao salvar XML",description:T.message,variant:"destructive"})}finally{At(!1)}},Te=async T=>{try{l(!0);const{empresa:O,payload:X,missing:G}=await gv({comandaId:T,codigoEmpresa:t});if(G&&G.length){r({title:"Pendncias para emisso",description:G.join(", "),variant:"destructive"});return}const L=wj(O);if(!L.cnpj||L.cnpj.length!==14){r({title:"CNPJ invlido",description:"CNPJ da empresa est ausente ou invlido (14 dgitos).",variant:"destructive"});return}if(!L.apiKey||!L.baseUrl){r({title:"Configurao fiscal incompleta",description:"Preencha Base URL e ApiKey do ambiente atual nas Configuraes.",variant:"destructive"});return}await mn(T,{nf_status:"processando"});let Re;try{Re=await Cst({baseUrl:L.baseUrl,apiKey:L.apiKey,cnpj:L.cnpj,dados:X.Dados})}catch(pr){throw await mn(T,{nf_status:"rejeitada"}),pr}const rt=Re?.chave||Re?.Chave||Re?.chaveAcesso||null,lt=Re?.numero||Re?.Numero||null,$t=Re?.serie||Re?.Serie||null,Fe=Re?.pdf_url||Re?.PdfUrl||null,It=Re?.xml_url||Re?.XmlUrl||null,Sr=Re?.protocolo||Re?.Protocolo||null,kr=!!(Re?.autorizada||Re?.Autorizada||Re?.sucesso||Re?.Sucesso||rt);await mn(T,{nf_status:kr?"autorizada":"processando",xml_chave:rt,nf_numero:lt,nf_serie:$t,nf_pdf_url:Fe,nf_xml_url:It,xml_protocolo:Sr}),r({title:kr?"NFC-e autorizada":"Emisso enviada",description:kr?"Documento autorizado.":"Aguardando autorizao."}),await Br()}catch(O){r({title:"Falha ao emitir",description:O.message,variant:"destructive"})}finally{l(!1)}},ot=async T=>{try{l(!0);const O=o.find(kr=>kr.id===T);if(!O)return;const{empresa:X}=await gv({comandaId:T,codigoEmpresa:t}),G=wj(X),L=O.xml_chave?{chave:O.xml_chave}:{numero:O.nf_numero,serie:O.nf_serie},Re=await VU({baseUrl:G.baseUrl,apiKey:G.apiKey,cnpj:G.cnpj,dados:L}),rt=Re?.status||Re?.Status||(Re?.autorizada?"autorizada":O.nf_status),lt=Re?.pdf_url||Re?.PdfUrl||O.nf_pdf_url,$t=Re?.xml_url||Re?.XmlUrl||O.nf_xml_url,Fe=Re?.chave||Re?.Chave||O.xml_chave,It=Re?.numero||Re?.Numero||O.nf_numero,Sr=Re?.serie||Re?.Serie||O.nf_serie;await mn(T,{nf_status:rt,nf_pdf_url:lt,nf_xml_url:$t,xml_chave:Fe,nf_numero:It,nf_serie:Sr}),r({title:"Consulta concluda"}),await Br()}catch(O){r({title:"Falha ao consultar",description:O.message,variant:"destructive"})}finally{l(!1)}},te=async T=>{try{const O=window.prompt("Informe o motivo do cancelamento:");if(!O)return;l(!0);const{empresa:X}=await gv({comandaId:T,codigoEmpresa:t}),G=wj(X),L=o.find(rt=>rt.id===T),Re=L.xml_chave?{chave:L.xml_chave,motivo:O}:{numero:L.nf_numero,serie:L.nf_serie,motivo:O};await Pst({baseUrl:G.baseUrl,apiKey:G.apiKey,cnpj:G.cnpj,dados:Re}),await mn(T,{nf_status:"cancelada"}),r({title:"NFC-e cancelada"}),await Br()}catch(O){r({title:"Falha ao cancelar",description:O.message,variant:"destructive"})}finally{l(!1)}};return a.jsxs("div",{className:"relative p-4",children:[a.jsx(Qw,{children:a.jsx("title",{children:"Central Fiscal"})}),a.jsxs("div",{className:"absolute inset-0 z-[10] flex justify-center items-start pt-10 pb-8 pointer-events-auto",children:[a.jsx("div",{className:"absolute inset-0 bg-black/85 backdrop-blur-md"}),a.jsxs("div",{className:"relative max-w-xl w-[min(92vw,640px)] rounded-2xl border border-warning/50 bg-gradient-to-br from-surface via-surface-2 to-surface shadow-2xl px-6 py-7 text-center flex flex-col items-center gap-4",children:[a.jsxs("div",{className:"inline-flex items-center gap-3 px-3 py-1 rounded-full bg-warning/10 border border-warning/40 text-warning text-xs font-semibold uppercase tracking-wide",children:[a.jsx("span",{className:"w-5 h-5 rounded-full bg-warning text-black flex items-center justify-center text-[11px] font-black",children:"NF"}),a.jsx("span",{children:"Central Fiscal em desenvolvimento"})]}),a.jsx("div",{className:"flex items-center justify-center w-14 h-14 rounded-2xl bg-warning/15 border border-warning/50 text-warning shadow-lg",children:a.jsx(Gs,{className:"w-7 h-7"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Em breve: painel fiscal completo diretamente no F7 Arena"}),a.jsx("p",{className:"text-sm text-text-secondary leading-relaxed",children:"Estamos construindo a nova Central Fiscal para acompanhar emisses de NFC-e e NF-e, revisar pendncias e acessar detalhes das notas em um s lugar."})]}),a.jsxs("div",{className:"w-full text-left text-xs md:text-sm text-text-secondary bg-surface/70 border border-white/5 rounded-xl p-4 space-y-2",children:[a.jsx("p",{className:"font-semibold text-text-primary mb-1",children:"Enquanto isso, voc pode:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:["Ajustar as configuraes fiscais da empresa na aba ",a.jsx("strong",{children:"Configurao Fiscal"}),";"]}),a.jsx("li",{children:"Validar CNPJ, inscrio estadual e parmetros da NFC-e/NF-e;"}),a.jsx("li",{children:"Integrar ou revisar os dados da API de emisso fiscal."})]})]}),a.jsx("p",{className:"text-[11px] text-text-muted",children:"Esta aba est em modo de desenvolvimento e ainda no deve ser utilizada em produo."})]})]}),a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Central Fiscal"}),a.jsx(ce,{type:"button",variant:"outline",size:"sm",className:"rounded-full",onClick:()=>n("/configuracao-fiscal"),title:"Configurao Fiscal",children:a.jsx(Of,{className:"w-4 h-4"})})]}),J.length>0&&a.jsx("div",{className:"mb-4 p-3 rounded-md border border-warning/40 bg-warning/10 text-warning",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-sm",children:"Pendncias fiscais da empresa"}),a.jsxs("p",{className:"text-xs",children:["Preencha: ",J.join(", "),"."]})]}),a.jsx(ce,{size:"sm",className:"bg-warning text-black hover:bg-warning/90",onClick:()=>n("/configuracao-fiscal"),children:"Corrigir agora"})]})}),a.jsxs(_c,{value:F,onValueChange:M,className:"w-full",children:[a.jsxs(ql,{className:"mb-3",children:[a.jsx(ca,{value:"nfce",children:"NFC-e"}),a.jsx(ca,{value:"nfe",children:"NF-e"})]}),a.jsxs(uo,{value:"nfce",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(De,{className:"text-sm",children:"Buscar"}),a.jsx(Je,{value:c,onChange:T=>d(T.target.value),placeholder:"Chave, nmero...",className:"w-60"})]}),a.jsx(De,{className:"text-sm ml-1",children:"Status"}),a.jsxs(Cn,{value:u,onValueChange:f,children:[a.jsx(jn,{className:"w-[170px] rounded-full",children:a.jsx(An,{placeholder:"Selecionar status"})}),a.jsxs(_n,{className:"rounded-xl",children:[a.jsx(nt,{value:"all",children:"Todos"}),a.jsx(nt,{value:"pendente",children:"Pendente"}),a.jsx(nt,{value:"processando",children:"Em andamento"}),a.jsx(nt,{value:"autorizada",children:"Autorizada"}),a.jsx(nt,{value:"rejeitada",children:"Rejeitada"}),a.jsx(nt,{value:"cancelada",children:"Cancelada"})]})]}),a.jsx(De,{className:"text-sm ml-2",children:"Perodo"}),a.jsxs("div",{className:"inline-flex items-center gap-2",children:[a.jsx(cv,{label:"Perodo inicial",value:b,onChange:w}),a.jsx("span",{className:"text-text-secondary",children:"at"}),a.jsx(cv,{label:"Perodo final",value:j,onChange:_})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 ml-2 text-sm",children:[a.jsx(Ha,{checked:C,onCheckedChange:E,className:"rounded-full border-warning data-[state=checked]:bg-warning"}),a.jsx("span",{children:"Somente pendentes/rejeitadas"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ce,{size:"sm",variant:"outline",disabled:!A,onClick:()=>(async()=>{const T=o.find(O=>O.id===A);if(T){if(T.nf_pdf_url){window.open(T.nf_pdf_url,"_blank");return}try{l(!0);const{empresa:O}=await gv({comandaId:T.id,codigoEmpresa:t}),X=wj(O),G=T.xml_chave?{chave:T.xml_chave}:{numero:T.nf_numero,serie:T.nf_serie},L=await VU({baseUrl:X.baseUrl,apiKey:X.apiKey,cnpj:X.cnpj,dados:G}),Re=L?.pdf_url||L?.PdfUrl;Re?(await fe.from("comandas").update({nf_pdf_url:Re}).eq("id",T.id).eq("codigo_empresa",t),window.open(Re,"_blank")):r({title:"Sem PDF disponvel",description:"Documento ainda no possui DANFE.",variant:"destructive"}),await Br()}catch(O){r({title:"Falha ao visualizar",description:O.message,variant:"destructive"})}finally{l(!1)}}})(),children:"Visualizar"}),a.jsx(ce,{size:"sm",disabled:!A||!["pendente","rejeitada"].includes(o.find(T=>T.id===A)?.nf_status||"pendente"),onClick:()=>Te(A),children:"Emitir"}),a.jsx(ce,{size:"sm",variant:"outline",disabled:!A||o.find(T=>T.id===A)?.nf_status!=="processando",onClick:()=>ot(A),children:"Consultar"}),a.jsx(ce,{size:"sm",variant:"destructive",disabled:!A||o.find(T=>T.id===A)?.nf_status!=="autorizada",onClick:()=>te(A),children:"Cancelar"})]}),a.jsx("div",{className:"bg-surface rounded border border-border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Abertura"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Status"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Chave"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Total"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Aes"})]})}),a.jsxs("tbody",{children:[(!zr||zr.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-text-muted",children:i?"Carregando...":"Nada por aqui"})}),zr.map(T=>{const O=T.nf_status||"pendente";return a.jsxs("tr",{className:`border-t border-border/60 transition-colors ${A===T.id?"bg-surface-2 ring-2 ring-[#FF7A1A]/60 rounded-md":"hover:bg-surface-2/50"}`,onClick:()=>P(T.id),children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:ZU(T.aberto_em)}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${_t(O)}`,children:O})}),a.jsx("td",{className:"px-3 py-2 break-all max-w-[380px]",children:T.xml_chave||""}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap",children:["R$ ",Qc(T.total||T.total_com_desconto)]}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap flex gap-2 justify-end",children:[(O==="pendente"||O==="rejeitada")&&a.jsxs(a.Fragment,{children:[a.jsx(ce,{size:"sm",variant:"outline",onClick:()=>Jr(T.id),children:"Pr-Emisso"}),a.jsx(ce,{size:"sm",onClick:()=>Te(T.id),children:"Emitir"})]}),O==="processando"&&a.jsx(ce,{size:"sm",variant:"outline",onClick:()=>ot(T.id),children:"Consultar"}),O==="autorizada"&&a.jsx(ce,{size:"sm",variant:"destructive",onClick:()=>te(T.id),children:"Cancelar"}),T.nf_pdf_url&&a.jsx("a",{className:"inline-flex",href:T.nf_pdf_url,target:"_blank",rel:"noreferrer",children:a.jsx(ce,{size:"sm",variant:"outline",children:"DANFE"})}),T.nf_xml_url&&a.jsx("a",{className:"inline-flex",href:T.nf_xml_url,target:"_blank",rel:"noreferrer",children:a.jsx(ce,{size:"sm",variant:"outline",children:"XML"})})]})]},T.id)})]})]})})]}),a.jsxs(uo,{value:"nfe",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(De,{className:"text-sm",children:"Buscar"}),a.jsx(Je,{value:c,onChange:T=>d(T.target.value),placeholder:"Chave, nmero...",className:"w-60"})]}),a.jsx(De,{className:"text-sm ml-1",children:"Status"}),a.jsxs(Cn,{value:u,onValueChange:f,children:[a.jsx(jn,{className:"w-[170px] rounded-full",children:a.jsx(An,{placeholder:"Selecionar status"})}),a.jsxs(_n,{className:"rounded-xl",children:[a.jsx(nt,{value:"all",children:"Todos"}),a.jsx(nt,{value:"pendente",children:"Pendente"}),a.jsx(nt,{value:"processando",children:"Em andamento"}),a.jsx(nt,{value:"autorizada",children:"Autorizada"}),a.jsx(nt,{value:"rejeitada",children:"Rejeitada"}),a.jsx(nt,{value:"cancelada",children:"Cancelada"})]})]}),a.jsx(De,{className:"text-sm ml-2",children:"Perodo"}),a.jsxs("div",{className:"inline-flex items-center gap-2",children:[a.jsx(cv,{label:"Perodo inicial",value:b,onChange:w}),a.jsx("span",{className:"text-text-secondary",children:"at"}),a.jsx(cv,{label:"Perodo final",value:j,onChange:_})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 ml-2 text-sm",children:[a.jsx(Ha,{checked:C,onCheckedChange:E,className:"rounded-full border-warning data-[state=checked]:bg-warning"}),a.jsx("span",{children:"Somente pendentes/rejeitadas"})]}),a.jsx("div",{className:"ml-auto",children:a.jsx(ce,{size:"sm",onClick:()=>{Nt(""),ut(!0)},children:"Nova NF-e"})})]}),a.jsx("div",{className:"bg-surface rounded border border-border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Abertura"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Status"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Chave"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Total"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Aes"})]})}),a.jsxs("tbody",{children:[(!zr||zr.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-text-muted",children:i?"Carregando...":"Nada por aqui"})}),zr.map(T=>{const O=T.nf_status||"pendente";return a.jsxs("tr",{className:`border-t border-border/60 transition-colors ${A===T.id?"bg-surface-2 ring-2 ring-[#FF7A1A]/60 rounded-md":"hover:bg-surface-2/50"}`,onClick:()=>P(T.id),children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:ZU(T.aberto_em)}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${_t(O)}`,children:O})}),a.jsx("td",{className:"px-3 py-2 break-all max-w-[380px]",children:T.xml_chave||""}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap",children:["R$ ",Qc(T.total||T.total_com_desconto)]}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap flex gap-2 justify-end",children:[a.jsx(ce,{size:"sm",onClick:()=>ma(T.id),children:"Gerar XML NF-e"}),a.jsx(ce,{size:"sm",variant:"outline",disabled:!0,children:"Emitir via API (em breve)"}),T.nf_xml_url&&a.jsx("a",{className:"inline-flex",href:T.nf_xml_url,target:"_blank",rel:"noreferrer",children:a.jsx(ce,{size:"sm",variant:"outline",children:"XML"})})]})]},T.id)})]})]})})]})]}),a.jsx(xn,{open:z,onOpenChange:H,children:a.jsxs(vn,{className:"max-w-[800px]",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Pr-Emisso NFC-e"}),a.jsx(On,{children:"Revise os dados e pendncias antes de emitir."})]}),q?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Gerando prvia"}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"JSON (EnviarNfce)"}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto",children:pe?JSON.stringify(pe,null,2):""})]}),a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Pendncias"}),!V||V.length===0?a.jsx("div",{className:"text-sm text-emerald-500",children:"Nenhuma pendncia encontrada."}):a.jsx("ul",{className:"list-disc pl-5 text-sm",children:V.map((T,O)=>a.jsx("li",{children:T},O))})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(ce,{variant:"outline",onClick:()=>H(!1),children:"Fechar"}),a.jsx(ce,{disabled:!0,children:"Emitir (desabilitado)"})]})]})}),a.jsx(xn,{open:Ee,onOpenChange:qe,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsxs(fn,{children:["Selecionar ",Et==="fornecedor"?"fornecedor":"cliente"]}),a.jsx(On,{children:"Busque pelo cdigo, nome ou documento e escolha a parte."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ce,{size:"sm",variant:Et==="cliente"?"default":"outline",onClick:()=>mt("cliente"),children:"Clientes"}),a.jsx(ce,{size:"sm",variant:Et==="fornecedor"?"default":"outline",onClick:()=>mt("fornecedor"),children:"Fornecedores"})]}),a.jsx("div",{className:"flex-1 min-w-[200px]",children:a.jsx(Je,{placeholder:"Buscar por cdigo, nome ou documento",value:Ge,onChange:T=>Qe(T.target.value)})}),a.jsxs("span",{className:"text-xs text-text-secondary",children:[Ze.length," itens"]})]}),a.jsxs("div",{className:"border border-border rounded-md divide-y divide-border",children:[Ze.map(T=>a.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 hover:bg-surface-2 cursor-pointer",onClick:()=>jt(T),children:[a.jsx("div",{className:"col-span-2 text-xs font-medium",children:String(T.codigo||T.codigo_cliente||T.codigo_fornecedor||T.code||"")}),a.jsx("div",{className:"col-span-6 text-sm truncate",title:T.nome||T.razao_social||"",children:T.nome||T.razao_social||"Sem nome"}),a.jsxs("div",{className:"col-span-4 text-xs text-text-secondary text-right",children:[(T.cnpj||T.cpf||"").toString()," ",T.cidade?` ${T.cidade}/${T.uf||""}`:""]})]},T.id)),Ze.length===0&&a.jsx("div",{className:"text-xs text-text-secondary px-3 py-2",children:"Nenhum registro encontrado"})]}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx(ce,{variant:"outline",onClick:()=>qe(!1),children:"Fechar"})})]})}),a.jsx(xn,{open:yr,onOpenChange:Xt,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Selecionar produto"}),a.jsx(On,{children:"Busque pelo nome ou cdigo para preencher o item."})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Je,{placeholder:"Buscar produto por nome ou cdigo",value:Se,onChange:T=>kt(T.target.value)}),a.jsxs("span",{className:"text-xs text-text-secondary",children:[at.length," itens"]})]}),a.jsxs("div",{className:"border border-border rounded-md divide-y divide-border",children:[at.map(T=>a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 hover:bg-surface-2 cursor-pointer",onClick:()=>{nr!=null&&er(nr,T),Xt(!1)},children:[a.jsxs("div",{className:"text-sm",children:[T.name," ",a.jsx("span",{className:"text-text-secondary",children:T.code?`(${T.code})`:""})]}),a.jsxs("div",{className:"text-xs text-text-secondary",children:["NCM ",T.ncm||"","  UN ",String(T.unit||"UN").toUpperCase(),"  R$ ",Qc(T.price??T.salePrice??0)]})]},T.id)),at.length===0&&a.jsx("div",{className:"text-xs text-text-secondary px-3 py-2",children:"Nenhum produto encontrado"})]}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx(ce,{variant:"outline",onClick:()=>Xt(!1),children:"Fechar"})})]})}),a.jsx(xn,{open:st,onOpenChange:ut,children:a.jsxs(vn,{className:"w-[960px] max-w-[96vw] h-[85vh] overflow-hidden flex flex-col",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Criar NF-e (manual)"}),a.jsx(On,{children:"Preencha os dados nas abas para gerar o XML."})]}),a.jsxs(_c,{value:Be,onValueChange:we,className:"w-full flex-1 overflow-hidden flex flex-col",children:[a.jsxs(ql,{className:"mb-3 w-full flex flex-wrap justify-start gap-1",children:[a.jsx(ca,{value:"cliente",children:"Cabealho"}),a.jsx(ca,{value:"itens",children:"Produtos"}),a.jsx(ca,{value:"impostos",children:"Impostos"}),a.jsx(ca,{value:"totais",children:"Totais"}),a.jsx(ca,{value:"pagamento",children:"Pagamento"}),a.jsx(ca,{value:"transporte",children:"Transporte"}),a.jsx(ca,{value:"adicionais",children:"Informaes"}),a.jsx(ca,{value:"rastreabilidade",children:"Rastreabilidade"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto pr-1",children:[Be==="cliente"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Tipo da Nota"}),a.jsxs(Cn,{value:Me.tipo_nota,onValueChange:T=>$e(O=>({...O,tipo_nota:T,natOp:T==="entrada"?"COMPRA":O.natOp||"VENDA"})),children:[a.jsx(jn,{className:"h-9",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"saida",children:"Sada"}),a.jsx(nt,{value:"entrada",children:"Entrada"})]})]})]}),a.jsxs("div",{children:[a.jsxs(De,{children:[Me.tipo_nota==="entrada"?"Fornecedor":"Cliente"," (cdigo)"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Je,{className:"h-9 w-[110px]",inputMode:"numeric",value:Me.party_codigo,onChange:T=>$e(O=>({...O,party_codigo:T.target.value.replace(/\D/g,"")})),onKeyDown:T=>{T.key==="Enter"&&(T.preventDefault(),Fr(Me.party_codigo))},onBlur:()=>Fr(Me.party_codigo),placeholder:""}),a.jsx(ce,{type:"button",size:"icon",variant:"ghost",title:"Selecionar",onClick:()=>{Qe(""),mt(Me.tipo_nota==="entrada"?"fornecedor":"cliente"),qe(!0)},children:a.jsx(ts,{className:"h-4 w-4"})}),(Me.party_codigo||Me.nome||Me.cpf_cnpj)&&a.jsx(ce,{type:"button",size:"icon",variant:"ghost",title:"Limpar",onClick:()=>$e(T=>({...T,party_id:"",party_codigo:"",tipo_pessoa:"PJ",cpf_cnpj:"",nome:"",email:"",telefone:"",inscricao_estadual:"",ie_isento:!1,logradouro:"",numero:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:""})),children:a.jsx(yl,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Data Emisso"}),a.jsx(cv,{label:"Data Emisso",value:Me.data_emissao,onChange:T=>$e(O=>({...O,data_emissao:T}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Data Sada"}),a.jsx(cv,{label:"Data Sada",value:Me.data_saida,onChange:T=>$e(O=>({...O,data_saida:T}))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Natureza (natOp)"}),a.jsx(Je,{className:"h-8",list:"natop-list",value:Me.natOp,onChange:T=>$e(O=>({...O,natOp:T.target.value}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Srie"}),a.jsx(Je,{className:"h-8",value:Me.serie,onChange:T=>$e(O=>({...O,serie:T.target.value}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Nmero (nNF)"}),a.jsx(Je,{className:"h-8",value:Me.nNF,onChange:T=>$e(O=>({...O,nNF:T.target.value}))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Finalidade da NF"}),a.jsxs(Cn,{value:Me.finNFe,onValueChange:T=>$e(O=>({...O,finNFe:T})),children:[a.jsx(jn,{className:"h-9",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"1",children:"Normal"}),a.jsx(nt,{value:"2",children:"Complementar"}),a.jsx(nt,{value:"3",children:"Ajuste"}),a.jsx(nt,{value:"4",children:"Devoluo"})]})]})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Local de Destino"}),a.jsxs(Cn,{value:Me.idDest,onValueChange:T=>$e(O=>({...O,idDest:T})),children:[a.jsx(jn,{className:"h-9",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"1",children:"Operao Interna"}),a.jsx(nt,{value:"2",children:"Interestadual"}),a.jsx(nt,{value:"3",children:"Exterior"})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Indicador de presena"}),a.jsxs(Cn,{value:Me.indPres,onValueChange:T=>$e(O=>({...O,indPres:T})),children:[a.jsx(jn,{className:"h-9",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"0",children:"No se aplica"}),a.jsx(nt,{value:"1",children:"Operao presencial"}),a.jsx(nt,{value:"2",children:"No presencial (internet)"}),a.jsx(nt,{value:"3",children:"No presencial (teleatendimento)"}),a.jsx(nt,{value:"4",children:"Entrega a domiclio"}),a.jsx(nt,{value:"9",children:"Outros"})]})]})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Intermediador/Marketplace"}),a.jsxs(Cn,{value:Me.indIntermed,onValueChange:T=>$e(O=>({...O,indIntermed:T})),children:[a.jsx(jn,{className:"h-9",children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"0",children:"Sem intermediador"}),a.jsx(nt,{value:"1",children:"Com intermediador"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:Me.indFinal==="1",onCheckedChange:T=>$e(O=>({...O,indFinal:T?"1":"0"}))}),a.jsx("span",{className:"text-sm",children:"Consumidor Final"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!Me.baixar_estoque,onCheckedChange:T=>$e(O=>({...O,baixar_estoque:!!T}))}),a.jsx("span",{className:"text-sm",children:"Baixar Estoque"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!Me.destacar_st,onCheckedChange:T=>$e(O=>({...O,destacar_st:!!T}))}),a.jsx("span",{className:"text-sm",children:"Destacar Substituio Trib."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"autoApplyCfop",checked:!!Mr,onCheckedChange:T=>Nr(!!T)}),a.jsx(De,{htmlFor:"autoApplyCfop",className:"text-xs",children:"Aplicar CFOP padro automaticamente aos itens"})]})]}),Me.indIntermed==="1"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(De,{children:"CNPJ Intermediador"}),a.jsx(Je,{inputMode:"numeric",placeholder:"Somente nmeros",value:Me.intermediador_cnpj,onChange:T=>$e(O=>({...O,intermediador_cnpj:Rr(T.target.value)}))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Identificador no Intermediador"}),a.jsx(Je,{value:Me.intermediador_id,onChange:T=>$e(O=>({...O,intermediador_id:T.target.value}))})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"CFOP padro"}),a.jsxs(Cn,{value:Me.cfop_padrao||"",onValueChange:T=>{wt(""),$e(O=>({...O,cfop_padrao:T,natOp:wr(T)}))},children:[a.jsx(jn,{className:"mt-1 w-full truncate h-8 text-xs",children:a.jsx(An,{placeholder:"Selecionar CFOP"})}),a.jsxs(_n,{className:"max-h-[300px] overflow-auto w-[360px] sm:w-[420px]",children:[a.jsx("div",{className:"sticky top-0 z-10 p-2 bg-background",children:a.jsx(Je,{className:"h-8 text-xs",placeholder:"Filtrar CFOP ou descrio",value:ye,onChange:T=>wt(T.target.value)})}),$n.filter(T=>{const O=ye.trim().toLowerCase();return O?T.code.toLowerCase().includes(O)||(T.desc||"").toLowerCase().includes(O):!0}).map(T=>a.jsx(nt,{value:T.code,title:`${T.code}  ${T.desc}`,children:`${T.code} - ${(T.desc||"").slice(0,60)}`},T.code))]})]})]})})]}),a.jsx(uo,{value:"cliente",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Tipo pessoa"}),a.jsxs(Cn,{value:Me.tipo_pessoa,onValueChange:T=>$e(O=>({...O,tipo_pessoa:T})),children:[a.jsx(jn,{children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"PJ",children:"PJ"}),a.jsx(nt,{value:"PF",children:"PF"})]})]})]}),a.jsxs("div",{children:[a.jsx(De,{children:"CPF/CNPJ"}),a.jsx(Je,{inputMode:"numeric",placeholder:"Somente nmeros",value:Me.cpf_cnpj,onChange:T=>$e(O=>({...O,cpf_cnpj:Rr(T.target.value)}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Nome/Razo"}),a.jsx(Je,{value:Me.nome,onChange:T=>$e(O=>({...O,nome:T.target.value}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Inscrio Estadual"}),a.jsx(Je,{value:Me.inscricao_estadual,onChange:T=>$e(O=>({...O,inscricao_estadual:T.target.value})),disabled:Me.ie_isento})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[a.jsx(Ha,{checked:Me.ie_isento,onCheckedChange:T=>$e(O=>({...O,ie_isento:!!T,inscricao_estadual:T?"ISENTO":O.inscricao_estadual}))}),a.jsx("span",{className:"text-sm",children:"IE Isento"})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Telefone"}),a.jsx(Je,{inputMode:"numeric",placeholder:"(DD) 9XXXX-XXXX",value:Me.telefone,onChange:T=>$e(O=>({...O,telefone:Rr(T.target.value)}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Email"}),a.jsx(Je,{value:Me.email,onChange:T=>$e(O=>({...O,email:T.target.value}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Logradouro"}),a.jsx(Je,{value:Me.logradouro,onChange:T=>$e(O=>({...O,logradouro:T.target.value}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Nmero"}),a.jsx(Je,{value:Me.numero,onChange:T=>$e(O=>({...O,numero:T.target.value}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Bairro"}),a.jsx(Je,{value:Me.bairro,onChange:T=>$e(O=>({...O,bairro:T.target.value}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Cidade"}),a.jsx(Je,{value:Me.cidade,onChange:T=>$e(O=>({...O,cidade:T.target.value}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"UF"}),a.jsx(Je,{value:Me.uf,onChange:T=>$e(O=>({...O,uf:T.target.value.toUpperCase().slice(0,2)}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"CEP"}),a.jsx(Je,{inputMode:"numeric",placeholder:"00000000",value:Me.cep,onChange:T=>$e(O=>({...O,cep:Rr(T.target.value).slice(0,8)})),onBlur:()=>bt(Me.cep)}),He&&a.jsx("div",{className:"text-xs text-text-secondary mt-1",children:"Buscando endereo"})]}),a.jsxs("div",{children:[a.jsx(De,{children:"cMun IBGE"}),a.jsx(Je,{inputMode:"numeric",placeholder:"Cdigo do municpio (IBGE)",value:Me.codigo_municipio_ibge,onChange:T=>$e(O=>({...O,codigo_municipio_ibge:Rr(T.target.value)}))})]})]})}),a.jsx(uo,{value:"itens",children:a.jsxs("div",{className:"space-y-2",children:[Me.itens.map((T,O)=>a.jsxs("div",{className:"space-y-1 border border-border rounded-md p-2",onClick:Fn(O),children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-1 items-start",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Cdigo"}),a.jsx(Je,{className:"h-8 text-xs",value:T.codigo,onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],codigo:X.target.value},{...G,itens:L}}),onKeyDown:X=>{if(X.key==="Enter"){const G=(Mt||[]).find(L=>String(L.code||"")===String((T.codigo||"").trim()));G&&er(O,G)}},onBlur:()=>{const X=(Mt||[]).find(G=>String(G.code||"")===String((T.codigo||"").trim()));X&&er(O,X)}})]}),a.jsxs("div",{className:"md:col-span-3 min-w-0",children:[a.jsx(De,{children:"Descrio"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Je,{className:"h-8 text-xs flex-1",value:T.descricao,onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],descricao:X.target.value},{...G,itens:L}})}),a.jsx(ce,{type:"button",size:"icon",variant:"ghost",title:"Buscar produto",onClick:()=>{ir(O),kt(""),Xt(!0)},children:a.jsx(ts,{className:"h-4 w-4"})}),a.jsx(ce,{type:"button",size:"icon",variant:"ghost",className:"text-text-secondary hover:text-red-500",title:"Remover item",onClick:()=>$e(X=>({...X,itens:X.itens.filter((G,L)=>L!==O)})),children:a.jsx(Bu,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"md:col-span-2 min-w-0",children:[a.jsx(De,{children:"CFOP"}),a.jsxs(Cn,{value:T.cfop||"",onValueChange:X=>{wt(""),$e(G=>{const L=[...G.itens];return L[O]={...L[O],cfop:X},{...G,itens:L,natOp:wr(X)}})},children:[a.jsx(jn,{className:"mt-1 w-full truncate h-8 text-xs",children:a.jsx(An,{placeholder:"Selecionar CFOP"})}),a.jsxs(_n,{className:"max-h-[300px] overflow-auto w-[360px] sm:w-[420px]",children:[a.jsx("div",{className:"sticky top-0 z-10 p-2 bg-background",children:a.jsx(Je,{className:"h-8 text-xs",placeholder:"Filtrar CFOP ou descrio",value:ye,onChange:X=>wt(X.target.value)})}),$n.filter(X=>{const G=ye.trim().toLowerCase();return G?X.code.toLowerCase().includes(G)||(X.desc||"").toLowerCase().includes(G):!0}).map(X=>a.jsx(nt,{value:X.code,title:`${X.code}  ${X.desc}`,children:`${X.code} - ${(X.desc||"").slice(0,60)}`},X.code))]})]})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx(De,{children:"Unid."}),a.jsx(Je,{className:"h-8 text-xs",list:"unid-list",placeholder:"UN, KG, LT",value:T.unidade,onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],unidade:X.target.value.toUpperCase().slice(0,5)},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx(De,{children:"Cd. Barras"}),a.jsx(Je,{className:"h-8 text-xs",value:T.cod_barras||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],cod_barras:X.target.value},{...G,itens:L}}),onKeyDown:X=>{if(X.key==="Enter"){const G=String((T.cod_barras||"").trim()),L=(Mt||[]).find(Re=>[Re.barcode,Re.ean,Re.gtin,Re.bar_code].some(rt=>String(rt||"")===G));L&&er(O,L)}},onBlur:()=>{const X=String((T.cod_barras||"").trim()),G=(Mt||[]).find(L=>[L.barcode,L.ean,L.gtin,L.bar_code].some(Re=>String(Re||"")===X));G&&er(O,G)}})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx(De,{children:"Qtd"}),a.jsx(Je,{className:"h-8 text-xs",inputMode:"decimal",value:T.quantidade,onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],quantidade:X.target.value.replace(/[^0-9.,]/g,"")},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Preo"}),a.jsx(Je,{className:"h-8 text-xs",inputMode:"decimal",value:T.preco_unitario,onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],preco_unitario:Hn(X.target.value)},{...G,itens:L}})})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-text-secondary mt-1",children:[a.jsx("div",{className:"truncate",children:`Item ${O+1}: ${T.codigo?T.codigo+" - ":""}${T.descricao||""}`}),a.jsx("div",{children:`Total item: R$ ${Qc((Er(T.preco_unitario)||0)*(Er(T.quantidade)||1)-(Er(T.desconto_percent)?(Er(T.preco_unitario)||0)*(Er(T.quantidade)||1)*(Er(T.desconto_percent)||0)/100:Er(T.desconto_valor)||0)+(Er(T.acrescimos_valor)||0)+(Er(T.frete_valor)||0)+(Er(T.seguro_valor)||0))}`})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!T.dest_icms,onCheckedChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],dest_icms:!!X},{...G,itens:L}})}),a.jsx("span",{className:"text-xs",children:"Destacar ICMS"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!T.dest_icms_info,onCheckedChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],dest_icms_info:!!X},{...G,itens:L}})}),a.jsx("span",{className:"text-xs",children:"ICMS na Info. Adicional"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!T.benef_fiscal,onCheckedChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],benef_fiscal:!!X},{...G,itens:L}})}),a.jsx("span",{className:"text-xs",children:"Benefcio Fiscal"})]})]}),Dt===O&&a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-12 gap-1",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"NCM"}),a.jsx(Je,{className:"h-8 text-xs",inputMode:"numeric",placeholder:"8 dgitos",value:T.ncm,onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],ncm:Rr(X.target.value).slice(0,8)},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"CEST"}),a.jsx(Je,{className:"h-8 text-xs",value:T.cest||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],cest:X.target.value},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Desc. (R$)"}),a.jsx(Je,{className:"h-8 text-xs",inputMode:"decimal",value:T.desconto_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],desconto_valor:Hn(X.target.value)},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Desc. (%)"}),a.jsx(Je,{className:"h-8 text-xs",inputMode:"decimal",value:T.desconto_percent||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],desconto_percent:X.target.value.replace(/[^0-9.,]/g,"")},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Acrscimos"}),a.jsx(Je,{className:"h-8 text-xs",inputMode:"decimal",value:T.acrescimos_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],acrescimos_valor:Hn(X.target.value)},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Frete (R$)"}),a.jsx(Je,{className:"h-8 text-xs",inputMode:"decimal",value:T.frete_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],frete_valor:Hn(X.target.value)},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Seguro (R$)"}),a.jsx(Je,{className:"h-8 text-xs",inputMode:"decimal",value:T.seguro_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],seguro_valor:Hn(X.target.value)},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-12",children:[a.jsx(De,{children:"Observaes"}),a.jsx(Je,{className:"h-8 text-xs",value:T.obs||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],obs:X.target.value},{...G,itens:L}})})]})]})]},O)),a.jsx("div",{className:"flex justify-start",children:a.jsx(ce,{size:"sm",variant:"outline",onClick:()=>{$e(T=>{const O={descricao:"",codigo:"",cod_barras:"",ncm:"",cest:"",cfop:T.cfop_padrao||"5102",unidade:"UN",quantidade:"1",preco_unitario:"0.00",desconto_valor:"0.00",desconto_percent:"",acrescimos_valor:"0.00",frete_valor:"0.00",seguro_valor:"0.00",obs:"",dest_icms:!1,dest_icms_info:!1,benef_fiscal:!1,impostos:{origem:"",icms:{cst:"",csosn:"",base:"",aliquota:"",valor:"",desonerado_valor:"",desoneracao_motivo:"",operacao_valor:"",aliq_diferimento:"",valor_diferido:""},icmsst:{base:"",aliquota:"",valor:""},fcp:{base:"",aliquota:"",valor:""},fcpst:{base:"",aliquota:"",valor:""},pis:{cst:"",aliquota:"",valor:""},cofins:{cst:"",aliquota:"",valor:""},ipi:{cst:"",aliquota:"",valor:"",tipo_calculo:"nenhum",valor_unit:""},iss:{aliquota:"",valor:""}}};return{...T,itens:[...T.itens,O]}})},children:"Adicionar item"})}),a.jsx("div",{className:"mt-2 overflow-x-auto border border-border rounded",children:a.jsxs("table",{className:"min-w-full text-[11px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-text-secondary",children:[a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Item"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Produto"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Descrio"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"UN"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"CST"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Qtde"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. Unit"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. ICMS"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. ICMS-ST"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. FCP"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Total Item"})]})}),a.jsx("tbody",{children:Me.itens.map((T,O)=>{const X=Er(T.preco_unitario)||0,G=Er(T.quantidade)||1,L=X*G,Re=Er(T.desconto_percent)||0,rt=Er(T.desconto_valor)||0,lt=Er(T.acrescimos_valor)||0,$t=Re?L*Re/100:rt,Fe=L-$t+lt+(Er(T.frete_valor)||0)+(Er(T.seguro_valor)||0),It=T.impostos?.icms?.cst||T.impostos?.icms?.csosn||"",Sr=Er(T.impostos?.icms?.valor)||0,kr=Er(T.impostos?.icmsst?.valor)||0,pr=Er(T.impostos?.fcp?.valor)||0;return a.jsxs("tr",{className:"border-t border-border/60",children:[a.jsx("td",{className:"px-2 py-1",children:O+1}),a.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:T.codigo||""}),a.jsx("td",{className:"px-2 py-1 truncate max-w-[320px]",children:T.descricao||""}),a.jsx("td",{className:"px-2 py-1",children:T.unidade||"UN"}),a.jsx("td",{className:"px-2 py-1",children:It||""}),a.jsx("td",{className:"px-2 py-1 text-right",children:Qc(G)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Qc(X)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Qc(Sr)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Qc(kr)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Qc(pr)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Qc(Fe)})]},O)})})]})})]})}),a.jsx(uo,{value:"impostos",children:a.jsx("div",{className:"space-y-3",children:Me.itens.map((T,O)=>a.jsxs("div",{className:"border border-border rounded-md p-2 cursor-pointer",onClick:Fn(O),children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"text-sm font-medium truncate",children:["Item ",O+1,": ",T.codigo?`${T.codigo} - `:"",T.descricao||""]}),a.jsxs("div",{className:"text-xs text-text-secondary flex gap-3",children:[a.jsxs("span",{children:["ICMS ",T.impostos?.icms?.cst||T.impostos?.icms?.csosn||"","/",T.impostos?.icms?.aliquota||"","%"]}),a.jsxs("span",{children:["PIS ",T.impostos?.pis?.cst||"","/",T.impostos?.pis?.aliquota||"","%"]}),a.jsxs("span",{children:["COFINS ",T.impostos?.cofins?.cst||"","/",T.impostos?.cofins?.aliquota||"","%"]}),a.jsxs("span",{children:["FCP ",T.impostos?.fcp?.aliquota||"","%"]}),a.jsxs("span",{children:["IPI ",T.impostos?.ipi?.cst||"","/",T.impostos?.ipi?.aliquota||"","%"]}),a.jsx("span",{children:`Total R$ ${Qc((Er(T.preco_unitario)||0)*(Er(T.quantidade)||1)-(Er(T.desconto_percent)?(Er(T.preco_unitario)||0)*(Er(T.quantidade)||1)*(Er(T.desconto_percent)||0)/100:Er(T.desconto_valor)||0)+(Er(T.acrescimos_valor)||0)+(Er(T.frete_valor)||0)+(Er(T.seguro_valor)||0))}`})]})]}),Dt===O&&a.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Origem"}),a.jsx(Je,{value:T.impostos?.origem||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,origem:X.target.value}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ICMS CST"}),a.jsx(Je,{value:T.impostos?.icms?.cst||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,cst:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"CSOSN"}),a.jsx(Je,{value:T.impostos?.icms?.csosn||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,csosn:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Base ICMS"}),a.jsx(Je,{value:T.impostos?.icms?.base||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,base:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Alquota ICMS (%)"}),a.jsx(Je,{value:T.impostos?.icms?.aliquota||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,aliquota:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Valor ICMS"}),a.jsx(Je,{value:T.impostos?.icms?.valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Base ICMS-ST"}),a.jsx(Je,{value:T.impostos?.icmsst?.base||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icmsst:{...L[O].impostos.icmsst,base:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Alquota ICMS-ST (%)"}),a.jsx(Je,{value:T.impostos?.icmsst?.aliquota||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icmsst:{...L[O].impostos.icmsst,aliquota:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Valor ICMS-ST"}),a.jsx(Je,{value:T.impostos?.icmsst?.valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icmsst:{...L[O].impostos.icmsst,valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"FCP Base"}),a.jsx(Je,{value:T.impostos?.fcp?.base||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,fcp:{...L[O].impostos.fcp,base:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"FCP Alquota (%)"}),a.jsx(Je,{value:T.impostos?.fcp?.aliquota||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,fcp:{...L[O].impostos.fcp,aliquota:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"FCP Valor"}),a.jsx(Je,{value:T.impostos?.fcp?.valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,fcp:{...L[O].impostos.fcp,valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"FCP-ST Base"}),a.jsx(Je,{value:T.impostos?.fcpst?.base||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,fcpst:{...L[O].impostos.fcpst,base:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"FCP-ST Alquota (%)"}),a.jsx(Je,{value:T.impostos?.fcpst?.aliquota||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,fcpst:{...L[O].impostos.fcpst,aliquota:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"FCP-ST Valor"}),a.jsx(Je,{value:T.impostos?.fcpst?.valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,fcpst:{...L[O].impostos.fcpst,valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ICMS Desonerado (R$)"}),a.jsx(Je,{value:T.impostos?.icms?.desonerado_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,desonerado_valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Motivo da Desonerao"}),a.jsx(Je,{value:T.impostos?.icms?.desoneracao_motivo||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,desoneracao_motivo:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ICMS Operao (R$)"}),a.jsx(Je,{value:T.impostos?.icms?.operacao_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,operacao_valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Alquota Diferimento (%)"}),a.jsx(Je,{value:T.impostos?.icms?.aliq_diferimento||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,aliq_diferimento:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Valor ICMS Diferido"}),a.jsx(Je,{value:T.impostos?.icms?.valor_diferido||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,valor_diferido:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"PIS CST"}),a.jsx(Je,{value:T.impostos?.pis?.cst||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,pis:{...L[O].impostos.pis,cst:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"PIS Alquota (%)"}),a.jsx(Je,{value:T.impostos?.pis?.aliquota||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,pis:{...L[O].impostos.pis,aliquota:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"PIS Valor"}),a.jsx(Je,{value:T.impostos?.pis?.valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,pis:{...L[O].impostos.pis,valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"COFINS CST"}),a.jsx(Je,{value:T.impostos?.cofins?.cst||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,cofins:{...L[O].impostos.cofins,cst:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"COFINS Alquota (%)"}),a.jsx(Je,{value:T.impostos?.cofins?.aliquota||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,cofins:{...L[O].impostos.cofins,aliquota:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"COFINS Valor"}),a.jsx(Je,{value:T.impostos?.cofins?.valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,cofins:{...L[O].impostos.cofins,valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"IPI CST"}),a.jsx(Je,{value:T.impostos?.ipi?.cst||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,ipi:{...L[O].impostos.ipi,cst:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"IPI - Tipo de Clculo"}),a.jsxs(Cn,{value:T.impostos?.ipi?.tipo_calculo||"nenhum",onValueChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,ipi:{...L[O].impostos.ipi,tipo_calculo:X}}},{...G,itens:L}}),children:[a.jsx(jn,{className:"h-8 text-xs"}),a.jsxs(_n,{children:[a.jsx(nt,{value:"aliquota",children:"Alquota"}),a.jsx(nt,{value:"valor_unit",children:"Vl Unit."}),a.jsx(nt,{value:"nenhum",children:"Nenhum"})]})]})]}),(T.impostos?.ipi?.tipo_calculo||"nenhum")==="aliquota"&&a.jsxs("div",{children:[a.jsx(De,{children:"IPI Alquota (%)"}),a.jsx(Je,{value:T.impostos?.ipi?.aliquota||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,ipi:{...L[O].impostos.ipi,aliquota:X.target.value}}},{...G,itens:L}})})]}),(T.impostos?.ipi?.tipo_calculo||"nenhum")==="valor_unit"&&a.jsxs("div",{children:[a.jsx(De,{children:"IPI Valor Unitrio"}),a.jsx(Je,{value:T.impostos?.ipi?.valor_unit||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,ipi:{...L[O].impostos.ipi,valor_unit:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"IPI Valor"}),a.jsx(Je,{value:T.impostos?.ipi?.valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,ipi:{...L[O].impostos.ipi,valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ISS Alquota (%)"}),a.jsx(Je,{value:T.impostos?.iss?.aliquota||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,iss:{...L[O].impostos.iss,aliquota:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ISS Valor"}),a.jsx(Je,{value:T.impostos?.iss?.valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,iss:{...L[O].impostos.iss,valor:X.target.value}}},{...G,itens:L}})})]}),a.jsx("div",{className:"md:col-span-6",children:a.jsxs("details",{children:[a.jsx("summary",{className:"text-xs text-text-secondary cursor-pointer select-none",children:"Impostos 2 (Avanado)"}),a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(De,{children:"AD Rem"}),a.jsx(Je,{value:T.impostos?.icms?.ad_rem||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,ad_rem:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"AD Rem Reteno"}),a.jsx(Je,{value:T.impostos?.icms?.ad_rem_retencao||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,ad_rem_retencao:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"BC Monofsico"}),a.jsx(Je,{value:T.impostos?.icms?.monofasico_bc||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,monofasico_bc:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ICMS Monofsico"}),a.jsx(Je,{value:T.impostos?.icms?.monofasico_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,monofasico_valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"BC Mono Reteno"}),a.jsx(Je,{value:T.impostos?.icms?.mono_retencao_bc||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,mono_retencao_bc:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ICMS Mono Reteno"}),a.jsx(Je,{value:T.impostos?.icms?.mono_retencao_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,mono_retencao_valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"% Reduo"}),a.jsx(Je,{value:T.impostos?.icms?.reducao_percent||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,reducao_percent:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Motivo da Reduo"}),a.jsx(Je,{value:T.impostos?.icms?.reducao_motivo||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,reducao_motivo:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"BC Mono Cobrado Ant."}),a.jsx(Je,{value:T.impostos?.icms?.mono_cobrado_ant_bc||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,mono_cobrado_ant_bc:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ICMS Mono Cobrado Ant."}),a.jsx(Je,{value:T.impostos?.icms?.mono_cobrado_ant_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,mono_cobrado_ant_valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"ICMS Prprio Devido"}),a.jsx(Je,{value:T.impostos?.icms?.proprio_devido_valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,icms:{...L[O].impostos.icms,proprio_devido_valor:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-6 border-t border-border/40 pt-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Grupo indicador da origem do combustvel"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(De,{children:"UF"}),a.jsx(Je,{value:T.impostos?.combustivel?.uf||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,combustivel:{...L[O].impostos.combustivel,uf:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"% origem UF"}),a.jsx(Je,{value:T.impostos?.combustivel?.perc_origem_uf||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,combustivel:{...L[O].impostos.combustivel,perc_origem_uf:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{children:"Indicador de importao"}),a.jsx(Je,{value:T.impostos?.combustivel?.indicador_importacao||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,combustivel:{...L[O].impostos.combustivel,indicador_importacao:X.target.value}}},{...G,itens:L}})})]})]})]}),a.jsxs("div",{className:"md:col-span-6 border-t border-border/40 pt-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"CIDE"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Aliq. CIDE"}),a.jsx(Je,{value:T.impostos?.cide?.aliq||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,cide:{...L[O].impostos.cide,aliq:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"BC CIDE"}),a.jsx(Je,{value:T.impostos?.cide?.base||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,cide:{...L[O].impostos.cide,base:X.target.value}}},{...G,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Vl. CIDE"}),a.jsx(Je,{value:T.impostos?.cide?.valor||"",onChange:X=>$e(G=>{const L=[...G.itens];return L[O]={...L[O],impostos:{...L[O].impostos,cide:{...L[O].impostos.cide,valor:X.target.value}}},{...G,itens:L}})})]})]})]})]})]})})]})]},O))})}),a.jsx(uo,{value:"totais",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Desconto Geral (R$)"}),a.jsx(Je,{value:Me.totais.desconto_geral,onChange:T=>$e(O=>({...O,totais:{...O.totais,desconto_geral:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Frete (R$)"}),a.jsx(Je,{value:Me.totais.frete,onChange:T=>$e(O=>({...O,totais:{...O.totais,frete:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Outras Despesas (R$)"}),a.jsx(Je,{value:Me.totais.outras_despesas,onChange:T=>$e(O=>({...O,totais:{...O.totais,outras_despesas:T.target.value}}))})]}),a.jsxs("div",{className:"mt-6 text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:"Total itens: "}),Qc(Me.itens.reduce((T,O)=>{const X=Er(O.preco_unitario),G=Er(O.quantidade)||1,L=Er(O.desconto_percent)||0,Re=Er(O.desconto_valor)||0,rt=Er(O.acrescimos_valor)||0,lt=X*G,$t=L?lt*L/100:Re;return T+(lt-$t+rt)},0))]})]})}),a.jsx(uo,{value:"pagamento",children:a.jsxs("div",{className:"space-y-3",children:[Me.pagamentos.map((T,O)=>a.jsxs("div",{className:"grid grid-cols-1 gap-2 items-end md:[grid-template-columns:2fr_1fr_1fr_1fr_auto]",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Finalizadora"}),a.jsxs(Cn,{value:T.finalizadora_id||"",onValueChange:X=>$e(G=>{const L=[...G.pagamentos],Re=(gt||[]).find(rt=>String(rt.id)===String(X));return L[O]={...L[O],finalizadora_id:X,tipo:Re?.nome||L[O].tipo},{...G,pagamentos:L}}),children:[a.jsx(jn,{className:"h-9",children:a.jsx(An,{placeholder:gt.length?"Selecionar":"Carregando"})}),a.jsx(_n,{children:gt.map(X=>a.jsx(nt,{value:X.id,children:`${X?.codigo_interno!=null&&String(X.codigo_interno).trim()!==""?String(X.codigo_interno).padStart(2,"0")+" - ":""}${X?.nome||""}`},X.id))})]})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Valor"}),a.jsx(Je,{className:"h-9",inputMode:"decimal",value:T.valor||"",onChange:X=>$e(G=>{const L=[...G.pagamentos];return L[O]={...L[O],valor:Hn(X.target.value)},{...G,pagamentos:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Parcelas"}),a.jsx(Je,{className:"h-9",inputMode:"numeric",value:T.parcelas||"",onChange:X=>$e(G=>{const L=[...G.pagamentos];return L[O]={...L[O],parcelas:Rr(X.target.value)},{...G,pagamentos:L}})})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Troco"}),a.jsx(Je,{className:"h-9",inputMode:"decimal",value:T.troco||"",onChange:X=>$e(G=>{const L=[...G.pagamentos];return L[O]={...L[O],troco:Hn(X.target.value)},{...G,pagamentos:L}})})]}),a.jsx("div",{className:"flex items-end justify-end",children:a.jsx(ce,{type:"button",size:"icon",variant:"ghost",className:"text-red-500 hover:text-red-600",title:"Remover pagamento",onClick:()=>$e(X=>({...X,pagamentos:X.pagamentos.filter((G,L)=>L!==O)})),children:a.jsx(Bu,{className:"h-4 w-4"})})})]},O)),a.jsx("div",{className:"flex justify-start",children:a.jsx(ce,{size:"sm",variant:"outline",onClick:()=>$e(T=>{const O=(gt||[])[0];return{...T,pagamentos:[...T.pagamentos,{finalizadora_id:O?.id||"",tipo:O?.nome||"Dinheiro",valor:""}]}}),children:"Adicionar pagamento"})})]})}),a.jsx(uo,{value:"transporte",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Tipo do frete"}),a.jsx(Je,{value:Me.transporte.tipo_frete,onChange:T=>$e(O=>({...O,transporte:{...O.transporte,tipo_frete:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Transportadora"}),a.jsx(Je,{value:Me.transporte.transportadora,onChange:T=>$e(O=>({...O,transporte:{...O.transporte,transportadora:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Placa"}),a.jsx(Je,{value:Me.transporte.placa,onChange:T=>$e(O=>({...O,transporte:{...O.transporte,placa:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Volumes"}),a.jsx(Je,{value:Me.transporte.volumes,onChange:T=>$e(O=>({...O,transporte:{...O.transporte,volumes:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Peso lquido"}),a.jsx(Je,{value:Me.transporte.peso_liquido,onChange:T=>$e(O=>({...O,transporte:{...O.transporte,peso_liquido:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Peso bruto"}),a.jsx(Je,{value:Me.transporte.peso_bruto,onChange:T=>$e(O=>({...O,transporte:{...O.transporte,peso_bruto:T.target.value}}))})]})]})}),a.jsx(uo,{value:"adicionais",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Observaes gerais"}),a.jsx(Je,{value:Me.adicionais.obs_gerais,onChange:T=>$e(O=>({...O,adicionais:{...O.adicionais,obs_gerais:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Info para o Fisco"}),a.jsx(Je,{value:Me.adicionais.info_fisco,onChange:T=>$e(O=>({...O,adicionais:{...O.adicionais,info_fisco:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Info para o Cliente"}),a.jsx(Je,{value:Me.adicionais.info_cliente,onChange:T=>$e(O=>({...O,adicionais:{...O.adicionais,info_cliente:T.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Referncia documento"}),a.jsx(Je,{value:Me.adicionais.referencia_doc,onChange:T=>$e(O=>({...O,adicionais:{...O.adicionais,referencia_doc:T.target.value}}))})]})]})}),a.jsx(uo,{value:"rastreabilidade",children:a.jsx("div",{className:"text-sm text-text-secondary",children:"Rastreabilidade de Produtos"})})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(ce,{variant:"outline",onClick:()=>ut(!1),children:"Fechar"}),a.jsx(ce,{onClick:async()=>{try{const T=[],O=Rr(Me.cpf_cnpj);Me.tipo_pessoa==="PF"&&O&&O.length!==11&&T.push("CPF deve ter 11 dgitos"),Me.tipo_pessoa==="PJ"&&O&&O.length!==14&&T.push("CNPJ deve ter 14 dgitos"),Me.nome||T.push("Nome/Razo no informado"),Me.email&&!_r(Me.email)&&T.push("Email invlido"),Me.uf&&Me.uf.length!==2&&T.push("UF deve ter 2 letras"),Me.cep&&Rr(Me.cep).length!==8&&T.push("CEP deve ter 8 dgitos"),Me.codigo_municipio_ibge||T.push("Cdigo IBGE do municpio  obrigatrio");const X=[];if(Me.itens.forEach((Fe,It)=>{Fe.descricao||X.push(`Item ${It+1}: descrio obrigatria`),(!Fe.ncm||Rr(Fe.ncm).length!==8)&&X.push(`Item ${It+1}: NCM deve ter 8 dgitos`),(!Fe.cfop||Rr(Fe.cfop).length!==4)&&X.push(`Item ${It+1}: CFOP deve ter 4 dgitos`),Er(Fe.quantidade)<=0&&X.push(`Item ${It+1}: quantidade deve ser > 0`),Er(Fe.preco_unitario)<=0&&X.push(`Item ${It+1}: preo deve ser > 0`)}),T.push(...X),T.length){r({title:"Pendncias para gerar XML",description:T.join(`
`),variant:"destructive"});return}const G=Me.itens.map(Fe=>{const It=Er(Fe.preco_unitario)||0,Sr=Er(Fe.quantidade)||1,kr=It*Sr,pr=Er(Fe.desconto_percent)||0,yn=Er(Fe.desconto_valor)||0,In=Er(Fe.acrescimos_valor)||0,Xn=pr?kr*pr/100:yn,En=kr-Xn+In;return{preco_unitario:It,quantidade:Sr,preco_total:En,produtos:{nome:Fe.descricao||"Produto",codigo:Fe.codigo||"",ncm:Fe.ncm||"",cfopInterno:Fe.cfop||"5102"}}}),Re=G.reduce((Fe,It)=>Fe+(Number(It.preco_total)||0),0)-(Er(Me.totais.desconto_geral)||0)+(Er(Me.totais.frete)||0)+(Er(Me.totais.outras_despesas)||0),rt={tipo_pessoa:Me.tipo_pessoa,cpf_cnpj:Rr(Me.cpf_cnpj),nome:Me.nome,email:Me.email,logradouro:Me.logradouro,numero:Me.numero,bairro:Me.bairro,cidade:Me.cidade,uf:Me.uf,cep:Rr(Me.cep),codigo_municipio_ibge:Me.codigo_municipio_ibge,inscricao_estadual:Me.ie_isento?"ISENTO":Me.inscricao_estadual,telefone:Me.telefone},lt=Me.pagamentos&&Me.pagamentos.length?Me.pagamentos.map(Fe=>({finalizadoras:{codigo_sefaz:(gt||[]).find(kr=>String(kr.id)===String(Fe.finalizadora_id))?.codigo_sefaz||"99"},valor:Er(Fe.valor)||0})):[{finalizadoras:{codigo_sefaz:"99"},valor:Re}],$t=await Dit({codigoEmpresa:t,cliente:rt,itens:G,pagamentos:lt,modelo:"55",overrides:{natOp:Me.natOp,serie:Me.serie,nNF:Me.nNF,indFinal:Me.indFinal,indPres:Me.indPres,idDest:Me.idDest,tpNF:Me.tipo_nota==="entrada"?"0":"1"}});Nt($t),br(!0),r({title:"XML NF-e gerado"})}catch(T){r({title:"Falha ao gerar XML",description:T.message,variant:"destructive"})}},children:"Gerar XML"})]}),!1]})}),a.jsx(xn,{open:Yt,onOpenChange:br,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[800px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"XML gerado"}),a.jsx(On,{children:"Faa o download ou salve no Supabase."})]}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Prvia do XML"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{size:"sm",variant:"outline",onClick:()=>eV(`nfe-manual-${Date.now()}.xml`,Rt),children:"Baixar XML"}),a.jsx(ce,{size:"sm",onClick:async()=>{try{he(!0);const T=`nfe/${t}/manual-${Date.now()}.xml`,O=new Blob([Rt],{type:"text/xml;charset=utf-8"}),{error:X}=await fe.storage.from("fiscal").upload(T,O,{contentType:"text/xml"});if(X)throw X;r({title:"XML salvo no Supabase"})}catch(T){r({title:"Falha ao salvar",description:T.message,variant:"destructive"})}finally{he(!1)}},disabled:tt,children:tt?"Salvando...":"Salvar no Supabase"})]})]}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto border border-border rounded p-2 bg-surface-2",children:Rt})]})}),a.jsx(xn,{open:Ne,onOpenChange:Z,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[680px] md:max-w-[860px] lg:max-w-[900px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Emisso NF-e (XML offline)"}),a.jsx(On,{children:"Preencha os campos abaixo e gere o XML da NF-e. Transmisso para SEFAZ ficar para a prxima etapa."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{children:"Natureza da Operao (natOp)"}),a.jsx(Je,{value:ae.natOp,onChange:T=>ie(O=>({...O,natOp:T.target.value})),placeholder:"VENDA"})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Srie"}),a.jsx(Je,{value:ae.serie,onChange:T=>ie(O=>({...O,serie:T.target.value}))})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Nmero (nNF)"}),a.jsx(Je,{value:ae.nNF,onChange:T=>ie(O=>({...O,nNF:T.target.value})),placeholder:"(opcional)"})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Destino da Operao (idDest)"}),a.jsxs(Cn,{value:ae.idDest||"",onValueChange:T=>ie(O=>({...O,idDest:T})),children:[a.jsx(jn,{children:a.jsx(An,{placeholder:"Automtico"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"",children:"Automtico"}),a.jsx(nt,{value:"1",children:"Interna (mesmo estado)"}),a.jsx(nt,{value:"2",children:"Interestadual"}),a.jsx(nt,{value:"3",children:"Exterior"})]})]})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Consumidor Final (indFinal)"}),a.jsxs(Cn,{value:ae.indFinal,onValueChange:T=>ie(O=>({...O,indFinal:T})),children:[a.jsx(jn,{children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"1",children:"Sim"}),a.jsx(nt,{value:"0",children:"No"})]})]})]}),a.jsxs("div",{children:[a.jsx(De,{children:"Presena do Comprador (indPres)"}),a.jsxs(Cn,{value:ae.indPres,onValueChange:T=>ie(O=>({...O,indPres:T})),children:[a.jsx(jn,{children:a.jsx(An,{})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"1",children:"Operao presencial"}),a.jsx(nt,{value:"2",children:"No presencial, internet"}),a.jsx(nt,{value:"4",children:"Entrega em domiclio"}),a.jsx(nt,{value:"9",children:"No se aplica"})]})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(ce,{variant:"outline",onClick:()=>Z(!1),children:"Fechar"}),a.jsx(ce,{onClick:Nn,disabled:ge,children:ge?"Gerando...":"Gerar XML"})]}),se&&a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Prvia do XML Gerado"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ce,{size:"sm",variant:"outline",onClick:()=>eV(`nfe-${de||"doc"}.xml`,se),children:"Baixar XML"}),a.jsx(ce,{size:"sm",onClick:re,disabled:dt,children:dt?"Salvando...":"Salvar no Supabase"})]})]}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto border border-border rounded p-2 bg-surface-2",children:se})]})]})})]})}function eV(e,t){try{const r=new Blob([t],{type:"text/xml;charset=utf-8"}),n=URL.createObjectURL(r),o=document.createElement("a");o.href=n,o.download=e,document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(n)}catch{}}const Fit=(e,t,r)=>e.split(/(\*\*.*?\*\*)/g).map((o,s)=>{if(o.startsWith("**")&&o.endsWith("**")){const i=o.slice(2,-2);return a.jsx("strong",{className:`font-black ${t?r?"text-white":"text-[#000000]":"text-white"}`,style:{fontWeight:900,textShadow:t?r?"0 0 1px rgba(0,0,0,0.25)":"0 0 1px rgba(0,0,0,0.3)":"0 0 1px rgba(255,255,255,0.5)"},children:i},s)}return o}),rse=({message:e})=>{const t=e.from==="isis",r=t&&e?.color==="green",n=t&&e?.color==="system",[o,s]=p.useState(!1),{selections:i}=Z4(),{clientIdentified:l,userInitial:c}=p.useMemo(()=>{const u=i?.contato?.nome||i?.cliente?.nome||"",f=String(u).trim(),h=f?f[0]:"",m=h&&/[A-Za-z---]/.test(h)?h.toUpperCase():"U";return{clientIdentified:!!u,userInitial:m}},[i?.contato?.nome,i?.cliente?.nome]),d=async u=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(u);else{const f=document.createElement("textarea");f.value=u,f.style.position="fixed",f.style.top="0",f.style.left="0",f.style.opacity="0",document.body.appendChild(f),f.focus(),f.select(),document.execCommand("copy"),document.body.removeChild(f)}s(!0),setTimeout(()=>s(!1),1800)}catch{}};return a.jsx(Pr.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,ease:[.22,1,.36,1]},className:`flex ${t?"justify-start":"justify-end"} mb-4 md:mb-6`,children:a.jsxs("div",{className:`flex items-end gap-2 md:gap-3 max-w-[90%] md:max-w-[85%] lg:max-w-[75%] ${!t&&"flex-row-reverse"}`,children:[t?a.jsx(xd,{size:"sm",variant:"message",className:"md:w-14 md:h-14"}):l?a.jsx("div",{className:"w-10 h-10 md:w-14 md:h-14 rounded-full flex items-center justify-center flex-shrink-0 bg-brand/10 text-brand ring-2 ring-brand/60",children:a.jsx("span",{className:"font-extrabold text-base md:text-lg leading-none select-none",children:c})}):a.jsx("div",{className:"w-10 h-10 md:w-14 md:h-14 rounded-full flex items-center justify-center flex-shrink-0 bg-surface border border-white/10 text-text-muted",children:a.jsx(Ou,{className:"w-5 h-5 md:w-6 md:h-6"})}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:`relative px-3 py-2.5 md:px-5 md:py-3.5 backdrop-blur-sm transition-all duration-300 ${t?r?"bg-emerald-600/90 border border-emerald-400 text-white rounded-2xl rounded-bl-sm shadow-lg shadow-emerald-600/30":n?"bg-surface/70 border border-white/10 text-text-muted rounded-2xl rounded-bl-sm":"bg-brand border border-brand text-[#0A0A0A] rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20":"bg-surface/70 border border-white/10 text-text-primary rounded-2xl rounded-br-sm"}`,children:[a.jsx("p",{className:"text-[15px] md:text-[15px] font-bold leading-relaxed whitespace-pre-wrap tracking-wide relative",children:Fit(e.text,t,r)}),e.copyable&&a.jsx("button",{type:"button",onClick:()=>d(e.copyText||(typeof e.text=="string"?e.text:"")),className:`absolute right-2 bottom-2 p-1.5 md:p-2 rounded-full border shadow-sm transition ${t?"bg-white/80 border-white/40 text-[#0A0A0A] hover:bg-white":"bg-white/10 border-white/10 text-text-primary hover:bg-white/20"}`,"aria-label":"Copiar texto",children:o?a.jsx(zf,{className:"w-4 h-4"}):a.jsx(FH,{className:"w-4 h-4"})})]}),a.jsx("p",{className:`text-[10px] md:text-[10px] text-text-muted px-2 ${t?"text-left":"text-right"}`,children:dr(e.timestamp,"HH:mm")})]})]})})};function $it(){const[e,t]=p.useState([]),[r,n]=p.useState(""),[o,s]=p.useState(!1),[i,l]=p.useState(""),[c,d]=p.useState(!0),u=p.useRef(null),{company:f,userProfile:h,user:m}=So();p.useEffect(()=>{const b={id:Date.now()+Math.random(),from:"isis",text:"Ol! Eu sou a verso Premium da sis, integrada  OpenAI. Em que posso ajudar? ",timestamp:new Date};t([b])},[]),p.useEffect(()=>{const b=setTimeout(()=>{u.current?.scrollIntoView({behavior:"smooth",block:"end"})},100);return()=>clearTimeout(b)},[e,o]);const v=b=>{t(w=>[...w,{id:Date.now()+Math.random(),timestamp:new Date,...b}])},g=b=>{const w=String(b||"").toLowerCase();return w?w.includes("agend")||w.includes("agenda")?w.includes("hoje")?"Consultando os agendamentos de hoje...":w.includes("amanh")?"Consultando os agendamentos de amanh...":"Consultando seus agendamentos...":w.includes("cliente")?"Buscando informaes de clientes...":w.includes("caixa")||w.includes("faturamento")||w.includes("financeiro")||w.includes("venda")||w.includes("pagamento")?"Analisando movimentaes da sua arena...":w.includes("quadra")||w.includes("reserva")?"Verificando horrios e quadras disponveis...":"...":"..."},y=async(b,w)=>{try{const j=f?.codigoEmpresa||f?.codigo_empresa||null,_=h?.id||m?.id||null,C=h?.nome||m?.email||null,E=h?.cargo||null,A=new Date,P=new Date(A.getFullYear(),A.getMonth(),A.getDate(),0,0,0,0),F=new Date(P);F.setDate(F.getDate()+1);const M=P.toISOString(),I=F.toISOString(),R=Array.isArray(w)?w.map(q=>({role:q.from==="isis"?"assistant":"user",content:q.text})):[],{data:D,error:U}=await fe.functions.invoke("chat-proxy",{body:{message:b,empresaCodigo:j,usuarioId:_,usuarioNome:C,usuarioCargo:E,data_inicio:M,data_fim:I,history:R}});if(U)throw U;const z=typeof D?.reply=="string"&&D.reply.trim().length>0?D.reply:"Certo! (resposta provisria)";let H=Array.isArray(D?.replies)?D.replies.filter(q=>typeof q=="string"&&q.trim().length>0):[];if(H.length===0&&(H=[z]),console.log("[sis][response]",{replies:H,raw:D}),D)try{console.log("[sis][response raw JSON]",JSON.stringify(D,null,2))}catch{}for(let q=0;q<H.length;q++){const Q=H[q];v({from:"isis",text:Q}),q<H.length-1&&await new Promise(pe=>setTimeout(pe,600))}s(!1),l("")}catch{v({from:"isis",text:"No momento, estou operando em modo de demonstrao. Em breve estarei 100% conectada  OpenAI aqui na aba Premium! "}),s(!1),l("")}},x=async b=>{b.preventDefault();const w=r.trim();if(!w)return;const j=[...e];console.log("[sis][question]",{message:w}),v({from:"user",text:w}),n(""),s(!0),l(g(w)),await y(w,j)};return a.jsxs("div",{className:"flex h-full w-full relative",children:[a.jsxs("div",{className:"flex-1 flex flex-col pointer-events-none",children:[a.jsxs("div",{className:"flex-1 overflow-y-auto px-3 md:px-6 py-4 md:py-6",children:[e.map(b=>a.jsx(rse,{message:b},b.id)),o&&a.jsx(Pr.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start mb-4",children:a.jsx("div",{className:"px-4 py-2 rounded-2xl bg-brand border border-brand text-[#0A0A0A] flex items-center gap-2 animate-pulse",children:i&&i!=="..."?a.jsxs(a.Fragment,{children:[a.jsx("span",{role:"img","aria-label":"pensando",children:""}),a.jsx("span",{children:i})]}):a.jsx("span",{className:"font-semibold tracking-widest",children:"..."})})}),a.jsx("div",{ref:u})]}),a.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:a.jsxs("form",{onSubmit:x,className:"flex items-center gap-2 bg-surface/70 border border-white/10 rounded-xl px-3 py-2.5",children:[a.jsx(RH,{className:"w-5 h-5 text-text-muted"}),a.jsx("input",{value:r,onChange:b=>n(b.target.value),placeholder:"Escreva aqui",className:"flex-1 bg-transparent outline-none text-sm"}),a.jsxs("button",{type:"submit",disabled:!r.trim(),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-semibold transition ${r.trim()?"bg-brand text-bg":"bg-surface/40 text-text-muted cursor-not-allowed"}`,children:[a.jsx(d4,{className:"w-4 h-4"}),"Enviar"]})]})})]}),c&&a.jsx("div",{className:"absolute inset-0 z-10 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto rounded-lg overflow-hidden",children:a.jsx(Pr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},transition:{duration:.5,ease:[.22,1,.36,1]},className:"rounded-2xl border border-white/30 bg-gradient-to-br from-slate-900 via-slate-900 to-slate-800 shadow-2xl max-w-sm w-full text-center mx-4 overflow-hidden",children:a.jsxs("div",{className:"px-8 py-10",children:[a.jsx(Pr.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.2,duration:.4},className:"flex items-center justify-center mb-8",children:a.jsx("div",{className:"w-24 h-24 rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_20px_rgba(168,85,247,0.5)] overflow-hidden",children:a.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-background flex items-center justify-center",children:a.jsx(xd,{size:"lg"})})})}),a.jsxs(Pr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},children:[a.jsx("div",{className:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300 mb-4",children:"sis"}),a.jsx("p",{className:"text-sm text-gray-300 mb-6 leading-relaxed",children:"Em breve sua assistente IA vai estar pronta para revolucionar a gesto da sua arena. "}),a.jsxs("div",{className:"space-y-3 text-left",children:[a.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[a.jsx("span",{className:"text-emerald-400 font-bold mt-0.5",children:""}),a.jsx("span",{children:"Gerencie agendamentos com inteligncia artificial"})]}),a.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[a.jsx("span",{className:"text-violet-400 font-bold mt-0.5",children:""}),a.jsx("span",{children:"Otimize sua agenda e maximize ocupao"})]}),a.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[a.jsx("span",{className:"text-fuchsia-400 font-bold mt-0.5",children:""}),a.jsx("span",{children:"Insights inteligentes sobre sua arena"})]})]})]})]})})})]})}function Bit({open:e,onOpenChange:t,codigoEmpresa:r,onSuccess:n}){const{toast:o}=no(),[s,i]=p.useState("upload"),[l,c]=p.useState(null),[d,u]=p.useState(null),[f,h]=p.useState(!1),[m,v]=p.useState({success:!1,comandaId:null,error:null}),g=async j=>{const _=j.target.files?.[0];if(_){if(!_.name.endsWith(".xml")){o({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}c(_);try{const C=await _.text(),E=CS(C);if(!E.success){o({title:"Erro ao ler XML",description:E.error||"XML invlido",variant:"destructive"});return}if(!E.produtos||E.produtos.length===0){o({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(E.nfe?.tipo!=="Sada"){o({title:"Tipo de nota incorreto",description:"Este XML  de entrada. Use a importao em Produtos para notas de entrada.",variant:"warning"});return}u(E),i("preview")}catch(C){console.error("[XMLSalesImport] Erro ao processar arquivo:",C),o({title:"Erro ao processar XML",description:C.message,variant:"destructive"})}}},y=async()=>{i("processing"),h(!0);try{const j=await fu({searchTerm:"",limit:1e4,codigoEmpresa:r}),_=d.nfe?.dataEmissao?new Date(d.nfe.dataEmissao):new Date,C=d.nfe?.chaveAcesso||"",{data:E,error:A}=await fe.from("comandas").insert({codigo_empresa:r,mesa_id:null,status:"closed",aberto_em:_.toISOString(),fechado_em:_.toISOString(),observacao:`Importado de XML - NF-e ${d.nfe?.numero||""}${C?`
Chave: ${C}`:""}`,origem:"xml",xml_chave:C||null}).select().single();if(A)throw A;const P=[],F=[];for(const I of d.produtos){const R=PS(I,j);if(R){P.push({comanda_id:E.id,produto_id:R.id,descricao:I.nome,quantidade:I.quantidade,preco_unitario:I.valorUnitario,desconto:I.desconto||0,codigo_empresa:r});const D=Math.max(0,(R.stock||R.estoque||0)-I.quantidade);await fe.from("produtos").update({estoque:D}).eq("id",R.id).eq("codigo_empresa",r)}else F.push(I.nome)}if(P.length>0){const{error:I}=await fe.from("comanda_itens").insert(P);if(I)throw I}const M=d.pagamentos||[];if(M.length>0){const{data:I}=await fe.from("finalizadoras").select("id, codigo_sefaz, nome").eq("codigo_empresa",r).eq("ativo",!0),R=new Map((I||[]).map(z=>[z.codigo_sefaz,z])),D=M.map(z=>{const H=R.get(z.codigoSefaz);return{comanda_id:E.id,finalizadora_id:H?.id||null,metodo:z.descricao.toLowerCase(),valor:z.valor,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:C||null}}),{error:U}=await fe.from("pagamentos").insert(D);if(U)throw U}else{const I=d.produtos.reduce((D,U)=>D+(U.valorTotal||0),0),{error:R}=await fe.from("pagamentos").insert({comanda_id:E.id,finalizadora_id:null,metodo:"outros",valor:I,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:C||null});if(R)throw R}console.log("[XMLSalesImport] Venda importada com sucesso. Comanda ID:",E.id),F.length>0?o({title:"Venda importada com avisos",description:`${P.length} produto(s) registrado(s), ${F.length} no encontrado(s).`,variant:"warning",duration:5e3}):o({title:"Venda importada com sucesso!",description:`${P.length} produto(s) registrado(s). Total: R$ ${w.toFixed(2)}`,variant:"success"}),v({success:!0,comandaId:E.id,error:null,produtosNaoEncontrados:F,totalItens:P.length,totalVenda:w,dataEmissao:_.toISOString().slice(0,10)}),i("done"),n&&n(_.toISOString().slice(0,10))}catch(j){console.error("[XMLSalesImport] Erro ao importar:",j),v({success:!1,comandaId:null,error:j.message}),i("done"),o({title:"Erro ao importar XML",description:j.message,variant:"destructive"})}finally{h(!1)}},x=()=>{i("upload"),c(null),u(null),v({success:!1,comandaId:null,error:null}),t(!1)},b=()=>{i("upload"),c(null),u(null)},w=d?.produtos?.reduce((j,_)=>j+(_.valorTotal||0),0)||0;return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"max-w-3xl max-h-[90vh] flex flex-col overflow-hidden",children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-2xl font-bold",children:"Importar XML de Venda (NF-e)"}),a.jsxs(On,{children:[s==="upload"&&"Selecione o arquivo XML da nota fiscal de sada",s==="preview"&&"Revise os dados da venda que ser importada",s==="processing"&&"Processando venda...",s==="done"&&"Importao finalizada"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-1",children:[s==="upload"&&a.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("label",{htmlFor:"xml-sales-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[a.jsx(f4,{className:"w-12 h-12 mb-4 text-text-muted"}),a.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),a.jsx("p",{className:"text-xs text-text-muted",children:"XML de NF-e de Sada (Venda)"})]}),a.jsx("input",{id:"xml-sales-upload",type:"file",accept:".xml",className:"hidden",onChange:g})]}),l&&a.jsxs("div",{className:"mt-4 p-3 bg-surface-2 rounded-lg flex items-center gap-2",children:[a.jsx(Gs,{className:"w-5 h-5 text-success"}),a.jsx("span",{className:"text-sm text-text-primary",children:l.name})]})]})}),s==="preview"&&a.jsxs("div",{className:"space-y-4",children:[d?.nfe&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Informaes da NF-e"}),d.fornecedor&&a.jsxs("div",{className:"mb-3 pb-3 border-b border-border",children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary mb-1",children:d.fornecedor.razaoSocial||d.fornecedor.nomeFantasia||"Fornecedor"}),a.jsxs("div",{className:"text-xs text-text-muted",children:[d.fornecedor.cnpj&&`CNPJ: ${d.fornecedor.cnpj}`,d.fornecedor.endereco?.cidade&&d.fornecedor.endereco?.uf&&`  ${d.fornecedor.endereco.cidade}/${d.fornecedor.endereco.uf}`]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",a.jsx("span",{className:"font-mono",children:d.nfe.numero})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",a.jsx("span",{className:"font-mono",children:d.nfe.serie})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",a.jsx("span",{className:"text-warning font-semibold",children:d.nfe.tipo})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Data:"})," ",a.jsx("span",{children:new Date(d.nfe.dataEmissao).toLocaleDateString("pt-BR")})]})]}),d.nfe.naturezaOperacao&&a.jsxs("div",{className:"mb-2 text-sm",children:[a.jsx("span",{className:"text-text-muted",children:"Natureza:"})," ",a.jsx("span",{className:"font-medium",children:d.nfe.naturezaOperacao})]}),d.nfe.totalNota!==void 0&&a.jsxs("div",{className:"mb-3 text-sm",children:[a.jsx("span",{className:"text-text-muted",children:"Total da Nota:"})," ",a.jsxs("span",{className:"font-mono font-semibold text-lg text-success",children:["R$ ",d.nfe.totalNota.toFixed(2)]})]}),d.nfe.chaveAcesso&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[a.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),a.jsx("p",{className:"font-mono text-xs break-all",children:d.nfe.chaveAcesso})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("h3",{className:"font-semibold mb-3",children:["Produtos da Venda (",d.produtos.length,")"]}),a.jsx("div",{className:"space-y-2",children:d.produtos.map((j,_)=>a.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-start gap-3",children:[a.jsx(a1,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm truncate",children:j.nome}),a.jsxs("p",{className:"text-xs text-text-muted",children:[j.codigo&&`Cdigo: ${j.codigo}  `,"Qtd: ",j.quantidade," ",j.unidade]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valorTotal.toFixed(2)]}),a.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: R$ ",j.valorUnitario.toFixed(2)]})]})]})})]},_))})]}),d.pagamentos&&d.pagamentos.length>0&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("h3",{className:"font-semibold mb-3",children:["Formas de Pagamento (",d.pagamentos.length,")"]}),a.jsx("div",{className:"space-y-2",children:d.pagamentos.map((j,_)=>a.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-sm",children:j.descricao}),a.jsxs("p",{className:"text-xs text-text-muted",children:["Cdigo SEFAZ: ",j.codigoSefaz]})]}),a.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valor.toFixed(2)]})]},_))})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Ac,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm mb-1",children:"Ateno: Venda Externa"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Esta venda ser registrada no histrico como uma venda externa (importada de XML). O estoque dos produtos ser subtrado automaticamente."})]})]})}),a.jsxs("div",{className:"flex items-center justify-between text-lg font-bold",children:[a.jsx("span",{children:"Total da Venda:"}),a.jsxs("span",{className:"text-success",children:["R$ ",w.toFixed(2)]})]})]}),s==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(zm,{className:"w-12 h-12 animate-spin text-warning mb-4"}),a.jsx("p",{className:"text-lg font-semibold",children:"Processando venda..."}),a.jsx("p",{className:"text-sm text-text-muted",children:"Criando comanda e atualizando estoque"})]}),s==="done"&&a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:m.success?a.jsxs(a.Fragment,{children:[a.jsx(Ds,{className:"w-16 h-16 text-success mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Venda Importada com Sucesso!"}),a.jsx("p",{className:"text-sm text-text-muted mb-4",children:"A venda foi registrada no histrico"}),m.produtosNaoEncontrados&&m.produtosNaoEncontrados.length>0&&a.jsxs("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-3 text-left",children:[a.jsx("p",{className:"text-sm font-semibold mb-2",children:" Produtos no encontrados:"}),a.jsx("ul",{className:"text-xs text-text-muted space-y-1",children:m.produtosNaoEncontrados.map((j,_)=>a.jsxs("li",{children:[" ",j]},_))})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(Ac,{className:"w-16 h-16 text-danger mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Erro na Importao"}),a.jsx("p",{className:"text-sm text-text-muted",children:m.error||"Ocorreu um erro ao importar a venda"})]})})})]}),a.jsxs(ra,{children:[s==="upload"&&a.jsx(ce,{variant:"outline",onClick:x,children:"Cancelar"}),s==="preview"&&a.jsxs(a.Fragment,{children:[a.jsx(ce,{variant:"outline",onClick:b,children:"Voltar"}),a.jsx(ce,{onClick:y,children:"Confirmar Importao"})]}),s==="done"&&a.jsx(ce,{onClick:x,children:"Fechar"})]})]})})}const qit={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},by={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function zit(e,t=300){const[r,n]=p.useState(e);return p.useEffect(()=>{const o=setTimeout(()=>n(e),t);return()=>clearTimeout(o)},[e,t]),r}function _j({value:e,onChange:t}){const[r,n]=p.useState(!1),o=p.useRef(null),s=p.useRef(null),i=p.useRef(null),[l,c]=p.useState({top:0,left:0,width:0,center:!1,mode:"fixed"});p.useEffect(()=>{function g(b){const w=b.target,j=o.current&&o.current.contains(w),_=i.current&&i.current.contains(w);!j&&!_&&n(!1)}function y(b){b.key==="Escape"&&n(!1)}function x(){r&&d()}return window.addEventListener("mousedown",g),window.addEventListener("keydown",y),window.addEventListener("scroll",x,!0),window.addEventListener("resize",x),()=>{window.removeEventListener("mousedown",g),window.removeEventListener("keydown",y),window.removeEventListener("scroll",x,!0),window.removeEventListener("resize",x)}},[r]),p.useEffect(()=>{if(r){const g=requestAnimationFrame(()=>{d();const y=requestAnimationFrame(()=>d());return()=>cancelAnimationFrame(y)});return()=>cancelAnimationFrame(g)}},[r]),p.useEffect(()=>{if(r&&l.mode==="overlay"){const g=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=g}}},[r,l.mode]);const d=()=>{try{const g=s.current;if(!g)return;const y=g.getBoundingClientRect(),x=window.innerWidth,b=window.innerHeight,w=8,j=Math.max(y.width,280),_=Math.min(x-w*2,360),C=Math.min(j,_);let E=320;if(i.current)try{E=i.current.getBoundingClientRect().height||E}catch{}if(x<=640){c({top:0,left:0,width:Math.min(x-w*2,360),center:!0,mode:"overlay"});return}const A=o.current,P=A?A.getBoundingClientRect():y,F=y.bottom-P.top+6,M=Math.max(y.width,280);c({top:F,left:0,width:M,center:!1,mode:"anchor"})}catch{}},u=g=>{try{const[y,x,b]=String(g||"").split("-").map(Number);return!y||!x||!b?null:new Date(y,x-1,b)}catch{return null}},f=g=>{const y=x=>String(x).padStart(2,"0");return`${g.getFullYear()}-${y(g.getMonth()+1)}-${y(g.getDate())}`},h=g=>{const y=x=>String(x).padStart(2,"0");return`${y(g.getDate())}/${y(g.getMonth()+1)}/${g.getFullYear()}`},m=u(e),v=m?h(m):"";return a.jsxs("div",{className:"relative",ref:o,children:[a.jsx("button",{type:"button",className:"absolute left-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-warning/10 focus:outline-none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},"aria-label":"Abrir calendrio",children:a.jsx(pue,{className:"h-4 w-4 text-warning"})}),typeof window<"u"&&window.innerWidth<=640?a.jsx("button",{type:"button",ref:s,onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(!0),setTimeout(d,0)},className:"pl-9 pr-3 h-10 w-full text-left bg-surface text-text-primary border border-warning/40 rounded-md",children:v||"Selecionar data"}):a.jsx(Je,{type:"text",readOnly:!0,ref:s,inputMode:"none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},className:"pl-9 pr-3 w-full bg-surface text-text-primary border border-warning/40 focus-visible:ring-warning focus-visible:border-warning",value:v}),r&&(l.mode==="overlay"?a.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",onClick:g=>{g.target===g.currentTarget&&n(!1)},children:a.jsx("div",{ref:i,className:"bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 w-[92vw] max-w-[360px]",children:a.jsx(Gl,{mode:"single",selected:m||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})})}):l.mode==="anchor"?a.jsx("div",{ref:i,className:"absolute z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 left-0",style:{top:`${l.top}px`,minWidth:`${l.width}px`,maxWidth:"92vw"},children:a.jsx(Gl,{mode:"single",selected:m||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}):a.jsx("div",{ref:i,className:"fixed z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2",style:{top:`${l.top}px`,left:`${l.left}px`,width:`${l.width}px`,maxWidth:"92vw"},children:a.jsx(Gl,{mode:"single",selected:m||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}))]})}function Uit(){const{toast:e}=no(),t=Yi(),{userProfile:r}=So(),[n]=QS(),o=n.get("mesa"),[s,i]=p.useState(!1),[l,c]=p.useState([]),[d,u]=p.useState(()=>o?"":new Date().toISOString().slice(0,10)),[f,h]=p.useState(()=>o?"":new Date().toISOString().slice(0,10)),[m,v]=p.useState(()=>o?"all":"closed"),[g,y]=p.useState(""),x=zit(g,350),[b,w]=p.useState("all"),[j,_]=p.useState("comandas"),[C,E]=p.useState(!1),[A,P]=p.useState(""),[F,M]=p.useState(null),[I,R]=p.useState({loading:!1,itens:[],pagamentos:[]}),[D,U]=p.useState(null),[z,H]=p.useState({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null},movs:[]}),[q,Q]=p.useState(!1),[pe,be]=p.useState(!1),[V,B]=p.useState(null),[J,ue]=p.useState([]),Ne=async Se=>{try{be(!0);const kt=ke();if(!kt)throw new Error("Empresa no detectada");const{payload:Lt,missing:fr}=await gv({comandaId:Se,codigoEmpresa:kt});B(Lt),ue(fr||[]),Q(!0)}catch(kt){e({title:"Falha ao gerar prvia",description:kt?.message||"Tente novamente",variant:"destructive"})}finally{be(!1)}},[Z,ge]=p.useState(!1),[le,se]=p.useState(!1),[ee,de]=p.useState(!1),Le=async()=>{try{e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"});const Se=await lz({status:m,from:d||void 0,to:f||void 0,search:x||"",limit:1e4,offset:0});if(!Se||Se.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const kt=Se.map(pt=>pt.id),Lt=await lS(kt,r?.codigo_empresa),fr=await Hm(r?.codigo_empresa),yr=new Map(fr.map(pt=>[pt.id,pt.numero])),Xt=await bT(kt),nr=await wT(kt),ir=Se.map(pt=>{const Et=pt.mesa_id?`Mesa ${yr.get(pt.mesa_id)||"?"}`:"Balco",mt=Xt[pt.id]||"Sem cliente",gt=nr[pt.id],ft=Array.isArray(gt)?gt.join(", "):gt||"No informado",Dt=pt.fechado_em?"Fechada":"Aberta";return{Tipo:pt.tipo==="balcao"?"Balco":"Mesa","Mesa/Local":Et,"Cliente(s)":mt,Status:Dt,Abertura:new Date(pt.aberto_em).toLocaleString("pt-BR"),Fechamento:pt.fechado_em?new Date(pt.fechado_em).toLocaleString("pt-BR"):"-","Total (R$)":Number(Lt[pt.id]||0).toFixed(2),"Forma(s) Pagamento":ft,Observaes:pt.observacao||"-"}}),Ee=Object.keys(ir[0]),qe=[Ee.join(";"),...ir.map(pt=>Ee.map(Et=>{const mt=pt[Et]||"";return`"${String(mt).replace(/"/g,'""')}"`}).join(";"))].join(`
`),Ge=new Blob(["\uFEFF"+qe],{type:"text/csv;charset=utf-8;"}),Qe=document.createElement("a"),St=URL.createObjectURL(Ge);Qe.setAttribute("href",St),Qe.setAttribute("download",`historico_comandas_${new Date().toISOString().slice(0,10)}.csv`),Qe.style.visibility="hidden",document.body.appendChild(Qe),Qe.click(),document.body.removeChild(Qe),e({title:"CSV exportado!",description:`${ir.length} comandas exportadas`,variant:"success"})}catch(Se){console.error("Erro ao exportar CSV:",Se),e({title:"Erro ao exportar",description:Se.message,variant:"destructive"})}},ae=async()=>{try{if(e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"}),!l||l.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const Se=l.map(nr=>{const ir=nr.status==="open"?"Aberto":nr.status==="closed"?"Fechado":nr.status;return{"Data Abertura":nr.aberto_em?new Date(nr.aberto_em).toLocaleString("pt-BR"):"-","Data Fechamento":nr.fechado_em?new Date(nr.fechado_em).toLocaleString("pt-BR"):"-",Status:ir,"Saldo Inicial (R$)":Number(nr.saldo_inicial||0).toFixed(2),"Saldo Final (R$)":Number(nr.saldo_final||0).toFixed(2),"Valor Contado (R$)":nr.valor_final_dinheiro?Number(nr.valor_final_dinheiro).toFixed(2):"-","Diferena (R$)":nr.diferenca_dinheiro?Number(nr.diferenca_dinheiro).toFixed(2):"-"}}),kt=Object.keys(Se[0]),Lt=[kt.join(";"),...Se.map(nr=>kt.map(ir=>{const Ee=nr[ir]||"";return`"${String(Ee).replace(/"/g,'""')}"`}).join(";"))].join(`
`),fr=new Blob(["\uFEFF"+Lt],{type:"text/csv;charset=utf-8;"}),yr=document.createElement("a"),Xt=URL.createObjectURL(fr);yr.setAttribute("href",Xt),yr.setAttribute("download",`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`),yr.style.visibility="hidden",document.body.appendChild(yr),yr.click(),document.body.removeChild(yr),e({title:"CSV exportado!",description:`${Se.length} fechamentos exportados`,variant:"success"})}catch(Se){console.error("Erro ao exportar CSV:",Se),e({title:"Erro ao exportar",description:Se.message,variant:"destructive"})}},ie=100,[dt,At]=p.useState(0),[st,ut]=p.useState(!1),Rt=p.useRef(!1),Nt=p.useRef(0),tt=p.useRef(0),he=p.useRef(!1),ke=()=>{try{const Se=localStorage.getItem("auth:userProfile");return Se&&JSON.parse(Se)?.codigo_empresa||null}catch{return null}},et=p.useMemo(()=>`hist:comandas:${ke()||"na"}:${d}:${f}:${m}:${b}:${(x||"").trim()}`,[d,f,m,b,x]),Me=async({append:Se=!1,skipCacheWrite:kt=!1}={})=>{try{i(!0);const Lt=ke();if(!Lt){i(!1);return}const fr=setTimeout(()=>i(!1),1e4);if(j==="comandas"){const yr=!!(x&&x.trim()),Xt=yr?1e3:ie,nr=yr?0:dt;console.log("[HistoricoComandasPage] Carregando com:",{status:m,from:d,to:f,search:x,mesaId:o,searching:yr,effLimit:Xt});const ir=await lz({status:m,from:d,to:f,search:o||x,limit:Xt,offset:nr});console.log("[HistoricoComandasPage] Resultado:",ir?.length||0,"comandas");const Ee=(ir||[]).map(mt=>mt.id);let qe={};if(Ee.length>0)try{qe=await lS(Ee,Lt)}catch{qe={}}let Ge=[];try{Ge=await Hm(Lt)}catch{Ge=[]}const Qe=new Map((Ge||[]).map(mt=>[mt.id,mt.numero]));let St={},pt={};try{St=await bT(Ee)}catch{St={}}try{pt=await wT(Ee)}catch{pt={}}const Et=(ir||[]).map(mt=>{const gt=St[mt.id],ft=pt[mt.id];return{...mt,statusDerived:mt.status==="cancelled"?"cancelled":mt.fechado_em?"closed":mt.status||"open",total:Number(qe[mt.id]||0),mesaNumero:Qe.get(mt.mesa_id),clientesStr:Array.isArray(gt)?gt.join(", "):gt||"",finalizadorasStr:Array.isArray(ft)?ft.join(", "):ft||""}});if(ut(yr?!1:(ir||[]).length===ie),c(Se?mt=>[...mt,...Et]:Et),!kt)try{localStorage.setItem(et,JSON.stringify({ts:Date.now(),rows:Et}))}catch{}}else{const yr=await Ere({from:d,to:f,limit:100,offset:0,codigoEmpresa:Lt});c(yr||[])}clearTimeout(fr)}catch(Lt){e({title:"Falha ao carregar histrico",description:Lt?.message||"Tente novamente",variant:"destructive"})}finally{i(!1),Nt.current=Date.now()}};p.useEffect(()=>{o&&(async()=>{try{const Lt=(await Hm(r?.codigo_empresa)||[]).find(fr=>fr.id===o);Lt&&P(`Mesa ${Lt.numero}`)}catch{}})()},[o,r?.codigo_empresa]),p.useEffect(()=>{if(Rt.current=!0,j==="comandas")try{const Se=localStorage.getItem(et);if(Se){const kt=JSON.parse(Se);kt&&Array.isArray(kt.rows)&&Date.now()-Number(kt.ts||0)<12e4&&c(kt.rows)}}catch{}return()=>{Rt.current=!1}},[et,j]),p.useEffect(()=>{j==="comandas"&&(At(0),ut(!1)),Me({append:!1})},[m,x,d,f,j]),p.useEffect(()=>{if(!s&&j==="comandas"&&l.length===0){const Se=setTimeout(()=>{Rt.current&&Me({append:!1,skipCacheWrite:!1})},1500);return()=>clearTimeout(Se)}},[l.length,s,j]),p.useEffect(()=>{const Se=()=>{document.visibilityState==="visible"&&Date.now()-(Nt.current||0)>3e4&&Me({append:!1})},kt=()=>{Date.now()-(Nt.current||0)>3e4&&Me({append:!1})};return window.addEventListener("visibilitychange",Se),window.addEventListener("focus",kt),()=>{window.removeEventListener("visibilitychange",Se),window.removeEventListener("focus",kt)}},[et,j]);const $e=async Se=>{M(Se),R({loading:!0,itens:[],pagamentos:[]});const kt=ke();he.current=!0;const Lt=++tt.current,fr=setTimeout(()=>{tt.current===Lt&&he.current&&R(yr=>({...yr,loading:!1}))},1e4);if(!kt){clearTimeout(fr),tt.current===Lt&&he.current&&R({loading:!1,itens:[],pagamentos:[]});return}try{const yr=(l||[]).find(Xt=>Xt.id===Se)||null;if(yr){const Xt=yr.mesa_id==null?"Balco":yr.mesaNumero!=null?`Mesa ${yr.mesaNumero}`:"Comanda";U({mesaLabel:Xt,clientesStr:yr.clientesStr||"",aberto_em:yr.aberto_em||null,fechado_em:yr.fechado_em||null,tipo:yr.mesa_id==null?"balcao":"comanda",status:yr.statusDerived||yr.status||"open",diferenca_pagamento:typeof yr.diferenca_pagamento=="number"?yr.diferenca_pagamento:0})}else U(null)}catch{U(null)}try{const yr=async()=>{const[nr,ir]=await Promise.all([ds({comandaId:Se,codigoEmpresa:kt}),Pre({comandaId:Se,codigoEmpresa:kt})]);let Ee=[];try{Ee=await ni({comandaId:Se,codigoEmpresa:kt})}catch{}console.log("[openDetail] clientesVinc:",Ee);const qe=new Map((Ee||[]).map(St=>{const pt=St?.cliente_id??St?.clientes?.id??null,Et=St?.clientes?.nome??St?.nome??St?.nome_livre??"";return console.log(`[openDetail] Mapeando cliente: cid=${pt}, nome=${Et}`),pt?[String(pt),Et]:null}).filter(Boolean));console.log("[openDetail] nomeById map:",Array.from(qe.entries()));const Ge=[...Array.from(qe.values()),...(Ee||[]).filter(St=>!St?.cliente_id&&(St?.nome_livre||St?.nome)).map(St=>St?.nome_livre||St?.nome||"Consumidor")];console.log("[openDetail] clientesDisponiveis:",Ge),console.log("[openDetail] pagamentos:",ir);const Qe=(ir||[]).map((St,pt)=>{let Et="";return St?.cliente_id?(Et=qe.get(String(St.cliente_id))||"",!Et&&Ge.length>0&&(Et=Ge[pt%Ge.length])):Ge.length>0&&(Et=Ge[pt%Ge.length]),console.log(`[openDetail] Pagamento ${pt}: cliente_id=${St?.cliente_id}, clienteNome=${Et}`),{...St,cliente_nome:Et,finalizadora_nome:St?.finalizadoras?.nome||St?.metodo||""}});return{itens:nr||[],pagamentos:Qe}};let Xt=await yr();Xt.itens.length===0&&Xt.pagamentos.length===0&&(await new Promise(nr=>setTimeout(nr,700)),Xt=await yr()),tt.current===Lt&&he.current&&R({loading:!1,itens:Xt.itens,pagamentos:Xt.pagamentos})}catch(yr){tt.current===Lt&&he.current&&R({loading:!1,itens:[],pagamentos:[]}),e({title:"Falha ao carregar detalhes",description:yr?.message||"Tente novamente",variant:"destructive"})}finally{clearTimeout(fr),tt.current===Lt&&he.current&&R(yr=>({...yr,loading:!1}))}},Be=p.useMemo(()=>({sum:l.reduce((kt,Lt)=>kt+Number(Lt.total||0),0)}),[l]),we=Se=>(Se||"").toString().toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,""),He=p.useMemo(()=>{const Se=(x||"").trim(),kt=we(Se),fr=l.filter(yr=>{const Xt=yr.mesa_id==null;return!(b==="balcao"&&!Xt||b==="comanda"&&Xt)}).filter(yr=>{const Xt=yr.statusDerived||(yr.status==="cancelled"?"cancelled":yr.fechado_em?"closed":yr.status||"open");return m==="closed"?Xt==="closed":m==="open"?Xt==="open":m==="awaiting-payment"?Xt==="awaiting-payment":m==="cancelled"?Xt==="cancelled":!0});return kt?fr.filter(yr=>{const Xt=yr.mesaNumero!=null?String(yr.mesaNumero):"",nr=yr.mesa_id==null?"balcao":`mesa ${Xt}`;return[Xt,nr,yr.clientesStr||"",yr.finalizadorasStr||"",yr.mesa_id==null?"balcao":"comanda",yr.statusDerived||yr.status||""].map(we).join(" | ").includes(kt)}):fr},[l,x,b,m]),ht=Se=>Se==="open"?"Aberta":Se==="awaiting-payment"?"Pagamento":Se==="closed"?"Fechada":Se==="cancelled"?"Cancelada":Se||"",zt=Se=>{if(!Se)return"";try{return new Date(Se).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}},hr=Se=>{const kt=String(Se||"").toLowerCase();return kt==="open"?"Aberto":kt==="closed"?"Fechado":""},Mt=Se=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Se||0)),Qt=Se=>Se==="open"?"text-info bg-info/10 border-info/30":Se==="awaiting-payment"?"text-warning bg-warning/10 border-warning/30":Se==="closed"?"text-success bg-success/10 border-success/30":Se==="cancelled"?"text-red-400 bg-red-500/10 border-red-500/30":"text-text-secondary bg-transparent border-border/50";return a.jsxs(Pr.div,{variants:qit,initial:"hidden",animate:"visible",className:"min-h-screen flex flex-col",children:[a.jsxs(Pr.div,{variants:by,className:"mb-6 gap-3 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsx(_c,{value:"historico",onValueChange:Se=>{Se==="mesas"&&t("/vendas"),Se==="balcao"&&t("/balcao"),Se==="historico"&&t("/historico")},children:a.jsxs(ql,{className:"grid w-full sm:w-auto grid-cols-3 sm:inline-flex",children:[a.jsx(ca,{value:"mesas",children:"Mesas"}),a.jsx(ca,{value:"balcao",children:"Balco"}),a.jsx(ca,{value:"historico",children:"Histrico"})]})}),a.jsxs("div",{className:"w-full flex items-center gap-2 sm:gap-3",children:[a.jsxs("div",{className:"flex sm:hidden items-center gap-2 w-full",children:[a.jsxs(Cn,{value:j,onValueChange:_,children:[a.jsx(jn,{className:"w-[160px] text-sm",children:a.jsx(An,{placeholder:"Selecionar"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"comandas",children:"Comandas"}),a.jsx(nt,{value:"fechamentos",children:"Fechamentos"})]})]}),a.jsxs("div",{className:"ml-auto text-xs text-text-secondary whitespace-nowrap",children:["Total: ",a.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",Be.sum.toFixed(2)]})]}),j==="comandas"&&a.jsx(ce,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:()=>se(!0),title:"Aes",children:a.jsx(ms,{className:"h-4 w-4"})}),j==="fechamentos"&&a.jsx(ce,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:ae,title:"Exportar",children:a.jsx(ms,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"hidden sm:flex items-center gap-2 sm:gap-3 ml-auto",children:a.jsx(_c,{value:j,onValueChange:_,className:"w-full sm:w-auto",children:a.jsxs(ql,{className:"w-full grid grid-cols-2 sm:w-auto sm:inline-flex text-sm",children:[a.jsx(ca,{value:"comandas",className:"text-sm",children:"Comandas"}),a.jsx(ca,{value:"fechamentos",className:"text-sm",children:"Fechamentos"})]})})})]}),a.jsxs("div",{className:"hidden sm:flex w-full sm:w-auto items-center gap-2 sm:gap-3",children:[j==="comandas"&&a.jsxs(a.Fragment,{children:[a.jsxs(ce,{variant:"secondary",size:"sm",className:"hidden sm:inline-flex",onClick:()=>ge(!0),children:[a.jsx(Gs,{className:"mr-2 h-4 w-4"}),"Importar XML"]}),a.jsxs(ce,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:Le,children:[a.jsx(ms,{className:"mr-1 h-3 w-3"}),"Exportar"]}),a.jsx("button",{className:"hidden sm:inline-block text-xs text-text-muted hover:text-text-primary transition-colors",onClick:()=>{if(ee){const Se=new Date().toISOString().slice(0,10);u(Se),h(Se),de(!1)}else u(""),h(""),de(!0);At(0)},title:ee?"Voltar ao filtro de hoje":"Mostrar todas as comandas",children:ee?"":""}),a.jsxs("div",{className:"text-sm text-text-secondary whitespace-nowrap ml-auto",children:["Total: ",a.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",Be.sum.toFixed(2)]})]})]}),j==="fechamentos"&&a.jsxs(ce,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:ae,children:[a.jsx(ms,{className:"mr-1 h-3 w-3"}),"Exportar"]})]})]}),a.jsx(xn,{open:le,onOpenChange:se,children:a.jsxs(vn,{className:"sm:hidden w-[92vw] max-w-[360px] p-2",onOpenAutoFocus:Se=>Se.preventDefault(),onKeyDown:Se=>Se.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{className:"text-base",children:"Aes"}),a.jsx(On,{children:"Escolha uma ao para Comandas"})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs(ce,{variant:"secondary",onClick:()=>{se(!1),ge(!0)},children:[a.jsx(Gs,{className:"mr-2 h-4 w-4"})," Importar XML"]}),a.jsxs(ce,{variant:"outline",onClick:()=>{se(!1),Le()},children:[a.jsx(ms,{className:"mr-2 h-4 w-4"})," Exportar CSV"]})]})]})}),j==="comandas"&&a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsxs("div",{className:"text-xs text-text-secondary",children:["Carregadas ",l.length," ",l.length===1?"comanda":"comandas"]}),st&&a.jsx(ce,{size:"sm",variant:"outline",disabled:s,onClick:async()=>{const Se=dt+ie;At(Se),await Me({append:!0})},children:"Carregar mais"})]}),j==="comandas"&&a.jsxs("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Buscar...",className:"pl-9 h-9 text-sm",value:g,onChange:Se=>y(Se.target.value)})]}),a.jsx(ce,{size:"sm",variant:"outline",className:"h-9",onClick:()=>E(Se=>!Se),children:C?"Ocultar":"Filtros"})]}),a.jsxs("div",{className:"mt-1 text-[11px] text-text-secondary truncate",children:[d||"","  ",f||""]})]}),j==="comandas"&&a.jsx(Pr.div,{variants:by,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${C?"":"hidden"} sm:block`,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{className:"mb-1 block",children:"Perodo Inicial"}),a.jsx(_j,{value:d,onChange:u})]}),a.jsxs("div",{children:[a.jsx(De,{className:"mb-1 block",children:"Perodo Final"}),a.jsx(_j,{value:f,onChange:h})]}),a.jsxs("div",{className:"md:col-span-2 hidden sm:block",children:[a.jsxs(De,{className:"mb-1 block",children:["Busca ",A&&a.jsxs("span",{className:"text-xs text-warning ml-1",children:["(",A,")"]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Je,{placeholder:"Mesa, status (fechada/aberta) ou cliente",className:"pl-9 pr-12",value:g,onChange:Se=>y(Se.target.value)}),o&&a.jsx(ce,{size:"sm",variant:"ghost",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 text-xs",onClick:()=>{t("/historico")},children:" Limpar"})]})]}),a.jsxs("div",{children:[a.jsx(De,{className:"mb-1 block",children:"Status"}),a.jsxs(Cn,{value:m,onValueChange:v,children:[a.jsx(jn,{className:"w-full text-xs",children:a.jsx(An,{placeholder:"Selecionar status"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"closed",children:"Fechadas"}),a.jsx(nt,{value:"open",children:"Abertas"}),a.jsx(nt,{value:"awaiting-payment",children:"Pagamento"}),a.jsx(nt,{value:"cancelled",children:"Canceladas"})]})]})]}),a.jsxs("div",{children:[a.jsx(De,{className:"mb-1 block",children:"Tipo"}),a.jsxs(Cn,{value:b,onValueChange:w,children:[a.jsx(jn,{className:"w-full text-xs",children:a.jsx(An,{placeholder:"Selecionar tipo"})}),a.jsxs(_n,{children:[a.jsx(nt,{value:"all",children:"Todos"}),a.jsx(nt,{value:"comanda",children:"Comandas"}),a.jsx(nt,{value:"balcao",children:"Balco"})]})]})]})]})}),j==="comandas"&&a.jsxs(Pr.div,{variants:by,className:"bg-surface rounded-lg border border-border p-0 overflow-hidden",children:[a.jsx("div",{className:"hidden sm:block overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Local"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Clientes"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Finalizadora"}),a.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Abertura"}),a.jsx("th",{className:"text-right px-4 py-3 whitespace-nowrap",children:"Diferena"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Total"}),a.jsx("th",{className:"text-right px-4 py-3 whitespace-nowrap",children:"Fiscal"})]})}),a.jsxs("tbody",{children:[He.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-6 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."})}),He.map(Se=>a.jsxs("tr",{className:"border-t border-border/70 hover:bg-warning/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:()=>$e(Se.id),children:[a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:Se.mesa_id==null?"Balco":Se.mesaNumero!=null?`Mesa ${Se.mesaNumero}`:""}),a.jsx("td",{className:"px-4 py-2 break-words",title:Se.clientesStr||"",children:Se.clientesStr||""}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("span",{className:mr("inline-flex items-center text-[11px] font-medium px-2 py-0.5 rounded-full border",Qt(Se.statusDerived||Se.status)),children:ht(Se.statusDerived||Se.status)})}),a.jsx("td",{className:"px-4 py-2 break-words",title:Se.finalizadorasStr||"",children:Se.finalizadorasStr||""}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:zt(Se.aberto_em)}),a.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:(()=>{const kt=typeof Se.diferenca_pagamento=="number"?Se.diferenca_pagamento:0;if(Math.abs(kt)<.005)return a.jsx("span",{className:"text-xs text-text-muted",children:"R$ 0,00"});const Lt=kt>0?"text-emerald-500":"text-amber-500",fr=kt>0?"+":"-";return a.jsx("span",{className:`text-xs font-semibold ${Lt}`,children:`${fr} R$ ${Math.abs(kt).toFixed(2)}`})})()}),a.jsx("td",{className:"px-4 py-2 text-right font-semibold whitespace-nowrap",children:Mt(Se.total)}),a.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:Se.fechado_em&&(!Se.nf_status||Se.nf_status==="rejeitada")&&a.jsx(ce,{size:"sm",variant:"outline",onClick:kt=>{kt.stopPropagation(),Ne(Se.id)},children:"Pr-Emisso"})})]},Se.id))]})]})}),a.jsxs("div",{className:"sm:hidden divide-y divide-border",children:[He.length===0&&a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."}),He.map(Se=>a.jsxs("button",{className:"w-full text-left p-3 active:bg-warning/10",onClick:()=>$e(Se.id),children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:Se.mesa_id==null?"Balco":Se.mesaNumero!=null?`Mesa ${Se.mesaNumero}`:"Comanda"}),a.jsx("div",{className:"font-semibold truncate max-w-[220px]",children:Se.clientesStr||"Sem cliente"})]}),a.jsx("div",{children:a.jsx("div",{className:mr("inline-flex items-center text-[10px] font-medium px-2 py-0.5 rounded-full border",Qt(Se.statusDerived||Se.status)),children:ht(Se.statusDerived||Se.status)})})]}),a.jsx("div",{className:"mt-1 text-xs text-text-secondary truncate",children:Se.finalizadorasStr||""}),a.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0 text-[11px] text-text-muted truncate pr-2",children:[zt(Se.aberto_em),Se.fechado_em?`  ${zt(Se.fechado_em)}`:""]}),a.jsxs("div",{className:"flex-shrink-0 text-right min-w-[84px]",children:[a.jsx("div",{className:"text-[11px]",children:(()=>{const kt=typeof Se.diferenca_pagamento=="number"?Se.diferenca_pagamento:0;if(Math.abs(kt)<.005)return a.jsx("span",{className:"text-text-muted",children:"Dif.: R$ 0,00"});const Lt=kt>0?"text-emerald-500":"text-amber-500",fr=kt>0?"+":"-";return a.jsx("span",{className:Lt,children:`Dif.: ${fr} R$ ${Math.abs(kt).toFixed(2)}`})})()}),a.jsx("div",{className:"font-mono font-semibold whitespace-nowrap",children:Mt(Se.total)})]})]}),Se.fechado_em&&(!Se.nf_status||Se.nf_status==="rejeitada")&&a.jsx("div",{className:"mt-2 flex justify-end",children:a.jsx(ce,{size:"sm",variant:"outline",onClick:kt=>{kt.preventDefault(),kt.stopPropagation(),Ne(Se.id)},children:"Pr-Emisso"})})]},Se.id))]})]}),a.jsx(xn,{open:q,onOpenChange:Q,children:a.jsxs(vn,{className:"max-w-[800px]",children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Pr-Emisso NFC-e"}),a.jsx(On,{children:"Revise os dados e pendncias antes de emitir."})]}),pe?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Gerando prvia"}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"JSON (EnviarNfce)"}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto",children:V?JSON.stringify(V,null,2):""})]}),a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Pendncias"}),!J||J.length===0?a.jsx("div",{className:"text-sm text-emerald-500",children:"Nenhuma pendncia encontrada."}):a.jsx("ul",{className:"list-disc pl-5 text-sm",children:J.map((Se,kt)=>a.jsx("li",{children:Se},kt))})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(ce,{variant:"outline",onClick:()=>Q(!1),children:"Fechar"}),a.jsx(ce,{disabled:!0,children:"Emitir (desabilitado)"})]})]})}),j==="fechamentos"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"text-sm font-medium",children:"Filtros"}),a.jsx(ce,{size:"sm",variant:"outline",onClick:()=>E(Se=>!Se),children:C?"Ocultar filtros":"Mostrar filtros"})]})}),a.jsx(Pr.div,{variants:by,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${C?"":"hidden"} sm:block`,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{className:"mb-1 block",children:"Perodo Inicial"}),a.jsx(_j,{value:d,onChange:u})]}),a.jsxs("div",{children:[a.jsx(De,{className:"mb-1 block",children:"Perodo Final"}),a.jsx(_j,{value:f,onChange:h})]})]})}),a.jsxs(Pr.div,{variants:by,className:"bg-surface rounded-lg border border-border p-4 overflow-hidden",children:[a.jsxs("div",{className:"sm:hidden space-y-2",children:[s&&(!l||l.length===0)&&a.jsxs("div",{className:"px-2 py-3 text-center text-text-muted",children:[a.jsx(zm,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]}),(!l||l.length===0)&&!s&&a.jsx("div",{className:"px-2 py-3 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."}),(l||[]).map(Se=>a.jsxs("button",{onClick:async()=>{try{H({open:!0,loading:!0,resumo:null,periodo:{from:Se.aberto_em,to:Se.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Se?.saldo_inicial??null,final:Se?.saldo_final??null}});const kt=ke(),[Lt,fr]=await Promise.all([cS({caixaSessaoId:Se.id,codigoEmpresa:kt}).catch(()=>null),qp({caixaSessaoId:Se.id,codigoEmpresa:kt}).catch(()=>[])]);let yr=Lt?.movimentos||null;if(!yr&&Array.isArray(fr)){const nr={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const ir of fr){const Ee=String(ir?.tipo||"").toLowerCase(),qe=Number(ir?.valor||0);Ee==="suprimento"?nr.suprimentos+=qe:Ee==="sangria"?nr.sangrias+=qe:Ee==="ajuste"?nr.ajustes+=qe:Ee==="troco"&&(nr.troco+=qe)}yr=nr}const Xt=Lt?{totalDescontos:Number(Lt.total_descontos||0),totalVendasLiquidas:Number(Lt.total_liquido||0),totalEntradas:Number(Lt.total_entradas||0),totalPorFinalizadora:Lt.por_finalizadora||{}}:null;H({open:!0,loading:!1,resumo:Xt,periodo:{from:Lt?.periodo_de||Se.aberto_em,to:Lt?.periodo_ate||Se.fechado_em},movs:fr||[],movimentosAgg:yr,saldos:{inicial:Se?.saldo_inicial??null,final:Se?.saldo_final??null}})}catch{H({open:!0,loading:!1,resumo:null,periodo:{from:Se.aberto_em,to:Se.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Se?.saldo_inicial??null,final:Se?.saldo_final??null}})}},className:"w-full text-left p-3 rounded-lg border border-border hover:bg-surface-2 transition",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"text-xs text-text-secondary",children:[zt(Se.aberto_em),a.jsx("span",{className:"mx-1",children:""}),zt(Se.fechado_em)]}),a.jsx("div",{className:"text-[11px] px-2 py-0.5 rounded-full border bg-success/10 text-success border-success/30",children:hr(Se.status)})]}),a.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[a.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Inicial"}),a.jsx("div",{className:"font-semibold",children:Se?.saldo_inicial!=null?Mt(Se.saldo_inicial):""})]}),a.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[a.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Final (contado)"}),a.jsx("div",{className:"font-semibold",children:Se?.valor_final_dinheiro!=null?Mt(Se.valor_final_dinheiro):""})]})]})]},Se.id))]}),a.jsx("div",{className:"hidden sm:block overflow-x-auto max-h-[60vh] overflow-y-auto pr-2 sm:pr-3",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3",children:"Abertura"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Fechamento"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Inicial"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Final (contado)"})]})}),a.jsxs("tbody",{children:[s&&(!l||l.length===0)&&a.jsx("tr",{children:a.jsxs("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:[a.jsx(zm,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]})}),(!l||l.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."})}),(l||[]).map(Se=>a.jsxs("tr",{className:"border-t border-border/70 hover:bg-success/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:async()=>{try{H({open:!0,loading:!0,resumo:null,periodo:{from:Se.aberto_em,to:Se.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Se?.saldo_inicial??null,final:Se?.saldo_final??null}});const kt=async()=>{const yr=ke(),[Xt,nr]=await Promise.all([cS({caixaSessaoId:Se.id,codigoEmpresa:yr}).catch(()=>null),qp({caixaSessaoId:Se.id,codigoEmpresa:yr}).catch(()=>[])]);return{snap:Xt,movs:nr}};let{snap:Lt,movs:fr}=await kt();if(Lt||(await new Promise(yr=>setTimeout(yr,700)),{snap:Lt,movs:fr}=await kt()),Lt){const yr={totalDescontos:Number(Lt.total_descontos||0),totalVendasLiquidas:Number(Lt.total_liquido||0),totalEntradas:Number(Lt.total_entradas||0),totalPorFinalizadora:Lt.por_finalizadora||{}};let Xt=Lt.movimentos||null;if(!Xt&&Array.isArray(fr)){const nr={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const ir of fr){const Ee=String(ir?.tipo||"").toLowerCase(),qe=Number(ir?.valor||0);Ee==="suprimento"?nr.suprimentos+=qe:Ee==="sangria"?nr.sangrias+=qe:Ee==="ajuste"?nr.ajustes+=qe:Ee==="troco"&&(nr.troco+=qe)}Xt=nr}H({open:!0,loading:!1,resumo:yr,periodo:{from:Lt.periodo_de||Se.aberto_em,to:Lt.periodo_ate||Se.fechado_em},movs:fr||[],movimentosAgg:Xt,saldos:{inicial:typeof Lt.saldo_inicial<"u"?Number(Lt.saldo_inicial):Se?.saldo_inicial??null,final:typeof Lt.valor_final_dinheiro<"u"?Number(Lt.valor_final_dinheiro):Se?.valor_final_dinheiro??null}})}else{const yr=ke(),Xt=await hd({from:Se.aberto_em,to:Se.fechado_em||new Date().toISOString(),codigoEmpresa:yr});let nr=null;if(Array.isArray(fr)){const ir={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const Ee of fr){const qe=String(Ee?.tipo||"").toLowerCase(),Ge=Number(Ee?.valor||0);qe==="suprimento"?ir.suprimentos+=Ge:qe==="sangria"?ir.sangrias+=Ge:qe==="ajuste"?ir.ajustes+=Ge:qe==="troco"&&(ir.troco+=Ge)}nr=ir}H({open:!0,loading:!1,resumo:Xt||null,periodo:{from:Se.aberto_em,to:Se.fechado_em},movs:fr||[],movimentosAgg:nr,saldos:{inicial:Se?.saldo_inicial??null,final:Se?.valor_final_dinheiro??null}})}}catch{H({open:!0,loading:!1,resumo:null,periodo:{from:Se.aberto_em,to:Se.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Se?.saldo_inicial??null,final:Se?.valor_final_dinheiro??null}})}},children:[a.jsx("td",{className:"px-4 py-2",children:zt(Se.aberto_em)}),a.jsx("td",{className:"px-4 py-2",children:zt(Se.fechado_em)}),a.jsx("td",{className:"px-4 py-2",children:hr(Se.status)}),a.jsx("td",{className:"px-4 py-2 text-right",children:Se?.saldo_inicial!=null?Mt(Se.saldo_inicial):""}),a.jsx("td",{className:"px-4 py-2 text-right",children:Se?.valor_final_dinheiro!=null?Mt(Se.valor_final_dinheiro):""})]},Se.id))]})]})})]})]}),j==="comandas"&&a.jsx(xn,{open:!!F,onOpenChange:Se=>{Se?he.current=!0:(he.current=!1,M(null),R({loading:!1,itens:[],pagamentos:[]}),U(null))},children:a.jsxs(vn,{className:"sm:max-w-4xl w-[92vw] max-h-[90vh] overflow-hidden flex flex-col animate-none",onKeyDown:Se=>Se.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsxs(fn,{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{children:D?a.jsxs("span",{children:[D.mesaLabel,D.clientesStr?a.jsxs("span",{className:"text-text-secondary",children:["  ",D.clientesStr]}):null]}):a.jsxs(a.Fragment,{children:["Comanda #",F||""]})}),D&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("span",{className:mr("text-xs px-2 py-0.5 rounded-full border",Qt(D.status)),children:D.status==="closed"?"Fechada":D.status==="open"?"Aberta":"Cancelada"}),a.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full border bg-info/10 text-info border-info/30",children:D.tipo==="balcao"?"Balco":D.tipo==="comanda"?"Mesa":"Importada"})]})]}),a.jsx(On,{className:"space-y-1",children:D?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[D.aberto_em?a.jsxs(a.Fragment,{children:["Abertura: ",zt(D.aberto_em)]}):"",D.fechado_em&&a.jsxs(a.Fragment,{children:[" ",""," ","Fechamento: ",zt(D.fechado_em),(()=>{const Se=new Date(D.aberto_em),Lt=new Date(D.fechado_em)-Se,fr=Math.floor(Lt/6e4),yr=Math.floor(fr/60),Xt=fr%60;return fr>0?a.jsxs("span",{className:"text-text-muted",children:[" (",yr>0?`${yr}h `:"",Xt,"min)"]}):null})()]})]}),D.observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:D.observacao.includes("Importado de XML")?a.jsxs("span",{className:"text-warning",children:[" ",D.observacao.split(`
`)[0]]}):a.jsxs("span",{children:["Obs: ",D.observacao]})})]}):a.jsx(a.Fragment,{children:"Itens e pagamentos registrados."})})]}),I.loading?a.jsxs("div",{className:"p-6 text-center text-text-muted",children:[a.jsx(zm,{className:"mr-2 inline h-4 w-4 animate-spin"})," Carregando..."]}):a.jsxs("div",{className:"space-y-4 overflow-y-auto flex-1 px-1",children:[(()=>{const Se=I.itens.reduce((nr,ir)=>nr+Number(ir.quantidade||0)*Number(ir.preco_unitario||0),0),kt=I.itens.reduce((nr,ir)=>nr+Number(ir.desconto||0),0),Lt=Se-kt,fr=I.pagamentos.reduce((nr,ir)=>nr+Number(ir.valor||0),0),yr=typeof D?.diferenca_pagamento=="number"?D.diferenca_pagamento:null,Xt=yr??fr-Lt;return a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Resumo Financeiro"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Subtotal"}),a.jsxs("span",{className:"font-mono font-semibold",children:["R$ ",Se.toFixed(2)]})]}),kt>0&&a.jsxs("div",{className:"flex items-center gap-2 text-warning",children:[a.jsx("span",{children:"Desconto"}),a.jsxs("span",{className:"font-mono font-semibold",children:["-R$ ",kt.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex justify-between font-semibold pt-2 border-t border-border",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{className:"font-mono text-lg",children:["R$ ",Lt.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2 text-success",children:[a.jsx("span",{children:"Pagamentos"}),a.jsxs("span",{className:"font-mono",children:["R$ ",fr.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-secondary",children:"Diferena"}),a.jsx("span",{className:mr("font-semibold",Math.abs(Xt)<.005?"text-text-muted":Xt>0?"text-emerald-500":"text-amber-500"),children:Math.abs(Xt)<.005?"R$ 0,00":`${Xt>0?"+":"-"} R$ ${Math.abs(Xt).toFixed(2)}`})]})]})]})]})})(),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"border rounded-md p-3",children:[a.jsxs("div",{className:"font-semibold mb-2",children:["Itens (",I.itens.length,")"]}),I.itens.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem itens."}):a.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:I.itens.map(Se=>{const kt=Number(Se.quantidade||0)*Number(Se.preco_unitario||0),Lt=Number(Se.desconto||0),fr=kt-Lt;return a.jsx("li",{className:"border-b border-border/50 pb-2 last:border-0",children:a.jsxs("div",{className:"flex justify-between items-start gap-2",children:[a.jsxs("span",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:Se.descricao}),a.jsxs("div",{className:"text-xs text-text-muted",children:[Se.quantidade," x R$ ",Number(Se.preco_unitario||0).toFixed(2),Lt>0&&a.jsxs("span",{className:"text-warning",children:[" (desc: R$ ",Lt.toFixed(2),")"]})]})]}),a.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",fr.toFixed(2)]})]})},Se.id)})})]}),a.jsxs("div",{className:"border rounded-md p-3",children:[a.jsxs("div",{className:"font-semibold mb-2",children:["Pagamentos (",I.pagamentos.length,")"]}),I.pagamentos.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros."}):a.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:I.pagamentos.map(Se=>a.jsxs("li",{className:"flex justify-between gap-2 border-b border-border/50 pb-2 last:border-0",children:[a.jsxs("span",{className:"pr-2 break-words flex-1",children:[Se.cliente_nome?a.jsx("div",{className:"font-medium",children:Se.cliente_nome}):a.jsx("div",{className:"text-text-muted",children:"Sem cliente"}),a.jsx("div",{className:"text-xs text-text-secondary",children:Se.finalizadora_nome||"Outros"})]}),a.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",Number(Se.valor||0).toFixed(2)]})]},Se.id))})]})]})]}),a.jsx(ra,{children:a.jsx(ce,{size:"sm",variant:"secondary",onClick:()=>{M(null)},children:"Fechar"})})]})}),j==="fechamentos"&&a.jsx(xn,{open:z.open,onOpenChange:Se=>{Se||H({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null}})},children:a.jsxs(vn,{className:"sm:max-w-2xl w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden overflow-x-hidden",onKeyDown:Se=>Se.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(fn,{children:"Fechamento do Perodo"}),a.jsxs(On,{children:[z.periodo.from?zt(z.periodo.from):""," ","at"," ",z.periodo.to?zt(z.periodo.to):""]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:z.loading?a.jsxs("div",{className:"p-3 sm:p-4 text-text-muted",children:[a.jsx(zm,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando resumo"]}):a.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),a.jsx("p",{className:"text-xl font-bold",children:Mt(z?.saldos?.inicial??0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Entradas (pagamentos)"}),a.jsx("p",{className:"text-xl font-bold text-success",children:Mt(z.resumo?.totalEntradas||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border col-span-2 sm:col-span-1",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),a.jsx("p",{className:"text-xl font-bold",children:z?.saldos?.final!=null?Mt(z.saldos.final):""})]})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),a.jsx("p",{className:"text-xl font-bold text-warning",children:Mt(z.resumo?.totalDescontos||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),a.jsx("p",{className:"text-xl font-bold",children:Mt(z.resumo?.totalVendasLiquidas||0)})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-1",children:"Por Finalizadora"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:z.resumo?.totalPorFinalizadora&&Object.keys(z.resumo.totalPorFinalizadora).length>0?Object.entries(z.resumo.totalPorFinalizadora).map(([Se,kt])=>a.jsxs("div",{className:"flex items-center justify-between bg-surface-2 rounded-md p-2 border border-border",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:String(Se)}),a.jsx("span",{className:"text-sm font-semibold",children:Mt(kt)})]},Se)):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados de finalizadoras"})})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-1",children:"Resumo de Movimentaes"}),z.movimentosAgg?a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Suprimentos"}),a.jsx("p",{className:"text-lg font-bold text-success",children:Mt(z.movimentosAgg?.suprimentos||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Sangrias"}),a.jsx("p",{className:"text-lg font-bold text-danger",children:Mt(z.movimentosAgg?.sangrias||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Ajustes"}),a.jsx("p",{className:"text-lg font-bold",children:Mt(z.movimentosAgg?.ajustes||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Troco"}),a.jsx("p",{className:"text-lg font-bold",children:Mt(z.movimentosAgg?.troco||0)})]})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes agregadas nesta sesso."})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-1",children:"Movimentaes"}),!z.movs||z.movs.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma movimentao registrada"}):a.jsxs(a.Fragment,{children:[a.jsx("ul",{className:"sm:hidden divide-y divide-border rounded-md border border-border overflow-hidden",children:z.movs.map((Se,kt)=>a.jsxs("li",{className:"px-3 py-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-xs text-text-secondary whitespace-nowrap",children:zt(Se.criado_em)}),a.jsx("span",{className:"text-sm font-semibold whitespace-nowrap",children:Mt(Se.valor||0)})]}),a.jsxs("div",{className:"mt-0.5 flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded bg-surface-2 border border-border text-text-secondary whitespace-nowrap",children:String(Se.tipo||"").toUpperCase()}),a.jsx("span",{className:"text-xs text-text-primary whitespace-normal break-words flex-1",children:Se.observacao||""})]})]},kt))}),a.jsx("div",{className:"hidden sm:block rounded-md border border-border overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Data"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Tipo"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Obs"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Valor"})]})}),a.jsx("tbody",{children:z.movs.map((Se,kt)=>a.jsxs("tr",{className:"border-t border-border/60",children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:zt(Se.criado_em)}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:String(Se.tipo||"").toUpperCase()}),a.jsx("td",{className:"px-3 py-2 whitespace-normal break-words",children:Se.observacao||""}),a.jsx("td",{className:"px-3 py-2 text-right font-semibold whitespace-nowrap",children:Mt(Se.valor||0)})]},kt))})]})})]})]})]})})]})}),a.jsx(Bit,{open:Z,onOpenChange:ge,codigoEmpresa:r?.codigo_empresa,onSuccess:async Se=>{ge(!1),Se&&(u(Se),h(Se)),await new Promise(kt=>setTimeout(kt,500)),At(0),await Me({append:!1})}})]})}function Vit(){const{userProfile:e}=So(),[t]=QS(),r=t.get("comanda"),[n,o]=p.useState(!0),[s,i]=p.useState(null),[l,c]=p.useState([]),[d,u]=p.useState([]),[f,h]=p.useState([]),[m,v]=p.useState(null),[g,y]=p.useState(""),[x,b]=p.useState("");p.useEffect(()=>{(async()=>{try{if(!r||!e?.codigo_empresa)return;try{const{data:R,error:D}=await fe.from("empresas").select("nome_fantasia, nome").eq("codigo_empresa",e.codigo_empresa).single();if(D&&console.warn("[PrintComandaPage] Erro ao buscar empresa:",D.message),R){const U=R.nome_fantasia||R.nome||"";console.log("[PrintComandaPage] Empresa carregada:",R,"-> nome exibido:",U),b(U)}else console.warn("[PrintComandaPage] Empresa no encontrada para codigo_empresa:",e.codigo_empresa)}catch(R){console.warn("[PrintComandaPage] Exceo ao carregar empresa:",R)}const{data:E}=await fe.from("comandas").select("mesa_id, observacoes").eq("id",r).eq("codigo_empresa",e.codigo_empresa).single();if(E?.mesa_id){const{data:R}=await fe.from("mesas").select("numero").eq("id",E.mesa_id).eq("codigo_empresa",e.codigo_empresa).single();v(R)}y(E?.observacoes||"");const[A,P,F]=await Promise.all([ds({comandaId:r,codigoEmpresa:e.codigo_empresa}),ni({comandaId:r,codigoEmpresa:e.codigo_empresa}),Pre({comandaId:r,codigoEmpresa:e.codigo_empresa})]);c(A||[]),u(P||[]),h(F||[]);const M=(A||[]).reduce((R,D)=>R+Number(D.quantidade||0)*Number(D.preco_unitario||0),0),I=(F||[]).reduce((R,D)=>R+Number(D.valor||0),0);i({id:r,totalItens:M,totalPagamentos:I,diferenca:I-M})}catch(E){console.error("Erro ao carregar comanda:",E)}finally{o(!1)}})()},[r,e?.codigo_empresa]);const w=()=>{window.print()},j=()=>{window.history.back()};if(n)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand mx-auto mb-4"}),a.jsx("p",{className:"text-text-muted",children:"Carregando comanda..."})]})});if(!s)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-text-muted mb-4",children:"Comanda no encontrada"}),a.jsxs(ce,{onClick:j,variant:"outline",children:[a.jsx(qy,{className:"mr-2 h-4 w-4"}),"Voltar"]})]})});const _=(d||[]).map(C=>C?.nome||C?.nome_livre||"").filter(Boolean).join(", ")||"Sem cliente";return s.totalItens,s.totalPagamentos,a.jsxs("div",{className:"w-screen h-screen bg-gray-100 flex flex-col print:bg-white print:p-0",children:[a.jsxs("div",{className:"flex gap-2 p-4 bg-white border-b border-gray-200 print:hidden",children:[a.jsxs(ce,{onClick:j,size:"sm",className:"bg-black text-white hover:bg-black/80 border border-black shadow-sm",children:[a.jsx(qy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsxs(ce,{onClick:w,size:"sm",className:"ml-auto",children:[a.jsx(UH,{className:"mr-2 h-4 w-4"}),"Imprimir"]})]}),a.jsx("div",{className:"flex-1 overflow-auto flex items-start justify-center p-4 print:p-0 print:overflow-visible print:flex-none",children:a.jsxs("div",{className:"w-80 border border-black p-6 bg-white print:border-0 print:p-0 print:w-full",children:[a.jsxs("div",{className:"text-center mb-4 border-b border-black pb-3",children:[a.jsx("p",{className:"text-xs font-semibold text-black mb-2",children:x||" "}),a.jsx("h1",{className:"text-xl font-bold text-black",children:"COMANDA"}),m&&a.jsxs("p",{className:"text-xs text-black mt-1",children:["Mesa ",m.numero]}),a.jsx("p",{className:"text-xs text-black mt-1",children:new Date().toLocaleString("pt-BR")})]}),a.jsxs("div",{className:"mb-6 pb-4 border-b border-black",children:[a.jsx("p",{className:"text-sm font-semibold text-black",children:"CLIENTE:"}),a.jsx("p",{className:"text-sm text-black",children:_})]}),a.jsx("div",{className:"mb-6 pb-4 border-b border-black",children:a.jsx("div",{className:"space-y-2",children:l.map((C,E)=>{const A=Number(C.quantidade||0)*Number(C.preco_unitario||0);return a.jsxs("div",{className:"flex justify-between text-sm text-black",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{children:C.descricao||"Item"}),a.jsxs("span",{className:"ml-2 text-xs",children:["x",C.quantidade]})]}),a.jsxs("span",{className:"font-semibold",children:["R$ ",A.toFixed(2)]})]},E)})})}),g&&a.jsxs("div",{className:"mb-4 pb-3",children:[a.jsx("p",{className:"text-xs font-semibold text-black mb-1",children:"OBS:"}),a.jsx("p",{className:"text-xs text-black border-b border-black pb-3",children:g})]}),a.jsx("div",{className:"text-center pt-4",children:a.jsxs("p",{className:"text-lg font-bold text-black mt-2",children:["TOTAL: R$ ",s.totalItens.toFixed(2)]})}),a.jsxs("div",{className:"text-center mt-8 pt-4 border-t border-black text-xs text-black",children:[a.jsx("p",{children:"Obrigado pela preferncia!"}),a.jsx("p",{className:"mt-2",children:"Fluxo7Arena"})]})]})}),a.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            background: white;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:border-0 {
            border: none !important;
          }
          .print\\:p-0 {
            padding: 0 !important;
          }
        }
      `})]})}const Wit="18810778",dv={hidden:{opacity:0,x:20},visible:{opacity:1,x:0,transition:{duration:.3}},exit:{opacity:0,x:-20,transition:{duration:.2}}};function Hit(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function Git(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2").substring(0,15)}async function Kit(){try{const{data:e,error:t}=await fe.from("empresas").select("codigo_empresa").order("codigo_empresa",{ascending:!1}).limit(100);if(t)return console.warn("Erro ao buscar cdigos:",t),"1";let r=0;return e&&e.length>0&&e.forEach(n=>{const o=parseInt(n.codigo_empresa);!isNaN(o)&&o>r&&(r=o)}),(r+1).toString()}catch(e){return console.warn("Erro ao gerar cdigo:",e),"1"}}function Xit(){const{toast:e}=no(),t=Yi(),[r,n]=p.useState(1),[o,s]=p.useState(!1),[i,l]=p.useState(!1),[c,d]=p.useState(""),[u,f]=p.useState({email:"",nomeUsuario:"",cargo:"",razaoSocial:"",nomeFantasia:"",cnpj:"",emailEmpresa:"",telefone:"",endereco:"",quadras:[],mesas:[],categorias:[]}),[h,m]=p.useState(null),v=H=>{H.preventDefault(),c===Wit?(l(!0),n(2),e({title:"Acesso liberado",description:"Bem-vindo ao formulrio de criao de empresa."})):(e({title:"Senha incorreta",description:"Tente novamente.",variant:"destructive"}),d(""))},g=()=>!0,y=()=>u.razaoSocial.trim()?u.nomeFantasia.trim()?!0:(e({title:"Nome Fantasia obrigatrio",variant:"destructive"}),!1):(e({title:"Razo Social obrigatria",variant:"destructive"}),!1),x=()=>{r===2&&!g()||r===3&&!y()||n(r+1)},b=()=>{n(r-1)},w=()=>{const H=u.quadras.length+1;f({...u,quadras:[...u.quadras,{nome:`Quadra ${H}`}]})},j=H=>{f({...u,quadras:u.quadras.filter((q,Q)=>Q!==H)})},_=()=>{const H=u.mesas.length+1;f({...u,mesas:[...u.mesas,{numero:H,nome:`Mesa ${H}`}]})},C=H=>{f({...u,mesas:u.mesas.filter((q,Q)=>Q!==H)})},E=()=>{const H=prompt("Digite o nome da categoria:");H&&H.trim()&&f({...u,categorias:[...u.categorias,{nome:H.trim(),descricao:""}]})},A=H=>{f({...u,categorias:u.categorias.filter((q,Q)=>Q!==H)})},P=async()=>{try{s(!0);try{const V={user:{email:u.email?.trim()||null,nome:u.nomeUsuario?.trim()||null,cargo:u.cargo?.trim()||"admin"},empresa:{razao_social:u.razaoSocial?.trim()||null,nome_fantasia:u.nomeFantasia?.trim()||null,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa?.trim()||null,telefone:u.telefone?.trim()||null,endereco:u.endereco?.trim()||null},quadras:u.quadras||[],mesas:u.mesas||[],categorias:u.categorias||[]},{data:B,error:J}=await fe.rpc("create_company_full",{payload:V});if(!J&&B&&B.codigo_empresa){m({success:!0,codigoEmpresa:B.codigo_empresa,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:(u.quadras||[]).length,numMesas:(u.mesas||[]).length,numCategorias:(u.categorias||[]).length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${B.codigo_empresa}`});return}else J&&console.warn("RPC create_company_full indisponvel/erro. Usando fluxo local.",J?.message||J)}catch(V){console.warn("Falha ao tentar RPC create_company_full. Usando fluxo local.",V?.message||V)}let H=null;u.email.trim()&&(console.log("Email fornecido:",u.email),console.log("Nota: O vnculo com o usurio ser criado no primeiro login"),H=null);const q=await Kit();console.log("Cdigo da empresa gerado:",q);const{data:Q,error:pe}=await fe.from("empresas").insert({codigo_empresa:q,nome:u.nomeFantasia,razao_social:u.razaoSocial,nome_fantasia:u.nomeFantasia,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa||null,telefone:u.telefone||null,endereco:u.endereco||null}).select().single();if(pe)throw new Error("Erro ao criar empresa: "+pe.message);const{error:be}=await fe.from("empresa_counters").insert({empresa_id:Q.id,next_cliente_codigo:1,next_agendamento_codigo:1});if(be&&console.warn("Erro ao criar contador:",be),u.email.trim()||u.nomeUsuario.trim())try{const V="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(ue){const Ne=Math.random()*16|0;return(ue==="x"?Ne:Ne&3|8).toString(16)}),{error:B}=await fe.from("usuarios").insert({id:V,email:u.email||null,nome:u.nomeUsuario||null,papel:u.cargo||"admin",codigo_empresa:q});B&&console.warn("Aviso ao criar usurio:",B.message);const{error:J}=await fe.from("colaboradores").insert({id:V,nome:u.nomeUsuario||"Administrador",cargo:u.cargo||"admin",ativo:!0,codigo_empresa:q});J&&console.warn("Aviso ao criar colaborador:",J.message),u.email&&(console.log(" APS O PRIMEIRO LOGIN, execute este SQL no Supabase:"),console.log(`
-- Atualizar ID do colaborador com o ID real do auth.users
UPDATE public.colaboradores 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${q}' AND id = '${V}';

-- Atualizar ID do usurio
UPDATE public.usuarios 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${q}' AND id = '${V}';
            `))}catch(V){console.warn("Erro ao criar registros de usurio:",V)}try{await fe.from("agenda_settings").insert({empresa_id:Q.id,auto_confirm_enabled:!1,auto_start_enabled:!0,auto_finish_enabled:!0})}catch(V){console.warn("Aviso: no foi possvel criar agenda_settings agora (provvel RLS). Ser configurado aps o primeiro login.",V?.message||V)}if(u.quadras.length>0){const V=u.quadras.map(B=>({nome:B.nome,codigo_empresa:q}));await fe.from("quadras").insert(V)}if(u.mesas.length>0){const V=u.mesas.map(B=>({numero:B.numero,nome:B.nome,codigo_empresa:q,status:"available"}));await fe.from("mesas").insert(V)}if(u.categorias.length>0){const V=u.categorias.map(B=>({nome:B.nome,descricao:B.descricao||null,codigo_empresa:q,ativa:!0}));await fe.from("produto_categorias").insert(V)}m({success:!0,codigoEmpresa:q,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:u.quadras.length,numMesas:u.mesas.length,numCategorias:u.categorias.length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${q}`})}catch(H){console.error("Erro ao criar empresa:",H),e({title:"Erro ao criar empresa",description:H.message,variant:"destructive"})}finally{s(!1)}},F=()=>{if(r===1||r===6)return null;const H=(r-1)/4*100;return a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("span",{className:"text-sm text-text-muted",children:["Etapa ",r-1," de 4"]}),a.jsxs("span",{className:"text-sm text-text-muted",children:[Math.round(H),"%"]})]}),a.jsx("div",{className:"h-2 bg-surface-2 rounded-full overflow-hidden",children:a.jsx(Pr.div,{className:"h-full bg-brand",initial:{width:0},animate:{width:`${H}%`},transition:{duration:.3}})})]})},M=()=>a.jsxs(Pr.div,{variants:dv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-md mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(gx,{className:"w-8 h-8 text-brand"})}),a.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"rea Restrita"}),a.jsx("p",{className:"text-text-muted",children:"Digite a senha para acessar"})]}),a.jsxs("form",{onSubmit:v,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"senha",children:"Senha de Acesso"}),a.jsx(Je,{id:"senha",type:"password",value:c,onChange:H=>d(H.target.value),placeholder:"Digite a senha",className:"text-center text-lg tracking-widest",autoFocus:!0})]}),a.jsxs(ce,{type:"submit",className:"w-full",children:["Acessar",a.jsx(_2,{className:"ml-2 h-4 w-4"})]})]})]},"step1"),I=()=>a.jsxs(Pr.div,{variants:dv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(Ou,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Primeiro Usurio"}),a.jsx("p",{className:"text-text-muted",children:"Informaes do administrador da empresa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"email",children:"Email cadastrado no Supabase Auth"}),a.jsx(Je,{id:"email",type:"email",value:u.email,onChange:H=>f({...u,email:H.target.value}),placeholder:"usuario@email.com"}),a.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Este email j deve estar cadastrado no Supabase Auth"})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"nomeUsuario",children:"Nome Completo"}),a.jsx(Je,{id:"nomeUsuario",type:"text",value:u.nomeUsuario,onChange:H=>f({...u,nomeUsuario:H.target.value}),placeholder:"Joo Silva"})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"cargo",children:"Cargo na Empresa"}),a.jsx(Je,{id:"cargo",type:"text",value:u.cargo,onChange:H=>f({...u,cargo:H.target.value}),placeholder:"Ex: Proprietrio, Gerente, Administrador, Scio, etc."}),a.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Digite o cargo que voc ocupa na empresa"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(ce,{type:"button",variant:"outline",onClick:()=>t("/"),className:"flex-1",children:"Cancelar"}),a.jsxs(ce,{type:"button",onClick:x,className:"flex-1",children:["Prximo",a.jsx(_2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step2"),R=()=>a.jsxs(Pr.div,{variants:dv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(T_,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Dados da Empresa"}),a.jsx("p",{className:"text-text-muted",children:"Informaes cadastrais da empresa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{htmlFor:"razaoSocial",children:"Razo Social *"}),a.jsx(Je,{id:"razaoSocial",type:"text",value:u.razaoSocial,onChange:H=>f({...u,razaoSocial:H.target.value}),placeholder:"Empresa LTDA"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{htmlFor:"nomeFantasia",children:"Nome Fantasia *"}),a.jsx(Je,{id:"nomeFantasia",type:"text",value:u.nomeFantasia,onChange:H=>f({...u,nomeFantasia:H.target.value}),placeholder:"Minha Empresa"}),a.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Como a empresa aparecer no sistema"})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"cnpj",children:"CNPJ"}),a.jsx(Je,{id:"cnpj",type:"text",value:u.cnpj,onChange:H=>f({...u,cnpj:Hit(H.target.value)}),placeholder:"00.000.000/0000-00"})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"telefone",children:"Telefone"}),a.jsx(Je,{id:"telefone",type:"tel",value:u.telefone,onChange:H=>f({...u,telefone:Git(H.target.value)}),placeholder:"(11) 99999-9999"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{htmlFor:"emailEmpresa",children:"Email da Empresa"}),a.jsx(Je,{id:"emailEmpresa",type:"email",value:u.emailEmpresa,onChange:H=>f({...u,emailEmpresa:H.target.value}),placeholder:"contato@empresa.com"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(De,{htmlFor:"endereco",children:"Endereo Completo (opcional)"}),a.jsx(Je,{id:"endereco",type:"text",value:u.endereco,onChange:H=>f({...u,endereco:H.target.value}),placeholder:"Rua X, 123, Bairro, Cidade - UF"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(ce,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[a.jsx(qy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsxs(ce,{type:"button",onClick:x,className:"flex-1",children:["Prximo",a.jsx(_2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step3"),D=()=>a.jsxs(Pr.div,{variants:dv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(Of,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Configurao Inicial"}),a.jsx("p",{className:"text-text-muted",children:"Adicione dados iniciais ou pule esta etapa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Cue,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"font-semibold text-text-primary",children:"Quadras Esportivas"})]}),a.jsxs(ce,{type:"button",onClick:w,size:"sm",className:"gap-2",children:[a.jsx(ro,{className:"w-4 h-4"}),"Adicionar Quadra"]})]}),u.quadras.length>0?a.jsx("div",{className:"space-y-2",children:u.quadras.map((H,q)=>a.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[a.jsx("span",{className:"text-sm text-text-primary",children:H.nome}),a.jsx(ce,{type:"button",variant:"ghost",size:"sm",onClick:()=>j(q),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:a.jsx(yl,{className:"w-4 h-4"})})]},q))}):a.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma quadra adicionada"})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ml,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"font-semibold text-text-primary",children:"Mesas da Loja"})]}),a.jsxs(ce,{type:"button",onClick:_,size:"sm",className:"gap-2",children:[a.jsx(ro,{className:"w-4 h-4"}),"Adicionar Mesa"]})]}),u.mesas.length>0?a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:u.mesas.map((H,q)=>a.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[a.jsx("span",{className:"text-sm text-text-primary",children:H.nome}),a.jsx(ce,{type:"button",variant:"ghost",size:"sm",onClick:()=>C(q),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:a.jsx(yl,{className:"w-4 h-4"})})]},q))}):a.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma mesa adicionada"})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(_d,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"font-semibold text-text-primary",children:"Categorias de Produtos"})]}),a.jsxs(ce,{type:"button",onClick:E,size:"sm",className:"gap-2",children:[a.jsx(ro,{className:"w-4 h-4"}),"Adicionar Categoria"]})]}),u.categorias.length>0?a.jsx("div",{className:"space-y-2",children:u.categorias.map((H,q)=>a.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[a.jsx("span",{className:"text-sm text-text-primary",children:H.nome}),a.jsx(ce,{type:"button",variant:"ghost",size:"sm",onClick:()=>A(q),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:a.jsx(yl,{className:"w-4 h-4"})})]},q))}):a.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma categoria adicionada"})]}),a.jsx("div",{className:"bg-info/10 border border-info/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Ac,{className:"w-5 h-5 text-info mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Configuraes Opcionais"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Voc pode adicionar quadras, mesas e categorias agora ou configurar depois no sistema."})]})]})}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(ce,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[a.jsx(qy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsxs(ce,{type:"button",onClick:x,className:"flex-1",children:["Prximo",a.jsx(_2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step4"),U=()=>a.jsxs(Pr.div,{variants:dv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(Ds,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Reviso Final"}),a.jsx("p",{className:"text-text-muted",children:"Confira os dados antes de criar a empresa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[a.jsx(Ou,{className:"w-5 h-5"}),"Primeiro Usurio"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Email:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.email})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Nome:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.nomeUsuario})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Cargo:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.cargo})]})]})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[a.jsx(T_,{className:"w-5 h-5"}),"Empresa"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Razo Social:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.razaoSocial})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Nome Fantasia:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.nomeFantasia})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"CNPJ:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.cnpj})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Email:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.emailEmpresa})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Telefone:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.telefone})]}),u.endereco&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Endereo:"}),a.jsx("span",{className:"text-text-primary font-medium text-right",children:u.endereco})]})]})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[a.jsx(Of,{className:"w-5 h-5"}),"Configuraes Iniciais"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Quadras:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.quadras.length})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Mesas:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.mesas.length})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Categorias de Produtos:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.categorias.length})]})]})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Ac,{className:"w-5 h-5 text-warning mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Ateno"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Esta ao criar a empresa no banco de dados. Certifique-se de que todos os dados esto corretos."})]})]})}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(ce,{type:"button",variant:"outline",onClick:b,className:"flex-1",disabled:o,children:[a.jsx(qy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsx(ce,{type:"button",onClick:P,className:"flex-1 bg-emerald-600 hover:bg-emerald-500",disabled:o,children:o?a.jsxs(a.Fragment,{children:[a.jsx(zm,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):a.jsx(a.Fragment,{children:" Criar Empresa"})})]})]})]},"step5"),z=()=>a.jsxs(Pr.div,{variants:dv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-success/10 rounded-full mb-6",children:a.jsx(Ds,{className:"w-12 h-12 text-success"})}),a.jsx("h2",{className:"text-3xl font-bold text-text-primary mb-2",children:" Empresa Criada!"}),a.jsx("p",{className:"text-text-muted",children:"Tudo pronto para comear a usar o sistema"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-brand/10 border border-brand/30 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-text-muted mb-2",children:"Cdigo da Empresa"}),a.jsx("p",{className:"text-3xl font-bold text-brand font-mono",children:h?.codigoEmpresa})]})}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados de Acesso"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Email:"}),a.jsx("span",{className:"text-text-primary font-medium",children:h?.email})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Senha:"}),a.jsx("span",{className:"text-text-primary font-medium",children:"(a que voc definiu no Supabase)"})]})]})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados Criados"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),a.jsx("div",{className:"text-xs text-text-muted",children:"Empresa"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),a.jsx("div",{className:"text-xs text-text-muted",children:"Configuraes"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:h?.numQuadras}),a.jsx("div",{className:"text-xs text-text-muted",children:"Quadras"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:h?.numMesas}),a.jsx("div",{className:"text-xs text-text-muted",children:"Mesas"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:h?.numCategorias}),a.jsx("div",{className:"text-xs text-text-muted",children:"Categorias"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),a.jsx("div",{className:"text-xs text-text-muted",children:"Pronto para Uso"})]})]})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Ac,{className:"w-5 h-5 text-warning mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-text-primary mb-2",children:" IMPORTANTE: Execute o SQL Antes de Fazer Login"}),a.jsxs("div",{className:"space-y-2 text-xs text-text-muted",children:[a.jsx("p",{className:"font-semibold text-text-primary",children:"Para vincular seu usurio  empresa, siga estes passos:"}),a.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[a.jsxs("li",{children:["Abra o ",a.jsx("strong",{children:"Console do Navegador"})," (pressione F12)"]}),a.jsxs("li",{children:["Procure pela mensagem ",a.jsx("strong",{children:'" APS O PRIMEIRO LOGIN, execute este SQL"'})]}),a.jsx("li",{children:"Copie o comando SQL que aparece no console"}),a.jsxs("li",{children:["Acesse o ",a.jsx("strong",{children:"Supabase  SQL Editor"})]}),a.jsx("li",{children:"Cole e execute o SQL"}),a.jsx("li",{children:"Agora sim, faa login normalmente"})]}),a.jsx("p",{className:"mt-2 text-warning font-medium",children:' Se no executar o SQL, voc ver o erro "Empresa no vinculada"'})]})]})]})}),a.jsx("div",{className:"pt-4",children:a.jsx(ce,{type:"button",onClick:()=>t("/"),className:"w-full bg-brand hover:bg-brand/90",children:"Ir para Login"})})]})]},"step6");return a.jsx(a.Fragment,{children:a.jsx("div",{className:"min-h-screen bg-background text-text-primary p-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[F(),a.jsxs(sge,{mode:"wait",children:[r===1&&M(),r===2&&I(),r===3&&R(),r===4&&D(),r===5&&U(),r===6&&z()]})]})})})}const Yit=()=>a.jsx(Pr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-start mb-6",children:a.jsxs("div",{className:"flex items-end gap-3 max-w-[85%] md:max-w-[75%]",children:[a.jsx(xd,{size:"md",variant:"message"}),a.jsx("div",{className:"px-4 py-3 bg-brand border border-brand backdrop-blur-sm rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20",children:a.jsx("div",{className:"flex gap-1.5",children:[0,1,2].map(e=>a.jsx(Pr.div,{className:"w-2.5 h-2.5 md:w-2 md:h-2 bg-[#0A0A0A] rounded-full",animate:{y:[0,-6,0],opacity:[.4,1,.4]},transition:{duration:.8,repeat:1/0,delay:e*.2,ease:"easeInOut"}},e))})})]})}),Jit=({buttons:e,onSelect:t,disabled:r=!1,hideText:n=!1,hidden:o=!1})=>a.jsx(Pr.div,{initial:{opacity:0,y:10,gridTemplateRows:"1fr"},animate:{opacity:o?0:1,y:o?-8:0,gridTemplateRows:o?"0fr":"1fr"},transition:{duration:.6,ease:[.16,1,.3,1]},className:`grid ml-12 md:ml-[68px] overflow-hidden transition-all duration-500 ${o?"mb-0 md:mb-0 pointer-events-none":"mb-2 md:mb-3"}`,children:a.jsx("div",{className:"flex flex-wrap gap-2 md:gap-2.5",children:e.map((s,i)=>a.jsx(Pr.button,{initial:{opacity:0,scale:.92,y:4,filter:"blur(2px)"},animate:{opacity:o||n?0:1,scale:o?.96:1,y:o?-8:0,filter:o?"blur(3.5px)":"blur(0px)"},transition:{duration:o?.4:.45,delay:o?i*.03:.2+i*.05,ease:[.16,1,.3,1]},whileHover:{scale:r?1:1.02,y:r?0:-2},whileTap:{scale:r?1:.98},onClick:()=>!r&&t(s),disabled:r,className:`
              group relative px-5 py-3.5 md:px-6 md:py-4 rounded-xl font-semibold text-[15px] md:text-[15px]
              transition-all duration-300 ease-out
              ${r?"bg-surface/30 text-text-muted cursor-not-allowed border border-white/5":"bg-surface/70 backdrop-blur-sm text-text-primary border border-white/10 hover:border-brand/70 hover:bg-brand/10 hover:text-brand hover:shadow-lg hover:shadow-brand/20 shadow-md"}
              ${n?"opacity-0 pointer-events-none":""}
            `,children:a.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1 relative z-10",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[s.icon&&!n&&a.jsx("span",{className:`text-base md:text-lg transition-transform duration-300 ${!r&&"group-hover:scale-110"}`,children:s.icon}),!n&&a.jsx("span",{className:"font-semibold",children:s.label})]}),s.subtitle&&!n&&a.jsx("span",{className:"text-[12px] md:text-xs opacity-70 pl-6 md:pl-7 font-normal",children:s.subtitle})]})},s.value||i))})}),Qit=({children:e,onButtonClick:t,hideButtonTexts:r=!1})=>{const{messages:n,isTyping:o,chatEndRef:s}=Z4(),[i,l]=p.useState(0),[c,d]=p.useState(void 0);return p.useEffect(()=>{const u=f=>{const h=!!f?.detail?.expanded,m=typeof window<"u"&&window.innerWidth<768,v=m?280:320,g=140,y=m?8:20,x=Math.max(0,v-g+y);l(h?x:0),d(h&&m?0:void 0)};try{window.addEventListener("isis-participantes-expand",u)}catch{}return()=>{try{window.removeEventListener("isis-participantes-expand",u)}catch{}}},[]),a.jsxs("div",{className:"flex flex-col min-h-full",children:[a.jsxs("div",{className:"flex-1 px-3 md:px-6 py-4 md:py-8",style:{paddingBottom:i,paddingTop:c},children:[n.map(u=>a.jsxs(Pr.div,{layout:"position",transition:{duration:.35,ease:[.16,1,.3,1]},children:[a.jsx(rse,{message:u}),u.type==="buttons"&&u.buttons&&a.jsx("div",{className:`overflow-hidden transition-all duration-500 ${u.buttonsHidden?"max-h-0 mb-0 md:mb-0":"max-h-[480px]"}`,children:a.jsx(Jit,{buttons:u.buttons,onSelect:f=>(t||u.onButtonClick)?.(f,u.id),disabled:u.disabled,hideText:r,hidden:!!u.buttonsHidden})})]},u.id)),o&&a.jsx(Yit,{}),a.jsx("div",{ref:s})]}),a.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:e})]})},Zit=({onSubmit:e,onMudarData:t,onMudarQuadra:r,hasMultipleQuadras:n=!1,disabled:o=!1,horariosDisponiveis:s=[],esportes:i=[]})=>{const[l,c]=p.useState(""),[d,u]=p.useState(""),[f,h]=p.useState(""),m=s.map((g,y)=>{let x=s[y].fim,b=0,w=y+1;for(;w<s.length&&s[w].inicio===x;)b++,x=s[w].fim,w++;const j=b>=1;return{value:g.inicio,label:g.inicio,available:j}}),v=(()=>{if(!l)return[];const g=s.findIndex(w=>w.inicio===l);if(g===-1)return[];const y=[];let x=s[g].fim,b=0;for(let w=g+1;w<s.length;w++){const j=s[w];if(j.inicio!==x)break;b++,b>=1&&y.push({value:j.fim,label:j.fim,available:!0}),x=j.fim}return y})();return p.useEffect(()=>{l&&d&&f&&!o&&e({inicio:l,fim:d,esporte:f})},[l,d,f]),p.useEffect(()=>{l&&u("")},[l]),a.jsxs(Pr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-sm md:text-xs",children:[a.jsx(vd,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium",children:"Horrio desejado"})]}),a.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"horario-inicio",className:"text-xs text-text-muted mb-1 block",children:"Incio"}),a.jsxs(Cn,{value:l,onValueChange:c,disabled:o,children:[a.jsx(jn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:a.jsx(An,{placeholder:"Selecione"})}),a.jsx(_n,{className:"max-h-[300px] z-[60]",children:m.filter(g=>g.available).map(g=>a.jsx(nt,{value:g.value,children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(vd,{className:"w-4 h-4 opacity-80"}),g.label]})},g.value))})]})]}),a.jsx("div",{className:"text-text-muted font-bold text-lg pt-5",children:""}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"horario-fim",className:"text-xs text-text-muted mb-1 block",children:"Trmino"}),a.jsxs(Cn,{value:d,onValueChange:u,disabled:!l||o,children:[a.jsx(jn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:a.jsx(An,{placeholder:"Selecione"})}),a.jsx(_n,{className:"max-h-[300px] z-[60]",children:v.filter(g=>g.available).map(g=>a.jsx(nt,{value:g.value,children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(vd,{className:"w-4 h-4 opacity-80"}),g.label]})},g.value))})]})]})]}),a.jsxs("div",{className:"flex items-end gap-2 md:gap-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"esporte",className:"text-xs text-text-muted mb-1 block",children:"Esporte"}),a.jsxs(Cn,{value:f,onValueChange:h,disabled:o,children:[a.jsx(jn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:a.jsx(An,{placeholder:"Selecione o esporte"})}),a.jsx(_n,{className:"max-h-[300px] z-[60]",children:i.map(g=>a.jsx(nt,{value:g,children:g},g))})]})]}),t&&a.jsxs(Pr.button,{type:"button",onClick:t,disabled:o,whileHover:{scale:o?1:1.05},whileTap:{scale:o?1:.95},className:`
              px-4 py-2.5 rounded-xl font-medium text-sm
              transition-all duration-300 shrink-0
              flex items-center gap-2
              ${o?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/70 backdrop-blur-sm border border-white/10 text-text-primary hover:bg-surface/90 hover:border-white/20"}
            `,children:[a.jsx(Ns,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden md:inline",children:"Mudar Data"}),a.jsx("span",{className:"md:hidden",children:"data"})]}),n&&r&&a.jsxs(Pr.button,{type:"button",onClick:r,disabled:o,whileHover:{scale:o?1:1.05},whileTap:{scale:o?1:.95},className:`
              px-4 py-2.5 rounded-xl font-medium text-sm
              transition-all duration-300 shrink-0
              flex items-center gap-2
              ${o?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/70 backdrop-blur-sm border border-white/10 text-text-primary hover:bg-surface/90 hover:border-white/20"}
            `,children:[a.jsx(jc,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden md:inline",children:"Mudar Quadra"}),a.jsx("span",{className:"md:hidden",children:"Quadra"})]})]})]})},elt=({onSubmit:e,tipo:t,onTrocarTipo:r,disabled:n=!1,mostrarBotaoTrocar:o=!0})=>{const[s,i]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(!1);p.useEffect(()=>{i("")},[t]);const f=w=>{if(w){const j=dr(w,"dd/MM/yyyy",{locale:wa});i(j),u(!1)}},h=w=>{const j=w.replace(/\D/g,"");return j.length<=2?`(${j}`:j.length<=7?`(${j.slice(0,2)}) ${j.slice(2)}`:j.length===10?`(${j.slice(0,2)}) ${j.slice(2,6)}-${j.slice(6)}`:j.length===11?`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7)}`:`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7,11)}`},m=w=>{const j=w.replace(/\D/g,"");return j.length<=2?j:j.length<=4?`${j.slice(0,2)}/${j.slice(2)}`:j.length<=8?`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4)}`:`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4,8)}`},v=w=>{const j=w.target.value;if(t==="telefone"){const _=h(j);i(_)}else if(t==="data_custom"){const _=m(j);i(_)}else i(j)},g=w=>{if(w.preventDefault(),!(!s.trim()||n))if(t==="telefone"){const j=s.replace(/\D/g,"");j.length===11&&(e(j),i(""))}else t==="data_custom"?s.trim()&&(e(s.trim()),i("")):s.includes("@")&&s.includes(".")&&(e(s.trim()),i(""))},y=w=>{w.key==="Enter"&&(w.preventDefault(),g(w))},x=w=>{if(w.length!==10)return{valida:!1,erro:"Data incompleta"};const j=/^(\d{2})\/(\d{2})\/(\d{4})$/,_=w.match(j);if(!_)return{valida:!1,erro:"Formato invlido"};const[,C,E,A]=_,P=new Date(parseInt(A),parseInt(E)-1,parseInt(C));if(isNaN(P.getTime())||P.getDate()!==parseInt(C)||P.getMonth()!==parseInt(E)-1||P.getFullYear()!==parseInt(A))return{valida:!1,erro:"Data invlida"};const F=new Date;return F.setHours(0,0,0,0),P.setHours(0,0,0,0),P<F?{valida:!1,erro:"Data no passado"}:{valida:!0,erro:null}},b=()=>t==="telefone"?s.replace(/\D/g,"").length===11:t==="data_custom"?x(s).valida:s.includes("@")&&s.includes(".");return a.jsxs(Pr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:g,className:"flex flex-col gap-3 max-w-md mx-auto",children:[a.jsx("div",{className:"relative",children:a.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${l?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[t!=="data_custom"&&a.jsx("div",{className:`
              shrink-0 transition-colors duration-300
              ${l?"text-brand":"text-text-muted"}
            `,children:t==="telefone"?a.jsx(Bb,{className:"w-4 h-4"}):a.jsx(vx,{className:"w-4 h-4"})}),a.jsxs("div",{className:"flex-1 relative flex items-center",children:[a.jsx("input",{type:t==="data_custom"?"text":t==="telefone"?"tel":"email",value:s,onChange:v,onKeyDown:y,onFocus:()=>c(!0),onBlur:()=>c(!1),placeholder:t==="telefone"?"(00) 00000-0000":t==="data_custom"?"DD/MM/AAAA":"email@exemplo.com",disabled:n,className:`
                w-full bg-transparent text-text-primary placeholder:text-text-muted
                outline-none text-[17px] md:text-base font-medium
                ${t==="data_custom"?"pr-12":""}
                ${n?"opacity-50 cursor-not-allowed":""}
              `}),t==="data_custom"&&a.jsxs(Oc,{open:d,onOpenChange:u,children:[a.jsx(Tc,{asChild:!0,children:a.jsx(Pr.button,{type:"button",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:n,className:`
                      absolute right-1 w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-300
                      bg-brand/10 text-brand hover:bg-brand hover:text-white
                      border border-brand/20 hover:border-brand/40
                      shadow-md hover:shadow-lg hover:shadow-brand/30
                      ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
                    `,children:a.jsx(Ns,{className:"w-5 h-5"})})}),a.jsx(Hl,{className:"w-auto p-0",align:"end",children:a.jsx(Gl,{mode:"single",selected:s?(()=>{try{const[w,j,_]=s.split("/");return new Date(parseInt(_),parseInt(j)-1,parseInt(w))}catch{return}})():void 0,onSelect:f,disabled:w=>{const j=new Date;return j.setHours(0,0,0,0),w<j},initialFocus:!0})})]})]}),a.jsx(Pr.button,{type:"submit",whileHover:{scale:b()?1.1:1},whileTap:{scale:b()?.9:1},disabled:!b()||n,className:`
              shrink-0 w-9 h-9 rounded-full flex items-center justify-center transition-all duration-300
              ${b()?"bg-brand text-bg shadow-md hover:shadow-lg hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:a.jsx(d4,{className:"w-4 h-4"})})]})}),t==="telefone"&&s&&a.jsx("div",{className:"text-xs text-center",children:(()=>{const w=s.replace(/\D/g,""),j=w.length===11,_=w.length>0&&!j;return j?a.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Telefone vlido"}):_?a.jsxs("span",{className:"text-yellow-400 flex items-center justify-center gap-1",children:[" Digite todos os dgitos (",w.length,"/11)"]}):null})()}),t==="data_custom"&&s&&a.jsx("div",{className:"text-xs text-center",children:(()=>{const w=x(s);return w.valida?a.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Data vlida"}):s.length>0?a.jsxs("span",{className:"text-red-400 flex items-center justify-center gap-1",children:[" ",w.erro]}):null})()}),o&&t!=="data_custom"&&a.jsx("button",{type:"button",onClick:r,className:"text-sm text-brand/80 hover:text-brand hover:underline self-center py-1 px-3 rounded-lg hover:bg-brand/5 transition-all",children:t==="telefone"?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(vx,{className:"w-4 h-4"}),"Prefiro usar e-mail"]}):a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Bb,{className:"w-4 h-4"}),"Prefiro usar telefone"]})})]})},tlt=({onSubmit:e,disabled:t=!1,valorInicial:r=null,tipoInicial:n="telefone",onCorrigirTelefone:o,onCorrigirEmail:s})=>{const[i,l]=p.useState(""),[c,d]=p.useState(n==="telefone"&&r||""),[u,f]=p.useState(n==="email"&&r||""),[h,m]=p.useState(null),v=b=>{const w=b.replace(/\D/g,"");return w.length<=2?`(${w}`:w.length<=7?`(${w.slice(0,2)}) ${w.slice(2)}`:w.length<=11?`(${w.slice(0,2)}) ${w.slice(2,7)}-${w.slice(7,11)}`:`(${w.slice(0,2)}) ${w.slice(2,7)}-${w.slice(7,11)}`},g=b=>{const w=v(b.target.value);d(w)},y=b=>{if(b.preventDefault(),!i.trim())return;const w=c.replace(/\D/g,"").length>=10,j=u.trim().includes("@")&&u.trim().includes(".");if(!w&&!j)return;const _={nome:i.trim(),telefone:w?c.replace(/\D/g,""):null,email:j?u.trim():null};e(_)},x=()=>{if(!i.trim())return!1;const b=c.replace(/\D/g,"").length>=10,w=u.trim().includes("@")&&u.trim().includes(".");return b||w};return a.jsxs(Pr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:y,className:"flex flex-col gap-3",children:[a.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${h==="nome"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[a.jsx(Ou,{className:`w-5 h-5 transition-colors ${h==="nome"?"text-brand":"text-text-muted"}`}),a.jsx("input",{type:"text",value:i,onChange:b=>l(b.target.value),onFocus:()=>m("nome"),onBlur:()=>m(null),placeholder:"Seu nome completo",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),a.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${h==="telefone"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[a.jsx(Bb,{className:`w-5 h-5 transition-colors ${h==="telefone"?"text-brand":"text-text-muted"}`}),a.jsx("input",{type:"tel",value:c,onChange:g,onFocus:()=>m("telefone"),onBlur:()=>m(null),placeholder:"(00) 00000-0000",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),a.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${h==="email"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[a.jsx(vx,{className:`w-5 h-5 transition-colors ${h==="email"?"text-brand":"text-text-muted"}`}),a.jsx("input",{type:"email",value:u,onChange:b=>f(b.target.value),onFocus:()=>m("email"),onBlur:()=>m(null),placeholder:"email@exemplo.com (opcional)",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),(o||s)&&a.jsx("div",{className:"-mt-1 mb-1",children:n==="email"&&s?a.jsx("button",{type:"button",onClick:s,className:"text-xs text-brand/80 hover:text-brand underline underline-offset-4 px-1 py-0.5 rounded-md hover:bg-brand/5",children:"Informei o e-mail errado"}):o&&a.jsx("button",{type:"button",onClick:o,className:"text-xs text-brand/80 hover:text-brand underline underline-offset-4 px-1 py-0.5 rounded-md hover:bg-brand/5",children:"Informei o telefone errado"})}),a.jsxs(Pr.button,{type:"submit",whileHover:{scale:x()?1.02:1},whileTap:{scale:x()?.98:1},disabled:!x()||t,className:`
          flex items-center justify-center gap-2 py-3 px-6 rounded-2xl
          font-semibold text-base transition-all duration-300
          ${x()?"bg-brand text-bg shadow-lg shadow-brand/20 hover:shadow-xl hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
        `,children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}),"Continuar"]}),a.jsx("p",{className:"text-xs text-text-muted text-center",children:"Preencha pelo menos telefone ou e-mail"})]})},rlt=({participantesAtuais:e=[],onAdicionar:t,onRemover:r,onFinalizar:n,disabled:o=!1,onAdicionarLote:s,selfName:i,onFixedRolesDetected:l})=>{const[c,d]=p.useState(""),[u,f]=p.useState(!1),[h,m]=p.useState(!1),v=p.useRef(null),[g,y]=p.useState(!1),[x,b]=p.useState(""),[w,j]=p.useState(!1),[_,C]=p.useState([]),[E,A]=p.useState([]),[P,F]=p.useState({}),[M,I]=p.useState(!1),[R,D]=p.useState(!1),[U,z]=p.useState(null),[H,q]=p.useState(!1),Q=p.useRef(null),pe=p.useRef(null);p.useEffect(()=>{const ke=()=>{m(window.innerWidth<768)};return ke(),window.addEventListener("resize",ke),()=>window.removeEventListener("resize",ke)},[]),p.useEffect(()=>{if(g){const ke=document.body.style.overflow;return document.body.style.overflow="hidden",C([]),A([]),F({}),I(!1),D(!1),z(null),()=>{document.body.style.overflow=ke}}},[g]),p.useEffect(()=>{if(g&&se&&(!_||_.length===0)){const ke=V(se);C([se]),F({[ke]:!0}),z(ke),D(!0),I(!0)}},[g]);const be=ke=>ke.normalize("NFD").replace(/[\u0300-\u036f]/g,""),V=ke=>be(String(ke||"").trim().toLowerCase()).replace(/\s+/g," "),B=ke=>String(ke||"").replace(/^\s*[*-]+/g,"").replace(/^\s*\d+\s*[\-\)\.]\s*/g,"").replace(/^[\W_]+|[\W_]+$/g,"").replace(//g,"").replace(/@[\S]+/g,"").replace(/\(\s*[mf]\s*\)/gi,"").replace(/\(\s*[mf][^)]*\)?/gi,"").replace(/\s{2,}/g," ").trim(),J=ke=>/^(espera|lista\s+de\s+espera)\b/i.test(be(String(ke||"").trim().toLowerCase())),ue=ke=>/^(jogador|jogadores|goleiro|goleiros|convocado|convocados|jogadore?s)\b/i.test(be(String(ke||"").trim().toLowerCase())),Ne=ke=>{const et=be(String(ke||"")).trim().toLowerCase();return/^(jogador|jogadores|goleiro|goleiros|convocado|convocados|levantador|levantadores)\b/.test(et)||/^(lista\s+de\s+espera|convidad\w*)\b/.test(et)},Z=ke=>{const et=String(ke||"").split(/\r?\n/);let Me=!1,$e=!1;const Be=[];for(const ht of et){const zt=String(ht||"").trim();if(!zt)continue;if(J(zt)){Me=!0;continue}if(Me)continue;if(ue(zt)){$e=!0;continue}if(!$e)continue;const hr=B(zt),Mt=/[A-Za-z---]/.test(hr);hr&&hr.length>=2&&hr.length<=60&&Mt&&!/[0-9@]/.test(hr)&&Be.push(hr.split(/\s+/).map(Se=>Se&&Se[0].toUpperCase()+Se.slice(1).toLowerCase()).join(" "))}const we=new Set,He=[];for(const ht of Be){const zt=V(ht);!zt||we.has(zt)||(we.add(zt),He.push(ht))}return He},ge=ke=>/^(reservas?)\b/i.test(be(String(ke||"").trim().toLowerCase())),le=ke=>{const et=String(ke||"").split(/\r?\n/),Me=[];let $e=!1,Be=!1;for(const we of et){const He=String(we||"").trim();if(!He)continue;if(J(He)){$e=!0,Be=!1;continue}if(ue(He)||ge(He)){$e=!1,Be=!0;continue}if($e||!Be)continue;const ht=B(He),zt=/[A-Za-z---]/.test(ht);if(!(ht&&ht.length>=2&&ht.length<=60&&zt&&!/[0-9@]/.test(ht)))continue;const Mt=ht.split(/\s+/).map(Qt=>Qt&&Qt[0].toUpperCase()+Qt.slice(1).toLowerCase()).join(" ");Ne(Mt)||Me.push(Mt)}return Me};new Set((e||[]).map(ke=>V(ke.nome)));const se=i?String(i).trim():e&&e[0]&&e[0].nome?String(e[0].nome).trim():null,ee=se?V(se):null,de=ke=>be(String(ke||"").toLowerCase()).split(/\s+/).map(et=>et.trim()).filter(et=>et.length>=3),Le=ke=>{if(!se)return!1;const et=String(ke||"").trim();if(!et)return!1;if(V(et)===ee)return!0;const Me=de(se),$e=de(et);return Me.length===0||$e.length===0?!1:$e.some(Be=>Me.includes(Be))},ae=ke=>{const et=new Set;if(!ke)return et;const Me=String(ke).split(/\r?\n/);let $e=!1;for(let Be of Me){const we=be(String(Be||"")).toLowerCase().trim();if(!$e){/^\s*[*\-]?\s*((lista\s+de\s+)?espera|convidad\w*)\b[\s:]*$/i.test(we)&&($e=!0);continue}if(/^\s*\*\s*\w+|^\s*(convocad|jogad|levanta|goleir)\w*/i.test(be(Be))){$e=!1;continue}const He=String(Be).replace(/^\s*[*\-]+\s*/g,"").replace(/^\s*\d+\)?\s*/g,"").replace(/^[\W_]+/,"").trim(),ht=/[A-Za-z---]/.test(He);He&&ht&&!/[0-9@]/.test(He)&&He.length>=2&&He.length<=60&&et.add(V(He))}return et},ie=ke=>{const et=String(ke||"").split(/\r?\n/),Me={levantadores:[],goleiros:[]};let $e=null;for(let Be of et){const we=be(String(Be||"")).toLowerCase().trim();if(/^\s*[*\-]?\s*levanta(dor|dores|dor(es)?)\b/i.test(we)){$e="levantadores";continue}if(/^\s*[*\-]?\s*goleir(o|os|a|as)\b/i.test(we)){$e="goleiros";continue}if($e){if(/(^|\s)jogador(e|es)\b/.test(we)){$e=null;continue}if(/^\s*[*\-]?\s*(convocad|lista\s+de\s+(espera|reserva)|convidad)\b/i.test(we)){$e=null;continue}if(/^\s*[*_]{1,3}\s*[a-z-]+/i.test(we)){$e=null;continue}if(/^\s*[*\-]?\s*(levanta|goleir)\b/i.test(we)){$e=null;continue}}if(!$e)continue;const He=String(Be).replace(/^\s*[*\-]+\s*/g,"").replace(/^\s*\d+\)?\s*/g,"").replace(/^[\W_]+/,"").trim(),ht=/[A-Za-z---]/.test(He);if(!(He&&ht&&!/[0-9@]/.test(He)&&He.length>=2&&He.length<=60))continue;const hr=He.toLowerCase().split(/\s+/).map(Qt=>Qt&&Qt[0].toUpperCase()+Qt.slice(1)).join(" "),Mt=V(hr);$e==="levantadores"?Me.levantadores.some(Qt=>V(Qt)===Mt)||Me.levantadores.push(hr):$e==="goleiros"&&(Me.goleiros.some(Qt=>V(Qt)===Mt)||Me.goleiros.push(hr))}return Me},dt=ke=>{ke.preventDefault(),!(!c.trim()||o)&&(t(c.trim()),d(""),setTimeout(()=>{v.current?.focus()},100))},At=ke=>{ke.key==="Enter"&&!h&&(ke.preventDefault(),ke.shiftKey?n():dt(ke))},st=async()=>{if(x.trim()){j(!0),C([]),A([]),F({});try{try{console.group("[Isis Import] start"),console.debug("[Isis Import] input.length=%s preview=%o",x.length,x.slice(0,180))}catch{}const{data:ke,error:et}=await fe.functions.invoke("parse-participants",{body:{text:x,locale:"pt-BR"}});if(et)throw et;if(ke&&typeof ke.source=="string"){console.log("[Isis Import] source=",ke.source);try{console.debug("[Isis Import] edge.meta keys=%o",Object.keys(ke||{}))}catch{}}const Me=ae(x);try{console.debug("[Isis Import] waitlist.count=%s sample=%o",Me.size,Array.from(Me).slice(0,8))}catch{}const $e=Array.isArray(ke?.roles?.levantadores)?ke.roles.levantadores:[],Be=Array.isArray(ke?.roles?.goleiros)?ke.roles.goleiros:[],we=$e.length||Be.length?{levantadores:$e,goleiros:Be}:ie(x);try{console.debug("[Isis Import] roles.edge lev=%s gol=%s",$e.length,Be.length)}catch{}try{$e.length||Be.length||console.debug("[Isis Import] roles.local lev=%s gol=%s",we.levantadores.length,we.goleiros.length)}catch{}const He=Array.isArray(ke?.extracted)?ke.extracted:[];let ht=He.filter(nr=>!Me.has(V(nr)));ht=ht.filter(nr=>!Ne(nr));try{console.debug("[Isis Import] extracted.raw=%s filtered=%s sample=%o",He.length,ht.length,ht.slice(0,10))}catch{}try{if(ht.length<6&&/(goleir|jogador)/i.test(be(x))){const ir=Z(x);try{console.debug("[Isis Import] local.mainOnly=%s sample=%o",ir.length,ir.slice(0,10))}catch{}const Ee=[...ht],qe=new Set(Ee.map(V));for(const Ge of ir){const Qe=V(Ge);!Qe||qe.has(Qe)||Me.has(Qe)||(qe.add(Qe),Ee.push(Ge))}ht=Ee.filter(Ge=>!Ne(Ge));try{console.debug("[Isis Import] boosted.count=%s",ht.length)}catch{}}}catch{}const zt=ht.some(nr=>Le(nr)),hr=Array.isArray(ke?.invalid)?ke.invalid:[],Mt=[],Qt=new Set;for(const nr of ht){const ir=B(nr);if(!ir)continue;const Ee=V(ir);if(!Ee||Qt.has(Ee))continue;Qt.add(Ee);const qe=ir.split(/\s+/).map(Ge=>Ge&&Ge[0].toUpperCase()+Ge.slice(1).toLowerCase()).join(" ");Mt.push(qe)}try{console.debug("[Isis Import] uniques.count=%s sample=%o",Mt.length,Mt.slice(0,12))}catch{}try{console.debug("[Isis Import] invalid.count=%s sample=%o",hr.length,hr.slice(0,6))}catch{}try{console.debug("[Isis Import] detectedSelf=%s self=%o",zt,se)}catch{}const Se=Z(x),kt=new Map(Se.map((nr,ir)=>[V(nr),ir])),Lt=le(x);let fr=Lt&&Lt.length?Lt.slice(0,200):(()=>{const nr=Mt.map((ir,Ee)=>({n:ir,i:Ee}));return nr.sort((ir,Ee)=>{const qe=kt.has(V(ir.n))?kt.get(V(ir.n)):Number.MAX_SAFE_INTEGER,Ge=kt.has(V(Ee.n))?kt.get(V(Ee.n)):Number.MAX_SAFE_INTEGER;return qe!==Ge?qe-Ge:ir.i-Ee.i}),nr.map(ir=>ir.n).slice(0,50)})(),yr=fr.findIndex(nr=>Le(nr));if(yr>=0){const nr=fr[yr];z(V(nr)),fr=[nr,...fr.filter((ir,Ee)=>Ee!==yr)]}else if(se){const nr=V(se);z(nr),D(!0),fr=[se,...fr]}else z(null);C(fr),A(hr);const Xt={};se&&(Xt[V(se)]=!0),Mt.slice(0,50).forEach(nr=>{Xt[V(nr)]=!0}),F(Xt),I(!0),D(zt||!!se);try{typeof l=="function"?l(we):window.dispatchEvent(new CustomEvent("isis:fixed-roles",{detail:we}))}catch{}try{console.debug("[Isis Import] final.suggested.count=%s sample=%o",fr.length,fr.slice(0,12))}catch{}try{console.groupEnd?.()}catch{}}catch(ke){try{console.error("[Isis Import] error=%o",ke)}catch{}const et=ae(x),Me=ie(x),$e=x.split(/[\n,;]+/).map(hr=>hr.trim()).filter(Boolean),Be=$e.some(hr=>{const Mt=hr.replace(/^[\W_]+|[\W_]+$/g,"");return Le(Mt)}),we=[],He=new Set;for(const hr of $e){const Mt=hr.replace(/^[\W_]+|[\W_]+$/g,""),Qt=V(Mt),Se=/[A-Za-z---]/.test(Mt);if(!(Mt.length>=2&&Mt.length<=60&&Se&&!/[0-9@]/.test(Mt))||!Qt||et.has(Qt)||He.has(Qt))continue;He.add(Qt);const Lt=Mt.toLowerCase().split(/\s+/).map(fr=>fr&&fr[0].toUpperCase()+fr.slice(1)).join(" ");we.push(Lt)}let ht=we.slice(0,50);if(se){const hr=V(se);z(hr),D(!0),ht=[se,...ht]}C(ht);const zt={};se&&(zt[V(se)]=!0),we.slice(0,50).forEach(hr=>{zt[V(hr)]=!0}),F(zt),I(!0),D(Be||!!se);try{typeof l=="function"?l(Me):window.dispatchEvent(new CustomEvent("isis:fixed-roles",{detail:Me}))}catch{}}finally{j(!1)}}},ut=ke=>{const et=V(ke);F(Me=>({...Me,[et]:!Me[et]}))},Rt=()=>{const ke={...P};_.forEach(et=>{ke[V(et)]=!0}),F(ke)},Nt=()=>{const ke={...P};_.forEach(et=>{ke[V(et)]=!1}),F(ke)},tt=()=>{const ke=_.filter(et=>{const Me=V(et);return U&&Me===U?!1:P[Me]});ke.length!==0&&(typeof s=="function"?s(ke):ke.forEach(et=>t(et)),y(!1),b(""),C([]),A([]),F({}))},he=()=>{b(""),C([]),A([]),F({}),I(!1),D(!1),z(null)};return a.jsxs(Pr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3 w-full",children:[a.jsxs("div",{ref:pe,className:"flex items-center justify-end gap-2 scroll-mt-24 md:scroll-mt-28",children:[a.jsx("button",{type:"button",disabled:o,onClick:()=>y(!0),className:`px-3 py-1.5 rounded-lg text-sm font-semibold transition-all ${o?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/80 hover:bg-surface/60 border border-white/10 text-text-primary"}`,children:"Importar lista"}),a.jsx("button",{type:"button",onClick:()=>{q(ke=>{const et=!ke;try{window.dispatchEvent(new CustomEvent("isis-participantes-expand",{detail:{expanded:et}}))}catch{}return et}),setTimeout(()=>{try{pe.current?.scrollIntoView({behavior:"smooth",block:"start"})}catch{}},50)},className:`p-2 rounded-lg border transition-all ${H?"bg-white/10 border-brand/40 text-brand shadow-sm":"hover:bg-white/10 border-white/10"}`,"aria-label":H?"Recolher lista":"Expandir lista","aria-pressed":H,children:H?a.jsx(i0,{className:"w-4 h-4"}):a.jsx(gue,{className:"w-4 h-4"})})]}),e.length>0&&a.jsx("div",{ref:Q,className:`flex flex-col gap-1.5 ${H?"max-h-[360px] md:max-h-[320px]":"max-h-[140px]"} overflow-y-auto px-1 transition-all`,children:e.map((ke,et)=>a.jsxs(Pr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm ${ke.principal?"bg-brand/10 border border-brand/30":"bg-surface/50 border border-white/10"}`,children:[a.jsx("span",{className:"w-7 shrink-0",children:a.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold ${ke.principal?"bg-brand/20 text-brand":"bg-white/10 text-text-primary"}`,children:et+1})}),a.jsx("span",{className:"text-base shrink-0",children:ke.principal?"":""}),a.jsxs("span",{className:`flex-1 font-medium truncate ${ke.principal?"text-brand":"text-text-primary"}`,children:[ke.nome,ke.principal&&a.jsx("span",{className:"ml-1.5 text-xs opacity-70",children:"(voc)"})]}),!ke.principal&&r&&a.jsx(Pr.button,{type:"button",onClick:()=>r(et),whileHover:{scale:1.1},whileTap:{scale:.9},className:"shrink-0 p-1 rounded-full hover:bg-red-500/20 text-red-400 hover:text-red-300 transition-colors",title:"Remover participante",children:a.jsx(yl,{className:"w-4 h-4"})})]},et))}),a.jsxs("form",{onSubmit:dt,className:"flex flex-col gap-2",children:[a.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${u?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[a.jsx(Uue,{className:`w-4 h-4 shrink-0 transition-colors ${u?"text-brand":"text-text-muted"}`}),a.jsx("input",{ref:v,type:"text",value:c,onChange:ke=>d(ke.target.value),onKeyDown:At,onFocus:()=>f(!0),onBlur:()=>f(!1),placeholder:h?"Nome":"Nome do participante",disabled:o,autoComplete:"off",className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base font-medium min-w-0"}),a.jsx(Pr.button,{type:"submit",whileHover:{scale:c.trim()?1.05:1},whileTap:{scale:c.trim()?.95:1},disabled:!c.trim()||o,className:`
              px-3 py-1.5 rounded-lg transition-all duration-300 text-sm font-semibold shrink-0
              ${c.trim()?"bg-brand text-bg shadow-md":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:"Adicionar"})]}),a.jsx(Pr.button,{type:"button",onClick:n,disabled:o,whileHover:{scale:o?1:1.05},whileTap:{scale:o?1:.95},className:`
            w-full px-6 py-3.5 rounded-xl font-bold text-base
            transition-all duration-300
            ${o?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-brand text-bg shadow-lg hover:shadow-xl hover:shadow-brand/30"}
          `,children:a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsx(zf,{className:"w-5 h-5"}),"Confirmar Participantes (",e.length,")"]})}),!h&&a.jsxs("p",{className:"text-xs text-text-muted text-center mt-1",children:[" ",a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Enter"})," adiciona  ",a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Shift+Enter"})," confirma"]})]}),g&&typeof document<"u"&&Qf.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[9999] overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black/75 backdrop-blur-sm",onClick:()=>!w&&y(!1)}),a.jsx("div",{className:"min-h-screen flex items-start justify-center pt-24 md:pt-16 pb-8 px-3",children:a.jsxs("div",{className:"relative w-[96vw] max-w-5xl bg-gradient-to-br from-surface via-background to-surface border border-white/10 rounded-3xl shadow-2xl flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"sticky top-0 z-10 px-5 py-4 border-b border-white/10 bg-surface/70 backdrop-blur flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(xd,{size:"sm",variant:"header"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-base md:text-lg font-extrabold text-text-primary leading-tight",children:_.length>0?"Sugestes encontradas":"Importar participantes"}),a.jsx("p",{className:"text-[11px] md:text-xs text-text-muted",children:_.length>0?`Selecione os nomes para adicionar (${_.length})`:"Cole sua lista e processe com IA"})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("button",{type:"button",disabled:w,onClick:()=>y(!1),className:"p-2 rounded-lg hover:bg-white/10",children:a.jsx(yl,{className:"w-5 h-5"})})})]}),a.jsx("div",{className:"flex-1 max-h-[70vh] overflow-y-auto p-4 md:p-5",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-full",children:[a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsx("label",{className:"text-xs text-text-muted mb-2",children:"Sua lista"}),a.jsx("textarea",{value:x,onChange:ke=>b(ke.target.value),disabled:w,placeholder:`Exemplo:
1) Joo Silva
2) Maria Clara
3) Pedro Henrique

Dica: nomes sob os cabealhos 'Lista de espera', 'Lista de reserva' ou 'Convidados' sero ignorados.

Cole sua lista (um por linha ou separados por vrgula) e clique em Processar com sis`,className:"w-full min-h-[320px] max-h-[320px] resize-none overflow-y-auto bg-surface border border-white/10 rounded-xl p-3 outline-none text-sm focus:ring-2 focus:ring-brand/40"}),a.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",onClick:he,disabled:w&&!x.trim(),className:"px-4 py-2 rounded-xl font-semibold bg-surface border border-white/10 text-text-primary hover:bg-white/10 disabled:opacity-60",children:"Apagar"}),a.jsx("button",{type:"button",onClick:st,disabled:w||!x.trim(),className:"px-5 py-2.5 rounded-xl font-semibold shadow-lg transition bg-gradient-to-r from-brand to-emerald-500 text-white hover:shadow-emerald-500/30 disabled:opacity-60 disabled:cursor-not-allowed",children:w?"Processando":"Processar com sis"})]})]}),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[a.jsx("span",{children:"Sugeridos"}),a.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:_.length})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:Rt,disabled:w,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Selecionar todos"}),a.jsx("button",{type:"button",onClick:Nt,disabled:w,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Limpar"})]})]}),a.jsx("div",{className:"min-h-[320px] max-h-[320px] overflow-y-auto border border-white/10 rounded-xl bg-surface",children:w?a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative w-5 h-5",children:[a.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-tr from-brand to-emerald-500 opacity-30"}),a.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-transparent [border-image:linear-gradient(to_right,var(--tw-gradient-from),var(--tw-gradient-to))_1] animate-spin"})]}),a.jsx("span",{className:"text-xs font-semibold text-text-primary",children:"Processando com IA"})]}),a.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-white/10 text-text-muted",children:"Premium"})]}),a.jsx("div",{className:"space-y-2",children:Array.from({length:10}).map((ke,et)=>a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded-lg bg-white/[0.03] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0 w-full",children:[a.jsx("span",{className:"w-7 shrink-0",children:a.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold bg-white/10 text-text-muted",children:et+1})}),a.jsx("div",{className:"relative h-3 w-full max-w-[220px] rounded bg-white/10 overflow-hidden",children:a.jsx("div",{className:"absolute inset-0 -translate-x-full animate-[shimmer_1.2s_infinite] bg-gradient-to-r from-transparent via-white/20 to-transparent"})})]}),a.jsx("div",{className:"h-4 w-4 rounded bg-white/10"})]},et))}),a.jsx("style",{children:"@keyframes shimmer{100%{transform:translateX(100%);}}"})]}):a.jsx("ul",{className:"divide-y divide-white/5",children:_.map((ke,et)=>{const Me=V(ke),$e=M&&R&&U&&Me===U;return a.jsxs("li",{className:`flex items-center justify-between px-3 py-2 ${$e?"bg-white/5":""}`,children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"w-7 shrink-0",children:a.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold ${$e?"bg-emerald-600/25 text-emerald-400":"bg-white/10 text-text-primary"}`,children:et+1})}),a.jsx("span",{className:"text-sm truncate pr-1",children:ke}),$e&&a.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-emerald-600/20 text-emerald-400 border border-emerald-500/30 shrink-0",children:"Voc"})]}),a.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:$e?!0:!!P[Me],onChange:()=>!$e&&ut(ke),disabled:$e})]},`${Me}-${et}`)})})}),M&&_.length===0&&x.trim()&&!w&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum nome novo encontrado."}),E.length>0&&a.jsxs("div",{className:"mt-2 text-xs text-text-muted flex items-center gap-2",children:[a.jsx("span",{children:"Ignorados"}),a.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:E.length})]}),a.jsx("div",{className:"mt-3 flex items-center justify-end",children:a.jsx("button",{type:"button",onClick:tt,disabled:w||_.filter(ke=>P[V(ke)]).length===0,className:`px-5 py-2.5 rounded-xl font-semibold ${w||_.filter(ke=>P[V(ke)]).length===0?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-emerald-600 text-white shadow-lg hover:shadow-emerald-600/30 transition"}`,children:(()=>`Adicionar selecionados (${_.reduce((et,Me)=>{const $e=V(Me);return M&&R&&U&&$e===U?et+1:et+(P[$e]?1:0)},0)})`)()})})]})]})})]})})]}),document.body)]})},nlt=({onSubmit:e,disabled:t=!1})=>{const[r,n]=p.useState(0),[o,s]=p.useState(0),[i,l]=p.useState(""),[c,d]=p.useState(!1),u=g=>{g.preventDefault(),!(r===0||t)&&e({rating:r,comentario:i.trim()||null,timestamp:new Date().toISOString()})},f=g=>{t||n(g)},h=g=>{t||s(g)},m=()=>{t||s(0)},v=o||r;return a.jsx(Pr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"w-full mb-8 md:mb-4",children:a.jsx("div",{className:"bg-background/98 backdrop-blur-3xl border-2 border-white/50 rounded-3xl p-6 md:p-8 shadow-2xl relative z-50",children:a.jsxs("form",{onSubmit:u,className:"flex flex-col gap-6",children:[a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(g=>a.jsx(Pr.button,{type:"button",onClick:()=>f(g),onMouseEnter:()=>h(g),onMouseLeave:m,disabled:t,whileHover:{scale:t?1:1.2},whileTap:{scale:t?1:.9},className:`
                    p-2 transition-all duration-200 rounded-full
                    ${t?"cursor-not-allowed":"cursor-pointer hover:bg-brand/10"}
                  `,children:a.jsx(Fue,{className:`w-8 h-8 md:w-10 md:h-10 transition-all duration-200 ${g<=v?"fill-yellow-400 text-yellow-400 drop-shadow-lg":"text-text-muted hover:text-yellow-300"}`})},g))}),r>0&&a.jsx(Pr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:a.jsxs("p",{className:"text-base font-semibold text-text-primary",children:[r===1&&" Muito ruim",r===2&&" Ruim",r===3&&" Regular",r===4&&" Bom",r===5&&" Excelente"]})})]}),r>0&&a.jsx("div",{className:"w-full h-px bg-white/10 my-2"}),r>0&&a.jsxs(Pr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3,delay:.2},className:"flex flex-col gap-4",children:[a.jsxs("label",{className:"text-base font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(Due,{className:"w-5 h-5 text-brand"}),"Comentrio (opcional)"]}),a.jsx("div",{className:`
                flex items-start gap-2 px-4 py-3 rounded-xl
                bg-background/60 backdrop-blur-sm
                border-2 transition-all duration-300
                ${c?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
              `,children:a.jsx("textarea",{value:i,onChange:g=>l(g.target.value),onFocus:()=>d(!0),onBlur:()=>d(!1),placeholder:"Conte-nos mais sobre sua experincia...",disabled:t,rows:3,maxLength:500,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base resize-none min-w-0"})}),a.jsxs("div",{className:"text-sm text-text-muted text-right",children:[i.length,"/500"]})]}),r>0&&a.jsx(Pr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},className:"mt-2 mb-4",children:a.jsxs(Pr.button,{type:"submit",disabled:t,whileHover:{scale:t?1:1.02},whileTap:{scale:t?1:.98},className:`
                w-full px-6 py-4 rounded-2xl font-bold text-lg
                transition-all duration-300 flex items-center justify-center gap-3
                shadow-xl border-2
                ${t?"bg-surface text-text-muted cursor-not-allowed border-white/10":"bg-gradient-to-r from-brand to-brand/90 text-white shadow-brand/30 hover:shadow-2xl hover:shadow-brand/40 border-brand/20 hover:from-brand/90 hover:to-brand"}
              `,children:[a.jsx(d4,{className:"w-6 h-6"}),"Enviar Avaliao"]})})]})})})},alt=({message:e="Carregando..."})=>{const t=[" sis IA iniciando..."," Processando dados em tempo real..."," IA analisando disponibilidade..."," sis aprendendo suas preferncias..."," Assistente virtual ativando..."," IA otimizando seu agendamento..."," sis calculando melhores opes..."," Sincronizando com IA..."," Inteligncia artificial carregando..."," sis processando informaes..."],r=t[Math.floor(Math.random()*t.length)];return a.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-surface/30 to-background",children:a.jsx(Pr.div,{className:"absolute inset-0 opacity-20",animate:{background:["radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 80% 50%, #FFAA33 0%, transparent 50%)","radial-gradient(circle at 50% 20%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}})}),a.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(6)].map((n,o)=>a.jsx(Pr.div,{className:"absolute w-2 h-2 rounded-full",style:{background:o%2===0?"#FF6600":"#FFAA33",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[-20,-100,-20],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},o))}),a.jsxs(Pr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.8,ease:[.22,1,.36,1]},className:"relative z-10 text-center",children:[a.jsxs("div",{className:"mb-8 flex flex-col items-center gap-6",children:[a.jsxs(Pr.div,{className:"relative",animate:{rotateY:[0,360]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:[a.jsx(Pr.div,{className:"absolute inset-0 rounded-2xl blur-xl opacity-60",style:{background:"#FFAA33"},animate:{scale:[1,1.2,1],opacity:[.4,.8,.4]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),a.jsx(Pr.div,{className:"relative w-20 h-20 md:w-24 md:h-24 rounded-2xl flex items-center justify-center",style:{background:"#FFAA33"},whileHover:{scale:1.05},children:a.jsx(jc,{className:"w-12 h-12 md:w-14 md:h-14 text-white",strokeWidth:2})})]}),a.jsxs(Pr.div,{className:"flex items-baseline gap-1",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3},children:[a.jsx(Pr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FF6600"},animate:{textShadow:["0 0 10px rgba(255, 102, 0, 0.5)","0 0 20px rgba(255, 102, 0, 0.8)","0 0 10px rgba(255, 102, 0, 0.5)"]},transition:{duration:2,repeat:1/0},children:"Fluxo"}),a.jsx(Pr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FFAA33"},animate:{textShadow:["0 0 10px rgba(255, 170, 51, 0.5)","0 0 20px rgba(255, 170, 51, 0.8)","0 0 10px rgba(255, 170, 51, 0.5)"]},transition:{duration:2,repeat:1/0,delay:.1},children:"7"}),a.jsx(Pr.span,{className:"font-medium text-4xl md:text-5xl ml-2",style:{color:"#B0B0B0"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.6},children:"Arena"})]})]}),a.jsx("div",{className:"w-64 md:w-80 mx-auto mb-6",children:a.jsx("div",{className:"h-1 bg-surface/30 rounded-full overflow-hidden",children:a.jsx(Pr.div,{className:"h-full rounded-full",style:{background:"linear-gradient(90deg, #FFAA33, #FFD700, #FFAA33)"},animate:{x:[-100,300]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},initial:{x:-100}})})}),a.jsxs(Pr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.8},className:"space-y-3",children:[a.jsx(Pr.p,{className:"text-base md:text-lg font-medium text-text-primary px-4",animate:{opacity:[.7,1,.7]},transition:{duration:1.5,repeat:1/0},children:r}),a.jsx("div",{className:"flex justify-center gap-1",children:[0,1,2].map(n=>a.jsx(Pr.div,{className:"w-2 h-2 rounded-full",style:{background:"#FFAA33"},animate:{scale:[.8,1.2,.8],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:n*.2}},n))})]})]})]})},olt={greeting:["Ol! Eu sou a Isis  Vou te ajudar a agendar sua quadra! Qual voc prefere?","Oi! Sou a Isis!  Vamos agendar? Me diz, qual quadra voc quer?","E a! Isis aqui! Bora marcar sua partida? Qual quadra te interessa?","Ol!  Prazer, sou a Isis! Qual quadra voc quer reservar?","Opa! Isis na rea! Vamos agendar sua quadra? Qual delas?","Seja bem-vindo! Sou a Isis e vou facilitar sua reserva! Qual quadra?"],afterQuadra:["Boa escolha! {quadra}  tima!  Para qual dia?","Perfeito! {quadra}  top! Qual dia voc quer?","{quadra} confirmada!  Me diz, que dia?","Show! {quadra}  sucesso aqui! Qual o dia?","Anotado! {quadra}  Agora me fala o dia:","Excelente! {quadra}  uma das melhores! Para quando?"],afterData:["Beleza! {data} anotado!  Qual horrio voc prefere?","timo! {data} t disponvel! Que horas?","{data}  logo ali!  Me diz o horrio:","Confirmado {data}! Qual horrio te atende melhor?","Perfeito! {data}  Agora escolhe o horrio:","Show! {data} t livre! Qual o melhor horrio pra voc?"],afterHorario:["{horario}  seu!  Qual modalidade?","Reservado {horario}!  Vai ser qual modalidade?","Fechou {horario}! Qual esporte?","{horario} confirmado! Me diz a modalidade:","Show! {horario}  E a modalidade ...?","Perfeito! {horario} garantido! Qual modalidade?"],afterModalidade:["{modalidade}! Massa!  Quantas pessoas vo jogar?","Vai ser {modalidade}! Legal! Quantos jogadores?","{modalidade}  bom demais!  Quantas pessoas?","Top! {modalidade}  Me diz quantas pessoas:","{modalidade} confirmado! Quantos vo jogar?","timo! {modalidade}  show! Quantos participantes?"],askNames:["Agora preciso dos nomes! Digite cada um (um por linha):","Beleza! Me manda os nomes dos participantes:","Show! Lista os nomes pra mim:","timo! Quais so os nomes?","Perfeito! Me passa os nomes de todo mundo:","Legal! Agora os nomes dos jogadores:"],askContact:["ltimos dados! Qual seu nome completo?","Agora preciso do seu nome e telefone:","Quase l! Me passa seu nome e WhatsApp:","Beleza! Seus dados para contato:","Falta pouco! Nome completo e telefone:","ltima etapa! Qual seu nome e telefone?"],reviewData:["timo! Vamos conferir tudo antes de confirmar:","Perfeito! Revisa comigo os dados:","Show! Confirma se t tudo certo:","Beleza! D uma olhada se est correto:","Legal! Vamos revisar juntos:","Massa! Confere os detalhes aqui:"],confirmation:[" Tudo certo! Agendamento #{codigo} confirmado!"," Pronto! Seu agendamento #{codigo} est garantido!"," Feito! Cdigo #{codigo} confirmado!"," Sucesso! Agendamento #{codigo} t na agenda!"," Confirmado! #{codigo}  seu!"," Show! Agendamento #{codigo} marcado!"],thankYou:["Obrigada por agendar conosco! At logo! ","Valeu! Te vejo no jogo! ","Brigada! Bom jogo! ","Obrigada! At a partida! ","Valeu pela preferncia! At breve! ","Obrigada! Qualquer coisa,  s voltar aqui! "],loading:["Deixa eu verificar...","S um momento...","Aguarda um pouquinho...","Consultando aqui...","Verificando pra voc..."],error:["Ops! Algo deu errado. Vamos tentar de novo?","Eita! Tive um problema aqui. Podemos recomear?","Putz! Deu erro. Tenta novamente?","Opa! Algo no funcionou. Vamos de novo?","Caramba! Erro aqui. Pode tentar novamente?"],noAvailability:["Puts... esse horrio j foi reservado.  Escolhe outro?","Eita! Esse j est ocupado. Que tal outro horrio?","Opa! Esse horrio acabou de ser reservado. Tem outro?","Poxa! Algum reservou esse agora mesmo. Outro horrio?","Xiii! Esse j foi. Bora escolher outro?"]},uv=(e,t={})=>{const r=olt[e];if(!r||r.length===0)return console.warn(`[Isis] Nenhuma variao encontrada para step: ${e}`),"Ol! Como posso ajudar?";const n=Math.floor(Math.random()*r.length);let o=r[n];return Object.keys(t).forEach(s=>{const i=new RegExp(`\\{${s}\\}`,"g");o=o.replace(i,t[s])}),o},tV=e=>{try{const t=JSON.parse(localStorage.getItem("isis-feedbacks")||"[]");return t.push(e),localStorage.setItem("isis-feedbacks",JSON.stringify(t)),console.log("[ISIS Feedback] Salvo localmente como fallback:",e.id),e}catch(t){return console.error("[ISIS Feedback] Erro ao salvar localmente:",t),e}},slt=async e=>{const t={id:Date.now()+Math.random().toString(36).substr(2,9),timestamp:new Date().toISOString(),estrelas:e?.rating??null,nome_cliente:e?.cliente_nome??null,empresa:e?.empresa_nome??null,projeto:"fluxo7arena",comentario:e?.comentario??null};try{const r={id:t.id,cod_cliente:e?.cliente_codigo??e?.cliente_id??e?.cod_cliente??null,nome_cliente:e?.cliente_nome||null,empresa:e?.empresa_nome||null,projeto:"fluxo7arena",nota:e?.rating??null,comentario:e?.comentario||null,conversa:Array.isArray(e?.conversaArray)?JSON.stringify(e.conversaArray):typeof e?.conversa=="string"?e.conversa:null,timestamp:t.timestamp},{error:n}=await $X.from("isis").insert(r);return n?(console.error("[Supabase ISIS] Erro ao inserir feedback:",n),tV({...t,projeto:"fluxo7arena"})):(console.log("[Supabase ISIS] Feedback inserido com sucesso:",r.id),t)}catch(r){return console.error("[Supabase ISIS] Exceo ao inserir feedback, salvando localmente:",r),tV(t)}},ilt=()=>{const{nomeFantasia:e}=ode(),t=_e.useMemo(()=>{try{if(typeof window>"u")return null;const Ee=window.location.host||"",qe="f7arena.com";if(!Ee.endsWith(qe))return null;const Ge=Ee.slice(0,-qe.length).replace(/\.$/,"");if(!Ge)return null;const Qe=Ge.toLowerCase();return Qe==="www"?null:Qe}catch{return null}},[]),r=e||t;Yi();const[n,o]=p.useState(null),{currentStep:s,selections:i,addIsisMessage:l,addIsisMessageWithButtons:c,addUserMessage:d,disableAllButtons:u,removeMessageById:f,hideButtonsInMessage:h,updateSelection:m,updateContact:v,nextStep:g,setIsLoading:y,setIsTyping:x,chatEndRef:b,sessionId:w,messages:j}=Z4(),[_,C]=p.useState(null),[E,A]=p.useState([]),[P,F]=p.useState([]),[M,I]=p.useState(!0),[R,D]=p.useState("telefone"),[U,z]=p.useState(!1),[H,q]=p.useState(null),[Q,pe]=p.useState(null),[be,V]=p.useState(!1),[B,J]=p.useState(null),[ue,Ne]=p.useState(null),Z=_e.useMemo(()=>(console.log("[Isis] Logo da empresa:",{logo_url:_?.logo_url,empresa:_}),_?.logo_url?`${_.logo_url}?v=${Date.now()}`:_?.logo_url||""),[_?.logo_url]);p.useEffect(()=>{(async()=>{if(!r){I(!1);return}try{console.log("[Isis] Buscando empresa por nome fantasia:",r);const Ge=decodeURIComponent(r).toLowerCase().replace(/[\s\-_]+/g,"").trim();console.log("[Isis] Nome normalizado para busca:",Ge);let Qe=null;try{const{data:pt,error:Et}=await fe.rpc("get_empresa_public_by_slug",{p_slug:Ge});!Et&&pt&&pt.length>0&&(Qe=pt[0])}catch{}let St=Qe||null;if(!St){const{data:pt,error:Et}=await fe.from("empresas").select("codigo_empresa, nome_fantasia, razao_social, nome, logo_url");if(!Et&&Array.isArray(pt)){const mt=pt.find(gt=>[gt?.nome_fantasia||"",gt?.razao_social||"",gt?.nome||""].some(Dt=>Dt.toLowerCase().replace(/[\s\-_]+/g,"").trim()===Ge));mt&&(St=mt)}}if(!St){console.error("[Isis] Empresa no encontrada (RPC e fallback)"),o(null),I(!1);return}console.log("[Isis] Empresa encontrada:",St),o(St.codigo_empresa),C(St),I(!1)}catch(qe){console.error("[Isis] Erro ao buscar empresa:",qe),o(null),I(!1)}})()},[r]),p.useEffect(()=>{const Ee=qe=>{try{qe.preventDefault()}catch{}J(qe)};return window.addEventListener("beforeinstallprompt",Ee),()=>window.removeEventListener("beforeinstallprompt",Ee)},[]),p.useEffect(()=>{try{if(!(new URLSearchParams(window.location.search||"").get("install")==="1"))return;const Ge=window.__installPrompt||B,Qe=()=>{const St=[" Como instalar o app:",""," Chrome (Android/PC):","  1) Toque nos 3 pontinhos () do navegador",'  2) Escolha "Instalar app" ou "Adicionar  tela inicial"','  3) Confirme em "Instalar"',""," Safari (iPhone/iPad):","  1) Toque no boto Compartilhar (quadrado com seta )",'  2) Selecione "Adicionar  Tela de Incio"','  3) Toque em "Adicionar"'].join(`
`);l(St,400),setTimeout(()=>{l("Beleza! O que voc gostaria de fazer agora?",600),setTimeout(()=>{try{st()}catch{}},800)},700)};(async()=>{try{Ge?.prompt&&(Ge===B&&J(null),Ge===window.__installPrompt&&(window.__installPrompt=null),await Ge.prompt(),await Ge.userChoice)}catch{}Qe()})()}catch{}},[B]),p.useEffect(()=>{if(console.log("[DEBUG] useEffect iniciarConversa:",{codigoEmpresa:n,loadingEmpresa:M,hasCliente:!!i.cliente,identificacaoIniciada:be,timestamp:new Date().toISOString()}),!n||M){console.log("[DEBUG] Saindo - sem cdigo ou ainda carregando");return}!i.cliente&&!be?(console.log("[DEBUG] Cliente no identificado e identificao no iniciada, agendando iniciarIdentificacao em 1s"),V(!0),setTimeout(()=>{console.log("[DEBUG] Executando iniciarIdentificacao aps delay (loading fora da tela)"),le()},2500)):console.log("[DEBUG] Cliente j identificado ou identificao j iniciada, no fazendo nada")},[n,M,i.cliente,be]),p.useEffect(()=>{(async()=>{if(!n){I(!1);return}try{console.log("[useEffect] Definindo empresa atual para RLS:",n),await fe.rpc("set_current_empresa",{empresa_codigo:String(n)}),await Rt()}catch(qe){console.error("[useEffect] Erro ao definir empresa para RLS:",qe),await Rt()}})()},[n]);const ge=()=>{const qe=new Date().getHours();return qe>=5&&qe<12?"Bom dia":qe>=12&&qe<18?"Boa tarde":"Boa noite"},le=()=>{console.log("[DEBUG] iniciarIdentificacao INICIOU:",{loadingEmpresa:M,empresa:_?.nome_fantasia,timestamp:new Date().toISOString()}),D("telefone"),z(!1);const Ee=_?.nome_fantasia||_?.razao_social||"Arena Palace",qe=ge(),Ge=[`**${qe}!** Tudo bem? 

Sou a **sis**, assistente virtual da **${Ee}** e estou aqui para tornar seu **agendamento** super fcil!

Para comear, qual seu **telefone** ou **e-mail**?`,`Hey! **${qe}!**  **sis** na rea!

Sou a assistente virtual da **${Ee}** e vim facilitar sua vida.

Bora **agendar**? Me passa seu **telefone** ou **e-mail**:`,`**${qe}!** Prazer em te atender! 

Sou a **sis** da **${Ee}**, sua assistente virtual para **agendamentos**.

Para comear, preciso do seu **telefone** ou **e-mail**:`,`Opa! **${qe}!**  **sis** aqui, sua assistente virtual da **${Ee}**!

Vamos **marcar seu horrio**?  rapidinho!

Me informa seu **telefone** ou **e-mail**:`,`**${qe}!** Seja bem-vindo! 

Eu sou a **sis**, sua assistente virtual aqui na **${Ee}**.

Vou te ajudar a **agendar seu horrio** rapidinho!

Informe seu **telefone** ou **e-mail**:`],Qe=Math.floor(Math.random()*Ge.length);console.log("[DEBUG] Mostrando indicador de digitao primeiro:",{loadingEmpresa:M,timestamp:new Date().toISOString()}),x(!0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll inicial para mostrar indicador de digitao"),b.current?.scrollIntoView({behavior:"smooth",block:"end"})},300),setTimeout(()=>{console.log("[DEBUG] Enviando mensagem da Isis aps indicador de digitao"),x(!1),l(Ge[Qe],0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll aps mensagem aparecer"),b.current?.scrollIntoView({behavior:"smooth",block:"end"})},100)},3500),setTimeout(()=>{console.log("[DEBUG] Mostrando input"),z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"end"})},200)},3500+600),g("identificacao")},se=async Ee=>{try{console.log("[DEBUG] Buscando cliente com valor:",Ee),console.log("[DEBUG] Cdigo empresa:",n);const qe=Ee.replace(/\D/g,"");if(qe.length>=10){console.log("[DEBUG] Buscando telefone:",qe);const{data:St,error:pt}=await fe.from("clientes").select("id, nome, email, telefone, whatsapp, celular1, codigo").eq("codigo_empresa",n).eq("status","active");if(pt)throw pt;console.log("[DEBUG] Total de clientes ativos:",St?.length);const Et=St?.find(mt=>{const gt=(mt.telefone||"").replace(/\D/g,""),ft=(mt.whatsapp||"").replace(/\D/g,""),Dt=(mt.celular1||"").replace(/\D/g,"");return gt.includes(qe)||ft.includes(qe)||Dt.includes(qe)});return console.log("[DEBUG] Cliente encontrado:",Et),Et||null}const{data:Ge,error:Qe}=await fe.from("clientes").select("id, nome, email, telefone, whatsapp, codigo").eq("codigo_empresa",n).eq("status","active").ilike("email",`%${Ee}%`);if(console.log("[DEBUG] Busca por email - Clientes encontrados:",Ge),Qe)throw Qe;return Ge?.[0]||null}catch(qe){return console.error("Erro ao buscar cliente:",qe),null}},ee=Ee=>{const qe=Ee.trim().split(" ").filter(Ge=>Ge);return qe.length===1?qe[0]:qe.length>=2?`${qe[0]} ${qe[1]}`:qe[0]},de=async Ee=>{if(!Ee){l("Por favor, informe a data desejada.",400);return}const qe=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,Ge=Ee.match(qe);if(!Ge){l("**Formato invlido!** Por favor, use o formato DD/MM/AAAA (exemplo: 15/12/2024)",400);return}const[,Qe,St,pt]=Ge,Et=new Date(parseInt(pt),parseInt(St)-1,parseInt(Qe));if(isNaN(Et.getTime())||Et.getDate()!==parseInt(Qe)||Et.getMonth()!==parseInt(St)-1||Et.getFullYear()!==parseInt(pt)){l("**Data invlida!** Verifique se o dia, ms e ano esto corretos.",400);return}const mt=new Date;if(mt.setHours(0,0,0,0),Et.setHours(0,0,0,0),Et<mt){l("**Data no passado!** Por favor, escolha uma data de hoje em diante.",400);return}d(Ee);const gt=dr(Et,"dd/MM/yyyy",{locale:wa}),ft=dr(Et,"EEEE",{locale:wa});y(!0);const Dt=await ke(i.quadra.id,Et);if(y(!1),Dt.fechada){if(Dt.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${gt}** (${ft}). 

**Motivo:** ${Dt.observacao}`,800);else if(Dt.motivo==="dia_semana"){const Yt=dr(Et,"EEEE",{locale:wa});l(`**Ops!** A quadra no funciona ${Yt==="domingo"||Yt==="sbado"?"aos":"s"} **${Yt}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{l("Digite **outra data** no formato DD/MM/AAAA:",1200),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},400)},1200);return}m("data",Et),z(!1),D("telefone"),l(`**Perfeito!** Data escolhida: **${gt}** (${ft}) `,600);const Ft=Dt.slots;if(Ft.length===0){l("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outra data?",800),setTimeout(()=>{perguntarData()},1200);return}const ye=et(Ft);let wt="";ye.length===1?wt=`Tenho **horrios livres** das **${ye[0].inicio}** s **${ye[0].fim}**! `:wt=`Tenho **horrios livres** ${ye.map((br,Mr)=>Mr===ye.length-1?`e das **${br.inicio}** s **${br.fim}**`:Mr===0?`das **${br.inicio}** s **${br.fim}**`:`das **${br.inicio}** s **${br.fim}**`).join(", ")}! `,l(wt,1e3),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",1200),g("horario"),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},1600)},Le=async Ee=>{if(R==="data_custom")return await de(Ee);if(!Ee){l("Por favor, informe seu telefone ou e-mail.",400);return}const qe=R==="telefone"?`(${Ee.slice(0,2)}) ${Ee.slice(2,7)}-${Ee.slice(7)}`:Ee;d(qe);const Ge=await se(Ee);if(Ge){m("cliente",Ge),z(!1);const Qe=ee(Ge.nome),St=[`**${Qe}!** `,`Opa, **${Qe}!** `,`E a, **${Qe}!** `,`**${Qe}!** Que bom te ver! `,`Fala, **${Qe}!** `,`**${Qe}!** Tudo bem? `,`Hey, **${Qe}!** `],pt=Math.floor(Math.random()*St.length);l(St[pt],600);let Et="telefone";try{Et=i?.identificacao_tipo||R||"telefone",Ne(Et==="email"?"email":"telefone")}catch{}const mt=Et==="email"?"email":"telefone";setTimeout(()=>{st(mt)},600)}else m("identificacao_valor",qe),m("identificacao_tipo",R),z(!1),l("No encontrei seu cadastro. Sem problemas! Vamos fazer rapidinho. ",800),l("Preciso de algumas informaes:",1400),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+800),g("cadastro")},ae=async Ee=>{let qe=`Nome: ${Ee.nome}`;if(Ee.telefone){const Ge=`(${Ee.telefone.slice(0,2)}) ${Ee.telefone.slice(2,7)}-${Ee.telefone.slice(7)}`;qe+=`
Telefone: ${Ge}`}Ee.email&&(qe+=`
E-mail: ${Ee.email}`),d(qe),await ie(Ee.nome,Ee.email,Ee.telefone)},ie=async(Ee,qe,Ge)=>{try{y(!0);try{if(Ge){const mt=String(Ge||"").replace(/\D/g,""),{data:gt,error:ft}=await fe.from("clientes").select("id, nome, email, telefone, whatsapp, celular1, codigo").eq("codigo_empresa",n).eq("status","active");if(!ft&&Array.isArray(gt)){const Dt=gt.find(Ft=>{const ye=(Ft.telefone||"").replace(/\D/g,""),wt=(Ft.whatsapp||"").replace(/\D/g,""),Yt=(Ft.celular1||"").replace(/\D/g,"");return ye===mt||wt===mt||Yt===mt});if(Dt){y(!1),m("cliente_sugerido",Dt),c(`Encontrei um cadastro existente para este telefone: **${ee(Dt.nome)}**.  voc?`,[{label:" Sim, sou eu",value:"confirm_cliente_existente"},{label:" No, quero corrigir",value:"corrigir_cadastro"}],200),z(!1),g("confirmar_cliente_existente");return}}}if(qe){const mt=String(qe||"").trim().toLowerCase(),{data:gt,error:ft}=await fe.from("clientes").select("id, nome, email, telefone, whatsapp, codigo").eq("codigo_empresa",n).eq("status","active").ilike("email",mt);if(!ft&&Array.isArray(gt)&&gt.length>0){const Dt=gt.find(Ft=>String(Ft.email||"").trim().toLowerCase()===mt)||null;if(Dt){y(!1),m("cliente_sugerido",Dt),c(`Este e-mail j possui cadastro: **${ee(Dt.nome)}**.  voc?`,[{label:" Sim, sou eu",value:"confirm_cliente_existente"},{label:" No, quero corrigir",value:"corrigir_cadastro"}],200),z(!1),g("confirmar_cliente_existente");return}}}}catch{}l(uv("loading"));const{data:Qe}=await fe.from("empresa_counters").select("next_cliente_codigo").eq("empresa_id",_?.id).single(),St=Qe?.next_cliente_codigo||1,{data:pt,error:Et}=await fe.from("clientes").insert({codigo_empresa:n,codigo:St,nome:Ee,email:qe||null,telefone:Ge,whatsapp:Ge,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(Et){if(Et.code==="23505"&&Et.message.includes("uq_clientes_empresa_codigo")){console.log("[Isis] Cdigo duplicado, tentando prximo cdigo...");const{data:mt,error:gt}=await fe.from("clientes").insert({codigo_empresa:n,codigo:St+1,nome:Ee,email:qe||null,telefone:Ge,whatsapp:Ge,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(gt)throw gt;await fe.from("empresa_counters").update({next_cliente_codigo:St+2}).eq("empresa_id",_?.id),y(!1),m("cliente",mt),l(`Pronto, ${Ee}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{ut()},1400);return}throw Et}await fe.from("empresa_counters").update({next_cliente_codigo:St+1}).eq("empresa_id",_?.id),y(!1),m("cliente",pt),l(`Pronto, ${Ee}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{ut()},1400)}catch(Qe){console.error("Erro ao criar cliente:",Qe),y(!1),l("Ops! Erro ao criar cadastro. Tente novamente.",400)}},dt=()=>{const Ee=new Date,qe=La(Ee,1),Ge=[{label:`Hoje (${dr(Ee,"dd/MM")})`,value:dr(Ee,"yyyy-MM-dd"),icon:"",date:Ee},{label:`Amanh (${dr(qe,"dd/MM")})`,value:dr(qe,"yyyy-MM-dd"),icon:"",date:qe},{label:"Outro dia...",value:"custom",icon:""}];c("Para qual dia voc gostaria de agendar?",Ge,600),g("data")},At=()=>{d(" Mudar Data"),z(!1),setTimeout(()=>{dt()},400)},st=(Ee=null)=>{const qe=["O que voc gostaria de fazer hoje?","Como posso te ajudar?","Qual  o plano para hoje?","O que vamos fazer?","Em que posso te auxiliar?","Qual sua necessidade hoje?","Como posso ser til?"],Ge=qe[Math.floor(Math.random()*qe.length)];let Qe=[{label:"Fazer Agendamento",value:"novo_agendamento",icon:""},{label:"Editar Agendamento",value:"buscar_agendamento",icon:""},{label:"Finalizar Atendimento",value:"finalizar_atendimento",icon:""}];const St=Ee||ue;St==="telefone"?Qe=[Qe[0],Qe[1],{label:"Informei o telefone errado",value:"corrigir_telefone",icon:""},Qe[2]]:St==="email"&&(Qe=[Qe[0],Qe[1],{label:"Informei o e-mail errado",value:"corrigir_email",icon:""},Qe[2]]),c(Ge,Qe,600),ue&&setTimeout(()=>Ne(null),0)},ut=async()=>{console.log("[iniciarAgendamento] Dados disponveis:",{quadras:E?.length||0,empresa:!!_,empresaNome:_?.nome_fantasia||_?.razao_social});let Ee=E,qe=_;if(!Ee||Ee.length===0){console.log("[iniciarAgendamento] Quadras no disponveis, carregando...");const Ge=await Rt(!1);if(Ee=Ge.quadras,qe=Ge.empresa,!Ee||Ee.length===0){console.error("[iniciarAgendamento] Quadras ainda no disponveis aps carregar!"),l("Ops! No consegui carregar as quadras. Tente novamente.",600);return}}if(!qe){console.error("[iniciarAgendamento] Empresa no disponvel!"),l("Ops! No consegui carregar os dados da empresa. Tente novamente.",600);return}setTimeout(()=>{Nt(Ee,qe,!0)},800)},Rt=async(Ee=!0)=>{try{Ee&&I(!0);const qe=Date.now(),Ge=3500;console.log("[DEBUG] Loading premium INICIOU:",{startTime:qe,minLoadingTime:Ge,timestamp:new Date().toISOString()});const{data:Qe,error:St}=await fe.from("empresas").select("*").eq("codigo_empresa",n).single();if(St)throw St;if(!Qe)return Vj({title:"Empresa no encontrada",description:"Verifique o cdigo e tente novamente",variant:"destructive"}),{empresa:null,quadras:[]};C(Qe),m("empresa",Qe);const{data:pt,error:Et}=await fe.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status, descricao").eq("codigo_empresa",String(n)).eq("status","Ativa").order("nome",{ascending:!0});if(Et)throw console.error("[loadEmpresa] Erro ao buscar quadras:",Et),Et;if(!pt||pt.length===0){console.warn("[loadEmpresa] Nenhuma quadra encontrada devido a RLS. Criando quadra temporria.");const ft=[{id:"temp-quadra-1004",nome:"Quadra Principal",modalidades:["Futebol","Futsal"],hora_inicio:"07:00:00",hora_fim:"22:00:00",valor:30,codigo_empresa:String(n),status:"Ativa",descricao:"Quadra temporria (problema de permisso)"}];return A(ft),{empresa:Qe,quadras:ft}}A(pt||[]);const mt=Date.now()-qe,gt=Math.max(0,Ge-mt);return console.log("[DEBUG] Verificando delay mnimo:",{elapsedTime:mt,remainingTime:gt,willWait:gt>0,timestamp:new Date().toISOString()}),gt>0&&(console.log("[DEBUG] Aguardando delay mnimo de",gt,"ms"),await new Promise(ft=>setTimeout(ft,gt)),console.log("[DEBUG] Delay mnimo CONCLUDO")),{empresa:Qe,quadras:pt||[]}}catch(qe){console.error("[Isis] Erro ao carregar empresa:",qe);const Ge=Date.now()-startTime,Qe=Math.max(0,minLoadingTime-Ge);return Qe>0&&await new Promise(St=>setTimeout(St,Qe)),Vj({title:"Erro ao carregar",description:"No foi possvel carregar os dados da empresa",variant:"destructive"}),{empresa:null,quadras:[]}}finally{Ee&&(console.log("[DEBUG] loadEmpresa FINALIZOU - setLoadingEmpresa(false):",{timestamp:new Date().toISOString()}),I(!1))}},Nt=(Ee,qe,Ge=!1)=>{if(console.log("[iniciarConversa] Iniciando com:",{quadras:Ee?.length||0,empresa:qe?.nome_fantasia||qe?.razao_social,jaIdentificado:Ge}),qe.nome_fantasia||qe.razao_social,ge(),Ee.length===1){console.log("[iniciarConversa] Uma quadra detectada, auto-selecionando:",Ee[0].nome);const pt=Ee[0];if(Ge){const Et=[`Perfeito! Agora vamos **agendar** seu horrio na **${pt.nome}!** `,`timo! Vou te ajudar a **marcar sua partida** na **${pt.nome}!** `,`Show! Bora **agendar** a **${pt.nome}?** `,`Perfeito! Vamos **marcar sua reserva** na **${pt.nome}!** `],mt=Math.floor(Math.random()*Et.length),gt=Et[mt];l(gt)}m("quadra",pt),setTimeout(()=>{const Et=new Date,mt=La(Et,1),gt=[{label:`Hoje (${dr(Et,"dd/MM")})`,value:dr(Et,"yyyy-MM-dd"),icon:"",date:Et},{label:`Amanh (${dr(mt,"dd/MM")})`,value:dr(mt,"yyyy-MM-dd"),icon:"",date:mt},{label:"Outro dia...",value:"custom",icon:""}];c("Para qual dia voc gostaria de agendar?",gt,800),g("data")},1200);return}let Qe;if(Ge){const pt=["Qual quadra voc quer reservar? ","Qual quadra te interessa? ","Me diz, qual quadra? ","Qual quadra voc prefere? ","Bora escolher a quadra? Qual delas? "],Et=Math.floor(Math.random()*pt.length);Qe=pt[Et]}else return;const St=Ee.map(pt=>({label:pt.nome,subtitle:pt.descricao||null,value:pt.id,icon:"",quadra:pt}));c(Qe,St),g("quadra")},tt=async Ee=>{console.log("[handleQuadraSelection] Iniciando...",{button:Ee,currentStep:s});const qe=Ee.quadra;if(d(qe.nome),m("quadra",qe),s==="review"){console.log("[handleQuadraSelection] Modo edio detectado - recarregando horrios"),console.log("[handleQuadraSelection] Quadra ID:",qe.id),console.log("[handleQuadraSelection] Data:",i.data),z(!1),q("horario"),y(!0);const Et=await ke(qe.id,i.data,Q?.id);if(console.log("[handleQuadraSelection] Resultado:",Et),y(!1),Et.fechada){const gt=dr(i.data,"dd/MM/yyyy",{locale:wa}),ft=dr(i.data,"EEEE",{locale:wa});if(Et.motivo==="data_especifica")l(`**Ops!** A **${qe.nome}** estar **fechada** no dia **${gt}** (${ft}). 

**Motivo:** ${Et.observacao}`,800);else if(Et.motivo==="dia_semana"){const Dt=dr(i.data,"EEEE",{locale:wa}),Ft=Dt==="domingo"||Dt==="sbado"?"aos":"s";l(`**Ops!** A **${qe.nome}** no funciona ${Ft} **${Dt}s**. `,800)}setTimeout(()=>{l("Escolha **outra quadra** ou **mude a data**:",1200),setTimeout(()=>{dt()},400)},1600);return}const mt=Et.slots;if(mt&&mt.length>0){const gt=et(mt);let ft="";gt.length===1?ft=`Tenho **horrios livres** das **${gt[0].inicio}** s **${gt[0].fim}**! `:ft=`Tenho **horrios livres** ${gt.map((Ft,ye)=>ye===gt.length-1?`e das **${Ft.inicio}** s **${Ft.fim}**`:ye===0?`das **${Ft.inicio}** s **${Ft.fim}**`:`das **${Ft.inicio}** s **${Ft.fim}**`).join(", ")}! `,console.log("[handleQuadraSelection] Mostrando horrios disponveis e input de horrio"),l(ft,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleQuadraSelection] Ativando showInput=true"),z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleQuadraSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia. ");return}console.log("[handleQuadraSelection] Fluxo normal (no edio)");const Ge=uv("afterQuadra",{quadra:qe.nome});l(Ge,600);const Qe=new Date,St=La(Qe,1),pt=[{label:`Hoje (${dr(Qe,"dd/MM")})`,value:dr(Qe,"yyyy-MM-dd"),icon:"",date:Qe},{label:`Amanh (${dr(St,"dd/MM")})`,value:dr(St,"yyyy-MM-dd"),icon:"",date:St},{label:"Outro dia...",value:"custom",icon:""}];c("Para qual dia voc gostaria de agendar?",pt,1e3),g("data")},he=async Ee=>{if(console.log("[handleDataSelection] Iniciando...",{button:Ee,currentStep:s}),Ee.value==="custom"){d(" Outro dia..."),l("**Perfeito!** Me informe a **data desejada** no formato DD/MM/AAAA:",600),D("data_custom"),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},800);return}const qe=Ee.date;if(d(Ee.label),m("data",qe),!!i?.editing_agendamento||!!Q){console.log("[handleDataSelection] Modo edio detectado - recarregando horrios"),console.log("[handleDataSelection] Quadra ID:",i.quadra?.id),console.log("[handleDataSelection] Nova Data:",qe),z(!1),q("horario"),y(!0);const mt=await ke(i.quadra.id,qe,Q?.id);if(console.log("[handleDataSelection] Resultado:",mt),y(!1),mt.fechada){const ft=dr(qe,"dd/MM/yyyy",{locale:wa}),Dt=dr(qe,"EEEE",{locale:wa});if(mt.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${ft}** (${Dt}). 

**Motivo:** ${mt.observacao}`,800);else if(mt.motivo==="dia_semana"){const Ft=dr(qe,"EEEE",{locale:wa});l(`**Ops!** A quadra no funciona ${Ft==="domingo"||Ft==="sbado"?"aos":"s"} **${Ft}s**. `,800)}setTimeout(()=>{l("Escolha **outra data**:",1200),setTimeout(()=>{dt()},400)},1600);return}const gt=mt.slots;if(gt&&gt.length>0){const ft=et(gt);let Dt="";ft.length===1?Dt=`Tenho **horrios livres** das **${ft[0].inicio}** s **${ft[0].fim}**! `:Dt=`Tenho **horrios livres** ${ft.map((ye,wt)=>wt===ft.length-1?`e das **${ye.inicio}** s **${ye.fim}**`:wt===0?`das **${ye.inicio}** s **${ye.fim}**`:`das **${ye.inicio}** s **${ye.fim}**`).join(", ")}! `,console.log("[handleDataSelection] Mostrando horrios disponveis e input"),l(Dt,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleDataSelection] Ativando showInput=true"),z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleDataSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia.  Tente outra data.");return}console.log("[handleDataSelection] Fluxo normal (no edio)"),y(!0);const Qe=await ke(i.quadra.id,qe);if(console.log("[handleDataSelection] Resultado (fluxo normal):",Qe),y(!1),Qe.fechada){const mt=dr(qe,"dd/MM/yyyy",{locale:wa}),gt=dr(qe,"EEEE",{locale:wa});if(Qe.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${mt}** (${gt}). 

**Motivo:** ${Qe.observacao}`,800);else if(Qe.motivo==="dia_semana"){const ft=dr(qe,"EEEE",{locale:wa});l(`**Ops!** A quadra no funciona ${ft==="domingo"||ft==="sbado"?"aos":"s"} **${ft}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{l("Que tal tentar **outra data**? ",1200),setTimeout(()=>{dt()},400)},1600);return}const St=Qe.slots;if(St.length===0){console.log("[handleDataSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outro dia?");return}const pt=et(St);let Et="";pt.length===1?Et=`Tenho **horrios livres** das **${pt[0].inicio}** s **${pt[0].fim}**! `:Et=`Tenho **horrios livres** ${pt.map((gt,ft)=>ft===pt.length-1?`e das **${gt.inicio}** s **${gt.fim}**`:ft===0?`das **${gt.inicio}** s **${gt.fim}**`:`das **${gt.inicio}** s **${gt.fim}**`).join(", ")}! `,l(Et,800),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",1e3),g("horario"),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},1e3)},1e3+600)},1400)},ke=async(Ee,qe,Ge=null)=>{try{console.log("[loadHorariosDisponiveis] quadraId:",Ee),console.log("[loadHorariosDisponiveis] data:",qe);const Qe=E.find(Rr=>Rr.id===Ee);if(!Qe)return console.error("[loadHorariosDisponiveis] Quadra no encontrada:",Ee),[];console.log("[loadHorariosDisponiveis] Quadra encontrada:",Qe.nome),console.log("[loadHorariosDisponiveis] Horrio funcionamento:",Qe.hora_inicio,"-",Qe.hora_fim);const St=dr(qe,"yyyy-MM-dd"),pt=qe.getDay();console.log("[loadHorariosDisponiveis] Verificando funcionamento para:",St,"dia da semana:",pt);const{data:Et,error:mt}=await fe.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",n).eq("quadra_id",Ee).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${St}),and(tipo.eq.dia_semana,dia_semana.eq.${pt})`);if(mt)console.error("[loadHorariosDisponiveis] Erro ao buscar configuraes de funcionamento:",mt);else{console.log("[loadHorariosDisponiveis] Configuraes encontradas:",Et?.length||0);const Rr=Et?.find(ln=>ln.tipo==="data_fechamento"&&ln.data_fechamento===St);if(Rr&&!Rr.funciona)return console.log("[loadHorariosDisponiveis] Quadra fechada em data especfica:",Rr.observacao),{slots:[],fechada:!0,motivo:"data_especifica",observacao:Rr.observacao||"Fechamento especial"};const Er=Et?.find(ln=>ln.tipo==="dia_semana"&&ln.dia_semana===pt);if(Er&&!Er.funciona)return console.log("[loadHorariosDisponiveis] Quadra no funciona neste dia da semana"),{slots:[],fechada:!0,motivo:"dia_semana",observacao:`Quadra fechada s ${["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"][pt]}s`};console.log("[loadHorariosDisponiveis] Quadra funciona normalmente na data selecionada")}const gt=ko(qe),ft=La(gt,1);let Dt=fe.from("agendamentos").select("inicio, fim, status").eq("codigo_empresa",n).eq("quadra_id",Ee).gte("inicio",gt.toISOString()).lt("inicio",ft.toISOString()).neq("status","canceled");Ge&&(Dt=Dt.neq("id",Ge),console.log("[loadHorariosDisponiveis] Excluindo agendamento sendo editado:",Ge));const{data:Ft,error:ye}=await Dt;if(ye)throw ye;console.log("[loadHorariosDisponiveis] Agendamentos encontrados:",Ft?.length||0);const wt=parseInt(Qe.hora_inicio?.split(":")[0]||"6");let Yt=parseInt(Qe.hora_fim?.split(":")[0]||"24");Yt===0&&(Yt=24);const br=new Date,Mr=ko(qe).getTime()===ko(br).getTime(),Nr=[];for(let Rr=wt;Rr<Yt;Rr++)for(let Er of[0,30]){const ln=q2(B2(qe,Rr),Er),Fn=Bye(ln,30);if(Mr&&ln<br)continue;Ft?.some($n=>{const at=new Date($n.inicio),Vt=new Date($n.fim),wr=Math.floor(ln.getTime()/6e4),er=Math.floor(Fn.getTime()/6e4),Ze=Math.floor(at.getTime()/6e4),Fr=Math.floor(Vt.getTime()/6e4);return er===Ze||wr===Fr?!1:wr<Fr&&er>Ze})||Nr.push({inicio:dr(ln,"HH:mm"),fim:dr(Fn,"HH:mm"),inicioDate:ln,fimDate:Fn})}return console.log("[loadHorariosDisponiveis] Total de slots disponveis:",Nr.length),F(Nr),{slots:Nr,fechada:!1,motivo:null,observacao:null}}catch(Qe){return console.error("[loadHorariosDisponiveis] Erro ao carregar horrios:",Qe),F([]),{slots:[],fechada:!1,motivo:"erro",observacao:"Erro ao carregar horrios"}}},et=Ee=>{if(Ee.length===0)return[];const qe=[];let Ge={inicio:Ee[0].inicio,fim:Ee[0].fim};for(let St=1;St<Ee.length;St++)Ee[St].inicio===Ge.fim?Ge.fim=Ee[St].fim:(qe.push(Ge),Ge={inicio:Ee[St].inicio,fim:Ee[St].fim});qe.push(Ge);const Qe=St=>{const[pt,Et]=St.split(":").map(Number);return pt===0&&Et===0?24*60:pt*60+Et};return qe.filter(St=>Qe(St.fim)-Qe(St.inicio)>=60)},Me=({inicio:Ee,fim:qe,esporte:Ge})=>{const[Qe,St]=Ee.split(":").map(Number),[pt,Et]=qe.split(":").map(Number),mt=i.data,gt=q2(B2(mt,Qe),St),ft=pt===0&&Et===0?q2(B2(La(mt,1),0),0):q2(B2(mt,pt),Et),Dt={inicio:Ee,fim:qe,inicioDate:gt,fimDate:ft};if(d(`${Dt.inicio} - ${Dt.fim}  ${Ge}`),console.log("[handleHorarioSubmit] Atualizando horrio:",Dt),console.log("[handleHorarioSubmit] Atualizando esporte:",Ge),m("horario",Dt),m("esporte",Ge),z(!1),s==="review"||H==="horario"){setTimeout(()=>{q(null),g("review"),ht(Dt,Ge)},600);return}const Ft=[{nome:i.cliente.nome,cliente_id:i.cliente.id,principal:!0}];m("participantes",Ft);const ye=ee(i.cliente.nome);l(`Perfeito! ${ye}, voc j est na lista! `,800),l('Quer adicionar mais pessoas? Digite o nome e clique em "Adicionar" para cada um, ou finalize quando quiser.',1400),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+600),g("participantes")},$e=Ee=>{if(!Ee||!Ee.trim())return;const qe=i.participantes||[],Ge={nome:Ee.trim(),cliente_id:null,principal:!1},Qe=[...qe,Ge];m("participantes",Qe)},Be=Ee=>{if(!Array.isArray(Ee)||Ee.length===0)return;const qe=ft=>String(ft||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g," "),Ge=i.cliente,Qe=Ge?.nome?String(Ge.nome).trim():null,St=Qe?qe(Qe):null,pt=i.participantes||[],Et=pt.length>0?pt:Qe&&Ge?[{nome:Qe,cliente_id:Ge.id,principal:!0}]:[],mt=[];if(!!i?.editing_agendamento){let ft=Et.find(Dt=>Dt.principal)||(Qe&&Ge?{nome:Qe,cliente_id:Ge.id,principal:!0}:null);ft&&mt.push({...ft,principal:!0}),Ee.forEach(Dt=>{const Ft=String(Dt||"").trim();if(!Ft)return;const ye=qe(Ft);St&&ye===St||mt.push({nome:Ft,cliente_id:null,principal:!1})})}else Et.forEach(ft=>{const Dt=qe(ft.nome),Ft=St&&Dt===St;mt.push({...ft,principal:Ft})}),Ee.forEach(ft=>{const Dt=String(ft||"").trim();if(!Dt)return;const Ft=qe(Dt);St&&Ft===St||mt.push({nome:Dt,cliente_id:null,principal:!1})});mt.length===0&&Qe&&Ge&&mt.push({nome:Qe,cliente_id:Ge.id,principal:!0}),m("participantes",mt)},we=Ee=>{const qe=i.participantes||[];if(Ee===0)return;const Ge=qe.filter((Qe,St)=>St!==Ee);m("participantes",Ge)},He=()=>{const Ee=i.participantes||[];if(Ee.length===0){l("Voc precisa ter pelo menos 1 participante!",400);return}z(!1);const qe=Ee.length;if(qe===1)d(" Apenas eu por enquanto");else{const Ge=Ee.filter(Qe=>!Qe.principal).map(Qe=>Qe.nome).join(", ");d(` Eu + ${Ge} (${qe} pessoas)`)}setTimeout(()=>{q(null),ht()},600)},ht=(Ee=null,qe=null,Ge=!1,Qe=null,St=null,pt=null,Et=null)=>{const mt=Ee||i.horario,gt=qe||i.esporte,ft=Qe||i.quadra,Dt=St||i.data,Ft=pt||i.participantes||[],ye=!!(Et||i?.editing_agendamento||Q);if(console.log("[mostrarResumo] Selections atuais:",i),console.log("[mostrarResumo] Horrio usado:",mt),console.log("[mostrarResumo] Esporte usado:",gt),console.log("[mostrarResumo] Quadra atual:",ft),console.log("[mostrarResumo] Data atual:",Dt),console.log("[mostrarResumo] Modo edio inicial:",Ge),!Dt||!mt||!ft){console.error("[mostrarResumo] Dados obrigatrios faltando:",{dataFinal:Dt,horarioFinal:mt,quadraFinal:ft});return}if(!Ge){const Nn=uv("reviewData");l(Nn,400)}const wt=Ft.map((Nn,re)=>{const Te=re===0?"":"",ot=re===0?" (voc)":"";return`${Te} ${Nn.nome}${ot}`}).join(`
`),Yt=dr(Dt,"dd/MM/yyyy",{locale:wa}),br=dr(Dt,"EEEE",{locale:wa}),[Mr,Nr]=mt.inicio.split(":").map(Number),[Rr,Er]=mt.fim.split(":").map(Number);let ln=Rr*60+Er-(Mr*60+Nr);Rr===0&&Er===0&&(ln=24*60-(Mr*60+Nr));const Fn=Math.floor(ln/60),Hn=ln%60,$n=Hn>0?`${Fn}h ${Hn}min`:`${Fn}h`,at=ft.valor||0,Vt=ln/30,wr=Math.round(at*Vt*100)/100,er=wr/Ft.length;console.log("[mostrarResumo] Clculo do valor:"),console.log("- Valor por meia hora:",at),console.log("- Slots de 30min:",Vt),console.log("- Durao em minutos:",ln),console.log("- Valor total:",wr),console.log("- Participantes:",Ft.length),console.log("- Valor dividido:",er);const Ze=i?.empresa?.endereco&&String(i.empresa.endereco).trim().length>0?String(i.empresa.endereco).trim():null,Fr=Ze?`
 **Endereo**
${Ze}
`:"",jt=Nn=>{if(!Nn)return"N/A";const re=String(Nn).replace(/\D/g,"");return re.length===11?`(${re.slice(0,2)}) ${re.slice(2,7)}-${re.slice(7)}`:re.length===10?`(${re.slice(0,2)}) ${re.slice(2,6)}-${re.slice(6)}`:Nn},_r=i.cliente.telefone||i.cliente.whatsapp||null,bt=jt(_r),Wt=` **RESUMO DO AGENDAMENTO**

 **Quadra**
${ft.nome}${Fr}
 **Data**
${Yt} (${br})

 **Horrio**
${mt.inicio} s ${mt.fim}
 Durao: **${$n}**

 **Modalidade**
${gt}

 **Participantes** (${Ft.length})
${wt}

 **Valor Total**
R$ **${wr.toFixed(2).replace(".",",")}**
 **Valor Dividido**
R$ **${er.toFixed(2).replace(".",",")}** por pessoa

 **Responsvel**
${i.cliente.nome}
 ${bt}`,Zt=Ge?200:1e3,Br=Wt.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:Wt,copyable:!0,copyText:Br},Zt);const zr=[{label:ye?"Salvar Alteraes":"Confirmar Agendamento",value:ye?"confirm":"criar agendamento",icon:""}],_t=[];E.length>1&&_t.push({label:"Editar Quadra",value:"edit_quadra",icon:""}),_t.push({label:"Editar Data",value:"edit_data",icon:""}),_t.push({label:"Editar Horrio e Esporte",value:"edit_horario",icon:""}),_t.push({label:"Editar Participantes",value:"edit_participantes",icon:""}),(Ge||ye&&!i?.editing_agendamento)&&_t.push({label:"Gerar Times",value:"gerar_times",icon:""}),ye&&_t.push({label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""});const mn=[...zr,..._t];c("Est tudo correto?",mn,Ge?400:1600),g("review")},zt=(Ee,qe=!1)=>{l(qe?" **Perfeito!** Suas **alteraes** foram **salvas com sucesso!**":" **Pronto!** Seu **agendamento** foi **confirmado com sucesso!**",600,"green");const Qe=i.participantes||[],St=Qe.map(at=>` ${at.nome}`).join(`
`),pt=dr(i.data,"dd/MM/yyyy",{locale:wa}),Et=dr(i.data,"EEEE",{locale:wa}),[mt,gt]=i.horario.inicio.split(":").map(Number),[ft,Dt]=i.horario.fim.split(":").map(Number);let Ft=ft*60+Dt-(mt*60+gt);ft===0&&Dt===0&&(Ft=24*60-(mt*60+gt));const ye=Math.floor(Ft/60),wt=Ft%60,Yt=wt>0?`${ye}h ${wt}min`:`${ye}h`,br=i.quadra.valor||0,Mr=Ft/30,Nr=Math.round(br*Mr*100)/100,Rr=Qe.length>0?Nr/Qe.length:0,Er=i?.empresa?.endereco&&String(i.empresa.endereco).trim().length>0?String(i.empresa.endereco).trim():null,ln=Er?`
 **Endereo**
${Er}
`:"",Fn=` **AGENDAMENTO CONFIRMADO**

 **Cdigo:** #${Ee.codigo}

 **Local**
${i.quadra.nome}${ln}

 **Quando**
${pt} (${Et})
 ${i.horario.inicio} s ${i.horario.fim} **(${Yt})**

 **Modalidade**
${i.esporte}

 **Participantes** (${Qe.length})
${St}

 **Valor Total:** R$ **${Nr.toFixed(2).replace(".",",")}**
 **Valor Dividido:** R$ **${Rr.toFixed(2).replace(".",",")}** por pessoa

 **Responsvel:** ${i.cliente.nome}`,Hn=Fn.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:Fn,copyable:!0,copyText:Hn},1200),c("O que voc gostaria de fazer?",[{label:"Gerar Times",value:"gerar_times",icon:""},{label:"Editar Agendamento",value:"editar_agendamento",icon:""},{label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""},{label:"Finalizar Atendimento",value:"finalizar",icon:""}],1800)},hr=async()=>{try{x(!0)}catch{}try{const Ee=(i.participantes||[]).map(Ze=>String(Ze?.nome||"").trim()).filter(Boolean);if(!Ee||Ee.length===0){l("No h participantes suficientes para formar times.");return}const qe=String(i?.esporte||i?.quadra?.tipo||"").toLowerCase();let Ge=0,Qe="unknown";try{console.log("[Teams] Start generation modalidade=%o",qe)}catch{}try{const{data:Ze}=await fe.functions.invoke("infer-team-size",{body:{modalidade:qe,quadra:i?.quadra||null,totalPlayers:(i.participantes||[]).length}});try{console.log("[Teams] Edge infer-team-size response=%o",Ze)}catch{}Ze&&Number(Ze.teamSize)>0&&(Ge=Number(Ze.teamSize),Qe="edge")}catch{}if(!Ge)if(/(praia|areia)/i.test(qe)){Ge=5,Qe="fallback:beach";try{console.log("[Teams] Fallback matched: praia/areia -> teamSize=5")}catch{}}else if(/(v[o]lei|voleibol)/i.test(qe)){Ge=6,Qe="fallback:volley";try{console.log("[Teams] Fallback matched: volei/voleibol -> teamSize=6")}catch{}}else if(/(hand|handebol)/i.test(qe)){Ge=7,Qe="fallback:hand";try{console.log("[Teams] Fallback matched: handebol -> teamSize=7")}catch{}}else if(/(futsal|society)/i.test(qe)){Ge=5,Qe="fallback:futsal";try{console.log("[Teams] Fallback matched: futsal/society -> teamSize=5")}catch{}}else if(/(futebol|campo)/i.test(qe)){Ge=11,Qe="fallback:campo";try{console.log("[Teams] Fallback matched: futebol/campo -> teamSize=11")}catch{}}else{Ge=5,Qe="fallback:default";try{console.log("[Teams] Fallback matched: default -> teamSize=5")}catch{}}{const Ze=String(qe||"").toLowerCase(),Fr=/(v[o]lei|voleibol)/.test(Ze),jt=/(praia|areia)/.test(Ze),_r=Ge;Fr&&(Ge=jt?5:6),Fr&&(Qe=jt?"forced:beach":"forced:volley");try{console.log("[Teams] Normalization: isVolley=%s isBeach=%s before=%s after=%s source=%s",Fr,jt,_r,Ge,Qe)}catch{}}const St=Ze=>String(Ze||"").trim().toLowerCase(),pt=Array.isArray(i?.fixos)?i.fixos:[],Et=Array.isArray(i?.goleiros)?i.goleiros:[],mt=Array.isArray(i?.levantadores)?i.levantadores:[],gt=new Set([...pt,...Et,...mt].map(St).filter(Boolean)),ft=Ze=>gt.has(St(Ze)),Dt=(()=>{const Ze={},Fr=i?.fixoRoles;if(Fr&&typeof Fr=="object")for(const jt of Object.keys(Fr))Ze[jt]=Fr[jt];return Et.forEach(jt=>{Ze[St(jt)]="Goleiro"}),mt.forEach(jt=>{Ze[St(jt)]="Levantador"}),Ze})(),Ft=Ze=>ft(Ze)?` (${Dt[St(Ze)]||"Fixo"})`:"",ye=Ee.filter(ft),Yt=Ee.filter(Ze=>!ft(Ze)).slice();for(let Ze=Yt.length-1;Ze>0;Ze--){const Fr=Math.floor(Math.random()*(Ze+1));[Yt[Ze],Yt[Fr]]=[Yt[Fr],Yt[Ze]]}Ge<2&&(Ge=2);const br=Ze=>Ze.map((Fr,jt)=>`${jt+1}) ${Fr}${Ft(Fr)}`).join(`
`)||"",Mr=Ee.length;let Nr=0;if(Mr>=2*Ge){Nr=Math.max(2,Math.floor(Mr/Ge));try{console.log("[Teams] Brute rule: canMakeTwoBase=true -> teamCount=%s teamSize=%s",Nr,Ge)}catch{}}else{const Ze=Ge;Ge>5&&(Ge=5),Nr=Math.ceil(Mr/Ge);try{console.log("[Teams] Brute rule: canMakeTwoBase=false -> forceSize %s->%s, teamCount=%s",Ze,Ge,Nr)}catch{}}let ln=` **Times gerados (${qe?qe[0].toUpperCase()+qe.slice(1):"modalidade"})**`;const Fn=["","","","","",""],Hn=(qe||"").toLowerCase(),$n=/(fut|society|sal[a]o)/.test(Hn),at=/(v[o]lei|volei|voleibol)/.test(Hn);try{console.log("[Teams] teamSize=%s totalPlayers=%s teamCount=%s isVolleyLike=%s isSoccerLike=%s source=%s",Ge,Mr,Nr,at,$n,Qe)}catch{}if(Nr>=2){const Ze=Array.from({length:Nr},()=>[]);if($n&&Et.length>0)for(let Zt=0;Zt<Nr;Zt++){const Br=Et[Zt%Et.length],zr=Ze[Zt].some(_t=>Et.includes(_t));Ze[Zt].length<Ge&&!zr&&!Ze[Zt].includes(Br)&&Ze[Zt].push(Br)}if(at&&mt.length>0)for(let Zt=0;Zt<Nr;Zt++){const Br=mt[Zt%mt.length],zr=Ze[Zt].some(_t=>mt.includes(_t));Ze[Zt].length<Ge&&!zr&&!Ze[Zt].includes(Br)&&Ze[Zt].push(Br)}const Fr=ye.filter(Zt=>!Et.includes(Zt)&&!mt.includes(Zt));if(Fr.length>0){let Zt=0;for(const Br of Fr){let zr=0;for(;zr<Nr&&Ze[Zt].length>=Ge;)Zt=(Zt+1)%Nr,zr++;Ze[Zt].length<Ge&&Ze[Zt].push(Br),Zt=(Zt+1)%Nr}}for(const Zt of Yt){let Br=0,zr=1/0;for(let _t=0;_t<Ze.length;_t++)Ze[_t].length<zr&&Ze[_t].length<Ge&&(zr=Ze[_t].length,Br=_t);Ze[Br].length<Ge&&Ze[Br].push(Zt)}for(let Zt=0;Zt<Ze.length;Zt++)for(;Ze[Zt].length<Ge;)if($n&&Et.length>0){if(Ze[Zt].some(_t=>Et.includes(_t)))break;const zr=Et.find(_t=>!Ze[Zt].includes(_t));if(zr)Ze[Zt].push(zr);else break}else if(at&&mt.length>0){if(Ze[Zt].some(_t=>mt.includes(_t)))break;const zr=mt.find(_t=>!Ze[Zt].includes(_t));if(zr)Ze[Zt].push(zr);else break}else break;const jt=Nr*Ge,_r=Mr>jt?[...ye,...Yt].slice(jt):[];$n&&Et.length>0?_r.some(Br=>Et.includes(Br))||_r.unshift(Et[0]):at&&mt.length>0&&(_r.some(Br=>mt.includes(Br))||_r.unshift(mt[0]));try{const Zt=Ze.map(Br=>Br.length);console.log("[Teams] Final distribution teamSize=%s teams=%o reservas=%o",Ge,Zt,_r)}catch{}const bt=[];for(;_r.length>=Ge;)bt.push(_r.splice(0,Ge));Ze.concat(bt).forEach((Zt,Br)=>{const zr=Fn[Br%Fn.length];ln+=`

**${zr} Time ${Br+1} (${Zt.length})**:
${br(Zt)}`}),_r.length&&(ln+=`

** Reservas (${_r.length})**:
${br(_r)}`)}else{const Ze=[...ye,...Yt];if(Ze.length===0){l("No h participantes suficientes para formar times.");return}if(Ze.length===1)ln+=`

 Ainda no h jogadores suficientes para formar 2 times. Adicione mais participantes.`,ln+=`

** Time 1 (1)**:
1) ${Ze[0]}${Ft(Ze[0])}`;else{const Fr=Math.min(Ge,Math.ceil(Ze.length/2)),jt=Math.min(Ge,Ze.length-Fr),_r=Ze.slice(0,Fr),bt=Ze.slice(Fr,Fr+jt);ln+=`

 Jogadores insuficientes para 2 equipes completas de ${Ge}. Montei 2 times balanceados de ${_r.length} e ${bt.length}.`,ln+=`

** Time 1 (${_r.length})**:
${br(_r)}`,ln+=`

** Time 2 (${bt.length})**:
${br(bt)}`}}const Vt=ln.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:ln,copyable:!0,copyText:Vt},600);const er=[...!0?[{label:"Gerar novamente",value:"gerar_times_again",icon:""}]:[],{label:"Concluir",value:"aceitar_times",icon:""}];c("Tudo certo com os times?",er,1400)}catch{l("No foi possvel gerar times agora. Tente novamente.")}},Mt=async Ee=>{if(Ee.quadra){await tt(Ee);return}if(Ee.date){await he(Ee);return}if(Ee.agendamento){const qe=dr(new Date(Ee.agendamento.inicio),"dd/MM/yyyy",{locale:wa}),Ge=dr(new Date(Ee.agendamento.inicio),"HH:mm"),Qe=dr(new Date(Ee.agendamento.fim),"HH:mm");d(`${qe}  ${Ge}-${Qe}`),await Se(Ee.agendamento);return}switch(Ee.value){case"novo_agendamento":{d(" Fazer Agendamento");try{pe(null)}catch{}try{m("editing_agendamento",null)}catch{}try{m("quadra",null)}catch{}try{m("data",null)}catch{}try{m("horario",null)}catch{}try{m("modalidade",null)}catch{}try{m("quantidade",null)}catch{}try{m("nomes",[])}catch{}try{m("participantes",[])}catch{}try{m("levantadores",[])}catch{}try{m("goleiros",[])}catch{}try{m("fixos",[])}catch{}try{m("fixoRoles",{})}catch{}try{q(null)}catch{}try{z(!1)}catch{}await ut();break}case"buscar_agendamento":{d(" Editar Agendamento"),l("Vou buscar seus agendamentos...",600),Qt();break}case"finalizar_atendimento":{d(" Finalizar Atendimento");try{resetConversation()}catch{}l("Atendimento finalizado. Se precisar,  s me chamar de novo! ",400);break}case"corrigir_telefone":{d(" Informei o telefone errado"),m("cliente",null),m("identificacao_valor",null),D("telefone"),z(!0),g("identificacao");break}case"corrigir_email":{d(" Informei o e-mail errado"),m("cliente",null),m("identificacao_valor",null),D("email"),z(!0),g("identificacao");break}case"continuar_fluxo":{st();break}case"gerar_times":case"gerar_times_again":{d(Ee.value==="gerar_times_again"?" Gerar novamente":" Gerar Times"),await hr();break}case"aceitar_times":{d(" Concluir"),l("Beleza! O que voc gostaria de fazer agora?",400),setTimeout(()=>{st()},800);break}case"confirm":const qe=!!i?.editing_agendamento||!!Q;d(qe?" Salvar Alteraes":" Confirmar Agendamento"),qe?await yr():await Xt();break;case"criar agendamento":d(" Confirmar Agendamento"),await Xt();break;case"edit_quadra":d(" Editar Quadra");const Qe=E.map(Yt=>({label:Yt.nome,value:Yt.id,icon:"",subtitle:Yt.descricao||Yt.tipo||null,quadra:Yt}));c("Qual quadra voc quer?",Qe,600);break;case"edit_data":d(" Editar Data");const St=new Date,pt=La(St,1),Et=[{label:`Hoje (${dr(St,"dd/MM")})`,value:dr(St,"yyyy-MM-dd"),icon:"",date:St},{label:`Amanh (${dr(pt,"dd/MM")})`,value:dr(pt,"yyyy-MM-dd"),icon:"",date:pt},{label:"Outro dia...",value:"custom",icon:""}];c("Para qual dia?",Et,600),g("data");break;case"edit_horario":d(" Editar Horrio e Esporte"),z(!1),q("horario"),y(!0);const mt=await ke(i.quadra.id,i.data,Q?.id);if(y(!1),mt.fechada){const Yt=dr(i.data,"dd/MM/yyyy",{locale:wa}),br=dr(i.data,"EEEE",{locale:wa});if(mt.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${Yt}** (${br}). 

**Motivo:** ${mt.observacao}`,800);else if(mt.motivo==="dia_semana"){const Mr=dr(i.data,"EEEE",{locale:wa});l(`**Ops!** A quadra no funciona ${Mr==="domingo"||Mr==="sbado"?"aos":"s"} **${Mr}s**. `,800)}setTimeout(()=>{l("No  possvel editar o horrio. Escolha **outra data** ou **quadra**:",1200),setTimeout(()=>{dt()},400)},1600);return}const gt=mt.slots;if(gt&&gt.length>0){const Yt=et(gt);let br="";Yt.length===1?br=`Tenho **horrios livres** das **${Yt[0].inicio}** s **${Yt[0].fim}**! `:br=`Tenho **horrios livres** ${Yt.map((Nr,Rr)=>Rr===Yt.length-1?`e das **${Nr.inicio}** s **${Nr.fim}**`:Rr===0?`das **${Nr.inicio}** s **${Nr.fim}**`:`das **${Nr.inicio}** s **${Nr.fim}**`).join(", ")}! `,l(br,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else l("Ops! No encontrei **horrios disponveis**. ");break;case"edit_participantes":d(" Editar Participantes"),z(!1),q("participantes"),l("Edite a lista de participantes:",600),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},800);break;case"finalizar":d(" Finalizar Atendimento");const ft=["Pronto! Seu agendamento est confirmado! ","Perfeito! Agendamento realizado com sucesso! ","Tudo certo! Seu horrio est garantido! ","Sucesso! Agendamento confirmado! "],Dt=ft[Math.floor(Math.random()*ft.length)];l(Dt,800),setTimeout(()=>{Lt()},1400);break;case"cancelar_agendamento":d(" Cancelar Agendamento");const Ft=[{label:"Sim, cancelar",value:"confirmar_cancelamento",icon:""},{label:"No, voltar",value:"voltar_cancelamento",icon:""}],ye=["Tem certeza que deseja cancelar este agendamento?","Confirma o cancelamento do agendamento?","Realmente quer cancelar? Esta ao no pode ser desfeita.","Deseja mesmo cancelar este agendamento?"],wt=ye[Math.floor(Math.random()*ye.length)];c(wt,Ft,600);break;case"confirmar_cancelamento":await kt();break;case"voltar_cancelamento":d(" Voltar"),l("Ok! Voltando ao resumo do agendamento.",400),setTimeout(()=>{ht(null,null,!0,null,null,null,Q)},800);break;case"editar_agendamento":d(" Editar Agendamento"),l("Claro! O que voc gostaria de alterar?",600),setTimeout(()=>{ht(null,null,!0)},800);break;case"novo_agendamento":d(" Fazer Agendamento"),ut();break;case"buscar_agendamento":d(" Editar Agendamento"),l("Vou buscar seus agendamentos...",600),Qt();break;case"finalizar_atendimento":d(" Finalizar Atendimento"),Lt();break;default:console.warn("[Isis] Ao no reconhecida:",Ee.value)}},Qt=async()=>{try{console.log("[buscarAgendamentosCliente] Iniciando busca de agendamentos...");const{data:Ee,error:qe}=await fe.from("agendamentos").select(`
          id,
          codigo,
          inicio,
          fim,
          modalidade,
          status,
          valor_total,
          quadras!inner(nome, descricao, valor)
        `).eq("codigo_empresa",n).eq("cliente_id",i.cliente.id).in("status",["scheduled","confirmed"]).gte("inicio",new Date().toISOString()).order("inicio",{ascending:!0});if(qe)throw qe;if(!Ee||Ee.length===0){l("No encontrei agendamentos futuros para voc. ",800),l("Que tal fazer um novo agendamento? ",1400),setTimeout(()=>{ut()},2e3);return}if(Ee.length===1){const Ge=Ee[0],Qe=dr(new Date(Ge.inicio),"dd/MM/yyyy",{locale:wa}),St=dr(new Date(Ge.inicio),"HH:mm"),pt=dr(new Date(Ge.fim),"HH:mm");l(`Encontrei seu agendamento para ${Qe} das ${St} s ${pt} - ${Ge.modalidade}! `,800),setTimeout(()=>{Se(Ge)},1200)}else{l(`Encontrei ${Ee.length} agendamentos futuros! Qual voc quer editar?`,800);const Ge=Ee.map(Qe=>{const St=new Date(Qe.inicio),pt=dr(St,"dd/MM/yyyy",{locale:wa}),Et=dr(St,"EEEE",{locale:wa}),mt=dr(St,"HH:mm"),gt=dr(new Date(Qe.fim),"HH:mm"),ft=(new Date(Qe.fim)-St)/(1e3*60),Dt=Math.floor(ft/60),Ft=ft%60;let ye="";Dt>0?ye=Ft>0?`${Dt}h${Ft}m`:`${Dt}h`:ye=`${Ft}m`;const wt=Number(Qe.quadras?.valor??0),Yt=ft/30,Mr=(Math.round(wt*Yt*100)/100).toFixed(2).replace(".",","),Nr=new Date,Rr=new Date(Nr);Rr.setDate(Nr.getDate()+1);let Er="";return St.toDateString()===Nr.toDateString()?Er="Hoje":St.toDateString()===Rr.toDateString()?Er="Amanh":Er=`${Et.charAt(0).toUpperCase()+Et.slice(1)}, ${pt}`,{label:`${Er}  ${mt}-${gt}`,value:`editar_agendamento_${Qe.id}`,icon:"",subtitle:`${Qe.quadras?.nome||"Quadra"}  ${Qe.modalidade||""}  ${ye}`,agendamento:Qe}});setTimeout(()=>{c("Escolha o agendamento:",Ge,600)},1200)}}catch(Ee){console.error("[Isis] Erro ao buscar agendamentos:",Ee),l("Ops! Tive um problema ao buscar seus agendamentos. ",800),l("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{ut()},2e3)}},Se=async Ee=>{try{console.log("[carregarAgendamentoParaEdicao] Iniciando carregamento do agendamento:",Ee.id),console.debug("[carregarAgendamentoParaEdicao] Iniciando JOIN: agendamentos  quadras, agendamento_participantes");const{data:qe,error:Ge}=await fe.from("agendamentos").select(`
          *,
          quadras(id, nome, descricao, modalidades, valor),
          agendamento_participantes(nome, cliente_id)
        `).eq("id",Ee.id).single();if(console.debug("[carregarAgendamentoParaEdicao] Resultado JOIN:",{hasError:!!Ge,error:Ge?.message,code:Ge?.code,participantes_len:Array.isArray(qe?.agendamento_participantes)?qe.agendamento_participantes.length:null}),Ge)throw console.error("[Isis] Erro ao buscar agendamento:",Ge),new Error(`Agendamento no encontrado ou inacessvel: ${Ge.message}`);if(!qe)throw new Error("Agendamento no encontrado");const Qe=new Date(qe.inicio),St=dr(Qe,"HH:mm"),pt=dr(new Date(qe.fim),"HH:mm");let Et=qe.quadras||null;if(!Et)try{const{data:ye}=await fe.from("quadras").select("id, nome, descricao, modalidades, valor").eq("id",qe.quadra_id).single();Et=ye||null}catch{}m("quadra",Et),m("data",Qe),m("horario",{inicio:St,fim:pt,inicioDate:new Date(qe.inicio),fimDate:new Date(qe.fim)}),m("esporte",qe.modalidade);const mt=qe.cliente_id||i.cliente?.id||null;let gt=qe.agendamento_participantes||[];if(!gt||gt.length===0)try{console.debug("[carregarAgendamentoParaEdicao] JOIN sem participantes. Fazendo SELECT direto em agendamento_participantes...");const{data:ye,error:wt}=await fe.from("agendamento_participantes").select("nome, cliente_id, codigo_empresa").eq("agendamento_id",Ee.id);console.debug("[carregarAgendamentoParaEdicao] SELECT direto participantes:",{hasError:!!wt,error:wt?.message,code:wt?.code,count:Array.isArray(ye)?ye.length:null}),Array.isArray(ye)&&ye.length>0&&(gt=ye.map(Yt=>({nome:Yt.nome,cliente_id:Yt.cliente_id})))}catch(ye){console.debug("[carregarAgendamentoParaEdicao] Falha no SELECT direto participantes:",ye?.message||ye)}let ft=null;const Dt=[];gt.forEach(ye=>{const wt=mt&&ye.cliente_id===mt,Yt={nome:ye.nome,cliente_id:ye.cliente_id,principal:wt};wt&&!ft?ft=Yt:Dt.push(Yt)});const Ft=ft?[ft,...Dt.map(ye=>({...ye,principal:!1}))]:gt.map((ye,wt)=>({nome:ye.nome,cliente_id:ye.cliente_id,principal:wt===0}));m("participantes",Ft);try{m("editing_agendamento",!0)}catch{}try{const ye=qe?.meta_roles||null;if(ye&&typeof ye=="object"){const wt=Array.isArray(ye.levantadores)?ye.levantadores:[],Yt=Array.isArray(ye.goleiros)?ye.goleiros:[],br=Array.isArray(ye.fixos)?ye.fixos:Array.from(new Set([...wt,...Yt])),Mr=ye.fixoRoles&&typeof ye.fixoRoles=="object"?ye.fixoRoles:{};m("levantadores",wt),m("goleiros",Yt),m("fixos",br),m("fixoRoles",Mr)}else{const wt=`f7a:fixos:${qe.id}`,Yt=JSON.parse(localStorage.getItem(wt)||"null");if(Yt&&typeof Yt=="object"){const br=Array.isArray(Yt.levantadores)?Yt.levantadores:[],Mr=Array.isArray(Yt.goleiros)?Yt.goleiros:[],Nr=Array.isArray(Yt.fixos)?Yt.fixos:Array.from(new Set([...br,...Mr])),Rr=Yt.fixoRoles&&typeof Yt.fixoRoles=="object"?Yt.fixoRoles:{};m("levantadores",br),m("goleiros",Mr),m("fixos",Nr),m("fixoRoles",Rr)}}}catch{}pe(qe),l("Perfeito! Aqui esto os detalhes do seu agendamento:",600),setTimeout(()=>{const ye={inicio:St,fim:pt,inicioDate:new Date(qe.inicio),fimDate:new Date(qe.fim)};Et?(ht(ye,qe.modalidade,!0,Et,Qe,Ft,qe),g("review")):(l("No consegui carregar os dados da quadra deste agendamento. Vamos escolher a quadra novamente?",800),setTimeout(()=>{const wt=E.map(Yt=>({label:Yt.nome,value:Yt.id,icon:"",subtitle:Yt.descricao||Yt.tipo||null,quadra:Yt}));c("Qual quadra voc quer?",wt,600)},1200))},1400)}catch(qe){console.error("[Isis] Erro ao carregar agendamento:",qe),qe.message.includes("no encontrado")?(l("Ops! Este agendamento no foi encontrado ou pode ter sido cancelado. ",800),l("Vou buscar seus agendamentos atualizados...",1400),setTimeout(()=>{Qt()},2e3)):(l("Ops! Tive um problema ao carregar o agendamento. ",800),l("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{ut()},2e3))}},kt=async()=>{if(!Q){console.error("[Isis] Nenhum agendamento para cancelar");return}try{y(!0);const{error:Ee}=await fe.from("agendamentos").update({status:"canceled"}).eq("id",Q.id);if(Ee)throw Ee;y(!1);const qe=[" Agendamento cancelado com sucesso!"," Pronto! Seu agendamento foi cancelado."," Cancelamento realizado! Agendamento removido."," Feito! O agendamento foi cancelado com sucesso."],Ge=qe[Math.floor(Math.random()*qe.length)];l(Ge,600),pe(null),setTimeout(()=>{l("O que voc gostaria de fazer agora?",800),setTimeout(()=>{st()},1200)},1200)}catch(Ee){console.error("[Isis] Erro ao cancelar agendamento:",Ee),y(!1);const qe=uv("error");l(qe)}},Lt=()=>{u();const Ee=["Antes de finalizar, que tal me dar uma avaliao? ","Para finalizar, gostaria que avaliasse nosso atendimento! ","Quase pronto! Me ajuda com uma avaliao rpida? ","ltima etapa! Como foi nosso atendimento hoje? ","Para encerrar, que nota voc daria para nosso atendimento? ","Ei, que tal me contar como foi a experincia? ","Curiosa para saber: como voc avalia nosso atendimento? ","Rapidinho aqui: o que achou do nosso servio? ","Me conta a, como foi para voc hoje? ","Sua opinio  super importante! Como foi tudo? ","Sua avaliao nos ajuda a melhorar! Como foi? ","Para continuarmos evoluindo, como voc nos avalia? ","Queremos sempre melhorar! Que nota voc daria? ","Seu feedback  ouro para ns! Como foi o atendimento? ","Ajude-nos a ser ainda melhores! Qual sua avaliao? ","Espero ter te ajudado bem! Como voc me avalia? ","Fiz um bom trabalho hoje? Me conta sua opinio! ","Consegui resolver tudo certinho? Que tal uma avaliao? ","Antes de voc ir, me diz como foi nossa conversa? ","Sua experincia foi boa? Adoraria saber! ","Obrigada pela confiana! Como foi para voc? ","Foi um prazer te atender! Que nota voc daria? ","Agradeo pela pacincia! Como avalia nosso servio? ","Muito obrigada! Me conta como foi tudo? ","Pode ser sincero(a)! Como foi o atendimento? ","Sem papas na lngua: que nota voc daria? ","Honestamente, como voc nos avalia? ","Sua opinio real  importante! Como foi? ","Para finalizar o atendimento, preciso da sua avaliao! ","Processo quase concludo! Falta s sua avaliao! ","ltima etapa do nosso protocolo: sua opinio! ","Para encerrar com chave de ouro: como nos avalia? "],qe=Ee[Math.floor(Math.random()*Ee.length)];l(qe,800),setTimeout(()=>{z(!0),g("avaliacao"),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1200)},fr=async Ee=>{try{const qe=Array.isArray(j)?[...j]:[],Ge=`${Ee.rating} estrela${Ee.rating>1?"s":""}`,Qe=Ee.comentario?` ${Ge}
 "${Ee.comentario}"`:` ${Ge}`;d(Qe),z(!1),y(!0);const St=qe.map(Ft=>({ts:Ft.timestamp instanceof Date?Ft.timestamp.toISOString():new Date(Ft.timestamp||Date.now()).toISOString(),from:Ft.from==="isis"?"assistant":"user",text:String(Ft.text??"")}));let pt=-1;for(let Ft=St.length-1;Ft>=0;Ft--)if(St[Ft].from==="assistant"){pt=Ft;break}const Et=pt>=0?St.slice(0,pt+1):St;await slt({rating:Number(Ee.rating),comentario:Ee.comentario||null,cliente_codigo:i?.cliente?.codigo??null,cliente_nome:i?.cliente?.nome||i?.cliente?.name||null,empresa_nome:_?.nome_fantasia||_?.razao_social||"Desconhecida",conversaArray:Et}),y(!1);const mt=_?.nome_fantasia||_?.razao_social||"a empresa",gt=new Date().getHours();let ft;gt>=5&&gt<12?ft="Tenha um timo dia! ":gt>=12&&gt<18?ft="Tenha uma tima tarde! ":gt>=18&&gt<22?ft="Tenha uma tima noite! ":ft="Tenha uma boa noite! ";let Dt;if(Ee.rating>=4){const Ft=[` **Muito obrigada pela avaliao!** A **${mt}** agradece imensamente! Foi um prazer te atender! ${ft}`,` **Que bom que gostou!** A **${mt}** fica muito feliz! Volte sempre! ${ft}`,` **Perfeito!** A **${mt}** agradece de corao! Espero ter ajudado! ${ft}`,` **Adorei seu feedback!** A **${mt}** est muito grata! Nos vemos em breve! ${ft}`,` **Excelente!** A **${mt}** agradece pela confiana! At a prxima! ${ft}`,` **Uau, que nota incrvel!** A **${mt}** est nas nuvens! Obrigada! ${ft}`,` **Voc  demais!** A **${mt}** adora clientes como voc! ${ft}`,` **Top demais!** A **${mt}** se sente campe com seu feedback! ${ft}`,` **Que alegria!** A **${mt}** fica radiante com sua avaliao! ${ft}`,` **Sensacional!** A **${mt}** est celebrando sua nota! ${ft}`,` **Amei sua avaliao!** Fico feliz em saber que te atendi bem! A **${mt}** agradece! ${ft}`,` **Que feedback maravilhoso!** Me deixou super feliz! A **${mt}**  grata! ${ft}`,` **Seu carinho me emociona!** A **${mt}** tem sorte de ter voc! ${ft}`,` **Voc iluminou meu dia!** A **${mt}** agradece de todo corao! ${ft}`,` **Nota mxima!** A **${mt}** te espera sempre de braos abertos! ${ft}`,` **Cliente 5 estrelas!** A **${mt}** adora te ter aqui! Volte logo! ${ft}`,` **Voc  especial!** A **${mt}** sempre ter um lugar especial para voc! ${ft}`,` **Show de avaliao!** A **${mt}** te aguarda para a prxima apresentao! ${ft}`];Dt=Ft[Math.floor(Math.random()*Ft.length)]}else if(Ee.rating===3){const Ft=[` **Obrigada pelo feedback!** A **${mt}** vai melhorar ainda mais! ${ft}`,` **Agradecemos sua avaliao!** A **${mt}** est trabalhando para evoluir! ${ft}`,` **Obrigada!** A **${mt}** valoriza seu retorno! Foi um prazer te atender! ${ft}`,` **Toda avaliao nos faz crescer!** A **${mt}** agradece sua sinceridade! ${ft}`,` **Feedback valioso!** A **${mt}** usa cada retorno para evoluir! ${ft}`,` **Obrigada pela nota!** A **${mt}** est sempre buscando melhorar! ${ft}`,` **Seu retorno  importante!** A **${mt}** vai usar para aprimorar nosso servio! ${ft}`,` **Agradecemos a oportunidade!** A **${mt}** espera te surpreender na prxima! ${ft}`,` **Obrigada pela dica!** A **${mt}** vai trabalhar para te conquistar! ${ft}`,` **Toda crtica construtiva  bem-vinda!** A **${mt}** agradece! ${ft}`];Dt=Ft[Math.floor(Math.random()*Ft.length)]}else{const Ft=[` **Obrigada pela sinceridade.** A **${mt}** vai trabalhar para melhorar! ${ft}`,` **Agradecemos seu feedback.** A **${mt}** est comprometida em evoluir! ${ft}`,` **Obrigada por compartilhar.** A **${mt}** vai usar seu retorno para melhorar! ${ft}`,` **Lamentamos no ter atendido suas expectativas.** A **${mt}** vai se esforar mais! ${ft}`,` **Sentimos muito pela experincia.** A **${mt}** levar isso muito a srio! ${ft}`,` **Assumimos a responsabilidade.** A **${mt}** vai fazer melhor da prxima vez! ${ft}`,` **Sua insatisfao nos preocupa.** A **${mt}** vai revisar todos os processos! ${ft}`,` **Obrigada pelo alerta!** A **${mt}** espera uma nova chance de te impressionar! ${ft}`,` **Vamos melhorar!** A **${mt}** promete que da prxima vez ser diferente! ${ft}`,` **Seu feedback  nosso combustvel!** A **${mt}** vai usar para crescer! ${ft}`,` **J estamos trabalhando nas melhorias!** A **${mt}** agradece sua pacincia! ${ft}`,` **Sua honestidade  valiosa!** A **${mt}** prefere a verdade para evoluir! ${ft}`,` **Crticas nos fazem crescer!** A **${mt}** agradece sua coragem de falar! ${ft}`];Dt=Ft[Math.floor(Math.random()*Ft.length)]}l(Dt,600),setTimeout(()=>{l("Atendimento finalizado.",0,"system")},1200)}catch(qe){console.error("[Isis] Erro ao enviar avaliao:",qe),y(!1);const Ge=_?.nome_fantasia||_?.razao_social||"a empresa",Qe=new Date().getHours();let St;Qe>=5&&Qe<12?St="Tenha um timo dia! ":Qe>=12&&Qe<18?St="Tenha uma tima tarde! ":Qe>=18&&Qe<22?St="Tenha uma tima noite! ":St="Tenha uma boa noite! ";const pt=[`Ops! Tive um problema ao salvar sua avaliao, mas a **${Ge}** agradece muito seu feedback! ${St}`,` No consegui salvar sua avaliao, mas a **${Ge}** agradece imensamente! ${St}`,` Deu uma travadinha aqui, mas sua opinio j ficou guardada no meu corao! A **${Ge}** agradece! ${St}`,` Ops, falhei na tecnologia, mas no falhei em te ouvir! A **${Ge}** valoriza seu feedback! ${St}`,` Parece que o sistema deu soluo, mas sua avaliao foi ouvida! A **${Ge}** agradece! ${St}`,` A internet no colaborou, mas sua opinio chegou at mim! A **${Ge}**  grata! ${St}`,` Problema tcnico aqui, mas o importante  que voc compartilhou! A **${Ge}** agradece! ${St}`,` O sistema travou, mas sua avaliao no passou despercebida! A **${Ge}** valoriza! ${St}`],Et=pt[Math.floor(Math.random()*pt.length)];l(Et,600),setTimeout(()=>{l("Atendimento finalizado.",0,"system")},1200)}},yr=async()=>{if(!Q){console.error("[Isis] Nenhum agendamento para atualizar");return}try{y(!0);const Ee=i.cliente,qe=i.participantes||[],{data:Ge}=await fe.from("clientes").select("id").eq("codigo_empresa",n).eq("is_consumidor_final",!0).single(),Qe=qe.find(Fn=>Fn.principal),St=qe.filter(Fn=>!Fn.principal),pt=Qe?[Qe,...St]:qe,Et=pt.map(Fn=>Fn.nome),[mt,gt]=i.horario.inicio.split(":").map(Number),[ft,Dt]=i.horario.fim.split(":").map(Number);let Ft=ft*60+Dt-(mt*60+gt);ft===0&&Dt===0&&(Ft=24*60-(mt*60+gt));const ye=i.quadra.valor||0,wt=Ft/30,Yt=Math.round(ye*wt*100)/100,br={levantadores:Array.isArray(i.levantadores)?i.levantadores:[],goleiros:Array.isArray(i.goleiros)?i.goleiros:[],fixos:Array.isArray(i.fixos)?i.fixos:[],fixoRoles:i.fixoRoles&&typeof i.fixoRoles=="object"?i.fixoRoles:{}},{data:Mr,error:Nr}=await fe.from("agendamentos").update({quadra_id:i.quadra.id,clientes:Et,inicio:i.horario.inicioDate.toISOString(),fim:i.horario.fimDate.toISOString(),modalidade:i.esporte,valor_total:Yt,meta_roles:br}).eq("id",Q.id).select().single();if(Nr)throw Nr;const{error:Rr}=await fe.from("agendamento_participantes").delete().eq("agendamento_id",Q.id);if(Rr)throw Rr;const Er=pt.map((Fn,Hn)=>({agendamento_id:Mr.id,codigo_empresa:n,cliente_id:Fn.cliente_id||Ge?.id,nome:Fn.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Hn+1})),{error:ln}=await fe.from("agendamento_participantes").insert(Er);if(ln)throw ln;y(!1),pe(Mr);try{const Fn=`f7a:fixos:${Mr.id}`,Hn={levantadores:i.levantadores||[],goleiros:i.goleiros||[],fixos:i.fixos||[],fixoRoles:i.fixoRoles||{}};localStorage.setItem(Fn,JSON.stringify(Hn))}catch{}zt(Mr,!0),g("confirmation")}catch(Ee){console.error("[Isis] Erro ao atualizar agendamento:",Ee),y(!1);const qe=uv("error");l(qe)}},Xt=async()=>{try{y(!0);const Ee=i.cliente,qe=i.participantes||[],{data:Ge}=await fe.from("clientes").select("id").eq("codigo_empresa",n).eq("is_consumidor_final",!0).single(),Qe=qe.find($n=>$n.principal),St=qe.filter($n=>!$n.principal),pt=Qe?[Qe,...St]:qe,Et=pt.map($n=>$n.nome),[mt,gt]=i.horario.inicio.split(":").map(Number),[ft,Dt]=i.horario.fim.split(":").map(Number);let Ft=ft*60+Dt-(mt*60+gt);ft===0&&Dt===0&&(Ft=24*60-(mt*60+gt));const ye=i.quadra.valor||0,wt=Ft/30,Yt=Math.round(ye*wt*100)/100,br={levantadores:Array.isArray(i.levantadores)?i.levantadores:[],goleiros:Array.isArray(i.goleiros)?i.goleiros:[],fixos:Array.isArray(i.fixos)?i.fixos:[],fixoRoles:i.fixoRoles&&typeof i.fixoRoles=="object"?i.fixoRoles:{}},{data:Mr}=await fe.from("agendamentos").select("codigo").eq("codigo_empresa",n).order("codigo",{ascending:!1}).limit(1).single();let Nr=Mr?Mr.codigo+1:1;console.log("[criarAgendamento] ltimo cdigo usado:",Mr?.codigo),console.log("[criarAgendamento] Prximo cdigo inicial:",Nr);let Rr,Er=0;const ln=10;for(;!Rr&&Er<ln;){Er++,console.log("[criarAgendamento] Tentativa",Er,"com cdigo:",Nr);const{data:$n,error:at}=await fe.from("agendamentos").insert({codigo:Nr,codigo_empresa:n,quadra_id:i.quadra.id,cliente_id:Ee.id,clientes:Et,inicio:i.horario.inicioDate.toISOString(),fim:i.horario.fimDate.toISOString(),modalidade:i.esporte,status:"scheduled",valor_total:Yt,meta_roles:br,created_by_isis:!0}).select("id, codigo").single();if(at)if(at.code==="23505")console.log("[criarAgendamento] Cdigo",Nr,"j existe, tentando prximo..."),Nr++;else throw at;else Rr=$n,console.log("[criarAgendamento] Agendamento criado com cdigo:",Rr.codigo)}if(!Rr)throw new Error("No foi possvel gerar um cdigo nico aps "+ln+" tentativas");try{const{data:$n}=await fe.from("empresas").select("id").eq("codigo_empresa",n).single();$n&&(await fe.from("empresa_counters").update({next_agendamento_codigo:Rr.codigo+1}).eq("empresa_id",$n.id),console.log("[criarAgendamento] Counter atualizado para:",Rr.codigo+1))}catch($n){console.warn("[criarAgendamento] Erro ao atualizar counter:",$n)}const Fn=pt.map(($n,at)=>({codigo_empresa:n,agendamento_id:Rr.id,cliente_id:$n.principal?Ee.id:Ge?.id||null,nome:$n.nome,valor_cota:0,status_pagamento:"Pendente",ordem:at+1})),{error:Hn}=await fe.from("agendamento_participantes").insert(Fn);if(Hn)throw Hn;y(!1),pe(Rr);try{const $n=`f7a:fixos:${Rr.id}`,at={levantadores:i.levantadores||[],goleiros:i.goleiros||[],fixos:i.fixos||[],fixoRoles:i.fixoRoles||{}};localStorage.setItem($n,JSON.stringify(at))}catch{}zt(Rr),g("confirmation")}catch(Ee){console.error("[Isis] Erro ao criar agendamento:",Ee),y(!1);const qe=uv("error");l(qe),Vj({title:"Erro ao criar agendamento",description:Ee.message||"Tente novamente",variant:"destructive"})}},nr=(Ee,qe)=>{if(u(),qe)try{h(qe)}catch{}switch(s){case"quadra":tt(Ee);break;case"data":he(Ee);break;case"identificacao":Mt(Ee);break;case"review":Mt(Ee);break;case"confirmation":Mt(Ee);break;case"confirmar_cliente_existente":{const Ge=(Ee?.value||"").toString();if(Ge==="confirm_cliente_existente"){const Qe=i?.cliente_sugerido||null;if(Qe){m("cliente",Qe),m("cliente_sugerido",null);const St=ee(Qe.nome||"");l(`Perfeito, **${St}**! `,300),z(!1),setTimeout(()=>{try{st()}catch{}},700)}else z(!0),g("identificacao")}else Ge==="corrigir_cadastro"&&(l("Sem problemas! Vamos corrigir seus dados. ",300),z(!0),g("cadastro"));break}default:console.warn("[Isis] Nenhum handler para step:",s)}},ir=()=>(console.log("[renderInput] currentStep:",s,"showInput:",U),U?s==="participantes"||s==="review"&&U&&H==="participantes"?(console.log("[renderInput] Renderizando IsisParticipantesInput"),a.jsx(rlt,{participantesAtuais:i.participantes||[],onAdicionar:$e,onRemover:we,onFinalizar:He,onAdicionarLote:Be,selfName:i.cliente?.nome,onFixedRolesDetected:Ee=>{try{const qe=Array.isArray(Ee?.levantadores)?Ee.levantadores:[],Ge=Array.isArray(Ee?.goleiros)?Ee.goleiros:[],Qe=Et=>String(Et||"").trim().toLowerCase(),St=Array.from(new Set([...qe,...Ge])),pt={};qe.forEach(Et=>{pt[Qe(Et)]="Levantador"}),Ge.forEach(Et=>{pt[Qe(Et)]="Goleiro"}),m("levantadores",qe),m("goleiros",Ge),m("fixos",St),m("fixoRoles",pt),Q?.id&&(async()=>{try{const Et={levantadores:qe,goleiros:Ge,fixos:St,fixoRoles:pt};await fe.from("agendamentos").update({meta_roles:Et}).eq("id",Q.id)}catch(Et){console.debug("[Isis] Falha ao persistir meta_roles imediatos:",Et?.message||Et)}})()}catch{}}})):s==="identificacao"||R==="data_custom"?a.jsx(elt,{tipo:R,onSubmit:Le,onTrocarTipo:()=>{D(R==="telefone"?"email":"telefone")}}):s==="cadastro"?a.jsx(tlt,{onSubmit:ae,valorInicial:i.identificacao_valor,tipoInicial:i.identificacao_tipo||"telefone",onCorrigirTelefone:()=>{try{l("Sem problemas! Informe seu telefone novamente:",400)}catch{}m("cliente",null),m("identificacao_valor",null),D("telefone"),g("identificacao"),z(!0)},onCorrigirEmail:()=>{try{l("Sem problemas! Informe seu e-mail novamente:",400)}catch{}m("cliente",null),m("identificacao_valor",null),D("email"),g("identificacao"),z(!0)}}):s==="horario"||s==="review"&&U&&H==="horario"?(console.log("[renderInput] Renderizando IsisHorarioInput"),console.log("[renderInput] horariosDisponiveis:",P?.length||0),console.log("[renderInput] esportes:",i.quadra?.modalidades),a.jsx(Zit,{onSubmit:Me,onMudarData:At,onMudarQuadra:()=>{try{z(!1),q("horario"),g("review");const Ee=(E||[]).map(qe=>({label:qe.nome,value:qe.id,icon:"",subtitle:qe.descricao||qe.tipo||null,quadra:qe}));Ee.length>0&&c("Qual quadra voc quer?",Ee,600)}catch{}},hasMultipleQuadras:(E||[]).length>1,horariosDisponiveis:P,esportes:i.quadra?.modalidades||[]})):s==="avaliacao"?(console.log("[renderInput] Renderizando IsisAvaliacaoInput"),a.jsx(nlt,{onSubmit:fr})):null:(console.log("[renderInput] showInput=false, retornando null"),null));return r?M?a.jsx(alt,{message:"Preparando sua experincia..."}):_?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(Pr.header,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"bg-surface/70 backdrop-blur-xl border-b border-white/10 sticky top-0 z-20 shadow-lg",children:a.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-3 md:py-4 flex items-center justify-between gap-3 md:gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"transition-all duration-300 group-hover:scale-105",children:a.jsx(xd,{size:"md",variant:"header",className:"md:w-20 md:h-20"})}),a.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 md:w-4 md:h-4 bg-success rounded-full border-2 border-surface"})]}),a.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[a.jsx("h1",{className:"font-bold text-text-primary text-lg md:text-2xl tracking-tight leading-none",children:"sis"}),a.jsxs("div",{className:"relative group w-fit",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 blur-md opacity-60 group-hover:opacity-100 animate-pulse rounded-md"}),a.jsxs("div",{className:"relative px-2 py-0.5 md:px-2.5 md:py-1 bg-gradient-to-r from-cyan-500/20 via-purple-500/20 to-pink-500/20 backdrop-blur-sm border border-cyan-500/50 rounded-md flex items-center gap-1 md:gap-1.5 shadow-lg",children:[a.jsxs("svg",{className:"w-2.5 h-2.5 md:w-3 md:h-3 text-cyan-400",fill:"currentColor",viewBox:"0 0 20 20",children:[a.jsx("path",{d:"M13 7H7v6h6V7z"}),a.jsx("path",{fillRule:"evenodd",d:"M7 2a1 1 0 012 0v1h2V2a1 1 0 112 0v1h2a2 2 0 012 2v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v2a2 2 0 01-2 2h-2v1a1 1 0 11-2 0v-1H9v1a1 1 0 11-2 0v-1H5a2 2 0 01-2-2v-2H2a1 1 0 110-2h1V9H2a1 1 0 010-2h1V5a2 2 0 012-2h2V2zM5 5h10v10H5V5z",clipRule:"evenodd"})]}),a.jsx("span",{className:"text-[9px] md:text-[10px] font-bold bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"chat"}),a.jsxs("div",{className:"hidden md:flex gap-0.5",children:[a.jsx("span",{className:"w-1 h-1 bg-cyan-400 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),a.jsx("span",{className:"w-1 h-1 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),a.jsx("span",{className:"w-1 h-1 bg-pink-400 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]})]})]})]})]}),a.jsx("div",{className:"flex flex-1 justify-end md:justify-center",children:a.jsxs("div",{className:"group relative",children:[a.jsx("div",{className:"hidden md:block absolute inset-0 bg-gradient-to-r from-brand/20 via-brand/10 to-brand/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),a.jsxs("div",{className:"relative flex items-center gap-2.5 md:gap-3 px-4 py-2 md:px-5 md:py-2.5 bg-gradient-to-r from-surface via-surface-2 to-surface backdrop-blur-sm rounded-lg md:rounded-xl border border-brand/20 shadow-md md:shadow-lg",children:[a.jsxs("div",{className:"relative w-9 h-9 md:w-10 md:h-10 shrink-0 overflow-hidden rounded-lg border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)] group-hover:border-white/20 transition-colors duration-300",children:[Z?a.jsx("img",{src:Z,alt:"Logo da empresa",className:"w-full h-full object-cover",onError:Ee=>{Ee.target.style.display="none",Ee.target.nextSibling.style.display="block"}}):null,a.jsx(T_,{className:`w-5 h-5 md:w-6 md:h-6 opacity-80 ${Z?"hidden":"block"}`,strokeWidth:2})]}),a.jsx("h2",{className:"text-sm md:text-base font-bold text-text-primary tracking-wide truncate max-w-[140px] md:max-w-none",children:_.nome_fantasia||_.razao_social})]})]})}),a.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(jc,{className:"w-7 h-7 text-primary-foreground"})}),a.jsxs("div",{className:"hidden lg:flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})]})}),a.jsx("div",{className:"container mx-auto max-w-5xl pb-6 md:pb-6 mb-12 md:mb-0",children:a.jsx(Qit,{onButtonClick:nr,hideButtonTexts:s==="avaliacao",children:ir()})}),a.jsx(Pr.footer,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.3},className:"md:hidden fixed bottom-0 left-0 right-0 bg-surface/90 backdrop-blur-xl border-t border-white/10 z-20 shadow-lg",children:a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-6 h-6 bg-brand rounded-lg flex items-center justify-center",children:a.jsx(jc,{className:"w-4 h-4 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-sm",style:{color:"#B0B0B0"},children:" Arena"})]})]})})})]}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:a.jsxs(Pr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[a.jsx(Pr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:a.jsxs("div",{className:"relative",children:[a.jsx(xd,{size:"xl",variant:"header"}),a.jsx(Pr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),a.jsxs(Pr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[a.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[ge(),"! Tentando Agendar? "]}),a.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:[a.jsxs("p",{className:"text-xl text-text-primary mb-6 leading-relaxed",children:["Entre em contato com o dono da quadra e solicite o ",a.jsx("strong",{children:"link de agendamento"}),"."]}),a.jsxs("div",{className:"bg-surface-2/50 border border-white/5 rounded-xl p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-3 flex items-center gap-2",children:[a.jsx(RH,{className:"w-5 h-5 text-brand"}),"Formato do Link"]}),a.jsxs("div",{className:"bg-background/60 border border-white/10 rounded-lg p-4 font-mono text-base md:text-lg",children:[a.jsx("span",{className:"text-brand font-bold",children:"nomedaempresa"}),a.jsx("span",{className:"text-text-muted",children:".f7arena.com"})]}),a.jsx("p",{className:"mt-2 text-xs text-text-muted",children:"(sem traos)"})]})]})]}),a.jsx(Pr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:a.jsx(jc,{className:"w-6 h-6 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:a.jsxs(Pr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[a.jsx(Pr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:a.jsxs("div",{className:"relative",children:[a.jsx(xd,{size:"xl",variant:"header"}),a.jsx(Pr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),a.jsxs(Pr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[a.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[ge(),"! Tentando Agendar?"]}),a.jsx("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:a.jsx("p",{className:"text-xl text-text-primary mb-4 leading-relaxed",children:"Entre em contato com o dono da quadra e solicite o link de agendamento."})})]}),a.jsx(Pr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:a.jsx(jc,{className:"w-6 h-6 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})})};function rV(){return a.jsx(qX,{children:a.jsx(ilt,{})})}const nV="f740028922";function aV(e){try{return dr(e,"EEE, d 'de' MMM 's' HH:mm",{locale:wa})}catch{return""}}function oV(){const e=Ls(),t=Yi(),r=!!OS||typeof window<"u"&&localStorage.getItem("maintenance:active")==="true",[n,o]=p.useState(""),[s,i]=p.useState("");p.useEffect(()=>{try{o(localStorage.getItem("maintenance:end")||""),i(localStorage.getItem("maintenance:message")||"");const f=h=>{h.key==="maintenance:end"&&o(h.newValue||""),h.key==="maintenance:message"&&i(h.newValue||"")};return window.addEventListener("storage",f),()=>window.removeEventListener("storage",f)}catch{}},[]);const l=n||Mit||{}.VITE_MAINTENANCE_END||"",c=s&&s.trim()?s:Rit,d=p.useMemo(()=>{if(!l)return null;const f=new Date(l);return isNaN(f.getTime())?null:f},[l]),u=p.useMemo(()=>c?.trim()?c:d?`Estamos em manuteno e voltaremos at ${aV(d)}.`:"Estamos em manuteno no momento. Voltaremos em breve.",[c,d]);return p.useEffect(()=>{try{window.f7MaintenanceBypass=f=>{const h=String(f||"")===nV;if(h){try{localStorage.setItem("maintenance:bypass","1")}catch{}try{sessionStorage.setItem("maintenance:bypass","1")}catch{}try{document.cookie="fx_maint_bypass=1; path=/; max-age=2592000"}catch{}try{sessionStorage.removeItem("auth:returnUrl")}catch{}t("/login",{replace:!0})}else console.warn("[Maintenance] Senha invlida.");return h},window.f7MaintenanceReset=()=>{try{localStorage.removeItem("maintenance:bypass")}catch{}console.info("[Maintenance] Bypass removido.")}}catch{}},[t]),p.useEffect(()=>{const h=String(e.pathname||"").split("/").filter(Boolean),m=h[h.length-1]||"",v=new URLSearchParams(e.search||""),y=v.get("senha")||v.get("pwd")||v.get("code")||""||m;if(y&&y===nV){try{localStorage.setItem("maintenance:bypass","1")}catch{}try{sessionStorage.setItem("maintenance:bypass","1")}catch{}try{document.cookie="fx_maint_bypass=1; path=/; max-age=2592000"}catch{}try{sessionStorage.removeItem("auth:returnUrl")}catch{}t("/login",{replace:!0})}},[e,t]),a.jsxs("div",{className:"min-h-screen relative overflow-hidden bg-gradient-to-b from-[#0f1324] via-[#0b0f1c] to-[#070a14] text-white",children:[a.jsx("div",{className:"pointer-events-none absolute -top-40 left-1/2 -translate-x-1/2 w-[90rem] h-[90rem] rounded-full opacity-30 blur-3xl",style:{background:"radial-gradient(50% 50% at 50% 50%, rgba(76,110,245,0.45) 0%, rgba(76,110,245,0.18) 40%, rgba(0,0,0,0) 70%)"}}),a.jsxs("div",{className:"relative z-10 mx-auto max-w-4xl px-6 py-16 md:py-24",children:[a.jsxs("div",{className:"mx-auto max-w-3xl rounded-3xl border border-white/10 bg-white/[0.02] backdrop-blur-xl shadow-[0_0_60px_-10px_rgba(76,110,245,0.5)] p-6 md:p-10",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"w-16 h-16 bg-brand rounded-xl flex items-center justify-center mr-4",children:a.jsx(jc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-5xl font-extrabold",children:[a.jsx("span",{style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{style:{color:"#FFAA33"},children:"7"})]}),a.jsx("p",{className:"text-2xl font-semibold",style:{color:"#B0B0B0"},children:"Arena"})]})]})}),a.jsxs("div",{className:"flex items-center justify-center gap-3 text-red-400 mb-4",children:[a.jsx(s4,{className:"w-6 h-6"}),a.jsx("span",{className:"font-semibold tracking-wide",children:"Modo de Manuteno"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-8",children:[a.jsx("div",{className:"shrink-0",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute -inset-4 bg-brand/20 blur-2xl rounded-full"}),a.jsx("div",{className:"relative rounded-2xl p-1 bg-gradient-to-b from-brand/40 to-transparent",children:a.jsx(xd,{size:"xl",variant:"header"})})]})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold leading-tight",children:"Oi! Eu sou a Isis "}),a.jsx("p",{className:"text-white/80 mt-3 text-base md:text-lg leading-relaxed",children:u}),a.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-white/80",children:[d&&a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/[0.03] px-3 py-2",children:[a.jsx(vd,{className:"w-4 h-4 text-brand"}),a.jsxs("span",{children:["Previso de retorno: ",a.jsx("strong",{className:"text-white/90",children:aV(d)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/[0.03] px-3 py-2",children:[a.jsx(Ns,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Vamos cuidar de tudo para voc jogar melhor "})]})]})]})]})]}),a.jsx("p",{className:"mt-6 text-center text-white/50 text-sm",children:r?"Modo de manuteno ativo":"Modo de manuteno inativo"})]})]})}function llt(){const[e,t]=p.useState(!0),[r,n]=p.useState(!1),o=()=>{t(c=>!c)},s=Ls(),i=Yi(),l=s.pathname==="/agenda";return p.useEffect(()=>{const c=d=>{const u=String(d.target?.tagName||"").toLowerCase();if(!(["input","textarea","select"].includes(u)||d.target?.isContentEditable)&&!d.repeat){if(String(d.key).toLowerCase()==="b"){d.preventDefault();const f=String(s?.pathname||"").toLowerCase();console.log("[Global Hotkey B] Current path:",f),f.includes("balcao")?(console.log("[Global Hotkey B] Navigating to /vendas"),i("/vendas")):(console.log("[Global Hotkey B] Navigating to /balcao"),i("/balcao"));return}if(String(d.key).toLowerCase()==="h"){d.preventDefault(),i("/historico");return}}};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[s,i]),a.jsx(qwe,{children:a.jsx(Dwe,{children:a.jsx(zwe,{children:a.jsxs("div",{className:"relative flex h-screen bg-background text-text-primary",children:[a.jsxs(Qw,{children:[a.jsx("title",{children:"F7 Arena"}),a.jsx("meta",{name:"description",content:"Software para gesto de quadras esportivas."})]}),a.jsx(hge,{isVisible:e,setIsVisible:t,sidebarPinned:r}),e&&a.jsx("button",{type:"button",onClick:()=>t(!1),className:"md:hidden fixed inset-0 z-30 bg-black/40","aria-label":"Fechar menu lateral"}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsx(Mwe,{onToggleSidebar:o,sidebarVisible:e,sidebarPinned:r}),a.jsx("main",{className:mr("flex-1 overflow-x-hidden overflow-y-auto bg-background",l?"p-0 md:p-8":"p-8"),children:a.jsxs(Lj,{children:[a.jsx(oo,{path:"/",element:a.jsx(Eze,{})}),a.jsx(oo,{path:"/agenda",element:a.jsx(iZe,{sidebarVisible:e})}),a.jsx(oo,{path:"/isis",element:a.jsx(qX,{children:a.jsx($it,{})})}),a.jsx(oo,{path:"/vendas",element:a.jsx(Xat,{})}),a.jsx(oo,{path:"/balcao",element:a.jsx(Yat,{})}),a.jsx(oo,{path:"/produtos",element:a.jsx(jot,{})}),a.jsx(oo,{path:"/compras",element:a.jsx(Sot,{})}),a.jsx(oo,{path:"/clientes",element:a.jsx(kot,{})}),a.jsx(oo,{path:"/equipe",element:a.jsx(Mot,{})}),a.jsx(oo,{path:"/financeiro",element:a.jsx(wst,{})}),a.jsx(oo,{path:"/caixa",element:a.jsx(AH,{to:"/financeiro?tab=caixa",replace:!0})}),a.jsx(oo,{path:"/quadras",element:a.jsx(Nst,{})}),a.jsx(oo,{path:"/empresas",element:a.jsx(Ost,{})}),a.jsx(oo,{path:"/finalizadoras",element:a.jsx(Dst,{})}),a.jsx(oo,{path:"/configuracao-fiscal",element:a.jsx(Ait,{})}),a.jsx(oo,{path:"/fiscal",element:a.jsx(Lit,{})}),a.jsx(oo,{path:"/test-page",element:a.jsx(Mst,{})}),a.jsx(oo,{path:"/historico",element:a.jsx(Uit,{})}),a.jsx(oo,{path:"/suporte",element:a.jsx(Lot,{})})]})})]})]})})})})}function clt(){Ls();const[e,t]=p.useState(!1),[r,n]=p.useState(!1),o=String({}.VITE_MAINTENANCE_MODE||"").toLowerCase()==="true",s=_e.useMemo(()=>{try{if(typeof window>"u")return null;const c=window.location.host||"",d="f7arena.com";if(!c.endsWith(d))return null;const u=c.slice(0,-d.length).replace(/\.$/,"").toLowerCase();return!u||u==="www"?null:u}catch{return null}},[]);p.useEffect(()=>{try{const c=()=>{const u=localStorage.getItem("maintenance:active")==="true",f=localStorage.getItem("maintenance:end");return u&&f&&new Date>new Date(f)?(localStorage.removeItem("maintenance:active"),!1):u};t(localStorage.getItem("maintenance:bypass")==="1"),n(c());const d=u=>{if(!u||!u.key){n(c()),t(localStorage.getItem("maintenance:bypass")==="1");return}u.key==="maintenance:bypass"&&t(u.newValue==="1"),(u.key==="maintenance:active"||u.key==="maintenance:end")&&n(c())};return window.addEventListener("storage",d),()=>window.removeEventListener("storage",d)}catch{}},[]);const i=!!OS||o||r,l=(()=>{try{const c=localStorage.getItem("maintenance:bypass")==="1",d=(()=>{try{return sessionStorage.getItem("maintenance:bypass")==="1"}catch{return!1}})(),u=(()=>{try{return document.cookie.split(";").some(f=>f.trim()==="fx_maint_bypass=1")}catch{return!1}})();return c||d||u}catch{return!1}})();return i&&!l?a.jsxs(Lj,{children:[a.jsx(oo,{path:"/maintenance",element:a.jsx(oV,{})}),a.jsx(oo,{path:"*",element:a.jsx(AH,{to:"/maintenance",replace:!0})})]}):s?a.jsx(Lj,{children:a.jsx(oo,{path:"/*",element:a.jsx(rV,{})})}):a.jsxs(Lj,{children:[a.jsx(oo,{path:"/reset-password",element:a.jsx(Fst,{})}),a.jsx(oo,{path:"/40028922",element:a.jsx(Xit,{})}),a.jsx(oo,{path:"/agendar/:nomeFantasia",element:a.jsx(rV,{})}),a.jsx(oo,{path:"/maintenance",element:a.jsx(oV,{})}),a.jsx(oo,{path:"/backenddeploy",element:a.jsx(Rst,{})}),a.jsx(oo,{path:"/print-comanda",element:a.jsx(k6,{children:a.jsx(Vit,{})})}),a.jsx(oo,{path:"/*",element:a.jsx(k6,{children:a.jsx(llt,{})})})]})}var $R="ToastProvider",[BR,dlt,ult]=y5("Toast"),[nse,ect]=Pd("Toast",[ult]),[flt,nP]=nse($R),ase=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:o="right",swipeThreshold:s=50,children:i}=e,[l,c]=p.useState(null),[d,u]=p.useState(0),f=p.useRef(!1),h=p.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${$R}\`. Expected non-empty \`string\`.`),a.jsx(BR.Provider,{scope:t,children:a.jsx(flt,{scope:t,label:r,duration:n,swipeDirection:o,swipeThreshold:s,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>u(m=>m+1),[]),onToastRemove:p.useCallback(()=>u(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:h,children:i})})};ase.displayName=$R;var ose="ToastViewport",mlt=["F8"],r3="toast.viewportPause",n3="toast.viewportResume",sse=p.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=mlt,label:o="Notifications ({hotkey})",...s}=e,i=nP(ose,r),l=dlt(r),c=p.useRef(null),d=p.useRef(null),u=p.useRef(null),f=p.useRef(null),h=za(t,f,i.onViewportChange),m=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=i.toastCount>0;p.useEffect(()=>{const y=x=>{n.length!==0&&n.every(w=>x[w]||x.code===w)&&f.current?.focus()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[n]),p.useEffect(()=>{const y=c.current,x=f.current;if(v&&y&&x){const b=()=>{if(!i.isClosePausedRef.current){const C=new CustomEvent(r3);x.dispatchEvent(C),i.isClosePausedRef.current=!0}},w=()=>{if(i.isClosePausedRef.current){const C=new CustomEvent(n3);x.dispatchEvent(C),i.isClosePausedRef.current=!1}},j=C=>{!y.contains(C.relatedTarget)&&w()},_=()=>{y.contains(document.activeElement)||w()};return y.addEventListener("focusin",b),y.addEventListener("focusout",j),y.addEventListener("pointermove",b),y.addEventListener("pointerleave",_),window.addEventListener("blur",b),window.addEventListener("focus",w),()=>{y.removeEventListener("focusin",b),y.removeEventListener("focusout",j),y.removeEventListener("pointermove",b),y.removeEventListener("pointerleave",_),window.removeEventListener("blur",b),window.removeEventListener("focus",w)}}},[v,i.isClosePausedRef]);const g=p.useCallback(({tabbingDirection:y})=>{const b=l().map(w=>{const j=w.ref.current,_=[j,...Clt(j)];return y==="forwards"?_:_.reverse()});return(y==="forwards"?b.reverse():b).flat()},[l]);return p.useEffect(()=>{const y=f.current;if(y){const x=b=>{const w=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!w){const _=document.activeElement,C=b.shiftKey;if(b.target===y&&C){d.current?.focus();return}const P=g({tabbingDirection:C?"backwards":"forwards"}),F=P.findIndex(M=>M===_);ZE(P.slice(F+1))?b.preventDefault():C?d.current?.focus():u.current?.focus()}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[l,g]),a.jsxs(Ige,{ref:c,role:"region","aria-label":o.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&a.jsx(a3,{ref:d,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});ZE(y)}}),a.jsx(BR.Slot,{scope:r,children:a.jsx(oa.ol,{tabIndex:-1,...s,ref:h})}),v&&a.jsx(a3,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});ZE(y)}})]})});sse.displayName=ose;var ise="ToastFocusProxy",a3=p.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...o}=e,s=nP(ise,r);return a.jsx(AM,{tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:i=>{const l=i.relatedTarget;!s.viewport?.contains(l)&&n()}})});a3.displayName=ise;var V1="Toast",hlt="toast.swipeStart",plt="toast.swipeMove",glt="toast.swipeCancel",vlt="toast.swipeEnd",lse=p.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:o,onOpenChange:s,...i}=e,[l,c]=Vf({prop:n,defaultProp:o??!0,onChange:s,caller:V1});return a.jsx(Bc,{present:r||l,children:a.jsx(blt,{open:l,...i,ref:t,onClose:()=>c(!1),onPause:Yl(e.onPause),onResume:Yl(e.onResume),onSwipeStart:bn(e.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:bn(e.onSwipeMove,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:bn(e.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:bn(e.onSwipeEnd,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});lse.displayName=V1;var[xlt,ylt]=nse(V1,{onClose(){}}),blt=p.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:o,open:s,onClose:i,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:f,onSwipeCancel:h,onSwipeEnd:m,...v}=e,g=nP(V1,r),[y,x]=p.useState(null),b=za(t,D=>x(D)),w=p.useRef(null),j=p.useRef(null),_=o||g.duration,C=p.useRef(0),E=p.useRef(_),A=p.useRef(0),{onToastAdd:P,onToastRemove:F}=g,M=Yl(()=>{y?.contains(document.activeElement)&&g.viewport?.focus(),i()}),I=p.useCallback(D=>{!D||D===1/0||(window.clearTimeout(A.current),C.current=new Date().getTime(),A.current=window.setTimeout(M,D))},[M]);p.useEffect(()=>{const D=g.viewport;if(D){const U=()=>{I(E.current),d?.()},z=()=>{const H=new Date().getTime()-C.current;E.current=E.current-H,window.clearTimeout(A.current),c?.()};return D.addEventListener(r3,z),D.addEventListener(n3,U),()=>{D.removeEventListener(r3,z),D.removeEventListener(n3,U)}}},[g.viewport,_,c,d,I]),p.useEffect(()=>{s&&!g.isClosePausedRef.current&&I(_)},[s,_,g.isClosePausedRef,I]),p.useEffect(()=>(P(),()=>F()),[P,F]);const R=p.useMemo(()=>y?pse(y):null,[y]);return g.viewport?a.jsxs(a.Fragment,{children:[R&&a.jsx(wlt,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:R}),a.jsx(xlt,{scope:r,onClose:M,children:Qf.createPortal(a.jsx(BR.ItemSlot,{scope:r,children:a.jsx(kge,{asChild:!0,onEscapeKeyDown:bn(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||M(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(oa.li,{tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":g.swipeDirection,...v,ref:b,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:bn(e.onKeyDown,D=>{D.key==="Escape"&&(l?.(D.nativeEvent),D.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,M()))}),onPointerDown:bn(e.onPointerDown,D=>{D.button===0&&(w.current={x:D.clientX,y:D.clientY})}),onPointerMove:bn(e.onPointerMove,D=>{if(!w.current)return;const U=D.clientX-w.current.x,z=D.clientY-w.current.y,H=!!j.current,q=["left","right"].includes(g.swipeDirection),Q=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,pe=q?Q(0,U):0,be=q?0:Q(0,z),V=D.pointerType==="touch"?10:2,B={x:pe,y:be},J={originalEvent:D,delta:B};H?(j.current=B,Nj(plt,f,J,{discrete:!1})):sV(B,g.swipeDirection,V)?(j.current=B,Nj(hlt,u,J,{discrete:!1}),D.target.setPointerCapture(D.pointerId)):(Math.abs(U)>V||Math.abs(z)>V)&&(w.current=null)}),onPointerUp:bn(e.onPointerUp,D=>{const U=j.current,z=D.target;if(z.hasPointerCapture(D.pointerId)&&z.releasePointerCapture(D.pointerId),j.current=null,w.current=null,U){const H=D.currentTarget,q={originalEvent:D,delta:U};sV(U,g.swipeDirection,g.swipeThreshold)?Nj(vlt,m,q,{discrete:!0}):Nj(glt,h,q,{discrete:!0}),H.addEventListener("click",Q=>Q.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),wlt=e=>{const{__scopeToast:t,children:r,...n}=e,o=nP(V1,t),[s,i]=p.useState(!1),[l,c]=p.useState(!1);return Nlt(()=>i(!0)),p.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:a.jsx(d0,{asChild:!0,children:a.jsx(AM,{...n,children:s&&a.jsxs(a.Fragment,{children:[o.label," ",r]})})})},jlt="ToastTitle",cse=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return a.jsx(oa.div,{...n,ref:t})});cse.displayName=jlt;var _lt="ToastDescription",dse=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return a.jsx(oa.div,{...n,ref:t})});dse.displayName=_lt;var use="ToastAction",fse=p.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?a.jsx(hse,{altText:r,asChild:!0,children:a.jsx(qR,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${use}\`. Expected non-empty \`string\`.`),null)});fse.displayName=use;var mse="ToastClose",qR=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,o=ylt(mse,r);return a.jsx(hse,{asChild:!0,children:a.jsx(oa.button,{type:"button",...n,ref:t,onClick:bn(e.onClick,o.onClose)})})});qR.displayName=mse;var hse=p.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...o}=e;return a.jsx(oa.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...o,ref:t})});function pse(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),Slt(n)){const o=n.ariaHidden||n.hidden||n.style.display==="none",s=n.dataset.radixToastAnnounceExclude==="";if(!o)if(s){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...pse(n))}}),t}function Nj(e,t,r,{discrete:n}){const o=r.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&o.addEventListener(e,t,{once:!0}),n?R4(o,s):o.dispatchEvent(s)}var sV=(e,t,r=0)=>{const n=Math.abs(e.x),o=Math.abs(e.y),s=n>o;return t==="left"||t==="right"?s&&n>r:!s&&o>r};function Nlt(e=()=>{}){const t=Yl(e);Ii(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function Slt(e){return e.nodeType===e.ELEMENT_NODE}function Clt(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function ZE(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Plt=ase,gse=sse,vse=lse,xse=cse,yse=dse,bse=fse,wse=qR;const Alt=Plt,jse=_e.forwardRef(({className:e,...t},r)=>a.jsx(gse,{ref:r,className:mr("fixed z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));jse.displayName=gse.displayName;const Elt=M4("group relative pointer-events-auto flex w-full items-start justify-between gap-4 overflow-hidden rounded-lg border p-4 pr-8 shadow-xl transition-all data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-warning text-black border-warning",destructive:"bg-danger text-white border-danger",success:"bg-success text-white border-success",info:"bg-info text-black border-info",warning:"bg-warning text-black border-warning"}},defaultVariants:{variant:"default"}}),_se=_e.forwardRef(({className:e,variant:t,...r},n)=>a.jsx(vse,{ref:n,className:mr(Elt({variant:t}),e),...r}));_se.displayName=vse.displayName;const klt=_e.forwardRef(({className:e,...t},r)=>a.jsx(bse,{ref:r,className:mr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));klt.displayName=bse.displayName;const Nse=_e.forwardRef(({className:e,...t},r)=>a.jsx(wse,{ref:r,className:mr("absolute right-2 top-2 rounded-md p-1 text-white/80 transition-opacity hover:text-white focus:outline-none focus:ring-2 focus:ring-white/50 group-[.default]:text-black/70 group-[.default]:hover:text-black",e),...t,children:a.jsx(yl,{className:"h-4 w-4"})}));Nse.displayName=wse.displayName;const Sse=_e.forwardRef(({className:e,...t},r)=>a.jsx(xse,{ref:r,className:mr("text-sm font-semibold",e),...t}));Sse.displayName=xse.displayName;const Cse=_e.forwardRef(({className:e,...t},r)=>a.jsx(yse,{ref:r,className:mr("text-sm",e),...t}));Cse.displayName=yse.displayName;function Ilt(){const{toasts:e}=no();return a.jsxs(Alt,{children:[e.map(({id:t,title:r,description:n,action:o,dismiss:s,...i})=>a.jsxs(_se,{...i,children:[a.jsxs("div",{className:"grid gap-1",children:[r&&a.jsx(Sse,{children:r}),n&&a.jsx(Cse,{children:n})]}),o,a.jsx(Nse,{onClick:s})]},t)),a.jsx(jse,{})]})}function Olt(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(e=>{setInterval(()=>{e.update()},6e4),e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&window.confirm("Nova verso disponvel! Deseja atualizar agora?")&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload())})})}).catch(e=>{console.error("[SW] Erro ao registrar Service Worker:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})})}Olt();window.screen?.orientation?.lock&&window.screen.orientation.lock("portrait").catch(e=>{console.log("[Orientation] Lock no suportado ou j bloqueado:",e.message)});window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),window.__installPrompt=e},{passive:!1});window.addEventListener("appinstalled",()=>{window.__installPrompt=null});ek.createRoot(document.getElementById("root")).render(a.jsx(Ede,{children:a.jsxs(Dye,{children:[a.jsx(clt,{}),a.jsx(Ilt,{})]})}));export{vwe as _,Gi as c,Ga as g};
