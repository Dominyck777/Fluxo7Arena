var Rie=Object.defineProperty;var Lie=(e,t,r)=>t in e?Rie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Za=(e,t,r)=>(Lie(e,typeof t!="symbol"?t+"":t,r),r);function $ie(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var qs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ba(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Fie(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var MU={exports:{}},dS={},RU={exports:{}},_a={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1=Symbol.for("react.element"),Bie=Symbol.for("react.portal"),qie=Symbol.for("react.fragment"),zie=Symbol.for("react.strict_mode"),Uie=Symbol.for("react.profiler"),Vie=Symbol.for("react.provider"),Wie=Symbol.for("react.context"),Hie=Symbol.for("react.forward_ref"),Gie=Symbol.for("react.suspense"),Kie=Symbol.for("react.memo"),Yie=Symbol.for("react.lazy"),qR=Symbol.iterator;function Xie(e){return e===null||typeof e!="object"?null:(e=qR&&e[qR]||e["@@iterator"],typeof e=="function"?e:null)}var LU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$U=Object.assign,FU={};function Gx(e,t,r){this.props=e,this.context=t,this.refs=FU,this.updater=r||LU}Gx.prototype.isReactComponent={};Gx.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Gx.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function BU(){}BU.prototype=Gx.prototype;function B4(e,t,r){this.props=e,this.context=t,this.refs=FU,this.updater=r||LU}var q4=B4.prototype=new BU;q4.constructor=B4;$U(q4,Gx.prototype);q4.isPureReactComponent=!0;var zR=Array.isArray,qU=Object.prototype.hasOwnProperty,z4={current:null},zU={key:!0,ref:!0,__self:!0,__source:!0};function UU(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)qU.call(t,n)&&!zU.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:L1,type:e,key:i,ref:s,props:a,_owner:z4.current}}function Jie(e,t){return{$$typeof:L1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function U4(e){return typeof e=="object"&&e!==null&&e.$$typeof===L1}function Qie(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var UR=/\/+/g;function H5(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Qie(""+e.key):t.toString(36)}function nj(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case L1:case Bie:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+H5(s,0):n,zR(a)?(r="",e!=null&&(r=e.replace(UR,"$&/")+"/"),nj(a,t,r,"",function(d){return d})):a!=null&&(U4(a)&&(a=Jie(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(UR,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",zR(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+H5(i,l);s+=nj(i,t,r,c,a)}else if(c=Xie(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+H5(i,l++),s+=nj(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Bw(e,t,r){if(e==null)return e;var n=[],a=0;return nj(e,n,"","",function(i){return t.call(r,i,a++)}),n}function Zie(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var gl={current:null},aj={transition:null},ese={ReactCurrentDispatcher:gl,ReactCurrentBatchConfig:aj,ReactCurrentOwner:z4};function VU(){throw Error("act(...) is not supported in production builds of React.")}_a.Children={map:Bw,forEach:function(e,t,r){Bw(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Bw(e,function(){t++}),t},toArray:function(e){return Bw(e,function(t){return t})||[]},only:function(e){if(!U4(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_a.Component=Gx;_a.Fragment=qie;_a.Profiler=Uie;_a.PureComponent=B4;_a.StrictMode=zie;_a.Suspense=Gie;_a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ese;_a.act=VU;_a.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=$U({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=z4.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)qU.call(t,c)&&!zU.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:L1,type:e.type,key:a,ref:i,props:n,_owner:s}};_a.createContext=function(e){return e={$$typeof:Wie,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Vie,_context:e},e.Consumer=e};_a.createElement=UU;_a.createFactory=function(e){var t=UU.bind(null,e);return t.type=e,t};_a.createRef=function(){return{current:null}};_a.forwardRef=function(e){return{$$typeof:Hie,render:e}};_a.isValidElement=U4;_a.lazy=function(e){return{$$typeof:Yie,_payload:{_status:-1,_result:e},_init:Zie}};_a.memo=function(e,t){return{$$typeof:Kie,type:e,compare:t===void 0?null:t}};_a.startTransition=function(e){var t=aj.transition;aj.transition={};try{e()}finally{aj.transition=t}};_a.unstable_act=VU;_a.useCallback=function(e,t){return gl.current.useCallback(e,t)};_a.useContext=function(e){return gl.current.useContext(e)};_a.useDebugValue=function(){};_a.useDeferredValue=function(e){return gl.current.useDeferredValue(e)};_a.useEffect=function(e,t){return gl.current.useEffect(e,t)};_a.useId=function(){return gl.current.useId()};_a.useImperativeHandle=function(e,t,r){return gl.current.useImperativeHandle(e,t,r)};_a.useInsertionEffect=function(e,t){return gl.current.useInsertionEffect(e,t)};_a.useLayoutEffect=function(e,t){return gl.current.useLayoutEffect(e,t)};_a.useMemo=function(e,t){return gl.current.useMemo(e,t)};_a.useReducer=function(e,t,r){return gl.current.useReducer(e,t,r)};_a.useRef=function(e){return gl.current.useRef(e)};_a.useState=function(e){return gl.current.useState(e)};_a.useSyncExternalStore=function(e,t,r){return gl.current.useSyncExternalStore(e,t,r)};_a.useTransition=function(){return gl.current.useTransition()};_a.version="18.3.1";RU.exports=_a;var p=RU.exports;const xe=Ba(p),V4=$ie({__proto__:null,default:xe},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tse=p,rse=Symbol.for("react.element"),nse=Symbol.for("react.fragment"),ase=Object.prototype.hasOwnProperty,ose=tse.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ise={key:!0,ref:!0,__self:!0,__source:!0};function WU(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)ase.call(t,n)&&!ise.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:rse,type:e,key:i,ref:s,props:a,_owner:ose.current}}dS.Fragment=nse;dS.jsx=WU;dS.jsxs=WU;MU.exports=dS;var o=MU.exports,IE={},HU={exports:{}},Cc={},GU={exports:{}},KU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t($,K){var ce=$.length;$.push(K);e:for(;0<ce;){var fe=ce-1>>>1,B=$[fe];if(0<a(B,K))$[fe]=K,$[ce]=B,ce=fe;else break e}}function r($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var K=$[0],ce=$.pop();if(ce!==K){$[0]=ce;e:for(var fe=0,B=$.length,L=B>>>1;fe<L;){var V=2*(fe+1)-1,re=$[V],me=V+1,G=$[me];if(0>a(re,ce))me<B&&0>a(G,re)?($[fe]=G,$[me]=ce,fe=me):($[fe]=re,$[V]=ce,fe=V);else if(me<B&&0>a(G,ce))$[fe]=G,$[me]=ce,fe=me;else break e}}return K}function a($,K){var ce=$.sortIndex-K.sortIndex;return ce!==0?ce:$.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],d=[],u=1,f=null,m=3,h=!1,v=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w($){for(var K=r(d);K!==null;){if(K.callback===null)n(d);else if(K.startTime<=$)n(d),K.sortIndex=K.expirationTime,t(c,K);else break;K=r(d)}}function j($){if(g=!1,w($),!v)if(r(c)!==null)v=!0,z(_);else{var K=r(d);K!==null&&q(j,K.startTime-$)}}function _($,K){v=!1,g&&(g=!1,y(E),E=-1),h=!0;var ce=m;try{for(w(K),f=r(c);f!==null&&(!(f.expirationTime>K)||$&&!C());){var fe=f.callback;if(typeof fe=="function"){f.callback=null,m=f.priorityLevel;var B=fe(f.expirationTime<=K);K=e.unstable_now(),typeof B=="function"?f.callback=B:f===r(c)&&n(c),w(K)}else n(c);f=r(c)}if(f!==null)var L=!0;else{var V=r(d);V!==null&&q(j,V.startTime-K),L=!1}return L}finally{f=null,m=ce,h=!1}}var S=!1,k=null,E=-1,A=5,M=-1;function C(){return!(e.unstable_now()-M<A)}function T(){if(k!==null){var $=e.unstable_now();M=$;var K=!0;try{K=k(!0,$)}finally{K?I():(S=!1,k=null)}}else S=!1}var I;if(typeof b=="function")I=function(){b(T)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,F=D.port2;D.port1.onmessage=T,I=function(){F.postMessage(null)}}else I=function(){x(T,0)};function z($){k=$,S||(S=!0,I())}function q($,K){E=x(function(){$(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,z(_))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function($){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var ce=m;m=K;try{return $()}finally{m=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,K){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ce=m;m=$;try{return K()}finally{m=ce}},e.unstable_scheduleCallback=function($,K,ce){var fe=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?fe+ce:fe):ce=fe,$){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ce+B,$={id:u++,callback:K,priorityLevel:$,startTime:ce,expirationTime:B,sortIndex:-1},ce>fe?($.sortIndex=ce,t(d,$),r(c)===null&&$===r(d)&&(g?(y(E),E=-1):g=!0,q(j,ce-fe))):($.sortIndex=B,t(c,$),v||h||(v=!0,z(_))),$},e.unstable_shouldYield=C,e.unstable_wrapCallback=function($){var K=m;return function(){var ce=m;m=K;try{return $.apply(this,arguments)}finally{m=ce}}}})(KU);GU.exports=KU;var sse=GU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lse=p,_c=sse;function Wr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var YU=new Set,sb={};function cg(e,t){Zv(e,t),Zv(e+"Capture",t)}function Zv(e,t){for(sb[e]=t,e=0;e<t.length;e++)YU.add(t[e])}var Pf=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),DE=Object.prototype.hasOwnProperty,cse=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,VR={},WR={};function dse(e){return DE.call(WR,e)?!0:DE.call(VR,e)?!1:cse.test(e)?WR[e]=!0:(VR[e]=!0,!1)}function use(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function fse(e,t,r,n){if(t===null||typeof t>"u"||use(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function vl(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var _s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){_s[e]=new vl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];_s[t]=new vl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){_s[e]=new vl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){_s[e]=new vl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){_s[e]=new vl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){_s[e]=new vl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){_s[e]=new vl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){_s[e]=new vl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){_s[e]=new vl(e,5,!1,e.toLowerCase(),null,!1,!1)});var W4=/[\-:]([a-z])/g;function H4(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(W4,H4);_s[t]=new vl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(W4,H4);_s[t]=new vl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(W4,H4);_s[t]=new vl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){_s[e]=new vl(e,1,!1,e.toLowerCase(),null,!1,!1)});_s.xlinkHref=new vl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){_s[e]=new vl(e,1,!1,e.toLowerCase(),null,!0,!0)});function G4(e,t,r,n){var a=_s.hasOwnProperty(t)?_s[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(fse(t,r,a,n)&&(r=null),n||a===null?dse(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var qf=lse.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qw=Symbol.for("react.element"),iv=Symbol.for("react.portal"),sv=Symbol.for("react.fragment"),K4=Symbol.for("react.strict_mode"),ME=Symbol.for("react.profiler"),XU=Symbol.for("react.provider"),JU=Symbol.for("react.context"),Y4=Symbol.for("react.forward_ref"),RE=Symbol.for("react.suspense"),LE=Symbol.for("react.suspense_list"),X4=Symbol.for("react.memo"),gm=Symbol.for("react.lazy"),QU=Symbol.for("react.offscreen"),HR=Symbol.iterator;function O0(e){return e===null||typeof e!="object"?null:(e=HR&&e[HR]||e["@@iterator"],typeof e=="function"?e:null)}var Go=Object.assign,G5;function dy(e){if(G5===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);G5=t&&t[1]||""}return`
`+G5+e}var K5=!1;function Y5(e,t){if(!e||K5)return"";K5=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,l=i.length-1;1<=s&&0<=l&&a[s]!==i[l];)l--;for(;1<=s&&0<=l;s--,l--)if(a[s]!==i[l]){if(s!==1||l!==1)do if(s--,l--,0>l||a[s]!==i[l]){var c=`
`+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=l);break}}}finally{K5=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?dy(e):""}function mse(e){switch(e.tag){case 5:return dy(e.type);case 16:return dy("Lazy");case 13:return dy("Suspense");case 19:return dy("SuspenseList");case 0:case 2:case 15:return e=Y5(e.type,!1),e;case 11:return e=Y5(e.type.render,!1),e;case 1:return e=Y5(e.type,!0),e;default:return""}}function $E(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case sv:return"Fragment";case iv:return"Portal";case ME:return"Profiler";case K4:return"StrictMode";case RE:return"Suspense";case LE:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case JU:return(e.displayName||"Context")+".Consumer";case XU:return(e._context.displayName||"Context")+".Provider";case Y4:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case X4:return t=e.displayName||null,t!==null?t:$E(e.type)||"Memo";case gm:t=e._payload,e=e._init;try{return $E(e(t))}catch{}}return null}function hse(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $E(t);case 8:return t===K4?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function lh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ZU(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function pse(e){var t=ZU(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function zw(e){e._valueTracker||(e._valueTracker=pse(e))}function eV(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ZU(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Lj(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function FE(e,t){var r=t.checked;return Go({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function GR(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=lh(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tV(e,t){t=t.checked,t!=null&&G4(e,"checked",t,!1)}function BE(e,t){tV(e,t);var r=lh(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?qE(e,t.type,r):t.hasOwnProperty("defaultValue")&&qE(e,t.type,lh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function KR(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function qE(e,t,r){(t!=="number"||Lj(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var uy=Array.isArray;function Ev(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+lh(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function zE(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Wr(91));return Go({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function YR(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Wr(92));if(uy(r)){if(1<r.length)throw Error(Wr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:lh(r)}}function rV(e,t){var r=lh(t.value),n=lh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function XR(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function nV(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function UE(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?nV(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Uw,aV=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Uw=Uw||document.createElement("div"),Uw.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Uw.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function lb(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var wy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gse=["Webkit","ms","Moz","O"];Object.keys(wy).forEach(function(e){gse.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),wy[t]=wy[e]})});function oV(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||wy.hasOwnProperty(e)&&wy[e]?(""+t).trim():t+"px"}function iV(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=oV(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var vse=Go({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function VE(e,t){if(t){if(vse[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Wr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Wr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Wr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Wr(62))}}function WE(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var HE=null;function J4(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var GE=null,kv=null,Ov=null;function JR(e){if(e=B1(e)){if(typeof GE!="function")throw Error(Wr(280));var t=e.stateNode;t&&(t=pS(t),GE(e.stateNode,e.type,t))}}function sV(e){kv?Ov?Ov.push(e):Ov=[e]:kv=e}function lV(){if(kv){var e=kv,t=Ov;if(Ov=kv=null,JR(e),t)for(e=0;e<t.length;e++)JR(t[e])}}function cV(e,t){return e(t)}function dV(){}var X5=!1;function uV(e,t,r){if(X5)return e(t,r);X5=!0;try{return cV(e,t,r)}finally{X5=!1,(kv!==null||Ov!==null)&&(dV(),lV())}}function cb(e,t){var r=e.stateNode;if(r===null)return null;var n=pS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Wr(231,t,typeof r));return r}var KE=!1;if(Pf)try{var T0={};Object.defineProperty(T0,"passive",{get:function(){KE=!0}}),window.addEventListener("test",T0,T0),window.removeEventListener("test",T0,T0)}catch{KE=!1}function xse(e,t,r,n,a,i,s,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var jy=!1,$j=null,Fj=!1,YE=null,yse={onError:function(e){jy=!0,$j=e}};function bse(e,t,r,n,a,i,s,l,c){jy=!1,$j=null,xse.apply(yse,arguments)}function wse(e,t,r,n,a,i,s,l,c){if(bse.apply(this,arguments),jy){if(jy){var d=$j;jy=!1,$j=null}else throw Error(Wr(198));Fj||(Fj=!0,YE=d)}}function dg(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function fV(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function QR(e){if(dg(e)!==e)throw Error(Wr(188))}function jse(e){var t=e.alternate;if(!t){if(t=dg(e),t===null)throw Error(Wr(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return QR(a),e;if(i===n)return QR(a),t;i=i.sibling}throw Error(Wr(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,l=a.child;l;){if(l===r){s=!0,r=a,n=i;break}if(l===n){s=!0,n=a,r=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===r){s=!0,r=i,n=a;break}if(l===n){s=!0,n=i,r=a;break}l=l.sibling}if(!s)throw Error(Wr(189))}}if(r.alternate!==n)throw Error(Wr(190))}if(r.tag!==3)throw Error(Wr(188));return r.stateNode.current===r?e:t}function mV(e){return e=jse(e),e!==null?hV(e):null}function hV(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=hV(e);if(t!==null)return t;e=e.sibling}return null}var pV=_c.unstable_scheduleCallback,ZR=_c.unstable_cancelCallback,Nse=_c.unstable_shouldYield,_se=_c.unstable_requestPaint,di=_c.unstable_now,Sse=_c.unstable_getCurrentPriorityLevel,Q4=_c.unstable_ImmediatePriority,gV=_c.unstable_UserBlockingPriority,Bj=_c.unstable_NormalPriority,Cse=_c.unstable_LowPriority,vV=_c.unstable_IdlePriority,uS=null,ku=null;function Pse(e){if(ku&&typeof ku.onCommitFiberRoot=="function")try{ku.onCommitFiberRoot(uS,e,void 0,(e.current.flags&128)===128)}catch{}}var Gd=Math.clz32?Math.clz32:kse,Ase=Math.log,Ese=Math.LN2;function kse(e){return e>>>=0,e===0?32:31-(Ase(e)/Ese|0)|0}var Vw=64,Ww=4194304;function fy(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function qj(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var l=s&~a;l!==0?n=fy(l):(i&=s,i!==0&&(n=fy(i)))}else s=r&~a,s!==0?n=fy(s):i!==0&&(n=fy(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Gd(t),a=1<<r,n|=e[r],t&=~a;return n}function Ose(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tse(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-Gd(i),l=1<<s,c=a[s];c===-1?(!(l&r)||l&n)&&(a[s]=Ose(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function XE(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xV(){var e=Vw;return Vw<<=1,!(Vw&4194240)&&(Vw=64),e}function J5(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function $1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gd(t),e[t]=r}function Ise(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Gd(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Z4(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Gd(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var to=0;function yV(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var bV,eT,wV,jV,NV,JE=!1,Hw=[],Lm=null,$m=null,Fm=null,db=new Map,ub=new Map,wm=[],Dse="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eL(e,t){switch(e){case"focusin":case"focusout":Lm=null;break;case"dragenter":case"dragleave":$m=null;break;case"mouseover":case"mouseout":Fm=null;break;case"pointerover":case"pointerout":db.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ub.delete(t.pointerId)}}function I0(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=B1(t),t!==null&&eT(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Mse(e,t,r,n,a){switch(t){case"focusin":return Lm=I0(Lm,e,t,r,n,a),!0;case"dragenter":return $m=I0($m,e,t,r,n,a),!0;case"mouseover":return Fm=I0(Fm,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return db.set(i,I0(db.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,ub.set(i,I0(ub.get(i)||null,e,t,r,n,a)),!0}return!1}function _V(e){var t=lp(e.target);if(t!==null){var r=dg(t);if(r!==null){if(t=r.tag,t===13){if(t=fV(r),t!==null){e.blockedOn=t,NV(e.priority,function(){wV(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function oj(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=QE(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);HE=n,r.target.dispatchEvent(n),HE=null}else return t=B1(r),t!==null&&eT(t),e.blockedOn=r,!1;t.shift()}return!0}function tL(e,t,r){oj(e)&&r.delete(t)}function Rse(){JE=!1,Lm!==null&&oj(Lm)&&(Lm=null),$m!==null&&oj($m)&&($m=null),Fm!==null&&oj(Fm)&&(Fm=null),db.forEach(tL),ub.forEach(tL)}function D0(e,t){e.blockedOn===t&&(e.blockedOn=null,JE||(JE=!0,_c.unstable_scheduleCallback(_c.unstable_NormalPriority,Rse)))}function fb(e){function t(a){return D0(a,e)}if(0<Hw.length){D0(Hw[0],e);for(var r=1;r<Hw.length;r++){var n=Hw[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Lm!==null&&D0(Lm,e),$m!==null&&D0($m,e),Fm!==null&&D0(Fm,e),db.forEach(t),ub.forEach(t),r=0;r<wm.length;r++)n=wm[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<wm.length&&(r=wm[0],r.blockedOn===null);)_V(r),r.blockedOn===null&&wm.shift()}var Tv=qf.ReactCurrentBatchConfig,zj=!0;function Lse(e,t,r,n){var a=to,i=Tv.transition;Tv.transition=null;try{to=1,tT(e,t,r,n)}finally{to=a,Tv.transition=i}}function $se(e,t,r,n){var a=to,i=Tv.transition;Tv.transition=null;try{to=4,tT(e,t,r,n)}finally{to=a,Tv.transition=i}}function tT(e,t,r,n){if(zj){var a=QE(e,t,r,n);if(a===null)sP(e,t,n,Uj,r),eL(e,n);else if(Mse(a,e,t,r,n))n.stopPropagation();else if(eL(e,n),t&4&&-1<Dse.indexOf(e)){for(;a!==null;){var i=B1(a);if(i!==null&&bV(i),i=QE(e,t,r,n),i===null&&sP(e,t,n,Uj,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else sP(e,t,n,null,r)}}var Uj=null;function QE(e,t,r,n){if(Uj=null,e=J4(n),e=lp(e),e!==null)if(t=dg(e),t===null)e=null;else if(r=t.tag,r===13){if(e=fV(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Uj=e,null}function SV(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Sse()){case Q4:return 1;case gV:return 4;case Bj:case Cse:return 16;case vV:return 536870912;default:return 16}default:return 16}}var Pm=null,rT=null,ij=null;function CV(){if(ij)return ij;var e,t=rT,r=t.length,n,a="value"in Pm?Pm.value:Pm.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return ij=a.slice(e,1<n?1-n:void 0)}function sj(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Gw(){return!0}function rL(){return!1}function Pc(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Gw:rL,this.isPropagationStopped=rL,this}return Go(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Gw)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Gw)},persist:function(){},isPersistent:Gw}),t}var Kx={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nT=Pc(Kx),F1=Go({},Kx,{view:0,detail:0}),Fse=Pc(F1),Q5,Z5,M0,fS=Go({},F1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:aT,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==M0&&(M0&&e.type==="mousemove"?(Q5=e.screenX-M0.screenX,Z5=e.screenY-M0.screenY):Z5=Q5=0,M0=e),Q5)},movementY:function(e){return"movementY"in e?e.movementY:Z5}}),nL=Pc(fS),Bse=Go({},fS,{dataTransfer:0}),qse=Pc(Bse),zse=Go({},F1,{relatedTarget:0}),eP=Pc(zse),Use=Go({},Kx,{animationName:0,elapsedTime:0,pseudoElement:0}),Vse=Pc(Use),Wse=Go({},Kx,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Hse=Pc(Wse),Gse=Go({},Kx,{data:0}),aL=Pc(Gse),Kse={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yse={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xse={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jse(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Xse[e])?!!t[e]:!1}function aT(){return Jse}var Qse=Go({},F1,{key:function(e){if(e.key){var t=Kse[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=sj(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Yse[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:aT,charCode:function(e){return e.type==="keypress"?sj(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?sj(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Zse=Pc(Qse),ele=Go({},fS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oL=Pc(ele),tle=Go({},F1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:aT}),rle=Pc(tle),nle=Go({},Kx,{propertyName:0,elapsedTime:0,pseudoElement:0}),ale=Pc(nle),ole=Go({},fS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ile=Pc(ole),sle=[9,13,27,32],oT=Pf&&"CompositionEvent"in window,Ny=null;Pf&&"documentMode"in document&&(Ny=document.documentMode);var lle=Pf&&"TextEvent"in window&&!Ny,PV=Pf&&(!oT||Ny&&8<Ny&&11>=Ny),iL=String.fromCharCode(32),sL=!1;function AV(e,t){switch(e){case"keyup":return sle.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EV(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var lv=!1;function cle(e,t){switch(e){case"compositionend":return EV(t);case"keypress":return t.which!==32?null:(sL=!0,iL);case"textInput":return e=t.data,e===iL&&sL?null:e;default:return null}}function dle(e,t){if(lv)return e==="compositionend"||!oT&&AV(e,t)?(e=CV(),ij=rT=Pm=null,lv=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return PV&&t.locale!=="ko"?null:t.data;default:return null}}var ule={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lL(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ule[e.type]:t==="textarea"}function kV(e,t,r,n){sV(n),t=Vj(t,"onChange"),0<t.length&&(r=new nT("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var _y=null,mb=null;function fle(e){qV(e,0)}function mS(e){var t=uv(e);if(eV(t))return e}function mle(e,t){if(e==="change")return t}var OV=!1;if(Pf){var tP;if(Pf){var rP="oninput"in document;if(!rP){var cL=document.createElement("div");cL.setAttribute("oninput","return;"),rP=typeof cL.oninput=="function"}tP=rP}else tP=!1;OV=tP&&(!document.documentMode||9<document.documentMode)}function dL(){_y&&(_y.detachEvent("onpropertychange",TV),mb=_y=null)}function TV(e){if(e.propertyName==="value"&&mS(mb)){var t=[];kV(t,mb,e,J4(e)),uV(fle,t)}}function hle(e,t,r){e==="focusin"?(dL(),_y=t,mb=r,_y.attachEvent("onpropertychange",TV)):e==="focusout"&&dL()}function ple(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return mS(mb)}function gle(e,t){if(e==="click")return mS(t)}function vle(e,t){if(e==="input"||e==="change")return mS(t)}function xle(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qd=typeof Object.is=="function"?Object.is:xle;function hb(e,t){if(Qd(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!DE.call(t,a)||!Qd(e[a],t[a]))return!1}return!0}function uL(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fL(e,t){var r=uL(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=uL(r)}}function IV(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?IV(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function DV(){for(var e=window,t=Lj();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Lj(e.document)}return t}function iT(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yle(e){var t=DV(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&IV(r.ownerDocument.documentElement,r)){if(n!==null&&iT(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=fL(r,i);var s=fL(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ble=Pf&&"documentMode"in document&&11>=document.documentMode,cv=null,ZE=null,Sy=null,ek=!1;function mL(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ek||cv==null||cv!==Lj(n)||(n=cv,"selectionStart"in n&&iT(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Sy&&hb(Sy,n)||(Sy=n,n=Vj(ZE,"onSelect"),0<n.length&&(t=new nT("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=cv)))}function Kw(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var dv={animationend:Kw("Animation","AnimationEnd"),animationiteration:Kw("Animation","AnimationIteration"),animationstart:Kw("Animation","AnimationStart"),transitionend:Kw("Transition","TransitionEnd")},nP={},MV={};Pf&&(MV=document.createElement("div").style,"AnimationEvent"in window||(delete dv.animationend.animation,delete dv.animationiteration.animation,delete dv.animationstart.animation),"TransitionEvent"in window||delete dv.transitionend.transition);function hS(e){if(nP[e])return nP[e];if(!dv[e])return e;var t=dv[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in MV)return nP[e]=t[r];return e}var RV=hS("animationend"),LV=hS("animationiteration"),$V=hS("animationstart"),FV=hS("transitionend"),BV=new Map,hL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yh(e,t){BV.set(e,t),cg(t,[e])}for(var aP=0;aP<hL.length;aP++){var oP=hL[aP],wle=oP.toLowerCase(),jle=oP[0].toUpperCase()+oP.slice(1);yh(wle,"on"+jle)}yh(RV,"onAnimationEnd");yh(LV,"onAnimationIteration");yh($V,"onAnimationStart");yh("dblclick","onDoubleClick");yh("focusin","onFocus");yh("focusout","onBlur");yh(FV,"onTransitionEnd");Zv("onMouseEnter",["mouseout","mouseover"]);Zv("onMouseLeave",["mouseout","mouseover"]);Zv("onPointerEnter",["pointerout","pointerover"]);Zv("onPointerLeave",["pointerout","pointerover"]);cg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cg("onBeforeInput",["compositionend","keypress","textInput","paste"]);cg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var my="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nle=new Set("cancel close invalid load scroll toggle".split(" ").concat(my));function pL(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,wse(n,t,void 0,e),e.currentTarget=null}function qV(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var l=n[s],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;pL(a,l,d),i=c}else for(s=0;s<n.length;s++){if(l=n[s],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;pL(a,l,d),i=c}}}if(Fj)throw e=YE,Fj=!1,YE=null,e}function Eo(e,t){var r=t[ok];r===void 0&&(r=t[ok]=new Set);var n=e+"__bubble";r.has(n)||(zV(t,e,2,!1),r.add(n))}function iP(e,t,r){var n=0;t&&(n|=4),zV(r,e,n,t)}var Yw="_reactListening"+Math.random().toString(36).slice(2);function pb(e){if(!e[Yw]){e[Yw]=!0,YU.forEach(function(r){r!=="selectionchange"&&(Nle.has(r)||iP(r,!1,e),iP(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Yw]||(t[Yw]=!0,iP("selectionchange",!1,t))}}function zV(e,t,r,n){switch(SV(t)){case 1:var a=Lse;break;case 4:a=$se;break;default:a=tT}r=a.bind(null,t,r,e),a=void 0,!KE||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function sP(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;s=s.return}for(;l!==null;){if(s=lp(l),s===null)return;if(c=s.tag,c===5||c===6){n=i=s;continue e}l=l.parentNode}}n=n.return}uV(function(){var d=i,u=J4(r),f=[];e:{var m=BV.get(e);if(m!==void 0){var h=nT,v=e;switch(e){case"keypress":if(sj(r)===0)break e;case"keydown":case"keyup":h=Zse;break;case"focusin":v="focus",h=eP;break;case"focusout":v="blur",h=eP;break;case"beforeblur":case"afterblur":h=eP;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=nL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=qse;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=rle;break;case RV:case LV:case $V:h=Vse;break;case FV:h=ale;break;case"scroll":h=Fse;break;case"wheel":h=ile;break;case"copy":case"cut":case"paste":h=Hse;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=oL}var g=(t&4)!==0,x=!g&&e==="scroll",y=g?m!==null?m+"Capture":null:m;g=[];for(var b=d,w;b!==null;){w=b;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,y!==null&&(j=cb(b,y),j!=null&&g.push(gb(b,j,w)))),x)break;b=b.return}0<g.length&&(m=new h(m,v,null,r,u),f.push({event:m,listeners:g}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",m&&r!==HE&&(v=r.relatedTarget||r.fromElement)&&(lp(v)||v[Af]))break e;if((h||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=d,v=v?lp(v):null,v!==null&&(x=dg(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=d),h!==v)){if(g=nL,j="onMouseLeave",y="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=oL,j="onPointerLeave",y="onPointerEnter",b="pointer"),x=h==null?m:uv(h),w=v==null?m:uv(v),m=new g(j,b+"leave",h,r,u),m.target=x,m.relatedTarget=w,j=null,lp(u)===d&&(g=new g(y,b+"enter",v,r,u),g.target=w,g.relatedTarget=x,j=g),x=j,h&&v)t:{for(g=h,y=v,b=0,w=g;w;w=Pg(w))b++;for(w=0,j=y;j;j=Pg(j))w++;for(;0<b-w;)g=Pg(g),b--;for(;0<w-b;)y=Pg(y),w--;for(;b--;){if(g===y||y!==null&&g===y.alternate)break t;g=Pg(g),y=Pg(y)}g=null}else g=null;h!==null&&gL(f,m,h,g,!1),v!==null&&x!==null&&gL(f,x,v,g,!0)}}e:{if(m=d?uv(d):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var _=mle;else if(lL(m))if(OV)_=vle;else{_=ple;var S=hle}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(_=gle);if(_&&(_=_(e,d))){kV(f,_,r,u);break e}S&&S(e,m,d),e==="focusout"&&(S=m._wrapperState)&&S.controlled&&m.type==="number"&&qE(m,"number",m.value)}switch(S=d?uv(d):window,e){case"focusin":(lL(S)||S.contentEditable==="true")&&(cv=S,ZE=d,Sy=null);break;case"focusout":Sy=ZE=cv=null;break;case"mousedown":ek=!0;break;case"contextmenu":case"mouseup":case"dragend":ek=!1,mL(f,r,u);break;case"selectionchange":if(ble)break;case"keydown":case"keyup":mL(f,r,u)}var k;if(oT)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else lv?AV(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(PV&&r.locale!=="ko"&&(lv||E!=="onCompositionStart"?E==="onCompositionEnd"&&lv&&(k=CV()):(Pm=u,rT="value"in Pm?Pm.value:Pm.textContent,lv=!0)),S=Vj(d,E),0<S.length&&(E=new aL(E,e,null,r,u),f.push({event:E,listeners:S}),k?E.data=k:(k=EV(r),k!==null&&(E.data=k)))),(k=lle?cle(e,r):dle(e,r))&&(d=Vj(d,"onBeforeInput"),0<d.length&&(u=new aL("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=k))}qV(f,t)})}function gb(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Vj(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=cb(e,r),i!=null&&n.unshift(gb(e,i,a)),i=cb(e,t),i!=null&&n.push(gb(e,i,a))),e=e.return}return n}function Pg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function gL(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,a?(c=cb(r,i),c!=null&&s.unshift(gb(r,c,l))):a||(c=cb(r,i),c!=null&&s.push(gb(r,c,l)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var _le=/\r\n?/g,Sle=/\u0000|\uFFFD/g;function vL(e){return(typeof e=="string"?e:""+e).replace(_le,`
`).replace(Sle,"")}function Xw(e,t,r){if(t=vL(t),vL(e)!==t&&r)throw Error(Wr(425))}function Wj(){}var tk=null,rk=null;function nk(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ak=typeof setTimeout=="function"?setTimeout:void 0,Cle=typeof clearTimeout=="function"?clearTimeout:void 0,xL=typeof Promise=="function"?Promise:void 0,Ple=typeof queueMicrotask=="function"?queueMicrotask:typeof xL<"u"?function(e){return xL.resolve(null).then(e).catch(Ale)}:ak;function Ale(e){setTimeout(function(){throw e})}function lP(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),fb(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);fb(t)}function Bm(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function yL(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Yx=Math.random().toString(36).slice(2),yu="__reactFiber$"+Yx,vb="__reactProps$"+Yx,Af="__reactContainer$"+Yx,ok="__reactEvents$"+Yx,Ele="__reactListeners$"+Yx,kle="__reactHandles$"+Yx;function lp(e){var t=e[yu];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Af]||r[yu]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=yL(e);e!==null;){if(r=e[yu])return r;e=yL(e)}return t}e=r,r=e.parentNode}return null}function B1(e){return e=e[yu]||e[Af],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function uv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Wr(33))}function pS(e){return e[vb]||null}var ik=[],fv=-1;function bh(e){return{current:e}}function Io(e){0>fv||(e.current=ik[fv],ik[fv]=null,fv--)}function jo(e,t){fv++,ik[fv]=e.current,e.current=t}var ch={},Us=bh(ch),Ol=bh(!1),Fp=ch;function ex(e,t){var r=e.type.contextTypes;if(!r)return ch;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Tl(e){return e=e.childContextTypes,e!=null}function Hj(){Io(Ol),Io(Us)}function bL(e,t,r){if(Us.current!==ch)throw Error(Wr(168));jo(Us,t),jo(Ol,r)}function UV(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Wr(108,hse(e)||"Unknown",a));return Go({},r,n)}function Gj(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ch,Fp=Us.current,jo(Us,e),jo(Ol,Ol.current),!0}function wL(e,t,r){var n=e.stateNode;if(!n)throw Error(Wr(169));r?(e=UV(e,t,Fp),n.__reactInternalMemoizedMergedChildContext=e,Io(Ol),Io(Us),jo(Us,e)):Io(Ol),jo(Ol,r)}var uf=null,gS=!1,cP=!1;function VV(e){uf===null?uf=[e]:uf.push(e)}function Ole(e){gS=!0,VV(e)}function wh(){if(!cP&&uf!==null){cP=!0;var e=0,t=to;try{var r=uf;for(to=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}uf=null,gS=!1}catch(a){throw uf!==null&&(uf=uf.slice(e+1)),pV(Q4,wh),a}finally{to=t,cP=!1}}return null}var mv=[],hv=0,Kj=null,Yj=0,Hc=[],Gc=0,Bp=null,pf=1,gf="";function Hh(e,t){mv[hv++]=Yj,mv[hv++]=Kj,Kj=e,Yj=t}function WV(e,t,r){Hc[Gc++]=pf,Hc[Gc++]=gf,Hc[Gc++]=Bp,Bp=e;var n=pf;e=gf;var a=32-Gd(n)-1;n&=~(1<<a),r+=1;var i=32-Gd(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,pf=1<<32-Gd(t)+a|r<<a|n,gf=i+e}else pf=1<<i|r<<a|n,gf=e}function sT(e){e.return!==null&&(Hh(e,1),WV(e,1,0))}function lT(e){for(;e===Kj;)Kj=mv[--hv],mv[hv]=null,Yj=mv[--hv],mv[hv]=null;for(;e===Bp;)Bp=Hc[--Gc],Hc[Gc]=null,gf=Hc[--Gc],Hc[Gc]=null,pf=Hc[--Gc],Hc[Gc]=null}var hc=null,dc=null,Bo=!1,Bd=null;function HV(e,t){var r=rd(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function jL(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,hc=e,dc=Bm(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,hc=e,dc=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Bp!==null?{id:pf,overflow:gf}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=rd(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,hc=e,dc=null,!0):!1;default:return!1}}function sk(e){return(e.mode&1)!==0&&(e.flags&128)===0}function lk(e){if(Bo){var t=dc;if(t){var r=t;if(!jL(e,t)){if(sk(e))throw Error(Wr(418));t=Bm(r.nextSibling);var n=hc;t&&jL(e,t)?HV(n,r):(e.flags=e.flags&-4097|2,Bo=!1,hc=e)}}else{if(sk(e))throw Error(Wr(418));e.flags=e.flags&-4097|2,Bo=!1,hc=e}}}function NL(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;hc=e}function Jw(e){if(e!==hc)return!1;if(!Bo)return NL(e),Bo=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!nk(e.type,e.memoizedProps)),t&&(t=dc)){if(sk(e))throw GV(),Error(Wr(418));for(;t;)HV(e,t),t=Bm(t.nextSibling)}if(NL(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Wr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){dc=Bm(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}dc=null}}else dc=hc?Bm(e.stateNode.nextSibling):null;return!0}function GV(){for(var e=dc;e;)e=Bm(e.nextSibling)}function tx(){dc=hc=null,Bo=!1}function cT(e){Bd===null?Bd=[e]:Bd.push(e)}var Tle=qf.ReactCurrentBatchConfig;function R0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Wr(309));var n=r.stateNode}if(!n)throw Error(Wr(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var l=a.refs;s===null?delete l[i]:l[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(Wr(284));if(!r._owner)throw Error(Wr(290,e))}return e}function Qw(e,t){throw e=Object.prototype.toString.call(t),Error(Wr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _L(e){var t=e._init;return t(e._payload)}function KV(e){function t(y,b){if(e){var w=y.deletions;w===null?(y.deletions=[b],y.flags|=16):w.push(b)}}function r(y,b){if(!e)return null;for(;b!==null;)t(y,b),b=b.sibling;return null}function n(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function a(y,b){return y=Vm(y,b),y.index=0,y.sibling=null,y}function i(y,b,w){return y.index=w,e?(w=y.alternate,w!==null?(w=w.index,w<b?(y.flags|=2,b):w):(y.flags|=2,b)):(y.flags|=1048576,b)}function s(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,b,w,j){return b===null||b.tag!==6?(b=gP(w,y.mode,j),b.return=y,b):(b=a(b,w),b.return=y,b)}function c(y,b,w,j){var _=w.type;return _===sv?u(y,b,w.props.children,j,w.key):b!==null&&(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===gm&&_L(_)===b.type)?(j=a(b,w.props),j.ref=R0(y,b,w),j.return=y,j):(j=hj(w.type,w.key,w.props,null,y.mode,j),j.ref=R0(y,b,w),j.return=y,j)}function d(y,b,w,j){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=vP(w,y.mode,j),b.return=y,b):(b=a(b,w.children||[]),b.return=y,b)}function u(y,b,w,j,_){return b===null||b.tag!==7?(b=Cp(w,y.mode,j,_),b.return=y,b):(b=a(b,w),b.return=y,b)}function f(y,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=gP(""+b,y.mode,w),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case qw:return w=hj(b.type,b.key,b.props,null,y.mode,w),w.ref=R0(y,null,b),w.return=y,w;case iv:return b=vP(b,y.mode,w),b.return=y,b;case gm:var j=b._init;return f(y,j(b._payload),w)}if(uy(b)||O0(b))return b=Cp(b,y.mode,w,null),b.return=y,b;Qw(y,b)}return null}function m(y,b,w,j){var _=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:l(y,b,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case qw:return w.key===_?c(y,b,w,j):null;case iv:return w.key===_?d(y,b,w,j):null;case gm:return _=w._init,m(y,b,_(w._payload),j)}if(uy(w)||O0(w))return _!==null?null:u(y,b,w,j,null);Qw(y,w)}return null}function h(y,b,w,j,_){if(typeof j=="string"&&j!==""||typeof j=="number")return y=y.get(w)||null,l(b,y,""+j,_);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case qw:return y=y.get(j.key===null?w:j.key)||null,c(b,y,j,_);case iv:return y=y.get(j.key===null?w:j.key)||null,d(b,y,j,_);case gm:var S=j._init;return h(y,b,w,S(j._payload),_)}if(uy(j)||O0(j))return y=y.get(w)||null,u(b,y,j,_,null);Qw(b,j)}return null}function v(y,b,w,j){for(var _=null,S=null,k=b,E=b=0,A=null;k!==null&&E<w.length;E++){k.index>E?(A=k,k=null):A=k.sibling;var M=m(y,k,w[E],j);if(M===null){k===null&&(k=A);break}e&&k&&M.alternate===null&&t(y,k),b=i(M,b,E),S===null?_=M:S.sibling=M,S=M,k=A}if(E===w.length)return r(y,k),Bo&&Hh(y,E),_;if(k===null){for(;E<w.length;E++)k=f(y,w[E],j),k!==null&&(b=i(k,b,E),S===null?_=k:S.sibling=k,S=k);return Bo&&Hh(y,E),_}for(k=n(y,k);E<w.length;E++)A=h(k,y,E,w[E],j),A!==null&&(e&&A.alternate!==null&&k.delete(A.key===null?E:A.key),b=i(A,b,E),S===null?_=A:S.sibling=A,S=A);return e&&k.forEach(function(C){return t(y,C)}),Bo&&Hh(y,E),_}function g(y,b,w,j){var _=O0(w);if(typeof _!="function")throw Error(Wr(150));if(w=_.call(w),w==null)throw Error(Wr(151));for(var S=_=null,k=b,E=b=0,A=null,M=w.next();k!==null&&!M.done;E++,M=w.next()){k.index>E?(A=k,k=null):A=k.sibling;var C=m(y,k,M.value,j);if(C===null){k===null&&(k=A);break}e&&k&&C.alternate===null&&t(y,k),b=i(C,b,E),S===null?_=C:S.sibling=C,S=C,k=A}if(M.done)return r(y,k),Bo&&Hh(y,E),_;if(k===null){for(;!M.done;E++,M=w.next())M=f(y,M.value,j),M!==null&&(b=i(M,b,E),S===null?_=M:S.sibling=M,S=M);return Bo&&Hh(y,E),_}for(k=n(y,k);!M.done;E++,M=w.next())M=h(k,y,E,M.value,j),M!==null&&(e&&M.alternate!==null&&k.delete(M.key===null?E:M.key),b=i(M,b,E),S===null?_=M:S.sibling=M,S=M);return e&&k.forEach(function(T){return t(y,T)}),Bo&&Hh(y,E),_}function x(y,b,w,j){if(typeof w=="object"&&w!==null&&w.type===sv&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case qw:e:{for(var _=w.key,S=b;S!==null;){if(S.key===_){if(_=w.type,_===sv){if(S.tag===7){r(y,S.sibling),b=a(S,w.props.children),b.return=y,y=b;break e}}else if(S.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===gm&&_L(_)===S.type){r(y,S.sibling),b=a(S,w.props),b.ref=R0(y,S,w),b.return=y,y=b;break e}r(y,S);break}else t(y,S);S=S.sibling}w.type===sv?(b=Cp(w.props.children,y.mode,j,w.key),b.return=y,y=b):(j=hj(w.type,w.key,w.props,null,y.mode,j),j.ref=R0(y,b,w),j.return=y,y=j)}return s(y);case iv:e:{for(S=w.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(y,b.sibling),b=a(b,w.children||[]),b.return=y,y=b;break e}else{r(y,b);break}else t(y,b);b=b.sibling}b=vP(w,y.mode,j),b.return=y,y=b}return s(y);case gm:return S=w._init,x(y,b,S(w._payload),j)}if(uy(w))return v(y,b,w,j);if(O0(w))return g(y,b,w,j);Qw(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(y,b.sibling),b=a(b,w),b.return=y,y=b):(r(y,b),b=gP(w,y.mode,j),b.return=y,y=b),s(y)):r(y,b)}return x}var rx=KV(!0),YV=KV(!1),Xj=bh(null),Jj=null,pv=null,dT=null;function uT(){dT=pv=Jj=null}function fT(e){var t=Xj.current;Io(Xj),e._currentValue=t}function ck(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Iv(e,t){Jj=e,dT=pv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Al=!0),e.firstContext=null)}function hd(e){var t=e._currentValue;if(dT!==e)if(e={context:e,memoizedValue:t,next:null},pv===null){if(Jj===null)throw Error(Wr(308));pv=e,Jj.dependencies={lanes:0,firstContext:e}}else pv=pv.next=e;return t}var cp=null;function mT(e){cp===null?cp=[e]:cp.push(e)}function XV(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,mT(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ef(e,n)}function Ef(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var vm=!1;function hT(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function JV(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function jf(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qm(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ua&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ef(e,r)}return a=n.interleaved,a===null?(t.next=t,mT(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ef(e,r)}function lj(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Z4(e,r)}}function SL(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Qj(e,t,r,n){var a=e.updateQueue;vm=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,s===null?i=d:s.next=d,s=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==s&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=a.baseState;s=0,u=d=c=null,l=i;do{var m=l.lane,h=l.eventTime;if((n&m)===m){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(m=t,h=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){f=v.call(h,f,m);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,m=typeof v=="function"?v.call(h,f,m):v,m==null)break e;f=Go({},f,m);break e;case 2:vm=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,m=a.effects,m===null?a.effects=[l]:m.push(l))}else h={eventTime:h,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,s|=m;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;m=l,l=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(1);if(u===null&&(c=f),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);zp|=s,e.lanes=s,e.memoizedState=f}}function CL(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Wr(191,a));a.call(n)}}}var q1={},Ou=bh(q1),xb=bh(q1),yb=bh(q1);function dp(e){if(e===q1)throw Error(Wr(174));return e}function pT(e,t){switch(jo(yb,t),jo(xb,e),jo(Ou,q1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:UE(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=UE(t,e)}Io(Ou),jo(Ou,t)}function nx(){Io(Ou),Io(xb),Io(yb)}function QV(e){dp(yb.current);var t=dp(Ou.current),r=UE(t,e.type);t!==r&&(jo(xb,e),jo(Ou,r))}function gT(e){xb.current===e&&(Io(Ou),Io(xb))}var Uo=bh(0);function Zj(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var dP=[];function vT(){for(var e=0;e<dP.length;e++)dP[e]._workInProgressVersionPrimary=null;dP.length=0}var cj=qf.ReactCurrentDispatcher,uP=qf.ReactCurrentBatchConfig,qp=0,Wo=null,qi=null,ts=null,eN=!1,Cy=!1,bb=0,Ile=0;function ks(){throw Error(Wr(321))}function xT(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Qd(e[r],t[r]))return!1;return!0}function yT(e,t,r,n,a,i){if(qp=i,Wo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,cj.current=e===null||e.memoizedState===null?Lle:$le,e=r(n,a),Cy){i=0;do{if(Cy=!1,bb=0,25<=i)throw Error(Wr(301));i+=1,ts=qi=null,t.updateQueue=null,cj.current=Fle,e=r(n,a)}while(Cy)}if(cj.current=tN,t=qi!==null&&qi.next!==null,qp=0,ts=qi=Wo=null,eN=!1,t)throw Error(Wr(300));return e}function bT(){var e=bb!==0;return bb=0,e}function vu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ts===null?Wo.memoizedState=ts=e:ts=ts.next=e,ts}function pd(){if(qi===null){var e=Wo.alternate;e=e!==null?e.memoizedState:null}else e=qi.next;var t=ts===null?Wo.memoizedState:ts.next;if(t!==null)ts=t,qi=e;else{if(e===null)throw Error(Wr(310));qi=e,e={memoizedState:qi.memoizedState,baseState:qi.baseState,baseQueue:qi.baseQueue,queue:qi.queue,next:null},ts===null?Wo.memoizedState=ts=e:ts=ts.next=e}return ts}function wb(e,t){return typeof t=="function"?t(e):t}function fP(e){var t=pd(),r=t.queue;if(r===null)throw Error(Wr(311));r.lastRenderedReducer=e;var n=qi,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=s=null,c=null,d=i;do{var u=d.lane;if((qp&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,s=n):c=c.next=f,Wo.lanes|=u,zp|=u}d=d.next}while(d!==null&&d!==i);c===null?s=n:c.next=l,Qd(n,t.memoizedState)||(Al=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Wo.lanes|=i,zp|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function mP(e){var t=pd(),r=t.queue;if(r===null)throw Error(Wr(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Qd(i,t.memoizedState)||(Al=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function ZV(){}function eW(e,t){var r=Wo,n=pd(),a=t(),i=!Qd(n.memoizedState,a);if(i&&(n.memoizedState=a,Al=!0),n=n.queue,wT(nW.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||ts!==null&&ts.memoizedState.tag&1){if(r.flags|=2048,jb(9,rW.bind(null,r,n,a,t),void 0,null),as===null)throw Error(Wr(349));qp&30||tW(r,t,a)}return a}function tW(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Wo.updateQueue,t===null?(t={lastEffect:null,stores:null},Wo.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function rW(e,t,r,n){t.value=r,t.getSnapshot=n,aW(t)&&oW(e)}function nW(e,t,r){return r(function(){aW(t)&&oW(e)})}function aW(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Qd(e,r)}catch{return!0}}function oW(e){var t=Ef(e,1);t!==null&&Kd(t,e,1,-1)}function PL(e){var t=vu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wb,lastRenderedState:e},t.queue=e,e=e.dispatch=Rle.bind(null,Wo,e),[t.memoizedState,e]}function jb(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Wo.updateQueue,t===null?(t={lastEffect:null,stores:null},Wo.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function iW(){return pd().memoizedState}function dj(e,t,r,n){var a=vu();Wo.flags|=e,a.memoizedState=jb(1|t,r,void 0,n===void 0?null:n)}function vS(e,t,r,n){var a=pd();n=n===void 0?null:n;var i=void 0;if(qi!==null){var s=qi.memoizedState;if(i=s.destroy,n!==null&&xT(n,s.deps)){a.memoizedState=jb(t,r,i,n);return}}Wo.flags|=e,a.memoizedState=jb(1|t,r,i,n)}function AL(e,t){return dj(8390656,8,e,t)}function wT(e,t){return vS(2048,8,e,t)}function sW(e,t){return vS(4,2,e,t)}function lW(e,t){return vS(4,4,e,t)}function cW(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function dW(e,t,r){return r=r!=null?r.concat([e]):null,vS(4,4,cW.bind(null,t,e),r)}function jT(){}function uW(e,t){var r=pd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&xT(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function fW(e,t){var r=pd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&xT(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function mW(e,t,r){return qp&21?(Qd(r,t)||(r=xV(),Wo.lanes|=r,zp|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Al=!0),e.memoizedState=r)}function Dle(e,t){var r=to;to=r!==0&&4>r?r:4,e(!0);var n=uP.transition;uP.transition={};try{e(!1),t()}finally{to=r,uP.transition=n}}function hW(){return pd().memoizedState}function Mle(e,t,r){var n=Um(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},pW(e))gW(t,r);else if(r=XV(e,t,r,n),r!==null){var a=hl();Kd(r,e,n,a),vW(r,t,n)}}function Rle(e,t,r){var n=Um(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(pW(e))gW(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,l=i(s,r);if(a.hasEagerState=!0,a.eagerState=l,Qd(l,s)){var c=t.interleaved;c===null?(a.next=a,mT(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=XV(e,t,a,n),r!==null&&(a=hl(),Kd(r,e,n,a),vW(r,t,n))}}function pW(e){var t=e.alternate;return e===Wo||t!==null&&t===Wo}function gW(e,t){Cy=eN=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function vW(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Z4(e,r)}}var tN={readContext:hd,useCallback:ks,useContext:ks,useEffect:ks,useImperativeHandle:ks,useInsertionEffect:ks,useLayoutEffect:ks,useMemo:ks,useReducer:ks,useRef:ks,useState:ks,useDebugValue:ks,useDeferredValue:ks,useTransition:ks,useMutableSource:ks,useSyncExternalStore:ks,useId:ks,unstable_isNewReconciler:!1},Lle={readContext:hd,useCallback:function(e,t){return vu().memoizedState=[e,t===void 0?null:t],e},useContext:hd,useEffect:AL,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,dj(4194308,4,cW.bind(null,t,e),r)},useLayoutEffect:function(e,t){return dj(4194308,4,e,t)},useInsertionEffect:function(e,t){return dj(4,2,e,t)},useMemo:function(e,t){var r=vu();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=vu();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Mle.bind(null,Wo,e),[n.memoizedState,e]},useRef:function(e){var t=vu();return e={current:e},t.memoizedState=e},useState:PL,useDebugValue:jT,useDeferredValue:function(e){return vu().memoizedState=e},useTransition:function(){var e=PL(!1),t=e[0];return e=Dle.bind(null,e[1]),vu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Wo,a=vu();if(Bo){if(r===void 0)throw Error(Wr(407));r=r()}else{if(r=t(),as===null)throw Error(Wr(349));qp&30||tW(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,AL(nW.bind(null,n,i,e),[e]),n.flags|=2048,jb(9,rW.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=vu(),t=as.identifierPrefix;if(Bo){var r=gf,n=pf;r=(n&~(1<<32-Gd(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=bb++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Ile++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$le={readContext:hd,useCallback:uW,useContext:hd,useEffect:wT,useImperativeHandle:dW,useInsertionEffect:sW,useLayoutEffect:lW,useMemo:fW,useReducer:fP,useRef:iW,useState:function(){return fP(wb)},useDebugValue:jT,useDeferredValue:function(e){var t=pd();return mW(t,qi.memoizedState,e)},useTransition:function(){var e=fP(wb)[0],t=pd().memoizedState;return[e,t]},useMutableSource:ZV,useSyncExternalStore:eW,useId:hW,unstable_isNewReconciler:!1},Fle={readContext:hd,useCallback:uW,useContext:hd,useEffect:wT,useImperativeHandle:dW,useInsertionEffect:sW,useLayoutEffect:lW,useMemo:fW,useReducer:mP,useRef:iW,useState:function(){return mP(wb)},useDebugValue:jT,useDeferredValue:function(e){var t=pd();return qi===null?t.memoizedState=e:mW(t,qi.memoizedState,e)},useTransition:function(){var e=mP(wb)[0],t=pd().memoizedState;return[e,t]},useMutableSource:ZV,useSyncExternalStore:eW,useId:hW,unstable_isNewReconciler:!1};function Md(e,t){if(e&&e.defaultProps){t=Go({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function dk(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Go({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var xS={isMounted:function(e){return(e=e._reactInternals)?dg(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=hl(),a=Um(e),i=jf(n,a);i.payload=t,r!=null&&(i.callback=r),t=qm(e,i,a),t!==null&&(Kd(t,e,a,n),lj(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=hl(),a=Um(e),i=jf(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=qm(e,i,a),t!==null&&(Kd(t,e,a,n),lj(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=hl(),n=Um(e),a=jf(r,n);a.tag=2,t!=null&&(a.callback=t),t=qm(e,a,n),t!==null&&(Kd(t,e,n,r),lj(t,e,n))}};function EL(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!hb(r,n)||!hb(a,i):!0}function xW(e,t,r){var n=!1,a=ch,i=t.contextType;return typeof i=="object"&&i!==null?i=hd(i):(a=Tl(t)?Fp:Us.current,n=t.contextTypes,i=(n=n!=null)?ex(e,a):ch),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=xS,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function kL(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&xS.enqueueReplaceState(t,t.state,null)}function uk(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},hT(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=hd(i):(i=Tl(t)?Fp:Us.current,a.context=ex(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(dk(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&xS.enqueueReplaceState(a,a.state,null),Qj(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function ax(e,t){try{var r="",n=t;do r+=mse(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function hP(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function fk(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Ble=typeof WeakMap=="function"?WeakMap:Map;function yW(e,t,r){r=jf(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){nN||(nN=!0,jk=n),fk(e,t)},r}function bW(e,t,r){r=jf(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){fk(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){fk(e,t),typeof n!="function"&&(zm===null?zm=new Set([this]):zm.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function OL(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Ble;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=ece.bind(null,e,t,r),t.then(e,e))}function TL(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function IL(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=jf(-1,1),t.tag=2,qm(r,t,1))),r.lanes|=1),e)}var qle=qf.ReactCurrentOwner,Al=!1;function il(e,t,r,n){t.child=e===null?YV(t,null,r,n):rx(t,e.child,r,n)}function DL(e,t,r,n,a){r=r.render;var i=t.ref;return Iv(t,a),n=yT(e,t,r,n,i,a),r=bT(),e!==null&&!Al?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,kf(e,t,a)):(Bo&&r&&sT(t),t.flags|=1,il(e,t,n,a),t.child)}function ML(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!kT(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,wW(e,t,i,n,a)):(e=hj(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:hb,r(s,n)&&e.ref===t.ref)return kf(e,t,a)}return t.flags|=1,e=Vm(i,n),e.ref=t.ref,e.return=t,t.child=e}function wW(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(hb(i,n)&&e.ref===t.ref)if(Al=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(Al=!0);else return t.lanes=e.lanes,kf(e,t,a)}return mk(e,t,r,n,a)}function jW(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},jo(vv,nc),nc|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,jo(vv,nc),nc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,jo(vv,nc),nc|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,jo(vv,nc),nc|=n;return il(e,t,a,r),t.child}function NW(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function mk(e,t,r,n,a){var i=Tl(r)?Fp:Us.current;return i=ex(t,i),Iv(t,a),r=yT(e,t,r,n,i,a),n=bT(),e!==null&&!Al?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,kf(e,t,a)):(Bo&&n&&sT(t),t.flags|=1,il(e,t,r,a),t.child)}function RL(e,t,r,n,a){if(Tl(r)){var i=!0;Gj(t)}else i=!1;if(Iv(t,a),t.stateNode===null)uj(e,t),xW(t,r,n),uk(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,l=t.memoizedProps;s.props=l;var c=s.context,d=r.contextType;typeof d=="object"&&d!==null?d=hd(d):(d=Tl(r)?Fp:Us.current,d=ex(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==n||c!==d)&&kL(t,s,n,d),vm=!1;var m=t.memoizedState;s.state=m,Qj(t,n,s,a),c=t.memoizedState,l!==n||m!==c||Ol.current||vm?(typeof u=="function"&&(dk(t,r,u,n),c=t.memoizedState),(l=vm||EL(t,r,l,n,m,c,d))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=d,n=l):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,JV(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Md(t.type,l),s.props=d,f=t.pendingProps,m=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=hd(c):(c=Tl(r)?Fp:Us.current,c=ex(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||m!==c)&&kL(t,s,n,c),vm=!1,m=t.memoizedState,s.state=m,Qj(t,n,s,a);var v=t.memoizedState;l!==f||m!==v||Ol.current||vm?(typeof h=="function"&&(dk(t,r,h,n),v=t.memoizedState),(d=vm||EL(t,r,d,n,m,v,c)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,v,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,v,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),s.props=n,s.state=v,s.context=c,n=d):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return hk(e,t,r,n,i,a)}function hk(e,t,r,n,a,i){NW(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&wL(t,r,!1),kf(e,t,i);n=t.stateNode,qle.current=t;var l=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=rx(t,e.child,null,i),t.child=rx(t,null,l,i)):il(e,t,l,i),t.memoizedState=n.state,a&&wL(t,r,!0),t.child}function _W(e){var t=e.stateNode;t.pendingContext?bL(e,t.pendingContext,t.pendingContext!==t.context):t.context&&bL(e,t.context,!1),pT(e,t.containerInfo)}function LL(e,t,r,n,a){return tx(),cT(a),t.flags|=256,il(e,t,r,n),t.child}var pk={dehydrated:null,treeContext:null,retryLane:0};function gk(e){return{baseLanes:e,cachePool:null,transitions:null}}function SW(e,t,r){var n=t.pendingProps,a=Uo.current,i=!1,s=(t.flags&128)!==0,l;if((l=s)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),jo(Uo,a&1),e===null)return lk(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=wS(s,n,0,null),e=Cp(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=gk(r),t.memoizedState=pk,e):NT(t,s));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return zle(e,t,s,n,l,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Vm(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Vm(l,i):(i=Cp(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?gk(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=pk,n}return i=e.child,e=i.sibling,n=Vm(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function NT(e,t){return t=wS({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Zw(e,t,r,n){return n!==null&&cT(n),rx(t,e.child,null,r),e=NT(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function zle(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=hP(Error(Wr(422))),Zw(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=wS({mode:"visible",children:n.children},a,0,null),i=Cp(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&rx(t,e.child,null,s),t.child.memoizedState=gk(s),t.memoizedState=pk,i);if(!(t.mode&1))return Zw(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Wr(419)),n=hP(i,n,void 0),Zw(e,t,s,n)}if(l=(s&e.childLanes)!==0,Al||l){if(n=as,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Ef(e,a),Kd(n,e,a,-1))}return ET(),n=hP(Error(Wr(421))),Zw(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=tce.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,dc=Bm(a.nextSibling),hc=t,Bo=!0,Bd=null,e!==null&&(Hc[Gc++]=pf,Hc[Gc++]=gf,Hc[Gc++]=Bp,pf=e.id,gf=e.overflow,Bp=t),t=NT(t,n.children),t.flags|=4096,t)}function $L(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ck(e.return,t,r)}function pP(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function CW(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(il(e,t,n.children,r),n=Uo.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$L(e,r,t);else if(e.tag===19)$L(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(jo(Uo,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Zj(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),pP(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Zj(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}pP(t,!0,r,null,i);break;case"together":pP(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function uj(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function kf(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),zp|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Wr(153));if(t.child!==null){for(e=t.child,r=Vm(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Vm(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Ule(e,t,r){switch(t.tag){case 3:_W(t),tx();break;case 5:QV(t);break;case 1:Tl(t.type)&&Gj(t);break;case 4:pT(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;jo(Xj,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(jo(Uo,Uo.current&1),t.flags|=128,null):r&t.child.childLanes?SW(e,t,r):(jo(Uo,Uo.current&1),e=kf(e,t,r),e!==null?e.sibling:null);jo(Uo,Uo.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return CW(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),jo(Uo,Uo.current),n)break;return null;case 22:case 23:return t.lanes=0,jW(e,t,r)}return kf(e,t,r)}var PW,vk,AW,EW;PW=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};vk=function(){};AW=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,dp(Ou.current);var i=null;switch(r){case"input":a=FE(e,a),n=FE(e,n),i=[];break;case"select":a=Go({},a,{value:void 0}),n=Go({},n,{value:void 0}),i=[];break;case"textarea":a=zE(e,a),n=zE(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Wj)}VE(r,n);var s;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(sb.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=a?.[d],n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(sb.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Eo("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};EW=function(e,t,r,n){r!==n&&(t.flags|=4)};function L0(e,t){if(!Bo)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Os(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Vle(e,t,r){var n=t.pendingProps;switch(lT(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Os(t),null;case 1:return Tl(t.type)&&Hj(),Os(t),null;case 3:return n=t.stateNode,nx(),Io(Ol),Io(Us),vT(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Jw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Bd!==null&&(Sk(Bd),Bd=null))),vk(e,t),Os(t),null;case 5:gT(t);var a=dp(yb.current);if(r=t.type,e!==null&&t.stateNode!=null)AW(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Wr(166));return Os(t),null}if(e=dp(Ou.current),Jw(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[yu]=t,n[vb]=i,e=(t.mode&1)!==0,r){case"dialog":Eo("cancel",n),Eo("close",n);break;case"iframe":case"object":case"embed":Eo("load",n);break;case"video":case"audio":for(a=0;a<my.length;a++)Eo(my[a],n);break;case"source":Eo("error",n);break;case"img":case"image":case"link":Eo("error",n),Eo("load",n);break;case"details":Eo("toggle",n);break;case"input":GR(n,i),Eo("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Eo("invalid",n);break;case"textarea":YR(n,i),Eo("invalid",n)}VE(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var l=i[s];s==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Xw(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Xw(n.textContent,l,e),a=["children",""+l]):sb.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&Eo("scroll",n)}switch(r){case"input":zw(n),KR(n,i,!0);break;case"textarea":zw(n),XR(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Wj)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=nV(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[yu]=t,e[vb]=n,PW(e,t,!1,!1),t.stateNode=e;e:{switch(s=WE(r,n),r){case"dialog":Eo("cancel",e),Eo("close",e),a=n;break;case"iframe":case"object":case"embed":Eo("load",e),a=n;break;case"video":case"audio":for(a=0;a<my.length;a++)Eo(my[a],e);a=n;break;case"source":Eo("error",e),a=n;break;case"img":case"image":case"link":Eo("error",e),Eo("load",e),a=n;break;case"details":Eo("toggle",e),a=n;break;case"input":GR(e,n),a=FE(e,n),Eo("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Go({},n,{value:void 0}),Eo("invalid",e);break;case"textarea":YR(e,n),a=zE(e,n),Eo("invalid",e);break;default:a=n}VE(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?iV(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&aV(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&lb(e,c):typeof c=="number"&&lb(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(sb.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Eo("scroll",e):c!=null&&G4(e,i,c,s))}switch(r){case"input":zw(e),KR(e,n,!1);break;case"textarea":zw(e),XR(e);break;case"option":n.value!=null&&e.setAttribute("value",""+lh(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ev(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ev(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Wj)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Os(t),null;case 6:if(e&&t.stateNode!=null)EW(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Wr(166));if(r=dp(yb.current),dp(Ou.current),Jw(t)){if(n=t.stateNode,r=t.memoizedProps,n[yu]=t,(i=n.nodeValue!==r)&&(e=hc,e!==null))switch(e.tag){case 3:Xw(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Xw(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[yu]=t,t.stateNode=n}return Os(t),null;case 13:if(Io(Uo),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Bo&&dc!==null&&t.mode&1&&!(t.flags&128))GV(),tx(),t.flags|=98560,i=!1;else if(i=Jw(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Wr(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Wr(317));i[yu]=t}else tx(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Os(t),i=!1}else Bd!==null&&(Sk(Bd),Bd=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Uo.current&1?Hi===0&&(Hi=3):ET())),t.updateQueue!==null&&(t.flags|=4),Os(t),null);case 4:return nx(),vk(e,t),e===null&&pb(t.stateNode.containerInfo),Os(t),null;case 10:return fT(t.type._context),Os(t),null;case 17:return Tl(t.type)&&Hj(),Os(t),null;case 19:if(Io(Uo),i=t.memoizedState,i===null)return Os(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)L0(i,!1);else{if(Hi!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Zj(e),s!==null){for(t.flags|=128,L0(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return jo(Uo,Uo.current&1|2),t.child}e=e.sibling}i.tail!==null&&di()>ox&&(t.flags|=128,n=!0,L0(i,!1),t.lanes=4194304)}else{if(!n)if(e=Zj(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),L0(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!Bo)return Os(t),null}else 2*di()-i.renderingStartTime>ox&&r!==1073741824&&(t.flags|=128,n=!0,L0(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=di(),t.sibling=null,r=Uo.current,jo(Uo,n?r&1|2:r&1),t):(Os(t),null);case 22:case 23:return AT(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?nc&1073741824&&(Os(t),t.subtreeFlags&6&&(t.flags|=8192)):Os(t),null;case 24:return null;case 25:return null}throw Error(Wr(156,t.tag))}function Wle(e,t){switch(lT(t),t.tag){case 1:return Tl(t.type)&&Hj(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return nx(),Io(Ol),Io(Us),vT(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return gT(t),null;case 13:if(Io(Uo),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Wr(340));tx()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Io(Uo),null;case 4:return nx(),null;case 10:return fT(t.type._context),null;case 22:case 23:return AT(),null;case 24:return null;default:return null}}var e2=!1,Fs=!1,Hle=typeof WeakSet=="function"?WeakSet:Set,fn=null;function gv(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Zo(e,t,n)}else r.current=null}function xk(e,t,r){try{r()}catch(n){Zo(e,t,n)}}var FL=!1;function Gle(e,t){if(tk=zj,e=DV(),iT(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,l=-1,c=-1,d=0,u=0,f=e,m=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(l=s+a),f!==i||n!==0&&f.nodeType!==3||(c=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)m=f,f=h;for(;;){if(f===e)break t;if(m===r&&++d===a&&(l=s),m===i&&++u===n&&(c=s),(h=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(rk={focusedElem:e,selectionRange:r},zj=!1,fn=t;fn!==null;)if(t=fn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,fn=e;else for(;fn!==null;){t=fn;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,x=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:Md(t.type,g),x);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Wr(163))}}catch(j){Zo(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,fn=e;break}fn=t.return}return v=FL,FL=!1,v}function Py(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&xk(t,r,i)}a=a.next}while(a!==n)}}function yS(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function yk(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function kW(e){var t=e.alternate;t!==null&&(e.alternate=null,kW(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[yu],delete t[vb],delete t[ok],delete t[Ele],delete t[kle])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function OW(e){return e.tag===5||e.tag===3||e.tag===4}function BL(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||OW(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function bk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Wj));else if(n!==4&&(e=e.child,e!==null))for(bk(e,t,r),e=e.sibling;e!==null;)bk(e,t,r),e=e.sibling}function wk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(wk(e,t,r),e=e.sibling;e!==null;)wk(e,t,r),e=e.sibling}var bs=null,Rd=!1;function nm(e,t,r){for(r=r.child;r!==null;)TW(e,t,r),r=r.sibling}function TW(e,t,r){if(ku&&typeof ku.onCommitFiberUnmount=="function")try{ku.onCommitFiberUnmount(uS,r)}catch{}switch(r.tag){case 5:Fs||gv(r,t);case 6:var n=bs,a=Rd;bs=null,nm(e,t,r),bs=n,Rd=a,bs!==null&&(Rd?(e=bs,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):bs.removeChild(r.stateNode));break;case 18:bs!==null&&(Rd?(e=bs,r=r.stateNode,e.nodeType===8?lP(e.parentNode,r):e.nodeType===1&&lP(e,r),fb(e)):lP(bs,r.stateNode));break;case 4:n=bs,a=Rd,bs=r.stateNode.containerInfo,Rd=!0,nm(e,t,r),bs=n,Rd=a;break;case 0:case 11:case 14:case 15:if(!Fs&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&xk(r,t,s),a=a.next}while(a!==n)}nm(e,t,r);break;case 1:if(!Fs&&(gv(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Zo(r,t,l)}nm(e,t,r);break;case 21:nm(e,t,r);break;case 22:r.mode&1?(Fs=(n=Fs)||r.memoizedState!==null,nm(e,t,r),Fs=n):nm(e,t,r);break;default:nm(e,t,r)}}function qL(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Hle),t.forEach(function(n){var a=rce.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ad(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,l=s;e:for(;l!==null;){switch(l.tag){case 5:bs=l.stateNode,Rd=!1;break e;case 3:bs=l.stateNode.containerInfo,Rd=!0;break e;case 4:bs=l.stateNode.containerInfo,Rd=!0;break e}l=l.return}if(bs===null)throw Error(Wr(160));TW(i,s,a),bs=null,Rd=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){Zo(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)IW(t,e),t=t.sibling}function IW(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ad(t,e),uu(e),n&4){try{Py(3,e,e.return),yS(3,e)}catch(g){Zo(e,e.return,g)}try{Py(5,e,e.return)}catch(g){Zo(e,e.return,g)}}break;case 1:Ad(t,e),uu(e),n&512&&r!==null&&gv(r,r.return);break;case 5:if(Ad(t,e),uu(e),n&512&&r!==null&&gv(r,r.return),e.flags&32){var a=e.stateNode;try{lb(a,"")}catch(g){Zo(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&tV(a,i),WE(l,s);var d=WE(l,i);for(s=0;s<c.length;s+=2){var u=c[s],f=c[s+1];u==="style"?iV(a,f):u==="dangerouslySetInnerHTML"?aV(a,f):u==="children"?lb(a,f):G4(a,u,f,d)}switch(l){case"input":BE(a,i);break;case"textarea":rV(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Ev(a,!!i.multiple,h,!1):m!==!!i.multiple&&(i.defaultValue!=null?Ev(a,!!i.multiple,i.defaultValue,!0):Ev(a,!!i.multiple,i.multiple?[]:"",!1))}a[vb]=i}catch(g){Zo(e,e.return,g)}}break;case 6:if(Ad(t,e),uu(e),n&4){if(e.stateNode===null)throw Error(Wr(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){Zo(e,e.return,g)}}break;case 3:if(Ad(t,e),uu(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{fb(t.containerInfo)}catch(g){Zo(e,e.return,g)}break;case 4:Ad(t,e),uu(e);break;case 13:Ad(t,e),uu(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(CT=di())),n&4&&qL(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Fs=(d=Fs)||u,Ad(t,e),Fs=d):Ad(t,e),uu(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(fn=e,u=e.child;u!==null;){for(f=fn=u;fn!==null;){switch(m=fn,h=m.child,m.tag){case 0:case 11:case 14:case 15:Py(4,m,m.return);break;case 1:gv(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Zo(n,r,g)}}break;case 5:gv(m,m.return);break;case 22:if(m.memoizedState!==null){UL(f);continue}}h!==null?(h.return=m,fn=h):UL(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=oV("display",s))}catch(g){Zo(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){Zo(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ad(t,e),uu(e),n&4&&qL(e);break;case 21:break;default:Ad(t,e),uu(e)}}function uu(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(OW(r)){var n=r;break e}r=r.return}throw Error(Wr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(lb(a,""),n.flags&=-33);var i=BL(e);wk(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,l=BL(e);bk(e,l,s);break;default:throw Error(Wr(161))}}catch(c){Zo(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Kle(e,t,r){fn=e,DW(e)}function DW(e,t,r){for(var n=(e.mode&1)!==0;fn!==null;){var a=fn,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||e2;if(!s){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Fs;l=e2;var d=Fs;if(e2=s,(Fs=c)&&!d)for(fn=a;fn!==null;)s=fn,c=s.child,s.tag===22&&s.memoizedState!==null?VL(a):c!==null?(c.return=s,fn=c):VL(a);for(;i!==null;)fn=i,DW(i),i=i.sibling;fn=a,e2=l,Fs=d}zL(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,fn=i):zL(e)}}function zL(e){for(;fn!==null;){var t=fn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Fs||yS(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Fs)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Md(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&CL(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}CL(t,s,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&fb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Wr(163))}Fs||t.flags&512&&yk(t)}catch(m){Zo(t,t.return,m)}}if(t===e){fn=null;break}if(r=t.sibling,r!==null){r.return=t.return,fn=r;break}fn=t.return}}function UL(e){for(;fn!==null;){var t=fn;if(t===e){fn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,fn=r;break}fn=t.return}}function VL(e){for(;fn!==null;){var t=fn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{yS(4,t)}catch(c){Zo(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){Zo(t,a,c)}}var i=t.return;try{yk(t)}catch(c){Zo(t,i,c)}break;case 5:var s=t.return;try{yk(t)}catch(c){Zo(t,s,c)}}}catch(c){Zo(t,t.return,c)}if(t===e){fn=null;break}var l=t.sibling;if(l!==null){l.return=t.return,fn=l;break}fn=t.return}}var Yle=Math.ceil,rN=qf.ReactCurrentDispatcher,_T=qf.ReactCurrentOwner,cd=qf.ReactCurrentBatchConfig,Ua=0,as=null,Ci=null,Ns=0,nc=0,vv=bh(0),Hi=0,Nb=null,zp=0,bS=0,ST=0,Ay=null,Cl=null,CT=0,ox=1/0,lf=null,nN=!1,jk=null,zm=null,t2=!1,Am=null,aN=0,Ey=0,Nk=null,fj=-1,mj=0;function hl(){return Ua&6?di():fj!==-1?fj:fj=di()}function Um(e){return e.mode&1?Ua&2&&Ns!==0?Ns&-Ns:Tle.transition!==null?(mj===0&&(mj=xV()),mj):(e=to,e!==0||(e=window.event,e=e===void 0?16:SV(e.type)),e):1}function Kd(e,t,r,n){if(50<Ey)throw Ey=0,Nk=null,Error(Wr(185));$1(e,r,n),(!(Ua&2)||e!==as)&&(e===as&&(!(Ua&2)&&(bS|=r),Hi===4&&jm(e,Ns)),Il(e,n),r===1&&Ua===0&&!(t.mode&1)&&(ox=di()+500,gS&&wh()))}function Il(e,t){var r=e.callbackNode;Tse(e,t);var n=qj(e,e===as?Ns:0);if(n===0)r!==null&&ZR(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&ZR(r),t===1)e.tag===0?Ole(WL.bind(null,e)):VV(WL.bind(null,e)),Ple(function(){!(Ua&6)&&wh()}),r=null;else{switch(yV(n)){case 1:r=Q4;break;case 4:r=gV;break;case 16:r=Bj;break;case 536870912:r=vV;break;default:r=Bj}r=zW(r,MW.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function MW(e,t){if(fj=-1,mj=0,Ua&6)throw Error(Wr(327));var r=e.callbackNode;if(Dv()&&e.callbackNode!==r)return null;var n=qj(e,e===as?Ns:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=oN(e,n);else{t=n;var a=Ua;Ua|=2;var i=LW();(as!==e||Ns!==t)&&(lf=null,ox=di()+500,Sp(e,t));do try{Qle();break}catch(l){RW(e,l)}while(1);uT(),rN.current=i,Ua=a,Ci!==null?t=0:(as=null,Ns=0,t=Hi)}if(t!==0){if(t===2&&(a=XE(e),a!==0&&(n=a,t=_k(e,a))),t===1)throw r=Nb,Sp(e,0),jm(e,n),Il(e,di()),r;if(t===6)jm(e,n);else{if(a=e.current.alternate,!(n&30)&&!Xle(a)&&(t=oN(e,n),t===2&&(i=XE(e),i!==0&&(n=i,t=_k(e,i))),t===1))throw r=Nb,Sp(e,0),jm(e,n),Il(e,di()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Wr(345));case 2:Gh(e,Cl,lf);break;case 3:if(jm(e,n),(n&130023424)===n&&(t=CT+500-di(),10<t)){if(qj(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){hl(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ak(Gh.bind(null,e,Cl,lf),t);break}Gh(e,Cl,lf);break;case 4:if(jm(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-Gd(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=di()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Yle(n/1960))-n,10<n){e.timeoutHandle=ak(Gh.bind(null,e,Cl,lf),n);break}Gh(e,Cl,lf);break;case 5:Gh(e,Cl,lf);break;default:throw Error(Wr(329))}}}return Il(e,di()),e.callbackNode===r?MW.bind(null,e):null}function _k(e,t){var r=Ay;return e.current.memoizedState.isDehydrated&&(Sp(e,t).flags|=256),e=oN(e,t),e!==2&&(t=Cl,Cl=r,t!==null&&Sk(t)),e}function Sk(e){Cl===null?Cl=e:Cl.push.apply(Cl,e)}function Xle(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Qd(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function jm(e,t){for(t&=~ST,t&=~bS,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Gd(t),n=1<<r;e[r]=-1,t&=~n}}function WL(e){if(Ua&6)throw Error(Wr(327));Dv();var t=qj(e,0);if(!(t&1))return Il(e,di()),null;var r=oN(e,t);if(e.tag!==0&&r===2){var n=XE(e);n!==0&&(t=n,r=_k(e,n))}if(r===1)throw r=Nb,Sp(e,0),jm(e,t),Il(e,di()),r;if(r===6)throw Error(Wr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Gh(e,Cl,lf),Il(e,di()),null}function PT(e,t){var r=Ua;Ua|=1;try{return e(t)}finally{Ua=r,Ua===0&&(ox=di()+500,gS&&wh())}}function Up(e){Am!==null&&Am.tag===0&&!(Ua&6)&&Dv();var t=Ua;Ua|=1;var r=cd.transition,n=to;try{if(cd.transition=null,to=1,e)return e()}finally{to=n,cd.transition=r,Ua=t,!(Ua&6)&&wh()}}function AT(){nc=vv.current,Io(vv)}function Sp(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Cle(r)),Ci!==null)for(r=Ci.return;r!==null;){var n=r;switch(lT(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Hj();break;case 3:nx(),Io(Ol),Io(Us),vT();break;case 5:gT(n);break;case 4:nx();break;case 13:Io(Uo);break;case 19:Io(Uo);break;case 10:fT(n.type._context);break;case 22:case 23:AT()}r=r.return}if(as=e,Ci=e=Vm(e.current,null),Ns=nc=t,Hi=0,Nb=null,ST=bS=zp=0,Cl=Ay=null,cp!==null){for(t=0;t<cp.length;t++)if(r=cp[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}cp=null}return e}function RW(e,t){do{var r=Ci;try{if(uT(),cj.current=tN,eN){for(var n=Wo.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}eN=!1}if(qp=0,ts=qi=Wo=null,Cy=!1,bb=0,_T.current=null,r===null||r.return===null){Hi=1,Nb=t,Ci=null;break}e:{var i=e,s=r.return,l=r,c=t;if(t=Ns,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=TL(s);if(h!==null){h.flags&=-257,IL(h,s,l,i,t),h.mode&1&&OL(i,d,t),t=h,c=d;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){OL(i,d,t),ET();break e}c=Error(Wr(426))}}else if(Bo&&l.mode&1){var x=TL(s);if(x!==null){!(x.flags&65536)&&(x.flags|=256),IL(x,s,l,i,t),cT(ax(c,l));break e}}i=c=ax(c,l),Hi!==4&&(Hi=2),Ay===null?Ay=[i]:Ay.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=yW(i,c,t);SL(i,y);break e;case 1:l=c;var b=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(zm===null||!zm.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=bW(i,l,t);SL(i,j);break e}}i=i.return}while(i!==null)}FW(r)}catch(_){t=_,Ci===r&&r!==null&&(Ci=r=r.return);continue}break}while(1)}function LW(){var e=rN.current;return rN.current=tN,e===null?tN:e}function ET(){(Hi===0||Hi===3||Hi===2)&&(Hi=4),as===null||!(zp&268435455)&&!(bS&268435455)||jm(as,Ns)}function oN(e,t){var r=Ua;Ua|=2;var n=LW();(as!==e||Ns!==t)&&(lf=null,Sp(e,t));do try{Jle();break}catch(a){RW(e,a)}while(1);if(uT(),Ua=r,rN.current=n,Ci!==null)throw Error(Wr(261));return as=null,Ns=0,Hi}function Jle(){for(;Ci!==null;)$W(Ci)}function Qle(){for(;Ci!==null&&!Nse();)$W(Ci)}function $W(e){var t=qW(e.alternate,e,nc);e.memoizedProps=e.pendingProps,t===null?FW(e):Ci=t,_T.current=null}function FW(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Wle(r,t),r!==null){r.flags&=32767,Ci=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Hi=6,Ci=null;return}}else if(r=Vle(r,t,nc),r!==null){Ci=r;return}if(t=t.sibling,t!==null){Ci=t;return}Ci=t=e}while(t!==null);Hi===0&&(Hi=5)}function Gh(e,t,r){var n=to,a=cd.transition;try{cd.transition=null,to=1,Zle(e,t,r,n)}finally{cd.transition=a,to=n}return null}function Zle(e,t,r,n){do Dv();while(Am!==null);if(Ua&6)throw Error(Wr(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Wr(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Ise(e,i),e===as&&(Ci=as=null,Ns=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||t2||(t2=!0,zW(Bj,function(){return Dv(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=cd.transition,cd.transition=null;var s=to;to=1;var l=Ua;Ua|=4,_T.current=null,Gle(e,r),IW(r,e),yle(rk),zj=!!tk,rk=tk=null,e.current=r,Kle(r),_se(),Ua=l,to=s,cd.transition=i}else e.current=r;if(t2&&(t2=!1,Am=e,aN=a),i=e.pendingLanes,i===0&&(zm=null),Pse(r.stateNode),Il(e,di()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(nN)throw nN=!1,e=jk,jk=null,e;return aN&1&&e.tag!==0&&Dv(),i=e.pendingLanes,i&1?e===Nk?Ey++:(Ey=0,Nk=e):Ey=0,wh(),null}function Dv(){if(Am!==null){var e=yV(aN),t=cd.transition,r=to;try{if(cd.transition=null,to=16>e?16:e,Am===null)var n=!1;else{if(e=Am,Am=null,aN=0,Ua&6)throw Error(Wr(331));var a=Ua;for(Ua|=4,fn=e.current;fn!==null;){var i=fn,s=i.child;if(fn.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(fn=d;fn!==null;){var u=fn;switch(u.tag){case 0:case 11:case 15:Py(8,u,i)}var f=u.child;if(f!==null)f.return=u,fn=f;else for(;fn!==null;){u=fn;var m=u.sibling,h=u.return;if(kW(u),u===d){fn=null;break}if(m!==null){m.return=h,fn=m;break}fn=h}}}var v=i.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(g!==null)}}fn=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,fn=s;else e:for(;fn!==null;){if(i=fn,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Py(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,fn=y;break e}fn=i.return}}var b=e.current;for(fn=b;fn!==null;){s=fn;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,fn=w;else e:for(s=b;fn!==null;){if(l=fn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:yS(9,l)}}catch(_){Zo(l,l.return,_)}if(l===s){fn=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,fn=j;break e}fn=l.return}}if(Ua=a,wh(),ku&&typeof ku.onPostCommitFiberRoot=="function")try{ku.onPostCommitFiberRoot(uS,e)}catch{}n=!0}return n}finally{to=r,cd.transition=t}}return!1}function HL(e,t,r){t=ax(r,t),t=yW(e,t,1),e=qm(e,t,1),t=hl(),e!==null&&($1(e,1,t),Il(e,t))}function Zo(e,t,r){if(e.tag===3)HL(e,e,r);else for(;t!==null;){if(t.tag===3){HL(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(zm===null||!zm.has(n))){e=ax(r,e),e=bW(t,e,1),t=qm(t,e,1),e=hl(),t!==null&&($1(t,1,e),Il(t,e));break}}t=t.return}}function ece(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=hl(),e.pingedLanes|=e.suspendedLanes&r,as===e&&(Ns&r)===r&&(Hi===4||Hi===3&&(Ns&130023424)===Ns&&500>di()-CT?Sp(e,0):ST|=r),Il(e,t)}function BW(e,t){t===0&&(e.mode&1?(t=Ww,Ww<<=1,!(Ww&130023424)&&(Ww=4194304)):t=1);var r=hl();e=Ef(e,t),e!==null&&($1(e,t,r),Il(e,r))}function tce(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),BW(e,r)}function rce(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Wr(314))}n!==null&&n.delete(t),BW(e,r)}var qW;qW=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ol.current)Al=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Al=!1,Ule(e,t,r);Al=!!(e.flags&131072)}else Al=!1,Bo&&t.flags&1048576&&WV(t,Yj,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;uj(e,t),e=t.pendingProps;var a=ex(t,Us.current);Iv(t,r),a=yT(null,t,n,e,a,r);var i=bT();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Tl(n)?(i=!0,Gj(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,hT(t),a.updater=xS,t.stateNode=a,a._reactInternals=t,uk(t,n,e,r),t=hk(null,t,n,!0,i,r)):(t.tag=0,Bo&&i&&sT(t),il(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(uj(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=ace(n),e=Md(n,e),a){case 0:t=mk(null,t,n,e,r);break e;case 1:t=RL(null,t,n,e,r);break e;case 11:t=DL(null,t,n,e,r);break e;case 14:t=ML(null,t,n,Md(n.type,e),r);break e}throw Error(Wr(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Md(n,a),mk(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Md(n,a),RL(e,t,n,a,r);case 3:e:{if(_W(t),e===null)throw Error(Wr(387));n=t.pendingProps,i=t.memoizedState,a=i.element,JV(e,t),Qj(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=ax(Error(Wr(423)),t),t=LL(e,t,n,r,a);break e}else if(n!==a){a=ax(Error(Wr(424)),t),t=LL(e,t,n,r,a);break e}else for(dc=Bm(t.stateNode.containerInfo.firstChild),hc=t,Bo=!0,Bd=null,r=YV(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(tx(),n===a){t=kf(e,t,r);break e}il(e,t,n,r)}t=t.child}return t;case 5:return QV(t),e===null&&lk(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,nk(n,a)?s=null:i!==null&&nk(n,i)&&(t.flags|=32),NW(e,t),il(e,t,s,r),t.child;case 6:return e===null&&lk(t),null;case 13:return SW(e,t,r);case 4:return pT(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=rx(t,null,n,r):il(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Md(n,a),DL(e,t,n,a,r);case 7:return il(e,t,t.pendingProps,r),t.child;case 8:return il(e,t,t.pendingProps.children,r),t.child;case 12:return il(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,jo(Xj,n._currentValue),n._currentValue=s,i!==null)if(Qd(i.value,s)){if(i.children===a.children&&!Ol.current){t=kf(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){s=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=jf(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),ck(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(Wr(341));s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),ck(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}il(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Iv(t,r),a=hd(a),n=n(a),t.flags|=1,il(e,t,n,r),t.child;case 14:return n=t.type,a=Md(n,t.pendingProps),a=Md(n.type,a),ML(e,t,n,a,r);case 15:return wW(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Md(n,a),uj(e,t),t.tag=1,Tl(n)?(e=!0,Gj(t)):e=!1,Iv(t,r),xW(t,n,a),uk(t,n,a,r),hk(null,t,n,!0,e,r);case 19:return CW(e,t,r);case 22:return jW(e,t,r)}throw Error(Wr(156,t.tag))};function zW(e,t){return pV(e,t)}function nce(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rd(e,t,r,n){return new nce(e,t,r,n)}function kT(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ace(e){if(typeof e=="function")return kT(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Y4)return 11;if(e===X4)return 14}return 2}function Vm(e,t){var r=e.alternate;return r===null?(r=rd(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function hj(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")kT(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case sv:return Cp(r.children,a,i,t);case K4:s=8,a|=8;break;case ME:return e=rd(12,r,t,a|2),e.elementType=ME,e.lanes=i,e;case RE:return e=rd(13,r,t,a),e.elementType=RE,e.lanes=i,e;case LE:return e=rd(19,r,t,a),e.elementType=LE,e.lanes=i,e;case QU:return wS(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case XU:s=10;break e;case JU:s=9;break e;case Y4:s=11;break e;case X4:s=14;break e;case gm:s=16,n=null;break e}throw Error(Wr(130,e==null?e:typeof e,""))}return t=rd(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Cp(e,t,r,n){return e=rd(7,e,n,t),e.lanes=r,e}function wS(e,t,r,n){return e=rd(22,e,n,t),e.elementType=QU,e.lanes=r,e.stateNode={isHidden:!1},e}function gP(e,t,r){return e=rd(6,e,null,t),e.lanes=r,e}function vP(e,t,r){return t=rd(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function oce(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=J5(0),this.expirationTimes=J5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=J5(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function OT(e,t,r,n,a,i,s,l,c){return e=new oce(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=rd(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},hT(i),e}function ice(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:iv,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function UW(e){if(!e)return ch;e=e._reactInternals;e:{if(dg(e)!==e||e.tag!==1)throw Error(Wr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Tl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Wr(171))}if(e.tag===1){var r=e.type;if(Tl(r))return UV(e,r,t)}return t}function VW(e,t,r,n,a,i,s,l,c){return e=OT(r,n,!0,e,a,i,s,l,c),e.context=UW(null),r=e.current,n=hl(),a=Um(r),i=jf(n,a),i.callback=t??null,qm(r,i,a),e.current.lanes=a,$1(e,a,n),Il(e,n),e}function jS(e,t,r,n){var a=t.current,i=hl(),s=Um(a);return r=UW(r),t.context===null?t.context=r:t.pendingContext=r,t=jf(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=qm(a,t,s),e!==null&&(Kd(e,a,s,i),lj(e,a,s)),s}function iN(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function GL(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function TT(e,t){GL(e,t),(e=e.alternate)&&GL(e,t)}function sce(){return null}var WW=typeof reportError=="function"?reportError:function(e){console.error(e)};function IT(e){this._internalRoot=e}NS.prototype.render=IT.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Wr(409));jS(e,t,null,null)};NS.prototype.unmount=IT.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Up(function(){jS(null,e,null,null)}),t[Af]=null}};function NS(e){this._internalRoot=e}NS.prototype.unstable_scheduleHydration=function(e){if(e){var t=jV();e={blockedOn:null,target:e,priority:t};for(var r=0;r<wm.length&&t!==0&&t<wm[r].priority;r++);wm.splice(r,0,e),r===0&&_V(e)}};function DT(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function _S(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function KL(){}function lce(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=iN(s);i.call(d)}}var s=VW(t,n,e,0,null,!1,!1,"",KL);return e._reactRootContainer=s,e[Af]=s.current,pb(e.nodeType===8?e.parentNode:e),Up(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var d=iN(c);l.call(d)}}var c=OT(e,0,!1,null,null,!1,!1,"",KL);return e._reactRootContainer=c,e[Af]=c.current,pb(e.nodeType===8?e.parentNode:e),Up(function(){jS(t,c,r,n)}),c}function SS(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var l=a;a=function(){var c=iN(s);l.call(c)}}jS(t,s,e,a)}else s=lce(r,t,e,a,n);return iN(s)}bV=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=fy(t.pendingLanes);r!==0&&(Z4(t,r|1),Il(t,di()),!(Ua&6)&&(ox=di()+500,wh()))}break;case 13:Up(function(){var n=Ef(e,1);if(n!==null){var a=hl();Kd(n,e,1,a)}}),TT(e,1)}};eT=function(e){if(e.tag===13){var t=Ef(e,134217728);if(t!==null){var r=hl();Kd(t,e,134217728,r)}TT(e,134217728)}};wV=function(e){if(e.tag===13){var t=Um(e),r=Ef(e,t);if(r!==null){var n=hl();Kd(r,e,t,n)}TT(e,t)}};jV=function(){return to};NV=function(e,t){var r=to;try{return to=e,t()}finally{to=r}};GE=function(e,t,r){switch(t){case"input":if(BE(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=pS(n);if(!a)throw Error(Wr(90));eV(n),BE(n,a)}}}break;case"textarea":rV(e,r);break;case"select":t=r.value,t!=null&&Ev(e,!!r.multiple,t,!1)}};cV=PT;dV=Up;var cce={usingClientEntryPoint:!1,Events:[B1,uv,pS,sV,lV,PT]},$0={findFiberByHostInstance:lp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dce={bundleType:$0.bundleType,version:$0.version,rendererPackageName:$0.rendererPackageName,rendererConfig:$0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=mV(e),e===null?null:e.stateNode},findFiberByHostInstance:$0.findFiberByHostInstance||sce,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var r2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!r2.isDisabled&&r2.supportsFiber)try{uS=r2.inject(dce),ku=r2}catch{}}Cc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cce;Cc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!DT(t))throw Error(Wr(200));return ice(e,t,null,r)};Cc.createRoot=function(e,t){if(!DT(e))throw Error(Wr(299));var r=!1,n="",a=WW;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=OT(e,1,!1,null,null,r,!1,n,a),e[Af]=t.current,pb(e.nodeType===8?e.parentNode:e),new IT(t)};Cc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Wr(188)):(e=Object.keys(e).join(","),Error(Wr(268,e)));return e=mV(t),e=e===null?null:e.stateNode,e};Cc.flushSync=function(e){return Up(e)};Cc.hydrate=function(e,t,r){if(!_S(t))throw Error(Wr(200));return SS(null,e,t,!0,r)};Cc.hydrateRoot=function(e,t,r){if(!DT(e))throw Error(Wr(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=WW;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=VW(t,null,e,1,r??null,a,!1,i,s),e[Af]=t.current,pb(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new NS(t)};Cc.render=function(e,t,r){if(!_S(t))throw Error(Wr(200));return SS(null,e,t,!1,r)};Cc.unmountComponentAtNode=function(e){if(!_S(e))throw Error(Wr(40));return e._reactRootContainer?(Up(function(){SS(null,null,e,!1,function(){e._reactRootContainer=null,e[Af]=null})}),!0):!1};Cc.unstable_batchedUpdates=PT;Cc.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!_S(r))throw Error(Wr(200));if(e==null||e._reactInternals===void 0)throw Error(Wr(38));return SS(e,t,r,!1,n)};Cc.version="18.3.1-next-f1338f8080-20240426";function HW(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(HW)}catch(e){console.error(e)}}HW(),HU.exports=Cc;var zf=HU.exports;const GW=Ba(zf);var YL=zf;IE.createRoot=YL.createRoot,IE.hydrateRoot=YL.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _b(){return _b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_b.apply(this,arguments)}var Em;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Em||(Em={}));const XL="popstate";function uce(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:s,hash:l}=n.location;return Ck("",{pathname:i,search:s,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:sN(a)}return mce(t,r,null,e)}function Ho(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function KW(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function fce(){return Math.random().toString(36).substr(2,8)}function JL(e,t){return{usr:e.state,key:e.key,idx:t}}function Ck(e,t,r,n){return r===void 0&&(r=null),_b({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Xx(t):t,{state:r,key:t&&t.key||n||fce()})}function sN(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Xx(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function mce(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,l=Em.Pop,c=null,d=u();d==null&&(d=0,s.replaceState(_b({},s.state,{idx:d}),""));function u(){return(s.state||{idx:null}).idx}function f(){l=Em.Pop;let x=u(),y=x==null?null:x-d;d=x,c&&c({action:l,location:g.location,delta:y})}function m(x,y){l=Em.Push;let b=Ck(g.location,x,y);r&&r(b,x),d=u()+1;let w=JL(b,d),j=g.createHref(b);try{s.pushState(w,"",j)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;a.location.assign(j)}i&&c&&c({action:l,location:g.location,delta:1})}function h(x,y){l=Em.Replace;let b=Ck(g.location,x,y);r&&r(b,x),d=u();let w=JL(b,d),j=g.createHref(b);s.replaceState(w,"",j),i&&c&&c({action:l,location:g.location,delta:0})}function v(x){let y=a.location.origin!=="null"?a.location.origin:a.location.href,b=typeof x=="string"?x:sN(x);return b=b.replace(/ $/,"%20"),Ho(y,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,y)}let g={get action(){return l},get location(){return e(a,s)},listen(x){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(XL,f),c=x,()=>{a.removeEventListener(XL,f),c=null}},createHref(x){return t(a,x)},createURL:v,encodeLocation(x){let y=v(x);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:m,replace:h,go(x){return s.go(x)}};return g}var QL;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(QL||(QL={}));function hce(e,t,r){return r===void 0&&(r="/"),pce(e,t,r,!1)}function pce(e,t,r,n){let a=typeof t=="string"?Xx(t):t,i=ix(a.pathname||"/",r);if(i==null)return null;let s=YW(e);gce(s);let l=null;for(let c=0;l==null&&c<s.length;++c){let d=Pce(i);l=Sce(s[c],d,n)}return l}function YW(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,s,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};c.relativePath.startsWith("/")&&(Ho(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Wm([n,c.relativePath]),u=r.concat(c);i.children&&i.children.length>0&&(Ho(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),YW(i.children,t,u,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:Nce(d,i.index),routesMeta:u})};return e.forEach((i,s)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,s);else for(let c of XW(i.path))a(i,s,c)}),t}function XW(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=XW(n.join("/")),l=[];return l.push(...s.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...s),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function gce(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:_ce(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const vce=/^:[\w-]+$/,xce=3,yce=2,bce=1,wce=10,jce=-2,ZL=e=>e==="*";function Nce(e,t){let r=e.split("/"),n=r.length;return r.some(ZL)&&(n+=jce),t&&(n+=yce),r.filter(a=>!ZL(a)).reduce((a,i)=>a+(vce.test(i)?xce:i===""?bce:wce),n)}function _ce(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function Sce(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,a={},i="/",s=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=lN({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),m=c.route;if(!f&&d&&r&&!n[n.length-1].route.index&&(f=lN({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!f)return null;Object.assign(a,f.params),s.push({params:a,pathname:Wm([i,f.pathname]),pathnameBase:Oce(Wm([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=Wm([i,f.pathnameBase]))}return s}function lN(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Cce(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((d,u,f)=>{let{paramName:m,isOptional:h}=u;if(m==="*"){let g=l[f]||"";s=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const v=l[f];return h&&!v?d[m]=void 0:d[m]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:s,pattern:e}}function Cce(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),KW(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Pce(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return KW(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ix(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Ace(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Xx(e):e;return{pathname:r?r.startsWith("/")?r:Ece(r,t):t,search:Tce(n),hash:Ice(a)}}function Ece(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function xP(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function kce(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function MT(e,t){let r=kce(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function RT(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Xx(e):(a=_b({},e),Ho(!a.pathname||!a.pathname.includes("?"),xP("?","pathname","search",a)),Ho(!a.pathname||!a.pathname.includes("#"),xP("#","pathname","hash",a)),Ho(!a.search||!a.search.includes("#"),xP("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,l;if(s==null)l=r;else{let f=t.length-1;if(!n&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),f-=1;a.pathname=m.join("/")}l=f>=0?t[f]:"/"}let c=Ace(a,l),d=s&&s!=="/"&&s.endsWith("/"),u=(i||s===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const Wm=e=>e.join("/").replace(/\/\/+/g,"/"),Oce=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Tce=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Ice=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Dce(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const JW=["post","put","patch","delete"];new Set(JW);const Mce=["get",...JW];new Set(Mce);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sb(){return Sb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sb.apply(this,arguments)}const CS=p.createContext(null),QW=p.createContext(null),Uf=p.createContext(null),PS=p.createContext(null),Vf=p.createContext({outlet:null,matches:[],isDataRoute:!1}),ZW=p.createContext(null);function Rce(e,t){let{relative:r}=t===void 0?{}:t;Jx()||Ho(!1);let{basename:n,navigator:a}=p.useContext(Uf),{hash:i,pathname:s,search:l}=AS(e,{relative:r}),c=s;return n!=="/"&&(c=s==="/"?n:Wm([n,s])),a.createHref({pathname:c,search:l,hash:i})}function Jx(){return p.useContext(PS)!=null}function ki(){return Jx()||Ho(!1),p.useContext(PS).location}function eH(e){p.useContext(Uf).static||p.useLayoutEffect(e)}function Fl(){let{isDataRoute:e}=p.useContext(Vf);return e?Xce():Lce()}function Lce(){Jx()||Ho(!1);let e=p.useContext(CS),{basename:t,future:r,navigator:n}=p.useContext(Uf),{matches:a}=p.useContext(Vf),{pathname:i}=ki(),s=JSON.stringify(MT(a,r.v7_relativeSplatPath)),l=p.useRef(!1);return eH(()=>{l.current=!0}),p.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let f=RT(d,JSON.parse(s),i,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Wm([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,s,i,e])}function $ce(){let{matches:e}=p.useContext(Vf),t=e[e.length-1];return t?t.params:{}}function AS(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=p.useContext(Uf),{matches:a}=p.useContext(Vf),{pathname:i}=ki(),s=JSON.stringify(MT(a,n.v7_relativeSplatPath));return p.useMemo(()=>RT(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function Fce(e,t){return Bce(e,t)}function Bce(e,t,r,n){Jx()||Ho(!1);let{navigator:a}=p.useContext(Uf),{matches:i}=p.useContext(Vf),s=i[i.length-1],l=s?s.params:{};s&&s.pathname;let c=s?s.pathnameBase:"/";s&&s.route;let d=ki(),u;if(t){var f;let x=typeof t=="string"?Xx(t):t;c==="/"||(f=x.pathname)!=null&&f.startsWith(c)||Ho(!1),u=x}else u=d;let m=u.pathname||"/",h=m;if(c!=="/"){let x=c.replace(/^\//,"").split("/");h="/"+m.replace(/^\//,"").split("/").slice(x.length).join("/")}let v=hce(e,{pathname:h}),g=Wce(v&&v.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:Wm([c,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:Wm([c,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,r,n);return t&&g?p.createElement(PS.Provider,{value:{location:Sb({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Em.Pop}},g):g}function qce(){let e=Yce(),t=Dce(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),r?p.createElement("pre",{style:a},r):null,i)}const zce=p.createElement(qce,null);class Uce extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?p.createElement(Vf.Provider,{value:this.props.routeContext},p.createElement(ZW.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Vce(e){let{routeContext:t,match:r,children:n}=e,a=p.useContext(CS);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),p.createElement(Vf.Provider,{value:t},n)}function Wce(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let u=s.findIndex(f=>f.route.id&&l?.[f.route.id]!==void 0);u>=0||Ho(!1),s=s.slice(0,Math.min(s.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<s.length;u++){let f=s[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=u),f.route.id){let{loaderData:m,errors:h}=r,v=f.route.loader&&m[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||v){c=!0,d>=0?s=s.slice(0,d+1):s=[s[0]];break}}}return s.reduceRight((u,f,m)=>{let h,v=!1,g=null,x=null;r&&(h=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||zce,c&&(d<0&&m===0?(Jce("route-fallback",!1),v=!0,x=null):d===m&&(v=!0,x=f.route.hydrateFallbackElement||null)));let y=t.concat(s.slice(0,m+1)),b=()=>{let w;return h?w=g:v?w=x:f.route.Component?w=p.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,p.createElement(Vce,{match:f,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?p.createElement(Uce,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:b(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):b()},null)}var tH=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(tH||{}),cN=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(cN||{});function Hce(e){let t=p.useContext(CS);return t||Ho(!1),t}function Gce(e){let t=p.useContext(QW);return t||Ho(!1),t}function Kce(e){let t=p.useContext(Vf);return t||Ho(!1),t}function rH(e){let t=Kce(),r=t.matches[t.matches.length-1];return r.route.id||Ho(!1),r.route.id}function Yce(){var e;let t=p.useContext(ZW),r=Gce(cN.UseRouteError),n=rH(cN.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Xce(){let{router:e}=Hce(tH.UseNavigateStable),t=rH(cN.UseNavigateStable),r=p.useRef(!1);return eH(()=>{r.current=!0}),p.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Sb({fromRouteId:t},i)))},[e,t])}const e6={};function Jce(e,t,r){!t&&!e6[e]&&(e6[e]=!0)}function Qce(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function nH(e){let{to:t,replace:r,state:n,relative:a}=e;Jx()||Ho(!1);let{future:i,static:s}=p.useContext(Uf),{matches:l}=p.useContext(Vf),{pathname:c}=ki(),d=Fl(),u=RT(t,MT(l,i.v7_relativeSplatPath),c,a==="path"),f=JSON.stringify(u);return p.useEffect(()=>d(JSON.parse(f),{replace:r,state:n,relative:a}),[d,f,a,r,n]),null}function so(e){Ho(!1)}function Zce(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Em.Pop,navigator:i,static:s=!1,future:l}=e;Jx()&&Ho(!1);let c=t.replace(/^\/*/,"/"),d=p.useMemo(()=>({basename:c,navigator:i,static:s,future:Sb({v7_relativeSplatPath:!1},l)}),[c,l,i,s]);typeof n=="string"&&(n=Xx(n));let{pathname:u="/",search:f="",hash:m="",state:h=null,key:v="default"}=n,g=p.useMemo(()=>{let x=ix(u,c);return x==null?null:{location:{pathname:x,search:f,hash:m,state:h,key:v},navigationType:a}},[c,u,f,m,h,v,a]);return g==null?null:p.createElement(Uf.Provider,{value:d},p.createElement(PS.Provider,{children:r,value:g}))}function pj(e){let{children:t,location:r}=e;return Fce(Pk(t),r)}new Promise(()=>{});function Pk(e,t){t===void 0&&(t=[]);let r=[];return p.Children.forEach(e,(n,a)=>{if(!p.isValidElement(n))return;let i=[...t,a];if(n.type===p.Fragment){r.push.apply(r,Pk(n.props.children,i));return}n.type!==so&&Ho(!1),!n.props.index||!n.props.children||Ho(!1);let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Pk(n.props.children,i)),r.push(s)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dN(){return dN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dN.apply(this,arguments)}function aH(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function ede(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function tde(e,t){return e.button===0&&(!t||t==="_self")&&!ede(e)}function Ak(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function rde(e,t){let r=Ak(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const nde=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ade=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],ode="6";try{window.__reactRouterVersion=ode}catch{}const ide=p.createContext({isTransitioning:!1}),sde="startTransition",t6=V4[sde];function lde(e){let{basename:t,children:r,future:n,window:a}=e,i=p.useRef();i.current==null&&(i.current=uce({window:a,v5Compat:!0}));let s=i.current,[l,c]=p.useState({action:s.action,location:s.location}),{v7_startTransition:d}=n||{},u=p.useCallback(f=>{d&&t6?t6(()=>c(f)):c(f)},[c,d]);return p.useLayoutEffect(()=>s.listen(u),[s,u]),p.useEffect(()=>Qce(n),[n]),p.createElement(Zce,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:s,future:n})}const cde=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",dde=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LT=p.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:s,state:l,target:c,to:d,preventScrollReset:u,viewTransition:f}=t,m=aH(t,nde),{basename:h}=p.useContext(Uf),v,g=!1;if(typeof d=="string"&&dde.test(d)&&(v=d,cde))try{let w=new URL(window.location.href),j=d.startsWith("//")?new URL(w.protocol+d):new URL(d),_=ix(j.pathname,h);j.origin===w.origin&&_!=null?d=_+j.search+j.hash:g=!0}catch{}let x=Rce(d,{relative:a}),y=fde(d,{replace:s,state:l,target:c,preventScrollReset:u,relative:a,viewTransition:f});function b(w){n&&n(w),w.defaultPrevented||y(w)}return p.createElement("a",dN({},m,{href:v||x,onClick:g||i?n:b,ref:r,target:c}))}),pu=p.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:a=!1,className:i="",end:s=!1,style:l,to:c,viewTransition:d,children:u}=t,f=aH(t,ade),m=AS(c,{relative:f.relative}),h=ki(),v=p.useContext(QW),{navigator:g,basename:x}=p.useContext(Uf),y=v!=null&&mde(m)&&d===!0,b=g.encodeLocation?g.encodeLocation(m).pathname:m.pathname,w=h.pathname,j=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;a||(w=w.toLowerCase(),j=j?j.toLowerCase():null,b=b.toLowerCase()),j&&x&&(j=ix(j,x)||j);const _=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let S=w===b||!s&&w.startsWith(b)&&w.charAt(_)==="/",k=j!=null&&(j===b||!s&&j.startsWith(b)&&j.charAt(b.length)==="/"),E={isActive:S,isPending:k,isTransitioning:y},A=S?n:void 0,M;typeof i=="function"?M=i(E):M=[i,S?"active":null,k?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let C=typeof l=="function"?l(E):l;return p.createElement(LT,dN({},f,{"aria-current":A,className:M,ref:r,style:C,to:c,viewTransition:d}),typeof u=="function"?u(E):u)});var Ek;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ek||(Ek={}));var r6;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(r6||(r6={}));function ude(e){let t=p.useContext(CS);return t||Ho(!1),t}function fde(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:s,viewTransition:l}=t===void 0?{}:t,c=Fl(),d=ki(),u=AS(e,{relative:s});return p.useCallback(f=>{if(tde(f,r)){f.preventDefault();let m=n!==void 0?n:sN(d)===sN(u);c(e,{replace:m,state:a,preventScrollReset:i,relative:s,viewTransition:l})}},[d,c,u,n,a,r,e,i,s,l])}function ES(e){let t=p.useRef(Ak(e)),r=p.useRef(!1),n=ki(),a=p.useMemo(()=>rde(n.search,r.current?null:t.current),[n.search]),i=Fl(),s=p.useCallback((l,c)=>{const d=Ak(typeof l=="function"?l(a):l);r.current=!0,i("?"+d,c)},[i,a]);return[a,s]}function mde(e,t){t===void 0&&(t={});let r=p.useContext(ide);r==null&&Ho(!1);let{basename:n}=ude(Ek.useViewTransitionState),a=AS(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=ix(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=ix(r.nextLocation.pathname,n)||r.nextLocation.pathname;return lN(a.pathname,s)!=null||lN(a.pathname,i)!=null}function oH(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=oH(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ta(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=oH(e))&&(n&&(n+=" "),n+=t);return n}function hde(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=iH(t))&&(n&&(n+=" "),n+=r);return n}function iH(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=iH(e[n]))&&(r&&(r+=" "),r+=t);return r}var $T="-";function pde(e){var t=vde(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,a=n===void 0?{}:n;function i(l){var c=l.split($T);return c[0]===""&&c.length!==1&&c.shift(),sH(c,t)||gde(l)}function s(l,c){var d=r[l]||[];return c&&a[l]?[].concat(d,a[l]):d}return{getClassGroupId:i,getConflictingClassGroupIds:s}}function sH(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),a=n?sH(e.slice(1),n):void 0;if(a)return a;if(t.validators.length!==0){var i=e.join($T);return t.validators.find(function(s){var l=s.validator;return l(i)})?.classGroupId}}var n6=/^\[(.+)\]$/;function gde(e){if(n6.test(e)){var t=n6.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function vde(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},a=yde(Object.entries(e.classGroups),r);return a.forEach(function(i){var s=i[0],l=i[1];kk(l,n,s,t)}),n}function kk(e,t,r,n){e.forEach(function(a){if(typeof a=="string"){var i=a===""?t:a6(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(xde(a)){kk(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(function(s){var l=s[0],c=s[1];kk(c,a6(t,l),r,n)})})}function a6(e,t){var r=e;return t.split($T).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function xde(e){return e.isThemeGetter}function yde(e,t){return t?e.map(function(r){var n=r[0],a=r[1],i=a.map(function(s){return typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(function(l){var c=l[0],d=l[1];return[t+c,d]})):s});return[n,i]}):e}function bde(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function a(i,s){r.set(i,s),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(s){var l=r.get(s);if(l!==void 0)return l;if((l=n.get(s))!==void 0)return a(s,l),l},set:function(s,l){r.has(s)?r.set(s,l):a(s,l)}}}var lH="!";function wde(e){var t=e.separator||":",r=t.length===1,n=t[0],a=t.length;return function(s){for(var l=[],c=0,d=0,u,f=0;f<s.length;f++){var m=s[f];if(c===0){if(m===n&&(r||s.slice(f,f+a)===t)){l.push(s.slice(d,f)),d=f+a;continue}if(m==="/"){u=f;continue}}m==="["?c++:m==="]"&&c--}var h=l.length===0?s:s.substring(d),v=h.startsWith(lH),g=v?h.substring(1):h,x=u&&u>d?u-d:void 0;return{modifiers:l,hasImportantModifier:v,baseClassName:g,maybePostfixModifierPosition:x}}}function jde(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var a=n[0]==="[";a?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function Nde(e){return{cache:bde(e.cacheSize),splitModifiers:wde(e),...pde(e)}}var _de=/\s+/;function Sde(e,t){var r=t.splitModifiers,n=t.getClassGroupId,a=t.getConflictingClassGroupIds,i=new Set;return e.trim().split(_de).map(function(s){var l=r(s),c=l.modifiers,d=l.hasImportantModifier,u=l.baseClassName,f=l.maybePostfixModifierPosition,m=n(f?u.substring(0,f):u),h=!!f;if(!m){if(!f)return{isTailwindClass:!1,originalClassName:s};if(m=n(u),!m)return{isTailwindClass:!1,originalClassName:s};h=!1}var v=jde(c).join(":"),g=d?v+lH:v;return{isTailwindClass:!0,modifierId:g,classGroupId:m,originalClassName:s,hasPostfixModifier:h}}).reverse().filter(function(s){if(!s.isTailwindClass)return!0;var l=s.modifierId,c=s.classGroupId,d=s.hasPostfixModifier,u=l+c;return i.has(u)?!1:(i.add(u),a(c,d).forEach(function(f){return i.add(l+f)}),!0)}).reverse().map(function(s){return s.originalClassName}).join(" ")}function Cde(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,a,i,s=l;function l(d){var u=t[0],f=t.slice(1),m=f.reduce(function(h,v){return v(h)},u());return n=Nde(m),a=n.cache.get,i=n.cache.set,s=c,c(d)}function c(d){var u=a(d);if(u)return u;var f=Sde(d,n);return i(d,f),f}return function(){return s(hde.apply(null,arguments))}}function Ao(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var cH=/^\[(?:([a-z-]+):)?(.+)\]$/i,Pde=/^\d+\/\d+$/,Ade=new Set(["px","full","screen"]),Ede=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,kde=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ode=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Ed(e){return up(e)||Ade.has(e)||Pde.test(e)||Ok(e)}function Ok(e){return ug(e,"length",Lde)}function Tde(e){return ug(e,"size",dH)}function Ide(e){return ug(e,"position",dH)}function Dde(e){return ug(e,"url",$de)}function n2(e){return ug(e,"number",up)}function up(e){return!Number.isNaN(Number(e))}function Mde(e){return e.endsWith("%")&&up(e.slice(0,-1))}function F0(e){return o6(e)||ug(e,"number",o6)}function Pa(e){return cH.test(e)}function B0(){return!0}function am(e){return Ede.test(e)}function Rde(e){return ug(e,"",Fde)}function ug(e,t,r){var n=cH.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function Lde(e){return kde.test(e)}function dH(){return!1}function $de(e){return e.startsWith("url(")}function o6(e){return Number.isInteger(Number(e))}function Fde(e){return Ode.test(e)}function Bde(){var e=Ao("colors"),t=Ao("spacing"),r=Ao("blur"),n=Ao("brightness"),a=Ao("borderColor"),i=Ao("borderRadius"),s=Ao("borderSpacing"),l=Ao("borderWidth"),c=Ao("contrast"),d=Ao("grayscale"),u=Ao("hueRotate"),f=Ao("invert"),m=Ao("gap"),h=Ao("gradientColorStops"),v=Ao("gradientColorStopPositions"),g=Ao("inset"),x=Ao("margin"),y=Ao("opacity"),b=Ao("padding"),w=Ao("saturate"),j=Ao("scale"),_=Ao("sepia"),S=Ao("skew"),k=Ao("space"),E=Ao("translate"),A=function(){return["auto","contain","none"]},M=function(){return["auto","hidden","clip","visible","scroll"]},C=function(){return["auto",Pa,t]},T=function(){return[Pa,t]},I=function(){return["",Ed]},D=function(){return["auto",up,Pa]},F=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},z=function(){return["solid","dashed","dotted","double","none"]},q=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},$=function(){return["start","end","center","between","around","evenly","stretch"]},K=function(){return["","0",Pa]},ce=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},fe=function(){return[up,n2]},B=function(){return[up,Pa]};return{cacheSize:500,theme:{colors:[B0],spacing:[Ed],blur:["none","",am,Pa],brightness:fe(),borderColor:[e],borderRadius:["none","","full",am,Pa],borderSpacing:T(),borderWidth:I(),contrast:fe(),grayscale:K(),hueRotate:B(),invert:K(),gap:T(),gradientColorStops:[e],gradientColorStopPositions:[Mde,Ok],inset:C(),margin:C(),opacity:fe(),padding:T(),saturate:fe(),scale:fe(),sepia:K(),skew:B(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",Pa]}],container:["container"],columns:[{columns:[am]}],"break-after":[{"break-after":ce()}],"break-before":[{"break-before":ce()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(F(),[Pa])}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",F0]}],basis:[{basis:C()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Pa]}],grow:[{grow:K()}],shrink:[{shrink:K()}],order:[{order:["first","last","none",F0]}],"grid-cols":[{"grid-cols":[B0]}],"col-start-end":[{col:["auto",{span:["full",F0]},Pa]}],"col-start":[{"col-start":D()}],"col-end":[{"col-end":D()}],"grid-rows":[{"grid-rows":[B0]}],"row-start-end":[{row:["auto",{span:[F0]},Pa]}],"row-start":[{"row-start":D()}],"row-end":[{"row-end":D()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Pa]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Pa]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal"].concat($())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat($(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat($(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Pa,t]}],"min-w":[{"min-w":["min","max","fit",Pa,Ed]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[am]},am,Pa]}],h:[{h:[Pa,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Pa,Ed]}],"max-h":[{"max-h":[Pa,t,"min","max","fit"]}],"font-size":[{text:["base",am,Ok]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",n2]}],"font-family":[{font:[B0]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Pa]}],"line-clamp":[{"line-clamp":["none",up,n2]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Pa,Ed]}],"list-image":[{"list-image":["none",Pa]}],"list-style-type":[{list:["none","disc","decimal",Pa]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(z(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Ed]}],"underline-offset":[{"underline-offset":["auto",Pa,Ed]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Pa]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Pa]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(F(),[Ide])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Tde]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Dde]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[].concat(z(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:z()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:[""].concat(z())}],"outline-offset":[{"outline-offset":[Pa,Ed]}],"outline-w":[{outline:[Ed]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Ed]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",am,Rde]}],"shadow-color":[{shadow:[B0]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":q()}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",am,Pa]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Pa]}],duration:[{duration:B()}],ease:[{ease:["linear","in","out","in-out",Pa]}],delay:[{delay:B()}],animate:[{animate:["none","spin","ping","pulse","bounce",Pa]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[F0,Pa]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Pa]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Pa]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Pa]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Ed,n2]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var qde=Cde(Bde);function Jt(...e){return qde(ta(e))}const i6=["#3B82F6","#22C55E","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F43F5E","#10B981","#A855F7","#EAB308"];function zde(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return Math.abs(t)}function xm(e){if(!e)return"#94A3B8";const t=zde(String(e))%i6.length;return i6[t]}var Ude={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Vde=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Dr=(e,t)=>{const r=p.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,children:l,...c},d)=>p.createElement("svg",{ref:d,...Ude,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:`lucide lucide-${Vde(e)}`,...c},[...t.map(([u,f])=>p.createElement(u,f)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${e}`,r},pc=Dr("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Of=Dr("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Wde=Dr("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),ky=Dr("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),a2=Dr("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),FT=Dr("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),BT=Dr("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),uH=Dr("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),yP=Dr("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),uN=Dr("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),fH=Dr("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),Hde=Dr("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]),fN=Dr("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Gde=Dr("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),qT=Dr("CalendarCheck",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),Kde=Dr("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),zT=Dr("CalendarPlus",[["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"19",x2:"19",y1:"16",y2:"22",key:"1ttwzi"}],["line",{x1:"16",x2:"22",y1:"19",y2:"19",key:"1g9955"}]]),gj=Dr("CalendarX",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"10",x2:"14",y1:"14",y2:"18",key:"1g3qc0"}],["line",{x1:"14",x2:"10",y1:"14",y2:"18",key:"1az83m"}]]),gi=Dr("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),o2=Dr("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Pi=Dr("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Tf=Dr("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),z1=Dr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),mH=Dr("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Qx=Dr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Yde=Dr("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]),Xde=Dr("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Jde=Dr("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]),dd=Dr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Qde=Dr("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),km=Dr("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Ui=Dr("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ei=Dr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Pp=Dr("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Vp=Dr("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ag=Dr("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),rs=Dr("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Tk=Dr("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Zde=Dr("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),eue=Dr("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),tue=Dr("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),rue=Dr("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),nue=Dr("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),aue=Dr("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),oue=Dr("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),hH=Dr("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),iue=Dr("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",key:"1kog09"}]]),sue=Dr("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),lue=Dr("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),pH=Dr("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),gH=Dr("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),Om=Dr("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),sx=Dr("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),cue=Dr("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),due=Dr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),lx=Dr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Ik=Dr("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),uue=Dr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),bP=Dr("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),fue=Dr("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),Dk=Dr("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),xv=Dr("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),mue=Dr("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),s6=Dr("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),gd=Dr("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),ll=Dr("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Cb=Dr("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),vH=Dr("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),Ga=Dr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),xH=Dr("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Ap=Dr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),l6=Dr("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),hue=Dr("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),hi=Dr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),UT=Dr("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Hm=Dr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),c6=Dr("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),pue=Dr("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Mv=Dr("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),U1=Dr("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),d6=Dr("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),wP=Dr("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),Mk=Dr("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),gue=Dr("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),VT=Dr("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),i2=Dr("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Gm=Dr("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),vue=Dr("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Wp=Dr("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),nd=Dr("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),xue=Dr("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),yH=Dr("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),WT=Dr("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),yue=Dr("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),bue=Dr("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),wue=Dr("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),bH=Dr("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),_u=Dr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),cl=Dr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),wH=Dr("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),Oy=Dr("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Dl=Dr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ud=({size:e="md",variant:t="header",className:r=""})=>{const n={xs:"w-8 h-8",sm:"w-10 h-10",md:"w-14 h-14",lg:"w-20 h-20",xl:"w-24 h-24"},a={header:"/isis-profile.png",message:"/isis-profile-baloon.png"},i=a[t]||a.header,s=e==="lg"?"scale-125":e==="md"?"scale-110":"scale-100";return o.jsx("div",{className:`${n[e]||n.md} rounded-full overflow-hidden flex-shrink-0 ring-2 ring-brand ring-offset-0 ${r}`,children:o.jsx("img",{src:i,alt:"Assistente Virtual",className:`w-full h-full object-cover ${s}`,onError:l=>{l.target.style.display="none",l.target.parentElement.innerHTML=`
            <div class="w-full h-full bg-brand flex items-center justify-center">
              <span class="text-bg font-bold text-lg">A</span>
            </div>
          `}})})},jH=p.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),kS=p.createContext({}),OS=p.createContext(null),TS=typeof document<"u",HT=TS?p.useLayoutEffect:p.useEffect,NH=p.createContext({strict:!1}),GT=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),jue="framerAppearId",_H="data-"+GT(jue);function Nue(e,t,r,n){const{visualElement:a}=p.useContext(kS),i=p.useContext(NH),s=p.useContext(OS),l=p.useContext(jH).reducedMotion,c=p.useRef();n=n||i.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:a,props:r,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:l}));const d=c.current;p.useInsertionEffect(()=>{d&&d.update(r,s)});const u=p.useRef(!!(r[_H]&&!window.HandoffComplete));return HT(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),p.useEffect(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}function yv(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function _ue(e,t,r){return p.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):yv(r)&&(r.current=n))},[t])}function Pb(e){return typeof e=="string"||Array.isArray(e)}function IS(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const KT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],YT=["initial",...KT];function DS(e){return IS(e.animate)||YT.some(t=>Pb(e[t]))}function SH(e){return!!(DS(e)||e.variants)}function Sue(e,t){if(DS(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Pb(r)?r:void 0,animate:Pb(n)?n:void 0}}return e.inherit!==!1?t:{}}function Cue(e){const{initial:t,animate:r}=Sue(e,p.useContext(kS));return p.useMemo(()=>({initial:t,animate:r}),[u6(t),u6(r)])}function u6(e){return Array.isArray(e)?e.join(" "):e}const f6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ab={};for(const e in f6)Ab[e]={isEnabled:t=>f6[e].some(r=>!!t[r])};function Pue(e){for(const t in e)Ab[t]={...Ab[t],...e[t]}}const XT=p.createContext({}),CH=p.createContext({}),Aue=Symbol.for("motionComponentSymbol");function Eue({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:a}){e&&Pue(e);function i(l,c){let d;const u={...p.useContext(jH),...l,layoutId:kue(l)},{isStatic:f}=u,m=Cue(l),h=n(l,f);if(!f&&TS){m.visualElement=Nue(a,h,u,t);const v=p.useContext(CH),g=p.useContext(NH).strict;m.visualElement&&(d=m.visualElement.loadFeatures(u,g,e,v))}return p.createElement(kS.Provider,{value:m},d&&m.visualElement?p.createElement(d,{visualElement:m.visualElement,...u}):null,r(a,l,_ue(h,m.visualElement,c),h,f,m.visualElement))}const s=p.forwardRef(i);return s[Aue]=a,s}function kue({layoutId:e}){const t=p.useContext(XT).id;return t&&e!==void 0?t+"-"+e:e}function Oue(e){function t(n,a={}){return Eue(e(n,a))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,a)=>(r.has(a)||r.set(a,t(a)),r.get(a))})}const Tue=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function JT(e){return typeof e!="string"||e.includes("-")?!1:!!(Tue.indexOf(e)>-1||/[A-Z]/.test(e))}const mN={};function Iue(e){Object.assign(mN,e)}const V1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],fg=new Set(V1);function PH(e,{layout:t,layoutId:r}){return fg.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!mN[e]||e==="opacity")}const Ll=e=>!!(e&&e.getVelocity),Due={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Mue=V1.length;function Rue(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,a){let i="";for(let s=0;s<Mue;s++){const l=V1[s];if(e[l]!==void 0){const c=Due[l]||l;i+=`${c}(${e[l]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),a?i=a(e,n?"":i):r&&n&&(i="none"),i}const AH=e=>t=>typeof t=="string"&&t.startsWith(e),EH=AH("--"),Rk=AH("var(--"),Lue=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,$ue=(e,t)=>t&&typeof e=="number"?t.transform(e):e,dh=(e,t,r)=>Math.min(Math.max(r,e),t),mg={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ty={...mg,transform:e=>dh(0,1,e)},s2={...mg,default:1},Iy=e=>Math.round(e*1e5)/1e5,MS=/(-)?([\d]*\.?[\d])+/g,kH=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Fue=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function W1(e){return typeof e=="string"}const H1=e=>({test:t=>W1(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),fm=H1("deg"),Tu=H1("%"),Gn=H1("px"),Bue=H1("vh"),que=H1("vw"),m6={...Tu,parse:e=>Tu.parse(e)/100,transform:e=>Tu.transform(e*100)},h6={...mg,transform:Math.round},OH={borderWidth:Gn,borderTopWidth:Gn,borderRightWidth:Gn,borderBottomWidth:Gn,borderLeftWidth:Gn,borderRadius:Gn,radius:Gn,borderTopLeftRadius:Gn,borderTopRightRadius:Gn,borderBottomRightRadius:Gn,borderBottomLeftRadius:Gn,width:Gn,maxWidth:Gn,height:Gn,maxHeight:Gn,size:Gn,top:Gn,right:Gn,bottom:Gn,left:Gn,padding:Gn,paddingTop:Gn,paddingRight:Gn,paddingBottom:Gn,paddingLeft:Gn,margin:Gn,marginTop:Gn,marginRight:Gn,marginBottom:Gn,marginLeft:Gn,rotate:fm,rotateX:fm,rotateY:fm,rotateZ:fm,scale:s2,scaleX:s2,scaleY:s2,scaleZ:s2,skew:fm,skewX:fm,skewY:fm,distance:Gn,translateX:Gn,translateY:Gn,translateZ:Gn,x:Gn,y:Gn,z:Gn,perspective:Gn,transformPerspective:Gn,opacity:Ty,originX:m6,originY:m6,originZ:Gn,zIndex:h6,fillOpacity:Ty,strokeOpacity:Ty,numOctaves:h6};function QT(e,t,r,n){const{style:a,vars:i,transform:s,transformOrigin:l}=e;let c=!1,d=!1,u=!0;for(const f in t){const m=t[f];if(EH(f)){i[f]=m;continue}const h=OH[f],v=$ue(m,h);if(fg.has(f)){if(c=!0,s[f]=v,!u)continue;m!==(h.default||0)&&(u=!1)}else f.startsWith("origin")?(d=!0,l[f]=v):a[f]=v}if(t.transform||(c||n?a.transform=Rue(e.transform,r,u,n):a.transform&&(a.transform="none")),d){const{originX:f="50%",originY:m="50%",originZ:h=0}=l;a.transformOrigin=`${f} ${m} ${h}`}}const ZT=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function TH(e,t,r){for(const n in t)!Ll(t[n])&&!PH(n,r)&&(e[n]=t[n])}function zue({transformTemplate:e},t,r){return p.useMemo(()=>{const n=ZT();return QT(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function Uue(e,t,r){const n=e.style||{},a={};return TH(a,n,e),Object.assign(a,zue(e,t,r)),e.transformValues?e.transformValues(a):a}function Vue(e,t,r){const n={},a=Uue(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=a,n}const Wue=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function hN(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Wue.has(e)}let IH=e=>!hN(e);function Hue(e){e&&(IH=t=>t.startsWith("on")?!hN(t):e(t))}try{Hue(require("@emotion/is-prop-valid").default)}catch{}function Gue(e,t,r){const n={};for(const a in e)a==="values"&&typeof e.values=="object"||(IH(a)||r===!0&&hN(a)||!t&&!hN(a)||e.draggable&&a.startsWith("onDrag"))&&(n[a]=e[a]);return n}function p6(e,t,r){return typeof e=="string"?e:Gn.transform(t+r*e)}function Kue(e,t,r){const n=p6(t,e.x,e.width),a=p6(r,e.y,e.height);return`${n} ${a}`}const Yue={offset:"stroke-dashoffset",array:"stroke-dasharray"},Xue={offset:"strokeDashoffset",array:"strokeDasharray"};function Jue(e,t,r=1,n=0,a=!0){e.pathLength=1;const i=a?Yue:Xue;e[i.offset]=Gn.transform(-n);const s=Gn.transform(t),l=Gn.transform(r);e[i.array]=`${s} ${l}`}function eI(e,{attrX:t,attrY:r,attrScale:n,originX:a,originY:i,pathLength:s,pathSpacing:l=1,pathOffset:c=0,...d},u,f,m){if(QT(e,d,u,m),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:v,dimensions:g}=e;h.transform&&(g&&(v.transform=h.transform),delete h.transform),g&&(a!==void 0||i!==void 0||v.transform)&&(v.transformOrigin=Kue(g,a!==void 0?a:.5,i!==void 0?i:.5)),t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),s!==void 0&&Jue(h,s,l,c,!1)}const DH=()=>({...ZT(),attrs:{}}),tI=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Que(e,t,r,n){const a=p.useMemo(()=>{const i=DH();return eI(i,t,{enableHardwareAcceleration:!1},tI(n),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};TH(i,e.style,e),a.style={...i,...a.style}}return a}function Zue(e=!1){return(r,n,a,{latestValues:i},s)=>{const c=(JT(r)?Que:Vue)(n,i,s,r),u={...Gue(n,typeof r=="string",e),...c,ref:a},{children:f}=n,m=p.useMemo(()=>Ll(f)?f.get():f,[f]);return p.createElement(r,{...u,children:m})}}function MH(e,{style:t,vars:r},n,a){Object.assign(e.style,t,a&&a.getProjectionStyles(n));for(const i in r)e.style.setProperty(i,r[i])}const RH=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function LH(e,t,r,n){MH(e,t,void 0,n);for(const a in t.attrs)e.setAttribute(RH.has(a)?a:GT(a),t.attrs[a])}function rI(e,t){const{style:r}=e,n={};for(const a in r)(Ll(r[a])||t.style&&Ll(t.style[a])||PH(a,e))&&(n[a]=r[a]);return n}function $H(e,t){const r=rI(e,t);for(const n in e)if(Ll(e[n])||Ll(t[n])){const a=V1.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[a]=e[n]}return r}function nI(e,t,r,n={},a={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,a)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,a)),t}function FH(e){const t=p.useRef(null);return t.current===null&&(t.current=e()),t.current}const pN=e=>Array.isArray(e),efe=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),tfe=e=>pN(e)?e[e.length-1]||0:e;function vj(e){const t=Ll(e)?e.get():e;return efe(t)?t.toValue():t}function rfe({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,a,i){const s={latestValues:nfe(n,a,i,e),renderState:t()};return r&&(s.mount=l=>r(n,l,s)),s}const BH=e=>(t,r)=>{const n=p.useContext(kS),a=p.useContext(OS),i=()=>rfe(e,t,n,a);return r?i():FH(i)};function nfe(e,t,r,n){const a={},i=n(e,{});for(const m in i)a[m]=vj(i[m]);let{initial:s,animate:l}=e;const c=DS(e),d=SH(e);t&&d&&!c&&e.inherit!==!1&&(s===void 0&&(s=t.initial),l===void 0&&(l=t.animate));let u=r?r.initial===!1:!1;u=u||s===!1;const f=u?l:s;return f&&typeof f!="boolean"&&!IS(f)&&(Array.isArray(f)?f:[f]).forEach(h=>{const v=nI(e,h);if(!v)return;const{transitionEnd:g,transition:x,...y}=v;for(const b in y){let w=y[b];if(Array.isArray(w)){const j=u?w.length-1:0;w=w[j]}w!==null&&(a[b]=w)}for(const b in g)a[b]=g[b]}),a}const ni=e=>e;class g6{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function afe(e){let t=new g6,r=new g6,n=0,a=!1,i=!1;const s=new WeakSet,l={schedule:(c,d=!1,u=!1)=>{const f=u&&a,m=f?t:r;return d&&s.add(c),m.add(c)&&f&&a&&(n=t.order.length),c},cancel:c=>{r.remove(c),s.delete(c)},process:c=>{if(a){i=!0;return}if(a=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let d=0;d<n;d++){const u=t.order[d];u(c),s.has(u)&&(l.schedule(u),e())}a=!1,i&&(i=!1,l.process(c))}};return l}const l2=["prepare","read","update","preRender","render","postRender"],ofe=40;function ife(e,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=l2.reduce((f,m)=>(f[m]=afe(()=>r=!0),f),{}),s=f=>i[f].process(a),l=()=>{const f=performance.now();r=!1,a.delta=n?1e3/60:Math.max(Math.min(f-a.timestamp,ofe),1),a.timestamp=f,a.isProcessing=!0,l2.forEach(s),a.isProcessing=!1,r&&t&&(n=!1,e(l))},c=()=>{r=!0,n=!0,a.isProcessing||e(l)};return{schedule:l2.reduce((f,m)=>{const h=i[m];return f[m]=(v,g=!1,x=!1)=>(r||c(),h.schedule(v,g,x)),f},{}),cancel:f=>l2.forEach(m=>i[m].cancel(f)),state:a,steps:i}}const{schedule:No,cancel:If,state:Ls,steps:jP}=ife(typeof requestAnimationFrame<"u"?requestAnimationFrame:ni,!0),sfe={useVisualState:BH({scrapeMotionValuesFromProps:$H,createRenderState:DH,onMount:(e,t,{renderState:r,latestValues:n})=>{No.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),No.render(()=>{eI(r,n,{enableHardwareAcceleration:!1},tI(t.tagName),e.transformTemplate),LH(t,r)})}})},lfe={useVisualState:BH({scrapeMotionValuesFromProps:rI,createRenderState:ZT})};function cfe(e,{forwardMotionProps:t=!1},r,n){return{...JT(e)?sfe:lfe,preloadedFeatures:r,useRender:Zue(t),createVisualElement:n,Component:e}}function vf(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const qH=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function RS(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const dfe=e=>t=>qH(t)&&e(t,RS(t));function Nf(e,t,r,n){return vf(e,t,dfe(r),n)}const ufe=(e,t)=>r=>t(e(r)),Km=(...e)=>e.reduce(ufe);function zH(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const v6=zH("dragHorizontal"),x6=zH("dragVertical");function UH(e){let t=!1;if(e==="y")t=x6();else if(e==="x")t=v6();else{const r=v6(),n=x6();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function VH(){const e=UH(!0);return e?(e(),!1):!0}class jh{constructor(t){this.isMounted=!1,this.node=t}update(){}}function y6(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),a=(i,s)=>{if(i.pointerType==="touch"||VH())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&No.update(()=>l[n](i,s))};return Nf(e.current,r,a,{passive:!e.getProps()[n]})}class ffe extends jh{mount(){this.unmount=Km(y6(this.node,!0),y6(this.node,!1))}unmount(){}}class mfe extends jh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Km(vf(this.node.current,"focus",()=>this.onFocus()),vf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const WH=(e,t)=>t?e===t?!0:WH(e,t.parentElement):!1;function NP(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,RS(r))}class hfe extends jh{constructor(){super(...arguments),this.removeStartListeners=ni,this.removeEndListeners=ni,this.removeAccessibleListeners=ni,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=Nf(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:f}=this.node.getProps();No.update(()=>{!f&&!WH(this.node.current,l.target)?u&&u(l,c):d&&d(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),s=Nf(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Km(i,s),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const s=l=>{l.key!=="Enter"||!this.checkPressEnd()||NP("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&No.update(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=vf(this.node.current,"keyup",s),NP("down",(l,c)=>{this.startPress(l,c)})},r=vf(this.node.current,"keydown",t),n=()=>{this.isPressing&&NP("cancel",(i,s)=>this.cancelPress(i,s))},a=vf(this.node.current,"blur",n);this.removeAccessibleListeners=Km(r,a)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:a}=this.node.getProps();a&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&No.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!VH()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&No.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=Nf(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=vf(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Km(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Lk=new WeakMap,_P=new WeakMap,pfe=e=>{const t=Lk.get(e.target);t&&t(e)},gfe=e=>{e.forEach(pfe)};function vfe({root:e,...t}){const r=e||document;_P.has(r)||_P.set(r,{});const n=_P.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(gfe,{root:e,...t})),n[a]}function xfe(e,t,r){const n=vfe(t);return Lk.set(e,r),n.observe(e),()=>{Lk.delete(e),n.unobserve(e)}}const yfe={some:0,all:1};class bfe extends jh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:i}=t,s={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:yfe[a]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),m=d?u:f;m&&m(c)};return xfe(this.node.current,s,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(wfe(t,r))&&this.startObserver()}unmount(){}}function wfe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const jfe={inView:{Feature:bfe},tap:{Feature:hfe},focus:{Feature:mfe},hover:{Feature:ffe}};function HH(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Nfe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function _fe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function LS(e,t,r){const n=e.getProps();return nI(n,t,r!==void 0?r:n.custom,Nfe(e),_fe(e))}let Sfe=ni,aI=ni;const Ym=e=>e*1e3,_f=e=>e/1e3,Cfe={current:!1},GH=e=>Array.isArray(e)&&typeof e[0]=="number";function KH(e){return!!(!e||typeof e=="string"&&YH[e]||GH(e)||Array.isArray(e)&&e.every(KH))}const hy=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,YH={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:hy([0,.65,.55,1]),circOut:hy([.55,0,1,.45]),backIn:hy([.31,.01,.66,-.59]),backOut:hy([.33,1.53,.69,.99])};function XH(e){if(e)return GH(e)?hy(e):Array.isArray(e)?e.map(XH):YH[e]}function Pfe(e,t,r,{delay:n=0,duration:a,repeat:i=0,repeatType:s="loop",ease:l,times:c}={}){const d={[t]:r};c&&(d.offset=c);const u=XH(l);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:a,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:s==="reverse"?"alternate":"normal"})}function Afe(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const JH=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Efe=1e-7,kfe=12;function Ofe(e,t,r,n,a){let i,s,l=0;do s=t+(r-t)/2,i=JH(s,n,a)-e,i>0?r=s:t=s;while(Math.abs(i)>Efe&&++l<kfe);return s}function G1(e,t,r,n){if(e===t&&r===n)return ni;const a=i=>Ofe(i,0,1,e,r);return i=>i===0||i===1?i:JH(a(i),t,n)}const Tfe=G1(.42,0,1,1),Ife=G1(0,0,.58,1),QH=G1(.42,0,.58,1),Dfe=e=>Array.isArray(e)&&typeof e[0]!="number",ZH=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,eG=e=>t=>1-e(1-t),oI=e=>1-Math.sin(Math.acos(e)),tG=eG(oI),Mfe=ZH(oI),rG=G1(.33,1.53,.69,.99),iI=eG(rG),Rfe=ZH(iI),Lfe=e=>(e*=2)<1?.5*iI(e):.5*(2-Math.pow(2,-10*(e-1))),$fe={linear:ni,easeIn:Tfe,easeInOut:QH,easeOut:Ife,circIn:oI,circInOut:Mfe,circOut:tG,backIn:iI,backInOut:Rfe,backOut:rG,anticipate:Lfe},b6=e=>{if(Array.isArray(e)){aI(e.length===4);const[t,r,n,a]=e;return G1(t,r,n,a)}else if(typeof e=="string")return $fe[e];return e},sI=(e,t)=>r=>!!(W1(r)&&Fue.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),nG=(e,t,r)=>n=>{if(!W1(n))return n;const[a,i,s,l]=n.match(MS);return{[e]:parseFloat(a),[t]:parseFloat(i),[r]:parseFloat(s),alpha:l!==void 0?parseFloat(l):1}},Ffe=e=>dh(0,255,e),SP={...mg,transform:e=>Math.round(Ffe(e))},fp={test:sI("rgb","red"),parse:nG("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+SP.transform(e)+", "+SP.transform(t)+", "+SP.transform(r)+", "+Iy(Ty.transform(n))+")"};function Bfe(e){let t="",r="",n="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const $k={test:sI("#"),parse:Bfe,transform:fp.transform},bv={test:sI("hsl","hue"),parse:nG("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Tu.transform(Iy(t))+", "+Tu.transform(Iy(r))+", "+Iy(Ty.transform(n))+")"},nl={test:e=>fp.test(e)||$k.test(e)||bv.test(e),parse:e=>fp.test(e)?fp.parse(e):bv.test(e)?bv.parse(e):$k.parse(e),transform:e=>W1(e)?e:e.hasOwnProperty("red")?fp.transform(e):bv.transform(e)},Vo=(e,t,r)=>-r*e+r*t+e;function CP(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function qfe({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let a=0,i=0,s=0;if(!t)a=i=s=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;a=CP(c,l,e+1/3),i=CP(c,l,e),s=CP(c,l,e-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(s*255),alpha:n}}const PP=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},zfe=[$k,fp,bv],Ufe=e=>zfe.find(t=>t.test(e));function w6(e){const t=Ufe(e);let r=t.parse(e);return t===bv&&(r=qfe(r)),r}const aG=(e,t)=>{const r=w6(e),n=w6(t),a={...r};return i=>(a.red=PP(r.red,n.red,i),a.green=PP(r.green,n.green,i),a.blue=PP(r.blue,n.blue,i),a.alpha=Vo(r.alpha,n.alpha,i),fp.transform(a))};function Vfe(e){var t,r;return isNaN(e)&&W1(e)&&(((t=e.match(MS))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(kH))===null||r===void 0?void 0:r.length)||0)>0}const oG={regex:Lue,countKey:"Vars",token:"${v}",parse:ni},iG={regex:kH,countKey:"Colors",token:"${c}",parse:nl.parse},sG={regex:MS,countKey:"Numbers",token:"${n}",parse:mg.parse};function AP(e,{regex:t,countKey:r,token:n,parse:a}){const i=e.tokenised.match(t);i&&(e["num"+r]=i.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...i.map(a)))}function gN(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&AP(r,oG),AP(r,iG),AP(r,sG),r}function lG(e){return gN(e).values}function cG(e){const{values:t,numColors:r,numVars:n,tokenised:a}=gN(e),i=t.length;return s=>{let l=a;for(let c=0;c<i;c++)c<n?l=l.replace(oG.token,s[c]):c<n+r?l=l.replace(iG.token,nl.transform(s[c])):l=l.replace(sG.token,Iy(s[c]));return l}}const Wfe=e=>typeof e=="number"?0:e;function Hfe(e){const t=lG(e);return cG(e)(t.map(Wfe))}const uh={test:Vfe,parse:lG,createTransformer:cG,getAnimatableNone:Hfe},dG=(e,t)=>r=>`${r>0?t:e}`;function uG(e,t){return typeof e=="number"?r=>Vo(e,t,r):nl.test(e)?aG(e,t):e.startsWith("var(")?dG(e,t):mG(e,t)}const fG=(e,t)=>{const r=[...e],n=r.length,a=e.map((i,s)=>uG(i,t[s]));return i=>{for(let s=0;s<n;s++)r[s]=a[s](i);return r}},Gfe=(e,t)=>{const r={...e,...t},n={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(n[a]=uG(e[a],t[a]));return a=>{for(const i in n)r[i]=n[i](a);return r}},mG=(e,t)=>{const r=uh.createTransformer(t),n=gN(e),a=gN(t);return n.numVars===a.numVars&&n.numColors===a.numColors&&n.numNumbers>=a.numNumbers?Km(fG(n.values,a.values),r):dG(e,t)},Eb=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},j6=(e,t)=>r=>Vo(e,t,r);function Kfe(e){return typeof e=="number"?j6:typeof e=="string"?nl.test(e)?aG:mG:Array.isArray(e)?fG:typeof e=="object"?Gfe:j6}function Yfe(e,t,r){const n=[],a=r||Kfe(e[0]),i=e.length-1;for(let s=0;s<i;s++){let l=a(e[s],e[s+1]);if(t){const c=Array.isArray(t)?t[s]||ni:t;l=Km(c,l)}n.push(l)}return n}function hG(e,t,{clamp:r=!0,ease:n,mixer:a}={}){const i=e.length;if(aI(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=Yfe(t,n,a),l=s.length,c=d=>{let u=0;if(l>1)for(;u<e.length-2&&!(d<e[u+1]);u++);const f=Eb(e[u],e[u+1],d);return s[u](f)};return r?d=>c(dh(e[0],e[i-1],d)):c}function Xfe(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const a=Eb(0,t,n);e.push(Vo(r,1,a))}}function Jfe(e){const t=[0];return Xfe(t,e.length-1),t}function Qfe(e,t){return e.map(r=>r*t)}function Zfe(e,t){return e.map(()=>t||QH).splice(0,e.length-1)}function vN({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=Dfe(n)?n.map(b6):b6(n),i={done:!1,value:t[0]},s=Qfe(r&&r.length===t.length?r:Jfe(t),e),l=hG(s,t,{ease:Array.isArray(a)?a:Zfe(t,a)});return{calculatedDuration:e,next:c=>(i.value=l(c),i.done=c>=e,i)}}function pG(e,t){return t?e*(1e3/t):0}const eme=5;function gG(e,t,r){const n=Math.max(t-eme,0);return pG(r-e(n),t-n)}const EP=.001,tme=.01,N6=10,rme=.05,nme=1;function ame({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let a,i;Sfe(e<=Ym(N6));let s=1-t;s=dh(rme,nme,s),e=dh(tme,N6,_f(e)),s<1?(a=d=>{const u=d*s,f=u*e,m=u-r,h=Fk(d,s),v=Math.exp(-f);return EP-m/h*v},i=d=>{const f=d*s*e,m=f*r+r,h=Math.pow(s,2)*Math.pow(d,2)*e,v=Math.exp(-f),g=Fk(Math.pow(d,2),s);return(-a(d)+EP>0?-1:1)*((m-h)*v)/g}):(a=d=>{const u=Math.exp(-d*e),f=(d-r)*e+1;return-EP+u*f},i=d=>{const u=Math.exp(-d*e),f=(r-d)*(e*e);return u*f});const l=5/e,c=ime(a,i,l);if(e=Ym(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:s*2*Math.sqrt(n*d),duration:e}}}const ome=12;function ime(e,t,r){let n=r;for(let a=1;a<ome;a++)n=n-e(n)/t(n);return n}function Fk(e,t){return e*Math.sqrt(1-t*t)}const sme=["duration","bounce"],lme=["stiffness","damping","mass"];function _6(e,t){return t.some(r=>e[r]!==void 0)}function cme(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!_6(e,lme)&&_6(e,sme)){const r=ame(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function vG({keyframes:e,restDelta:t,restSpeed:r,...n}){const a=e[0],i=e[e.length-1],s={done:!1,value:a},{stiffness:l,damping:c,mass:d,duration:u,velocity:f,isResolvedFromDuration:m}=cme({...n,velocity:-_f(n.velocity||0)}),h=f||0,v=c/(2*Math.sqrt(l*d)),g=i-a,x=_f(Math.sqrt(l/d)),y=Math.abs(g)<5;r||(r=y?.01:2),t||(t=y?.005:.5);let b;if(v<1){const w=Fk(x,v);b=j=>{const _=Math.exp(-v*x*j);return i-_*((h+v*x*g)/w*Math.sin(w*j)+g*Math.cos(w*j))}}else if(v===1)b=w=>i-Math.exp(-x*w)*(g+(h+x*g)*w);else{const w=x*Math.sqrt(v*v-1);b=j=>{const _=Math.exp(-v*x*j),S=Math.min(w*j,300);return i-_*((h+v*x*g)*Math.sinh(S)+w*g*Math.cosh(S))/w}}return{calculatedDuration:m&&u||null,next:w=>{const j=b(w);if(m)s.done=w>=u;else{let _=h;w!==0&&(v<1?_=gG(b,w,j):_=0);const S=Math.abs(_)<=r,k=Math.abs(i-j)<=t;s.done=S&&k}return s.value=s.done?i:j,s}}}function S6({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:s,min:l,max:c,restDelta:d=.5,restSpeed:u}){const f=e[0],m={done:!1,value:f},h=E=>l!==void 0&&E<l||c!==void 0&&E>c,v=E=>l===void 0?c:c===void 0||Math.abs(l-E)<Math.abs(c-E)?l:c;let g=r*t;const x=f+g,y=s===void 0?x:s(x);y!==x&&(g=y-f);const b=E=>-g*Math.exp(-E/n),w=E=>y+b(E),j=E=>{const A=b(E),M=w(E);m.done=Math.abs(A)<=d,m.value=m.done?y:M};let _,S;const k=E=>{h(m.value)&&(_=E,S=vG({keyframes:[m.value,v(m.value)],velocity:gG(w,E,m.value),damping:a,stiffness:i,restDelta:d,restSpeed:u}))};return k(0),{calculatedDuration:null,next:E=>{let A=!1;return!S&&_===void 0&&(A=!0,j(E),k(E)),_!==void 0&&E>_?S.next(E-_):(!A&&j(E),m)}}}const dme=e=>{const t=({timestamp:r})=>e(r);return{start:()=>No.update(t,!0),stop:()=>If(t),now:()=>Ls.isProcessing?Ls.timestamp:performance.now()}},C6=2e4;function P6(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<C6;)t+=r,n=e.next(t);return t>=C6?1/0:t}const ume={decay:S6,inertia:S6,tween:vN,keyframes:vN,spring:vG};function xN({autoplay:e=!0,delay:t=0,driver:r=dme,keyframes:n,type:a="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:l="loop",onPlay:c,onStop:d,onComplete:u,onUpdate:f,...m}){let h=1,v=!1,g,x;const y=()=>{x=new Promise(fe=>{g=fe})};y();let b;const w=ume[a]||vN;let j;w!==vN&&typeof n[0]!="number"&&(j=hG([0,100],n,{clamp:!1}),n=[0,100]);const _=w({...m,keyframes:n});let S;l==="mirror"&&(S=w({...m,keyframes:[...n].reverse(),velocity:-(m.velocity||0)}));let k="idle",E=null,A=null,M=null;_.calculatedDuration===null&&i&&(_.calculatedDuration=P6(_));const{calculatedDuration:C}=_;let T=1/0,I=1/0;C!==null&&(T=C+s,I=T*(i+1)-s);let D=0;const F=fe=>{if(A===null)return;h>0&&(A=Math.min(A,fe)),h<0&&(A=Math.min(fe-I/h,A)),E!==null?D=E:D=Math.round(fe-A)*h;const B=D-t*(h>=0?1:-1),L=h>=0?B<0:B>I;D=Math.max(B,0),k==="finished"&&E===null&&(D=I);let V=D,re=_;if(i){const ae=Math.min(D,I)/T;let J=Math.floor(ae),je=ae%1;!je&&ae>=1&&(je=1),je===1&&J--,J=Math.min(J,i+1),!!(J%2)&&(l==="reverse"?(je=1-je,s&&(je-=s/T)):l==="mirror"&&(re=S)),V=dh(0,1,je)*T}const me=L?{done:!1,value:n[0]}:re.next(V);j&&(me.value=j(me.value));let{done:G}=me;!L&&C!==null&&(G=h>=0?D>=I:D<=0);const Q=E===null&&(k==="finished"||k==="running"&&G);return f&&f(me.value),Q&&$(),me},z=()=>{b&&b.stop(),b=void 0},q=()=>{k="idle",z(),g(),y(),A=M=null},$=()=>{k="finished",u&&u(),z(),g()},K=()=>{if(v)return;b||(b=r(F));const fe=b.now();c&&c(),E!==null?A=fe-E:(!A||k==="finished")&&(A=fe),k==="finished"&&y(),M=A,E=null,k="running",b.start()};e&&K();const ce={then(fe,B){return x.then(fe,B)},get time(){return _f(D)},set time(fe){fe=Ym(fe),D=fe,E!==null||!b||h===0?E=fe:A=b.now()-fe/h},get duration(){const fe=_.calculatedDuration===null?P6(_):_.calculatedDuration;return _f(fe)},get speed(){return h},set speed(fe){fe===h||!b||(h=fe,ce.time=_f(D))},get state(){return k},play:K,pause:()=>{k="paused",E=D},stop:()=>{v=!0,k!=="idle"&&(k="idle",d&&d(),q())},cancel:()=>{M!==null&&F(M),q()},complete:()=>{k="finished"},sample:fe=>(A=0,F(fe))};return ce}function fme(e){let t;return()=>(t===void 0&&(t=e()),t)}const mme=fme(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),hme=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),c2=10,pme=2e4,gme=(e,t)=>t.type==="spring"||e==="backgroundColor"||!KH(t.ease);function vme(e,t,{onUpdate:r,onComplete:n,...a}){if(!(mme()&&hme.has(t)&&!a.repeatDelay&&a.repeatType!=="mirror"&&a.damping!==0&&a.type!=="inertia"))return!1;let s=!1,l,c,d=!1;const u=()=>{c=new Promise(w=>{l=w})};u();let{keyframes:f,duration:m=300,ease:h,times:v}=a;if(gme(t,a)){const w=xN({...a,repeat:0,delay:0});let j={done:!1,value:f[0]};const _=[];let S=0;for(;!j.done&&S<pme;)j=w.sample(S),_.push(j.value),S+=c2;v=void 0,f=_,m=S-c2,h="linear"}const g=Pfe(e.owner.current,t,f,{...a,duration:m,ease:h,times:v}),x=()=>{d=!1,g.cancel()},y=()=>{d=!0,No.update(x),l(),u()};return g.onfinish=()=>{d||(e.set(Afe(f,a)),n&&n(),y())},{then(w,j){return c.then(w,j)},attachTimeline(w){return g.timeline=w,g.onfinish=null,ni},get time(){return _f(g.currentTime||0)},set time(w){g.currentTime=Ym(w)},get speed(){return g.playbackRate},set speed(w){g.playbackRate=w},get duration(){return _f(m)},play:()=>{s||(g.play(),If(x))},pause:()=>g.pause(),stop:()=>{if(s=!0,g.playState==="idle")return;const{currentTime:w}=g;if(w){const j=xN({...a,autoplay:!1});e.setWithVelocity(j.sample(w-c2).value,j.sample(w).value,c2)}y()},complete:()=>{d||g.finish()},cancel:y}}function xme({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const a=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:ni,pause:ni,stop:ni,then:i=>(i(),Promise.resolve()),cancel:ni,complete:ni});return t?xN({keyframes:[0,1],duration:0,delay:t,onComplete:a}):a()}const yme={type:"spring",stiffness:500,damping:25,restSpeed:10},bme=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),wme={type:"keyframes",duration:.8},jme={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Nme=(e,{keyframes:t})=>t.length>2?wme:fg.has(e)?e.startsWith("scale")?bme(t[1]):yme:jme,Bk=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(uh.test(t)||t==="0")&&!t.startsWith("url(")),_me=new Set(["brightness","contrast","saturate","opacity"]);function Sme(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(MS)||[];if(!n)return e;const a=r.replace(n,"");let i=_me.has(t)?1:0;return n!==r&&(i*=100),t+"("+i+a+")"}const Cme=/([a-z-]*)\(.*?\)/g,qk={...uh,getAnimatableNone:e=>{const t=e.match(Cme);return t?t.map(Sme).join(" "):e}},Pme={...OH,color:nl,backgroundColor:nl,outlineColor:nl,fill:nl,stroke:nl,borderColor:nl,borderTopColor:nl,borderRightColor:nl,borderBottomColor:nl,borderLeftColor:nl,filter:qk,WebkitFilter:qk},lI=e=>Pme[e];function xG(e,t){let r=lI(e);return r!==qk&&(r=uh),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const yG=e=>/^0[^.\s]+$/.test(e);function Ame(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||yG(e)}function Eme(e,t,r,n){const a=Bk(t,r);let i;Array.isArray(r)?i=[...r]:i=[null,r];const s=n.from!==void 0?n.from:e.get();let l;const c=[];for(let d=0;d<i.length;d++)i[d]===null&&(i[d]=d===0?s:i[d-1]),Ame(i[d])&&c.push(d),typeof i[d]=="string"&&i[d]!=="none"&&i[d]!=="0"&&(l=i[d]);if(a&&c.length&&l)for(let d=0;d<c.length;d++){const u=c[d];i[u]=xG(t,l)}return i}function kme({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:i,repeatType:s,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}function cI(e,t){return e[t]||e.default||e}const Ome={skipAnimations:!1},dI=(e,t,r,n={})=>a=>{const i=cI(n,e)||{},s=i.delay||n.delay||0;let{elapsed:l=0}=n;l=l-Ym(s);const c=Eme(t,e,r,i),d=c[0],u=c[c.length-1],f=Bk(e,d),m=Bk(e,u);let h={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:v=>{t.set(v),i.onUpdate&&i.onUpdate(v)},onComplete:()=>{a(),i.onComplete&&i.onComplete()}};if(kme(i)||(h={...h,...Nme(e,h)}),h.duration&&(h.duration=Ym(h.duration)),h.repeatDelay&&(h.repeatDelay=Ym(h.repeatDelay)),!f||!m||Cfe.current||i.type===!1||Ome.skipAnimations)return xme(h);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const v=vme(t,e,h);if(v)return v}return xN(h)};function yN(e){return!!(Ll(e)&&e.add)}const bG=e=>/^\-?\d*\.?\d+$/.test(e);function uI(e,t){e.indexOf(t)===-1&&e.push(t)}function fI(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class mI{constructor(){this.subscriptions=[]}add(t){return uI(this.subscriptions,t),()=>fI(this.subscriptions,t)}notify(t,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,n);else for(let i=0;i<a;i++){const s=this.subscriptions[i];s&&s(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Tme=e=>!isNaN(parseFloat(e));class Ime{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,a=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:s}=Ls;this.lastUpdated!==s&&(this.timeDelta=i,this.lastUpdated=s,No.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>No.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=Tme(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new mI);const n=this.events[t].add(r);return t==="change"?()=>{n(),No.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?pG(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function cx(e,t){return new Ime(e,t)}const wG=e=>t=>t.test(e),Dme={test:e=>e==="auto",parse:e=>e},jG=[mg,Gn,Tu,fm,que,Bue,Dme],q0=e=>jG.find(wG(e)),Mme=[...jG,nl,uh],Rme=e=>Mme.find(wG(e));function Lme(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,cx(r))}function $me(e,t){const r=LS(e,t);let{transitionEnd:n={},transition:a={},...i}=r?e.makeTargetAnimatable(r,!1):{};i={...i,...n};for(const s in i){const l=tfe(i[s]);Lme(e,s,l)}}function Fme(e,t,r){var n,a;const i=Object.keys(t).filter(l=>!e.hasValue(l)),s=i.length;if(s)for(let l=0;l<s;l++){const c=i[l],d=t[c];let u=null;Array.isArray(d)&&(u=d[0]),u===null&&(u=(a=(n=r[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&a!==void 0?a:t[c]),u!=null&&(typeof u=="string"&&(bG(u)||yG(u))?u=parseFloat(u):!Rme(u)&&uh.test(d)&&(u=xG(c,d)),e.addValue(c,cx(u,{owner:e})),r[c]===void 0&&(r[c]=u),u!==null&&e.setBaseTarget(c,u))}}function Bme(e,t){return t?(t[e]||t.default||t).from:void 0}function qme(e,t,r){const n={};for(const a in e){const i=Bme(a,t);if(i!==void 0)n[a]=i;else{const s=r.getValue(a);s&&(n[a]=s.get())}}return n}function zme({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function Ume(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function NG(e,t,{delay:r=0,transitionOverride:n,type:a}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:s,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(i=n);const d=[],u=a&&e.animationState&&e.animationState.getState()[a];for(const f in l){const m=e.getValue(f),h=l[f];if(!m||h===void 0||u&&zme(u,f))continue;const v={delay:r,elapsed:0,...cI(i||{},f)};if(window.HandoffAppearAnimations){const y=e.getProps()[_H];if(y){const b=window.HandoffAppearAnimations(y,f,m,No);b!==null&&(v.elapsed=b,v.isHandoff=!0)}}let g=!v.isHandoff&&!Ume(m,h);if(v.type==="spring"&&(m.getVelocity()||v.velocity)&&(g=!1),m.animation&&(g=!1),g)continue;m.start(dI(f,m,h,e.shouldReduceMotion&&fg.has(f)?{type:!1}:v));const x=m.animation;yN(c)&&(c.add(f),x.then(()=>c.remove(f))),d.push(x)}return s&&Promise.all(d).then(()=>{s&&$me(e,s)}),d}function zk(e,t,r={}){const n=LS(e,t,r.custom);let{transition:a=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(a=r.transitionOverride);const i=n?()=>Promise.all(NG(e,n,r)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:f}=a;return Vme(e,t,d+c,u,f,r)}:()=>Promise.resolve(),{when:l}=a;if(l){const[c,d]=l==="beforeChildren"?[i,s]:[s,i];return c().then(()=>d())}else return Promise.all([i(),s(r.delay)])}function Vme(e,t,r=0,n=0,a=1,i){const s=[],l=(e.variantChildren.size-1)*n,c=a===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(Wme).forEach((d,u)=>{d.notify("AnimationStart",t),s.push(zk(d,t,{...i,delay:r+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(s)}function Wme(e,t){return e.sortNodePosition(t)}function Hme(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const a=t.map(i=>zk(e,i,r));n=Promise.all(a)}else if(typeof t=="string")n=zk(e,t,r);else{const a=typeof t=="function"?LS(e,t,r.custom):t;n=Promise.all(NG(e,a,r))}return n.then(()=>e.notify("AnimationComplete",t))}const Gme=[...KT].reverse(),Kme=KT.length;function Yme(e){return t=>Promise.all(t.map(({animation:r,options:n})=>Hme(e,r,n)))}function Xme(e){let t=Yme(e);const r=Qme();let n=!0;const a=(c,d)=>{const u=LS(e,d);if(u){const{transition:f,transitionEnd:m,...h}=u;c={...c,...h,...m}}return c};function i(c){t=c(e)}function s(c,d){const u=e.getProps(),f=e.getVariantContext(!0)||{},m=[],h=new Set;let v={},g=1/0;for(let y=0;y<Kme;y++){const b=Gme[y],w=r[b],j=u[b]!==void 0?u[b]:f[b],_=Pb(j),S=b===d?w.isActive:null;S===!1&&(g=y);let k=j===f[b]&&j!==u[b]&&_;if(k&&n&&e.manuallyAnimateOnMount&&(k=!1),w.protectedKeys={...v},!w.isActive&&S===null||!j&&!w.prevProp||IS(j)||typeof j=="boolean")continue;let A=Jme(w.prevProp,j)||b===d&&w.isActive&&!k&&_||y>g&&_,M=!1;const C=Array.isArray(j)?j:[j];let T=C.reduce(a,{});S===!1&&(T={});const{prevResolvedValues:I={}}=w,D={...I,...T},F=z=>{A=!0,h.has(z)&&(M=!0,h.delete(z)),w.needsAnimating[z]=!0};for(const z in D){const q=T[z],$=I[z];if(v.hasOwnProperty(z))continue;let K=!1;pN(q)&&pN($)?K=!HH(q,$):K=q!==$,K?q!==void 0?F(z):h.add(z):q!==void 0&&h.has(z)?F(z):w.protectedKeys[z]=!0}w.prevProp=j,w.prevResolvedValues=T,w.isActive&&(v={...v,...T}),n&&e.blockInitialAnimation&&(A=!1),A&&(!k||M)&&m.push(...C.map(z=>({animation:z,options:{type:b,...c}})))}if(h.size){const y={};h.forEach(b=>{const w=e.getBaseTarget(b);w!==void 0&&(y[b]=w)}),m.push({animation:y})}let x=!!m.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(x=!1),n=!1,x?t(m):Promise.resolve()}function l(c,d,u){var f;if(r[c].isActive===d)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(h=>{var v;return(v=h.animationState)===null||v===void 0?void 0:v.setActive(c,d)}),r[c].isActive=d;const m=s(u,c);for(const h in r)r[h].protectedKeys={};return m}return{animateChanges:s,setActive:l,setAnimateFunction:i,getState:()=>r}}function Jme(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!HH(t,e):!1}function $h(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Qme(){return{animate:$h(!0),whileInView:$h(),whileHover:$h(),whileTap:$h(),whileDrag:$h(),whileFocus:$h(),exit:$h()}}class Zme extends jh{constructor(t){super(t),t.animationState||(t.animationState=Xme(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),IS(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let ehe=0;class the extends jh{constructor(){super(...arguments),this.id=ehe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const i=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&i.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const rhe={animation:{Feature:Zme},exit:{Feature:the}},A6=(e,t)=>Math.abs(e-t);function nhe(e,t){const r=A6(e.x,t.x),n=A6(e.y,t.y);return Math.sqrt(r**2+n**2)}class _G{constructor(t,r,{transformPagePoint:n,contextWindow:a,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=OP(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,h=nhe(f.offset,{x:0,y:0})>=3;if(!m&&!h)return;const{point:v}=f,{timestamp:g}=Ls;this.history.push({...v,timestamp:g});const{onStart:x,onMove:y}=this.handlers;m||(x&&x(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=kP(m,this.transformPagePoint),No.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:h,onSessionEnd:v,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=OP(f.type==="pointercancel"?this.lastMoveEventInfo:kP(m,this.transformPagePoint),this.history);this.startEvent&&h&&h(f,x),v&&v(f,x)},!qH(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=a||window;const s=RS(t),l=kP(s,this.transformPagePoint),{point:c}=l,{timestamp:d}=Ls;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=r;u&&u(t,OP(l,this.history)),this.removeListeners=Km(Nf(this.contextWindow,"pointermove",this.handlePointerMove),Nf(this.contextWindow,"pointerup",this.handlePointerUp),Nf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),If(this.updatePoint)}}function kP(e,t){return t?{point:t(e.point)}:e}function E6(e,t){return{x:e.x-t.x,y:e.y-t.y}}function OP({point:e},t){return{point:e,delta:E6(e,SG(t)),offset:E6(e,ahe(t)),velocity:ohe(t,.1)}}function ahe(e){return e[0]}function SG(e){return e[e.length-1]}function ohe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const a=SG(e);for(;r>=0&&(n=e[r],!(a.timestamp-n.timestamp>Ym(t)));)r--;if(!n)return{x:0,y:0};const i=_f(a.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const s={x:(a.x-n.x)/i,y:(a.y-n.y)/i};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function Sc(e){return e.max-e.min}function Uk(e,t=0,r=.01){return Math.abs(e-t)<=r}function k6(e,t,r,n=.5){e.origin=n,e.originPoint=Vo(t.min,t.max,e.origin),e.scale=Sc(r)/Sc(t),(Uk(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=Vo(r.min,r.max,e.origin)-e.originPoint,(Uk(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Dy(e,t,r,n){k6(e.x,t.x,r.x,n?n.originX:void 0),k6(e.y,t.y,r.y,n?n.originY:void 0)}function O6(e,t,r){e.min=r.min+t.min,e.max=e.min+Sc(t)}function ihe(e,t,r){O6(e.x,t.x,r.x),O6(e.y,t.y,r.y)}function T6(e,t,r){e.min=t.min-r.min,e.max=e.min+Sc(t)}function My(e,t,r){T6(e.x,t.x,r.x),T6(e.y,t.y,r.y)}function she(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Vo(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Vo(r,e,n.max):Math.min(e,r)),e}function I6(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function lhe(e,{top:t,left:r,bottom:n,right:a}){return{x:I6(e.x,r,a),y:I6(e.y,t,n)}}function D6(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function che(e,t){return{x:D6(e.x,t.x),y:D6(e.y,t.y)}}function dhe(e,t){let r=.5;const n=Sc(e),a=Sc(t);return a>n?r=Eb(t.min,t.max-n,e.min):n>a&&(r=Eb(e.min,e.max-a,t.min)),dh(0,1,r)}function uhe(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Vk=.35;function fhe(e=Vk){return e===!1?e=0:e===!0&&(e=Vk),{x:M6(e,"left","right"),y:M6(e,"top","bottom")}}function M6(e,t,r){return{min:R6(e,t),max:R6(e,r)}}function R6(e,t){return typeof e=="number"?e:e[t]||0}const L6=()=>({translate:0,scale:1,origin:0,originPoint:0}),wv=()=>({x:L6(),y:L6()}),$6=()=>({min:0,max:0}),wi=()=>({x:$6(),y:$6()});function Vc(e){return[e("x"),e("y")]}function CG({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function mhe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function hhe(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function TP(e){return e===void 0||e===1}function Wk({scale:e,scaleX:t,scaleY:r}){return!TP(e)||!TP(t)||!TP(r)}function Kh(e){return Wk(e)||PG(e)||e.z||e.rotate||e.rotateX||e.rotateY}function PG(e){return F6(e.x)||F6(e.y)}function F6(e){return e&&e!=="0%"}function bN(e,t,r){const n=e-r,a=t*n;return r+a}function B6(e,t,r,n,a){return a!==void 0&&(e=bN(e,a,n)),bN(e,r,n)+t}function Hk(e,t=0,r=1,n,a){e.min=B6(e.min,t,r,n,a),e.max=B6(e.max,t,r,n,a)}function AG(e,{x:t,y:r}){Hk(e.x,t.translate,t.scale,t.originPoint),Hk(e.y,r.translate,r.scale,r.originPoint)}function phe(e,t,r,n=!1){const a=r.length;if(!a)return;t.x=t.y=1;let i,s;for(let l=0;l<a;l++){i=r[l],s=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&jv(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,AG(e,s)),n&&Kh(i.latestValues)&&jv(e,i.latestValues))}t.x=q6(t.x),t.y=q6(t.y)}function q6(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function ym(e,t){e.min=e.min+t,e.max=e.max+t}function z6(e,t,[r,n,a]){const i=t[a]!==void 0?t[a]:.5,s=Vo(e.min,e.max,i);Hk(e,t[r],t[n],s,t.scale)}const ghe=["x","scaleX","originX"],vhe=["y","scaleY","originY"];function jv(e,t){z6(e.x,t,ghe),z6(e.y,t,vhe)}function EG(e,t){return CG(hhe(e.getBoundingClientRect(),t))}function xhe(e,t,r){const n=EG(e,r),{scroll:a}=t;return a&&(ym(n.x,a.offset.x),ym(n.y,a.offset.y)),n}const kG=({current:e})=>e?e.ownerDocument.defaultView:null,yhe=new WeakMap;class bhe{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=wi(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(RS(u,"page").point)},i=(u,f)=>{const{drag:m,dragPropagation:h,onDragStart:v}=this.getProps();if(m&&!h&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=UH(m),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Vc(x=>{let y=this.getAxisMotionValue(x).get()||0;if(Tu.test(y)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[x];w&&(y=Sc(w)*(parseFloat(y)/100))}}this.originPoint[x]=y}),v&&No.update(()=>v(u,f),!1,!0);const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},s=(u,f)=>{const{dragPropagation:m,dragDirectionLock:h,onDirectionLock:v,onDrag:g}=this.getProps();if(!m&&!this.openGlobalLock)return;const{offset:x}=f;if(h&&this.currentDirection===null){this.currentDirection=whe(x),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,x),this.updateAxis("y",f.point,x),this.visualElement.render(),g&&g(u,f)},l=(u,f)=>this.stop(u,f),c=()=>Vc(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new _G(t,{onSessionStart:a,onStart:i,onMove:s,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:kG(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:i}=this.getProps();i&&No.update(()=>i(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:a}=this.getProps();if(!n||!d2(t,a,this.currentDirection))return;const i=this.getAxisMotionValue(t);let s=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(s=she(s,this.constraints[t],this.elastic[t])),i.set(s)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;r&&yv(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=lhe(a.layoutBox,r):this.constraints=!1,this.elastic=fhe(n),i!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&Vc(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=uhe(a.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!yv(t))return!1;const n=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=xhe(n,a.root,this.visualElement.getTransformPagePoint());let s=che(a.layout.layoutBox,i);if(r){const l=r(mhe(s));this.hasMutatedConstraints=!!l,l&&(s=CG(l))}return s}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:i,dragSnapToOrigin:s,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Vc(u=>{if(!d2(u,r,this.currentDirection))return;let f=c&&c[u]||{};s&&(f={min:0,max:0});const m=a?200:1e6,h=a?40:1e7,v={type:"inertia",velocity:n?t[u]:0,bounceStiffness:m,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(u,v)});return Promise.all(d).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(dI(t,n,0,r))}stopAnimation(){Vc(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Vc(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Vc(r=>{const{drag:n}=this.getProps();if(!d2(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(r);if(a&&a.layout){const{min:s,max:l}=a.layout.layoutBox[r];i.set(t[r]-Vo(s,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!yv(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Vc(s=>{const l=this.getAxisMotionValue(s);if(l){const c=l.get();a[s]=dhe({min:c,max:c},this.constraints[s])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Vc(s=>{if(!d2(s,t,null))return;const l=this.getAxisMotionValue(s),{min:c,max:d}=this.constraints[s];l.set(Vo(c,d,a[s]))})}addListeners(){if(!this.visualElement.current)return;yhe.set(this.visualElement,this);const t=this.visualElement.current,r=Nf(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();yv(c)&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),n();const s=vf(window,"resize",()=>this.scalePositionWithinConstraints()),l=a.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Vc(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=c[u].translate,f.set(f.get()+c[u].translate))}),this.visualElement.render())});return()=>{s(),r(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:s=Vk,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:i,dragElastic:s,dragMomentum:l}}}function d2(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function whe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class jhe extends jh{constructor(t){super(t),this.removeGroupControls=ni,this.removeListeners=ni,this.controls=new bhe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ni}unmount(){this.removeGroupControls(),this.removeListeners()}}const U6=e=>(t,r)=>{e&&No.update(()=>e(t,r))};class Nhe extends jh{constructor(){super(...arguments),this.removePointerDownListener=ni}onPointerDown(t){this.session=new _G(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:kG(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:U6(t),onStart:U6(r),onMove:n,onEnd:(i,s)=>{delete this.session,a&&No.update(()=>a(i,s))}}}mount(){this.removePointerDownListener=Nf(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function _he(){const e=p.useContext(OS);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,a=p.useId();return p.useEffect(()=>n(a),[]),!t&&r?[!1,()=>r&&r(a)]:[!0]}const xj={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function V6(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const z0={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Gn.test(e))e=parseFloat(e);else return e;const r=V6(e,t.target.x),n=V6(e,t.target.y);return`${r}% ${n}%`}},She={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,a=uh.parse(e);if(a.length>5)return n;const i=uh.createTransformer(e),s=typeof a[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;a[0+s]/=l,a[1+s]/=c;const d=Vo(l,c,.5);return typeof a[2+s]=="number"&&(a[2+s]/=d),typeof a[3+s]=="number"&&(a[3+s]/=d),i(a)}};class Che extends xe.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:i}=t;Iue(Phe),i&&(r.group&&r.group.add(i),n&&n.register&&a&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),xj.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:a,isPresent:i}=this.props,s=n.projection;return s&&(s.isPresent=i,a||t.layoutDependency!==r||r===void 0?s.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?s.promote():s.relegate()||No.postRender(()=>{const l=s.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function OG(e){const[t,r]=_he(),n=p.useContext(XT);return xe.createElement(Che,{...e,layoutGroup:n,switchLayoutGroup:p.useContext(CH),isPresent:t,safeToRemove:r})}const Phe={borderRadius:{...z0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:z0,borderTopRightRadius:z0,borderBottomLeftRadius:z0,borderBottomRightRadius:z0,boxShadow:She},TG=["TopLeft","TopRight","BottomLeft","BottomRight"],Ahe=TG.length,W6=e=>typeof e=="string"?parseFloat(e):e,H6=e=>typeof e=="number"||Gn.test(e);function Ehe(e,t,r,n,a,i){a?(e.opacity=Vo(0,r.opacity!==void 0?r.opacity:1,khe(n)),e.opacityExit=Vo(t.opacity!==void 0?t.opacity:1,0,Ohe(n))):i&&(e.opacity=Vo(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let s=0;s<Ahe;s++){const l=`border${TG[s]}Radius`;let c=G6(t,l),d=G6(r,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||H6(c)===H6(d)?(e[l]=Math.max(Vo(W6(c),W6(d),n),0),(Tu.test(d)||Tu.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||r.rotate)&&(e.rotate=Vo(t.rotate||0,r.rotate||0,n))}function G6(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const khe=IG(0,.5,tG),Ohe=IG(.5,.95,ni);function IG(e,t,r){return n=>n<e?0:n>t?1:r(Eb(e,t,n))}function K6(e,t){e.min=t.min,e.max=t.max}function Fc(e,t){K6(e.x,t.x),K6(e.y,t.y)}function Y6(e,t,r,n,a){return e-=t,e=bN(e,1/r,n),a!==void 0&&(e=bN(e,1/a,n)),e}function The(e,t=0,r=1,n=.5,a,i=e,s=e){if(Tu.test(t)&&(t=parseFloat(t),t=Vo(s.min,s.max,t/100)-s.min),typeof t!="number")return;let l=Vo(i.min,i.max,n);e===i&&(l-=t),e.min=Y6(e.min,t,r,l,a),e.max=Y6(e.max,t,r,l,a)}function X6(e,t,[r,n,a],i,s){The(e,t[r],t[n],t[a],t.scale,i,s)}const Ihe=["x","scaleX","originX"],Dhe=["y","scaleY","originY"];function J6(e,t,r,n){X6(e.x,t,Ihe,r?r.x:void 0,n?n.x:void 0),X6(e.y,t,Dhe,r?r.y:void 0,n?n.y:void 0)}function Q6(e){return e.translate===0&&e.scale===1}function DG(e){return Q6(e.x)&&Q6(e.y)}function Mhe(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function MG(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function Z6(e){return Sc(e.x)/Sc(e.y)}class Rhe{constructor(){this.members=[]}add(t){uI(this.members,t),t.scheduleRender()}remove(t){if(fI(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function e$(e,t,r){let n="";const a=e.x.translate/t.x,i=e.y.translate/t.y;if((a||i)&&(n=`translate3d(${a}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:d,rotateY:u}=r;c&&(n+=`rotate(${c}deg) `),d&&(n+=`rotateX(${d}deg) `),u&&(n+=`rotateY(${u}deg) `)}const s=e.x.scale*t.x,l=e.y.scale*t.y;return(s!==1||l!==1)&&(n+=`scale(${s}, ${l})`),n||"none"}const Lhe=(e,t)=>e.depth-t.depth;class $he{constructor(){this.children=[],this.isDirty=!1}add(t){uI(this.children,t),this.isDirty=!0}remove(t){fI(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Lhe),this.isDirty=!1,this.children.forEach(t)}}function Fhe(e,t){const r=performance.now(),n=({timestamp:a})=>{const i=a-r;i>=t&&(If(n),e(i-t))};return No.read(n,!0),()=>If(n)}function Bhe(e){window.MotionDebug&&window.MotionDebug.record(e)}function qhe(e){return e instanceof SVGElement&&e.tagName!=="svg"}function zhe(e,t,r){const n=Ll(e)?e:cx(e);return n.start(dI("",n,t,r)),n.animation}const t$=["","X","Y","Z"],Uhe={visibility:"hidden"},r$=1e3;let Vhe=0;const Yh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function RG({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(s={},l=t?.()){this.id=Vhe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Yh.totalNodes=Yh.resolvedTargetDeltas=Yh.recalculatedProjection=0,this.nodes.forEach(Ghe),this.nodes.forEach(Qhe),this.nodes.forEach(Zhe),this.nodes.forEach(Khe),Bhe(Yh)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new $he)}addEventListener(s,l){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new mI),this.eventHandlers.get(s).add(l)}notifyListeners(s,...l){const c=this.eventHandlers.get(s);c&&c.notify(...l)}hasListeners(s){return this.eventHandlers.has(s)}mount(s,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=qhe(s),this.instance=s;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let f;const m=()=>this.root.updateBlockedByResize=!1;e(s,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=Fhe(m,250),xj.hasAnimatedSinceResize&&(xj.hasAnimatedSinceResize=!1,this.nodes.forEach(a$))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeTargetChanged:h,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||ape,{onLayoutAnimationStart:x,onLayoutAnimationComplete:y}=u.getProps(),b=!this.targetLayout||!MG(this.targetLayout,v)||h,w=!m&&h;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||m&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,w);const j={...cI(g,"layout"),onPlay:x,onComplete:y};(u.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j)}else m||a$(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,If(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(epe),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(n$);return}this.isUpdating||this.nodes.forEach(Xhe),this.isUpdating=!1,this.nodes.forEach(Jhe),this.nodes.forEach(Whe),this.nodes.forEach(Hhe),this.clearAllSnapshots();const l=performance.now();Ls.delta=dh(0,1e3/60,l-Ls.timestamp),Ls.timestamp=l,Ls.isProcessing=!0,jP.update.process(Ls),jP.preRender.process(Ls),jP.render.process(Ls),Ls.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Yhe),this.sharedNodes.forEach(tpe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,No.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){No.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=wi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:s,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!a)return;const s=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!DG(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;s&&(l||Kh(this.latestValues)||u)&&(a(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return s&&(c=this.removeTransform(c)),ope(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:s}=this.options;if(!s)return wi();const l=s.measureViewportBox(),{scroll:c}=this.root;return c&&(ym(l.x,c.offset.x),ym(l.y,c.offset.y)),l}removeElementScroll(s){const l=wi();Fc(l,s);for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:f}=d;if(d!==this.root&&u&&f.layoutScroll){if(u.isRoot){Fc(l,s);const{scroll:m}=this.root;m&&(ym(l.x,-m.offset.x),ym(l.y,-m.offset.y))}ym(l.x,u.offset.x),ym(l.y,u.offset.y)}}return l}applyTransform(s,l=!1){const c=wi();Fc(c,s);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&jv(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Kh(u.latestValues)&&jv(c,u.latestValues)}return Kh(this.latestValues)&&jv(c,this.latestValues),c}removeTransform(s){const l=wi();Fc(l,s);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Kh(d.latestValues))continue;Wk(d.latestValues)&&d.updateSnapshot();const u=wi(),f=d.measurePageBox();Fc(u,f),J6(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Kh(this.latestValues)&&J6(l,this.latestValues),l}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ls.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(s||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:m}=this.options;if(!(!this.layout||!(f||m))){if(this.resolvedRelativeTargetAt=Ls.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=wi(),this.relativeTargetOrigin=wi(),My(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),Fc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=wi(),this.targetWithTransforms=wi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),ihe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Fc(this.target,this.layout.layoutBox),AG(this.target,this.targetDelta)):Fc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=wi(),this.relativeTargetOrigin=wi(),My(this.relativeTargetOrigin,this.target,h.target),Fc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Yh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Wk(this.parent.latestValues)||PG(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var s;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Ls.timestamp&&(d=!1),d)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;Fc(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,h=this.treeScale.y;phe(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:v}=l;if(!v){this.projectionTransform&&(this.projectionDelta=wv(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=wv(),this.projectionDeltaWithTransform=wv());const g=this.projectionTransform;Dy(this.projectionDelta,this.layoutCorrected,v,this.latestValues),this.projectionTransform=e$(this.projectionDelta,this.treeScale),(this.projectionTransform!==g||this.treeScale.x!==m||this.treeScale.y!==h)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),Yh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),s){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(s,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},f=wv();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=wi(),h=c?c.source:void 0,v=this.layout?this.layout.source:void 0,g=h!==v,x=this.getStack(),y=!x||x.members.length<=1,b=!!(g&&!y&&this.options.crossfade===!0&&!this.path.some(npe));this.animationProgress=0;let w;this.mixTargetDelta=j=>{const _=j/1e3;o$(f.x,s.x,_),o$(f.y,s.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(My(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),rpe(this.relativeTarget,this.relativeTargetOrigin,m,_),w&&Mhe(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=wi()),Fc(w,this.relativeTarget)),g&&(this.animationValues=u,Ehe(u,d,this.latestValues,_,b,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(If(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=No.update(()=>{xj.hasAnimatedSinceResize=!0,this.currentAnimation=zhe(0,r$,{...s,onUpdate:l=>{this.mixTargetDelta(l),s.onUpdate&&s.onUpdate(l)},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(r$),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=s;if(!(!l||!c||!d)){if(this!==s&&this.layout&&d&&LG(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||wi();const f=Sc(this.layout.layoutBox.x);c.x.min=s.target.x.min,c.x.max=c.x.min+f;const m=Sc(this.layout.layoutBox.y);c.y.min=s.target.y.min,c.y.max=c.y.min+m}Fc(l,c),jv(l,u),Dy(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(s,l){this.sharedNodes.has(s)||this.sharedNodes.set(s,new Rhe),this.sharedNodes.get(s).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){var s;const{layoutId:l}=this.options;return l?((s=this.getStack())===null||s===void 0?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:l}=this.options;return l?(s=this.getStack())===null||s===void 0?void 0:s.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),s&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetRotation(){const{visualElement:s}=this.options;if(!s)return;let l=!1;const{latestValues:c}=s;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const d={};for(let u=0;u<t$.length;u++){const f="rotate"+t$[u];c[f]&&(d[f]=c[f],s.setStaticValue(f,0))}s.render();for(const u in d)s.setStaticValue(u,d[u]);s.scheduleRender()}getProjectionStyles(s){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Uhe;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=vj(s?.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=vj(s?.pointerEvents)||""),this.hasProjected&&!Kh(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const m=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=e$(this.projectionDeltaWithTransform,this.treeScale,m),u&&(d.transform=u(m,d.transform));const{x:h,y:v}=this.projectionDelta;d.transformOrigin=`${h.origin*100}% ${v.origin*100}% 0`,f.animationValues?d.opacity=f===this?(c=(l=m.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:d.opacity=f===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const g in mN){if(m[g]===void 0)continue;const{correct:x,applyTo:y}=mN[g],b=d.transform==="none"?m[g]:x(m[g],f);if(y){const w=y.length;for(let j=0;j<w;j++)d[y[j]]=b}else d[g]=b}return this.options.layoutId&&(d.pointerEvents=f===this?vj(s?.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>{var l;return(l=s.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(n$),this.root.sharedNodes.clear()}}}function Whe(e){e.updateLayout()}function Hhe(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=e.layout,{animationType:i}=e.options,s=r.source!==e.layout.source;i==="size"?Vc(f=>{const m=s?r.measuredBox[f]:r.layoutBox[f],h=Sc(m);m.min=n[f].min,m.max=m.min+h}):LG(i,r.layoutBox,n)&&Vc(f=>{const m=s?r.measuredBox[f]:r.layoutBox[f],h=Sc(n[f]);m.max=m.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+h)});const l=wv();Dy(l,n,r.layoutBox);const c=wv();s?Dy(c,e.applyTransform(a,!0),r.measuredBox):Dy(c,n,r.layoutBox);const d=!DG(l);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:h}=f;if(m&&h){const v=wi();My(v,r.layoutBox,m.layoutBox);const g=wi();My(g,n,h.layoutBox),MG(v,g)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=v,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Ghe(e){Yh.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Khe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Yhe(e){e.clearSnapshot()}function n$(e){e.clearMeasurements()}function Xhe(e){e.isLayoutDirty=!1}function Jhe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function a$(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Qhe(e){e.resolveTargetDelta()}function Zhe(e){e.calcProjection()}function epe(e){e.resetRotation()}function tpe(e){e.removeLeadSnapshot()}function o$(e,t,r){e.translate=Vo(t.translate,0,r),e.scale=Vo(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function i$(e,t,r,n){e.min=Vo(t.min,r.min,n),e.max=Vo(t.max,r.max,n)}function rpe(e,t,r,n){i$(e.x,t.x,r.x,n),i$(e.y,t.y,r.y,n)}function npe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const ape={duration:.45,ease:[.4,0,.1,1]},s$=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),l$=s$("applewebkit/")&&!s$("chrome/")?Math.round:ni;function c$(e){e.min=l$(e.min),e.max=l$(e.max)}function ope(e){c$(e.x),c$(e.y)}function LG(e,t,r){return e==="position"||e==="preserve-aspect"&&!Uk(Z6(t),Z6(r),.2)}const ipe=RG({attachResizeListener:(e,t)=>vf(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),IP={current:void 0},$G=RG({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!IP.current){const e=new ipe({});e.mount(window),e.setOptions({layoutScroll:!0}),IP.current=e}return IP.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),spe={pan:{Feature:Nhe},drag:{Feature:jhe,ProjectionNode:$G,MeasureLayout:OG}},lpe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function cpe(e){const t=lpe.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function Gk(e,t,r=1){const[n,a]=cpe(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const s=i.trim();return bG(s)?parseFloat(s):s}else return Rk(a)?Gk(a,t,r+1):a}function dpe(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(a=>{const i=a.get();if(!Rk(i))return;const s=Gk(i,n);s&&a.set(s)});for(const a in t){const i=t[a];if(!Rk(i))continue;const s=Gk(i,n);s&&(t[a]=s,r||(r={}),r[a]===void 0&&(r[a]=i))}return{target:t,transitionEnd:r}}const upe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),FG=e=>upe.has(e),fpe=e=>Object.keys(e).some(FG),d$=e=>e===mg||e===Gn,u$=(e,t)=>parseFloat(e.split(", ")[t]),f$=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const a=n.match(/^matrix3d\((.+)\)$/);if(a)return u$(a[1],t);{const i=n.match(/^matrix\((.+)\)$/);return i?u$(i[1],e):0}},mpe=new Set(["x","y","z"]),hpe=V1.filter(e=>!mpe.has(e));function ppe(e){const t=[];return hpe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const dx={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:f$(4,13),y:f$(5,14)};dx.translateX=dx.x;dx.translateY=dx.y;const gpe=(e,t,r)=>{const n=t.measureViewportBox(),a=t.current,i=getComputedStyle(a),{display:s}=i,l={};s==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(d=>{l[d]=dx[d](n,i)}),t.render();const c=t.measureViewportBox();return r.forEach(d=>{const u=t.getValue(d);u&&u.jump(l[d]),e[d]=dx[d](c,i)}),e},vpe=(e,t,r={},n={})=>{t={...t},n={...n};const a=Object.keys(t).filter(FG);let i=[],s=!1;const l=[];if(a.forEach(c=>{const d=e.getValue(c);if(!e.hasValue(c))return;let u=r[c],f=q0(u);const m=t[c];let h;if(pN(m)){const v=m.length,g=m[0]===null?1:0;u=m[g],f=q0(u);for(let x=g;x<v&&m[x]!==null;x++)h?aI(q0(m[x])===h):h=q0(m[x])}else h=q0(m);if(f!==h)if(d$(f)&&d$(h)){const v=d.get();typeof v=="string"&&d.set(parseFloat(v)),typeof m=="string"?t[c]=parseFloat(m):Array.isArray(m)&&h===Gn&&(t[c]=m.map(parseFloat))}else f?.transform&&h?.transform&&(u===0||m===0)?u===0?d.set(h.transform(u)):t[c]=f.transform(m):(s||(i=ppe(e),s=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],d.jump(m))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,d=gpe(t,e,l);return i.length&&i.forEach(([u,f])=>{e.getValue(u).set(f)}),e.render(),TS&&c!==null&&window.scrollTo({top:c}),{target:d,transitionEnd:n}}else return{target:t,transitionEnd:n}};function xpe(e,t,r,n){return fpe(t)?vpe(e,t,r,n):{target:t,transitionEnd:n}}const ype=(e,t,r,n)=>{const a=dpe(e,t,n);return t=a.target,n=a.transitionEnd,xpe(e,t,r,n)},Kk={current:null},BG={current:!1};function bpe(){if(BG.current=!0,!!TS)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Kk.current=e.matches;e.addListener(t),t()}else Kk.current=!1}function wpe(e,t,r){const{willChange:n}=t;for(const a in t){const i=t[a],s=r[a];if(Ll(i))e.addValue(a,i),yN(n)&&n.add(a);else if(Ll(s))e.addValue(a,cx(i,{owner:e})),yN(n)&&n.remove(a);else if(s!==i)if(e.hasValue(a)){const l=e.getValue(a);!l.hasAnimated&&l.set(i)}else{const l=e.getStaticValue(a);e.addValue(a,cx(l!==void 0?l:i,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const m$=new WeakMap,qG=Object.keys(Ab),jpe=qG.length,h$=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Npe=YT.length;class _pe{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:a,visualState:i},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>No.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=s,this.isControllingVariants=DS(r),this.isVariantNode=SH(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(r,{});for(const f in u){const m=u[f];l[f]!==void 0&&Ll(m)&&(m.set(l[f],!1),yN(d)&&d.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,m$.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),BG.current||bpe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Kk.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){m$.delete(this.current),this.projection&&this.projection.unmount(),If(this.notifyUpdate),If(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=fg.has(t),a=r.on("change",s=>{this.latestValues[t]=s,this.props.onUpdate&&No.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{a(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,a,i){let s,l;for(let c=0;c<jpe;c++){const d=qG[c],{isEnabled:u,Feature:f,ProjectionNode:m,MeasureLayout:h}=Ab[d];m&&(s=m),u(r)&&(!this.features[d]&&f&&(this.features[d]=new f(this)),h&&(l=h))}if((this.type==="html"||this.type==="svg")&&!this.projection&&s){this.projection=new s(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:d,drag:u,dragConstraints:f,layoutScroll:m,layoutRoot:h}=r;this.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!u||f&&yv(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:i,layoutScroll:m,layoutRoot:h})}return l}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):wi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<h$.length;n++){const a=h$[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i=t["on"+a];i&&(this.propEventSubscriptions[a]=this.on(a,i))}this.prevMotionValues=wpe(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<Npe;n++){const a=YT[n],i=this.props[a];(Pb(i)||i===!1)&&(r[a]=i)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=cx(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,a=typeof n=="string"||typeof n=="object"?(r=nI(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&a!==void 0)return a;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!Ll(i)?i:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new mI),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class zG extends _pe{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:a},i){let s=qme(n,t||{},this);if(a&&(r&&(r=a(r)),n&&(n=a(n)),s&&(s=a(s))),i){Fme(this,n,s);const l=ype(this,n,s,r);r=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:r,...n}}}function Spe(e){return window.getComputedStyle(e)}class Cpe extends zG{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(fg.has(r)){const n=lI(r);return n&&n.default||0}else{const n=Spe(t),a=(EH(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return EG(t,r)}build(t,r,n,a){QT(t,r,n,a.transformTemplate)}scrapeMotionValuesFromProps(t,r){return rI(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Ll(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,a){MH(t,r,n,a)}}class Ppe extends zG{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(fg.has(r)){const n=lI(r);return n&&n.default||0}return r=RH.has(r)?r:GT(r),t.getAttribute(r)}measureInstanceViewportBox(){return wi()}scrapeMotionValuesFromProps(t,r){return $H(t,r)}build(t,r,n,a){eI(t,r,n,this.isSVGTag,a.transformTemplate)}renderInstance(t,r,n,a){LH(t,r,n,a)}mount(t){this.isSVGTag=tI(t.tagName),super.mount(t)}}const Ape=(e,t)=>JT(e)?new Ppe(t,{enableHardwareAcceleration:!1}):new Cpe(t,{enableHardwareAcceleration:!0}),Epe={layout:{ProjectionNode:$G,MeasureLayout:OG}},kpe={...rhe,...jfe,...spe,...Epe},fr=Oue((e,t)=>cfe(e,t,kpe,Ape));function UG(){const e=p.useRef(!1);return HT(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Ope(){const e=UG(),[t,r]=p.useState(0),n=p.useCallback(()=>{e.current&&r(t+1)},[t]);return[p.useCallback(()=>No.postRender(n),[n]),t]}class Tpe extends p.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Ipe({children:e,isPresent:t}){const r=p.useId(),n=p.useRef(null),a=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:i,height:s,top:l,left:c}=a.current;if(t||!n.current||!i||!s)return;n.current.dataset.motionPopId=r;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),p.createElement(Tpe,{isPresent:t,childRef:n,sizeRef:a},p.cloneElement(e,{ref:n}))}const DP=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:a,presenceAffectsLayout:i,mode:s})=>{const l=FH(Dpe),c=p.useId(),d=p.useMemo(()=>({id:c,initial:t,isPresent:r,custom:a,onExitComplete:u=>{l.set(u,!0);for(const f of l.values())if(!f)return;n&&n()},register:u=>(l.set(u,!1),()=>l.delete(u))}),i?void 0:[r]);return p.useMemo(()=>{l.forEach((u,f)=>l.set(f,!1))},[r]),p.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),s==="popLayout"&&(e=p.createElement(Ipe,{isPresent:r},e)),p.createElement(OS.Provider,{value:d},e)};function Dpe(){return new Map}function Mpe(e){return p.useEffect(()=>()=>e(),[])}const Xh=e=>e.key||"";function Rpe(e,t){e.forEach(r=>{const n=Xh(r);t.set(n,r)})}function Lpe(e){const t=[];return p.Children.forEach(e,r=>{p.isValidElement(r)&&t.push(r)}),t}const $pe=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:a,presenceAffectsLayout:i=!0,mode:s="sync"})=>{const l=p.useContext(XT).forceRender||Ope()[0],c=UG(),d=Lpe(e);let u=d;const f=p.useRef(new Map).current,m=p.useRef(u),h=p.useRef(new Map).current,v=p.useRef(!0);if(HT(()=>{v.current=!1,Rpe(d,h),m.current=u}),Mpe(()=>{v.current=!0,h.clear(),f.clear()}),v.current)return p.createElement(p.Fragment,null,u.map(b=>p.createElement(DP,{key:Xh(b),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:i,mode:s},b)));u=[...u];const g=m.current.map(Xh),x=d.map(Xh),y=g.length;for(let b=0;b<y;b++){const w=g[b];x.indexOf(w)===-1&&!f.has(w)&&f.set(w,void 0)}return s==="wait"&&f.size&&(u=[]),f.forEach((b,w)=>{if(x.indexOf(w)!==-1)return;const j=h.get(w);if(!j)return;const _=g.indexOf(w);let S=b;if(!S){const k=()=>{f.delete(w);const E=Array.from(h.keys()).filter(A=>!x.includes(A));if(E.forEach(A=>h.delete(A)),m.current=d.filter(A=>{const M=Xh(A);return M===w||E.includes(M)}),!f.size){if(c.current===!1)return;l(),n&&n()}};S=p.createElement(DP,{key:Xh(j),isPresent:!1,onExitComplete:k,custom:t,presenceAffectsLayout:i,mode:s},j),f.set(w,S)}u.splice(_,0,S)}),u=u.map(b=>{const w=b.key;return f.has(w)?b:p.createElement(DP,{key:Xh(b),isPresent:!0,presenceAffectsLayout:i,mode:s},b)}),p.createElement(p.Fragment,null,f.size?u:u.map(b=>p.cloneElement(b)))};function p$(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function $S(...e){return t=>{let r=!1;const n=e.map(a=>{const i=p$(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():p$(e[a],null)}}}}function Ia(...e){return p.useCallback($S(...e),e)}function fh(e){const t=Bpe(e),r=p.forwardRef((n,a)=>{const{children:i,...s}=n,l=p.Children.toArray(i),c=l.find(zpe);if(c){const d=c.props.children,u=l.map(f=>f===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:f);return o.jsx(t,{...s,ref:a,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return o.jsx(t,{...s,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var Fpe=fh("Slot");function Bpe(e){const t=p.forwardRef((r,n)=>{const{children:a,...i}=r;if(p.isValidElement(a)){const s=Vpe(a),l=Upe(i,a.props);return a.type!==p.Fragment&&(l.ref=n?$S(n,s):s),p.cloneElement(a,l)}return p.Children.count(a)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var VG=Symbol("radix.slottable");function qpe(e){const t=({children:r})=>o.jsx(o.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=VG,t}function zpe(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===VG}function Upe(e,t){const r={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{const c=i(...l);return a(...l),c}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function Vpe(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const g$=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,v$=ta,hI=(e,t)=>r=>{var n;if(t?.variants==null)return v$(e,r?.class,r?.className);const{variants:a,defaultVariants:i}=t,s=Object.keys(a).map(d=>{const u=r?.[d],f=i?.[d];if(u===null)return null;const m=g$(u)||g$(f);return a[d][m]}),l=r&&Object.entries(r).reduce((d,u)=>{let[f,m]=u;return m===void 0||(d[f]=m),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let{class:f,className:m,...h}=u;return Object.entries(h).every(v=>{let[g,x]=v;return Array.isArray(x)?x.includes({...i,...l}[g]):{...i,...l}[g]===x})?[...d,f,m]:d},[]);return v$(e,s,c,r?.class,r?.className)},kb=hI("inline-flex items-center justify-center rounded-sm text-sm font-bold tracking-wide transition-all duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background active:scale-[0.98] disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-brand text-primary-foreground hover:bg-brand/90 shadow-lg shadow-brand/15",destructive:"bg-danger text-white hover:bg-danger/90 shadow-lg shadow-danger/15",outline:"border border-border bg-transparent hover:bg-accent hover:text-accent-foreground",secondary:"bg-surface-2 text-secondary-foreground hover:bg-surface-2/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-brand underline-offset-4 hover:underline",success:"bg-success text-white hover:bg-success/90 shadow-lg shadow-success/15"},size:{default:"h-10 px-5 py-2 gap-2",sm:"h-9 rounded-sm px-3 gap-1.5",lg:"h-12 rounded-md px-8 gap-2.5 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),le=xe.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},i)=>{const s=n?Fpe:"button";return o.jsx(s,{className:Jt(kb({variant:t,size:r,className:e})),ref:i,...a})});le.displayName="Button";const u2=[{to:"/",icon:lue,label:"Painel Principal"},{to:"/agenda",icon:gi,label:"Agenda"},{to:"/vendas",icon:U1,label:"Loja"},{to:"/financeiro",icon:wH,label:"Financeiro"}],yj={hidden:{opacity:0,x:-20},visible:e=>({opacity:1,x:0,transition:{delay:e*.05+.3,duration:.3,ease:"easeOut"}})},Wpe=({to:e,icon:t,label:r,index:n,onNavigate:a})=>{const i="flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand w-full",s="flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent w-full";return o.jsx(fr.li,{custom:n,variants:yj,initial:"hidden",animate:"visible",whileHover:{x:4},transition:{type:"spring",stiffness:300,damping:15},children:o.jsxs(pu,{to:e,onClick:a,className:({isActive:l})=>e==="/isis"&&l?"flex items-center h-[52px] px-4 rounded-sm font-bold text-white shadow-lg shadow-emerald-500/10 border-l-4 border-transparent bg-gradient-to-r from-fuchsia-600 via-violet-600 to-emerald-600 ring-1 ring-white/10":l?i:s,children:[e==="/isis"?o.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:o.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:o.jsx(ud,{size:"sm"})})}):o.jsx(t,{className:"h-5 w-5 mr-4 flex-shrink-0"}),o.jsx("span",{className:"text-base flex items-center gap-2",children:r})]})})};function Hpe({onNavigate:e,isVisible:t,setIsVisible:r,sidebarPinned:n}){const a=ki(),i=["/produtos","/compras","/clientes","/equipe","/quadras","/empresas","/finalizadoras"],s=p.useMemo(()=>i.includes(a.pathname),[a.pathname]),[l,c]=p.useState(s),d=p.useRef(null);p.useRef(null);const u=p.useRef(0),f=p.useRef(0),m=()=>{window.innerWidth<768&&r(!1)};return p.useEffect(()=>{const h=x=>{window.innerWidth>=768||(u.current=x.touches[0].clientX,f.current=x.touches[0].clientY)},v=x=>{if(window.innerWidth>=768)return;const y=x.touches[0].clientX,b=x.touches[0].clientY,w=y-u.current,j=Math.abs(b-f.current);u.current<50&&w>50&&j<50&&r(!0)},g=()=>{u.current=0,f.current=0};return window.addEventListener("touchstart",h,{passive:!0}),window.addEventListener("touchmove",v,{passive:!0}),window.addEventListener("touchend",g,{passive:!0}),()=>{window.removeEventListener("touchstart",h),window.removeEventListener("touchmove",v),window.removeEventListener("touchend",g)}},[t]),o.jsx(o.Fragment,{children:o.jsxs(fr.aside,{ref:d,initial:!1,animate:{width:n||t?280:0},className:`h-screen bg-surface flex flex-col border-r border-border shadow-xl shadow-black/20 overflow-hidden\r
                   fixed inset-y-0 left-0 z-40 md:static md:flex-shrink-0`,children:[o.jsxs(fr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"flex items-center px-6 pt-8 pb-6 h-[120px] flex-shrink-0",children:[o.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center mr-4",children:o.jsx(nd,{className:"w-8 h-8 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),o.jsx("nav",{className:"flex-1 overflow-y-auto px-6 py-2 scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent hover:scrollbar-thumb-border-hover",children:o.jsxs("ul",{className:"space-y-3",children:[u2.map((h,v)=>o.jsx(Wpe,{...h,index:v,onNavigate:m},h.to)),o.jsxs(fr.li,{custom:u2.length,variants:yj,initial:"hidden",animate:"visible",children:[o.jsxs("button",{type:"button",onClick:()=>c(h=>!h),className:`w-full flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 ${s?"bg-brand text-primary-foreground font-bold border-brand":"border-transparent"}`,children:[o.jsx(eue,{className:"h-5 w-5 mr-4 flex-shrink-0"}),o.jsx("span",{className:"text-base flex-1 text-left",children:"Cadastros"}),o.jsx(z1,{className:`h-4 w-4 transition-transform ${l?"rotate-180":""}`})]}),l&&o.jsxs("ul",{className:"mt-2 ml-8 space-y-2",children:[o.jsx("li",{children:o.jsxs(pu,{to:"/clientes",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(cl,{className:"h-4 w-4 mr-3"})," Clientes & Fornecedores"]})}),o.jsx("li",{children:o.jsxs(pu,{to:"/finalizadoras",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(km,{className:"h-4 w-4 mr-3"})," Finalizadoras"]})}),o.jsx("li",{children:o.jsxs(pu,{to:"/produtos",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(gd,{className:"h-4 w-4 mr-3"})," Produtos"]})}),o.jsx("li",{children:o.jsxs(pu,{to:"/compras",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(Mv,{className:"h-4 w-4 mr-3"})," Compras"]})}),o.jsx("li",{children:o.jsxs(pu,{to:"/equipe",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(bue,{className:"h-4 w-4 mr-3"})," Equipe"]})}),o.jsx("li",{children:o.jsxs(pu,{to:"/quadras",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(sue,{className:"h-4 w-4 mr-3"})," Quadras"]})}),o.jsx("li",{children:o.jsxs(pu,{to:"/empresas",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(fN,{className:"h-4 w-4 mr-3"})," Empresa"]})})]})]}),o.jsx(fr.li,{custom:u2.length+1,variants:yj,initial:"hidden",animate:"visible",className:"pt-4 border-t border-border/50 mt-4",children:o.jsxs(pu,{to:"/suporte",onClick:m,className:({isActive:h})=>h?"flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand":"flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent",children:[o.jsx(pH,{className:"h-5 w-5 mr-4 flex-shrink-0"}),o.jsx("span",{className:"text-base",children:"Suporte"})]})}),o.jsx(fr.li,{custom:u2.length+2,variants:yj,initial:"hidden",animate:"visible",children:o.jsxs(pu,{to:"/isis",onClick:m,className:({isActive:h})=>h?"flex items-center h-[56px] px-4 rounded-sm font-extrabold text-text-primary bg-surface-2/80 border border-white/20 shadow-[inset_0_0_0_1px_rgba(255,255,255,0.06)]":"flex items-center h-[56px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border border-white/15",children:[o.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:o.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:o.jsx(ud,{size:"sm"})})}),o.jsx("span",{className:"text-lg font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300",children:"sis"})]})})]})})]})})}function Qr(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e?.(a),r===!1||!a.defaultPrevented)return t?.(a)}}function Gpe(e,t){const r=p.createContext(t),n=i=>{const{children:s,...l}=i,c=p.useMemo(()=>l,Object.values(l));return o.jsx(r.Provider,{value:c,children:s})};n.displayName=e+"Provider";function a(i){const s=p.useContext(r);if(s)return s;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[n,a]}function bd(e,t=[]){let r=[];function n(i,s){const l=p.createContext(s),c=r.length;r=[...r,s];const d=f=>{const{scope:m,children:h,...v}=f,g=m?.[e]?.[c]||l,x=p.useMemo(()=>v,Object.values(v));return o.jsx(g.Provider,{value:x,children:h})};d.displayName=i+"Provider";function u(f,m){const h=m?.[e]?.[c]||l,v=p.useContext(h);if(v)return v;if(s!==void 0)return s;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(s=>p.createContext(s));return function(l){const c=l?.[e]||i;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return a.scopeName=e,[n,Kpe(a,...t)]}function Kpe(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const s=n.reduce((l,{useScope:c,scopeName:d})=>{const f=c(i)[`__scope${d}`];return{...l,...f}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}var Ss=globalThis?.document?p.useLayoutEffect:()=>{},Ype=V4[" useId ".trim().toString()]||(()=>{}),Xpe=0;function Yd(e){const[t,r]=p.useState(Ype());return Ss(()=>{e||r(n=>n??String(Xpe++))},[e]),e||(t?`radix-${t}`:"")}var Jpe=V4[" useInsertionEffect ".trim().toString()]||Ss;function Df({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,i,s]=Qpe({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:a;{const u=p.useRef(e!==void 0);p.useEffect(()=>{const f=u.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,n])}const d=p.useCallback(u=>{if(l){const f=Zpe(u)?u(e):u;f!==e&&s.current?.(f)}else i(u)},[l,e,i,s]);return[c,d]}function Qpe({defaultProp:e,onChange:t}){const[r,n]=p.useState(e),a=p.useRef(r),i=p.useRef(t);return Jpe(()=>{i.current=t},[t]),p.useEffect(()=>{a.current!==r&&(i.current?.(r),a.current=r)},[r,a]),[r,n,i]}function Zpe(e){return typeof e=="function"}var ege=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Hn=ege.reduce((e,t)=>{const r=fh(`Primitive.${t}`),n=p.forwardRef((a,i)=>{const{asChild:s,...l}=a,c=s?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(c,{...l,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function pI(e,t){e&&zf.flushSync(()=>e.dispatchEvent(t))}function $l(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...r)=>t.current?.(...r),[])}function tge(e,t=globalThis?.document){const r=$l(e);p.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var rge="DismissableLayer",Yk="dismissableLayer.update",nge="dismissableLayer.pointerDownOutside",age="dismissableLayer.focusOutside",x$,WG=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Zx=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:s,onDismiss:l,...c}=e,d=p.useContext(WG),[u,f]=p.useState(null),m=u?.ownerDocument??globalThis?.document,[,h]=p.useState({}),v=Ia(t,k=>f(k)),g=Array.from(d.layers),[x]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(x),b=u?g.indexOf(u):-1,w=d.layersWithOutsidePointerEventsDisabled.size>0,j=b>=y,_=ige(k=>{const E=k.target,A=[...d.branches].some(M=>M.contains(E));!j||A||(a?.(k),s?.(k),k.defaultPrevented||l?.())},m),S=sge(k=>{const E=k.target;[...d.branches].some(M=>M.contains(E))||(i?.(k),s?.(k),k.defaultPrevented||l?.())},m);return tge(k=>{b===d.layers.size-1&&(n?.(k),!k.defaultPrevented&&l&&(k.preventDefault(),l()))},m),p.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(x$=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),y$(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=x$)}},[u,m,r,d]),p.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),y$())},[u,d]),p.useEffect(()=>{const k=()=>h({});return document.addEventListener(Yk,k),()=>document.removeEventListener(Yk,k)},[]),o.jsx(Hn.div,{...c,ref:v,style:{pointerEvents:w?j?"auto":"none":void 0,...e.style},onFocusCapture:Qr(e.onFocusCapture,S.onFocusCapture),onBlurCapture:Qr(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:Qr(e.onPointerDownCapture,_.onPointerDownCapture)})});Zx.displayName=rge;var oge="DismissableLayerBranch",HG=p.forwardRef((e,t)=>{const r=p.useContext(WG),n=p.useRef(null),a=Ia(t,n);return p.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),o.jsx(Hn.div,{...e,ref:a})});HG.displayName=oge;function ige(e,t=globalThis?.document){const r=$l(e),n=p.useRef(!1),a=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){GG(nge,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function sge(e,t=globalThis?.document){const r=$l(e),n=p.useRef(!1);return p.useEffect(()=>{const a=i=>{i.target&&!n.current&&GG(age,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function y$(){const e=new CustomEvent(Yk);document.dispatchEvent(e)}function GG(e,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?pI(a,i):a.dispatchEvent(i)}var lge=Zx,cge=HG,MP="focusScope.autoFocusOnMount",RP="focusScope.autoFocusOnUnmount",b$={bubbles:!1,cancelable:!0},dge="FocusScope",K1=p.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...s}=e,[l,c]=p.useState(null),d=$l(a),u=$l(i),f=p.useRef(null),m=Ia(t,g=>c(g)),h=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(n){let g=function(w){if(h.paused||!l)return;const j=w.target;l.contains(j)?f.current=j:mm(f.current,{select:!0})},x=function(w){if(h.paused||!l)return;const j=w.relatedTarget;j!==null&&(l.contains(j)||mm(f.current,{select:!0}))},y=function(w){if(document.activeElement===document.body)for(const _ of w)_.removedNodes.length>0&&mm(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",x);const b=new MutationObserver(y);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",x),b.disconnect()}}},[n,l,h.paused]),p.useEffect(()=>{if(l){j$.add(h);const g=document.activeElement;if(!l.contains(g)){const y=new CustomEvent(MP,b$);l.addEventListener(MP,d),l.dispatchEvent(y),y.defaultPrevented||(uge(gge(KG(l)),{select:!0}),document.activeElement===g&&mm(l))}return()=>{l.removeEventListener(MP,d),setTimeout(()=>{const y=new CustomEvent(RP,b$);l.addEventListener(RP,u),l.dispatchEvent(y),y.defaultPrevented||mm(g??document.body,{select:!0}),l.removeEventListener(RP,u),j$.remove(h)},0)}}},[l,d,u,h]);const v=p.useCallback(g=>{if(!r&&!n||h.paused)return;const x=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(x&&y){const b=g.currentTarget,[w,j]=fge(b);w&&j?!g.shiftKey&&y===j?(g.preventDefault(),r&&mm(w,{select:!0})):g.shiftKey&&y===w&&(g.preventDefault(),r&&mm(j,{select:!0})):y===b&&g.preventDefault()}},[r,n,h.paused]);return o.jsx(Hn.div,{tabIndex:-1,...s,ref:m,onKeyDown:v})});K1.displayName=dge;function uge(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(mm(n,{select:t}),document.activeElement!==r)return}function fge(e){const t=KG(e),r=w$(t,e),n=w$(t.reverse(),e);return[r,n]}function KG(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function w$(e,t){for(const r of e)if(!mge(r,{upTo:t}))return r}function mge(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function hge(e){return e instanceof HTMLInputElement&&"select"in e}function mm(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&hge(e)&&t&&e.select()}}var j$=pge();function pge(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=N$(e,t),e.unshift(t)},remove(t){e=N$(e,t),e[0]?.resume()}}}function N$(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function gge(e){return e.filter(t=>t.tagName!=="A")}var vge="Portal",e0=p.forwardRef((e,t)=>{const{container:r,...n}=e,[a,i]=p.useState(!1);Ss(()=>i(!0),[]);const s=r||a&&globalThis?.document?.body;return s?GW.createPortal(o.jsx(Hn.div,{...n,ref:t}),s):null});e0.displayName=vge;function xge(e,t){return p.useReducer((r,n)=>t[r][n]??r,e)}var Ac=e=>{const{present:t,children:r}=e,n=yge(t),a=typeof r=="function"?r({present:n.isPresent}):p.Children.only(r),i=Ia(n.ref,bge(a));return typeof r=="function"||n.isPresent?p.cloneElement(a,{ref:i}):null};Ac.displayName="Presence";function yge(e){const[t,r]=p.useState(),n=p.useRef(null),a=p.useRef(e),i=p.useRef("none"),s=e?"mounted":"unmounted",[l,c]=xge(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const d=f2(n.current);i.current=l==="mounted"?d:"none"},[l]),Ss(()=>{const d=n.current,u=a.current;if(u!==e){const m=i.current,h=f2(d);e?c("MOUNT"):h==="none"||d?.display==="none"?c("UNMOUNT"):c(u&&m!==h?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),Ss(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,f=h=>{const g=f2(n.current).includes(CSS.escape(h.animationName));if(h.target===t&&g&&(c("ANIMATION_END"),!a.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},m=h=>{h.target===t&&(i.current=f2(n.current))};return t.addEventListener("animationstart",m),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",m),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function f2(e){return e?.animationName||"none"}function bge(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var LP=0;function FS(){p.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??_$()),document.body.insertAdjacentElement("beforeend",e[1]??_$()),LP++,()=>{LP===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),LP--}},[])}function _$(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var bu=function(){return bu=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},bu.apply(this,arguments)};function YG(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function wge(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var bj="right-scroll-bar-position",wj="width-before-scroll-bar",jge="with-scroll-bars-hidden",Nge="--removed-body-scroll-bar-size";function $P(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function _ge(e,t){var r=p.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var Sge=typeof window<"u"?p.useLayoutEffect:p.useEffect,S$=new WeakMap;function Cge(e,t){var r=_ge(t||null,function(n){return e.forEach(function(a){return $P(a,n)})});return Sge(function(){var n=S$.get(r);if(n){var a=new Set(n),i=new Set(e),s=r.current;a.forEach(function(l){i.has(l)||$P(l,null)}),i.forEach(function(l){a.has(l)||$P(l,s)})}S$.set(r,e)},[e]),r}function Pge(e){return e}function Age(e,t){t===void 0&&(t=Pge);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var s=t(i,n);return r.push(s),function(){r=r.filter(function(l){return l!==s})}},assignSyncMedium:function(i){for(n=!0;r.length;){var s=r;r=[],s.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var s=[];if(r.length){var l=r;r=[],l.forEach(i),s=r}var c=function(){var u=s;s=[],u.forEach(i)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(u){s.push(u),d()},filter:function(u){return s=s.filter(u),r}}}};return a}function Ege(e){e===void 0&&(e={});var t=Age(null);return t.options=bu({async:!0,ssr:!1},e),t}var XG=function(e){var t=e.sideCar,r=YG(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return p.createElement(n,bu({},r))};XG.isSideCarExport=!0;function kge(e,t){return e.useMedium(t),XG}var JG=Ege(),FP=function(){},BS=p.forwardRef(function(e,t){var r=p.useRef(null),n=p.useState({onScrollCapture:FP,onWheelCapture:FP,onTouchMoveCapture:FP}),a=n[0],i=n[1],s=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,u=e.enabled,f=e.shards,m=e.sideCar,h=e.noRelative,v=e.noIsolation,g=e.inert,x=e.allowPinchZoom,y=e.as,b=y===void 0?"div":y,w=e.gapMode,j=YG(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=m,S=Cge([r,t]),k=bu(bu({},j),a);return p.createElement(p.Fragment,null,u&&p.createElement(_,{sideCar:JG,removeScrollBar:d,shards:f,noRelative:h,noIsolation:v,inert:g,setCallbacks:i,allowPinchZoom:!!x,lockRef:r,gapMode:w}),s?p.cloneElement(p.Children.only(l),bu(bu({},k),{ref:S})):p.createElement(b,bu({},k,{className:c,ref:S}),l))});BS.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};BS.classNames={fullWidth:wj,zeroRight:bj};var C$,Oge=function(){if(C$)return C$;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Tge(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Oge();return t&&e.setAttribute("nonce",t),e}function Ige(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Dge(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Mge=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Tge())&&(Ige(t,r),Dge(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Rge=function(){var e=Mge();return function(t,r){p.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},QG=function(){var e=Rge(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},Lge={left:0,top:0,right:0,gap:0},BP=function(e){return parseInt(e||"",10)||0},$ge=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[BP(r),BP(n),BP(a)]},Fge=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Lge;var t=$ge(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Bge=QG(),Rv="data-scroll-locked",qge=function(e,t,r,n){var a=e.left,i=e.top,s=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(jge,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Rv,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(bj,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(wj,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(bj," .").concat(bj,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(wj," .").concat(wj,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Rv,`] {
    `).concat(Nge,": ").concat(l,`px;
  }
`)},P$=function(){var e=parseInt(document.body.getAttribute(Rv)||"0",10);return isFinite(e)?e:0},zge=function(){p.useEffect(function(){return document.body.setAttribute(Rv,(P$()+1).toString()),function(){var e=P$()-1;e<=0?document.body.removeAttribute(Rv):document.body.setAttribute(Rv,e.toString())}},[])},Uge=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;zge();var i=p.useMemo(function(){return Fge(a)},[a]);return p.createElement(Bge,{styles:qge(i,!t,a,r?"":"!important")})},Xk=!1;if(typeof window<"u")try{var m2=Object.defineProperty({},"passive",{get:function(){return Xk=!0,!0}});window.addEventListener("test",m2,m2),window.removeEventListener("test",m2,m2)}catch{Xk=!1}var Eg=Xk?{passive:!1}:!1,Vge=function(e){return e.tagName==="TEXTAREA"},ZG=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Vge(e)&&r[t]==="visible")},Wge=function(e){return ZG(e,"overflowY")},Hge=function(e){return ZG(e,"overflowX")},A$=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=eK(e,n);if(a){var i=tK(e,n),s=i[1],l=i[2];if(s>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Gge=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Kge=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},eK=function(e,t){return e==="v"?Wge(t):Hge(t)},tK=function(e,t){return e==="v"?Gge(t):Kge(t)},Yge=function(e,t){return e==="h"&&t==="rtl"?-1:1},Xge=function(e,t,r,n,a){var i=Yge(e,window.getComputedStyle(t).direction),s=i*n,l=r.target,c=t.contains(l),d=!1,u=s>0,f=0,m=0;do{if(!l)break;var h=tK(e,l),v=h[0],g=h[1],x=h[2],y=g-x-i*v;(v||y)&&eK(e,l)&&(f+=y,m+=v);var b=l.parentNode;l=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&(a&&Math.abs(f)<1||!a&&s>f)||!u&&(a&&Math.abs(m)<1||!a&&-s>m))&&(d=!0),d},h2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},E$=function(e){return[e.deltaX,e.deltaY]},k$=function(e){return e&&"current"in e?e.current:e},Jge=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Qge=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Zge=0,kg=[];function eve(e){var t=p.useRef([]),r=p.useRef([0,0]),n=p.useRef(),a=p.useState(Zge++)[0],i=p.useState(QG)[0],s=p.useRef(e);p.useEffect(function(){s.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var g=wge([e.lockRef.current],(e.shards||[]).map(k$),!0).filter(Boolean);return g.forEach(function(x){return x.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),g.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(g,x){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!s.current.allowPinchZoom;var y=h2(g),b=r.current,w="deltaX"in g?g.deltaX:b[0]-y[0],j="deltaY"in g?g.deltaY:b[1]-y[1],_,S=g.target,k=Math.abs(w)>Math.abs(j)?"h":"v";if("touches"in g&&k==="h"&&S.type==="range")return!1;var E=A$(k,S);if(!E)return!0;if(E?_=k:(_=k==="v"?"h":"v",E=A$(k,S)),!E)return!1;if(!n.current&&"changedTouches"in g&&(w||j)&&(n.current=_),!_)return!0;var A=n.current||_;return Xge(A,x,g,A==="h"?w:j,!0)},[]),c=p.useCallback(function(g){var x=g;if(!(!kg.length||kg[kg.length-1]!==i)){var y="deltaY"in x?E$(x):h2(x),b=t.current.filter(function(_){return _.name===x.type&&(_.target===x.target||x.target===_.shadowParent)&&Jge(_.delta,y)})[0];if(b&&b.should){x.cancelable&&x.preventDefault();return}if(!b){var w=(s.current.shards||[]).map(k$).filter(Boolean).filter(function(_){return _.contains(x.target)}),j=w.length>0?l(x,w[0]):!s.current.noIsolation;j&&x.cancelable&&x.preventDefault()}}},[]),d=p.useCallback(function(g,x,y,b){var w={name:g,delta:x,target:y,should:b,shadowParent:tve(y)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(j){return j!==w})},1)},[]),u=p.useCallback(function(g){r.current=h2(g),n.current=void 0},[]),f=p.useCallback(function(g){d(g.type,E$(g),g.target,l(g,e.lockRef.current))},[]),m=p.useCallback(function(g){d(g.type,h2(g),g.target,l(g,e.lockRef.current))},[]);p.useEffect(function(){return kg.push(i),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:m}),document.addEventListener("wheel",c,Eg),document.addEventListener("touchmove",c,Eg),document.addEventListener("touchstart",u,Eg),function(){kg=kg.filter(function(g){return g!==i}),document.removeEventListener("wheel",c,Eg),document.removeEventListener("touchmove",c,Eg),document.removeEventListener("touchstart",u,Eg)}},[]);var h=e.removeScrollBar,v=e.inert;return p.createElement(p.Fragment,null,v?p.createElement(i,{styles:Qge(a)}):null,h?p.createElement(Uge,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function tve(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const rve=kge(JG,eve);var rK=p.forwardRef(function(e,t){return p.createElement(BS,bu({},e,{ref:t,sideCar:rve}))});rK.classNames=BS.classNames;const qS=rK;var nve=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Og=new WeakMap,p2=new WeakMap,g2={},qP=0,nK=function(e){return e&&(e.host||nK(e.parentNode))},ave=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=nK(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},ove=function(e,t,r,n){var a=ave(t,Array.isArray(e)?e:[e]);g2[r]||(g2[r]=new WeakMap);var i=g2[r],s=[],l=new Set,c=new Set(a),d=function(f){!f||l.has(f)||(l.add(f),d(f.parentNode))};a.forEach(d);var u=function(f){!f||c.has(f)||Array.prototype.forEach.call(f.children,function(m){if(l.has(m))u(m);else try{var h=m.getAttribute(n),v=h!==null&&h!=="false",g=(Og.get(m)||0)+1,x=(i.get(m)||0)+1;Og.set(m,g),i.set(m,x),s.push(m),g===1&&v&&p2.set(m,!0),x===1&&m.setAttribute(r,"true"),v||m.setAttribute(n,"true")}catch(y){console.error("aria-hidden: cannot operate on ",m,y)}})};return u(t),l.clear(),qP++,function(){s.forEach(function(f){var m=Og.get(f)-1,h=i.get(f)-1;Og.set(f,m),i.set(f,h),m||(p2.has(f)||f.removeAttribute(n),p2.delete(f)),h||f.removeAttribute(r)}),qP--,qP||(Og=new WeakMap,Og=new WeakMap,p2=new WeakMap,g2={})}},zS=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=t||nve(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),ove(n,a,r,"aria-hidden")):function(){return null}},US="Dialog",[aK,oK]=bd(US),[ive,au]=aK(US),iK=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:s=!0}=e,l=p.useRef(null),c=p.useRef(null),[d,u]=Df({prop:n,defaultProp:a??!1,onChange:i,caller:US});return o.jsx(ive,{scope:t,triggerRef:l,contentRef:c,contentId:Yd(),titleId:Yd(),descriptionId:Yd(),open:d,onOpenChange:u,onOpenToggle:p.useCallback(()=>u(f=>!f),[u]),modal:s,children:r})};iK.displayName=US;var sK="DialogTrigger",lK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=au(sK,r),i=Ia(t,a.triggerRef);return o.jsx(Hn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":xI(a.open),...n,ref:i,onClick:Qr(e.onClick,a.onOpenToggle)})});lK.displayName=sK;var gI="DialogPortal",[sve,cK]=aK(gI,{forceMount:void 0}),dK=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,i=au(gI,t);return o.jsx(sve,{scope:t,forceMount:r,children:p.Children.map(n,s=>o.jsx(Ac,{present:r||i.open,children:o.jsx(e0,{asChild:!0,container:a,children:s})}))})};dK.displayName=gI;var wN="DialogOverlay",uK=p.forwardRef((e,t)=>{const r=cK(wN,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,i=au(wN,e.__scopeDialog);return i.modal?o.jsx(Ac,{present:n||i.open,children:o.jsx(cve,{...a,ref:t})}):null});uK.displayName=wN;var lve=fh("DialogOverlay.RemoveScroll"),cve=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=au(wN,r);return o.jsx(qS,{as:lve,allowPinchZoom:!0,shards:[a.contentRef],children:o.jsx(Hn.div,{"data-state":xI(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Hp="DialogContent",fK=p.forwardRef((e,t)=>{const r=cK(Hp,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,i=au(Hp,e.__scopeDialog);return o.jsx(Ac,{present:n||i.open,children:i.modal?o.jsx(dve,{...a,ref:t}):o.jsx(uve,{...a,ref:t})})});fK.displayName=Hp;var dve=p.forwardRef((e,t)=>{const r=au(Hp,e.__scopeDialog),n=p.useRef(null),a=Ia(t,r.contentRef,n);return p.useEffect(()=>{const i=n.current;if(i)return zS(i)},[]),o.jsx(mK,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Qr(e.onCloseAutoFocus,i=>{i.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Qr(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,l=s.button===0&&s.ctrlKey===!0;(s.button===2||l)&&i.preventDefault()}),onFocusOutside:Qr(e.onFocusOutside,i=>i.preventDefault())})}),uve=p.forwardRef((e,t)=>{const r=au(Hp,e.__scopeDialog),n=p.useRef(!1),a=p.useRef(!1);return o.jsx(mK,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{e.onCloseAutoFocus?.(i),i.defaultPrevented||(n.current||r.triggerRef.current?.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{e.onInteractOutside?.(i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=i.target;r.triggerRef.current?.contains(s)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),mK=p.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,...s}=e,l=au(Hp,r),c=p.useRef(null),d=Ia(t,c);return FS(),o.jsxs(o.Fragment,{children:[o.jsx(K1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:o.jsx(Zx,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":xI(l.open),...s,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),o.jsxs(o.Fragment,{children:[o.jsx(mve,{titleId:l.titleId}),o.jsx(pve,{contentRef:c,descriptionId:l.descriptionId})]})]})}),vI="DialogTitle",hK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=au(vI,r);return o.jsx(Hn.h2,{id:a.titleId,...n,ref:t})});hK.displayName=vI;var pK="DialogDescription",gK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=au(pK,r);return o.jsx(Hn.p,{id:a.descriptionId,...n,ref:t})});gK.displayName=pK;var vK="DialogClose",xK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=au(vK,r);return o.jsx(Hn.button,{type:"button",...n,ref:t,onClick:Qr(e.onClick,()=>a.onOpenChange(!1))})});xK.displayName=vK;function xI(e){return e?"open":"closed"}var yK="DialogTitleWarning",[fve,bK]=Gpe(yK,{contentName:Hp,titleName:vI,docsSlug:"dialog"}),mve=({titleId:e})=>{const t=bK(yK),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return p.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},hve="DialogDescriptionWarning",pve=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${bK(hve).contentName}}.`;return p.useEffect(()=>{const a=e.current?.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},wK=iK,gve=lK,jK=dK,yI=uK,bI=fK,wI=hK,jI=gK,VS=xK;const ln=wK,vve=jK,Xm=VS,NK=xe.forwardRef(({className:e,disableAnimations:t,...r},n)=>{const a=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),i=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,s=(t??!1)||a||i;return o.jsx(yI,{ref:n,className:Jt("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",s?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r})});NK.displayName=yI.displayName;const sn=xe.forwardRef(({className:e,children:t,overlayClassName:r,disableAnimations:n,alignTop:a,...i},s)=>{const l=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),c=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,d=(n??!1)||l||c;return o.jsxs(vve,{children:[o.jsx(NK,{disableAnimations:d,className:r}),o.jsxs(bI,{ref:s,className:Jt("fixed z-50 grid w-full max-w-lg gap-4 border border-border bg-surface p-6 shadow-lg duration-200 sm:rounded-lg",a?"left-1/2 top-[10%] -translate-x-1/2":"left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",d?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...i,children:[t,o.jsxs(VS,{className:"absolute right-3 top-3 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground p-1",children:[o.jsx(Dl,{className:"h-5 w-5"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]})});sn.displayName=bI.displayName;const an=({className:e,...t})=>o.jsx("div",{className:Jt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});an.displayName="DialogHeader";const Un=({className:e,...t})=>o.jsx("div",{className:Jt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Un.displayName="DialogFooter";const nn=xe.forwardRef(({className:e,...t},r)=>o.jsx(wI,{ref:r,className:Jt("text-lg font-semibold leading-none tracking-tight",e),...t}));nn.displayName=wI.displayName;const _n=xe.forwardRef(({className:e,...t},r)=>o.jsx(jI,{ref:r,className:Jt("text-sm text-text-secondary",e),...t}));_n.displayName=jI.displayName;const xve=1;let zP=0;function yve(){return zP=(zP+1)%Number.MAX_VALUE,zP.toString()}const al={state:{toasts:[]},listeners:[],getState:()=>al.state,setState:e=>{typeof e=="function"?al.state=e(al.state):al.state={...al.state,...e},al.listeners.forEach(t=>t(al.state))},subscribe:e=>(al.listeners.push(e),()=>{al.listeners=al.listeners.filter(t=>t!==e)})},jj=({...e})=>{const t=yve(),r=a=>al.setState(i=>({...i,toasts:i.toasts.map(s=>s.id===t?{...s,...a}:s)})),n=()=>al.setState(a=>({...a,toasts:a.toasts.filter(i=>i.id!==t)}));return al.setState(a=>({...a,toasts:[{...e,id:t,dismiss:n},...a.toasts].slice(0,xve)})),{id:t,dismiss:n,update:r}};function ro(){const[e,t]=p.useState(al.getState());return p.useEffect(()=>al.subscribe(n=>{t(n)}),[]),p.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const a=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(a)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:jj,toasts:e.toasts}}const bve="main",wve={dev:{supabaseUrl:"https://xlbgopcindcsteymtwjp.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhsYmdvcGNpbmRjc3RleW10d2pwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3MDAwMTQsImV4cCI6MjA4MDI3NjAxNH0.0ydvsFW8j5ZKCyHalAlFWHjjK8QbcDC6mZQzVJ0lSnA"},main:{supabaseUrl:"https://dlfryxtyxqoacuunswuc.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY"}},jve=Object.freeze(Object.defineProperty({__proto__:null,ACTIVE_TARGET:bve,TARGETS:wve},Symbol.toStringTag,{value:"Module"})),Nve=void 0,_ve=void 0,Sve=Object.freeze(Object.defineProperty({__proto__:null,ACTIVE_TARGET:Nve,TARGETS:_ve},Symbol.toStringTag,{value:"Module"})),Cve="modulepreload",Pve=function(e){return"/"+e},O$={},Iu=function(t,r,n){if(!r||r.length===0)return t();const a=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=Pve(i),i in O$)return;O$[i]=!0;const s=i.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(!!n)for(let u=a.length-1;u>=0;u--){const f=a[u];if(f.href===i&&(!s||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const d=document.createElement("link");if(d.rel=s?"stylesheet":Cve,s||(d.as="script",d.crossOrigin=""),d.href=i,document.head.appendChild(d),s)return new Promise((u,f)=>{d.addEventListener("load",u),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i})},Ave=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Iu(()=>Promise.resolve().then(()=>t0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class NI extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class T$ extends NI{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class I$ extends NI{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class D$ extends NI{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Jk;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Jk||(Jk={}));var Eve=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class kve{constructor(t,{headers:r={},customFetch:n,region:a=Jk.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Ave(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Eve(this,arguments,void 0,function*(r,n={}){var a;try{const{headers:i,method:s,body:l,signal:c}=n;let d={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let m;l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",m=l):typeof l=="string"?(d["Content-Type"]="text/plain",m=l):typeof FormData<"u"&&l instanceof FormData?m=l:(d["Content-Type"]="application/json",m=JSON.stringify(l)));const h=yield this.fetch(f.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),i),body:m,signal:c}).catch(y=>{throw y.name==="AbortError"?y:new T$(y)}),v=h.headers.get("x-relay-error");if(v&&v==="true")throw new I$(h);if(!h.ok)throw new D$(h);let g=((a=h.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),x;return g==="application/json"?x=yield h.json():g==="application/octet-stream"?x=yield h.blob():g==="text/event-stream"?x=h:g==="multipart/form-data"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new T$(i)}:{data:null,error:i,response:i instanceof D$||i instanceof I$?i.context:void 0}}})}}var Pl={},_I={},WS={},Y1={},HS={},GS={},Ove=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ux=Ove();const Tve=ux.fetch,_K=ux.fetch.bind(ux),SK=ux.Headers,Ive=ux.Request,Dve=ux.Response,t0=Object.freeze(Object.defineProperty({__proto__:null,Headers:SK,Request:Ive,Response:Dve,default:_K,fetch:Tve},Symbol.toStringTag,{value:"Module"})),Mve=Fie(t0);var KS={};Object.defineProperty(KS,"__esModule",{value:!0});let Rve=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};KS.default=Rve;var CK=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(GS,"__esModule",{value:!0});const Lve=CK(Mve),$ve=CK(KS);let Fve=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Lve.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var s,l,c,d;let u=null,f=null,m=null,h=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const b=await i.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((s=this.headers.get("Accept"))===null||s===void 0)&&s.includes("application/vnd.pgrst.plan+text"))?f=b:f=JSON.parse(b))}const x=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),y=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");x&&y&&y.length>1&&(m=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,h=406,v="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const x=await i.text();try{u=JSON.parse(x),Array.isArray(u)&&i.status===404&&(f=[],u=null,h=200,v="OK")}catch{i.status===404&&x===""?(h=204,v="No Content"):u={message:x}}if(u&&this.isMaybeSingle&&(!((d=u?.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,h=200,v="OK"),u&&this.shouldThrowOnError)throw new $ve.default(u)}return{error:u,data:f,count:m,status:h,statusText:v}});return this.shouldThrowOnError||(a=a.catch(i=>{var s,l,c;return{error:{message:`${(s=i?.name)!==null&&s!==void 0?s:"FetchError"}: ${i?.message}`,details:`${(l=i?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i?.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};GS.default=Fve;var Bve=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(HS,"__esModule",{value:!0});const qve=Bve(GS);let zve=class extends qve.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${d}"; options=${c};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};HS.default=zve;var Uve=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Y1,"__esModule",{value:!0});const Vve=Uve(HS);let Wve=class extends Vve.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Y1.default=Wve;var Hve=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(WS,"__esModule",{value:!0});const U0=Hve(Y1);let Gve=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,r){const{head:n=!1,count:a}=r??{},i=n?"HEAD":"GET";let s=!1;const l=(t??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",l),a&&this.headers.append("Prefer",`count=${a}`),new U0.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const s=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(s.length>0){const l=[...new Set(s)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new U0.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){var s;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new U0.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new U0.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new U0.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};WS.default=Gve;var PK=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_I,"__esModule",{value:!0});const Kve=PK(WS),Yve=PK(Y1);let Xve=class AK{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new Kve.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new AK(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var s;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;n||a?(l=n?"HEAD":"GET",Object.entries(r).filter(([f,m])=>m!==void 0).map(([f,m])=>[f,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([f,m])=>{c.searchParams.append(f,m)})):(l="POST",d=r);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new Yve.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};_I.default=Xve;var r0=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.PostgrestError=Pl.PostgrestBuilder=Pl.PostgrestTransformBuilder=Pl.PostgrestFilterBuilder=Pl.PostgrestQueryBuilder=Pl.PostgrestClient=void 0;const EK=r0(_I);Pl.PostgrestClient=EK.default;const kK=r0(WS);Pl.PostgrestQueryBuilder=kK.default;const OK=r0(Y1);Pl.PostgrestFilterBuilder=OK.default;const TK=r0(HS);Pl.PostgrestTransformBuilder=TK.default;const IK=r0(GS);Pl.PostgrestBuilder=IK.default;const DK=r0(KS);Pl.PostgrestError=DK.default;var Jve=Pl.default={PostgrestClient:EK.default,PostgrestQueryBuilder:kK.default,PostgrestFilterBuilder:OK.default,PostgrestTransformBuilder:TK.default,PostgrestBuilder:IK.default,PostgrestError:DK.default};const{PostgrestClient:Qve,PostgrestQueryBuilder:ult,PostgrestFilterBuilder:flt,PostgrestTransformBuilder:mlt,PostgrestBuilder:hlt,PostgrestError:plt}=Jve;class Zve{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const exe="2.75.0",txe=`realtime-js/${exe}`,rxe="1.0.0",Qk=1e4,nxe=1e3,axe=100;var Ry;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ry||(Ry={}));var Bi;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Bi||(Bi={}));var Ld;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ld||(Ld={}));var Zk;(function(e){e.websocket="websocket"})(Zk||(Zk={}));var op;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(op||(op={}));class oxe{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const l=n.decode(t.slice(s,s+a));s=s+a;const c=n.decode(t.slice(s,s+i));s=s+i;const d=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class MK{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var yo;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(yo||(yo={}));const M$=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,s)=>(i[s]=ixe(s,e,t,a),i),{}):{}},ixe=(e,t,r,n)=>{const a=t.find(l=>l.name===e),i=a?.type,s=r[e];return i&&!n.includes(i)?RK(i,s):eO(s)},RK=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return dxe(t,r)}switch(e){case yo.bool:return sxe(t);case yo.float4:case yo.float8:case yo.int2:case yo.int4:case yo.int8:case yo.numeric:case yo.oid:return lxe(t);case yo.json:case yo.jsonb:return cxe(t);case yo.timestamp:return uxe(t);case yo.abstime:case yo.date:case yo.daterange:case yo.int4range:case yo.int8range:case yo.money:case yo.reltime:case yo.text:case yo.time:case yo.timestamptz:case yo.timetz:case yo.tsrange:case yo.tstzrange:return eO(t);default:return eO(t)}},eO=e=>e,sxe=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},lxe=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},cxe=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},dxe=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(l=>RK(t,l))}return e},uxe=e=>typeof e=="string"?e.replace(" ","T"):e,LK=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class UP{constructor(t,r,n={},a=Qk){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var R$;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(R$||(R$={}));class Ly{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ly.syncState(this.state,a,i,s),this.pendingDiffs.forEach(c=>{this.state=Ly.syncDiff(this.state,c,i,s)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Ly.syncDiff(this.state,a,i,s),l())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),l={},c={};return this.map(i,(d,u)=>{s[d]||(c[d]=u)}),this.map(s,(d,u)=>{const f=i[d];if(f){const m=u.map(x=>x.presence_ref),h=f.map(x=>x.presence_ref),v=u.filter(x=>h.indexOf(x.presence_ref)<0),g=f.filter(x=>m.indexOf(x.presence_ref)<0);v.length>0&&(l[d]=v),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const f=t[l].map(h=>h.presence_ref),m=u.filter(h=>f.indexOf(h.presence_ref)<0);t[l].unshift(...m)}n(l,u,c)}),this.map(s,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[l]=d,a(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var L$;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(L$||(L$={}));var $y;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})($y||($y={}));var cf;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(cf||(cf={}));class SI{constructor(t,r={config:{}},n){var a,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Bi.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new UP(this,Ld.join,this.params,this.timeout),this.rejoinTimer=new MK(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Bi.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Bi.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Bi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Bi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Bi.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ld.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new Ly(this),this.broadcastEndpointURL=LK(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Bi.closed){const{config:{broadcast:s,presence:l,private:c}}=this.params,d=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[$y.PRESENCE]&&this.bindings[$y.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},m={broadcast:s,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(h=>t?.(cf.CHANNEL_ERROR,h)),this._onClose(()=>t?.(cf.CLOSED)),this.updateJoinPayload(Object.assign({config:m},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var v;if(this.socket.setAuth(),h===void 0){t?.(cf.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,x=(v=g?.length)!==null&&v!==void 0?v:0,y=[];for(let b=0;b<x;b++){const w=g[b],{filter:{event:j,schema:_,table:S,filter:k}}=w,E=h&&h[b];if(E&&E.event===j&&E.schema===_&&E.table===S&&E.filter===k)y.push(Object.assign(Object.assign({},w),{id:E.id}));else{this.unsubscribe(),this.state=Bi.errored,t?.(cf.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(cf.SUBSCRIBED);return}}).receive("error",h=>{this.state=Bi.errored,t?.(cf.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t?.(cf.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Bi.joined&&t===$y.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:s}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(s=this.params)===null||s===void 0?void 0:s.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Bi.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ld.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new UP(this,Ld.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Bi.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new UP(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>axe){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Ld;if(n&&[l,c,d,u].indexOf(s)>=0&&n!==this._joinRef())return;let m=this._onMessage(s,r,n);if(r&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var v,g,x;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((x=(g=h.filter)===null||g===void 0?void 0:g.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===s}).map(h=>h.callback(m,n)):(i=this.bindings[s])===null||i===void 0||i.filter(h=>{var v,g,x,y,b,w;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const j=h.id,_=(v=h.filter)===null||v===void 0?void 0:v.event;return j&&((g=r.ids)===null||g===void 0?void 0:g.includes(j))&&(_==="*"||_?.toLocaleLowerCase()===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const j=(b=(y=h?.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return j==="*"||j===((w=r?.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof m=="object"&&"ids"in m){const v=m.data,{schema:g,table:x,commit_timestamp:y,type:b,errors:w}=v;m=Object.assign(Object.assign({},{schema:g,table:x,commit_timestamp:y,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(v))}h.callback(m,n)})}_isClosed(){return this.state===Bi.closed}_isJoined(){return this.state===Bi.joined}_isJoining(){return this.state===Bi.joining}_isLeaving(){return this.state===Bi.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&SI.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ld.close,{},t)}_onError(t){this._on(Ld.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Bi.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=M$(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=M$(t.columns,t.old_record)),r}}const VP=()=>{},v2={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},fxe=[1e3,2e3,5e3,1e4],mxe=1e4,hxe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class pxe{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Qk,this.transport=null,this.heartbeatIntervalMs=v2.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=VP,this.ref=0,this.reconnectTimer=null,this.logger=VP,this.conn=null,this.sendBuffer=[],this.serializer=new oxe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...s)=>Iu(()=>Promise.resolve().then(()=>t0),void 0).then(({default:l})=>l(...s)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...s)=>i(...s)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Zk.websocket}`,this.httpEndpoint=LK(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Zve.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:rxe}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ry.connecting:return op.Connecting;case Ry.open:return op.Open;case Ry.closing:return op.Closing;default:return op.Closed}}isConnected(){return this.connectionState()===op.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new SI(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(nxe,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},v2.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:s}=r,l=s?`(${s})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(a,i,s)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ld.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([hxe],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:txe};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Ld.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new MK(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},v2.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,s,l,c,d,u;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Qk,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:v2.HEARTBEAT_INTERVAL,this.worker=(i=t?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(s=t?.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(l=t?.heartbeatCallback)!==null&&l!==void 0?l:VP,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:f=>fxe[f-1]||mxe,this.encode=(d=t?.encode)!==null&&d!==void 0?d:(f,m)=>m(JSON.stringify(f)),this.decode=(u=t?.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class CI extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function _i(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class gxe extends CI{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class tO extends CI{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var vxe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const $K=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Iu(()=>Promise.resolve().then(()=>t0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},xxe=()=>vxe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Iu(()=>Promise.resolve().then(()=>t0),void 0)).Response:Response}),rO=e=>{if(Array.isArray(e))return e.map(r=>rO(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=rO(n)}),t},yxe=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var hg=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const WP=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),bxe=(e,t,r)=>hg(void 0,void 0,void 0,function*(){const n=yield xxe();e instanceof n&&!r?.noResolveJson?e.json().then(a=>{const i=e.status||500,s=a?.statusCode||i+"";t(new gxe(WP(a),i,s))}).catch(a=>{t(new tO(WP(a),a))}):t(new tO(WP(e),e))}),wxe=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"||!n?a:(yxe(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(n)):a.body=n,t?.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function X1(e,t,r,n,a,i){return hg(this,void 0,void 0,function*(){return new Promise((s,l)=>{e(r,wxe(t,n,a,i)).then(c=>{if(!c.ok)throw c;return n?.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>bxe(c,l,n))})})}function jN(e,t,r,n){return hg(this,void 0,void 0,function*(){return X1(e,"GET",t,r,n)})}function xu(e,t,r,n,a){return hg(this,void 0,void 0,function*(){return X1(e,"POST",t,n,a,r)})}function nO(e,t,r,n,a){return hg(this,void 0,void 0,function*(){return X1(e,"PUT",t,n,a,r)})}function jxe(e,t,r,n){return hg(this,void 0,void 0,function*(){return X1(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function FK(e,t,r,n,a){return hg(this,void 0,void 0,function*(){return X1(e,"DELETE",t,n,a,r)})}var Nxe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class _xe{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Nxe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}})}}var Sxe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Cxe{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}asStream(){return new _xe(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.execute().then(t,r)}execute(){return Sxe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}})}}var Nl=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Pxe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$$={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Axe{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=$K(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return Nl(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},$$),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const c=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${s.cacheControl}`,l["content-type"]=s.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a?.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield(t=="PUT"?nO:xu)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},s?.duplex?{duplex:s.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(_i(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Nl(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Nl(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${s}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:$$.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield nO(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(_i(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Nl(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r?.upsert&&(a["x-upsert"]="true");const i=yield xu(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),l=s.searchParams.get("token");if(!l)throw new CI("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_i(n))return{data:null,error:n};throw n}})}update(t,r,n){return Nl(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Nl(this,void 0,void 0,function*(){try{return{data:yield xu(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_i(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Nl(this,void 0,void 0,function*(){try{return{data:{path:(yield xu(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_i(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Nl(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield xu(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_i(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Nl(this,void 0,void 0,function*(){try{const a=yield xu(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_i(a))return{data:null,error:a};throw a}})}download(t,r){const a=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),s=i?`?${i}`:"",l=this._getFinalPath(t),c=()=>jN(this.fetch,`${this.url}/${a}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new Cxe(c,this.shouldThrowOnError)}info(t){return Nl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield jN(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:rO(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_i(n))return{data:null,error:n};throw n}})}exists(t){return Nl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield jxe(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_i(n)&&n instanceof tO){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const l=typeof r?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(r?.transform||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return Nl(this,void 0,void 0,function*(){try{return{data:yield FK(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_i(r))return{data:null,error:r};throw r}})}list(t,r,n){return Nl(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Pxe),r),{prefix:t||""});return{data:yield xu(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_i(a))return{data:null,error:a};throw a}})}listV2(t,r){return Nl(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield xu(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_i(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Exe="2.75.0",kxe={"X-Client-Info":`storage-js/${Exe}`};var Tg=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Oxe{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const i=new URL(t);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},kxe),r),this.fetch=$K(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Tg(this,void 0,void 0,function*(){try{return{data:yield jN(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}})}getBucket(t){return Tg(this,void 0,void 0,function*(){try{return{data:yield jN(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_i(r))return{data:null,error:r};throw r}})}createBucket(t){return Tg(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield xu(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_i(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return Tg(this,void 0,void 0,function*(){try{return{data:yield nO(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_i(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Tg(this,void 0,void 0,function*(){try{return{data:yield xu(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_i(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Tg(this,void 0,void 0,function*(){try{return{data:yield FK(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_i(r))return{data:null,error:r};throw r}})}}class Txe extends Oxe{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new Axe(this.url,this.headers,t,this.fetch)}}const Ixe="2.75.0";let py="";typeof Deno<"u"?py="deno":typeof document<"u"?py="web":typeof navigator<"u"&&navigator.product==="ReactNative"?py="react-native":py="node";const Dxe={"X-Client-Info":`supabase-js-${py}/${Ixe}`},Mxe={headers:Dxe},Rxe={schema:"public"},Lxe={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},$xe={};var Fxe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Bxe=e=>{let t;return e?t=e:typeof fetch>"u"?t=_K:t=fetch,(...r)=>t(...r)},qxe=()=>typeof Headers>"u"?SK:Headers,zxe=(e,t,r)=>{const n=Bxe(r),a=qxe();return(i,s)=>Fxe(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new a(s?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},s),{headers:d}))})};var Uxe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function Vxe(e){return e.endsWith("/")?e:e+"/"}function Wxe(e,t){var r,n;const{db:a,auth:i,realtime:s,global:l}=e,{db:c,auth:d,realtime:u,global:f}=t,m={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),s),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f?.headers)!==null&&r!==void 0?r:{}),(n=l?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Uxe(this,void 0,void 0,function*(){return""})};return e.accessToken?m.accessToken=e.accessToken:delete m.accessToken,m}function Hxe(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Vxe(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const BK="2.75.0",rv=30*1e3,aO=3,HP=aO*rv,Gxe="http://localhost:9999",Kxe="supabase.auth.token",Yxe={"X-Client-Info":`gotrue-js/${BK}`},oO="X-Supabase-Api-Version",qK={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Xxe=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Jxe=10*60*1e3;class Ob extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Bn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Qxe extends Ob{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Zxe(e){return Bn(e)&&e.name==="AuthApiError"}class ip extends Ob{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Nh extends Ob{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class hm extends Nh{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function e0e(e){return Bn(e)&&e.name==="AuthSessionMissingError"}class Ig extends Nh{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class x2 extends Nh{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class y2 extends Nh{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function t0e(e){return Bn(e)&&e.name==="AuthImplicitGrantRedirectError"}class F$ extends Nh{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class iO extends Nh{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function GP(e){return Bn(e)&&e.name==="AuthRetryableFetchError"}class B$ extends Nh{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class sO extends Nh{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const NN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),q$=` 	
\r=`.split(""),r0e=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<q$.length;t+=1)e[q$[t].charCodeAt(0)]=-2;for(let t=0;t<NN.length;t+=1)e[NN[t].charCodeAt(0)]=t;return e})();function z$(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(NN[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(NN[n]),t.queuedBits-=6}}function zK(e,t,r){const n=r0e[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function U$(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{o0e(s,n,r)};for(let s=0;s<e.length;s+=1)zK(e.charCodeAt(s),a,i);return t.join("")}function n0e(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function a0e(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}n0e(n,t)}}function o0e(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Lv(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)zK(e.charCodeAt(a),r,n);return new Uint8Array(t)}function i0e(e){const t=[];return a0e(e,r=>t.push(r)),new Uint8Array(t)}function mp(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>z$(a,r,n)),z$(null,r,n),t.join("")}function s0e(e){return Math.round(Date.now()/1e3)+e}function l0e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Zl=()=>typeof window<"u"&&typeof document<"u",Fh={tested:!1,writable:!1},UK=()=>{if(!Zl())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Fh.tested)return Fh.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Fh.tested=!0,Fh.writable=!0}catch{Fh.tested=!0,Fh.writable=!1}return Fh.writable};function c0e(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const VK=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Iu(()=>Promise.resolve().then(()=>t0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},d0e=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",nv=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Bh=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},om=async(e,t)=>{await e.removeItem(t)};class YS{constructor(){this.promise=new YS.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}YS.promiseConstructor=Promise;function KP(e){const t=e.split(".");if(t.length!==3)throw new sO("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Xxe.test(t[n]))throw new sO("JWT not in base64url format");return{header:JSON.parse(U$(t[0])),payload:JSON.parse(U$(t[1])),signature:Lv(t[2]),raw:{header:t[0],payload:t[1]}}}async function u0e(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function f0e(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function m0e(e){return("0"+e.toString(16)).substr(-2)}function h0e(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,m0e).join("")}async function p0e(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function g0e(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await p0e(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Dg(e,t,r=!1){const n=h0e();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await nv(e,`${t}-code-verifier`,a);const i=await g0e(n);return[i,n===i?"plain":"s256"]}const v0e=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function x0e(e){const t=e.headers.get(oO);if(!t||!t.match(v0e))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function y0e(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function b0e(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const w0e=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Mg(e){if(!w0e.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function YP(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function V$(e){return JSON.parse(JSON.stringify(e))}var j0e=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Jh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),N0e=[502,503,504];async function W$(e){var t;if(!d0e(e))throw new iO(Jh(e),0);if(N0e.includes(e.status))throw new iO(Jh(e),e.status);let r;try{r=await e.json()}catch(i){throw new ip(Jh(i),i)}let n;const a=x0e(e);if(a&&a.getTime()>=qK["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new B$(Jh(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new hm}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new B$(Jh(r),e.status,r.weak_password.reasons);throw new Qxe(Jh(r),e.status||500,n)}const _0e=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function na(e,t,r,n){var a;const i=Object.assign({},n?.headers);i[oO]||(i[oO]=qK["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(s.redirect_to=n.redirectTo);const l=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=await S0e(e,t,r+l,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(c):{data:Object.assign({},c),error:null}}async function S0e(e,t,r,n,a,i){const s=_0e(t,n,a,i);let l;try{l=await e(r,Object.assign({},s))}catch(c){throw console.error(c),new iO(Jh(c),0)}if(l.ok||await W$(l),n?.noResolveJson)return l;try{return await l.json()}catch(c){await W$(c)}}function Td(e){var t;let r=null;A0e(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=s0e(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function H$(e){const t=Td(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Nm(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function C0e(e){return{data:e,error:null}}function P0e(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=j0e(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},s);return{data:{properties:l,user:c},error:null}}function G$(e){return e}function A0e(e){return e.access_token&&e.refresh_token&&e.expires_in}const XP=["global","local","others"];var E0e=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class k0e{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=VK(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=XP[0]){if(XP.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${XP.join(", ")}`);try{return await na(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Bn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await na(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Nm})}catch(n){if(Bn(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=E0e(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await na(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:P0e,redirectTo:r?.redirectTo})}catch(r){if(Bn(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await na(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Nm})}catch(r){if(Bn(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await na(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:G$});if(u.error)throw u.error;const f=await u.json(),m=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(v.split(";")[1].split("=")[1]);d[`${x}Page`]=g}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Bn(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Mg(t);try{return await na(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Nm})}catch(r){if(Bn(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Mg(t);try{return await na(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Nm})}catch(n){if(Bn(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Mg(t);try{return await na(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Nm})}catch(n){if(Bn(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Mg(t.userId);try{const{data:r,error:n}=await na(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Bn(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Mg(t.userId),Mg(t.id);try{return{data:await na(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Bn(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,i,s,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await na(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:G$});if(u.error)throw u.error;const f=await u.json(),m=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(v.split(";")[1].split("=")[1]);d[`${x}Page`]=g}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Bn(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await na(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Bn(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await na(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Bn(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await na(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Bn(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await na(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Bn(r))return{data:null,error:r};throw r}}}function K$(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Rg={debug:!!(globalThis&&UK()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class WK extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class O0e extends WK{}async function T0e(e,t,r){Rg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Rg.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Rg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Rg.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Rg.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new O0e(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Rg.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function I0e(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function HK(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function D0e(e){return parseInt(e,16)}function M0e(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function R0e(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:s,notBefore:l,requestId:c,resources:d,scheme:u,uri:f,version:m}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(m!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const h=HK(e.address),v=u?`${u}://${n}`:n,g=e.statement?`${e.statement}
`:"",x=`${v} wants you to sign in with your Ethereum account:
${h}

${g}`;let y=`URI: ${f}
Version: ${m}
Chain ID: ${r}${s?`
Nonce: ${s}`:""}
Issued At: ${i.toISOString()}`;if(a&&(y+=`
Expiration Time: ${a.toISOString()}`),l&&(y+=`
Not Before: ${l.toISOString()}`),c&&(y+=`
Request ID: ${c}`),d){let b=`
Resources:`;for(const w of d){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);b+=`
- ${w}`}y+=b}return`${x}
${y}`}class Ni extends Error{constructor({message:t,code:r,cause:n,name:a}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class _N extends Ni{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function L0e({error:e,options:t}){var r,n,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ni({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ni({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ni({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Ni({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Ni({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Ni({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Ni({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Ni({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(KK(s)){if(i.rp.id!==s)return new Ni({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ni({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Ni({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Ni({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ni({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function $0e({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ni({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Ni({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(KK(n)){if(r.rpId!==n)return new Ni({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ni({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Ni({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ni({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}var GK=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class F0e{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const B0e=new F0e;function q0e(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=GK(e,["challenge","user","excludeCredentials"]),i=Lv(t).buffer,s=Object.assign(Object.assign({},r),{id:Lv(r.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:i,user:s});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Lv(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function z0e(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=GK(e,["challenge","allowCredentials"]),a=Lv(t).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let s=0;s<r.length;s++){const l=r[s];i.allowCredentials[s]=Object.assign(Object.assign({},l),{id:Lv(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function U0e(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:mp(new Uint8Array(e.response.attestationObject)),clientDataJSON:mp(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function V0e(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:mp(new Uint8Array(a.authenticatorData)),clientDataJSON:mp(new Uint8Array(a.clientDataJSON)),signature:mp(new Uint8Array(a.signature)),userHandle:a.userHandle?mp(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function KK(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Y$(){var e,t;return!!(Zl()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function W0e(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new _N("Browser returned unexpected credential type",t)}:{data:null,error:new _N("Empty credential response",t)}}catch(t){return{data:null,error:L0e({error:t,options:e})}}}async function H0e(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new _N("Browser returned unexpected credential type",t)}:{data:null,error:new _N("Empty credential response",t)}}catch(t){return{data:null,error:$0e({error:t,options:e})}}}const G0e={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},K0e={userVerification:"preferred",hints:["security-key"]};function SN(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const i in a){const s=a[i];if(s!==void 0)if(Array.isArray(s))n[i]=s;else if(r(s))n[i]=s;else if(t(s)){const l=n[i];t(l)?n[i]=SN(l,s):n[i]=SN(s)}else n[i]=s}return n}function Y0e(e,t){return SN(G0e,e,t||{})}function X0e(e,t){return SN(K0e,e,t||{})}class J0e{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},i){try{const{data:s,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!s)return{data:null,error:l};const c=a??B0e.createNewAbortSignal();if(s.webauthn.type==="create"){const{user:d}=s.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(s.webauthn.type){case"create":{const d=Y0e(s.webauthn.credential_options.publicKey,i?.create),{data:u,error:f}=await W0e({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const d=X0e(s.webauthn.credential_options.publicKey,i?.request),{data:u,error:f}=await H0e(Object.assign(Object.assign({},s.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(s){return Bn(s)?{data:null,error:s}:{data:null,error:new ip("Unexpected error in challenge",s)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}},i){if(!r)return{data:null,error:new Ob("rpId is required for WebAuthn authentication")};try{if(!Y$())return{data:null,error:new ip("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:i});if(!s)return{data:null,error:l};const{webauthn:c}=s;return this._verify({factorId:t,challengeId:s.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(s){return Bn(s)?{data:null,error:s}:{data:null,error:new ip("Unexpected error in authenticate",s)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a},i){if(!r)return{data:null,error:new Ob("rpId is required for WebAuthn registration")};try{if(!Y$())return{data:null,error:new ip("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this._enroll({friendlyName:t});if(!s)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(m=>m.factor_type==="webauthn"&&m.friendly_name===t&&m.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:s.id,friendlyName:s.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:i});return c?this._verify({factorId:s.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(s){return Bn(s)?{data:null,error:s}:{data:null,error:new ip("Unexpected error in register",s)}}}}I0e();const Q0e={url:Gxe,storageKey:Kxe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Yxe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function X$(e,t,r){return await r()}const Lg={};class Tb{get jwks(){var t,r;return(r=(t=Lg[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Lg[this.storageKey]=Object.assign(Object.assign({},Lg[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Lg[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Lg[this.storageKey]=Object.assign(Object.assign({},Lg[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Tb.nextInstanceID,Tb.nextInstanceID+=1,this.instanceID>0&&Zl()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Q0e),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new k0e({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=VK(a.fetch),this.lock=a.lock||X$,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Zl()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=T0e:this.lock=X$,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new J0e(this)},this.persistSession?(a.storage?this.storage=a.storage:UK()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=K$(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=K$(this.memoryStorage)),Zl()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${BK}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=c0e(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Zl()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),t0e(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",l),await this._saveSession(s),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Bn(r)?{error:r}:{error:new ip("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await na(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Td}),{data:s,error:l}=i;if(l||!s)return{data:{user:null,session:null},error:l};const c=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Bn(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:f,options:m}=t;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await Dg(this.storage,this.storageKey)),i=await na(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m?.emailRedirectTo,body:{email:u,password:f,data:(r=m?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:h,code_challenge_method:v},xform:Td})}else if("phone"in t){const{phone:u,password:f,options:m}=t;i=await na(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=m?.data)!==null&&n!==void 0?n:{},channel:(a=m?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:Td})}else throw new x2("You must provide either an email or phone number and a password");const{data:s,error:l}=i;if(l||!s)return{data:{user:null,session:null},error:l};const c=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Bn(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:l}=t;r=await na(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:H$})}else if("phone"in t){const{phone:i,password:s,options:l}=t;r=await na(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:H$})}else throw new x2("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ig}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Bn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,i,s,l,c,d,u,f,m;let h,v;if("message"in t)h=t.message,v=t.signature;else{const{chain:g,wallet:x,statement:y,options:b}=t;let w;if(Zl())if(typeof x=="object")w=x;else{const A=window;if("ethereum"in A&&typeof A.ethereum=="object"&&"request"in A.ethereum&&typeof A.ethereum.request=="function")w=A.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=x}const j=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href),_=await w.request({method:"eth_requestAccounts"}).then(A=>A).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=HK(_[0]);let k=(n=b?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const A=await w.request({method:"eth_chainId"});k=D0e(A)}const E={domain:j.host,address:S,statement:y,uri:j.href,version:"1",chainId:k,nonce:(a=b?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(s=(i=b?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&s!==void 0?s:new Date,expirationTime:(l=b?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=b?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=b?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=b?.signInWithEthereum)===null||u===void 0?void 0:u.resources};h=R0e(E),v=await w.request({method:"personal_sign",params:[M0e(h),S]})}try{const{data:g,error:x}=await na(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:v},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Td});if(x)throw x;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Ig}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:x})}catch(g){if(Bn(g))return{data:{user:null,session:null},error:g};throw g}}async signInWithSolana(t){var r,n,a,i,s,l,c,d,u,f,m,h;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:x,wallet:y,statement:b,options:w}=t;let j;if(Zl())if(typeof y=="object")j=y;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))j=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=y}const _=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const S=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),b?{statement:b}:null));let k;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")k=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)k=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)v=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),g=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${_.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(a=(n=w?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=w?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((s=w?.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(u=w?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const S=await j.signMessage(new TextEncoder().encode(v),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=S}}try{const{data:x,error:y}=await na(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:mp(g)},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Td});if(y)throw y;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new Ig}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:y})}catch(x){if(Bn(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await Bh(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await na(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Td});if(await om(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ig}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(Bn(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,l=await na(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Td}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ig}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Bn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Dg(this.storage,this.storageKey));const{error:f}=await na(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await na(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c?.data)!==null&&a!==void 0?a:{},create_user:(i=c?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(s=c?.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:u}}throw new x2("You must provide either an email or phone number.")}catch(l){if(Bn(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:l}=await na(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Td});if(l)throw l;if(!s)throw new Error("An error occurred on token verification.");const c=s.session,d=s.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Bn(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await Dg(this.storage,this.storageKey)),await na(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:C0e})}catch(i){if(Bn(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new hm;const{error:a}=await na(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Bn(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await na(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:l}=await na(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:s?.message_id},error:l}}throw new x2("You must provide either an email or phone number and a type")}catch(r){if(Bn(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Bh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<HP:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const s=await Bh(this.userStorage,this.storageKey+"-user");s?.user?t.user=s.user:t.user=YP()}if(this.storage.isServer&&t.user){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!s&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await na(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Nm}):await this._useSession(async r=>{var n,a,i;const{data:s,error:l}=r;if(l)throw l;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new hm}:await na(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Nm})})}catch(r){if(Bn(r))return e0e(r)&&(await this._removeSession(),await om(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new hm;const s=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Dg(this.storage,this.storageKey));const{data:d,error:u}=await na(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:s.access_token,xform:Nm});if(u)throw u;return s.user=d.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(Bn(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new hm;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=KP(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Bn(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:l}=r;if(l)throw l;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new hm;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Bn(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Zl())throw new y2("No browser detected.");if(t.error||t.error_description||t.error_code)throw new y2(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new F$("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new y2("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new F$("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:l,expires_at:c,token_type:d}=t;if(!i||!l||!s||!d)throw new y2("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let m=u+f;c&&(m=parseInt(c));const h=m-u;h*1e3<=rv&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const v=m-f;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,m,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,m,u);const{data:g,error:x}=await this._getUser(i);if(x)throw x;const y={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:m,refresh_token:s,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(Bn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Bh(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:l}=await this.admin.signOut(s,t);if(l&&!(Zxe(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await om(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=l0e(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Dg(this.storage,this.storageKey,!0));try{return await na(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Bn(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Bn(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,l,c,d,u;const{data:f,error:m}=i;if(m)throw m;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await na(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Zl()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(Bn(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:s,provider:l,token:c,access_token:d,nonce:u}=t,f=await na(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Td}),{data:m,error:h}=f;return h?{data:{user:null,session:null},error:h}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Ig}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("USER_UPDATED",m.session)),{data:m,error:h})}catch(a){if(Bn(a))return{data:{user:null,session:null},error:a};throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await na(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Bn(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await f0e(async a=>(a>0&&await u0e(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await na(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Td})),(a,i)=>{const s=200*Math.pow(2,a);return i&&GP(i)&&Date.now()+s-n<rv})}catch(n){if(this._debug(r,"error",n),Bn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Zl()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Bh(this.storage,this.storageKey);if(a&&this.userStorage){let s=await Bh(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await nv(this.userStorage,this.storageKey+"-user",s)),a.user=(t=s?.user)!==null&&t!==void 0?t:YP()}else if(a&&!a.user&&!a.user){const s=await Bh(this.storage,this.storageKey+"-user");s&&s?.user?(a.user=s.user,await om(this.storage,this.storageKey+"-user"),await nv(this.storage,this.storageKey,a)):a.user=YP()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<HP;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${HP}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),GP(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:l}=await this._getUser(a.access_token);!l&&s?.user?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new hm;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new YS;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new hm;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),Bn(i)){const s={data:null,error:i};return GP(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(s),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await nv(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=V$(a);await nv(this.storage,this.storageKey,i)}else{const a=V$(r);await nv(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await om(this.storage,this.storageKey),await om(this.storage,this.storageKey+"-code-verifier"),await om(this.storage,this.storageKey+"-user"),this.userStorage&&await om(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Zl()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),rv);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/rv);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${rv}ms, refresh threshold is ${aO} ticks`),a<=aO&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof WK)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Zl()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await Dg(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(l.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await na(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Bn(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await na(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&c.type==="totp"&&(!((a=c?.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Bn(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const s=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?U0e(t.webauthn.credential_response):V0e(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await na(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:s,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(r){if(Bn(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const s=await na(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});if(s.error)return s;const{data:l}=s;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:q0e(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:z0e(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Bn(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r?.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=KP(a.access_token);let l=null;s.aal&&(l=s.aal);let c=l;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=s.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+Jxe>a)return n;const{data:i,error:s}=await na(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return{data:null,error:v};n=h.session.access_token}const{header:a,payload:i,signature:s,raw:{header:l,payload:c}}=KP(n);r?.allowExpired||y0e(i.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:a,signature:s},error:null}}const u=b0e(a.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,s,i0e(`${l}.${c}`)))throw new sO("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(Bn(n))return{data:null,error:n};throw n}}}Tb.nextInstanceID=0;const Z0e=Tb;class eye extends Z0e{constructor(t){super(t)}}var tye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class rye{constructor(t,r,n){var a,i,s;this.supabaseUrl=t,this.supabaseKey=r;const l=Hxe(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:Rxe,realtime:$xe,auth:Object.assign(Object.assign({},Lxe),{storageKey:c}),global:Mxe},u=Wxe(n??{},d);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=zxe(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Qve(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Txe(this.storageUrl.href,this.headers,this.fetch,n?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new kve(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return tye(this,void 0,void 0,function*(){var t,r;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,storageKey:s,flowType:l,lock:c,debug:d},u,f){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new eye({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),u),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,flowType:l,lock:c,debug:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new pxe(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const nye=(e,t,r)=>new rye(e,t,r);function aye(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}aye()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const oye="https://dlfryxtyxqoacuunswuc.supabase.co",iye="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY";function PI(){try{if(typeof window<"u"&&window.__SUPABASE_URL)return window.__SUPABASE_URL}catch{}return oye}function YK(){try{if(typeof window<"u"&&window.__SUPABASE_KEY)return window.__SUPABASE_KEY}catch{}return iye}function sye(){try{return(new URL(PI()).host||"").split(".")[0]||""}catch{return""}}function lye(){const e=sye();return e?`sb-${e}-auth-token`:"sb-auth-token"}async function cye(){try{const e=localStorage.getItem("custom-auth-token");if(e&&e.trim())return e.trim()}catch{}try{if(typeof Jm<"u"&&Jm?.auth?.getSession){const e=new Promise((a,i)=>setTimeout(()=>i(new Error("getSession timeout")),1e3)),t=Jm.auth.getSession(),{data:r}=await Promise.race([t,e]),n=r?.session?.access_token;if(n)return console.debug("[Supabase Wrapper] Token obtido via getSession"),n}}catch(e){console.debug("[Supabase Wrapper] getSession falhou ou timeout:",e.message)}try{const e=lye(),t=localStorage.getItem(e);if(t){const r=JSON.parse(t);if(r?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage"),r.access_token;if(r?.currentSession?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage (currentSession)"),r.currentSession.access_token}}catch(e){console.warn("[Supabase Wrapper] Erro ao ler localStorage:",e)}return console.warn("[Supabase Wrapper]  Nenhum token encontrado - usando anon key"),null}const dye=e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([r,n])=>{n!=null&&(Array.isArray(n)?n.forEach(a=>t.append(r,String(a))):t.append(r,String(n)))}),t.toString()},XK=async(e,t={})=>{const{method:r="GET",body:n,headers:a={},params:i={},signal:s,timeoutMs:l=2e4}=t,c=dye(i),u=`${PI()}/rest/v1/${e}${c?`?${c}`:""}`,f=YK(),m={apikey:f,Authorization:`Bearer ${f}`,"Content-Type":"application/json",Prefer:"return=representation",...a};try{const _=await cye();_&&(m.Authorization=`Bearer ${_}`)}catch(_){console.warn("[Supabase Wrapper] Erro ao obter token de sesso:",_)}const h={method:r,headers:m};n&&(h.body=JSON.stringify(n)),s&&(h.signal=s);const v=new AbortController,g=setTimeout(()=>{console.warn(`[Supabase Wrapper]  Timeout (${l}ms) para ${e}`);try{v.abort("timeout")}catch{}},Math.max(5e3,l)),x=(()=>{if(!s)return v.signal;try{s.addEventListener("abort",()=>{try{v.abort("upstream-abort")}catch{}})}catch{}return v.signal})();h.signal=x;const y=Date.now();let b;try{b=await fetch(u,h)}finally{clearTimeout(g)}if(!b.ok){let _="";try{_=await b.text()}catch{}const S=Date.now()-y;let k=!1;try{const E=JSON.parse(_);k=b.status===401&&(E?.code==="PGRST303"||/jwt expired/i.test(E?.message||""))}catch{}if(k){try{window.dispatchEvent(new CustomEvent("auth:jwt-expired"))}catch{}try{localStorage.removeItem("custom-auth-token"),Object.keys(localStorage).filter(E=>E.startsWith("sb-")).forEach(E=>localStorage.removeItem(E)),Object.keys(sessionStorage).filter(E=>E.startsWith("sb-")).forEach(E=>sessionStorage.removeItem(E)),sessionStorage.setItem("auth:forceLogout","1"),window.location.replace("/")}catch{}}throw new Error(`[Supabase Wrapper] HTTP ${b.status} (${S}ms) - ${_||"unknown error"}`)}const w=Date.now()-y;let j;try{j=await b.json()}catch(_){throw console.error(`[Supabase Wrapper] Erro ao parsear JSON de ${e}:`,_),new Error(`[Supabase Wrapper] JSON parse error: ${_.message}`)}return w>3e3?console.warn(`[Supabase Wrapper]  fetch ${e} LENTO (${w}ms)`):console.debug(`[Supabase Wrapper] fetch ${e} OK (${w}ms)`),{data:j,error:null}};class uye{constructor(t){this.table=t,this.params={},this.multiFilters={},this.selectColumns="*",this.signal=null}select(t="*"){return this.selectColumns=t,this.params.select=t,this}eq(t,r){return this._addFilter(t,`eq.${r}`),this}neq(t,r){return this.params[t]=`neq.${r}`,this}gt(t,r){return this.params[t]=`gt.${r}`,this}gte(t,r){return this._addFilter(t,`gte.${r}`),this}lt(t,r){return this.params[t]=`lt.${r}`,this}lte(t,r){return this._addFilter(t,`lte.${r}`),this}like(t,r){return this.params[t]=`like.${r}`,this}ilike(t,r){return this.params[t]=`ilike.${r}`,this}is(t,r){return this.params[t]=`is.${r}`,this}in(t,r){return this.params[t]=`in.(${r.join(",")})`,this}not(t,r,n){return this.params[t]=`not.${r}.${n}`,this}or(t){return this.params.or=`(${t})`,this}contains(t,r){return this.params[t]=`cs.{${r}}`,this}containedBy(t,r){return this.params[t]=`cd.{${r}}`,this}filter(t,r,n){return this._addFilter(t,`${r}.${n}`),this}order(t,r={}){const n=r.ascending===!1?"desc":"asc";return this.params.order=`${t}.${n}`,this}limit(t){return this.params.limit=t,this}range(t,r){return this.params.offset=t,this.params.limit=r-t+1,this}single(){return this.params.limit=1,this.isSingle=!0,this}maybeSingle(){return this.params.limit=1,this.isMaybeSingle=!0,this}abortSignal(t){return this.signal=t,this}_addFilter(t,r){this.multiFilters[t]||(this.multiFilters[t]=[]),this.multiFilters[t].push(r)}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([i,s])=>{s.length===1?n[i]=s[0]:s.length>1&&(n[i]=s)});const a=await XK(this.table,{method:"GET",params:n,signal:this.signal});this.isSingle&&a.data&&(a.data=a.data[0]||null),this.isMaybeSingle&&a.data&&(a.data=a.data[0]||null),t(a)}catch(n){r(n)}}}class fye extends uye{insert(t){return this.method="POST",this.body=Array.isArray(t)?t:[t],this}update(t){return this.method="PATCH",this.body=t,this}upsert(t,r={}){this.method="POST",this.body=Array.isArray(t)?t:[t];const n=r.ignoreDuplicates?"resolution=ignore-duplicates":"resolution=merge-duplicates",a=r.returning==="minimal"?"return=minimal":"return=representation";return this.headers={...this.headers||{},Prefer:`${n},${a}`},r.onConflict&&(this.params.on_conflict=r.onConflict),this}delete(){return this.method="DELETE",this}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([i,s])=>{s.length===1?n[i]=s[0]:s.length>1&&(n[i]=s)});const a=await XK(this.table,{method:this.method||"GET",body:this.body,params:n,signal:this.signal,headers:this.headers||{}});this.isSingle&&a.data&&(a.data=a.data[0]||null),this.isMaybeSingle&&a.data&&(a.data=a.data[0]||null),t(a)}catch(n){r(n)}}}const Jm={from(e){return new fye(e)},auth:null,supabaseUrl:PI(),supabaseKey:YK()};typeof window<"u"&&Jm.from("empresas").select("id").limit(1).then(({data:e,error:t})=>{t&&console.error("[Supabase Wrapper]  ERRO:",t)}).catch(e=>{console.error("[Supabase Wrapper]  EXCEPTION:",e)});const J$="main";let $v,Fy;try{const e=Object.assign({"./backendTargets.js":jve,"./backendTargets.local.js":Sve}),t=e["./backendTargets.js"]||null,r=e["./backendTargets.local.js"]||null;t?.TARGETS&&(Fy=t.TARGETS),t?.ACTIVE_TARGET&&($v=t.ACTIVE_TARGET),r?.TARGETS&&(Fy=r.TARGETS),r?.ACTIVE_TARGET&&($v=r.ACTIVE_TARGET)}catch{}let ad=Fy&&$v&&Fy[$v]?Fy[$v]:null,AI=$v;!ad&&J$&&(AI=J$);let lc=ad&&ad.supabaseUrl&&ad.supabaseUrl.trim()?ad.supabaseUrl:"",sl=ad&&ad.supabaseAnonKey&&ad.supabaseAnonKey.trim()?ad.supabaseAnonKey:"";if(!lc||!sl){const e=(AI||"dev").toLowerCase(),t=e==="main"?{}.VITE_SUPABASE_URL_MAIN:{}.VITE_SUPABASE_URL_DEV,r=e==="main"?{}.VITE_SUPABASE_ANON_KEY_MAIN:{}.VITE_SUPABASE_ANON_KEY_DEV;lc=lc&&lc.trim()?lc:t,sl=sl&&sl.trim()?sl:r}(!lc||!sl)&&(lc=lc||"https://dlfryxtyxqoacuunswuc.supabase.co",sl=sl||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY");try{try{const e=AI||"dev";console.log(`[Target] Branch ativa: ${e}`);try{typeof window<"u"&&(window.__ACTIVE_TARGET=e)}catch{}const t=!!ad&&!!(ad.supabaseUrl||"").trim()&&!!(ad.supabaseAnonKey||"").trim(),r=!t&&(!!{}.VITE_SUPABASE_URL_DEV||!!{}.VITE_SUPABASE_URL_MAIN);console.info(`[Supabase] Backend target mode: ${t?"static config":r?"per-target env":"generic env"}`)}catch{}}catch{}if(!lc||!sl)throw console.error("[Supabase]  ERRO CRTICO: Variveis de ambiente ausentes!"),new Error("Supabase: Variveis de ambiente no configuradas!");const mye=lc,hye=sl,Id=nye(lc,sl,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:typeof window<"u"?window.localStorage:void 0},global:{headers:{"X-Client-Info":"fluxo7arena-web",apikey:sl,Authorization:`Bearer ${sl}`}}});try{typeof window<"u"&&Jm&&(Jm.auth=Id.auth)}catch{}const pe={from:e=>Jm.from(e),auth:Id.auth,storage:Id.storage,functions:Id.functions,rpc:(...e)=>Id.rpc(...e),realtime:Id.realtime,channel:(...e)=>Id.channel(...e),removeChannel:(...e)=>Id.removeChannel(...e),removeAllChannels:()=>Id.removeAllChannels(),getChannels:()=>Id.getChannels(),supabaseUrl:lc,supabaseKey:sl};if(typeof window<"u"){window.__supabase=pe,window.__supabase_original=Id,window.__supabase_wrapper=Jm;try{window.__SUPABASE_URL=lc}catch{}try{window.__SUPABASE_KEY=sl}catch{}}const JK=p.createContext({}),Do=()=>{const e=p.useContext(JK);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},pye=({children:e})=>{const[t,r]=p.useState(null),[n,a]=p.useState(null),[i,s]=p.useState(null),[l,c]=p.useState(!0),[d,u]=p.useState(!1),f=p.useRef(null),m=p.useRef(!1),h=(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}})();p.useEffect(()=>{if((()=>{try{return sessionStorage.getItem("auth:forceLogout")==="1"}catch{return!1}})()){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),a(null),s(null),u(!0),c(!1);try{sessionStorage.removeItem("auth:forceLogout")}catch{}try{pe.auth.signOut({scope:"global"}).catch(()=>{})}catch{}return}try{const E=localStorage.getItem("auth:userProfile"),A=localStorage.getItem("auth:company");E&&a(JSON.parse(E)),A&&s(JSON.parse(A)),(E||A)&&u(!0)}catch(E){console.warn("AuthContext: falha ao hidratar cache local:",E)}(async()=>{try{if(h)try{const M=localStorage.getItem("custom-auth-token");if(M&&M.trim()){const T=JSON.parse(atob(M.split(".")[1].replace(/-/g,"+").replace(/_/g,"/")))?.sub||null;if(T){r({id:T}),u(!0),await v(T),f.current=T,c(!1);return}}}catch{}const{data:{session:E},error:A}=await pe.auth.getSession();A&&console.error("supabase.auth.getSession error:",A),E?.user?(r(E.user),u(!0),await v(E.user.id),f.current=E.user.id):u(!0)}catch(E){console.error("getSession exception:",E)}finally{c(!1)}})();const{data:S}=pe.auth.onAuthStateChange(async(E,A)=>{console.log("[AuthContext] onAuthStateChange",{event:E,userId:A?.user?.id||null});try{if(E==="SIGNED_OUT"){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),a(null),s(null),f.current=null,m.current=!1,c(!1),u(!0);return}if(h){u(!0),c(!1);return}const M=A?.user||null;r(M),u(!0),M?.id&&(await v(M.id),f.current=M.id,c(!1))}catch(M){console.error("onAuthStateChange handler error:",M),c(!1),u(!0)}}),k=setTimeout(()=>{c(E=>E&&!1),u(E=>E||!0)},12e3);return()=>{clearTimeout(k),S.subscription.unsubscribe()}},[]),p.useEffect(()=>{(async()=>{try{if(!d||!t)return;const _=!n,S=!!n&&!i&&!!n.codigo_empresa;(_||S)&&(await v(t.id),f.current=t.id)}catch{}})()},[d,t?.id,!!n,n?.codigo_empresa,!!i]),p.useEffect(()=>{const j=()=>{try{const k=localStorage.getItem("auth:userProfile"),E=localStorage.getItem("auth:company");if(k){const A=JSON.parse(k);(!n||!n.codigo_empresa)&&a(A)}if(E){const A=JSON.parse(E);(!i||!i.codigo_empresa)&&s(A)}}catch{}},_=()=>{j(),t?.id&&v(t.id).catch(()=>{})},S=()=>{document.visibilityState==="visible"&&_()};return window.addEventListener("focus",_),document.addEventListener("visibilitychange",S),()=>{window.removeEventListener("focus",_),document.removeEventListener("visibilitychange",S)}},[t?.id]);const v=async j=>{if(m.current){console.log("[AuthDebug] loadUserProfile:skip (already running)");return}m.current=!0;try{const _=[300,800,1600,3e3],S=A=>new Promise(M=>setTimeout(M,A)),k=async(A,M)=>{let C;try{const T=new Promise(D=>{C=setTimeout(()=>D({__timeout:!0}),M)});return await Promise.race([A,T])}finally{clearTimeout(C)}},E=1200;for(let A=0;A<=_.length;A++){console.log("[AuthDebug] loadUserProfile:start",{userId:j,attempt:A});try{console.log("[AuthDebug] querying colaboradores",{userId:j});const M=pe.from("colaboradores").select("*").eq("id",j).single(),C=await k(M,E);if(C&&C.__timeout){console.warn("[AuthDebug] colaboradores:timeout, using usuarios fallback (inline)");try{console.log("[AuthDebug] fallback-inline: querying usuarios by id");const{data:D,error:F}=await pe.from("usuarios").select("*").eq("id",j).maybeSingle();if(!F&&D){let z=null;if(D.codigo_empresa){console.log("[AuthDebug] fallback-inline: querying empresas by codigo",{codigo_empresa:D.codigo_empresa});const{data:$,error:K}=await pe.from("empresas").select("*").eq("codigo_empresa",D.codigo_empresa).single();K?console.warn("[AuthDebug] fallback-inline: empresa error",{status:K.status,code:K.code,message:K.message}):(z=$,console.log("[AuthDebug] fallback-inline: empresa loaded"))}const q={id:j,nome:D.nome||null,cargo:D.papel||"user",codigo_empresa:D.codigo_empresa||null,_source:"usuarios"};a(q);try{localStorage.setItem("auth:userProfile",JSON.stringify(q))}catch{}if(z){s(z);try{localStorage.setItem("auth:company",JSON.stringify(z))}catch{}console.log("[AuthDebug] fallback-inline: set company from usuarios path")}else console.warn("[AuthDebug] fallback-inline: no company resolved; preserving previous company");return}F&&console.warn("[AuthDebug] fallback-inline: usuarios error",{status:F.status,code:F.code,message:F.message})}catch(D){console.warn("[AuthDebug] fallback-inline: unexpected error",D?.message||D)}if(A<_.length){await S(_[A]);continue}return}const{data:T,error:I}=C||{};if(console.log("[AuthDebug] colaboradores:success",{hasProfile:!!T,codigo_empresa:T?.codigo_empresa||null}),I){if(console.warn("[AuthDebug] colaboradores:error",{code:I.code,status:I.status,message:I.message}),I.code==="42P17"){if(A<_.length){await S(_[A]);continue}console.warn("RLS recursion (42P17) persistente ao carregar perfil. Prosseguindo sem alterar cache.");return}if([401,403].includes(Number(I.status))&&(console.warn("[AuthDebug] Erro de autorizao detectado, tentando fallback"),A<_.length)){await S(_[A]);continue}if(I.code==="PGRST116"){try{console.log("[AuthDebug] fallback: querying usuarios by id");const{data:F,error:z}=await pe.from("usuarios").select("*").eq("id",j).maybeSingle();if(!z&&F){let q=null;if(F.codigo_empresa){console.log("[AuthDebug] fallback: querying empresas by codigo",{codigo_empresa:F.codigo_empresa});const{data:K,error:ce}=await pe.from("empresas").select("*").eq("codigo_empresa",F.codigo_empresa).single();ce?console.warn("[AuthDebug] fallback: empresa error",{status:ce.status,code:ce.code,message:ce.message}):(q=K,console.log("[AuthDebug] fallback: empresa loaded"))}const $={id:j,nome:F.nome||null,cargo:F.papel||"user",codigo_empresa:F.codigo_empresa||null,_source:"usuarios"};a($);try{localStorage.setItem("auth:userProfile",JSON.stringify($))}catch{}if(q){s(q);try{localStorage.setItem("auth:company",JSON.stringify(q))}catch{}console.log("[AuthDebug] fallback: set company from usuarios path")}else console.warn("[AuthDebug] fallback: no company resolved; preserving previous company");return}z&&console.warn("[AuthDebug] fallback: usuarios error",{status:z.status,code:z.code,message:z.message})}catch{}console.warn("AuthContext: perfil no encontrado (PGRST116) e fallback falhou; mantendo cache atual.");return}if([401,403,406].includes(Number(I.status))&&A<_.length){await S(_[A]);continue}throw I}if(!T){if(A<_.length){await S(_[A]);continue}return}a(T);try{localStorage.setItem("auth:userProfile",JSON.stringify(T))}catch{}if(T?.codigo_empresa){console.log("[AuthDebug] company: querying empresas by codigo from colaboradores",{codigo_empresa:T.codigo_empresa});const{data:D,error:F}=await pe.from("empresas").select("*").eq("codigo_empresa",T.codigo_empresa).single();if(F){if([401,403,406].includes(Number(F.status))&&A<_.length){await S(_[A]);continue}console.warn("[AuthDebug] company: load error; preserving previous company",{status:F.status,code:F.code,message:F.message});return}else{s(D);try{localStorage.setItem("auth:company",JSON.stringify(D))}catch{}console.log("[AuthDebug] company: set from colaboradores path")}}else console.warn("[AuthDebug] company: no codigo_empresa available on profile; preserving previous company");return}catch(M){if(console.error("[AuthDebug] loadUserProfile:unexpected error",{message:M?.message,code:M?.code,status:M?.status}),A<_.length){await S(_[A]);continue}console.error("Error loading user profile:",M);return}}}finally{m.current=!1}},w={user:t,userProfile:n,company:i,loading:l,authReady:d,signUp:async(j,_,S,k=null)=>{try{const{data:E,error:A}=await pe.auth.signUp({email:j,password:_});if(A)throw A;if(E?.user&&k){const{data:M,error:C}=await pe.from("empresas").select("id, codigo_empresa").eq("codigo_empresa",k).single();if(C)throw new Error("Cdigo de empresa invlido. Verifique o cdigo informado.");const{error:T}=await pe.from("colaboradores").insert({id:E.user.id,codigo_empresa:M.codigo_empresa,nome:S,cargo:"user",ativo:!0});if(T)throw T}return{data:E,error:null}}catch(E){let A="No foi possvel cadastrar. Verifique os dados e tente novamente.";const M=(E?.message||"").toLowerCase();return M.includes("user already registered")||M.includes("already registered")||M.includes("user already exists")?A="Email j cadastrado. Tente entrar ou redefinir a senha.":M.includes("password")&&M.includes("length")&&(A="Senha muito curta. Use ao menos 6 caracteres."),{data:null,error:new Error(A)}}},signIn:async(j,_)=>{try{if(h){const E=mye,A=hye,M=await fetch(`${E}/rest/v1/rpc/auth_login_dev`,{method:"POST",headers:{"Content-Type":"application/json",apikey:A,Authorization:`Bearer ${A}`},body:JSON.stringify({p_email:j,p_password:_})});if(!M.ok){const D=await M.text().catch(()=>"");let F="No foi possvel entrar. Tente novamente.";return M.status===401&&(F="Email ou senha invlidos."),M.status===423&&(F="Usurio bloqueado temporariamente."),{data:null,error:new Error(F+(D?` (${D})`:""))}}const T=(await M.json())?.access_token||"",I=(()=>{try{return JSON.parse(atob(T.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"))).sub}catch{return null}})();try{localStorage.setItem("custom-auth-token",T)}catch{}return I&&(r({id:I}),u(!0),await v(I),f.current=I),{data:{user:I?{id:I}:null},error:null}}const{data:S,error:k}=await pe.auth.signInWithPassword({email:j,password:_});if(k){let E="No foi possvel entrar. Tente novamente.";const A=(k.message||"").toLowerCase(),M=k.status;return A.includes("invalid login")||A.includes("invalid credentials")||M===400?E="Email ou senha invlidos.":A.includes("email not confirmed")||A.includes("not confirmed")?E="Email no confirmado. Verifique sua caixa de entrada.":M===429?E="Muitas tentativas. Aguarde alguns minutos e tente novamente.":M>=500&&(E="Servio indisponvel no momento. Tente novamente mais tarde."),{data:null,error:new Error(E)}}return S.user&&await pe.from("colaboradores").select("id").eq("id",S.user.id).single(),{data:S,error:null}}catch(S){return{data:null,error:S}}},signOut:async()=>{try{localStorage.removeItem("custom-auth-token")}catch{}try{const j=pe.auth.signOut({scope:"global"}),_=new Promise(S=>setTimeout(S,700));await Promise.race([j,_])}catch(j){console.warn("[AuthContext] signOut(): error during signOut",j?.message||j)}f.current=null,r(null),a(null),s(null),c(!1),u(!0);try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company"),localStorage.removeItem("clientes:list"),localStorage.removeItem("quadras:list"),localStorage.removeItem("agenda:courts"),localStorage.removeItem("agenda:selectedCourts"),localStorage.removeItem("agenda:viewFilter"),Object.keys(localStorage).filter(j=>j.startsWith("agenda:bookings:")).forEach(j=>localStorage.removeItem(j)),Object.keys(localStorage).filter(j=>j.startsWith("sb-")).forEach(j=>localStorage.removeItem(j)),Object.keys(sessionStorage).filter(j=>j.startsWith("sb-")).forEach(j=>sessionStorage.removeItem(j))}catch{}try{sessionStorage.setItem("auth:forceLogout","1")}catch{}try{window.location.replace("/")}catch{}return{error:null}},reloadCompany:async()=>{try{const j=n&&n.codigo_empresa?n.codigo_empresa:null;if(!j)return;const{data:_,error:S}=await pe.from("empresas").select("*").eq("codigo_empresa",j).single();if(!S&&_){s(_);try{localStorage.setItem("auth:company",JSON.stringify(_))}catch{}}}catch{}}};return o.jsx(JK.Provider,{value:w,children:e})};function Aa(e){"@babel/helpers - typeof";return Aa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aa(e)}function ai(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Pn(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function Jn(e){Pn(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||Aa(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Oa(e,t){Pn(2,arguments);var r=Jn(e),n=ai(t);return isNaN(n)?new Date(NaN):(n&&r.setDate(r.getDate()+n),r)}function Zd(e,t){Pn(2,arguments);var r=Jn(e),n=ai(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var a=r.getDate(),i=new Date(r.getTime());i.setMonth(r.getMonth()+n+1,0);var s=i.getDate();return a>=s?i:(r.setFullYear(i.getFullYear(),i.getMonth(),a),r)}function QK(e,t){Pn(2,arguments);var r=Jn(e).getTime(),n=ai(t);return new Date(r+n)}var gye={};function _h(){return gye}function vd(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=_h(),f=ai((r=(n=(a=(i=t?.weekStartsOn)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=Jn(e),h=m.getDay(),v=(h<f?7:0)+h-f;return m.setDate(m.getDate()-v),m.setHours(0,0,0,0),m}function Gp(e){return Pn(1,arguments),vd(e,{weekStartsOn:1})}function vye(e){Pn(1,arguments);var t=Jn(e),r=t.getFullYear(),n=new Date(0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);var a=Gp(n),i=new Date(0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);var s=Gp(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=s.getTime()?r:r-1}function xye(e){Pn(1,arguments);var t=vye(e),r=new Date(0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);var n=Gp(r);return n}function Ib(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function ti(e){Pn(1,arguments);var t=Jn(e);return t.setHours(0,0,0,0),t}var yye=864e5;function Su(e,t){Pn(2,arguments);var r=ti(e),n=ti(t),a=r.getTime()-Ib(r),i=n.getTime()-Ib(n);return Math.round((a-i)/yye)}var bye=6e4;function wye(e,t){Pn(2,arguments);var r=ai(t);return QK(e,r*bye)}function lO(e,t){Pn(2,arguments);var r=ai(t),n=r*7;return Oa(e,n)}function jye(e,t){Pn(2,arguments);var r=ai(t);return Zd(e,r*12)}function Nye(e){Pn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Aa(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var a=Jn(n);(r===void 0||r<a||isNaN(Number(a)))&&(r=a)}),r||new Date(NaN)}function _ye(e){Pn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Aa(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var a=Jn(n);(r===void 0||r>a||isNaN(a.getDate()))&&(r=a)}),r||new Date(NaN)}var ZK=6e4,eY=36e5;function zs(e,t){Pn(2,arguments);var r=ti(e),n=ti(t);return r.getTime()===n.getTime()}function EI(e){return Pn(1,arguments),e instanceof Date||Aa(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Sye(e){if(Pn(1,arguments),!EI(e)&&typeof e!="number")return!1;var t=Jn(e);return!isNaN(Number(t))}function Db(e,t){Pn(2,arguments);var r=Jn(e),n=Jn(t),a=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return a*12+i}var Cye=6048e5;function Pye(e,t,r){Pn(2,arguments);var n=vd(e,r),a=vd(t,r),i=n.getTime()-Ib(n),s=a.getTime()-Ib(a);return Math.round((i-s)/Cye)}function Q$(e,t){var r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function Aye(e,t){Pn(2,arguments);var r=Jn(e),n=Jn(t),a=Q$(r,n),i=Math.abs(Su(r,n));r.setDate(r.getDate()-a*i);var s=+(Q$(r,n)===-a),l=a*(i-s);return l===0?0:l}function Nj(e){Pn(1,arguments);var t=Jn(e);return t.setHours(23,59,59,999),t}function XS(e){Pn(1,arguments);var t=Jn(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function pl(e){Pn(1,arguments);var t=Jn(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Eye(e){Pn(1,arguments);var t=Jn(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function kI(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=_h(),f=ai((r=(n=(a=(i=t?.weekStartsOn)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=Jn(e),h=m.getDay(),v=(h<f?-7:0)+6-(h-f);return m.setDate(m.getDate()+v),m.setHours(23,59,59,999),m}function tY(e){return Pn(1,arguments),kI(e,{weekStartsOn:1})}function kye(e,t){Pn(2,arguments);var r=ai(t);return QK(e,-r)}var Oye=864e5;function Tye(e){Pn(1,arguments);var t=Jn(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),a=r-n;return Math.floor(a/Oye)+1}function CN(e){Pn(1,arguments);var t=1,r=Jn(e),n=r.getUTCDay(),a=(n<t?7:0)+n-t;return r.setUTCDate(r.getUTCDate()-a),r.setUTCHours(0,0,0,0),r}function rY(e){Pn(1,arguments);var t=Jn(e),r=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var a=CN(n),i=new Date(0);i.setUTCFullYear(r,0,4),i.setUTCHours(0,0,0,0);var s=CN(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=s.getTime()?r:r-1}function Iye(e){Pn(1,arguments);var t=rY(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var n=CN(r);return n}var Dye=6048e5;function Mye(e){Pn(1,arguments);var t=Jn(e),r=CN(t).getTime()-Iye(t).getTime();return Math.round(r/Dye)+1}function PN(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=_h(),f=ai((r=(n=(a=(i=t?.weekStartsOn)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=Jn(e),h=m.getUTCDay(),v=(h<f?7:0)+h-f;return m.setUTCDate(m.getUTCDate()-v),m.setUTCHours(0,0,0,0),m}function nY(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=Jn(e),f=u.getUTCFullYear(),m=_h(),h=ai((r=(n=(a=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:m.firstWeekContainsDate)!==null&&n!==void 0?n:(c=m.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setUTCFullYear(f+1,0,h),v.setUTCHours(0,0,0,0);var g=PN(v,t),x=new Date(0);x.setUTCFullYear(f,0,h),x.setUTCHours(0,0,0,0);var y=PN(x,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=y.getTime()?f:f-1}function Rye(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=_h(),f=ai((r=(n=(a=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),m=nY(e,t),h=new Date(0);h.setUTCFullYear(m,0,f),h.setUTCHours(0,0,0,0);var v=PN(h,t);return v}var Lye=6048e5;function $ye(e,t){Pn(1,arguments);var r=Jn(e),n=PN(r,t).getTime()-Rye(r,t).getTime();return Math.round(n/Lye)+1}function eo(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var Fye={y:function(t,r){var n=t.getUTCFullYear(),a=n>0?n:1-n;return eo(r==="yy"?a%100:a,r.length)},M:function(t,r){var n=t.getUTCMonth();return r==="M"?String(n+1):eo(n+1,2)},d:function(t,r){return eo(t.getUTCDate(),r.length)},a:function(t,r){var n=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(t,r){return eo(t.getUTCHours()%12||12,r.length)},H:function(t,r){return eo(t.getUTCHours(),r.length)},m:function(t,r){return eo(t.getUTCMinutes(),r.length)},s:function(t,r){return eo(t.getUTCSeconds(),r.length)},S:function(t,r){var n=r.length,a=t.getUTCMilliseconds(),i=Math.floor(a*Math.pow(10,n-3));return eo(i,r.length)}};const im=Fye;var $g={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Bye={G:function(t,r,n){var a=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});case"GGGG":default:return n.era(a,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){var a=t.getUTCFullYear(),i=a>0?a:1-a;return n.ordinalNumber(i,{unit:"year"})}return im.y(t,r)},Y:function(t,r,n,a){var i=nY(t,a),s=i>0?i:1-i;if(r==="YY"){var l=s%100;return eo(l,2)}return r==="Yo"?n.ordinalNumber(s,{unit:"year"}):eo(s,r.length)},R:function(t,r){var n=rY(t);return eo(n,r.length)},u:function(t,r){var n=t.getUTCFullYear();return eo(n,r.length)},Q:function(t,r,n){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(a);case"QQ":return eo(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,r,n){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(a);case"qq":return eo(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,r,n){var a=t.getUTCMonth();switch(r){case"M":case"MM":return im.M(t,r);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(t,r,n){var a=t.getUTCMonth();switch(r){case"L":return String(a+1);case"LL":return eo(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(t,r,n,a){var i=$ye(t,a);return r==="wo"?n.ordinalNumber(i,{unit:"week"}):eo(i,r.length)},I:function(t,r,n){var a=Mye(t);return r==="Io"?n.ordinalNumber(a,{unit:"week"}):eo(a,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):im.d(t,r)},D:function(t,r,n){var a=Tye(t);return r==="Do"?n.ordinalNumber(a,{unit:"dayOfYear"}):eo(a,r.length)},E:function(t,r,n){var a=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});case"EEEE":default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(t,r,n,a){var i=t.getUTCDay(),s=(i-a.weekStartsOn+8)%7||7;switch(r){case"e":return String(s);case"ee":return eo(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(t,r,n,a){var i=t.getUTCDay(),s=(i-a.weekStartsOn+8)%7||7;switch(r){case"c":return String(s);case"cc":return eo(s,r.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(t,r,n){var a=t.getUTCDay(),i=a===0?7:a;switch(r){case"i":return String(i);case"ii":return eo(i,r.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});case"iiii":default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(t,r,n){var a=t.getUTCHours(),i=a/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,r,n){var a=t.getUTCHours(),i;switch(a===12?i=$g.noon:a===0?i=$g.midnight:i=a/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,r,n){var a=t.getUTCHours(),i;switch(a>=17?i=$g.evening:a>=12?i=$g.afternoon:a>=4?i=$g.morning:i=$g.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){var a=t.getUTCHours()%12;return a===0&&(a=12),n.ordinalNumber(a,{unit:"hour"})}return im.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):im.H(t,r)},K:function(t,r,n){var a=t.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(a,{unit:"hour"}):eo(a,r.length)},k:function(t,r,n){var a=t.getUTCHours();return a===0&&(a=24),r==="ko"?n.ordinalNumber(a,{unit:"hour"}):eo(a,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):im.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):im.s(t,r)},S:function(t,r){return im.S(t,r)},X:function(t,r,n,a){var i=a._originalDate||t,s=i.getTimezoneOffset();if(s===0)return"Z";switch(r){case"X":return eF(s);case"XXXX":case"XX":return Qh(s);case"XXXXX":case"XXX":default:return Qh(s,":")}},x:function(t,r,n,a){var i=a._originalDate||t,s=i.getTimezoneOffset();switch(r){case"x":return eF(s);case"xxxx":case"xx":return Qh(s);case"xxxxx":case"xxx":default:return Qh(s,":")}},O:function(t,r,n,a){var i=a._originalDate||t,s=i.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+Z$(s,":");case"OOOO":default:return"GMT"+Qh(s,":")}},z:function(t,r,n,a){var i=a._originalDate||t,s=i.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+Z$(s,":");case"zzzz":default:return"GMT"+Qh(s,":")}},t:function(t,r,n,a){var i=a._originalDate||t,s=Math.floor(i.getTime()/1e3);return eo(s,r.length)},T:function(t,r,n,a){var i=a._originalDate||t,s=i.getTime();return eo(s,r.length)}};function Z$(e,t){var r=e>0?"-":"+",n=Math.abs(e),a=Math.floor(n/60),i=n%60;if(i===0)return r+String(a);var s=t||"";return r+String(a)+s+eo(i,2)}function eF(e,t){if(e%60===0){var r=e>0?"-":"+";return r+eo(Math.abs(e)/60,2)}return Qh(e,t)}function Qh(e,t){var r=t||"",n=e>0?"-":"+",a=Math.abs(e),i=eo(Math.floor(a/60),2),s=eo(a%60,2);return n+i+r+s}const qye=Bye;var tF=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},aY=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},zye=function(t,r){var n=t.match(/(P+)(p+)?/)||[],a=n[1],i=n[2];if(!i)return tF(t,r);var s;switch(a){case"P":s=r.dateTime({width:"short"});break;case"PP":s=r.dateTime({width:"medium"});break;case"PPP":s=r.dateTime({width:"long"});break;case"PPPP":default:s=r.dateTime({width:"full"});break}return s.replace("{{date}}",tF(a,r)).replace("{{time}}",aY(i,r))},Uye={p:aY,P:zye};const Vye=Uye;var Wye=["D","DD"],Hye=["YY","YYYY"];function Gye(e){return Wye.indexOf(e)!==-1}function Kye(e){return Hye.indexOf(e)!==-1}function rF(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Yye={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Xye=function(t,r,n){var a,i=Yye[t];return typeof i=="string"?a=i:r===1?a=i.one:a=i.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a};const Jye=Xye;function Fv(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var Qye={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Zye={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ebe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},tbe={date:Fv({formats:Qye,defaultWidth:"full"}),time:Fv({formats:Zye,defaultWidth:"full"}),dateTime:Fv({formats:ebe,defaultWidth:"full"})};const rbe=tbe;var nbe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},abe=function(t,r,n,a){return nbe[t]};const obe=abe;function wu(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",a;if(n==="formatting"&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,s=r!=null&&r.width?String(r.width):i;a=e.formattingValues[s]||e.formattingValues[i]}else{var l=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[l]}var d=e.argumentCallback?e.argumentCallback(t):t;return a[d]}}var ibe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},sbe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},lbe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},cbe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ube={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},fbe=function(t,r){var n=Number(t),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},mbe={ordinalNumber:fbe,era:wu({values:ibe,defaultWidth:"wide"}),quarter:wu({values:sbe,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:wu({values:lbe,defaultWidth:"wide"}),day:wu({values:cbe,defaultWidth:"wide"}),dayPeriod:wu({values:dbe,defaultWidth:"wide",formattingValues:ube,defaultFormattingWidth:"wide"})};const hbe=mbe;function ju(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;var s=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?gbe(l,function(f){return f.test(s)}):pbe(l,function(f){return f.test(s)}),d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;var u=t.slice(s.length);return{value:d,rest:u}}}function pbe(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function gbe(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function oY(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var a=n[0],i=t.match(e.parsePattern);if(!i)return null;var s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;var l=t.slice(a.length);return{value:s,rest:l}}}var vbe=/^(\d+)(th|st|nd|rd)?/i,xbe=/\d+/i,ybe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},bbe={any:[/^b/i,/^(a|c)/i]},wbe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},jbe={any:[/1/i,/2/i,/3/i,/4/i]},Nbe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},_be={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Sbe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Cbe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Pbe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Abe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ebe={ordinalNumber:oY({matchPattern:vbe,parsePattern:xbe,valueCallback:function(t){return parseInt(t,10)}}),era:ju({matchPatterns:ybe,defaultMatchWidth:"wide",parsePatterns:bbe,defaultParseWidth:"any"}),quarter:ju({matchPatterns:wbe,defaultMatchWidth:"wide",parsePatterns:jbe,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:ju({matchPatterns:Nbe,defaultMatchWidth:"wide",parsePatterns:_be,defaultParseWidth:"any"}),day:ju({matchPatterns:Sbe,defaultMatchWidth:"wide",parsePatterns:Cbe,defaultParseWidth:"any"}),dayPeriod:ju({matchPatterns:Pbe,defaultMatchWidth:"any",parsePatterns:Abe,defaultParseWidth:"any"})};const kbe=Ebe;var Obe={code:"en-US",formatDistance:Jye,formatLong:rbe,formatRelative:obe,localize:hbe,match:kbe,options:{weekStartsOn:0,firstWeekContainsDate:1}};const iY=Obe;var Tbe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ibe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Dbe=/^'([^]*?)'?$/,Mbe=/''/g,Rbe=/[a-zA-Z]/;function Xt(e,t,r){var n,a,i,s,l,c,d,u,f,m,h,v,g,x,y,b,w,j;Pn(2,arguments);var _=String(t),S=_h(),k=(n=(a=r?.locale)!==null&&a!==void 0?a:S.locale)!==null&&n!==void 0?n:iY,E=ai((i=(s=(l=(c=r?.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&l!==void 0?l:S.firstWeekContainsDate)!==null&&s!==void 0?s:(f=S.locale)===null||f===void 0||(m=f.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(E>=1&&E<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var A=ai((h=(v=(g=(x=r?.weekStartsOn)!==null&&x!==void 0?x:r==null||(y=r.locale)===null||y===void 0||(b=y.options)===null||b===void 0?void 0:b.weekStartsOn)!==null&&g!==void 0?g:S.weekStartsOn)!==null&&v!==void 0?v:(w=S.locale)===null||w===void 0||(j=w.options)===null||j===void 0?void 0:j.weekStartsOn)!==null&&h!==void 0?h:0);if(!(A>=0&&A<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!k.localize)throw new RangeError("locale must contain localize property");if(!k.formatLong)throw new RangeError("locale must contain formatLong property");var M=Jn(e);if(!Sye(M))throw new RangeError("Invalid time value");var C=Ib(M),T=kye(M,C),I={firstWeekContainsDate:E,weekStartsOn:A,locale:k,_originalDate:M},D=_.match(Ibe).map(function(F){var z=F[0];if(z==="p"||z==="P"){var q=Vye[z];return q(F,k.formatLong)}return F}).join("").match(Tbe).map(function(F){if(F==="''")return"'";var z=F[0];if(z==="'")return Lbe(F);var q=qye[z];if(q)return!(r!=null&&r.useAdditionalWeekYearTokens)&&Kye(F)&&rF(F,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&Gye(F)&&rF(F,t,String(e)),q(T,F,k.localize,I);if(z.match(Rbe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+z+"`");return F}).join("");return D}function Lbe(e){var t=e.match(Dbe);return t?t[1].replace(Mbe,"'"):e}function $be(e){Pn(1,arguments);var t=Jn(e),r=t.getFullYear(),n=t.getMonth(),a=new Date(0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function fu(e){Pn(1,arguments);var t=Jn(e),r=t.getHours();return r}var Fbe=6048e5;function Bbe(e){Pn(1,arguments);var t=Jn(e),r=Gp(t).getTime()-xye(t).getTime();return Math.round(r/Fbe)+1}function mu(e){Pn(1,arguments);var t=Jn(e),r=t.getMinutes();return r}function qbe(e){Pn(1,arguments);var t=Jn(e),r=t.getTime();return r}function zbe(e){return Pn(1,arguments),Math.floor(qbe(e)/1e3)}function Ube(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=Jn(e),f=u.getFullYear(),m=_h(),h=ai((r=(n=(a=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:m.firstWeekContainsDate)!==null&&n!==void 0?n:(c=m.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setFullYear(f+1,0,h),v.setHours(0,0,0,0);var g=vd(v,t),x=new Date(0);x.setFullYear(f,0,h),x.setHours(0,0,0,0);var y=vd(x,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=y.getTime()?f:f-1}function Vbe(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=_h(),f=ai((r=(n=(a=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),m=Ube(e,t),h=new Date(0);h.setFullYear(m,0,f),h.setHours(0,0,0,0);var v=vd(h,t);return v}var Wbe=6048e5;function Hbe(e,t){Pn(1,arguments);var r=Jn(e),n=vd(r,t).getTime()-Vbe(r,t).getTime();return Math.round(n/Wbe)+1}function Gbe(e){Pn(1,arguments);var t=Jn(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Kbe(e,t){return Pn(1,arguments),Pye(Gbe(e),pl(e),t)+1}function cO(e,t){Pn(2,arguments);var r=Jn(e),n=Jn(t);return r.getTime()>n.getTime()}function sY(e,t){Pn(2,arguments);var r=Jn(e),n=Jn(t);return r.getTime()<n.getTime()}function nF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ybe(e,t){if(e){if(typeof e=="string")return nF(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nF(e,t):void 0}}function dO(e,t){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},dO(e,t)}function Xbe(e,t){if(Aa(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Aa(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jbe(e){var t=Xbe(e,"string");return Aa(t)=="symbol"?t:t+""}function Qbe(e,t,r){return(t=Jbe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OI(e,t){Pn(2,arguments);var r=Jn(e),n=Jn(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Zbe(e,t){Pn(2,arguments);var r=Jn(e),n=Jn(t);return r.getFullYear()===n.getFullYear()}function By(e,t){Pn(2,arguments);var r=ai(t);return Oa(e,-r)}function aF(e,t){var r;Pn(1,arguments);var n=ai((r=t?.additionalDigits)!==null&&r!==void 0?r:2);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var a=n1e(e),i;if(a.date){var s=a1e(a.date,n);i=o1e(s.restDateString,s.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);var l=i.getTime(),c=0,d;if(a.time&&(c=i1e(a.time),isNaN(c)))return new Date(NaN);if(a.timezone){if(d=s1e(a.timezone),isNaN(d))return new Date(NaN)}else{var u=new Date(l+c),f=new Date(0);return f.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),f.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),f}return new Date(l+c+d)}var b2={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},e1e=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,t1e=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,r1e=/^([+-])(\d{2})(?::?(\d{2}))?$/;function n1e(e){var t={},r=e.split(b2.dateTimeDelimiter),n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],b2.timeZoneDelimiter.test(t.date)&&(t.date=e.split(b2.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){var a=b2.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function a1e(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};var a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((n[1]||n[2]).length)}}function o1e(e,t){if(t===null)return new Date(NaN);var r=e.match(e1e);if(!r)return new Date(NaN);var n=!!r[4],a=V0(r[1]),i=V0(r[2])-1,s=V0(r[3]),l=V0(r[4]),c=V0(r[5])-1;if(n)return f1e(t,l,c)?l1e(t,l,c):new Date(NaN);var d=new Date(0);return!d1e(t,i,s)||!u1e(t,a)?new Date(NaN):(d.setUTCFullYear(t,i,Math.max(a,s)),d)}function V0(e){return e?parseInt(e):1}function i1e(e){var t=e.match(t1e);if(!t)return NaN;var r=JP(t[1]),n=JP(t[2]),a=JP(t[3]);return m1e(r,n,a)?r*eY+n*ZK+a*1e3:NaN}function JP(e){return e&&parseFloat(e.replace(",","."))||0}function s1e(e){if(e==="Z")return 0;var t=e.match(r1e);if(!t)return 0;var r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return h1e(n,a)?r*(n*eY+a*ZK):NaN}function l1e(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var a=n.getUTCDay()||7,i=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}var c1e=[31,null,31,30,31,30,31,31,30,31,30,31];function lY(e){return e%400===0||e%4===0&&e%100!==0}function d1e(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(c1e[t]||(lY(e)?29:28))}function u1e(e,t){return t>=1&&t<=(lY(e)?366:365)}function f1e(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function m1e(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function h1e(e,t){return t>=0&&t<=59}function QP(e,t){Pn(2,arguments);var r=Jn(e),n=ai(t),a=r.getFullYear(),i=r.getDate(),s=new Date(0);s.setFullYear(a,n,15),s.setHours(0,0,0,0);var l=$be(s);return r.setMonth(n,Math.min(i,l)),r}function w2(e,t){Pn(2,arguments);var r=Jn(e),n=ai(t);return r.setHours(n),r}function j2(e,t){Pn(2,arguments);var r=Jn(e),n=ai(t);return r.setMinutes(n),r}function oF(e,t){Pn(2,arguments);var r=Jn(e),n=ai(t);return isNaN(r.getTime())?new Date(NaN):(r.setFullYear(n),r)}const cY=p.createContext(),p1e=({children:e})=>{const{userProfile:t}=Do(),r=ki(),[n,a]=p.useState([]),[i,s]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(!1),f=p.useRef(r.pathname),m=p.useCallback(()=>document.querySelectorAll('[role="dialog"]').length>0,[]),h=p.useCallback(async()=>{if(t?.codigo_empresa)try{u(!0);const v=t.codigo_empresa,g=new Date,x=ti(g).toISOString(),y=Nj(g).toISOString(),b=[],{data:w}=await pe.from("produtos").select("nome, estoque, estoque_minimo, status").eq("codigo_empresa",v).not("estoque_minimo","is",null),j=(w||[]).filter(z=>{const q=Number(z.estoque||0),$=Number(z.estoque_minimo||0);return q<=$&&$>0});j.length>0&&b.push({tipo:"estoque",icone:"Package",cor:"danger",mensagem:`${j.length} produto${j.length>1?"s":""} com estoque baixo`,link:"/produtos"});const{data:_}=await pe.from("agendamento_participantes").select("id, agendamento_id").eq("codigo_empresa",v).eq("status_pagamento","Pendente");if(_&&_.length>0){const z=[...new Set(_.map(ce=>ce.agendamento_id))],{data:q}=await pe.from("agendamentos").select("id, inicio, status").in("id",z).not("status","in","(canceled,absent)").order("inicio",{ascending:!0}),$=new Set((q||[]).map(ce=>ce.id)),K=_.filter(ce=>$.has(ce.agendamento_id));if(K.length>0){const ce=q?.[0],fe=Xt(ce?new Date(ce.inicio):g,"yyyy-MM-dd");b.push({tipo:"pagamento",icone:"DollarSign",cor:"warning",mensagem:`${K.length} pagamento${K.length>1?"s":""} pendente${K.length>1?"s":""} em agendamentos`,link:`/agenda?date=${fe}`})}}const S=new Date;S.setHours(S.getHours()-3);const{data:k}=await pe.from("comandas").select("id, aberto_em, status").eq("codigo_empresa",v).eq("status","open").is("fechado_em",null).lte("aberto_em",S.toISOString());k&&k.length>0&&b.push({tipo:"comanda",icone:"Clock",cor:"warning",mensagem:`${k.length} comanda${k.length>1?"s":""} aberta${k.length>1?"s":""} h mais de 3 horas`,link:"/vendas"});const E=new Date;E.setHours(E.getHours()-12);const{data:A}=await pe.from("caixa_sessoes").select("id, aberto_em").eq("codigo_empresa",v).eq("status","open").lte("aberto_em",E.toISOString()).limit(1);A&&A.length>0&&b.push({tipo:"caixa",icone:"ShoppingCart",cor:"danger",mensagem:"Caixa aberto h mais de 12 horas",link:"/vendas"});const{data:M}=await pe.from("mesas").select("id, nome, numero").eq("codigo_empresa",v).eq("status","awaiting-payment");if(M&&M.length>0){const z=M.map($=>$.id),{data:q}=await pe.from("comandas").select("id, mesa_id").eq("codigo_empresa",v).in("mesa_id",z).eq("status","open");if(q&&q.length>0){const $=q.map(B=>B.id),{data:K}=await pe.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",$),ce={};(K||[]).forEach(B=>{const L=(Number(B.quantidade)||0)*(Number(B.preco_unitario)||0),V=Number(B.desconto)||0,re=L-V;ce[B.comanda_id]=(ce[B.comanda_id]||0)+re});const fe=Object.values(ce).filter(B=>B>100).length;fe>0&&b.push({tipo:"mesa",icone:"Store",cor:"info",mensagem:`${fe} mesa${fe>1?"s":""} com saldo alto aguardando pagamento`,link:"/vendas"})}}const{data:C}=await pe.from("clientes").select("id, nome, aniversario").eq("codigo_empresa",v).eq("status","Ativo").not("aniversario","is",null),T=Xt(g,"MM-dd"),I=(C||[]).filter(z=>z.aniversario?Xt(new Date(z.aniversario),"MM-dd")===T:!1);I.length>0&&b.push({tipo:"aniversario",icone:"Users",cor:"success",mensagem:` ${I.length} aniversariante${I.length>1?"s":""} hoje!`,link:"/clientes"});const D=[];for(let z=1;z<=7;z++){const q=new Date(g);q.setDate(q.getDate()+z),D.push(Xt(q,"MM-dd"))}const F=(C||[]).filter(z=>{if(!z.aniversario)return!1;const q=Xt(new Date(z.aniversario),"MM-dd");return D.includes(q)});F.length>0&&b.push({tipo:"aniversario-semana",icone:"CalendarPlus",cor:"purple",mensagem:` ${F.length} aniversariante${F.length>1?"s":""} esta semana`,link:"/clientes"}),a(b)}catch(v){console.error("[AlertsContext] Erro ao carregar alertas:",v)}finally{u(!1)}},[t?.codigo_empresa]);return p.useEffect(()=>{if(t?.codigo_empresa){h();const v=setInterval(()=>{h()},5*60*1e3);return()=>clearInterval(v)}},[t?.codigo_empresa,h]),p.useEffect(()=>{if(!t?.codigo_empresa)return;const v=()=>{if(document.visibilityState==="visible"){if(m())return;h()}},g=()=>{m()||h()};return document.addEventListener("visibilitychange",v),window.addEventListener("focus",g),()=>{document.removeEventListener("visibilitychange",v),window.removeEventListener("focus",g)}},[t?.codigo_empresa,h,m]),p.useEffect(()=>{if(t?.codigo_empresa){if(f.current===r.pathname)return;if(f.current=r.pathname,m()){console.log("[AlertsContext] Mudana de rota detectada, mas h modais abertos - ignorando recarga");return}console.log("[AlertsContext] Mudana de rota detectada - recarregando alertas"),h()}},[r.pathname,t?.codigo_empresa,h,m]),o.jsx(cY.Provider,{value:{alerts:n,setAlerts:a,showModal:i,setShowModal:s,showBalloon:l,setShowBalloon:c,loading:d,loadAlerts:h},children:e})},JS=()=>{const e=p.useContext(cY);if(!e)throw new Error("useAlerts must be used within AlertsProvider");return e};function g1e({onToggleSidebar:e,sidebarVisible:t,sidebarPinned:r}){const{toast:n}=ro(),{signOut:a,userProfile:i,company:s,user:l}=Do(),{alerts:c,showModal:d,setShowModal:u}=JS(),f=Fl(),m=i?.nome||"Usurio",h=xe.useMemo(()=>{const T=m.trim().split(/\s+/);return T.length>=2?`${T[0]} ${T[1]}`:m},[m]),v=i?.cargo||i?.papel||"";let g="";try{const T=localStorage.getItem("auth:company");if(T){const I=JSON.parse(T);g=I?.nome_fantasia||I?.razao_social||I?.nome||I?.codigoEmpresa||"";var x=I?.logo_url||""}}catch{}const y=s?.nome_fantasia||s?.razao_social||s?.nome||s?.codigoEmpresa||g||"Empresa no vinculada",b=s?.logo_url||(typeof x<"u"?x:""),w=xe.useMemo(()=>s?.logo_url?`${s.logo_url}?v=${Date.now()}`:b||"",[s?.logo_url]),j=xe.useMemo(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}},[]),_=T=>({Package:gd,DollarSign:Ui,CalendarCheck:qT,Clock:dd,ShoppingCart:U1,Store:VT,Users:cl,CalendarPlus:zT,AlertTriangle:Of,Info:hH})[T]||Of,S=T=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[T]||"text-warning",k=({alert:T,onClick:I})=>{const D=_(T.icone),F=S(T.cor);return o.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:I,children:[o.jsx(D,{className:`w-4 h-4 flex-shrink-0 ${F}`}),o.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:T.mensagem}),T.link&&o.jsx(FT,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})},E=async()=>{console.log("[Header] Logout button clicked",{at:new Date().toISOString(),userBefore:!!l});const{error:T}=await a();console.log("[Header] Logout completed",{error:T,userAfter:!!l}),n(T?{title:"Erro ao sair",description:"Ocorreu um erro ao fazer logout. Tente novamente.",variant:"destructive"}:{title:"Logout realizado",description:"Voc foi desconectado com sucesso.",variant:"default"})};new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"});const A=ki(),M=xe.useMemo(()=>{try{const T=String(A?.pathname||"");if(T==="/"||T.startsWith("/dashboard"))return"";const D=[{key:"/agenda",label:"Agenda"},{key:"/isis",label:"sis"},{key:"/clientes",label:"Clientes & Fornecedores"},{key:"/produtos",label:"Produtos"},{key:"/vendas",label:"Vendas"},{key:"/financeiro",label:"Financeiro"},{key:"/balcao",label:"Balco"},{key:"/cadastros",label:"Cadastros"},{key:"/quadras",label:"Quadras"},{key:"/equipe",label:"Equipe"},{key:"/finalizadoras",label:"Finalizadoras"},{key:"/empresas",label:"Empresas"},{key:"/configuracoes",label:"Configuraes"},{key:"/login",label:"Login"}].find(F=>T.startsWith(F.key));if(D)return D.label;if(typeof document<"u"){const F=String(document.title||"");return(F.includes(" - ")?F.split(" - ")[0]:F)||""}}catch{}return""},[A?.pathname]),C=xe.useMemo(()=>String(A?.pathname||"").startsWith("/isis"),[A?.pathname]);return o.jsxs(fr.header,{animate:{opacity:1,y:0},transition:{duration:.6,ease:[.22,1,.36,1]},className:"relative bg-surface/80 backdrop-blur-sm text-text-primary h-[72px] flex-shrink-0 flex items-center justify-between px-8 border-b border-border shadow-[0_1px_0_RGBA(255,255,255,0.04)]",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx(le,{variant:"ghost",size:"icon",onClick:e,"aria-label":t?"Ocultar barra lateral":"Mostrar barra lateral",className:"h-12 w-12 hover:bg-surface-2/60 transition-colors",children:o.jsx(uue,{className:`w-7 h-7 transition-colors ${t?"text-brand":"text-text-primary"}`})}),o.jsxs("div",{className:"group pl-3 pr-5 py-1.5 border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary flex items-center gap-4 shadow-sm hover:border-white/20 transition-colors",title:y,children:[o.jsx("div",{className:"relative w-11 h-11 shrink-0 overflow-hidden border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)]",children:w?o.jsx("img",{src:w,alt:"Logo",className:"w-full h-full object-cover"}):o.jsx(Gde,{className:"w-6 h-6 opacity-80"})}),o.jsx("span",{className:"tracking-tight max-w-[240px] md:max-w-[320px] truncate leading-[44px] text-base text-text-primary font-semibold",children:y}),j&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-extrabold uppercase tracking-wider bg-red-600 text-white shadow animate-pulse",children:"Dev"})]})]}),C?o.jsx("div",{className:"pointer-events-none absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)] w-8 h-8",children:o.jsx("div",{className:"rounded-full overflow-hidden bg-background w-full h-full",children:o.jsx(ud,{size:"xs",className:"w-8 h-8"})})}),o.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:"sis"})]})}):M?o.jsx("div",{className:"pointer-events-none absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:o.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:M})}):null,o.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[!C&&o.jsxs(le,{variant:"ghost",onClick:()=>f("/isis"),className:"hidden md:inline-flex items-center gap-2 px-2.5 py-1.5 rounded-full border border-white/10 bg-surface/60 hover:bg-surface-2/70 hover:border-white/20 transition-all duration-200 hover:-translate-y-px hover:shadow-[0_4px_16px_rgba(0,0,0,0.25)]",children:[o.jsx("span",{className:"inline-flex items-center justify-center rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400",children:o.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:o.jsx(ud,{size:"xs"})})}),o.jsx("span",{className:"text-sm font-semibold text-text-primary",children:"sis"})]}),o.jsxs(le,{variant:"ghost",size:"icon",onClick:()=>u(!0),className:"relative text-text-secondary hover:text-text-primary transition-colors duration-200",children:[o.jsx(uN,{className:"h-5 w-5"}),c.length>0&&o.jsx("span",{className:"absolute -top-1 -right-1 bg-danger text-white text-[10px] font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:c.length})]}),o.jsx(le,{variant:"ghost",size:"icon",onClick:E,className:"text-text-secondary hover:text-brand hover:bg-brand/10 transition-colors duration-200 shrink-0",children:o.jsx(due,{className:"h-5 w-5"})}),o.jsx("div",{className:"w-px h-8 bg-border mx-1 md:mx-2"}),o.jsxs("div",{className:"group pl-2 pr-3 md:pl-4 md:pr-4 py-1.5 rounded-full border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary flex items-center gap-2 md:gap-3 shadow-sm hover:border-white/20 transition-colors",title:`${h}  ${v}`,children:[o.jsx("span",{className:"text-xs md:text-sm font-semibold truncate max-w-[120px] md:max-w-[180px]",children:h}),o.jsx("span",{className:"text-[10px] md:text-[11px] px-1.5 md:px-2 py-0.5 rounded-full bg-brand/15 text-brand font-medium tracking-wide",children:v})]})]}),o.jsx(ln,{open:d,onOpenChange:u,children:o.jsxs(sn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[o.jsx(an,{children:o.jsxs(nn,{className:"flex items-center gap-2",children:[o.jsx(uN,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",c.length,")"]})}),o.jsx("div",{className:"mt-4",children:c.length===0?o.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):o.jsx("ul",{className:"space-y-2 text-sm",children:c.map((T,I)=>o.jsx(k,{alert:T,onClick:()=>{T.link&&(f(T.link),u(!1))}},I))})})]})})]})}const ir=xe.forwardRef(({className:e,type:t,...r},n)=>o.jsx("input",{type:t,className:Jt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));ir.displayName="Input";var v1e="Label",dY=p.forwardRef((e,t)=>o.jsx(Hn.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));dY.displayName=v1e;var uY=dY;const x1e=hI("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ht=xe.forwardRef(({className:e,...t},r)=>o.jsx(uY,{ref:r,className:Jt(x1e(),e),...t}));Ht.displayName=uY.displayName;const y1e=e=>{const t={"Invalid login credentials":"Email ou senha incorretos","Email not confirmed":"Email no confirmado","User not found":"Usurio no encontrado","Invalid email":"Email invlido","Password should be at least 6 characters":"A senha deve ter pelo menos 6 caracteres","Unable to validate email address: invalid format":"Formato de email invlido","Email rate limit exceeded":"Muitas tentativas. Aguarde alguns minutos","Network request failed":"Erro de conexo. Verifique sua internet","Failed to fetch":"Erro de conexo. Verifique sua internet"};if(t[e])return t[e];for(const[r,n]of Object.entries(t))if(e.includes(r))return n;return"Erro ao fazer login. Verifique suas credenciais e tente novamente."},b1e=()=>{const[e,t]=p.useState(!1),[r,n]=p.useState(!1),[a,i]=p.useState(""),[s,l]=p.useState({email:"",password:""}),{signIn:c,user:d,authReady:u}=Do(),{toast:f}=ro();p.useEffect(()=>{if(u&&d)try{const x=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const y=x||"/";console.log("[LoginPage] Redirecionando para:",y),window.location.replace(y)}catch{}},[u,!!d]);const m=x=>{l({...s,[x.target.name]:x.target.value}),a&&i("")},h=async x=>{x.preventDefault(),n(!0),i("");try{const y=await c(s.email,s.password);if(y.error)throw y.error;f({title:"Login realizado!",description:"Bem-vindo de volta!",variant:"default"});try{const b=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const w=b||"/";console.log("[LoginPage] Redirecionando aps login para:",w),window.location.replace(w)}catch{}}catch(y){const b=y.message||"Ocorreu um erro. Tente novamente.",w=y1e(b);i(w),f({title:"Erro",description:w,variant:"destructive"})}finally{n(!1)}},v={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}},g=(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}})();return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 sm:p-6 relative",children:[g&&o.jsx("div",{className:"pointer-events-none select-none absolute top-4 right-4 z-20",children:o.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-extrabold uppercase tracking-wider bg-red-600 text-white shadow animate-pulse",children:"Dev"})}),o.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.02] mix-blend-overlay"}),o.jsxs(fr.div,{variants:v,initial:"hidden",animate:"visible",className:"relative z-10 w-full max-w-md pb-20 sm:pb-0",children:[o.jsxs("div",{className:"fx-card",children:[o.jsx("div",{className:"text-center mb-6",children:o.jsxs("div",{className:"flex items-center justify-center mb-4",children:[o.jsx("div",{className:"w-16 h-16 bg-brand rounded-xl flex items-center justify-center mr-4",children:o.jsx(nd,{className:"w-8 h-8 text-primary-foreground"})}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-5xl font-extrabold",children:[o.jsx("span",{style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{style:{color:"#FFAA33"},children:"7"})]}),o.jsx("p",{className:"text-2xl font-semibold",style:{color:"#B0B0B0"},children:"Arena"})]})]})}),o.jsxs("form",{onSubmit:h,className:"space-y-5 sm:space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ht,{htmlFor:"email",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[o.jsx(lx,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Email"]}),o.jsx(ir,{id:"email",name:"email",type:"email",placeholder:"seu@email.com",value:s.email,onChange:m,required:!0,className:"placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ht,{htmlFor:"password",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[o.jsx(sx,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Senha"]}),o.jsxs("div",{className:"relative",children:[o.jsx(ir,{id:"password",name:"password",type:e?"text":"password",placeholder:"Sua senha",value:s.password,onChange:m,required:!0,className:"pr-10 placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"}),o.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary transition-colors",children:e?o.jsx(Pp,{className:"w-5 h-5 sm:w-4 sm:h-4"}):o.jsx(Vp,{className:"w-5 h-5 sm:w-4 sm:h-4"})})]})]}),a&&o.jsx(fr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 rounded-lg bg-destructive/10 border border-destructive/30 text-destructive text-sm",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-base",children:""}),o.jsx("span",{className:"flex-1",children:a})]})}),o.jsx(le,{type:"submit",className:"w-full h-12 sm:h-10 text-base sm:text-sm",disabled:r,children:r?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 border-2 border-primary-foreground border-t-transparent rounded-full animate-spin"}),"Entrando..."]}):o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(cue,{className:"w-4 h-4"}),"Entrar"]})})]})]}),o.jsx("p",{className:"mt-4 text-center text-xs text-text-muted opacity-70",children:" 2025 Fluxo7 Arena  Todos os direitos reservados."})]})]})})},iF=({children:e})=>{const{user:t,authReady:r}=Do(),n=ki();return p.useEffect(()=>{if(r&&!t&&n.pathname!=="/login")try{sessionStorage.setItem("auth:returnUrl",n.pathname+n.search),console.log("[ProtectedRoute] Salvando rota de retorno:",n.pathname+n.search)}catch(a){console.warn("[ProtectedRoute] Erro ao salvar rota de retorno:",a)}},[r,t,n.pathname,n.search]),r?t?e:o.jsx(b1e,{}):o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 border-4 border-brand border-t-transparent rounded-full animate-spin"}),o.jsx("span",{className:"text-text-primary font-medium",children:"Carregando..."})]})})},w1e=p.createContext(),j1e=({children:e})=>{const[t,r]=p.useState({payment:{open:!1,data:null},editParticipant:{open:!1,data:null}}),[n,a]=p.useState(new Set),i=p.useCallback((f,m=null)=>{console.log(" [MODALS] Abrindo modal:",f,m),r(h=>({...h,[f]:{open:!0,data:m}}))},[]),s=p.useCallback(f=>{if(n.has(f)){console.log(` [ModalsContext] Modal "${f}" est protegido, ignorando fechamento`);return}r(m=>({...m,[f]:{open:!1,data:{}}}))},[n]),l=p.useCallback(f=>t[f]?.open||!1,[t]),c=p.useCallback(f=>t[f]?.data||{},[t]),d=p.useCallback(f=>{console.log(` [ModalsContext] Protegendo modal "${f}"`),a(m=>new Set([...m,f]))},[]),u=p.useCallback(f=>{console.log(` [ModalsContext] Desprotegendo modal "${f}"`),a(m=>{const h=new Set(m);return h.delete(f),h})},[]);return o.jsx(w1e.Provider,{value:{openModal:i,closeModal:s,isModalOpen:l,getModalData:c,protectModal:d,unprotectModal:u},children:e})},fY=p.createContext(),AN=()=>{const e=p.useContext(fY);if(!e)throw new Error("useAgenda must be used within AgendaProvider");return e},N1e=({children:e})=>{const[t,r]=p.useState(!1),[n,a]=p.useState(!1),[i,s]=p.useState(!1),[l,c]=p.useState({participantId:null,participantName:""}),[d,u]=p.useState(null),[f,m]=p.useState([]),[h,v]=p.useState(""),[g,x]=p.useState([]),[y,b]=p.useState(null),[w,j]=p.useState([]),_=p.useRef({isProtected:!1,protectedUntil:0}),S=p.useRef(Date.now()),k=p.useRef(null),E=ki(),A=p.useCallback((F=2e3)=>{const z=Date.now()+F;if(z>_.current.protectedUntil)_.current.isProtected=!0,_.current.protectedUntil=z;else return;setTimeout(()=>{Date.now()>=_.current.protectedUntil&&(_.current.isProtected=!1)},F)},[]),M=p.useCallback(()=>{r(!0)},[]),C=p.useCallback(()=>{const F=Date.now();if(_.current.isProtected&&F<_.current.protectedUntil){const q=_.current.protectedUntil-F;try{localStorage.getItem("debug:agenda")==="1"&&console.log(` [PaymentModal] Fechamento bloqueado por proteo (${q}ms restantes)`)}catch{}return!1}if(Date.now()-S.current<500){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechamento bloqueado por mudana de visibilidade recente")}catch{}return!1}try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechando modal (no protegido)")}catch{}return r(!1),!0},[]),T=p.useCallback((F,z)=>{c({participantId:F,participantName:z}),a(!0),A(3e3)},[A]),I=p.useCallback(()=>{a(!1),c({participantId:null,participantName:""})},[]);p.useEffect(()=>{if(!(E?.pathname||"").startsWith("/agenda"))return()=>{};const q=()=>{const K=Date.now(),ce=document.hidden;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] visibilitychange:",{hidden:ce,timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(S.current=K,!ce&&t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Aba restaurada com modal aberto - protegendo por 3s")}catch{}const fe=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=fe}},$=()=>{const K=Date.now();try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] window focus:",{timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(S.current=K,t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Janela ganhou foco com modal aberto - protegendo por 3s")}catch{}const ce=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=ce}};return document.addEventListener("visibilitychange",q),window.addEventListener("focus",$),()=>{document.removeEventListener("visibilitychange",q),window.removeEventListener("focus",$)}},[t,E?.pathname]);const D={isPaymentModalOpen:t,isEditParticipantModalOpen:n,isAddBookingModalOpen:i,openPaymentModal:M,closePaymentModal:C,openEditParticipantModal:T,closeEditParticipantModal:I,setIsAddBookingModalOpen:s,editParticipantData:l,editingBooking:d,setEditingBooking:u,participantsForm:f,setParticipantsForm:m,paymentTotal:h,setPaymentTotal:v,payMethods:g,setPayMethods:x,bookingForm:y,setBookingForm:b,localCustomers:w,setLocalCustomers:j,protectPaymentModal:A,onParticipantReplacedRef:k,get lastVisibilityChangeTime(){return S.current},get isModalProtected(){const F=Date.now();return _.current.isProtected&&F<_.current.protectedUntil}};return o.jsx(fY.Provider,{value:D,children:e})};var _1e=Array.isArray,Bl=_1e,S1e=typeof qs=="object"&&qs&&qs.Object===Object&&qs,mY=S1e,C1e=mY,P1e=typeof self=="object"&&self&&self.Object===Object&&self,A1e=C1e||P1e||Function("return this")(),Vu=A1e,E1e=Vu,k1e=E1e.Symbol,J1=k1e,sF=J1,hY=Object.prototype,O1e=hY.hasOwnProperty,T1e=hY.toString,W0=sF?sF.toStringTag:void 0;function I1e(e){var t=O1e.call(e,W0),r=e[W0];try{e[W0]=void 0;var n=!0}catch{}var a=T1e.call(e);return n&&(t?e[W0]=r:delete e[W0]),a}var D1e=I1e,M1e=Object.prototype,R1e=M1e.toString;function L1e(e){return R1e.call(e)}var $1e=L1e,lF=J1,F1e=D1e,B1e=$1e,q1e="[object Null]",z1e="[object Undefined]",cF=lF?lF.toStringTag:void 0;function U1e(e){return e==null?e===void 0?z1e:q1e:cF&&cF in Object(e)?F1e(e):B1e(e)}var Wf=U1e;function V1e(e){return e!=null&&typeof e=="object"}var Hf=V1e,W1e=Wf,H1e=Hf,G1e="[object Symbol]";function K1e(e){return typeof e=="symbol"||H1e(e)&&W1e(e)==G1e}var n0=K1e,Y1e=Bl,X1e=n0,J1e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q1e=/^\w*$/;function Z1e(e,t){if(Y1e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||X1e(e)?!0:Q1e.test(e)||!J1e.test(e)||t!=null&&e in Object(t)}var TI=Z1e;function ewe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Sh=ewe;const a0=Ba(Sh);var twe=Wf,rwe=Sh,nwe="[object AsyncFunction]",awe="[object Function]",owe="[object GeneratorFunction]",iwe="[object Proxy]";function swe(e){if(!rwe(e))return!1;var t=twe(e);return t==awe||t==owe||t==nwe||t==iwe}var II=swe;const Vn=Ba(II);var lwe=Vu,cwe=lwe["__core-js_shared__"],dwe=cwe,ZP=dwe,dF=function(){var e=/[^.]+$/.exec(ZP&&ZP.keys&&ZP.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function uwe(e){return!!dF&&dF in e}var fwe=uwe,mwe=Function.prototype,hwe=mwe.toString;function pwe(e){if(e!=null){try{return hwe.call(e)}catch{}try{return e+""}catch{}}return""}var pY=pwe,gwe=II,vwe=fwe,xwe=Sh,ywe=pY,bwe=/[\\^$.*+?()[\]{}|]/g,wwe=/^\[object .+?Constructor\]$/,jwe=Function.prototype,Nwe=Object.prototype,_we=jwe.toString,Swe=Nwe.hasOwnProperty,Cwe=RegExp("^"+_we.call(Swe).replace(bwe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Pwe(e){if(!xwe(e)||vwe(e))return!1;var t=gwe(e)?Cwe:wwe;return t.test(ywe(e))}var Awe=Pwe;function Ewe(e,t){return e?.[t]}var kwe=Ewe,Owe=Awe,Twe=kwe;function Iwe(e,t){var r=Twe(e,t);return Owe(r)?r:void 0}var pg=Iwe,Dwe=pg,Mwe=Dwe(Object,"create"),QS=Mwe,uF=QS;function Rwe(){this.__data__=uF?uF(null):{},this.size=0}var Lwe=Rwe;function $we(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Fwe=$we,Bwe=QS,qwe="__lodash_hash_undefined__",zwe=Object.prototype,Uwe=zwe.hasOwnProperty;function Vwe(e){var t=this.__data__;if(Bwe){var r=t[e];return r===qwe?void 0:r}return Uwe.call(t,e)?t[e]:void 0}var Wwe=Vwe,Hwe=QS,Gwe=Object.prototype,Kwe=Gwe.hasOwnProperty;function Ywe(e){var t=this.__data__;return Hwe?t[e]!==void 0:Kwe.call(t,e)}var Xwe=Ywe,Jwe=QS,Qwe="__lodash_hash_undefined__";function Zwe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Jwe&&t===void 0?Qwe:t,this}var e2e=Zwe,t2e=Lwe,r2e=Fwe,n2e=Wwe,a2e=Xwe,o2e=e2e;function o0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}o0.prototype.clear=t2e;o0.prototype.delete=r2e;o0.prototype.get=n2e;o0.prototype.has=a2e;o0.prototype.set=o2e;var i2e=o0;function s2e(){this.__data__=[],this.size=0}var l2e=s2e;function c2e(e,t){return e===t||e!==e&&t!==t}var DI=c2e,d2e=DI;function u2e(e,t){for(var r=e.length;r--;)if(d2e(e[r][0],t))return r;return-1}var ZS=u2e,f2e=ZS,m2e=Array.prototype,h2e=m2e.splice;function p2e(e){var t=this.__data__,r=f2e(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():h2e.call(t,r,1),--this.size,!0}var g2e=p2e,v2e=ZS;function x2e(e){var t=this.__data__,r=v2e(t,e);return r<0?void 0:t[r][1]}var y2e=x2e,b2e=ZS;function w2e(e){return b2e(this.__data__,e)>-1}var j2e=w2e,N2e=ZS;function _2e(e,t){var r=this.__data__,n=N2e(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var S2e=_2e,C2e=l2e,P2e=g2e,A2e=y2e,E2e=j2e,k2e=S2e;function i0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}i0.prototype.clear=C2e;i0.prototype.delete=P2e;i0.prototype.get=A2e;i0.prototype.has=E2e;i0.prototype.set=k2e;var eC=i0,O2e=pg,T2e=Vu,I2e=O2e(T2e,"Map"),MI=I2e,fF=i2e,D2e=eC,M2e=MI;function R2e(){this.size=0,this.__data__={hash:new fF,map:new(M2e||D2e),string:new fF}}var L2e=R2e;function $2e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var F2e=$2e,B2e=F2e;function q2e(e,t){var r=e.__data__;return B2e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var tC=q2e,z2e=tC;function U2e(e){var t=z2e(this,e).delete(e);return this.size-=t?1:0,t}var V2e=U2e,W2e=tC;function H2e(e){return W2e(this,e).get(e)}var G2e=H2e,K2e=tC;function Y2e(e){return K2e(this,e).has(e)}var X2e=Y2e,J2e=tC;function Q2e(e,t){var r=J2e(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Z2e=Q2e,eje=L2e,tje=V2e,rje=G2e,nje=X2e,aje=Z2e;function s0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}s0.prototype.clear=eje;s0.prototype.delete=tje;s0.prototype.get=rje;s0.prototype.has=nje;s0.prototype.set=aje;var RI=s0,gY=RI,oje="Expected a function";function LI(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(oje);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var s=e.apply(this,n);return r.cache=i.set(a,s)||i,s};return r.cache=new(LI.Cache||gY),r}LI.Cache=gY;var vY=LI;const ije=Ba(vY);var sje=vY,lje=500;function cje(e){var t=sje(e,function(n){return r.size===lje&&r.clear(),n}),r=t.cache;return t}var dje=cje,uje=dje,fje=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mje=/\\(\\)?/g,hje=uje(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(fje,function(r,n,a,i){t.push(a?i.replace(mje,"$1"):n||r)}),t}),pje=hje;function gje(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var $I=gje,mF=J1,vje=$I,xje=Bl,yje=n0,bje=1/0,hF=mF?mF.prototype:void 0,pF=hF?hF.toString:void 0;function xY(e){if(typeof e=="string")return e;if(xje(e))return vje(e,xY)+"";if(yje(e))return pF?pF.call(e):"";var t=e+"";return t=="0"&&1/e==-bje?"-0":t}var wje=xY,jje=wje;function Nje(e){return e==null?"":jje(e)}var yY=Nje,_je=Bl,Sje=TI,Cje=pje,Pje=yY;function Aje(e,t){return _je(e)?e:Sje(e,t)?[e]:Cje(Pje(e))}var bY=Aje,Eje=n0,kje=1/0;function Oje(e){if(typeof e=="string"||Eje(e))return e;var t=e+"";return t=="0"&&1/e==-kje?"-0":t}var rC=Oje,Tje=bY,Ije=rC;function Dje(e,t){t=Tje(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Ije(t[r++])];return r&&r==n?e:void 0}var FI=Dje,Mje=FI;function Rje(e,t,r){var n=e==null?void 0:Mje(e,t);return n===void 0?r:n}var wY=Rje;const gc=Ba(wY);function Lje(e){return e==null}var $je=Lje;const Xn=Ba($je);var Fje=Wf,Bje=Bl,qje=Hf,zje="[object String]";function Uje(e){return typeof e=="string"||!Bje(e)&&qje(e)&&Fje(e)==zje}var Vje=Uje;const Kp=Ba(Vje);var jY={exports:{}},no={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BI=Symbol.for("react.element"),qI=Symbol.for("react.portal"),nC=Symbol.for("react.fragment"),aC=Symbol.for("react.strict_mode"),oC=Symbol.for("react.profiler"),iC=Symbol.for("react.provider"),sC=Symbol.for("react.context"),Wje=Symbol.for("react.server_context"),lC=Symbol.for("react.forward_ref"),cC=Symbol.for("react.suspense"),dC=Symbol.for("react.suspense_list"),uC=Symbol.for("react.memo"),fC=Symbol.for("react.lazy"),Hje=Symbol.for("react.offscreen"),NY;NY=Symbol.for("react.module.reference");function wd(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case BI:switch(e=e.type,e){case nC:case oC:case aC:case cC:case dC:return e;default:switch(e=e&&e.$$typeof,e){case Wje:case sC:case lC:case fC:case uC:case iC:return e;default:return t}}case qI:return t}}}no.ContextConsumer=sC;no.ContextProvider=iC;no.Element=BI;no.ForwardRef=lC;no.Fragment=nC;no.Lazy=fC;no.Memo=uC;no.Portal=qI;no.Profiler=oC;no.StrictMode=aC;no.Suspense=cC;no.SuspenseList=dC;no.isAsyncMode=function(){return!1};no.isConcurrentMode=function(){return!1};no.isContextConsumer=function(e){return wd(e)===sC};no.isContextProvider=function(e){return wd(e)===iC};no.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===BI};no.isForwardRef=function(e){return wd(e)===lC};no.isFragment=function(e){return wd(e)===nC};no.isLazy=function(e){return wd(e)===fC};no.isMemo=function(e){return wd(e)===uC};no.isPortal=function(e){return wd(e)===qI};no.isProfiler=function(e){return wd(e)===oC};no.isStrictMode=function(e){return wd(e)===aC};no.isSuspense=function(e){return wd(e)===cC};no.isSuspenseList=function(e){return wd(e)===dC};no.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===nC||e===oC||e===aC||e===cC||e===dC||e===Hje||typeof e=="object"&&e!==null&&(e.$$typeof===fC||e.$$typeof===uC||e.$$typeof===iC||e.$$typeof===sC||e.$$typeof===lC||e.$$typeof===NY||e.getModuleId!==void 0)};no.typeOf=wd;jY.exports=no;var Gje=jY.exports,Kje=Wf,Yje=Hf,Xje="[object Number]";function Jje(e){return typeof e=="number"||Yje(e)&&Kje(e)==Xje}var _Y=Jje;const Qje=Ba(_Y);var Zje=_Y;function eNe(e){return Zje(e)&&e!=+e}var tNe=eNe;const l0=Ba(tNe);var dl=function(t){return t===0?0:t>0?1:-1},hp=function(t){return Kp(t)&&t.indexOf("%")===t.length-1},Vr=function(t){return Qje(t)&&!l0(t)},rNe=function(t){return Xn(t)},Gi=function(t){return Vr(t)||Kp(t)},nNe=0,gg=function(t){var r=++nNe;return"".concat(t||"").concat(r)},ul=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Vr(t)&&!Kp(t))return n;var i;if(hp(t)){var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return l0(i)&&(i=n),a&&i>r&&(i=r),i},_m=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},aNe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Vi=function(t,r){return Vr(t)&&Vr(r)?function(n){return t+n*(r-t)}:function(){return r}};function EN(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):gc(n,t))===r})}var oNe=function(t,r){return Vr(t)&&Vr(r)?t-r:Kp(t)&&Kp(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Bv(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function uO(e){"@babel/helpers - typeof";return uO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uO(e)}var iNe=["viewBox","children"],sNe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],gF=["points","pathLength"],eA={svg:iNe,polygon:gF,polyline:gF},zI=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],kN=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(p.isValidElement(t)&&(n=t.props),!a0(n))return null;var a={};return Object.keys(n).forEach(function(i){zI.includes(i)&&(a[i]=r||function(s){return n[i](n,s)})}),a},lNe=function(t,r,n){return function(a){return t(r,n,a),null}},Yp=function(t,r,n){if(!a0(t)||uO(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var s=t[i];zI.includes(i)&&typeof s=="function"&&(a||(a={}),a[i]=lNe(s,r,n))}),a},cNe=["children"],dNe=["children"];function vF(e,t){if(e==null)return{};var r=uNe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function fO(e){"@babel/helpers - typeof";return fO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fO(e)}var xF={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Sf=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},yF=null,tA=null,UI=function e(t){if(t===yF&&Array.isArray(tA))return tA;var r=[];return p.Children.forEach(t,function(n){Xn(n)||(Gje.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),tA=r,yF=t,r};function vc(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return Sf(a)}):n=[Sf(t)],UI(e).forEach(function(a){var i=gc(a,"type.displayName")||gc(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function ac(e,t){var r=vc(e,t);return r&&r[0]}var bF=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Vr(n)||n<=0||!Vr(a)||a<=0)},fNe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],mNe=function(t){return t&&t.type&&Kp(t.type)&&fNe.indexOf(t.type)>=0},SY=function(t){return t&&fO(t)==="object"&&"clipDot"in t},hNe=function(t,r,n,a){var i,s=(i=eA?.[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Vn(t)&&(a&&s.includes(r)||sNe.includes(r))||n&&zI.includes(r)},On=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(p.isValidElement(t)&&(a=t.props),!a0(a))return null;var i={};return Object.keys(a).forEach(function(s){var l;hNe((l=a)===null||l===void 0?void 0:l[s],s,r,n)&&(i[s]=a[s])}),i},mO=function e(t,r){if(t===r)return!0;var n=p.Children.count(t);if(n!==p.Children.count(r))return!1;if(n===0)return!0;if(n===1)return wF(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],s=r[a];if(Array.isArray(i)||Array.isArray(s)){if(!e(i,s))return!1}else if(!wF(i,s))return!1}return!0},wF=function(t,r){if(Xn(t)&&Xn(r))return!0;if(!Xn(t)&&!Xn(r)){var n=t.props||{},a=n.children,i=vF(n,cNe),s=r.props||{},l=s.children,c=vF(s,dNe);return a&&l?Bv(i,c)&&mO(a,l):!a&&!l?Bv(i,c):!1}return!1},jF=function(t,r){var n=[],a={};return UI(t).forEach(function(i,s){if(mNe(i))n.push(i);else if(i){var l=Sf(i.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!a[l])){var f=d(i,l,s);n.push(f),a[l]=!0}}}),n},pNe=function(t){var r=t&&t.type;return r&&xF[r]?xF[r]:null},gNe=function(t,r){return UI(r).indexOf(t)},vNe=["children","width","height","viewBox","className","style","title","desc"];function hO(){return hO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hO.apply(this,arguments)}function xNe(e,t){if(e==null)return{};var r=yNe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function pO(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,s=e.style,l=e.title,c=e.desc,d=xNe(e,vNe),u=a||{width:r,height:n,x:0,y:0},f=ta("recharts-surface",i);return xe.createElement("svg",hO({},On(d,!0,"svg"),{className:f,width:r,height:n,style:s,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),xe.createElement("title",null,l),xe.createElement("desc",null,c),t)}var bNe=["children","className"];function gO(){return gO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gO.apply(this,arguments)}function wNe(e,t){if(e==null)return{};var r=jNe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Na=xe.forwardRef(function(e,t){var r=e.children,n=e.className,a=wNe(e,bNe),i=ta("recharts-layer",n);return xe.createElement("g",gO({className:i},On(a,!0),{ref:t}),r)}),Xd=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function NNe(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var _Ne=NNe,SNe=_Ne;function CNe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:SNe(e,t,r)}var PNe=CNe,ANe="\\ud800-\\udfff",ENe="\\u0300-\\u036f",kNe="\\ufe20-\\ufe2f",ONe="\\u20d0-\\u20ff",TNe=ENe+kNe+ONe,INe="\\ufe0e\\ufe0f",DNe="\\u200d",MNe=RegExp("["+DNe+ANe+TNe+INe+"]");function RNe(e){return MNe.test(e)}var CY=RNe;function LNe(e){return e.split("")}var $Ne=LNe,PY="\\ud800-\\udfff",FNe="\\u0300-\\u036f",BNe="\\ufe20-\\ufe2f",qNe="\\u20d0-\\u20ff",zNe=FNe+BNe+qNe,UNe="\\ufe0e\\ufe0f",VNe="["+PY+"]",vO="["+zNe+"]",xO="\\ud83c[\\udffb-\\udfff]",WNe="(?:"+vO+"|"+xO+")",AY="[^"+PY+"]",EY="(?:\\ud83c[\\udde6-\\uddff]){2}",kY="[\\ud800-\\udbff][\\udc00-\\udfff]",HNe="\\u200d",OY=WNe+"?",TY="["+UNe+"]?",GNe="(?:"+HNe+"(?:"+[AY,EY,kY].join("|")+")"+TY+OY+")*",KNe=TY+OY+GNe,YNe="(?:"+[AY+vO+"?",vO,EY,kY,VNe].join("|")+")",XNe=RegExp(xO+"(?="+xO+")|"+YNe+KNe,"g");function JNe(e){return e.match(XNe)||[]}var QNe=JNe,ZNe=$Ne,e_e=CY,t_e=QNe;function r_e(e){return e_e(e)?t_e(e):ZNe(e)}var n_e=r_e,a_e=PNe,o_e=CY,i_e=n_e,s_e=yY;function l_e(e){return function(t){t=s_e(t);var r=o_e(t)?i_e(t):void 0,n=r?r[0]:t.charAt(0),a=r?a_e(r,1).join(""):t.slice(1);return n[e]()+a}}var c_e=l_e,d_e=c_e,u_e=d_e("toUpperCase"),f_e=u_e;const mC=Ba(f_e);function wo(e){return function(){return e}}const IY=Math.cos,ON=Math.sin,ou=Math.sqrt,TN=Math.PI,hC=2*TN,yO=Math.PI,bO=2*yO,Zh=1e-6,m_e=bO-Zh;function DY(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function h_e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return DY;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class p_e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?DY:h_e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,c=n-t,d=a-r,u=s-t,f=l-r,m=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>Zh)if(!(Math.abs(f*c-d*u)>Zh)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-s,v=a-l,g=c*c+d*d,x=h*h+v*v,y=Math.sqrt(g),b=Math.sqrt(m),w=i*Math.tan((yO-Math.acos((g+m-x)/(2*y*b)))/2),j=w/b,_=w/y;Math.abs(j-1)>Zh&&this._append`L${t+j*u},${r+j*f}`,this._append`A${i},${i},0,0,${+(f*h>u*v)},${this._x1=t+_*c},${this._y1=r+_*d}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=t+l,u=r+c,f=1^s,m=s?a-i:i-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Zh||Math.abs(this._y1-u)>Zh)&&this._append`L${d},${u}`,n&&(m<0&&(m=m%bO+bO),m>m_e?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:m>Zh&&this._append`A${n},${n},0,${+(m>=yO)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function VI(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new p_e(t)}function WI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function MY(e){this._context=e}MY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function pC(e){return new MY(e)}function RY(e){return e[0]}function LY(e){return e[1]}function $Y(e,t){var r=wo(!0),n=null,a=pC,i=null,s=VI(l);e=typeof e=="function"?e:e===void 0?RY:wo(e),t=typeof t=="function"?t:t===void 0?LY:wo(t);function l(c){var d,u=(c=WI(c)).length,f,m=!1,h;for(n==null&&(i=a(h=s())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===m&&((m=!m)?i.lineStart():i.lineEnd()),m&&i.point(+e(f,d,c),+t(f,d,c));if(h)return i=null,h+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:wo(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:wo(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:wo(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function N2(e,t,r){var n=null,a=wo(!0),i=null,s=pC,l=null,c=VI(d);e=typeof e=="function"?e:e===void 0?RY:wo(+e),t=typeof t=="function"?t:wo(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?LY:wo(+r);function d(f){var m,h,v,g=(f=WI(f)).length,x,y=!1,b,w=new Array(g),j=new Array(g);for(i==null&&(l=s(b=c())),m=0;m<=g;++m){if(!(m<g&&a(x=f[m],m,f))===y)if(y=!y)h=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),v=m-1;v>=h;--v)l.point(w[v],j[v]);l.lineEnd(),l.areaEnd()}y&&(w[m]=+e(x,m,f),j[m]=+t(x,m,f),l.point(n?+n(x,m,f):w[m],r?+r(x,m,f):j[m]))}if(b)return l=null,b+""||null}function u(){return $Y().defined(a).curve(s).context(i)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:wo(+f),n=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:wo(+f),d):e},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:wo(+f),d):n},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:wo(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:wo(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:wo(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(f){return arguments.length?(a=typeof f=="function"?f:wo(!!f),d):a},d.curve=function(f){return arguments.length?(s=f,i!=null&&(l=s(i)),d):s},d.context=function(f){return arguments.length?(f==null?i=l=null:l=s(i=f),d):i},d}class FY{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function g_e(e){return new FY(e,!0)}function v_e(e){return new FY(e,!1)}const HI={draw(e,t){const r=ou(t/TN);e.moveTo(r,0),e.arc(0,0,r,0,hC)}},x_e={draw(e,t){const r=ou(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},BY=ou(1/3),y_e=BY*2,b_e={draw(e,t){const r=ou(t/y_e),n=r*BY;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},w_e={draw(e,t){const r=ou(t),n=-r/2;e.rect(n,n,r,r)}},j_e=.8908130915292852,qY=ON(TN/10)/ON(7*TN/10),N_e=ON(hC/10)*qY,__e=-IY(hC/10)*qY,S_e={draw(e,t){const r=ou(t*j_e),n=N_e*r,a=__e*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=hC*i/5,l=IY(s),c=ON(s);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},rA=ou(3),C_e={draw(e,t){const r=-ou(t/(rA*3));e.moveTo(0,r*2),e.lineTo(-rA*r,-r),e.lineTo(rA*r,-r),e.closePath()}},Bc=-.5,qc=ou(3)/2,wO=1/ou(12),P_e=(wO/2+1)*3,A_e={draw(e,t){const r=ou(t/P_e),n=r/2,a=r*wO,i=n,s=r*wO+r,l=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,c),e.lineTo(Bc*n-qc*a,qc*n+Bc*a),e.lineTo(Bc*i-qc*s,qc*i+Bc*s),e.lineTo(Bc*l-qc*c,qc*l+Bc*c),e.lineTo(Bc*n+qc*a,Bc*a-qc*n),e.lineTo(Bc*i+qc*s,Bc*s-qc*i),e.lineTo(Bc*l+qc*c,Bc*c-qc*l),e.closePath()}};function E_e(e,t){let r=null,n=VI(a);e=typeof e=="function"?e:wo(e||HI),t=typeof t=="function"?t:wo(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:wo(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:wo(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function IN(){}function DN(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function zY(e){this._context=e}zY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:DN(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:DN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function k_e(e){return new zY(e)}function UY(e){this._context=e}UY.prototype={areaStart:IN,areaEnd:IN,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:DN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function O_e(e){return new UY(e)}function VY(e){this._context=e}VY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:DN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function T_e(e){return new VY(e)}function WY(e){this._context=e}WY.prototype={areaStart:IN,areaEnd:IN,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function I_e(e){return new WY(e)}function NF(e){return e<0?-1:1}function _F(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(NF(i)+NF(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function SF(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function nA(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function MN(e){this._context=e}MN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nA(this,this._t0,SF(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,nA(this,SF(this,r=_F(this,e,t)),r);break;default:nA(this,this._t0,r=_F(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function HY(e){this._context=new GY(e)}(HY.prototype=Object.create(MN.prototype)).point=function(e,t){MN.prototype.point.call(this,t,e)};function GY(e){this._context=e}GY.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function D_e(e){return new MN(e)}function M_e(e){return new HY(e)}function KY(e){this._context=e}KY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=CF(e),a=CF(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function CF(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function R_e(e){return new KY(e)}function gC(e,t){this._context=e,this._t=t}gC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function L_e(e){return new gC(e,.5)}function $_e(e){return new gC(e,0)}function F_e(e){return new gC(e,1)}function fx(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function jO(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function B_e(e,t){return e[t]}function q_e(e){const t=[];return t.key=e,t}function z_e(){var e=wo([]),t=jO,r=fx,n=B_e;function a(i){var s=Array.from(e.apply(this,arguments),q_e),l,c=s.length,d=-1,u;for(const f of i)for(l=0,++d;l<c;++l)(s[l][d]=[0,+n(f,s[l].key,d,i)]).data=f;for(l=0,u=WI(t(s));l<c;++l)s[u[l]].index=l;return r(s,u),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:wo(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:wo(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?jO:typeof i=="function"?i:wo(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??fx,a):r},a}function U_e(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}fx(e,t)}}function V_e(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}fx(e,t)}}function W_e(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,c=0,d=0;l<s;++l){for(var u=e[t[l]],f=u[n][1]||0,m=u[n-1][1]||0,h=(f-m)/2,v=0;v<l;++v){var g=e[t[v]],x=g[n][1]||0,y=g[n-1][1]||0;h+=x-y}c+=f,d+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,fx(e,t)}}function Mb(e){"@babel/helpers - typeof";return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mb(e)}var H_e=["type","size","sizeType"];function NO(){return NO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NO.apply(this,arguments)}function PF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function AF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PF(Object(r),!0).forEach(function(n){G_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function G_e(e,t,r){return t=K_e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K_e(e){var t=Y_e(e,"string");return Mb(t)=="symbol"?t:t+""}function Y_e(e,t){if(Mb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X_e(e,t){if(e==null)return{};var r=J_e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function J_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var YY={symbolCircle:HI,symbolCross:x_e,symbolDiamond:b_e,symbolSquare:w_e,symbolStar:S_e,symbolTriangle:C_e,symbolWye:A_e},Q_e=Math.PI/180,Z_e=function(t){var r="symbol".concat(mC(t));return YY[r]||HI},eSe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*Q_e;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},tSe=function(t,r){YY["symbol".concat(mC(t))]=r},GI=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,s=t.sizeType,l=s===void 0?"area":s,c=X_e(t,H_e),d=AF(AF({},c),{},{type:n,size:i,sizeType:l}),u=function(){var x=Z_e(n),y=E_e().type(x).size(eSe(i,l,n));return y()},f=d.className,m=d.cx,h=d.cy,v=On(d,!0);return m===+m&&h===+h&&i===+i?xe.createElement("path",NO({},v,{className:ta("recharts-symbols",f),transform:"translate(".concat(m,", ").concat(h,")"),d:u()})):null};GI.registerSymbol=tSe;function mx(e){"@babel/helpers - typeof";return mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mx(e)}function _O(){return _O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_O.apply(this,arguments)}function EF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rSe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EF(Object(r),!0).forEach(function(n){Rb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JY(n.key),n)}}function aSe(e,t,r){return t&&kF(e.prototype,t),r&&kF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oSe(e,t,r){return t=RN(t),iSe(e,XY()?Reflect.construct(t,r||[],RN(e).constructor):t.apply(e,r))}function iSe(e,t){if(t&&(mx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sSe(e)}function sSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XY=function(){return!!e})()}function RN(e){return RN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},RN(e)}function lSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SO(e,t)}function SO(e,t){return SO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},SO(e,t)}function Rb(e,t,r){return t=JY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JY(e){var t=cSe(e,"string");return mx(t)=="symbol"?t:t+""}function cSe(e,t){if(mx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zc=32,KI=function(e){function t(){return nSe(this,t),oSe(this,t,arguments)}return lSe(t,e),aSe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=zc/2,s=zc/6,l=zc/3,c=n.inactive?a:n.color;if(n.type==="plainline")return xe.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:zc,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return xe.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(zc,"M").concat(2*l,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return xe.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(zc/8,"h").concat(zc,"v").concat(zc*3/4,"h").concat(-zc,"z"),className:"recharts-legend-icon"});if(xe.isValidElement(n.legendIcon)){var d=rSe({},n);return delete d.legendIcon,xe.cloneElement(n.legendIcon,d)}return xe.createElement(GI,{fill:c,cx:i,cy:i,size:zc,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,s=a.iconSize,l=a.layout,c=a.formatter,d=a.inactiveColor,u={x:0,y:0,width:zc,height:zc},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},m={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(h,v){var g=h.formatter||c,x=ta(Rb(Rb({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",h.inactive));if(h.type==="none")return null;var y=Vn(h.value)?null:h.value;Xd(!Vn(h.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=h.inactive?d:h.color;return xe.createElement("li",_O({className:x,style:f,key:"legend-item-".concat(v)},Yp(n.props,h,v)),xe.createElement(pO,{width:s,height:s,viewBox:u,style:m},n.renderIcon(h)),xe.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},g?g(y,h,v):y))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,s=n.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return xe.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(p.PureComponent);Rb(KI,"displayName","Legend");Rb(KI,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var dSe=eC;function uSe(){this.__data__=new dSe,this.size=0}var fSe=uSe;function mSe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var hSe=mSe;function pSe(e){return this.__data__.get(e)}var gSe=pSe;function vSe(e){return this.__data__.has(e)}var xSe=vSe,ySe=eC,bSe=MI,wSe=RI,jSe=200;function NSe(e,t){var r=this.__data__;if(r instanceof ySe){var n=r.__data__;if(!bSe||n.length<jSe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new wSe(n)}return r.set(e,t),this.size=r.size,this}var _Se=NSe,SSe=eC,CSe=fSe,PSe=hSe,ASe=gSe,ESe=xSe,kSe=_Se;function c0(e){var t=this.__data__=new SSe(e);this.size=t.size}c0.prototype.clear=CSe;c0.prototype.delete=PSe;c0.prototype.get=ASe;c0.prototype.has=ESe;c0.prototype.set=kSe;var QY=c0,OSe="__lodash_hash_undefined__";function TSe(e){return this.__data__.set(e,OSe),this}var ISe=TSe;function DSe(e){return this.__data__.has(e)}var MSe=DSe,RSe=RI,LSe=ISe,$Se=MSe;function LN(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new RSe;++t<r;)this.add(e[t])}LN.prototype.add=LN.prototype.push=LSe;LN.prototype.has=$Se;var ZY=LN;function FSe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var eX=FSe;function BSe(e,t){return e.has(t)}var tX=BSe,qSe=ZY,zSe=eX,USe=tX,VSe=1,WSe=2;function HSe(e,t,r,n,a,i){var s=r&VSe,l=e.length,c=t.length;if(l!=c&&!(s&&c>l))return!1;var d=i.get(e),u=i.get(t);if(d&&u)return d==t&&u==e;var f=-1,m=!0,h=r&WSe?new qSe:void 0;for(i.set(e,t),i.set(t,e);++f<l;){var v=e[f],g=t[f];if(n)var x=s?n(g,v,f,t,e,i):n(v,g,f,e,t,i);if(x!==void 0){if(x)continue;m=!1;break}if(h){if(!zSe(t,function(y,b){if(!USe(h,b)&&(v===y||a(v,y,r,n,i)))return h.push(b)})){m=!1;break}}else if(!(v===g||a(v,g,r,n,i))){m=!1;break}}return i.delete(e),i.delete(t),m}var rX=HSe,GSe=Vu,KSe=GSe.Uint8Array,YSe=KSe;function XSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var JSe=XSe;function QSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var YI=QSe,OF=J1,TF=YSe,ZSe=DI,eCe=rX,tCe=JSe,rCe=YI,nCe=1,aCe=2,oCe="[object Boolean]",iCe="[object Date]",sCe="[object Error]",lCe="[object Map]",cCe="[object Number]",dCe="[object RegExp]",uCe="[object Set]",fCe="[object String]",mCe="[object Symbol]",hCe="[object ArrayBuffer]",pCe="[object DataView]",IF=OF?OF.prototype:void 0,aA=IF?IF.valueOf:void 0;function gCe(e,t,r,n,a,i,s){switch(r){case pCe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case hCe:return!(e.byteLength!=t.byteLength||!i(new TF(e),new TF(t)));case oCe:case iCe:case cCe:return ZSe(+e,+t);case sCe:return e.name==t.name&&e.message==t.message;case dCe:case fCe:return e==t+"";case lCe:var l=tCe;case uCe:var c=n&nCe;if(l||(l=rCe),e.size!=t.size&&!c)return!1;var d=s.get(e);if(d)return d==t;n|=aCe,s.set(e,t);var u=eCe(l(e),l(t),n,a,i,s);return s.delete(e),u;case mCe:if(aA)return aA.call(e)==aA.call(t)}return!1}var vCe=gCe;function xCe(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var nX=xCe,yCe=nX,bCe=Bl;function wCe(e,t,r){var n=t(e);return bCe(e)?n:yCe(n,r(e))}var jCe=wCe;function NCe(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[a++]=s)}return i}var _Ce=NCe;function SCe(){return[]}var CCe=SCe,PCe=_Ce,ACe=CCe,ECe=Object.prototype,kCe=ECe.propertyIsEnumerable,DF=Object.getOwnPropertySymbols,OCe=DF?function(e){return e==null?[]:(e=Object(e),PCe(DF(e),function(t){return kCe.call(e,t)}))}:ACe,TCe=OCe;function ICe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var DCe=ICe,MCe=Wf,RCe=Hf,LCe="[object Arguments]";function $Ce(e){return RCe(e)&&MCe(e)==LCe}var FCe=$Ce,MF=FCe,BCe=Hf,aX=Object.prototype,qCe=aX.hasOwnProperty,zCe=aX.propertyIsEnumerable,UCe=MF(function(){return arguments}())?MF:function(e){return BCe(e)&&qCe.call(e,"callee")&&!zCe.call(e,"callee")},XI=UCe,$N={exports:{}};function VCe(){return!1}var WCe=VCe;$N.exports;(function(e,t){var r=Vu,n=WCe,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,l=s?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})($N,$N.exports);var oX=$N.exports,HCe=9007199254740991,GCe=/^(?:0|[1-9]\d*)$/;function KCe(e,t){var r=typeof e;return t=t??HCe,!!t&&(r=="number"||r!="symbol"&&GCe.test(e))&&e>-1&&e%1==0&&e<t}var JI=KCe,YCe=9007199254740991;function XCe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=YCe}var QI=XCe,JCe=Wf,QCe=QI,ZCe=Hf,e5e="[object Arguments]",t5e="[object Array]",r5e="[object Boolean]",n5e="[object Date]",a5e="[object Error]",o5e="[object Function]",i5e="[object Map]",s5e="[object Number]",l5e="[object Object]",c5e="[object RegExp]",d5e="[object Set]",u5e="[object String]",f5e="[object WeakMap]",m5e="[object ArrayBuffer]",h5e="[object DataView]",p5e="[object Float32Array]",g5e="[object Float64Array]",v5e="[object Int8Array]",x5e="[object Int16Array]",y5e="[object Int32Array]",b5e="[object Uint8Array]",w5e="[object Uint8ClampedArray]",j5e="[object Uint16Array]",N5e="[object Uint32Array]",ko={};ko[p5e]=ko[g5e]=ko[v5e]=ko[x5e]=ko[y5e]=ko[b5e]=ko[w5e]=ko[j5e]=ko[N5e]=!0;ko[e5e]=ko[t5e]=ko[m5e]=ko[r5e]=ko[h5e]=ko[n5e]=ko[a5e]=ko[o5e]=ko[i5e]=ko[s5e]=ko[l5e]=ko[c5e]=ko[d5e]=ko[u5e]=ko[f5e]=!1;function _5e(e){return ZCe(e)&&QCe(e.length)&&!!ko[JCe(e)]}var S5e=_5e;function C5e(e){return function(t){return e(t)}}var iX=C5e,FN={exports:{}};FN.exports;(function(e,t){var r=mY,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();e.exports=l})(FN,FN.exports);var P5e=FN.exports,A5e=S5e,E5e=iX,RF=P5e,LF=RF&&RF.isTypedArray,k5e=LF?E5e(LF):A5e,sX=k5e,O5e=DCe,T5e=XI,I5e=Bl,D5e=oX,M5e=JI,R5e=sX,L5e=Object.prototype,$5e=L5e.hasOwnProperty;function F5e(e,t){var r=I5e(e),n=!r&&T5e(e),a=!r&&!n&&D5e(e),i=!r&&!n&&!a&&R5e(e),s=r||n||a||i,l=s?O5e(e.length,String):[],c=l.length;for(var d in e)(t||$5e.call(e,d))&&!(s&&(d=="length"||a&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||M5e(d,c)))&&l.push(d);return l}var B5e=F5e,q5e=Object.prototype;function z5e(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||q5e;return e===r}var U5e=z5e;function V5e(e,t){return function(r){return e(t(r))}}var lX=V5e,W5e=lX,H5e=W5e(Object.keys,Object),G5e=H5e,K5e=U5e,Y5e=G5e,X5e=Object.prototype,J5e=X5e.hasOwnProperty;function Q5e(e){if(!K5e(e))return Y5e(e);var t=[];for(var r in Object(e))J5e.call(e,r)&&r!="constructor"&&t.push(r);return t}var Z5e=Q5e,ePe=II,tPe=QI;function rPe(e){return e!=null&&tPe(e.length)&&!ePe(e)}var Q1=rPe,nPe=B5e,aPe=Z5e,oPe=Q1;function iPe(e){return oPe(e)?nPe(e):aPe(e)}var vC=iPe,sPe=jCe,lPe=TCe,cPe=vC;function dPe(e){return sPe(e,cPe,lPe)}var uPe=dPe,$F=uPe,fPe=1,mPe=Object.prototype,hPe=mPe.hasOwnProperty;function pPe(e,t,r,n,a,i){var s=r&fPe,l=$F(e),c=l.length,d=$F(t),u=d.length;if(c!=u&&!s)return!1;for(var f=c;f--;){var m=l[f];if(!(s?m in t:hPe.call(t,m)))return!1}var h=i.get(e),v=i.get(t);if(h&&v)return h==t&&v==e;var g=!0;i.set(e,t),i.set(t,e);for(var x=s;++f<c;){m=l[f];var y=e[m],b=t[m];if(n)var w=s?n(b,y,m,t,e,i):n(y,b,m,e,t,i);if(!(w===void 0?y===b||a(y,b,r,n,i):w)){g=!1;break}x||(x=m=="constructor")}if(g&&!x){var j=e.constructor,_=t.constructor;j!=_&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof _=="function"&&_ instanceof _)&&(g=!1)}return i.delete(e),i.delete(t),g}var gPe=pPe,vPe=pg,xPe=Vu,yPe=vPe(xPe,"DataView"),bPe=yPe,wPe=pg,jPe=Vu,NPe=wPe(jPe,"Promise"),_Pe=NPe,SPe=pg,CPe=Vu,PPe=SPe(CPe,"Set"),cX=PPe,APe=pg,EPe=Vu,kPe=APe(EPe,"WeakMap"),OPe=kPe,CO=bPe,PO=MI,AO=_Pe,EO=cX,kO=OPe,dX=Wf,d0=pY,FF="[object Map]",TPe="[object Object]",BF="[object Promise]",qF="[object Set]",zF="[object WeakMap]",UF="[object DataView]",IPe=d0(CO),DPe=d0(PO),MPe=d0(AO),RPe=d0(EO),LPe=d0(kO),ep=dX;(CO&&ep(new CO(new ArrayBuffer(1)))!=UF||PO&&ep(new PO)!=FF||AO&&ep(AO.resolve())!=BF||EO&&ep(new EO)!=qF||kO&&ep(new kO)!=zF)&&(ep=function(e){var t=dX(e),r=t==TPe?e.constructor:void 0,n=r?d0(r):"";if(n)switch(n){case IPe:return UF;case DPe:return FF;case MPe:return BF;case RPe:return qF;case LPe:return zF}return t});var $Pe=ep,oA=QY,FPe=rX,BPe=vCe,qPe=gPe,VF=$Pe,WF=Bl,HF=oX,zPe=sX,UPe=1,GF="[object Arguments]",KF="[object Array]",_2="[object Object]",VPe=Object.prototype,YF=VPe.hasOwnProperty;function WPe(e,t,r,n,a,i){var s=WF(e),l=WF(t),c=s?KF:VF(e),d=l?KF:VF(t);c=c==GF?_2:c,d=d==GF?_2:d;var u=c==_2,f=d==_2,m=c==d;if(m&&HF(e)){if(!HF(t))return!1;s=!0,u=!1}if(m&&!u)return i||(i=new oA),s||zPe(e)?FPe(e,t,r,n,a,i):BPe(e,t,c,r,n,a,i);if(!(r&UPe)){var h=u&&YF.call(e,"__wrapped__"),v=f&&YF.call(t,"__wrapped__");if(h||v){var g=h?e.value():e,x=v?t.value():t;return i||(i=new oA),a(g,x,r,n,i)}}return m?(i||(i=new oA),qPe(e,t,r,n,a,i)):!1}var HPe=WPe,GPe=HPe,XF=Hf;function uX(e,t,r,n,a){return e===t?!0:e==null||t==null||!XF(e)&&!XF(t)?e!==e&&t!==t:GPe(e,t,r,n,uX,a)}var ZI=uX,KPe=QY,YPe=ZI,XPe=1,JPe=2;function QPe(e,t,r,n){var a=r.length,i=a,s=!n;if(e==null)return!i;for(e=Object(e);a--;){var l=r[a];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<i;){l=r[a];var c=l[0],d=e[c],u=l[1];if(s&&l[2]){if(d===void 0&&!(c in e))return!1}else{var f=new KPe;if(n)var m=n(d,u,c,e,t,f);if(!(m===void 0?YPe(u,d,XPe|JPe,n,f):m))return!1}}return!0}var ZPe=QPe,eAe=Sh;function tAe(e){return e===e&&!eAe(e)}var fX=tAe,rAe=fX,nAe=vC;function aAe(e){for(var t=nAe(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,rAe(a)]}return t}var oAe=aAe;function iAe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var mX=iAe,sAe=ZPe,lAe=oAe,cAe=mX;function dAe(e){var t=lAe(e);return t.length==1&&t[0][2]?cAe(t[0][0],t[0][1]):function(r){return r===e||sAe(r,e,t)}}var uAe=dAe;function fAe(e,t){return e!=null&&t in Object(e)}var mAe=fAe,hAe=bY,pAe=XI,gAe=Bl,vAe=JI,xAe=QI,yAe=rC;function bAe(e,t,r){t=hAe(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var s=yAe(t[n]);if(!(i=e!=null&&r(e,s)))break;e=e[s]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&xAe(a)&&vAe(s,a)&&(gAe(e)||pAe(e)))}var wAe=bAe,jAe=mAe,NAe=wAe;function _Ae(e,t){return e!=null&&NAe(e,t,jAe)}var SAe=_Ae,CAe=ZI,PAe=wY,AAe=SAe,EAe=TI,kAe=fX,OAe=mX,TAe=rC,IAe=1,DAe=2;function MAe(e,t){return EAe(e)&&kAe(t)?OAe(TAe(e),t):function(r){var n=PAe(r,e);return n===void 0&&n===t?AAe(r,e):CAe(t,n,IAe|DAe)}}var RAe=MAe;function LAe(e){return e}var u0=LAe;function $Ae(e){return function(t){return t?.[e]}}var FAe=$Ae,BAe=FI;function qAe(e){return function(t){return BAe(t,e)}}var zAe=qAe,UAe=FAe,VAe=zAe,WAe=TI,HAe=rC;function GAe(e){return WAe(e)?UAe(HAe(e)):VAe(e)}var KAe=GAe,YAe=uAe,XAe=RAe,JAe=u0,QAe=Bl,ZAe=KAe;function eEe(e){return typeof e=="function"?e:e==null?JAe:typeof e=="object"?QAe(e)?XAe(e[0],e[1]):YAe(e):ZAe(e)}var Wu=eEe;function tEe(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var hX=tEe;function rEe(e){return e!==e}var nEe=rEe;function aEe(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var oEe=aEe,iEe=hX,sEe=nEe,lEe=oEe;function cEe(e,t,r){return t===t?lEe(e,t,r):iEe(e,sEe,r)}var dEe=cEe,uEe=dEe;function fEe(e,t){var r=e==null?0:e.length;return!!r&&uEe(e,t,0)>-1}var mEe=fEe;function hEe(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var pEe=hEe;function gEe(){}var vEe=gEe,iA=cX,xEe=vEe,yEe=YI,bEe=1/0,wEe=iA&&1/yEe(new iA([,-0]))[1]==bEe?function(e){return new iA(e)}:xEe,jEe=wEe,NEe=ZY,_Ee=mEe,SEe=pEe,CEe=tX,PEe=jEe,AEe=YI,EEe=200;function kEe(e,t,r){var n=-1,a=_Ee,i=e.length,s=!0,l=[],c=l;if(r)s=!1,a=SEe;else if(i>=EEe){var d=t?null:PEe(e);if(d)return AEe(d);s=!1,a=CEe,c=new NEe}else c=t?[]:l;e:for(;++n<i;){var u=e[n],f=t?t(u):u;if(u=r||u!==0?u:0,s&&f===f){for(var m=c.length;m--;)if(c[m]===f)continue e;t&&c.push(f),l.push(u)}else a(c,f,r)||(c!==l&&c.push(f),l.push(u))}return l}var OEe=kEe,TEe=Wu,IEe=OEe;function DEe(e,t){return e&&e.length?IEe(e,TEe(t)):[]}var MEe=DEe;const JF=Ba(MEe);function pX(e,t,r){return t===!0?JF(e,r):Vn(t)?JF(e,t):e}function hx(e){"@babel/helpers - typeof";return hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hx(e)}var REe=["ref"];function QF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QF(Object(r),!0).forEach(function(n){xC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vX(n.key),n)}}function $Ee(e,t,r){return t&&ZF(e.prototype,t),r&&ZF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FEe(e,t,r){return t=BN(t),BEe(e,gX()?Reflect.construct(t,r||[],BN(e).constructor):t.apply(e,r))}function BEe(e,t){if(t&&(hx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qEe(e)}function qEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gX=function(){return!!e})()}function BN(e){return BN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},BN(e)}function zEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OO(e,t)}function OO(e,t){return OO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},OO(e,t)}function xC(e,t,r){return t=vX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vX(e){var t=UEe(e,"string");return hx(t)=="symbol"?t:t+""}function UEe(e,t){if(hx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VEe(e,t){if(e==null)return{};var r=WEe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function HEe(e){return e.value}function GEe(e,t){if(xe.isValidElement(e))return xe.cloneElement(e,t);if(typeof e=="function")return xe.createElement(e,t);t.ref;var r=VEe(t,REe);return xe.createElement(KI,r)}var e8=1,Ep=function(e){function t(){var r;LEe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=FEe(this,t,[].concat(a)),xC(r,"lastBoundingBox",{width:-1,height:-1}),r}return zEe(t,e),$Ee(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>e8||Math.abs(a.height-this.lastBoundingBox.height)>e8)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?tf({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,s=a.align,l=a.verticalAlign,c=a.margin,d=a.chartWidth,u=a.chartHeight,f,m;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&i==="vertical"){var h=this.getBBoxSnapshot();f={left:((d||0)-h.width)/2}}else f=s==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var v=this.getBBoxSnapshot();m={top:((u||0)-v.height)/2}}else m=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return tf(tf({},f),m)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,s=a.width,l=a.height,c=a.wrapperStyle,d=a.payloadUniqBy,u=a.payload,f=tf(tf({position:"absolute",width:s||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return xe.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(h){n.wrapperNode=h}},GEe(i,tf(tf({},this.props),{},{payload:pX(u,d,HEe)})))}}],[{key:"getWithHeight",value:function(n,a){var i=tf(tf({},this.defaultProps),n.props),s=i.layout;return s==="vertical"&&Vr(n.props.height)?{height:n.props.height}:s==="horizontal"?{width:n.props.width||a}:null}}])}(p.PureComponent);xC(Ep,"displayName","Legend");xC(Ep,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var t8=J1,KEe=XI,YEe=Bl,r8=t8?t8.isConcatSpreadable:void 0;function XEe(e){return YEe(e)||KEe(e)||!!(r8&&e&&e[r8])}var JEe=XEe,QEe=nX,ZEe=JEe;function xX(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=ZEe),a||(a=[]);++i<s;){var l=e[i];t>0&&r(l)?t>1?xX(l,t-1,r,n,a):QEe(a,l):n||(a[a.length]=l)}return a}var yX=xX;function eke(e){return function(t,r,n){for(var a=-1,i=Object(t),s=n(t),l=s.length;l--;){var c=s[e?l:++a];if(r(i[c],c,i)===!1)break}return t}}var tke=eke,rke=tke,nke=rke(),ake=nke,oke=ake,ike=vC;function ske(e,t){return e&&oke(e,t,ike)}var bX=ske,lke=Q1;function cke(e,t){return function(r,n){if(r==null)return r;if(!lke(r))return e(r,n);for(var a=r.length,i=t?a:-1,s=Object(r);(t?i--:++i<a)&&n(s[i],i,s)!==!1;);return r}}var dke=cke,uke=bX,fke=dke,mke=fke(uke),eD=mke,hke=eD,pke=Q1;function gke(e,t){var r=-1,n=pke(e)?Array(e.length):[];return hke(e,function(a,i,s){n[++r]=t(a,i,s)}),n}var wX=gke;function vke(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var xke=vke,n8=n0;function yke(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=n8(e),s=t!==void 0,l=t===null,c=t===t,d=n8(t);if(!l&&!d&&!i&&e>t||i&&s&&c&&!l&&!d||n&&s&&c||!r&&c||!a)return 1;if(!n&&!i&&!d&&e<t||d&&r&&a&&!n&&!i||l&&r&&a||!s&&a||!c)return-1}return 0}var bke=yke,wke=bke;function jke(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,s=a.length,l=r.length;++n<s;){var c=wke(a[n],i[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return e.index-t.index}var Nke=jke,sA=$I,_ke=FI,Ske=Wu,Cke=wX,Pke=xke,Ake=iX,Eke=Nke,kke=u0,Oke=Bl;function Tke(e,t,r){t.length?t=sA(t,function(i){return Oke(i)?function(s){return _ke(s,i.length===1?i[0]:i)}:i}):t=[kke];var n=-1;t=sA(t,Ake(Ske));var a=Cke(e,function(i,s,l){var c=sA(t,function(d){return d(i)});return{criteria:c,index:++n,value:i}});return Pke(a,function(i,s){return Eke(i,s,r)})}var Ike=Tke;function Dke(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Mke=Dke,Rke=Mke,a8=Math.max;function Lke(e,t,r){return t=a8(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=a8(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=n[a];return l[t]=r(s),Rke(e,this,l)}}var $ke=Lke;function Fke(e){return function(){return e}}var Bke=Fke,qke=pg,zke=function(){try{var e=qke(Object,"defineProperty");return e({},"",{}),e}catch{}}(),jX=zke,Uke=Bke,o8=jX,Vke=u0,Wke=o8?function(e,t){return o8(e,"toString",{configurable:!0,enumerable:!1,value:Uke(t),writable:!0})}:Vke,Hke=Wke,Gke=800,Kke=16,Yke=Date.now;function Xke(e){var t=0,r=0;return function(){var n=Yke(),a=Kke-(n-r);if(r=n,a>0){if(++t>=Gke)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Jke=Xke,Qke=Hke,Zke=Jke,eOe=Zke(Qke),tOe=eOe,rOe=u0,nOe=$ke,aOe=tOe;function oOe(e,t){return aOe(nOe(e,t,rOe),e+"")}var iOe=oOe,sOe=DI,lOe=Q1,cOe=JI,dOe=Sh;function uOe(e,t,r){if(!dOe(r))return!1;var n=typeof t;return(n=="number"?lOe(r)&&cOe(t,r.length):n=="string"&&t in r)?sOe(r[t],e):!1}var yC=uOe,fOe=yX,mOe=Ike,hOe=iOe,i8=yC,pOe=hOe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&i8(e,t[0],t[1])?t=[]:r>2&&i8(t[0],t[1],t[2])&&(t=[t[0]]),mOe(e,fOe(t,1),[])}),gOe=pOe;const tD=Ba(gOe);function Lb(e){"@babel/helpers - typeof";return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}function TO(){return TO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},TO.apply(this,arguments)}function vOe(e,t){return wOe(e)||bOe(e,t)||yOe(e,t)||xOe()}function xOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yOe(e,t){if(e){if(typeof e=="string")return s8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s8(e,t)}}function s8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function wOe(e){if(Array.isArray(e))return e}function l8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l8(Object(r),!0).forEach(function(n){jOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jOe(e,t,r){return t=NOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NOe(e){var t=_Oe(e,"string");return Lb(t)=="symbol"?t:t+""}function _Oe(e,t){if(Lb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SOe(e){return Array.isArray(e)&&Gi(e[0])&&Gi(e[1])?e.join(" ~ "):e}var COe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,s=t.itemStyle,l=s===void 0?{}:s,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,f=t.formatter,m=t.itemSorter,h=t.wrapperClassName,v=t.labelClassName,g=t.label,x=t.labelFormatter,y=t.accessibilityLayer,b=y===void 0?!1:y,w=function(){if(u&&u.length){var T={padding:0,margin:0},I=(m?tD(u,m):u).map(function(D,F){if(D.type==="none")return null;var z=lA({display:"block",paddingTop:4,paddingBottom:4,color:D.color||"#000"},l),q=D.formatter||f||SOe,$=D.value,K=D.name,ce=$,fe=K;if(q&&ce!=null&&fe!=null){var B=q($,K,D,F,u);if(Array.isArray(B)){var L=vOe(B,2);ce=L[0],fe=L[1]}else ce=B}return xe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(F),style:z},Gi(fe)?xe.createElement("span",{className:"recharts-tooltip-item-name"},fe):null,Gi(fe)?xe.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,xe.createElement("span",{className:"recharts-tooltip-item-value"},ce),xe.createElement("span",{className:"recharts-tooltip-item-unit"},D.unit||""))});return xe.createElement("ul",{className:"recharts-tooltip-item-list",style:T},I)}return null},j=lA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),_=lA({margin:0},d),S=!Xn(g),k=S?g:"",E=ta("recharts-default-tooltip",h),A=ta("recharts-tooltip-label",v);S&&x&&u!==void 0&&u!==null&&(k=x(g,u));var M=b?{role:"status","aria-live":"assertive"}:{};return xe.createElement("div",TO({className:E,style:j},M),xe.createElement("p",{className:A,style:_},xe.isValidElement(k)?k:"".concat(k)),w())};function $b(e){"@babel/helpers - typeof";return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(e)}function S2(e,t,r){return t=POe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function POe(e){var t=AOe(e,"string");return $b(t)=="symbol"?t:t+""}function AOe(e,t){if($b(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($b(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H0="recharts-tooltip-wrapper",EOe={visibility:"hidden"};function kOe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return ta(H0,S2(S2(S2(S2({},"".concat(H0,"-right"),Vr(r)&&t&&Vr(t.x)&&r>=t.x),"".concat(H0,"-left"),Vr(r)&&t&&Vr(t.x)&&r<t.x),"".concat(H0,"-bottom"),Vr(n)&&t&&Vr(t.y)&&n>=t.y),"".concat(H0,"-top"),Vr(n)&&t&&Vr(t.y)&&n<t.y))}function c8(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,s=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(i&&Vr(i[n]))return i[n];var u=r[n]-l-a,f=r[n]+a;if(t[n])return s[n]?u:f;if(s[n]){var m=u,h=c[n];return m<h?Math.max(f,c[n]):Math.max(u,c[n])}var v=f+l,g=c[n]+d;return v>g?Math.max(u,c[n]):Math.max(f,c[n])}function OOe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function TOe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,s=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,u,f;return s.height>0&&s.width>0&&r?(u=c8({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),f=c8({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),d=OOe({translateX:u,translateY:f,useTranslate3d:l})):d=EOe,{cssProperties:d,cssClasses:kOe({translateX:u,translateY:f,coordinate:r})}}function px(e){"@babel/helpers - typeof";return px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},px(e)}function d8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d8(Object(r),!0).forEach(function(n){DO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_X(n.key),n)}}function DOe(e,t,r){return t&&f8(e.prototype,t),r&&f8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MOe(e,t,r){return t=qN(t),ROe(e,NX()?Reflect.construct(t,r||[],qN(e).constructor):t.apply(e,r))}function ROe(e,t){if(t&&(px(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LOe(e)}function LOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NX=function(){return!!e})()}function qN(e){return qN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qN(e)}function $Oe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IO(e,t)}function IO(e,t){return IO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},IO(e,t)}function DO(e,t,r){return t=_X(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _X(e){var t=FOe(e,"string");return px(t)=="symbol"?t:t+""}function FOe(e,t){if(px(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(px(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m8=1,BOe=function(e){function t(){var r;IOe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=MOe(this,t,[].concat(a)),DO(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),DO(r,"handleKeyDown",function(s){if(s.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return $Oe(t,e),DOe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>m8||Math.abs(n.height-this.state.lastBoundingBox.height)>m8)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.children,u=a.coordinate,f=a.hasPayload,m=a.isAnimationActive,h=a.offset,v=a.position,g=a.reverseDirection,x=a.useTranslate3d,y=a.viewBox,b=a.wrapperStyle,w=TOe({allowEscapeViewBox:s,coordinate:u,offsetTopLeft:h,position:v,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:x,viewBox:y}),j=w.cssClasses,_=w.cssProperties,S=u8(u8({transition:m&&i?"transform ".concat(l,"ms ").concat(c):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},b);return xe.createElement("div",{tabIndex:-1,className:j,style:S,ref:function(E){n.wrapperNode=E}},d)}}])}(p.PureComponent),qOe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Jd={isSsr:qOe(),get:function(t){return Jd[t]},set:function(t,r){if(typeof t=="string")Jd[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(a){Jd[a]=t[a]})}}};function gx(e){"@babel/helpers - typeof";return gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gx(e)}function h8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h8(Object(r),!0).forEach(function(n){rD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CX(n.key),n)}}function UOe(e,t,r){return t&&g8(e.prototype,t),r&&g8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VOe(e,t,r){return t=zN(t),WOe(e,SX()?Reflect.construct(t,r||[],zN(e).constructor):t.apply(e,r))}function WOe(e,t){if(t&&(gx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HOe(e)}function HOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SX=function(){return!!e})()}function zN(e){return zN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zN(e)}function GOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MO(e,t)}function MO(e,t){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},MO(e,t)}function rD(e,t,r){return t=CX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CX(e){var t=KOe(e,"string");return gx(t)=="symbol"?t:t+""}function KOe(e,t){if(gx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YOe(e){return e.dataKey}function XOe(e,t){return xe.isValidElement(e)?xe.cloneElement(e,t):typeof e=="function"?xe.createElement(e,t):xe.createElement(COe,t)}var oc=function(e){function t(){return zOe(this,t),VOe(this,t,arguments)}return GOe(t,e),UOe(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.content,u=a.coordinate,f=a.filterNull,m=a.isAnimationActive,h=a.offset,v=a.payload,g=a.payloadUniqBy,x=a.position,y=a.reverseDirection,b=a.useTranslate3d,w=a.viewBox,j=a.wrapperStyle,_=v??[];f&&_.length&&(_=pX(v.filter(function(k){return k.value!=null&&(k.hide!==!0||n.props.includeHidden)}),g,YOe));var S=_.length>0;return xe.createElement(BOe,{allowEscapeViewBox:s,animationDuration:l,animationEasing:c,isAnimationActive:m,active:i,coordinate:u,hasPayload:S,offset:h,position:x,reverseDirection:y,useTranslate3d:b,viewBox:w,wrapperStyle:j},XOe(d,p8(p8({},this.props),{},{payload:_})))}}])}(p.PureComponent);rD(oc,"displayName","Tooltip");rD(oc,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Jd.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var JOe=Vu,QOe=function(){return JOe.Date.now()},ZOe=QOe,e3e=/\s/;function t3e(e){for(var t=e.length;t--&&e3e.test(e.charAt(t)););return t}var r3e=t3e,n3e=r3e,a3e=/^\s+/;function o3e(e){return e&&e.slice(0,n3e(e)+1).replace(a3e,"")}var i3e=o3e,s3e=i3e,v8=Sh,l3e=n0,x8=0/0,c3e=/^[-+]0x[0-9a-f]+$/i,d3e=/^0b[01]+$/i,u3e=/^0o[0-7]+$/i,f3e=parseInt;function m3e(e){if(typeof e=="number")return e;if(l3e(e))return x8;if(v8(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=v8(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=s3e(e);var r=d3e.test(e);return r||u3e.test(e)?f3e(e.slice(2),r?2:8):c3e.test(e)?x8:+e}var PX=m3e,h3e=Sh,cA=ZOe,y8=PX,p3e="Expected a function",g3e=Math.max,v3e=Math.min;function x3e(e,t,r){var n,a,i,s,l,c,d=0,u=!1,f=!1,m=!0;if(typeof e!="function")throw new TypeError(p3e);t=y8(t)||0,h3e(r)&&(u=!!r.leading,f="maxWait"in r,i=f?g3e(y8(r.maxWait)||0,t):i,m="trailing"in r?!!r.trailing:m);function h(S){var k=n,E=a;return n=a=void 0,d=S,s=e.apply(E,k),s}function v(S){return d=S,l=setTimeout(y,t),u?h(S):s}function g(S){var k=S-c,E=S-d,A=t-k;return f?v3e(A,i-E):A}function x(S){var k=S-c,E=S-d;return c===void 0||k>=t||k<0||f&&E>=i}function y(){var S=cA();if(x(S))return b(S);l=setTimeout(y,g(S))}function b(S){return l=void 0,m&&n?h(S):(n=a=void 0,s)}function w(){l!==void 0&&clearTimeout(l),d=0,n=c=a=l=void 0}function j(){return l===void 0?s:b(cA())}function _(){var S=cA(),k=x(S);if(n=arguments,a=this,c=S,k){if(l===void 0)return v(c);if(f)return clearTimeout(l),l=setTimeout(y,t),h(c)}return l===void 0&&(l=setTimeout(y,t)),s}return _.cancel=w,_.flush=j,_}var y3e=x3e,b3e=y3e,w3e=Sh,j3e="Expected a function";function N3e(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(j3e);return w3e(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),b3e(e,t,{leading:n,maxWait:t,trailing:a})}var _3e=N3e;const AX=Ba(_3e);function Fb(e){"@babel/helpers - typeof";return Fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fb(e)}function b8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b8(Object(r),!0).forEach(function(n){S3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S3e(e,t,r){return t=C3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C3e(e){var t=P3e(e,"string");return Fb(t)=="symbol"?t:t+""}function P3e(e,t){if(Fb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A3e(e,t){return T3e(e)||O3e(e,t)||k3e(e,t)||E3e()}function E3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k3e(e,t){if(e){if(typeof e=="string")return w8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w8(e,t)}}function w8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function T3e(e){if(Array.isArray(e))return e}var _j=p.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,s=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,f=e.minHeight,m=e.maxHeight,h=e.children,v=e.debounce,g=v===void 0?0:v,x=e.id,y=e.className,b=e.onResize,w=e.style,j=w===void 0?{}:w,_=p.useRef(null),S=p.useRef();S.current=b,p.useImperativeHandle(t,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var k=p.useState({containerWidth:a.width,containerHeight:a.height}),E=A3e(k,2),A=E[0],M=E[1],C=p.useCallback(function(I,D){M(function(F){var z=Math.round(I),q=Math.round(D);return F.containerWidth===z&&F.containerHeight===q?F:{containerWidth:z,containerHeight:q}})},[]);p.useEffect(function(){var I=function(K){var ce,fe=K[0].contentRect,B=fe.width,L=fe.height;C(B,L),(ce=S.current)===null||ce===void 0||ce.call(S,B,L)};g>0&&(I=AX(I,g,{trailing:!0,leading:!1}));var D=new ResizeObserver(I),F=_.current.getBoundingClientRect(),z=F.width,q=F.height;return C(z,q),D.observe(_.current),function(){D.disconnect()}},[C,g]);var T=p.useMemo(function(){var I=A.containerWidth,D=A.containerHeight;if(I<0||D<0)return null;Xd(hp(s)||hp(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,c),Xd(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=hp(s)?I:s,z=hp(c)?D:c;r&&r>0&&(F?z=F/r:z&&(F=z*r),m&&z>m&&(z=m)),Xd(F>0||z>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,z,s,c,u,f,r);var q=!Array.isArray(h)&&Sf(h.type).endsWith("Chart");return xe.Children.map(h,function($){return xe.isValidElement($)?p.cloneElement($,C2({width:F,height:z},q?{style:C2({height:"100%",width:"100%",maxHeight:z,maxWidth:F},$.props.style)}:{})):$})},[r,h,c,m,f,u,A,s]);return xe.createElement("div",{id:x?"".concat(x):void 0,className:ta("recharts-responsive-container",y),style:C2(C2({},j),{},{width:s,height:c,minWidth:u,minHeight:f,maxHeight:m}),ref:_},T)}),Bb=function(t){return null};Bb.displayName="Cell";function qb(e){"@babel/helpers - typeof";return qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qb(e)}function j8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j8(Object(r),!0).forEach(function(n){I3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I3e(e,t,r){return t=D3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D3e(e){var t=M3e(e,"string");return qb(t)=="symbol"?t:t+""}function M3e(e,t){if(qb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fg={widthCache:{},cacheCount:0},R3e=2e3,L3e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},N8="recharts_measurement_span";function $3e(e){var t=RO({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var qy=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Jd.isSsr)return{width:0,height:0};var n=$3e(r),a=JSON.stringify({text:t,copyStyle:n});if(Fg.widthCache[a])return Fg.widthCache[a];try{var i=document.getElementById(N8);i||(i=document.createElement("span"),i.setAttribute("id",N8),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=RO(RO({},L3e),n);Object.assign(i.style,s),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return Fg.widthCache[a]=c,++Fg.cacheCount>R3e&&(Fg.cacheCount=0,Fg.widthCache={}),c}catch{return{width:0,height:0}}},F3e=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function zb(e){"@babel/helpers - typeof";return zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zb(e)}function UN(e,t){return U3e(e)||z3e(e,t)||q3e(e,t)||B3e()}function B3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q3e(e,t){if(e){if(typeof e=="string")return _8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _8(e,t)}}function _8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function z3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function U3e(e){if(Array.isArray(e))return e}function V3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H3e(n.key),n)}}function W3e(e,t,r){return t&&S8(e.prototype,t),r&&S8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H3e(e){var t=G3e(e,"string");return zb(t)=="symbol"?t:t+""}function G3e(e,t){if(zb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var C8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,P8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,K3e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Y3e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,EX={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},X3e=Object.keys(EX),Nv="NaN";function J3e(e,t){return e*EX[t]}var P2=function(){function e(t,r){V3e(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!K3e.test(r)&&(this.num=NaN,this.unit=""),X3e.includes(r)&&(this.num=J3e(t,r),this.unit="px")}return W3e(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=Y3e.exec(r))!==null&&n!==void 0?n:[],i=UN(a,3),s=i[1],l=i[2];return new e(parseFloat(s),l??"")}}])}();function kX(e){if(e.includes(Nv))return Nv;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=C8.exec(t))!==null&&r!==void 0?r:[],a=UN(n,4),i=a[1],s=a[2],l=a[3],c=P2.parse(i??""),d=P2.parse(l??""),u=s==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return Nv;t=t.replace(C8,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,m=(f=P8.exec(t))!==null&&f!==void 0?f:[],h=UN(m,4),v=h[1],g=h[2],x=h[3],y=P2.parse(v??""),b=P2.parse(x??""),w=g==="+"?y.add(b):y.subtract(b);if(w.isNaN())return Nv;t=t.replace(P8,w.toString())}return t}var A8=/\(([^()]*)\)/;function Q3e(e){for(var t=e;t.includes("(");){var r=A8.exec(t),n=UN(r,2),a=n[1];t=t.replace(A8,kX(a))}return t}function Z3e(e){var t=e.replace(/\s+/g,"");return t=Q3e(t),t=kX(t),t}function e4e(e){try{return Z3e(e)}catch{return Nv}}function dA(e){var t=e4e(e.slice(5,-1));return t===Nv?"":t}var t4e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],r4e=["dx","dy","angle","className","breakAll"];function LO(){return LO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LO.apply(this,arguments)}function E8(e,t){if(e==null)return{};var r=n4e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function n4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function k8(e,t){return s4e(e)||i4e(e,t)||o4e(e,t)||a4e()}function a4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o4e(e,t){if(e){if(typeof e=="string")return O8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O8(e,t)}}function O8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function s4e(e){if(Array.isArray(e))return e}var OX=/[ \f\n\r\t\v\u2028\u2029]+/,TX=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];Xn(r)||(n?i=r.toString().split(""):i=r.toString().split(OX));var s=i.map(function(c){return{word:c,width:qy(c,a).width}}),l=n?0:qy("",a).width;return{wordsWithComputedWidth:s,spaceWidth:l}}catch{return null}},l4e=function(t,r,n,a,i){var s=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=Vr(s),f=l,m=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return F.reduce(function(z,q){var $=q.word,K=q.width,ce=z[z.length-1];if(ce&&(a==null||i||ce.width+K+n<Number(a)))ce.words.push($),ce.width+=K+n;else{var fe={words:[$],width:K};z.push(fe)}return z},[])},h=m(r),v=function(F){return F.reduce(function(z,q){return z.width>q.width?z:q})};if(!u)return h;for(var g="",x=function(F){var z=f.slice(0,F),q=TX({breakAll:d,style:c,children:z+g}).wordsWithComputedWidth,$=m(q),K=$.length>s||v($).width>Number(a);return[K,$]},y=0,b=f.length-1,w=0,j;y<=b&&w<=f.length-1;){var _=Math.floor((y+b)/2),S=_-1,k=x(S),E=k8(k,2),A=E[0],M=E[1],C=x(_),T=k8(C,1),I=T[0];if(!A&&!I&&(y=_+1),A&&I&&(b=_-1),!A&&I){j=M;break}w++}return j||h},T8=function(t){var r=Xn(t)?[]:t.toString().split(OX);return[{words:r}]},c4e=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,s=t.breakAll,l=t.maxLines;if((r||n)&&!Jd.isSsr){var c,d,u=TX({breakAll:s,children:a,style:i});if(u){var f=u.wordsWithComputedWidth,m=u.spaceWidth;c=f,d=m}else return T8(a);return l4e({breakAll:s,children:a,maxLines:l,style:i},c,d,r,n)}return T8(a)},I8="#808080",Xp=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.lineHeight,l=s===void 0?"1em":s,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,f=u===void 0?!1:u,m=t.textAnchor,h=m===void 0?"start":m,v=t.verticalAnchor,g=v===void 0?"end":v,x=t.fill,y=x===void 0?I8:x,b=E8(t,t4e),w=p.useMemo(function(){return c4e({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:f,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,f,b.style,b.width]),j=b.dx,_=b.dy,S=b.angle,k=b.className,E=b.breakAll,A=E8(b,r4e);if(!Gi(n)||!Gi(i))return null;var M=n+(Vr(j)?j:0),C=i+(Vr(_)?_:0),T;switch(g){case"start":T=dA("calc(".concat(d,")"));break;case"middle":T=dA("calc(".concat((w.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:T=dA("calc(".concat(w.length-1," * -").concat(l,")"));break}var I=[];if(f){var D=w[0].width,F=b.width;I.push("scale(".concat((Vr(F)?F/D:1)/D,")"))}return S&&I.push("rotate(".concat(S,", ").concat(M,", ").concat(C,")")),I.length&&(A.transform=I.join(" ")),xe.createElement("text",LO({},On(A,!0),{x:M,y:C,className:ta("recharts-text",k),textAnchor:h,fill:y.includes("url")?I8:y}),w.map(function(z,q){var $=z.words.join(E?"":" ");return xe.createElement("tspan",{x:M,dy:q===0?T:l,key:"".concat($,"-").concat(q)},$)}))};function Qm(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function d4e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nD(e){let t,r,n;e.length!==2?(t=Qm,r=(l,c)=>Qm(e(l),c),n=(l,c)=>e(l)-c):(t=e===Qm||e===d4e?e:u4e,r=e,n=e);function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function s(l,c,d=0,u=l.length){const f=a(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:s,right:i}}function u4e(){return 0}function IX(e){return e===null?NaN:+e}function*f4e(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const m4e=nD(Qm),h4e=m4e.right;nD(IX).center;const Z1=h4e;class D8 extends Map{constructor(t,r=v4e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(M8(this,t))}has(t){return super.has(M8(this,t))}set(t,r){return super.set(p4e(this,t),r)}delete(t){return super.delete(g4e(this,t))}}function M8({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function p4e({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function g4e({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function v4e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function x4e(e=Qm){if(e===Qm)return DX;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function DX(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const y4e=Math.sqrt(50),b4e=Math.sqrt(10),w4e=Math.sqrt(2);function VN(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=y4e?10:i>=b4e?5:i>=w4e?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/s,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*s,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?VN(e,t,r*2):[l,c,d]}function $O(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?VN(t,e,r):VN(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(s<0)for(let d=0;d<l;++d)c[d]=(i-d)/-s;else for(let d=0;d<l;++d)c[d]=(i-d)*s;else if(s<0)for(let d=0;d<l;++d)c[d]=(a+d)/-s;else for(let d=0;d<l;++d)c[d]=(a+d)*s;return c}function FO(e,t,r){return t=+t,e=+e,r=+r,VN(e,t,r)[2]}function BO(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?FO(t,e,r):FO(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function R8(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r<a||r===void 0&&a>=a)&&(r=a)}return r}function L8(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r>a||r===void 0&&a>=a)&&(r=a)}return r}function MX(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?DX:x4e(a);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),h=Math.max(r,Math.floor(t-d*f/c+m)),v=Math.min(n,Math.floor(t+(c-d)*f/c+m));MX(e,t,h,v,a)}const i=e[t];let s=r,l=n;for(G0(e,r,t),a(e[n],i)>0&&G0(e,r,n);s<l;){for(G0(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?G0(e,r,l):(++l,G0(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function G0(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function j4e(e,t,r){if(e=Float64Array.from(f4e(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return L8(e);if(t>=1)return R8(e);var n,a=(n-1)*t,i=Math.floor(a),s=R8(MX(e,i).subarray(0,i+1)),l=L8(e.subarray(i+1));return s+(l-s)*(a-i)}}function N4e(e,t,r=IX){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function _4e(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function jd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Gf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const qO=Symbol("implicit");function aD(){var e=new D8,t=[],r=[],n=qO;function a(i){let s=e.get(i);if(s===void 0){if(n!==qO)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new D8;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return aD(t,r).unknown(n)},jd.apply(a,arguments),a}function Ub(){var e=aD().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var m=t().length,h=a<n,v=h?a:n,g=h?n:a;i=(g-v)/Math.max(1,m-c+d*2),l&&(i=Math.floor(i)),v+=(g-v-i*(m-c))*u,s=i*(1-c),l&&(v=Math.round(v),s=Math.round(s));var x=_4e(m).map(function(y){return v+i*y});return r(h?x.reverse():x)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([n,a]=m,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(m){return[n,a]=m,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(m){return arguments.length?(l=!!m,f()):l},e.padding=function(m){return arguments.length?(c=Math.min(1,d=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(d=+m,f()):d},e.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),f()):u},e.copy=function(){return Ub(t(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},jd.apply(f(),arguments)}function RX(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return RX(t())},e}function zy(){return RX(Ub.apply(null,arguments).paddingInner(1))}function oD(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function LX(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ew(){}var Vb=.7,WN=1/Vb,qv="\\s*([+-]?\\d+)\\s*",Wb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Du="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",S4e=/^#([0-9a-f]{3,8})$/,C4e=new RegExp(`^rgb\\(${qv},${qv},${qv}\\)$`),P4e=new RegExp(`^rgb\\(${Du},${Du},${Du}\\)$`),A4e=new RegExp(`^rgba\\(${qv},${qv},${qv},${Wb}\\)$`),E4e=new RegExp(`^rgba\\(${Du},${Du},${Du},${Wb}\\)$`),k4e=new RegExp(`^hsl\\(${Wb},${Du},${Du}\\)$`),O4e=new RegExp(`^hsla\\(${Wb},${Du},${Du},${Wb}\\)$`),$8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};oD(ew,Hb,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:F8,formatHex:F8,formatHex8:T4e,formatHsl:I4e,formatRgb:B8,toString:B8});function F8(){return this.rgb().formatHex()}function T4e(){return this.rgb().formatHex8()}function I4e(){return $X(this).formatHsl()}function B8(){return this.rgb().formatRgb()}function Hb(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=S4e.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?q8(t):r===3?new El(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?A2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?A2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=C4e.exec(e))?new El(t[1],t[2],t[3],1):(t=P4e.exec(e))?new El(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=A4e.exec(e))?A2(t[1],t[2],t[3],t[4]):(t=E4e.exec(e))?A2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=k4e.exec(e))?V8(t[1],t[2]/100,t[3]/100,1):(t=O4e.exec(e))?V8(t[1],t[2]/100,t[3]/100,t[4]):$8.hasOwnProperty(e)?q8($8[e]):e==="transparent"?new El(NaN,NaN,NaN,0):null}function q8(e){return new El(e>>16&255,e>>8&255,e&255,1)}function A2(e,t,r,n){return n<=0&&(e=t=r=NaN),new El(e,t,r,n)}function D4e(e){return e instanceof ew||(e=Hb(e)),e?(e=e.rgb(),new El(e.r,e.g,e.b,e.opacity)):new El}function zO(e,t,r,n){return arguments.length===1?D4e(e):new El(e,t,r,n??1)}function El(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}oD(El,zO,LX(ew,{brighter(e){return e=e==null?WN:Math.pow(WN,e),new El(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Vb:Math.pow(Vb,e),new El(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new El(kp(this.r),kp(this.g),kp(this.b),HN(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:z8,formatHex:z8,formatHex8:M4e,formatRgb:U8,toString:U8}));function z8(){return`#${pp(this.r)}${pp(this.g)}${pp(this.b)}`}function M4e(){return`#${pp(this.r)}${pp(this.g)}${pp(this.b)}${pp((isNaN(this.opacity)?1:this.opacity)*255)}`}function U8(){const e=HN(this.opacity);return`${e===1?"rgb(":"rgba("}${kp(this.r)}, ${kp(this.g)}, ${kp(this.b)}${e===1?")":`, ${e})`}`}function HN(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function kp(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function pp(e){return e=kp(e),(e<16?"0":"")+e.toString(16)}function V8(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ud(e,t,r,n)}function $X(e){if(e instanceof Ud)return new Ud(e.h,e.s,e.l,e.opacity);if(e instanceof ew||(e=Hb(e)),!e)return new Ud;if(e instanceof Ud)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,c=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=c<.5?i+a:2-i-a,s*=60):l=c>0&&c<1?0:s,new Ud(s,l,c,e.opacity)}function R4e(e,t,r,n){return arguments.length===1?$X(e):new Ud(e,t,r,n??1)}function Ud(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}oD(Ud,R4e,LX(ew,{brighter(e){return e=e==null?WN:Math.pow(WN,e),new Ud(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Vb:Math.pow(Vb,e),new Ud(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new El(uA(e>=240?e-240:e+120,a,n),uA(e,a,n),uA(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ud(W8(this.h),E2(this.s),E2(this.l),HN(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=HN(this.opacity);return`${e===1?"hsl(":"hsla("}${W8(this.h)}, ${E2(this.s)*100}%, ${E2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function W8(e){return e=(e||0)%360,e<0?e+360:e}function E2(e){return Math.max(0,Math.min(1,e||0))}function uA(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const iD=e=>()=>e;function L4e(e,t){return function(r){return e+r*t}}function $4e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function F4e(e){return(e=+e)==1?FX:function(t,r){return r-t?$4e(t,r,e):iD(isNaN(t)?r:t)}}function FX(e,t){var r=t-e;return r?L4e(e,r):iD(isNaN(e)?t:e)}const H8=function e(t){var r=F4e(t);function n(a,i){var s=r((a=zO(a)).r,(i=zO(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),d=FX(a.opacity,i.opacity);return function(u){return a.r=s(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return n.gamma=e,n}(1);function B4e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function q4e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function z4e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=f0(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function U4e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function GN(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function V4e(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=f0(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var UO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fA=new RegExp(UO.source,"g");function W4e(e){return function(){return e}}function H4e(e){return function(t){return e(t)+""}}function G4e(e,t){var r=UO.lastIndex=fA.lastIndex=0,n,a,i,s=-1,l=[],c=[];for(e=e+"",t=t+"";(n=UO.exec(e))&&(a=fA.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,c.push({i:s,x:GN(n,a)})),r=fA.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?c[0]?H4e(c[0].x):W4e(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function f0(e,t){var r=typeof t,n;return t==null||r==="boolean"?iD(t):(r==="number"?GN:r==="string"?(n=Hb(t))?(t=n,H8):G4e:t instanceof Hb?H8:t instanceof Date?U4e:q4e(t)?B4e:Array.isArray(t)?z4e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?V4e:GN)(e,t)}function sD(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function K4e(e,t){t===void 0&&(t=e,e=f0);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function Y4e(e){return function(){return e}}function KN(e){return+e}var G8=[0,1];function fl(e){return e}function VO(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Y4e(isNaN(t)?NaN:.5)}function X4e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function J4e(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=VO(a,n),i=r(s,i)):(n=VO(n,a),i=r(i,s)),function(l){return i(n(l))}}function Q4e(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=VO(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var c=Z1(e,l,1,n)-1;return i[c](a[c](l))}}function tw(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function bC(){var e=G8,t=G8,r=f0,n,a,i,s=fl,l,c,d;function u(){var m=Math.min(e.length,t.length);return s!==fl&&(s=X4e(e[0],e[m-1])),l=m>2?Q4e:J4e,c=d=null,f}function f(m){return m==null||isNaN(m=+m)?i:(c||(c=l(e.map(n),t,r)))(n(s(m)))}return f.invert=function(m){return s(a((d||(d=l(t,e.map(n),GN)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,KN),u()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),u()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),r=sD,u()},f.clamp=function(m){return arguments.length?(s=m?!0:fl,u()):s!==fl},f.interpolate=function(m){return arguments.length?(r=m,u()):r},f.unknown=function(m){return arguments.length?(i=m,f):i},function(m,h){return n=m,a=h,u()}}function lD(){return bC()(fl,fl)}function Z4e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function YN(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function vx(e){return e=YN(Math.abs(e)),e?e[1]:NaN}function eTe(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function tTe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var rTe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gb(e){if(!(t=rTe.exec(e)))throw new Error("invalid format: "+e);var t;return new cD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Gb.prototype=cD.prototype;function cD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}cD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function nTe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var BX;function aTe(e,t){var r=YN(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(BX=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+YN(e,Math.max(0,t+i-1))[0]}function K8(e,t){var r=YN(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const Y8={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Z4e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>K8(e*100,t),r:K8,s:aTe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function X8(e){return e}var J8=Array.prototype.map,Q8=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function oTe(e){var t=e.grouping===void 0||e.thousands===void 0?X8:eTe(J8.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?X8:tTe(J8.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=Gb(f);var m=f.fill,h=f.align,v=f.sign,g=f.symbol,x=f.zero,y=f.width,b=f.comma,w=f.precision,j=f.trim,_=f.type;_==="n"?(b=!0,_="g"):Y8[_]||(w===void 0&&(w=12),j=!0,_="g"),(x||m==="0"&&h==="=")&&(x=!0,m="0",h="=");var S=g==="$"?r:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",k=g==="$"?n:/[%p]/.test(_)?s:"",E=Y8[_],A=/[defgprs%]/.test(_);w=w===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function M(C){var T=S,I=k,D,F,z;if(_==="c")I=E(C)+I,C="";else{C=+C;var q=C<0||1/C<0;if(C=isNaN(C)?c:E(Math.abs(C),w),j&&(C=nTe(C)),q&&+C==0&&v!=="+"&&(q=!1),T=(q?v==="("?v:l:v==="-"||v==="("?"":v)+T,I=(_==="s"?Q8[8+BX/3]:"")+I+(q&&v==="("?")":""),A){for(D=-1,F=C.length;++D<F;)if(z=C.charCodeAt(D),48>z||z>57){I=(z===46?a+C.slice(D+1):C.slice(D))+I,C=C.slice(0,D);break}}}b&&!x&&(C=t(C,1/0));var $=T.length+C.length+I.length,K=$<y?new Array(y-$+1).join(m):"";switch(b&&x&&(C=t(K+C,K.length?y-I.length:1/0),K=""),h){case"<":C=T+C+I+K;break;case"=":C=T+K+C+I;break;case"^":C=K.slice(0,$=K.length>>1)+T+C+I+K.slice($);break;default:C=K+T+C+I;break}return i(C)}return M.toString=function(){return f+""},M}function u(f,m){var h=d((f=Gb(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(vx(m)/3)))*3,g=Math.pow(10,-v),x=Q8[8+v/3];return function(y){return h(g*y)+x}}return{format:d,formatPrefix:u}}var k2,dD,qX;iTe({thousands:",",grouping:[3],currency:["$",""]});function iTe(e){return k2=oTe(e),dD=k2.format,qX=k2.formatPrefix,k2}function sTe(e){return Math.max(0,-vx(Math.abs(e)))}function lTe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(vx(t)/3)))*3-vx(Math.abs(e)))}function cTe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,vx(t)-vx(e))+1}function zX(e,t,r,n){var a=BO(e,t,r),i;switch(n=Gb(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=lTe(a,s))&&(n.precision=i),qX(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=cTe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=sTe(a))&&(n.precision=i-(n.type==="%")*2);break}}return dD(n)}function Ch(e){var t=e.domain;return e.ticks=function(r){var n=t();return $O(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return zX(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],c,d,u=10;for(l<s&&(d=s,s=l,l=d,d=a,a=i,i=d);u-- >0;){if(d=FO(s,l,r),d===c)return n[a]=s,n[i]=l,t(n);if(d>0)s=Math.floor(s/d)*d,l=Math.ceil(l/d)*d;else if(d<0)s=Math.ceil(s*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function XN(){var e=lD();return e.copy=function(){return tw(e,XN())},jd.apply(e,arguments),Ch(e)}function UX(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,KN),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return UX(e).unknown(t)},e=arguments.length?Array.from(e,KN):[0,1],Ch(r)}function VX(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function Z8(e){return Math.log(e)}function eB(e){return Math.exp(e)}function dTe(e){return-Math.log(-e)}function uTe(e){return-Math.exp(-e)}function fTe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function mTe(e){return e===10?fTe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function hTe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function tB(e){return(t,r)=>-e(-t,r)}function uD(e){const t=e(Z8,eB),r=t.domain;let n=10,a,i;function s(){return a=hTe(n),i=mTe(n),r()[0]<0?(a=tB(a),i=tB(i),e(dTe,uTe)):e(Z8,eB),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let m=a(d),h=a(u),v,g;const x=l==null?10:+l;let y=[];if(!(n%1)&&h-m<x){if(m=Math.floor(m),h=Math.ceil(h),d>0){for(;m<=h;++m)for(v=1;v<n;++v)if(g=m<0?v/i(-m):v*i(m),!(g<d)){if(g>u)break;y.push(g)}}else for(;m<=h;++m)for(v=n-1;v>=1;--v)if(g=m>0?v/i(-m):v*i(m),!(g<d)){if(g>u)break;y.push(g)}y.length*2<x&&(y=$O(d,u,x))}else y=$O(m,h,Math.min(h-m,x)).map(i);return f?y.reverse():y},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Gb(c)).precision==null&&(c.trim=!0),c=dD(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let f=u/i(Math.round(a(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},t.nice=()=>r(VX(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function WX(){const e=uD(bC()).domain([1,10]);return e.copy=()=>tw(e,WX()).base(e.base()),jd.apply(e,arguments),e}function rB(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function nB(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function fD(e){var t=1,r=e(rB(t),nB(t));return r.constant=function(n){return arguments.length?e(rB(t=+n),nB(t)):t},Ch(r)}function HX(){var e=fD(bC());return e.copy=function(){return tw(e,HX()).constant(e.constant())},jd.apply(e,arguments)}function aB(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function pTe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function gTe(e){return e<0?-e*e:e*e}function mD(e){var t=e(fl,fl),r=1;function n(){return r===1?e(fl,fl):r===.5?e(pTe,gTe):e(aB(r),aB(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Ch(t)}function hD(){var e=mD(bC());return e.copy=function(){return tw(e,hD()).exponent(e.exponent())},jd.apply(e,arguments),e}function vTe(){return hD.apply(null,arguments).exponent(.5)}function oB(e){return Math.sign(e)*e*e}function xTe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function GX(){var e=lD(),t=[0,1],r=!1,n;function a(i){var s=xTe(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(oB(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,KN)).map(oB)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return GX(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},jd.apply(a,arguments),Ch(a)}function KX(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=N4e(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Z1(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Qm),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return KX().domain(e).range(t).unknown(n)},jd.apply(i,arguments)}function YX(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[Z1(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},s.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return YX().domain([e,t]).range(a).unknown(i)},jd.apply(Ch(s),arguments)}function XX(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Z1(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return XX().domain(e).range(t).unknown(r)},jd.apply(a,arguments)}const mA=new Date,hA=new Date;function Ki(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<s);return c},a.filter=i=>Ki(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(mA.setTime(+i),hA.setTime(+s),e(mA),e(hA),Math.floor(r(mA,hA))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const JN=Ki(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);JN.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ki(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):JN);JN.range;const xf=1e3,od=xf*60,yf=od*60,Mf=yf*24,pD=Mf*7,iB=Mf*30,pA=Mf*365,gp=Ki(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*xf)},(e,t)=>(t-e)/xf,e=>e.getUTCSeconds());gp.range;const gD=Ki(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*xf)},(e,t)=>{e.setTime(+e+t*od)},(e,t)=>(t-e)/od,e=>e.getMinutes());gD.range;const vD=Ki(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*od)},(e,t)=>(t-e)/od,e=>e.getUTCMinutes());vD.range;const xD=Ki(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*xf-e.getMinutes()*od)},(e,t)=>{e.setTime(+e+t*yf)},(e,t)=>(t-e)/yf,e=>e.getHours());xD.range;const yD=Ki(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*yf)},(e,t)=>(t-e)/yf,e=>e.getUTCHours());yD.range;const rw=Ki(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*od)/Mf,e=>e.getDate()-1);rw.range;const wC=Ki(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Mf,e=>e.getUTCDate()-1);wC.range;const JX=Ki(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Mf,e=>Math.floor(e/Mf));JX.range;function vg(e){return Ki(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*od)/pD)}const jC=vg(0),QN=vg(1),yTe=vg(2),bTe=vg(3),xx=vg(4),wTe=vg(5),jTe=vg(6);jC.range;QN.range;yTe.range;bTe.range;xx.range;wTe.range;jTe.range;function xg(e){return Ki(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/pD)}const NC=xg(0),ZN=xg(1),NTe=xg(2),_Te=xg(3),yx=xg(4),STe=xg(5),CTe=xg(6);NC.range;ZN.range;NTe.range;_Te.range;yx.range;STe.range;CTe.range;const bD=Ki(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());bD.range;const wD=Ki(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());wD.range;const Rf=Ki(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Rf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ki(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Rf.range;const Lf=Ki(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Lf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ki(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Lf.range;function QX(e,t,r,n,a,i){const s=[[gp,1,xf],[gp,5,5*xf],[gp,15,15*xf],[gp,30,30*xf],[i,1,od],[i,5,5*od],[i,15,15*od],[i,30,30*od],[a,1,yf],[a,3,3*yf],[a,6,6*yf],[a,12,12*yf],[n,1,Mf],[n,2,2*Mf],[r,1,pD],[t,1,iB],[t,3,3*iB],[e,1,pA]];function l(d,u,f){const m=u<d;m&&([d,u]=[u,d]);const h=f&&typeof f.range=="function"?f:c(d,u,f),v=h?h.range(d,+u+1):[];return m?v.reverse():v}function c(d,u,f){const m=Math.abs(u-d)/f,h=nD(([,,x])=>x).right(s,m);if(h===s.length)return e.every(BO(d/pA,u/pA,f));if(h===0)return JN.every(Math.max(BO(d,u,f),1));const[v,g]=s[m/s[h-1][2]<s[h][2]/m?h-1:h];return v.every(g)}return[l,c]}const[PTe,ATe]=QX(Lf,wD,NC,JX,yD,vD),[ETe,kTe]=QX(Rf,bD,jC,rw,xD,gD);function gA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function vA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function K0(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function OTe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,c=e.shortMonths,d=Y0(a),u=X0(a),f=Y0(i),m=X0(i),h=Y0(s),v=X0(s),g=Y0(l),x=X0(l),y=Y0(c),b=X0(c),w={a:q,A:$,b:K,B:ce,c:null,d:fB,e:fB,f:eIe,g:dIe,G:fIe,H:JTe,I:QTe,j:ZTe,L:ZX,m:tIe,M:rIe,p:fe,q:B,Q:pB,s:gB,S:nIe,u:aIe,U:oIe,V:iIe,w:sIe,W:lIe,x:null,X:null,y:cIe,Y:uIe,Z:mIe,"%":hB},j={a:L,A:V,b:re,B:me,c:null,d:mB,e:mB,f:vIe,g:PIe,G:EIe,H:hIe,I:pIe,j:gIe,L:tJ,m:xIe,M:yIe,p:G,q:Q,Q:pB,s:gB,S:bIe,u:wIe,U:jIe,V:NIe,w:_Ie,W:SIe,x:null,X:null,y:CIe,Y:AIe,Z:kIe,"%":hB},_={a:M,A:C,b:T,B:I,c:D,d:dB,e:dB,f:GTe,g:cB,G:lB,H:uB,I:uB,j:UTe,L:HTe,m:zTe,M:VTe,p:A,q:qTe,Q:YTe,s:XTe,S:WTe,u:RTe,U:LTe,V:$Te,w:MTe,W:FTe,x:F,X:z,y:cB,Y:lB,Z:BTe,"%":KTe};w.x=S(r,w),w.X=S(n,w),w.c=S(t,w),j.x=S(r,j),j.X=S(n,j),j.c=S(t,j);function S(ae,J){return function(je){var be=[],Ue=-1,Z=0,Y=ae.length,lt,gt,Te;for(je instanceof Date||(je=new Date(+je));++Ue<Y;)ae.charCodeAt(Ue)===37&&(be.push(ae.slice(Z,Ue)),(gt=sB[lt=ae.charAt(++Ue)])!=null?lt=ae.charAt(++Ue):gt=lt==="e"?" ":"0",(Te=J[lt])&&(lt=Te(je,gt)),be.push(lt),Z=Ue+1);return be.push(ae.slice(Z,Ue)),be.join("")}}function k(ae,J){return function(je){var be=K0(1900,void 0,1),Ue=E(be,ae,je+="",0),Z,Y;if(Ue!=je.length)return null;if("Q"in be)return new Date(be.Q);if("s"in be)return new Date(be.s*1e3+("L"in be?be.L:0));if(J&&!("Z"in be)&&(be.Z=0),"p"in be&&(be.H=be.H%12+be.p*12),be.m===void 0&&(be.m="q"in be?be.q:0),"V"in be){if(be.V<1||be.V>53)return null;"w"in be||(be.w=1),"Z"in be?(Z=vA(K0(be.y,0,1)),Y=Z.getUTCDay(),Z=Y>4||Y===0?ZN.ceil(Z):ZN(Z),Z=wC.offset(Z,(be.V-1)*7),be.y=Z.getUTCFullYear(),be.m=Z.getUTCMonth(),be.d=Z.getUTCDate()+(be.w+6)%7):(Z=gA(K0(be.y,0,1)),Y=Z.getDay(),Z=Y>4||Y===0?QN.ceil(Z):QN(Z),Z=rw.offset(Z,(be.V-1)*7),be.y=Z.getFullYear(),be.m=Z.getMonth(),be.d=Z.getDate()+(be.w+6)%7)}else("W"in be||"U"in be)&&("w"in be||(be.w="u"in be?be.u%7:"W"in be?1:0),Y="Z"in be?vA(K0(be.y,0,1)).getUTCDay():gA(K0(be.y,0,1)).getDay(),be.m=0,be.d="W"in be?(be.w+6)%7+be.W*7-(Y+5)%7:be.w+be.U*7-(Y+6)%7);return"Z"in be?(be.H+=be.Z/100|0,be.M+=be.Z%100,vA(be)):gA(be)}}function E(ae,J,je,be){for(var Ue=0,Z=J.length,Y=je.length,lt,gt;Ue<Z;){if(be>=Y)return-1;if(lt=J.charCodeAt(Ue++),lt===37){if(lt=J.charAt(Ue++),gt=_[lt in sB?J.charAt(Ue++):lt],!gt||(be=gt(ae,je,be))<0)return-1}else if(lt!=je.charCodeAt(be++))return-1}return be}function A(ae,J,je){var be=d.exec(J.slice(je));return be?(ae.p=u.get(be[0].toLowerCase()),je+be[0].length):-1}function M(ae,J,je){var be=h.exec(J.slice(je));return be?(ae.w=v.get(be[0].toLowerCase()),je+be[0].length):-1}function C(ae,J,je){var be=f.exec(J.slice(je));return be?(ae.w=m.get(be[0].toLowerCase()),je+be[0].length):-1}function T(ae,J,je){var be=y.exec(J.slice(je));return be?(ae.m=b.get(be[0].toLowerCase()),je+be[0].length):-1}function I(ae,J,je){var be=g.exec(J.slice(je));return be?(ae.m=x.get(be[0].toLowerCase()),je+be[0].length):-1}function D(ae,J,je){return E(ae,t,J,je)}function F(ae,J,je){return E(ae,r,J,je)}function z(ae,J,je){return E(ae,n,J,je)}function q(ae){return s[ae.getDay()]}function $(ae){return i[ae.getDay()]}function K(ae){return c[ae.getMonth()]}function ce(ae){return l[ae.getMonth()]}function fe(ae){return a[+(ae.getHours()>=12)]}function B(ae){return 1+~~(ae.getMonth()/3)}function L(ae){return s[ae.getUTCDay()]}function V(ae){return i[ae.getUTCDay()]}function re(ae){return c[ae.getUTCMonth()]}function me(ae){return l[ae.getUTCMonth()]}function G(ae){return a[+(ae.getUTCHours()>=12)]}function Q(ae){return 1+~~(ae.getUTCMonth()/3)}return{format:function(ae){var J=S(ae+="",w);return J.toString=function(){return ae},J},parse:function(ae){var J=k(ae+="",!1);return J.toString=function(){return ae},J},utcFormat:function(ae){var J=S(ae+="",j);return J.toString=function(){return ae},J},utcParse:function(ae){var J=k(ae+="",!0);return J.toString=function(){return ae},J}}}var sB={"-":"",_:" ",0:"0"},ss=/^\s*\d+/,TTe=/^%/,ITe=/[\\^$*+?|[\]().{}]/g;function Va(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function DTe(e){return e.replace(ITe,"\\$&")}function Y0(e){return new RegExp("^(?:"+e.map(DTe).join("|")+")","i")}function X0(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function MTe(e,t,r){var n=ss.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function RTe(e,t,r){var n=ss.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function LTe(e,t,r){var n=ss.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function $Te(e,t,r){var n=ss.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function FTe(e,t,r){var n=ss.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function lB(e,t,r){var n=ss.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function cB(e,t,r){var n=ss.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function BTe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function qTe(e,t,r){var n=ss.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function zTe(e,t,r){var n=ss.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function dB(e,t,r){var n=ss.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function UTe(e,t,r){var n=ss.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function uB(e,t,r){var n=ss.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function VTe(e,t,r){var n=ss.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function WTe(e,t,r){var n=ss.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function HTe(e,t,r){var n=ss.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function GTe(e,t,r){var n=ss.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function KTe(e,t,r){var n=TTe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function YTe(e,t,r){var n=ss.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function XTe(e,t,r){var n=ss.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function fB(e,t){return Va(e.getDate(),t,2)}function JTe(e,t){return Va(e.getHours(),t,2)}function QTe(e,t){return Va(e.getHours()%12||12,t,2)}function ZTe(e,t){return Va(1+rw.count(Rf(e),e),t,3)}function ZX(e,t){return Va(e.getMilliseconds(),t,3)}function eIe(e,t){return ZX(e,t)+"000"}function tIe(e,t){return Va(e.getMonth()+1,t,2)}function rIe(e,t){return Va(e.getMinutes(),t,2)}function nIe(e,t){return Va(e.getSeconds(),t,2)}function aIe(e){var t=e.getDay();return t===0?7:t}function oIe(e,t){return Va(jC.count(Rf(e)-1,e),t,2)}function eJ(e){var t=e.getDay();return t>=4||t===0?xx(e):xx.ceil(e)}function iIe(e,t){return e=eJ(e),Va(xx.count(Rf(e),e)+(Rf(e).getDay()===4),t,2)}function sIe(e){return e.getDay()}function lIe(e,t){return Va(QN.count(Rf(e)-1,e),t,2)}function cIe(e,t){return Va(e.getFullYear()%100,t,2)}function dIe(e,t){return e=eJ(e),Va(e.getFullYear()%100,t,2)}function uIe(e,t){return Va(e.getFullYear()%1e4,t,4)}function fIe(e,t){var r=e.getDay();return e=r>=4||r===0?xx(e):xx.ceil(e),Va(e.getFullYear()%1e4,t,4)}function mIe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Va(t/60|0,"0",2)+Va(t%60,"0",2)}function mB(e,t){return Va(e.getUTCDate(),t,2)}function hIe(e,t){return Va(e.getUTCHours(),t,2)}function pIe(e,t){return Va(e.getUTCHours()%12||12,t,2)}function gIe(e,t){return Va(1+wC.count(Lf(e),e),t,3)}function tJ(e,t){return Va(e.getUTCMilliseconds(),t,3)}function vIe(e,t){return tJ(e,t)+"000"}function xIe(e,t){return Va(e.getUTCMonth()+1,t,2)}function yIe(e,t){return Va(e.getUTCMinutes(),t,2)}function bIe(e,t){return Va(e.getUTCSeconds(),t,2)}function wIe(e){var t=e.getUTCDay();return t===0?7:t}function jIe(e,t){return Va(NC.count(Lf(e)-1,e),t,2)}function rJ(e){var t=e.getUTCDay();return t>=4||t===0?yx(e):yx.ceil(e)}function NIe(e,t){return e=rJ(e),Va(yx.count(Lf(e),e)+(Lf(e).getUTCDay()===4),t,2)}function _Ie(e){return e.getUTCDay()}function SIe(e,t){return Va(ZN.count(Lf(e)-1,e),t,2)}function CIe(e,t){return Va(e.getUTCFullYear()%100,t,2)}function PIe(e,t){return e=rJ(e),Va(e.getUTCFullYear()%100,t,2)}function AIe(e,t){return Va(e.getUTCFullYear()%1e4,t,4)}function EIe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?yx(e):yx.ceil(e),Va(e.getUTCFullYear()%1e4,t,4)}function kIe(){return"+0000"}function hB(){return"%"}function pB(e){return+e}function gB(e){return Math.floor(+e/1e3)}var Bg,nJ,aJ;OIe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function OIe(e){return Bg=OTe(e),nJ=Bg.format,Bg.parse,aJ=Bg.utcFormat,Bg.utcParse,Bg}function TIe(e){return new Date(e)}function IIe(e){return e instanceof Date?+e:+new Date(+e)}function jD(e,t,r,n,a,i,s,l,c,d){var u=lD(),f=u.invert,m=u.domain,h=d(".%L"),v=d(":%S"),g=d("%I:%M"),x=d("%I %p"),y=d("%a %d"),b=d("%b %d"),w=d("%B"),j=d("%Y");function _(S){return(c(S)<S?h:l(S)<S?v:s(S)<S?g:i(S)<S?x:n(S)<S?a(S)<S?y:b:r(S)<S?w:j)(S)}return u.invert=function(S){return new Date(f(S))},u.domain=function(S){return arguments.length?m(Array.from(S,IIe)):m().map(TIe)},u.ticks=function(S){var k=m();return e(k[0],k[k.length-1],S??10)},u.tickFormat=function(S,k){return k==null?_:d(k)},u.nice=function(S){var k=m();return(!S||typeof S.range!="function")&&(S=t(k[0],k[k.length-1],S??10)),S?m(VX(k,S)):u},u.copy=function(){return tw(u,jD(e,t,r,n,a,i,s,l,c,d))},u}function DIe(){return jd.apply(jD(ETe,kTe,Rf,bD,jC,rw,xD,gD,gp,nJ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function MIe(){return jd.apply(jD(PTe,ATe,Lf,wD,NC,wC,yD,vD,gp,aJ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function _C(){var e=0,t=1,r,n,a,i,s=fl,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(s=f,d):s};function u(f){return function(m){var h,v;return arguments.length?([h,v]=m,s=f(h,v),d):[s(0),s(1)]}}return d.range=u(f0),d.rangeRound=u(sD),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),d}}function Ph(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function oJ(){var e=Ch(_C()(fl));return e.copy=function(){return Ph(e,oJ())},Gf.apply(e,arguments)}function iJ(){var e=uD(_C()).domain([1,10]);return e.copy=function(){return Ph(e,iJ()).base(e.base())},Gf.apply(e,arguments)}function sJ(){var e=fD(_C());return e.copy=function(){return Ph(e,sJ()).constant(e.constant())},Gf.apply(e,arguments)}function ND(){var e=mD(_C());return e.copy=function(){return Ph(e,ND()).exponent(e.exponent())},Gf.apply(e,arguments)}function RIe(){return ND.apply(null,arguments).exponent(.5)}function lJ(){var e=[],t=fl;function r(n){if(n!=null&&!isNaN(n=+n))return t((Z1(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Qm),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>j4e(e,i/n))},r.copy=function(){return lJ(t).domain(e)},Gf.apply(r,arguments)}function SC(){var e=0,t=.5,r=1,n=1,a,i,s,l,c,d=fl,u,f=!1,m;function h(g){return isNaN(g=+g)?m:(g=.5+((g=+u(g))-i)*(n*g<n*i?l:c),d(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,r]=g,a=u(e=+e),i=u(t=+t),s=u(r=+r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,h):[e,t,r]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(d=g,h):d};function v(g){return function(x){var y,b,w;return arguments.length?([y,b,w]=x,d=K4e(g,[y,b,w]),h):[d(0),d(.5),d(1)]}}return h.range=v(f0),h.rangeRound=v(sD),h.unknown=function(g){return arguments.length?(m=g,h):m},function(g){return u=g,a=g(e),i=g(t),s=g(r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,h}}function cJ(){var e=Ch(SC()(fl));return e.copy=function(){return Ph(e,cJ())},Gf.apply(e,arguments)}function dJ(){var e=uD(SC()).domain([.1,1,10]);return e.copy=function(){return Ph(e,dJ()).base(e.base())},Gf.apply(e,arguments)}function uJ(){var e=fD(SC());return e.copy=function(){return Ph(e,uJ()).constant(e.constant())},Gf.apply(e,arguments)}function _D(){var e=mD(SC());return e.copy=function(){return Ph(e,_D()).exponent(e.exponent())},Gf.apply(e,arguments)}function LIe(){return _D.apply(null,arguments).exponent(.5)}const vB=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ub,scaleDiverging:cJ,scaleDivergingLog:dJ,scaleDivergingPow:_D,scaleDivergingSqrt:LIe,scaleDivergingSymlog:uJ,scaleIdentity:UX,scaleImplicit:qO,scaleLinear:XN,scaleLog:WX,scaleOrdinal:aD,scalePoint:zy,scalePow:hD,scaleQuantile:KX,scaleQuantize:YX,scaleRadial:GX,scaleSequential:oJ,scaleSequentialLog:iJ,scaleSequentialPow:ND,scaleSequentialQuantile:lJ,scaleSequentialSqrt:RIe,scaleSequentialSymlog:sJ,scaleSqrt:vTe,scaleSymlog:HX,scaleThreshold:XX,scaleTime:DIe,scaleUtc:MIe,tickFormat:zX},Symbol.toStringTag,{value:"Module"}));var $Ie=n0;function FIe(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],s=t(i);if(s!=null&&(l===void 0?s===s&&!$Ie(s):r(s,l)))var l=s,c=i}return c}var CC=FIe;function BIe(e,t){return e>t}var fJ=BIe,qIe=CC,zIe=fJ,UIe=u0;function VIe(e){return e&&e.length?qIe(e,UIe,zIe):void 0}var WIe=VIe;const Tm=Ba(WIe);function HIe(e,t){return e<t}var mJ=HIe,GIe=CC,KIe=mJ,YIe=u0;function XIe(e){return e&&e.length?GIe(e,YIe,KIe):void 0}var JIe=XIe;const PC=Ba(JIe);var QIe=$I,ZIe=Wu,eDe=wX,tDe=Bl;function rDe(e,t){var r=tDe(e)?QIe:eDe;return r(e,ZIe(t))}var nDe=rDe,aDe=yX,oDe=nDe;function iDe(e,t){return aDe(oDe(e,t),1)}var sDe=iDe;const lDe=Ba(sDe);var cDe=ZI;function dDe(e,t){return cDe(e,t)}var uDe=dDe;const Jp=Ba(uDe);var m0=1e9,fDe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},CD,qo=!0,xd="[DecimalError] ",Op=xd+"Invalid argument: ",SD=xd+"Exponent out of range: ",h0=Math.floor,tp=Math.pow,mDe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,cc,es=1e7,Oo=7,hJ=9007199254740991,e_=h0(hJ/Oo),mn={};mn.absoluteValue=mn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};mn.comparedTo=mn.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};mn.decimalPlaces=mn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Oo;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};mn.dividedBy=mn.div=function(e){return Cf(this,new this.constructor(e))};mn.dividedToIntegerBy=mn.idiv=function(e){var t=this,r=t.constructor;return ho(Cf(t,new r(e),0,1),r.precision)};mn.equals=mn.eq=function(e){return!this.cmp(e)};mn.exponent=function(){return Ai(this)};mn.greaterThan=mn.gt=function(e){return this.cmp(e)>0};mn.greaterThanOrEqualTo=mn.gte=function(e){return this.cmp(e)>=0};mn.isInteger=mn.isint=function(){return this.e>this.d.length-2};mn.isNegative=mn.isneg=function(){return this.s<0};mn.isPositive=mn.ispos=function(){return this.s>0};mn.isZero=function(){return this.s===0};mn.lessThan=mn.lt=function(e){return this.cmp(e)<0};mn.lessThanOrEqualTo=mn.lte=function(e){return this.cmp(e)<1};mn.logarithm=mn.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(cc))throw Error(xd+"NaN");if(r.s<1)throw Error(xd+(r.s?"NaN":"-Infinity"));return r.eq(cc)?new n(0):(qo=!1,t=Cf(Kb(r,i),Kb(e,i),i),qo=!0,ho(t,a))};mn.minus=mn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?vJ(t,e):pJ(t,(e.s=-e.s,e))};mn.modulo=mn.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(xd+"NaN");return r.s?(qo=!1,t=Cf(r,e,0,1).times(e),qo=!0,r.minus(t)):ho(new n(r),a)};mn.naturalExponential=mn.exp=function(){return gJ(this)};mn.naturalLogarithm=mn.ln=function(){return Kb(this)};mn.negated=mn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};mn.plus=mn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?pJ(t,e):vJ(t,(e.s=-e.s,e))};mn.precision=mn.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Op+e);if(t=Ai(a)+1,n=a.d.length-1,r=n*Oo+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};mn.squareRoot=mn.sqrt=function(){var e,t,r,n,a,i,s,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(xd+"NaN")}for(e=Ai(l),qo=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=Cu(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=h0((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(Cf(l,i,s+2)).times(.5),Cu(i.d).slice(0,s)===(t=Cu(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(ho(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return qo=!0,ho(n,r)};mn.times=mn.mul=function(e){var t,r,n,a,i,s,l,c,d,u=this,f=u.constructor,m=u.d,h=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=m.length,d=h.length,c<d&&(i=m,m=h,h=i,s=c,c=d,d=s),i=[],s=c+d,n=s;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+h[n]*m[a-n-1]+t,i[a--]=l%es|0,t=l/es|0;i[a]=(i[a]+t)%es|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,qo?ho(e,f.precision):e};mn.toDecimalPlaces=mn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Bu(e,0,m0),t===void 0?t=n.rounding:Bu(t,0,8),ho(r,e+Ai(r)+1,t))};mn.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Qp(n,!0):(Bu(e,0,m0),t===void 0?t=a.rounding:Bu(t,0,8),n=ho(new a(n),e+1,t),r=Qp(n,!0,e+1)),r};mn.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Qp(a):(Bu(e,0,m0),t===void 0?t=i.rounding:Bu(t,0,8),n=ho(new i(a),e+Ai(a)+1,t),r=Qp(n.abs(),!1,e+Ai(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};mn.toInteger=mn.toint=function(){var e=this,t=e.constructor;return ho(new t(e),Ai(e)+1,t.rounding)};mn.toNumber=function(){return+this};mn.toPower=mn.pow=function(e){var t,r,n,a,i,s,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(cc);if(l=new c(l),!l.s){if(e.s<1)throw Error(xd+"Infinity");return l}if(l.eq(cc))return l;if(n=c.precision,e.eq(cc))return ho(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=u<0?-u:u)<=hJ){for(a=new c(cc),t=Math.ceil(n/Oo+4),qo=!1;r%2&&(a=a.times(l),yB(a.d,t)),r=h0(r/2),r!==0;)l=l.times(l),yB(l.d,t);return qo=!0,e.s<0?new c(cc).div(a):ho(a,n)}}else if(i<0)throw Error(xd+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,qo=!1,a=e.times(Kb(l,n+d)),qo=!0,a=gJ(a),a.s=i,a};mn.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Ai(a),n=Qp(a,r<=i.toExpNeg||r>=i.toExpPos)):(Bu(e,1,m0),t===void 0?t=i.rounding:Bu(t,0,8),a=ho(new i(a),e,t),r=Ai(a),n=Qp(a,e<=r||r<=i.toExpNeg,e)),n};mn.toSignificantDigits=mn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Bu(e,1,m0),t===void 0?t=n.rounding:Bu(t,0,8)),ho(new n(r),e,t)};mn.toString=mn.valueOf=mn.val=mn.toJSON=mn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ai(e),r=e.constructor;return Qp(e,t<=r.toExpNeg||t>=r.toExpPos)};function pJ(e,t){var r,n,a,i,s,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),qo?ho(t,f):t;if(c=e.d,d=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,l=d.length):(n=d,a=s,l=c.length),s=Math.ceil(f/Oo),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,n=d,d=c,c=n),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/es|0,c[i]%=es;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,qo?ho(t,f):t}function Bu(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Op+e)}function Cu(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Oo-n.length,r&&(i+=bm(r)),i+=n;s=e[t],n=s+"",r=Oo-n.length,r&&(i+=bm(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Cf=function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%es|0,s=i/es|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,c;if(i!=s)c=i>s?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*es+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,c,d,u,f,m,h,v,g,x,y,b,w,j,_,S,k,E,A=n.constructor,M=n.s==a.s?1:-1,C=n.d,T=a.d;if(!n.s)return new A(n);if(!a.s)throw Error(xd+"Division by zero");for(c=n.e-a.e,k=T.length,_=C.length,h=new A(M),v=h.d=[],d=0;T[d]==(C[d]||0);)++d;if(T[d]>(C[d]||0)&&--c,i==null?b=i=A.precision:s?b=i+(Ai(n)-Ai(a))+1:b=i,b<0)return new A(0);if(b=b/Oo+2|0,d=0,k==1)for(u=0,T=T[0],b++;(d<_||u)&&b--;d++)w=u*es+(C[d]||0),v[d]=w/T|0,u=w%T|0;else{for(u=es/(T[0]+1)|0,u>1&&(T=e(T,u),C=e(C,u),k=T.length,_=C.length),j=k,g=C.slice(0,k),x=g.length;x<k;)g[x++]=0;E=T.slice(),E.unshift(0),S=T[0],T[1]>=es/2&&++S;do u=0,l=t(T,g,k,x),l<0?(y=g[0],k!=x&&(y=y*es+(g[1]||0)),u=y/S|0,u>1?(u>=es&&(u=es-1),f=e(T,u),m=f.length,x=g.length,l=t(f,g,m,x),l==1&&(u--,r(f,k<m?E:T,m))):(u==0&&(l=u=1),f=T.slice()),m=f.length,m<x&&f.unshift(0),r(g,f,x),l==-1&&(x=g.length,l=t(T,g,k,x),l<1&&(u++,r(g,k<x?E:T,x))),x=g.length):l===0&&(u++,g=[0]),v[d++]=u,l&&g[0]?g[x++]=C[j]||0:(g=[C[j]],x=1);while((j++<_||g[0]!==void 0)&&b--)}return v[0]||v.shift(),h.e=c,ho(h,s?i+Ai(h)+1:i)}}();function gJ(e,t){var r,n,a,i,s,l,c=0,d=0,u=e.constructor,f=u.precision;if(Ai(e)>16)throw Error(SD+Ai(e));if(!e.s)return new u(cc);for(t==null?(qo=!1,l=f):l=t,s=new u(.03125);e.abs().gte(.1);)e=e.times(s),d+=5;for(n=Math.log(tp(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new u(cc),u.precision=l;;){if(a=ho(a.times(e),l),r=r.times(++c),s=i.plus(Cf(a,r,l)),Cu(s.d).slice(0,l)===Cu(i.d).slice(0,l)){for(;d--;)i=ho(i.times(i),l);return u.precision=f,t==null?(qo=!0,ho(i,f)):i}i=s}}function Ai(e){for(var t=e.e*Oo,r=e.d[0];r>=10;r/=10)t++;return t}function xA(e,t,r){if(t>e.LN10.sd())throw qo=!0,r&&(e.precision=r),Error(xd+"LN10 precision limit exceeded");return ho(new e(e.LN10),t)}function bm(e){for(var t="";e--;)t+="0";return t}function Kb(e,t){var r,n,a,i,s,l,c,d,u,f=1,m=10,h=e,v=h.d,g=h.constructor,x=g.precision;if(h.s<1)throw Error(xd+(h.s?"NaN":"-Infinity"));if(h.eq(cc))return new g(0);if(t==null?(qo=!1,d=x):d=t,h.eq(10))return t==null&&(qo=!0),xA(g,d);if(d+=m,g.precision=d,r=Cu(v),n=r.charAt(0),i=Ai(h),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(e),r=Cu(h.d),n=r.charAt(0),f++;i=Ai(h),n>1?(h=new g("0."+r),i++):h=new g(n+"."+r.slice(1))}else return c=xA(g,d+2,x).times(i+""),h=Kb(new g(n+"."+r.slice(1)),d-m).plus(c),g.precision=x,t==null?(qo=!0,ho(h,x)):h;for(l=s=h=Cf(h.minus(cc),h.plus(cc),d),u=ho(h.times(h),d),a=3;;){if(s=ho(s.times(u),d),c=l.plus(Cf(s,new g(a),d)),Cu(c.d).slice(0,d)===Cu(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(xA(g,d+2,x).times(i+""))),l=Cf(l,new g(f),d),g.precision=x,t==null?(qo=!0,ho(l,x)):l;l=c,a+=2}}function xB(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=h0(r/Oo),e.d=[],n=(r+1)%Oo,r<0&&(n+=Oo),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Oo;n<a;)e.d.push(+t.slice(n,n+=Oo));t=t.slice(n),n=Oo-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),qo&&(e.e>e_||e.e<-e_))throw Error(SD+r)}else e.s=0,e.e=0,e.d=[0];return e}function ho(e,t,r){var n,a,i,s,l,c,d,u,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Oo,a=t,d=f[u=0];else{if(u=Math.ceil((n+1)/Oo),i=f.length,u>=i)return e;for(d=i=f[u],s=1;i>=10;i/=10)s++;n%=Oo,a=n-Oo+s}if(r!==void 0&&(i=tp(10,s-a-1),l=d/i%10|0,c=t<0||f[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/tp(10,s-a):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=Ai(e),f.length=1,t=t-i-1,f[0]=tp(10,(Oo-t%Oo)%Oo),e.e=h0(-t/Oo)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,i=1,u--):(f.length=u+1,i=tp(10,Oo-n),f[u]=a>0?(d/tp(10,s-a)%tp(10,a)|0)*i:0),c)for(;;)if(u==0){(f[0]+=i)==es&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=es)break;f[u--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(qo&&(e.e>e_||e.e<-e_))throw Error(SD+Ai(e));return e}function vJ(e,t){var r,n,a,i,s,l,c,d,u,f,m=e.constructor,h=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),qo?ho(t,h):t;if(c=e.d,f=t.d,n=t.e,d=e.e,c=c.slice(),s=d-n,s){for(u=s<0,u?(r=c,s=-s,l=f.length):(r=f,n=d,l=c.length),a=Math.max(Math.ceil(h/Oo),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){u=c[a]<f[a];break}s=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>s;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=es-1;--c[i],c[a]+=es}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,qo?ho(t,h):t):new m(0)}function Qp(e,t,r){var n,a=Ai(e),i=Cu(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+bm(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+bm(-a-1)+i,r&&(n=r-s)>0&&(i+=bm(n))):a>=s?(i+=bm(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+bm(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=bm(n))),e.s<0?"-"+i:i}function yB(e,t){if(e.length>t)return e.length=t,!0}function xJ(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Op+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return xB(s,i.toString())}else if(typeof i!="string")throw Error(Op+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,mDe.test(i))xB(s,i);else throw Error(Op+i)}if(a.prototype=mn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=xJ,a.config=a.set=hDe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function hDe(e){if(!e||typeof e!="object")throw Error(xd+"Object expected");var t,r,n,a=["precision",1,m0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(h0(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Op+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Op+r+": "+n);return this}var CD=xJ(fDe);cc=new CD(1);const lo=CD;function pDe(e){return yDe(e)||xDe(e)||vDe(e)||gDe()}function gDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vDe(e,t){if(e){if(typeof e=="string")return WO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WO(e,t)}}function xDe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function yDe(e){if(Array.isArray(e))return WO(e)}function WO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var bDe=function(t){return t},yJ={"@@functional/placeholder":!0},bJ=function(t){return t===yJ},bB=function(t){return function r(){return arguments.length===0||arguments.length===1&&bJ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},wDe=function e(t,r){return t===1?r:bB(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a.filter(function(l){return l!==yJ}).length;return s>=t?r.apply(void 0,a):e(t-s,bB(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=a.map(function(f){return bJ(f)?c.shift():f});return r.apply(void 0,pDe(u).concat(c))}))})},AC=function(t){return wDe(t.length,t)},HO=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},jDe=AC(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),NDe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return bDe;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},GO=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},wJ=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r&&i.every(function(l,c){return l===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function _De(e){var t;return e===0?t=1:t=Math.floor(new lo(e).abs().log(10).toNumber())+1,t}function SDe(e,t,r){for(var n=new lo(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var CDe=AC(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),PDe=AC(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),ADe=AC(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const EC={rangeStep:SDe,getDigitCount:_De,interpolateNumber:CDe,uninterpolateNumber:PDe,uninterpolateTruncation:ADe};function KO(e){return ODe(e)||kDe(e)||jJ(e)||EDe()}function EDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kDe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function ODe(e){if(Array.isArray(e))return YO(e)}function Yb(e,t){return DDe(e)||IDe(e,t)||jJ(e,t)||TDe()}function TDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jJ(e,t){if(e){if(typeof e=="string")return YO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YO(e,t)}}function YO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IDe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var s=e[Symbol.iterator](),l;!(n=(l=s.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&s.return!=null&&s.return()}finally{if(a)throw i}}return r}}function DDe(e){if(Array.isArray(e))return e}function NJ(e){var t=Yb(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function _J(e,t,r){if(e.lte(0))return new lo(0);var n=EC.getDigitCount(e.toNumber()),a=new lo(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new lo(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=l.mul(a);return t?c:new lo(Math.ceil(c))}function MDe(e,t,r){var n=1,a=new lo(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new lo(10).pow(EC.getDigitCount(e)-1),a=new lo(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new lo(Math.floor(e)))}else e===0?a=new lo(Math.floor((t-1)/2)):r||(a=new lo(Math.floor(e)));var s=Math.floor((t-1)/2),l=NDe(jDe(function(c){return a.add(new lo(c-s).mul(n)).toNumber()}),HO);return l(0,t)}function SJ(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new lo(0),tickMin:new lo(0),tickMax:new lo(0)};var i=_J(new lo(t).sub(e).div(r-1),n,a),s;e<=0&&t>=0?s=new lo(0):(s=new lo(e).add(t).div(2),s=s.sub(new lo(s).mod(i)));var l=Math.ceil(s.sub(e).div(i).toNumber()),c=Math.ceil(new lo(t).sub(s).div(i).toNumber()),d=l+c+1;return d>r?SJ(e,t,r,n,a+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:i,tickMin:s.sub(new lo(l).mul(i)),tickMax:s.add(new lo(c).mul(i))})}function RDe(e){var t=Yb(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),l=NJ([r,n]),c=Yb(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var f=u===1/0?[d].concat(KO(HO(0,a-1).map(function(){return 1/0}))):[].concat(KO(HO(0,a-1).map(function(){return-1/0})),[u]);return r>n?GO(f):f}if(d===u)return MDe(d,a,i);var m=SJ(d,u,s,i),h=m.step,v=m.tickMin,g=m.tickMax,x=EC.rangeStep(v,g.add(new lo(.1).mul(h)),h);return r>n?GO(x):x}function LDe(e,t){var r=Yb(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=NJ([n,a]),l=Yb(s,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[n,a];if(c===d)return[c];var u=Math.max(t,2),f=_J(new lo(d).sub(c).div(u-1),i,0),m=[].concat(KO(EC.rangeStep(new lo(c),new lo(d).sub(new lo(.99).mul(f)),f)),[d]);return n>a?GO(m):m}var $De=wJ(RDe),FDe=wJ(LDe),BDe=!0,yA="Invariant failed";function mh(e,t){if(!e){if(BDe)throw new Error(yA);var r=typeof t=="function"?t():t,n=r?"".concat(yA,": ").concat(r):yA;throw new Error(n)}}var qDe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function bx(e){"@babel/helpers - typeof";return bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bx(e)}function t_(){return t_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t_.apply(this,arguments)}function zDe(e,t){return HDe(e)||WDe(e,t)||VDe(e,t)||UDe()}function UDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VDe(e,t){if(e){if(typeof e=="string")return wB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wB(e,t)}}function wB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function HDe(e){if(Array.isArray(e))return e}function GDe(e,t){if(e==null)return{};var r=KDe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function YDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AJ(n.key),n)}}function XDe(e,t,r){return t&&jB(e.prototype,t),r&&jB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JDe(e,t,r){return t=r_(t),QDe(e,CJ()?Reflect.construct(t,r||[],r_(e).constructor):t.apply(e,r))}function QDe(e,t){if(t&&(bx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZDe(e)}function ZDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CJ=function(){return!!e})()}function r_(e){return r_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},r_(e)}function eMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},XO(e,t)}function PJ(e,t,r){return t=AJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AJ(e){var t=tMe(e,"string");return bx(t)=="symbol"?t:t+""}function tMe(e,t){if(bx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nw=function(e){function t(){return YDe(this,t),JDe(this,t,arguments)}return eMe(t,e),XDe(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,s=n.width,l=n.dataKey,c=n.data,d=n.dataPointFormatter,u=n.xAxis,f=n.yAxis,m=GDe(n,qDe),h=On(m,!1);this.props.direction==="x"&&u.type!=="number"&&mh(!1);var v=c.map(function(g){var x=d(g,l),y=x.x,b=x.y,w=x.value,j=x.errorVal;if(!j)return null;var _=[],S,k;if(Array.isArray(j)){var E=zDe(j,2);S=E[0],k=E[1]}else S=k=j;if(i==="vertical"){var A=u.scale,M=b+a,C=M+s,T=M-s,I=A(w-S),D=A(w+k);_.push({x1:D,y1:C,x2:D,y2:T}),_.push({x1:I,y1:M,x2:D,y2:M}),_.push({x1:I,y1:C,x2:I,y2:T})}else if(i==="horizontal"){var F=f.scale,z=y+a,q=z-s,$=z+s,K=F(w-S),ce=F(w+k);_.push({x1:q,y1:ce,x2:$,y2:ce}),_.push({x1:z,y1:K,x2:z,y2:ce}),_.push({x1:q,y1:K,x2:$,y2:K})}return xe.createElement(Na,t_({className:"recharts-errorBar",key:"bar-".concat(_.map(function(fe){return"".concat(fe.x1,"-").concat(fe.x2,"-").concat(fe.y1,"-").concat(fe.y2)}))},h),_.map(function(fe){return xe.createElement("line",t_({},fe,{key:"line-".concat(fe.x1,"-").concat(fe.x2,"-").concat(fe.y1,"-").concat(fe.y2)}))}))});return xe.createElement(Na,{className:"recharts-errorBars"},v)}}])}(xe.Component);PJ(nw,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});PJ(nw,"displayName","ErrorBar");function Xb(e){"@babel/helpers - typeof";return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(e)}function NB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NB(Object(r),!0).forEach(function(n){rMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rMe(e,t,r){return t=nMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nMe(e){var t=aMe(e,"string");return Xb(t)=="symbol"?t:t+""}function aMe(e,t){if(Xb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EJ=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,s=ac(r,Ep);if(!s)return null;var l=Ep.defaultProps,c=l!==void 0?qh(qh({},l),s.props):{},d;return s.props&&s.props.payload?d=s.props&&s.props.payload:i==="children"?d=(n||[]).reduce(function(u,f){var m=f.item,h=f.props,v=h.sectors||h.data||[];return u.concat(v.map(function(g){return{type:s.props.iconType||m.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):d=(n||[]).map(function(u){var f=u.item,m=f.type.defaultProps,h=m!==void 0?qh(qh({},m),f.props):{},v=h.dataKey,g=h.name,x=h.legendType,y=h.hide;return{inactive:y,dataKey:v,type:c.iconType||x||"square",color:PD(f),value:g||v,payload:h}}),qh(qh(qh({},c),Ep.getWithHeight(s,a)),{},{payload:d,item:s})};function Jb(e){"@babel/helpers - typeof";return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jb(e)}function _B(e){return lMe(e)||sMe(e)||iMe(e)||oMe()}function oMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iMe(e,t){if(e){if(typeof e=="string")return JO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JO(e,t)}}function sMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lMe(e){if(Array.isArray(e))return JO(e)}function JO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ri(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SB(Object(r),!0).forEach(function(n){zv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zv(e,t,r){return t=cMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cMe(e){var t=dMe(e,"string");return Jb(t)=="symbol"?t:t+""}function dMe(e,t){if(Jb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pi(e,t,r){return Xn(e)||Xn(t)?r:Gi(t)?gc(e,t,r):Vn(t)?t(e):r}function Uy(e,t,r,n){var a=lDe(e,function(l){return pi(l,t)});if(r==="number"){var i=a.filter(function(l){return Vr(l)||parseFloat(l)});return i.length?[PC(i),Tm(i)]:[1/0,-1/0]}var s=n?a.filter(function(l){return!Xn(l)}):a;return s.map(function(l){return Gi(l)||l instanceof Date?l:""})}var uMe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=-1,l=(r=n?.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,d=0;d<l;d++){var u=d>0?a[d-1].coordinate:a[l-1].coordinate,f=a[d].coordinate,m=d>=l-1?a[0].coordinate:a[d+1].coordinate,h=void 0;if(dl(f-u)!==dl(m-f)){var v=[];if(dl(m-f)===dl(c[1]-c[0])){h=m;var g=f+c[1]-c[0];v[0]=Math.min(g,(g+u)/2),v[1]=Math.max(g,(g+u)/2)}else{h=u;var x=m+c[1]-c[0];v[0]=Math.min(f,(x+f)/2),v[1]=Math.max(f,(x+f)/2)}var y=[Math.min(f,(h+f)/2),Math.max(f,(h+f)/2)];if(t>y[0]&&t<=y[1]||t>=v[0]&&t<=v[1]){s=a[d].index;break}}else{var b=Math.min(u,m),w=Math.max(u,m);if(t>(b+f)/2&&t<=(w+f)/2){s=a[d].index;break}}}else for(var j=0;j<l;j++)if(j===0&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j>0&&j<l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j===l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2){s=n[j].index;break}return s},PD=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?ri(ri({},t.type.defaultProps),t.props):t.props,s=i.stroke,l=i.fill,c;switch(a){case"Line":c=s;break;case"Area":case"Radar":c=s&&s!=="none"?s:l;break;default:c=l;break}return c},fMe=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var s={},l=Object.keys(i),c=0,d=l.length;c<d;c++)for(var u=i[l[c]].stackGroups,f=Object.keys(u),m=0,h=f.length;m<h;m++){var v=u[f[m]],g=v.items,x=v.cateAxisId,y=g.filter(function(k){return Sf(k.type).indexOf("Bar")>=0});if(y&&y.length){var b=y[0].type.defaultProps,w=b!==void 0?ri(ri({},b),y[0].props):y[0].props,j=w.barSize,_=w[x];s[_]||(s[_]=[]);var S=Xn(j)?r:j;s[_].push({item:y[0],stackList:y.slice(1),barSize:Xn(S)?void 0:ul(S,n,0)})}}return s},mMe=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,s=i===void 0?[]:i,l=t.maxBarSize,c=s.length;if(c<1)return null;var d=ul(r,a,0,!0),u,f=[];if(s[0].barSize===+s[0].barSize){var m=!1,h=a/c,v=s.reduce(function(j,_){return j+_.barSize||0},0);v+=(c-1)*d,v>=a&&(v-=(c-1)*d,d=0),v>=a&&h>0&&(m=!0,h*=.9,v=c*h);var g=(a-v)/2>>0,x={offset:g-d,size:0};u=s.reduce(function(j,_){var S={item:_.item,position:{offset:x.offset+x.size+d,size:m?h:_.barSize}},k=[].concat(_B(j),[S]);return x=k[k.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(E){k.push({item:E,position:x})}),k},f)}else{var y=ul(n,a,0,!0);a-2*y-(c-1)*d<=0&&(d=0);var b=(a-2*y-(c-1)*d)/c;b>1&&(b>>=0);var w=l===+l?Math.min(b,l):b;u=s.reduce(function(j,_,S){var k=[].concat(_B(j),[{item:_.item,position:{offset:y+(b+d)*S+(b-w)/2,size:w}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(E){k.push({item:E,position:k[k.length-1].position})}),k},f)}return u},hMe=function(t,r,n,a){var i=n.children,s=n.width,l=n.margin,c=s-(l.left||0)-(l.right||0),d=EJ({children:i,legendWidth:c});if(d){var u=a||{},f=u.width,m=u.height,h=d.align,v=d.verticalAlign,g=d.layout;if((g==="vertical"||g==="horizontal"&&v==="middle")&&h!=="center"&&Vr(t[h]))return ri(ri({},t),{},zv({},h,t[h]+(f||0)));if((g==="horizontal"||g==="vertical"&&h==="center")&&v!=="middle"&&Vr(t[v]))return ri(ri({},t),{},zv({},v,t[v]+(m||0)))}return t},pMe=function(t,r,n){return Xn(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},kJ=function(t,r,n,a,i){var s=r.props.children,l=vc(s,nw).filter(function(d){return pMe(a,i,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var f=pi(u,n);if(Xn(f))return d;var m=Array.isArray(f)?[PC(f),Tm(f)]:[f,f],h=c.reduce(function(v,g){var x=pi(u,g,0),y=m[0]-Math.abs(Array.isArray(x)?x[0]:x),b=m[1]+Math.abs(Array.isArray(x)?x[1]:x);return[Math.min(y,v[0]),Math.max(b,v[1])]},[1/0,-1/0]);return[Math.min(h[0],d[0]),Math.max(h[1],d[1])]},[1/0,-1/0])}return null},gMe=function(t,r,n,a,i){var s=r.map(function(l){return kJ(t,l,n,i,a)}).filter(function(l){return!Xn(l)});return s&&s.length?s.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},OJ=function(t,r,n,a,i){var s=r.map(function(c){var d=c.props.dataKey;return n==="number"&&d&&kJ(t,c,d,a)||Uy(t,d,n,i)});if(n==="number")return s.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return s.reduce(function(c,d){for(var u=0,f=d.length;u<f;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},TJ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},IJ=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,s,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(s=!0),c.coordinate});return i||l.push(r),s||l.push(n),l},bf=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,s=t.type,l=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,d=(r||n)&&s==="category"&&a.bandwidth?a.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&l?.length>=2?dl(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var m=i?i.indexOf(f):f;return{coordinate:a(m)+d,value:f,offset:d}});return u.filter(function(f){return!l0(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,m){return{coordinate:a(f)+d,value:f,index:m,offset:d}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+d,value:f,offset:d}}):a.domain().map(function(f,m){return{coordinate:a(f)+d,value:i?i[f]:f,index:m,offset:d}})},bA=new WeakMap,O2=function(t,r){if(typeof r!="function")return t;bA.has(t)||bA.set(t,new WeakMap);var n=bA.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},DJ=function(t,r,n){var a=t.scale,i=t.type,s=t.layout,l=t.axisType;if(a==="auto")return s==="radial"&&l==="radiusAxis"?{scale:Ub(),realScaleType:"band"}:s==="radial"&&l==="angleAxis"?{scale:XN(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:zy(),realScaleType:"point"}:i==="category"?{scale:Ub(),realScaleType:"band"}:{scale:XN(),realScaleType:"linear"};if(Kp(a)){var c="scale".concat(mC(a));return{scale:(vB[c]||zy)(),realScaleType:vB[c]?c:"point"}}return Vn(a)?{scale:a}:{scale:zy(),realScaleType:"point"}},CB=1e-4,MJ=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-CB,s=Math.max(a[0],a[1])+CB,l=t(r[0]),c=t(r[n-1]);(l<i||l>s||c<i||c>s)&&t.domain([r[0],r[n-1]])}},vMe=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},xMe=function(t,r){if(!r||r.length!==2||!Vr(r[0])||!Vr(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Vr(t[0])||t[0]<n)&&(i[0]=n),(!Vr(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},yMe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0,l=0;l<r;++l){var c=l0(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1]):(t[l][n][0]=s,t[l][n][1]=s+c,s=t[l][n][1])}},bMe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0;s<r;++s){var l=l0(t[s][n][1])?t[s][n][0]:t[s][n][1];l>=0?(t[s][n][0]=i,t[s][n][1]=i+l,i=t[s][n][1]):(t[s][n][0]=0,t[s][n][1]=0)}},wMe={sign:yMe,expand:U_e,none:fx,silhouette:V_e,wiggle:W_e,positive:bMe},jMe=function(t,r,n){var a=r.map(function(l){return l.props.dataKey}),i=wMe[n],s=z_e().keys(a).value(function(l,c){return+pi(l,c,0)}).order(jO).offset(i);return s(t)},NMe=function(t,r,n,a,i,s){if(!t)return null;var l=s?r.reverse():r,c={},d=l.reduce(function(f,m){var h,v=(h=m.type)!==null&&h!==void 0&&h.defaultProps?ri(ri({},m.type.defaultProps),m.props):m.props,g=v.stackId,x=v.hide;if(x)return f;var y=v[n],b=f[y]||{hasStack:!1,stackGroups:{}};if(Gi(g)){var w=b.stackGroups[g]||{numericAxisId:n,cateAxisId:a,items:[]};w.items.push(m),b.hasStack=!0,b.stackGroups[g]=w}else b.stackGroups[gg("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[m]};return ri(ri({},f),{},zv({},y,b))},c),u={};return Object.keys(d).reduce(function(f,m){var h=d[m];if(h.hasStack){var v={};h.stackGroups=Object.keys(h.stackGroups).reduce(function(g,x){var y=h.stackGroups[x];return ri(ri({},g),{},zv({},x,{numericAxisId:n,cateAxisId:a,items:y.items,stackedData:jMe(t,y.items,i)}))},v)}return ri(ri({},f),{},zv({},m,h))},u)},RJ=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,s=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=$De(d,i,l);return t.domain([PC(u),Tm(u)]),{niceTicks:u}}if(i&&a==="number"){var f=t.domain(),m=FDe(f,i,l);return{niceTicks:m}}return null};function n_(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,s=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Xn(a[t.dataKey])){var l=EN(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=pi(a,Xn(s)?t.dataKey:s);return Xn(c)?null:t.scale(c)}var PB=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,s=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+a:null;var c=pi(s,r.dataKey,r.domain[l]);return Xn(c)?null:r.scale(c)-i/2+a},_Me=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},SMe=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?ri(ri({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(Gi(i)){var s=r[i];if(s){var l=s.items.indexOf(t);return l>=0?s.stackedData[l]:null}}return null},CMe=function(t){return t.reduce(function(r,n){return[PC(n.concat([r[0]]).filter(Vr)),Tm(n.concat([r[1]]).filter(Vr))]},[1/0,-1/0])},LJ=function(t,r,n){return Object.keys(t).reduce(function(a,i){var s=t[i],l=s.stackedData,c=l.reduce(function(d,u){var f=CMe(u.slice(r,n+1));return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},AB=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,EB=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,QO=function(t,r,n){if(Vn(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Vr(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(AB.test(t[0])){var i=+AB.exec(t[0])[1];a[0]=r[0]-i}else Vn(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Vr(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(EB.test(t[1])){var s=+EB.exec(t[1])[1];a[1]=r[1]+s}else Vn(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},a_=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=tD(r,function(f){return f.coordinate}),s=1/0,l=1,c=i.length;l<c;l++){var d=i[l],u=i[l-1];s=Math.min((d.coordinate||0)-(u.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},kB=function(t,r,n){return!t||!t.length||Jp(t,gc(n,"type.defaultProps.domain"))?r:t},$J=function(t,r){var n=t.type.defaultProps?ri(ri({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,s=n.unit,l=n.formatter,c=n.tooltipType,d=n.chartType,u=n.hide;return ri(ri({},On(t,!1)),{},{dataKey:a,unit:s,formatter:l,name:i||a,color:PD(t),value:pi(r,a),type:c,payload:r,chartType:d,hide:u})};function Qb(e){"@babel/helpers - typeof";return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(e)}function OB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function df(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OB(Object(r),!0).forEach(function(n){FJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FJ(e,t,r){return t=PMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PMe(e){var t=AMe(e,"string");return Qb(t)=="symbol"?t:t+""}function AMe(e,t){if(Qb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EMe(e,t){return IMe(e)||TMe(e,t)||OMe(e,t)||kMe()}function kMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OMe(e,t){if(e){if(typeof e=="string")return TB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TB(e,t)}}function TB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function IMe(e){if(Array.isArray(e))return e}var o_=Math.PI/180,DMe=function(t){return t*180/Math.PI},_o=function(t,r,n,a){return{x:t+Math.cos(-o_*a)*n,y:r+Math.sin(-o_*a)*n}},BJ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},MMe=function(t,r,n,a,i){var s=t.width,l=t.height,c=t.startAngle,d=t.endAngle,u=ul(t.cx,s,s/2),f=ul(t.cy,l,l/2),m=BJ(s,l,n),h=ul(t.innerRadius,m,0),v=ul(t.outerRadius,m,m*.8),g=Object.keys(r);return g.reduce(function(x,y){var b=r[y],w=b.domain,j=b.reversed,_;if(Xn(b.range))a==="angleAxis"?_=[c,d]:a==="radiusAxis"&&(_=[h,v]),j&&(_=[_[1],_[0]]);else{_=b.range;var S=_,k=EMe(S,2);c=k[0],d=k[1]}var E=DJ(b,i),A=E.realScaleType,M=E.scale;M.domain(w).range(_),MJ(M);var C=RJ(M,df(df({},b),{},{realScaleType:A})),T=df(df(df({},b),C),{},{range:_,radius:v,realScaleType:A,scale:M,cx:u,cy:f,innerRadius:h,outerRadius:v,startAngle:c,endAngle:d});return df(df({},x),{},FJ({},y,T))},{})},RMe=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-s,2))},LMe=function(t,r){var n=t.x,a=t.y,i=r.cx,s=r.cy,l=RMe({x:n,y:a},{x:i,y:s});if(l<=0)return{radius:l};var c=(n-i)/l,d=Math.acos(c);return a>s&&(d=2*Math.PI-d),{radius:l,angle:DMe(d),angleInRadian:d}},$Me=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return{startAngle:r-s*360,endAngle:n-s*360}},FMe=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),s=Math.floor(a/360),l=Math.min(i,s);return t+l*360},IB=function(t,r){var n=t.x,a=t.y,i=LMe({x:n,y:a},r),s=i.radius,l=i.angle,c=r.innerRadius,d=r.outerRadius;if(s<c||s>d)return!1;if(s===0)return!0;var u=$Me(r),f=u.startAngle,m=u.endAngle,h=l,v;if(f<=m){for(;h>m;)h-=360;for(;h<f;)h+=360;v=h>=f&&h<=m}else{for(;h>f;)h-=360;for(;h<m;)h+=360;v=h>=m&&h<=f}return v?df(df({},r),{},{radius:s,angle:FMe(h,r)}):null},qJ=function(t){return!p.isValidElement(t)&&!Vn(t)&&typeof t!="boolean"?t.className:""};function Zb(e){"@babel/helpers - typeof";return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zb(e)}var BMe=["offset"];function qMe(e){return WMe(e)||VMe(e)||UMe(e)||zMe()}function zMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UMe(e,t){if(e){if(typeof e=="string")return ZO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZO(e,t)}}function VMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WMe(e){if(Array.isArray(e))return ZO(e)}function ZO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HMe(e,t){if(e==null)return{};var r=GMe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function GMe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function DB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DB(Object(r),!0).forEach(function(n){KMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KMe(e,t,r){return t=YMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YMe(e){var t=XMe(e,"string");return Zb(t)=="symbol"?t:t+""}function XMe(e,t){if(Zb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e1(){return e1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e1.apply(this,arguments)}var JMe=function(t){var r=t.value,n=t.formatter,a=Xn(t.children)?r:t.children;return Vn(n)?n(a):a},QMe=function(t,r){var n=dl(r-t),a=Math.min(Math.abs(r-t),360);return n*a},ZMe=function(t,r,n){var a=t.position,i=t.viewBox,s=t.offset,l=t.className,c=i,d=c.cx,u=c.cy,f=c.innerRadius,m=c.outerRadius,h=c.startAngle,v=c.endAngle,g=c.clockWise,x=(f+m)/2,y=QMe(h,v),b=y>=0?1:-1,w,j;a==="insideStart"?(w=h+b*s,j=g):a==="insideEnd"?(w=v-b*s,j=!g):a==="end"&&(w=v+b*s,j=g),j=y<=0?j:!j;var _=_o(d,u,x,w),S=_o(d,u,x,w+(j?1:-1)*359),k="M".concat(_.x,",").concat(_.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(j?0:1,`,
    `).concat(S.x,",").concat(S.y),E=Xn(t.id)?gg("recharts-radial-line-"):t.id;return xe.createElement("text",e1({},n,{dominantBaseline:"central",className:ta("recharts-radial-bar-label",l)}),xe.createElement("defs",null,xe.createElement("path",{id:E,d:k})),xe.createElement("textPath",{xlinkHref:"#".concat(E)},r))},eRe=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,s=i.cx,l=i.cy,c=i.innerRadius,d=i.outerRadius,u=i.startAngle,f=i.endAngle,m=(u+f)/2;if(a==="outside"){var h=_o(s,l,d+n,m),v=h.x,g=h.y;return{x:v,y:g,textAnchor:v>=s?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"end"};var x=(c+d)/2,y=_o(s,l,x,m),b=y.x,w=y.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},tRe=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,s=r,l=s.x,c=s.y,d=s.width,u=s.height,f=u>=0?1:-1,m=f*a,h=f>0?"end":"start",v=f>0?"start":"end",g=d>=0?1:-1,x=g*a,y=g>0?"end":"start",b=g>0?"start":"end";if(i==="top"){var w={x:l+d/2,y:c-f*a,textAnchor:"middle",verticalAnchor:h};return Fi(Fi({},w),n?{height:Math.max(c-n.y,0),width:d}:{})}if(i==="bottom"){var j={x:l+d/2,y:c+u+m,textAnchor:"middle",verticalAnchor:v};return Fi(Fi({},j),n?{height:Math.max(n.y+n.height-(c+u),0),width:d}:{})}if(i==="left"){var _={x:l-x,y:c+u/2,textAnchor:y,verticalAnchor:"middle"};return Fi(Fi({},_),n?{width:Math.max(_.x-n.x,0),height:u}:{})}if(i==="right"){var S={x:l+d+x,y:c+u/2,textAnchor:b,verticalAnchor:"middle"};return Fi(Fi({},S),n?{width:Math.max(n.x+n.width-S.x,0),height:u}:{})}var k=n?{width:d,height:u}:{};return i==="insideLeft"?Fi({x:l+x,y:c+u/2,textAnchor:b,verticalAnchor:"middle"},k):i==="insideRight"?Fi({x:l+d-x,y:c+u/2,textAnchor:y,verticalAnchor:"middle"},k):i==="insideTop"?Fi({x:l+d/2,y:c+m,textAnchor:"middle",verticalAnchor:v},k):i==="insideBottom"?Fi({x:l+d/2,y:c+u-m,textAnchor:"middle",verticalAnchor:h},k):i==="insideTopLeft"?Fi({x:l+x,y:c+m,textAnchor:b,verticalAnchor:v},k):i==="insideTopRight"?Fi({x:l+d-x,y:c+m,textAnchor:y,verticalAnchor:v},k):i==="insideBottomLeft"?Fi({x:l+x,y:c+u-m,textAnchor:b,verticalAnchor:h},k):i==="insideBottomRight"?Fi({x:l+d-x,y:c+u-m,textAnchor:y,verticalAnchor:h},k):a0(i)&&(Vr(i.x)||hp(i.x))&&(Vr(i.y)||hp(i.y))?Fi({x:l+ul(i.x,d),y:c+ul(i.y,u),textAnchor:"end",verticalAnchor:"end"},k):Fi({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},k)},rRe=function(t){return"cx"in t&&Vr(t.cx)};function ns(e){var t=e.offset,r=t===void 0?5:t,n=HMe(e,BMe),a=Fi({offset:r},n),i=a.viewBox,s=a.position,l=a.value,c=a.children,d=a.content,u=a.className,f=u===void 0?"":u,m=a.textBreakAll;if(!i||Xn(l)&&Xn(c)&&!p.isValidElement(d)&&!Vn(d))return null;if(p.isValidElement(d))return p.cloneElement(d,a);var h;if(Vn(d)){if(h=p.createElement(d,a),p.isValidElement(h))return h}else h=JMe(a);var v=rRe(i),g=On(a,!0);if(v&&(s==="insideStart"||s==="insideEnd"||s==="end"))return ZMe(a,h,g);var x=v?eRe(a):tRe(a);return xe.createElement(Xp,e1({className:ta("recharts-label",f)},g,x,{breakAll:m}),h)}ns.displayName="Label";var zJ=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,s=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,f=t.x,m=t.y,h=t.top,v=t.left,g=t.width,x=t.height,y=t.clockWise,b=t.labelViewBox;if(b)return b;if(Vr(g)&&Vr(x)){if(Vr(f)&&Vr(m))return{x:f,y:m,width:g,height:x};if(Vr(h)&&Vr(v))return{x:h,y:v,width:g,height:x}}return Vr(f)&&Vr(m)?{x:f,y:m,width:0,height:0}:Vr(r)&&Vr(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:s||a||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:y}:t.viewBox?t.viewBox:{}},nRe=function(t,r){return t?t===!0?xe.createElement(ns,{key:"label-implicit",viewBox:r}):Gi(t)?xe.createElement(ns,{key:"label-implicit",viewBox:r,value:t}):p.isValidElement(t)?t.type===ns?p.cloneElement(t,{key:"label-implicit",viewBox:r}):xe.createElement(ns,{key:"label-implicit",content:t,viewBox:r}):Vn(t)?xe.createElement(ns,{key:"label-implicit",content:t,viewBox:r}):a0(t)?xe.createElement(ns,e1({viewBox:r},t,{key:"label-implicit"})):null:null},aRe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=zJ(t),s=vc(a,ns).map(function(c,d){return p.cloneElement(c,{viewBox:r||i,key:"label-".concat(d)})});if(!n)return s;var l=nRe(t.label,r||i);return[l].concat(qMe(s))};ns.parseViewBox=zJ;ns.renderCallByParent=aRe;function oRe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var iRe=oRe;const sRe=Ba(iRe);function t1(e){"@babel/helpers - typeof";return t1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t1(e)}var lRe=["valueAccessor"],cRe=["data","dataKey","clockWise","id","textBreakAll"];function dRe(e){return hRe(e)||mRe(e)||fRe(e)||uRe()}function uRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fRe(e,t){if(e){if(typeof e=="string")return e3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e3(e,t)}}function mRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hRe(e){if(Array.isArray(e))return e3(e)}function e3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i_(){return i_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i_.apply(this,arguments)}function MB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MB(Object(r),!0).forEach(function(n){pRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pRe(e,t,r){return t=gRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gRe(e){var t=vRe(e,"string");return t1(t)=="symbol"?t:t+""}function vRe(e,t){if(t1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(t1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LB(e,t){if(e==null)return{};var r=xRe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var yRe=function(t){return Array.isArray(t.value)?sRe(t.value):t.value};function Mu(e){var t=e.valueAccessor,r=t===void 0?yRe:t,n=LB(e,lRe),a=n.data,i=n.dataKey,s=n.clockWise,l=n.id,c=n.textBreakAll,d=LB(n,cRe);return!a||!a.length?null:xe.createElement(Na,{className:"recharts-label-list"},a.map(function(u,f){var m=Xn(i)?r(u,f):pi(u&&u.payload,i),h=Xn(l)?{}:{id:"".concat(l,"-").concat(f)};return xe.createElement(ns,i_({},On(u,!0),d,h,{parentViewBox:u.parentViewBox,value:m,textBreakAll:c,viewBox:ns.parseViewBox(Xn(s)?u:RB(RB({},u),{},{clockWise:s})),key:"label-".concat(f),index:f}))}))}Mu.displayName="LabelList";function bRe(e,t){return e?e===!0?xe.createElement(Mu,{key:"labelList-implicit",data:t}):xe.isValidElement(e)||Vn(e)?xe.createElement(Mu,{key:"labelList-implicit",data:t,content:e}):a0(e)?xe.createElement(Mu,i_({data:t},e,{key:"labelList-implicit"})):null:null}function wRe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=vc(n,Mu).map(function(s,l){return p.cloneElement(s,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var i=bRe(e.label,t);return[i].concat(dRe(a))}Mu.renderCallByParent=wRe;function r1(e){"@babel/helpers - typeof";return r1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r1(e)}function t3(){return t3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t3.apply(this,arguments)}function $B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$B(Object(r),!0).forEach(function(n){jRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$B(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jRe(e,t,r){return t=NRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NRe(e){var t=_Re(e,"string");return r1(t)=="symbol"?t:t+""}function _Re(e,t){if(r1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(r1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SRe=function(t,r){var n=dl(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},T2=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,s=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+a,f=Math.asin(c/u)/o_,m=d?i:i+s*f,h=_o(r,n,u,m),v=_o(r,n,a,m),g=d?i-s*f:i,x=_o(r,n,u*Math.cos(f*o_),g);return{center:h,circleTangency:v,lineTangency:x,theta:f}},UJ=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.startAngle,l=t.endAngle,c=SRe(s,l),d=s+c,u=_o(r,n,i,s),f=_o(r,n,i,d),m="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(s>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var h=_o(r,n,a,s),v=_o(r,n,a,d);m+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(s<=d),`,
            `).concat(h.x,",").concat(h.y," Z")}else m+="L ".concat(r,",").concat(n," Z");return m},CRe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,f=dl(u-d),m=T2({cx:r,cy:n,radius:i,angle:d,sign:f,cornerRadius:s,cornerIsExternal:c}),h=m.circleTangency,v=m.lineTangency,g=m.theta,x=T2({cx:r,cy:n,radius:i,angle:u,sign:-f,cornerRadius:s,cornerIsExternal:c}),y=x.circleTangency,b=x.lineTangency,w=x.theta,j=c?Math.abs(d-u):Math.abs(d-u)-g-w;if(j<0)return l?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):UJ({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u});var _="M ".concat(v.x,",").concat(v.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(j>180),",").concat(+(f<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
  `);if(a>0){var S=T2({cx:r,cy:n,radius:a,angle:d,sign:f,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),k=S.circleTangency,E=S.lineTangency,A=S.theta,M=T2({cx:r,cy:n,radius:a,angle:u,sign:-f,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),C=M.circleTangency,T=M.lineTangency,I=M.theta,D=c?Math.abs(d-u):Math.abs(d-u)-A-I;if(D<0&&s===0)return"".concat(_,"L").concat(r,",").concat(n,"Z");_+="L".concat(T.x,",").concat(T.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(C.x,",").concat(C.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(D>180),",").concat(+(f>0),",").concat(k.x,",").concat(k.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(E.x,",").concat(E.y,"Z")}else _+="L".concat(r,",").concat(n,"Z");return _},PRe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},AD=function(t){var r=FB(FB({},PRe),t),n=r.cx,a=r.cy,i=r.innerRadius,s=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,m=r.className;if(s<i||u===f)return null;var h=ta("recharts-sector",m),v=s-i,g=ul(l,v,0,!0),x;return g>0&&Math.abs(u-f)<360?x=CRe({cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(g,v/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):x=UJ({cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:u,endAngle:f}),xe.createElement("path",t3({},On(r,!0),{className:h,d:x,role:"img"}))};function n1(e){"@babel/helpers - typeof";return n1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n1(e)}function r3(){return r3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r3.apply(this,arguments)}function BB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BB(Object(r),!0).forEach(function(n){ARe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ARe(e,t,r){return t=ERe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ERe(e){var t=kRe(e,"string");return n1(t)=="symbol"?t:t+""}function kRe(e,t){if(n1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(n1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zB={curveBasisClosed:O_e,curveBasisOpen:T_e,curveBasis:k_e,curveBumpX:g_e,curveBumpY:v_e,curveLinearClosed:I_e,curveLinear:pC,curveMonotoneX:D_e,curveMonotoneY:M_e,curveNatural:R_e,curveStep:L_e,curveStepAfter:F_e,curveStepBefore:$_e},I2=function(t){return t.x===+t.x&&t.y===+t.y},J0=function(t){return t.x},Q0=function(t){return t.y},ORe=function(t,r){if(Vn(t))return t;var n="curve".concat(mC(t));return(n==="curveMonotone"||n==="curveBump")&&r?zB["".concat(n).concat(r==="vertical"?"Y":"X")]:zB[n]||pC},TRe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,s=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=ORe(n,l),f=d?i.filter(function(g){return I2(g)}):i,m;if(Array.isArray(s)){var h=d?s.filter(function(g){return I2(g)}):s,v=f.map(function(g,x){return qB(qB({},g),{},{base:h[x]})});return l==="vertical"?m=N2().y(Q0).x1(J0).x0(function(g){return g.base.x}):m=N2().x(J0).y1(Q0).y0(function(g){return g.base.y}),m.defined(I2).curve(u),m(v)}return l==="vertical"&&Vr(s)?m=N2().y(Q0).x1(J0).x0(s):Vr(s)?m=N2().x(J0).y1(Q0).y0(s):m=$Y().x(J0).y(Q0),m.defined(I2).curve(u),m(f)},Tp=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var s=n&&n.length?TRe(t):a;return p.createElement("path",r3({},On(t,!1),kN(t),{className:ta("recharts-curve",r),d:s,ref:i}))},VJ={exports:{}},IRe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",DRe=IRe,MRe=DRe;function WJ(){}function HJ(){}HJ.resetWarningCache=WJ;var RRe=function(){function e(n,a,i,s,l,c){if(c!==MRe){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:HJ,resetWarningCache:WJ};return r.PropTypes=r,r};VJ.exports=RRe();var LRe=VJ.exports;const Ln=Ba(LRe);var $Re=Object.getOwnPropertyNames,FRe=Object.getOwnPropertySymbols,BRe=Object.prototype.hasOwnProperty;function UB(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function D2(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,s=i.get(r),l=i.get(n);if(s&&l)return s===n&&l===r;i.set(r,n),i.set(n,r);var c=e(r,n,a);return i.delete(r),i.delete(n),c}}function VB(e){return $Re(e).concat(FRe(e))}var qRe=Object.hasOwn||function(e,t){return BRe.call(e,t)};function yg(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var zRe="__v",URe="__o",VRe="_owner",WB=Object.getOwnPropertyDescriptor,HB=Object.keys;function WRe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function HRe(e,t){return yg(e.getTime(),t.getTime())}function GRe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function KRe(e,t){return e===t}function GB(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),s,l,c=0;(s=i.next())&&!s.done;){for(var d=t.entries(),u=!1,f=0;(l=d.next())&&!l.done;){if(a[f]){f++;continue}var m=s.value,h=l.value;if(r.equals(m[0],h[0],c,f,e,t,r)&&r.equals(m[1],h[1],m[0],h[0],e,t,r)){u=a[f]=!0;break}f++}if(!u)return!1;c++}return!0}var YRe=yg;function XRe(e,t,r){var n=HB(e),a=n.length;if(HB(t).length!==a)return!1;for(;a-- >0;)if(!GJ(e,t,r,n[a]))return!1;return!0}function Z0(e,t,r){var n=VB(e),a=n.length;if(VB(t).length!==a)return!1;for(var i,s,l;a-- >0;)if(i=n[a],!GJ(e,t,r,i)||(s=WB(e,i),l=WB(t,i),(s||l)&&(!s||!l||s.configurable!==l.configurable||s.enumerable!==l.enumerable||s.writable!==l.writable)))return!1;return!0}function JRe(e,t){return yg(e.valueOf(),t.valueOf())}function QRe(e,t){return e.source===t.source&&e.flags===t.flags}function KB(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),s,l;(s=i.next())&&!s.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!a[u]&&r.equals(s.value,l.value,s.value,l.value,e,t,r)){d=a[u]=!0;break}u++}if(!d)return!1}return!0}function ZRe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function eLe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function GJ(e,t,r,n){return(n===VRe||n===URe||n===zRe)&&(e.$$typeof||t.$$typeof)?!0:qRe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var tLe="[object Arguments]",rLe="[object Boolean]",nLe="[object Date]",aLe="[object Error]",oLe="[object Map]",iLe="[object Number]",sLe="[object Object]",lLe="[object RegExp]",cLe="[object Set]",dLe="[object String]",uLe="[object URL]",fLe=Array.isArray,YB=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,XB=Object.assign,mLe=Object.prototype.toString.call.bind(Object.prototype.toString);function hLe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,s=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,m=e.areUrlsEqual;return function(v,g,x){if(v===g)return!0;if(v==null||g==null)return!1;var y=typeof v;if(y!==typeof g)return!1;if(y!=="object")return y==="number"?s(v,g,x):y==="function"?a(v,g,x):!1;var b=v.constructor;if(b!==g.constructor)return!1;if(b===Object)return l(v,g,x);if(fLe(v))return t(v,g,x);if(YB!=null&&YB(v))return f(v,g,x);if(b===Date)return r(v,g,x);if(b===RegExp)return d(v,g,x);if(b===Map)return i(v,g,x);if(b===Set)return u(v,g,x);var w=mLe(v);return w===nLe?r(v,g,x):w===lLe?d(v,g,x):w===oLe?i(v,g,x):w===cLe?u(v,g,x):w===sLe?typeof v.then!="function"&&typeof g.then!="function"&&l(v,g,x):w===uLe?m(v,g,x):w===aLe?n(v,g,x):w===tLe?l(v,g,x):w===rLe||w===iLe||w===dLe?c(v,g,x):!1}}function pLe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Z0:WRe,areDatesEqual:HRe,areErrorsEqual:GRe,areFunctionsEqual:KRe,areMapsEqual:n?UB(GB,Z0):GB,areNumbersEqual:YRe,areObjectsEqual:n?Z0:XRe,arePrimitiveWrappersEqual:JRe,areRegExpsEqual:QRe,areSetsEqual:n?UB(KB,Z0):KB,areTypedArraysEqual:n?Z0:ZRe,areUrlsEqual:eLe};if(r&&(a=XB({},a,r(a))),t){var i=D2(a.areArraysEqual),s=D2(a.areMapsEqual),l=D2(a.areObjectsEqual),c=D2(a.areSetsEqual);a=XB({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:l,areSetsEqual:c})}return a}function gLe(e){return function(t,r,n,a,i,s,l){return e(t,r,l)}}function vLe(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(c,d){var u=n(),f=u.cache,m=f===void 0?t?new WeakMap:void 0:f,h=u.meta;return r(c,d,{cache:m,equals:a,meta:h,strict:i})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(c,d){return r(c,d,s)}}var xLe=Ah();Ah({strict:!0});Ah({circular:!0});Ah({circular:!0,strict:!0});Ah({createInternalComparator:function(){return yg}});Ah({strict:!0,createInternalComparator:function(){return yg}});Ah({circular:!0,createInternalComparator:function(){return yg}});Ah({circular:!0,createInternalComparator:function(){return yg},strict:!0});function Ah(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,s=i===void 0?!1:i,l=pLe(e),c=hLe(l),d=n?n(c):gLe(c);return vLe({circular:r,comparator:c,createState:a,equals:d,strict:s})}function yLe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function JB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):yLe(a)};requestAnimationFrame(n)}function n3(e){"@babel/helpers - typeof";return n3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n3(e)}function bLe(e){return _Le(e)||NLe(e)||jLe(e)||wLe()}function wLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jLe(e,t){if(e){if(typeof e=="string")return QB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QB(e,t)}}function QB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Le(e){if(Array.isArray(e))return e}function SLe(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var s=i,l=bLe(s),c=l[0],d=l.slice(1);if(typeof c=="number"){JB(a.bind(null,d),c);return}a(c),JB(a.bind(null,d));return}n3(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function a1(e){"@babel/helpers - typeof";return a1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a1(e)}function ZB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function e7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZB(Object(r),!0).forEach(function(n){KJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KJ(e,t,r){return t=CLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CLe(e){var t=PLe(e,"string");return a1(t)==="symbol"?t:String(t)}function PLe(e,t){if(a1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(a1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ALe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},ELe=function(t){return t},kLe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Vy=function(t,r){return Object.keys(r).reduce(function(n,a){return e7(e7({},n),{},KJ({},a,t(a,r[a])))},{})},t7=function(t,r,n){return t.map(function(a){return"".concat(kLe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function OLe(e,t){return DLe(e)||ILe(e,t)||YJ(e,t)||TLe()}function TLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ILe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function DLe(e){if(Array.isArray(e))return e}function MLe(e){return $Le(e)||LLe(e)||YJ(e)||RLe()}function RLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YJ(e,t){if(e){if(typeof e=="string")return a3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a3(e,t)}}function LLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Le(e){if(Array.isArray(e))return a3(e)}function a3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s_=1e-4,XJ=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},JJ=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},r7=function(t,r){return function(n){var a=XJ(t,r);return JJ(a,n)}},FLe=function(t,r){return function(n){var a=XJ(t,r),i=[].concat(MLe(a.map(function(s,l){return s*l}).slice(1)),[0]);return JJ(i,n)}},n7=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],s=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,s=1,l=1;break;case"ease":a=.25,i=.1,s=.25,l=1;break;case"ease-in":a=.42,i=0,s=1,l=1;break;case"ease-out":a=.42,i=0,s=.58,l=1;break;case"ease-in-out":a=0,i=0,s=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(x){return parseFloat(x)}),u=OLe(d,4);a=u[0],i=u[1],s=u[2],l=u[3]}}}var f=r7(a,s),m=r7(i,l),h=FLe(a,s),v=function(y){return y>1?1:y<0?0:y},g=function(y){for(var b=y>1?1:y,w=b,j=0;j<8;++j){var _=f(w)-b,S=h(w);if(Math.abs(_-b)<s_||S<s_)return m(w);w=v(w-_/S)}return m(w)};return g.isStepper=!1,g},BLe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,s=t.dt,l=s===void 0?17:s,c=function(u,f,m){var h=-(u-f)*n,v=m*i,g=m+(h-v)*l/1e3,x=m*l/1e3+u;return Math.abs(x-f)<s_&&Math.abs(g)<s_?[f,0]:[x,g]};return c.isStepper=!0,c.dt=l,c},qLe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return n7(a);case"spring":return BLe();default:if(a.split("(")[0]==="cubic-bezier")return n7(a)}return typeof a=="function"?a:null};function o1(e){"@babel/helpers - typeof";return o1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o1(e)}function a7(e){return VLe(e)||ULe(e)||QJ(e)||zLe()}function zLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ULe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VLe(e){if(Array.isArray(e))return i3(e)}function o7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ys(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o7(Object(r),!0).forEach(function(n){o3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o3(e,t,r){return t=WLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WLe(e){var t=HLe(e,"string");return o1(t)==="symbol"?t:String(t)}function HLe(e,t){if(o1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(o1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GLe(e,t){return XLe(e)||YLe(e,t)||QJ(e,t)||KLe()}function KLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QJ(e,t){if(e){if(typeof e=="string")return i3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i3(e,t)}}function i3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function XLe(e){if(Array.isArray(e))return e}var l_=function(t,r,n){return t+(r-t)*n},s3=function(t){var r=t.from,n=t.to;return r!==n},JLe=function e(t,r,n){var a=Vy(function(i,s){if(s3(s)){var l=t(s.from,s.to,s.velocity),c=GLe(l,2),d=c[0],u=c[1];return ys(ys({},s),{},{from:d,velocity:u})}return s},r);return n<1?Vy(function(i,s){return s3(s)?ys(ys({},s),{},{velocity:l_(s.velocity,a[i].velocity,n),from:l_(s.from,a[i].from,n)}):s},r):e(t,a,n-1)};const QLe=function(e,t,r,n,a){var i=ALe(e,t),s=i.reduce(function(x,y){return ys(ys({},x),{},o3({},y,[e[y],t[y]]))},{}),l=i.reduce(function(x,y){return ys(ys({},x),{},o3({},y,{from:e[y],velocity:0,to:t[y]}))},{}),c=-1,d,u,f=function(){return null},m=function(){return Vy(function(y,b){return b.from},l)},h=function(){return!Object.values(l).filter(s3).length},v=function(y){d||(d=y);var b=y-d,w=b/r.dt;l=JLe(r,l,w),a(ys(ys(ys({},e),t),m())),d=y,h()||(c=requestAnimationFrame(f))},g=function(y){u||(u=y);var b=(y-u)/n,w=Vy(function(_,S){return l_.apply(void 0,a7(S).concat([r(b)]))},s);if(a(ys(ys(ys({},e),t),w)),b<1)c=requestAnimationFrame(f);else{var j=Vy(function(_,S){return l_.apply(void 0,a7(S).concat([r(1)]))},s);a(ys(ys(ys({},e),t),j))}};return f=r.isStepper?v:g,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function wx(e){"@babel/helpers - typeof";return wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wx(e)}var ZLe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function e6e(e,t){if(e==null)return{};var r=t6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t6e(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function wA(e){return o6e(e)||a6e(e)||n6e(e)||r6e()}function r6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n6e(e,t){if(e){if(typeof e=="string")return l3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l3(e,t)}}function a6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function o6e(e){if(Array.isArray(e))return l3(e)}function l3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(r),!0).forEach(function(n){gy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gy(e,t,r){return t=ZJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZJ(n.key),n)}}function s6e(e,t,r){return t&&s7(e.prototype,t),r&&s7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZJ(e){var t=l6e(e,"string");return wx(t)==="symbol"?t:String(t)}function l6e(e,t){if(wx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function c6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c3(e,t)}function c3(e,t){return c3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},c3(e,t)}function d6e(e){var t=u6e();return function(){var n=c_(e),a;if(t){var i=c_(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return d3(this,a)}}function d3(e,t){if(t&&(wx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u3(e)}function u3(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function c_(e){return c_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},c_(e)}var kC=function(e){c6e(r,e);var t=d6e(r);function r(n,a){var i;i6e(this,r),i=t.call(this,n,a);var s=i.props,l=s.isActive,c=s.attributeName,d=s.from,u=s.to,f=s.steps,m=s.children,h=s.duration;if(i.handleStyleChange=i.handleStyleChange.bind(u3(i)),i.changeStyle=i.changeStyle.bind(u3(i)),!l||h<=0)return i.state={style:{}},typeof m=="function"&&(i.state={style:u}),d3(i);if(f&&f.length)i.state={style:f[0].style};else if(d){if(typeof m=="function")return i.state={style:d},d3(i);i.state={style:c?gy({},c,d):d}}else i.state={style:{}};return i}return s6e(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,s=a.canBegin;this.mounted=!0,!(!i||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,s=i.isActive,l=i.canBegin,c=i.attributeName,d=i.shouldReAnimate,u=i.to,f=i.from,m=this.state.style;if(l){if(!s){var h={style:c?gy({},c,u):u};this.state&&m&&(c&&m[c]!==u||!c&&m!==u)&&this.setState(h);return}if(!(xLe(a.to,u)&&a.canBegin&&a.isActive)){var v=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=v||d?f:a.to;if(this.state&&m){var x={style:c?gy({},c,g):g};(c&&m[c]!==g||!c&&m!==g)&&this.setState(x)}this.runAnimation(kd(kd({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,s=a.from,l=a.to,c=a.duration,d=a.easing,u=a.begin,f=a.onAnimationEnd,m=a.onAnimationStart,h=QLe(s,l,qLe(d),c,this.changeStyle),v=function(){i.stopJSAnimation=h()};this.manager.start([m,u,v,c,f])}},{key:"runStepAnimation",value:function(a){var i=this,s=a.steps,l=a.begin,c=a.onAnimationStart,d=s[0],u=d.style,f=d.duration,m=f===void 0?0:f,h=function(g,x,y){if(y===0)return g;var b=x.duration,w=x.easing,j=w===void 0?"ease":w,_=x.style,S=x.properties,k=x.onAnimationEnd,E=y>0?s[y-1]:x,A=S||Object.keys(_);if(typeof j=="function"||j==="spring")return[].concat(wA(g),[i.runJSAnimation.bind(i,{from:E.style,to:_,duration:b,easing:j}),b]);var M=t7(A,b,j),C=kd(kd(kd({},E.style),_),{},{transition:M});return[].concat(wA(g),[C,b,k]).filter(ELe)};return this.manager.start([c].concat(wA(s.reduce(h,[u,Math.max(m,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=SLe());var i=a.begin,s=a.duration,l=a.attributeName,c=a.to,d=a.easing,u=a.onAnimationStart,f=a.onAnimationEnd,m=a.steps,h=a.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof d=="function"||typeof h=="function"||d==="spring"){this.runJSAnimation(a);return}if(m.length>1){this.runStepAnimation(a);return}var g=l?gy({},l,c):c,x=t7(Object.keys(g),s,d);v.start([u,i,kd(kd({},g),{},{transition:x}),s,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var s=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=e6e(a,ZLe),d=p.Children.count(i),u=this.state.style;if(typeof i=="function")return i(u);if(!l||d===0||s<=0)return i;var f=function(h){var v=h.props,g=v.style,x=g===void 0?{}:g,y=v.className,b=p.cloneElement(h,kd(kd({},c),{},{style:kd(kd({},x),u),className:y}));return b};return d===1?f(p.Children.only(i)):xe.createElement("div",null,p.Children.map(i,function(m){return f(m)}))}}]),r}(p.PureComponent);kC.displayName="Animate";kC.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};kC.propTypes={from:Ln.oneOfType([Ln.object,Ln.string]),to:Ln.oneOfType([Ln.object,Ln.string]),attributeName:Ln.string,duration:Ln.number,begin:Ln.number,easing:Ln.oneOfType([Ln.string,Ln.func]),steps:Ln.arrayOf(Ln.shape({duration:Ln.number.isRequired,style:Ln.object.isRequired,easing:Ln.oneOfType([Ln.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Ln.func]),properties:Ln.arrayOf("string"),onAnimationEnd:Ln.func})),children:Ln.oneOfType([Ln.node,Ln.func]),isActive:Ln.bool,canBegin:Ln.bool,onAnimationEnd:Ln.func,shouldReAnimate:Ln.bool,onAnimationStart:Ln.func,onAnimationReStart:Ln.func};const hh=kC;function qn(){return qn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qn.apply(null,arguments)}function d_(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function eQ(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,dO(e,t)}function i1(e){"@babel/helpers - typeof";return i1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i1(e)}function u_(){return u_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u_.apply(this,arguments)}function f6e(e,t){return g6e(e)||p6e(e,t)||h6e(e,t)||m6e()}function m6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h6e(e,t){if(e){if(typeof e=="string")return l7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l7(e,t)}}function l7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p6e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function g6e(e){if(Array.isArray(e))return e}function c7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c7(Object(r),!0).forEach(function(n){v6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v6e(e,t,r){return t=x6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x6e(e){var t=y6e(e,"string");return i1(t)=="symbol"?t:t+""}function y6e(e,t){if(i1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u7=function(t,r,n,a,i){var s=Math.min(Math.abs(n)/2,Math.abs(a)/2),l=a>=0?1:-1,c=n>=0?1:-1,d=a>=0&&n>=0||a<0&&n<0?1:0,u;if(s>0&&i instanceof Array){for(var f=[0,0,0,0],m=0,h=4;m<h;m++)f[m]=i[m]>s?s:i[m];u="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(r)),u+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+l*f[1])),u+="L ".concat(t+n,",").concat(r+a-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+n-c*f[2],",").concat(r+a)),u+="L ".concat(t+c*f[3],",").concat(r+a),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+a-l*f[3])),u+="Z"}else if(s>0&&i===+i&&i>0){var v=Math.min(s,i);u="M ".concat(t,",").concat(r+l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+c*v,",").concat(r,`
            L `).concat(t+n-c*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n,",").concat(r+l*v,`
            L `).concat(t+n,",").concat(r+a-l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n-c*v,",").concat(r+a,`
            L `).concat(t+c*v,",").concat(r+a,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t,",").concat(r+a-l*v," Z")}else u="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return u},b6e=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,s=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(i,i+l),u=Math.max(i,i+l),f=Math.min(s,s+c),m=Math.max(s,s+c);return n>=d&&n<=u&&a>=f&&a<=m}return!1},w6e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ED=function(t){var r=d7(d7({},w6e),t),n=p.useRef(),a=p.useState(-1),i=f6e(a,2),s=i[0],l=i[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var j=n.current.getTotalLength();j&&l(j)}catch{}},[]);var c=r.x,d=r.y,u=r.width,f=r.height,m=r.radius,h=r.className,v=r.animationEasing,g=r.animationDuration,x=r.animationBegin,y=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||u===0||f===0)return null;var w=ta("recharts-rectangle",h);return b?xe.createElement(hh,{canBegin:s>0,from:{width:u,height:f,x:c,y:d},to:{width:u,height:f,x:c,y:d},duration:g,animationEasing:v,isActive:b},function(j){var _=j.width,S=j.height,k=j.x,E=j.y;return xe.createElement(hh,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:g,isActive:y,easing:v},xe.createElement("path",u_({},On(r,!0),{className:w,d:u7(k,E,_,S,m),ref:n})))}):xe.createElement("path",u_({},On(r,!0),{className:w,d:u7(c,d,u,f,m)}))},j6e=["points","className","baseLinePoints","connectNulls"];function _v(){return _v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_v.apply(this,arguments)}function N6e(e,t){if(e==null)return{};var r=_6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function f7(e){return A6e(e)||P6e(e)||C6e(e)||S6e()}function S6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C6e(e,t){if(e){if(typeof e=="string")return f3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f3(e,t)}}function P6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function A6e(e){if(Array.isArray(e))return f3(e)}function f3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var m7=function(t){return t&&t.x===+t.x&&t.y===+t.y},E6e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){m7(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),m7(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Wy=function(t,r){var n=E6e(t);r&&(n=[n.reduce(function(i,s){return[].concat(f7(i),f7(s))},[])]);var a=n.map(function(i){return i.reduce(function(s,l,c){return"".concat(s).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},k6e=function(t,r,n){var a=Wy(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Wy(r.reverse(),n).slice(1))},O6e=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,i=t.connectNulls,s=N6e(t,j6e);if(!r||!r.length)return null;var l=ta("recharts-polygon",n);if(a&&a.length){var c=s.stroke&&s.stroke!=="none",d=k6e(r,a,i);return xe.createElement("g",{className:l},xe.createElement("path",_v({},On(s,!0),{fill:d.slice(-1)==="Z"?s.fill:"none",stroke:"none",d})),c?xe.createElement("path",_v({},On(s,!0),{fill:"none",d:Wy(r,i)})):null,c?xe.createElement("path",_v({},On(s,!0),{fill:"none",d:Wy(a,i)})):null)}var u=Wy(r,i);return xe.createElement("path",_v({},On(s,!0),{fill:u.slice(-1)==="Z"?s.fill:"none",className:l,d:u}))};function m3(){return m3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m3.apply(this,arguments)}var aw=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,s=ta("recharts-dot",i);return r===+r&&n===+n&&a===+a?p.createElement("circle",m3({},On(t,!1),kN(t),{className:s,cx:r,cy:n,r:a})):null};function s1(e){"@babel/helpers - typeof";return s1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s1(e)}var T6e=["x","y","top","left","width","height","className"];function h3(){return h3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h3.apply(this,arguments)}function h7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function I6e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h7(Object(r),!0).forEach(function(n){D6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D6e(e,t,r){return t=M6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M6e(e){var t=R6e(e,"string");return s1(t)=="symbol"?t:t+""}function R6e(e,t){if(s1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(s1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L6e(e,t){if(e==null)return{};var r=$6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var F6e=function(t,r,n,a,i,s){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(s,",").concat(r,"h").concat(n)},B6e=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.top,l=s===void 0?0:s,c=t.left,d=c===void 0?0:c,u=t.width,f=u===void 0?0:u,m=t.height,h=m===void 0?0:m,v=t.className,g=L6e(t,T6e),x=I6e({x:n,y:i,top:l,left:d,width:f,height:h},g);return!Vr(n)||!Vr(i)||!Vr(f)||!Vr(h)||!Vr(l)||!Vr(d)?null:xe.createElement("path",h3({},On(x,!0),{className:ta("recharts-cross",v),d:F6e(n,i,f,h,l,d)}))},q6e=CC,z6e=fJ,U6e=Wu;function V6e(e,t){return e&&e.length?q6e(e,U6e(t),z6e):void 0}var W6e=V6e;const H6e=Ba(W6e);var G6e=CC,K6e=Wu,Y6e=mJ;function X6e(e,t){return e&&e.length?G6e(e,K6e(t),Y6e):void 0}var J6e=X6e;const Q6e=Ba(J6e);var Z6e=["cx","cy","angle","ticks","axisLine"],e$e=["ticks","tick","angle","tickFormatter","stroke"];function jx(e){"@babel/helpers - typeof";return jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jx(e)}function Hy(){return Hy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hy.apply(this,arguments)}function p7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p7(Object(r),!0).forEach(function(n){OC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g7(e,t){if(e==null)return{};var r=t$e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function r$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rQ(n.key),n)}}function n$e(e,t,r){return t&&v7(e.prototype,t),r&&v7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a$e(e,t,r){return t=f_(t),o$e(e,tQ()?Reflect.construct(t,r||[],f_(e).constructor):t.apply(e,r))}function o$e(e,t){if(t&&(jx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return i$e(e)}function i$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tQ=function(){return!!e})()}function f_(e){return f_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},f_(e)}function s$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p3(e,t)}function p3(e,t){return p3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},p3(e,t)}function OC(e,t,r){return t=rQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rQ(e){var t=l$e(e,"string");return jx(t)=="symbol"?t:t+""}function l$e(e,t){if(jx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TC=function(e){function t(){return r$e(this,t),a$e(this,t,arguments)}return s$e(t,e),n$e(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,i=this.props,s=i.angle,l=i.cx,c=i.cy;return _o(l,c,a,s)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,l=n.ticks,c=H6e(l,function(u){return u.coordinate||0}),d=Q6e(l,function(u){return u.coordinate||0});return{cx:a,cy:i,startAngle:s,endAngle:s,innerRadius:d.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,l=n.ticks,c=n.axisLine,d=g7(n,Z6e),u=l.reduce(function(v,g){return[Math.min(v[0],g.coordinate),Math.max(v[1],g.coordinate)]},[1/0,-1/0]),f=_o(a,i,u[0],s),m=_o(a,i,u[1],s),h=zh(zh(zh({},On(d,!1)),{},{fill:"none"},On(c,!1)),{},{x1:f.x,y1:f.y,x2:m.x,y2:m.y});return xe.createElement("line",Hy({className:"recharts-polar-radius-axis-line"},h))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,l=a.angle,c=a.tickFormatter,d=a.stroke,u=g7(a,e$e),f=this.getTickTextAnchor(),m=On(u,!1),h=On(s,!1),v=i.map(function(g,x){var y=n.getTickValueCoord(g),b=zh(zh(zh(zh({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(y.x,", ").concat(y.y,")")},m),{},{stroke:"none",fill:d},h),{},{index:x},y),{},{payload:g});return xe.createElement(Na,Hy({className:ta("recharts-polar-radius-axis-tick",qJ(s)),key:"tick-".concat(g.coordinate)},Yp(n.props,g,x)),t.renderTickItem(s,b,c?c(g.value,x):g.value))});return xe.createElement(Na,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.axisLine,s=n.tick;return!a||!a.length?null:xe.createElement(Na,{className:ta("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),s&&this.renderTicks(),ns.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,i){var s;return xe.isValidElement(n)?s=xe.cloneElement(n,a):Vn(n)?s=n(a):s=xe.createElement(Xp,Hy({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),s}}])}(p.PureComponent);OC(TC,"displayName","PolarRadiusAxis");OC(TC,"axisType","radiusAxis");OC(TC,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Nx(e){"@babel/helpers - typeof";return Nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nx(e)}function sp(){return sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sp.apply(this,arguments)}function x7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Uh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x7(Object(r),!0).forEach(function(n){IC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aQ(n.key),n)}}function d$e(e,t,r){return t&&y7(e.prototype,t),r&&y7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u$e(e,t,r){return t=m_(t),f$e(e,nQ()?Reflect.construct(t,r||[],m_(e).constructor):t.apply(e,r))}function f$e(e,t){if(t&&(Nx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return m$e(e)}function m$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nQ=function(){return!!e})()}function m_(e){return m_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},m_(e)}function h$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g3(e,t)}function g3(e,t){return g3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},g3(e,t)}function IC(e,t,r){return t=aQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aQ(e){var t=p$e(e,"string");return Nx(t)=="symbol"?t:t+""}function p$e(e,t){if(Nx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g$e=Math.PI/180,b7=1e-5,DC=function(e){function t(){return c$e(this,t),u$e(this,t,arguments)}return h$e(t,e),d$e(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.cx,s=a.cy,l=a.radius,c=a.orientation,d=a.tickSize,u=d||8,f=_o(i,s,l,n.coordinate),m=_o(i,s,l+(c==="inner"?-1:1)*u,n.coordinate);return{x1:f.x,y1:f.y,x2:m.x,y2:m.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,i=Math.cos(-n.coordinate*g$e),s;return i>b7?s=a==="outer"?"start":"end":i<-b7?s=a==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.radius,l=n.axisLine,c=n.axisLineType,d=Uh(Uh({},On(this.props,!1)),{},{fill:"none"},On(l,!1));if(c==="circle")return xe.createElement(aw,sp({className:"recharts-polar-angle-axis-line"},d,{cx:a,cy:i,r:s}));var u=this.props.ticks,f=u.map(function(m){return _o(a,i,s,m.coordinate)});return xe.createElement(O6e,sp({className:"recharts-polar-angle-axis-line"},d,{points:f}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,l=a.tickLine,c=a.tickFormatter,d=a.stroke,u=On(this.props,!1),f=On(s,!1),m=Uh(Uh({},u),{},{fill:"none"},On(l,!1)),h=i.map(function(v,g){var x=n.getTickLineCoord(v),y=n.getTickTextAnchor(v),b=Uh(Uh(Uh({textAnchor:y},u),{},{stroke:"none",fill:d},f),{},{index:g,payload:v,x:x.x2,y:x.y2});return xe.createElement(Na,sp({className:ta("recharts-polar-angle-axis-tick",qJ(s)),key:"tick-".concat(v.coordinate)},Yp(n.props,v,g)),l&&xe.createElement("line",sp({className:"recharts-polar-angle-axis-tick-line"},m,x)),s&&t.renderTickItem(s,b,c?c(v.value,g):v.value))});return xe.createElement(Na,{className:"recharts-polar-angle-axis-ticks"},h)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.radius,s=n.axisLine;return i<=0||!a||!a.length?null:xe.createElement(Na,{className:ta("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,i){var s;return xe.isValidElement(n)?s=xe.cloneElement(n,a):Vn(n)?s=n(a):s=xe.createElement(Xp,sp({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),s}}])}(p.PureComponent);IC(DC,"displayName","PolarAngleAxis");IC(DC,"axisType","angleAxis");IC(DC,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var v$e=lX,x$e=v$e(Object.getPrototypeOf,Object),y$e=x$e,b$e=Wf,w$e=y$e,j$e=Hf,N$e="[object Object]",_$e=Function.prototype,S$e=Object.prototype,oQ=_$e.toString,C$e=S$e.hasOwnProperty,P$e=oQ.call(Object);function A$e(e){if(!j$e(e)||b$e(e)!=N$e)return!1;var t=w$e(e);if(t===null)return!0;var r=C$e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&oQ.call(r)==P$e}var E$e=A$e;const k$e=Ba(E$e);var O$e=Wf,T$e=Hf,I$e="[object Boolean]";function D$e(e){return e===!0||e===!1||T$e(e)&&O$e(e)==I$e}var M$e=D$e;const R$e=Ba(M$e);function l1(e){"@babel/helpers - typeof";return l1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l1(e)}function h_(){return h_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h_.apply(this,arguments)}function L$e(e,t){return q$e(e)||B$e(e,t)||F$e(e,t)||$$e()}function $$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F$e(e,t){if(e){if(typeof e=="string")return w7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w7(e,t)}}function w7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function q$e(e){if(Array.isArray(e))return e}function j7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j7(Object(r),!0).forEach(function(n){z$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z$e(e,t,r){return t=U$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U$e(e){var t=V$e(e,"string");return l1(t)=="symbol"?t:t+""}function V$e(e,t){if(l1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(l1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _7=function(t,r,n,a,i){var s=n-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-s/2,",").concat(r+i),l+="L ".concat(t+n-s/2-a,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},W$e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},H$e=function(t){var r=N7(N7({},W$e),t),n=p.useRef(),a=p.useState(-1),i=L$e(a,2),s=i[0],l=i[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&l(w)}catch{}},[]);var c=r.x,d=r.y,u=r.upperWidth,f=r.lowerWidth,m=r.height,h=r.className,v=r.animationEasing,g=r.animationDuration,x=r.animationBegin,y=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||m!==+m||u===0&&f===0||m===0)return null;var b=ta("recharts-trapezoid",h);return y?xe.createElement(hh,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:m,x:c,y:d},to:{upperWidth:u,lowerWidth:f,height:m,x:c,y:d},duration:g,animationEasing:v,isActive:y},function(w){var j=w.upperWidth,_=w.lowerWidth,S=w.height,k=w.x,E=w.y;return xe.createElement(hh,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:g,easing:v},xe.createElement("path",h_({},On(r,!0),{className:b,d:_7(k,E,j,_,S),ref:n})))}):xe.createElement("g",null,xe.createElement("path",h_({},On(r,!0),{className:b,d:_7(c,d,u,f,m)})))},G$e=["option","shapeType","propTransformer","activeClassName","isActive"];function c1(e){"@babel/helpers - typeof";return c1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c1(e)}function K$e(e,t){if(e==null)return{};var r=Y$e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Y$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function S7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S7(Object(r),!0).forEach(function(n){X$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X$e(e,t,r){return t=J$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J$e(e){var t=Q$e(e,"string");return c1(t)=="symbol"?t:t+""}function Q$e(e,t){if(c1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(c1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z$e(e,t){return p_(p_({},t),e)}function eFe(e,t){return e==="symbols"}function C7(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return xe.createElement(ED,r);case"trapezoid":return xe.createElement(H$e,r);case"sector":return xe.createElement(AD,r);case"symbols":if(eFe(t))return xe.createElement(GI,r);break;default:return null}}function tFe(e){return p.isValidElement(e)?e.props:e}function iQ(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?Z$e:n,i=e.activeClassName,s=i===void 0?"recharts-active-shape":i,l=e.isActive,c=K$e(e,G$e),d;if(p.isValidElement(t))d=p.cloneElement(t,p_(p_({},c),tFe(t)));else if(Vn(t))d=t(c);else if(k$e(t)&&!R$e(t)){var u=a(t,c);d=xe.createElement(C7,{shapeType:r,elementProps:u})}else{var f=c;d=xe.createElement(C7,{shapeType:r,elementProps:f})}return l?xe.createElement(Na,{className:s},d):d}function MC(e,t){return t!=null&&"trapezoids"in e.props}function RC(e,t){return t!=null&&"sectors"in e.props}function d1(e,t){return t!=null&&"points"in e.props}function rFe(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function nFe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function aFe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function oFe(e,t){var r;return MC(e,t)?r=rFe:RC(e,t)?r=nFe:d1(e,t)&&(r=aFe),r}function iFe(e,t){var r;return MC(e,t)?r="trapezoids":RC(e,t)?r="sectors":d1(e,t)&&(r="points"),r}function sFe(e,t){if(MC(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(RC(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return d1(e,t)?t.payload:{}}function lFe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=iFe(r,t),i=sFe(r,t),s=n.filter(function(c,d){var u=Jp(i,c),f=r.props[a].filter(function(v){var g=oFe(r,t);return g(v,t)}),m=r.props[a].indexOf(f[f.length-1]),h=d===m;return u&&h}),l=n.indexOf(s[s.length-1]);return l}var Sj;function _x(e){"@babel/helpers - typeof";return _x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_x(e)}function Sv(){return Sv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sv.apply(this,arguments)}function P7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P7(Object(r),!0).forEach(function(n){ed(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lQ(n.key),n)}}function dFe(e,t,r){return t&&A7(e.prototype,t),r&&A7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uFe(e,t,r){return t=g_(t),fFe(e,sQ()?Reflect.construct(t,r||[],g_(e).constructor):t.apply(e,r))}function fFe(e,t){if(t&&(_x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mFe(e)}function mFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sQ=function(){return!!e})()}function g_(e){return g_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},g_(e)}function hFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v3(e,t)}function v3(e,t){return v3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},v3(e,t)}function ed(e,t,r){return t=lQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lQ(e){var t=pFe(e,"string");return _x(t)=="symbol"?t:t+""}function pFe(e,t){if(_x(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_x(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qu=function(e){function t(r){var n;return cFe(this,t),n=uFe(this,t,[r]),ed(n,"pieRef",null),ed(n,"sectorRefs",[]),ed(n,"id",gg("recharts-pie-")),ed(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Vn(a)&&a()}),ed(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Vn(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return hFe(t,e),dFe(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.label,l=i.labelLine,c=i.dataKey,d=i.valueKey,u=On(this.props,!1),f=On(s,!1),m=On(l,!1),h=s&&s.offsetRadius||20,v=n.map(function(g,x){var y=(g.startAngle+g.endAngle)/2,b=_o(g.cx,g.cy,g.outerRadius+h,y),w=bo(bo(bo(bo({},u),g),{},{stroke:"none"},f),{},{index:x,textAnchor:t.getTextAnchor(b.x,g.cx)},b),j=bo(bo(bo(bo({},u),g),{},{fill:"none",stroke:g.fill},m),{},{index:x,points:[_o(g.cx,g.cy,g.outerRadius,y),b]}),_=c;return Xn(c)&&Xn(d)?_="value":Xn(c)&&(_=d),xe.createElement(Na,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(x)},l&&t.renderLabelLineItem(l,j,"line"),t.renderLabelItem(s,w,pi(g,_)))});return xe.createElement(Na,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(n){var a=this,i=this.props,s=i.activeShape,l=i.blendStroke,c=i.inactiveShape;return n.map(function(d,u){if(d?.startAngle===0&&d?.endAngle===0&&n.length!==1)return null;var f=a.isActiveIndex(u),m=c&&a.hasActiveIndex()?c:null,h=f?s:m,v=bo(bo({},d),{},{stroke:l?d.fill:d.stroke,tabIndex:-1});return xe.createElement(Na,Sv({ref:function(x){x&&!a.sectorRefs.includes(x)&&a.sectorRefs.push(x)},tabIndex:-1,className:"recharts-pie-sector"},Yp(a.props,d,u),{key:"sector-".concat(d?.startAngle,"-").concat(d?.endAngle,"-").concat(d.midAngle,"-").concat(u)}),xe.createElement(iQ,Sv({option:h,isActive:f,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,i=a.sectors,s=a.isAnimationActive,l=a.animationBegin,c=a.animationDuration,d=a.animationEasing,u=a.animationId,f=this.state,m=f.prevSectors,h=f.prevIsAnimationActive;return xe.createElement(hh,{begin:l,duration:c,isActive:s,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(h),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var g=v.t,x=[],y=i&&i[0],b=y.startAngle;return i.forEach(function(w,j){var _=m&&m[j],S=j>0?gc(w,"paddingAngle",0):0;if(_){var k=Vi(_.endAngle-_.startAngle,w.endAngle-w.startAngle),E=bo(bo({},w),{},{startAngle:b+S,endAngle:b+k(g)+S});x.push(E),b=E.endAngle}else{var A=w.endAngle,M=w.startAngle,C=Vi(0,A-M),T=C(g),I=bo(bo({},w),{},{startAngle:b+S,endAngle:b+T+S});x.push(I),b=I.endAngle}}),xe.createElement(Na,null,n.renderSectorsStatically(x))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var s=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[s].focus(),a.setState({sectorToFocus:s});break}case"ArrowRight":{var l=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[l].focus(),a.setState({sectorToFocus:l});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,i=n.isAnimationActive,s=this.state.prevSectors;return i&&a&&a.length&&(!s||!Jp(s,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,i=a.hide,s=a.sectors,l=a.className,c=a.label,d=a.cx,u=a.cy,f=a.innerRadius,m=a.outerRadius,h=a.isAnimationActive,v=this.state.isAnimationFinished;if(i||!s||!s.length||!Vr(d)||!Vr(u)||!Vr(f)||!Vr(m))return null;var g=ta("recharts-pie",l);return xe.createElement(Na,{tabIndex:this.props.rootTabIndex,className:g,ref:function(y){n.pieRef=y}},this.renderSectors(),c&&this.renderLabels(s),ns.renderCallByParent(this.props,null,!1),(!h||v)&&Mu.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,i){if(xe.isValidElement(n))return xe.cloneElement(n,a);if(Vn(n))return n(a);var s=ta("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return xe.createElement(Tp,Sv({},a,{key:i,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(n,a,i){if(xe.isValidElement(n))return xe.cloneElement(n,a);var s=i;if(Vn(n)&&(s=n(a),xe.isValidElement(s)))return s;var l=ta("recharts-pie-label-text",typeof n!="boolean"&&!Vn(n)?n.className:"");return xe.createElement(Xp,Sv({},a,{alignmentBaseline:"middle",className:l}),s)}}])}(p.PureComponent);Sj=qu;ed(qu,"displayName","Pie");ed(qu,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Jd.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});ed(qu,"parseDeltaAngle",function(e,t){var r=dl(t-e),n=Math.min(Math.abs(t-e),360);return r*n});ed(qu,"getRealPieData",function(e){var t=e.data,r=e.children,n=On(e,!1),a=vc(r,Bb);return t&&t.length?t.map(function(i,s){return bo(bo(bo({payload:i},n),i),a&&a[s]&&a[s].props)}):a&&a.length?a.map(function(i){return bo(bo({},n),i.props)}):[]});ed(qu,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,i=t.height,s=BJ(a,i),l=n+ul(e.cx,a,a/2),c=r+ul(e.cy,i,i/2),d=ul(e.innerRadius,s,0),u=ul(e.outerRadius,s,s*.8),f=e.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:l,cy:c,innerRadius:d,outerRadius:u,maxRadius:f}});ed(qu,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?bo(bo({},t.type.defaultProps),t.props):t.props,a=Sj.getRealPieData(n);if(!a||!a.length)return null;var i=n.cornerRadius,s=n.startAngle,l=n.endAngle,c=n.paddingAngle,d=n.dataKey,u=n.nameKey,f=n.valueKey,m=n.tooltipType,h=Math.abs(n.minAngle),v=Sj.parseCoordinateOfPie(n,r),g=Sj.parseDeltaAngle(s,l),x=Math.abs(g),y=d;Xn(d)&&Xn(f)?(Xd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y="value"):Xn(d)&&(Xd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y=f);var b=a.filter(function(E){return pi(E,y,0)!==0}).length,w=(x>=360?b:b-1)*c,j=x-b*h-w,_=a.reduce(function(E,A){var M=pi(A,y,0);return E+(Vr(M)?M:0)},0),S;if(_>0){var k;S=a.map(function(E,A){var M=pi(E,y,0),C=pi(E,u,A),T=(Vr(M)?M:0)/_,I;A?I=k.endAngle+dl(g)*c*(M!==0?1:0):I=s;var D=I+dl(g)*((M!==0?h:0)+T*j),F=(I+D)/2,z=(v.innerRadius+v.outerRadius)/2,q=[{name:C,value:M,payload:E,dataKey:y,type:m}],$=_o(v.cx,v.cy,z,F);return k=bo(bo(bo({percent:T,cornerRadius:i,name:C,tooltipPayload:q,midAngle:F,middleRadius:z,tooltipPosition:$},E),v),{},{value:pi(E,y),startAngle:I,endAngle:D,payload:E,paddingAngle:dl(g)*c}),k})}return bo(bo({},v),{},{sectors:S,data:a})});var gFe=Math.ceil,vFe=Math.max;function xFe(e,t,r,n){for(var a=-1,i=vFe(gFe((t-e)/(r||1)),0),s=Array(i);i--;)s[n?i:++a]=e,e+=r;return s}var yFe=xFe,bFe=PX,E7=1/0,wFe=17976931348623157e292;function jFe(e){if(!e)return e===0?e:0;if(e=bFe(e),e===E7||e===-E7){var t=e<0?-1:1;return t*wFe}return e===e?e:0}var cQ=jFe,NFe=yFe,_Fe=yC,jA=cQ;function SFe(e){return function(t,r,n){return n&&typeof n!="number"&&_Fe(t,r,n)&&(r=n=void 0),t=jA(t),r===void 0?(r=t,t=0):r=jA(r),n=n===void 0?t<r?1:-1:jA(n),NFe(t,r,n,e)}}var CFe=SFe,PFe=CFe,AFe=PFe(),EFe=AFe;const v_=Ba(EFe);function u1(e){"@babel/helpers - typeof";return u1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u1(e)}function k7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function O7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(r),!0).forEach(function(n){dQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dQ(e,t,r){return t=kFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kFe(e){var t=OFe(e,"string");return u1(t)=="symbol"?t:t+""}function OFe(e,t){if(u1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(u1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TFe=["Webkit","Moz","O","ms"],IFe=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=TFe.reduce(function(i,s){return O7(O7({},i),{},dQ({},s+n,r))},{});return a[t]=r,a};function Sx(e){"@babel/helpers - typeof";return Sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sx(e)}function x_(){return x_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x_.apply(this,arguments)}function T7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function NA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T7(Object(r),!0).forEach(function(n){ec(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fQ(n.key),n)}}function MFe(e,t,r){return t&&I7(e.prototype,t),r&&I7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RFe(e,t,r){return t=y_(t),LFe(e,uQ()?Reflect.construct(t,r||[],y_(e).constructor):t.apply(e,r))}function LFe(e,t){if(t&&(Sx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Fe(e)}function $Fe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uQ=function(){return!!e})()}function y_(e){return y_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},y_(e)}function FFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x3(e,t)}function x3(e,t){return x3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},x3(e,t)}function ec(e,t,r){return t=fQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fQ(e){var t=BFe(e,"string");return Sx(t)=="symbol"?t:t+""}function BFe(e,t){if(Sx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qFe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,s=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=zy().domain(v_(0,c)).range([i,i+s-l]),u=d.domain().map(function(f){return d(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(a),scale:d,scaleValues:u}},D7=function(t){return t.changedTouches&&!!t.changedTouches.length},Cx=function(e){function t(r){var n;return DFe(this,t),n=RFe(this,t,[r]),ec(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),ec(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),ec(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,s=a.onDragEnd,l=a.startIndex;s?.({endIndex:i,startIndex:l})}),n.detachDragEndListener()}),ec(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),ec(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),ec(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),ec(n,"handleSlideDragStart",function(a){var i=D7(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return FFe(t,e),MFe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,s=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,f=Math.min(a,i),m=Math.max(a,i),h=t.getIndexInRange(s,f),v=t.getIndexInRange(s,m);return{startIndex:h-h%c,endIndex:v===u?u:v-v%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,s=a.tickFormatter,l=a.dataKey,c=pi(i[n],l,n);return Vn(s)?s(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,s=a.startX,l=a.endX,c=this.props,d=c.x,u=c.width,f=c.travellerWidth,m=c.startIndex,h=c.endIndex,v=c.onChange,g=n.pageX-i;g>0?g=Math.min(g,d+u-f-l,d+u-f-s):g<0&&(g=Math.max(g,d-s,d-l));var x=this.getIndex({startX:s+g,endX:l+g});(x.startIndex!==m||x.endIndex!==h)&&v&&v(x),this.setState({startX:s+g,endX:l+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=D7(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,s=a.movingTravellerId,l=a.endX,c=a.startX,d=this.state[s],u=this.props,f=u.x,m=u.width,h=u.travellerWidth,v=u.onChange,g=u.gap,x=u.data,y={startX:this.state.startX,endX:this.state.endX},b=n.pageX-i;b>0?b=Math.min(b,f+m-h-d):b<0&&(b=Math.max(b,f-d)),y[s]=d+b;var w=this.getIndex(y),j=w.startIndex,_=w.endIndex,S=function(){var E=x.length-1;return s==="startX"&&(l>c?j%g===0:_%g===0)||l<c&&_===E||s==="endX"&&(l>c?_%g===0:j%g===0)||l>c&&_===E};this.setState(ec(ec({},s,d+b),"brushMoveStartX",n.pageX),function(){v&&S()&&v(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,s=this.state,l=s.scaleValues,c=s.startX,d=s.endX,u=this.state[a],f=l.indexOf(u);if(f!==-1){var m=f+n;if(!(m===-1||m>=l.length)){var h=l[m];a==="startX"&&h>=d||a==="endX"&&h<=c||this.setState(ec({},a,h),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.fill,d=n.stroke;return xe.createElement("rect",{stroke:d,fill:c,x:a,y:i,width:s,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.data,d=n.children,u=n.padding,f=p.Children.only(d);return f?xe.cloneElement(f,{x:a,y:i,width:s,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,s,l=this,c=this.props,d=c.y,u=c.travellerWidth,f=c.height,m=c.traveller,h=c.ariaLabel,v=c.data,g=c.startIndex,x=c.endIndex,y=Math.max(n,this.props.x),b=NA(NA({},On(this.props,!1)),{},{x:y,y:d,width:u,height:f}),w=h||"Min value: ".concat((i=v[g])===null||i===void 0?void 0:i.name,", Max value: ").concat((s=v[x])===null||s===void 0?void 0:s.name);return xe.createElement(Na,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),l.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(m,b))}},{key:"renderSlide",value:function(n,a){var i=this.props,s=i.y,l=i.height,c=i.stroke,d=i.travellerWidth,u=Math.min(n,a)+d,f=Math.max(Math.abs(a-n)-d,0);return xe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:s,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,s=n.y,l=n.height,c=n.travellerWidth,d=n.stroke,u=this.state,f=u.startX,m=u.endX,h=5,v={pointerEvents:"none",fill:d};return xe.createElement(Na,{className:"recharts-brush-texts"},xe.createElement(Xp,x_({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,m)-h,y:s+l/2},v),this.getTextOfTick(a)),xe.createElement(Xp,x_({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,m)+c+h,y:s+l/2},v),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,s=n.children,l=n.x,c=n.y,d=n.width,u=n.height,f=n.alwaysShowText,m=this.state,h=m.startX,v=m.endX,g=m.isTextActive,x=m.isSlideMoving,y=m.isTravellerMoving,b=m.isTravellerFocused;if(!a||!a.length||!Vr(l)||!Vr(c)||!Vr(d)||!Vr(u)||d<=0||u<=0)return null;var w=ta("recharts-brush",i),j=xe.Children.count(s)===1,_=IFe("userSelect","none");return xe.createElement(Na,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(h,v),this.renderTravellerLayer(h,"startX"),this.renderTravellerLayer(v,"endX"),(g||x||y||b||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,s=n.width,l=n.height,c=n.stroke,d=Math.floor(i+l/2)-1;return xe.createElement(xe.Fragment,null,xe.createElement("rect",{x:a,y:i,width:s,height:l,fill:c,stroke:"none"}),xe.createElement("line",{x1:a+1,y1:d,x2:a+s-1,y2:d,fill:"none",stroke:"#fff"}),xe.createElement("line",{x1:a+1,y1:d+2,x2:a+s-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return xe.isValidElement(n)?i=xe.cloneElement(n,a):Vn(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,s=n.width,l=n.x,c=n.travellerWidth,d=n.updateId,u=n.startIndex,f=n.endIndex;if(i!==a.prevData||d!==a.prevUpdateId)return NA({prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:s},i&&i.length?qFe({data:i,width:s,x:l,travellerWidth:c,startIndex:u,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(s!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+s-c]);var m=a.scale.domain().map(function(h){return a.scale(h)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:s,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:m}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,s=0,l=i-1;l-s>1;){var c=Math.floor((s+l)/2);n[c]>a?l=c:s=c}return a>=n[l]?l:s}}])}(p.PureComponent);ec(Cx,"displayName","Brush");ec(Cx,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var zFe=eD;function UFe(e,t){var r;return zFe(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var VFe=UFe,WFe=eX,HFe=Wu,GFe=VFe,KFe=Bl,YFe=yC;function XFe(e,t,r){var n=KFe(e)?WFe:GFe;return r&&YFe(e,t,r)&&(t=void 0),n(e,HFe(t))}var JFe=XFe;const QFe=Ba(JFe);var Ru=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},M7=jX;function ZFe(e,t,r){t=="__proto__"&&M7?M7(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var e8e=ZFe,t8e=e8e,r8e=bX,n8e=Wu;function a8e(e,t){var r={};return t=n8e(t),r8e(e,function(n,a,i){t8e(r,a,t(n,a,i))}),r}var o8e=a8e;const i8e=Ba(o8e);function s8e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var l8e=s8e,c8e=eD;function d8e(e,t){var r=!0;return c8e(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var u8e=d8e,f8e=l8e,m8e=u8e,h8e=Wu,p8e=Bl,g8e=yC;function v8e(e,t,r){var n=p8e(e)?f8e:m8e;return r&&g8e(e,t,r)&&(t=void 0),n(e,h8e(t))}var x8e=v8e;const mQ=Ba(x8e);var y8e=["x","y"];function f1(e){"@babel/helpers - typeof";return f1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f1(e)}function y3(){return y3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y3.apply(this,arguments)}function R7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ey(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R7(Object(r),!0).forEach(function(n){b8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b8e(e,t,r){return t=w8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w8e(e){var t=j8e(e,"string");return f1(t)=="symbol"?t:t+""}function j8e(e,t){if(f1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(f1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function N8e(e,t){if(e==null)return{};var r=_8e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function S8e(e,t){var r=e.x,n=e.y,a=N8e(e,y8e),i="".concat(r),s=parseInt(i,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||a.height),u=parseInt(d,10),f="".concat(t.width||a.width),m=parseInt(f,10);return ey(ey(ey(ey(ey({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:u,width:m,name:t.name,radius:t.radius})}function L7(e){return xe.createElement(iQ,y3({shapeType:"rectangle",propTransformer:S8e,activeClassName:"recharts-active-bar"},e))}var C8e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=Vr(n)||rNe(n);return i?t(n,a):(i||mh(!1),r)}},P8e=["value","background"],hQ;function Px(e){"@babel/helpers - typeof";return Px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Px(e)}function A8e(e,t){if(e==null)return{};var r=E8e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function E8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function b_(){return b_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b_.apply(this,arguments)}function $7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ji(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$7(Object(r),!0).forEach(function(n){Im(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gQ(n.key),n)}}function O8e(e,t,r){return t&&F7(e.prototype,t),r&&F7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T8e(e,t,r){return t=w_(t),I8e(e,pQ()?Reflect.construct(t,r||[],w_(e).constructor):t.apply(e,r))}function I8e(e,t){if(t&&(Px(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D8e(e)}function D8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pQ=function(){return!!e})()}function w_(e){return w_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},w_(e)}function M8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b3(e,t)}function b3(e,t){return b3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},b3(e,t)}function Im(e,t,r){return t=gQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gQ(e){var t=R8e(e,"string");return Px(t)=="symbol"?t:t+""}function R8e(e,t){if(Px(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Px(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bg=function(e){function t(){var r;k8e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=T8e(this,t,[].concat(a)),Im(r,"state",{isAnimationFinished:!1}),Im(r,"id",gg("recharts-bar-")),Im(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),s&&s()}),Im(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),s&&s()}),r}return M8e(t,e),O8e(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,s=i.shape,l=i.dataKey,c=i.activeIndex,d=i.activeBar,u=On(this.props,!1);return n&&n.map(function(f,m){var h=m===c,v=h?d:s,g=ji(ji(ji({},u),f),{},{isActive:h,option:v,index:m,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return xe.createElement(Na,b_({className:"recharts-bar-rectangle"},Yp(a.props,f,m),{key:"rectangle-".concat(f?.x,"-").concat(f?.y,"-").concat(f?.value,"-").concat(m)}),xe.createElement(L7,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,s=a.layout,l=a.isAnimationActive,c=a.animationBegin,d=a.animationDuration,u=a.animationEasing,f=a.animationId,m=this.state.prevData;return xe.createElement(hh,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var v=h.t,g=i.map(function(x,y){var b=m&&m[y];if(b){var w=Vi(b.x,x.x),j=Vi(b.y,x.y),_=Vi(b.width,x.width),S=Vi(b.height,x.height);return ji(ji({},x),{},{x:w(v),y:j(v),width:_(v),height:S(v)})}if(s==="horizontal"){var k=Vi(0,x.height),E=k(v);return ji(ji({},x),{},{y:x.y+x.height-E,height:E})}var A=Vi(0,x.width),M=A(v);return ji(ji({},x),{},{width:M})});return xe.createElement(Na,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,s=this.state.prevData;return i&&a&&a.length&&(!s||!Jp(s,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,s=a.dataKey,l=a.activeIndex,c=On(this.props.background,!1);return i.map(function(d,u){d.value;var f=d.background,m=A8e(d,P8e);if(!f)return null;var h=ji(ji(ji(ji(ji({},m),{},{fill:"#eee"},f),c),Yp(n.props,d,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:s,index:u,className:"recharts-bar-background-rectangle"});return xe.createElement(L7,b_({key:"background-bar-".concat(u),option:n.props.background,isActive:u===l},h))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.data,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,f=vc(u,nw);if(!f)return null;var m=d==="vertical"?s[0].height/2:s[0].width/2,h=function(x,y){var b=Array.isArray(x.value)?x.value[1]:x.value;return{x:x.x,y:x.y,value:b,errorVal:pi(x,y)}},v={clipPath:n?"url(#clipPath-".concat(a,")"):null};return xe.createElement(Na,v,f.map(function(g){return xe.cloneElement(g,{key:"error-bar-".concat(a,"-").concat(g.props.dataKey),data:s,xAxis:l,yAxis:c,layout:d,offset:m,dataPointFormatter:h})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,s=n.className,l=n.xAxis,c=n.yAxis,d=n.left,u=n.top,f=n.width,m=n.height,h=n.isAnimationActive,v=n.background,g=n.id;if(a||!i||!i.length)return null;var x=this.state.isAnimationFinished,y=ta("recharts-bar",s),b=l&&l.allowDataOverflow,w=c&&c.allowDataOverflow,j=b||w,_=Xn(g)?this.id:g;return xe.createElement(Na,{className:y},b||w?xe.createElement("defs",null,xe.createElement("clipPath",{id:"clipPath-".concat(_)},xe.createElement("rect",{x:b?d:d-f/2,y:w?u:u-m/2,width:b?f:f*2,height:w?m:m*2}))):null,xe.createElement(Na,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(_,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,_),(!h||x)&&Mu.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(p.PureComponent);hQ=bg;Im(bg,"displayName","Bar");Im(bg,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Jd.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Im(bg,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,s=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,m=e.offset,h=vMe(n,r);if(!h)return null;var v=t.layout,g=r.type.defaultProps,x=g!==void 0?ji(ji({},g),r.props):r.props,y=x.dataKey,b=x.children,w=x.minPointSize,j=v==="horizontal"?s:i,_=d?j.scale.domain():null,S=_Me({numericAxis:j}),k=vc(b,Bb),E=f.map(function(A,M){var C,T,I,D,F,z;d?C=xMe(d[u+M],_):(C=pi(A,y),Array.isArray(C)||(C=[S,C]));var q=C8e(w,hQ.defaultProps.minPointSize)(C[1],M);if(v==="horizontal"){var $,K=[s.scale(C[0]),s.scale(C[1])],ce=K[0],fe=K[1];T=PB({axis:i,ticks:l,bandSize:a,offset:h.offset,entry:A,index:M}),I=($=fe??ce)!==null&&$!==void 0?$:void 0,D=h.size;var B=ce-fe;if(F=Number.isNaN(B)?0:B,z={x:T,y:s.y,width:D,height:s.height},Math.abs(q)>0&&Math.abs(F)<Math.abs(q)){var L=dl(F||q)*(Math.abs(q)-Math.abs(F));I-=L,F+=L}}else{var V=[i.scale(C[0]),i.scale(C[1])],re=V[0],me=V[1];if(T=re,I=PB({axis:s,ticks:c,bandSize:a,offset:h.offset,entry:A,index:M}),D=me-re,F=h.size,z={x:i.x,y:I,width:i.width,height:F},Math.abs(q)>0&&Math.abs(D)<Math.abs(q)){var G=dl(D||q)*(Math.abs(q)-Math.abs(D));D+=G}}return ji(ji(ji({},A),{},{x:T,y:I,width:D,height:F,value:d?C:C[1],payload:A,background:z},k&&k[M]&&k[M].props),{},{tooltipPayload:[$J(r,A)],tooltipPosition:{x:T+D/2,y:I+F/2}})});return ji({data:E,layout:v},m)});function m1(e){"@babel/helpers - typeof";return m1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m1(e)}function L8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vQ(n.key),n)}}function $8e(e,t,r){return t&&B7(e.prototype,t),r&&B7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $d(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q7(Object(r),!0).forEach(function(n){LC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LC(e,t,r){return t=vQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vQ(e){var t=F8e(e,"string");return m1(t)=="symbol"?t:t+""}function F8e(e,t){if(m1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(m1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kD=function(t,r,n,a,i){var s=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),f={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},m=!!ac(d,bg);return u.reduce(function(h,v){var g=r[v],x=g.orientation,y=g.domain,b=g.padding,w=b===void 0?{}:b,j=g.mirror,_=g.reversed,S="".concat(x).concat(j?"Mirror":""),k,E,A,M,C;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var T=y[1]-y[0],I=1/0,D=g.categoricalDomain.sort(oNe);if(D.forEach(function(V,re){re>0&&(I=Math.min((V||0)-(D[re-1]||0),I))}),Number.isFinite(I)){var F=I/T,z=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(k=F*z/2),g.padding==="no-gap"){var q=ul(t.barCategoryGap,F*z),$=F*z/2;k=$-q-($-q)/z*q}}}a==="xAxis"?E=[n.left+(w.left||0)+(k||0),n.left+n.width-(w.right||0)-(k||0)]:a==="yAxis"?E=c==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(k||0),n.top+n.height-(w.bottom||0)-(k||0)]:E=g.range,_&&(E=[E[1],E[0]]);var K=DJ(g,i,m),ce=K.scale,fe=K.realScaleType;ce.domain(y).range(E),MJ(ce);var B=RJ(ce,$d($d({},g),{},{realScaleType:fe}));a==="xAxis"?(C=x==="top"&&!j||x==="bottom"&&j,A=n.left,M=f[S]-C*g.height):a==="yAxis"&&(C=x==="left"&&!j||x==="right"&&j,A=f[S]-C*g.width,M=n.top);var L=$d($d($d({},g),B),{},{realScaleType:fe,x:A,y:M,scale:ce,width:a==="xAxis"?n.width:g.width,height:a==="yAxis"?n.height:g.height});return L.bandSize=a_(L,B),!g.hide&&a==="xAxis"?f[S]+=(C?-1:1)*L.height:g.hide||(f[S]+=(C?-1:1)*L.width),$d($d({},h),{},LC({},v,L))},{})},xQ=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return{x:Math.min(n,i),y:Math.min(a,s),width:Math.abs(i-n),height:Math.abs(s-a)}},B8e=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return xQ({x:r,y:n},{x:a,y:i})},yQ=function(){function e(t){L8e(this,e),this.scale=t}return $8e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();LC(yQ,"EPS",1e-4);var OD=function(t){var r=Object.keys(t).reduce(function(n,a){return $d($d({},n),{},LC({},a,yQ.create(t[a])))},{});return $d($d({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,l=i.position;return i8e(a,function(c,d){return r[d].apply(c,{bandAware:s,position:l})})},isInRange:function(a){return mQ(a,function(i,s){return r[s].isInRange(i)})}})};function q8e(e){return(e%180+180)%180}var z8e=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=q8e(a),s=i*Math.PI/180,l=Math.atan(n/r),c=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},U8e=Wu,V8e=Q1,W8e=vC;function H8e(e){return function(t,r,n){var a=Object(t);if(!V8e(t)){var i=U8e(r);t=W8e(t),r=function(l){return i(a[l],l,a)}}var s=e(t,r,n);return s>-1?a[i?t[s]:s]:void 0}}var G8e=H8e,K8e=cQ;function Y8e(e){var t=K8e(e),r=t%1;return t===t?r?t-r:t:0}var X8e=Y8e,J8e=hX,Q8e=Wu,Z8e=X8e,eBe=Math.max;function tBe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:Z8e(r);return a<0&&(a=eBe(n+a,0)),J8e(e,Q8e(t),a)}var rBe=tBe,nBe=G8e,aBe=rBe,oBe=nBe(aBe),iBe=oBe;const sBe=Ba(iBe);var lBe=ije(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),TD=p.createContext(void 0),ID=p.createContext(void 0),bQ=p.createContext(void 0),wQ=p.createContext({}),jQ=p.createContext(void 0),NQ=p.createContext(0),_Q=p.createContext(0),z7=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,s=t.clipPathId,l=t.children,c=t.width,d=t.height,u=lBe(i);return xe.createElement(TD.Provider,{value:n},xe.createElement(ID.Provider,{value:a},xe.createElement(wQ.Provider,{value:i},xe.createElement(bQ.Provider,{value:u},xe.createElement(jQ.Provider,{value:s},xe.createElement(NQ.Provider,{value:d},xe.createElement(_Q.Provider,{value:c},l)))))))},cBe=function(){return p.useContext(jQ)},SQ=function(t){var r=p.useContext(TD);r==null&&mh(!1);var n=r[t];return n==null&&mh(!1),n},dBe=function(){var t=p.useContext(TD);return _m(t)},uBe=function(){var t=p.useContext(ID),r=sBe(t,function(n){return mQ(n.domain,Number.isFinite)});return r||_m(t)},CQ=function(t){var r=p.useContext(ID);r==null&&mh(!1);var n=r[t];return n==null&&mh(!1),n},fBe=function(){var t=p.useContext(bQ);return t},mBe=function(){return p.useContext(wQ)},DD=function(){return p.useContext(_Q)},MD=function(){return p.useContext(NQ)};function Ax(e){"@babel/helpers - typeof";return Ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ax(e)}function hBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AQ(n.key),n)}}function pBe(e,t,r){return t&&U7(e.prototype,t),r&&U7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gBe(e,t,r){return t=j_(t),vBe(e,PQ()?Reflect.construct(t,r||[],j_(e).constructor):t.apply(e,r))}function vBe(e,t){if(t&&(Ax(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xBe(e)}function xBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(PQ=function(){return!!e})()}function j_(e){return j_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},j_(e)}function yBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w3(e,t)}function w3(e,t){return w3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},w3(e,t)}function V7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function W7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V7(Object(r),!0).forEach(function(n){RD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RD(e,t,r){return t=AQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AQ(e){var t=bBe(e,"string");return Ax(t)=="symbol"?t:t+""}function bBe(e,t){if(Ax(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ax(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wBe(e,t){return SBe(e)||_Be(e,t)||NBe(e,t)||jBe()}function jBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NBe(e,t){if(e){if(typeof e=="string")return H7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H7(e,t)}}function H7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Be(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function SBe(e){if(Array.isArray(e))return e}function j3(){return j3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},j3.apply(this,arguments)}var CBe=function(t,r){var n;return xe.isValidElement(t)?n=xe.cloneElement(t,r):Vn(t)?n=t(r):n=xe.createElement("line",j3({},r,{className:"recharts-reference-line-line"})),n},PBe=function(t,r,n,a,i,s,l,c,d){var u=i.x,f=i.y,m=i.width,h=i.height;if(n){var v=d.y,g=t.y.apply(v,{position:s});if(Ru(d,"discard")&&!t.y.isInRange(g))return null;var x=[{x:u+m,y:g},{x:u,y:g}];return c==="left"?x.reverse():x}if(r){var y=d.x,b=t.x.apply(y,{position:s});if(Ru(d,"discard")&&!t.x.isInRange(b))return null;var w=[{x:b,y:f+h},{x:b,y:f}];return l==="top"?w.reverse():w}if(a){var j=d.segment,_=j.map(function(S){return t.apply(S,{position:s})});return Ru(d,"discard")&&QFe(_,function(S){return!t.isInRange(S)})?null:_}return null};function ABe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,s=e.shape,l=e.className,c=e.alwaysShow,d=cBe(),u=SQ(a),f=CQ(i),m=fBe();if(!d||!m)return null;Xd(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=OD({x:u.scale,y:f.scale}),v=Gi(t),g=Gi(r),x=n&&n.length===2,y=PBe(h,v,g,x,m,e.position,u.orientation,f.orientation,e);if(!y)return null;var b=wBe(y,2),w=b[0],j=w.x,_=w.y,S=b[1],k=S.x,E=S.y,A=Ru(e,"hidden")?"url(#".concat(d,")"):void 0,M=W7(W7({clipPath:A},On(e,!0)),{},{x1:j,y1:_,x2:k,y2:E});return xe.createElement(Na,{className:ta("recharts-reference-line",l)},CBe(s,M),ns.renderCallByParent(e,B8e({x1:j,y1:_,x2:k,y2:E})))}var LD=function(e){function t(){return hBe(this,t),gBe(this,t,arguments)}return yBe(t,e),pBe(t,[{key:"render",value:function(){return xe.createElement(ABe,this.props)}}])}(xe.Component);RD(LD,"displayName","ReferenceLine");RD(LD,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function N3(){return N3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},N3.apply(this,arguments)}function Ex(e){"@babel/helpers - typeof";return Ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ex(e)}function G7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function K7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G7(Object(r),!0).forEach(function(n){$C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kQ(n.key),n)}}function kBe(e,t,r){return t&&Y7(e.prototype,t),r&&Y7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OBe(e,t,r){return t=N_(t),TBe(e,EQ()?Reflect.construct(t,r||[],N_(e).constructor):t.apply(e,r))}function TBe(e,t){if(t&&(Ex(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IBe(e)}function IBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EQ=function(){return!!e})()}function N_(e){return N_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},N_(e)}function DBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_3(e,t)}function _3(e,t){return _3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},_3(e,t)}function $C(e,t,r){return t=kQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kQ(e){var t=MBe(e,"string");return Ex(t)=="symbol"?t:t+""}function MBe(e,t){if(Ex(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ex(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RBe=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,s=OD({x:a.scale,y:i.scale}),l=s.apply({x:r,y:n},{bandAware:!0});return Ru(t,"discard")&&!s.isInRange(l)?null:l},FC=function(e){function t(){return EBe(this,t),OBe(this,t,arguments)}return DBe(t,e),kBe(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,s=n.r,l=n.alwaysShow,c=n.clipPathId,d=Gi(a),u=Gi(i);if(Xd(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var f=RBe(this.props);if(!f)return null;var m=f.x,h=f.y,v=this.props,g=v.shape,x=v.className,y=Ru(this.props,"hidden")?"url(#".concat(c,")"):void 0,b=K7(K7({clipPath:y},On(this.props,!0)),{},{cx:m,cy:h});return xe.createElement(Na,{className:ta("recharts-reference-dot",x)},t.renderDot(g,b),ns.renderCallByParent(this.props,{x:m-s,y:h-s,width:2*s,height:2*s}))}}])}(xe.Component);$C(FC,"displayName","ReferenceDot");$C(FC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});$C(FC,"renderDot",function(e,t){var r;return xe.isValidElement(e)?r=xe.cloneElement(e,t):Vn(e)?r=e(t):r=xe.createElement(aw,N3({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function S3(){return S3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S3.apply(this,arguments)}function kx(e){"@babel/helpers - typeof";return kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kx(e)}function X7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function J7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X7(Object(r),!0).forEach(function(n){BC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TQ(n.key),n)}}function $Be(e,t,r){return t&&Q7(e.prototype,t),r&&Q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FBe(e,t,r){return t=__(t),BBe(e,OQ()?Reflect.construct(t,r||[],__(e).constructor):t.apply(e,r))}function BBe(e,t){if(t&&(kx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qBe(e)}function qBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OQ=function(){return!!e})()}function __(e){return __=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},__(e)}function zBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C3(e,t)}function C3(e,t){return C3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},C3(e,t)}function BC(e,t,r){return t=TQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TQ(e){var t=UBe(e,"string");return kx(t)=="symbol"?t:t+""}function UBe(e,t){if(kx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VBe=function(t,r,n,a,i){var s=i.x1,l=i.x2,c=i.y1,d=i.y2,u=i.xAxis,f=i.yAxis;if(!u||!f)return null;var m=OD({x:u.scale,y:f.scale}),h={x:t?m.x.apply(s,{position:"start"}):m.x.rangeMin,y:n?m.y.apply(c,{position:"start"}):m.y.rangeMin},v={x:r?m.x.apply(l,{position:"end"}):m.x.rangeMax,y:a?m.y.apply(d,{position:"end"}):m.y.rangeMax};return Ru(i,"discard")&&(!m.isInRange(h)||!m.isInRange(v))?null:xQ(h,v)},qC=function(e){function t(){return LBe(this,t),FBe(this,t,arguments)}return zBe(t,e),$Be(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,s=n.y1,l=n.y2,c=n.className,d=n.alwaysShow,u=n.clipPathId;Xd(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Gi(a),m=Gi(i),h=Gi(s),v=Gi(l),g=this.props.shape;if(!f&&!m&&!h&&!v&&!g)return null;var x=VBe(f,m,h,v,this.props);if(!x&&!g)return null;var y=Ru(this.props,"hidden")?"url(#".concat(u,")"):void 0;return xe.createElement(Na,{className:ta("recharts-reference-area",c)},t.renderRect(g,J7(J7({clipPath:y},On(this.props,!0)),x)),ns.renderCallByParent(this.props,x))}}])}(xe.Component);BC(qC,"displayName","ReferenceArea");BC(qC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});BC(qC,"renderRect",function(e,t){var r;return xe.isValidElement(e)?r=xe.cloneElement(e,t):Vn(e)?r=e(t):r=xe.createElement(ED,S3({},t,{className:"recharts-reference-area-rect"})),r});function IQ(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)if(r===void 0||r(e[a])===!0)n.push(e[a]);else return;return n}function WBe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return z8e(n,r)}function HBe(e,t,r){var n=r==="width",a=e.x,i=e.y,s=e.width,l=e.height;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function S_(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function GBe(e,t){return IQ(e,t+1)}function KBe(e,t,r,n,a){for(var i=(n||[]).slice(),s=t.start,l=t.end,c=0,d=1,u=s,f=function(){var v=n?.[c];if(v===void 0)return{v:IQ(n,d)};var g=c,x,y=function(){return x===void 0&&(x=r(v,g)),x},b=v.coordinate,w=c===0||S_(e,b,y,u,l);w||(c=0,u=s,d+=1),w&&(u=b+e*(y()/2+a),c+=d)},m;d<=i.length;)if(m=f(),m)return m.v;return[]}function h1(e){"@babel/helpers - typeof";return h1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h1(e)}function Z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z7(Object(r),!0).forEach(function(n){YBe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YBe(e,t,r){return t=XBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XBe(e){var t=JBe(e,"string");return h1(t)=="symbol"?t:t+""}function JBe(e,t){if(h1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(h1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QBe(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,l=t.start,c=t.end,d=function(m){var h=i[m],v,g=function(){return v===void 0&&(v=r(h,m)),v};if(m===s-1){var x=e*(h.coordinate+e*g()/2-c);i[m]=h=$s($s({},h),{},{tickCoord:x>0?h.coordinate-x*e:h.coordinate})}else i[m]=h=$s($s({},h),{},{tickCoord:h.coordinate});var y=S_(e,h.tickCoord,g,l,c);y&&(c=h.tickCoord-e*(g()/2+a),i[m]=$s($s({},h),{},{isShow:!0}))},u=s-1;u>=0;u--)d(u);return i}function ZBe(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,c=t.start,d=t.end;if(i){var u=n[l-1],f=r(u,l-1),m=e*(u.coordinate+e*f/2-d);s[l-1]=u=$s($s({},u),{},{tickCoord:m>0?u.coordinate-m*e:u.coordinate});var h=S_(e,u.tickCoord,function(){return f},c,d);h&&(d=u.tickCoord-e*(f/2+a),s[l-1]=$s($s({},u),{},{isShow:!0}))}for(var v=i?l-1:l,g=function(b){var w=s[b],j,_=function(){return j===void 0&&(j=r(w,b)),j};if(b===0){var S=e*(w.coordinate-e*_()/2-c);s[b]=w=$s($s({},w),{},{tickCoord:S<0?w.coordinate-S*e:w.coordinate})}else s[b]=w=$s($s({},w),{},{tickCoord:w.coordinate});var k=S_(e,w.tickCoord,_,c,d);k&&(c=w.tickCoord+e*(_()/2+a),s[b]=$s($s({},w),{},{isShow:!0}))},x=0;x<v;x++)g(x);return s}function $D(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,s=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(Vr(c)||Jd.isSsr)return GBe(a,typeof c=="number"&&Vr(c)?c:0);var m=[],h=l==="top"||l==="bottom"?"width":"height",v=u&&h==="width"?qy(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(w,j){var _=Vn(d)?d(w.value,j):w.value;return h==="width"?WBe(qy(_,{fontSize:t,letterSpacing:r}),v,f):qy(_,{fontSize:t,letterSpacing:r})[h]},x=a.length>=2?dl(a[1].coordinate-a[0].coordinate):1,y=HBe(i,x,h);return c==="equidistantPreserveStart"?KBe(x,y,g,a,s):(c==="preserveStart"||c==="preserveStartEnd"?m=ZBe(x,y,g,a,s,c==="preserveStartEnd"):m=QBe(x,y,g,a,s),m.filter(function(b){return b.isShow}))}var e7e=["viewBox"],t7e=["viewBox"],r7e=["ticks"];function Ox(e){"@babel/helpers - typeof";return Ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ox(e)}function Cv(){return Cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cv.apply(this,arguments)}function eq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eq(Object(r),!0).forEach(function(n){FD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _A(e,t){if(e==null)return{};var r=n7e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function n7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function a7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MQ(n.key),n)}}function o7e(e,t,r){return t&&tq(e.prototype,t),r&&tq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i7e(e,t,r){return t=C_(t),s7e(e,DQ()?Reflect.construct(t,r||[],C_(e).constructor):t.apply(e,r))}function s7e(e,t){if(t&&(Ox(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l7e(e)}function l7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DQ=function(){return!!e})()}function C_(e){return C_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},C_(e)}function c7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P3(e,t)}function P3(e,t){return P3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},P3(e,t)}function FD(e,t,r){return t=MQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MQ(e){var t=d7e(e,"string");return Ox(t)=="symbol"?t:t+""}function d7e(e,t){if(Ox(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ox(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var p0=function(e){function t(r){var n;return a7e(this,t),n=i7e(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return c7e(t,e),o7e(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,s=_A(n,e7e),l=this.props,c=l.viewBox,d=_A(l,t7e);return!Bv(i,c)||!Bv(s,d)||!Bv(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,s=a.y,l=a.width,c=a.height,d=a.orientation,u=a.tickSize,f=a.mirror,m=a.tickMargin,h,v,g,x,y,b,w=f?-1:1,j=n.tickSize||u,_=Vr(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":h=v=n.coordinate,x=s+ +!f*c,g=x-w*j,b=g-w*m,y=_;break;case"left":g=x=n.coordinate,v=i+ +!f*l,h=v-w*j,y=h-w*m,b=_;break;case"right":g=x=n.coordinate,v=i+ +f*l,h=v+w*j,y=h+w*m,b=_;break;default:h=v=n.coordinate,x=s+ +f*c,g=x+w*j,b=g+w*m,y=_;break}return{line:{x1:h,y1:g,x2:v,y2:x},tick:{x:y,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s;switch(a){case"left":s=i?"start":"end";break;case"right":s=i?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s="end";switch(a){case"left":case"right":s="middle";break;case"top":s=i?"start":"end";break;default:s=i?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.orientation,d=n.mirror,u=n.axisLine,f=$i($i($i({},On(this.props,!1)),On(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var m=+(c==="top"&&!d||c==="bottom"&&d);f=$i($i({},f),{},{x1:a,y1:i+m*l,x2:a+s,y2:i+m*l})}else{var h=+(c==="left"&&!d||c==="right"&&d);f=$i($i({},f),{},{x1:a+h*s,y1:i,x2:a+h*s,y2:i+l})}return xe.createElement("line",Cv({},f,{className:ta("recharts-cartesian-axis-line",gc(u,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var s=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,f=l.tickFormatter,m=l.unit,h=$D($i($i({},this.props),{},{ticks:n}),a,i),v=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),x=On(this.props,!1),y=On(u,!1),b=$i($i({},x),{},{fill:"none"},On(c,!1)),w=h.map(function(j,_){var S=s.getTickLineCoord(j),k=S.line,E=S.tick,A=$i($i($i($i({textAnchor:v,verticalAnchor:g},x),{},{stroke:"none",fill:d},y),E),{},{index:_,payload:j,visibleTicksCount:h.length,tickFormatter:f});return xe.createElement(Na,Cv({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},Yp(s.props,j,_)),c&&xe.createElement("line",Cv({},b,k,{className:ta("recharts-cartesian-axis-tick-line",gc(c,"className"))})),u&&t.renderTickItem(u,A,"".concat(Vn(f)?f(j.value,_):j.value).concat(m||"")))});return xe.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,s=a.width,l=a.height,c=a.ticksGenerator,d=a.className,u=a.hide;if(u)return null;var f=this.props,m=f.ticks,h=_A(f,r7e),v=m;return Vn(c)&&(v=m&&m.length>0?c(this.props):c(h)),s<=0||l<=0||!v||!v.length?null:xe.createElement(Na,{className:ta("recharts-cartesian-axis",d),ref:function(x){n.layerReference=x}},i&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),ns.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var s,l=ta(a.className,"recharts-cartesian-axis-tick-value");return xe.isValidElement(n)?s=xe.cloneElement(n,$i($i({},a),{},{className:l})):Vn(n)?s=n($i($i({},a),{},{className:l})):s=xe.createElement(Xp,Cv({},a,{className:"recharts-cartesian-axis-tick-value"}),i),s}}])}(p.Component);FD(p0,"displayName","CartesianAxis");FD(p0,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var u7e=["x1","y1","x2","y2","key"],f7e=["offset"];function Zp(e){"@babel/helpers - typeof";return Zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zp(e)}function rq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rq(Object(r),!0).forEach(function(n){m7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m7e(e,t,r){return t=h7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h7e(e){var t=p7e(e,"string");return Zp(t)=="symbol"?t:t+""}function p7e(e,t){if(Zp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vp(){return vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vp.apply(this,arguments)}function nq(e,t){if(e==null)return{};var r=g7e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var v7e=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,s=t.width,l=t.height,c=t.ry;return xe.createElement("rect",{x:a,y:i,ry:c,width:s,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function RQ(e,t){var r;if(xe.isValidElement(e))r=xe.cloneElement(e,t);else if(Vn(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,s=t.y2,l=t.key,c=nq(t,u7e),d=On(c,!1);d.offset;var u=nq(d,f7e);r=xe.createElement("line",vp({},u,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:l}))}return r}function x7e(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(l,c){var d=Bs(Bs({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return RQ(a,d)});return xe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function y7e(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(l,c){var d=Bs(Bs({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return RQ(a,d)});return xe.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function b7e(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,s=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(m){return Math.round(m+a-a)}).sort(function(m,h){return m-h});a!==u[0]&&u.unshift(0);var f=u.map(function(m,h){var v=!u[h+1],g=v?a+s-m:u[h+1]-m;if(g<=0)return null;var x=h%t.length;return xe.createElement("rect",{key:"react-".concat(h),y:m,x:n,height:g,width:i,stroke:"none",fill:t[x],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return xe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function w7e(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,s=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var u=d.map(function(m){return Math.round(m+i-i)}).sort(function(m,h){return m-h});i!==u[0]&&u.unshift(0);var f=u.map(function(m,h){var v=!u[h+1],g=v?i+l-m:u[h+1]-m;if(g<=0)return null;var x=h%n.length;return xe.createElement("rect",{key:"react-".concat(h),x:m,y:s,width:g,height:c,stroke:"none",fill:n[x],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return xe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var j7e=function(t,r){var n=t.xAxis,a=t.width,i=t.height,s=t.offset;return IJ($D(Bs(Bs(Bs({},p0.defaultProps),n),{},{ticks:bf(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,r)},N7e=function(t,r){var n=t.yAxis,a=t.width,i=t.height,s=t.offset;return IJ($D(Bs(Bs(Bs({},p0.defaultProps),n),{},{ticks:bf(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,r)},qg={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function A3(e){var t,r,n,a,i,s,l=DD(),c=MD(),d=mBe(),u=Bs(Bs({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:qg.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:qg.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:qg.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:qg.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:qg.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:qg.verticalFill,x:Vr(e.x)?e.x:d.left,y:Vr(e.y)?e.y:d.top,width:Vr(e.width)?e.width:d.width,height:Vr(e.height)?e.height:d.height}),f=u.x,m=u.y,h=u.width,v=u.height,g=u.syncWithTicks,x=u.horizontalValues,y=u.verticalValues,b=dBe(),w=uBe();if(!Vr(h)||h<=0||!Vr(v)||v<=0||!Vr(f)||f!==+f||!Vr(m)||m!==+m)return null;var j=u.verticalCoordinatesGenerator||j7e,_=u.horizontalCoordinatesGenerator||N7e,S=u.horizontalPoints,k=u.verticalPoints;if((!S||!S.length)&&Vn(_)){var E=x&&x.length,A=_({yAxis:w?Bs(Bs({},w),{},{ticks:E?x:w.ticks}):void 0,width:l,height:c,offset:d},E?!0:g);Xd(Array.isArray(A),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Zp(A),"]")),Array.isArray(A)&&(S=A)}if((!k||!k.length)&&Vn(j)){var M=y&&y.length,C=j({xAxis:b?Bs(Bs({},b),{},{ticks:M?y:b.ticks}):void 0,width:l,height:c,offset:d},M?!0:g);Xd(Array.isArray(C),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Zp(C),"]")),Array.isArray(C)&&(k=C)}return xe.createElement("g",{className:"recharts-cartesian-grid"},xe.createElement(v7e,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),xe.createElement(x7e,vp({},u,{offset:d,horizontalPoints:S,xAxis:b,yAxis:w})),xe.createElement(y7e,vp({},u,{offset:d,verticalPoints:k,xAxis:b,yAxis:w})),xe.createElement(b7e,vp({},u,{horizontalPoints:S})),xe.createElement(w7e,vp({},u,{verticalPoints:k})))}A3.displayName="CartesianGrid";var _7e=["type","layout","connectNulls","ref"],S7e=["key"];function Tx(e){"@babel/helpers - typeof";return Tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tx(e)}function aq(e,t){if(e==null)return{};var r=C7e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function C7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Gy(){return Gy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gy.apply(this,arguments)}function oq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ql(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oq(Object(r),!0).forEach(function(n){Fd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zg(e){return k7e(e)||E7e(e)||A7e(e)||P7e()}function P7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A7e(e,t){if(e){if(typeof e=="string")return E3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E3(e,t)}}function E7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function k7e(e){if(Array.isArray(e))return E3(e)}function E3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Q(n.key),n)}}function T7e(e,t,r){return t&&iq(e.prototype,t),r&&iq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I7e(e,t,r){return t=P_(t),D7e(e,LQ()?Reflect.construct(t,r||[],P_(e).constructor):t.apply(e,r))}function D7e(e,t){if(t&&(Tx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M7e(e)}function M7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LQ=function(){return!!e})()}function P_(e){return P_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},P_(e)}function R7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k3(e,t)}function k3(e,t){return k3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},k3(e,t)}function Fd(e,t,r){return t=$Q(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Q(e){var t=L7e(e,"string");return Tx(t)=="symbol"?t:t+""}function L7e(e,t){if(Tx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ow=function(e){function t(){var r;O7e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=I7e(this,t,[].concat(a)),Fd(r,"state",{isAnimationFinished:!0,totalLength:0}),Fd(r,"generateSimpleStrokeDasharray",function(s,l){return"".concat(l,"px ").concat(s-l,"px")}),Fd(r,"getStrokeDasharray",function(s,l,c){var d=c.reduce(function(y,b){return y+b});if(!d)return r.generateSimpleStrokeDasharray(l,s);for(var u=Math.floor(s/d),f=s%d,m=l-s,h=[],v=0,g=0;v<c.length;g+=c[v],++v)if(g+c[v]>f){h=[].concat(zg(c.slice(0,v)),[f-g]);break}var x=h.length%2===0?[0,m]:[m];return[].concat(zg(t.repeat(c,u)),zg(h),x).map(function(y){return"".concat(y,"px")}).join(", ")}),Fd(r,"id",gg("recharts-line-")),Fd(r,"pathRef",function(s){r.mainCurve=s}),Fd(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Fd(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return R7e(t,e),T7e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.points,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,f=vc(u,nw);if(!f)return null;var m=function(g,x){return{x:g.x,y:g.y,value:g.value,errorVal:pi(g.payload,x)}},h={clipPath:n?"url(#clipPath-".concat(a,")"):null};return xe.createElement(Na,h,f.map(function(v){return xe.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:s,xAxis:l,yAxis:c,layout:d,dataPointFormatter:m})}))}},{key:"renderDots",value:function(n,a,i){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,u=l.dataKey,f=On(this.props,!1),m=On(c,!0),h=d.map(function(g,x){var y=Ql(Ql(Ql({key:"dot-".concat(x),r:3},f),m),{},{index:x,cx:g.x,cy:g.y,value:g.value,dataKey:u,payload:g.payload,points:d});return t.renderDotItem(c,y)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return xe.createElement(Na,Gy({className:"recharts-line-dots",key:"dots"},v),h)}},{key:"renderCurveStatically",value:function(n,a,i,s){var l=this.props,c=l.type,d=l.layout,u=l.connectNulls;l.ref;var f=aq(l,_7e),m=Ql(Ql(Ql({},On(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},s),{},{type:c,layout:d,connectNulls:u});return xe.createElement(Tp,Gy({},m,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,s=this.props,l=s.points,c=s.strokeDasharray,d=s.isAnimationActive,u=s.animationBegin,f=s.animationDuration,m=s.animationEasing,h=s.animationId,v=s.animateNewValues,g=s.width,x=s.height,y=this.state,b=y.prevPoints,w=y.totalLength;return xe.createElement(hh,{begin:u,duration:f,isActive:d,easing:m,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var _=j.t;if(b){var S=b.length/l.length,k=l.map(function(T,I){var D=Math.floor(I*S);if(b[D]){var F=b[D],z=Vi(F.x,T.x),q=Vi(F.y,T.y);return Ql(Ql({},T),{},{x:z(_),y:q(_)})}if(v){var $=Vi(g*2,T.x),K=Vi(x/2,T.y);return Ql(Ql({},T),{},{x:$(_),y:K(_)})}return Ql(Ql({},T),{},{x:T.x,y:T.y})});return i.renderCurveStatically(k,n,a)}var E=Vi(0,w),A=E(_),M;if(c){var C="".concat(c).split(/[,\s]+/gim).map(function(T){return parseFloat(T)});M=i.getStrokeDasharray(A,w,C)}else M=i.generateSimpleStrokeDasharray(w,A);return i.renderCurveStatically(l,n,a,{strokeDasharray:M})})}},{key:"renderCurve",value:function(n,a){var i=this.props,s=i.points,l=i.isAnimationActive,c=this.state,d=c.prevPoints,u=c.totalLength;return l&&s&&s.length&&(!d&&u>0||!Jp(d,s))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,s=a.dot,l=a.points,c=a.className,d=a.xAxis,u=a.yAxis,f=a.top,m=a.left,h=a.width,v=a.height,g=a.isAnimationActive,x=a.id;if(i||!l||!l.length)return null;var y=this.state.isAnimationFinished,b=l.length===1,w=ta("recharts-line",c),j=d&&d.allowDataOverflow,_=u&&u.allowDataOverflow,S=j||_,k=Xn(x)?this.id:x,E=(n=On(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},A=E.r,M=A===void 0?3:A,C=E.strokeWidth,T=C===void 0?2:C,I=SY(s)?s:{},D=I.clipDot,F=D===void 0?!0:D,z=M*2+T;return xe.createElement(Na,{className:w},j||_?xe.createElement("defs",null,xe.createElement("clipPath",{id:"clipPath-".concat(k)},xe.createElement("rect",{x:j?m:m-h/2,y:_?f:f-v/2,width:j?h:h*2,height:_?v:v*2})),!F&&xe.createElement("clipPath",{id:"clipPath-dots-".concat(k)},xe.createElement("rect",{x:m-z/2,y:f-z/2,width:h+z,height:v+z}))):null,!b&&this.renderCurve(S,k),this.renderErrorBar(S,k),(b||s)&&this.renderDots(S,F,k),(!g||y)&&Mu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(zg(n),[0]):n,s=[],l=0;l<a;++l)s=[].concat(zg(s),zg(i));return s}},{key:"renderDotItem",value:function(n,a){var i;if(xe.isValidElement(n))i=xe.cloneElement(n,a);else if(Vn(n))i=n(a);else{var s=a.key,l=aq(a,S7e),c=ta("recharts-line-dot",typeof n!="boolean"?n.className:"");i=xe.createElement(aw,Gy({key:s},l,{className:c}))}return i}}])}(p.PureComponent);Fd(ow,"displayName","Line");Fd(ow,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Jd.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Fd(ow,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,s=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,u=t.layout,f=c.map(function(m,h){var v=pi(m,s);return u==="horizontal"?{x:n_({axis:r,ticks:a,bandSize:l,entry:m,index:h}),y:Xn(v)?null:n.scale(v),value:v,payload:m}:{x:Xn(v)?null:r.scale(v),y:n_({axis:n,ticks:i,bandSize:l,entry:m,index:h}),value:v,payload:m}});return Ql({points:f,layout:u},d)});var $7e=["layout","type","stroke","connectNulls","isRange","ref"],F7e=["key"],FQ;function Ix(e){"@babel/helpers - typeof";return Ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ix(e)}function BQ(e,t){if(e==null)return{};var r=B7e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function B7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function xp(){return xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xp.apply(this,arguments)}function sq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sq(Object(r),!0).forEach(function(n){Pu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zQ(n.key),n)}}function z7e(e,t,r){return t&&lq(e.prototype,t),r&&lq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U7e(e,t,r){return t=A_(t),V7e(e,qQ()?Reflect.construct(t,r||[],A_(e).constructor):t.apply(e,r))}function V7e(e,t){if(t&&(Ix(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W7e(e)}function W7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qQ=function(){return!!e})()}function A_(e){return A_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},A_(e)}function H7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O3(e,t)}function O3(e,t){return O3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},O3(e,t)}function Pu(e,t,r){return t=zQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zQ(e){var t=G7e(e,"string");return Ix(t)=="symbol"?t:t+""}function G7e(e,t){if(Ix(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ix(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Eh=function(e){function t(){var r;q7e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=U7e(this,t,[].concat(a)),Pu(r,"state",{isAnimationFinished:!0}),Pu(r,"id",gg("recharts-area-")),Pu(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Vn(s)&&s()}),Pu(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Vn(s)&&s()}),r}return H7e(t,e),z7e(t,[{key:"renderDots",value:function(n,a,i){var s=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(s&&!l)return null;var c=this.props,d=c.dot,u=c.points,f=c.dataKey,m=On(this.props,!1),h=On(d,!0),v=u.map(function(x,y){var b=pm(pm(pm({key:"dot-".concat(y),r:3},m),h),{},{index:y,cx:x.x,cy:x.y,dataKey:f,value:x.value,payload:x.payload,points:u});return t.renderDotItem(d,b)}),g={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return xe.createElement(Na,xp({className:"recharts-area-dots"},g),v)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,s=a.points,l=a.strokeWidth,c=s[0].x,d=s[s.length-1].x,u=n*Math.abs(c-d),f=Tm(s.map(function(m){return m.y||0}));return Vr(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(Tm(i.map(function(m){return m.y||0})),f)),Vr(f)?xe.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(f+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,s=a.points,l=a.strokeWidth,c=s[0].y,d=s[s.length-1].y,u=n*Math.abs(c-d),f=Tm(s.map(function(m){return m.x||0}));return Vr(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(Tm(i.map(function(m){return m.x||0})),f)),Vr(f)?xe.createElement("rect",{x:0,y:c<d?c:c-u,width:f+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,s){var l=this.props,c=l.layout,d=l.type,u=l.stroke,f=l.connectNulls,m=l.isRange;l.ref;var h=BQ(l,$7e);return xe.createElement(Na,{clipPath:i?"url(#clipPath-".concat(s,")"):null},xe.createElement(Tp,xp({},On(h,!0),{points:n,connectNulls:f,type:d,baseLine:a,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&xe.createElement(Tp,xp({},On(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:n})),u!=="none"&&m&&xe.createElement(Tp,xp({},On(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,s=this.props,l=s.points,c=s.baseLine,d=s.isAnimationActive,u=s.animationBegin,f=s.animationDuration,m=s.animationEasing,h=s.animationId,v=this.state,g=v.prevPoints,x=v.prevBaseLine;return xe.createElement(hh,{begin:u,duration:f,isActive:d,easing:m,from:{t:0},to:{t:1},key:"area-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(y){var b=y.t;if(g){var w=g.length/l.length,j=l.map(function(E,A){var M=Math.floor(A*w);if(g[M]){var C=g[M],T=Vi(C.x,E.x),I=Vi(C.y,E.y);return pm(pm({},E),{},{x:T(b),y:I(b)})}return E}),_;if(Vr(c)&&typeof c=="number"){var S=Vi(x,c);_=S(b)}else if(Xn(c)||l0(c)){var k=Vi(x,0);_=k(b)}else _=c.map(function(E,A){var M=Math.floor(A*w);if(x[M]){var C=x[M],T=Vi(C.x,E.x),I=Vi(C.y,E.y);return pm(pm({},E),{},{x:T(b),y:I(b)})}return E});return i.renderAreaStatically(j,_,n,a)}return xe.createElement(Na,null,xe.createElement("defs",null,xe.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(b))),xe.createElement(Na,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(l,c,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,s=i.points,l=i.baseLine,c=i.isAnimationActive,d=this.state,u=d.prevPoints,f=d.prevBaseLine,m=d.totalLength;return c&&s&&s.length&&(!u&&m>0||!Jp(u,s)||!Jp(f,l))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(s,l,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,s=a.dot,l=a.points,c=a.className,d=a.top,u=a.left,f=a.xAxis,m=a.yAxis,h=a.width,v=a.height,g=a.isAnimationActive,x=a.id;if(i||!l||!l.length)return null;var y=this.state.isAnimationFinished,b=l.length===1,w=ta("recharts-area",c),j=f&&f.allowDataOverflow,_=m&&m.allowDataOverflow,S=j||_,k=Xn(x)?this.id:x,E=(n=On(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},A=E.r,M=A===void 0?3:A,C=E.strokeWidth,T=C===void 0?2:C,I=SY(s)?s:{},D=I.clipDot,F=D===void 0?!0:D,z=M*2+T;return xe.createElement(Na,{className:w},j||_?xe.createElement("defs",null,xe.createElement("clipPath",{id:"clipPath-".concat(k)},xe.createElement("rect",{x:j?u:u-h/2,y:_?d:d-v/2,width:j?h:h*2,height:_?v:v*2})),!F&&xe.createElement("clipPath",{id:"clipPath-dots-".concat(k)},xe.createElement("rect",{x:u-z/2,y:d-z/2,width:h+z,height:v+z}))):null,b?null:this.renderArea(S,k),(s||b)&&this.renderDots(S,F,k),(!g||y)&&Mu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(p.PureComponent);FQ=Eh;Pu(Eh,"displayName","Area");Pu(Eh,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Jd.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Pu(Eh,"getBaseValue",function(e,t,r,n){var a=e.layout,i=e.baseValue,s=t.props.baseValue,l=s??i;if(Vr(l)&&typeof l=="number")return l;var c=a==="horizontal"?n:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return l==="dataMin"?f:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});Pu(Eh,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,i=e.xAxisTicks,s=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,m=e.offset,h=t.layout,v=d&&d.length,g=FQ.getBaseValue(t,r,n,a),x=h==="horizontal",y=!1,b=f.map(function(j,_){var S;v?S=d[u+_]:(S=pi(j,c),Array.isArray(S)?y=!0:S=[g,S]);var k=S[1]==null||v&&pi(j,c)==null;return x?{x:n_({axis:n,ticks:i,bandSize:l,entry:j,index:_}),y:k?null:a.scale(S[1]),value:S,payload:j}:{x:k?null:n.scale(S[1]),y:n_({axis:a,ticks:s,bandSize:l,entry:j,index:_}),value:S,payload:j}}),w;return v||y?w=b.map(function(j){var _=Array.isArray(j.value)?j.value[0]:null;return x?{x:j.x,y:_!=null&&j.y!=null?a.scale(_):null}:{x:_!=null?n.scale(_):null,y:j.y}}):w=x?a.scale(g):n.scale(g),pm({points:b,baseLine:w,layout:h,isRange:y},m)});Pu(Eh,"renderDotItem",function(e,t){var r;if(xe.isValidElement(e))r=xe.cloneElement(e,t);else if(Vn(e))r=e(t);else{var n=ta("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=BQ(t,F7e);r=xe.createElement(aw,xp({},i,{key:a,className:n}))}return r});function Dx(e){"@babel/helpers - typeof";return Dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dx(e)}function K7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WQ(n.key),n)}}function Y7e(e,t,r){return t&&cq(e.prototype,t),r&&cq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X7e(e,t,r){return t=E_(t),J7e(e,UQ()?Reflect.construct(t,r||[],E_(e).constructor):t.apply(e,r))}function J7e(e,t){if(t&&(Dx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q7e(e)}function Q7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UQ=function(){return!!e})()}function E_(e){return E_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},E_(e)}function Z7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T3(e,t)}function T3(e,t){return T3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},T3(e,t)}function VQ(e,t,r){return t=WQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WQ(e){var t=eqe(e,"string");return Dx(t)=="symbol"?t:t+""}function eqe(e,t){if(Dx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I3(){return I3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I3.apply(this,arguments)}function tqe(e){var t=e.xAxisId,r=DD(),n=MD(),a=SQ(t);return a==null?null:p.createElement(p0,I3({},a,{className:ta("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(s){return bf(s,!0)}}))}var eg=function(e){function t(){return K7e(this,t),X7e(this,t,arguments)}return Z7e(t,e),Y7e(t,[{key:"render",value:function(){return p.createElement(tqe,this.props)}}])}(p.Component);VQ(eg,"displayName","XAxis");VQ(eg,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Mx(e){"@babel/helpers - typeof";return Mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mx(e)}function rqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KQ(n.key),n)}}function nqe(e,t,r){return t&&dq(e.prototype,t),r&&dq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aqe(e,t,r){return t=k_(t),oqe(e,HQ()?Reflect.construct(t,r||[],k_(e).constructor):t.apply(e,r))}function oqe(e,t){if(t&&(Mx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iqe(e)}function iqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HQ=function(){return!!e})()}function k_(e){return k_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},k_(e)}function sqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D3(e,t)}function D3(e,t){return D3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},D3(e,t)}function GQ(e,t,r){return t=KQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KQ(e){var t=lqe(e,"string");return Mx(t)=="symbol"?t:t+""}function lqe(e,t){if(Mx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M3(){return M3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M3.apply(this,arguments)}var cqe=function(t){var r=t.yAxisId,n=DD(),a=MD(),i=CQ(r);return i==null?null:p.createElement(p0,M3({},i,{className:ta("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return bf(l,!0)}}))},tg=function(e){function t(){return rqe(this,t),aqe(this,t,arguments)}return sqe(t,e),nqe(t,[{key:"render",value:function(){return p.createElement(cqe,this.props)}}])}(p.Component);GQ(tg,"displayName","YAxis");GQ(tg,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function uq(e){return mqe(e)||fqe(e)||uqe(e)||dqe()}function dqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uqe(e,t){if(e){if(typeof e=="string")return R3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R3(e,t)}}function fqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mqe(e){if(Array.isArray(e))return R3(e)}function R3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L3=function(t,r,n,a,i){var s=vc(t,LD),l=vc(t,FC),c=[].concat(uq(s),uq(l)),d=vc(t,qC),u="".concat(a,"Id"),f=a[0],m=r;if(c.length&&(m=c.reduce(function(g,x){if(x.props[u]===n&&Ru(x.props,"extendDomain")&&Vr(x.props[f])){var y=x.props[f];return[Math.min(g[0],y),Math.max(g[1],y)]}return g},m)),d.length){var h="".concat(f,"1"),v="".concat(f,"2");m=d.reduce(function(g,x){if(x.props[u]===n&&Ru(x.props,"extendDomain")&&Vr(x.props[h])&&Vr(x.props[v])){var y=x.props[h],b=x.props[v];return[Math.min(g[0],y,b),Math.max(g[1],y,b)]}return g},m)}return i&&i.length&&(m=i.reduce(function(g,x){return Vr(x)?[Math.min(g[0],x),Math.max(g[1],x)]:g},m)),m},YQ={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,f,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new a(u,f||c,m),v=r?r+d:d;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],h]:c._events[v].push(h):(c._events[v]=h,c._eventsCount++),c}function s(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,h=f.length,v=new Array(h);m<h;m++)v[m]=f[m].fn;return v},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,m,h,v){var g=r?r+d:d;if(!this._events[g])return!1;var x=this._events[g],y=arguments.length,b,w;if(x.fn){switch(x.once&&this.removeListener(d,x.fn,void 0,!0),y){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,f),!0;case 4:return x.fn.call(x.context,u,f,m),!0;case 5:return x.fn.call(x.context,u,f,m,h),!0;case 6:return x.fn.call(x.context,u,f,m,h,v),!0}for(w=1,b=new Array(y-1);w<y;w++)b[w-1]=arguments[w];x.fn.apply(x.context,b)}else{var j=x.length,_;for(w=0;w<j;w++)switch(x[w].once&&this.removeListener(d,x[w].fn,void 0,!0),y){case 1:x[w].fn.call(x[w].context);break;case 2:x[w].fn.call(x[w].context,u);break;case 3:x[w].fn.call(x[w].context,u,f);break;case 4:x[w].fn.call(x[w].context,u,f,m);break;default:if(!b)for(_=1,b=new Array(y-1);_<y;_++)b[_-1]=arguments[_];x[w].fn.apply(x[w].context,b)}}return!0},l.prototype.on=function(d,u,f){return i(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return i(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,m){var h=r?r+d:d;if(!this._events[h])return this;if(!u)return s(this,h),this;var v=this._events[h];if(v.fn)v.fn===u&&(!m||v.once)&&(!f||v.context===f)&&s(this,h);else{for(var g=0,x=[],y=v.length;g<y;g++)(v[g].fn!==u||m&&!v[g].once||f&&v[g].context!==f)&&x.push(v[g]);x.length?this._events[h]=x.length===1?x[0]:x:s(this,h)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(YQ);var hqe=YQ.exports;const pqe=Ba(hqe);var SA=new pqe,CA="recharts.syncMouseEvents";function p1(e){"@babel/helpers - typeof";return p1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p1(e)}function gqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XQ(n.key),n)}}function vqe(e,t,r){return t&&fq(e.prototype,t),r&&fq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PA(e,t,r){return t=XQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XQ(e){var t=xqe(e,"string");return p1(t)=="symbol"?t:t+""}function xqe(e,t){if(p1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(p1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yqe=function(){function e(){gqe(this,e),PA(this,"activeIndex",0),PA(this,"coordinateList",[]),PA(this,"layout","horizontal")}return vqe(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,s=r.container,l=s===void 0?null:s,c=r.layout,d=c===void 0?null:c,u=r.offset,f=u===void 0?null:u,m=r.mouseHandlerCallback,h=m===void 0?null:m;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=d??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=h??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,s=a.y,l=a.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=i+c+d,m=s+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:f,pageY:m})}}}])}();function bqe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e?.[0],a=e?.[1];if(n&&a&&Vr(n)&&Vr(a))return!0}return!1}function wqe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function JQ(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,s=_o(t,r,n,a),l=_o(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function jqe(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,f=t.angle,m=_o(l,c,d,f),h=_o(l,c,u,f);n=m.x,a=m.y,i=h.x,s=h.y}else return JQ(t);return[{x:n,y:a},{x:i,y:s}]}function g1(e){"@babel/helpers - typeof";return g1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g1(e)}function mq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function M2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mq(Object(r),!0).forEach(function(n){Nqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nqe(e,t,r){return t=_qe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _qe(e){var t=Sqe(e,"string");return g1(t)=="symbol"?t:t+""}function Sqe(e,t){if(g1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(g1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cqe(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,s=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,u=e.tooltipAxisBandSize,f=e.layout,m=e.chartName,h=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!h||!i||!s||m!=="ScatterChart"&&a!=="axis")return null;var v,g=Tp;if(m==="ScatterChart")v=s,g=B6e;else if(m==="BarChart")v=wqe(f,s,c,u),g=ED;else if(f==="radial"){var x=JQ(s),y=x.cx,b=x.cy,w=x.radius,j=x.startAngle,_=x.endAngle;v={cx:y,cy:b,startAngle:j,endAngle:_,innerRadius:w,outerRadius:w},g=AD}else v={points:jqe(f,s,c)},g=Tp;var S=M2(M2(M2(M2({stroke:"#ccc",pointerEvents:"none"},c),v),On(h,!1)),{},{payload:l,payloadIndex:d,className:ta("recharts-tooltip-cursor",h.className)});return p.isValidElement(h)?p.cloneElement(h,S):p.createElement(g,S)}var Pqe=["item"],Aqe=["children","className","width","height","style","compact","title","desc"];function Rx(e){"@babel/helpers - typeof";return Rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rx(e)}function Pv(){return Pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pv.apply(this,arguments)}function hq(e,t){return Oqe(e)||kqe(e,t)||ZQ(e,t)||Eqe()}function Eqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function Oqe(e){if(Array.isArray(e))return e}function pq(e,t){if(e==null)return{};var r=Tqe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Tqe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Iqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eZ(n.key),n)}}function Dqe(e,t,r){return t&&gq(e.prototype,t),r&&gq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mqe(e,t,r){return t=O_(t),Rqe(e,QQ()?Reflect.construct(t,r||[],O_(e).constructor):t.apply(e,r))}function Rqe(e,t){if(t&&(Rx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lqe(e)}function Lqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QQ=function(){return!!e})()}function O_(e){return O_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},O_(e)}function $qe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$3(e,t)}function $3(e,t){return $3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$3(e,t)}function Lx(e){return qqe(e)||Bqe(e)||ZQ(e)||Fqe()}function Fqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZQ(e,t){if(e){if(typeof e=="string")return F3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F3(e,t)}}function Bqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qqe(e){if(Array.isArray(e))return F3(e)}function F3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vq(Object(r),!0).forEach(function(n){zn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zn(e,t,r){return t=eZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eZ(e){var t=zqe(e,"string");return Rx(t)=="symbol"?t:t+""}function zqe(e,t){if(Rx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uqe={xAxis:["bottom","top"],yAxis:["left","right"]},Vqe={width:"100%",height:"100%"},tZ={x:0,y:0};function R2(e){return e}var Wqe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},Hqe=function(t,r,n,a){var i=r.find(function(u){return u&&u.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var s=i.coordinate,l=a.radius;return mr(mr(mr({},a),_o(a.cx,a.cy,l,s)),{},{angle:s,radius:l})}var c=i.coordinate,d=a.angle;return mr(mr(mr({},a),_o(a.cx,a.cy,c,d)),{},{angle:d,radius:c})}return tZ},zC=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,s=(n??[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(Lx(l),Lx(d)):l},[]);return s.length>0?s:t&&t.length&&Vr(a)&&Vr(i)?t.slice(a,i+1):[]};function rZ(e){return e==="number"?[0,"auto"]:void 0}var B3=function(t,r,n,a){var i=t.graphicalItems,s=t.tooltipAxis,l=zC(r,t);return n<0||!i||!i.length||n>=l.length?null:i.reduce(function(c,d){var u,f=(u=d.props.data)!==null&&u!==void 0?u:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var m;if(s.dataKey&&!s.allowDuplicatedCategory){var h=f===void 0?l:f;m=EN(h,s.dataKey,a)}else m=f&&f[n]||l[n];return m?[].concat(Lx(c),[$J(d,m)]):c},[])},xq=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},s=Wqe(i,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=uMe(s,l,d,c);if(u>=0&&d){var f=d[u]&&d[u].value,m=B3(t,r,u,f),h=Hqe(n,l,u,i);return{activeTooltipIndex:u,activeLabel:f,activePayload:m,activeCoordinate:h}}return null},Gqe=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,s=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,m=t.stackOffset,h=TJ(u,i);return n.reduce(function(v,g){var x,y=g.type.defaultProps!==void 0?mr(mr({},g.type.defaultProps),g.props):g.props,b=y.type,w=y.dataKey,j=y.allowDataOverflow,_=y.allowDuplicatedCategory,S=y.scale,k=y.ticks,E=y.includeHidden,A=y[s];if(v[A])return v;var M=zC(t.data,{graphicalItems:a.filter(function(B){var L,V=s in B.props?B.props[s]:(L=B.type.defaultProps)===null||L===void 0?void 0:L[s];return V===A}),dataStartIndex:c,dataEndIndex:d}),C=M.length,T,I,D;bqe(y.domain,j,b)&&(T=QO(y.domain,null,j),h&&(b==="number"||S!=="auto")&&(D=Uy(M,w,"category")));var F=rZ(b);if(!T||T.length===0){var z,q=(z=y.domain)!==null&&z!==void 0?z:F;if(w){if(T=Uy(M,w,b),b==="category"&&h){var $=aNe(T);_&&$?(I=T,T=v_(0,C)):_||(T=kB(q,T,g).reduce(function(B,L){return B.indexOf(L)>=0?B:[].concat(Lx(B),[L])},[]))}else if(b==="category")_?T=T.filter(function(B){return B!==""&&!Xn(B)}):T=kB(q,T,g).reduce(function(B,L){return B.indexOf(L)>=0||L===""||Xn(L)?B:[].concat(Lx(B),[L])},[]);else if(b==="number"){var K=gMe(M,a.filter(function(B){var L,V,re=s in B.props?B.props[s]:(L=B.type.defaultProps)===null||L===void 0?void 0:L[s],me="hide"in B.props?B.props.hide:(V=B.type.defaultProps)===null||V===void 0?void 0:V.hide;return re===A&&(E||!me)}),w,i,u);K&&(T=K)}h&&(b==="number"||S!=="auto")&&(D=Uy(M,w,"category"))}else h?T=v_(0,C):l&&l[A]&&l[A].hasStack&&b==="number"?T=m==="expand"?[0,1]:LJ(l[A].stackGroups,c,d):T=OJ(M,a.filter(function(B){var L=s in B.props?B.props[s]:B.type.defaultProps[s],V="hide"in B.props?B.props.hide:B.type.defaultProps.hide;return L===A&&(E||!V)}),b,u,!0);if(b==="number")T=L3(f,T,A,i,k),q&&(T=QO(q,T,j));else if(b==="category"&&q){var ce=q,fe=T.every(function(B){return ce.indexOf(B)>=0});fe&&(T=ce)}}return mr(mr({},v),{},zn({},A,mr(mr({},y),{},{axisType:i,domain:T,categoricalDomain:D,duplicateDomain:I,originalDomain:(x=y.domain)!==null&&x!==void 0?x:F,isCategorical:h,layout:u})))},{})},Kqe=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,s=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,m=zC(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),h=m.length,v=TJ(u,i),g=-1;return n.reduce(function(x,y){var b=y.type.defaultProps!==void 0?mr(mr({},y.type.defaultProps),y.props):y.props,w=b[s],j=rZ("number");if(!x[w]){g++;var _;return v?_=v_(0,h):l&&l[w]&&l[w].hasStack?(_=LJ(l[w].stackGroups,c,d),_=L3(f,_,w,i)):(_=QO(j,OJ(m,n.filter(function(S){var k,E,A=s in S.props?S.props[s]:(k=S.type.defaultProps)===null||k===void 0?void 0:k[s],M="hide"in S.props?S.props.hide:(E=S.type.defaultProps)===null||E===void 0?void 0:E.hide;return A===w&&!M}),"number",u),a.defaultProps.allowDataOverflow),_=L3(f,_,w,i)),mr(mr({},x),{},zn({},w,mr(mr({axisType:i},a.defaultProps),{},{hide:!0,orientation:gc(Uqe,"".concat(i,".").concat(g%2),null),domain:_,originalDomain:j,isCategorical:v,layout:u})))}return x},{})},Yqe=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,s=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,f="".concat(a,"Id"),m=vc(u,i),h={};return m&&m.length?h=Gqe(t,{axes:m,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):s&&s.length&&(h=Kqe(t,{Axis:i,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),h},Xqe=function(t){var r=_m(t),n=bf(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:tD(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:a_(r,n)}},yq=function(t){var r=t.children,n=t.defaultShowTooltip,a=ac(r,Cx),i=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(s=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},Jqe=function(t){return!t||!t.length?!1:t.some(function(r){var n=Sf(r&&r.type);return n&&n.indexOf("Bar")>=0})},bq=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Qqe=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,s=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,d=n.width,u=n.height,f=n.children,m=n.margin||{},h=ac(f,Cx),v=ac(f,Ep),g=Object.keys(c).reduce(function(_,S){var k=c[S],E=k.orientation;return!k.mirror&&!k.hide?mr(mr({},_),{},zn({},E,_[E]+k.width)):_},{left:m.left||0,right:m.right||0}),x=Object.keys(s).reduce(function(_,S){var k=s[S],E=k.orientation;return!k.mirror&&!k.hide?mr(mr({},_),{},zn({},E,gc(_,"".concat(E))+k.height)):_},{top:m.top||0,bottom:m.bottom||0}),y=mr(mr({},x),g),b=y.bottom;h&&(y.bottom+=h.props.height||Cx.defaultProps.height),v&&r&&(y=hMe(y,a,n,r));var w=d-y.left-y.right,j=u-y.top-y.bottom;return mr(mr({brushBottom:b},y),{},{width:Math.max(w,0),height:Math.max(j,0)})},Zqe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},UC=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,s=t.validateTooltipEventTypes,l=s===void 0?["axis"]:s,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,f=t.defaultProps,m=function(y,b){var w=b.graphicalItems,j=b.stackGroups,_=b.offset,S=b.updateId,k=b.dataStartIndex,E=b.dataEndIndex,A=y.barSize,M=y.layout,C=y.barGap,T=y.barCategoryGap,I=y.maxBarSize,D=bq(M),F=D.numericAxisName,z=D.cateAxisName,q=Jqe(w),$=[];return w.forEach(function(K,ce){var fe=zC(y.data,{graphicalItems:[K],dataStartIndex:k,dataEndIndex:E}),B=K.type.defaultProps!==void 0?mr(mr({},K.type.defaultProps),K.props):K.props,L=B.dataKey,V=B.maxBarSize,re=B["".concat(F,"Id")],me=B["".concat(z,"Id")],G={},Q=c.reduce(function(vt,Sr){var se=b["".concat(Sr.axisType,"Map")],Ze=B["".concat(Sr.axisType,"Id")];se&&se[Ze]||Sr.axisType==="zAxis"||mh(!1);var ct=se[Ze];return mr(mr({},vt),{},zn(zn({},Sr.axisType,ct),"".concat(Sr.axisType,"Ticks"),bf(ct)))},G),ae=Q[z],J=Q["".concat(z,"Ticks")],je=j&&j[re]&&j[re].hasStack&&SMe(K,j[re].stackGroups),be=Sf(K.type).indexOf("Bar")>=0,Ue=a_(ae,J),Z=[],Y=q&&fMe({barSize:A,stackGroups:j,totalSize:Zqe(Q,z)});if(be){var lt,gt,Te=Xn(V)?I:V,at=(lt=(gt=a_(ae,J,!0))!==null&&gt!==void 0?gt:Te)!==null&&lt!==void 0?lt:0;Z=mMe({barGap:C,barCategoryGap:T,bandSize:at!==Ue?at:Ue,sizeList:Y[me],maxBarSize:Te}),at!==Ue&&(Z=Z.map(function(vt){return mr(mr({},vt),{},{position:mr(mr({},vt.position),{},{offset:vt.position.offset-at/2})})}))}var yt=K&&K.type&&K.type.getComposedData;yt&&$.push({props:mr(mr({},yt(mr(mr({},Q),{},{displayedData:fe,props:y,dataKey:L,item:K,bandSize:Ue,barPosition:Z,offset:_,stackedData:je,layout:M,dataStartIndex:k,dataEndIndex:E}))),{},zn(zn(zn({key:K.key||"item-".concat(ce)},F,Q[F]),z,Q[z]),"animationId",S)),childIndex:gNe(K,y.children),item:K})}),$},h=function(y,b){var w=y.props,j=y.dataStartIndex,_=y.dataEndIndex,S=y.updateId;if(!bF({props:w}))return null;var k=w.children,E=w.layout,A=w.stackOffset,M=w.data,C=w.reverseStackOrder,T=bq(E),I=T.numericAxisName,D=T.cateAxisName,F=vc(k,n),z=NMe(M,F,"".concat(I,"Id"),"".concat(D,"Id"),A,C),q=c.reduce(function(B,L){var V="".concat(L.axisType,"Map");return mr(mr({},B),{},zn({},V,Yqe(w,mr(mr({},L),{},{graphicalItems:F,stackGroups:L.axisType===I&&z,dataStartIndex:j,dataEndIndex:_}))))},{}),$=Qqe(mr(mr({},q),{},{props:w,graphicalItems:F}),b?.legendBBox);Object.keys(q).forEach(function(B){q[B]=u(w,q[B],$,B.replace("Map",""),r)});var K=q["".concat(D,"Map")],ce=Xqe(K),fe=m(w,mr(mr({},q),{},{dataStartIndex:j,dataEndIndex:_,updateId:S,graphicalItems:F,stackGroups:z,offset:$}));return mr(mr({formattedGraphicalItems:fe,graphicalItems:F,offset:$,stackGroups:z},ce),q)},v=function(x){function y(b){var w,j,_;return Iqe(this,y),_=Mqe(this,y,[b]),zn(_,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),zn(_,"accessibilityManager",new yqe),zn(_,"handleLegendBBoxUpdate",function(S){if(S){var k=_.state,E=k.dataStartIndex,A=k.dataEndIndex,M=k.updateId;_.setState(mr({legendBBox:S},h({props:_.props,dataStartIndex:E,dataEndIndex:A,updateId:M},mr(mr({},_.state),{},{legendBBox:S}))))}}),zn(_,"handleReceiveSyncEvent",function(S,k,E){if(_.props.syncId===S){if(E===_.eventEmitterSymbol&&typeof _.props.syncMethod!="function")return;_.applySyncEvent(k)}}),zn(_,"handleBrushChange",function(S){var k=S.startIndex,E=S.endIndex;if(k!==_.state.dataStartIndex||E!==_.state.dataEndIndex){var A=_.state.updateId;_.setState(function(){return mr({dataStartIndex:k,dataEndIndex:E},h({props:_.props,dataStartIndex:k,dataEndIndex:E,updateId:A},_.state))}),_.triggerSyncEvent({dataStartIndex:k,dataEndIndex:E})}}),zn(_,"handleMouseEnter",function(S){var k=_.getMouseInfo(S);if(k){var E=mr(mr({},k),{},{isTooltipActive:!0});_.setState(E),_.triggerSyncEvent(E);var A=_.props.onMouseEnter;Vn(A)&&A(E,S)}}),zn(_,"triggeredAfterMouseMove",function(S){var k=_.getMouseInfo(S),E=k?mr(mr({},k),{},{isTooltipActive:!0}):{isTooltipActive:!1};_.setState(E),_.triggerSyncEvent(E);var A=_.props.onMouseMove;Vn(A)&&A(E,S)}),zn(_,"handleItemMouseEnter",function(S){_.setState(function(){return{isTooltipActive:!0,activeItem:S,activePayload:S.tooltipPayload,activeCoordinate:S.tooltipPosition||{x:S.cx,y:S.cy}}})}),zn(_,"handleItemMouseLeave",function(){_.setState(function(){return{isTooltipActive:!1}})}),zn(_,"handleMouseMove",function(S){S.persist(),_.throttleTriggeredAfterMouseMove(S)}),zn(_,"handleMouseLeave",function(S){_.throttleTriggeredAfterMouseMove.cancel();var k={isTooltipActive:!1};_.setState(k),_.triggerSyncEvent(k);var E=_.props.onMouseLeave;Vn(E)&&E(k,S)}),zn(_,"handleOuterEvent",function(S){var k=pNe(S),E=gc(_.props,"".concat(k));if(k&&Vn(E)){var A,M;/.*touch.*/i.test(k)?M=_.getMouseInfo(S.changedTouches[0]):M=_.getMouseInfo(S),E((A=M)!==null&&A!==void 0?A:{},S)}}),zn(_,"handleClick",function(S){var k=_.getMouseInfo(S);if(k){var E=mr(mr({},k),{},{isTooltipActive:!0});_.setState(E),_.triggerSyncEvent(E);var A=_.props.onClick;Vn(A)&&A(E,S)}}),zn(_,"handleMouseDown",function(S){var k=_.props.onMouseDown;if(Vn(k)){var E=_.getMouseInfo(S);k(E,S)}}),zn(_,"handleMouseUp",function(S){var k=_.props.onMouseUp;if(Vn(k)){var E=_.getMouseInfo(S);k(E,S)}}),zn(_,"handleTouchMove",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&_.throttleTriggeredAfterMouseMove(S.changedTouches[0])}),zn(_,"handleTouchStart",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&_.handleMouseDown(S.changedTouches[0])}),zn(_,"handleTouchEnd",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&_.handleMouseUp(S.changedTouches[0])}),zn(_,"handleDoubleClick",function(S){var k=_.props.onDoubleClick;if(Vn(k)){var E=_.getMouseInfo(S);k(E,S)}}),zn(_,"handleContextMenu",function(S){var k=_.props.onContextMenu;if(Vn(k)){var E=_.getMouseInfo(S);k(E,S)}}),zn(_,"triggerSyncEvent",function(S){_.props.syncId!==void 0&&SA.emit(CA,_.props.syncId,S,_.eventEmitterSymbol)}),zn(_,"applySyncEvent",function(S){var k=_.props,E=k.layout,A=k.syncMethod,M=_.state.updateId,C=S.dataStartIndex,T=S.dataEndIndex;if(S.dataStartIndex!==void 0||S.dataEndIndex!==void 0)_.setState(mr({dataStartIndex:C,dataEndIndex:T},h({props:_.props,dataStartIndex:C,dataEndIndex:T,updateId:M},_.state)));else if(S.activeTooltipIndex!==void 0){var I=S.chartX,D=S.chartY,F=S.activeTooltipIndex,z=_.state,q=z.offset,$=z.tooltipTicks;if(!q)return;if(typeof A=="function")F=A($,S);else if(A==="value"){F=-1;for(var K=0;K<$.length;K++)if($[K].value===S.activeLabel){F=K;break}}var ce=mr(mr({},q),{},{x:q.left,y:q.top}),fe=Math.min(I,ce.x+ce.width),B=Math.min(D,ce.y+ce.height),L=$[F]&&$[F].value,V=B3(_.state,_.props.data,F),re=$[F]?{x:E==="horizontal"?$[F].coordinate:fe,y:E==="horizontal"?B:$[F].coordinate}:tZ;_.setState(mr(mr({},S),{},{activeLabel:L,activeCoordinate:re,activePayload:V,activeTooltipIndex:F}))}else _.setState(S)}),zn(_,"renderCursor",function(S){var k,E=_.state,A=E.isTooltipActive,M=E.activeCoordinate,C=E.activePayload,T=E.offset,I=E.activeTooltipIndex,D=E.tooltipAxisBandSize,F=_.getTooltipEventType(),z=(k=S.props.active)!==null&&k!==void 0?k:A,q=_.props.layout,$=S.key||"_recharts-cursor";return xe.createElement(Cqe,{key:$,activeCoordinate:M,activePayload:C,activeTooltipIndex:I,chartName:r,element:S,isActive:z,layout:q,offset:T,tooltipAxisBandSize:D,tooltipEventType:F})}),zn(_,"renderPolarAxis",function(S,k,E){var A=gc(S,"type.axisType"),M=gc(_.state,"".concat(A,"Map")),C=S.type.defaultProps,T=C!==void 0?mr(mr({},C),S.props):S.props,I=M&&M[T["".concat(A,"Id")]];return p.cloneElement(S,mr(mr({},I),{},{className:ta(A,I.className),key:S.key||"".concat(k,"-").concat(E),ticks:bf(I,!0)}))}),zn(_,"renderPolarGrid",function(S){var k=S.props,E=k.radialLines,A=k.polarAngles,M=k.polarRadius,C=_.state,T=C.radiusAxisMap,I=C.angleAxisMap,D=_m(T),F=_m(I),z=F.cx,q=F.cy,$=F.innerRadius,K=F.outerRadius;return p.cloneElement(S,{polarAngles:Array.isArray(A)?A:bf(F,!0).map(function(ce){return ce.coordinate}),polarRadius:Array.isArray(M)?M:bf(D,!0).map(function(ce){return ce.coordinate}),cx:z,cy:q,innerRadius:$,outerRadius:K,key:S.key||"polar-grid",radialLines:E})}),zn(_,"renderLegend",function(){var S=_.state.formattedGraphicalItems,k=_.props,E=k.children,A=k.width,M=k.height,C=_.props.margin||{},T=A-(C.left||0)-(C.right||0),I=EJ({children:E,formattedGraphicalItems:S,legendWidth:T,legendContent:d});if(!I)return null;var D=I.item,F=pq(I,Pqe);return p.cloneElement(D,mr(mr({},F),{},{chartWidth:A,chartHeight:M,margin:C,onBBoxUpdate:_.handleLegendBBoxUpdate}))}),zn(_,"renderTooltip",function(){var S,k=_.props,E=k.children,A=k.accessibilityLayer,M=ac(E,oc);if(!M)return null;var C=_.state,T=C.isTooltipActive,I=C.activeCoordinate,D=C.activePayload,F=C.activeLabel,z=C.offset,q=(S=M.props.active)!==null&&S!==void 0?S:T;return p.cloneElement(M,{viewBox:mr(mr({},z),{},{x:z.left,y:z.top}),active:q,label:F,payload:q?D:[],coordinate:I,accessibilityLayer:A})}),zn(_,"renderBrush",function(S){var k=_.props,E=k.margin,A=k.data,M=_.state,C=M.offset,T=M.dataStartIndex,I=M.dataEndIndex,D=M.updateId;return p.cloneElement(S,{key:S.key||"_recharts-brush",onChange:O2(_.handleBrushChange,S.props.onChange),data:A,x:Vr(S.props.x)?S.props.x:C.left,y:Vr(S.props.y)?S.props.y:C.top+C.height+C.brushBottom-(E.bottom||0),width:Vr(S.props.width)?S.props.width:C.width,startIndex:T,endIndex:I,updateId:"brush-".concat(D)})}),zn(_,"renderReferenceElement",function(S,k,E){if(!S)return null;var A=_,M=A.clipPathId,C=_.state,T=C.xAxisMap,I=C.yAxisMap,D=C.offset,F=S.type.defaultProps||{},z=S.props,q=z.xAxisId,$=q===void 0?F.xAxisId:q,K=z.yAxisId,ce=K===void 0?F.yAxisId:K;return p.cloneElement(S,{key:S.key||"".concat(k,"-").concat(E),xAxis:T[$],yAxis:I[ce],viewBox:{x:D.left,y:D.top,width:D.width,height:D.height},clipPathId:M})}),zn(_,"renderActivePoints",function(S){var k=S.item,E=S.activePoint,A=S.basePoint,M=S.childIndex,C=S.isRange,T=[],I=k.props.key,D=k.item.type.defaultProps!==void 0?mr(mr({},k.item.type.defaultProps),k.item.props):k.item.props,F=D.activeDot,z=D.dataKey,q=mr(mr({index:M,dataKey:z,cx:E.x,cy:E.y,r:4,fill:PD(k.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},On(F,!1)),kN(F));return T.push(y.renderActiveDot(F,q,"".concat(I,"-activePoint-").concat(M))),A?T.push(y.renderActiveDot(F,mr(mr({},q),{},{cx:A.x,cy:A.y}),"".concat(I,"-basePoint-").concat(M))):C&&T.push(null),T}),zn(_,"renderGraphicChild",function(S,k,E){var A=_.filterFormatItem(S,k,E);if(!A)return null;var M=_.getTooltipEventType(),C=_.state,T=C.isTooltipActive,I=C.tooltipAxis,D=C.activeTooltipIndex,F=C.activeLabel,z=_.props.children,q=ac(z,oc),$=A.props,K=$.points,ce=$.isRange,fe=$.baseLine,B=A.item.type.defaultProps!==void 0?mr(mr({},A.item.type.defaultProps),A.item.props):A.item.props,L=B.activeDot,V=B.hide,re=B.activeBar,me=B.activeShape,G=!!(!V&&T&&q&&(L||re||me)),Q={};M!=="axis"&&q&&q.props.trigger==="click"?Q={onClick:O2(_.handleItemMouseEnter,S.props.onClick)}:M!=="axis"&&(Q={onMouseLeave:O2(_.handleItemMouseLeave,S.props.onMouseLeave),onMouseEnter:O2(_.handleItemMouseEnter,S.props.onMouseEnter)});var ae=p.cloneElement(S,mr(mr({},A.props),Q));function J(Sr){return typeof I.dataKey=="function"?I.dataKey(Sr.payload):null}if(G)if(D>=0){var je,be;if(I.dataKey&&!I.allowDuplicatedCategory){var Ue=typeof I.dataKey=="function"?J:"payload.".concat(I.dataKey.toString());je=EN(K,Ue,F),be=ce&&fe&&EN(fe,Ue,F)}else je=K?.[D],be=ce&&fe&&fe[D];if(me||re){var Z=S.props.activeIndex!==void 0?S.props.activeIndex:D;return[p.cloneElement(S,mr(mr(mr({},A.props),Q),{},{activeIndex:Z})),null,null]}if(!Xn(je))return[ae].concat(Lx(_.renderActivePoints({item:A,activePoint:je,basePoint:be,childIndex:D,isRange:ce})))}else{var Y,lt=(Y=_.getItemByXY(_.state.activeCoordinate))!==null&&Y!==void 0?Y:{graphicalItem:ae},gt=lt.graphicalItem,Te=gt.item,at=Te===void 0?S:Te,yt=gt.childIndex,vt=mr(mr(mr({},A.props),Q),{},{activeIndex:yt});return[p.cloneElement(at,vt),null,null]}return ce?[ae,null,null]:[ae,null]}),zn(_,"renderCustomized",function(S,k,E){return p.cloneElement(S,mr(mr({key:"recharts-customized-".concat(E)},_.props),_.state))}),zn(_,"renderMap",{CartesianGrid:{handler:R2,once:!0},ReferenceArea:{handler:_.renderReferenceElement},ReferenceLine:{handler:R2},ReferenceDot:{handler:_.renderReferenceElement},XAxis:{handler:R2},YAxis:{handler:R2},Brush:{handler:_.renderBrush,once:!0},Bar:{handler:_.renderGraphicChild},Line:{handler:_.renderGraphicChild},Area:{handler:_.renderGraphicChild},Radar:{handler:_.renderGraphicChild},RadialBar:{handler:_.renderGraphicChild},Scatter:{handler:_.renderGraphicChild},Pie:{handler:_.renderGraphicChild},Funnel:{handler:_.renderGraphicChild},Tooltip:{handler:_.renderCursor,once:!0},PolarGrid:{handler:_.renderPolarGrid,once:!0},PolarAngleAxis:{handler:_.renderPolarAxis},PolarRadiusAxis:{handler:_.renderPolarAxis},Customized:{handler:_.renderCustomized}}),_.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:gg("recharts"),"-clip"),_.throttleTriggeredAfterMouseMove=AX(_.triggeredAfterMouseMove,(j=b.throttleDelay)!==null&&j!==void 0?j:1e3/60),_.state={},_}return $qe(y,x),Dqe(y,[{key:"componentDidMount",value:function(){var w,j;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var w=this.props,j=w.children,_=w.data,S=w.height,k=w.layout,E=ac(j,oc);if(E){var A=E.props.defaultIndex;if(!(typeof A!="number"||A<0||A>this.state.tooltipTicks.length-1)){var M=this.state.tooltipTicks[A]&&this.state.tooltipTicks[A].value,C=B3(this.state,_,A,M),T=this.state.tooltipTicks[A].coordinate,I=(this.state.offset.top+S)/2,D=k==="horizontal",F=D?{x:T,y:I}:{y:T,x:I},z=this.state.formattedGraphicalItems.find(function($){var K=$.item;return K.type.name==="Scatter"});z&&(F=mr(mr({},F),z.props.points[A].tooltipPosition),C=z.props.points[A].tooltipPayload);var q={activeTooltipIndex:A,isTooltipActive:!0,activeLabel:M,activePayload:C,activeCoordinate:F};this.setState(q),this.renderCursor(E),this.accessibilityManager.setIndex(A)}}}},{key:"getSnapshotBeforeUpdate",value:function(w,j){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==j.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==w.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==w.margin){var _,S;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0}})}return null}},{key:"componentDidUpdate",value:function(w){mO([ac(w.children,oc)],[ac(this.props.children,oc)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var w=ac(this.props.children,oc);if(w&&typeof w.props.shared=="boolean"){var j=w.props.shared?"axis":"item";return l.indexOf(j)>=0?j:i}return i}},{key:"getMouseInfo",value:function(w){if(!this.container)return null;var j=this.container,_=j.getBoundingClientRect(),S=F3e(_),k={chartX:Math.round(w.pageX-S.left),chartY:Math.round(w.pageY-S.top)},E=_.width/j.offsetWidth||1,A=this.inRange(k.chartX,k.chartY,E);if(!A)return null;var M=this.state,C=M.xAxisMap,T=M.yAxisMap,I=this.getTooltipEventType(),D=xq(this.state,this.props.data,this.props.layout,A);if(I!=="axis"&&C&&T){var F=_m(C).scale,z=_m(T).scale,q=F&&F.invert?F.invert(k.chartX):null,$=z&&z.invert?z.invert(k.chartY):null;return mr(mr({},k),{},{xValue:q,yValue:$},D)}return D?mr(mr({},k),D):null}},{key:"inRange",value:function(w,j){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,S=this.props.layout,k=w/_,E=j/_;if(S==="horizontal"||S==="vertical"){var A=this.state.offset,M=k>=A.left&&k<=A.left+A.width&&E>=A.top&&E<=A.top+A.height;return M?{x:k,y:E}:null}var C=this.state,T=C.angleAxisMap,I=C.radiusAxisMap;if(T&&I){var D=_m(T);return IB({x:k,y:E},D)}return null}},{key:"parseEventsOfWrapper",value:function(){var w=this.props.children,j=this.getTooltipEventType(),_=ac(w,oc),S={};_&&j==="axis"&&(_.props.trigger==="click"?S={onClick:this.handleClick}:S={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var k=kN(this.props,this.handleOuterEvent);return mr(mr({},k),S)}},{key:"addListener",value:function(){SA.on(CA,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){SA.removeListener(CA,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(w,j,_){for(var S=this.state.formattedGraphicalItems,k=0,E=S.length;k<E;k++){var A=S[k];if(A.item===w||A.props.key===w.key||j===Sf(A.item.type)&&_===A.childIndex)return A}return null}},{key:"renderClipPath",value:function(){var w=this.clipPathId,j=this.state.offset,_=j.left,S=j.top,k=j.height,E=j.width;return xe.createElement("defs",null,xe.createElement("clipPath",{id:w},xe.createElement("rect",{x:_,y:S,height:k,width:E})))}},{key:"getXScales",value:function(){var w=this.state.xAxisMap;return w?Object.entries(w).reduce(function(j,_){var S=hq(_,2),k=S[0],E=S[1];return mr(mr({},j),{},zn({},k,E.scale))},{}):null}},{key:"getYScales",value:function(){var w=this.state.yAxisMap;return w?Object.entries(w).reduce(function(j,_){var S=hq(_,2),k=S[0],E=S[1];return mr(mr({},j),{},zn({},k,E.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(w){var j;return(j=this.state.xAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getYScaleByAxisId",value:function(w){var j;return(j=this.state.yAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getItemByXY",value:function(w){var j=this.state,_=j.formattedGraphicalItems,S=j.activeItem;if(_&&_.length)for(var k=0,E=_.length;k<E;k++){var A=_[k],M=A.props,C=A.item,T=C.type.defaultProps!==void 0?mr(mr({},C.type.defaultProps),C.props):C.props,I=Sf(C.type);if(I==="Bar"){var D=(M.data||[]).find(function($){return b6e(w,$)});if(D)return{graphicalItem:A,payload:D}}else if(I==="RadialBar"){var F=(M.data||[]).find(function($){return IB(w,$)});if(F)return{graphicalItem:A,payload:F}}else if(MC(A,S)||RC(A,S)||d1(A,S)){var z=lFe({graphicalItem:A,activeTooltipItem:S,itemData:T.data}),q=T.activeIndex===void 0?z:T.activeIndex;return{graphicalItem:mr(mr({},A),{},{childIndex:q}),payload:d1(A,S)?T.data[z]:A.props.data[z]}}}return null}},{key:"render",value:function(){var w=this;if(!bF(this))return null;var j=this.props,_=j.children,S=j.className,k=j.width,E=j.height,A=j.style,M=j.compact,C=j.title,T=j.desc,I=pq(j,Aqe),D=On(I,!1);if(M)return xe.createElement(z7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},xe.createElement(pO,Pv({},D,{width:k,height:E,title:C,desc:T}),this.renderClipPath(),jF(_,this.renderMap)));if(this.props.accessibilityLayer){var F,z;D.tabIndex=(F=this.props.tabIndex)!==null&&F!==void 0?F:0,D.role=(z=this.props.role)!==null&&z!==void 0?z:"application",D.onKeyDown=function($){w.accessibilityManager.keyboardEvent($)},D.onFocus=function(){w.accessibilityManager.focus()}}var q=this.parseEventsOfWrapper();return xe.createElement(z7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},xe.createElement("div",Pv({className:ta("recharts-wrapper",S),style:mr({position:"relative",cursor:"default",width:k,height:E},A)},q,{ref:function(K){w.container=K}}),xe.createElement(pO,Pv({},D,{width:k,height:E,title:C,desc:T,style:Vqe}),this.renderClipPath(),jF(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(p.Component);zn(v,"displayName",r),zn(v,"defaultProps",mr({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),zn(v,"getDerivedStateFromProps",function(x,y){var b=x.dataKey,w=x.data,j=x.children,_=x.width,S=x.height,k=x.layout,E=x.stackOffset,A=x.margin,M=y.dataStartIndex,C=y.dataEndIndex;if(y.updateId===void 0){var T=yq(x);return mr(mr(mr({},T),{},{updateId:0},h(mr(mr({props:x},T),{},{updateId:0}),y)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:S,prevLayout:k,prevStackOffset:E,prevMargin:A,prevChildren:j})}if(b!==y.prevDataKey||w!==y.prevData||_!==y.prevWidth||S!==y.prevHeight||k!==y.prevLayout||E!==y.prevStackOffset||!Bv(A,y.prevMargin)){var I=yq(x),D={chartX:y.chartX,chartY:y.chartY,isTooltipActive:y.isTooltipActive},F=mr(mr({},xq(y,w,k)),{},{updateId:y.updateId+1}),z=mr(mr(mr({},I),D),F);return mr(mr(mr({},z),h(mr({props:x},z),y)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:S,prevLayout:k,prevStackOffset:E,prevMargin:A,prevChildren:j})}if(!mO(j,y.prevChildren)){var q,$,K,ce,fe=ac(j,Cx),B=fe&&(q=($=fe.props)===null||$===void 0?void 0:$.startIndex)!==null&&q!==void 0?q:M,L=fe&&(K=(ce=fe.props)===null||ce===void 0?void 0:ce.endIndex)!==null&&K!==void 0?K:C,V=B!==M||L!==C,re=!Xn(w),me=re&&!V?y.updateId:y.updateId+1;return mr(mr({updateId:me},h(mr(mr({props:x},y),{},{updateId:me,dataStartIndex:B,dataEndIndex:L}),y)),{},{prevChildren:j,dataStartIndex:B,dataEndIndex:L})}return null}),zn(v,"renderActiveDot",function(x,y,b){var w;return p.isValidElement(x)?w=p.cloneElement(x,y):Vn(x)?w=x(y):w=xe.createElement(aw,y),xe.createElement(Na,{className:"recharts-active-dot",key:b},w)});var g=p.forwardRef(function(y,b){return xe.createElement(v,Pv({},y,{ref:b}))});return g.displayName=v.displayName,g},eze=UC({chartName:"LineChart",GraphicalChild:ow,axisComponents:[{axisType:"xAxis",AxisComp:eg},{axisType:"yAxis",AxisComp:tg}],formatAxisMap:kD}),tze=UC({chartName:"BarChart",GraphicalChild:bg,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:eg},{axisType:"yAxis",AxisComp:tg}],formatAxisMap:kD}),rze=UC({chartName:"PieChart",GraphicalChild:qu,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:DC},{axisType:"radiusAxis",AxisComp:TC}],formatAxisMap:MMe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),nze=UC({chartName:"AreaChart",GraphicalChild:Eh,axisComponents:[{axisType:"xAxis",AxisComp:eg},{axisType:"yAxis",AxisComp:tg}],formatAxisMap:kD});const wq=({icon:e,title:t,value:r,trend:n,trendValue:a,color:i,className:s,loading:l})=>{const c=n==="up"?FT:Wde,d=n==="up"?"text-success":"text-danger";return o.jsx(fr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col justify-between ${s}`,children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10",style:{color:`var(--${i})`},children:o.jsx(e,{className:"h-5 w-5"})}),!l&&n&&a&&o.jsxs("div",{className:`flex items-center text-xs font-bold ${d}`,children:[o.jsx(c,{className:"w-3.5 h-3.5 mr-1"}),o.jsx("span",{children:a})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-2",children:t}),l?o.jsx("div",{className:"h-9 bg-white/5 rounded animate-pulse"}):o.jsx("p",{className:"text-3xl font-bold text-text-primary tabular-nums tracking-tight",children:r})]})]})})},aze=({alerts:e,className:t})=>{const r=Fl(),[n,a]=p.useState(!1),i=u=>({Package:gd,DollarSign:Ui,CalendarCheck:qT,Clock:dd,ShoppingCart:U1,Store:VT,Users:cl,CalendarPlus:zT,AlertTriangle:Of,Info:hH})[u]||Of,s=u=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[u]||"text-warning",l=e.length>2?e.slice(0,2):e,c=e.length>2,d=({alert:u,onClick:f})=>{const m=i(u.icone),h=s(u.cor);return o.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:f,children:[o.jsx(m,{className:`w-4 h-4 flex-shrink-0 ${h}`}),o.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:u.mensagem}),u.link&&o.jsx(FT,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})};return o.jsxs(o.Fragment,{children:[o.jsxs(fr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card ${t||""}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("h2",{className:"text-lg font-bold text-text-primary flex items-center",children:[o.jsx(uN,{className:"mr-2 h-5 w-5 text-brand"})," Alertas do Dia"]}),c&&o.jsx(le,{variant:"ghost",size:"sm",className:"text-xs text-brand hover:text-brand/80",onClick:()=>a(!0),children:"Ver todos"})]}),e.length===0?o.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum alerta no momento! "}):o.jsx("ul",{className:"space-y-2 text-sm",children:l.map((u,f)=>o.jsx(d,{alert:u,onClick:()=>u.link&&r(u.link)},f))})]}),o.jsx(ln,{open:n,onOpenChange:a,children:o.jsxs(sn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[o.jsx(an,{children:o.jsxs(nn,{className:"flex items-center gap-2",children:[o.jsx(uN,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",e.length,")"]})}),o.jsx("div",{className:"mt-4",children:e.length===0?o.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):o.jsx("ul",{className:"space-y-2 text-sm",children:e.map((u,f)=>o.jsx(d,{alert:u,onClick:()=>{u.link&&(r(u.link),a(!1))}},f))})})]})})]})},oze=({title:e,icon:t,data:r,color:n,className:a,loading:i})=>{const s=r.reduce((d,u)=>d+(u.receita||0),0),l=r.reduce((d,u)=>d+(u.despesa||0),0),c=s-l;return o.jsxs(fr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group ${a||""}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:o.jsx(t,{className:"h-5 w-5"})}),o.jsx("h3",{className:"text-base font-bold text-text-primary flex-1",children:e}),o.jsx("div",{className:"text-xs font-semibold text-text-muted",children:"ltimos 14 dias"})]}),o.jsx("div",{className:"mb-2",children:o.jsx(_j,{width:"100%",height:90,children:o.jsxs(nze,{data:r,margin:{top:4,right:0,left:0,bottom:0},children:[o.jsx(oc,{cursor:{stroke:"var(--border)",strokeDasharray:"3 3"},contentStyle:{background:"rgba(10, 10, 10, 0.85)",borderColor:"var(--border)",color:"var(--text-primary)",borderRadius:"var(--radius-sm)"},formatter:(d,u)=>u==="saldo"?[`R$ ${d.toLocaleString("pt-BR")}`,"Saldo"]:d,labelFormatter:d=>d}),o.jsx(Eh,{type:"monotone",dataKey:"saldo",stroke:"var(--brand)",strokeWidth:2,fill:"var(--brand)",fillOpacity:.15})]})})}),o.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary",children:"Receita"}),i?o.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):o.jsxs("p",{className:"font-bold text-success tabular-nums",children:["R$ ",s.toLocaleString("pt-BR")]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary",children:"Despesa"}),i?o.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):o.jsxs("p",{className:"font-bold text-danger tabular-nums",children:["R$ ",l.toLocaleString("pt-BR")]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary",children:"Saldo"}),i?o.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):o.jsxs("p",{className:"font-bold text-text-primary tabular-nums",children:["R$ ",c.toLocaleString("pt-BR")]})]})]})]})},ize=({title:e,icon:t,data:r,color:n,className:a,loading:i})=>o.jsxs(fr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col ${a||""}`,children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:o.jsx(t,{className:"h-5 w-5"})}),o.jsx("h3",{className:"text-base font-bold text-text-primary",children:e})]}),o.jsx("div",{className:"space-y-3 mt-auto",children:i?Array.from({length:3}).map((s,l)=>o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("div",{className:"h-4 w-24 bg-white/5 rounded animate-pulse"}),o.jsx("div",{className:"h-4 w-12 bg-white/5 rounded animate-pulse"})]},l)):r.map((s,l)=>o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:s.name}),o.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:s.value})]},l))})]}),sze={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.1,delayChildren:.2}}},AA={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}};function lze(){const{toast:e}=ro(),{userProfile:t}=Do(),n=JS()?.alerts||[],a=Fl(),[i,s]=p.useState(!0),[l,c]=p.useState(0),[d,u]=p.useState({finalizados:0,total:0}),[f,m]=p.useState(0),[h,v]=p.useState(0),[g,x]=p.useState(0),[y,b]=p.useState(0),[w,j]=p.useState(0),[_,S]=p.useState(0),[k,E]=p.useState([]);p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa){console.log("[DashboardPage] Aguardando autenticao..."),s(!1);return}console.log("[DashboardPage] Iniciando carregamento de dados...");try{s(!0);const T=t.codigo_empresa,I=new Date,D=ti(I).toISOString(),F=Nj(I).toISOString();console.log("[Dashboard] 1. Buscando pagamentos...");const{data:z}=await pe.from("pagamentos").select("valor, status").eq("codigo_empresa",T).gte("recebido_em",D).lte("recebido_em",F);console.log("[Dashboard]  Pagamentos carregados:",z?.length||0);const q=(z||[]).filter(se=>!["Cancelado","Estornado"].includes(se.status)).reduce((se,Ze)=>se+Number(Ze.valor||0),0);console.log("[Dashboard] 2. Buscando agendamentos de hoje...");const{data:$}=await pe.from("agendamentos").select("id").eq("codigo_empresa",T).gte("inicio",D).lte("inicio",F);console.log("[Dashboard]  Agendamentos de hoje:",$?.length||0);let K=0;if($&&$.length>0){console.log("[Dashboard] 3. Buscando participantes pagos...");const se=$.map(ct=>ct.id),{data:Ze}=await pe.from("agendamento_participantes").select("valor_cota, status_pagamento, aplicar_taxa, finalizadora_id, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",T).in("agendamento_id",se).eq("status_pagamento","Pago");console.log("[Dashboard]  Participantes pagos:",Ze?.length||0),K=(Ze||[]).reduce((ct,Qt)=>{let we=Number(Qt.valor_cota||0);if(Qt.aplicar_taxa===!0){const ye=Number(Qt.finalizadoras?.taxa_percentual||0);ye>0&&(we=we/(1+ye/100))}return ct+we},0)}const ce=q+K;c(ce),console.log("[Dashboard] 4. Buscando agendamentos completos...");const{data:fe}=await pe.from("agendamentos").select("id, status, inicio, fim").eq("codigo_empresa",T).gte("inicio",D).lte("inicio",F);console.log("[Dashboard]  Agendamentos completos:",fe?.length||0);const B=(fe||[]).filter(se=>se.status==="finished").length;u({finalizados:B,total:fe?.length||0});const L=new Date().toISOString(),V=(fe||[]).filter(se=>se.inicio>L&&!["canceled","finished"].includes(se.status)).length;m(V);const re=(fe||[]).filter(se=>se.status==="in_progress").length;v(re),console.log("[Dashboard] 5. Buscando quadras...");const{data:me}=await pe.from("quadras").select("id").eq("codigo_empresa",T);console.log("[Dashboard]  Quadras:",me?.length||0);const ae=(me?.length||0)*17;let J=0;for(const se of fe||[])if(!["canceled","no_show"].includes(se.status))if(se.inicio&&se.fim){const Ze=new Date(se.inicio),we=(new Date(se.fim)-Ze)/(1e3*60*60);J+=we}else J+=1;const je=ae>0?Math.round(J/ae*100):0;x(je),console.log("[Dashboard] 6. Buscando comandas abertas...");const{data:be}=await pe.from("comandas").select("id").eq("codigo_empresa",T).eq("status","open");console.log("[Dashboard]  Comandas abertas:",be?.length||0),b(be?.length||0),console.log("[Dashboard] 7. Buscando mesas...");const{data:Ue}=await pe.from("mesas").select("id, status").eq("codigo_empresa",T);console.log("[Dashboard]  Mesas:",Ue?.length||0);const Z=(Ue||[]).filter(se=>["in-use","awaiting-payment"].includes(se.status)).length;j(Z),console.log("[Dashboard] 8. Buscando vendas da loja...");const{data:Y}=await pe.from("comandas").select("id").eq("codigo_empresa",T).eq("status","closed").gte("fechado_em",D).lte("fechado_em",F);console.log("[Dashboard]  Vendas da loja:",Y?.length||0),S(Y?.length||0),console.log("[Dashboard] 9. Buscando dados dos ltimos 14 dias...");const lt=new Date;lt.setDate(lt.getDate()-13);const gt=ti(lt).toISOString(),Te=Nj(I).toISOString(),{data:at}=await pe.from("pagamentos").select("valor, status, recebido_em").eq("codigo_empresa",T).gte("recebido_em",gt).lte("recebido_em",Te);console.log("[Dashboard]  Pagamentos 14 dias:",at?.length||0);const{data:yt}=await pe.from("agendamentos").select("id, inicio").eq("codigo_empresa",T).gte("inicio",gt).lte("inicio",Te);console.log("[Dashboard]  Agendamentos 14 dias:",yt?.length||0);let vt=[];if(yt&&yt.length>0){const se=yt.map(ct=>ct.id),{data:Ze}=await pe.from("agendamento_participantes").select("valor_cota, agendamento_id").eq("codigo_empresa",T).in("agendamento_id",se).eq("status_pagamento","Pago");vt=Ze||[],console.log("[Dashboard]  Participantes pagos 14 dias:",vt.length)}const Sr=[];for(let se=13;se>=0;se--){const Ze=new Date;Ze.setDate(Ze.getDate()-se);const ct=ti(Ze),Qt=Nj(Ze),we=(at||[]).filter(Pe=>{const It=new Date(Pe.recebido_em);return It>=ct&&It<=Qt&&!["Cancelado","Estornado"].includes(Pe.status)}).reduce((Pe,It)=>Pe+Number(It.valor||0),0),ye=(yt||[]).filter(Pe=>{const It=new Date(Pe.inicio);return It>=ct&&It<=Qt}).map(Pe=>Pe.id),te=vt.filter(Pe=>ye.includes(Pe.agendamento_id)).reduce((Pe,It)=>Pe+Number(It.valor_cota||0),0),$e=we+te;Sr.push({name:se===0?"Hoje":`${se}d`,saldo:Math.round($e),receita:Math.round($e),despesa:0})}console.log("[Dashboard]  Dados de 14 dias carregados"),E(Sr)}catch(T){console.error("[DashboardPage]  Erro ao carregar dashboard:",T),e({title:"Erro ao carregar dashboard",description:T?.message||"Tente recarregar a pgina",variant:"destructive"})}finally{console.log("[DashboardPage]  Carregamento concludo"),s(!1)}})()},[t?.codigo_empresa]);const A=C=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(C||0)),M=[{name:"Comandas Abertas",value:y},{name:"Mesas Ocupadas",value:w},{name:"Vendas Hoje",value:_}];return o.jsx(o.Fragment,{children:o.jsxs(fr.div,{variants:sze,initial:"hidden",animate:"visible",className:"space-y-4",children:[o.jsxs(fr.div,{variants:AA,className:"relative grid grid-cols-1 xl:grid-cols-12 gap-4 items-start",children:[o.jsx("div",{className:"xl:col-span-8",children:o.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm relative p-4 rounded-xl border border-white/10 overflow-hidden shadow-1",children:[o.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.03] mix-blend-overlay"}),o.jsxs("div",{className:"relative z-10 max-w-[720px]",children:[o.jsxs("h1",{className:"text-3xl font-black mb-2 text-text-primary tracking-tighter",children:["Bem-vindo de volta, ",o.jsxs("span",{className:"text-brand",children:[(t?.nome_exibicao||t?.nome||t?.email?.split("@")[0]||"Admin").split(" ")[0],"!"]})]}),o.jsx("p",{className:"text-text-secondary mb-3 max-w-[60ch] text-sm md:text-base font-normal",children:"Sua central de comando para uma gesto de sucesso. Monitore agendamentos, faturamento e clientes em um s lugar."}),o.jsxs("div",{className:"flex flex-wrap gap-2.5",children:[o.jsxs(le,{onClick:()=>a("/agenda",{state:{openModal:!0}}),size:"default",children:[o.jsx(zT,{className:"mr-2 h-4 w-4"}),"+ Agendamento"]}),o.jsxs(le,{onClick:()=>a("/clientes",{state:{openModal:!0}}),variant:"outline",size:"default",children:[o.jsx(cl,{className:"mr-2 h-4 w-4"}),"Adicionar Cliente"]})]})]})]})}),o.jsx("div",{className:"xl:col-span-4",children:o.jsxs("div",{className:"fx-card",children:[o.jsxs("h2",{className:"text-lg font-bold text-text-primary mb-3 flex items-center",children:[o.jsx(dd,{className:"mr-2 h-5 w-5 text-brand"})," Resumo do Dia"]}),o.jsxs("ul",{className:"space-y-2 text-sm",children:[o.jsxs("li",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-text-secondary",children:"Prximas Reservas"}),i?o.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):o.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:f})]}),o.jsxs("li",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-text-secondary",children:"Quadras em Uso"}),i?o.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):o.jsx("span",{className:"font-bold text-success tabular-nums",children:h})]}),o.jsxs("li",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-text-secondary",children:"Taxa de Ocupao"}),i?o.jsx("div",{className:"h-6 w-16 bg-white/5 rounded animate-pulse"}):o.jsxs("span",{className:`font-bold tabular-nums ${g>=70?"text-success":g>=40?"text-warning":"text-danger"}`,children:[g,"%"]})]})]})]})})]}),o.jsxs(fr.div,{variants:AA,className:"relative grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-12 gap-4 items-stretch",children:[o.jsx("div",{className:"xl:col-span-3",children:o.jsx(wq,{icon:Ui,title:"Faturamento do Dia",value:A(l),color:"success",className:"h-full",loading:i})}),o.jsx("div",{className:"xl:col-span-3",children:o.jsx(wq,{icon:qT,title:"Agend. Finalizados",value:`${d.finalizados} de ${d.total}`,color:"info",className:"h-full",loading:i})}),o.jsx("div",{className:"xl:col-span-3",children:o.jsx(aze,{className:"h-full",alerts:n})}),o.jsx("div",{className:"xl:col-span-3",children:o.jsx(ize,{icon:VT,title:"Informaes da Loja",data:M,color:"purple",className:"h-full",loading:i})})]}),o.jsx(fr.div,{variants:AA,className:"grid grid-cols-1 gap-4",children:o.jsx(oze,{icon:Wp,title:"Resumo Financeiro",data:k,color:"brand",loading:i})})]})})}var cze={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},dze=function(t,r,n){var a,i=cze[t];return typeof i=="string"?a=i:r===1?a=i.one:a=i.other.replace("{{count}}",String(r)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"em "+a:"h "+a:a};const uze=dze;var fze={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},mze={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},hze={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pze={date:Fv({formats:fze,defaultWidth:"full"}),time:Fv({formats:mze,defaultWidth:"full"}),dateTime:Fv({formats:hze,defaultWidth:"full"})};const gze=pze;var vze={lastWeek:function(t){var r=t.getUTCDay(),n=r===0||r===6?"ltimo":"ltima";return"'"+n+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},xze=function(t,r,n,a){var i=vze[t];return typeof i=="function"?i(r):i};const yze=xze;var bze={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},wze={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},jze={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},Nze={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},_ze={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},Sze={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},Cze=function(t,r){var n=Number(t);return r?.unit==="week"?n+"":n+""},Pze={ordinalNumber:Cze,era:wu({values:bze,defaultWidth:"wide"}),quarter:wu({values:wze,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:wu({values:jze,defaultWidth:"wide"}),day:wu({values:Nze,defaultWidth:"wide"}),dayPeriod:wu({values:_ze,defaultWidth:"wide",formattingValues:Sze,defaultFormattingWidth:"wide"})};const Aze=Pze;var Eze=/^(\d+)[o]?/i,kze=/\d+/i,Oze={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},Tze={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},Ize={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},Dze={any:[/1/i,/2/i,/3/i,/4/i]},Mze={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},Rze={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},Lze={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},$ze={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},Fze={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},Bze={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},qze={ordinalNumber:oY({matchPattern:Eze,parsePattern:kze,valueCallback:function(t){return parseInt(t,10)}}),era:ju({matchPatterns:Oze,defaultMatchWidth:"wide",parsePatterns:Tze,defaultParseWidth:"any"}),quarter:ju({matchPatterns:Ize,defaultMatchWidth:"wide",parsePatterns:Dze,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:ju({matchPatterns:Mze,defaultMatchWidth:"wide",parsePatterns:Rze,defaultParseWidth:"any"}),day:ju({matchPatterns:Lze,defaultMatchWidth:"wide",parsePatterns:$ze,defaultParseWidth:"any"}),dayPeriod:ju({matchPatterns:Fze,defaultMatchWidth:"any",parsePatterns:Bze,defaultParseWidth:"any"})};const zze=qze;var Uze={code:"pt-BR",formatDistance:uze,formatLong:gze,formatRelative:yze,localize:Aze,match:zze,options:{weekStartsOn:0,firstWeekContainsDate:1}};const aa=Uze,Vze=["top","right","bottom","left"],ph=Math.min,ic=Math.max,T_=Math.round,L2=Math.floor,Lu=e=>({x:e,y:e}),Wze={left:"right",right:"left",bottom:"top",top:"bottom"},Hze={start:"end",end:"start"};function q3(e,t,r){return ic(e,ph(t,r))}function $f(e,t){return typeof e=="function"?e(t):e}function Ff(e){return e.split("-")[0]}function g0(e){return e.split("-")[1]}function BD(e){return e==="x"?"y":"x"}function qD(e){return e==="y"?"height":"width"}const Gze=new Set(["top","bottom"]);function Au(e){return Gze.has(Ff(e))?"y":"x"}function zD(e){return BD(Au(e))}function Kze(e,t,r){r===void 0&&(r=!1);const n=g0(e),a=zD(e),i=qD(a);let s=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=I_(s)),[s,I_(s)]}function Yze(e){const t=I_(e);return[z3(e),t,z3(t)]}function z3(e){return e.replace(/start|end/g,t=>Hze[t])}const jq=["left","right"],Nq=["right","left"],Xze=["top","bottom"],Jze=["bottom","top"];function Qze(e,t,r){switch(e){case"top":case"bottom":return r?t?Nq:jq:t?jq:Nq;case"left":case"right":return t?Xze:Jze;default:return[]}}function Zze(e,t,r,n){const a=g0(e);let i=Qze(Ff(e),r==="start",n);return a&&(i=i.map(s=>s+"-"+a),t&&(i=i.concat(i.map(z3)))),i}function I_(e){return e.replace(/left|right|bottom|top/g,t=>Wze[t])}function e9e(e){return{top:0,right:0,bottom:0,left:0,...e}}function nZ(e){return typeof e!="number"?e9e(e):{top:e,right:e,bottom:e,left:e}}function D_(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function _q(e,t,r){let{reference:n,floating:a}=e;const i=Au(t),s=zD(t),l=qD(s),c=Ff(t),d=i==="y",u=n.x+n.width/2-a.width/2,f=n.y+n.height/2-a.height/2,m=n[l]/2-a[l]/2;let h;switch(c){case"top":h={x:u,y:n.y-a.height};break;case"bottom":h={x:u,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:f};break;case"left":h={x:n.x-a.width,y:f};break;default:h={x:n.x,y:n.y}}switch(g0(t)){case"start":h[s]-=m*(r&&d?-1:1);break;case"end":h[s]+=m*(r&&d?-1:1);break}return h}const t9e=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:s}=r,l=i.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(t));let d=await s.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:f}=_q(d,n,c),m=n,h={},v=0;for(let g=0;g<l.length;g++){const{name:x,fn:y}=l[g],{x:b,y:w,data:j,reset:_}=await y({x:u,y:f,initialPlacement:n,placement:m,strategy:a,middlewareData:h,rects:d,platform:s,elements:{reference:e,floating:t}});u=b??u,f=w??f,h={...h,[x]:{...h[x],...j}},_&&v<=50&&(v++,typeof _=="object"&&(_.placement&&(m=_.placement),_.rects&&(d=_.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:a}):_.rects),{x:u,y:f}=_q(d,m,c)),g=-1)}return{x:u,y:f,placement:m,strategy:a,middlewareData:h}};async function v1(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:i,rects:s,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:m=!1,padding:h=0}=$f(t,e),v=nZ(h),x=l[m?f==="floating"?"reference":"floating":f],y=D_(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(x)))==null||r?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),b=f==="floating"?{x:n,y:a,width:s.floating.width,height:s.floating.height}:s.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),j=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},_=D_(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:w,strategy:c}):b);return{top:(y.top-_.top+v.top)/j.y,bottom:(_.bottom-y.bottom+v.bottom)/j.y,left:(y.left-_.left+v.left)/j.x,right:(_.right-y.right+v.right)/j.x}}const r9e=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:i,platform:s,elements:l,middlewareData:c}=t,{element:d,padding:u=0}=$f(e,t)||{};if(d==null)return{};const f=nZ(u),m={x:r,y:n},h=zD(a),v=qD(h),g=await s.getDimensions(d),x=h==="y",y=x?"top":"left",b=x?"bottom":"right",w=x?"clientHeight":"clientWidth",j=i.reference[v]+i.reference[h]-m[h]-i.floating[v],_=m[h]-i.reference[h],S=await(s.getOffsetParent==null?void 0:s.getOffsetParent(d));let k=S?S[w]:0;(!k||!await(s.isElement==null?void 0:s.isElement(S)))&&(k=l.floating[w]||i.floating[v]);const E=j/2-_/2,A=k/2-g[v]/2-1,M=ph(f[y],A),C=ph(f[b],A),T=M,I=k-g[v]-C,D=k/2-g[v]/2+E,F=q3(T,D,I),z=!c.arrow&&g0(a)!=null&&D!==F&&i.reference[v]/2-(D<T?M:C)-g[v]/2<0,q=z?D<T?D-T:D-I:0;return{[h]:m[h]+q,data:{[h]:F,centerOffset:D-F-q,...z&&{alignmentOffset:q}},reset:z}}}),n9e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:i,rects:s,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:m,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...x}=$f(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=Ff(a),b=Au(l),w=Ff(l)===l,j=await(c.isRTL==null?void 0:c.isRTL(d.floating)),_=m||(w||!g?[I_(l)]:Yze(l)),S=v!=="none";!m&&S&&_.push(...Zze(l,g,v,j));const k=[l,..._],E=await v1(t,x),A=[];let M=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&A.push(E[y]),f){const D=Kze(a,s,j);A.push(E[D[0]],E[D[1]])}if(M=[...M,{placement:a,overflows:A}],!A.every(D=>D<=0)){var C,T;const D=(((C=i.flip)==null?void 0:C.index)||0)+1,F=k[D];if(F&&(!(f==="alignment"?b!==Au(F):!1)||M.every($=>Au($.placement)===b?$.overflows[0]>0:!0)))return{data:{index:D,overflows:M},reset:{placement:F}};let z=(T=M.filter(q=>q.overflows[0]<=0).sort((q,$)=>q.overflows[1]-$.overflows[1])[0])==null?void 0:T.placement;if(!z)switch(h){case"bestFit":{var I;const q=(I=M.filter($=>{if(S){const K=Au($.placement);return K===b||K==="y"}return!0}).map($=>[$.placement,$.overflows.filter(K=>K>0).reduce((K,ce)=>K+ce,0)]).sort(($,K)=>$[1]-K[1])[0])==null?void 0:I[0];q&&(z=q);break}case"initialPlacement":z=l;break}if(a!==z)return{reset:{placement:z}}}return{}}}};function Sq(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Cq(e){return Vze.some(t=>e[t]>=0)}const a9e=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=$f(e,t);switch(n){case"referenceHidden":{const i=await v1(t,{...a,elementContext:"reference"}),s=Sq(i,r.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:Cq(s)}}}case"escaped":{const i=await v1(t,{...a,altBoundary:!0}),s=Sq(i,r.floating);return{data:{escapedOffsets:s,escaped:Cq(s)}}}default:return{}}}}},aZ=new Set(["left","top"]);async function o9e(e,t){const{placement:r,platform:n,elements:a}=e,i=await(n.isRTL==null?void 0:n.isRTL(a.floating)),s=Ff(r),l=g0(r),c=Au(r)==="y",d=aZ.has(s)?-1:1,u=i&&c?-1:1,f=$f(t,e);let{mainAxis:m,crossAxis:h,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof v=="number"&&(h=l==="end"?v*-1:v),c?{x:h*u,y:m*d}:{x:m*d,y:h*u}}const i9e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:i,placement:s,middlewareData:l}=t,c=await o9e(t,e);return s===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:a+c.x,y:i+c.y,data:{...c,placement:s}}}}},s9e=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:i=!0,crossAxis:s=!1,limiter:l={fn:x=>{let{x:y,y:b}=x;return{x:y,y:b}}},...c}=$f(e,t),d={x:r,y:n},u=await v1(t,c),f=Au(Ff(a)),m=BD(f);let h=d[m],v=d[f];if(i){const x=m==="y"?"top":"left",y=m==="y"?"bottom":"right",b=h+u[x],w=h-u[y];h=q3(b,h,w)}if(s){const x=f==="y"?"top":"left",y=f==="y"?"bottom":"right",b=v+u[x],w=v-u[y];v=q3(b,v,w)}const g=l.fn({...t,[m]:h,[f]:v});return{...g,data:{x:g.x-r,y:g.y-n,enabled:{[m]:i,[f]:s}}}}}},l9e=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:i,middlewareData:s}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=$f(e,t),u={x:r,y:n},f=Au(a),m=BD(f);let h=u[m],v=u[f];const g=$f(l,t),x=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const w=m==="y"?"height":"width",j=i.reference[m]-i.floating[w]+x.mainAxis,_=i.reference[m]+i.reference[w]-x.mainAxis;h<j?h=j:h>_&&(h=_)}if(d){var y,b;const w=m==="y"?"width":"height",j=aZ.has(Ff(a)),_=i.reference[f]-i.floating[w]+(j&&((y=s.offset)==null?void 0:y[f])||0)+(j?0:x.crossAxis),S=i.reference[f]+i.reference[w]+(j?0:((b=s.offset)==null?void 0:b[f])||0)-(j?x.crossAxis:0);v<_?v=_:v>S&&(v=S)}return{[m]:h,[f]:v}}}},c9e=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:i,platform:s,elements:l}=t,{apply:c=()=>{},...d}=$f(e,t),u=await v1(t,d),f=Ff(a),m=g0(a),h=Au(a)==="y",{width:v,height:g}=i.floating;let x,y;f==="top"||f==="bottom"?(x=f,y=m===(await(s.isRTL==null?void 0:s.isRTL(l.floating))?"start":"end")?"left":"right"):(y=f,x=m==="end"?"top":"bottom");const b=g-u.top-u.bottom,w=v-u.left-u.right,j=ph(g-u[x],b),_=ph(v-u[y],w),S=!t.middlewareData.shift;let k=j,E=_;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(E=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(k=b),S&&!m){const M=ic(u.left,0),C=ic(u.right,0),T=ic(u.top,0),I=ic(u.bottom,0);h?E=v-2*(M!==0||C!==0?M+C:ic(u.left,u.right)):k=g-2*(T!==0||I!==0?T+I:ic(u.top,u.bottom))}await c({...t,availableWidth:E,availableHeight:k});const A=await s.getDimensions(l.floating);return v!==A.width||g!==A.height?{reset:{rects:!0}}:{}}}};function VC(){return typeof window<"u"}function v0(e){return oZ(e)?(e.nodeName||"").toLowerCase():"#document"}function xc(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Hu(e){var t;return(t=(oZ(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function oZ(e){return VC()?e instanceof Node||e instanceof xc(e).Node:!1}function eu(e){return VC()?e instanceof Element||e instanceof xc(e).Element:!1}function zu(e){return VC()?e instanceof HTMLElement||e instanceof xc(e).HTMLElement:!1}function Pq(e){return!VC()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof xc(e).ShadowRoot}const d9e=new Set(["inline","contents"]);function iw(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=tu(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!d9e.has(a)}const u9e=new Set(["table","td","th"]);function f9e(e){return u9e.has(v0(e))}const m9e=[":popover-open",":modal"];function WC(e){return m9e.some(t=>{try{return e.matches(t)}catch{return!1}})}const h9e=["transform","translate","scale","rotate","perspective"],p9e=["transform","translate","scale","rotate","perspective","filter"],g9e=["paint","layout","strict","content"];function UD(e){const t=VD(),r=eu(e)?tu(e):e;return h9e.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||p9e.some(n=>(r.willChange||"").includes(n))||g9e.some(n=>(r.contain||"").includes(n))}function v9e(e){let t=gh(e);for(;zu(t)&&!$x(t);){if(UD(t))return t;if(WC(t))return null;t=gh(t)}return null}function VD(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const x9e=new Set(["html","body","#document"]);function $x(e){return x9e.has(v0(e))}function tu(e){return xc(e).getComputedStyle(e)}function HC(e){return eu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function gh(e){if(v0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Pq(e)&&e.host||Hu(e);return Pq(t)?t.host:t}function iZ(e){const t=gh(e);return $x(t)?e.ownerDocument?e.ownerDocument.body:e.body:zu(t)&&iw(t)?t:iZ(t)}function x1(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=iZ(e),i=a===((n=e.ownerDocument)==null?void 0:n.body),s=xc(a);if(i){const l=U3(s);return t.concat(s,s.visualViewport||[],iw(a)?a:[],l&&r?x1(l):[])}return t.concat(a,x1(a,[],r))}function U3(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function sZ(e){const t=tu(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=zu(e),i=a?e.offsetWidth:r,s=a?e.offsetHeight:n,l=T_(r)!==i||T_(n)!==s;return l&&(r=i,n=s),{width:r,height:n,$:l}}function WD(e){return eu(e)?e:e.contextElement}function Uv(e){const t=WD(e);if(!zu(t))return Lu(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:i}=sZ(t);let s=(i?T_(r.width):r.width)/n,l=(i?T_(r.height):r.height)/a;return(!s||!Number.isFinite(s))&&(s=1),(!l||!Number.isFinite(l))&&(l=1),{x:s,y:l}}const y9e=Lu(0);function lZ(e){const t=xc(e);return!VD()||!t.visualViewport?y9e:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function b9e(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==xc(e)?!1:t}function rg(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=WD(e);let s=Lu(1);t&&(n?eu(n)&&(s=Uv(n)):s=Uv(e));const l=b9e(i,r,n)?lZ(i):Lu(0);let c=(a.left+l.x)/s.x,d=(a.top+l.y)/s.y,u=a.width/s.x,f=a.height/s.y;if(i){const m=xc(i),h=n&&eu(n)?xc(n):n;let v=m,g=U3(v);for(;g&&n&&h!==v;){const x=Uv(g),y=g.getBoundingClientRect(),b=tu(g),w=y.left+(g.clientLeft+parseFloat(b.paddingLeft))*x.x,j=y.top+(g.clientTop+parseFloat(b.paddingTop))*x.y;c*=x.x,d*=x.y,u*=x.x,f*=x.y,c+=w,d+=j,v=xc(g),g=U3(v)}}return D_({width:u,height:f,x:c,y:d})}function HD(e,t){const r=HC(e).scrollLeft;return t?t.left+r:rg(Hu(e)).left+r}function cZ(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:HD(e,n)),i=n.top+t.scrollTop;return{x:a,y:i}}function w9e(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const i=a==="fixed",s=Hu(n),l=t?WC(t.floating):!1;if(n===s||l&&i)return r;let c={scrollLeft:0,scrollTop:0},d=Lu(1);const u=Lu(0),f=zu(n);if((f||!f&&!i)&&((v0(n)!=="body"||iw(s))&&(c=HC(n)),zu(n))){const h=rg(n);d=Uv(n),u.x=h.x+n.clientLeft,u.y=h.y+n.clientTop}const m=s&&!f&&!i?cZ(s,c,!0):Lu(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+u.x+m.x,y:r.y*d.y-c.scrollTop*d.y+u.y+m.y}}function j9e(e){return Array.from(e.getClientRects())}function N9e(e){const t=Hu(e),r=HC(e),n=e.ownerDocument.body,a=ic(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=ic(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let s=-r.scrollLeft+HD(e);const l=-r.scrollTop;return tu(n).direction==="rtl"&&(s+=ic(t.clientWidth,n.clientWidth)-a),{width:a,height:i,x:s,y:l}}function _9e(e,t){const r=xc(e),n=Hu(e),a=r.visualViewport;let i=n.clientWidth,s=n.clientHeight,l=0,c=0;if(a){i=a.width,s=a.height;const d=VD();(!d||d&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:s,x:l,y:c}}const S9e=new Set(["absolute","fixed"]);function C9e(e,t){const r=rg(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,i=zu(e)?Uv(e):Lu(1),s=e.clientWidth*i.x,l=e.clientHeight*i.y,c=a*i.x,d=n*i.y;return{width:s,height:l,x:c,y:d}}function Aq(e,t,r){let n;if(t==="viewport")n=_9e(e,r);else if(t==="document")n=N9e(Hu(e));else if(eu(t))n=C9e(t,r);else{const a=lZ(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return D_(n)}function dZ(e,t){const r=gh(e);return r===t||!eu(r)||$x(r)?!1:tu(r).position==="fixed"||dZ(r,t)}function P9e(e,t){const r=t.get(e);if(r)return r;let n=x1(e,[],!1).filter(l=>eu(l)&&v0(l)!=="body"),a=null;const i=tu(e).position==="fixed";let s=i?gh(e):e;for(;eu(s)&&!$x(s);){const l=tu(s),c=UD(s);!c&&l.position==="fixed"&&(a=null),(i?!c&&!a:!c&&l.position==="static"&&!!a&&S9e.has(a.position)||iw(s)&&!c&&dZ(e,s))?n=n.filter(u=>u!==s):a=l,s=gh(s)}return t.set(e,n),n}function A9e(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const s=[...r==="clippingAncestors"?WC(t)?[]:P9e(t,this._c):[].concat(r),n],l=s[0],c=s.reduce((d,u)=>{const f=Aq(t,u,a);return d.top=ic(f.top,d.top),d.right=ph(f.right,d.right),d.bottom=ph(f.bottom,d.bottom),d.left=ic(f.left,d.left),d},Aq(t,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function E9e(e){const{width:t,height:r}=sZ(e);return{width:t,height:r}}function k9e(e,t,r){const n=zu(t),a=Hu(t),i=r==="fixed",s=rg(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=Lu(0);function d(){c.x=HD(a)}if(n||!n&&!i)if((v0(t)!=="body"||iw(a))&&(l=HC(t)),n){const h=rg(t,!0,i,t);c.x=h.x+t.clientLeft,c.y=h.y+t.clientTop}else a&&d();i&&!n&&a&&d();const u=a&&!n&&!i?cZ(a,l):Lu(0),f=s.left+l.scrollLeft-c.x-u.x,m=s.top+l.scrollTop-c.y-u.y;return{x:f,y:m,width:s.width,height:s.height}}function EA(e){return tu(e).position==="static"}function Eq(e,t){if(!zu(e)||tu(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Hu(e)===r&&(r=r.ownerDocument.body),r}function uZ(e,t){const r=xc(e);if(WC(e))return r;if(!zu(e)){let a=gh(e);for(;a&&!$x(a);){if(eu(a)&&!EA(a))return a;a=gh(a)}return r}let n=Eq(e,t);for(;n&&f9e(n)&&EA(n);)n=Eq(n,t);return n&&$x(n)&&EA(n)&&!UD(n)?r:n||v9e(e)||r}const O9e=async function(e){const t=this.getOffsetParent||uZ,r=this.getDimensions,n=await r(e.floating);return{reference:k9e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function T9e(e){return tu(e).direction==="rtl"}const I9e={convertOffsetParentRelativeRectToViewportRelativeRect:w9e,getDocumentElement:Hu,getClippingRect:A9e,getOffsetParent:uZ,getElementRects:O9e,getClientRects:j9e,getDimensions:E9e,getScale:Uv,isElement:eu,isRTL:T9e};function fZ(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function D9e(e,t){let r=null,n;const a=Hu(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function s(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const d=e.getBoundingClientRect(),{left:u,top:f,width:m,height:h}=d;if(l||t(),!m||!h)return;const v=L2(f),g=L2(a.clientWidth-(u+m)),x=L2(a.clientHeight-(f+h)),y=L2(u),w={rootMargin:-v+"px "+-g+"px "+-x+"px "+-y+"px",threshold:ic(0,ph(1,c))||1};let j=!0;function _(S){const k=S[0].intersectionRatio;if(k!==c){if(!j)return s();k?s(!1,k):n=setTimeout(()=>{s(!1,1e-7)},1e3)}k===1&&!fZ(d,e.getBoundingClientRect())&&s(),j=!1}try{r=new IntersectionObserver(_,{...w,root:a.ownerDocument})}catch{r=new IntersectionObserver(_,w)}r.observe(e)}return s(!0),i}function M9e(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=WD(e),u=a||i?[...d?x1(d):[],...x1(t)]:[];u.forEach(y=>{a&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const f=d&&l?D9e(d,r):null;let m=-1,h=null;s&&(h=new ResizeObserver(y=>{let[b]=y;b&&b.target===d&&h&&(h.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),r()}),d&&!c&&h.observe(d),h.observe(t));let v,g=c?rg(e):null;c&&x();function x(){const y=rg(e);g&&!fZ(g,y)&&r(),g=y,v=requestAnimationFrame(x)}return r(),()=>{var y;u.forEach(b=>{a&&b.removeEventListener("scroll",r),i&&b.removeEventListener("resize",r)}),f?.(),(y=h)==null||y.disconnect(),h=null,c&&cancelAnimationFrame(v)}}const R9e=i9e,L9e=s9e,$9e=n9e,F9e=c9e,B9e=a9e,kq=r9e,q9e=l9e,z9e=(e,t,r)=>{const n=new Map,a={platform:I9e,...r},i={...a.platform,_c:n};return t9e(e,t,{...a,platform:i})};var U9e=typeof document<"u",V9e=function(){},Cj=U9e?p.useLayoutEffect:V9e;function M_(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!M_(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const i=a[n];if(!(i==="_owner"&&e.$$typeof)&&!M_(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function mZ(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Oq(e,t){const r=mZ(e);return Math.round(t*r)/r}function kA(e){const t=p.useRef(e);return Cj(()=>{t.current=e}),t}function W9e(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:i,floating:s}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,f]=p.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[m,h]=p.useState(n);M_(m,n)||h(n);const[v,g]=p.useState(null),[x,y]=p.useState(null),b=p.useCallback($=>{$!==S.current&&(S.current=$,g($))},[]),w=p.useCallback($=>{$!==k.current&&(k.current=$,y($))},[]),j=i||v,_=s||x,S=p.useRef(null),k=p.useRef(null),E=p.useRef(u),A=c!=null,M=kA(c),C=kA(a),T=kA(d),I=p.useCallback(()=>{if(!S.current||!k.current)return;const $={placement:t,strategy:r,middleware:m};C.current&&($.platform=C.current),z9e(S.current,k.current,$).then(K=>{const ce={...K,isPositioned:T.current!==!1};D.current&&!M_(E.current,ce)&&(E.current=ce,zf.flushSync(()=>{f(ce)}))})},[m,t,r,C,T]);Cj(()=>{d===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,f($=>({...$,isPositioned:!1})))},[d]);const D=p.useRef(!1);Cj(()=>(D.current=!0,()=>{D.current=!1}),[]),Cj(()=>{if(j&&(S.current=j),_&&(k.current=_),j&&_){if(M.current)return M.current(j,_,I);I()}},[j,_,I,M,A]);const F=p.useMemo(()=>({reference:S,floating:k,setReference:b,setFloating:w}),[b,w]),z=p.useMemo(()=>({reference:j,floating:_}),[j,_]),q=p.useMemo(()=>{const $={position:r,left:0,top:0};if(!z.floating)return $;const K=Oq(z.floating,u.x),ce=Oq(z.floating,u.y);return l?{...$,transform:"translate("+K+"px, "+ce+"px)",...mZ(z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:K,top:ce}},[r,l,z.floating,u.x,u.y]);return p.useMemo(()=>({...u,update:I,refs:F,elements:z,floatingStyles:q}),[u,I,F,z,q])}const H9e=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?kq({element:n.current,padding:a}).fn(r):{}:n?kq({element:n,padding:a}).fn(r):{}}}},G9e=(e,t)=>({...R9e(e),options:[e,t]}),K9e=(e,t)=>({...L9e(e),options:[e,t]}),Y9e=(e,t)=>({...q9e(e),options:[e,t]}),X9e=(e,t)=>({...$9e(e),options:[e,t]}),J9e=(e,t)=>({...F9e(e),options:[e,t]}),Q9e=(e,t)=>({...B9e(e),options:[e,t]}),Z9e=(e,t)=>({...H9e(e),options:[e,t]});var eUe="Arrow",hZ=p.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...i}=e;return o.jsx(Hn.svg,{...i,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:o.jsx("polygon",{points:"0,0 30,0 15,10"})})});hZ.displayName=eUe;var tUe=hZ;function pZ(e){const[t,r]=p.useState(void 0);return Ss(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let s,l;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;s=d.inlineSize,l=d.blockSize}else s=e.offsetWidth,l=e.offsetHeight;r({width:s,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var GD="Popper",[gZ,x0]=bd(GD),[rUe,vZ]=gZ(GD),xZ=e=>{const{__scopePopper:t,children:r}=e,[n,a]=p.useState(null);return o.jsx(rUe,{scope:t,anchor:n,onAnchorChange:a,children:r})};xZ.displayName=GD;var yZ="PopperAnchor",bZ=p.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,i=vZ(yZ,r),s=p.useRef(null),l=Ia(t,s),c=p.useRef(null);return p.useEffect(()=>{const d=c.current;c.current=n?.current||s.current,d!==c.current&&i.onAnchorChange(c.current)}),n?null:o.jsx(Hn.div,{...a,ref:l})});bZ.displayName=yZ;var KD="PopperContent",[nUe,aUe]=gZ(KD),wZ=p.forwardRef((e,t)=>{const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:i="center",alignOffset:s=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:m=!1,updatePositionStrategy:h="optimized",onPlaced:v,...g}=e,x=vZ(KD,r),[y,b]=p.useState(null),w=Ia(t,G=>b(G)),[j,_]=p.useState(null),S=pZ(j),k=S?.width??0,E=S?.height??0,A=n+(i!=="center"?"-"+i:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},C=Array.isArray(d)?d:[d],T=C.length>0,I={padding:M,boundary:C.filter(iUe),altBoundary:T},{refs:D,floatingStyles:F,placement:z,isPositioned:q,middlewareData:$}=W9e({strategy:"fixed",placement:A,whileElementsMounted:(...G)=>M9e(...G,{animationFrame:h==="always"}),elements:{reference:x.anchor},middleware:[G9e({mainAxis:a+E,alignmentAxis:s}),c&&K9e({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?Y9e():void 0,...I}),c&&X9e({...I}),J9e({...I,apply:({elements:G,rects:Q,availableWidth:ae,availableHeight:J})=>{const{width:je,height:be}=Q.reference,Ue=G.floating.style;Ue.setProperty("--radix-popper-available-width",`${ae}px`),Ue.setProperty("--radix-popper-available-height",`${J}px`),Ue.setProperty("--radix-popper-anchor-width",`${je}px`),Ue.setProperty("--radix-popper-anchor-height",`${be}px`)}}),j&&Z9e({element:j,padding:l}),sUe({arrowWidth:k,arrowHeight:E}),m&&Q9e({strategy:"referenceHidden",...I})]}),[K,ce]=_Z(z),fe=$l(v);Ss(()=>{q&&fe?.()},[q,fe]);const B=$.arrow?.x,L=$.arrow?.y,V=$.arrow?.centerOffset!==0,[re,me]=p.useState();return Ss(()=>{y&&me(window.getComputedStyle(y).zIndex)},[y]),o.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...F,transform:q?F.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[$.transformOrigin?.x,$.transformOrigin?.y].join(" "),...$.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:o.jsx(nUe,{scope:r,placedSide:K,onArrowChange:_,arrowX:B,arrowY:L,shouldHideArrow:V,children:o.jsx(Hn.div,{"data-side":K,"data-align":ce,...g,ref:w,style:{...g.style,animation:q?void 0:"none"}})})})});wZ.displayName=KD;var jZ="PopperArrow",oUe={top:"bottom",right:"left",bottom:"top",left:"right"},NZ=p.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,i=aUe(jZ,n),s=oUe[i.placedSide];return o.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:o.jsx(tUe,{...a,ref:r,style:{...a.style,display:"block"}})})});NZ.displayName=jZ;function iUe(e){return e!==null}var sUe=e=>({name:"transformOrigin",options:e,fn(t){const{placement:r,rects:n,middlewareData:a}=t,s=a.arrow?.centerOffset!==0,l=s?0:e.arrowWidth,c=s?0:e.arrowHeight,[d,u]=_Z(r),f={start:"0%",center:"50%",end:"100%"}[u],m=(a.arrow?.x??0)+l/2,h=(a.arrow?.y??0)+c/2;let v="",g="";return d==="bottom"?(v=s?f:`${m}px`,g=`${-c}px`):d==="top"?(v=s?f:`${m}px`,g=`${n.floating.height+c}px`):d==="right"?(v=`${-c}px`,g=s?f:`${h}px`):d==="left"&&(v=`${n.floating.width+c}px`,g=s?f:`${h}px`),{data:{x:v,y:g}}}});function _Z(e){const[t,r="center"]=e.split("-");return[t,r]}var YD=xZ,GC=bZ,XD=wZ,JD=NZ,KC="Popover",[SZ,glt]=bd(KC,[x0]),sw=x0(),[lUe,kh]=SZ(KC),CZ=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:s=!1}=e,l=sw(t),c=p.useRef(null),[d,u]=p.useState(!1),[f,m]=Df({prop:n,defaultProp:a??!1,onChange:i,caller:KC});return o.jsx(YD,{...l,children:o.jsx(lUe,{scope:t,contentId:Yd(),triggerRef:c,open:f,onOpenChange:m,onOpenToggle:p.useCallback(()=>m(h=>!h),[m]),hasCustomAnchor:d,onCustomAnchorAdd:p.useCallback(()=>u(!0),[]),onCustomAnchorRemove:p.useCallback(()=>u(!1),[]),modal:s,children:r})})};CZ.displayName=KC;var PZ="PopoverAnchor",cUe=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=kh(PZ,r),i=sw(r),{onCustomAnchorAdd:s,onCustomAnchorRemove:l}=a;return p.useEffect(()=>(s(),()=>l()),[s,l]),o.jsx(GC,{...i,...n,ref:t})});cUe.displayName=PZ;var AZ="PopoverTrigger",EZ=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=kh(AZ,r),i=sw(r),s=Ia(t,a.triggerRef),l=o.jsx(Hn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":DZ(a.open),...n,ref:s,onClick:Qr(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:o.jsx(GC,{asChild:!0,...i,children:l})});EZ.displayName=AZ;var QD="PopoverPortal",[dUe,uUe]=SZ(QD,{forceMount:void 0}),kZ=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,i=kh(QD,t);return o.jsx(dUe,{scope:t,forceMount:r,children:o.jsx(Ac,{present:r||i.open,children:o.jsx(e0,{asChild:!0,container:a,children:n})})})};kZ.displayName=QD;var Fx="PopoverContent",OZ=p.forwardRef((e,t)=>{const r=uUe(Fx,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,i=kh(Fx,e.__scopePopover);return o.jsx(Ac,{present:n||i.open,children:i.modal?o.jsx(mUe,{...a,ref:t}):o.jsx(hUe,{...a,ref:t})})});OZ.displayName=Fx;var fUe=fh("PopoverContent.RemoveScroll"),mUe=p.forwardRef((e,t)=>{const r=kh(Fx,e.__scopePopover),n=p.useRef(null),a=Ia(t,n),i=p.useRef(!1);return p.useEffect(()=>{const s=n.current;if(s)return zS(s)},[]),o.jsx(qS,{as:fUe,allowPinchZoom:!0,children:o.jsx(TZ,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Qr(e.onCloseAutoFocus,s=>{s.preventDefault(),i.current||r.triggerRef.current?.focus()}),onPointerDownOutside:Qr(e.onPointerDownOutside,s=>{const l=s.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;i.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:Qr(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),hUe=p.forwardRef((e,t)=>{const r=kh(Fx,e.__scopePopover),n=p.useRef(!1),a=p.useRef(!1);return o.jsx(TZ,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{e.onCloseAutoFocus?.(i),i.defaultPrevented||(n.current||r.triggerRef.current?.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{e.onInteractOutside?.(i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=i.target;r.triggerRef.current?.contains(s)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),TZ=p.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...f}=e,m=kh(Fx,r),h=sw(r);return FS(),o.jsx(K1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:o.jsx(Zx,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>m.onOpenChange(!1),children:o.jsx(XD,{"data-state":DZ(m.open),role:"dialog",id:m.contentId,...h,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),IZ="PopoverClose",pUe=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=kh(IZ,r);return o.jsx(Hn.button,{type:"button",...n,ref:t,onClick:Qr(e.onClick,()=>a.onOpenChange(!1))})});pUe.displayName=IZ;var gUe="PopoverArrow",vUe=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=sw(r);return o.jsx(JD,{...a,...n,ref:t})});vUe.displayName=gUe;function DZ(e){return e?"open":"closed"}var xUe=CZ,yUe=EZ,bUe=kZ,MZ=OZ;const yc=xUe,bc=yUe,Ml=xe.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>o.jsx(bUe,{container:document.body,children:o.jsx(MZ,{ref:a,align:t,sideOffset:r,className:Jt("z-[9999] w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Ml.displayName=MZ.displayName;var Kn=function(){return Kn=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Kn.apply(this,arguments)};function wUe(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function RZ(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function lw(e){return e.mode==="multiple"}function cw(e){return e.mode==="range"}function YC(e){return e.mode==="single"}var jUe={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function NUe(e,t){return Xt(e,"LLLL y",t)}function _Ue(e,t){return Xt(e,"d",t)}function SUe(e,t){return Xt(e,"LLLL",t)}function CUe(e){return"".concat(e)}function PUe(e,t){return Xt(e,"cccccc",t)}function AUe(e,t){return Xt(e,"yyyy",t)}var EUe=Object.freeze({__proto__:null,formatCaption:NUe,formatDay:_Ue,formatMonthCaption:SUe,formatWeekNumber:CUe,formatWeekdayName:PUe,formatYearCaption:AUe}),kUe=function(e,t,r){return Xt(e,"do MMMM (EEEE)",r)},OUe=function(){return"Month: "},TUe=function(){return"Go to next month"},IUe=function(){return"Go to previous month"},DUe=function(e,t){return Xt(e,"cccc",t)},MUe=function(e){return"Week n. ".concat(e)},RUe=function(){return"Year: "},LUe=Object.freeze({__proto__:null,labelDay:kUe,labelMonthDropdown:OUe,labelNext:TUe,labelPrevious:IUe,labelWeekNumber:MUe,labelWeekday:DUe,labelYearDropdown:RUe});function $Ue(){var e="buttons",t=jUe,r=iY,n={},a={},i=1,s={},l=new Date;return{captionLayout:e,classNames:t,formatters:EUe,labels:LUe,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:i,styles:s,today:l,mode:"default"}}function FUe(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,i=e.fromDate,s=e.toDate;return n?i=pl(n):t&&(i=new Date(t,0,1)),a?s=XS(a):r&&(s=new Date(r,11,31)),{fromDate:i?ti(i):void 0,toDate:s?ti(s):void 0}}var LZ=p.createContext(void 0);function BUe(e){var t,r=e.initialProps,n=$Ue(),a=FUe(r),i=a.fromDate,s=a.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;l!=="buttons"&&(!i||!s)&&(l="buttons");var c;(YC(r)||lw(r)||cw(r))&&(c=r.onSelect);var d=Kn(Kn(Kn({},n),r),{captionLayout:l,classNames:Kn(Kn({},n.classNames),r.classNames),components:Kn({},r.components),formatters:Kn(Kn({},n.formatters),r.formatters),fromDate:i,labels:Kn(Kn({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:Kn(Kn({},n.modifiers),r.modifiers),modifiersClassNames:Kn(Kn({},n.modifiersClassNames),r.modifiersClassNames),onSelect:c,styles:Kn(Kn({},n.styles),r.styles),toDate:s});return o.jsx(LZ.Provider,{value:d,children:e.children})}function So(){var e=p.useContext(LZ);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function $Z(e){var t=So(),r=t.locale,n=t.classNames,a=t.styles,i=t.formatters.formatCaption;return o.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:r})})}function qUe(e){return o.jsx("svg",Kn({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:o.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function FZ(e){var t,r,n=e.onChange,a=e.value,i=e.children,s=e.caption,l=e.className,c=e.style,d=So(),u=(r=(t=d.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:qUe;return o.jsxs("div",{className:l,style:c,children:[o.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),o.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:a,onChange:n,children:i}),o.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[s,o.jsx(u,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function zUe(e){var t,r=So(),n=r.fromDate,a=r.toDate,i=r.styles,s=r.locale,l=r.formatters.formatMonthCaption,c=r.classNames,d=r.components,u=r.labels.labelMonthDropdown;if(!n)return o.jsx(o.Fragment,{});if(!a)return o.jsx(o.Fragment,{});var f=[];if(Zbe(n,a))for(var m=pl(n),h=n.getMonth();h<=a.getMonth();h++)f.push(QP(m,h));else for(var m=pl(new Date),h=0;h<=11;h++)f.push(QP(m,h));var v=function(x){var y=Number(x.target.value),b=QP(pl(e.displayMonth),y);e.onChange(b)},g=(t=d?.Dropdown)!==null&&t!==void 0?t:FZ;return o.jsx(g,{name:"months","aria-label":u(),className:c.dropdown_month,style:i.dropdown_month,onChange:v,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:s}),children:f.map(function(x){return o.jsx("option",{value:x.getMonth(),children:l(x,{locale:s})},x.getMonth())})})}function UUe(e){var t,r=e.displayMonth,n=So(),a=n.fromDate,i=n.toDate,s=n.locale,l=n.styles,c=n.classNames,d=n.components,u=n.formatters.formatYearCaption,f=n.labels.labelYearDropdown,m=[];if(!a)return o.jsx(o.Fragment,{});if(!i)return o.jsx(o.Fragment,{});for(var h=a.getFullYear(),v=i.getFullYear(),g=h;g<=v;g++)m.push(oF(Eye(new Date),g));var x=function(b){var w=oF(pl(r),Number(b.target.value));e.onChange(w)},y=(t=d?.Dropdown)!==null&&t!==void 0?t:FZ;return o.jsx(y,{name:"years","aria-label":f(),className:c.dropdown_year,style:l.dropdown_year,onChange:x,value:r.getFullYear(),caption:u(r,{locale:s}),children:m.map(function(b){return o.jsx("option",{value:b.getFullYear(),children:u(b,{locale:s})},b.getFullYear())})})}function VUe(e,t){var r=p.useState(e),n=r[0],a=r[1],i=t===void 0?n:t;return[i,a]}function WUe(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,i=e.toDate,s=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(i&&Db(i,a)<0){var d=-1*(c-1);a=Zd(i,d)}return s&&Db(a,s)<0&&(a=s),pl(a)}function HUe(){var e=So(),t=WUe(e),r=VUe(t,e.month),n=r[0],a=r[1],i=function(s){var l;if(!e.disableNavigation){var c=pl(s);a(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[n,i]}function GUe(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=pl(e),i=pl(Zd(a,n)),s=Db(i,a),l=[],c=0;c<s;c++){var d=Zd(a,c);l.push(d)}return r&&(l=l.reverse()),l}function KUe(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,s=n?i:1,l=pl(e);if(!r)return Zd(l,s);var c=Db(r,e);if(!(c<i))return Zd(l,s)}}function YUe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,s=n?i:1,l=pl(e);if(!r)return Zd(l,-s);var c=Db(l,r);if(!(c<=0))return Zd(l,-s)}}var BZ=p.createContext(void 0);function XUe(e){var t=So(),r=HUe(),n=r[0],a=r[1],i=GUe(n,t),s=KUe(n,t),l=YUe(n,t),c=function(f){return i.some(function(m){return OI(f,m)})},d=function(f,m){c(f)||(m&&sY(f,m)?a(Zd(f,1+t.numberOfMonths*-1)):a(f))},u={currentMonth:n,displayMonths:i,goToMonth:a,goToDate:d,previousMonth:l,nextMonth:s,isDateDisplayed:c};return o.jsx(BZ.Provider,{value:u,children:e.children})}function dw(){var e=p.useContext(BZ);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function Tq(e){var t,r=So(),n=r.classNames,a=r.styles,i=r.components,s=dw().goToMonth,l=function(u){s(Zd(u,e.displayIndex?-e.displayIndex:0))},c=(t=i?.CaptionLabel)!==null&&t!==void 0?t:$Z,d=o.jsx(c,{id:e.id,displayMonth:e.displayMonth});return o.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[o.jsx("div",{className:n.vhidden,children:d}),o.jsx(zUe,{onChange:l,displayMonth:e.displayMonth}),o.jsx(UUe,{onChange:l,displayMonth:e.displayMonth})]})}function JUe(e){return o.jsx("svg",Kn({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:o.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function QUe(e){return o.jsx("svg",Kn({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:o.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var R_=p.forwardRef(function(e,t){var r=So(),n=r.classNames,a=r.styles,i=[n.button_reset,n.button];e.className&&i.push(e.className);var s=i.join(" "),l=Kn(Kn({},a.button_reset),a.button);return e.style&&Object.assign(l,e.style),o.jsx("button",Kn({},e,{ref:t,type:"button",className:s,style:l}))});function ZUe(e){var t,r,n=So(),a=n.dir,i=n.locale,s=n.classNames,l=n.styles,c=n.labels,d=c.labelPrevious,u=c.labelNext,f=n.components;if(!e.nextMonth&&!e.previousMonth)return o.jsx(o.Fragment,{});var m=d(e.previousMonth,{locale:i}),h=[s.nav_button,s.nav_button_previous].join(" "),v=u(e.nextMonth,{locale:i}),g=[s.nav_button,s.nav_button_next].join(" "),x=(t=f?.IconRight)!==null&&t!==void 0?t:QUe,y=(r=f?.IconLeft)!==null&&r!==void 0?r:JUe;return o.jsxs("div",{className:s.nav,style:l.nav,children:[!e.hidePrevious&&o.jsx(R_,{name:"previous-month","aria-label":m,className:h,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?o.jsx(x,{className:s.nav_icon,style:l.nav_icon}):o.jsx(y,{className:s.nav_icon,style:l.nav_icon})}),!e.hideNext&&o.jsx(R_,{name:"next-month","aria-label":v,className:g,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?o.jsx(y,{className:s.nav_icon,style:l.nav_icon}):o.jsx(x,{className:s.nav_icon,style:l.nav_icon})})]})}function Iq(e){var t=So().numberOfMonths,r=dw(),n=r.previousMonth,a=r.nextMonth,i=r.goToMonth,s=r.displayMonths,l=s.findIndex(function(v){return OI(e.displayMonth,v)}),c=l===0,d=l===s.length-1,u=t>1&&(c||!d),f=t>1&&(d||!c),m=function(){n&&i(n)},h=function(){a&&i(a)};return o.jsx(ZUe,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:f,nextMonth:a,previousMonth:n,onPreviousClick:m,onNextClick:h})}function eVe(e){var t,r=So(),n=r.classNames,a=r.disableNavigation,i=r.styles,s=r.captionLayout,l=r.components,c=(t=l?.CaptionLabel)!==null&&t!==void 0?t:$Z,d;return a?d=o.jsx(c,{id:e.id,displayMonth:e.displayMonth}):s==="dropdown"?d=o.jsx(Tq,{displayMonth:e.displayMonth,id:e.id}):s==="dropdown-buttons"?d=o.jsxs(o.Fragment,{children:[o.jsx(Tq,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),o.jsx(Iq,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):d=o.jsxs(o.Fragment,{children:[o.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),o.jsx(Iq,{displayMonth:e.displayMonth,id:e.id})]}),o.jsx("div",{className:n.caption,style:i.caption,children:d})}function tVe(e){var t=So(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?o.jsx("tfoot",{className:a,style:n.tfoot,children:o.jsx("tr",{children:o.jsx("td",{colSpan:8,children:r})})}):o.jsx(o.Fragment,{})}function rVe(e,t,r){for(var n=r?Gp(new Date):vd(new Date,{locale:e,weekStartsOn:t}),a=[],i=0;i<7;i++){var s=Oa(n,i);a.push(s)}return a}function nVe(){var e=So(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,i=e.weekStartsOn,s=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,d=rVe(a,i,s);return o.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&o.jsx("td",{style:r.head_cell,className:t.head_cell}),d.map(function(u,f){return o.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":c(u,{locale:a}),children:l(u,{locale:a})},f)})]})}function aVe(){var e,t=So(),r=t.classNames,n=t.styles,a=t.components,i=(e=a?.HeadRow)!==null&&e!==void 0?e:nVe;return o.jsx("thead",{style:n.head,className:r.head,children:o.jsx(i,{})})}function oVe(e){var t=So(),r=t.locale,n=t.formatters.formatDay;return o.jsx(o.Fragment,{children:n(e.date,{locale:r})})}var ZD=p.createContext(void 0);function iVe(e){if(!lw(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return o.jsx(ZD.Provider,{value:t,children:e.children})}return o.jsx(sVe,{initialProps:e.initialProps,children:e.children})}function sVe(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,i=t.max,s=function(d,u,f){var m,h;(m=t.onDayClick)===null||m===void 0||m.call(t,d,u,f);var v=!!(u.selected&&a&&n?.length===a);if(!v){var g=!!(!u.selected&&i&&n?.length===i);if(!g){var x=n?RZ([],n,!0):[];if(u.selected){var y=x.findIndex(function(b){return zs(d,b)});x.splice(y,1)}else x.push(d);(h=t.onSelect)===null||h===void 0||h.call(t,x,d,u,f)}}},l={disabled:[]};n&&l.disabled.push(function(d){var u=i&&n.length>i-1,f=n.some(function(m){return zs(m,d)});return!!(u&&!f)});var c={selected:n,onDayClick:s,modifiers:l};return o.jsx(ZD.Provider,{value:c,children:r})}function eM(){var e=p.useContext(ZD);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function lVe(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?zs(a,e)&&zs(n,e)?void 0:zs(a,e)?{from:a,to:void 0}:zs(n,e)?void 0:cO(n,e)?{from:e,to:a}:{from:n,to:e}:a?cO(e,a)?{from:a,to:e}:{from:e,to:a}:n?sY(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var tM=p.createContext(void 0);function cVe(e){if(!cw(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return o.jsx(tM.Provider,{value:t,children:e.children})}return o.jsx(dVe,{initialProps:e.initialProps,children:e.children})}function dVe(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},i=a.from,s=a.to,l=t.min,c=t.max,d=function(h,v,g){var x,y;(x=t.onDayClick)===null||x===void 0||x.call(t,h,v,g);var b=lVe(h,n);(y=t.onSelect)===null||y===void 0||y.call(t,b,h,v,g)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(u.range_start=[i],s?(u.range_end=[s],zs(i,s)||(u.range_middle=[{after:i,before:s}])):u.range_end=[i]):s&&(u.range_start=[s],u.range_end=[s]),l&&(i&&!s&&u.disabled.push({after:By(i,l-1),before:Oa(i,l-1)}),i&&s&&u.disabled.push({after:i,before:Oa(i,l-1)}),!i&&s&&u.disabled.push({after:By(s,l-1),before:Oa(s,l-1)})),c){if(i&&!s&&(u.disabled.push({before:Oa(i,-c+1)}),u.disabled.push({after:Oa(i,c-1)})),i&&s){var f=Su(s,i)+1,m=c-f;u.disabled.push({before:By(i,m)}),u.disabled.push({after:Oa(s,m)})}!i&&s&&(u.disabled.push({before:Oa(s,-c+1)}),u.disabled.push({after:Oa(s,c-1)}))}return o.jsx(tM.Provider,{value:{selected:n,onDayClick:d,modifiers:u},children:r})}function rM(){var e=p.useContext(tM);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function Pj(e){return Array.isArray(e)?RZ([],e,!0):e!==void 0?[e]:[]}function uVe(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=Pj(a)}),t}var ru;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(ru||(ru={}));var fVe=ru.Selected,rf=ru.Disabled,mVe=ru.Hidden,hVe=ru.Today,OA=ru.RangeEnd,TA=ru.RangeMiddle,IA=ru.RangeStart,pVe=ru.Outside;function gVe(e,t,r){var n,a=(n={},n[fVe]=Pj(e.selected),n[rf]=Pj(e.disabled),n[mVe]=Pj(e.hidden),n[hVe]=[e.today],n[OA]=[],n[TA]=[],n[IA]=[],n[pVe]=[],n);return e.fromDate&&a[rf].push({before:e.fromDate}),e.toDate&&a[rf].push({after:e.toDate}),lw(e)?a[rf]=a[rf].concat(t.modifiers[rf]):cw(e)&&(a[rf]=a[rf].concat(r.modifiers[rf]),a[IA]=r.modifiers[IA],a[TA]=r.modifiers[TA],a[OA]=r.modifiers[OA]),a}var qZ=p.createContext(void 0);function vVe(e){var t=So(),r=eM(),n=rM(),a=gVe(t,r,n),i=uVe(t.modifiers),s=Kn(Kn({},a),i);return o.jsx(qZ.Provider,{value:s,children:e.children})}function zZ(){var e=p.useContext(qZ);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function xVe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function yVe(e){return!!(e&&typeof e=="object"&&"from"in e)}function bVe(e){return!!(e&&typeof e=="object"&&"after"in e)}function wVe(e){return!!(e&&typeof e=="object"&&"before"in e)}function jVe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function NVe(e,t){var r,n=t.from,a=t.to;if(n&&a){var i=Su(a,n)<0;i&&(r=[a,n],n=r[0],a=r[1]);var s=Su(e,n)>=0&&Su(a,e)>=0;return s}return a?zs(a,e):n?zs(n,e):!1}function _Ve(e){return EI(e)}function SVe(e){return Array.isArray(e)&&e.every(EI)}function CVe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(_Ve(r))return zs(e,r);if(SVe(r))return r.includes(e);if(yVe(r))return NVe(e,r);if(jVe(r))return r.dayOfWeek.includes(e.getDay());if(xVe(r)){var n=Su(r.before,e),a=Su(r.after,e),i=n>0,s=a<0,l=cO(r.before,r.after);return l?s&&i:i||s}return bVe(r)?Su(e,r.after)>0:wVe(r)?Su(r.before,e)>0:typeof r=="function"?r(e):!1})}function nM(e,t,r){var n=Object.keys(t).reduce(function(i,s){var l=t[s];return CVe(e,l)&&i.push(s),i},[]),a={};return n.forEach(function(i){return a[i]=!0}),r&&!OI(e,r)&&(a.outside=!0),a}function PVe(e,t){for(var r=pl(e[0]),n=XS(e[e.length-1]),a,i,s=r;s<=n;){var l=nM(s,t),c=!l.disabled&&!l.hidden;if(!c){s=Oa(s,1);continue}if(l.selected)return s;l.today&&!i&&(i=s),a||(a=s),s=Oa(s,1)}return i||a}var AVe=365;function UZ(e,t){var r=t.moveBy,n=t.direction,a=t.context,i=t.modifiers,s=t.retry,l=s===void 0?{count:0,lastFocused:e}:s,c=a.weekStartsOn,d=a.fromDate,u=a.toDate,f=a.locale,m={day:Oa,week:lO,month:Zd,year:jye,startOfWeek:function(x){return a.ISOWeek?Gp(x):vd(x,{locale:f,weekStartsOn:c})},endOfWeek:function(x){return a.ISOWeek?tY(x):kI(x,{locale:f,weekStartsOn:c})}},h=m[r](e,n==="after"?1:-1);n==="before"&&d?h=Nye([d,h]):n==="after"&&u&&(h=_ye([u,h]));var v=!0;if(i){var g=nM(h,i);v=!g.disabled&&!g.hidden}return v?h:l.count>AVe?l.lastFocused:UZ(h,{moveBy:r,direction:n,context:a,modifiers:i,retry:Kn(Kn({},l),{count:l.count+1})})}var VZ=p.createContext(void 0);function EVe(e){var t=dw(),r=zZ(),n=p.useState(),a=n[0],i=n[1],s=p.useState(),l=s[0],c=s[1],d=PVe(t.displayMonths,r),u=a??(l&&t.isDateDisplayed(l))?l:d,f=function(){c(a),i(void 0)},m=function(x){i(x)},h=So(),v=function(x,y){if(a){var b=UZ(a,{moveBy:x,direction:y,context:h,modifiers:r});zs(a,b)||(t.goToDate(b,a),m(b))}},g={focusedDay:a,focusTarget:u,blur:f,focus:m,focusDayAfter:function(){return v("day","after")},focusDayBefore:function(){return v("day","before")},focusWeekAfter:function(){return v("week","after")},focusWeekBefore:function(){return v("week","before")},focusMonthBefore:function(){return v("month","before")},focusMonthAfter:function(){return v("month","after")},focusYearBefore:function(){return v("year","before")},focusYearAfter:function(){return v("year","after")},focusStartOfWeek:function(){return v("startOfWeek","before")},focusEndOfWeek:function(){return v("endOfWeek","after")}};return o.jsx(VZ.Provider,{value:g,children:e.children})}function aM(){var e=p.useContext(VZ);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function kVe(e,t){var r=zZ(),n=nM(e,r,t);return n}var oM=p.createContext(void 0);function OVe(e){if(!YC(e.initialProps)){var t={selected:void 0};return o.jsx(oM.Provider,{value:t,children:e.children})}return o.jsx(TVe,{initialProps:e.initialProps,children:e.children})}function TVe(e){var t=e.initialProps,r=e.children,n=function(i,s,l){var c,d,u;if((c=t.onDayClick)===null||c===void 0||c.call(t,i,s,l),s.selected&&!t.required){(d=t.onSelect)===null||d===void 0||d.call(t,void 0,i,s,l);return}(u=t.onSelect)===null||u===void 0||u.call(t,i,i,s,l)},a={selected:t.selected,onDayClick:n};return o.jsx(oM.Provider,{value:a,children:r})}function WZ(){var e=p.useContext(oM);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function IVe(e,t){var r=So(),n=WZ(),a=eM(),i=rM(),s=aM(),l=s.focusDayAfter,c=s.focusDayBefore,d=s.focusWeekAfter,u=s.focusWeekBefore,f=s.blur,m=s.focus,h=s.focusMonthBefore,v=s.focusMonthAfter,g=s.focusYearBefore,x=s.focusYearAfter,y=s.focusStartOfWeek,b=s.focusEndOfWeek,w=function(q){var $,K,ce,fe;YC(r)?($=n.onDayClick)===null||$===void 0||$.call(n,e,t,q):lw(r)?(K=a.onDayClick)===null||K===void 0||K.call(a,e,t,q):cw(r)?(ce=i.onDayClick)===null||ce===void 0||ce.call(i,e,t,q):(fe=r.onDayClick)===null||fe===void 0||fe.call(r,e,t,q)},j=function(q){var $;m(e),($=r.onDayFocus)===null||$===void 0||$.call(r,e,t,q)},_=function(q){var $;f(),($=r.onDayBlur)===null||$===void 0||$.call(r,e,t,q)},S=function(q){var $;($=r.onDayMouseEnter)===null||$===void 0||$.call(r,e,t,q)},k=function(q){var $;($=r.onDayMouseLeave)===null||$===void 0||$.call(r,e,t,q)},E=function(q){var $;($=r.onDayPointerEnter)===null||$===void 0||$.call(r,e,t,q)},A=function(q){var $;($=r.onDayPointerLeave)===null||$===void 0||$.call(r,e,t,q)},M=function(q){var $;($=r.onDayTouchCancel)===null||$===void 0||$.call(r,e,t,q)},C=function(q){var $;($=r.onDayTouchEnd)===null||$===void 0||$.call(r,e,t,q)},T=function(q){var $;($=r.onDayTouchMove)===null||$===void 0||$.call(r,e,t,q)},I=function(q){var $;($=r.onDayTouchStart)===null||$===void 0||$.call(r,e,t,q)},D=function(q){var $;($=r.onDayKeyUp)===null||$===void 0||$.call(r,e,t,q)},F=function(q){var $;switch(q.key){case"ArrowLeft":q.preventDefault(),q.stopPropagation(),r.dir==="rtl"?l():c();break;case"ArrowRight":q.preventDefault(),q.stopPropagation(),r.dir==="rtl"?c():l();break;case"ArrowDown":q.preventDefault(),q.stopPropagation(),d();break;case"ArrowUp":q.preventDefault(),q.stopPropagation(),u();break;case"PageUp":q.preventDefault(),q.stopPropagation(),q.shiftKey?g():h();break;case"PageDown":q.preventDefault(),q.stopPropagation(),q.shiftKey?x():v();break;case"Home":q.preventDefault(),q.stopPropagation(),y();break;case"End":q.preventDefault(),q.stopPropagation(),b();break}($=r.onDayKeyDown)===null||$===void 0||$.call(r,e,t,q)},z={onClick:w,onFocus:j,onBlur:_,onKeyDown:F,onKeyUp:D,onMouseEnter:S,onMouseLeave:k,onPointerEnter:E,onPointerLeave:A,onTouchCancel:M,onTouchEnd:C,onTouchMove:T,onTouchStart:I};return z}function DVe(){var e=So(),t=WZ(),r=eM(),n=rM(),a=YC(e)?t.selected:lw(e)?r.selected:cw(e)?n.selected:void 0;return a}function MVe(e){return Object.values(ru).includes(e)}function RVe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(MVe(n)){var i=e.classNames["day_".concat(n)];i&&r.push(i)}}),r}function LVe(e,t){var r=Kn({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=Kn(Kn({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function $Ve(e,t,r){var n,a,i,s=So(),l=aM(),c=kVe(e,t),d=IVe(e,c),u=DVe(),f=!!(s.onDayClick||s.mode!=="default");p.useEffect(function(){var S;c.outside||l.focusedDay&&f&&zs(l.focusedDay,e)&&((S=r.current)===null||S===void 0||S.focus())},[l.focusedDay,e,r,f,c.outside]);var m=RVe(s,c).join(" "),h=LVe(s,c),v=!!(c.outside&&!s.showOutsideDays||c.hidden),g=(i=(a=s.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:oVe,x=o.jsx(g,{date:e,displayMonth:t,activeModifiers:c}),y={style:h,className:m,children:x,role:"gridcell"},b=l.focusTarget&&zs(l.focusTarget,e)&&!c.outside,w=l.focusedDay&&zs(l.focusedDay,e),j=Kn(Kn(Kn({},y),(n={disabled:c.disabled,role:"gridcell"},n["aria-selected"]=c.selected,n.tabIndex=w||b?0:-1,n)),d),_={isButton:f,isHidden:v,activeModifiers:c,selectedDays:u,buttonProps:j,divProps:y};return _}function FVe(e){var t=p.useRef(null),r=$Ve(e.date,e.displayMonth,t);return r.isHidden?o.jsx("div",{role:"gridcell"}):r.isButton?o.jsx(R_,Kn({name:"day",ref:t},r.buttonProps)):o.jsx("div",Kn({},r.divProps))}function BVe(e){var t=e.number,r=e.dates,n=So(),a=n.onWeekNumberClick,i=n.styles,s=n.classNames,l=n.locale,c=n.labels.labelWeekNumber,d=n.formatters.formatWeekNumber,u=d(Number(t),{locale:l});if(!a)return o.jsx("span",{className:s.weeknumber,style:i.weeknumber,children:u});var f=c(Number(t),{locale:l}),m=function(h){a(t,r,h)};return o.jsx(R_,{name:"week-number","aria-label":f,className:s.weeknumber,style:i.weeknumber,onClick:m,children:u})}function qVe(e){var t,r,n=So(),a=n.styles,i=n.classNames,s=n.showWeekNumber,l=n.components,c=(t=l?.Day)!==null&&t!==void 0?t:FVe,d=(r=l?.WeekNumber)!==null&&r!==void 0?r:BVe,u;return s&&(u=o.jsx("td",{className:i.cell,style:a.cell,children:o.jsx(d,{number:e.weekNumber,dates:e.dates})})),o.jsxs("tr",{className:i.row,style:a.row,children:[u,e.dates.map(function(f){return o.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:o.jsx(c,{displayMonth:e.displayMonth,date:f})},zbe(f))})]})}function Dq(e,t,r){for(var n=r?.ISOWeek?tY(t):kI(t,r),a=r?.ISOWeek?Gp(e):vd(e,r),i=Su(n,a),s=[],l=0;l<=i;l++)s.push(Oa(a,l));var c=s.reduce(function(d,u){var f=r?.ISOWeek?Bbe(u):Hbe(u,r),m=d.find(function(h){return h.weekNumber===f});return m?(m.dates.push(u),d):(d.push({weekNumber:f,dates:[u]}),d)},[]);return c}function zVe(e,t){var r=Dq(pl(e),XS(e),t);if(t?.useFixedWeeks){var n=Kbe(e,t);if(n<6){var a=r[r.length-1],i=a.dates[a.dates.length-1],s=lO(i,6-n),l=Dq(lO(i,1),s,t);r.push.apply(r,l)}}return r}function UVe(e){var t,r,n,a=So(),i=a.locale,s=a.classNames,l=a.styles,c=a.hideHead,d=a.fixedWeeks,u=a.components,f=a.weekStartsOn,m=a.firstWeekContainsDate,h=a.ISOWeek,v=zVe(e.displayMonth,{useFixedWeeks:!!d,ISOWeek:h,locale:i,weekStartsOn:f,firstWeekContainsDate:m}),g=(t=u?.Head)!==null&&t!==void 0?t:aVe,x=(r=u?.Row)!==null&&r!==void 0?r:qVe,y=(n=u?.Footer)!==null&&n!==void 0?n:tVe;return o.jsxs("table",{id:e.id,className:s.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&o.jsx(g,{}),o.jsx("tbody",{className:s.tbody,style:l.tbody,children:v.map(function(b){return o.jsx(x,{displayMonth:e.displayMonth,dates:b.dates,weekNumber:b.weekNumber},b.weekNumber)})}),o.jsx(y,{displayMonth:e.displayMonth})]})}function VVe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var WVe=VVe()?p.useLayoutEffect:p.useEffect,DA=!1,HVe=0;function Mq(){return"react-day-picker-".concat(++HVe)}function GVe(e){var t,r=e??(DA?Mq():null),n=p.useState(r),a=n[0],i=n[1];return WVe(function(){a===null&&i(Mq())},[]),p.useEffect(function(){DA===!1&&(DA=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function KVe(e){var t,r,n=So(),a=n.dir,i=n.classNames,s=n.styles,l=n.components,c=dw().displayMonths,d=GVe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),u=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,f=[i.month],m=s.month,h=e.displayIndex===0,v=e.displayIndex===c.length-1,g=!h&&!v;a==="rtl"&&(t=[h,v],v=t[0],h=t[1]),h&&(f.push(i.caption_start),m=Kn(Kn({},m),s.caption_start)),v&&(f.push(i.caption_end),m=Kn(Kn({},m),s.caption_end)),g&&(f.push(i.caption_between),m=Kn(Kn({},m),s.caption_between));var x=(r=l?.Caption)!==null&&r!==void 0?r:eVe;return o.jsxs("div",{className:f.join(" "),style:m,children:[o.jsx(x,{id:d,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),o.jsx(UVe,{id:u,"aria-labelledby":d,displayMonth:e.displayMonth})]},e.displayIndex)}function YVe(e){var t=So(),r=t.classNames,n=t.styles;return o.jsx("div",{className:r.months,style:n.months,children:e.children})}function XVe(e){var t,r,n=e.initialProps,a=So(),i=aM(),s=dw(),l=p.useState(!1),c=l[0],d=l[1];p.useEffect(function(){a.initialFocus&&i.focusTarget&&(c||(i.focus(i.focusTarget),d(!0)))},[a.initialFocus,c,i.focus,i.focusTarget,i]);var u=[a.classNames.root,a.className];a.numberOfMonths>1&&u.push(a.classNames.multiple_months),a.showWeekNumber&&u.push(a.classNames.with_weeknumber);var f=Kn(Kn({},a.styles.root),a.style),m=Object.keys(n).filter(function(v){return v.startsWith("data-")}).reduce(function(v,g){var x;return Kn(Kn({},v),(x={},x[g]=n[g],x))},{}),h=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:YVe;return o.jsx("div",Kn({className:u.join(" "),style:f,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},m,{children:o.jsx(h,{children:s.displayMonths.map(function(v,g){return o.jsx(KVe,{displayIndex:g,displayMonth:v},g)})})}))}function JVe(e){var t=e.children,r=wUe(e,["children"]);return o.jsx(BUe,{initialProps:r,children:o.jsx(XUe,{children:o.jsx(OVe,{initialProps:r,children:o.jsx(iVe,{initialProps:r,children:o.jsx(cVe,{initialProps:r,children:o.jsx(vVe,{children:o.jsx(EVe,{children:t})})})})})})})}function V3(e){return o.jsx(JVe,Kn({},e,{children:o.jsx(XVe,{initialProps:e})}))}function wc({className:e,classNames:t,showOutsideDays:r=!0,weekStartsOn:n=1,locale:a=aa,...i}){const s=["dom","seg","ter","qua","qui","sex","sb"];return o.jsx(V3,{showOutsideDays:r,weekStartsOn:n,locale:a,className:Jt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Jt(kb({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Jt(kb({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"text-muted-foreground opacity-50",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},formatters:{formatWeekdayName:(l,c)=>s[l.getDay()]},components:{IconLeft:({...l})=>o.jsx(mH,{className:"h-4 w-4"}),IconRight:({...l})=>o.jsx(Qx,{className:"h-4 w-4"})},...i})}wc.displayName="Calendar";var HZ="AlertDialog",[QVe,vlt]=bd(HZ,[oK]),Kf=oK(),GZ=e=>{const{__scopeAlertDialog:t,...r}=e,n=Kf(t);return o.jsx(wK,{...n,...r,modal:!0})};GZ.displayName=HZ;var ZVe="AlertDialogTrigger",KZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Kf(r);return o.jsx(gve,{...a,...n,ref:t})});KZ.displayName=ZVe;var eWe="AlertDialogPortal",YZ=e=>{const{__scopeAlertDialog:t,...r}=e,n=Kf(t);return o.jsx(jK,{...n,...r})};YZ.displayName=eWe;var tWe="AlertDialogOverlay",XZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Kf(r);return o.jsx(yI,{...a,...n,ref:t})});XZ.displayName=tWe;var Vv="AlertDialogContent",[rWe,nWe]=QVe(Vv),aWe=qpe("AlertDialogContent"),JZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...a}=e,i=Kf(r),s=p.useRef(null),l=Ia(t,s),c=p.useRef(null);return o.jsx(fve,{contentName:Vv,titleName:QZ,docsSlug:"alert-dialog",children:o.jsx(rWe,{scope:r,cancelRef:c,children:o.jsxs(bI,{role:"alertdialog",...i,...a,ref:l,onOpenAutoFocus:Qr(a.onOpenAutoFocus,d=>{d.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[o.jsx(aWe,{children:n}),o.jsx(iWe,{contentRef:s})]})})})});JZ.displayName=Vv;var QZ="AlertDialogTitle",ZZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Kf(r);return o.jsx(wI,{...a,...n,ref:t})});ZZ.displayName=QZ;var eee="AlertDialogDescription",tee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Kf(r);return o.jsx(jI,{...a,...n,ref:t})});tee.displayName=eee;var oWe="AlertDialogAction",ree=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Kf(r);return o.jsx(VS,{...a,...n,ref:t})});ree.displayName=oWe;var nee="AlertDialogCancel",aee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:a}=nWe(nee,r),i=Kf(r),s=Ia(t,a);return o.jsx(VS,{...i,...n,ref:s})});aee.displayName=nee;var iWe=({contentRef:e})=>{const t=`\`${Vv}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Vv}\` by passing a \`${eee}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Vv}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},sWe=GZ,lWe=KZ,cWe=YZ,oee=XZ,iee=JZ,see=ree,lee=aee,cee=ZZ,dee=tee;const qd=sWe,yp=lWe,dWe=cWe,uee=xe.forwardRef(({className:e,...t},r)=>o.jsx(oee,{className:Jt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));uee.displayName=oee.displayName;const Kc=xe.forwardRef(({className:e,...t},r)=>o.jsxs(dWe,{children:[o.jsx(uee,{}),o.jsx(iee,{ref:r,className:Jt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Kc.displayName=iee.displayName;const Yc=({className:e,...t})=>o.jsx("div",{className:Jt("flex flex-col space-y-2 text-center sm:text-left",e),...t});Yc.displayName="AlertDialogHeader";const Xc=({className:e,...t})=>o.jsx("div",{className:Jt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Xc.displayName="AlertDialogFooter";const Jc=xe.forwardRef(({className:e,...t},r)=>o.jsx(cee,{ref:r,className:Jt("text-lg font-semibold",e),...t}));Jc.displayName=cee.displayName;const Qc=xe.forwardRef(({className:e,...t},r)=>o.jsx(dee,{ref:r,className:Jt("text-sm text-muted-foreground",e),...t}));Qc.displayName=dee.displayName;const zd=xe.forwardRef(({className:e,...t},r)=>o.jsx(see,{ref:r,className:Jt(kb(),e),...t}));zd.displayName=see.displayName;const Zc=xe.forwardRef(({className:e,...t},r)=>o.jsx(lee,{ref:r,className:Jt(kb({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Zc.displayName=lee.displayName;function Rq(e,[t,r]){return Math.min(r,Math.max(t,e))}function XC(e){const t=e+"CollectionProvider",[r,n]=bd(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),s=g=>{const{scope:x,children:y}=g,b=xe.useRef(null),w=xe.useRef(new Map).current;return o.jsx(a,{scope:x,itemMap:w,collectionRef:b,children:y})};s.displayName=t;const l=e+"CollectionSlot",c=fh(l),d=xe.forwardRef((g,x)=>{const{scope:y,children:b}=g,w=i(l,y),j=Ia(x,w.collectionRef);return o.jsx(c,{ref:j,children:b})});d.displayName=l;const u=e+"CollectionItemSlot",f="data-radix-collection-item",m=fh(u),h=xe.forwardRef((g,x)=>{const{scope:y,children:b,...w}=g,j=xe.useRef(null),_=Ia(x,j),S=i(u,y);return xe.useEffect(()=>(S.itemMap.set(j,{ref:j,...w}),()=>void S.itemMap.delete(j))),o.jsx(m,{[f]:"",ref:_,children:b})});h.displayName=u;function v(g){const x=i(e+"CollectionConsumer",g);return xe.useCallback(()=>{const b=x.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${f}]`));return Array.from(x.itemMap.values()).sort((S,k)=>w.indexOf(S.ref.current)-w.indexOf(k.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:s,Slot:d,ItemSlot:h},v,n]}var uWe=p.createContext(void 0);function JC(e){const t=p.useContext(uWe);return e||t||"ltr"}function fee(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var mee=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),fWe="VisuallyHidden",iM=p.forwardRef((e,t)=>o.jsx(Hn.span,{...e,ref:t,style:{...mee,...e.style}}));iM.displayName=fWe;var mWe=[" ","Enter","ArrowUp","ArrowDown"],hWe=[" ","Enter"],ng="Select",[QC,ZC,pWe]=XC(ng),[y0,xlt]=bd(ng,[pWe,x0]),e5=x0(),[gWe,Oh]=y0(ng),[vWe,xWe]=y0(ng),hee=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:i,value:s,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:f,disabled:m,required:h,form:v}=e,g=e5(t),[x,y]=p.useState(null),[b,w]=p.useState(null),[j,_]=p.useState(!1),S=JC(d),[k,E]=Df({prop:n,defaultProp:a??!1,onChange:i,caller:ng}),[A,M]=Df({prop:s,defaultProp:l,onChange:c,caller:ng}),C=p.useRef(null),T=x?v||!!x.closest("form"):!0,[I,D]=p.useState(new Set),F=Array.from(I).map(z=>z.props.value).join(";");return o.jsx(YD,{...g,children:o.jsxs(gWe,{required:h,scope:t,trigger:x,onTriggerChange:y,valueNode:b,onValueNodeChange:w,valueNodeHasChildren:j,onValueNodeHasChildrenChange:_,contentId:Yd(),value:A,onValueChange:M,open:k,onOpenChange:E,dir:S,triggerPointerDownPosRef:C,disabled:m,children:[o.jsx(QC.Provider,{scope:t,children:o.jsx(vWe,{scope:e.__scopeSelect,onNativeOptionAdd:p.useCallback(z=>{D(q=>new Set(q).add(z))},[]),onNativeOptionRemove:p.useCallback(z=>{D(q=>{const $=new Set(q);return $.delete(z),$})},[]),children:r})}),T?o.jsxs(Ree,{"aria-hidden":!0,required:h,tabIndex:-1,name:u,autoComplete:f,value:A,onChange:z=>M(z.target.value),disabled:m,form:v,children:[A===void 0?o.jsx("option",{value:""}):null,Array.from(I)]},F):null]})})};hee.displayName=ng;var pee="SelectTrigger",gee=p.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,i=e5(r),s=Oh(pee,r),l=s.disabled||n,c=Ia(t,s.onTriggerChange),d=ZC(r),u=p.useRef("touch"),[f,m,h]=$ee(g=>{const x=d().filter(w=>!w.disabled),y=x.find(w=>w.value===s.value),b=Fee(x,g,y);b!==void 0&&s.onValueChange(b.value)}),v=g=>{l||(s.onOpenChange(!0),h()),g&&(s.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return o.jsx(GC,{asChild:!0,...i,children:o.jsx(Hn.button,{type:"button",role:"combobox","aria-controls":s.contentId,"aria-expanded":s.open,"aria-required":s.required,"aria-autocomplete":"none",dir:s.dir,"data-state":s.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":Lee(s.value)?"":void 0,...a,ref:c,onClick:Qr(a.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&v(g)}),onPointerDown:Qr(a.onPointerDown,g=>{u.current=g.pointerType;const x=g.target;x.hasPointerCapture(g.pointerId)&&x.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(v(g),g.preventDefault())}),onKeyDown:Qr(a.onKeyDown,g=>{const x=f.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&m(g.key),!(x&&g.key===" ")&&mWe.includes(g.key)&&(v(),g.preventDefault())})})})});gee.displayName=pee;var vee="SelectValue",xee=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:i,placeholder:s="",...l}=e,c=Oh(vee,r),{onValueNodeHasChildrenChange:d}=c,u=i!==void 0,f=Ia(t,c.onValueNodeChange);return Ss(()=>{d(u)},[d,u]),o.jsx(Hn.span,{...l,ref:f,style:{pointerEvents:"none"},children:Lee(c.value)?o.jsx(o.Fragment,{children:s}):i})});xee.displayName=vee;var yWe="SelectIcon",yee=p.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return o.jsx(Hn.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});yee.displayName=yWe;var bWe="SelectPortal",bee=e=>o.jsx(e0,{asChild:!0,...e});bee.displayName=bWe;var ag="SelectContent",wee=p.forwardRef((e,t)=>{const r=Oh(ag,e.__scopeSelect),[n,a]=p.useState();if(Ss(()=>{a(new DocumentFragment)},[]),!r.open){const i=n;return i?zf.createPortal(o.jsx(jee,{scope:e.__scopeSelect,children:o.jsx(QC.Slot,{scope:e.__scopeSelect,children:o.jsx("div",{children:e.children})})}),i):null}return o.jsx(Nee,{...e,ref:t})});wee.displayName=ag;var Dd=10,[jee,Th]=y0(ag),wWe="SelectContentImpl",jWe=fh("SelectContent.RemoveScroll"),Nee=p.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:s,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:h,sticky:v,hideWhenDetached:g,avoidCollisions:x,...y}=e,b=Oh(ag,r),[w,j]=p.useState(null),[_,S]=p.useState(null),k=Ia(t,G=>j(G)),[E,A]=p.useState(null),[M,C]=p.useState(null),T=ZC(r),[I,D]=p.useState(!1),F=p.useRef(!1);p.useEffect(()=>{if(w)return zS(w)},[w]),FS();const z=p.useCallback(G=>{const[Q,...ae]=T().map(be=>be.ref.current),[J]=ae.slice(-1),je=document.activeElement;for(const be of G)if(be===je||(be?.scrollIntoView({block:"nearest"}),be===Q&&_&&(_.scrollTop=0),be===J&&_&&(_.scrollTop=_.scrollHeight),be?.focus(),document.activeElement!==je))return},[T,_]),q=p.useCallback(()=>z([E,w]),[z,E,w]);p.useEffect(()=>{I&&q()},[I,q]);const{onOpenChange:$,triggerPointerDownPosRef:K}=b;p.useEffect(()=>{if(w){let G={x:0,y:0};const Q=J=>{G={x:Math.abs(Math.round(J.pageX)-(K.current?.x??0)),y:Math.abs(Math.round(J.pageY)-(K.current?.y??0))}},ae=J=>{G.x<=10&&G.y<=10?J.preventDefault():w.contains(J.target)||$(!1),document.removeEventListener("pointermove",Q),K.current=null};return K.current!==null&&(document.addEventListener("pointermove",Q),document.addEventListener("pointerup",ae,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Q),document.removeEventListener("pointerup",ae,{capture:!0})}}},[w,$,K]),p.useEffect(()=>{const G=()=>$(!1);return window.addEventListener("blur",G),window.addEventListener("resize",G),()=>{window.removeEventListener("blur",G),window.removeEventListener("resize",G)}},[$]);const[ce,fe]=$ee(G=>{const Q=T().filter(je=>!je.disabled),ae=Q.find(je=>je.ref.current===document.activeElement),J=Fee(Q,G,ae);J&&setTimeout(()=>J.ref.current.focus())}),B=p.useCallback((G,Q,ae)=>{const J=!F.current&&!ae;(b.value!==void 0&&b.value===Q||J)&&(A(G),J&&(F.current=!0))},[b.value]),L=p.useCallback(()=>w?.focus(),[w]),V=p.useCallback((G,Q,ae)=>{const J=!F.current&&!ae;(b.value!==void 0&&b.value===Q||J)&&C(G)},[b.value]),re=n==="popper"?W3:_ee,me=re===W3?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:h,sticky:v,hideWhenDetached:g,avoidCollisions:x}:{};return o.jsx(jee,{scope:r,content:w,viewport:_,onViewportChange:S,itemRefCallback:B,selectedItem:E,onItemLeave:L,itemTextRefCallback:V,focusSelectedItem:q,selectedItemText:M,position:n,isPositioned:I,searchRef:ce,children:o.jsx(qS,{as:jWe,allowPinchZoom:!0,children:o.jsx(K1,{asChild:!0,trapped:b.open,onMountAutoFocus:G=>{G.preventDefault()},onUnmountAutoFocus:Qr(a,G=>{b.trigger?.focus({preventScroll:!0}),G.preventDefault()}),children:o.jsx(Zx,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:G=>G.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:o.jsx(re,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:G=>G.preventDefault(),...y,...me,onPlaced:()=>D(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:Qr(y.onKeyDown,G=>{const Q=G.ctrlKey||G.altKey||G.metaKey;if(G.key==="Tab"&&G.preventDefault(),!Q&&G.key.length===1&&fe(G.key),["ArrowUp","ArrowDown","Home","End"].includes(G.key)){let J=T().filter(je=>!je.disabled).map(je=>je.ref.current);if(["ArrowUp","End"].includes(G.key)&&(J=J.slice().reverse()),["ArrowUp","ArrowDown"].includes(G.key)){const je=G.target,be=J.indexOf(je);J=J.slice(be+1)}setTimeout(()=>z(J)),G.preventDefault()}})})})})})})});Nee.displayName=wWe;var NWe="SelectItemAlignedPosition",_ee=p.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,i=Oh(ag,r),s=Th(ag,r),[l,c]=p.useState(null),[d,u]=p.useState(null),f=Ia(t,k=>u(k)),m=ZC(r),h=p.useRef(!1),v=p.useRef(!0),{viewport:g,selectedItem:x,selectedItemText:y,focusSelectedItem:b}=s,w=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&d&&g&&x&&y){const k=i.trigger.getBoundingClientRect(),E=d.getBoundingClientRect(),A=i.valueNode.getBoundingClientRect(),M=y.getBoundingClientRect();if(i.dir!=="rtl"){const je=M.left-E.left,be=A.left-je,Ue=k.left-be,Z=k.width+Ue,Y=Math.max(Z,E.width),lt=window.innerWidth-Dd,gt=Rq(be,[Dd,Math.max(Dd,lt-Y)]);l.style.minWidth=Z+"px",l.style.left=gt+"px"}else{const je=E.right-M.right,be=window.innerWidth-A.right-je,Ue=window.innerWidth-k.right-be,Z=k.width+Ue,Y=Math.max(Z,E.width),lt=window.innerWidth-Dd,gt=Rq(be,[Dd,Math.max(Dd,lt-Y)]);l.style.minWidth=Z+"px",l.style.right=gt+"px"}const C=m(),T=window.innerHeight-Dd*2,I=g.scrollHeight,D=window.getComputedStyle(d),F=parseInt(D.borderTopWidth,10),z=parseInt(D.paddingTop,10),q=parseInt(D.borderBottomWidth,10),$=parseInt(D.paddingBottom,10),K=F+z+I+$+q,ce=Math.min(x.offsetHeight*5,K),fe=window.getComputedStyle(g),B=parseInt(fe.paddingTop,10),L=parseInt(fe.paddingBottom,10),V=k.top+k.height/2-Dd,re=T-V,me=x.offsetHeight/2,G=x.offsetTop+me,Q=F+z+G,ae=K-Q;if(Q<=V){const je=C.length>0&&x===C[C.length-1].ref.current;l.style.bottom="0px";const be=d.clientHeight-g.offsetTop-g.offsetHeight,Ue=Math.max(re,me+(je?L:0)+be+q),Z=Q+Ue;l.style.height=Z+"px"}else{const je=C.length>0&&x===C[0].ref.current;l.style.top="0px";const Ue=Math.max(V,F+g.offsetTop+(je?B:0)+me)+ae;l.style.height=Ue+"px",g.scrollTop=Q-V+g.offsetTop}l.style.margin=`${Dd}px 0`,l.style.minHeight=ce+"px",l.style.maxHeight=T+"px",n?.(),requestAnimationFrame(()=>h.current=!0)}},[m,i.trigger,i.valueNode,l,d,g,x,y,i.dir,n]);Ss(()=>w(),[w]);const[j,_]=p.useState();Ss(()=>{d&&_(window.getComputedStyle(d).zIndex)},[d]);const S=p.useCallback(k=>{k&&v.current===!0&&(w(),b?.(),v.current=!1)},[w,b]);return o.jsx(SWe,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:h,onScrollButtonChange:S,children:o.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:o.jsx(Hn.div,{...a,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});_ee.displayName=NWe;var _We="SelectPopperPosition",W3=p.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=Dd,...i}=e,s=e5(r);return o.jsx(XD,{...s,...i,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});W3.displayName=_We;var[SWe,sM]=y0(ag,{}),H3="SelectViewport",See=p.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,i=Th(H3,r),s=sM(H3,r),l=Ia(t,i.onViewportChange),c=p.useRef(0);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),o.jsx(QC.Slot,{scope:r,children:o.jsx(Hn.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Qr(a.onScroll,d=>{const u=d.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:m}=s;if(m?.current&&f){const h=Math.abs(c.current-u.scrollTop);if(h>0){const v=window.innerHeight-Dd*2,g=parseFloat(f.style.minHeight),x=parseFloat(f.style.height),y=Math.max(g,x);if(y<v){const b=y+h,w=Math.min(v,b),j=b-w;f.style.height=w+"px",f.style.bottom==="0px"&&(u.scrollTop=j>0?j:0,f.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});See.displayName=H3;var Cee="SelectGroup",[CWe,PWe]=y0(Cee),AWe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Yd();return o.jsx(CWe,{scope:r,id:a,children:o.jsx(Hn.div,{role:"group","aria-labelledby":a,...n,ref:t})})});AWe.displayName=Cee;var Pee="SelectLabel",Aee=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=PWe(Pee,r);return o.jsx(Hn.div,{id:a.id,...n,ref:t})});Aee.displayName=Pee;var L_="SelectItem",[EWe,Eee]=y0(L_),kee=p.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:i,...s}=e,l=Oh(L_,r),c=Th(L_,r),d=l.value===n,[u,f]=p.useState(i??""),[m,h]=p.useState(!1),v=Ia(t,b=>c.itemRefCallback?.(b,n,a)),g=Yd(),x=p.useRef("touch"),y=()=>{a||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return o.jsx(EWe,{scope:r,value:n,disabled:a,textId:g,isSelected:d,onItemTextChange:p.useCallback(b=>{f(w=>w||(b?.textContent??"").trim())},[]),children:o.jsx(QC.ItemSlot,{scope:r,value:n,disabled:a,textValue:u,children:o.jsx(Hn.div,{role:"option","aria-labelledby":g,"data-highlighted":m?"":void 0,"aria-selected":d&&m,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...s,ref:v,onFocus:Qr(s.onFocus,()=>h(!0)),onBlur:Qr(s.onBlur,()=>h(!1)),onClick:Qr(s.onClick,()=>{x.current!=="mouse"&&y()}),onPointerUp:Qr(s.onPointerUp,()=>{x.current==="mouse"&&y()}),onPointerDown:Qr(s.onPointerDown,b=>{x.current=b.pointerType}),onPointerMove:Qr(s.onPointerMove,b=>{x.current=b.pointerType,a?c.onItemLeave?.():x.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Qr(s.onPointerLeave,b=>{b.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:Qr(s.onKeyDown,b=>{c.searchRef?.current!==""&&b.key===" "||(hWe.includes(b.key)&&y(),b.key===" "&&b.preventDefault())})})})})});kee.displayName=L_;var vy="SelectItemText",Oee=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...i}=e,s=Oh(vy,r),l=Th(vy,r),c=Eee(vy,r),d=xWe(vy,r),[u,f]=p.useState(null),m=Ia(t,y=>f(y),c.onItemTextChange,y=>l.itemTextRefCallback?.(y,c.value,c.disabled)),h=u?.textContent,v=p.useMemo(()=>o.jsx("option",{value:c.value,disabled:c.disabled,children:h},c.value),[c.disabled,c.value,h]),{onNativeOptionAdd:g,onNativeOptionRemove:x}=d;return Ss(()=>(g(v),()=>x(v)),[g,x,v]),o.jsxs(o.Fragment,{children:[o.jsx(Hn.span,{id:c.textId,...i,ref:m}),c.isSelected&&s.valueNode&&!s.valueNodeHasChildren?zf.createPortal(i.children,s.valueNode):null]})});Oee.displayName=vy;var Tee="SelectItemIndicator",Iee=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return Eee(Tee,r).isSelected?o.jsx(Hn.span,{"aria-hidden":!0,...n,ref:t}):null});Iee.displayName=Tee;var G3="SelectScrollUpButton",kWe=p.forwardRef((e,t)=>{const r=Th(G3,e.__scopeSelect),n=sM(G3,e.__scopeSelect),[a,i]=p.useState(!1),s=Ia(t,n.onScrollButtonChange);return Ss(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;i(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?o.jsx(Dee,{...e,ref:s,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});kWe.displayName=G3;var K3="SelectScrollDownButton",OWe=p.forwardRef((e,t)=>{const r=Th(K3,e.__scopeSelect),n=sM(K3,e.__scopeSelect),[a,i]=p.useState(!1),s=Ia(t,n.onScrollButtonChange);return Ss(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;i(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?o.jsx(Dee,{...e,ref:s,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});OWe.displayName=K3;var Dee=p.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,i=Th("SelectScrollButton",r),s=p.useRef(null),l=ZC(r),c=p.useCallback(()=>{s.current!==null&&(window.clearInterval(s.current),s.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),Ss(()=>{l().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),o.jsx(Hn.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Qr(a.onPointerDown,()=>{s.current===null&&(s.current=window.setInterval(n,50))}),onPointerMove:Qr(a.onPointerMove,()=>{i.onItemLeave?.(),s.current===null&&(s.current=window.setInterval(n,50))}),onPointerLeave:Qr(a.onPointerLeave,()=>{c()})})}),TWe="SelectSeparator",Mee=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return o.jsx(Hn.div,{"aria-hidden":!0,...n,ref:t})});Mee.displayName=TWe;var Y3="SelectArrow",IWe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=e5(r),i=Oh(Y3,r),s=Th(Y3,r);return i.open&&s.position==="popper"?o.jsx(JD,{...a,...n,ref:t}):null});IWe.displayName=Y3;var DWe="SelectBubbleInput",Ree=p.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const a=p.useRef(null),i=Ia(n,a),s=fee(t);return p.useEffect(()=>{const l=a.current;if(!l)return;const c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(s!==t&&u){const f=new Event("change",{bubbles:!0});u.call(l,t),l.dispatchEvent(f)}},[s,t]),o.jsx(Hn.select,{...r,style:{...mee,...r.style},ref:i,defaultValue:t})});Ree.displayName=DWe;function Lee(e){return e===""||e===void 0}function $ee(e){const t=$l(e),r=p.useRef(""),n=p.useRef(0),a=p.useCallback(s=>{const l=r.current+s;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=p.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,i]}function Fee(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let s=MWe(e,Math.max(i,0));a.length===1&&(s=s.filter(d=>d!==r));const c=s.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function MWe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var RWe=hee,Bee=gee,LWe=xee,$We=yee,FWe=bee,qee=wee,BWe=See,zee=Aee,Uee=kee,qWe=Oee,zWe=Iee,Vee=Mee;const En=RWe,kn=LWe,Sn=xe.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(Bee,{ref:n,className:Jt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground hover:bg-surface-2/30 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-150",e),...r,children:[t,o.jsx($We,{asChild:!0,children:o.jsx(z1,{className:"h-4 w-4 opacity-50"})})]}));Sn.displayName=Bee.displayName;const Cn=xe.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>o.jsx(FWe,{children:o.jsx(qee,{ref:a,className:Jt("relative z-50 min-w-[8rem] max-h-[340px] overflow-auto fx-scroll rounded-md border bg-popover text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:o.jsx(BWe,{className:Jt("p-1",r==="popper"&&"w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));Cn.displayName=qee.displayName;const UWe=xe.forwardRef(({className:e,...t},r)=>o.jsx(zee,{ref:r,className:Jt("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));UWe.displayName=zee.displayName;const Nt=xe.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(Uee,{ref:n,className:Jt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-surface-2/50 focus:bg-surface-2/50 data-[state=checked]:bg-surface-2/50 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 transition-colors",e),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(zWe,{children:o.jsx(Tf,{className:"h-4 w-4"})})}),o.jsx(qWe,{children:t})]}));Nt.displayName=Uee.displayName;const VWe=xe.forwardRef(({className:e,...t},r)=>o.jsx(Vee,{ref:r,className:Jt("-mx-1 my-1 h-px bg-muted",e),...t}));VWe.displayName=Vee.displayName;var t5="Checkbox",[WWe,ylt]=bd(t5),[HWe,lM]=WWe(t5);function GWe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:i,form:s,name:l,onCheckedChange:c,required:d,value:u="on",internal_do_not_use_render:f}=e,[m,h]=Df({prop:r,defaultProp:a??!1,onChange:c,caller:t5}),[v,g]=p.useState(null),[x,y]=p.useState(null),b=p.useRef(!1),w=v?!!s||!!v.closest("form"):!0,j={checked:m,disabled:i,setChecked:h,control:v,setControl:g,name:l,form:s,value:u,hasConsumerStoppedPropagationRef:b,required:d,defaultChecked:Zm(a)?!1:a,isFormControl:w,bubbleInput:x,setBubbleInput:y};return o.jsx(HWe,{scope:t,...j,children:KWe(f)?f(j):n})}var Wee="CheckboxTrigger",Hee=p.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},a)=>{const{control:i,value:s,disabled:l,checked:c,required:d,setControl:u,setChecked:f,hasConsumerStoppedPropagationRef:m,isFormControl:h,bubbleInput:v}=lM(Wee,e),g=Ia(a,u),x=p.useRef(c);return p.useEffect(()=>{const y=i?.form;if(y){const b=()=>f(x.current);return y.addEventListener("reset",b),()=>y.removeEventListener("reset",b)}},[i,f]),o.jsx(Hn.button,{type:"button",role:"checkbox","aria-checked":Zm(c)?"mixed":c,"aria-required":d,"data-state":Jee(c),"data-disabled":l?"":void 0,disabled:l,value:s,...n,ref:g,onKeyDown:Qr(t,y=>{y.key==="Enter"&&y.preventDefault()}),onClick:Qr(r,y=>{f(b=>Zm(b)?!0:!b),v&&h&&(m.current=y.isPropagationStopped(),m.current||y.stopPropagation())})})});Hee.displayName=Wee;var cM=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:i,required:s,disabled:l,value:c,onCheckedChange:d,form:u,...f}=e;return o.jsx(GWe,{__scopeCheckbox:r,checked:a,defaultChecked:i,disabled:l,required:s,onCheckedChange:d,name:n,form:u,value:c,internal_do_not_use_render:({isFormControl:m})=>o.jsxs(o.Fragment,{children:[o.jsx(Hee,{...f,ref:t,__scopeCheckbox:r}),m&&o.jsx(Xee,{__scopeCheckbox:r})]})})});cM.displayName=t5;var Gee="CheckboxIndicator",Kee=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=e,i=lM(Gee,r);return o.jsx(Ac,{present:n||Zm(i.checked)||i.checked===!0,children:o.jsx(Hn.span,{"data-state":Jee(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});Kee.displayName=Gee;var Yee="CheckboxBubbleInput",Xee=p.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:i,defaultChecked:s,required:l,disabled:c,name:d,value:u,form:f,bubbleInput:m,setBubbleInput:h}=lM(Yee,e),v=Ia(r,h),g=fee(i),x=pZ(n);p.useEffect(()=>{const b=m;if(!b)return;const w=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(w,"checked").set,S=!a.current;if(g!==i&&_){const k=new Event("click",{bubbles:S});b.indeterminate=Zm(i),_.call(b,Zm(i)?!1:i),b.dispatchEvent(k)}},[m,g,i,a]);const y=p.useRef(Zm(i)?!1:i);return o.jsx(Hn.input,{type:"checkbox","aria-hidden":!0,defaultChecked:s??y.current,required:l,disabled:c,name:d,value:u,form:f,...t,tabIndex:-1,ref:v,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Xee.displayName=Yee;function KWe(e){return typeof e=="function"}function Zm(e){return e==="indeterminate"}function Jee(e){return Zm(e)?"indeterminate":e?"checked":"unchecked"}const Fo=xe.forwardRef(({className:e,...t},r)=>o.jsx(cM,{ref:r,className:Jt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:o.jsx(Kee,{className:Jt("flex items-center justify-center text-current"),children:o.jsx(Tf,{className:"h-4 w-4"})})}));Fo.displayName=cM.displayName;var MA="rovingFocusGroup.onEntryFocus",YWe={bubbles:!1,cancelable:!0},uw="RovingFocusGroup",[X3,Qee,XWe]=XC(uw),[JWe,r5]=bd(uw,[XWe]),[QWe,ZWe]=JWe(uw),Zee=p.forwardRef((e,t)=>o.jsx(X3.Provider,{scope:e.__scopeRovingFocusGroup,children:o.jsx(X3.Slot,{scope:e.__scopeRovingFocusGroup,children:o.jsx(eHe,{...e,ref:t})})}));Zee.displayName=uw;var eHe=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:i,currentTabStopId:s,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...f}=e,m=p.useRef(null),h=Ia(t,m),v=JC(i),[g,x]=Df({prop:s,defaultProp:l??null,onChange:c,caller:uw}),[y,b]=p.useState(!1),w=$l(d),j=Qee(r),_=p.useRef(!1),[S,k]=p.useState(0);return p.useEffect(()=>{const E=m.current;if(E)return E.addEventListener(MA,w),()=>E.removeEventListener(MA,w)},[w]),o.jsx(QWe,{scope:r,orientation:n,dir:v,loop:a,currentTabStopId:g,onItemFocus:p.useCallback(E=>x(E),[x]),onItemShiftTab:p.useCallback(()=>b(!0),[]),onFocusableItemAdd:p.useCallback(()=>k(E=>E+1),[]),onFocusableItemRemove:p.useCallback(()=>k(E=>E-1),[]),children:o.jsx(Hn.div,{tabIndex:y||S===0?-1:0,"data-orientation":n,...f,ref:h,style:{outline:"none",...e.style},onMouseDown:Qr(e.onMouseDown,()=>{_.current=!0}),onFocus:Qr(e.onFocus,E=>{const A=!_.current;if(E.target===E.currentTarget&&A&&!y){const M=new CustomEvent(MA,YWe);if(E.currentTarget.dispatchEvent(M),!M.defaultPrevented){const C=j().filter(z=>z.focusable),T=C.find(z=>z.active),I=C.find(z=>z.id===g),F=[T,I,...C].filter(Boolean).map(z=>z.ref.current);rte(F,u)}}_.current=!1}),onBlur:Qr(e.onBlur,()=>b(!1))})})}),ete="RovingFocusGroupItem",tte=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:i,children:s,...l}=e,c=Yd(),d=i||c,u=ZWe(ete,r),f=u.currentTabStopId===d,m=Qee(r),{onFocusableItemAdd:h,onFocusableItemRemove:v,currentTabStopId:g}=u;return p.useEffect(()=>{if(n)return h(),()=>v()},[n,h,v]),o.jsx(X3.ItemSlot,{scope:r,id:d,focusable:n,active:a,children:o.jsx(Hn.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...l,ref:t,onMouseDown:Qr(e.onMouseDown,x=>{n?u.onItemFocus(d):x.preventDefault()}),onFocus:Qr(e.onFocus,()=>u.onItemFocus(d)),onKeyDown:Qr(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){u.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const y=nHe(x,u.orientation,u.dir);if(y!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let w=m().filter(j=>j.focusable).map(j=>j.ref.current);if(y==="last")w.reverse();else if(y==="prev"||y==="next"){y==="prev"&&w.reverse();const j=w.indexOf(x.currentTarget);w=u.loop?aHe(w,j+1):w.slice(j+1)}setTimeout(()=>rte(w))}}),children:typeof s=="function"?s({isCurrentTabStop:f,hasTabStop:g!=null}):s})})});tte.displayName=ete;var tHe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function rHe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function nHe(e,t,r){const n=rHe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return tHe[n]}function rte(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function aHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var nte=Zee,ate=tte,J3=["Enter"," "],oHe=["ArrowDown","PageUp","Home"],ote=["ArrowUp","PageDown","End"],iHe=[...oHe,...ote],sHe={ltr:[...J3,"ArrowRight"],rtl:[...J3,"ArrowLeft"]},lHe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},fw="Menu",[y1,cHe,dHe]=XC(fw),[wg,ite]=bd(fw,[dHe,x0,r5]),n5=x0(),ste=r5(),[uHe,jg]=wg(fw),[fHe,mw]=wg(fw),lte=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:i,modal:s=!0}=e,l=n5(t),[c,d]=p.useState(null),u=p.useRef(!1),f=$l(i),m=JC(a);return p.useEffect(()=>{const h=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),o.jsx(YD,{...l,children:o.jsx(uHe,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:d,children:o.jsx(fHe,{scope:t,onClose:p.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:m,modal:s,children:n})})})};lte.displayName=fw;var mHe="MenuAnchor",dM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=n5(r);return o.jsx(GC,{...a,...n,ref:t})});dM.displayName=mHe;var uM="MenuPortal",[hHe,cte]=wg(uM,{forceMount:void 0}),dte=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,i=jg(uM,t);return o.jsx(hHe,{scope:t,forceMount:r,children:o.jsx(Ac,{present:r||i.open,children:o.jsx(e0,{asChild:!0,container:a,children:n})})})};dte.displayName=uM;var fd="MenuContent",[pHe,fM]=wg(fd),ute=p.forwardRef((e,t)=>{const r=cte(fd,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=jg(fd,e.__scopeMenu),s=mw(fd,e.__scopeMenu);return o.jsx(y1.Provider,{scope:e.__scopeMenu,children:o.jsx(Ac,{present:n||i.open,children:o.jsx(y1.Slot,{scope:e.__scopeMenu,children:s.modal?o.jsx(gHe,{...a,ref:t}):o.jsx(vHe,{...a,ref:t})})})})}),gHe=p.forwardRef((e,t)=>{const r=jg(fd,e.__scopeMenu),n=p.useRef(null),a=Ia(t,n);return p.useEffect(()=>{const i=n.current;if(i)return zS(i)},[]),o.jsx(mM,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Qr(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),vHe=p.forwardRef((e,t)=>{const r=jg(fd,e.__scopeMenu);return o.jsx(mM,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),xHe=fh("MenuContent.ScrollLock"),mM=p.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:h,disableOutsideScroll:v,...g}=e,x=jg(fd,r),y=mw(fd,r),b=n5(r),w=ste(r),j=cHe(r),[_,S]=p.useState(null),k=p.useRef(null),E=Ia(t,k,x.onContentChange),A=p.useRef(0),M=p.useRef(""),C=p.useRef(0),T=p.useRef(null),I=p.useRef("right"),D=p.useRef(0),F=v?qS:p.Fragment,z=v?{as:xHe,allowPinchZoom:!0}:void 0,q=K=>{const ce=M.current+K,fe=j().filter(G=>!G.disabled),B=document.activeElement,L=fe.find(G=>G.ref.current===B)?.textValue,V=fe.map(G=>G.textValue),re=kHe(V,ce,L),me=fe.find(G=>G.textValue===re)?.ref.current;(function G(Q){M.current=Q,window.clearTimeout(A.current),Q!==""&&(A.current=window.setTimeout(()=>G(""),1e3))})(ce),me&&setTimeout(()=>me.focus())};p.useEffect(()=>()=>window.clearTimeout(A.current),[]),FS();const $=p.useCallback(K=>I.current===T.current?.side&&THe(K,T.current?.area),[]);return o.jsx(pHe,{scope:r,searchRef:M,onItemEnter:p.useCallback(K=>{$(K)&&K.preventDefault()},[$]),onItemLeave:p.useCallback(K=>{$(K)||(k.current?.focus(),S(null))},[$]),onTriggerLeave:p.useCallback(K=>{$(K)&&K.preventDefault()},[$]),pointerGraceTimerRef:C,onPointerGraceIntentChange:p.useCallback(K=>{T.current=K},[]),children:o.jsx(F,{...z,children:o.jsx(K1,{asChild:!0,trapped:a,onMountAutoFocus:Qr(i,K=>{K.preventDefault(),k.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:o.jsx(Zx,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:h,children:o.jsx(nte,{asChild:!0,...w,dir:y.dir,orientation:"vertical",loop:n,currentTabStopId:_,onCurrentTabStopIdChange:S,onEntryFocus:Qr(c,K=>{y.isUsingKeyboardRef.current||K.preventDefault()}),preventScrollOnEntryFocus:!0,children:o.jsx(XD,{role:"menu","aria-orientation":"vertical","data-state":Pte(x.open),"data-radix-menu-content":"",dir:y.dir,...b,...g,ref:E,style:{outline:"none",...g.style},onKeyDown:Qr(g.onKeyDown,K=>{const fe=K.target.closest("[data-radix-menu-content]")===K.currentTarget,B=K.ctrlKey||K.altKey||K.metaKey,L=K.key.length===1;fe&&(K.key==="Tab"&&K.preventDefault(),!B&&L&&q(K.key));const V=k.current;if(K.target!==V||!iHe.includes(K.key))return;K.preventDefault();const me=j().filter(G=>!G.disabled).map(G=>G.ref.current);ote.includes(K.key)&&me.reverse(),AHe(me)}),onBlur:Qr(e.onBlur,K=>{K.currentTarget.contains(K.target)||(window.clearTimeout(A.current),M.current="")}),onPointerMove:Qr(e.onPointerMove,b1(K=>{const ce=K.target,fe=D.current!==K.clientX;if(K.currentTarget.contains(ce)&&fe){const B=K.clientX>D.current?"right":"left";I.current=B,D.current=K.clientX}}))})})})})})})});ute.displayName=fd;var yHe="MenuGroup",hM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(Hn.div,{role:"group",...n,ref:t})});hM.displayName=yHe;var bHe="MenuLabel",fte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(Hn.div,{...n,ref:t})});fte.displayName=bHe;var $_="MenuItem",Lq="menu.itemSelect",a5=p.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,i=p.useRef(null),s=mw($_,e.__scopeMenu),l=fM($_,e.__scopeMenu),c=Ia(t,i),d=p.useRef(!1),u=()=>{const f=i.current;if(!r&&f){const m=new CustomEvent(Lq,{bubbles:!0,cancelable:!0});f.addEventListener(Lq,h=>n?.(h),{once:!0}),pI(f,m),m.defaultPrevented?d.current=!1:s.onClose()}};return o.jsx(mte,{...a,ref:c,disabled:r,onClick:Qr(e.onClick,u),onPointerDown:f=>{e.onPointerDown?.(f),d.current=!0},onPointerUp:Qr(e.onPointerUp,f=>{d.current||f.currentTarget?.click()}),onKeyDown:Qr(e.onKeyDown,f=>{const m=l.searchRef.current!=="";r||m&&f.key===" "||J3.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});a5.displayName=$_;var mte=p.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...i}=e,s=fM($_,r),l=ste(r),c=p.useRef(null),d=Ia(t,c),[u,f]=p.useState(!1),[m,h]=p.useState("");return p.useEffect(()=>{const v=c.current;v&&h((v.textContent??"").trim())},[i.children]),o.jsx(y1.ItemSlot,{scope:r,disabled:n,textValue:a??m,children:o.jsx(ate,{asChild:!0,...l,focusable:!n,children:o.jsx(Hn.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:d,onPointerMove:Qr(e.onPointerMove,b1(v=>{n?s.onItemLeave(v):(s.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Qr(e.onPointerLeave,b1(v=>s.onItemLeave(v))),onFocus:Qr(e.onFocus,()=>f(!0)),onBlur:Qr(e.onBlur,()=>f(!1))})})})}),wHe="MenuCheckboxItem",hte=p.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return o.jsx(yte,{scope:e.__scopeMenu,checked:r,children:o.jsx(a5,{role:"menuitemcheckbox","aria-checked":F_(r)?"mixed":r,...a,ref:t,"data-state":gM(r),onSelect:Qr(a.onSelect,()=>n?.(F_(r)?!0:!r),{checkForDefaultPrevented:!1})})})});hte.displayName=wHe;var pte="MenuRadioGroup",[jHe,NHe]=wg(pte,{value:void 0,onValueChange:()=>{}}),gte=p.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,i=$l(n);return o.jsx(jHe,{scope:e.__scopeMenu,value:r,onValueChange:i,children:o.jsx(hM,{...a,ref:t})})});gte.displayName=pte;var vte="MenuRadioItem",xte=p.forwardRef((e,t)=>{const{value:r,...n}=e,a=NHe(vte,e.__scopeMenu),i=r===a.value;return o.jsx(yte,{scope:e.__scopeMenu,checked:i,children:o.jsx(a5,{role:"menuitemradio","aria-checked":i,...n,ref:t,"data-state":gM(i),onSelect:Qr(n.onSelect,()=>a.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});xte.displayName=vte;var pM="MenuItemIndicator",[yte,_He]=wg(pM,{checked:!1}),bte=p.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,i=_He(pM,r);return o.jsx(Ac,{present:n||F_(i.checked)||i.checked===!0,children:o.jsx(Hn.span,{...a,ref:t,"data-state":gM(i.checked)})})});bte.displayName=pM;var SHe="MenuSeparator",wte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(Hn.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});wte.displayName=SHe;var CHe="MenuArrow",jte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=n5(r);return o.jsx(JD,{...a,...n,ref:t})});jte.displayName=CHe;var PHe="MenuSub",[blt,Nte]=wg(PHe),xy="MenuSubTrigger",_te=p.forwardRef((e,t)=>{const r=jg(xy,e.__scopeMenu),n=mw(xy,e.__scopeMenu),a=Nte(xy,e.__scopeMenu),i=fM(xy,e.__scopeMenu),s=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,d={__scopeMenu:e.__scopeMenu},u=p.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return p.useEffect(()=>u,[u]),p.useEffect(()=>{const f=l.current;return()=>{window.clearTimeout(f),c(null)}},[l,c]),o.jsx(dM,{asChild:!0,...d,children:o.jsx(mte,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":Pte(r.open),...e,ref:$S(t,a.onTriggerChange),onClick:f=>{e.onClick?.(f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Qr(e.onPointerMove,b1(f=>{i.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!s.current&&(i.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:Qr(e.onPointerLeave,b1(f=>{u();const m=r.content?.getBoundingClientRect();if(m){const h=r.content?.dataset.side,v=h==="right",g=v?-5:5,x=m[v?"left":"right"],y=m[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+g,y:f.clientY},{x,y:m.top},{x:y,y:m.top},{x:y,y:m.bottom},{x,y:m.bottom}],side:h}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Qr(e.onKeyDown,f=>{const m=i.searchRef.current!=="";e.disabled||m&&f.key===" "||sHe[n.dir].includes(f.key)&&(r.onOpenChange(!0),r.content?.focus(),f.preventDefault())})})})});_te.displayName=xy;var Ste="MenuSubContent",Cte=p.forwardRef((e,t)=>{const r=cte(fd,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=jg(fd,e.__scopeMenu),s=mw(fd,e.__scopeMenu),l=Nte(Ste,e.__scopeMenu),c=p.useRef(null),d=Ia(t,c);return o.jsx(y1.Provider,{scope:e.__scopeMenu,children:o.jsx(Ac,{present:n||i.open,children:o.jsx(y1.Slot,{scope:e.__scopeMenu,children:o.jsx(mM,{id:l.contentId,"aria-labelledby":l.triggerId,...a,ref:d,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{s.isUsingKeyboardRef.current&&c.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Qr(e.onFocusOutside,u=>{u.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Qr(e.onEscapeKeyDown,u=>{s.onClose(),u.preventDefault()}),onKeyDown:Qr(e.onKeyDown,u=>{const f=u.currentTarget.contains(u.target),m=lHe[s.dir].includes(u.key);f&&m&&(i.onOpenChange(!1),l.trigger?.focus(),u.preventDefault())})})})})})});Cte.displayName=Ste;function Pte(e){return e?"open":"closed"}function F_(e){return e==="indeterminate"}function gM(e){return F_(e)?"indeterminate":e?"checked":"unchecked"}function AHe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function EHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function kHe(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let s=EHe(e,Math.max(i,0));a.length===1&&(s=s.filter(d=>d!==r));const c=s.find(d=>d.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function OHe(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,s=t.length-1;i<t.length;s=i++){const l=t[i],c=t[s],d=l.x,u=l.y,f=c.x,m=c.y;u>n!=m>n&&r<(f-d)*(n-u)/(m-u)+d&&(a=!a)}return a}function THe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return OHe(r,t)}function b1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var IHe=lte,DHe=dM,MHe=dte,RHe=ute,LHe=hM,$He=fte,FHe=a5,BHe=hte,qHe=gte,zHe=xte,UHe=bte,VHe=wte,WHe=jte,HHe=_te,GHe=Cte,o5="DropdownMenu",[KHe,wlt]=bd(o5,[ite]),xl=ite(),[YHe,Ate]=KHe(o5),Ete=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:i,onOpenChange:s,modal:l=!0}=e,c=xl(t),d=p.useRef(null),[u,f]=Df({prop:a,defaultProp:i??!1,onChange:s,caller:o5});return o.jsx(YHe,{scope:t,triggerId:Yd(),triggerRef:d,contentId:Yd(),open:u,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(m=>!m),[f]),modal:l,children:o.jsx(IHe,{...c,open:u,onOpenChange:f,dir:n,modal:l,children:r})})};Ete.displayName=o5;var kte="DropdownMenuTrigger",Ote=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,i=Ate(kte,r),s=xl(r);return o.jsx(DHe,{asChild:!0,...s,children:o.jsx(Hn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:$S(t,i.triggerRef),onPointerDown:Qr(e.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:Qr(e.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Ote.displayName=kte;var XHe="DropdownMenuPortal",Tte=e=>{const{__scopeDropdownMenu:t,...r}=e,n=xl(t);return o.jsx(MHe,{...n,...r})};Tte.displayName=XHe;var Ite="DropdownMenuContent",Dte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ate(Ite,r),i=xl(r),s=p.useRef(!1);return o.jsx(RHe,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...n,ref:t,onCloseAutoFocus:Qr(e.onCloseAutoFocus,l=>{s.current||a.triggerRef.current?.focus(),s.current=!1,l.preventDefault()}),onInteractOutside:Qr(e.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;(!a.modal||u)&&(s.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Dte.displayName=Ite;var JHe="DropdownMenuGroup",QHe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(LHe,{...a,...n,ref:t})});QHe.displayName=JHe;var ZHe="DropdownMenuLabel",Mte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx($He,{...a,...n,ref:t})});Mte.displayName=ZHe;var eGe="DropdownMenuItem",Rte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(FHe,{...a,...n,ref:t})});Rte.displayName=eGe;var tGe="DropdownMenuCheckboxItem",Lte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(BHe,{...a,...n,ref:t})});Lte.displayName=tGe;var rGe="DropdownMenuRadioGroup",nGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(qHe,{...a,...n,ref:t})});nGe.displayName=rGe;var aGe="DropdownMenuRadioItem",$te=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(zHe,{...a,...n,ref:t})});$te.displayName=aGe;var oGe="DropdownMenuItemIndicator",Fte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(UHe,{...a,...n,ref:t})});Fte.displayName=oGe;var iGe="DropdownMenuSeparator",Bte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(VHe,{...a,...n,ref:t})});Bte.displayName=iGe;var sGe="DropdownMenuArrow",lGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(WHe,{...a,...n,ref:t})});lGe.displayName=sGe;var cGe="DropdownMenuSubTrigger",qte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(HHe,{...a,...n,ref:t})});qte.displayName=cGe;var dGe="DropdownMenuSubContent",zte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(GHe,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});zte.displayName=dGe;var uGe=Ete,fGe=Ote,mGe=Tte,Ute=Dte,Vte=Mte,Wte=Rte,Hte=Lte,Gte=$te,Kte=Fte,Yte=Bte,Xte=qte,Jte=zte;const Ky=uGe,Yy=fGe,hGe=xe.forwardRef(({className:e,inset:t,children:r,...n},a)=>o.jsxs(Xte,{ref:a,className:Jt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,o.jsx(Qx,{className:"ml-auto h-4 w-4"})]}));hGe.displayName=Xte.displayName;const pGe=xe.forwardRef(({className:e,...t},r)=>o.jsx(Jte,{ref:r,className:Jt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));pGe.displayName=Jte.displayName;const Wv=xe.forwardRef(({className:e,sideOffset:t=4,...r},n)=>o.jsx(mGe,{children:o.jsx(Ute,{ref:n,sideOffset:t,className:Jt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Wv.displayName=Ute.displayName;const ol=xe.forwardRef(({className:e,inset:t,...r},n)=>o.jsx(Wte,{ref:n,className:Jt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));ol.displayName=Wte.displayName;const gGe=xe.forwardRef(({className:e,children:t,checked:r,...n},a)=>o.jsxs(Hte,{ref:a,className:Jt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(Kte,{children:o.jsx(Tf,{className:"h-4 w-4"})})}),t]}));gGe.displayName=Hte.displayName;const vGe=xe.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(Gte,{ref:n,className:Jt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(Kte,{children:o.jsx(Xde,{className:"h-2 w-2 fill-current"})})}),t]}));vGe.displayName=Gte.displayName;const Q3=xe.forwardRef(({className:e,inset:t,...r},n)=>o.jsx(Vte,{ref:n,className:Jt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));Q3.displayName=Vte.displayName;const Aj=xe.forwardRef(({className:e,...t},r)=>o.jsx(Yte,{ref:r,className:Jt("-mx-1 my-1 h-px bg-muted",e),...t}));Aj.displayName=Yte.displayName;function Wn(){try{const e=localStorage.getItem("auth:userProfile");if(e){const r=JSON.parse(e);if(r?.codigo_empresa)return r.codigo_empresa}const t=localStorage.getItem("auth:company");if(t){const r=JSON.parse(t);if(r?.codigo_empresa)return r.codigo_empresa;if(r?.codigo)return r.codigo}return typeof window<"u"&&window.__authProfile&&window.__authProfile.codigo_empresa?window.__authProfile.codigo_empresa:null}catch{return null}}async function Hv({somenteAtivas:e=!0,codigoEmpresa:t}={}){const r=t||Wn();let n=pe.from("finalizadoras").select("*").order("codigo_interno",{ascending:!0,nullsFirst:!1}).order("nome",{ascending:!0});r&&(n=n.eq("codigo_empresa",r)),e&&(n=n.eq("ativo",!0));const{data:a,error:i}=await n;if(i)throw i;const s=a||[];return s.sort((l,c)=>{const d=parseInt(l?.codigo_interno)||0,u=parseInt(c?.codigo_interno)||0;if(d!==u)return d-u;const f=(l?.nome||"").toLowerCase(),m=(c?.nome||"").toLowerCase();return f.localeCompare(m)}),s}async function xGe(e,t){const r=t||Wn(),n={codigo_interno:e?.codigo_interno||null,codigo_sefaz:e?.codigo_sefaz||null,nome:(e?.nome||"").trim(),tipo:e?.tipo||"outros",ativo:e?.ativo??!0,taxa_percentual:e?.taxa_percentual==null?null:Number(e.taxa_percentual)};if(!n.nome)throw new Error("Nome  obrigatrio");r&&(n.codigo_empresa=r);const{data:a,error:i}=await pe.from("finalizadoras").insert(n).select("*").single();if(i)throw i;return a}async function B_({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||Wn();let n=pe.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;const s=Array.isArray(a)?a[0]:a;if(!s)throw new Error("Sesso no encontrada");const l=s.aberto_em,c=s.fechado_em||new Date().toISOString(),d=await id({from:l,to:c,codigoEmpresa:r});let u=0,f=0,m=0,h=0;try{let g=pe.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",e);r&&(g=g.eq("codigo_empresa",r));const{data:x}=await g;for(const y of x||[]){const b=Number(y?.valor||0),w=String(y?.tipo||"").toLowerCase();w==="suprimento"?u+=b:w==="sangria"?f+=b:w==="ajuste"?m+=b:w==="troco"&&(h+=b)}}catch{}const v=u+m-f-h;return{...d,saldoInicial:Number(s.saldo_inicial||0),saldoFinal:s.saldo_final!=null?Number(s.saldo_final):null,movimentos:{suprimentos:u,sangrias:f,ajustes:m,troco:h,totalMovimentos:v}}}async function yGe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||Wn(),a={codigo_interno:t?.codigo_interno||null,codigo_sefaz:t?.codigo_sefaz||null,nome:(t?.nome||"").trim(),tipo:t?.tipo||"outros",ativo:t?.ativo??!0,taxa_percentual:t?.taxa_percentual==null?null:Number(t.taxa_percentual)};if(!a.nome)throw new Error("Nome  obrigatrio");let i=pe.from("finalizadoras").update(a).eq("id",e);n&&(i=i.eq("codigo_empresa",n));const{data:s,error:l}=await i.select("*").single();if(l)throw l;return s}async function bGe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||Wn();let a=pe.from("finalizadoras").update({ativo:!!t}).eq("id",e);n&&(a=a.eq("codigo_empresa",n));const{data:i,error:s}=await a.select("*").single();if(s)throw s;return i}async function vM({codigoEmpresa:e}={}){const t=e||Wn();let r=pe.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:a}=await r;if(a)throw a;if(!(Array.isArray(n)&&n.length>0)){const s=new Error(" necessrio abrir o caixa antes de criar comandas.");throw s.code="NO_OPEN_CASH_SESSION",s}return!0}async function $q(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||Wn(),n=async s=>{let l=pe.from("comanda_clientes").select(`comanda_id, cliente_id, nome_livre, clientes:clientes${s}(id, nome)`).in("comanda_id",e);return r&&(l=l.eq("codigo_empresa",r)),l};let a=[];try{const{data:s,error:l}=await n("!comanda_clientes_cliente_id_fkey");if(l)throw l;a=s||[]}catch{try{const{data:s,error:l}=await n("!fk_comanda_clientes_cliente");if(l)throw l;a=s||[]}catch{let s=pe.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",e);r&&(s=s.eq("codigo_empresa",r));const{data:l}=await s;a=l||[]}}const i={};for(const s of a){const l=s.comanda_id,c=s.clientes?.nome||s.nome_livre||"";i[l]||(i[l]=[]),c&&i[l].push(c)}for(const s of Object.keys(i))i[s]=Array.from(new Set(i[s])).join(", ");return i}async function Fq(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||Wn();let n=pe.from("pagamentos").select("comanda_id, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;const s={};for(const c of a||[]){if(!((c.status||"Pago")!=="Cancelado"&&(c.status||"Pago")!=="Estornado"))continue;const u=c.comanda_id,f=c?.finalizadoras?.nome||c.metodo||"Outros";s[u]||(s[u]=[]),s[u].push(f)}const l={};for(const[c,d]of Object.entries(s))d.length===0?l[c]="":d.length===1?l[c]=d[0]:l[c]=`${d[0]} +${d.length-1}`;return l}async function wGe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||Wn();let n=pe.from("comanda_itens").select("produto_id, quantidade").eq("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;const s=new Map;for(const h of a||[]){const v=h.produto_id,g=Number(h.quantidade||0);s.set(v,(s.get(v)||0)+g)}if(s.size===0)return!0;const l=Array.from(s.keys());let c=pe.from("produtos").select("id, nome, estoque");c=c.in("id",l),r&&(c=c.eq("codigo_empresa",r));const{data:d,error:u}=await c;if(u)throw u;const f=new Map((d||[]).map(h=>[h.id,{nome:h.nome,estoque:Number(h.estoque||0)}])),m=[];for(const[h,v]of s.entries()){const g=f.get(h)||{nome:`Produto ${h}`,estoque:0};v>g.estoque&&m.push({id:h,name:g.nome,solicitado:v,estoque:g.estoque})}if(m.length>0){const h=m.map(g=>`${g.name}: solicitado ${g.solicitado}, estoque ${g.estoque}`).join("; "),v=new Error(`Estoque insuficiente para finalizar: ${h}`);throw v.code="INSUFFICIENT_STOCK_COMANDA",v.items=m,v}return!0}async function xM({codigoEmpresa:e}={}){const t=e||Wn();let r=pe.from("comandas").select("id,status,aberto_em").is("mesa_id",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:a}=await r;if(a)throw a;return n?.[0]||null}async function Ej({codigoEmpresa:e}={}){const t=e||Wn();console.log("[getOrCreateComandaBalcao] Iniciando com codigo_empresa:",t),await vM({codigoEmpresa:t});const r=await xM({codigoEmpresa:t});if(r)return console.log("[getOrCreateComandaBalcao] Comanda existente encontrada:",r),r;const n={status:"open",mesa_id:null,aberto_em:new Date().toISOString()};console.log("[getOrCreateComandaBalcao] Criando nova comanda (codigo_empresa via DEFAULT):",n);const{data:a,error:i}=await pe.from("comandas").insert(n).select("id,status,aberto_em,tipo,codigo_empresa").single();if(i)throw console.error("[getOrCreateComandaBalcao] ERRO ao criar comanda:",i),i;return console.log("[getOrCreateComandaBalcao] Comanda criada com sucesso:",a),console.log("[getOrCreateComandaBalcao] Codigo da comanda criada:",a?.codigo_empresa,"vs esperado:",t),await new Promise(s=>setTimeout(s,100)),a}async function Bq({status:e,from:t,to:r,search:n="",limit:a=50,offset:i=0,codigoEmpresa:s}={}){const l=s||Wn();let c=pe.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").order("fechado_em",{ascending:!1,nullsFirst:!1}).order("aberto_em",{ascending:!1}).range(i,i+a-1);l&&(c=c.eq("codigo_empresa",l)),e&&Array.isArray(e)&&e.length?c=c.in("status",e):typeof e=="string"&&e!=="all"&&(e==="closed"?c=c.or("status.eq.closed,fechado_em.not.is.null").neq("status","cancelled"):c=c.eq("status",e));const d=x=>{if(!x)return null;if(typeof x=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(x)){const[y,b,w]=x.split("-").map(Number);return new Date(y,b-1,w,0,0,0,0)}return new Date(x)},u=x=>{if(!x)return null;if(typeof x=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(x)){const[y,b,w]=x.split("-").map(Number);return new Date(y,b-1,w,23,59,59,999)}return new Date(x)},f=d(t),m=u(r);f&&(c=c.gte("aberto_em",f.toISOString())),m&&(c=c.lte("aberto_em",m.toISOString()));const h=(n||"").trim();if(h){const x=/^\d+$/.test(h);if(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(h)){const b=pe.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("id",h).eq("codigo_empresa",l),w=pe.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("mesa_id",h).eq("codigo_empresa",l),[j,_]=await Promise.all([b,w]),S=j.data||[],k=_.data||[],E=[...S,...k];return Array.from(new Map(E.map(M=>[M.id,M])).values()).sort((M,C)=>new Date(C.fechado_em||C.aberto_em)-new Date(M.fechado_em||M.aberto_em))}else x?c=c.or(`id.eq.${h},status.ilike.%${h}%`):c=c.or(`status.ilike.%${h}%`)}const{data:v,error:g}=await c;if(g)throw g;return v||[]}async function id({from:e,to:t,codigoEmpresa:r}={}){const n="[listarResumoPeriodo]",a=r||Wn();console.log(`${n} Iniciando consulta`),console.log(`${n} Perodo: ${e||"SEM from"} at ${t||"SEM to"}`),console.log(`${n} codigo_empresa: ${a}`);let i=[];try{let m=pe.from("comandas").select("id, fechado_em").eq("status","closed");a&&(m=m.eq("codigo_empresa",a)),e&&(m=m.gte("fechado_em",new Date(e).toISOString())),t&&(m=m.lte("fechado_em",new Date(t).toISOString()));const{data:h,error:v}=await m;if(v)throw v;i=h||[]}catch{i=[]}const s=(i||[]).map(m=>m.id);let l=0,c=0;if(s.length>0)try{let m=pe.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",s);a&&(m=m.eq("codigo_empresa",a));const{data:h,error:v}=await m;if(v)throw v;for(const g of h||[]){const x=Number(g.quantidade||0)*Number(g.preco_unitario||0),y=Number(g.desconto||0);l+=x,c+=y}}catch{}const d=Math.max(0,l-c),u={};let f=0;try{let m=pe.from("pagamentos").select("metodo, valor, recebido_em, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)");a&&(m=m.eq("codigo_empresa",a)),e&&(m=m.gte("recebido_em",new Date(e).toISOString())),t&&(m=m.lte("recebido_em",new Date(t).toISOString())),console.log(`${n} Consultando pagamentos de comandas...`);const{data:h,error:v}=await m;if(v)throw console.error(`${n}  Erro ao buscar pagamentos:`,v),v;console.log(`${n} Total de pagamentos de comandas encontrados: ${(h||[]).length}`);for(const g of h||[]){if(!((g.status||"Pago")!=="Cancelado"&&(g.status||"Pago")!=="Estornado"))continue;const y=g.finalizadoras?.nome||g.metodo||"outros",b=Number(g.valor||0);u[y]=(u[y]||0)+b,f+=b}console.log(`${n}  Resumo comandas por finalizadora:`,u)}catch(m){console.error(`${n}  Exception ao processar pagamentos de comandas:`,m)}try{let m=pe.from("agendamentos").select("id, inicio");a&&(m=m.eq("codigo_empresa",a)),e&&(m=m.gte("inicio",new Date(e).toISOString())),t&&(m=m.lte("inicio",new Date(t).toISOString())),console.log(`${n} Consultando agendamentos no perodo...`);const{data:h,error:v}=await m;if(v)throw console.error(`${n}  Erro ao buscar agendamentos:`,v),v;if(console.log(`${n} Total de agendamentos encontrados: ${(h||[]).length}`),h&&h.length>0){const g=h.map(w=>w.id);let x=pe.from("agendamento_participantes").select("valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(nome, taxa_percentual)").in("agendamento_id",g).eq("status_pagamento","Pago");a&&(x=x.eq("codigo_empresa",a)),console.log(`${n} Consultando participantes pagos...`);const{data:y,error:b}=await x;if(b)throw console.error(`${n}  Erro ao buscar participantes:`,b),b;console.log(`${n} Total de participantes pagos encontrados: ${(y||[]).length}`);for(const w of y||[]){const j=w.finalizadoras?.nome||"Outros";let _=Number(w.valor_cota||0);if(w.aplicar_taxa===!0){const S=Number(w.finalizadoras?.taxa_percentual||0);S>0&&(_=_/(1+S/100),console.log(`${n}  Participante com taxa: valor_cota=${w.valor_cota}, taxa=${S}%, valor_real=${_.toFixed(2)}`))}u[j]=(u[j]||0)+_,f+=_}console.log(`${n}  Resumo agendamentos por finalizadora:`,u)}}catch(m){console.error(`${n}  Exception ao processar pagamentos de agendamentos:`,m)}return console.log(`${n}  RESUMO FINAL por finalizadora:`,u),console.log(`${n} Total de entradas: R$ ${f.toFixed(2)}`),{from:e?new Date(e).toISOString():null,to:t?new Date(t).toISOString():null,totalPorFinalizadora:u,totalEntradas:f,totalVendasBrutas:l,totalDescontos:c,totalVendasLiquidas:d}}async function w1({codigoEmpresa:e}={}){const t=e||Wn();let r=null;try{let a=pe.from("caixa_sessoes").select("aberto_em").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(a=a.eq("codigo_empresa",t));const{data:i,error:s}=await a;if(s)throw s;r=i?.[0]?.aberto_em||null}catch{}if(!r)return null;const n=new Date().toISOString();return id({from:r,to:n,codigoEmpresa:t})}async function Qte({comandaId:e,codigoEmpresa:t}={}){const r=t||Wn();let n=pe.from("pagamentos").select("*, finalizadoras!pagamentos_finalizadora_id_fkey(id, nome, codigo_sefaz, codigo_interno)").order("recebido_em",{ascending:!0});e&&(n=n.eq("comanda_id",e)),r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;return a||[]}async function kj({searchTerm:e="",limit:t=20,codigoEmpresa:r}={}){const n=r||Wn();let a=pe.from("clientes").select("*").eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0}).limit(t);n&&(a=a.eq("codigo_empresa",n));const i=(e||"").trim();i&&(/^\d+$/.test(i)?a=a.or(`codigo.eq.${i},nome.ilike.%${i}%,email.ilike.%${i}%,telefone.ilike.%${i}%`):a=a.or(`nome.ilike.%${i}%,email.ilike.%${i}%,telefone.ilike.%${i}%`));const{data:s,error:l}=await a;if(l)throw l;return s||[]}async function sc({codigoEmpresa:e}={}){const t="[listarComandasAbertas]",r=e||Wn(),n=async()=>{const a=new Promise((c,d)=>setTimeout(()=>d(new Error("listarComandasAbertas timeout aps 30s")),3e4));let i=pe.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, observacoes, observacoes_atualizadas_em").is("fechado_em",null).neq("status","cancelled").order("aberto_em",{ascending:!1}).limit(500);r&&(i=i.eq("codigo_empresa",r));const{data:s,error:l}=await Promise.race([i,a]);if(l)throw l;return s||[]};try{try{return await n()}catch(a){if(String(a?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw a}}catch(a){return console.error(`${t}  EXCEPTION:`,a?.message||a),[]}}async function Z3(e=[],t){if(!e||e.length===0)return{};const r=t||Wn();let n=pe.from("comanda_itens").select("comanda_id, quantidade, preco_unitario").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;const s={};for(const l of a||[]){const c=l.comanda_id,d=Number(l.quantidade||0)*Number(l.preco_unitario||0);s[c]=(s[c]||0)+d}return s}async function bp(e){const t="[listMesas]",r=e||Wn(),n=async()=>{const a=new Promise((c,d)=>setTimeout(()=>d(new Error("listMesas timeout aps 30s")),3e4));let i=pe.from("mesas").select("id, numero, nome, status").order("numero",{ascending:!0}).limit(200);r&&(i=i.eq("codigo_empresa",r));const{data:s,error:l}=await Promise.race([i,a]);if(l)throw l;return s||[]};try{try{return await n()}catch(a){if(String(a?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw a}}catch(a){return console.error(`${t}  EXCEPTION:`,a?.message||a),[]}}async function jGe({comandaId:e,status:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");let n=pe.from("pagamentos").select("*").eq("comanda_id",e);t&&(n=n.eq("status",t)),n=n.order("created_at",{ascending:!0});const{data:a,error:i}=await n;if(i)throw i;return a||[]}async function qq({comandaId:e,linhas:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const n=r||Wn();if(Array.isArray(t)){await pe.from("pagamentos").delete().eq("comanda_id",e).eq("status","Pendente");for(const a of t){const i=Number(a?.valor||0);if(i<=0)continue;const s=a?.metodo||a?.metodoNome||"outros";await yM({comandaId:e,finalizadoraId:a?.finalizadoraId||a?.methodId||null,metodo:s,valor:i,status:"Pendente",codigoEmpresa:n,clienteId:a?.clienteId||a?.clientId||null})}}}async function NGe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||Wn();let n=pe.from("pagamentos").update({status:"Pago",recebido_em:new Date().toISOString()}).eq("comanda_id",e).eq("status","Pendente");r&&(n=n.eq("codigo_empresa",r));const{error:a}=await n;if(a)throw a;return!0}async function _Ge({numero:e,nome:t,codigoEmpresa:r}={}){const n=r||Wn();let a=e;if(!a){let s=pe.from("mesas").select("numero").order("numero",{ascending:!1}).limit(1);n&&(s=s.eq("codigo_empresa",n));const{data:l,error:c}=await s;if(c)throw c;a=(l?.[0]?.numero||0)+1}const i={numero:a,status:"available"};t&&typeof t=="string"&&t.trim()&&(i.nome=t.trim()),n&&(i.codigo_empresa=n);try{const{data:s,error:l}=await pe.from("mesas").insert(i).select("*").single();if(l)throw l;return s}catch(s){const l=String(s?.message||s||"");if(/column\s+\"?nome\"?\s+of\s+relation/i.test(l)||/column\s+\"?nome\"?\s+does not exist/i.test(l)){const c={numero:a,status:"available"};n&&(c.codigo_empresa=n);const{data:d,error:u}=await pe.from("mesas").insert(c).select("*").single();if(u)throw u;return d}throw s}}async function hf({saldoInicial:e=0,codigoEmpresa:t}={}){const r=t||Wn();let n=pe.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;if(a&&a.length>0){const d=a[0];try{const u=new Date(d.aberto_em),f=new Date;if(u.toDateString()!==f.toDateString()){try{const b=await sc({codigoEmpresa:r});if(Array.isArray(b)&&b.length>0)return console.warn("[ensureCaixaAberto] Sesso de dia anterior detectada, mas h comandas abertas. No fechar automaticamente."),d}catch{}const h=f.toISOString();let v=0,g=0;try{const b=await id({from:d.aberto_em,to:h,codigoEmpresa:r});v=Number(b?.totalEntradas||0)}catch{}try{let b=pe.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",d.id);r&&(b=b.eq("codigo_empresa",r));const{data:w}=await b;for(const j of w||[]){const _=Number(j?.valor||0),S=String(j?.tipo||"").toLowerCase();S==="suprimento"||S==="ajuste"?g+=_:(S==="sangria"||S==="troco")&&(g-=_)}}catch{}const x=Number(d?.saldo_inicial||0)+v+g;let y=pe.from("caixa_sessoes").update({status:"closed",saldo_final:x,fechado_em:h}).eq("id",d.id).eq("status","open");r&&(y=y.eq("codigo_empresa",r)),await y;try{const b=await B_({caixaSessaoId:d.id,codigoEmpresa:r}).catch(async()=>await id({from:d.aberto_em,to:h,codigoEmpresa:r})),w={codigo_empresa:r||Wn(),caixa_sessao_id:d.id,periodo_de:b?.from||d.aberto_em,periodo_ate:b?.to||h,total_bruto:Number(b?.totalVendasBrutas||0),total_descontos:Number(b?.totalDescontos||0),total_liquido:Number(b?.totalVendasLiquidas||0),total_entradas:Number(b?.totalEntradas||0),por_finalizadora:b?.totalPorFinalizadora||{}},j=w.por_finalizadora;await pe.from("caixa_resumos").insert({...w,por_finalizadora:j&&typeof j!="string"?JSON.stringify(j):j})}catch{}}else{try{if(d?.saldo_inicial==null&&e!=null){let h=pe.from("caixa_sessoes").update({saldo_inicial:Number(e)||0}).eq("id",d.id);return r&&(h=h.eq("codigo_empresa",r)),await h,{...d,saldo_inicial:Number(e)||0}}}catch{}return d}}catch{}return d}const s={status:"open",saldo_inicial:e};r&&(s.codigo_empresa=r);const{data:l,error:c}=await pe.from("caixa_sessoes").insert(s).select("id,status,aberto_em").single();if(c)throw c;return l}async function Dm({codigoEmpresa:e}={}){const t=e||Wn();let r=pe.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:a}=await r;if(a)throw a;return n?.[0]||null}async function Zte({saldoFinal:e=null,valorFinalDinheiro:t=null,codigoEmpresa:r}={}){console.log("[fecharCaixa] Iniciando fechamento:",{valorFinalDinheiro:t,saldoFinal:e,codigoEmpresa:r});const n=r||Wn();try{console.log("[fecharCaixa]  Limpeza preventiva: corrigindo comandas inconsistentes...");const{data:y}=await pe.from("comandas").select("id, status, fechado_em").eq("codigo_empresa",n).is("fechado_em",null).neq("status","open").neq("status","awaiting-payment");if(y&&y.length>0){console.log(`[fecharCaixa]  Encontradas ${y.length} comandas inconsistentes, corrigindo...`);const b=new Date().toISOString();for(const w of y)try{await pe.from("comandas").update({fechado_em:b}).eq("id",w.id).eq("codigo_empresa",n),console.log(`[fecharCaixa]  Comanda ${w.id} (status: ${w.status}) corrigida`)}catch{}}else console.log("[fecharCaixa]  Nenhuma comanda inconsistente encontrada")}catch(y){console.warn("[fecharCaixa]  Erro na limpeza preventiva:",y?.message)}try{let y=await sc({codigoEmpresa:n});if(y=y||[],console.log(`[fecharCaixa]  Comandas abertas encontradas: ${y.length}`,y.map(w=>({id:w.id,status:w.status,mesa:w.mesa_id}))),y&&y.length>0){const w=y.map(j=>`${j.id}${j.mesa_id?`@mesa:${j.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${y.length} comanda(s) aberta(s). Feche todas as comandas antes de encerrar o caixa.`)}let b=0;for(;b<12&&(y=await sc({codigoEmpresa:n}),!(!y||y.length===0));)await new Promise(w=>setTimeout(w,250)),b++;if(y&&y.length>0){const w=y.map(k=>k.id);let j=new Map,_=new Map;try{if(w.length>0){let k=pe.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",w);n&&(k=k.eq("codigo_empresa",n));const{data:E}=await k;j=new Map;for(const A of E||[]){const M=A.comanda_id,C=Number(A.quantidade||0);j.set(M,(j.get(M)||0)+C)}}}catch{}try{if(w.length>0){let k=pe.from("pagamentos").select("comanda_id, status").in("comanda_id",w);n&&(k=k.eq("codigo_empresa",n));const{data:E}=await k;_=new Map;for(const A of E||[]){const M=String(A?.status||"Pago");if(M==="Cancelado"||M==="Estornado")continue;const C=A.comanda_id;_.set(C,(_.get(C)||0)+1)}}}catch{}for(const k of y){const E=Number(j.get(k.id)||0)>0,A=Number(_.get(k.id)||0)>0;if(!E&&!A)try{await Bx({comandaId:k.id,codigoEmpresa:n})}catch{}}let S=await sc({codigoEmpresa:n});if(S=S||[],S.length>0){const k=S.map(C=>C.id);let E=new Map,A=new Map;try{if(k.length>0){let C=pe.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",k);n&&(C=C.eq("codigo_empresa",n));const{data:T}=await C;E=new Map;for(const I of T||[]){const D=I.comanda_id,F=Number(I.quantidade||0);E.set(D,(E.get(D)||0)+F)}}}catch{}try{if(k.length>0){let C=pe.from("pagamentos").select("comanda_id, status").in("comanda_id",k);n&&(C=C.eq("codigo_empresa",n));const{data:T}=await C;A=new Map;for(const I of T||[]){const D=String(I?.status||"Pago");if(D==="Cancelado"||D==="Estornado")continue;const F=I.comanda_id;A.set(F,(A.get(F)||0)+1)}}}catch{}const M=S.filter(C=>Number(E.get(C.id)||0)>0||Number(A.get(C.id)||0)>0);if(M.length>0){const C=M.map(T=>`${T.id}${T.mesa_id?`@mesa:${T.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${M.length} comandas abertas. IDs: ${C}. Feche todas antes de encerrar o caixa.`)}}}}catch(y){if(y&&/Existem \d+ comandas/.test(y.message||""))throw y;const b=new Error("Falha ao validar comandas abertas. Tente novamente e verifique sua conexo.");throw b.code="CASH_CLOSE_VALIDATION_FAILED",b}let a=pe.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);n&&(a=a.eq("codigo_empresa",n));const{data:i,error:s}=await a;if(s)throw s;const l=i?.[0]?.id||null,c=i?.[0]?.aberto_em||null,d=Number(i?.[0]?.saldo_inicial||0);if(!l)throw new Error("Nenhuma sesso de caixa aberta encontrada.");const u=new Date().toISOString();let f=0,m=0;try{const y=await id({from:c,to:u,codigoEmpresa:n});f=Number(y?.totalEntradas||0)}catch{}try{let y=pe.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",l);n&&(y=y.eq("codigo_empresa",n));const{data:b}=await y;for(const w of b||[]){const j=Number(w?.valor||0),_=String(w?.tipo||"").toLowerCase();_==="suprimento"||_==="ajuste"?m+=j:(_==="sangria"||_==="troco")&&(m-=j)}}catch{}const h=e!=null?Number(e):d+f+m;try{let y=await sc({codigoEmpresa:n});if(y=y||[],y.length>0){const b=y.map(S=>S.id);let w=new Map,j=new Map;try{if(b.length>0){let S=pe.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",b);n&&(S=S.eq("codigo_empresa",n));const{data:k}=await S;w=new Map;for(const E of k||[]){const A=E.comanda_id,M=Number(E.quantidade||0);w.set(A,(w.get(A)||0)+M)}}}catch{}try{if(b.length>0){let S=pe.from("pagamentos").select("comanda_id, status").in("comanda_id",b);n&&(S=S.eq("codigo_empresa",n));const{data:k}=await S;j=new Map;for(const E of k||[]){const A=String(E?.status||"Pago");if(A==="Cancelado"||A==="Estornado")continue;const M=E.comanda_id;j.set(M,(j.get(M)||0)+1)}}}catch{}for(const S of y){const k=Number(w.get(S.id)||0)>0,E=Number(j.get(S.id)||0)>0;if(!k&&!E)try{await Bx({comandaId:S.id,codigoEmpresa:n})}catch{}}let _=await sc({codigoEmpresa:n});if(_=_||[],_.length>0){const S=_.map(k=>`${k.id}${k.mesa_id?`@mesa:${k.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${_.length} comandas abertas. IDs: ${S}. Feche todas antes de encerrar o caixa.`)}}}catch(y){if(!(y&&y.message)){const b=new Error("Falha ao validar comandas abertas no momento do fechamento. Tente novamente.");throw b.code="CASH_CLOSE_FINAL_CHECK_FAILED",b}throw y}let v=pe.from("caixa_sessoes").update({status:"closed",saldo_final:h,fechado_em:u}).eq("id",l).eq("status","open");n&&(v=v.eq("codigo_empresa",n));const{data:g,error:x}=await v.select("id,status,fechado_em,saldo_final").single();if(x){const y=String(x.message||"");if(y.toLowerCase().includes("row")||y.toLowerCase().includes("single")){let b=pe.from("caixa_sessoes").select("id,status,fechado_em,saldo_final").eq("id",l).limit(1);n&&(b=b.eq("codigo_empresa",n));const{data:w}=await b;if(w&&w[0])return w[0]}throw x}try{if(c&&u&&g?.status==="closed"){let y;try{y=await B_({caixaSessaoId:l,codigoEmpresa:n})}catch{y=await id({from:c,to:u,codigoEmpresa:n})}const b={codigo_empresa:n||Wn(),caixa_sessao_id:l,periodo_de:y?.from||c,periodo_ate:y?.to||u,total_bruto:Number(y?.totalVendasBrutas||0),total_descontos:Number(y?.totalDescontos||0),total_liquido:Number(y?.totalVendasLiquidas||0),total_entradas:Number(y?.totalEntradas||0),por_finalizadora:y?.totalPorFinalizadora||{}},w=t!=null?Number(t):null,j=w!=null?w-Number(h||0):null;console.log("[fecharCaixa] Valores para snapshot:",{contado:w,diferenca:j,efetivoSaldoFinal:h,valorFinalDinheiroOriginal:t});const S=await(async k=>{const E={...k},A=E.por_finalizadora;A&&typeof A!="string"&&(E.por_finalizadora=JSON.stringify(A));let M=!0,C=!0;try{const q=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),$=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");q==="no"&&(M=!1),$==="no"&&(C=!1)}catch{}if(!M||!C)try{let q=pe.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:$}=await q;if(!$){M=!0,C=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}if(!M&&!C)return await pe.from("caixa_resumos").insert(E);let T={...E};M&&w!=null&&(T.valor_final_dinheiro=w),C&&j!=null&&(T.diferenca_dinheiro=j),console.log("[fecharCaixa] Tentando inserir snapshot com:",{supportValor:M,supportDif:C,contado:w,diferenca:j,hasValorFinalDinheiro:"valor_final_dinheiro"in T});const I=await pe.from("caixa_resumos").insert(T);if(!I.error)return I;const D=`${I.error?.message||""} ${I.error?.details||""}`.toLowerCase(),F=I.error?.code;if(F==="42703"||F==="PGRST204"||D.includes("column")||D.includes("schema cache")){try{T.valor_final_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),T.diferenca_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}return await pe.from("caixa_resumos").insert(E)}return I})(b);if(S.error)throw console.error("[fecharCaixa] Erro ao inserir snapshot:",S.error),S.error;console.log("[fecharCaixa]  Snapshot inserido com sucesso");try{const{data:k}=await pe.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").eq("caixa_sessao_id",l).order("criado_em",{ascending:!1}).limit(1).single();console.log("[fecharCaixa] Verificao ps-insert:",k)}catch(k){console.warn("[fecharCaixa] Falha ao verificar snapshot:",k?.message)}}}catch(y){console.warn("[fecharCaixa] Falha ao gravar snapshot de fechamento:",y)}try{let y=pe.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open");n&&(y=y.eq("codigo_empresa",n));const{data:b}=await y;if(Array.isArray(b)&&b.length>0)for(const w of b)try{const j=w?.aberto_em,_=Number(w?.saldo_inicial||0),S=new Date().toISOString();let k=0,E=0;try{const M=await id({from:j,to:S,codigoEmpresa:n});k=Number(M?.totalEntradas||0)}catch{}try{let M=pe.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",w.id);n&&(M=M.eq("codigo_empresa",n));const{data:C}=await M;for(const T of C||[]){const I=Number(T?.valor||0),D=String(T?.tipo||"").toLowerCase();D==="suprimento"||D==="ajuste"?E+=I:(D==="sangria"||D==="troco")&&(E-=I)}}catch{}const A=_+k+E;await pe.from("caixa_sessoes").update({status:"closed",saldo_final:A,fechado_em:S}).eq("id",w.id).eq("status","open").eq(n?"codigo_empresa":"id",n||w.id);try{const M=await B_({caixaSessaoId:w.id,codigoEmpresa:n}).catch(async()=>await id({from:j,to:S,codigoEmpresa:n})),C={codigo_empresa:n||Wn(),caixa_sessao_id:w.id,periodo_de:M?.from||j,periodo_ate:M?.to||S,total_bruto:Number(M?.totalVendasBrutas||0),total_descontos:Number(M?.totalDescontos||0),total_liquido:Number(M?.totalVendasLiquidas||0),total_entradas:Number(M?.totalEntradas||0),por_finalizadora:M?.totalPorFinalizadora||{}},T=C.por_finalizadora;await pe.from("caixa_resumos").insert({...C,por_finalizadora:T&&typeof T!="string"?JSON.stringify(T):T})}catch{}}catch(j){try{console.warn("[fecharCaixa] Saneamento: falhou ao fechar sesso remanescente",w?.id,j?.message||j)}catch{}}}catch{}return g}async function ere({from:e,to:t,limit:r=50,codigoEmpresa:n}={}){console.log("[listarFechamentosCaixa] Iniciando busca de fechamentos",{from:e,to:t,limit:r});const a=n||Wn();let i=pe.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final, status").eq("status","closed").order("fechado_em",{ascending:!1}).limit(r);a&&(i=i.eq("codigo_empresa",a)),e&&(i=i.gte("fechado_em",`${e}T00:00:00`)),t&&(i=i.lte("fechado_em",`${t}T23:59:59`));const{data:s,error:l}=await i;if(l)throw l;const c=Array.isArray(s)?s:[];if(console.log("[listarFechamentosCaixa] Sesses fechadas encontradas:",c.length),c.length===0)return[];const d=c.map(h=>h.id);let u=[];try{let h=!0,v=!0;try{const j=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),_=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");j==="no"&&(h=!1),_==="no"&&(v=!1)}catch{}if(!h||!v)try{let j=pe.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:_}=await j;if(!_){h=!0,v=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const g=["caixa_sessao_id"];h&&g.push("valor_final_dinheiro"),v&&g.push("diferenca_dinheiro");const x=g.join(", ");let y=pe.from("caixa_resumos").select(x).in("caixa_sessao_id",d).order("criado_em",{ascending:!1});a&&(y=y.eq("codigo_empresa",a));let{data:b,error:w}=await y;if(w){const j=w?.code,_=`${w?.message||""} ${w?.details||""}`.toLowerCase();if(j==="42703"||j==="PGRST204"||_.includes("column")||_.includes("schema cache")){try{h&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),v&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let k=pe.from("caixa_resumos").select("caixa_sessao_id").in("caixa_sessao_id",d).order("criado_em",{ascending:!1});a&&(k=k.eq("codigo_empresa",a));const{data:E}=await k;u=E||[]}else throw w}else u=b||[]}catch(h){console.warn("[listarFechamentosCaixa] Erro ao buscar snapshots:",h?.message),u=[]}console.log("[listarFechamentosCaixa] Snapshots encontrados:",u.length,u);const f=new Map(u.map(h=>[h.caixa_sessao_id,h])),m=c.map(h=>{const v=f.get(h.id),g={...h,valor_final_dinheiro:v?.valor_final_dinheiro??null,diferenca_dinheiro:v?.diferenca_dinheiro??null};return v&&console.log(`[listarFechamentosCaixa] Sesso ${h.id} enriquecida com snapshot:`,{valor_final_dinheiro:v.valor_final_dinheiro,diferenca_dinheiro:v.diferenca_dinheiro}),g});return console.log("[listarFechamentosCaixa] Resultado final:",m.length,"sesses com dados enriquecidos"),m}async function q_({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||Wn();let n=null;try{let a=!0,i=!0;try{const f=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),m=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");f==="no"&&(a=!1),m==="no"&&(i=!1)}catch{}if(!a||!i)try{let f=pe.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:m}=await f;if(!m){a=!0,i=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const s=["caixa_sessao_id","periodo_de","periodo_ate","total_bruto","total_descontos","total_liquido","total_entradas","por_finalizadora"];a&&s.push("valor_final_dinheiro"),i&&s.push("diferenca_dinheiro");const l=s.join(", ");let c=pe.from("caixa_resumos").select(l).eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(c=c.eq("codigo_empresa",r));let{data:d,error:u}=await c;if(u){const f=u?.code,m=`${u?.message||""} ${u?.details||""}`.toLowerCase();if(f==="42703"||f==="PGRST204"||m.includes("column")||m.includes("schema cache")){try{a&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),i&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let v=pe.from("caixa_resumos").select("caixa_sessao_id, periodo_de, periodo_ate, total_bruto, total_descontos, total_liquido, total_entradas, por_finalizadora").eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(v=v.eq("codigo_empresa",r));const{data:g}=await v;n=g?.[0]||null}else throw u}else n=d?.[0]||null}catch(a){try{console.warn("[getCaixaResumo] Snapshot select falhou, usando fallback dinmico:",a?.message||a)}catch{}}if(!n||typeof n.saldo_inicial>"u"||typeof n.saldo_final>"u"){const a=await B_({caixaSessaoId:e,codigoEmpresa:r});let i=null;try{let s=pe.from("caixa_sessoes").select("saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(s=s.eq("codigo_empresa",r));const{data:l}=await s;i=l?.[0]||null}catch{}n={codigo_empresa:r,caixa_sessao_id:e,periodo_de:a?.from||null,periodo_ate:a?.to||null,total_bruto:Number(a?.totalVendasBrutas||0),total_descontos:Number(a?.totalDescontos||0),total_liquido:Number(a?.totalVendasLiquidas||0),total_entradas:Number(a?.totalEntradas||0),por_finalizadora:a?.totalPorFinalizadora||{},saldo_inicial:Number(i?.saldo_inicial??a?.saldoInicial??0),saldo_final:i?.saldo_final!=null?Number(i.saldo_final):null,movimentos:a?.movimentos||{suprimentos:0,sangrias:0,ajustes:0,troco:0,totalMovimentos:0}}}else if(typeof n.por_finalizadora=="string")try{n.por_finalizadora=JSON.parse(n.por_finalizadora)}catch{n.por_finalizadora={}}return n}async function e4({tipo:e,valor:t,observacao:r="",caixaSessaoId:n,codigoEmpresa:a}={}){const i=a||Wn();if(!e||!["sangria","suprimento","troco","ajuste"].includes(e))throw new Error("Tipo invlido de movimentao");let s=n;if(!s){let u=pe.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);i&&(u=u.eq("codigo_empresa",i));const{data:f,error:m}=await u;if(m)throw m;s=f?.[0]?.id||null}if(!s)throw new Error("Sesso de caixa no encontrada para registrar movimentao");const l={codigo_empresa:i,caixa_sessao_id:s,tipo:e,valor:Math.max(0,Number(t)||0),observacao:(r||"").trim()||null},{data:c,error:d}=await pe.from("caixa_movimentacoes").insert(l).select("*").single();if(d)throw d;return c}async function Ip({caixaSessaoId:e,codigoEmpresa:t}={}){const r=t||Wn();if(!e)throw new Error("caixaSessaoId  obrigatrio");let n=pe.from("caixa_movimentacoes").select("*").eq("caixa_sessao_id",e).order("criado_em",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;return a||[]}async function SGe({mesaId:e,codigoEmpresa:t}={}){const r=t||Wn();await vM({codigoEmpresa:r}),console.log(`[abrirComandaParaMesa] Iniciando para mesaId: ${e}, codigo_empresa: ${r}`);try{const n={status:"open",aberto_em:new Date().toISOString()};e&&(n.mesa_id=e),console.log("[abrirComandaParaMesa] Payload (codigo_empresa via DEFAULT):",n);const{data:a,error:i}=await pe.from("comandas").insert(n).select("*").single();if(i)throw console.error("[abrirComandaParaMesa] ERRO ao criar comanda:",i),i;return console.log("[abrirComandaParaMesa]  Comanda criada:",a),await new Promise(s=>setTimeout(s,100)),a}catch(n){throw console.error("[abrirComandaParaMesa] ERRO:",n),n}}async function CGe({mesaId:e,codigoEmpresa:t}){const r=t||Wn();let n=pe.from("comandas").select("id,status,aberto_em,fechado_em").eq("mesa_id",e).is("fechado_em",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;return a?.[0]||null}async function Si({comandaId:e,codigoEmpresa:t}){const r=t||Wn();let n=pe.from("comanda_itens").select("*").eq("comanda_id",e).order("created_at",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;return a||[]}async function Gv({codigoEmpresa:e}){const t=e||Wn();let r=pe.from("comandas").select("id").is("fechado_em",null);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:a}=await r;if(a)throw a;if(console.log("[listarItensDeTodasComandasAbertas] Comandas abertas:",n?.length||0,"IDs:",n?.map(d=>d.id)),!n||n.length===0)return console.log("[listarItensDeTodasComandasAbertas] Nenhuma comanda aberta encontrada"),[];const i=n.map(d=>d.id);let s=pe.from("comanda_itens").select("produto_id, quantidade").in("comanda_id",i);t&&(s=s.eq("codigo_empresa",t));const{data:l,error:c}=await s;if(c)throw c;return console.log("[listarItensDeTodasComandasAbertas] Itens encontrados:",l?.length||0),l&&l.length>0&&console.log("[listarItensDeTodasComandasAbertas] Detalhes dos itens:",l),l||[]}const $2=new Map;async function PGe({mesaId:e,codigoEmpresa:t}={}){const r=`${e}:${t||Wn()}`;if($2.has(r))return console.log(`[getOrCreateComandaForMesa]  Operao j em andamento para mesa ${e}, aguardando...`),$2.get(r);const n=t||Wn(),a=(async()=>{try{await vM({codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Criando nova comanda para mesa ${e}`);const i=await CGe({mesaId:e,codigoEmpresa:n});if(i){console.log(`[getOrCreateComandaForMesa]  Comanda existente ${i.id} encontrada, verificando se est vazia...`);let l=!1,c=!1;try{l=(await Si({comandaId:i.id,codigoEmpresa:n})||[]).length>0}catch{}try{const{data:d}=await pe.from("pagamentos").select("id, status").eq("comanda_id",i.id).eq("codigo_empresa",n);c=(d||[]).filter(f=>{const m=String(f?.status||"Pago");return m!=="Cancelado"&&m!=="Estornado"}).length>0}catch{}if(!l&&!c){console.log(`[getOrCreateComandaForMesa]  Comanda ${i.id} est vazia, fechando automaticamente...`);try{await Bx({comandaId:i.id,codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Comanda ${i.id} fechada com sucesso`)}catch(d){console.warn(`[getOrCreateComandaForMesa]  Erro ao fechar comanda ${i.id}:`,d?.message)}}else console.log(`[getOrCreateComandaForMesa]  Comanda ${i.id} tem dados (itens: ${l}, pagamentos: ${c}), no ser fechada automaticamente`)}console.log(`[getOrCreateComandaForMesa]  Criando comanda zerada para mesa ${e}`);const s=await SGe({mesaId:e,codigoEmpresa:n});return console.log(`[getOrCreateComandaForMesa]  Comanda ${s.id} criada com sucesso`),s}finally{$2.delete(r),console.log(`[getOrCreateComandaForMesa]  Lock liberado para mesa ${e}`)}})();return $2.set(r,a),a}async function Kv({comandaId:e,clienteIds:t=[],nomesLivres:r=[],codigoEmpresa:n,replace:a=!1}={}){const i=n||Wn();if(!e)throw new Error("comandaId  obrigatrio");let s=[],l=[];try{s=Array.isArray(t)?t:t?[t]:[]}catch(h){console.warn("[adicionarClientesAComanda] Erro ao processar clienteIds:",h),s=[]}try{l=Array.isArray(r)?r:r?[r]:[]}catch(h){console.warn("[adicionarClientesAComanda] Erro ao processar nomesLivres:",h),l=[]}const c=s.map(h=>h&&typeof h=="object"?h.id||h.cliente_id||h.value:h).filter(Boolean),d=l.map(h=>h&&typeof h=="object"?h.nome||h.name||h.label:h).map(h=>String(h||"").trim()).filter(Boolean);if(console.log(`[adicionarClientesAComanda] Adicionando clientes  comanda ${e}:`,{clienteIds:c,nomesLivres:d,codigo:i,replace:a}),a){const{error:h}=await pe.from("comanda_clientes").delete().eq("comanda_id",e);h&&console.warn("[adicionarClientesAComanda] Erro ao limpar clientes existentes:",h)}const u=[];if(Array.isArray(c)){let h=[];if(!a)try{const{data:g}=await pe.from("comanda_clientes").select("cliente_id, nome_livre").eq("comanda_id",e);h=Array.isArray(g)?g:[]}catch{}const v=new Set((h||[]).map(g=>g.cliente_id).filter(Boolean));for(let g=0;g<c.length;g++){const x=c[g];x&&(!a&&v.has(x)||u.push({comanda_id:e,cliente_id:x}))}}if(Array.isArray(d))for(let h=0;h<d.length;h++){const g=(d[h]||"").trim();g&&u.push({comanda_id:e,nome_livre:g})}if(u.length===0)return console.log("[adicionarClientesAComanda] Nenhum cliente para adicionar"),!0;let f=[];Array.isArray(u)&&(f=u.map(h=>i?{...h,codigo_empresa:i}:h)),console.log("[adicionarClientesAComanda] Payload para insero:",f);const{error:m}=await pe.from("comanda_clientes").insert(f);if(m)throw console.error("[adicionarClientesAComanda] ERRO ao inserir clientes:",m),m;return console.log("[adicionarClientesAComanda] Clientes adicionados com sucesso"),!0}async function Qi({comandaId:e,codigoEmpresa:t}={}){if(t||Wn(),!e)throw new Error("comandaId  obrigatrio");try{const{data:r,error:n}=await pe.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!comanda_clientes_cliente_id_fkey(id, codigo, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(n)throw n;return(r||[]).map(a=>({id:a.id,tipo:a.cliente_id?"cadastrado":"livre",nome:a.clientes?.nome||a.nome_livre,cliente_id:a.cliente_id}))}catch{try{const{data:n,error:a}=await pe.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!fk_comanda_clientes_cliente(id, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(a)throw a;return(n||[]).map(i=>({id:i.id,tipo:i.cliente_id?"cadastrado":"livre",nome:i.clientes?.nome||i.nome_livre,cliente_id:i.cliente_id}))}catch{const{data:a,error:i}=await pe.from("comanda_clientes").select("id, cliente_id, nome_livre").eq("comanda_id",e).order("created_at",{ascending:!0});if(i)throw i;return(a||[]).map(s=>({id:s.id,tipo:s.cliente_id?"cadastrado":"livre",nome:s.nome_livre||"",cliente_id:s.cliente_id}))}}}async function t4({comandaId:e,produtoId:t,descricao:r,quantidade:n,precoUnitario:a,desconto:i=0,codigoEmpresa:s}){const l=s||Wn();console.log(`[adicionarItem] Adicionando item  comanda ${e}:`,{produtoId:t,descricao:r,quantidade:n,precoUnitario:a,codigo:l});try{let f=pe.from("produtos").select("id, estoque, estoque_minimo, nome").eq("id",t).limit(1);l&&(f=f.eq("codigo_empresa",l));const{data:m,error:h}=await f;if(h)throw h;const v=Array.isArray(m)?m[0]:m;if(v){const g=Number(v.estoque??0),x=Number(v.estoque_minimo??0),y=Number(n??1);if(g<=0){const k=new Error(`Produto sem estoque: ${v.nome||""}`.trim());throw k.code="OUT_OF_STOCK",k}let b=pe.from("comanda_itens").select("quantidade").eq("comanda_id",e).eq("produto_id",t);l&&(b=b.eq("codigo_empresa",l));const{data:w,error:j}=await b;if(j)throw j;const _=Array.isArray(w)&&w.length?w.reduce((k,E)=>k+Number(E?.quantidade||0),0):0;if(_+y>g){const k=new Error(`Estoque insuficiente. Em comanda: ${_}, solicitado: +${y}, disponvel: ${g}`);throw k.code="INSUFFICIENT_STOCK",k}if(g<=x&&g>0)try{console.warn(`[adicionarItem] Aviso: estoque baixo para produto '${v.nome}' (estoque=${g}, minimo=${x})`)}catch{}}}catch(f){throw f}const c={comanda_id:e,produto_id:t,descricao:r,quantidade:n,preco_unitario:a,desconto:i};l&&(c.codigo_empresa=l);const{data:d,error:u}=await pe.from("comanda_itens").insert(c).select("*").single();if(u)throw u;return d}async function Wc({itemId:e,quantidade:t,codigoEmpresa:r}){const n=r||Wn();let a=pe.from("comanda_itens").select("id, quantidade, produto_id, comanda_id").eq("id",e).limit(1);n&&(a=a.eq("codigo_empresa",n));const{data:i,error:s}=await a;if(s)throw s;const l=Array.isArray(i)?i[0]:i,c=Number(t||0);if(!l)throw new Error("Item no encontrado");const d=Number(l.quantidade||0);if(c-d>0){let v=pe.from("produtos").select("id, estoque, nome, estoque_minimo").eq("id",l.produto_id).limit(1);n&&(v=v.eq("codigo_empresa",n));const{data:g,error:x}=await v;if(x)throw x;const y=Array.isArray(g)?g[0]:g;if(y){const b=Number(y.estoque??0);let w=pe.from("comanda_itens").select("quantidade").eq("comanda_id",l.comanda_id).eq("produto_id",l.produto_id).neq("id",l.id);n&&(w=w.eq("codigo_empresa",n));const{data:j,error:_}=await w;if(_)throw _;const S=Array.isArray(j)&&j.length?j.reduce((M,C)=>M+Number(C?.quantidade||0),0):0;if(S+c>b){const M=new Error(`Estoque insuficiente. Em comanda (outros itens): ${S}, novo para este item: ${c}, disponvel: ${b}`);throw M.code="INSUFFICIENT_STOCK",M}const E=Number(y.estoque_minimo??0),A=b-(S+c);if(A<=E&&A>=0)try{console.warn(`[atualizarQuantidadeItem] Aviso: produto '${y.nome}' atingiu nvel de estoque baixo (restante=${A}, minimo=${E})`)}catch{}}}let f=pe.from("comanda_itens").update({quantidade:c}).eq("id",e);n&&(f=f.eq("codigo_empresa",n));const{data:m,error:h}=await f.select("*").single();if(h)throw h;return m}async function Av({itemId:e,codigoEmpresa:t}){const r=t||Wn();let n=pe.from("comanda_itens").delete().eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n.select("id");if(i&&i.code!=="PGRST116")throw i;return Array.isArray(a)&&a.length>0}function AGe(e){if(!e)return!1;const t=e.code?String(e.code):"",r=[e.message,e.details,e.hint].filter(Boolean).join(" ").toLowerCase();return t==="22P02"||r.includes("invalid input value for enum")}async function yM({comandaId:e,finalizadoraId:t,metodo:r,valor:n,status:a="Pago",codigoEmpresa:i,clienteId:s=null}){const l=i||Wn();if(!l)throw new Error("Empresa no identificada (codigo_empresa ausente).");const c=a&&["Pendente","Pago","Estornado","Cancelado"].includes(a)?a:"Pago",d=["dinheiro","credito","debito","pix","voucher","outros"],f=(h=>{if(!h)return"outros";const v=String(h).toLowerCase().trim(),x={"cartao credito":"credito","carto credito":"credito","cartao debito":"debito","carto debito":"debito","carto de credito":"credito","carto de dbito":"debito","cartao de credito":"credito","cartao de debito":"debito"}[v]||v;return d.includes(x)?x:"outros"})(r),m={comanda_id:e,finalizadora_id:t||null,metodo:f,valor:Math.max(0,Number(n)||0),status:c,recebido_em:new Date().toISOString(),codigo_empresa:l};s&&(m.cliente_id=s),console.log("[registrarPagamento] Iniciando registro de pagamento:",{comandaId:e,finalizadoraId:t,metodo:f,valor:m.valor,status:m.status,codigoEmpresa:l,payload:m});try{const{data:h,error:v}=await pe.from("pagamentos").insert(m).select().single();if(v){console.warn("[registrarPagamento] Primeira tentativa falhou:",{code:v.code,message:v.message});const g=`${v?.message||""} ${v?.details||""}`.toLowerCase();if(v?.code==="42703"||g.includes("column")&&g.includes("cliente_id")){const{cliente_id:y,...b}=m;try{localStorage.setItem("schema:pagamentos:cliente_id","no")}catch{}const{data:w,error:j}=await pe.from("pagamentos").insert(b).select().single();if(j)throw j;return console.log("[registrarPagamento] Pagamento registrado sem cliente_id:",w),w}if(AGe(v)){console.log("[registrarPagamento] Tentando abordagem alternativa sem status...");try{const y={...m};delete y.status;const{data:b,error:w}=await pe.from("pagamentos").insert(y).select().single();if(w)throw w;return console.log("[registrarPagamento] Pagamento registrado com sucesso (abordagem alternativa):",b),b}catch(y){throw console.error("[registrarPagamento] Falha na abordagem alternativa:",y),new Error(`Falha ao processar pagamento: ${y.message}`)}}throw v}return console.log("[registrarPagamento] Pagamento registrado com sucesso:",h),h}catch(h){throw console.error("[registrarPagamento] Erro ao registrar pagamento:",{error:{message:h.message,code:h.code,details:h.details,hint:h.hint},comandaId:e,finalizadoraId:t,valor:m.valor,status:m.status,codigoEmpresa:l}),h}}async function Bx({comandaId:e,codigoEmpresa:t,diferencaPagamento:r}){const n=t||Wn(),a="[fecharComandaEMesa]";try{console.group(a)}catch{}try{console.time?.(a)}catch{}try{console.log(`${a} Iniciando fechamento da comanda ${e}`),console.log(`${a} Obtendo dados da comanda...`);const{data:i,error:s}=await pe.from("comandas").select("id, mesa_id, status, fechado_em").eq("id",e).single();if(s||!i)throw console.error(`${a} Erro ao buscar comanda:`,s?.message||"Comanda no encontrada"),s||new Error("Comanda no encontrada");if(i.fechado_em)return console.log(`${a} Comanda ${e} j est fechada em ${i.fechado_em}`),!0;const l=new Date().toISOString();console.log(`${a} Atualizando comanda...`);const c={status:"closed",fechado_em:l};typeof r=="number"&&Number.isFinite(r)&&(c.diferenca_pagamento=r),console.log(`${a} Fechando comanda com status closed + fechado_em${c.diferenca_pagamento!=null?" + diferenca_pagamento":""}...`);let{error:d}=await pe.from("comandas").update(c).eq("id",e).eq("codigo_empresa",n);if(d&&d.code==="42703"){console.warn(`${a} Coluna diferenca_pagamento ausente no schema, tentando novamente sem ela...`);const u={status:"closed",fechado_em:l};({error:d}=await pe.from("comandas").update(u).eq("id",e).eq("codigo_empresa",n))}if(d)throw console.error(`${a} Erro ao fechar comanda:`,d),d;if(console.log(`${a} Comanda ${e} fechada com sucesso`),i.mesa_id){console.log(`${a} Atualizando status da mesa ${i.mesa_id} para disponvel...`);try{const{error:u}=await pe.from("mesas").update({status:"available"}).eq("id",i.mesa_id).select("id").single();u?console.error(`${a} Erro ao atualizar status da mesa:`,u):console.log(`${a} Mesa ${i.mesa_id} marcada como disponvel`)}catch(u){console.error(`${a} Exceo ao atualizar mesa:`,u)}}else console.log(`${a} Nenhuma mesa associada para liberar`);return console.log(`${a} Fechamento da comanda ${e} concludo com sucesso`),!0}catch(i){throw console.error(`${a} Erro fatal ao fechar comanda:`,i),i}finally{try{console.timeEnd?.(a)}catch{}try{console.groupEnd()}catch{}}}async function zq({comandaId:e,codigoEmpresa:t}){const r=t||Wn(),n="[cancelarComandaEMesa]";try{console.group(n)}catch{}try{console.time?.(n)}catch{}try{if(!e)throw new Error("comandaId obrigatrio");if(!r)throw new Error("codigo_empresa obrigatrio");console.log(`${n} Cancelando comanda ${e}`);const{data:a}=await pe.from("comandas").select("id, mesa_id").eq("id",e).single();try{await pe.from("comanda_itens").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}try{await pe.from("comanda_clientes").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}const i=new Date().toISOString(),{data:s,error:l}=await pe.from("comandas").update({status:"cancelled",fechado_em:i}).eq("id",e).eq("codigo_empresa",r).select();if(l)throw console.error(`${n} Erro ao atualizar comanda:`,l),l;if(!s||s.length===0)throw console.error(`${n}  UPDATE no afetou nenhuma linha! Comanda ${e} no foi encontrada ou RLS bloqueou`),new Error("Comanda no encontrada ou sem permisso para cancelar");if(console.log(`${n}  Comanda atualizada:`,s[0]),a?.mesa_id){console.log(`${n} Liberando mesa ${a.mesa_id}`);try{await pe.from("mesas").update({status:"available"}).eq("id",a.mesa_id)}catch(c){console.error(`${n} Erro ao liberar mesa:`,c)}}return console.log(`${n} Comanda ${e} cancelada com sucesso`),!0}catch(a){throw console.error(`${n} Falha:`,a),a}finally{try{console.timeEnd?.(n)}catch{}try{console.groupEnd?.(n)}catch{}}}async function EGe({itemId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:a}={}){const i=a||Wn();if(!e)throw new Error("itemId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let s=pe.from("comanda_itens").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);i&&(s=s.eq("codigo_empresa",i));const{data:l,error:c}=await s.select("*").single();if(c)throw c;return l}async function kGe({comandaId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:a}={}){const i=a||Wn();if(!e)throw new Error("comandaId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let s=pe.from("comandas").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);i&&(s=s.eq("codigo_empresa",i));const{data:l,error:c}=await s.select("*").single();if(c)throw c;return l}async function OGe({itemId:e,codigoEmpresa:t}={}){const r=t||Wn();if(!e)throw new Error("itemId  obrigatrio");let n=pe.from("comanda_itens").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n.select("*").single();if(i)throw i;return a}async function TGe({comandaId:e,codigoEmpresa:t}={}){const r=t||Wn();if(!e)throw new Error("comandaId  obrigatrio");let n=pe.from("comandas").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n.select("*").single();if(i)throw i;return a}async function IGe({comandaId:e,observacoes:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const{error:n}=await pe.from("comandas").update({observacoes:(t||"").trim()||null,observacoes_atualizadas_em:new Date().toISOString()}).eq("id",e);if(n)throw n;return{id:e}}var i5="Tabs",[DGe,jlt]=bd(i5,[r5]),tre=r5(),[MGe,bM]=DGe(i5),rre=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:i,orientation:s="horizontal",dir:l,activationMode:c="automatic",...d}=e,u=JC(l),[f,m]=Df({prop:n,onChange:a,defaultProp:i??"",caller:i5});return o.jsx(MGe,{scope:r,baseId:Yd(),value:f,onValueChange:m,orientation:s,dir:u,activationMode:c,children:o.jsx(Hn.div,{dir:u,"data-orientation":s,...d,ref:t})})});rre.displayName=i5;var nre="TabsList",are=p.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,i=bM(nre,r),s=tre(r);return o.jsx(nte,{asChild:!0,...s,orientation:i.orientation,dir:i.dir,loop:n,children:o.jsx(Hn.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});are.displayName=nre;var ore="TabsTrigger",ire=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...i}=e,s=bM(ore,r),l=tre(r),c=cre(s.baseId,n),d=dre(s.baseId,n),u=n===s.value;return o.jsx(ate,{asChild:!0,...l,focusable:!a,active:u,children:o.jsx(Hn.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...i,ref:t,onMouseDown:Qr(e.onMouseDown,f=>{!a&&f.button===0&&f.ctrlKey===!1?s.onValueChange(n):f.preventDefault()}),onKeyDown:Qr(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&s.onValueChange(n)}),onFocus:Qr(e.onFocus,()=>{const f=s.activationMode!=="manual";!u&&!a&&f&&s.onValueChange(n)})})})});ire.displayName=ore;var sre="TabsContent",lre=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:i,...s}=e,l=bM(sre,r),c=cre(l.baseId,n),d=dre(l.baseId,n),u=n===l.value,f=p.useRef(u);return p.useEffect(()=>{const m=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(m)},[]),o.jsx(Ac,{present:a||u,children:({present:m})=>o.jsx(Hn.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!m,id:d,tabIndex:0,...s,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:m&&i})})});lre.displayName=sre;function cre(e,t){return`${e}-trigger-${t}`}function dre(e,t){return`${e}-content-${t}`}var RGe=rre,ure=are,fre=ire,mre=lre;const Vd=RGe,sd=xe.forwardRef(({className:e,...t},r)=>o.jsx(ure,{ref:r,className:Jt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));sd.displayName=ure.displayName;const ba=xe.forwardRef(({className:e,...t},r)=>o.jsx(fre,{ref:r,className:Jt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));ba.displayName=fre.displayName;const Wi=xe.forwardRef(({className:e,...t},r)=>o.jsx(mre,{ref:r,className:Jt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Wi.displayName=mre.displayName;function hre({open:e,onOpenChange:t,client:r,onSaved:n}){const{toast:a}=ro(),{userProfile:i}=Do(),s=C=>({tipo_pessoa:C?.tipo_pessoa||"PF",tipo_cadastro:C?.tipo_cadastro||"cliente",nome:C?.nome||"",apelido:C?.apelido||"",cpf:C?.cpf||"",cnpj:C?.cnpj||"",rg:C?.rg||"",ie:C?.ie||"",email:C?.email||"",telefone:C?.telefone||"",fone2:C?.fone2||"",celular1:C?.celular1||"",celular2:C?.celular2||"",whatsapp:C?.whatsapp||"",cep:C?.cep||"",endereco:C?.endereco||"",numero:C?.numero||"",complemento:C?.complemento||"",bairro:C?.bairro||"",cidade:C?.cidade||"",uf:C?.uf||"",cidade_ibge:C?.cidade_ibge||"",limite_credito:C?.limite_credito??"",tipo_recebimento:C?.tipo_recebimento||"",regime_tributario:C?.regime_tributario||"",tipo_contribuinte:C?.tipo_contribuinte||"",aniversario:C?.aniversario?String(C.aniversario).slice(0,10):"",sexo:C?.sexo||"",estado_civil:C?.estado_civil||"",nome_mae:C?.nome_mae||"",nome_pai:C?.nome_pai||"",observacoes:C?.observacoes||"",status:C?.status||"active"}),[l,c]=p.useState(s(r)),[d,u]=p.useState("basicos"),[f,m]=p.useState(!1);p.useEffect(()=>{let C="cliente";r?.flag_cliente&&r?.flag_fornecedor?C="ambos":r?.flag_fornecedor&&(C="fornecedor"),c({tipo_pessoa:r?.tipo_pessoa||"PF",tipo_cadastro:C,nome:r?.nome||"",apelido:r?.apelido||"",cpf:r?.cpf||"",cnpj:r?.cnpj||"",rg:r?.rg||"",ie:r?.ie||"",email:r?.email||"",telefone:r?.telefone||"",fone2:r?.fone2||"",celular1:r?.celular1||"",celular2:r?.celular2||"",whatsapp:r?.whatsapp||"",cep:r?.cep||"",endereco:r?.endereco||"",numero:r?.numero||"",complemento:r?.complemento||"",bairro:r?.bairro||"",cidade:r?.cidade||"",uf:r?.uf||"",cidade_ibge:r?.cidade_ibge||"",limite_credito:r?.limite_credito??"",tipo_recebimento:r?.tipo_recebimento||"",regime_tributario:r?.regime_tributario||"",tipo_contribuinte:r?.tipo_contribuinte||"",aniversario:r?.aniversario?String(r.aniversario).slice(0,10):"",sexo:r?.sexo||"",estado_civil:r?.estado_civil||"",nome_mae:r?.nome_mae||"",nome_pai:r?.nome_pai||"",observacoes:r?.observacoes||"",status:r?.status||"active"})},[r]),p.useEffect(()=>{e?c(s(r||null)):r||c(s(null))},[e,!!r]);const h=C=>{const{id:T,value:I}=C.target;c(D=>({...D,[T]:I}))},v=C=>C===""?null:C,g=C=>{if(C==null)return null;if(typeof C=="number")return C;const T=String(C).trim();if(!T)return null;const I=T.replace(/\s+/g,"").replace(/\.(?=\d{3}(?:\D|$))/g,"").replace(/,/g,"."),D=Number(I);return Number.isFinite(D)?D:null},x=p.useMemo(()=>({digits:C=>(C||"").replace(/\D+/g,"")}),[]),y=C=>x.digits(C).slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),b=C=>x.digits(C).slice(0,14).replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d{1,2})$/,"$1-$2"),w=C=>x.digits(C).slice(0,8).replace(/(\d{5})(\d)/,"$1-$2"),j=C=>{const T=x.digits(C).slice(0,11);return T.length<=10?T.replace(/(\d{2})(\d{4})(\d{0,4})/,"($1) $2-$3").trim():T.replace(/(\d{2})(\d{5})(\d{0,4})/,"($1) $2-$3").trim()},_=C=>String(C||"").replace(/[^a-z]/gi,"").toUpperCase().slice(0,2),S=(C,T=6)=>x.digits(C).slice(0,T),k=C=>{const T=x.digits(C);return T?(Number(T)/100).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},E=(C,T)=>{let I=T;C==="cpf"&&(I=y(T)),C==="cnpj"&&(I=b(T)),C==="cep"&&(I=w(T)),["telefone","fone2","celular1","celular2","whatsapp"].includes(C)&&(I=j(T)),C==="uf"&&(I=_(T)),C==="numero"&&(I=S(T,8)),C==="cidade_ibge"&&(I=S(T,7)),C==="limite_credito"&&(I=k(T)),c(D=>({...D,[C]:I}))},A=async()=>{const C=x.digits(l.cep);if(!C||C.length!==8){a({title:"CEP invlido",description:"Informe 8 dgitos.",variant:"destructive"});return}try{m(!0),c(D=>({...D,endereco:"Buscando...",bairro:"Buscando...",cidade:"Buscando...",uf:""}));const I=await(await fetch(`https://viacep.com.br/ws/${C}/json/`)).json();if(I.erro)throw new Error("CEP no encontrado");c(D=>({...D,endereco:I.logradouro||"",bairro:I.bairro||"",cidade:I.localidade||"",uf:I.uf||"",cidade_ibge:I.ibge||""})),a({title:"CEP encontrado!",description:"Endereo preenchido automaticamente.",variant:"success"})}catch(T){c(I=>({...I,endereco:"",bairro:"",cidade:"",uf:""})),a({title:"Falha ao buscar CEP",description:T.message||"Tente novamente.",variant:"destructive"})}finally{m(!1)}},M=async C=>{C?.preventDefault?.(),window.__protectPaymentModal&&window.__protectPaymentModal(5e3);try{if(!l.nome||l.nome.trim().length<2)throw new Error("Informe o nome/razo social do cliente.");const T={tipo_pessoa:v(l.tipo_pessoa),nome:l.nome,apelido:v(l.apelido),cpf:v(l.cpf),cnpj:v(l.cnpj),rg:v(l.rg),ie:v(l.ie),email:v(l.email),telefone:v(l.telefone),fone2:v(l.fone2),celular1:v(l.celular1),celular2:v(l.celular2),whatsapp:v(l.whatsapp),cep:v(l.cep),endereco:v(l.endereco),numero:v(l.numero),complemento:v(l.complemento),bairro:v(l.bairro),cidade:v(l.cidade),uf:v(l.uf),cidade_ibge:v(l.cidade_ibge),limite_credito:g(l.limite_credito),tipo_recebimento:v(l.tipo_recebimento),regime_tributario:v(l.regime_tributario),tipo_contribuinte:v(l.tipo_contribuinte),aniversario:v(l.aniversario),sexo:v(l.sexo),estado_civil:v(l.estado_civil),nome_mae:v(l.nome_mae),nome_pai:v(l.nome_pai),observacoes:v(l.observacoes),flag_cliente:l.tipo_cadastro==="cliente"||l.tipo_cadastro==="ambos",flag_fornecedor:l.tipo_cadastro==="fornecedor"||l.tipo_cadastro==="ambos",flag_funcionario:!1,flag_administradora:!1,flag_parceiro:!1,flag_ccf_spc:!1,status:l.status};let I,D=null;if(r?.id){const{data:F,error:z}=await pe.from("clientes").update(T).eq("id",r.id).select().single();I=z,D=F??null}else{const F=i?.codigo_empresa||null;if(!F)throw new Error("No foi possvel identificar a empresa do usurio (codigo_empresa). Tente recarregar a pgina ou entrar novamente.");const z={...T,codigo_empresa:F},{data:q,error:$}=await pe.from("clientes").insert(z).select().single();I=$,D=q??null}if(I)throw I;a({title:"Cliente salvo!",description:"As informaes do cliente foram atualizadas.",variant:"success"}),n?.(D),setTimeout(()=>{t?.(!1)},50)}catch(T){const I=(T?.message||"").toLowerCase(),D=T?.code||"";let F="Erro ao salvar cliente",z=T.message;D==="23505"||I.includes("duplicate key")&&I.includes("uq_clientes_empresa_codigo")?(F="Cdigo j cadastrado",z="J existe um cliente com este cdigo na sua empresa. Deixe o campo cdigo em branco para gerar automaticamente ou escolha outro nmero."):I.includes("column")&&I.includes("does not exist")&&(z="Seu banco pode no estar migrado para os novos campos. Atualize o schema conforme estrutura_bd."),a({title:F,description:z,variant:"destructive"})}};return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(sn,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto w-full",children:[o.jsxs(an,{children:[o.jsx(nn,{children:r?"Editar Cliente":"Novo Cliente"}),o.jsx(_n,{children:"Preencha os dados cadastrais do cliente."})]}),o.jsx("form",{onSubmit:M,className:"grid gap-4 sm:gap-6 py-2",children:o.jsxs(Vd,{value:d,onValueChange:u,className:"w-full",children:[o.jsx("div",{className:"sm:hidden mb-4",children:o.jsxs(En,{value:d,onValueChange:u,children:[o.jsx(Sn,{className:"w-full",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"basicos",children:"Dados Bsicos"}),o.jsx(Nt,{value:"endereco",children:"Endereo"}),o.jsx(Nt,{value:"financeiro",children:"Financeiro"}),o.jsx(Nt,{value:"adicionais",children:"Adicionais"})]})]})}),o.jsxs(sd,{className:"hidden sm:grid grid-cols-4 gap-2",children:[o.jsx(ba,{value:"basicos",children:"Dados Bsicos"}),o.jsx(ba,{value:"endereco",children:"Endereo"}),o.jsx(ba,{value:"financeiro",children:"Financeiro"}),o.jsx(ba,{value:"adicionais",children:"Adicionais"})]}),o.jsx(Wi,{value:"basicos",className:"space-y-3 sm:space-y-4 mt-2",children:o.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{children:"Tipo de Pessoa"}),o.jsxs(En,{value:l.tipo_pessoa,onValueChange:C=>c(T=>({...T,tipo_pessoa:C})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Pessoa"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"PF",children:"Fsica"}),o.jsx(Nt,{value:"PJ",children:"Jurdica"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{children:"Tipo de Cadastro *"}),o.jsxs(En,{value:l.tipo_cadastro,onValueChange:C=>c(T=>({...T,tipo_cadastro:C})),required:!0,children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"cliente",children:"Cliente"}),o.jsx(Nt,{value:"fornecedor",children:"Fornecedor"}),o.jsx(Nt,{value:"ambos",children:"Cliente e Fornecedor"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[o.jsx(Ht,{htmlFor:"nome",children:l.tipo_pessoa==="PJ"?"Razo Social":"Nome"}),o.jsx(ir,{id:"nome",value:l.nome,onChange:h,required:!0})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[o.jsx(Ht,{htmlFor:"apelido",children:l.tipo_pessoa==="PJ"?"Nome Fantasia":"Apelido"}),o.jsx(ir,{id:"apelido",value:l.apelido,onChange:h})]}),l.tipo_pessoa==="PF"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"cpf",children:"CPF"}),o.jsx(ir,{id:"cpf",value:l.cpf,onChange:C=>E("cpf",C.target.value),placeholder:"000.000.000-00"})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"rg",children:"RG"}),o.jsx(ir,{id:"rg",value:l.rg,onChange:h})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"cnpj",children:"CNPJ"}),o.jsx(ir,{id:"cnpj",value:l.cnpj,onChange:C=>E("cnpj",C.target.value),placeholder:"00.000.000/0000-00"})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"ie",children:"Inscrio Estadual (IE)"}),o.jsx(ir,{id:"ie",value:l.ie,onChange:h})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[o.jsx(Ht,{htmlFor:"email",children:"Email"}),o.jsx(ir,{id:"email",type:"email",value:l.email,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"telefone",children:"Telefone"}),o.jsx(ir,{id:"telefone",value:l.telefone,onChange:C=>E("telefone",C.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"celular1",children:"Celular"}),o.jsx(ir,{id:"celular1",value:l.celular1,onChange:C=>E("celular1",C.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"whatsapp",children:"WhatsApp"}),o.jsx(ir,{id:"whatsapp",value:l.whatsapp,onChange:C=>E("whatsapp",C.target.value),placeholder:"(DDD) 9...."})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"fone2",children:"Fone 2"}),o.jsx(ir,{id:"fone2",value:l.fone2,onChange:C=>E("fone2",C.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"celular2",children:"Celular 2"}),o.jsx(ir,{id:"celular2",value:l.celular2,onChange:C=>E("celular2",C.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"aniversario",children:"Nascimento"}),o.jsx(ir,{id:"aniversario",type:"date",value:l.aniversario||"",onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{children:"Status"}),o.jsxs(En,{value:l.status,onValueChange:C=>c(T=>({...T,status:C})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Status"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"active",children:"Ativo"}),o.jsx(Nt,{value:"inactive",children:"Inativo"})]})]})]})]})}),o.jsx(Wi,{value:"endereco",className:"space-y-3 sm:space-y-4 mt-2",children:o.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"cep",children:"CEP"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(ir,{id:"cep",value:l.cep,onChange:C=>E("cep",C.target.value),placeholder:"00000-000"}),o.jsx(le,{type:"button",variant:"outline",onClick:A,disabled:f,children:f?"Buscando...":"Buscar"})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[o.jsx(Ht,{htmlFor:"endereco",children:"Endereo"}),o.jsx(ir,{id:"endereco",value:l.endereco,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"numero",children:"Nmero"}),o.jsx(ir,{id:"numero",value:l.numero,onChange:C=>E("numero",C.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Ht,{htmlFor:"complemento",children:"Complemento"}),o.jsx(ir,{id:"complemento",value:l.complemento,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Ht,{htmlFor:"bairro",children:"Bairro"}),o.jsx(ir,{id:"bairro",value:l.bairro,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"cidade",children:"Cidade"}),o.jsx(ir,{id:"cidade",value:l.cidade,onChange:h})]}),o.jsxs("div",{className:"col-span-6 sm:col-span-1",children:[o.jsx(Ht,{htmlFor:"uf",children:"UF"}),o.jsx(ir,{id:"uf",value:l.uf,onChange:C=>E("uf",C.target.value),placeholder:"UF"})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"cidade_ibge",children:"Cd. IBGE"}),o.jsx(ir,{id:"cidade_ibge",value:l.cidade_ibge,onChange:C=>E("cidade_ibge",C.target.value)})]})]})}),o.jsx(Wi,{value:"financeiro",className:"space-y-3 sm:space-y-4 mt-2",children:o.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{htmlFor:"limite_credito",children:"Limite de Crdito"}),o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary text-sm",children:"R$"}),o.jsx(ir,{id:"limite_credito",value:l.limite_credito,onChange:C=>E("limite_credito",C.target.value),placeholder:"0,00",className:"pl-10"})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{children:"Tipo de Recebimento"}),o.jsxs(En,{value:l.tipo_recebimento||"",onValueChange:C=>c(T=>({...T,tipo_recebimento:C})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"avista",children:" vista"}),o.jsx(Nt,{value:"aprazo",children:"A prazo"}),o.jsx(Nt,{value:"misto",children:"Misto"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{children:"Regime Tributrio"}),o.jsxs(En,{value:l.regime_tributario||"",onValueChange:C=>c(T=>({...T,regime_tributario:C})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"simples",children:"Simples"}),o.jsx(Nt,{value:"lucro_presumido",children:"Lucro Presumido"}),o.jsx(Nt,{value:"lucro_real",children:"Lucro Real"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Ht,{children:"Tipo de Contribuinte"}),o.jsxs(En,{value:l.tipo_contribuinte||"",onValueChange:C=>c(T=>({...T,tipo_contribuinte:C})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"nao_contribuinte",children:"No Contribuinte"}),o.jsx(Nt,{value:"contribuinte",children:"Contribuinte"}),o.jsx(Nt,{value:"isento",children:"Isento"})]})]})]})]})}),o.jsx(Wi,{value:"adicionais",className:"space-y-3 sm:space-y-4 mt-2",children:o.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Ht,{htmlFor:"sexo",children:"Sexo"}),o.jsxs(En,{value:l.sexo||"",onValueChange:C=>c(T=>({...T,sexo:C})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"m",children:"Masculino"}),o.jsx(Nt,{value:"f",children:"Feminino"}),o.jsx(Nt,{value:"o",children:"Outro"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Ht,{htmlFor:"estado_civil",children:"Estado Civil"}),o.jsxs(En,{value:l.estado_civil||"",onValueChange:C=>c(T=>({...T,estado_civil:C})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"solteiro",children:"Solteiro(a)"}),o.jsx(Nt,{value:"casado",children:"Casado(a)"}),o.jsx(Nt,{value:"divorciado",children:"Divorciado(a)"}),o.jsx(Nt,{value:"viuvo",children:"Vivo(a)"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Ht,{htmlFor:"nome_mae",children:"Nome da Me"}),o.jsx(ir,{id:"nome_mae",value:l.nome_mae,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Ht,{htmlFor:"nome_pai",children:"Nome do Pai"}),o.jsx(ir,{id:"nome_pai",value:l.nome_pai,onChange:h})]}),o.jsxs("div",{className:"col-span-12",children:[o.jsx(Ht,{htmlFor:"observacoes",children:"Observaes"}),o.jsx("textarea",{id:"observacoes",value:l.observacoes,onChange:h,rows:4,className:"w-full rounded-md border border-border bg-background p-2 text-sm"})]})]})})]})}),o.jsxs(Un,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[o.jsx(Xm,{asChild:!0,children:o.jsx(le,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),o.jsx(le,{type:"submit",onClick:M,className:"w-full sm:w-auto",children:"Salvar Cliente"})]})]})})}function LGe(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),a=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(a),t&&(n.href=t),a.href=e,a.href}const $Ge=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function eh(e){const t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}let Ug=null;function pre(e={}){return Ug||(e.includeStyleProperties?(Ug=e.includeStyleProperties,Ug):(Ug=eh(window.getComputedStyle(document.documentElement)),Ug))}function z_(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function FGe(e){const t=z_(e,"border-left-width"),r=z_(e,"border-right-width");return e.clientWidth+t+r}function BGe(e){const t=z_(e,"border-top-width"),r=z_(e,"border-bottom-width");return e.clientHeight+t+r}function gre(e,t={}){const r=t.width||FGe(e),n=t.height||BGe(e);return{width:r,height:n}}function qGe(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const Xl=16384;function zGe(e){(e.width>Xl||e.height>Xl)&&(e.width>Xl&&e.height>Xl?e.width>e.height?(e.height*=Xl/e.width,e.width=Xl):(e.width*=Xl/e.height,e.height=Xl):e.width>Xl?(e.height*=Xl/e.width,e.width=Xl):(e.width*=Xl/e.height,e.height=Xl))}function U_(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>t(n))})},n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function UGe(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function VGe(e,t,r){const n="http://www.w3.org/2000/svg",a=document.createElementNS(n,"svg"),i=document.createElementNS(n,"foreignObject");return a.setAttribute("width",`${t}`),a.setAttribute("height",`${r}`),a.setAttribute("viewBox",`0 0 ${t} ${r}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),a.appendChild(i),i.appendChild(e),UGe(a)}const Rl=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||Rl(r,t)};function WGe(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function HGe(e,t){return pre(t).map(r=>{const n=e.getPropertyValue(r),a=e.getPropertyPriority(r);return`${r}: ${n}${a?" !important":""};`}).join(" ")}function GGe(e,t,r,n){const a=`.${e}:${t}`,i=r.cssText?WGe(r):HGe(r,n);return document.createTextNode(`${a}{${i}}`)}function Uq(e,t,r,n){const a=window.getComputedStyle(e,r),i=a.getPropertyValue("content");if(i===""||i==="none")return;const s=$Ge();try{t.className=`${t.className} ${s}`}catch{return}const l=document.createElement("style");l.appendChild(GGe(s,r,a,n)),t.appendChild(l)}function KGe(e,t,r){Uq(e,t,":before",r),Uq(e,t,":after",r)}const Vq="application/font-woff",Wq="image/jpeg",YGe={woff:Vq,woff2:Vq,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Wq,jpeg:Wq,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function XGe(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function wM(e){const t=XGe(e).toLowerCase();return YGe[t]||""}function JGe(e){return e.split(/,/)[1]}function r4(e){return e.search(/^(data:)/)!==-1}function vre(e,t){return`data:${t};base64,${e}`}async function xre(e,t,r){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const a=await n.blob();return new Promise((i,s)=>{const l=new FileReader;l.onerror=s,l.onloadend=()=>{try{i(r({res:n,result:l.result}))}catch(c){s(c)}},l.readAsDataURL(a)})}const RA={};function QGe(e,t,r){let n=e.replace(/\?.*/,"");return r&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function jM(e,t,r){const n=QGe(e,t,r.includeQueryParams);if(RA[n]!=null)return RA[n];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let a;try{const i=await xre(e,r.fetchRequestInit,({res:s,result:l})=>(t||(t=s.headers.get("Content-Type")||""),JGe(l)));a=vre(i,t)}catch(i){a=r.imagePlaceholder||"";let s=`Failed to fetch resource: ${e}`;i&&(s=typeof i=="string"?i:i.message),s&&console.warn(s)}return RA[n]=a,a}async function ZGe(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):U_(t)}async function eKe(e,t){if(e.currentSrc){const i=document.createElement("canvas"),s=i.getContext("2d");i.width=e.clientWidth,i.height=e.clientHeight,s?.drawImage(e,0,0,i.width,i.height);const l=i.toDataURL();return U_(l)}const r=e.poster,n=wM(r),a=await jM(r,n,t);return U_(a)}async function tKe(e,t){var r;try{if(!((r=e?.contentDocument)===null||r===void 0)&&r.body)return await s5(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function rKe(e,t){return Rl(e,HTMLCanvasElement)?ZGe(e):Rl(e,HTMLVideoElement)?eKe(e,t):Rl(e,HTMLIFrameElement)?tKe(e,t):e.cloneNode(yre(e))}const nKe=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",yre=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function aKe(e,t,r){var n,a;if(yre(t))return t;let i=[];return nKe(e)&&e.assignedNodes?i=eh(e.assignedNodes()):Rl(e,HTMLIFrameElement)&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?i=eh(e.contentDocument.body.childNodes):i=eh(((a=e.shadowRoot)!==null&&a!==void 0?a:e).childNodes),i.length===0||Rl(e,HTMLVideoElement)||await i.reduce((s,l)=>s.then(()=>s5(l,r)).then(c=>{c&&t.appendChild(c)}),Promise.resolve()),t}function oKe(e,t,r){const n=t.style;if(!n)return;const a=window.getComputedStyle(e);a.cssText?(n.cssText=a.cssText,n.transformOrigin=a.transformOrigin):pre(r).forEach(i=>{let s=a.getPropertyValue(i);i==="font-size"&&s.endsWith("px")&&(s=`${Math.floor(parseFloat(s.substring(0,s.length-2)))-.1}px`),Rl(e,HTMLIFrameElement)&&i==="display"&&s==="inline"&&(s="block"),i==="d"&&t.getAttribute("d")&&(s=`path(${t.getAttribute("d")})`),n.setProperty(i,s,a.getPropertyPriority(i))})}function iKe(e,t){Rl(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),Rl(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function sKe(e,t){if(Rl(e,HTMLSelectElement)){const r=t,n=Array.from(r.children).find(a=>e.value===a.getAttribute("value"));n&&n.setAttribute("selected","")}}function lKe(e,t,r){return Rl(t,Element)&&(oKe(e,t,r),KGe(e,t,r),iKe(e,t),sKe(e,t)),t}async function cKe(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const n={};for(let i=0;i<r.length;i++){const l=r[i].getAttribute("xlink:href");if(l){const c=e.querySelector(l),d=document.querySelector(l);!c&&d&&!n[l]&&(n[l]=await s5(d,t,!0))}}const a=Object.values(n);if(a.length){const i="http://www.w3.org/1999/xhtml",s=document.createElementNS(i,"svg");s.setAttribute("xmlns",i),s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.overflow="hidden",s.style.display="none";const l=document.createElementNS(i,"defs");s.appendChild(l);for(let c=0;c<a.length;c++)l.appendChild(a[c]);e.appendChild(s)}return e}async function s5(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>rKe(n,t)).then(n=>aKe(e,n,t)).then(n=>lKe(e,n,t)).then(n=>cKe(n,t))}const bre=/url\((['"]?)([^'"]+?)\1\)/g,dKe=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,uKe=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function fKe(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function mKe(e){const t=[];return e.replace(bre,(r,n,a)=>(t.push(a),r)),t.filter(r=>!r4(r))}async function hKe(e,t,r,n,a){try{const i=r?LGe(t,r):t,s=wM(t);let l;if(a){const c=await a(i);l=vre(c,s)}else l=await jM(i,s,n);return e.replace(fKe(t),`$1${l}$3`)}catch{}return e}function pKe(e,{preferredFontFormat:t}){return t?e.replace(uKe,r=>{for(;;){const[n,,a]=dKe.exec(r)||[];if(!a)return"";if(a===t)return`src: ${n};`}}):e}function wre(e){return e.search(bre)!==-1}async function jre(e,t,r){if(!wre(e))return e;const n=pKe(e,r);return mKe(n).reduce((i,s)=>i.then(l=>hKe(l,s,t,r)),Promise.resolve(n))}async function Vg(e,t,r){var n;const a=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(a){const i=await jre(a,null,r);return t.style.setProperty(e,i,t.style.getPropertyPriority(e)),!0}return!1}async function gKe(e,t){await Vg("background",e,t)||await Vg("background-image",e,t),await Vg("mask",e,t)||await Vg("-webkit-mask",e,t)||await Vg("mask-image",e,t)||await Vg("-webkit-mask-image",e,t)}async function vKe(e,t){const r=Rl(e,HTMLImageElement);if(!(r&&!r4(e.src))&&!(Rl(e,SVGImageElement)&&!r4(e.href.baseVal)))return;const n=r?e.src:e.href.baseVal,a=await jM(n,wM(n),t);await new Promise((i,s)=>{e.onload=i,e.onerror=t.onImageErrorHandler?(...c)=>{try{i(t.onImageErrorHandler(...c))}catch(d){s(d)}}:s;const l=e;l.decode&&(l.decode=i),l.loading==="lazy"&&(l.loading="eager"),r?(e.srcset="",e.src=a):e.href.baseVal=a})}async function xKe(e,t){const n=eh(e.childNodes).map(a=>Nre(a,t));await Promise.all(n).then(()=>e)}async function Nre(e,t){Rl(e,Element)&&(await gKe(e,t),await vKe(e,t),await xKe(e,t))}function yKe(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(a=>{r[a]=n[a]}),e}const Hq={};async function Gq(e){let t=Hq[e];if(t!=null)return t;const n=await(await fetch(e)).text();return t={url:e,cssText:n},Hq[e]=t,t}async function Kq(e,t){let r=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,i=(r.match(/url\([^)]+\)/g)||[]).map(async s=>{let l=s.replace(n,"$1");return l.startsWith("https://")||(l=new URL(l,e.url).href),xre(l,t.fetchRequestInit,({result:c})=>(r=r.replace(s,`url(${c})`),[s,c]))});return Promise.all(i).then(()=>r)}function Yq(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(r,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=a.exec(n);if(c===null)break;t.push(c[0])}n=n.replace(a,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",l=new RegExp(s,"gi");for(;;){let c=i.exec(n);if(c===null){if(c=l.exec(n),c===null)break;i.lastIndex=l.lastIndex}else l.lastIndex=i.lastIndex;t.push(c[0])}return t}async function bKe(e,t){const r=[],n=[];return e.forEach(a=>{if("cssRules"in a)try{eh(a.cssRules||[]).forEach((i,s)=>{if(i.type===CSSRule.IMPORT_RULE){let l=s+1;const c=i.href,d=Gq(c).then(u=>Kq(u,t)).then(u=>Yq(u).forEach(f=>{try{a.insertRule(f,f.startsWith("@import")?l+=1:a.cssRules.length)}catch(m){console.error("Error inserting rule from remote css",{rule:f,error:m})}})).catch(u=>{console.error("Error loading remote css",u.toString())});n.push(d)}})}catch(i){const s=e.find(l=>l.href==null)||document.styleSheets[0];a.href!=null&&n.push(Gq(a.href).then(l=>Kq(l,t)).then(l=>Yq(l).forEach(c=>{s.insertRule(c,s.cssRules.length)})).catch(l=>{console.error("Error loading remote stylesheet",l)})),console.error("Error inlining remote css file",i)}}),Promise.all(n).then(()=>(e.forEach(a=>{if("cssRules"in a)try{eh(a.cssRules||[]).forEach(i=>{r.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${a.href}`,i)}}),r))}function wKe(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>wre(t.style.getPropertyValue("src")))}async function jKe(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=eh(e.ownerDocument.styleSheets),n=await bKe(r,t);return wKe(n)}function _re(e){return e.trim().replace(/["']/g,"")}function NKe(e){const t=new Set;function r(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(i=>{t.add(_re(i))}),Array.from(n.children).forEach(i=>{i instanceof HTMLElement&&r(i)})}return r(e),t}async function _Ke(e,t){const r=await jKe(e,t),n=NKe(e);return(await Promise.all(r.filter(i=>n.has(_re(i.style.fontFamily))).map(i=>{const s=i.parentStyleSheet?i.parentStyleSheet.href:null;return jre(i.cssText,s,t)}))).join(`
`)}async function SKe(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await _Ke(e,t);if(r){const n=document.createElement("style"),a=document.createTextNode(r);n.appendChild(a),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function CKe(e,t={}){const{width:r,height:n}=gre(e,t),a=await s5(e,t,!0);return await SKe(a,t),await Nre(a,t),yKe(a,t),await VGe(a,r,n)}async function PKe(e,t={}){const{width:r,height:n}=gre(e,t),a=await CKe(e,t),i=await U_(a),s=document.createElement("canvas"),l=s.getContext("2d"),c=t.pixelRatio||qGe(),d=t.canvasWidth||r,u=t.canvasHeight||n;return s.width=d*c,s.height=u*c,t.skipAutoScale||zGe(s),s.style.width=`${d}`,s.style.height=`${u}`,t.backgroundColor&&(l.fillStyle=t.backgroundColor,l.fillRect(0,0,s.width,s.height)),l.drawImage(i,0,0,s.width,s.height),s}async function AKe(e,t={}){return(await PKe(e,t)).toDataURL()}var nu=Uint8Array,uc=Uint16Array,NM=Int32Array,_M=new nu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),SM=new nu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Xq=new nu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Sre=function(e,t){for(var r=new uc(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new NM(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},Cre=Sre(_M,2),EKe=Cre.b,n4=Cre.r;EKe[28]=258,n4[258]=28;var kKe=Sre(SM,0),Jq=kKe.r,a4=new uc(32768);for(var To=0;To<32768;++To){var sm=(To&43690)>>1|(To&21845)<<1;sm=(sm&52428)>>2|(sm&13107)<<2,sm=(sm&61680)>>4|(sm&3855)<<4,a4[To]=((sm&65280)>>8|(sm&255)<<8)>>1}var Xy=function(e,t,r){for(var n=e.length,a=0,i=new uc(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new uc(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var l;if(r){l=new uc(1<<t);var c=15-t;for(a=0;a<n;++a)if(e[a])for(var d=a<<4|e[a],u=t-e[a],f=s[e[a]-1]++<<u,m=f|(1<<u)-1;f<=m;++f)l[a4[f]>>c]=d}else for(l=new uc(n),a=0;a<n;++a)e[a]&&(l[a]=a4[s[e[a]-1]++]>>15-e[a]);return l},og=new nu(288);for(var To=0;To<144;++To)og[To]=8;for(var To=144;To<256;++To)og[To]=9;for(var To=256;To<280;++To)og[To]=7;for(var To=280;To<288;++To)og[To]=8;var V_=new nu(32);for(var To=0;To<32;++To)V_[To]=5;var OKe=Xy(og,9,0),TKe=Xy(V_,5,0),Pre=function(e){return(e+7)/8|0},IKe=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new nu(e.subarray(t,r))},nf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},ty=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},LA=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:Ere,l:0};if(a==1){var s=new nu(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(_,S){return _.f-S.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=a-1;)l=r[r[d].f<r[f].f?d++:f++],c=r[d!=u&&r[d].f<r[f].f?d++:f++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var m=i[0].s,n=1;n<a;++n)i[n].s>m&&(m=i[n].s);var h=new uc(m+1),v=o4(r[u-1],h,0);if(v>t){var n=0,g=0,x=v-t,y=1<<x;for(i.sort(function(S,k){return h[k.s]-h[S.s]||S.f-k.f});n<a;++n){var b=i[n].s;if(h[b]>t)g+=y-(1<<v-h[b]),h[b]=t;else break}for(g>>=x;g>0;){var w=i[n].s;h[w]<t?g-=1<<t-h[w]++-1:++n}for(;n>=0&&g;--n){var j=i[n].s;h[j]==t&&(--h[j],++g)}v=t}return{t:new nu(h),l:v}},o4=function(e,t,r){return e.s==-1?Math.max(o4(e.l,t,r+1),o4(e.r,t,r+1)):t[e.s]=r},Qq=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new uc(++t),n=0,a=e[0],i=1,s=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==a&&l!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[l]}return{c:r.subarray(0,n),n:t}},ry=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},Are=function(e,t,r){var n=r.length,a=Pre(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},Zq=function(e,t,r,n,a,i,s,l,c,d,u){nf(t,u++,r),++a[256];for(var f=LA(a,15),m=f.t,h=f.l,v=LA(i,15),g=v.t,x=v.l,y=Qq(m),b=y.c,w=y.n,j=Qq(g),_=j.c,S=j.n,k=new uc(19),E=0;E<b.length;++E)++k[b[E]&31];for(var E=0;E<_.length;++E)++k[_[E]&31];for(var A=LA(k,7),M=A.t,C=A.l,T=19;T>4&&!M[Xq[T-1]];--T);var I=d+5<<3,D=ry(a,og)+ry(i,V_)+s,F=ry(a,m)+ry(i,g)+s+14+3*T+ry(k,M)+2*k[16]+3*k[17]+7*k[18];if(c>=0&&I<=D&&I<=F)return Are(t,u,e.subarray(c,c+d));var z,q,$,K;if(nf(t,u,1+(F<D)),u+=2,F<D){z=Xy(m,h,0),q=m,$=Xy(g,x,0),K=g;var ce=Xy(M,C,0);nf(t,u,w-257),nf(t,u+5,S-1),nf(t,u+10,T-4),u+=14;for(var E=0;E<T;++E)nf(t,u+3*E,M[Xq[E]]);u+=3*T;for(var fe=[b,_],B=0;B<2;++B)for(var L=fe[B],E=0;E<L.length;++E){var V=L[E]&31;nf(t,u,ce[V]),u+=M[V],V>15&&(nf(t,u,L[E]>>5&127),u+=L[E]>>12)}}else z=OKe,q=og,$=TKe,K=V_;for(var E=0;E<l;++E){var re=n[E];if(re>255){var V=re>>18&31;ty(t,u,z[V+257]),u+=q[V+257],V>7&&(nf(t,u,re>>23&31),u+=_M[V]);var me=re&31;ty(t,u,$[me]),u+=K[me],me>3&&(ty(t,u,re>>5&8191),u+=SM[me])}else ty(t,u,z[re]),u+=q[re]}return ty(t,u,z[256]),u+q[256]},DKe=new NM([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ere=new nu(0),MKe=function(e,t,r,n,a,i){var s=i.z||e.length,l=new nu(n+s+5*(1+Math.ceil(s/7e3))+a),c=l.subarray(n,l.length-a),d=i.l,u=(i.r||0)&7;if(t){u&&(c[0]=i.r>>3);for(var f=DKe[t-1],m=f>>13,h=f&8191,v=(1<<r)-1,g=i.p||new uc(32768),x=i.h||new uc(v+1),y=Math.ceil(r/3),b=2*y,w=function(Z){return(e[Z]^e[Z+1]<<y^e[Z+2]<<b)&v},j=new NM(25e3),_=new uc(288),S=new uc(32),k=0,E=0,A=i.i||0,M=0,C=i.w||0,T=0;A+2<s;++A){var I=w(A),D=A&32767,F=x[I];if(g[D]=F,x[I]=D,C<=A){var z=s-A;if((k>7e3||M>24576)&&(z>423||!d)){u=Zq(e,c,0,j,_,S,E,M,T,A-T,u),M=k=E=0,T=A;for(var q=0;q<286;++q)_[q]=0;for(var q=0;q<30;++q)S[q]=0}var $=2,K=0,ce=h,fe=D-F&32767;if(z>2&&I==w(A-fe))for(var B=Math.min(m,z)-1,L=Math.min(32767,A),V=Math.min(258,z);fe<=L&&--ce&&D!=F;){if(e[A+$]==e[A+$-fe]){for(var re=0;re<V&&e[A+re]==e[A+re-fe];++re);if(re>$){if($=re,K=fe,re>B)break;for(var me=Math.min(fe,re-2),G=0,q=0;q<me;++q){var Q=A-fe+q&32767,ae=g[Q],J=Q-ae&32767;J>G&&(G=J,F=Q)}}}D=F,F=g[D],fe+=D-F&32767}if(K){j[M++]=268435456|n4[$]<<18|Jq[K];var je=n4[$]&31,be=Jq[K]&31;E+=_M[je]+SM[be],++_[257+je],++S[be],C=A+$,++k}else j[M++]=e[A],++_[e[A]]}}for(A=Math.max(A,C);A<s;++A)j[M++]=e[A],++_[e[A]];u=Zq(e,c,d,j,_,S,E,M,T,A-T,u),d||(i.r=u&7|c[u/8|0]<<3,u-=7,i.h=x,i.p=g,i.i=A,i.w=C)}else{for(var A=i.w||0;A<s+d;A+=65535){var Ue=A+65535;Ue>=s&&(c[u/8|0]=d,Ue=s),u=Are(c,u+1,e.subarray(A,Ue))}i.i=s}return IKe(l,0,n+Pre(u)+a)},kre=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var l=Math.min(s+2655,i);s<l;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},RKe=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new nu(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return MKe(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},Ore=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},LKe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=kre();a.p(t.dictionary),Ore(e,2,a.d())}};function i4(e,t){t||(t={});var r=kre();r.p(e);var n=RKe(e,t,t.dictionary?6:2,4);return LKe(n,t),Ore(n,n.length-4,r.d()),n}var $Ke=typeof TextDecoder<"u"&&new TextDecoder,FKe=0;try{$Ke.decode(Ere,{stream:!0}),FKe=1}catch{}function BKe(e){if(Array.isArray(e))return e}function qKe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function zKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ez(e,t){return BKe(e)||qKe(e,t)||Ybe(e,t)||zKe()}function tz(e,t="utf8"){return new TextDecoder(t).decode(e)}const UKe=new TextEncoder;function VKe(e){return UKe.encode(e)}const WKe=1024*8,HKe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),$A={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class CM{constructor(t=WKe,r={}){Za(this,"buffer");Za(this,"byteLength");Za(this,"byteOffset");Za(this,"length");Za(this,"offset");Za(this,"lastWrittenByte");Za(this,"littleEndian");Za(this,"_data");Za(this,"_mark");Za(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,i=t.byteLength-a;let s=a;(ArrayBuffer.isView(t)||t instanceof CM)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=$A[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+n);if(this.littleEndian===HKe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new $A[r](l.buffer);return this.offset+=n,c.reverse(),c}const s=new $A[r](i);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return tz(this.readBytes(t))}decodeText(t=1,r="utf8"){return tz(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(VKe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const GKe=4,rz=0,nz=1,KKe=2;function b0(e){let t=e.length;for(;--t>=0;)e[t]=0}const YKe=0,Tre=1,XKe=2,JKe=3,QKe=258,PM=29,hw=256,j1=hw+1+PM,Yv=30,AM=19,Ire=2*j1+1,wp=15,FA=16,ZKe=7,EM=256,Dre=16,Mre=17,Rre=18,s4=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Oj=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),eYe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Lre=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),tYe=512,ff=new Array((j1+2)*2);b0(ff);const Jy=new Array(Yv*2);b0(Jy);const N1=new Array(tYe);b0(N1);const _1=new Array(QKe-JKe+1);b0(_1);const kM=new Array(PM);b0(kM);const W_=new Array(Yv);b0(W_);function BA(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}let $re,Fre,Bre;function qA(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const qre=e=>e<256?N1[e]:N1[256+(e>>>7)],S1=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},kl=(e,t,r)=>{e.bi_valid>FA-r?(e.bi_buf|=t<<e.bi_valid&65535,S1(e,e.bi_buf),e.bi_buf=t>>FA-e.bi_valid,e.bi_valid+=r-FA):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Nu=(e,t,r)=>{kl(e,r[t*2],r[t*2+1])},zre=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},rYe=e=>{e.bi_valid===16?(S1(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},nYe=(e,t)=>{const r=t.dyn_tree,n=t.max_code,a=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let d,u,f,m,h,v,g=0;for(m=0;m<=wp;m++)e.bl_count[m]=0;for(r[e.heap[e.heap_max]*2+1]=0,d=e.heap_max+1;d<Ire;d++)u=e.heap[d],m=r[r[u*2+1]*2+1]+1,m>c&&(m=c,g++),r[u*2+1]=m,!(u>n)&&(e.bl_count[m]++,h=0,u>=l&&(h=s[u-l]),v=r[u*2],e.opt_len+=v*(m+h),i&&(e.static_len+=v*(a[u*2+1]+h)));if(g!==0){do{for(m=c-1;e.bl_count[m]===0;)m--;e.bl_count[m]--,e.bl_count[m+1]+=2,e.bl_count[c]--,g-=2}while(g>0);for(m=c;m!==0;m--)for(u=e.bl_count[m];u!==0;)f=e.heap[--d],!(f>n)&&(r[f*2+1]!==m&&(e.opt_len+=(m-r[f*2+1])*r[f*2],r[f*2+1]=m),u--)}},Ure=(e,t,r)=>{const n=new Array(wp+1);let a=0,i,s;for(i=1;i<=wp;i++)a=a+r[i-1]<<1,n[i]=a;for(s=0;s<=t;s++){let l=e[s*2+1];l!==0&&(e[s*2]=zre(n[l]++,l))}},aYe=()=>{let e,t,r,n,a;const i=new Array(wp+1);for(r=0,n=0;n<PM-1;n++)for(kM[n]=r,e=0;e<1<<s4[n];e++)_1[r++]=n;for(_1[r-1]=n,a=0,n=0;n<16;n++)for(W_[n]=a,e=0;e<1<<Oj[n];e++)N1[a++]=n;for(a>>=7;n<Yv;n++)for(W_[n]=a<<7,e=0;e<1<<Oj[n]-7;e++)N1[256+a++]=n;for(t=0;t<=wp;t++)i[t]=0;for(e=0;e<=143;)ff[e*2+1]=8,e++,i[8]++;for(;e<=255;)ff[e*2+1]=9,e++,i[9]++;for(;e<=279;)ff[e*2+1]=7,e++,i[7]++;for(;e<=287;)ff[e*2+1]=8,e++,i[8]++;for(Ure(ff,j1+1,i),e=0;e<Yv;e++)Jy[e*2+1]=5,Jy[e*2]=zre(e,5);$re=new BA(ff,s4,hw+1,j1,wp),Fre=new BA(Jy,Oj,0,Yv,wp),Bre=new BA(new Array(0),eYe,0,AM,ZKe)},Vre=e=>{let t;for(t=0;t<j1;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Yv;t++)e.dyn_dtree[t*2]=0;for(t=0;t<AM;t++)e.bl_tree[t*2]=0;e.dyn_ltree[EM*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Wre=e=>{e.bi_valid>8?S1(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},az=(e,t,r,n)=>{const a=t*2,i=r*2;return e[a]<e[i]||e[a]===e[i]&&n[t]<=n[r]},zA=(e,t,r)=>{const n=e.heap[r];let a=r<<1;for(;a<=e.heap_len&&(a<e.heap_len&&az(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!az(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n},oz=(e,t,r)=>{let n,a,i=0,s,l;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+i++]&255,n+=(e.pending_buf[e.sym_buf+i++]&255)<<8,a=e.pending_buf[e.sym_buf+i++],n===0?Nu(e,a,t):(s=_1[a],Nu(e,s+hw+1,t),l=s4[s],l!==0&&(a-=kM[s],kl(e,a,l)),n--,s=qre(n),Nu(e,s,r),l=Oj[s],l!==0&&(n-=W_[s],kl(e,n,l)));while(i<e.sym_next);Nu(e,EM,t)},l4=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,i=t.stat_desc.elems;let s,l,c=-1,d;for(e.heap_len=0,e.heap_max=Ire,s=0;s<i;s++)r[s*2]!==0?(e.heap[++e.heap_len]=c=s,e.depth[s]=0):r[s*2+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=c<2?++c:0,r[d*2]=1,e.depth[d]=0,e.opt_len--,a&&(e.static_len-=n[d*2+1]);for(t.max_code=c,s=e.heap_len>>1;s>=1;s--)zA(e,r,s);d=i;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],zA(e,r,1),l=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=l,r[d*2]=r[s*2]+r[l*2],e.depth[d]=(e.depth[s]>=e.depth[l]?e.depth[s]:e.depth[l])+1,r[s*2+1]=r[l*2+1]=d,e.heap[1]=d++,zA(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],nYe(e,t),Ure(r,c,e.bl_count)},iz=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],l=0,c=7,d=4;for(s===0&&(c=138,d=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)i=s,s=t[(n+1)*2+1],!(++l<c&&i===s)&&(l<d?e.bl_tree[i*2]+=l:i!==0?(i!==a&&e.bl_tree[i*2]++,e.bl_tree[Dre*2]++):l<=10?e.bl_tree[Mre*2]++:e.bl_tree[Rre*2]++,l=0,a=i,s===0?(c=138,d=3):i===s?(c=6,d=3):(c=7,d=4))},sz=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],l=0,c=7,d=4;for(s===0&&(c=138,d=3),n=0;n<=r;n++)if(i=s,s=t[(n+1)*2+1],!(++l<c&&i===s)){if(l<d)do Nu(e,i,e.bl_tree);while(--l!==0);else i!==0?(i!==a&&(Nu(e,i,e.bl_tree),l--),Nu(e,Dre,e.bl_tree),kl(e,l-3,2)):l<=10?(Nu(e,Mre,e.bl_tree),kl(e,l-3,3)):(Nu(e,Rre,e.bl_tree),kl(e,l-11,7));l=0,a=i,s===0?(c=138,d=3):i===s?(c=6,d=3):(c=7,d=4)}},oYe=e=>{let t;for(iz(e,e.dyn_ltree,e.l_desc.max_code),iz(e,e.dyn_dtree,e.d_desc.max_code),l4(e,e.bl_desc),t=AM-1;t>=3&&e.bl_tree[Lre[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},iYe=(e,t,r,n)=>{let a;for(kl(e,t-257,5),kl(e,r-1,5),kl(e,n-4,4),a=0;a<n;a++)kl(e,e.bl_tree[Lre[a]*2+1],3);sz(e,e.dyn_ltree,t-1),sz(e,e.dyn_dtree,r-1)},sYe=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return rz;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return nz;for(r=32;r<hw;r++)if(e.dyn_ltree[r*2]!==0)return nz;return rz};let lz=!1;const lYe=e=>{lz||(aYe(),lz=!0),e.l_desc=new qA(e.dyn_ltree,$re),e.d_desc=new qA(e.dyn_dtree,Fre),e.bl_desc=new qA(e.bl_tree,Bre),e.bi_buf=0,e.bi_valid=0,Vre(e)},Hre=(e,t,r,n)=>{kl(e,(YKe<<1)+(n?1:0),3),Wre(e),S1(e,r),S1(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},cYe=e=>{kl(e,Tre<<1,3),Nu(e,EM,ff),rYe(e)},dYe=(e,t,r,n)=>{let a,i,s=0;e.level>0?(e.strm.data_type===KKe&&(e.strm.data_type=sYe(e)),l4(e,e.l_desc),l4(e,e.d_desc),s=oYe(e),a=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=a&&(a=i)):a=i=r+5,r+4<=a&&t!==-1?Hre(e,t,r,n):e.strategy===GKe||i===a?(kl(e,(Tre<<1)+(n?1:0),3),oz(e,ff,Jy)):(kl(e,(XKe<<1)+(n?1:0),3),iYe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),oz(e,e.dyn_ltree,e.dyn_dtree)),Vre(e),n&&Wre(e)},uYe=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(_1[r]+hw+1)*2]++,e.dyn_dtree[qre(t)*2]++),e.sym_next===e.sym_end);var fYe=lYe,mYe=Hre,hYe=dYe,pYe=uYe,gYe=cYe,vYe={_tr_init:fYe,_tr_stored_block:mYe,_tr_flush_block:hYe,_tr_tally:pYe,_tr_align:gYe};const xYe=(e,t,r,n)=>{let a=e&65535|0,i=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do a=a+t[n++]|0,i=i+a|0;while(--s);a%=65521,i%=65521}return a|i<<16|0};var C1=xYe;const yYe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},bYe=new Uint32Array(yYe()),wYe=(e,t,r,n)=>{const a=bYe,i=n+r;e^=-1;for(let s=n;s<i;s++)e=e>>>8^a[(e^t[s])&255];return e^-1};var Zi=wYe,qx={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},pw={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:jYe,_tr_stored_block:c4,_tr_flush_block:NYe,_tr_tally:th,_tr_align:_Ye}=vYe,{Z_NO_FLUSH:rh,Z_PARTIAL_FLUSH:SYe,Z_FULL_FLUSH:CYe,Z_FINISH:td,Z_BLOCK:cz,Z_OK:ws,Z_STREAM_END:dz,Z_STREAM_ERROR:$u,Z_DATA_ERROR:PYe,Z_BUF_ERROR:UA,Z_DEFAULT_COMPRESSION:AYe,Z_FILTERED:EYe,Z_HUFFMAN_ONLY:F2,Z_RLE:kYe,Z_FIXED:OYe,Z_DEFAULT_STRATEGY:TYe,Z_UNKNOWN:IYe,Z_DEFLATED:l5}=pw,DYe=9,MYe=15,RYe=8,LYe=29,$Ye=256,d4=$Ye+1+LYe,FYe=30,BYe=19,qYe=2*d4+1,zYe=15,Ta=3,Mm=258,Fu=Mm+Ta+1,UYe=32,zx=42,OM=57,u4=69,f4=73,m4=91,h4=103,jp=113,yy=666,ml=1,w0=2,ig=3,j0=4,VYe=3,Np=(e,t)=>(e.msg=qx[t],t),uz=e=>e*2-(e>4?9:0),Sm=e=>{let t=e.length;for(;--t>=0;)e[t]=0},WYe=e=>{let t,r,n,a=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=a?r-a:0;while(--t);t=a,n=t;do r=e.prev[--n],e.prev[n]=r>=a?r-a:0;while(--t)};let HYe=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,nh=HYe;const tc=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},fc=(e,t)=>{NYe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,tc(e.strm)},Ha=(e,t)=>{e.pending_buf[e.pending++]=t},ny=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},p4=(e,t,r,n)=>{let a=e.avail_in;return a>n&&(a=n),a===0?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),r),e.state.wrap===1?e.adler=C1(e.adler,t,a,r):e.state.wrap===2&&(e.adler=Zi(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)},Gre=(e,t)=>{let r=e.max_chain_length,n=e.strstart,a,i,s=e.prev_length,l=e.nice_match;const c=e.strstart>e.w_size-Fu?e.strstart-(e.w_size-Fu):0,d=e.window,u=e.w_mask,f=e.prev,m=e.strstart+Mm;let h=d[n+s-1],v=d[n+s];e.prev_length>=e.good_match&&(r>>=2),l>e.lookahead&&(l=e.lookahead);do if(a=t,!(d[a+s]!==v||d[a+s-1]!==h||d[a]!==d[n]||d[++a]!==d[n+1])){n+=2,a++;do;while(d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&n<m);if(i=Mm-(m-n),n=m-Mm,i>s){if(e.match_start=t,s=i,i>=l)break;h=d[n+s-1],v=d[n+s]}}while((t=f[t&u])>c&&--r!==0);return s<=e.lookahead?s:e.lookahead},Ux=e=>{const t=e.w_size;let r,n,a;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Fu)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),WYe(e),n+=t),e.strm.avail_in===0)break;if(r=p4(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=Ta)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=nh(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=nh(e,e.ins_h,e.window[a+Ta-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<Ta)););}while(e.lookahead<Fu&&e.strm.avail_in!==0)},Kre=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,a,i,s=0,l=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,a=e.strstart-e.block_start,n>a+e.strm.avail_in&&(n=a+e.strm.avail_in),n>i&&(n=i),n<r&&(n===0&&t!==td||t===rh||n!==a+e.strm.avail_in)))break;s=t===td&&n===a+e.strm.avail_in?1:0,c4(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,tc(e.strm),a&&(a>n&&(a=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,n-=a),n&&(p4(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(s===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?j0:t!==rh&&t!==td&&e.strm.avail_in===0&&e.strstart===e.block_start?w0:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(p4(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,r=i>e.w_size?e.w_size:i,a=e.strstart-e.block_start,(a>=r||(a||t===td)&&t!==rh&&e.strm.avail_in===0&&a<=i)&&(n=a>i?i:a,s=t===td&&e.strm.avail_in===0&&n===a?1:0,c4(e,e.block_start,n,s),e.block_start+=n,tc(e.strm)),s?ig:ml)},VA=(e,t)=>{let r,n;for(;;){if(e.lookahead<Fu){if(Ux(e),e.lookahead<Fu&&t===rh)return ml;if(e.lookahead===0)break}if(r=0,e.lookahead>=Ta&&(e.ins_h=nh(e,e.ins_h,e.window[e.strstart+Ta-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Fu&&(e.match_length=Gre(e,r)),e.match_length>=Ta)if(n=th(e,e.strstart-e.match_start,e.match_length-Ta),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Ta){e.match_length--;do e.strstart++,e.ins_h=nh(e,e.ins_h,e.window[e.strstart+Ta-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=nh(e,e.ins_h,e.window[e.strstart+1]);else n=th(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(fc(e,!1),e.strm.avail_out===0))return ml}return e.insert=e.strstart<Ta-1?e.strstart:Ta-1,t===td?(fc(e,!0),e.strm.avail_out===0?ig:j0):e.sym_next&&(fc(e,!1),e.strm.avail_out===0)?ml:w0},Wg=(e,t)=>{let r,n,a;for(;;){if(e.lookahead<Fu){if(Ux(e),e.lookahead<Fu&&t===rh)return ml;if(e.lookahead===0)break}if(r=0,e.lookahead>=Ta&&(e.ins_h=nh(e,e.ins_h,e.window[e.strstart+Ta-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Ta-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Fu&&(e.match_length=Gre(e,r),e.match_length<=5&&(e.strategy===EYe||e.match_length===Ta&&e.strstart-e.match_start>4096)&&(e.match_length=Ta-1)),e.prev_length>=Ta&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-Ta,n=th(e,e.strstart-1-e.prev_match,e.prev_length-Ta),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=nh(e,e.ins_h,e.window[e.strstart+Ta-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Ta-1,e.strstart++,n&&(fc(e,!1),e.strm.avail_out===0))return ml}else if(e.match_available){if(n=th(e,0,e.window[e.strstart-1]),n&&fc(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return ml}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=th(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Ta-1?e.strstart:Ta-1,t===td?(fc(e,!0),e.strm.avail_out===0?ig:j0):e.sym_next&&(fc(e,!1),e.strm.avail_out===0)?ml:w0},GYe=(e,t)=>{let r,n,a,i;const s=e.window;for(;;){if(e.lookahead<=Mm){if(Ux(e),e.lookahead<=Mm&&t===rh)return ml;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Ta&&e.strstart>0&&(a=e.strstart-1,n=s[a],n===s[++a]&&n===s[++a]&&n===s[++a])){i=e.strstart+Mm;do;while(n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&a<i);e.match_length=Mm-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Ta?(r=th(e,1,e.match_length-Ta),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=th(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(fc(e,!1),e.strm.avail_out===0))return ml}return e.insert=0,t===td?(fc(e,!0),e.strm.avail_out===0?ig:j0):e.sym_next&&(fc(e,!1),e.strm.avail_out===0)?ml:w0},KYe=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(Ux(e),e.lookahead===0)){if(t===rh)return ml;break}if(e.match_length=0,r=th(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(fc(e,!1),e.strm.avail_out===0))return ml}return e.insert=0,t===td?(fc(e,!0),e.strm.avail_out===0?ig:j0):e.sym_next&&(fc(e,!1),e.strm.avail_out===0)?ml:w0};function hu(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}const by=[new hu(0,0,0,0,Kre),new hu(4,4,8,4,VA),new hu(4,5,16,8,VA),new hu(4,6,32,32,VA),new hu(4,4,16,16,Wg),new hu(8,16,32,32,Wg),new hu(8,16,128,128,Wg),new hu(8,32,128,256,Wg),new hu(32,128,258,1024,Wg),new hu(32,258,258,4096,Wg)],YYe=e=>{e.window_size=2*e.w_size,Sm(e.head),e.max_lazy_match=by[e.level].max_lazy,e.good_match=by[e.level].good_length,e.nice_match=by[e.level].nice_length,e.max_chain_length=by[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Ta-1,e.match_available=0,e.ins_h=0};function XYe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=l5,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(qYe*2),this.dyn_dtree=new Uint16Array((2*FYe+1)*2),this.bl_tree=new Uint16Array((2*BYe+1)*2),Sm(this.dyn_ltree),Sm(this.dyn_dtree),Sm(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(zYe+1),this.heap=new Uint16Array(2*d4+1),Sm(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*d4+1),Sm(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const gw=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==zx&&t.status!==OM&&t.status!==u4&&t.status!==f4&&t.status!==m4&&t.status!==h4&&t.status!==jp&&t.status!==yy?1:0},Yre=e=>{if(gw(e))return Np(e,$u);e.total_in=e.total_out=0,e.data_type=IYe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?OM:t.wrap?zx:jp,e.adler=t.wrap===2?0:1,t.last_flush=-2,jYe(t),ws},Xre=e=>{const t=Yre(e);return t===ws&&YYe(e.state),t},JYe=(e,t)=>gw(e)||e.state.wrap!==2?$u:(e.state.gzhead=t,ws),Jre=(e,t,r,n,a,i)=>{if(!e)return $u;let s=1;if(t===AYe&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),a<1||a>DYe||r!==l5||n<8||n>15||t<0||t>9||i<0||i>OYe||n===8&&s!==1)return Np(e,$u);n===8&&(n=9);const l=new XYe;return e.state=l,l.strm=e,l.status=zx,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+Ta-1)/Ta),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=t,l.strategy=i,l.method=r,Xre(e)},QYe=(e,t)=>Jre(e,t,l5,MYe,RYe,TYe),ZYe=(e,t)=>{if(gw(e)||t>cz||t<0)return e?Np(e,$u):$u;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===yy&&t!==td)return Np(e,e.avail_out===0?UA:$u);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(tc(e),e.avail_out===0)return r.last_flush=-1,ws}else if(e.avail_in===0&&uz(t)<=uz(n)&&t!==td)return Np(e,UA);if(r.status===yy&&e.avail_in!==0)return Np(e,UA);if(r.status===zx&&r.wrap===0&&(r.status=jp),r.status===zx){let a=l5+(r.w_bits-8<<4)<<8,i=-1;if(r.strategy>=F2||r.level<2?i=0:r.level<6?i=1:r.level===6?i=2:i=3,a|=i<<6,r.strstart!==0&&(a|=UYe),a+=31-a%31,ny(r,a),r.strstart!==0&&(ny(r,e.adler>>>16),ny(r,e.adler&65535)),e.adler=1,r.status=jp,tc(e),r.pending!==0)return r.last_flush=-1,ws}if(r.status===OM){if(e.adler=0,Ha(r,31),Ha(r,139),Ha(r,8),r.gzhead)Ha(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ha(r,r.gzhead.time&255),Ha(r,r.gzhead.time>>8&255),Ha(r,r.gzhead.time>>16&255),Ha(r,r.gzhead.time>>24&255),Ha(r,r.level===9?2:r.strategy>=F2||r.level<2?4:0),Ha(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(Ha(r,r.gzhead.extra.length&255),Ha(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Zi(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=u4;else if(Ha(r,0),Ha(r,0),Ha(r,0),Ha(r,0),Ha(r,0),Ha(r,r.level===9?2:r.strategy>=F2||r.level<2?4:0),Ha(r,VYe),r.status=jp,tc(e),r.pending!==0)return r.last_flush=-1,ws}if(r.status===u4){if(r.gzhead.extra){let a=r.pending,i=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+i>r.pending_buf_size;){let l=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+l),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>a&&(e.adler=Zi(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex+=l,tc(e),r.pending!==0)return r.last_flush=-1,ws;a=0,i-=l}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>a&&(e.adler=Zi(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=f4}if(r.status===f4){if(r.gzhead.name){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=Zi(e.adler,r.pending_buf,r.pending-a,a)),tc(e),r.pending!==0)return r.last_flush=-1,ws;a=0}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,Ha(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=Zi(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=m4}if(r.status===m4){if(r.gzhead.comment){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=Zi(e.adler,r.pending_buf,r.pending-a,a)),tc(e),r.pending!==0)return r.last_flush=-1,ws;a=0}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,Ha(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=Zi(e.adler,r.pending_buf,r.pending-a,a))}r.status=h4}if(r.status===h4){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(tc(e),r.pending!==0))return r.last_flush=-1,ws;Ha(r,e.adler&255),Ha(r,e.adler>>8&255),e.adler=0}if(r.status=jp,tc(e),r.pending!==0)return r.last_flush=-1,ws}if(e.avail_in!==0||r.lookahead!==0||t!==rh&&r.status!==yy){let a=r.level===0?Kre(r,t):r.strategy===F2?KYe(r,t):r.strategy===kYe?GYe(r,t):by[r.level].func(r,t);if((a===ig||a===j0)&&(r.status=yy),a===ml||a===ig)return e.avail_out===0&&(r.last_flush=-1),ws;if(a===w0&&(t===SYe?_Ye(r):t!==cz&&(c4(r,0,0,!1),t===CYe&&(Sm(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),tc(e),e.avail_out===0))return r.last_flush=-1,ws}return t!==td?ws:r.wrap<=0?dz:(r.wrap===2?(Ha(r,e.adler&255),Ha(r,e.adler>>8&255),Ha(r,e.adler>>16&255),Ha(r,e.adler>>24&255),Ha(r,e.total_in&255),Ha(r,e.total_in>>8&255),Ha(r,e.total_in>>16&255),Ha(r,e.total_in>>24&255)):(ny(r,e.adler>>>16),ny(r,e.adler&65535)),tc(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?ws:dz)},eXe=e=>{if(gw(e))return $u;const t=e.state.status;return e.state=null,t===jp?Np(e,PYe):ws},tXe=(e,t)=>{let r=t.length;if(gw(e))return $u;const n=e.state,a=n.wrap;if(a===2||a===1&&n.status!==zx||n.lookahead)return $u;if(a===1&&(e.adler=C1(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){a===0&&(Sm(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(t.subarray(r-n.w_size,r),0),t=c,r=n.w_size}const i=e.avail_in,s=e.next_in,l=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Ux(n);n.lookahead>=Ta;){let c=n.strstart,d=n.lookahead-(Ta-1);do n.ins_h=nh(n,n.ins_h,n.window[c+Ta-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--d);n.strstart=c,n.lookahead=Ta-1,Ux(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Ta-1,n.match_available=0,e.next_in=s,e.input=l,e.avail_in=i,n.wrap=a,ws};var rXe=QYe,nXe=Jre,aXe=Xre,oXe=Yre,iXe=JYe,sXe=ZYe,lXe=eXe,cXe=tXe,dXe="pako deflate (from Nodeca project)",Qy={deflateInit:rXe,deflateInit2:nXe,deflateReset:aXe,deflateResetKeep:oXe,deflateSetHeader:iXe,deflate:sXe,deflateEnd:lXe,deflateSetDictionary:cXe,deflateInfo:dXe};const uXe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var fXe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)uXe(r,n)&&(e[n]=r[n])}}return e},mXe=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,i=e.length;n<i;n++){let s=e[n];r.set(s,a),a+=s.length}return r},c5={assign:fXe,flattenChunks:mXe};let Qre=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Qre=!1}const P1=new Uint8Array(256);for(let e=0;e<256;e++)P1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;P1[254]=P1[254]=1;var hXe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,a,i,s=e.length,l=0;for(a=0;a<s;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),i=0,a=0;i<l;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const pXe=(e,t)=>{if(t<65534&&e.subarray&&Qre)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var gXe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,a;const i=new Array(r*2);for(a=0,n=0;n<r;){let s=e[n++];if(s<128){i[a++]=s;continue}let l=P1[s];if(l>4){i[a++]=65533,n+=l-1;continue}for(s&=l===2?31:l===3?15:7;l>1&&n<r;)s=s<<6|e[n++]&63,l--;if(l>1){i[a++]=65533;continue}s<65536?i[a++]=s:(s-=65536,i[a++]=55296|s>>10&1023,i[a++]=56320|s&1023)}return pXe(i,a)},vXe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+P1[e[r]]>t?r:t},A1={string2buf:hXe,buf2string:gXe,utf8border:vXe};function xXe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Zre=xXe;const ene=Object.prototype.toString,{Z_NO_FLUSH:yXe,Z_SYNC_FLUSH:bXe,Z_FULL_FLUSH:wXe,Z_FINISH:jXe,Z_OK:H_,Z_STREAM_END:NXe,Z_DEFAULT_COMPRESSION:_Xe,Z_DEFAULT_STRATEGY:SXe,Z_DEFLATED:CXe}=pw;function TM(e){this.options=c5.assign({level:_Xe,method:CXe,chunkSize:16384,windowBits:15,memLevel:8,strategy:SXe},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zre,this.strm.avail_out=0;let r=Qy.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==H_)throw new Error(qx[r]);if(t.header&&Qy.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=A1.string2buf(t.dictionary):ene.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=Qy.deflateSetDictionary(this.strm,n),r!==H_)throw new Error(qx[r]);this._dict_set=!0}}TM.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let a,i;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?jXe:yXe,typeof e=="string"?r.input=A1.string2buf(e):ene.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===bXe||i===wXe)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(a=Qy.deflate(r,i),a===NXe)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=Qy.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===H_;if(r.avail_out===0){this.onData(r.output);continue}if(i>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};TM.prototype.onData=function(e){this.chunks.push(e)};TM.prototype.onEnd=function(e){e===H_&&(this.result=c5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const B2=16209,PXe=16191;var AXe=function(t,r){let n,a,i,s,l,c,d,u,f,m,h,v,g,x,y,b,w,j,_,S,k,E,A,M;const C=t.state;n=t.next_in,A=t.input,a=n+(t.avail_in-5),i=t.next_out,M=t.output,s=i-(r-t.avail_out),l=i+(t.avail_out-257),c=C.dmax,d=C.wsize,u=C.whave,f=C.wnext,m=C.window,h=C.hold,v=C.bits,g=C.lencode,x=C.distcode,y=(1<<C.lenbits)-1,b=(1<<C.distbits)-1;e:do{v<15&&(h+=A[n++]<<v,v+=8,h+=A[n++]<<v,v+=8),w=g[h&y];t:for(;;){if(j=w>>>24,h>>>=j,v-=j,j=w>>>16&255,j===0)M[i++]=w&65535;else if(j&16){_=w&65535,j&=15,j&&(v<j&&(h+=A[n++]<<v,v+=8),_+=h&(1<<j)-1,h>>>=j,v-=j),v<15&&(h+=A[n++]<<v,v+=8,h+=A[n++]<<v,v+=8),w=x[h&b];r:for(;;){if(j=w>>>24,h>>>=j,v-=j,j=w>>>16&255,j&16){if(S=w&65535,j&=15,v<j&&(h+=A[n++]<<v,v+=8,v<j&&(h+=A[n++]<<v,v+=8)),S+=h&(1<<j)-1,S>c){t.msg="invalid distance too far back",C.mode=B2;break e}if(h>>>=j,v-=j,j=i-s,S>j){if(j=S-j,j>u&&C.sane){t.msg="invalid distance too far back",C.mode=B2;break e}if(k=0,E=m,f===0){if(k+=d-j,j<_){_-=j;do M[i++]=m[k++];while(--j);k=i-S,E=M}}else if(f<j){if(k+=d+f-j,j-=f,j<_){_-=j;do M[i++]=m[k++];while(--j);if(k=0,f<_){j=f,_-=j;do M[i++]=m[k++];while(--j);k=i-S,E=M}}}else if(k+=f-j,j<_){_-=j;do M[i++]=m[k++];while(--j);k=i-S,E=M}for(;_>2;)M[i++]=E[k++],M[i++]=E[k++],M[i++]=E[k++],_-=3;_&&(M[i++]=E[k++],_>1&&(M[i++]=E[k++]))}else{k=i-S;do M[i++]=M[k++],M[i++]=M[k++],M[i++]=M[k++],_-=3;while(_>2);_&&(M[i++]=M[k++],_>1&&(M[i++]=M[k++]))}}else if(j&64){t.msg="invalid distance code",C.mode=B2;break e}else{w=x[(w&65535)+(h&(1<<j)-1)];continue r}break}}else if(j&64)if(j&32){C.mode=PXe;break e}else{t.msg="invalid literal/length code",C.mode=B2;break e}else{w=g[(w&65535)+(h&(1<<j)-1)];continue t}break}}while(n<a&&i<l);_=v>>3,n-=_,v-=_<<3,h&=(1<<v)-1,t.next_in=n,t.next_out=i,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=i<l?257+(l-i):257-(i-l),C.hold=h,C.bits=v};const Hg=15,fz=852,mz=592,hz=0,WA=1,pz=2,EXe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),kXe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),OXe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),TXe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),IXe=(e,t,r,n,a,i,s,l)=>{const c=l.bits;let d=0,u=0,f=0,m=0,h=0,v=0,g=0,x=0,y=0,b=0,w,j,_,S,k,E=null,A;const M=new Uint16Array(Hg+1),C=new Uint16Array(Hg+1);let T=null,I,D,F;for(d=0;d<=Hg;d++)M[d]=0;for(u=0;u<n;u++)M[t[r+u]]++;for(h=c,m=Hg;m>=1&&M[m]===0;m--);if(h>m&&(h=m),m===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<m&&M[f]===0;f++);for(h<f&&(h=f),x=1,d=1;d<=Hg;d++)if(x<<=1,x-=M[d],x<0)return-1;if(x>0&&(e===hz||m!==1))return-1;for(C[1]=0,d=1;d<Hg;d++)C[d+1]=C[d]+M[d];for(u=0;u<n;u++)t[r+u]!==0&&(s[C[t[r+u]]++]=u);if(e===hz?(E=T=s,A=20):e===WA?(E=EXe,T=kXe,A=257):(E=OXe,T=TXe,A=0),b=0,u=0,d=f,k=i,v=h,g=0,_=-1,y=1<<h,S=y-1,e===WA&&y>fz||e===pz&&y>mz)return 1;for(;;){I=d-g,s[u]+1<A?(D=0,F=s[u]):s[u]>=A?(D=T[s[u]-A],F=E[s[u]-A]):(D=32+64,F=0),w=1<<d-g,j=1<<v,f=j;do j-=w,a[k+(b>>g)+j]=I<<24|D<<16|F|0;while(j!==0);for(w=1<<d-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,u++,--M[d]===0){if(d===m)break;d=t[r+s[u]]}if(d>h&&(b&S)!==_){for(g===0&&(g=h),k+=f,v=d-g,x=1<<v;v+g<m&&(x-=M[v+g],!(x<=0));)v++,x<<=1;if(y+=1<<v,e===WA&&y>fz||e===pz&&y>mz)return 1;_=b&S,a[_]=h<<24|v<<16|k-i|0}}return b!==0&&(a[k+b]=d-g<<24|64<<16|0),l.bits=h,0};var Zy=IXe;const DXe=0,tne=1,rne=2,{Z_FINISH:gz,Z_BLOCK:MXe,Z_TREES:q2,Z_OK:sg,Z_STREAM_END:RXe,Z_NEED_DICT:LXe,Z_STREAM_ERROR:yd,Z_DATA_ERROR:nne,Z_MEM_ERROR:ane,Z_BUF_ERROR:$Xe,Z_DEFLATED:vz}=pw,d5=16180,xz=16181,yz=16182,bz=16183,wz=16184,jz=16185,Nz=16186,_z=16187,Sz=16188,Cz=16189,G_=16190,af=16191,HA=16192,Pz=16193,GA=16194,Az=16195,Ez=16196,kz=16197,Oz=16198,z2=16199,U2=16200,Tz=16201,Iz=16202,Dz=16203,Mz=16204,Rz=16205,KA=16206,Lz=16207,$z=16208,Lo=16209,one=16210,ine=16211,FXe=852,BXe=592,qXe=15,zXe=qXe,Fz=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function UXe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ng=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<d5||t.mode>ine?1:0},sne=e=>{if(Ng(e))return yd;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=d5,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(FXe),t.distcode=t.distdyn=new Int32Array(BXe),t.sane=1,t.back=-1,sg},lne=e=>{if(Ng(e))return yd;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,sne(e)},cne=(e,t)=>{let r;if(Ng(e))return yd;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?yd:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,lne(e))},dne=(e,t)=>{if(!e)return yd;const r=new UXe;e.state=r,r.strm=e,r.window=null,r.mode=d5;const n=cne(e,t);return n!==sg&&(e.state=null),n},VXe=e=>dne(e,zXe);let Bz=!0,YA,XA;const WXe=e=>{if(Bz){YA=new Int32Array(512),XA=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Zy(tne,e.lens,0,288,YA,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Zy(rne,e.lens,0,32,XA,0,e.work,{bits:5}),Bz=!1}e.lencode=YA,e.lenbits=9,e.distcode=XA,e.distbits=5},une=(e,t,r,n)=>{let a;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),n-=a,n?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},HXe=(e,t)=>{let r,n,a,i,s,l,c,d,u,f,m,h,v,g,x=0,y,b,w,j,_,S,k,E;const A=new Uint8Array(4);let M,C;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ng(e)||!e.output||!e.input&&e.avail_in!==0)return yd;r=e.state,r.mode===af&&(r.mode=HA),s=e.next_out,a=e.output,c=e.avail_out,i=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,f=l,m=c,E=sg;e:for(;;)switch(r.mode){case d5:if(r.wrap===0){r.mode=HA;break}for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,A[0]=d&255,A[1]=d>>>8&255,r.check=Zi(r.check,A,2,0),d=0,u=0,r.mode=xz;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=Lo;break}if((d&15)!==vz){e.msg="unknown compression method",r.mode=Lo;break}if(d>>>=4,u-=4,k=(d&15)+8,r.wbits===0&&(r.wbits=k),k>15||k>r.wbits){e.msg="invalid window size",r.mode=Lo;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?Cz:af,d=0,u=0;break;case xz:for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.flags=d,(r.flags&255)!==vz){e.msg="unknown compression method",r.mode=Lo;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Lo;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,r.check=Zi(r.check,A,2,0)),d=0,u=0,r.mode=yz;case yz:for(;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,A[2]=d>>>16&255,A[3]=d>>>24&255,r.check=Zi(r.check,A,4,0)),d=0,u=0,r.mode=bz;case bz:for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,r.check=Zi(r.check,A,2,0)),d=0,u=0,r.mode=wz;case wz:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,r.check=Zi(r.check,A,2,0)),d=0,u=0}else r.head&&(r.head.extra=null);r.mode=jz;case jz:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+h),k)),r.flags&512&&r.wrap&4&&(r.check=Zi(r.check,n,h,i)),l-=h,i+=h,r.length-=h),r.length))break e;r.length=0,r.mode=Nz;case Nz:if(r.flags&2048){if(l===0)break e;h=0;do k=n[i+h++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k));while(k&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Zi(r.check,n,h,i)),l-=h,i+=h,k)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=_z;case _z:if(r.flags&4096){if(l===0)break e;h=0;do k=n[i+h++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k));while(k&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Zi(r.check,n,h,i)),l-=h,i+=h,k)break e}else r.head&&(r.head.comment=null);r.mode=Sz;case Sz:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Lo;break}d=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=af;break;case Cz:for(;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}e.adler=r.check=Fz(d),d=0,u=0,r.mode=G_;case G_:if(r.havedict===0)return e.next_out=s,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=d,r.bits=u,LXe;e.adler=r.check=1,r.mode=af;case af:if(t===MXe||t===q2)break e;case HA:if(r.last){d>>>=u&7,u-=u&7,r.mode=KA;break}for(;u<3;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}switch(r.last=d&1,d>>>=1,u-=1,d&3){case 0:r.mode=Pz;break;case 1:if(WXe(r),r.mode=z2,t===q2){d>>>=2,u-=2;break e}break;case 2:r.mode=Ez;break;case 3:e.msg="invalid block type",r.mode=Lo}d>>>=2,u-=2;break;case Pz:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Lo;break}if(r.length=d&65535,d=0,u=0,r.mode=GA,t===q2)break e;case GA:r.mode=Az;case Az:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(i,i+h),s),l-=h,i+=h,c-=h,s+=h,r.length-=h;break}r.mode=af;break;case Ez:for(;u<14;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.nlen=(d&31)+257,d>>>=5,u-=5,r.ndist=(d&31)+1,d>>>=5,u-=5,r.ncode=(d&15)+4,d>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Lo;break}r.have=0,r.mode=kz;case kz:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.lens[T[r.have++]]=d&7,d>>>=3,u-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,M={bits:r.lenbits},E=Zy(DXe,r.lens,0,19,r.lencode,0,r.work,M),r.lenbits=M.bits,E){e.msg="invalid code lengths set",r.mode=Lo;break}r.have=0,r.mode=Oz;case Oz:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[d&(1<<r.lenbits)-1],y=x>>>24,b=x>>>16&255,w=x&65535,!(y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(w<16)d>>>=y,u-=y,r.lens[r.have++]=w;else{if(w===16){for(C=y+2;u<C;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(d>>>=y,u-=y,r.have===0){e.msg="invalid bit length repeat",r.mode=Lo;break}k=r.lens[r.have-1],h=3+(d&3),d>>>=2,u-=2}else if(w===17){for(C=y+3;u<C;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=y,u-=y,k=0,h=3+(d&7),d>>>=3,u-=3}else{for(C=y+7;u<C;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=y,u-=y,k=0,h=11+(d&127),d>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Lo;break}for(;h--;)r.lens[r.have++]=k}}if(r.mode===Lo)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Lo;break}if(r.lenbits=9,M={bits:r.lenbits},E=Zy(tne,r.lens,0,r.nlen,r.lencode,0,r.work,M),r.lenbits=M.bits,E){e.msg="invalid literal/lengths set",r.mode=Lo;break}if(r.distbits=6,r.distcode=r.distdyn,M={bits:r.distbits},E=Zy(rne,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,M),r.distbits=M.bits,E){e.msg="invalid distances set",r.mode=Lo;break}if(r.mode=z2,t===q2)break e;case z2:r.mode=U2;case U2:if(l>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=d,r.bits=u,AXe(e,m),s=e.next_out,a=e.output,c=e.avail_out,i=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,r.mode===af&&(r.back=-1);break}for(r.back=0;x=r.lencode[d&(1<<r.lenbits)-1],y=x>>>24,b=x>>>16&255,w=x&65535,!(y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(b&&!(b&240)){for(j=y,_=b,S=w;x=r.lencode[S+((d&(1<<j+_)-1)>>j)],y=x>>>24,b=x>>>16&255,w=x&65535,!(j+y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=y,u-=y,r.back+=y,r.length=w,b===0){r.mode=Rz;break}if(b&32){r.back=-1,r.mode=af;break}if(b&64){e.msg="invalid literal/length code",r.mode=Lo;break}r.extra=b&15,r.mode=Tz;case Tz:if(r.extra){for(C=r.extra;u<C;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Iz;case Iz:for(;x=r.distcode[d&(1<<r.distbits)-1],y=x>>>24,b=x>>>16&255,w=x&65535,!(y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(!(b&240)){for(j=y,_=b,S=w;x=r.distcode[S+((d&(1<<j+_)-1)>>j)],y=x>>>24,b=x>>>16&255,w=x&65535,!(j+y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=y,u-=y,r.back+=y,b&64){e.msg="invalid distance code",r.mode=Lo;break}r.offset=w,r.extra=b&15,r.mode=Dz;case Dz:if(r.extra){for(C=r.extra;u<C;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Lo;break}r.mode=Mz;case Mz:if(c===0)break e;if(h=m-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Lo;break}h>r.wnext?(h-=r.wnext,v=r.wsize-h):v=r.wnext-h,h>r.length&&(h=r.length),g=r.window}else g=a,v=s-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[s++]=g[v++];while(--h);r.length===0&&(r.mode=U2);break;case Rz:if(c===0)break e;a[s++]=r.length,c--,r.mode=U2;break;case KA:if(r.wrap){for(;u<32;){if(l===0)break e;l--,d|=n[i++]<<u,u+=8}if(m-=c,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?Zi(r.check,a,m,s-m):C1(r.check,a,m,s-m)),m=c,r.wrap&4&&(r.flags?d:Fz(d))!==r.check){e.msg="incorrect data check",r.mode=Lo;break}d=0,u=0}r.mode=Lz;case Lz:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Lo;break}d=0,u=0}r.mode=$z;case $z:E=RXe;break e;case Lo:E=nne;break e;case one:return ane;case ine:default:return yd}return e.next_out=s,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=d,r.bits=u,(r.wsize||m!==e.avail_out&&r.mode<Lo&&(r.mode<KA||t!==gz))&&une(e,e.output,e.next_out,m-e.avail_out),f-=e.avail_in,m-=e.avail_out,e.total_in+=f,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?Zi(r.check,a,m,e.next_out-m):C1(r.check,a,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(r.mode===af?128:0)+(r.mode===z2||r.mode===GA?256:0),(f===0&&m===0||t===gz)&&E===sg&&(E=$Xe),E},GXe=e=>{if(Ng(e))return yd;let t=e.state;return t.window&&(t.window=null),e.state=null,sg},KXe=(e,t)=>{if(Ng(e))return yd;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,sg):yd},YXe=(e,t)=>{const r=t.length;let n,a,i;return Ng(e)||(n=e.state,n.wrap!==0&&n.mode!==G_)?yd:n.mode===G_&&(a=1,a=C1(a,t,r,0),a!==n.check)?nne:(i=une(e,t,r,r),i?(n.mode=one,ane):(n.havedict=1,sg))};var XXe=lne,JXe=cne,QXe=sne,ZXe=VXe,eJe=dne,tJe=HXe,rJe=GXe,nJe=KXe,aJe=YXe,oJe="pako inflate (from Nodeca project)",mf={inflateReset:XXe,inflateReset2:JXe,inflateResetKeep:QXe,inflateInit:ZXe,inflateInit2:eJe,inflate:tJe,inflateEnd:rJe,inflateGetHeader:nJe,inflateSetDictionary:aJe,inflateInfo:oJe};function iJe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var sJe=iJe;const fne=Object.prototype.toString,{Z_NO_FLUSH:lJe,Z_FINISH:cJe,Z_OK:E1,Z_STREAM_END:JA,Z_NEED_DICT:QA,Z_STREAM_ERROR:dJe,Z_DATA_ERROR:qz,Z_MEM_ERROR:uJe}=pw;function vw(e){this.options=c5.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zre,this.strm.avail_out=0;let r=mf.inflateInit2(this.strm,t.windowBits);if(r!==E1)throw new Error(qx[r]);if(this.header=new sJe,mf.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=A1.string2buf(t.dictionary):fne.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=mf.inflateSetDictionary(this.strm,t.dictionary),r!==E1)))throw new Error(qx[r])}vw.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let i,s,l;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?cJe:lJe,fne.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=mf.inflate(r,s),i===QA&&a&&(i=mf.inflateSetDictionary(r,a),i===E1?i=mf.inflate(r,s):i===qz&&(i=QA));r.avail_in>0&&i===JA&&r.state.wrap>0&&e[r.next_in]!==0;)mf.inflateReset(r),i=mf.inflate(r,s);switch(i){case dJe:case qz:case QA:case uJe:return this.onEnd(i),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||i===JA))if(this.options.to==="string"){let c=A1.utf8border(r.output,r.next_out),d=r.next_out-c,u=A1.buf2string(r.output,c);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===E1&&l===0)){if(i===JA)return i=mf.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};vw.prototype.onData=function(e){this.chunks.push(e)};vw.prototype.onEnd=function(e){e===E1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function IM(e,t){const r=new vw(t);if(r.push(e),r.err)throw r.msg||qx[r.err];return r.result}function fJe(e,t){return t=t||{},t.raw=!0,IM(e,t)}var mJe=vw,hJe=IM,pJe=fJe,gJe=IM,vJe=pw,xJe={Inflate:mJe,inflate:hJe,inflateRaw:pJe,ungzip:gJe,constants:vJe};const{Inflate:yJe,inflate:bJe,inflateRaw:Nlt,ungzip:_lt}=xJe;var zz=yJe,wJe=bJe;const mne=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;mne[e]=t}const Uz=4294967295;function jJe(e,t,r){let n=e;for(let a=0;a<r;a++)n=mne[(n^t[a])&255]^n>>>8;return n}function NJe(e,t){return(jJe(Uz,e,t)^Uz)>>>0}function Vz(e,t,r){const n=e.readUint32(),a=NJe(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function hne(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function pne(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function gne(e,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function vne(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+(t[i-a]>>1)&255}else{for(;i<a;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<n;i++)t[i]=e[i]+(t[i-a]+r[i]>>1)&255}}function xne(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+t[i-a]&255}else{for(;i<a;i++)t[i]=e[i]+r[i]&255;for(;i<n;i++)t[i]=e[i]+_Je(t[i-a],r[i],r[i-a])&255}}function _Je(e,t,r){const n=e+t-r,a=Math.abs(n-e),i=Math.abs(n-t),s=Math.abs(n-r);return a<=i&&a<=s?e:i<=s?t:r}function SJe(e,t,r,n,a,i){switch(e){case 0:hne(t,r,a);break;case 1:pne(t,r,a,i);break;case 2:gne(t,r,n,a);break;case 3:vne(t,r,n,a,i);break;case 4:xne(t,r,n,a,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const CJe=new Uint16Array([255]),PJe=new Uint8Array(CJe.buffer),AJe=PJe[0]===255;function EJe(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*a,c=new Uint8Array(n*r*l);let d=0;for(let u=0;u<7;u++){const f=s[u],m=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(m<=0||h<=0)continue;const v=m*l,g=new Uint8Array(v);for(let x=0;x<h;x++){const y=t[d++],b=t.subarray(d,d+v);d+=v;const w=new Uint8Array(v);SJe(y,b,w,g,v,l),g.set(w);for(let j=0;j<m;j++){const _=f.x+j*f.xStep,S=f.y+x*f.yStep;if(!(_>=r||S>=n))for(let k=0;k<l;k++)c[(S*r+_)*l+k]=w[j*l+k]}}}if(i===16){const u=new Uint16Array(c.buffer);if(AJe)for(let f=0;f<u.length;f++)u[f]=kJe(u[f]);return u}else return c}function kJe(e){return(e&255)<<8|e>>8&255}const OJe=new Uint16Array([255]),TJe=new Uint8Array(OJe.buffer),IJe=TJe[0]===255,DJe=new Uint8Array(0);function Wz(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=Math.ceil(i/8)*a,l=Math.ceil(i/8*a*r),c=new Uint8Array(n*l);let d=DJe,u=0,f,m;for(let h=0;h<n;h++){switch(f=t.subarray(u+1,u+1+l),m=c.subarray(h*l,(h+1)*l),t[u]){case 0:hne(f,m,l);break;case 1:pne(f,m,l,s);break;case 2:gne(f,m,d,l);break;case 3:vne(f,m,d,l,s);break;case 4:xne(f,m,d,l,s);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}d=m,u+=l+1}if(i===16){const h=new Uint16Array(c.buffer);if(IJe)for(let v=0;v<h.length;v++)h[v]=MJe(h[v]);return h}else return c}function MJe(e){return(e&255)<<8|e>>8&255}const Tj=Uint8Array.of(137,80,78,71,13,10,26,10);function Hz(e){if(!RJe(e.readBytes(Tj.length)))throw new Error("wrong PNG signature")}function RJe(e){if(e.length<Tj.length)return!1;for(let t=0;t<Tj.length;t++)if(e[t]!==Tj[t])return!1;return!0}const LJe="tEXt",$Je=0,yne=new TextDecoder("latin1");function FJe(e){if(qJe(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const BJe=/^[\u0000-\u00FF]*$/;function qJe(e){if(!BJe.test(e))throw new Error("invalid latin1 text")}function zJe(e,t,r){const n=bne(t);e[n]=UJe(t,r-n.length-1)}function bne(e){for(e.mark();e.readByte()!==$Je;);const t=e.offset;e.reset();const r=yne.decode(e.readBytes(t-e.offset-1));return e.skip(1),FJe(r),r}function UJe(e,t){return yne.decode(e.readBytes(t))}const Jl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},ZA={UNKNOWN:-1,DEFLATE:0},Gz={UNKNOWN:-1,ADAPTIVE:0},eE={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},V2={NONE:0,BACKGROUND:1,PREVIOUS:2},tE={SOURCE:0,OVER:1};class VJe extends CM{constructor(r,n={}){super(r);Za(this,"_checkCrc");Za(this,"_inflator");Za(this,"_png");Za(this,"_apng");Za(this,"_end");Za(this,"_hasPalette");Za(this,"_palette");Za(this,"_hasTransparency");Za(this,"_transparency");Za(this,"_compressionMethod");Za(this,"_filterMethod");Za(this,"_interlaceMethod");Za(this,"_colorType");Za(this,"_isAnimated");Za(this,"_numberOfFrames");Za(this,"_numberOfPlays");Za(this,"_frames");Za(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new zz,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=ZA.UNKNOWN,this._filterMethod=Gz.UNKNOWN,this._interlaceMethod=eE.UNKNOWN,this._colorType=Jl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Hz(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(Hz(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case LJe:zJe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?Vz(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?Vz(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=WJe(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Jl.GREYSCALE:a=1;break;case Jl.TRUECOLOUR:a=3;break;case Jl.INDEXED_COLOUR:a=1;break;case Jl.GREYSCALE_ALPHA:a=2;break;case Jl.TRUECOLOUR_ALPHA:a=4;break;case Jl.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==ZA.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let i=0;i<n;i++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Jl.GREYSCALE:case Jl.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Jl.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Jl.UNKNOWN:case Jl.GREYSCALE_ALPHA:case Jl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=bne(this),a=this.readUint8();if(a!==ZA.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:wJe(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=Wz({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(a,i,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case V2.NONE:break;case V2.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let s=0;s<this._png.width;s++){const l=(i*r.width+s)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case V2.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,i=(s,l)=>{const c=((s+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,d=(s*n.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(n.blendOp){case tE.SOURCE:for(let s=0;s<n.height;s++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=i(s,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[d+u]}break;case tE.OVER:for(let s=0;s<n.height;s++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=i(s,l);for(let u=0;u<this._png.channels;u++){const f=n.data[d+this._png.channels-1]/a,m=u%(this._png.channels-1)===0?1:n.data[d+u],h=Math.floor(f*m+(1-f)*r.data[c+u]);r.data[c+u]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Gz.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===eE.NO_INTERLACE)this._png.data=Wz({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===eE.ADAM7)this._png.data=EJe({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:V2.NONE,blendOp:tE.SOURCE,data:r}),this._inflator=new zz,this._writingDataChunks=!1}}function WJe(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var Kz;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(Kz||(Kz={}));function HJe(e,t){return new VJe(e,t).decode()}var Yn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function rE(){Yn.console&&typeof Yn.console.log=="function"&&Yn.console.log.apply(Yn.console,arguments)}var mo={log:rE,warn:function(e){Yn.console&&(typeof Yn.console.warn=="function"?Yn.console.warn.apply(Yn.console,arguments):rE.call(null,arguments))},error:function(e){Yn.console&&(typeof Yn.console.error=="function"?Yn.console.error.apply(Yn.console,arguments):rE(e))}};function nE(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){rp(n.response,t,r)},n.onerror=function(){mo.error("could not download file")},n.send()}function Yz(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function W2(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var rp=Yn.saveAs||((typeof window>"u"?"undefined":Aa(window))!=="object"||window!==Yn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Yn.URL||Yn.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?Yz(a.href)?nE(e,t,r):W2(a,a.target="_blank"):W2(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){W2(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Yz(e))nE(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){W2(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:Aa(i)!=="object"&&(mo.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return nE(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(Yn.HTMLElement)||Yn.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":Aa(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(e)}else{var c=Yn.URL||Yn.webkitURL,d=c.createObjectURL(e);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function wne(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var Ij=Yn.atob.bind(Yn),Xz=Yn.btoa.bind(Yn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function aE(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=Ts(r,n,a,i,t[0],7,-680876936),i=Ts(i,r,n,a,t[1],12,-389564586),a=Ts(a,i,r,n,t[2],17,606105819),n=Ts(n,a,i,r,t[3],22,-1044525330),r=Ts(r,n,a,i,t[4],7,-176418897),i=Ts(i,r,n,a,t[5],12,1200080426),a=Ts(a,i,r,n,t[6],17,-1473231341),n=Ts(n,a,i,r,t[7],22,-45705983),r=Ts(r,n,a,i,t[8],7,1770035416),i=Ts(i,r,n,a,t[9],12,-1958414417),a=Ts(a,i,r,n,t[10],17,-42063),n=Ts(n,a,i,r,t[11],22,-1990404162),r=Ts(r,n,a,i,t[12],7,1804603682),i=Ts(i,r,n,a,t[13],12,-40341101),a=Ts(a,i,r,n,t[14],17,-1502002290),r=Is(r,n=Ts(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=Is(i,r,n,a,t[6],9,-1069501632),a=Is(a,i,r,n,t[11],14,643717713),n=Is(n,a,i,r,t[0],20,-373897302),r=Is(r,n,a,i,t[5],5,-701558691),i=Is(i,r,n,a,t[10],9,38016083),a=Is(a,i,r,n,t[15],14,-660478335),n=Is(n,a,i,r,t[4],20,-405537848),r=Is(r,n,a,i,t[9],5,568446438),i=Is(i,r,n,a,t[14],9,-1019803690),a=Is(a,i,r,n,t[3],14,-187363961),n=Is(n,a,i,r,t[8],20,1163531501),r=Is(r,n,a,i,t[13],5,-1444681467),i=Is(i,r,n,a,t[2],9,-51403784),a=Is(a,i,r,n,t[7],14,1735328473),r=Ds(r,n=Is(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=Ds(i,r,n,a,t[8],11,-2022574463),a=Ds(a,i,r,n,t[11],16,1839030562),n=Ds(n,a,i,r,t[14],23,-35309556),r=Ds(r,n,a,i,t[1],4,-1530992060),i=Ds(i,r,n,a,t[4],11,1272893353),a=Ds(a,i,r,n,t[7],16,-155497632),n=Ds(n,a,i,r,t[10],23,-1094730640),r=Ds(r,n,a,i,t[13],4,681279174),i=Ds(i,r,n,a,t[0],11,-358537222),a=Ds(a,i,r,n,t[3],16,-722521979),n=Ds(n,a,i,r,t[6],23,76029189),r=Ds(r,n,a,i,t[9],4,-640364487),i=Ds(i,r,n,a,t[12],11,-421815835),a=Ds(a,i,r,n,t[15],16,530742520),r=Ms(r,n=Ds(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=Ms(i,r,n,a,t[7],10,1126891415),a=Ms(a,i,r,n,t[14],15,-1416354905),n=Ms(n,a,i,r,t[5],21,-57434055),r=Ms(r,n,a,i,t[12],6,1700485571),i=Ms(i,r,n,a,t[3],10,-1894986606),a=Ms(a,i,r,n,t[10],15,-1051523),n=Ms(n,a,i,r,t[1],21,-2054922799),r=Ms(r,n,a,i,t[8],6,1873313359),i=Ms(i,r,n,a,t[15],10,-30611744),a=Ms(a,i,r,n,t[6],15,-1560198380),n=Ms(n,a,i,r,t[13],21,1309151649),r=Ms(r,n,a,i,t[4],6,-145523070),i=Ms(i,r,n,a,t[11],10,-1120210379),a=Ms(a,i,r,n,t[2],15,718787259),n=Ms(n,a,i,r,t[9],21,-343485551),e[0]=Rm(r,e[0]),e[1]=Rm(n,e[1]),e[2]=Rm(a,e[2]),e[3]=Rm(i,e[3])}function u5(e,t,r,n,a,i){return t=Rm(Rm(t,e),Rm(n,i)),Rm(t<<a|t>>>32-a,r)}function Ts(e,t,r,n,a,i,s){return u5(t&r|~t&n,e,t,a,i,s)}function Is(e,t,r,n,a,i,s){return u5(t&n|r&~n,e,t,a,i,s)}function Ds(e,t,r,n,a,i,s){return u5(t^r^n,e,t,a,i,s)}function Ms(e,t,r,n,a,i,s){return u5(r^(t|~n),e,t,a,i,s)}function jne(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)aE(n,GJe(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(aE(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,aE(n,a),n}function GJe(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var Jz="0123456789abcdef".split("");function KJe(e){for(var t="",r=0;r<4;r++)t+=Jz[e>>8*r+4&15]+Jz[e>>8*r&15];return t}function YJe(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function g4(e){return jne(e).map(YJe).join("")}var XJe=function(e){for(var t=0;t<e.length;t++)e[t]=KJe(e[t]);return e.join("")}(jne("hello"))!="5d41402abc4b2a76b9719d911017c592";function Rm(e,t){if(XJe){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function v4(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length|0),new Array(i+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+s.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=e,n=l}else l=n;var f=t.length,m=0,h=0,v="";for(c=0;c<f;c++)h=(h+(u=l[m=(m+1)%256]))%256,l[m]=l[h],l[h]=u,s=l[(l[m]+l[h])%256],v+=String.fromCharCode(t.charCodeAt(c)^s);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Qz={print:4,modify:8,copy:16,"annot-forms":32};function av(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(l){if(Qz.perm!==void 0)throw new Error("Invalid permission: "+l);a+=Qz[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=g4(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=v4(this.encryptionKey,this.padding)}function ov(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return t}function Zz(e){if(Aa(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(l){Yn.console&&mo.error("jsPDF PubSub Error",l.message,l)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function k1(e){if(!(this instanceof k1))return new k1(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Nne(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Cm(e,t,r,n,a){if(!(this instanceof Cm))return new Cm(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Nne.call(this,n,a)}function _p(e,t,r,n,a){if(!(this instanceof _p))return new _p(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Nne.call(this,n,a)}function Nn(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],l=1,c=16,d="S",u=null;Aa(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,m={},h={internal:{},__private__:{}};h.__private__.PubSub=Zz;var v="1.3",g=h.__private__.getPdfVersion=function(){return v};h.__private__.setPdfVersion=function(O){v=O};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var y=h.__private__.getPageFormat=function(O){return x[O]};a=a||"a4";var b="compat",w="advanced",j=b;function _(){this.saveGraphicsState(),Y(new Mt($e,0,0,-$e,0,Qe()*$e).toString()+" cm"),this.setFontSize(this.getFontSize()/$e),d="n",j=w}function S(){this.restoreGraphicsState(),d="S",j=b}var k=h.__private__.combineFontStyleAndFontWeight=function(O,H){if(O=="bold"&&H=="normal"||O=="bold"&&H==400||O=="normal"&&H=="italic"||O=="bold"&&H=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return H&&(O=H==400||H==="normal"?O==="italic"?"italic":"normal":H!=700&&H!=="bold"||O!=="normal"?(H==700?"bold":H)+""+O:"bold"),O};h.advancedAPI=function(O){var H=j===b;return H&&_.call(this),typeof O!="function"||(O(this),H&&S.call(this)),this},h.compatAPI=function(O){var H=j===w;return H&&S.call(this),typeof O!="function"||(O(this),H&&_.call(this)),this},h.isAdvancedAPI=function(){return j===w};var E,A=function(O){if(j!==w)throw new Error(O+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},M=h.roundToPrecision=h.__private__.roundToPrecision=function(O,H){var _e=t||H;if(isNaN(O)||isNaN(_e))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return O.toFixed(_e).replace(/0+$/,"")};E=h.hpf=h.__private__.hpf=typeof c=="number"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return M(O,c)}:c==="smart"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return M(O,O>-1&&O<1?16:5)}:function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return M(O,16)};var C=h.f2=h.__private__.f2=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f2");return M(O,2)},T=h.__private__.f3=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f3");return M(O,3)},I=h.scale=h.__private__.scale=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.scale");return j===b?O*$e:j===w?O:void 0},D=function(O){return I(function(H){return j===b?Qe()-H:j===w?H:void 0}(O))};h.__private__.setPrecision=h.setPrecision=function(O){typeof parseInt(O,10)=="number"&&(t=parseInt(O,10))};var F,z="00000000000000000000000000000000",q=h.__private__.getFileId=function(){return z},$=h.__private__.setFileId=function(O){return z=O!==void 0&&/^[a-fA-F0-9]{32}$/.test(O)?O.toUpperCase():z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(He=new av(u.userPermissions,u.userPassword,u.ownerPassword,z)),z};h.setFileId=function(O){return $(O),this},h.getFileId=function(){return q()};var K=h.__private__.convertDateToPDFDate=function(O){var H=O.getTimezoneOffset(),_e=H<0?"+":"-",Oe=Math.floor(Math.abs(H/60)),ve=Math.abs(H%60),Xe=[_e,V(Oe),"'",V(ve),"'"].join("");return["D:",O.getFullYear(),V(O.getMonth()+1),V(O.getDate()),V(O.getHours()),V(O.getMinutes()),V(O.getSeconds()),Xe].join("")},ce=h.__private__.convertPDFDateToDate=function(O){var H=parseInt(O.substr(2,4),10),_e=parseInt(O.substr(6,2),10)-1,Oe=parseInt(O.substr(8,2),10),ve=parseInt(O.substr(10,2),10),Xe=parseInt(O.substr(12,2),10),et=parseInt(O.substr(14,2),10);return new Date(H,_e,Oe,ve,Xe,et,0)},fe=h.__private__.setCreationDate=function(O){var H;if(O===void 0&&(O=new Date),O instanceof Date)H=K(O);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(O))throw new Error("Invalid argument passed to jsPDF.setCreationDate");H=O}return F=H},B=h.__private__.getCreationDate=function(O){var H=F;return O==="jsDate"&&(H=ce(F)),H};h.setCreationDate=function(O){return fe(O),this},h.getCreationDate=function(O){return B(O)};var L,V=h.__private__.padd2=function(O){return("0"+parseInt(O)).slice(-2)},re=h.__private__.padd2Hex=function(O){return("00"+(O=O.toString())).substr(O.length)},me=0,G=[],Q=[],ae=0,J=[],je=[],be=!1,Ue=Q;h.__private__.setCustomOutputDestination=function(O){be=!0,Ue=O};var Z=function(O){be||(Ue=O)};h.__private__.resetCustomOutputDestination=function(){be=!1,Ue=Q};var Y=h.__private__.out=function(O){return O=O.toString(),ae+=O.length+1,Ue.push(O),Ue},lt=h.__private__.write=function(O){return Y(arguments.length===1?O.toString():Array.prototype.join.call(arguments," "))},gt=h.__private__.getArrayBuffer=function(O){for(var H=O.length,_e=new ArrayBuffer(H),Oe=new Uint8Array(_e);H--;)Oe[H]=O.charCodeAt(H);return _e},Te=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Te};var at=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(O){return at=j===w?O/$e:O,this};var yt,vt=h.__private__.getFontSize=h.getFontSize=function(){return j===b?at:at*$e},Sr=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(O){return Sr=O,this},h.__private__.getR2L=h.getR2L=function(){return Sr};var se,Ze=h.__private__.setZoomMode=function(O){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(O))yt=O;else if(isNaN(O)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(O)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+O+'" is not recognized.');yt=O}else yt=parseInt(O,10)};h.__private__.getZoomMode=function(){return yt};var ct,Qt=h.__private__.setPageMode=function(O){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(O)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+O+'" is not recognized.');se=O};h.__private__.getPageMode=function(){return se};var we=h.__private__.setLayoutMode=function(O){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(O)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+O+'" is not recognized.');ct=O};h.__private__.getLayoutMode=function(){return ct},h.__private__.setDisplayMode=h.setDisplayMode=function(O,H,_e){return Ze(O),we(H),Qt(_e),this};var ye={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(O){if(Object.keys(ye).indexOf(O)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ye[O]},h.__private__.getDocumentProperties=function(){return ye},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(O){for(var H in ye)ye.hasOwnProperty(H)&&O[H]&&(ye[H]=O[H]);return this},h.__private__.setDocumentProperty=function(O,H){if(Object.keys(ye).indexOf(O)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ye[O]=H};var te,$e,Pe,It,Dt,kt={},cr={},Cr=[],Ie={},ke={},Je={},mt={},Be=null,$t=0,Ee=[],Ct=new Zz(h),hr=e.hotfixes||[],Mr={},qr={},Or=[],Mt=function O(H,_e,Oe,ve,Xe,et){if(!(this instanceof O))return new O(H,_e,Oe,ve,Xe,et);isNaN(H)&&(H=1),isNaN(_e)&&(_e=0),isNaN(Oe)&&(Oe=0),isNaN(ve)&&(ve=1),isNaN(Xe)&&(Xe=0),isNaN(et)&&(et=0),this._matrix=[H,_e,Oe,ve,Xe,et]};Object.defineProperty(Mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Mt.prototype.join=function(O){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(E).join(O)},Mt.prototype.multiply=function(O){var H=O.sx*this.sx+O.shy*this.shx,_e=O.sx*this.shy+O.shy*this.sy,Oe=O.shx*this.sx+O.sy*this.shx,ve=O.shx*this.shy+O.sy*this.sy,Xe=O.tx*this.sx+O.ty*this.shx+this.tx,et=O.tx*this.shy+O.ty*this.sy+this.ty;return new Mt(H,_e,Oe,ve,Xe,et)},Mt.prototype.decompose=function(){var O=this.sx,H=this.shy,_e=this.shx,Oe=this.sy,ve=this.tx,Xe=this.ty,et=Math.sqrt(O*O+H*H),zt=(O/=et)*_e+(H/=et)*Oe;_e-=O*zt,Oe-=H*zt;var nr=Math.sqrt(_e*_e+Oe*Oe);return zt/=nr,O*(Oe/=nr)<H*(_e/=nr)&&(O=-O,H=-H,zt=-zt,et=-et),{scale:new Mt(et,0,0,nr,0,0),translate:new Mt(1,0,0,1,ve,Xe),rotate:new Mt(O,H,-H,O,0,0),skew:new Mt(1,0,zt,1,0,0)}},Mt.prototype.toString=function(O){return this.join(" ")},Mt.prototype.inversed=function(){var O=this.sx,H=this.shy,_e=this.shx,Oe=this.sy,ve=this.tx,Xe=this.ty,et=1/(O*Oe-H*_e),zt=Oe*et,nr=-H*et,Et=-_e*et,Gt=O*et;return new Mt(zt,nr,Et,Gt,-zt*ve-Et*Xe,-nr*ve-Gt*Xe)},Mt.prototype.applyToPoint=function(O){var H=O.x*this.sx+O.y*this.shx+this.tx,_e=O.x*this.shy+O.y*this.sy+this.ty;return new er(H,_e)},Mt.prototype.applyToRectangle=function(O){var H=this.applyToPoint(O),_e=this.applyToPoint(new er(O.x+O.w,O.y+O.h));return new _r(H.x,H.y,_e.x-H.x,_e.y-H.y)},Mt.prototype.clone=function(){var O=this.sx,H=this.shy,_e=this.shx,Oe=this.sy,ve=this.tx,Xe=this.ty;return new Mt(O,H,_e,Oe,ve,Xe)},h.Matrix=Mt;var Ir=h.matrixMult=function(O,H){return H.multiply(O)},Ar=new Mt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Ar;var Zt=function(O,H){if(!ke[O]){var _e=(H instanceof Cm?"Sh":"P")+(Object.keys(Ie).length+1).toString(10);H.id=_e,ke[O]=_e,Ie[_e]=H,Ct.publish("addPattern",H)}};h.ShadingPattern=Cm,h.TilingPattern=_p,h.addShadingPattern=function(O,H){return A("addShadingPattern()"),Zt(O,H),this},h.beginTilingPattern=function(O){A("beginTilingPattern()"),ie(O.boundingBox[0],O.boundingBox[1],O.boundingBox[2]-O.boundingBox[0],O.boundingBox[3]-O.boundingBox[1],O.matrix)},h.endTilingPattern=function(O,H){A("endTilingPattern()"),H.stream=je[L].join(`
`),Zt(O,H),Ct.publish("endTilingPattern",H),Or.pop().restore()};var Kr,Tr=h.__private__.newObject=function(){var O=dn();return Ae(O,!0),O},dn=h.__private__.newObjectDeferred=function(){return me++,G[me]=function(){return ae},me},Ae=function(O,H){return H=typeof H=="boolean"&&H,G[O]=ae,H&&Y(O+" 0 obj"),O},pt=h.__private__.newAdditionalObject=function(){var O={objId:dn(),content:""};return J.push(O),O},Br=dn(),Pr=dn(),Ur=h.__private__.decodeColorString=function(O){var H=O.split(" ");if(H.length!==2||H[1]!=="g"&&H[1]!=="G")H.length!==5||H[4]!=="k"&&H[4]!=="K"||(H=[(1-H[0])*(1-H[3]),(1-H[1])*(1-H[3]),(1-H[2])*(1-H[3]),"r"]);else{var _e=parseFloat(H[0]);H=[_e,_e,_e,"r"]}for(var Oe="#",ve=0;ve<3;ve++)Oe+=("0"+Math.floor(255*parseFloat(H[ve])).toString(16)).slice(-2);return Oe},Zr=h.__private__.encodeColorString=function(O){var H;typeof O=="string"&&(O={ch1:O});var _e=O.ch1,Oe=O.ch2,ve=O.ch3,Xe=O.ch4,et=O.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof _e=="string"&&_e.charAt(0)!=="#"){var zt=new wne(_e);if(zt.ok)_e=zt.toHex();else if(!/^\d*\.?\d*$/.test(_e))throw new Error('Invalid color "'+_e+'" passed to jsPDF.encodeColorString.')}if(typeof _e=="string"&&/^#[0-9A-Fa-f]{3}$/.test(_e)&&(_e="#"+_e[1]+_e[1]+_e[2]+_e[2]+_e[3]+_e[3]),typeof _e=="string"&&/^#[0-9A-Fa-f]{6}$/.test(_e)){var nr=parseInt(_e.substr(1),16);_e=nr>>16&255,Oe=nr>>8&255,ve=255&nr}if(Oe===void 0||Xe===void 0&&_e===Oe&&Oe===ve)H=typeof _e=="string"?_e+" "+et[0]:O.precision===2?C(_e/255)+" "+et[0]:T(_e/255)+" "+et[0];else if(Xe===void 0||Aa(Xe)==="object"){if(Xe&&!isNaN(Xe.a)&&Xe.a===0)return["1.","1.","1.",et[1]].join(" ");H=typeof _e=="string"?[_e,Oe,ve,et[1]].join(" "):O.precision===2?[C(_e/255),C(Oe/255),C(ve/255),et[1]].join(" "):[T(_e/255),T(Oe/255),T(ve/255),et[1]].join(" ")}else H=typeof _e=="string"?[_e,Oe,ve,Xe,et[2]].join(" "):O.precision===2?[C(_e),C(Oe),C(ve),C(Xe),et[2]].join(" "):[T(_e),T(Oe),T(ve),T(Xe),et[2]].join(" ");return H},cn=h.__private__.getFilters=function(){return s},Tn=h.__private__.putStream=function(O){var H=(O=O||{}).data||"",_e=O.filters||cn(),Oe=O.alreadyAppliedFilters||[],ve=O.addLength1||!1,Xe=H.length,et=O.objectId,zt=function(xr){return xr};if(u!==null&&et===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(zt=He.encryptor(et,0));var nr={};_e===!0&&(_e=["FlateEncode"]);var Et=O.additionalKeyValues||[],Gt=(nr=Nn.API.processDataByFilters!==void 0?Nn.API.processDataByFilters(H,_e):{data:H,reverseChain:[]}).reverseChain+(Array.isArray(Oe)?Oe.join(" "):Oe.toString());if(nr.data.length!==0&&(Et.push({key:"Length",value:nr.data.length}),ve===!0&&Et.push({key:"Length1",value:Xe})),Gt.length!=0)if(Gt.split("/").length-1==1)Et.push({key:"Filter",value:Gt});else{Et.push({key:"Filter",value:"["+Gt+"]"});for(var Nr=0;Nr<Et.length;Nr+=1)if(Et[Nr].key==="DecodeParms"){for(var tr=[],ar=0;ar<nr.reverseChain.split("/").length-1;ar+=1)tr.push("null");tr.push(Et[Nr].value),Et[Nr].value="["+tr.join(" ")+"]"}}Y("<<");for(var sr=0;sr<Et.length;sr++)Y("/"+Et[sr].key+" "+Et[sr].value);Y(">>"),nr.data.length!==0&&(Y("stream"),Y(zt(nr.data)),Y("endstream"))},Qn=h.__private__.putPage=function(O){var H=O.number,_e=O.data,Oe=O.objId,ve=O.contentsObjId;Ae(Oe,!0),Y("<</Type /Page"),Y("/Parent "+O.rootDictionaryObjId+" 0 R"),Y("/Resources "+O.resourceDictionaryObjId+" 0 R"),Y("/MediaBox ["+parseFloat(E(O.mediaBox.bottomLeftX))+" "+parseFloat(E(O.mediaBox.bottomLeftY))+" "+E(O.mediaBox.topRightX)+" "+E(O.mediaBox.topRightY)+"]"),O.cropBox!==null&&Y("/CropBox ["+E(O.cropBox.bottomLeftX)+" "+E(O.cropBox.bottomLeftY)+" "+E(O.cropBox.topRightX)+" "+E(O.cropBox.topRightY)+"]"),O.bleedBox!==null&&Y("/BleedBox ["+E(O.bleedBox.bottomLeftX)+" "+E(O.bleedBox.bottomLeftY)+" "+E(O.bleedBox.topRightX)+" "+E(O.bleedBox.topRightY)+"]"),O.trimBox!==null&&Y("/TrimBox ["+E(O.trimBox.bottomLeftX)+" "+E(O.trimBox.bottomLeftY)+" "+E(O.trimBox.topRightX)+" "+E(O.trimBox.topRightY)+"]"),O.artBox!==null&&Y("/ArtBox ["+E(O.artBox.bottomLeftX)+" "+E(O.artBox.bottomLeftY)+" "+E(O.artBox.topRightX)+" "+E(O.artBox.topRightY)+"]"),typeof O.userUnit=="number"&&O.userUnit!==1&&Y("/UserUnit "+O.userUnit),Ct.publish("putPage",{objId:Oe,pageContext:Ee[H],pageNumber:H,page:_e}),Y("/Contents "+ve+" 0 R"),Y(">>"),Y("endobj");var Xe=_e.join(`
`);return j===w&&(Xe+=`
Q`),Ae(ve,!0),Tn({data:Xe,filters:cn(),objectId:ve}),Y("endobj"),Oe},Sa=h.__private__.putPages=function(){var O,H,_e=[];for(O=1;O<=$t;O++)Ee[O].objId=dn(),Ee[O].contentsObjId=dn();for(O=1;O<=$t;O++)_e.push(Qn({number:O,data:je[O],objId:Ee[O].objId,contentsObjId:Ee[O].contentsObjId,mediaBox:Ee[O].mediaBox,cropBox:Ee[O].cropBox,bleedBox:Ee[O].bleedBox,trimBox:Ee[O].trimBox,artBox:Ee[O].artBox,userUnit:Ee[O].userUnit,rootDictionaryObjId:Br,resourceDictionaryObjId:Pr}));Ae(Br,!0),Y("<</Type /Pages");var Oe="/Kids [";for(H=0;H<$t;H++)Oe+=_e[H]+" 0 R ";Y(Oe+"]"),Y("/Count "+$t),Y(">>"),Y("endobj"),Ct.publish("postPutPages")},ht=function(O){Ct.publish("putFont",{font:O,out:Y,newObject:Tr,putStream:Tn}),O.isAlreadyPutted!==!0&&(O.objectNumber=Tr(),Y("<<"),Y("/Type /Font"),Y("/BaseFont /"+ov(O.postScriptName)),Y("/Subtype /Type1"),typeof O.encoding=="string"&&Y("/Encoding /"+O.encoding),Y("/FirstChar 32"),Y("/LastChar 255"),Y(">>"),Y("endobj"))},Vt=function(O){O.objectNumber=Tr();var H=[];H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Form"}),H.push({key:"BBox",value:"["+[E(O.x),E(O.y),E(O.x+O.width),E(O.y+O.height)].join(" ")+"]"}),H.push({key:"Matrix",value:"["+O.matrix.toString()+"]"});var _e=O.pages[1].join(`
`);Tn({data:_e,additionalKeyValues:H,objectId:O.objectNumber}),Y("endobj")},gr=function(O,H){H||(H=21);var _e=Tr(),Oe=function(et,zt){var nr,Et=[],Gt=1/(zt-1);for(nr=0;nr<1;nr+=Gt)Et.push(nr);if(Et.push(1),et[0].offset!=0){var Nr={offset:0,color:et[0].color};et.unshift(Nr)}if(et[et.length-1].offset!=1){var tr={offset:1,color:et[et.length-1].color};et.push(tr)}for(var ar="",sr=0,xr=0;xr<Et.length;xr++){for(nr=Et[xr];nr>et[sr+1].offset;)sr++;var St=et[sr].offset,Lr=(nr-St)/(et[sr+1].offset-St),Fr=et[sr].color,gn=et[sr+1].color;ar+=re(Math.round((1-Lr)*Fr[0]+Lr*gn[0]).toString(16))+re(Math.round((1-Lr)*Fr[1]+Lr*gn[1]).toString(16))+re(Math.round((1-Lr)*Fr[2]+Lr*gn[2]).toString(16))}return ar.trim()}(O.colors,H),ve=[];ve.push({key:"FunctionType",value:"0"}),ve.push({key:"Domain",value:"[0.0 1.0]"}),ve.push({key:"Size",value:"["+H+"]"}),ve.push({key:"BitsPerSample",value:"8"}),ve.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ve.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Tn({data:Oe,additionalKeyValues:ve,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:_e}),Y("endobj"),O.objectNumber=Tr(),Y("<< /ShadingType "+O.type),Y("/ColorSpace /DeviceRGB");var Xe="/Coords ["+E(parseFloat(O.coords[0]))+" "+E(parseFloat(O.coords[1]))+" ";O.type===2?Xe+=E(parseFloat(O.coords[2]))+" "+E(parseFloat(O.coords[3])):Xe+=E(parseFloat(O.coords[2]))+" "+E(parseFloat(O.coords[3]))+" "+E(parseFloat(O.coords[4]))+" "+E(parseFloat(O.coords[5])),Y(Xe+="]"),O.matrix&&Y("/Matrix ["+O.matrix.toString()+"]"),Y("/Function "+_e+" 0 R"),Y("/Extend [true true]"),Y(">>"),Y("endobj")},Lt=function(O,H){var _e=dn(),Oe=Tr();H.push({resourcesOid:_e,objectOid:Oe}),O.objectNumber=Oe;var ve=[];ve.push({key:"Type",value:"/Pattern"}),ve.push({key:"PatternType",value:"1"}),ve.push({key:"PaintType",value:"1"}),ve.push({key:"TilingType",value:"1"}),ve.push({key:"BBox",value:"["+O.boundingBox.map(E).join(" ")+"]"}),ve.push({key:"XStep",value:E(O.xStep)}),ve.push({key:"YStep",value:E(O.yStep)}),ve.push({key:"Resources",value:_e+" 0 R"}),O.matrix&&ve.push({key:"Matrix",value:"["+O.matrix.toString()+"]"}),Tn({data:O.stream,additionalKeyValues:ve,objectId:O.objectNumber}),Y("endobj")},Pt=function(O){for(var H in O.objectNumber=Tr(),Y("<<"),O)switch(H){case"opacity":Y("/ca "+C(O[H]));break;case"stroke-opacity":Y("/CA "+C(O[H]))}Y(">>"),Y("endobj")},Yr=function(O){Ae(O.resourcesOid,!0),Y("<<"),Y("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var H in Y("/Font <<"),kt)kt.hasOwnProperty(H)&&(f===!1||f===!0&&m.hasOwnProperty(H))&&Y("/"+H+" "+kt[H].objectNumber+" 0 R");Y(">>")}(),function(){if(Object.keys(Ie).length>0){for(var H in Y("/Shading <<"),Ie)Ie.hasOwnProperty(H)&&Ie[H]instanceof Cm&&Ie[H].objectNumber>=0&&Y("/"+H+" "+Ie[H].objectNumber+" 0 R");Ct.publish("putShadingPatternDict"),Y(">>")}}(),function(H){if(Object.keys(Ie).length>0){for(var _e in Y("/Pattern <<"),Ie)Ie.hasOwnProperty(_e)&&Ie[_e]instanceof h.TilingPattern&&Ie[_e].objectNumber>=0&&Ie[_e].objectNumber<H&&Y("/"+_e+" "+Ie[_e].objectNumber+" 0 R");Ct.publish("putTilingPatternDict"),Y(">>")}}(O.objectOid),function(){if(Object.keys(Je).length>0){var H;for(H in Y("/ExtGState <<"),Je)Je.hasOwnProperty(H)&&Je[H].objectNumber>=0&&Y("/"+H+" "+Je[H].objectNumber+" 0 R");Ct.publish("putGStateDict"),Y(">>")}}(),function(){for(var H in Y("/XObject <<"),Mr)Mr.hasOwnProperty(H)&&Mr[H].objectNumber>=0&&Y("/"+H+" "+Mr[H].objectNumber+" 0 R");Ct.publish("putXobjectDict"),Y(">>")}(),Y(">>"),Y("endobj")},Ft=function(O){cr[O.fontName]=cr[O.fontName]||{},cr[O.fontName][O.fontStyle]=O.id},jr=function(O,H,_e,Oe,ve){var Xe={id:"F"+(Object.keys(kt).length+1).toString(10),postScriptName:O,fontName:H,fontStyle:_e,encoding:Oe,isStandardFont:ve||!1,metadata:{}};return Ct.publish("addFont",{font:Xe,instance:this}),kt[Xe.id]=Xe,Ft(Xe),Xe.id},ot=h.__private__.pdfEscape=h.pdfEscape=function(O,H){return function(_e,Oe){var ve,Xe,et,zt,nr,Et,Gt,Nr,tr;if(et=(Oe=Oe||{}).sourceEncoding||"Unicode",nr=Oe.outputEncoding,(Oe.autoencode||nr)&&kt[te].metadata&&kt[te].metadata[et]&&kt[te].metadata[et].encoding&&(zt=kt[te].metadata[et].encoding,!nr&&kt[te].encoding&&(nr=kt[te].encoding),!nr&&zt.codePages&&(nr=zt.codePages[0]),typeof nr=="string"&&(nr=zt[nr]),nr)){for(Gt=!1,Et=[],ve=0,Xe=_e.length;ve<Xe;ve++)(Nr=nr[_e.charCodeAt(ve)])?Et.push(String.fromCharCode(Nr)):Et.push(_e[ve]),Et[ve].charCodeAt(0)>>8&&(Gt=!0);_e=Et.join("")}for(ve=_e.length;Gt===void 0&&ve!==0;)_e.charCodeAt(ve-1)>>8&&(Gt=!0),ve--;if(!Gt)return _e;for(Et=Oe.noBOM?[]:[254,255],ve=0,Xe=_e.length;ve<Xe;ve++){if((tr=(Nr=_e.charCodeAt(ve))>>8)>>8)throw new Error("Character at position "+ve+" of string '"+_e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Et.push(tr),Et.push(Nr-(tr<<8))}return String.fromCharCode.apply(void 0,Et)}(O,H).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Kt=h.__private__.beginPage=function(O){je[++$t]=[],Ee[$t]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(O[0]),topRightY:Number(O[1])}},nt($t),Z(je[L])},vr=function(O,H){var _e,Oe,ve;switch(r=H||r,typeof O=="string"&&(_e=y(O.toLowerCase()),Array.isArray(_e)&&(Oe=_e[0],ve=_e[1])),Array.isArray(O)&&(Oe=O[0]*$e,ve=O[1]*$e),isNaN(Oe)&&(Oe=a[0],ve=a[1]),(Oe>14400||ve>14400)&&(mo.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Oe=Math.min(14400,Oe),ve=Math.min(14400,ve)),a=[Oe,ve],r.substr(0,1)){case"l":ve>Oe&&(a=[ve,Oe]);break;case"p":Oe>ve&&(a=[ve,Oe])}Kt(a),Ea(va),Y(cs),Rt!==0&&Y(Rt+" J"),Ot!==0&&Y(Ot+" j"),Ct.publish("addPage",{pageNumber:$t})},X=function(O){O>0&&O<=$t&&(je.splice(O,1),Ee.splice(O,1),$t--,L>$t&&(L=$t),this.setPage(L))},nt=function(O){O>0&&O<=$t&&(L=O)},qe=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return je.length-1},it=function(O,H,_e){var Oe,ve=void 0;return _e=_e||{},O=O!==void 0?O:kt[te].fontName,H=H!==void 0?H:kt[te].fontStyle,Oe=O.toLowerCase(),cr[Oe]!==void 0&&cr[Oe][H]!==void 0?ve=cr[Oe][H]:cr[O]!==void 0&&cr[O][H]!==void 0?ve=cr[O][H]:_e.disableWarning===!1&&mo.warn("Unable to look up font label for font '"+O+"', '"+H+"'. Refer to getFontList() for available fonts."),ve||_e.noFallback||(ve=cr.times[H])==null&&(ve=cr.times.normal),ve},We=h.__private__.putInfo=function(){var O=Tr(),H=function(Oe){return Oe};for(var _e in u!==null&&(H=He.encryptor(O,0)),Y("<<"),Y("/Producer ("+ot(H("jsPDF "+Nn.version))+")"),ye)ye.hasOwnProperty(_e)&&ye[_e]&&Y("/"+_e.substr(0,1).toUpperCase()+_e.substr(1)+" ("+ot(H(ye[_e]))+")");Y("/CreationDate ("+ot(H(F))+")"),Y(">>"),Y("endobj")},ut=h.__private__.putCatalog=function(O){var H=(O=O||{}).rootDictionaryObjId||Br;switch(Tr(),Y("<<"),Y("/Type /Catalog"),Y("/Pages "+H+" 0 R"),yt||(yt="fullwidth"),yt){case"fullwidth":Y("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Y("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Y("/OpenAction [3 0 R /Fit]");break;case"original":Y("/OpenAction [3 0 R /XYZ null null 1]");break;default:var _e=""+yt;_e.substr(_e.length-1)==="%"&&(yt=parseInt(yt)/100),typeof yt=="number"&&Y("/OpenAction [3 0 R /XYZ null null "+C(yt)+"]")}switch(ct||(ct="continuous"),ct){case"continuous":Y("/PageLayout /OneColumn");break;case"single":Y("/PageLayout /SinglePage");break;case"two":case"twoleft":Y("/PageLayout /TwoColumnLeft");break;case"tworight":Y("/PageLayout /TwoColumnRight")}se&&Y("/PageMode /"+se),Ct.publish("putCatalog"),Y(">>"),Y("endobj")},At=h.__private__.putTrailer=function(){Y("trailer"),Y("<<"),Y("/Size "+(me+1)),Y("/Root "+me+" 0 R"),Y("/Info "+(me-1)+" 0 R"),u!==null&&Y("/Encrypt "+He.oid+" 0 R"),Y("/ID [ <"+z+"> <"+z+"> ]"),Y(">>")},Wt=h.__private__.putHeader=function(){Y("%PDF-"+v),Y("%")},$r=h.__private__.putXRef=function(){var O="0000000000";Y("xref"),Y("0 "+(me+1)),Y("0000000000 65535 f ");for(var H=1;H<=me;H++)typeof G[H]=="function"?Y((O+G[H]()).slice(-10)+" 00000 n "):G[H]!==void 0?Y((O+G[H]).slice(-10)+" 00000 n "):Y("0000000000 00000 n ")},W=h.__private__.buildDocument=function(){var O;me=0,ae=0,Q=[],G=[],J=[],Br=dn(),Pr=dn(),Z(Q),Ct.publish("buildDocument"),Wt(),Sa(),function(){Ct.publish("putAdditionalObjects");for(var _e=0;_e<J.length;_e++){var Oe=J[_e];Ae(Oe.objId,!0),Y(Oe.content),Y("endobj")}Ct.publish("postPutAdditionalObjects")}(),O=[],function(){for(var _e in kt)kt.hasOwnProperty(_e)&&(f===!1||f===!0&&m.hasOwnProperty(_e))&&ht(kt[_e])}(),function(){var _e;for(_e in Je)Je.hasOwnProperty(_e)&&Pt(Je[_e])}(),function(){for(var _e in Mr)Mr.hasOwnProperty(_e)&&Vt(Mr[_e])}(),function(_e){var Oe;for(Oe in Ie)Ie.hasOwnProperty(Oe)&&(Ie[Oe]instanceof Cm?gr(Ie[Oe]):Ie[Oe]instanceof _p&&Lt(Ie[Oe],_e))}(O),Ct.publish("putResources"),O.forEach(Yr),Yr({resourcesOid:Pr,objectOid:Number.MAX_SAFE_INTEGER}),Ct.publish("postPutResources"),u!==null&&(He.oid=Tr(),Y("<<"),Y("/Filter /Standard"),Y("/V "+He.v),Y("/R "+He.r),Y("/U <"+He.toHexString(He.U)+">"),Y("/O <"+He.toHexString(He.O)+">"),Y("/P "+He.P),Y(">>"),Y("endobj")),We(),ut();var H=ae;return $r(),At(),Y("startxref"),Y(""+H),Y("%%EOF"),Z(je[L]),Q.join(`
`)},Ce=h.__private__.getBlob=function(O){return new Blob([gt(O)],{type:"application/pdf"})},De=h.output=h.__private__.output=(Kr=function(O,H){switch(typeof(H=H||{})=="string"?H={filename:H}:H.filename=H.filename||"generated.pdf",O){case void 0:return W();case"save":h.save(H.filename);break;case"arraybuffer":return gt(W());case"blob":return Ce(W());case"bloburi":case"bloburl":if(Yn.URL!==void 0&&typeof Yn.URL.createObjectURL=="function")return Yn.URL&&Yn.URL.createObjectURL(Ce(W()))||void 0;mo.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var _e="",Oe=W();try{_e=Xz(Oe)}catch{_e=Xz(unescape(encodeURIComponent(Oe)))}return"data:application/pdf;filename="+H.filename+";base64,"+_e;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Yn)==="[object Window]"){var ve="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Xe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';H.pdfObjectUrl&&(ve=H.pdfObjectUrl,Xe="");var et='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ve+'"'+Xe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(H)+");<\/script></body></html>",zt=Yn.open();return zt!==null&&zt.document.write(et),zt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Yn)==="[object Window]"){var nr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(H.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+H.filename+'" width="500px" height="400px" /></body></html>',Et=Yn.open();if(Et!==null){Et.document.write(nr);var Gt=this;Et.document.documentElement.querySelector("#pdfViewer").onload=function(){Et.document.title=H.filename,Et.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Gt.output("bloburl"))}}return Et}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Yn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Nr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",H)+'"></iframe></body></html>',tr=Yn.open();if(tr!==null&&(tr.document.write(Nr),tr.document.title=H.filename),tr||typeof safari>"u")return tr;break;case"datauri":case"dataurl":return Yn.document.location.href=this.output("datauristring",H);default:return null}},Kr.foo=function(){try{return Kr.apply(this,arguments)}catch(_e){var O=_e.stack||"";~O.indexOf(" at ")&&(O=O.split(" at ")[1]);var H="Error in function "+O.split(`
`)[0].split("<")[0]+": "+_e.message;if(!Yn.console)throw new Error(H);Yn.console.error(H,_e),Yn.alert&&alert(H)}},Kr.foo.bar=Kr,Kr.foo),bt=function(O){return Array.isArray(hr)===!0&&hr.indexOf(O)>-1};switch(n){case"pt":$e=1;break;case"mm":$e=72/25.4;break;case"cm":$e=72/2.54;break;case"in":$e=72;break;case"px":$e=bt("px_scaling")==1?.75:96/72;break;case"pc":case"em":$e=12;break;case"ex":$e=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);$e=n}var He=null;fe(),$();var dt=h.__private__.getPageInfo=h.getPageInfo=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ee[O].objId,pageNumber:O,pageContext:Ee[O]}},rr=h.__private__.getPageInfoByObjId=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var H in Ee)if(Ee[H].objId===O)break;return dt(H)},Gr=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Ee[L].objId,pageNumber:L,pageContext:Ee[L]}};h.addPage=function(){return vr.apply(this,arguments),this},h.setPage=function(){return nt.apply(this,arguments),Z.call(this,je[L]),this},h.insertPage=function(O){return this.addPage(),this.movePage(L,O),this},h.movePage=function(O,H){var _e,Oe;if(O>H){_e=je[O],Oe=Ee[O];for(var ve=O;ve>H;ve--)je[ve]=je[ve-1],Ee[ve]=Ee[ve-1];je[H]=_e,Ee[H]=Oe,this.setPage(H)}else if(O<H){_e=je[O],Oe=Ee[O];for(var Xe=O;Xe<H;Xe++)je[Xe]=je[Xe+1],Ee[Xe]=Ee[Xe+1];je[H]=_e,Ee[H]=Oe,this.setPage(H)}return this},h.deletePage=function(){return X.apply(this,arguments),this},h.__private__.text=h.text=function(O,H,_e,Oe,ve){var Xe,et,zt,nr,Et,Gt,Nr,tr,ar,sr=(Oe=Oe||{}).scope||this;if(typeof O=="number"&&typeof H=="number"&&(typeof _e=="string"||Array.isArray(_e))){var xr=_e;_e=H,H=O,O=xr}if(arguments[3]instanceof Mt==0?(zt=arguments[4],nr=arguments[5],Aa(Nr=arguments[3])==="object"&&Nr!==null||(typeof zt=="string"&&(nr=zt,zt=null),typeof Nr=="string"&&(nr=Nr,Nr=null),typeof Nr=="number"&&(zt=Nr,Nr=null),Oe={flags:Nr,angle:zt,align:nr})):(A("The transform parameter of text() with a Matrix value"),ar=ve),isNaN(H)||isNaN(_e)||O==null)throw new Error("Invalid arguments passed to jsPDF.text");if(O.length===0)return sr;var St,Lr="",Fr=typeof Oe.lineHeightFactor=="number"?Oe.lineHeightFactor:Dn,gn=sr.internal.scaleFactor;function wa(ua){return ua=ua.split("	").join(Array(Oe.TabLen||9).join(" ")),ot(ua,Nr)}function $n(ua){for(var Ka,zo=ua.concat(),ii=[],Nd=zo.length;Nd--;)typeof(Ka=zo.shift())=="string"?ii.push(Ka):Array.isArray(ua)&&(Ka.length===1||Ka[1]===void 0&&Ka[2]===void 0)?ii.push(Ka[0]):ii.push([Ka[0],Ka[1],Ka[2]]);return ii}function ca(ua,Ka){var zo;if(typeof ua=="string")zo=Ka(ua)[0];else if(Array.isArray(ua)){for(var ii,Nd,Mh=ua.concat(),Ju=[],Rh=Mh.length;Rh--;)typeof(ii=Mh.shift())=="string"?Ju.push(Ka(ii)[0]):Array.isArray(ii)&&typeof ii[0]=="string"&&(Nd=Ka(ii[0],ii[1],ii[2]),Ju.push([Nd[0],Nd[1],Nd[2]]));zo=Ju}return zo}var da=!1,co=!0;if(typeof O=="string")da=!0;else if(Array.isArray(O)){var Oi=O.concat();et=[];for(var oi,Da=Oi.length;Da--;)(typeof(oi=Oi.shift())!="string"||Array.isArray(oi)&&typeof oi[0]!="string")&&(co=!1);da=co}if(da===!1)throw new Error('Type of text must be string or Array. "'+O+'" is not recognized.');typeof O=="string"&&(O=O.match(/[\r?\n]/)?O.split(/\r\n|\r|\n/g):[O]);var go=at/sr.internal.scaleFactor,Yi=go*(Fr-1);switch(Oe.baseline){case"bottom":_e-=Yi;break;case"top":_e+=go-Yi;break;case"hanging":_e+=go-2*Yi;break;case"middle":_e+=go/2-Yi}if((Gt=Oe.maxWidth||0)>0&&(typeof O=="string"?O=sr.splitTextToSize(O,Gt):Object.prototype.toString.call(O)==="[object Array]"&&(O=O.reduce(function(ua,Ka){return ua.concat(sr.splitTextToSize(Ka,Gt))},[]))),Xe={text:O,x:H,y:_e,options:Oe,mutex:{pdfEscape:ot,activeFontKey:te,fonts:kt,activeFontSize:at}},Ct.publish("preProcessText",Xe),O=Xe.text,zt=(Oe=Xe.options).angle,ar instanceof Mt==0&&zt&&typeof zt=="number"){zt*=Math.PI/180,Oe.rotationDirection===0&&(zt=-zt),j===w&&(zt=-zt);var uo=Math.cos(zt),ds=Math.sin(zt);ar=new Mt(uo,ds,-ds,uo,0,0)}else zt&&zt instanceof Mt&&(ar=zt);j!==w||ar||(ar=Ar),(Et=Oe.charSpace||Le)!==void 0&&(Lr+=E(I(Et))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(tr=Oe.horizontalScale)!==void 0&&(Lr+=E(100*tr)+` Tz
`),Oe.lang;var xa=-1,Xi=Oe.renderingMode!==void 0?Oe.renderingMode:Oe.stroke,Vs=sr.internal.getCurrentPageInfo().pageContext;switch(Xi){case 0:case!1:case"fill":xa=0;break;case 1:case!0:case"stroke":xa=1;break;case 2:case"fillThenStroke":xa=2;break;case 3:case"invisible":xa=3;break;case 4:case"fillAndAddForClipping":xa=4;break;case 5:case"strokeAndAddPathForClipping":xa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":xa=6;break;case 7:case"addToPathForClipping":xa=7}var Yu=Vs.usedRenderingMode!==void 0?Vs.usedRenderingMode:-1;xa!==-1?Lr+=xa+` Tr
`:Yu!==-1&&(Lr+=`0 Tr
`),xa!==-1&&(Vs.usedRenderingMode=xa),nr=Oe.align||"left";var Ma,Ws=at*Fr,Ul=sr.internal.pageSize.getWidth(),Cs=kt[te];Et=Oe.charSpace||Le,Gt=Oe.maxWidth||0,Nr=Object.assign({autoencode:!0,noBOM:!0},Oe.flags);var Ti=[],cu=function(ua){return sr.getStringUnitWidth(ua,{font:Cs,charSpace:Et,fontSize:at,doKerning:!1})*at/gn};if(Object.prototype.toString.call(O)==="[object Array]"){var bl;et=$n(O),nr!=="left"&&(Ma=et.map(cu));var Hs,xi=0;if(nr==="right"){H-=Ma[0],O=[],Da=et.length;for(var Ko=0;Ko<Da;Ko++)Ko===0?(Hs=vi(H),bl=oo(_e)):(Hs=I(xi-Ma[Ko]),bl=-Ws),O.push([et[Ko],Hs,bl]),xi=Ma[Ko]}else if(nr==="center"){H-=Ma[0]/2,O=[],Da=et.length;for(var du=0;du<Da;du++)du===0?(Hs=vi(H),bl=oo(_e)):(Hs=I((xi-Ma[du])/2),bl=-Ws),O.push([et[du],Hs,bl]),xi=Ma[du]}else if(nr==="left"){O=[],Da=et.length;for(var Oc=0;Oc<Da;Oc++)O.push(et[Oc])}else if(nr==="justify"&&Cs.encoding==="Identity-H"){O=[],Da=et.length,Gt=Gt!==0?Gt:Ul;for(var Tc=0,io=0;io<Da;io++)if(bl=io===0?oo(_e):-Ws,Hs=io===0?vi(H):Tc,io<Da-1){var Vl=I((Gt-Ma[io])/(et[io].split(" ").length-1)),vo=et[io].split(" ");O.push([vo[0]+" ",Hs,bl]),Tc=0;for(var Ps=1;Ps<vo.length;Ps++){var Xu=(cu(vo[Ps-1]+" "+vo[Ps])-cu(vo[Ps]))*gn+Vl;Ps==vo.length-1?O.push([vo[Ps],Xu,0]):O.push([vo[Ps]+" ",Xu,0]),Tc-=Xu}}else O.push([et[io],Hs,bl]);O.push(["",Tc,0])}else{if(nr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(O=[],Da=et.length,Gt=Gt!==0?Gt:Ul,io=0;io<Da;io++){bl=io===0?oo(_e):-Ws,Hs=io===0?vi(H):0;var Ic=et[io].split(" ").length-1,Dh=Ic>0?(Gt-Ma[io])/Ic:0;io<Da-1?Ti.push(E(I(Dh))):Ti.push(0),O.push([et[io],Hs,bl])}}}(typeof Oe.R2L=="boolean"?Oe.R2L:Sr)===!0&&(O=ca(O,function(ua,Ka,zo){return[ua.split("").reverse().join(""),Ka,zo]})),Xe={text:O,x:H,y:_e,options:Oe,mutex:{pdfEscape:ot,activeFontKey:te,fonts:kt,activeFontSize:at}},Ct.publish("postProcessText",Xe),O=Xe.text,St=Xe.mutex.isHex||!1;var Yf=kt[te].encoding;Yf!=="WinAnsiEncoding"&&Yf!=="StandardEncoding"||(O=ca(O,function(ua,Ka,zo){return[wa(ua),Ka,zo]})),et=$n(O),O=[];for(var Dc,Mc,Rc,Gs=Array.isArray(et[0])?1:0,Yo="",yi=function(ua,Ka,zo){var ii="";return zo instanceof Mt?(zo=typeof Oe.angle=="number"?Ir(zo,new Mt(1,0,0,1,ua,Ka)):Ir(new Mt(1,0,0,1,ua,Ka),zo),j===w&&(zo=Ir(new Mt(1,0,0,-1,0,0),zo)),ii=zo.join(" ")+` Tm
`):ii=E(ua)+" "+E(Ka)+` Td
`,ii},us=0;us<et.length;us++){switch(Yo="",Gs){case 1:Rc=(St?"<":"(")+et[us][0]+(St?">":")"),Dc=parseFloat(et[us][1]),Mc=parseFloat(et[us][2]);break;case 0:Rc=(St?"<":"(")+et[us]+(St?">":")"),Dc=vi(H),Mc=oo(_e)}Ti!==void 0&&Ti[us]!==void 0&&(Yo=Ti[us]+` Tw
`),us===0?O.push(Yo+yi(Dc,Mc,ar)+Rc):Gs===0?O.push(Yo+Rc):Gs===1&&O.push(Yo+yi(Dc,Mc,ar)+Rc)}O=Gs===0?O.join(` Tj
T* `):O.join(` Tj
`),O+=` Tj
`;var Lc=`BT
/`;return Lc+=te+" "+at+` Tf
`,Lc+=E(at*Fr)+` TL
`,Lc+=kc+`
`,Lc+=Lr,Lc+=O,Y(Lc+="ET"),m[te]=!0,sr};var Rr=h.__private__.clip=h.clip=function(O){return Y(O==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Rr("evenodd")},h.__private__.discardPath=h.discardPath=function(){return Y("n"),this};var br=h.__private__.isValidStyle=function(O){var H=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(O)!==-1&&(H=!0),H};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(O){return br(O)&&(d=O),this};var wr=h.__private__.getStyle=h.getStyle=function(O){var H=d;switch(O){case"D":case"S":H="S";break;case"F":H="f";break;case"FD":case"DF":H="B";break;case"f":case"f*":case"B":case"B*":H=O}return H},or=h.close=function(){return Y("h"),this};h.stroke=function(){return Y("S"),this},h.fill=function(O){return tn("f",O),this},h.fillEvenOdd=function(O){return tn("f*",O),this},h.fillStroke=function(O){return tn("B",O),this},h.fillStrokeEvenOdd=function(O){return tn("B*",O),this};var tn=function(O,H){Aa(H)==="object"?un(H,O):Y(O)},tt=function(O){O===null||j===w&&O===void 0||(O=wr(O),Y(O))};function Hr(O,H,_e,Oe,ve){var Xe=new _p(H||this.boundingBox,_e||this.xStep,Oe||this.yStep,this.gState,ve||this.matrix);Xe.stream=this.stream;var et=O+"$$"+this.cloneIndex+++"$$";return Zt(et,Xe),Xe}var un=function(O,H){var _e=ke[O.key],Oe=Ie[_e];if(Oe instanceof Cm)Y("q"),Y(jn(H)),Oe.gState&&h.setGState(Oe.gState),Y(O.matrix.toString()+" cm"),Y("/"+_e+" sh"),Y("Q");else if(Oe instanceof _p){var ve=new Mt(1,0,0,-1,0,Qe());O.matrix&&(ve=ve.multiply(O.matrix||Ar),_e=Hr.call(Oe,O.key,O.boundingBox,O.xStep,O.yStep,ve).id),Y("q"),Y("/Pattern cs"),Y("/"+_e+" scn"),Oe.gState&&h.setGState(Oe.gState),Y(H),Y("Q")}},jn=function(O){switch(O){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},vn=h.moveTo=function(O,H){return Y(E(I(O))+" "+E(D(H))+" m"),this},Zn=h.lineTo=function(O,H){return Y(E(I(O))+" "+E(D(H))+" l"),this},Mn=h.curveTo=function(O,H,_e,Oe,ve,Xe){return Y([E(I(O)),E(D(H)),E(I(_e)),E(D(Oe)),E(I(ve)),E(D(Xe)),"c"].join(" ")),this};h.__private__.line=h.line=function(O,H,_e,Oe,ve){if(isNaN(O)||isNaN(H)||isNaN(_e)||isNaN(Oe)||!br(ve))throw new Error("Invalid arguments passed to jsPDF.line");return j===b?this.lines([[_e-O,Oe-H]],O,H,[1,1],ve||"S"):this.lines([[_e-O,Oe-H]],O,H,[1,1]).stroke()},h.__private__.lines=h.lines=function(O,H,_e,Oe,ve,Xe){var et,zt,nr,Et,Gt,Nr,tr,ar,sr,xr,St,Lr;if(typeof O=="number"&&(Lr=_e,_e=H,H=O,O=Lr),Oe=Oe||[1,1],Xe=Xe||!1,isNaN(H)||isNaN(_e)||!Array.isArray(O)||!Array.isArray(Oe)||!br(ve)||typeof Xe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(vn(H,_e),et=Oe[0],zt=Oe[1],Et=O.length,xr=H,St=_e,nr=0;nr<Et;nr++)(Gt=O[nr]).length===2?(xr=Gt[0]*et+xr,St=Gt[1]*zt+St,Zn(xr,St)):(Nr=Gt[0]*et+xr,tr=Gt[1]*zt+St,ar=Gt[2]*et+xr,sr=Gt[3]*zt+St,xr=Gt[4]*et+xr,St=Gt[5]*zt+St,Mn(Nr,tr,ar,sr,xr,St));return Xe&&or(),tt(ve),this},h.path=function(O){for(var H=0;H<O.length;H++){var _e=O[H],Oe=_e.c;switch(_e.op){case"m":vn(Oe[0],Oe[1]);break;case"l":Zn(Oe[0],Oe[1]);break;case"c":Mn.apply(this,Oe);break;case"h":or()}}return this},h.__private__.rect=h.rect=function(O,H,_e,Oe,ve){if(isNaN(O)||isNaN(H)||isNaN(_e)||isNaN(Oe)||!br(ve))throw new Error("Invalid arguments passed to jsPDF.rect");return j===b&&(Oe=-Oe),Y([E(I(O)),E(D(H)),E(I(_e)),E(I(Oe)),"re"].join(" ")),tt(ve),this},h.__private__.triangle=h.triangle=function(O,H,_e,Oe,ve,Xe,et){if(isNaN(O)||isNaN(H)||isNaN(_e)||isNaN(Oe)||isNaN(ve)||isNaN(Xe)||!br(et))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[_e-O,Oe-H],[ve-_e,Xe-Oe],[O-ve,H-Xe]],O,H,[1,1],et,!0),this},h.__private__.roundedRect=h.roundedRect=function(O,H,_e,Oe,ve,Xe,et){if(isNaN(O)||isNaN(H)||isNaN(_e)||isNaN(Oe)||isNaN(ve)||isNaN(Xe)||!br(et))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var zt=4/3*(Math.SQRT2-1);return ve=Math.min(ve,.5*_e),Xe=Math.min(Xe,.5*Oe),this.lines([[_e-2*ve,0],[ve*zt,0,ve,Xe-Xe*zt,ve,Xe],[0,Oe-2*Xe],[0,Xe*zt,-ve*zt,Xe,-ve,Xe],[2*ve-_e,0],[-ve*zt,0,-ve,-Xe*zt,-ve,-Xe],[0,2*Xe-Oe],[0,-Xe*zt,ve*zt,-Xe,ve,-Xe]],O+ve,H,[1,1],et,!0),this},h.__private__.ellipse=h.ellipse=function(O,H,_e,Oe,ve){if(isNaN(O)||isNaN(H)||isNaN(_e)||isNaN(Oe)||!br(ve))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Xe=4/3*(Math.SQRT2-1)*_e,et=4/3*(Math.SQRT2-1)*Oe;return vn(O+_e,H),Mn(O+_e,H-et,O+Xe,H-Oe,O,H-Oe),Mn(O-Xe,H-Oe,O-_e,H-et,O-_e,H),Mn(O-_e,H+et,O-Xe,H+Oe,O,H+Oe),Mn(O+Xe,H+Oe,O+_e,H+et,O+_e,H),tt(ve),this},h.__private__.circle=h.circle=function(O,H,_e,Oe){if(isNaN(O)||isNaN(H)||isNaN(_e)||!br(Oe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(O,H,_e,_e,Oe)},h.setFont=function(O,H,_e){return _e&&(H=k(H,_e)),te=it(O,H,{disableWarning:!1}),this};var oa=h.__private__.getFont=h.getFont=function(){return kt[it.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var O,H,_e={};for(O in cr)if(cr.hasOwnProperty(O))for(H in _e[O]=[],cr[O])cr[O].hasOwnProperty(H)&&_e[O].push(H);return _e},h.addFont=function(O,H,_e,Oe,ve){var Xe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Xe.indexOf(arguments[3])!==-1?ve=arguments[3]:arguments[3]&&Xe.indexOf(arguments[3])==-1&&(_e=k(_e,Oe)),jr.call(this,O,H,_e,ve=ve||"Identity-H")};var Dn,va=e.lineWidth||.200025,on=h.__private__.getLineWidth=h.getLineWidth=function(){return va},Ea=h.__private__.setLineWidth=h.setLineWidth=function(O){return va=O,Y(E(I(O))+" w"),this};h.__private__.setLineDash=Nn.API.setLineDash=Nn.API.setLineDashPattern=function(O,H){if(O=O||[],H=H||0,isNaN(H)||!Array.isArray(O))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return O=O.map(function(_e){return E(I(_e))}).join(" "),H=E(I(H)),Y("["+O+"] "+H+" d"),this};var Ca=h.__private__.getLineHeight=h.getLineHeight=function(){return at*Dn};h.__private__.getLineHeight=h.getLineHeight=function(){return at*Dn};var ya=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(O){return typeof(O=O||1.15)=="number"&&(Dn=O),this},Mo=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Dn};ya(e.lineHeight);var vi=h.__private__.getHorizontalCoordinate=function(O){return I(O)},oo=h.__private__.getVerticalCoordinate=function(O){return j===w?O:Ee[L].mediaBox.topRightY-Ee[L].mediaBox.bottomLeftY-I(O)},zl=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(O){return E(vi(O))},yl=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(O){return E(oo(O))},cs=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Ur(cs)},h.__private__.setStrokeColor=h.setDrawColor=function(O,H,_e,Oe){return cs=Zr({ch1:O,ch2:H,ch3:_e,ch4:Oe,pdfColorType:"draw",precision:2}),Y(cs),this};var Ku=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Ur(Ku)},h.__private__.setFillColor=h.setFillColor=function(O,H,_e,Oe){return Ku=Zr({ch1:O,ch2:H,ch3:_e,ch4:Oe,pdfColorType:"fill",precision:2}),Y(Ku),this};var kc=e.textColor||"0 g",de=h.__private__.getTextColor=h.getTextColor=function(){return Ur(kc)};h.__private__.setTextColor=h.setTextColor=function(O,H,_e,Oe){return kc=Zr({ch1:O,ch2:H,ch3:_e,ch4:Oe,pdfColorType:"text",precision:3}),this};var Le=e.charSpace,jt=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Le||0)};h.__private__.setCharSpace=h.setCharSpace=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Le=O,this};var Rt=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(O){var H=h.CapJoinStyles[O];if(H===void 0)throw new Error("Line cap style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Rt=H,Y(H+" J"),this};var Ot=0;h.__private__.setLineJoin=h.setLineJoin=function(O){var H=h.CapJoinStyles[O];if(H===void 0)throw new Error("Line join style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ot=H,Y(H+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(O){if(O=O||0,isNaN(O))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Y(E(I(O))+" M"),this},h.GState=k1,h.setGState=function(O){(O=typeof O=="string"?Je[mt[O]]:dr(null,O)).equals(Be)||(Y("/"+O.id+" gs"),Be=O)};var dr=function(O,H){if(!O||!mt[O]){var _e=!1;for(var Oe in Je)if(Je.hasOwnProperty(Oe)&&Je[Oe].equals(H)){_e=!0;break}if(_e)H=Je[Oe];else{var ve="GS"+(Object.keys(Je).length+1).toString(10);Je[ve]=H,H.id=ve}return O&&(mt[O]=H.id),Ct.publish("addGState",H),H}};h.addGState=function(O,H){return dr(O,H),this},h.saveGraphicsState=function(){return Y("q"),Cr.push({key:te,size:at,color:kc}),this},h.restoreGraphicsState=function(){Y("Q");var O=Cr.pop();return te=O.key,at=O.size,kc=O.color,Be=null,this},h.setCurrentTransformationMatrix=function(O){return Y(O.toString()+" cm"),this},h.comment=function(O){return Y("#"+O),this};var er=function(O,H){var _e=O||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return _e},set:function(Xe){isNaN(Xe)||(_e=parseFloat(Xe))}});var Oe=H||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Oe},set:function(Xe){isNaN(Xe)||(Oe=parseFloat(Xe))}});var ve="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ve},set:function(Xe){ve=Xe.toString()}}),this},_r=function(O,H,_e,Oe){er.call(this,O,H),this.type="rect";var ve=_e||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ve},set:function(et){isNaN(et)||(ve=parseFloat(et))}});var Xe=Oe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Xe},set:function(et){isNaN(et)||(Xe=parseFloat(et))}}),this},ne=function(){this.page=$t,this.currentPage=L,this.pages=je.slice(0),this.pagesContext=Ee.slice(0),this.x=Pe,this.y=It,this.matrix=Dt,this.width=ze(L),this.height=rt(L),this.outputDestination=Ue,this.id="",this.objectNumber=-1};ne.prototype.restore=function(){$t=this.page,L=this.currentPage,Ee=this.pagesContext,je=this.pages,Pe=this.x,It=this.y,Dt=this.matrix,Ke(L,this.width),oe(L,this.height),Ue=this.outputDestination};var ie=function(O,H,_e,Oe,ve){Or.push(new ne),$t=L=0,je=[],Pe=O,It=H,Dt=ve,Kt([_e,Oe])};for(var Ye in h.beginFormObject=function(O,H,_e,Oe,ve){return ie(O,H,_e,Oe,ve),this},h.endFormObject=function(O){return function(H){if(qr[H])Or.pop().restore();else{var _e=new ne,Oe="Xo"+(Object.keys(Mr).length+1).toString(10);_e.id=Oe,qr[H]=Oe,Mr[Oe]=_e,Ct.publish("addFormObject",_e),Or.pop().restore()}}(O),this},h.doFormObject=function(O,H){var _e=Mr[qr[O]];return Y("q"),Y(H.toString()+" cm"),Y("/"+_e.id+" Do"),Y("Q"),this},h.getFormObject=function(O){var H=Mr[qr[O]];return{x:H.x,y:H.y,width:H.width,height:H.height,matrix:H.matrix}},h.save=function(O,H){return O=O||"generated.pdf",(H=H||{}).returnPromise=H.returnPromise||!1,H.returnPromise===!1?(rp(Ce(W()),O),typeof rp.unload=="function"&&Yn.setTimeout&&setTimeout(rp.unload,911),this):new Promise(function(_e,Oe){try{var ve=rp(Ce(W()),O);typeof rp.unload=="function"&&Yn.setTimeout&&setTimeout(rp.unload,911),_e(ve)}catch(Xe){Oe(Xe.message)}})},Nn.API)Nn.API.hasOwnProperty(Ye)&&(Ye==="events"&&Nn.API.events.length?function(O,H){var _e,Oe,ve;for(ve=H.length-1;ve!==-1;ve--)_e=H[ve][0],Oe=H[ve][1],O.subscribe.apply(O,[_e].concat(typeof Oe=="function"?[Oe]:Oe))}(Ct,Nn.API.events):h[Ye]=Nn.API[Ye]);function ze(O){return Ee[O].mediaBox.topRightX-Ee[O].mediaBox.bottomLeftX}function Ke(O,H){Ee[O].mediaBox.topRightX=H+Ee[O].mediaBox.bottomLeftX}function rt(O){return Ee[O].mediaBox.topRightY-Ee[O].mediaBox.bottomLeftY}function oe(O,H){Ee[O].mediaBox.topRightY=H+Ee[O].mediaBox.bottomLeftY}var st=h.getPageWidth=function(O){return ze(O=O||L)/$e},Ve=h.setPageWidth=function(O,H){Ke(O,H*$e)},Qe=h.getPageHeight=function(O){return rt(O=O||L)/$e},qt=h.setPageHeight=function(O,H){oe(O,H*$e)};return h.internal={pdfEscape:ot,getStyle:wr,getFont:oa,getFontSize:vt,getCharSpace:jt,getTextColor:de,getLineHeight:Ca,getLineHeightFactor:Mo,getLineWidth:on,write:lt,getHorizontalCoordinate:vi,getVerticalCoordinate:oo,getCoordinateString:zl,getVerticalCoordinateString:yl,collections:{},newObject:Tr,newAdditionalObject:pt,newObjectDeferred:dn,newObjectDeferredBegin:Ae,getFilters:cn,putStream:Tn,events:Ct,scaleFactor:$e,pageSize:{getWidth:function(){return st(L)},setWidth:function(O){Ve(L,O)},getHeight:function(){return Qe(L)},setHeight:function(O){qt(L,O)}},encryptionOptions:u,encryption:He,getEncryptor:function(O){return u!==null?He.encryptor(O,0):function(H){return H}},output:De,getNumberOfPages:qe,pages:je,out:Y,f2:C,f3:T,getPageInfo:dt,getPageInfoByObjId:rr,getCurrentPageInfo:Gr,getPDFVersion:g,Point:er,Rectangle:_r,Matrix:Mt,hasHotfix:bt},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return st(L)},set:function(O){Ve(L,O)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Qe(L)},set:function(O){qt(L,O)},enumerable:!0,configurable:!0}),function(O){for(var H=0,_e=Te.length;H<_e;H++){var Oe=jr.call(this,O[H][0],O[H][1],O[H][2],Te[H][3],!0);f===!1&&(m[Oe]=!0);var ve=O[H][0].split("-");Ft({id:Oe,fontName:ve[0],fontStyle:ve[1]||""})}Ct.publish("addFonts",{fonts:kt,dictionary:cr})}.call(h,Te),te="F1",vr(a,r),Ct.publish("initialized"),h}av.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},av.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},av.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},av.prototype.processOwnerPassword=function(e,t){return v4(g4(t).substr(0,5),e)},av.prototype.encryptor=function(e,t){var r=g4(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return v4(r,n)}},k1.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Aa(e)!==Aa(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Nn.API={events:[]},Nn.version="3.0.3";var Qo=Nn.API,DM=1,_g=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Gg=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ra=function(e){return e.toFixed(2)},lm=function(e){return e.toFixed(5)};Qo.__acroform__={};var ql=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},e9=function(e){return e*DM},gu=function(e){var t=new Sne,r=pn.internal.getHeight(e)||0,n=pn.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ra(n)),Number(ra(r))],t},JJe=Qo.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},QJe=Qo.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},ZJe=Qo.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},ui=Qo.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return ZJe(e,t-1)},fi=Qo.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return JJe(e,t-1)},mi=Qo.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return QJe(e,t-1)},eQe=Qo.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],l=e[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(a+s)||0,c.upperRight_Y=n(i)||0,[Number(ra(c.lowerLeft_X)),Number(ra(c.lowerLeft_Y)),Number(ra(c.upperRight_X)),Number(ra(c.upperRight_Y))]},tQe=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=x4(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+ra(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=gu(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},x4=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(C){return C.split(`
`)}):a.map(function(C){return[C]});var i=r,s=pn.internal.getHeight(e)||0;s=s<0?-s:s;var l=pn.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(C,T,I){if(C+1<a.length){var D=T+" "+a[C+1][0];return H2(D,e,I).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var d,u,f=H2("3",e,i).height,m=e.multiline?s-i:(s-f)/2,h=m+=2,v=0,g=0,x=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+H2(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var y="",b=0,w=0;w<a.length;w++)if(a.hasOwnProperty(w)){var j=!1;if(a[w].length!==1&&x!==a[w].length-1){if((f+2)*(b+2)+2>s)continue e;y+=a[w][x],j=!0,g=w,w--}else{y=(y+=a[w][x]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var _=parseInt(w),S=c(_,y,i),k=w>=a.length-1;if(S&&!k){y+=" ",x=0;continue}if(S||k){if(k)g=_;else if(e.multiline&&(f+2)*(b+2)+2>s)continue e}else{if(!e.multiline||(f+2)*(b+2)+2>s)continue e;g=_}}for(var E="",A=v;A<=g;A++){var M=a[A];if(e.multiline){if(A===g){E+=M[x]+" ",x=(x+1)%M.length;continue}if(A===v){E+=M[M.length-1]+" ";continue}}E+=M[0]+" "}switch(E=E.substr(E.length-1)==" "?E.substr(0,E.length-1):E,u=H2(E,e,i).width,e.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}t+=ra(d)+" "+ra(h)+` Td
`,t+="("+_g(E)+`) Tj
`,t+=-ra(d)+` 0 Td
`,h=-(i+2),u=0,v=j?g:g+1,b++,y=""}break}return n.text=t,n.fontSize=i,n},H2=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},rQe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},nQe=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},aQe=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(iu.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(rQe)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");DM=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Cne,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&nQe(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var l=n[s],c=[],d=l.Rect;if(l.Rect&&(l.Rect=eQe(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=pn.createDefaultAppearanceStream(l),Aa(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=tQe(l);c.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var f="";for(var m in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(m)){var h=l.appearanceStreamContent[m];if(f+="/"+m+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var s in h)if(h.hasOwnProperty(s)){var v=h[s];typeof v=="function"&&(v=v.call(a,l)),f+="/"+s+" "+v+" ",a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v)}}else typeof(v=h)=="function"&&(v=v.call(a,l)),f+="/"+s+" "+v,a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}i&&function(g,x){for(var y in g)if(g.hasOwnProperty(y)){var b=y,w=g[y];x.internal.newObjectDeferredBegin(w.objId,!0),Aa(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[b]}}(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},_ne=Qo.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),Aa(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+_g(n(e[i].toString()))+")"):a+=e[i].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},oE=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+_g(n(e))+")"},Eu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Eu.prototype.toString=function(){return this.objId+" 0 R"},Eu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Eu.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:_ne(a,this.objId,this.scope)}):a instanceof Eu?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var Sne=function(){Eu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ql(Sne,Eu);var Cne=function(){Eu.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+_g(r(e))+")"}},set:function(r){e=r}})};ql(Cne,Eu);var iu=function e(){Eu.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ui(t,3)},set:function(y){y?this.F=fi(t,3):this.F=mi(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof K_)return;i="FieldObject"+e.FieldNum++}var y=function(b){return b};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+_g(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(y){s=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/DM:d},set:function(y){d=y}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(y){u=y}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof K_||this instanceof ah))return oE(f,this.objId,this.scope)},set:function(y){y=y.toString(),f=y}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof zi==0?oE(m,this.objId,this.scope):m},set:function(y){y=y.toString(),m=this instanceof zi==0?y.substr(0,1)==="("?Gg(y.substr(1,y.length-2)):Gg(y):y}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof zi==1?Gg(m.substr(1,m.length-1)):m},set:function(y){y=y.toString(),m=this instanceof zi==1?"/"+y:y}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof zi==0?oE(h,this.objId,this.scope):h},set:function(y){y=y.toString(),h=this instanceof zi==0?y.substr(0,1)==="("?Gg(y.substr(1,y.length-2)):Gg(y):y}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof zi==1?Gg(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof zi==1?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(y){y=!!y,g=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(y){v=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,1)},set:function(y){y?this.Ff=fi(this.Ff,1):this.Ff=mi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,2)},set:function(y){y?this.Ff=fi(this.Ff,2):this.Ff=mi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,3)},set:function(y){y?this.Ff=fi(this.Ff,3):this.Ff=mi(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');x=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(x){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};ql(iu,Eu);var Dp=function(){iu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return _ne(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,s,l){l||(l=1);for(var c,d=[];c=s.exec(i);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,18)},set:function(r){r?this.Ff=fi(this.Ff,18):this.Ff=mi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=fi(this.Ff,19):this.Ff=mi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,20)},set:function(r){r?(this.Ff=fi(this.Ff,20),t.sort()):this.Ff=mi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,22)},set:function(r){r?this.Ff=fi(this.Ff,22):this.Ff=mi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,23)},set:function(r){r?this.Ff=fi(this.Ff,23):this.Ff=mi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,27)},set:function(r){r?this.Ff=fi(this.Ff,27):this.Ff=mi(this.Ff,27)}}),this.hasAppearanceStream=!1};ql(Dp,iu);var Mp=function(){Dp.call(this),this.fontName="helvetica",this.combo=!1};ql(Mp,Dp);var Rp=function(){Mp.call(this),this.combo=!0};ql(Rp,Mp);var eb=function(){Rp.call(this),this.edit=!0};ql(eb,Rp);var zi=function(){iu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,15)},set:function(r){r?this.Ff=fi(this.Ff,15):this.Ff=mi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,16)},set:function(r){r?this.Ff=fi(this.Ff,16):this.Ff=mi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,17)},set:function(r){r?this.Ff=fi(this.Ff,17):this.Ff=mi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,26)},set:function(r){r?this.Ff=fi(this.Ff,26):this.Ff=mi(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+_g(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){Aa(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};ql(zi,iu);var tb=function(){zi.call(this),this.pushButton=!0};ql(tb,zi);var Lp=function(){zi.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ql(Lp,zi);var K_=function(){var e,t;iu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+_g(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){Aa(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=pn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ql(K_,iu),Lp.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Lp.prototype.createOption=function(e){var t=new K_;return t.Parent=this,t.optionName=e,this.Kids.push(t),oQe.call(this.scope,t),t};var rb=function(){zi.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=pn.CheckBox.createAppearanceStream()};ql(rb,zi);var ah=function(){iu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,13)},set:function(t){t?this.Ff=fi(this.Ff,13):this.Ff=mi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,21)},set:function(t){t?this.Ff=fi(this.Ff,21):this.Ff=mi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,23)},set:function(t){t?this.Ff=fi(this.Ff,23):this.Ff=mi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,24)},set:function(t){t?this.Ff=fi(this.Ff,24):this.Ff=mi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,25)},set:function(t){t?this.Ff=fi(this.Ff,25):this.Ff=mi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,26)},set:function(t){t?this.Ff=fi(this.Ff,26):this.Ff=mi(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ql(ah,iu);var nb=function(){ah.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ui(this.Ff,14)},set:function(e){e?this.Ff=fi(this.Ff,14):this.Ff=mi(this.Ff,14)}}),this.password=!0};ql(nb,ah);var pn={CheckBox:{createAppearanceStream:function(){return{N:{On:pn.CheckBox.YesNormal},D:{On:pn.CheckBox.YesPushDown,Off:pn.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=gu(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=x4(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+ra(pn.internal.getWidth(e))+" "+ra(pn.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+ra(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=gu(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=pn.internal.getHeight(e),s=pn.internal.getWidth(e),l=x4(e,e.caption);return a.push("1 g"),a.push("0 0 "+ra(s)+" "+ra(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+ra(s-1)+" "+ra(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+ra(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=gu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ra(pn.internal.getWidth(e))+" "+ra(pn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:pn.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=pn.RadioButton.Circle.YesNormal,t.D[e]=pn.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=gu(e);t.scope=e.scope;var r=[],n=pn.internal.getWidth(e)<=pn.internal.getHeight(e)?pn.internal.getWidth(e)/4:pn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=pn.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+lm(pn.internal.getWidth(e)/2)+" "+lm(pn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=gu(e);t.scope=e.scope;var r=[],n=pn.internal.getWidth(e)<=pn.internal.getHeight(e)?pn.internal.getWidth(e)/4:pn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*pn.internal.Bezier_C).toFixed(5)),s=Number((n*pn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+lm(pn.internal.getWidth(e)/2)+" "+lm(pn.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+lm(pn.internal.getWidth(e)/2)+" "+lm(pn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=gu(e);t.scope=e.scope;var r=[],n=pn.internal.getWidth(e)<=pn.internal.getHeight(e)?pn.internal.getWidth(e)/4:pn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*pn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+lm(pn.internal.getWidth(e)/2)+" "+lm(pn.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:pn.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=pn.RadioButton.Cross.YesNormal,t.D[e]=pn.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=gu(e);t.scope=e.scope;var r=[],n=pn.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+ra(pn.internal.getWidth(e)-2)+" "+ra(pn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ra(n.x1.x)+" "+ra(n.x1.y)+" m"),r.push(ra(n.x2.x)+" "+ra(n.x2.y)+" l"),r.push(ra(n.x4.x)+" "+ra(n.x4.y)+" m"),r.push(ra(n.x3.x)+" "+ra(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=gu(e);t.scope=e.scope;var r=pn.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+ra(pn.internal.getWidth(e))+" "+ra(pn.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ra(pn.internal.getWidth(e)-2)+" "+ra(pn.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(ra(r.x1.x)+" "+ra(r.x1.y)+" m"),n.push(ra(r.x2.x)+" "+ra(r.x2.y)+" l"),n.push(ra(r.x4.x)+" "+ra(r.x4.y)+" m"),n.push(ra(r.x3.x)+" "+ra(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=gu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ra(pn.internal.getWidth(e))+" "+ra(pn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};pn.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=pn.internal.getWidth(e),r=pn.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},pn.internal.getWidth=function(e){var t=0;return Aa(e)==="object"&&(t=e9(e.Rect[2])),t},pn.internal.getHeight=function(e){var t=0;return Aa(e)==="object"&&(t=e9(e.Rect[3])),t};var oQe=Qo.addField=function(e){if(aQe(this,e),!(e instanceof iu))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Qo.AcroFormChoiceField=Dp,Qo.AcroFormListBox=Mp,Qo.AcroFormComboBox=Rp,Qo.AcroFormEditBox=eb,Qo.AcroFormButton=zi,Qo.AcroFormPushButton=tb,Qo.AcroFormRadioButton=Lp,Qo.AcroFormCheckBox=rb,Qo.AcroFormTextField=ah,Qo.AcroFormPasswordField=nb,Qo.AcroFormAppearance=pn,Qo.AcroForm={ChoiceField:Dp,ListBox:Mp,ComboBox:Rp,EditBox:eb,Button:zi,PushButton:tb,RadioButton:Lp,CheckBox:rb,TextField:ah,PasswordField:nb,Appearance:pn},Nn.AcroForm={ChoiceField:Dp,ListBox:Mp,ComboBox:Rp,EditBox:eb,Button:zi,PushButton:tb,RadioButton:Lp,CheckBox:rb,TextField:ah,PasswordField:nb,Appearance:pn};var iQe=Nn.AcroForm;function Pne(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(C,T){var I,D,F,z,q,$=r;if((T=T||r)==="RGBA"||C.data!==void 0&&C.data instanceof Uint8ClampedArray&&"height"in C&&"width"in C)return"RGBA";if(S(C))for(q in n)for(F=n[q],I=0;I<F.length;I+=1){for(z=!0,D=0;D<F[I].length;D+=1)if(F[I][D]!==void 0&&F[I][D]!==C[D]){z=!1;break}if(z===!0){$=q;break}}else for(q in n)for(F=n[q],I=0;I<F.length;I+=1){for(z=!0,D=0;D<F[I].length;D+=1)if(F[I][D]!==void 0&&F[I][D]!==C.charCodeAt(D)){z=!1;break}if(z===!0){$=q;break}}return $===r&&T!==r&&($=T),$},i=function C(T){for(var I=this.internal.write,D=this.internal.putStream,F=(0,this.internal.getFilters)();F.indexOf("FlateEncode")!==-1;)F.splice(F.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var z=[];if(z.push({key:"Type",value:"/XObject"}),z.push({key:"Subtype",value:"/Image"}),z.push({key:"Width",value:T.width}),z.push({key:"Height",value:T.height}),T.colorSpace===y.INDEXED?z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(z.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===y.DEVICE_CMYK&&z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),z.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&z.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var q="",$=0,K=T.transparency.length;$<K;$++)q+=T.transparency[$]+" "+T.transparency[$]+" ";z.push({key:"Mask",value:"["+q+"]"})}T.sMask!==void 0&&z.push({key:"SMask",value:T.objectId+1+" 0 R"});var ce=T.filter!==void 0?["/"+T.filter]:void 0;if(D({data:T.data,additionalKeyValues:z,alreadyAppliedFilters:ce,objectId:T.objectId}),I("endobj"),"sMask"in T&&T.sMask!==void 0){var fe,B=(fe=T.sMaskBitsPerComponent)!==null&&fe!==void 0?fe:T.bitsPerComponent,L={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:B,data:T.sMask};"filter"in T&&(L.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(B," /Columns ").concat(T.width),L.filter=T.filter),C.call(this,L)}if(T.colorSpace===y.INDEXED){var V=this.internal.newObject();D({data:E(new Uint8Array(T.palette)),objectId:V}),I("endobj")}},s=function(){var C=this.internal.collections[t+"images"];for(var T in C)i.call(this,C[T])},l=function(){var C,T=this.internal.collections[t+"images"],I=this.internal.write;for(var D in T)I("/I"+(C=T[D]).index,C.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var C=this.internal.collections[t+"images"];return c.call(this),C},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(C){return typeof e["process"+C.toUpperCase()]=="function"},m=function(C){return Aa(C)==="object"&&C.nodeType===1},h=function(C,T){if(C.nodeName==="IMG"&&C.hasAttribute("src")){var I=""+C.getAttribute("src");if(I.indexOf("data:image/")===0)return Ij(unescape(I).split("base64,").pop());var D=e.loadFile(I,!0);if(D!==void 0)return D}if(C.nodeName==="CANVAS"){if(C.width===0||C.height===0)throw new Error("Given canvas must have data. Canvas width: "+C.width+", height: "+C.height);var F;switch(T){case"PNG":F="image/png";break;case"WEBP":F="image/webp";break;default:F="image/jpeg"}return Ij(C.toDataURL(F,1).split("base64,").pop())}},v=function(C){var T=this.internal.collections[t+"images"];if(T){for(var I in T)if(C===T[I].alias)return T[I]}},g=function(C,T,I){return C||T||(C=-96,T=-96),C<0&&(C=-1*I.width*72/C/this.internal.scaleFactor),T<0&&(T=-1*I.height*72/T/this.internal.scaleFactor),C===0&&(C=T*I.width/I.height),T===0&&(T=C*I.height/I.width),[C,T]},x=function(C,T,I,D,F,z){var q=g.call(this,I,D,F),$=this.internal.getCoordinateString,K=this.internal.getVerticalCoordinateString,ce=d.call(this);if(I=q[0],D=q[1],ce[F.index]=F,z){z*=Math.PI/180;var fe=Math.cos(z),B=Math.sin(z),L=function(re){return re.toFixed(4)},V=[L(fe),L(B),L(-1*B),L(fe),0,0,"cm"]}this.internal.write("q"),z?(this.internal.write([1,"0","0",1,$(C),K(T+D),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([$(I),"0","0",$(D),"0","0","cm"].join(" "))):this.internal.write([$(I),"0","0",$(D),$(C),K(T+D),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+F.index+" Do"),this.internal.write("Q")},y=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(C){var T,I,D=0;if(typeof C=="string")for(I=C.length,T=0;T<I;T++)D=(D<<5)-D+C.charCodeAt(T),D|=0;else if(S(C))for(I=C.byteLength/2,T=0;T<I;T++)D=(D<<5)-D+C[T],D|=0;return D},j=e.__addimage__.validateStringAsBase64=function(C){(C=C||"").toString().trim();var T=!0;return C.length===0&&(T=!1),C.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(C.substr(0,C.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(C.substr(-2))===!1&&(T=!1),T},_=e.__addimage__.extractImageFromDataUrl=function(C){if(C==null||!(C=C.trim()).startsWith("data:"))return null;var T=C.indexOf(",");return T<0?null:C.substring(0,T).trim().endsWith("base64")?C.substring(T+1):null};e.__addimage__.isArrayBuffer=function(C){return C instanceof ArrayBuffer};var S=e.__addimage__.isArrayBufferView=function(C){return C instanceof Int8Array||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array},k=e.__addimage__.binaryStringToUint8Array=function(C){for(var T=C.length,I=new Uint8Array(T),D=0;D<T;D++)I[D]=C.charCodeAt(D);return I},E=e.__addimage__.arrayBufferToBinaryString=function(C){for(var T="",I=S(C)?C:new Uint8Array(C),D=0;D<I.length;D+=8192)T+=String.fromCharCode.apply(null,I.subarray(D,D+8192));return T};e.addImage=function(){var C,T,I,D,F,z,q,$,K;if(typeof arguments[1]=="number"?(T=r,I=arguments[1],D=arguments[2],F=arguments[3],z=arguments[4],q=arguments[5],$=arguments[6],K=arguments[7]):(T=arguments[1],I=arguments[2],D=arguments[3],F=arguments[4],z=arguments[5],q=arguments[6],$=arguments[7],K=arguments[8]),Aa(C=arguments[0])==="object"&&!m(C)&&"imageData"in C){var ce=C;C=ce.imageData,T=ce.format||T||r,I=ce.x||I||0,D=ce.y||D||0,F=ce.w||ce.width||F,z=ce.h||ce.height||z,q=ce.alias||q,$=ce.compression||$,K=ce.rotation||ce.angle||K}var fe=this.internal.getFilters();if($===void 0&&fe.indexOf("FlateEncode")!==-1&&($="SLOW"),isNaN(I)||isNaN(D))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var B=A.call(this,C,T,q,$);return x.call(this,I,D,F,z,B,K),this};var A=function(C,T,I,D){var F,z,q;if(typeof C=="string"&&a(C)===r){C=unescape(C);var $=M(C,!1);($!==""||($=e.loadFile(C,!0))!==void 0)&&(C=$)}if(m(C)&&(C=h(C,T)),T=a(C,T),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((q=I)==null||q.length===0)&&(I=function(K){return typeof K=="string"||S(K)?w(K):S(K.data)?w(K.data):null}(C)),(F=v.call(this,I))||(C instanceof Uint8Array||T==="RGBA"||(z=C,C=k(C)),F=this["process"+T.toUpperCase()](C,u.call(this),I,function(K){return K&&typeof K=="string"&&(K=K.toUpperCase()),K in e.image_compression?K:b.NONE}(D),z)),!F)throw new Error("An unknown error occurred whilst processing the image.");return F},M=e.__addimage__.convertBase64ToBinaryString=function(C,T){T=typeof T!="boolean"||T;var I,D="";if(typeof C=="string"){var F;I=(F=_(C))!==null&&F!==void 0?F:C;try{D=Ij(I)}catch(z){if(T)throw j(I)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return D};e.getImageProperties=function(C){var T,I,D="";if(m(C)&&(C=h(C)),typeof C=="string"&&a(C)===r&&((D=M(C,!1))===""&&(D=e.loadFile(C)||""),C=D),I=a(C),!f(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(C instanceof Uint8Array||(C=k(C)),!(T=this["process"+I.toUpperCase()](C)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=I,T}})(Nn.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Nn.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,f=0;f<d.length&&!u;f++)switch((n=d[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var m=0;m<d.length;m++){n=d[m];var h=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(g.objId),b=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(y(n.contents))+")",i+=" /Popup "+x.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(y(b))+") >>",g.content=i;var w=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(i+=" /Open true"),i+=" >>",x.content=i,this.internal.write(g.objId,"0 R",x.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(v(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var _=this.annotations._nameMap[n.options.name];n.options.pageNumber=_.page,n.options.top=_.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var S=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+S+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+a),h:d(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var u=this.splitTextToSize(r,l).length;s=Math.ceil(d*u)}else l=c,s=d;return this.text(r,n,a,i),a+=.2*d,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,a-d,l,s,i),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Nn.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return s(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var x=0,y=r,b="",w=0;for(x=0;x<g.length;x+=1)y[g.charCodeAt(x)]!==void 0?(w++,typeof(y=y[g.charCodeAt(x)])=="number"&&(b+=String.fromCharCode(y),y=r,w=0),x===g.length-1&&(y=r,b+=g.charAt(x-(w-1)),x-=w-1,w=0)):(y=r,b+=g.charAt(x-w),x-=w,w=0);return b};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var m=e.__arabicParser__.getCorrectForm=function(g,x,y){return s(g)?i(g)===!1?-1:!d(g)||!s(x)&&!s(y)||!s(y)&&l(x)||l(g)&&!s(x)||l(g)&&c(x)||l(g)&&l(x)?0:u(g)&&s(x)&&!l(x)&&s(y)&&d(y)?3:l(g)||!s(y)?1:2:-1},h=function(g){var x=0,y=0,b=0,w="",j="",_="",S=(g=g||"").split("\\s+"),k=[];for(x=0;x<S.length;x+=1){for(k.push(""),y=0;y<S[x].length;y+=1)w=S[x][y],j=S[x][y-1],_=S[x][y+1],s(w)?(b=m(w,j,_),k[x]+=b!==-1?String.fromCharCode(t[w.charCodeAt(0)][b]):w):k[x]+=w;k[x]=f(k[x])}return k.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var g,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(x)){var b=0;for(y=[],b=0;b<x.length;b+=1)Array.isArray(x[b])?y.push([h(x[b][0]),x[b][1],x[b][2]]):y.push([h(x[b])]);g=y}else g=h(x);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",v])}(Nn.API),Nn.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(l){s=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Nn.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(g){v=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),f=d.font||this.getFont(),m=d.scaleFactor||this.internal.scaleFactor,h=0,v=0,g=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=d.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,j){return w.concat(x.splitTextToSize(j,y))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)h<(g=this.getStringUnitWidth(c[b],{font:f})*u)&&(h=g);return h!==0&&(v=c.length),{w:h/=m,h:Math.max((v*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/m,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,d,u,f,m){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,v,g,x,y=[],b=[],w=[],j={},_={},S=[],k=[],E=(m=m||{}).autoSize||!1,A=m.printHeaders!==!1,M=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,C=m.margins||Object.assign({width:this.getPageWidth()},t),T=typeof m.padding=="number"?m.padding:3,I=m.headerBackgroundColor||"#c8c8c8",D=m.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=C,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=I,this.internal.__cell__.headerTextColor=D,this.setFontSize(M),f==null)b=y=Object.keys(u[0]),w=y.map(function(){return"left"});else if(Array.isArray(f)&&Aa(f[0])==="object")for(y=f.map(function(ce){return ce.name}),b=f.map(function(ce){return ce.prompt||ce.name||""}),w=f.map(function(ce){return ce.align||"left"}),h=0;h<f.length;h+=1)_[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(b=y=f,w=y.map(function(){return"left"}));if(E||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<y.length;h+=1){for(j[x=y[h]]=u.map(function(ce){return ce[x]}),this.setFont(void 0,"bold"),S.push(this.getTextDimensions(b[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=j[x],this.setFont(void 0,"normal"),g=0;g<v.length;g+=1)S.push(this.getTextDimensions(v[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);_[x]=Math.max.apply(null,S)+T+T,S=[]}if(A){var F={};for(h=0;h<y.length;h+=1)F[y[h]]={},F[y[h]].text=b[h],F[y[h]].align=w[h];var z=l.call(this,F,_);k=y.map(function(ce){return new i(c,d,_[ce],z,F[ce].text,void 0,F[ce].align)}),this.setTableHeaderRow(k),this.printHeaderRow(1,!1)}var q=f.reduce(function(ce,fe){return ce[fe.name]=fe.align,ce},{});for(h=0;h<u.length;h+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:h,data:u[h]},this);var $=l.call(this,u[h],_);for(g=0;g<y.length;g+=1){var K=u[h][y[g]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:h,col:g,data:K},this),s.call(this,new i(c,d,_[y[g]],$,K,h+2,q[y[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(h){var v=c[h];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,d[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/m+u+u},this).reduce(function(h,v){return Math.max(h,v)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,m.push(u)),u.lineNumber=c;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(v)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),r=!1}}(Nn.API);var Ane={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Ene=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],y4=Pne(Ene),kne=[100,200,300,400,500,600,700,800,900],sQe=Pne(kne);function iE(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return Ane[i=i||"normal"]?i:"normal"}(e.style),n=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),a=function(i){return typeof y4[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function t9(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var lQe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},r9={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function n9(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function a9(e){return e.trimLeft()}function cQe(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function dQe(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var G2,o9,i9,Kg,K2,s9,l9,c9,sE=["times"];function d9(e,t,r,n,a){var i=4,s=f9;switch(a){case Nn.API.image_compression.FAST:i=1,s=u9;break;case Nn.API.image_compression.MEDIUM:i=6,s=m9;break;case Nn.API.image_compression.SLOW:i=9,s=h9}e=function(c,d,u,f){for(var m,h=c.length/d,v=new Uint8Array(c.length+h),g=[uQe,u9,f9,m9,h9],x=0;x<h;x+=1){var y=x*d,b=c.subarray(y,y+d);if(f)v.set(f(b,u,m),y+x);else{for(var w=g.length,j=[],_=0;_<w;_+=1)j[_]=g[_](b,u,m);var S=mQe(j.concat());v.set(j[S],y+x)}m=b}return v}(e,t,Math.ceil(r*n/8),s);var l=i4(e,{level:i});return Nn.API.__addimage__.arrayBufferToBinaryString(l)}function uQe(e){var t=Array.apply([],e);return t.unshift(0),t}function u9(e,t){var r=e.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var i=e[a-t]||0;n[a+1]=e[a]-i+256&255}return n}function f9(e,t,r){var n=e.length,a=[];a[0]=2;for(var i=0;i<n;i+=1){var s=r&&r[i]||0;a[i+1]=e[i]-s+256&255}return a}function m9(e,t,r){var n=e.length,a=[];a[0]=3;for(var i=0;i<n;i+=1){var s=e[i-t]||0,l=r&&r[i]||0;a[i+1]=e[i]+256-(s+l>>>1)&255}return a}function h9(e,t,r){var n=e.length,a=[];a[0]=4;for(var i=0;i<n;i+=1){var s=fQe(e[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);a[i+1]=e[i]-s+256&255}return a}function fQe(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),a=Math.abs(e-r),i=Math.abs(e+t-r-r);return n<=a&&n<=i?e:a<=i?t:r}function mQe(e){var t=e.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function lE(e,t,r){var n=t*r,a=Math.floor(n/8),i=16-(n-8*a+r),s=(1<<r)-1;return One(e,a)>>i&s}function p9(e,t,r,n){var a=r*n,i=Math.floor(a/8),s=16-(a-8*i+n),l=(1<<n)-1,c=(t&l)<<s;(function(d,u,f){if(u+1<d.byteLength)d.setUint16(u,f,!1);else{var m=f>>8&255;d.setUint8(u,m)}})(e,i,One(e,i)&~(l<<s)&65535|c)}function One(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function hQe(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<1+(7&a);e[t++],e[t++];var l=null,c=null;i&&(l=t,c=s,t+=3*s);var d=!0,u=[],f=0,m=null,h=0,v=null;for(this.width=r,this.height=n;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,m=e[t++],1&g||(m=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var x=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,j=e[t++],_=j>>6&1,S=1<<1+(7&j),k=l,E=c,A=!1;j>>7&&(A=!0,k=t,E=S,t+=3*S);var M=t;for(t++;;){var C;if(!((C=e[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}u.push({x,y,width:b,height:w,has_local_palette:A,palette_offset:k,palette_size:E,data_offset:M,data_length:t-M,transparent_index:m,interlaced:!!_,delay:f,disposal:h});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return v},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,I){var D=this.frameInfo(T),F=D.width*D.height,z=new Uint8Array(F);g9(e,D.data_offset,z,F);var q=D.palette_offset,$=D.transparent_index;$===null&&($=256);var K=D.width,ce=r-K,fe=K,B=4*(D.y*r+D.x),L=4*((D.y+D.height)*r+D.x),V=B,re=4*ce;D.interlaced===!0&&(re+=4*r*7);for(var me=8,G=0,Q=z.length;G<Q;++G){var ae=z[G];if(fe===0&&(fe=K,(V+=re)>=L&&(re=4*ce+4*r*(me-1),V=B+(K+ce)*(me<<1),me>>=1)),ae===$)V+=4;else{var J=e[q+3*ae],je=e[q+3*ae+1],be=e[q+3*ae+2];I[V++]=be,I[V++]=je,I[V++]=J,I[V++]=255}--fe}},this.decodeAndBlitFrameRGBA=function(T,I){var D=this.frameInfo(T),F=D.width*D.height,z=new Uint8Array(F);g9(e,D.data_offset,z,F);var q=D.palette_offset,$=D.transparent_index;$===null&&($=256);var K=D.width,ce=r-K,fe=K,B=4*(D.y*r+D.x),L=4*((D.y+D.height)*r+D.x),V=B,re=4*ce;D.interlaced===!0&&(re+=4*r*7);for(var me=8,G=0,Q=z.length;G<Q;++G){var ae=z[G];if(fe===0&&(fe=K,(V+=re)>=L&&(re=4*ce+4*r*(me-1),V=B+(K+ce)*(me<<1),me>>=1)),ae===$)V+=4;else{var J=e[q+3*ae],je=e[q+3*ae+1],be=e[q+3*ae+2];I[V++]=J,I[V++]=je,I[V++]=be,I[V++]=255}--fe}}}function g9(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,l=s+1,c=a+1,d=(1<<c)-1,u=0,f=0,m=0,h=e[t++],v=new Int32Array(4096),g=null;;){for(;u<16&&h!==0;)f|=e[t++]<<u,u+=8,h===1?h=e[t++]:--h;if(u<c)break;var x=f&d;if(f>>=c,u-=c,x!==i){if(x===s)break;for(var y=x<l?x:g,b=0,w=y;w>i;)w=v[w]>>8,++b;var j=w;if(m+b+(y!==x?1:0)>n)return void mo.log("Warning, gif stream longer than expected.");r[m++]=j;var _=m+=b;for(y!==x&&(r[m++]=j),w=y;b--;)w=v[w],r[--_]=255&w,w>>=8;g!==null&&l<4096&&(v[l++]=g<<8|j,l>=d+1&&c<12&&(++c,d=d<<1|1)),g=x}else l=s+1,d=(1<<(c=a+1))-1,g=null}return m!==n&&mo.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function cE(e){var t,r,n,a,i,s=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),f=new Array(65535),m=new Array(65535),h=new Array(64),v=new Array(64),g=[],x=0,y=7,b=new Array(64),w=new Array(64),j=new Array(64),_=new Array(256),S=new Array(2048),k=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],F=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function z(B,L){for(var V=0,re=0,me=new Array,G=1;G<=16;G++){for(var Q=1;Q<=B[G];Q++)me[L[re]]=[],me[L[re]][0]=V,me[L[re]][1]=G,re++,V++;V*=2}return me}function q(B){for(var L=B[0],V=B[1]-1;V>=0;)L&1<<V&&(x|=1<<y),V--,--y<0&&(x==255?($(255),$(0)):$(x),y=7,x=0)}function $(B){g.push(B)}function K(B){$(B>>8&255),$(255&B)}function ce(B,L,V,re,me){for(var G,Q=me[0],ae=me[240],J=function(at,yt){var vt,Sr,se,Ze,ct,Qt,we,ye,te,$e,Pe=0;for(te=0;te<8;++te){vt=at[Pe],Sr=at[Pe+1],se=at[Pe+2],Ze=at[Pe+3],ct=at[Pe+4],Qt=at[Pe+5],we=at[Pe+6];var It=vt+(ye=at[Pe+7]),Dt=vt-ye,kt=Sr+we,cr=Sr-we,Cr=se+Qt,Ie=se-Qt,ke=Ze+ct,Je=Ze-ct,mt=It+ke,Be=It-ke,$t=kt+Cr,Ee=kt-Cr;at[Pe]=mt+$t,at[Pe+4]=mt-$t;var Ct=.707106781*(Ee+Be);at[Pe+2]=Be+Ct,at[Pe+6]=Be-Ct;var hr=.382683433*((mt=Je+Ie)-(Ee=cr+Dt)),Mr=.5411961*mt+hr,qr=1.306562965*Ee+hr,Or=.707106781*($t=Ie+cr),Mt=Dt+Or,Ir=Dt-Or;at[Pe+5]=Ir+Mr,at[Pe+3]=Ir-Mr,at[Pe+1]=Mt+qr,at[Pe+7]=Mt-qr,Pe+=8}for(Pe=0,te=0;te<8;++te){vt=at[Pe],Sr=at[Pe+8],se=at[Pe+16],Ze=at[Pe+24],ct=at[Pe+32],Qt=at[Pe+40],we=at[Pe+48];var Ar=vt+(ye=at[Pe+56]),Zt=vt-ye,Kr=Sr+we,Tr=Sr-we,dn=se+Qt,Ae=se-Qt,pt=Ze+ct,Br=Ze-ct,Pr=Ar+pt,Ur=Ar-pt,Zr=Kr+dn,cn=Kr-dn;at[Pe]=Pr+Zr,at[Pe+32]=Pr-Zr;var Tn=.707106781*(cn+Ur);at[Pe+16]=Ur+Tn,at[Pe+48]=Ur-Tn;var Qn=.382683433*((Pr=Br+Ae)-(cn=Tr+Zt)),Sa=.5411961*Pr+Qn,ht=1.306562965*cn+Qn,Vt=.707106781*(Zr=Ae+Tr),gr=Zt+Vt,Lt=Zt-Vt;at[Pe+40]=Lt+Sa,at[Pe+24]=Lt-Sa,at[Pe+8]=gr+ht,at[Pe+56]=gr-ht,Pe++}for(te=0;te<64;++te)$e=at[te]*yt[te],h[te]=$e>0?$e+.5|0:$e-.5|0;return h}(B,L),je=0;je<64;++je)v[k[je]]=J[je];var be=v[0]-V;V=v[0],be==0?q(re[0]):(q(re[m[G=32767+be]]),q(f[G]));for(var Ue=63;Ue>0&&v[Ue]==0;)Ue--;if(Ue==0)return q(Q),V;for(var Z,Y=1;Y<=Ue;){for(var lt=Y;v[Y]==0&&Y<=Ue;)++Y;var gt=Y-lt;if(gt>=16){Z=gt>>4;for(var Te=1;Te<=Z;++Te)q(ae);gt&=15}G=32767+v[Y],q(me[(gt<<4)+m[G]]),q(f[G]),Y++}return Ue!=63&&q(Q),V}function fe(B){B=Math.min(Math.max(B,1),100),i!=B&&(function(L){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],re=0;re<64;re++){var me=s((V[re]*L+50)/100);me=Math.min(Math.max(me,1),255),l[k[re]]=me}for(var G=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Q=0;Q<64;Q++){var ae=s((G[Q]*L+50)/100);ae=Math.min(Math.max(ae,1),255),c[k[Q]]=ae}for(var J=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],je=0,be=0;be<8;be++)for(var Ue=0;Ue<8;Ue++)d[je]=1/(l[k[je]]*J[be]*J[Ue]*8),u[je]=1/(c[k[je]]*J[be]*J[Ue]*8),je++}(B<50?Math.floor(5e3/B):Math.floor(200-2*B)),i=B)}this.encode=function(B,L){L&&fe(L),g=new Array,x=0,y=7,K(65496),K(65504),K(16),$(74),$(70),$(73),$(70),$(0),$(1),$(1),$(0),K(1),K(1),$(0),$(0),function(){K(65499),K(132),$(0);for(var Sr=0;Sr<64;Sr++)$(l[Sr]);$(1);for(var se=0;se<64;se++)$(c[se])}(),function(Sr,se){K(65472),K(17),$(8),K(se),K(Sr),$(3),$(1),$(17),$(0),$(2),$(17),$(1),$(3),$(17),$(1)}(B.width,B.height),function(){K(65476),K(418),$(0);for(var Sr=0;Sr<16;Sr++)$(E[Sr+1]);for(var se=0;se<=11;se++)$(A[se]);$(16);for(var Ze=0;Ze<16;Ze++)$(M[Ze+1]);for(var ct=0;ct<=161;ct++)$(C[ct]);$(1);for(var Qt=0;Qt<16;Qt++)$(T[Qt+1]);for(var we=0;we<=11;we++)$(I[we]);$(17);for(var ye=0;ye<16;ye++)$(D[ye+1]);for(var te=0;te<=161;te++)$(F[te])}(),K(65498),K(12),$(3),$(1),$(0),$(2),$(17),$(3),$(17),$(0),$(63),$(0);var V=0,re=0,me=0;x=0,y=7,this.encode.displayName="_encode_";for(var G,Q,ae,J,je,be,Ue,Z,Y,lt=B.data,gt=B.width,Te=B.height,at=4*gt,yt=0;yt<Te;){for(G=0;G<at;){for(je=at*yt+G,Ue=-1,Z=0,Y=0;Y<64;Y++)be=je+(Z=Y>>3)*at+(Ue=4*(7&Y)),yt+Z>=Te&&(be-=at*(yt+1+Z-Te)),G+Ue>=at&&(be-=G+Ue-at+4),Q=lt[be++],ae=lt[be++],J=lt[be++],b[Y]=(S[Q]+S[ae+256|0]+S[J+512|0]>>16)-128,w[Y]=(S[Q+768|0]+S[ae+1024|0]+S[J+1280|0]>>16)-128,j[Y]=(S[Q+1280|0]+S[ae+1536|0]+S[J+1792|0]>>16)-128;V=ce(b,d,V,t,n),re=ce(w,u,re,r,a),me=ce(j,u,me,r,a),G+=32}yt+=8}if(y>=0){var vt=[];vt[1]=y+1,vt[0]=(1<<y+1)-1,q(vt)}return K(65497),new Uint8Array(g)},e=e||50,function(){for(var B=String.fromCharCode,L=0;L<256;L++)_[L]=B(L)}(),t=z(E,A),r=z(T,I),n=z(M,C),a=z(D,F),function(){for(var B=1,L=2,V=1;V<=15;V++){for(var re=B;re<L;re++)m[32767+re]=V,f[32767+re]=[],f[32767+re][1]=V,f[32767+re][0]=re;for(var me=-(L-1);me<=-B;me++)m[32767+me]=V,f[32767+me]=[],f[32767+me][1]=V,f[32767+me][0]=L-1+me;B<<=1,L<<=1}}(),function(){for(var B=0;B<256;B++)S[B]=19595*B,S[B+256|0]=38470*B,S[B+512|0]=7471*B+32768,S[B+768|0]=-11059*B,S[B+1024|0]=-21709*B,S[B+1280|0]=32768*B+8421375,S[B+1536|0]=-27439*B,S[B+1792|0]=-5329*B}(),fe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Od(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function v9(e){function t(A){if(!A)throw Error("assert :P")}function r(A,M,C){for(var T=0;4>T;T++)if(A[M+T]!=C.charCodeAt(T))return!0;return!1}function n(A,M,C,T,I){for(var D=0;D<I;D++)A[M+D]=C[T+D]}function a(A,M,C,T){for(var I=0;I<T;I++)A[M+I]=C}function i(A){return new Int32Array(A)}function s(A,M){for(var C=[],T=0;T<A;T++)C.push(new M);return C}function l(A,M){var C=[];return function T(I,D,F){for(var z=F[D],q=0;q<z&&(I.push(F.length>D+1?[]:new M),!(F.length<D+1));q++)T(I[q],D+1,F)}(C,0,A),C}var c=function(){var A=this;function M(N,P){for(var R=1<<P-1>>>0;N&R;)R>>>=1;return R?(N&R-1)+R:N}function C(N,P,R,U,ee){t(!(U%R));do N[P+(U-=R)]=ee;while(0<U)}function T(N,P,R,U,ee){if(t(2328>=ee),512>=ee)var ue=i(512);else if((ue=i(ee))==null)return 0;return function(he,Ne,Se,Me,ft,Ut){var Re,wt,Tt=Ne,ur=1<<Se,Bt=i(16),pr=i(16);for(t(ft!=0),t(Me!=null),t(he!=null),t(0<Se),wt=0;wt<ft;++wt){if(15<Me[wt])return 0;++Bt[Me[wt]]}if(Bt[0]==ft)return 0;for(pr[1]=0,Re=1;15>Re;++Re){if(Bt[Re]>1<<Re)return 0;pr[Re+1]=pr[Re]+Bt[Re]}for(wt=0;wt<ft;++wt)Re=Me[wt],0<Me[wt]&&(Ut[pr[Re]++]=wt);if(pr[15]==1)return(Me=new I).g=0,Me.value=Ut[0],C(he,Tt,1,ur,Me),ur;var yr,zr=-1,kr=ur-1,An=0,hn=1,ma=1,bn=1<<Se;for(wt=0,Re=1,ft=2;Re<=Se;++Re,ft<<=1){if(hn+=ma<<=1,0>(ma-=Bt[Re]))return 0;for(;0<Bt[Re];--Bt[Re])(Me=new I).g=Re,Me.value=Ut[wt++],C(he,Tt+An,ft,bn,Me),An=M(An,Re)}for(Re=Se+1,ft=2;15>=Re;++Re,ft<<=1){if(hn+=ma<<=1,0>(ma-=Bt[Re]))return 0;for(;0<Bt[Re];--Bt[Re]){if(Me=new I,(An&kr)!=zr){for(Tt+=bn,yr=1<<(zr=Re)-Se;15>zr&&!(0>=(yr-=Bt[zr]));)++zr,yr<<=1;ur+=bn=1<<(yr=zr-Se),he[Ne+(zr=An&kr)].g=yr+Se,he[Ne+zr].value=Tt-Ne-zr}Me.g=Re-Se,Me.value=Ut[wt++],C(he,Tt+(An>>Se),ft,bn,Me),An=M(An,Re)}}return hn!=2*pr[15]-1?0:ur}(N,P,R,U,ee,ue)}function I(){this.value=this.g=0}function D(){this.value=this.g=0}function F(){this.G=s(5,I),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(cu,D)}function z(N,P,R,U){t(N!=null),t(P!=null),t(2147483648>U),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=P,N.pa=R,N.Jd=P,N.Yc=R+U,N.Zc=4<=U?R+U-4+1:R,Q(N)}function q(N,P){for(var R=0;0<P--;)R|=J(N,128)<<P;return R}function $(N,P){var R=q(N,P);return ae(N)?-R:R}function K(N,P,R,U){var ee,ue=0;for(t(N!=null),t(P!=null),t(4294967288>U),N.Sb=U,N.Ra=0,N.u=0,N.h=0,4<U&&(U=4),ee=0;ee<U;++ee)ue+=P[R+ee]<<8*ee;N.Ra=ue,N.bb=U,N.oa=P,N.pa=R}function ce(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<xi-8>>>0,++N.bb,N.u-=8;re(N)&&(N.h=1,N.u=0)}function fe(N,P){if(t(0<=P),!N.h&&P<=Hs){var R=V(N)&bl[P];return N.u+=P,ce(N),R}return N.h=1,N.u=0}function B(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function L(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(N){return N.Ra>>>(N.u&xi-1)>>>0}function re(N){return t(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>xi}function me(N,P){N.u=P,N.h=re(N)}function G(N){N.u>=Ko&&(t(N.u>=Ko),ce(N))}function Q(N){t(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(t(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function ae(N){return q(N,1)}function J(N,P){var R=N.Ca;0>N.b&&Q(N);var U=N.b,ee=R*P>>>8,ue=(N.I>>>U>ee)+0;for(ue?(R-=ee,N.I-=ee+1<<U>>>0):R=ee+1,U=R,ee=0;256<=U;)ee+=8,U>>=8;return U=7^ee+du[U],N.b-=U,N.Ca=(R<<U)-1,ue}function je(N,P,R){N[P+0]=R>>24&255,N[P+1]=R>>16&255,N[P+2]=R>>8&255,N[P+3]=255&R}function be(N,P){return N[P+0]|N[P+1]<<8}function Ue(N,P){return be(N,P)|N[P+2]<<16}function Z(N,P){return be(N,P)|be(N,P+2)<<16}function Y(N,P){var R=1<<P;return t(N!=null),t(0<P),N.X=i(R),N.X==null?0:(N.Mb=32-P,N.Xa=P,1)}function lt(N,P){t(N!=null),t(P!=null),t(N.Xa==P.Xa),n(P.X,0,N.X,0,1<<P.Xa)}function gt(){this.X=[],this.Xa=this.Mb=0}function Te(N,P,R,U){t(R!=null),t(U!=null);var ee=R[0],ue=U[0];return ee==0&&(ee=(N*ue+P/2)/P),ue==0&&(ue=(P*ee+N/2)/N),0>=ee||0>=ue?0:(R[0]=ee,U[0]=ue,1)}function at(N,P){return N+(1<<P)-1>>>P}function yt(N,P){return((4278255360&N)+(4278255360&P)>>>0&4278255360)+((16711935&N)+(16711935&P)>>>0&16711935)>>>0}function vt(N,P){A[P]=function(R,U,ee,ue,he,Ne,Se){var Me;for(Me=0;Me<he;++Me){var ft=A[N](Ne[Se+Me-1],ee,ue+Me);Ne[Se+Me]=yt(R[U+Me],ft)}}}function Sr(){this.ud=this.hd=this.jd=0}function se(N,P){return((4278124286&(N^P))>>>1)+(N&P)>>>0}function Ze(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function ct(N,P){return Ze(N+(N-P+.5>>1))}function Qt(N,P,R){return Math.abs(P-R)-Math.abs(N-R)}function we(N,P,R,U,ee,ue,he){for(U=ue[he-1],R=0;R<ee;++R)ue[he+R]=U=yt(N[P+R],U)}function ye(N,P,R,U,ee){var ue;for(ue=0;ue<R;++ue){var he=N[P+ue],Ne=he>>8&255,Se=16711935&(Se=(Se=16711935&he)+((Ne<<16)+Ne));U[ee+ue]=(4278255360&he)+Se>>>0}}function te(N,P){P.jd=255&N,P.hd=N>>8&255,P.ud=N>>16&255}function $e(N,P,R,U,ee,ue){var he;for(he=0;he<U;++he){var Ne=P[R+he],Se=Ne>>>8,Me=Ne,ft=255&(ft=(ft=Ne>>>16)+((N.jd<<24>>24)*(Se<<24>>24)>>>5));Me=255&(Me=(Me+=(N.hd<<24>>24)*(Se<<24>>24)>>>5)+((N.ud<<24>>24)*(ft<<24>>24)>>>5)),ee[ue+he]=(4278255360&Ne)+(ft<<16)+Me}}function Pe(N,P,R,U,ee){A[P]=function(ue,he,Ne,Se,Me,ft,Ut,Re,wt){for(Se=Ut;Se<Re;++Se)for(Ut=0;Ut<wt;++Ut)Me[ft++]=ee(Ne[U(ue[he++])])},A[N]=function(ue,he,Ne,Se,Me,ft,Ut){var Re=8>>ue.b,wt=ue.Ea,Tt=ue.K[0],ur=ue.w;if(8>Re)for(ue=(1<<ue.b)-1,ur=(1<<Re)-1;he<Ne;++he){var Bt,pr=0;for(Bt=0;Bt<wt;++Bt)Bt&ue||(pr=U(Se[Me++])),ft[Ut++]=ee(Tt[pr&ur]),pr>>=Re}else A["VP8LMapColor"+R](Se,Me,Tt,ur,ft,Ut,he,Ne,wt)}}function It(N,P,R,U,ee){for(R=P+R;P<R;){var ue=N[P++];U[ee++]=ue>>16&255,U[ee++]=ue>>8&255,U[ee++]=255&ue}}function Dt(N,P,R,U,ee){for(R=P+R;P<R;){var ue=N[P++];U[ee++]=ue>>16&255,U[ee++]=ue>>8&255,U[ee++]=255&ue,U[ee++]=ue>>24&255}}function kt(N,P,R,U,ee){for(R=P+R;P<R;){var ue=(he=N[P++])>>16&240|he>>12&15,he=240&he|he>>28&15;U[ee++]=ue,U[ee++]=he}}function cr(N,P,R,U,ee){for(R=P+R;P<R;){var ue=(he=N[P++])>>16&248|he>>13&7,he=he>>5&224|he>>3&31;U[ee++]=ue,U[ee++]=he}}function Cr(N,P,R,U,ee){for(R=P+R;P<R;){var ue=N[P++];U[ee++]=255&ue,U[ee++]=ue>>8&255,U[ee++]=ue>>16&255}}function Ie(N,P,R,U,ee,ue){if(ue==0)for(R=P+R;P<R;)je(U,((ue=N[P++])[0]>>24|ue[1]>>8&65280|ue[2]<<8&16711680|ue[3]<<24)>>>0),ee+=32;else n(U,ee,N,P,R)}function ke(N,P){A[P][0]=A[N+"0"],A[P][1]=A[N+"1"],A[P][2]=A[N+"2"],A[P][3]=A[N+"3"],A[P][4]=A[N+"4"],A[P][5]=A[N+"5"],A[P][6]=A[N+"6"],A[P][7]=A[N+"7"],A[P][8]=A[N+"8"],A[P][9]=A[N+"9"],A[P][10]=A[N+"10"],A[P][11]=A[N+"11"],A[P][12]=A[N+"12"],A[P][13]=A[N+"13"],A[P][14]=A[N+"0"],A[P][15]=A[N+"0"]}function Je(N){return N==Di||N==fa||N==si||N==Co}function mt(){this.eb=[],this.size=this.A=this.fb=0}function Be(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function $t(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new mt,this.f.kb=new Be,this.sd=null}function Ee(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ct(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function hr(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function Mr(N,P){var R=N.T,U=P.ba.f.RGBA,ee=U.eb,ue=U.fb+N.ka*U.A,he=$c[P.ba.S],Ne=N.y,Se=N.O,Me=N.f,ft=N.N,Ut=N.ea,Re=N.W,wt=P.cc,Tt=P.dc,ur=P.Mc,Bt=P.Nc,pr=N.ka,yr=N.ka+N.T,zr=N.U,kr=zr+1>>1;for(pr==0?he(Ne,Se,null,null,Me,ft,Ut,Re,Me,ft,Ut,Re,ee,ue,null,null,zr):(he(P.ec,P.fc,Ne,Se,wt,Tt,ur,Bt,Me,ft,Ut,Re,ee,ue-U.A,ee,ue,zr),++R);pr+2<yr;pr+=2)wt=Me,Tt=ft,ur=Ut,Bt=Re,ft+=N.Rc,Re+=N.Rc,ue+=2*U.A,he(Ne,(Se+=2*N.fa)-N.fa,Ne,Se,wt,Tt,ur,Bt,Me,ft,Ut,Re,ee,ue-U.A,ee,ue,zr);return Se+=N.fa,N.j+yr<N.o?(n(P.ec,P.fc,Ne,Se,zr),n(P.cc,P.dc,Me,ft,kr),n(P.Mc,P.Nc,Ut,Re,kr),R--):1&yr||he(Ne,Se,null,null,Me,ft,Ut,Re,Me,ft,Ut,Re,ee,ue+U.A,null,null,zr),R}function qr(N,P,R){var U=N.F,ee=[N.J];if(U!=null){var ue=N.U,he=P.ba.S,Ne=he==Xa||he==si;P=P.ba.f.RGBA;var Se=[0],Me=N.ka;Se[0]=N.T,N.Kb&&(Me==0?--Se[0]:(--Me,ee[0]-=N.width),N.j+N.ka+N.T==N.o&&(Se[0]=N.o-N.j-Me));var ft=P.eb;Me=P.fb+Me*P.A,N=Yt(U,ee[0],N.width,ue,Se,ft,Me+(Ne?0:3),P.A),t(R==Se),N&&Je(he)&&_t(ft,Me,Ne,ue,Se,P.A)}return 0}function Or(N){var P=N.ma,R=P.ba.S,U=11>R,ee=R==As||R==Ii||R==Xa||R==Ro||R==12||Je(R);if(P.memory=null,P.Ib=null,P.Jb=null,P.Nd=null,!Ul(P.Oa,N,ee?11:12))return 0;if(ee&&Je(R)&&wa(),N.da)alert("todo:use_scaling");else{if(U){if(P.Ib=hr,N.Kb){if(R=N.U+1>>1,P.memory=i(N.U+2*R),P.memory==null)return 0;P.ec=P.memory,P.fc=0,P.cc=P.ec,P.dc=P.fc+N.U,P.Mc=P.cc,P.Nc=P.dc+R,P.Ib=Mr,wa()}}else alert("todo:EmitYUV");ee&&(P.Jb=qr,U&&Fr())}if(U&&!PR){for(N=0;256>N;++N)vie[N]=89858*(N-128)+Ow>>kw,bie[N]=-22014*(N-128)+Ow,yie[N]=-45773*(N-128),xie[N]=113618*(N-128)+Ow>>kw;for(N=P0;N<L5;++N)P=76283*(N-16)+Ow>>kw,wie[N-P0]=xa(P,255),jie[N-P0]=xa(P+8>>4,15);PR=1}return 1}function Mt(N){var P=N.ma,R=N.U,U=N.T;return t(!(1&N.ka)),0>=R||0>=U?0:(R=P.Ib(N,P),P.Jb!=null&&P.Jb(N,P,R),P.Dc+=R,1)}function Ir(N){N.ma.memory=null}function Ar(N,P,R,U){return fe(N,8)!=47?0:(P[0]=fe(N,14)+1,R[0]=fe(N,14)+1,U[0]=fe(N,1),fe(N,3)!=0?0:!N.h)}function Zt(N,P){if(4>N)return N+1;var R=N-2>>1;return(2+(1&N)<<R)+fe(P,R)+1}function Kr(N,P){return 120<P?P-120:1<=(R=((R=nie[P-1])>>4)*N+(8-(15&R)))?R:1;var R}function Tr(N,P,R){var U=V(R),ee=N[P+=255&U].g-8;return 0<ee&&(me(R,R.u+8),U=V(R),P+=N[P].value,P+=U&(1<<ee)-1),me(R,R.u+N[P].g),N[P].value}function dn(N,P,R){return R.g+=N.g,R.value+=N.value<<P>>>0,t(8>=R.g),N.g}function Ae(N,P,R){var U=N.xc;return t((P=U==0?0:N.vc[N.md*(R>>U)+(P>>U)])<N.Wb),N.Ya[P]}function pt(N,P,R,U){var ee=N.ab,ue=N.c*P,he=N.C;P=he+P;var Ne=R,Se=U;for(U=N.Ta,R=N.Ua;0<ee--;){var Me=N.gc[ee],ft=he,Ut=P,Re=Ne,wt=Se,Tt=(Se=U,Ne=R,Me.Ea);switch(t(ft<Ut),t(Ut<=Me.nc),Me.hc){case 2:io(Re,wt,(Ut-ft)*Tt,Se,Ne);break;case 0:var ur=ft,Bt=Ut,pr=Se,yr=Ne,zr=(bn=Me).Ea;ur==0&&(Oc(Re,wt,null,null,1,pr,yr),we(Re,wt+1,0,0,zr-1,pr,yr+1),wt+=zr,yr+=zr,++ur);for(var kr=1<<bn.b,An=kr-1,hn=at(zr,bn.b),ma=bn.K,bn=bn.w+(ur>>bn.b)*hn;ur<Bt;){var ka=ma,Mi=bn,ha=1;for(Tc(Re,wt,pr,yr-zr,1,pr,yr);ha<zr;){var wn=(ha&~An)+kr;wn>zr&&(wn=zr),(0,Ic[ka[Mi++]>>8&15])(Re,wt+ +ha,pr,yr+ha-zr,wn-ha,pr,yr+ha),ha=wn}wt+=zr,yr+=zr,++ur&An||(bn+=hn)}Ut!=Me.nc&&n(Se,Ne-Tt,Se,Ne+(Ut-ft-1)*Tt,Tt);break;case 1:for(Tt=Re,Bt=wt,zr=(Re=Me.Ea)-(yr=Re&~(pr=(wt=1<<Me.b)-1)),ur=at(Re,Me.b),kr=Me.K,Me=Me.w+(ft>>Me.b)*ur;ft<Ut;){for(An=kr,hn=Me,ma=new Sr,bn=Bt+yr,ka=Bt+Re;Bt<bn;)te(An[hn++],ma),Dh(ma,Tt,Bt,wt,Se,Ne),Bt+=wt,Ne+=wt;Bt<ka&&(te(An[hn++],ma),Dh(ma,Tt,Bt,zr,Se,Ne),Bt+=zr,Ne+=zr),++ft&pr||(Me+=ur)}break;case 3:if(Re==Se&&wt==Ne&&0<Me.b){for(Bt=Se,Re=Tt=Ne+(Ut-ft)*Tt-(yr=(Ut-ft)*at(Me.Ea,Me.b)),wt=Se,pr=Ne,ur=[],yr=(zr=yr)-1;0<=yr;--yr)ur[yr]=wt[pr+yr];for(yr=zr-1;0<=yr;--yr)Bt[Re+yr]=ur[yr];Vl(Me,ft,Ut,Se,Tt,Se,Ne)}else Vl(Me,ft,Ut,Re,wt,Se,Ne)}Ne=U,Se=R}Se!=R&&n(U,R,Ne,Se,ue)}function Br(N,P){var R=N.V,U=N.Ba+N.c*N.C,ee=P-N.C;if(t(P<=N.l.o),t(16>=ee),0<ee){var ue=N.l,he=N.Ta,Ne=N.Ua,Se=ue.width;if(pt(N,ee,R,U),ee=Ne=[Ne],t((R=N.C)<(U=P)),t(ue.v<ue.va),U>ue.o&&(U=ue.o),R<ue.j){var Me=ue.j-R;R=ue.j,ee[0]+=Me*Se}if(R>=U?R=0:(ee[0]+=4*ue.v,ue.ka=R-ue.j,ue.U=ue.va-ue.v,ue.T=U-R,R=1),R){if(Ne=Ne[0],11>(R=N.ca).S){var ft=R.f.RGBA,Ut=(U=R.S,ee=ue.U,ue=ue.T,Me=ft.eb,ft.A),Re=ue;for(ft=ft.fb+N.Ma*ft.A;0<Re--;){var wt=he,Tt=Ne,ur=ee,Bt=Me,pr=ft;switch(U){case ga:Yf(wt,Tt,ur,Bt,pr);break;case As:Dc(wt,Tt,ur,Bt,pr);break;case Di:Dc(wt,Tt,ur,Bt,pr),_t(Bt,pr,0,ur,1,0);break;case Ya:Gs(wt,Tt,ur,Bt,pr);break;case Ii:Ie(wt,Tt,ur,Bt,pr,1);break;case fa:Ie(wt,Tt,ur,Bt,pr,1),_t(Bt,pr,0,ur,1,0);break;case Xa:Ie(wt,Tt,ur,Bt,pr,0);break;case si:Ie(wt,Tt,ur,Bt,pr,0),_t(Bt,pr,1,ur,1,0);break;case Ro:Mc(wt,Tt,ur,Bt,pr);break;case Co:Mc(wt,Tt,ur,Bt,pr),Er(Bt,pr,ur,1,0);break;case fs:Rc(wt,Tt,ur,Bt,pr);break;default:t(0)}Ne+=Se,ft+=Ut}N.Ma+=ue}else alert("todo:EmitRescaledRowsYUVA");t(N.Ma<=R.height)}}N.C=P,t(N.C<=N.i)}function Pr(N){var P;if(0<N.ua)return 0;for(P=0;P<N.Wb;++P){var R=N.Ya[P].G,U=N.Ya[P].H;if(0<R[1][U[1]+0].g||0<R[2][U[2]+0].g||0<R[3][U[3]+0].g)return 0}return 1}function Ur(N,P,R,U,ee,ue){if(N.Z!=0){var he=N.qd,Ne=N.rd;for(t(Qf[N.Z]!=null);P<R;++P)Qf[N.Z](he,Ne,U,ee,U,ee,ue),he=U,Ne=ee,ee+=ue;N.qd=he,N.rd=Ne}}function Zr(N,P){var R=N.l.ma,U=R.Z==0||R.Z==1?N.l.j:N.C;if(U=N.C<U?U:N.C,t(P<=N.l.o),P>U){var ee=N.l.width,ue=R.ca,he=R.tb+ee*U,Ne=N.V,Se=N.Ba+N.c*U,Me=N.gc;t(N.ab==1),t(Me[0].hc==3),Ps(Me[0],U,P,Ne,Se,ue,he),Ur(R,U,P,ue,he,ee)}N.C=N.Ma=P}function cn(N,P,R,U,ee,ue,he){var Ne=N.$/U,Se=N.$%U,Me=N.m,ft=N.s,Ut=R+N.$,Re=Ut;ee=R+U*ee;var wt=R+U*ue,Tt=280+ft.ua,ur=N.Pb?Ne:16777216,Bt=0<ft.ua?ft.Wa:null,pr=ft.wc,yr=Ut<wt?Ae(ft,Se,Ne):null;t(N.C<ue),t(wt<=ee);var zr=!1;e:for(;;){for(;zr||Ut<wt;){var kr=0;if(Ne>=ur){var An=Ut-R;t((ur=N).Pb),ur.wd=ur.m,ur.xd=An,0<ur.s.ua&&lt(ur.s.Wa,ur.s.vb),ur=Ne+oie}if(Se&pr||(yr=Ae(ft,Se,Ne)),t(yr!=null),yr.Qb&&(P[Ut]=yr.qb,zr=!0),!zr)if(G(Me),yr.jc){kr=Me,An=P;var hn=Ut,ma=yr.pd[V(kr)&cu-1];t(yr.jc),256>ma.g?(me(kr,kr.u+ma.g),An[hn]=ma.value,kr=0):(me(kr,kr.u+ma.g-256),t(256<=ma.value),kr=ma.value),kr==0&&(zr=!0)}else kr=Tr(yr.G[0],yr.H[0],Me);if(Me.h)break;if(zr||256>kr){if(!zr)if(yr.nd)P[Ut]=(yr.qb|kr<<8)>>>0;else{if(G(Me),zr=Tr(yr.G[1],yr.H[1],Me),G(Me),An=Tr(yr.G[2],yr.H[2],Me),hn=Tr(yr.G[3],yr.H[3],Me),Me.h)break;P[Ut]=(hn<<24|zr<<16|kr<<8|An)>>>0}if(zr=!1,++Ut,++Se>=U&&(Se=0,++Ne,he!=null&&Ne<=ue&&!(Ne%16)&&he(N,Ne),Bt!=null))for(;Re<Ut;)kr=P[Re++],Bt.X[(506832829*kr&4294967295)>>>Bt.Mb]=kr}else if(280>kr){if(kr=Zt(kr-256,Me),An=Tr(yr.G[4],yr.H[4],Me),G(Me),An=Kr(U,An=Zt(An,Me)),Me.h)break;if(Ut-R<An||ee-Ut<kr)break e;for(hn=0;hn<kr;++hn)P[Ut+hn]=P[Ut+hn-An];for(Ut+=kr,Se+=kr;Se>=U;)Se-=U,++Ne,he!=null&&Ne<=ue&&!(Ne%16)&&he(N,Ne);if(t(Ut<=ee),Se&pr&&(yr=Ae(ft,Se,Ne)),Bt!=null)for(;Re<Ut;)kr=P[Re++],Bt.X[(506832829*kr&4294967295)>>>Bt.Mb]=kr}else{if(!(kr<Tt))break e;for(zr=kr-280,t(Bt!=null);Re<Ut;)kr=P[Re++],Bt.X[(506832829*kr&4294967295)>>>Bt.Mb]=kr;kr=Ut,t(!(zr>>>(An=Bt).Xa)),P[kr]=An.X[zr],zr=!0}zr||t(Me.h==re(Me))}if(N.Pb&&Me.h&&Ut<ee)t(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&lt(N.s.vb,N.s.Wa);else{if(Me.h)break e;he?.(N,Ne>ue?ue:Ne),N.a=0,N.$=Ut-R}return 1}return N.a=3,0}function Tn(N){t(N!=null),N.vc=null,N.yc=null,N.Ya=null;var P=N.Wa;P!=null&&(P.X=null),N.vb=null,t(N!=null)}function Qn(){var N=new nr;return N==null?null:(N.a=0,N.xb=wR,ke("Predictor","VP8LPredictors"),ke("Predictor","VP8LPredictors_C"),ke("PredictorAdd","VP8LPredictorsAdd"),ke("PredictorAdd","VP8LPredictorsAdd_C"),io=ye,Dh=$e,Yf=It,Dc=Dt,Mc=kt,Rc=cr,Gs=Cr,A.VP8LMapColor32b=vo,A.VP8LMapColor8b=Xu,N)}function Sa(N,P,R,U,ee){var ue=1,he=[N],Ne=[P],Se=U.m,Me=U.s,ft=null,Ut=0;e:for(;;){if(R)for(;ue&&fe(Se,1);){var Re=he,wt=Ne,Tt=U,ur=1,Bt=Tt.m,pr=Tt.gc[Tt.ab],yr=fe(Bt,2);if(Tt.Oc&1<<yr)ue=0;else{switch(Tt.Oc|=1<<yr,pr.hc=yr,pr.Ea=Re[0],pr.nc=wt[0],pr.K=[null],++Tt.ab,t(4>=Tt.ab),yr){case 0:case 1:pr.b=fe(Bt,3)+2,ur=Sa(at(pr.Ea,pr.b),at(pr.nc,pr.b),0,Tt,pr.K),pr.K=pr.K[0];break;case 3:var zr,kr=fe(Bt,8)+1,An=16<kr?0:4<kr?1:2<kr?2:3;if(Re[0]=at(pr.Ea,An),pr.b=An,zr=ur=Sa(kr,1,0,Tt,pr.K)){var hn,ma=kr,bn=pr,ka=1<<(8>>bn.b),Mi=i(ka);if(Mi==null)zr=0;else{var ha=bn.K[0],wn=bn.w;for(Mi[0]=bn.K[0][0],hn=1;hn<1*ma;++hn)Mi[hn]=yt(ha[wn+hn],Mi[hn-1]);for(;hn<4*ka;++hn)Mi[hn]=0;bn.K[0]=null,bn.K[0]=Mi,zr=1}}ur=zr;break;case 2:break;default:t(0)}ue=ur}}if(he=he[0],Ne=Ne[0],ue&&fe(Se,1)&&!(ue=1<=(Ut=fe(Se,4))&&11>=Ut)){U.a=3;break e}var Jr;if(Jr=ue)t:{var li,ia,$a,Po=U,ms=he,Ys=Ne,Xo=Ut,Es=R,Xs=Po.m,Ri=Po.s,qa=[null],Ja=1,Jo=0,Qa=aie[Xo];r:for(;;){if(Es&&fe(Xs,1)){var hs=fe(Xs,3)+2,Cd=at(ms,hs),ci=at(Ys,hs),wl=Cd*ci;if(!Sa(Cd,ci,0,Po,qa))break r;for(qa=qa[0],Ri.xc=hs,li=0;li<wl;++li){var fo=qa[li]>>8&65535;qa[li]=fo,fo>=Ja&&(Ja=fo+1)}}if(Xs.h)break r;for(ia=0;5>ia;++ia){var Li=_d[ia];!ia&&0<Xo&&(Li+=1<<Xo),Jo<Li&&(Jo=Li)}var Wl=s(Ja*Qa,I),Js=Ja,Hl=s(Js,F);if(Hl==null)var Gl=null;else t(65536>=Js),Gl=Hl;var jl=i(Jo);if(Gl==null||jl==null||Wl==null){Po.a=1;break r}var Kl=Wl;for(li=$a=0;li<Ja;++li){var xo=Gl[li],Yl=xo.G,Pd=xo.H,Lh=0,Zu=1,ps=0;for(ia=0;5>ia;++ia){Li=_d[ia],Yl[ia]=Kl,Pd[ia]=$a,!ia&&0<Xo&&(Li+=1<<Xo);a:{var Iw,$5=Li,Dw=Po,A0=jl,Sie=Kl,Cie=$a,F5=0,Zf=Dw.m,Pie=fe(Zf,1);if(a(A0,0,0,$5),Pie){var Aie=fe(Zf,1)+1,Eie=fe(Zf,1),kR=fe(Zf,Eie==0?1:8);A0[kR]=1,Aie==2&&(A0[kR=fe(Zf,8)]=1);var Mw=1}else{var OR=i(19),TR=fe(Zf,4)+4;if(19<TR){Dw.a=3;var Rw=0;break a}for(Iw=0;Iw<TR;++Iw)OR[rie[Iw]]=fe(Zf,3);var B5=void 0,E0=void 0,IR=Dw,kie=OR,Lw=$5,DR=A0,q5=0,em=IR.m,MR=8,RR=s(128,I);n:for(;T(RR,0,7,kie,19);){if(fe(em,1)){var Oie=2+2*fe(em,3);if((B5=2+fe(em,Oie))>Lw)break n}else B5=Lw;for(E0=0;E0<Lw&&B5--;){G(em);var LR=RR[0+(127&V(em))];me(em,em.u+LR.g);var Cg=LR.value;if(16>Cg)DR[E0++]=Cg,Cg!=0&&(MR=Cg);else{var Tie=Cg==16,$R=Cg-16,Iie=Ks[$R],FR=fe(em,Ji[$R])+Iie;if(E0+FR>Lw)break n;for(var Die=Tie?MR:0;0<FR--;)DR[E0++]=Die}}q5=1;break n}q5||(IR.a=3),Mw=q5}(Mw=Mw&&!Zf.h)&&(F5=T(Sie,Cie,8,A0,$5)),Mw&&F5!=0?Rw=F5:(Dw.a=3,Rw=0)}if(Rw==0)break r;if(Zu&&tie[ia]==1&&(Zu=Kl[$a].g==0),Lh+=Kl[$a].g,$a+=Rw,3>=ia){var k0,z5=jl[0];for(k0=1;k0<Li;++k0)jl[k0]>z5&&(z5=jl[k0]);ps+=z5}}if(xo.nd=Zu,xo.Qb=0,Zu&&(xo.qb=(Yl[3][Pd[3]+0].value<<24|Yl[1][Pd[1]+0].value<<16|Yl[2][Pd[2]+0].value)>>>0,Lh==0&&256>Yl[0][Pd[0]+0].value&&(xo.Qb=1,xo.qb+=Yl[0][Pd[0]+0].value<<8)),xo.jc=!xo.Qb&&6>ps,xo.jc){var $w,ef=xo;for($w=0;$w<cu;++$w){var tm=$w,rm=ef.pd[tm],Fw=ef.G[0][ef.H[0]+tm];256<=Fw.value?(rm.g=Fw.g+256,rm.value=Fw.value):(rm.g=0,rm.value=0,tm>>=dn(Fw,8,rm),tm>>=dn(ef.G[1][ef.H[1]+tm],16,rm),tm>>=dn(ef.G[2][ef.H[2]+tm],0,rm),dn(ef.G[3][ef.H[3]+tm],24,rm))}}}Ri.vc=qa,Ri.Wb=Ja,Ri.Ya=Gl,Ri.yc=Wl,Jr=1;break t}Jr=0}if(!(ue=Jr)){U.a=3;break e}if(0<Ut){if(Me.ua=1<<Ut,!Y(Me.Wa,Ut)){U.a=1,ue=0;break e}}else Me.ua=0;var U5=U,BR=he,Mie=Ne,V5=U5.s,W5=V5.xc;if(U5.c=BR,U5.i=Mie,V5.md=at(BR,W5),V5.wc=W5==0?-1:(1<<W5)-1,R){U.xb=fie;break e}if((ft=i(he*Ne))==null){U.a=1,ue=0;break e}ue=(ue=cn(U,ft,0,he,Ne,Ne,null))&&!Se.h;break e}return ue?(ee!=null?ee[0]=ft:(t(ft==null),t(R)),U.$=0,R||Tn(Me)):Tn(Me),ue}function ht(N,P){var R=N.c*N.i,U=R+P+16*P;return t(N.c<=P),N.V=i(U),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+R+P,1)}function Vt(N,P){var R=N.C,U=P-R,ee=N.V,ue=N.Ba+N.c*R;for(t(P<=N.l.o);0<U;){var he=16<U?16:U,Ne=N.l.ma,Se=N.l.width,Me=Se*he,ft=Ne.ca,Ut=Ne.tb+Se*R,Re=N.Ta,wt=N.Ua;pt(N,he,ee,ue),lr(Re,wt,ft,Ut,Me),Ur(Ne,R,R+he,ft,Ut,Se),U-=he,ee+=he*N.c,R+=he}t(R==P),N.C=N.Ma=P}function gr(){this.ub=this.yd=this.td=this.Rb=0}function Lt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Pt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Yr(){this.Yb=function(){var N=[];return function P(R,U,ee){for(var ue=ee[U],he=0;he<ue&&(R.push(ee.length>U+1?[]:0),!(ee.length<U+1));he++)P(R[he],U+1,ee)}(N,0,[3,11]),N}()}function Ft(){this.jb=i(3),this.Wc=l([4,8],Yr),this.Xc=l([4,17],Yr)}function jr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function ot(){this.ld=this.La=this.dd=this.tc=0}function Kt(){this.Na=this.la=0}function vr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function X(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function nt(){this.uc=this.M=this.Nb=0,this.wa=Array(new ot),this.Y=0,this.ya=Array(new X),this.aa=0,this.l=new We}function qe(){this.y=i(16),this.f=i(8),this.ea=i(8)}function it(){this.cb=this.a=0,this.sc="",this.m=new B,this.Od=new gr,this.Kc=new Lt,this.ed=new jr,this.Qa=new Pt,this.Ic=this.$c=this.Aa=0,this.D=new nt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,B),this.ia=0,this.pb=s(4,vr),this.Pa=new Ft,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new qe),this.Hd=0,this.rb=Array(new Kt),this.sb=0,this.wa=Array(new ot),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new X),this.L=this.aa=0,this.gd=l([4,2],ot),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function We(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ut(){var N=new it;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,C0||(C0=W)),N}function At(N,P,R){return N.a==0&&(N.a=P,N.sc=R,N.cb=0),0}function Wt(N,P,R){return 3<=R&&N[P+0]==157&&N[P+1]==1&&N[P+2]==42}function $r(N,P){if(N==null)return 0;if(N.a=0,N.sc="OK",P==null)return At(N,2,"null VP8Io passed to VP8GetHeaders()");var R=P.data,U=P.w,ee=P.ha;if(4>ee)return At(N,7,"Truncated header.");var ue=R[U+0]|R[U+1]<<8|R[U+2]<<16,he=N.Od;if(he.Rb=!(1&ue),he.td=ue>>1&7,he.yd=ue>>4&1,he.ub=ue>>5,3<he.td)return At(N,3,"Incorrect keyframe parameters.");if(!he.yd)return At(N,4,"Frame not displayable.");U+=3,ee-=3;var Ne=N.Kc;if(he.Rb){if(7>ee)return At(N,7,"cannot parse picture header");if(!Wt(R,U,ee))return At(N,3,"Bad code word");Ne.c=16383&(R[U+4]<<8|R[U+3]),Ne.Td=R[U+4]>>6,Ne.i=16383&(R[U+6]<<8|R[U+5]),Ne.Ud=R[U+6]>>6,U+=7,ee-=7,N.za=Ne.c+15>>4,N.Ub=Ne.i+15>>4,P.width=Ne.c,P.height=Ne.i,P.Da=0,P.j=0,P.v=0,P.va=P.width,P.o=P.height,P.da=0,P.ib=P.width,P.hb=P.height,P.U=P.width,P.T=P.height,a((ue=N.Pa).jb,0,255,ue.jb.length),t((ue=N.Qa)!=null),ue.Cb=0,ue.Bb=0,ue.Fb=1,a(ue.Zb,0,0,ue.Zb.length),a(ue.Lb,0,0,ue.Lb)}if(he.ub>ee)return At(N,7,"bad partition length");z(ue=N.m,R,U,he.ub),U+=he.ub,ee-=he.ub,he.Rb&&(Ne.Ld=ae(ue),Ne.Kd=ae(ue)),Ne=N.Qa;var Se,Me=N.Pa;if(t(ue!=null),t(Ne!=null),Ne.Cb=ae(ue),Ne.Cb){if(Ne.Bb=ae(ue),ae(ue)){for(Ne.Fb=ae(ue),Se=0;4>Se;++Se)Ne.Zb[Se]=ae(ue)?$(ue,7):0;for(Se=0;4>Se;++Se)Ne.Lb[Se]=ae(ue)?$(ue,6):0}if(Ne.Bb)for(Se=0;3>Se;++Se)Me.jb[Se]=ae(ue)?q(ue,8):255}else Ne.Bb=0;if(ue.Ka)return At(N,3,"cannot parse segment header");if((Ne=N.ed).zd=ae(ue),Ne.Tb=q(ue,6),Ne.wb=q(ue,3),Ne.Pc=ae(ue),Ne.Pc&&ae(ue)){for(Me=0;4>Me;++Me)ae(ue)&&(Ne.vd[Me]=$(ue,6));for(Me=0;4>Me;++Me)ae(ue)&&(Ne.od[Me]=$(ue,6))}if(N.L=Ne.Tb==0?0:Ne.zd?1:2,ue.Ka)return At(N,3,"cannot parse filter header");var ft=ee;if(ee=Se=U,U=Se+ft,Ne=ft,N.Xb=(1<<q(N.m,2))-1,ft<3*(Me=N.Xb))R=7;else{for(Se+=3*Me,Ne-=3*Me,ft=0;ft<Me;++ft){var Ut=R[ee+0]|R[ee+1]<<8|R[ee+2]<<16;Ut>Ne&&(Ut=Ne),z(N.Jc[+ft],R,Se,Ut),Se+=Ut,Ne-=Ut,ee+=3}z(N.Jc[+Me],R,Se,Ne),R=Se<U?0:5}if(R!=0)return At(N,R,"cannot parse partitions");for(R=q(Se=N.m,7),ee=ae(Se)?$(Se,4):0,U=ae(Se)?$(Se,4):0,Ne=ae(Se)?$(Se,4):0,Me=ae(Se)?$(Se,4):0,Se=ae(Se)?$(Se,4):0,ft=N.Qa,Ut=0;4>Ut;++Ut){if(ft.Cb){var Re=ft.Zb[Ut];ft.Fb||(Re+=R)}else{if(0<Ut){N.pb[Ut]=N.pb[0];continue}Re=R}var wt=N.pb[Ut];wt.Sc[0]=M5[xa(Re+ee,127)],wt.Sc[1]=R5[xa(Re+0,127)],wt.Eb[0]=2*M5[xa(Re+U,127)],wt.Eb[1]=101581*R5[xa(Re+Ne,127)]>>16,8>wt.Eb[1]&&(wt.Eb[1]=8),wt.Qc[0]=M5[xa(Re+Me,117)],wt.Qc[1]=R5[xa(Re+Se,127)],wt.lc=Re+Se}if(!he.Rb)return At(N,4,"Not a key frame.");for(ae(ue),he=N.Pa,R=0;4>R;++R){for(ee=0;8>ee;++ee)for(U=0;3>U;++U)for(Ne=0;11>Ne;++Ne)Me=J(ue,die[R][ee][U][Ne])?q(ue,8):lie[R][ee][U][Ne],he.Wc[R][ee].Yb[U][Ne]=Me;for(ee=0;17>ee;++ee)he.Xc[R][ee]=he.Wc[R][uie[ee]]}return N.kc=ae(ue),N.kc&&(N.Bd=q(ue,8)),N.cb=1}function W(N,P,R,U,ee,ue,he){var Ne=P[ee].Yb[R];for(R=0;16>ee;++ee){if(!J(N,Ne[R+0]))return ee;for(;!J(N,Ne[R+1]);)if(Ne=P[++ee].Yb[0],R=0,ee==16)return 16;var Se=P[ee+1].Yb;if(J(N,Ne[R+2])){var Me=N,ft=0;if(J(Me,(Re=Ne)[(Ut=R)+3]))if(J(Me,Re[Ut+6])){for(Ne=0,Ut=2*(ft=J(Me,Re[Ut+8]))+(Re=J(Me,Re[Ut+9+ft])),ft=0,Re=iie[Ut];Re[Ne];++Ne)ft+=ft+J(Me,Re[Ne]);ft+=3+(8<<Ut)}else J(Me,Re[Ut+7])?(ft=7+2*J(Me,165),ft+=J(Me,145)):ft=5+J(Me,159);else ft=J(Me,Re[Ut+4])?3+J(Me,Re[Ut+5]):2;Ne=Se[2]}else ft=1,Ne=Se[1];Se=he+sie[ee],0>(Me=N).b&&Q(Me);var Ut,Re=Me.b,wt=(Ut=Me.Ca>>1)-(Me.I>>Re)>>31;--Me.b,Me.Ca+=wt,Me.Ca|=1,Me.I-=(Ut+1&wt)<<Re,ue[Se]=((ft^wt)-wt)*U[(0<ee)+0]}return 16}function Ce(N){var P=N.rb[N.sb-1];P.la=0,P.Na=0,a(N.zc,0,0,N.zc.length),N.ja=0}function De(N,P,R,U,ee){ee=N[P+R+32*U]+(ee>>3),N[P+R+32*U]=-256&ee?0>ee?0:255:ee}function bt(N,P,R,U,ee,ue){De(N,P,0,R,U+ee),De(N,P,1,R,U+ue),De(N,P,2,R,U-ue),De(N,P,3,R,U-ee)}function He(N){return(20091*N>>16)+N}function dt(N,P,R,U){var ee,ue=0,he=i(16);for(ee=0;4>ee;++ee){var Ne=N[P+0]+N[P+8],Se=N[P+0]-N[P+8],Me=(35468*N[P+4]>>16)-He(N[P+12]),ft=He(N[P+4])+(35468*N[P+12]>>16);he[ue+0]=Ne+ft,he[ue+1]=Se+Me,he[ue+2]=Se-Me,he[ue+3]=Ne-ft,ue+=4,P++}for(ee=ue=0;4>ee;++ee)Ne=(N=he[ue+0]+4)+he[ue+8],Se=N-he[ue+8],Me=(35468*he[ue+4]>>16)-He(he[ue+12]),De(R,U,0,0,Ne+(ft=He(he[ue+4])+(35468*he[ue+12]>>16))),De(R,U,1,0,Se+Me),De(R,U,2,0,Se-Me),De(R,U,3,0,Ne-ft),ue++,U+=32}function rr(N,P,R,U){var ee=N[P+0]+4,ue=35468*N[P+4]>>16,he=He(N[P+4]),Ne=35468*N[P+1]>>16;bt(R,U,0,ee+he,N=He(N[P+1]),Ne),bt(R,U,1,ee+ue,N,Ne),bt(R,U,2,ee-ue,N,Ne),bt(R,U,3,ee-he,N,Ne)}function Gr(N,P,R,U,ee){dt(N,P,R,U),ee&&dt(N,P+16,R,U+4)}function Rr(N,P,R,U){yi(N,P+0,R,U,1),yi(N,P+32,R,U+128,1)}function br(N,P,R,U){var ee;for(N=N[P+0]+4,ee=0;4>ee;++ee)for(P=0;4>P;++P)De(R,U,P,ee,N)}function wr(N,P,R,U){N[P+0]&&ua(N,P+0,R,U),N[P+16]&&ua(N,P+16,R,U+4),N[P+32]&&ua(N,P+32,R,U+128),N[P+48]&&ua(N,P+48,R,U+128+4)}function or(N,P,R,U){var ee,ue=i(16);for(ee=0;4>ee;++ee){var he=N[P+0+ee]+N[P+12+ee],Ne=N[P+4+ee]+N[P+8+ee],Se=N[P+4+ee]-N[P+8+ee],Me=N[P+0+ee]-N[P+12+ee];ue[0+ee]=he+Ne,ue[8+ee]=he-Ne,ue[4+ee]=Me+Se,ue[12+ee]=Me-Se}for(ee=0;4>ee;++ee)he=(N=ue[0+4*ee]+3)+ue[3+4*ee],Ne=ue[1+4*ee]+ue[2+4*ee],Se=ue[1+4*ee]-ue[2+4*ee],Me=N-ue[3+4*ee],R[U+0]=he+Ne>>3,R[U+16]=Me+Se>>3,R[U+32]=he-Ne>>3,R[U+48]=Me-Se>>3,U+=64}function tn(N,P,R){var U,ee=P-32,ue=La,he=255-N[ee-1];for(U=0;U<R;++U){var Ne,Se=ue,Me=he+N[P-1];for(Ne=0;Ne<R;++Ne)N[P+Ne]=Se[Me+N[ee+Ne]];P+=32}}function tt(N,P){tn(N,P,4)}function Hr(N,P){tn(N,P,8)}function un(N,P){tn(N,P,16)}function jn(N,P){var R;for(R=0;16>R;++R)n(N,P+32*R,N,P-32,16)}function vn(N,P){var R;for(R=16;0<R;--R)a(N,P,N[P-1],16),P+=32}function Zn(N,P,R){var U;for(U=0;16>U;++U)a(P,R+32*U,N,16)}function Mn(N,P){var R,U=16;for(R=0;16>R;++R)U+=N[P-1+32*R]+N[P+R-32];Zn(U>>5,N,P)}function oa(N,P){var R,U=8;for(R=0;16>R;++R)U+=N[P-1+32*R];Zn(U>>4,N,P)}function Dn(N,P){var R,U=8;for(R=0;16>R;++R)U+=N[P+R-32];Zn(U>>4,N,P)}function va(N,P){Zn(128,N,P)}function on(N,P,R){return N+2*P+R+2>>2}function Ea(N,P){var R,U=P-32;for(U=new Uint8Array([on(N[U-1],N[U+0],N[U+1]),on(N[U+0],N[U+1],N[U+2]),on(N[U+1],N[U+2],N[U+3]),on(N[U+2],N[U+3],N[U+4])]),R=0;4>R;++R)n(N,P+32*R,U,0,U.length)}function Ca(N,P){var R=N[P-1],U=N[P-1+32],ee=N[P-1+64],ue=N[P-1+96];je(N,P+0,16843009*on(N[P-1-32],R,U)),je(N,P+32,16843009*on(R,U,ee)),je(N,P+64,16843009*on(U,ee,ue)),je(N,P+96,16843009*on(ee,ue,ue))}function ya(N,P){var R,U=4;for(R=0;4>R;++R)U+=N[P+R-32]+N[P-1+32*R];for(U>>=3,R=0;4>R;++R)a(N,P+32*R,U,4)}function Mo(N,P){var R=N[P-1+0],U=N[P-1+32],ee=N[P-1+64],ue=N[P-1-32],he=N[P+0-32],Ne=N[P+1-32],Se=N[P+2-32],Me=N[P+3-32];N[P+0+96]=on(U,ee,N[P-1+96]),N[P+1+96]=N[P+0+64]=on(R,U,ee),N[P+2+96]=N[P+1+64]=N[P+0+32]=on(ue,R,U),N[P+3+96]=N[P+2+64]=N[P+1+32]=N[P+0+0]=on(he,ue,R),N[P+3+64]=N[P+2+32]=N[P+1+0]=on(Ne,he,ue),N[P+3+32]=N[P+2+0]=on(Se,Ne,he),N[P+3+0]=on(Me,Se,Ne)}function vi(N,P){var R=N[P+1-32],U=N[P+2-32],ee=N[P+3-32],ue=N[P+4-32],he=N[P+5-32],Ne=N[P+6-32],Se=N[P+7-32];N[P+0+0]=on(N[P+0-32],R,U),N[P+1+0]=N[P+0+32]=on(R,U,ee),N[P+2+0]=N[P+1+32]=N[P+0+64]=on(U,ee,ue),N[P+3+0]=N[P+2+32]=N[P+1+64]=N[P+0+96]=on(ee,ue,he),N[P+3+32]=N[P+2+64]=N[P+1+96]=on(ue,he,Ne),N[P+3+64]=N[P+2+96]=on(he,Ne,Se),N[P+3+96]=on(Ne,Se,Se)}function oo(N,P){var R=N[P-1+0],U=N[P-1+32],ee=N[P-1+64],ue=N[P-1-32],he=N[P+0-32],Ne=N[P+1-32],Se=N[P+2-32],Me=N[P+3-32];N[P+0+0]=N[P+1+64]=ue+he+1>>1,N[P+1+0]=N[P+2+64]=he+Ne+1>>1,N[P+2+0]=N[P+3+64]=Ne+Se+1>>1,N[P+3+0]=Se+Me+1>>1,N[P+0+96]=on(ee,U,R),N[P+0+64]=on(U,R,ue),N[P+0+32]=N[P+1+96]=on(R,ue,he),N[P+1+32]=N[P+2+96]=on(ue,he,Ne),N[P+2+32]=N[P+3+96]=on(he,Ne,Se),N[P+3+32]=on(Ne,Se,Me)}function zl(N,P){var R=N[P+0-32],U=N[P+1-32],ee=N[P+2-32],ue=N[P+3-32],he=N[P+4-32],Ne=N[P+5-32],Se=N[P+6-32],Me=N[P+7-32];N[P+0+0]=R+U+1>>1,N[P+1+0]=N[P+0+64]=U+ee+1>>1,N[P+2+0]=N[P+1+64]=ee+ue+1>>1,N[P+3+0]=N[P+2+64]=ue+he+1>>1,N[P+0+32]=on(R,U,ee),N[P+1+32]=N[P+0+96]=on(U,ee,ue),N[P+2+32]=N[P+1+96]=on(ee,ue,he),N[P+3+32]=N[P+2+96]=on(ue,he,Ne),N[P+3+64]=on(he,Ne,Se),N[P+3+96]=on(Ne,Se,Me)}function yl(N,P){var R=N[P-1+0],U=N[P-1+32],ee=N[P-1+64],ue=N[P-1+96];N[P+0+0]=R+U+1>>1,N[P+2+0]=N[P+0+32]=U+ee+1>>1,N[P+2+32]=N[P+0+64]=ee+ue+1>>1,N[P+1+0]=on(R,U,ee),N[P+3+0]=N[P+1+32]=on(U,ee,ue),N[P+3+32]=N[P+1+64]=on(ee,ue,ue),N[P+3+64]=N[P+2+64]=N[P+0+96]=N[P+1+96]=N[P+2+96]=N[P+3+96]=ue}function cs(N,P){var R=N[P-1+0],U=N[P-1+32],ee=N[P-1+64],ue=N[P-1+96],he=N[P-1-32],Ne=N[P+0-32],Se=N[P+1-32],Me=N[P+2-32];N[P+0+0]=N[P+2+32]=R+he+1>>1,N[P+0+32]=N[P+2+64]=U+R+1>>1,N[P+0+64]=N[P+2+96]=ee+U+1>>1,N[P+0+96]=ue+ee+1>>1,N[P+3+0]=on(Ne,Se,Me),N[P+2+0]=on(he,Ne,Se),N[P+1+0]=N[P+3+32]=on(R,he,Ne),N[P+1+32]=N[P+3+64]=on(U,R,he),N[P+1+64]=N[P+3+96]=on(ee,U,R),N[P+1+96]=on(ue,ee,U)}function Ku(N,P){var R;for(R=0;8>R;++R)n(N,P+32*R,N,P-32,8)}function kc(N,P){var R;for(R=0;8>R;++R)a(N,P,N[P-1],8),P+=32}function de(N,P,R){var U;for(U=0;8>U;++U)a(P,R+32*U,N,8)}function Le(N,P){var R,U=8;for(R=0;8>R;++R)U+=N[P+R-32]+N[P-1+32*R];de(U>>4,N,P)}function jt(N,P){var R,U=4;for(R=0;8>R;++R)U+=N[P+R-32];de(U>>3,N,P)}function Rt(N,P){var R,U=4;for(R=0;8>R;++R)U+=N[P-1+32*R];de(U>>3,N,P)}function Ot(N,P){de(128,N,P)}function dr(N,P,R){var U=N[P-R],ee=N[P+0],ue=3*(ee-U)+Ra[1020+N[P-2*R]-N[P+R]],he=pa[112+(ue+4>>3)];N[P-R]=La[255+U+pa[112+(ue+3>>3)]],N[P+0]=La[255+ee-he]}function er(N,P,R,U){var ee=N[P+0],ue=N[P+R];return Rn[255+N[P-2*R]-N[P-R]]>U||Rn[255+ue-ee]>U}function _r(N,P,R,U){return 4*Rn[255+N[P-R]-N[P+0]]+Rn[255+N[P-2*R]-N[P+R]]<=U}function ne(N,P,R,U,ee){var ue=N[P-3*R],he=N[P-2*R],Ne=N[P-R],Se=N[P+0],Me=N[P+R],ft=N[P+2*R],Ut=N[P+3*R];return 4*Rn[255+Ne-Se]+Rn[255+he-Me]>U?0:Rn[255+N[P-4*R]-ue]<=ee&&Rn[255+ue-he]<=ee&&Rn[255+he-Ne]<=ee&&Rn[255+Ut-ft]<=ee&&Rn[255+ft-Me]<=ee&&Rn[255+Me-Se]<=ee}function ie(N,P,R,U){var ee=2*U+1;for(U=0;16>U;++U)_r(N,P+U,R,ee)&&dr(N,P+U,R)}function Ye(N,P,R,U){var ee=2*U+1;for(U=0;16>U;++U)_r(N,P+U*R,1,ee)&&dr(N,P+U*R,1)}function ze(N,P,R,U){var ee;for(ee=3;0<ee;--ee)ie(N,P+=4*R,R,U)}function Ke(N,P,R,U){var ee;for(ee=3;0<ee;--ee)Ye(N,P+=4,R,U)}function rt(N,P,R,U,ee,ue,he,Ne){for(ue=2*ue+1;0<ee--;){if(ne(N,P,R,ue,he))if(er(N,P,R,Ne))dr(N,P,R);else{var Se=N,Me=P,ft=R,Ut=Se[Me-2*ft],Re=Se[Me-ft],wt=Se[Me+0],Tt=Se[Me+ft],ur=Se[Me+2*ft],Bt=27*(yr=Ra[1020+3*(wt-Re)+Ra[1020+Ut-Tt]])+63>>7,pr=18*yr+63>>7,yr=9*yr+63>>7;Se[Me-3*ft]=La[255+Se[Me-3*ft]+yr],Se[Me-2*ft]=La[255+Ut+pr],Se[Me-ft]=La[255+Re+Bt],Se[Me+0]=La[255+wt-Bt],Se[Me+ft]=La[255+Tt-pr],Se[Me+2*ft]=La[255+ur-yr]}P+=U}}function oe(N,P,R,U,ee,ue,he,Ne){for(ue=2*ue+1;0<ee--;){if(ne(N,P,R,ue,he))if(er(N,P,R,Ne))dr(N,P,R);else{var Se=N,Me=P,ft=R,Ut=Se[Me-ft],Re=Se[Me+0],wt=Se[Me+ft],Tt=pa[112+(4+(ur=3*(Re-Ut))>>3)],ur=pa[112+(ur+3>>3)],Bt=Tt+1>>1;Se[Me-2*ft]=La[255+Se[Me-2*ft]+Bt],Se[Me-ft]=La[255+Ut+ur],Se[Me+0]=La[255+Re-Tt],Se[Me+ft]=La[255+wt-Bt]}P+=U}}function st(N,P,R,U,ee,ue){rt(N,P,R,1,16,U,ee,ue)}function Ve(N,P,R,U,ee,ue){rt(N,P,1,R,16,U,ee,ue)}function Qe(N,P,R,U,ee,ue){var he;for(he=3;0<he;--he)oe(N,P+=4*R,R,1,16,U,ee,ue)}function qt(N,P,R,U,ee,ue){var he;for(he=3;0<he;--he)oe(N,P+=4,1,R,16,U,ee,ue)}function O(N,P,R,U,ee,ue,he,Ne){rt(N,P,ee,1,8,ue,he,Ne),rt(R,U,ee,1,8,ue,he,Ne)}function H(N,P,R,U,ee,ue,he,Ne){rt(N,P,1,ee,8,ue,he,Ne),rt(R,U,1,ee,8,ue,he,Ne)}function _e(N,P,R,U,ee,ue,he,Ne){oe(N,P+4*ee,ee,1,8,ue,he,Ne),oe(R,U+4*ee,ee,1,8,ue,he,Ne)}function Oe(N,P,R,U,ee,ue,he,Ne){oe(N,P+4,1,ee,8,ue,he,Ne),oe(R,U+4,1,ee,8,ue,he,Ne)}function ve(){this.ba=new $t,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ct,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Xe(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function et(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function zt(){this.ua=0,this.Wa=new gt,this.vb=new gt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new F,this.yc=new I}function nr(){this.xb=this.a=0,this.l=new We,this.ca=new $t,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new L,this.Pb=0,this.wd=new L,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new zt,this.ab=0,this.gc=s(4,et),this.Oc=0}function Et(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new We,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Gt(N,P,R,U,ee,ue,he){for(N=N==null?0:N[P+0],P=0;P<he;++P)ee[ue+P]=N+R[U+P]&255,N=ee[ue+P]}function Nr(N,P,R,U,ee,ue,he){var Ne;if(N==null)Gt(null,null,R,U,ee,ue,he);else for(Ne=0;Ne<he;++Ne)ee[ue+Ne]=N[P+Ne]+R[U+Ne]&255}function tr(N,P,R,U,ee,ue,he){if(N==null)Gt(null,null,R,U,ee,ue,he);else{var Ne,Se=N[P+0],Me=Se,ft=Se;for(Ne=0;Ne<he;++Ne)Me=ft+(Se=N[P+Ne])-Me,ft=R[U+Ne]+(-256&Me?0>Me?0:255:Me)&255,Me=Se,ee[ue+Ne]=ft}}function ar(N,P,R,U){var ee=P.width,ue=P.o;if(t(N!=null&&P!=null),0>R||0>=U||R+U>ue)return null;if(!N.Cc){if(N.ga==null){var he;if(N.ga=new Et,(he=N.ga==null)||(he=P.width*P.o,t(N.Gb.length==0),N.Gb=i(he),N.Uc=0,N.Gb==null?he=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,he=1),he=!he),!he){he=N.ga;var Ne=N.Fa,Se=N.P,Me=N.qc,ft=N.mb,Ut=N.nb,Re=Se+1,wt=Me-1,Tt=he.l;if(t(Ne!=null&&ft!=null&&P!=null),Qf[0]=null,Qf[1]=Gt,Qf[2]=Nr,Qf[3]=tr,he.ca=ft,he.tb=Ut,he.c=P.width,he.i=P.height,t(0<he.c&&0<he.i),1>=Me)P=0;else if(he.$a=3&Ne[Se+0],he.Z=Ne[Se+0]>>2&3,he.Lc=Ne[Se+0]>>4&3,Se=Ne[Se+0]>>6&3,0>he.$a||1<he.$a||4<=he.Z||1<he.Lc||Se)P=0;else if(Tt.put=Mt,Tt.ac=Or,Tt.bc=Ir,Tt.ma=he,Tt.width=P.width,Tt.height=P.height,Tt.Da=P.Da,Tt.v=P.v,Tt.va=P.va,Tt.j=P.j,Tt.o=P.o,he.$a)e:{t(he.$a==1),P=Qn();t:for(;;){if(P==null){P=0;break e}if(t(he!=null),he.mc=P,P.c=he.c,P.i=he.i,P.l=he.l,P.l.ma=he,P.l.width=he.c,P.l.height=he.i,P.a=0,K(P.m,Ne,Re,wt),!Sa(he.c,he.i,1,P,null)||(P.ab==1&&P.gc[0].hc==3&&Pr(P.s)?(he.ic=1,Ne=P.c*P.i,P.Ta=null,P.Ua=0,P.V=i(Ne),P.Ba=0,P.V==null?(P.a=1,P=0):P=1):(he.ic=0,P=ht(P,he.c)),!P))break t;P=1;break e}he.mc=null,P=0}else P=wt>=he.c*he.i;he=!P}if(he)return null;N.ga.Lc!=1?N.Ga=0:U=ue-R}t(N.ga!=null),t(R+U<=ue);e:{if(P=(Ne=N.ga).c,ue=Ne.l.o,Ne.$a==0){if(Re=N.rc,wt=N.Vc,Tt=N.Fa,Se=N.P+1+R*P,Me=N.mb,ft=N.nb+R*P,t(Se<=N.P+N.qc),Ne.Z!=0)for(t(Qf[Ne.Z]!=null),he=0;he<U;++he)Qf[Ne.Z](Re,wt,Tt,Se,Me,ft,P),Re=Me,wt=ft,ft+=P,Se+=P;else for(he=0;he<U;++he)n(Me,ft,Tt,Se,P),Re=Me,wt=ft,ft+=P,Se+=P;N.rc=Re,N.Vc=wt}else{if(t(Ne.mc!=null),P=R+U,t((he=Ne.mc)!=null),t(P<=he.i),he.C>=P)P=1;else if(Ne.ic||Fr(),Ne.ic){Ne=he.V,Re=he.Ba,wt=he.c;var ur=he.i,Bt=(Tt=1,Se=he.$/wt,Me=he.$%wt,ft=he.m,Ut=he.s,he.$),pr=wt*ur,yr=wt*P,zr=Ut.wc,kr=Bt<yr?Ae(Ut,Me,Se):null;t(Bt<=pr),t(P<=ur),t(Pr(Ut));t:for(;;){for(;!ft.h&&Bt<yr;){if(Me&zr||(kr=Ae(Ut,Me,Se)),t(kr!=null),G(ft),256>(ur=Tr(kr.G[0],kr.H[0],ft)))Ne[Re+Bt]=ur,++Bt,++Me>=wt&&(Me=0,++Se<=P&&!(Se%16)&&Zr(he,Se));else{if(!(280>ur)){Tt=0;break t}ur=Zt(ur-256,ft);var An,hn=Tr(kr.G[4],kr.H[4],ft);if(G(ft),!(Bt>=(hn=Kr(wt,hn=Zt(hn,ft)))&&pr-Bt>=ur)){Tt=0;break t}for(An=0;An<ur;++An)Ne[Re+Bt+An]=Ne[Re+Bt+An-hn];for(Bt+=ur,Me+=ur;Me>=wt;)Me-=wt,++Se<=P&&!(Se%16)&&Zr(he,Se);Bt<yr&&Me&zr&&(kr=Ae(Ut,Me,Se))}t(ft.h==re(ft))}Zr(he,Se>P?P:Se);break t}!Tt||ft.h&&Bt<pr?(Tt=0,he.a=ft.h?5:3):he.$=Bt,P=Tt}else P=cn(he,he.V,he.Ba,he.c,he.i,P,Vt);if(!P){U=0;break e}}R+U>=ue&&(N.Cc=1),U=1}if(!U)return null;if(N.Cc&&((U=N.ga)!=null&&(U.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+R*ee}function sr(N,P,R,U,ee,ue){for(;0<ee--;){var he,Ne=N,Se=P+(R?1:0),Me=N,ft=P+(R?0:3);for(he=0;he<U;++he){var Ut=Me[ft+4*he];Ut!=255&&(Ut*=32897,Ne[Se+4*he+0]=Ne[Se+4*he+0]*Ut>>23,Ne[Se+4*he+1]=Ne[Se+4*he+1]*Ut>>23,Ne[Se+4*he+2]=Ne[Se+4*he+2]*Ut>>23)}P+=ue}}function xr(N,P,R,U,ee){for(;0<U--;){var ue;for(ue=0;ue<R;++ue){var he=N[P+2*ue+0],Ne=15&(Me=N[P+2*ue+1]),Se=4369*Ne,Me=(240&Me|Me>>4)*Se>>16;N[P+2*ue+0]=(240&he|he>>4)*Se>>16&240|(15&he|he<<4)*Se>>16>>4&15,N[P+2*ue+1]=240&Me|Ne}P+=ee}}function St(N,P,R,U,ee,ue,he,Ne){var Se,Me,ft=255;for(Me=0;Me<ee;++Me){for(Se=0;Se<U;++Se){var Ut=N[P+Se];ue[he+4*Se]=Ut,ft&=Ut}P+=R,he+=Ne}return ft!=255}function Lr(N,P,R,U,ee){var ue;for(ue=0;ue<ee;++ue)R[U+ue]=N[P+ue]>>8}function Fr(){_t=sr,Er=xr,Yt=St,lr=Lr}function gn(N,P,R){A[N]=function(U,ee,ue,he,Ne,Se,Me,ft,Ut,Re,wt,Tt,ur,Bt,pr,yr,zr){var kr,An=zr-1>>1,hn=Ne[Se+0]|Me[ft+0]<<16,ma=Ut[Re+0]|wt[Tt+0]<<16;t(U!=null);var bn=3*hn+ma+131074>>2;for(P(U[ee+0],255&bn,bn>>16,ur,Bt),ue!=null&&(bn=3*ma+hn+131074>>2,P(ue[he+0],255&bn,bn>>16,pr,yr)),kr=1;kr<=An;++kr){var ka=Ne[Se+kr]|Me[ft+kr]<<16,Mi=Ut[Re+kr]|wt[Tt+kr]<<16,ha=hn+ka+ma+Mi+524296,wn=ha+2*(ka+ma)>>3;bn=wn+hn>>1,hn=(ha=ha+2*(hn+Mi)>>3)+ka>>1,P(U[ee+2*kr-1],255&bn,bn>>16,ur,Bt+(2*kr-1)*R),P(U[ee+2*kr-0],255&hn,hn>>16,ur,Bt+(2*kr-0)*R),ue!=null&&(bn=ha+ma>>1,hn=wn+Mi>>1,P(ue[he+2*kr-1],255&bn,bn>>16,pr,yr+(2*kr-1)*R),P(ue[he+2*kr+0],255&hn,hn>>16,pr,yr+(2*kr+0)*R)),hn=ka,ma=Mi}1&zr||(bn=3*hn+ma+131074>>2,P(U[ee+zr-1],255&bn,bn>>16,ur,Bt+(zr-1)*R),ue!=null&&(bn=3*ma+hn+131074>>2,P(ue[he+zr-1],255&bn,bn>>16,pr,yr+(zr-1)*R)))}}function wa(){$c[ga]=mie,$c[As]=jR,$c[Ya]=hie,$c[Ii]=NR,$c[Xa]=_R,$c[Ro]=SR,$c[fs]=pie,$c[Di]=jR,$c[fa]=NR,$c[si]=_R,$c[Co]=SR}function $n(N){return N&~gie?0>N?0:255:N>>CR}function ca(N,P){return $n((19077*N>>8)+(26149*P>>8)-14234)}function da(N,P,R){return $n((19077*N>>8)-(6419*P>>8)-(13320*R>>8)+8708)}function co(N,P){return $n((19077*N>>8)+(33050*P>>8)-17685)}function Oi(N,P,R,U,ee){U[ee+0]=ca(N,R),U[ee+1]=da(N,P,R),U[ee+2]=co(N,P)}function oi(N,P,R,U,ee){U[ee+0]=co(N,P),U[ee+1]=da(N,P,R),U[ee+2]=ca(N,R)}function Da(N,P,R,U,ee){var ue=da(N,P,R);P=ue<<3&224|co(N,P)>>3,U[ee+0]=248&ca(N,R)|ue>>5,U[ee+1]=P}function go(N,P,R,U,ee){var ue=240&co(N,P)|15;U[ee+0]=240&ca(N,R)|da(N,P,R)>>4,U[ee+1]=ue}function Yi(N,P,R,U,ee){U[ee+0]=255,Oi(N,P,R,U,ee+1)}function uo(N,P,R,U,ee){oi(N,P,R,U,ee),U[ee+3]=255}function ds(N,P,R,U,ee){Oi(N,P,R,U,ee),U[ee+3]=255}function xa(N,P){return 0>N?0:N>P?P:N}function Xi(N,P,R){A[N]=function(U,ee,ue,he,Ne,Se,Me,ft,Ut){for(var Re=ft+(-2&Ut)*R;ft!=Re;)P(U[ee+0],ue[he+0],Ne[Se+0],Me,ft),P(U[ee+1],ue[he+0],Ne[Se+0],Me,ft+R),ee+=2,++he,++Se,ft+=2*R;1&Ut&&P(U[ee+0],ue[he+0],Ne[Se+0],Me,ft)}}function Vs(N,P,R){return R==0?N==0?P==0?6:5:P==0?4:0:R}function Yu(N,P,R,U,ee){switch(N>>>30){case 3:yi(P,R,U,ee,0);break;case 2:us(P,R,U,ee);break;case 1:ua(P,R,U,ee)}}function Ma(N,P){var R,U,ee=P.M,ue=P.Nb,he=N.oc,Ne=N.pc+40,Se=N.oc,Me=N.pc+584,ft=N.oc,Ut=N.pc+600;for(R=0;16>R;++R)he[Ne+32*R-1]=129;for(R=0;8>R;++R)Se[Me+32*R-1]=129,ft[Ut+32*R-1]=129;for(0<ee?he[Ne-1-32]=Se[Me-1-32]=ft[Ut-1-32]=129:(a(he,Ne-32-1,127,21),a(Se,Me-32-1,127,9),a(ft,Ut-32-1,127,9)),U=0;U<N.za;++U){var Re=P.ya[P.aa+U];if(0<U){for(R=-1;16>R;++R)n(he,Ne+32*R-4,he,Ne+32*R+12,4);for(R=-1;8>R;++R)n(Se,Me+32*R-4,Se,Me+32*R+4,4),n(ft,Ut+32*R-4,ft,Ut+32*R+4,4)}var wt=N.Gd,Tt=N.Hd+U,ur=Re.ad,Bt=Re.Hc;if(0<ee&&(n(he,Ne-32,wt[Tt].y,0,16),n(Se,Me-32,wt[Tt].f,0,8),n(ft,Ut-32,wt[Tt].ea,0,8)),Re.Za){var pr=he,yr=Ne-32+16;for(0<ee&&(U>=N.za-1?a(pr,yr,wt[Tt].y[15],4):n(pr,yr,wt[Tt+1].y,0,4)),R=0;4>R;R++)pr[yr+128+R]=pr[yr+256+R]=pr[yr+384+R]=pr[yr+0+R];for(R=0;16>R;++R,Bt<<=2)pr=he,yr=Ne+AR[R],Sd[Re.Ob[R]](pr,yr),Yu(Bt,ur,16*+R,pr,yr)}else if(pr=Vs(U,ee,Re.Ob[0]),Jf[pr](he,Ne),Bt!=0)for(R=0;16>R;++R,Bt<<=2)Yu(Bt,ur,16*+R,he,Ne+AR[R]);for(R=Re.Gc,pr=Vs(U,ee,Re.Dd),Qu[pr](Se,Me),Qu[pr](ft,Ut),Bt=ur,pr=Se,yr=Me,255&(Re=0|R)&&(170&Re?Lc(Bt,256,pr,yr):Ka(Bt,256,pr,yr)),Re=ft,Bt=Ut,255&(R>>=8)&&(170&R?Lc(ur,320,Re,Bt):Ka(ur,320,Re,Bt)),ee<N.Ub-1&&(n(wt[Tt].y,0,he,Ne+480,16),n(wt[Tt].f,0,Se,Me+224,8),n(wt[Tt].ea,0,ft,Ut+224,8)),R=8*ue*N.B,wt=N.sa,Tt=N.ta+16*U+16*ue*N.R,ur=N.qa,Re=N.ra+8*U+R,Bt=N.Ha,pr=N.Ia+8*U+R,R=0;16>R;++R)n(wt,Tt+R*N.R,he,Ne+32*R,16);for(R=0;8>R;++R)n(ur,Re+R*N.B,Se,Me+32*R,8),n(Bt,pr+R*N.B,ft,Ut+32*R,8)}}function Ws(N,P,R,U,ee,ue,he,Ne,Se){var Me=[0],ft=[0],Ut=0,Re=Se!=null?Se.kd:0,wt=Se??new Xe;if(N==null||12>R)return 7;wt.data=N,wt.w=P,wt.ha=R,P=[P],R=[R],wt.gb=[wt.gb];e:{var Tt=P,ur=R,Bt=wt.gb;if(t(N!=null),t(ur!=null),t(Bt!=null),Bt[0]=0,12<=ur[0]&&!r(N,Tt[0],"RIFF")){if(r(N,Tt[0]+8,"WEBP")){Bt=3;break e}var pr=Z(N,Tt[0]+4);if(12>pr||4294967286<pr){Bt=3;break e}if(Re&&pr>ur[0]-8){Bt=7;break e}Bt[0]=pr,Tt[0]+=12,ur[0]-=12}Bt=0}if(Bt!=0)return Bt;for(pr=0<wt.gb[0],R=R[0];;){e:{var yr=N;ur=P,Bt=R;var zr=Me,kr=ft,An=Tt=[0];if((bn=Ut=[Ut])[0]=0,8>Bt[0])Bt=7;else{if(!r(yr,ur[0],"VP8X")){if(Z(yr,ur[0]+4)!=10){Bt=3;break e}if(18>Bt[0]){Bt=7;break e}var hn=Z(yr,ur[0]+8),ma=1+Ue(yr,ur[0]+12);if(2147483648<=ma*(yr=1+Ue(yr,ur[0]+15))){Bt=3;break e}An!=null&&(An[0]=hn),zr!=null&&(zr[0]=ma),kr!=null&&(kr[0]=yr),ur[0]+=18,Bt[0]-=18,bn[0]=1}Bt=0}}if(Ut=Ut[0],Tt=Tt[0],Bt!=0)return Bt;if(ur=!!(2&Tt),!pr&&Ut)return 3;if(ue!=null&&(ue[0]=!!(16&Tt)),he!=null&&(he[0]=ur),Ne!=null&&(Ne[0]=0),he=Me[0],Tt=ft[0],Ut&&ur&&Se==null){Bt=0;break}if(4>R){Bt=7;break}if(pr&&Ut||!pr&&!Ut&&!r(N,P[0],"ALPH")){R=[R],wt.na=[wt.na],wt.P=[wt.P],wt.Sa=[wt.Sa];e:{hn=N,Bt=P,pr=R;var bn=wt.gb;zr=wt.na,kr=wt.P,An=wt.Sa,ma=22,t(hn!=null),t(pr!=null),yr=Bt[0];var ka=pr[0];for(t(zr!=null),t(An!=null),zr[0]=null,kr[0]=null,An[0]=0;;){if(Bt[0]=yr,pr[0]=ka,8>ka){Bt=7;break e}var Mi=Z(hn,yr+4);if(4294967286<Mi){Bt=3;break e}var ha=8+Mi+1&-2;if(ma+=ha,0<bn&&ma>bn){Bt=3;break e}if(!r(hn,yr,"VP8 ")||!r(hn,yr,"VP8L")){Bt=0;break e}if(ka[0]<ha){Bt=7;break e}r(hn,yr,"ALPH")||(zr[0]=hn,kr[0]=yr+8,An[0]=Mi),yr+=ha,ka-=ha}}if(R=R[0],wt.na=wt.na[0],wt.P=wt.P[0],wt.Sa=wt.Sa[0],Bt!=0)break}R=[R],wt.Ja=[wt.Ja],wt.xa=[wt.xa];e:if(bn=N,Bt=P,pr=R,zr=wt.gb[0],kr=wt.Ja,An=wt.xa,hn=Bt[0],yr=!r(bn,hn,"VP8 "),ma=!r(bn,hn,"VP8L"),t(bn!=null),t(pr!=null),t(kr!=null),t(An!=null),8>pr[0])Bt=7;else{if(yr||ma){if(bn=Z(bn,hn+4),12<=zr&&bn>zr-12){Bt=3;break e}if(Re&&bn>pr[0]-8){Bt=7;break e}kr[0]=bn,Bt[0]+=8,pr[0]-=8,An[0]=ma}else An[0]=5<=pr[0]&&bn[hn+0]==47&&!(bn[hn+4]>>5),kr[0]=pr[0];Bt=0}if(R=R[0],wt.Ja=wt.Ja[0],wt.xa=wt.xa[0],P=P[0],Bt!=0)break;if(4294967286<wt.Ja)return 3;if(Ne==null||ur||(Ne[0]=wt.xa?2:1),he=[he],Tt=[Tt],wt.xa){if(5>R){Bt=7;break}Ne=he,Re=Tt,ur=ue,N==null||5>R?N=0:5<=R&&N[P+0]==47&&!(N[P+4]>>5)?(pr=[0],bn=[0],zr=[0],K(kr=new L,N,P,R),Ar(kr,pr,bn,zr)?(Ne!=null&&(Ne[0]=pr[0]),Re!=null&&(Re[0]=bn[0]),ur!=null&&(ur[0]=zr[0]),N=1):N=0):N=0}else{if(10>R){Bt=7;break}Ne=Tt,N==null||10>R||!Wt(N,P+3,R-3)?N=0:(Re=N[P+0]|N[P+1]<<8|N[P+2]<<16,ur=16383&(N[P+7]<<8|N[P+6]),N=16383&(N[P+9]<<8|N[P+8]),1&Re||3<(Re>>1&7)||!(Re>>4&1)||Re>>5>=wt.Ja||!ur||!N?N=0:(he&&(he[0]=ur),Ne&&(Ne[0]=N),N=1))}if(!N||(he=he[0],Tt=Tt[0],Ut&&(Me[0]!=he||ft[0]!=Tt)))return 3;Se!=null&&(Se[0]=wt,Se.offset=P-Se.w,t(4294967286>P-Se.w),t(Se.offset==Se.ha-R));break}return Bt==0||Bt==7&&Ut&&Se==null?(ue!=null&&(ue[0]|=wt.na!=null&&0<wt.na.length),U!=null&&(U[0]=he),ee!=null&&(ee[0]=Tt),0):Bt}function Ul(N,P,R){var U=P.width,ee=P.height,ue=0,he=0,Ne=U,Se=ee;if(P.Da=N!=null&&0<N.Da,P.Da&&(Ne=N.cd,Se=N.bd,ue=N.v,he=N.j,11>R||(ue&=-2,he&=-2),0>ue||0>he||0>=Ne||0>=Se||ue+Ne>U||he+Se>ee))return 0;if(P.v=ue,P.j=he,P.va=ue+Ne,P.o=he+Se,P.U=Ne,P.T=Se,P.da=N!=null&&0<N.da,P.da){if(!Te(Ne,Se,R=[N.ib],ue=[N.hb]))return 0;P.ib=R[0],P.hb=ue[0]}return P.ob=N!=null&&N.ob,P.Kb=N==null||!N.Sd,P.da&&(P.ob=P.ib<3*U/4&&P.hb<3*ee/4,P.Kb=0),1}function Cs(N){if(N==null)return 2;if(11>N.S){var P=N.f.RGBA;P.fb+=(N.height-1)*P.A,P.A=-P.A}else P=N.f.kb,N=N.height,P.O+=(N-1)*P.fa,P.fa=-P.fa,P.N+=(N-1>>1)*P.Ab,P.Ab=-P.Ab,P.W+=(N-1>>1)*P.Db,P.Db=-P.Db,P.F!=null&&(P.J+=(N-1)*P.lb,P.lb=-P.lb);return 0}function Ti(N,P,R,U){if(U==null||0>=N||0>=P)return 2;if(R!=null){if(R.Da){var ee=R.cd,ue=R.bd,he=-2&R.v,Ne=-2&R.j;if(0>he||0>Ne||0>=ee||0>=ue||he+ee>N||Ne+ue>P)return 2;N=ee,P=ue}if(R.da){if(!Te(N,P,ee=[R.ib],ue=[R.hb]))return 2;N=ee[0],P=ue[0]}}U.width=N,U.height=P;e:{var Se=U.width,Me=U.height;if(N=U.S,0>=Se||0>=Me||!(N>=ga&&13>N))N=2;else{if(0>=U.Rd&&U.sd==null){he=ue=ee=P=0;var ft=(Ne=Se*ER[N])*Me;if(11>N||(ue=(Me+1)/2*(P=(Se+1)/2),N==12&&(he=(ee=Se)*Me)),(Me=i(ft+2*ue+he))==null){N=1;break e}U.sd=Me,11>N?((Se=U.f.RGBA).eb=Me,Se.fb=0,Se.A=Ne,Se.size=ft):((Se=U.f.kb).y=Me,Se.O=0,Se.fa=Ne,Se.Fd=ft,Se.f=Me,Se.N=0+ft,Se.Ab=P,Se.Cd=ue,Se.ea=Me,Se.W=0+ft+ue,Se.Db=P,Se.Ed=ue,N==12&&(Se.F=Me,Se.J=0+ft+2*ue),Se.Tc=he,Se.lb=ee)}if(P=1,ee=U.S,ue=U.width,he=U.height,ee>=ga&&13>ee)if(11>ee)N=U.f.RGBA,P&=(Ne=Math.abs(N.A))*(he-1)+ue<=N.size,P&=Ne>=ue*ER[ee],P&=N.eb!=null;else{N=U.f.kb,Ne=(ue+1)/2,ft=(he+1)/2,Se=Math.abs(N.fa),Me=Math.abs(N.Ab);var Ut=Math.abs(N.Db),Re=Math.abs(N.lb),wt=Re*(he-1)+ue;P&=Se*(he-1)+ue<=N.Fd,P&=Me*(ft-1)+Ne<=N.Cd,P=(P&=Ut*(ft-1)+Ne<=N.Ed)&Se>=ue&Me>=Ne&Ut>=Ne,P&=N.y!=null,P&=N.f!=null,P&=N.ea!=null,ee==12&&(P&=Re>=ue,P&=wt<=N.Tc,P&=N.F!=null)}else P=0;N=P?0:2}}return N!=0||R!=null&&R.fd&&(N=Cs(U)),N}var cu=64,bl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Hs=24,xi=32,Ko=8,du=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];vt("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(N){return N},A.Predictor2=function(N,P,R){return P[R+0]},A.Predictor3=function(N,P,R){return P[R+1]},A.Predictor4=function(N,P,R){return P[R-1]},A.Predictor5=function(N,P,R){return se(se(N,P[R+1]),P[R+0])},A.Predictor6=function(N,P,R){return se(N,P[R-1])},A.Predictor7=function(N,P,R){return se(N,P[R+0])},A.Predictor8=function(N,P,R){return se(P[R-1],P[R+0])},A.Predictor9=function(N,P,R){return se(P[R+0],P[R+1])},A.Predictor10=function(N,P,R){return se(se(N,P[R-1]),se(P[R+0],P[R+1]))},A.Predictor11=function(N,P,R){var U=P[R+0];return 0>=Qt(U>>24&255,N>>24&255,(P=P[R-1])>>24&255)+Qt(U>>16&255,N>>16&255,P>>16&255)+Qt(U>>8&255,N>>8&255,P>>8&255)+Qt(255&U,255&N,255&P)?U:N},A.Predictor12=function(N,P,R){var U=P[R+0];return(Ze((N>>24&255)+(U>>24&255)-((P=P[R-1])>>24&255))<<24|Ze((N>>16&255)+(U>>16&255)-(P>>16&255))<<16|Ze((N>>8&255)+(U>>8&255)-(P>>8&255))<<8|Ze((255&N)+(255&U)-(255&P)))>>>0},A.Predictor13=function(N,P,R){var U=P[R-1];return(ct((N=se(N,P[R+0]))>>24&255,U>>24&255)<<24|ct(N>>16&255,U>>16&255)<<16|ct(N>>8&255,U>>8&255)<<8|ct(255&N,255&U))>>>0};var Oc=A.PredictorAdd0;A.PredictorAdd1=we,vt("Predictor2","PredictorAdd2"),vt("Predictor3","PredictorAdd3"),vt("Predictor4","PredictorAdd4"),vt("Predictor5","PredictorAdd5"),vt("Predictor6","PredictorAdd6"),vt("Predictor7","PredictorAdd7"),vt("Predictor8","PredictorAdd8"),vt("Predictor9","PredictorAdd9"),vt("Predictor10","PredictorAdd10"),vt("Predictor11","PredictorAdd11"),vt("Predictor12","PredictorAdd12"),vt("Predictor13","PredictorAdd13");var Tc=A.PredictorAdd2;Pe("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),Pe("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var io,Vl=A.ColorIndexInverseTransform,vo=A.MapARGB,Ps=A.VP8LColorIndexInverseTransformAlpha,Xu=A.MapAlpha,Ic=A.VP8LPredictorsAdd=[];Ic.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var Dh,Yf,Dc,Mc,Rc,Gs,Yo,yi,us,Lc,ua,Ka,zo,ii,Nd,Mh,Ju,Rh,Sg,Xf,ge,Fe,Ge,xt,_t,Er,Yt,lr,xn=i(511),ea=i(2041),Fn=i(225),rn=i(767),Wa=0,Ra=ea,pa=Fn,La=rn,Rn=xn,ga=0,As=1,Ya=2,Ii=3,Xa=4,Ro=5,fs=6,Di=7,fa=8,si=9,Co=10,Ji=[2,3,7],Ks=[3,3,11],_d=[280,256,256,256,40],tie=[0,1,1,1,0],rie=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],nie=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],aie=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],oie=8,M5=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],R5=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],C0=null,iie=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],sie=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],bR=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],lie=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],cie=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],die=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],uie=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Jf=[],Sd=[],Qu=[],fie=1,wR=2,Qf=[],$c=[];gn("UpsampleRgbLinePair",Oi,3),gn("UpsampleBgrLinePair",oi,3),gn("UpsampleRgbaLinePair",ds,4),gn("UpsampleBgraLinePair",uo,4),gn("UpsampleArgbLinePair",Yi,4),gn("UpsampleRgba4444LinePair",go,2),gn("UpsampleRgb565LinePair",Da,2);var mie=A.UpsampleRgbLinePair,hie=A.UpsampleBgrLinePair,jR=A.UpsampleRgbaLinePair,NR=A.UpsampleBgraLinePair,_R=A.UpsampleArgbLinePair,SR=A.UpsampleRgba4444LinePair,pie=A.UpsampleRgb565LinePair,kw=16,Ow=1<<kw-1,P0=-227,L5=482,CR=6,gie=(256<<CR)-1,PR=0,vie=i(256),xie=i(256),yie=i(256),bie=i(256),wie=i(L5-P0),jie=i(L5-P0);Xi("YuvToRgbRow",Oi,3),Xi("YuvToBgrRow",oi,3),Xi("YuvToRgbaRow",ds,4),Xi("YuvToBgraRow",uo,4),Xi("YuvToArgbRow",Yi,4),Xi("YuvToRgba4444Row",go,2),Xi("YuvToRgb565Row",Da,2);var AR=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Tw=[0,2,8],Nie=[8,7,6,4,4,2,2,2,1,1,1,1],_ie=1;this.WebPDecodeRGBA=function(N,P,R,U,ee){var ue=As,he=new ve,Ne=new $t;he.ba=Ne,Ne.S=ue,Ne.width=[Ne.width],Ne.height=[Ne.height];var Se=Ne.width,Me=Ne.height,ft=new Ee;if(ft==null||N==null)var Ut=2;else t(ft!=null),Ut=Ws(N,P,R,ft.width,ft.height,ft.Pd,ft.Qd,ft.format,null);if(Ut!=0?Se=0:(Se!=null&&(Se[0]=ft.width[0]),Me!=null&&(Me[0]=ft.height[0]),Se=1),Se){Ne.width=Ne.width[0],Ne.height=Ne.height[0],U!=null&&(U[0]=Ne.width),ee!=null&&(ee[0]=Ne.height);e:{if(U=new We,(ee=new Xe).data=N,ee.w=P,ee.ha=R,ee.kd=1,P=[0],t(ee!=null),((N=Ws(ee.data,ee.w,ee.ha,null,null,null,P,null,ee))==0||N==7)&&P[0]&&(N=4),(P=N)==0){if(t(he!=null),U.data=ee.data,U.w=ee.w+ee.offset,U.ha=ee.ha-ee.offset,U.put=Mt,U.ac=Or,U.bc=Ir,U.ma=he,ee.xa){if((N=Qn())==null){he=1;break e}if(function(Re,wt){var Tt=[0],ur=[0],Bt=[0];t:for(;;){if(Re==null)return 0;if(wt==null)return Re.a=2,0;if(Re.l=wt,Re.a=0,K(Re.m,wt.data,wt.w,wt.ha),!Ar(Re.m,Tt,ur,Bt)){Re.a=3;break t}if(Re.xb=wR,wt.width=Tt[0],wt.height=ur[0],!Sa(Tt[0],ur[0],1,Re,null))break t;return 1}return t(Re.a!=0),0}(N,U)){if(U=(P=Ti(U.width,U.height,he.Oa,he.ba))==0){t:{U=N;r:for(;;){if(U==null){U=0;break t}if(t(U.s.yc!=null),t(U.s.Ya!=null),t(0<U.s.Wb),t((R=U.l)!=null),t((ee=R.ma)!=null),U.xb!=0){if(U.ca=ee.ba,U.tb=ee.tb,t(U.ca!=null),!Ul(ee.Oa,R,Ii)){U.a=2;break r}if(!ht(U,R.width)||R.da)break r;if((R.da||Je(U.ca.S))&&Fr(),11>U.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),U.ca.f.kb.F!=null&&Fr()),U.Pb&&0<U.s.ua&&U.s.vb.X==null&&!Y(U.s.vb,U.s.Wa.Xa)){U.a=1;break r}U.xb=0}if(!cn(U,U.V,U.Ba,U.c,U.i,R.o,Br))break r;ee.Dc=U.Ma,U=1;break t}t(U.a!=0),U=0}U=!U}U&&(P=N.a)}else P=N.a}else{if((N=new ut)==null){he=1;break e}if(N.Fa=ee.na,N.P=ee.P,N.qc=ee.Sa,$r(N,U)){if((P=Ti(U.width,U.height,he.Oa,he.ba))==0){if(N.Aa=0,R=he.Oa,t((ee=N)!=null),R!=null){if(0<(Se=0>(Se=R.Md)?0:100<Se?255:255*Se/100)){for(Me=ft=0;4>Me;++Me)12>(Ut=ee.pb[Me]).lc&&(Ut.ia=Se*Nie[0>Ut.lc?0:Ut.lc]>>3),ft|=Ut.ia;ft&&(alert("todo:VP8InitRandom"),ee.ia=1)}ee.Ga=R.Id,100<ee.Ga?ee.Ga=100:0>ee.Ga&&(ee.Ga=0)}(function(Re,wt){if(Re==null)return 0;if(wt==null)return At(Re,2,"NULL VP8Io parameter in VP8Decode().");if(!Re.cb&&!$r(Re,wt))return 0;if(t(Re.cb),wt.ac==null||wt.ac(wt)){wt.ob&&(Re.L=0);var Tt=Tw[Re.L];if(Re.L==2?(Re.yb=0,Re.zb=0):(Re.yb=wt.v-Tt>>4,Re.zb=wt.j-Tt>>4,0>Re.yb&&(Re.yb=0),0>Re.zb&&(Re.zb=0)),Re.Va=wt.o+15+Tt>>4,Re.Hb=wt.va+15+Tt>>4,Re.Hb>Re.za&&(Re.Hb=Re.za),Re.Va>Re.Ub&&(Re.Va=Re.Ub),0<Re.L){var ur=Re.ed;for(Tt=0;4>Tt;++Tt){var Bt;if(Re.Qa.Cb){var pr=Re.Qa.Lb[Tt];Re.Qa.Fb||(pr+=ur.Tb)}else pr=ur.Tb;for(Bt=0;1>=Bt;++Bt){var yr=Re.gd[Tt][Bt],zr=pr;if(ur.Pc&&(zr+=ur.vd[0],Bt&&(zr+=ur.od[0])),0<(zr=0>zr?0:63<zr?63:zr)){var kr=zr;0<ur.wb&&(kr=4<ur.wb?kr>>2:kr>>1)>9-ur.wb&&(kr=9-ur.wb),1>kr&&(kr=1),yr.dd=kr,yr.tc=2*zr+kr,yr.ld=40<=zr?2:15<=zr?1:0}else yr.tc=0;yr.La=Bt}}}Tt=0}else At(Re,6,"Frame setup failed"),Tt=Re.a;if(Tt=Tt==0){if(Tt){Re.$c=0,0<Re.Aa||(Re.Ic=_ie);t:{Tt=Re.Ic,ur=4*(kr=Re.za);var An=32*kr,hn=kr+1,ma=0<Re.L?kr*(0<Re.Aa?2:1):0,bn=(Re.Aa==2?2:1)*kr;if((yr=ur+832+(Bt=3*(16*Tt+Tw[Re.L])/2*An)+(pr=Re.Fa!=null&&0<Re.Fa.length?Re.Kc.c*Re.Kc.i:0))!=yr)Tt=0;else{if(yr>Re.Vb){if(Re.Vb=0,Re.Ec=i(yr),Re.Fc=0,Re.Ec==null){Tt=At(Re,1,"no memory during frame initialization.");break t}Re.Vb=yr}yr=Re.Ec,zr=Re.Fc,Re.Ac=yr,Re.Bc=zr,zr+=ur,Re.Gd=s(An,qe),Re.Hd=0,Re.rb=s(hn+1,Kt),Re.sb=1,Re.wa=ma?s(ma,ot):null,Re.Y=0,Re.D.Nb=0,Re.D.wa=Re.wa,Re.D.Y=Re.Y,0<Re.Aa&&(Re.D.Y+=kr),t(!0),Re.oc=yr,Re.pc=zr,zr+=832,Re.ya=s(bn,X),Re.aa=0,Re.D.ya=Re.ya,Re.D.aa=Re.aa,Re.Aa==2&&(Re.D.aa+=kr),Re.R=16*kr,Re.B=8*kr,kr=(An=Tw[Re.L])*Re.R,An=An/2*Re.B,Re.sa=yr,Re.ta=zr+kr,Re.qa=Re.sa,Re.ra=Re.ta+16*Tt*Re.R+An,Re.Ha=Re.qa,Re.Ia=Re.ra+8*Tt*Re.B+An,Re.$c=0,zr+=Bt,Re.mb=pr?yr:null,Re.nb=pr?zr:null,t(zr+pr<=Re.Fc+Re.Vb),Ce(Re),a(Re.Ac,Re.Bc,0,ur),Tt=1}}if(Tt){if(wt.ka=0,wt.y=Re.sa,wt.O=Re.ta,wt.f=Re.qa,wt.N=Re.ra,wt.ea=Re.Ha,wt.Vd=Re.Ia,wt.fa=Re.R,wt.Rc=Re.B,wt.F=null,wt.J=0,!Wa){for(Tt=-255;255>=Tt;++Tt)xn[255+Tt]=0>Tt?-Tt:Tt;for(Tt=-1020;1020>=Tt;++Tt)ea[1020+Tt]=-128>Tt?-128:127<Tt?127:Tt;for(Tt=-112;112>=Tt;++Tt)Fn[112+Tt]=-16>Tt?-16:15<Tt?15:Tt;for(Tt=-255;510>=Tt;++Tt)rn[255+Tt]=0>Tt?0:255<Tt?255:Tt;Wa=1}Yo=or,yi=Gr,Lc=Rr,ua=br,Ka=wr,us=rr,zo=st,ii=Ve,Nd=O,Mh=H,Ju=Qe,Rh=qt,Sg=_e,Xf=Oe,ge=ie,Fe=Ye,Ge=ze,xt=Ke,Sd[0]=ya,Sd[1]=tt,Sd[2]=Ea,Sd[3]=Ca,Sd[4]=Mo,Sd[5]=oo,Sd[6]=vi,Sd[7]=zl,Sd[8]=cs,Sd[9]=yl,Jf[0]=Mn,Jf[1]=un,Jf[2]=jn,Jf[3]=vn,Jf[4]=oa,Jf[5]=Dn,Jf[6]=va,Qu[0]=Le,Qu[1]=Hr,Qu[2]=Ku,Qu[3]=kc,Qu[4]=Rt,Qu[5]=jt,Qu[6]=Ot,Tt=1}else Tt=0}Tt&&(Tt=function(ka,Mi){for(ka.M=0;ka.M<ka.Va;++ka.M){var ha,wn=ka.Jc[ka.M&ka.Xb],Jr=ka.m,li=ka;for(ha=0;ha<li.za;++ha){var ia=Jr,$a=li,Po=$a.Ac,ms=$a.Bc+4*ha,Ys=$a.zc,Xo=$a.ya[$a.aa+ha];if($a.Qa.Bb?Xo.$b=J(ia,$a.Pa.jb[0])?2+J(ia,$a.Pa.jb[2]):J(ia,$a.Pa.jb[1]):Xo.$b=0,$a.kc&&(Xo.Ad=J(ia,$a.Bd)),Xo.Za=!J(ia,145)+0,Xo.Za){var Es=Xo.Ob,Xs=0;for($a=0;4>$a;++$a){var Ri,qa=Ys[0+$a];for(Ri=0;4>Ri;++Ri){qa=cie[Po[ms+Ri]][qa];for(var Ja=bR[J(ia,qa[0])];0<Ja;)Ja=bR[2*Ja+J(ia,qa[Ja])];qa=-Ja,Po[ms+Ri]=qa}n(Es,Xs,Po,ms,4),Xs+=4,Ys[0+$a]=qa}}else qa=J(ia,156)?J(ia,128)?1:3:J(ia,163)?2:0,Xo.Ob[0]=qa,a(Po,ms,qa,4),a(Ys,0,qa,4);Xo.Dd=J(ia,142)?J(ia,114)?J(ia,183)?1:3:2:0}if(li.m.Ka)return At(ka,7,"Premature end-of-partition0 encountered.");for(;ka.ja<ka.za;++ka.ja){if(li=wn,ia=(Jr=ka).rb[Jr.sb-1],Po=Jr.rb[Jr.sb+Jr.ja],ha=Jr.ya[Jr.aa+Jr.ja],ms=Jr.kc?ha.Ad:0)ia.la=Po.la=0,ha.Za||(ia.Na=Po.Na=0),ha.Hc=0,ha.Gc=0,ha.ia=0;else{var Jo,Qa;if(ia=Po,Po=li,ms=Jr.Pa.Xc,Ys=Jr.ya[Jr.aa+Jr.ja],Xo=Jr.pb[Ys.$b],$a=Ys.ad,Es=0,Xs=Jr.rb[Jr.sb-1],qa=Ri=0,a($a,Es,0,384),Ys.Za)var hs=0,Cd=ms[3];else{Ja=i(16);var ci=ia.Na+Xs.Na;if(ci=C0(Po,ms[1],ci,Xo.Eb,0,Ja,0),ia.Na=Xs.Na=(0<ci)+0,1<ci)Yo(Ja,0,$a,Es);else{var wl=Ja[0]+3>>3;for(Ja=0;256>Ja;Ja+=16)$a[Es+Ja]=wl}hs=1,Cd=ms[0]}var fo=15&ia.la,Li=15&Xs.la;for(Ja=0;4>Ja;++Ja){var Wl=1&Li;for(wl=Qa=0;4>wl;++wl)fo=fo>>1|(Wl=(ci=C0(Po,Cd,ci=Wl+(1&fo),Xo.Sc,hs,$a,Es))>hs)<<7,Qa=Qa<<2|(3<ci?3:1<ci?2:$a[Es+0]!=0),Es+=16;fo>>=4,Li=Li>>1|Wl<<7,Ri=(Ri<<8|Qa)>>>0}for(Cd=fo,hs=Li>>4,Jo=0;4>Jo;Jo+=2){for(Qa=0,fo=ia.la>>4+Jo,Li=Xs.la>>4+Jo,Ja=0;2>Ja;++Ja){for(Wl=1&Li,wl=0;2>wl;++wl)ci=Wl+(1&fo),fo=fo>>1|(Wl=0<(ci=C0(Po,ms[2],ci,Xo.Qc,0,$a,Es)))<<3,Qa=Qa<<2|(3<ci?3:1<ci?2:$a[Es+0]!=0),Es+=16;fo>>=2,Li=Li>>1|Wl<<5}qa|=Qa<<4*Jo,Cd|=fo<<4<<Jo,hs|=(240&Li)<<Jo}ia.la=Cd,Xs.la=hs,Ys.Hc=Ri,Ys.Gc=qa,Ys.ia=43690&qa?0:Xo.ia,ms=!(Ri|qa)}if(0<Jr.L&&(Jr.wa[Jr.Y+Jr.ja]=Jr.gd[ha.$b][ha.Za],Jr.wa[Jr.Y+Jr.ja].La|=!ms),li.Ka)return At(ka,7,"Premature end-of-file encountered.")}if(Ce(ka),Jr=Mi,li=1,ha=(wn=ka).D,ia=0<wn.L&&wn.M>=wn.zb&&wn.M<=wn.Va,wn.Aa==0)t:{if(ha.M=wn.M,ha.uc=ia,Ma(wn,ha),li=1,ha=(Qa=wn.D).Nb,ia=(qa=Tw[wn.L])*wn.R,Po=qa/2*wn.B,Ja=16*ha*wn.R,wl=8*ha*wn.B,ms=wn.sa,Ys=wn.ta-ia+Ja,Xo=wn.qa,$a=wn.ra-Po+wl,Es=wn.Ha,Xs=wn.Ia-Po+wl,Li=(fo=Qa.M)==0,Ri=fo>=wn.Va-1,wn.Aa==2&&Ma(wn,Qa),Qa.uc)for(Wl=(ci=wn).D.M,t(ci.D.uc),Qa=ci.yb;Qa<ci.Hb;++Qa){hs=Qa,Cd=Wl;var Js=(Hl=(ps=ci).D).Nb;Jo=ps.R;var Hl=Hl.wa[Hl.Y+hs],Gl=ps.sa,jl=ps.ta+16*Js*Jo+16*hs,Kl=Hl.dd,xo=Hl.tc;if(xo!=0)if(t(3<=xo),ps.L==1)0<hs&&Fe(Gl,jl,Jo,xo+4),Hl.La&&xt(Gl,jl,Jo,xo),0<Cd&&ge(Gl,jl,Jo,xo+4),Hl.La&&Ge(Gl,jl,Jo,xo);else{var Yl=ps.B,Pd=ps.qa,Lh=ps.ra+8*Js*Yl+8*hs,Zu=ps.Ha,ps=ps.Ia+8*Js*Yl+8*hs;Js=Hl.ld,0<hs&&(ii(Gl,jl,Jo,xo+4,Kl,Js),Mh(Pd,Lh,Zu,ps,Yl,xo+4,Kl,Js)),Hl.La&&(Rh(Gl,jl,Jo,xo,Kl,Js),Xf(Pd,Lh,Zu,ps,Yl,xo,Kl,Js)),0<Cd&&(zo(Gl,jl,Jo,xo+4,Kl,Js),Nd(Pd,Lh,Zu,ps,Yl,xo+4,Kl,Js)),Hl.La&&(Ju(Gl,jl,Jo,xo,Kl,Js),Sg(Pd,Lh,Zu,ps,Yl,xo,Kl,Js))}}if(wn.ia&&alert("todo:DitherRow"),Jr.put!=null){if(Qa=16*fo,fo=16*(fo+1),Li?(Jr.y=wn.sa,Jr.O=wn.ta+Ja,Jr.f=wn.qa,Jr.N=wn.ra+wl,Jr.ea=wn.Ha,Jr.W=wn.Ia+wl):(Qa-=qa,Jr.y=ms,Jr.O=Ys,Jr.f=Xo,Jr.N=$a,Jr.ea=Es,Jr.W=Xs),Ri||(fo-=qa),fo>Jr.o&&(fo=Jr.o),Jr.F=null,Jr.J=null,wn.Fa!=null&&0<wn.Fa.length&&Qa<fo&&(Jr.J=ar(wn,Jr,Qa,fo-Qa),Jr.F=wn.mb,Jr.F==null&&Jr.F.length==0)){li=At(wn,3,"Could not decode alpha data.");break t}Qa<Jr.j&&(qa=Jr.j-Qa,Qa=Jr.j,t(!(1&qa)),Jr.O+=wn.R*qa,Jr.N+=wn.B*(qa>>1),Jr.W+=wn.B*(qa>>1),Jr.F!=null&&(Jr.J+=Jr.width*qa)),Qa<fo&&(Jr.O+=Jr.v,Jr.N+=Jr.v>>1,Jr.W+=Jr.v>>1,Jr.F!=null&&(Jr.J+=Jr.v),Jr.ka=Qa-Jr.j,Jr.U=Jr.va-Jr.v,Jr.T=fo-Qa,li=Jr.put(Jr))}ha+1!=wn.Ic||Ri||(n(wn.sa,wn.ta-ia,ms,Ys+16*wn.R,ia),n(wn.qa,wn.ra-Po,Xo,$a+8*wn.B,Po),n(wn.Ha,wn.Ia-Po,Es,Xs+8*wn.B,Po))}if(!li)return At(ka,6,"Output aborted.")}return 1}(Re,wt)),wt.bc!=null&&wt.bc(wt),Tt&=1}return Tt?(Re.cb=0,Tt):0})(N,U)||(P=N.a)}}else P=N.a}P==0&&he.Oa!=null&&he.Oa.fd&&(P=Cs(he.ba))}he=P}ue=he!=0?null:11>ue?Ne.f.RGBA.eb:Ne.f.kb.y}else ue=null;return ue};var ER=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(A,M){for(var C="",T=0;T<4;T++)C+=String.fromCharCode(A[M++]);return C}function u(A,M){return A[M+0]|A[M+1]<<8}function f(A,M){return(A[M+0]|A[M+1]<<8|A[M+2]<<16)>>>0}function m(A,M){return(A[M+0]|A[M+1]<<8|A[M+2]<<16|A[M+3]<<24)>>>0}new c;var h=[0],v=[0],g=[],x=new c,y=e,b=function(A,M){var C={},T=0,I=!1,D=0,F=0;if(C.frames=[],!function(B,L){for(var V=0;V<4;V++)if(B[L+V]!="RIFF".charCodeAt(V))return!0;return!1}(A,M)){for(m(A,M+=4),M+=8;M<A.length;){var z=d(A,M),q=m(A,M+=4);M+=4;var $=q+(1&q);switch(z){case"VP8 ":case"VP8L":C.frames[T]===void 0&&(C.frames[T]={}),(fe=C.frames[T]).src_off=I?F:M-8,fe.src_size=D+q+8,T++,I&&(I=!1,D=0,F=0);break;case"VP8X":(fe=C.header={}).feature_flags=A[M];var K=M+4;fe.canvas_width=1+f(A,K),K+=3,fe.canvas_height=1+f(A,K),K+=3;break;case"ALPH":I=!0,D=$+8,F=M-8;break;case"ANIM":(fe=C.header).bgcolor=m(A,M),K=M+4,fe.loop_count=u(A,K),K+=2;break;case"ANMF":var ce,fe;(fe=C.frames[T]={}).offset_x=2*f(A,M),M+=3,fe.offset_y=2*f(A,M),M+=3,fe.width=1+f(A,M),M+=3,fe.height=1+f(A,M),M+=3,fe.duration=f(A,M),M+=3,ce=A[M++],fe.dispose=1&ce,fe.blend=ce>>1&1}z!="ANMF"&&(M+=$)}return C}}(y,0);b.response=y,b.rgbaoutput=!0,b.dataurl=!1;var w=b.header?b.header:null,j=b.frames?b.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],v=[w.canvas_width];for(var _=0;_<j.length&&j[_].blend!=0;_++);}var S=j[0],k=x.WebPDecodeRGBA(y,S.src_off,S.src_size,v,h);S.rgba=k,S.imgwidth=v[0],S.imgheight=h[0];for(var E=0;E<v[0]*h[0]*4;E++)g[E]=k[E];return this.width=v,this.height=h,this.data=g,this}(function(e){var t,r,n,a,i,s,l,c,d,u=function(B){return B=B||{},this.isStrokeTransparent=B.isStrokeTransparent||!1,this.strokeOpacity=B.strokeOpacity||1,this.strokeStyle=B.strokeStyle||"#000000",this.fillStyle=B.fillStyle||"#000000",this.isFillTransparent=B.isFillTransparent||!1,this.fillOpacity=B.fillOpacity||1,this.font=B.font||"10px sans-serif",this.textBaseline=B.textBaseline||"alphabetic",this.textAlign=B.textAlign||"left",this.lineWidth=B.lineWidth||1,this.lineJoin=B.lineJoin||"miter",this.lineCap=B.lineCap||"butt",this.path=B.path||[],this.transform=B.transform!==void 0?B.transform.clone():new c,this.globalCompositeOperation=B.globalCompositeOperation||"normal",this.globalAlpha=B.globalAlpha||1,this.clip_path=B.clip_path||[],this.currentPoint=B.currentPoint||new s,this.miterLimit=B.miterLimit||10,this.lastPoint=B.lastPoint||new s,this.lineDashOffset=B.lineDashOffset||0,this.lineDash=B.lineDash||[],this.margin=B.margin||[0,0,0,0],this.prevPageLastElemOffset=B.prevPageLastElemOffset||0,this.ignoreClearRect=typeof B.ignoreClearRect!="boolean"||B.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var f=function(B){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var L=B;Object.defineProperty(this,"pdf",{get:function(){return L}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(Z){V=!!Z}});var re=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return re},set:function(Z){re=!!Z}});var me=0;Object.defineProperty(this,"posX",{get:function(){return me},set:function(Z){isNaN(Z)||(me=Z)}});var G=0;Object.defineProperty(this,"posY",{get:function(){return G},set:function(Z){isNaN(Z)||(G=Z)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Z){var Y;typeof Z=="number"?Y=[Z,Z,Z,Z]:((Y=new Array(4))[0]=Z[0],Y[1]=Z.length>=2?Z[1]:Y[0],Y[2]=Z.length>=3?Z[2]:Y[0],Y[3]=Z.length>=4?Z[3]:Y[1]),d.margin=Y}});var Q=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Q},set:function(Z){Q=Z}});var ae=0;Object.defineProperty(this,"lastBreak",{get:function(){return ae},set:function(Z){ae=Z}});var J=[];Object.defineProperty(this,"pageBreaks",{get:function(){return J},set:function(Z){J=Z}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Z){Z instanceof u&&(d=Z)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Z){d.path=Z}});var je=[];Object.defineProperty(this,"ctxStack",{get:function(){return je},set:function(Z){je=Z}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Z){var Y;Y=m(Z),this.ctx.fillStyle=Y.style,this.ctx.isFillTransparent=Y.a===0,this.ctx.fillOpacity=Y.a,this.pdf.setFillColor(Y.r,Y.g,Y.b,{a:Y.a}),this.pdf.setTextColor(Y.r,Y.g,Y.b,{a:Y.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Z){var Y=m(Z);this.ctx.strokeStyle=Y.style,this.ctx.isStrokeTransparent=Y.a===0,this.ctx.strokeOpacity=Y.a,Y.a===0?this.pdf.setDrawColor(255,255,255):(Y.a,this.pdf.setDrawColor(Y.r,Y.g,Y.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Z){["butt","round","square"].indexOf(Z)!==-1&&(this.ctx.lineCap=Z,this.pdf.setLineCap(Z))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Z){isNaN(Z)||(this.ctx.lineWidth=Z,this.pdf.setLineWidth(Z))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Z){["bevel","round","miter"].indexOf(Z)!==-1&&(this.ctx.lineJoin=Z,this.pdf.setLineJoin(Z))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Z){isNaN(Z)||(this.ctx.miterLimit=Z,this.pdf.setMiterLimit(Z))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Z){this.ctx.textBaseline=Z}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Z){["right","end","center","left","start"].indexOf(Z)!==-1&&(this.ctx.textAlign=Z)}});var be=null,Ue=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ue},set:function(Z){be=null,Ue=Z}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Z){var Y;if(this.ctx.font=Z,(Y=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Z))!==null){var lt=Y[1];Y[2];var gt=Y[3],Te=Y[4];Y[5];var at=Y[6],yt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Te)[2];Te=Math.floor(yt==="px"?parseFloat(Te)*this.pdf.internal.scaleFactor:yt==="em"?parseFloat(Te)*this.pdf.getFontSize():parseFloat(Te)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Te);var vt=function($e){var Pe,It,Dt=[],kt=$e.trim();if(kt==="")return sE;if(kt in r9)return[r9[kt]];for(;kt!=="";){switch(It=null,Pe=(kt=a9(kt)).charAt(0)){case'"':case"'":It=cQe(kt.substring(1),Pe);break;default:It=dQe(kt)}if(It===null||(Dt.push(It[0]),(kt=a9(It[1]))!==""&&kt.charAt(0)!==","))return sE;kt=kt.replace(/^,/,"")}return Dt}(at);if(this.fontFaces){var Sr=function($e,Pe){if(be===null){var It=function(Dt){var kt=[];return Object.keys(Dt).forEach(function(cr){Dt[cr].forEach(function(Cr){var Ie=null;switch(Cr){case"bold":Ie={family:cr,weight:"bold"};break;case"italic":Ie={family:cr,style:"italic"};break;case"bolditalic":Ie={family:cr,weight:"bold",style:"italic"};break;case"":case"normal":Ie={family:cr}}Ie!==null&&(Ie.ref={name:cr,style:Cr},kt.push(Ie))})}),kt}($e.getFontList());be=function(Dt){for(var kt={},cr=0;cr<Dt.length;++cr){var Cr=iE(Dt[cr]),Ie=Cr.family,ke=Cr.stretch,Je=Cr.style,mt=Cr.weight;kt[Ie]=kt[Ie]||{},kt[Ie][ke]=kt[Ie][ke]||{},kt[Ie][ke][Je]=kt[Ie][ke][Je]||{},kt[Ie][ke][Je][mt]=Cr}return kt}(It.concat(Pe))}return be}(this.pdf,this.fontFaces),se=vt.map(function($e){return{family:$e,stretch:"normal",weight:gt,style:lt}}),Ze=function($e,Pe,It){for(var Dt=(It=It||{}).defaultFontFamily||"times",kt=Object.assign({},lQe,It.genericFontFamilies||{}),cr=null,Cr=null,Ie=0;Ie<Pe.length;++Ie)if(kt[(cr=iE(Pe[Ie])).family]&&(cr.family=kt[cr.family]),$e.hasOwnProperty(cr.family)){Cr=$e[cr.family];break}if(!(Cr=Cr||$e[Dt]))throw new Error("Could not find a font-family for the rule '"+n9(cr)+"' and default family '"+Dt+"'.");if(Cr=function(ke,Je){if(Je[ke])return Je[ke];var mt=y4[ke],Be=mt<=y4.normal?-1:1,$t=t9(Je,Ene,mt,Be);if(!$t)throw new Error("Could not find a matching font-stretch value for "+ke);return $t}(cr.stretch,Cr),Cr=function(ke,Je){if(Je[ke])return Je[ke];for(var mt=Ane[ke],Be=0;Be<mt.length;++Be)if(Je[mt[Be]])return Je[mt[Be]];throw new Error("Could not find a matching font-style for "+ke)}(cr.style,Cr),!(Cr=function(ke,Je){if(Je[ke])return Je[ke];if(ke===400&&Je[500])return Je[500];if(ke===500&&Je[400])return Je[400];var mt=sQe[ke],Be=t9(Je,kne,mt,ke<400?-1:1);if(!Be)throw new Error("Could not find a matching font-weight for value "+ke);return Be}(cr.weight,Cr)))throw new Error("Failed to resolve a font for the rule '"+n9(cr)+"'.");return Cr}(Sr,se);this.pdf.setFont(Ze.ref.name,Ze.ref.style)}else{var ct="";(gt==="bold"||parseInt(gt,10)>=700||lt==="bold")&&(ct="bold"),lt==="italic"&&(ct+="italic"),ct.length===0&&(ct="normal");for(var Qt="",we={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ye=0;ye<vt.length;ye++){if(this.pdf.internal.getFont(vt[ye],ct,{noFallback:!0,disableWarning:!0})!==void 0){Qt=vt[ye];break}if(ct==="bolditalic"&&this.pdf.internal.getFont(vt[ye],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Qt=vt[ye],ct="bold";else if(this.pdf.internal.getFont(vt[ye],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Qt=vt[ye],ct="normal";break}}if(Qt===""){for(var te=0;te<vt.length;te++)if(we[vt[te]]){Qt=we[vt[te]];break}}Qt=Qt===""?"Times":Qt,this.pdf.setFont(Qt,ct)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Z){this.ctx.globalCompositeOperation=Z}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Z){this.ctx.globalAlpha=Z}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Z){this.ctx.lineDashOffset=Z,fe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Z){this.ctx.lineDash=Z,fe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Z){this.ctx.ignoreClearRect=!!Z}})};f.prototype.setLineDash=function(B){this.lineDash=B},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){j.call(this,"fill",!1)},f.prototype.stroke=function(){j.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(B,L){if(isNaN(B)||isNaN(L))throw mo.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new s(B,L));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new s(B,L)},f.prototype.closePath=function(){var B=new s(0,0),L=0;for(L=this.path.length-1;L!==-1;L--)if(this.path[L].type==="begin"&&Aa(this.path[L+1])==="object"&&typeof this.path[L+1].x=="number"){B=new s(this.path[L+1].x,this.path[L+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(B.x,B.y)},f.prototype.lineTo=function(B,L){if(isNaN(B)||isNaN(L))throw mo.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new s(B,L));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new s(V.x,V.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},f.prototype.quadraticCurveTo=function(B,L,V,re){if(isNaN(V)||isNaN(re)||isNaN(B)||isNaN(L))throw mo.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var me=this.ctx.transform.applyToPoint(new s(V,re)),G=this.ctx.transform.applyToPoint(new s(B,L));this.path.push({type:"qct",x1:G.x,y1:G.y,x:me.x,y:me.y}),this.ctx.lastPoint=new s(me.x,me.y)},f.prototype.bezierCurveTo=function(B,L,V,re,me,G){if(isNaN(me)||isNaN(G)||isNaN(B)||isNaN(L)||isNaN(V)||isNaN(re))throw mo.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Q=this.ctx.transform.applyToPoint(new s(me,G)),ae=this.ctx.transform.applyToPoint(new s(B,L)),J=this.ctx.transform.applyToPoint(new s(V,re));this.path.push({type:"bct",x1:ae.x,y1:ae.y,x2:J.x,y2:J.y,x:Q.x,y:Q.y}),this.ctx.lastPoint=new s(Q.x,Q.y)},f.prototype.arc=function(B,L,V,re,me,G){if(isNaN(B)||isNaN(L)||isNaN(V)||isNaN(re)||isNaN(me))throw mo.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(G=!!G,!this.ctx.transform.isIdentity){var Q=this.ctx.transform.applyToPoint(new s(B,L));B=Q.x,L=Q.y;var ae=this.ctx.transform.applyToPoint(new s(0,V)),J=this.ctx.transform.applyToPoint(new s(0,0));V=Math.sqrt(Math.pow(ae.x-J.x,2)+Math.pow(ae.y-J.y,2))}Math.abs(me-re)>=2*Math.PI&&(re=0,me=2*Math.PI),this.path.push({type:"arc",x:B,y:L,radius:V,startAngle:re,endAngle:me,counterclockwise:G})},f.prototype.arcTo=function(B,L,V,re,me){throw new Error("arcTo not implemented.")},f.prototype.rect=function(B,L,V,re){if(isNaN(B)||isNaN(L)||isNaN(V)||isNaN(re))throw mo.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(B,L),this.lineTo(B+V,L),this.lineTo(B+V,L+re),this.lineTo(B,L+re),this.lineTo(B,L),this.lineTo(B+V,L),this.lineTo(B,L)},f.prototype.fillRect=function(B,L,V,re){if(isNaN(B)||isNaN(L)||isNaN(V)||isNaN(re))throw mo.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var me={};this.lineCap!=="butt"&&(me.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(me.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(B,L,V,re),this.fill(),me.hasOwnProperty("lineCap")&&(this.lineCap=me.lineCap),me.hasOwnProperty("lineJoin")&&(this.lineJoin=me.lineJoin)}},f.prototype.strokeRect=function(B,L,V,re){if(isNaN(B)||isNaN(L)||isNaN(V)||isNaN(re))throw mo.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(B,L,V,re),this.stroke())},f.prototype.clearRect=function(B,L,V,re){if(isNaN(B)||isNaN(L)||isNaN(V)||isNaN(re))throw mo.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(B,L,V,re))},f.prototype.save=function(B){B=typeof B!="boolean"||B;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(L),B){this.ctx.fontSize=this.pdf.internal.getFontSize();var re=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=re}},f.prototype.restore=function(B){B=typeof B!="boolean"||B;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(L),B&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(B){var L,V,re,me;if(B.isCanvasGradient===!0&&(B=B.getColor()),!B)return{r:0,g:0,b:0,a:0,style:B};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(B))L=0,V=0,re=0,me=0;else{var G=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(B);if(G!==null)L=parseInt(G[1]),V=parseInt(G[2]),re=parseInt(G[3]),me=1;else if((G=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(B))!==null)L=parseInt(G[1]),V=parseInt(G[2]),re=parseInt(G[3]),me=parseFloat(G[4]);else{if(me=1,typeof B=="string"&&B.charAt(0)!=="#"){var Q=new wne(B);B=Q.ok?Q.toHex():"#000000"}B.length===4?(L=B.substring(1,2),L+=L,V=B.substring(2,3),V+=V,re=B.substring(3,4),re+=re):(L=B.substring(1,3),V=B.substring(3,5),re=B.substring(5,7)),L=parseInt(L,16),V=parseInt(V,16),re=parseInt(re,16)}}return{r:L,g:V,b:re,a:me,style:B}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(B,L,V,re){if(isNaN(L)||isNaN(V)||typeof B!="string")throw mo.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(re=isNaN(re)?void 0:re,!h.call(this)){var me=$(this.ctx.transform.rotation),G=this.ctx.transform.scaleX;T.call(this,{text:B,x:L,y:V,scale:G,angle:me,align:this.textAlign,maxWidth:re})}},f.prototype.strokeText=function(B,L,V,re){if(isNaN(L)||isNaN(V)||typeof B!="string")throw mo.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){re=isNaN(re)?void 0:re;var me=$(this.ctx.transform.rotation),G=this.ctx.transform.scaleX;T.call(this,{text:B,x:L,y:V,scale:G,renderingMode:"stroke",angle:me,align:this.textAlign,maxWidth:re})}},f.prototype.measureText=function(B){if(typeof B!="string")throw mo.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var L=this.pdf,V=this.pdf.internal.scaleFactor,re=L.internal.getFontSize(),me=L.getStringUnitWidth(B)*re/L.internal.scaleFactor;return new function(G){var Q=(G=G||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Q}}),this}({width:me*=Math.round(96*V/72*1e4)/1e4})},f.prototype.scale=function(B,L){if(isNaN(B)||isNaN(L))throw mo.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new c(B,0,0,L,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.rotate=function(B){if(isNaN(B))throw mo.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var L=new c(Math.cos(B),Math.sin(B),-Math.sin(B),Math.cos(B),0,0);this.ctx.transform=this.ctx.transform.multiply(L)},f.prototype.translate=function(B,L){if(isNaN(B)||isNaN(L))throw mo.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new c(1,0,0,1,B,L);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.transform=function(B,L,V,re,me,G){if(isNaN(B)||isNaN(L)||isNaN(V)||isNaN(re)||isNaN(me)||isNaN(G))throw mo.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Q=new c(B,L,V,re,me,G);this.ctx.transform=this.ctx.transform.multiply(Q)},f.prototype.setTransform=function(B,L,V,re,me,G){B=isNaN(B)?1:B,L=isNaN(L)?0:L,V=isNaN(V)?0:V,re=isNaN(re)?1:re,me=isNaN(me)?0:me,G=isNaN(G)?0:G,this.ctx.transform=new c(B,L,V,re,me,G)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(B,L,V,re,me,G,Q,ae,J){var je=this.pdf.getImageProperties(B),be=1,Ue=1,Z=1,Y=1;re!==void 0&&ae!==void 0&&(Z=ae/re,Y=J/me,be=je.width/re*ae/re,Ue=je.height/me*J/me),G===void 0&&(G=L,Q=V,L=0,V=0),re!==void 0&&ae===void 0&&(ae=re,J=me),re===void 0&&ae===void 0&&(ae=je.width,J=je.height);for(var lt,gt=this.ctx.transform.decompose(),Te=$(gt.rotate.shx),at=new c,yt=(at=(at=(at=at.multiply(gt.translate)).multiply(gt.skew)).multiply(gt.scale)).applyToRectangle(new l(G-L*Z,Q-V*Y,re*be,me*Ue)),vt=x.call(this,yt),Sr=[],se=0;se<vt.length;se+=1)Sr.indexOf(vt[se])===-1&&Sr.push(vt[se]);if(w(Sr),this.autoPaging)for(var Ze=Sr[0],ct=Sr[Sr.length-1],Qt=Ze;Qt<ct+1;Qt++){this.pdf.setPage(Qt);var we=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ye=Qt===1?this.posY+this.margin[0]:this.margin[0],te=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$e=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Pe=Qt===1?0:te+(Qt-2)*$e;if(this.ctx.clip_path.length!==0){var It=this.path;lt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(lt,this.posX+this.margin[3],-Pe+ye+this.ctx.prevPageLastElemOffset),_.call(this,"fill",!0),this.path=It}var Dt=JSON.parse(JSON.stringify(yt));Dt=b([Dt],this.posX+this.margin[3],-Pe+ye+this.ctx.prevPageLastElemOffset)[0];var kt=(Qt>Ze||Qt<ct)&&g.call(this);kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],we,$e,null).clip().discardPath()),this.pdf.addImage(B,"JPEG",Dt.x,Dt.y,Dt.w,Dt.h,null,null,Te),kt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(B,"JPEG",yt.x,yt.y,yt.w,yt.h,null,null,Te)};var x=function(B,L,V){var re=[];L=L||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var me=this.posY+this.ctx.prevPageLastElemOffset;switch(B.type){default:case"mt":case"lt":re.push(Math.floor((B.y+me)/V)+1);break;case"arc":re.push(Math.floor((B.y+me-B.radius)/V)+1),re.push(Math.floor((B.y+me+B.radius)/V)+1);break;case"qct":var G=K(this.ctx.lastPoint.x,this.ctx.lastPoint.y,B.x1,B.y1,B.x,B.y);re.push(Math.floor((G.y+me)/V)+1),re.push(Math.floor((G.y+G.h+me)/V)+1);break;case"bct":var Q=ce(this.ctx.lastPoint.x,this.ctx.lastPoint.y,B.x1,B.y1,B.x2,B.y2,B.x,B.y);re.push(Math.floor((Q.y+me)/V)+1),re.push(Math.floor((Q.y+Q.h+me)/V)+1);break;case"rect":re.push(Math.floor((B.y+me)/V)+1),re.push(Math.floor((B.y+B.h+me)/V)+1)}for(var ae=0;ae<re.length;ae+=1)for(;this.pdf.internal.getNumberOfPages()<re[ae];)y.call(this);return re},y=function(){var B=this.fillStyle,L=this.strokeStyle,V=this.font,re=this.lineCap,me=this.lineWidth,G=this.lineJoin;this.pdf.addPage(),this.fillStyle=B,this.strokeStyle=L,this.font=V,this.lineCap=re,this.lineWidth=me,this.lineJoin=G},b=function(B,L,V){for(var re=0;re<B.length;re++)switch(B[re].type){case"bct":B[re].x2+=L,B[re].y2+=V;case"qct":B[re].x1+=L,B[re].y1+=V;default:B[re].x+=L,B[re].y+=V}return B},w=function(B){return B.sort(function(L,V){return L-V})},j=function(B,L){for(var V,re,me=this.fillStyle,G=this.strokeStyle,Q=this.lineCap,ae=this.lineWidth,J=Math.abs(ae*this.ctx.transform.scaleX),je=this.lineJoin,be=JSON.parse(JSON.stringify(this.path)),Ue=JSON.parse(JSON.stringify(this.path)),Z=[],Y=0;Y<Ue.length;Y++)if(Ue[Y].x!==void 0)for(var lt=x.call(this,Ue[Y]),gt=0;gt<lt.length;gt+=1)Z.indexOf(lt[gt])===-1&&Z.push(lt[gt]);for(var Te=0;Te<Z.length;Te++)for(;this.pdf.internal.getNumberOfPages()<Z[Te];)y.call(this);if(w(Z),this.autoPaging)for(var at=Z[0],yt=Z[Z.length-1],vt=at;vt<yt+1;vt++){this.pdf.setPage(vt),this.fillStyle=me,this.strokeStyle=G,this.lineCap=Q,this.lineWidth=J,this.lineJoin=je;var Sr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],se=vt===1?this.posY+this.margin[0]:this.margin[0],Ze=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Qt=vt===1?0:Ze+(vt-2)*ct;if(this.ctx.clip_path.length!==0){var we=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(V,this.posX+this.margin[3],-Qt+se+this.ctx.prevPageLastElemOffset),_.call(this,B,!0),this.path=we}if(re=JSON.parse(JSON.stringify(be)),this.path=b(re,this.posX+this.margin[3],-Qt+se+this.ctx.prevPageLastElemOffset),L===!1||vt===0){var ye=(vt>at||vt<yt)&&g.call(this);ye&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Sr,ct,null).clip().discardPath()),_.call(this,B,L),ye&&this.pdf.restoreGraphicsState()}this.lineWidth=ae}else this.lineWidth=J,_.call(this,B,L),this.lineWidth=ae;this.path=be},_=function(B,L){if((B!=="stroke"||L||!v.call(this))&&(B==="stroke"||L||!h.call(this))){for(var V,re,me=[],G=this.path,Q=0;Q<G.length;Q++){var ae=G[Q];switch(ae.type){case"begin":me.push({begin:!0});break;case"close":me.push({close:!0});break;case"mt":me.push({start:ae,deltas:[],abs:[]});break;case"lt":var J=me.length;if(G[Q-1]&&!isNaN(G[Q-1].x)&&(V=[ae.x-G[Q-1].x,ae.y-G[Q-1].y],J>0)){for(;J>=0;J--)if(me[J-1].close!==!0&&me[J-1].begin!==!0){me[J-1].deltas.push(V),me[J-1].abs.push(ae);break}}break;case"bct":V=[ae.x1-G[Q-1].x,ae.y1-G[Q-1].y,ae.x2-G[Q-1].x,ae.y2-G[Q-1].y,ae.x-G[Q-1].x,ae.y-G[Q-1].y],me[me.length-1].deltas.push(V);break;case"qct":var je=G[Q-1].x+2/3*(ae.x1-G[Q-1].x),be=G[Q-1].y+2/3*(ae.y1-G[Q-1].y),Ue=ae.x+2/3*(ae.x1-ae.x),Z=ae.y+2/3*(ae.y1-ae.y),Y=ae.x,lt=ae.y;V=[je-G[Q-1].x,be-G[Q-1].y,Ue-G[Q-1].x,Z-G[Q-1].y,Y-G[Q-1].x,lt-G[Q-1].y],me[me.length-1].deltas.push(V);break;case"arc":me.push({deltas:[],abs:[],arc:!0}),Array.isArray(me[me.length-1].abs)&&me[me.length-1].abs.push(ae)}}re=L?null:B==="stroke"?"stroke":"fill";for(var gt=!1,Te=0;Te<me.length;Te++)if(me[Te].arc)for(var at=me[Te].abs,yt=0;yt<at.length;yt++){var vt=at[yt];vt.type==="arc"?E.call(this,vt.x,vt.y,vt.radius,vt.startAngle,vt.endAngle,vt.counterclockwise,void 0,L,!gt):I.call(this,vt.x,vt.y),gt=!0}else if(me[Te].close===!0)this.pdf.internal.out("h"),gt=!1;else if(me[Te].begin!==!0){var Sr=me[Te].start.x,se=me[Te].start.y;D.call(this,me[Te].deltas,Sr,se),gt=!0}re&&A.call(this,re),L&&M.call(this)}},S=function(B){var L=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=L*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return B-V;case"top":return B+L-V;case"hanging":return B+L-2*V;case"middle":return B+L/2-V;default:return B}},k=function(B){return B+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var B=function(){};return B.colorStops=[],B.addColorStop=function(L,V){this.colorStops.push([L,V])},B.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},B.isCanvasGradient=!0,B},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var E=function(B,L,V,re,me,G,Q,ae,J){for(var je=z.call(this,V,re,me,G),be=0;be<je.length;be++){var Ue=je[be];be===0&&(J?C.call(this,Ue.x1+B,Ue.y1+L):I.call(this,Ue.x1+B,Ue.y1+L)),F.call(this,B,L,Ue.x2,Ue.y2,Ue.x3,Ue.y3,Ue.x4,Ue.y4)}ae?M.call(this):A.call(this,Q)},A=function(B){switch(B){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},C=function(B,L){this.pdf.internal.out(r(B)+" "+n(L)+" m")},T=function(B){var L;switch(B.align){case"right":case"end":L="right";break;case"center":L="center";break;default:L="left"}var V=this.pdf.getTextDimensions(B.text),re=S.call(this,B.y),me=k.call(this,re)-V.h,G=this.ctx.transform.applyToPoint(new s(B.x,re)),Q=this.ctx.transform.decompose(),ae=new c;ae=(ae=(ae=ae.multiply(Q.translate)).multiply(Q.skew)).multiply(Q.scale);for(var J,je,be,Ue=this.ctx.transform.applyToRectangle(new l(B.x,re,V.w,V.h)),Z=ae.applyToRectangle(new l(B.x,me,V.w,V.h)),Y=x.call(this,Z),lt=[],gt=0;gt<Y.length;gt+=1)lt.indexOf(Y[gt])===-1&&lt.push(Y[gt]);if(w(lt),this.autoPaging)for(var Te=lt[0],at=lt[lt.length-1],yt=Te;yt<at+1;yt++){this.pdf.setPage(yt);var vt=yt===1?this.posY+this.margin[0]:this.margin[0],Sr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],se=this.pdf.internal.pageSize.height-this.margin[2],Ze=se-this.margin[0],ct=this.pdf.internal.pageSize.width-this.margin[1],Qt=ct-this.margin[3],we=yt===1?0:Sr+(yt-2)*Ze;if(this.ctx.clip_path.length!==0){var ye=this.path;J=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(J,this.posX+this.margin[3],-1*we+vt),_.call(this,"fill",!0),this.path=ye}var te=b([JSON.parse(JSON.stringify(Z))],this.posX+this.margin[3],-we+vt+this.ctx.prevPageLastElemOffset)[0];B.scale>=.01&&(je=this.pdf.internal.getFontSize(),this.pdf.setFontSize(je*B.scale),be=this.lineWidth,this.lineWidth=be*B.scale);var $e=this.autoPaging!=="text";if($e||te.y+te.h<=se){if($e||te.y>=vt&&te.x<=ct){var Pe=$e?B.text:this.pdf.splitTextToSize(B.text,B.maxWidth||ct-te.x)[0],It=b([JSON.parse(JSON.stringify(Ue))],this.posX+this.margin[3],-we+vt+this.ctx.prevPageLastElemOffset)[0],Dt=$e&&(yt>Te||yt<at)&&g.call(this);Dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Qt,Ze,null).clip().discardPath()),this.pdf.text(Pe,It.x,It.y,{angle:B.angle,align:L,renderingMode:B.renderingMode}),Dt&&this.pdf.restoreGraphicsState()}}else te.y<se&&(this.ctx.prevPageLastElemOffset+=se-te.y);B.scale>=.01&&(this.pdf.setFontSize(je),this.lineWidth=be)}else B.scale>=.01&&(je=this.pdf.internal.getFontSize(),this.pdf.setFontSize(je*B.scale),be=this.lineWidth,this.lineWidth=be*B.scale),this.pdf.text(B.text,G.x+this.posX,G.y+this.posY,{angle:B.angle,align:L,renderingMode:B.renderingMode,maxWidth:B.maxWidth}),B.scale>=.01&&(this.pdf.setFontSize(je),this.lineWidth=be)},I=function(B,L,V,re){V=V||0,re=re||0,this.pdf.internal.out(r(B+V)+" "+n(L+re)+" l")},D=function(B,L,V){return this.pdf.lines(B,L,V,null,null)},F=function(B,L,V,re,me,G,Q,ae){this.pdf.internal.out([t(a(V+B)),t(i(re+L)),t(a(me+B)),t(i(G+L)),t(a(Q+B)),t(i(ae+L)),"c"].join(" "))},z=function(B,L,V,re){for(var me=2*Math.PI,G=Math.PI/2;L>V;)L-=me;var Q=Math.abs(V-L);Q<me&&re&&(Q=me-Q);for(var ae=[],J=re?-1:1,je=L;Q>1e-5;){var be=je+J*Math.min(Q,G);ae.push(q.call(this,B,je,be)),Q-=Math.abs(be-je),je=be}return ae},q=function(B,L,V){var re=(V-L)/2,me=B*Math.cos(re),G=B*Math.sin(re),Q=me,ae=-G,J=Q*Q+ae*ae,je=J+Q*me+ae*G,be=4/3*(Math.sqrt(2*J*je)-je)/(Q*G-ae*me),Ue=Q-be*ae,Z=ae+be*Q,Y=Ue,lt=-Z,gt=re+L,Te=Math.cos(gt),at=Math.sin(gt);return{x1:B*Math.cos(L),y1:B*Math.sin(L),x2:Ue*Te-Z*at,y2:Ue*at+Z*Te,x3:Y*Te-lt*at,y3:Y*at+lt*Te,x4:B*Math.cos(V),y4:B*Math.sin(V)}},$=function(B){return 180*B/Math.PI},K=function(B,L,V,re,me,G){var Q=B+.5*(V-B),ae=L+.5*(re-L),J=me+.5*(V-me),je=G+.5*(re-G),be=Math.min(B,me,Q,J),Ue=Math.max(B,me,Q,J),Z=Math.min(L,G,ae,je),Y=Math.max(L,G,ae,je);return new l(be,Z,Ue-be,Y-Z)},ce=function(B,L,V,re,me,G,Q,ae){var J,je,be,Ue,Z,Y,lt,gt,Te,at,yt,vt,Sr,se,Ze=V-B,ct=re-L,Qt=me-V,we=G-re,ye=Q-me,te=ae-G;for(je=0;je<41;je++)Te=(lt=(be=B+(J=je/40)*Ze)+J*((Z=V+J*Qt)-be))+J*(Z+J*(me+J*ye-Z)-lt),at=(gt=(Ue=L+J*ct)+J*((Y=re+J*we)-Ue))+J*(Y+J*(G+J*te-Y)-gt),je==0?(yt=Te,vt=at,Sr=Te,se=at):(yt=Math.min(yt,Te),vt=Math.min(vt,at),Sr=Math.max(Sr,Te),se=Math.max(se,at));return new l(Math.round(yt),Math.round(vt),Math.round(Sr-yt),Math.round(se-vt))},fe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var B,L,V=(B=this.ctx.lineDash,L=this.ctx.lineDashOffset,JSON.stringify({lineDash:B,lineDashOffset:L}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(Nn.API),function(e){var t=function(s){var l,c,d,u,f,m,h,v,g,x;for(c=[],d=0,u=(s+=l="\0\0\0\0".slice(s.length%4||4)).length;u>d;d+=4)(f=(s.charCodeAt(d)<<24)+(s.charCodeAt(d+1)<<16)+(s.charCodeAt(d+2)<<8)+s.charCodeAt(d+3))!==0?(m=(f=((f=((f=((f=(f-(x=f%85))/85)-(g=f%85))/85)-(v=f%85))/85)-(h=f%85))/85)%85,c.push(m+33,h+33,v+33,g+33,x+33)):c.push(122);return function(y,b){for(var w=b;w>0;w--)y.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(s){var l,c,d,u,f,m=String,h="length",v=255,g="charCodeAt",x="slice",y="replace";for(s[x](-2),s=s[x](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),d=[],u=0,f=(s+=l="uuuuu"[x](s[h]%5||5))[h];f>u;u+=5)c=52200625*(s[g](u)-33)+614125*(s[g](u+1)-33)+7225*(s[g](u+2)-33)+85*(s[g](u+3)-33)+(s[g](u+4)-33),d.push(v&c>>24,v&c>>16,v&c>>8,v&c);return function(b,w){for(var j=w;j>0;j--)b.pop()}(d,l[h]),m.fromCharCode.apply(m,d)},n=function(s){return s.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(s){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),l.test(s)===!1)return"";for(var c="",d=0;d<s.length;d+=2)c+=String.fromCharCode("0x"+(s[d]+s[d+1]));return c},i=function(s){for(var l=new Uint8Array(s.length),c=s.length;c--;)l[c]=s.charCodeAt(c);return(l=i4(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};e.processDataByFilters=function(s,l){var c=0,d=s||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=a(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(Nn.API),function(e){e.loadFile=function(t,r,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var l=void 0;try{l=function(c,d,u){var f=new XMLHttpRequest,m=0,h=function(v){var g=v.length,x=[],y=String.fromCharCode;for(m=0;m<g;m+=1)x.push(y(255&v.charCodeAt(m)));return x.join("")};if(f.open("GET",c,!d),f.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(f.onload=function(){f.status===200?u(h(this.responseText)):u(void 0)}),f.send(null),d&&f.status===200)return h(f.responseText)}(a,i,s)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Nn.API),function(e){function t(){return(Yn.html2canvas?Promise.resolve(Yn.html2canvas):Iu(()=>import("./html2canvas.esm-f16e60ff.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Yn.DOMPurify?Promise.resolve(Yn.DOMPurify):Iu(()=>import("./purify.es-fd086bfc.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Aa(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},i=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(l(f,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},s=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(l,c){return l.__proto__=c||s.prototype,l},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:a("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},s.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var h=0;h<u.length;++h){var v=u[h],g=v.src.find(function(x){return x.format==="truetype"});g&&d.addFont(g.url,v.ref.name,v.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,d.context2d.save(!0),c(this.prop.container,m)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},s.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},s.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},s.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in s.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},s.prototype.get=function(l,c){return this.then(function(){var d=l in s.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},s.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},s.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||Nn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},s.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,f){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(m){return d.updateProgress(null,u),m}).then(u,f).then(function(m){return d.updateProgress(1),m})})},s.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:s.convert(Object.assign({},u),Promise.prototype),m=d.call(f,l,c);return s.convert(m,u.__proto__)},s.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},s.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},s.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return s.convert(c,this)},s.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},s.prototype.error=function(l){return this.then(function(){throw new Error(l)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Nn.getPageSize=function(l,c,d){if(Aa(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var f,m=(""+d).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var v,g=0,x=0;if(h.hasOwnProperty(m))g=h[m][1]/f,x=h[m][0]/f;else try{g=d[1],x=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",x>g&&(v=x,x=g,g=v);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>x&&(v=x,x=g,g=v)}return{width:x,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(iE):null;var d=new s(c);return c.worker?d:d.from(l).doCallback()}}(Nn.API),Nn.API.addJS=function(e){return i9=e,this.internal.events.subscribe("postPutResources",function(){G2=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(G2+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),o9=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+i9+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){G2!==void 0&&o9!==void 0&&this.internal.out("/Names <</JavaScript "+G2+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],l=n.exec(s);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(i=0;i<d;i++){var f=r.internal.newObject();u.push(f);var m=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var l=this.count=this.count_r({count:0},s);if(l>0&&this.line("/Count "+l),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(Nn.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var m,h=256*f.charCodeAt(4)+f.charCodeAt(5),v=f.length,g={width:0,height:0,numcomponents:1},x=4;x<v;x+=2){if(x+=h,t.indexOf(f.charCodeAt(x+1))!==-1){m=256*f.charCodeAt(x+5)+f.charCodeAt(x+6),g={width:256*f.charCodeAt(x+7)+f.charCodeAt(x+8),height:m,numcomponents:f.charCodeAt(x+9)};break}h=256*f.charCodeAt(x+2)+f.charCodeAt(x+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:a}}return u}}(Nn.API),Nn.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,i=HJe(e,{checkCrc:!0}),s=i.width,l=i.height,c=i.channels,d=i.palette,u=i.depth;a=d&&c===1?function(E){for(var A=E.width,M=E.height,C=E.data,T=E.palette,I=E.depth,D=!1,F=[],z=[],q=void 0,$=!1,K=0,ce=0;ce<T.length;ce++){var fe=ez(T[ce],4),B=fe[0],L=fe[1],V=fe[2],re=fe[3];F.push(B,L,V),re!=null&&(re===0?(K++,z.length<1&&z.push(ce)):re<255&&($=!0))}if($||K>1){D=!0,z=void 0;var me=A*M;q=new Uint8Array(me);for(var G=new DataView(C.buffer),Q=0;Q<me;Q++){var ae=lE(G,Q,I),J=ez(T[ae],4)[3];q[Q]=J}}else K===0&&(z=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:D?8:void 0,colorBytes:C,alphaBytes:q,needSMask:D,palette:F,mask:z}}(i):c===2||c===4?function(E){for(var A=E.data,M=E.width,C=E.height,T=E.channels,I=E.depth,D=T===2?"DeviceGray":"DeviceRGB",F=T-1,z=M*C,q=F,$=z*q,K=1*z,ce=Math.ceil($*I/8),fe=Math.ceil(K*I/8),B=new Uint8Array(ce),L=new Uint8Array(fe),V=new DataView(A.buffer),re=new DataView(B.buffer),me=new DataView(L.buffer),G=!1,Q=0;Q<z;Q++){for(var ae=Q*T,J=0;J<q;J++)p9(re,lE(V,ae+J,I),Q*q+J,I);var je=lE(V,ae+q,I);je<(1<<I)-1&&(G=!0),p9(me,je,1*Q,I)}return{colorSpace:D,colorsPerPixel:F,sMaskBitsPerComponent:G?I:void 0,colorBytes:B,alphaBytes:L,needSMask:G}}(i):function(E){var A=E.data,M=E.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:M,colorsPerPixel:M==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?function(C){for(var T=C.length,I=new Uint8Array(2*T),D=new DataView(I.buffer,I.byteOffset,I.byteLength),F=0;F<T;F++)D.setUint16(2*F,C[F],!1);return I}(A):A,needSMask:!1}}(i);var f,m,h,v=a,g=v.colorSpace,x=v.colorsPerPixel,y=v.sMaskBitsPerComponent,b=v.colorBytes,w=v.alphaBytes,j=v.needSMask,_=v.palette,S=v.mask,k=null;return n!==Nn.API.image_compression.NONE&&typeof i4=="function"?(k=function(E){var A;switch(E){case Nn.API.image_compression.FAST:A=11;break;case Nn.API.image_compression.MEDIUM:A=13;break;case Nn.API.image_compression.SLOW:A=14;break;default:A=12}return A}(n),f=this.decode.FLATE_DECODE,m="/Predictor ".concat(k," /Colors ").concat(x," /BitsPerComponent ").concat(u," /Columns ").concat(s),e=d9(b,Math.ceil(s*x*u/8),x,u,n),j&&(h=d9(w,Math.ceil(s*y/8),1,y,n))):(f=void 0,m=void 0,e=b,j&&(h=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:e,index:t,filter:f,decodeParameters:m,transparency:S,palette:_,sMask:h,predictor:k,width:s,height:l,bitsPerComponent:u,sMaskBitsPerComponent:y,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,a){var i=new hQe(t),s=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:s,height:l},u=new cE(100).encode(d,100);return e.processJPEG.call(this,u,r,n,a)},e.processGIF87A=e.processGIF89A}(Nn.API),Od.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Od.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){mo.log("bit decode error:"+r)}},Od.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[s+4*l]=c.blue,this.data[s+4*l+1]=c.green,this.data[s+4*l+2]=c.red,this.data[s+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Od.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,l=i>>4,c=15&i,d=this.palette[l];if(this.data[s]=d.blue,this.data[s+1]=d.green,this.data[s+2]=d.red,this.data[s+3]=255,2*a+1>=this.width)break;d=this.palette[c],this.data[s+4]=d.blue,this.data[s+4+1]=d.green,this.data[s+4+2]=d.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Od.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Od.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,d=i>>15?255:0,u=n*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=s,this.data[u+3]=d}this.pos+=e}},Od.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&t)/t*255|0,c=(s>>5&r)/r*255|0,d=(s>>11)/t*255|0,u=a*this.width*4+4*i;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=e}},Od.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Od.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=s}},Od.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new Od(t,!1),s=i.width,l=i.height,c={data:i.getData(),width:s,height:l},d=new cE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,a)}}(Nn.API),v9.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new v9(t),s=i.width,l=i.height,c={data:i.getData(),width:s,height:l},d=new cE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,a)}}(Nn.API),Nn.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),l=0,c=0,d=0;d<a;d+=4){var u=n[d],f=n[d+1],m=n[d+2],h=n[d+3];i[l++]=u,i[l++]=f,i[l++]=m,s[c++]=h}var v=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Nn.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Kg=Nn.API,K2=Kg.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,d=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=d.fof?d.fof:1,f=t.doKerning!==!1,m=0,h=e.length,v=0,g=l[0]||c,x=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?x.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(m=f&&Aa(d[n])==="object"&&!isNaN(parseInt(d[n][v],10))?d[n][v]/u:0,x.push((l[n]||g)/c+m)),v=n;return x},s9=Kg.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Kg.processArabic&&(e=Kg.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:K2.apply(this,arguments).reduce(function(i,s){return i+s},0)},l9=function(e,t,r,n){for(var a=[],i=0,s=e.length,l=0;i!==s&&l+t[i]<r;)l+=t[i],i++;a.push(e.slice(0,i));var c=i;for(l=0;i!==s;)l+t[i]>n&&(a.push(e.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&a.push(e.slice(c,i)),a},c9=function(e,t,r){r||(r={});var n,a,i,s,l,c,d,u=[],f=[u],m=r.textIndent||0,h=0,v=0,g=e.split(" "),x=K2.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var y=Array(c).join(" "),b=[];g.map(function(j){(j=j.split(/\s*\n/)).length>1?b=b.concat(j.map(function(_,S){return(S&&_.length?`
`:"")+_})):b.push(j[0])}),g=b,c=s9.apply(this,[y,r])}for(i=0,s=g.length;i<s;i++){var w=0;if(n=g[i],c&&n[0]==`
`&&(n=n.substr(1),w=1),m+h+(v=(a=K2.apply(this,[n,r])).reduce(function(j,_){return j+_},0))>t||w){if(v>t){for(l=l9.apply(this,[n,a,t-(m+h),t]),u.push(l.shift()),u=[l.pop()];l.length;)f.push([l.shift()]);v=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(j,_){return j+_},0)}else u=[n];f.push(u),m=v+c,h=x}else u.push(n),m+=h+v,h=x}return d=c?function(j,_){return(_?y:"")+j.join(" ")}:function(j){return j.join(" ")},f.map(d)},Kg.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),m="Unicode";return f.metadata[m]?{widths:f.metadata[m].widths||{0:1},kerning:f.metadata[m].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(c9.apply(this,[n[l],s,i]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},i=0;i<16;i++)n[r[i]]=t[i],a[t[i]]=r[i];var s=function(m){return"0x"+parseInt(m,10).toString(16)},l=e.__fontmetrics__.compress=function(m){var h,v,g,x,y=["{"];for(var b in m){if(h=m[b],isNaN(parseInt(b,10))?v="'"+b+"'":(b=parseInt(b,10),v=(v=s(b).slice(2)).slice(0,-1)+a[v.slice(-1)]),typeof h=="number")h<0?(g=s(h).slice(3),x="-"):(g=s(h).slice(2),x=""),g=x+g.slice(0,-1)+a[g.slice(-1)];else{if(Aa(h)!=="object")throw new Error("Don't know what to do with value type "+Aa(h)+".");g=l(h)}y.push(v+g)}return y.push("}"),y.join("")},c=e.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,v,g,x,y={},b=1,w=y,j=[],_="",S="",k=m.length-1,E=1;E<k;E+=1)(x=m[E])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(x):x=="{"?(j.push([w,g]),w={},g=void 0):x=="}"?((v=j.pop())[0][v[1]]=w,g=void 0,w=v[0]):x=="-"?b=-1:g===void 0?n.hasOwnProperty(x)?(_+=n[x],g=parseInt(_,16)*b,b=1,_=""):_+=x:n.hasOwnProperty(x)?(S+=n[x],w[g]=parseInt(S,16)*b,b=1,g=void 0,S=""):S+=x;return y},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(m){var h=m.font,v=f.Unicode[h.postScriptName];v&&(h.metadata.Unicode={},h.metadata.Unicode.widths=v.widths,h.metadata.Unicode.kerning=v.kerning);var g=u.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(Nn.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Ij(l)),s.metadata=e.API.TTFFont.open(l),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(Nn),Nn.API.addSvgAsImage=function(e,t,r,n,a,i,s,l){if(isNaN(t)||isNaN(r))throw mo.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw mo.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Yn.canvg?Promise.resolve(Yn.canvg):Iu(()=>import("./index.es-41406c6a.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(u)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,a,s,l)})},Nn.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},Nn.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(s),c=[],d=0,u=0,f=0;function m(v,g){var x,y=!1;for(x=0;x<v.length;x+=1)v[x]===g&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Aa(e)==="object"){for(a in e)if(i=e[a],m(l,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&m(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(d=0;d<i.length;d+=1)if(n=!0,i[d].length===1&&typeof i[d][0]=="number")c.push(String(i[d]-1));else if(i[d].length>1){for(u=0;u<i[d].length;u+=1)typeof i[d][u]!="number"&&(n=!1);n===!0&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,g=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?g.push("/"+v+" /"+r[v].value):g.push("/"+v+" "+r[v].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+s.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Nn.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var l,c=s.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],f=0,m=i.length;f<m;++f){if(l=s.metadata.characterToGlyph(i.charCodeAt(f)),s.metadata.glyIdsUsed.push(l),s.metadata.toUnicode[l]=i.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(s.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(i){var s,l,c,d,u,f,m;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,m=(l=Object.keys(i).sort(function(h,v){return h-v})).length;f<m;f++)s=l[f],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(d=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var l=s.font,c=s.out,d=s.newObject,u=s.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,m=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",v=0;v<m.length;v++)h+=String.fromCharCode(m[v]);var g=d();u({data:h,addLength1:!0,objectId:g}),c("endobj");var x=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var y=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+ov(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+ov(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+ov(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var l=s.font,c=s.out,d=s.newObject,u=s.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,m="",h=0;h<f.length;h++)m+=String.fromCharCode(f[h]);var v=d();u({data:m,addLength1:!0,objectId:v}),c("endobj");var g=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var x=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+v+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+ov(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+ov(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,l=i.text||"",c=i.x,d=i.y,u=i.options||{},f=i.mutex||{},m=f.pdfEscape,h=f.activeFontKey,v=f.fonts,g=h,x="",y=0,b="",w=v[g].encoding;if(v[g].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:f};for(b=l,g=h,Array.isArray(l)&&(b=l[0]),y=0;y<b.length;y+=1)v[g].metadata.hasOwnProperty("cmap")&&(s=v[g].metadata.cmap.unicode.codeMap[b[y].charCodeAt(0)]),s||b[y].charCodeAt(0)<256&&v[g].metadata.hasOwnProperty("Unicode")?x+=b[y]:x+="";var j="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?j=m(x,g).split("").map(function(_){return _.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(j=r(x,v[g])),f.isHex=!0,{text:j,x:c,y:d,options:u,mutex:f}};t.events.push(["postProcessText",function(i){var s=i.text||"",l=[],c={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var d=0;for(d=0;d<s.length;d+=1)Array.isArray(s[d])&&s[d].length===3?l.push([a(Object.assign({},c,{text:s[d][0]})).text,s[d][1],s[d][2]]):l.push(a(Object.assign({},c,{text:s[d]})).text);i.text=l}else i.text=a(Object.assign({},c,{text:s})).text}])}(Nn),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Nn.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,l,c,d,u,f=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var j=function(C){var T=C.charCodeAt(),I=T>>8,D=g[I];return D!==void 0?f[256*D+(255&T)]:I===252||I===253?"AL":y.test(I)?"L":I===8?"R":"N"},_=function(C){for(var T,I=0;I<C.length;I++){if((T=j(C.charAt(I)))==="L")return!1;if(T==="R")return!0}return!1},S=function(C,T,I,D){var F,z,q,$,K=T[D];switch(K){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"N":case"AN":break;case"EN":b&&(K="AN");break;case"AL":b=!0,K="R";break;case"WS":case"BN":K="N";break;case"CS":D<1||D+1>=T.length||(F=I[D-1])!=="EN"&&F!=="AN"||(z=T[D+1])!=="EN"&&z!=="AN"?K="N":b&&(z="AN"),K=z===F?z:"N";break;case"ES":K=(F=D>0?I[D-1]:"B")==="EN"&&D+1<T.length&&T[D+1]==="EN"?"EN":"N";break;case"ET":if(D>0&&I[D-1]==="EN"){K="EN";break}if(b){K="N";break}for(q=D+1,$=T.length;q<$&&T[q]==="ET";)q++;K=q<$&&T[q]==="EN"?"EN":"N";break;case"NSM":if(s&&!l){for($=T.length,q=D+1;q<$&&T[q]==="NSM";)q++;if(q<$){var ce=C[D],fe=ce>=1425&&ce<=2303||ce===64286;if(F=T[q],fe&&(F==="R"||F==="AL")){K="R";break}}}K=D<1||(F=T[D-1])==="B"?"N":I[D-1];break;case"B":b=!1,a=!0,K=w;break;case"S":i=!0,K="N"}return K},k=function(C,T,I){var D=C.split("");return I&&E(D,I,{hiLevel:w}),D.reverse(),T&&T.reverse(),D.join("")},E=function(C,T,I){var D,F,z,q,$,K=-1,ce=C.length,fe=0,B=[],L=w?h:m,V=[];for(b=!1,a=!1,i=!1,F=0;F<ce;F++)V[F]=j(C[F]);for(z=0;z<ce;z++){if($=fe,B[z]=S(C,V,B,z),D=240&(fe=L[$][v[B[z]]]),fe&=15,T[z]=q=L[fe][5],D>0)if(D===16){for(F=K;F<z;F++)T[F]=1;K=-1}else K=-1;if(L[fe][6])K===-1&&(K=z);else if(K>-1){for(F=K;F<z;F++)T[F]=q;K=-1}V[z]==="B"&&(T[z]=0),I.hiLevel|=q}i&&function(re,me,G){for(var Q=0;Q<G;Q++)if(re[Q]==="S"){me[Q]=w;for(var ae=Q-1;ae>=0&&re[ae]==="WS";ae--)me[ae]=w}}(V,T,ce)},A=function(C,T,I,D,F){if(!(F.hiLevel<C)){if(C===1&&w===1&&!a)return T.reverse(),void(I&&I.reverse());for(var z,q,$,K,ce=T.length,fe=0;fe<ce;){if(D[fe]>=C){for($=fe+1;$<ce&&D[$]>=C;)$++;for(K=fe,q=$-1;K<q;K++,q--)z=T[K],T[K]=T[q],T[q]=z,I&&(z=I[K],I[K]=I[q],I[q]=z);fe=$}fe++}}},M=function(C,T,I){var D=C.split(""),F={hiLevel:w};return I||(I=[]),E(D,I,F),function(z,q,$){if($.hiLevel!==0&&u)for(var K,ce=0;ce<z.length;ce++)q[ce]===1&&(K=x.indexOf(z[ce]))>=0&&(z[ce]=x[K+1])}(D,I,F),A(2,D,T,I,F),A(1,D,T,I,F),D.join("")};return this.__bidiEngine__.doBidiReorder=function(C,T,I){if(function(F,z){if(z)for(var q=0;q<F.length;q++)z[q]=q;l===void 0&&(l=_(F)),d===void 0&&(d=_(F))}(C,T),s||!c||d)if(s&&c&&l^d)w=l?1:0,C=k(C,T,I);else if(!s&&c&&d)w=l?1:0,C=M(C,T,I),C=k(C,T);else if(!s||l||c||d){if(s&&!c&&l^d)C=k(C,T),l?(w=0,C=M(C,T,I)):(w=1,C=M(C,T,I),C=k(C,T));else if(s&&l&&!c&&d)w=1,C=M(C,T,I),C=k(C,T);else if(!s&&!c&&l^d){var D=u;l?(w=1,C=M(C,T,I),w=0,u=!1,C=M(C,T,I),u=D):(w=0,C=M(C,T,I),C=k(C,T),w=1,u=!1,C=M(C,T,I),u=D,C=k(C,T))}}else w=0,C=M(C,T,I);else w=l?1:0,C=M(C,T,I);return C},this.__bidiEngine__.setOptions=function(C){C&&(s=C.isInputVisual,c=C.isOutputVisual,l=C.isInputRtl,d=C.isOutputRtl,u=C.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var s=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(s=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?s.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):s.push([r.doBidiReorder(a[l])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(Nn),Nn.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new vh(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new EQe(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new pQe(this.contents),this.head=new vQe(this),this.name=new jQe(this),this.cmap=new Tne(this),this.toUnicode={},this.hhea=new xQe(this),this.maxp=new NQe(this),this.hmtx=new _Qe(this),this.post=new bQe(this),this.os2=new yQe(this),this.loca=new AQe(this),this.glyf=new SQe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,l,c,d;for(d=[],s=0,l=(c=this.bbox).length;s<l;s++)t=c[s],d.push(Math.round(t*this.scaleFactor));return d}.call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,l;for(s=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var su,vh=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),pQe=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,l,c,d,u,f,m,h,v,g;for(g in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),s=Math.floor(f/c),u=16*h-f,(a=new vh).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(s),a.writeShort(u),i=16*h,d=a.pos+i,l=null,v=[],r)for(m=r[g],a.writeString(g),a.writeInt(e(m)),a.writeInt(d),a.writeInt(m.length),v=v.concat(m),g==="head"&&(l=d),d+=m.length;d%4;)v.push(0),d++;return a.write(v),n=2981146554-e(a.data),a.pos=l+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=Ine.call(r);r.length%4;)r.push(0);for(i=new vh(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),gQe={}.hasOwnProperty,Gu=function(e,t){for(var r in t)gQe.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};su=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var vQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new vh).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),x9=function(){function e(t,r){var n,a,i,s,l,c,d,u,f,m,h,v,g,x,y,b,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),m=h/2,t.pos+=6,i=function(){var j,_;for(_=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)_.push(t.readUInt16());return _}(),t.pos+=2,g=function(){var j,_;for(_=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)_.push(t.readUInt16());return _}(),d=function(){var j,_;for(_=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)_.push(t.readUInt16());return _}(),u=function(){var j,_;for(_=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)_.push(t.readUInt16());return _}(),a=(this.length-t.pos+this.offset)/2,l=function(){var j,_;for(_=[],c=j=0;0<=a?j<a:j>a;c=0<=a?++j:--j)_.push(t.readUInt16());return _}(),c=y=0,w=i.length;y<w;c=++y)for(x=i[c],n=b=v=g[c];v<=x?b<=x:b>=x;n=v<=x?++b:--b)u[c]===0?s=n+d[c]:(s=l[u[c]/2+(n-v)-(m-c)]||0)!==0&&(s+=d[c]),this.codeMap[n]=65535&s}t.pos=f}return e.encode=function(t,r){var n,a,i,s,l,c,d,u,f,m,h,v,g,x,y,b,w,j,_,S,k,E,A,M,C,T,I,D,F,z,q,$,K,ce,fe,B,L,V,re,me,G,Q,ae,J,je,be;switch(D=new vh,s=Object.keys(t).sort(function(Ue,Z){return Ue-Z}),r){case"macroman":for(g=0,x=function(){var Ue=[];for(v=0;v<256;++v)Ue.push(0);return Ue}(),b={0:0},i={},F=0,K=s.length;F<K;F++)b[ae=t[a=s[F]]]==null&&(b[ae]=++g),i[a]={old:t[a],new:b[t[a]]},x[a]=b[t[a]];return D.writeUInt16(1),D.writeUInt16(0),D.writeUInt32(12),D.writeUInt16(0),D.writeUInt16(262),D.writeUInt16(0),D.write(x),{charMap:i,subtable:D.data,maxGlyphID:g+1};case"unicode":for(T=[],f=[],w=0,b={},n={},y=d=null,z=0,ce=s.length;z<ce;z++)b[_=t[a=s[z]]]==null&&(b[_]=++w),n[a]={old:_,new:b[_]},l=b[_]-a,y!=null&&l===d||(y&&f.push(y),T.push(a),d=l),y=a;for(y&&f.push(y),f.push(65535),T.push(65535),M=2*(A=T.length),E=2*Math.pow(Math.log(A)/Math.LN2,2),m=Math.log(E/2)/Math.LN2,k=2*A-E,c=[],S=[],h=[],v=q=0,fe=T.length;q<fe;v=++q){if(C=T[v],u=f[v],C===65535){c.push(0),S.push(0);break}if(C-(I=n[C].new)>=32768)for(c.push(0),S.push(2*(h.length+A-v)),a=$=C;C<=u?$<=u:$>=u;a=C<=u?++$:--$)h.push(n[a].new);else c.push(I-C),S.push(0)}for(D.writeUInt16(3),D.writeUInt16(1),D.writeUInt32(12),D.writeUInt16(4),D.writeUInt16(16+8*A+2*h.length),D.writeUInt16(0),D.writeUInt16(M),D.writeUInt16(E),D.writeUInt16(m),D.writeUInt16(k),G=0,B=f.length;G<B;G++)a=f[G],D.writeUInt16(a);for(D.writeUInt16(0),Q=0,L=T.length;Q<L;Q++)a=T[Q],D.writeUInt16(a);for(J=0,V=c.length;J<V;J++)l=c[J],D.writeUInt16(l);for(je=0,re=S.length;je<re;je++)j=S[je],D.writeUInt16(j);for(be=0,me=h.length;be<me;be++)g=h[be],D.writeUInt16(g);return{charMap:n,subtable:D.data,maxGlyphID:w+1}}},e}(),Tne=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new x9(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,a;return r==null&&(r="macroman"),n=x9.encode(t,r),(a=new vh).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},e}(),xQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),yQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),bQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)r=t.readByte(),a.push(this.names.push(t.readString(r)));return a;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=function(){var s,l,c;for(c=[],i=s=0,l=this.file.maxp.numGlyphs;0<=l?s<l:s>l;i=0<=l?++s:--s)c.push(t.readUInt32());return c}.call(this)}},e}(),wQe=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},jQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,a,i,s,l,c,d,u,f,m;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},i=u=0,f=n.length;u<f;i=++u)a=n[i],t.pos=a.offset,d=t.readString(a.length),s=new wQe(d,a),c[m=a.nameID]==null&&(c[m]=[]),c[a.nameID].push(s);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),NQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),_Qe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,a,i,s,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],r=d=0;0<=a?d<a:d>a;r=0<=a?++d:--d)u.push(t.readInt16());return u}(),this.widths=function(){var d,u,f,m;for(m=[],d=0,u=(f=this.metrics).length;d<u;d++)i=f[d],m.push(i.advance);return m}.call(this),n=this.widths[this.widths.length-1],c=[],r=s=0;0<=a?s<a:s>a;r=0<=a?++s:--s)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),Ine=[].slice,SQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,a,i,s,l,c,d,u,f;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,n=i.indexOf(t),(a=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,s=(l=new vh(r.read(a))).readShort(),d=l.readShort(),f=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[t]=s===-1?new PQe(l,d,f,c,u):new CQe(l,s,d,f,c,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var a,i,s,l,c;for(s=[],i=[],l=0,c=r.length;l<c;l++)a=t[r[l]],i.push(s.length),a&&(s=s.concat(a.encode(n)));return i.push(s.length),{table:s,offsets:i}},e}(),CQe=function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),PQe=function(){function e(t,r,n,a,i){var s,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;l=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&l;)s.pos+=1&l?4:2,128&l?s.pos+=8:64&l?s.pos+=4:8&l&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new vh(Ine.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),AQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Gu(e,su),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=2)i.push(2*t.readUInt16());return i}.call(this):function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=4)i.push(t.readUInt32());return i}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),a=0,i=0,s=0;s<n.length;++s)if(n[s]=a,i<r.length&&r[i]==s){++i,n[s]=a;var l=this.offsets[s],c=this.offsets[s+1]-l;c>0&&(a+=c)}for(var d=new Array(4*n.length),u=0;u<n.length;++u)d[4*u+3]=255&n[u],d[4*u+2]=(65280&n[u])>>8,d[4*u+1]=(16711680&n[u])>>16,d[4*u]=(4278190080&n[u])>>24;return d},e}(),EQe=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,l,c;for(a={},s=0,l=t.length;s<l;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,l,c,d,u,f,m,h,v,g,x,y;for(a in n=Tne.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),h={0:0},y=n.charMap)h[(c=y[a]).old]=c.new;for(v in m=n.maxGlyphID,s)v in h||(h[v]=m++);return u=function(b){var w,j;for(w in j={},b)j[b[w]]=w;return j}(h),f=Object.keys(u).sort(function(b,w){return b-w}),g=function(){var b,w,j;for(j=[],b=0,w=f.length;b<w;b++)l=f[b],j.push(u[l]);return j}(),i=this.font.glyf.encode(s,g,h),d=this.font.loca.encode(i.offsets,g),x={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},e}();Nn.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(t.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t}();const kQe=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:iQe,AcroFormAppearance:pn,AcroFormButton:zi,AcroFormCheckBox:rb,AcroFormChoiceField:Dp,AcroFormComboBox:Rp,AcroFormEditBox:eb,AcroFormListBox:Mp,AcroFormPasswordField:nb,AcroFormPushButton:tb,AcroFormRadioButton:Lp,AcroFormTextField:ah,GState:k1,ShadingPattern:Cm,TilingPattern:_p,default:Nn,jsPDF:Nn},Symbol.toStringTag,{value:"Module"})),bi=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,a]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${a}`},gs=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function OQe({setIsModalOpen:e,setBookings:t,form:r,setForm:n,localCustomers:a,onOpenClientModal:i,onClientModalSuccess:s}){const{toast:l}=ro(),{userProfile:c}=Do(),{loadAlerts:d}=JS(),{isPaymentModalOpen:u,closePaymentModal:f,editingBooking:m,paymentTotal:h,setPaymentTotal:v,participantsForm:g,setParticipantsForm:x,payMethods:y,openEditParticipantModal:b,protectPaymentModal:w,onParticipantReplacedRef:j,lastVisibilityChangeTime:_,isModalProtected:S}=AN();window.__protectPaymentModal=w,p.useEffect(()=>(u&&(document.body.style.overflow="auto",document.body.style.pointerEvents="auto"),()=>{document.body.style.overflow="",document.body.style.pointerEvents=""}),[u]);const[k,E]=p.useState(""),[A,M]=p.useState([]);p.useState(null);const[C,T]=p.useState(null),[I,D]=p.useState(!1),[F,z]=p.useState(""),[q,$]=p.useState(!1),[K,ce]=p.useState([]);p.useState(null);const[fe,B]=p.useState(0),[L,V]=p.useState(!1),[re,me]=p.useState(""),[G,Q]=p.useState([]),[ae,J]=p.useState([]),je=p.useRef({}),be=p.useRef({}),Ue=p.useRef({}),[Z,Y]=p.useState(null),[lt,gt]=p.useState(null),[Te,at]=p.useState(!1),[yt,vt]=p.useState("downloading"),[Sr,se]=p.useState(0),[Ze,ct]=p.useState(null),[Qt,we]=p.useState(""),[ye,te]=p.useState(null),$e=p.useRef(null),Pe=p.useRef(null),It=p.useRef(null),Dt=p.useRef(null),kt=p.useRef([]),cr=p.useRef(null),Cr=p.useRef(null),Ie=p.useRef(null),ke=p.useRef(!1),[Je,mt]=p.useState(!1),[Be,$t]=p.useState({isOpen:!1,participantIndex:null,currentStatus:null}),Ee=p.useRef(!1),Ct=p.useCallback((ht,Vt)=>{J(gr=>{const Lt=[...gr];return ht>=0&&ht<Lt.length&&(Vt===""&&Lt[ht].nome?Ue.current[ht]=Lt[ht].nome:Vt!==""&&delete Ue.current[ht],Lt[ht]={...Lt[ht],nome:Vt}),x(Lt),Lt})},[x]),hr=p.useCallback(ht=>{const Vt=Ue.current[ht];Vt&&(J(gr=>{const Lt=[...gr];return ht>=0&&ht<Lt.length&&(Lt[ht]={...Lt[ht],nome:Vt}),delete Ue.current[ht],x(Lt),Lt}),setTimeout(()=>{je.current[ht]?.focus()},0))},[x]),Mr=p.useCallback((ht,Vt,gr)=>{if(Vt==="Pago"){const Lt=gs(gr);if(Number.isFinite(Lt)&&Lt>0)return}Ee.current=!0,console.log(" [StatusConfirmation] Modal protegido por 3 segundos"),setTimeout(()=>{Ee.current=!1,console.log(" [StatusConfirmation] Proteo removida")},3e3),$t({isOpen:!0,participantIndex:ht,currentStatus:Vt})},[]),qr=p.useCallback(ht=>{const{participantIndex:Vt}=Be;Vt!==null&&(J(gr=>{const Lt=[...gr];return Vt>=0&&Vt<Lt.length&&(Lt[Vt]={...Lt[Vt],status_pagamento:ht}),x(Lt),Lt}),ke.current=!0,Cr.current&&clearTimeout(Cr.current),Cr.current=setTimeout(()=>{console.log(" [StatusChange] Salvando mudana de status...")},100),setTimeout(()=>{console.log(" [StatusChange] Recarregando alertas..."),d().catch(gr=>{console.error(" [StatusChange] Erro ao recarregar alertas:",gr)})},500)),$t({isOpen:!1,participantIndex:null,currentStatus:null})},[Be,x,d]),Or=p.useCallback(ht=>!a||!Array.isArray(a)?!1:a.find(gr=>gr.id===ht)?.is_consumidor_final===!0,[a]),Mt=p.useCallback(()=>{const ht=A||[],Vt=(ae||[]).map((Pt,Yr)=>({...Pt,_originalIndex:Yr})).filter(Pt=>!ht.includes(Pt._originalIndex)),gr=Vt.find(Pt=>Or(Pt.cliente_id)&&Pt.nome&&Pt.nome.toLowerCase().includes("cliente consumidor"));return gr?gr._originalIndex:Vt.find(Pt=>Or(Pt.cliente_id)&&Pt.nome)?._originalIndex??null},[ae,A,Or]),Ir=p.useCallback(ht=>{const Vt=A||[],Lt=(ae||[]).map((Yr,Ft)=>({...Yr,_originalIndex:Ft})).filter(Yr=>!Vt.includes(Yr._originalIndex)).filter(Yr=>Or(Yr.cliente_id));if(Lt.length===0)return null;const Pt=Lt.findIndex(Yr=>Yr._originalIndex===ht);return Pt!==-1?Pt<Lt.length-1?Lt[Pt+1]._originalIndex:Lt[0]._originalIndex:null},[ae,A,Or]),Ar=p.useCallback(ht=>{const Vt=A||[],Lt=(ae||[]).map((Yr,Ft)=>({...Yr,_originalIndex:Ft})).filter(Yr=>!Vt.includes(Yr._originalIndex)).filter(Yr=>Or(Yr.cliente_id)),Pt=Lt.findIndex(Yr=>Yr._originalIndex===ht);return Pt>0?Lt[Pt-1]._originalIndex:null},[ae,A,Or]),Zt=p.useCallback(()=>{if(!y||y.length===0)return null;const ht=y.find(Vt=>Vt.codigo_interno==="01");return ht||y[0]},[y]),Kr=p.useMemo(()=>{const ht=ae||[],Vt=A||[];return ht.filter((gr,Lt)=>!Vt.includes(Lt)).length},[ae,A]),Tr=p.useMemo(()=>{const ht=ae||[],Vt=A||[],gr=ht.filter((Kt,vr)=>!Vt.includes(vr)),Lt=gs(h);let Pt=0,Yr=0,Ft=0,jr=!1;gr.forEach(Kt=>{let vr=gs(Kt?.valor_cota);if(Kt?.aplicar_taxa===!0&&Number.isFinite(vr)){const nt=y.find(it=>String(it.id)===String(Kt.finalizadora_id)),qe=Number(nt?.taxa_percentual||0);qe>0&&(vr=vr/(1+qe/100),jr=!0)}Number.isFinite(vr)&&(Pt+=vr),(Kt?.status_pagamento||"Pendente")==="Pago"?Yr++:Ft++});const ot=Number.isFinite(Lt)?Pt-Lt:0;return{totalTarget:Lt,totalAssigned:Pt,diff:ot,paid:Yr,pending:Ft,temTaxaAplicada:jr}},[ae,A,h,y]),dn=()=>{const ht=gs(h);if(!Number.isFinite(ht)||Kr===0)return;const Vt=ht/Kr,gr=bi(String(Vt.toFixed(2)));J(Lt=>{const Pt=[...Lt];return Pt.forEach((Yr,Ft)=>{Pt[Ft]={...Pt[Ft],valor_cota:gr,status_pagamento:"Pago",aplicar_taxa:!1}}),Pt})},Ae=()=>{J(ht=>{const Vt=[...ht];return Vt.forEach((gr,Lt)=>{Vt[Lt]={...Vt[Lt],valor_cota:"",status_pagamento:"Pendente",aplicar_taxa:!1}}),Vt})},pt=()=>{J(ht=>{const Vt=[...ht];return Vt.forEach((gr,Lt)=>{const Pt=gs(gr.valor_cota);if(Pt>0){const Ft=y.find(ot=>String(ot.id)===String(gr.finalizadora_id)),jr=Number(Ft?.taxa_percentual||0);if(jr>0&&!gr.aplicar_taxa){const ot=Pt*(1+jr/100);Vt[Lt]={...Vt[Lt],aplicar_taxa:!0,valor_cota:bi(ot.toFixed(2))}}}}),Vt})},Br=(ht,Vt)=>{b(ht,Vt)},Pr=()=>{me(h||""),V(!0)},Ur=()=>{v(re),V(!1)},Zr=()=>{me(""),V(!1)},cn=async(ht={})=>{const{autoSave:Vt=!1}=ht;try{if(I)return;D(!0);const gr=m?.id,Lt=c?.codigo_empresa;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [SAVE-PAYMENTS] Iniciando salvamento",{autoSave:Vt,agendamentoId:gr,timestamp:new Date().toISOString()})}catch{}if(!gr||!Lt){l({title:"Erro ao salvar pagamentos",description:"Agendamento ou empresa indisponvel.",variant:"destructive"});return}const Pt=ae||[],Yr=Pt.reduce((qe,it)=>{const We=it.status_pagamento||"Pendente";return qe+(We!=="Pago"?1:0)},0);try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Dados a salvar:",{totalParticipantes:Pt.length,pendentes:Yr}),console.log("[ORDER-SAVE] savingIds:",Pt.map(qe=>qe.cliente_id)))}catch{}const Ft=new Date().toISOString();try{localStorage.getItem("debug:agenda")==="1"&&console.log(`

========== SALVAMENTO INICIADO ${Ft} ==========`)}catch{}const{data:jr,error:ot}=await pe.from("agendamento_participantes").select("*").eq("codigo_empresa",Lt).eq("agendamento_id",gr).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(ot)throw console.error(" Erro ao buscar participantes originais:",ot),ot;try{localStorage.getItem("debug:agenda")==="1"&&(console.log(` Participantes originais no banco: ${jr?.length||0}`),console.log("[ORDER-SAVE] originalIds:",(jr||[]).map(qe=>qe.cliente_id)))}catch{}Pt.forEach((qe,it)=>{console.log(`  #${it+1} (novo): ${qe.nome}`)}),console.log(" Fazendo substituio inteligente por posio");for(let qe=0;qe<jr.length;qe++){const it=jr[qe],We=Pt[qe];if(!We){console.log(` Posio #${qe+1}: Sem participante novo, pulando`);continue}const ut=gs(We.valor_cota),At=Zt(),Wt=We.finalizadora_id||(At?.id?String(At.id):null);console.log(` Atualizando posio #${qe+1}: ${it.nome}  ${We.nome}`);const{error:$r}=await pe.from("agendamento_participantes").update({cliente_id:We.cliente_id,nome:We.nome,valor_cota:Number.isFinite(ut)?ut:0,status_pagamento:We.status_pagamento||"Pendente",finalizadora_id:Wt,aplicar_taxa:We.aplicar_taxa||!1,ordem:qe+1}).eq("id",it.id);if($r)throw console.error(` Erro ao atualizar posio #${qe+1}:`,$r),$r}const Kt=jr.length;if(Pt.length>Kt){console.log(" Inserindo participantes adicionais:",Pt.length-Kt);const qe=Pt.slice(Kt).map((We,ut)=>{const At=gs(We.valor_cota),Wt=Zt(),$r=We.finalizadora_id||(Wt?.id?String(Wt.id):null);return{codigo_empresa:Lt,agendamento_id:gr,cliente_id:We.cliente_id,nome:We.nome,valor_cota:Number.isFinite(At)?At:0,status_pagamento:We.status_pagamento||"Pendente",finalizadora_id:$r,aplicar_taxa:We.aplicar_taxa||!1,ordem:Kt+ut+1}}),{error:it}=await pe.from("agendamento_participantes").insert(qe);if(it)throw console.error(" Erro ao inserir novos participantes:",it),it}console.log(" Substituio inteligente concluda"),console.log(`========== SALVAMENTO CONCLUDO ==========

`);const vr=Pt.map(qe=>({id:qe.cliente_id,nome:qe.nome,codigo:qe.codigo!==null&&qe.codigo!==void 0?qe.codigo:null})),X=vr[0]||null,nt=vr.map(qe=>qe?.nome).filter(Boolean);await pe.from("agendamentos").update({cliente_id:X?.id??null,clientes:nt}).eq("codigo_empresa",Lt).eq("id",gr),n(qe=>({...qe,selectedClients:vr})),t(qe=>qe.map(it=>it.id===gr?{...it,customer:X?.nome||it.customer,cliente_id:X?.id??null,clientes:nt}:it)),M([]),Vt||(Yr>0?l({title:"Pagamentos salvos",description:`${Yr} ${Yr===1?"pendente":"pendentes"}`,variant:"warning"}):l({title:"Pagamentos salvos",variant:"success"})),T(null),x(Pt);try{window.dispatchEvent(new CustomEvent("payments:saved",{detail:{agendamentoId:gr,participants:Pt}}))}catch{}d().catch(qe=>{console.error("[PaymentModal] Erro ao recarregar alertas:",qe)});try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Salvamento concludo com sucesso"),console.log(" [SAVE-PAYMENTS] Contagem final de pendentes:",Yr))}catch{}console.log(" [LOG 2 - FECHAR PAYMENT MODAL] Dados salvos no banco:"),console.log("   Total:",Pt.length),console.log("   Pendentes:",Yr),Pt.forEach((qe,it)=>{console.log(`   #${it+1}: ${qe.nome} | Status: ${qe.status_pagamento} | Valor: ${qe.valor_cota}`)}),Vt?console.log(" [SAVE-PAYMENTS] Auto-save concludo - modal permanece aberto"):(console.log(" [SAVE-PAYMENTS] Fechando modal de pagamentos (no  auto-save)"),f(),e(!1))}catch(gr){console.error(" [SAVE-PAYMENTS] Erro ao salvar:",gr),l({title:"Erro ao salvar pagamentos",description:"Tente novamente.",variant:"destructive"})}finally{D(!1)}};p.useEffect(()=>{const ht=Vt=>{if(u&&!q&&!Te&&(Vt.key==="Escape"&&(Vt.preventDefault(),console.log(" [Auto-save Payments] Salvando ao fechar modal (ESC)..."),Cr.current&&clearTimeout(Cr.current),cn({autoSave:!0}).then(()=>{console.log(" [Auto-save Payments] Salvo ao fechar (ESC)!"),f()}).catch(gr=>{console.error(" [Auto-save Payments] Erro ao salvar ao fechar (ESC):",gr),f()})),Vt.key==="F8"&&(Vt.preventDefault(),h&&Kr>0&&dn()),Vt.key==="F9"&&(Vt.preventDefault(),Kr>0&&pt()),Vt.key==="F10"&&(Vt.preventDefault(),Kr>0&&Ae()),Vt.key==="Delete")){const gr=document.activeElement;if(!(gr&&gr.tagName==="INPUT")){Vt.preventDefault();const Pt=Mt();Pt!==null&&(Ct(Pt,""),setTimeout(()=>{je.current[Pt]?.focus()},0))}}};return window.addEventListener("keydown",ht),()=>window.removeEventListener("keydown",ht)},[u,q,Te,h,Kr,dn,pt,Ae,I,cn,f,ae,A,Or,Ct,Mt]),p.useEffect(()=>{if(u){const ht=Mt();Y(ht)}},[u,ae,A,Mt]),p.useEffect(()=>{if(u){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Modal aberto - payMethods:",y?.length||0,"initializedRef:",Pe.current)}catch{}It.current=setTimeout(()=>{try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Timeout de 3s acionado - initializedRef:",Pe.current,"payMethods:",y?.length||0)}catch{}if(!Pe.current&&(!y||y.length===0)){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Inicializando com timeout (sem finalizadoras)")}catch{}const ht=(r?.selectedClients||[]).map(Vt=>{let gr=Vt.codigo;if(gr==null&&a&&Array.isArray(a)){const Lt=a.find(Pt=>Pt.id===Vt.id);gr=Lt?.codigo!==null&&Lt?.codigo!==void 0?Lt.codigo:null}return{cliente_id:Vt.id,nome:Vt.nome,codigo:gr,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:null,aplicar_taxa:!1}});J(ht),Pe.current=Date.now()}},3e3),!Pe.current&&y&&y.length>0&&(It.current&&(clearTimeout(It.current),It.current=null),(async()=>{const{defaultMethod:Vt,defaultFinalizadoraId:gr,defaultAplicarTaxa:Lt}=(()=>{const jr=Zt(),ot=jr?.id?String(jr.id):null,Kt=Number(jr?.taxa_percentual||0)>0;return{defaultMethod:jr,defaultFinalizadoraId:ot,defaultAplicarTaxa:Kt}})();let Pt=[],Yr="nenhuma";if(m?.id)try{const{data:jr,error:ot}=await pe.from("agendamento_participantes").select("*").eq("agendamento_id",m.id).eq("codigo_empresa",c?.codigo_empresa).order("ordem",{ascending:!0}).order("id",{ascending:!0});ot?console.error(" Erro ao buscar participantes:",ot):jr&&jr.length>0?(Pt=jr.map(Kt=>({cliente_id:Kt.cliente_id,nome:Kt.nome,codigo:null,valor_cota:Kt.valor_cota?bi(String(Number(Kt.valor_cota).toFixed(2))):"0,00",status_pagamento:Kt.status_pagamento||"Pendente",finalizadora_id:Kt.finalizadora_id?String(Kt.finalizadora_id):gr,aplicar_taxa:Kt.aplicar_taxa||!1})),Yr="banco de dados"):Yr="banco vazio"}catch(jr){console.error(" Erro ao buscar participantes:",jr)}Pt.length===0&&g&&g.length>0?(Pt=g,Yr="participantsForm (contexto)"):Pt.length===0&&r?.selectedClients&&r.selectedClients.length>0&&(Pt=(r?.selectedClients||[]).map(jr=>{let ot=jr.codigo;if(ot==null&&a&&Array.isArray(a)){const Kt=a.find(vr=>vr.id===jr.id);ot=Kt?.codigo!==null&&Kt?.codigo!==void 0?Kt.codigo:null}return{cliente_id:jr.id,nome:jr.nome,codigo:ot,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:gr,aplicar_taxa:Lt}}),Yr="form.selectedClients");let Ft=Pt.map(jr=>{let ot=jr.codigo;if(ot==null&&a&&Array.isArray(a)){const vr=a.find(X=>X.id===jr.cliente_id);ot=vr?.codigo!==null&&vr?.codigo!==void 0?vr.codigo:null}let Kt=jr.finalizadora_id;if(!Kt){const vr=Zt();Kt=vr?.id?String(vr.id):null}return{...jr,codigo:ot??jr.codigo,finalizadora_id:Kt}});try{const jr=(r?.selectedClients||[]).slice();if(jr.length>0&&Ft.length>0){const ot=new Map;Ft.forEach(qe=>{const it=ot.get(qe.cliente_id)||[];it.push(qe),ot.set(qe.cliente_id,it)});const Kt=new Map,vr=[];for(const qe of jr){const it=Kt.get(qe.id)||0,ut=(ot.get(qe.id)||[])[it];if(ut)vr.push(ut),Kt.set(qe.id,it+1);else{const At=Zt(),Wt=At?.id?String(At.id):null;vr.push({cliente_id:qe.id,nome:qe.nome,codigo:qe.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:Wt,aplicar_taxa:Number(At?.taxa_percentual||0)>0})}}const X=new Map(Kt),nt=[];ot.forEach((qe,it)=>{const We=X.get(it)||0;for(let ut=We;ut<qe.length;ut++)nt.push(qe[ut])}),Pt=vr.concat(nt);try{const qe=Pt.findIndex(it=>String(it?.nome||"").toLowerCase()!=="cliente consumidor");if(qe>0){const it=Pt.splice(qe,1)[0];Pt.unshift(it),localStorage.getItem("debug:agenda")==="1"&&console.log("[REP] Promovido a representante:",it?.nome)}}catch{}Yr=Yr+" (reordenado pelos chips)"}}catch(jr){console.error("[PaymentModal] Falha ao reordenar por chips:",jr)}if(Ft=Pt.map(jr=>{let ot=jr.codigo;if(ot==null&&a&&Array.isArray(a)){const Kt=a.find(vr=>vr.id===jr.cliente_id);ot=Kt?.codigo!==null&&Kt?.codigo!==void 0?Kt.codigo:null}return{...jr,codigo:ot??jr.codigo,finalizadora_id:jr.finalizadora_id||(()=>{const Kt=Zt();return Kt?.id?String(Kt.id):null})()}}),Ft.length===0&&m?.id){console.error(" ALERTA CRTICO: Nenhum participante encontrado em NENHUMA fonte!"),console.error(" Agendamento ID:",m.id),console.error(" Empresa:",c?.codigo_empresa),console.error(" Isso pode indicar perda de dados!");try{const{data:jr,error:ot}=await pe.from("agendamento_participantes").select("*").eq("agendamento_id",m.id);console.error(" Busca sem filtro de empresa:",{encontrados:jr?.length||0,dados:jr,erro:ot})}catch(jr){console.error(" Erro na busca de debug:",jr)}}if(Ft.length>0||!m?.id){J(Ft),Pe.current=Date.now();try{if(localStorage.getItem("debug:agenda")==="1"){console.log(" [LOG 1 - ABRIR PAYMENT MODAL] Participantes carregados:"),console.log("   Total:",Ft.length),console.log("   Fonte:",Yr),Ft.forEach((Kt,vr)=>{console.log(`   #${vr+1}: ${Kt.nome} | Status: ${Kt.status_pagamento} | Valor: ${Kt.valor_cota}`)});const jr=(r?.selectedClients||[]).map(Kt=>Kt.id),ot=Ft.map(Kt=>Kt.cliente_id);console.log("[ORDER] chipsIds:",jr),console.log("[ORDER] finalIds:",ot)}}catch{}}else console.error(" BLOQUEADO: No vou sobrescrever com array vazio!"),console.error(" Mantendo dados anteriores para evitar perda.")})())}else It.current&&(clearTimeout(It.current),It.current=null),E(""),T(null),M([]),J([]);return()=>{It.current&&clearTimeout(It.current)}},[u,y,Zt,g,r?.selectedClients,a]),p.useEffect(()=>{Pe.current=null},[m?.id]),p.useEffect(()=>(j.current=ht=>{Q([ht]),setTimeout(()=>{Q([])},1e3)},()=>{j.current=null}),[j]);const Tn=p.useCallback(ht=>{J(ht)},[]);p.useEffect(()=>(u&&(x.updateLocal=Tn,x.getLocal=()=>ae),()=>{x.updateLocal&&(delete x.updateLocal,delete x.getLocal)}),[u,Tn,ae]),p.useLayoutEffect(()=>{if(!u)return;const ht=(r?.selectedClients||[]).slice();if(ht.length!==0&&!(!ae||ae.length===0))try{const Vt=new Map;ae.forEach(ot=>{const Kt=Vt.get(ot.cliente_id)||[];Kt.push(ot),Vt.set(ot.cliente_id,Kt)});const gr=new Map,Lt=[];for(const ot of ht){const Kt=gr.get(ot.id)||0,X=(Vt.get(ot.id)||[])[Kt];X?(Lt.push(X),gr.set(ot.id,Kt+1)):Lt.push({cliente_id:ot.id,nome:ot.nome,codigo:ot.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:Zt()?.id?String(Zt().id):null,aplicar_taxa:Number(Zt()?.taxa_percentual||0)>0})}const Pt=new Map(gr),Yr=[];Vt.forEach((ot,Kt)=>{const vr=Pt.get(Kt)||0;for(let X=vr;X<ot.length;X++)Yr.push(ot[X])});const Ft=Lt.concat(Yr);if(Ft.length!==ae.length||Ft.some((ot,Kt)=>ot.cliente_id!==ae[Kt]?.cliente_id||ot.nome!==ae[Kt]?.nome)){try{if(localStorage.getItem("debug:agenda")==="1"){const ot=ht.map(vr=>vr.nome),Kt=Ft.map(vr=>vr.nome);console.log("[ORDER] chipsNames:",ot),console.log("[ORDER] finalNames (next):",Kt)}}catch{}J(Ft)}}catch(Vt){console.error("[PaymentModal] Falha ao reordenar aps mudana de chips:",Vt)}},[u,r?.selectedClients]),p.useEffect(()=>{q||(ce([]),z("")),B(0)},[q]),p.useEffect(()=>{q&&kt.current[fe]&&kt.current[fe]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[fe,q]),p.useEffect(()=>{const ht=Vt=>{if(q&&(Vt.key==="Escape"&&(Vt.preventDefault(),$(!1),z(""),ce([])),Vt.key==="Enter"&&Vt.target.tagName!=="INPUT"&&K.length>0)){Vt.preventDefault();const gr=K.map(Lt=>({cliente_id:Lt.id,nome:Lt.nome,codigo:Lt.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const Pt=Zt();return Pt?.id?String(Pt.id):null})(),aplicar_taxa:(()=>{const Pt=Zt();return Number(Pt?.taxa_percentual||0)>0})()}));J(Lt=>{const Pt=Lt.length,Yr=gr.map((Ft,jr)=>Pt+jr);return Q(Yr),setTimeout(()=>{Q([])},1e3),[...Lt,...gr]}),$(!1),ce([]),z("")}};return window.addEventListener("keydown",ht),()=>window.removeEventListener("keydown",ht)},[q,K,Zt,J,l,z,$,ce]),p.useEffect(()=>{const ht=async()=>{try{if(!u)return;Cr.current&&(clearTimeout(Cr.current),Cr.current=null),I||await cn({autoSave:!0})}catch(Vt){console.error("[PaymentModal] save-and-close erro:",Vt)}finally{f();try{window.dispatchEvent(new Event("paymentmodal:closed"))}catch{}}};return window.addEventListener("paymentmodal:save-and-close",ht),()=>window.removeEventListener("paymentmodal:save-and-close",ht)},[u,cn,f]),p.useEffect(()=>{if(!u){console.log(" [AUTO-SAVE] Modal de pagamentos fechado - desabilitando auto-save"),console.log(" [AUTO-SAVE] Estado final ao fechar:",{localParticipantsForm:ae.map(Vt=>({nome:Vt.nome,status:Vt.status_pagamento,valor:Vt.valor_cota})),timestamp:new Date().toISOString()}),ke.current=!1,Ie.current=null;return}if(!ke.current){console.log(" [AUTO-SAVE] Inicializando auto-save (aguardando 500ms)");const Vt=setTimeout(()=>{ke.current=!0,Ie.current=JSON.stringify(ae),console.log(" [AUTO-SAVE] Auto-save habilitado")},500);return()=>clearTimeout(Vt)}const ht=JSON.stringify(ae);if(ht!==Ie.current)return console.log(" [AUTO-SAVE] Mudana detectada - agendando salvamento em 1.5s"),Cr.current&&(console.log(" [AUTO-SAVE] Cancelando auto-save anterior"),clearTimeout(Cr.current)),Cr.current=setTimeout(async()=>{console.log(" [AUTO-SAVE] Iniciando auto-save AGORA"),console.log(" [AUTO-SAVE] Participantes a salvar:",ae.length),mt(!0);try{await cn({autoSave:!0}),Ie.current=ht,console.log(" [AUTO-SAVE] Salvo com sucesso!")}catch(Vt){console.error(" [AUTO-SAVE] Erro ao salvar:",Vt)}finally{mt(!1)}},1500),()=>{Cr.current&&clearTimeout(Cr.current)}},[u,ae,cn]),p.useEffect(()=>{!Te&&ye&&(console.log(" [PDF] Revogando URL do blob ao fechar modal"),URL.revokeObjectURL(ye),te(null))},[Te,ye]);const Qn=p.useRef(null),Sa=async()=>{try{if(console.log(" [PDF] Iniciando gerao do PDF"),!Qn.current)throw new Error("Elemento do relatrio no encontrado");console.log(" [PDF] Abrindo modal de download"),ye&&URL.revokeObjectURL(ye),at(!0),vt("downloading"),se(0),ct(null),te(null),we("");const ht=(ae||[]).filter((Wt,$r)=>!(A||[]).includes($r)),Vt=20,gr=Math.ceil(ht.length/Vt);se(5);const Lt=new Nn({orientation:"landscape",unit:"mm",format:"a4",compress:!0}),Pt=297,Yr=210;for(let Wt=0;Wt<gr;Wt++){const $r=Wt*Vt,W=Math.min($r+Vt,ht.length),Ce=ht.slice($r,W),De=10+Math.floor(Wt/gr*80);se(De);const bt=Qn.current;if(!bt)throw new Error("Elemento do relatrio no encontrado durante a gerao");console.log(` [PDF] Capturando pgina ${Wt+1}/${gr} (participantes ${$r+1}-${W})`);const He={visibility:bt.style.visibility,opacity:bt.style.opacity};bt.style.visibility="visible",bt.style.opacity="1",console.log(` [PDF] Elemento innerHTML length: ${bt.innerHTML.length}`),console.log(` [PDF] Elemento scrollHeight: ${bt.scrollHeight}`),console.log(` [PDF] Elemento scrollWidth: ${bt.scrollWidth}`);const dt=bt.querySelector('div[style*="borderBottom"]'),rr=bt.querySelectorAll('div[style*="borderBottom"]')[1];Wt>0?(dt&&(dt.style.display="none"),rr&&(rr.style.display="none")):(dt&&(dt.style.display="block"),rr&&(rr.style.display="flex"));const Gr=bt.querySelectorAll("tbody tr");console.log(` [PDF] Total de linhas na tabela: ${Gr.length}`),Gr.forEach((tt,Hr)=>{tt.style.display=Hr>=$r&&Hr<W?"table-row":"none"});const Rr=bt.querySelector("#page-indicator");Rr&&(Rr.textContent=`Pgina ${Wt+1} de ${gr}`),console.log(" [PDF] Forando reflow..."),bt.offsetHeight,bt.getBoundingClientRect(),bt.scrollHeight,bt.offsetWidth,bt.clientHeight,console.log(" [PDF] Aguardando renderizao..."),await new Promise(tt=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(tt,2e3)})})})}),console.log(" [PDF] Renderizao completa, iniciando captura...");const br=bt.querySelectorAll("tbody tr");if(console.log(` [PDF] Linhas da tabela encontradas: ${br.length}`),br.forEach((tt,Hr)=>{const un=tt.querySelectorAll("td"),jn=Array.from(un).map(vn=>vn.textContent.trim()).join(" | ");console.log(` [PDF] Linha ${Hr+1}: ${jn}`)}),br.length===0){console.warn(" [PDF] AVISO: Nenhuma linha de tabela encontrada! Verificando estrutura...");const tt=bt.querySelector("tbody");console.log(" [PDF] tbody existe:",!!tt),tt&&console.log(" [PDF] innerHTML do tbody:",tt.innerHTML.substring(0,500))}let wr;try{const tt=bt.scrollHeight,Hr=bt.scrollWidth;if(console.log(` [PDF] Dimenses reais: width=${Hr}px, height=${tt}px`),wr=await AKe(bt,{pixelRatio:2,backgroundColor:"#ffffff",cacheBust:!0,skipFonts:!1}),!wr||wr.length===0)throw new Error("Canvas vazio retornado pela captura");console.log(` [PDF] Pgina ${Wt+1} capturada (${wr.length} bytes, ${tt}px altura, ${br.length} linhas)`)}catch(tt){throw console.error(` [PDF] Erro ao capturar pgina ${Wt+1}:`,tt),bt.style.visibility=He.visibility,bt.style.opacity=He.opacity,new Error(`Falha ao capturar pgina ${Wt+1}: ${tt.message}`)}bt.style.visibility=He.visibility,bt.style.opacity=He.opacity,Wt>0&&Lt.addPage();const or=Pt,tn=bt.scrollHeight/bt.scrollWidth*Pt;Lt.addImage(wr,"PNG",0,0,or,tn,"","MEDIUM"),console.log(` [PDF] Pgina ${Wt+1} adicionada ao PDF (${or}mm x ${tn}mm)`)}if(Qn.current){Qn.current.querySelectorAll("tbody tr").forEach(W=>{W.style.display="table-row"});const $r=Qn.current.querySelector("#page-indicator");$r&&($r.textContent="")}se(95);const Ft=gr>1?` (${gr} pginas)`:"",jr=(ae||[]).filter((Wt,$r)=>!(A||[]).includes($r));let ot=jr.find(Wt=>!a?.find(W=>W.id===Wt.cliente_id)?.is_consumidor_final);!ot&&jr.length>0&&(ot=jr[0]);const vr=(ot?.nome||"sem-nome").trim().split(/\s+/),X=vr[0]||"sem",nt=vr.length>1?vr[vr.length-1]:"nome",it=`rel-${`${X}-${nt}`.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+|-+$/g,"")}-${m?.code||"0"}${Ft}.pdf`,We=Lt.output("blob"),ut=URL.createObjectURL(We);ct(We),te(ut),we(it),se(100);const At=document.createElement("a");At.href=ut,At.download=it,At.click(),await new Promise(Wt=>setTimeout(Wt,500)),console.log(" [PDF] PDF gerado com sucesso! Modal de download deve permanecer aberto."),console.log(" [PDF] isPaymentModalOpen deve continuar true"),vt("success"),console.log(" [PDF] Status atualizado para success")}catch(ht){console.error(" [PDF] Erro ao gerar PDF:",ht),at(!1),l({title:"Erro ao gerar PDF",description:ht?.message||"No foi possvel gerar o PDF.",variant:"destructive"})}};return o.jsxs(o.Fragment,{children:[o.jsx(ln,{open:u,onOpenChange:ht=>{if(console.log(" [PaymentModal] onOpenChange chamado:",{open:ht,isDownloadModalOpen:Te}),!ht){if(console.log(" [PaymentModal] Tentando fechar modal de pagamentos"),Te){console.log(" [PaymentModal] BLOQUEADO: Modal de download est aberto");return}console.log(" [PaymentModal] Fechando modal de pagamentos"),f()}},children:o.jsx(sn,{forceMount:!0,className:"w-full max-w-[95vw] sm:max-w-[1100px] max-h-[90vh] overflow-y-auto overflow-x-hidden",onOpenAutoFocus:ht=>ht.preventDefault(),onInteractOutside:async ht=>{const Vt=Date.now(),gr=Pe.current?Vt-Pe.current:0,Lt=Vt-_;if(console.log(" [PaymentModal] onInteractOutside disparado:",{target:ht.target?.tagName,className:ht.target?.className?.substring?.(0,50),timeSinceInit:`${gr}ms`,timeSinceVisibility:`${Lt}ms`,isAddParticipantOpen:q,isDownloadModalOpen:Te,statusConfirmationOpen:Be.isOpen,isModalProtected:S,timestamp:new Date().toISOString()}),Be.isOpen){console.log(" [PaymentModal] Bloqueado: modal de confirmao de status est aberto"),ht.preventDefault();return}if(Te){console.log(" [PaymentModal] Bloqueado: modal de download est aberto"),ht.preventDefault();return}if(S){console.log(" [PaymentModal] Bloqueado: modal protegido (protectPaymentModal ativo)"),ht.preventDefault();return}if(q){console.log(" [PaymentModal] Bloqueado: modal de adicionar participante aberto"),ht.preventDefault();return}if(Pe.current&&gr<500){console.log(" [PaymentModal] Bloqueado: modal abriu recentemente"),ht.preventDefault();return}if(Lt<3e3){console.log(` [PaymentModal] Bloqueado: mudana de visibilidade recente (${Lt}ms atrs)`),ht.preventDefault();return}ht.preventDefault(),console.log(" [Auto-save Payments] Salvando ao clicar fora do modal...");try{if(Cr.current&&(console.log(" [Auto-save Payments] Cancelando auto-save pendente antes de salvar ao clicar fora"),clearTimeout(Cr.current),Cr.current=null),I){console.log(" [Auto-save Payments] J est salvando - ignorando novo salvamento ao clicar fora"),f();return}await cn({autoSave:!0}),console.log(" [Auto-save Payments] Salvo ao clicar fora!")}catch(Pt){console.error(" [Auto-save Payments] Erro ao salvar ao clicar fora:",Pt)}finally{f()}},onEscapeKeyDown:ht=>{ht.preventDefault()},children:!y||y.length===0?Pe.current?o.jsxs(o.Fragment,{children:[o.jsxs(an,{className:"sr-only",children:[o.jsx(nn,{children:"Aviso"}),o.jsx(_n,{children:"Nenhuma forma de pagamento cadastrada"})]}),o.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[o.jsx(Of,{className:"w-12 h-12 text-amber-500"}),o.jsxs("div",{className:"text-center space-y-2",children:[o.jsx("p",{className:"font-semibold text-amber-500",children:"Nenhuma forma de pagamento cadastrada"}),o.jsx("p",{className:"text-sm text-text-muted",children:"Cadastre pelo menos uma finalizadora para gerenciar pagamentos."})]}),o.jsxs("div",{className:"flex gap-2 mt-4",children:[o.jsx(le,{type:"button",variant:"outline",onClick:f,children:"Fechar"}),o.jsx(LT,{to:"/finalizadoras",children:o.jsx(le,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:f,children:"Cadastrar Finalizadora"})})]})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs(an,{className:"sr-only",children:[o.jsx(nn,{children:"Carregando"}),o.jsx(_n,{children:"Carregando formas de pagamento"})]}),o.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"}),o.jsx("p",{className:"text-sm text-text-muted",children:"Carregando formas de pagamento..."})]})]}):o.jsxs(o.Fragment,{children:[o.jsx(an,{className:"relative pb-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-3 sm:gap-4",children:[o.jsxs("div",{className:"flex-1 w-full sm:w-auto",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(nn,{children:"Registrar pagamento"}),Je&&o.jsxs("span",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs bg-blue-600/10 text-blue-400 border-blue-700/30",children:[o.jsxs("svg",{className:"w-3 h-3 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]})]}),o.jsx(_n,{children:"As alteraes so salvas automaticamente enquanto voc edita."})]}),o.jsxs(le,{type:"button",variant:"outline",size:"sm",onClick:Sa,className:"flex-shrink-0 gap-2 w-full sm:w-auto mt-2 sm:mt-0",title:"Baixar relatrio como imagem",children:[o.jsx(ei,{className:"w-4 h-4"}),o.jsx("span",{children:"Baixar Relatrio"})]})]})}),o.jsxs("div",{className:"space-y-3 sm:space-y-6",children:[o.jsxs("div",{className:"sm:hidden space-y-2 max-w-md mx-auto",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"p-2 rounded-lg bg-emerald-600/10 border border-emerald-500/30 min-w-0 relative group",children:[o.jsx("div",{className:"text-[10px] text-emerald-300/80 mb-1 truncate",children:"Total"}),L?o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(ir,{type:"text",value:re,onChange:ht=>me(bi(ht.target.value)),className:"w-full h-6 text-xs text-center font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300 px-1",placeholder:"0,00",autoFocus:!0,onKeyDown:ht=>{ht.key==="Enter"&&re!==h?Ur():ht.key==="Escape"&&Zr()},onBlur:()=>{re!==h?Ur():Zr()}}),re!==h&&o.jsx("button",{onMouseDown:ht=>ht.preventDefault(),onClick:Ur,className:"p-0.5 rounded hover:bg-emerald-500/20 transition-colors flex-shrink-0",title:"Confirmar",children:o.jsx(Tf,{className:"w-3 h-3 text-emerald-400"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-bold text-emerald-400 truncate",children:bi(h)||"R$ 0,00"}),o.jsx("button",{onClick:Pr,className:"absolute right-1 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-emerald-500/20 transition-colors",title:"Editar",children:o.jsx(ll,{className:"w-3 h-3 text-emerald-400"})})]})]}),o.jsxs("div",{className:`p-2 rounded-lg border min-w-0 ${Tr.diff===0?"bg-emerald-600/10 border-emerald-500/30":Tr.diff>0?"bg-amber-600/10 border-amber-500/30":"bg-rose-600/10 border-rose-500/30"}`,children:[o.jsx("div",{className:`text-[10px] mb-1 truncate ${Tr.diff===0?"text-emerald-300/80":Tr.diff>0?"text-amber-300/80":"text-rose-300/80"}`,children:"Diferena"}),o.jsxs("div",{className:`text-sm font-bold truncate ${Tr.diff===0?"text-emerald-400":Tr.diff>0?"text-amber-400":"text-rose-400"}`,children:[Tr.diff>0?"+":"",bi(String(Math.abs(Tr.diff).toFixed(2)))]})]})]}),o.jsxs("div",{className:"flex gap-1.5 text-xs justify-center",children:[o.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[o.jsx("span",{className:"text-text-secondary",children:"Participantes:"})," ",o.jsx("strong",{children:Kr})]}),o.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[o.jsx("span",{className:"text-text-secondary",children:"Atribudo:"})," ",o.jsxs("strong",{children:["R$ ",Tr.totalAssigned.toFixed(2)]})]}),o.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[o.jsx("span",{className:"text-text-secondary",children:"Alvo:"})," ",o.jsxs("strong",{children:["R$ ",Tr.totalTarget.toFixed(2)]})]})]}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx(le,{type:"button",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white text-xs h-8 px-3",onClick:dn,disabled:!h||Kr===0,children:(()=>{const ht=gs(h);if(Number.isFinite(ht)&&Kr>0){const Vt=ht/Kr;return`Dividir (${bi(String(Vt.toFixed(2)))})`}return"Dividir"})()}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(le,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 text-xs h-8 px-3 flex-1",onClick:pt,disabled:Kr===0,children:"Aplicar taxas"}),o.jsx(le,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 text-xs h-8 px-3 flex-1",onClick:Ae,disabled:Kr===0,children:"Zerar"})]})]})]}),o.jsx("div",{className:"hidden sm:block p-4 rounded-lg border border-border bg-gradient-to-br from-surface-2 to-surface shadow-md",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-start gap-3 w-full",children:[o.jsxs("div",{className:"flex flex-row gap-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx(Ht,{className:"font-bold text-base text-white",children:"Valor total a receber"}),o.jsx("div",{className:"w-[180px] px-3 py-2 rounded-md bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-2 border-emerald-500/40 shadow-lg flex items-center justify-center gap-2 relative group",children:L?o.jsxs(o.Fragment,{children:[o.jsx(ir,{type:"text",value:re,onChange:ht=>me(bi(ht.target.value)),className:"w-full h-8 text-center text-lg font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300",placeholder:"0,00",autoFocus:!0,onKeyDown:ht=>{ht.key==="Enter"&&re!==h?Ur():ht.key==="Escape"&&Zr()},onBlur:()=>{re!==h?Ur():Zr()}}),re!==h&&o.jsx("button",{onMouseDown:ht=>ht.preventDefault(),onClick:Ur,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors",title:"Confirmar (Enter)",children:o.jsx(Tf,{className:"w-4 h-4 text-emerald-400"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-xl font-bold text-emerald-400",children:bi(h)||"R$ 0,00"}),o.jsx("button",{onClick:Pr,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors opacity-0 group-hover:opacity-100",title:"Editar valor total",children:o.jsx(ll,{className:"w-4 h-4 text-emerald-400"})})]})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(Ht,{className:"font-bold text-base text-white",children:"Diferena"}),o.jsx("div",{className:`w-[180px] px-3 py-2 rounded-md border-2 shadow-lg flex items-center justify-center ${Tr.diff===0?"bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-emerald-500/40":Tr.diff>0?"bg-gradient-to-br from-amber-600/20 to-amber-700/20 border-amber-500/40":"bg-gradient-to-br from-rose-600/20 to-rose-700/20 border-rose-500/40"}`,children:o.jsxs("span",{className:`text-xl font-bold ${Tr.diff===0?"text-emerald-400":Tr.diff>0?"text-amber-400":"text-rose-400"}`,children:[Tr.diff>0?"+":"",bi(String(Math.abs(Tr.diff).toFixed(2)))]})})]})]}),o.jsxs("div",{className:"ml-auto flex flex-col gap-3 items-end",children:[o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[o.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),o.jsx("strong",{children:Kr})]}),o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[o.jsx("span",{className:"text-text-secondary",children:"Atribudo:"}),o.jsxs("strong",{children:["R$ ",Tr.totalAssigned.toFixed(2)]})]}),o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[o.jsx("span",{className:"text-text-secondary",children:"Alvo:"}),o.jsxs("strong",{children:["R$ ",Tr.totalTarget.toFixed(2)]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[o.jsx(le,{type:"button",variant:"secondary",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white flex-shrink-0",onClick:dn,disabled:!h||Kr===0,children:(()=>{const ht=gs(h);if(Number.isFinite(ht)&&Kr>0){const Vt=ht/Kr;return o.jsxs(o.Fragment,{children:["Dividir igualmente (",bi(String(Vt.toFixed(2)))," cada)",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})}return o.jsxs(o.Fragment,{children:["Dividir igualmente",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})})()}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(le,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 flex-1 sm:flex-initial whitespace-nowrap",onClick:pt,disabled:Kr===0,children:["Aplicar taxas",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-amber-700/50 rounded border border-amber-500/30",children:"F9"})]}),o.jsxs(le,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 flex-1 sm:flex-initial",onClick:Ae,disabled:Kr===0,children:["Zerar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"F10"})]})]})]})]})]})}),(r.selectedClients||[]).length===0?o.jsx("div",{className:"text-xs text-text-muted italic",children:'Nenhum participante neste agendamento. Adicione participantes no campo "Clientes" do modal principal.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs("div",{className:"relative flex-1 min-w-0",children:[o.jsx(ir,{ref:$e,type:"text",placeholder:"Buscar participante...",value:k,onChange:ht=>E(ht.target.value),className:"pr-16"}),o.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-amber-400 hover:text-amber-300",onClick:()=>{E(""),$e.current?.focus()},children:"limpar"})]}),o.jsxs(le,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md flex-shrink-0",onClick:ht=>{ht.preventDefault(),ht.stopPropagation(),w(2e3),$(!0)},children:[o.jsx("span",{className:"hidden sm:inline",children:"Adicionar participante +"}),o.jsx("span",{className:"sm:hidden",children:"Participante +"})]})]}),C?.type==="pending"&&o.jsxs("div",{role:"alert",className:"mb-2 rounded-md border border-amber-600/40 bg-amber-500/10 px-3 py-2 text-amber-200 flex items-start gap-3",children:[o.jsx(Of,{className:"w-4 h-4 text-amber-300 mt-0.5"}),o.jsxs("div",{className:"flex-1 text-sm",children:[o.jsx("strong",{children:"Ateno:"})," Existem ",o.jsx("strong",{children:C.count})," participante(s) com status ",o.jsx("strong",{children:"Pendente"}),"."]}),o.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded bg-amber-500/20 hover:bg-amber-500/30 border border-amber-600/40",onClick:()=>T(null),children:"Entendi"})]}),o.jsx("div",{className:"border border-border rounded-md overflow-hidden",children:o.jsx("div",{className:"divide-y divide-border max-h-[50vh] overflow-y-scroll",children:(()=>{const ht=k.trim().toLowerCase(),Vt=A||[],Lt=(ae||[]).map((Pt,Yr)=>({...Pt,_originalIndex:Yr})).filter(Pt=>!Vt.includes(Pt._originalIndex)).filter(Pt=>!ht||String(Pt?.nome||"").toLowerCase().includes(ht));return Lt.length===0?o.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum participante com esse nome"}):Lt.map(Pt=>{const Yr=`participant-${Pt._originalIndex}`,Ft=Pt._originalIndex,jr=G.includes(Ft);return o.jsxs("div",{className:`p-2 sm:p-3 border-b last:border-b-0 transition-all duration-500 ease-out ${jr?"bg-white/10":""}`,children:[o.jsxs("div",{className:"sm:hidden space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[Pt.codigo!==null&&Pt.codigo!==void 0&&o.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${Pt.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",Pt.codigo]}),Or(Pt.cliente_id)?o.jsxs("div",{className:"relative flex-1 min-w-0",children:[o.jsx("input",{ref:ot=>{ot&&(je.current[Ft]=ot)},type:"text",value:Pt.nome||"",onChange:ot=>Ct(Ft,ot.target.value),onFocus:()=>gt(Ft),onKeyDown:ot=>{if(ot.key==="Enter"){ot.preventDefault();const Kt=Ir(Ft);Kt!==null&&setTimeout(()=>{je.current[Kt]?.focus()},0)}else if(ot.key==="Delete"&&Pt.nome&&ot.target===document.activeElement)ot.preventDefault(),ot.stopPropagation(),Ct(Ft,""),setTimeout(()=>{je.current[Ft]?.focus()},0);else if(ot.key==="ArrowDown"){ot.preventDefault();const Kt=Ir(Ft);Kt!==null&&setTimeout(()=>{je.current[Kt]?.focus()},0)}else if(ot.key==="ArrowUp"){ot.preventDefault();const Kt=Ar(Ft);Kt!==null&&setTimeout(()=>{je.current[Kt]?.focus()},0)}},onBlur:async()=>{gt(null),!Pt.nome&&Ue.current[Ft]&&hr(Ft);try{Cr.current&&clearTimeout(Cr.current),await cn({autoSave:!0})}catch(ot){console.error("[PaymentModal] Erro ao salvar ao sair do nome consumidor (compacto):",ot)}},placeholder:"Nome do cliente...",className:"font-medium text-sm bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded px-2 py-0.5 pr-11 focus:border-white/30 focus:outline-none focus:ring-1 focus:ring-white/20 w-full",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),Pt.nome?o.jsx("button",{type:"button",onClick:()=>{Ct(Ft,""),setTimeout(()=>{je.current[Ft]?.focus()},0)},className:`absolute right-1 top-1/2 -translate-y-1/2 px-1.5 py-0.5 text-[10px] font-bold border rounded transition-all ${lt===Ft||!lt&&Z===Ft?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/20":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20"}`,title:lt===Ft||!lt&&Z===Ft?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):Ue.current[Ft]?o.jsx("button",{type:"button",onClick:()=>hr(Ft),className:"absolute right-1 top-1/2 -translate-y-1/2 p-1 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all",title:"Restaurar ltimo nome",children:o.jsx(l6,{className:"w-3 h-3"})}):null]}):o.jsx("span",{className:"font-medium text-sm truncate",children:Pt.nome})]}),o.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[o.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>Br(Ft,Pt.nome),title:"Trocar",children:o.jsx(ll,{className:"w-4 h-4"})}),o.jsx(le,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400 h-6 w-6 p-0",onClick:()=>{M(ot=>[...ot,Ft])},children:""})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[o.jsxs("div",{children:[o.jsx(Ht,{className:"text-[10px] text-text-muted",children:"Mtodo"}),o.jsxs(En,{value:String(Pt.finalizadora_id||""),onValueChange:ot=>{J(Kt=>{const vr=[...Kt];if(Ft>=0&&Ft<vr.length){const X=y.find(qe=>String(qe.id)===String(ot)),nt=Number(X?.taxa_percentual||0)>0;vr[Ft]={...vr[Ft],finalizadora_id:ot,aplicar_taxa:nt?vr[Ft].aplicar_taxa??!0:!1}}return vr})},children:[o.jsx(Sn,{className:"h-8 text-xs",children:o.jsx(kn,{placeholder:"Mtodo"})}),o.jsx(Cn,{children:y.map(ot=>o.jsx(Nt,{value:String(ot.id),children:ot.nome||ot.tipo||"Outros"},ot.id))})]}),(()=>{const ot=y.find(nt=>String(nt.id)===String(Pt.finalizadora_id)),Kt=Number(ot?.taxa_percentual||0);if(Kt<=0)return o.jsx("div",{className:"h-4 mt-1"});const vr=gs(Pt.valor_cota),X=Number.isFinite(vr)&&vr>0;return o.jsxs("label",{className:`flex items-center gap-1.5 mt-1 text-[11px] ${X?"cursor-pointer":"cursor-not-allowed opacity-50"}`,title:X?`Taxa de ${Kt.toFixed(2)}%`:"Informe o valor primeiro",children:[o.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:!!Pt.aplicar_taxa,disabled:!X,onChange:nt=>{if(!X){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}J(qe=>{const it=[...qe];if(Ft>=0&&Ft<it.length){const We=nt.target.checked;let ut=vr;We?ut=vr*(1+Kt/100):ut=vr/(1+Kt/100),it[Ft]={...it[Ft],aplicar_taxa:We,valor_cota:bi(ut.toFixed(2))}}return it})},style:{accentColor:"#f59e0b"}}),o.jsxs("span",{className:"text-amber-500 font-medium",children:["Taxa (",Kt.toFixed(2),"%)"]})]})})()]}),o.jsxs("div",{className:"isolate",children:[o.jsx(Ht,{className:"text-[10px] text-text-muted",children:"Valor"}),o.jsx(ir,{ref:ot=>{ot&&(be.current[Ft]=ot)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:bi(Pt.valor_cota),onChange:ot=>{const Kt=bi(ot.target.value),vr=gs(Kt),X=Number.isFinite(vr)&&vr>0?"Pago":"Pendente";J(nt=>{const qe=[...nt];return Ft>=0&&Ft<qe.length&&(qe[Ft]={...qe[Ft],valor_cota:Kt,status_pagamento:X,aplicar_taxa:Kt===""||vr<=0?!1:qe[Ft].aplicar_taxa}),qe})},className:"h-8 text-xs text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})]})]}),o.jsx("div",{className:"flex justify-end",children:(()=>{const ot=Pt.status_pagamento==="Pago",Kt=Number.isFinite(gs(Pt.valor_cota))&&gs(Pt.valor_cota)>0,vr=ot&&Kt;return o.jsx("button",{type:"button",onClick:()=>Mr(Ft,Pt.status_pagamento,Pt.valor_cota),disabled:vr,className:`inline-flex items-center justify-center px-3 py-0.5 rounded text-xs font-medium border transition-all ${ot&&Kt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":ot?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:vr?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:ot?"Pago":"Pendente"})})()})]}),o.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"flex items-center gap-2",children:[Pt.codigo!==null&&Pt.codigo!==void 0&&o.jsxs("span",{className:`text-sm font-bold rounded-md px-2.5 py-1 shadow-sm ${Pt.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",Pt.codigo]}),Or(Pt.cliente_id)?o.jsxs("div",{className:"relative",children:[o.jsx("input",{ref:ot=>{ot&&(je.current[Ft]=ot)},type:"text",value:Pt.nome||"",onChange:ot=>Ct(Ft,ot.target.value),onFocus:()=>gt(Ft),onKeyDown:ot=>{if(ot.key==="Enter"){ot.preventDefault();const Kt=Ir(Ft);Kt!==null&&setTimeout(()=>{je.current[Kt]?.focus()},0)}else if(ot.key==="Delete"&&Pt.nome&&ot.target===document.activeElement)ot.preventDefault(),ot.stopPropagation(),Ct(Ft,""),setTimeout(()=>{je.current[Ft]?.focus()},0);else if(ot.key==="ArrowDown"){ot.preventDefault();const Kt=Ir(Ft);Kt!==null&&setTimeout(()=>{je.current[Kt]?.focus()},0)}else if(ot.key==="ArrowUp"){ot.preventDefault();const Kt=Ar(Ft);Kt!==null&&setTimeout(()=>{je.current[Kt]?.focus()},0)}},onBlur:async()=>{gt(null),!Pt.nome&&Ue.current[Ft]&&hr(Ft);try{Cr.current&&clearTimeout(Cr.current),await cn({autoSave:!0})}catch(ot){console.error("[PaymentModal] Erro ao salvar ao sair do nome consumidor (normal):",ot)}},placeholder:"Nome do cliente...",className:"font-medium text-base bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded-md px-3 py-1.5 pr-14 focus:border-white/30 focus:outline-none focus:ring-2 focus:ring-white/20 min-w-[200px] max-w-[300px]",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),Pt.nome?o.jsx("button",{type:"button",onClick:()=>{Ct(Ft,""),setTimeout(()=>{je.current[Ft]?.focus()},0)},className:`absolute right-2 top-1/2 -translate-y-1/2 px-2 py-1 text-xs font-bold border rounded transition-all ${lt===Ft||!lt&&Z===Ft?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/30":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20 shadow-sm"}`,title:lt===Ft||!lt&&Z===Ft?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):Ue.current[Ft]?o.jsx("button",{type:"button",onClick:()=>hr(Ft),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all shadow-sm",title:"Restaurar ltimo nome",children:o.jsx(l6,{className:"w-4 h-4"})}):null]}):o.jsx("span",{className:"font-medium text-base",children:Pt.nome}),o.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>Br(Ft,Pt.nome),title:"Trocar participante",children:o.jsx(ll,{className:"w-5 h-5"})})]})}),o.jsx("div",{className:"isolate",children:o.jsx(ir,{ref:ot=>{ot&&(be.current[Ft]=ot)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:bi(Pt.valor_cota),onChange:ot=>{const Kt=bi(ot.target.value),vr=gs(Kt),X=Number.isFinite(vr)&&vr>0?"Pago":"Pendente";J(nt=>{const qe=[...nt];return Ft>=0&&Ft<qe.length&&(qe[Ft]={...qe[Ft],valor_cota:Kt,status_pagamento:X,aplicar_taxa:Kt===""||vr<=0?!1:qe[Ft].aplicar_taxa}),qe})},className:"w-28 text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})}),o.jsxs("div",{className:"flex items-center gap-2 min-w-[240px] isolate",children:[o.jsxs(En,{value:String(Pt.finalizadora_id||""),onValueChange:ot=>{J(Kt=>{const vr=[...Kt];if(Ft>=0&&Ft<vr.length){const X=y.find(qe=>String(qe.id)===String(ot)),nt=Number(X?.taxa_percentual||0)>0;vr[Ft]={...vr[Ft],finalizadora_id:ot,aplicar_taxa:nt?vr[Ft].aplicar_taxa??!0:!1}}return vr})},children:[o.jsx(Sn,{className:"w-[140px] flex-shrink-0",children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsx(Cn,{children:y.map(ot=>o.jsx(Nt,{value:String(ot.id),children:ot.nome||ot.tipo||"Outros"},ot.id))})]}),o.jsx("div",{className:"flex-1 min-w-0 isolate",children:(()=>{const ot=y.find(nt=>String(nt.id)===String(Pt.finalizadora_id)),Kt=Number(ot?.taxa_percentual||0);if(Kt<=0)return o.jsx("div",{className:"h-5"});const vr=gs(Pt.valor_cota),X=vr>0;return o.jsxs("label",{className:`flex items-center gap-1.5 text-xs transition-colors ${X?"cursor-pointer hover:text-text-primary":"cursor-not-allowed opacity-50"}`,title:X?`Taxa de ${Kt.toFixed(2)}%`:"Informe o valor primeiro",children:[o.jsx("input",{type:"checkbox",checked:!!Pt.aplicar_taxa,disabled:!X,onChange:nt=>{if(!X){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}J(qe=>{const it=[...qe];if(Ft>=0&&Ft<it.length){const We=nt.target.checked;let ut=vr;We?ut=vr*(1+Kt/100):ut=vr/(1+Kt/100),it[Ft]={...it[Ft],aplicar_taxa:We,valor_cota:bi(ut.toFixed(2))}}return it})},className:`w-4 h-4 rounded border-2 border-amber-500 checked:bg-amber-500 checked:border-amber-500 focus:ring-2 focus:ring-amber-500 focus:ring-offset-1 ${X?"cursor-pointer":"cursor-not-allowed"}`,style:{accentColor:"#f59e0b"}}),o.jsxs("span",{className:"whitespace-nowrap text-amber-500 font-medium",children:["Taxa (",Kt.toFixed(2),"%)"]})]})})()})]}),(()=>{const ot=Pt.status_pagamento==="Pago",Kt=Number.isFinite(gs(Pt.valor_cota))&&gs(Pt.valor_cota)>0,vr=ot&&Kt;return o.jsx("button",{type:"button",onClick:()=>Mr(Ft,Pt.status_pagamento,Pt.valor_cota),disabled:vr,className:`inline-flex items-center justify-center w-[90px] px-3 py-1 rounded text-sm font-medium border transition-all ${ot&&Kt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":ot?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:vr?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:ot?"Pago":"Pendente"})})(),o.jsx(le,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400",onClick:()=>{M(ot=>[...ot,Ft])},children:"Remover"})]})]},Yr)})})()})})]})]}),o.jsx(Un,{className:"gap-2",children:o.jsxs(le,{type:"button",variant:"ghost",className:"border border-white/10",onClick:async()=>{console.log(" [Auto-save Payments] Salvando ao fechar modal...");try{Cr.current&&clearTimeout(Cr.current),await cn({autoSave:!0}),console.log(" [Auto-save Payments] Salvo ao fechar!")}catch(ht){console.error(" [Auto-save Payments] Erro ao salvar ao fechar:",ht)}f()},children:["Fechar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]})})]})})}),o.jsxs("div",{ref:Qn,style:{position:"fixed",left:"0",top:"0",width:"900px",minHeight:"auto",padding:"30px",backgroundColor:"#ffffff !important",color:"#000000 !important",fontFamily:"Arial, sans-serif",opacity:"0",visibility:"hidden",zIndex:"-9999",pointerEvents:"none",overflow:"hidden"},children:[o.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"6px",borderBottom:"2px solid #000",backgroundColor:"#fff",color:"#000"},children:[o.jsx("h1",{style:{fontSize:"18px",fontWeight:"bold",margin:"0 0 6px 0",color:"#000",letterSpacing:"0.5px",textAlign:"center"},children:"RELATRIO DE PAGAMENTOS"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"10px",color:"#000",fontWeight:"600"},children:[o.jsxs("div",{style:{display:"flex",gap:"20px",flex:1},children:[o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Data:"}),o.jsx("span",{style:{marginLeft:"4px"},children:m?.start?new Date(m.start).toLocaleDateString("pt-BR"):"-"})]}),o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Quadra:"}),o.jsx("span",{style:{marginLeft:"4px"},children:m?.court||"-"})]}),o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Cdigo:"}),o.jsx("span",{style:{marginLeft:"4px"},children:m?.code?`#${m.code}`:"-"})]})]}),o.jsxs("div",{style:{display:"flex",gap:"30px",textAlign:"right"},children:[o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Total:"}),o.jsxs("strong",{style:{marginLeft:"4px",color:"#000",fontSize:"11px",display:"inline"},children:["R$ ",bi(h||0)]})]}),o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Diferena:"}),o.jsxs("strong",{style:{marginLeft:"4px",color:Tr.diff<0?"#dc2626":"#16a34a",fontSize:"11px",display:"inline"},children:[Tr.diff<0?"-":"","R$ ",bi(Math.abs(Tr.diff).toFixed(2))]})]})]})]})]}),o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"8px",fontSize:"10px",backgroundColor:"#fff",fontFamily:"Arial, sans-serif",border:"1px solid #000",tableLayout:"fixed"},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{backgroundColor:"#cccccc",borderBottom:"1px solid #000"},children:[o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"5%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"N"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"35%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Nome"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"10%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Cdigo"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Valor"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"20%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Forma"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Status"})]})}),o.jsx("tbody",{children:(()=>(ae||[]).filter((Vt,gr)=>!(A||[]).includes(gr)).map((Vt,gr)=>{const Lt=y?.find(vr=>String(vr.id)===String(Vt.finalizadora_id)),Pt=Vt.status_pagamento==="Pago",Ft=a?.find(vr=>vr.id===Vt.cliente_id)?.is_consumidor_final,ot=(Vt.nome||"Sem nome").trim().split(/\s+/).slice(0,2).join(" "),Kt=Ft?"0":Vt.codigo||"N/A";return o.jsxs("tr",{"data-participant-index":gr,style:{backgroundColor:"#fff"},children:[o.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:gr+1}),o.jsx("td",{style:{padding:"4px 2px",textAlign:"left",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word",overflow:"hidden"},children:ot}),o.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Kt}),o.jsxs("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:["R$ ",bi(Vt.valor_cota||0)]}),o.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Lt?.nome||"N/D"}),o.jsx("td",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:Pt?"#16a34a":"#ca8a04",fontSize:"10px",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Pt?" Pago":" Pendente"})]},`participant-${gr}-${Vt.cliente_id}`)}))()})]}),o.jsx("div",{style:{height:"2px",backgroundColor:"#fff"}}),o.jsxs("div",{style:{marginTop:"2px",textAlign:"center",fontSize:"10px",color:"#000",borderTop:"1px solid #000",paddingTop:"2px",display:"flex",justifyContent:"space-between",backgroundColor:"#fff"},children:[o.jsxs("div",{style:{color:"#000",fontWeight:"500"},children:["Gerado em: ",new Date().toLocaleString("pt-BR")]}),o.jsx("div",{id:"page-indicator",style:{fontSize:"10px",fontWeight:"bold",color:"#000"}})]})]}),o.jsx(ln,{open:q,onOpenChange:ht=>{ht||(ce([]),z("")),$(ht)},children:o.jsxs(sn,{className:"sm:max-w-[500px]",onInteractOutside:ht=>{ht.preventDefault(),w(2e3),$(!1)},children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Adicionar Participante"}),o.jsx(_n,{children:"Selecione um cliente para adicionar aos pagamentos."})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{ref:Dt,placeholder:"Buscar por cdigo ou nome...",value:F,onChange:ht=>{z(ht.target.value),B(0)},onKeyDown:ht=>{const Vt=F.toLowerCase().trim(),gr=(a||[]).filter(jr=>{if(!Vt)return!0;const ot=String(jr.codigo||""),Kt=(jr.nome||"").toLowerCase();return ot.includes(Vt)||Kt.includes(Vt)}),Lt=gr.find(jr=>jr?.is_consumidor_final===!0),Yr=gr.filter(jr=>jr?.is_consumidor_final!==!0).sort((jr,ot)=>{const Kt=jr.codigo||0,vr=ot.codigo||0;return Kt-vr}),Ft=Lt?[Lt,...Yr]:Yr;if(ht.key==="ArrowDown")ht.preventDefault(),B(jr=>Math.min(jr+1,Ft.length-1));else if(ht.key==="ArrowUp")ht.preventDefault(),B(jr=>Math.max(jr-1,0));else if(ht.key==="Enter"&&Ft[fe]){ht.preventDefault();const ot={...Ft[fe],timestamp:Date.now()};ce(Kt=>[...Kt,ot])}},className:"pl-10 pr-10"}),F&&o.jsx("button",{type:"button",onClick:()=>z(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text",children:o.jsx(Dl,{className:"h-4 w-4"})})]}),o.jsx(le,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md",onClick:()=>{i&&(w(15e3),i(()=>{$(!0)}),$(!1),z(""))},children:"+Novo"})]}),o.jsx("div",{ref:cr,className:"border rounded-md max-h-[400px] overflow-y-auto",children:(()=>{const ht=F.toLowerCase().trim(),Vt=(a||[]).filter(Ft=>{if(!ht)return!0;const jr=String(Ft.codigo||""),ot=(Ft.nome||"").toLowerCase();return jr.includes(ht)||ot.includes(ht)}),gr=Vt.find(Ft=>Ft?.is_consumidor_final===!0),Pt=Vt.filter(Ft=>Ft?.is_consumidor_final!==!0).sort((Ft,jr)=>{const ot=Ft.codigo||0,Kt=jr.codigo||0;return ot-Kt}),Yr=gr?[gr,...Pt]:Pt;return Yr.length===0?o.jsx("div",{className:"p-8 text-center text-text-muted",children:"Nenhum cliente encontrado."}):Yr.map((Ft,jr)=>{const ot=Ft?.is_consumidor_final===!0,Kt=K.filter(X=>X.id===Ft.id).length,vr=jr===fe;return o.jsxs("div",{ref:X=>{kt.current[jr]=X},role:"button",tabIndex:0,className:`w-full px-4 py-3 text-left transition-all border-b border-border last:border-0 flex items-center gap-3 cursor-pointer ${vr?"ring-2 ring-blue-500 ring-inset z-10":""} ${ot?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":Kt>0?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>B(jr),onClick:X=>{X.preventDefault(),X.stopPropagation();const nt={...Ft,timestamp:Date.now()};ce(qe=>[...qe,nt])},onKeyDown:X=>{if(X.key==="Enter"||X.key===" "){X.preventDefault();const nt={...Ft,timestamp:Date.now()};ce(qe=>[...qe,nt])}},children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[(()=>Ft.codigo!==null&&Ft.codigo!==void 0?o.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${ot?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",Ft.codigo]}):null)(),o.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[o.jsx("span",{className:`font-medium ${ot?"text-amber-100/90":""}`,children:Ft.nome}),ot&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),Kt>0&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:X=>{X.preventDefault(),X.stopPropagation(),ce(nt=>{const qe=nt.findIndex(it=>it.id===Ft.id);if(qe!==-1){const it=[...nt];return it.splice(qe,1),it}return nt})},children:"-"}),o.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:Kt}),o.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:X=>{X.preventDefault(),X.stopPropagation();const nt={...Ft,timestamp:Date.now()};ce(qe=>[...qe,nt])},children:"+"})]})]},Ft.id)})})()})]}),o.jsxs(Un,{className:"flex items-center justify-between",children:[o.jsx("div",{className:"text-sm text-text-muted",children:K.length>0&&o.jsxs("span",{className:"font-medium",children:[K.length," ",K.length===1?"participante selecionado":"participantes selecionados"]})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(le,{type:"button",variant:"ghost",className:"border border-border",onClick:ht=>{ht.preventDefault(),ht.stopPropagation(),w(1e3),$(!1),z(""),ce([])},children:["Cancelar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),o.jsxs(le,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",disabled:K.length===0,onClick:ht=>{console.log("[AddParticipant] Boto Salvar clicado"),ht.preventDefault(),ht.stopPropagation(),console.log("[AddParticipant] Protegendo modal de pagamentos (3000ms)"),w(3e3),console.log("[AddParticipant] Adicionando participantes:",K.length);const Vt=K.map(gr=>({cliente_id:gr.id,nome:gr.nome,codigo:gr.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const Lt=Zt();return Lt?.id?String(Lt.id):null})(),aplicar_taxa:(()=>{const Lt=Zt();return Number(Lt?.taxa_percentual||0)>0})()}));J(gr=>{const Lt=gr.length,Pt=Vt.map((Yr,Ft)=>Lt+Ft);return Q(Pt),setTimeout(()=>{Q([])},1e3),[...gr,...Vt]}),console.log("[AddParticipant] Fechando modal de adicionar participante"),$(!1),z(""),ce([]),console.log("[AddParticipant] Concludo")},children:["Confirmar (",K.length,")",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})]})}),o.jsx(ln,{open:Te,onOpenChange:ht=>{console.log(" [DownloadModal] onOpenChange chamado:",{open:ht,downloadStatus:yt}),!ht&&yt==="success"?(console.log(" [DownloadModal] Fechando modal de download (sucesso)"),at(!1)):ht||console.log(" [DownloadModal] BLOQUEADO: Ainda baixando")},children:o.jsxs(sn,{className:"sm:max-w-md",onPointerDownOutside:ht=>{yt==="downloading"&&ht.preventDefault()},onEscapeKeyDown:ht=>{yt==="downloading"&&ht.preventDefault()},children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-center",children:yt==="downloading"?"Gerando PDF...":"PDF Gerado com Sucesso!"}),o.jsx(_n,{className:"sr-only",children:yt==="downloading"?"Aguarde enquanto o relatrio de pagamentos est sendo gerado":"Relatrio de pagamentos gerado e baixado com sucesso"})]}),o.jsx("div",{className:"flex flex-col items-center justify-center py-6 space-y-4",children:yt==="downloading"?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-500"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Gerando seu relatrio..."}),o.jsxs("div",{className:"w-full max-w-xs",children:[o.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[o.jsx("span",{children:"Progresso"}),o.jsxs("span",{children:[Sr,"%"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:o.jsx("div",{className:"bg-green-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${Sr}%`}})})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"rounded-full bg-green-100 p-3",children:o.jsx("svg",{className:"w-12 h-12 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),o.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Relatrio baixado com sucesso!"}),o.jsx("p",{className:"text-xs text-gray-400 text-center",children:Qt})]})}),yt==="success"&&o.jsxs("div",{className:"flex flex-col gap-2",children:[navigator.share&&navigator.canShare&&navigator.canShare({files:[]})&&o.jsxs(le,{onClick:async()=>{if(!Ze){l({title:"Arquivo no disponvel",description:"Tente gerar o PDF novamente.",variant:"destructive"});return}try{console.log(" [PDF] Compartilhando via Web Share API...");const ht=new File([Ze],Qt,{type:"application/pdf"});await navigator.share({files:[ht],title:"Relatrio de Pagamentos",text:"Confira o relatrio de pagamentos"}),console.log(" [PDF] Compartilhado com sucesso"),l({title:"Compartilhado com sucesso!",variant:"success"})}catch(ht){if(ht.name==="AbortError"){console.log(" [PDF] Compartilhamento cancelado");return}console.error(" [PDF] Erro ao compartilhar:",ht),l({title:"Erro ao compartilhar",description:ht.message,variant:"destructive"})}},className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Compartilhar"]}),o.jsxs(le,{onClick:()=>{ye?(console.log(" [PDF] Abrindo PDF em nova aba:",ye),window.open(ye,"_blank")):(console.error(" [PDF] URL do blob no disponvel"),l({title:"Erro ao abrir PDF",description:"URL do PDF no est disponvel.",variant:"destructive"}))},className:"w-full bg-green-600 hover:bg-green-700",children:[o.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Abrir PDF"]}),o.jsx("p",{className:"text-xs text-center text-gray-500 px-2",children:"O PDF foi baixado. Abra-o para visualizar, imprimir ou compartilhar."}),o.jsx(le,{onClick:()=>at(!1),variant:"ghost",className:"w-full",children:"Fechar"})]})]})}),o.jsx(ln,{open:Be.isOpen,onOpenChange:ht=>{if(!ht&&Ee.current){console.log(" [StatusConfirmation] Bloqueado onOpenChange (protegido)");return}ht||(console.log(" [StatusConfirmation] Fechando modal via onOpenChange"),$t({isOpen:!1,participantIndex:null,currentStatus:null}))},children:o.jsxs(sn,{className:"w-[95vw] sm:max-w-[400px]",onInteractOutside:ht=>{Ee.current&&(console.log(" [StatusConfirmation] Bloqueado clique fora"),ht.preventDefault())},onEscapeKeyDown:ht=>{Ee.current&&(console.log(" [StatusConfirmation] Bloqueado ESC"),ht.preventDefault())},children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Alterar Status de Pagamento"}),o.jsx(_n,{children:Be.currentStatus==="Pago"?o.jsxs(o.Fragment,{children:["Tem certeza que deseja marcar este participante como ",o.jsx("strong",{children:"Pendente"}),"?"]}):o.jsxs(o.Fragment,{children:["Tem certeza que deseja marcar este participante como ",o.jsx("strong",{children:"Pago"})," mesmo sem valor registrado?"]})})]}),o.jsx("div",{className:"space-y-4",children:o.jsx("div",{className:"p-3 rounded-lg bg-amber-500/10 border border-amber-500/30",children:o.jsx("p",{className:"text-sm text-amber-400",children:Be.currentStatus==="Pago"?o.jsx(o.Fragment,{children:" Esta ao marcar o participante como pendente novamente para refazer o pagamento."}):o.jsx(o.Fragment,{children:" Esta ao marcar o participante como pago sem um valor especfico."})})})}),o.jsxs(Un,{className:"gap-2",children:[o.jsx(le,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{$t({isOpen:!1,participantIndex:null,currentStatus:null})},children:"Cancelar"}),o.jsx(le,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>qr(Be.currentStatus==="Pago"?"Pendente":"Pago"),children:"Confirmar"})]})]})})]})}function TQe({form:e,setForm:t,localCustomers:r}){ro(),Do();const{isEditParticipantModalOpen:n,closeEditParticipantModal:a,editParticipantData:i,participantsForm:s,setParticipantsForm:l,payMethods:c,protectPaymentModal:d,onParticipantReplacedRef:u}=AN(),[f,m]=p.useState(""),[h,v]=p.useState(!1),[g,x]=p.useState(0),y=xe.useRef(null),b=xe.useRef([]),w=xe.useRef(null),j=C=>{const T=i.participantId;if(s[T]?.cliente_id===C.id)return;console.log(" [EditParticipantModal] Substituindo participante:",{de:i.participantName,para:C.nome,indice:T,id_para:C.id});const I=s[T];if(l.updateLocal&&l.getLocal){const D=l.getLocal();if(T>=0&&T<D.length){const F={cliente_id:C.id,nome:C.nome,codigo:C.codigo,valor_cota:I?.valor_cota||"",status_pagamento:I?.status_pagamento||"Pendente",finalizadora_id:I?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:I?.aplicar_taxa||!1},z=[...D];z[T]=F,l.updateLocal(z)}}else l(D=>{if(T<0||T>=D.length)return D;const F={cliente_id:C.id,nome:C.nome,codigo:C.codigo,valor_cota:I?.valor_cota||"",status_pagamento:I?.status_pagamento||"Pendente",finalizadora_id:I?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:I?.aplicar_taxa||!1},z=[...D];return z[T]=F,z});d(3e3),a(),m(""),u?.current&&u.current(T)};if(p.useEffect(()=>{n&&(m(""),v(!1),x(0))},[n]),p.useEffect(()=>{n&&b.current[g]&&b.current[g]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[g,n]),!n)return null;const _=f.trim().toLowerCase(),S=(r||[]).filter(C=>_?String(C?.nome||"").toLowerCase().includes(_):!0),k=S.find(C=>C?.is_consumidor_final===!0),A=S.filter(C=>C?.is_consumidor_final!==!0).sort((C,T)=>{const I=Number(C?.codigo),D=Number(T?.codigo);return Number.isFinite(I)&&Number.isFinite(D)?I-D:String(C?.nome||"").localeCompare(String(T?.nome||""))}),M=k?[k,...A]:A;return o.jsx(ln,{open:n,onOpenChange:C=>{console.log("[EditParticipantModal] onOpenChange:",C),C||(console.log("[EditParticipantModal] Protegendo modal de pagamentos"),d(2e3),a(),m(""))},modal:!0,children:o.jsxs(sn,{className:"sm:max-w-[500px]",onPointerDownOutside:C=>{console.log(" [EditParticipantModal] onPointerDownOutside - prevenindo"),C.preventDefault(),C.stopPropagation()},onInteractOutside:C=>{console.log(" [EditParticipantModal] onInteractOutside - prevenindo"),C.preventDefault(),C.stopPropagation(),d(2e3)},children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Trocar Participante"}),o.jsxs(_n,{children:["Substituindo: ",o.jsx("strong",{children:i.participantName})]})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"edit-participant-search",children:"Buscar cliente"}),o.jsx(ir,{ref:y,id:"edit-participant-search",type:"text",placeholder:"Digite o nome do cliente...",value:f,onChange:C=>{m(C.target.value),x(0)},onKeyDown:C=>{if(C.key==="ArrowDown")C.preventDefault(),x(T=>Math.min(T+1,M.length-1));else if(C.key==="ArrowUp")C.preventDefault(),x(T=>Math.max(T-1,0));else if(C.key==="Enter"&&M[g]){C.preventDefault();const T=M[g],I=i.participantId;s[I]?.cliente_id===T.id||(d(2e3),j(T))}},className:"mt-1",autoFocus:!0})]}),o.jsx("div",{ref:w,className:"border border-border rounded-md max-h-[300px] overflow-y-auto",children:h?o.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Carregando clientes..."}):M.length===0?o.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:_?"Nenhum cliente encontrado":"Nenhum cliente cadastrado"}):M.map((C,T)=>{const I=i.participantId,D=s[I]?.cliente_id===C.id,F=C?.is_consumidor_final===!0,z=T===g;return o.jsxs("button",{ref:q=>{b.current[T]=q},type:"button",className:Jt(z&&"ring-2 ring-blue-500 ring-inset z-10","w-full px-4 py-3 text-left transition-all","border-b border-border last:border-b-0","flex items-center gap-3",D&&"bg-brand/10 cursor-not-allowed opacity-60",!D&&F&&"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40",!D&&!F&&"hover:bg-surface-2"),disabled:D,onMouseEnter:()=>x(T),onClick:q=>{q.preventDefault(),q.stopPropagation(),console.log("[EditParticipantModal] Cliente selecionado - protegendo modal"),d(2e3),j(C)},children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[C.codigo!==null&&C.codigo!==void 0&&o.jsxs("span",{className:Jt("inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors",F&&"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20",!F&&"bg-emerald-600/20 text-emerald-400"),children:["#",C.codigo]}),o.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[o.jsx("span",{className:Jt("font-medium",F&&"text-amber-100/90"),children:C.nome}),F&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),D&&o.jsx("span",{className:"text-xs text-brand font-medium",children:"Atual"})]},C.id)})})]}),o.jsx(Un,{children:o.jsx(le,{type:"button",variant:"ghost",className:"border border-white/10",onClick:C=>{console.log(" [EditParticipantModal] ========== BOTO CANCELAR CLICADO =========="),console.log(" [EditParticipantModal] preventDefault()"),C.preventDefault(),console.log(" [EditParticipantModal] stopPropagation()"),C.stopPropagation(),console.log(" [EditParticipantModal] Protegendo modal de pagamentos (2000ms)"),d(2e3),console.log(" [EditParticipantModal] Fechando modal de editar participante"),a(),console.log(" [EditParticipantModal] Limpando busca"),m(""),console.log(" [EditParticipantModal] ========== CANCELAR CONCLUDO ==========")},children:"Cancelar"})})]})})}const IQe=e=>e?e.trim().split(/\s+/).slice(0,2).join(" "):"",cm=56,dE=30,DQe=6,MQe=24;function RQe({weekStart:e,weekBookings:t,activeCourtFilter:r,courtsMap:n,participantsByAgendamento:a,onBookingClick:i,onSlotClick:s,statusConfig:l,dayStartHour:c=DQe,dayEndHourExclusive:d=MQe,weekDiasFuncionamento:u={},sidebarVisible:f=!1}){const m=p.useRef(null),h=p.useRef(null),[v,g]=xe.useState(0),[x,y]=xe.useState(window.innerWidth<768);xe.useEffect(()=>{const E=()=>{y(window.innerWidth<768)};return window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const b=p.useMemo(()=>Array.from({length:7},(E,A)=>Oa(e,A)),[e]);p.useEffect(()=>{const E=()=>{h.current&&m.current&&(m.current.scrollLeft=h.current.scrollLeft)},A=()=>{m.current&&h.current&&(h.current.scrollLeft=m.current.scrollLeft)},M=()=>{if(h.current){const I=h.current.scrollHeight>h.current.clientHeight;g(I?17:0)}},C=h.current,T=m.current;return C&&C.addEventListener("scroll",E),T&&T.addEventListener("scroll",A),M(),window.addEventListener("resize",M),()=>{C&&C.removeEventListener("scroll",E),T&&T.removeEventListener("scroll",A),window.removeEventListener("resize",M)}},[]);const w=p.useMemo(()=>{if(r&&n[r]){const E=n[r],A=E.hora_inicio||`${c}:00:00`,M=E.hora_fim||`${d}:00:00`,[C]=String(A).split(":").map(Number),[T,I]=String(M).split(":").map(Number);let D=T===0&&I===0?24:T;return I>0&&D<24&&(D+=1),{start:C||c,end:D||d}}return{start:c,end:d}},[r,n,c,d]),j=p.useMemo(()=>Array.from({length:Math.max(0,w.end-w.start)},(E,A)=>w.start+A),[w]),_=p.useMemo(()=>Math.max(0,w.end-w.start)*(60/dE)*cm,[w]),S=p.useMemo(()=>{const E={};return b.forEach(A=>{E[Xt(A,"yyyy-MM-dd")]=[]}),t.forEach(A=>{const M=Xt(ti(A.start),"yyyy-MM-dd");E[M]&&E[M].push(A)}),E},[b,t]),k=(E,A)=>{const M=E.start.getHours()*60+E.start.getMinutes(),T=E.end.getHours()*60+E.end.getMinutes()-M,I=w.start*60,D=(M-I)/dE*cm,F=T/dE*cm,q=l[E.status]||{hex:"#888",text:"text-gray-400",label:"Unknown",icon:null},$=q.icon,K=40,ce=Math.max(K,F-4),fe=Math.min(1.3,ce/55),B=Math.max(11,Math.round(13*fe)),L=Math.max(10,Math.round(11*fe)),V=Math.max(9,Math.round(10*fe)),re=Math.max(14,Math.round(16*fe)),me=A?.[E.id]||[],G=me.filter(J=>String(J.status_pagamento||"").toLowerCase()==="pago").length,Q=me.length,ae=T===30;return o.jsx("div",{id:`booking-${E.id}`,className:"absolute left-0.5 right-0.5 rounded-md border-2 bg-surface cursor-pointer transition-all hover:bg-surface-2 hover:shadow-md overflow-hidden",style:{top:`${D}px`,height:`${Math.max(K,F)}px`,borderColor:q.hex||"#888",borderLeftWidth:"3px",zIndex:5},onClick:()=>i(E),children:o.jsxs("div",{className:"h-full flex flex-col justify-center px-2 py-1",children:[o.jsx("div",{className:"flex items-center gap-1.5 mb-0.5",children:o.jsx("p",{className:"font-semibold truncate",style:{fontSize:`${B}px`,lineHeight:1.1,color:"#e2e8f0"},children:IQe(E.customer)})}),ae&&(E.modality||Q>0)&&o.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",style:{lineHeight:1},children:[E.modality&&o.jsx("span",{className:"text-xs font-bold text-white bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm flex-shrink-0",style:{fontSize:Math.max(7,V-1)},children:E.modality}),Q>0&&o.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${G===Q?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,V-1)},children:[o.jsx(Ui,{style:{width:Math.max(10,V-1),height:Math.max(10,V-1)}}),o.jsxs("span",{children:[G,"/",Q]})]})]}),ae&&o.jsxs("div",{className:"flex items-center gap-1.5 justify-between",children:[o.jsxs("span",{className:"font-semibold whitespace-nowrap",style:{fontSize:`${L}px`,color:"#999",lineHeight:1},children:[Xt(E.start,"HH:mm"),"",Xt(E.end,"HH:mm")]}),$&&o.jsxs("div",{className:"flex items-center gap-0.5",children:[!f&&!x&&o.jsx($,{style:{width:Math.max(12,re-2),height:Math.max(12,re-2),color:q.hex}}),o.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${L}px`,color:q.hex,lineHeight:1},children:q.label})]})]}),!ae&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"truncate",style:{fontSize:`${L}px`,color:"#999",lineHeight:1,marginBottom:"2px"},children:[Xt(E.start,"HH:mm"),"",Xt(E.end,"HH:mm")]}),E.modality&&o.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm mb-0.5",style:{fontSize:Math.max(7,V-1),display:"inline-block",width:"fit-content"},children:E.modality}),o.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",children:[$&&o.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[!f&&!x&&o.jsx($,{style:{width:re,height:re,color:q.hex}}),o.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${V}px`,color:q.hex,lineHeight:1},children:E.status==="in_progress"?"Andamento":q.label})]}),Q>0&&o.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${G===Q?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,V-1)},children:[o.jsx(Ui,{style:{width:Math.max(12,V),height:Math.max(12,V)}}),o.jsxs("span",{children:[G,"/",Q]})]})]})]})]})},E.id)};return o.jsxs("div",{className:"flex-1 bg-surface rounded-lg border border-border flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"flex sticky top-0 z-20 bg-surface border-b border-border",children:[o.jsx("div",{className:"w-20 flex-shrink-0 flex items-center justify-center font-semibold text-sm border-r border-border bg-surface",children:"Horrios"}),o.jsxs("div",{ref:m,"data-header-scroll":!0,className:"flex flex-1 overflow-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none",paddingRight:`${v}px`,minWidth:0},children:[o.jsx("style",{children:`
            [data-header-scroll]::-webkit-scrollbar {
              display: none;
            }
          `}),b.map(E=>o.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] flex flex-col items-center justify-center py-3 border-r border-border bg-surface-2/50 text-center",children:[o.jsx("div",{className:"text-xs font-semibold text-text-muted",children:Xt(E,"EEE",{locale:aa}).toUpperCase()}),o.jsx("div",{className:"text-sm font-bold text-text-primary",children:Xt(E,"dd")})]},Xt(E,"yyyy-MM-dd")))]})]}),o.jsxs("div",{ref:h,className:"flex flex-1 overflow-auto",style:{minWidth:0},children:[o.jsxs("div",{className:"w-20 flex-shrink-0 bg-surface sticky left-0 z-10 flex flex-col relative",style:{borderRight:"1px solid var(--color-border)",minHeight:`${_}px`},children:[j.map(E=>o.jsxs(xe.Fragment,{children:[o.jsx("div",{className:Jt("relative border-b border-border/60",E%2===1&&"bg-surface-2/30"),style:{height:cm},children:o.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(E).padStart(2,"0"),":00"]})}),o.jsx("div",{className:Jt("relative border-b border-border/60",E%2===1&&"bg-surface-2/30"),style:{height:cm},children:o.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(E).padStart(2,"0"),":30"]})})]},`time-${E}`)),o.jsx("div",{className:"absolute right-0 top-0 w-px bg-border pointer-events-none",style:{height:`${_}px`}})]}),b.map(E=>{const A=Xt(E,"yyyy-MM-dd"),M=S[A]||[],C=u[A]||{},T=r&&C[r]&&!C[r].funciona;return o.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] relative border-r border-border bg-surface-2/10",style:{minHeight:`${_}px`},children:[j.map(I=>o.jsx("div",{className:Jt("border-b border-border/60",I%2===1&&"bg-surface-2/5"),style:{height:cm*2},children:T?o.jsx("div",{className:"w-full h-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/60 transition-colors",onClick:D=>D.preventDefault(),children:o.jsxs("div",{className:"text-center pointer-events-none",children:[o.jsx(BT,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),o.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),C[r]?.observacao&&o.jsx("div",{className:"text-xs text-text-muted",children:C[r].observacao})]})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:cm},onClick:()=>{const D=new Date(E.getTime());D.setHours(I,0,0,0),console.log("Slot :00 clicked",{day:E,hour:I,slotDate:D,activeCourtFilter:r}),s?.(D,r)}}),o.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:cm},onClick:()=>{const D=new Date(E.getTime());D.setHours(I,30,0,0),console.log("Slot :30 clicked",{day:E,hour:I,slotDate:D,activeCourtFilter:r}),s?.(D,r)}})]})},`${A}-${I}`)),M.map(I=>k(I,a))]},A)})]})]})}const ja=30,Yg=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,a]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${a}`},of=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function y9(e){const t=String(e||"").trim().split(/\s+/).filter(Boolean);return t.length===0?"":t.length===1?t[0]:`${t[0]} ${t[1]}`}const vs=56,LQe=6,b4=6,Dne=24;Array.from({length:(Dne-b4)*(60/ja)},(e,t)=>{const r=b4*60+t*ja,n=Math.floor(r/60),a=r%60;return{time:`${String(n).padStart(2,"0")}:${String(a).padStart(2,"0")}`,isHourMark:a===0}});const Vh=["Futebol","Beach Tennis","Futevlei","Treino"];function np(e){return vd(e,{weekStartsOn:1})}function $Qe(e){const t=np(e),r=Oa(t,6);return t.getMonth()===r.getMonth()?`${Xt(t,"dd")}-${Xt(r,"dd")} de ${Xt(r,"MMMM",{locale:aa})} de ${Xt(r,"yyyy")}`:`${Xt(t,"dd")} de ${Xt(t,"MMMM",{locale:aa})} - ${Xt(r,"dd")} de ${Xt(r,"MMMM",{locale:aa})} de ${Xt(r,"yyyy")}`}const Rs={scheduled:{label:"Agendado",accent:"bg-[#3B82F6]",text:"text-[#3B82F6]",border:"border-[#3B82F6]",hex:"#3B82F6",icon:gi},confirmed:{label:"Confirmado",accent:"bg-[#22C55E]",text:"text-[#22C55E]",border:"border-[#22C55E]",hex:"#22C55E",icon:Pi},in_progress:{label:"Em andamento",accent:"bg-[#FACC15]",text:"text-[#FACC15]",border:"border-[#FACC15]",hex:"#FACC15",icon:vH},finished:{label:"Finalizado",accent:"bg-[#6B7280]",text:"text-[#6B7280]",border:"border-[#6B7280]",hex:"#6B7280",icon:Zde},canceled:{label:"Cancelado",accent:"bg-[#EF4444]",text:"text-[#EF4444]",border:"border-[#EF4444]",hex:"#EF4444",icon:Oy},absent:{label:"Ausente",accent:"bg-[#F97316]",text:"text-[#F97316]",border:"border-[#F97316]",hex:"#F97316",icon:bH}},FQe={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},b9={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},w9=e=>{let t=Math.floor(e/60);const r=e%60;return t>=24&&(t=t%24),`${String(t).padStart(2,"0")}:${String(r).padStart(2,"0")}`};function BQe({sidebarVisible:e=!1}){const{toast:t}=ro(),{loadAlerts:r}=JS(),n=ki(),{isPaymentModalOpen:a,openPaymentModal:i,closePaymentModal:s,isEditParticipantModalOpen:l,openEditParticipantModal:c,closeEditParticipantModal:d,editParticipantData:u,editingBooking:f,setEditingBooking:m,participantsForm:h,setParticipantsForm:v,paymentTotal:g,setPaymentTotal:x,payMethods:y,setPayMethods:b}=AN(),w=p.useMemo(()=>{try{return typeof window<"u"&&localStorage.getItem("debug:agenda")==="1"}catch{return!1}},[]),j=p.useCallback((...ne)=>{if(w)try{console.log("[AgendaDbg]",...ne)}catch{}},[w]);p.useEffect(()=>{const ne=console.log,ie=console.info,Ye=console.debug,ze=console.warn,Ke=console.error,rt=oe=>{const st=String(oe||"");return st.startsWith("[AgendaDbg]")||!1||st.startsWith("[PulseDump]")||st.startsWith("[Clientes:load]")||st.startsWith("[AgendaSettings]")||st.startsWith("[Auto]")||st.startsWith("[DEBUG-PaymentModal]")||st.startsWith(" EditGuard")};return console.log=(...oe)=>{try{if(rt(oe[0]))return}catch{}return ne(...oe)},console.info=(...oe)=>{try{if(rt(oe[0]))return}catch{}return ie(...oe)},console.debug=(...oe)=>{try{if(rt(oe[0]))return}catch{}return Ye(...oe)},console.warn=(...oe)=>{try{if(rt(oe[0]))return}catch{}return ze(...oe)},console.error=(...oe)=>{try{if(rt(oe[0]))return}catch{}return Ke(...oe)},()=>{console.log=ne,console.info=ie,console.debug=Ye,console.warn=ze,console.error=Ke}},[]);const _=p.useRef({active:!1,tag:"",start:0,timer:null,events:[]}),S=p.useCallback((ne,ie)=>{if(w)try{const Ye=Date.now(),ze=_.current&&_.current.active?Ye-(_.current.start||Ye):0;_.current.events.push({t:Ye,ms:ze,event:ne,data:ie})}catch{}},[w]),k=p.useCallback(ne=>{if(w){try{if(!_.current.active)return;const{tag:ie,start:Ye,events:ze}=_.current,Ke=`[PulseDump] tag=${ie} dur=${Date.now()-Ye}ms reason=${ne}`;console.groupCollapsed(Ke);for(const rt of ze)console.log(` +${String(rt.ms).padStart(4," ")}ms`,rt.event,rt.data||{});console.groupEnd()}catch{}try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!1,tag:"",start:0,timer:null,events:[]}}},[w]),E=p.useCallback((ne,ie=5e3)=>{if(w){try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!0,tag:ne,start:Date.now(),timer:null,events:[]},_.current.timer=setTimeout(()=>k("timeout"),ie),j("PulseStart",{tag:ne,timeoutMs:ie})}},[w,k,j]),{userProfile:A,authReady:M,company:C}=Do(),[T,I]=ES(),[D,F]=p.useState(new Date),[z,q]=p.useState("day"),[$,K]=p.useState(!1),[ce,fe]=p.useState({}),[B,L]=p.useState(!1),[V,re]=p.useState({});p.useEffect(()=>{const ne=ie=>{if(ie.key==="Escape"&&$){K(!1);return}if(ie.key==="F10"){try{ie.preventDefault()}catch{}K(Ye=>!Ye)}};return window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)},[$]),p.useEffect(()=>{if($&&window.innerWidth<768)if(screen.orientation&&screen.orientation.lock)screen.orientation.lock("landscape").catch(()=>{const ne=document.getElementById("screen-orientation-meta");ne&&ne.setAttribute("content","landscape")});else{const ne=document.getElementById("screen-orientation-meta");ne&&ne.setAttribute("content","landscape")}else if(!$&&window.innerWidth<768){screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock();const ne=document.getElementById("screen-orientation-meta");ne&&ne.setAttribute("content","portrait-primary")}},[$]),p.useEffect(()=>{const ne=T.get("date");if(ne)try{const ie=new Date(ne+"T00:00:00");isNaN(ie.getTime())||(F(ie),T.delete("date"),I(T,{replace:!0}))}catch(ie){console.error("[AgendaPage] Erro ao parsear date da URL:",ie)}},[T,I]);const[me,G]=p.useState([]),[Q,ae]=p.useState(!1),[J,je]=p.useState(!1),[be,Ue]=p.useState(4),[Z,Y]=p.useState(!1),[lt,gt]=p.useState(!1),Te=f,at=m,[yt,vt]=p.useState({}),Sr=p.useRef(0),se=p.useRef("");p.useEffect(()=>{const ne=ie=>{try{const Ye=ie?.detail||{},ze=Ye.agendamentoId,Ke=Ye.participants;if(!ze||!Array.isArray(Ke))return;vt(rt=>{const oe=rt[ze]||[],st=Ke.map((Ve,Qe)=>{const qt=oe[Qe]||{};return{...qt,cliente_id:Ve.cliente_id,nome:Ve.nome,codigo:qt.codigo!==void 0?qt.codigo:Ve.codigo??null,valor_cota:typeof Ve.valor_cota=="string"?Ve.valor_cota:qt.valor_cota??"",status_pagamento:Ve.status_pagamento||qt.status_pagamento||"Pendente",finalizadora_id:Ve.finalizadora_id??qt.finalizadora_id??null,aplicar_taxa:Ve.aplicar_taxa??qt.aplicar_taxa??!1,ordem:qt.ordem??Qe+1}});return{...rt,[ze]:st}})}catch{}};return window.addEventListener("payments:saved",ne),()=>window.removeEventListener("payments:saved",ne)},[]);const Ze=p.useRef(!1);p.useEffect(()=>{Ze.current=Q,j("Modal state change:",{isModalOpen:Q}),S("modal",{open:Q})},[Q,j]);const ct=p.useRef("init"),Qt=p.useRef(0),we=p.useRef(!1),ye=p.useRef(0),te=p.useRef(!1),$e=p.useRef(0),[Pe,It]=p.useState(!1),Dt=p.useRef(0),kt=p.useRef(!1),cr=p.useRef(0),Cr=p.useCallback((ne=800)=>{cr.current=Date.now()+ne,j("UI:busy set",{ms:ne})},[j]),Ie=p.useCallback(()=>Date.now()<cr.current,[]),ke=p.useRef(0),Je=p.useRef(0),mt=p.useRef(!1),Be=p.useCallback(()=>{const ne=Date.now();Q||ne-Je.current<350||(Je.current=ne,ae(!0),mt.current=!0)},[Q]),$t=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!Q&&!$t.current&&($t.current=!0,Be(),window.history.replaceState({},document.title))},[n.state?.openModal,Q,Be]);const[Ee,Ct]=p.useState({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),[hr,Mr]=p.useState(null),[qr,Or]=p.useState(!0),Mt=p.useMemo(()=>Object.fromEntries((hr??[]).map(ne=>[ne.nome,ne])),[hr]),Ir=p.useMemo(()=>(hr??[]).map(ne=>ne.nome),[hr]),[Ar,Zt]=p.useState([]),Kr=A?.codigo_empresa,Tr=p.useMemo(()=>Kr?`quadras:list:${Kr}`:"quadras:list",[Kr]),dn=p.useMemo(()=>Kr?`agenda:selectedCourts:${Kr}`:"agenda:selectedCourts",[Kr]),Ae=p.useMemo(()=>Kr?`agenda:viewFilter:${Kr}`:"agenda:viewFilter",[Kr]),[pt,Br]=p.useState(null),[Pr,Ur]=p.useState(0);p.useEffect(()=>{Ar.length>0&&pt===null&&Br(Ar[0])},[Ar,pt]);const[Zr,cn]=p.useState([]),Tn=p.useRef(null),Qn=p.useRef({scheduled:!0,canceledOnly:!1}),[Sa,ht]=p.useState(null),[Vt,gr]=p.useState(""),Lt=p.useRef(0),Pt=p.useRef(!1),Yr=p.useRef(!1),[Ft,jr]=p.useState(!1),[ot,Kt]=p.useState(()=>{try{return localStorage.getItem("agenda:hideCanceledInfo")==="1"}catch{return!1}});p.useEffect(()=>{try{localStorage.setItem("agenda:hideCanceledInfo",ot?"1":"0")}catch{}},[ot]);const vr=p.useMemo(()=>{if(!A?.codigo_empresa)return null;const ne=Xt(z==="week"?np(D):D,"yyyy-MM-dd"),ie=z==="week"?"week":"day";return`agenda:bookings:${A.codigo_empresa}:${ie}:${ne}`},[A?.codigo_empresa,D,z]),X=p.useMemo(()=>{if(!A?.codigo_empresa)return null;const ne=Xt(D,"yyyy-MM-dd");return`agenda:participants:${A.codigo_empresa}:${ne}`},[A?.codigo_empresa,D]),[nt,qe]=p.useState(!1),it=p.useMemo(()=>({autoConfirmEnabled:!1,autoConfirmMinutesBefore:120,autoStartEnabled:!0,autoFinishEnabled:!0}),[]),[We,ut]=p.useState(it),[At,Wt]=p.useState(it),[$r,W]=p.useState(!1),[Ce,De]=p.useState(0),bt=p.useCallback(()=>Date.now()+(Number.isFinite(Ce)?Ce:0),[Ce]),[He,dt]=p.useState(null);p.useEffect(()=>{(async()=>{if(console.log("[AgendaSettings][LOAD] Iniciando carregamento...",{authReady:M,company_id:C?.id}),!M||!C?.id){console.warn("[AgendaSettings][LOAD] Aguardando autenticao...");return}try{console.log("[AgendaSettings][LOAD] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][LOAD] Buscando para empresa_id:",C.id);const{data:ie,error:Ye}=await pe.from("agenda_settings").select("*").eq("empresa_id",C.id).maybeSingle();if(console.log("[AgendaSettings][LOAD] Resultado da query:",{data:ie,error:Ye}),console.log("[AgendaSettings][LOAD] Data type:",ie===null?"null":typeof ie),Ye){console.error("[AgendaSettings][LOAD] ERRO ao carregar:",Ye);return}if(!ie){console.warn("[AgendaSettings][LOAD] Nenhum registro encontrado (ainda no criado)");return}console.log("[AgendaSettings][LOAD]  Registro encontrado:",ie);const ze={autoConfirmEnabled:!!ie.auto_confirm_enabled,autoConfirmMinutesBefore:ie.auto_confirm_enabled&&Number.isFinite(Number(ie.auto_confirm_hours))?Number(ie.auto_confirm_hours)*60:it.autoConfirmMinutesBefore,autoStartEnabled:!!ie.auto_start_enabled,autoFinishEnabled:!!ie.auto_finish_enabled};console.log("[AgendaSettings][LOAD]  Estado mapeado:",ze),ut(Ke=>({...Ke,...ze})),Wt(ze),console.log("[AgendaSettings][LOAD]  Estados atualizados com sucesso!")}catch(ie){console.warn("[AgendaSettings] unexpected load error",ie)}})()},[M,C?.id]),p.useEffect(()=>{let ne=!0,ie=null,Ye=!1;const ze=async()=>{try{const{data:Ke,error:rt}=await pe.functions.invoke("time-br",{body:{}});if(!rt&&Ke&&ne){const oe=Number(Ke.nowMs);if(Number.isFinite(oe)){const st=oe-Date.now();De(st),dt(Date.now());return}}if(!Ye){Ye=!0;try{console.warn("[TimeSync] time-br sem dados vlidos; usando relgio local.")}catch{}}}catch{if(!Ye){Ye=!0;try{console.warn("[TimeSync] time-br falhou; usando relgio local.")}catch{}}}};return ze(),ie=setInterval(ze,5*60*1e3),()=>{ne=!1,ie&&clearInterval(ie)}},[]);const[rr,Gr]=p.useState({}),Rr=2*60*60*1e3,br=p.useCallback(ne=>{Gr(ie=>({...ie,[ne]:Date.now()}))},[]),wr=p.useCallback(ne=>{Gr(ie=>{if(!ie||!(ne in ie))return ie;const Ye={...ie};return delete Ye[ne],Ye})},[]),or=p.useCallback(ne=>{const ie=rr?.[ne];return typeof ie=="number"&&Date.now()-ie<Rr},[rr]),[tn,tt]=p.useState(null),Hr=p.useCallback(()=>new Promise(ne=>{tt({resolve:ne})}),[]),un=p.useRef(new Map),jn=async()=>{console.log(" [AgendaSettings][SAVE] FUNO CHAMADA! "),console.log("[AgendaSettings][SAVE] Linha 509 - Antes do try");try{if(console.log("[AgendaSettings][SAVE] Linha 511 - Dentro do try"),console.log("[AgendaSettings][SAVE] authReady:",M),console.log("[AgendaSettings][SAVE] company:",C),!M||!C?.id){console.error("[AgendaSettings][SAVE] ERRO: No autenticado",{authReady:M,company:C}),t({title:"No autenticado",description:"Faa login para salvar as configuraes.",variant:"destructive"});return}console.log("[AgendaSettings][SAVE]  Autenticado! Preparando payload..."),console.log("[AgendaSettings][SAVE] automation atual:",We),W(!0);const ne={empresa_id:C.id,auto_confirm_enabled:!!We.autoConfirmEnabled,auto_confirm_hours:We.autoConfirmEnabled?Math.max(0,Math.round(Number(We.autoConfirmMinutesBefore||0)/60)):null,auto_start_enabled:!!We.autoStartEnabled,auto_finish_enabled:!!We.autoFinishEnabled};console.log("[AgendaSettings][SAVE] Payload preparado:",ne),console.log("[AgendaSettings][SAVE] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][SAVE] Supabase client type:",typeof pe.from);const{data:ie,error:Ye}=await pe.from("agenda_settings").upsert(ne,{onConflict:"empresa_id"}).select();if(console.log("[AgendaSettings][SAVE] Resultado do upsert:",{data:ie,error:Ye}),console.log("[AgendaSettings][SAVE] Data type:",Array.isArray(ie)?"array":typeof ie),console.log("[AgendaSettings][SAVE] Data length:",ie?.length),Ye)throw console.error("[AgendaSettings][SAVE]  ERRO no upsert:",Ye),Ye;!ie||ie.length===0?console.error("[AgendaSettings][SAVE]  AVISO: Upsert no retornou dados!"):console.log("[AgendaSettings][SAVE]  Dados salvos com sucesso:",ie[0]),Wt(We),console.log("[AgendaSettings][SAVE]  savedAutomation atualizado:",We),t({title:"Configuraes salvas",description:"As automaes da agenda foram atualizadas com sucesso."}),qe(!1),console.log("[AgendaSettings][SAVE]  Salvamento concludo!")}catch(ne){console.error(" [AgendaSettings][SAVE] ERRO CAPTURADO:",ne),console.error("[AgendaSettings][SAVE] Stack:",ne?.stack),console.error("[AgendaSettings][SAVE] Message:",ne?.message);const ie=ne?.message||"Falha ao salvar as configuraes.";t({title:"Erro ao salvar",description:ie,variant:"destructive"})}finally{console.log("[AgendaSettings][SAVE] Finally executado"),W(!1)}},vn=p.useCallback(async(ne,ie,Ye="user")=>{try{const ze=["canceled","finished","absent"],Ke=["scheduled","confirmed","in_progress"],rt=ze.includes(ie);let oe=!1;if(Ye==="user"&&Ke.includes(ie)){const Qe=(me||[]).find(H=>H.id===ne),qt=Qe?ze.includes(Qe.status):!1,O=Qe?!!Qe.auto_disabled:!1;(qt||O)&&(oe=!!await Hr())}const st=rt?{status:ie,auto_disabled:!0}:oe?{status:ie,auto_disabled:!1}:{status:ie},{error:Ve}=await pe.from("agendamentos").update(st).eq("codigo_empresa",A.codigo_empresa).eq("id",ne).select("id");if(Ve)throw Ve;G(Qe=>Qe.map(qt=>{if(qt.id!==ne)return qt;const O={...qt,status:ie,customer:qt.customer||""};return rt?O.auto_disabled=!0:oe&&(O.auto_disabled=!1),O}));try{un.current.set(ne,{status:ie,ts:Date.now()})}catch{}try{const Qe=JSON.parse(localStorage.getItem(vr)||"[]");if(Array.isArray(Qe)&&Qe.length>0){const qt=Array.isArray(Qe)?Qe.map(O=>{if(O.id!==ne)return O;const H={...O,status:ie,customer:O.customer||""};return rt?H.auto_disabled=!0:oe&&(H.auto_disabled=!1),H}):Qe;localStorage.setItem(vr,JSON.stringify(qt))}}catch{}if(Ye==="user")try{oe?wr(ne):br(ne)}catch{}}catch(ze){console.error("Auto-status: falha ao atualizar",ne,ie,ze)}},[me,vr,br,wr,Hr,Ee]),Zn=p.useRef(!1),Mn=p.useRef(null),oa=p.useRef(null),Dn=p.useCallback(()=>{try{Mn.current&&(clearTimeout(Mn.current),Mn.current=null)}catch{}},[]),va=p.useCallback(()=>{if(!M||!A?.codigo_empresa)return;if(Date.now()<(ke.current||0)){console.log("[AutoDiag] scheduleNextAutomation:deferred returning-from-hidden"),setTimeout(()=>va(),600);return}if(Ze.current){j("scheduleNextAutomation:skipped (modal open)");return}S("auto:schedule"),Dn();const ie=bt();let Ye=1/0;const ze=Ke=>{Number.isFinite(Ke)&&Ke>ie&&Ke<Ye&&(Ye=Ke)};try{for(const Ke of me||[]){if(!Ke||Ke.auto_disabled||or(Ke.id))continue;const rt=Ke.start instanceof Date?Ke.start.getTime():new Date(Ke.start).getTime(),oe=Ke.end instanceof Date?Ke.end.getTime():new Date(Ke.end).getTime();if(Ke.status==="scheduled"&&At.autoConfirmEnabled){const st=Number(At.autoConfirmMinutesBefore||0)*6e4;ze(rt-st),At.autoFinishEnabled&&ze(oe)}Ke.status==="confirmed"&&(At.autoStartEnabled&&ze(rt),At.autoFinishEnabled&&ze(oe)),Ke.status==="in_progress"&&At.autoFinishEnabled&&ze(oe)}}catch{}if(Ye!==1/0){const Ke=Math.max(0,Math.min(Ye-ie+250,6e5));try{console.debug("[Auto] next schedule in ms",Ke)}catch{}try{Ku(Ye)}catch{}Mn.current=setTimeout(()=>{try{oa.current&&oa.current()}catch{}},Ke)}},[M,A?.codigo_empresa,me,At,or,Dn,bt]),on=p.useCallback(async ne=>{try{if(!(typeof He=="number"&&Date.now()-He<6e5))try{const{data:ze}=await pe.functions.invoke("time-br",{body:{}}),Ke=Number(ze?.nowMs);Number.isFinite(Ke)&&(De(Ke-Date.now()),dt(Date.now()))}catch{}try{va()}catch{}let Ye=null;if(ne?.id&&A?.codigo_empresa){const{data:ze}=await pe.from("agendamentos").select("id, inicio, fim, status, modalidade, quadra_id, cliente_id, auto_disabled").eq("codigo_empresa",A.codigo_empresa).eq("id",ne.id).single();if(ze){const Ke={...ne,start:new Date(ze.inicio),end:new Date(ze.fim),status:ze.status||ne.status,modality:ze.modalidade||ne.modality,auto_disabled:!!ze.auto_disabled,customer:ne.customer||""};Ye=Ke,G(rt=>rt.map(oe=>oe.id===ne.id?Ke:oe))}}try{const ze=Ye||ne;if(ze&&ze.id){const Ke=bt(),rt=ze.start instanceof Date?ze.start.getTime():new Date(ze.start).getTime(),oe=ze.end instanceof Date?ze.end.getTime():new Date(ze.end).getTime();if(!ze.auto_disabled&&!or(ze.id))if(ze.status==="in_progress"&&At.autoFinishEnabled&&Number.isFinite(oe)&&Ke>=oe)await vn(ze.id,"finished","automation");else if(ze.status==="scheduled"&&At.autoStartEnabled&&Number.isFinite(rt)&&Ke>=rt)await vn(ze.id,"in_progress","automation");else if(ze.status==="confirmed"&&At.autoStartEnabled&&Number.isFinite(rt)&&Ke>=rt)await vn(ze.id,"in_progress","automation");else if(ze.status==="scheduled"&&At.autoConfirmEnabled&&Number.isFinite(rt)){const Ve=Number(At.autoConfirmMinutesBefore||0)*6e4;Ke>=rt-Ve&&await vn(ze.id,"confirmed","automation")}else(ze.status==="scheduled"||ze.status==="confirmed")&&At.autoFinishEnabled&&Number.isFinite(oe)&&Ke>=oe&&await vn(ze.id,"finished","automation")}}catch{}try{oa.current&&oa.current()}catch{}try{console.log(" EditGuard | ok | tempo=",typeof He=="number"?"Servidor":"Local")}catch{}return{booking:Ye}}catch(ie){try{console.warn(" EditGuard | falha leve",ie?.message||ie)}catch{}return{booking:null}}},[He,pe,A,G,va,bt,We,or,vn]),Ea=p.useCallback(async()=>{if(!(!M||!A?.codigo_empresa)){if(Ze.current){j("runAutomation:skipped (modal open)");return}if(!Zn.current){Zn.current=!0;try{try{console.debug("[Auto] tick")}catch{}S("auto:tick");const ne=bt(),ie=new Date(ne),Ye=Xt(ie,"yyyy-MM-dd");let ze=(me||[]).filter(rt=>Xt(rt.start,"yyyy-MM-dd")===Ye);if(ze.length===0)try{const rt=ti(ie),oe=Oa(rt,1),{data:st,error:Ve}=await pe.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",A.codigo_empresa).gte("inicio",rt.toISOString()).lt("inicio",oe.toISOString());!Ve&&Array.isArray(st)&&(ze=st.map(Qe=>({id:Qe.id,start:new Date(Qe.inicio),end:new Date(Qe.fim),status:Qe.status||"scheduled",auto_disabled:!!Qe.auto_disabled})))}catch{}try{const{data:rt,error:oe}=await pe.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",A.codigo_empresa).lt("fim",ie.toISOString()).in("status",["scheduled","confirmed","in_progress"]);if(!oe&&Array.isArray(rt)&&rt.length>0){const st=rt.map(Qe=>({id:Qe.id,start:new Date(Qe.inicio),end:new Date(Qe.fim),status:Qe.status||"scheduled",auto_disabled:!!Qe.auto_disabled})),Ve=new Map(ze.map(Qe=>[Qe.id,Qe]));for(const Qe of st)Ve.has(Qe.id)||Ve.set(Qe.id,Qe);ze=Array.from(Ve.values())}}catch{}let Ke=!1;for(const rt of ze){if(rt.auto_disabled||or(rt.id))continue;const oe=rt.start instanceof Date?rt.start.getTime():new Date(rt.start).getTime(),st=rt.end instanceof Date?rt.end.getTime():new Date(rt.end).getTime();if(rt.status==="in_progress"&&At.autoFinishEnabled&&ne>=st){try{console.debug("[Auto] finish",{id:rt.id})}catch{}await vn(rt.id,"finished","automation"),Ke=!0;continue}if(rt.status==="scheduled"&&At.autoStartEnabled&&ne>=oe){try{console.debug("[Auto] start-direct (skip confirm)",{id:rt.id})}catch{}await vn(rt.id,"in_progress","automation"),Ke=!0;continue}if(rt.status==="confirmed"&&At.autoStartEnabled&&ne>=oe){try{console.debug("[Auto] start",{id:rt.id})}catch{}await vn(rt.id,"in_progress","automation"),Ke=!0;continue}if(rt.status==="scheduled"&&At.autoConfirmEnabled){const Ve=Number(At.autoConfirmMinutesBefore||0)*6e4;if(ne>=oe-Ve){try{console.debug("[Auto] confirm",{id:rt.id})}catch{}await vn(rt.id,"confirmed","automation"),Ke=!0;continue}}if((rt.status==="scheduled"||rt.status==="confirmed")&&At.autoFinishEnabled&&ne>=st){try{console.debug("[Auto] catchup-finish",{id:rt.id})}catch{}await vn(rt.id,"finished","automation"),Ke=!0;continue}}if(Ke)try{setTimeout(()=>{try{Ca()}catch{}},800)}catch{}try{va()}catch{}}finally{Zn.current=!1}}}},[M,A?.codigo_empresa,me,At,vn,or,va,bt]);p.useEffect(()=>{oa.current=Ea},[Ea]),p.useEffect(()=>{const ne=setInterval(Ea,1e4);try{oa.current&&oa.current()}catch{}try{va()}catch{}return()=>clearInterval(ne)},[Ea]),p.useEffect(()=>{const ne=setInterval(()=>{try{if(!!!(At?.autoConfirmEnabled||At?.autoStartEnabled||At?.autoFinishEnabled))return;oa.current&&(console.debug("[Auto][Watchdog] forcing periodic automation run"),oa.current())}catch{}},18e5);return()=>clearInterval(ne)},[At]),p.useEffect(()=>{if(vr)try{const ne=JSON.parse(localStorage.getItem(vr)||"[]");if(Array.isArray(ne)&&ne.length>0){const ie=ne.map(Ye=>({...Ye,start:new Date(Ye.start),end:new Date(Ye.end),customer:Ye.customer||""}));j("cache:bookings:hydrate",{count:ie.length,sample:ie[0]}),S("cache:hydrate",{count:ie.length}),G(Ye=>Ye&&Ye.length>0?Ye:ie),Cr(1200)}}catch{}},[vr,j]),p.useEffect(()=>{const ne=()=>{try{const ze=new Date().toISOString();if(document.visibilityState==="visible"){const Ke=Date.now();ke.current=Ke+800}}catch{}},ie=()=>{try{const ze=new Date().toISOString()}catch{}},Ye=()=>{try{const ze=new Date().toISOString()}catch{}};return document.addEventListener("visibilitychange",ne),window.addEventListener("focus",ie),window.addEventListener("blur",Ye),()=>{document.removeEventListener("visibilitychange",ne),window.removeEventListener("focus",ie),window.removeEventListener("blur",Ye)}},[Q,me]),p.useEffect(()=>{try{va()}catch{}return()=>{try{Dn()}catch{}}},[me,We,va,Dn]),p.useEffect(()=>{if(X)try{const ne=JSON.parse(localStorage.getItem(X)||"{}");ne&&typeof ne=="object"&&(vt(ne),se.current=Xt(D,"yyyy-MM-dd"))}catch{}},[X]);const Ca=p.useCallback(async()=>{if(!M||!A?.codigo_empresa||Date.now()<(ke.current||0)||Q)return;j("fetchBookings:start",{date:Xt(D,"yyyy-MM-dd"),empresa:A?.codigo_empresa}),S("fetch:start",{day:Xt(D,"yyyy-MM-dd")});const ne=ti(D),ie=z==="week"?np(D):ne,Ye=z==="week"?Oa(ie,7):Oa(ie,1),{data:ze,error:Ke}=await pe.from("agendamentos").select(`
        id, codigo, codigo_empresa, quadra_id, cliente_id, clientes, inicio, fim, modalidade, status, auto_disabled,
        quadra:quadra_id ( nome )
      `).eq("codigo_empresa",A.codigo_empresa).gte("inicio",ie.toISOString()).lt("inicio",Ye.toISOString()).order("inicio",{ascending:!0});if(Ke){j("fetchBookings:error",{message:Ke?.message,code:Ke?.code,status:Ke?.status}),S("fetch:error",{message:Ke?.message,code:Ke?.code,status:Ke?.status}),t({title:"Erro ao carregar agendamentos",description:Ke.message,variant:"destructive"}),Pt.current||(Pt.current=!0,setTimeout(Ca,900));return}if(!ze||ze.length===0){j("fetchBookings:empty-first-hit"),S("fetch:empty-first");let st=!1;try{const Ve=vr?JSON.parse(localStorage.getItem(vr)||"[]"):[];st=Array.isArray(Ve)&&Ve.length>0}catch{}if(!Pt.current&&(Pt.current=!0,st)){setTimeout(Ca,700);return}}Pt.current=!1;const rt=Date.now(),oe=(ze||[]).map(st=>{const Ve=new Date(st.inicio),Qe=new Date(st.fim),qt=st.quadra?.[0]?.nome||st.quadra?.nome||Object.values(Mt).find(Oe=>Oe.id===st.quadra_id)?.nome||"";let O="";if(yt[st.id]){const Oe=yt[st.id];Array.isArray(Oe)&&Oe.length>0&&(O=Oe[0]?.nome||"")}if(!O&&st.clientes)try{const Oe=typeof st.clientes=="string"?JSON.parse(st.clientes):st.clientes;Array.isArray(Oe)&&Oe.length>0&&(O=Oe[0]?.nome||Oe[0]||"")}catch{}const H=un.current.get(st.id),_e=H&&rt-H.ts<4e3;return{id:st.id,code:st.codigo,court:qt,customer:O,start:Ve,end:Qe,status:_e?H.status:st.status||"scheduled",modality:st.modalidade||"",auto_disabled:!!st.auto_disabled}});G(oe);try{if(vr){const st=oe.map(Ve=>({id:Ve.id,code:Ve.code,court:Ve.court,customer:Ve.customer,start:Ve.start.toISOString(),end:Ve.end.toISOString(),status:Ve.status,modality:Ve.modality,auto_disabled:Ve.auto_disabled}));localStorage.setItem(vr,JSON.stringify(st))}}catch{}},[M,A?.codigo_empresa,D,Mt,vr,t,j,w,yt]);p.useEffect(()=>{if(w)try{const ne=(me||[]).map(ie=>`${ie.id}:${Xt(ie.start,"HH:mm")}-${Xt(ie.end,"HH:mm")}:${ie.status}`).join(" | ");console.log("[AgendaDbg] bookings:changed",{count:Array.isArray(me)?me.length:0,summary:ne})}catch{}},[me,w]),p.useEffect(()=>{try{const ne=Date.now()+1800;ye.current=ne,j("Picker:suppressClose window set",{until:ne})}catch{}},[me]),p.useEffect(()=>{M&&A?.codigo_empresa&&Ca()},[M,A?.codigo_empresa,D,Mt,vr]);const ya=p.useRef(null),[Mo,vi]=p.useState("idle"),[oo,zl]=p.useState(null),yl=p.useRef(!1);p.useEffect(()=>{if(!M||!A?.codigo_empresa)return;const ne=ti(D);Oa(ne,1);const ie=setInterval(()=>{Ze.current||Ca()},3e4);return()=>{try{ya.current&&clearTimeout(ya.current)}catch{}try{clearInterval(ie)}catch{}try{vi("polling")}catch{}}},[M,A?.codigo_empresa,D,Ca]),p.useEffect(()=>{if(!Q&&yl.current){yl.current=!1;try{j("Modal closed: flushing pending realtime refresh"),S("rt:flushAfterModalClose"),Ca()}catch{}}},[Q,Ca,j]);const[cs,Ku]=p.useState(null),kc=p.useRef("");p.useEffect(()=>{try{const ne=typeof He=="number"&&Date.now()-He<6e5,ie=Qe=>typeof Qe=="number"?Xt(new Date(Qe),"HH:mm:ss",{locale:aa}):"",Ye=Qe=>typeof Qe=="number"?Xt(new Date(Qe),"HH:mm",{locale:aa}):"",ze=ne?"":"",rt=String(Mo).toUpperCase()==="SUBSCRIBED"||String(Mo).toLowerCase()==="polling"?"":"",oe=typeof cs=="number"?"":"",st=Array.isArray(me)?me.length:0,Ve=` Agenda | ${ze} Tempo=${ne?"Servidor":"Local"} (${Math.round(Ce)}ms, sync ${ie(He)}) |  Realtime=${rt} ${Mo}${oo?` (${ie(oo)})`:""} | ${oe} Prximo=${Ye(cs)} |  Agendamentos=${st}`;kc.current!==Ve&&(kc.current=Ve,console.log(Ve)),typeof window<"u"&&(window.__AgendaConn={usingServer:ne,serverOffsetMs:Ce,lastTimeSyncAtMs:He,realtimeStatus:Mo,lastRealtimeEventAtMs:oo,nextAutoAtMs:cs})}catch{}},[Ce,He,Mo,oo,We,cs,A?.codigo_empresa,D,Array.isArray(me)?me.length:0]),p.useEffect(()=>{const ne=setInterval(()=>{try{const ie=Date.now();if(ie<(ke.current||0)){console.log("[AutoDiag] reconcile:skipped returning-from-hidden");return}if(Q){console.log("[AutoDiag] reconcile:skipped modal-open");return}const Ye=String(Mo||"").toUpperCase()==="SUBSCRIBED",ze=typeof oo=="number"?ie-oo:1/0,Ke=!Ye||ze>7*60*1e3,rt=typeof cs=="number"?ie>cs+60*1e3:!1;if(Ke||rt){console.debug("[Reconcile] forcing fetchBookings (stale=",Ke," tickDue=",rt,")"),Ca();try{va()}catch{}}}catch{}},3e5);return()=>clearInterval(ne)},[Mo,oo,cs,Ca,va]),p.useEffect(()=>{(async()=>{if(!M||!A?.codigo_empresa||Date.now()<(ke.current||0))return;if(Ze.current){j("Participants:skipped (modal open)");return}j("Participants:load start"),S("parts:start");const ie=(me||[]).map(st=>st.id).filter(Boolean),Ye=Xt(D,"yyyy-MM-dd");if(!ie.length){if(se.current!==Ye){vt({});try{X&&localStorage.setItem(X,"{}")}catch{}}se.current=Ye;return}const ze=++Sr.current,{data:Ke,error:rt}=await pe.from("agendamento_participantes").select("id, agendamento_id, codigo_empresa, cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, cliente:clientes!agendamento_participantes_cliente_id_fkey(nome, codigo)").in("agendamento_id",ie).order("ordem",{ascending:!0});if(Sr.current!==ze)return;if(rt){console.warn("[Participants] load error",rt),j("Participants:error",{message:rt?.message,code:rt?.code,status:rt?.status}),S("parts:error",{code:rt?.code});return}const oe={};for(const st of Ke||[]){const Ve=st.agendamento_id;oe[Ve]||(oe[Ve]=[]);const Qe=st.nome||(Array.isArray(st.cliente)?st.cliente[0]?.nome:st.cliente?.nome)||"",qt=(Array.isArray(st.cliente)?st.cliente[0]?.codigo:st.cliente?.codigo)||null;oe[Ve].push({...st,nome:Qe,codigo:qt})}j("Participants:loaded",{bookings:ie.length,rows:(Ke||[]).length}),S("parts:loaded",{rows:(Ke||[]).length}),se.current=Ye,vt(st=>{const Ve={...st};for(const Qe of ie)Ve[Qe]=oe[Qe]||[];try{X&&localStorage.setItem(X,JSON.stringify(Ve))}catch{}return j("Participants:set state for ids",{ids:ie}),S("parts:set",{idsCount:ie.length}),Ve})})()},[M,A?.codigo_empresa,me,D,X,j]),p.useEffect(()=>{(async()=>{if(!(!M||!A?.codigo_empresa||!Ir.length)){L(!0);try{const ie=Xt(D,"yyyy-MM-dd"),Ye=D.getDay(),{data:ze,error:Ke}=await pe.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",A.codigo_empresa).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${ie}),and(tipo.eq.dia_semana,dia_semana.eq.${Ye})`);if(Ke){console.error("Erro ao carregar dias de funcionamento:",Ke);return}const rt={};Ir.forEach(oe=>{const st=Mt[oe];if(!st)return;const Ve=ze?.find(qt=>qt.quadra_id===st.id&&qt.tipo==="data_fechamento"&&qt.data_fechamento===ie);if(Ve&&!Ve.funciona){rt[oe]={funciona:!1,motivo:"data_especifica",observacao:Ve.observacao||"Fechamento especial"};return}const Qe=ze?.find(qt=>qt.quadra_id===st.id&&qt.tipo==="dia_semana"&&qt.dia_semana===Ye);Qe?rt[oe]={funciona:Qe.funciona,motivo:Qe.funciona?"normal":"dia_semana",observacao:Qe.funciona?null:"Fechado neste dia da semana"}:rt[oe]={funciona:!0,motivo:"normal",observacao:null}}),fe(rt)}catch(ie){console.error("Erro ao verificar dias de funcionamento:",ie)}finally{L(!1)}}})()},[M,A?.codigo_empresa,D,Ir,Mt]),p.useEffect(()=>{if(!M||!A?.codigo_empresa||Ir.length===0)return;(async()=>{try{const ie=new Date(D);ie.setDate(ie.getDate()-ie.getDay());const{data:Ye,error:ze}=await pe.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",A.codigo_empresa);if(ze){console.error("Erro ao carregar funcionamento da semana:",ze);return}const Ke={};for(let rt=0;rt<7;rt++){const oe=new Date(ie);oe.setDate(oe.getDate()+rt);const st=Xt(oe,"yyyy-MM-dd"),Ve=oe.getDay(),Qe={};Ir.forEach(qt=>{const O=Mt[qt];if(!O)return;const H=Ye?.find(Oe=>Oe.quadra_id===O.id&&Oe.tipo==="data_fechamento"&&Oe.data_fechamento===st);if(H&&!H.funciona){Qe[qt]={funciona:!1,motivo:"data_especifica",observacao:H.observacao||"Fechamento especial"};return}const _e=Ye?.find(Oe=>Oe.quadra_id===O.id&&Oe.tipo==="dia_semana"&&Oe.dia_semana===Ve);_e?Qe[qt]={funciona:_e.funciona,motivo:_e.funciona?"normal":"dia_semana",observacao:_e.funciona?null:"Fechado neste dia da semana"}:Qe[qt]={funciona:!0,motivo:"normal",observacao:null}}),Ke[st]=Qe}re(Ke)}catch(ie){console.error("Erro ao carregar funcionamento da semana:",ie)}})()},[M,A?.codigo_empresa,D,Ir,Mt]),p.useEffect(()=>{Object.values(ce).some(ie=>!ie.funciona)&&Tn.current},[ce]),p.useEffect(()=>{if(Kr)try{const ne=JSON.parse(localStorage.getItem(Tr)||"[]");Array.isArray(ne)&&ne.length&&(!hr||hr.length===0)&&(Mr(ne),Or(!1))}catch{}},[Kr,Tr]),p.useEffect(()=>{const ne=async()=>{if(!A?.codigo_empresa)return;try{const Ke=JSON.parse(localStorage.getItem(Tr)||"[]");if(Array.isArray(Ke)&&Ke.length>0){const rt=Ke[0]?.codigo_empresa;if(rt&&rt!==A.codigo_empresa){console.warn(" [Cache Limpo] Quadras de outra empresa detectadas e removidas"),localStorage.removeItem(Tr),localStorage.removeItem(dn),Mr([]);try{Zt([])}catch{}try{Br(null)}catch{}try{setForm(oe=>({...oe,court:""}))}catch{}}}}catch{}(!hr||hr.length===0)&&Or(!0);const{data:ie,error:Ye}=await pe.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status").eq("codigo_empresa",A.codigo_empresa).eq("status","Ativa").order("nome",{ascending:!0});if(Ye){t({title:"Erro ao carregar quadras",description:Ye.message}),Yr.current?Or(!1):(Yr.current=!0,setTimeout(ne,900));return}const ze=ie||[];if(ze.length===0){let Ke=0;try{const rt=JSON.parse(localStorage.getItem("quadras:list")||"[]");Ke=Array.isArray(rt)?rt.length:0}catch{}if(Ke>0&&!Yr.current){Yr.current=!0,Or(!1),setTimeout(ne,700);return}}Yr.current=!1,Mr(ze);try{localStorage.setItem(Tr,JSON.stringify(ze))}catch{}Or(!1)};M&&A?.codigo_empresa&&ne()},[M,A?.codigo_empresa,Tr,dn]),p.useEffect(()=>{try{if(qr)return;const ne=Ir||[];form?.court&&!ne.includes(form.court)&&setForm(ie=>({...ie,court:ne[0]||""})),(!form?.court||form.court==="")&&ne.length>0&&setForm(ie=>({...ie,court:ne[0]}))}catch{}},[qr,Ir,A?.codigo_empresa]),p.useEffect(()=>{if(qr)return;const ne=(()=>{try{return JSON.parse(localStorage.getItem(dn)||"[]")}catch{return[]}})(),ie=(()=>{try{return JSON.parse(localStorage.getItem(Ae)||"{}")}catch{return{}}})(),Ye=ne.filter(ze=>Ir.includes(ze));Ye.length>0?Zt(Ye):Ar.length===0&&Zt(Ir),ie&&typeof ie=="object"&&Ct(ze=>({...ze,canceledOnly:!1,...ie}))},[qr,Ir.length]),p.useEffect(()=>{try{localStorage.setItem(dn,JSON.stringify(Ar))}catch{}},[Ar,dn]),p.useEffect(()=>{try{localStorage.setItem(Ae,JSON.stringify(Ee))}catch{}},[Ee,Ae]);const de=p.useMemo(()=>{const ne=Ar.map(Ye=>Mt[Ye]?.hora_inicio||"06:00:00").map(Ye=>{const[ze,Ke]=String(Ye).split(":").map(Number);return(ze||0)*60+(Ke||0)});if(!ne.length)return b4;const ie=Math.min(...ne);return Math.floor(ie/60)},[Ar,Mt]),Le=p.useMemo(()=>{const ne=Ar.map(Ye=>Mt[Ye]?.hora_fim||"24:00:00").map(Ye=>{const[ze,Ke]=String(Ye).split(":").map(Number);return(ze===0&&Ke===0?24:ze||0)*60+(Ke||0)});if(!ne.length)return Dne;const ie=Math.max(...ne);return Math.ceil(ie/60)},[Ar,Mt]);p.useEffect(()=>{const ne=new Date,ie=fu(ne),Ye=mu(ne);setTimeout(()=>{if(!Tn.current)return;const Ke=Math.max(0,(ie-de)*60+Ye)/ja;Tn.current.scrollTop=Math.max(0,Ke*vs-120)},150)},[de]);const jt=({booking:ne,courtGridStart:ie,courtGridEnd:Ye})=>{const ze=vs,Ke=xa=>{const Xi=fu(xa),Vs=mu(xa);return Xi===0&&Vs===0?1440:Xi*60+Vs},rt=Ke(ne.start),oe=Ke(ne.end),st=ie!==void 0?ie:pt?_r.start*60:de*60,Ve=Ye!==void 0?Ye:pt?_r.end*60:Le*60,Qe=rt-st,qt=(Ve-st)/ja;let O=Math.floor(Qe/ja);const H=Math.max(0,oe-rt),_e=Math.max(1,Math.ceil(H/ja));let Oe=O+_e;O=Math.max(0,Math.min(O,qt-1)),Oe=Math.max(0,Math.min(Oe,qt)),Oe<=O&&(Oe=O+1),Oe=Math.min(Oe,qt);const ve=O*ze;let Xe=(Oe-O)*ze;const et=Rs[ne.status]||Rs.confirmed,zt=et.icon,nr=et.border,Et=_e===1,Nr=Et?4:LQe,tr=ve+Nr,ar=Math.max(Et?40:32,Xe-Nr*2),sr=H>=90,xr=2,St=1.15,Lr=sr?(()=>{const xa=Math.min(Math.max((H-90)/90,0),1);return Math.min(St+xa*(xr-St),xr)})():1,Fr=16,gn=14,wa=Et?16:24,$n=Math.round(Fr*(sr?Lr:1)),ca=Math.round(gn*(sr?Lr:1)),da=Math.round(wa*(sr?Lr:1)),co=Et?12:16,Oi=Et?12:16,oi=sr?Math.min(Lr,1.3):1,Da=Math.round(co*oi),go=Math.round(Oi*oi),Yi=yt[ne.id]||[],uo=Yi.filter(xa=>String(xa.status_pagamento||"").toLowerCase()==="pago").length,ds=Yi.length;return o.jsxs(fr.div,{layout:Q?!1:"position",initial:Q?!1:{opacity:0,y:6},animate:Q?!1:{opacity:1,y:0},exit:Q?!1:{opacity:0,y:6},id:`booking-${ne.id}`,className:Jt("absolute left-2 right-2 rounded-md border-2 bg-surface text-sm shadow-sm z-0 cursor-pointer",nr,"overflow-hidden transition-all duration-150 hover:bg-surface-2 hover:shadow-md"),style:{top:`${tr}px`,height:`${ar}px`},onClick:async()=>{const xa=on(ne),Xi=new Promise(Ma=>setTimeout(Ma,600));let Vs=null;try{Vs=await Promise.race([xa,Xi])}catch{}const Yu=Vs&&Vs.booking||me.find(Ma=>Ma.id===ne.id)||ne;at(Yu),Be()},children:[o.jsx("div",{className:Jt("absolute left-0 top-0 h-full w-[6px] rounded-l-md",et.accent)}),o.jsx("div",{className:Jt("h-full flex",Et?"px-3 py-3":"px-4 py-4"),style:{paddingLeft:Da,paddingRight:Da,paddingTop:go,paddingBottom:go},children:o.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[o.jsx("p",{className:"font-semibold text-text-primary truncate text-base",style:{fontSize:$n,lineHeight:1.15},children:y9(ne.customer)}),Et&&o.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2 py-0.5 whitespace-nowrap shadow-md",style:{fontSize:ca},children:ne.modality})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs("span",{className:Jt("text-text-muted font-semibold text-base whitespace-nowrap"),style:{fontSize:$n},children:[Xt(ne.start,"HH:mm"),"",Xt(ne.end,"HH:mm")]}),Et&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(zt,{className:Jt(et.text),style:{width:da,height:da}}),o.jsx("span",{className:Jt("truncate font-semibold",et.text,"text-base"),style:{fontSize:$n},children:et.label})]}),Et&&ds>0&&o.jsxs("span",{className:`text-xs font-semibold rounded-full px-2 py-0.5 border ${uo===ds?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(11,Math.round(11*(sr?Lr:1)))},children:[uo,"/",ds]})]}),o.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2 flex-wrap",children:[!Et&&o.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2.5 py-1 shadow-md",style:{fontSize:ca},children:ne.modality}),!Et&&o.jsxs("div",{className:"flex items-center gap-1.5 text-base flex-wrap justify-end",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(zt,{className:Jt(et.text),style:{width:da,height:da}}),o.jsx("span",{className:Jt("truncate font-semibold",et.text),style:{fontSize:$n},children:(()=>typeof window<"u"&&window.innerWidth<768&&ne.status==="in_progress"?"Andamento":et.label)()})]}),ds>0&&(()=>{const xa=typeof window<"u"&&window.innerWidth<768;return o.jsxs("span",{className:Jt("font-bold rounded-full border flex items-center gap-1 whitespace-nowrap",Et?"px-2 py-0.5 text-xs":"px-2.5 py-1 text-sm",uo===ds?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"),style:{fontSize:Math.max(Et?11:13,Math.round((Et?11:13)*(sr?Lr:1)))},children:[o.jsx(Ui,{className:"w-3 h-3 flex-shrink-0"}),o.jsxs("span",{className:"whitespace-nowrap",children:[uo,"/",ds,xa?"":" pagos"]})]})})()]})]})]})})]})},Rt=()=>{p.useRef(Math.random().toString(36).slice(2)),AN();const ne=p.useRef(0),ie=p.useRef(""),Ye=ge=>{if(!ge)return"";if(typeof ge=="string")return ge;const Fe=ge.nome||ge.name||"",Ge=ge.codigo??ge.code;return Ge!=null?`[${Ge}] ${Fe}`:Fe},ze=ge=>ge?typeof ge=="string"?ge:ge.nome||ge.name||"":"",Ke=ge=>{const Fe=Mt[ge];if(!Fe)return{start:de*60,end:Le*60};const[Ge,xt]=String(Fe.hora_inicio||"06:00:00").split(":").map(Number),[_t,Er]=String(Fe.hora_fim||"24:00:00").split(":").map(Number),Yt=_t===0&&Er===0?24:_t;return{start:Ge*60+(xt||0),end:Yt*60+(Er||0)}},rt=()=>{const ge=fu(new Date),Fe=mu(new Date),Ge=ge*60+Fe,xt=Ir[0]||"",_t=Ke(xt);return Math.max(_t.start,Math.min(_t.end-ja,Math.round(Ge/ja)*ja))},[oe,st]=p.useState(()=>{let ge=[];try{const Ge=sessionStorage.getItem("agenda:customerPicker:closingAt"),xt=Ge?Number(Ge):0,_t=xt&&Date.now()-xt<1e4,Er=sessionStorage.getItem(Fr),Yt=Er?JSON.parse(Er):[];if(_t&&Array.isArray(Yt)&&Yt.length>0?ge=Yt:Array.isArray(ca)&&ca.length>0?ge=ca:Array.isArray(St.current)&&St.current.length>0&&(ge=St.current),ge.length>0)try{Qe.current=!0}catch{}}catch{}return{selectedClients:ge,court:(()=>Ir.find(xt=>!ce[xt]||ce[xt].funciona)||Ir[0]||"")(),modality:Vh[0],status:"scheduled",date:D,startMinutes:rt(),endMinutes:rt()+60}}),Ve=p.useRef([]),Qe=p.useRef(!1),qt=p.useRef(null);p.useEffect(()=>{Ve.current=Array.isArray(oe.selectedClients)?oe.selectedClients:[];try{(Ve.current||[]).length>0&&(Qe.current=!0)}catch{}},[oe.selectedClients]);const[O,H]=p.useState(!1),[_e,Oe]=p.useState(""),[ve,Xe]=p.useState(0),et=p.useRef(0),zt=p.useRef(!1);p.useEffect(()=>{const ge=()=>{try{if(document.visibilityState==="hidden"){zt.current=!!(Pe||O);const Fe=Date.now();try{Dt.current=Fe+1200}catch{}try{ye.current=Fe+1200}catch{}try{et.current=Fe+800}catch{}}else if(document.visibilityState==="visible"){const Fe=zt.current;zt.current=!1;const Ge=Date.now();try{Dt.current=Math.max(Dt.current||0,Ge+600)}catch{}try{ye.current=Math.max(ye.current||0,Ge+600)}catch{}try{et.current=Math.max(et.current||0,Ge+400)}catch{}Fe&&!Ze.current&&setTimeout(()=>{Ze.current||(H(!0),It(!0))},60)}}catch{}};return document.addEventListener("visibilitychange",ge),()=>document.removeEventListener("visibilitychange",ge)},[Pe,O,Q]),p.useEffect(()=>{},[O,Pe]);const nr=p.useRef(0);p.useEffect(()=>{const ge=Array.isArray(oe.selectedClients)?oe.selectedClients.length:-1,Fe=nr.current;ge!==Fe&&(nr.current=ge)},[oe.selectedClients,O,Pe]);const[Et,Gt]=p.useState(!1),[Nr,tr]=p.useState(null),[ar,sr]=p.useState(!1),xr=p.useRef(!1),St=p.useRef([]),Lr=p.useRef("init"),Fr=p.useMemo(()=>{try{return`agenda:lastSelection:${A?.codigo_empresa||"no-company"}`}catch{return"agenda:lastSelection:no-company"}},[A?.codigo_empresa]),gn=p.useCallback(ge=>{try{sessionStorage.setItem(Fr,JSON.stringify(ge||[]))}catch{}},[Fr]),wa=p.useCallback(()=>{try{const ge=sessionStorage.getItem(Fr);if(ge){const Fe=JSON.parse(ge);Array.isArray(Fe)&&(St.current=Fe)}}catch{}},[Fr]),$n=p.useRef(!1),[ca,da]=p.useState([]),co=p.useCallback(ge=>{da(ge)},[]),Oi=p.useRef(null),oi=p.useRef(null),Da=p.useRef([]);p.useEffect(()=>{Pe&&Da.current[ve]&&Da.current[ve]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[ve,Pe]),p.useEffect(()=>{Pe&&Xe(0)},[Pe]);const[go,Yi]=p.useState(!1),[uo,ds]=p.useState(!1);p.useState(!1);const[xa,Xi]=p.useState(!1),[Vs,Yu]=p.useState(!1),Ma=p.useRef(null),Ws=p.useRef(null),Ul=p.useRef(!1);p.useEffect(()=>{if(!a)return;let ge=!1;return(async()=>{try{if(!M||!A?.codigo_empresa)return;const Fe=await Hv({somenteAtivas:!0,codigoEmpresa:A.codigo_empresa});ge||b(Array.isArray(Fe)?Fe:[])}catch{}})(),()=>{ge=!0}},[a,M,A?.codigo_empresa]),p.useEffect(()=>{if(!a||!Array.isArray(y)||y.length===0)return;const ge=String(y[0].id);v(Fe=>Fe.length===0&&Array.isArray(oe.selectedClients)&&oe.selectedClients.length>0?oe.selectedClients.map(_t=>({cliente_id:_t.id,nome:_t.nome,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:ge})):Fe.map(xt=>({...xt,finalizadora_id:xt.finalizadora_id&&xt.finalizadora_id!==""?xt.finalizadora_id:ge})))},[a,y]);const Cs=p.useCallback((ge,Fe)=>{try{const Ge=Date.now(),xt=Ge<(Lt.current||0)||Ge<(ye.current||0),_t=!Pe,Er=!!$n.current;let Yt=Array.isArray(Fe)?Fe:[];if(Yt.length===0&&_t&&xt&&!Er){const lr=Array.isArray(St.current)?St.current:[];lr.length>0&&(Yt=lr)}try{if(!Te&&Array.isArray(Yt)&&Yt.length>0&&qt.current){const lr=Yt.findIndex(xn=>xn&&xn.id===qt.current);lr>0&&(Yt=[Yt[lr],...Yt.filter((ea,Fn)=>Fn!==lr)])}}catch{}if(st(lr=>({...lr,selectedClients:Yt})),Array.isArray(Yt)&&Yt.length>0){St.current=Yt,co(Yt);try{sessionStorage.setItem(Fr,JSON.stringify(Yt))}catch{}$n.current=!1}try{Lr.current=ge}catch{}}catch{}},[Pe,st,co,Fr]);p.useState(""),p.useRef(null),p.useEffect(()=>{try{Qt.current=Date.now()}catch{}},[O,uo]),p.useEffect(()=>{if(w){if(we.current=O,O)E("customer-picker",6e3),S("picker:open"),te.current=!0,It(!0);else if(S("picker:close"),k("picker-close"),yl.current){yl.current=!1;try{j("Picker closed: flushing pending refresh"),S("picker:flush"),Ca()}catch{}}}},[O]);const Ti=p.useCallback((ge,Fe={})=>{if(w)try{const Ge=new Date().toISOString(),xt=ct.current,_t=!!te.current,Er=!!xr.current}catch{}},[w,Q,O,Pe,uo,Et]);p.useEffect(()=>{w&&Ti("state-change",{isCustomerPickerOpen:O,effectiveCustomerPickerOpen:Pe})},[w,O,Pe]),p.useEffect(()=>{if(!Q||Pe)return;const ge=Array.isArray(oe.selectedClients)?oe.selectedClients:[],Fe=Array.isArray(St.current)?St.current:[],Ge=Date.now()<(Dt.current||0);if(ge.length===0&&Fe.length>0&&!$n.current&&Ge)Lr.current="global:restore",st(xt=>({...xt,selectedClients:Fe}));else if(ge.length===0&&Fe.length>0&&$n.current&&!Ge)try{St.current=[]}catch{}},[Q,Pe,oe.selectedClients]),p.useEffect(()=>{if(!Q)return;let ge=te.current;try{const Ge=localStorage.getItem("agenda:customerPicker:desiredAt");if(Ge){const xt=Number(Ge);Number.isFinite(xt)&&Date.now()-xt<3e3&&(ge=!0)}}catch{}if(!ge||O||Date.now()<ye.current||Ie())return;const Fe=Date.now();Fe-$e.current<800||($e.current=Fe,ct.current="open",H(!0),It(!0))},[O,Q]),p.useEffect(()=>{const ge=Array.isArray(oe.selectedClients)?oe.selectedClients:[];ge.length>0&&(St.current=ge,gn(ge),co(ge))},[oe.selectedClients,gn]),p.useEffect(()=>{if(!Q||(wa(),Pe)||te.current)return;const ge=Array.isArray(oe.selectedClients)?oe.selectedClients:[],Fe=(()=>{const Ge=Array.isArray(St.current)?St.current:[];if(Ge&&Ge.length>0)return Ge;try{const xt=sessionStorage.getItem(Fr),_t=xt?JSON.parse(xt):[];return Array.isArray(_t)?_t:[]}catch{return[]}})();ge.length===0&&Fe.length>0&&!$n.current&&(st(Ge=>({...Ge,selectedClients:Fe})),xr.current=!1)},[Pe,Q,wa,Fr]);const cu=p.useRef(0);p.useEffect(()=>{try{const ge=Date.now(),Fe=Array.isArray(Ve.current)?Ve.current:[],Ge=Array.isArray(St.current)?St.current:[];if(ge-cu.current>300&&(cu.current=ge),Q&&!Pe&&Fe.length===0&&Ge.length>0&&!$n.current){try{Lt.current=Date.now()+2e3}catch{}try{const xt=ye?.current||0,_t={ts:new Date().toISOString(),reason:"empty-after-close",modalOpen:Q,pickerOpen:Pe,formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Fe.length,lastLen:Ge.length,clearedByUser:!!$n?.current,lastAction:Lr?.current,chipsLen:Array.isArray(ca)?ca.length:NaN,clientsLoading:!!uo,suppressUntil:xt}}catch{}co(Ge);try{sessionStorage.setItem(Fr,JSON.stringify(Ge))}catch{}st(xt=>({...xt,selectedClients:[...Ge]}));try{Promise.resolve().then(()=>{st(xt=>({...xt,selectedClients:[...St.current]}))})}catch{}try{requestAnimationFrame(()=>{st(xt=>({...xt,selectedClients:[...St.current||[]]}))})}catch{}setTimeout(()=>{const xt=Array.isArray(Ve.current)?Ve.current:[],_t=Array.isArray(St.current)?St.current:[];xt.length===0&&_t.length>0&&st(Er=>({...Er,selectedClients:[..._t]}))},25),setTimeout(()=>{const xt=Array.isArray(Ve.current)?Ve.current:[],_t=Array.isArray(St.current)?St.current:[];xt.length===0&&_t.length>0&&st(Er=>({...Er,selectedClients:[..._t]}))},120),setTimeout(()=>{const xt=Array.isArray(Ve.current)?Ve.current:[],_t=Array.isArray(St.current)?St.current:[];xt.length===0&&_t.length>0&&st(Er=>({...Er,selectedClients:[..._t]}))},240)}}catch{}},[oe.selectedClients,Pe,Q]),p.useEffect(()=>{try{const ge=now<(Lt.current||0),Fe=Array.isArray(Ve.current)?Ve.current:[],Ge=Array.isArray(St.current)?St.current:[],xt=now<(Dt.current||0);if(Q&&!Pe&&(ge||xt)&&Fe.length===0&&Ge.length>0&&!$n.current){da(Ge);try{sessionStorage.setItem(Fr,JSON.stringify(Ge))}catch{}st(_t=>({..._t,selectedClients:[...Ge]}));try{requestAnimationFrame(()=>st(_t=>({..._t,selectedClients:[...St.current||[]]})))}catch{}setTimeout(()=>st(_t=>({..._t,selectedClients:[...St.current||[]]})),32),setTimeout(()=>st(_t=>({..._t,selectedClients:[...St.current||[]]})),96)}}catch{}},[oe.selectedClients,Pe,Q]),p.useEffect(()=>{const ge=Date.now();if(ge<(ke.current||0)||!Q||Pe||ge>=(Dt.current||0))return;const Fe=Array.isArray(oe.selectedClients)?oe.selectedClients:[],Ge=Array.isArray(St.current)?St.current:[];if(Fe.length===0&&Ge.length>0){da(Ge);try{sessionStorage.setItem(Fr,JSON.stringify(Ge))}catch{}st(xt=>({...xt,selectedClients:[...Ge]})),Promise.resolve().then(()=>st(xt=>({...xt,selectedClients:[...St.current||[]]}))),setTimeout(()=>st(xt=>({...xt,selectedClients:[...St.current||[]]})),24),setTimeout(()=>st(xt=>({...xt,selectedClients:[...St.current||[]]})),80),setTimeout(()=>st(xt=>({...xt,selectedClients:[...St.current||[]]})),240)}},[oe.selectedClients,Q,Pe]);const[bl,Hs]=p.useState([]);p.useEffect(()=>{a&&Hs([])},[a]);const xi=p.useRef(!1),Ko=p.useRef(!1),[du,Oc]=p.useState(null);p.useState(null);const Tc=p.useRef(!1);p.useEffect(()=>{const ge=Array.isArray(oe.selectedClients)?oe.selectedClients:[],Fe=du,Ge=Fe&&ge.some(xt=>xt&&xt.id===Fe);ge.length>0&&!Ge?Oc(ge[0]?.id||null):ge.length===0&&Fe&&Oc(null)},[oe.selectedClients,Q,Te]);const io=p.useRef(!1),Vl=p.useRef(!1),[vo,Ps]=p.useState(Zr),Xu=p.useRef(0);p.useEffect(()=>{if(!(Date.now()<(ke.current||0)))if(uo){Xu.current||(Xu.current=Date.now());const Fe=setTimeout(()=>{uo&&(!Array.isArray(vo)||vo.length===0)&&ds(!1)},2e3);return()=>clearTimeout(Fe)}else Xu.current=0},[uo,vo]);const Ic=p.useMemo(()=>Array.isArray(oe.selectedClients)?oe.selectedClients:[],[oe.selectedClients]),Dh=p.useMemo(()=>{const ge=Ic||[];if(ge.length===0)return"Adicionar clientes";const Fe=ge[0]?.nome||"Cliente",Ge=ge.length-1;return Ge>0?`${Fe} +${Ge}`:Fe},[Ic]),Yf=p.useMemo(()=>{const ge=Array.isArray(oe.selectedClients)?oe.selectedClients:[],Fe=Array.isArray(Ve.current)?Ve.current:[],Ge=Array.isArray(St.current)?St.current:[],xt=Array.isArray(ca)?ca:[];return ge.length>0&&ge.every(_t=>_t?.nome)?ge:ge.length>0?ge.map(_t=>{if(_t?.nome)return _t;const Er=Fe.find(ea=>ea?.id===_t?.id),Yt=Ge.find(ea=>ea?.id===_t?.id),lr=xt.find(ea=>ea?.id===_t?.id),xn=(vo||[]).find(ea=>ea?.id===_t?.id);return{..._t,nome:Er?.nome||Yt?.nome||lr?.nome||xn?.nome||_t?.nome||"Cliente"}}):Fe.length>0&&Fe.every(_t=>_t?.nome)?Fe:xt.length>0&&xt.every(_t=>_t?.nome)?xt:Ge.length>0&&Ge.every(_t=>_t?.nome)?Ge:ge},[oe.selectedClients,ca,vo]);p.useEffect(()=>{if(!(Date.now()<(ke.current||0)))try{j("Chips:effective change",{effectiveLen:Array.isArray(Ic)?Ic.length:0,formLen:Array.isArray(oe.selectedClients)?oe.selectedClients.length:0,lastLen:Array.isArray(St.current)?St.current.length:0,pickerOpen:O})}catch{}},[Ic,oe.selectedClients,O]);const Dc=p.useRef(null),Mc=p.useRef(!1);p.useEffect(()=>{if(Q){Array.isArray(Zr)&&Zr.length>0&&Ps(Zr);try{if(!vo||vo.length===0){const ge=A?.codigo_empresa?`clientes:list:${A.codigo_empresa}`:null;if(ge){const Fe=JSON.parse(localStorage.getItem(ge)||"[]");Array.isArray(Fe)&&Fe.length>0&&Ps(Fe)}}}catch{}}},[Q,Zr]),p.useEffect(()=>{Q||(Dc.current=null,ds(!1))},[Q]),p.useEffect(()=>{Q||(xi.current=!1,Ko.current=!1,Xi(!1),Vl.current=!1)},[Q]);const Rc=p.useRef(!1);p.useEffect(()=>{if(Q&&!Rc.current){Rc.current=!0;try{const ge=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",Fe=sessionStorage.getItem("agenda:customerPicker:closingAt"),Ge=Fe?Number(Fe):0,xt=Ge&&Date.now()-Ge<1e4;ge&&xt?ie.current=ge:ie.current||(ie.current=`${Date.now()}-${Math.random().toString(36).slice(2)}`),sessionStorage.setItem("agenda:modal:sessionId",ie.current)}catch{}if(!Te){try{const ge=sessionStorage.getItem("agenda:customerPicker:closingAt"),Fe=ge?Number(ge):0,Ge=Fe&&Date.now()-Fe<1e4,xt=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",_t=sessionStorage.getItem("agenda:modal:sessionId")||"",Er=sessionStorage.getItem(Fr),Yt=Er?JSON.parse(Er):[];if(Ge&&Array.isArray(Yt)&&Yt.length>0&&xt&&_t&&xt===_t){try{Qe.current=!0}catch{}st(lr=>({...lr,selectedClients:Yt})),St.current=Yt,co(Yt);try{$n.current=!1}catch{}try{Promise.resolve().then(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})))}catch{}try{requestAnimationFrame(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})))}catch{}setTimeout(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})),24),setTimeout(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})),96);return}if(Ge&&Array.isArray(Yt)&&Yt.length>0){try{Qe.current=!0}catch{}st(lr=>({...lr,selectedClients:Yt})),St.current=Yt,co(Yt);try{$n.current=!1}catch{}try{Promise.resolve().then(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})))}catch{}try{requestAnimationFrame(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})))}catch{}setTimeout(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})),24),setTimeout(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})),96);return}}catch{}try{if(Date.now()<(ne.current||0))return}catch{}try{te.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{const ge=sessionStorage.getItem(Fr),Fe=ge?JSON.parse(ge):[],Ge=Array.isArray(St.current)?St.current:[];if(!(Array.isArray(Fe)&&Fe.length>0||Array.isArray(Ge)&&Ge.length>0)){try{St.current=[]}catch{}try{da([])}catch{}try{$n.current=!1}catch{}st(xt=>({...xt,selectedClients:[]}))}}catch{try{St.current=[]}catch{}try{da([])}catch{}try{$n.current=!1}catch{}st(ge=>({...ge,selectedClients:[]}))}}}else!Q&&Rc.current;if(Te)Gs.current=!1;else{if(Gs.current)return;Gs.current=!0;try{const ge=sessionStorage.getItem("agenda:customerPicker:closingAt"),Fe=ge?Number(ge):0,Ge=Fe&&Date.now()-Fe<5e3,xt=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",_t=sessionStorage.getItem("agenda:modal:sessionId")||"",Er=sessionStorage.getItem(Fr),Yt=Er?JSON.parse(Er):[];if(Ge&&Array.isArray(Yt)&&Yt.length>0&&xt&&_t&&xt===_t){try{Qe.current=!0}catch{}st(lr=>({...lr,selectedClients:Yt})),St.current=Yt,co(Yt);try{$n.current=!1}catch{}try{Promise.resolve().then(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})))}catch{}try{requestAnimationFrame(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})))}catch{}setTimeout(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})),24),setTimeout(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})),96);return}if(Ge&&Array.isArray(Yt)&&Yt.length>0){try{Qe.current=!0}catch{}st(lr=>({...lr,selectedClients:Yt})),St.current=Yt,co(Yt);try{$n.current=!1}catch{}try{Promise.resolve().then(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})))}catch{}try{requestAnimationFrame(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})))}catch{}setTimeout(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})),24),setTimeout(()=>st(lr=>({...lr,selectedClients:[...St.current||[]]})),96);return}}catch{}try{if(Date.now()<(ne.current||0))return}catch{}try{te.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{$n.current=!1}catch{}try{const ge=sessionStorage.getItem(Fr),Fe=ge?JSON.parse(ge):[],Ge=Array.isArray(St.current)?St.current:[];if(!(Array.isArray(Fe)&&Fe.length>0||Array.isArray(Ge)&&Ge.length>0)){try{St.current=[]}catch{}try{da([])}catch{}st(xt=>({...xt,selectedClients:[]}))}}catch{try{St.current=[]}catch{}try{da([])}catch{}st(ge=>({...ge,selectedClients:[]}))}}},[Q,Te]);const Gs=p.useRef(!1);p.useEffect(()=>{if(!Q){Gs.current=!1;try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt"),sessionStorage.removeItem("agenda:customerPicker:sessionId"),sessionStorage.removeItem("agenda:modal:sessionId"),ie.current="",sessionStorage.removeItem(Fr);try{St.current=[]}catch{}try{da([])}catch{}try{Qe.current=!1}catch{}try{ne.current=0}catch{}try{Dt.current=0}catch{}je(!1),Ue(4);try{ye.current=0}catch{}try{ct.current=null}catch{}try{te.current=!1}catch{}st(ge=>({...ge,selectedClients:[]})),Oc(null)}catch{}return}if(Te)Gs.current=!1;else{if(Gs.current)return;Gs.current=!0;try{if(Date.now()<(ne.current||0))return}catch{}try{te.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{$n.current=!1}catch{}try{const ge=sessionStorage.getItem(Fr),Fe=ge?JSON.parse(ge):[],Ge=Array.isArray(St.current)?St.current:[];if(!(Array.isArray(Fe)&&Fe.length>0||Array.isArray(Ge)&&Ge.length>0)){try{St.current=[]}catch{}try{da([])}catch{}st(xt=>({...xt,selectedClients:[]}))}}catch{try{St.current=[]}catch{}try{da([])}catch{}st(ge=>({...ge,selectedClients:[]}))}}},[Q,Te]);const Yo=p.useCallback(async(ge={})=>{const{autoSave:Fe=!1}=ge;if(!xa){Xi(!0);try{const Ge=Mt[oe.court];if(!Ge){t({title:"Selecione uma quadra",variant:"destructive"}),xi.current=!1,Ko.current=!1;return}const xt=oe.startMinutes,_t=oe.endMinutes;if(!(Number.isFinite(xt)&&Number.isFinite(_t)&&_t>xt)){t({title:"Horrio invlido",variant:"destructive"}),xi.current=!1,Ko.current=!1;return}if(!ua(xt,_t)){t({title:"Conflito de horrio",description:"O horrio selecionado est ocupado.",variant:"destructive"}),xi.current=!1,Ko.current=!1;return}const Yt=(Rn,ga)=>new Date(Rn.getFullYear(),Rn.getMonth(),Rn.getDate(),Math.floor(ga/60),ga%60,0,0),lr=Yt(oe.date,xt),xn=Yt(oe.date,_t);let ea=Array.isArray(oe.selectedClients)&&oe.selectedClients.length>0?oe.selectedClients:Array.isArray(Ve.current)?Ve.current:[];if((!ea||ea.length===0)&&Te?.id)try{const Rn=Array.isArray(St.current)?St.current:[];Rn&&Rn.length>0&&(ea=Rn,st(ga=>({...ga,selectedClients:Rn})))}catch{}const Fn=[...ea];console.log(" [FIX] selNowSnapshot criado:",Fn.length,"participantes"),console.log(" [FIX] form.selectedClients:",oe.selectedClients?.length||0),console.log(" [FIX] editingBooking.id:",Te?.id),console.log(" [LOG 3 - FECHAR MODAL AGENDAMENTO] Estado ao salvar:"),console.log("   Participantes selecionados:",Fn.length),Fn.forEach((Rn,ga)=>{console.log(`   #${ga+1}: ${Rn.nome}`)}),console.log("   participantsForm (contexto):",(h||[]).length),(h||[]).forEach((Rn,ga)=>{console.log(`   #${ga+1}: ${Rn.nome} | Status: ${Rn.status_pagamento} | Valor: ${Rn.valor_cota}`)});let rn=Fn,Wa=!1;if(Te?.id){const Rn=Fn.map(Ya=>Ya.nome).sort().join("|");let ga="";const As=yt[Te.id]||[];if(As.length>0&&(ga=As.map(Ya=>Ya.nome).sort().join("|")),Wa=Rn!==ga,console.log(" [DEBUG] Comparao de nomes:"),console.log("   nomesAtuais:",Rn),console.log("   nomesOriginais:",ga),console.log("   editingBooking.clientes:",Te.clientes),console.log("   houveMudancaDeParticipantes:",Wa),!Wa){let Ya=[];if(Te.clientes)try{Ya=Array.isArray(Te.clientes)?Te.clientes:JSON.parse(Te.clientes)}catch{Ya=(yt[Te.id]||[]).map(Xa=>Xa.nome)}else Ya=(yt[Te.id]||[]).map(Xa=>Xa.nome);Ya.length>0&&(rn=[...ea].sort((Ii,Xa)=>{const Ro=Ya.findIndex(Di=>Di===Ii.nome),fs=Ya.findIndex(Di=>Di===Xa.nome);return Ro!==-1&&fs!==-1?Ro-fs:Ro!==-1?-1:fs!==-1?1:0}))}}const Ra=rn[0],pa=rn.map(ze).filter(Boolean);if(!Te?.id&&!Ra?.id){t({title:"Selecione um cliente",description:"Para criar um agendamento, selecione pelo menos um cliente.",variant:"destructive"});return}if(Te?.id){const Rn=Te.status,ga=oe.status!==Rn,As={quadra_id:Ge.id,cliente_id:Ra?.id??null,clientes:pa,inicio:lr.toISOString(),fim:xn.toISOString(),modalidade:oe.modality};if(!ga){let fa=oe.status;try{const si=bt(),Co=lr.getTime();if(!!We?.autoConfirmEnabled&&Number.isFinite(Number(We?.autoConfirmMinutesBefore))){const Ks=Number(We.autoConfirmMinutesBefore)*6e4,_d=Co-Ks;fa==="confirmed"&&si<_d?fa="scheduled":fa==="scheduled"&&si>=_d&&(fa="confirmed")}}catch{}As.status=fa}const{error:Ya}=await pe.from("agendamentos").update(As).eq("codigo_empresa",A.codigo_empresa).eq("id",Te.id);if(Ya)throw Ya;const{data:Ii}=await pe.from("agendamento_participantes").select("*").eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",Te.id).order("ordem",{ascending:!0}).order("id",{ascending:!0}),Xa=Ii||[];if(console.log(" [SAVE-BOOKING] houveMudancaDeParticipantes:",Wa),console.log(" [SAVE-BOOKING] currentArray.length:",Xa.length),console.log(" [SAVE-BOOKING] selNowFinal.length:",rn.length),Wa){if(!rn||rn.length===0)console.error(" [SAVE-BOOKING] PROTEO ACIONADA: No vou deletar participantes com selNowFinal vazio!"),console.error(" [SAVE-BOOKING] Isso evita perda de dados. Verifique por que selNowFinal est vazio.");else{console.log(" [SAVE-BOOKING] Deletando e recriando participantes...");const{error:fa}=await pe.from("agendamento_participantes").delete().eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",Te.id);fa&&console.error("Erro ao deletar participantes:",fa)}if(rn&&rn.length>0){const fa=rn.map((Co,Ji)=>{const Ks=Xa[Ji],_d=Ks&&Ks.cliente_id===Co.id;return{codigo_empresa:A.codigo_empresa,agendamento_id:Te.id,cliente_id:Co.id,nome:Co.nome,ordem:Ji+1,valor_cota:_d?Ks.valor_cota??0:0,status_pagamento:_d?Ks.status_pagamento??"Pendente":"Pendente",finalizadora_id:_d?Ks.finalizadora_id??null:null,aplicar_taxa:_d?Ks.aplicar_taxa??!1:!1,pago_em:_d?Ks.pago_em??null:null}}),{error:si}=await pe.from("agendamento_participantes").insert(fa);si&&console.error("Erro ao inserir participantes:",si)}}const Ro=Ra?.nome||Ra?.name||ze(Ra)||pa[0]||Te.customer,fs={...Te,court:oe.court,customer:Ro,start:lr,end:xn,modality:oe.modality,...ga?{}:{status:As.status??oe.status}};if(G(fa=>fa.map(si=>si.id===Te.id?fs:si)),at(fs),ga)try{ae(!1),await vn(Te.id,oe.status,"user")}catch{}Fe||t({title:"Agendamento atualizado"}),Ko.current=!0,xi.current=!1;const Di=ea.map((fa,si)=>{const Co=Xa.find(Ks=>Ks.cliente_id===fa.id),Ji=!!Co;return{cliente_id:fa.id,nome:fa.nome,codigo:fa.codigo||null,valor_cota:Ji?Co.valor_cota??0:0,status_pagamento:Ji?Co.status_pagamento??"Pendente":"Pendente",finalizadora_id:Ji?Co.finalizadora_id??null:null,aplicar_taxa:Ji?Co.aplicar_taxa??!1:!1,ordem:si+1}});if(vt(fa=>({...fa,[Te.id]:Di})),console.log(" [FIX] houveMudancaDeParticipantes =",Wa),Wa?(console.log(" [FIX] Mudana de participantes detectada - reconstruindo participantsForm"),v(Di.map(fa=>({cliente_id:fa.cliente_id,nome:fa.nome,codigo:fa.codigo,valor_cota:fa.valor_cota?Yg(String(Number(fa.valor_cota).toFixed(2))):"",status_pagamento:fa.status_pagamento,finalizadora_id:fa.finalizadora_id?String(fa.finalizadora_id):y?.[0]?.id?String(y[0].id):null,aplicar_taxa:fa.aplicar_taxa})))):(console.log(" [FIX] Sem mudana de participantes - preservando dados de pagamento do contexto"),v(fa=>{const si=(fa||[]).map(Co=>{const Ji=Di.find(Ks=>Ks.cliente_id===Co.cliente_id);return Ji?{cliente_id:Co.cliente_id,nome:Co.nome||Ji.nome,codigo:Co.codigo??Ji.codigo,valor_cota:Co.valor_cota||Ji.valor_cota,status_pagamento:Co.status_pagamento||Ji.status_pagamento,finalizadora_id:Co.finalizadora_id??Ji.finalizadora_id,aplicar_taxa:Co.aplicar_taxa??Ji.aplicar_taxa}:Co});return console.log(" [FIX] Dados de pagamento preservados:",si),si.length>0?si:Di})),console.log(" [LOG 3 - RESULTADO FINAL] participantsForm aps atualizao:"),console.log("   Total:",Di.length),Di.forEach((fa,si)=>{console.log(`   #${si+1}: ${fa.nome} | Status: ${fa.status_pagamento} | Valor: ${fa.valor_cota}`)}),r().catch(fa=>{console.error("[AgendaPage] Erro ao recarregar alertas:",fa)}),!Fe){try{St.current=[]}catch{}try{da([])}catch{}try{sessionStorage.removeItem(Fr)}catch{}ae(!1)}return}let La=null;try{const{data:Rn}=await pe.from("agendamentos").select("id, status, codigo").eq("codigo_empresa",A.codigo_empresa).eq("quadra_id",Ge.id).eq("inicio",lr.toISOString()).eq("fim",xn.toISOString()).limit(1);Array.isArray(Rn)&&Rn.length>0&&(La=Rn[0])}catch{}if(La?.id&&La.status!=="canceled"){const Rn={id:La.id,code:La.codigo,court:oe.court,customer:Ra?.nome||pa[0]||"",start:lr,end:xn,status:oe.status,modality:oe.modality};G(ga=>ga.some(Ya=>Ya.id===La.id)?ga:[...ga,Rn]),t({title:"Agendamento confirmado"}),Ko.current=!0,ae(!1);return}if(J&&be>1){const Rn=[],ga=[];for(let Xa=0;Xa<be;Xa++){const Ro=Oa(oe.date,Xa*7),fs=new Date(Ro);fs.setHours(Math.floor(oe.startMinutes/60),oe.startMinutes%60,0,0);const Di=new Date(Ro);Di.setHours(Math.floor(oe.endMinutes/60),oe.endMinutes%60,0,0),Rn.push({codigo_empresa:A.codigo_empresa,quadra_id:Ge.id,cliente_id:Ra?.id??null,clientes:pa,inicio:fs.toISOString(),fim:Di.toISOString(),modalidade:oe.modality,status:oe.status})}const{data:As,error:Ya}=await pe.from("agendamentos").insert(Rn).select("id, codigo, inicio, fim");if(Ya)throw Ya;const Ii=[];for(const Xa of As){const Ro=rn.map((fs,Di)=>({codigo_empresa:A.codigo_empresa,agendamento_id:Xa.id,cliente_id:fs.id,nome:fs.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Di+1}));Ii.push(...Ro),ga.push({id:Xa.id,code:Xa.codigo,court:oe.court,customer:Ra?.nome||pa[0]||"",start:new Date(Xa.inicio),end:new Date(Xa.fim),status:oe.status,modality:oe.modality})}Ii.length>0&&await pe.from("agendamento_participantes").insert(Ii),G(Xa=>[...Xa,...ga]),t({title:`${be} Agendamentos criados!`,description:"Agendamentos recorrentes criados com sucesso.",variant:"success"}),je(!1),Ue(4)}else{const{data:Rn,error:ga}=await pe.from("agendamentos").insert({codigo_empresa:A.codigo_empresa,quadra_id:Ge.id,cliente_id:Ra?.id??null,clientes:pa,inicio:lr.toISOString(),fim:xn.toISOString(),modalidade:oe.modality,status:oe.status}).select("id, codigo").single();if(ga)throw ga;const As={id:Rn.id,code:Rn.codigo,court:oe.court,customer:Ra?.nome||pa[0]||"",start:lr,end:xn,status:oe.status,modality:oe.modality};G(Ya=>[...Ya,As]),t({title:"Agendamento criado",variant:"success",duration:2e3}),r().catch(Ya=>{console.error("[AgendaPage] Erro ao recarregar alertas:",Ya)});try{const Ya=rn.map((Ii,Xa)=>({codigo_empresa:A.codigo_empresa,agendamento_id:Rn.id,cliente_id:Ii.id,nome:Ii.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Xa+1}));if(Ya.length>0){const{error:Ii}=await pe.from("agendamento_participantes").insert(Ya);if(!Ii){const Xa=Ya.map(Ro=>({agendamento_id:Ro.agendamento_id,cliente_id:Ro.cliente_id,nome:Ro.nome,codigo:rn.find(fs=>fs.id===Ro.cliente_id)?.codigo||null,valor_cota:Ro.valor_cota,status_pagamento:Ro.status_pagamento,ordem:Ro.ordem}));vt(Ro=>({...Ro,[Rn.id]:Xa}))}}}catch{}}Ko.current=!0,xi.current=!1;try{St.current=[]}catch{}try{da([])}catch{}try{sessionStorage.removeItem(Fr)}catch{}ae(!1)}catch(Ge){t({title:"Erro ao salvar agendamento",description:Ge?.message||"Tentando novamente automaticamente",variant:"destructive"})}finally{Xi(!1)}}},[xa,Mt,oe,Te,A,ua,G,t,ae,vn]);p.useEffect(()=>{if(!Te?.id){Ul.current=!1,Ws.current=null;return}if(!Vl.current||!Ul.current){const Fe=setTimeout(()=>{Vl.current&&(Ul.current=!0,Ws.current=JSON.stringify({court:oe.court,startMinutes:oe.startMinutes,endMinutes:oe.endMinutes,modality:oe.modality,status:oe.status,selectedClients:oe.selectedClients}))},500);return()=>clearTimeout(Fe)}const ge=JSON.stringify({court:oe.court,startMinutes:oe.startMinutes,endMinutes:oe.endMinutes,modality:oe.modality,status:oe.status,selectedClients:oe.selectedClients});if(ge!==Ws.current)return Ma.current&&clearTimeout(Ma.current),Ma.current=setTimeout(async()=>{if(!Mt[oe.court])return;const Ge=oe.startMinutes,xt=oe.endMinutes;if(!(Number.isFinite(Ge)&&Number.isFinite(xt)&&xt>Ge)||!ua(Ge,xt))return;const Er=Ws.current?JSON.parse(Ws.current).selectedClients:[],Yt=oe.selectedClients||[],lr=JSON.stringify(Er)!==JSON.stringify(Yt);console.log(lr?" [Auto-save] Salvando alteraes (participantes modificados)...":" [Auto-save] Salvando alteraes..."),Yu(!0);try{await Yo({autoSave:!0}),Ws.current=ge,console.log(lr?" [Auto-save] Participantes salvos no banco! Disponveis no modal de pagamentos.":" [Auto-save] Salvo com sucesso!")}catch(xn){console.error(" [Auto-save] Erro ao salvar:",xn)}finally{Yu(!1)}},1500),()=>{Ma.current&&clearTimeout(Ma.current)}},[Te?.id,oe.court,oe.startMinutes,oe.endMinutes,oe.modality,oe.status,oe.selectedClients,Mt,ua,Yo]),p.useEffect(()=>{const ge=async()=>{if(!Q||!A?.codigo_empresa)return;const Fe=String(A.codigo_empresa);if(Dc.current!==Fe)try{ds(!0);try{const _t=`clientes:list:${A.codigo_empresa}`,Er=JSON.parse(localStorage.getItem(_t)||"[]");if(Array.isArray(Er)&&Er.length>0){Ps(Er);try{cn(Yt=>JSON.stringify(Yt)===JSON.stringify(Er)?Yt:Er)}catch{}}}catch{}const{data:Ge,error:xt}=await pe.from("clientes").select("id, nome, codigo, email, telefone, status, codigo_empresa, is_consumidor_final").eq("codigo_empresa",A.codigo_empresa).eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0});if(xt){console.error("Falha ao carregar clientes:",xt);return}if(Array.isArray(Ge)){if(Ge.length===0){let _t=0;try{const Er=`clientes:list:${A.codigo_empresa}`,Yt=JSON.parse(localStorage.getItem(Er)||"[]");_t=Array.isArray(Yt)?Yt.length:0}catch{}if(_t>0&&!Mc.current){Mc.current=!0,setTimeout(ge,700);return}}Mc.current=!1,Dc.current=Fe,Ps(Ge);try{const _t=`clientes:list:${A.codigo_empresa}`;localStorage.setItem(_t,JSON.stringify(Ge))}catch{}try{cn(_t=>JSON.stringify(_t)===JSON.stringify(Ge)?_t:Ge)}catch{}}}catch{}finally{ds(!1)}};ge()},[Q,A?.codigo_empresa]),p.useEffect(()=>{const ge=Mt[oe.court];if(!ge)return;const Fe=Number(ge.valor||0);if(!Number.isFinite(Fe)||Fe<=0)return;const Ge=Math.max(0,oe.endMinutes-oe.startMinutes);if(Ge<=0)return;const xt=Ge/ja,_t=Math.round(Fe*xt*100)/100;x(Yg(String(_t.toFixed(2))))},[Mt,oe.court,oe.startMinutes,oe.endMinutes]),p.useEffect(()=>{if(Q&&!Vl.current)if(Te){const ge=fu(Te.start)*60+mu(Te.start),Fe=fu(Te.end)*60+mu(Te.end),Ge=yt[Te.id]||[],xt=Ge.filter(Yt=>Yt&&Yt.cliente_id).map(Yt=>({id:Yt.cliente_id,nome:Yt.nome,codigo:Yt.codigo||null})),_t=Mt[Te.court]?.modalidades||Vh,Er=_t.includes(Te.modality)?Te.modality:_t[0]||"";st({selectedClients:xt,court:Te.court,modality:Er,status:Te.status,date:ti(Te.start),startMinutes:ge,endMinutes:Fe}),io.current=!0,v(Ge.map(Yt=>({cliente_id:Yt.cliente_id,nome:Yt.nome,codigo:Yt.codigo,valor_cota:(()=>{const lr=Number.isFinite(Number(Yt.valor_cota))?Number(Yt.valor_cota):of(Yt.valor_cota);return Yg(String((Number.isFinite(lr)?lr:0).toFixed(2)))})(),status_pagamento:Yt.status_pagamento||"Pendente",finalizadora_id:Yt.finalizadora_id?String(Yt.finalizadora_id):null,aplicar_taxa:Yt.aplicar_taxa||!1}))),Oc(xt[0]?.id||null),(async()=>{try{const{data:Yt,error:lr}=await pe.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, cliente:clientes!agendamento_participantes_cliente_id_fkey ( nome, codigo )").eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",Te.id).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(!lr&&Array.isArray(Yt)){const xn=(oe?.selectedClients||[]).slice();let ea=Yt.slice();if(xn.length>0){const rn=new Map;Yt.forEach(pa=>{const La=rn.get(pa.cliente_id)||[];La.push(pa),rn.set(pa.cliente_id,La)});const Wa=new Map,Ra=[];for(const pa of xn){const La=Wa.get(pa.id)||0,ga=(rn.get(pa.id)||[])[La];ga&&(Ra.push(ga),Wa.set(pa.id,La+1))}Ra.length===xn.length&&(ea=Ra)}else if(Array.isArray(Te?.clientes)&&Te.clientes.length>0){const rn=new Map;Yt.forEach(pa=>{const La=pa.nome||pa.cliente?.nome||"",Rn=rn.get(La)||[];Rn.push(pa),rn.set(La,Rn)});const Wa=new Map,Ra=[];for(const pa of Te.clientes){const La=Wa.get(pa)||0,ga=(rn.get(pa)||[])[La];ga&&(Ra.push(ga),Wa.set(pa,La+1))}Ra.length===Yt.length&&(ea=Ra)}try{const rn=ea.findIndex(Wa=>String(Wa?.nome||"").toLowerCase()!=="cliente consumidor");if(rn>0){const Wa=ea.splice(rn,1)[0];ea.unshift(Wa)}}catch{}const Fn=ea.filter(rn=>rn&&rn.cliente_id).map(rn=>({id:rn.cliente_id,nome:rn.nome||rn.cliente?.nome||"",codigo:rn.cliente?.codigo||null}));st(rn=>({...rn,selectedClients:Fn})),v(ea.map(rn=>({cliente_id:rn.cliente_id,nome:rn.nome||rn.cliente?.nome||"",codigo:rn.cliente?.codigo||null,valor_cota:(()=>{const Wa=Number.isFinite(Number(rn.valor_cota))?Number(rn.valor_cota):of(rn.valor_cota);return Yg(String((Number.isFinite(Wa)?Wa:0).toFixed(2)))})(),status_pagamento:rn.status_pagamento||"Pendente",finalizadora_id:rn.finalizadora_id?String(rn.finalizadora_id):null,aplicar_taxa:rn.aplicar_taxa||!1}))),Oc(Fn[0]?.id||null)}}catch(Yt){console.error("Falha ao carregar participantes (refresh)",Yt)}})(),Vl.current=!0,Ws.current=JSON.stringify({court:Te.court,startMinutes:ge,endMinutes:Fe,modality:Er,status:Te.status,selectedClients:xt})}else if(Sa){const ge=(Ir||[]).includes(Sa.court)?Sa.court:(Ir||[])[0]||"",Fe={selectedClients:Qe.current?Array.isArray(oe.selectedClients)?oe.selectedClients:[]:[],court:ge,modality:(()=>(Mt[ge]?.modalidades||Vh)[0]||"")(),status:"scheduled",date:Sa.date??D,startMinutes:Sa.startMinutes??rt(),endMinutes:Sa.endMinutes??rt()+60};st(Fe),v([]),io.current=!0,Vl.current=!0}else{const ge=Ir[0]||"",Fe=Mt[ge]?.modalidades||Vh,Ge=Array.isArray(ca)?ca:[],xt=Qe.current?Array.isArray(oe.selectedClients)?oe.selectedClients:[]:Ge.length>0?Ge:[];if(!Qe.current&&Ge.length>0)try{Qe.current=!0}catch{}st({selectedClients:xt,court:ge,modality:Fe[0]||"",status:"scheduled",date:D,startMinutes:rt(),endMinutes:rt()+60}),v([]),io.current=!0,Vl.current=!0}},[Q,Te,D,Sa,Ir,Vh,yt]),p.useEffect(()=>{if(Q&&Te){Vl.current=!1,Tc.current=!1,Qe.current||st(ge=>({...ge,selectedClients:[]}));try{$n.current=!1}catch{}}},[Te,Q]),p.useEffect(()=>{if(Q)try{Tc.current=!1}catch{}},[Q]),p.useEffect(()=>{if(!Q||!Te||Tc.current||Ul.current)return;const ge=yt[Te.id]||[];if(!ge.length)return;let Fe=ge.slice();const Ge=(oe?.selectedClients||[]).slice();if(Ge.length>0){const _t=new Map;ge.forEach(lr=>{const xn=_t.get(lr.cliente_id)||[];xn.push(lr),_t.set(lr.cliente_id,xn)});const Er=new Map,Yt=[];for(const lr of Ge){const xn=Er.get(lr.id)||0,Fn=(_t.get(lr.id)||[])[xn];Fn&&(Yt.push(Fn),Er.set(lr.id,xn+1))}Yt.length===Ge.length&&(Fe=Yt)}else if(Array.isArray(Te?.clientes)&&Te.clientes.length>0){const _t=new Map;ge.forEach(lr=>{const xn=lr.nome||"",ea=_t.get(xn)||[];ea.push(lr),_t.set(xn,ea)});const Er=new Map,Yt=[];for(const lr of Te.clientes){const xn=Er.get(lr)||0,Fn=(_t.get(lr)||[])[xn];Fn&&(Yt.push(Fn),Er.set(lr,xn+1))}Yt.length===ge.length&&(Fe=Yt)}try{const _t=Fe.findIndex(Er=>String(Er?.nome||"").toLowerCase()!=="cliente consumidor");if(_t>0){const Er=Fe.splice(_t,1)[0];Fe.unshift(Er)}}catch{}const xt=Fe.filter(_t=>_t&&_t.cliente_id).map(_t=>({id:_t.cliente_id,nome:_t.nome,codigo:_t.codigo||null}));if(xt.length>0){try{localStorage.getItem("debug:agenda")==="1"&&(console.log("[ORDER-AGENDA] chipsIdsNow:",Ge.map(_t=>_t.id)),console.log("[ORDER-AGENDA] selectedFromPartsIds:",xt.map(_t=>_t.id)))}catch{}st(_t=>({..._t,selectedClients:xt})),v(Fe.map(_t=>({cliente_id:_t.cliente_id,nome:_t.nome,codigo:_t.codigo||null,valor_cota:(()=>{const Er=Number.isFinite(Number(_t.valor_cota))?Number(_t.valor_cota):of(_t.valor_cota);return Yg(String((Number.isFinite(Er)?Er:0).toFixed(2)))})(),status_pagamento:_t.status_pagamento||"Pendente",finalizadora_id:_t.finalizadora_id||null,aplicar_taxa:_t.aplicar_taxa||!1}))),Oc(xt[0]?.id||null),Tc.current=!0}},[Q,Te,yt]),p.useEffect(()=>{const ge=Fe=>{if(Q&&!a){if(Fe.key==="Escape"){if(Fe.preventDefault(),Te?.id){console.log(" [Auto-save] Salvando ao fechar modal (ESC)..."),Ma.current&&clearTimeout(Ma.current),Yo({autoSave:!0}).then(()=>{console.log(" [Auto-save] Salvo ao fechar (ESC)!"),ae(!1)}).catch(Ge=>{console.error(" [Auto-save] Erro ao salvar ao fechar (ESC):",Ge),ae(!1)});return}ae(!1)}Fe.key==="Enter"&&!["INPUT","TEXTAREA"].includes(Fe.target.tagName)&&(Fe.preventDefault(),!xi.current&&!Ko.current&&(xi.current=!0,Ko.current=!1,Yo().catch(()=>{}))),Te&&(Fe.key==="F3"&&(Fe.preventDefault(),Yi(!0)),Fe.key==="F4"&&(Fe.preventDefault(),i()))}};return window.addEventListener("keydown",ge),()=>window.removeEventListener("keydown",ge)},[Q,Te,a,i,Yi,Yo,xi,Ko,ae,oe]);const yi=p.useMemo(()=>{const ge=Mt[oe.court];if(!ge)return{start:de*60,end:Le*60};const[Fe,Ge]=String(ge.hora_inicio||"06:00:00").split(":").map(Number),[xt,_t]=String(ge.hora_fim||"24:00:00").split(":").map(Number),Er=xt===0&&_t===0?24:xt;return{start:Fe*60+(Ge||0),end:Er*60+(_t||0)}},[Mt,oe.court,de,Le]),us=p.useMemo(()=>{const ge=Xt(oe.date,"yyyy-MM-dd"),Fe=Ge=>{const xt=fu(Ge),_t=mu(Ge);return xt===0&&_t===0?1440:xt*60+_t};return me.filter(Ge=>Ge.court===oe.court&&Xt(Ge.start,"yyyy-MM-dd")===ge&&Ge.status!=="canceled"&&(!Te||Ge.id!==Te.id)).map(Ge=>[Fe(Ge.start),Fe(Ge.end)]).sort((Ge,xt)=>Ge[0]-xt[0])},[me,oe.court,oe.date,Te]),Lc=(ge,Fe,Ge,xt)=>ge<xt&&Ge<Fe;function ua(ge,Fe){if(Fe<=ge||ge<yi.start||Fe>yi.end)return!1;for(const[Ge,xt]of us)if(Lc(ge,Fe,Ge,xt))return!1;return!0}const Ka=ge=>{let Fe=ge+ja;if(!ua(ge,Fe))return null;for(;Fe+ja<=yi.end&&ua(ge,Fe+ja);)Fe+=ja;return Fe},zo=p.useMemo(()=>{const ge=yi,Fe=[];for(let Ge=ge.start;Ge<=ge.end;Ge+=ja){const xt=ua(Ge,Ge+ja);let _t=Math.floor(Ge/60);const Er=Ge%60;_t>=24&&Ge===1440&&(_t=0),Fe.push({value:Ge,label:`${String(_t).padStart(2,"0")}:${String(Er).padStart(2,"0")}`,available:xt})}return Fe},[yi,us]),ii=p.useMemo(()=>{const ge=Ka(oe.startMinutes),Fe=[];for(let Ge=oe.startMinutes+ja;Ge<=yi.end;Ge+=ja){const xt=!!ge&&Ge<=ge;let _t=Math.floor(Ge/60);const Er=Ge%60;_t>=24&&(_t=_t%24),Fe.push({value:Ge,label:`${String(_t).padStart(2,"0")}:${String(Er).padStart(2,"0")}`,available:xt})}return Fe},[oe.startMinutes,us,yi]);p.useEffect(()=>{if(io.current){io.current=!1;return}const Fe=(()=>{if(ua(oe.startMinutes,oe.startMinutes+ja))return oe.startMinutes;for(let _t=Math.max(yi.start,oe.startMinutes);_t<=yi.end-ja;_t+=ja)if(ua(_t,_t+ja))return _t;for(let _t=yi.start;_t<=yi.end-ja;_t+=ja)if(ua(_t,_t+ja))return _t;return oe.startMinutes})();if(Fe!==oe.startMinutes){st(_t=>({..._t,startMinutes:Fe}));return}const Ge=Ka(Fe);if(!Ge)return;let xt=oe.endMinutes;(!Number.isFinite(xt)||xt<=Fe||xt>Ge)&&(xt=Math.min(Fe+60,Ge),xt<Fe+ja&&(xt=Fe+ja),st(_t=>({..._t,endMinutes:xt})))},[oe.startMinutes,oe.court,oe.date,us,yi]);const Nd=p.useMemo(()=>Mt[oe.court]?.modalidades||Vh,[Mt,oe.court]);p.useEffect(()=>{const ge=Mt[oe.court]?.modalidades||Vh;ge.includes(oe.modality)||st(Fe=>({...Fe,modality:ge[0]||""}))},[oe.court,Mt]),p.useEffect(()=>{if(io.current||!zs(oe.date,D))return;if(ce[oe.court]&&!ce[oe.court].funciona){const Ge=Ir.find(xt=>!ce[xt]||ce[xt].funciona);Ge&&st(xt=>({...xt,court:Ge}))}},[oe.court,oe.date,ce,Ir,D]);const Mh=p.useMemo(()=>{const ge=Math.max(0,oe.endMinutes-oe.startMinutes),Fe=Math.floor(ge/60),Ge=ge%60;return Fe>0&&Ge>0?`${Fe}h ${Ge}min`:Fe>0?`${Fe}h`:`${Ge}min`},[oe.startMinutes,oe.endMinutes]),Ju=p.useMemo(()=>{if(!Q)return"";const ge=new Date,Fe=fu(ge)*60+mu(ge),Ge=Number(oe.startMinutes),xt=Number(oe.endMinutes),_t=Er=>{let Yt=Math.floor(Er/60);const lr=Er%60;return Yt>=24&&(Yt=Yt%24),`${String(Yt).padStart(2,"0")}:${String(lr).padStart(2,"0")}`};if(We.autoConfirmEnabled&&oe.status==="scheduled"){const Er=Math.max(0,Ge-Number(We.autoConfirmMinutesBefore||0));if(Fe<Er)return`Este agendamento est com automao ativa (Confirmar automaticamente s ${_t(Er)})`}return We.autoStartEnabled&&oe.status==="confirmed"&&Fe<Ge?`Este agendamento est com automao ativa (Iniciar automaticamente s ${_t(Ge)})`:We.autoFinishEnabled&&oe.status==="in_progress"&&Fe<xt?`Este agendamento est com automao ativa (Finalizar automaticamente s ${_t(xt)})`:""},[Q,oe.startMinutes,oe.endMinutes,oe.status,We]),Rh=p.useMemo(()=>(h||[]).length,[h]),Sg=p.useMemo(()=>{const Fe=(h||[]).map(lr=>{const xn=of(lr?.valor_cota);return Number.isFinite(xn)?xn:0}).reduce((lr,xn)=>lr+xn,0),Ge=of(g),xt=Number.isFinite(Ge)?Ge:0,_t=Number((xt-Fe).toFixed(2));let Er=0,Yt=0;for(const lr of h||[])(lr?.status_pagamento||"Pendente")==="Pago"?Er++:Yt++;return{totalAssigned:Fe,totalTarget:xt,diff:_t,paid:Er,pending:Yt}},[h,g]);p.useEffect(()=>{const ge=of(g);if(!Number.isFinite(ge)||ge<=0)return;(h||[]).some(Ge=>of(Ge?.valor_cota)>=ge)&&(h||[]).some(Ge=>Ge.status_pagamento!=="Pago")&&v(Ge=>Ge.map(xt=>({...xt,status_pagamento:"Pago"})))},[h,g]),p.useCallback(()=>{const ge=(oe.selectedClients||[]).length;if(!ge)return;const Fe=of(g);if(!Number.isFinite(Fe)||Fe<0)return;const Ge=Math.round(Fe*100),xt=Math.floor(Ge/ge);let _t=Ge-xt*ge;v(Er=>{const Yt=(oe.selectedClients||[]).slice(),lr=new Map,xn=new Map;return(Er||[]).forEach(Fn=>{const rn=xn.get(Fn.cliente_id)||[];rn.push(Fn),xn.set(Fn.cliente_id,rn)}),Yt.map(Fn=>{const rn=lr.get(Fn.id)||0,Ra=(xn.get(Fn.id)||[])[rn];lr.set(Fn.id,rn+1);const pa=xt+(_t>0?1:0);_t>0&&_t--;const La=(pa/100).toFixed(2),Rn=Yg(String(La)),ga=of(Rn);return{cliente_id:Fn.id,nome:Fn.nome,codigo:Ra?.codigo??Fn.codigo??null,valor_cota:Rn,status_pagamento:Number.isFinite(ga)&&ga>0?"Pago":"Pendente",finalizadora_id:Ra?.finalizadora_id??null,aplicar_taxa:Ra?.aplicar_taxa??!1}})})},[oe.selectedClients,g,v]),p.useCallback(()=>{v(ge=>ge.map(Fe=>({...Fe,valor_cota:"",status_pagamento:"Pendente"})))},[v]);const Xf=p.useCallback(async()=>{try{te.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{ct.current="close"}catch{}try{H(!1),It(!1)}catch{}if(Te?.id&&Ul.current)try{Ma.current&&clearTimeout(Ma.current),console.log(" [CustomerPicker] Salvando participantes ao fechar..."),await Yo({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(ge){console.error(" [CustomerPicker] Erro ao salvar:",ge)}},[Te?.id,Yo]);return o.jsxs(o.Fragment,{children:[tn&&o.jsx(ln,{open:!0,onOpenChange:ge=>{if(!ge&&tn){try{tn.resolve(!1)}catch{}tt(null)}},children:o.jsxs(sn,{onOpenAutoFocus:ge=>ge.preventDefault(),children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Reativar automao?"}),o.jsx(_n,{children:"Ao reativar, este agendamento voltar a ser atualizado automaticamente (incio e trmino) pelas regras da agenda."})]}),o.jsx(Un,{children:o.jsxs("div",{className:"ml-auto flex gap-2",children:[o.jsx(le,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{try{tn?.resolve(!1)}catch{}tt(null)},children:"Cancelar"}),o.jsx(le,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>{try{tn?.resolve(!0)}catch{}tt(null)},children:"Reativar"})]})})]})}),Q&&o.jsx(ln,{open:!0,onOpenChange:async ge=>{if(ge)ae(!0);else{try{const Fe=Date.now()<(ye.current||0);if(Pe||Et||Fe){try{const Ge={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(blocked)",effectiveCustomerPickerOpen:Pe,isClientFormOpen:Et,suppressUntil:ye.current,formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ve.current)?Ve.current.length:NaN,lastLen:Array.isArray(St.current)?St.current.length:NaN};console.warn("[CustomerPicker][DIALOG:block-close]",Ge)}catch{}return}}catch{}try{const Fe={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(allow-close)",effectiveCustomerPickerOpen:Pe,isClientFormOpen:Et,suppressUntil:ye.current,formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ve.current)?Ve.current.length:NaN,lastLen:Array.isArray(St.current)?St.current.length:NaN};console.warn("[CustomerPicker][DIALOG:allow-close]",Fe)}catch{}if(a&&console.log("[Dialog] Fechamento solicitado com PaymentModal aberto - iniciando coordenao"),console.log(" [FLUXO CRTICO] Solicitao de fechamento do modal de agendamento recebida"),console.log(" Estado atual:",{isPaymentModalOpen:a,editingBooking:Te?.id,timestamp:new Date().toISOString()}),a&&typeof window<"u"){console.log(" [FLUXO CRTICO] PaymentModal aberto - solicitando save-and-close");try{await new Promise(Fe=>{const Ge=()=>{window.removeEventListener("paymentmodal:closed",Ge),console.log(" [FLUXO CRTICO] PaymentModal confirmou fechamento"),Fe()},xt=setTimeout(()=>{window.removeEventListener("paymentmodal:closed",Ge),console.warn(" [FLUXO CRTICO] Timeout aguardando PaymentModal fechar"),Fe()},3e3),_t=()=>{clearTimeout(xt),Ge()};window.addEventListener("paymentmodal:closed",_t,{once:!0}),window.dispatchEvent(new Event("paymentmodal:save-and-close"))})}catch{}}ae(!1),at(null),ht(null),Tc.current=!1,console.log(" [FLUXO CRTICO] Modal de agendamento fechado"),je(!1),Ue(4)}},children:o.jsxs(sn,{forceMount:!0,disableAnimations:!0,alignTop:!0,className:"sm:max-w-[960px] max-h-[85vh] min-h-[360px] flex flex-col p-0",onOpenAutoFocus:ge=>ge.preventDefault(),onInteractOutside:async ge=>{try{const Fe=Date.now()<(ye.current||0);if(a||Pe||Et||Fe){try{const Ge={ts:new Date().toISOString(),hook:"DialogContent:onInteractOutside(blocked)",effectiveCustomerPickerOpen:Pe,isClientFormOpen:Et,isPaymentModalOpen:a,suppressUntil:ye.current,formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ve.current)?Ve.current.length:NaN,lastLen:Array.isArray(St.current)?St.current.length:NaN}}catch{}ge.preventDefault();return}if(Te?.id){ge.preventDefault(),console.log(" [Auto-save] Salvando ao clicar fora do modal...");try{Ma.current&&clearTimeout(Ma.current),await Yo({autoSave:!0}),console.log(" [Auto-save] Salvo ao clicar fora!")}catch(Ge){console.error(" [Auto-save] Erro ao salvar ao clicar fora:",Ge)}finally{ae(!1)}return}}catch{}},onEscapeKeyDown:ge=>{try{const Fe=Date.now()<(ye.current||0);if(a||Pe||Et||Fe){ge.preventDefault();return}}catch{}},children:[o.jsxs(an,{className:"px-6 pt-6 pb-4 flex-shrink-0",children:[o.jsxs(nn,{className:"flex items-center justify-between gap-3 flex-wrap",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{children:Te?(()=>{const ge=Te?.code,Fe=typeof ge=="number"?String(ge).padStart(3,"0"):null;return Fe?`Editar agendamento - ${Fe}`:"Editar Agendamento"})():"Novo Agendamento"}),Vs&&o.jsxs("span",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs bg-blue-600/10 text-blue-400 border-blue-700/30",children:[o.jsxs("svg",{className:"w-3 h-3 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]})]}),Te&&(()=>{Sg?.pending===0&&Rh>0;const ge=(Sg?.pending||0)>0,Fe="inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs",Ge="bg-emerald-600/10 text-emerald-400 border-emerald-700/30",xt="bg-amber-600/15 text-amber-400 border-amber-700/30",_t=Er=>o.jsx("span",{"aria-hidden":!0,className:`inline-block w-2 h-2 rounded-full ${Er}`});return o.jsxs("span",{className:`${Fe} ${ge?xt:Ge}`,title:ge?"H pagamentos pendentes":"Todos participantes pagos","aria-live":"polite",children:[_t(ge?"bg-amber-400":"bg-emerald-400"),o.jsx("span",{className:"tracking-wide",children:"Pagos"}),o.jsx("strong",{className:"text-base font-semibold tabular-nums",children:Sg?.paid||0}),o.jsx("span",{className:"opacity-60",children:"/"}),o.jsx("span",{className:"text-base font-semibold tabular-nums",children:Rh})]})})(),o.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-md border text-sm bg-white/5 border-white/10 text-text-primary",title:"Data do agendamento",children:[o.jsx(gi,{className:"w-4 h-4 opacity-80"}),o.jsxs("span",{className:"font-semibold",children:[Xt(oe.date,"dd/MM/yyyy"),(()=>{const ge=Number(oe?.startMinutes),Fe=Number(oe?.endMinutes);if(!(Number.isFinite(ge)&&Number.isFinite(Fe)&&Fe>ge))return"";const xt=_t=>{let Er=Math.floor(_t/60);const Yt=_t%60;return Er>=24&&(Er=Er%24),`${String(Er).padStart(2,"0")}:${String(Yt).padStart(2,"0")}`};return`  ${xt(ge)}${xt(Fe)}`})()]})]})]}),o.jsx(_n,{children:Te?"As alteraes so salvas automaticamente enquanto voc edita.":"Preencha os detalhes para criar uma nova reserva."})]}),o.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:o.jsxs("div",{className:"grid md:grid-cols-2 gap-4 pb-4",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"clientes-field",className:"font-bold",children:"Clientes"}),o.jsxs("div",{className:"flex gap-2 mt-1",children:[o.jsxs(yc,{modal:!1,open:Pe,onOpenChange:ge=>{const Fe=Date.now(),Ge=Fe<(Dt.current||0)||Fe<(ye.current||0)||Fe<(et.current||0)||Ie();if(!((Et||uo)&&ge===!1)){if(!ge&&Ge){Ti("onOpenChange:blocked:guard-window");return}if(!ge&&ct.current!=="close"){Ti("onOpenChange:blocked:sticky-close");return}if(ge){te.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}It(!0),Ti("open:accepted")}else{te.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{const xt=Array.isArray(Ve.current)?[...Ve.current]:[];if(xt.length>0){Lr.current="onOpenChange:close:preserve";try{sessionStorage.setItem(Fr,JSON.stringify(xt))}catch{}co(xt),Cs("onOpenChange:close:preserve",xt)}else $n.current||(Lr.current="onOpenChange:close:empty",Cs("onOpenChange:close:empty",[]))}catch{}try{ye.current=Date.now()+1500}catch{}try{const xt={ts:new Date().toISOString(),hook:"onOpenChange(false)",formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ve.current)?Ve.current.length:NaN,lastLen:Array.isArray(St.current)?St.current.length:NaN,chipsLen:Array.isArray(ca)?ca.length:NaN,clientsLoading:!!uo,lastAction:Lr?.current,clearedByUser:!!$n?.current,suppressUntil:ye.current};console.warn("[CustomerPicker][CLOSE:onOpenChange]",xt)}catch{}It(!1),Ti("close:accepted")}!ge&&xr.current&&(sr(!0),xr.current=!1,setTimeout(()=>sr(!1),1200)),ct.current=ge?"open":"close",H(ge)}},children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{type:"button",variant:"outline",className:Jt("min-w-[180px] justify-between",ar&&"ring-2 ring-emerald-500/40 ring-offset-2 ring-offset-transparent transition-shadow"),onClick:()=>{Ti("trigger:click");try{ct.current="open"}catch{}try{te.current=!0,localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}H(!0),It(!0),setTimeout(()=>{H(!0),It(!0),Ti("trigger:reassert-open")},30),Ti("trigger:after-set-open")},children:[Dh,o.jsx(z1,{className:"w-4 h-4 ml-2 opacity-60"})]})}),o.jsx(Ml,{forceMount:!0,side:"bottom",align:"start",className:"w-[360px] p-2 z-[9999]",onPointerDownOutside:ge=>{const Fe=Date.now();if(Fe<(Dt.current||0)||Fe<(ye.current||0)||Fe<(et.current||0)||Ie()){ge.preventDefault();return}if(Et||uo){ge.preventDefault();return}try{const xt=Array.isArray(Ve.current)?[...Ve.current]:[];if(xt.length>0){Lr.current="outside:close:snapshot",St.current=xt;try{sessionStorage.setItem(Fr,JSON.stringify(xt))}catch{}co(xt),Cs("outside:close:apply",xt),$n.current=!1}else{if(Lr.current="outside:close:empty",$n.current){St.current=[];try{sessionStorage.removeItem(Fr)}catch{}console.warn("[CustomerPicker][outside:close:empty:cleared]",{ts:new Date().toISOString()})}Cs("outside:close:empty",[])}}catch{}try{ye.current=Date.now()+1500}catch{}try{const xt={ts:new Date().toISOString(),hook:"onPointerDownOutside",formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ve.current)?Ve.current.length:NaN,lastLen:Array.isArray(St.current)?St.current.length:NaN,chipsLen:Array.isArray(ca)?ca.length:NaN,clientsLoading:!!uo,lastAction:Lr?.current,clearedByUser:!!$n?.current,suppressUntil:ye.current}}catch{}xr.current=!0,ct.current="close",te.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}H(!1),It(!1),Te?.id&&Ul.current&&(async()=>{try{Ma.current&&clearTimeout(Ma.current),console.log(" [CustomerPicker] Salvando participantes (clique fora)..."),await Yo({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(xt){console.error(" [CustomerPicker] Erro ao salvar:",xt)}})()},onFocusOutside:ge=>{Ti("focusOutside"),(Et||uo)&&ge.preventDefault()},onEscapeKeyDown:ge=>{Ti("escapeKeyDown"),(Et||uo)&&ge.preventDefault()},children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{ref:Oi,placeholder:"Buscar por cdigo ou nome...",value:_e,onChange:ge=>{Oe(ge.target.value),Xe(0)},onKeyDown:ge=>{if(ge.key==="ArrowDown"||ge.key==="ArrowUp"){ge.preventDefault();const Fe=(vo||[]).filter(Yt=>{const lr=_e.trim().toLowerCase();return lr?String(Ye(Yt)||"").toLowerCase().includes(lr):!0}),Ge=Fe.find(Yt=>Yt?.is_consumidor_final===!0),_t=Fe.filter(Yt=>Yt?.is_consumidor_final!==!0).slice().sort((Yt,lr)=>{const xn=typeof Yt=="object"&&Number.isFinite(Number(Yt?.codigo))?Number(Yt.codigo):1/0,ea=typeof lr=="object"&&Number.isFinite(Number(lr?.codigo))?Number(lr.codigo):1/0;if(xn!==ea)return xn-ea;const Fn=String(ze(Yt)||"").toLowerCase(),rn=String(ze(lr)||"").toLowerCase();return Fn.localeCompare(rn)}),Er=Ge?[Ge,..._t]:_t;ge.key==="ArrowDown"?Xe(Yt=>Math.min(Yt+1,Er.length-1)):Xe(Yt=>Math.max(Yt-1,0))}if(ge.key==="Enter"){ge.preventDefault();const Fe=(vo||[]).filter(lr=>{const xn=_e.trim().toLowerCase();return xn?String(Ye(lr)||"").toLowerCase().includes(xn):!0}),Ge=Fe.find(lr=>lr?.is_consumidor_final===!0),_t=Fe.filter(lr=>lr?.is_consumidor_final!==!0).slice().sort((lr,xn)=>{const ea=typeof lr=="object"&&Number.isFinite(Number(lr?.codigo))?Number(lr.codigo):1/0,Fn=typeof xn=="object"&&Number.isFinite(Number(xn?.codigo))?Number(xn.codigo):1/0;if(ea!==Fn)return ea-Fn;const rn=String(ze(lr)||"").toLowerCase(),Wa=String(ze(xn)||"").toLowerCase();return rn.localeCompare(Wa)}),Yt=(Ge?[Ge,..._t]:_t)[ve];if(Yt){const lr=Yt.id,xn=ze(Yt),ea=Yt.codigo,Fn={id:lr,nome:xn,codigo:ea},rn=[...Array.isArray(Ve.current)?Ve.current:[],Fn];try{(Ve.current||[]).length===0&&(qt.current=lr||null)}catch{}try{$n.current=!1}catch{}try{rn.length>0&&(St.current=rn)}catch{}try{Ve.current=rn}catch{}Cs("keyboard:enter",rn),te.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}}}},className:"pl-10 pr-10"}),_e&&o.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary p-1 rounded hover:bg-white/10",onClick:()=>{Oe(""),Oi.current?.focus()},children:o.jsx(Dl,{className:"w-4 h-4"})})]}),o.jsxs("div",{ref:oi,className:"max-h-[260px] overflow-y-auto divide-y divide-border rounded-md border border-border",onWheel:ge=>{ge.stopPropagation()},onTouchMove:ge=>{ge.stopPropagation()},style:{overscrollBehavior:"contain"},children:[uo&&(vo||[]).length===0&&o.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Carregando clientes"}),!uo&&(vo||[]).length===0&&o.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum cliente encontrado"}),!uo&&(()=>{const ge=(vo||[]).filter(Er=>{const Yt=_e.trim().toLowerCase();return Yt?String(Ye(Er)||"").toLowerCase().includes(Yt):!0}),Fe=ge.find(Er=>Er?.is_consumidor_final===!0),xt=ge.filter(Er=>Er?.is_consumidor_final!==!0).slice().sort((Er,Yt)=>{const lr=typeof Er=="object"&&Number.isFinite(Number(Er?.codigo))?Number(Er.codigo):1/0,xn=typeof Yt=="object"&&Number.isFinite(Number(Yt?.codigo))?Number(Yt.codigo):1/0;if(lr!==xn)return lr-xn;const ea=String(ze(Er)||"").toLowerCase(),Fn=String(ze(Yt)||"").toLowerCase();return ea.localeCompare(Fn)});return Fe?[Fe,...xt]:xt})().map((ge,Fe)=>{const Ge=ge?.is_consumidor_final===!0,xt=typeof ge=="object"?ge.id:null,_t=ze(ge),Er=typeof ge=="object"?ge.codigo:null,Yt=String(_t||"").toLowerCase(),lr=Fn=>Fn.id&&xt?Fn.id===xt:String(Fn.nome||"").toLowerCase()===Yt,xn=(oe.selectedClients||[]).some(lr),ea=Fe===ve;return o.jsxs("button",{ref:Fn=>{Da.current[Fe]=Fn},type:"button",className:`w-full text-left py-3 px-4 flex items-center gap-3 transition-all border-b border-border last:border-0 ${ea?"ring-2 ring-blue-500 ring-inset z-10":""} ${Ge?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":xn?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>Xe(Fe),onMouseDown:Fn=>{Fn.stopPropagation()},role:"option","aria-checked":xn,onClick:()=>{const Fn={id:xt,nome:_t,codigo:Er},rn=[...Array.isArray(Ve.current)?Ve.current:[],Fn];try{(Ve.current||[]).length===0&&(qt.current=xt||null)}catch{}try{$n.current=!1}catch{}try{rn.length>0&&(St.current=rn)}catch{}try{Ve.current=rn}catch{}Cs("list:add",rn),te.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}},children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[Er!=null&&o.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${Ge?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",Er]}),o.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[o.jsx("span",{className:`font-medium truncate ${Ge?"text-amber-100/90":""}`,children:_t}),Ge&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),(()=>{const Fn=(oe.selectedClients||[]).filter(rn=>lr(rn)).length;return Fn>0?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:rn=>{rn.stopPropagation();const Wa=Array.isArray(Ve.current)?Ve.current:[],Ra=Wa.findIndex(pa=>lr(pa));if(Ra!==-1){const pa=[...Wa];pa.splice(Ra,1);try{$n.current=pa.length===0}catch{}try{pa.length===0&&(qt.current=null)}catch{}try{pa.length>0&&(St.current=pa)}catch{}try{Ve.current=pa}catch{}Cs("list:remove-one",pa)}},children:"-"}),o.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:Fn}),o.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:rn=>{rn.stopPropagation();const Wa={id:xt,nome:_t,codigo:Er},Ra=[...Array.isArray(Ve.current)?Ve.current:[],Wa];try{(Ve.current||[]).length===0&&(qt.current=xt||null)}catch{}try{$n.current=!1}catch{}try{Ra.length>0&&(St.current=Ra)}catch{}try{Ve.current=Ra}catch{}Cs("list:add-one",Ra)},children:"+"})]}):null})()]},xt||Yt)})]}),o.jsxs("div",{className:"flex items-center justify-between pt-1",children:[o.jsx(le,{type:"button",size:"sm",className:"bg-emerald-600 hover:bg-emerald-500 text-white shadow-md ring-2 ring-emerald-400/40 ring-offset-2 ring-offset-transparent",onMouseDown:ge=>{try{ye.current=Date.now()+3e3}catch{}try{Dt.current=Date.now()+3500}catch{}try{ne.current=Date.now()+5e3}catch{}try{ct.current="close"}catch{}try{te.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{sessionStorage.setItem("agenda:customerPicker:closing","1"),sessionStorage.setItem("agenda:customerPicker:closingAt",String(Date.now()));const Fe=ie.current||sessionStorage.getItem("agenda:modal:sessionId")||"";Fe&&sessionStorage.setItem("agenda:customerPicker:sessionId",Fe);const Ge=Array.isArray(Ve.current)?Ve.current:[];Ge.length>0&&sessionStorage.setItem(Fr,JSON.stringify(Ge));try{const xt={ts:new Date().toISOString(),hook:"conclude:mousedown",modalSessionId:Fe,closingAt:sessionStorage.getItem("agenda:customerPicker:closingAt"),selLen:Array.isArray(Ge)?Ge.length:NaN,formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,lockUntil:Dt.current,suppressUntil:ye.current,isPickerOpen:!!Pe,isModalOpen:!!Q}}catch{}}catch{}ge.stopPropagation()},onClick:()=>{ct.current="close",te.current=!1;try{ne.current=Date.now()+5e3}catch{}try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}kt.current=!0;const Fe=Array.isArray(Ve.current)?[...Ve.current]:[];try{Fe.length>0&&(Lr.current="conclude:close:snapshot",St.current=Fe,sessionStorage.setItem(Fr,JSON.stringify(Fe)))}catch{}co(Fe);try{Dt.current=Date.now()+3e3}catch{}Cs("conclude:close:apply",Fe),st(Ge=>({...Ge,selectedClients:[...Fe]}));try{$n.current=!1}catch{}try{ye.current=Date.now()+2500}catch{}H(!1),It(!1),setTimeout(()=>{try{ye.current=Date.now()+2500}catch{}H(!1),It(!1)},15),setTimeout(()=>{try{ye.current=Date.now()+2500}catch{}H(!1),It(!1)},120),Te?.id&&Ul.current&&(async()=>{try{Ma.current&&clearTimeout(Ma.current),console.log(" [CustomerPicker] Salvando participantes (Concluir)..."),await Yo({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(Ge){console.error(" [CustomerPicker] Erro ao salvar:",Ge)}})();try{ye.current=Date.now()+2500}catch{}try{const Ge={ts:new Date().toISOString(),hook:"conclude:click",formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ve.current)?Ve.current.length:NaN,lastLen:Array.isArray(St.current)?St.current.length:NaN,chipsLen:Array.isArray(ca)?ca.length:NaN,clientsLoading:!!uo,lastAction:Lr?.current,clearedByUser:!!$n?.current,suppressUntil:ye.current,selectionLockUntil:Dt.current,restoreGuardUntil:Lt.current,modalSessionId:ie.current||sessionStorage.getItem("agenda:modal:sessionId")||"",closingAt:sessionStorage.getItem("agenda:customerPicker:closingAt"),pickerOpen:!!Pe,modalOpen:!!Q}}catch{}setTimeout(()=>{try{kt.current=!1}catch{}},3e3)},children:"Concluir"}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("span",{className:"text-xs text-text-muted",children:[(Ic||[]).length," selecionado(s)"]})})]})]})})]}),o.jsx(le,{type:"button",onClick:()=>{try{const ge=Array.isArray(Ve.current)?Ve.current:[];ge.length>0&&(St.current=ge,sessionStorage.setItem(Fr,JSON.stringify(ge)),co(ge),console.warn("[CustomerPicker][+Novo:save-selection]",{savedCount:ge.length}))}catch{}te.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}ct.current="close",H(!1),It(!1),tr(null),Gt(!0)},children:"+ Novo"})]}),Yf.length>0?o.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Yf.map((ge,Fe)=>{const Ge=String(ge?.nome||"").toLowerCase(),xt=`${ge?.id||Ge}-${Fe}`,_t=ge?.id||`__name:${Ge}`;return o.jsxs("span",{className:"text-sm font-medium bg-white/5 border border-white/10 rounded px-2 py-1 flex items-center gap-2",children:[y9(ge.nome),o.jsxs("button",{type:"button","aria-label":"Remover cliente",title:"Remover cliente",className:"text-text-muted hover:text-red-400 p-1 rounded hover:bg-red-500/10",onClick:()=>{j("CustomerPicker:chip:remove",{token:_t,chipIdx:Fe});const Er=(Array.isArray(Ve.current)?Ve.current:[]).filter((Yt,lr)=>lr!==Fe);try{$n.current=Er.length===0}catch{}try{St.current=Er,Er.length===0&&(sessionStorage.removeItem(Fr),console.warn("[CustomerPicker][chip:remove:cleared-all]",{ts:new Date().toISOString()}))}catch{}try{Ve.current=Er}catch{}Cs("chips:remove",Er)},children:[o.jsx(Dl,{className:"w-5 h-5"}),o.jsx("span",{className:"sr-only",children:"Remover"})]})]},xt)})}):null]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"quadra-select",className:"font-bold",children:"Quadra"}),o.jsxs(En,{value:oe.court,onValueChange:ge=>st(Fe=>({...Fe,court:ge})),children:[o.jsx(Sn,{className:"mt-1",onMouseDown:()=>{Pe&&setTimeout(Xf,0)},children:o.jsx(kn,{children:oe.court&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:xm(oe.court)}}),o.jsx("span",{children:oe.court})]})})}),o.jsx(Cn,{className:"z-[60]",children:Ir.map(ge=>{const Fe=Xt(oe.date,"yyyy-MM-dd"),Ge=V[Fe]||{},xt=Ge[ge]&&!Ge[ge].funciona;return o.jsx(Nt,{value:ge,disabled:xt,className:xt?"opacity-50 cursor-not-allowed":"",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:xm(ge)}}),o.jsx("span",{children:ge}),xt&&o.jsx("span",{className:"text-xs text-text-muted ml-auto",children:"(Fechada)"})]})},ge)})})]})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"modalidade-select",className:"font-bold",children:"Modalidade"}),o.jsxs(En,{value:oe.modality,onValueChange:ge=>st(Fe=>({...Fe,modality:ge})),children:[o.jsx(Sn,{className:"mt-1",onMouseDown:()=>{Pe&&setTimeout(Xf,0)},children:o.jsx(kn,{})}),o.jsx(Cn,{children:(Nd||[]).map(ge=>o.jsx(Nt,{value:ge,children:ge},ge))})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"status-select",className:"font-bold",children:"Status"}),o.jsxs(En,{value:oe.status,onValueChange:ge=>st(Fe=>({...Fe,status:ge})),children:[o.jsx(Sn,{className:"mt-1",onMouseDown:()=>{Pe&&setTimeout(Xf,0)},children:o.jsx(kn,{})}),o.jsx(Cn,{children:Object.keys(Rs).map(ge=>o.jsx(Nt,{value:ge,children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("span",{"aria-hidden":!0,className:`inline-block h-4 w-1 rounded ${Rs[ge].accent}`}),Rs[ge].label]})},ge))})]}),Ju&&o.jsx("div",{className:"mt-1.5 text-xs text-text-primary font-medium bg-brand/5 border border-brand/20 rounded px-2 py-1.5",children:Ju})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"horario-inicio",className:"font-bold",children:"Horrio"}),o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsxs(En,{value:String(oe.startMinutes),onValueChange:ge=>st(Fe=>({...Fe,startMinutes:Number(ge)})),children:[o.jsx(Sn,{className:"w-32","aria-label":"Hora incio",onMouseDown:()=>{Pe&&setTimeout(Xf,0)},children:o.jsx(kn,{})}),o.jsx(Cn,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:zo.map(ge=>o.jsx(Nt,{value:String(ge.value),disabled:!ge.available,className:Jt(!ge.available&&"opacity-60"),children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[ge.available?o.jsx(dd,{className:"w-4 h-4 opacity-80"}):o.jsx(sx,{className:"w-4 h-4 opacity-80"}),ge.label]})},ge.value))})]}),o.jsxs(En,{value:String(oe.endMinutes),onValueChange:ge=>st(Fe=>({...Fe,endMinutes:Number(ge)})),children:[o.jsx(Sn,{className:"w-32","aria-label":"Hora fim",onMouseDown:()=>{Pe&&setTimeout(Xf,0)},children:o.jsx(kn,{})}),o.jsx(Cn,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:ii.map(ge=>o.jsx(Nt,{value:String(ge.value),disabled:!ge.available,className:Jt(!ge.available&&"opacity-60"),children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[ge.available?o.jsx(dd,{className:"w-4 h-4 opacity-80"}):o.jsx(sx,{className:"w-4 h-4 opacity-80"}),ge.label]})},ge.value))})]})]}),o.jsxs("div",{className:"mt-1 inline-block text-xs font-semibold text-text-secondary bg-white/5 border border-white/10 rounded px-2 py-0.5",children:["Durao: ",Mh]})]}),!Te&&o.jsxs("div",{className:"border-t border-border pt-4 mt-4",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("input",{type:"checkbox",id:"is-recorrente",checked:J,onChange:ge=>je(ge.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-brand focus:ring-brand"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{htmlFor:"is-recorrente",className:"font-semibold text-text-primary cursor-pointer",children:"Agendamento Fixo (Recorrente)"}),o.jsx("p",{className:"text-xs text-text-secondary mt-0.5",children:"Criar este agendamento automaticamente nas prximas semanas, no mesmo dia e horrio"})]})]}),J&&o.jsxs("div",{className:"ml-7 mt-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"quantidade-semanas",className:"text-sm font-medium",children:"Repetir por quantas semanas?"}),o.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[o.jsxs("div",{className:"flex items-center border border-border rounded-md bg-surface-2",children:[o.jsx("button",{type:"button",onClick:()=>Ue(ge=>Math.max(2,(ge||2)-1)),className:"px-3 py-2 hover:bg-surface-3 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:be<=2,children:o.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),o.jsx("div",{className:"px-4 py-2 min-w-[60px] text-center font-semibold border-x border-border",children:be}),o.jsx("button",{type:"button",onClick:()=>Ue(ge=>(ge||2)+1),className:"px-3 py-2 hover:bg-surface-3 transition-colors",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),o.jsxs("span",{className:"text-sm text-text-secondary",children:["semanas (",be," agendamentos)"]})]})]}),oe.date&&be>=2&&o.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[o.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:"Datas que sero criadas:"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:be}).map((ge,Fe)=>{const Ge=Oa(oe.date,Fe*7);return o.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-slate-700/50 border border-slate-600 rounded px-2 py-1",children:[o.jsx("svg",{className:"w-3.5 h-3.5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),o.jsx("span",{className:"text-xs font-medium text-white",children:Xt(Ge,"dd/MM/yyyy '('EEEE')'",{locale:aa})})]},Fe)})})]}),o.jsx("div",{className:"bg-slate-800/50 border-l-4 border-blue-600 rounded-r-lg p-3",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"flex-shrink-0 mt-0.5",children:o.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),o.jsxs("div",{className:"text-xs text-gray-300",children:[o.jsx("p",{className:"font-semibold mb-1 text-blue-300",children:"Importante: Revise os dados antes de salvar"}),o.jsxs("p",{children:["Sero criados ",o.jsxs("strong",{className:"text-white",children:[be," agendamentos"]})," incluindo a data selecionada e as prximas ",be-1," semanas. Editar ou cancelar depois exigir alterar cada agendamento individualmente."]})]})]})})]})]})]})]})}),o.jsx(Un,{className:"flex-shrink-0 border-t border-border bg-surface px-6 py-3",children:o.jsxs("div",{className:"w-full flex flex-col gap-3 sm:flex-row sm:items-center",children:[Te&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:mr-auto w-full sm:w-auto",children:[o.jsxs(le,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white border border-red-700 w-full sm:w-auto justify-center",onClick:()=>Yi(!0),children:[o.jsx(Oy,{className:"w-4 h-4 mr-2 opacity-90"}),"Cancelar agendamento",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-red-700/50 rounded border border-red-500/30",children:"F3"})]}),o.jsxs(le,{type:"button",variant:"secondary",className:"bg-teal-600 hover:bg-teal-500 text-white border-teal-700 w-full sm:w-auto justify-center",onClick:()=>{i()},children:[o.jsx(Ui,{className:"w-4 h-4 mr-2 opacity-90"}),o.jsx("span",{className:"hidden sm:inline",children:"Gerenciar Pagamentos"}),o.jsx("span",{className:"sm:hidden",children:"Pagamentos"}),o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-teal-700/50 rounded border border-teal-500/30",children:"F4"})]})]}),o.jsx(qd,{open:go,onOpenChange:Yi,children:o.jsxs(Kc,{children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Cancelar agendamento?"}),o.jsx(Qc,{children:'Ao cancelar, este agendamento deixar de aparecer na agenda padro. Ele s ser visvel ao selecionar o filtro "Cancelados".'})]}),o.jsxs(Xc,{children:[o.jsx(Zc,{children:"Voltar"}),o.jsx(zd,{className:"bg-red-600 hover:bg-red-500",onClick:async()=>{try{Yi(!1),ae(!1),await vn(Te.id,"canceled","user"),t({title:"Agendamento cancelado"})}catch(ge){t({title:"Erro ao cancelar",description:ge?.message||"Tente novamente."})}},children:"Confirmar cancelamento"})]})]})})]}),o.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[o.jsxs(le,{type:"button",variant:"ghost",className:"border border-white/10 flex-1 sm:flex-none",onClick:async()=>{if(Te?.id){console.log(" [Auto-save] Salvando ao fechar modal...");try{Ma.current&&clearTimeout(Ma.current),await Yo({autoSave:!0}),console.log(" [Auto-save] Salvo ao fechar!")}catch(ge){console.error(" [Auto-save] Erro ao salvar ao fechar:",ge)}}ae(!1)},children:["Fechar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),!Te?.id&&o.jsxs(le,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white disabled:opacity-60 disabled:cursor-not-allowed flex-1 sm:flex-none",disabled:xa,onClick:async()=>{try{if(xa)return;if(J&&!Te){Y(!0);return}xi.current=!0,Ko.current=!1,await Yo()}catch{}},children:["Salvar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})})]})}),o.jsx(qd,{open:Z,onOpenChange:Y,children:o.jsxs(Kc,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[o.jsxs(Yc,{children:[o.jsxs(Jc,{className:"flex items-center gap-3 text-xl",children:[o.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-orange-600/20 border border-orange-600/40",children:o.jsx("svg",{className:"w-6 h-6 text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),"Confirmar Criao de Agendamentos Recorrentes"]}),o.jsxs(Qc,{className:"space-y-4 mt-4",children:[oe.date&&be>=2&&o.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[o.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:" Datas que sero criadas:"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:Array.from({length:be}).map((ge,Fe)=>{const Ge=Oa(oe.date,Fe*7);return o.jsxs("div",{className:"flex items-center gap-2 bg-slate-700/50 border border-slate-600 rounded px-2 py-1.5",children:[o.jsxs("span",{className:"text-xs font-semibold text-slate-400",children:["#",Fe+1]}),o.jsx("span",{className:"text-xs font-medium text-white",children:Xt(Ge,"dd/MM/yyyy '('EEEE')'",{locale:aa})})]},Fe)})})]}),o.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[o.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-3 uppercase tracking-wide",children:"Resumo do Agendamento"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[o.jsx("span",{className:"text-sm text-slate-400",children:"Quadra"}),o.jsx("span",{className:"font-semibold text-white",children:Mt[oe.court]?.name||oe.court})]}),o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[o.jsx("span",{className:"text-sm text-slate-400",children:"Horrio"}),o.jsxs("span",{className:"font-semibold text-white font-mono",children:[w9(oe.startMinutes)," - ",w9(oe.endMinutes)]})]}),o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[o.jsx("span",{className:"text-sm text-slate-400",children:"Modalidade"}),o.jsx("span",{className:"font-semibold text-white",children:oe.modality})]}),o.jsxs("div",{className:"flex items-start justify-between py-2",children:[o.jsx("span",{className:"text-sm text-slate-400",children:"Participantes"}),o.jsx("div",{className:"text-right max-w-xs",children:oe.selectedClients?.length>0?o.jsxs("div",{className:"font-semibold text-white",children:[lt?oe.selectedClients.map(ge=>ge.nome).join(", "):oe.selectedClients.slice(0,3).map(ge=>ge.nome).join(", "),!lt&&oe.selectedClients.length>3&&o.jsxs("span",{className:"text-slate-400",children:[" +",oe.selectedClients.length-3]}),oe.selectedClients.length>3&&o.jsxs(o.Fragment,{children:[" ",o.jsx("button",{type:"button",onClick:()=>gt(!lt),className:"text-xs text-blue-400 hover:text-blue-300 underline inline",children:lt?"Ver menos":"Ver todos"})]})]}):o.jsx("span",{className:"font-semibold text-white",children:"Nenhum participante"})})]})]})]}),o.jsx("div",{className:"bg-red-900/30 border-l-4 border-red-600 rounded-r-lg p-4",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"w-5 h-5 text-red-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),o.jsx("div",{children:o.jsxs("p",{className:"text-sm text-gray-300",children:[o.jsx("strong",{className:"text-red-300",children:"Importante:"})," Aps criar, editar ou cancelar exigir alterar cada agendamento individualmente. Certifique-se de que todos os dados esto corretos!"]})})]})})]})]}),o.jsxs(Xc,{className:"gap-2",children:[o.jsx(Zc,{onClick:()=>{Y(!1),gt(!1)},className:"border-slate-600 hover:bg-slate-800",children:"Cancelar e Revisar"}),o.jsxs(zd,{className:"bg-emerald-700 hover:bg-emerald-600 text-white font-semibold",onClick:async()=>{Y(!1),gt(!1),xi.current=!0,Ko.current=!1,await Yo()},children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Confirmar e Criar ",be," Agendamentos"]})]})]})}),Et&&o.jsx(hre,{open:Et,onOpenChange:ge=>{Gt(ge),ge||(tr(null),window.__paymentModalCallback&&(window.__paymentModalCallback=null))},client:Nr,onSaved:ge=>{try{if(ge&&typeof ge=="object"){console.warn("[CustomerPicker][onSaved:START]",{clientId:ge.id,clientName:ge.nome,currentSelection:Array.isArray(Ve.current)?Ve.current.length:0});try{ne.current=Date.now()+3e3,Dt.current=Date.now()+3e3,Lt.current=Date.now()+3e3}catch{}(vo||[]).some(Ge=>typeof Ge=="object"?Ge.id===ge.id:!1)||(Ps(Ge=>[...Ge||[],ge]),cn(Ge=>[...Ge||[],ge])),st(Ge=>{const xt=Array.isArray(Ge.selectedClients)?Ge.selectedClients:[],_t={id:ge.id,nome:ge.nome||ge.name||ze(ge),codigo:ge.codigo},Er=xt.filter(lr=>lr.id!==ge.id),Yt=[_t,...Er];try{Ve.current=Yt}catch{}try{St.current=Yt}catch{}try{co(Yt)}catch{}try{sessionStorage.setItem(Fr,JSON.stringify(Yt))}catch{}try{$n.current=!1}catch{}return console.warn("[CustomerPicker][onSaved:COMPLETE]",{newClientId:ge.id,newClientName:ge.nome,totalSelected:Yt.length,refsSynced:!0,protectionActive:!0}),{...Ge,selectedClients:Yt}}),Promise.resolve().then(()=>{try{const Ge=Array.isArray(Ve.current)?Ve.current:[];Ge.length>0&&(st(xt=>({...xt,selectedClients:[...Ge]})),console.warn("[CustomerPicker][onSaved:REASSERT]",{count:Ge.length}))}catch{}})}if(window.__paymentModalCallback&&typeof window.__paymentModalCallback=="function")try{window.__protectPaymentModal&&window.__protectPaymentModal(3e3),window.__paymentModalCallback(),window.__paymentModalCallback=null}catch(Fe){console.error("[PaymentModal][callback:ERROR]",Fe)}}catch(Fe){console.error("[CustomerPicker][onSaved:ERROR]",Fe)}}}),a&&o.jsx(OQe,{setIsModalOpen:ae,setBookings:G,form:oe,setForm:st,localCustomers:vo,onOpenClientModal:ge=>{Gt(!0),window.__paymentModalCallback=ge}}),l&&o.jsx(TQe,{form:oe,setForm:st,localCustomers:vo})]})},Ot=p.useMemo(()=>{const ne=Xt(D,"yyyy-MM-dd");let ie=me.filter(Ye=>Xt(Ye.start,"yyyy-MM-dd")===ne);if(ie=Ee.canceledOnly?ie.filter(Ye=>Ye.status==="canceled"):ie.filter(Ye=>Ye.status!=="canceled"),Ee.pendingPayments&&(ie=ie.filter(Ye=>{const ze=yt[Ye.id]||[];return ze.some(rt=>String(rt.status_pagamento||"").toLowerCase()!=="pago")&&ze.length>0})),Vt.trim()){const Ye=Vt.trim().toLowerCase();ie=ie.filter(ze=>(ze.customer||"").toLowerCase().includes(Ye)||(ze.court||"").toLowerCase().includes(Ye)||(Rs[ze.status]?.label||"").toLowerCase().includes(Ye))}return Ee.scheduled||Ee.canceledOnly||Ee.pendingPayments?ie:[]},[me,D,Ee.scheduled,Ee.canceledOnly,Ee.pendingPayments,Vt,yt]),dr=p.useMemo(()=>{const ne=Xt(D,"yyyy-MM-dd"),ie=pt||Ar[0],Ye=me.filter(Ke=>Xt(Ke.start,"yyyy-MM-dd")===ne&&Ke.status!=="canceled"&&Ke.court===ie);let ze=0;return Ye.forEach(Ke=>{const oe=(yt[Ke.id]||[]).filter(st=>String(st.status_pagamento||"").toLowerCase()!=="pago").length;ze+=oe}),{totalBookings:Ye.length,totalPendingPayments:ze}},[me,D,yt,pt,Ar]),er=p.useMemo(()=>{const ne=np(D),ie=Oa(ne,6);let Ye=me.filter(ze=>{const Ke=ti(ze.start),rt=ti(ne),oe=ti(ie);return Ke>=rt&&Ke<=oe});if(Ye=Ee.canceledOnly?Ye.filter(ze=>ze.status==="canceled"):Ye.filter(ze=>ze.status!=="canceled"),Ee.pendingPayments&&(Ye=Ye.filter(ze=>{const Ke=yt[ze.id]||[];return Ke.some(oe=>String(oe.status_pagamento||"").toLowerCase()!=="pago")&&Ke.length>0})),Vt.trim()){const ze=Vt.trim().toLowerCase();Ye=Ye.filter(Ke=>(Ke.customer||"").toLowerCase().includes(ze)||(Ke.court||"").toLowerCase().includes(ze)||(Rs[Ke.status]?.label||"").toLowerCase().includes(ze))}return Ee.scheduled||Ee.canceledOnly||Ee.pendingPayments?Ye:[]},[me,D,Ee.scheduled,Ee.canceledOnly,Ee.pendingPayments,Vt,yt]);p.useEffect(()=>{if(!Vt.trim()||!(Ee.scheduled||Ee.canceledOnly||Ee.pendingPayments)||!Ot||Ot.length===0)return;const ne=[...Ot].sort((Ye,ze)=>Ye.start-ze.start)[0];if(!ne?.id)return;const ie=document.getElementById(`booking-${ne.id}`);ie?.scrollIntoView&&ie.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},[Vt,Ot,Ee.scheduled,Ee.canceledOnly,Ee.pendingPayments]),p.useEffect(()=>{const ne=Tn.current,ie=Qn.current||{},Ye=Ee.canceledOnly&&!ie.canceledOnly,ze=Ee.scheduled&&!ie.scheduled&&!Ee.canceledOnly,Ke=Ee.pendingPayments&&!ie.pendingPayments;if(!ne||!Ye&&!ze&&!Ke){Qn.current={scheduled:Ee.scheduled,canceledOnly:Ee.canceledOnly,pendingPayments:Ee.pendingPayments};return}const rt=Ot||[];if(rt.length===0){Qn.current={scheduled:Ee.scheduled,canceledOnly:Ee.canceledOnly,pendingPayments:Ee.pendingPayments};return}const oe=ne.getBoundingClientRect();if(!rt.some(Ve=>{const Qe=document.getElementById(`booking-${Ve.id}`);if(!Qe)return!1;const qt=Qe.getBoundingClientRect();return qt.bottom>oe.top&&qt.top<oe.bottom})){const Ve=[...rt].sort((qt,O)=>qt.start-O.start)[0],Qe=Ve&&document.getElementById(`booking-${Ve.id}`);Qe?.scrollIntoView&&Qe.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}Qn.current={scheduled:Ee.scheduled,canceledOnly:Ee.canceledOnly,pendingPayments:Ee.pendingPayments}},[Ee.scheduled,Ee.canceledOnly,Ee.pendingPayments,Ot]);const _r=p.useMemo(()=>{if(!pt||!Mt[pt])return{start:de,end:Le};const ne=Mt[pt],ie=ne.hora_inicio||`${de}:00:00`,Ye=ne.hora_fim||`${Le}:00:00`,[ze,Ke]=String(ie).split(":").map(Number),[rt,oe]=String(Ye).split(":").map(Number),st=rt===0&&oe===0?24:rt,Ve=st*60+(oe||0);return{start:ze||de,end:st||Le,startMinutes:(ze||0)*60+(Ke||0),endMinutes:Ve}},[pt,Mt,de,Le]);return p.useMemo(()=>{const ne=_r.start,ie=_r.end;return Array.from({length:Math.max(0,ie-ne)},(Ye,ze)=>ne+ze)},[_r]),p.useMemo(()=>{const ne=_r.start,ie=_r.end;return Math.max(0,ie-ne)*(60/ja)*vs},[_r]),o.jsxs(o.Fragment,{children:[o.jsxs(fr.div,{variants:Q?void 0:FQe,initial:Q?!1:"hidden",animate:Q?!1:"visible",className:Jt("h-full w-full flex flex-col md:px-0",$&&"fixed inset-0 z-40 bg-surface"),children:[o.jsx(fr.div,{variants:b9,className:"p-3 bg-surface mb-6 md:rounded-lg",children:o.jsxs("div",{className:"max-w-[1200px] mx-auto w-full flex flex-col gap-3 md:flex-row md:items-center md:gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(le,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>F(z==="day"?By(D,1):By(D,7)),children:o.jsx(mH,{className:"h-5 w-5"})}),o.jsxs(yc,{children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"ghost",className:"w-full sm:w-auto max-w-full justify-center text-base font-semibold whitespace-nowrap truncate",children:[o.jsx(gi,{className:"mr-2 h-5 w-5"}),z==="day"?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden sm:inline",children:Xt(D,"EEE, dd 'de' MMMM 'de' yyyy",{locale:aa})}),o.jsx("span",{className:"sm:hidden",children:Xt(D,"EEE, dd/MM/yyyy",{locale:aa})})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden sm:inline",children:$Qe(D)}),o.jsxs("span",{className:"sm:hidden",children:[Xt(np(D),"dd/MM/yyyy")," - ",Xt(Oa(np(D),6),"dd/MM/yyyy")]})]})]})}),o.jsx(Ml,{className:"w-auto p-0",children:o.jsx(wc,{mode:"single",selected:D,onSelect:ne=>ne&&F(ne),initialFocus:!0})})]}),o.jsx(le,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>F(z==="day"?Oa(D,1):Oa(D,7)),children:o.jsx(Qx,{className:"h-5 w-5"})})]}),Ar.length>0&&o.jsx("div",{className:"hidden md:flex md:justify-center md:flex-1",children:Ar.length===1?o.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[o.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:xm(Ar[0])}}),o.jsx("span",{className:"font-semibold text-sm",children:Ar[0]})]}):o.jsxs(En,{value:pt||Ar[0],onValueChange:ne=>{Br(ne)},children:[o.jsx(Sn,{className:"w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:o.jsx(kn,{placeholder:"Selecionar quadra"})}),o.jsx(Cn,{className:"border-brand/30",children:Ar.map(ne=>{const ie=xm(ne);return o.jsx(Nt,{value:ne,children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:ie}}),o.jsx("span",{className:"font-semibold",children:ne})]})},ne)})})]})}),o.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto md:ml-auto",children:[o.jsxs("div",{className:"flex items-center gap-3 justify-center md:hidden",children:[o.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[o.jsx(le,{variant:z==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>q("day"),children:"Dia"}),o.jsx(le,{variant:z==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>q("week"),children:"Semana"})]}),o.jsxs(Ky,{children:[o.jsx(Yy,{asChild:!0,children:o.jsxs(le,{variant:"outline",size:"sm",className:"gap-2",disabled:Ir.length===0,children:[o.jsx(d6,{className:"h-4 w-4"})," Filtros"]})}),o.jsxs(Wv,{align:"end",className:"w-64",children:[o.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[o.jsx(Q3,{className:"p-0",children:"Exibio"}),o.jsx(le,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>Ct({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),o.jsx(Aj,{}),o.jsx(ol,{onClick:ne=>ne.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(gi,{className:"h-4 w-4 text-text-muted"}),o.jsx("span",{children:"Agendados"})]}),o.jsx(Fo,{checked:Ee.scheduled,onCheckedChange:ne=>Ct(ie=>({...ie,scheduled:!!ne,canceledOnly:ne?!1:ie.canceledOnly}))})]})}),o.jsx(ol,{onClick:ne=>ne.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Mk,{className:"h-4 w-4 text-text-muted"}),o.jsx("span",{children:"Livres"})]}),o.jsx(Fo,{checked:Ee.available,onCheckedChange:ne=>Ct(ie=>({...ie,available:!!ne,canceledOnly:ne?!1:ie.canceledOnly}))})]})}),o.jsx(ol,{onClick:ne=>ne.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Oy,{className:"h-4 w-4 text-rose-400"}),o.jsx("span",{children:"Cancelados"})]}),o.jsx(Fo,{checked:Ee.canceledOnly,onCheckedChange:ne=>{const ie=!!ne;Ct(Ye=>({...Ye,canceledOnly:ie,scheduled:ie?!1:Ye.scheduled,available:ie?!1:Ye.available})),ie&&!ot&&jr(!0)}})]})}),o.jsx(ol,{onClick:ne=>ne.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ui,{className:"h-4 w-4 text-warning"}),o.jsx("span",{children:"Pagamentos Pendentes"})]}),o.jsx(Fo,{checked:Ee.pendingPayments,onCheckedChange:ne=>Ct(ie=>({...ie,pendingPayments:!!ne}))})]})})]})]}),o.jsxs("div",{className:"relative inline-block group",children:[o.jsx(le,{variant:$?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>K(!$),"aria-label":$?"Minimizar grid":"Expandir grid",children:$?o.jsx(Dk,{className:"h-4 w-4"}):o.jsx(Ik,{className:"h-4 w-4"})}),o.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:o.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:$?"Minimizar (F10)":"Expandir (F10)"})})]}),o.jsx(le,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>qe(!0),disabled:Ir.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:o.jsx(Hm,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"flex items-center gap-3 justify-end flex-shrink-0",children:[o.jsxs("div",{className:"relative w-full sm:w-56",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar agendamento...",className:"pl-9",value:Vt,onChange:ne=>gr(ne.target.value),onBlur:()=>gr("")}),Vt&&o.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 px-2 py-0.5 rounded text-xs font-medium text-primary hover:bg-surface-2",onClick:()=>gr(""),children:"Limpar"})]}),o.jsxs(le,{size:"sm",onClick:()=>{at(null),ht(null);try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}Be()},"aria-label":"Novo agendamento",className:"gap-2",disabled:Ir.length===0||Ar.every(ne=>ce[ne]&&!ce[ne].funciona),children:[o.jsx(Ga,{className:"h-4 w-4"})," Agendar"]})]}),Ar.length>0&&o.jsx("div",{className:"md:hidden flex justify-center",children:Ar.length===1?o.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg w-full h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[o.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:xm(Ar[0])}}),o.jsx("span",{className:"font-semibold text-sm",children:Ar[0]})]}):o.jsxs(En,{value:Ar[Pr%Ar.length],onValueChange:ne=>{const ie=Ar.indexOf(ne);ie!==-1&&Ur(ie)},children:[o.jsx(Sn,{className:"w-48 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:o.jsx(kn,{placeholder:"Selecionar quadra"})}),o.jsx(Cn,{className:"border-brand/30",children:Ar.map(ne=>{const ie=xm(ne);return o.jsx(Nt,{value:ne,children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:ie}}),o.jsx("span",{className:"font-semibold",children:ne})]})},ne)})})]})}),o.jsxs("div",{className:"hidden md:flex items-center gap-3 justify-end",children:[o.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[o.jsx(le,{variant:z==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>q("day"),children:"Dia"}),o.jsx(le,{variant:z==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>q("week"),children:"Semana"})]}),o.jsxs(Ky,{children:[o.jsx(Yy,{asChild:!0,children:o.jsxs(le,{variant:"outline",size:"sm",className:"gap-2",disabled:Ir.length===0,children:[o.jsx(d6,{className:"h-4 w-4"})," Filtros"]})}),o.jsxs(Wv,{align:"end",className:"w-64",children:[o.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[o.jsx(Q3,{className:"p-0",children:"Exibio"}),o.jsx(le,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>Ct({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),o.jsx(Aj,{}),o.jsx(ol,{onClick:ne=>ne.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(gi,{className:"h-4 w-4 text-text-muted"}),o.jsx("span",{children:"Agendados"})]}),o.jsx(Fo,{checked:Ee.scheduled,onCheckedChange:ne=>Ct(ie=>({...ie,scheduled:!!ne,canceledOnly:ne?!1:ie.canceledOnly}))})]})}),o.jsx(ol,{onClick:ne=>ne.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Mk,{className:"h-4 w-4 text-text-muted"}),o.jsx("span",{children:"Livres"})]}),o.jsx(Fo,{checked:Ee.available,onCheckedChange:ne=>Ct(ie=>({...ie,available:!!ne,canceledOnly:ne?!1:ie.canceledOnly}))})]})}),o.jsx(ol,{onClick:ne=>ne.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Oy,{className:"h-4 w-4 text-rose-400"}),o.jsx("span",{children:"Cancelados"})]}),o.jsx(Fo,{checked:Ee.canceledOnly,onCheckedChange:ne=>{const ie=!!ne;Ct(Ye=>({...Ye,canceledOnly:ie,scheduled:ie?!1:Ye.scheduled,available:ie?!1:Ye.available})),ie&&!ot&&jr(!0)}})]})}),o.jsx(ol,{onClick:ne=>ne.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ui,{className:"h-4 w-4 text-warning"}),o.jsx("span",{children:"Pagamentos Pendentes"})]}),o.jsx(Fo,{checked:Ee.pendingPayments,onCheckedChange:ne=>Ct(ie=>({...ie,pendingPayments:!!ne}))})]})})]})]}),o.jsxs("div",{className:"relative inline-block group",children:[o.jsx(le,{variant:$?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>K(!$),"aria-label":$?"Minimizar grid":"Expandir grid",children:$?o.jsx(Dk,{className:"h-4 w-4"}):o.jsx(Ik,{className:"h-4 w-4"})}),o.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:o.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:$?"Minimizar (F10)":"Expandir (F10)"})})]}),o.jsx(le,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>qe(!0),disabled:Ir.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:o.jsx(Hm,{className:"h-5 w-5"})})]})]})]})}),o.jsx(ln,{open:nt,onOpenChange:ne=>{ne||ut(At),qe(ne)},children:o.jsxs(sn,{className:"sm:max-w-[680px]",onOpenAutoFocus:ne=>ne.preventDefault(),children:[o.jsx(an,{className:"pb-3 border-b border-border bg-surface-2/40 rounded-t-lg px-2 -mx-2 -mt-2",children:o.jsx(nn,{className:"text-base font-semibold tracking-tight",children:"Configuraes da Agenda"})}),o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[o.jsx(Pi,{className:"h-4 w-4",style:{color:Rs.confirmed.hex}}),o.jsx("span",{className:"text-sm font-medium",children:"Confirmao automtica"})]}),o.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-3",style:{borderLeftWidth:3,borderLeftColor:Rs.confirmed.hex},children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Fo,{id:"autoConfirmEnabled",checked:We.autoConfirmEnabled,onCheckedChange:ne=>ut(ie=>({...ie,autoConfirmEnabled:!!ne}))}),o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:Rs.confirmed.hex}}),o.jsx(Ht,{htmlFor:"autoConfirmEnabled",className:"font-medium",children:"Confirmao automtica"})]})]})}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(Ht,{htmlFor:"autoconfirm-hours",className:"text-sm text-text-muted",children:"Confirmar se faltar"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs(En,{value:String(Math.max(0,Math.round((We.autoConfirmMinutesBefore||0)/60))),onValueChange:ne=>ut(ie=>({...ie,autoConfirmMinutesBefore:Math.max(0,Number(ne))*60})),disabled:!We.autoConfirmEnabled,children:[o.jsx(Sn,{className:"w-32",children:o.jsx(kn,{placeholder:"Horas"})}),o.jsxs(Cn,{align:"start",children:[o.jsx(Nt,{value:"0",children:"Imediato"}),o.jsx(Nt,{value:"1",children:"1 h"}),o.jsx(Nt,{value:"2",children:"2 h"}),o.jsx(Nt,{value:"3",children:"3 h"}),o.jsx(Nt,{value:"4",children:"4 h"}),o.jsx(Nt,{value:"6",children:"6 h"}),o.jsx(Nt,{value:"8",children:"8 h"}),o.jsx(Nt,{value:"12",children:"12 h"}),o.jsx(Nt,{value:"24",children:"24 h"})]})]}),o.jsx("span",{className:"text-sm text-text-muted",children:"antes"})]})]})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[o.jsx(vH,{className:"h-4 w-4",style:{color:Rs.in_progress.hex}}),o.jsx("span",{className:"text-sm font-medium",children:"Transies automticas"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:Rs.in_progress.hex},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Fo,{id:"autoStartEnabled",checked:We.autoStartEnabled,onCheckedChange:ne=>ut(ie=>({...ie,autoStartEnabled:!!ne}))}),o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:Rs.in_progress.hex}}),o.jsx(Ht,{htmlFor:"autoStartEnabled",className:"font-medium",children:"Iniciar no horrio"})]})]}),o.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Confirmado  Em andamento no horrio de incio."})]}),o.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:Rs.finished.hex},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Fo,{id:"autoFinishEnabled",checked:We.autoFinishEnabled,onCheckedChange:ne=>ut(ie=>({...ie,autoFinishEnabled:!!ne}))}),o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:Rs.finished.hex}}),o.jsx(Ht,{htmlFor:"autoFinishEnabled",className:"font-medium",children:"Finalizar ao trmino"})]})]}),o.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Em andamento  Finalizado no horrio de trmino."})]})]})]})]}),o.jsxs(Un,{className:"mt-2 gap-2",children:[o.jsx(le,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>qe(!1),children:"Cancelar"}),o.jsx(le,{type:"button",variant:"default",onClick:()=>{console.log(" BOTO SALVAR CLICADO!"),jn()},disabled:$r,children:$r?"Salvando":"Salvar"})]})]})}),o.jsx(ln,{open:Ft,onOpenChange:jr,children:o.jsxs(sn,{className:"sm:max-w-[520px]",onOpenAutoFocus:ne=>ne.preventDefault(),children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Sobre agendamentos cancelados"}),o.jsx(_n,{children:"Agendamentos cancelados no aparecem na agenda quando o filtro no est selecionado e no ocupam horrio."})]}),o.jsxs("div",{className:"flex items-start gap-3 mt-2",children:[o.jsx(Fo,{id:"hide-canceled-info",checked:ot,onCheckedChange:ne=>Kt(!!ne),className:"mt-0.5"}),o.jsx(Ht,{htmlFor:"hide-canceled-info",className:"text-sm cursor-pointer text-text-secondary",children:"No mostrar novamente"})]}),o.jsx(Un,{className:"mt-4",children:o.jsx(le,{type:"button",onClick:()=>jr(!1),children:"Entendi"})})]})}),!qr&&Ir.length===0&&o.jsxs("div",{className:"mb-4 p-4 rounded-lg border border-border bg-surface text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:"Nenhuma quadra encontrada"}),o.jsx("div",{className:"text-text-muted",children:"Cadastre suas quadras para comear a usar a agenda."})]}),o.jsx(le,{asChild:!0,className:"w-full sm:w-auto",children:o.jsxs(LT,{to:"/quadras",children:[o.jsx("span",{className:"hidden sm:inline",children:"Ir para Cadastros  Quadras"}),o.jsx("span",{className:"sm:hidden",children:"Adicionar"})]})})]}),Ar.length>0&&z==="week"&&(()=>{const ne=pt||Ar[0],ie=er.filter(Ye=>Ye.court===ne);return o.jsx(o.Fragment,{children:o.jsx(RQe,{weekStart:np(D),weekBookings:ie,activeCourtFilter:ne,courtsMap:Mt,participantsByAgendamento:yt,onBookingClick:Ye=>{at(Ye),ae(!0)},onSlotClick:(Ye,ze)=>{at(null);const Ke=Ye.getHours()*60+Ye.getMinutes(),rt=ze||pt||Ar[0],oe=Xt(Ye,"yyyy-MM-dd"),st=(()=>{try{return(me||[]).filter(H=>H.court===rt&&Xt(H.start,"yyyy-MM-dd")===oe&&H.status!=="canceled").map(H=>fu(H.start)*60+mu(H.start)).filter(H=>H>Ke).sort((H,_e)=>H-_e)[0]}catch{}})(),Ve=(()=>{const H=Mt[rt]?.hora_fim;if(!H)return Le*60;const[_e,Oe]=String(H).split(":").map(Number);return(_e===0&&(Oe||0)===0?24:_e)*60+(Oe||0)})(),Qe=typeof st=="number"?st:Ve;let qt=Math.min(Ke+60,Qe);qt-Ke<30&&(Qe-30>=Ke?qt=Qe:qt=Math.min(Ve,Ke+30));const O={date:ti(Ye),court:rt,startMinutes:Ke,endMinutes:qt};console.log("onSlotClick in AgendaPage - BEFORE setPrefill",{slotDate:Ye,court:ze,activeCourtFilter:pt,selectedCourts:Ar,startMinutes:Ke,endMinutes:qt,prefillData:O}),ht(O),console.log("onSlotClick in AgendaPage - AFTER setPrefill (state not updated yet)");try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}Be()},statusConfig:Rs,dayStartHour:de,dayEndHourExclusive:Le,weekDiasFuncionamento:V,sidebarVisible:e},`weekly-${ne}`)})})(),Ar.length>0&&z==="day"&&(()=>{const ne=typeof window<"u"&&window.innerWidth<768,ie=ne?[Ar[Pr%Ar.length]]:pt?[pt]:Ar,Ye=ne?ie[0]:pt,ze=(()=>{if(Ye&&Mt[Ye]){const oe=Mt[Ye],st=oe.hora_inicio||`${de}:00:00`,Ve=oe.hora_fim||`${Le}:00:00`,[Qe]=String(st).split(":").map(Number),[qt,O]=String(Ve).split(":").map(Number);let H=qt===0&&O===0?24:qt;return O>0&&H<24&&(H+=1),{start:Qe||de,end:H||Le}}return{start:de,end:Le}})(),Ke=Array.from({length:Math.max(0,ze.end-ze.start)},(oe,st)=>ze.start+st),rt=Math.max(0,ze.end-ze.start)*(60/ja)*vs;return ie.some(oe=>ce[oe]&&!ce[oe].funciona),o.jsx(o.Fragment,{children:o.jsx(fr.div,{variants:Q?void 0:b9,className:Jt("bg-surface fx-scroll","overflow-auto",ne?"":"rounded-lg border border-border"),ref:Tn,style:{flex:"1 1 auto",minWidth:0},children:o.jsxs("div",{className:Jt("grid",!ne&&"mx-auto"),style:{gridTemplateColumns:ne?"60px 1fr":ie.length===1?"120px 760px":ie.length===2?"120px repeat(2, 520px)":`120px repeat(${ie.length}, 1fr)`,width:ne?"100%":ie.length<=2?"fit-content":void 0,columnGap:ne?"4px":"16px"},children:[o.jsxs("div",{className:"sticky left-0 bg-surface z-20",children:[o.jsx("div",{className:"sticky top-0 z-20 h-14 border-b border-r border-border bg-surface flex items-center justify-center px-2",children:o.jsxs(Ky,{children:[o.jsx(Yy,{asChild:!0,children:o.jsx(le,{size:"sm",variant:"ghost",className:"hover:bg-surface-2/50 text-lg font-semibold",children:zs(D,new Date)?"Hoje":Xt(D,"EEEE",{locale:aa})})}),o.jsxs(Wv,{align:"center",children:[o.jsx(ol,{onClick:()=>F(new Date),children:"Hoje"}),o.jsx(Aj,{}),(()=>{const oe=["Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],st=vd(D,{weekStartsOn:1,locale:aa});return oe.map((Ve,Qe)=>o.jsx(ol,{onClick:()=>F(Oa(st,Qe)),children:Ve},Ve))})()]})]})}),Ke.map(oe=>o.jsxs("div",{className:Jt("border-r border-border",oe%2===1&&"bg-surface-2/30"),children:[o.jsx("div",{className:"relative border-b border-border/80",style:{height:vs},children:o.jsxs("span",{className:Jt("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",ne?"px-1 text-sm":"px-2 text-lg"),children:[String(oe).padStart(2,"0"),":00"]})}),o.jsx("div",{className:"relative border-b border-border/80",style:{height:vs},children:o.jsxs("span",{className:Jt("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",ne?"px-1 text-sm":"px-2 text-lg"),children:[String(oe).padStart(2,"0"),":30"]})})]},`time-${oe}`))]}),ie.map((oe,st)=>o.jsxs("div",{className:"relative border-r border-border",children:[o.jsx("div",{className:"h-14 border-b border-border sticky top-0 bg-surface z-10 flex items-center justify-center",children:st===0&&o.jsxs("div",{className:"flex items-center gap-4",children:[dr.totalBookings>0&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"font-bold text-text-primary",children:dr.totalBookings}),o.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["agendamento",dr.totalBookings!==1?"s":""]})]}),dr.totalPendingPayments>0&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"font-bold text-text-primary",children:dr.totalPendingPayments}),o.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["pendente",dr.totalPendingPayments!==1?"s":""]})]})]})}),o.jsxs("div",{className:Jt("relative"),style:{height:rt},children:[ce[oe]&&!ce[oe].funciona?(()=>Ke.map(Ve=>o.jsx("div",{className:"absolute w-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/30 transition-colors",style:{height:vs*2,top:Ke.indexOf(Ve)*vs*2},children:o.jsxs("div",{className:"text-center pointer-events-none",children:[o.jsx(BT,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),o.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),ce[oe].observacao&&o.jsx("div",{className:"text-xs text-text-muted",children:ce[oe].observacao})]})},`closed-${oe}-${Ve}`)))():null,(Ee.scheduled||Ee.canceledOnly||Ee.pendingPayments)&&(()=>{const Ve=ze.start*60,Qe=ze.end*60,qt=(()=>{const nr=Mt[oe]?.hora_inicio,Et=Mt[oe]?.hora_fim,[Gt,Nr]=String(nr||`${ze.start}:00:00`).split(":").map(Number),[tr,ar]=String(Et||`${ze.end}:00:00`).split(":").map(Number),sr=tr===0&&ar===0?24:tr||0;return{start:(Gt||0)*60+(Nr||0),end:sr*60+(ar||0)}})(),O=Math.max(qt.start,Ve),H=Math.min(qt.end,Qe),_e=Math.max(0,Math.floor((O-Ve)/ja)),Oe=Math.max(_e,Math.ceil((H-Ve)/ja)),ve=Math.max(0,(Qe-Ve)/ja),Xe=_e*vs,et=Math.min(ve,Math.max(0,Oe-_e)),zt=Math.max(0,(ve-Oe)*vs);return o.jsxs(o.Fragment,{children:[Xe>0&&o.jsx("div",{style:{height:Xe}}),Array.from({length:et},(nr,Et)=>{const Gt=_e+Et,tr=(Math.floor(Gt/(60/ja))+Math.floor(Ve/60))%2===1;return o.jsx("div",{className:Jt("border-b border-border/80",tr&&"bg-surface-2/30"),style:{height:vs}},`base-${oe}-slot-${Gt}`)}),zt>0&&o.jsx("div",{style:{height:zt}})]})})(),(Ee.scheduled||Ee.canceledOnly||Ee.pendingPayments)&&Ot.filter(Ve=>Ve.court===oe).map(Ve=>o.jsx(jt,{booking:Ve,courtGridStart:ze.start*60,courtGridEnd:ze.end*60},Ve.id)),Ee.available&&!(ce[oe]&&!ce[oe].funciona)&&(()=>{const Ve=(()=>{const Xe=Mt[oe]?.hora_inicio;if(!Xe)return de*60;const[et,zt]=String(Xe).split(":").map(Number);return et*60+(zt||0)})(),Qe=(()=>{const Xe=Mt[oe]?.hora_fim;if(!Xe)return Le*60;const[et,zt]=String(Xe).split(":").map(Number);return(et===0&&zt===0?24:et)*60+(zt||0)})(),qt=Xe=>{const et=fu(Xe),zt=mu(Xe);return et===0&&zt===0?1440:et*60+zt},O=Xt(D,"yyyy-MM-dd"),H=me.filter(Xe=>Xe.court===oe&&Xt(Xe.start,"yyyy-MM-dd")===O&&Xe.status!=="canceled").map(Xe=>[qt(Xe.start),qt(Xe.end)]).sort((Xe,et)=>Xe[0]-et[0]),_e=[];let Oe=Ve;for(const[Xe,et]of H)Xe>Oe&&_e.push([Oe,Xe]),Oe=Math.max(Oe,et);Oe<Qe&&_e.push([Oe,Qe]);const ve=({startM:Xe,endM:et})=>{const[zt,nr]=p.useState(null),Et=ze.start*60,Gt=Math.floor((Xe-Et)/ja),Nr=Math.max(1,Math.ceil((et-Xe)/ja)),tr=Gt+Nr,ar=Gt*vs-1,sr=(tr-Gt)*vs+2;let xr=Math.floor(Xe/60),St=Math.floor(et/60);xr>=24&&(xr=xr%24),St>=24&&(St=St%24);const Lr=`${String(xr).padStart(2,"0")}:${String(Xe%60).padStart(2,"0")}`,Fr=`${String(St).padStart(2,"0")}:${String(et%60).padStart(2,"0")}`;return o.jsxs("div",{className:Jt("absolute left-2 right-2 rounded-md border-2 border-dashed text-sm z-0 cursor-pointer","border-[#10B981]","bg-transparent hover:border-[#10B981]/80 hover:shadow-sm"),style:{top:`${ar}px`,height:`${sr}px`},onMouseMove:gn=>{const wa=gn.currentTarget.getBoundingClientRect(),$n=Math.min(Math.max(0,gn.clientY-wa.top),wa.height);let ca=Math.floor($n/vs);ca=Math.max(0,Math.min(ca,Nr-1)),nr(ca)},onMouseLeave:()=>nr(null),onClick:gn=>{const wa=gn.currentTarget.getBoundingClientRect(),$n=Math.min(Math.max(0,gn.clientY-wa.top),wa.height),ca=Math.floor($n/vs);let da=Xe+ca*ja;da=Math.max(Xe,Math.min(da,et-ja));const co=(()=>me.filter(go=>go.court===oe&&Xt(go.start,"yyyy-MM-dd")===O).map(go=>fu(go.start)*60+mu(go.start)).filter(go=>go>da).sort((go,Yi)=>go-Yi)[0])(),Oi=typeof co=="number"?co:Qe;let oi=Math.min(da+60,Oi);if(oi-da<30){const Da=Oi-30;Da>=Xe?(da=Math.max(Xe,Math.min(da,Da)),oi=Oi):(da=Xe,oi=Math.min(Oi,et))}at(null);{const Da=Ir||[],go=Da.includes(oe)?oe:Da[0]||"";ht({court:go,date:D,startMinutes:da,endMinutes:oi})}try{lastNonEmptySelectionRef.current=[],setChipsSnapshot([]),sessionStorage.removeItem(persistLastKey),sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}Be()},title:`Livre: ${Lr}${Fr}`,children:[zt!==null&&o.jsx("div",{className:"pointer-events-none absolute left-[6px] right-[6px] rounded-md border border-white/10 bg-white/5",style:{top:`${zt*vs}px`,height:`${vs}px`}}),o.jsxs("div",{className:"h-full px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"font-medium text-[#10B981]",children:"Livre"}),o.jsxs("span",{className:"text-text-muted",children:[Lr,"",Fr]})]})]})};return _e.map(([Xe,et],zt)=>o.jsx(ve,{startM:Xe,endM:et},`free-${oe}-${zt}`))})()]})]},oe))]})})})})()]}),Rt()]})}function j9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j9(Object(r),!0).forEach(function(n){Qbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sl(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var _9=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),uE=function(){return Math.random().toString(36).substring(7).split("").join(".")},S9={INIT:"@@redux/INIT"+uE(),REPLACE:"@@redux/REPLACE"+uE(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+uE()}};function qQe(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Mne(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Sl(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Sl(1));return r(Mne)(e,t)}if(typeof e!="function")throw new Error(Sl(2));var a=e,i=t,s=[],l=s,c=!1;function d(){l===s&&(l=s.slice())}function u(){if(c)throw new Error(Sl(3));return i}function f(g){if(typeof g!="function")throw new Error(Sl(4));if(c)throw new Error(Sl(5));var x=!0;return d(),l.push(g),function(){if(x){if(c)throw new Error(Sl(6));x=!1,d();var b=l.indexOf(g);l.splice(b,1),s=null}}}function m(g){if(!qQe(g))throw new Error(Sl(7));if(typeof g.type>"u")throw new Error(Sl(8));if(c)throw new Error(Sl(9));try{c=!0,i=a(i,g)}finally{c=!1}for(var x=s=l,y=0;y<x.length;y++){var b=x[y];b()}return g}function h(g){if(typeof g!="function")throw new Error(Sl(10));a=g,m({type:S9.REPLACE})}function v(){var g,x=f;return g={subscribe:function(b){if(typeof b!="object"||b===null)throw new Error(Sl(11));function w(){b.next&&b.next(u())}w();var j=x(w);return{unsubscribe:j}}},g[_9]=function(){return this},g}return m({type:S9.INIT}),n={dispatch:m,subscribe:f,getState:u,replaceReducer:h},n[_9]=v,n}function C9(e,t){return function(){return t(e.apply(this,arguments))}}function P9(e,t){if(typeof e=="function")return C9(e,t);if(typeof e!="object"||e===null)throw new Error(Sl(16));var r={};for(var n in e){var a=e[n];typeof a=="function"&&(r[n]=C9(a,t))}return r}function Rne(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,a){return function(){return n(a.apply(void 0,arguments))}})}function zQe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var a=n.apply(void 0,arguments),i=function(){throw new Error(Sl(15))},s={getState:a.getState,dispatch:function(){return i.apply(void 0,arguments)}},l=t.map(function(c){return c(s)});return i=Rne.apply(void 0,l)(a.dispatch),N9(N9({},a),{},{dispatch:i})}}}var Lne=xe.createContext(null);function UQe(e){e()}var $ne=UQe,VQe=function(t){return $ne=t},WQe=function(){return $ne};function HQe(){var e=WQe(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var a=t;a;)a.callback(),a=a.next})},get:function(){for(var a=[],i=t;i;)a.push(i),i=i.next;return a},subscribe:function(a){var i=!0,s=r={callback:a,next:null,prev:r};return s.prev?s.prev.next=s:t=s,function(){!i||t===null||(i=!1,s.next?s.next.prev=s.prev:r=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var A9={notify:function(){},get:function(){return[]}};function Fne(e,t){var r,n=A9;function a(f){return c(),n.subscribe(f)}function i(){n.notify()}function s(){u.onStateChange&&u.onStateChange()}function l(){return!!r}function c(){r||(r=t?t.addNestedSub(s):e.subscribe(s),n=HQe())}function d(){r&&(r(),r=void 0,n.clear(),n=A9)}var u={addNestedSub:a,notifyNestedSubs:i,handleChangeWrapper:s,isSubscribed:l,trySubscribe:c,tryUnsubscribe:d,getListeners:function(){return n}};return u}var Bne=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect;function GQe(e){var t=e.store,r=e.context,n=e.children,a=p.useMemo(function(){var l=Fne(t);return{store:t,subscription:l}},[t]),i=p.useMemo(function(){return t.getState()},[t]);Bne(function(){var l=a.subscription;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),i!==t.getState()&&l.notifyNestedSubs(),function(){l.tryUnsubscribe(),l.onStateChange=null}},[a,i]);var s=r||Lne;return xe.createElement(s.Provider,{value:a},n)}var qne={exports:{}},ao={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ls=typeof Symbol=="function"&&Symbol.for,MM=ls?Symbol.for("react.element"):60103,RM=ls?Symbol.for("react.portal"):60106,f5=ls?Symbol.for("react.fragment"):60107,m5=ls?Symbol.for("react.strict_mode"):60108,h5=ls?Symbol.for("react.profiler"):60114,p5=ls?Symbol.for("react.provider"):60109,g5=ls?Symbol.for("react.context"):60110,LM=ls?Symbol.for("react.async_mode"):60111,v5=ls?Symbol.for("react.concurrent_mode"):60111,x5=ls?Symbol.for("react.forward_ref"):60112,y5=ls?Symbol.for("react.suspense"):60113,KQe=ls?Symbol.for("react.suspense_list"):60120,b5=ls?Symbol.for("react.memo"):60115,w5=ls?Symbol.for("react.lazy"):60116,YQe=ls?Symbol.for("react.block"):60121,XQe=ls?Symbol.for("react.fundamental"):60117,JQe=ls?Symbol.for("react.responder"):60118,QQe=ls?Symbol.for("react.scope"):60119;function Ec(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case MM:switch(e=e.type,e){case LM:case v5:case f5:case h5:case m5:case y5:return e;default:switch(e=e&&e.$$typeof,e){case g5:case x5:case w5:case b5:case p5:return e;default:return t}}case RM:return t}}}function zne(e){return Ec(e)===v5}ao.AsyncMode=LM;ao.ConcurrentMode=v5;ao.ContextConsumer=g5;ao.ContextProvider=p5;ao.Element=MM;ao.ForwardRef=x5;ao.Fragment=f5;ao.Lazy=w5;ao.Memo=b5;ao.Portal=RM;ao.Profiler=h5;ao.StrictMode=m5;ao.Suspense=y5;ao.isAsyncMode=function(e){return zne(e)||Ec(e)===LM};ao.isConcurrentMode=zne;ao.isContextConsumer=function(e){return Ec(e)===g5};ao.isContextProvider=function(e){return Ec(e)===p5};ao.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===MM};ao.isForwardRef=function(e){return Ec(e)===x5};ao.isFragment=function(e){return Ec(e)===f5};ao.isLazy=function(e){return Ec(e)===w5};ao.isMemo=function(e){return Ec(e)===b5};ao.isPortal=function(e){return Ec(e)===RM};ao.isProfiler=function(e){return Ec(e)===h5};ao.isStrictMode=function(e){return Ec(e)===m5};ao.isSuspense=function(e){return Ec(e)===y5};ao.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===f5||e===v5||e===h5||e===m5||e===y5||e===KQe||typeof e=="object"&&e!==null&&(e.$$typeof===w5||e.$$typeof===b5||e.$$typeof===p5||e.$$typeof===g5||e.$$typeof===x5||e.$$typeof===XQe||e.$$typeof===JQe||e.$$typeof===QQe||e.$$typeof===YQe)};ao.typeOf=Ec;qne.exports=ao;var ZQe=qne.exports,$M=ZQe,eZe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},tZe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},rZe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Une={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},FM={};FM[$M.ForwardRef]=rZe;FM[$M.Memo]=Une;function E9(e){return $M.isMemo(e)?Une:FM[e.$$typeof]||eZe}var nZe=Object.defineProperty,aZe=Object.getOwnPropertyNames,k9=Object.getOwnPropertySymbols,oZe=Object.getOwnPropertyDescriptor,iZe=Object.getPrototypeOf,O9=Object.prototype;function Vne(e,t,r){if(typeof t!="string"){if(O9){var n=iZe(t);n&&n!==O9&&Vne(e,n,r)}var a=aZe(t);k9&&(a=a.concat(k9(t)));for(var i=E9(e),s=E9(t),l=0;l<a.length;++l){var c=a[l];if(!tZe[c]&&!(r&&r[c])&&!(s&&s[c])&&!(i&&i[c])){var d=oZe(t,c);try{nZe(e,c,d)}catch{}}}}return e}var sZe=Vne;const T9=Ba(sZe);var Wne={exports:{}},po={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j5=60103,N5=60106,xw=60107,yw=60108,bw=60114,ww=60109,jw=60110,Nw=60112,_w=60113,BM=60120,Sw=60115,Cw=60116,Hne=60121,Gne=60122,Kne=60117,Yne=60129,Xne=60131;if(typeof Symbol=="function"&&Symbol.for){var xs=Symbol.for;j5=xs("react.element"),N5=xs("react.portal"),xw=xs("react.fragment"),yw=xs("react.strict_mode"),bw=xs("react.profiler"),ww=xs("react.provider"),jw=xs("react.context"),Nw=xs("react.forward_ref"),_w=xs("react.suspense"),BM=xs("react.suspense_list"),Sw=xs("react.memo"),Cw=xs("react.lazy"),Hne=xs("react.block"),Gne=xs("react.server.block"),Kne=xs("react.fundamental"),Yne=xs("react.debug_trace_mode"),Xne=xs("react.legacy_hidden")}function lu(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case j5:switch(e=e.type,e){case xw:case bw:case yw:case _w:case BM:return e;default:switch(e=e&&e.$$typeof,e){case jw:case Nw:case Cw:case Sw:case ww:return e;default:return t}}case N5:return t}}}var lZe=ww,cZe=j5,dZe=Nw,uZe=xw,fZe=Cw,mZe=Sw,hZe=N5,pZe=bw,gZe=yw,vZe=_w;po.ContextConsumer=jw;po.ContextProvider=lZe;po.Element=cZe;po.ForwardRef=dZe;po.Fragment=uZe;po.Lazy=fZe;po.Memo=mZe;po.Portal=hZe;po.Profiler=pZe;po.StrictMode=gZe;po.Suspense=vZe;po.isAsyncMode=function(){return!1};po.isConcurrentMode=function(){return!1};po.isContextConsumer=function(e){return lu(e)===jw};po.isContextProvider=function(e){return lu(e)===ww};po.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===j5};po.isForwardRef=function(e){return lu(e)===Nw};po.isFragment=function(e){return lu(e)===xw};po.isLazy=function(e){return lu(e)===Cw};po.isMemo=function(e){return lu(e)===Sw};po.isPortal=function(e){return lu(e)===N5};po.isProfiler=function(e){return lu(e)===bw};po.isStrictMode=function(e){return lu(e)===yw};po.isSuspense=function(e){return lu(e)===_w};po.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===xw||e===bw||e===Yne||e===yw||e===_w||e===BM||e===Xne||typeof e=="object"&&e!==null&&(e.$$typeof===Cw||e.$$typeof===Sw||e.$$typeof===ww||e.$$typeof===jw||e.$$typeof===Nw||e.$$typeof===Kne||e.$$typeof===Hne||e[0]===Gne)};po.typeOf=lu;Wne.exports=po;var xZe=Wne.exports,yZe=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],bZe=["reactReduxForwardedRef"],wZe=[],jZe=[null,null];function NZe(e,t){var r=e[1];return[t.payload,r+1]}function I9(e,t,r){Bne(function(){return e.apply(void 0,t)},r)}function _Ze(e,t,r,n,a,i,s){e.current=n,t.current=a,r.current=!1,i.current&&(i.current=null,s())}function SZe(e,t,r,n,a,i,s,l,c,d){if(e){var u=!1,f=null,m=function(){if(!u){var g=t.getState(),x,y;try{x=n(g,a.current)}catch(b){y=b,f=b}y||(f=null),x===i.current?s.current||c():(i.current=x,l.current=x,s.current=!0,d({type:"STORE_UPDATED",payload:{error:y}}))}};r.onStateChange=m,r.trySubscribe(),m();var h=function(){if(u=!0,r.tryUnsubscribe(),r.onStateChange=null,f)throw f};return h}}var CZe=function(){return[null,0]};function PZe(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,a=n===void 0?function(w){return"ConnectAdvanced("+w+")"}:n,i=r.methodName,s=i===void 0?"connectAdvanced":i,l=r.renderCountProp,c=l===void 0?void 0:l,d=r.shouldHandleStateChanges,u=d===void 0?!0:d,f=r.storeKey,m=f===void 0?"store":f;r.withRef;var h=r.forwardRef,v=h===void 0?!1:h,g=r.context,x=g===void 0?Lne:g,y=d_(r,yZe),b=x;return function(j){var _=j.displayName||j.name||"Component",S=a(_),k=qn({},y,{getDisplayName:a,methodName:s,renderCountProp:c,shouldHandleStateChanges:u,storeKey:m,displayName:S,wrappedComponentName:_,WrappedComponent:j}),E=y.pure;function A(D){return e(D.dispatch,k)}var M=E?p.useMemo:function(D){return D()};function C(D){var F=p.useMemo(function(){var at=D.reactReduxForwardedRef,yt=d_(D,bZe);return[D.context,at,yt]},[D]),z=F[0],q=F[1],$=F[2],K=p.useMemo(function(){return z&&z.Consumer&&xZe.isContextConsumer(xe.createElement(z.Consumer,null))?z:b},[z,b]),ce=p.useContext(K),fe=!!D.store&&!!D.store.getState&&!!D.store.dispatch;ce&&ce.store;var B=fe?D.store:ce.store,L=p.useMemo(function(){return A(B)},[B]),V=p.useMemo(function(){if(!u)return jZe;var at=Fne(B,fe?null:ce.subscription),yt=at.notifyNestedSubs.bind(at);return[at,yt]},[B,fe,ce]),re=V[0],me=V[1],G=p.useMemo(function(){return fe?ce:qn({},ce,{subscription:re})},[fe,ce,re]),Q=p.useReducer(NZe,wZe,CZe),ae=Q[0],J=ae[0],je=Q[1];if(J&&J.error)throw J.error;var be=p.useRef(),Ue=p.useRef($),Z=p.useRef(),Y=p.useRef(!1),lt=M(function(){return Z.current&&$===Ue.current?Z.current:L(B.getState(),$)},[B,J,$]);I9(_Ze,[Ue,be,Y,$,lt,Z,me]),I9(SZe,[u,B,re,L,Ue,be,Y,Z,me,je],[B,re,L]);var gt=p.useMemo(function(){return xe.createElement(j,qn({},lt,{ref:q}))},[q,j,lt]),Te=p.useMemo(function(){return u?xe.createElement(K.Provider,{value:G},gt):gt},[K,gt,G]);return Te}var T=E?xe.memo(C):C;if(T.WrappedComponent=j,T.displayName=C.displayName=S,v){var I=xe.forwardRef(function(F,z){return xe.createElement(T,qn({},F,{reactReduxForwardedRef:z}))});return I.displayName=S,I.WrappedComponent=j,T9(I,j)}return T9(T,j)}}function D9(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function fE(e,t){if(D9(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!D9(e[r[a]],t[r[a]]))return!1;return!0}function AZe(e,t){var r={},n=function(s){var l=e[s];typeof l=="function"&&(r[s]=function(){return t(l.apply(void 0,arguments))})};for(var a in e)n(a);return r}function qM(e){return function(r,n){var a=e(r,n);function i(){return a}return i.dependsOnOwnProps=!1,i}}function M9(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function Jne(e,t){return function(n,a){a.displayName;var i=function(l,c){return i.dependsOnOwnProps?i.mapToProps(l,c):i.mapToProps(l)};return i.dependsOnOwnProps=!0,i.mapToProps=function(l,c){i.mapToProps=e,i.dependsOnOwnProps=M9(e);var d=i(l,c);return typeof d=="function"&&(i.mapToProps=d,i.dependsOnOwnProps=M9(d),d=i(l,c)),d},i}}function EZe(e){return typeof e=="function"?Jne(e):void 0}function kZe(e){return e?void 0:qM(function(t){return{dispatch:t}})}function OZe(e){return e&&typeof e=="object"?qM(function(t){return AZe(e,t)}):void 0}const TZe=[EZe,kZe,OZe];function IZe(e){return typeof e=="function"?Jne(e):void 0}function DZe(e){return e?void 0:qM(function(){return{}})}const MZe=[IZe,DZe];function RZe(e,t,r){return qn({},r,e,t)}function LZe(e){return function(r,n){n.displayName;var a=n.pure,i=n.areMergedPropsEqual,s=!1,l;return function(d,u,f){var m=e(d,u,f);return s?(!a||!i(m,l))&&(l=m):(s=!0,l=m),l}}}function $Ze(e){return typeof e=="function"?LZe(e):void 0}function FZe(e){return e?void 0:function(){return RZe}}const BZe=[$Ze,FZe];var qZe=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function zZe(e,t,r,n){return function(i,s){return r(e(i,s),t(n,s),s)}}function UZe(e,t,r,n,a){var i=a.areStatesEqual,s=a.areOwnPropsEqual,l=a.areStatePropsEqual,c=!1,d,u,f,m,h;function v(w,j){return d=w,u=j,f=e(d,u),m=t(n,u),h=r(f,m,u),c=!0,h}function g(){return f=e(d,u),t.dependsOnOwnProps&&(m=t(n,u)),h=r(f,m,u),h}function x(){return e.dependsOnOwnProps&&(f=e(d,u)),t.dependsOnOwnProps&&(m=t(n,u)),h=r(f,m,u),h}function y(){var w=e(d,u),j=!l(w,f);return f=w,j&&(h=r(f,m,u)),h}function b(w,j){var _=!s(j,u),S=!i(w,d,j,u);return d=w,u=j,_&&S?g():_?x():S?y():h}return function(j,_){return c?b(j,_):v(j,_)}}function VZe(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,a=t.initMergeProps,i=d_(t,qZe),s=r(e,i),l=n(e,i),c=a(e,i),d=i.pure?UZe:zZe;return d(s,l,c,e,i)}var WZe=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function mE(e,t,r){for(var n=t.length-1;n>=0;n--){var a=t[n](e);if(a)return a}return function(i,s){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+s.wrappedComponentName+".")}}function HZe(e,t){return e===t}function GZe(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?PZe:r,a=t.mapStateToPropsFactories,i=a===void 0?MZe:a,s=t.mapDispatchToPropsFactories,l=s===void 0?TZe:s,c=t.mergePropsFactories,d=c===void 0?BZe:c,u=t.selectorFactory,f=u===void 0?VZe:u;return function(h,v,g,x){x===void 0&&(x={});var y=x,b=y.pure,w=b===void 0?!0:b,j=y.areStatesEqual,_=j===void 0?HZe:j,S=y.areOwnPropsEqual,k=S===void 0?fE:S,E=y.areStatePropsEqual,A=E===void 0?fE:E,M=y.areMergedPropsEqual,C=M===void 0?fE:M,T=d_(y,WZe),I=mE(h,i,"mapStateToProps"),D=mE(v,l,"mapDispatchToProps"),F=mE(g,d,"mergeProps");return n(f,qn({methodName:"connect",getDisplayName:function(q){return"Connect("+q+")"},shouldHandleStateChanges:!!h,initMapStateToProps:I,initMapDispatchToProps:D,initMergeProps:F,pure:w,areStatesEqual:_,areOwnPropsEqual:k,areStatePropsEqual:A,areMergedPropsEqual:C},T))}}const Qne=GZe();VQe(zf.unstable_batchedUpdates);function KZe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Zne(e,t){var r=p.useState(function(){return{inputs:t,result:e()}})[0],n=p.useRef(!0),a=p.useRef(r),i=n.current||!!(t&&a.current.inputs&&KZe(t,a.current.inputs)),s=i?a.current:{inputs:t,result:e()};return p.useEffect(function(){n.current=!1,a.current=s},[s]),s.result}function YZe(e,t){return Zne(function(){return e},t)}var za=Zne,In=YZe,Wd=function(t){var r=t.top,n=t.right,a=t.bottom,i=t.left,s=n-i,l=a-r,c={top:r,right:n,bottom:a,left:i,width:s,height:l,x:i,y:r,center:{x:(n+i)/2,y:(a+r)/2}};return c},zM=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},R9=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},XZe=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},hE={top:0,right:0,bottom:0,left:0},UM=function(t){var r=t.borderBox,n=t.margin,a=n===void 0?hE:n,i=t.border,s=i===void 0?hE:i,l=t.padding,c=l===void 0?hE:l,d=Wd(zM(r,a)),u=Wd(R9(r,s)),f=Wd(R9(u,c));return{marginBox:d,borderBox:Wd(r),paddingBox:u,contentBox:f,margin:a,border:s,padding:c}},Uc=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var a=Number(r);return isNaN(a)&&mh(!1),a},JZe=function(){return{x:window.pageXOffset,y:window.pageYOffset}},Y_=function(t,r){var n=t.borderBox,a=t.border,i=t.margin,s=t.padding,l=XZe(n,r);return UM({borderBox:l,border:a,margin:i,padding:s})},X_=function(t,r){return r===void 0&&(r=JZe()),Y_(t,r)},eae=function(t,r){var n={top:Uc(r.marginTop),right:Uc(r.marginRight),bottom:Uc(r.marginBottom),left:Uc(r.marginLeft)},a={top:Uc(r.paddingTop),right:Uc(r.paddingRight),bottom:Uc(r.paddingBottom),left:Uc(r.paddingLeft)},i={top:Uc(r.borderTopWidth),right:Uc(r.borderRightWidth),bottom:Uc(r.borderBottomWidth),left:Uc(r.borderLeftWidth)};return UM({borderBox:t,margin:n,padding:a,border:i})},tae=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return eae(r,n)},L9=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function QZe(e,t){return!!(e===t||L9(e)&&L9(t))}function ZZe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!QZe(e[r],t[r]))return!1;return!0}function os(e,t){t===void 0&&(t=ZZe);var r,n=[],a,i=!1;function s(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return i&&r===this&&t(l,n)||(a=e.apply(this,l),i=!0,r=this,n=l),a}return s}var eet=function(t){var r=[],n=null,a=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return a.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},a};const O1=eet;function rae(e,t){}rae.bind(null,"warn");rae.bind(null,"error");function oh(){}function tet(e,t){return qn({},e,{},t)}function ld(e,t,r){var n=t.map(function(a){var i=tet(r,a.options);return e.addEventListener(a.eventName,a.fn,i),function(){e.removeEventListener(a.eventName,a.fn,i)}});return function(){n.forEach(function(i){i()})}}var ret="Invariant failed";function J_(e){this.message=e}J_.prototype.toString=function(){return this.message};function Xr(e,t){if(!e)throw new J_(ret)}var net=function(e){eQ(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=e.call.apply(e,[this].concat(i))||this,n.callbacks=null,n.unbind=oh,n.onWindowError=function(l){var c=n.getCallbacks();c.isDragging()&&c.tryAbort();var d=l.error;d instanceof J_&&l.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(l){n.callbacks=l},n}var r=t.prototype;return r.componentDidMount=function(){this.unbind=ld(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(a){if(a instanceof J_){this.setState({});return}throw a},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(xe.Component),aet=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,Q_=function(t){return t+1},oet=function(t){return`
  You have lifted an item in position `+Q_(t.source.index)+`
`},nae=function(t,r){var n=t.droppableId===r.droppableId,a=Q_(t.index),i=Q_(r.index);return n?`
      You have moved the item from position `+a+`
      to position `+i+`
    `:`
    You have moved the item from position `+a+`
    in list `+t.droppableId+`
    to list `+r.droppableId+`
    in position `+i+`
  `},aae=function(t,r,n){var a=r.droppableId===n.droppableId;return a?`
      The item `+t+`
      has been combined with `+n.draggableId:`
      The item `+t+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},iet=function(t){var r=t.destination;if(r)return nae(t.source,r);var n=t.combine;return n?aae(t.draggableId,t.source,n):"You are over an area that cannot be dropped on"},$9=function(t){return`
  The item has returned to its starting position
  of `+Q_(t.index)+`
`},set=function(t){if(t.reason==="CANCEL")return`
      Movement cancelled.
      `+$9(t.source)+`
    `;var r=t.destination,n=t.combine;return r?`
      You have dropped the item.
      `+nae(t.source,r)+`
    `:n?`
      You have dropped the item.
      `+aae(t.draggableId,t.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+$9(t.source)+`
  `},Dj={dragHandleUsageInstructions:aet,onDragStart:oet,onDragUpdate:iet,onDragEnd:set},is={x:0,y:0},js=function(t,r){return{x:t.x+r.x,y:t.y+r.y}},mc=function(t,r){return{x:t.x-r.x,y:t.y-r.y}},ih=function(t,r){return t.x===r.x&&t.y===r.y},N0=function(t){return{x:t.x!==0?-t.x:0,y:t.y!==0?-t.y:0}},lg=function(t,r,n){var a;return n===void 0&&(n=0),a={},a[t]=r,a[t==="x"?"y":"x"]=n,a},T1=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))},F9=function(t,r){return Math.min.apply(Math,r.map(function(n){return T1(t,n)}))},oae=function(t){return function(r){return{x:t(r.x),y:t(r.y)}}},cet=function(e,t){var r=Wd({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r},Pw=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},B9=function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}]},det={top:0,right:0,bottom:0,left:0},uet=function(t,r){return r?Pw(t,r.scroll.diff.displacement):t},fet=function(t,r,n){if(n&&n.increasedBy){var a;return qn({},t,(a={},a[r.end]=t[r.end]+n.increasedBy[r.line],a))}return t},met=function(t,r){return r&&r.shouldClipSubject?cet(r.pageMarginBox,t):Wd(t)},Vx=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,a=e.frame,i=uet(t.marginBox,a),s=fet(i,n,r),l=met(s,a);return{page:t,withPlaceholder:r,active:l}},VM=function(e,t){e.frame||Xr(!1);var r=e.frame,n=mc(t,r.scroll.initial),a=N0(n),i=qn({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:a},max:r.scroll.max}}),s=Vx({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:i}),l=qn({},e,{frame:i,subject:s});return l};function Z_(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})}function WM(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function Ih(e,t){if(e.find)return e.find(t);var r=WM(e,t);if(r!==-1)return e[r]}function iae(e){return Array.prototype.slice.call(e)}var sae=os(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),lae=os(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),_5=os(function(e){return Z_(e)}),het=os(function(e){return Z_(e)}),_0=os(function(e,t){var r=het(t).filter(function(n){return e===n.descriptor.droppableId}).sort(function(n,a){return n.descriptor.index-a.descriptor.index});return r});function HM(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function S5(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var C5=os(function(e,t){return t.filter(function(r){return r.descriptor.id!==e.descriptor.id})}),pet=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.previousImpact;if(!n.isCombineEnabled)return null;var s=HM(i);if(!s)return null;function l(g){var x={type:"COMBINE",combine:{draggableId:g,droppableId:n.descriptor.id}};return qn({},i,{at:x})}var c=i.displaced.all,d=c.length?c[0]:null;if(t)return d?l(d):null;var u=C5(r,a);if(!d){if(!u.length)return null;var f=u[u.length-1];return l(f.descriptor.id)}var m=WM(u,function(g){return g.descriptor.id===d});m===-1&&Xr(!1);var h=m-1;if(h<0)return null;var v=u[h];return l(v.descriptor.id)},S0=function(e,t){return e.descriptor.droppableId===t.descriptor.id},cae={point:is,value:0},I1={invisible:{},visible:{},all:[]},get={displaced:I1,displacedBy:cae,at:null},md=function(e,t){return function(r){return e<=r&&r<=t}},dae=function(e){var t=md(e.top,e.bottom),r=md(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);if(a)return!0;var i=t(n.top)||t(n.bottom),s=r(n.left)||r(n.right),l=i&&s;if(l)return!0;var c=n.top<e.top&&n.bottom>e.bottom,d=n.left<e.left&&n.right>e.right,u=c&&d;if(u)return!0;var f=c&&s||d&&i;return f}},vet=function(e){var t=md(e.top,e.bottom),r=md(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);return a}},GM={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},uae={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},xet=function(e){return function(t){var r=md(t.top,t.bottom),n=md(t.left,t.right);return function(a){return e===GM?r(a.top)&&r(a.bottom):n(a.left)&&n(a.right)}}},yet=function(t,r){var n=r.frame?r.frame.scroll.diff.displacement:is;return Pw(t,n)},bet=function(t,r,n){return r.subject.active?n(r.subject.active)(t):!1},wet=function(t,r,n){return n(r)(t)},KM=function(t){var r=t.target,n=t.destination,a=t.viewport,i=t.withDroppableDisplacement,s=t.isVisibleThroughFrameFn,l=i?yet(r,n):r;return bet(l,n,s)&&wet(l,a,s)},jet=function(t){return KM(qn({},t,{isVisibleThroughFrameFn:dae}))},fae=function(t){return KM(qn({},t,{isVisibleThroughFrameFn:vet}))},Net=function(t){return KM(qn({},t,{isVisibleThroughFrameFn:xet(t.destination.axis)}))},_et=function(t,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var a=r.invisible,i=r.visible;if(a[t])return!1;var s=i[t];return s?s.shouldAnimate:!0};function Cet(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return Wd(zM(r,n))}function D1(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,a=e.viewport,i=e.forceShouldAnimate,s=e.last;return t.reduce(function(c,d){var u=Cet(d,n),f=d.descriptor.id;c.all.push(f);var m=jet({target:u,destination:r,viewport:a,withDroppableDisplacement:!0});if(!m)return c.invisible[d.descriptor.id]=!0,c;var h=_et(f,s,i),v={draggableId:f,shouldAnimate:h};return c.visible[f]=v,c},{all:[],visible:{},invisible:{}})}function Pet(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function q9(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,a=e.destination,i=Pet(t,{inHomeList:r});return{displaced:I1,displacedBy:n,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:i}}}}function eS(e){var t=e.draggable,r=e.insideDestination,n=e.destination,a=e.viewport,i=e.displacedBy,s=e.last,l=e.index,c=e.forceShouldAnimate,d=S0(t,n);if(l==null)return q9({insideDestination:r,inHomeList:d,displacedBy:i,destination:n});var u=Ih(r,function(g){return g.descriptor.index===l});if(!u)return q9({insideDestination:r,inHomeList:d,displacedBy:i,destination:n});var f=C5(t,r),m=r.indexOf(u),h=f.slice(m),v=D1({afterDragging:h,destination:n,displacedBy:i,last:s,viewport:a.frame,forceShouldAnimate:c});return{displaced:v,displacedBy:i,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function xh(e,t){return!!t.effected[e]}var Aet=function(e){var t=e.isMovingForward,r=e.destination,n=e.draggables,a=e.combine,i=e.afterCritical;if(!r.isCombineEnabled)return null;var s=a.draggableId,l=n[s],c=l.descriptor.index,d=xh(s,i);return d?t?c:c-1:t?c+1:c},Eet=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,a=e.location;if(!n.length)return null;var i=a.index,s=t?i+1:i-1,l=n[0].descriptor.index,c=n[n.length-1].descriptor.index,d=r?c:c+1;return s<l||s>d?null:s},ket=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,a=e.draggables,i=e.destination,s=e.insideDestination,l=e.previousImpact,c=e.viewport,d=e.afterCritical,u=l.at;if(u||Xr(!1),u.type==="REORDER"){var f=Eet({isMovingForward:t,isInHomeList:r,location:u.destination,insideDestination:s});return f==null?null:eS({draggable:n,insideDestination:s,destination:i,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:f})}var m=Aet({isMovingForward:t,destination:i,displaced:l.displaced,draggables:a,combine:u.combine,afterCritical:d});return m==null?null:eS({draggable:n,insideDestination:s,destination:i,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:m})},Oet=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,a=e.displacedBy,i=!!(t.visible[n]||t.invisible[n]);return xh(n,r)?i?is:N0(a.point):i?a.point:is},Tet=function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,a=S5(r);a||Xr(!1);var i=a.draggableId,s=n[i].page.borderBox.center,l=Oet({displaced:r.displaced,afterCritical:t,combineWith:i,displacedBy:r.displacedBy});return js(s,l)},mae=function(t,r){return r.margin[t.start]+r.borderBox[t.size]/2},Iet=function(t,r){return r.margin[t.end]+r.borderBox[t.size]/2},YM=function(t,r,n){return r[t.crossAxisStart]+n.margin[t.crossAxisStart]+n.borderBox[t.crossAxisSize]/2},z9=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return lg(r.line,n.marginBox[r.end]+mae(r,a),YM(r,n.marginBox,a))},U9=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return lg(r.line,n.marginBox[r.start]-Iet(r,a),YM(r,n.marginBox,a))},Det=function(t){var r=t.axis,n=t.moveInto,a=t.isMoving;return lg(r.line,n.contentBox[r.start]+mae(r,a),YM(r,n.contentBox,a))},Met=function(e){var t=e.impact,r=e.draggable,n=e.draggables,a=e.droppable,i=e.afterCritical,s=_0(a.descriptor.id,n),l=r.page,c=a.axis;if(!s.length)return Det({axis:c,moveInto:a.page,isMoving:l});var d=t.displaced,u=t.displacedBy,f=d.all[0];if(f){var m=n[f];if(xh(f,i))return U9({axis:c,moveRelativeTo:m.page,isMoving:l});var h=Y_(m.page,u.point);return U9({axis:c,moveRelativeTo:h,isMoving:l})}var v=s[s.length-1];if(v.descriptor.id===r.descriptor.id)return l.borderBox.center;if(xh(v.descriptor.id,i)){var g=Y_(v.page,N0(i.displacedBy.point));return z9({axis:c,moveRelativeTo:g,isMoving:l})}return z9({axis:c,moveRelativeTo:v.page,isMoving:l})},w4=function(e,t){var r=e.frame;return r?js(t,r.scroll.diff.displacement):t},Ret=function(t){var r=t.impact,n=t.draggable,a=t.droppable,i=t.draggables,s=t.afterCritical,l=n.page.borderBox.center,c=r.at;return!a||!c?l:c.type==="REORDER"?Met({impact:r,draggable:n,draggables:i,droppable:a,afterCritical:s}):Tet({impact:r,draggables:i,afterCritical:s})},P5=function(e){var t=Ret(e),r=e.droppable,n=r?w4(r,t):t;return n},hae=function(e,t){var r=mc(t,e.scroll.initial),n=N0(r),a=Wd({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),i={frame:a,scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}};return i};function V9(e,t){return e.map(function(r){return t[r]})}function Let(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}var $et=function(e){var t=e.impact,r=e.viewport,n=e.destination,a=e.draggables,i=e.maxScrollChange,s=hae(r,js(r.scroll.current,i)),l=n.frame?VM(n,js(n.frame.scroll.current,i)):n,c=t.displaced,d=D1({afterDragging:V9(c.all,a),destination:n,displacedBy:t.displacedBy,viewport:s.frame,last:c,forceShouldAnimate:!1}),u=D1({afterDragging:V9(c.all,a),destination:l,displacedBy:t.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),f={},m={},h=[c,d,u];c.all.forEach(function(g){var x=Let(g,h);if(x){m[g]=x;return}f[g]=!0});var v=qn({},t,{displaced:{all:c.all,invisible:f,visible:m}});return v},Fet=function(e,t){return js(e.scroll.diff.displacement,t)},XM=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=e.viewport,a=Fet(n,t),i=mc(a,r.page.borderBox.center);return js(r.client.borderBox.center,i)},pae=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,a=e.viewport,i=e.withDroppableDisplacement,s=e.onlyOnMainAxis,l=s===void 0?!1:s,c=mc(n,t.page.borderBox.center),d=Pw(t.page.borderBox,c),u={target:d,destination:r,withDroppableDisplacement:i,viewport:a};return l?Net(u):fae(u)},Bet=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.draggables,i=e.previousImpact,s=e.viewport,l=e.previousPageBorderBoxCenter,c=e.previousClientSelection,d=e.afterCritical;if(!n.isEnabled)return null;var u=_0(n.descriptor.id,a),f=S0(r,n),m=pet({isMovingForward:t,draggable:r,destination:n,insideDestination:u,previousImpact:i})||ket({isMovingForward:t,isInHomeList:f,draggable:r,draggables:a,destination:n,insideDestination:u,previousImpact:i,viewport:s,afterCritical:d});if(!m)return null;var h=P5({impact:m,draggable:r,droppable:n,draggables:a,afterCritical:d}),v=pae({draggable:r,destination:n,newPageBorderBoxCenter:h,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(v){var g=XM({pageBorderBoxCenter:h,draggable:r,viewport:s});return{clientSelection:g,impact:m,scrollJumpRequest:null}}var x=mc(h,l),y=$et({impact:m,viewport:s,destination:n,draggables:a,maxScrollChange:x});return{clientSelection:c,impact:y,scrollJumpRequest:x}},Qs=function(t){var r=t.subject.active;return r||Xr(!1),r},qet=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,a=e.droppables,i=e.viewport,s=n.subject.active;if(!s)return null;var l=n.axis,c=md(s[l.start],s[l.end]),d=_5(a).filter(function(f){return f!==n}).filter(function(f){return f.isEnabled}).filter(function(f){return!!f.subject.active}).filter(function(f){return dae(i.frame)(Qs(f))}).filter(function(f){var m=Qs(f);return t?s[l.crossAxisEnd]<m[l.crossAxisEnd]:m[l.crossAxisStart]<s[l.crossAxisStart]}).filter(function(f){var m=Qs(f),h=md(m[l.start],m[l.end]);return c(m[l.start])||c(m[l.end])||h(s[l.start])||h(s[l.end])}).sort(function(f,m){var h=Qs(f)[l.crossAxisStart],v=Qs(m)[l.crossAxisStart];return t?h-v:v-h}).filter(function(f,m,h){return Qs(f)[l.crossAxisStart]===Qs(h[0])[l.crossAxisStart]});if(!d.length)return null;if(d.length===1)return d[0];var u=d.filter(function(f){var m=md(Qs(f)[l.start],Qs(f)[l.end]);return m(r[l.line])});return u.length===1?u[0]:u.length>1?u.sort(function(f,m){return Qs(f)[l.start]-Qs(m)[l.start]})[0]:d.sort(function(f,m){var h=F9(r,B9(Qs(f))),v=F9(r,B9(Qs(m)));return h!==v?h-v:Qs(f)[l.start]-Qs(m)[l.start]})[0]},W9=function(t,r){var n=t.page.borderBox.center;return xh(t.descriptor.id,r)?mc(n,r.displacedBy.point):n},zet=function(t,r){var n=t.page.borderBox;return xh(t.descriptor.id,r)?Pw(n,N0(r.displacedBy.point)):n},Uet=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,a=e.insideDestination,i=e.afterCritical,s=a.filter(function(l){return fae({target:zet(l,i),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(l,c){var d=T1(t,w4(n,W9(l,i))),u=T1(t,w4(n,W9(c,i)));return d<u?-1:u<d?1:l.descriptor.index-c.descriptor.index});return s[0]||null},Aw=os(function(t,r){var n=r[t.line];return{value:n,point:lg(t.line,n)}}),Vet=function(t,r,n){var a=t.axis;if(t.descriptor.mode==="virtual")return lg(a.line,r[a.line]);var i=t.subject.page.contentBox[a.size],s=_0(t.descriptor.id,n),l=s.reduce(function(u,f){return u+f.client.marginBox[a.size]},0),c=l+r[a.line],d=c-i;return d<=0?null:lg(a.line,d)},gae=function(t,r){return qn({},t,{scroll:qn({},t.scroll,{max:r})})},vae=function(t,r,n){var a=t.frame;S0(r,t)&&Xr(!1),t.subject.withPlaceholder&&Xr(!1);var i=Aw(t.axis,r.displaceBy).point,s=Vet(t,i,n),l={placeholderSize:i,increasedBy:s,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!a){var c=Vx({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:t.frame});return qn({},t,{subject:c})}var d=s?js(a.scroll.max,s):a.scroll.max,u=gae(a,d),f=Vx({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:u});return qn({},t,{subject:f,frame:u})},Wet=function(t){var r=t.subject.withPlaceholder;r||Xr(!1);var n=t.frame;if(!n){var a=Vx({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return qn({},t,{subject:a})}var i=r.oldFrameMaxScroll;i||Xr(!1);var s=gae(n,i),l=Vx({page:t.subject.page,axis:t.axis,frame:s,withPlaceholder:null});return qn({},t,{subject:l,frame:s})},Het=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,a=e.draggable,i=e.draggables,s=e.destination,l=e.viewport,c=e.afterCritical;if(!r){if(n.length)return null;var d={displaced:I1,displacedBy:cae,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:0}}},u=P5({impact:d,draggable:a,droppable:s,draggables:i,afterCritical:c}),f=S0(a,s)?s:vae(s,a,i),m=pae({draggable:a,destination:f,newPageBorderBoxCenter:u,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return m?d:null}var h=t[s.axis.line]<=r.page.borderBox.center[s.axis.line],v=function(){var x=r.descriptor.index;return r.descriptor.id===a.descriptor.id||h?x:x+1}(),g=Aw(s.axis,a.displaceBy);return eS({draggable:a,insideDestination:n,destination:s,viewport:l,displacedBy:g,last:I1,index:v})},Get=function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,a=e.isOver,i=e.draggables,s=e.droppables,l=e.viewport,c=e.afterCritical,d=qet({isMovingForward:t,pageBorderBoxCenter:r,source:a,droppables:s,viewport:l});if(!d)return null;var u=_0(d.descriptor.id,i),f=Uet({pageBorderBoxCenter:r,viewport:l,destination:d,insideDestination:u,afterCritical:c}),m=Het({previousPageBorderBoxCenter:r,destination:d,draggable:n,draggables:i,moveRelativeTo:f,insideDestination:u,viewport:l,afterCritical:c});if(!m)return null;var h=P5({impact:m,draggable:n,droppable:d,draggables:i,afterCritical:c}),v=XM({pageBorderBoxCenter:h,draggable:n,viewport:l});return{clientSelection:v,impact:m,scrollJumpRequest:null}},jc=function(e){var t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null},Ket=function(t,r){var n=jc(t);return n?r[n]:null},Yet=function(e){var t=e.state,r=e.type,n=Ket(t.impact,t.dimensions.droppables),a=!!n,i=t.dimensions.droppables[t.critical.droppable.id],s=n||i,l=s.axis.direction,c=l==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||l==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(c&&!a)return null;var d=r==="MOVE_DOWN"||r==="MOVE_RIGHT",u=t.dimensions.draggables[t.critical.draggable.id],f=t.current.page.borderBoxCenter,m=t.dimensions,h=m.draggables,v=m.droppables;return c?Bet({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,destination:s,draggables:h,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):Get({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,isOver:s,draggables:h,droppables:v,viewport:t.viewport,afterCritical:t.afterCritical})};function ap(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function xae(e){var t=md(e.top,e.bottom),r=md(e.left,e.right);return function(a){return t(a.y)&&r(a.x)}}function Xet(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function Jet(e){var t=e.pageBorderBox,r=e.draggable,n=e.candidates,a=r.page.borderBox.center,i=n.map(function(s){var l=s.axis,c=lg(s.axis.line,t.center[l.line],s.page.borderBox.center[l.crossAxisLine]);return{id:s.descriptor.id,distance:T1(a,c)}}).sort(function(s,l){return l.distance-s.distance});return i[0]?i[0].id:null}function Qet(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,a=_5(n).filter(function(i){if(!i.isEnabled)return!1;var s=i.subject.active;if(!s||!Xet(t,s))return!1;if(xae(s)(t.center))return!0;var l=i.axis,c=s.center[l.crossAxisLine],d=t[l.crossAxisStart],u=t[l.crossAxisEnd],f=md(s[l.crossAxisStart],s[l.crossAxisEnd]),m=f(d),h=f(u);return!m&&!h?!0:m?d<c:u>c});return a.length?a.length===1?a[0].descriptor.id:Jet({pageBorderBox:t,draggable:r,candidates:a}):null}var yae=function(t,r){return Wd(Pw(t,r))},Zet=function(e,t){var r=e.frame;return r?yae(t,r.scroll.diff.value):t};function bae(e){var t=e.displaced,r=e.id;return!!(t.visible[r]||t.invisible[r])}function ett(e){var t=e.draggable,r=e.closest,n=e.inHomeList;return r?n&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var ttt=function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.last,s=e.viewport,l=e.afterCritical,c=n.axis,d=Aw(n.axis,r.displaceBy),u=d.value,f=t[c.start],m=t[c.end],h=C5(r,a),v=Ih(h,function(x){var y=x.descriptor.id,b=x.page.borderBox.center[c.line],w=xh(y,l),j=bae({displaced:i,id:y});return w?j?m<=b:f<b-u:j?m<=b+u:f<b}),g=ett({draggable:r,closest:v,inHomeList:S0(r,n)});return eS({draggable:r,insideDestination:a,destination:n,viewport:s,last:i,displacedBy:d,index:g})},rtt=4,ntt=function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,a=e.destination,i=e.insideDestination,s=e.afterCritical;if(!a.isCombineEnabled)return null;var l=a.axis,c=Aw(a.axis,t.displaceBy),d=c.value,u=r[l.start],f=r[l.end],m=C5(t,i),h=Ih(m,function(g){var x=g.descriptor.id,y=g.page.borderBox,b=y[l.size],w=b/rtt,j=xh(x,s),_=bae({displaced:n.displaced,id:x});return j?_?f>y[l.start]+w&&f<y[l.end]-w:u>y[l.start]-d+w&&u<y[l.end]-d-w:_?f>y[l.start]+d+w&&f<y[l.end]+d-w:u>y[l.start]+w&&u<y[l.end]-w});if(!h)return null;var v={displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:h.descriptor.id,droppableId:a.descriptor.id}}};return v},wae=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,a=e.droppables,i=e.previousImpact,s=e.viewport,l=e.afterCritical,c=yae(r.page.borderBox,t),d=Qet({pageBorderBox:c,draggable:r,droppables:a});if(!d)return get;var u=a[d],f=_0(u.descriptor.id,n),m=Zet(u,c);return ntt({pageBorderBoxWithDroppableScroll:m,draggable:r,previousImpact:i,destination:u,insideDestination:f,afterCritical:l})||ttt({pageBorderBoxWithDroppableScroll:m,draggable:r,destination:u,insideDestination:f,last:i.displaced,viewport:s,afterCritical:l})},JM=function(e,t){var r;return qn({},e,(r={},r[t.descriptor.id]=t,r))},att=function(t){var r=t.previousImpact,n=t.impact,a=t.droppables,i=jc(r),s=jc(n);if(!i||i===s)return a;var l=a[i];if(!l.subject.withPlaceholder)return a;var c=Wet(l);return JM(a,c)},ott=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,a=e.previousImpact,i=e.impact,s=att({previousImpact:a,impact:i,droppables:n}),l=jc(i);if(!l)return s;var c=n[l];if(S0(t,c)||c.subject.withPlaceholder)return s;var d=vae(c,t,r);return JM(s,d)},ab=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,a=e.viewport,i=e.impact,s=e.scrollJumpRequest,l=a||t.viewport,c=n||t.dimensions,d=r||t.current.client.selection,u=mc(d,t.initial.client.selection),f={offset:u,selection:d,borderBoxCenter:js(t.initial.client.borderBoxCenter,u)},m={selection:js(f.selection,l.scroll.current),borderBoxCenter:js(f.borderBoxCenter,l.scroll.current),offset:js(f.offset,l.scroll.diff.value)},h={client:f,page:m};if(t.phase==="COLLECTING")return qn({phase:"COLLECTING"},t,{dimensions:c,viewport:l,current:h});var v=c.draggables[t.critical.draggable.id],g=i||wae({pageOffset:m.offset,draggable:v,draggables:c.draggables,droppables:c.droppables,previousImpact:t.impact,viewport:l,afterCritical:t.afterCritical}),x=ott({draggable:v,impact:g,previousImpact:t.impact,draggables:c.draggables,droppables:c.droppables}),y=qn({},t,{current:h,dimensions:{draggables:c.draggables,droppables:x},impact:g,viewport:l,scrollJumpRequest:s||null,forceShouldAnimate:s?!1:null});return y};function itt(e,t){return e.map(function(r){return t[r]})}var jae=function(e){var t=e.impact,r=e.viewport,n=e.draggables,a=e.destination,i=e.forceShouldAnimate,s=t.displaced,l=itt(s.all,n),c=D1({afterDragging:l,destination:a,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:i,last:s});return qn({},t,{displaced:c})},Nae=function(e){var t=e.impact,r=e.draggable,n=e.droppable,a=e.draggables,i=e.viewport,s=e.afterCritical,l=P5({impact:t,draggable:r,draggables:a,droppable:n,afterCritical:s});return XM({pageBorderBoxCenter:l,draggable:r,viewport:i})},_ae=function(e){var t=e.state,r=e.dimensions,n=e.viewport;t.movementMode!=="SNAP"&&Xr(!1);var a=t.impact,i=n||t.viewport,s=r||t.dimensions,l=s.draggables,c=s.droppables,d=l[t.critical.draggable.id],u=jc(a);u||Xr(!1);var f=c[u],m=jae({impact:a,viewport:i,destination:f,draggables:l}),h=Nae({impact:m,draggable:d,droppable:f,draggables:l,viewport:i,afterCritical:t.afterCritical});return ab({impact:m,clientSelection:h,state:t,dimensions:s,viewport:i})},stt=function(e){return{index:e.index,droppableId:e.droppableId}},Sae=function(e){var t=e.draggable,r=e.home,n=e.draggables,a=e.viewport,i=Aw(r.axis,t.displaceBy),s=_0(r.descriptor.id,n),l=s.indexOf(t);l===-1&&Xr(!1);var c=s.slice(l+1),d=c.reduce(function(h,v){return h[v.descriptor.id]=!0,h},{}),u={inVirtualList:r.descriptor.mode==="virtual",displacedBy:i,effected:d},f=D1({afterDragging:c,destination:r,displacedBy:i,last:null,viewport:a.frame,forceShouldAnimate:!1}),m={displaced:f,displacedBy:i,at:{type:"REORDER",destination:stt(t.descriptor)}};return{impact:m,afterCritical:u}},ltt=function(e,t){return{draggables:e.draggables,droppables:JM(e.droppables,t)}},ctt=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,a=Y_(t.client,r),i=X_(a,n),s=qn({},t,{placeholder:qn({},t.placeholder,{client:a}),client:a,page:i});return s},dtt=function(e){var t=e.frame;return t||Xr(!1),t},utt=function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,a=n.scroll.diff.value;return t.map(function(i){var s=i.descriptor.droppableId,l=r[s],c=dtt(l),d=c.scroll.diff.value,u=js(a,d),f=ctt({draggable:i,offset:u,initialWindowScroll:n.scroll.initial});return f})},ftt=function(e){var t=e.state,r=e.published,n=r.modified.map(function(w){var j=t.dimensions.droppables[w.droppableId],_=VM(j,w.scroll);return _}),a=qn({},t.dimensions.droppables,{},sae(n)),i=lae(utt({additions:r.additions,updatedDroppables:a,viewport:t.viewport})),s=qn({},t.dimensions.draggables,{},i);r.removals.forEach(function(w){delete s[w]});var l={droppables:a,draggables:s},c=jc(t.impact),d=c?l.droppables[c]:null,u=l.draggables[t.critical.draggable.id],f=l.droppables[t.critical.droppable.id],m=Sae({draggable:u,home:f,draggables:s,viewport:t.viewport}),h=m.impact,v=m.afterCritical,g=d&&d.isCombineEnabled?t.impact:h,x=wae({pageOffset:t.current.page.offset,draggable:l.draggables[t.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:g,viewport:t.viewport,afterCritical:v}),y=qn({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:x,onLiftImpact:h,dimensions:l,afterCritical:v,forceShouldAnimate:!1});if(t.phase==="COLLECTING")return y;var b=qn({phase:"DROP_PENDING"},y,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1});return b},j4=function(t){return t.movementMode==="SNAP"},pE=function(t,r,n){var a=ltt(t.dimensions,r);return!j4(t)||n?ab({state:t,dimensions:a}):_ae({state:t,dimensions:a})};function gE(e){return e.isDragging&&e.movementMode==="SNAP"?qn({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var H9={phase:"IDLE",completed:null,shouldFlush:!1},mtt=function(e,t){if(e===void 0&&(e=H9),t.type==="FLUSH")return qn({},H9,{shouldFlush:!0});if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&Xr(!1);var r=t.payload,n=r.critical,a=r.clientSelection,i=r.viewport,s=r.dimensions,l=r.movementMode,c=s.draggables[n.draggable.id],d=s.droppables[n.droppable.id],u={selection:a,borderBoxCenter:c.client.borderBox.center,offset:is},f={client:u,page:{selection:js(u.selection,i.scroll.initial),borderBoxCenter:js(u.selection,i.scroll.initial),offset:js(u.selection,i.scroll.diff.value)}},m=_5(s.droppables).every(function(je){return!je.isFixedOnPage}),h=Sae({draggable:c,home:d,draggables:s.draggables,viewport:i}),v=h.impact,g=h.afterCritical,x={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:s,initial:f,current:f,isWindowScrollAllowed:m,impact:v,afterCritical:g,onLiftImpact:v,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null};return x}if(t.type==="COLLECTION_STARTING"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&Xr(!1);var y=qn({phase:"COLLECTING"},e,{phase:"COLLECTING"});return y}if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||Xr(!1),ftt({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;ap(e)||Xr(!1);var b=t.payload.client;return ih(b,e.current.client.selection)?e:ab({state:e,clientSelection:b,impact:j4(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return gE(e);ap(e)||Xr(!1);var w=t.payload,j=w.id,_=w.newScroll,S=e.dimensions.droppables[j];if(!S)return e;var k=VM(S,_);return pE(e,k,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;ap(e)||Xr(!1);var E=t.payload,A=E.id,M=E.isEnabled,C=e.dimensions.droppables[A];C||Xr(!1),C.isEnabled===M&&Xr(!1);var T=qn({},C,{isEnabled:M});return pE(e,T,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;ap(e)||Xr(!1);var I=t.payload,D=I.id,F=I.isCombineEnabled,z=e.dimensions.droppables[D];z||Xr(!1),z.isCombineEnabled===F&&Xr(!1);var q=qn({},z,{isCombineEnabled:F});return pE(e,q,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;ap(e)||Xr(!1),e.isWindowScrollAllowed||Xr(!1);var $=t.payload.newScroll;if(ih(e.viewport.scroll.current,$))return gE(e);var K=hae(e.viewport,$);return j4(e)?_ae({state:e,viewport:K}):ab({state:e,viewport:K})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!ap(e))return e;var ce=t.payload.maxScroll;if(ih(ce,e.viewport.scroll.max))return e;var fe=qn({},e.viewport,{scroll:qn({},e.viewport.scroll,{max:ce})});return qn({phase:"DRAGGING"},e,{viewport:fe})}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&Xr(!1);var B=Yet({state:e,type:t.type});return B?ab({state:e,impact:B.impact,clientSelection:B.clientSelection,scrollJumpRequest:B.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){var L=t.payload.reason;e.phase!=="COLLECTING"&&Xr(!1);var V=qn({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:L});return V}if(t.type==="DROP_ANIMATE"){var re=t.payload,me=re.completed,G=re.dropDuration,Q=re.newHomeClientOffset;e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||Xr(!1);var ae={phase:"DROP_ANIMATING",completed:me,dropDuration:G,newHomeClientOffset:Q,dimensions:e.dimensions};return ae}if(t.type==="DROP_COMPLETE"){var J=t.payload.completed;return{phase:"IDLE",completed:J,shouldFlush:!1}}return e},htt=function(t){return{type:"BEFORE_INITIAL_CAPTURE",payload:t}},ptt=function(t){return{type:"LIFT",payload:t}},gtt=function(t){return{type:"INITIAL_PUBLISH",payload:t}},vtt=function(t){return{type:"PUBLISH_WHILE_DRAGGING",payload:t}},xtt=function(){return{type:"COLLECTION_STARTING",payload:null}},ytt=function(t){return{type:"UPDATE_DROPPABLE_SCROLL",payload:t}},btt=function(t){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}},wtt=function(t){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}},Cae=function(t){return{type:"MOVE",payload:t}},jtt=function(t){return{type:"MOVE_BY_WINDOW_SCROLL",payload:t}},Ntt=function(t){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}},_tt=function(){return{type:"MOVE_UP",payload:null}},Stt=function(){return{type:"MOVE_DOWN",payload:null}},Ctt=function(){return{type:"MOVE_RIGHT",payload:null}},Ptt=function(){return{type:"MOVE_LEFT",payload:null}},QM=function(){return{type:"FLUSH",payload:null}},Att=function(t){return{type:"DROP_ANIMATE",payload:t}},ZM=function(t){return{type:"DROP_COMPLETE",payload:t}},Pae=function(t){return{type:"DROP",payload:t}},Ett=function(t){return{type:"DROP_PENDING",payload:t}},Aae=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},ktt=function(e){return function(t){var r=t.getState,n=t.dispatch;return function(a){return function(i){if(i.type!=="LIFT"){a(i);return}var s=i.payload,l=s.id,c=s.clientSelection,d=s.movementMode,u=r();u.phase==="DROP_ANIMATING"&&n(ZM({completed:u.completed})),r().phase!=="IDLE"&&Xr(!1),n(QM()),n(htt({draggableId:l,movementMode:d}));var f={shouldPublishImmediately:d==="SNAP"},m={draggableId:l,scrollOptions:f},h=e.startPublishing(m),v=h.critical,g=h.dimensions,x=h.viewport;n(gtt({critical:v,dimensions:g,clientSelection:c,movementMode:d,viewport:x}))}}}},Ott=function(e){return function(){return function(t){return function(r){r.type==="INITIAL_PUBLISH"&&e.dragging(),r.type==="DROP_ANIMATE"&&e.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&e.resting(),t(r)}}}},eR={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},M1={opacity:{drop:0,combining:.7},scale:{drop:.75}},tR={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},Wh=tR.outOfTheWay+"s "+eR.outOfTheWay,ob={fluid:"opacity "+Wh,snap:"transform "+Wh+", opacity "+Wh,drop:function(t){var r=t+"s "+eR.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+Wh,placeholder:"height "+Wh+", width "+Wh+", margin "+Wh},G9=function(t){return ih(t,is)?null:"translate("+t.x+"px, "+t.y+"px)"},N4={moveTo:G9,drop:function(t,r){var n=G9(t);return n?r?n+" scale("+M1.scale.drop+")":n:null}},_4=tR.minDropTime,Eae=tR.maxDropTime,Ttt=Eae-_4,K9=1500,Itt=.6,Dtt=function(e){var t=e.current,r=e.destination,n=e.reason,a=T1(t,r);if(a<=0)return _4;if(a>=K9)return Eae;var i=a/K9,s=_4+Ttt*i,l=n==="CANCEL"?s*Itt:s;return Number(l.toFixed(2))},Mtt=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,a=e.viewport,i=e.afterCritical,s=n.draggables,l=n.droppables,c=jc(t),d=c?l[c]:null,u=l[r.descriptor.droppableId],f=Nae({impact:t,draggable:r,draggables:s,afterCritical:i,droppable:d||u,viewport:a}),m=mc(f,r.client.borderBox.center);return m},Rtt=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,a=e.home,i=e.viewport,s=e.onLiftImpact;if(!n.at||r!=="DROP"){var l=jae({draggables:t,impact:s,destination:a,viewport:i,forceShouldAnimate:!0});return{impact:l,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var c=qn({},n,{displaced:I1});return{impact:c,didDropInsideDroppable:!0}},Ltt=function(e){var t=e.getState,r=e.dispatch;return function(n){return function(a){if(a.type!=="DROP"){n(a);return}var i=t(),s=a.payload.reason;if(i.phase==="COLLECTING"){r(Ett({reason:s}));return}if(i.phase!=="IDLE"){var l=i.phase==="DROP_PENDING"&&i.isWaiting;l&&Xr(!1),i.phase==="DRAGGING"||i.phase==="DROP_PENDING"||Xr(!1);var c=i.critical,d=i.dimensions,u=d.draggables[i.critical.draggable.id],f=Rtt({reason:s,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),m=f.impact,h=f.didDropInsideDroppable,v=h?HM(m):null,g=h?S5(m):null,x={index:c.draggable.index,droppableId:c.droppable.id},y={draggableId:u.descriptor.id,type:u.descriptor.type,source:x,reason:s,mode:i.movementMode,destination:v,combine:g},b=Mtt({impact:m,draggable:u,dimensions:d,viewport:i.viewport,afterCritical:i.afterCritical}),w={critical:i.critical,afterCritical:i.afterCritical,result:y,impact:m},j=!ih(i.current.client.offset,b)||!!y.combine;if(!j){r(ZM({completed:w}));return}var _=Dtt({current:i.current.client.offset,destination:b,reason:s}),S={newHomeClientOffset:b,dropDuration:_,completed:w};r(Att(S))}}}},kae=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function $tt(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||e()}}}function Ftt(e){var t=e.onWindowScroll;function r(){t(kae())}var n=O1(r),a=$tt(n),i=oh;function s(){return i!==oh}function l(){s()&&Xr(!1),i=ld(window,[a])}function c(){s()||Xr(!1),n.cancel(),i(),i=oh}return{start:l,stop:c,isActive:s}}var Btt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},qtt=function(e){var t=Ftt({onWindowScroll:function(n){e.dispatch(jtt({newScroll:n}))}});return function(r){return function(n){!t.isActive()&&n.type==="INITIAL_PUBLISH"&&t.start(),t.isActive()&&Btt(n)&&t.stop(),r(n)}}},ztt=function(e){var t=!1,r=!1,n=setTimeout(function(){r=!0}),a=function(s){t||r||(t=!0,e(s),clearTimeout(n))};return a.wasCalled=function(){return t},a},Utt=function(){var e=[],t=function(i){var s=WM(e,function(d){return d.timerId===i});s===-1&&Xr(!1);var l=e.splice(s,1),c=l[0];c.callback()},r=function(i){var s=setTimeout(function(){return t(s)}),l={timerId:s,callback:i};e.push(l)},n=function(){if(e.length){var i=[].concat(e);e.length=0,i.forEach(function(s){clearTimeout(s.timerId),s.callback()})}};return{add:r,flush:n}},Vtt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.droppableId===r.droppableId&&t.index===r.index},Wtt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.draggableId===r.draggableId&&t.droppableId===r.droppableId},Htt=function(t,r){if(t===r)return!0;var n=t.draggable.id===r.draggable.id&&t.draggable.droppableId===r.draggable.droppableId&&t.draggable.type===r.draggable.type&&t.draggable.index===r.draggable.index,a=t.droppable.id===r.droppable.id&&t.droppable.type===r.droppable.type;return n&&a},ay=function(t,r){r()},Y2=function(t,r){return{draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:r}},vE=function(t,r,n,a){if(!t){n(a(r));return}var i=ztt(n),s={announce:i};t(r,s),i.wasCalled()||n(a(r))},Gtt=function(e,t){var r=Utt(),n=null,a=function(m,h){n&&Xr(!1),ay("onBeforeCapture",function(){var v=e().onBeforeCapture;if(v){var g={draggableId:m,mode:h};v(g)}})},i=function(m,h){n&&Xr(!1),ay("onBeforeDragStart",function(){var v=e().onBeforeDragStart;v&&v(Y2(m,h))})},s=function(m,h){n&&Xr(!1);var v=Y2(m,h);n={mode:h,lastCritical:m,lastLocation:v.source,lastCombine:null},r.add(function(){ay("onDragStart",function(){return vE(e().onDragStart,v,t,Dj.onDragStart)})})},l=function(m,h){var v=HM(h),g=S5(h);n||Xr(!1);var x=!Htt(m,n.lastCritical);x&&(n.lastCritical=m);var y=!Vtt(n.lastLocation,v);y&&(n.lastLocation=v);var b=!Wtt(n.lastCombine,g);if(b&&(n.lastCombine=g),!(!x&&!y&&!b)){var w=qn({},Y2(m,n.mode),{combine:g,destination:v});r.add(function(){ay("onDragUpdate",function(){return vE(e().onDragUpdate,w,t,Dj.onDragUpdate)})})}},c=function(){n||Xr(!1),r.flush()},d=function(m){n||Xr(!1),n=null,ay("onDragEnd",function(){return vE(e().onDragEnd,m,t,Dj.onDragEnd)})},u=function(){if(n){var m=qn({},Y2(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});d(m)}};return{beforeCapture:a,beforeStart:i,start:s,update:l,flush:c,drop:d,abort:u}},Ktt=function(e,t){var r=Gtt(e,t);return function(n){return function(a){return function(i){if(i.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(i.payload.draggableId,i.payload.movementMode);return}if(i.type==="INITIAL_PUBLISH"){var s=i.payload.critical;r.beforeStart(s,i.payload.movementMode),a(i),r.start(s,i.payload.movementMode);return}if(i.type==="DROP_COMPLETE"){var l=i.payload.completed.result;r.flush(),a(i),r.drop(l);return}if(a(i),i.type==="FLUSH"){r.abort();return}var c=n.getState();c.phase==="DRAGGING"&&r.update(c.critical,c.impact)}}}},Ytt=function(e){return function(t){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){t(r);return}var n=e.getState();n.phase!=="DROP_ANIMATING"&&Xr(!1),e.dispatch(ZM({completed:n.completed}))}}},Xtt=function(e){var t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return function(a){return function(i){if((i.type==="FLUSH"||i.type==="DROP_COMPLETE"||i.type==="DROP_ANIMATION_FINISHED")&&n(),a(i),i.type==="DROP_ANIMATE"){var s={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var c=e.getState();c.phase==="DROP_ANIMATING"&&e.dispatch(Aae())}};r=requestAnimationFrame(function(){r=null,t=ld(window,[s])})}}}},Jtt=function(e){return function(){return function(t){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&e.stopPublishing(),t(r)}}}},Qtt=function(e){var t=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(n.type==="FLUSH"){t=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){t=!1;var a=n.payload.completed.result;a.combine&&e.tryShiftRecord(a.draggableId,a.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}},Ztt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},ert=function(e){return function(t){return function(r){return function(n){if(Ztt(n)){e.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var a=t.getState();a.phase!=="DRAGGING"&&Xr(!1),e.start(a);return}r(n),e.scroll(t.getState())}}}},trt=function(e){return function(t){return function(r){if(t(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(Pae({reason:n.reason})))}}}},rrt=Rne,nrt=function(e){var t=e.dimensionMarshal,r=e.focusMarshal,n=e.styleMarshal,a=e.getResponders,i=e.announce,s=e.autoScroller;return Mne(mtt,rrt(zQe(Ott(n),Jtt(t),ktt(t),Ltt,Ytt,Xtt,trt,ert(s),qtt,Qtt(r),Ktt(a,i))))},xE=function(){return{additions:{},removals:{},modified:{}}};function art(e){var t=e.registry,r=e.callbacks,n=xE(),a=null,i=function(){a||(r.collectionStarting(),a=requestAnimationFrame(function(){a=null;var u=n,f=u.additions,m=u.removals,h=u.modified,v=Object.keys(f).map(function(y){return t.draggable.getById(y).getDimension(is)}).sort(function(y,b){return y.descriptor.index-b.descriptor.index}),g=Object.keys(h).map(function(y){var b=t.droppable.getById(y),w=b.callbacks.getScrollWhileDragging();return{droppableId:y,scroll:w}}),x={additions:v,removals:Object.keys(m),modified:g};n=xE(),r.publish(x)}))},s=function(u){var f=u.descriptor.id;n.additions[f]=u,n.modified[u.descriptor.droppableId]=!0,n.removals[f]&&delete n.removals[f],i()},l=function(u){var f=u.descriptor;n.removals[f.id]=!0,n.modified[f.droppableId]=!0,n.additions[f.id]&&delete n.additions[f.id],i()},c=function(){a&&(cancelAnimationFrame(a),a=null,n=xE())};return{add:s,remove:l,stop:c}}var Oae=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,a=e.width,i=mc({x:r,y:t},{x:a,y:n}),s={x:Math.max(0,i.x),y:Math.max(0,i.y)};return s},Tae=function(){var e=document.documentElement;return e||Xr(!1),e},Iae=function(){var e=Tae(),t=Oae({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight});return t},ort=function(){var e=kae(),t=Iae(),r=e.y,n=e.x,a=Tae(),i=a.clientWidth,s=a.clientHeight,l=n+i,c=r+s,d=Wd({top:r,left:n,right:l,bottom:c}),u={frame:d,scroll:{initial:e,current:e,max:t,diff:{value:is,displacement:is}}};return u},irt=function(e){var t=e.critical,r=e.scrollOptions,n=e.registry,a=ort(),i=a.scroll.current,s=t.droppable,l=n.droppable.getAllByType(s.type).map(function(f){return f.callbacks.getDimensionAndWatchScroll(i,r)}),c=n.draggable.getAllByType(t.draggable.type).map(function(f){return f.getDimension(i)}),d={draggables:lae(c),droppables:sae(l)},u={dimensions:d,critical:t,viewport:a};return u};function Y9(e,t,r){if(r.descriptor.id===t.id||r.descriptor.type!==t.type)return!1;var n=e.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var srt=function(e,t){var r=null,n=art({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),a=function(h,v){e.droppable.exists(h)||Xr(!1),r&&t.updateDroppableIsEnabled({id:h,isEnabled:v})},i=function(h,v){r&&(e.droppable.exists(h)||Xr(!1),t.updateDroppableIsCombineEnabled({id:h,isCombineEnabled:v}))},s=function(h,v){r&&(e.droppable.exists(h)||Xr(!1),t.updateDroppableScroll({id:h,newScroll:v}))},l=function(h,v){r&&e.droppable.getById(h).callbacks.scroll(v)},c=function(){if(r){n.stop();var h=r.critical.droppable;e.droppable.getAllByType(h.type).forEach(function(v){return v.callbacks.dragStopped()}),r.unsubscribe(),r=null}},d=function(h){r||Xr(!1);var v=r.critical.draggable;h.type==="ADDITION"&&Y9(e,v,h.value)&&n.add(h.value),h.type==="REMOVAL"&&Y9(e,v,h.value)&&n.remove(h.value)},u=function(h){r&&Xr(!1);var v=e.draggable.getById(h.draggableId),g=e.droppable.getById(v.descriptor.droppableId),x={draggable:v.descriptor,droppable:g.descriptor},y=e.subscribe(d);return r={critical:x,unsubscribe:y},irt({critical:x,registry:e,scrollOptions:h.scrollOptions})},f={updateDroppableIsEnabled:a,updateDroppableIsCombineEnabled:i,scrollDroppable:l,updateDroppableScroll:s,startPublishing:u,stopPublishing:c};return f},Dae=function(e,t){return e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP"},lrt=function(e){window.scrollBy(e.x,e.y)},crt=os(function(e){return _5(e).filter(function(t){return!(!t.isEnabled||!t.frame)})}),drt=function(t,r){var n=Ih(crt(r),function(a){return a.frame||Xr(!1),xae(a.frame.pageMarginBox)(t)});return n},urt=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var a=n[r];return a.frame?a:null}var i=drt(t,n);return i},sh={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(t){return Math.pow(t,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},frt=function(e,t){var r=e[t.size]*sh.startFromPercentage,n=e[t.size]*sh.maxScrollAtPercentage,a={startScrollingFrom:r,maxScrollValueAt:n};return a},Mae=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,a=r-t;if(a===0)return 0;var i=n-t,s=i/a;return s},rR=1,mrt=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return sh.maxPixelScroll;if(e===t.startScrollingFrom)return rR;var r=Mae({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=1-r,a=sh.maxPixelScroll*sh.ease(n);return Math.ceil(a)},X9=sh.durationDampening.accelerateAt,J9=sh.durationDampening.stopDampeningAt,hrt=function(e,t){var r=t,n=J9,a=Date.now(),i=a-r;if(i>=J9)return e;if(i<X9)return rR;var s=Mae({startOfRange:X9,endOfRange:n,current:i}),l=e*sh.ease(s);return Math.ceil(l)},Q9=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,a=e.shouldUseTimeDampening,i=mrt(t,r);return i===0?0:a?Math.max(hrt(i,n),rR):i},Z9=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,a=e.axis,i=e.shouldUseTimeDampening,s=frt(t,a),l=r[a.end]<r[a.start];return l?Q9({distanceToEdge:r[a.end],thresholds:s,dragStartTime:n,shouldUseTimeDampening:i}):-1*Q9({distanceToEdge:r[a.start],thresholds:s,dragStartTime:n,shouldUseTimeDampening:i})},prt=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,a=r.height>t.height,i=r.width>t.width;return!i&&!a?n:i&&a?null:{x:i?0:n.x,y:a?0:n.y}},grt=oae(function(e){return e===0?0:e}),Rae=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,a=e.center,i=e.shouldUseTimeDampening,s={top:a.y-r.top,right:r.right-a.x,bottom:r.bottom-a.y,left:a.x-r.left},l=Z9({container:r,distanceToEdges:s,dragStartTime:t,axis:GM,shouldUseTimeDampening:i}),c=Z9({container:r,distanceToEdges:s,dragStartTime:t,axis:uae,shouldUseTimeDampening:i}),d=grt({x:c,y:l});if(ih(d,is))return null;var u=prt({container:r,subject:n,proposedScroll:d});return u?ih(u,is)?null:u:null},vrt=oae(function(e){return e===0?0:e>0?1:-1}),nR=function(){var e=function(r,n){return r<0?r:r>n?r-n:0};return function(t){var r=t.current,n=t.max,a=t.change,i=js(r,a),s={x:e(i.x,n.x),y:e(i.y,n.y)};return ih(s,is)?null:s}}(),Lae=function(t){var r=t.max,n=t.current,a=t.change,i={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},s=vrt(a),l=nR({max:i,current:n,change:s});return!l||s.x!==0&&l.x===0||s.y!==0&&l.y===0},aR=function(t,r){return Lae({current:t.scroll.current,max:t.scroll.max,change:r})},xrt=function(t,r){if(!aR(t,r))return null;var n=t.scroll.max,a=t.scroll.current;return nR({current:a,max:n,change:r})},oR=function(t,r){var n=t.frame;return n?Lae({current:n.scroll.current,max:n.scroll.max,change:r}):!1},yrt=function(t,r){var n=t.frame;return!n||!oR(t,r)?null:nR({current:n.scroll.current,max:n.scroll.max,change:r})},brt=function(e){var t=e.viewport,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,s=Rae({dragStartTime:a,container:t.frame,subject:r,center:n,shouldUseTimeDampening:i});return s&&aR(t,s)?s:null},wrt=function(e){var t=e.droppable,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,s=t.frame;if(!s)return null;var l=Rae({dragStartTime:a,container:s.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:i});return l&&oR(t,l)?l:null},eU=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,a=e.scrollWindow,i=e.scrollDroppable,s=t.current.page.borderBoxCenter,l=t.dimensions.draggables[t.critical.draggable.id],c=l.page.marginBox;if(t.isWindowScrollAllowed){var d=t.viewport,u=brt({dragStartTime:r,viewport:d,subject:c,center:s,shouldUseTimeDampening:n});if(u){a(u);return}}var f=urt({center:s,destination:jc(t.impact),droppables:t.dimensions.droppables});if(f){var m=wrt({dragStartTime:r,droppable:f,subject:c,center:s,shouldUseTimeDampening:n});m&&i(f.descriptor.id,m)}},jrt=function(e){var t=e.scrollWindow,r=e.scrollDroppable,n=O1(t),a=O1(r),i=null,s=function(u){i||Xr(!1);var f=i,m=f.shouldUseTimeDampening,h=f.dragStartTime;eU({state:u,scrollWindow:n,scrollDroppable:a,dragStartTime:h,shouldUseTimeDampening:m})},l=function(u){i&&Xr(!1);var f=Date.now(),m=!1,h=function(){m=!0};eU({state:u,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:h,scrollDroppable:h}),i={dragStartTime:f,shouldUseTimeDampening:m},m&&s(u)},c=function(){i&&(n.cancel(),a.cancel(),i=null)};return{start:l,stop:c,scroll:s}},Nrt=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow,a=function(d,u){var f=js(d.current.client.selection,u);t({client:f})},i=function(d,u){if(!oR(d,u))return u;var f=yrt(d,u);if(!f)return r(d.descriptor.id,u),null;var m=mc(u,f);r(d.descriptor.id,m);var h=mc(u,m);return h},s=function(d,u,f){if(!d||!aR(u,f))return f;var m=xrt(u,f);if(!m)return n(f),null;var h=mc(f,m);n(h);var v=mc(f,h);return v},l=function(d){var u=d.scrollJumpRequest;if(u){var f=jc(d.impact);f||Xr(!1);var m=i(d.dimensions.droppables[f],u);if(m){var h=d.viewport,v=s(d.isWindowScrollAllowed,h,m);v&&a(d,v)}}};return l},_rt=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,a=jrt({scrollWindow:r,scrollDroppable:t}),i=Nrt({move:n,scrollWindow:r,scrollDroppable:t}),s=function(d){if(d.phase==="DRAGGING"){if(d.movementMode==="FLUID"){a.scroll(d);return}d.scrollJumpRequest&&i(d)}},l={scroll:s,start:a.start,stop:a.stop};return l},Wx="data-rbd",Hx=function(){var e=Wx+"-drag-handle";return{base:e,draggableId:e+"-draggable-id",contextId:e+"-context-id"}}(),S4=function(){var e=Wx+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Srt=function(){var e=Wx+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),tU={contextId:Wx+"-scroll-container-context-id"},Crt=function(t){return function(r){return"["+r+'="'+t+'"]'}},oy=function(t,r){return t.map(function(n){var a=n.styles[r];return a?n.selector+" { "+a+" }":""}).join(" ")},Prt="pointer-events: none;",Art=function(e){var t=Crt(e),r=function(){var l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(Hx.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:Prt,dropAnimating:l}}}(),n=function(){var l=`
      transition: `+ob.outOfTheWay+`;
    `;return{selector:t(S4.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}}(),a={selector:t(Srt.contextId),styles:{always:"overflow-anchor: none;"}},i={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},s=[n,r,a,i];return{always:oy(s,"always"),resting:oy(s,"resting"),dragging:oy(s,"dragging"),dropAnimating:oy(s,"dropAnimating"),userCancel:oy(s,"userCancel")}},Nc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,yE=function(){var t=document.querySelector("head");return t||Xr(!1),t},rU=function(t){var r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.type="text/css",r};function Ert(e,t){var r=za(function(){return Art(e)},[e]),n=p.useRef(null),a=p.useRef(null),i=In(os(function(f){var m=a.current;m||Xr(!1),m.textContent=f}),[]),s=In(function(f){var m=n.current;m||Xr(!1),m.textContent=f},[]);Nc(function(){!n.current&&!a.current||Xr(!1);var f=rU(t),m=rU(t);return n.current=f,a.current=m,f.setAttribute(Wx+"-always",e),m.setAttribute(Wx+"-dynamic",e),yE().appendChild(f),yE().appendChild(m),s(r.always),i(r.resting),function(){var h=function(g){var x=g.current;x||Xr(!1),yE().removeChild(x),g.current=null};h(n),h(a)}},[t,s,i,r.always,r.resting,e]);var l=In(function(){return i(r.dragging)},[i,r.dragging]),c=In(function(f){if(f==="DROP"){i(r.dropAnimating);return}i(r.userCancel)},[i,r.dropAnimating,r.userCancel]),d=In(function(){a.current&&i(r.resting)},[i,r.resting]),u=za(function(){return{dragging:l,dropping:c,resting:d}},[l,c,d]);return u}var $ae=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function A5(e){return e instanceof $ae(e).HTMLElement}function krt(e,t){var r="["+Hx.contextId+'="'+e+'"]',n=iae(document.querySelectorAll(r));if(!n.length)return null;var a=Ih(n,function(i){return i.getAttribute(Hx.draggableId)===t});return!a||!A5(a)?null:a}function Ort(e){var t=p.useRef({}),r=p.useRef(null),n=p.useRef(null),a=p.useRef(!1),i=In(function(m,h){var v={id:m,focus:h};return t.current[m]=v,function(){var x=t.current,y=x[m];y!==v&&delete x[m]}},[]),s=In(function(m){var h=krt(e,m);h&&h!==document.activeElement&&h.focus()},[e]),l=In(function(m,h){r.current===m&&(r.current=h)},[]),c=In(function(){n.current||a.current&&(n.current=requestAnimationFrame(function(){n.current=null;var m=r.current;m&&s(m)}))},[s]),d=In(function(m){r.current=null;var h=document.activeElement;h&&h.getAttribute(Hx.draggableId)===m&&(r.current=m)},[]);Nc(function(){return a.current=!0,function(){a.current=!1;var m=n.current;m&&cancelAnimationFrame(m)}},[]);var u=za(function(){return{register:i,tryRecordFocus:d,tryRestoreFocusRecorded:c,tryShiftRecord:l}},[i,d,c,l]);return u}function Trt(){var e={draggables:{},droppables:{}},t=[];function r(f){return t.push(f),function(){var h=t.indexOf(f);h!==-1&&t.splice(h,1)}}function n(f){t.length&&t.forEach(function(m){return m(f)})}function a(f){return e.draggables[f]||null}function i(f){var m=a(f);return m||Xr(!1),m}var s={register:function(m){e.draggables[m.descriptor.id]=m,n({type:"ADDITION",value:m})},update:function(m,h){var v=e.draggables[h.descriptor.id];v&&v.uniqueId===m.uniqueId&&(delete e.draggables[h.descriptor.id],e.draggables[m.descriptor.id]=m)},unregister:function(m){var h=m.descriptor.id,v=a(h);v&&m.uniqueId===v.uniqueId&&(delete e.draggables[h],n({type:"REMOVAL",value:m}))},getById:i,findById:a,exists:function(m){return!!a(m)},getAllByType:function(m){return Z_(e.draggables).filter(function(h){return h.descriptor.type===m})}};function l(f){return e.droppables[f]||null}function c(f){var m=l(f);return m||Xr(!1),m}var d={register:function(m){e.droppables[m.descriptor.id]=m},unregister:function(m){var h=l(m.descriptor.id);h&&m.uniqueId===h.uniqueId&&delete e.droppables[m.descriptor.id]},getById:c,findById:l,exists:function(m){return!!l(m)},getAllByType:function(m){return Z_(e.droppables).filter(function(h){return h.descriptor.type===m})}};function u(){e.draggables={},e.droppables={},t.length=0}return{draggable:s,droppable:d,subscribe:r,clean:u}}function Irt(){var e=za(Trt,[]);return p.useEffect(function(){return function(){requestAnimationFrame(e.clean)}},[e]),e}var iR=xe.createContext(null),tS=function(){var e=document.body;return e||Xr(!1),e},Drt={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},Mrt=function(t){return"rbd-announcement-"+t};function Rrt(e){var t=za(function(){return Mrt(e)},[e]),r=p.useRef(null);p.useEffect(function(){var i=document.createElement("div");return r.current=i,i.id=t,i.setAttribute("aria-live","assertive"),i.setAttribute("aria-atomic","true"),qn(i.style,Drt),tS().appendChild(i),function(){setTimeout(function(){var c=tS();c.contains(i)&&c.removeChild(i),i===r.current&&(r.current=null)})}},[t]);var n=In(function(a){var i=r.current;if(i){i.textContent=a;return}},[]);return n}var Lrt=0,$rt={separator:"::"};function sR(e,t){return t===void 0&&(t=$rt),za(function(){return""+e+t.separator+Lrt++},[t.separator,e])}function Frt(e){var t=e.contextId,r=e.uniqueId;return"rbd-hidden-text-"+t+"-"+r}function Brt(e){var t=e.contextId,r=e.text,n=sR("hidden-text",{separator:"-"}),a=za(function(){return Frt({contextId:t,uniqueId:n})},[n,t]);return p.useEffect(function(){var s=document.createElement("div");return s.id=a,s.textContent=r,s.style.display="none",tS().appendChild(s),function(){var c=tS();c.contains(s)&&c.removeChild(s)}},[a,r]),a}var E5=xe.createContext(null);function Fae(e){var t=p.useRef(e);return p.useEffect(function(){t.current=e}),t}function qrt(){var e=null;function t(){return!!e}function r(s){return s===e}function n(s){e&&Xr(!1);var l={abandon:s};return e=l,l}function a(){e||Xr(!1),e=null}function i(){e&&(e.abandon(),a())}return{isClaimed:t,isActive:r,claim:n,release:a,tryAbandon:i}}var zrt=9,Urt=13,lR=27,Bae=32,Vrt=33,Wrt=34,Hrt=35,Grt=36,Krt=37,Yrt=38,Xrt=39,Jrt=40,X2,Qrt=(X2={},X2[Urt]=!0,X2[zrt]=!0,X2),qae=function(e){Qrt[e.keyCode]&&e.preventDefault()},k5=function(){var e="visibilitychange";if(typeof document>"u")return e;var t=[e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],r=Ih(t,function(n){return"on"+n in document});return r||e}(),zae=0,nU=5;function Zrt(e,t){return Math.abs(t.x-e.x)>=nU||Math.abs(t.y-e.y)>=nU}var aU={type:"IDLE"};function ent(e){var t=e.cancel,r=e.completed,n=e.getPhase,a=e.setPhase;return[{eventName:"mousemove",fn:function(s){var l=s.button,c=s.clientX,d=s.clientY;if(l===zae){var u={x:c,y:d},f=n();if(f.type==="DRAGGING"){s.preventDefault(),f.actions.move(u);return}f.type!=="PENDING"&&Xr(!1);var m=f.point;if(Zrt(m,u)){s.preventDefault();var h=f.actions.fluidLift(u);a({type:"DRAGGING",actions:h})}}}},{eventName:"mouseup",fn:function(s){var l=n();if(l.type!=="DRAGGING"){t();return}s.preventDefault(),l.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(s){n().type==="DRAGGING"&&s.preventDefault(),t()}},{eventName:"keydown",fn:function(s){var l=n();if(l.type==="PENDING"){t();return}if(s.keyCode===lR){s.preventDefault(),t();return}qae(s)}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&t()}},{eventName:"webkitmouseforcedown",fn:function(s){var l=n();if(l.type==="IDLE"&&Xr(!1),l.actions.shouldRespectForcePress()){t();return}s.preventDefault()}},{eventName:k5,fn:t}]}function tnt(e){var t=p.useRef(aU),r=p.useRef(oh),n=za(function(){return{eventName:"mousedown",fn:function(f){if(!f.defaultPrevented&&f.button===zae&&!(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)){var m=e.findClosestDraggableId(f);if(m){var h=e.tryGetLock(m,s,{sourceEvent:f});if(h){f.preventDefault();var v={x:f.clientX,y:f.clientY};r.current(),d(h,v)}}}}}},[e]),a=za(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(f){if(!f.defaultPrevented){var m=e.findClosestDraggableId(f);if(m){var h=e.findOptionsForDraggable(m);h&&(h.shouldRespectForcePress||e.canGetLock(m)&&f.preventDefault())}}}}},[e]),i=In(function(){var f={passive:!1,capture:!0};r.current=ld(window,[a,n],f)},[a,n]),s=In(function(){var u=t.current;u.type!=="IDLE"&&(t.current=aU,r.current(),i())},[i]),l=In(function(){var u=t.current;s(),u.type==="DRAGGING"&&u.actions.cancel({shouldBlockNextClick:!0}),u.type==="PENDING"&&u.actions.abort()},[s]),c=In(function(){var f={capture:!0,passive:!1},m=ent({cancel:l,completed:s,getPhase:function(){return t.current},setPhase:function(v){t.current=v}});r.current=ld(window,m,f)},[l,s]),d=In(function(f,m){t.current.type!=="IDLE"&&Xr(!1),t.current={type:"PENDING",point:m,actions:f},c()},[c]);Nc(function(){return i(),function(){r.current()}},[i])}var Xg;function rnt(){}var nnt=(Xg={},Xg[Wrt]=!0,Xg[Vrt]=!0,Xg[Grt]=!0,Xg[Hrt]=!0,Xg);function ant(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:function(i){if(i.keyCode===lR){i.preventDefault(),r();return}if(i.keyCode===Bae){i.preventDefault(),n();return}if(i.keyCode===Jrt){i.preventDefault(),e.moveDown();return}if(i.keyCode===Yrt){i.preventDefault(),e.moveUp();return}if(i.keyCode===Xrt){i.preventDefault(),e.moveRight();return}if(i.keyCode===Krt){i.preventDefault(),e.moveLeft();return}if(nnt[i.keyCode]){i.preventDefault();return}qae(i)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:k5,fn:r}]}function ont(e){var t=p.useRef(rnt),r=za(function(){return{eventName:"keydown",fn:function(i){if(i.defaultPrevented||i.keyCode!==Bae)return;var s=e.findClosestDraggableId(i);if(!s)return;var l=e.tryGetLock(s,u,{sourceEvent:i});if(!l)return;i.preventDefault();var c=!0,d=l.snapLift();t.current();function u(){c||Xr(!1),c=!1,t.current(),n()}t.current=ld(window,ant(d,u),{capture:!0,passive:!1})}}},[e]),n=In(function(){var i={passive:!1,capture:!0};t.current=ld(window,[r],i)},[r]);Nc(function(){return n(),function(){t.current()}},[n])}var bE={type:"IDLE"},int=120,snt=.15;function lnt(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(a){a.preventDefault()}},{eventName:"keydown",fn:function(a){if(r().type!=="DRAGGING"){t();return}a.keyCode===lR&&a.preventDefault(),t()}},{eventName:k5,fn:t}]}function cnt(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(i){var s=n();if(s.type!=="DRAGGING"){t();return}s.hasMoved=!0;var l=i.touches[0],c=l.clientX,d=l.clientY,u={x:c,y:d};i.preventDefault(),s.actions.move(u)}},{eventName:"touchend",fn:function(i){var s=n();if(s.type!=="DRAGGING"){t();return}i.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(i){if(n().type!=="DRAGGING"){t();return}i.preventDefault(),t()}},{eventName:"touchforcechange",fn:function(i){var s=n();s.type==="IDLE"&&Xr(!1);var l=i.touches[0];if(l){var c=l.force>=snt;if(c){var d=s.actions.shouldRespectForcePress();if(s.type==="PENDING"){d&&t();return}if(d){if(s.hasMoved){i.preventDefault();return}t();return}i.preventDefault()}}}},{eventName:k5,fn:t}]}function dnt(e){var t=p.useRef(bE),r=p.useRef(oh),n=In(function(){return t.current},[]),a=In(function(h){t.current=h},[]),i=za(function(){return{eventName:"touchstart",fn:function(h){if(!h.defaultPrevented){var v=e.findClosestDraggableId(h);if(v){var g=e.tryGetLock(v,l,{sourceEvent:h});if(g){var x=h.touches[0],y=x.clientX,b=x.clientY,w={x:y,y:b};r.current(),f(g,w)}}}}}},[e]),s=In(function(){var h={capture:!0,passive:!1};r.current=ld(window,[i],h)},[i]),l=In(function(){var m=t.current;m.type!=="IDLE"&&(m.type==="PENDING"&&clearTimeout(m.longPressTimerId),a(bE),r.current(),s())},[s,a]),c=In(function(){var m=t.current;l(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[l]),d=In(function(){var h={capture:!0,passive:!1},v={cancel:c,completed:l,getPhase:n},g=ld(window,cnt(v),h),x=ld(window,lnt(v),h);r.current=function(){g(),x()}},[c,n,l]),u=In(function(){var h=n();h.type!=="PENDING"&&Xr(!1);var v=h.actions.fluidLift(h.point);a({type:"DRAGGING",actions:v,hasMoved:!1})},[n,a]),f=In(function(h,v){n().type!=="IDLE"&&Xr(!1);var g=setTimeout(u,int);a({type:"PENDING",point:v,actions:h,longPressTimerId:g}),d()},[d,n,a,u]);Nc(function(){return s(),function(){r.current();var v=n();v.type==="PENDING"&&(clearTimeout(v.longPressTimerId),a(bE))}},[n,s,a]),Nc(function(){var h=ld(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return h},[])}var unt={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function Uae(e,t){if(t==null)return!1;var r=!!unt[t.tagName.toLowerCase()];if(r)return!0;var n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:Uae(e,t.parentElement)}function fnt(e,t){var r=t.target;return A5(r)?Uae(e,r):!1}var mnt=function(e){return Wd(e.getBoundingClientRect()).center};function hnt(e){return e instanceof $ae(e).Element}var pnt=function(){var e="matches";if(typeof document>"u")return e;var t=[e,"msMatchesSelector","webkitMatchesSelector"],r=Ih(t,function(n){return n in Element.prototype});return r||e}();function Vae(e,t){return e==null?null:e[pnt](t)?e:Vae(e.parentElement,t)}function gnt(e,t){return e.closest?e.closest(t):Vae(e,t)}function vnt(e){return"["+Hx.contextId+'="'+e+'"]'}function xnt(e,t){var r=t.target;if(!hnt(r))return null;var n=vnt(e),a=gnt(r,n);return!a||!A5(a)?null:a}function ynt(e,t){var r=xnt(e,t);return r?r.getAttribute(Hx.draggableId):null}function bnt(e,t){var r="["+S4.contextId+'="'+e+'"]',n=iae(document.querySelectorAll(r)),a=Ih(n,function(i){return i.getAttribute(S4.id)===t});return!a||!A5(a)?null:a}function wnt(e){e.preventDefault()}function J2(e){var t=e.expected,r=e.phase,n=e.isLockActive;return e.shouldWarn,!(!n()||t!==r)}function Wae(e){var t=e.lockAPI,r=e.store,n=e.registry,a=e.draggableId;if(t.isClaimed())return!1;var i=n.draggable.findById(a);return!(!i||!i.options.isEnabled||!Dae(r.getState(),a))}function jnt(e){var t=e.lockAPI,r=e.contextId,n=e.store,a=e.registry,i=e.draggableId,s=e.forceSensorStop,l=e.sourceEvent,c=Wae({lockAPI:t,store:n,registry:a,draggableId:i});if(!c)return null;var d=a.draggable.getById(i),u=bnt(r,d.descriptor.id);if(!u||l&&!d.options.canDragInteractiveElements&&fnt(u,l))return null;var f=t.claim(s||oh),m="PRE_DRAG";function h(){return d.options.shouldRespectForcePress}function v(){return t.isActive(f)}function g(S,k){J2({expected:S,phase:m,isLockActive:v,shouldWarn:!0})&&n.dispatch(k())}var x=g.bind(null,"DRAGGING");function y(S){function k(){t.release(),m="COMPLETED"}m!=="PRE_DRAG"&&(k(),m!=="PRE_DRAG"&&Xr(!1)),n.dispatch(ptt(S.liftActionArgs)),m="DRAGGING";function E(A,M){if(M===void 0&&(M={shouldBlockNextClick:!1}),S.cleanup(),M.shouldBlockNextClick){var C=ld(window,[{eventName:"click",fn:wnt,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(C)}k(),n.dispatch(Pae({reason:A}))}return qn({isActive:function(){return J2({expected:"DRAGGING",phase:m,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:h,drop:function(M){return E("DROP",M)},cancel:function(M){return E("CANCEL",M)}},S.actions)}function b(S){var k=O1(function(A){x(function(){return Cae({client:A})})}),E=y({liftActionArgs:{id:i,clientSelection:S,movementMode:"FLUID"},cleanup:function(){return k.cancel()},actions:{move:k}});return qn({},E,{move:k})}function w(){var S={moveUp:function(){return x(_tt)},moveRight:function(){return x(Ctt)},moveDown:function(){return x(Stt)},moveLeft:function(){return x(Ptt)}};return y({liftActionArgs:{id:i,clientSelection:mnt(u),movementMode:"SNAP"},cleanup:oh,actions:S})}function j(){var S=J2({expected:"PRE_DRAG",phase:m,isLockActive:v,shouldWarn:!0});S&&t.release()}var _={isActive:function(){return J2({expected:"PRE_DRAG",phase:m,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:h,fluidLift:b,snapLift:w,abort:j};return _}var Nnt=[tnt,ont,dnt];function _nt(e){var t=e.contextId,r=e.store,n=e.registry,a=e.customSensors,i=e.enableDefaultSensors,s=[].concat(i?Nnt:[],a||[]),l=p.useState(function(){return qrt()})[0],c=In(function(b,w){b.isDragging&&!w.isDragging&&l.tryAbandon()},[l]);Nc(function(){var b=r.getState(),w=r.subscribe(function(){var j=r.getState();c(b,j),b=j});return w},[l,r,c]),Nc(function(){return l.tryAbandon},[l.tryAbandon]);for(var d=In(function(y){return Wae({lockAPI:l,registry:n,store:r,draggableId:y})},[l,n,r]),u=In(function(y,b,w){return jnt({lockAPI:l,registry:n,contextId:t,store:r,draggableId:y,forceSensorStop:b,sourceEvent:w&&w.sourceEvent?w.sourceEvent:null})},[t,l,n,r]),f=In(function(y){return ynt(t,y)},[t]),m=In(function(y){var b=n.draggable.findById(y);return b?b.options:null},[n.draggable]),h=In(function(){l.isClaimed()&&(l.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(QM()))},[l,r]),v=In(l.isClaimed,[l]),g=za(function(){return{canGetLock:d,tryGetLock:u,findClosestDraggableId:f,findOptionsForDraggable:m,tryReleaseLock:h,isLockClaimed:v}},[d,u,f,m,h,v]),x=0;x<s.length;x++)s[x](g)}var Snt=function(t){return{onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}};function iy(e){return e.current||Xr(!1),e.current}function Cnt(e){var t=e.contextId,r=e.setCallbacks,n=e.sensors,a=e.nonce,i=e.dragHandleUsageInstructions,s=p.useRef(null),l=Fae(e),c=In(function(){return Snt(l.current)},[l]),d=Rrt(t),u=Brt({contextId:t,text:i}),f=Ert(t,a),m=In(function(A){iy(s).dispatch(A)},[]),h=za(function(){return P9({publishWhileDragging:vtt,updateDroppableScroll:ytt,updateDroppableIsEnabled:btt,updateDroppableIsCombineEnabled:wtt,collectionStarting:xtt},m)},[m]),v=Irt(),g=za(function(){return srt(v,h)},[v,h]),x=za(function(){return _rt(qn({scrollWindow:lrt,scrollDroppable:g.scrollDroppable},P9({move:Cae},m)))},[g.scrollDroppable,m]),y=Ort(t),b=za(function(){return nrt({announce:d,autoScroller:x,dimensionMarshal:g,focusMarshal:y,getResponders:c,styleMarshal:f})},[d,x,g,y,c,f]);s.current=b;var w=In(function(){var A=iy(s),M=A.getState();M.phase!=="IDLE"&&A.dispatch(QM())},[]),j=In(function(){var A=iy(s).getState();return A.isDragging||A.phase==="DROP_ANIMATING"},[]),_=za(function(){return{isDragging:j,tryAbort:w}},[j,w]);r(_);var S=In(function(A){return Dae(iy(s).getState(),A)},[]),k=In(function(){return ap(iy(s).getState())},[]),E=za(function(){return{marshal:g,focus:y,contextId:t,canLift:S,isMovementAllowed:k,dragHandleUsageInstructionsId:u,registry:v}},[t,g,u,y,S,k,v]);return _nt({contextId:t,store:b,registry:v,customSensors:n,enableDefaultSensors:e.enableDefaultSensors!==!1}),p.useEffect(function(){return w},[w]),xe.createElement(E5.Provider,{value:E},xe.createElement(GQe,{context:iR,store:b},e.children))}var Pnt=0;function Ant(){return za(function(){return""+Pnt++},[])}function Ent(e){var t=Ant(),r=e.dragHandleUsageInstructions||Dj.dragHandleUsageInstructions;return xe.createElement(net,null,function(n){return xe.createElement(Cnt,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)})}var Hae=function(t){return function(r){return t===r}},knt=Hae("scroll"),Ont=Hae("auto"),oU=function(t,r){return r(t.overflowX)||r(t.overflowY)},Tnt=function(t){var r=window.getComputedStyle(t),n={overflowX:r.overflowX,overflowY:r.overflowY};return oU(n,knt)||oU(n,Ont)},Int=function(){return!1},Dnt=function e(t){return t==null?null:t===document.body?Int()?t:null:t===document.documentElement?null:Tnt(t)?t:e(t.parentElement)},C4=function(e){return{x:e.scrollLeft,y:e.scrollTop}},Mnt=function e(t){if(!t)return!1;var r=window.getComputedStyle(t);return r.position==="fixed"?!0:e(t.parentElement)},Rnt=function(e){var t=Dnt(e),r=Mnt(e);return{closestScrollable:t,isFixedOnPage:r}},Lnt=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,a=e.isFixedOnPage,i=e.direction,s=e.client,l=e.page,c=e.closest,d=function(){if(!c)return null;var h=c.scrollSize,v=c.client,g=Oae({scrollHeight:h.scrollHeight,scrollWidth:h.scrollWidth,height:v.paddingBox.height,width:v.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:v,scrollSize:h,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:g,diff:{value:is,displacement:is}}}}(),u=i==="vertical"?GM:uae,f=Vx({page:l,withPlaceholder:null,axis:u,frame:d}),m={descriptor:t,isCombineEnabled:n,isFixedOnPage:a,axis:u,isEnabled:r,client:s,page:l,frame:d,subject:f};return m},$nt=function(t,r){var n=tae(t);if(!r||t!==r)return n;var a=n.paddingBox.top-r.scrollTop,i=n.paddingBox.left-r.scrollLeft,s=a+r.scrollHeight,l=i+r.scrollWidth,c={top:a,right:l,bottom:s,left:i},d=zM(c,n.border),u=UM({borderBox:d,margin:n.margin,border:n.border,padding:n.padding});return u},Fnt=function(e){var t=e.ref,r=e.descriptor,n=e.env,a=e.windowScroll,i=e.direction,s=e.isDropDisabled,l=e.isCombineEnabled,c=e.shouldClipSubject,d=n.closestScrollable,u=$nt(t,d),f=X_(u,a),m=function(){if(!d)return null;var v=tae(d),g={scrollHeight:d.scrollHeight,scrollWidth:d.scrollWidth};return{client:v,page:X_(v,a),scroll:C4(d),scrollSize:g,shouldClipSubject:c}}(),h=Lnt({descriptor:r,isEnabled:!s,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:i,client:u,page:f,closest:m});return h},Bnt={passive:!1},qnt={passive:!0},iU=function(e){return e.shouldPublishImmediately?Bnt:qnt};function rS(e){var t=p.useContext(e);return t||Xr(!1),t}var Q2=function(t){return t&&t.env.closestScrollable||null};function znt(e){var t=p.useRef(null),r=rS(E5),n=sR("droppable"),a=r.registry,i=r.marshal,s=Fae(e),l=za(function(){return{id:e.droppableId,type:e.type,mode:e.mode}},[e.droppableId,e.mode,e.type]),c=p.useRef(l),d=za(function(){return os(function(j,_){t.current||Xr(!1);var S={x:j,y:_};i.updateDroppableScroll(l.id,S)})},[l.id,i]),u=In(function(){var j=t.current;return!j||!j.env.closestScrollable?is:C4(j.env.closestScrollable)},[]),f=In(function(){var j=u();d(j.x,j.y)},[u,d]),m=za(function(){return O1(f)},[f]),h=In(function(){var j=t.current,_=Q2(j);j&&_||Xr(!1);var S=j.scrollOptions;if(S.shouldPublishImmediately){f();return}m()},[m,f]),v=In(function(j,_){t.current&&Xr(!1);var S=s.current,k=S.getDroppableRef();k||Xr(!1);var E=Rnt(k),A={ref:k,descriptor:l,env:E,scrollOptions:_};t.current=A;var M=Fnt({ref:k,descriptor:l,env:E,windowScroll:j,direction:S.direction,isDropDisabled:S.isDropDisabled,isCombineEnabled:S.isCombineEnabled,shouldClipSubject:!S.ignoreContainerClipping}),C=E.closestScrollable;return C&&(C.setAttribute(tU.contextId,r.contextId),C.addEventListener("scroll",h,iU(A.scrollOptions))),M},[r.contextId,l,h,s]),g=In(function(){var j=t.current,_=Q2(j);return j&&_||Xr(!1),C4(_)},[]),x=In(function(){var j=t.current;j||Xr(!1);var _=Q2(j);t.current=null,_&&(m.cancel(),_.removeAttribute(tU.contextId),_.removeEventListener("scroll",h,iU(j.scrollOptions)))},[h,m]),y=In(function(j){var _=t.current;_||Xr(!1);var S=Q2(_);S||Xr(!1),S.scrollTop+=j.y,S.scrollLeft+=j.x},[]),b=za(function(){return{getDimensionAndWatchScroll:v,getScrollWhileDragging:g,dragStopped:x,scroll:y}},[x,v,g,y]),w=za(function(){return{uniqueId:n,descriptor:l,callbacks:b}},[b,l,n]);Nc(function(){return c.current=w.descriptor,a.droppable.register(w),function(){t.current&&x(),a.droppable.unregister(w)}},[b,l,x,w,i,a.droppable]),Nc(function(){t.current&&i.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,i]),Nc(function(){t.current&&i.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,i])}function wE(){}var sU={width:0,height:0,margin:det},Unt=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate;return r||a==="close"?sU:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},Vnt=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate,i=Unt({isAnimatingOpenOnMount:r,placeholder:n,animate:a});return{display:n.display,boxSizing:"border-box",width:i.width,height:i.height,marginTop:i.margin.top,marginRight:i.margin.right,marginBottom:i.margin.bottom,marginLeft:i.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:a!=="none"?ob.placeholder:null}};function Wnt(e){var t=p.useRef(null),r=In(function(){t.current&&(clearTimeout(t.current),t.current=null)},[]),n=e.animate,a=e.onTransitionEnd,i=e.onClose,s=e.contextId,l=p.useState(e.animate==="open"),c=l[0],d=l[1];p.useEffect(function(){return c?n!=="open"?(r(),d(!1),wE):t.current?wE:(t.current=setTimeout(function(){t.current=null,d(!1)}),r):wE},[n,c,r]);var u=In(function(m){m.propertyName==="height"&&(a(),n==="close"&&i())},[n,i,a]),f=Vnt({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return xe.createElement(e.placeholder.tagName,{style:f,"data-rbd-placeholder-context-id":s,onTransitionEnd:u,ref:e.innerRef})}var Hnt=xe.memo(Wnt),cR=xe.createContext(null),Gnt=function(e){eQ(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=e.call.apply(e,[this].concat(i))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}t.getDerivedStateFromProps=function(a,i){return a.shouldAnimate?a.on?{isVisible:!0,data:a.on,animate:"open"}:i.isVisible?{isVisible:!0,data:i.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!a.on,data:a.on,animate:"none"}};var r=t.prototype;return r.render=function(){if(!this.state.isVisible)return null;var a={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(a)},t}(xe.PureComponent),lU={dragging:5e3,dropAnimating:4500},Knt=function(t,r){return r?ob.drop(r.duration):t?ob.snap:ob.fluid},Ynt=function(t,r){return t?r?M1.opacity.drop:M1.opacity.combining:null},Xnt=function(t){return t.forceShouldAnimate!=null?t.forceShouldAnimate:t.mode==="SNAP"};function Jnt(e){var t=e.dimension,r=t.client,n=e.offset,a=e.combineWith,i=e.dropping,s=!!a,l=Xnt(e),c=!!i,d=c?N4.drop(n,s):N4.moveTo(n),u={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:Knt(l,i),transform:d,opacity:Ynt(s,c),zIndex:c?lU.dropAnimating:lU.dragging,pointerEvents:"none"};return u}function Qnt(e){return{transform:N4.moveTo(e.offset),transition:e.shouldAnimateDisplacement?null:"none"}}function Znt(e){return e.type==="DRAGGING"?Jnt(e):Qnt(e)}function eat(e,t,r){r===void 0&&(r=is);var n=window.getComputedStyle(t),a=t.getBoundingClientRect(),i=eae(a,n),s=X_(i,r),l={client:i,tagName:t.tagName.toLowerCase(),display:n.display},c={x:i.marginBox.width,y:i.marginBox.height},d={descriptor:e,placeholder:l,displaceBy:c,client:i,page:s};return d}function tat(e){var t=sR("draggable"),r=e.descriptor,n=e.registry,a=e.getDraggableRef,i=e.canDragInteractiveElements,s=e.shouldRespectForcePress,l=e.isEnabled,c=za(function(){return{canDragInteractiveElements:i,shouldRespectForcePress:s,isEnabled:l}},[i,l,s]),d=In(function(h){var v=a();return v||Xr(!1),eat(r,v,h)},[r,a]),u=za(function(){return{uniqueId:t,descriptor:r,options:c,getDimension:d}},[r,d,c,t]),f=p.useRef(u),m=p.useRef(!0);Nc(function(){return n.draggable.register(f.current),function(){return n.draggable.unregister(f.current)}},[n.draggable]),Nc(function(){if(m.current){m.current=!1;return}var h=f.current;f.current=u,n.draggable.update(u,h)},[u,n.draggable])}function rat(e){e.preventDefault()}function nat(e){var t=p.useRef(null),r=In(function(A){t.current=A},[]),n=In(function(){return t.current},[]),a=rS(E5),i=a.contextId,s=a.dragHandleUsageInstructionsId,l=a.registry,c=rS(cR),d=c.type,u=c.droppableId,f=za(function(){return{id:e.draggableId,index:e.index,type:d,droppableId:u}},[e.draggableId,e.index,d,u]),m=e.children,h=e.draggableId,v=e.isEnabled,g=e.shouldRespectForcePress,x=e.canDragInteractiveElements,y=e.isClone,b=e.mapped,w=e.dropAnimationFinished;if(!y){var j=za(function(){return{descriptor:f,registry:l,getDraggableRef:n,canDragInteractiveElements:x,shouldRespectForcePress:g,isEnabled:v}},[f,l,n,x,g,v]);tat(j)}var _=za(function(){return v?{tabIndex:0,role:"button","aria-describedby":s,"data-rbd-drag-handle-draggable-id":h,"data-rbd-drag-handle-context-id":i,draggable:!1,onDragStart:rat}:null},[i,s,h,v]),S=In(function(A){b.type==="DRAGGING"&&b.dropping&&A.propertyName==="transform"&&w()},[w,b]),k=za(function(){var A=Znt(b),M=b.type==="DRAGGING"&&b.dropping?S:null,C={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":i,"data-rbd-draggable-id":h,style:A,onTransitionEnd:M},dragHandleProps:_};return C},[i,_,h,b,S,r]),E=za(function(){return{draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}},[f.droppableId,f.id,f.index,f.type]);return m(k,b.snapshot,E)}var Gae=function(e,t){return e===t},Kae=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null},aat=function(t){return t.combine?t.combine.draggableId:null},oat=function(t){return t.at&&t.at.type==="COMBINE"?t.at.combine.draggableId:null};function iat(){var e=os(function(a,i){return{x:a,y:i}}),t=os(function(a,i,s,l,c){return{isDragging:!0,isClone:i,isDropAnimating:!!c,dropAnimation:c,mode:a,draggingOver:s,combineWith:l,combineTargetFor:null}}),r=os(function(a,i,s,l,c,d,u){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:d,mode:i,offset:a,dimension:s,forceShouldAnimate:u,snapshot:t(i,l,c,d,null)}}}),n=function(i,s){if(i.isDragging){if(i.critical.draggable.id!==s.draggableId)return null;var l=i.current.client.offset,c=i.dimensions.draggables[s.draggableId],d=jc(i.impact),u=oat(i.impact),f=i.forceShouldAnimate;return r(e(l.x,l.y),i.movementMode,c,s.isClone,d,u,f)}if(i.phase==="DROP_ANIMATING"){var m=i.completed;if(m.result.draggableId!==s.draggableId)return null;var h=s.isClone,v=i.dimensions.draggables[s.draggableId],g=m.result,x=g.mode,y=Kae(g),b=aat(g),w=i.dropDuration,j={duration:w,curve:eR.drop,moveTo:i.newHomeClientOffset,opacity:b?M1.opacity.drop:null,scale:b?M1.scale.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:v,dropping:j,draggingOver:y,combineWith:b,mode:x,forceShouldAnimate:null,snapshot:t(x,h,y,b,j)}}}return null};return n}function Yae(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var sat={mapped:{type:"SECONDARY",offset:is,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:Yae(null)}};function lat(){var e=os(function(s,l){return{x:s,y:l}}),t=os(Yae),r=os(function(s,l,c){return l===void 0&&(l=null),{mapped:{type:"SECONDARY",offset:s,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:t(l)}}}),n=function(l){return l?r(is,l,!0):null},a=function(l,c,d,u){var f=d.displaced.visible[l],m=!!(u.inVirtualList&&u.effected[l]),h=S5(d),v=h&&h.draggableId===l?c:null;if(!f){if(!m)return n(v);if(d.displaced.invisible[l])return null;var g=N0(u.displacedBy.point),x=e(g.x,g.y);return r(x,v,!0)}if(m)return n(v);var y=d.displacedBy.point,b=e(y.x,y.y);return r(b,v,f.shouldAnimate)},i=function(l,c){if(l.isDragging)return l.critical.draggable.id===c.draggableId?null:a(c.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){var d=l.completed;return d.result.draggableId===c.draggableId?null:a(c.draggableId,d.result.draggableId,d.impact,d.afterCritical)}return null};return i}var cat=function(){var t=iat(),r=lat(),n=function(i,s){return t(i,s)||r(i,s)||sat};return n},dat={dropAnimationFinished:Aae},uat=Qne(cat,dat,null,{context:iR,pure:!0,areStatePropsEqual:Gae})(nat);function Xae(e){var t=rS(cR),r=t.isUsingCloneFor;return r===e.draggableId&&!e.isClone?null:xe.createElement(uat,e)}function fat(e){var t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return xe.createElement(Xae,qn({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function mat(e){var t=p.useContext(E5);t||Xr(!1);var r=t.contextId,n=t.isMovementAllowed,a=p.useRef(null),i=p.useRef(null),s=e.children,l=e.droppableId,c=e.type,d=e.mode,u=e.direction,f=e.ignoreContainerClipping,m=e.isDropDisabled,h=e.isCombineEnabled,v=e.snapshot,g=e.useClone,x=e.updateViewportMaxScroll,y=e.getContainerForClone,b=In(function(){return a.current},[]),w=In(function(C){a.current=C},[]);In(function(){return i.current},[]);var j=In(function(C){i.current=C},[]),_=In(function(){n()&&x({maxScroll:Iae()})},[n,x]);znt({droppableId:l,type:c,mode:d,direction:u,isDropDisabled:m,isCombineEnabled:h,ignoreContainerClipping:f,getDroppableRef:b});var S=xe.createElement(Gnt,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},function(C){var T=C.onClose,I=C.data,D=C.animate;return xe.createElement(Hnt,{placeholder:I,onClose:T,innerRef:j,animate:D,contextId:r,onTransitionEnd:_})}),k=za(function(){return{innerRef:w,placeholder:S,droppableProps:{"data-rbd-droppable-id":l,"data-rbd-droppable-context-id":r}}},[r,l,S,w]),E=g?g.dragging.draggableId:null,A=za(function(){return{droppableId:l,type:c,isUsingCloneFor:E}},[l,E,c]);function M(){if(!g)return null;var C=g.dragging,T=g.render,I=xe.createElement(Xae,{draggableId:C.draggableId,index:C.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(D,F){return T(D,F,C)});return GW.createPortal(I,y())}return xe.createElement(cR.Provider,{value:A},s(k,v),M())}var jE=function(t,r){return t===r.droppable.type},cU=function(t,r){return r.draggables[t.draggable.id]},hat=function(){var t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=qn({},t,{shouldAnimatePlaceholder:!1}),n=os(function(s){return{draggableId:s.id,type:s.type,source:{index:s.index,droppableId:s.droppableId}}}),a=os(function(s,l,c,d,u,f){var m=u.descriptor.id,h=u.descriptor.droppableId===s;if(h){var v=f?{render:f,dragging:n(u.descriptor)}:null,g={isDraggingOver:c,draggingOverWith:c?m:null,draggingFromThisWith:m,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!1,snapshot:g,useClone:v}}if(!l)return r;if(!d)return t;var x={isDraggingOver:c,draggingOverWith:m,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!0,snapshot:x,useClone:null}}),i=function(l,c){var d=c.droppableId,u=c.type,f=!c.isDropDisabled,m=c.renderClone;if(l.isDragging){var h=l.critical;if(!jE(u,h))return r;var v=cU(h,l.dimensions),g=jc(l.impact)===d;return a(d,f,g,g,v,m)}if(l.phase==="DROP_ANIMATING"){var x=l.completed;if(!jE(u,x.critical))return r;var y=cU(x.critical,l.dimensions);return a(d,f,Kae(x.result)===d,jc(x.impact)===d,y,m)}if(l.phase==="IDLE"&&l.completed&&!l.shouldFlush){var b=l.completed;if(!jE(u,b.critical))return r;var w=jc(b.impact)===d,j=!!(b.impact.at&&b.impact.at.type==="COMBINE"),_=b.critical.droppable.id===d;return w?j?t:r:_?t:r}return r};return i},pat={updateViewportMaxScroll:Ntt};function gat(){return document.body||Xr(!1),document.body}var vat={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:gat},Jae=Qne(hat,pat,null,{context:iR,pure:!0,areStatePropsEqual:Gae})(mat);Jae.defaultProps=vat;function Jg({className:e,...t}){return o.jsx("div",{className:Jt("animate-pulse rounded-md bg-muted/20",e),...t})}function O5(e){return{id:e.id,code:e.codigo_produto??"",name:e.nome,category:e.categoria??"",type:e.tipo_produto==="uso_interno"?"Uso Interno":"Venda",cost:Number(e.valor_custo??e.preco_custo??0),price:Number(e.valor_venda??e.preco_venda??0),stock:Number(e.estoque??e.estoque_atual??0),minStock:Number(e.estoque_minimo??0),status:e.status??(e.ativo===!1||Number(e.estoque??0)===0?"inactive":Number(e.estoque??0)>0&&Number(e.estoque??0)<=Number(e.estoque_minimo??0)?"low_stock":"active"),validade:e.validade?new Date(e.validade):null,barcode:e.codigo_barras??"",barcodeBox:e.codigo_barras_caixa??"",reference:e.referencia??"",brand:e.marca??"",group:e.grupo??"",unit:e.unidade??"UN",initialStock:Number(e.estoque_inicial??0),currentStock:Number(e.estoque_atual??e.estoque??0),weight:e.peso!=null?Number(e.peso):null,buyPrice:e.preco_compra!=null?Number(e.preco_compra):null,costsPercent:e.custos_percent!=null?Number(e.custos_percent):null,costPrice:e.preco_custo!=null?Number(e.preco_custo):null,marginPercent:e.lucro_percent!=null?Number(e.lucro_percent):null,salePrice:e.preco_venda!=null?Number(e.preco_venda):null,wholesaleQty:e.qtd_atacado!=null?Number(e.qtd_atacado):null,wholesalePrice:e.preco_atacado!=null?Number(e.preco_atacado):null,commissionPercent:e.comissao_percent!=null?Number(e.comissao_percent):null,discountPercent:e.desconto_percent!=null?Number(e.desconto_percent):null,cfopInterno:e.cfop_interno??"",cstIcmsInterno:e.cst_icms_interno??"",csosnInterno:e.csosn_interno??"",aliqIcmsInterno:e.aliquota_icms_interno!=null?Number(e.aliquota_icms_interno):null,cfopExterno:e.cfop_externo??"",cstIcmsExterno:e.cst_icms_externo??"",csosnExterno:e.csosn_externo??"",aliqIcmsExterno:e.aliquota_icms_externo!=null?Number(e.aliquota_icms_externo):null,cstPisEntrada:e.cst_pis_entrada??"",cstPisSaida:e.cst_pis_saida??"",aliqPisPercent:e.aliquota_pis_percent!=null?Number(e.aliquota_pis_percent):null,aliqCofinsPercent:e.aliquota_cofins_percent!=null?Number(e.aliquota_cofins_percent):null,cstIpi:e.cst_ipi??"",aliqIpiPercent:e.aliquota_ipi_percent!=null?Number(e.aliquota_ipi_percent):null,fcpPercent:e.fcp_percent!=null?Number(e.fcp_percent):null,mvaPercent:e.mva_percent!=null?Number(e.mva_percent):null,baseReduzidaPercent:e.base_reduzida_percent!=null?Number(e.base_reduzida_percent):null,ncm:e.ncm??"",ncmDescription:e.descricao_ncm??"",cest:e.cest??"",active:e.ativo??!0,allowSale:e.permite_venda??!0,payCommission:e.paga_comissao??!1,variablePrice:e.preco_variavel??!1,composition:e.composicao??!1,service:e.servico??!1,hasGrid:e.grade??!1,usePriceTable:e.usar_tabela_preco??!1,fuel:e.combustivel??!1,useImei:e.usa_imei??!1,stockByGrid:e.controle_estoque_por_grade??!1,showInApp:e.mostrar_no_app??!1,dataImportacao:e.data_importacao?new Date(e.data_importacao):null,importadoViaXml:e.importado_via_xml??!1}}async function xat({from:e,to:t,codigoEmpresa:r,limit:n=1e3}={}){if(!e||!t)throw new Error("Perodo invlido");const a=(e instanceof Date?e:new Date(e)).toISOString(),i=(t instanceof Date?t:new Date(t)).toISOString(),{data:s,error:l}=await Ei(v=>{let g=pe.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",a).lte("created_at",i).limit(n).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},2e4,"Timeout getSoldProductsByPeriod (20s)");if(l)throw l;const c=new Map;for(const v of s||[]){const g=v.produto_id,x=Number(v.quantidade||0);c.set(g,(c.get(g)||0)+x)}const d=Array.from(c.entries()).sort((v,g)=>g[1]-v[1]);if(d.length===0)return[];const u=d.map(([v])=>v),{data:f,error:m}=await Ei(v=>{let g=pe.from("produtos").select("id, nome").in("id",u).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},15e3,"Timeout getSoldProductsByPeriod:produtos (15s)");if(m)throw m;const h=new Map((f||[]).map(v=>[v.id,v.nome]));return d.map(([v,g])=>({id:v,name:h.get(v)||String(v),total:g}))}async function Xv({productId:e,delta:t,codigoEmpresa:r}){const n=Number(t);if(!e||!Number.isFinite(n)||n===0)throw new Error("Parmetros invlidos para ajuste de estoque");const{data:a,error:i}=await Ei(d=>{let u=pe.from("produtos").select("id, estoque, estoque_atual").eq("id",e).single().abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout get current stock (10s)");if(i)throw i;const l=Number(a?.estoque??a?.estoque_atual??0)+n,{error:c}=await Ei(d=>{let u=pe.from("produtos").update({estoque:l,estoque_atual:l}).eq("id",e).abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout update stock (10s)");if(c)throw c;return{id:e,stock:l}}async function yat({limit:e=5,codigoEmpresa:t}={}){const r=new Date;r.setHours(0,0,0,0);const n=r.toISOString(),{data:a,error:i}=await Ei(m=>{let h=pe.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",n).abortSignal(m);return t&&(h=h.eq("codigo_empresa",t)),h},15e3,"Timeout getMostSoldProductsToday (15s)");if(i)throw i;const s=new Map;for(const m of a||[]){const h=m.produto_id,v=Number(m.quantidade||0);s.set(h,(s.get(h)||0)+v)}const l=Array.from(s.entries()).sort((m,h)=>h[1]-m[1]).slice(0,e);if(l.length===0)return[];const c=l.map(([m])=>m),{data:d,error:u}=await Ei(m=>{let h=pe.from("produtos").select("id, nome").in("id",c).abortSignal(m);return t&&(h=h.eq("codigo_empresa",t)),h},15e3,"Timeout getMostSoldProductsToday:produtos (15s)");if(u)throw u;const f=new Map((d||[]).map(m=>[m.id,m.nome]));return l.map(([m,h])=>({id:m,name:f.get(m)||String(m),total:h}))}async function dU({codigoEmpresa:e}={}){if(!e)throw new Error("codigoEmpresa  obrigatrio");const{data:t,error:r}=await Ei(l=>pe.from("produtos").select("codigo_produto").eq("codigo_empresa",e).order("codigo_produto",{ascending:!0}).abortSignal(l),15e3,"Timeout getNextProductCode (15s)");if(r)throw r;const n=new Set;for(const l of t||[]){const c=(l.codigo_produto||"").trim();if(/^\d+$/.test(c)){const d=parseInt(c,10);Number.isFinite(d)&&d>0&&n.add(d)}}let a=1;const i=(n.size||0)+1e3;let s=0;for(;n.has(a)&&s<i;)a+=1,s+=1;return(!Number.isFinite(a)||a<=0)&&(a=1),String(a).padStart(4,"0")}function Qae(e){return{codigo_produto:e.code||null,nome:e.name,categoria:e.category||null,tipo_produto:e.type==="Uso Interno"?"uso_interno":"venda",valor_custo:e.cost!=null?Number(e.cost):0,valor_venda:e.price!=null?Number(e.price):0,estoque:e.stock!=null?Number(e.stock):0,estoque_minimo:e.minStock!=null?Number(e.minStock):0,status:e.status||null,validade:e.validade?new Date(e.validade).toISOString().slice(0,10):null,codigo_barras:e.barcode||null,codigo_barras_caixa:e.barcodeBox||null,referencia:e.reference||null,marca:e.brand||null,grupo:e.group||null,unidade:e.unit||null,estoque_inicial:e.initialStock!=null?Number(e.initialStock):null,estoque_atual:e.currentStock!=null?Number(e.currentStock):null,peso:e.weight!=null?Number(e.weight):null,preco_compra:e.buyPrice!=null?Number(e.buyPrice):null,custos_percent:e.costsPercent!=null?Number(e.costsPercent):null,preco_custo:e.costPrice!=null?Number(e.costPrice):null,lucro_percent:e.marginPercent!=null?Number(e.marginPercent):null,preco_venda:e.salePrice!=null?Number(e.salePrice):null,qtd_atacado:e.wholesaleQty!=null?Number(e.wholesaleQty):null,preco_atacado:e.wholesalePrice!=null?Number(e.wholesalePrice):null,comissao_percent:e.commissionPercent!=null?Number(e.commissionPercent):null,desconto_percent:e.discountPercent!=null?Number(e.discountPercent):null,cfop_interno:e.cfopInterno||null,cst_icms_interno:e.cstIcmsInterno||null,csosn_interno:e.csosnInterno||null,aliquota_icms_interno:e.aliqIcmsInterno!=null?Number(e.aliqIcmsInterno):null,cfop_externo:e.cfopExterno||null,cst_icms_externo:e.cstIcmsExterno||null,csosn_externo:e.csosnExterno||null,aliquota_icms_externo:e.aliqIcmsExterno!=null?Number(e.aliqIcmsExterno):null,cst_pis_entrada:e.cstPisEntrada||null,cst_pis_saida:e.cstPisSaida||null,aliquota_pis_percent:e.aliqPisPercent!=null?Number(e.aliqPisPercent):null,aliquota_cofins_percent:e.aliqCofinsPercent!=null?Number(e.aliqCofinsPercent):null,cst_ipi:e.cstIpi||null,aliquota_ipi_percent:e.aliqIpiPercent!=null?Number(e.aliqIpiPercent):null,fcp_percent:e.fcpPercent!=null?Number(e.fcpPercent):null,mva_percent:e.mvaPercent!=null?Number(e.mvaPercent):null,base_reduzida_percent:e.baseReduzidaPercent!=null?Number(e.baseReduzidaPercent):null,ncm:e.ncm||null,descricao_ncm:e.ncmDescription||null,cest:e.cest||null,ativo:e.active!=null?!!e.active:!0,permite_venda:e.allowSale!=null?!!e.allowSale:!0,paga_comissao:e.payCommission!=null?!!e.payCommission:!1,preco_variavel:e.variablePrice!=null?!!e.variablePrice:!1,composicao:e.composition!=null?!!e.composition:!1,servico:e.service!=null?!!e.service:!1,grade:e.hasGrid!=null?!!e.hasGrid:!1,usar_tabela_preco:e.usePriceTable!=null?!!e.usePriceTable:!1,combustivel:e.fuel!=null?!!e.fuel:!1,usa_imei:e.useImei!=null?!!e.useImei:!1,controle_estoque_por_grade:e.stockByGrid!=null?!!e.stockByGrid:!1,mostrar_no_app:e.showInApp!=null?!!e.showInApp:!1,importado_via_xml:e.importedViaXML===!0,data_importacao:e.dataImportacao?e.dataImportacao instanceof Date?e.dataImportacao.toISOString():new Date(e.dataImportacao).toISOString():null,xml_chave:e.xmlChave||null,xml_numero:e.xmlNumero||null,xml_serie:e.xmlSerie||null,xml_emissao:e.xmlEmissao?new Date(e.xmlEmissao).toISOString():null}}async function Uu(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n}=e;console.log("[products.api] ====== listProducts INICIO ======"),console.log("[products.api] Parametros:",{includeInactive:t,search:r,codigoEmpresa:n});const{data:a,error:i}=await Ei(c=>{let d=pe.from("produtos").select("*").eq("codigo_empresa",n).order("nome",{ascending:!0}).abortSignal(c);if(t||(d=d.neq("status","inactive"),d=d.or("ativo.is.null,ativo.eq.true"),console.log("[products.api] Filtro aplicado: status != inactive AND (ativo IS NULL OR ativo = true)")),r&&r.trim().length>0){const u=r.trim();d=d.or(`nome.ilike.%${u}%,codigo_produto.ilike.%${u}%`)}return d},15e3,"Timeout listProducts (15s)");if(i)throw console.error("[products.api] listProducts:error",i),i;const s=(a||[]).map(O5);console.log("[products.api] listProducts RETORNOU:",s.length,"produtos"),console.log("[products.api] includeInactive:",t),console.log("[products.api] Produtos:",s.map(c=>({id:c.id,name:c.name,code:c.code})));const l=s.filter(c=>!c.code||c.code.trim()==="");return console.log("[products.api] Produtos SEM cdigo:",l.length),l.length>0&&l.forEach(c=>{console.log("  -",c.name,"| active:",c.active,"| status:",c.status,"| code:",c.code||"NULL")}),s}async function bat(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n,page:a=1,pageSize:i=100}=e;if(!n)return{data:[],count:0};const s=a>0?a:1,l=i>0?i:100,c=(s-1)*l,d=c+l-1;console.log("[products.api] ====== listProductsPaged INICIO ======",{includeInactive:t,search:r,codigoEmpresa:n,page:s,pageSize:l});try{const{data:u,error:f,count:m}=await Ei(v=>{let g=pe.from("produtos").select("*",{count:"exact"}).eq("codigo_empresa",n).order("nome",{ascending:!0}).range(c,d).abortSignal(v);if(t||(g=g.neq("status","inactive"),g=g.or("ativo.is.null,ativo.eq.true")),r&&r.trim().length>0){const x=r.trim();g=g.or(`nome.ilike.%${x}%,codigo_produto.ilike.%${x}%`)}return g},2e4,"Timeout listProductsPaged (20s)");if(f)throw console.error("[products.api] listProductsPaged:error",f),f;const h=(u||[]).map(O5);return console.log("[products.api] listProductsPaged RETORNOU:",h.length,"produtos de",m||0),{data:h,count:m||0}}catch(u){return console.error("[products.api] listProductsPaged:exception",u),{data:[],count:0}}}async function nS(e,t={}){const{codigoEmpresa:r}=t,n=Qae(e);r&&(n.codigo_empresa=r),console.info("[products.api] createProduct: payload",n);const a=async()=>Ei(d=>pe.from("produtos").insert(n).select("*").single().abortSignal(d),15e3,"Timeout createProduct (15s)"),i=d=>{if(!d)return!1;if(d.code&&String(d.code)==="23505")return!0;const u=[d.message,d.details,d.hint].filter(Boolean).join(" ").toLowerCase();return u.includes("duplicate key")||u.includes("unique constraint")||u.includes("ux_produtos_empresa_codigo_produto")||u.includes("codigo_produto")};let s,l;if({data:s,error:l}=await a(),l&&i(l)&&n.codigo_produto){console.warn("[products.api] createProduct: duplicate code, trying to free code from inactive product");const{data:d,error:u}=await Ei(m=>pe.from("produtos").select("id,status").eq("codigo_produto",n.codigo_produto).eq("status","inactive").limit(1).abortSignal(m),15e3,"Timeout find duplicate product (15s)"),f=Array.isArray(d)&&d.length>0?d[0]:null;if(!u&&f&&f.status==="inactive"){const{error:m}=await Ei(h=>pe.from("produtos").update({codigo_produto:null}).eq("id",f.id).abortSignal(h),15e3,"Timeout clear duplicate code (15s)");m||({data:s,error:l}=await a())}else{const m=n.codigo_produto;n.codigo_produto=null,console.warn("[products.api] createProduct: no inactive found for duplicate code, retrying with codigo_produto = null (original:",m,")"),{data:s,error:l}=await a()}}if(l)throw console.error("[products.api] createProduct:error",l),l;const c=O5(s);return console.info("[products.api] createProduct: ok",c),c}async function T5(e,t,r={}){const n=Qae(t);n.data_importacao=null,console.info("[products.api] updateProduct: id",e,"payload",n);const{data:a,error:i}=await Ei(l=>pe.from("produtos").update(n).eq("id",e).select("*").single().abortSignal(l),15e3,"Timeout updateProduct (15s)");if(i)throw console.error("[products.api] updateProduct:error",i),i;const s=O5(a);return console.info("[products.api] updateProduct: ok",s),s}async function Ei(e,t,r){const n=new AbortController,a=setTimeout(()=>n.abort(new Error(r)),t);try{return await e(n.signal)}catch(i){throw i?.name==="AbortError"?new Error(r):i}finally{clearTimeout(a)}}async function dR(e){console.info("[products.api] deleteProduct (soft): id",e);const{error:t}=await Ei(r=>pe.from("produtos").update({status:"inactive",codigo_produto:null}).eq("id",e).abortSignal(r),15e3,"Timeout deleteProduct (15s)");if(t)throw console.error("[products.api] deleteProduct:error",t),t;return console.info("[products.api] deleteProduct: ok (inativado)"),!0}async function wat({ids:e,status:t}){const r=Array.isArray(e)?e.filter(Boolean):[];if(!r.length)throw new Error("Nenhum produto selecionado para atualizao em massa");if(!["active","inactive","low_stock"].includes(t))throw new Error("Status invlido para atualizao em massa");const n=t!=="inactive";console.info("[products.api] bulkUpdateProductStatus:start",{count:r.length,status:t});const{error:a}=await Ei(i=>pe.from("produtos").update({status:t,ativo:n}).in("id",r).abortSignal(i),2e4,"Timeout bulkUpdateProductStatus (20s)");if(a)throw console.error("[products.api] bulkUpdateProductStatus:error",a),a;return console.info("[products.api] bulkUpdateProductStatus:ok",{count:r.length,status:t}),!0}async function jat({ids:e}){const t=Array.isArray(e)?e.filter(Boolean):[];if(!t.length)throw new Error("Nenhum produto selecionado para limpar flag de novo");console.info("[products.api] bulkClearNewFlag:start",{count:t.length});const{error:r}=await Ei(n=>pe.from("produtos").update({data_importacao:null}).in("id",t).abortSignal(n),2e4,"Timeout bulkClearNewFlag (20s)");if(r)throw console.error("[products.api] bulkClearNewFlag:error",r),r;return console.info("[products.api] bulkClearNewFlag:ok",{count:t.length}),!0}async function uU(){console.info("[products.api] listCategories: start");const{data:e,error:t}=await Ei(n=>pe.from("produto_categorias").select("nome").eq("ativa",!0).order("nome",{ascending:!0}).abortSignal(n),15e3,"Timeout listCategories (15s)");if(t)throw console.error("[products.api] listCategories:error",t),t;const r=(e||[]).map(n=>n.nome).filter(Boolean);return console.info("[products.api] listCategories: ok",{count:r.length}),r}async function Nat(e){const t=String(e||"").trim();if(!t)throw new Error("Nome da categoria invlido");console.info("[products.api] createCategory:",t);const{data:r,error:n}=await Ei(a=>pe.from("produto_categorias").insert({nome:t}).select("nome").single().abortSignal(a),15e3,"Timeout createCategory (15s)");if(n)throw console.error("[products.api] createCategory:error",n),n;return r?.nome||t}async function _at(e){const t=String(e||"").trim();if(!t)throw new Error("Nome da categoria invlido");console.info("[products.api] removeCategory:",t);const{count:r,error:n}=await Ei(l=>pe.from("produtos").select("id",{count:"exact",head:!0}).eq("categoria",t).neq("status","inactive").abortSignal(l),15e3,"Timeout removeCategory:count (15s)");if(n)throw console.error("[products.api] removeCategory:count:error",n),n;if((r??0)>0){const l=new Error("Categoria possui produtos ativos vinculados");throw console.warn("[products.api] removeCategory: blocked by active products",{nome:t,prodCount:r}),l}const{data:a,error:i}=await Ei(l=>pe.from("produto_categorias").update({ativa:!1}).eq("nome",t).select("nome").abortSignal(l),15e3,"Timeout removeCategory (15s)");if(i)throw console.error("[products.api] removeCategory:error",i),i;if((Array.isArray(a)?a.length:0)===0){const l=new Error("Categoria no encontrada para desativar");throw console.warn("[products.api] removeCategory: no rows affected",{nome:t}),l}return!0}function Sat({item:e,onApply:t,onClose:r,codigoEmpresa:n}){const{toast:a}=ro(),[i,s]=p.useState(e?.desconto_tipo||"percentual"),[l,c]=p.useState(e?.desconto_valor||0),[d,u]=p.useState(e?.desconto_motivo||""),[f,m]=p.useState(!1);if(!e)return null;const h=Number(e.price||e.preco_unitario||0),v=Number(e.quantity||e.quantidade||1),g=h*v,x=i==="percentual"?g*(1-l/100):g-l,y=async()=>{try{if(m(!0),l<0){a({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(i==="percentual"&&l>100){a({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}console.log("Aplicando desconto:",{itemId:e.id,desconto_tipo:i,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});const w=await EGe({itemId:e.id,desconto_tipo:i,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});console.log("Resultado:",w),a({title:"Sucesso",description:"Desconto aplicado!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao aplicar desconto:",w),a({title:"Erro",description:w.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{m(!1)}},b=async()=>{try{m(!0),await OGe({itemId:e.id,codigoEmpresa:n}),a({title:"Sucesso",description:"Desconto removido!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao remover desconto:",w),a({title:"Erro",description:w.message||"Falha ao remover desconto",variant:"destructive"})}finally{m(!1)}};return o.jsx(ln,{open:!0,onOpenChange:r,children:o.jsxs(sn,{overlayClassName:"z-[90]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[91]",children:[o.jsx(an,{children:o.jsxs(nn,{className:"text-lg font-bold",children:["Desconto - ",e.name]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ht,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(le,{variant:i==="percentual"?"default":"outline",onClick:()=>s("percentual"),disabled:f,className:"flex-1",children:"Percentual (%)"}),o.jsx(le,{variant:i==="fixo"?"default":"outline",onClick:()=>s("fixo"),disabled:f,className:"flex-1",children:"Fixo (R$)"})]})]}),o.jsxs("div",{children:[o.jsxs(Ht,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",i==="percentual"?"(%)":"(R$)"]}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(ir,{id:"desconto-valor",type:"text",value:i==="percentual"?l===0?"":l:l===0?"":`R$ ${l.toFixed(2)}`,onChange:w=>{let j=w.target.value.trim();if(j===""){c(0);return}i==="fixo"&&(j=j.replace(/[^\d.,]/g,"").replace(",","."));let _=Number(j);isNaN(_)&&(_=0),i==="percentual"&&_>100&&(_=100),_<0&&(_=0),c(_)},placeholder:i==="percentual"?"0":"0,00",disabled:f,className:"mt-1"}),i==="percentual"&&o.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),o.jsxs("select",{id:"desconto-motivo",value:d,onChange:w=>u(w.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:f,children:[o.jsx("option",{value:"",children:"Selecione um motivo..."}),o.jsx("option",{value:"Promoo",children:"Promoo"}),o.jsx("option",{value:"Meia entrada",children:"Meia entrada"}),o.jsx("option",{value:"Cortesia",children:"Cortesia"}),o.jsx("option",{value:"Ajuste",children:"Ajuste"}),o.jsx("option",{value:"Outro",children:"Outro"})]})]}),o.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Preo Original:"}),o.jsxs("span",{className:"font-semibold",children:["R$ ",g.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[o.jsx("span",{children:"Desconto:"}),o.jsxs("span",{children:["-R$ ",(g-x).toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[o.jsx("span",{children:"Total do Item:"}),o.jsxs("span",{className:"text-brand",children:["R$ ",Math.max(0,x).toFixed(2)]})]})]}),d&&o.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[o.jsx("strong",{children:"Motivo:"})," ",d]})]}),o.jsxs(Un,{className:"flex gap-2",children:[o.jsx(le,{variant:"outline",onClick:r,disabled:f,children:"Cancelar"}),e.desconto_valor>0&&o.jsxs(le,{variant:"destructive",onClick:b,disabled:f,size:"sm",className:"gap-2",children:[o.jsx(Gm,{className:"w-4 h-4"}),"Remover"]}),o.jsx(le,{onClick:y,disabled:f,className:"gap-2",children:f?"Aplicando...":"Aplicar Desconto"})]})]})})}function Cat({comanda:e,subtotal:t,onApply:r,onClose:n,codigoEmpresa:a}){const{toast:i}=ro(),[s,l]=p.useState(e?.desconto_tipo||"percentual"),[c,d]=p.useState(e?.desconto_valor||0),[u,f]=p.useState(e?.desconto_motivo||""),[m,h]=p.useState(!1);if(!e)return null;const v=s==="percentual"?t*c/100:c,g=Math.max(0,t-v),x=async()=>{try{if(h(!0),c<0){i({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(s==="percentual"&&c>100){i({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}if(v>t){i({title:"Erro",description:"Desconto no pode ser maior que o subtotal",variant:"destructive"});return}console.log("Aplicando desconto comanda:",{comandaId:e.id,desconto_tipo:s,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:a});const b=await kGe({comandaId:e.id,desconto_tipo:s,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:a});console.log("Resultado comanda:",b),i({title:"Sucesso",description:"Desconto aplicado na comanda!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao aplicar desconto:",b),i({title:"Erro",description:b.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{h(!1)}},y=async()=>{try{h(!0),await TGe({comandaId:e.id,codigoEmpresa:a}),i({title:"Sucesso",description:"Desconto removido!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao remover desconto:",b),i({title:"Erro",description:b.message||"Falha ao remover desconto",variant:"destructive"})}finally{h(!1)}};return o.jsx(ln,{open:!0,onOpenChange:n,children:o.jsxs(sn,{className:"sm:max-w-[420px]",children:[o.jsx(an,{children:o.jsx(nn,{className:"text-lg font-bold",children:"Desconto da Comanda"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ht,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(le,{variant:s==="percentual"?"default":"outline",onClick:()=>l("percentual"),disabled:m,className:"flex-1",children:"Percentual (%)"}),o.jsx(le,{variant:s==="fixo"?"default":"outline",onClick:()=>l("fixo"),disabled:m,className:"flex-1",children:"Fixo (R$)"})]})]}),o.jsxs("div",{children:[o.jsxs(Ht,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",s==="percentual"?"(%)":"(R$)"]}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(ir,{id:"desconto-valor",type:"text",name:"desconto-valor",autoComplete:"off",autoCorrect:"off",spellCheck:!1,value:s==="percentual"?c===0?"":c:c===0?"":`R$ ${c.toFixed(2)}`,onChange:b=>{let w=b.target.value.trim();if(w===""){d(0);return}s==="fixo"&&(w=w.replace(/[^\d.,]/g,"").replace(",","."));let j=Number(w);isNaN(j)&&(j=0),s==="percentual"&&j>100&&(j=100),j<0&&(j=0),d(j)},placeholder:s==="percentual"?"0":"0,00",disabled:m,className:"mt-1"}),s==="percentual"&&o.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),o.jsxs("select",{id:"desconto-motivo",value:u,onChange:b=>f(b.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:m,children:[o.jsx("option",{value:"",children:"Selecione um motivo..."}),o.jsx("option",{value:"Promoo",children:"Promoo"}),o.jsx("option",{value:"Cortesia",children:"Cortesia"}),o.jsx("option",{value:"Ajuste",children:"Ajuste"}),o.jsx("option",{value:"Outro",children:"Outro"})]})]}),o.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Subtotal:"}),o.jsxs("span",{className:"font-semibold",children:["R$ ",t.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[o.jsx("span",{children:"Desconto:"}),o.jsxs("span",{children:["-R$ ",v.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[o.jsx("span",{children:"Total da Comanda:"}),o.jsxs("span",{className:"text-brand",children:["R$ ",g.toFixed(2)]})]})]}),u&&o.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[o.jsx("strong",{children:"Motivo:"})," ",u]})]}),o.jsxs(Un,{className:"flex gap-2",children:[o.jsx(le,{variant:"outline",onClick:n,disabled:m,children:"Cancelar"}),e.desconto_valor>0&&o.jsxs(le,{variant:"destructive",onClick:y,disabled:m,size:"sm",className:"gap-2",children:[o.jsx(Gm,{className:"w-4 h-4"}),"Remover"]}),o.jsx(le,{onClick:x,disabled:m,className:"gap-2",children:m?"Aplicando...":"Aplicar Desconto"})]})]})})}const Pat={available:{label:"Livre",color:"border-success/50 bg-success/10 text-success",icon:Pi},"in-use":{label:"Em Uso",color:"border-warning/50 bg-warning/10 text-warning",icon:dd},"awaiting-payment":{label:"Pagamento",color:"border-info/50 bg-info/10 text-info",icon:rs}};function Aat(){const{toast:e}=ro(),{userProfile:t,authReady:r}=Do(),n=Fl(),[a,i]=p.useState([]),[s,l]=p.useState(null),[c,d]=p.useState(!1),[u,f]=p.useState(0);p.useRef(!1);const[m,h]=p.useState(!1);p.useState([]);const[v,g]=p.useState(!1),[x,y]=p.useState(new Map),[b,w]=p.useState(!1);p.useRef(null),p.useRef(null);const j=p.useRef([]),_=p.useRef(null),[S,k]=p.useState(0),[E,A]=p.useState("tables");p.useRef(null);const[M,C]=p.useState("order");p.useRef(null),p.useRef(null),p.useState(!1);const[T,I]=p.useState(null),[D,F]=p.useState(null),[z,q]=p.useState(!1),[$,K]=p.useState(!1),[ce,fe]=p.useState(!1),[B,L]=p.useState(null),[V,re]=p.useState(!1),[me,G]=p.useState([]),[Q,ae]=p.useState(!1),[J,je]=p.useState(!1),[be,Ue]=p.useState(!1),[Z,Y]=p.useState(!1),[lt,gt]=p.useState(null),[Te,at]=p.useState(""),[yt,vt]=p.useState(!1),[Sr,se]=p.useState(!1),[Ze,ct]=p.useState([]),[Qt,we]=p.useState(null),[ye,te]=p.useState(null),[$e,Pe]=p.useState(!1),It=p.useRef(""),[Dt,kt]=p.useState(!1),[cr,Cr]=p.useState(!1),[Ie,ke]=p.useState("order"),[Je,mt]=p.useState(!1),[Be,$t]=p.useState(""),[Ee,Ct]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}}),[hr,Mr]=p.useState(null),[qr,Or]=p.useState(null),[Mt,Ir]=p.useState(!1),Ar=p.useMemo(()=>{const de=new Map,Le=s?.order||[];for(const jt of Le)de.set(jt.productId,(de.get(jt.productId)||0)+Number(jt.quantity||0));return de},[s?.order]),Zt=async de=>{try{const jt=(s?.order||[]).find(ne=>String(ne.productId)===String(de.id));if(!jt)return;const Rt=Number(jt.quantity||0)-1;Rt>0?await Wc({itemId:jt.id,quantidade:Rt,codigoEmpresa:t?.codigo_empresa}):await Av({itemId:jt.id,codigoEmpresa:t?.codigo_empresa});const dr=(await Si({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(ne=>({id:ne.id,productId:ne.produto_id,name:ne.descricao||"Item",price:Number(ne.preco_unitario||0),quantity:Number(ne.quantidade||1)})),er=(dr||[]).reduce((ne,ie)=>ne+Number(ie.price||0)*Number(ie.quantity||0),0),_r={...s,order:dr,totalHint:er};l(_r),i(ne=>ne.map(ie=>ie.id===_r.id?_r:ie));try{const ne=await Gv({codigoEmpresa:t?.codigo_empresa}),ie=new Map;for(const Ye of ne||[]){const ze=Ye.produto_id,Ke=Number(Ye.quantidade||0);ie.set(ze,(ie.get(ze)||0)+Ke)}y(ie)}catch(ne){console.error("[decProduct] Erro ao atualizar estoque reservado:",ne)}}catch(Le){console.error("[decProduct] Erro:",Le),e({title:"Falha ao alterar quantidade",description:Le?.message||"Tente novamente",variant:"destructive"})}},Kr=p.useRef(null),Tr=p.useCallback(()=>{try{const de=Kr.current;if(!de)return 1;const jt=window.getComputedStyle(de).gridTemplateColumns||"";if(jt){const Ot=jt.split(" ").filter(Boolean).length;if(Ot>0)return Ot}const Rt=de.querySelector("[data-table-id]");if(Rt){const Ot=Rt.getBoundingClientRect().width,dr=de.getBoundingClientRect().width;if(Ot>0)return Math.max(1,Math.floor(dr/Ot))}return 1}catch{return 1}},[]),[dn,Ae]=p.useState(!1);ki();const pt=p.useMemo(()=>(a||[]).find(de=>de.status==="available")?.id||null,[a]),Br=J||Z||$||v||yt||$e||m||z||cr||!1,Pr=async de=>{try{if(!de)return;if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}if(Sr)return;if(se(!0),l(Le=>!Le||Le.id!==de.id?de:Le),de.status==="available"||!de.comandaId){gt(de),Y(!0);return}try{await jr(de)}catch{try{const Rt=(await Si({comandaId:de.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(er=>({id:er.id,productId:er.produto_id,name:er.descricao||"Item",price:Number(er.preco_unitario||0),quantity:Number(er.quantidade||1)}));let Ot=null;try{const _r=(await Qi({comandaId:de.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(ne=>ne?.nome).filter(Boolean);Ot=_r.length?_r.join(", "):null}catch{}const dr={...de,order:Rt,customer:Ot};l(dr),i(er=>er.map(_r=>_r.id===dr.id?dr:_r))}catch{}}}finally{se(!1)}};p.useEffect(()=>{const de=()=>{try{Ct(typeof window<"u"&&window.innerWidth<=640)}catch{Ct(!1)}};return de(),window.addEventListener("resize",de),()=>window.removeEventListener("resize",de)},[]),p.useEffect(()=>{const de=async Le=>{try{if(b)return;const jt=String(Le.target?.tagName||"").toLowerCase();if(["input","textarea","select"].includes(jt)||Le.target?.isContentEditable||Br)return;if(Le.key==="F1"){Le.preventDefault();try{const Ot=(a||[]).filter(dr=>dr.status==="available");Ot.length>0?(l(Ot[0]),gt?.(Ot[0])):!s&&Array.isArray(a)&&a.length>0&&(l(a[0]),gt?.(a[0]))}catch{}Y(!0);return}if(Le.key==="F2"){Le.preventDefault(),s?.comandaId?await gr():e({title:"Nenhuma comanda selecionada",description:"Selecione uma mesa com comanda aberta antes de fechar.",variant:"warning"});return}if(Le.key==="F10"){Le.preventDefault(),c?e({title:"Caixa j est aberto",description:"Use F11 para ver detalhes do caixa.",variant:"info"}):Pe(!0);return}if(Le.key==="F11"){Le.preventDefault(),g(!0);return}if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(Le.key)){if(E!=="tables"||!s||!Array.isArray(a)||a.length===0)return;Le.preventDefault(),Le.stopPropagation();let Ot=Math.max(0,a.findIndex(ie=>ie.id===s?.id));Ot<0&&(Ot=0);let dr=Tr(),er=Ot;Le.key==="ArrowRight"&&(er=Ot+1),Le.key==="ArrowLeft"&&(er=Ot-1),Le.key==="ArrowDown"&&(er=Ot+dr),Le.key==="ArrowUp"&&(er=Ot-dr);const _r=a.length;er=(er%_r+_r)%_r;const ne=a[er];ne&&ne.id!==s?.id&&(l(ne),setTimeout(()=>{try{document.querySelector(`[data-table-id="${ne.id}"]`)?.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}catch{}},0));return}if(Le.key==="Enter"){if(E!=="tables")return;Le.preventDefault(),Le.stopPropagation(),s&&!Sr&&await Pr(s);return}if(Le.key==="Escape"){if(Le.preventDefault(),s&&(M==="products"||Ie==="products")){C("order"),ke("order");return}if(s){l(null);return}return}if(Le.key==="p"||Le.key==="P"){if(Le.preventDefault(),m){setTimeout(()=>{try{_.current?.focus()}catch{}},0);return}if(s){w(!0);return}h(!0),setTimeout(()=>{try{_.current?.focus()}catch{}},50);return}}catch{}};return window.addEventListener("keydown",de),()=>window.removeEventListener("keydown",de)},[Br,s?.id,a,Tr,b]),p.useEffect(()=>{try{s?.id&&t?.codigo_empresa&&localStorage.setItem(`vendas:selected:${t.codigo_empresa}`,String(s.id))}catch{}},[s?.id,t?.codigo_empresa]),p.useEffect(()=>{(async()=>{try{if(!s&&t?.codigo_empresa&&Array.isArray(a)&&a.length>0){const Le=localStorage.getItem(`vendas:selected:${t.codigo_empresa}`);if(Le){const jt=a.find(Rt=>String(Rt.id)===String(Le));if(jt)if(A("tables"),jt.comandaId)try{await jr(jt),A("tables")}catch(Rt){console.error("[Restore Selection] Erro ao carregar detalhes:",Rt),localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}else localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}}}catch(Le){console.error("[Restore Selection] Erro:",Le)}})()},[a,s,t?.codigo_empresa]);const Ur=p.useCallback(async()=>{try{const de=await Dm({codigoEmpresa:t?.codigo_empresa});d(!!(de&&(de.id||de?.length)))}catch{d(!1)}},[t?.codigo_empresa]),Zr=async()=>{const de=t?.codigo_empresa||null;try{if(!de)return;const[Le,jt]=await Promise.all([w1({codigoEmpresa:de}).catch(()=>null),Dm({codigoEmpresa:de}).catch(()=>null)]);if(!jt?.id){I(null);return}let Rt=0,Ot=[];try{Ot=await Ip({caixaSessaoId:jt.id,codigoEmpresa:de}),Rt=(Ot||[]).filter(er=>(er?.tipo||"")==="sangria").reduce((er,_r)=>er+Number(_r?.valor||0),0)}catch{}const dr={saldo_inicial:jt.saldo_inicial||0,totalPorFinalizadora:Le?.totalPorFinalizadora||Le?.porFinalizadora||{},totalEntradas:Le?.totalEntradas||Le?.entradas||0,totalSangria:Rt,totalSaidas:Rt,sessaoId:jt.id,movimentacoes:Ot};xe.startTransition(()=>{I(dr)})}catch{xe.startTransition(()=>{I(null)})}finally{}},cn=p.useRef(!1);p.useEffect(()=>{v&&!cn.current?(cn.current=!0,Zr().catch(()=>{})):v||(cn.current=!1)},[v]);const Tn=de=>de==="in_use"?"in-use":de==="awaiting_payment"?"awaiting-payment":"available",Qn=p.useRef(!0);p.useEffect(()=>(Qn.current=!0,()=>{Qn.current=!1}),[]);const Sa=p.useRef(0),ht=p.useRef(0),Vt=p.useRef(0);p.useEffect(()=>{const de=t?.codigo_empresa||null,Le=de?`vendas:tables:${de}`:null,jt=()=>{try{if(!Le)return;const Ot=JSON.parse(localStorage.getItem(Le)||"[]");Array.isArray(Ot)&&Ot.length>0&&i(Ot)}catch{}};de&&jt();const Rt=async()=>{try{if(!r||!de)return;const Ot=++Vt.current,dr=setTimeout(()=>{Qn.current&&jt()},2e3),er=setTimeout(()=>{Qn.current&&Vt.current===Ot&&jt()},1e4),[_r,ne]=await Promise.all([bp(de),Gv({codigoEmpresa:de}).catch(()=>[])]);if(Qn.current&&Vt.current===Ot){const Qe=new Map;for(const qt of ne||[]){const O=qt.produto_id,H=Number(qt.quantidade||0);Qe.set(O,(Qe.get(O)||0)+H)}y(Qe)}let ie=[];try{ie=await sc({codigoEmpresa:de})}catch(Qe){console.error("[VendasPage:load] Erro ao carregar comandas abertas:",Qe)}const Ye=await(async()=>{try{return await Z3((ie||[]).map(Qe=>Qe.id),de)}catch{return{}}})(),ze=await(async()=>{try{const Qe=await Promise.all((ie||[]).map(async qt=>{try{const H=(await Qi({comandaId:qt.id,codigoEmpresa:de})||[]).map(_e=>_e?.nome).filter(Boolean);return[qt.id,H.length?H.join(", "):null]}catch{return[qt.id,null]}}));return Object.fromEntries(Qe)}catch{return{}}})(),Ke=new Map;(ie||[]).forEach(Qe=>Ke.set(Qe.mesa_id,Qe));const oe=(_r||[]).map(Qe=>{const qt=Ke.get(Qe.id);let O=Tn(Qe.status),H=null,_e=null,Oe=0,ve=null;return qt&&(O=qt.status==="awaiting-payment"||qt.status==="awaiting_payment"?"awaiting-payment":"in-use",H=qt.id,_e=ze[qt.id]||null,Oe=Ye[qt.id]||0,ve=qt.aberto_em||null),{id:Qe.id,number:Qe.numero,name:Qe.nome||null,status:O,order:[],customer:_e,comandaId:H,totalHint:Oe,aberto_em:ve}}).map(Qe=>s&&Qe.id===s.id?{...Qe,order:s.order||[],customer:s.customer||Qe.customer}:Qe);if(!Qn.current||Vt.current!==Ot){clearTimeout(dr),clearTimeout(er);return}if(i(oe),(oe||[]).length===0)try{Le&&localStorage.removeItem(Le)}catch{}else try{Le&&localStorage.setItem(Le,JSON.stringify(oe))}catch{}const st=de?`vendas:selected:${de}`:null;if(st)try{const Qe=localStorage.getItem(st);if(Qe){const qt=oe.find(O=>String(O.id)===String(Qe));qt&&!qt.comandaId&&localStorage.removeItem(st)}}catch{}ht.current=Array.isArray(oe)?oe.length:0,Sa.current=Date.now();let Ve=null;try{const Qe=de?`vendas:selected:${de}`:null,qt=Qe?localStorage.getItem(Qe):null;if(qt){const O=oe.find(H=>String(H.id)===String(qt));O&&(Ve=O)}}catch{}Ve?yt||l(Qe=>!Qe||Qe.id!==Ve.id?Ve:{...Ve,order:Qe.order||Ve.order||[],customer:Qe.customer||Ve.customer||null,observacoes:Qe.observacoes??Ve.observacoes??null,desconto_tipo:Qe.desconto_tipo??Ve.desconto_tipo??null,desconto_valor:Qe.desconto_valor??Ve.desconto_valor??0,desconto_motivo:Qe.desconto_motivo??Ve.desconto_motivo??null}):yt||l(Qe=>{const qt=Qe?oe.find(H=>H.id===Qe.id):null;return qt?{...qt,order:Qe.order||qt.order||[],customer:Qe.customer||qt.customer||null,observacoes:Qe.observacoes??qt.observacoes??null,desconto_tipo:Qe.desconto_tipo??qt.desconto_tipo??null,desconto_valor:Qe.desconto_valor??qt.desconto_valor??0,desconto_motivo:Qe.desconto_motivo??qt.desconto_motivo??null}:oe[0]||null});try{const Qe=await Uu({includeInactive:!1,codigoEmpresa:de});G(Qe||[])}catch(Qe){console.warn("Falha ao carregar produtos:",Qe?.message||Qe)}clearTimeout(dr),clearTimeout(er)}catch(Ot){console.error("Erro ao carregar mesas:",Ot)}};return jt(),r&&de&&Rt(),()=>{}},[r,t?.codigo_empresa,Br]),p.useEffect(()=>{!r||!t?.codigo_empresa||Ur()},[r,t?.codigo_empresa,Ur]),p.useEffect(()=>{let de=!0;return(async()=>{try{if(!t?.codigo_empresa){de&&f(0);return}const Le=await sc({codigoEmpresa:t?.codigo_empresa});if(!de)return;f(Array.isArray(Le)?Le.length:0)}catch{de&&f(0)}})(),()=>{de=!1}},[t?.codigo_empresa,a.length]),p.useEffect(()=>{const de=t?.codigo_empresa||null,Le=de?`vendas:selected:${de}`:null;try{Le&&s?.id&&localStorage.setItem(Le,String(s.id))}catch{}s?.comandaId&&(!s.order||s.order.length===0)&&jr(s)},[s?.id,s?.comandaId]),p.useEffect(()=>()=>{},[s?.comandaId,Br,ce]);const gr=async()=>{try{if(!s?.comandaId){e({title:"Selecione uma mesa com comanda aberta",variant:"warning"});return}await hf({codigoEmpresa:t?.codigo_empresa});try{const Rt=(await Si({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(dr=>({id:dr.id,productId:dr.produto_id,name:dr.descricao||"Item",price:Number(dr.preco_unitario||0),quantity:Number(dr.quantidade||1),desconto_tipo:dr.desconto_tipo||null,desconto_valor:Number(dr.desconto_valor||0),desconto_motivo:dr.desconto_motivo||null})),Ot={...s,order:Rt};l(Ot),i(dr=>dr.map(er=>er.id===Ot.id?Ot:er))}catch{}const de=await Hv({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});ct(de||[]);const Le=de&&de[0]&&de[0].id?de[0].id:null;we(Le),te(Le),vt(!0)}catch(de){e({title:"Falha ao carregar finalizadoras",description:de?.message||"Tente novamente",variant:"destructive"})}},Lt=de=>{if(!de.destination)return;const Le=Array.from(a),[jt]=Le.splice(de.source.index,1);Le.splice(de.destination.index,0,jt),i(Le),e({title:"Layout das mesas atualizado!",description:"As posies foram salvas temporariamente.",variant:"success"})},Pt=(de,Le)=>{let jt=0;for(const Ot of de||[]){let dr=(Ot.price||0)*(Ot.quantity||1);Ot.desconto_tipo==="percentual"&&Ot.desconto_valor>0?dr*=1-Ot.desconto_valor/100:Ot.desconto_tipo==="fixo"&&Ot.desconto_valor>0&&(dr-=Ot.desconto_valor),jt+=Math.max(0,dr)}let Rt=jt;return Le?.desconto_tipo==="percentual"&&Le?.desconto_valor>0?Rt*=1-Le.desconto_valor/100:Le?.desconto_tipo==="fixo"&&Le?.desconto_valor>0&&(Rt-=Le.desconto_valor),Math.max(0,Rt)},Yr=de=>{if(!de)return"";const Le=de.trim().split(/\s+/);return Le.length<=2?de:Le.slice(0,2).join(" ")},Ft=de=>{if(!de)return"";const Le=Rt=>String(Rt).replace(/^\s*[\[]+\s*/g,"").replace(/\s*[\]]+\s*$/g,"").trim(),jt=de.split(",").map(Rt=>Le(Rt)).filter(Boolean);return jt.length===0?"":jt.length===1?Yr(jt[0]):`${Yr(jt[0])} +${jt.length-1}`},jr=async de=>{try{if(!de?.comandaId)return;const jt=(await Si({comandaId:de.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(er=>({id:er.id,productId:er.produto_id,name:er.descricao||"Item",price:Number(er.preco_unitario||0),quantity:Number(er.quantidade||1),desconto_tipo:er.desconto_tipo||null,desconto_valor:Number(er.desconto_valor||0),desconto_motivo:er.desconto_motivo||null}));let Rt=de.customer||null;try{const _r=(await Qi({comandaId:de.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(ne=>ne?.nome).filter(Boolean);Rt=_r.length?_r.join(", "):null}catch{}let Ot=de;try{const _r=(await sc({codigoEmpresa:t?.codigo_empresa}))?.find(ne=>ne.id===de.comandaId);_r&&(Ot={...de,desconto_tipo:_r.desconto_tipo||null,desconto_valor:Number(_r.desconto_valor||0),desconto_motivo:_r.desconto_motivo||null,observacoes:_r.observacoes||null})}catch{}const dr={...Ot,status:de.status==="awaiting-payment"?"awaiting-payment":"in-use",order:jt,customer:Rt};l(dr),i(er=>er.map(_r=>_r.id===dr.id?dr:_r))}catch(Le){console.warn("[VendasPage] Falha ao recarregar detalhes da mesa selecionada:",Le)}},ot=async({showToast:de=!1}={})=>{try{const Le=t?.codigo_empresa;if(!Le)return;const jt=await bp(Le);let Rt=[];try{Rt=await sc({codigoEmpresa:Le})}catch(ie){console.error("[refreshTablesLight] Erro ao carregar comandas:",ie)}const Ot=new Map((Rt||[]).map(ie=>[ie.mesa_id,ie])),dr={},er={};try{const ie=(Rt||[]).map(Ke=>Ke.id);(await Promise.all(ie.map(async Ke=>{try{return{id:Ke,vinculos:await Qi({comandaId:Ke,codigoEmpresa:Le})}}catch{return{id:Ke,vinculos:[]}}}))).forEach(({id:Ke,vinculos:rt})=>{const oe=(rt||[]).map(st=>st?.nome).filter(Boolean);dr[Ke]=oe.length?oe.join(", "):null}),(await Promise.all(ie.map(async Ke=>{try{const oe=(await Si({comandaId:Ke,codigoEmpresa:Le})||[]).reduce((st,Ve)=>{const Qe=(Ve.quantidade||0)*(Ve.preco_unitario||0)-(Ve.desconto||0);return st+Qe},0);return{comandaId:Ke,total:oe}}catch(rt){return console.error(`[refreshTablesLight] Erro ao buscar itens da comanda ${Ke}:`,rt),{comandaId:Ke,total:0}}}))).forEach(({comandaId:Ke,total:rt})=>{er[Ke]=rt})}catch(ie){console.error("[refreshTablesLight] Erro ao carregar clientes/totais:",ie)}const ne=(jt||[]).map(ie=>{const Ye=Ot.get(ie.id);let ze=Tn(ie.status),Ke=null,rt=null,oe=0;return Ye&&(ze=Ye.status==="awaiting-payment"||Ye.status==="awaiting_payment"?"awaiting-payment":"in-use",Ke=Ye.id,rt=dr[Ye.id]||null,oe=er[Ye.id]||0),{id:ie.id,number:ie.numero,name:ie.nome||null,status:ze,order:[],customer:rt,comandaId:Ke,totalHint:oe}}).map(ie=>s&&ie.id===s.id?ie.comandaId?{...ie,order:s.order||[],customer:s.customer||ie.customer}:{...ie,order:[],customer:null}:ie);if(i(ne),s){const ie=ne.find(Ye=>Ye.id===s.id);ie&&!ie.comandaId&&l({...ie,order:[],customer:null})}}catch(Le){console.error("[refreshTablesLight] Erro fatal:",Le),de&&e({title:"Erro ao atualizar mesas",description:"Recarregue a pgina se o problema persistir",variant:"destructive"})}},Kt=({table:de,provided:Le,isDragging:jt})=>{const Rt=Pat[de.status],Ot=Rt.icon,dr=Array.isArray(de.order)?de.order:[],er=dr.filter(Ke=>String(Ke.id||"").startsWith("tmp-")).reduce((Ke,rt)=>Ke+Number(rt.quantity||0)*Number(rt.price||0),0),_r=dr.filter(Ke=>!String(Ke.id||"").startsWith("tmp-")).reduce((Ke,rt)=>Ke+Number(rt.quantity||0)*Number(rt.price||0),0),ne=Number(de.totalHint||0);Ft(de.customer);const ie=de.status==="available"&&de.id===pt,Ye=de.status==="in-use"||de.status==="awaiting-payment"?(ne>0?ne:_r)+er:0,ze=de.status==="available"?"text-success bg-success/10 border-success/30":de.status==="in-use"?"text-warning bg-warning/10 border-warning/30":"text-info bg-info/10 border-info/30";return o.jsxs("div",{ref:Le?.innerRef,"data-table-id":de.id,...Le?.draggableProps||{},className:Jt("p-4 rounded-lg border bg-surface flex flex-col relative h-44 shadow-sm min-w-[240px]",jt&&"shadow-lg",E==="tables"&&s?.id===de.id&&"ring-2 ring-brand/60 bg-surface-2",c?"cursor-pointer":"cursor-not-allowed opacity-60"),onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}Pr(de)},children:[o.jsx("div",{...Le?.dragHandleProps||{},className:"absolute top-2 right-2 text-text-muted opacity-60 hover:opacity-100",children:o.jsx(rue,{size:14})}),o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(Ot,{className:"w-5 h-5 text-text-secondary"}),o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("span",{className:"text-lg font-semibold text-text-primary truncate",children:de.name?de.name:`Mesa ${de.number}`}),ie&&o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]}),o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(de.status==="in-use"||de.status==="awaiting-payment")&&de.aberto_em&&o.jsxs("div",{className:"flex items-center gap-0.5 text-xs text-text-secondary",children:[o.jsx(dd,{className:"w-3.5 h-3.5 text-text-muted"}),o.jsx("span",{className:"font-medium",children:(()=>{try{const Ke=new Date(de.aberto_em),oe=new Date-Ke,st=Math.floor(oe/6e4),Ve=Math.floor(st/60),Qe=st%60;return st<1?"agora":Ve===0?`${Qe}m`:Ve>0&&Qe===0?`${Ve}h`:`${Ve}h${Qe}m`}catch{return""}})()})]}),o.jsx("span",{className:Jt("text-[11px] font-medium px-2 py-0.5 rounded-full border flex-shrink-0",ze),children:Rt.label})]})]}),o.jsx("div",{className:Jt("flex-1 flex items-center justify-center"),children:de.status==="available"?o.jsx("img",{src:"/mesalivre.png",alt:"Mesa livre",className:Jt("w-16 h-16 object-contain opacity-80",s?.id===de.id&&"opacity-100")}):de.status==="in-use"?o.jsx("img",{src:"/mesaocupada.png",alt:"Mesa ocupada",className:Jt("w-16 h-16 object-contain opacity-80",s?.id===de.id&&"opacity-100")}):o.jsx("div",{className:Jt("w-16 h-16 rounded-lg bg-info/20 border-2 border-info/40 flex items-center justify-center",s?.id===de.id&&"bg-info/30 border-info/60"),children:o.jsx(rs,{className:"w-8 h-8 text-info"})})}),o.jsx("div",{className:"w-full mt-auto",children:de.status==="in-use"||de.status==="awaiting-payment"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(cl,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),o.jsx("div",{className:"text-sm sm:text-base font-medium text-text-primary truncate",title:de.customer||"",children:Ft(de.customer)||""})]}),o.jsxs("div",{className:"flex items-center gap-1 justify-between",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Ui,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),o.jsxs("div",{className:"text-sm font-bold text-text-secondary",children:["R$ ",Ye.toFixed(2)]})]}),o.jsx("button",{onClick:Ke=>{Ke.stopPropagation(),n(`/historico?mesa=${de.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:o.jsx(rs,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})]}):o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"text-xs text-text-muted",children:"Sem comanda"}),o.jsx("button",{onClick:Ke=>{Ke.stopPropagation(),n(`/historico?mesa=${de.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:o.jsx(rs,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})})]})},vr=()=>{const de=s?Pt(s.order,s):0,[Le,jt]=p.useState(!1),[Rt,Ot]=p.useState([]),[dr,er]=p.useState(1),[_r,ne]=p.useState([]),ie=p.useRef(new Map),Ye=typeof window<"u"&&window.innerWidth<=640,ze=ve=>{const Xe=String(ve||"").replace(/\D/g,"");return Xe?Number(Xe)/100:0},Ke=ve=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.max(0,Number(ve)||0)),rt=ve=>{const Xe=(Ze||[]).find(zt=>String(zt.id)===String(ve.methodId)),et=Xe&&Xe.taxa_percentual!=null?Number(Xe.taxa_percentual):0;return Number.isFinite(et)?et/100:0},oe=()=>(Rt||[]).reduce((ve,Xe)=>ve+ze(Xe.value),0),st=(ve,Xe)=>{try{if(Ye)return;const et=(Rt||[]).findIndex(zt=>zt.id===Xe);if(et>=0){const zt=(Rt||[])[et+1]||null;if(zt&&ie.current.get(zt.id)){const nr=ie.current.get(zt.id);setTimeout(()=>{try{nr.focus(),nr.select?.()}catch{}},0);return}}if(ve&&ve instanceof HTMLElement){const zt=Array.from(document.querySelectorAll('input[data-pay-value="1"]')),nr=zt.indexOf(ve);if(nr>=0&&zt[nr+1]){const Et=zt[nr+1];setTimeout(()=>{try{Et.focus(),Et.select?.()}catch{}},0);return}}Ot(zt=>{const nr=_r[0]?.id||"",Et=Ze&&Ze[0]&&Ze[0].id?Ze[0].id:null,Gt=dr,Nr=[...zt,{id:Gt,clientId:nr,methodId:Et,value:"",chargeFee:!0}];return er(tr=>tr+1),Ye||setTimeout(()=>{const tr=ie.current.get(Gt);if(tr)try{tr.focus(),tr.select?.()}catch{}},0),Nr})}catch{}};p.useEffect(()=>{let ve=!0;return(async()=>{try{if(!yt||!s?.comandaId)return;let et=[];try{const xr=await jGe({comandaId:s.comandaId,status:"Pendente",codigoEmpresa:t?.codigo_empresa});et=Array.isArray(xr)?xr:[]}catch{et=[]}let zt=[];try{const xr=await Qi({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa});zt=(Array.isArray(xr)?xr:[]).map(Lr=>{const Fr=Lr?.cliente_id??Lr?.clientes?.id??Lr?.id??null,gn=Lr?.clientes?.nome??Lr?.nome??Lr?.nome_livre??"";return!Fr&&gn?{id:`livre-${Lr?.id||Math.random()}`,nome:gn}:Fr?{id:Fr,nome:gn}:null}).filter(Boolean)}catch{zt=[]}if(!ve)return;if(ne(zt),Array.isArray(et)&&et.length>0){const xr=et.map((St,Lr)=>{const Fr=Number(St.valor||0),wa={id:Lr+1,clientId:St.cliente_id||null,methodId:St.finalizadora_id||null,chargeFee:!0},$n=rt(wa),ca=$n>0?Fr/(1+$n):Fr,da=ca*(1+$n);return{...wa,baseValue:ca,value:Ke(da)}});Ot(xr),er(xr.length+1);return}let nr=Ze&&Ze[0]&&Ze[0].id?Ze[0].id:null,Et=zt[0]?.id||null,Gt="";try{const St=(await Si({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).reduce((Lr,Fr)=>Lr+Number(Fr.quantidade||0)*Number(Fr.preco_unitario||0),0);St>0&&(Gt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(St))}catch{}const Nr=ze(Gt),tr={id:1,clientId:Et,methodId:nr,baseValue:Nr,chargeFee:!0},ar=rt(tr),sr=tr.chargeFee?Nr*(1+ar):Nr;Ot([{...tr,value:Ke(sr)}]),er(2)}catch(et){console.error(et)}})(),()=>{ve=!1}},[yt,s?.comandaId,Ze]),p.useEffect(()=>{if(!yt||!s?.comandaId||!Array.isArray(Rt)||Rt.length===0)return;const ve=setTimeout(async()=>{try{const Xe=(Rt||[]).map(et=>{const zt=ze(et.value),nr=(Ze||[]).find(Gt=>String(Gt.id)===String(et.methodId)),Et=nr?.tipo||nr?.nome||"outros";return{clienteId:et.clientId||null,finalizadoraId:et.methodId||null,metodo:Et,valor:zt}});await qq({comandaId:s.comandaId,linhas:Xe,codigoEmpresa:t?.codigo_empresa})}catch(Xe){console.warn("[PayDialog] Falha ao salvar rascunho de pagamentos (debounced):",Xe)}},400);return()=>{clearTimeout(ve)}},[yt,s?.comandaId,Rt,Ze,t?.codigo_empresa]),p.useEffect(()=>{let ve=!0;return(async()=>{try{if(!yt||Array.isArray(Ze)&&Ze.length>0)return;const et=await Hv({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});if(!ve)return;ct(et||[])}catch{}})(),()=>{ve=!1}},[yt]),p.useEffect(()=>{yt&&(!Array.isArray(Ze)||Ze.length===0||Ot(ve=>{if(!Array.isArray(ve)||ve.length===0)return ve;const Xe=Ze&&Ze[0]&&Ze[0].id?Ze[0].id:null;if(!Xe)return ve;let et=!1;const zt=ve.map(nr=>{if(!nr.methodId){et=!0;const Et={...nr,methodId:Xe},Gt=rt(Et),Nr=Et.chargeFee!==!1?Number(Et.baseValue||0)*(1+Gt):Number(Et.baseValue||0);return{...Et,value:Ke(Nr)}}return nr});return et?zt:ve}))},[yt,Ze]);const Ve=async()=>{try{if(!s?.comandaId)return;const ve=t?.codigo_empresa;if(!ve){e({title:"Empresa no definida",variant:"destructive"});return}if(!Array.isArray(Rt)||Rt.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const ar of Rt){if(!ar.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(ze(ar.value)<=0){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}const Xe=de>0?de:0,et=(Rt||[]).reduce((ar,sr)=>ar+ze(sr.value),0),zt=(Rt||[]).reduce((ar,sr)=>{const xr=Number(sr.baseValue||0),St=rt(sr);return ar+(sr.chargeFee!==!1&&St>0?xr*St:0)},0),nr=Xe+zt,Et=et-nr,Gt=Math.abs(Et);let Nr=de;if(Nr<=0)try{Nr=(await Si({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).reduce((xr,St)=>xr+Number(St.quantidade||0)*Number(St.preco_unitario||0),0)}catch{}jt(!0),await hf({codigoEmpresa:t?.codigo_empresa});try{const ar=(Rt||[]).map(sr=>{const xr=ze(sr.value),St=(Ze||[]).find(Fr=>String(Fr.id)===String(sr.methodId)),Lr=St?.tipo||St?.nome||"outros";return{clienteId:sr.clientId||null,finalizadoraId:sr.methodId||null,metodo:Lr,valor:xr}});await qq({comandaId:s.comandaId,linhas:ar,codigoEmpresa:ve})}catch(ar){console.warn("[PayDialog] Falha ao salvar rascunho antes de promover:",ar)}await NGe({comandaId:s.comandaId,codigoEmpresa:ve}),await Bx({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa,diferencaPagamento:Et}),i(ar=>ar.map(sr=>sr.id===s.id?{...sr,status:"available",order:[],comandaId:null,customer:null,totalHint:0}:sr)),l(ar=>ar&&{...ar,status:"available",order:[],comandaId:null,customer:null,totalHint:0});try{t?.codigo_empresa&&localStorage.removeItem(`vendas:tables:${t.codigo_empresa}`)}catch{}try{const ar=await bp(t?.codigo_empresa),sr=await sc({codigoEmpresa:t?.codigo_empresa}),xr={};await Promise.all((sr||[]).map(async Lr=>{try{const gn=(await Qi({comandaId:Lr.id,codigoEmpresa:t?.codigo_empresa})||[]).map(wa=>wa?.nome).filter(Boolean);xr[Lr.id]=gn.length?gn.join(", "):null}catch{xr[Lr.id]=null}}));const St=(ar||[]).map(Lr=>{const Fr=(sr||[]).find(gn=>gn.mesa_id===Lr.id);return{id:Lr.id,name:Lr.nome||`Mesa ${Lr.numero}`,status:Fr?"in-use":"available",comandaId:Fr?.id||null,customer:Fr?xr[Fr.id]:null,order:[],totalHint:0,aberto_em:Fr?.aberto_em||null}});i(St)}catch{}const tr=Gt>.009?Et>0?` | Diferena cobrada a mais: R$ ${Gt.toFixed(2)}`:` | Diferena cobrada a menos: R$ ${Gt.toFixed(2)}`:"";e({title:"Pagamento registrado",description:`Total itens R$ ${Nr.toFixed(2)} | Pagamentos R$ ${et.toFixed(2)}${tr}`,variant:"success"}),vt(!1)}catch(ve){e({title:"Falha ao registrar pagamento",description:ve?.message||"Tente novamente",variant:"destructive"})}finally{jt(!1)}};Rt&&Rt.length>0;const Qe=de>0?de:0,qt=(Rt||[]).reduce((ve,Xe)=>ve+ze(Xe.value),0),O=(Rt||[]).reduce((ve,Xe)=>{const et=Number(Xe.baseValue||0),zt=rt(Xe);return ve+(Xe.chargeFee!==!1&&zt>0?et*zt:0)},0),H=Qe+O,_e=qt-H,Oe=Math.abs(_e);return o.jsx(ln,{open:yt,onOpenChange:vt,children:o.jsxs(sn,{className:"sm:max-w-xl w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:ve=>ve.stopPropagation(),onKeyDownCapture:ve=>ve.stopPropagation(),onPointerDownOutside:ve=>ve.stopPropagation(),onInteractOutside:ve=>ve.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-2xl font-bold",children:"Fechar Conta"}),o.jsx(_n,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),o.jsxs("div",{className:"space-y-2",children:[(()=>{let ve=0,Xe=0,et=0;for(const Et of s?.order||[]){const Gt=(Et.price||0)*(Et.quantity||1);ve+=Gt,Et.desconto_tipo==="percentual"&&Et.desconto_valor>0?Xe+=Gt*(Et.desconto_valor/100):Et.desconto_tipo==="fixo"&&Et.desconto_valor>0&&(Xe+=Et.desconto_valor)}const zt=ve-Xe;s?.desconto_tipo==="percentual"&&s?.desconto_valor>0?et=zt*(s.desconto_valor/100):s?.desconto_tipo==="fixo"&&s?.desconto_valor>0&&(et=s.desconto_valor);const nr=Xe+et;return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-8 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-secondary",children:"Subtotal"}),o.jsxs("span",{className:"font-semibold",children:["R$ ",ve.toFixed(2)]})]}),nr>0&&o.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[o.jsx("span",{children:"Descontos"}),o.jsxs("span",{className:"font-semibold",children:["-R$ ",nr.toFixed(2)]})]})]}),o.jsxs("div",{className:"border-t border-border pt-1 flex items-center justify-between",children:[o.jsx("div",{className:"font-semibold",children:"Total"}),o.jsxs("div",{className:"font-bold text-lg",children:["R$ ",de.toFixed(2)]})]})]})})(),o.jsxs("div",{className:"flex items-center gap-8 text-xs text-text-muted pt-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:"Pagamentos"}),o.jsxs("span",{className:"font-semibold",children:["R$ ",qt.toFixed(2)]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:"Diferena"}),o.jsx("span",{className:Oe>.009?_e>0?"font-semibold text-emerald-600":"font-semibold text-amber-600":"font-semibold",children:Oe>.009?`${_e>0?"+":"-"} R$ ${Oe.toFixed(2)}`:"R$ 0,00"})]})]}),o.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1 max-h-[60vh]",children:[o.jsx(Ht,{className:"block",children:"Pagamentos"}),(Rt||[]).map((ve,Xe)=>{const et=Et=>{if(!Et)return"Cliente";const Gt=(_r||[]).find(Nr=>String(Nr.id)===String(Et));return Gt?.nome?Gt.nome:"Cliente"},zt=(_r||[]).length>1,nr=(_r||[])[0]||null;return(_r||[]).filter(Et=>String(Et.id)!==String(nr?.id||"")),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-center",children:[o.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:Rt.length>1&&Xe>0&&o.jsx(le,{type:"button",variant:"outline",size:"sm",className:"h-8 w-8",onClick:()=>{Ot(Et=>{const Gt=Et.filter(sr=>sr.id!==ve.id);if(Gt.length===0)return[];const Nr=de>0?de:0,tr=Math.floor(Nr/Gt.length*100)/100,ar=Nr-tr*Gt.length;return Gt.map((sr,xr)=>{const St=xr===Gt.length-1?tr+ar:tr,Lr={...sr},Fr=rt(Lr),wa=Lr.chargeFee!==!1&&Fr>0?St/(1+Fr):St;return{...Lr,baseValue:wa,value:Ke(St)}})})},children:""})}),Xe===0?o.jsx("div",{className:"sm:col-span-4",children:o.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:et(nr?.id||ve.clientId)})}):zt?o.jsx("div",{className:"sm:col-span-4",children:o.jsxs(En,{value:ve.clientId||"",onValueChange:Et=>Ot(Gt=>Gt.map(Nr=>Nr.id===ve.id?{...Nr,clientId:Et}:Nr)),children:[o.jsx(Sn,{className:"w-full truncate",children:o.jsx(kn,{placeholder:"Cliente"})}),o.jsx(Cn,{children:(_r||[]).map(Et=>o.jsx(Nt,{value:Et.id,children:Et.nome},Et.id))})]})}):o.jsx("div",{className:"sm:col-span-4",children:o.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:et(nr?.id||ve.clientId)})}),o.jsx("div",{className:"sm:col-span-4",children:o.jsxs(En,{value:ve.methodId||"",onValueChange:Et=>{Ot(Gt=>Gt.map(Nr=>{if(Nr.id!==ve.id)return Nr;const ar={...Nr,methodId:Et},sr=rt(ar),xr=ar.chargeFee!==!1?Number(ar.baseValue||0)*(1+sr):Number(ar.baseValue||0);return{...ar,value:Ke(xr)}}))},children:[o.jsx(Sn,{className:"w-full truncate",children:o.jsx(kn,{placeholder:"Forma de pagamento"})}),o.jsx(Cn,{children:(Ze||[]).map(Et=>o.jsx(Nt,{value:Et.id,children:Et.nome},Et.id))})]})}),o.jsx("div",{className:"sm:col-span-3",children:o.jsx(ir,{placeholder:"0,00",inputMode:"numeric",value:ve.value,"data-pay-value":"1",ref:Et=>{Et?ie.current.set(ve.id,Et):ie.current.delete(ve.id)},onChange:Et=>{const Gt=(Et.target.value||"").replace(/\D/g,""),Nr=Gt?Number(Gt)/100:0;Ot(tr=>tr.map(ar=>{if(ar.id!==ve.id)return ar;const sr=rt(ar),xr=ar.chargeFee!==!1&&sr>0?Nr/(1+sr):Nr,St=ar.chargeFee!==!1?xr*(1+sr):xr;return{...ar,baseValue:xr,value:Ke(St)}}))},onKeyDown:Et=>{if(Et.stopPropagation(),Et.key==="Enter"){Et.preventDefault(),st(Et.currentTarget,ve.id);return}["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(Et.key)||/^[0-9]$/.test(Et.key)||Et.preventDefault()},onBeforeInput:Et=>{const Gt=Et.data??"";Gt&&/\D/.test(Gt)&&Et.preventDefault()}})}),o.jsx("div",{className:"sm:col-span-12 -mt-1 pl-1",children:(()=>{const Et=rt(ve),Gt=Et*100,Nr=ve.chargeFee!==!1,tr=ve.baseValue!=null?Number(ve.baseValue):(()=>{const xr=(ve.value||"").toString().replace(/\D/g,""),St=xr?Number(xr)/100:0;return Nr&&Et>0?St/(1+Et):St})();if(!Gt||Gt<=0||!Number.isFinite(tr)||tr<=0)return null;const ar=Nr?tr*Et:0;return o.jsxs("button",{type:"button",onClick:()=>{Ot(sr=>sr.map(xr=>{if(xr.id!==ve.id)return xr;const St=rt(xr),Lr=xr.chargeFee!==!1,Fr=xr.baseValue!=null?Number(xr.baseValue):ze(xr.value),gn=Lr?Fr:Fr*(1+St);return{...xr,chargeFee:!Lr,baseValue:Fr,value:Ke(gn)}}))},className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",Nr?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:Nr?"Desmarcar taxa":"Cobrar taxa",children:[o.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",Nr?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),o.jsxs("span",{children:["Taxa R$ ",ar.toFixed(2)]})]})})()})]},ve.id)}),o.jsx("div",{children:o.jsx(le,{type:"button",variant:"secondary",size:"sm",className:"pointer-events-auto",onPointerUp:ve=>{ve.preventDefault(),ve.stopPropagation(),Ot(Xe=>{const et=_r[0]?.id||"",zt=Ze&&Ze[0]&&Ze[0].id?Ze[0].id:null,nr=[...Xe,{id:dr,clientId:et,methodId:zt,value:"",chargeFee:!0}],Et=de>0?de:0,Gt=Math.floor(Et/nr.length*100)/100,Nr=Et-Gt*nr.length;return nr.map((tr,ar)=>{const sr=ar===nr.length-1?Gt+Nr:Gt,xr=rt(tr),Lr=tr.chargeFee!==!1&&xr>0?sr/(1+xr):sr;return{...tr,baseValue:Lr,value:Ke(sr)}})}),er(Xe=>Xe+1)},children:"Adicionar forma"})}),(()=>{const ve=oe(),Xe=(Rt||[]).reduce((nr,Et)=>{const Gt=Number(Et.baseValue||0),Nr=rt(Et);return nr+(Et.chargeFee!==!1&&Nr>0?Gt*Nr:0)},0),zt=(de>0?de:0)+Xe-ve;return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[o.jsx("span",{children:"Soma"}),o.jsxs("span",{children:["R$ ",ve.toFixed(2)]})]}),o.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[o.jsx("span",{children:"Restante"}),o.jsxs("span",{className:Math.abs(zt)<.005?"text-success":"text-warning",children:["R$ ",zt.toFixed(2)]})]})]})})()]})]}),o.jsxs(Un,{children:[o.jsx(le,{type:"button",variant:"outline",onClick:()=>vt(!1),disabled:Le,children:"Cancelar"}),o.jsx(le,{type:"button",onClick:Ve,disabled:!(Rt&&Rt.length>0&&!Le),children:Le?"Processando...":"Confirmar Pagamento"})]})]})})},X=xe.memo(({open:de,onOpenChange:Le,cashSummary:jt})=>{const Rt=qt=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(qt||0)),[Ot,dr]=p.useState(!0);p.useEffect(()=>{dr(!!de)},[de]);const er=p.useMemo(()=>{const qt=Number(jt?.saldo_inicial??jt?.saldoInicial??0),O=jt?.totalPorFinalizadora||jt?.porFinalizadora||{},H=Number(jt?.totalEntradas??jt?.entradas??0),_e=H>0?H:Object.values(O||{}).reduce((et,zt)=>et+Number(zt||0),0),Oe=Number(jt?.sangria??jt?.totalSangria??0),ve=Number(jt?.totalSaidas??jt?.saidas??Oe),Xe=Math.max(0,qt+_e-ve);return{saldoInicial:qt,porFinalizadora:O,entradasInformadas:H,entradasCalc:_e,sangriaVal:Oe,saidas:ve,saldoAtual:Xe}},[jt]);p.useEffect(()=>{if(de&&jt){const qt=setTimeout(()=>dr(!1),50);return()=>clearTimeout(qt)}},[de,jt]);const{porFinalizadora:_r,sangriaVal:ne}=er,[ie,Ye]=p.useState(!1),[ze,Ke]=p.useState(""),[rt,oe]=p.useState(""),[st,Ve]=p.useState(!1),Qe=async()=>{try{Ve(!0);const qt=String(ze||"").replace(/\D/g,""),O=qt?Number(qt)/100:0;if(O<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await hf({codigoEmpresa:t?.codigo_empresa}),await e4({tipo:"sangria",valor:O,observacao:rt,codigoEmpresa:t?.codigo_empresa}),Ye(!1),Ke(""),oe(""),await Zr(),e({title:"Sangria registrada",variant:"success"})}catch(qt){e({title:"Falha ao registrar sangria",description:qt?.message||"Tente novamente",variant:"destructive"})}finally{Ve(!1)}};return o.jsx(ln,{open:de,onOpenChange:Le,children:o.jsxs(sn,{forceMount:!0,className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:qt=>qt.preventDefault(),onKeyDown:qt=>qt.stopPropagation(),onKeyDownCapture:qt=>qt.stopPropagation(),onPointerDownOutside:qt=>qt.stopPropagation(),onInteractOutside:qt=>qt.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),o.jsx(_n,{children:"Resumo da sesso atual do caixa."})]}),Ot||!jt?o.jsxs("div",{className:"px-4 space-y-3",children:[o.jsx(Jg,{className:"h-16 w-full"}),o.jsx(Jg,{className:"h-16 w-full"}),o.jsx(Jg,{className:"h-12 w-full"})]}):o.jsxs("div",{className:"px-1",children:[Object.keys(_r).length===0?o.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):o.jsxs(o.Fragment,{children:[o.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(_r).map(([qt,O])=>o.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(qt)}),o.jsx("span",{className:"text-sm font-semibold tabular-nums",children:Rt(O)})]},qt))}),o.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),o.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:Rt(ne)})]})]}),o.jsx("div",{className:"mt-3 text-xs text-text-muted leading-relaxed px-1",children:'Sadas incluem sangrias e ajustes. Use "Registrar Sangria" para lanar uma retirada.'})]}),o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsx("div",{className:"mr-auto"}),o.jsx(le,{variant:"destructive",onClick:()=>Ye(!0),children:"Registrar Sangria"}),o.jsx(le,{variant:"secondary",onClick:()=>Le(!1),children:"Fechar"})]}),o.jsx(ln,{open:ie,onOpenChange:Ye,children:o.jsxs(sn,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:qt=>qt.stopPropagation(),onKeyDownCapture:qt=>qt.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-xl font-bold",children:"Registrar Sangria"}),o.jsx(_n,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"sangria-valor",children:"Valor"}),o.jsx(ir,{id:"sangria-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:ze,onChange:qt=>{const O=(qt.target.value||"").replace(/\D/g,""),H=O?Number(O)/100:0,_e=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(H);Ke(_e)},onKeyDown:qt=>{qt.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(qt.key)&&(/^[0-9]$/.test(qt.key)||qt.preventDefault())},onBeforeInput:qt=>{const O=qt.data??"";O&&/\D/.test(O)&&qt.preventDefault()}})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"sangria-obs",children:"Observao"}),o.jsx(ir,{id:"sangria-obs",placeholder:"Opcional",value:rt,onChange:qt=>oe(qt.target.value)})]})]}),o.jsxs(Un,{children:[o.jsx(le,{variant:"outline",onClick:()=>Ye(!1),disabled:st,children:"Cancelar"}),o.jsx(le,{onClick:Qe,disabled:st,children:st?"Registrando...":"Confirmar"})]})]})})]})})}),nt=()=>{const de=async()=>{if(B)try{await Av({itemId:B.id,codigoEmpresa:t?.codigo_empresa}),e({title:"Item removido",description:B.name,variant:"warning"})}catch(Le){e({title:"Falha ao remover item",description:Le?.message||"Tente novamente",variant:"destructive"})}finally{re(!1),L(null)}};return o.jsx(qd,{open:V,onOpenChange:re,children:o.jsxs(Kc,{children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Remover item?"}),o.jsxs(Qc,{children:['Tem certeza que deseja remover "',B?.name,'" da comanda? Esta ao no pode ser desfeita.']})]}),o.jsxs(Xc,{children:[o.jsx(Zc,{children:"Cancelar"}),o.jsx(zd,{onClick:de,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})})},qe=()=>{const de=s,Le=de?.order||[],jt=de?Pt(Le):0;return o.jsx(ln,{open:$,onOpenChange:K,children:o.jsxs(sn,{className:"sm:max-w-xl w-[92vw] animate-none",onKeyDown:Rt=>Rt.stopPropagation(),onKeyDownCapture:Rt=>Rt.stopPropagation(),onPointerDownOutside:Rt=>Rt.stopPropagation(),onInteractOutside:Rt=>Rt.stopPropagation(),children:[o.jsxs(an,{children:[o.jsxs(nn,{className:"text-2xl font-bold",children:["Comanda da Mesa ",de?.number??""]}),o.jsx(_n,{children:de?.customer?`Cliente: ${de.customer}`:"Sem cliente vinculado"})]}),o.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto thin-scroll",children:Le.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Nenhum item na comanda."}):o.jsx("ul",{className:"divide-y divide-border",children:Le.map(Rt=>o.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"font-medium truncate",children:Rt.name}),o.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",Rt.quantity,"  Unit: R$ ",Number(Rt.price||0).toFixed(2)]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("div",{className:"font-semibold",children:["R$ ",(Number(Rt.price||0)*Number(Rt.quantity||0)).toFixed(2)]})})]},Rt.id))})}),o.jsxs(Un,{children:[o.jsxs("div",{className:"mr-auto text-sm font-semibold",children:["Total: R$ ",jt.toFixed(2)]}),o.jsx(le,{variant:"secondary",onClick:()=>K(!1),children:"Fechar"}),de?.comandaId&&o.jsxs(le,{variant:"outline",onClick:()=>window.open(`/print-comanda?comanda=${de.comandaId}`,"_blank"),children:[o.jsx(xH,{className:"mr-2 h-4 w-4"})," Imprimir"]}),o.jsxs(le,{onClick:async()=>{K(!1),await gr()},disabled:!de||Le.length===0,children:[o.jsx(Ui,{className:"mr-2 h-4 w-4"})," Fechar Conta",o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]})})},it=p.useMemo(()=>qe,[s?.id,$]),We=({table:de})=>{const[Le,jt]=p.useState(""),[Rt,Ot]=p.useState(!1),[dr,er]=p.useState(!1),_r=async()=>{if(!(!de?.comandaId||Rt))try{Ot(!0),await IGe({comandaId:de.comandaId,observacoes:Le,codigoEmpresa:Number(t?.codigo_empresa)}),e({title:"Observaes salvas",description:"As observaes da comanda foram atualizadas."});try{await jr(de)}catch(ne){console.error("Erro ao recarregar detalhes da comanda aps salvar observaes:",ne)}}catch(ne){ne?.code!=="42804"&&(console.error("Erro ao salvar observao:",ne),e({title:"Erro ao salvar observaes",description:"Tente novamente mais tarde.",variant:"destructive"}))}finally{Ot(!1)}};return p.useEffect(()=>{if(!de?.comandaId){jt("");return}jt(de.observacoes||"")},[de?.comandaId,de?.observacoes]),de?o.jsxs("div",{className:"flex flex-col h-full p-4 space-y-4 overflow-y-auto thin-scroll",children:[de.order&&de.order.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(Ht,{className:"text-sm font-semibold",children:"Descontos por Item"}),o.jsx(le,{size:"xs",variant:"ghost",className:"h-6 px-2 text-[11px]",onClick:()=>er(ne=>!ne),children:dr?"Esconder":`Mostrar (${de.order.length})`})]}),dr&&o.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:de.order.map(ne=>o.jsx("button",{onClick:()=>Or(ne),className:"w-full p-3 rounded border border-border bg-surface hover:bg-surface-2 transition text-left",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm font-semibold truncate",children:ne.name}),o.jsxs("p",{className:"text-xs text-text-secondary",children:["Qtd: ",ne.quantity,"  R$ ",(ne.price||0).toFixed(2)]})]}),o.jsx("div",{className:"text-right flex-shrink-0",children:ne.desconto_valor>0?o.jsxs("span",{className:"text-xs font-bold text-destructive",children:["-",ne.desconto_tipo==="percentual"?ne.desconto_valor+"%":"R$"+(ne.desconto_valor||0).toFixed(2)]}):o.jsx("span",{className:"text-xs text-text-muted",children:"Sem desconto"})})]})},ne.id))})]}),de.comandaId&&o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsx(Ht,{className:"text-sm font-semibold",children:"Observaes"}),Rt&&o.jsx("span",{className:"text-[11px] text-text-secondary",children:"Salvando..."})]}),o.jsx("textarea",{className:"border border-border rounded p-3 text-sm resize-none bg-background min-h-20",placeholder:"Ex: sem cebola, urgente, etc.",value:Le,onChange:ne=>{const ie=ne.target.value;jt(ie)},onKeyDown:async ne=>{ne.key==="Enter"&&!ne.shiftKey&&(ne.preventDefault(),await _r())}})]}),de.comandaId&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{className:"text-sm font-semibold",children:"Desconto da Comanda"}),o.jsx(le,{size:"sm",variant:de.desconto_valor>0?"default":"outline",onClick:()=>Ir(!0),className:"w-full gap-2",children:de.desconto_valor>0?o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Desconto Ativo:"}),o.jsxs("span",{className:"font-bold",children:["-",de.desconto_tipo==="percentual"?de.desconto_valor+"%":"R$"+de.desconto_valor.toFixed(2)]})]}):"Aplicar Desconto"}),de.desconto_motivo&&o.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded border border-border",children:[o.jsx("strong",{children:"Motivo:"})," ",de.desconto_motivo]})]})]}):o.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:o.jsxs("div",{className:"text-center",children:[o.jsx(rs,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),o.jsx("p",{children:"Selecione uma mesa"})]})})},ut=({table:de})=>{if(!de)return o.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Mv,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),o.jsx("p",{children:"Selecione uma mesa para ver a comanda"})]})});if(dn)return o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[o.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx(le,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}gt(de),Y(!0)},children:"Abrir Mesa"})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:[o.jsx(Jg,{className:"h-20 w-full"}),o.jsx(Jg,{className:"h-20 w-full"}),o.jsx(Jg,{className:"h-20 w-full"})]}),o.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[o.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary mb-2",children:[o.jsx("span",{children:"Total"}),o.jsx("span",{children:"R$ 0,00"})]}),o.jsx(le,{size:"lg",className:"w-full",disabled:!c,children:"Fechar Conta"})]})]});const Le=Pt(de.order,de),jt=Ft(de.customer),Rt=async()=>{if(!de?.comandaId)return;const _r=(await Si({comandaId:de.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(ze=>({id:ze.id,productId:ze.produto_id,name:ze.descricao||"Item",price:Number(ze.preco_unitario||0),quantity:Number(ze.quantidade||1)})),ne=(_r||[]).reduce((ze,Ke)=>ze+Number(Ke.price||0)*Number(Ke.quantity||0),0);let ie=de.customer||null;try{const Ke=(await Qi({comandaId:de.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(rt=>rt?.nome).filter(Boolean);ie=Ke.length?Ke.join(", "):null}catch{}const Ye={...de,order:_r,customer:ie,totalHint:ne};l(Ye),i(ze=>ze.map(Ke=>Ke.id===Ye.id?Ye:Ke))},Ot=async(er,_r)=>{try{const ie=Number(er.quantity||1)+_r;if(ie<=0){L(er),re(!0),setTimeout(async()=>{V||await Rt()},100);return}const Ye=Number(er.price||0)*Number(_r||0);Ye&&(l(ze=>ze&&{...ze,totalHint:Math.max(0,Number(ze.totalHint||0)+Ye)}),i(ze=>ze.map(Ke=>Ke.id===s?.id?{...Ke,totalHint:Math.max(0,Number(Ke.totalHint||0)+Ye)}:Ke))),await Wc({itemId:er.id,quantidade:ie,codigoEmpresa:t?.codigo_empresa}),await Rt(),e({title:"Quantidade atualizada",description:`${er.name}: ${ie}`,variant:"success"})}catch(ne){e({title:"Falha ao atualizar quantidade",description:ne?.message||"Tente novamente",variant:"destructive"})}},dr=async er=>{L(er),re(!0),setTimeout(async()=>{V||await Rt()},100)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex flex-col h-full",onMouseDown:er=>{er.target===er.currentTarget&&er.preventDefault()},children:[o.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-center md:justify-between gap-2",children:[jt?o.jsx("div",{className:"hidden sm:block text-sm font-medium text-text-primary leading-none truncate",title:de.customer||"",children:jt}):o.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),o.jsx("div",{className:"flex items-center gap-2",children:de.comandaId?o.jsxs(o.Fragment,{children:[o.jsxs(le,{size:"sm",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all flex items-center",onClick:()=>fe(!0),children:[o.jsx(cl,{size:12,className:"text-white/80 mr-1.5"}),"Clientes"]}),o.jsxs(le,{size:"sm",variant:"outline",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all",onClick:()=>K(!0),children:[o.jsx("span",{className:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-black/40 border border-white/10 mr-1.5",children:o.jsx(rs,{size:12,className:"text-white/80"})}),"Comanda"]}),o.jsxs(qd,{children:[o.jsx(yp,{asChild:!0,children:o.jsx(le,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",children:"Cancelar"})}),o.jsxs(Kc,{className:"sm:max-w-[420px] animate-none",onKeyDown:er=>er.stopPropagation(),children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Cancelar comanda?"}),o.jsx(Qc,{children:"Esta ao no pode ser desfeita. Os itens sero descartados e a mesa voltar a ficar livre."})]}),o.jsxs(Xc,{children:[o.jsx(Zc,{children:"Voltar"}),o.jsx(zd,{disabled:!1,onClick:async er=>{const _r=er.currentTarget.closest('[role="alertdialog"]');_r&&_r.querySelector("[data-radix-collection-item]")?.click();try{const ne=t?.codigo_empresa;if(ne)try{localStorage.removeItem(`vendas:selected:${ne}`),localStorage.removeItem(`vendas:tables:${ne}`)}catch{}await zq({comandaId:de.comandaId,codigoEmpresa:ne}),l(null),await ot({showToast:!1}),e({title:"Comanda cancelada",variant:"success"})}catch(ne){console.error("[Cancelar Comanda] Erro:",ne),e({title:"Falha ao cancelar comanda",description:ne?.message||"Tente novamente",variant:"destructive"});try{await ot({showToast:!1})}catch(ie){console.error("[Cancelar Comanda] Erro ao recarregar aps falha:",ie)}}},children:"Confirmar Cancelamento"})]})]})]})]}):o.jsx(le,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}gt(de),Y(!0)},children:"Abrir Mesa"})})]}),o.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 thin-scroll",children:de.order.length===0?o.jsx("div",{className:"text-center text-text-muted pt-16",children:o.jsx("p",{children:"Comanda vazia. Adicione produtos na aba ao lado."})}):o.jsx("ul",{className:"space-y-3",children:de.order.map(er=>o.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface",children:[o.jsx("div",{className:"flex-1 min-w-0",children:o.jsx("p",{className:"text-sm font-semibold text-text-primary truncate",title:er.name,children:er.name})}),o.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(le,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>Ot(er,-1),children:o.jsx(xv,{size:12})}),o.jsx("span",{className:"w-7 text-center font-semibold text-sm",children:er.quantity}),o.jsx(le,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>Ot(er,1),children:o.jsx(Ga,{size:12})})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"text-right flex-1",children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsxs("span",{className:"font-bold text-text-primary",children:["R$ ",(er.price*er.quantity).toFixed(2)]}),er.desconto_valor>0&&o.jsxs("span",{className:"text-xs font-semibold text-destructive",children:["-",er.desconto_tipo==="percentual"?er.desconto_valor+"%":"R$"+(er.desconto_valor||0).toFixed(2)]})]})}),o.jsx(le,{variant:"ghost",size:"icon",className:"text-danger/80 hover:text-danger h-7 w-7",onClick:()=>dr(er),children:o.jsx(Gm,{size:14})})]})]})]},er.id))})}),o.jsxs("div",{className:"p-4 border-t border-border mt-auto space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary",children:[o.jsx("span",{children:"Total"}),o.jsxs("span",{children:["R$ ",Le.toFixed(2)]})]}),o.jsxs(le,{size:"lg",className:"w-full",onClick:gr,children:[o.jsx(Ui,{className:"mr-2"})," Fechar Conta",o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]}),o.jsx(vr,{})]})},At=()=>{const[de,Le]=p.useState(""),[jt,Rt]=p.useState(""),Ot=async()=>{try{if(Q)return;ae(!0);const dr=(de??"").toString().trim(),er=dr?Number(dr):void 0;if(er!==void 0&&(Number.isNaN(er)||er<=0)){e({title:"Nmero invlido",description:"Informe um nmero positivo.",variant:"warning"});return}const _r=await _Ge({numero:er,nome:(jt||"").trim()||void 0,codigoEmpresa:t?.codigo_empresa}),ne={id:_r.id,number:_r.numero,name:_r.nome,status:"available",order:[],customer:null,comandaId:null,totalHint:0};i(ie=>(ie.some(Ke=>Ke.id===ne.id)?ie.map(Ke=>Ke.id===ne.id?ne:Ke):[...ie,ne]).slice().sort((Ke,rt)=>Number(Ke.number)-Number(rt.number))),xe.startTransition(()=>{l(ne),Ue(!1)}),e({title:"Mesa criada",description:`Mesa ${_r.numero} adicionada`,variant:"success"}),Le(""),Rt("")}catch(dr){e({title:"Falha ao criar mesa",description:dr?.message||"Tente novamente",variant:"destructive"})}finally{ae(!1)}};return o.jsx(ln,{open:be,onOpenChange:dr=>{Ue(dr),dr||(Le(""),Rt(""))},children:o.jsxs(sn,{className:"sm:max-w-md w-[92vw]",children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-2xl font-bold",children:"Nova Mesa"}),o.jsx(_n,{children:"Informe o nome da mesa. Se deixar em branco, ser criada com numerao automtica."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(Ht,{htmlFor:"nova-mesa-nome",children:"Nome da mesa"}),o.jsx(ir,{id:"nova-mesa-nome",type:"text",placeholder:"Ex: Mesa 1, Varanda, etc.",value:jt,onChange:dr=>Rt(dr.target.value),onKeyDown:dr=>{dr.stopPropagation(),dr.key==="Enter"&&!Q&&(dr.preventDefault(),Ot())},onKeyPress:dr=>dr.stopPropagation()})]}),o.jsxs(Un,{children:[o.jsx(le,{type:"button",variant:"outline",onClick:()=>Ue(!1),disabled:Q,children:"Cancelar"}),o.jsx(le,{type:"button",onClick:Ot,disabled:Q,children:Q?"Criando...":"Criar Mesa"})]})]})})},Wt=async de=>{try{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}if(!s?.comandaId){e({title:"Selecione uma mesa",description:"Abra a comanda clicando na mesa primeiro.",variant:"destructive"});return}const Le=Number(de.stock??de.currentStock??0),jt=x.get(de.id)||0,Rt=Math.max(0,Le-jt);if(((s?.order||[]).find(rt=>rt.productId===de.id)?.quantity||0)+1>Rt){e({title:"Estoque insuficiente",description:`${de.name} - Estoque disponvel: ${Rt} (${Le} total, ${jt} reservado em outras comandas)`,variant:"destructive"});return}const er=Number(de.salePrice??de.price??0),_r=(s?.order||[]).find(rt=>rt.productId===de.id);let ne;_r?(await Wc({itemId:_r.id,quantidade:Number(_r.quantity||1)+1,codigoEmpresa:t?.codigo_empresa}),ne={..._r,quantity:Number(_r.quantity||1)+1}):ne=await t4({comandaId:s.comandaId,produtoId:de.id,descricao:de.name,quantidade:1,precoUnitario:er,codigoEmpresa:t?.codigo_empresa});const Ye=(await Si({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(rt=>({id:rt.id,productId:rt.produto_id,name:rt.descricao||"Item",price:Number(rt.preco_unitario||0),quantity:Number(rt.quantidade||1)})),ze=(Ye||[]).reduce((rt,oe)=>rt+Number(oe.price||0)*Number(oe.quantity||0),0),Ke={...s,order:Ye,totalHint:ze};l(Ke),i(rt=>rt.map(oe=>oe.id===Ke.id?Ke:oe));try{const rt=await Gv({codigoEmpresa:t?.codigo_empresa}),oe=new Map;for(const st of rt||[]){const Ve=st.produto_id,Qe=Number(st.quantidade||0);oe.set(Ve,(oe.get(Ve)||0)+Qe)}y(oe)}catch(rt){console.error("[addProductToComanda] Erro ao atualizar estoque reservado:",rt)}Mr(de.id),setTimeout(()=>{Mr(rt=>rt===de.id?null:rt)},500),e({title:"Produto adicionado",variant:"success"})}catch(Le){console.error("[addProductToComanda] EXCEPTION:",Le),e({title:"Falha ao adicionar produto",description:Le?.message||"Tente novamente",variant:"destructive"})}},$r=()=>{const[de,Le]=p.useState(""),[jt,Rt]=p.useState("all"),Ot=p.useRef(null),dr=p.useRef(0),er=p.useRef(null),ne=(me||[]).slice().sort((ie,Ye)=>{const ze=ie.code||"",Ke=Ye.code||"";return/^\d+$/.test(ze)&&/^\d+$/.test(Ke)?parseInt(ze,10)-parseInt(Ke,10):ze.localeCompare(Ke)}).filter(ie=>{const Ye=de.trim().toLowerCase(),ze=!Ye||(ie.name||"").toLowerCase().includes(Ye)||String(ie.code||"").toLowerCase().includes(Ye);if(jt==="all")return ze;const Ke=Number(ie.stock??ie.currentStock??0),rt=x.get(ie.id)||0,oe=Math.max(0,Ke-rt);return jt==="available"?ze&&oe>0:jt==="low"?ze&&oe>0&&oe<=5:jt==="out"?ze&&oe<=0:ze});return s?o.jsx(ln,{open:b,onOpenChange:ie=>{w(ie),A(ie?"panel":"tables")},children:o.jsxs(sn,{className:"w-[95vw] sm:max-w-4xl max-h-[80vh] sm:max-h-[85vh] flex flex-col p-0 gap-0 focus:outline-none focus-visible:outline-none !overflow-visible",style:{scrollBehavior:"auto"},onOpenAutoFocus:ie=>{ie.preventDefault(),A("panel")},onWheel:ie=>{ie.stopPropagation()},onKeyDown:ie=>{const Ye=ie.target,ze=Ye&&(Ye.tagName==="INPUT"||Ye.closest("input")),Ke=Ye&&Ye.closest("[data-product-card]");if(!["ArrowDown","ArrowUp","Home","End","Enter","Delete","Escape"].includes(ie.key)||ze||Ke)return;ie.preventDefault(),ie.stopPropagation();const rt=S||0,oe=ne.length;if(ie.key==="ArrowDown"){const st=Math.min(rt+1,oe-1);k(st),dr.current=st,requestAnimationFrame(()=>j.current[st]?.focus());return}if(ie.key==="ArrowUp"){const st=Math.max(rt-1,0);k(st),dr.current=st,requestAnimationFrame(()=>j.current[st]?.focus());return}if(ie.key==="Home"){k(0),dr.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(ie.key==="End"){const st=Math.max(0,oe-1);k(st),dr.current=st,requestAnimationFrame(()=>j.current[st]?.focus());return}if(ie.key==="Escape"){w(!1);return}},children:[o.jsxs(an,{className:"px-6 py-4 border-b border-border",children:[o.jsxs(nn,{className:"text-2xl font-bold flex items-center gap-3",children:[o.jsx(Mv,{className:"w-6 h-6 text-brand"}),"Adicionar Produtos"]}),o.jsxs(_n,{className:"text-base mt-2",children:["Mesa ",s.number,"  ",Ft(s.customer)||"Sem cliente"]})]}),o.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border bg-surface/50",children:[o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted"}),o.jsx("input",{ref:Ot,type:"text",className:"w-full pl-10 pr-4 py-3 text-base rounded-lg bg-background border-2 border-border focus:border-brand focus:ring-2 focus:ring-brand/20 transition-all outline-none",placeholder:"Digite o nome ou cdigo do produto...",value:de,onChange:ie=>Le(ie.target.value),onClick:ie=>{ie.stopPropagation(),ie.currentTarget.focus(),A("panel")},onFocus:ie=>{ie.stopPropagation(),A("panel")},onKeyDown:ie=>{if(ie.stopPropagation(),ie.nativeEvent&&typeof ie.nativeEvent.stopImmediatePropagation=="function"&&ie.nativeEvent.stopImmediatePropagation(),A("panel"),["ArrowDown","ArrowUp","Home","End","Escape"].includes(ie.key)){ie.preventDefault();const Ye=S||0,ze=ne.length;if(ie.key==="ArrowDown"){k(Math.min(Ye+1,ze-1));return}if(ie.key==="ArrowUp"){k(Math.max(Ye-1,0));return}if(ie.key==="Home"){k(0);return}if(ie.key==="End"){k(ze-1);return}if(ie.key==="Escape"){w(!1);return}}}})]}),o.jsxs("div",{className:"flex items-center justify-between gap-4 mt-3",children:[o.jsx("button",{onClick:()=>Rt("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${jt==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),o.jsx("button",{onClick:()=>Rt("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${jt==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),o.jsx("button",{onClick:()=>Rt("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${jt==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),o.jsx("button",{onClick:()=>Rt("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${jt==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"}),o.jsxs("div",{className:"hidden sm:flex items-center gap-2 ml-auto text-xs text-text-muted flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:""}),o.jsx("span",{children:"Navegar"})]}),o.jsx("div",{className:"w-px h-3 bg-border"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:"Esc"}),o.jsx("span",{children:"Fechar"})]})]})]})]}),o.jsx("div",{ref:er,className:"flex-1 overflow-y-auto px-6 py-4 focus:outline-none",tabIndex:-1,onKeyDown:ie=>{["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(ie.key)&&(ie.preventDefault(),ie.stopPropagation(),ie.nativeEvent&&typeof ie.nativeEvent.stopImmediatePropagation=="function"&&ie.nativeEvent.stopImmediatePropagation()),ie.stopPropagation();const Ye=ie.target,ze=Ye&&(Ye.tagName==="INPUT"||Ye.closest("input"));if(!["ArrowDown","ArrowUp","Home","End","Escape"].includes(ie.key)||ze)return;const Ke=S||0,rt=ne.length;if(ie.key==="ArrowDown"){const oe=Math.min(Ke+1,rt-1);k(oe),dr.current=oe,requestAnimationFrame(()=>j.current[oe]?.focus());return}if(ie.key==="ArrowUp"){const oe=Math.max(Ke-1,0);k(oe),dr.current=oe,requestAnimationFrame(()=>j.current[oe]?.focus());return}if(ie.key==="Home"){k(0),dr.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(ie.key==="End"){const oe=Math.max(0,rt-1);k(oe),dr.current=oe,requestAnimationFrame(()=>j.current[oe]?.focus());return}if(ie.key==="Escape"){w(!1);return}},children:ne.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[o.jsx(Mv,{className:"w-16 h-16 text-text-muted mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto encontrado"}),o.jsx("p",{className:"text-text-muted mb-4",children:"Tente ajustar sua busca ou cadastre novos produtos"}),o.jsxs(le,{onClick:()=>{w(!1),n("/produtos")},children:[o.jsx(Ga,{className:"w-4 h-4 mr-2"}),"Cadastrar Produtos"]})]}):o.jsx("div",{className:"flex flex-col gap-1.5",children:ne.map((ie,Ye)=>{const ze=Ar.get(ie.id)||0,Ke=Number(ie.stock??ie.currentStock??0),rt=x.get(ie.id)||0,oe=Math.max(0,Ke-rt),st=Ye===S,Ve=ie.id===hr;return o.jsxs("div",{ref:Qe=>{console.log("[Card ref] Atribuindo ref para idx:",Ye,"prod:",ie.name,"el:",!!Qe),j.current[Ye]=Qe,console.log("[Card ref] productItemRefs.current:",j.current.length,"elementos")},"data-product-card":!0,className:Jt("flex items-center gap-2 sm:gap-4 p-2.5 sm:p-3 rounded-lg border-2 transition-colors duration-500 outline-none focus:outline-none focus-visible:outline-none",oe===0&&ze===0?"opacity-50 cursor-not-allowed bg-surface-2 border-border":"cursor-pointer",st?"border-brand bg-brand/5 shadow-md":oe>0?"border-border bg-surface hover:border-brand/50 hover:bg-surface-2":ze>0?"border-border bg-surface":"border-border",Ve&&"bg-brand/8"),tabIndex:oe>0||ze>0?0:-1,onKeyDown:Qe=>{if(["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(Qe.key)&&(Qe.preventDefault(),Qe.stopPropagation(),Qe.nativeEvent&&typeof Qe.nativeEvent.stopImmediatePropagation=="function"&&Qe.nativeEvent.stopImmediatePropagation()),!["ArrowDown","ArrowUp","Home","End","Escape"].includes(Qe.key))return;Qe.stopPropagation();const qt=ne.length;if(Qe.key==="ArrowDown"){const O=Math.min(Ye+1,qt-1);k(O),dr.current=O,requestAnimationFrame(()=>j.current[O]?.focus());return}if(Qe.key==="ArrowUp"){const O=Math.max(Ye-1,0);k(O),dr.current=O,requestAnimationFrame(()=>j.current[O]?.focus());return}if(Qe.key==="Home"){k(0),dr.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(Qe.key==="End"){const O=Math.max(0,qt-1);k(O),dr.current=O,requestAnimationFrame(()=>j.current[O]?.focus());return}if(Qe.key==="Escape"){w(!1);return}},onClick:()=>{oe===0&&ze===0||(k(Ye),dr.current=Ye,requestAnimationFrame(()=>j.current[Ye]?.focus()))},onMouseDown:Qe=>{if(oe===0&&ze===0){Qe.preventDefault();return}Qe.currentTarget.focus()},children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[ie.code&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-mono font-semibold bg-surface-2 border border-border rounded",children:ie.code}),o.jsx("h4",{className:"font-semibold text-sm sm:text-base text-text-primary truncate",children:ie.name})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px] sm:text-xs mt-0.5",children:[o.jsx("span",{className:Jt("font-bold",oe===0?"text-text-muted":"text-brand"),children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(ie.salePrice??ie.price??0))}),o.jsxs("span",{className:"text-text-muted whitespace-nowrap",children:["Estoque: ",o.jsx("span",{className:Jt("font-semibold",oe<=5?"text-destructive":"text-text-secondary"),children:oe})]}),ze>0&&o.jsxs("span",{className:"px-2 py-0.5 bg-brand/10 text-brand text-[11px] font-semibold rounded whitespace-nowrap",children:[ze,"x na comanda"]})]})]}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[o.jsx(le,{size:"icon",variant:"outline",onClick:Qe=>{Qe.stopPropagation(),Zt(ie)},disabled:ze===0,className:"h-8 w-8 p-0",children:o.jsx(xv,{className:"w-4 h-4"})}),o.jsx(le,{size:"icon",onClick:Qe=>{Qe.stopPropagation(),Wt(ie)},disabled:oe===0,className:"h-8 w-8 p-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",children:o.jsx(Ga,{className:"w-4 h-4"})})]})]},ie.id)})})}),o.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t border-border bg-surface/50",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2",children:[o.jsxs("div",{className:"hidden sm:block text-sm text-text-muted",children:[ne.length," produto",ne.length!==1?"s":"","  ",(s.order||[]).length," ite",(s.order||[]).length!==1?"ns":"m"," na comanda"]}),o.jsxs("div",{className:"flex items-center justify-end gap-3 w-full sm:w-auto",children:[o.jsxs("div",{className:"text-left sm:text-right",children:[o.jsx("div",{className:"text-xs text-text-muted",children:"Total"}),o.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.totalHint||0)})]}),o.jsx(le,{onClick:()=>w(!1),className:"px-4 sm:px-6 min-w-[96px] sm:min-w-[120px]",size:"sm",children:"Concluir"})]})]})})]})]})}):null},[W,Ce]=p.useState(null),[De,bt]=p.useState([]),[He,dt]=p.useState(!1),[rr,Gr]=p.useState(""),[Rr,br]=p.useState(!1),[wr,or]=p.useState([]),[tn,tt]=p.useState(!1),[Hr,un]=p.useState(null),[jn,vn]=p.useState(!1),[Zn,Mn]=p.useState(null),oa=p.useMemo(()=>{const de=new Map;for(const Le of De||[]){const jt=Le.productId,Rt=Number(Le.quantity||0);de.set(jt,(de.get(jt)||0)+Rt)}return de},[De]),Dn=async de=>{if(!de)return;const jt=(await Si({comandaId:de,codigoEmpresa:t?.codigo_empresa})||[]).map(Rt=>({id:Rt.id,productId:Rt.produto_id,name:Rt.descricao||"Item",price:Number(Rt.preco_unitario||0),quantity:Number(Rt.quantidade||1)}));bt(jt)},va=async de=>{try{const Le=t?.codigo_empresa;if(!Le){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}let jt=W;if(!jt){if(jt=(await Ej({codigoEmpresa:Le}))?.id,!jt){e({title:"Falha ao iniciar venda no balco",description:"No foi possvel criar ou recuperar a comanda.",variant:"destructive"});return}Ce(jt)}const Rt=Number(de.salePrice??de.price??0);await t4({comandaId:jt,produtoId:de.id,descricao:de.name,quantidade:1,precoUnitario:Rt,codigoEmpresa:Le}),await Dn(jt),e({title:"Produto adicionado (balco)",description:de.name,variant:"success"})}catch(Le){e({title:"Falha ao adicionar produto (balco)",description:Le?.message||"Tente novamente",variant:"destructive"})}},on=async de=>{if(!(!W||!de)){br(!1);try{await Kv({comandaId:W,clienteIds:[de],nomesLivres:[],codigoEmpresa:t?.codigo_empresa}),un(de),Gr(""),or([]),e({title:"Cliente associado",variant:"success"})}catch(Le){e({title:"Falha ao associar cliente",description:Le?.message||"Tente novamente",variant:"destructive"}),br(!0)}}},Ea=async()=>{if(W)try{const de=Pt(De,null);if(de<=0){e({title:"Sem itens",description:"Adicione itens antes de pagar.",variant:"warning"});return}dt(!0),await hf({codigoEmpresa:t?.codigo_empresa});let Le=Ze;if(!Array.isArray(Le)||Le.length===0)try{Le=await Hv({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa}),ct(Le)}catch{}const jt=Le?.[0],Rt=jt?.tipo||jt?.nome||"outros";await yM({comandaId:W,finalizadoraId:jt?.id,metodo:Rt,valor:de,codigoEmpresa:t?.codigo_empresa}),await Bx({comandaId:W,codigoEmpresa:t?.codigo_empresa}),e({title:"Pagamento registrado (balco)",description:`R$ ${de.toFixed(2)}`,variant:"success"}),bt([]),Ce(null),h(!1)}catch(de){e({title:"Falha no pagamento (balco)",description:de?.message||"Tente novamente",variant:"destructive"})}finally{dt(!1)}},Ca=()=>{p.useEffect(()=>{let Le=!0;return(async()=>{if(m)try{dt(!0);const Rt=t?.codigo_empresa;if(!Rt){Le&&e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}const Ot=await xM({codigoEmpresa:Rt});if(!Le)return;if(Ot?.id){Ce(Ot.id),await Dn(Ot.id);try{const dr=await Qi({comandaId:Ot.id,codigoEmpresa:Rt}),er=Array.isArray(dr)&&dr.length>0?dr[0]:null;er?.cliente_id&&un(er.cliente_id)}catch{}}else Ce(null),bt([])}catch(Rt){Le&&e({title:"Falha ao abrir Modo Balco",description:Rt?.message||"Tente novamente",variant:"destructive"})}finally{Le&&dt(!1)}})(),()=>{Le=!1}},[m]),p.useEffect(()=>{if(!Rr)return;let Le=!0;const Rt=setTimeout(async()=>{try{tt(!0);const Ot=await kj({searchTerm:rr,limit:20,codigoEmpresa:t?.codigo_empresa});Le&&or(Ot||[])}catch{Le&&or([])}finally{Le&&tt(!1)}},250);return()=>{Le=!1,clearTimeout(Rt)}},[Rr,rr]);const de=Pt(De,null);return o.jsx(ln,{open:m,onOpenChange:h,children:o.jsxs(sn,{className:"max-w-4xl h-[90vh]",onKeyDown:Le=>Le.stopPropagation(),onKeyDownCapture:Le=>Le.stopPropagation(),onPointerDownOutside:Le=>Le.stopPropagation(),onInteractOutside:Le=>Le.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-2xl font-bold",children:"Modo Balco"}),o.jsx(_n,{children:"Venda rpida para clientes sem mesa."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-6 h-full overflow-hidden pt-4",children:[o.jsxs("div",{className:"col-span-1 flex flex-col border-r border-border pr-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Catlogo de Produtos"}),o.jsx(le,{variant:"outline",size:"sm",onClick:()=>br(!0),children:Hr?o.jsxs(o.Fragment,{children:[o.jsx(Pi,{className:"mr-1 h-4 w-4 text-success"})," Cliente"]}):"Cliente"})]}),o.jsxs("div",{className:"relative mb-4",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar produto...",className:"pl-9",value:rr,onChange:Le=>Gr(Le.target.value),ref:_})]}),o.jsx("div",{className:"flex-1 overflow-y-auto -mr-4 pr-4 thin-scroll",children:o.jsxs("ul",{className:"space-y-2",children:[(me||[]).filter(Le=>{const jt=rr.trim().toLowerCase();return jt?(Le.name||"").toLowerCase().includes(jt)||(Le.code||"").toLowerCase().includes(jt):!0}).sort((Le,jt)=>{const Rt=Le.code||"",Ot=jt.code||"";return/^\d+$/.test(Rt)&&/^\d+$/.test(Ot)?parseInt(Rt,10)-parseInt(Ot,10):Rt.localeCompare(Ot)}).map(Le=>{const jt=(De||[]).reduce((er,_r)=>er+(_r.productId===Le.id?Number(_r.quantity||0):0),0),Rt=Number(Le.stock??Le.currentStock??0),Ot=x.get(Le.id)||0,dr=Math.max(0,Rt-Ot);return o.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors",onClick:()=>{Mn(Le),vn(!0)},children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("p",{className:"font-semibold truncate",title:`${Le.code?`[${Le.code}] `:""}${Le.name}`,children:[Le.code&&o.jsxs("span",{className:"text-text-muted",children:["[",Le.code,"]"]})," ",Le.name]}),jt>0&&o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",jt]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Number(Le.salePrice??Le.price??0).toFixed(2)]}),o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",dr]})]})]}),o.jsx(le,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:er=>{er.stopPropagation(),va(Le)},"aria-label":`Adicionar ${Le.name}`,children:o.jsx(Ga,{size:16})})]},Le.id)}),(!me||me.length===0)&&o.jsxs("li",{className:"text-center text-text-muted py-8",children:[o.jsx("div",{className:"mb-3",children:"Nenhum produto cadastrado. Cadastre produtos para vender no balco."}),o.jsx(le,{size:"sm",onClick:()=>n("/produtos"),children:"Cadastrar Produtos"})]})]})})]}),o.jsxs("div",{className:"col-span-1 flex flex-col",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Comanda do Balco"}),o.jsx("div",{className:"flex-1 overflow-y-auto bg-surface-2 rounded-lg p-4 thin-scroll",children:De.length===0?o.jsx("p",{className:"text-center text-text-muted pt-16",children:"Adicione produtos  comanda."}):o.jsx("ul",{className:"divide-y divide-border",children:De.map(Le=>o.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"font-medium truncate",children:Le.name}),o.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",Le.quantity,"  Unit: R$ ",Number(Le.price||0).toFixed(2)]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"font-semibold mr-2",children:["R$ ",(Number(Le.price||0)*Number(Le.quantity||0)).toFixed(2)]}),o.jsx(le,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{const jt=Number(Le.quantity||1)-1;if(jt<=0)L(Le),re(!0),setTimeout(async()=>{V||await Dn(W)},100);else try{await Wc({itemId:Le.id,quantidade:jt,codigoEmpresa:t?.codigo_empresa}),await Dn(W)}catch(Rt){e({title:"Falha ao atualizar",description:Rt?.message||"Tente novamente",variant:"destructive"})}},children:o.jsx(xv,{size:14})}),o.jsx("span",{className:"w-8 text-center font-semibold",children:Le.quantity}),o.jsx(le,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{try{await Wc({itemId:Le.id,quantidade:Number(Le.quantity||1)+1,codigoEmpresa:t?.codigo_empresa}),await Dn(W)}catch(jt){e({title:"Falha ao atualizar",description:jt?.message||"Tente novamente",variant:"destructive"})}},children:o.jsx(Ga,{size:14})})]})]},Le.id))})}),o.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[o.jsxs("div",{className:"flex justify-between items-center text-xl font-bold mb-4",children:[o.jsx("span",{children:"Total"}),o.jsxs("span",{children:["R$ ",de.toFixed(2)]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs(qd,{children:[o.jsx(yp,{asChild:!0,children:o.jsx(le,{size:"lg",className:"flex-1 bg-red-600 hover:bg-red-500 text-white border border-red-600/70",children:"Cancelar"})}),o.jsxs(Kc,{className:"sm:max-w-[420px] animate-none",onKeyDown:Le=>Le.stopPropagation(),children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Cancelar comanda do balco?"}),o.jsx(Qc,{children:"Os itens sero descartados e o balco ser limpo. Esta ao no pode ser desfeita."})]}),o.jsxs(Xc,{children:[o.jsx(Zc,{children:"Voltar"}),o.jsx(zd,{onClick:async()=>{try{if(!W){h(!1);return}await zq({comandaId:W,codigoEmpresa:t?.codigo_empresa}),bt([]),Ce(null),h(!1),e({title:"Comanda cancelada (balco)",variant:"success"})}catch(Le){e({title:"Falha ao cancelar",description:Le?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Cancelamento"})]})]})]}),o.jsxs(le,{size:"lg",className:"flex-1",onClick:Ea,disabled:He||de<=0,children:[o.jsx(Ui,{className:"mr-2"})," Finalizar Pagamento"]})]})]})]})]}),Rr&&o.jsx("div",{className:"absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center",onClick:Le=>{Le.target===Le.currentTarget&&br(!1)},onKeyDown:Le=>{Le.key==="Escape"&&br(!1)},children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-lg w-full max-w-md p-4",role:"dialog","aria-modal":"true",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h4",{className:"text-lg font-semibold",children:"Selecionar Cliente"}),o.jsx(le,{variant:"ghost",size:"sm",onClick:()=>br(!1),children:"Fechar"})]}),o.jsxs("div",{className:"relative mb-2",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:rr,onChange:Le=>Gr(Le.target.value)})]}),o.jsx("div",{className:"max-h-64 overflow-auto thin-scroll border rounded-md",children:tn?o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Carregando clientes..."}):wr.length>0?o.jsx("ul",{children:wr.map(Le=>o.jsxs("li",{className:Jt("p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2",Hr===Le.id&&"bg-surface-2"),onClick:()=>on(Le.id),children:[o.jsx("div",{children:o.jsxs("div",{className:"font-medium",children:[Le.codigo!=null?String(Le.codigo)+" - ":"",Le.nome]})}),Hr===Le.id&&o.jsx(Pi,{size:16,className:"text-success"})]},Le.id))}):o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum cliente encontrado."})})]})})]})})},ya=()=>{const de=Zn,Le=de&&oa.get(de.id)||0,jt=de?Number(de.salePrice??de.price??0):0,Rt=Ot=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Ot||0));return o.jsx(ln,{open:jn,onOpenChange:Ot=>{vn(Ot),Ot||Mn(null)},children:o.jsxs(sn,{overlayClassName:"z-[60]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[61]",onKeyDown:Ot=>Ot.stopPropagation(),onPointerDownOutside:Ot=>Ot.stopPropagation(),onInteractOutside:Ot=>Ot.stopPropagation(),onEscapeKeyDown:Ot=>{Ot.preventDefault(),Ot.stopPropagation()},children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-xl font-bold break-words",title:de?.name||"",children:de?.name||"Produto"}),o.jsx(_n,{children:"Detalhes do produto (Balco)."})]}),de?o.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),o.jsx("span",{className:"text-sm font-semibold",children:Rt(jt)})]}),de.category?o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),o.jsx("span",{className:"text-sm font-medium",children:de.category})]}):null,o.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof de.stock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),o.jsx("div",{className:"text-base font-semibold",children:de.stock})]}),typeof de.minStock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),o.jsx("div",{className:"text-base font-semibold",children:de.minStock})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),o.jsxs("div",{className:"text-base font-semibold",children:["x",Le]})]})]})]}):null,o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsxs(le,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{de&&n("/produtos",{state:{productId:de.id,productName:de.name}})},children:[o.jsx(rs,{className:"w-4 h-4"}),o.jsx("span",{children:"Info"})]}),o.jsx(le,{variant:"outline",onClick:()=>{vn(!1),Mn(null)},children:"Fechar"}),o.jsx(le,{onClick:async()=>{de&&(await va(de),vn(!1),Mn(null))},children:"Adicionar"})]})]})})},Mo=()=>{const[de,Le]=p.useState(""),[jt,Rt]=p.useState(!1),[Ot,dr]=p.useState([]),[er,_r]=p.useState([]),[ne,ie]=p.useState(0),[Ye,ze]=p.useState(!1),[Ke,rt]=p.useState(0),oe=p.useRef([]),st=p.useRef(null),Ve=p.useRef(null),Qe=p.useRef(null),qt=p.useRef(null),O=p.useRef(0),H=p.useRef(0);p.useEffect(()=>{let ve=!0;return(async()=>{try{Rt(!0);const et=await kj({searchTerm:de,limit:20});if(!ve)return;const zt=(et||[]).slice(),nr=String(de||"").trim().toLowerCase(),Et=Gt=>{const Nr=String(Gt?.nome||"").toLowerCase();return nr?Nr.startsWith(nr)?0:Nr.includes(nr)?1:2:2};zt.sort((Gt,Nr)=>{const tr=Et(Gt),ar=Et(Nr);if(tr!==ar)return tr-ar;const sr=Number(Gt?.codigo||0),xr=Number(Nr?.codigo||0);return sr-xr}),dr(zt),rt(0)}catch{if(!ve)return;dr([])}finally{ve&&Rt(!1)}})(),()=>{ve=!1}},[de]);const _e=p.useRef(!1);p.useEffect(()=>{try{Z&&!_e.current&&(_e.current=!0,Qe.current&&(Qe.current.scrollTop=0),st.current&&(st.current.scrollTop=0),Ve.current&&(Ve.current.scrollTop=0)),Z||(_e.current=!1)}catch{}},[Z]),p.useEffect(()=>{try{Z&&Array.isArray(Ot)&&Ot.length>0&&(rt(0),setTimeout(()=>{try{st.current?.focus(),Ve.current&&(Ve.current.scrollTop=0)}catch{}},0))}catch{}},[Z,Ot.length]);const Oe=async(ve=null)=>{try{if(!lt)return;const Xe=await PGe({mesaId:lt.id,codigoEmpresa:t?.codigo_empresa}),zt=Array.isArray(ve)?ve:er,nr=Array.isArray(zt)?Array.from(new Set(zt)):[];let Et=[],Gt=Math.max(0,Number(ne||0));nr.length===0&&Gt===0&&(Gt=1);for(let ar=0;ar<Gt;ar++)Et.push("Consumidor");console.log("[confirmOpen] Chamando adicionarClientesAComanda com:",{comandaId:Xe.id,clienteIds:nr,nomesLivres:Et}),await Kv({comandaId:Xe.id,clienteIds:nr,nomesLivres:Et,codigoEmpresa:t?.codigo_empresa,replace:!0});let Nr=null;try{const ar=await Qi({comandaId:Xe.id,codigoEmpresa:t?.codigo_empresa}),xr=(Array.isArray(ar)?ar:[]).map(St=>St?.nome).filter(Boolean);Nr=xr.length?xr.join(", "):null}catch(ar){console.warn("[confirmOpen] Erro ao buscar vnculos:",ar)}if(!Nr){const ar=Array.isArray(nr)?nr:[],sr=Array.isArray(Ot)?Ot:[];Nr=ar.length?ar.map(xr=>sr.find(St=>St.id===xr)?.nome).filter(Boolean).join(", "):Et.length>0?Et.join(", "):""}console.log("[confirmOpen] displayName calculado:",{displayName:Nr,nomesLivres:Et,clienteIds:nr});const tr={...lt,comandaId:Xe.id,status:"in-use",customer:Nr||null,order:[]};l(tr),i(ar=>ar.map(sr=>sr.id===tr.id?tr:sr)),await new Promise(ar=>setTimeout(ar,500));try{const ar=await bp(t?.codigo_empresa),sr=await sc({codigoEmpresa:t?.codigo_empresa}),xr={},St={},Lr=Array.isArray(sr)?sr:[];await Promise.all(Lr.map(async gn=>{try{const wa=await Qi({comandaId:gn.id,codigoEmpresa:t?.codigo_empresa}),ca=(Array.isArray(wa)?wa:[]).map(oi=>oi?.nome).filter(Boolean);xr[gn.id]=ca.length?ca.join(", "):null,console.log("[confirmOpen] Clientes da comanda",gn.id,":",{vincs:wa,nomes:ca,resultado:xr[gn.id]});const da=await Si({comandaId:gn.id,codigoEmpresa:t?.codigo_empresa}),Oi=(Array.isArray(da)?da:[]).reduce((oi,Da)=>{const go=(Da.quantidade||0)*(Da.preco_unitario||0)-(Da.desconto||0);return oi+go},0);St[gn.id]=Oi}catch(wa){console.warn("[confirmOpen] Erro ao buscar dados da comanda:",wa),xr[gn.id]=null,St[gn.id]=0}}));const Fr=(ar||[]).map(gn=>{const wa=(sr||[]).find(ca=>ca.mesa_id===gn.id),$n=wa?xr[wa.id]!==null?xr[wa.id]:Nr:null;return{id:gn.id,name:gn.nome||`Mesa ${gn.numero}`,status:wa?"in-use":"available",comandaId:wa?.id||null,customer:$n,order:[],totalHint:wa&&St[wa.id]||0,aberto_em:wa?.aberto_em||null}});i(Fr)}catch(ar){console.error("[confirmOpen] Erro ao atualizar mesas:",ar)}Y(!1),gt(null),at(""),_r([]),ie(0),ze(!1),e({title:"Mesa aberta",description:Nr?`Comanda criada para: ${Nr}`:"Comanda criada.",variant:"success"})}catch(Xe){try{console.error("[confirmOpen] Falha ao abrir mesa:",Xe?.message||Xe,Xe?.stack),console.log("[confirmOpen] Contexto debug:",{pendingTable:lt,consumidorCount:ne,selectedClientIds:er,clienteIdsType:Array.isArray(er)})}catch{}e({title:"Falha ao abrir mesa",description:Xe?.message||"Tente novamente",variant:"destructive"})}};return o.jsx(ln,{open:Z,onOpenChange:ve=>{Y(ve),ve||(gt(null),at(""),_r([]),ie(0),ze(!1))},children:o.jsxs(sn,{className:"w-[95vw] max-w-md h-[560px] max-h-[75vh] flex flex-col animate-none overflow-hidden",onOpenAutoFocus:ve=>ve.preventDefault(),onPointerDownOutside:ve=>{ve.preventDefault(),ve.stopPropagation()},onInteractOutside:ve=>{ve.preventDefault(),ve.stopPropagation()},onEscapeKeyDown:ve=>{ve.preventDefault(),Y(!1)},onKeyDown:ve=>{ve.key==="Escape"&&(ve.preventDefault(),ve.stopPropagation(),Y(!1))},ref:Qe,children:[o.jsxs(an,{className:"flex-shrink-0",children:[o.jsxs(nn,{className:"text-xl font-bold",children:["Abrir Mesa ",lt?`#${lt.number}`:""]}),o.jsx(_n,{className:"text-sm",children:"Selecione um ou mais clientes para a mesa."})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto thin-scroll min-h-0 space-y-2 py-2",ref:Ve,children:[o.jsxs("div",{children:[o.jsx(Ht,{className:"text-sm font-medium mb-1.5 block",children:"Buscar cliente"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(hi,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Nome, telefone ou cdigo",className:"pl-8 h-9 text-sm",value:de,ref:qt,onChange:ve=>{H.current=Date.now(),Le(ve.target.value)},onKeyDown:ve=>{if(ve.key==="Enter"){ve.preventDefault();try{if(Array.isArray(Ot)&&Ot.length>0){const Xe=Math.min(Math.max(Ke||0,0),Ot.length-1),et=Ot[Xe];et?.id&&_r(zt=>zt.includes(et.id)?zt.filter(nr=>nr!==et.id):[...zt,et.id])}}catch{}Le(""),setTimeout(()=>{try{st.current?.focus()}catch{}},0)}else H.current=Date.now()}})]}),o.jsx(le,{type:"button",size:"icon",title:"Cadastrar cliente",className:"h-9 w-9 flex-shrink-0 bg-brand text-black hover:bg-brand/90",onClick:()=>{window.location.href="/clientes"},children:o.jsx(Ga,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"mt-1.5 text-[12px] text-text-muted flex items-center gap-2",children:[o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," seleciona"]}),o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," desmarca"]}),o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:"Enter"})," confirma"]}),o.jsx("span",{className:"inline-flex items-center gap-1",children:"Digite para buscar"})]})]}),o.jsx("div",{className:"min-h-[8px]",children:er.length>0&&o.jsxs("div",{className:"bg-success/10 border border-success/30 rounded-md p-2.5",children:[o.jsxs("div",{className:"text-xs font-medium text-success mb-1",children:[er.length," cliente",er.length>1?"s":""," selecionado",er.length>1?"s":""]}),o.jsx("div",{className:"text-sm text-text-primary",children:Ot.filter(ve=>er.includes(ve.id)).map(ve=>ve.nome).join(", ")})]})}),o.jsx("div",{className:"border rounded-md focus:outline-none focus:ring-0 focus-visible:outline-none focus-visible:ring-0",role:"listbox","aria-label":"Clientes","aria-activedescendant":Ot&&Ot.length>0&&Ot[Ke]&&Ot[Ke].id?`ot-option-${Ot[Ke].id}`:void 0,ref:st,tabIndex:0,onKeyDown:ve=>{try{if(ve.key&&ve.key.length===1&&!ve.ctrlKey&&!ve.metaKey&&!ve.altKey||ve.key==="Backspace"){ve.preventDefault(),ve.stopPropagation();let et=String(de||"");ve.key==="Backspace"?et=et.slice(0,-1):et+=ve.key,Le(et),H.current=Date.now();try{Ve.current&&(Ve.current.scrollTop=0)}catch{}setTimeout(()=>{try{if(qt.current){qt.current.focus();const zt=et.length;qt.current.setSelectionRange?.(zt,zt)}}catch{}},0);return}if(["ArrowDown","ArrowUp","Home","End","ArrowRight","ArrowLeft"," "].includes(ve.key)){let et=Ke||0;const zt=Ot.length;ve.key==="ArrowDown"&&(et=Math.min(et+1,zt-1)),ve.key==="ArrowUp"&&(et=Math.max(et-1,0)),ve.key==="Home"&&(et=0),ve.key==="End"&&(et=zt-1),rt(et),setTimeout(()=>{try{oe.current[et]?.scrollIntoView({block:"nearest"})}catch{}},0);const nr=Ot[et],Et=nr?.codigo===0;if(ve.key==="ArrowRight"&&nr?.id&&(Et?(ze(!0),ie(Gt=>Gt+1)):(at(""),_r(Gt=>Gt.includes(nr.id)?Gt:[...Gt,nr.id]))),ve.key==="ArrowLeft"&&nr?.id)if(Et){const Gt=Math.max(0,ne-1);ie(Gt),Gt===0&&ze(!1)}else _r(Gt=>Gt.filter(Nr=>Nr!==nr.id));ve.key===" "&&nr?.id&&(at(""),_r(Gt=>Gt.includes(nr.id)?Gt.filter(Nr=>Nr!==nr.id):[...Gt,nr.id]));return}if(ve.key==="Enter"){ve.preventDefault();const et=Math.min(Math.max(Ke||0,0),Ot.length-1),zt=Ot[et];if(Date.now()-H.current<600||document.activeElement===qt.current||de&&de.length>0){zt?.id&&(at(""),_r(Gt=>Gt.includes(zt.id)?Gt.filter(Nr=>Nr!==zt.id):[...Gt,zt.id])),Le(""),setTimeout(()=>{try{st.current?.focus(),Ve.current&&(Ve.current.scrollTop=0)}catch{}},0);return}if(zt?.id){const Gt=er.includes(zt.id)?er:[...er,zt.id];er.includes(zt.id)||_r(Nr=>[...Nr,zt.id]),setTimeout(()=>{try{Oe(Gt)}catch{}},0);return}setTimeout(()=>{try{Oe(er)}catch{}},0);return}}catch{}},children:jt?o.jsx("div",{className:"p-3 text-center text-sm text-text-muted",children:"Carregando..."}):Ot.length>0?o.jsx("ul",{className:"divide-y divide-border",children:Ot.map((ve,Xe)=>{const et=ve.codigo===0,zt=er.includes(ve.id),nr=Xe===(Ke||0),Et=et?ne:0;return o.jsxs("li",{id:`ot-option-${ve.id}`,ref:Gt=>{oe.current[Xe]=Gt},role:"option","aria-selected":nr,className:Jt("p-2.5 flex items-center gap-2 cursor-pointer transition-colors outline-none focus:outline-none focus-visible:outline-none border border-transparent",et?"bg-amber-500/5 border-l-2 border-l-amber-500/40":"",zt&&!et?"bg-success/10 hover:bg-success/15":"hover:bg-surface-2",Ye&&et?"bg-amber-500/10":"",nr?"bg-brand/10":""),onClick:()=>{et?Ye||(ze(!0),ie(1)):(at(""),_r(Gt=>Gt.includes(ve.id)?Gt.filter(Nr=>Nr!==ve.id):[...Gt,ve.id]))},onDoubleClick:()=>{if(!et){const Gt=er.includes(ve.id)?er:[...er,ve.id];_r(Gt),setTimeout(()=>{try{Oe(Gt)}catch{}},0)}},onMouseEnter:()=>{Date.now()-(O.current||0)>300&&rt(Xe)},tabIndex:-1,children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[!et&&o.jsx("span",{className:Jt("w-2 h-2 rounded-full flex-shrink-0",zt?"bg-success":nr?"bg-brand":"bg-border")}),o.jsxs("div",{className:"font-medium text-sm truncate",children:[ve.codigo!=null&&ve.codigo!==0?`${ve.codigo} - `:"",ve.nome,et&&o.jsx("span",{className:"ml-2 text-xs text-amber-600",children:"Cliente Padro"})]})]}),et?Ye?o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[o.jsx(le,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-red-500/10",onClick:Gt=>{Gt.stopPropagation();const Nr=Math.max(0,ne-1);ie(Nr),Nr===0&&ze(!1)},children:o.jsx(xv,{className:"h-4 w-4"})}),o.jsx("div",{className:"w-8 h-7 flex items-center justify-center bg-surface-2 rounded text-sm font-medium",children:Et}),o.jsx(le,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-500/10",onClick:Gt=>{Gt.stopPropagation(),ie(Nr=>Nr+1)},children:o.jsx(Ga,{className:"h-4 w-4"})})]}):null:o.jsx("div",{className:"ml-2 flex-shrink-0",children:zt?o.jsx(Pi,{size:18,className:"text-success"}):o.jsx("div",{className:"w-[18px] h-[18px] rounded-full border-2 border-border"})})]},ve.id)})}):o.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Nenhum cliente encontrado"})})]}),o.jsxs(Un,{className:"flex-shrink-0 pt-3",children:[o.jsx(le,{type:"button",variant:"outline",onClick:()=>{Y(!1),gt(null),at(""),_r([])},children:"Cancelar"}),o.jsx(le,{onClick:()=>Oe(),disabled:!lt,children:"Confirmar Abertura"})]})]})})},vi=()=>{const[de,Le]=p.useState("");return p.useEffect(()=>{It.current&&Le(It.current)},[]),o.jsxs(o.Fragment,{children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Abrir Caixa"}),o.jsx(Qc,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),o.jsxs("div",{className:"py-4",children:[o.jsx(Ht,{htmlFor:"initial-value",children:"Valor Inicial"}),o.jsxs("div",{className:"relative mt-2",children:[o.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted",children:"R$"}),o.jsx(ir,{id:"initial-value",type:"text",inputMode:"numeric",pattern:"[0-9.,]*",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:!1,name:"cash-open-initial",placeholder:"0,00",className:"pl-9 font-semibold",value:de,onChange:jt=>{const Rt=(jt.target.value||"").replace(/\D/g,""),Ot=Rt?Number(Rt)/100:0,dr=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Ot);Le(dr),It.current=dr},onKeyDown:jt=>{jt.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(jt.key)&&(/^[0-9]$/.test(jt.key)||jt.preventDefault())},onBeforeInput:jt=>{const Rt=jt.data??"";Rt&&/\D/.test(Rt)&&jt.preventDefault()},onMouseDown:jt=>jt.stopPropagation()})]})]}),o.jsxs(Xc,{children:[o.jsx(Zc,{onClick:()=>Pe(!1),children:"Cancelar"}),o.jsx(zd,{onClick:async()=>{if(!Dt){kt(!0);try{const jt=String(de).replace(/\./g,"").replace(",","."),Rt=Number(jt)||0;try{localStorage.setItem("cash:opening",String(Date.now()))}catch{}await hf({saldoInicial:Rt,codigoEmpresa:t?.codigo_empresa}),await Ur(),await ot({showToast:!1}),Pe(!1),e({title:"Caixa aberto com sucesso!",variant:"success"}),It.current="",Le("")}catch(jt){e({title:"Falha ao abrir caixa",description:jt?.message||"Tente novamente",variant:"destructive"})}finally{try{localStorage.removeItem("cash:opening")}catch{}kt(!1)}}},children:"Confirmar Abertura"})]})]})},oo=()=>o.jsxs(qd,{open:$e,onOpenChange:Pe,children:[o.jsx(yp,{asChild:!0,children:o.jsxs(le,{variant:"success",size:"sm",disabled:c||Dt,onClick:()=>Pe(!0),className:"px-3",children:[o.jsx(yH,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"}),o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-emerald-700 border border-emerald-800 rounded shadow-sm",children:"F10"})]})}),o.jsx(Kc,{className:"sm:max-w-[425px] animate-none",onKeyDown:de=>de.stopPropagation(),onKeyDownCapture:de=>de.stopPropagation(),onEscapeKeyDown:de=>de.preventDefault(),onPointerDownOutside:de=>{de.preventDefault(),de.stopPropagation()},onInteractOutside:de=>{de.preventDefault(),de.stopPropagation()},children:o.jsx(vi,{})})]}),zl=()=>{const[de,Le]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[jt,Rt]=p.useState(!1),[Ot,dr]=p.useState(!1),[er,_r]=p.useState(!1),[ne,ie]=p.useState(!1),[Ye,ze]=p.useState(""),Ke=async()=>{try{Le({loading:!0,saldoInicial:0,resumo:null});const Ve=await Dm({codigoEmpresa:t?.codigo_empresa}),Qe=await w1({codigoEmpresa:t?.codigo_empresa});Le({loading:!1,saldoInicial:Number(Ve?.saldo_inicial||0),resumo:Qe||{totalPorFinalizadora:{}}})}catch{Le({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},rt=de?.resumo?.totalPorFinalizadora||{},oe=Object.values(rt).reduce((Ve,Qe)=>Ve+Number(Qe||0),0),st=Number(de.saldoInicial||0)+oe;return o.jsxs(o.Fragment,{children:[o.jsxs(qd,{open:jt,onOpenChange:Ve=>{Rt(Ve),Ve&&Ke()},children:[o.jsx(yp,{asChild:!0,children:o.jsxs(le,{variant:"destructive",size:"sm",disabled:!c,onClick:()=>Rt(!0),className:"px-3",children:[o.jsx(sx,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Fechar"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Fechar Caixa"})]})}),o.jsxs(Kc,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:Ve=>Ve.preventDefault(),onKeyDown:Ve=>Ve.stopPropagation(),onKeyDownCapture:Ve=>Ve.stopPropagation(),onPointerDownOutside:Ve=>{Ve.preventDefault(),Ve.stopPropagation()},onInteractOutside:Ve=>{Ve.preventDefault(),Ve.stopPropagation()},children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Fechar Caixa"}),o.jsx(Qc,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),er&&o.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[o.jsx(pc,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),de.loading?o.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):o.jsxs("div",{className:"py-4 space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor Inicial:"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(de.saldoInicial||0).toFixed(2)]})]}),Object.keys(rt).length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):Object.entries(rt).map(([Ve,Qe])=>o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("span",{className:"text-text-secondary",children:[String(Ve),":"]})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(Qe||0).toFixed(2)]})]},Ve)),o.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[o.jsx("span",{className:"text-text-primary",children:"Total em Caixa:"})," ",o.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(st||0).toFixed(2)]})]})]}),o.jsxs(Xc,{children:[o.jsx(Zc,{onClick:()=>Rt(!1),disabled:ne,children:"Cancelar"}),o.jsx(zd,{onClick:()=>{dr(!0)},disabled:ne,children:"Continuar"})]})]})]}),o.jsx(qd,{open:Ot,onOpenChange:Ve=>{ne||dr(Ve)},children:o.jsxs(Kc,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:Ve=>Ve.preventDefault(),onEscapeKeyDown:Ve=>{ne||Ve.preventDefault()},onKeyDown:Ve=>Ve.stopPropagation(),onKeyDownCapture:Ve=>Ve.stopPropagation(),onPointerDownOutside:Ve=>{ne||(Ve.preventDefault(),Ve.stopPropagation())},onInteractOutside:Ve=>{ne||(Ve.preventDefault(),Ve.stopPropagation())},children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Confirmar Fechamento do Caixa"}),o.jsx(Qc,{children:"Informe o saldo final para finalizar o fechamento."})]}),o.jsxs("div",{className:"py-4",children:[o.jsx(Ht,{htmlFor:"valor-contado-final",className:"text-sm font-medium text-text-primary mb-2 block",children:"Saldo Final (opcional)"}),o.jsx("input",{id:"valor-contado-final",type:"text",placeholder:"R$ 0,00",value:Ye,onChange:Ve=>{let Qe=Ve.target.value.replace(/\D/g,"");Qe.length>0&&(Qe=(Number(Qe)/100).toFixed(2),Qe=Qe.replace(".",","),Qe="R$ "+Qe),ze(Qe)},className:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),o.jsxs(Xc,{children:[o.jsx(Zc,{onClick:()=>{dr(!1)},disabled:ne,children:"Voltar"}),o.jsx(zd,{onClick:async()=>{try{if(ne)return;ie(!0);const Ve=Number(de.saldoInicial||0)+oe,Qe=Ye?Number(Ye.replace(/[^0-9,]/g,"").replace(",",".")):null;await Zte({saldoFinal:Ve,valorFinalDinheiro:Qe,codigoEmpresa:t?.codigo_empresa}),d(!1),typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{dr(!1),Rt(!1),ze(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${Ve.toFixed(2)}`,duration:4e3})}):(dr(!1),Rt(!1),ze(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${Ve.toFixed(2)}`,duration:4e3})),setTimeout(async()=>{try{await Dm({codigoEmpresa:t?.codigo_empresa})}catch{}},0)}catch(Ve){console.error(Ve);const Qe=Ve?.message||"Tente novamente";if(Ee){$t(Qe.includes("Existem")?Qe:`Falha ao fechar caixa: ${Qe}`);try{dr(!1),Rt(!1)}catch{}typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{mt(!0)}):mt(!0),setTimeout(()=>mt(!1),2600)}else e({title:"Falha ao fechar caixa",description:Qe,variant:"destructive"})}finally{ie(!1)}},children:"Confirmar Fechamento"})]})]})})]})},yl=()=>{const[de,Le]=p.useState(""),[jt,Rt]=p.useState([]),[Ot,dr]=p.useState([]),[er,_r]=p.useState(!1),[ne,ie]=p.useState(new Set),Ye=p.useRef([]),ze=p.useRef(!1),Ke=p.useRef(!1),[rt,oe]=p.useState(0);p.useRef([]);const st=p.useRef(null);p.useRef(0);const[Ve,Qe]=p.useState(!1),[qt,O]=p.useState(null),[H,_e]=p.useState(null),[Oe,ve]=p.useState("");p.useEffect(()=>{let tr=!0;const ar=async()=>{if(!(!ce||!s?.comandaId)&&!(ze.current&&de===""))try{_r(!0);const sr=await Qi({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa});if(!tr)return;console.log("[ManageClientsDialog] Clientes da comanda:",sr);const xr=(sr||[]).map(Fr=>({id:Fr.id,cliente_id:Fr.cliente_id,nome:Fr.nome||"",tipo:Fr.tipo||(Fr.cliente_id?"cadastrado":"livre")}));console.log("[ManageClientsDialog] Linked mapeado:",xr),Ke.current||(dr(xr),Ye.current=JSON.parse(JSON.stringify(xr)),ie(new Set));const St=await kj({searchTerm:de,limit:50});if(!tr)return;const Lr=(St||[]).slice().sort((Fr,gn)=>Number(Fr?.codigo||0)-Number(gn?.codigo||0));Rt(Lr),oe(0),ze.current=!0}catch(sr){console.error("Erro ao carregar clientes:",sr)}finally{tr&&_r(!1)}};return ce?(ar(),()=>{tr=!1}):(ze.current=!1,Le(""),()=>{tr=!1})},[ce,s?.comandaId]),p.useEffect(()=>{Ke.current=ne.size>0},[ne]),p.useEffect(()=>{ce&&Array.isArray(jt)&&jt.length>0&&(oe(0),setTimeout(()=>{try{const tr=document.querySelector('[role="dialog"]');if(tr){const ar=tr.querySelector(".overflow-y-auto");ar&&(ar.scrollTop=0)}}catch{}},0))},[ce,jt.length]);const Xe=()=>{s?.comandaId&&(async()=>{try{_r(!0);const{data:tr,error:ar}=await pe.from("comanda_clientes").insert({comanda_id:s.comandaId,nome_livre:"Consumidor",codigo_empresa:t?.codigo_empresa}).select("id, cliente_id, nome_livre").single();if(ar)throw ar;const sr={id:tr.id,cliente_id:tr.cliente_id,nome:tr.nome_livre||"Consumidor",tipo:"livre"};dr(xr=>[...xr,sr]),_e(sr.id),ve(sr.nome||"Consumidor")}catch(tr){console.error("[ManageClientsDialog] Erro ao adicionar consumidor:",tr),e({title:"Falha ao adicionar consumidor",description:tr?.message||"Tente novamente",variant:"destructive"})}finally{_r(!1)}})()},et=tr=>{if(!s?.comandaId)return;const ar=jt.find(sr=>sr.id===tr);ar&&(async()=>{try{_r(!0);const{data:sr,error:xr}=await pe.from("comanda_clientes").insert({comanda_id:s.comandaId,cliente_id:tr,codigo_empresa:t?.codigo_empresa}).select("id, cliente_id").single();if(xr)throw xr;const St={id:sr.id,cliente_id:sr.cliente_id,nome:ar.nome,tipo:"cadastrado"};dr(Lr=>[...Lr,St]),Qe(!1)}catch(sr){console.error("[ManageClientsDialog] Erro ao adicionar cliente:",sr),e({title:"Falha ao adicionar cliente",description:sr?.message||"Tente novamente",variant:"destructive"})}finally{_r(!1)}})()},zt=(tr,ar)=>{if(!s?.comandaId)return;const sr=jt.find(St=>St.id===ar);!sr||!Ot.find(St=>St.id===tr)||(async()=>{try{_r(!0);const{error:St}=await pe.from("comanda_clientes").update({cliente_id:ar}).eq("id",tr).eq("codigo_empresa",t?.codigo_empresa);if(St)throw St;dr(Lr=>Lr.map(Fr=>Fr.id===tr?{...Fr,cliente_id:ar,nome:sr.nome,tipo:"cadastrado"}:Fr)),O(null),Qe(!1)}catch(St){console.error("[ManageClientsDialog] Erro ao trocar cliente:",St),e({title:"Falha ao trocar cliente",description:St?.message||"Tente novamente",variant:"destructive"})}finally{_r(!1)}})()},nr=tr=>{const ar=Ot.find(sr=>sr.id===tr);ar&&(dr(sr=>sr.filter(xr=>xr.id!==tr)),!(!s?.comandaId||String(tr).startsWith("temp-"))&&(async()=>{try{_r(!0);const{error:sr}=await pe.from("comanda_clientes").delete().eq("id",tr).eq("codigo_empresa",t?.codigo_empresa);if(sr)throw sr}catch(sr){console.error("[ManageClientsDialog] Erro ao remover cliente:",sr),e({title:"Falha ao remover cliente",description:sr?.message||"Tente novamente",variant:"destructive"}),dr(xr=>[...xr,ar])}finally{_r(!1)}})())},Et=tr=>{const ar=Ot.find(sr=>sr.id===tr);ar&&(_e(tr),ve(ar.nome||"Consumidor"))},Gt=()=>{if(!H||!s?.comandaId)return;const tr=Oe.trim()||"Consumidor";(async()=>{try{_r(!0);const{error:ar}=await pe.from("comanda_clientes").update({nome_livre:tr}).eq("id",H).eq("codigo_empresa",t?.codigo_empresa);if(ar)throw ar;dr(sr=>sr.map(xr=>xr.id===H?{...xr,nome:tr}:xr))}catch(ar){console.error("[ManageClientsDialog] Erro ao salvar consumidor:",ar),e({title:"Falha ao salvar cliente",description:ar?.message||"Tente novamente",variant:"destructive"})}finally{_e(null),ve(""),_r(!1)}})()},Nr=async()=>{if(!s?.comandaId){fe(!1);return}if(ne.size===0){fe(!1);return}_r(!0);try{const tr=Ye.current.map(Lr=>Lr.id),ar=Ot.map(Lr=>Lr.id),sr=Ye.current.filter(Lr=>!ar.includes(Lr.id));for(const Lr of sr)if(!String(Lr.id).startsWith("temp-")){const{error:Fr}=await pe.from("comanda_clientes").delete().eq("id",Lr.id).eq("codigo_empresa",t?.codigo_empresa);if(Fr)throw console.error("[confirmChanges] Erro ao remover:",Fr),Fr}const xr=Ot.filter(Lr=>String(Lr.id).startsWith("temp-")),St=Ot.filter(Lr=>{if(String(Lr.id).startsWith("temp-")||Lr.tipo!=="livre")return!1;const Fr=Ye.current.find(gn=>gn.id===Lr.id);return Fr&&Fr.nome!==Lr.nome});if(xr.length>0){const Lr=xr.filter(gn=>gn.tipo==="cadastrado").map(gn=>gn.cliente_id),Fr=xr.filter(gn=>gn.tipo==="livre").map(gn=>gn.nome);console.log("[confirmChanges] Adicionando:",{clienteIds:Lr,nomesLivres:Fr}),await Kv({comandaId:s.comandaId,clienteIds:Lr,nomesLivres:Fr,codigoEmpresa:t?.codigo_empresa})}for(const Lr of St){const{error:Fr}=await pe.from("comanda_clientes").update({nome_livre:Lr.nome}).eq("id",Lr.id).eq("codigo_empresa",t?.codigo_empresa);if(Fr)throw console.error("[confirmChanges] Erro ao atualizar:",Fr),Fr}console.log("[confirmChanges] Operaes concludas, atualizando mesa"),await jr(s),await ot({showToast:!1}),e({title:"Clientes atualizados",variant:"success"})}catch(tr){console.error("[confirmChanges] Erro:",tr),e({title:"Falha ao atualizar clientes",description:tr?.message||"Tente novamente",variant:"destructive"})}finally{_r(!1)}};return o.jsxs(ln,{open:ce,onOpenChange:fe,children:[o.jsxs(sn,{className:"sm:max-w-[480px] w-[92vw] max-h-[85vh] h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:tr=>tr.preventDefault(),onPointerDownOutside:tr=>{tr.preventDefault(),tr.stopPropagation()},onInteractOutside:tr=>{tr.preventDefault(),tr.stopPropagation()},onEscapeKeyDown:tr=>tr.preventDefault(),children:[o.jsxs(an,{className:"flex-shrink-0",children:[o.jsx(nn,{children:"Gerenciar Clientes da Mesa"}),o.jsx(_n,{children:"Gerencie os clientes vinculados a esta mesa."})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-4 thin-scroll",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"text-sm font-medium text-text-primary",children:["Clientes vinculados (",Ot.length,"):"]}),er&&Ot.length===0?o.jsx("div",{className:"p-4 text-center text-sm text-text-muted border border-dashed rounded-md",children:"Carregando clientes da mesa..."}):Ot.length===0?o.jsx("div",{className:"p-4 text-center text-sm text-text-muted border border-dashed rounded-md",children:"Nenhum cliente vinculado ainda"}):o.jsx("div",{className:"space-y-2",children:Ot.map(tr=>{const ar=tr.tipo==="livre",sr=H===tr.id;return o.jsx("div",{className:Jt("flex items-center gap-2 p-2 rounded-md border",ar?"bg-amber-500/10 border-amber-500/30":"bg-surface-2 border-border"),children:sr?o.jsxs(o.Fragment,{children:[o.jsx(ir,{value:Oe,onChange:xr=>ve(xr.target.value),onKeyDown:xr=>{xr.key==="Enter"&&Gt(),xr.key==="Escape"&&(_e(null),ve("")),xr.stopPropagation()},className:"flex-1 h-8",autoFocus:!0}),o.jsx(le,{size:"sm",onClick:Gt,className:"h-8 px-2",children:o.jsx(Pi,{className:"h-4 w-4"})})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:Jt("flex-1 text-sm truncate p-1 rounded",ar?"cursor-pointer hover:bg-amber-500/10":"cursor-default"),onClick:()=>ar&&Et(tr.id),title:ar?"Clique para editar":"",children:[o.jsx("span",{children:tr.nome}),ar&&o.jsx("span",{className:"ml-2 text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30 align-middle",children:"Cliente Padro"})]}),!ar&&o.jsx(le,{size:"sm",variant:"ghost",onClick:()=>{O(tr.id),Qe(!0)},className:"h-7 px-2",title:"Trocar cliente",children:o.jsx(ll,{className:"h-4 w-4"})}),o.jsx(le,{size:"sm",variant:"ghost",onClick:()=>nr(tr.id),className:"h-7 px-2 text-destructive hover:text-destructive",children:o.jsx(Dl,{className:"h-4 w-4"})})]})},tr.id)})})]}),o.jsxs(le,{onClick:()=>{O(null),Qe(!0)},className:"w-full",size:"sm",children:[o.jsx(Ga,{className:"h-4 w-4 mr-2"}),"Adicionar Cliente"]})]}),o.jsxs(Un,{children:[o.jsx(le,{variant:"outline",onClick:()=>fe(!1),disabled:er,children:"Cancelar"}),o.jsx(le,{onClick:Nr,disabled:er,children:er?"Salvando...":`Confirmar ${ne.size>0?`(${ne.size} alteraes)`:""}`})]})]}),o.jsx(ln,{open:Ve,onOpenChange:Qe,children:o.jsxs(sn,{className:"sm:max-w-[500px] max-h-[80vh] flex flex-col",children:[o.jsxs(an,{children:[o.jsx(nn,{children:qt?"Trocar Cliente":"Adicionar Cliente"}),o.jsx(_n,{children:"Selecione um cliente da lista"})]}),o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col gap-3",children:[o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar cliente...",className:"pl-9",value:de,onChange:tr=>Le(tr.target.value)})]}),o.jsx("div",{className:"flex-1 border rounded-md overflow-y-auto thin-scroll",role:"listbox","aria-label":"Clientes disponveis",ref:st,tabIndex:0,children:er?o.jsx("div",{className:"p-4 text-center text-text-muted",children:"Carregando..."}):jt.length===0?o.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhum cliente encontrado"}):o.jsx("ul",{className:"divide-y divide-border",children:jt.map(tr=>{const ar=tr.codigo===0,sr=Ot.some(xr=>xr.cliente_id===tr.id&&xr.tipo==="cadastrado");return o.jsxs("li",{className:Jt("p-3 cursor-pointer transition-colors flex items-center justify-between",ar?"bg-amber-500/5 hover:bg-amber-500/10":"hover:bg-surface-2"),onClick:()=>{ar?qt?(O(null),Qe(!1)):(Xe(),Qe(!1)):qt?zt(qt,tr.id):et(tr.id)},children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"font-medium truncate flex items-center gap-2",children:[ar?"Cliente Consumidor":`${tr?.codigo?`${tr.codigo} - `:""}${tr?.nome||""}`,ar&&o.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30",children:"Cliente Padro"})]}),!ar&&tr.telefone&&o.jsx("div",{className:"text-xs text-text-muted",children:tr.telefone}),ar&&o.jsx("div",{className:"text-xs text-text-muted",children:"Clique para adicionar consumidor"})]}),sr&&!ar&&o.jsx(Pi,{className:"h-5 w-5 text-success ml-2 flex-shrink-0"})]},tr.id)})})})]}),o.jsx(Un,{children:o.jsx(le,{variant:"outline",onClick:()=>Qe(!1),children:"Cancelar"})})]})})]})},cs=()=>{const de=jt=>jt==="available"?"bg-success/10 border-success/30 text-success":jt==="in-use"?"bg-warning/10 border-warning/30 text-warning":jt==="awaiting-payment"?"bg-info/10 border-info/30 text-info":"bg-surface-2 border-border text-text-secondary",Le=jt=>jt==="available"?"Livre":jt==="in-use"?"Ocupada":jt==="awaiting-payment"?"Aguardando":"Desconhecido";return o.jsx("div",{className:"md:hidden space-y-2",children:a.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[o.jsx("div",{className:"text-text-muted mb-4",children:o.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),o.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear"})]}):a.map(jt=>{const Rt=Pt(jt.order||[],jt),Ot=jt.totalHint>0?jt.totalHint:Rt;return o.jsx("div",{onClick:async()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}await Pr(jt),jt.status!=="available"&&Cr(!0)},className:Jt("p-3 rounded-lg border-2 bg-surface transition-all active:scale-[0.98]",de(jt.status),s?.id===jt.id&&"ring-2 ring-brand/60",c?"cursor-pointer":"cursor-not-allowed opacity-60"),children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("h3",{className:"font-bold text-base truncate",children:jt.name||`Mesa ${jt.number}`}),jt.status==="available"&&jt.id===pt&&o.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-gray-400 bg-transparent border border-gray-300/50 rounded flex-shrink-0",children:"F1"})]}),o.jsx("span",{className:Jt("text-xs px-2 py-0.5 rounded-full border font-medium flex-shrink-0",de(jt.status)),children:Le(jt.status)})]}),jt.status==="in-use"||jt.status==="awaiting-payment"?o.jsxs("div",{className:"space-y-0.5",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-text-secondary",children:[o.jsx(cl,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:Ft(jt.customer)||"Sem cliente"})]}),o.jsxs("div",{className:"flex items-center gap-1.5 text-sm font-semibold text-text-primary",children:[o.jsx(Ui,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsxs("span",{children:["R$ ",Ot.toFixed(2)]})]})]}):o.jsx("div",{className:"text-xs text-text-muted",children:"Mesa disponvel"})]}),o.jsx(Qx,{className:"w-5 h-5 text-text-muted flex-shrink-0 ml-2"})]})},jt.id)})})},Ku=()=>s?o.jsx(ln,{open:cr,modal:!z,onOpenChange:de=>{!de&&z||(Cr(de),de||Or(null),de&&A("tables"))},children:o.jsxs(sn,{className:"w-[95vw] sm:max-w-2xl max-h-[85vh] flex flex-col p-0 gap-0 animate-none",children:[o.jsxs("div",{className:"p-4 border-b border-border bg-surface-2",children:[o.jsx("div",{className:"flex items-center justify-between mb-2",children:o.jsx(nn,{className:"text-xl font-bold",children:s.name||`Mesa ${s.number}`})}),o.jsx(_n,{className:"sr-only",children:"Visualizao da comanda e produtos da mesa selecionada"}),(s.status==="in-use"||s.status==="awaiting-payment")&&o.jsxs("div",{className:"flex items-center gap-4 text-sm text-text-secondary",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(cl,{className:"w-4 h-4"}),o.jsx("span",{children:Ft(s.customer)||"Sem cliente"})]}),s.order&&s.order.length>0&&o.jsxs("div",{className:"flex items-center gap-1 font-semibold text-text-primary",children:[o.jsx(Ui,{className:"w-4 h-4"}),o.jsxs("span",{children:["R$ ",(s.totalHint>0?s.totalHint:Pt(s.order||[])).toFixed(2)]})]})]})]}),o.jsxs(Vd,{value:Ie,onValueChange:de=>{ke(de),Or(null),de==="products"&&s&&(w(!0),ke("order"))},className:"flex flex-col flex-1 min-h-0",children:[o.jsxs(sd,{className:"grid w-full grid-cols-3 m-2 rounded-lg",children:[o.jsx(ba,{value:"order",className:"text-sm flex items-center justify-center gap-2",children:"Comanda"}),o.jsx(ba,{value:"details",className:"text-sm flex items-center justify-center gap-2",children:"Detalhes"}),o.jsxs(ba,{value:"products",className:"text-sm flex items-center justify-center gap-2",onClick:()=>{s&&w(!0)},children:["Produtos",o.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),o.jsx(Wi,{value:"order",className:"flex-1 overflow-hidden min-h-0 m-0",onKeyDown:de=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(de.key)&&A("tables")},children:o.jsx(ut,{table:s})}),o.jsx(Wi,{value:"details",className:"flex-1 overflow-hidden min-h-0 m-0",children:o.jsx(We,{table:s})})]})]})}):null,kc=()=>{const de=D,Le=de&&Ar.get(de.id)||0,jt=de?Number(de.salePrice??de.price??0):0,Rt=Ot=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Ot||0));return o.jsx(ln,{open:z,onOpenChange:Ot=>{q(Ot),Ot||F(null)},children:o.jsxs(sn,{overlayClassName:"z-[70]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[71]",onOpenAutoFocus:Ot=>{},onKeyDown:Ot=>Ot.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-xl font-bold break-words",title:de?.name||"",children:de?.name||"Produto"}),o.jsx(_n,{children:"Detalhes do produto e aes rpidas."})]}),de?o.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),o.jsx("span",{className:"text-sm font-semibold",children:Rt(jt)})]}),de.category?o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),o.jsx("span",{className:"text-sm font-medium",children:de.category})]}):null,o.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof de.stock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),o.jsx("div",{className:"text-base font-semibold",children:de.stock})]}),typeof de.minStock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),o.jsx("div",{className:"text-base font-semibold",children:de.minStock})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),o.jsxs("div",{className:"text-base font-semibold",children:["x",Le]})]})]})]}):null,o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsxs(le,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{de&&n("/produtos",{state:{productId:de.id,productName:de.name}})},children:[o.jsx(rs,{className:"w-4 h-4"}),o.jsx("span",{children:"Info"})]}),o.jsx(le,{variant:"outline",onClick:()=>{q(!1),F(null)},children:"Fechar"}),o.jsx(le,{onClick:async()=>{de&&(await Wt(de),q(!1),F(null))},children:"Adicionar"})]})]})})};return o.jsxs(o.Fragment,{children:[o.jsx(kc,{}),o.jsx(ya,{}),o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx("div",{className:"md:hidden mb-2 w-full",children:o.jsx(Vd,{value:"mesas",onValueChange:de=>{de==="mesas"&&n("/vendas"),de==="balcao"&&n("/balcao"),de==="historico"&&n("/historico")},children:o.jsxs(sd,{className:"grid w-full grid-cols-3",children:[o.jsx(ba,{value:"mesas",className:"text-xs",title:"Pressione B para alternar",children:"Mesas"}),o.jsx(ba,{value:"balcao",className:"text-xs",title:"Pressione B para alternar",children:"Balco"}),o.jsx(ba,{value:"historico",className:"text-xs",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),o.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[o.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:o.jsx(Vd,{value:"mesas",onValueChange:de=>{de==="mesas"&&n("/vendas"),de==="balcao"&&n("/balcao"),de==="historico"&&n("/historico")},children:o.jsxs(sd,{className:"inline-flex",children:[o.jsx(ba,{value:"mesas",className:"text-sm",title:"Pressione B para alternar",children:"Mesas"}),o.jsx(ba,{value:"balcao",className:"text-sm",title:"Pressione B para alternar",children:"Balco"}),o.jsx(ba,{value:"historico",className:"text-sm",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),o.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 flex-shrink-0",children:[o.jsx(oo,{}),o.jsx(zl,{}),o.jsxs(le,{variant:"outline",size:"sm",onClick:()=>g(!0),className:"px-3",children:[o.jsx(uH,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"}),o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F11"})]}),o.jsx("div",{className:"hidden md:block w-px h-6 bg-border mx-1"}),o.jsxs(le,{onClick:()=>Ue(!0),className:"hidden md:flex",size:"sm",children:[o.jsx(Ga,{className:"mr-2 h-4 w-4"})," Nova Mesa",o.jsx("kbd",{className:"ml-2 px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]})]})]}),!c&&u>0&&o.jsxs("div",{className:"md:hidden mb-3 text-[11px] text-warning flex items-center gap-2",children:[o.jsx(pc,{className:"h-3 w-3"}),"H comandas abertas, mas o caixa parece fechado.",o.jsx(le,{size:"sm",variant:"outline",className:"h-6 px-2 text-[11px]",onClick:()=>Pe(!0),children:"Reabrir sesso"})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 overflow-visible min-h-0",children:[o.jsxs("div",{className:"lg:col-span-2 bg-surface rounded-lg border border-border p-4 md:p-6 overflow-y-auto thin-scroll min-h-0",tabIndex:0,onKeyDown:de=>{E==="tables"&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(de.key)&&de.preventDefault()},onClick:de=>{de.stopPropagation(),de.preventDefault(),A("tables"),!s&&a.length>0&&l(a[0]),de.currentTarget.focus()},onFocus:()=>{A("tables"),!s&&a.length>0&&l(a[0])},style:{outline:E==="tables"?"2px solid rgba(148, 163, 184, 0.4)":"none",outlineOffset:"-2px",transition:"outline 0.15s ease"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-4 gap-4",children:[o.jsx("h2",{className:"text-xl font-bold",children:"Mapa de Mesas"}),o.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-text-muted flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:""}),o.jsx("span",{children:"Navegar"})]}),o.jsx("div",{className:"w-px h-3 bg-border"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"Enter"}),o.jsx("span",{children:"Selecionar"})]})]}),o.jsx(le,{type:"button",className:"md:hidden h-9 w-9 p-0 bg-amber-400 text-black hover:bg-amber-300 flex-shrink-0",size:"icon",title:"Nova Mesa",onClick:()=>Ue(!0),children:o.jsx(Ga,{className:"h-5 w-5"})})]}),o.jsx(cs,{}),o.jsx("div",{className:"hidden md:block",children:o.jsx(Ent,{onDragEnd:Lt,children:o.jsx(Jae,{droppableId:"tables",children:de=>o.jsxs("div",{...de.droppableProps,ref:Le=>{de.innerRef(Le),Kr.current=Le},role:"grid","aria-label":"Lista de mesas",className:"grid gap-5 grid-cols-[repeat(auto-fit,minmax(240px,1fr))]",children:[a.length===0?o.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[o.jsx("div",{className:"text-text-muted mb-4",children:o.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),o.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear a receber pedidos"}),o.jsxs(le,{onClick:()=>Ue(!0),className:"flex items-center gap-2",children:[o.jsx(Ga,{size:16}),"Criar Nova Mesa"]})]}):a.map((Le,jt)=>o.jsx(fat,{draggableId:Le.id,index:jt,children:(Rt,Ot)=>o.jsx(Kt,{table:Le,provided:Rt,isDragging:Ot.isDragging})},Le.id)),de.placeholder]})})})})]}),o.jsx("div",{className:"hidden md:flex bg-surface rounded-lg border border-border flex-col min-h-0 transition-all overflow-hidden",style:{boxShadow:E==="panel"?"inset 0 0 0 2px rgba(148, 163, 184, 0.4)":"none"},children:o.jsxs(Vd,{value:M,onValueChange:de=>{C(de),de==="products"&&s&&(w(!0),C("order"))},className:"flex flex-col h-full",children:[o.jsxs(sd,{className:"grid w-full grid-cols-3 m-2",children:[o.jsx(ba,{value:"order",className:"flex items-center justify-center gap-2 text-xs",children:"Comanda"}),o.jsx(ba,{value:"details",className:"flex items-center justify-center gap-2 text-xs",children:"Detalhes"}),o.jsxs(ba,{value:"products",onClick:()=>{s&&w(!0)},className:"flex items-center justify-center gap-2 text-xs",children:["Produtos",o.jsx("kbd",{className:"hidden md:inline px-1 py-0.5 text-[10px] font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),o.jsx(Wi,{value:"order",className:"flex-1 overflow-hidden min-h-0",children:o.jsx(ut,{table:s})}),o.jsx(Wi,{value:"details",className:"flex-1 overflow-hidden min-h-0",children:o.jsx(We,{table:s})})]})})]})]}),o.jsx(Ku,{}),o.jsx(Ca,{}),o.jsx(X,{open:v,onOpenChange:g,cashSummary:T}),o.jsx(it,{}),o.jsx(nt,{}),o.jsx(yl,{}),o.jsx(Mo,{}),o.jsx(At,{}),Je&&o.jsx("div",{className:"fixed left-3 right-3 z-[9999]",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:o.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[o.jsx(pc,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),o.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:Be||"Ateno"})]})}),qr&&o.jsx(Sat,{item:qr,onApply:()=>{s&&jr(s)},onClose:()=>{Or(null)},codigoEmpresa:t?.codigo_empresa}),s&&Mt&&o.jsx(Cat,{comanda:s,subtotal:Pt(s.order||[],s),onApply:()=>{s&&jr(s)},onClose:()=>Ir(!1),codigoEmpresa:t?.codigo_empresa}),p.useMemo(()=>o.jsx($r,{}),[b,s?.id])]})}function Eat(){const{toast:e}=ro(),t=Fl(),{userProfile:r}=Do(),[n,a]=p.useState(null),[i,s]=p.useState([]),[l,c]=p.useState([]),[d,u]=p.useState(!0),[f,m]=p.useState(""),[h,v]=p.useState(""),[g,x]=p.useState(null),[y,b]=p.useState(null),[w,j]=p.useState(!1),_=p.useRef(!1),[S,k]=p.useState(new Map),[E,A]=p.useState(!1),[M,C]=p.useState(!1),[T,I]=p.useState(!1),[D,F]=p.useState(!1),[z,q]=p.useState(null),[$,K]=p.useState(!1),[ce,fe]=p.useState([]);p.useState(null);const[B,L]=p.useState(!1),[V,re]=p.useState([]),[me,G]=p.useState(1),[Q,ae]=p.useState([]),[J,je]=p.useState(null),[be,Ue]=p.useState(!1),[Z,Y]=p.useState(null),[lt,gt]=p.useState(!1),[Te,at]=p.useState(""),[yt,vt]=p.useState(!1),[Sr,se]=p.useState(""),[Ze,ct]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}});p.useEffect(()=>{const X=()=>{try{ct(typeof window<"u"&&window.innerWidth<=640)}catch{ct(!1)}};return X(),window.addEventListener("resize",X),()=>window.removeEventListener("resize",X)},[]),p.useState("cadastrado");const[Qt,we]=p.useState(""),[ye,te]=p.useState([]),[$e,Pe]=p.useState([]);p.useState(!1),p.useState(!1);const[It,Dt]=p.useState(!1),[kt,cr]=p.useState(!1),[Cr,Ie]=p.useState(0),[ke,Je]=p.useState("all"),[mt,Be]=p.useState(()=>{try{return localStorage.getItem("balcao_sort_order")||"code"}catch{return"code"}}),$t=p.useRef([]),Ee=p.useRef(null),[Ct,hr]=p.useState(()=>{try{const X=localStorage.getItem("balcao_left_panel_width");return X?parseFloat(X):50}catch{return 50}}),[Mr,qr]=p.useState(!1),Or=p.useRef(null),Mt=p.useRef(0),Ir=p.useRef([]);p.useEffect(()=>{Ir.current=l},[l]);const Ar=p.useRef(!1);p.useEffect(()=>(Ar.current=!0,()=>{Ar.current=!1}),[]),p.useEffect(()=>{(l||[]).length>0&&(_.current=!0)},[l]),p.useEffect(()=>{n&&_.current&&(l||[]).length===0&&Pt(n,2)},[n,l?.length]),p.useEffect(()=>{let X=!0;return(async()=>{try{const nt=await Dm({codigoEmpresa:r?.codigo_empresa});X&&A(!!nt)}catch{X&&A(!1)}})(),()=>{X=!1}},[r?.codigo_empresa]);const Zt=async()=>{const X=r?.codigo_empresa||null;try{if(!X)return;F(!0);const[nt,qe]=await Promise.all([w1({codigoEmpresa:X}).catch(()=>null),Dm({codigoEmpresa:X}).catch(()=>null)]);if(!qe?.id){q(null);return}let it=0,We=0,ut=[];try{ut=await Ip({caixaSessaoId:qe.id,codigoEmpresa:X}),it=(ut||[]).filter(Wt=>String(Wt?.tipo||"").toLowerCase()==="sangria").reduce((Wt,$r)=>Wt+Number($r?.valor||0),0),We=(ut||[]).filter(Wt=>String(Wt?.tipo||"").toLowerCase()==="suprimento").reduce((Wt,$r)=>Wt+Number($r?.valor||0),0)}catch{}const At={saldo_inicial:qe.saldo_inicial||0,totalPorFinalizadora:nt?.totalPorFinalizadora||nt?.porFinalizadora||{},totalEntradas:nt?.totalEntradas||nt?.entradas||0,totalSangria:it,totalSuprimento:We,totalSaidas:it,sessaoId:qe.id,movimentacoes:ut};q(At)}catch{q(null)}finally{F(!1)}};p.useEffect(()=>{let X=!0;return(async()=>{try{if(!$||!n)return;const qe=r?.codigo_empresa;let it=[];try{const At=await Qi({comandaId:n,codigoEmpresa:qe});it=(Array.isArray(At)?At:[]).map($r=>{const W=$r?.clientes?.id??$r?.cliente_id??$r?.id??null,Ce=$r?.clientes?.nome??$r?.nome??$r?.nome_livre??"";return W?{id:W,nome:Ce}:null}).filter(Boolean)}catch{it=[]}if(!X)return;ae(it);const ut=Array.isArray($e)&&$e.length>0?$e:it.map(At=>At.id);if(!Array.isArray(ut)||ut.length===0)return;re(At=>{let Wt=At&&At.length?[...At]:[{id:1,clientId:ut[0],methodId:ce[0]?.id||"",value:""}];Wt[0]||(Wt[0]={id:1,clientId:ut[0],methodId:ce[0]?.id||"",value:""}),Wt[0].clientId=ut[0];const $r=new Set([Wt[0].clientId].filter(Boolean));for(let W=1;W<Wt.length;W++){if(!Wt[W].clientId||$r.has(Wt[W].clientId)){const Ce=(ut||[]).find(De=>!$r.has(De));Wt[W].clientId=Ce||ut[0]}$r.add(Wt[W].clientId)}return Wt})}catch{}})(),()=>{X=!1}},[$,$e,n,r?.codigo_empresa]);const Kr=X=>{const nt=String(X||"").replace(/\D/g,"");return nt?Number(nt)/100:0},Tr=X=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(X),dn=X=>(ce||[]).find(nt=>String(nt.id)===String(X)),Ae=X=>Number(dn(X.methodId)?.taxa_percentual||0),pt=X=>{const nt=Kr(X.value),qe=Ae(X);return!X.chargeFee||!qe?nt:nt/(1+qe/100)},Br=X=>{const nt=pt(X),qe=Ae(X);return!X.chargeFee||!qe||nt<=0?0:nt*(qe/100)},Pr=(X,nt)=>{const qe=Ae(X);if(X.chargeFee&&qe>0){const it=nt*(1+qe/100);return{...X,value:Tr(it)}}return{...X,value:Tr(nt)}},Ur=()=>(V||[]).reduce((X,nt)=>X+pt(nt),0),Zr=()=>(V||[]).reduce((X,nt)=>X+Br(nt),0),cn=()=>Ur()+Zr();p.useEffect(()=>{try{if(!$)return;let X=0;try{X=(l||[]).reduce((it,We)=>it+Number(We.quantity||0)*Number(We.price||0),0)}catch{}const nt=Ur(),qe=X-nt;Math.abs(qe)>.009&&Math.abs(qe)<=.05&&Array.isArray(V)&&V.length>0&&re(it=>it.map((We,ut,At)=>{if(ut!==At.length-1)return We;const Wt=pt(We)+qe;return Pr(We,Wt)}))}catch{}},[V,$]);const Tn=async()=>{try{if(!n){e({title:"Nenhuma comanda aberta",description:"Adicione itens para abrir uma comanda.",variant:"warning"});return}const X=r?.codigo_empresa;if(!X){e({title:"Empresa no definida",variant:"destructive"});return}try{const{data:We,error:ut}=await pe.from("comandas").select("id").eq("id",n).eq("codigo_empresa",X).single();if(ut||!We){console.error("[confirmPay] Comanda no encontrada no banco:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Criando nova comanda...",variant:"warning"}),a(null),c([]);try{localStorage.removeItem(Lt.comandaId),localStorage.removeItem(Lt.items)}catch{}await Yr();return}}catch(We){console.error("[confirmPay] Erro ao validar comanda:",We),e({title:"Erro de validao",description:"No foi possvel validar a comanda.",variant:"destructive"});return}if(!Array.isArray(V)||V.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const We of V){if(!We.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(!String(We.value||"").replace(/\D/g,"")){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}let nt=0;try{nt=(await Si({comandaId:n,codigoEmpresa:X})||[]).reduce((ut,At)=>ut+Number(At.quantidade||0)*Number(At.preco_unitario||0),0)}catch{}const qe=Ur(),it=Math.abs(qe-nt);if(it>.009&&it<=.05){const We=nt-qe;re(ut=>ut.map((At,Wt,$r)=>{if(Wt!==$r.length-1)return At;const W=pt(At)+We;return Pr(At,W)}))}else if(it>.05){const We=nt-qe;We>0?e({title:"Valor insuficiente",description:`Faltam R$ ${We.toFixed(2)} para fechar o total.`,variant:"warning"}):e({title:"Valor excedente",description:`Excedeu em R$ ${Math.abs(We).toFixed(2)}. Ajuste os valores.`,variant:"warning"});return}L(!0),await hf({codigoEmpresa:X});for(const We of V){const ut=Kr(We.value),At=ce.find($r=>String($r.id)===String(We.methodId)),Wt=At?.nome||At?.tipo||"outros";await yM({comandaId:n,finalizadoraId:We.methodId,metodo:Wt,valor:ut,status:"Pago",codigoEmpresa:X,clienteId:We.clientId||null})}await Bx({comandaId:n,codigoEmpresa:X}),a(null),c([]),Pe([]),m(""),cr(!1),re([]);try{localStorage.removeItem(Lt.comandaId),localStorage.removeItem(Lt.items),localStorage.removeItem(Lt.customerName)}catch{}e({title:"Pagamento concludo",description:`Total R$ ${nt.toFixed(2)}`,variant:"success"}),K(!1)}catch(X){e({title:"Falha ao concluir",description:X?.message||"Tente novamente",variant:"destructive"})}finally{L(!1)}};p.useEffect(()=>{(async()=>{try{if(!M)return;await Zt()}catch{}})()},[M,r?.codigo_empresa]);const Qn=()=>{const[X,nt]=p.useState(""),qe=p.useRef(null);return p.useEffect(()=>{if(typeof window<"u"&&window.innerWidth<=640)return;const We=setTimeout(()=>{try{qe.current?.focus()}catch{}},0);return()=>clearTimeout(We)},[]),o.jsxs(o.Fragment,{children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Abrir Caixa"}),o.jsx(Qc,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),o.jsxs("div",{className:"py-4",children:[o.jsx(Ht,{className:"mb-2 block",htmlFor:"open-cash-initial",children:"Saldo inicial"}),o.jsx(ir,{id:"open-cash-initial",ref:qe,type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:X,onChange:it=>{const We=(it.target.value||"").replace(/\D/g,""),ut=We?Number(We)/100:0,At=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(ut);nt(At)},onKeyDown:it=>{it.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(it.key)&&(/^[0-9]$/.test(it.key)||it.preventDefault())},onBeforeInput:it=>{const We=it.data??"";We&&/\D/.test(We)&&it.preventDefault()}}),o.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Digite nmeros; a mscara formata em reais automaticamente."})]}),o.jsxs(Xc,{children:[o.jsx(Zc,{onClick:()=>I(!1),children:"Cancelar"}),o.jsx(zd,{onClick:async()=>{try{const it=String(X||"").replace(/\D/g,""),We=it?Number(it)/100:0;await hf({saldoInicial:We,codigoEmpresa:r?.codigo_empresa}),A(!0),I(!1),e({title:"Caixa aberto com sucesso!",variant:"success"})}catch(it){e({title:"Falha ao abrir caixa",description:it?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Abertura"})]})]})},Sa=()=>o.jsxs(qd,{open:T,onOpenChange:I,children:[o.jsx(yp,{asChild:!0,children:o.jsxs(le,{variant:"success",size:"sm",disabled:E,onClick:()=>I(!0),className:"px-3",children:[o.jsx(yH,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"})]})}),o.jsx(Kc,{className:"sm:max-w-[425px] w-[92vw] animate-none",onKeyDown:X=>X.stopPropagation(),onPointerDownOutside:X=>{X.preventDefault(),X.stopPropagation()},onInteractOutside:X=>{X.preventDefault(),X.stopPropagation()},children:o.jsx(Qn,{})})]}),ht=()=>{const[X,nt]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[qe,it]=p.useState(!1),[We,ut]=p.useState(""),[At,Wt]=p.useState(!1),$r=async()=>{try{nt({loading:!0,saldoInicial:0,resumo:null});const dt=await Dm({codigoEmpresa:r?.codigo_empresa}),rr=await w1({codigoEmpresa:r?.codigo_empresa});nt({loading:!1,saldoInicial:Number(dt?.saldo_inicial||0),resumo:rr||{totalPorFinalizadora:{}}})}catch{nt({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},W=X?.resumo?.totalPorFinalizadora||{},Ce=Object.values(W).reduce((dt,rr)=>dt+Number(rr||0),0),De=Number(X.saldoInicial||0)+Ce,bt=Number(z?.totalSuprimento||0),He=Number(z?.totalSangria||0);return o.jsxs(qd,{onOpenChange:dt=>{dt&&(Wt(!1),$r())},children:[o.jsx(yp,{asChild:!0,children:o.jsxs(le,{variant:"destructive",size:"sm",disabled:!E,onClick:$r,className:"px-3",children:[o.jsx(sx,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2",children:"Fechar Caixa"})]})}),o.jsxs(Kc,{className:"sm:max-w-[425px] animate-none",onKeyDown:dt=>dt.stopPropagation(),onPointerDownOutside:dt=>{dt.preventDefault(),dt.stopPropagation()},onInteractOutside:dt=>{dt.preventDefault(),dt.stopPropagation()},children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Fechar Caixa"}),o.jsx(Qc,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),qe&&o.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[o.jsx(pc,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),X.loading?o.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):o.jsx("div",{className:"py-4 space-y-2",children:At?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(X.saldoInicial||0).toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor Final"})," ",o.jsx("span",{className:"font-mono",children:(()=>{const dt=String(We||"").replace(/\D/g,""),rr=dt?Number(dt)/100:0;return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(rr)})()})]})]}),o.jsxs("div",{className:"mt-2",children:[o.jsx(Ht,{className:"mb-1 block",children:"Saldo Final (opcional)"}),o.jsx(ir,{type:"text",inputMode:"numeric",placeholder:"0,00",value:We,onChange:dt=>{const rr=(dt.target.value||"").replace(/\D/g,""),Gr=rr?Number(rr)/100:0,Rr=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Gr);ut(Rr)},onKeyDown:dt=>{dt.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(dt.key)&&(/^[0-9]$/.test(dt.key)||dt.preventDefault())},onBeforeInput:dt=>{const rr=dt.data??"";rr&&/\D/.test(rr)&&dt.preventDefault()}})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Resumo"}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(X.saldoInicial||0).toFixed(2)]})]}),Object.keys(W).length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):o.jsx("div",{className:"space-y-1",children:Object.entries(W).map(([dt,rr])=>o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:String(dt)})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(rr||0).toFixed(2)]})]},dt))}),o.jsx("div",{className:"my-2 h-px bg-border"}),o.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Conferncia"}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Suprimentos"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",bt.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Sangrias"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",He.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between font-medium text-base",children:[o.jsx("span",{className:"text-text-secondary",children:"Total em Caixa"})," ",o.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(De||0).toFixed(2)]})]})]})}),o.jsx(Xc,{children:At?o.jsxs(o.Fragment,{children:[o.jsx(le,{variant:"outline",onClick:()=>Wt(!1),children:"Voltar"}),o.jsx(le,{onClick:async()=>{try{try{const Gr=await sc({codigoEmpresa:r?.codigo_empresa});if(Array.isArray(Gr)&&Gr.length>0){Ze?(it(!0),e({title:"Fechamento bloqueado",description:`Existem ${Gr.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning"})):e({title:"Fechamento bloqueado",description:`Existem ${Gr.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning",duration:2500});return}}catch{}const dt=String(We||"").replace(/\D/g,""),rr=dt?Number(dt)/100:0;await Zte({codigoEmpresa:r?.codigo_empresa,valorFinalDinheiro:rr}),A(!1),e({title:"Caixa fechado!",description:"Fechamento registrado com sucesso.",variant:"success"})}catch(dt){e({title:"Falha ao fechar caixa",description:dt?.message||"Tente novamente",variant:"destructive"})}},children:"Fechar Caixa"})]}):o.jsxs(o.Fragment,{children:[o.jsx(Zc,{children:"Cancelar"}),o.jsx(le,{onClick:()=>Wt(!0),children:"Confirmar Fechamento"})]})})]})]})},Vt=()=>{const X=wr=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(wr||0)),[nt,qe]=p.useState(!1),[it,We]=p.useState(!1),[ut,At]=p.useState(""),[Wt,$r]=p.useState(""),[W,Ce]=p.useState(!1),De=async()=>{try{Ce(!0);const wr=String(ut||"").replace(/\D/g,""),or=wr?Number(wr)/100:0;if(or<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await hf({codigoEmpresa:r?.codigo_empresa}),await e4({tipo:"sangria",valor:or,observacao:Wt,codigoEmpresa:r?.codigo_empresa}),qe(!1),At(""),$r(""),await Zt(),e({title:"Sangria registrada",variant:"success"})}catch(wr){e({title:"Falha ao registrar sangria",description:wr?.message||"Tente novamente",variant:"destructive"})}finally{Ce(!1)}},[bt,He]=p.useState(""),[dt,rr]=p.useState(""),[Gr,Rr]=p.useState(!1),br=async()=>{try{Rr(!0);const wr=String(bt||"").replace(/\D/g,""),or=wr?Number(wr)/100:0;if(or<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await hf({codigoEmpresa:r?.codigo_empresa}),await e4({tipo:"suprimento",valor:or,observacao:dt,codigoEmpresa:r?.codigo_empresa}),We(!1),He(""),rr(""),await Zt(),e({title:"Suprimento registrado",variant:"success"})}catch(wr){e({title:"Falha ao registrar suprimento",description:wr?.message||"Tente novamente",variant:"destructive"})}finally{Rr(!1)}};return o.jsx(ln,{open:M,onOpenChange:C,children:o.jsxs(sn,{className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:wr=>wr.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),o.jsx(_n,{children:D?"Carregando resumo...":z?"Resumo da sesso atual do caixa.":"Nenhuma sesso de caixa aberta."})]}),z?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex-1 overflow-y-auto pr-1",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[o.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Inicial"}),o.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:X(z.saldo_inicial)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[o.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Entradas"}),o.jsx("div",{className:"text-base md:text-lg font-bold text-success tabular-nums leading-tight",children:X(z.totalEntradas)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[o.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Sadas"}),o.jsx("div",{className:"text-base md:text-lg font-bold text-danger tabular-nums leading-tight",children:X(z.totalSangria)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[o.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Atual"}),o.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:X((z.saldo_inicial||0)+(z.totalEntradas||0)-(z.totalSangria||0))})]})]}),o.jsxs("div",{className:"mt-5",children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("h4",{className:"text-sm font-semibold text-text-secondary",children:"Totais por Finalizadora"})}),Object.keys(z.totalPorFinalizadora||{}).length===0?o.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):o.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(z.totalPorFinalizadora||{}).map(([wr,or])=>o.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(wr)}),o.jsx("span",{className:"text-sm font-semibold tabular-nums",children:X(or)})]},wr))}),o.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Suprimentos"}),o.jsx("span",{className:"text-sm font-semibold tabular-nums text-success",children:X(z.totalSuprimento||0)})]}),o.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),o.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:X(z.totalSangria||0)})]})]})]}),o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsx("div",{className:"mr-auto"}),o.jsx(le,{variant:"outline",onClick:()=>We(!0),children:"Registrar Suprimento"}),o.jsx(le,{variant:"destructive",onClick:()=>qe(!0),children:"Registrar Sangria"}),o.jsx(le,{variant:"secondary",onClick:()=>C(!1),children:"Fechar"})]}),o.jsx(ln,{open:it,onOpenChange:We,children:o.jsxs(sn,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:wr=>wr.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-xl font-bold",children:"Registrar Suprimento"}),o.jsx(_n,{children:"Informe o valor de entrada no caixa e, opcionalmente, uma observao."})]}),o.jsxs("div",{className:"flex-1 flex flex-col space-y-3",children:[o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"r-valor",children:"Valor"}),o.jsx(ir,{id:"r-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:bt,onChange:wr=>{const or=(wr.target.value||"").replace(/\D/g,""),tn=or?Number(or)/100:0,tt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(tn);He(tt)},onKeyDown:wr=>{wr.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(wr.key)&&(/^[0-9]$/.test(wr.key)||wr.preventDefault())},onBeforeInput:wr=>{const or=wr.data??"";or&&/\D/.test(or)&&wr.preventDefault()}})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"r-obs",children:"Observao"}),o.jsx(ir,{id:"r-obs",placeholder:"Opcional",value:dt,onChange:wr=>rr(wr.target.value)})]})]}),o.jsxs(Un,{children:[o.jsx(le,{variant:"outline",onClick:()=>We(!1),disabled:Gr,children:"Cancelar"}),o.jsx(le,{onClick:br,disabled:Gr,children:Gr?"Registrando...":"Confirmar"})]})]})}),o.jsx(ln,{open:nt,onOpenChange:qe,children:o.jsxs(sn,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:wr=>wr.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-xl font-bold",children:"Registrar Sangria"}),o.jsx(_n,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"s-valor",children:"Valor"}),o.jsx(ir,{id:"s-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:ut,onChange:wr=>{const or=(wr.target.value||"").replace(/\D/g,""),tn=or?Number(or)/100:0,tt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(tn);At(tt)},onKeyDown:wr=>{wr.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(wr.key)&&(/^[0-9]$/.test(wr.key)||wr.preventDefault())},onBeforeInput:wr=>{const or=wr.data??"";or&&/\D/.test(or)&&wr.preventDefault()}})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"s-obs",children:"Observao"}),o.jsx(ir,{id:"s-obs",placeholder:"Opcional",value:Wt,onChange:wr=>$r(wr.target.value)})]})]}),o.jsxs(Un,{children:[o.jsx(le,{variant:"outline",onClick:()=>qe(!1),disabled:W,children:"Cancelar"}),o.jsx(le,{onClick:De,disabled:W,children:W?"Registrando...":"Confirmar"})]})]})})]}):o.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma sesso de caixa aberta."})]})})},gr=r?.codigo_empresa||"anon",Lt={comandaId:`balcao:comandaId:${gr}`,items:`balcao:items:${gr}`,customerName:`balcao:customer:${gr}`,clientChosen:`balcao:clientChosen:${gr}`,pendingClientIds:`balcao:pendingClientIds:${gr}`,missCount:`balcao:missCount:${gr}`,lastMissTs:`balcao:lastMissTs:${gr}`},Pt=async(X,nt=3)=>{if(!X)return;const qe=r?.codigo_empresa,it=++Mt.current;for(let We=0;We<nt;We++)try{const ut=await Si({comandaId:X,codigoEmpresa:qe});if(it!==Mt.current)return;const At=(ut||[]).map(Wt=>({id:Wt.id,productId:Wt.produto_id,name:Wt.descricao||"Item",price:Number(Wt.preco_unitario||0),quantity:Number(Wt.quantidade||1)}));c(At);try{const Wt=await Qi({comandaId:X,codigoEmpresa:qe});if(it!==Mt.current)return;const $r=(Wt||[]).map(Ce=>Ce?.nome).filter(Boolean),W=$r.length?$r.join(", "):"";m(W),cr(!!W)}catch{m(""),cr(!1)}break}catch(ut){if(We===nt-1)e({title:"Falha ao atualizar itens",description:ut?.message||"Tente novamente",variant:"destructive"});else{const At=350*(We+1),Wt=Math.floor(Math.random()*120);await new Promise($r=>setTimeout($r,At+Wt))}}},Yr=async()=>{try{u(!0);let X=setTimeout(()=>{Ar.current&&u(!1)},1e4);const nt=r?.codigo_empresa;if(!nt){Ar.current&&u(!1);return}try{const ut=localStorage.getItem(Lt.comandaId),At=JSON.parse(localStorage.getItem(Lt.items)||"[]"),Wt=localStorage.getItem(Lt.customerName)||"",$r=localStorage.getItem(Lt.clientChosen),W=JSON.parse(localStorage.getItem(Lt.pendingClientIds)||"[]");ut&&a(Number.isNaN(+ut)?ut:Number(ut)),Array.isArray(At)&&At.length>0&&c(At),Wt&&m(Wt),$r==="true"&&cr(!0),Array.isArray(W)&&W.length>0&&Pe(W)}catch{}const qe=localStorage.getItem(Lt.comandaId),it=qe?Number.isNaN(+qe)?qe:Number(qe):null,We=await xM({codigoEmpresa:nt}).catch(()=>null);if(We?.id)a(We.id),await Pt(We.id);else if(it)a(it),await Pt(it,3);else{let ut=0,At=0;try{ut=Number(localStorage.getItem(Lt.missCount)||"0"),At=Number(localStorage.getItem(Lt.lastMissTs)||"0")}catch{}const Wt=Date.now(),W=Wt-At<9e4?ut+1:1;try{localStorage.setItem(Lt.missCount,String(W)),localStorage.setItem(Lt.lastMissTs,String(Wt))}catch{}try{const Ce=localStorage.getItem(Lt.customerName)||"",De=localStorage.getItem(Lt.clientChosen)==="true",bt=JSON.parse(localStorage.getItem(Lt.pendingClientIds)||"[]");m(Ce||""),cr(!!De),Pe(Array.isArray(bt)?bt:[])}catch{}if(a(null),W>=2){c([]);try{localStorage.removeItem(Lt.comandaId),localStorage.removeItem(Lt.items)}catch{}}else try{const Ce=JSON.parse(localStorage.getItem(Lt.items)||"[]");Array.isArray(Ce)&&Ce.length>0&&c(Ce)}catch{}}try{const ut=await Uu({includeInactive:!1,search:h?.trim()||void 0,codigoEmpresa:nt});Ar.current&&s(ut||[])}catch{s([])}clearTimeout(X)}catch(X){e({title:"Falha ao carregar Modo Balco",description:X?.message||"Tente novamente",variant:"destructive"})}finally{Ar.current&&u(!1)}},Ft=async()=>{try{j(!0);const X=r?.codigo_empresa;if(n&&X)try{try{await pe.from("comanda_itens").delete().eq("comanda_id",n).eq("codigo_empresa",X)}catch{}try{await pe.from("comanda_clientes").delete().eq("comanda_id",n).eq("codigo_empresa",X)}catch{}await pe.from("comandas").delete().eq("id",n).eq("codigo_empresa",X)}catch{}}finally{a(null),c([]),Pe([]),m(""),cr(!1),b(null);try{localStorage.removeItem(Lt.comandaId),localStorage.removeItem(Lt.items),localStorage.removeItem(Lt.customerName)}catch{}j(!1),e({title:"Venda cancelada",variant:"success"})}};p.useEffect(()=>{let X=!1;(async()=>{await Yr(),!X&&Ar.current&&!n&&(Ir.current||[]).length===0&&(X=!0,setTimeout(()=>{Ar.current&&Yr()},700))})()},[r?.codigo_empresa]),p.useEffect(()=>{try{n&&localStorage.setItem(Lt.comandaId,String(n)),localStorage.setItem(Lt.items,JSON.stringify(l||[])),localStorage.setItem(Lt.customerName,f||""),localStorage.setItem(Lt.clientChosen,kt?"true":"false"),n?localStorage.removeItem(Lt.pendingClientIds):localStorage.setItem(Lt.pendingClientIds,JSON.stringify($e||[]))}catch{}},[n,l,f,kt,$e]),p.useEffect(()=>{const X=()=>{n&&Pt(n,2)},nt=()=>{document.visibilityState==="visible"&&n&&Pt(n,2)};return window.addEventListener("focus",X),document.addEventListener("visibilitychange",nt),()=>{window.removeEventListener("focus",X),document.removeEventListener("visibilitychange",nt)}},[n]),p.useEffect(()=>{const X=nt=>{const qe=nt.target;if(!(qe&&(qe.tagName==="INPUT"||qe.tagName==="TEXTAREA"))){if(nt.key==="p"||nt.key==="P"){nt.preventDefault(),Ee.current?.focus();return}if((nt.key==="c"||nt.key==="C")&&E&&kt){nt.preventDefault(),Dt(!0);return}if(nt.key==="Escape"){if(lt){gt(!1);return}if(It){Dt(!1);return}if($){K(!1);return}if(be){Ue(!1);return}}}};return window.addEventListener("keydown",X),()=>window.removeEventListener("keydown",X)},[E,kt,lt,It,$,be]),p.useEffect(()=>{const X=qe=>{if(!Mr||!Or.current)return;const We=Or.current.getBoundingClientRect(),ut=18;We.width-ut;const Wt=(qe.clientX-We.left)/We.width*100;Wt>=20&&Wt<=80&&hr(Wt)},nt=()=>{if(Mr){qr(!1);try{localStorage.setItem("balcao_left_panel_width",String(Ct))}catch{}}};return Mr&&(document.addEventListener("mousemove",X),document.addEventListener("mouseup",nt),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",nt),document.body.style.cursor="",document.body.style.userSelect=""}},[Mr,Ct]),p.useEffect(()=>{let X=!0;const nt=setTimeout(async()=>{try{const qe=await Uu({includeInactive:!1,search:h?.trim()||void 0,codigoEmpresa:r?.codigo_empresa});if(!X)return;let it=qe||[];if(h?.trim()){const We=h.trim().toLowerCase();it=it.filter(ut=>(ut.name||"").toLowerCase().includes(We)||(ut.code||"").toLowerCase().includes(We))}it.sort((We,ut)=>{const At=We.code||"",Wt=ut.code||"";return/^\d+$/.test(At)&&/^\d+$/.test(Wt)?parseInt(At,10)-parseInt(Wt,10):At.localeCompare(Wt)}),s(it)}catch{X&&s([])}},300);return()=>{X=!1,clearTimeout(nt)}},[h]),p.useEffect(()=>{let X=!0;const nt=async()=>{try{const it=r?.codigo_empresa;if(!it)return;const We=await Gv({codigoEmpresa:it});if(!X)return;console.log("[BalcaoPage] Itens de todas comandas abertas:",We?.length||0);const ut=new Map;for(const At of We||[]){const Wt=At.produto_id,$r=Number(At.quantidade||0);ut.set(Wt,(ut.get(Wt)||0)+$r)}console.log("[BalcaoPage] Estoque reservado atualizado:",ut.size,"produtos diferentes"),ut.size>0&&console.log("[BalcaoPage] Produtos reservados:",Array.from(ut.entries()).map(([At,Wt])=>({id:At,qty:Wt}))),k(ut)}catch(it){console.error("[BalcaoPage] Erro ao buscar estoque reservado:",it),X&&k(new Map)}};nt();const qe=setInterval(nt,5e3);return()=>{X=!1,clearInterval(qe)}},[r?.codigo_empresa,l]),p.useEffect(()=>{let X=!0;const nt=setTimeout(async()=>{try{const qe=await kj({searchTerm:Qt,limit:20,codigoEmpresa:r?.codigo_empresa});if(!X)return;const it=(qe||[]).slice().sort((We,ut)=>Number(We?.codigo||0)-Number(ut?.codigo||0));if(te(it),It&&(!$e||$e.length===0)){const We=it?.find(ut=>ut?.codigo===0);if(We){Pe([We.id]);try{localStorage.setItem(Lt.pendingClientIds,JSON.stringify([We.id]))}catch{}}}}catch{X&&te([])}},250);return()=>{X=!1,clearTimeout(nt)}},[Qt,It]);const jr=p.useMemo(()=>l.reduce((X,nt)=>X+Number(nt.price||0)*Number(nt.quantity||0),0),[l]),ot=p.useMemo(()=>{const X=new Map;for(const nt of l||[]){const qe=nt.productId;if(!qe)continue;const it=Number(nt.quantity||0);X.set(qe,(X.get(qe)||0)+it)}return X},[l]),Kt=async(X,nt={})=>{try{if(!E){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}if(!kt&&!nt.skipClientCheck){b(X),Dt(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de vender.",variant:"warning"});return}const qe=r?.codigo_empresa;if(!qe){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}if(g)return;const it=Number(X.stock??X.currentStock??0),We=S.get(X.id)||0,ut=Math.max(0,it-We),At=Number(X.minStock??0);if(ut<=0){e({title:"Sem estoque disponvel",description:`Produto "${X.name}" est sem estoque (${it} total, ${We} reservado em outras comandas).`,variant:"destructive"});return}x(X.id);let Wt=n;const $r=!Wt;if(!Wt)try{const De=await Ej({codigoEmpresa:qe});Wt=De.id,a(De.id),await new Promise(He=>setTimeout(He,300));const{data:bt}=await pe.from("comandas").select("id").eq("id",Wt).eq("codigo_empresa",qe).single();if(!bt)throw new Error("Comanda criada mas no acessvel via RLS")}catch(De){if(De?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para vender",description:"Voc precisa abrir o caixa antes de iniciar uma comanda no Balco.",variant:"warning"});return}throw De}const W=Number(X.salePrice??X.price??0),Ce=(Ir.current||[]).find(De=>De.productId===X.id);Ce?await Wc({itemId:Ce.id,quantidade:Number(Ce.quantity||0)+1,codigoEmpresa:qe}):await t4({comandaId:Wt,produtoId:X.id,descricao:X.name,quantidade:1,precoUnitario:W,codigoEmpresa:qe}),await Pt(Wt);try{const De=await Gv({codigoEmpresa:qe}),bt=new Map;for(const He of De||[]){const dt=He.produto_id,rr=Number(He.quantidade||0);bt.set(dt,(bt.get(dt)||0)+rr)}k(bt),console.log("[BalcaoPage:addProduct] Estoque reservado atualizado:",bt.size,"produtos")}catch(De){console.error("[BalcaoPage:addProduct] Erro ao atualizar estoque reservado:",De)}if($r)try{const De=Array.from(new Set($e||[]));if(De.length>0){await Kv({comandaId:Wt,clienteIds:De,nomesLivres:[],codigoEmpresa:qe}),await Pt(Wt);const He=(await Qi({comandaId:Wt,codigoEmpresa:qe})||[]).map(dt=>dt?.nome).filter(Boolean);m(He.length?He.join(", "):""),cr(!0);try{localStorage.removeItem(Lt.pendingClientIds),localStorage.setItem(Lt.customerName,He.length?He.join(", "):""),localStorage.setItem(Lt.clientChosen,"true")}catch(dt){console.error("Erro ao atualizar cache local:",dt)}}}catch(De){console.error("Erro ao associar clientes:",De)}it-1<=0?e({title:"ltima unidade vendida",description:`"${X.name}" esgotou aps esta venda.`,variant:"warning"}):it-1<=At?e({title:"Estoque baixo",description:`"${X.name}" atingiu nvel de estoque baixo.`,variant:"warning"}):e({title:"Produto adicionado",description:X.name,variant:"success"})}catch(qe){const it=String(qe?.message||"").toLowerCase();qe?.code==="OUT_OF_STOCK"||it.includes("sem estoque")?e({title:"Sem estoque",description:"Este produto est sem estoque.",variant:"destructive"}):qe?.code==="INSUFFICIENT_STOCK"||it.includes("insuficiente")?e({title:"Estoque insuficiente",description:qe?.message||"Quantidade maior que o disponvel.",variant:"destructive"}):e({title:"Falha ao adicionar",description:qe?.message||"Tente novamente",variant:"destructive"})}finally{x(null)}},vr=async()=>{try{if(L(!0),!kt){Dt(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de pagar.",variant:"warning"}),L(!1);return}const X=r?.codigo_empresa;if(!X){e({title:"Empresa no definida",variant:"destructive"});return}if(!n)try{const De=await Ej({codigoEmpresa:X});if(!De?.id){e({title:"Comanda no encontrada",description:"Abra uma comanda antes de pagar.",variant:"destructive"}),L(!1);return}a(De.id)}catch(De){if(De?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),L(!1);return}throw De}try{await wGe({comandaId:n,codigoEmpresa:X})}catch(De){const bt=Array.isArray(De?.items)&&De.items.length?De.items.map(He=>`${He.name} (solicitado ${He.solicitado}, estoque ${He.estoque})`).join("; "):De?.message||"Estoque insuficiente na comanda";e({title:"Estoque insuficiente",description:bt,variant:"destructive",duration:7e3}),L(!1);return}const nt=await Hv({somenteAtivas:!0,codigoEmpresa:X});fe(nt||[]);let qe=[];try{const De=await Qi({comandaId:n,codigoEmpresa:X});qe=(Array.isArray(De)?De:[]).map(He=>{const dt=He?.cliente_id??He?.clientes?.id??null,rr=He?.clientes?.nome??He?.nome??He?.nome_livre??"";return dt?{id:dt,nome:rr}:null}).filter(Boolean)}catch{qe=[]}ae(qe);const it=nt&&nt[0]&&nt[0].id?nt[0].id:null,We=$e&&$e.length>0?$e[0]:qe[0]?.id||null;let ut=0;try{ut=(await Si({comandaId:n,codigoEmpresa:X})||[]).reduce((bt,He)=>bt+Number(He.quantidade||0)*Number(He.preco_unitario||0),0)}catch{}const At=(nt||[]).find(De=>String(De.id)===String(it)),Wt=Number(At?.taxa_percentual||0),$r=Wt>0,W=$r?ut*(1+Wt/100):ut,Ce=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(W);re([{id:1,clientId:We,methodId:it,value:Ce,chargeFee:$r}]),G(2),K(!0),L(!1);return}catch(X){if(X?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),L(!1);return}e({title:"Falha ao iniciar pagamento",description:X?.message||"Tente novamente",variant:"destructive"})}finally{}};return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx("div",{className:"md:hidden mb-2 w-full",children:o.jsx(Vd,{value:"balcao",onValueChange:X=>{X==="mesas"&&t("/vendas"),X==="balcao"&&t("/balcao"),X==="historico"&&t("/historico")},children:o.jsxs(sd,{className:"grid w-full grid-cols-3",children:[o.jsx(ba,{value:"mesas",className:"text-xs",children:"Mesas"}),o.jsx(ba,{value:"balcao",className:"text-xs",children:"Balco"}),o.jsx(ba,{value:"historico",className:"text-xs",children:"Histrico"})]})})}),o.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[o.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:o.jsx(Vd,{value:"balcao",onValueChange:X=>{X==="mesas"&&t("/vendas"),X==="balcao"&&t("/balcao"),X==="historico"&&t("/historico")},children:o.jsxs(sd,{className:"inline-flex",children:[o.jsx(ba,{value:"mesas",className:"text-sm",children:"Mesas"}),o.jsx(ba,{value:"balcao",className:"text-sm",children:"Balco"}),o.jsx(ba,{value:"historico",className:"text-sm",children:"Histrico"})]})})}),o.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 md:ml-auto",children:[o.jsx(Sa,{}),o.jsx(ht,{}),o.jsxs(le,{variant:"outline",size:"sm",onClick:()=>C(!0),className:"px-3",children:[o.jsx(uH,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"})]})]})]}),o.jsx("div",{className:"md:hidden flex-1 flex flex-col",children:o.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden bg-surface flex-1 min-h-0",children:[o.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),o.jsx("div",{className:"text-base font-bold truncate",children:"Balco"}),kt&&f&&o.jsx("div",{className:"text-[11px] text-text-muted truncate mt-0.5",children:f})]}),o.jsx("div",{className:"flex flex-col items-end gap-1",children:kt?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsxs(le,{size:"sm",className:"h-8 px-2 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!E,onClick:()=>{if(!E){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}gt(!0)},children:[o.jsx(Ga,{className:"h-4 w-4 mr-1"})," Produto"]}),o.jsx(le,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs",onClick:()=>Dt(!0),children:"+ Cliente"})]}),o.jsxs("span",{className:"text-xs text-text-muted whitespace-nowrap",children:["Total: R$ ",jr.toFixed(2)]})]}):o.jsx(le,{size:"sm",className:"h-8 px-3 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!E,onClick:()=>{if(!E){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Dt(!0)},children:"Iniciar venda"})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-3 thin-scroll min-h-0",children:kt?l.length===0?o.jsxs("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:[o.jsx("div",{children:"Comanda criada para o cliente."}),o.jsxs("div",{children:["Use o boto ",o.jsx("span",{className:"font-semibold",children:"Produto"})," para adicionar itens."]})]}):o.jsx("ul",{className:"space-y-2",children:l.map(X=>o.jsxs("li",{className:"p-2 rounded-md border border-border/40 bg-surface-2",children:[o.jsx("div",{className:"text-sm font-medium truncate",title:X.name,children:X.name}),o.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(le,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async nt=>{nt.stopPropagation();const qe=r?.codigo_empresa;if(!qe){e({title:"Empresa no definida",variant:"destructive"});return}const it=Number(X.quantity||1)-1;try{it<=0?(await Av({itemId:X.id,codigoEmpresa:qe}),c(We=>We.filter(ut=>ut.id!==X.id))):(await Wc({itemId:X.id,quantidade:it,codigoEmpresa:qe}),c(We=>We.map(ut=>ut.id===X.id?{...ut,quantity:it}:ut)))}catch(We){e({title:"Falha ao atualizar item",description:We?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),o.jsx("span",{className:"w-7 text-center text-sm font-semibold",children:X.quantity}),o.jsx(le,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async nt=>{nt.stopPropagation();const qe=r?.codigo_empresa;if(!qe){e({title:"Empresa no definida",variant:"destructive"});return}const it=Number(X.quantity||1)+1;try{await Wc({itemId:X.id,quantidade:it,codigoEmpresa:qe}),c(We=>We.map(ut=>ut.id===X.id?{...ut,quantity:it}:ut))}catch(We){e({title:"Falha ao atualizar item",description:We?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),o.jsxs("span",{className:"text-sm font-semibold whitespace-nowrap",children:["R$ ",(Number(X.quantity)*Number(X.price)).toFixed(2)]})]})]},X.id))}):o.jsx("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:o.jsxs("div",{children:["Para comear, toque em ",o.jsx("span",{className:"font-semibold",children:"Iniciar venda"})," e selecione o cliente."]})})}),o.jsx("div",{className:"p-3 border-t border-border flex gap-2",children:kt?o.jsxs(o.Fragment,{children:[o.jsx(le,{className:"flex-1",variant:"outline",size:"sm",onClick:Ft,disabled:l.length===0,children:"Cancelar"}),o.jsx(le,{className:"flex-1",size:"sm",disabled:jr<=0,onClick:vr,children:"Finalizar"})]}):o.jsx(le,{className:"flex-1",size:"sm",variant:"outline",disabled:!E,onClick:()=>{if(!E){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Dt(!0)},children:"Iniciar venda"})})]})}),o.jsx(Vt,{}),o.jsx(ln,{open:be,onOpenChange:X=>{Ue(X),X||je(null)},children:o.jsxs(sn,{className:"sm:max-w-[420px] w-full max-h-[85vh] flex flex-col animate-none",onKeyDown:X=>X.stopPropagation(),onPointerDownOutside:X=>X.stopPropagation(),onInteractOutside:X=>X.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-xl font-bold break-words",title:J?.name||"",children:J?.name||"Produto"}),o.jsx(_n,{children:"Detalhes do produto e aes rpidas."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),o.jsx("span",{className:"text-sm font-semibold",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(J?.price??J?.salePrice??0))})]}),J?.category?o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),o.jsx("span",{className:"text-sm font-medium",children:J.category})]}):null,o.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof J?.stock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),o.jsx("div",{className:"text-base font-semibold",children:J.stock})]}),typeof J?.minStock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),o.jsx("div",{className:"text-base font-semibold",children:J.minStock})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),o.jsxs("div",{className:"text-base font-semibold",children:["x",ot.get(J?.id)||0]})]})]})]}),o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsxs(le,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{J&&t("/produtos",{state:{productId:J.id,productName:J.name}})},children:[o.jsx(rs,{className:"w-4 h-4"}),o.jsx("span",{children:"Info"})]}),o.jsx(le,{variant:"outline",onClick:()=>{Ue(!1),je(null)},children:"Fechar"}),o.jsx(le,{onClick:async()=>{J&&(await Kt(J,{skipClientCheck:!1}),Ue(!1),je(null))},children:"Adicionar"})]})]})}),o.jsx(ln,{open:lt,onOpenChange:gt,children:o.jsxs(sn,{className:"sm:max-w-xl w-[92vw] max-h-[85vh] flex flex-col overflow-hidden animate-none",onOpenAutoFocus:X=>X.preventDefault(),onKeyDown:X=>X.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-xl font-bold",children:"Adicionar Produtos"}),o.jsx(_n,{children:"Busque e adicione produtos  comanda do balco."})]}),o.jsx("div",{className:"p-4 pt-0",children:o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar produto...",className:"pl-9",value:Te,onChange:X=>at(X.target.value)})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4 thin-scroll",children:[o.jsx("ul",{className:"space-y-2",children:(i||[]).filter(X=>{const nt=(Te||"").toLowerCase();if(!nt)return!0;const qe=String(X.name||X.descricao||"").toLowerCase(),it=String(X.code||X.codigo||"").toLowerCase();return qe.includes(nt)||it.includes(nt)}).sort((X,nt)=>{const qe=X.code?parseInt(X.code,10):999999,it=nt.code?parseInt(nt.code,10):999999;return qe-it}).map(X=>{const nt=ot.get(X.id)||0,qe=Number(X.stock??X.currentStock??0),it=Math.max(0,qe-nt),We=Number(X.salePrice??X.price??0);return o.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors border border-border/40",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("p",{className:"font-semibold truncate max-w-[200px]",title:`${X.code?`[${X.code}] `:""}${X.name}`,children:[X.code&&o.jsxs("span",{className:"text-text-muted",children:["[",X.code,"]"]})," ",X.name]}),nt>0&&o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",nt]}),o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",it]})]}),o.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",We.toFixed(2)]})]}),o.jsx(le,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:async()=>{await Kt(X)},"aria-label":`Adicionar ${X.name}`,children:o.jsx(Ga,{className:"h-4 w-4"})})]},X.id)})}),Array.isArray(i)&&i.length===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx(Mv,{className:"w-16 h-16 text-text-muted mb-4"}),o.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum produto encontrado."})]})]}),o.jsx(Un,{children:o.jsx(le,{variant:"outline",onClick:()=>gt(!1),children:"Fechar"})})]})}),o.jsxs("div",{ref:Or,className:"hidden md:flex gap-0 h-full overflow-hidden relative",children:[o.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${Ct}%`},children:[o.jsxs("div",{className:"p-4 border-b border-border space-y-3 cursor-pointer",onClick:X=>{X.target.tagName==="INPUT"||X.target.tagName==="BUTTON"||X.target.closest("button")||Ee.current?.focus()},children:[o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar produto...",className:"pl-9",value:h,onChange:X=>v(X.target.value),onKeyDown:X=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(X.key)&&X.stopPropagation()}})]}),o.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsx("button",{onClick:()=>Je("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${ke==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),o.jsx("button",{onClick:()=>Je("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${ke==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),o.jsx("button",{onClick:()=>Je("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${ke==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),o.jsx("button",{onClick:()=>Je("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${ke==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>{Be("code");try{localStorage.setItem("balcao_sort_order","code")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${mt==="code"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por cdigo",children:"Cdigo"}),o.jsx("button",{onClick:()=>{Be("name");try{localStorage.setItem("balcao_sort_order","name")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${mt==="name"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por nome",children:"A-Z"})]})]}),o.jsx("div",{className:"flex items-center gap-4 text-sm text-text-muted cursor-pointer",onClick:()=>Ee.current?.focus(),children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-2 py-1 bg-surface border border-border rounded text-xs font-mono",children:""}),o.jsx("span",{children:"Navegar"})]})})]}),o.jsx("div",{ref:Ee,className:"flex-1 overflow-y-auto p-4 thin-scroll focus:outline-none focus:ring-2 focus:ring-brand/20",tabIndex:0,onClick:()=>Ee.current?.focus(),onKeyDown:X=>{const nt=i.filter(We=>{const ut=h.trim().toLowerCase(),At=!ut||(We.name||"").toLowerCase().includes(ut)||String(We.code||"").toLowerCase().includes(ut);if(ke==="all")return At;const Wt=S.get(We.id)||0,$r=Number(We.stock??We.currentStock??0),W=Math.max(0,$r-Wt);return ke==="available"?At&&W>0:ke==="low"?At&&W>0&&W<=5:ke==="out"?At&&W<=0:At}).sort((We,ut)=>{if(mt==="name"){const At=(We.name||"").toLowerCase(),Wt=(ut.name||"").toLowerCase();return At.localeCompare(Wt)}else{const At=We.code?parseInt(We.code,10):999999,Wt=ut.code?parseInt(ut.code,10):999999;return At-Wt}});if(!["ArrowDown","ArrowUp","Home","End"].includes(X.key))return;X.preventDefault();const qe=Cr||0,it=nt.length;if(X.key==="ArrowDown"){const We=Math.min(qe+1,it-1);Ie(We),requestAnimationFrame(()=>$t.current[We]?.scrollIntoView({block:"nearest"}))}if(X.key==="ArrowUp"){const We=Math.max(qe-1,0);Ie(We),requestAnimationFrame(()=>$t.current[We]?.scrollIntoView({block:"nearest"}))}if(X.key==="Home"&&(Ie(0),requestAnimationFrame(()=>$t.current[0]?.scrollIntoView({block:"nearest"}))),X.key==="End"){const We=Math.max(0,it-1);Ie(We),requestAnimationFrame(()=>$t.current[We]?.scrollIntoView({block:"nearest"}))}},children:(i||[]).length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12",children:[o.jsx(Mv,{className:"w-16 h-16 text-text-muted mb-4"}),o.jsx("p",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto cadastrado"}),o.jsx("p",{className:"text-sm text-text-muted mb-6 text-center",children:"Cadastre produtos para comear a vender"}),o.jsxs(le,{onClick:()=>t("/produtos"),children:[o.jsx(Ga,{className:"mr-2 h-4 w-4"}),"Cadastrar Produto"]})]}):o.jsx("ul",{className:"space-y-2",children:i.filter(X=>{const nt=h.trim().toLowerCase(),qe=!nt||(X.name||"").toLowerCase().includes(nt)||String(X.code||"").toLowerCase().includes(nt);if(ke==="all")return qe;const it=S.get(X.id)||0,We=Number(X.stock??X.currentStock??0),ut=Math.max(0,We-it);return ke==="available"?qe&&ut>0:ke==="low"?qe&&ut>0&&ut<=5:ke==="out"?qe&&ut<=0:qe}).sort((X,nt)=>{if(mt==="name"){const qe=(X.name||"").toLowerCase(),it=(nt.name||"").toLowerCase();return qe.localeCompare(it)}else{const qe=X.code?parseInt(X.code,10):999999,it=nt.code?parseInt(nt.code,10):999999;return qe-it}}).map((X,nt)=>{const qe=ot.get(X.id)||0,it=S.get(X.id)||0,We=Number(X.stock??X.currentStock??0),ut=Math.max(0,We-it),At=Number(X.salePrice??X.price??0),Wt=nt===Cr;return o.jsx(xe.Fragment,{children:o.jsxs("li",{ref:$r=>{$t.current[nt]=$r},className:`flex items-center gap-3 p-2 rounded-md transition-colors border-2 ${Wt?"border-brand bg-brand/5":"border-transparent hover:bg-surface-2"} ${ut===0&&qe===0?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{Ie(nt),Ee.current?.focus()},children:[o.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:$r=>{$r.stopPropagation(),je({...X,qty:qe,remaining:ut,price:At}),Ue(!0)},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsxs("p",{className:"font-semibold truncate",title:`${X.code?`[${X.code}] `:""}${X.name}`,children:[X.code&&o.jsxs("span",{className:"text-text-muted",children:["[",X.code,"]"]})," ",X.name]}),qe>0&&o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",qe]})]}),o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",At.toFixed(2)]}),o.jsxs("span",{className:`text-xs font-medium whitespace-nowrap ${ut<=0?"text-destructive":ut<=5?"text-warning":"text-text-secondary"}`,children:["Estoque: ",ut]})]})]}),o.jsx(le,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:$r=>{$r.stopPropagation(),Kt(X)},disabled:ut===0,"aria-label":`Adicionar ${X.name}`,children:o.jsx(Ga,{className:"h-4 w-4"})})]})},X.id)})})})]}),o.jsx("div",{className:"w-2 bg-border hover:bg-brand cursor-col-resize transition-colors flex-shrink-0 mx-2",onMouseDown:()=>qr(!0),title:"Arraste para redimensionar"}),o.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${100-Ct}%`},children:[o.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2 flex-wrap",children:[o.jsxs("div",{className:"min-w-0 flex-shrink",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("span",{className:"text-base font-bold whitespace-nowrap",children:"Balco"}),f?o.jsx("span",{className:"truncate text-[11px] px-2 py-0.5 rounded-full border border-border bg-surface-2 text-text-secondary",children:f}):null]})]}),o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap",children:[o.jsxs(le,{size:"sm",className:"md:hidden h-8 px-2 text-xs whitespace-nowrap bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!E,onClick:()=>{if(!E){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}gt(!0)},title:"Adicionar produto",children:[o.jsx(Ga,{className:"h-4 w-4 mr-1"}),"Produto"]}),kt&&o.jsx(le,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs whitespace-nowrap",disabled:!E,onClick:()=>{if(!E){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar clientes.",variant:"warning"});return}Dt(!0)},children:"+ Cliente"}),kt?o.jsxs(qd,{children:[o.jsx(yp,{asChild:!0,children:o.jsx(le,{size:"sm",className:"h-8 px-2 text-xs whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",disabled:w,children:w?"Cancelando...":"Cancelar"})}),o.jsxs(Kc,{className:"sm:max-w-[420px] animate-none",onKeyDown:X=>X.stopPropagation(),children:[o.jsxs(Yc,{children:[o.jsx(Jc,{children:"Cancelar venda do balco?"}),o.jsx(Qc,{children:"Os itens sero descartados e a venda ser limpa. Esta ao no pode ser desfeita."})]}),o.jsxs(Xc,{children:[o.jsx(Zc,{children:"Voltar"}),o.jsx(zd,{onClick:Ft,children:"Confirmar Cancelamento"})]})]})]}):o.jsx(le,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs opacity-60 cursor-not-allowed whitespace-nowrap",disabled:!0,children:"Cancelar"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:kt?l.length===0?o.jsx("div",{className:"text-center text-text-muted pt-16",children:'Comanda vazia. Use o boto "+" para adicionar produtos.'}):o.jsx("ul",{className:"space-y-3 pr-1",children:l.map(X=>o.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface hover:bg-surface-2 transition-colors",children:[o.jsx("div",{className:"min-w-0 flex-1",children:o.jsx("div",{className:"font-medium truncate",title:X.name,children:X.name})}),o.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(le,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async nt=>{nt.stopPropagation();const qe=r?.codigo_empresa;if(!qe){e({title:"Empresa no definida",variant:"destructive"});return}const it=Number(X.quantity||1)-1;try{it<=0?(await Av({itemId:X.id,codigoEmpresa:qe}),c(We=>We.filter(ut=>ut.id!==X.id))):(await Wc({itemId:X.id,quantidade:it,codigoEmpresa:qe}),c(We=>We.map(ut=>ut.id===X.id?{...ut,quantity:it}:ut)));try{const We=await Gv({codigoEmpresa:qe}),ut=new Map;for(const At of We||[]){const Wt=At.produto_id,$r=Number(At.quantidade||0);ut.set(Wt,(ut.get(Wt)||0)+$r)}k(ut)}catch(We){console.error("[BalcaoPage:removeItem] Erro ao atualizar estoque reservado:",We)}}catch(We){const ut=String(We?.message||"").toLowerCase();We?.code==="INSUFFICIENT_STOCK"||ut.includes("insuficiente")?e({title:"Estoque insuficiente",description:We?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:We?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),o.jsx("span",{className:"w-7 text-center font-semibold",children:X.quantity}),o.jsx(le,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async nt=>{nt.stopPropagation();const qe=r?.codigo_empresa;if(!qe){e({title:"Empresa no definida",variant:"destructive"});return}const it=Number(X.quantity||1)+1;try{await Wc({itemId:X.id,quantidade:it,codigoEmpresa:qe}),c(We=>We.map(ut=>ut.id===X.id?{...ut,quantity:it}:ut))}catch(We){const ut=String(We?.message||"").toLowerCase();We?.code==="INSUFFICIENT_STOCK"||ut.includes("insuficiente")?e({title:"Estoque insuficiente",description:We?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:We?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"font-semibold whitespace-nowrap",children:["R$ ",(Number(X.quantity)*Number(X.price)).toFixed(2)]}),o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface text-text-secondary border border-border",children:["x",X.quantity]})]})]})]},X.id))}):o.jsxs("div",{className:"text-center pt-12",children:[o.jsx("div",{className:"text-sm text-text-secondary mb-3",children:"Para comear, inicie uma nova venda e selecione o cliente."}),o.jsx(le,{disabled:!E,onClick:()=>{if(!E){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Dt(!0)},children:"Iniciar nova venda"})]})}),o.jsxs("div",{className:"p-4 border-t border-border",children:[o.jsxs("div",{className:"flex justify-between items-center text-lg font-bold mb-3",children:[o.jsx("span",{children:"Total"}),o.jsxs("span",{children:["R$ ",jr.toFixed(2)]})]}),o.jsx(le,{size:"lg",className:"w-full",onClick:vr,disabled:jr<=0,children:"Finalizar Pagamento"})]})]})]}),o.jsx(ln,{open:$,onOpenChange:K,children:o.jsxs(sn,{className:"sm:max-w-xl w-[92vw] max-h-[90vh] flex flex-col overflow-hidden animate-none",onKeyDown:X=>X.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-2xl font-bold",children:"Fechar Conta"}),o.jsx(_n,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[o.jsx("span",{children:"Total"}),o.jsxs("span",{children:["R$ ",jr.toFixed(2)]})]}),o.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1",children:[o.jsx(Ht,{className:"block",children:"Pagamentos"}),(()=>null)(),(()=>null)(),(V||[]).map((X,nt)=>{const qe=ut=>{if(!ut)return f||"Cliente";const At=String(ut),Wt=(Q||[]).find(W=>String(W.id)===At);if(Wt?.nome)return Wt.nome;const $r=(ye||[]).find(W=>String(W.id)===At);return $r?.nome?$r.nome:f||"Cliente"},it=(Q||[]).length>1,We=(Q||[])[0]||null;return(Q||[]).filter(ut=>String(ut.id)!==String(We?.id||"")),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-start",children:[o.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:V.length>1&&nt>0&&o.jsx(le,{type:"button",variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{re(ut=>{const At=ut.filter(Ce=>Ce.id!==X.id);if(At.length===0)return[];const Wt=(l||[]).reduce((Ce,De)=>Ce+Number(De.quantity||0)*Number(De.price||0),0),$r=Math.floor(Wt/At.length*100)/100,W=Wt-$r*At.length;return At.map((Ce,De)=>{const bt=De===At.length-1?$r+W:$r;return Pr(Ce,bt)})})},children:o.jsx(Dl,{className:"h-4 w-4"})})}),nt===0?o.jsx("div",{className:"sm:col-span-4",children:o.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:qe(We?.id||X.clientId)})}):it?o.jsx("div",{className:"sm:col-span-4",children:o.jsxs(En,{value:X.clientId||"",onValueChange:ut=>re(At=>At.map(Wt=>Wt.id===X.id?{...Wt,clientId:ut}:Wt)),children:[o.jsx(Sn,{className:"w-full truncate",children:o.jsx(kn,{placeholder:"Cliente"})}),o.jsx(Cn,{children:(Q||[]).map(ut=>o.jsx(Nt,{value:ut.id,children:ut.nome},ut.id))})]})}):o.jsx("div",{className:"sm:col-span-4",children:o.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:qe(We?.id||X.clientId)})}),o.jsxs("div",{className:"sm:col-span-4",children:[o.jsxs(En,{value:X.methodId||"",onValueChange:ut=>re(At=>At.map(Wt=>{if(Wt.id!==X.id)return Wt;const $r=dn(ut),W=Number($r?.taxa_percentual||0);if(W>0){const De=pt(Wt)*(1+W/100);return{...Wt,methodId:ut,chargeFee:!0,value:Tr(De)}}else{const Ce=pt(Wt);return{...Wt,methodId:ut,chargeFee:!1,value:Tr(Ce)}}})),children:[o.jsx(Sn,{className:"w-full h-9 truncate",children:o.jsx(kn,{placeholder:"Forma de pagamento"})}),o.jsx(Cn,{children:(ce||[]).map(ut=>o.jsx(Nt,{value:ut.id,children:ut.nome},ut.id))})]}),(()=>{const ut=Ae(X);if(!ut)return null;const At=Br(X),Wt=!!X.chargeFee;return o.jsx("div",{className:"mt-1",children:o.jsxs("button",{type:"button",onClick:()=>re($r=>$r.map(W=>{if(W.id!==X.id)return W;const Ce=pt(W);if(!Wt){const De=Ce*(1+ut/100);return{...W,chargeFee:!0,value:Tr(De)}}return{...W,chargeFee:!1,value:Tr(Ce)}})),className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",Wt?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:Wt?"Desmarcar taxa":"Cobrar taxa",children:[o.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",Wt?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),o.jsxs("span",{children:["Taxa R$ ",At.toFixed(2)]})]})})})()]}),o.jsx("div",{className:"sm:col-span-3",children:o.jsx(ir,{placeholder:"0,00",inputMode:"numeric",value:X.value,className:"h-9",onChange:ut=>{const At=(ut.target.value||"").replace(/\D/g,""),Wt=At?Number(At)/100:0,$r=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Wt);re(W=>W.map(Ce=>Ce.id===X.id?{...Ce,value:$r}:Ce))},onKeyDown:ut=>{ut.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(ut.key)&&(/^[0-9]$/.test(ut.key)||ut.preventDefault())},onBeforeInput:ut=>{const At=ut.data??"";At&&/\D/.test(At)&&ut.preventDefault()}})})]},X.id)}),o.jsx("div",{children:o.jsx(le,{type:"button",variant:"secondary",size:"sm",onClick:()=>{re(X=>{const qe=Array.isArray($e)&&$e.length>0?$e:(Q||[]).map(He=>He.id),it=new Set(X.map(He=>He.clientId).filter(Boolean)),ut=(qe||[]).filter(He=>!it.has(He))[0]||qe[0]||"",At=ce[0]?.id||"",Wt=dn(At),$r=Number(Wt?.taxa_percentual||0)>0,W=[...X,{id:me,clientId:ut,methodId:At,value:"",chargeFee:$r}],Ce=(l||[]).reduce((He,dt)=>He+Number(dt.quantity||0)*Number(dt.price||0),0),De=Math.floor(Ce/W.length*100)/100,bt=Ce-De*W.length;return W.map((He,dt)=>{const rr=dt===W.length-1?De+bt:De;return Pr(He,rr)})}),G(X=>X+1)},children:"Adicionar forma"})}),(()=>{const X=cn(),nt=Zr(),We=(l||[]).reduce((ut,At)=>ut+Number(At.quantity||0)*Number(At.price||0),0)+nt-X;return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[o.jsx("span",{children:"Soma"}),o.jsxs("span",{children:["R$ ",X.toFixed(2)]})]}),o.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[o.jsx("span",{children:"Taxas"}),o.jsxs("span",{children:["R$ ",nt.toFixed(2)]})]}),o.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[o.jsx("span",{children:"Restante"}),o.jsxs("span",{className:Math.abs(We)<.005?"text-success":"text-warning",children:["R$ ",We.toFixed(2)]})]})]})})()]})]}),o.jsxs(Un,{children:[o.jsx(le,{variant:"outline",onClick:()=>K(!1),disabled:B,children:"Cancelar"}),o.jsx(le,{onClick:Tn,disabled:B,children:B?"Processando...":"Confirmar Pagamento"})]})]})}),o.jsx(ln,{open:It,onOpenChange:X=>Dt(X),children:o.jsxs(sn,{className:"max-w-lg",onOpenAutoFocus:X=>X.preventDefault(),onKeyDown:X=>X.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-2xl font-bold",children:"Identificar Cliente"}),o.jsx(_n,{children:"Selecione um cliente cadastrado para esta venda."})]}),o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"w-full",children:[o.jsx(Ht,{className:"mb-1 block",children:"Buscar cliente"}),o.jsxs("div",{className:"flex items-center gap-2 justify-between",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:Qt,onChange:X=>we(X.target.value),onKeyDown:X=>X.stopPropagation()})]}),o.jsx(le,{type:"button",size:"icon",title:"Cadastrar cliente",className:"ml-2 bg-brand text-black hover:bg-brand/90 border border-brand",onClick:()=>{window.location.href="/clientes"},children:o.jsx(Ga,{className:"h-4 w-4"})})]}),o.jsx("div",{className:"mt-2 max-h-48 overflow-auto border rounded-md thin-scroll",children:o.jsxs("ul",{children:[(ye||[]).map(X=>{const nt=($e||[]).includes(X.id);return o.jsxs("li",{className:`p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2 ${X?.codigo===0?"bg-warning/10 border-l-4 border-warning":""} ${nt?"bg-surface-2":""}`,onClick:()=>{Pe(qe=>{const it=new Set(qe||[]);it.has(X.id)?it.delete(X.id):it.add(X.id);const We=Array.from(it);try{localStorage.setItem(Lt.pendingClientIds,JSON.stringify(We))}catch{}return We})},children:[o.jsx("div",{children:o.jsxs("div",{className:"font-medium",children:[X.codigo!=null?String(X.codigo)+" - ":"",X.nome,X?.codigo===0&&o.jsx("span",{className:"ml-2 text-xs text-warning",children:"(Padro)"})]})}),o.jsx(Pi,{size:16,className:nt?"text-success":"text-text-muted opacity-40"})]},X.id)}),(!ye||ye.length===0)&&o.jsx("li",{className:"p-2 text-sm text-text-muted",children:"Nenhum cliente encontrado."})]})})]})}),o.jsxs(Un,{children:[o.jsx(le,{variant:"outline",onClick:()=>Dt(!1),children:"Fechar"}),o.jsx(le,{onClick:async()=>{try{const X=Array.from(new Set($e||[]));if(X.length===0){e({title:"Selecione pelo menos um cliente",variant:"warning"});return}const nt=r?.codigo_empresa;if(n){try{const{data:We,error:ut}=await pe.from("comandas").select("id").eq("id",n).eq("codigo_empresa",nt).single();if(ut||!We){console.error("[ClientWizard] Comanda no encontrada:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Reiniciando...",variant:"warning"}),a(null),c([]),cr(!1),m("");try{localStorage.removeItem(Lt.comandaId),localStorage.removeItem(Lt.items),localStorage.removeItem(Lt.customerName),localStorage.removeItem(Lt.clientChosen)}catch{}Dt(!1);return}}catch(We){console.error("[ClientWizard] Erro ao validar comanda:",We),e({title:"Erro de validao",variant:"destructive"});return}try{await Kv({comandaId:n,clienteIds:X,nomesLivres:[],codigoEmpresa:nt})}catch(We){if(We?.message?.includes("violates foreign key")){console.error("[ClientWizard] Foreign key error, limpando cache:",We),a(null),c([]);try{localStorage.removeItem(Lt.comandaId),localStorage.removeItem(Lt.items)}catch{}e({title:"Comanda invlida",description:"Reinicie a venda.",variant:"destructive"}),Dt(!1);return}if(!We?.message?.includes("duplicate"))throw We;console.log("Alguns clientes j estavam vinculados, continuando...")}const it=(await Qi({comandaId:n,codigoEmpresa:nt})||[]).map(We=>We?.nome).filter(Boolean);m(it.length?it.join(", "):""),cr(!0),Dt(!1)}else{if(!nt){e({title:"Empresa no definida",variant:"destructive"});return}try{const qe=await Ej({codigoEmpresa:nt});if(!qe?.id){e({title:"Falha ao abrir venda",description:"No foi possvel criar a comanda.",variant:"destructive"});return}const it=qe.id;await Kv({comandaId:it,clienteIds:X,nomesLivres:[],codigoEmpresa:nt}),a(it);const We=(ye||[]).filter(At=>X.includes(At.id)).map(At=>At?.nome).filter(Boolean),ut=We.length?We.join(", "):"";m(ut),cr(!0);try{localStorage.setItem(Lt.comandaId,String(it)),localStorage.setItem(Lt.customerName,ut||""),localStorage.setItem(Lt.clientChosen,"true"),localStorage.removeItem(Lt.pendingClientIds)}catch{}try{await Pt(it,2)}catch{}Dt(!1)}catch(qe){console.error("[ClientWizard] Erro ao criar comanda de balco:",qe),e({title:"Falha ao iniciar venda",description:qe?.message||"Tente novamente.",variant:"destructive"});return}}if(y){const qe=y;b(null),await Kt(qe,{skipClientCheck:!0})}}catch(X){e({title:"Falha ao iniciar venda",description:X?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar"})]})]})}),o.jsx(ln,{open:!!Z,onOpenChange:X=>!X&&Y(null),children:o.jsx(sn,{className:"sm:max-w-[425px]",children:Z&&o.jsxs(o.Fragment,{children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-lg",children:Z.name}),o.jsx(_n,{className:"text-sm",children:"Detalhes do item"})]}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm font-medium",children:"Preo Unitrio"}),o.jsxs("p",{className:"text-lg font-bold",children:["R$ ",Number(Z.price).toFixed(2)]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm font-medium",children:"Quantidade"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(le,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async X=>{X.stopPropagation();const nt=r?.codigo_empresa;if(!nt){e({title:"Empresa no definida",variant:"destructive"});return}const qe=Math.max(0,Z.quantity-1);try{qe<=0?(await Av({itemId:Z.id,codigoEmpresa:nt}),Y(null)):(await Wc({itemId:Z.id,quantidade:qe,codigoEmpresa:nt}),Y({...Z,quantity:qe}));const it=await Si({comandaId:n,codigoEmpresa:nt});c((it||[]).map(We=>({id:We.id,productId:We.produto_id,name:We.descricao||"Item",price:Number(We.preco_unitario||0),quantity:Number(We.quantidade||1)})))}catch(it){e({title:"Erro ao atualizar quantidade",description:it?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),o.jsx("span",{className:"w-8 text-center font-semibold",children:Z.quantity}),o.jsx(le,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async X=>{X.stopPropagation();const nt=r?.codigo_empresa;if(!nt){e({title:"Empresa no definida",variant:"destructive"});return}const qe=Z.quantity+1;try{await Wc({itemId:Z.id,quantidade:qe,codigoEmpresa:nt}),Y({...Z,quantity:qe});const it=await Si({comandaId:n,codigoEmpresa:nt});c((it||[]).map(We=>({id:We.id,productId:We.produto_id,name:We.descricao||"Item",price:Number(We.preco_unitario||0),quantity:Number(We.quantidade||1)})))}catch(it){e({title:"Erro ao atualizar quantidade",description:it?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm font-medium",children:"Subtotal"}),o.jsxs("p",{className:"text-lg font-bold",children:["R$ ",(Z.quantity*Z.price).toFixed(2)]})]})]}),o.jsx(Un,{children:o.jsx(le,{variant:"destructive",onClick:async()=>{try{const X=r?.codigo_empresa;if(!X){e({title:"Empresa no definida",variant:"destructive"});return}await Av({itemId:Z.id,codigoEmpresa:X});const nt=await Si({comandaId:n,codigoEmpresa:X});c((nt||[]).map(qe=>({id:qe.id,productId:qe.produto_id,name:qe.descricao||"Item",price:Number(qe.preco_unitario||0),quantity:Number(qe.quantidade||1)}))),Y(null),e({title:"Item removido",variant:"success"})}catch(X){e({title:"Falha ao remover item",description:X?.message||"Tente novamente",variant:"destructive"})}},children:"Remover Item"})})]})})}),yt&&o.jsx("div",{className:"fixed left-3 right-3 z-[9999] md:hidden",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:o.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[o.jsx(pc,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),o.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:Sr||"Ateno"})]})})]})}async function Zae({userId:e,scope:t}){if(!e||!t)return null;try{const{data:r,error:n}=await pe.from("user_ui_settings").select("settings").eq("user_id",e).eq("scope",t).maybeSingle();return n?(console.error("[user_ui_settings] getUserUISettings:error",n),null):r?.settings||null}catch(r){return console.error("[user_ui_settings] getUserUISettings:exception",r),null}}async function eoe({userId:e,scope:t,settings:r}){if(!(!e||!t))try{const n={user_id:e,scope:t,settings:r||{},updated_at:new Date().toISOString()},{error:a}=await pe.from("user_ui_settings").upsert(n,{onConflict:"user_id,scope"});a&&console.error("[user_ui_settings] saveUserUISettings:error",a)}catch(n){console.error("[user_ui_settings] saveUserUISettings:exception",n)}}function aS(e){try{const r=new DOMParser().parseFromString(e,"text/xml"),n=r.querySelector("parsererror");if(n)throw new Error("XML invlido: "+n.textContent);const a=kat(r),i=Oat(r),s=Tat(r),l=Iat(r),c=s.reduce((u,f)=>u+(f.valorTotal||0),0),d={produtos:s,fornecedor:i,pagamentos:l,nfe:{...a,totalNota:c},success:!0};return console.log("[XMLParser] Resultado final:",d),{data:d,success:!0}}catch(t){return console.error("[XMLParser] Erro ao fazer parse do XML:",t),{produtos:[],fornecedor:null,nfe:null,success:!1,error:t.message}}}function kat(e){const t=e.querySelector("ide");if(!t)return null;let r="";const n=e.querySelector("chNFe");if(n&&(r=n.textContent.trim()),!r){const a=e.querySelector("infNFe");if(a){const i=a.getAttribute("Id");i&&(r=i.replace("NFe",""))}}return{numero:sa(t,"nNF"),serie:sa(t,"serie"),dataEmissao:sa(t,"dhEmi"),chaveAcesso:r,tipo:sa(t,"tpNF")==="0"?"Entrada":"Sada",naturezaOperacao:sa(t,"natOp"),modelo:sa(t,"mod")||null}}function Oat(e){const t=e.querySelector("emit");return t?{cnpj:sa(t,"CNPJ"),razaoSocial:sa(t,"xNome"),nomeFantasia:sa(t,"xFant"),endereco:{logradouro:sa(t,"xLgr"),numero:sa(t,"nro"),bairro:sa(t,"xBairro"),cidade:sa(t,"xMun"),uf:sa(t,"UF"),cep:sa(t,"CEP")}}:null}function Tat(e){const t=e.querySelectorAll("det"),r=new Map;return t.forEach((n,a)=>{const i=n.querySelector("prod"),s=n.querySelector("imposto");if(!i)return;const l=sa(i,"cProd"),c=sa(i,"cEAN"),d=sa(i,"xProd"),u=parseFloat(sa(i,"qCom")||"0"),f=c&&c!=="SEM GTIN"?`ean:${c}`:l?`cod:${l}`:`nome:${d.toLowerCase().trim()}`;if(r.has(f)){const m=r.get(f);m.quantidade+=u,m.valorTotal+=parseFloat(sa(i,"vProd")||"0")}else{const m={codigo:l,ean:c,nome:d,ncm:sa(i,"NCM"),cest:sa(i,"CEST"),cfop:sa(i,"CFOP"),unidade:sa(i,"uCom"),quantidade:u,valorUnitario:parseFloat(sa(i,"vUnCom")||"0"),precoVenda:parseFloat(sa(i,"vUnCom")||"0"),valorTotal:parseFloat(sa(i,"vProd")||"0"),desconto:parseFloat(sa(i,"vDesc")||"0"),impostos:Mat(s),descricao:d,origem:a+1};r.set(f,m)}}),Array.from(r.values())}function Iat(e){const t=e.querySelectorAll("pag"),r=[];return t.forEach(n=>{const a=sa(n,"tPag"),i=parseFloat(sa(n,"vPag")||"0");a&&r.push({codigoSefaz:a,valor:i,nome:Dat(a)})}),console.log("[XMLParser] Pagamentos extrados:",r),r}function Dat(e){return{"01":"Dinheiro","02":"Cheque","03":"Carto de Crdito","04":"Carto de Dbito","05":"Carto da Loja",10:"Vale Alimentao",11:"Vale Refeio",12:"Vale Presente",13:"Vale Combustvel",14:"Duplicata Mercantil",15:"Boleto Bancrio",16:"Depsito Bancrio",17:"PIX Dinmico",18:"Transferncia Bancria",19:"Programa de Fidelidade",20:"PIX Esttico",21:"Crdito em Loja",22:"Pagamento Eletrnico",90:"Sem Pagamento",99:"Outros"}[e]||"Outros"}function Mat(e){if(!e)return{};const t={},r=e.querySelector("ICMS");if(r){const s=r.children[0];s&&(t.icms={cst:sa(s,"CST"),csosn:sa(s,"CSOSN"),aliquota:parseFloat(sa(s,"pICMS")||"0"),valor:parseFloat(sa(s,"vICMS")||"0")})}const n=e.querySelector("PIS");if(n){const s=n.children[0];s&&(t.pis={cst:sa(s,"CST"),aliquota:parseFloat(sa(s,"pPIS")||"0"),valor:parseFloat(sa(s,"vPIS")||"0")})}const a=e.querySelector("COFINS");if(a){const s=a.children[0];s&&(t.cofins={cst:sa(s,"CST"),aliquota:parseFloat(sa(s,"pCOFINS")||"0"),valor:parseFloat(sa(s,"vCOFINS")||"0")})}const i=e.querySelector("IPI");if(i){const s=i.querySelector("IPITrib");s&&(t.ipi={cst:sa(s,"CST"),aliquota:parseFloat(sa(s,"pIPI")||"0"),valor:parseFloat(sa(s,"vIPI")||"0")})}return t}function sa(e,t){if(!e)return"";const r=e.querySelector(t);return r?r.textContent.trim():""}function oS(e,t){const r=e.unidade?.toUpperCase().trim()||"";if(e.ean&&e.ean!=="SEM GTIN"){const a=t.find(s=>{const l=s.unit?.toUpperCase().trim()||"";return s.barcode===e.ean&&l===r});if(a)return a;const i=t.find(s=>s.barcode===e.ean);i&&console.log("[xmlParser] EAN igual mas unidade diferente (no considerar o mesmo produto):",{ean:e.ean,unidadeXML:r,unidadeSistema:(i.unit||"").toUpperCase()})}if(e.codigo){const a=t.find(s=>{const l=s.unit?.toUpperCase().trim()||"";return s.code===e.codigo&&l===r});if(a)return a;const i=t.find(s=>s.code===e.codigo);i&&console.log("[xmlParser] Cdigo igual mas unidade diferente (no considerar o mesmo produto):",{codigo:e.codigo,unidadeXML:r,unidadeSistema:(i.unit||"").toUpperCase()})}const n=e.nome?.toLowerCase().trim()||"";if(n){const a=t.find(i=>{const s=i.name?.toLowerCase().trim()||"",l=i.unit?.toUpperCase().trim()||"",c=s===n,d=l===r,u=c&&d;return c&&!d&&(console.log("[xmlParser] Nome igual mas UNIDADE diferente - NO  o mesmo produto:"),console.log("  Nome XML:",n,"| Unidade XML:",r),console.log("  Nome Sistema:",s,"| Unidade Sistema:",l)),u&&(console.log("[xmlParser] MATCH ENCONTRADO (nome + unidade):"),console.log("  XML:",n,"| Unidade:",r),console.log("  Sistema:",s,"| Unidade:",l),console.log("  Produto:",i)),u});if(a)return console.log("[xmlParser] Produto existente encontrado por nome + unidade:",a.name,a.unit),a}return console.log("[xmlParser] Nenhum produto encontrado para:",n,"| Unidade:",r),null}function P4(e,t){const r=e.valorUnitario||0,n=30,a=r>0?r/(1-n/100):0;return{code:e.codigo||"",name:e.nome||"",barcode:e.ean&&e.ean!=="SEM GTIN"?e.ean:"",ncm:e.ncm||"",cest:e.cest||"",unit:e.unidade||"UN",costPrice:r,salePrice:a,price:a,stock:0,minStock:0,status:"active",active:!0,type:"Venda",category:"Importados",cfopInterno:e.cfop||"",cstIcmsInterno:e.impostos?.icms?.cst||"",csosnInterno:e.impostos?.icms?.csosn||"",aliqIcmsInterno:e.impostos?.icms?.aliquota||0,cstPisEntrada:e.impostos?.pis?.cst||"",aliqPisPercent:e.impostos?.pis?.aliquota||0,aliqCofinsPercent:e.impostos?.cofins?.aliquota||0,cstIpi:e.impostos?.ipi?.cst||"",aliqIpiPercent:e.impostos?.ipi?.aliquota||0,codigo_empresa:t,importedViaXML:!0,dataImportacao:new Date,xmlChave:e?.xmlChave||null,xmlNumero:e?.xmlNumero||null,xmlSerie:e?.xmlSerie||null,xmlEmissao:e?.xmlEmissao||null}}async function Rat(e,t){if(!e||!t)return null;const r=e.replace(/\D/g,"");try{const{data:n,error:a}=await pe.from("clientes").select("*").eq("codigo_empresa",t).eq("cnpj",r).eq("flag_fornecedor",!0).maybeSingle();if(a)throw a;return n}catch(n){throw console.error("[Suppliers] Erro ao buscar fornecedor:",n),n}}async function Lat(e,t){if(!e||!t)throw new Error("Dados do fornecedor e cdigo da empresa so obrigatrios");const r=e.cnpj?.replace(/\D/g,"")||"";if(!r)throw new Error("CNPJ do fornecedor no encontrado no XML");const n={codigo_empresa:t,tipo_pessoa:"PJ",cnpj:r,nome:e.razaoSocial||"Fornecedor Importado",apelido:e.nomeFantasia||e.razaoSocial,flag_fornecedor:!0,flag_cliente:!1,status:"active",endereco:e.endereco?.logradouro||null,numero:e.endereco?.numero||null,bairro:e.endereco?.bairro||null,cidade:e.endereco?.cidade||null,uf:e.endereco?.uf||null,cep:e.endereco?.cep?.replace(/\D/g,"")||null};try{const{data:a,error:i}=await pe.from("clientes").insert(n).select().single();if(i)throw i;return console.log("[Suppliers] Fornecedor criado:",a),a}catch(a){throw console.error("[Suppliers] Erro ao criar fornecedor:",a),a}}async function $at(e,t){if(!e?.cnpj)throw new Error("CNPJ do fornecedor no encontrado no XML");try{const r=await Rat(e.cnpj,t);return r?(console.log("[Suppliers] Fornecedor encontrado:",r.razao_social),r):(console.log("[Suppliers] Criando novo fornecedor:",e.razaoSocial),await Lat(e,t))}catch(r){throw console.error("[Suppliers] Erro ao buscar/criar fornecedor:",r),r}}async function Fat(e,t){if(!e||!t)return null;try{const{data:r,error:n}=await pe.from("compras").select("*").eq("codigo_empresa",t).eq("chave_nfe",e).order("ativo",{ascending:!1}).maybeSingle();if(n)throw n;return r}catch(r){throw console.error("[Purchases] Erro ao buscar compra:",r),r}}async function Bat(e){const t={codigo_empresa:e.codigoEmpresa,fornecedor_id:e.fornecedorId,chave_nfe:e.chaveNfe,numero_nfe:e.numeroNfe,serie_nfe:e.serieNfe,data_emissao:e.dataEmissao,tipo_operacao:e.tipoOperacao,natureza_operacao:e.naturezaOperacao,valor_produtos:e.valorProdutos,valor_total:e.valorTotal,forma_pagamento:e.formaPagamento||null,status:"processada",observacoes:e.observacoes||null,xml_completo:e.xmlCompleto||null};try{const{data:r,error:n}=await pe.from("compras").insert(t).select().single();if(n)throw n;return console.log("[Purchases] Compra criada:",r.numero_nfe,"ID:",r.id),r}catch(r){throw console.error("[Purchases] Erro ao criar compra:",r),r}}async function toe(e,t){if(!e||!t||t.length===0)throw new Error("ID da compra e itens so obrigatrios");const r=t.map(n=>({compra_id:e,produto_id:n.produtoId||null,codigo_produto_xml:n.codigoProdutoXML||null,nome_produto_xml:n.nomeProdutoXML,ean_xml:n.eanXML||null,ncm_xml:n.ncmXML||null,cfop_xml:n.cfopXML||null,unidade_xml:n.unidadeXML||null,quantidade:n.quantidade,valor_unitario:n.valorUnitario,valor_total:n.valorTotal,valor_desconto:n.valorDesconto||0,valor_frete:n.valorFrete||0,valor_seguro:n.valorSeguro||0,valor_outras_despesas:n.valorOutrasDespesas||0,icms_aliquota:n.icmsAliquota||null,icms_valor:n.icmsValor||null,ipi_aliquota:n.ipiAliquota||null,ipi_valor:n.ipiValor||null,pis_aliquota:n.pisAliquota||null,pis_valor:n.pisValor||null,cofins_aliquota:n.cofinsAliquota||null,cofins_valor:n.cofinsValor||null,vinculado_manualmente:n.vinculadoManualmente||!1,observacoes:n.observacoes||null,selecionado_na_importacao:n.selecionadoNaImportacao||!1}));try{const{data:n,error:a}=await pe.from("compras_itens").insert(r).select();if(a)throw a;return console.log("[Purchases] Itens criados:",n.length),n}catch(n){throw console.error("[Purchases] Erro ao criar itens:",n),n}}async function qat(e,t={}){if(!e)return{data:[],count:0};try{const r=t.page&&t.page>0?t.page:1,n=t.pageSize&&t.pageSize>0?t.pageSize:100,a=(r-1)*n,i=a+n-1;let s=pe.from("compras").select("*,fornecedor:clientes!compras_fornecedor_id_fkey(id,nome,cnpj)",{count:"exact"}).eq("codigo_empresa",e);t.apenasInativas?s=s.eq("ativo",!1):t.incluirInativas||(s=s.eq("ativo",!0)),t.status&&(s=s.eq("status",t.status)),t.fornecedorId&&(s=s.eq("fornecedor_id",t.fornecedorId)),t.dataInicio&&(s=s.gte("data_emissao",t.dataInicio)),t.dataFim&&(s=s.lte("data_emissao",t.dataFim)),s=s.order("data_emissao",{ascending:!1}).range(a,i);const{data:l,error:c,count:d}=await s;if(c)throw c;return{data:l||[],count:d??0}}catch(r){return console.error("[Purchases] Erro ao listar compras:",r),{data:[],count:0}}}async function roe(e){try{const{data:t,error:r}=await pe.from("compras_itens").select(`
        *,
        produto:produto_id(id, nome, codigo_produto, codigo_barras, data_importacao)
      `).eq("compra_id",e).order("criado_em",{ascending:!0});if(r)throw console.error("[Purchases] Erro ao buscar itens:",r),r;return t}catch(t){throw console.error("[Purchases] Erro ao buscar itens:",t),t}}async function zat(e,t,r){if(!e||!t)throw new Error("ID da compra e motivo so obrigatrios");try{const{data:n,error:a}=await pe.from("compras").update({ativo:!1,motivo_inativacao:t,inativado_em:new Date().toISOString(),inativado_por:r}).eq("id",e).select().single();if(a)throw a;return console.log("[Purchases] Compra inativada:",e),n}catch(n){throw console.error("[Purchases] Erro ao inativar compra:",n),n}}async function Uat(e){try{console.log("[Purchases] Deletando itens da compra:",e);const{error:t}=await pe.from("compras_itens").delete().eq("compra_id",e);if(t)throw console.error("[Purchases] Erro ao deletar itens:",t),t;return console.log("[Purchases] Itens deletados com sucesso"),!0}catch(t){throw console.error("[Purchases] Erro ao deletar itens:",t),t}}async function Vat(e,t){try{return console.log("[Purchases] Reprocessando XML da compra:",e),await Uat(e),await toe(e,t),console.log("[Purchases] XML reprocessado com sucesso"),!0}catch(r){throw console.error("[Purchases] Erro ao reprocessar XML:",r),r}}async function Wat(e,t){try{console.log("[Purchases] Atualizando compra:",e,t);const{data:r,error:n}=await pe.from("compras").update({fornecedor_id:t.fornecedorId,numero_nfe:t.numeroNfe,serie_nfe:t.serieNfe,data_emissao:t.dataEmissao,tipo_operacao:t.tipoOperacao,natureza_operacao:t.naturezaOperacao,valor_produtos:t.valorProdutos,valor_total:t.valorTotal,forma_pagamento:t.formaPagamento,observacoes:t.observacoes,atualizado_em:new Date().toISOString()}).eq("id",e).select().single();if(n)throw console.error("[Purchases] Erro ao atualizar compra:",n),n;return console.log("[Purchases] Compra atualizada:",r),r}catch(r){throw console.error("[Purchases] Erro ao atualizar compra:",r),r}}function noe({isOpen:e,onClose:t,onSelect:r,currentProduct:n}){const{userProfile:a}=Do(),[i,s]=p.useState([]),[l,c]=p.useState(!0),[d,u]=p.useState(""),[f,m]=p.useState(null);p.useEffect(()=>{e&&a?.codigo_empresa&&h()},[e,a?.codigo_empresa]);const h=async()=>{try{c(!0),console.log("[ProductSelectionModal] Carregando produtos para empresa:",a.codigo_empresa);const y=await Uu({codigoEmpresa:a.codigo_empresa,includeInactive:!1,search:""});console.log("[ProductSelectionModal] Produtos carregados:",y?.length||0),console.log("[ProductSelectionModal] Primeiro produto:",y?.[0]),console.log("[ProductSelectionModal] Estrutura do produto:",Object.keys(y?.[0]||{})),s(y||[])}catch(y){console.error("[ProductSelectionModal] Erro ao carregar produtos:",y),s([])}finally{c(!1)}},v=p.useMemo(()=>{if(console.log("[ProductSelectionModal] Filtrando produtos. Total:",i.length,"Busca:",d),!d.trim())return i;const y=d.toLowerCase().trim(),b=i.filter(w=>(w.name||w.nome)?.toLowerCase().includes(y)||(w.code||w.codigo_produto)?.toLowerCase().includes(y)||(w.barcode||w.codigo_barras)?.toLowerCase().includes(y));return console.log("[ProductSelectionModal] Produtos filtrados:",b.length),b},[i,d]),g=()=>{f?(console.log("[ProductSelectionModal] Produto selecionado para vinculao:",f),console.log("[ProductSelectionModal] ID do produto:",f.id),console.log("[ProductSelectionModal] Nome do produto:",f.name),r(f),x()):console.log("[ProductSelectionModal] ERRO: Nenhum produto selecionado")},x=()=>{u(""),m(null),t()};return o.jsx(ln,{open:e,onOpenChange:x,children:o.jsxs(sn,{className:"w-[95vw] sm:max-w-3xl max-h-[80vh] overflow-hidden flex flex-col bg-black text-white border border-neutral-700",children:[o.jsxs(an,{className:"bg-neutral-900 -mx-6 -mt-6 mb-4 px-6 py-4 border-b border-neutral-600",children:[o.jsxs(nn,{className:"flex items-center gap-2 text-white",children:[o.jsx(gd,{className:"h-5 w-5 text-yellow-500"}),"Selecionar Produto para Vinculao"]}),o.jsx(_n,{className:"text-neutral-300",children:"Busque e selecione um produto cadastrado para vincular ao item do XML"})]}),o.jsx("div",{className:"px-6 pb-4",children:o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400"}),o.jsx(ir,{placeholder:"Buscar por nome, cdigo do produto ou cdigo de barras...",value:d,onChange:y=>u(y.target.value),className:"pl-10 bg-neutral-900 border-neutral-600 text-white placeholder-neutral-400 focus:border-yellow-500",autoFocus:!0})]})}),o.jsx("div",{className:"flex-1 overflow-hidden flex flex-col px-6",children:l?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500 mb-4"}),o.jsx("p",{className:"text-neutral-400",children:"Carregando produtos..."})]})}):v.length===0?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(gd,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),o.jsx("p",{className:"text-neutral-400",children:d?"Nenhum produto encontrado":"Nenhum produto cadastrado"}),d&&o.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"Tente buscar por nome, cdigo ou cdigo de barras"})]})}):o.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:o.jsx("ul",{className:"space-y-2",children:v.map(y=>{const b=y.code||y.codigo_produto,w=y.name||y.nome||"Produto sem nome",j=y.stock||y.estoque||0,_=Number(y.salePrice||y.preco_venda||0),S=f?.id===y.id;return o.jsxs("li",{className:`flex items-center gap-3 p-3 rounded-lg transition-all cursor-pointer border-2 ${S?"border-yellow-500 bg-yellow-500/10":"border-neutral-600 bg-black hover:border-yellow-400 hover:bg-neutral-900"}`,onClick:()=>m(y),children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"flex items-center gap-2 mb-1",children:o.jsxs("p",{className:"font-semibold text-white truncate",title:`${b?`[${b}] `:""}${w}`,children:[b&&o.jsxs("span",{className:"text-neutral-400",children:["[",b,"]"]})," ",w]})}),o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("p",{className:"text-sm text-neutral-300",children:["R$ ",_.toFixed(2)]}),o.jsxs("span",{className:"text-xs font-medium text-neutral-400 whitespace-nowrap",children:["Estoque: ",j]})]})]}),S&&o.jsx(Tf,{className:"h-5 w-5 text-yellow-500 flex-shrink-0"})]},y.id)})})})}),o.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-neutral-600 px-6 pb-6",children:[o.jsxs("div",{className:"text-sm text-neutral-400",children:[v.length," produto",v.length!==1?"s":"",d&&` encontrado${v.length!==1?"s":""}`]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(le,{variant:"outline",onClick:x,className:"border-neutral-600 text-neutral-300 hover:bg-neutral-700",children:"Cancelar"}),o.jsxs(le,{onClick:g,disabled:!f,className:"gap-2 bg-yellow-600 hover:bg-yellow-700 text-black",children:[o.jsx(Tf,{className:"h-4 w-4"}),"Vincular Produto"]})]})]})]})})}function aoe({isOpen:e,onClose:t,onConfirm:r,products:n,editedProducts:a,isReprocess:i=!1,allProducts:s=[]}){if(!e||!n)return null;const l=n.filter(d=>d.selected),c=l.reduce((d,u,f)=>{const m=u.originalIndex!==void 0?u.originalIndex:f,h=a[m]||{},v=h.linkedProductId,g=h.updatePrice,x=Number(h.quantity||h.qty||u.xml?.quantidade||0);let y=0;if(h.salePrice!=null?y=Number(h.salePrice):h.margin!=null&&u.xml?.valorUnitario?y=Number(u.xml.valorUnitario)*(1+h.margin/100):u.xml?.precoVenda&&(y=Number(u.xml.precoVenda)),u.isNew&&!v)d.newProducts.push({name:h.name||u.xml?.nome,quantity:x,price:y,total:x*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome});else if(v||u.existing){const b=v&&s.find(k=>k.id===v)||u.existing,w=Number(b?.stock||0),j=Number(b?.preco_venda||b?.salePrice||b?.price||0),_=i?0:x,S=i?w:w+x;d.updatedProducts.push({name:b?.name||h.name||u.xml?.nome,currentStock:w,newStock:S,stockChange:_,currentPrice:j,newPrice:g?y:j,priceChange:g?y-j:0,willUpdatePrice:g,total:x*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome,isLinked:!!v,linkedProductId:v,linkedProductName:v?b?.name:null})}else v&&d.linkedProducts.push({xmlName:u.xml?.nome,linkedName:h.name||u.xml?.nome,quantity:x,total:x*(u.xml?.valorUnitario||0),linkedProductId:v});return d.totalValue+=x*(u.xml?.valorUnitario||0),d.totalItems+=x,d},{newProducts:[],updatedProducts:[],linkedProducts:[],totalValue:0,totalItems:0});return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(sn,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[o.jsx(an,{children:o.jsxs(nn,{className:"flex items-center gap-2",children:[o.jsx(Of,{className:"h-5 w-5 text-warning"}),"Confirmar ",i?"Reprocessamento":"Importao"]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[o.jsx(gd,{className:"h-4 w-4 text-warning"}),o.jsx("span",{className:"font-medium",children:"Total de Produtos"})]}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:l.length})]}),o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[o.jsx(nue,{className:"h-4 w-4 text-warning"}),o.jsx("span",{className:"font-medium",children:"Total de Itens"})]}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:c.totalItems})]}),o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[o.jsx(Ui,{className:"h-4 w-4 text-warning"}),o.jsx("span",{className:"font-medium",children:"Valor Total"})]}),o.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:["R$ ",c.totalValue.toFixed(2)]})]})]}),!i&&c.newProducts.length>0&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-4 border-b border-border",children:o.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(Ga,{className:"h-4 w-4 text-success"}),"Produtos que sero criados (",c.newProducts.length,")"]})}),o.jsx("div",{className:"p-4 space-y-3",children:c.newProducts.map((d,u)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:d.name}),o.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",d.quantity,"  Preo unit.: R$ ",(d.total/d.quantity).toFixed(2),"  Total: R$ ",d.total.toFixed(2)]})]}),o.jsx("div",{className:"text-right",children:o.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})})]},u))})]}),!i&&c.updatedProducts.length>0&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-4 border-b border-border",children:o.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(Ap,{className:"h-4 w-4 text-info"}),"Produtos que sero atualizados (",c.updatedProducts.length,")"]})}),o.jsx("div",{className:"p-4 space-y-3",children:c.updatedProducts.map((d,u)=>o.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[d.isLinked?o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(gH,{className:"h-4 w-4 text-warning"}),o.jsxs("p",{className:"font-medium text-text-primary",children:[d.xmlName,"  ",d.linkedProductName||d.name]})]}):o.jsx("p",{className:"font-medium text-text-primary",children:d.name}),o.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[i?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-muted",children:"Estoque:"}),o.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),o.jsx("span",{className:"text-text-muted",children:"(sem alterao no reprocesso)"})]}):o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-muted",children:"Estoque:"}),o.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),o.jsx(Wp,{className:"h-3 w-3 text-success"}),o.jsx("span",{className:"font-medium text-success",children:d.newStock}),o.jsxs("span",{className:"text-success",children:["(+",d.stockChange,")"]})]}),d.willUpdatePrice&&d.priceChange!==0&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-muted",children:"Preo:"}),o.jsxs("span",{className:"font-medium text-text-primary",children:["R$ ",d.currentPrice.toFixed(2)]}),d.priceChange>0?o.jsx(Wp,{className:"h-3 w-3 text-success"}):o.jsx(vue,{className:"h-3 w-3 text-destructive"}),o.jsxs("span",{className:`font-medium ${d.priceChange>0?"text-success":"text-destructive"}`,children:["R$ ",d.newPrice.toFixed(2)]}),o.jsxs("span",{className:d.priceChange>0?"text-success":"text-destructive",children:["(",d.priceChange>0?"+":"","R$ ",d.priceChange.toFixed(2),")"]})]})]})]}),o.jsxs("div",{className:"text-right",children:[i?o.jsxs("p",{className:"text-xs text-text-muted",children:["Total NF-e (custo): R$ ",d.total.toFixed(2)]}):o.jsxs("p",{className:"text-xs text-text-muted",children:["Unit.: R$ ",(d.total/d.stockChange).toFixed(2)]}),o.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})]})]})},u))})]}),i&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-4 border-b border-border",children:o.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(Ap,{className:"h-4 w-4 text-info"}),"Itens da NF-e que sero reprocessados (",l.length,")"]})}),o.jsx("div",{className:"p-4 space-y-3",children:l.map((d,u)=>{const f=d.originalIndex!==void 0?d.originalIndex:u,m=a[f]||{},h=Number(m.quantity||m.qty||d.xml?.quantidade||0),v=Number(d.xml?.valorUnitario||0),g=h*v;return o.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:d.xml?.nome}),o.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",h,"  Valor unit.: R$ ",v.toFixed(2),"  Total: R$ ",g.toFixed(2)]})]}),o.jsx("div",{className:"text-right",children:o.jsxs("p",{className:"font-medium text-warning",children:["R$ ",g.toFixed(2)]})})]},u)})})]}),o.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Of,{className:"h-5 w-5 text-warning flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-warning mb-2",children:i?"Ateno - Reprocessamento":"Ateno - Importao"}),o.jsxs("ul",{className:"text-sm text-text-muted space-y-1",children:[i?o.jsxs(o.Fragment,{children:[o.jsx("li",{children:" Os itens atuais da compra sero substitudos pelos selecionados"}),o.jsx("li",{children:" As quantidades de estoque sero ajustadas conforme as mudanas"}),o.jsx("li",{children:" Esta ao no pode ser desfeita automaticamente"})]}):o.jsxs(o.Fragment,{children:[o.jsx("li",{children:" Os produtos selecionados sero criados ou atualizados no sistema"}),o.jsx("li",{children:" As quantidades sero adicionadas ao estoque atual"}),o.jsx("li",{children:" Uma nova compra ser registrada no histrico"})]}),o.jsx("li",{children:" Verifique cuidadosamente as informaes antes de confirmar"})]})]})]})})]}),o.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[o.jsxs("div",{className:"text-sm text-text-muted",children:[l.length," produto",l.length!==1?"s":""," selecionado",l.length!==1?"s":""]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(le,{variant:"outline",onClick:t,children:"Cancelar"}),o.jsxs(le,{onClick:r,className:"gap-2",children:[o.jsx(Ap,{className:"h-4 w-4"}),"Confirmar ",i?"Reprocessamento":"Importao"]})]})]})]})})}function Hat({open:e,onOpenChange:t,products:r,codigoEmpresa:n,onSuccess:a}){const{toast:i}=ro(),[s,l]=p.useState("upload"),[c,d]=p.useState(null),[u,f]=p.useState(null),[m,h]=p.useState([]),[v,g]=p.useState(!1),[x,y]=p.useState({created:0,updated:0,errors:0,details:[]}),[b,w]=p.useState({}),[j,_]=p.useState({}),[S,k]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[E,A]=p.useState({isOpen:!1}),M=()=>{const L=u?.nfe?.modelo;return L==="55"?"NF-e":L==="65"?"NFC-e":"NF-e / NFC-e"},C=async L=>{const V=L.target.files?.[0];if(!V){console.log("[XMLImport] Nenhum arquivo selecionado");return}if(console.log("[XMLImport] Arquivo selecionado:",V.name),!V.name.endsWith(".xml")){i({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}d(V);try{console.log("[XMLImport] Lendo contedo do arquivo...");const re=await V.text();console.log("[XMLImport] Arquivo lido, parseando XML...");const me=aS(re);if(console.log("[XMLImport] XML parseado:",me),!me.success){i({title:"Erro ao ler XML",description:me.error||"XML invlido",variant:"destructive"});return}if(!me.data?.produtos||me.data.produtos.length===0){i({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}f(me.data);let G=r;try{G=await Uu({search:"",codigoEmpresa:n,includeInactive:!0})||r,console.log("[XMLImport] Produtos carregados para validao:",G.length),console.log("[XMLImport] Nomes dos produtos:",G.map(je=>je.name))}catch(J){console.warn("[XMLImport] No foi possvel carregar lista completa, usando cache:",J)}const Q=me.data.produtos.map((J,je)=>{const be=oS(J,G),Ue={...J};if(J.impostos){const{icms:Z,pis:Y,cofins:lt,ipi:gt}=J.impostos;Z&&(Ue.icmsAliquota=Z.aliquota??Ue.icmsAliquota,Ue.icmsValor=Z.valor??Ue.icmsValor),gt&&(Ue.ipiAliquota=gt.aliquota??Ue.ipiAliquota,Ue.ipiValor=gt.valor??Ue.ipiValor),Y&&(Ue.pisAliquota=Y.aliquota??Ue.pisAliquota,Ue.pisValor=Y.valor??Ue.pisValor),lt&&(Ue.cofinsAliquota=lt.aliquota??Ue.cofinsAliquota,Ue.cofinsValor=lt.valor??Ue.cofinsValor)}return{xml:Ue,existing:be,isNew:!be,willCreate:!be,willUpdate:!!be,selected:!0,index:je}});h(Q);const ae={};Q.forEach((J,je)=>{J.xml.precoVenda&&(ae[je]={salePrice:Number(J.xml.precoVenda)})}),console.log("[XMLImport] Pr-populando editedProducts:",ae),w(ae),console.log("[XMLImport] Preview preparado, mudando para step preview. Total produtos:",Q.length),l("preview")}catch(re){console.error("[XMLImport] Erro ao processar arquivo:",re),i({title:"Erro ao processar XML",description:re.message,variant:"destructive"})}},T=()=>{A({isOpen:!0})},I=async()=>{A({isOpen:!1});let L="";if(c)try{L=await c.text()}catch(G){console.error("[XMLImport] Erro ao ler XML:",G),i({title:"Erro ao ler XML",description:"No foi possvel ler o arquivo XML.",variant:"destructive"});return}l("processing"),g(!0);const V={created:0,updated:0,errors:0,skipped:0,details:[],supplierId:null},re=m.filter(G=>G.selected);if(re.length===0){i({title:"Nenhum produto selecionado",description:"Selecione ao menos um produto para importar.",variant:"warning"}),g(!1),l("preview");return}let me=null;if(u?.fornecedor)try{me=await $at(u.fornecedor,n),V.supplierId=me.id,console.log("[XMLImport] Fornecedor processado:",me.razao_social,"ID:",me.id)}catch(G){console.error("[XMLImport] Erro ao processar fornecedor:",G),i({title:"Aviso",description:"No foi possvel criar/vincular o fornecedor, mas os produtos sero importados.",variant:"warning"})}console.log("[XMLImport] Processando apenas produtos selecionados:",re.length);for(const G of re){const Q=b[G.index]||{},ae=Q.name||G.xml.nome,J=Q.qty!==void 0?Q.qty:Number(G.xml.quantidade),je=Q.margin,be=Q.salePrice,Ue=Q.linkedProductId;try{if(Ue&&Ue!=="force-new"){J>0&&await Xv({productId:Ue,delta:J,codigoEmpresa:n}),V.updated++,V.details.push({produto:ae,acao:`Vinculado - Estoque atualizado (+${J})`,status:"success"});continue}if(G.isNew||Ue==="force-new"){const Z=P4(G.xml,n);if(Q.name&&(Z.name=Q.name),be!=null)Z.salePrice=be,Z.price=be;else if(je!=null&&je>0){const Y=Z.costPrice||0;if(Y>0){const lt=Y*(1+je/100);Z.salePrice=lt,Z.price=lt}}else Z.salePrice!=null&&Z.price==null&&(Z.price=Z.salePrice);Z.stock=J,Z.initialStock=J,Z.currentStock=J,Z.importedViaXML=!0,Z.category="Importados",u?.nfe&&(Z.xmlChave=u.nfe.chaveAcesso||null,Z.xmlNumero=u.nfe.numero||null,Z.xmlSerie=u.nfe.serie||null,Z.xmlEmissao=u.nfe.dataEmissao||null);try{await nS(Z,{codigoEmpresa:n}),V.created++,V.details.push({produto:ae,acao:"Criado",status:"success"})}catch(Y){if(Y.message?.includes("duplicate")||Y.message?.includes("unique constraint")){console.warn("[XMLImport] Produto j existe, tentando atualizar estoque:",G.xml.nome);const gt=(await Uu({search:G.xml.nome,codigoEmpresa:n,includeInactive:!0})).find(Te=>{const at=(Te.name||"").toLowerCase().trim()===(G.xml.nome||"").toLowerCase().trim(),yt=(Te.unit||"").toUpperCase().trim()===(G.xml.unidade||"").toUpperCase().trim(),vt=(Te.barcode||"")===(G.xml.ean||""),Sr=(Te.code||"")===(G.xml.codigo||""),se=at&&yt||vt&&yt||Sr&&yt;return!se&&(vt||Sr)&&!yt&&console.log("[XMLImport] Encontrado mesmo EAN/Cdigo porm unidade diferente. NO unir:",{nomeSistema:Te.name,unidadeSistema:Te.unit,nomeXML:G.xml.nome,unidadeXML:G.xml.unidade,ean:G.xml.ean,codigo:G.xml.codigo}),se});if(gt&&Number(G.xml.quantidade)>0)await Xv({productId:gt.id,delta:Number(G.xml.quantidade)||0,codigoEmpresa:n}),V.updated++,V.details.push({produto:G.xml.nome,acao:"J existe - Estoque atualizado",status:"success"});else if(gt)V.skipped++,V.details.push({produto:G.xml.nome,acao:"Sem quantidade para ajustar",status:"warning"});else try{console.log("[XMLImport] Duplicate report mas no encontrou por nome+unidade/EAN+unidade/cdigo+unidade. Tentando criar novo produto.");const Te=P4(G.xml,n);Te.salePrice!=null&&Te.price==null&&(Te.price=Te.salePrice);const at=Number(G.xml.quantidade)||0;Te.stock=at,Te.initialStock=at,Te.currentStock=at,await nS(Te,{codigoEmpresa:n}),V.created++,V.details.push({produto:G.xml.nome,acao:"Criado aps checagem",status:"success"})}catch(Te){console.warn("[XMLImport] Falhou ao criar aps duplicate:",Te),V.skipped++,V.details.push({produto:G.xml.nome,acao:"Falha ao criar aps duplicate",status:"warning"})}}else throw Y}}else{const Z=Number(G.xml.quantidade)||0;if(Z>0&&await Xv({productId:G.existing.id,delta:Z,codigoEmpresa:n}),Q.updatePrice===!0){const lt=Number(G.xml.valorUnitario)||0;if(lt>0)try{const gt={costPrice:lt};if(be!=null)gt.salePrice=be,gt.price=be;else if(je!=null&&je>0){const Te=lt*(1+je/100);gt.salePrice=Te,gt.price=Te}await T5(G.existing.id,gt)}catch(gt){console.warn("[XMLImport] Falha ao atualizar preo do produto existente",gt)}}V.updated++,V.details.push({produto:G.xml.nome,acao:Z>0?`Estoque +${Z} (somado)`:"Verificado",status:"success"})}}catch(Z){console.error("[XMLImport] Erro ao processar produto:",G.xml.nome,Z),V.errors++,V.details.push({produto:G.xml.nome,acao:"Erro",status:"error",error:Z.message})}}if(u?.nfe?.chaveAcesso&&me)try{const G=await Fat(u.nfe.chaveAcesso,n);let Q=G;if(!G||!G.ativo){const J={codigoEmpresa:n,fornecedorId:me.id,chaveNfe:u.nfe.chaveAcesso,numeroNfe:u.nfe.numero,serieNfe:u.nfe.serie,dataEmissao:u.nfe.dataEmissao,tipoOperacao:u.nfe.tipo||"Entrada",naturezaOperacao:u.nfe.naturezaOperacao,valorProdutos:u.nfe.totalNota||0,valorTotal:u.nfe.totalNota||0,xmlCompleto:L,formaPagamento:u.pagamentos&&u.pagamentos.length>0?u.pagamentos.map(je=>je.nome).join(", "):null};Q=await Bat(J),console.log("[XMLImport] Nova compra registrada:",Q.numero_nfe)}else console.log("[XMLImport] NF-e j existe, adicionando novos itens:",G.numero_nfe),V.purchaseAlreadyExists=!0;const ae=re.map(J=>{const je=b[J.index]||{},be=je.linkedProductId;let Ue=null;return be&&be!=="force-new"?Ue=be:J.existing&&!be&&(Ue=J.existing.id),{produtoId:Ue,codigoProdutoXML:J.xml.codigo,nomeProdutoXML:J.xml.nome,eanXML:J.xml.ean,ncmXML:J.xml.ncm,cfopXML:J.xml.cfop,unidadeXML:J.xml.unidade,quantidade:je.qty!==void 0?je.qty:Number(J.xml.quantidade),valorUnitario:Number(J.xml.valorUnitario)||0,valorTotal:Number(J.xml.valorTotal)||0,valorDesconto:J.xml.valorDesconto||0,valorFrete:J.xml.valorFrete||0,valorSeguro:J.xml.valorSeguro||0,valorOutrasDespesas:J.xml.valorOutrasDespesas||0,icmsAliquota:J.xml.icmsAliquota,icmsValor:J.xml.icmsValor,ipiAliquota:J.xml.ipiAliquota,ipiValor:J.xml.ipiValor,pisAliquota:J.xml.pisAliquota,pisValor:J.xml.pisValor,cofinsAliquota:J.xml.cofinsAliquota,cofinsValor:J.xml.cofinsValor,vinculadoManualmente:!!je.linkedProductId,observacoes:je.observacoes||null,selecionadoNaImportacao:J.selected}});await toe(Q.id,ae),console.log("[XMLImport] Itens adicionados  compra:",ae.length),V.purchaseId=Q.id}catch(G){console.error("[XMLImport] Erro ao registrar compra:",G)}y(V),g(!1),l("done"),V.purchaseAlreadyExists?i({title:"NF-e j importada!",description:`Esta NF-e j existe no sistema. ${V.created} produto(s) criado(s), ${V.updated} atualizado(s).`,variant:"warning"}):V.errors===0?i({title:"Importao concluda!",description:`${V.created} produto(s) criado(s), ${V.updated} atualizado(s).`,variant:"success"}):i({title:"Importao concluda com erros",description:`${V.created} criado(s), ${V.updated} atualizado(s), ${V.errors} erro(s).`,variant:"warning"}),a&&a()},D=()=>{console.log("[XMLImport] Fechando modal"),l("upload"),d(null),f(null),h([]),w({}),_({}),y({created:0,updated:0,errors:0,details:[]}),t(!1)};xe.useEffect(()=>{e&&console.log("[XMLImport] Modal aberto. Step atual:",s)},[e,s]);const F=()=>{l("upload"),d(null),f(null),h([]),w({}),_({})},z=L=>{h(V=>V.map((re,me)=>me===L?{...re,selected:!re.selected}:re))},q=()=>{const L=m.every(V=>V.selected);h(V=>V.map(re=>({...re,selected:!L})))},$=(L,V,re)=>{w(me=>({...me,[L]:{...me[L],[V]:re}}))},K=(L,V)=>{console.log("[XMLImportModal] handleLinkProduct chamado:",{index:L,productId:V}),console.log("[XMLImportModal] Estado editedProducts completo antes:",b),console.log("[XMLImportModal] Estado editedProducts[index] antes:",b[L]),w(re=>{console.log("[XMLImportModal] Estado prev no setEditedProducts:",re);const me={...re,[L]:{...re[L],linkedProductId:V}};return console.log("[XMLImportModal] Novo estado editedProducts:",me),me})},ce=(L,V)=>!L||!V?0:L*(1+V/100),fe=(L,V,re)=>b[L]?.[V]??re,B=L=>{_(V=>({...V,[L]:!V[L]}))};return o.jsxs(ln,{open:e,onOpenChange:D,children:[o.jsxs(sn,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] flex flex-col",children:[o.jsxs(an,{className:"flex-shrink-0",children:[o.jsxs(nn,{className:"flex items-center gap-2 text-2xl font-bold",children:[o.jsx("span",{children:"Importar XML de Compra"}),u?.nfe&&o.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:M()})]}),o.jsxs(_n,{children:[s==="upload"&&"Selecione o arquivo XML da nota fiscal de entrada",s==="preview"&&"Revise os produtos que sero importados",s==="processing"&&"Processando produtos...",s==="done"&&"Importao finalizada"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-2 py-1",children:[s==="upload"&&o.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:o.jsx("div",{className:"w-full max-w-md",children:o.jsxs("label",{htmlFor:"xml-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[o.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[o.jsx(WT,{className:"w-12 h-12 mb-4 text-text-muted"}),o.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Arquivo XML de NF-e (Nota Fiscal Eletrnica)"})]}),o.jsx("input",{id:"xml-upload",type:"file",accept:".xml",className:"hidden",onChange:C})]})})}),s==="preview"&&o.jsxs("div",{className:"space-y-4",children:[u?.nfe&&o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("h3",{className:"font-semibold mb-2",children:["Informaes da ",M()]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",o.jsx("span",{className:"font-mono",children:u.nfe.numero})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",o.jsx("span",{className:"font-mono",children:u.nfe.serie})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",o.jsx("span",{children:u.nfe.tipo})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",o.jsx("span",{children:u.fornecedor?.razaoSocial})]})]})]}),o.jsxs("div",{className:"flex flex-col gap-2 min-w-[200px]",children:[o.jsxs("div",{className:"bg-brand/10 rounded-lg p-3 border border-brand/20",children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Valor Total NF-e"}),o.jsxs("p",{className:"text-xl font-bold text-brand",children:["R$ ",Number(u.nfe.totalNota||0).toFixed(2)]})]}),u.pagamentos&&u.pagamentos.length>0&&o.jsxs("div",{className:"bg-success/10 rounded-lg p-2.5 border border-success/20",children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento"}),o.jsx("p",{className:"text-sm font-semibold text-success",children:u.pagamentos.map(L=>L.nome).join(", ")})]})]})]}),u.nfe.chaveAcesso&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-border",children:[o.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),o.jsx("p",{className:"font-mono text-xs break-all",children:u.nfe.chaveAcesso})]})]}),o.jsxs("div",{className:"flex items-center justify-between gap-4 px-2",children:[o.jsx(le,{variant:"outline",size:"sm",onClick:q,children:m.every(L=>L.selected)?"Desmarcar Todos":"Selecionar Todos"}),o.jsxs("span",{className:"text-sm text-text-muted",children:[m.filter(L=>L.selected).length," de ",m.length," selecionados"]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold mb-3 text-base",children:"Produtos Encontrados"}),o.jsx("div",{className:"space-y-2",children:m.map((L,V)=>{const re=fe(V,"linkedProductId",null),me=fe(V,"name",L.xml.nome),G=fe(V,"quantity",L.xml.quantidade),Q=fe(V,"margin",L.xml.margem),ae=fe(V,"salePrice",null),J=L.xml.valorUnitario||0;let je=ae;je==null&&!L.isNew&&L.existing&&(je=Number(L.existing.preco_venda||L.existing.salePrice||L.existing.price||0)),je==null&&Q!=null&&(je=ce(J,Q)),je==null&&L.xml.precoVenda&&(je=Number(L.xml.precoVenda));let be=null;if(Q!=null)be=Q;else if(je!=null&&J>0&&je>0){const Z=(je-J)/J*100;be=Math.max(-999,Math.min(9999,Z))}const Ue=j[V];return o.jsxs("div",{className:Jt("rounded-lg border transition-all",L.selected?L.isNew?"bg-success/10 border-success/30":"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[o.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx("input",{type:"checkbox",checked:L.selected,onChange:()=>z(V),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),o.jsx("button",{onClick:()=>B(V),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:Ue?o.jsx(z1,{className:"w-4 h-4 text-text-muted"}):o.jsx(Qx,{className:"w-4 h-4 text-text-muted"})}),o.jsx("div",{children:L.isNew?o.jsx(Ga,{className:"w-5 h-5 text-success"}):o.jsx(Ap,{className:"w-5 h-5 text-info"})})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"font-semibold text-sm truncate",children:me}),o.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[L.xml.codigo&&o.jsxs("span",{className:"flex-shrink-0",children:["#",L.xml.codigo]}),o.jsxs("span",{children:["Qtd: ",G]})]})]}),o.jsx("div",{className:"flex-shrink-0 ml-2",children:L.isNew?o.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-success/20 text-success font-medium",children:"Novo"}):o.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),o.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[o.jsxs("span",{children:["R$ ",Number(J).toFixed(2),je?`  R$ ${je.toFixed(2)}`:""]}),be!=null&&o.jsxs("span",{className:"ml-2 "+(be>0?"text-success":be<0?"text-destructive":"text-text-muted"),children:[be.toFixed(1),"%"]})]})]})]}),Ue&&o.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),o.jsx("input",{type:"text",value:me,onChange:Z=>$(V,"name",Z.target.value),disabled:!L.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{type:"button",onClick:()=>$(V,"qty",Math.max(0,G-1)),disabled:!L.selected||G<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:o.jsx(xv,{className:"w-4 h-4"})}),o.jsx("input",{type:"text",value:G,onChange:Z=>{const Y=Z.target.value.replace(/\D/g,"");$(V,"qty",Y===""?0:Number(Y))},disabled:!L.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),o.jsx("button",{type:"button",onClick:()=>$(V,"qty",G+1),disabled:!L.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:o.jsx(Ga,{className:"w-4 h-4"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",value:(()=>{const Z=fe(V,"margin",null);if(Z!=null)return String(Z);if(!L.isNew&&L.existing&&J>0){const Y=Number(L.existing.preco_venda||L.existing.salePrice||L.existing.price||0);if(Y>0)return((Y-J)/J*100).toFixed(1)}return""})(),onChange:Z=>{const Y=Z.target.value;if(Y===""){$(V,"margin",null);return}const lt=Y.replace(/[^0-9.,\-]/g,"").replace(",",".");if(lt==="."||lt==="-"||lt==="-.")return;const gt=parseFloat(lt);if(!isNaN(gt)&&($(V,"margin",gt),J>0)){const Te=ce(J,gt);$(V,"salePrice",Te)}},disabled:!L.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),o.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),o.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:o.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",J.toFixed(2)]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),o.jsx("input",{type:"text",value:(()=>{const Z=fe(V,"salePrice",je);return Z==null?"":Number(Z).toFixed(2).replace(".",",")})(),onChange:Z=>{const Y=Z.target.value.replace(/\D/g,"");if(Y===""){$(V,"salePrice",null);return}const lt=Number(Y)/100;if($(V,"salePrice",lt),lt>0&&J>0){const gt=(lt-J)/J*100;$(V,"margin",Math.round(gt*100)/100)}},disabled:!L.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:L.isNew?"Vincular a Produto Existente (Opcional)":"Ao para este Produto"}),o.jsx("div",{className:"flex gap-2",children:o.jsxs(En,{value:re==="force-new"?"force-new":re||(L.isNew?"new":L.existing?.id||"new"),onValueChange:Z=>{Z==="new"||Z===L.existing?.id?K(V,null):Z==="search"?k({isOpen:!0,productIndex:V,currentProduct:L}):K(V,Z)},disabled:!L.selected,children:[o.jsx(Sn,{className:"flex-1 hover:bg-white/5 transition-colors text-xs sm:text-sm",children:o.jsx(kn,{placeholder:L.isNew?"Criar novo":"Atualizar existente",children:re&&re!=="force-new"&&re!=="new"?(()=>{const Z=r?.find(Y=>Y.id===re);return Z?`Vinculado: ${Z.name}`:L.isNew?"Criar novo":"Atualizar existente"})():re==="force-new"?"Criar novo (ignorar)":L.isNew?"Criar novo":"Atualizar existente"})}),o.jsxs(Cn,{className:"max-h-[300px] overflow-y-auto text-xs sm:text-sm",children:[L.isNew?o.jsx(Nt,{value:"new",children:"Criar novo produto"}):o.jsxs(Nt,{value:L.existing?.id||"new",children:["Atualizar: ",L.existing?.name," (Estoque: ",L.existing?.stock||0,")"]}),!L.isNew&&o.jsx(Nt,{value:"force-new",children:"Criar novo (ignorar existente)"}),o.jsx(Nt,{value:"search",children:"Buscar produto para vincular"})]})]})})]}),!L.isNew&&o.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:fe(V,"updatePrice",!1),onChange:Z=>$(V,"updatePrice",Z.target.checked),disabled:!L.selected,className:"w-4 h-4 rounded border-border bg-surface text-brand focus:ring-2 focus:ring-brand/50 disabled:opacity-50 disabled:cursor-not-allowed"}),o.jsx("span",{className:"text-text-secondary",children:"Atualizar preo de custo e venda deste produto"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[L.xml.codigo&&o.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Cdigo: ",L.xml.codigo]}),L.xml.ean&&L.xml.ean!=="SEM GTIN"&&o.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["EAN: ",L.xml.ean]}),o.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Unidade: ",L.xml.unidade]})]})]})]},V)})})]}),o.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-success"}),o.jsxs("span",{children:[m.filter(L=>L.isNew&&L.selected).length," novos"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-info"}),o.jsxs("span",{children:[m.filter(L=>!L.isNew&&L.selected).length," existentes"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-warning"}),o.jsxs("span",{children:[m.filter(L=>b[L.index]?.linkedProductId).length," vinculados"]})]})]})]}),s==="processing"&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx(Om,{className:"w-12 h-12 animate-spin text-warning mb-4"}),o.jsx("p",{className:"text-lg font-semibold",children:"Processando produtos..."}),o.jsx("p",{className:"text-sm text-text-muted",children:"Aguarde enquanto importamos os produtos"})]}),s==="done"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:[o.jsx(Pi,{className:"w-16 h-16 text-success mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Importao Concluda!"}),o.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-success",children:x.created}),o.jsx("p",{className:"text-sm text-text-muted",children:"Criados"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-info",children:x.updated}),o.jsx("p",{className:"text-sm text-text-muted",children:"Atualizados"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-danger",children:x.errors}),o.jsx("p",{className:"text-sm text-text-muted",children:"Erros"})]})]})]}),x.details.length>0&&o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold mb-3",children:"Detalhes"}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:x.details.map((L,V)=>o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[L.status==="success"?o.jsx(Pi,{className:"w-4 h-4 text-success flex-shrink-0"}):o.jsx(pc,{className:"w-4 h-4 text-danger flex-shrink-0"}),o.jsx("span",{className:"flex-1 truncate",children:L.produto}),o.jsx("span",{className:Jt("text-xs px-2 py-1 rounded",L.status==="success"?"bg-success/20 text-success":"bg-danger/20 text-danger"),children:L.acao})]},V))})]})]})]}),o.jsxs(Un,{children:[s==="upload"&&o.jsx(le,{variant:"outline",onClick:D,children:"Cancelar"}),s==="preview"&&o.jsxs(o.Fragment,{children:[o.jsx(le,{variant:"outline",onClick:F,children:"Voltar"}),o.jsxs(le,{onClick:T,disabled:m.filter(L=>L.selected).length===0,children:["Confirmar Importao (",m.filter(L=>L.selected).length," de ",m.length," produtos)"]})]}),s==="done"&&o.jsx(le,{onClick:D,children:"Fechar"})]})]}),o.jsx(noe,{isOpen:S.isOpen,onClose:()=>k({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:L=>{console.log("[XMLImportModal] onSelect chamado com produto:",L),console.log("[XMLImportModal] Index do produto:",S.productIndex),K(S.productIndex,L.id),k({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:S.currentProduct}),o.jsx(aoe,{isOpen:E.isOpen,onClose:()=>A({isOpen:!1}),onConfirm:I,products:m.map((L,V)=>({...L,originalIndex:V})),editedProducts:b,allProducts:r,isReprocess:!1})]})}const Gat=[],Kat=[],Yat={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},A4={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},fU="produtosPage:settings";function Xat(e){const t=["Cdigo","Produto","Categoria","Tipo","Unidade","Preo Custo","Preo Venda","% Lucro","Estoque","Estoque Mn.","Validade","Status","Ativo","EAN-13","EAN-13 Caixa","Referncia","Marca","Grupo","NCM","Descrio NCM","CEST","Usar CSOSN","CFOP Interno","CST ICMS Interno","CSOSN Interno","Aliq ICMS Interno (%)","CFOP Externo","CST ICMS Externo","CSOSN Externo","Aliq ICMS Externo (%)","CST PIS Entrada","CST PIS Sada","Aliq PIS (%)","Aliq COFINS (%)","CST IPI","Aliq IPI (%)","FCP (%)","MVA (%)","Base Reduzida (%)"],r=";",n=g=>{const x=Number(g??0);return Number.isFinite(x)?x.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):"0,00"},a=g=>`R$ ${n(g)}`,i=g=>{const x=Number(g??0);return Number.isFinite(x)?x.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},s=g=>{if(!g)return"";try{if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g)){const[y,b,w]=g.split("-");return`${w}/${b}/${y}`}const x=new Date(g);if(!isNaN(x)){const y=String(x.getDate()).padStart(2,"0"),b=String(x.getMonth()+1).padStart(2,"0"),w=x.getFullYear();return`${y}/${b}/${w}`}}catch{}return String(g)},l=g=>g==="active"?"Ativo":g==="low_stock"?"Estoque Baixo":g==="inactive"?"Inativo":"",c=g=>g?"Sim":"No",d=g=>g??"",u=g=>{const x=g==null?"":String(g);return/[";\n]/.test(x)?`"${x.replace(/"/g,'""')}"`:x},f=[];f.push("\uFEFF"+t.join(r));for(const g of e){const x=[d(g.code),d(g.name),d(g.category),d(g.type),d(g.unit),a(g.costPrice),a(g.price??g.salePrice),i(g.marginPercent),Number(g.stock??0),Number(g.minStock??0),s(g.validade),l(g.status),c(g.active!==!1),d(g.barcode),d(g.barcodeBox),d(g.reference),d(g.brand),d(g.group),d(g.ncm),d(g.ncmDescription),d(g.cest),g.useCsosn?"Sim":"",d(g.cfopInterno),d(g.cstIcmsInterno),d(g.csosnInterno),i(g.aliqIcmsInterno),d(g.cfopExterno),d(g.cstIcmsExterno),d(g.csosnExterno),i(g.aliqIcmsExterno),d(g.cstPisEntrada),d(g.cstPisSaida),i(g.aliqPisPercent),i(g.aliqCofinsPercent),d(g.cstIpi),i(g.aliqIpiPercent),i(g.fcpPercent),i(g.mvaPercent),i(g.baseReduzidaPercent)].map(u).join(r);f.push(x)}const m=new Blob([f.join(`
`)],{type:"text/csv;charset=utf-8;"}),h=URL.createObjectURL(m),v=document.createElement("a");v.href=h,v.download="produtos.csv",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(h)}function rc(e,{action:t}={}){const r=String(e?.message||e||"").toLowerCase();if(r.includes("categoria possui produtos ativos vinculados"))return{title:"No  possvel remover",description:"Existem produtos ativos vinculados a esta categoria. Inative ou recategoriz-os antes."};if(r.includes("categoria no encontrada"))return{title:"Categoria no encontrada",description:"No foi possvel localizar a categoria para desativao."};if(r.includes("duplicate key")&&r.includes("ux_produtos_empresa_codigo_produto"))return{title:"Cdigo j cadastrado",description:"J existe um produto com este cdigo na sua empresa. Informe outro cdigo."};if(r.includes("duplicate key")&&r.includes("unique constraint"))return{title:"Registro j existe",description:"J existe um registro com estes dados."};if(r.includes("permission denied")||r.includes("violates row-level security")||r.includes("rls"))return{title:"Sem permisso",description:"Voc no tem permisso para executar esta ao."};const n=r.match(/null value in column "([^"]+)" violates not-null constraint/);return n?{title:"Campo obrigatrio",description:`Preencha o campo "${n[1].replace(/_/g," ")}".`}:r.includes("invalid input syntax")||r.includes("invalid input value")?{title:"Valor invlido",description:"Revise os valores informados (formato invlido)."}:r.includes("violates check constraint")?{title:"Valor invlido",description:"Os dados informados no atendem s regras do sistema."}:r.includes("violates foreign key constraint")?r.includes("update or delete on table")?{title:"No  possvel excluir",description:"Existem registros vinculados que impedem a excluso."}:{title:"Relao invlida",description:"O registro relacionado no foi encontrado ou  invlido."}:r.includes("failed to fetch")||r.includes("networkerror")||r.includes("network error")?{title:"Falha de conexo",description:"Verifique sua internet e tente novamente."}:r.includes("timeout")?{title:"Tempo esgotado",description:"A operao demorou demais. Tente novamente."}:r.includes("rate limit")||r.includes("too many requests")||r.includes("status code 429")?{title:"Muitas solicitaes",description:"Aguarde alguns segundos e tente novamente."}:t==="save"?{title:"Falha ao salvar",description:"No foi possvel salvar o produto. Tente novamente."}:t==="delete"?{title:"Falha ao inativar",description:"No foi possvel inativar o produto."}:t==="fetch"?{title:"Erro ao carregar",description:"No foi possvel atualizar a lista de produtos."}:t==="export"?{title:"Falha ao exportar",description:"No foi possvel gerar o arquivo."}:{title:"Erro",description:e?.message||"Ocorreu um erro."}}const NE=({icon:e,title:t,value:r,subtitle:n,color:a,onClick:i,isActive:s})=>{const l=e;return o.jsxs(fr.div,{variants:A4,className:Jt("bg-surface rounded-2xl border-2 p-3 sm:p-4 flex flex-col justify-between gap-2 cursor-pointer transition-all duration-300",s?`${a}/30 border-${a}`:"border-border hover:border-border-hover"),onClick:i,children:[o.jsxs("div",{className:"flex items-center justify-between gap-2 min-w-0",children:[o.jsx("p",{className:"text-text-secondary text-xs sm:text-sm font-semibold leading-snug whitespace-nowrap overflow-hidden text-ellipsis",children:t}),o.jsx(l,{className:Jt("w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",a)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-text-primary leading-tight whitespace-nowrap overflow-hidden text-ellipsis",children:r}),o.jsx("p",{className:"hidden sm:block text-xs text-text-muted",children:n})]})]})};function Jat({open:e,onOpenChange:t,product:r,onSave:n,categories:a,onCreateCategory:i,suggestedCode:s,onRefreshProducts:l,products:c}){const{toast:d}=ro(),{userProfile:u}=Do(),[f,m]=p.useState("dados"),[h,v]=p.useState(r?.code||""),[g,x]=p.useState(r?.name||""),[y,b]=p.useState(r?.category||""),[w,j]=p.useState(r?.type||"Venda"),[_,S]=p.useState(r?.unit||"UN"),[k,E]=p.useState(r?.active??!0),[A,M]=p.useState(r?.barcode||""),[C,T]=p.useState(r?.barcodeBox||""),[I,D]=p.useState(r?.reference||""),[F,z]=p.useState(r?.brand||""),[q,$]=p.useState(r?.group||""),[K,ce]=p.useState(!!r?.allowSale),[fe,B]=p.useState(!!r?.payCommission),[L,V]=p.useState(!!r?.variablePrice),[re,me]=p.useState(!!r?.composition),[G,Q]=p.useState(!!r?.service),[ae,J]=p.useState(!!r?.hasGrid),[je,be]=p.useState(!!r?.usePriceTable),[Ue,Z]=p.useState(!!r?.fuel),[Y,lt]=p.useState(!!r?.useImei),[gt,Te]=p.useState(!!r?.stockByGrid),[at,yt]=p.useState(!!r?.showInApp),[vt,Sr]=p.useState(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[se,Ze]=p.useState(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[ct,Qt]=p.useState(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),[we,ye]=p.useState(r?.stock?String(r.stock):""),[te,$e]=p.useState(r?.minStock?String(r.minStock):""),[Pe,It]=p.useState(r?.status||"active"),[Dt,kt]=p.useState(r?.validade||null),[cr,Cr]=p.useState(!1),[Ie,ke]=p.useState(!1),[Je,mt]=p.useState(""),[Be,$t]=p.useState(!0),[Ee,Ct]=p.useState(!!(r?.csosnInterno||r?.csosnExterno)),[hr,Mr]=p.useState(r?.cfopInterno||""),[qr,Or]=p.useState(r?.cstIcmsInterno||""),[Mt,Ir]=p.useState(r?.csosnInterno||""),[Ar,Zt]=p.useState(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),[Kr,Tr]=p.useState(r?.cfopExterno||""),[dn,Ae]=p.useState(r?.cstIcmsExterno||""),[pt,Br]=p.useState(r?.csosnExterno||""),[Pr,Ur]=p.useState(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),[Zr,cn]=p.useState(r?.cstPisEntrada||""),[Tn,Qn]=p.useState(r?.cstPisSaida||""),[Sa,ht]=p.useState(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),[Vt,gr]=p.useState(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),[Lt,Pt]=p.useState(r?.cstIpi||""),[Yr,Ft]=p.useState(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),[jr,ot]=p.useState(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),[Kt,vr]=p.useState(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),[X,nt]=p.useState(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),[qe,it]=p.useState(r?.ncm||""),[We,ut]=p.useState(r?.ncmDescription||""),[At,Wt]=p.useState(r?.cest||""),[$r,W]=p.useState(!1),[Ce,De]=p.useState(!1),bt=tt=>{const Hr=String(tt||"").replace(/\D/g,"");return(Hr?Number(Hr)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},He=tt=>{if(!tt)return 0;const Hr=String(tt).replace(/\./g,"").replace(",","."),un=Number(Hr);return Number.isFinite(un)?un:0},dt=tt=>{const Hr=String(tt||"").replace(/[^\d,]/g,"");return Hr?`% ${Hr}`:""},rr=tt=>{if(tt==null||tt==="")return 0;const Hr=String(tt).replace(/\./g,"").replace(",","."),un=Number(Hr);return Number.isFinite(un)?un:0},Gr=tt=>String(tt||"").replace(/\D/g,"").slice(0,13),Rr=tt=>String(tt||"").replace(/\D/g,"").slice(0,4),br=tt=>String(tt||"").replace(/\D/g,"").slice(0,8),wr=tt=>String(tt||"").replace(/\D/g,"").slice(0,7);p.useEffect(()=>{v(r?.code||""),x(r?.name||""),b(r?.category||""),j(r?.type||"Venda"),S(r?.unit||"UN"),E(r?.active??!0),M(r?.barcode||""),T(r?.barcodeBox||""),D(r?.reference||""),z(r?.brand||""),$(r?.group||""),ce(!!r?.allowSale),B(!!r?.payCommission),V(!!r?.variablePrice),me(!!r?.composition),Q(!!r?.service),J(!!r?.hasGrid),be(!!r?.usePriceTable),Z(!!r?.fuel),lt(!!r?.useImei),Te(!!r?.stockByGrid),yt(!!r?.showInApp),Sr(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),Ze(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),Qt(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),ye(r?.stock?String(r.stock):""),$e(r?.minStock?String(r.minStock):""),It(r?.status||"active"),kt(r?.validade||null),Ct(!!(r?.csosnInterno||r?.csosnExterno)),Mr(r?.cfopInterno||""),Or(r?.cstIcmsInterno||""),Ir(r?.csosnInterno||""),Zt(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),Tr(r?.cfopExterno||""),Ae(r?.cstIcmsExterno||""),Br(r?.csosnExterno||""),Ur(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),cn(r?.cstPisEntrada||""),Qn(r?.cstPisSaida||""),ht(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),gr(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),Pt(r?.cstIpi||""),Ft(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),ot(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),vr(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),nt(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),it(r?.ncm||""),ut(r?.ncmDescription||""),Wt(r?.cest||""),$t(!0),!r&&s&&!h&&v(s),W(!1),De(!1)},[r,e]);const or=p.useRef("salePrice");p.useEffect(()=>{if(or.current==="salePrice"){const tt=He(vt),Hr=He(se);if(Hr>0){const un=(Hr-tt)/Hr*100;Qt(un.toFixed(2).replace(".",","))}else Qt("")}},[vt,se]),p.useEffect(()=>{if(or.current==="marginPercent"){const tt=setTimeout(()=>{const Hr=He(vt),un=rr(ct);if(console.log("[Margem] Custo:",Hr,"Margem:",un),Hr>0&&un>0)if(un>=100){const jn=Hr*(1+un/100);console.log("[Margem] Preo calculado (markup):",jn),Ze(jn.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const jn=Hr/(1-un/100);console.log("[Margem] Preo calculado (margem):",jn),Ze(jn.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}},500);return()=>clearTimeout(tt)}},[ct,vt]);const tn=async tt=>{if(tt.preventDefault(),cr)return;const Hr=[];if(g?.trim()||Hr.push("Descrio"),_?.trim()||Hr.push("Unidade"),w||Hr.push("Tipo de Produto"),He(se)<=0&&Hr.push("Preo de Venda"),Hr.length){d({title:"Preencha os campos obrigatrios",description:Hr.join(", "),variant:"destructive"});return}console.log("[ProdutosPage] handleSave - Estado active antes de salvar:",k);let un=Pe;k?Pe==="inactive"&&k&&(un="active"):un="inactive",console.log("[ProdutosPage] handleSave - Status ajustado:",un);const jn={id:r?.id,code:h?.trim()||"",name:g,category:y,type:w,stock:Number(we||0),minStock:Number(te||0),status:un,validade:Dt,unit:_,active:k,barcode:Gr(A),barcodeBox:Gr(C),reference:I?.trim()||null,brand:F?.trim()||null,group:q?.trim()||null,cost:He(vt),price:He(se),buyPrice:null,costsPercent:null,costPrice:He(vt),salePrice:He(se),marginPercent:rr(ct),allowSale:K,payCommission:fe,variablePrice:L,composition:re,service:G,hasGrid:ae,usePriceTable:je,fuel:Ue,useImei:Y,stockByGrid:gt,showInApp:at,cfopInterno:Rr(hr)||null,cstIcmsInterno:Ee?null:qr||null,csosnInterno:Ee&&Mt||null,aliqIcmsInterno:rr(Ar),cfopExterno:Rr(Kr)||null,cstIcmsExterno:Ee?null:dn||null,csosnExterno:Ee&&pt||null,aliqIcmsExterno:rr(Pr),cstPisEntrada:Zr||null,cstPisSaida:Tn||null,aliqPisPercent:rr(Sa),aliqCofinsPercent:rr(Vt),cstIpi:Lt||null,aliqIpiPercent:rr(Yr),fcpPercent:rr(jr),mvaPercent:rr(Kt),baseReduzidaPercent:rr(X),ncm:br(qe)||null,ncmDescription:We||null,cest:wr(At)||null};try{Cr(!0),console.log("[Produtos] Salvando produto",jn);const vn=2e4,Zn=new Promise((Mn,oa)=>setTimeout(()=>oa(new Error("Timeout ao salvar produto (20s)")),vn));await Promise.race([n(jn),Zn]),d({title:"Produto salvo",description:"O produto foi salvo com sucesso.",variant:"success",duration:4e3,className:"bg-amber-500 text-black shadow-xl"}),t(!1)}catch(vn){console.error("[Produtos] Erro ao salvar",vn);const Zn=rc(vn,{action:"save"});d({title:Zn.title,description:Zn.description,variant:"destructive",duration:6e3})}finally{Cr(!1)}};return p.useEffect(()=>{e||Cr(!1)},[e]),o.jsxs(ln,{open:e,onOpenChange:t,children:[o.jsxs(sn,{className:"w-[90vw] sm:max-w-[780px] max-h-[80vh] sm:max-h-[85vh] flex flex-col",onKeyDown:tt=>{tt.key==="F5"&&(tt.preventDefault(),tn(tt)),tt.key==="Escape"&&(tt.preventDefault(),t(!1))},children:[o.jsx(an,{children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx(nn,{className:"text-lg sm:text-xl",children:r?"Detalhes do Produto":"Novo Produto"}),o.jsx(_n,{className:"text-xs sm:text-sm",children:"Preencha as informaes e use as abas para navegar."})]})})}),o.jsx("form",{onSubmit:tn,className:"grid gap-4 py-2 flex-1 overflow-y-auto pr-1 fx-scroll",children:o.jsxs(Vd,{value:f,onValueChange:m,className:"w-full",children:[o.jsx("div",{className:"sm:hidden mb-4",children:o.jsxs(En,{value:f,onValueChange:m,children:[o.jsx(Sn,{className:"w-full",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"dados",children:"Dados"}),o.jsx(Nt,{value:"estoque",children:"Estoque"}),o.jsx(Nt,{value:"preco",children:"Preo e Lucro"}),o.jsx(Nt,{value:"impostos",children:"Impostos"}),o.jsx(Nt,{value:"outras",children:"Outras Info"})]})]})}),o.jsxs(sd,{className:"hidden sm:grid grid-cols-5 gap-1",children:[o.jsx(ba,{value:"dados",children:"Dados"}),o.jsx(ba,{value:"estoque",children:"Estoque"}),o.jsx(ba,{value:"preco",children:"Preo e Lucro"}),o.jsx(ba,{value:"impostos",children:"Impostos"}),o.jsx(ba,{value:"outras",children:"Outras Info"})]}),o.jsx("div",{className:"mt-2 text-[10px] sm:text-[11px] text-text-muted",children:"* Campo obrigatrio"}),o.jsxs(Wi,{value:"dados",className:"space-y-3 mt-2",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Ht,{htmlFor:"code",className:"text-left sm:text-right text-xs sm:text-sm",children:["Cdigo ",o.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(auto)"})]}),o.jsx(ir,{id:"code",value:h,onChange:tt=>v(tt.target.value.replace(/\D/g,"")),className:"col-span-1 sm:col-span-3 text-sm",placeholder:s||"Ex.: 0001",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Ht,{htmlFor:"name",className:"text-left sm:text-right text-xs sm:text-sm",children:["Descrio ",!g?.trim()&&o.jsx("span",{className:"text-danger",children:"*"})]}),o.jsx(ir,{id:"name",value:g,onChange:tt=>x(tt.target.value),className:"col-span-1 sm:col-span-3 text-sm",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{htmlFor:"category",className:"text-left sm:text-right text-xs sm:text-sm",children:"Categoria"}),o.jsxs("div",{className:"col-span-3 flex gap-2 items-center",children:[o.jsxs(En,{value:y,onValueChange:tt=>Be&&b(tt),children:[o.jsx(Sn,{className:"w-full",disabled:!Be,children:o.jsx(kn,{placeholder:"Selecione..."})}),o.jsx(Cn,{children:a.map(tt=>o.jsx(Nt,{value:tt,children:tt},tt))})]}),o.jsxs(le,{type:"button",onClick:()=>ke(tt=>!tt),className:"bg-amber-500 hover:bg-amber-400 text-black inline-flex items-center gap-2 whitespace-nowrap px-3",title:Ie?"Fechar":"Adicionar nova categoria",disabled:!Be,children:[o.jsx("span",{className:"font-bold",children:"+"}),o.jsx("span",{children:"Novo"})]})]})]}),Ie&&o.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[o.jsx("div",{className:"col-span-1"}),o.jsxs("div",{className:"col-span-3 flex gap-2",children:[o.jsx(ir,{value:Je,onChange:tt=>mt(tt.target.value),placeholder:"Nome da nova categoria"}),o.jsx(le,{type:"button",onClick:async()=>{const tt=Je.trim();if(tt)try{if(a.includes(tt)){d({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}await i?.(tt),b(tt),mt(""),ke(!1),d({title:"Categoria adicionada",description:"Ela j est selecionada no formulrio.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(Hr){console.error("[Produto] add category inline:error",Hr);const un=rc(Hr,{action:"save"});d({title:un.title,description:un.description,variant:"destructive"})}},children:"Adicionar"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Ht,{htmlFor:"unit",className:"text-left sm:text-right text-xs sm:text-sm",children:["Unidade ",!_?.trim()&&o.jsx("span",{className:"text-danger",children:"*"})]}),o.jsxs(En,{value:_,onValueChange:tt=>Be&&S(tt),children:[o.jsx(Sn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!Be,children:o.jsx(kn,{placeholder:"Selecione a unidade"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"UN",children:"UN - Unidade"}),o.jsx(Nt,{value:"CX",children:"CX - Caixa"}),o.jsx(Nt,{value:"PC",children:"PC - Pea"}),o.jsx(Nt,{value:"KG",children:"KG - Quilograma"}),o.jsx(Nt,{value:"G",children:"G - Grama"}),o.jsx(Nt,{value:"L",children:"L - Litro"}),o.jsx(Nt,{value:"ML",children:"ML - Mililitro"}),o.jsx(Nt,{value:"M",children:"M - Metro"}),o.jsx(Nt,{value:"M2",children:"M - Metro Quadrado"}),o.jsx(Nt,{value:"M3",children:"M - Metro Cbico"}),o.jsx(Nt,{value:"PAR",children:"PAR - Par"}),o.jsx(Nt,{value:"DZ",children:"DZ - Dzia"}),o.jsx(Nt,{value:"FD",children:"FD - Fardo"}),o.jsx(Nt,{value:"SC",children:"SC - Saco"}),o.jsx(Nt,{value:"PT",children:"PT - Pacote"}),o.jsx(Nt,{value:"SERV",children:"SERV - Servio"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Ht,{className:"text-left sm:text-right text-xs sm:text-sm",children:["Tipo ",!w&&o.jsx("span",{className:"text-danger",children:"*"})]}),o.jsxs(En,{value:w,onValueChange:tt=>Be&&j(tt),children:[o.jsx(Sn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!Be,children:o.jsx(kn,{placeholder:"Selecione o tipo"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"Venda",children:"Produto para Venda"}),o.jsx(Nt,{value:"Uso Interno",children:"Produto de Uso Interno"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-left sm:text-right text-xs sm:text-sm",children:"Ativo"}),o.jsx("div",{className:"col-span-1 sm:col-span-3",children:r?o.jsxs(o.Fragment,{children:[o.jsx(Fo,{checked:k,onCheckedChange:tt=>{console.log("[ProdutosPage] Checkbox active mudou para:",tt),E(!!tt)},disabled:!Be}),o.jsx("span",{className:"ml-2 text-xs sm:text-sm",children:"Ativo"})]}):o.jsxs(En,{value:k?"ativo":"inativo",onValueChange:tt=>{console.log("[ProdutosPage] Select active mudou para:",tt),E(tt==="ativo")},children:[o.jsx(Sn,{className:"w-full sm:w-48 text-sm",disabled:!Be,children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"ativo",children:"Ativo"}),o.jsx(Nt,{value:"inativo",children:"Inativo"})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{htmlFor:"barcode",className:"text-left sm:text-right text-xs sm:text-sm",children:"EAN-13"}),o.jsx(ir,{id:"barcode",value:A,onChange:tt=>M(Gr(tt.target.value)),className:"col-span-1 sm:col-span-3 text-sm",placeholder:"789...",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Ht,{htmlFor:"validade",className:"text-left sm:text-right text-xs sm:text-sm",children:["Validade ",o.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(Opcional)"})]}),o.jsxs(yc,{children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"outline",className:Jt("col-span-1 sm:col-span-3 justify-start text-left font-normal text-xs sm:text-sm",!Dt&&"text-muted-foreground"),disabled:!Be,children:[o.jsx(gj,{className:"mr-2 h-3 w-3 sm:h-4 sm:w-4"}),Dt?Xt(Dt,"dd/MM/yyyy"):o.jsx("span",{children:"Selecione a data"})]})}),o.jsx(Ml,{className:"p-0 w-[280px] sm:w-[300px]",children:o.jsx("div",{className:"w-[280px] sm:w-[300px] min-h-[300px] sm:min-h-[332px]",children:o.jsx(wc,{mode:"single",selected:Dt,onSelect:kt,initialFocus:!0,fixedWeeks:!0})})})]})]})]}),o.jsx(Wi,{value:"estoque",className:"space-y-3 mt-2",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid grid-cols-2 items-center gap-2",children:[o.jsx(Ht,{htmlFor:"stock",className:"text-right",children:"Estoque"}),o.jsx(ir,{id:"stock",value:we,onChange:tt=>ye(tt.target.value.replace(/[^0-9]/g,"")),disabled:!Be,className:"col-span-1",inputMode:"numeric"})]}),o.jsxs("div",{className:"grid grid-cols-2 items-center gap-4",children:[o.jsx(Ht,{htmlFor:"minStock",className:"text-right",children:"Estoque Mn."}),o.jsx(ir,{id:"minStock",value:te,onChange:tt=>$e(tt.target.value.replace(/[^0-9]/g,"")),disabled:!Be,inputMode:"numeric"})]})]})}),o.jsxs(Wi,{value:"preco",className:"space-y-3 mt-2",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{htmlFor:"costPrice",className:"text-xs sm:text-right",children:"Preo de Custo (R$)"}),o.jsx(ir,{id:"costPrice",inputMode:"numeric",placeholder:"Ex.: 10,00",value:`R$ ${vt||"0,00"}`,onChange:tt=>{Sr(bt(tt.target.value))},disabled:!Be,className:"sm:col-span-3 text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Ht,{htmlFor:"salePrice",className:"text-xs sm:text-right",children:["Preo de Venda (R$) ",(!se||He(se)<=0)&&o.jsx("span",{className:"text-danger",children:"*"})]}),o.jsx(ir,{id:"salePrice",inputMode:"numeric",placeholder:"Ex.: 15,00",value:`R$ ${se||"0,00"}`,onChange:tt=>{or.current="salePrice",Ze(bt(tt.target.value))},disabled:!Be,className:"sm:col-span-3 text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{htmlFor:"marginPercent",className:"text-xs sm:text-right",children:"% de Lucro (Margem)"}),o.jsx(ir,{id:"marginPercent",type:"text",placeholder:"Ex.: 40",value:ct?`% ${ct}`:"",onChange:tt=>{or.current="marginPercent";const Hr=tt.target.value.replace(/[^\d,]/g,"");Qt(Hr)},onBlur:()=>{if(or.current==="marginPercent"){const tt=He(vt),Hr=rr(ct);if(tt>0&&Hr>0)if(Hr>=100){const un=tt*(1+Hr/100);Ze(un.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const un=tt/(1-Hr/100);Ze(un.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}}},disabled:!Be,className:"sm:col-span-3 text-xs sm:text-sm"})]})]}),o.jsxs(Wi,{value:"impostos",className:"space-y-4 mt-2",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Fo,{id:"useCsosn",checked:Ee,onCheckedChange:tt=>Ct(!!tt),disabled:!Be}),o.jsx(Ht,{htmlFor:"useCsosn",className:"cursor-pointer text-xs sm:text-sm",children:"Usar CSOSN (Simples Nacional)"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Interna"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CFOP"}),o.jsx(ir,{value:hr,onChange:tt=>Mr(Rr(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"5102",disabled:!Be})]}),!Ee&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CST"}),o.jsx(ir,{value:qr,onChange:tt=>Or(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!Be})]}),Ee&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CSOSN"}),o.jsx(ir,{value:Mt,onChange:tt=>Ir(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),o.jsx(ir,{value:`${Ar||""}`,onChange:tt=>Zt(dt(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!Be})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Externa"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CFOP"}),o.jsx(ir,{value:Kr,onChange:tt=>Tr(Rr(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"6102",disabled:!Be})]}),!Ee&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CST"}),o.jsx(ir,{value:dn,onChange:tt=>Ae(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!Be})]}),Ee&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CSOSN"}),o.jsx(ir,{value:pt,onChange:tt=>Br(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),o.jsx(ir,{value:`${Pr||""}`,onChange:tt=>Ur(dt(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!Be})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"PIS/COFINS"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CST PIS Entrada"}),o.jsx(ir,{value:Zr,onChange:tt=>cn(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 70...",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CST PIS Sada"}),o.jsx(ir,{value:Tn,onChange:tt=>Qn(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"01, 04...",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"Alquota PIS (%)"}),o.jsx(ir,{value:`${Sa||""}`,onChange:tt=>ht(dt(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,65",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"Alquota COFINS (%)"}),o.jsx(ir,{value:`${Vt||""}`,onChange:tt=>gr(dt(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"3,00",disabled:!Be})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"IPI"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CST IPI"}),o.jsx(ir,{value:Lt,onChange:tt=>Pt(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 99...",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"Alquota IPI (%)"}),o.jsx(ir,{value:`${Yr||""}`,onChange:tt=>Ft(dt(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!Be})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"FCP (%)"}),o.jsx(ir,{value:`${jr||""}`,onChange:tt=>ot(dt(tt.target.value)),placeholder:"2,00",disabled:!Be,className:"text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"MVA (%)"}),o.jsx(ir,{value:`${Kt||""}`,onChange:tt=>vr(dt(tt.target.value)),placeholder:"40,00",disabled:!Be,className:"text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"Base Reduzida (%)"}),o.jsx(ir,{value:`${X||""}`,onChange:tt=>nt(dt(tt.target.value)),placeholder:"0,00",disabled:!Be,className:"text-xs sm:text-sm"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"NCM"}),o.jsx(ir,{value:qe,onChange:tt=>it(br(tt.target.value)),placeholder:"00000000",disabled:!Be,className:"text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"CEST"}),o.jsx(ir,{value:At,onChange:tt=>Wt(wr(tt.target.value)),placeholder:"0000000",disabled:!Be,className:"text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4 sm:col-span-1",children:[o.jsx(Ht,{className:"text-xs sm:text-right",children:"Descrio NCM"}),o.jsx(ir,{value:We,onChange:tt=>ut(tt.target.value),placeholder:"Descrio do NCM",disabled:!Be,className:"text-xs sm:text-sm"})]})]})]}),o.jsxs(Wi,{value:"outras",className:"space-y-3 mt-2",children:[r&&o.jsxs("div",{className:"pb-4 mb-4 border-b border-border",children:[o.jsx(le,{type:"button",onClick:()=>W(!0),disabled:!Be,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:"Desmembrar e Unir Produto"}),o.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{htmlFor:"barcode2",className:"text-xs sm:text-right",children:"Cdigo de Barras"}),o.jsx(ir,{id:"barcode2",value:A,onChange:tt=>M(Gr(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{htmlFor:"barcodeBox",className:"text-xs sm:text-right",children:"Cdigo Barras (Caixa)"}),o.jsx(ir,{id:"barcodeBox",value:C,onChange:tt=>T(Gr(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13 da caixa",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{htmlFor:"reference",className:"text-xs sm:text-right",children:"Referncia"}),o.jsx(ir,{id:"reference",value:I,onChange:tt=>D(tt.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: REF-123",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{htmlFor:"brand",className:"text-xs sm:text-right",children:"Marca"}),o.jsx(ir,{id:"brand",value:F,onChange:tt=>z(tt.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Nike",disabled:!Be})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Ht,{htmlFor:"group",className:"text-xs sm:text-right",children:"Grupo"}),o.jsx(ir,{id:"group",value:q,onChange:tt=>$(tt.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Calados",disabled:!Be})]})]}),!1]})}),o.jsxs(Un,{children:[o.jsx(Xm,{asChild:!0,children:o.jsx(le,{type:"button",variant:"secondary",children:"Cancelar"})}),o.jsx(le,{type:"button",onClick:tn,disabled:cr||!Be,title:"F5 para salvar",children:cr?"Salvando...":"Salvar Produto"})]})]}),o.jsx(Qat,{open:$r,onOpenChange:W,product:r,currentPrice:se,allProducts:c,userProfile:u,onApply:async(tt,Hr,un,jn)=>{if(!un)Ze(tt),ye(Hr),W(!1),d({title:"Preo desmembrado!",description:`Preo unitrio: R$ ${He(tt).toFixed(2)} | Estoque: ${Hr}`,variant:"success"});else try{const vn=Number(Hr),Zn=await Xv({productId:un.id,delta:vn,codigoEmpresa:u?.codigo_empresa}),Mn=Number(Zn?.stock??Number(un.stock||0)+vn);if(jn){const oa={...un,stock:Mn,salePrice:He(tt),price:He(tt)};await T5(un.id,oa)}await dR(r.id),d({title:"Produto desmembrado e unido!",description:`${un.name}: novo estoque = ${Mn} | preo unitrio = R$ ${He(tt).toFixed(2)}`,variant:"success"}),W(!1),t(!1);try{typeof l=="function"&&l()}catch{}}catch(vn){console.error("[Desmembrar e Unir] Erro:",vn),d({title:"Erro ao processar",description:vn?.message||"Tente novamente",variant:"destructive"})}}})]})}function Qat({open:e,onOpenChange:t,product:r,currentPrice:n,allProducts:a,userProfile:i,onApply:s}){const[l,c]=p.useState(""),[d,u]=p.useState(""),[f,m]=p.useState(!1),[h,v]=p.useState(""),[g,x]=p.useState(null),[y,b]=p.useState(!1),w=E=>{const A=String(E||"").replace(/\D/g,"");return(A?Number(A)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},j=E=>{if(!E)return 0;const A=String(E).replace(/\./g,"").replace(",","."),M=Number(A);return Number.isFinite(M)?M:0};p.useEffect(()=>{e&&n&&(c(n),u(""),m(!1),v(""),x(null),b(!1))},[e,n]);const _=l&&d&&Number(d)>0?j(l)/Number(d):0,S=(a||[]).filter(E=>{if(!r||E.id===r.id)return!1;if(!h.trim())return!0;const A=h.toLowerCase();return(E.name||"").toLowerCase().includes(A)||(E.code||"").toLowerCase().includes(A)}).slice(0,10),k=g?Number(d||0)+Number(g.stock||0):0;return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(sn,{className:"w-[95vw] sm:max-w-[650px] max-h-[85vh] flex flex-col overflow-y-auto",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Desmembrar e Unir Produto"}),o.jsx(_n,{children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("h3",{className:"text-sm font-semibold",children:"1. Desmembrar Preo"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{children:"Valor Total (R$)"}),o.jsx(ir,{inputMode:"numeric",placeholder:"0,00",value:`R$ ${l||"0,00"}`,onChange:E=>c(w(E.target.value))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{children:"Quantidade de Unidades"}),o.jsx(ir,{type:"text",inputMode:"numeric",placeholder:"0",value:d,onChange:E=>u(E.target.value.replace(/[^0-9]/g,""))})]}),_>0&&o.jsx("div",{className:"bg-muted/50 border border-border p-3 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Preo Unitrio:"}),o.jsxs("span",{className:"text-lg font-bold",children:["R$ ",_.toFixed(2)]})]})})]}),_>0&&o.jsxs("div",{className:"space-y-3 border-t pt-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Fo,{id:"wantToMerge",checked:f,onCheckedChange:E=>{m(!!E),E||(x(null),v(""),b(!1))}}),o.jsx(Ht,{htmlFor:"wantToMerge",className:"cursor-pointer text-sm font-semibold",children:"2. Unir com outro produto (opcional)"})]}),f&&o.jsxs("div",{className:"space-y-3 ml-6",children:[o.jsx("div",{className:"bg-muted/30 border border-border p-3 rounded-lg",children:o.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.jsx("strong",{children:"Produto atual:"})," ",r?.name," (ser inativado aps unio)"]})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{children:"Buscar Produto Destino"}),o.jsx(ir,{placeholder:"Digite o nome ou cdigo...",value:h,onChange:E=>v(E.target.value)})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ht,{className:"text-xs",children:["Produtos Disponveis (",S.length,")"]}),o.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1 border border-border rounded-lg p-2",children:S.length===0?o.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:"Nenhum produto encontrado"}):S.map(E=>o.jsx("div",{onClick:()=>x(E),className:Jt("p-2 rounded-md cursor-pointer border transition-colors",g?.id===E.id?"bg-primary/10 border-primary":"bg-background hover:bg-muted/50 border-transparent"),children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-medium truncate",children:E.name}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:[E.code&&`Cdigo: ${E.code}  `,"Estoque: ",E.stock||0,"  R$ ",Number(E.price||E.salePrice||0).toFixed(2)]})]}),g?.id===E.id&&o.jsx(Pi,{className:"w-4 h-4 text-primary flex-shrink-0"})]})},E.id))})]}),g&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"bg-primary/5 border border-primary/20 p-3 rounded-lg",children:[o.jsx("p",{className:"text-xs font-medium mb-1",children:"Resumo da Unio:"}),o.jsxs("div",{className:"text-xs space-y-0.5 text-muted-foreground",children:[o.jsxs("p",{children:[" Destino: ",o.jsx("strong",{children:g.name})]}),o.jsxs("p",{children:[" Estoque atual: ",g.stock||0]}),o.jsxs("p",{children:[" Estoque a somar: +",d]}),o.jsxs("p",{className:"text-primary font-bold",children:[" Novo estoque: ",k]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Fo,{id:"updatePrice",checked:y,onCheckedChange:E=>b(!!E)}),o.jsxs(Ht,{htmlFor:"updatePrice",className:"cursor-pointer text-xs",children:["Atualizar preo do destino para R$ ",_.toFixed(2)]})]})]})]})]})]}),o.jsxs(Un,{children:[o.jsx(le,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),o.jsx(le,{onClick:()=>{if(_>0){const E=_.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});s(E,d,f?g:null,y)}},disabled:_<=0||f&&!g,children:f&&g?"Desmembrar e Unir":"Aplicar Desmembramento"})]})]})})}function Zat({open:e,onOpenChange:t,categories:r,onAddCategory:n,onRemoveCategory:a}){const{toast:i}=ro(),[s,l]=p.useState(""),[c,d]=p.useState(!1),u=async()=>{const m=s.trim();if(m){if(r.includes(m)){i({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}try{d(!0),await n(m),l(""),i({title:"Categoria adicionada",description:"Ela j aparece na lista.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(h){console.error("[Categorias] add:error",h);const v=rc(h,{action:"save"});i({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}}},f=async m=>{try{d(!0),await a(m),i({title:"Categoria desativada",description:"A categoria foi marcada como inativa.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(h){console.error("[Categorias] remove:error",h);const v=rc(h,{action:"save"});i({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}};return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(sn,{className:"w-[90vw] sm:max-w-[480px]",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Gerenciar Categorias"}),o.jsx(_n,{children:"Adicione ou remova categorias de produtos."})]}),o.jsxs("div",{className:"py-4 space-y-4",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx(ir,{value:s,onChange:m=>l(m.target.value),placeholder:"Nome da nova categoria"}),o.jsx(le,{onClick:u,disabled:c,children:c?"Processando...":"Adicionar"})]}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.map(m=>o.jsxs("div",{className:"flex items-center justify-between bg-surface-2 p-2 rounded-md",children:[o.jsx("span",{className:"font-semibold",children:m}),o.jsx(le,{variant:"ghost",size:"icon",className:"h-8 w-8 text-danger/80 hover:text-danger",onClick:()=>f(m),disabled:c,children:o.jsx(Gm,{size:14})})]},m))})]})]})})}function eot(){const{toast:e}=ro(),{userProfile:t,authReady:r}=Do();ki();const[n,a]=p.useState(Gat),[i,s]=p.useState(Kat),[l,c]=p.useState([]),[d,u]=p.useState("");p.useState("list");const[f,m]=p.useState(!0),[h,v]=p.useState(null),[g,x]=p.useState(!1),[y,b]=p.useState(!1),[w,j]=p.useState("all"),[_,S]=p.useState(""),[k,E]=p.useState({type:"all",category:"all",status:"active",newOnly:!1}),[A,M]=p.useState(!1),[C,T]=p.useState(!1),[I,D]=p.useState(!1),[F,z]=p.useState(null),[q,$]=p.useState({by:"code",dir:"asc"}),K=p.useRef(!0),ce=p.useRef(0),fe=p.useRef(0);p.useRef(!1);const[B,L]=p.useState(!1),[V,re]=p.useState("paged"),me=V==="paged",[G,Q]=p.useState(1),[ae]=p.useState(100),[J,je]=p.useState(0);p.useEffect(()=>(K.current=!0,()=>{K.current=!1}),[]),p.useEffect(()=>{try{const Ae=localStorage.getItem(fU);if(!Ae)return;const pt=JSON.parse(Ae);pt&&typeof pt=="object"&&((pt.listMode==="paged"||pt.listMode==="all")&&re(pt.listMode),typeof pt.showStats=="boolean"&&m(pt.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa||!t?.id&&!t?.user_id)return;const pt=t.id||t.user_id,Br=`produtos:${t.codigo_empresa}`,Pr=await Zae({userId:pt,scope:Br});Pr&&((Pr.listMode==="paged"||Pr.listMode==="all")&&re(Pr.listMode),typeof Pr.showStats=="boolean"&&m(Pr.showStats))})()},[t?.codigo_empresa,t?.id]),p.useEffect(()=>{try{const Ae={listMode:V,showStats:f};localStorage.setItem(fU,JSON.stringify(Ae))}catch{}if(t?.codigo_empresa&&(t?.id||t?.user_id)){const Ae=t.id||t.user_id,pt=`produtos:${t.codigo_empresa}`;eoe({userId:Ae,scope:pt,settings:{listMode:V,showStats:f}})}},[V,f,t?.codigo_empresa,t?.id]);const be=async()=>{const Ae=t?.codigo_empresa||null;if(!r||!Ae)return;const pt=`produtos:list:${Ae}`;M(!0);const Br=setTimeout(()=>{if(K.current)try{const Pr=JSON.parse(localStorage.getItem(pt)||"[]");Array.isArray(Pr)&&Pr.length>0&&(console.warn("[Produtos] slow fallback: using cached snapshot"),a(Pr))}catch{}},2e3);try{const Pr=k.status==="all"||k.status==="inactive";let Ur=[];if(me){console.log("[Produtos] refetchProducts - modo paginado - Filtro status:",k.status,"includeInactive:",Pr,"page:",G,"pageSize:",ae);const Zr=await bat({includeInactive:Pr,search:_,codigoEmpresa:Ae,page:G,pageSize:ae});if(!K.current)return;Ur=Zr?.data||[];const cn=Zr?.count||0;console.log("[Produtos] refetchProducts - Produtos carregados (paginado):",Ur.length,"de",cn),a(Ur),je(cn)}else{if(console.log("[Produtos] refetchProducts - modo TODOS - Filtro status:",k.status,"includeInactive:",Pr),Ur=await Uu({includeInactive:Pr,search:_,codigoEmpresa:Ae}),!K.current)return;console.log("[Produtos] refetchProducts - Produtos carregados (todos):",Ur.length),a(Ur),je(Ur.length)}try{localStorage.setItem(pt,JSON.stringify(Ur))}catch{}fe.current=Ur.length,ce.current=Date.now()}catch(Pr){console.error("[Produtos] refetchProducts:error",Pr);const Ur=rc(Pr,{action:"fetch"});e({title:Ur.title,description:Ur.description,variant:"destructive"})}finally{clearTimeout(Br),M(!1)}};p.useEffect(()=>{const Ae=(()=>{try{const Zr=localStorage.getItem("auth:userProfile");return Zr&&JSON.parse(Zr)?.codigo_empresa||null}catch{return null}})(),pt=t?.codigo_empresa||Ae;if(!pt)return;const Br=`produtos:list:${pt}`,Pr=(()=>{try{return JSON.parse(localStorage.getItem(Br)||"[]")}catch{return[]}})();Array.isArray(Pr)&&Pr.length>0&&(a(Pr),fe.current=Pr.length);const Ur=async(Zr=3)=>{for(let cn=0;cn<Zr;cn++)try{if(K.current){await be();break}}catch(Tn){console.warn(`[ProdutosPage] Tentativa ${cn+1} falhou:`,Tn),cn===Zr-1?console.error("[ProdutosPage] Todas as tentativas falharam"):await new Promise(Qn=>setTimeout(Qn,1e3*(cn+1)))}};try{const Zr=JSON.parse(localStorage.getItem(`produtos:cats:${pt}`)||"[]");Array.isArray(Zr)&&Zr.length>0&&s(Zr)}catch{}if(r&&t?.codigo_empresa){const Zr=setTimeout(()=>Ur(),100);return(async()=>{try{const cn=await uU({codigoEmpresa:t.codigo_empresa});if(!K.current)return;s(cn);try{localStorage.setItem(`produtos:cats:${t.codigo_empresa}`,JSON.stringify(cn))}catch{}}catch(cn){console.error("[Categorias] load on mount:error",cn)}})(),()=>clearTimeout(Zr)}},[r,t?.codigo_empresa]),p.useEffect(()=>{const Ae=()=>{(Date.now()-(ce.current||0)>3e4||fe.current===0)&&be()},pt=()=>{document.visibilityState==="visible"&&(Date.now()-(ce.current||0)>3e4||fe.current===0)&&be()};return window.addEventListener("focus",Ae),document.addEventListener("visibilitychange",pt),()=>{window.removeEventListener("focus",Ae),document.removeEventListener("visibilitychange",pt)}},[r,t?.codigo_empresa]),p.useEffect(()=>{Q(1),r&&be()},[k.status,r]),p.useEffect(()=>{const Ae=setTimeout(()=>{Q(1),r&&be()},300);return()=>clearTimeout(Ae)},[_,r]),p.useEffect(()=>{Q(1),r&&be()},[V,r]);const[Ue,Z]=p.useState("N/A");p.useEffect(()=>{let Ae=!0;return(async()=>{try{const pt=await yat({limit:1,codigoEmpresa:t?.codigo_empresa});if(!Ae)return;if(Array.isArray(pt)&&pt.length>0){const Br=pt[0];Z(`${Br.name} (${Br.total})`)}else Z("")}catch{Ae&&Z("N/A")}})(),()=>{Ae=!1}},[t?.codigo_empresa]);const[Y,lt]=p.useState(!1),[gt,Te]=p.useState(()=>{const Ae=new Date;return Ae.setHours(0,0,0,0),Ae}),[at,yt]=p.useState(!1),[vt,Sr]=p.useState(()=>new Date),[se,Ze]=p.useState(!1),[ct,Qt]=p.useState([]),[we,ye]=p.useState(!1),te=async()=>{try{Ze(!0);const Ae=await xat({from:gt,to:vt,codigoEmpresa:t?.codigo_empresa});Qt(Ae||[])}catch(Ae){e({title:"Falha ao carregar vendas do perodo",description:Ae?.message||"Tente novamente",variant:"destructive"})}finally{Ze(!1)}},$e=p.useMemo(()=>{const Ae=new Date;return{mostSold:Ue,lowStock:n.filter(pt=>pt.status==="low_stock"||pt.stock>0&&pt.stock<=pt.minStock).length,expired:n.filter(pt=>pt.validade&&pt.validade<Ae).length}},[n,Ue]),Pe=p.useMemo(()=>{const Ae=new Date;return n.filter(pt=>{const Br=w==="all"?!0:w==="low_stock"?pt.status==="low_stock"||pt.stock>0&&pt.stock<=pt.minStock:w==="expired"?pt.validade&&pt.validade<Ae:!1,Pr=k.status==="all"?!0:pt.status===k.status,Ur=k.type==="all"||pt.type===k.type,Zr=k.category==="all"||pt.category===k.category,cn=!k.newOnly||pt.dataImportacao&&(()=>Math.floor((new Date-pt.dataImportacao)/864e5)<=7)();return Br&&Pr&&Ur&&Zr&&cn})},[n,w,k]),It=Ae=>Ae?.dataImportacao?Math.floor((new Date-Ae.dataImportacao)/(1e3*60*60*24))<=7:!1,Dt=p.useMemo(()=>{const Ae=[...Pe],pt=q.dir==="asc"?1:-1,Br=(Ur,Zr)=>Number.isFinite(Ur)?Ur:Zr,Pr=Ur=>{if(!Ur)return NaN;if(Ur instanceof Date)return Ur.getTime();const Zr=new Date(Ur);return Number.isNaN(Zr.getTime())?NaN:Zr.getTime()};return Ae.sort((Ur,Zr)=>{if(q.by==="code"){const cn=Br(parseInt((Ur.code||"").trim(),10),1/0),Tn=Br(parseInt((Zr.code||"").trim(),10),1/0);return cn===Tn?0:cn>Tn?pt:-pt}if(q.by==="name"){const cn=(Ur.name||"").toString(),Tn=(Zr.name||"").toString();return cn.localeCompare(Tn,"pt-BR",{sensitivity:"base"})*pt}if(q.by==="validade"){const cn=Br(Pr(Ur.validade),1/0),Tn=Br(Pr(Zr.validade),1/0);return cn===Tn?0:cn>Tn?pt:-pt}return 0}),Ae},[Pe,q]),kt=p.useMemo(()=>{if(!ae)return 1;const Ae=Math.ceil((J||0)/ae);return Ae>0?Ae:1},[J,ae]),cr=Ae=>{$(pt=>pt.by===Ae?{by:Ae,dir:pt.dir==="asc"?"desc":"asc"}:{by:Ae,dir:"asc"})},Cr=Ae=>{j(pt=>pt===Ae?"all":Ae)},Ie=()=>{Te(()=>{const Ae=new Date;return Ae.setHours(0,0,0,0),Ae}),Sr(new Date),lt(!0),setTimeout(te,0)},ke=(Ae,pt)=>{E(Br=>({...Br,[Ae]:pt}))},Je=async()=>{v(null);const Ae=t?.codigo_empresa||null;let pt="";if(Ae)try{pt=await dU({codigoEmpresa:Ae})}catch(Br){console.error("[Produtos] handleAddNew: falha ao obter prximo cdigo",Br)}u(pt||""),x(!0)},mt=Ae=>{v(Ae),x(!0)},Be=()=>{try{Xat(Dt),e({title:"Exportao concluda",description:`${Dt.length} produto(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(Ae){console.error("[Produtos] export:error",Ae);const pt=rc(Ae,{action:"export"});e({title:pt.title,description:pt.description,variant:"destructive"})}},$t=Ae=>{c(pt=>pt.includes(Ae)?pt.filter(Br=>Br!==Ae):[...pt,Ae])},Ee=()=>{const Ae=Dt.map(pt=>pt.id);Ae.length&&c(Ae)},Ct=()=>{c([])},hr=Ae=>{Ae?Ee():Ct()},Mr=p.useMemo(()=>Dt.filter(Ae=>l.includes(Ae.id)),[Dt,l]),qr=p.useMemo(()=>Mr.some(It),[Mr]),Or=async Ae=>{if(l.length)try{await wat({ids:l,status:Ae}),await be(),Ct(),e({title:Ae==="inactive"?"Produtos inativados":"Produtos atualizados",description:`${l.length} produto(s) atualizado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(pt){const Br=rc(pt,{action:"save"});e({title:Br.title,description:Br.description,variant:"destructive"})}},Mt=async()=>{if(!(!l.length||!qr))try{await jat({ids:l}),await be(),Ct(),e({title:"Novos removidos",description:"A etiqueta de novo foi removida dos produtos selecionados.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(Ae){const pt=rc(Ae,{action:"save"});e({title:pt.title,description:pt.description,variant:"destructive"})}},Ir=async()=>{const Ae=t?.codigo_empresa||null;if(!(!r||!Ae))try{const pt=await uU({codigoEmpresa:Ae});if(!K.current)return;s(pt);try{localStorage.setItem(`produtos:cats:${Ae}`,JSON.stringify(pt))}catch{}}catch(pt){console.error("[Categorias] load on mount:error",pt)}},Ar=async Ae=>{s(pt=>{if(pt.includes(Ae))return pt;const Br=[...pt,Ae];return Br.sort((Pr,Ur)=>Pr.localeCompare(Ur,"pt-BR")),Br});try{await Nat(Ae),await Ir()}catch(pt){s(Pr=>Pr.filter(Ur=>Ur!==Ae)),console.error("[Categorias] add:error",pt);const Br=rc(pt,{action:"save"});e({title:Br.title,description:Br.description,variant:"destructive"})}},Zt=async Ae=>{if(n.some(Pr=>Pr.category===Ae&&Pr.status!=="inactive"))throw new Error("Categoria possui produtos ativos vinculados");const Br=i;s(Pr=>Pr.filter(Ur=>Ur!==Ae));try{await _at(Ae),await Ir()}catch(Pr){s(Br),console.error("[Categorias] remove:error",Pr);const Ur=rc(Pr,{action:"save"});e({title:Ur.title,description:Ur.description,variant:"destructive"})}},Kr=async Ae=>{try{if(console.log("[Produtos] handleSaveProduct",Ae),!Ae||typeof Ae!="object"){console.warn("[Produtos] handleSaveProduct chamado sem payload vlido. Ignorando.");return}const pt=t?.codigo_empresa||null;if(!Ae.code&&pt)try{const Pr=await dU({codigoEmpresa:pt});Ae.code=Pr}catch(Pr){console.error("[Produtos] Falha ao obter prximo cdigo automtico",Pr)}const Br=async Pr=>{const Zr=new Promise((cn,Tn)=>setTimeout(()=>Tn(new Error("Timeout update/create (12s)")),12e3));return Promise.race([Pr,Zr])};if(Ae.id){const Pr=await Br(T5(Ae.id,Ae,{codigoEmpresa:pt}));console.log("[Produtos] Produto atualizado - active:",Pr.active,"status:",Pr.status),a(Ur=>Ur.map(Zr=>Zr.id===Pr.id?Pr:Zr)),await be(),console.log("[Produtos] Refetch concludo aps update")}else{Ae.dataImportacao||(Ae.dataImportacao=new Date);const Pr=await Br(nS(Ae,{codigoEmpresa:pt}));console.log("[Produtos] Produto criado",Pr),a(Ur=>[Pr,...Ur]),setTimeout(()=>{be().catch(Ur=>console.error("[Produtos] refetch ps-create falhou",Ur))},0)}}catch(pt){console.error("[Produtos] Erro no handleSaveProduct",pt);const Br=rc(pt,{action:"save"});throw e({title:Br.title,description:Br.description,variant:"destructive"}),pt}},Tr=Ae=>{z(Ae),T(!0)},dn=async()=>{if(F?.id)try{D(!0),await dR(F.id),a(pt=>pt.filter(Br=>Br.id!==F.id)),await be();const Ae=rc(null,{action:"delete"});e({variant:"success",title:Ae.title,description:`Produto "${F.name}" foi inativado com sucesso.`})}catch(Ae){const pt=rc(Ae,{action:"delete"});e({variant:"destructive",...pt})}finally{D(!1),T(!1),z(null)}};return o.jsxs(o.Fragment,{children:[o.jsxs(fr.div,{variants:Yat,initial:"hidden",animate:"visible",className:"flex flex-col",children:[o.jsxs(fr.div,{variants:A4,className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Produtos"}),o.jsx("p",{className:"text-text-secondary hidden md:block",children:"Controle total sobre seu inventrio e estoque."})]}),o.jsx(le,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full hidden md:flex items-center justify-center",onClick:()=>L(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:o.jsx(Hm,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-wrap",children:[o.jsx(le,{variant:"outline",size:"icon",onClick:()=>m(Ae=>!Ae),title:f?"Ocultar resumo":"Mostrar resumo","aria-label":f?"Ocultar resumo":"Mostrar resumo",children:f?o.jsx(Pp,{className:"h-4 w-4"}):o.jsx(Vp,{className:"h-4 w-4"})}),o.jsxs(le,{variant:"outline",onClick:Be,children:[o.jsx(ei,{className:"mr-2 h-4 w-4"})," Exportar"]}),o.jsxs(le,{variant:"secondary",onClick:()=>yt(!0),children:[o.jsx(rs,{className:"mr-2 h-4 w-4"})," Importar XML"]}),o.jsxs(le,{onClick:Je,children:[o.jsx(Ga,{className:"mr-2 h-4 w-4"})," Novo Produto"]})]}),o.jsxs("div",{className:"mt-2 flex md:hidden items-center gap-2",children:[o.jsxs(le,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:Be,title:"Exportar CSV","aria-label":"Exportar CSV",children:[o.jsx(ei,{className:"h-4 w-4"}),o.jsx("span",{children:"CSV"})]}),o.jsxs(le,{variant:"secondary",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>yt(!0),title:"Importar XML","aria-label":"Importar XML",children:[o.jsx(rs,{className:"h-4 w-4"}),o.jsx("span",{children:"XML"})]}),o.jsxs(le,{className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:Je,title:"Novo Produto","aria-label":"Novo Produto",children:[o.jsx(Ga,{className:"h-4 w-4"}),o.jsx("span",{children:"Prod"})]}),o.jsxs(le,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>b(!0),title:"Gerenciar categorias","aria-label":"Gerenciar categorias",children:[o.jsx(i2,{className:"h-4 w-4"}),o.jsx("span",{children:"Cat."})]}),o.jsx(le,{variant:"outline",size:"icon",className:"h-9 w-9 rounded-xl flex items-center justify-center ml-auto",onClick:()=>L(!0),title:"Configuraes da aba","aria-label":"Configuraes da aba",children:o.jsx(Hm,{className:"h-4 w-4"})}),o.jsx(le,{variant:"outline",size:"icon",className:"h-10 w-10 rounded-xl flex items-center justify-center ml-auto",onClick:()=>m(Ae=>!Ae),title:f?"Ocultar resumo":"Mostrar resumo","aria-label":f?"Ocultar resumo":"Mostrar resumo",children:f?o.jsx(Pp,{className:"h-5 w-5"}):o.jsx(Vp,{className:"h-5 w-5"})})]})]}),f&&o.jsxs("div",{className:"grid grid-cols-3 gap-3 md:gap-6 mb-6",children:[o.jsx(NE,{icon:nd,title:o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden md:inline",children:"Mais Vendido (Dia)"}),o.jsx("span",{className:"md:hidden",children:"+ vendidos"})]}),value:$e.mostSold,subtitle:"Produto com mais sadas hoje",color:"text-brand",onClick:Ie}),o.jsx(NE,{icon:Of,title:o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden md:inline",children:"Estoque Baixo"}),o.jsx("span",{className:"md:hidden",children:"Est. baixo"})]}),value:$e.lowStock,subtitle:"Produtos precisando de reposio",color:"text-warning",onClick:()=>Cr("low_stock"),isActive:w==="low_stock"}),o.jsx(NE,{icon:gj,title:o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden md:inline",children:"Vendidos"}),o.jsx("span",{className:"md:hidden",children:"Vencidos"})]}),value:$e.expired,subtitle:"Produtos fora da data de validade",color:"text-danger",onClick:()=>Cr("expired"),isActive:w==="expired"})]}),o.jsx(ln,{open:Y,onOpenChange:lt,children:o.jsxs(sn,{className:"max-w-2xl",onKeyDown:Ae=>Ae.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-xl font-bold",children:"Vendas por Perodo"}),o.jsx(_n,{children:"Selecione o intervalo de datas e visualize os produtos vendidos."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[o.jsxs("div",{children:[o.jsx(Ht,{className:"mb-1 block",children:"Incio"}),o.jsxs(yc,{children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"outline",className:"w-full justify-start",children:[o.jsx(gj,{className:"mr-2 h-4 w-4"}),gt?Xt(gt,"dd/MM/yyyy"):"Incio"]})}),o.jsx(Ml,{className:"p-0 w-[300px]",children:o.jsx("div",{className:"w-[300px] min-h-[332px]",children:o.jsx(wc,{mode:"single",selected:gt,onSelect:Ae=>Ae&&Te(Ae),initialFocus:!0,fixedWeeks:!0})})})]})]}),o.jsxs("div",{children:[o.jsx(Ht,{className:"mb-1 block",children:"Fim"}),o.jsxs(yc,{children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"outline",className:"w-full justify-start",children:[o.jsx(gj,{className:"mr-2 h-4 w-4"}),vt?Xt(vt,"dd/MM/yyyy"):"Fim"]})}),o.jsx(Ml,{className:"p-0 w-[300px]",children:o.jsx("div",{className:"w-[300px] min-h-[332px]",children:o.jsx(wc,{mode:"single",selected:vt,onSelect:Ae=>Ae&&Sr(Ae),initialFocus:!0,fixedWeeks:!0})})})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(le,{type:"button",onClick:te,disabled:se,className:"w-full",children:se?"Carregando...":"Aplicar"}),o.jsx(le,{type:"button",variant:"secondary",onClick:()=>{try{const Ae=ct||[],pt=";",Br=()=>{const cn=["Produto;Quantidade"];for(const Tn of Ae)cn.push(`${(Tn.name||"").replace(/;/g,",")}${pt}${Number(Tn.total||0)}`);return cn.join(`
`)},Pr=new Blob(["\uFEFF"+Br()],{type:"text/csv;charset=utf-8;"}),Ur=URL.createObjectURL(Pr),Zr=document.createElement("a");Zr.href=Ur,Zr.download="vendas-periodo.csv",document.body.appendChild(Zr),Zr.click(),document.body.removeChild(Zr),URL.revokeObjectURL(Ur),e({title:"Exportao concluda",description:`${Ae.length} linha(s)`,variant:"success"})}catch(Ae){e({title:"Falha ao exportar",description:Ae?.message||"Tente novamente",variant:"destructive"})}},children:"Exportar CSV"})]})]}),o.jsx("div",{className:"mt-3 border rounded-md max-h-[50vh] overflow-auto thin-scroll",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-surface-2",children:[o.jsx("th",{className:"text-left p-2",children:"Produto"}),o.jsx("th",{className:"text-right p-2",children:"Quantidade"})]})}),o.jsxs("tbody",{children:[(ct||[]).length===0&&!se&&o.jsx("tr",{children:o.jsx("td",{colSpan:2,className:"p-3 text-text-muted",children:"Nenhum item no perodo."})}),(ct||[]).map(Ae=>o.jsxs("tr",{className:"border-t border-border",children:[o.jsx("td",{className:"p-2",children:Ae.name}),o.jsx("td",{className:"p-2 text-right font-mono",children:Number(Ae.total||0)})]},Ae.id))]})]})}),o.jsx(Un,{children:o.jsx(Xm,{asChild:!0,children:o.jsx(le,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),o.jsx(ln,{open:B,onOpenChange:L,children:o.jsxs(sn,{className:"max-w-2xl",children:[o.jsx(an,{children:o.jsx(nn,{children:"Configuraes da aba"})}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-[11px] font-medium text-text-muted",children:"Modo de listagem"}),o.jsxs(En,{value:V,onValueChange:re,children:[o.jsx(Sn,{className:"w-[200px] h-8 text-xs",children:o.jsx(kn,{placeholder:"Paginado"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"paged",children:"Paginado (100 por pgina)"}),o.jsx(Nt,{value:"all",children:"Todos (sem paginao)"})]})]})]}),o.jsx("div",{className:"flex items-center justify-between pt-1",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Fo,{id:"produtos-show-stats",checked:f,onCheckedChange:m}),o.jsx("label",{htmlFor:"produtos-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de resumo no topo"})]})})]}),o.jsx(Un,{children:o.jsx(Xm,{asChild:!0,children:o.jsx(le,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),o.jsxs(fr.div,{variants:A4,className:"bg-surface rounded-lg border border-border flex flex-col",children:[o.jsxs("div",{className:"p-3 pb-4 sm:p-4 border-b border-border space-y-3 flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar por nome ou cdigo...",className:"pl-9 text-sm",value:_,onChange:Ae=>S(Ae.target.value)})]}),o.jsx(le,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>ye(!0),"aria-label":"Abrir filtros",title:"Filtros",children:o.jsx(Tk,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"hidden md:flex w-full items-center gap-3",children:[o.jsx("div",{className:"flex-1 min-w-[120px]",children:o.jsxs(En,{value:k.type,onValueChange:Ae=>ke("type",Ae),children:[o.jsx(Sn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Tipos"}),o.jsx(Nt,{value:"Venda",children:"Venda"}),o.jsx(Nt,{value:"Uso Interno",children:"Uso Interno"})]})]})}),o.jsx("div",{className:"flex-1 min-w-[140px]",children:o.jsxs(En,{value:k.category,onValueChange:Ae=>ke("category",Ae),children:[o.jsx(Sn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Categorias"}),i.map(Ae=>o.jsx(Nt,{value:Ae,children:Ae},Ae))]})]})}),o.jsx("div",{className:"flex-1 max-w-[180px]",children:o.jsxs(En,{value:k.status,onValueChange:Ae=>ke("status",Ae),children:[o.jsx(Sn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Status"}),o.jsx(Nt,{value:"active",children:"Ativo"}),o.jsx(Nt,{value:"low_stock",children:"Estoque Baixo"}),o.jsx(Nt,{value:"inactive",children:"Inativo"})]})]})}),o.jsxs("div",{className:"flex-1 flex justify-end gap-2 min-w-[160px]",children:[o.jsxs(le,{variant:"outline",onClick:()=>ke("newOnly",!k.newOnly),className:Jt("text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",k.newOnly&&"bg-amber-500 text-black border-amber-500 hover:bg-amber-400"),size:"sm",children:[o.jsx("span",{className:"mr-1",children:""}),o.jsx("span",{children:"Novos"})]}),o.jsxs(le,{variant:"outline",onClick:()=>b(!0),className:"text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",size:"sm",children:[o.jsx(i2,{className:"h-3 w-3 sm:h-4 sm:w-4"}),o.jsx("span",{children:"Categorias"})]}),o.jsx(le,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>L(Ae=>!Ae),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:o.jsx(Hm,{className:"h-4 w-4"})})]})]})]}),l.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"px-3 sm:px-4 py-2.5 border-b border-border flex md:hidden items-center gap-2 text-xs",children:[o.jsxs("span",{className:"font-medium mr-2",children:[l.length," sel."]}),o.jsxs("button",{type:"button",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-border bg-surface-2",onClick:()=>{const Ae=Dt.length>0&&Dt.every(pt=>l.includes(pt.id));hr(!Ae)},children:[o.jsx(Fo,{checked:Dt.length>0&&Dt.every(Ae=>l.includes(Ae.id)),className:"h-4 w-4"}),o.jsx("span",{children:"Todos"})]}),o.jsxs("div",{className:"flex items-center gap-1.5 ml-auto",children:[o.jsx(le,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>Or("active"),children:o.jsx(Pi,{className:"h-4 w-4"})}),o.jsx(le,{variant:"outline",size:"icon",className:"h-8 w-8 text-danger border-danger/60 hover:bg-danger/10",onClick:()=>Or("inactive"),children:o.jsx(Gm,{className:"h-4 w-4"})}),qr&&o.jsx(le,{variant:"outline",size:"icon",className:"h-8 w-8 border-amber-500/70 text-amber-700 hover:bg-amber-500/10",onClick:Mt,children:o.jsx(i2,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"hidden md:flex px-4 py-2 border-b border-border items-center gap-3 text-xs",children:[o.jsx("span",{className:"font-medium text-text-secondary whitespace-nowrap",children:l.length===0?"Nenhum item selecionado":`${l.length} produto${l.length>1?"s":""} selecionado${l.length>1?"s":""}`}),o.jsxs("div",{className:"flex flex-1 flex-wrap items-center justify-end gap-2",children:[o.jsxs(le,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:Ee,children:[o.jsx(Pi,{className:"h-3 w-3"}),o.jsx("span",{children:"Marcar filtrados"})]}),o.jsxs(le,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:Ct,children:[o.jsx(Tk,{className:"h-3 w-3"}),o.jsx("span",{children:"Limpar seleo"})]}),o.jsxs(le,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-emerald-500/70 text-emerald-300 bg-emerald-500/10 hover:bg-emerald-500/20 flex items-center gap-1",onClick:()=>Or("active"),children:[o.jsx(Pi,{className:"h-3 w-3"}),o.jsx("span",{children:"Ativar itens"})]}),o.jsxs(le,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full text-danger border-danger/60 hover:bg-danger/10 flex items-center gap-1",onClick:()=>Or("inactive"),children:[o.jsx(Pp,{className:"h-3 w-3"}),o.jsx("span",{children:"Desativar itens"})]}),qr&&o.jsxs(le,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-amber-500/70 text-amber-500 hover:bg-amber-500/10 flex items-center gap-1",onClick:Mt,children:[o.jsx(i2,{className:"h-3 w-3"}),o.jsx("span",{children:'Limpar tag "Novo"'})]})]})]})]}),o.jsx("div",{children:Dt.length===0?o.jsxs("div",{className:"p-10 text-center text-text-secondary",children:[o.jsx("p",{className:"text-lg mb-3",children:"Nenhum produto cadastrado."}),o.jsxs(le,{onClick:Je,children:[o.jsx(Ga,{className:"mr-2 h-4 w-4"}),"Cadastrar primeiro produto"]})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"md:hidden p-3 space-y-3",children:Dt.map(Ae=>{const pt=l.includes(Ae.id);return o.jsxs("div",{className:Jt("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer",pt?"border-brand/70 bg-brand/5":"border-border"),onClick:()=>mt(Ae),children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsx("button",{type:"button",className:"pt-1 pr-2 -ml-1 flex items-center justify-center w-9 h-9",onClick:Br=>{Br.stopPropagation(),$t(Ae.id)},children:o.jsx(Fo,{checked:pt,className:"h-5 w-5 border-2"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",title:Ae.name,children:Ae.name}),Ae.dataImportacao&&(()=>Math.floor((new Date-Ae.dataImportacao)/864e5)<=7?o.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Novo"})]}):null)()]}),o.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:Ae.category||"Sem categoria"})]}),o.jsx("span",{className:Jt("inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0",Ae.status==="active"&&"bg-emerald-50/5 border-emerald-500/30 text-emerald-400",Ae.status==="low_stock"&&"bg-amber-50/5 border-amber-500/30 text-amber-400",Ae.status==="inactive"&&"bg-surface-2 border-border text-text-muted"),children:Ae.status==="active"?"Ativo":Ae.status==="low_stock"?"Estoque Baixo":"Inativo"})]}),o.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-text-muted",children:[Ae.code&&o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("span",{children:"Cd."}),o.jsx("span",{className:"font-mono text-text-primary text-xs",children:Ae.code})]}),o.jsx("span",{className:"mx-1 text-text-muted",children:""}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("span",{children:"R$"}),o.jsx("span",{className:"font-semibold text-text-primary",children:Ae.price.toFixed(2)})]}),o.jsx("span",{className:"mx-1 text-text-muted",children:""}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("span",{children:"Est."}),o.jsx("span",{className:"font-medium text-text-primary",children:Ae.stock})]}),Ae.validade&&o.jsx("span",{className:"mx-1 text-text-muted",children:""}),Ae.validade&&o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("span",{children:"Val."}),o.jsx("span",{className:"text-text-primary",children:(()=>{const Br=Ae.validade instanceof Date?Ae.validade:aF(String(Ae.validade));return isNaN(Br)?"-":Xt(Br,"dd/MM/yy")})()})]}),o.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[o.jsx(le,{variant:"outline",size:"icon",onClick:Br=>{Br.stopPropagation(),mt(Ae)},className:"h-7 w-7",children:o.jsx(ll,{className:"h-3.5 w-3.5"})}),o.jsx(le,{variant:"outline",size:"icon",onClick:Br=>{Br.stopPropagation(),Tr(Ae)},className:"h-7 w-7 text-danger hover:text-danger",children:o.jsx(Gm,{className:"h-3.5 w-3.5"})})]})]})]},Ae.id)})}),o.jsx("div",{className:"hidden md:block rounded-lg border border-border overflow-hidden",children:o.jsxs("table",{className:"w-full text-sm bg-surface table-fixed",children:[o.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:o.jsxs("tr",{className:"border-b border-border",children:[o.jsx("th",{className:"p-3 w-10 text-center",children:o.jsx(Fo,{checked:Dt.length>0&&Dt.every(Ae=>l.includes(Ae.id)),onCheckedChange:Ae=>hr(!!Ae)})}),o.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[110px]",onClick:()=>cr("code"),children:["Cdigo ",q.by==="code"?q.dir==="asc"?"":"":""]}),o.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[40%]",onClick:()=>cr("name"),children:["Produto ",q.by==="name"?q.dir==="asc"?"":"":""]}),o.jsx("th",{className:"p-3 text-left font-semibold whitespace-nowrap w-[18%]",children:"Categoria"}),o.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[120px]",children:"Preo"}),o.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[110px]",children:"Estoque"}),o.jsxs("th",{className:"p-3 text-center font-semibold select-none cursor-pointer whitespace-nowrap w-[120px]",onClick:()=>cr("validade"),children:["Validade ",q.by==="validade"?q.dir==="asc"?"":"":""]}),o.jsx("th",{className:"p-3 text-center font-semibold whitespace-nowrap w-[140px]",children:"Status"}),o.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[90px]",children:"Aes"})]})}),o.jsx("tbody",{className:"text-text-primary divide-y divide-border",children:Dt.map(Ae=>o.jsxs("tr",{className:"hover:bg-surface-2 transition-colors group cursor-pointer align-middle",children:[o.jsx("td",{className:"p-3 text-center align-middle",children:o.jsx(Fo,{checked:l.includes(Ae.id),onCheckedChange:()=>$t(Ae.id)})}),o.jsx("td",{className:"p-3 font-mono text-sm text-text-secondary align-middle whitespace-nowrap",onClick:()=>mt(Ae),children:Ae.code||"-"}),o.jsx("td",{className:"p-3 font-semibold align-middle text-text-primary whitespace-nowrap overflow-hidden text-ellipsis",onClick:()=>mt(Ae),title:Ae.name,children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"truncate",children:Ae.name}),Ae.dataImportacao&&(()=>Math.floor((new Date-Ae.dataImportacao)/864e5)<=7?o.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Novo"})]}):null)()]})}),o.jsx("td",{className:"p-3 text-text-secondary align-middle whitespace-nowrap",onClick:()=>mt(Ae),children:Ae.category}),o.jsxs("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>mt(Ae),children:["R$ ",Ae.price.toFixed(2)]}),o.jsx("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>mt(Ae),children:Ae.stock}),o.jsx("td",{className:"p-3 text-center font-mono tabular-nums whitespace-nowrap",onClick:()=>mt(Ae),children:(()=>{if(!Ae.validade)return"-";const pt=Ae.validade instanceof Date?Ae.validade:aF(String(Ae.validade));return isNaN(pt)?"-":Xt(pt,"dd/MM/yy")})()}),o.jsx("td",{className:"p-3 text-center whitespace-nowrap",onClick:()=>mt(Ae),children:o.jsx("span",{className:Jt("px-2 py-1 text-xs font-bold rounded-full",Ae.status==="active"&&"bg-success/10 text-success",Ae.status==="low_stock"&&"bg-warning/10 text-warning",Ae.status==="inactive"&&"bg-danger/10 text-danger"),children:Ae.status==="active"?"Ativo":Ae.status==="low_stock"?"Estoque Baixo":"Inativo"})}),o.jsx("td",{className:"p-3 whitespace-nowrap",children:o.jsx("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx(le,{variant:"ghost",size:"icon",className:"h-8 w-8 text-text-muted hover:text-danger",onClick:pt=>{pt.stopPropagation(),Tr(Ae)},children:o.jsx(Gm,{size:14})})})})]},Ae.id))})]})})]})}),me&&o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted px-3 sm:px-4 pb-3",children:[o.jsxs("span",{children:["Pgina ",G," de ",kt," (",J," produto(s))"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(le,{type:"button",variant:"outline",size:"sm",onClick:()=>Q(Ae=>Math.max(1,Ae-1)),disabled:G<=1,children:"Anterior"}),o.jsx(le,{type:"button",variant:"outline",size:"sm",onClick:()=>Q(Ae=>Math.min(kt,Ae+1)),disabled:G>=kt,children:"Prxima"})]})]})]})]}),o.jsx(Jat,{open:g,onOpenChange:x,product:h,categories:i,onSave:Kr,onCreateCategory:Ar,suggestedCode:h?void 0:d,onRefreshProducts:be,products:n}),o.jsx(ln,{open:C,onOpenChange:T,children:o.jsxs(sn,{className:"sm:max-w-[480px]",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Excluir produto"}),o.jsxs(_n,{children:["Tem certeza que deseja excluir o produto",F?` "${F.name}"`:"","? Esta ao no pode ser desfeita."]})]}),o.jsxs(Un,{children:[o.jsx(Xm,{asChild:!0,children:o.jsx(le,{type:"button",variant:"secondary",disabled:I,children:"Cancelar"})}),o.jsx(le,{type:"button",variant:"destructive",onClick:dn,disabled:I,children:I?"Excluindo...":"Excluir"})]})]})}),o.jsx(Hat,{open:at,onOpenChange:yt,products:n,codigoEmpresa:t?.codigo_empresa,onSuccess:()=>{be(),yt(!1)}}),o.jsx(ln,{open:we,onOpenChange:ye,children:o.jsxs(sn,{className:"w-[90vw] sm:max-w-[420px]",children:[o.jsx(an,{children:o.jsx(nn,{className:"text-base",children:"Filtros de Produtos"})}),o.jsxs("div",{className:"space-y-3 py-2 text-xs",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx(Ht,{className:"text-xs",children:"Tipo"}),o.jsxs(En,{value:k.type,onValueChange:Ae=>ke("type",Ae),children:[o.jsx(Sn,{className:"text-xs",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Todos"}),o.jsx(Nt,{value:"Venda",children:"Venda"}),o.jsx(Nt,{value:"Uso Interno",children:"Uso Interno"})]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(Ht,{className:"text-xs",children:"Categoria"}),o.jsxs(En,{value:k.category,onValueChange:Ae=>ke("category",Ae),children:[o.jsx(Sn,{className:"text-xs",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Todas"}),i.map(Ae=>o.jsx(Nt,{value:Ae,children:Ae},Ae))]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(Ht,{className:"text-xs",children:"Status"}),o.jsxs(En,{value:k.status,onValueChange:Ae=>ke("status",Ae),children:[o.jsx(Sn,{className:"text-xs",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Todos"}),o.jsx(Nt,{value:"active",children:"Ativo"}),o.jsx(Nt,{value:"low_stock",children:"Estoque Baixo"}),o.jsx(Nt,{value:"inactive",children:"Inativo"})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[o.jsx(Fo,{id:"mobileNewOnly",checked:!!k.newOnly,onCheckedChange:Ae=>ke("newOnly",!!Ae)}),o.jsx(Ht,{htmlFor:"mobileNewOnly",className:"text-xs flex items-center gap-1",children:o.jsx("span",{children:"Somente Novos"})})]})]}),o.jsxs(Un,{className:"flex justify-between mt-2",children:[o.jsx(le,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:()=>{E({type:"all",category:"all",status:"active",newOnly:!1}),ye(!1)},children:"Limpar"}),o.jsx(le,{type:"button",size:"sm",className:"text-xs",onClick:()=>ye(!1),children:"Aplicar"})]})]})}),o.jsx(Zat,{open:y,onOpenChange:b,categories:i,onAddCategory:Ar,onRemoveCategory:Zt})]})}function tot({purchase:e,items:t,onClose:r,onEdit:n,onReprocess:a,onDownloadXML:i,onInactivate:s}){if(!e)return null;const l=t.reduce((d,u)=>d+Number(u.valor_total||0),0),c=d=>d?.data_importacao?Aye(new Date,new Date(d.data_importacao))<=7:!1;return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-3 py-4 bg-black/60 backdrop-blur-sm",children:o.jsxs("div",{className:"relative w-[95vw] sm:w-full sm:max-w-4xl max-h-[85vh] bg-surface rounded-xl shadow-2xl border border-border overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"relative bg-surface border-b border-border p-4",children:[o.jsx("button",{onClick:r,className:"absolute top-3 right-3 p-1.5 hover:bg-surface-2 rounded-lg transition-colors",children:o.jsx(Dl,{className:"h-4 w-4 text-text-muted"})}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4 pr-0 sm:pr-10",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"p-2 bg-brand/10 rounded-lg",children:o.jsx(rs,{className:"h-5 w-5 text-brand"})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-xl font-bold text-text-primary mb-0.5",children:["NF-e ",e.numero_nfe,e.serie_nfe&&` / Srie ${e.serie_nfe}`]}),o.jsx("p",{className:"text-text-muted text-xs",children:e.natureza_operacao||"Nota Fiscal Eletrnica"})]})]}),o.jsxs("div",{className:"mt-3 sm:mt-0 sm:text-right",children:[o.jsx("p",{className:"text-text-muted text-xs mb-0.5",children:"Valor Total"}),o.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-success whitespace-nowrap",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-6",children:o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"bg-surface-2 rounded-lg border border-border p-4",children:o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"flex-shrink-0 mt-0.5",children:o.jsx(_u,{className:"h-4 w-4 text-brand"})}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-xs font-medium text-text-muted mb-0.5",children:"Fornecedor"}),o.jsx("p",{className:"font-semibold text-base text-text-primary leading-snug break-words",children:e.fornecedor?.nome||"No identificado"}),e.fornecedor?.cnpj&&o.jsxs("p",{className:"text-xs text-text-muted mt-0.5",children:["CNPJ: ",e.fornecedor.cnpj]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(gi,{className:"h-3.5 w-3.5 text-info"}),o.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Emisso"})]}),o.jsx("p",{className:"font-semibold text-text-primary",children:e.data_emissao?Xt(new Date(e.data_emissao),"dd/MM/yyyy",{locale:aa}):"No informada"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(xue,{className:"h-3.5 w-3.5 text-warning"}),o.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Operao"})]}),o.jsx("p",{className:"font-semibold text-text-primary",children:e.tipo_operacao||"Entrada"})]}),e.forma_pagamento&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(km,{className:"h-3.5 w-3.5 text-success"}),o.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Pagamento"})]}),o.jsx("p",{className:"font-semibold text-text-primary",children:e.forma_pagamento})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor dos Produtos"}),o.jsxs("p",{className:"font-semibold text-text-primary",children:["R$ ",l.toFixed(2)]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor Total NF-e"}),o.jsxs("p",{className:"font-semibold text-brand",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-base font-semibold text-text-primary flex items-center gap-2 mb-3",children:[o.jsx(gd,{className:"h-4 w-4 text-brand"}),"Produtos da NF-e",o.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-brand/10 text-brand font-medium ml-2",children:t.length})]}),o.jsx("div",{className:"space-y-2",children:t.map((d,u)=>o.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border hover:border-brand/30 transition-colors",children:o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsx("div",{className:"flex-1 min-w-0",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center mt-0.5",children:u+1}),o.jsxs("div",{className:"flex-1",children:[d.produto?.nome?o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:"font-medium text-base text-text-primary mb-0.5",children:["Produto atual: ",d.produto.nome]}),d.nome_produto_xml&&o.jsxs("p",{className:"text-xs text-text-muted mb-1",children:["XML original: ",o.jsx("span",{className:"font-medium text-text-primary",children:d.nome_produto_xml})]})]}):o.jsx("p",{className:"font-medium text-sm text-text-primary mb-1",children:d.nome_produto_xml}),o.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-text-muted mb-1.5",children:[(d.produto?.codigo_produto||d.codigo_produto_xml)&&o.jsxs("span",{children:[o.jsx("span",{className:"font-medium",children:"Cd:"})," ",d.produto?.codigo_produto||d.codigo_produto_xml]}),d.ean_xml&&d.ean_xml!=="SEM GTIN"&&o.jsxs("span",{children:[o.jsx("span",{className:"font-medium",children:"EAN:"})," ",d.ean_xml]}),d.ncm_xml&&o.jsxs("span",{children:[o.jsx("span",{className:"font-medium",children:"NCM:"})," ",d.ncm_xml]}),d.unidade_xml&&o.jsxs("span",{children:[o.jsx("span",{className:"font-medium",children:"Un:"})," ",d.unidade_xml]}),d.produto&&o.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-success/20 text-success font-medium",children:" Cadastrado"}),d.produto&&c(d.produto)&&o.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand font-medium",children:[o.jsx(Mk,{className:"h-3 w-3"}),"Novo"]}),d.vinculado_manualmente&&o.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-warning/20 text-warning font-medium",children:" Vinculado"}),!d.produto&&o.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-text-muted/20 text-text-muted font-medium",children:" No importado"})]})]})]})}),o.jsxs("div",{className:"flex-shrink-0 text-right",children:[o.jsxs("div",{className:"mb-1.5",children:[o.jsx("span",{className:"text-xs text-text-muted mr-1",children:"Qtd:"}),o.jsx("span",{className:"font-bold text-base text-warning",children:d.quantidade})]}),o.jsxs("div",{className:"space-y-0.5",children:[o.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: ",o.jsxs("span",{className:"font-semibold text-success",children:["R$ ",Number(d.valor_unitario||0).toFixed(2)]})]}),o.jsxs("p",{className:"text-sm font-bold text-text-primary",children:["Total: R$ ",Number(d.valor_total||0).toFixed(2)]})]})]})]})},u))})]}),e.chave_nfe&&o.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[o.jsxs("p",{className:"text-xs font-medium text-text-muted mb-1.5 flex items-center gap-1.5",children:[o.jsx(rs,{className:"h-3 w-3"}),"Chave de Acesso NF-e:"]}),o.jsx("p",{className:"font-mono text-xs text-text-primary break-all leading-relaxed select-all",children:e.chave_nfe})]})]})}),o.jsxs("div",{className:"p-3 sm:p-4 bg-surface-2 border-t border-border flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[o.jsx("div",{className:"flex flex-wrap gap-2",children:e.ativo&&o.jsxs(o.Fragment,{children:[o.jsxs(le,{onClick:()=>n?.(e),size:"sm",variant:"outline",className:"gap-2",children:[o.jsx(ll,{className:"h-4 w-4"}),"Editar"]}),o.jsxs(le,{onClick:()=>a?.(e),size:"sm",variant:"outline",className:"gap-2",disabled:!e.xml_completo,children:[o.jsx(Ap,{className:"h-4 w-4"}),"Reprocessar"]}),e.xml_completo&&o.jsx(o.Fragment,{children:o.jsxs(le,{onClick:()=>i?.(e),size:"sm",variant:"outline",className:"gap-2",children:[o.jsx(ei,{className:"h-4 w-4"}),"XML"]})}),o.jsxs(le,{onClick:()=>s?.(e),size:"sm",variant:"outline",className:"gap-2 text-destructive hover:text-destructive",children:[o.jsx(Gm,{className:"h-4 w-4"}),"Inativar"]})]})}),o.jsx(le,{onClick:r,variant:"outline",className:"w-full sm:w-auto",children:"Fechar"})]})]})})}function rot({open:e,onOpenChange:t,purchase:r,products:n,codigoEmpresa:a,onSuccess:i,autoFile:s}){const{toast:l}=ro(),[c,d]=p.useState("upload"),[u,f]=p.useState(null),[m,h]=p.useState(null),[v,g]=p.useState([]),[x,y]=p.useState(!1),[b,w]=p.useState({created:0,updated:0,errors:0,details:[]}),[j,_]=p.useState({}),[S,k]=p.useState({}),[E,A]=p.useState({}),[M,C]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[T,I]=p.useState({isOpen:!1}),D=()=>{const G=m?.nfe?.modelo||r?.modelo_nfe;return G==="55"?"NF-e":G==="65"?"NFC-e":"NF-e / NFC-e"},F=(G,Q,ae)=>j[G]?.[Q]??ae,z=(G,Q)=>!G||!Q?0:G*(1+Q/100),q=G=>{k(Q=>({...Q,[G]:!Q[G]}))},$=(G,Q,ae)=>{console.log("[XMLReprocessModal] handleEditProduct chamado:",{index:G,field:Q,value:ae}),_(J=>{const je={...J,[G]:{...J[G],[Q]:ae}};return console.log("[XMLReprocessModal] Novo estado editedProducts:",je),je})},K=G=>{g(Q=>Q.map((ae,J)=>{if(J===G){const je=!ae.selected;return A(be=>({...be,[G]:je})),{...ae,selected:je}}return ae}))},ce=(G,Q)=>{console.log("[XMLReprocessModal] handleLinkProduct chamado:",{index:G,productId:Q}),console.log("[XMLReprocessModal] Estado editedProducts antes:",j[G]),$(G,"linkedProductId",Q),console.log("[XMLReprocessModal] Estado editedProducts depois:",{...j,[G]:{...j[G],linkedProductId:Q}})};p.useEffect(()=>{s&&e&&fe(s)},[s,e]);const fe=async G=>{f(G);try{console.log("[XMLReprocess] Processando arquivo automtico..."),console.log("[XMLReprocess] Purchase data:",r);const ae=await G.text();console.log("[XMLReprocess] XML content length:",ae.length);const J=aS(ae);if(!J.success){l({title:"Erro ao ler XML",description:J.error||"XML invlido",variant:"destructive"});return}console.log("[XMLReprocess] Dados parseados:",J.data),console.log("[XMLReprocess] Produtos encontrados:",J.data?.produtos?.length||0),console.log("[XMLReprocess] Comparando chaves:",{xmlChave:J.data?.nfe?.chaveAcesso,purchaseChave:r?.chave_nfe,match:J.data?.nfe?.chaveAcesso===r?.chave_nfe}),h(J.data);const je=await roe(r.id);console.log("[XMLReprocess] Itens da compra original:",je.length);const be=J.data?.produtos?.map((Z,Y)=>{const lt=oS(Z,n),gt=!lt,Te=je.find(vt=>Z.codigo&&vt.codigo_produto_xml?vt.codigo_produto_xml===Z.codigo:vt.nome_produto_xml===Z.nome),at=!!Te,yt=Te?.selecionado_na_importacao||!1;return console.log(`[XMLReprocess] Produto ${Y+1}: ${Z.nome}`),console.log(`  - Cdigo XML: ${Z.codigo}`),console.log("  - originalItem encontrado:",Te?`${Te.nome_produto_xml} (cdigo: ${Te.codigo_produto_xml})`:"NO ENCONTRADO"),console.log(`  - wasImported: ${at}`),console.log(`  - wasSelectedInOriginalImport: ${yt}`),{index:Y,xml:Z,existing:lt,isNew:gt,wasImported:at,selected:E[Y]!==void 0?E[Y]:at}})||[];console.log("[XMLReprocess] Preview preparado:",be.length,"produtos"),console.log("[XMLReprocess] Produtos marcados:",be.filter(Z=>Z.selected).length),console.log("[XMLReprocess] Produtos importados originalmente:",be.filter(Z=>Z.wasImported).length),console.log("[XMLReprocess] Items da compra original detalhado:"),je.forEach((Z,Y)=>{console.log(`  ${Y+1}. ${Z.nome_produto_xml} (cdigo: ${Z.codigo_produto_xml}) - selecionado_na_importacao: ${Z.selecionado_na_importacao}`)}),g(be);const Ue={};be.forEach((Z,Y)=>{Z.xml.precoVenda&&(Ue[Y]={salePrice:Number(Z.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Ue),_(Ue),d("preview")}catch(ae){console.error("[XMLReprocess] Erro ao processar arquivo automtico:",ae),l({title:"Erro",description:"Erro ao processar o XML salvo.",variant:"destructive"})}},B=async G=>{const Q=G.target.files?.[0];if(!Q){console.log("[XMLReprocess] Nenhum arquivo selecionado");return}if(console.log("[XMLReprocess] Arquivo selecionado:",Q.name),!Q.name.endsWith(".xml")){l({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}f(Q);try{console.log("[XMLReprocess] Lendo contedo do arquivo...");const ae=await Q.text();console.log("[XMLReprocess] Arquivo lido, parseando XML...");const J=aS(ae);if(console.log("[XMLReprocess] XML parseado:",J),!J.success){l({title:"Erro ao ler XML",description:J.error||"XML invlido",variant:"destructive"});return}if(!J.data?.produtos||J.data.produtos.length===0){l({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(J.data?.nfe?.chaveAcesso!==r?.chave_nfe){l({title:"XML incompatvel",description:"Este XML no corresponde  NF-e selecionada. Verifique a chave de acesso.",variant:"destructive"});return}h(J.data);let je=n;try{je=await Uu({search:"",codigoEmpresa:a,includeInactive:!0})||n,console.log("[XMLReprocess] Produtos carregados para validao:",je.length)}catch(Z){console.warn("[XMLReprocess] No foi possvel carregar lista completa, usando cache:",Z)}const be=J.data.produtos.map((Z,Y)=>{const lt=oS(Z,je);return{xml:Z,existing:lt,isNew:!lt,willCreate:!lt,willUpdate:!!lt,selected:!0,index:Y}});g(be);const Ue={};be.forEach((Z,Y)=>{Z.xml.precoVenda&&(Ue[Y]={salePrice:Number(Z.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Ue),_(Ue),console.log("[XMLReprocess] Preview preparado, mudando para step preview. Total produtos:",be.length),d("preview")}catch(ae){console.error("[XMLReprocess] Erro ao processar arquivo:",ae),l({title:"Erro",description:"Erro ao processar o arquivo XML.",variant:"destructive"})}},L=()=>{I({isOpen:!0})},V=async()=>{if(I({isOpen:!1}),!m||!r){l({title:"Erro",description:"Dados insuficientes para reprocessamento.",variant:"destructive"});return}y(!0),d("processing");const G={created:0,updated:0,removed:0,errors:0,details:[]},Q=v.filter(J=>J.selected),ae=v.filter(J=>!J.selected);console.log("[XMLReprocess] Iniciando reprocessamento para compra:",r.id),console.log("[XMLReprocess] Produtos selecionados:",Q.length),console.log("[XMLReprocess] Produtos desmarcados:",ae.length);try{for(const J of ae){const be=(j[J.index]||{}).name||J.xml.nome,Ue=Number(J.xml.quantidade);try{if(J.isNew){const Z=J.existing;Z&&(await dR(Z.id),G.removed++,G.details.push({produto:be,acao:"Produto removido (era novo e foi desmarcado)",status:"success"}))}else{const Z=J.existing;Z&&Ue>0&&(await Xv({productId:Z.id,delta:-Ue,codigoEmpresa:r.codigo_empresa}),G.updated++,G.details.push({produto:be,acao:`Estoque revertido -${Ue}`,status:"success"}))}}catch(Z){console.error(`[XMLReprocess] Erro ao processar produto desmarcado: ${be}`,Z),G.errors++,G.details.push({produto:be,acao:`Erro ao reverter: ${Z.message}`,status:"error"})}}for(const J of Q){const je=j[J.index]||{},be=je.name||J.xml.nome,Ue=je.qty!==void 0?je.qty:Number(J.xml.quantidade),Z=je.margin,Y=je.salePrice,lt=je.linkedProductId;try{if(J.isNew&&(!lt||lt==="new")){const gt=P4(J.xml,r.codigo_empresa);if(be&&(gt.name=be),Y!=null)gt.salePrice=Y,gt.price=Y;else if(Z!=null&&Z>0){const at=gt.costPrice||0;if(at>0){const yt=at*(1+Z/100);gt.salePrice=yt,gt.price=yt}}else gt.salePrice!=null&&gt.price==null&&(gt.price=gt.salePrice);const Te=await nS(gt,{codigoEmpresa:r.codigo_empresa});Ue>0&&await Xv({productId:Te.id,delta:Ue,codigoEmpresa:r.codigo_empresa}),G.created++,G.details.push({produto:be,acao:Ue>0?`Criado com estoque ${Ue}`:"Criado",status:"success"})}else{const gt=lt&&lt!=="force-new"&&lt!=="new"?n.find(Te=>Te.id===lt):J.existing;if(je.updatePrice&&gt){const Te=Number(J.xml.valorUnitario)||0,at={};if(Te>0&&(at.costPrice=Te),Y!=null)at.salePrice=Y,at.price=Y;else if(Z!=null&&Z>0&&Te>0){const yt=Te*(1+Z/100);at.salePrice=yt,at.price=yt}await T5(gt.id,at)}G.updated++,G.details.push({produto:be,acao:je.updatePrice?"Preo atualizado":"Mantido sem alteraes",status:"success"})}}catch(gt){console.error(`[XMLReprocess] Erro ao processar produto: ${be}`,gt),G.errors++,G.details.push({produto:be,acao:`Erro: ${gt.message}`,status:"error"})}}}catch(J){console.error("[XMLReprocess] Erro geral no reprocessamento:",J),G.errors++,G.details.push({produto:"Sistema",acao:`Erro geral: ${J.message}`,status:"error",error:J.message})}try{const J=Q.map(je=>{const be=j[je.index]||{},Ue=be.linkedProductId;let Z=null;return Ue&&Ue!=="force-new"?Z=Ue:!je.isNew&&Ue!=="force-new"&&(Z=je.existing?.id||null),{produtoId:Z,codigoProdutoXML:je.xml.codigo,nomeProdutoXML:je.xml.nome,eanXML:je.xml.ean,ncmXML:je.xml.ncm,cfopXML:je.xml.cfop,unidadeXML:je.xml.unidade,quantidade:be.qty!==void 0?be.qty:Number(je.xml.quantidade),valorUnitario:Number(je.xml.valorUnitario)||0,valorTotal:Number(je.xml.valorTotal)||0,vinculadoManualmente:!!Ue&&Ue!=="force-new"}});await Vat(r.id,J),console.log("[XMLReprocess] Itens reprocessados:",J.length)}catch(J){console.error("[XMLReprocess] Erro ao reprocessar itens da compra:",J),G.errors++,G.details.push({produto:"Itens da NF-e",acao:"Erro ao reprocessar",status:"error",error:J.message})}w(G),y(!1),d("done"),G.errors===0?l({title:"Reprocessamento concludo!",description:`${G.created} produto(s) criado(s), ${G.updated} atualizado(s).`,variant:"success"}):l({title:"Reprocessamento com erros",description:`${G.errors} erro(s) encontrado(s). Verifique os detalhes.`,variant:"destructive"}),i&&i()};p.useEffect(()=>{e||(d("upload"),f(null),h(null),g([]),_({}),k({}),w({created:0,updated:0,errors:0,details:[]}),y(!1),A({}))},[e]);const re=()=>{t(!1)},me=v.filter(G=>G.selected).length;return o.jsxs(ln,{open:e,onOpenChange:re,children:[o.jsxs(sn,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] overflow-hidden flex flex-col",children:[o.jsxs(an,{children:[o.jsxs(nn,{className:"flex items-center gap-2",children:[o.jsx(Ap,{className:"h-5 w-5"}),o.jsx("span",{children:"Reprocessar XML"}),o.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:D()}),o.jsx("span",{className:"text-sm text-text-muted",children:r?.numero_nfe})]}),o.jsx(_n,{children:"Reimporte o XML para atualizar os produtos e itens desta NF-e. Os itens atuais sero substitudos pelos novos."})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[c==="upload"&&o.jsx("div",{className:"space-y-6",children:o.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-8 text-center",children:[o.jsx(WT,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selecione o arquivo XML"}),o.jsxs("p",{className:"text-text-muted mb-4",children:["Faa upload do XML da NF-e ",r?.numero_nfe," para reprocessar os produtos"]}),o.jsx("input",{type:"file",accept:".xml",onChange:B,className:"hidden",id:"xml-reprocess-upload"}),o.jsx("label",{htmlFor:"xml-reprocess-upload",children:o.jsx(le,{asChild:!0,children:o.jsx("span",{children:"Selecionar XML"})})})]})}),c==="preview"&&m&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4",children:[o.jsx("h3",{className:"font-semibold mb-2",children:"Informaes da NF-e"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",m.nfe.numero]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",m.nfe.serie]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Modelo:"})," ",D()]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",m.fornecedor?.nome]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Total:"})," R$ ",Number(m.nfe.totalNota||0).toFixed(2)]})]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"font-semibold text-base",children:"Produtos Encontrados"}),o.jsxs("span",{className:"text-sm text-text-muted",children:[v.filter(G=>G.selected).length," de ",v.length," selecionados"]})]}),o.jsx("div",{className:"space-y-2",children:v.map((G,Q)=>{const ae=F(Q,"name",G.xml.nome),J=F(Q,"qty",Number(G.xml.quantidade)),je=F(Q,"linkedProductId",null),be=G.xml.valorUnitario||0,Ue=F(Q,"margin",null);let Y=F(Q,"salePrice",null);Y==null&&!G.isNew&&G.existing&&(Y=Number(G.existing.preco_venda||G.existing.salePrice||G.existing.price||0)),Y==null&&Ue!=null&&(Y=z(be,Ue)),Y==null&&G.xml.precoVenda&&(Y=Number(G.xml.precoVenda));let lt=null;if(Ue!=null)lt=Ue;else if(Y!=null&&be>0&&Y>0){const Te=(Y-be)/be*100;lt=Math.max(-999,Math.min(9999,Te))}const gt=S[Q];return o.jsxs("div",{className:Jt("rounded-lg border transition-all",G.selected?"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[o.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx("input",{type:"checkbox",checked:G.selected,onChange:()=>K(Q),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),o.jsx("button",{onClick:()=>q(Q),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:gt?o.jsx(z1,{className:"w-4 h-4 text-text-muted"}):o.jsx(Qx,{className:"w-4 h-4 text-text-muted"})}),o.jsx("div",{children:je?o.jsx(gH,{className:"w-5 h-5 text-warning"}):o.jsx(Ap,{className:"w-5 h-5 text-info"})})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"font-semibold text-sm truncate",children:je&&je!=="force-new"&&je!=="new"?(()=>{const Te=n.find(at=>at.id===je);return Te?Te.name:ae})():ae}),o.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[G.xml.codigo&&o.jsxs("span",{className:"flex-shrink-0",children:["#",G.xml.codigo]}),o.jsxs("span",{children:["Qtd: ",J]})]})]}),o.jsx("div",{className:"flex-shrink-0 ml-2",children:je?o.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-warning/20 text-warning font-medium",children:"Vinculado"}):o.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),o.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[o.jsxs("span",{children:["R$ ",be.toFixed(2),Y?`  R$ ${Y.toFixed(2)}`:""]}),lt!=null&&o.jsxs("span",{className:"ml-2 "+(lt>0?"text-success":lt<0?"text-destructive":"text-text-muted"),children:[lt.toFixed(1),"%"]})]})]})]}),gt&&o.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),o.jsx("input",{type:"text",value:ae,onChange:Te=>$(Q,"name",Te.target.value),disabled:!G.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{type:"button",onClick:()=>$(Q,"qty",Math.max(0,J-1)),disabled:!G.selected||J<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:o.jsx(xv,{className:"w-4 h-4"})}),o.jsx("input",{type:"text",value:J,onChange:Te=>{const at=Te.target.value.replace(/\D/g,"");$(Q,"qty",at===""?0:Number(at))},disabled:!G.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),o.jsx("button",{type:"button",onClick:()=>$(Q,"qty",J+1),disabled:!G.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:o.jsx(Ga,{className:"w-4 h-4"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",value:(()=>{const Te=F(Q,"margin",null);return Te!=null?String(Te):""})(),onChange:Te=>{const at=Te.target.value;if(at===""){$(Q,"margin",null),$(Q,"salePrice",null);return}const yt=at.replace(/[^0-9.,\-]/g,"").replace(",",".");if(yt==="."||yt==="-"||yt==="-.")return;const vt=parseFloat(yt);if(!isNaN(vt)&&($(Q,"margin",vt),be>0)){const Sr=z(be,vt);$(Q,"salePrice",Sr)}},disabled:!G.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),o.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),o.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:o.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",be.toFixed(2)]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),o.jsx("input",{type:"text",value:(()=>{const Te=F(Q,"salePrice",Y);return Te==null?"":Number(Te).toFixed(2).replace(".",",")})(),onChange:Te=>{const at=Te.target.value.replace(/\D/g,"");if(at===""){$(Q,"salePrice",null);return}const yt=Number(at)/100;if($(Q,"salePrice",yt),yt>0&&be>0){const vt=(yt-be)/be*100;$(Q,"margin",Math.round(vt*100)/100)}},disabled:!G.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[o.jsx("input",{type:"checkbox",id:`update-price-${Q}`,checked:F(Q,"updatePrice",!1),onChange:Te=>$(Q,"updatePrice",Te.target.checked),disabled:!G.selected,className:"w-4 h-4 text-brand bg-surface border-border rounded focus:ring-brand focus:ring-2 disabled:opacity-50"}),o.jsx("label",{htmlFor:`update-price-${Q}`,className:"text-sm text-text-primary select-none cursor-pointer",children:"Atualizar preo do produto no sistema"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Vincular a Produto Existente (Opcional)"}),o.jsxs(En,{value:je==="force-new"?"force-new":je||(G.isNew?"new":G.existing?.id||"new"),onValueChange:Te=>{Te==="new"||Te===G.existing?.id?ce(Q,null):Te==="search"?C({isOpen:!0,productIndex:Q,currentProduct:G}):ce(Q,Te)},disabled:!G.selected,children:[o.jsx(Sn,{className:"w-full hover:bg-white/5 transition-colors",children:o.jsx(kn,{placeholder:G.isNew?" Criar como novo produto":" Atualizar produto existente"})}),o.jsxs(Cn,{className:"max-h-[300px] overflow-y-auto",children:[G.isNew?o.jsx(Nt,{value:"new",children:" Criar como novo produto"}):o.jsxs(Nt,{value:G.existing?.id||"new",children:[" Atualizar: ",G.existing?.name," (Estoque atual: ",G.existing?.stock||0,")"]}),!G.isNew&&o.jsx(Nt,{value:"force-new",children:" Criar como novo produto (ignorar existente)"}),o.jsx(Nt,{value:"search",children:" Buscar produto para vincular..."})]})]})]})]})]},Q)})})]})]}),c==="processing"&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx(Om,{className:"h-12 w-12 animate-spin text-brand mb-4"}),o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Reprocessando XML..."}),o.jsx("p",{className:"text-text-muted",children:"Atualizando produtos e itens da NF-e"})]}),c==="done"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"text-center py-6",children:[b.errors===0?o.jsx(Pi,{className:"h-12 w-12 text-success mx-auto mb-4"}):o.jsx(pc,{className:"h-12 w-12 text-warning mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold mb-2",children:b.errors===0?"Reprocessamento Concludo!":"Reprocessamento com Erros"}),o.jsxs("div",{className:"text-text-muted",children:[b.created," produto(s) criado(s), ",b.updated," atualizado(s)",b.errors>0&&`, ${b.errors} erro(s)`]})]}),b.details.length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-3",children:"Detalhes do Reprocessamento"}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:b.details.map((G,Q)=>o.jsxs("div",{className:Jt("flex items-center gap-3 p-2 rounded",G.status==="success"?"bg-green-50 text-green-800":G.status==="error"?"bg-red-50 text-red-800":"bg-gray-50 text-gray-800"),children:[G.status==="success"?o.jsx(Pi,{className:"h-4 w-4 flex-shrink-0"}):o.jsx(pc,{className:"h-4 w-4 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium truncate",children:G.produto}),o.jsx("div",{className:"text-xs",children:G.acao}),G.error&&o.jsx("div",{className:"text-xs mt-1 opacity-75",children:G.error})]})]},Q))})]})]})]}),o.jsxs(Un,{children:[c==="upload"&&o.jsx(le,{variant:"outline",onClick:re,children:"Cancelar"}),c==="preview"&&o.jsxs(o.Fragment,{children:[o.jsx(le,{variant:"outline",onClick:()=>d("upload"),children:"Voltar"}),o.jsxs(le,{onClick:L,disabled:me===0,children:["Reprocessar (",me," produtos)"]})]}),c==="done"&&o.jsx(le,{onClick:re,children:"Fechar"})]})]}),o.jsx(noe,{isOpen:M.isOpen,onClose:()=>C({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:G=>{console.log("[XMLReprocessModal] onSelect chamado com produto:",G),console.log("[XMLReprocessModal] Index do produto:",M.productIndex),ce(M.productIndex,G.id),C({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:M.currentProduct}),o.jsx(aoe,{isOpen:T.isOpen,onClose:()=>I({isOpen:!1}),onConfirm:V,products:v.map((G,Q)=>({...G,originalIndex:Q})),editedProducts:j,allProducts:n,isReprocess:!0})]})}const mU="comprasPage:settings";function not(){const{user:e,userProfile:t}=Do(),[r,n]=p.useState([]),[a,i]=p.useState(!0),[s,l]=p.useState(""),[c,d]=p.useState(null),[u,f]=p.useState([]),[m,h]=p.useState(!1),[v,g]=p.useState(()=>pl(new Date)),[x,y]=p.useState(()=>XS(new Date)),[b,w]=p.useState("all"),[j,_]=p.useState(!0),[S,k]=p.useState(!1),[E,A]=p.useState("active"),[M,C]=p.useState({show:!1,purchase:null}),[T,I]=p.useState(""),[D,F]=p.useState({show:!1,purchase:null}),[z,q]=p.useState({}),[$,K]=p.useState({show:!1,purchase:null}),[ce,fe]=p.useState([]),[B,L]=p.useState(!1),[V,re]=p.useState(!1),[me,G]=p.useState("paged"),Q=me==="paged",[ae,J]=p.useState(1),[je]=p.useState(100),[be,Ue]=p.useState(0),Z=te=>{const $e=String(te||"").replace(/\D/g,"");return($e?Number($e)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},Y=te=>{if(!te.xml_completo){alert("XML no disponvel para esta NF-e");return}const $e=new Blob([te.xml_completo],{type:"text/xml;charset=utf-8"}),Pe=URL.createObjectURL($e),It=document.createElement("a");It.href=Pe,It.download=`${te.chave_nfe}.xml`,document.body.appendChild(It),It.click(),document.body.removeChild(It),URL.revokeObjectURL(Pe)},lt=async te=>{if(!te.xml_completo){alert("XML no disponvel para reprocessamento automtico");return}if(confirm("Deseja reprocessar esta NF-e? Isso substituir todos os itens atuais pelos dados do XML original."))try{console.log("[ComprasPage] Iniciando reprocessamento para purchase:",te),console.log("[ComprasPage] Chave NF-e:",te.chave_nfe),console.log("[ComprasPage] XML disponvel:",!!te.xml_completo);const $e=new Blob([te.xml_completo],{type:"text/xml"}),Pe=new File([$e],`${te.chave_nfe}.xml`,{type:"text/xml"});K({show:!0,purchase:te,autoFile:Pe})}catch($e){console.error("Erro no reprocessamento automtico:",$e),alert("Erro ao iniciar reprocessamento automtico")}},gt=te=>{if(!te)return 0;const $e=String(te).replace(/\./g,"").replace(",",".");return parseFloat($e)||0};p.useEffect(()=>{try{const te=localStorage.getItem(mU);if(!te)return;const $e=JSON.parse(te);$e&&typeof $e=="object"&&(($e.listMode==="paged"||$e.listMode==="all")&&G($e.listMode),typeof $e.showStats=="boolean"&&_($e.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!e?.id||!t?.codigo_empresa)return;const $e=`compras:${t.codigo_empresa}`,Pe=await Zae({userId:e.id,scope:$e});Pe&&((Pe.listMode==="paged"||Pe.listMode==="all")&&G(Pe.listMode),typeof Pe.showStats=="boolean"&&_(Pe.showStats))})()},[e?.id,t?.codigo_empresa]),p.useEffect(()=>{try{const te={listMode:me,showStats:j};localStorage.setItem(mU,JSON.stringify(te))}catch{}if(e?.id&&t?.codigo_empresa){const te=`compras:${t.codigo_empresa}`;eoe({userId:e.id,scope:te,settings:{listMode:me,showStats:j}})}},[me,j,e?.id,t?.codigo_empresa]),p.useEffect(()=>{t?.codigo_empresa&&(at(),Te())},[t,E,b,v,x,ae,me]),p.useEffect(()=>{J(1)},[E,b,v,x,me]);const Te=async()=>{try{const te=await Uu({codigoEmpresa:t.codigo_empresa});fe(te||[])}catch(te){console.error("[Compras] Erro ao carregar produtos:",te)}},at=async()=>{try{i(!0);let te=null,$e=null;if(v){const cr=new Date(v);cr.setHours(0,0,0,0),te=cr.toISOString()}if(x){const cr=new Date(x);cr.setHours(23,59,59,999),$e=cr.toISOString()}const Dt={incluirInativas:E==="all"||E==="inactive",apenasInativas:E==="inactive",fornecedorId:b!=="all"?b:void 0,dataInicio:te,dataFim:$e,page:Q?ae:1,pageSize:Q?je:1e4},kt=await qat(t.codigo_empresa,Dt);n(kt?.data||[]),Ue(kt?.count||0)}catch(te){console.error("[Compras] Erro ao carregar compras:",te)}finally{i(!1)}},yt=async te=>{d(te),h(!0);try{const $e=await roe(te.id);f($e||[])}catch($e){console.error("[Compras] Erro ao carregar itens:",$e),f([])}finally{h(!1)}},vt=()=>{d(null),f([])},Sr=te=>{F({show:!0,purchase:te}),q({numeroNfe:te.numero_nfe||"",serieNfe:te.serie_nfe||"",dataEmissao:te.data_emissao?te.data_emissao.split("T")[0]:"",tipoOperacao:te.tipo_operacao||"",naturezaOperacao:te.natureza_operacao||"",valorProdutos:Z((te.valor_produtos||0)*100),valorTotal:Z((te.valor_total||0)*100),formaPagamento:te.forma_pagamento||"",observacoes:te.observacoes||""})},se=async()=>{try{await Wat(D.purchase.id,{...z,valorProdutos:gt(z.valorProdutos),valorTotal:gt(z.valorTotal),fornecedorId:D.purchase.fornecedor_id}),await at(),F({show:!1,purchase:null}),q({}),console.log("Compra editada com sucesso!")}catch(te){console.error("Erro ao editar compra:",te)}},Ze=p.useMemo(()=>{const te=new Map;return r.forEach($e=>{$e.fornecedor?.id&&te.set($e.fornecedor.id,$e.fornecedor)}),Array.from(te.values())},[r]),ct=p.useMemo(()=>r.filter(te=>{if(s){const $e=s.toLowerCase();if(!(te.numero_nfe?.toLowerCase().includes($e)||te.fornecedor?.nome?.toLowerCase().includes($e)||te.chave_nfe?.toLowerCase().includes($e)))return!1}return!0}),[r,s]),Qt=p.useMemo(()=>{const te=ct.reduce((kt,cr)=>kt+Number(cr.valor_total||0),0),$e=ct.length,Pe=$e>0?te/$e:0,It={};ct.forEach(kt=>{const cr=kt.fornecedor?.id||"unknown",Cr=kt.fornecedor?.nome||"No identificado";It[cr]||(It[cr]={name:Cr,total:0,count:0}),It[cr].total+=Number(kt.valor_total||0),It[cr].count+=1});const Dt=Object.values(It).sort((kt,cr)=>cr.total-kt.total).slice(0,5);return{total:te,count:$e,avgTicket:Pe,topSuppliers:Dt}},[ct]),we=p.useMemo(()=>{if(!je)return 1;const te=Math.ceil((be||0)/je);return te>0?te:1},[be,je]),ye=()=>{const te=["NF-e","Serie","Data Emissao","Fornecedor","CNPJ","Tipo","Valor Total","Valor Produtos","Forma Pagamento"],$e=ct.map(kt=>[kt.numero_nfe||"",kt.serie_nfe||"",kt.data_emissao?Xt(new Date(kt.data_emissao),"dd/MM/yyyy"):"",(kt.fornecedor?.nome||"").replace(/,/g," "),kt.fornecedor?.cnpj||"",kt.tipo_operacao||"",Number(kt.valor_total||0).toFixed(2),Number(kt.valor_produtos||0).toFixed(2),(kt.forma_pagamento||"").replace(/,/g," ")]),Pe=[te,...$e].map(kt=>kt.join(";")).join(`
`),It=new Blob(["\uFEFF"+Pe],{type:"text/csv;charset=utf-8;"}),Dt=document.createElement("a");Dt.href=URL.createObjectURL(It),Dt.download=`compras_${Xt(new Date,"yyyy-MM-dd")}.csv`,Dt.click()};return o.jsxs("div",{className:"px-3 py-4 md:p-6 max-w-7xl mx-auto",children:[o.jsx("div",{className:"mb-4",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3 md:gap-4 mb-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:"Compras (NF-e)"}),o.jsx(le,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>re(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:o.jsx(Hm,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"flex flex-row flex-wrap items-end gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-[140px]",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Inicial"}),o.jsxs(yc,{modal:!0,children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[o.jsx(gi,{className:"mr-2 h-4 w-4"}),v?Xt(v,"dd/MM/yyyy"):o.jsx("span",{children:"Selecionar"})]})}),o.jsx(Ml,{className:"w-auto p-0 z-50",align:"end",children:o.jsx(wc,{mode:"single",selected:v,onSelect:g,locale:aa})})]})]}),o.jsxs("div",{className:"flex-1 min-w-[140px]",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Final"}),o.jsxs(yc,{modal:!0,children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[o.jsx(gi,{className:"mr-2 h-4 w-4"}),x?Xt(x,"dd/MM/yyyy"):o.jsx("span",{children:"Selecionar"})]})}),o.jsx(Ml,{className:"w-auto p-0 z-50",align:"end",children:o.jsx(wc,{mode:"single",selected:x,onSelect:y,locale:aa})})]})]}),(v||x)&&o.jsx(le,{variant:"ghost",size:"sm",onClick:()=>{g(null),y(null)},className:"h-8 px-3 text-xs",children:"Limpar"})]})]})}),j&&ct.length>0&&o.jsxs("div",{className:"mb-4 space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[o.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[o.jsx(rs,{className:"h-3.5 w-3.5"}),o.jsx("span",{children:"NF-es"})]}),o.jsx("p",{className:"text-lg md:text-2xl font-bold text-text-primary leading-none",children:Qt.count})]}),o.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[o.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[o.jsx(Ui,{className:"h-3.5 w-3.5"}),o.jsx("span",{children:"Total"})]}),o.jsxs("p",{className:"text-base md:text-2xl font-bold text-success leading-none whitespace-nowrap",children:["R$ ",Qt.total.toFixed(2)]})]}),o.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[o.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[o.jsx(_u,{className:"h-3.5 w-3.5"}),o.jsx("span",{children:"Fornec."})]}),o.jsx("p",{className:"text-lg md:text-2xl font-bold text-info leading-none",children:Ze.length})]})]}),Qt.topSuppliers.length>0&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(yP,{className:"h-4 w-4"}),"Top 5 Fornecedores"]}),o.jsx(le,{variant:"ghost",size:"sm",onClick:()=>k(!0),className:"text-xs",children:"Ver Todos"})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Qt.topSuppliers.map((te,$e)=>{const Pe=te.total/Qt.total*100;return o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs",children:[o.jsx("span",{className:"text-text-primary font-medium truncate flex-1",title:te.name,children:te.name}),o.jsxs("span",{className:"text-text-muted text-xs ml-2 flex-shrink-0",children:["R$ ",te.total.toFixed(2)]})]}),o.jsx("div",{className:"w-full bg-surface-2 rounded-full h-1.5",children:o.jsx("div",{className:"bg-brand rounded-full h-1.5 transition-all",style:{width:`${Pe}%`}})})]},$e)})})]})]}),o.jsx("div",{className:"mb-6 space-y-4",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-4 md:flex-wrap",children:[o.jsxs("div",{className:"flex items-center gap-2 w-full md:flex-1 md:min-w-[250px]",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar por NF-e, fornecedor ou chave...",value:s,onChange:te=>l(te.target.value),className:"pl-10"})]}),o.jsx(le,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>L(te=>!te),"aria-label":"Filtros",children:o.jsx(Tk,{className:"h-4 w-4"})})]}),B&&o.jsxs("div",{className:"md:hidden mt-1 space-y-3 px-0.5",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Fornecedor"}),o.jsxs(En,{value:b,onValueChange:w,children:[o.jsxs(Sn,{className:"w-full text-sm",children:[o.jsx(_u,{className:"h-4 w-4 mr-2 flex-shrink-0"}),o.jsx("div",{className:"truncate",children:o.jsx(kn,{placeholder:"Todos"})})]}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Todos"}),Ze.map(te=>o.jsx(Nt,{value:te.id,children:o.jsx("div",{className:"truncate max-w-[220px]",title:te.nome,children:te.nome})},te.id))]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Status"}),o.jsxs(En,{value:E,onValueChange:A,children:[o.jsx(Sn,{className:"w-full text-sm",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"active",children:"Apenas ativas"}),o.jsx(Nt,{value:"all",children:"Todas"}),o.jsx(Nt,{value:"inactive",children:"Apenas inativas"})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1 border-t border-border/60",children:[o.jsxs(le,{type:"button",variant:"ghost",size:"sm",className:"gap-2 text-xs px-2",onClick:()=>_(!j),children:[o.jsx(yP,{className:"h-4 w-4"}),j?"Ocultar estatsticas":"Mostrar estatsticas"]}),o.jsxs(le,{type:"button",variant:"outline",size:"sm",onClick:ye,disabled:ct.length===0,className:"gap-1 text-xs px-3",children:[o.jsx(ei,{className:"h-4 w-4"}),"CSV"]})]})]}),o.jsxs("div",{className:"hidden md:flex md:items-center md:gap-4 md:flex-wrap w-full",children:[o.jsxs(En,{value:b,onValueChange:w,children:[o.jsxs(Sn,{className:"w-full md:w-[220px]",children:[o.jsx(_u,{className:"h-4 w-4 mr-2 flex-shrink-0"}),o.jsx("div",{className:"truncate",children:o.jsx(kn,{placeholder:"Fornecedor"})})]}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Todos"}),Ze.map(te=>o.jsx(Nt,{value:te.id,children:o.jsx("div",{className:"truncate max-w-[180px]",title:te.nome,children:te.nome})},te.id))]})]}),o.jsxs(le,{variant:"outline",onClick:ye,disabled:ct.length===0,className:"gap-2 w-full sm:w-auto justify-center",children:[o.jsx(ei,{className:"h-4 w-4"}),"Exportar CSV"]}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>_(!j),className:"gap-2",children:[o.jsx(yP,{className:"h-4 w-4"}),j?"Ocultar":"Mostrar"]}),o.jsxs(En,{value:E,onValueChange:A,children:[o.jsx(Sn,{className:"w-[140px]",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"active",children:"Apenas ativas"}),o.jsx(Nt,{value:"all",children:"Todas"}),o.jsx(Nt,{value:"inactive",children:"Apenas inativas"})]})]})]})]})]})}),a?o.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-border",children:[o.jsx(gd,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),o.jsx("p",{className:"text-text-muted",children:s?"Nenhuma compra encontrada":"Nenhuma NF-e importada ainda"}),o.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Importe XMLs de NF-e na pgina de Produtos"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"grid gap-3",children:ct.map(te=>o.jsx("div",{className:`rounded-lg border overflow-hidden transition-all hover:shadow-lg ${te.ativo===!1?"bg-gray-900/60 border-red-500 shadow-red-500/20":"bg-surface border-border hover:border-brand/50"}`,onClick:()=>yt(te),children:o.jsx("div",{className:"p-4",children:o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",children:o.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[o.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[o.jsx(rs,{className:"h-6 w-6 text-brand mt-0.5 flex-shrink-0"}),o.jsx("div",{className:"min-w-0",children:o.jsxs("h3",{className:`font-semibold text-sm md:text-base leading-snug ${te.ativo===!1?"text-red-600":"text-text-primary"}`,children:["NF-e ",te.numero_nfe," / Srie ",te.serie_nfe,te.ativo===!1&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 bg-red-100 text-red-700 text-[10px] rounded-full font-medium align-middle",children:"INATIVA"})]})})]}),o.jsx("div",{className:"sm:hidden flex items-center",children:o.jsxs("span",{className:"text-success font-semibold text-xs whitespace-nowrap pr-2",children:["R$ ",Number(te.valor_total||0).toFixed(2)]})})]}),o.jsxs("div",{className:"space-y-2.5",children:[o.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[o.jsx(_u,{className:"h-5 w-5 flex-shrink-0 text-brand"}),o.jsx("span",{className:"font-medium text-text-primary text-sm md:text-base overflow-hidden truncate",title:te.fornecedor?.nome||"Fornecedor no identificado",children:te.fornecedor?.nome||"Fornecedor no identificado"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1.5 text-xs md:text-sm text-text-muted",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(gi,{className:"h-4 w-4"}),o.jsx("span",{children:te.data_emissao?Xt(new Date(te.data_emissao),"dd/MM/yyyy",{locale:aa}):"Data no informada"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(gd,{className:"h-4 w-4"}),o.jsx("span",{children:te.tipo_operacao||"Entrada"})]}),te.chave_nfe&&o.jsxs("div",{className:"text-[10px] md:text-xs max-w-[180px] md:max-w-xs overflow-hidden whitespace-nowrap truncate",children:[o.jsx("span",{className:"font-medium",children:"Chave:"})," ",te.chave_nfe.length>20?te.chave_nfe.slice(0,20)+"...":te.chave_nfe]})]}),te.natureza_operacao&&o.jsx("p",{className:"text-[10px] md:text-xs text-text-muted overflow-hidden whitespace-nowrap truncate",title:te.natureza_operacao,children:te.natureza_operacao})]})]}),o.jsxs("div",{className:"hidden sm:flex sm:flex-col sm:gap-3 sm:mt-0 sm:w-auto",children:[o.jsx("div",{className:"w-full flex justify-end",children:o.jsxs("div",{className:"text-right text-text-muted",children:[o.jsxs("span",{className:"text-success font-semibold text-base md:text-lg whitespace-nowrap",children:["R$ ",Number(te.valor_total||0).toFixed(2)]}),o.jsxs("p",{className:"text-[11px] md:text-xs mt-0.5",children:["Produtos: R$ ",Number(te.valor_produtos||0).toFixed(2)]})]})}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full justify-end",children:[o.jsxs(le,{onClick:$e=>{$e.stopPropagation(),yt(te)},size:"sm",className:"gap-2 w-full justify-center",children:[o.jsx(Vp,{className:"h-4 w-4"}),o.jsx("span",{className:"text-xs sm:text-sm",children:"Detalhes"})]}),te.ativo&&o.jsxs(le,{onClick:$e=>{$e.stopPropagation(),Sr(te)},size:"sm",variant:"outline",className:"gap-2 w-full justify-center",children:[o.jsx(ll,{className:"h-4 w-4"}),o.jsx("span",{className:"text-xs sm:text-sm",children:"Editar"})]})]})]})]})})})},te.id))}),Q&&o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted",children:[o.jsxs("span",{children:["Pgina ",ae," de ",we," (",be," NF-es)"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(le,{type:"button",variant:"outline",size:"sm",onClick:()=>J(te=>Math.max(1,te-1)),disabled:ae<=1,children:"Anterior"}),o.jsx(le,{type:"button",variant:"outline",size:"sm",onClick:()=>J(te=>Math.min(we,te+1)),disabled:ae>=we,children:"Prxima"})]})]})]}),o.jsx(ln,{open:V,onOpenChange:re,children:o.jsxs(sn,{className:"w-[90vw] sm:max-w-md max-h-[80vh] flex flex-col",children:[o.jsx(an,{children:o.jsx(nn,{children:"Configuraes de Compras"})}),o.jsxs("div",{className:"space-y-4 text-sm",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Modo de listagem"}),o.jsxs(En,{value:me,onValueChange:G,children:[o.jsx(Sn,{className:"w-full h-9 text-sm",children:o.jsx(kn,{placeholder:"Paginado"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"paged",children:"Paginado (100 por pgina)"}),o.jsx(Nt,{value:"all",children:"Todos (sem paginao)"})]})]})]}),o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Fo,{id:"compras-show-stats",checked:j,onCheckedChange:_}),o.jsx("label",{htmlFor:"compras-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de estatsticas"})]})})]})]})}),o.jsx(ln,{open:M.show,onOpenChange:te=>C({show:te,purchase:null}),children:o.jsxs(sn,{className:"w-[90vw] sm:max-w-md",children:[o.jsx(an,{children:o.jsx(nn,{children:"Inativar NF-e"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("p",{className:"text-sm text-text-muted",children:["Tem certeza que deseja inativar a NF-e ",o.jsx("strong",{children:M.purchase?.numero_nfe}),"?"]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Motivo da inativao:"}),o.jsx(ir,{value:T,onChange:te=>I(te.target.value),placeholder:"Ex: NF-e duplicada, erro na importao...",className:"w-full"})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(le,{variant:"outline",onClick:()=>{C({show:!1,purchase:null}),I("")},children:"Cancelar"}),o.jsx(le,{variant:"destructive",onClick:async()=>{if(!T.trim()){alert("Por favor, informe o motivo da inativao");return}try{await zat(M.purchase.id,T.trim(),t.id),C({show:!1,purchase:null}),I(""),at()}catch(te){console.error("Erro ao inativar compra:",te),alert("Erro ao inativar NF-e. Tente novamente.")}},disabled:!T.trim(),children:"Inativar"})]})]})]})}),c&&o.jsx(tot,{purchase:c,items:m?[]:u,onClose:vt,onEdit:Sr,onReprocess:lt,onDownloadXML:Y,onInactivate:te=>C({show:!0,purchase:te})}),o.jsx(ln,{open:S,onOpenChange:k,children:o.jsxs(sn,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[o.jsx(an,{children:o.jsx(nn,{children:"Todos os Fornecedores"})}),o.jsx("div",{className:"px-6 py-3 bg-surface-2 border-y border-border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-muted",children:"Valor Total Geral"}),o.jsxs("span",{className:"text-2xl font-bold text-success",children:["R$ ",Qt.total.toFixed(2)]})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:o.jsx("div",{className:"space-y-3 pr-2",children:Object.entries(ct.reduce((te,$e)=>{const Pe=$e.fornecedor?.id||"unknown",It=$e.fornecedor?.nome||"No identificado";return te[Pe]||(te[Pe]={name:It,total:0,count:0}),te[Pe].total+=Number($e.valor_total||0),te[Pe].count+=1,te},{})).sort(([,te],[,$e])=>$e.total-te.total).map(([te,$e],Pe)=>{const It=$e.total/Qt.total*100;return o.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center",children:Pe+1}),o.jsx("span",{className:"font-medium text-text-primary",children:$e.name})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"font-bold text-success",children:["R$ ",$e.total.toFixed(2)]}),o.jsxs("p",{className:"text-xs text-text-muted",children:[$e.count," NF-es"]})]})]}),o.jsx("div",{className:"w-full bg-surface rounded-full h-2",children:o.jsx("div",{className:"bg-brand rounded-full h-2 transition-all",style:{width:`${It}%`}})})]},te)})})})]})}),o.jsx(ln,{open:D.show,onOpenChange:te=>F({show:te,purchase:null}),children:o.jsxs(sn,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] flex flex-col",onOpenAutoFocus:te=>te.preventDefault(),children:[o.jsx(an,{children:o.jsx(nn,{children:"Editar NF-e"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Nmero NF-e"}),o.jsx(ir,{value:z.numeroNfe||"",onChange:te=>q($e=>({...$e,numeroNfe:te.target.value})),placeholder:"Nmero da NF-e"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Srie"}),o.jsx(ir,{value:z.serieNfe||"",onChange:te=>q($e=>({...$e,serieNfe:te.target.value})),placeholder:"Srie"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Data de Emisso"}),o.jsx(ir,{type:"date",value:z.dataEmissao||"",onChange:te=>q($e=>({...$e,dataEmissao:te.target.value}))})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Tipo de Operao"}),o.jsxs(En,{value:z.tipoOperacao||"",onValueChange:te=>q($e=>({...$e,tipoOperacao:te})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione o tipo"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"Entrada",children:"0 - Entrada"}),o.jsx(Nt,{value:"Sada",children:"1 - Sada"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Natureza da Operao"}),o.jsxs(En,{value:z.naturezaOperacao||"",onValueChange:te=>q($e=>({...$e,naturezaOperacao:te})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione a natureza"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"Compra para comercializao",children:"Compra para comercializao"}),o.jsx(Nt,{value:"Compra para industrializao",children:"Compra para industrializao"}),o.jsx(Nt,{value:"Compra para uso ou consumo",children:"Compra para uso ou consumo"}),o.jsx(Nt,{value:"Compra de ativo imobilizado",children:"Compra de ativo imobilizado"}),o.jsx(Nt,{value:"Compra de material para uso ou consumo",children:"Compra de material para uso ou consumo"}),o.jsx(Nt,{value:"Devoluo de venda de produo do estabelecimento",children:"Devoluo de venda de produo do estabelecimento"}),o.jsx(Nt,{value:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros",children:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros"}),o.jsx(Nt,{value:"Remessa de mercadoria por conta e ordem de terceiros",children:"Remessa de mercadoria por conta e ordem de terceiros"}),o.jsx(Nt,{value:"Retorno de mercadoria remetida por conta e ordem de terceiros",children:"Retorno de mercadoria remetida por conta e ordem de terceiros"}),o.jsx(Nt,{value:"Remessa para industrializao por encomenda",children:"Remessa para industrializao por encomenda"}),o.jsx(Nt,{value:"Retorno de mercadoria remetida para industrializao por encomenda",children:"Retorno de mercadoria remetida para industrializao por encomenda"}),o.jsx(Nt,{value:"Transferncia de produo do estabelecimento",children:"Transferncia de produo do estabelecimento"}),o.jsx(Nt,{value:"Transferncia de mercadoria adquirida ou recebida de terceiros",children:"Transferncia de mercadoria adquirida ou recebida de terceiros"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Valor dos Produtos"}),o.jsx(ir,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${z.valorProdutos||"0,00"}`,onChange:te=>q($e=>({...$e,valorProdutos:Z(te.target.value)}))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Valor Total"}),o.jsx(ir,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${z.valorTotal||"0,00"}`,onChange:te=>q($e=>({...$e,valorTotal:Z(te.target.value)}))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Forma de Pagamento"}),o.jsxs(En,{value:z.formaPagamento||"",onValueChange:te=>q($e=>({...$e,formaPagamento:te})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione a forma de pagamento"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"01 - Dinheiro",children:"01 - Dinheiro"}),o.jsx(Nt,{value:"02 - Cheque",children:"02 - Cheque"}),o.jsx(Nt,{value:"03 - Carto de Crdito",children:"03 - Carto de Crdito"}),o.jsx(Nt,{value:"04 - Carto de Dbito",children:"04 - Carto de Dbito"}),o.jsx(Nt,{value:"05 - Carto da Loja (Private Label)",children:"05 - Carto da Loja (Private Label)"}),o.jsx(Nt,{value:"10 - Vale Alimentao",children:"10 - Vale Alimentao"}),o.jsx(Nt,{value:"11 - Vale Refeio",children:"11 - Vale Refeio"}),o.jsx(Nt,{value:"12 - Vale Presente",children:"12 - Vale Presente"}),o.jsx(Nt,{value:"13 - Vale Combustvel",children:"13 - Vale Combustvel"}),o.jsx(Nt,{value:"14 - Duplicata Mercantil",children:"14 - Duplicata Mercantil"}),o.jsx(Nt,{value:"15 - Boleto Bancrio",children:"15 - Boleto Bancrio"}),o.jsx(Nt,{value:"16 - Depsito Bancrio",children:"16 - Depsito Bancrio"}),o.jsx(Nt,{value:"17 - PIX Dinmico (QR-Code)",children:"17 - PIX Dinmico (QR-Code)"}),o.jsx(Nt,{value:"18 - Transferncia Bancria / Carteira Digital",children:"18 - Transferncia Bancria / Carteira Digital"}),o.jsx(Nt,{value:"19 - Programa de Fidelidade / Cashback",children:"19 - Programa de Fidelidade / Cashback"}),o.jsx(Nt,{value:"20 - PIX Esttico",children:"20 - PIX Esttico"}),o.jsx(Nt,{value:"21 - Crdito em Loja",children:"21 - Crdito em Loja"}),o.jsx(Nt,{value:"22 - Pagamento Eletrnico no Informado",children:"22 - Pagamento Eletrnico no Informado"}),o.jsx(Nt,{value:"90 - Sem Pagamento",children:"90 - Sem Pagamento"}),o.jsx(Nt,{value:"99 - Outros",children:"99 - Outros"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Observaes"}),o.jsx(ir,{value:z.observacoes||"",onChange:te=>q($e=>({...$e,observacoes:te.target.value})),placeholder:"Observaes adicionais"})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[o.jsx(le,{variant:"outline",onClick:()=>F({show:!1,purchase:null}),children:"Cancelar"}),o.jsx(le,{onClick:se,children:"Salvar Alteraes"})]})]})]})}),o.jsx(rot,{open:$.show,onOpenChange:te=>K({show:te,purchase:null}),purchase:$.purchase,products:ce,codigoEmpresa:t?.codigo_empresa,autoFile:$.autoFile,onSuccess:()=>{at(),K({show:!1,purchase:null})}})]})}const el=xe.forwardRef(({className:e,...t},r)=>o.jsx("div",{className:"relative w-full overflow-auto",children:o.jsx("table",{ref:r,className:Jt("w-full caption-bottom text-sm",e),...t})}));el.displayName="Table";const tl=xe.forwardRef(({className:e,...t},r)=>o.jsx("thead",{ref:r,className:Jt("[&_tr]:border-b",e),...t}));tl.displayName="TableHeader";const rl=xe.forwardRef(({className:e,...t},r)=>o.jsx("tbody",{ref:r,className:Jt("[&_tr:last-child]:border-0",e),...t}));rl.displayName="TableBody";const aot=xe.forwardRef(({className:e,...t},r)=>o.jsx("tfoot",{ref:r,className:Jt("bg-primary font-medium text-primary-foreground",e),...t}));aot.displayName="TableFooter";const Fa=xe.forwardRef(({className:e,...t},r)=>o.jsx("tr",{ref:r,className:Jt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Fa.displayName="TableRow";const yn=xe.forwardRef(({className:e,...t},r)=>o.jsx("th",{ref:r,className:Jt("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));yn.displayName="TableHead";const en=xe.forwardRef(({className:e,...t},r)=>o.jsx("td",{ref:r,className:Jt("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));en.displayName="TableCell";const oot=xe.forwardRef(({className:e,...t},r)=>o.jsx("caption",{ref:r,className:Jt("mt-4 text-sm text-muted-foreground",e),...t}));oot.displayName="TableCaption";const iot={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},ooe={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},Z2=({icon:e,title:t,value:r,color:n,onClick:a,isActive:i})=>{const s=e;return o.jsxs(fr.div,{variants:ooe,className:Jt("bg-surface rounded-lg border p-4 flex items-center gap-4 cursor-pointer transition-all duration-200",i?"border-brand ring-2 ring-brand/50":"border-border hover:border-brand/50"),onClick:a,children:[o.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:o.jsx(s,{className:`w-6 h-6 ${n}`})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function sot({open:e,onOpenChange:t,client:r,onEdit:n,onInactivate:a,codigoEmpresa:i}){const{toast:s}=ro(),l={scheduled:{bg:"bg-[#3B82F6]/10",text:"text-[#3B82F6]",border:"border-[#3B82F6]/30"},confirmed:{bg:"bg-[#22C55E]/10",text:"text-[#22C55E]",border:"border-[#22C55E]/30"},in_progress:{bg:"bg-[#FACC15]/10",text:"text-[#FACC15]",border:"border-[#FACC15]/30"},finished:{bg:"bg-[#6B7280]/10",text:"text-[#6B7280]",border:"border-[#6B7280]/30"},canceled:{bg:"bg-[#EF4444]/10",text:"text-[#EF4444]",border:"border-[#EF4444]/30"},absent:{bg:"bg-[#F97316]/10",text:"text-[#F97316]",border:"border-[#F97316]/30"}},c=({label:I,value:D})=>o.jsxs("div",{className:"grid grid-cols-12 items-start gap-3 py-2 border-b border-border/50",children:[o.jsx("div",{className:"col-span-5 sm:col-span-4",children:o.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-text-muted font-semibold",children:I})}),o.jsx("div",{className:"col-span-7 sm:col-span-8",children:o.jsx("span",{className:"block text-sm font-medium text-text-primary break-words",children:D})})]}),[d,u]=p.useState(!1),[f,m]=p.useState([]),[h,v]=p.useState(!1),[g,x]=p.useState([]),y=p.useRef(!1),b=p.useRef(!1),[w,j]=p.useState(!1),[_,S]=p.useState(null),[k,E]=p.useState(!1),[A,M]=p.useState(null),C=p.useMemo(()=>{try{const I=(f||[]).map(F=>({kind:"comanda",ts:new Date(F.aberto_em||F.created_at||0).getTime(),data:F})),D=(g||[]).map(F=>({kind:"agendamento",ts:new Date(F.inicio||0).getTime(),data:F}));return[...I,...D].sort((F,z)=>z.ts-F.ts).slice(0,10)}catch{return[]}},[f,g]),T=async I=>{try{if(j(!0),S(I?.kind||null),E(!0),M(null),I?.kind==="comanda"){const D=I?.data?.comanda_id;if(!D){E(!1);return}let F=pe.from("comanda_itens").select("id, quantidade, preco_unitario, desconto, produto:produtos!comanda_itens_produto_id_fkey ( nome )").eq("comanda_id",D);i&&(F=F.eq("codigo_empresa",i));const{data:z}=await F,q=(z||[]).map(G=>({id:G.id,quantidade:G.quantidade,preco_unitario:G.preco_unitario,desconto:G.desconto,produto_nome:G.produto?.[0]?.nome||G.produto?.nome||"Item"}));let $=pe.from("pagamentos").select("id, valor, status, recebido_em, metodo").eq("comanda_id",D);i&&($=$.eq("codigo_empresa",i));const{data:K}=await $,ce=K||[];let fe=pe.from("comanda_clientes").select("cliente:clientes!comanda_clientes_cliente_id_fkey ( id, nome, email, telefone )").eq("comanda_id",D);i&&(fe=fe.eq("codigo_empresa",i));const{data:B}=await fe,L=(B||[]).map(G=>G.cliente?.[0]||G.cliente).filter(Boolean),V=(q||[]).reduce((G,Q)=>G+(Number(Q.quantidade||0)*Number(Q.preco_unitario||0)-Number(Q.desconto||0)),0),re=(ce||[]).filter(G=>(G.status||"Pago")!=="Cancelado"&&(G.status||"Pago")!=="Estornado").reduce((G,Q)=>G+Number(Q.valor||0),0),me=Math.max(0,V-re);M({comandaId:D,mesa_title:I?.data?.mesa_title||"Balco",status:I?.data?.status||"open",itens:q||[],pagamentos:ce||[],clientes:L,totalItens:V,totalPagos:re,saldo:me,aberto_em:I?.data?.aberto_em||I?.data?.created_at||null,fechado_em:I?.data?.fechado_em||null})}else if(I?.kind==="agendamento"){const D=I?.data?.id;if(!D){E(!1);return}let F=[];try{const{data:$}=await pe.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento").eq("agendamento_id",D).limit(200);F=$||[]}catch{F=[]}const z=Array.from(new Set((F||[]).map($=>$.cliente_id).filter(Boolean)));let q=[];if(q=(F||[]).map($=>({id:$.cliente_id,nome:$.nome||null,email:null,telefone:null,codigo:null,valor_cota:$.valor_cota??null,status_pagamento:$.status_pagamento||null})),z.length>0)try{const{data:$}=await pe.from("clientes").select("id,nome,email,telefone,codigo").in("id",z),K=new Map(($||[]).map(ce=>[String(ce.id),ce]));q=q.map(ce=>{const fe=K.get(String(ce.id));return fe?{...ce,nome:ce.nome||fe.nome,email:fe.email,telefone:fe.telefone,codigo:fe.codigo}:ce})}catch{}M({id:D,inicio:I?.data?.inicio||null,fim:I?.data?.fim||null,status:I?.data?.status||null,modalidade:I?.data?.modalidade||null,quadra_nome:I?.data?.quadra_nome||null,participantes:q})}}catch{}finally{E(!1)}};return p.useEffect(()=>{let I=!1;if(e&&(y.current=!1,b.current=!1),e&&r?.id&&!i)return u(!1),v(!1),()=>{I=!0};const D=async()=>{if(!e||!r?.id)return;u(!0);const z=Number(r?.codigo??-1)===0;let q=pe.from("comanda_clientes").select("comanda_id, created_at");z?q=q.is("cliente_id",null):q=q.eq("cliente_id",r.id),q=q.order("created_at",{ascending:!1}).limit(50),i&&(q=q.eq("codigo_empresa",i));const{data:$,error:K}=await q;if(K)throw K;const ce=Array.from(new Set(($||[]).map(re=>re.comanda_id).filter(Boolean)));let fe=[];if(!z){let re=pe.from("comandas").select("id, status, aberto_em, fechado_em").eq("cliente_id",r.id).order("aberto_em",{ascending:!1}).limit(10);i&&(re=re.eq("codigo_empresa",i));const{data:me,error:G}=await re;if(G)throw G;fe=me||[]}const B=Array.from(new Set((fe||[]).map(re=>re.id))),L=Array.from(new Set([...ce,...B]));if(L.length===0){m([]),u(!1);return}let V;try{V=setTimeout(()=>u(!1),1e4)}catch{}try{let re=pe.from("comandas").select("id,status,aberto_em,fechado_em, mesa:mesas!comandas_mesa_id_fkey ( nome, numero )").in("id",L);i&&(re=re.eq("codigo_empresa",i));const{data:me,error:G}=await re;if(G)throw G;const Q=new Map((me||[]).map(vt=>[vt.id,vt]));let ae=pe.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",L);i&&(ae=ae.eq("codigo_empresa",i));const{data:J,error:je}=await ae;if(je)throw je;const be={};for(const vt of J||[]){const Sr=Number(vt.quantidade||0)*Number(vt.preco_unitario||0),se=Number(vt.desconto||0);be[vt.comanda_id]=(be[vt.comanda_id]||0)+Math.max(0,Sr-se)}let Ue=pe.from("pagamentos").select("comanda_id, valor, status, recebido_em, metodo").in("comanda_id",L);i&&(Ue=Ue.eq("codigo_empresa",i));const{data:Z,error:Y}=await Ue;if(Y)throw Y;const lt={};for(const vt of Z||[])(vt.status||"Pago")!=="Cancelado"&&(vt.status||"Pago")!=="Estornado"&&(lt[vt.comanda_id]=(lt[vt.comanda_id]||0)+Number(vt.valor||0));const gt=(vt,Sr=null)=>{const se=Q.get(vt)||{},Ze=Number(be[vt]||0),ct=Number(lt[vt]||0),Qt=Math.max(0,Ze-ct),we=se.mesa?.[0]?.nome||se.mesa?.nome||null,ye=se.mesa?.[0]?.numero||se.mesa?.numero||null,te=we||(ye!=null?`Mesa ${ye}`:"Balco");return{comanda_id:vt,created_at:Sr,aberto_em:se.aberto_em||null,fechado_em:se.fechado_em||null,status:se.status||"open",total:Ze,pago:ct,saldo:Qt,mesa_title:te}},Te=($||[]).map(vt=>gt(vt.comanda_id,vt.created_at)),at=(fe||[]).filter(vt=>!(ce||[]).includes(vt.id)).map(vt=>gt(vt.id,vt.aberto_em)),yt=[...Te,...at].sort((vt,Sr)=>{const se=new Date(vt.aberto_em||vt.created_at||0).getTime();return new Date(Sr.aberto_em||Sr.created_at||0).getTime()-se}).slice(0,10);if(!I&&yt.length===0&&!y.current){y.current=!0,console.debug("[ClientDetailsModal] loadHistory: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&D()},700);return}I||m(yt)}catch(re){s({title:"Falha ao carregar histrico do cliente",description:re?.message||"Tente novamente",variant:"destructive"})}finally{try{clearTimeout(V)}catch{}I||u(!1)}},F=async()=>{if(!e||!r?.id)return;v(!0);let z;try{z=setTimeout(()=>v(!1),1e4)}catch{}try{console.debug("[ClientDetailsModal] loadBookings: start",{clientId:r.id,codigoEmpresa:i});let q=pe.from("agendamentos").select(`
            id, inicio, fim, status, modalidade,
            quadra:quadra_id ( nome )
          `).eq("cliente_id",r.id).order("inicio",{ascending:!1}).limit(10);i&&(q=q.eq("codigo_empresa",i));const{data:$,error:K}=await q;if(K)throw K;const ce=($||[]).map(ae=>({id:ae.id,inicio:ae.inicio,fim:ae.fim,status:ae.status,modalidade:ae.modalidade,quadra_nome:ae.quadra?.[0]?.nome||ae.quadra?.nome||null}));let fe=pe.from("v_agendamento_participantes").select("agendamento_id").eq("cliente_id",r.id).limit(30);const{data:B,error:L}=await fe;if(L)throw L;const V=Array.from(new Set((B||[]).map(ae=>ae.agendamento_id).filter(Boolean))),re=new Set((ce||[]).map(ae=>ae.id)),me=V.filter(ae=>!re.has(ae));let G=[];if(me.length>0){let ae=pe.from("agendamentos").select(`
              id, inicio, fim, status, modalidade,
              quadra:quadra_id ( nome )
            `).in("id",me);i&&(ae=ae.eq("codigo_empresa",i));const{data:J,error:je}=await ae;if(je)throw je;G=(J||[]).map(be=>({id:be.id,inicio:be.inicio,fim:be.fim,status:be.status,modalidade:be.modalidade,quadra_nome:be.quadra?.[0]?.nome||be.quadra?.nome||null}))}const Q=[...ce,...G].sort((ae,J)=>new Date(J.inicio)-new Date(ae.inicio)).slice(0,10);if(!I&&Q.length===0&&!b.current){b.current=!0,console.debug("[ClientDetailsModal] loadBookings: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&F()},700);return}I||x(Q)}catch(q){console.warn("[ClientDetailsModal] Falha ao carregar agendamentos do cliente:",q)}finally{try{clearTimeout(z)}catch{}I||v(!1)}};return D(),F(),()=>{I=!0,e||(u(!1),v(!1))}},[e,r?.id,i]),r?o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(sn,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto w-full",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Detalhes do Cliente"}),o.jsx(_n,{children:"Informaes cadastrais e histrico recente deste cliente."})]}),o.jsxs("div",{className:"p-4 sm:p-6 space-y-6 sm:space-y-8",children:[o.jsx("div",{className:"overflow-hidden",children:o.jsx("div",{className:"flex items-start justify-between gap-4",children:o.jsxs("div",{className:"min-w-0",children:[o.jsx("h2",{className:"text-xl sm:text-2xl font-extrabold tracking-tight text-text-primary truncate",children:r.nome}),o.jsxs("div",{className:"mt-2 flex items-center flex-wrap gap-2",children:[o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",o.jsx("span",{className:"text-text-primary font-mono",children:r.codigo})]}),o.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold border ${r.status==="active"?"bg-emerald-500/10 text-emerald-400 border-emerald-400/30":"bg-rose-500/10 text-rose-400 border-rose-400/30"}`,children:r.status==="active"?"Ativo":"Inativo"}),r.flag_cliente&&o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),r.flag_fornecedor&&o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),o.jsx("span",{className:"mt-2 block text-sm text-text-secondary truncate",children:r.email||""})]})})}),o.jsx("div",{className:"grid grid-cols-1 gap-8",children:o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-text-secondary mb-2",children:"Informaes Cadastrais"}),o.jsxs("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg space-y-1",children:[o.jsx(c,{label:"Cdigo",value:r.codigo}),o.jsx(c,{label:"CPF/CNPJ",value:r.cpf||r.cnpj||""}),o.jsx(c,{label:"Telefone",value:r.telefone||""}),o.jsx(c,{label:"Aniversrio",value:r.aniversario?new Date(r.aniversario).toLocaleDateString("pt-BR"):""}),o.jsx(c,{label:"Email",value:r.email||""}),o.jsx(c,{label:"Status",value:r.status==="active"?"Ativo":"Inativo"})]})]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-primary",children:[o.jsx(aue,{className:"w-5 h-5 text-text-secondary"}),o.jsx("h4",{className:"font-semibold",children:"Histrico Recente"})]}),o.jsx("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg",children:d&&h?o.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Carregando histrico..."}):C&&C.length>0?o.jsx("div",{className:"max-h-64 overflow-y-auto thin-scroll pr-1",children:o.jsx("div",{className:"space-y-3",children:C.map((I,D)=>o.jsxs("div",{className:"group flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3 p-3 rounded-md border border-border/60 bg-background cursor-pointer transition-colors transition-shadow hover:bg-surface-2/60 hover:shadow-md hover:border-brand/30",title:"Clique para ver detalhes",onClick:()=>T(I),children:[o.jsx("div",{className:"min-w-0",children:I.kind==="comanda"?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:I.data.mesa_title||"Balco"}),o.jsx("div",{className:"text-xs text-text-secondary truncate",children:(()=>{const F=I.data;return F.aberto_em?new Date(F.aberto_em).toLocaleString("pt-BR"):new Date(F.created_at).toLocaleString("pt-BR")})()})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:I.data.modalidade||"Agendamento"}),o.jsxs("div",{className:"text-xs text-text-secondary truncate",children:[new Date(I.data.inicio).toLocaleString("pt-BR"),"  ",I.data.quadra_nome||"Quadra"]})]})}),o.jsx("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:I.kind==="comanda"?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:Jt("px-2 py-1 text-[11px] font-semibold rounded-full border",I.data.status==="closed"||I.data.fechado_em?"bg-success/10 text-success border-success/30":I.data.status==="awaiting-payment"?"bg-info/10 text-info border-info/30":"bg-warning/10 text-warning border-warning/30"),children:I.data.status==="closed"||I.data.fechado_em?"Fechada":I.data.status==="awaiting-payment"?"Pagamento":"Em uso"}),o.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:Jt("px-2 py-1 text-[11px] font-semibold rounded-full border",(()=>{const F=String(I.data.status||"").toLowerCase(),z=l[F]||l.scheduled;return`${z.bg} ${z.text} ${z.border}`})()),children:(()=>{switch(I.data.status){case"finished":return"Finalizado";case"canceled":return"Cancelado";case"in_progress":return"Em andamento";case"confirmed":return"Confirmado";case"absent":return"Ausente";case"scheduled":default:return"Agendado"}})()}),o.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]})})]},`${I.kind}-${D}`))})}):o.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Sem registros recentes para este cliente."})})]}),o.jsx(ln,{open:w,onOpenChange:j,children:o.jsxs(sn,{className:"sm:max-w-[700px] w-full max-h-[85vh] overflow-y-auto",children:[o.jsxs(an,{children:[o.jsx(nn,{children:_==="comanda"?A?.mesa_title||"Detalhes da Comanda":"Detalhes do Agendamento"}),o.jsx(_n,{children:_==="comanda"?"Itens e pagamentos desta comanda.":"Informaes do agendamento e participantes."}),o.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[o.jsx("span",{className:"text-xs text-text-secondary",children:"Cliente:"}),o.jsx("span",{className:"text-sm font-medium text-text-primary",children:r?.nome||""}),o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",o.jsx("span",{className:"text-text-primary font-mono",children:r?.codigo??""})]})]})]}),o.jsx("div",{className:"space-y-4",children:k?o.jsx("div",{className:"text-sm text-text-muted",children:"Carregando detalhes..."}):_==="comanda"&&A?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Status"}),o.jsx("p",{className:"font-semibold",children:(()=>{const I=String(A.status||"").toLowerCase();return I==="closed"||A.fechado_em?"Fechada":I==="awaiting-payment"?"Aguardando pagamento":"Aberta"})()})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Abertura"}),o.jsx("p",{className:"font-semibold",children:A.aberto_em?new Date(A.aberto_em).toLocaleString("pt-BR"):""})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Fechamento"}),o.jsx("p",{className:"font-semibold",children:A.fechado_em?new Date(A.fechado_em).toLocaleString("pt-BR"):""})]})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Itens"}),o.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(A.itens||[]).map(I=>o.jsxs("div",{className:"p-2 flex flex-col sm:grid sm:grid-cols-12 gap-1 sm:gap-2 text-sm",children:[o.jsx("div",{className:"sm:col-span-6 font-medium",children:I.produto_nome||"Item"}),o.jsxs("div",{className:"sm:col-span-2 sm:text-right text-text-muted",children:["Qtd: ",Number(I.quantidade||0)]}),o.jsxs("div",{className:"sm:col-span-2 sm:text-right",children:["R$ ",Number(I.preco_unitario||0).toFixed(2)]}),o.jsx("div",{className:"sm:col-span-2 sm:text-right text-text-secondary",children:Number(I.desconto||0)?`- R$ ${Number(I.desconto||0).toFixed(2)}`:""})]},I.id)),(!A.itens||A.itens.length===0)&&o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum item."})]})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Pagamentos"}),o.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(A.pagamentos||[]).map(I=>o.jsxs("div",{className:"p-2 flex items-center justify-between text-sm",children:[o.jsxs("span",{className:"truncate",children:[I.metodo||""," ",I.status?`(${I.status})`:""]}),o.jsxs("span",{className:"font-semibold",children:["R$ ",Number(I.valor||0).toFixed(2)]})]},I.id)),(!A.pagamentos||A.pagamentos.length===0)&&o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum pagamento registrado."})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Total de Itens"}),o.jsxs("p",{className:"font-bold",children:["R$ ",Number(A.totalItens||0).toFixed(2)]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Total Pago"}),o.jsxs("p",{className:"font-bold text-success",children:["R$ ",Number(A.totalPagos||0).toFixed(2)]})]})]})]}):_==="agendamento"&&A?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Modalidade"}),o.jsx("p",{className:"font-semibold",children:A.modalidade||""})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Quadra"}),o.jsx("p",{className:"font-semibold",children:A.quadra_nome||""})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Incio"}),o.jsx("p",{className:"font-semibold",children:A.inicio?new Date(A.inicio).toLocaleString("pt-BR"):""})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Fim"}),o.jsx("p",{className:"font-semibold",children:A.fim?new Date(A.fim).toLocaleString("pt-BR"):""})]})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Participantes"}),o.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(A.participantes||[]).map((I,D)=>o.jsxs("div",{className:"p-2 text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3",children:[o.jsx("div",{className:"min-w-0",children:o.jsxs("div",{className:"flex items-center gap-2",children:[I.codigo!==null&&I.codigo!==void 0&&o.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${String(I.status_pagamento||"").toLowerCase()==="pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",I.codigo]}),o.jsx("span",{className:"font-medium truncate",children:I.nome||"Participante"})]})}),o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:[I.valor_cota!=null&&o.jsxs("span",{className:"text-xs font-semibold text-text-secondary",children:["R$ ",Number(I.valor_cota||0).toFixed(2)]}),o.jsx("span",{className:`text-[11px] font-semibold rounded-full px-2 py-0.5 border ${String(I.status_pagamento||"").toLowerCase()==="pago"?"bg-success/10 text-success border-success/30":"bg-warning/10 text-warning border-warning/30"}`,children:String(I.status_pagamento||I.status_pagamento_text||"Pendente")})]})]},`${I.id}-${D}`)),(!A.participantes||A.participantes.length===0)&&o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum participante encontrado."})]})]})]}):o.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma informao para exibir."})}),o.jsx(Un,{children:o.jsx(le,{variant:"outline",onClick:()=>j(!1),children:"Fechar"})})]})})]}),o.jsxs(Un,{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-0 sm:justify-between",children:[!r?.is_consumidor_final&&o.jsx("div",{className:"w-full sm:flex-1",children:o.jsxs(le,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white w-full sm:w-auto",onClick:()=>a?.(r),children:[o.jsx(bH,{className:"mr-2 h-4 w-4"})," Inativar Cliente"]})}),o.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[o.jsx(Xm,{asChild:!0,children:o.jsx(le,{type:"button",variant:"secondary",className:"flex-1 sm:flex-none",children:"Fechar"})}),!r?.is_consumidor_final&&o.jsxs(le,{onClick:()=>n(r),className:"flex-1 sm:flex-none",children:[o.jsx(ll,{className:"mr-2 h-4 w-4"})," Editar Cliente"]})]})]})]})}):null}function lot(){const{toast:e}=ro(),{userProfile:t,authReady:r}=Do(),n=ki(),[a,i]=p.useState(()=>{try{const L=localStorage.getItem("auth:userProfile"),V=L&&JSON.parse(L)?.codigo_empresa||null,re=V?`clientes:list:${V}`:"clientes:list",me=JSON.parse(localStorage.getItem(re)||"[]");return Array.isArray(me)?me:[]}catch{return[]}}),[s,l]=p.useState(!1),[c,d]=p.useState(!0),[u,f]=p.useState(!1),[m,h]=p.useState(!1),[v,g]=p.useState(null),[x,y]=p.useState(null),[b,w]=p.useState({searchTerm:"",status:"all",tipo:"todos"}),j=p.useRef(!1),_=p.useRef(0),S=p.useRef(0),k=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!u&&!k.current&&(k.current=!0,f(!0),window.history.replaceState({},document.title))},[n.state?.openModal,u]);const E=async()=>{try{const L=a&&a.length>0;if(L||l(!0),!t?.codigo_empresa)return;const V=`clientes:list:${t.codigo_empresa}`;let re=pe.from("clientes").select("*, is_consumidor_final").eq("codigo_empresa",t.codigo_empresa).order("codigo",{ascending:!0});if(b.searchTerm.trim()!==""){const J=b.searchTerm.trim();/^\d+$/.test(J)?re=re.or(`codigo.eq.${J},nome.ilike.%${J}%,email.ilike.%${J}%,telefone.ilike.%${J}%`):re=re.or(`nome.ilike.%${J}%,email.ilike.%${J}%,telefone.ilike.%${J}%`)}b.status!=="all"&&(re=re.eq("status",b.status));const me=setTimeout(()=>{try{if(!L){const J=JSON.parse(localStorage.getItem(V)||"[]");Array.isArray(J)&&J.length>0&&(console.warn("[Clientes] slow fallback: using cached snapshot"),i(J),S.current=J.length)}}catch{}},2e3),{data:G,error:Q}=await re;if(Q){if(!j.current){j.current=!0,setTimeout(E,900);return}throw Q}const ae=G||[];if(ae.length===0&&L&&!j.current){j.current=!0,setTimeout(E,700);return}j.current=!1,i(ae);try{localStorage.setItem(V,JSON.stringify(ae))}catch{}S.current=ae.length,_.current=Date.now()}catch(L){e({title:"Erro ao carregar clientes",description:L.message,variant:"destructive"})}finally{l(!1);try{clearTimeout(slowFallback)}catch{}}};p.useEffect(()=>{try{const L=localStorage.getItem("auth:userProfile"),V=t?.codigo_empresa||L&&JSON.parse(L)?.codigo_empresa||null;if(V){const re=`clientes:list:${V}`,me=JSON.parse(localStorage.getItem(re)||"[]");Array.isArray(me)&&me.length&&a.length===0&&(i(me),S.current=me.length)}}catch{}if(r&&t?.codigo_empresa){const L=setTimeout(E,50);return()=>clearTimeout(L)}return()=>{}},[r,t?.codigo_empresa]),p.useEffect(()=>{if(r&&t?.codigo_empresa){const L=setTimeout(E,200);return()=>clearTimeout(L)}return()=>{}},[b.searchTerm,b.status,r,t?.codigo_empresa]),p.useEffect(()=>{const L=()=>{(Date.now()-(_.current||0)>3e4||S.current===0)&&r&&t?.codigo_empresa&&E()},V=()=>{document.visibilityState==="visible"&&(Date.now()-(_.current||0)>3e4||S.current===0)&&r&&t?.codigo_empresa&&E()};return window.addEventListener("focus",L),document.addEventListener("visibilitychange",V),()=>{window.removeEventListener("focus",L),document.removeEventListener("visibilitychange",V)}},[r,t?.codigo_empresa]);const A=p.useMemo(()=>{const V=new Date().getMonth();return{total:a.length,birthdays:a.filter(re=>re.aniversario&&new Date(re.aniversario).getMonth()===V).length,active:a.filter(re=>re.status==="active").length}},[a]);function M(L){const V=["Cdigo","Tipo Pessoa","Nome/Razo Social","Apelido/Nome Fantasia","CPF","CNPJ","RG","IE","Email","Telefone","Fone 2","Celular 1","Celular 2","WhatsApp","CEP","Endereo","Nmero","Complemento","Bairro","Cidade","UF","Cidade IBGE","Limite Crdito","Tipo Recebimento","Regime Tributrio","Tipo Contribuinte","Aniversrio","Sexo","Estado Civil","Nome da Me","Nome do Pai","Observaes"," Cliente"," Fornecedor"," Funcionrio"," Administradora"," Parceiro","CCF/SPC","Status"],re=";",me=Z=>{if(!Z)return"";try{const Y=new Date(Z);if(!isNaN(Y)){const lt=String(Y.getDate()).padStart(2,"0"),gt=String(Y.getMonth()+1).padStart(2,"0"),Te=Y.getFullYear();return`${lt}/${gt}/${Te}`}}catch{}return String(Z)},G=Z=>{const Y=Number(Z??0);return Number.isFinite(Y)?Y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},Q=Z=>Z?"Sim":"No",ae=Z=>{const Y=Z==null?"":String(Z);return/[";\n]/.test(Y)?`"${Y.replace(/"/g,'""')}"`:Y},J=[];J.push("\uFEFF"+V.join(re));for(const Z of L){const Y=[Z.codigo??"",Z.tipo_pessoa||"",Z.nome||"",Z.apelido||"",Z.cpf||"",Z.cnpj||"",Z.rg||"",Z.ie||"",Z.email||"",Z.telefone||"",Z.fone2||"",Z.celular1||"",Z.celular2||"",Z.whatsapp||"",Z.cep||"",Z.endereco||"",Z.numero||"",Z.complemento||"",Z.bairro||"",Z.cidade||"",Z.uf||"",Z.cidade_ibge||"",G(Z.limite_credito),Z.tipo_recebimento||"",Z.regime_tributario||"",Z.tipo_contribuinte||"",me(Z.aniversario),Z.sexo||"",Z.estado_civil||"",Z.nome_mae||"",Z.nome_pai||"",Z.observacoes||"",Q(!!Z.flag_cliente),Q(!!Z.flag_fornecedor),Q(!!Z.flag_funcionario),Q(!!Z.flag_administradora),Q(!!Z.flag_parceiro),Q(!!Z.flag_ccf_spc),Z.status==="active"?"Ativo":"Inativo"].map(ae).join(re);J.push(Y)}const je=new Blob([J.join(`
`)],{type:"text/csv;charset=utf-8;"}),be=URL.createObjectURL(je),Ue=document.createElement("a");Ue.href=be,Ue.download="clientes.csv",document.body.appendChild(Ue),Ue.click(),document.body.removeChild(Ue),URL.revokeObjectURL(be)}const C=()=>{try{M(T),e({title:"Exportao concluda",description:`${T.length} cliente(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(L){e({title:"Falha ao exportar",description:L?.message||"No foi possvel gerar o arquivo.",variant:"destructive"})}},T=p.useMemo(()=>(new Date().getMonth(),a.filter(V=>{const re=b.searchTerm.toLowerCase()===""||(V.nome||"").toLowerCase().includes(b.searchTerm.toLowerCase())||(V.cpf||"").includes(b.searchTerm)||(V.telefone||"").includes(b.searchTerm),me=b.status==="all"||V.status===b.status;let G=!0;return b.tipo==="clientes"?G=V.flag_cliente===!0:b.tipo==="fornecedores"?G=V.flag_fornecedor===!0:b.tipo==="ambos"&&(G=V.flag_cliente===!0&&V.flag_fornecedor===!0),re&&me&&G})),[a,b]),[I,D]=p.useState({by:"codigo",dir:"asc"}),F=L=>{D(V=>V.by===L&&V.dir==="asc"?{by:L,dir:"desc"}:{by:L,dir:"asc"})},z=p.useMemo(()=>{const L=T.find(Q=>Q?.is_consumidor_final===!0),re=[...T.filter(Q=>Q?.is_consumidor_final!==!0)],me=I.dir==="asc"?1:-1,G=(Q,ae)=>Number.isFinite(Q)?Q:ae;return re.sort((Q,ae)=>{if(I.by==="codigo"){const J=G(parseInt(String(Q.codigo||"").trim(),10),1/0),je=G(parseInt(String(ae.codigo||"").trim(),10),1/0);return J===je?0:J>je?me:-me}if(I.by==="nome"){const J=(Q.nome||"").toString(),je=(ae.nome||"").toString();return J.localeCompare(je,"pt-BR",{sensitivity:"base"})*me}return 0}),L?[L,...re]:re},[T,I]),q=L=>{g(L),h(!0)},$=()=>{y(null),f(!0)},K=L=>{h(!1),y(L),f(!0)},ce=async L=>{try{const{error:V}=await pe.from("clientes").update({status:"inactive"}).eq("id",L.id);if(V)throw V;h(!1),e({title:"Cliente inativado",description:`${L.nome} foi marcado como inativo.`}),E()}catch(V){e({title:"Erro ao inativar cliente",description:V.message,variant:"destructive"})}},fe=()=>{w({searchTerm:"",status:"all",tipo:"todos"})},B=b.searchTerm!==""||b.status!=="all"||b.tipo!=="todos";return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-full flex flex-col",children:o.jsxs(fr.div,{variants:iot,initial:"hidden",animate:"visible",children:[o.jsxs(fr.div,{variants:ooe,className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Clientes & Fornecedores"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa de clientes e fornecedores"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[o.jsx(le,{variant:"outline",size:"icon",onClick:()=>d(L=>!L),title:c?"Ocultar resumo":"Mostrar resumo","aria-label":c?"Ocultar resumo":"Mostrar resumo",className:"flex-shrink-0",children:c?o.jsx(Pp,{className:"h-4 w-4"}):o.jsx(Vp,{className:"h-4 w-4"})}),o.jsxs(le,{variant:"outline",onClick:C,className:"text-sm",children:[o.jsx(ei,{className:"mr-2 h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Exportar"}),o.jsx("span",{className:"sm:hidden",children:"CSV"})]}),o.jsxs(le,{onClick:$,className:"text-sm",children:[o.jsx(Ga,{className:"mr-2 h-4 w-4"})," ",o.jsx("span",{className:"hidden xs:inline",children:"Novo"}),o.jsx("span",{className:"xs:hidden",children:"Novo"})]})]})]}),c&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[o.jsx(Z2,{icon:cl,title:"Total de Clientes",value:a.filter(L=>L.flag_cliente).length,color:"text-brand",onClick:()=>w(L=>({...L,tipo:"clientes"})),isActive:b.tipo==="clientes"}),o.jsx(Z2,{icon:cl,title:"Total de Fornecedores",value:a.filter(L=>L.flag_fornecedor).length,color:"text-purple-500",onClick:()=>w(L=>({...L,tipo:"fornecedores"})),isActive:b.tipo==="fornecedores"}),o.jsx(Z2,{icon:tue,title:"Aniversariantes do Ms",value:A.birthdays,color:"text-info",onClick:()=>w(L=>({...L,tipo:"todos"})),isActive:b.tipo==="todos"}),o.jsx(Z2,{icon:Wp,title:"Ativos",value:A.active,color:"text-success",onClick:()=>w(L=>({...L,status:"active"})),isActive:b.status==="active"})]}),o.jsx(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsxs("div",{className:"p-4 border-b border-border flex flex-col gap-4",children:[o.jsxs("div",{className:"relative w-full",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar por nome, CPF ou telefone...",className:"pl-9",value:b.searchTerm,onChange:L=>w(V=>({...V,searchTerm:L.target.value}))})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[o.jsxs(En,{value:b.tipo,onValueChange:L=>w(V=>({...V,tipo:L})),children:[o.jsx(Sn,{className:"w-full sm:w-[200px]",children:o.jsx(kn,{placeholder:"Tipo"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"todos",children:"Todos"}),o.jsx(Nt,{value:"clientes",children:"Apenas Clientes"}),o.jsx(Nt,{value:"fornecedores",children:"Apenas Fornecedores"}),o.jsx(Nt,{value:"ambos",children:"Clientes e Fornecedores"})]})]}),o.jsxs(En,{value:b.status,onValueChange:L=>w(V=>({...V,status:L})),children:[o.jsx(Sn,{className:"w-full sm:w-[180px]",children:o.jsx(kn,{placeholder:"Status"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Todos os Status"}),o.jsx(Nt,{value:"active",children:"Ativos"}),o.jsx(Nt,{value:"inactive",children:"Inativos"})]})]}),B&&o.jsxs(le,{variant:"ghost",onClick:fe,className:"w-full sm:w-auto",children:[o.jsx(Oy,{className:"mr-2 h-4 w-4"}),"Limpar Filtros"]})]})]}),o.jsx("div",{className:"md:hidden space-y-3 p-4",children:s?o.jsx("div",{className:"text-center py-8 text-text-muted",children:"Carregando..."}):z.length>0?z.map(L=>{const V=L?.is_consumidor_final===!0;return o.jsxs("div",{className:Jt("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer transition-all",V?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-4 border-l-amber-500/40 border-t-border border-r-border border-b-border":"border-border hover:border-brand/50"),onClick:()=>q(L),children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsx("span",{className:Jt("font-mono text-sm font-semibold",V?"text-amber-300/90":"text-text-primary"),children:L.codigo}),o.jsx("span",{className:Jt("px-2 py-0.5 text-xs font-semibold rounded-full flex-shrink-0",L.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:L.status==="active"?"Ativo":"Inativo"})]}),o.jsxs("div",{children:[o.jsx("h3",{className:Jt("font-semibold text-base mb-1",V?"text-amber-100/90":"text-text-primary"),children:L.nome||""}),V&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium mb-1",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),o.jsx("p",{className:"text-sm text-text-muted",children:L.cpf&&`CPF: ${L.cpf}`||L.cnpj&&`CNPJ: ${L.cnpj}`||(L.apelido?`Apelido: ${L.apelido}`:" ")})]}),o.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[L.flag_cliente&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),L.flag_fornecedor&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),(L.telefone||L.email)&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Contato"}),o.jsx("span",{className:"text-sm font-medium",children:L.telefone||L.email})]}),o.jsx("div",{className:"text-xs text-text-muted text-center pt-2 border-t border-border/50",children:"Toque para ver detalhes"})]},L.id)}):o.jsx("div",{className:"text-center py-8 text-text-muted",children:"Nenhum cliente encontrado com os filtros aplicados."})}),o.jsx("div",{className:"hidden md:block",children:o.jsxs(el,{children:[o.jsx(tl,{className:"sticky top-0 bg-surface-2 z-10",children:o.jsxs(Fa,{className:"border-b border-border",children:[o.jsxs(yn,{className:"select-none cursor-pointer text-text-secondary",onClick:()=>F("codigo"),title:"Ordenar por cdigo",children:["Cdigo ",I.by==="codigo"?I.dir==="asc"?"":"":""]}),o.jsxs(yn,{className:"text-text-secondary select-none cursor-pointer",onClick:()=>F("nome"),title:"Ordenar por nome",children:["Cliente ",I.by==="nome"?I.dir==="asc"?"":"":""]}),o.jsx(yn,{className:"text-text-secondary",children:"Contato"}),o.jsx(yn,{className:"text-text-secondary",children:"Tipo"}),o.jsx(yn,{className:"text-text-secondary",children:"Status"})]})}),o.jsx(rl,{children:s?o.jsx(Fa,{children:o.jsx(en,{colSpan:5,className:"h-24 text-center",children:"Carregando..."})}):z.length>0?z.map(L=>{const V=L?.is_consumidor_final===!0;return o.jsxs(Fa,{className:Jt("cursor-pointer transition-all",V?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":"hover:bg-surface-2"),onClick:()=>q(L),children:[o.jsx(en,{className:Jt("font-mono text-base font-semibold",V?"text-amber-300/90":"text-text-primary"),children:L.codigo}),o.jsx(en,{children:o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:Jt("text-base font-semibold truncate",V?"text-amber-100/90":"text-text-primary"),children:L.nome||""}),V&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),o.jsx("span",{className:"text-xs text-text-muted truncate",children:L.cpf&&`CPF: ${L.cpf}`||L.cnpj&&`CNPJ: ${L.cnpj}`||(L.apelido?`Apelido: ${L.apelido}`:" ")})]})}),o.jsx(en,{children:o.jsx("div",{className:"flex flex-col",children:o.jsx("span",{className:"text-sm truncate",children:L.telefone||L.email||""})})}),o.jsx(en,{children:o.jsxs("div",{className:"flex flex-wrap gap-1",children:[L.flag_cliente&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),L.flag_fornecedor&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]})}),o.jsx(en,{children:o.jsx("span",{className:Jt("px-2 py-1 text-xs font-semibold rounded-full",L.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:L.status==="active"?"Ativo":"Inativo"})})]},L.id)}):o.jsx(Fa,{children:o.jsx(en,{colSpan:5,className:"h-24 text-center",children:"Nenhum cliente encontrado com os filtros aplicados."})})})]})})]})})]})}),o.jsx(hre,{open:u,onOpenChange:f,client:x,onSaved:E}),o.jsx(sot,{open:m,onOpenChange:h,client:v,onEdit:K,onInactivate:ce,codigoEmpresa:t?.codigo_empresa})]})}const cot=[],dot={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},ioe={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},_E=({icon:e,title:t,value:r,color:n})=>{const a=e;return o.jsxs(fr.div,{variants:ioe,className:"bg-surface rounded-lg border border-border p-4 flex items-center gap-4",children:[o.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:o.jsx(a,{className:`w-6 h-6 ${n}`})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function uot({open:e,onOpenChange:t,member:r,onEdit:n}){return r?o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(sn,{className:"sm:max-w-[500px] w-full",children:[o.jsx(an,{children:o.jsx(nn,{children:"Detalhes do Funcionrio"})}),o.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-xl font-bold",children:r.name}),o.jsx("p",{className:"text-brand font-semibold",children:r.role})]}),o.jsxs("div",{className:"bg-surface-2 p-8 rounded-lg text-center border border-border",children:[o.jsx("p",{className:"text-lg font-semibold text-text-secondary",children:" Em desenvolvimento"}),o.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Detalhes completos do funcionrio estaro disponveis em breve."})]})]}),o.jsxs(Un,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[o.jsx(Xm,{asChild:!0,children:o.jsx(le,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Fechar"})}),o.jsxs(le,{onClick:()=>n(r),className:"w-full sm:w-auto",children:[o.jsx(ll,{className:"mr-2 h-4 w-4"})," Editar"]})]})]})}):null}function fot({open:e,onOpenChange:t,member:r,onSave:n,loading:a}){const{toast:i}=ro(),[s,l]=p.useState(r?.name||""),[c,d]=p.useState(r?.role||"");p.useEffect(()=>{e&&(l(r?.name||""),d(r?.role||""))},[r,e]);const u=async f=>{if(f.preventDefault(),!s.trim()){i({title:"Nome  obrigatrio",variant:"destructive"});return}await n({name:s.trim(),role:c.trim()})};return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(sn,{className:"sm:max-w-[700px] w-full",children:[o.jsxs(an,{children:[o.jsx(nn,{children:r?"Editar Funcionrio":"Novo Funcionrio"}),o.jsx(_n,{children:"Informe apenas nome e cargo. O cargo  livre (texto)."})]}),o.jsx("form",{onSubmit:u,className:"py-2",children:o.jsx("div",{className:"bg-surface-2 border border-border rounded-lg p-4 space-y-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{htmlFor:"name",children:"Nome"}),o.jsxs("div",{className:"relative",children:[o.jsx(_u,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{id:"name",value:s,onChange:f=>l(f.target.value),className:"pl-9",placeholder:"Ex.: Maria Silva"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{htmlFor:"role",children:"Cargo"}),o.jsxs("div",{className:"relative",children:[o.jsx(iue,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{id:"role",value:c,onChange:f=>d(f.target.value),className:"pl-9",placeholder:"Ex.: Gerente, Caixa, ..."})]})]})]})})}),o.jsxs(Un,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[o.jsx(Xm,{asChild:!0,children:o.jsx(le,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),o.jsx(le,{type:"submit",onClick:u,disabled:!!a,className:"w-full sm:w-auto",children:a?"Salvando...":"Salvar"})]})]})})}function mot(){const{company:e,authReady:t,userProfile:r}=Do(),{toast:n}=ro(),[a,i]=p.useState(cot),[s,l]=p.useState(!1),[c,d]=p.useState(!1),[u,f]=p.useState(null),[m,h]=p.useState(null),[v,g]=p.useState(""),[x,y]=p.useState(!1),b=p.useRef(!1),w=p.useRef(!0);p.useEffect(()=>(w.current=!0,()=>{w.current=!1}),[]);const j=async()=>{try{const I=e?.codigo_empresa||null;if(!I&&!e?.id)return;const D=I?`team:list:${I}`:"team:list",F=setTimeout(()=>{if(w.current)try{const B=localStorage.getItem(D),L=B?JSON.parse(B):[];Array.isArray(L)&&L.length>0&&(console.warn("[Equipe] slow fallback: using cached snapshot"),i(L))}catch{}},5e3);let z=pe.from("colaboradores").select("*").order("nome",{ascending:!0});I&&(z=z.eq("codigo_empresa",I));const{data:q,error:$}=await z;if($){if(!b.current){b.current=!0,setTimeout(j,800);return}throw $}let ce=(q||[]).map(B=>({id:B.id,name:B.nome||"",role:B.cargo||"user",status:B.ativo===!1?"inactive":"active",online:!1,permissions:{}}));const fe=r?.codigo_empresa&&e?.codigo_empresa&&r.codigo_empresa===e.codigo_empresa;if(r?.id&&fe&&(ce.some(L=>L.id===r.id)||(ce=[{id:r.id,name:r.nome||"Voc",role:r.cargo||"user",status:"active",online:!1,permissions:{}},...ce])),!w.current)return;i(ce);try{localStorage.setItem(D,JSON.stringify(ce))}catch{}}catch(I){console.error("Falha ao carregar equipe:",I);const D=e?.codigo_empresa||null,F=D?`team:list:${D}`:"team:list";try{const z=localStorage.getItem(F);z&&w.current&&i(JSON.parse(z))}catch{}}finally{b.current=!1}};p.useEffect(()=>{const I=e?.codigo_empresa||null;if(!(!t||!I)){try{const D=localStorage.getItem(`team:list:${I}`),F=D?JSON.parse(D):[];Array.isArray(F)&&F.length>0&&i(F)}catch{}j()}},[t,e?.codigo_empresa]),p.useEffect(()=>{const I=()=>{document.visibilityState==="visible"&&t&&(e?.codigo_empresa||e?.id)&&j()},D=()=>{t&&(e?.codigo_empresa||e?.id)&&j()};return document.addEventListener("visibilitychange",I),window.addEventListener("focus",D),()=>{document.removeEventListener("visibilitychange",I),window.removeEventListener("focus",D)}},[t,e?.codigo_empresa,e?.id]);const _=p.useMemo(()=>({total:a.length,active:a.filter(I=>I.status==="active").length,inactive:a.filter(I=>I.status==="inactive").length}),[a]),S=p.useMemo(()=>a.filter(I=>I.name.toLowerCase().includes(v.toLowerCase())||I.role.toLowerCase().includes(v.toLowerCase())),[a,v]),k=I=>{f(I),d(!0)},E=()=>{h(null),l(!0)},A=I=>{d(!1),h(I),l(!0)},M=I=>{h(I),l(!0)},C=async({name:I,role:D})=>{try{if(y(!0),!e?.codigo_empresa&&!e?.id)throw new Error("Empresa no encontrada para o usurio atual.");let F=e?.codigo_empresa||null;if(!F&&e?.id){const{data:z}=await pe.from("empresas").select("codigo_empresa").eq("id",e.id).single();F=z?.codigo_empresa||null}if(!F)throw new Error("Empresa sem cdigo. Defina o cdigo da empresa antes de adicionar colaboradores.");if(m){const{error:z}=await pe.from("colaboradores").update({nome:I,cargo:D}).eq("id",m.id);if(z)throw z;n({title:"Funcionrio atualizado",description:m.name,variant:"default"})}else{const{error:z}=await pe.from("colaboradores").insert({codigo_empresa:F,nome:I,cargo:D,ativo:!0});if(z)throw z;n({title:"Funcionrio criado com sucesso",description:I,variant:"success"})}await j(),l(!1),h(null)}catch(F){n({title:"Erro ao salvar funcionrio",description:F.message||String(F),variant:"destructive"})}finally{y(!1)}},T=async I=>{try{if(!(e?.id||e?.codigo_empresa))return;const D=a[0]?.id;if(I.id===D){n({title:"Ao no permitida",description:"No  possvel desativar o primeiro funcionrio.",variant:"destructive"});return}if(r?.id&&I.id===r.id){n({title:"Ao no permitida",description:"Voc no pode desativar o seu prprio usurio.",variant:"destructive"});return}if(a.filter(z=>z.status==="active").length<=1){n({title:"Ao no permitida",description:"Deve haver pelo menos um funcionrio ativo.",variant:"destructive"});return}const{error:F}=await pe.from("colaboradores").update({ativo:!1}).eq("id",I.id);if(F)throw F;n({title:"Funcionrio desativado",description:I.name}),await j()}catch(D){n({title:"Erro ao desativar",description:D.message||String(D),variant:"destructive"})}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-full flex flex-col",children:o.jsxs(fr.div,{variants:dot,initial:"hidden",animate:"visible",children:[o.jsxs(fr.div,{variants:ioe,className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Gesto de Equipe"}),o.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"Controle de funcionrios, permisses e logs."})]}),o.jsxs(le,{onClick:E,disabled:!t||!e?.codigo_empresa,title:t?e?.codigo_empresa?"":"Empresa sem cdigo. Defina o cdigo da empresa antes.":"Aguardando autenticao...",children:[o.jsx(Ga,{className:"mr-2 h-4 w-4"})," Novo Funcionrio"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsx(_E,{icon:cl,title:"Total",value:_.total,color:"text-brand"}),o.jsx(_E,{icon:yue,title:"Ativos",value:_.active,color:"text-success"}),o.jsx(_E,{icon:pue,title:"Desativados",value:_.inactive,color:"text-danger"})]}),o.jsx(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-4 border-b border-border",children:o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar por nome ou cargo...",className:"pl-9",value:v,onChange:I=>g(I.target.value)})]})}),o.jsx("div",{className:"md:hidden p-4 space-y-3",children:S.length===0?o.jsx("div",{className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."}):S.map((I,D)=>o.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",onClick:()=>k(I),children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",children:I.name}),o.jsx("p",{className:"text-sm text-text-muted mt-0.5",children:I.role})]}),o.jsx("span",{className:Jt("inline-flex px-2 py-0.5 rounded-full text-xs font-semibold flex-shrink-0",I.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:I.status==="active"?"Ativo":"Inativo"})]}),o.jsxs("div",{className:"flex gap-2 pt-2",children:[o.jsx(le,{variant:"outline",size:"sm",onClick:F=>{F.stopPropagation(),k(I)},className:"flex-1",children:"Ver Detalhes"}),o.jsx(le,{variant:"outline",size:"sm",onClick:F=>{F.stopPropagation(),M(I)},children:o.jsx(ll,{className:"h-3 w-3"})}),o.jsxs(Ky,{children:[o.jsx(Yy,{asChild:!0,children:o.jsx(le,{variant:"outline",size:"sm",onClick:F=>F.stopPropagation(),children:o.jsx(s6,{className:"h-3 w-3"})})}),o.jsx(Wv,{align:"end",children:o.jsx(ol,{className:"text-danger",disabled:D===0||a.filter(F=>F.status==="active").length<=1||r?.id&&I.id===r.id,onClick:F=>{F.stopPropagation(),T(I)},children:"Desativar"})})]})]})]},I.id))}),o.jsx("div",{className:"hidden md:block",children:o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{children:"Funcionrio"}),o.jsx(yn,{children:"Cargo"}),o.jsx(yn,{children:"Status"}),o.jsx(yn,{className:"w-[80px] text-center",children:"Aes"})]})}),o.jsxs(rl,{children:[S.length===0&&o.jsx(Fa,{children:o.jsx(en,{colSpan:4,className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."})}),S.map((I,D)=>o.jsxs(Fa,{className:"cursor-pointer",onClick:()=>k(I),children:[o.jsx(en,{className:"font-medium",children:o.jsx("div",{className:"flex items-center gap-3",children:o.jsx("span",{children:I.name})})}),o.jsx(en,{children:I.role}),o.jsx(en,{children:o.jsx("span",{className:Jt("px-2 py-1 text-xs font-semibold rounded-full",I.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:I.status==="active"?"Ativo":"Inativo"})}),o.jsx(en,{className:"text-center",children:o.jsxs(Ky,{children:[o.jsx(Yy,{asChild:!0,children:o.jsx(le,{variant:"ghost",className:"h-8 w-8 p-0 mx-auto",onClick:F=>F.stopPropagation(),children:o.jsx(s6,{className:"h-4 w-4"})})}),o.jsxs(Wv,{align:"end",children:[o.jsx(ol,{onClick:F=>{F.stopPropagation(),k(I)},children:"Ver Detalhes"}),o.jsx(ol,{onClick:F=>{F.stopPropagation(),M(I)},children:"Editar"}),o.jsx(ol,{className:"text-danger",disabled:D===0||a.filter(F=>F.status==="active").length<=1||r?.id&&I.id===r.id,onClick:F=>{F.stopPropagation(),T(I)},children:"Desativar"})]})]})})]},I.id))]})]})})]})})]})}),o.jsx(fot,{open:s,onOpenChange:l,member:m,onSave:C,loading:x}),o.jsx(uot,{open:c,onOpenChange:d,member:u,onEdit:A})]})}const hot="v1.0.4";function dm({title:e,icon:t,children:r,className:n="",collapsible:a=!1,defaultOpen:i=!0}){return a?o.jsx("div",{className:`bg-surface rounded-lg border border-border shadow-sm ${n}`,children:o.jsxs("details",{className:"group",open:i,children:[o.jsxs("summary",{className:"list-none cursor-pointer select-none p-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[t&&o.jsx(t,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"text-base font-semibold",children:e})]}),o.jsx("span",{className:"text-xs text-text-secondary group-open:rotate-180 transition-transform",children:""})]}),o.jsx("div",{className:"px-4 pb-4",children:r})]})}):o.jsxs("div",{className:`bg-surface rounded-lg border border-border shadow-sm p-4 ${n}`,children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t&&o.jsx(t,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"text-base font-semibold",children:e})]}),r]})}function um({label:e,value:t}){return o.jsxs("div",{className:"flex items-center justify-between gap-3 py-1 text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:e}),o.jsx("span",{className:"font-medium truncate",children:t||""})]})}function pot(){const{userProfile:e,company:t,authReady:r,loading:n}=Do();ki();const[a,i]=p.useState("Agenda"),[s,l]=p.useState("Mdia"),[c,d]=p.useState(""),[u,f]=p.useState(""),[m,h]=p.useState(!0),[v,g]=p.useState(()=>window.__installPrompt||null),[x,y]=p.useState(!1),[b,w]=p.useState(!1),[j,_]=p.useState(!1),[S,k]=p.useState("unknown"),E="Fluxo7 Arena",A="fluxo7team@gmail.com",M="https://wa.me/5534998936088",C="tel:+5534998936088",T="+55 (34) 99893-6088";p.useEffect(()=>{try{const K=window.matchMedia("(pointer:fine)"),ce=()=>h(K.matches);return ce(),K.addEventListener?.("change",ce),()=>K.removeEventListener?.("change",ce)}catch{h(!0)}},[]),p.useEffect(()=>{const K=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;w(K);const ce=navigator.userAgent;ce.includes("Chrome")&&!ce.includes("Edg")?k("chrome"):ce.includes("Edg")?k("edge"):ce.includes("Firefox")?k("firefox"):ce.includes("Safari")&&!ce.includes("Chrome")?k("safari"):k("other"),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&y(!0),window.__installPrompt&&!v&&g(window.__installPrompt);const fe=()=>{y(!0),g(null),_(!1)};return window.addEventListener("appinstalled",fe),()=>{window.removeEventListener("appinstalled",fe)}},[v]);const I=async()=>{if(v)try{await v.prompt();const{outcome:K}=await v.userChoice;K==="accepted"?(y(!0),_(!1)):_(!0),g(null),window.__installPrompt=null}catch(K){console.error("Erro ao mostrar prompt de instalao:",K),_(!0)}else _(!0)},D=()=>{navigator.share?navigator.share({title:"F7 Arena",text:"Adicione F7 Arena  sua tela inicial",url:window.location.href}).catch(()=>{alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)}):alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)},F=p.useMemo(()=>{try{return{empresa:t?.nome||t?.fantasia||t?.razao_social||t?.razaoSocial||t?.displayName||t?.codigo_empresa||"",usuario:e?.nome||e?.name||e?.email||"",dataHora:new Date().toLocaleString("pt-BR")}}catch{return{empresa:"",usuario:"",dataHora:new Date().toLocaleString("pt-BR")}}},[t?.nome,t?.fantasia,t?.razao_social,t?.razaoSocial,t?.displayName,t?.codigo_empresa,e?.nome,e?.name,e?.email]),z=p.useMemo(()=>[`[${E} - Suporte]`,`Assunto: ${c||"(sem assunto)"} `,`Categoria: ${a} `,`Severidade: ${s}`,"","Descrio:",(u||"(adicione uma descrio detalhada, passos para reproduzir, prints se possvel)")+`
`," Dados ",`Empresa: ${F.empresa}`,`Usurio: ${F.usuario}`,`Data e Hora: ${F.dataHora}`].join(`
`),[c,a,s,u,F]),q=`${M}?text=${encodeURIComponent(z)}`,$=`mailto:${A}?subject=${encodeURIComponent(`[Suporte] ${c||"Assunto"}`)}&body=${encodeURIComponent(z)}`;return o.jsxs("div",{className:"px-4 md:px-6 lg:px-8 py-4 md:py-6",children:[o.jsxs("div",{className:"bg-surface rounded-xl border border-border p-5 md:p-6 mb-6",children:[o.jsxs("div",{className:"flex items-start md:items-center justify-between gap-4 flex-col md:flex-row",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand/10 border border-brand/30 flex items-center justify-center",children:o.jsx(pH,{className:"w-5 h-5 text-brand"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"Suporte"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Precisa de ajuda? Fale com a gente ou consulte as respostas rpidas abaixo."})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center",children:o.jsx(nd,{className:"w-6 h-6 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-base md:text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),o.jsxs("div",{className:"text-xs text-text-secondary mt-1",children:["Verso ",hot]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[o.jsx(dm,{title:"Status",icon:o2,children:o.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[o.jsx(um,{label:"Empresa",value:F.empresa}),o.jsx(um,{label:"Usurio",value:`${F.usuario}`})]})}),o.jsx(dm,{title:"Fale com a gente",icon:bP,children:o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("a",{href:M,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[o.jsx(bP,{className:"w-4 h-4"})," WhatsApp"]}),o.jsxs("a",{href:`mailto:${A}`,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[o.jsx(lx,{className:"w-4 h-4"})," E-mail"]}),o.jsxs("a",{href:C,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[o.jsx(Cb,{className:"w-4 h-4"})," ",m?T:"Telefone"]})]})}),!x&&b&&o.jsx(dm,{title:"Adicionar  Tela Inicial",icon:wP,children:o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Crie um atalho do F7 Arena na sua tela inicial para acesso rpido."}),o.jsxs("button",{onClick:D,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[o.jsx(c6,{className:"w-4 h-4"})," Criar Atalho"]}),o.jsxs("details",{className:"text-xs text-text-muted",children:[o.jsx("summary",{className:"cursor-pointer hover:text-text-secondary",children:"Como fazer manualmente?"}),o.jsxs("div",{className:"mt-2 space-y-1 pl-2",children:[o.jsxs("p",{children:["1. Toque no boto ",o.jsx(c6,{className:"inline w-3 h-3"})," (Compartilhar)"]}),o.jsx("p",{children:'2. Role para baixo e toque em "Adicionar  Tela de Incio"'}),o.jsx("p",{children:'3. Toque em "Adicionar"'})]})]})]})}),!x&&!b&&o.jsx(dm,{title:"Instalar Aplicativo",icon:wP,children:o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Instale o F7 Arena no seu dispositivo para acesso rpido e experincia completa de aplicativo."}),o.jsxs("button",{onClick:I,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[o.jsx(ei,{className:"w-4 h-4"})," Instalar App"]}),o.jsx("p",{className:"text-xs text-text-muted text-center",children:"Pode demorar alguns segundos. Se no aparecer nada, veja as instrues no tutorial."})]})}),x&&o.jsx(dm,{title:"Aplicativo Instalado",icon:o2,children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-success",children:[o.jsx(o2,{className:"w-4 h-4"}),o.jsx("span",{children:"F7 Arena est instalado no seu dispositivo!"})]})})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsx("div",{className:"lg:col-span-2 space-y-3",children:o.jsx(dm,{title:"Perguntas Frequentes (FAQ)",children:o.jsxs("div",{className:"divide-y divide-border/60",children:[o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como abrir comanda de balco?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o caixa antes. A tela de balco utiliza uma comanda sem mesa (mesa_id nulo). Se no existir, o sistema cria ao abrir o balco; caso o caixa esteja fechado, a abertura da comanda  bloqueada."})]}),o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Por que no consigo fechar o caixa?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"O fechamento  bloqueado se houver comandas com itens em aberto (inclui balco e mesas). Finalize ou feche as comandas pendentes antes de encerrar o caixa."})]}),o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como adicionar participantes no agendamento?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"No modal de agendamento, selecione um ou mais clientes. Aps salvar, o chip de pagamentos  atualizado imediatamente. Se no visualizar, recarregue os dados da agenda."})]}),o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ver o histrico completo do cliente?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o cliente e utilize o Histrico Recente, que combina comandas e agendamentos em uma nica timeline com totais e status."})]}),o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ajustar estoque mnimo e ver mais vendidos?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Na aba de Produtos voc pode gerenciar estoque, preos e relatrios. Utilize filtros e exportaes para anlise."})]})]})})}),o.jsx("div",{className:"lg:col-span-1",children:o.jsxs("div",{className:"space-y-3 lg:sticky lg:top-6",children:[o.jsx(dm,{title:"Reportar um problema",icon:Hde,collapsible:!0,defaultOpen:!1,children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary",children:"Categoria"}),o.jsxs("select",{value:a,onChange:K=>i(K.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[o.jsx("option",{children:"Agenda"}),o.jsx("option",{children:"Vendas"}),o.jsx("option",{children:"Clientes"}),o.jsx("option",{children:"Produtos"}),o.jsx("option",{children:"Financeiro"}),o.jsx("option",{children:"Outros"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary",children:"Severidade"}),o.jsxs("select",{value:s,onChange:K=>l(K.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[o.jsx("option",{children:"Baixa"}),o.jsx("option",{children:"Mdia"}),o.jsx("option",{children:"Alta"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary",children:"Assunto"}),o.jsx("input",{value:c,onChange:K=>d(K.target.value),placeholder:"Ex.: Erro ao salvar agendamento",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary",children:"Descrio"}),o.jsx("textarea",{value:u,onChange:K=>f(K.target.value),rows:4,placeholder:"Descreva o que aconteceu, passos para reproduzir, expectativa.",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border resize-y"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 pt-1",children:[o.jsxs("a",{href:q,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[o.jsx(bP,{className:"w-4 h-4"})," Enviar no WhatsApp"]}),o.jsxs("a",{href:$,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[o.jsx(lx,{className:"w-4 h-4"})," Enviar por E-mail"]}),o.jsxs("a",{href:C,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[o.jsx(Cb,{className:"w-4 h-4"})," ",m?T:"Ligar agora"]})]})]})}),o.jsx(dm,{title:"Diagnstico",icon:Jde,children:o.jsxs("div",{className:"space-y-1 text-sm",children:[o.jsx(um,{label:"Empresa",value:F.empresa}),o.jsx(um,{label:"Usurio",value:`${F.usuario}`}),o.jsx(um,{label:"Data/Hora",value:F.dataHora}),o.jsx(um,{label:"Canal - WhatsApp",value:"(34) 99893-6088"}),o.jsx(um,{label:"Canal - E-mail",value:"fluxo7team@gmail.com"}),o.jsx(um,{label:"Canal - Telefone",value:"(34) 99893-6088"})]})})]})})]}),o.jsx(ln,{open:j,onOpenChange:_,children:o.jsxs(sn,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[o.jsx(an,{children:o.jsxs(nn,{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-12 h-12 rounded-xl bg-brand/10 border border-brand/30 flex items-center justify-center",children:o.jsx(ei,{className:"w-6 h-6 text-brand"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold",children:"Como Instalar o F7 Arena"}),o.jsx("p",{className:"text-sm text-text-secondary font-normal",children:"Siga as instrues para o seu navegador"})]})]})}),o.jsxs("div",{className:"mt-6 space-y-6",children:[(S==="chrome"||S==="edge")&&o.jsxs("div",{className:"bg-gradient-to-br from-brand/10 to-brand/5 rounded-xl p-6 border-2 border-brand/30",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand flex items-center justify-center",children:o.jsx(Yde,{className:"w-6 h-6 text-black"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold",children:"Chrome (Celular)"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"1"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",o.jsx("span",{className:"text-2xl",children:""})]}),o.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"No canto superior direito da tela"}),o.jsx("div",{className:"bg-background/50 rounded-md p-3 border border-border/50",children:o.jsx("p",{className:"text-xs text-text-muted",children:" Os 3 pontinhos ficam ao lado da barra de endereo"})})]})]})}),o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"2"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),o.jsxs("div",{className:"space-y-2 mb-3",children:[o.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:o.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar aplicativo"'})}),o.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[o.jsx("div",{className:"h-px bg-border flex-1"}),o.jsx("span",{children:"OU"}),o.jsx("div",{className:"h-px bg-border flex-1"})]}),o.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:o.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Toque em qualquer uma dessas opes no menu"})]})]})}),o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"3"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-semibold mb-2",children:"Confirme a instalao"}),o.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Aparecer uma janela perguntando se deseja instalar"}),o.jsx("div",{className:"bg-success/10 rounded-md p-3 border border-success/30",children:o.jsx("p",{className:"text-sm font-medium text-center",children:' Toque em "Instalar"'})})]})]})}),o.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[o.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),o.jsx("p",{className:"text-xs text-text-secondary",children:"O app aparecer na sua tela inicial e voc poder abri-lo como qualquer outro aplicativo!"})]})]})]}),S==="firefox"&&o.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-orange-500/5 rounded-xl p-6 border-2 border-orange-500/30",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500 flex items-center justify-center",children:o.jsx(mue,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold",children:"Firefox (Celular)"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"1"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",o.jsx("span",{className:"text-2xl",children:""})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"No canto inferior direito da tela"})]})]})}),o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"2"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:o.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar"'})}),o.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[o.jsx("div",{className:"h-px bg-border flex-1"}),o.jsx("span",{children:"OU"}),o.jsx("div",{className:"h-px bg-border flex-1"})]}),o.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:o.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]})]})]})}),o.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[o.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),o.jsx("p",{className:"text-xs text-text-secondary",children:"O app ser adicionado  sua tela inicial!"})]})]})]}),(S==="safari"||S==="other")&&o.jsxs("div",{className:"bg-gradient-to-br from-purple-500/10 to-purple-500/5 rounded-xl p-6 border-2 border-purple-500/30",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500 flex items-center justify-center",children:o.jsx(wP,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold",children:"Outros Navegadores"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Instrues gerais"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[o.jsx("p",{className:"font-semibold mb-3",children:"Procure no menu do navegador:"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:o.jsx("p",{className:"font-medium",children:' "Instalar aplicativo"'})}),o.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:o.jsx("p",{className:"font-medium",children:' "Adicionar  tela inicial"'})}),o.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:o.jsx("p",{className:"font-medium",children:' "Criar atalho"'})})]})]}),o.jsx("div",{className:"bg-background/50 rounded-lg p-4 border border-border/50",children:o.jsx("p",{className:"text-sm text-text-muted",children:" Geralmente a opo est no menu de 3 pontos ou 3 linhas do navegador"})})]})]}),o.jsxs("div",{className:"bg-brand/5 rounded-lg p-4 border border-brand/20",children:[o.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[o.jsx(o2,{className:"w-5 h-5 text-brand"}),"Benefcios do App Instalado"]}),o.jsxs("ul",{className:"space-y-1.5 text-sm text-text-secondary",children:[o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Acesso rpido direto da rea de trabalho ou menu iniciar"]}),o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Funciona em tela cheia, sem barras do navegador"]}),o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Notificaes e atualizaes automticas"]}),o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Melhor desempenho e experincia de uso"]})]})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2.5 rounded-md bg-surface-2 hover:bg-surface text-text-primary font-medium transition",children:"Entendi"})})]})]})})]})}function soe(e,t,r,n,a){n=n||{};var i=1.15,s=a.internal.scaleFactor,l=a.internal.getFontSize()/s,c=a.getLineHeightFactor?a.getLineHeightFactor():i,d=l*c,u=/\r\n|\r|\n/g,f="",m=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(u):e,m=f.length||1),r+=l*(2-i),n.valign==="middle"?r-=m/2*d:n.valign==="bottom"&&(r-=m*d),n.halign==="center"||n.halign==="right"){var h=l;if(n.halign==="center"&&(h*=.5),f&&m>=1){for(var v=0;v<f.length;v++)a.text(f[v],t-a.getStringUnitWidth(f[v])*h,r),r+=d;return a}t-=a.getStringUnitWidth(e)*h}return n.halign==="justify"?a.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(e,t,r),a}var hU={},Jv=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:hU=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,a,i;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),l=s.fontStyle,c=s.fontName;if(t.font&&(c=t.font),t.fontStyle){l=t.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=e.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=e.unifyColor(t.textColor),u&&(a=this.jsPDFDocument).setTextColor.apply(a,u),u=e.unifyColor(t.lineColor),u&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,a,i){return this.jsPDFDocument.rect(t,r,n,a,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return hU||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),E4=function(e,t){return E4=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},E4(e,t)};function loe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");E4(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var coe=function(e){loe(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function got(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function vot(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function iS(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],a=n.map(function(i){return r.getTextWidth(i)}).reduce(function(i,s){return Math.max(i,s)},0);return a}function doe(e,t,r,n){var a=t.settings.tableLineWidth,i=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:i});var s=uoe(a,!1);s&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,s)}function uoe(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function I5(e,t){var r,n,a,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(a=e.right)!==null&&a!==void 0?a:t,bottom:(i=e.bottom)!==null&&i!==void 0?i:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function foe(e,t){var r=I5(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function xot(e,t,r,n,a){var i={},s=1.3333333333333333,l=SE(t,function(w){return a.getComputedStyle(w).backgroundColor});l!=null&&(i.fillColor=l);var c=SE(t,function(w){return a.getComputedStyle(w).color});c!=null&&(i.textColor=c);var d=bot(n,r);d&&(i.cellPadding=d);var u="borderTopColor",f=s*r,m=n.borderTopWidth;if(n.borderBottomWidth===m&&n.borderRightWidth===m&&n.borderLeftWidth===m){var h=(parseFloat(m)||0)/f;h&&(i.lineWidth=h)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},i.lineWidth.top||(i.lineWidth.right?u="borderRightColor":i.lineWidth.bottom?u="borderBottomColor":i.lineWidth.left&&(u="borderLeftColor"));var v=SE(t,function(w){return a.getComputedStyle(w)[u]});v!=null&&(i.lineColor=v);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var x=parseInt(n.fontSize||"");isNaN(x)||(i.fontSize=x/s);var y=yot(n);y&&(i.fontStyle=y);var b=(n.fontFamily||"").toLowerCase();return e.indexOf(b)!==-1&&(i.font=b),i}function yot(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function SE(e,t){var r=moe(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function moe(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:moe(e.parentElement,t):r}function bot(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,i=r.map(function(l){return parseInt(l||"0")/n}),s=I5(i,0);return a>s.top&&(s.top=a),a>s.bottom&&(s.bottom=a),s}function hoe(e,t,r,n,a){var i,s;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof t=="string"?l=r.document.querySelector(t):l=t;var c=Object.keys(e.getFontList()),d=e.scaleFactor(),u=[],f=[],m=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:u,body:f,foot:m};for(var h=0;h<l.rows.length;h++){var v=l.rows[h],g=(s=(i=v?.parentElement)===null||i===void 0?void 0:i.tagName)===null||s===void 0?void 0:s.toLowerCase(),x=wot(c,d,r,v,n,a);x&&(g==="thead"?u.push(x):g==="tfoot"?m.push(x):f.push(x))}return{head:u,body:f,foot:m}}function wot(e,t,r,n,a,i){for(var s=new coe(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(a||d.display!=="none"){var u=void 0;i&&(u=xot(e,c,t,d,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:jot(c)})}}var f=r.getComputedStyle(n);if(s.length>0&&(a||f.display!=="none"))return s}function jot(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Not(e,t,r){for(var n=0,a=[e,t,r];n<a.length;n++){var i=a[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function wf(e,t,r,n,a){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),s=1;s<arguments.length;s++){var l=arguments[s];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(i[c]=l[c])}return i}function uR(e,t){var r=new Jv(e),n=r.getDocumentOptions(),a=r.getGlobalOptions();Not(a,n,t);var i=wf({},a,n,t),s;typeof window<"u"&&(s=window);var l=_ot(a,n,t),c=Sot(a,n,t),d=Cot(r,i),u=Aot(r,i,s);return{id:t.tableId,content:u,hooks:c,styles:l,settings:d}}function _ot(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var d=e[c],u=t[c],f=r[c];n.columnStyles=wf({},d,u,f)}else{var m=[e,t,r],h=m.map(function(v){return v[c]||{}});n[c]=wf({},h[0],h[1],h[2])}},i=0,s=Object.keys(n);i<s.length;i++){var l=s[i];a(l)}return n}function Sot(e,t,r){for(var n=[e,t,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,s=n;i<s.length;i++){var l=s[i];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function Cot(e,t){var r,n,a,i,s,l,c,d,u,f,m,h,v=I5(t.margin,40/e.scaleFactor()),g=(r=Pot(e,t.startY))!==null&&r!==void 0?r:v.top,x;t.showFoot===!0?x="everyPage":t.showFoot===!1?x="never":x=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var y;t.showHead===!0?y="everyPage":t.showHead===!1?y="never":y=(a=t.showHead)!==null&&a!==void 0?a:"everyPage";var b=(i=t.useCss)!==null&&i!==void 0?i:!1,w=t.theme||(b?"plain":"striped"),j=!!t.horizontalPageBreak,_=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(l=t.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:b,theme:w,startY:g,margin:v,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=t.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:y,showFoot:x,tableLineWidth:(f=t.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(m=t.tableLineColor)!==null&&m!==void 0?m:200,horizontalPageBreak:j,horizontalPageBreakRepeat:_,horizontalPageBreakBehaviour:(h=t.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function Pot(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),a=e.pageNumber(),i=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;i=s===a}return typeof t=="number"?t:(t==null||t===!1)&&i&&r?.finalY!=null?r.finalY+20/n:null}function Aot(e,t,r){var n=t.head||[],a=t.body||[],i=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(r){var l=hoe(e,t.html,r,s,t.useCss)||{};n=l.head||n,a=l.body||n,i=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||Eot(n,a,i);return{columns:c,head:n,body:a,foot:i}}function Eot(e,t,r){var n=e[0]||t[0]||r[0]||[],a=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var s=1,l;Array.isArray(n)?l=n[parseInt(i)]:l=n[i],typeof l=="object"&&!Array.isArray(l)&&(s=l?.colSpan||1);for(var c=0;c<s;c++){var d=void 0;Array.isArray(n)?d=a.length:d=i+(c>0?"_".concat(c):"");var u={dataKey:d};a.push(u)}}),a}var sS=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),poe=function(e){loe(t,e);function t(r,n,a,i,s,l){var c=e.call(this,r,n,l)||this;return c.cell=a,c.row=i,c.column=s,c.section=i.section,c}return t}(sS),goe=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,a,i,s){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new poe(t,this,n,a,i,s),f=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var i=a[n];i(new sS(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var i=a[n];i(new sS(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,i){return a+i.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),fR=function(){function e(t,r,n,a,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof coe&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,a){var i;return Math.max(n,((i=r.cells[a.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(a,i){var s=n.cells[i.index];if(!s)return 0;var l=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),d=c+l;return d>a?d:a},0)},e}(),mR=function(){function e(t,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(a=t.content)!==null&&a!==void 0?a:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=i!=null?""+i:"",l=/\r\n|\r|\n/g;this.text=s.split(l)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/t*r,i=n*a+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=I5(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),voe=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,a=t.allRows();n<a.length;n++){var i=a[n],s=i.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},e}();function kot(e,t){Oot(e,t);var r=[],n=0;t.columns.forEach(function(i){var s=i.getMaxCustomCellWidth(t);s?i.width=s:(i.width=i.wrappedWidth,r.push(i)),n+=i.width});var a=t.getWidth(e.pageSize().width)-n;a&&(a=k4(r,a,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),a&&(a=k4(r,a,function(i){return i.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),Iot(t),Dot(t,e),Tot(t)}function Oot(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,a=foe(e,t);t.allRows().forEach(function(i){for(var s=0,l=t.columns;s<l.length;s++){var c=l[s],d=i.cells[c.index];if(d){var u=t.hooks.didParseCell;t.callCellHooks(e,u,d,i,c,null);var f=d.padding("horizontal");d.contentWidth=iS(d.text,d.styles,e)+f;var m=iS(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,e);if(d.minReadableWidth=m+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>a?(d.minWidth=a,d.wrappedWidth=a):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var h=10/r;d.minWidth=d.styles.minCellWidth||h,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),t.allRows().forEach(function(i){for(var s=0,l=t.columns;s<l.length;s++){var c=l[s],d=i.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},f=u.cellWidth||u.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function k4(e,t,r){for(var n=t,a=e.reduce(function(h,v){return h+v.wrappedWidth},0),i=0;i<e.length;i++){var s=e[i],l=s.wrappedWidth/a,c=n*l,d=s.width+c,u=r(s),f=d<u?u:d;t-=f-s.width,s.width=f}if(t=Math.round(t*1e10)/1e10,t){var m=e.filter(function(h){return t<0?h.width>r(h):!0});m.length&&(t=k4(m,t,r))}return t}function Tot(e){for(var t={},r=1,n=e.allRows(),a=0;a<n.length;a++)for(var i=n[a],s=0,l=e.columns;s<l.length;s++){var c=l[s],d=t[c.index];if(r>1)r--,delete i.cells[c.index];else if(d)d.cell.height+=i.height,r=d.cell.colSpan,delete i.cells[c.index],d.left--,d.left<=1&&delete t[c.index];else{var u=i.cells[c.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var f=n.length-a,m=u.rowSpan>f?f:u.rowSpan;t[c.index]={cell:u,left:m,row:i}}}}}function Iot(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],a=null,i=0,s=0,l=0;l<e.columns.length;l++){var c=e.columns[l];if(s-=1,s>1&&e.columns[l+1])i+=c.width,delete n.cells[c.index];else if(a){var d=a;delete n.cells[c.index],a=null,d.width=c.width+i}else{var d=n.cells[c.index];if(!d)continue;if(s=d.colSpan,i=0,d.colSpan>1){a=d,i+=c.width;continue}d.width=c.width+i}}}function Dot(e,t){for(var r={count:0,height:0},n=0,a=e.allRows();n<a.length;n++){for(var i=a[n],s=0,l=e.columns;s<l.length;s++){var c=l[s],d=i.cells[c.index];if(d){t.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=t.splitTextToSize(d.text,u+1/t.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=pU(d.text,u,d.styles,t,"...");else if(d.styles.overflow==="hidden")d.text=pU(d.text,u,d.styles,t,"");else if(typeof d.styles.overflow=="function"){var f=d.styles.overflow(d.text,u);typeof f=="string"?d.text=[f]:d.text=f}d.contentHeight=d.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var m=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<m*d.rowSpan?r={height:m,count:d.rowSpan}:r&&r.count>0&&r.height>m&&(m=r.height),m>i.height&&(i.height=m)}}r.count--}}function pU(e,t,r,n,a){return e.map(function(i){return Mot(i,t,r,n,a)})}function Mot(e,t,r,n,a){var i=1e4*n.scaleFactor();if(t=Math.ceil(t*i)/i,t>=iS(e,r,n))return e;for(;t<iS(e+a,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}function hR(e,t){var r=new Jv(e),n=Rot(t,r.scaleFactor()),a=new goe(t,n);return kot(r,a),r.applyStyles(r.userStyles),a}function Rot(e,t){var r=e.content,n=$ot(r.columns);if(r.head.length===0){var a=gU(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=gU(n,"foot");a&&r.foot.push(a)}var i=e.settings.theme,s=e.styles;return{columns:n,head:CE("head",r.head,n,s,i,t),body:CE("body",r.body,n,s,i,t),foot:CE("foot",r.foot,n,s,i,t)}}function CE(e,t,r,n,a,i){var s={},l=t.map(function(c,d){for(var u=0,f={},m=0,h=0,v=0,g=r;v<g.length;v++){var x=g[v];if(s[x.index]==null||s[x.index].left===0)if(h===0){var y=void 0;Array.isArray(c)?y=c[x.index-m-u]:y=c[x.dataKey];var b={};typeof y=="object"&&!Array.isArray(y)&&(b=y?.styles||{});var w=Fot(e,x,d,a,n,i,b),j=new mR(y,w,e);f[x.dataKey]=j,f[x.index]=j,h=j.colSpan-1,s[x.index]={left:j.rowSpan-1,times:h}}else h--,m++;else s[x.index].left--,h=s[x.index].times,u++}return new fR(c,d,e,f)});return l}function gU(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var a=Lot(t,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function Lot(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function $ot(e){return e.map(function(t,r){var n,a;return typeof t=="object"?a=(n=t.dataKey)!==null&&n!==void 0?n:r:a=r,new voe(a,t,r)})}function Fot(e,t,r,n,a,i,s){var l=vot(n),c;e==="head"?c=a.headStyles:e==="body"?c=a.bodyStyles:e==="foot"&&(c=a.footStyles);var d=wf({},l.table,l[e],a.styles,c),u=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},f=e==="body"?u:{},m=e==="body"&&r%2===0?wf({},l.alternateRow,a.alternateRowStyles):{},h=got(i),v=wf({},h,d,m,f);return wf(v,s)}function Bot(e,t,r){var n;r===void 0&&(r={});var a=foe(e,t),i=new Map,s=[],l=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(m){var h=t.columns.find(function(v){return v.dataKey===m||v.index===m});h&&!i.has(h.index)&&(i.set(h.index,!0),s.push(h.index),l.push(t.columns[h.index]),a-=h.wrappedWidth)});for(var d=!0,u=(n=r?.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(i.has(u)){u++;continue}var f=t.columns[u].wrappedWidth;if(d||a>=f)d=!1,s.push(u),l.push(t.columns[u]),a-=f;else break;u++}return{colIndexes:s,columns:l,lastIndex:u-1}}function qot(e,t){for(var r=[],n=0;n<t.columns.length;n++){var a=Bot(e,t,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function pR(e,t){var r=t.settings,n=r.startY,a=r.margin,i={x:a.left,y:n},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=n+a.bottom+s;if(r.pageBreak==="avoid"){var c=t.body,d=c.reduce(function(m,h){return m+h.height},0);l+=d}var u=new Jv(e);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(yoe(u),i.y=a.top),t.callWillDrawPageHooks(u,i);var f=wf({},i);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?zot(u,t,f,i):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(m){return Bf(u,t,m,i,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(m,h){var v=h===t.body.length-1;lS(u,t,m,v,f,i,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(m){return Bf(u,t,m,i,t.columns)})),doe(u,t,f,i),t.callEndPageHooks(u,i),t.finalY=i.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function zot(e,t,r,n){var a=qot(e,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(d,u){e.applyStyles(e.userStyles),u>0?ib(e,t,r,n,d.columns,!0):vU(e,t,n,d.columns),Uot(e,t,r,n,d.columns),PE(e,t,n,d.columns)});else for(var s=-1,l=a[0],c=function(){var d=s;if(l){e.applyStyles(e.userStyles);var u=l.columns;s>=0?ib(e,t,r,n,u,!0):vU(e,t,n,u),d=xU(e,t,s+1,n,u),PE(e,t,n,u)}var f=d-s;a.slice(1).forEach(function(m){e.applyStyles(e.userStyles),ib(e,t,r,n,m.columns,!0),xU(e,t,s+1,n,m.columns,f),PE(e,t,n,m.columns)}),s=d};s<t.body.length-1;)c()}function vU(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&t.head.forEach(function(i){return Bf(e,t,i,r,n)})}function Uot(e,t,r,n,a){e.applyStyles(e.userStyles),t.body.forEach(function(i,s){var l=s===t.body.length-1;lS(e,t,i,l,r,n,a)})}function xU(e,t,r,n,a,i){e.applyStyles(e.userStyles),i=i??t.body.length;var s=Math.min(r+i,t.body.length),l=-1;return t.body.slice(r,s).forEach(function(c,d){var u=r+d===t.body.length-1,f=xoe(e,t,u,n);c.canEntireRowFit(f,a)&&(Bf(e,t,c,n,a),l=r+d)}),l}function PE(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&t.foot.forEach(function(i){return Bf(e,t,i,r,n)})}function Vot(e,t,r){var n=r.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),i=Math.floor((t-a)/n);return Math.max(0,i)}function Wot(e,t,r,n){var a={};e.spansMultiplePages=!0,e.height=0;for(var i=0,s=0,l=r.columns;s<l.length;s++){var c=l[s],d=e.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new mR(d.raw,d.styles,d.section);u=wf(u,d),u.text=[];var f=Vot(d,t,n);d.text.length>f&&(u.text=d.text.splice(f,d.text.length));var m=n.scaleFactor(),h=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(m,h),d.contentHeight>=t&&(d.contentHeight=t,u.styles.minCellHeight-=t),d.contentHeight>e.height&&(e.height=d.contentHeight),u.contentHeight=u.getContentHeight(m,h),u.contentHeight>i&&(i=u.contentHeight),a[c.index]=u}}var v=new fR(e.raw,-1,e.section,a,!0);v.height=i;for(var g=0,x=r.columns;g<x.length;g++){var c=x[g],u=v.cells[c.index];u&&(u.height=v.height);var d=e.cells[c.index];d&&(d.height=e.height)}return v}function Hot(e,t,r,n){var a=e.pageSize().height,i=n.settings.margin,s=i.top+i.bottom,l=a-s;t.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,e),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=t.hasRowSpan(n.columns),f=t.getMaxCellHeight(n.columns)>l;return f?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function lS(e,t,r,n,a,i,s){var l=xoe(e,t,n,i);if(r.canEntireRowFit(l,s))Bf(e,t,r,i,s);else if(Hot(e,r,l,t)){var c=Wot(r,l,t,e);Bf(e,t,r,i,s),ib(e,t,a,i,s),lS(e,t,c,n,a,i,s)}else ib(e,t,a,i,s),lS(e,t,r,n,a,i,s)}function Bf(e,t,r,n,a){n.x=t.settings.margin.left;for(var i=0,s=a;i<s.length;i++){var l=s[i],c=r.cells[l.index];if(!c){n.x+=l.width;continue}e.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=t.callCellHooks(e,t.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}Got(e,c,n);var u=c.getTextPos();soe(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function Got(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=uoe(n.lineWidth,n.fillColor);a&&e.rect(t.x,r.y,t.width,t.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),Kot(e,t,r,n.lineWidth))}function Kot(e,t,r,n){var a,i,s,l;n.top&&(a=r.x,i=r.y,s=r.x+t.width,l=r.y,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,i,s,l)),n.bottom&&(a=r.x,i=r.y+t.height,s=r.x+t.width,l=r.y+t.height,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,i,s,l)),n.left&&(a=r.x,i=r.y,s=r.x,l=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,i,s,l)),n.right&&(a=r.x+t.width,i=r.y,s=r.x+t.width,l=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,i,s,l));function c(d,u,f,m,h){e.getDocument().setLineWidth(d),e.getDocument().line(u,f,m,h,"S")}}function xoe(e,t,r,n){var a=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-a}function ib(e,t,r,n,a,i){a===void 0&&(a=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(l){return Bf(e,t,l,n,a)}),t.callEndPageHooks(e,n);var s=t.settings.margin;doe(e,t,r,n),yoe(e),t.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(l){return Bf(e,t,l,n,a)}),e.applyStyles(e.userStyles))}function yoe(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function boe(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=uR(this,n),i=hR(this,a);return pR(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,a){soe(t,r,n,a,this)},e.API.autoTableSetDefaults=function(t){return Jv.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){Jv.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new Jv(this),i=hoe(a,t,window,r,!1),s=i.head,l=i.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var AE;function yU(e,t){var r=uR(e,t),n=hR(e,r);pR(e,n)}function Yot(e,t){var r=uR(e,t);return hR(e,r)}function Xot(e,t){pR(e,t)}try{if(typeof window<"u"&&window){var bU=window,wU=bU.jsPDF||((AE=bU.jspdf)===null||AE===void 0?void 0:AE.jsPDF);wU&&boe(wU)}}catch(e){console.error("Could not apply autoTable plugin",e)}const Jot=Object.freeze(Object.defineProperty({__proto__:null,Cell:mR,CellHookData:poe,Column:voe,HookData:sS,Row:fR,Table:goe,__createTable:Yot,__drawTable:Xot,applyPlugin:boe,autoTable:yU,default:yU},Symbol.toStringTag,{value:"Module"})),Qot={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.08,delayChildren:.1}}},Zs={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function ej({icon:e,label:t,value:r,delta:n,positive:a=!0,color:i="brand"}){return o.jsxs(fr.div,{variants:Zs,className:"fx-card border-0 ring-0 outline-none shadow-none",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[o.jsx(e,{className:`w-4 h-4 text-${i}`}),o.jsx("span",{children:t})]}),n!=null&&o.jsxs("div",{className:`text-xs font-bold ${a?"text-success":"text-danger"}`,children:[a?"+":"",n]})]}),o.jsx("div",{className:"text-3xl font-bold text-text-primary tabular-nums",children:r})]})}function Zot(){const{toast:e}=ro(),{userProfile:t}=Do(),[r,n]=ES(),[a,i]=p.useState(r.get("tab")||"visao-geral"),[s,l]=p.useState(!1),[c,d]=p.useState(()=>{const W=new Date;return new Date(W.getFullYear(),W.getMonth(),1).toISOString().slice(0,10)}),[u,f]=p.useState(()=>new Date().toISOString().slice(0,10)),[m,h]=p.useState(null),[v,g]=p.useState(0),[x,y]=p.useState(0),[b,w]=p.useState([]),[j,_]=p.useState([]),[S,k]=p.useState([]),[E,A]=p.useState([]),[M,C]=p.useState([]),[T,I]=p.useState(0),[D,F]=p.useState(0),[z,q]=p.useState(!1),[$,K]=p.useState(!1),[ce,fe]=p.useState(null),[B,L]=p.useState([]),[V,re]=p.useState(!1),[me,G]=p.useState(!1),[Q,ae]=p.useState(!1),[J,je]=p.useState(null),[be,Ue]=p.useState([]),[Z,Y]=p.useState([]);p.useState({open:!1,tipo:"suprimento",valor:"",observacao:"",loading:!1});const[lt,gt]=p.useState(!1),[Te,at]=p.useState(!1),[yt,vt]=p.useState(null),[Sr,se]=p.useState([]),[Ze,ct]=p.useState(""),[Qt,we]=p.useState("all"),[ye,te]=p.useState("all"),[$e,Pe]=p.useState([]),[It,Dt]=p.useState(""),[kt,cr]=p.useState("all"),[Cr,Ie]=p.useState("all"),[ke,Je]=p.useState(new Set),[mt,Be]=p.useState(!1),[$t,Ee]=p.useState(!1),[Ct,hr]=p.useState(null),[Mr,qr]=p.useState([]),[Or,Mt]=p.useState(!1),[Ir,Ar]=p.useState([]);p.useState("");const Zt=W=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(W||0)),Kr=W=>Number(W||0).toFixed(2),Tr=async(W,Ce,De,bt)=>{try{const{default:He}=await Iu(()=>Promise.resolve().then(()=>kQe),void 0);await Iu(()=>Promise.resolve().then(()=>Jot),void 0);const dt=new He("p","mm","a4"),rr=dt.internal.pageSize.getWidth();if(dt.setFontSize(20),dt.setTextColor(245,158,11),dt.text(W,14,20),dt.setDrawColor(245,158,11),dt.setLineWidth(.5),dt.line(14,23,rr-14,23),dt.setFontSize(10),dt.setTextColor(100,100,100),dt.text(`Perodo: ${c||"N/A"} at ${u||"N/A"}`,14,30),dt.text(`Gerado em: ${new Date().toLocaleString("pt-BR")}`,14,35),typeof dt.autoTable=="function"){dt.autoTable({head:[Ce],body:De,startY:42,theme:"striped",headStyles:{fillColor:[245,158,11],textColor:[255,255,255],fontStyle:"bold",fontSize:11},bodyStyles:{fontSize:10,textColor:[50,50,50]},alternateRowStyles:{fillColor:[249,249,249]},margin:{top:42,left:14,right:14}});const Gr=dt.lastAutoTable.finalY||50;dt.setFontSize(8),dt.setTextColor(150,150,150),dt.text("Relatrio gerado por Fluxo7Arena - Sistema de Gesto de Quadras Esportivas",rr/2,Gr+15,{align:"center"})}else{let Gr=45;dt.setFontSize(11),dt.setTextColor(0,0,0),Ce.forEach((Rr,br)=>{const wr=14+br*60;dt.text(Rr,wr,Gr)}),Gr+=7,dt.setFontSize(10),De.forEach(Rr=>{Rr.forEach((br,wr)=>{const or=14+wr*60;dt.text(String(br),or,Gr)}),Gr+=6})}dt.save(`${bt}_${Xt(new Date,"yyyy-MM-dd")}.pdf`),e({title:"PDF baixado com sucesso!",description:"O arquivo foi salvo na sua pasta de downloads"})}catch(He){console.error("Erro ao gerar PDF:",He),e({title:"Erro ao gerar PDF",description:He.message,variant:"destructive"})}},dn=async()=>{try{const W=["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"],Ce=(Z||[]).map(De=>[De?.aberto_em?new Date(De.aberto_em).toLocaleString("pt-BR"):"-",De?.fechado_em?new Date(De.fechado_em).toLocaleString("pt-BR"):"-",Zt(De?.saldo_inicial||0),De?.saldo_final!=null?Zt(De.saldo_final):Zt(0),De?.valor_final_dinheiro!=null?Zt(De.valor_final_dinheiro):"",De?.diferenca_dinheiro!=null?Zt(De.diferenca_dinheiro):"",String(De?.status||"").toUpperCase()]);await Tr("Fechamentos de Caixa",W,Ce,"fechamentos_caixa")}catch(W){e({title:"Erro ao exportar PDF",description:W?.message||"Tente novamente",variant:"destructive"})}},Ae=()=>{try{const W=";",De=[["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"].join(W)];(Z||[]).forEach(rr=>{const Gr=rr?.aberto_em?new Date(rr.aberto_em).toLocaleString("pt-BR"):"-",Rr=rr?.fechado_em?new Date(rr.fechado_em).toLocaleString("pt-BR"):"-",br=Number(rr?.saldo_inicial||0).toFixed(2).replace(".",","),wr=(rr?.saldo_final!=null?Number(rr.saldo_final):0).toFixed(2).replace(".",","),or=rr?.valor_final_dinheiro!=null?Number(rr.valor_final_dinheiro):null,tn=rr?.diferenca_dinheiro!=null?Number(rr.diferenca_dinheiro):null,tt=String(rr?.status||"").toUpperCase();De.push([Gr,Rr,br,wr,or!=null?or.toFixed(2).replace(".",","):"",tn!=null?tn.toFixed(2).replace(".",","):"",tt].join(W))});const bt=new Blob(["\uFEFF"+De.join(`
`)],{type:"text/csv;charset=utf-8;"}),He=URL.createObjectURL(bt),dt=document.createElement("a");dt.href=He,dt.download=`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(dt),dt.click(),document.body.removeChild(dt),URL.revokeObjectURL(He),e({title:"CSV baixado com sucesso!"})}catch(W){e({title:"Erro ao exportar CSV",description:W?.message||"Tente novamente",variant:"destructive"})}},pt=({cx:W,cy:Ce,midAngle:De,outerRadius:bt,percent:He})=>{const dt=Math.PI/180,rr=(bt||0)+12,Gr=W+rr*Math.cos(-De*dt),Rr=Ce+rr*Math.sin(-De*dt);return o.jsx("text",{x:Gr,y:Rr,fill:"#fff",textAnchor:Gr>W?"start":"end",dominantBaseline:"central",style:{pointerEvents:"none",fontSize:15,fontWeight:700},children:`${Math.round((He||0)*100)}%`})},Br=W=>{const Ce=gr!=null&&gr!==W;return{transition:"opacity 320ms ease-in-out, filter 320ms ease-in-out",opacity:Ce?.25:1,filter:Ce?"grayscale(15%)":"none",cursor:"pointer"}};p.useEffect(()=>{(async()=>{if(!$t||!Ct||Ct.origem!=="Comanda"||!Ct.comanda_id){qr([]),Ar([]);return}try{Mt(!0);const Ce=t?.codigo_empresa;let De=pe.from("comanda_itens").select("descricao, quantidade, preco_unitario").eq("comanda_id",Ct.comanda_id);Ce&&(De=De.eq("codigo_empresa",Ce));const{data:bt}=await De;qr(bt||[]);let He=pe.from("pagamentos").select("id, valor, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("comanda_id",Ct.comanda_id);Ce&&(He=He.eq("codigo_empresa",Ce));const{data:dt}=await He;Ar(dt||[])}catch(Ce){console.warn("[Financeiro][RecebimentoModal] Falha ao carregar itens da comanda:",Ce?.message),qr([]),Ar([])}finally{Mt(!1)}})()},[$t,Ct,t?.codigo_empresa]);const Pr=async()=>{try{l(!0);const W=Tn(c)||void 0,Ce=Qn(u)||void 0,De=t?.codigo_empresa;console.debug("[Financeiro][VisaoGeral] Carregando com perodo:",{fromISO:W,toISO:Ce,codigo:De});const bt=await id({from:W,to:Ce}).catch(()=>null);h(bt||{totalPorFinalizadora:{},totalEntradas:0,totalVendasBrutas:0,totalDescontos:0,totalVendasLiquidas:0}),console.debug("[Financeiro][VisaoGeral] Resumo calculado:",bt);try{let He=pe.from("pagamentos").select("valor, status").eq("codigo_empresa",De);W&&(He=He.gte("recebido_em",W)),Ce&&(He=He.lte("recebido_em",Ce));const{data:dt}=await He,rr=(dt||[]).reduce((wr,or)=>{const tn=or.status||"Pago";return tn==="Cancelado"||tn==="Estornado"?wr:wr+Number(or.valor||0)},0);g(rr);let Gr=pe.from("agendamentos").select("id").eq("codigo_empresa",De);W&&(Gr=Gr.gte("inicio",W)),Ce&&(Gr=Gr.lte("inicio",Ce));const{data:Rr}=await Gr;let br=0;if(Rr&&Rr.length>0){const wr=Rr.map(tn=>tn.id),{data:or}=await pe.from("agendamento_participantes").select("valor_cota, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",De).in("agendamento_id",wr).eq("status_pagamento","Pago");br=(or||[]).reduce((tn,tt)=>{let Hr=Number(tt.valor_cota||0);if(tt.aplicar_taxa===!0){const un=Number(tt.finalizadoras?.taxa_percentual||0);un>0&&(Hr=Hr/(1+un/100))}return tn+Hr},0)}y(br),console.debug("[Financeiro][VisaoGeral] Receitas por origem:",{totalComandas:rr,totalAg:br})}catch(He){console.warn("[Financeiro][VisaoGeral] Falha ao calcular KPIs por origem:",He?.message),g(0),y(0)}try{let He=pe.from("pagamentos").select("valor, status, origem").eq("codigo_empresa",De).eq("origem","xml");W&&(He=He.gte("recebido_em",W)),Ce&&(He=He.lte("recebido_em",Ce));const{data:dt}=await He,rr=(dt||[]).reduce((Rr,br)=>["Cancelado","Estornado"].includes(br.status)?Rr:Rr+Number(br.valor||0),0);I(rr);const{count:Gr}=await pe.from("produtos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",De).or("importado_via_xml.is.true,categoria.ilike.Importados").gte("criado_em",W).lte("criado_em",Ce);F(Gr||0)}catch(He){console.warn("[Financeiro][VisaoGeral] Falha KPIs XML:",He?.message),I(0),F(0)}if(De){let He=pe.from("comandas").select("id").eq("status","closed");De&&(He=He.eq("codigo_empresa",De)),W&&(He=He.gte("fechado_em",W)),Ce&&(He=He.lte("fechado_em",Ce));const{data:dt,error:rr}=await He;if(rr)throw rr;const Gr=(dt||[]).map(or=>or.id);console.debug("[Financeiro][VisaoGeral] Comandas fechadas:",Gr.length);let Rr=[];if(Gr.length>0){let or=pe.from("comanda_itens").select("produto_id, quantidade, preco_unitario, produtos!comanda_itens_produto_id_fkey(nome)").in("comanda_id",Gr);De&&(or=or.eq("codigo_empresa",De));const{data:tn}=await or;Rr=tn||[]}const br={};(Rr||[]).forEach(or=>{const tn=or.produtos?.nome||"Produto sem nome",tt=Number(or.quantidade||0),Hr=tt*Number(or.preco_unitario||0);br[tn]||(br[tn]={quantidade:0,valor:0}),br[tn].quantidade+=tt,br[tn].valor+=Hr});const wr=Object.entries(br).map(([or,tn])=>({nome:or,quantidade:tn.quantidade,valor:tn.valor})).sort((or,tn)=>tn.valor-or.valor);k(wr),w(wr.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Produtos agregados:",{total:wr.length,top5:wr.slice(0,5)})}if(De)try{let He=pe.from("pagamentos").select("comanda_id, valor, status").eq("codigo_empresa",De).neq("status","Cancelado").neq("status","Estornado");W&&(He=He.gte("recebido_em",W)),Ce&&(He=He.lte("recebido_em",Ce));const{data:dt}=await He;console.debug("[Financeiro][VisaoGeral] Pagamentos carregados:",(dt||[]).length);const rr=Array.from(new Set((dt||[]).map(tt=>tt.comanda_id).filter(Boolean)));let Gr=[];if(rr.length>0){let tt=pe.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",rr).eq("codigo_empresa",De);const{data:Hr}=await tt;Gr=Hr||[]}console.debug("[Financeiro][VisaoGeral] Vinculos comanda_clientes:",Gr.length);const Rr=Array.from(new Set(Gr.map(tt=>tt.cliente_id).filter(Boolean))),br={};if(Rr.length>0){const{data:tt}=await pe.from("clientes").select("id, nome").in("id",Rr).eq("codigo_empresa",De);(tt||[]).forEach(Hr=>{br[Hr.id]=Hr.nome})}const wr={};Gr.forEach(tt=>{const Hr=tt.nome_livre||br[tt.cliente_id]||`Cliente ${tt.cliente_id||""}`;wr[tt.comanda_id]||(wr[tt.comanda_id]=new Set),Hr&&wr[tt.comanda_id].add(Hr)});const or={};(dt||[]).forEach(tt=>{const Hr=Array.from(wr[tt.comanda_id]||[]),un=Number(tt.valor||0);if(Hr.length===0){const jn="Sem cliente";or[jn]||(or[jn]={id:null,nome:jn,valor:0}),or[jn].valor+=un}else Hr.forEach(jn=>{or[jn]||(or[jn]={id:null,nome:jn,valor:0}),or[jn].valor+=un})});try{const tt=new Map(Object.values(br).map((Dn,va)=>[Object.keys(br)[va],Dn]));let Hr=pe.from("v_agendamento_participantes").select("agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text");De&&(Hr=Hr.eq("codigo_empresa",De));let{data:un}=await Hr;un=un||[];const jn=Array.from(new Set(un.map(Dn=>Dn.agendamento_id).filter(Boolean)));let vn=new Set;if(jn.length>0){let Dn=pe.from("agendamentos").select("id, inicio").in("id",jn);De&&(Dn=Dn.eq("codigo_empresa",De));const{data:va}=await Dn,on=W?new Date(W).getTime():null,Ea=Ce?new Date(Ce).getTime():null;(va||[]).forEach(Ca=>{const ya=Ca?.inicio?new Date(Ca.inicio).getTime():null;ya!=null&&(on==null||ya>=on)&&(Ea==null||ya<=Ea)&&vn.add(Ca.id)})}const Zn=un.filter(Dn=>vn.has(Dn.agendamento_id));console.debug("[Financeiro][Agendamentos] participantes no perodo (by agendamento.inicio):",Zn.length);const oa=Array.from(new Set((Zn||[]).map(Dn=>Dn.cliente_id).filter(Boolean).map(String))).filter(Dn=>!tt.has(Dn));if(oa.length>0){const{data:Dn}=await pe.from("clientes").select("id,nome").in("id",oa);(Dn||[]).forEach(va=>tt.set(String(va.id),va.nome))}(Zn||[]).forEach(Dn=>{const va=String(Dn.status_pagamento||Dn.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(va))return;const on=Dn.cliente_id,Ea=on?tt.get(String(on))||`Cliente ${on}`:null;if(!Ea)return;const Ca=Number(Dn.valor_cota||0);or[Ea]||(or[Ea]={id:on||null,nome:Ea,valor:0}),or[Ea].valor+=Ca})}catch{}const tn=Object.values(or).sort((tt,Hr)=>Hr.valor-tt.valor);A(tn),_(tn.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Clientes agregados:",{total:tn.length,top5:tn.slice(0,5)})}catch(He){console.error("Erro ao carregar top clientes:",He),_([]),A([])}if(De&&W&&Ce)try{let He=pe.from("pagamentos").select("recebido_em, valor, status").eq("codigo_empresa",De).gte("recebido_em",W).lte("recebido_em",Ce).order("recebido_em",{ascending:!0});const{data:dt}=await He;let rr=pe.from("v_agendamentos_detalhado").select("inicio, valor_pago, status_pagamento").eq("codigo_empresa",De).eq("status_pagamento","Pago").gte("inicio",W).lte("inicio",Ce).order("inicio",{ascending:!0});const{data:Gr}=await rr,Rr={};(dt||[]).forEach(wr=>{if(["Cancelado","Estornado"].includes(wr.status))return;const or=new Date(wr.recebido_em).toLocaleDateString("pt-BR");Rr[or]=(Rr[or]||0)+Number(wr.valor||0)}),(Gr||[]).forEach(wr=>{const or=new Date(wr.inicio).toLocaleDateString("pt-BR");Rr[or]=(Rr[or]||0)+Number(wr.valor_pago||0)});const br=Object.entries(Rr).map(([wr,or])=>({data:wr,valor:or})).sort((wr,or)=>{const[tn,tt,Hr]=wr.data.split("/").map(Number),[un,jn,vn]=or.data.split("/").map(Number);return new Date(Hr,tt-1,tn).getTime()-new Date(vn,jn-1,un).getTime()});C(br),console.debug("[Financeiro][VisaoGeral] Evoluo diria:",br.length,"dias")}catch(He){console.warn("[Financeiro][VisaoGeral] Falha ao calcular evoluo diria:",He?.message),C([])}else C([])}catch(W){e({title:"Falha ao carregar viso geral",description:W?.message||"Tente novamente",variant:"destructive"})}finally{l(!1)}},Ur=async()=>{try{const W=t?.codigo_empresa,Ce=await Dm({codigoEmpresa:W});if(ae(!!Ce),Ce){const[bt,He]=await Promise.all([w1({codigoEmpresa:W}),Ip({caixaSessaoId:Ce.id,codigoEmpresa:W})]);je(bt||null),Ue(He||[])}else je(null),Ue([]);const De=await ere({limit:50,codigoEmpresa:W});if(console.log("[FinanceiroPage][loadCaixa] Histrico recebido de listarFechamentosCaixa:",De?.length,"sesses"),De&&De.length>0){console.log("[FinanceiroPage][loadCaixa] Primeira sesso do histrico:",De[0]);const bt=De.filter(He=>He.valor_final_dinheiro!=null);console.log("[FinanceiroPage][loadCaixa] Sesses com valor_final_dinheiro:",bt.length,"/",De.length)}Y(De||[])}catch(W){e({title:"Falha ao carregar caixa",description:W?.message,variant:"destructive"})}},Zr=async()=>{try{l(!0);const W=t?.codigo_empresa,Ce=Tn(c)||void 0,De=Qn(u)||void 0;let bt=pe.from("pagamentos").select("id, comanda_id, valor, status, metodo, recebido_em, origem, xml_chave, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("codigo_empresa",W).order("recebido_em",{ascending:!1});Ce&&(bt=bt.gte("recebido_em",Ce)),De&&(bt=bt.lte("recebido_em",De));const{data:He}=await bt;let dt=new Map,rr=new Map;try{const or=Array.from(new Set((He||[]).map(tn=>tn.comanda_id).filter(Boolean)));if(or.length>0){const{data:tn}=await pe.from("comandas").select("id, cliente_id, tipo").in("id",or).eq("codigo_empresa",W),tt=Array.from(new Set((tn||[]).map(jn=>jn.cliente_id).filter(Boolean)));let Hr=new Map;if(tt.length>0){const{data:jn}=await pe.from("clientes").select("id, nome").in("id",tt).eq("codigo_empresa",W);Hr=new Map((jn||[]).map(vn=>[vn.id,vn.nome]))}for(const jn of tn||[]){if(!jn)continue;const vn=Hr.get(jn.cliente_id)||null;dt.set(jn.id,vn),rr.set(jn.id,jn.tipo||null)}const un=(tn||[]).filter(jn=>!jn?.cliente_id).map(jn=>jn.id);if(un.length>0)try{const{data:jn}=await pe.from("comanda_clientes").select("comanda_id, cliente_id").in("comanda_id",un).eq("codigo_empresa",W),vn=Array.from(new Set((jn||[]).map(Zn=>Zn.cliente_id).filter(Boolean)));if(vn.length>0){const{data:Zn}=await pe.from("clientes").select("id, nome").in("id",vn).eq("codigo_empresa",W),Mn=new Map((Zn||[]).map(oa=>[oa.id,oa.nome]));for(const oa of jn||[]){const Dn=Mn.get(oa.cliente_id)||null;Dn&&!dt.get(oa.comanda_id)&&dt.set(oa.comanda_id,Dn)}}}catch{console.debug("[Financeiro][Recebimentos] comanda_clientes indisponvel (ok)")}}}catch(or){console.warn("[Financeiro][Recebimentos] Falha ao buscar clientes de comandas:",or?.message)}let Gr=pe.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, quadra_nome, participante_nome, valor_cota, status_pagamento, finalizadora_nome").eq("codigo_empresa",W).eq("status_pagamento","Pago").order("inicio",{ascending:!1});Ce&&(Gr=Gr.gte("inicio",Ce)),De&&(Gr=Gr.lte("inicio",De));const{data:Rr}=await Gr,br=(He||[]).map(or=>({id:or.id,origem:rr.get(or.comanda_id||"")==="balcao"?"Balco":"Comanda",comanda_id:or.comanda_id||null,recebido_em:or.recebido_em,finalizadoras:or.finalizadoras,metodo:or.metodo,valor:or.valor,status:or.status,descricao:dt.get(or.comanda_id||"")||null,fonte:or.origem||"manual",xml_chave:or.xml_chave||null})),wr=(Rr||[]).map((or,tn)=>({id:`ag-${or.agendamento_id}-${tn}`,origem:"Agendamento",recebido_em:or.inicio,finalizadoras:or.finalizadora_nome?{nome:or.finalizadora_nome}:null,metodo:or.finalizadora_nome||null,valor:or.valor_cota,status:or.status_pagamento,descricao:`#${or.agendamento_codigo} - ${or.participante_nome} (${or.quadra_nome||""})`,agendamento_codigo:or.agendamento_codigo,quadra_nome:or.quadra_nome,participante_nome:or.participante_nome,fonte:null}));se([...br,...wr])}catch(W){e({title:"Falha ao carregar recebimentos",description:W?.message,variant:"destructive"})}finally{l(!1)}},cn=async()=>{try{l(!0);const W=t?.codigo_empresa,Ce=Tn(c)||void 0,De=Qn(u)||void 0;let bt=pe.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, fim, quadra_nome, participante_nome, cliente_id, valor_cota, finalizadora_nome, status_pagamento").eq("codigo_empresa",W).order("inicio",{ascending:!1});Ce&&(bt=bt.gte("inicio",Ce)),De&&(bt=bt.lte("inicio",De));const{data:He}=await bt,dt=[...new Set((He||[]).map(Rr=>Rr.cliente_id).filter(Boolean))];let rr={};if(dt.length>0){const{data:Rr}=await pe.from("clientes").select("id, is_consumidor_final, codigo").in("id",dt).eq("codigo_empresa",W);Rr&&(rr=Object.fromEntries(Rr.map(br=>[br.id,br])))}const Gr=(He||[]).map(Rr=>({...Rr,is_consumidor_final:rr[Rr.cliente_id]?.is_consumidor_final||!1,cliente_codigo:rr[Rr.cliente_id]?.codigo||null}));Pe(Gr)}catch(W){e({title:"Falha ao carregar agendamentos",description:W?.message,variant:"destructive"})}finally{l(!1)}};p.useEffect(()=>{n({tab:a})},[a]);const Tn=W=>{if(!W)return null;if(typeof W=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(W)){const[Ce,De,bt]=W.split("-").map(Number);return new Date(Ce,De-1,bt,0,0,0,0).toISOString()}return new Date(W).toISOString()},Qn=W=>{if(!W)return null;if(typeof W=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(W)){const[Ce,De,bt]=W.split("-").map(Number);return new Date(Ce,De-1,bt,23,59,59,999).toISOString()}return new Date(W).toISOString()};p.useEffect(()=>{t?.codigo_empresa&&(a==="visao-geral"||a==="relatorios"?Pr():a==="caixa"?Ur():a==="recebimentos"?Zr():a==="agendamentos"&&cn())},[a,c,u,t?.codigo_empresa]);const Sa=p.useMemo(()=>{const W=m?.totalPorFinalizadora||{},Ce=Object.entries(W).map(([De,bt])=>({name:De,valor:Number(bt||0)}));return Ce.sort((De,bt)=>bt.valor-De.valor),Ce},[m]),[ht,Vt]=p.useState(null),[gr,Lt]=p.useState(null),Pt={start:90,end:-270},Yr=(W,Ce,De)=>W+(Ce-W)*De,Ft=W=>W<.5?4*W*W*W:1-Math.pow(-2*W+2,3)/2,jr=W=>{const Ce=Number(v||0),De=Number(x||0),bt=Math.max(1e-4,Ce+De),He=360*(Ce/bt);return W===0?{a:Pt.start,b:Pt.start-He}:{a:Pt.start-He,b:Pt.end}},[ot,Kt]=p.useState({from:null,to:null,t:1}),vr=gr??ht;p.useEffect(()=>{if(vr==null)return;const W=jr(vr);Kt(dt=>({from:dt.to||W,to:W,t:0}));let Ce;const De=performance.now(),bt=380,He=dt=>{const rr=Math.min(1,(dt-De)/bt),Gr=Ft(rr);Kt(Rr=>({...Rr,t:Gr})),rr<1&&(Ce=requestAnimationFrame(He))};return Ce=requestAnimationFrame(He),()=>Ce&&cancelAnimationFrame(Ce)},[vr,v,x]);const X=86,nt=94,qe=80,[it,We]=p.useState({from:[X,X],to:[X,X],t:1});p.useEffect(()=>{const W=vr===0?[nt,qe]:vr===1?[qe,nt]:[X,X];We(dt=>({from:dt.to||W,to:W,t:0}));let Ce;const De=performance.now(),bt=380,He=dt=>{const rr=Math.min(1,(dt-De)/bt),Gr=Ft(rr);We(Rr=>({...Rr,t:Gr})),rr<1&&(Ce=requestAnimationFrame(He))};return Ce=requestAnimationFrame(He),()=>Ce&&cancelAnimationFrame(Ce)},[vr]);const ut=({cx:W,cy:Ce,outerRadius:De})=>{if(!ot.from||!ot.to)return null;const bt=Yr(ot.from.a,ot.to.a,ot.t),He=Yr(ot.from.b,ot.to.b,ot.t),dt=vr===0?"#22C55E":"#F59E0B";return o.jsx(AD,{cx:W,cy:Ce,innerRadius:0,outerRadius:(De||0)+4,startAngle:bt,endAngle:He,fill:dt,fillOpacity:.18,stroke:"transparent"})},At=p.useMemo(()=>{let W=Sr;if(Ze){const Ce=Ze.toLowerCase();W=W.filter(De=>(De.descricao||"").toLowerCase().includes(Ce)||(De.finalizadoras?.nome||"").toLowerCase().includes(Ce)||String(De.valor||"").includes(Ce)||(De.origem||"").toLowerCase().includes(Ce))}return Qt!=="all"&&(W=W.filter(Ce=>(Ce.finalizadoras?.nome||Ce.metodo)===Qt)),ye!=="all"&&(W=W.filter(Ce=>(Ce.fonte||"manual")===ye)),W},[Sr,Ze,Qt,ye]),Wt=p.useMemo(()=>{const W={};return($e||[]).forEach(Ce=>{const De=Ce.agendamento_id||Ce.agendamento_codigo;W[De]||(W[De]={agendamento_id:Ce.agendamento_id,agendamento_codigo:Ce.agendamento_codigo,inicio:Ce.inicio,fim:Ce.fim,quadra_nome:Ce.quadra_nome,participantes:[],total:0,totalPago:0,totalPendente:0,statusGeral:"Pendente",representante:"",representanteClienteId:null,representanteCodigo:null,isRepresentanteConsumidor:!1}),W[De].participantes.push(Ce),W[De].total+=Number(Ce.valor_cota||0),Ce.status_pagamento==="Pago"?W[De].totalPago+=Number(Ce.valor_cota||0):W[De].totalPendente+=Number(Ce.valor_cota||0)}),Object.values(W).forEach(Ce=>{const De=Ce.participantes.every(He=>He.status_pagamento==="Pago");if(Ce.participantes.every(He=>He.status_pagamento==="Cancelado")?Ce.statusGeral="Cancelado":De?Ce.statusGeral="Pago":Ce.statusGeral="Pendente",Ce.participantes.length>0){let He=Ce.participantes.find(rr=>!rr.is_consumidor_final);He||(He=Ce.participantes[0]);let dt=He?.participante_nome||"";He?.is_consumidor_final&&dt&&(dt.toLowerCase().includes("cliente consumidor")||(dt=dt)),Ce.representante=dt,Ce.representanteClienteId=He?.cliente_id||null,Ce.representanteCodigo=He?.is_consumidor_final?0:He?.cliente_codigo??null,Ce.isRepresentanteConsumidor=He?.is_consumidor_final||!1}}),Object.values(W).sort((Ce,De)=>new Date(De.inicio)-new Date(Ce.inicio))},[$e]),$r=p.useMemo(()=>{const W=It.toLowerCase().trim();return Wt.filter(Ce=>{if(kt!=="all"&&(kt==="Pago"&&Ce.statusGeral!=="Pago"||kt==="Pendente"&&Ce.statusGeral!=="Pendente"||kt==="Cancelado"&&Ce.statusGeral!=="Cancelado")||Cr!=="all"&&!Ce.participantes.some(rr=>rr.finalizadora_nome===Cr))return!1;if(!W)return!0;const De=String(Ce.agendamento_codigo||""),bt=String(Ce.quadra_nome||"").toLowerCase(),He=Ce.participantes.map(dt=>String(dt.participante_nome||"").toLowerCase()).join(" ");return De.includes(W)||bt.includes(W)||He.includes(W)})},[Wt,It,kt,Cr]);return o.jsx(o.Fragment,{children:o.jsxs(fr.div,{variants:Qot,initial:"hidden",animate:"visible",className:"space-y-6",children:[o.jsx(fr.div,{variants:Zs,className:"fx-card p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Financeiro"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa das finanas da empresa"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap items-stretch sm:items-center gap-3 w-full sm:w-auto",children:[o.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[o.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Incio"}),o.jsxs(yc,{children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[o.jsx(gi,{className:"h-5 w-5 text-warning flex-shrink-0"}),o.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:c?Xt(new Date(c+"T00:00:00"),"dd/MM/yyyy",{locale:aa}):"Selecione"})]})}),o.jsx(Ml,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:o.jsx(wc,{mode:"single",selected:c?new Date(c+"T00:00:00"):void 0,onSelect:W=>W&&d(Xt(W,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]}),o.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[o.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Fim"}),o.jsxs(yc,{children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[o.jsx(gi,{className:"h-5 w-5 text-warning flex-shrink-0"}),o.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:u?Xt(new Date(u+"T00:00:00"),"dd/MM/yyyy",{locale:aa}):"Selecione"})]})}),o.jsx(Ml,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:o.jsx(wc,{mode:"single",selected:u?new Date(u+"T00:00:00"):void 0,onSelect:W=>W&&f(Xt(W,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]})]})]})}),o.jsxs(Vd,{value:a,onValueChange:i,children:[o.jsx("div",{className:"md:hidden mb-4",children:o.jsxs(En,{value:a,onValueChange:i,children:[o.jsx(Sn,{className:"w-full h-11 bg-black border-warning/40 text-white",children:o.jsx(kn,{placeholder:"Selecione uma aba"})}),o.jsxs(Cn,{className:"bg-black text-white border-warning/40",children:[o.jsx(Nt,{value:"visao-geral",children:"Viso Geral"}),o.jsx(Nt,{value:"caixa",children:"Caixa"}),o.jsx(Nt,{value:"recebimentos",children:"Recebimentos"}),o.jsx(Nt,{value:"agendamentos",children:"Agendamentos"}),o.jsx(Nt,{value:"relatorios",children:"Relatrios"})]})]})}),o.jsxs(sd,{className:"hidden md:grid w-full grid-cols-5",children:[o.jsx(ba,{value:"visao-geral",children:"Viso Geral"}),o.jsx(ba,{value:"caixa",children:"Caixa"}),o.jsx(ba,{value:"recebimentos",children:"Recebimentos"}),o.jsx(ba,{value:"agendamentos",children:"Agendamentos"}),o.jsx(ba,{value:"relatorios",children:"Relatrios"})]}),o.jsxs(Wi,{value:"visao-geral",className:"space-y-6 mt-6",children:[o.jsxs(fr.div,{variants:Zs,className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[o.jsx(ej,{icon:wH,label:"Total Geral",value:Zt(Number(v||0)+Number(x||0)),color:"brand"}),o.jsx(ej,{icon:U1,label:"Comandas",value:Zt(v),color:"success"}),o.jsx(ej,{icon:gi,label:"Agendamentos",value:Zt(x),color:"success"}),o.jsx(ej,{icon:km,label:"XML (Recebimentos)",value:Zt(T),color:"success"})]}),o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[o.jsx(km,{className:"w-4 h-4 text-brand"}),o.jsx("span",{children:"Proporo de Receita"})]})}),Number(v||0)+Number(x||0)===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem receitas no perodo."}):o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[o.jsx("div",{className:"w-full md:flex-1 h-[280px]",children:o.jsx(_j,{width:"100%",height:"100%",children:o.jsxs(rze,{children:[o.jsxs(qu,{data:function(){const W=Yr(it.from?.[0]??X,it.to?.[0]??X,it.t),Ce=Yr(it.from?.[1]??X,it.to?.[1]??X,it.t);return[{name:"Comandas",value:Number(v||0),fill:"#22C55E",outerRadius:W},{name:"Agendamentos",value:Number(x||0),fill:"#F59E0B",outerRadius:Ce}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:!1,labelLine:!1,isAnimationActive:!0,animationBegin:50,animationDuration:500,startAngle:Pt.start,endAngle:Pt.end,activeIndex:vr,activeShape:void 0,onMouseEnter:(W,Ce)=>Vt(Ce),onMouseLeave:()=>Vt(null),onClick:(W,Ce)=>{Lt(De=>De===Ce?null:Ce),Vt(Ce)},children:[o.jsx(Bb,{fill:"#22C55E",style:Br(0)},"c"),o.jsx(Bb,{fill:"#F59E0B",style:Br(1)},"a")]}),ut({cx:"50%",cy:"50%",outerRadius:92}),o.jsx(qu,{data:function(){const W=Yr(it.from?.[0]??X,it.to?.[0]??X,it.t),Ce=Yr(it.from?.[1]??X,it.to?.[1]??X,it.t);return[{name:"Comandas",value:Number(v||0),fill:"transparent",outerRadius:W},{name:"Agendamentos",value:Number(x||0),fill:"transparent",outerRadius:Ce}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:pt,labelLine:!1,isAnimationActive:!1,startAngle:Pt.start,endAngle:Pt.end}),o.jsx(oc,{formatter:W=>Zt(W),contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 10px",color:"#fff"},labelStyle:{color:"#fff"},itemStyle:{color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.06)"}})]})})}),o.jsx("div",{className:"w-full md:w-64 space-y-3 md:pr-2",children:[{name:"Comandas",value:Number(v||0),color:"#22C55E"},{name:"Agendamentos",value:Number(x||0),color:"#F59E0B"}].map((W,Ce)=>o.jsxs("div",{className:`flex items-center justify-between px-3 py-2 rounded-md transition-all duration-200 ${ht===Ce?"bg-white/5":"hover:bg-white/5"} cursor-pointer ${gr!=null&&gr!==Ce?"opacity-60":""}`,onMouseEnter:()=>Vt(Ce),onMouseLeave:()=>Vt(null),onClick:()=>Lt(De=>De===Ce?null:Ce),role:"button",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-3 h-3 rounded-sm",style:{backgroundColor:W.color}}),o.jsx("span",{className:"text-sm text-text-secondary",children:W.name})]}),o.jsx("div",{className:`text-sm font-semibold ${gr!=null&&gr!==Ce?"opacity-70":""}`,children:Zt(W.value)})]},W.name))})]})]}),o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[o.jsx(km,{className:"w-4 h-4 text-brand"}),o.jsx("span",{children:"Entradas por Finalizadora"})]})}),Sa.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos no perodo."}):o.jsx("div",{className:"h-[280px]",children:o.jsx(_j,{width:"100%",height:"100%",children:o.jsxs(tze,{data:Sa,margin:{top:8,right:8,left:8,bottom:8},children:[o.jsx(A3,{strokeDasharray:"3 3",stroke:"#333"}),o.jsx(eg,{dataKey:"name",stroke:"#aaa"}),o.jsx(tg,{stroke:"#aaa",tickFormatter:W=>Zt(W),width:80}),o.jsx(oc,{formatter:W=>Zt(W),labelFormatter:W=>`Finalizadora: ${W}`,contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 12px",color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.1)"}}),o.jsx(Ep,{}),o.jsx(bg,{dataKey:"valor",name:"Valor",fill:"#fbbf24"})]})})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>q(!0),children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[o.jsx(gd,{className:"w-4 h-4 text-brand"}),o.jsx("span",{children:"Produtos mais vendidos"}),S.length>5&&o.jsx(le,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>q(!0),children:"Ver todos"})]}),b.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):o.jsx("div",{className:"space-y-2",children:b.map((W,Ce)=>o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border last:border-0",children:[o.jsxs("span",{className:"text-sm text-text-primary",children:[Ce+1,". ",W.nome]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-text-secondary",children:Zt(W.valor)}),o.jsxs("span",{className:"text-sm font-bold text-brand",children:["x",W.quantidade]})]})]},Ce))})]}),o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>K(!0),children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[o.jsx(cl,{className:"w-4 h-4 text-brand"}),o.jsx("span",{children:"Clientes (por valor pago)"}),E.length>5&&o.jsx(le,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>K(!0),children:"Ver todos"})]}),j.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):o.jsx("div",{className:"space-y-2",children:j.map((W,Ce)=>o.jsxs("button",{className:"w-full flex items-center justify-between py-2 border-b border-border last:border-0 hover:bg-surface-2 rounded-sm px-2 text-left",onClick:()=>{fe(W),K(!0)},children:[o.jsxs("span",{className:"text-sm text-text-primary",children:[Ce+1,". ",W.nome]}),o.jsx("span",{className:"text-sm font-bold text-success",children:Zt(W.valor)})]},Ce))})]})]})]}),o.jsx(Wi,{value:"agendamentos",className:"space-y-6 mt-6",children:o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[o.jsx("h2",{className:"text-lg font-bold",children:"Agendamentos (Pagamentos por Participante)"}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center",children:[o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar (#cdigo, participante, quadra)",value:It,onChange:W=>Dt(W.target.value),className:"pl-10 pr-10 w-full md:w-[260px] bg-black border-warning/40 text-white placeholder:text-white/60"}),o.jsxs(yc,{open:mt,onOpenChange:Be,children:[o.jsx(bc,{asChild:!0,children:o.jsx(le,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7 p-0 hover:bg-warning/20",title:"Selecionar cliente",children:o.jsx("svg",{className:"h-4 w-4 text-warning",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})}),o.jsx(Ml,{className:"w-[280px] p-2 bg-surface border-border",align:"end",children:o.jsxs("div",{className:"space-y-1 max-h-[300px] overflow-y-auto",children:[o.jsx("div",{className:"text-xs font-semibold text-text-secondary px-2 py-1 sticky top-0 bg-surface z-10",children:"Selecionar Cliente"}),(()=>{const W=new Map;$e.forEach(De=>{const bt=De.participante_nome;bt&&!W.has(bt)&&W.set(bt,{nome:bt,codigo:De.cliente_codigo||0,is_consumidor:De.is_consumidor_final||!1})});const Ce=Array.from(W.values()).sort((De,bt)=>De.is_consumidor!==bt.is_consumidor?De.is_consumidor?1:-1:De.nome.localeCompare(bt.nome));return Ce.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-4",children:"Nenhum participante encontrado"}):Ce.map((De,bt)=>o.jsxs("button",{onClick:()=>{Dt(De.nome),Be(!1)},className:"w-full flex items-center gap-2 px-2 py-2 hover:bg-surface-2 rounded text-left transition-colors",children:[o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-5 px-1 rounded text-[10px] font-bold ${De.codigo===0?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",De.codigo]}),o.jsx("span",{className:"text-sm text-text-primary flex-1 truncate",children:De.nome})]},bt))})()]})})]})]}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[o.jsxs(En,{value:kt,onValueChange:cr,children:[o.jsx(Sn,{className:"w-full md:w-[170px] h-9 bg-black border-warning/40 text-white",children:o.jsx(kn,{placeholder:"Todos os Status"})}),o.jsxs(Cn,{className:"bg-black text-white border-warning/40",children:[o.jsx(Nt,{value:"all",children:"Todos os Status"}),o.jsx(Nt,{value:"Pago",children:"Pago"}),o.jsx(Nt,{value:"Pendente",children:"Pendente"}),o.jsx(Nt,{value:"Cancelado",children:"Cancelado"})]})]}),o.jsxs(En,{value:Cr,onValueChange:Ie,children:[o.jsx(Sn,{className:"w-full md:w-[220px] h-9 bg-black border-warning/40 text-white",children:o.jsx(kn,{placeholder:"Todas as Finalizadoras"})}),o.jsxs(Cn,{className:"bg-black text-white border-warning/40",children:[o.jsx(Nt,{value:"all",children:"Todas as Finalizadoras"}),[...new Set(($e||[]).map(W=>W.finalizadora_nome).filter(Boolean))].map(W=>o.jsx(Nt,{value:W,children:W},W))]})]})]}),o.jsxs(le,{variant:"outline",size:"sm",onClick:()=>{try{const W=";",De=[["Data","Horrio","Cdigo","Representante","Quadra","Participantes","Total","Pago","Pendente","Status"].join(W)];$r.forEach(br=>{const wr=br.inicio?new Date(br.inicio).toLocaleDateString("pt-BR"):"",or=br.inicio&&br.fim?`${new Date(br.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}-${new Date(br.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:"",tn=br.participantes.length,tt=br.participantes.filter(vn=>vn.status_pagamento==="Pago").length,Hr=br.participantes.filter(vn=>vn.status_pagamento==="Pendente").length,un=String(Kr(br.total)).replace(".",","),jn=[wr,or,br.agendamento_codigo??"",(br.representante??"").replace(/"/g,'""'),(br.quadra_nome??"").replace(/"/g,'""'),tn,un,tt,Hr,br.statusGeral??""].map(vn=>`"${vn}"`).join(W);De.push(jn)});const bt="\uFEFF"+De.join(`
`),He=new Blob([bt],{type:"text/csv;charset=utf-8;"}),dt=URL.createObjectURL(He),rr=document.createElement("a");rr.href=dt;const Gr=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"",Rr=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"";rr.download=`agendamentos_${Gr}_a_${Rr}.csv`,document.body.appendChild(rr),rr.click(),document.body.removeChild(rr),URL.revokeObjectURL(dt),e({title:"CSV exportado com sucesso!"})}catch(W){e({title:"Falha ao exportar CSV",description:W?.message,variant:"destructive"})}},children:[o.jsx(ei,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),s?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),o.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):$r.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{className:"w-12"}),o.jsx(yn,{children:"Data/Hora"}),o.jsx(yn,{children:"Cdigo"}),o.jsx(yn,{children:"Representante"}),o.jsx(yn,{children:"Quadra"}),o.jsx(yn,{className:"text-right",children:"Participantes"}),o.jsx(yn,{className:"text-right",children:"Total"}),o.jsx(yn,{children:"Status"})]})}),o.jsx(rl,{children:$r.map(W=>{const Ce=ke.has(W.agendamento_id||W.agendamento_codigo);return o.jsxs(xe.Fragment,{children:[o.jsxs(Fa,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{const De=W.agendamento_id||W.agendamento_codigo;Je(bt=>{const He=new Set(bt);return He.has(De)?He.delete(De):He.add(De),He})},children:[o.jsx(en,{children:o.jsx("div",{className:`transition-transform ${Ce?"rotate-90":""}`,children:""})}),o.jsx(en,{children:W.inicio?o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-text-secondary",children:new Date(W.inicio).toLocaleDateString("pt-BR")}),o.jsxs("span",{className:"font-medium",children:[new Date(W.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),W.fim&&` - ${new Date(W.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`]})]}):""}),o.jsxs(en,{className:"font-semibold",children:["#",W.agendamento_codigo||""]}),o.jsx(en,{children:o.jsxs("div",{className:"flex items-center gap-2",children:[W.representanteCodigo!==null&&W.representanteCodigo!==void 0&&o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[32px] h-6 px-1.5 rounded text-xs font-bold ${W.representanteCodigo===0||W.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",W.representanteCodigo]}),o.jsx("span",{className:"text-text-primary",children:W.representante||""})]})}),o.jsx(en,{children:W.quadra_nome||""}),o.jsx(en,{className:"text-right",children:W.participantes.length}),o.jsx(en,{className:"text-right font-semibold",children:Zt(W.total)}),o.jsx(en,{children:o.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${W.statusGeral==="Pago"?"bg-success/20 text-success":W.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:W.statusGeral==="Parcial"?"Pendente":W.statusGeral})})]}),Ce&&W.participantes.map((De,bt)=>{const He=De.is_consumidor_final?0:De.cliente_codigo??null;return o.jsxs(Fa,{className:"bg-surface-2/30 hover:bg-surface-2/50 transition-colors",children:[o.jsx(en,{}),o.jsx(en,{colSpan:2}),o.jsx(en,{className:"pl-8 text-sm text-text-secondary",children:o.jsxs("div",{className:"flex items-center gap-2",children:[He!=null&&o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${He===0||He==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",He]}),o.jsx("span",{children:De.participante_nome||""})]})}),o.jsx(en,{className:"text-sm text-text-secondary",children:De.finalizadora_nome||""}),o.jsx(en,{}),o.jsx(en,{className:"text-right text-sm font-medium",children:Zt(De.valor_cota)}),o.jsx(en,{className:"text-sm",children:o.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs ${De.status_pagamento==="Pago"?"bg-success/20 text-success":De.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:De.status_pagamento||"Pendente"})})]},`${W.agendamento_codigo}-${bt}`)})]},W.agendamento_id||W.agendamento_codigo)})})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:$r.map(W=>{const Ce=ke.has(W.agendamento_id||W.agendamento_codigo);return o.jsxs("div",{className:"bg-surface-2 rounded-lg overflow-hidden",children:[o.jsxs("div",{className:"p-4 cursor-pointer",onClick:()=>{const De=W.agendamento_id||W.agendamento_codigo;Je(bt=>{const He=new Set(bt);return He.has(De)?He.delete(De):He.add(De),He})},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`transition-transform text-text-secondary ${Ce?"rotate-90":""}`,children:""}),o.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["#",W.agendamento_codigo||""]})]}),o.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${W.statusGeral==="Pago"?"bg-success/20 text-success":W.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:W.statusGeral==="Parcial"?"Pendente":W.statusGeral})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Data:"}),o.jsx("span",{className:"text-text-primary",children:W.inicio?new Date(W.inicio).toLocaleDateString("pt-BR"):""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Horrio:"}),o.jsx("span",{className:"text-text-primary font-medium",children:W.inicio&&W.fim?`${new Date(W.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})} - ${new Date(W.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:""})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-text-secondary",children:"Representante:"}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[W.representanteCodigo!==null&&W.representanteCodigo!==void 0&&o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${W.representanteCodigo===0||W.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",W.representanteCodigo]}),o.jsx("span",{className:"text-text-primary font-medium",children:W.representante||""})]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Quadra:"}),o.jsx("span",{className:"text-text-primary font-medium",children:W.quadra_nome||""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),o.jsx("span",{className:"text-text-primary",children:W.participantes.length})]}),o.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[o.jsx("span",{className:"text-text-secondary",children:"Total:"}),o.jsx("span",{className:"font-bold text-lg text-success",children:Zt(W.total)})]})]})]}),Ce&&o.jsx("div",{className:"border-t border-border/50 bg-surface-2/20",children:W.participantes.map((De,bt)=>{const He=De.is_consumidor_final?0:De.cliente_codigo??null;return o.jsxs("div",{className:"px-4 py-3 border-b border-border/30 last:border-b-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[He!=null&&o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-4 px-1 rounded text-[9px] font-bold ${He===0||He==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",He]}),o.jsx("div",{className:"font-medium text-sm",children:De.participante_nome||""})]}),o.jsx("div",{className:`text-xs px-2 py-0.5 rounded-full ${De.status_pagamento==="Pago"?"bg-success/20 text-success":De.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:De.status_pagamento||"Pendente"})]}),o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{className:"text-text-secondary",children:De.finalizadora_nome||""}),o.jsx("span",{className:"font-semibold text-success",children:Zt(De.valor_cota)})]})]},bt)})})]},W.agendamento_id||W.agendamento_codigo)})})]})]})}),o.jsx(Wi,{value:"caixa",className:"space-y-6 mt-6",children:o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[o.jsx("h3",{className:"text-base font-bold",children:"Fechamentos Anteriores"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(le,{variant:"outline",size:"sm",onClick:Ae,children:[o.jsx(ei,{className:"h-4 w-4 mr-2"})," CSV"]}),o.jsxs(le,{variant:"outline",size:"sm",onClick:dn,children:[o.jsx(Ag,{className:"h-4 w-4 mr-2"})," PDF"]})]})]}),Z.length===0?o.jsx("div",{className:"text-sm text-text-secondary",children:"Nenhum fechamento encontrado."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{children:"Aberto em"}),o.jsx(yn,{children:"Fechado em"}),o.jsx(yn,{className:"text-right",children:"Saldo Inicial"}),o.jsx(yn,{className:"text-right",children:"Saldo Final (contado)"}),o.jsx(yn,{children:"Status"})]})}),o.jsxs(rl,{children:[(()=>{console.log("[FinanceiroPage][Render] Renderizando histrico, total de sesses:",Z.length);const W=Z.filter(Ce=>Ce.valor_final_dinheiro!=null);return console.log("[FinanceiroPage][Render] Sesses com valor_final_dinheiro no render:",W.length),Z.length>0&&console.log("[FinanceiroPage][Render] Primeira sesso no array history:",Z[0]),null})(),Z.map(W=>o.jsxs(Fa,{className:"cursor-pointer hover:bg-surface-2",onClick:async()=>{gt(!0),at(!0),vt(null);try{const Ce=t?.codigo_empresa,De=typeof performance<"u"&&performance.now?performance.now():Date.now();console.log("[Caixa][Fechamento][Open]",{sessaoId:W.id,from:W.aberto_em,to:W.fechado_em,codigo:Ce});let bt=await q_({caixaSessaoId:W.id,codigoEmpresa:Ce}),dt=(Zn=>{if(!Zn)return null;if(Zn.total_bruto!=null||Zn.por_finalizadora!=null){let Mn=Zn.por_finalizadora;if(Mn&&typeof Mn=="string")try{Mn=JSON.parse(Mn)}catch{Mn={}}return{from:Zn.periodo_de||null,to:Zn.periodo_ate||null,totalPorFinalizadora:Mn||{},totalEntradas:Number(Zn.total_entradas||0),totalVendasBrutas:Number(Zn.total_bruto||0),totalDescontos:Number(Zn.total_descontos||0),totalVendasLiquidas:Number(Zn.total_liquido||0)}}return Zn})(bt);dt||(console.log("[Caixa][Fechamento] Snapshot ausente, calculando resumo por perodo..."),dt=await id({from:W.aberto_em,to:W.fechado_em||new Date().toISOString(),codigoEmpresa:Ce}));const rr={...W,saldo_inicial:bt&&typeof bt.saldo_inicial<"u"?Number(bt.saldo_inicial):W.saldo_inicial,saldo_final:bt&&typeof bt.saldo_final<"u"?Number(bt.saldo_final):W.saldo_final};if(!dt||!dt.totalPorFinalizadora||Object.keys(dt.totalPorFinalizadora).length===0)try{const Zn=W.aberto_em,Mn=W.fechado_em||new Date().toISOString();let oa=pe.from("pagamentos").select("metodo, valor, status, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",Zn).lte("recebido_em",Mn);Ce&&(oa=oa.eq("codigo_empresa",Ce));const{data:Dn}=await oa,va={};let on=0;for(const Ea of Dn||[]){if(!((Ea.status||"Pago")!=="Cancelado"&&(Ea.status||"Pago")!=="Estornado"))continue;const ya=Ea.finalizadoras?.nome||Ea.metodo||"Outros",Mo=Number(Ea.valor||0);va[ya]=(va[ya]||0)+Mo,on+=Mo}dt={...dt||{},totalPorFinalizadora:va,totalEntradas:Number(dt?.totalEntradas||0)||on},console.log("[Caixa][Fechamento][FallbackPF]",{methods:Object.keys(va).length})}catch{}const Rr=await Ip({caixaSessaoId:W.id,codigoEmpresa:Ce}),br=bt&&bt.movimentos?bt.movimentos:null,wr=W.aberto_em,or=W.fechado_em||new Date().toISOString();let tn=pe.from("pagamentos").select("id, valor, status, metodo, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",wr).lte("recebido_em",or).order("recebido_em",{ascending:!1});Ce&&(tn=tn.eq("codigo_empresa",Ce));const{data:tt}=await tn;console.log("[Caixa][Fechamento][Pays]",{count:(tt||[]).length});const Hr=bt&&typeof bt.valor_final_dinheiro<"u"?Number(bt.valor_final_dinheiro):null;vt({resumo:dt,movimentacoes:Rr,movimentosAgg:br,pagamentos:tt||[],sessao:rr,valorFinalContado:Hr});const un=typeof performance<"u"&&performance.now?performance.now():Date.now(),jn=Array.isArray(Rr)?Rr.length:0,vn=dt&&dt.totalPorFinalizadora?Object.keys(dt.totalPorFinalizadora).length:0;console.log("[Caixa][Fechamento][Loaded]",{sessaoId:W.id,finCount:vn,movCount:jn,ms:Math.round(un-De)})}catch(Ce){console.error("[Caixa][Fechamento][Error]",{sessaoId:W.id,message:Ce?.message,code:Ce?.code}),e({title:"Falha ao carregar fechamento",description:Ce?.message||"Tente novamente",variant:"destructive"})}finally{at(!1)}},children:[o.jsx(en,{children:W.aberto_em?new Date(W.aberto_em).toLocaleString("pt-BR"):""}),o.jsx(en,{children:W.fechado_em?new Date(W.fechado_em).toLocaleString("pt-BR"):""}),o.jsx(en,{className:"text-right",children:Zt(W.saldo_inicial)}),o.jsx(en,{className:"text-right",children:W.valor_final_dinheiro!=null?Zt(W.valor_final_dinheiro):""}),o.jsx(en,{children:String(W.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]},W.id))]})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:Z.map(W=>o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:async()=>{gt(!0),at(!0),vt(null);try{const Ce=t?.codigo_empresa;let De=await q_({caixaSessaoId:W.id,codigoEmpresa:Ce}),He=(br=>{if(!br)return null;if(br.total_bruto!=null||br.por_finalizadora!=null){let wr=br.por_finalizadora;if(wr&&typeof wr=="string")try{wr=JSON.parse(wr)}catch{wr={}}return{from:br.periodo_de||null,to:br.periodo_ate||null,totalPorFinalizadora:wr||{},totalEntradas:Number(br.total_entradas||0),totalVendasBrutas:Number(br.total_bruto||0),totalDescontos:Number(br.total_descontos||0),totalVendasLiquidas:Number(br.total_liquido||0)}}return br})(De);He||(He=await id({from:W.aberto_em,to:W.fechado_em||new Date().toISOString(),codigoEmpresa:Ce}));const dt={...W,saldo_inicial:De&&typeof De.saldo_inicial<"u"?Number(De.saldo_inicial):W.saldo_inicial,saldo_final:De&&typeof De.saldo_final<"u"?Number(De.saldo_final):W.saldo_final},rr=await Ip({caixaSessaoId:W.id,codigoEmpresa:Ce}),Gr=De&&De.movimentos?De.movimentos:null,Rr=De&&typeof De.valor_final_dinheiro<"u"?Number(De.valor_final_dinheiro):null;vt({resumo:He,movimentacoes:rr,movimentosAgg:Gr,sessao:dt,pagamentos:[],valorFinalContado:Rr})}catch(Ce){console.error("[Caixa][Fechamento][Error]",Ce),e({title:"Erro ao carregar detalhes",description:Ce?.message,variant:"destructive"})}finally{at(!1)}},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["Sesso #",W.id]}),o.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${W.status==="fechado"?"bg-success/20 text-success":"bg-warning/20 text-warning"}`,children:String(W.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Aberto em:"}),o.jsx("span",{className:"text-text-primary",children:W.aberto_em?new Date(W.aberto_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Fechado em:"}),o.jsx("span",{className:"text-text-primary",children:W.fechado_em?new Date(W.fechado_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Saldo Inicial:"}),o.jsx("span",{className:"font-semibold text-info",children:Zt(W.saldo_inicial)})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Saldo Final (contado):"}),o.jsx("span",{className:"font-semibold text-success",children:W.valor_final_dinheiro!=null?Zt(W.valor_final_dinheiro):""})]})]}),o.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},W.id))})]})]})}),o.jsx(Wi,{value:"recebimentos",className:"space-y-6 mt-6",children:o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[o.jsx("h2",{className:"text-lg font-bold",children:"Todos os Recebimentos"}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar...",value:Ze,onChange:W=>ct(W.target.value),className:"pl-10 w-full md:w-[200px]"})]}),o.jsxs(En,{value:ye,onValueChange:te,children:[o.jsx(Sn,{className:"w-full md:w-[160px] h-9 bg-black border-warning/40 text-white",children:o.jsx(kn,{placeholder:"Todas as Fontes"})}),o.jsxs(Cn,{className:"bg-black text-white border-warning/40",children:[o.jsx(Nt,{value:"all",children:"Todas as Fontes"}),o.jsx(Nt,{value:"manual",children:"Manual"}),o.jsx(Nt,{value:"xml",children:"XML"})]})]}),o.jsxs(le,{variant:"outline",size:"sm",onClick:()=>{try{const W=At||[],De=[["Data/Hora","Origem","Fonte","Descrio","Finalizadora","Valor","Status"].join(";")];for(const br of W){const wr=[br.recebido_em?new Date(br.recebido_em).toLocaleString("pt-BR"):"",br.origem??"",br.fonte??"",(br.descricao??"").replaceAll('"','""'),(br.finalizadoras?.nome||br.metodo||"").replaceAll('"','""'),String(Kr(br.valor)).replace(".",","),br.status??""].map(or=>`"${String(or)}"`).join(";");De.push(wr)}const bt="\uFEFF"+De.join(`
`),He=new Blob([bt],{type:"text/csv;charset=utf-8;"}),dt=URL.createObjectURL(He),rr=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR"):"",Gr=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR"):"",Rr=document.createElement("a");Rr.href=dt,Rr.download=`recebimentos_${rr}_a_${Gr}.csv`,document.body.appendChild(Rr),Rr.click(),document.body.removeChild(Rr),URL.revokeObjectURL(dt)}catch(W){e({title:"Falha ao exportar CSV",description:W?.message,variant:"destructive"})}},children:[o.jsx(ei,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),s?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),o.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):At.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{children:"Data/Hora"}),o.jsx(yn,{children:"Origem"}),o.jsx(yn,{children:"Fonte"}),o.jsx(yn,{children:"Descrio"}),o.jsx(yn,{children:"Finalizadora"}),o.jsx(yn,{className:"text-right",children:"Valor"}),o.jsx(yn,{children:"Status"})]})}),o.jsx(rl,{children:At.map(W=>o.jsxs(Fa,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{hr(W),Ee(!0)},children:[o.jsx(en,{children:W.recebido_em?new Date(W.recebido_em).toLocaleString("pt-BR"):""}),o.jsx(en,{children:W.origem||""}),o.jsx(en,{children:W.fonte?W.fonte.toUpperCase():""}),o.jsx(en,{className:"truncate max-w-[260px]",title:W.descricao||"",children:W.descricao||""}),o.jsx(en,{children:W.finalizadoras?.nome||W.metodo||""}),o.jsx(en,{className:"text-right font-semibold",children:Zt(W.valor)}),o.jsx(en,{children:W.status||""})]},W.id))})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:At.map(W=>o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:()=>{hr(W),Ee(!0)},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"text-sm font-semibold text-text-primary",children:W.origem||"Recebimento"}),o.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${W.status==="Pago"?"bg-success/20 text-success":W.status==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:W.status||"Pendente"})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Data/Hora:"}),o.jsx("span",{className:"text-text-primary",children:W.recebido_em?new Date(W.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Fonte:"}),o.jsx("span",{className:"text-text-primary font-medium",children:W.fonte?W.fonte.toUpperCase():""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Finalizadora:"}),o.jsx("span",{className:"text-text-primary",children:W.finalizadoras?.nome||W.metodo||""})]}),W.descricao&&o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:"text-text-secondary",children:"Descrio:"}),o.jsx("span",{className:"text-text-primary text-xs bg-surface/50 p-2 rounded",children:W.descricao})]}),o.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor:"}),o.jsx("span",{className:"font-bold text-lg text-success",children:Zt(W.valor)})]})]}),o.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},W.id))})]})]})}),o.jsxs(Wi,{value:"relatorios",className:"space-y-6 mt-6",children:[o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(Ui,{className:"w-5 h-5 text-success"}),"Faturamento Consolidado"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Resumo geral das receitas no perodo"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(le,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const Ce=[["Mtrica","Valor"],["Receita de Comandas",Zt(v)],["Receita de Agendamentos",Zt(x)],["Receita Total",Zt(Number(v||0)+Number(x||0))],["Perodo",`${c||"N/A"} at ${u||"N/A"}`]].map(dt=>dt.map(rr=>`"${rr}"`).join(";")).join(`
`),De=new Blob(["\uFEFF"+Ce],{type:"text/csv;charset=utf-8;"}),bt=URL.createObjectURL(De),He=document.createElement("a");He.href=bt,He.download=`faturamento_consolidado_${Xt(new Date,"yyyy-MM-dd")}.csv`,He.click(),URL.revokeObjectURL(bt),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ei,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(le,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const W=[["Receita de Comandas",Zt(v)],["Receita de Agendamentos",Zt(x)],["Receita Total",Zt(Number(v||0)+Number(x||0))]];Tr("Faturamento Consolidado",["Mtrica","Valor"],W,"faturamento_consolidado")},children:[o.jsx(Ag,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"p-4 bg-success/5 border border-success/20 rounded-lg",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Comandas"}),o.jsx("div",{className:"text-2xl font-bold text-success",children:Zt(v)}),o.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Vendas no perodo"})]}),o.jsxs("div",{className:"p-4 bg-purple-500/5 border border-purple-500/20 rounded-lg",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Agendamentos"}),o.jsx("div",{className:"text-2xl font-bold text-purple-400",children:Zt(x)}),o.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Reservas pagas"})]}),o.jsxs("div",{className:"p-4 bg-brand/5 border border-brand/20 rounded-lg",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Total"}),o.jsx("div",{className:"text-2xl font-bold text-brand",children:Zt(Number(v||0)+Number(x||0))}),o.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Perodo selecionado"})]})]})]}),o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(km,{className:"w-5 h-5 text-info"}),"Pagamentos por Mtodo"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Distribuio por finalizadora"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(le,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const W=m?.totalPorFinalizadora||{},Ce=Object.entries(W).map(([Rr,br])=>[Rr,Zt(br)]).sort((Rr,br)=>{const wr=Number(String(Rr[1]).replace(/[^\d,]/g,"").replace(",","."));return Number(String(br[1]).replace(/[^\d,]/g,"").replace(",","."))-wr}),De=Object.values(W).reduce((Rr,br)=>Rr+br,0),He=[["Mtodo de Pagamento","Valor","% do Total"],...Ce.map(([Rr,br])=>{const or=((Object.entries(W).find(([tn])=>tn===Rr)?.[1]||0)/De*100).toFixed(1)+"%";return[Rr,br,or]}),["TOTAL",Zt(De),"100%"]].map(Rr=>Rr.map(br=>`"${br}"`).join(";")).join(`
`),dt=new Blob(["\uFEFF"+He],{type:"text/csv;charset=utf-8;"}),rr=URL.createObjectURL(dt),Gr=document.createElement("a");Gr.href=rr,Gr.download=`pagamentos_por_metodo_${Xt(new Date,"yyyy-MM-dd")}.csv`,Gr.click(),URL.revokeObjectURL(rr),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ei,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(le,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const W=m?.totalPorFinalizadora||{},Ce=Object.values(W).reduce((bt,He)=>bt+He,0),De=Object.entries(W).sort(([,bt],[,He])=>He-bt).map(([bt,He])=>[bt,Zt(He),(He/Ce*100).toFixed(1)+"%"]);De.push(["TOTAL",Zt(Ce),"100%"]),Tr("Pagamentos por Mtodo",["Mtodo","Valor","% do Total"],De,"pagamentos_por_metodo")},children:[o.jsx(Ag,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),Object.keys(m?.totalPorFinalizadora||{}).length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{children:"Mtodo de Pagamento"}),o.jsx(yn,{className:"text-right",children:"Valor"}),o.jsx(yn,{className:"text-right",children:"% do Total"})]})}),o.jsxs(rl,{children:[Object.entries(m?.totalPorFinalizadora||{}).sort(([,W],[,Ce])=>Ce-W).map(([W,Ce])=>{const De=Object.values(m?.totalPorFinalizadora||{}).reduce((He,dt)=>He+dt,0),bt=(Ce/De*100).toFixed(1);return o.jsxs(Fa,{children:[o.jsx(en,{className:"font-medium",children:W}),o.jsx(en,{className:"text-right font-semibold",children:Zt(Ce)}),o.jsxs(en,{className:"text-right text-text-secondary",children:[bt,"%"]})]},W)}),o.jsxs(Fa,{className:"bg-surface-2 font-bold",children:[o.jsx(en,{children:"TOTAL"}),o.jsx(en,{className:"text-right",children:Zt(Object.values(m?.totalPorFinalizadora||{}).reduce((W,Ce)=>W+Ce,0))}),o.jsx(en,{className:"text-right",children:"100%"})]})]})]})})]}),o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(gd,{className:"w-5 h-5 text-purple-400"}),"Produtos Mais Vendidos"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Top produtos por faturamento"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(le,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const Ce=[["Posio","Produto","Faturamento"],...S.slice(0,50).map((dt,rr)=>[rr+1,dt.nome,Zt(dt.valor)])].map(dt=>dt.map(rr=>`"${rr}"`).join(";")).join(`
`),De=new Blob(["\uFEFF"+Ce],{type:"text/csv;charset=utf-8;"}),bt=URL.createObjectURL(De),He=document.createElement("a");He.href=bt,He.download=`produtos_vendidos_${Xt(new Date,"yyyy-MM-dd")}.csv`,He.click(),URL.revokeObjectURL(bt),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ei,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(le,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const W=S.slice(0,50).map((Ce,De)=>[De+1,Ce.nome,Zt(Ce.valor)]);Tr("Produtos Mais Vendidos",["#","Produto","Faturamento"],W,"produtos_vendidos")},children:[o.jsx(Ag,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),S.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem produtos vendidos no perodo."}):o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{className:"w-16",children:"#"}),o.jsx(yn,{children:"Produto"}),o.jsx(yn,{className:"text-right",children:"Faturamento"})]})}),o.jsx(rl,{children:S.slice(0,20).map((W,Ce)=>o.jsxs(Fa,{children:[o.jsx(en,{className:"text-text-secondary font-mono",children:Ce+1}),o.jsx(en,{className:"font-medium",children:W.nome}),o.jsx(en,{className:"text-right font-semibold",children:Zt(W.valor)})]},`${W.nome}-${Ce}`))})]}),S.length>20&&o.jsx("div",{className:"text-center mt-4",children:o.jsxs(le,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>q(!0),children:["Ver todos os ",S.length," produtos"]})})]})]}),o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(cl,{className:"w-5 h-5 text-warning"}),"Clientes que Mais Consomem"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Ranking por faturamento total"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(le,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const Ce=[["Posio","Cliente","Faturamento"],...E.slice(0,50).map((dt,rr)=>[rr+1,dt.nome,Zt(dt.valor)])].map(dt=>dt.map(rr=>`"${rr}"`).join(";")).join(`
`),De=new Blob(["\uFEFF"+Ce],{type:"text/csv;charset=utf-8;"}),bt=URL.createObjectURL(De),He=document.createElement("a");He.href=bt,He.download=`clientes_top_${Xt(new Date,"yyyy-MM-dd")}.csv`,He.click(),URL.revokeObjectURL(bt),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ei,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(le,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const W=E.slice(0,50).map((Ce,De)=>[De+1,Ce.nome,Zt(Ce.valor)]);Tr("Clientes que Mais Consomem",["#","Cliente","Total Gasto"],W,"clientes_top")},children:[o.jsx(Ag,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),E.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de clientes no perodo."}):o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{className:"w-16",children:"#"}),o.jsx(yn,{children:"Cliente"}),o.jsx(yn,{className:"text-right",children:"Total Gasto"})]})}),o.jsx(rl,{children:E.slice(0,20).map((W,Ce)=>o.jsxs(Fa,{children:[o.jsx(en,{className:"text-text-secondary font-mono",children:Ce+1}),o.jsx(en,{className:"font-medium",children:W.nome}),o.jsx(en,{className:"text-right font-semibold",children:Zt(W.valor)})]},`${W.nome}-${Ce}`))})]}),E.length>20&&o.jsx("div",{className:"text-center mt-4",children:o.jsxs(le,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>K(!0),children:["Ver todos os ",E.length," clientes"]})})]})]}),o.jsxs(fr.div,{variants:Zs,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(Wp,{className:"w-5 h-5 text-success"}),"Evoluo Diria de Receitas"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Faturamento dia a dia no perodo"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(le,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const Ce=[["Data","Receita"],...M.map(dt=>[dt.data,Zt(dt.valor)])].map(dt=>dt.map(rr=>`"${rr}"`).join(";")).join(`
`),De=new Blob(["\uFEFF"+Ce],{type:"text/csv;charset=utf-8;"}),bt=URL.createObjectURL(De),He=document.createElement("a");He.href=bt,He.download=`evolucao_diaria_${Xt(new Date,"yyyy-MM-dd")}.csv`,He.click(),URL.revokeObjectURL(bt),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ei,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(le,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const W=M.map(Ce=>[Ce.data,Zt(Ce.valor)]);Tr("Evoluo Diria de Receitas",["Data","Receita"],W,"evolucao_diaria")},children:[o.jsx(Ag,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),M.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de evoluo no perodo."}):o.jsx("div",{className:"h-80",children:o.jsx(_j,{width:"100%",height:"100%",children:o.jsxs(eze,{data:M,margin:{top:5,right:20,bottom:5,left:0},children:[o.jsx(A3,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),o.jsx(eg,{dataKey:"data",stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:W=>{const Ce=W.split("/");return`${Ce[0]}/${Ce[1]}`}}),o.jsx(tg,{stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:W=>`R$ ${(W/1e3).toFixed(0)}k`}),o.jsx(oc,{contentStyle:{backgroundColor:"#1a1a1a",border:"1px solid #333",borderRadius:"8px"},labelStyle:{color:"#fff"},itemStyle:{color:"#22C55E"},formatter:W=>[Zt(W),"Receita"]}),o.jsx(ow,{type:"monotone",dataKey:"valor",stroke:"#22C55E",strokeWidth:2,dot:{fill:"#22C55E",r:4},activeDot:{r:6}})]})})})]})]})]}),o.jsx(ln,{open:$t,onOpenChange:Ee,children:o.jsxs(sn,{className:"max-w-lg",children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-xl font-bold",children:"Detalhes do Recebimento"}),o.jsx(_n,{children:Ct?.origem==="Comanda"?"Operao de comanda":Ct?.origem==="Agendamento"?"Operao de agendamento":"Operao"})]}),Ct&&o.jsxs("div",{className:"space-y-3 text-sm",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Data/Hora"}),o.jsx("div",{className:"font-medium",children:Ct.recebido_em?new Date(Ct.recebido_em).toLocaleString("pt-BR"):""})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Valor"}),o.jsx("div",{className:"font-semibold",children:Zt(Ct.valor)})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Origem"}),o.jsx("div",{children:Ct.origem||""})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Fonte"}),o.jsx("div",{children:Ct.fonte?Ct.fonte.toUpperCase():""})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Finalizadora"}),o.jsx("div",{children:Ct.finalizadoras?.nome||Ct.metodo||""})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Status"}),o.jsx("div",{children:Ct.status||""})]})]}),Ct.origem==="Comanda"&&o.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[o.jsx("div",{className:"font-semibold mb-2",children:"Comanda"}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Cliente"}),o.jsx("div",{children:Ct.descricao||""})]})}),o.jsxs("div",{className:"mt-3",children:[o.jsx("div",{className:"text-text-muted mb-1",children:"Produtos"}),Or?o.jsx("div",{className:"text-xs text-text-muted",children:"Carregando itens..."}):Mr.length===0?o.jsx("div",{className:"text-xs text-text-muted",children:"Sem itens encontrados."}):o.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:Mr.map((W,Ce)=>o.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[o.jsxs("div",{className:"truncate",children:[o.jsx("span",{className:"font-mono",children:Kr(W.quantidade)}),o.jsx("span",{children:" x "}),o.jsx("span",{className:"font-medium",children:W.descricao})]}),o.jsx("div",{className:"whitespace-nowrap",children:Zt(Number(W.preco_unitario||0)*Number(W.quantidade||0))})]},Ce))})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("div",{className:"text-text-muted mb-1",children:"Pagamentos"}),Ir.length===0?o.jsx("div",{className:"text-xs text-text-muted",children:"Sem pagamentos adicionais."}):o.jsxs("div",{className:"space-y-1",children:[Ir.map((W,Ce)=>o.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[o.jsx("div",{className:"truncate",children:o.jsx("span",{className:"font-medium",children:W.finalizadoras?.nome||W.metodo||""})}),o.jsx("div",{className:"whitespace-nowrap",children:Zt(W.valor)})]},W.id||Ce)),o.jsxs("div",{className:"text-xs flex justify-between gap-3 pt-2 border-t border-border",children:[o.jsx("div",{className:"font-semibold",children:"Total"}),o.jsx("div",{className:"font-semibold",children:Zt(Ir.reduce((W,Ce)=>W+Number(Ce.valor||0),0))})]})]})]})]}),Ct.origem==="Agendamento"&&o.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[o.jsx("div",{className:"font-semibold mb-2",children:"Agendamento"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Cdigo"}),o.jsxs("div",{className:"font-mono",children:["#",Ct.agendamento_codigo]})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Participante"}),o.jsx("div",{children:Ct.participante_nome})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("div",{className:"text-text-muted",children:"Quadra"}),o.jsx("div",{children:Ct.quadra_nome||""})]})]})]})]})]})}),o.jsx(ln,{open:z,onOpenChange:q,children:o.jsxs(sn,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Todos os Produtos"}),o.jsx(_n,{children:"Ordenados por valor de vendas"})]}),o.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{children:"Produto"}),o.jsx(yn,{className:"text-center",children:"Quantidade"}),o.jsx(yn,{className:"text-right",children:"Valor Total"})]})}),o.jsx(rl,{children:S.map((W,Ce)=>o.jsxs(Fa,{children:[o.jsxs(en,{children:[Ce+1,". ",W.nome]}),o.jsxs(en,{className:"text-center",children:["x",W.quantidade]}),o.jsx(en,{className:"text-right font-semibold",children:Zt(W.valor)})]},`${W.nome}-${Ce}`))})]})})]})}),o.jsx(ln,{open:lt,onOpenChange:gt,children:o.jsxs(sn,{className:"sm:max-w-[900px] w-full max-h-[85vh] overflow-y-auto bg-surface text-text-primary border-0",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Fechamento do Caixa"}),o.jsxs(_n,{children:[yt?.sessao?.aberto_em?`${new Date(yt.sessao.aberto_em).toLocaleString("pt-BR")}`:"",yt?.sessao?.fechado_em?`  ${new Date(yt.sessao.fechado_em).toLocaleString("pt-BR")}`:""]})]}),Te?o.jsx("div",{className:"text-sm text-text-muted",children:"Carregando..."}):yt?o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),o.jsx("p",{className:"text-2xl font-bold tabular-nums",children:Zt(yt.sessao?.saldo_inicial)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Total do Dia"}),o.jsx("p",{className:"text-2xl font-bold text-success tabular-nums",children:(()=>{const W=Number(yt.resumo?.totalEntradas||0),Ce=Array.isArray(yt.movimentacoes)?yt.movimentacoes:[];let De=0,bt=0,He=0,dt=0;for(const Gr of Ce){const Rr=String(Gr?.tipo||"").toLowerCase(),br=Number(Gr?.valor||0);Rr==="suprimento"?De+=br:Rr==="sangria"?bt+=br:Rr==="troco"?He+=br:Rr==="ajuste"&&(dt+=br)}const rr=W+De+dt-bt-He;return Zt(rr)})()})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),o.jsx("p",{className:"text-2xl font-bold tabular-nums",children:(()=>{const W=yt&&typeof yt.valorFinalContado=="number"?yt.valorFinalContado:null;return W!=null?Zt(W):""})()})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),o.jsx("p",{className:"text-2xl font-bold text-warning tabular-nums",children:Zt(yt.resumo?.totalDescontos)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),o.jsx("p",{className:"text-2xl font-bold tabular-nums",children:Zt(yt.resumo?.totalVendasLiquidas)})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Entradas por Finalizadora"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:yt.resumo?.totalPorFinalizadora&&Object.keys(yt.resumo.totalPorFinalizadora).length>0?Object.entries(yt.resumo.totalPorFinalizadora).map(([W,Ce])=>o.jsxs("div",{className:"bg-surface-2 rounded-md p-2 border border-border flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate",children:String(W)}),o.jsx("span",{className:"text-sm font-semibold",children:Zt(Ce)})]},W)):o.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos."})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Movimentaes"}),!yt.movimentacoes||yt.movimentacoes.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes nesta sesso."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{children:"Data"}),o.jsx(yn,{children:"Tipo"}),o.jsx(yn,{children:"Obs"}),o.jsx(yn,{className:"text-right",children:"Valor"})]})}),o.jsx(rl,{children:yt.movimentacoes.map(W=>o.jsxs(Fa,{children:[o.jsx(en,{children:W.created_at?new Date(W.created_at).toLocaleString("pt-BR"):""}),o.jsx(en,{className:"capitalize",children:W.tipo||""}),o.jsx(en,{className:"truncate max-w-[280px]",title:W.observacao||"",children:W.observacao||""}),o.jsx(en,{className:"text-right font-semibold",children:Zt(W.valor)})]},W.id))})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Recebimentos"}),!yt.pagamentos||yt.pagamentos.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem recebimentos no perodo deste caixa."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{children:"Data/Hora"}),o.jsx(yn,{children:"Finalizadora"}),o.jsx(yn,{className:"text-right",children:"Valor"}),o.jsx(yn,{children:"Status"})]})}),o.jsx(rl,{children:yt.pagamentos.map(W=>o.jsxs(Fa,{children:[o.jsx(en,{children:W.recebido_em?new Date(W.recebido_em).toLocaleString("pt-BR"):""}),o.jsx(en,{children:W.finalizadoras?.nome||W.metodo||""}),o.jsx(en,{className:"text-right font-semibold",children:Zt(W.valor)}),o.jsx(en,{children:W.status||""})]},W.id))})]})})]})]}):o.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados."})]})}),o.jsx(ln,{open:$,onOpenChange:W=>{K(W),W||(fe(null),L([]))},children:o.jsxs(sn,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Clientes"}),o.jsx(_n,{children:"Ordenados por valor pago no perodo selecionado"})]}),o.jsx("div",{className:"max-h-[60vh] overflow-y-auto border border-border rounded-md",children:o.jsxs(el,{children:[o.jsx(tl,{children:o.jsxs(Fa,{children:[o.jsx(yn,{children:"Cliente"}),o.jsx(yn,{className:"text-right",children:"Pago"})]})}),o.jsx(rl,{children:E.map((W,Ce)=>o.jsxs(Fa,{className:"cursor-pointer hover:bg-brand/10",onClick:async()=>{G(!0),fe(W),re(!0);try{const De=Tn(c),bt=Qn(u),He=(W.nome||"").trim(),dt=t?.codigo_empresa;let rr=pe.from("clientes").select("id, nome").eq("codigo_empresa",dt).ilike("nome",`%${He}%`);const{data:Gr}=await rr,Rr=new Set((Gr||[]).map(Mn=>Mn.id));let br=pe.from("comanda_clientes").select("comanda_id").eq("codigo_empresa",dt).ilike("nome_livre",`%${He}%`);const{data:wr}=await br;let or=new Set((wr||[]).map(Mn=>Mn.comanda_id));if(Rr.size>0){let Mn=pe.from("comanda_clientes").select("comanda_id, cliente_id").eq("codigo_empresa",dt).in("cliente_id",Array.from(Rr));const{data:oa}=await Mn;(oa||[]).forEach(Dn=>or.add(Dn.comanda_id))}const tn=Array.from(or);let tt=pe.from("pagamentos").select("id, valor, recebido_em, metodo, finalizadoras!pagamentos_finalizadora_id_fkey(nome), comanda_id, status").in("comanda_id",tn).neq("status","Cancelado").neq("status","Estornado").order("recebido_em",{ascending:!1}).limit(50);De&&(tt=tt.gte("recebido_em",De)),bt&&(tt=tt.lte("recebido_em",bt));const{data:Hr}=await tt,un=Hr||[],jn=Array.from(new Set(un.map(Mn=>Mn.comanda_id).filter(Boolean))),vn={};if(jn.length>0){let Mn=pe.from("comandas").select("id, tipo, mesa_id").in("id",jn);const{data:oa}=await Mn,Dn=Array.from(new Set((oa||[]).map(on=>on.mesa_id).filter(Boolean))),va={};if(Dn.length>0){let on=pe.from("mesas").select("id, numero, nome").in("id",Dn);const{data:Ea}=await on;(Ea||[]).forEach(Ca=>{va[Ca.id]=(Ca.nome||`Mesa ${Ca.numero||""}`).trim()})}(oa||[]).forEach(on=>{let Ea="";const Ca=String(on?.tipo||"").toLowerCase();Ca==="balcao"||Ca==="balco"?Ea="Balco":Ca==="mesa"||on.mesa_id?Ea=va[on.mesa_id]||"Mesa":Ca==="agendamento"&&(Ea="Agendamento"),vn[on.id]=Ea})}let Zn=un.map(Mn=>({...Mn,origem:Mn.comanda_id&&vn[Mn.comanda_id]||""}));try{const Mn=t?.codigo_empresa;let oa=[];if(Rr&&Rr.size>0){let ya=pe.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(Rr));Mn&&(ya=ya.eq("codigo_empresa",Mn));const{data:Mo}=await ya;if(oa=Mo||[],oa.length===0&&Mn){let vi=pe.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(Rr));const{data:oo}=await vi;oa=oo||[]}}let Dn=[...oa];const va=Array.from(new Set(Dn.map(ya=>ya.agendamento_id).filter(Boolean)));let on=new Set;const Ea={};if(va.length>0){let ya=pe.from("agendamentos").select("id, inicio").in("id",va);Mn&&(ya=ya.eq("codigo_empresa",Mn));const{data:Mo}=await ya,vi=De?new Date(De).getTime():null,oo=bt?new Date(bt).getTime():null;(Mo||[]).forEach(zl=>{const yl=zl?.inicio?new Date(zl.inicio).getTime():null;yl!=null&&(vi==null||yl>=vi)&&(oo==null||yl<=oo)&&on.add(zl.id),zl?.id&&(Ea[zl.id]=zl.inicio||null)})}Dn=Dn.filter(ya=>on.has(ya.agendamento_id));const Ca=new Set;console.debug("[Financeiro][Agendamentos][Detalhe] encontrados:",Dn.length),Dn.forEach(ya=>{const Mo=`${ya.id}`;if(Ca.has(Mo))return;Ca.add(Mo);const vi=String(ya.status_pagamento||ya.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(vi))return;const oo=ya.finalizadora_nome||ya.metodo||ya.metodo_pagamento||ya.forma_pagamento||"Agendamento";Zn.push({id:`ag-${ya.id}`,recebido_em:Ea[ya.agendamento_id]||null,finalizadoras:oo?{nome:oo}:null,metodo:oo,origem:"Agendamento",valor:ya.valor_cota})})}catch{}L(Zn)}finally{re(!1)}},children:[o.jsx(en,{children:W.nome}),o.jsx(en,{className:"text-right font-semibold",children:Zt(W.valor)})]},`${W.nome}-${Ce}`))})]})})]})}),o.jsx(ln,{open:me,onOpenChange:G,children:o.jsxs(sn,{className:"max-w-5xl w-[95vw] md:w-[90vw] max-h-[85vh] bg-surface text-text-primary border-0 overflow-hidden flex flex-col",children:[o.jsxs(an,{className:"flex-shrink-0",children:[o.jsx(nn,{className:"text-lg md:text-xl",children:"Detalhes do Cliente"}),o.jsx(_n,{className:"text-sm md:text-base",children:ce?.nome})]}),ce?o.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 bg-surface-2 rounded-lg flex-shrink-0",children:[o.jsx("span",{className:"text-sm md:text-base text-text-secondary",children:"Total Pago no Perodo"}),o.jsx("span",{className:"text-lg md:text-2xl font-bold text-success",children:Zt(ce.valor)})]}),V?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Carregando detalhes..."}):B.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo selecionado."}):o.jsx("div",{className:"flex-1 overflow-auto border border-border rounded-md",children:o.jsxs(el,{children:[o.jsx(tl,{className:"sticky top-0 bg-surface z-10",children:o.jsxs(Fa,{children:[o.jsx(yn,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:"Data"}),o.jsx(yn,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:"Finaliz."}),o.jsx(yn,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:"Origem"}),o.jsx(yn,{className:"text-right text-xs md:text-sm w-[70px] md:w-auto",children:"Valor"})]})}),o.jsx(rl,{children:B.map(W=>o.jsxs(Fa,{children:[o.jsx(en,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:o.jsx("div",{className:"text-[10px] md:text-xs leading-tight",children:W.recebido_em?new Date(W.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):""})}),o.jsx(en,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:o.jsx("div",{className:"truncate max-w-[80px] md:max-w-[200px] text-[10px] md:text-xs",title:W.finalizadoras?.nome||W.metodo||"",children:W.finalizadoras?.nome||W.metodo||""})}),o.jsx(en,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:o.jsx("div",{className:"truncate max-w-[60px] md:max-w-[150px] text-[10px] md:text-xs",title:W.origem||"",children:W.origem||""})}),o.jsx(en,{className:"text-right font-semibold text-xs md:text-sm w-[70px] md:w-auto",children:o.jsx("div",{className:"text-[10px] md:text-xs whitespace-nowrap",children:Zt(W.valor)})})]},W.id))})]})})]}):o.jsx("div",{className:"text-sm text-text-muted py-8 text-center",children:"Nenhum cliente selecionado"})]})})]})})}const eit={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},gR={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function tit({children:e,className:t=""}){return o.jsx(fr.div,{variants:gR,className:`fx-card ${t}`,children:e})}const EE=({icon:e,title:t,value:r,subtitle:n,color:a})=>{const i=e;return o.jsxs(fr.div,{variants:gR,className:"bg-surface rounded-lg border-2 border-border hover:border-border-hover p-4 flex flex-col justify-between gap-2 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("p",{className:"text-text-secondary text-sm font-semibold",children:t}),o.jsx(i,{className:`w-5 h-5 ${a}`})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r}),o.jsx("p",{className:"text-xs text-text-muted",children:n})]})]})};function jU({label:e,...t}){return o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:e}),o.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function rit(){const{toast:e}=ro(),{userProfile:t,authReady:r}=Do(),n=p.useRef(!1),[a,i]=p.useState(()=>{try{const se=JSON.parse(localStorage.getItem("quadras:list")||"[]");return Array.isArray(se)?se:[]}catch{return[]}}),[s,l]=p.useState(()=>{try{const se=JSON.parse(localStorage.getItem("quadras:list")||"[]");return!(Array.isArray(se)&&se.length>0)}catch{return!0}}),[c,d]=p.useState(!1),[u,f]=p.useState(!1),[m,h]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[v,g]=p.useState(""),[x,y]=p.useState(!1),[b,w]=p.useState(null),[j,_]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[S,k]=p.useState(""),[E,A]=p.useState(!0),[M,C]=p.useState({mostUsed:"-",topClient:"-",totalBookings:"-"}),[T,I]=p.useState(!1),[D,F]=p.useState(null),[z,q]=p.useState({0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0}),[$,K]=p.useState([]),[ce,fe]=p.useState(""),[B,L]=p.useState(""),[V,re]=p.useState(!1),me=se=>{if(!se)return null;const[Ze,ct]=String(se).split(":");return`${Ze.padStart(2,"0")}:${ct.padStart(2,"0")}:00`},G=se=>{const Ze=String(se??"").replace(/\D/g,"");if(!Ze)return"";const ct=(Number(Ze)/100).toFixed(2),[Qt,we]=ct.split(".");return`${Qt.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${we}`},Q=se=>{if(se==null||se==="")return NaN;const Ze=String(se).replace(/\./g,"").replace(",","."),ct=parseFloat(Ze);return Number.isFinite(ct)?ct:NaN},ae=(se,Ze=!1)=>{if(se==null||!Number.isFinite(Number(se)))return"-";const Qt=Number(se).toFixed(2).split("."),we=Qt[0],ye=Qt[1],$e=`${we.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${ye}`;return Ze?`R$ ${$e}`:$e},J=se=>{if(!se)return"";const[Ze,ct]=String(se).split(":");return`${String(Ze).padStart(2,"0")}:${String(ct).padStart(2,"0")}`},je=se=>{if(!se)return 0;const[Ze,ct]=String(se).split(":").map(Number);return(Ze===0&&ct===0?24:Ze||0)*60+(ct||0)},be=se=>{if(!se)return!1;const Ze=String(se).split(":");if(Ze.length<2)return!1;const ct=Number(Ze[1]);return ct===0||ct===30},Ue=se=>{if(!se)return"";const[Ze,ct]=String(se).split(":");let Qt=Math.max(0,Math.min(23,parseInt(Ze||"0",10))),we=Math.max(0,Math.min(59,parseInt(ct||"0",10)));const ye=Math.round(we/30);if(ye>=2?(Qt+=1,we=0):we=ye*30,Qt>=24)return"23:59";const te=String(Qt).padStart(2,"0"),$e=String(we).padStart(2,"0");return`${te}:${$e}`};p.useEffect(()=>{if(!c)return;const se=setTimeout(()=>{console.error("[Quadras] add/update stuck >15s",{route:"/quadras",codigo_empresa:t?.codigo_empresa,editingId:b,formQuadra:m,editForm:j})},15e3);return()=>clearTimeout(se)},[c,t?.codigo_empresa,b,m,j]);const Z=async()=>{if(!t?.codigo_empresa)return;const se=a&&a.length>0;se||l(!0);const{data:Ze,error:ct}=await pe.from("quadras").select("*").eq("codigo_empresa",t.codigo_empresa).order("nome",{ascending:!0});if(ct){if(!n.current){n.current=!0,setTimeout(Z,800),se||l(!1);return}e({title:"Erro ao carregar quadras",description:ct.message}),se||l(!1);return}const Qt=Ze||[];if(Qt.length===0&&se&&!n.current){n.current=!0,setTimeout(Z,600),se||l(!1);return}n.current=!1,i(Qt);try{localStorage.setItem("quadras:list",JSON.stringify(Qt))}catch{}se||l(!1)},Y=se=>{w(se.id),_({nome:se.nome||"",descricao:se.descricao||"",modalidades:Array.isArray(se.modalidades)?se.modalidades:se.modalidades?[se.modalidades]:[],tipo:se.tipo||"Descoberta",status:se.status||"Ativa",hora_inicio:J(se.hora_inicio||"06:00:00"),hora_fim:J(se.hora_fim||"24:00:00")||"23:59",valor_hora:se.valor!=null&&se.valor!==""?G(String((Number(se.valor)*2).toFixed(2))):""}),k(""),y(!0)},lt=async()=>{if(!j.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."});return}if(!j.hora_inicio||!j.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!be(j.hora_inicio)||!be(j.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(je(j.hora_fim)<=je(j.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!j.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!t?.codigo_empresa||!b){e({title:"Atualizao indisponvel",description:"Dados insuficientes para atualizar."});return}d(!0);const se={nome:j.nome.trim(),descricao:j.descricao?.trim()||null,modalidades:j.modalidades,tipo:j.tipo,status:j.status,hora_inicio:me(j.hora_inicio),hora_fim:me(j.hora_fim==="24:00"?"23:59":j.hora_fim)};if(j.valor_hora!=null&&String(j.valor_hora).trim()!==""){const we=Q(j.valor_hora);!Number.isNaN(we)&&Number.isFinite(we)&&(se.valor=Math.round(we/2*100)/100)}else se.valor=null;const Ze=(we,ye)=>Promise.race([we,new Promise((te,$e)=>setTimeout(()=>$e(new Error("Timeout ao atualizar quadra (>12s)")),ye))]);let ct,Qt;try{({data:ct,error:Qt}=await Ze(pe.from("quadras").update(se).eq("codigo_empresa",t.codigo_empresa).eq("id",b).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch(we){console.error("update timeout/error",we),e({title:"Tempo excedido",description:"Sem resposta do servidor ao atualizar. Verifique conexo e tente novamente."}),d(!1);return}if(d(!1),Qt){e({title:"Erro ao atualizar quadra",description:Qt.message});return}if(!ct){await Z(),e({title:"Quadra atualizada",description:`${se.nome} foi atualizada.`}),y(!1),w(null),k("");return}e({title:"Quadra atualizada",description:`${ct.nome} foi atualizada.`}),y(!1),w(null),k(""),i(we=>we.map(ye=>ye.id===ct.id?ct:ye).sort((ye,te)=>ye.nome.localeCompare(te.nome)))};p.useEffect(()=>{try{const se=JSON.parse(localStorage.getItem("quadras:list")||"[]");Array.isArray(se)&&se.length&&a.length===0&&(i(se),l(!1))}catch{}},[]),p.useEffect(()=>{r&&t?.codigo_empresa&&(Z(),gt())},[r,t?.codigo_empresa]);const gt=async()=>{if(t?.codigo_empresa)try{const se=new Date;se.setDate(se.getDate()-30);const{data:Ze}=await pe.from("agendamentos").select("quadra_id, cliente_id, quadras!inner(nome), clientes(nome, codigo)").eq("codigo_empresa",t.codigo_empresa).gte("inicio",se.toISOString()).neq("status","canceled");if(!Ze||Ze.length===0){C({mostUsed:"Sem dados",topClient:"Sem dados",totalBookings:"0"});return}const ct={};Ze.forEach(te=>{const $e=te.quadras?.nome||"Sem nome";ct[$e]=(ct[$e]||0)+1});const Qt=Object.entries(ct).sort((te,$e)=>$e[1]-te[1])[0],we={};Ze.forEach(te=>{if(te.cliente_id&&te.clientes?.nome){const $e=te.clientes?.codigo;if($e===0||$e==="0")return;const Pe=te.clientes.nome;we[Pe]=(we[Pe]||0)+1}});const ye=Object.entries(we).sort((te,$e)=>$e[1]-te[1])[0];C({mostUsed:Qt?`${Qt[0]} (${Qt[1]})`:"Sem dados",topClient:ye?`${ye[0]} (${ye[1]})`:"Sem dados",totalBookings:Ze.length.toString()})}catch(se){console.error("Erro ao carregar stats:",se),C({mostUsed:"Erro",topClient:"Erro",totalBookings:"0"})}},Te=async()=>{if(console.groupCollapsed("[Quadras] addQuadra: CLICK"),console.time("[Quadras] addQuadra duration"),console.log("pre-validate",{codigo_empresa:t?.codigo_empresa,formQuadra:m}),!m.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."}),console.warn("validation: missing nome"),console.groupEnd();return}if(!m.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!m.hora_inicio||!m.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!be(m.hora_inicio)||!be(m.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(je(m.hora_fim)<=je(m.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!t?.codigo_empresa){e({title:"Empresa no localizada",description:"Associe o usurio a uma empresa para cadastrar quadras."});return}d(!0),console.log("validated, building payload");const se={codigo_empresa:t.codigo_empresa,nome:m.nome.trim(),descricao:m.descricao?.trim()||null,modalidades:m.modalidades,tipo:m.tipo,status:m.status,hora_inicio:me(m.hora_inicio),hora_fim:me(m.hora_fim==="24:00"?"23:59":m.hora_fim)};if(m.valor_hora!=null&&String(m.valor_hora).trim()!==""){const we=Q(m.valor_hora);!Number.isNaN(we)&&Number.isFinite(we)&&(se.valor=Math.round(we/2*100)/100)}console.log("payload",se);const Ze=(we,ye)=>Promise.race([we,new Promise((te,$e)=>setTimeout(()=>$e(new Error("Timeout ao inserir quadra (>12s)")),ye))]);let ct,Qt;try{({data:ct,error:Qt}=await Ze(pe.from("quadras").insert(se).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch(we){d(!1),console.error("insert timeout/error",we),e({title:"Tempo excedido",description:"Sem resposta do servidor ao cadastrar. Verifique conexo e tente novamente."}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(d(!1),Qt){e({title:"Erro ao cadastrar quadra",description:Qt.message}),console.error("insert error",{code:Qt.code,message:Qt.message,details:Qt.details}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(!ct){console.warn("insert success sem representao; recarregando lista"),await Z(),e({title:"Quadra adicionada",description:`${se.nome} foi cadastrada.`}),h({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}console.log("insert success",{id:ct?.id,nome:ct?.nome}),e({title:"Quadra adicionada",description:`${ct.nome} foi cadastrada.`}),h({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),i(we=>[ct,...we].sort((ye,te)=>ye.nome.localeCompare(te.nome))),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd()},at=async se=>{F(se),re(!0);try{const{data:Ze,error:ct}=await pe.from("quadras_dias_funcionamento").select("*").eq("quadra_id",se.id).eq("codigo_empresa",t.codigo_empresa);if(ct)throw ct;const Qt={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0},we=[];Ze?.forEach(ye=>{ye.tipo==="dia_semana"?Qt[ye.dia_semana]=ye.funciona:ye.tipo==="data_fechamento"&&we.push(ye)}),q(Qt),K(we),I(!0)}catch(Ze){console.error("Erro ao carregar dias de funcionamento:",Ze),e({title:"Erro",description:"No foi possvel carregar as configuraes."})}finally{re(!1)}},yt=async()=>{if(D){re(!0);try{await pe.from("quadras_dias_funcionamento").delete().eq("quadra_id",D.id).eq("tipo","dia_semana");const se=Object.entries(z).map(([ct,Qt])=>({quadra_id:D.id,codigo_empresa:t.codigo_empresa,tipo:"dia_semana",dia_semana:parseInt(ct),funciona:Qt,observacao:"Configurao de dias da semana"})),{error:Ze}=await pe.from("quadras_dias_funcionamento").insert(se);if(Ze)throw Ze;e({title:"Sucesso",description:"Dias da semana salvos com sucesso!"})}catch(se){console.error("Erro ao salvar dias da semana:",se),e({title:"Erro",description:"No foi possvel salvar as configuraes."})}finally{re(!1)}}},vt=async()=>{if(!(!D||!ce)){re(!0);try{const{data:se,error:Ze}=await pe.from("quadras_dias_funcionamento").insert({quadra_id:D.id,codigo_empresa:t.codigo_empresa,tipo:"data_fechamento",data_fechamento:ce,funciona:!1,observacao:B||"Fechamento especial"}).select().single();if(Ze)throw Ze;K(ct=>[...ct,se]),fe(""),L(""),e({title:"Sucesso",description:"Data de fechamento adicionada!"})}catch(se){console.error("Erro ao adicionar data de fechamento:",se),e({title:"Erro",description:"No foi possvel adicionar a data de fechamento."})}finally{re(!1)}}},Sr=async se=>{re(!0);try{const{error:Ze}=await pe.from("quadras_dias_funcionamento").delete().eq("id",se);if(Ze)throw Ze;K(ct=>ct.filter(Qt=>Qt.id!==se)),e({title:"Sucesso",description:"Data de fechamento removida!"})}catch(Ze){console.error("Erro ao remover data de fechamento:",Ze),e({title:"Erro",description:"No foi possvel remover a data de fechamento."})}finally{re(!1)}};return o.jsx(o.Fragment,{children:o.jsxs(fr.div,{variants:eit,initial:"hidden",animate:"visible",className:"space-y-6",children:[o.jsxs(fr.div,{variants:gR,className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Quadras"}),o.jsx("p",{className:"text-text-secondary",children:"Gerencie as quadras e horrios disponveis."})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(le,{variant:"outline",size:"icon",onClick:()=>A(se=>!se),title:E?"Ocultar resumo":"Mostrar resumo","aria-label":E?"Ocultar resumo":"Mostrar resumo",children:E?o.jsx(Pp,{className:"h-4 w-4"}):o.jsx(Vp,{className:"h-4 w-4"})}),o.jsx(le,{onClick:()=>f(!0),className:"shadow-sm",children:"Adicionar Quadra"})]})]}),E&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsx(EE,{icon:nd,title:"Quadra Mais Usada",value:M.mostUsed,subtitle:"ltimos 30 dias",color:"text-brand"}),o.jsx(EE,{icon:cl,title:"Cliente Top",value:M.topClient,subtitle:"Mais agendamentos no ms",color:"text-purple"}),o.jsx(EE,{icon:Wp,title:"Total de Agendamentos",value:M.totalBookings,subtitle:"ltimos 30 dias",color:"text-success"})]}),o.jsxs(tit,{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-lg font-bold text-text-primary",children:"Quadras"}),o.jsx("div",{className:"text-xs text-text-muted",children:s?"Carregando...":`${a.length} registro(s)`})]}),!s&&a.length===0?o.jsxs("div",{className:"text-sm text-text-muted py-8 text-center",children:[o.jsx("div",{className:"font-medium mb-1",children:"Nenhuma quadra cadastrada"}),o.jsx("div",{className:"mb-4",children:'Clique em "Adicionar Quadra" para cadastrar a primeira.'}),o.jsx(le,{onClick:()=>f(!0),children:"Adicionar Quadra"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"md:hidden space-y-3",children:a.map(se=>o.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:xm(se.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),o.jsx("span",{className:"font-semibold text-base text-text-primary truncate",children:se.nome})]}),o.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0 ${se.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":se.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:se.status})]}),Array.isArray(se.modalidades)&&se.modalidades.length>0&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-text-muted mb-1 block",children:"Modalidades"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:se.modalidades.map(Ze=>o.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-xs",children:Ze},Ze))})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Valor/hora"}),o.jsx("span",{className:"text-sm font-medium",children:se.valor==null||se.valor===""?"-":ae(Number(se.valor)*2,!0)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Funcionamento"}),o.jsxs("span",{className:"text-sm font-medium",children:[J(se.hora_inicio)," - ",J(se.hora_fim==="24:00:00"?"23:59:00":se.hora_fim)]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs(le,{variant:"outline",size:"sm",onClick:()=>at(se),className:"flex items-center gap-1",children:[o.jsx(gi,{className:"h-3 w-3"}),"Dias"]}),o.jsx(le,{variant:"outline",size:"sm",onClick:()=>Y(se),children:"Editar"})]})]},se.id))}),o.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-border bg-surface-0",children:o.jsxs(el,{children:[o.jsx(tl,{className:"bg-surface-2/60 backdrop-blur supports-[backdrop-filter]:bg-surface-2/70",children:o.jsxs(Fa,{children:[o.jsx(yn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Nome"}),o.jsx(yn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Modalidades"}),o.jsx(yn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Valor por hora"}),o.jsx(yn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Funcionamento"}),o.jsx(yn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Status"}),o.jsx(yn,{className:"text-right text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Aes"})]})}),o.jsx(rl,{children:a.map(se=>o.jsxs(Fa,{className:"hover:bg-surface-2/40 transition-colors",children:[o.jsx(en,{className:"font-medium text-sm md:text-base text-text-primary",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:xm(se.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),o.jsx("span",{children:se.nome})]})}),o.jsx(en,{className:"text-sm md:text-base",children:Array.isArray(se.modalidades)&&se.modalidades.length>0?o.jsx("div",{className:"flex flex-wrap gap-1",children:se.modalidades.map(Ze=>o.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:Ze},Ze))}):se.modalidades||""}),o.jsx(en,{className:"text-sm md:text-base",children:se.valor==null||se.valor===""?"-":o.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:ae(Number(se.valor)*2,!0)})}),o.jsxs(en,{className:"text-sm md:text-base",children:[J(se.hora_inicio)," - ",J(se.hora_fim==="24:00:00"?"23:59:00":se.hora_fim)]}),o.jsx(en,{className:"text-sm md:text-base",children:o.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-[11px] md:text-xs border ${se.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":se.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:se.status})}),o.jsx(en,{className:"text-right",children:o.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[o.jsxs(le,{variant:"outline",size:"sm",onClick:()=>at(se),className:"text-sm",children:[o.jsx(gi,{className:"h-3 w-3 mr-1"}),"Dias"]}),o.jsx(le,{variant:"outline",size:"sm",onClick:()=>Y(se),className:"text-sm",children:"Editar"})]})})]},se.id))})]})})]})]}),o.jsx(ln,{open:u,onOpenChange:f,children:o.jsxs(sn,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Adicionar Quadra"}),o.jsx(_n,{children:"Cadastre uma nova quadra da sua empresa."})]}),o.jsxs("div",{className:"grid gap-4 py-2",children:[o.jsx(jU,{label:"Nome",value:m.nome,onChange:se=>h({...m,nome:se.target.value}),placeholder:"Ex.: Quadra Society 2"}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),o.jsx("textarea",{value:m.descricao,onChange:se=>h({...m,descricao:se.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),o.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text",value:v,onChange:se=>g(se.target.value),onKeyDown:se=>{if(se.key==="Enter"){se.preventDefault();const Ze=v.trim();if(!Ze)return;h(ct=>ct.modalidades.some(we=>we.toLowerCase()===Ze.toLowerCase())?ct:{...ct,modalidades:[...ct.modalidades,Ze]}),g("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),o.jsx(le,{type:"button",variant:"secondary",className:"bg-amber-500 hover:bg-amber-400 text-black disabled:opacity-50 disabled:cursor-not-allowed",disabled:!v.trim(),onClick:()=>{const se=v.trim();se&&(h(Ze=>Ze.modalidades.some(Qt=>Qt.toLowerCase()===se.toLowerCase())?Ze:{...Ze,modalidades:[...Ze.modalidades,se]}),g(""))},"aria-label":"Adicionar modalidade",title:"Adicionar modalidade",children:"+"})]}),m.modalidades.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2",children:m.modalidades.map(se=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[o.jsx("span",{className:"px-0.5",children:se}),o.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>h(Ze=>({...Ze,modalidades:Ze.modalidades.filter(ct=>ct!==se)})),"aria-label":`Remover ${se}`,title:`Remover ${se}`,children:""})]},se))})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),o.jsxs("select",{value:m.tipo,onChange:se=>h({...m,tipo:se.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{children:"Descoberta"}),o.jsx("option",{children:"Coberta"})]})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),o.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:m.valor_hora,onChange:se=>h({...m,valor_hora:G(se.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),o.jsx("input",{type:"time",step:"1800",value:m.hora_inicio,onChange:se=>h({...m,hora_inicio:se.target.value}),onBlur:se=>h(Ze=>({...Ze,hora_inicio:Ue(se.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),o.jsx("input",{type:"time",step:"1800",value:m.hora_fim,onChange:se=>h({...m,hora_fim:se.target.value}),onBlur:se=>h(Ze=>({...Ze,hora_fim:Ue(se.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),o.jsxs("select",{value:m.status,onChange:se=>h({...m,status:se.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{children:"Ativa"}),o.jsx("option",{children:"Inativa"}),o.jsx("option",{children:"Manuteno"})]})]})]}),o.jsx(Un,{children:o.jsx(le,{onClick:Te,disabled:c||m.modalidades.length===0,children:c?"Adicionando...":"Salvar"})})]})}),o.jsx(ln,{open:x,onOpenChange:y,children:o.jsxs(sn,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Editar Quadra"}),o.jsx(_n,{children:"Atualize os dados da quadra selecionada."})]}),o.jsxs("div",{className:"grid gap-4 py-2",children:[o.jsx(jU,{label:"Nome",value:j.nome,onChange:se=>_({...j,nome:se.target.value}),placeholder:"Ex.: Quadra Society 2"}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),o.jsx("textarea",{value:j.descricao,onChange:se=>_({...j,descricao:se.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),o.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text",value:S,onChange:se=>k(se.target.value),onKeyDown:se=>{if(se.key==="Enter"){se.preventDefault();const Ze=S.trim();if(!Ze)return;_(ct=>ct.modalidades.some(we=>we.toLowerCase()===Ze.toLowerCase())?ct:{...ct,modalidades:[...ct.modalidades,Ze]}),k("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),o.jsx(le,{type:"button",variant:"secondary",onClick:()=>{const se=S.trim();se&&(_(Ze=>Ze.modalidades.some(Qt=>Qt.toLowerCase()===se.toLowerCase())?Ze:{...Ze,modalidades:[...Ze.modalidades,se]}),k(""))},children:"+"})]}),j.modalidades.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2",children:j.modalidades.map(se=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[o.jsx("span",{className:"px-0.5",children:se}),o.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>_(Ze=>({...Ze,modalidades:Ze.modalidades.filter(ct=>ct!==se)})),"aria-label":`Remover ${se}`,title:`Remover ${se}`,children:""})]},se))})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),o.jsxs("select",{value:j.tipo,onChange:se=>_({...j,tipo:se.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{children:"Descoberta"}),o.jsx("option",{children:"Coberta"})]})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),o.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:j.valor_hora,onChange:se=>_({...j,valor_hora:G(se.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),o.jsx("input",{type:"time",step:"1800",value:j.hora_inicio,onChange:se=>_({...j,hora_inicio:se.target.value}),onBlur:se=>_(Ze=>({...Ze,hora_inicio:Ue(se.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),o.jsx("input",{type:"time",step:"1800",value:j.hora_fim,onChange:se=>_({...j,hora_fim:se.target.value}),onBlur:se=>_(Ze=>({...Ze,hora_fim:Ue(se.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),o.jsxs("select",{value:j.status,onChange:se=>_({...j,status:se.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{children:"Ativa"}),o.jsx("option",{children:"Inativa"}),o.jsx("option",{children:"Manuteno"})]})]})]}),o.jsx(Un,{children:o.jsx(le,{onClick:lt,disabled:c||j.modalidades.length===0,children:c?"Salvando...":"Salvar alteraes"})})]})}),o.jsx(ln,{open:T,onOpenChange:I,children:o.jsxs(sn,{className:"sm:max-w-[600px] max-h-[90vh] overflow-hidden pointer-events-none",children:[o.jsx("div",{className:"fixed inset-0 z-50 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto",children:o.jsx("div",{className:"rounded-2xl border border-white/30 bg-slate-900 shadow-2xl max-w-sm w-full text-center mx-4",children:o.jsxs("div",{className:"px-8 py-10",children:[o.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[o.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:o.jsx(nd,{className:"w-8 h-8 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline select-none",children:[o.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-3xl",style:{color:"#FFFFFF"},children:" Arena"})]})]}),o.jsx("div",{className:"text-2xl font-bold text-white mb-3",children:"Em Desenvolvimento"}),o.jsx("p",{className:"text-base text-gray-200",children:"Esta funcionalidade est sendo desenvolvida e em breve estar disponvel."}),o.jsx("div",{className:"mt-8 flex items-center justify-center",children:o.jsx(le,{variant:"outline",onClick:()=>I(!1),children:"Fechar"})})]})})}),o.jsxs(an,{children:[o.jsxs(nn,{className:"flex items-center gap-2",children:[o.jsx(gi,{className:"h-5 w-5"}),"Dias de Funcionamento - ",D?.nome]}),o.jsx(_n,{children:"Configure os dias da semana que a quadra funciona e adicione datas especficas de fechamento."})]}),V?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"text-sm text-text-muted",children:"Carregando configuraes..."})}):o.jsxs("div",{className:"space-y-6 py-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Dias da Semana"}),o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[{key:0,label:"Domingo",short:"Dom"},{key:1,label:"Segunda",short:"Seg"},{key:2,label:"Tera",short:"Ter"},{key:3,label:"Quarta",short:"Qua"},{key:4,label:"Quinta",short:"Qui"},{key:5,label:"Sexta",short:"Sex"},{key:6,label:"Sbado",short:"Sb"}].map(se=>o.jsxs("label",{className:"flex items-center gap-2 p-3 rounded-lg border border-border hover:bg-surface-2/50 cursor-pointer transition-colors",children:[o.jsx("input",{type:"checkbox",checked:z[se.key],onChange:Ze=>q(ct=>({...ct,[se.key]:Ze.target.checked})),className:"w-4 h-4 text-primary bg-surface-2 border-border rounded focus:ring-primary focus:ring-2"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-sm font-medium text-text-primary",children:se.short}),o.jsx("span",{className:"text-xs text-text-muted hidden sm:block",children:se.label})]})]},se.key))}),o.jsx("div",{className:"mt-4",children:o.jsx(le,{onClick:yt,disabled:V,size:"sm",children:V?"Salvando...":"Salvar Dias da Semana"})})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Datas de Fechamento"}),o.jsx("div",{className:"bg-surface-2/30 rounded-lg p-4 mb-4",children:o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Data"}),o.jsx("input",{type:"date",value:ce,onChange:se=>fe(se.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Observao"}),o.jsx("input",{type:"text",placeholder:"Ex: Feriado, Manuteno",value:B,onChange:se=>L(se.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),o.jsx("div",{className:"flex items-end",children:o.jsx(le,{onClick:vt,disabled:!ce||V,size:"sm",className:"w-full sm:w-auto",children:"Adicionar"})})]})}),$.length>0?o.jsx("div",{className:"space-y-2",children:$.map(se=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2/50 rounded-lg border border-border",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(dd,{className:"h-4 w-4 text-text-muted"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-text-primary",children:new Date(se.data_fechamento+"T00:00:00").toLocaleDateString("pt-BR")}),se.observacao&&o.jsx("div",{className:"text-xs text-text-muted",children:se.observacao})]})]}),o.jsx(le,{variant:"outline",size:"sm",onClick:()=>Sr(se.id),disabled:V,className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:o.jsx(Dl,{className:"h-3 w-3"})})]},se.id))}):o.jsx("div",{className:"text-center py-6 text-sm text-text-muted",children:"Nenhuma data de fechamento configurada"})]})]}),o.jsx(Un,{children:o.jsx(le,{variant:"outline",onClick:()=>I(!1),children:"Fechar"})})]})})]})})}const nit={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},ait={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function NU({children:e,className:t=""}){return o.jsx(fr.div,{variants:ait,className:`fx-card ${t}`,children:e})}function Qg({label:e,...t}){return o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:e}),o.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function oit(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function iit(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,15)}function sit(){const{toast:e}=ro(),{company:t,userProfile:r,reloadCompany:n}=Do(),[a,i]=p.useState(!1),[s,l]=p.useState({razao_social:"",nome_fantasia:"",cnpj:"",email:"",telefone:"",endereco:"",logo_url:""}),c=p.useRef(null),[d,u]=p.useState(""),f=p.useRef(!0);p.useEffect(()=>(f.current=!0,()=>{f.current=!1}),[]),p.useEffect(()=>{(async()=>{try{const g=r?.codigo_empresa||null;if(!g)return;const x=`empresa:form:${g}`;try{const _=localStorage.getItem(x);if(_){const S=JSON.parse(_);S&&typeof S=="object"&&(l(k=>({...k,...S})),S.logo_url&&u(`${S.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}const y=setTimeout(()=>{if(f.current)try{const _=localStorage.getItem(x);if(_){const S=JSON.parse(_);S&&typeof S=="object"&&(console.warn("[Empresas] slow fallback: using cached form"),l(k=>({...k,...S})),S.logo_url&&u(`${S.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}},5e3),{data:b,error:w}=await pe.from("empresas").select("*").eq("codigo_empresa",g).single();if(clearTimeout(y),w)throw w;if(!f.current)return;const j={razao_social:b?.razao_social||"",nome_fantasia:b?.nome_fantasia||b?.nome||"",cnpj:b?.cnpj||"",email:b?.email||"",telefone:b?.telefone||"",endereco:b?.endereco||"",logo_url:b?.logo_url||""};l(j),u(j.logo_url?`${j.logo_url.split("?")[0]}?v=${Date.now()}`:"");try{localStorage.setItem(x,JSON.stringify(j))}catch{}}catch(g){console.warn("Falha ao carregar empresa:",g)}})()},[r?.codigo_empresa]),p.useEffect(()=>{if(!s.logo_url){u("");return}const v=s.logo_url.split("?")[0];u(`${v}?v=${Date.now()}`)},[s.logo_url]);const m=async v=>{if(v.preventDefault(),!a){if(!s.razao_social?.trim()||!s.cnpj?.trim()){e({title:"Campos obrigatrios",description:"Preencha Razo Social e CNPJ."});return}if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"No foi possvel identificar a empresa do usurio para salvar."});return}try{i(!0);const g={nome:s.nome_fantasia||s.razao_social||"Empresa",razao_social:s.razao_social||null,nome_fantasia:s.nome_fantasia||null,cnpj:s.cnpj?.replace(/\D/g,"")||null,email:s.email||null,telefone:s.telefone||null,endereco:s.endereco||null,logo_url:s.logo_url||null},{error:x}=await pe.from("empresas").upsert({codigo_empresa:r.codigo_empresa,...g},{onConflict:"codigo_empresa"}).select("id").single();if(x)throw x;await n?.(),e({title:"Dados salvos",description:"As informaes da empresa foram atualizadas."})}catch(g){console.error(g);const x=(g?.message||g?.hint||"").toString()||"No foi possvel salvar os dados. Verifique as permisses e tente novamente.";e({title:"Erro ao salvar",description:x})}finally{i(!1)}}},h=async v=>{try{const g=v.target.files?.[0];if(!g)return;if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"Seu usurio no est associado a uma empresa."});return}const x=g.name.split(".").pop()?.toLowerCase()||"png",y=`${r.codigo_empresa}/logo.${x}`,{error:b}=await pe.storage.from("logos").upload(y,g,{upsert:!0,contentType:g.type||void 0});if(b)throw b;const{data:w}=pe.storage.from("logos").getPublicUrl(y),j=w?.publicUrl||"";l(_=>({..._,logo_url:j})),u(j?`${j}?v=${Date.now()}`:""),e({title:"Logo enviada",description:"A imagem foi carregada com sucesso. Lembre-se de salvar."})}catch(g){console.error("Falha no upload da logo:",g),e({title:"Erro no upload",description:"No foi possvel enviar a logo. Tente outro arquivo."})}finally{c.current&&(c.current.value="")}};return o.jsx(o.Fragment,{children:o.jsxs(fr.div,{variants:nit,initial:"hidden",animate:"visible",className:"space-y-6",children:[o.jsx(NU,{children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Cadastros  Empresa"})})}),o.jsxs(NU,{children:[o.jsx("h2",{className:"text-lg font-bold text-text-primary mb-4",children:"Dados da Empresa"}),o.jsxs("form",{onSubmit:m,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[o.jsx(Qg,{label:"Razo Social",value:s.razao_social,onChange:v=>l({...s,razao_social:v.target.value}),placeholder:"Ex.: Fluxo7 Arena LTDA"}),o.jsx(Qg,{label:"Nome Fantasia",value:s.nome_fantasia,onChange:v=>l({...s,nome_fantasia:v.target.value}),placeholder:"Ex.: Fluxo7 Arena"}),o.jsx(Qg,{label:"CNPJ",type:"text",inputMode:"numeric",value:s.cnpj,onChange:v=>l({...s,cnpj:oit(v.target.value)}),placeholder:"00.000.000/0000-00"}),o.jsx(Qg,{label:"Email",type:"email",value:s.email,onChange:v=>l({...s,email:v.target.value}),placeholder:"contato@empresa.com"}),o.jsx(Qg,{label:"Telefone",type:"tel",inputMode:"tel",value:s.telefone,onChange:v=>l({...s,telefone:iit(v.target.value)}),placeholder:"(11) 99999-9999"}),o.jsx(Qg,{label:"Endereo",value:s.endereco,onChange:v=>l({...s,endereco:v.target.value}),placeholder:"Rua, nmero, bairro, cidade",className:"md:col-span-2 lg:col-span-2"}),o.jsx("div",{className:"md:col-span-2 lg:col-span-2 grid grid-cols-1 gap-3",children:o.jsxs("div",{className:"flex items-center gap-4",children:[d||s.logo_url?o.jsx("img",{src:d||s.logo_url,alt:"Logo da empresa",className:"w-16 h-16 rounded-md object-cover border border-border"}):o.jsx("div",{className:"w-16 h-16 rounded-md border border-dashed border-border/60 bg-surface-2/40 flex items-center justify-center text-xs text-text-muted",children:"Sem logo"}),o.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Upload da Logo"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(le,{type:"button",variant:"outline",onClick:()=>c.current?.click(),className:"px-3",children:"Escolher imagem"}),o.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:h,className:"hidden"}),(d||s.logo_url)&&o.jsx("span",{className:"text-xs text-text-muted truncate max-w-[260px]",title:s.logo_url||d,children:"Logo selecionada"})]}),o.jsx("span",{className:"text-[11px] text-text-muted",children:"Formatos: PNG/JPG. Tamanho recomendado: 256x256."})]})]})}),o.jsx("div",{className:"flex items-end",children:o.jsx(le,{type:"submit",className:"w-full md:w-auto",disabled:a,children:a?"Salvando...":"Salvar"})})]})]})]})})}const lit={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Mj={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},_U=[{codigo:"01",nome:"Dinheiro"},{codigo:"02",nome:"Cheque"},{codigo:"03",nome:"Carto de Crdito"},{codigo:"04",nome:"Carto de Dbito"},{codigo:"05",nome:"Carto da Loja (Private Label)"},{codigo:"10",nome:"Vale Alimentao"},{codigo:"11",nome:"Vale Refeio"},{codigo:"12",nome:"Vale Presente"},{codigo:"13",nome:"Vale Combustvel"},{codigo:"14",nome:"Duplicata Mercantil"},{codigo:"15",nome:"Boleto Bancrio"},{codigo:"16",nome:"Depsito Bancrio"},{codigo:"17",nome:"PIX Dinmico (QR-Code)"},{codigo:"18",nome:"Transferncia Bancria / Carteira Digital"},{codigo:"19",nome:"Programa de Fidelidade / Cashback"},{codigo:"20",nome:"PIX Esttico"},{codigo:"21",nome:"Crdito em Loja"},{codigo:"22",nome:"Pagamento Eletrnico no Informado"},{codigo:"90",nome:"Sem Pagamento"},{codigo:"99",nome:"Outros"}],kE=({icon:e,title:t,value:r,subtitle:n,color:a,onClick:i,isActive:s})=>o.jsx(fr.div,{variants:Mj,onClick:i,className:Jt("bg-surface rounded-lg border md:border-2 p-3 md:p-4 transition-all text-center h-[90px] md:h-auto",i?"cursor-pointer hover:shadow-md":"",s?`border-${a} bg-${a}/5`:"border-border",i&&!s?"hover:border-border-hover":""),children:o.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 md:flex-row md:items-center md:gap-3 h-full",children:[o.jsx("div",{className:Jt("p-1.5 md:p-2 rounded-lg",`bg-${a}/10`),children:o.jsx(e,{className:Jt("w-4 h-4 md:w-5 md:h-5",`text-${a}`)})}),o.jsxs("div",{className:"flex-1 md:text-left",children:[o.jsx("p",{className:"text-base md:text-2xl font-bold text-text-primary leading-none",children:r}),o.jsx("p",{className:"text-[10px] md:text-xs font-semibold text-text-secondary md:mt-0.5",children:t}),o.jsx("p",{className:"hidden md:block text-xs text-text-muted",children:n})]})]})});function cit(){const{toast:e}=ro(),{userProfile:t,authReady:r}=Do(),[n,a]=p.useState([]),[i,s]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(""),[f,m]=p.useState("all"),[h,v]=p.useState("all"),[g,x]=p.useState(!0),[y,b]=p.useState(null),[w,j]=p.useState(!1),[_,S]=p.useState(null),[k,E]=p.useState({codigo_interno:"",codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),[A,M]=p.useState(!1),[C,T]=p.useState(""),[I,D]=p.useState(!1),[F,z]=p.useState(null),[q,$]=p.useState(null),[K,ce]=p.useState(!1),[fe,B]=p.useState("mes"),[L,V]=p.useState(!1),[re,me]=p.useState([]),[G,Q]=p.useState("customizado"),[ae,J]=p.useState(""),[je,be]=p.useState(""),[Ue,Z]=p.useState(!1),[Y,lt]=p.useState(!1);p.useEffect(()=>{const ye=()=>{try{lt(typeof window<"u"&&window.innerWidth<=640)}catch{}};return ye(),window.addEventListener("resize",ye),()=>window.removeEventListener("resize",ye)},[]);const gt=async()=>{try{s(!0);const ye=t?.codigo_empresa;if(!ye)return;const te=await Hv({somenteAtivas:!1,codigoEmpresa:ye});console.log(" Finalizadoras carregadas:",te),console.log(" Primeira finalizadora:",te?.[0]),a(Array.isArray(te)?te:[])}catch(ye){e({title:"Erro ao carregar",description:ye?.message,variant:"destructive"})}finally{s(!1)}},Te=p.useMemo(()=>{const ye=n.length,te=n.filter(Dt=>Dt.ativo).length,$e=n.length>0?n.reduce((Dt,kt)=>{const cr=kt.nome||"Sem nome";return Dt[cr]=(Dt[cr]||0)+1,Dt},{}):{},Pe=Object.entries($e).sort((Dt,kt)=>kt[1]-Dt[1])[0],It=Pe?Pe[0]:"-";return{total:ye,ativas:te,maisUsada:It}},[n]),at=p.useMemo(()=>{let ye=[...n];if(d){const te=d.toLowerCase();ye=ye.filter($e=>{const Pe=String($e.tipo||"").toLowerCase(),It=String($e.nome||"").toLowerCase(),Dt=String($e.codigo_interno||"").toLowerCase(),kt=te.replace(/\D/g,""),cr=String($e.codigo_interno||"").replace(/\D/g,"");return Pe.includes(te)||It.includes(te)||Dt.includes(te)||!!kt&&cr===kt})}return f!=="all"&&(ye=ye.filter(te=>te.tipo===f)),h!=="all"&&(ye=ye.filter(te=>h==="active"?te.ativo:!te.ativo)),y==="ativas"&&(ye=ye.filter(te=>te.ativo)),ye.sort((te,$e)=>{const Pe=parseInt(te.codigo_interno)||0,It=parseInt($e.codigo_interno)||0;return Pe-It}),ye},[n,d,f,h,y]),yt=()=>{S(null);const ye=n.reduce(($e,Pe)=>{const It=parseInt(Pe.codigo_interno)||0;return It>$e?It:$e},0),te=String(ye+1).padStart(2,"0");E({codigo_interno:te,codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),j(!0)},vt=ye=>{S(ye),E({codigo_interno:ye.codigo_interno||"",codigo_sefaz:ye.codigo_sefaz||"",nome:ye.nome||"",taxa_percentual:ye.taxa_percentual!=null?String(ye.taxa_percentual):"",ativo:ye.ativo!==!1}),j(!0)},Sr=async(ye,te="mes")=>{try{ce(!0);const $e=t?.codigo_empresa;if(!$e)return;const Pe=new Date;let It,Dt=Pe.toISOString();switch(te){case"hoje":It=new Date(Pe.setHours(0,0,0,0)).toISOString();break;case"semana":It=new Date(Pe.setDate(Pe.getDate()-7)).toISOString();break;case"mes":It=new Date(Pe.setMonth(Pe.getMonth()-1)).toISOString();break;default:It=new Date(Pe.setMonth(Pe.getMonth()-1)).toISOString()}const{data:kt,error:cr}=await pe.from("pagamentos").select("valor, recebido_em, status").eq("finalizadora_id",ye).eq("codigo_empresa",$e).gte("recebido_em",It).lte("recebido_em",Dt).neq("status","Cancelado").neq("status","Estornado");if(cr)throw cr;const Cr=kt?.length||0,Ie=kt?.reduce((mt,Be)=>mt+(Number(Be.valor)||0),0)||0,ke=Cr>0?Ie/Cr:0,Je=kt?.[kt.length-1]?.recebido_em||null;$({transacoes:Cr,faturamento:Ie,ticketMedio:ke,ultimaUtilizacao:Je})}catch($e){console.error("Erro ao carregar estatsticas:",$e),e({title:"Erro ao carregar estatsticas",description:$e?.message,variant:"destructive"})}finally{ce(!1)}},se=async(ye="customizado",te=null,$e=null)=>{try{Z(!0);const Pe=t?.codigo_empresa;if(!Pe)return;let It,Dt;if(ye==="customizado"&&te&&$e)It=new Date(te).toISOString(),Dt=new Date($e+"T23:59:59").toISOString();else{const ke=new Date;switch(Dt=ke.toISOString(),ye){case"hoje":It=new Date(ke.setHours(0,0,0,0)).toISOString();break;case"semana":It=new Date(ke.setDate(ke.getDate()-7)).toISOString();break;case"mes":It=new Date(ke.setMonth(ke.getMonth()-1)).toISOString();break;default:It=new Date(ke.setMonth(ke.getMonth()-1)).toISOString()}}const{data:kt,error:cr}=await pe.from("pagamentos").select("finalizadora_id, valor, finalizadoras!pagamentos_finalizadora_id_fkey(id, codigo_interno, nome)").eq("codigo_empresa",Pe).gte("recebido_em",It).lte("recebido_em",Dt).neq("status","Cancelado").neq("status","Estornado");if(cr)throw cr;const Cr={};kt?.forEach(ke=>{const Je=ke.finalizadora_id;Je&&(Cr[Je]||(Cr[Je]={id:Je,codigo:ke.finalizadoras?.codigo_interno||"-",nome:ke.finalizadoras?.nome||"Sem nome",total:0,transacoes:0}),Cr[Je].total+=Number(ke.valor)||0,Cr[Je].transacoes+=1)});const Ie=Object.values(Cr).sort((ke,Je)=>Je.total-ke.total);me(Ie)}catch(Pe){console.error("Erro ao carregar ranking:",Pe),e({title:"Erro ao carregar ranking",description:Pe?.message,variant:"destructive"})}finally{Z(!1)}},Ze=()=>{V(!0),Q("customizado");const ye=new Date,te=new Date;te.setMonth(te.getMonth()-1),J(te.toISOString().split("T")[0]),be(ye.toISOString().split("T")[0]),se("customizado",te.toISOString().split("T")[0],ye.toISOString().split("T")[0])},ct=ye=>{z(ye),D(!0),B("mes"),Sr(ye.id,"mes")},Qt=async()=>{try{if(!k.nome?.trim()){e({title:"Nome  obrigatrio",variant:"warning"});return}if(!k.codigo_sefaz){e({title:"Cdigo SEFAZ  obrigatrio",variant:"warning"});return}if(k.codigo_interno?.trim()&&n.some(Pe=>Pe.codigo_interno===k.codigo_interno.trim()&&(!_||Pe.id!==_.id))){e({title:"Cdigo j existe",description:"Este cdigo interno j est em uso por outra finalizadora",variant:"warning"});return}c(!0);const ye=t?.codigo_empresa,te={codigo_interno:k.codigo_interno?.trim()||null,codigo_sefaz:k.codigo_sefaz,nome:k.nome.trim(),tipo:"outros",taxa_percentual:k.taxa_percentual===""?null:Number(k.taxa_percentual),ativo:k.ativo};_?(await yGe(_.id,te,ye),e({title:"Finalizadora atualizada!",variant:"success"})):(await xGe(te,ye),e({title:"Finalizadora criada!",variant:"success"})),j(!1),await gt()}catch(ye){e({title:"Erro ao salvar",description:ye?.message,variant:"destructive"})}finally{c(!1)}},we=async ye=>{try{await bGe(ye.id,!ye.ativo,t?.codigo_empresa),e({title:ye.ativo?"Desativada":"Ativada",variant:"success"}),await gt()}catch(te){e({title:"Erro ao alterar status",description:te?.message,variant:"destructive"})}};return p.useEffect(()=>{r&&t?.codigo_empresa&&gt()},[r,t?.codigo_empresa]),o.jsxs(o.Fragment,{children:[o.jsxs(fr.div,{variants:lit,initial:"hidden",animate:"visible",className:"flex-1 space-y-6 p-4 md:p-6",children:[o.jsxs(fr.div,{variants:Mj,className:"flex items-center justify-between gap-2",children:[o.jsx("div",{className:"min-w-0",children:o.jsx("h1",{className:"text-2xl md:text-3xl font-black text-text-primary tracking-tight leading-tight",children:"Finalizadoras"})}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx(le,{variant:"ghost",size:"icon",onClick:()=>x(!g),className:"h-9 w-9",children:g?o.jsx(Pp,{className:"h-5 w-5"}):o.jsx(Vp,{className:"h-5 w-5"})}),o.jsxs(le,{onClick:yt,className:"gap-2 h-9 px-3 whitespace-nowrap",children:[o.jsx(Ga,{className:"h-4 w-4"}),o.jsx("span",{className:"md:hidden",children:"Nova"}),o.jsx("span",{className:"hidden md:inline",children:"Nova Finalizadora"})]})]})]}),g&&o.jsxs("div",{className:"grid grid-cols-3 gap-3 md:grid-cols-3 md:gap-6",children:[o.jsx(kE,{icon:km,title:"Total",value:Te.total,subtitle:"Finalizadoras cadastradas",color:"brand"}),o.jsx(kE,{icon:Ui,title:"Ativas",value:Te.ativas,subtitle:"Disponveis para uso",color:"success",onClick:()=>b(y==="ativas"?null:"ativas"),isActive:y==="ativas"}),o.jsx(kE,{icon:Wp,title:"Mais Usada",value:Te.maisUsada,subtitle:"Mtodo mais popular",color:"warning",onClick:Ze})]}),o.jsx(fr.div,{variants:Mj,className:"bg-surface rounded-lg border border-border p-4",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative min-w-0 basis-0 flex-grow",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar finalizadora...",value:d,onChange:ye=>u(ye.target.value),className:"pl-10 h-11"})]}),o.jsxs(En,{value:h,onValueChange:v,children:[o.jsx(Sn,{className:"w-[110px] md:w-[180px]",children:o.jsx(kn,{placeholder:"Filtrar por status"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Todos"}),o.jsx(Nt,{value:"active",children:"Ativas"}),o.jsx(Nt,{value:"inactive",children:"Inativas"})]})]})]})}),o.jsx(fr.div,{variants:Mj,className:"bg-surface rounded-lg border border-border overflow-hidden",children:i?o.jsxs("div",{className:"p-12 text-center",children:[o.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),o.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):at.length===0?o.jsxs("div",{className:"p-12 text-center text-text-muted",children:[o.jsx(km,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{children:"Nenhuma finalizadora encontrada"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"md:hidden divide-y divide-border",children:at.map(ye=>o.jsxs("div",{className:"p-3 flex flex-col gap-2 hover:bg-surface-2/50 cursor-pointer",onClick:()=>ct(ye),children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("span",{className:"px-2 py-0.5 rounded-md bg-surface-2 border border-border font-mono text-xs text-text-secondary",children:ye.codigo_interno||"-"}),o.jsx("span",{className:"font-semibold text-sm text-text-primary truncate",title:ye.nome,children:ye.nome})]}),o.jsxs("span",{className:Jt("inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[11px] font-medium",ye.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[o.jsx("span",{className:Jt("w-1.5 h-1.5 rounded-full",ye.ativo?"bg-success":"bg-muted")}),ye.ativo?"Ativa":"Inativa"]})]}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-text-secondary",children:[o.jsx("div",{className:"flex items-center gap-3",children:o.jsxs("span",{children:["Taxa: ",ye.taxa_percentual?`${ye.taxa_percentual}%`:"-"]})}),o.jsxs("div",{className:"flex items-center gap-2",onClick:te=>te.stopPropagation(),children:[o.jsx(le,{variant:"ghost",size:"sm",className:"h-7 px-2",onClick:()=>vt(ye),children:o.jsx(ll,{className:"h-4 w-4"})}),o.jsx(le,{variant:ye.ativo?"ghost":"default",size:"sm",className:"h-7 px-2",onClick:()=>we(ye),children:ye.ativo?"Desativar":"Ativar"})]})]})]},ye.id))}),o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-surface-2 border-b border-border",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Cdigo"}),o.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Descrio"}),o.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Taxa (%)"}),o.jsx("th",{className:"text-center px-6 py-4 text-sm font-semibold text-text-secondary",children:"Status"}),o.jsx("th",{className:"text-right px-6 py-4 text-sm font-semibold text-text-secondary",children:"Aes"})]})}),o.jsx("tbody",{className:"divide-y divide-border",children:at.map(ye=>o.jsxs("tr",{className:"hover:bg-surface-2/50 transition-colors cursor-pointer",onClick:()=>ct(ye),children:[o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"font-mono text-sm text-text-primary",children:ye.codigo_interno||"-"})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"font-semibold text-text-primary",children:ye.nome})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"text-text-secondary",children:ye.taxa_percentual?`${ye.taxa_percentual}%`:"-"})}),o.jsx("td",{className:"px-6 py-4 text-center",children:o.jsxs("span",{className:Jt("inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium",ye.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[o.jsx("span",{className:Jt("w-2 h-2 rounded-full",ye.ativo?"bg-success":"bg-muted")}),ye.ativo?"Ativa":"Inativa"]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex justify-end gap-2",onClick:te=>te.stopPropagation(),children:[o.jsx(le,{variant:"ghost",size:"sm",onClick:()=>vt(ye),children:o.jsx(ll,{className:"h-4 w-4"})}),o.jsx(le,{variant:ye.ativo?"ghost":"default",size:"sm",onClick:()=>we(ye),children:ye.ativo?"Desativar":"Ativar"})]})})]},ye.id))})]})})]})})]}),o.jsx(ln,{open:w,onOpenChange:j,children:o.jsxs(sn,{className:"sm:max-w-[500px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[o.jsxs(an,{children:[o.jsx(nn,{children:_?"Editar Finalizadora":"Nova Finalizadora"}),o.jsx(_n,{children:_?"Atualize as informaes da finalizadora":"Adicione um novo mtodo de pagamento"})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{htmlFor:"codigo_interno",children:"Cdigo Finalizadora"}),o.jsx(ir,{id:"codigo_interno",type:"text",placeholder:"Ex: 01, 02, 03...",value:k.codigo_interno,onChange:ye=>E({...k,codigo_interno:ye.target.value})}),o.jsx("p",{className:"text-xs text-text-muted",children:"Gerado automaticamente, mas pode ser editado"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{htmlFor:"nome",children:"Descrio *"}),o.jsx(ir,{id:"nome",placeholder:"Ex: PIX, Dinheiro, Carto de Crdito...",value:k.nome,onChange:ye=>E({...k,nome:ye.target.value})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{htmlFor:"codigo_sefaz",children:"Forma de Pagamento NF-e/NFC-e *"}),o.jsx(le,{type:"button",variant:"outline",className:"justify-between w-full",onClick:()=>M(!0),children:k.codigo_sefaz?`${k.codigo_sefaz} - ${_U.find(ye=>ye.codigo===k.codigo_sefaz)?.nome||""}`:"Selecione a forma de pagamento"}),o.jsx("p",{className:"text-xs text-text-muted",children:"A lista abrir em um modal com rolagem."})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ht,{htmlFor:"taxa",children:"Taxa"}),o.jsxs("div",{className:"relative",children:[o.jsx(ir,{id:"taxa",inputMode:"decimal",placeholder:"0,00",className:"pr-10",value:k.taxa_percentual,onChange:ye=>{const te=String(ye.target.value).replace(/[^0-9.,]/g,"").replace(/,/g,".");if(te===""){E({...k,taxa_percentual:""});return}const $e=Number(te);if(Number.isFinite($e)){const Pe=Math.max(0,Math.min(100,$e));E({...k,taxa_percentual:String(Pe)})}},onBlur:()=>{const ye=String(k.taxa_percentual||"").replace(/,/g,".");if(ye==="")return;const te=Number(ye);if(Number.isFinite(te)){const $e=Math.max(0,Math.min(100,te));E(Pe=>({...Pe,taxa_percentual:$e.toFixed(2)}))}}}),o.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-muted text-sm",children:"%"})]}),o.jsx("p",{className:"text-xs text-text-muted",children:"Deixe vazio se no houver taxa"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",id:"ativo",checked:k.ativo,onChange:ye=>E({...k,ativo:ye.target.checked}),className:"h-4 w-4 rounded border-border"}),o.jsx(Ht,{htmlFor:"ativo",className:"text-sm font-normal cursor-pointer",children:"Finalizadora ativa"})]})]}),o.jsxs(Un,{children:[o.jsx(le,{variant:"outline",onClick:()=>j(!1),disabled:l,children:"Cancelar"}),o.jsx(le,{onClick:Qt,disabled:l,children:l?"Salvando...":"Salvar"})]})]})}),o.jsx(ln,{open:A,onOpenChange:M,children:o.jsxs(sn,{className:"sm:max-w-[520px] w-[92vw]",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Selecionar Forma de Pagamento (SEFAZ)"}),o.jsx(_n,{children:"Busque por cdigo ou nome"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(ir,{placeholder:"Ex.: 03, crdito, pix...",value:C,onChange:ye=>T(ye.target.value)}),o.jsx("div",{className:"max-h-[420px] overflow-auto fx-scroll rounded-md border border-border",children:o.jsx("ul",{className:"divide-y divide-border",children:_U.filter(ye=>{const te=(C||"").toLowerCase();return te?ye.codigo.includes(te)||String(ye.nome).toLowerCase().includes(te):!0}).map(ye=>o.jsx("li",{children:o.jsxs("button",{type:"button",className:`w-full text-left px-3 py-2 hover:bg-surface-2 ${k.codigo_sefaz===ye.codigo?"bg-surface-2":""}`,onClick:()=>{E(te=>({...te,codigo_sefaz:ye.codigo})),M(!1)},children:[o.jsx("span",{className:"font-mono mr-2 text-text-secondary",children:ye.codigo}),o.jsx("span",{children:ye.nome})]})},ye.codigo))})})]})]})}),o.jsx(ln,{open:I,onOpenChange:D,children:o.jsxs(sn,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Detalhes da Finalizadora"}),o.jsx(_n,{children:"Estatsticas e informaes completas"})]}),F&&o.jsxs("div",{className:"space-y-6 py-4",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Informaes"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Cdigo Finalizadora"}),o.jsx("p",{className:"font-mono text-sm text-text-primary",children:F.codigo_interno||"-"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento NF-e/NFC-e"}),o.jsx("p",{className:"font-mono text-sm text-text-primary",children:F.codigo_sefaz||"-"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Descrio"}),o.jsx("p",{className:"font-medium text-text-primary",children:F.nome})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Taxa"}),o.jsx("p",{className:"font-medium text-text-primary",children:F.taxa_percentual?`${F.taxa_percentual}%`:"Sem taxa"})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Status"}),o.jsxs("span",{className:Jt("inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs font-medium",F.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[o.jsx("span",{className:Jt("w-2 h-2 rounded-full",F.ativo?"bg-success":"bg-muted")}),F.ativo?"Ativa":"Inativa"]})]})]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Perodo de Anlise"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(le,{variant:fe==="hoje"?"default":"outline",size:"sm",onClick:()=>{B("hoje"),Sr(F.id,"hoje")},children:"Hoje"}),o.jsx(le,{variant:fe==="semana"?"default":"outline",size:"sm",onClick:()=>{B("semana"),Sr(F.id,"semana")},children:"7 Dias"}),o.jsx(le,{variant:fe==="mes"?"default":"outline",size:"sm",onClick:()=>{B("mes"),Sr(F.id,"mes")},children:"30 Dias"})]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Estatsticas de Uso"}),K?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-brand border-t-transparent"})}):q?o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Total de Transaes"}),o.jsx("span",{className:"font-semibold text-text-primary",children:q.transacoes})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Faturamento Total"}),o.jsxs("span",{className:"font-semibold text-success",children:["R$ ",q.faturamento.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Ticket Mdio"}),o.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",q.ticketMedio.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"ltima Utilizao"}),o.jsx("span",{className:"font-medium text-text-muted",children:q.ultimaUtilizacao?new Date(q.ultimaUtilizacao).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Nunca utilizada"})]})]}):o.jsx("div",{className:"text-center py-8 text-text-muted",children:o.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel"})})]})]}),o.jsxs(Un,{children:[o.jsx(le,{variant:"outline",onClick:()=>D(!1),children:"Fechar"}),o.jsxs(le,{onClick:()=>{D(!1),vt(F)},children:[o.jsx(ll,{className:"h-4 w-4 mr-2"}),"Editar"]})]})]})}),o.jsx(ln,{open:L,onOpenChange:V,children:o.jsxs(sn,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Ranking de Finalizadoras"}),o.jsx(_n,{children:"Faturamento por forma de pagamento"})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsx(le,{variant:G==="hoje"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{Q("hoje"),se("hoje")},children:"Hoje"}),o.jsx(le,{variant:G==="semana"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{Q("semana"),se("semana")},children:"7 Dias"}),o.jsx(le,{variant:G==="mes"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{Q("mes"),se("mes")},children:"30 Dias"}),o.jsx(le,{variant:G==="customizado"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>Q("customizado"),children:"Perodo"})]}),G==="customizado"&&(Y?o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx(Ht,{className:"text-xs",children:"Data Inicial"}),o.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:ae,onChange:ye=>J(ye.target.value)})]}),o.jsxs("div",{children:[o.jsx(Ht,{className:"text-xs",children:"Data Final"}),o.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:je,onChange:ye=>be(ye.target.value)})]})]}),o.jsx(le,{className:"w-full",onClick:()=>se("customizado",ae,je),disabled:!ae||!je||Ue,children:Ue?"Buscando...":"Buscar"})]}):o.jsxs("div",{className:"flex gap-3 items-end",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx(Ht,{children:"Data Inicial"}),o.jsxs(yc,{children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"outline",className:Jt("w-full justify-start text-left font-normal",!ae&&"text-text-muted"),children:[o.jsx(gi,{className:"mr-2 h-4 w-4"}),ae?new Date(ae+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),o.jsx(Ml,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:o.jsx(V3,{mode:"single",selected:ae?new Date(ae+"T12:00:00"):void 0,onSelect:ye=>{if(ye){const te=ye.getFullYear(),$e=String(ye.getMonth()+1).padStart(2,"0"),Pe=String(ye.getDate()).padStart(2,"0");J(`${te}-${$e}-${Pe}`)}},className:"p-3"})})]})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx(Ht,{children:"Data Final"}),o.jsxs(yc,{children:[o.jsx(bc,{asChild:!0,children:o.jsxs(le,{variant:"outline",className:Jt("w-full justify-start text-left font-normal",!je&&"text-text-muted"),children:[o.jsx(gi,{className:"mr-2 h-4 w-4"}),je?new Date(je+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),o.jsx(Ml,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:o.jsx(V3,{mode:"single",selected:je?new Date(je+"T12:00:00"):void 0,onSelect:ye=>{if(ye){const te=ye.getFullYear(),$e=String(ye.getMonth()+1).padStart(2,"0"),Pe=String(ye.getDate()).padStart(2,"0");be(`${te}-${$e}-${Pe}`)}},className:"p-3"})})]})]}),o.jsx(le,{onClick:()=>se("customizado",ae,je),disabled:!ae||!je||Ue,children:"Buscar"})]}))]}),Ue?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand border-t-transparent"})}):re.length===0?o.jsx("div",{className:"text-center py-12 text-text-muted",children:o.jsx("p",{children:"Nenhuma transao no perodo selecionado"})}):o.jsx("div",{className:"space-y-3",children:re.map((ye,te)=>o.jsx("div",{className:"bg-surface-2 rounded-lg p-3 md:p-4 border border-border",children:o.jsxs("div",{className:"flex items-start md:items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex items-start md:items-center gap-2 md:gap-3 flex-1 min-w-0",children:[o.jsxs("div",{className:Jt("flex items-center justify-center w-7 h-7 md:w-8 md:h-8 rounded-full font-bold text-xs md:text-sm flex-shrink-0",te===0?"bg-warning/20 text-warning":te===1?"bg-info/20 text-info":te===2?"bg-success/20 text-success":"bg-muted/20 text-muted"),children:[te+1,""]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[o.jsx("span",{className:"font-mono text-[10px] md:text-xs text-text-muted",children:ye.codigo}),o.jsx("span",{className:"font-semibold text-sm md:text-base text-text-primary truncate",children:ye.nome})]}),o.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted",children:[ye.transacoes," transaes"]})]})]}),o.jsxs("div",{className:"text-right flex-shrink-0",children:[o.jsxs("p",{className:"text-base md:text-lg font-bold text-success whitespace-nowrap",children:["R$ ",ye.total.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),o.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted whitespace-nowrap",children:["Mdia: R$ ",(ye.total/ye.transacoes).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})},ye.id))})]}),o.jsx(Un,{children:o.jsx(le,{variant:"outline",onClick:()=>V(!1),children:"Fechar"})})]})})]})}function dit(){return o.jsxs("div",{className:"p-8",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Pgina de Teste"}),o.jsx("p",{children:"Esta  uma pgina de teste para verificar se o roteamento est funcionando corretamente."})]})}function uit(){const[e,t]=p.useState(!1),[r,n]=p.useState(""),[a,i]=p.useState("Manuteno em andamento. Volte em breve!"),[s,l]=p.useState(!1),[c,d]=p.useState("");p.useEffect(()=>{try{const m=localStorage.getItem("maintenance:active")==="false",h=localStorage.getItem("maintenance:end")||"",v=localStorage.getItem("maintenance:message")||"Manuteno em andamento. Volte em breve!";t(m),n(h),i(v)}catch{}},[]);const u=m=>{if(m?.preventDefault(),e&&!r){alert("Defina uma data de trmino para a manuteno");return}localStorage.setItem("maintenance:active",e),localStorage.setItem("maintenance:end",r),localStorage.setItem("maintenance:message",a),window.dispatchEvent(new Event("storage")),l(!1),d(" Configuraes salvas!"),setTimeout(()=>d(""),3e3)},f=()=>{const m=!e;if(t(m),localStorage.setItem("maintenance:active",String(m)),m&&!r){const h=new Date;h.setDate(h.getDate()+1);const v=h.toISOString().slice(0,16);n(v),localStorage.setItem("maintenance:end",v)}window.dispatchEvent(new Event("storage")),d(m?" Modo manuteno ATIVADO":" Modo manuteno DESATIVADO"),setTimeout(()=>d(""),3e3)};return o.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg mt-10",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Controle de Manuteno"}),o.jsx("button",{onClick:f,className:`inline-flex items-center px-4 py-2 rounded-md font-medium ${e?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:e?"Manuteno ATIVA":"Manuteno INATIVA"})]}),e&&o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"font-medium text-lg",children:"Configuraes"}),o.jsxs("button",{onClick:()=>l(!s),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 text-sm",children:[o.jsx(ll,{className:"w-4 h-4"}),s?"Ocultar":"Editar"]})]}),s?o.jsxs("form",{onSubmit:u,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Trmino"}),o.jsx("div",{className:"relative",children:o.jsx("input",{type:"datetime-local",value:r,onChange:m=>n(m.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:new Date().toISOString().slice(0,16),required:!0})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensagem de Manuteno"}),o.jsx("textarea",{value:a,onChange:m=>i(m.target.value),rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Ex: Estamos em manuteno programada. Volte em breve!",required:!0})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancelar"}),o.jsxs("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[o.jsx(hue,{className:"inline w-4 h-4 mr-1"}),"Salvar"]})]})]}):o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Trmino:"}),o.jsx("p",{className:"text-gray-900",children:r?new Date(r).toLocaleString():"No definido"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mensagem:"}),o.jsx("p",{className:"text-gray-900 whitespace-pre-line",children:a})]})]})]}),o.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600",children:[o.jsx("h3",{className:"font-medium mb-2",children:"Como usar:"}),o.jsxs("ol",{className:"list-decimal pl-5 space-y-1",children:[o.jsx("li",{children:"Ative/desative o boto no topo"}),o.jsx("li",{children:"Defina a data de trmino e uma mensagem amigvel"}),o.jsx("li",{children:"Salve as configuraes"}),o.jsx("li",{children:"Para acessar durante a manuteno, use a senha no link"})]})]}),c&&o.jsx("div",{className:"fixed bottom-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded shadow-lg",children:c})]})}function fit(e){const t=new URLSearchParams(e.startsWith("#")?e.slice(1):e),r=t.get("access_token"),n=t.get("refresh_token");return{access_token:r,refresh_token:n}}const mit=()=>{const{toast:e}=ro(),t=Fl(),[r,n]=p.useState(""),[a,i]=p.useState(""),[s,l]=p.useState(!1),[c,d]=p.useState(!1),u=p.useMemo(()=>fit(window.location.hash),[]);p.useEffect(()=>{(async()=>{const{data:{session:h}}=await pe.auth.getSession();if(h){d(!0);return}if(u.access_token&&u.refresh_token){const{data:v,error:g}=await pe.auth.setSession({access_token:u.access_token,refresh_token:u.refresh_token});g&&e({title:"Link invlido ou expirado",description:"Abra o link do email novamente.",variant:"destructive"}),d(!!v?.session)}else e({title:"Link invlido",description:"Abra o link de redefinio enviado por email.",variant:"destructive"})})()},[]);const f=async m=>{if(m.preventDefault(),r.length<6){e({title:"Senha muito curta",description:"A senha deve ter pelo menos 6 caracteres.",variant:"destructive"});return}if(r!==a){e({title:"Senhas no conferem",description:"As senhas digitadas so diferentes.",variant:"destructive"});return}l(!0);const{data:h,error:v}=await pe.auth.updateUser({password:r});if(l(!1),v){e({title:"Erro ao redefinir senha",description:v.message||"Tente novamente.",variant:"destructive"});return}e({title:"Senha redefinida",description:"Voc j pode acessar o sistema.",variant:"default"}),t("/")};return o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-6",children:o.jsxs("div",{className:"w-full max-w-md bg-surface rounded-xl border border-border p-6 shadow",children:[o.jsx("h1",{className:"text-2xl font-semibold mb-2 text-text-primary",children:"Redefinir senha"}),o.jsx("p",{className:"text-sm text-text-secondary mb-6",children:"Defina uma nova senha para sua conta."}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Nova senha"}),o.jsx(ir,{type:"password",value:r,onChange:m=>n(m.target.value),placeholder:"",disabled:!c||s})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Confirmar nova senha"}),o.jsx(ir,{type:"password",value:a,onChange:m=>i(m.target.value),placeholder:"",disabled:!c||s})]}),o.jsx(le,{type:"submit",className:"w-full",disabled:!c||s,children:s?"Salvando...":"Salvar nova senha"})]})]})})},hit=(e,t,r)=>e.split(/(\*\*.*?\*\*)/g).map((a,i)=>{if(a.startsWith("**")&&a.endsWith("**")){const s=a.slice(2,-2);return o.jsx("strong",{className:`font-black ${t?r?"text-white":"text-[#000000]":"text-white"}`,style:{fontWeight:900,textShadow:t?r?"0 0 1px rgba(0,0,0,0.25)":"0 0 1px rgba(0,0,0,0.3)":"0 0 1px rgba(255,255,255,0.5)"},children:s},i)}return a}),woe=({message:e})=>{const t=e.from==="isis",r=t&&e?.color==="green",[n,a]=p.useState(!1),i=async s=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s);else{const l=document.createElement("textarea");l.value=s,l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.opacity="0",document.body.appendChild(l),l.focus(),l.select(),document.execCommand("copy"),document.body.removeChild(l)}a(!0),setTimeout(()=>a(!1),1800)}catch{}};return o.jsx(fr.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,ease:[.22,1,.36,1]},className:`flex ${t?"justify-start":"justify-end"} mb-4 md:mb-6`,children:o.jsxs("div",{className:`flex items-end gap-2 md:gap-3 max-w-[90%] md:max-w-[85%] lg:max-w-[75%] ${!t&&"flex-row-reverse"}`,children:[t?o.jsx(ud,{size:"sm",variant:"message",className:"md:w-14 md:h-14"}):o.jsx("div",{className:"w-10 h-10 md:w-14 md:h-14 rounded-full flex items-center justify-center flex-shrink-0 border bg-surface border-border-color",children:o.jsx(_u,{className:"w-5 h-5 md:w-6 md:h-6 text-text-secondary"})}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsxs("div",{className:`relative px-3 py-2.5 md:px-5 md:py-3.5 backdrop-blur-sm transition-all duration-300 ${t?r?"bg-emerald-600/90 border border-emerald-400 text-white rounded-2xl rounded-bl-sm shadow-lg shadow-emerald-600/30":"bg-brand border border-brand text-[#0A0A0A] rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20":"bg-surface/70 border border-white/10 text-text-primary rounded-2xl rounded-br-sm"}`,children:[o.jsx("p",{className:"text-[15px] md:text-[15px] font-bold leading-relaxed whitespace-pre-wrap tracking-wide relative",children:hit(e.text,t,r)}),e.copyable&&o.jsx("button",{type:"button",onClick:()=>i(e.copyText||(typeof e.text=="string"?e.text:"")),className:`absolute right-2 bottom-2 p-1.5 md:p-2 rounded-full border shadow-sm transition ${t?"bg-white/80 border-white/40 text-[#0A0A0A] hover:bg-white":"bg-white/10 border-white/10 text-text-primary hover:bg-white/20"}`,"aria-label":"Copiar texto",children:n?o.jsx(Tf,{className:"w-4 h-4"}):o.jsx(Qde,{className:"w-4 h-4"})})]}),o.jsx("p",{className:`text-[10px] md:text-[10px] text-text-muted px-2 ${t?"text-left":"text-right"}`,children:Xt(e.timestamp,"HH:mm")})]})]})})};function pit(){const[e,t]=p.useState([]),[r,n]=p.useState(""),[a,i]=p.useState(!1),[s,l]=p.useState(""),[c,d]=p.useState(!0),u=p.useRef(null),{company:f,userProfile:m,user:h}=Do();p.useEffect(()=>{const b={id:Date.now()+Math.random(),from:"isis",text:"Ol! Eu sou a verso Premium da sis, integrada  OpenAI. Em que posso ajudar? ",timestamp:new Date};t([b])},[]),p.useEffect(()=>{const b=setTimeout(()=>{u.current?.scrollIntoView({behavior:"smooth",block:"end"})},100);return()=>clearTimeout(b)},[e,a]);const v=b=>{t(w=>[...w,{id:Date.now()+Math.random(),timestamp:new Date,...b}])},g=b=>{const w=String(b||"").toLowerCase();return w?w.includes("agend")||w.includes("agenda")?w.includes("hoje")?"Consultando os agendamentos de hoje...":w.includes("amanh")?"Consultando os agendamentos de amanh...":"Consultando seus agendamentos...":w.includes("cliente")?"Buscando informaes de clientes...":w.includes("caixa")||w.includes("faturamento")||w.includes("financeiro")||w.includes("venda")||w.includes("pagamento")?"Analisando movimentaes da sua arena...":w.includes("quadra")||w.includes("reserva")?"Verificando horrios e quadras disponveis...":"...":"..."},x=async(b,w)=>{try{const j=f?.codigoEmpresa||f?.codigo_empresa||null,_=m?.id||h?.id||null,S=m?.nome||h?.email||null,k=m?.cargo||null,E=new Date,A=new Date(E.getFullYear(),E.getMonth(),E.getDate(),0,0,0,0),M=new Date(A);M.setDate(M.getDate()+1);const C=A.toISOString(),T=M.toISOString(),I=Array.isArray(w)?w.map($=>({role:$.from==="isis"?"assistant":"user",content:$.text})):[],{data:D,error:F}=await pe.functions.invoke("chat-proxy",{body:{message:b,empresaCodigo:j,usuarioId:_,usuarioNome:S,usuarioCargo:k,data_inicio:C,data_fim:T,history:I}});if(F)throw F;const z=typeof D?.reply=="string"&&D.reply.trim().length>0?D.reply:"Certo! (resposta provisria)";let q=Array.isArray(D?.replies)?D.replies.filter($=>typeof $=="string"&&$.trim().length>0):[];if(q.length===0&&(q=[z]),console.log("[sis][response]",{replies:q,raw:D}),D)try{console.log("[sis][response raw JSON]",JSON.stringify(D,null,2))}catch{}for(let $=0;$<q.length;$++){const K=q[$];v({from:"isis",text:K}),$<q.length-1&&await new Promise(ce=>setTimeout(ce,600))}i(!1),l("")}catch{v({from:"isis",text:"No momento, estou operando em modo de demonstrao. Em breve estarei 100% conectada  OpenAI aqui na aba Premium! "}),i(!1),l("")}},y=async b=>{b.preventDefault();const w=r.trim();if(!w)return;const j=[...e];console.log("[sis][question]",{message:w}),v({from:"user",text:w}),n(""),i(!0),l(g(w)),await x(w,j)};return o.jsxs("div",{className:"flex h-full w-full relative",children:[o.jsxs("div",{className:"flex-1 flex flex-col pointer-events-none",children:[o.jsxs("div",{className:"flex-1 overflow-y-auto px-3 md:px-6 py-4 md:py-6",children:[e.map(b=>o.jsx(woe,{message:b},b.id)),a&&o.jsx(fr.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start mb-4",children:o.jsx("div",{className:"px-4 py-2 rounded-2xl bg-brand border border-brand text-[#0A0A0A] flex items-center gap-2 animate-pulse",children:s&&s!=="..."?o.jsxs(o.Fragment,{children:[o.jsx("span",{role:"img","aria-label":"pensando",children:""}),o.jsx("span",{children:s})]}):o.jsx("span",{className:"font-semibold tracking-widest",children:"..."})})}),o.jsx("div",{ref:u})]}),o.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:o.jsxs("form",{onSubmit:y,className:"flex items-center gap-2 bg-surface/70 border border-white/10 rounded-xl px-3 py-2.5",children:[o.jsx(fH,{className:"w-5 h-5 text-text-muted"}),o.jsx("input",{value:r,onChange:b=>n(b.target.value),placeholder:"Escreva aqui",className:"flex-1 bg-transparent outline-none text-sm"}),o.jsxs("button",{type:"submit",disabled:!r.trim(),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-semibold transition ${r.trim()?"bg-brand text-bg":"bg-surface/40 text-text-muted cursor-not-allowed"}`,children:[o.jsx(UT,{className:"w-4 h-4"}),"Enviar"]})]})})]}),c&&o.jsx("div",{className:"absolute inset-0 z-10 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto rounded-lg overflow-hidden",children:o.jsx(fr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},transition:{duration:.5,ease:[.22,1,.36,1]},className:"rounded-2xl border border-white/30 bg-gradient-to-br from-slate-900 via-slate-900 to-slate-800 shadow-2xl max-w-sm w-full text-center mx-4 overflow-hidden",children:o.jsxs("div",{className:"px-8 py-10",children:[o.jsx(fr.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.2,duration:.4},className:"flex items-center justify-center mb-8",children:o.jsx("div",{className:"w-24 h-24 rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_20px_rgba(168,85,247,0.5)] overflow-hidden",children:o.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-background flex items-center justify-center",children:o.jsx(ud,{size:"lg"})})})}),o.jsxs(fr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},children:[o.jsx("div",{className:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300 mb-4",children:"sis"}),o.jsx("p",{className:"text-sm text-gray-300 mb-6 leading-relaxed",children:"Em breve sua assistente IA vai estar pronta para revolucionar a gesto da sua arena. "}),o.jsxs("div",{className:"space-y-3 text-left",children:[o.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[o.jsx("span",{className:"text-emerald-400 font-bold mt-0.5",children:""}),o.jsx("span",{children:"Gerencie agendamentos com inteligncia artificial"})]}),o.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[o.jsx("span",{className:"text-violet-400 font-bold mt-0.5",children:""}),o.jsx("span",{children:"Otimize sua agenda e maximize ocupao"})]}),o.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[o.jsx("span",{className:"text-fuchsia-400 font-bold mt-0.5",children:""}),o.jsx("span",{children:"Insights inteligentes sobre sua arena"})]})]})]})]})})})]})}function git({open:e,onOpenChange:t,codigoEmpresa:r,onSuccess:n}){const{toast:a}=ro(),[i,s]=p.useState("upload"),[l,c]=p.useState(null),[d,u]=p.useState(null),[f,m]=p.useState(!1),[h,v]=p.useState({success:!1,comandaId:null,error:null}),g=async j=>{const _=j.target.files?.[0];if(_){if(!_.name.endsWith(".xml")){a({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}c(_);try{const S=await _.text(),k=aS(S);if(!k.success){a({title:"Erro ao ler XML",description:k.error||"XML invlido",variant:"destructive"});return}if(!k.produtos||k.produtos.length===0){a({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(k.nfe?.tipo!=="Sada"){a({title:"Tipo de nota incorreto",description:"Este XML  de entrada. Use a importao em Produtos para notas de entrada.",variant:"warning"});return}u(k),s("preview")}catch(S){console.error("[XMLSalesImport] Erro ao processar arquivo:",S),a({title:"Erro ao processar XML",description:S.message,variant:"destructive"})}}},x=async()=>{s("processing"),m(!0);try{const j=await Uu({searchTerm:"",limit:1e4,codigoEmpresa:r}),_=d.nfe?.dataEmissao?new Date(d.nfe.dataEmissao):new Date,S=d.nfe?.chaveAcesso||"",{data:k,error:E}=await pe.from("comandas").insert({codigo_empresa:r,mesa_id:null,status:"closed",aberto_em:_.toISOString(),fechado_em:_.toISOString(),observacao:`Importado de XML - NF-e ${d.nfe?.numero||""}${S?`
Chave: ${S}`:""}`,origem:"xml",xml_chave:S||null}).select().single();if(E)throw E;const A=[],M=[];for(const T of d.produtos){const I=oS(T,j);if(I){A.push({comanda_id:k.id,produto_id:I.id,descricao:T.nome,quantidade:T.quantidade,preco_unitario:T.valorUnitario,desconto:T.desconto||0,codigo_empresa:r});const D=Math.max(0,(I.stock||I.estoque||0)-T.quantidade);await pe.from("produtos").update({estoque:D}).eq("id",I.id).eq("codigo_empresa",r)}else M.push(T.nome)}if(A.length>0){const{error:T}=await pe.from("comanda_itens").insert(A);if(T)throw T}const C=d.pagamentos||[];if(C.length>0){const{data:T}=await pe.from("finalizadoras").select("id, codigo_sefaz, nome").eq("codigo_empresa",r).eq("ativo",!0),I=new Map((T||[]).map(z=>[z.codigo_sefaz,z])),D=C.map(z=>{const q=I.get(z.codigoSefaz);return{comanda_id:k.id,finalizadora_id:q?.id||null,metodo:z.descricao.toLowerCase(),valor:z.valor,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:S||null}}),{error:F}=await pe.from("pagamentos").insert(D);if(F)throw F}else{const T=d.produtos.reduce((D,F)=>D+(F.valorTotal||0),0),{error:I}=await pe.from("pagamentos").insert({comanda_id:k.id,finalizadora_id:null,metodo:"outros",valor:T,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:S||null});if(I)throw I}console.log("[XMLSalesImport] Venda importada com sucesso. Comanda ID:",k.id),M.length>0?a({title:"Venda importada com avisos",description:`${A.length} produto(s) registrado(s), ${M.length} no encontrado(s).`,variant:"warning",duration:5e3}):a({title:"Venda importada com sucesso!",description:`${A.length} produto(s) registrado(s). Total: R$ ${w.toFixed(2)}`,variant:"success"}),v({success:!0,comandaId:k.id,error:null,produtosNaoEncontrados:M,totalItens:A.length,totalVenda:w,dataEmissao:_.toISOString().slice(0,10)}),s("done"),n&&n(_.toISOString().slice(0,10))}catch(j){console.error("[XMLSalesImport] Erro ao importar:",j),v({success:!1,comandaId:null,error:j.message}),s("done"),a({title:"Erro ao importar XML",description:j.message,variant:"destructive"})}finally{m(!1)}},y=()=>{s("upload"),c(null),u(null),v({success:!1,comandaId:null,error:null}),t(!1)},b=()=>{s("upload"),c(null),u(null)},w=d?.produtos?.reduce((j,_)=>j+(_.valorTotal||0),0)||0;return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(sn,{className:"max-w-3xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-2xl font-bold",children:"Importar XML de Venda (NF-e)"}),o.jsxs(_n,{children:[i==="upload"&&"Selecione o arquivo XML da nota fiscal de sada",i==="preview"&&"Revise os dados da venda que ser importada",i==="processing"&&"Processando venda...",i==="done"&&"Importao finalizada"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-1",children:[i==="upload"&&o.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:o.jsxs("div",{className:"w-full max-w-md",children:[o.jsxs("label",{htmlFor:"xml-sales-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[o.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[o.jsx(WT,{className:"w-12 h-12 mb-4 text-text-muted"}),o.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),o.jsx("p",{className:"text-xs text-text-muted",children:"XML de NF-e de Sada (Venda)"})]}),o.jsx("input",{id:"xml-sales-upload",type:"file",accept:".xml",className:"hidden",onChange:g})]}),l&&o.jsxs("div",{className:"mt-4 p-3 bg-surface-2 rounded-lg flex items-center gap-2",children:[o.jsx(rs,{className:"w-5 h-5 text-success"}),o.jsx("span",{className:"text-sm text-text-primary",children:l.name})]})]})}),i==="preview"&&o.jsxs("div",{className:"space-y-4",children:[d?.nfe&&o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold mb-3",children:"Informaes da NF-e"}),d.fornecedor&&o.jsxs("div",{className:"mb-3 pb-3 border-b border-border",children:[o.jsx("div",{className:"text-sm font-semibold text-text-primary mb-1",children:d.fornecedor.razaoSocial||d.fornecedor.nomeFantasia||"Fornecedor"}),o.jsxs("div",{className:"text-xs text-text-muted",children:[d.fornecedor.cnpj&&`CNPJ: ${d.fornecedor.cnpj}`,d.fornecedor.endereco?.cidade&&d.fornecedor.endereco?.uf&&`  ${d.fornecedor.endereco.cidade}/${d.fornecedor.endereco.uf}`]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",o.jsx("span",{className:"font-mono",children:d.nfe.numero})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",o.jsx("span",{className:"font-mono",children:d.nfe.serie})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",o.jsx("span",{className:"text-warning font-semibold",children:d.nfe.tipo})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Data:"})," ",o.jsx("span",{children:new Date(d.nfe.dataEmissao).toLocaleDateString("pt-BR")})]})]}),d.nfe.naturezaOperacao&&o.jsxs("div",{className:"mb-2 text-sm",children:[o.jsx("span",{className:"text-text-muted",children:"Natureza:"})," ",o.jsx("span",{className:"font-medium",children:d.nfe.naturezaOperacao})]}),d.nfe.totalNota!==void 0&&o.jsxs("div",{className:"mb-3 text-sm",children:[o.jsx("span",{className:"text-text-muted",children:"Total da Nota:"})," ",o.jsxs("span",{className:"font-mono font-semibold text-lg text-success",children:["R$ ",d.nfe.totalNota.toFixed(2)]})]}),d.nfe.chaveAcesso&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[o.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),o.jsx("p",{className:"font-mono text-xs break-all",children:d.nfe.chaveAcesso})]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsxs("h3",{className:"font-semibold mb-3",children:["Produtos da Venda (",d.produtos.length,")"]}),o.jsx("div",{className:"space-y-2",children:d.produtos.map((j,_)=>o.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-start gap-3",children:[o.jsx(U1,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"font-semibold text-sm truncate",children:j.nome}),o.jsxs("p",{className:"text-xs text-text-muted",children:[j.codigo&&`Cdigo: ${j.codigo}  `,"Qtd: ",j.quantidade," ",j.unidade]})]}),o.jsxs("div",{className:"text-right flex-shrink-0",children:[o.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valorTotal.toFixed(2)]}),o.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: R$ ",j.valorUnitario.toFixed(2)]})]})]})})]},_))})]}),d.pagamentos&&d.pagamentos.length>0&&o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsxs("h3",{className:"font-semibold mb-3",children:["Formas de Pagamento (",d.pagamentos.length,")"]}),o.jsx("div",{className:"space-y-2",children:d.pagamentos.map((j,_)=>o.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold text-sm",children:j.descricao}),o.jsxs("p",{className:"text-xs text-text-muted",children:["Cdigo SEFAZ: ",j.codigoSefaz]})]}),o.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valor.toFixed(2)]})]},_))})]}),o.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(pc,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-semibold text-sm mb-1",children:"Ateno: Venda Externa"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Esta venda ser registrada no histrico como uma venda externa (importada de XML). O estoque dos produtos ser subtrado automaticamente."})]})]})}),o.jsxs("div",{className:"flex items-center justify-between text-lg font-bold",children:[o.jsx("span",{children:"Total da Venda:"}),o.jsxs("span",{className:"text-success",children:["R$ ",w.toFixed(2)]})]})]}),i==="processing"&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx(Om,{className:"w-12 h-12 animate-spin text-warning mb-4"}),o.jsx("p",{className:"text-lg font-semibold",children:"Processando venda..."}),o.jsx("p",{className:"text-sm text-text-muted",children:"Criando comanda e atualizando estoque"})]}),i==="done"&&o.jsx("div",{className:"space-y-4",children:o.jsx("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:h.success?o.jsxs(o.Fragment,{children:[o.jsx(Pi,{className:"w-16 h-16 text-success mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Venda Importada com Sucesso!"}),o.jsx("p",{className:"text-sm text-text-muted mb-4",children:"A venda foi registrada no histrico"}),h.produtosNaoEncontrados&&h.produtosNaoEncontrados.length>0&&o.jsxs("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-3 text-left",children:[o.jsx("p",{className:"text-sm font-semibold mb-2",children:" Produtos no encontrados:"}),o.jsx("ul",{className:"text-xs text-text-muted space-y-1",children:h.produtosNaoEncontrados.map((j,_)=>o.jsxs("li",{children:[" ",j]},_))})]})]}):o.jsxs(o.Fragment,{children:[o.jsx(pc,{className:"w-16 h-16 text-danger mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Erro na Importao"}),o.jsx("p",{className:"text-sm text-text-muted",children:h.error||"Ocorreu um erro ao importar a venda"})]})})})]}),o.jsxs(Un,{children:[i==="upload"&&o.jsx(le,{variant:"outline",onClick:y,children:"Cancelar"}),i==="preview"&&o.jsxs(o.Fragment,{children:[o.jsx(le,{variant:"outline",onClick:b,children:"Voltar"}),o.jsx(le,{onClick:x,children:"Confirmar Importao"})]}),i==="done"&&o.jsx(le,{onClick:y,children:"Fechar"})]})]})})}const vit={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},sy={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function xit(e,t=300){const[r,n]=p.useState(e);return p.useEffect(()=>{const a=setTimeout(()=>n(e),t);return()=>clearTimeout(a)},[e,t]),r}function tj({value:e,onChange:t}){const[r,n]=p.useState(!1),a=p.useRef(null),i=p.useRef(null),s=p.useRef(null),[l,c]=p.useState({top:0,left:0,width:0,center:!1,mode:"fixed"});p.useEffect(()=>{function g(b){const w=b.target,j=a.current&&a.current.contains(w),_=s.current&&s.current.contains(w);!j&&!_&&n(!1)}function x(b){b.key==="Escape"&&n(!1)}function y(){r&&d()}return window.addEventListener("mousedown",g),window.addEventListener("keydown",x),window.addEventListener("scroll",y,!0),window.addEventListener("resize",y),()=>{window.removeEventListener("mousedown",g),window.removeEventListener("keydown",x),window.removeEventListener("scroll",y,!0),window.removeEventListener("resize",y)}},[r]),p.useEffect(()=>{if(r){const g=requestAnimationFrame(()=>{d();const x=requestAnimationFrame(()=>d());return()=>cancelAnimationFrame(x)});return()=>cancelAnimationFrame(g)}},[r]),p.useEffect(()=>{if(r&&l.mode==="overlay"){const g=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=g}}},[r,l.mode]);const d=()=>{try{const g=i.current;if(!g)return;const x=g.getBoundingClientRect(),y=window.innerWidth,b=window.innerHeight,w=8,j=Math.max(x.width,280),_=Math.min(y-w*2,360),S=Math.min(j,_);let k=320;if(s.current)try{k=s.current.getBoundingClientRect().height||k}catch{}if(y<=640){c({top:0,left:0,width:Math.min(y-w*2,360),center:!0,mode:"overlay"});return}const E=a.current,A=E?E.getBoundingClientRect():x,M=x.bottom-A.top+6,C=Math.max(x.width,280);c({top:M,left:0,width:C,center:!1,mode:"anchor"})}catch{}},u=g=>{try{const[x,y,b]=String(g||"").split("-").map(Number);return!x||!y||!b?null:new Date(x,y-1,b)}catch{return null}},f=g=>{const x=y=>String(y).padStart(2,"0");return`${g.getFullYear()}-${x(g.getMonth()+1)}-${x(g.getDate())}`},m=g=>{const x=y=>String(y).padStart(2,"0");return`${x(g.getDate())}/${x(g.getMonth()+1)}/${g.getFullYear()}`},h=u(e),v=h?m(h):"";return o.jsxs("div",{className:"relative",ref:a,children:[o.jsx("button",{type:"button",className:"absolute left-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-warning/10 focus:outline-none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},"aria-label":"Abrir calendrio",children:o.jsx(Kde,{className:"h-4 w-4 text-warning"})}),typeof window<"u"&&window.innerWidth<=640?o.jsx("button",{type:"button",ref:i,onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(!0),setTimeout(d,0)},className:"pl-9 pr-3 h-10 w-full text-left bg-surface text-text-primary border border-warning/40 rounded-md",children:v||"Selecionar data"}):o.jsx(ir,{type:"text",readOnly:!0,ref:i,inputMode:"none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},className:"pl-9 pr-3 w-full bg-surface text-text-primary border border-warning/40 focus-visible:ring-warning focus-visible:border-warning",value:v}),r&&(l.mode==="overlay"?o.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",onClick:g=>{g.target===g.currentTarget&&n(!1)},children:o.jsx("div",{ref:s,className:"bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 w-[92vw] max-w-[360px]",children:o.jsx(wc,{mode:"single",selected:h||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})})}):l.mode==="anchor"?o.jsx("div",{ref:s,className:"absolute z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 left-0",style:{top:`${l.top}px`,minWidth:`${l.width}px`,maxWidth:"92vw"},children:o.jsx(wc,{mode:"single",selected:h||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}):o.jsx("div",{ref:s,className:"fixed z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2",style:{top:`${l.top}px`,left:`${l.left}px`,width:`${l.width}px`,maxWidth:"92vw"},children:o.jsx(wc,{mode:"single",selected:h||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}))]})}function yit(){const{toast:e}=ro(),t=Fl(),{userProfile:r}=Do(),[n]=ES(),a=n.get("mesa"),[i,s]=p.useState(!1),[l,c]=p.useState([]),[d,u]=p.useState(()=>a?"":new Date().toISOString().slice(0,10)),[f,m]=p.useState(()=>a?"":new Date().toISOString().slice(0,10)),[h,v]=p.useState(()=>a?"all":"closed"),[g,x]=p.useState(""),y=xit(g,350),[b,w]=p.useState("all"),[j,_]=p.useState("comandas"),[S,k]=p.useState(!1),[E,A]=p.useState(""),[M,C]=p.useState(null),[T,I]=p.useState({loading:!1,itens:[],pagamentos:[]}),[D,F]=p.useState(null),[z,q]=p.useState({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null},movs:[]}),[$,K]=p.useState(!1),[ce,fe]=p.useState(!1),[B,L]=p.useState(!1),V=async()=>{try{e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"});const we=await Bq({status:h,from:d||void 0,to:f||void 0,search:y||"",limit:1e4,offset:0});if(!we||we.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const ye=we.map(mt=>mt.id),te=await Z3(ye,r?.codigo_empresa),$e=await bp(r?.codigo_empresa),Pe=new Map($e.map(mt=>[mt.id,mt.numero])),It=await $q(ye),Dt=await Fq(ye),kt=we.map(mt=>{const Be=mt.mesa_id?`Mesa ${Pe.get(mt.mesa_id)||"?"}`:"Balco",$t=It[mt.id]||"Sem cliente",Ee=Dt[mt.id],Ct=Array.isArray(Ee)?Ee.join(", "):Ee||"No informado",hr=mt.fechado_em?"Fechada":"Aberta";return{Tipo:mt.tipo==="balcao"?"Balco":"Mesa","Mesa/Local":Be,"Cliente(s)":$t,Status:hr,Abertura:new Date(mt.aberto_em).toLocaleString("pt-BR"),Fechamento:mt.fechado_em?new Date(mt.fechado_em).toLocaleString("pt-BR"):"-","Total (R$)":Number(te[mt.id]||0).toFixed(2),"Forma(s) Pagamento":Ct,Observaes:mt.observacao||"-"}}),cr=Object.keys(kt[0]),Cr=[cr.join(";"),...kt.map(mt=>cr.map(Be=>{const $t=mt[Be]||"";return`"${String($t).replace(/"/g,'""')}"`}).join(";"))].join(`
`),Ie=new Blob(["\uFEFF"+Cr],{type:"text/csv;charset=utf-8;"}),ke=document.createElement("a"),Je=URL.createObjectURL(Ie);ke.setAttribute("href",Je),ke.setAttribute("download",`historico_comandas_${new Date().toISOString().slice(0,10)}.csv`),ke.style.visibility="hidden",document.body.appendChild(ke),ke.click(),document.body.removeChild(ke),e({title:"CSV exportado!",description:`${kt.length} comandas exportadas`,variant:"success"})}catch(we){console.error("Erro ao exportar CSV:",we),e({title:"Erro ao exportar",description:we.message,variant:"destructive"})}},re=async()=>{try{if(e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"}),!l||l.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const we=l.map(Dt=>{const kt=Dt.status==="open"?"Aberto":Dt.status==="closed"?"Fechado":Dt.status;return{"Data Abertura":Dt.aberto_em?new Date(Dt.aberto_em).toLocaleString("pt-BR"):"-","Data Fechamento":Dt.fechado_em?new Date(Dt.fechado_em).toLocaleString("pt-BR"):"-",Status:kt,"Saldo Inicial (R$)":Number(Dt.saldo_inicial||0).toFixed(2),"Saldo Final (R$)":Number(Dt.saldo_final||0).toFixed(2),"Valor Contado (R$)":Dt.valor_final_dinheiro?Number(Dt.valor_final_dinheiro).toFixed(2):"-","Diferena (R$)":Dt.diferenca_dinheiro?Number(Dt.diferenca_dinheiro).toFixed(2):"-"}}),ye=Object.keys(we[0]),te=[ye.join(";"),...we.map(Dt=>ye.map(kt=>{const cr=Dt[kt]||"";return`"${String(cr).replace(/"/g,'""')}"`}).join(";"))].join(`
`),$e=new Blob(["\uFEFF"+te],{type:"text/csv;charset=utf-8;"}),Pe=document.createElement("a"),It=URL.createObjectURL($e);Pe.setAttribute("href",It),Pe.setAttribute("download",`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`),Pe.style.visibility="hidden",document.body.appendChild(Pe),Pe.click(),document.body.removeChild(Pe),e({title:"CSV exportado!",description:`${we.length} fechamentos exportados`,variant:"success"})}catch(we){console.error("Erro ao exportar CSV:",we),e({title:"Erro ao exportar",description:we.message,variant:"destructive"})}},me=100,[G,Q]=p.useState(0),[ae,J]=p.useState(!1),je=p.useRef(!1),be=p.useRef(0),Ue=p.useRef(0),Z=p.useRef(!1),Y=()=>{try{const we=localStorage.getItem("auth:userProfile");return we&&JSON.parse(we)?.codigo_empresa||null}catch{return null}},lt=p.useMemo(()=>`hist:comandas:${Y()||"na"}:${d}:${f}:${h}:${b}:${(y||"").trim()}`,[d,f,h,b,y]),gt=async({append:we=!1,skipCacheWrite:ye=!1}={})=>{try{s(!0);const te=Y();if(!te){s(!1);return}const $e=setTimeout(()=>s(!1),1e4);if(j==="comandas"){const Pe=!!(y&&y.trim()),It=Pe?1e3:me,Dt=Pe?0:G;console.log("[HistoricoComandasPage] Carregando com:",{status:h,from:d,to:f,search:y,mesaId:a,searching:Pe,effLimit:It});const kt=await Bq({status:h,from:d,to:f,search:a||y,limit:It,offset:Dt});console.log("[HistoricoComandasPage] Resultado:",kt?.length||0,"comandas");const cr=(kt||[]).map($t=>$t.id);let Cr={};if(cr.length>0)try{Cr=await Z3(cr,te)}catch{Cr={}}let Ie=[];try{Ie=await bp(te)}catch{Ie=[]}const ke=new Map((Ie||[]).map($t=>[$t.id,$t.numero]));let Je={},mt={};try{Je=await $q(cr)}catch{Je={}}try{mt=await Fq(cr)}catch{mt={}}const Be=(kt||[]).map($t=>{const Ee=Je[$t.id],Ct=mt[$t.id];return{...$t,statusDerived:$t.status==="cancelled"?"cancelled":$t.fechado_em?"closed":$t.status||"open",total:Number(Cr[$t.id]||0),mesaNumero:ke.get($t.mesa_id),clientesStr:Array.isArray(Ee)?Ee.join(", "):Ee||"",finalizadorasStr:Array.isArray(Ct)?Ct.join(", "):Ct||""}});if(J(Pe?!1:(kt||[]).length===me),c(we?$t=>[...$t,...Be]:Be),!ye)try{localStorage.setItem(lt,JSON.stringify({ts:Date.now(),rows:Be}))}catch{}}else{const Pe=await ere({from:d,to:f,limit:100,offset:0,codigoEmpresa:te});c(Pe||[])}clearTimeout($e)}catch(te){e({title:"Falha ao carregar histrico",description:te?.message||"Tente novamente",variant:"destructive"})}finally{s(!1),be.current=Date.now()}};p.useEffect(()=>{a&&(async()=>{try{const te=(await bp(r?.codigo_empresa)||[]).find($e=>$e.id===a);te&&A(`Mesa ${te.numero}`)}catch{}})()},[a,r?.codigo_empresa]),p.useEffect(()=>{if(je.current=!0,j==="comandas")try{const we=localStorage.getItem(lt);if(we){const ye=JSON.parse(we);ye&&Array.isArray(ye.rows)&&Date.now()-Number(ye.ts||0)<12e4&&c(ye.rows)}}catch{}return()=>{je.current=!1}},[lt,j]),p.useEffect(()=>{j==="comandas"&&(Q(0),J(!1)),gt({append:!1})},[h,y,d,f,j]),p.useEffect(()=>{if(!i&&j==="comandas"&&l.length===0){const we=setTimeout(()=>{je.current&&gt({append:!1,skipCacheWrite:!1})},1500);return()=>clearTimeout(we)}},[l.length,i,j]),p.useEffect(()=>{const we=()=>{document.visibilityState==="visible"&&Date.now()-(be.current||0)>3e4&&gt({append:!1})},ye=()=>{Date.now()-(be.current||0)>3e4&&gt({append:!1})};return window.addEventListener("visibilitychange",we),window.addEventListener("focus",ye),()=>{window.removeEventListener("visibilitychange",we),window.removeEventListener("focus",ye)}},[lt,j]);const Te=async we=>{C(we),I({loading:!0,itens:[],pagamentos:[]});const ye=Y();Z.current=!0;const te=++Ue.current,$e=setTimeout(()=>{Ue.current===te&&Z.current&&I(Pe=>({...Pe,loading:!1}))},1e4);if(!ye){clearTimeout($e),Ue.current===te&&Z.current&&I({loading:!1,itens:[],pagamentos:[]});return}try{const Pe=(l||[]).find(It=>It.id===we)||null;if(Pe){const It=Pe.mesa_id==null?"Balco":Pe.mesaNumero!=null?`Mesa ${Pe.mesaNumero}`:"Comanda";F({mesaLabel:It,clientesStr:Pe.clientesStr||"",aberto_em:Pe.aberto_em||null,fechado_em:Pe.fechado_em||null,tipo:Pe.mesa_id==null?"balcao":"comanda",status:Pe.statusDerived||Pe.status||"open",diferenca_pagamento:typeof Pe.diferenca_pagamento=="number"?Pe.diferenca_pagamento:0})}else F(null)}catch{F(null)}try{const Pe=async()=>{const[Dt,kt]=await Promise.all([Si({comandaId:we,codigoEmpresa:ye}),Qte({comandaId:we,codigoEmpresa:ye})]);let cr=[];try{cr=await Qi({comandaId:we,codigoEmpresa:ye})}catch{}console.log("[openDetail] clientesVinc:",cr);const Cr=new Map((cr||[]).map(Je=>{const mt=Je?.cliente_id??Je?.clientes?.id??null,Be=Je?.clientes?.nome??Je?.nome??Je?.nome_livre??"";return console.log(`[openDetail] Mapeando cliente: cid=${mt}, nome=${Be}`),mt?[String(mt),Be]:null}).filter(Boolean));console.log("[openDetail] nomeById map:",Array.from(Cr.entries()));const Ie=[...Array.from(Cr.values()),...(cr||[]).filter(Je=>!Je?.cliente_id&&(Je?.nome_livre||Je?.nome)).map(Je=>Je?.nome_livre||Je?.nome||"Consumidor")];console.log("[openDetail] clientesDisponiveis:",Ie),console.log("[openDetail] pagamentos:",kt);const ke=(kt||[]).map((Je,mt)=>{let Be="";return Je?.cliente_id?(Be=Cr.get(String(Je.cliente_id))||"",!Be&&Ie.length>0&&(Be=Ie[mt%Ie.length])):Ie.length>0&&(Be=Ie[mt%Ie.length]),console.log(`[openDetail] Pagamento ${mt}: cliente_id=${Je?.cliente_id}, clienteNome=${Be}`),{...Je,cliente_nome:Be,finalizadora_nome:Je?.finalizadoras?.nome||Je?.metodo||""}});return{itens:Dt||[],pagamentos:ke}};let It=await Pe();It.itens.length===0&&It.pagamentos.length===0&&(await new Promise(Dt=>setTimeout(Dt,700)),It=await Pe()),Ue.current===te&&Z.current&&I({loading:!1,itens:It.itens,pagamentos:It.pagamentos})}catch(Pe){Ue.current===te&&Z.current&&I({loading:!1,itens:[],pagamentos:[]}),e({title:"Falha ao carregar detalhes",description:Pe?.message||"Tente novamente",variant:"destructive"})}finally{clearTimeout($e),Ue.current===te&&Z.current&&I(Pe=>({...Pe,loading:!1}))}},at=p.useMemo(()=>({sum:l.reduce((ye,te)=>ye+Number(te.total||0),0)}),[l]),yt=we=>(we||"").toString().toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,""),vt=p.useMemo(()=>{const we=(y||"").trim(),ye=yt(we),$e=l.filter(Pe=>{const It=Pe.mesa_id==null;return!(b==="balcao"&&!It||b==="comanda"&&It)}).filter(Pe=>{const It=Pe.statusDerived||(Pe.status==="cancelled"?"cancelled":Pe.fechado_em?"closed":Pe.status||"open");return h==="closed"?It==="closed":h==="open"?It==="open":h==="awaiting-payment"?It==="awaiting-payment":h==="cancelled"?It==="cancelled":!0});return ye?$e.filter(Pe=>{const It=Pe.mesaNumero!=null?String(Pe.mesaNumero):"",Dt=Pe.mesa_id==null?"balcao":`mesa ${It}`;return[It,Dt,Pe.clientesStr||"",Pe.finalizadorasStr||"",Pe.mesa_id==null?"balcao":"comanda",Pe.statusDerived||Pe.status||""].map(yt).join(" | ").includes(ye)}):$e},[l,y,b,h]),Sr=we=>we==="open"?"Aberta":we==="awaiting-payment"?"Pagamento":we==="closed"?"Fechada":we==="cancelled"?"Cancelada":we||"",se=we=>{if(!we)return"";try{return new Date(we).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}},Ze=we=>{const ye=String(we||"").toLowerCase();return ye==="open"?"Aberto":ye==="closed"?"Fechado":""},ct=we=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(we||0)),Qt=we=>we==="open"?"text-info bg-info/10 border-info/30":we==="awaiting-payment"?"text-warning bg-warning/10 border-warning/30":we==="closed"?"text-success bg-success/10 border-success/30":we==="cancelled"?"text-red-400 bg-red-500/10 border-red-500/30":"text-text-secondary bg-transparent border-border/50";return o.jsxs(fr.div,{variants:vit,initial:"hidden",animate:"visible",className:"min-h-screen flex flex-col",children:[o.jsxs(fr.div,{variants:sy,className:"mb-6 gap-3 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[o.jsx(Vd,{value:"historico",onValueChange:we=>{we==="mesas"&&t("/vendas"),we==="balcao"&&t("/balcao"),we==="historico"&&t("/historico")},children:o.jsxs(sd,{className:"grid w-full sm:w-auto grid-cols-3 sm:inline-flex",children:[o.jsx(ba,{value:"mesas",children:"Mesas"}),o.jsx(ba,{value:"balcao",children:"Balco"}),o.jsx(ba,{value:"historico",children:"Histrico"})]})}),o.jsxs("div",{className:"w-full flex items-center gap-2 sm:gap-3",children:[o.jsxs("div",{className:"flex sm:hidden items-center gap-2 w-full",children:[o.jsxs(En,{value:j,onValueChange:_,children:[o.jsx(Sn,{className:"w-[160px] text-sm",children:o.jsx(kn,{placeholder:"Selecionar"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"comandas",children:"Comandas"}),o.jsx(Nt,{value:"fechamentos",children:"Fechamentos"})]})]}),o.jsxs("div",{className:"ml-auto text-xs text-text-secondary whitespace-nowrap",children:["Total: ",o.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",at.sum.toFixed(2)]})]}),j==="comandas"&&o.jsx(le,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:()=>fe(!0),title:"Aes",children:o.jsx(ei,{className:"h-4 w-4"})}),j==="fechamentos"&&o.jsx(le,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:re,title:"Exportar",children:o.jsx(ei,{className:"h-4 w-4"})})]}),o.jsx("div",{className:"hidden sm:flex items-center gap-2 sm:gap-3 ml-auto",children:o.jsx(Vd,{value:j,onValueChange:_,className:"w-full sm:w-auto",children:o.jsxs(sd,{className:"w-full grid grid-cols-2 sm:w-auto sm:inline-flex text-sm",children:[o.jsx(ba,{value:"comandas",className:"text-sm",children:"Comandas"}),o.jsx(ba,{value:"fechamentos",className:"text-sm",children:"Fechamentos"})]})})})]}),o.jsxs("div",{className:"hidden sm:flex w-full sm:w-auto items-center gap-2 sm:gap-3",children:[j==="comandas"&&o.jsxs(o.Fragment,{children:[o.jsxs(le,{variant:"secondary",size:"sm",className:"hidden sm:inline-flex",onClick:()=>K(!0),children:[o.jsx(rs,{className:"mr-2 h-4 w-4"}),"Importar XML"]}),o.jsxs(le,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:V,children:[o.jsx(ei,{className:"mr-1 h-3 w-3"}),"Exportar"]}),o.jsx("button",{className:"hidden sm:inline-block text-xs text-text-muted hover:text-text-primary transition-colors",onClick:()=>{if(B){const we=new Date().toISOString().slice(0,10);u(we),m(we),L(!1)}else u(""),m(""),L(!0);Q(0)},title:B?"Voltar ao filtro de hoje":"Mostrar todas as comandas",children:B?"":""}),o.jsxs("div",{className:"text-sm text-text-secondary whitespace-nowrap ml-auto",children:["Total: ",o.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",at.sum.toFixed(2)]})]})]}),j==="fechamentos"&&o.jsxs(le,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:re,children:[o.jsx(ei,{className:"mr-1 h-3 w-3"}),"Exportar"]})]})]}),o.jsx(ln,{open:ce,onOpenChange:fe,children:o.jsxs(sn,{className:"sm:hidden w-[92vw] max-w-[360px] p-2",onOpenAutoFocus:we=>we.preventDefault(),onKeyDown:we=>we.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{className:"text-base",children:"Aes"}),o.jsx(_n,{children:"Escolha uma ao para Comandas"})]}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs(le,{variant:"secondary",onClick:()=>{fe(!1),K(!0)},children:[o.jsx(rs,{className:"mr-2 h-4 w-4"})," Importar XML"]}),o.jsxs(le,{variant:"outline",onClick:()=>{fe(!1),V()},children:[o.jsx(ei,{className:"mr-2 h-4 w-4"})," Exportar CSV"]})]})]})}),j==="comandas"&&o.jsxs("div",{className:"flex items-center justify-between mt-2",children:[o.jsxs("div",{className:"text-xs text-text-secondary",children:["Carregadas ",l.length," ",l.length===1?"comanda":"comandas"]}),ae&&o.jsx(le,{size:"sm",variant:"outline",disabled:i,onClick:async()=>{const we=G+me;Q(we),await gt({append:!0})},children:"Carregar mais"})]}),j==="comandas"&&o.jsxs("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Buscar...",className:"pl-9 h-9 text-sm",value:g,onChange:we=>x(we.target.value)})]}),o.jsx(le,{size:"sm",variant:"outline",className:"h-9",onClick:()=>k(we=>!we),children:S?"Ocultar":"Filtros"})]}),o.jsxs("div",{className:"mt-1 text-[11px] text-text-secondary truncate",children:[d||"","  ",f||""]})]}),j==="comandas"&&o.jsx(fr.div,{variants:sy,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${S?"":"hidden"} sm:block`,children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[o.jsxs("div",{children:[o.jsx(Ht,{className:"mb-1 block",children:"Perodo Inicial"}),o.jsx(tj,{value:d,onChange:u})]}),o.jsxs("div",{children:[o.jsx(Ht,{className:"mb-1 block",children:"Perodo Final"}),o.jsx(tj,{value:f,onChange:m})]}),o.jsxs("div",{className:"md:col-span-2 hidden sm:block",children:[o.jsxs(Ht,{className:"mb-1 block",children:["Busca ",E&&o.jsxs("span",{className:"text-xs text-warning ml-1",children:["(",E,")"]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(ir,{placeholder:"Mesa, status (fechada/aberta) ou cliente",className:"pl-9 pr-12",value:g,onChange:we=>x(we.target.value)}),a&&o.jsx(le,{size:"sm",variant:"ghost",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 text-xs",onClick:()=>{t("/historico")},children:" Limpar"})]})]}),o.jsxs("div",{children:[o.jsx(Ht,{className:"mb-1 block",children:"Status"}),o.jsxs(En,{value:h,onValueChange:v,children:[o.jsx(Sn,{className:"w-full text-xs",children:o.jsx(kn,{placeholder:"Selecionar status"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"closed",children:"Fechadas"}),o.jsx(Nt,{value:"open",children:"Abertas"}),o.jsx(Nt,{value:"awaiting-payment",children:"Pagamento"}),o.jsx(Nt,{value:"cancelled",children:"Canceladas"})]})]})]}),o.jsxs("div",{children:[o.jsx(Ht,{className:"mb-1 block",children:"Tipo"}),o.jsxs(En,{value:b,onValueChange:w,children:[o.jsx(Sn,{className:"w-full text-xs",children:o.jsx(kn,{placeholder:"Selecionar tipo"})}),o.jsxs(Cn,{children:[o.jsx(Nt,{value:"all",children:"Todos"}),o.jsx(Nt,{value:"comanda",children:"Comandas"}),o.jsx(Nt,{value:"balcao",children:"Balco"})]})]})]})]})}),j==="comandas"&&o.jsxs(fr.div,{variants:sy,className:"bg-surface rounded-lg border border-border p-0 overflow-hidden",children:[o.jsx("div",{className:"hidden sm:block overflow-x-auto pr-2 sm:pr-3",children:o.jsxs("table",{className:"min-w-full text-sm",children:[o.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Mesa"}),o.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Tipo"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Clientes"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Finalizadora"}),o.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Abertura"}),o.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Fechamento"}),o.jsx("th",{className:"text-right px-4 py-3 whitespace-nowrap",children:"Diferena"}),o.jsx("th",{className:"text-right px-4 py-3",children:"Total"})]})}),o.jsxs("tbody",{children:[vt.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"px-4 py-6 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."})}),vt.map(we=>o.jsxs("tr",{className:"border-t border-border/70 hover:bg-warning/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:()=>Te(we.id),children:[o.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:we.mesa_id==null?"Balco":we.mesaNumero!=null?`Mesa ${we.mesaNumero}`:""}),o.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:we.mesa_id==null?"Balco":"Comanda"}),o.jsx("td",{className:"px-4 py-2 break-words",title:we.clientesStr||"",children:we.clientesStr||""}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("span",{className:Jt("inline-flex items-center text-[11px] font-medium px-2 py-0.5 rounded-full border",Qt(we.statusDerived||we.status)),children:Sr(we.statusDerived||we.status)})}),o.jsx("td",{className:"px-4 py-2 break-words",title:we.finalizadorasStr||"",children:we.finalizadorasStr||""}),o.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:se(we.aberto_em)}),o.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:se(we.fechado_em)}),o.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:(()=>{const ye=typeof we.diferenca_pagamento=="number"?we.diferenca_pagamento:0;if(Math.abs(ye)<.005)return o.jsx("span",{className:"text-xs text-text-muted",children:"R$ 0,00"});const te=ye>0?"text-emerald-500":"text-amber-500",$e=ye>0?"+":"-";return o.jsx("span",{className:`text-xs font-semibold ${te}`,children:`${$e} R$ ${Math.abs(ye).toFixed(2)}`})})()}),o.jsx("td",{className:"px-4 py-2 text-right font-semibold whitespace-nowrap",children:ct(we.total)})]},we.id))]})]})}),o.jsxs("div",{className:"sm:hidden divide-y divide-border",children:[vt.length===0&&o.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."}),vt.map(we=>o.jsxs("button",{className:"w-full text-left p-3 active:bg-warning/10",onClick:()=>Te(we.id),children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:we.mesa_id==null?"Balco":we.mesaNumero!=null?`Mesa ${we.mesaNumero}`:"Comanda"}),o.jsx("div",{className:"font-semibold truncate max-w-[220px]",children:we.clientesStr||"Sem cliente"})]}),o.jsx("div",{children:o.jsx("div",{className:Jt("inline-flex items-center text-[10px] font-medium px-2 py-0.5 rounded-full border",Qt(we.statusDerived||we.status)),children:Sr(we.statusDerived||we.status)})})]}),o.jsx("div",{className:"mt-1 text-xs text-text-secondary truncate",children:we.finalizadorasStr||""}),o.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0 text-[11px] text-text-muted truncate pr-2",children:[se(we.aberto_em),we.fechado_em?`  ${se(we.fechado_em)}`:""]}),o.jsxs("div",{className:"flex-shrink-0 text-right min-w-[84px]",children:[o.jsx("div",{className:"text-[11px]",children:(()=>{const ye=typeof we.diferenca_pagamento=="number"?we.diferenca_pagamento:0;if(Math.abs(ye)<.005)return o.jsx("span",{className:"text-text-muted",children:"Dif.: R$ 0,00"});const te=ye>0?"text-emerald-500":"text-amber-500",$e=ye>0?"+":"-";return o.jsx("span",{className:te,children:`Dif.: ${$e} R$ ${Math.abs(ye).toFixed(2)}`})})()}),o.jsx("div",{className:"font-mono font-semibold whitespace-nowrap",children:ct(we.total)})]})]})]},we.id))]})]}),j==="fechamentos"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("div",{className:"text-sm font-medium",children:"Filtros"}),o.jsx(le,{size:"sm",variant:"outline",onClick:()=>k(we=>!we),children:S?"Ocultar filtros":"Mostrar filtros"})]})}),o.jsx(fr.div,{variants:sy,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${S?"":"hidden"} sm:block`,children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[o.jsxs("div",{children:[o.jsx(Ht,{className:"mb-1 block",children:"Perodo Inicial"}),o.jsx(tj,{value:d,onChange:u})]}),o.jsxs("div",{children:[o.jsx(Ht,{className:"mb-1 block",children:"Perodo Final"}),o.jsx(tj,{value:f,onChange:m})]})]})}),o.jsxs(fr.div,{variants:sy,className:"bg-surface rounded-lg border border-border p-4 overflow-hidden",children:[o.jsxs("div",{className:"sm:hidden space-y-2",children:[i&&(!l||l.length===0)&&o.jsxs("div",{className:"px-2 py-3 text-center text-text-muted",children:[o.jsx(Om,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]}),(!l||l.length===0)&&!i&&o.jsx("div",{className:"px-2 py-3 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."}),(l||[]).map(we=>o.jsxs("button",{onClick:async()=>{try{q({open:!0,loading:!0,resumo:null,periodo:{from:we.aberto_em,to:we.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:we?.saldo_inicial??null,final:we?.saldo_final??null}});const ye=Y(),[te,$e]=await Promise.all([q_({caixaSessaoId:we.id,codigoEmpresa:ye}).catch(()=>null),Ip({caixaSessaoId:we.id,codigoEmpresa:ye}).catch(()=>[])]);let Pe=te?.movimentos||null;if(!Pe&&Array.isArray($e)){const Dt={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const kt of $e){const cr=String(kt?.tipo||"").toLowerCase(),Cr=Number(kt?.valor||0);cr==="suprimento"?Dt.suprimentos+=Cr:cr==="sangria"?Dt.sangrias+=Cr:cr==="ajuste"?Dt.ajustes+=Cr:cr==="troco"&&(Dt.troco+=Cr)}Pe=Dt}const It=te?{totalDescontos:Number(te.total_descontos||0),totalVendasLiquidas:Number(te.total_liquido||0),totalEntradas:Number(te.total_entradas||0),totalPorFinalizadora:te.por_finalizadora||{}}:null;q({open:!0,loading:!1,resumo:It,periodo:{from:te?.periodo_de||we.aberto_em,to:te?.periodo_ate||we.fechado_em},movs:$e||[],movimentosAgg:Pe,saldos:{inicial:we?.saldo_inicial??null,final:we?.saldo_final??null}})}catch{q({open:!0,loading:!1,resumo:null,periodo:{from:we.aberto_em,to:we.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:we?.saldo_inicial??null,final:we?.saldo_final??null}})}},className:"w-full text-left p-3 rounded-lg border border-border hover:bg-surface-2 transition",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"text-xs text-text-secondary",children:[se(we.aberto_em),o.jsx("span",{className:"mx-1",children:""}),se(we.fechado_em)]}),o.jsx("div",{className:"text-[11px] px-2 py-0.5 rounded-full border bg-success/10 text-success border-success/30",children:Ze(we.status)})]}),o.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2 text-xs",children:[o.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[o.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Inicial"}),o.jsx("div",{className:"font-semibold",children:we?.saldo_inicial!=null?ct(we.saldo_inicial):""})]}),o.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[o.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Final (contado)"}),o.jsx("div",{className:"font-semibold",children:we?.valor_final_dinheiro!=null?ct(we.valor_final_dinheiro):""})]})]})]},we.id))]}),o.jsx("div",{className:"hidden sm:block overflow-x-auto max-h-[60vh] overflow-y-auto pr-2 sm:pr-3",children:o.jsxs("table",{className:"min-w-full text-sm",children:[o.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-4 py-3",children:"Abertura"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Fechamento"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),o.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Inicial"}),o.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Final (contado)"})]})}),o.jsxs("tbody",{children:[i&&(!l||l.length===0)&&o.jsx("tr",{children:o.jsxs("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:[o.jsx(Om,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]})}),(!l||l.length===0)&&o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."})}),(l||[]).map(we=>o.jsxs("tr",{className:"border-t border-border/70 hover:bg-success/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:async()=>{try{q({open:!0,loading:!0,resumo:null,periodo:{from:we.aberto_em,to:we.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:we?.saldo_inicial??null,final:we?.saldo_final??null}});const ye=async()=>{const Pe=Y(),[It,Dt]=await Promise.all([q_({caixaSessaoId:we.id,codigoEmpresa:Pe}).catch(()=>null),Ip({caixaSessaoId:we.id,codigoEmpresa:Pe}).catch(()=>[])]);return{snap:It,movs:Dt}};let{snap:te,movs:$e}=await ye();if(te||(await new Promise(Pe=>setTimeout(Pe,700)),{snap:te,movs:$e}=await ye()),te){const Pe={totalDescontos:Number(te.total_descontos||0),totalVendasLiquidas:Number(te.total_liquido||0),totalEntradas:Number(te.total_entradas||0),totalPorFinalizadora:te.por_finalizadora||{}};let It=te.movimentos||null;if(!It&&Array.isArray($e)){const Dt={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const kt of $e){const cr=String(kt?.tipo||"").toLowerCase(),Cr=Number(kt?.valor||0);cr==="suprimento"?Dt.suprimentos+=Cr:cr==="sangria"?Dt.sangrias+=Cr:cr==="ajuste"?Dt.ajustes+=Cr:cr==="troco"&&(Dt.troco+=Cr)}It=Dt}q({open:!0,loading:!1,resumo:Pe,periodo:{from:te.periodo_de||we.aberto_em,to:te.periodo_ate||we.fechado_em},movs:$e||[],movimentosAgg:It,saldos:{inicial:typeof te.saldo_inicial<"u"?Number(te.saldo_inicial):we?.saldo_inicial??null,final:typeof te.valor_final_dinheiro<"u"?Number(te.valor_final_dinheiro):we?.valor_final_dinheiro??null}})}else{const Pe=Y(),It=await id({from:we.aberto_em,to:we.fechado_em||new Date().toISOString(),codigoEmpresa:Pe});let Dt=null;if(Array.isArray($e)){const kt={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const cr of $e){const Cr=String(cr?.tipo||"").toLowerCase(),Ie=Number(cr?.valor||0);Cr==="suprimento"?kt.suprimentos+=Ie:Cr==="sangria"?kt.sangrias+=Ie:Cr==="ajuste"?kt.ajustes+=Ie:Cr==="troco"&&(kt.troco+=Ie)}Dt=kt}q({open:!0,loading:!1,resumo:It||null,periodo:{from:we.aberto_em,to:we.fechado_em},movs:$e||[],movimentosAgg:Dt,saldos:{inicial:we?.saldo_inicial??null,final:we?.valor_final_dinheiro??null}})}}catch{q({open:!0,loading:!1,resumo:null,periodo:{from:we.aberto_em,to:we.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:we?.saldo_inicial??null,final:we?.valor_final_dinheiro??null}})}},children:[o.jsx("td",{className:"px-4 py-2",children:se(we.aberto_em)}),o.jsx("td",{className:"px-4 py-2",children:se(we.fechado_em)}),o.jsx("td",{className:"px-4 py-2",children:Ze(we.status)}),o.jsx("td",{className:"px-4 py-2 text-right",children:we?.saldo_inicial!=null?ct(we.saldo_inicial):""}),o.jsx("td",{className:"px-4 py-2 text-right",children:we?.valor_final_dinheiro!=null?ct(we.valor_final_dinheiro):""})]},we.id))]})]})})]})]}),j==="comandas"&&o.jsx(ln,{open:!!M,onOpenChange:we=>{we?Z.current=!0:(Z.current=!1,C(null),I({loading:!1,itens:[],pagamentos:[]}),F(null))},children:o.jsxs(sn,{className:"sm:max-w-4xl w-[92vw] max-h-[90vh] overflow-hidden flex flex-col animate-none",onKeyDown:we=>we.stopPropagation(),children:[o.jsxs(an,{children:[o.jsxs(nn,{className:"flex items-center gap-2 flex-wrap",children:[o.jsx("span",{children:D?o.jsxs("span",{children:[D.mesaLabel,D.clientesStr?o.jsxs("span",{className:"text-text-secondary",children:["  ",D.clientesStr]}):null]}):o.jsxs(o.Fragment,{children:["Comanda #",M||""]})}),D&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:Jt("text-xs px-2 py-0.5 rounded-full border",Qt(D.status)),children:D.status==="closed"?"Fechada":D.status==="open"?"Aberta":"Cancelada"}),o.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full border bg-info/10 text-info border-info/30",children:D.tipo==="balcao"?"Balco":D.tipo==="comanda"?"Mesa":"Importada"})]})]}),o.jsx(_n,{className:"space-y-1",children:D?o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[D.aberto_em?o.jsxs(o.Fragment,{children:["Abertura: ",se(D.aberto_em)]}):"",D.fechado_em&&o.jsxs(o.Fragment,{children:[" ",""," ","Fechamento: ",se(D.fechado_em),(()=>{const we=new Date(D.aberto_em),te=new Date(D.fechado_em)-we,$e=Math.floor(te/6e4),Pe=Math.floor($e/60),It=$e%60;return $e>0?o.jsxs("span",{className:"text-text-muted",children:[" (",Pe>0?`${Pe}h `:"",It,"min)"]}):null})()]})]}),D.observacao&&o.jsx("div",{className:"text-xs text-text-muted",children:D.observacao.includes("Importado de XML")?o.jsxs("span",{className:"text-warning",children:[" ",D.observacao.split(`
`)[0]]}):o.jsxs("span",{children:["Obs: ",D.observacao]})})]}):o.jsx(o.Fragment,{children:"Itens e pagamentos registrados."})})]}),T.loading?o.jsxs("div",{className:"p-6 text-center text-text-muted",children:[o.jsx(Om,{className:"mr-2 inline h-4 w-4 animate-spin"})," Carregando..."]}):o.jsxs("div",{className:"space-y-4 overflow-y-auto flex-1 px-1",children:[(()=>{const we=T.itens.reduce((Dt,kt)=>Dt+Number(kt.quantidade||0)*Number(kt.preco_unitario||0),0),ye=T.itens.reduce((Dt,kt)=>Dt+Number(kt.desconto||0),0),te=we-ye,$e=T.pagamentos.reduce((Dt,kt)=>Dt+Number(kt.valor||0),0),Pe=typeof D?.diferenca_pagamento=="number"?D.diferenca_pagamento:null,It=Pe??$e-te;return o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold mb-3",children:"Resumo Financeiro"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-muted",children:"Subtotal"}),o.jsxs("span",{className:"font-mono font-semibold",children:["R$ ",we.toFixed(2)]})]}),ye>0&&o.jsxs("div",{className:"flex items-center gap-2 text-warning",children:[o.jsx("span",{children:"Desconto"}),o.jsxs("span",{className:"font-mono font-semibold",children:["-R$ ",ye.toFixed(2)]})]})]}),o.jsxs("div",{className:"flex justify-between font-semibold pt-2 border-t border-border",children:[o.jsx("span",{children:"Total:"}),o.jsxs("span",{className:"font-mono text-lg",children:["R$ ",te.toFixed(2)]})]}),o.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-2 text-success",children:[o.jsx("span",{children:"Pagamentos"}),o.jsxs("span",{className:"font-mono",children:["R$ ",$e.toFixed(2)]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-secondary",children:"Diferena"}),o.jsx("span",{className:Jt("font-semibold",Math.abs(It)<.005?"text-text-muted":It>0?"text-emerald-500":"text-amber-500"),children:Math.abs(It)<.005?"R$ 0,00":`${It>0?"+":"-"} R$ ${Math.abs(It).toFixed(2)}`})]})]})]})]})})(),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"border rounded-md p-3",children:[o.jsxs("div",{className:"font-semibold mb-2",children:["Itens (",T.itens.length,")"]}),T.itens.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem itens."}):o.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:T.itens.map(we=>{const ye=Number(we.quantidade||0)*Number(we.preco_unitario||0),te=Number(we.desconto||0),$e=ye-te;return o.jsx("li",{className:"border-b border-border/50 pb-2 last:border-0",children:o.jsxs("div",{className:"flex justify-between items-start gap-2",children:[o.jsxs("span",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium truncate",children:we.descricao}),o.jsxs("div",{className:"text-xs text-text-muted",children:[we.quantidade," x R$ ",Number(we.preco_unitario||0).toFixed(2),te>0&&o.jsxs("span",{className:"text-warning",children:[" (desc: R$ ",te.toFixed(2),")"]})]})]}),o.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",$e.toFixed(2)]})]})},we.id)})})]}),o.jsxs("div",{className:"border rounded-md p-3",children:[o.jsxs("div",{className:"font-semibold mb-2",children:["Pagamentos (",T.pagamentos.length,")"]}),T.pagamentos.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros."}):o.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:T.pagamentos.map(we=>o.jsxs("li",{className:"flex justify-between gap-2 border-b border-border/50 pb-2 last:border-0",children:[o.jsxs("span",{className:"pr-2 break-words flex-1",children:[we.cliente_nome?o.jsx("div",{className:"font-medium",children:we.cliente_nome}):o.jsx("div",{className:"text-text-muted",children:"Sem cliente"}),o.jsx("div",{className:"text-xs text-text-secondary",children:we.finalizadora_nome||"Outros"})]}),o.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",Number(we.valor||0).toFixed(2)]})]},we.id))})]})]})]}),o.jsx(Un,{children:o.jsx(le,{size:"sm",variant:"secondary",onClick:()=>{C(null)},children:"Fechar"})})]})}),j==="fechamentos"&&o.jsx(ln,{open:z.open,onOpenChange:we=>{we||q({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null}})},children:o.jsxs(sn,{className:"sm:max-w-2xl w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden overflow-x-hidden",onKeyDown:we=>we.stopPropagation(),children:[o.jsxs(an,{children:[o.jsx(nn,{children:"Fechamento do Perodo"}),o.jsxs(_n,{children:[z.periodo.from?se(z.periodo.from):""," ","at"," ",z.periodo.to?se(z.periodo.to):""]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:z.loading?o.jsxs("div",{className:"p-3 sm:p-4 text-text-muted",children:[o.jsx(Om,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando resumo"]}):o.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),o.jsx("p",{className:"text-xl font-bold",children:ct(z?.saldos?.inicial??0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Entradas (pagamentos)"}),o.jsx("p",{className:"text-xl font-bold text-success",children:ct(z.resumo?.totalEntradas||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border col-span-2 sm:col-span-1",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),o.jsx("p",{className:"text-xl font-bold",children:z?.saldos?.final!=null?ct(z.saldos.final):""})]})]}),o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),o.jsx("p",{className:"text-xl font-bold text-warning",children:ct(z.resumo?.totalDescontos||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),o.jsx("p",{className:"text-xl font-bold",children:ct(z.resumo?.totalVendasLiquidas||0)})]})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold mb-1",children:"Por Finalizadora"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:z.resumo?.totalPorFinalizadora&&Object.keys(z.resumo.totalPorFinalizadora).length>0?Object.entries(z.resumo.totalPorFinalizadora).map(([we,ye])=>o.jsxs("div",{className:"flex items-center justify-between bg-surface-2 rounded-md p-2 border border-border",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:String(we)}),o.jsx("span",{className:"text-sm font-semibold",children:ct(ye)})]},we)):o.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados de finalizadoras"})})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold mb-1",children:"Resumo de Movimentaes"}),z.movimentosAgg?o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Suprimentos"}),o.jsx("p",{className:"text-lg font-bold text-success",children:ct(z.movimentosAgg?.suprimentos||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Sangrias"}),o.jsx("p",{className:"text-lg font-bold text-danger",children:ct(z.movimentosAgg?.sangrias||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Ajustes"}),o.jsx("p",{className:"text-lg font-bold",children:ct(z.movimentosAgg?.ajustes||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Troco"}),o.jsx("p",{className:"text-lg font-bold",children:ct(z.movimentosAgg?.troco||0)})]})]}):o.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes agregadas nesta sesso."})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold mb-1",children:"Movimentaes"}),!z.movs||z.movs.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma movimentao registrada"}):o.jsxs(o.Fragment,{children:[o.jsx("ul",{className:"sm:hidden divide-y divide-border rounded-md border border-border overflow-hidden",children:z.movs.map((we,ye)=>o.jsxs("li",{className:"px-3 py-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("span",{className:"text-xs text-text-secondary whitespace-nowrap",children:se(we.criado_em)}),o.jsx("span",{className:"text-sm font-semibold whitespace-nowrap",children:ct(we.valor||0)})]}),o.jsxs("div",{className:"mt-0.5 flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded bg-surface-2 border border-border text-text-secondary whitespace-nowrap",children:String(we.tipo||"").toUpperCase()}),o.jsx("span",{className:"text-xs text-text-primary whitespace-normal break-words flex-1",children:we.observacao||""})]})]},ye))}),o.jsx("div",{className:"hidden sm:block rounded-md border border-border overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{className:"bg-surface-2",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-3 py-2",children:"Data"}),o.jsx("th",{className:"text-left px-3 py-2",children:"Tipo"}),o.jsx("th",{className:"text-left px-3 py-2",children:"Obs"}),o.jsx("th",{className:"text-right px-3 py-2",children:"Valor"})]})}),o.jsx("tbody",{children:z.movs.map((we,ye)=>o.jsxs("tr",{className:"border-t border-border/60",children:[o.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:se(we.criado_em)}),o.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:String(we.tipo||"").toUpperCase()}),o.jsx("td",{className:"px-3 py-2 whitespace-normal break-words",children:we.observacao||""}),o.jsx("td",{className:"px-3 py-2 text-right font-semibold whitespace-nowrap",children:ct(we.valor||0)})]},ye))})]})})]})]})]})})]})}),o.jsx(git,{open:$,onOpenChange:K,codigoEmpresa:r?.codigo_empresa,onSuccess:async we=>{K(!1),we&&(u(we),m(we)),await new Promise(ye=>setTimeout(ye,500)),Q(0),await gt({append:!1})}})]})}function bit(){const{userProfile:e}=Do(),[t]=ES(),r=t.get("comanda"),[n,a]=p.useState(!0),[i,s]=p.useState(null),[l,c]=p.useState([]),[d,u]=p.useState([]),[f,m]=p.useState([]),[h,v]=p.useState(null),[g,x]=p.useState(""),[y,b]=p.useState("");p.useEffect(()=>{(async()=>{try{if(!r||!e?.codigo_empresa)return;try{const{data:I,error:D}=await pe.from("empresas").select("nome_fantasia, nome").eq("codigo_empresa",e.codigo_empresa).single();if(D&&console.warn("[PrintComandaPage] Erro ao buscar empresa:",D.message),I){const F=I.nome_fantasia||I.nome||"";console.log("[PrintComandaPage] Empresa carregada:",I,"-> nome exibido:",F),b(F)}else console.warn("[PrintComandaPage] Empresa no encontrada para codigo_empresa:",e.codigo_empresa)}catch(I){console.warn("[PrintComandaPage] Exceo ao carregar empresa:",I)}const{data:k}=await pe.from("comandas").select("mesa_id, observacoes").eq("id",r).eq("codigo_empresa",e.codigo_empresa).single();if(k?.mesa_id){const{data:I}=await pe.from("mesas").select("numero").eq("id",k.mesa_id).eq("codigo_empresa",e.codigo_empresa).single();v(I)}x(k?.observacoes||"");const[E,A,M]=await Promise.all([Si({comandaId:r,codigoEmpresa:e.codigo_empresa}),Qi({comandaId:r,codigoEmpresa:e.codigo_empresa}),Qte({comandaId:r,codigoEmpresa:e.codigo_empresa})]);c(E||[]),u(A||[]),m(M||[]);const C=(E||[]).reduce((I,D)=>I+Number(D.quantidade||0)*Number(D.preco_unitario||0),0),T=(M||[]).reduce((I,D)=>I+Number(D.valor||0),0);s({id:r,totalItens:C,totalPagamentos:T,diferenca:T-C})}catch(k){console.error("Erro ao carregar comanda:",k)}finally{a(!1)}})()},[r,e?.codigo_empresa]);const w=()=>{window.print()},j=()=>{window.history.back()};if(n)return o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand mx-auto mb-4"}),o.jsx("p",{className:"text-text-muted",children:"Carregando comanda..."})]})});if(!i)return o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-text-muted mb-4",children:"Comanda no encontrada"}),o.jsxs(le,{onClick:j,variant:"outline",children:[o.jsx(ky,{className:"mr-2 h-4 w-4"}),"Voltar"]})]})});const _=(d||[]).map(S=>S?.nome||S?.nome_livre||"").filter(Boolean).join(", ")||"Sem cliente";return i.totalItens,i.totalPagamentos,o.jsxs("div",{className:"w-screen h-screen bg-gray-100 flex flex-col print:bg-white print:p-0",children:[o.jsxs("div",{className:"flex gap-2 p-4 bg-white border-b border-gray-200 print:hidden",children:[o.jsxs(le,{onClick:j,size:"sm",className:"bg-black text-white hover:bg-black/80 border border-black shadow-sm",children:[o.jsx(ky,{className:"mr-2 h-4 w-4"}),"Voltar"]}),o.jsxs(le,{onClick:w,size:"sm",className:"ml-auto",children:[o.jsx(xH,{className:"mr-2 h-4 w-4"}),"Imprimir"]})]}),o.jsx("div",{className:"flex-1 overflow-auto flex items-start justify-center p-4 print:p-0 print:overflow-visible print:flex-none",children:o.jsxs("div",{className:"w-80 border border-black p-6 bg-white print:border-0 print:p-0 print:w-full",children:[o.jsxs("div",{className:"text-center mb-4 border-b border-black pb-3",children:[o.jsx("p",{className:"text-xs font-semibold text-black mb-2",children:y||" "}),o.jsx("h1",{className:"text-xl font-bold text-black",children:"COMANDA"}),h&&o.jsxs("p",{className:"text-xs text-black mt-1",children:["Mesa ",h.numero]}),o.jsx("p",{className:"text-xs text-black mt-1",children:new Date().toLocaleString("pt-BR")})]}),o.jsxs("div",{className:"mb-6 pb-4 border-b border-black",children:[o.jsx("p",{className:"text-sm font-semibold text-black",children:"CLIENTE:"}),o.jsx("p",{className:"text-sm text-black",children:_})]}),o.jsx("div",{className:"mb-6 pb-4 border-b border-black",children:o.jsx("div",{className:"space-y-2",children:l.map((S,k)=>{const E=Number(S.quantidade||0)*Number(S.preco_unitario||0);return o.jsxs("div",{className:"flex justify-between text-sm text-black",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{children:S.descricao||"Item"}),o.jsxs("span",{className:"ml-2 text-xs",children:["x",S.quantidade]})]}),o.jsxs("span",{className:"font-semibold",children:["R$ ",E.toFixed(2)]})]},k)})})}),g&&o.jsxs("div",{className:"mb-4 pb-3",children:[o.jsx("p",{className:"text-xs font-semibold text-black mb-1",children:"OBS:"}),o.jsx("p",{className:"text-xs text-black border-b border-black pb-3",children:g})]}),o.jsx("div",{className:"text-center pt-4",children:o.jsxs("p",{className:"text-lg font-bold text-black mt-2",children:["TOTAL: R$ ",i.totalItens.toFixed(2)]})}),o.jsxs("div",{className:"text-center mt-8 pt-4 border-t border-black text-xs text-black",children:[o.jsx("p",{children:"Obrigado pela preferncia!"}),o.jsx("p",{className:"mt-2",children:"Fluxo7Arena"})]})]})}),o.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            background: white;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:border-0 {
            border: none !important;
          }
          .print\\:p-0 {
            padding: 0 !important;
          }
        }
      `})]})}const wit="18810778",Zg={hidden:{opacity:0,x:20},visible:{opacity:1,x:0,transition:{duration:.3}},exit:{opacity:0,x:-20,transition:{duration:.2}}};function jit(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function Nit(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2").substring(0,15)}async function _it(){try{const{data:e,error:t}=await pe.from("empresas").select("codigo_empresa").order("codigo_empresa",{ascending:!1}).limit(100);if(t)return console.warn("Erro ao buscar cdigos:",t),"1";let r=0;return e&&e.length>0&&e.forEach(n=>{const a=parseInt(n.codigo_empresa);!isNaN(a)&&a>r&&(r=a)}),(r+1).toString()}catch(e){return console.warn("Erro ao gerar cdigo:",e),"1"}}function Sit(){const{toast:e}=ro(),t=Fl(),[r,n]=p.useState(1),[a,i]=p.useState(!1),[s,l]=p.useState(!1),[c,d]=p.useState(""),[u,f]=p.useState({email:"",nomeUsuario:"",cargo:"",razaoSocial:"",nomeFantasia:"",cnpj:"",emailEmpresa:"",telefone:"",endereco:"",quadras:[],mesas:[],categorias:[]}),[m,h]=p.useState(null),v=q=>{q.preventDefault(),c===wit?(l(!0),n(2),e({title:"Acesso liberado",description:"Bem-vindo ao formulrio de criao de empresa."})):(e({title:"Senha incorreta",description:"Tente novamente.",variant:"destructive"}),d(""))},g=()=>!0,x=()=>u.razaoSocial.trim()?u.nomeFantasia.trim()?!0:(e({title:"Nome Fantasia obrigatrio",variant:"destructive"}),!1):(e({title:"Razo Social obrigatria",variant:"destructive"}),!1),y=()=>{r===2&&!g()||r===3&&!x()||n(r+1)},b=()=>{n(r-1)},w=()=>{const q=u.quadras.length+1;f({...u,quadras:[...u.quadras,{nome:`Quadra ${q}`}]})},j=q=>{f({...u,quadras:u.quadras.filter(($,K)=>K!==q)})},_=()=>{const q=u.mesas.length+1;f({...u,mesas:[...u.mesas,{numero:q,nome:`Mesa ${q}`}]})},S=q=>{f({...u,mesas:u.mesas.filter(($,K)=>K!==q)})},k=()=>{const q=prompt("Digite o nome da categoria:");q&&q.trim()&&f({...u,categorias:[...u.categorias,{nome:q.trim(),descricao:""}]})},E=q=>{f({...u,categorias:u.categorias.filter(($,K)=>K!==q)})},A=async()=>{try{i(!0);try{const B={user:{email:u.email?.trim()||null,nome:u.nomeUsuario?.trim()||null,cargo:u.cargo?.trim()||"admin"},empresa:{razao_social:u.razaoSocial?.trim()||null,nome_fantasia:u.nomeFantasia?.trim()||null,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa?.trim()||null,telefone:u.telefone?.trim()||null,endereco:u.endereco?.trim()||null},quadras:u.quadras||[],mesas:u.mesas||[],categorias:u.categorias||[]},{data:L,error:V}=await pe.rpc("create_company_full",{payload:B});if(!V&&L&&L.codigo_empresa){h({success:!0,codigoEmpresa:L.codigo_empresa,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:(u.quadras||[]).length,numMesas:(u.mesas||[]).length,numCategorias:(u.categorias||[]).length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${L.codigo_empresa}`});return}else V&&console.warn("RPC create_company_full indisponvel/erro. Usando fluxo local.",V?.message||V)}catch(B){console.warn("Falha ao tentar RPC create_company_full. Usando fluxo local.",B?.message||B)}let q=null;u.email.trim()&&(console.log("Email fornecido:",u.email),console.log("Nota: O vnculo com o usurio ser criado no primeiro login"),q=null);const $=await _it();console.log("Cdigo da empresa gerado:",$);const{data:K,error:ce}=await pe.from("empresas").insert({codigo_empresa:$,nome:u.nomeFantasia,razao_social:u.razaoSocial,nome_fantasia:u.nomeFantasia,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa||null,telefone:u.telefone||null,endereco:u.endereco||null}).select().single();if(ce)throw new Error("Erro ao criar empresa: "+ce.message);const{error:fe}=await pe.from("empresa_counters").insert({empresa_id:K.id,next_cliente_codigo:1,next_agendamento_codigo:1});if(fe&&console.warn("Erro ao criar contador:",fe),u.email.trim()||u.nomeUsuario.trim())try{const B="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(re){const me=Math.random()*16|0;return(re==="x"?me:me&3|8).toString(16)}),{error:L}=await pe.from("usuarios").insert({id:B,email:u.email||null,nome:u.nomeUsuario||null,papel:u.cargo||"admin",codigo_empresa:$});L&&console.warn("Aviso ao criar usurio:",L.message);const{error:V}=await pe.from("colaboradores").insert({id:B,nome:u.nomeUsuario||"Administrador",cargo:u.cargo||"admin",ativo:!0,codigo_empresa:$});V&&console.warn("Aviso ao criar colaborador:",V.message),u.email&&(console.log(" APS O PRIMEIRO LOGIN, execute este SQL no Supabase:"),console.log(`
-- Atualizar ID do colaborador com o ID real do auth.users
UPDATE public.colaboradores 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${$}' AND id = '${B}';

-- Atualizar ID do usurio
UPDATE public.usuarios 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${$}' AND id = '${B}';
            `))}catch(B){console.warn("Erro ao criar registros de usurio:",B)}try{await pe.from("agenda_settings").insert({empresa_id:K.id,auto_confirm_enabled:!1,auto_start_enabled:!0,auto_finish_enabled:!0})}catch(B){console.warn("Aviso: no foi possvel criar agenda_settings agora (provvel RLS). Ser configurado aps o primeiro login.",B?.message||B)}if(u.quadras.length>0){const B=u.quadras.map(L=>({nome:L.nome,codigo_empresa:$}));await pe.from("quadras").insert(B)}if(u.mesas.length>0){const B=u.mesas.map(L=>({numero:L.numero,nome:L.nome,codigo_empresa:$,status:"available"}));await pe.from("mesas").insert(B)}if(u.categorias.length>0){const B=u.categorias.map(L=>({nome:L.nome,descricao:L.descricao||null,codigo_empresa:$,ativa:!0}));await pe.from("produto_categorias").insert(B)}h({success:!0,codigoEmpresa:$,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:u.quadras.length,numMesas:u.mesas.length,numCategorias:u.categorias.length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${$}`})}catch(q){console.error("Erro ao criar empresa:",q),e({title:"Erro ao criar empresa",description:q.message,variant:"destructive"})}finally{i(!1)}},M=()=>{if(r===1||r===6)return null;const q=(r-1)/4*100;return o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsxs("span",{className:"text-sm text-text-muted",children:["Etapa ",r-1," de 4"]}),o.jsxs("span",{className:"text-sm text-text-muted",children:[Math.round(q),"%"]})]}),o.jsx("div",{className:"h-2 bg-surface-2 rounded-full overflow-hidden",children:o.jsx(fr.div,{className:"h-full bg-brand",initial:{width:0},animate:{width:`${q}%`},transition:{duration:.3}})})]})},C=()=>o.jsxs(fr.div,{variants:Zg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-md mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(sx,{className:"w-8 h-8 text-brand"})}),o.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"rea Restrita"}),o.jsx("p",{className:"text-text-muted",children:"Digite a senha para acessar"})]}),o.jsxs("form",{onSubmit:v,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"senha",children:"Senha de Acesso"}),o.jsx(ir,{id:"senha",type:"password",value:c,onChange:q=>d(q.target.value),placeholder:"Digite a senha",className:"text-center text-lg tracking-widest",autoFocus:!0})]}),o.jsxs(le,{type:"submit",className:"w-full",children:["Acessar",o.jsx(a2,{className:"ml-2 h-4 w-4"})]})]})]},"step1"),T=()=>o.jsxs(fr.div,{variants:Zg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(_u,{className:"w-8 h-8 text-brand"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Primeiro Usurio"}),o.jsx("p",{className:"text-text-muted",children:"Informaes do administrador da empresa"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"email",children:"Email cadastrado no Supabase Auth"}),o.jsx(ir,{id:"email",type:"email",value:u.email,onChange:q=>f({...u,email:q.target.value}),placeholder:"usuario@email.com"}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Este email j deve estar cadastrado no Supabase Auth"})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"nomeUsuario",children:"Nome Completo"}),o.jsx(ir,{id:"nomeUsuario",type:"text",value:u.nomeUsuario,onChange:q=>f({...u,nomeUsuario:q.target.value}),placeholder:"Joo Silva"})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"cargo",children:"Cargo na Empresa"}),o.jsx(ir,{id:"cargo",type:"text",value:u.cargo,onChange:q=>f({...u,cargo:q.target.value}),placeholder:"Ex: Proprietrio, Gerente, Administrador, Scio, etc."}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Digite o cargo que voc ocupa na empresa"})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsx(le,{type:"button",variant:"outline",onClick:()=>t("/"),className:"flex-1",children:"Cancelar"}),o.jsxs(le,{type:"button",onClick:y,className:"flex-1",children:["Prximo",o.jsx(a2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step2"),I=()=>o.jsxs(fr.div,{variants:Zg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(fN,{className:"w-8 h-8 text-brand"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Dados da Empresa"}),o.jsx("p",{className:"text-text-muted",children:"Informaes cadastrais da empresa"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx(Ht,{htmlFor:"razaoSocial",children:"Razo Social *"}),o.jsx(ir,{id:"razaoSocial",type:"text",value:u.razaoSocial,onChange:q=>f({...u,razaoSocial:q.target.value}),placeholder:"Empresa LTDA"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx(Ht,{htmlFor:"nomeFantasia",children:"Nome Fantasia *"}),o.jsx(ir,{id:"nomeFantasia",type:"text",value:u.nomeFantasia,onChange:q=>f({...u,nomeFantasia:q.target.value}),placeholder:"Minha Empresa"}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Como a empresa aparecer no sistema"})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"cnpj",children:"CNPJ"}),o.jsx(ir,{id:"cnpj",type:"text",value:u.cnpj,onChange:q=>f({...u,cnpj:jit(q.target.value)}),placeholder:"00.000.000/0000-00"})]}),o.jsxs("div",{children:[o.jsx(Ht,{htmlFor:"telefone",children:"Telefone"}),o.jsx(ir,{id:"telefone",type:"tel",value:u.telefone,onChange:q=>f({...u,telefone:Nit(q.target.value)}),placeholder:"(11) 99999-9999"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx(Ht,{htmlFor:"emailEmpresa",children:"Email da Empresa"}),o.jsx(ir,{id:"emailEmpresa",type:"email",value:u.emailEmpresa,onChange:q=>f({...u,emailEmpresa:q.target.value}),placeholder:"contato@empresa.com"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx(Ht,{htmlFor:"endereco",children:"Endereo Completo (opcional)"}),o.jsx(ir,{id:"endereco",type:"text",value:u.endereco,onChange:q=>f({...u,endereco:q.target.value}),placeholder:"Rua X, 123, Bairro, Cidade - UF"})]})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsxs(le,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[o.jsx(ky,{className:"mr-2 h-4 w-4"}),"Voltar"]}),o.jsxs(le,{type:"button",onClick:y,className:"flex-1",children:["Prximo",o.jsx(a2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step3"),D=()=>o.jsxs(fr.div,{variants:Zg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(Hm,{className:"w-8 h-8 text-brand"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Configurao Inicial"}),o.jsx("p",{className:"text-text-muted",children:"Adicione dados iniciais ou pule esta etapa"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(oue,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"font-semibold text-text-primary",children:"Quadras Esportivas"})]}),o.jsxs(le,{type:"button",onClick:w,size:"sm",className:"gap-2",children:[o.jsx(Ga,{className:"w-4 h-4"}),"Adicionar Quadra"]})]}),u.quadras.length>0?o.jsx("div",{className:"space-y-2",children:u.quadras.map((q,$)=>o.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[o.jsx("span",{className:"text-sm text-text-primary",children:q.nome}),o.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:()=>j($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:o.jsx(Dl,{className:"w-4 h-4"})})]},$))}):o.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma quadra adicionada"})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(cl,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"font-semibold text-text-primary",children:"Mesas da Loja"})]}),o.jsxs(le,{type:"button",onClick:_,size:"sm",className:"gap-2",children:[o.jsx(Ga,{className:"w-4 h-4"}),"Adicionar Mesa"]})]}),u.mesas.length>0?o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:u.mesas.map((q,$)=>o.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[o.jsx("span",{className:"text-sm text-text-primary",children:q.nome}),o.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:()=>S($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:o.jsx(Dl,{className:"w-4 h-4"})})]},$))}):o.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma mesa adicionada"})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(gd,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"font-semibold text-text-primary",children:"Categorias de Produtos"})]}),o.jsxs(le,{type:"button",onClick:k,size:"sm",className:"gap-2",children:[o.jsx(Ga,{className:"w-4 h-4"}),"Adicionar Categoria"]})]}),u.categorias.length>0?o.jsx("div",{className:"space-y-2",children:u.categorias.map((q,$)=>o.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[o.jsx("span",{className:"text-sm text-text-primary",children:q.nome}),o.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:()=>E($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:o.jsx(Dl,{className:"w-4 h-4"})})]},$))}):o.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma categoria adicionada"})]}),o.jsx("div",{className:"bg-info/10 border border-info/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(pc,{className:"w-5 h-5 text-info mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Configuraes Opcionais"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Voc pode adicionar quadras, mesas e categorias agora ou configurar depois no sistema."})]})]})}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsxs(le,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[o.jsx(ky,{className:"mr-2 h-4 w-4"}),"Voltar"]}),o.jsxs(le,{type:"button",onClick:y,className:"flex-1",children:["Prximo",o.jsx(a2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step4"),F=()=>o.jsxs(fr.div,{variants:Zg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(Pi,{className:"w-8 h-8 text-brand"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Reviso Final"}),o.jsx("p",{className:"text-text-muted",children:"Confira os dados antes de criar a empresa"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[o.jsx(_u,{className:"w-5 h-5"}),"Primeiro Usurio"]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Email:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.email})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Nome:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.nomeUsuario})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Cargo:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.cargo})]})]})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[o.jsx(fN,{className:"w-5 h-5"}),"Empresa"]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Razo Social:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.razaoSocial})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Nome Fantasia:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.nomeFantasia})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"CNPJ:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.cnpj})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Email:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.emailEmpresa})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Telefone:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.telefone})]}),u.endereco&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Endereo:"}),o.jsx("span",{className:"text-text-primary font-medium text-right",children:u.endereco})]})]})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[o.jsx(Hm,{className:"w-5 h-5"}),"Configuraes Iniciais"]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Quadras:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.quadras.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Mesas:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.mesas.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Categorias de Produtos:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.categorias.length})]})]})]}),o.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(pc,{className:"w-5 h-5 text-warning mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Ateno"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Esta ao criar a empresa no banco de dados. Certifique-se de que todos os dados esto corretos."})]})]})}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsxs(le,{type:"button",variant:"outline",onClick:b,className:"flex-1",disabled:a,children:[o.jsx(ky,{className:"mr-2 h-4 w-4"}),"Voltar"]}),o.jsx(le,{type:"button",onClick:A,className:"flex-1 bg-emerald-600 hover:bg-emerald-500",disabled:a,children:a?o.jsxs(o.Fragment,{children:[o.jsx(Om,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):o.jsx(o.Fragment,{children:" Criar Empresa"})})]})]})]},"step5"),z=()=>o.jsxs(fr.div,{variants:Zg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-success/10 rounded-full mb-6",children:o.jsx(Pi,{className:"w-12 h-12 text-success"})}),o.jsx("h2",{className:"text-3xl font-bold text-text-primary mb-2",children:" Empresa Criada!"}),o.jsx("p",{className:"text-text-muted",children:"Tudo pronto para comear a usar o sistema"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-brand/10 border border-brand/30 rounded-lg p-6",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm text-text-muted mb-2",children:"Cdigo da Empresa"}),o.jsx("p",{className:"text-3xl font-bold text-brand font-mono",children:m?.codigoEmpresa})]})}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados de Acesso"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Email:"}),o.jsx("span",{className:"text-text-primary font-medium",children:m?.email})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Senha:"}),o.jsx("span",{className:"text-text-primary font-medium",children:"(a que voc definiu no Supabase)"})]})]})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados Criados"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),o.jsx("div",{className:"text-xs text-text-muted",children:"Empresa"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),o.jsx("div",{className:"text-xs text-text-muted",children:"Configuraes"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:m?.numQuadras}),o.jsx("div",{className:"text-xs text-text-muted",children:"Quadras"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:m?.numMesas}),o.jsx("div",{className:"text-xs text-text-muted",children:"Mesas"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:m?.numCategorias}),o.jsx("div",{className:"text-xs text-text-muted",children:"Categorias"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),o.jsx("div",{className:"text-xs text-text-muted",children:"Pronto para Uso"})]})]})]}),o.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(pc,{className:"w-5 h-5 text-warning mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-text-primary mb-2",children:" IMPORTANTE: Execute o SQL Antes de Fazer Login"}),o.jsxs("div",{className:"space-y-2 text-xs text-text-muted",children:[o.jsx("p",{className:"font-semibold text-text-primary",children:"Para vincular seu usurio  empresa, siga estes passos:"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[o.jsxs("li",{children:["Abra o ",o.jsx("strong",{children:"Console do Navegador"})," (pressione F12)"]}),o.jsxs("li",{children:["Procure pela mensagem ",o.jsx("strong",{children:'" APS O PRIMEIRO LOGIN, execute este SQL"'})]}),o.jsx("li",{children:"Copie o comando SQL que aparece no console"}),o.jsxs("li",{children:["Acesse o ",o.jsx("strong",{children:"Supabase  SQL Editor"})]}),o.jsx("li",{children:"Cole e execute o SQL"}),o.jsx("li",{children:"Agora sim, faa login normalmente"})]}),o.jsx("p",{className:"mt-2 text-warning font-medium",children:' Se no executar o SQL, voc ver o erro "Empresa no vinculada"'})]})]})]})}),o.jsx("div",{className:"pt-4",children:o.jsx(le,{type:"button",onClick:()=>t("/"),className:"w-full bg-brand hover:bg-brand/90",children:"Ir para Login"})})]})]},"step6");return o.jsx(o.Fragment,{children:o.jsx("div",{className:"min-h-screen bg-background text-text-primary p-8",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[M(),o.jsxs($pe,{mode:"wait",children:[r===1&&C(),r===2&&T(),r===3&&I(),r===4&&D(),r===5&&F(),r===6&&z()]})]})})})}const joe=p.createContext(),Noe=()=>{const e=p.useContext(joe);if(!e)throw new Error("useIsis deve ser usado dentro de IsisProvider");return e},Cit=({children:e})=>{const[t,r]=p.useState("greeting"),[n,a]=p.useState([]),[i,s]=p.useState({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),[l,c]=p.useState(!1),[d,u]=p.useState(!1),f=p.useRef(null),m=p.useCallback(A=>{a(M=>[...M,{id:Date.now()+Math.random(),timestamp:new Date,...A}]),setTimeout(()=>{f.current?.scrollIntoView({behavior:"smooth"})},100)},[]),h=p.useCallback((A,M=2e3,C=null)=>{u(!0),setTimeout(()=>{u(!1);const T=A&&typeof A=="object"&&A.text?A:{text:A};m({from:"isis",text:T.text,type:"text",color:T.color??C,copyable:!!T.copyable,copyText:T.copyText})},M)},[m]),v=p.useCallback((A,M,C=2e3)=>{u(!0),setTimeout(()=>{u(!1),a(T=>T.map(I=>I.type==="buttons"&&I.buttons&&I.buttons.length>0?{...I,disabled:!0}:I)),m({from:"isis",text:A,type:"buttons",buttons:M,disabled:!1})},C)},[m]),g=p.useCallback(()=>{a(A=>A.map(M=>M.type==="buttons"&&M.buttons&&M.buttons.length>0&&!M.disabled?{...M,disabled:!0}:M))},[]),x=p.useCallback(A=>{a(M=>M.filter(C=>C.id!==A))},[]),y=p.useCallback(A=>{a(M=>M.map(C=>C.id===A&&C.type==="buttons"?{...C,buttonsHidden:!0,disabled:!0}:C))},[]),b=p.useCallback(A=>{m({from:"user",text:A,type:"text"})},[m]),w=p.useCallback((A,M)=>{s(C=>({...C,[A]:M}))},[]),j=p.useCallback((A,M)=>{s(C=>({...C,contato:{...C.contato,[A]:M}}))},[]),_=p.useCallback(A=>{r(A)},[]),S=p.useCallback(()=>{const A=["greeting","quadra","data","horario","modalidade","quantidade","nomes","contato","review","confirmation","avaliacao"],M=A.indexOf(t);M>0&&r(A[M-1])},[t]),k=p.useCallback(()=>{r("greeting"),a([]),s({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),c(!1),u(!1)},[]),E={currentStep:t,messages:n,selections:i,isLoading:l,isTyping:d,chatEndRef:f,addMessage:m,addIsisMessage:h,addIsisMessageWithButtons:v,addUserMessage:b,disableAllButtons:g,removeMessageById:x,hideButtonsInMessage:y,updateSelection:w,updateContact:j,nextStep:_,previousStep:S,resetConversation:k,setIsLoading:c,setIsTyping:u};return o.jsx(joe.Provider,{value:E,children:e})},Pit=()=>o.jsx(fr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-start mb-6",children:o.jsxs("div",{className:"flex items-end gap-3 max-w-[85%] md:max-w-[75%]",children:[o.jsx(ud,{size:"md",variant:"message"}),o.jsx("div",{className:"px-4 py-3 bg-brand border border-brand backdrop-blur-sm rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20",children:o.jsx("div",{className:"flex gap-1.5",children:[0,1,2].map(e=>o.jsx(fr.div,{className:"w-2.5 h-2.5 md:w-2 md:h-2 bg-[#0A0A0A] rounded-full",animate:{y:[0,-6,0],opacity:[.4,1,.4]},transition:{duration:.8,repeat:1/0,delay:e*.2,ease:"easeInOut"}},e))})})]})}),Ait=({buttons:e,onSelect:t,disabled:r=!1,hideText:n=!1,hidden:a=!1})=>o.jsx(fr.div,{initial:{opacity:0,y:10,gridTemplateRows:"1fr"},animate:{opacity:a?0:1,y:a?-8:0,gridTemplateRows:a?"0fr":"1fr"},transition:{duration:.6,ease:[.16,1,.3,1]},className:`grid ml-12 md:ml-[68px] overflow-hidden transition-all duration-500 ${a?"mb-0 md:mb-0 pointer-events-none":"mb-2 md:mb-3"}`,children:o.jsx("div",{className:"flex flex-wrap gap-2 md:gap-2.5",children:e.map((i,s)=>o.jsx(fr.button,{initial:{opacity:0,scale:.92,y:4,filter:"blur(2px)"},animate:{opacity:a||n?0:1,scale:a?.96:1,y:a?-8:0,filter:a?"blur(3.5px)":"blur(0px)"},transition:{duration:a?.4:.45,delay:a?s*.03:.2+s*.05,ease:[.16,1,.3,1]},whileHover:{scale:r?1:1.02,y:r?0:-2},whileTap:{scale:r?1:.98},onClick:()=>!r&&t(i),disabled:r,className:`
              group relative px-5 py-3.5 md:px-6 md:py-4 rounded-xl font-semibold text-[15px] md:text-[15px]
              transition-all duration-300 ease-out
              ${r?"bg-surface/30 text-text-muted cursor-not-allowed border border-white/5":"bg-surface/70 backdrop-blur-sm text-text-primary border border-white/10 hover:border-brand/70 hover:bg-brand/10 hover:text-brand hover:shadow-lg hover:shadow-brand/20 shadow-md"}
              ${n?"opacity-0 pointer-events-none":""}
            `,children:o.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1 relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[i.icon&&!n&&o.jsx("span",{className:`text-base md:text-lg transition-transform duration-300 ${!r&&"group-hover:scale-110"}`,children:i.icon}),!n&&o.jsx("span",{className:"font-semibold",children:i.label})]}),i.subtitle&&!n&&o.jsx("span",{className:"text-[12px] md:text-xs opacity-70 pl-6 md:pl-7 font-normal",children:i.subtitle})]})},i.value||s))})}),Eit=({children:e,onButtonClick:t,hideButtonTexts:r=!1})=>{const{messages:n,isTyping:a,chatEndRef:i}=Noe(),[s,l]=p.useState(0);return p.useEffect(()=>{const c=d=>{const u=!!d?.detail?.expanded,f=typeof window<"u"&&window.innerWidth<768?280:360,m=140,h=24,v=Math.max(0,f-m+h);l(u?v:0)};try{window.addEventListener("isis-participantes-expand",c)}catch{}return()=>{try{window.removeEventListener("isis-participantes-expand",c)}catch{}}},[]),o.jsxs("div",{className:"flex flex-col min-h-full",children:[o.jsxs("div",{className:"flex-1 px-3 md:px-6 py-4 md:py-8",style:{paddingBottom:s},children:[n.map(c=>o.jsxs(fr.div,{layout:"position",transition:{duration:.35,ease:[.16,1,.3,1]},children:[o.jsx(woe,{message:c}),c.type==="buttons"&&c.buttons&&o.jsx("div",{className:`overflow-hidden transition-all duration-500 ${c.buttonsHidden?"max-h-0 mb-0 md:mb-0":"max-h-[480px]"}`,children:o.jsx(Ait,{buttons:c.buttons,onSelect:d=>(t||c.onButtonClick)?.(d,c.id),disabled:c.disabled,hideText:r,hidden:!!c.buttonsHidden})})]},c.id)),a&&o.jsx(Pit,{}),o.jsx("div",{ref:i})]}),o.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:e})]})},kit=({onSubmit:e,onMudarData:t,disabled:r=!1,horariosDisponiveis:n=[],esportes:a=[]})=>{const[i,s]=p.useState(""),[l,c]=p.useState(""),[d,u]=p.useState(""),f=n.map((h,v)=>{let g=n[v].fim,x=0,y=v+1;for(;y<n.length&&n[y].inicio===g;)x++,g=n[y].fim,y++;const b=x>=1;return{value:h.inicio,label:h.inicio,available:b}}),m=(()=>{if(!i)return[];const h=n.findIndex(y=>y.inicio===i);if(h===-1)return[];const v=[];let g=n[h].fim,x=0;for(let y=h+1;y<n.length;y++){const b=n[y];if(b.inicio!==g)break;x++,x>=1&&v.push({value:b.fim,label:b.fim,available:!0}),g=b.fim}return v})();return p.useEffect(()=>{i&&l&&d&&!r&&e({inicio:i,fim:l,esporte:d})},[i,l,d]),p.useEffect(()=>{i&&c("")},[i]),o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-sm md:text-xs",children:[o.jsx(dd,{className:"w-4 h-4"}),o.jsx("span",{className:"font-medium",children:"Horrio desejado"})]}),o.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{htmlFor:"horario-inicio",className:"text-xs text-text-muted mb-1 block",children:"Incio"}),o.jsxs(En,{value:i,onValueChange:s,disabled:r,children:[o.jsx(Sn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsx(Cn,{className:"max-h-[300px] z-[60]",children:f.filter(h=>h.available).map(h=>o.jsx(Nt,{value:h.value,children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx(dd,{className:"w-4 h-4 opacity-80"}),h.label]})},h.value))})]})]}),o.jsx("div",{className:"text-text-muted font-bold text-lg pt-5",children:""}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{htmlFor:"horario-fim",className:"text-xs text-text-muted mb-1 block",children:"Trmino"}),o.jsxs(En,{value:l,onValueChange:c,disabled:!i||r,children:[o.jsx(Sn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsx(Cn,{className:"max-h-[300px] z-[60]",children:m.filter(h=>h.available).map(h=>o.jsx(Nt,{value:h.value,children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx(dd,{className:"w-4 h-4 opacity-80"}),h.label]})},h.value))})]})]})]}),o.jsxs("div",{className:"flex items-end gap-2 md:gap-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{htmlFor:"esporte",className:"text-xs text-text-muted mb-1 block",children:"Esporte"}),o.jsxs(En,{value:d,onValueChange:u,disabled:r,children:[o.jsx(Sn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:o.jsx(kn,{placeholder:"Selecione o esporte"})}),o.jsx(Cn,{className:"max-h-[300px] z-[60]",children:a.map(h=>o.jsx(Nt,{value:h,children:h},h))})]})]}),t&&o.jsxs(fr.button,{type:"button",onClick:t,disabled:r,whileHover:{scale:r?1:1.05},whileTap:{scale:r?1:.95},className:`
              px-4 py-2.5 rounded-xl font-medium text-sm
              transition-all duration-300 shrink-0
              flex items-center gap-2
              ${r?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/70 backdrop-blur-sm border border-white/10 text-text-primary hover:bg-surface/90 hover:border-white/20"}
            `,children:[o.jsx(gi,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden md:inline",children:"Mudar Data"}),o.jsx("span",{className:"md:hidden",children:"Mudar Data"})]})]})]})},Oit=({onSubmit:e,tipo:t,onTrocarTipo:r,disabled:n=!1,mostrarBotaoTrocar:a=!0})=>{const[i,s]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(!1);p.useEffect(()=>{s("")},[t]);const f=w=>{if(w){const j=Xt(w,"dd/MM/yyyy",{locale:aa});s(j),u(!1)}},m=w=>{const j=w.replace(/\D/g,"");return j.length<=2?`(${j}`:j.length<=7?`(${j.slice(0,2)}) ${j.slice(2)}`:j.length===10?`(${j.slice(0,2)}) ${j.slice(2,6)}-${j.slice(6)}`:j.length===11?`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7)}`:`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7,11)}`},h=w=>{const j=w.replace(/\D/g,"");return j.length<=2?j:j.length<=4?`${j.slice(0,2)}/${j.slice(2)}`:j.length<=8?`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4)}`:`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4,8)}`},v=w=>{const j=w.target.value;if(t==="telefone"){const _=m(j);s(_)}else if(t==="data_custom"){const _=h(j);s(_)}else s(j)},g=w=>{if(w.preventDefault(),!(!i.trim()||n))if(t==="telefone"){const j=i.replace(/\D/g,"");j.length===11&&(e(j),s(""))}else t==="data_custom"?i.trim()&&(e(i.trim()),s("")):i.includes("@")&&i.includes(".")&&(e(i.trim()),s(""))},x=w=>{w.key==="Enter"&&(w.preventDefault(),g(w))},y=w=>{if(w.length!==10)return{valida:!1,erro:"Data incompleta"};const j=/^(\d{2})\/(\d{2})\/(\d{4})$/,_=w.match(j);if(!_)return{valida:!1,erro:"Formato invlido"};const[,S,k,E]=_,A=new Date(parseInt(E),parseInt(k)-1,parseInt(S));if(isNaN(A.getTime())||A.getDate()!==parseInt(S)||A.getMonth()!==parseInt(k)-1||A.getFullYear()!==parseInt(E))return{valida:!1,erro:"Data invlida"};const M=new Date;return M.setHours(0,0,0,0),A.setHours(0,0,0,0),A<M?{valida:!1,erro:"Data no passado"}:{valida:!0,erro:null}},b=()=>t==="telefone"?i.replace(/\D/g,"").length===11:t==="data_custom"?y(i).valida:i.includes("@")&&i.includes(".");return o.jsxs(fr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:g,className:"flex flex-col gap-3 max-w-md mx-auto",children:[o.jsx("div",{className:"relative",children:o.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${l?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[t!=="data_custom"&&o.jsx("div",{className:`
              shrink-0 transition-colors duration-300
              ${l?"text-brand":"text-text-muted"}
            `,children:t==="telefone"?o.jsx(Cb,{className:"w-4 h-4"}):o.jsx(lx,{className:"w-4 h-4"})}),o.jsxs("div",{className:"flex-1 relative flex items-center",children:[o.jsx("input",{type:t==="data_custom"?"text":t==="telefone"?"tel":"email",value:i,onChange:v,onKeyDown:x,onFocus:()=>c(!0),onBlur:()=>c(!1),placeholder:t==="telefone"?"(00) 00000-0000":t==="data_custom"?"DD/MM/AAAA":"email@exemplo.com",disabled:n,className:`
                w-full bg-transparent text-text-primary placeholder:text-text-muted
                outline-none text-[17px] md:text-base font-medium
                ${t==="data_custom"?"pr-12":""}
                ${n?"opacity-50 cursor-not-allowed":""}
              `}),t==="data_custom"&&o.jsxs(yc,{open:d,onOpenChange:u,children:[o.jsx(bc,{asChild:!0,children:o.jsx(fr.button,{type:"button",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:n,className:`
                      absolute right-1 w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-300
                      bg-brand/10 text-brand hover:bg-brand hover:text-white
                      border border-brand/20 hover:border-brand/40
                      shadow-md hover:shadow-lg hover:shadow-brand/30
                      ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
                    `,children:o.jsx(gi,{className:"w-5 h-5"})})}),o.jsx(Ml,{className:"w-auto p-0",align:"end",children:o.jsx(wc,{mode:"single",selected:i?(()=>{try{const[w,j,_]=i.split("/");return new Date(parseInt(_),parseInt(j)-1,parseInt(w))}catch{return}})():void 0,onSelect:f,disabled:w=>{const j=new Date;return j.setHours(0,0,0,0),w<j},initialFocus:!0})})]})]}),o.jsx(fr.button,{type:"submit",whileHover:{scale:b()?1.1:1},whileTap:{scale:b()?.9:1},disabled:!b()||n,className:`
              shrink-0 w-9 h-9 rounded-full flex items-center justify-center transition-all duration-300
              ${b()?"bg-brand text-bg shadow-md hover:shadow-lg hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:o.jsx(UT,{className:"w-4 h-4"})})]})}),t==="telefone"&&i&&o.jsx("div",{className:"text-xs text-center",children:(()=>{const w=i.replace(/\D/g,""),j=w.length===11,_=w.length>0&&!j;return j?o.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Telefone vlido"}):_?o.jsxs("span",{className:"text-yellow-400 flex items-center justify-center gap-1",children:[" Digite todos os dgitos (",w.length,"/11)"]}):null})()}),t==="data_custom"&&i&&o.jsx("div",{className:"text-xs text-center",children:(()=>{const w=y(i);return w.valida?o.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Data vlida"}):i.length>0?o.jsxs("span",{className:"text-red-400 flex items-center justify-center gap-1",children:[" ",w.erro]}):null})()}),a&&t!=="data_custom"&&o.jsx("button",{type:"button",onClick:r,className:"text-sm text-brand/80 hover:text-brand hover:underline self-center py-1 px-3 rounded-lg hover:bg-brand/5 transition-all",children:t==="telefone"?o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(lx,{className:"w-4 h-4"}),"Prefiro usar e-mail"]}):o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(Cb,{className:"w-4 h-4"}),"Prefiro usar telefone"]})})]})},Tit=({onSubmit:e,disabled:t=!1,valorInicial:r=null,tipoInicial:n="telefone"})=>{const[a,i]=p.useState(""),[s,l]=p.useState(n==="telefone"&&r||""),[c,d]=p.useState(n==="email"&&r||""),[u,f]=p.useState(null),m=x=>{const y=x.replace(/\D/g,"");return y.length<=2?`(${y}`:y.length<=7?`(${y.slice(0,2)}) ${y.slice(2)}`:y.length<=11?`(${y.slice(0,2)}) ${y.slice(2,7)}-${y.slice(7,11)}`:`(${y.slice(0,2)}) ${y.slice(2,7)}-${y.slice(7,11)}`},h=x=>{const y=m(x.target.value);l(y)},v=x=>{if(x.preventDefault(),!a.trim())return;const y=s.replace(/\D/g,"").length>=10,b=c.trim().includes("@")&&c.trim().includes(".");if(!y&&!b)return;const w={nome:a.trim(),telefone:y?s.replace(/\D/g,""):null,email:b?c.trim():null};e(w)},g=()=>{if(!a.trim())return!1;const x=s.replace(/\D/g,"").length>=10,y=c.trim().includes("@")&&c.trim().includes(".");return x||y};return o.jsxs(fr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:v,className:"flex flex-col gap-3",children:[o.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${u==="nome"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[o.jsx(_u,{className:`w-5 h-5 transition-colors ${u==="nome"?"text-brand":"text-text-muted"}`}),o.jsx("input",{type:"text",value:a,onChange:x=>i(x.target.value),onFocus:()=>f("nome"),onBlur:()=>f(null),placeholder:"Seu nome completo",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),o.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${u==="telefone"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[o.jsx(Cb,{className:`w-5 h-5 transition-colors ${u==="telefone"?"text-brand":"text-text-muted"}`}),o.jsx("input",{type:"tel",value:s,onChange:h,onFocus:()=>f("telefone"),onBlur:()=>f(null),placeholder:"(00) 00000-0000",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),o.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${u==="email"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[o.jsx(lx,{className:`w-5 h-5 transition-colors ${u==="email"?"text-brand":"text-text-muted"}`}),o.jsx("input",{type:"email",value:c,onChange:x=>d(x.target.value),onFocus:()=>f("email"),onBlur:()=>f(null),placeholder:"email@exemplo.com (opcional)",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),o.jsxs(fr.button,{type:"submit",whileHover:{scale:g()?1.02:1},whileTap:{scale:g()?.98:1},disabled:!g()||t,className:`
          flex items-center justify-center gap-2 py-3 px-6 rounded-2xl
          font-semibold text-base transition-all duration-300
          ${g()?"bg-brand text-bg shadow-lg shadow-brand/20 hover:shadow-xl hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
        `,children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}),"Continuar"]}),o.jsx("p",{className:"text-xs text-text-muted text-center",children:"Preencha pelo menos telefone ou e-mail"})]})},Iit=({participantesAtuais:e=[],onAdicionar:t,onRemover:r,onFinalizar:n,disabled:a=!1,onAdicionarLote:i,selfName:s})=>{const[l,c]=p.useState(""),[d,u]=p.useState(!1),[f,m]=p.useState(!1),h=p.useRef(null),[v,g]=p.useState(!1),[x,y]=p.useState(""),[b,w]=p.useState(!1),[j,_]=p.useState([]),[S,k]=p.useState([]),[E,A]=p.useState({}),[M,C]=p.useState(!1),[T,I]=p.useState(!1),[D,F]=p.useState(null),[z,q]=p.useState(!1),$=p.useRef(null),K=p.useRef(null);p.useEffect(()=>{const Y=()=>{m(window.innerWidth<768)};return Y(),window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]),p.useEffect(()=>{if(v){const Y=document.body.style.overflow;return document.body.style.overflow="hidden",C(!1),I(!1),F(null),()=>{document.body.style.overflow=Y}}},[v]),p.useEffect(()=>{if(v&&B&&(!j||j.length===0)){const Y=fe(B);_([B]),A({[Y]:!0}),F(Y),I(!0),C(!0)}},[v]);const ce=Y=>Y.normalize("NFD").replace(/[\u0300-\u036f]/g,""),fe=Y=>ce(String(Y||"").trim().toLowerCase()).replace(/\s+/g," ");new Set((e||[]).map(Y=>fe(Y.nome)));const B=s?String(s).trim():e&&e[0]&&e[0].nome?String(e[0].nome).trim():null,L=B?fe(B):null,V=Y=>ce(String(Y||"").toLowerCase()).split(/\s+/).map(lt=>lt.trim()).filter(lt=>lt.length>=3),re=Y=>{if(!B)return!1;const lt=String(Y||"").trim();if(!lt)return!1;if(fe(lt)===L)return!0;const gt=V(B),Te=V(lt);return gt.length===0||Te.length===0?!1:Te.some(at=>gt.includes(at))},me=Y=>{const lt=new Set;if(!Y)return lt;const gt=String(Y).split(/\r?\n/);let Te=!1;for(let at of gt){const yt=ce(String(at||"")).toLowerCase().trim();if(!Te){/^\s*[*\-]?\s*(lista\s+de\s+(espera|reserva)|convidad\w*)\b[\s:]*$/i.test(yt)&&(Te=!0);continue}if(/^\s*\*\s*\w+|^\s*(convocad|jogad|levanta|goleir)\w*/i.test(ce(at))){Te=!1;continue}const vt=String(at).replace(/^\s*[*\-]+\s*/g,"").replace(/^\s*\d+\)?\s*/g,"").replace(/^[\W_]+/,"").trim(),Sr=/[A-Za-z---]/.test(vt);vt&&Sr&&!/[0-9@]/.test(vt)&&vt.length>=2&&vt.length<=60&&lt.add(fe(vt))}return lt},G=Y=>{Y.preventDefault(),!(!l.trim()||a)&&(t(l.trim()),c(""),setTimeout(()=>{h.current?.focus()},100))},Q=Y=>{Y.key==="Enter"&&!f&&(Y.preventDefault(),Y.shiftKey?n():G(Y))},ae=async()=>{if(x.trim()){w(!0),_([]),k([]),A({});try{const{data:Y,error:lt}=await pe.functions.invoke("parse-participants",{body:{text:x,locale:"pt-BR"}});if(lt)throw lt;Y&&typeof Y.source=="string"&&console.log("[Isis Import] source=",Y.source);const gt=me(x),at=(Array.isArray(Y?.extracted)?Y.extracted:[]).filter(we=>!gt.has(fe(we))),yt=at.some(we=>re(we)),vt=Array.isArray(Y?.invalid)?Y.invalid:[],Sr=[],se=new Set;for(const we of at){const ye=fe(we);!ye||se.has(ye)||(se.add(ye),Sr.push(we))}let Ze=Sr.slice(0,50),ct=Ze.findIndex(we=>re(we));if(ct>=0){const we=Ze[ct];F(fe(we)),Ze=[we,...Ze.filter((ye,te)=>te!==ct)]}else if(B){const we=fe(B);F(we),I(!0),Ze=[B,...Ze]}else F(null);_(Ze),k(vt);const Qt={};B&&(Qt[fe(B)]=!0),Sr.slice(0,50).forEach(we=>{Qt[fe(we)]=!0}),A(Qt),C(!0),I(yt||!!B)}catch{const lt=me(x),gt=x.split(/[\n,;]+/).map(se=>se.trim()).filter(Boolean),Te=gt.some(se=>{const Ze=se.replace(/^[\W_]+|[\W_]+$/g,"");return re(Ze)}),at=[],yt=new Set;for(const se of gt){const Ze=se.replace(/^[\W_]+|[\W_]+$/g,""),ct=fe(Ze),Qt=/[A-Za-z---]/.test(Ze);if(!(Ze.length>=2&&Ze.length<=60&&Qt&&!/[0-9@]/.test(Ze))||!ct||lt.has(ct)||yt.has(ct))continue;yt.add(ct);const ye=Ze.toLowerCase().split(/\s+/).map(te=>te&&te[0].toUpperCase()+te.slice(1)).join(" ");at.push(ye)}let vt=at.slice(0,50);if(B){const se=fe(B);F(se),I(!0),vt=[B,...vt]}_(vt);const Sr={};B&&(Sr[fe(B)]=!0),at.slice(0,50).forEach(se=>{Sr[fe(se)]=!0}),A(Sr),C(!0),I(Te||!!B)}finally{w(!1)}}},J=Y=>{const lt=fe(Y);A(gt=>({...gt,[lt]:!gt[lt]}))},je=()=>{const Y={...E};j.forEach(lt=>{Y[fe(lt)]=!0}),A(Y)},be=()=>{const Y={...E};j.forEach(lt=>{Y[fe(lt)]=!1}),A(Y)},Ue=()=>{const Y=j.filter(lt=>{const gt=fe(lt);return D&&gt===D?!1:E[gt]});Y.length!==0&&(typeof i=="function"?i(Y):Y.forEach(lt=>t(lt)),g(!1),y(""),_([]),k([]),A({}))},Z=()=>{y(""),_([]),k([]),A({}),C(!1),I(!1),F(null)};return o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3 w-full",children:[o.jsxs("div",{ref:K,className:"flex items-center justify-end gap-2 scroll-mt-24 md:scroll-mt-28",children:[o.jsx("button",{type:"button",disabled:a,onClick:()=>g(!0),className:`px-3 py-1.5 rounded-lg text-sm font-semibold transition-all ${a?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/80 hover:bg-surface/60 border border-white/10 text-text-primary"}`,children:"Importar lista"}),o.jsx("button",{type:"button",onClick:()=>{q(Y=>{const lt=!Y;try{window.dispatchEvent(new CustomEvent("isis-participantes-expand",{detail:{expanded:lt}}))}catch{}return lt}),setTimeout(()=>{try{K.current?.scrollIntoView({behavior:"smooth",block:"start"})}catch{}},50)},className:`p-2 rounded-lg border transition-all ${z?"bg-white/10 border-brand/40 text-brand shadow-sm":"hover:bg-white/10 border-white/10"}`,"aria-label":z?"Recolher lista":"Expandir lista","aria-pressed":z,children:z?o.jsx(Dk,{className:"w-4 h-4"}):o.jsx(Ik,{className:"w-4 h-4"})})]}),e.length>0&&o.jsx("div",{ref:$,className:`flex flex-col gap-1.5 ${z?"max-h-[240px] md:max-h-[320px]":"max-h-[140px]"} overflow-y-auto px-1 transition-all`,children:e.map((Y,lt)=>o.jsxs(fr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm ${Y.principal?"bg-brand/10 border border-brand/30":"bg-surface/50 border border-white/10"}`,children:[o.jsx("span",{className:"w-7 shrink-0",children:o.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold ${Y.principal?"bg-brand/20 text-brand":"bg-white/10 text-text-primary"}`,children:lt+1})}),o.jsx("span",{className:"text-base shrink-0",children:Y.principal?"":""}),o.jsxs("span",{className:`flex-1 font-medium truncate ${Y.principal?"text-brand":"text-text-primary"}`,children:[Y.nome,Y.principal&&o.jsx("span",{className:"ml-1.5 text-xs opacity-70",children:"(voc)"})]}),!Y.principal&&r&&o.jsx(fr.button,{type:"button",onClick:()=>r(lt),whileHover:{scale:1.1},whileTap:{scale:.9},className:"shrink-0 p-1 rounded-full hover:bg-red-500/20 text-red-400 hover:text-red-300 transition-colors",title:"Remover participante",children:o.jsx(Dl,{className:"w-4 h-4"})})]},lt))}),o.jsxs("form",{onSubmit:G,className:"flex flex-col gap-2",children:[o.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${d?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[o.jsx(wue,{className:`w-4 h-4 shrink-0 transition-colors ${d?"text-brand":"text-text-muted"}`}),o.jsx("input",{ref:h,type:"text",value:l,onChange:Y=>c(Y.target.value),onKeyDown:Q,onFocus:()=>u(!0),onBlur:()=>u(!1),placeholder:f?"Nome":"Nome do participante",disabled:a,autoComplete:"off",className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base font-medium min-w-0"}),o.jsx(fr.button,{type:"submit",whileHover:{scale:l.trim()?1.05:1},whileTap:{scale:l.trim()?.95:1},disabled:!l.trim()||a,className:`
              px-3 py-1.5 rounded-lg transition-all duration-300 text-sm font-semibold shrink-0
              ${l.trim()?"bg-brand text-bg shadow-md":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:"Adicionar"})]}),o.jsx(fr.button,{type:"button",onClick:n,disabled:a,whileHover:{scale:a?1:1.05},whileTap:{scale:a?1:.95},className:`
            w-full px-6 py-3.5 rounded-xl font-bold text-base
            transition-all duration-300
            ${a?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-brand text-bg shadow-lg hover:shadow-xl hover:shadow-brand/30"}
          `,children:o.jsxs("span",{className:"flex items-center justify-center gap-2",children:[o.jsx(Tf,{className:"w-5 h-5"}),"Confirmar Participantes (",e.length,")"]})}),!f&&o.jsxs("p",{className:"text-xs text-text-muted text-center mt-1",children:[" ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Enter"})," adiciona  ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Shift+Enter"})," confirma"]})]}),v&&typeof document<"u"&&zf.createPortal(o.jsxs("div",{className:"fixed inset-0 z-[9999] overflow-y-auto",children:[o.jsx("div",{className:"fixed inset-0 bg-black/75 backdrop-blur-sm",onClick:()=>!b&&g(!1)}),o.jsx("div",{className:"min-h-screen flex items-start justify-center pt-24 md:pt-16 pb-8 px-3",children:o.jsxs("div",{className:"relative w-[96vw] max-w-5xl bg-gradient-to-br from-surface via-background to-surface border border-white/10 rounded-3xl shadow-2xl flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"sticky top-0 z-10 px-5 py-4 border-b border-white/10 bg-surface/70 backdrop-blur flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(ud,{size:"sm",variant:"header"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-base md:text-lg font-extrabold text-text-primary leading-tight",children:j.length>0?"Sugestes encontradas":"Importar participantes"}),o.jsx("p",{className:"text-[11px] md:text-xs text-text-muted",children:j.length>0?`Selecione os nomes para adicionar (${j.length})`:"Cole sua lista e processe com IA"})]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("button",{type:"button",disabled:b,onClick:()=>g(!1),className:"p-2 rounded-lg hover:bg-white/10",children:o.jsx(Dl,{className:"w-5 h-5"})})})]}),o.jsx("div",{className:"flex-1 max-h-[70vh] overflow-y-auto p-4 md:p-5",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-full",children:[o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsx("label",{className:"text-xs text-text-muted mb-2",children:"Sua lista"}),o.jsx("textarea",{value:x,onChange:Y=>y(Y.target.value),disabled:b,placeholder:`Exemplo:
1) Joo Silva
2) Maria Clara
3) Pedro Henrique

Dica: nomes sob os cabealhos 'Lista de espera', 'Lista de reserva' ou 'Convidados' sero ignorados.

Cole sua lista (um por linha ou separados por vrgula) e clique em Processar com sis`,className:"w-full min-h-[320px] max-h-[320px] resize-none overflow-y-auto bg-surface border border-white/10 rounded-xl p-3 outline-none text-sm focus:ring-2 focus:ring-brand/40"}),o.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[o.jsx("button",{type:"button",onClick:Z,disabled:b&&!x.trim(),className:"px-4 py-2 rounded-xl font-semibold bg-surface border border-white/10 text-text-primary hover:bg-white/10 disabled:opacity-60",children:"Apagar"}),o.jsx("button",{type:"button",onClick:ae,disabled:b||!x.trim(),className:"px-5 py-2.5 rounded-xl font-semibold shadow-lg transition bg-gradient-to-r from-brand to-emerald-500 text-white hover:shadow-emerald-500/30 disabled:opacity-60 disabled:cursor-not-allowed",children:b?"Processando":"Processar com sis"})]})]}),o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[o.jsx("span",{children:"Sugeridos"}),o.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:j.length})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:je,disabled:b,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Selecionar todos"}),o.jsx("button",{type:"button",onClick:be,disabled:b,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Limpar"})]})]}),o.jsx("div",{className:"min-h-[320px] max-h-[320px] overflow-y-auto border border-white/10 rounded-xl bg-surface",children:b?o.jsxs("div",{className:"p-3 animate-pulse",children:[o.jsx("div",{className:"h-4 w-28 bg-white/10 rounded mb-3"}),o.jsx("div",{className:"space-y-2",children:Array.from({length:8}).map((Y,lt)=>o.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[o.jsx("div",{className:"h-3 w-40 bg-white/10 rounded"}),o.jsx("div",{className:"h-4 w-4 bg-white/10 rounded"})]},lt))})]}):o.jsx("ul",{className:"divide-y divide-white/5",children:j.map((Y,lt)=>{const gt=fe(Y),Te=M&&T&&D&&gt===D;return o.jsxs("li",{className:`flex items-center justify-between px-3 py-2 ${Te?"bg-white/5":""}`,children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("span",{className:"w-7 shrink-0",children:o.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold ${Te?"bg-emerald-600/25 text-emerald-400":"bg-white/10 text-text-primary"}`,children:lt+1})}),o.jsx("span",{className:"text-sm truncate pr-1",children:Y}),Te&&o.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-emerald-600/20 text-emerald-400 border border-emerald-500/30 shrink-0",children:"Voc"})]}),o.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:Te?!0:!!E[gt],onChange:()=>!Te&&J(Y),disabled:Te})]},gt)})})}),M&&j.length===0&&x.trim()&&!b&&o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum nome novo encontrado."}),S.length>0&&o.jsxs("div",{className:"mt-2 text-xs text-text-muted flex items-center gap-2",children:[o.jsx("span",{children:"Ignorados"}),o.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:S.length})]}),o.jsx("div",{className:"mt-3 flex items-center justify-end",children:o.jsx("button",{type:"button",onClick:Ue,disabled:b||j.filter(Y=>E[fe(Y)]).length===0,className:`px-5 py-2.5 rounded-xl font-semibold ${b||j.filter(Y=>E[fe(Y)]).length===0?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-emerald-600 text-white shadow-lg hover:shadow-emerald-600/30 transition"}`,children:(()=>`Adicionar selecionados (${j.reduce((lt,gt)=>{const Te=fe(gt);return M&&T&&D&&Te===D?lt+1:lt+(E[Te]?1:0)},0)})`)()})})]})]})})]})})]}),document.body)]})},Dit=({onSubmit:e,disabled:t=!1})=>{const[r,n]=p.useState(0),[a,i]=p.useState(0),[s,l]=p.useState(""),[c,d]=p.useState(!1),u=g=>{g.preventDefault(),!(r===0||t)&&e({rating:r,comentario:s.trim()||null,timestamp:new Date().toISOString()})},f=g=>{t||n(g)},m=g=>{t||i(g)},h=()=>{t||i(0)},v=a||r;return o.jsx(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"w-full mb-8 md:mb-4",children:o.jsx("div",{className:"bg-background/98 backdrop-blur-3xl border-2 border-white/50 rounded-3xl p-6 md:p-8 shadow-2xl relative z-50",children:o.jsxs("form",{onSubmit:u,className:"flex flex-col gap-6",children:[o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[o.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(g=>o.jsx(fr.button,{type:"button",onClick:()=>f(g),onMouseEnter:()=>m(g),onMouseLeave:h,disabled:t,whileHover:{scale:t?1:1.2},whileTap:{scale:t?1:.9},className:`
                    p-2 transition-all duration-200 rounded-full
                    ${t?"cursor-not-allowed":"cursor-pointer hover:bg-brand/10"}
                  `,children:o.jsx(gue,{className:`w-8 h-8 md:w-10 md:h-10 transition-all duration-200 ${g<=v?"fill-yellow-400 text-yellow-400 drop-shadow-lg":"text-text-muted hover:text-yellow-300"}`})},g))}),r>0&&o.jsx(fr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:o.jsxs("p",{className:"text-base font-semibold text-text-primary",children:[r===1&&" Muito ruim",r===2&&" Ruim",r===3&&" Regular",r===4&&" Bom",r===5&&" Excelente"]})})]}),r>0&&o.jsx("div",{className:"w-full h-px bg-white/10 my-2"}),r>0&&o.jsxs(fr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3,delay:.2},className:"flex flex-col gap-4",children:[o.jsxs("label",{className:"text-base font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(fue,{className:"w-5 h-5 text-brand"}),"Comentrio (opcional)"]}),o.jsx("div",{className:`
                flex items-start gap-2 px-4 py-3 rounded-xl
                bg-background/60 backdrop-blur-sm
                border-2 transition-all duration-300
                ${c?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
              `,children:o.jsx("textarea",{value:s,onChange:g=>l(g.target.value),onFocus:()=>d(!0),onBlur:()=>d(!1),placeholder:"Conte-nos mais sobre sua experincia...",disabled:t,rows:3,maxLength:500,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base resize-none min-w-0"})}),o.jsxs("div",{className:"text-sm text-text-muted text-right",children:[s.length,"/500"]})]}),r>0&&o.jsx(fr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},className:"mt-2 mb-4",children:o.jsxs(fr.button,{type:"submit",disabled:t,whileHover:{scale:t?1:1.02},whileTap:{scale:t?1:.98},className:`
                w-full px-6 py-4 rounded-2xl font-bold text-lg
                transition-all duration-300 flex items-center justify-center gap-3
                shadow-xl border-2
                ${t?"bg-surface text-text-muted cursor-not-allowed border-white/10":"bg-gradient-to-r from-brand to-brand/90 text-white shadow-brand/30 hover:shadow-2xl hover:shadow-brand/40 border-brand/20 hover:from-brand/90 hover:to-brand"}
              `,children:[o.jsx(UT,{className:"w-6 h-6"}),"Enviar Avaliao"]})})]})})})},Mit=({message:e="Carregando..."})=>{const t=[" sis IA iniciando..."," Processando dados em tempo real..."," IA analisando disponibilidade..."," sis aprendendo suas preferncias..."," Assistente virtual ativando..."," IA otimizando seu agendamento..."," sis calculando melhores opes..."," Sincronizando com IA..."," Inteligncia artificial carregando..."," sis processando informaes..."],r=t[Math.floor(Math.random()*t.length)];return o.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-surface/30 to-background",children:o.jsx(fr.div,{className:"absolute inset-0 opacity-20",animate:{background:["radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 80% 50%, #FFAA33 0%, transparent 50%)","radial-gradient(circle at 50% 20%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}})}),o.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(6)].map((n,a)=>o.jsx(fr.div,{className:"absolute w-2 h-2 rounded-full",style:{background:a%2===0?"#FF6600":"#FFAA33",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[-20,-100,-20],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},a))}),o.jsxs(fr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.8,ease:[.22,1,.36,1]},className:"relative z-10 text-center",children:[o.jsxs("div",{className:"mb-8 flex flex-col items-center gap-6",children:[o.jsxs(fr.div,{className:"relative",animate:{rotateY:[0,360]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:[o.jsx(fr.div,{className:"absolute inset-0 rounded-2xl blur-xl opacity-60",style:{background:"#FFAA33"},animate:{scale:[1,1.2,1],opacity:[.4,.8,.4]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),o.jsx(fr.div,{className:"relative w-20 h-20 md:w-24 md:h-24 rounded-2xl flex items-center justify-center",style:{background:"#FFAA33"},whileHover:{scale:1.05},children:o.jsx(nd,{className:"w-12 h-12 md:w-14 md:h-14 text-white",strokeWidth:2})})]}),o.jsxs(fr.div,{className:"flex items-baseline gap-1",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3},children:[o.jsx(fr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FF6600"},animate:{textShadow:["0 0 10px rgba(255, 102, 0, 0.5)","0 0 20px rgba(255, 102, 0, 0.8)","0 0 10px rgba(255, 102, 0, 0.5)"]},transition:{duration:2,repeat:1/0},children:"Fluxo"}),o.jsx(fr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FFAA33"},animate:{textShadow:["0 0 10px rgba(255, 170, 51, 0.5)","0 0 20px rgba(255, 170, 51, 0.8)","0 0 10px rgba(255, 170, 51, 0.5)"]},transition:{duration:2,repeat:1/0,delay:.1},children:"7"}),o.jsx(fr.span,{className:"font-medium text-4xl md:text-5xl ml-2",style:{color:"#B0B0B0"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.6},children:"Arena"})]})]}),o.jsx("div",{className:"w-64 md:w-80 mx-auto mb-6",children:o.jsx("div",{className:"h-1 bg-surface/30 rounded-full overflow-hidden",children:o.jsx(fr.div,{className:"h-full rounded-full",style:{background:"linear-gradient(90deg, #FFAA33, #FFD700, #FFAA33)"},animate:{x:[-100,300]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},initial:{x:-100}})})}),o.jsxs(fr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.8},className:"space-y-3",children:[o.jsx(fr.p,{className:"text-base md:text-lg font-medium text-text-primary px-4",animate:{opacity:[.7,1,.7]},transition:{duration:1.5,repeat:1/0},children:r}),o.jsx("div",{className:"flex justify-center gap-1",children:[0,1,2].map(n=>o.jsx(fr.div,{className:"w-2 h-2 rounded-full",style:{background:"#FFAA33"},animate:{scale:[.8,1.2,.8],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:n*.2}},n))})]})]})]})},Rit={greeting:["Ol! Eu sou a Isis  Vou te ajudar a agendar sua quadra! Qual voc prefere?","Oi! Sou a Isis!  Vamos agendar? Me diz, qual quadra voc quer?","E a! Isis aqui! Bora marcar sua partida? Qual quadra te interessa?","Ol!  Prazer, sou a Isis! Qual quadra voc quer reservar?","Opa! Isis na rea! Vamos agendar sua quadra? Qual delas?","Seja bem-vindo! Sou a Isis e vou facilitar sua reserva! Qual quadra?"],afterQuadra:["Boa escolha! {quadra}  tima!  Para qual dia?","Perfeito! {quadra}  top! Qual dia voc quer?","{quadra} confirmada!  Me diz, que dia?","Show! {quadra}  sucesso aqui! Qual o dia?","Anotado! {quadra}  Agora me fala o dia:","Excelente! {quadra}  uma das melhores! Para quando?"],afterData:["Beleza! {data} anotado!  Qual horrio voc prefere?","timo! {data} t disponvel! Que horas?","{data}  logo ali!  Me diz o horrio:","Confirmado {data}! Qual horrio te atende melhor?","Perfeito! {data}  Agora escolhe o horrio:","Show! {data} t livre! Qual o melhor horrio pra voc?"],afterHorario:["{horario}  seu!  Qual modalidade?","Reservado {horario}!  Vai ser qual modalidade?","Fechou {horario}! Qual esporte?","{horario} confirmado! Me diz a modalidade:","Show! {horario}  E a modalidade ...?","Perfeito! {horario} garantido! Qual modalidade?"],afterModalidade:["{modalidade}! Massa!  Quantas pessoas vo jogar?","Vai ser {modalidade}! Legal! Quantos jogadores?","{modalidade}  bom demais!  Quantas pessoas?","Top! {modalidade}  Me diz quantas pessoas:","{modalidade} confirmado! Quantos vo jogar?","timo! {modalidade}  show! Quantos participantes?"],askNames:["Agora preciso dos nomes! Digite cada um (um por linha):","Beleza! Me manda os nomes dos participantes:","Show! Lista os nomes pra mim:","timo! Quais so os nomes?","Perfeito! Me passa os nomes de todo mundo:","Legal! Agora os nomes dos jogadores:"],askContact:["ltimos dados! Qual seu nome completo?","Agora preciso do seu nome e telefone:","Quase l! Me passa seu nome e WhatsApp:","Beleza! Seus dados para contato:","Falta pouco! Nome completo e telefone:","ltima etapa! Qual seu nome e telefone?"],reviewData:["timo! Vamos conferir tudo antes de confirmar:","Perfeito! Revisa comigo os dados:","Show! Confirma se t tudo certo:","Beleza! D uma olhada se est correto:","Legal! Vamos revisar juntos:","Massa! Confere os detalhes aqui:"],confirmation:[" Tudo certo! Agendamento #{codigo} confirmado!"," Pronto! Seu agendamento #{codigo} est garantido!"," Feito! Cdigo #{codigo} confirmado!"," Sucesso! Agendamento #{codigo} t na agenda!"," Confirmado! #{codigo}  seu!"," Show! Agendamento #{codigo} marcado!"],thankYou:["Obrigada por agendar conosco! At logo! ","Valeu! Te vejo no jogo! ","Brigada! Bom jogo! ","Obrigada! At a partida! ","Valeu pela preferncia! At breve! ","Obrigada! Qualquer coisa,  s voltar aqui! "],loading:["Deixa eu verificar...","S um momento...","J te respondo...","Aguarda um pouquinho...","Consultando aqui...","Verificando pra voc..."],error:["Ops! Algo deu errado. Vamos tentar de novo?","Eita! Tive um problema aqui. Podemos recomear?","Putz! Deu erro. Tenta novamente?","Opa! Algo no funcionou. Vamos de novo?","Caramba! Erro aqui. Pode tentar novamente?"],noAvailability:["Puts... esse horrio j foi reservado.  Escolhe outro?","Eita! Esse j est ocupado. Que tal outro horrio?","Opa! Esse horrio acabou de ser reservado. Tem outro?","Poxa! Algum reservou esse agora mesmo. Outro horrio?","Xiii! Esse j foi. Bora escolher outro?"]},ev=(e,t={})=>{const r=Rit[e];if(!r||r.length===0)return console.warn(`[Isis] Nenhuma variao encontrada para step: ${e}`),"Ol! Como posso ajudar?";const n=Math.floor(Math.random()*r.length);let a=r[n];return Object.keys(t).forEach(i=>{const s=new RegExp(`\\{${i}\\}`,"g");a=a.replace(s,t[i])}),a},O4="690605e5ae596e708f3c7bc5",T4="$2a$10$/XmOGvx8./SZzV3qMzQ5i.6FjBjS4toNbeaEFzX2D8QPUddyM6VR2",_oe="https://api.jsonbin.io/v3",Lit=async()=>{try{const e=await fetch(`${_oe}/b/${O4}/latest`,{method:"GET",headers:{"X-Master-Key":T4,"Content-Type":"application/json"}});if(!e.ok){const r=await e.text();throw console.error("[JSONBin] Resposta do servidor:",r),e.status===401?new Error("Chave de API JSONBin invlida ou bin no pertence  conta"):e.status===404?new Error("Bin JSONBin no encontrado"):new Error(`Erro ao buscar dados: ${e.status} - ${r}`)}return(await e.json()).record}catch(e){throw console.error("[JSONBin] Erro ao buscar dados:",e),e}},$it=async e=>{try{const t=await fetch(`${_oe}/b/${O4}`,{method:"PUT",headers:{"X-Master-Key":T4,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Erro ao atualizar dados: ${t.status}`);return(await t.json()).record}catch(t){throw console.error("[JSONBin] Erro ao atualizar dados:",t),t}},Fit=e=>{try{const t=JSON.parse(localStorage.getItem("isis-feedbacks")||"[]");return t.push(e),localStorage.setItem("isis-feedbacks",JSON.stringify(t)),console.log("[JSONBin] Feedback salvo localmente como fallback:",e.id),e}catch(t){return console.error("[JSONBin] Erro ao salvar feedback localmente:",t),e}},Bit=async e=>{const t={id:Date.now()+Math.random().toString(36).substr(2,9),timestamp:new Date().toISOString(),estrelas:e.rating,nome_cliente:e.cliente_nome,empresa:e.empresa_nome,projeto:"fluxo7arena",comentario:e.comentario||null};try{console.log("[JSONBin] Adicionando feedback ISIS:",e);const r=await Lit();return r["feedback-isis"]||(r["feedback-isis"]=[]),r["feedback-isis"].push(t),await $it(r),console.log("[JSONBin] Feedback adicionado com sucesso:",t.id),t}catch(r){return console.error("[JSONBin] Erro ao adicionar feedback, salvando localmente:",r),Fit(t)}},qit=()=>{const{nomeFantasia:e}=$ce(),t=xe.useMemo(()=>{try{if(typeof window>"u")return null;const Ie=window.location.host||"",ke="f7arena.com";if(!Ie.endsWith(ke))return null;const Je=Ie.slice(0,-ke.length).replace(/\.$/,"");if(!Je)return null;const mt=Je.toLowerCase();return mt==="www"?null:mt}catch{return null}},[]),r=e||t;Fl();const[n,a]=p.useState(null),{currentStep:i,selections:s,addIsisMessage:l,addIsisMessageWithButtons:c,addUserMessage:d,disableAllButtons:u,removeMessageById:f,hideButtonsInMessage:m,updateSelection:h,updateContact:v,nextStep:g,setIsLoading:x,setIsTyping:y,chatEndRef:b}=Noe(),[w,j]=p.useState(null),[_,S]=p.useState([]),[k,E]=p.useState([]),[A,M]=p.useState(!0),[C,T]=p.useState("telefone"),[I,D]=p.useState(!1),[F,z]=p.useState(null),[q,$]=p.useState(null),[K,ce]=p.useState(!1),fe=xe.useMemo(()=>(console.log("[Isis] Logo da empresa:",{logo_url:w?.logo_url,empresa:w}),w?.logo_url?`${w.logo_url}?v=${Date.now()}`:w?.logo_url||""),[w?.logo_url]);p.useEffect(()=>{(async()=>{if(!r){M(!1);return}try{console.log("[Isis] Buscando empresa por nome fantasia:",r);const Je=decodeURIComponent(r).toLowerCase().replace(/[\s\-_]+/g,"").trim();console.log("[Isis] Nome normalizado para busca:",Je);let mt=null;try{const{data:$t,error:Ee}=await pe.rpc("get_empresa_public_by_slug",{p_slug:Je});!Ee&&$t&&$t.length>0&&(mt=$t[0])}catch{}let Be=mt||null;if(!Be){const{data:$t,error:Ee}=await pe.from("empresas").select("codigo_empresa, nome_fantasia, razao_social, nome, logo_url");if(!Ee&&Array.isArray($t)){const Ct=$t.find(hr=>[hr?.nome_fantasia||"",hr?.razao_social||"",hr?.nome||""].some(qr=>qr.toLowerCase().replace(/[\s\-_]+/g,"").trim()===Je));Ct&&(Be=Ct)}}if(!Be){console.error("[Isis] Empresa no encontrada (RPC e fallback)"),a(null),M(!1);return}console.log("[Isis] Empresa encontrada:",Be),a(Be.codigo_empresa),j(Be),M(!1)}catch(ke){console.error("[Isis] Erro ao buscar empresa:",ke),a(null),M(!1)}})()},[r]),p.useEffect(()=>{if(console.log("[DEBUG] useEffect iniciarConversa:",{codigoEmpresa:n,loadingEmpresa:A,hasCliente:!!s.cliente,identificacaoIniciada:K,timestamp:new Date().toISOString()}),!n||A){console.log("[DEBUG] Saindo - sem cdigo ou ainda carregando");return}!s.cliente&&!K?(console.log("[DEBUG] Cliente no identificado e identificao no iniciada, agendando iniciarIdentificacao em 1s"),ce(!0),setTimeout(()=>{console.log("[DEBUG] Executando iniciarIdentificacao aps delay (loading fora da tela)"),L()},2500)):console.log("[DEBUG] Cliente j identificado ou identificao j iniciada, no fazendo nada")},[n,A,s.cliente,K]),p.useEffect(()=>{(async()=>{if(!n){M(!1);return}try{console.log("[useEffect] Definindo empresa atual para RLS:",n),await pe.rpc("set_current_empresa",{empresa_codigo:String(n)}),await Z()}catch(ke){console.error("[useEffect] Erro ao definir empresa para RLS:",ke),await Z()}})()},[n]);const B=()=>{const ke=new Date().getHours();return ke>=5&&ke<12?"Bom dia":ke>=12&&ke<18?"Boa tarde":"Boa noite"},L=()=>{console.log("[DEBUG] iniciarIdentificacao INICIOU:",{loadingEmpresa:A,empresa:w?.nome_fantasia,timestamp:new Date().toISOString()}),T("telefone"),D(!1);const Ie=w?.nome_fantasia||w?.razao_social||"Arena Palace",ke=B(),Je=[`**${ke}!** Tudo bem? 

Sou a **sis**, assistente virtual da **${Ie}** e estou aqui para tornar seu **agendamento** super fcil!

Para comear, qual seu **telefone** ou **e-mail**?`,`Hey! **${ke}!**  **sis** na rea!

Sou a assistente virtual da **${Ie}** e vim facilitar sua vida.

Bora **agendar**? Me passa seu **telefone** ou **e-mail**:`,`**${ke}!** Prazer em te atender! 

Sou a **sis** da **${Ie}**, sua assistente virtual para **agendamentos**.

Para comear, preciso do seu **telefone** ou **e-mail**:`,`Opa! **${ke}!**  **sis** aqui, sua assistente virtual da **${Ie}**!

Vamos **marcar seu horrio**?  rapidinho!

Me informa seu **telefone** ou **e-mail**:`,`**${ke}!** Seja bem-vindo! 

Eu sou a **sis**, sua assistente virtual aqui na **${Ie}**.

Vou te ajudar a **agendar seu horrio** rapidinho!

Informe seu **telefone** ou **e-mail**:`],mt=Math.floor(Math.random()*Je.length);console.log("[DEBUG] Mostrando indicador de digitao primeiro:",{loadingEmpresa:A,timestamp:new Date().toISOString()}),y(!0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll inicial para mostrar indicador de digitao"),b.current?.scrollIntoView({behavior:"smooth",block:"end"})},300),setTimeout(()=>{console.log("[DEBUG] Enviando mensagem da Isis aps indicador de digitao"),y(!1),l(Je[mt],0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll aps mensagem aparecer"),b.current?.scrollIntoView({behavior:"smooth",block:"end"})},100)},3500),setTimeout(()=>{console.log("[DEBUG] Mostrando input"),D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"end"})},200)},3500+600),g("identificacao")},V=async Ie=>{try{console.log("[DEBUG] Buscando cliente com valor:",Ie),console.log("[DEBUG] Cdigo empresa:",n);const ke=Ie.replace(/\D/g,"");if(ke.length>=10){console.log("[DEBUG] Buscando telefone:",ke);const{data:Be,error:$t}=await pe.from("clientes").select("id, nome, email, telefone, whatsapp, celular1, codigo").eq("codigo_empresa",n).eq("status","active");if($t)throw $t;console.log("[DEBUG] Total de clientes ativos:",Be?.length);const Ee=Be?.find(Ct=>{const hr=(Ct.telefone||"").replace(/\D/g,""),Mr=(Ct.whatsapp||"").replace(/\D/g,""),qr=(Ct.celular1||"").replace(/\D/g,"");return hr.includes(ke)||Mr.includes(ke)||qr.includes(ke)});return console.log("[DEBUG] Cliente encontrado:",Ee),Ee||null}const{data:Je,error:mt}=await pe.from("clientes").select("id, nome, email, telefone, whatsapp, codigo").eq("codigo_empresa",n).eq("status","active").ilike("email",`%${Ie}%`);if(console.log("[DEBUG] Busca por email - Clientes encontrados:",Je),mt)throw mt;return Je?.[0]||null}catch(ke){return console.error("Erro ao buscar cliente:",ke),null}},re=Ie=>{const ke=Ie.trim().split(" ").filter(Je=>Je);return ke.length===1?ke[0]:ke.length>=2?`${ke[0]} ${ke[1]}`:ke[0]},me=async Ie=>{if(!Ie){l("Por favor, informe a data desejada.",400);return}const ke=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,Je=Ie.match(ke);if(!Je){l("**Formato invlido!** Por favor, use o formato DD/MM/AAAA (exemplo: 15/12/2024)",400);return}const[,mt,Be,$t]=Je,Ee=new Date(parseInt($t),parseInt(Be)-1,parseInt(mt));if(isNaN(Ee.getTime())||Ee.getDate()!==parseInt(mt)||Ee.getMonth()!==parseInt(Be)-1||Ee.getFullYear()!==parseInt($t)){l("**Data invlida!** Verifique se o dia, ms e ano esto corretos.",400);return}const Ct=new Date;if(Ct.setHours(0,0,0,0),Ee.setHours(0,0,0,0),Ee<Ct){l("**Data no passado!** Por favor, escolha uma data de hoje em diante.",400);return}d(Ie);const hr=Xt(Ee,"dd/MM/yyyy",{locale:aa}),Mr=Xt(Ee,"EEEE",{locale:aa});x(!0);const qr=await Te(s.quadra.id,Ee);if(x(!1),qr.fechada){if(qr.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${hr}** (${Mr}). 

**Motivo:** ${qr.observacao}`,800);else if(qr.motivo==="dia_semana"){const Ar=Xt(Ee,"EEEE",{locale:aa});l(`**Ops!** A quadra no funciona ${Ar==="domingo"||Ar==="sbado"?"aos":"s"} **${Ar}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{l("Digite **outra data** no formato DD/MM/AAAA:",1200),setTimeout(()=>{D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},400)},1200);return}h("data",Ee),D(!1),T("telefone"),l(`**Perfeito!** Data escolhida: **${hr}** (${Mr}) `,600);const Or=qr.slots;if(Or.length===0){l("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outra data?",800),setTimeout(()=>{perguntarData()},1200);return}const Mt=at(Or);let Ir="";Mt.length===1?Ir=`Tenho **horrios livres** das **${Mt[0].inicio}** s **${Mt[0].fim}**! `:Ir=`Tenho **horrios livres** ${Mt.map((Zt,Kr)=>Kr===Mt.length-1?`e das **${Zt.inicio}** s **${Zt.fim}**`:Kr===0?`das **${Zt.inicio}** s **${Zt.fim}**`:`das **${Zt.inicio}** s **${Zt.fim}**`).join(", ")}! `,l(Ir,1e3),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",1200),g("horario"),setTimeout(()=>{D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},1600)},G=async Ie=>{if(C==="data_custom")return await me(Ie);if(!Ie){l("Por favor, informe seu telefone ou e-mail.",400);return}const ke=C==="telefone"?`(${Ie.slice(0,2)}) ${Ie.slice(2,7)}-${Ie.slice(7)}`:Ie;d(ke);const Je=await V(Ie);if(Je){h("cliente",Je),D(!1);const mt=re(Je.nome),Be=[`**${mt}!** `,`Opa, **${mt}!** `,`E a, **${mt}!** `,`**${mt}!** Que bom te ver! `,`Fala, **${mt}!** `,`**${mt}!** Tudo bem? `,`Hey, **${mt}!** `],$t=Math.floor(Math.random()*Be.length);l(Be[$t],600),setTimeout(()=>{be()},1e3)}else h("identificacao_valor",ke),h("identificacao_tipo",C),D(!1),l("No encontrei seu cadastro. Sem problemas! Vamos fazer rapidinho. ",800),l("Preciso de algumas informaes:",1400),setTimeout(()=>{D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+800),g("cadastro")},Q=async Ie=>{let ke=`Nome: ${Ie.nome}`;if(Ie.telefone){const Je=`(${Ie.telefone.slice(0,2)}) ${Ie.telefone.slice(2,7)}-${Ie.telefone.slice(7)}`;ke+=`
Telefone: ${Je}`}Ie.email&&(ke+=`
E-mail: ${Ie.email}`),d(ke),await ae(Ie.nome,Ie.email,Ie.telefone)},ae=async(Ie,ke,Je)=>{try{x(!0),l(ev("loading"));const{data:mt}=await pe.from("empresa_counters").select("next_cliente_codigo").eq("empresa_id",w?.id).single(),Be=mt?.next_cliente_codigo||1,{data:$t,error:Ee}=await pe.from("clientes").insert({codigo_empresa:n,codigo:Be,nome:Ie,email:ke||null,telefone:Je,whatsapp:Je,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(Ee){if(Ee.code==="23505"&&Ee.message.includes("uq_clientes_empresa_codigo")){console.log("[Isis] Cdigo duplicado, tentando prximo cdigo...");const{data:Ct,error:hr}=await pe.from("clientes").insert({codigo_empresa:n,codigo:Be+1,nome:Ie,email:ke||null,telefone:Je,whatsapp:Je,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(hr)throw hr;await pe.from("empresa_counters").update({next_cliente_codigo:Be+2}).eq("empresa_id",w?.id),x(!1),h("cliente",Ct),l(`Pronto, ${Ie}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{Ue()},1400);return}throw Ee}await pe.from("empresa_counters").update({next_cliente_codigo:Be+1}).eq("empresa_id",w?.id),x(!1),h("cliente",$t),l(`Pronto, ${Ie}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{Ue()},1400)}catch(mt){console.error("Erro ao criar cliente:",mt),x(!1),l("Ops! Erro ao criar cadastro. Tente novamente.",400)}},J=()=>{const Ie=new Date,ke=Oa(Ie,1),Je=[{label:`Hoje (${Xt(Ie,"dd/MM")})`,value:Xt(Ie,"yyyy-MM-dd"),icon:"",date:Ie},{label:`Amanh (${Xt(ke,"dd/MM")})`,value:Xt(ke,"yyyy-MM-dd"),icon:"",date:ke},{label:"Outro dia...",value:"custom",icon:""}];c("Para qual dia voc gostaria de agendar?",Je,600),g("data")},je=()=>{d(" Mudar Data"),D(!1),setTimeout(()=>{J()},400)},be=()=>{const Ie=["O que voc gostaria de fazer hoje?","Como posso te ajudar?","Qual  o plano para hoje?","O que vamos fazer?","Em que posso te auxiliar?","Qual sua necessidade hoje?","Como posso ser til?"],ke=Ie[Math.floor(Math.random()*Ie.length)];c(ke,[{label:"Fazer Agendamento",value:"novo_agendamento",icon:""},{label:"Editar Agendamento",value:"buscar_agendamento",icon:""},{label:"Finalizar Atendimento",value:"finalizar_atendimento",icon:""}],600)},Ue=async()=>{console.log("[iniciarAgendamento] Dados disponveis:",{quadras:_?.length||0,empresa:!!w,empresaNome:w?.nome_fantasia||w?.razao_social});let Ie=_,ke=w;if(!Ie||Ie.length===0){console.log("[iniciarAgendamento] Quadras no disponveis, carregando...");const Je=await Z(!1);if(Ie=Je.quadras,ke=Je.empresa,!Ie||Ie.length===0){console.error("[iniciarAgendamento] Quadras ainda no disponveis aps carregar!"),l("Ops! No consegui carregar as quadras. Tente novamente.",600);return}}if(!ke){console.error("[iniciarAgendamento] Empresa no disponvel!"),l("Ops! No consegui carregar os dados da empresa. Tente novamente.",600);return}setTimeout(()=>{Y(Ie,ke,!0)},800)},Z=async(Ie=!0)=>{try{Ie&&M(!0);const ke=Date.now(),Je=3500;console.log("[DEBUG] Loading premium INICIOU:",{startTime:ke,minLoadingTime:Je,timestamp:new Date().toISOString()});const{data:mt,error:Be}=await pe.from("empresas").select("*").eq("codigo_empresa",n).single();if(Be)throw Be;if(!mt)return jj({title:"Empresa no encontrada",description:"Verifique o cdigo e tente novamente",variant:"destructive"}),{empresa:null,quadras:[]};j(mt),h("empresa",mt);const{data:$t,error:Ee}=await pe.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status, descricao").eq("codigo_empresa",String(n)).eq("status","Ativa").order("nome",{ascending:!0});if(Ee)throw console.error("[loadEmpresa] Erro ao buscar quadras:",Ee),Ee;if(!$t||$t.length===0){console.warn("[loadEmpresa] Nenhuma quadra encontrada devido a RLS. Criando quadra temporria.");const Mr=[{id:"temp-quadra-1004",nome:"Quadra Principal",modalidades:["Futebol","Futsal"],hora_inicio:"07:00:00",hora_fim:"22:00:00",valor:30,codigo_empresa:String(n),status:"Ativa",descricao:"Quadra temporria (problema de permisso)"}];return S(Mr),{empresa:mt,quadras:Mr}}S($t||[]);const Ct=Date.now()-ke,hr=Math.max(0,Je-Ct);return console.log("[DEBUG] Verificando delay mnimo:",{elapsedTime:Ct,remainingTime:hr,willWait:hr>0,timestamp:new Date().toISOString()}),hr>0&&(console.log("[DEBUG] Aguardando delay mnimo de",hr,"ms"),await new Promise(Mr=>setTimeout(Mr,hr)),console.log("[DEBUG] Delay mnimo CONCLUDO")),{empresa:mt,quadras:$t||[]}}catch(ke){console.error("[Isis] Erro ao carregar empresa:",ke);const Je=Date.now()-startTime,mt=Math.max(0,minLoadingTime-Je);return mt>0&&await new Promise(Be=>setTimeout(Be,mt)),jj({title:"Erro ao carregar",description:"No foi possvel carregar os dados da empresa",variant:"destructive"}),{empresa:null,quadras:[]}}finally{Ie&&(console.log("[DEBUG] loadEmpresa FINALIZOU - setLoadingEmpresa(false):",{timestamp:new Date().toISOString()}),M(!1))}},Y=(Ie,ke,Je=!1)=>{if(console.log("[iniciarConversa] Iniciando com:",{quadras:Ie?.length||0,empresa:ke?.nome_fantasia||ke?.razao_social,jaIdentificado:Je}),ke.nome_fantasia||ke.razao_social,B(),Ie.length===1){console.log("[iniciarConversa] Uma quadra detectada, auto-selecionando:",Ie[0].nome);const $t=Ie[0];if(Je){const Ee=[`Perfeito! Agora vamos **agendar** seu horrio na **${$t.nome}!** `,`timo! Vou te ajudar a **marcar sua partida** na **${$t.nome}!** `,`Show! Bora **agendar** a **${$t.nome}?** `,`Perfeito! Vamos **marcar sua reserva** na **${$t.nome}!** `],Ct=Math.floor(Math.random()*Ee.length),hr=Ee[Ct];l(hr)}h("quadra",$t),setTimeout(()=>{const Ee=new Date,Ct=Oa(Ee,1),hr=[{label:`Hoje (${Xt(Ee,"dd/MM")})`,value:Xt(Ee,"yyyy-MM-dd"),icon:"",date:Ee},{label:`Amanh (${Xt(Ct,"dd/MM")})`,value:Xt(Ct,"yyyy-MM-dd"),icon:"",date:Ct},{label:"Outro dia...",value:"custom",icon:""}];l("Para qual dia voc gostaria de agendar?",800),c("",hr,1e3),g("data")},1200);return}let mt;if(Je){const $t=["Qual quadra voc quer reservar? ","Qual quadra te interessa? ","Me diz, qual quadra? ","Qual quadra voc prefere? ","Bora escolher a quadra? Qual delas? "],Ee=Math.floor(Math.random()*$t.length);mt=$t[Ee]}else return;const Be=Ie.map($t=>({label:$t.nome,subtitle:$t.descricao||null,value:$t.id,icon:"",quadra:$t}));c(mt,Be),g("quadra")},lt=async Ie=>{console.log("[handleQuadraSelection] Iniciando...",{button:Ie,currentStep:i});const ke=Ie.quadra;if(d(ke.nome),h("quadra",ke),i==="review"){console.log("[handleQuadraSelection] Modo edio detectado - recarregando horrios"),console.log("[handleQuadraSelection] Quadra ID:",ke.id),console.log("[handleQuadraSelection] Data:",s.data),D(!1),z("horario"),x(!0);const Ee=await Te(ke.id,s.data,q?.id);if(console.log("[handleQuadraSelection] Resultado:",Ee),x(!1),Ee.fechada){const hr=Xt(s.data,"dd/MM/yyyy",{locale:aa}),Mr=Xt(s.data,"EEEE",{locale:aa});if(Ee.motivo==="data_especifica")l(`**Ops!** A **${ke.nome}** estar **fechada** no dia **${hr}** (${Mr}). 

**Motivo:** ${Ee.observacao}`,800);else if(Ee.motivo==="dia_semana"){const qr=Xt(s.data,"EEEE",{locale:aa}),Or=qr==="domingo"||qr==="sbado"?"aos":"s";l(`**Ops!** A **${ke.nome}** no funciona ${Or} **${qr}s**. `,800)}setTimeout(()=>{l("Escolha **outra quadra** ou **mude a data**:",1200),setTimeout(()=>{J()},400)},1600);return}const Ct=Ee.slots;if(Ct&&Ct.length>0){const hr=at(Ct);let Mr="";hr.length===1?Mr=`Tenho **horrios livres** das **${hr[0].inicio}** s **${hr[0].fim}**! `:Mr=`Tenho **horrios livres** ${hr.map((Or,Mt)=>Mt===hr.length-1?`e das **${Or.inicio}** s **${Or.fim}**`:Mt===0?`das **${Or.inicio}** s **${Or.fim}**`:`das **${Or.inicio}** s **${Or.fim}**`).join(", ")}! `,console.log("[handleQuadraSelection] Mostrando horrios disponveis e input de horrio"),l(Mr,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleQuadraSelection] Ativando showInput=true"),D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleQuadraSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia. ");return}console.log("[handleQuadraSelection] Fluxo normal (no edio)");const Je=ev("afterQuadra",{quadra:ke.nome});l(Je,600);const mt=new Date,Be=Oa(mt,1),$t=[{label:`Hoje (${Xt(mt,"dd/MM")})`,value:Xt(mt,"yyyy-MM-dd"),icon:"",date:mt},{label:`Amanh (${Xt(Be,"dd/MM")})`,value:Xt(Be,"yyyy-MM-dd"),icon:"",date:Be},{label:"Outro dia...",value:"custom",icon:""}];c("Para qual dia voc gostaria de agendar?",$t,1e3),g("data")},gt=async Ie=>{if(console.log("[handleDataSelection] Iniciando...",{button:Ie,currentStep:i}),Ie.value==="custom"){d(" Outro dia..."),l("**Perfeito!** Me informe a **data desejada** no formato DD/MM/AAAA:",600),T("data_custom"),setTimeout(()=>{D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},800);return}const ke=Ie.date;if(d(Ie.label),h("data",ke),i==="review"){console.log("[handleDataSelection] Modo edio detectado - recarregando horrios"),console.log("[handleDataSelection] Quadra ID:",s.quadra?.id),console.log("[handleDataSelection] Nova Data:",ke),D(!1),z("horario"),x(!0);const Ee=await Te(s.quadra.id,ke,q?.id);if(console.log("[handleDataSelection] Resultado:",Ee),x(!1),Ee.fechada){const hr=Xt(ke,"dd/MM/yyyy",{locale:aa}),Mr=Xt(ke,"EEEE",{locale:aa});if(Ee.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${hr}** (${Mr}). 

**Motivo:** ${Ee.observacao}`,800);else if(Ee.motivo==="dia_semana"){const qr=Xt(ke,"EEEE",{locale:aa});l(`**Ops!** A quadra no funciona ${qr==="domingo"||qr==="sbado"?"aos":"s"} **${qr}s**. `,800)}setTimeout(()=>{l("Escolha **outra data**:",1200),setTimeout(()=>{J()},400)},1600);return}const Ct=Ee.slots;if(Ct&&Ct.length>0){const hr=at(Ct);let Mr="";hr.length===1?Mr=`Tenho **horrios livres** das **${hr[0].inicio}** s **${hr[0].fim}**! `:Mr=`Tenho **horrios livres** ${hr.map((Or,Mt)=>Mt===hr.length-1?`e das **${Or.inicio}** s **${Or.fim}**`:Mt===0?`das **${Or.inicio}** s **${Or.fim}**`:`das **${Or.inicio}** s **${Or.fim}**`).join(", ")}! `,console.log("[handleDataSelection] Mostrando horrios disponveis e input"),l(Mr,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleDataSelection] Ativando showInput=true"),D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleDataSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia.  Tente outra data.");return}console.log("[handleDataSelection] Fluxo normal (no edio)"),x(!0);const Je=await Te(s.quadra.id,ke);if(console.log("[handleDataSelection] Resultado (fluxo normal):",Je),x(!1),Je.fechada){const Ee=Xt(ke,"dd/MM/yyyy",{locale:aa}),Ct=Xt(ke,"EEEE",{locale:aa});if(Je.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${Ee}** (${Ct}). 

**Motivo:** ${Je.observacao}`,800);else if(Je.motivo==="dia_semana"){const hr=Xt(ke,"EEEE",{locale:aa});l(`**Ops!** A quadra no funciona ${hr==="domingo"||hr==="sbado"?"aos":"s"} **${hr}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{l("Que tal tentar **outra data**? ",1200),setTimeout(()=>{J()},400)},1600);return}const mt=Je.slots;if(mt.length===0){console.log("[handleDataSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outro dia?");return}const Be=at(mt);let $t="";Be.length===1?$t=`Tenho **horrios livres** das **${Be[0].inicio}** s **${Be[0].fim}**! `:$t=`Tenho **horrios livres** ${Be.map((Ct,hr)=>hr===Be.length-1?`e das **${Ct.inicio}** s **${Ct.fim}**`:hr===0?`das **${Ct.inicio}** s **${Ct.fim}**`:`das **${Ct.inicio}** s **${Ct.fim}**`).join(", ")}! `,l($t,800),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",1e3),g("horario"),setTimeout(()=>{D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},1e3)},1e3+600)},1400)},Te=async(Ie,ke,Je=null)=>{try{console.log("[loadHorariosDisponiveis] quadraId:",Ie),console.log("[loadHorariosDisponiveis] data:",ke);const mt=_.find(dn=>dn.id===Ie);if(!mt)return console.error("[loadHorariosDisponiveis] Quadra no encontrada:",Ie),[];console.log("[loadHorariosDisponiveis] Quadra encontrada:",mt.nome),console.log("[loadHorariosDisponiveis] Horrio funcionamento:",mt.hora_inicio,"-",mt.hora_fim);const Be=Xt(ke,"yyyy-MM-dd"),$t=ke.getDay();console.log("[loadHorariosDisponiveis] Verificando funcionamento para:",Be,"dia da semana:",$t);const{data:Ee,error:Ct}=await pe.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",n).eq("quadra_id",Ie).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${Be}),and(tipo.eq.dia_semana,dia_semana.eq.${$t})`);if(Ct)console.error("[loadHorariosDisponiveis] Erro ao buscar configuraes de funcionamento:",Ct);else{console.log("[loadHorariosDisponiveis] Configuraes encontradas:",Ee?.length||0);const dn=Ee?.find(pt=>pt.tipo==="data_fechamento"&&pt.data_fechamento===Be);if(dn&&!dn.funciona)return console.log("[loadHorariosDisponiveis] Quadra fechada em data especfica:",dn.observacao),{slots:[],fechada:!0,motivo:"data_especifica",observacao:dn.observacao||"Fechamento especial"};const Ae=Ee?.find(pt=>pt.tipo==="dia_semana"&&pt.dia_semana===$t);if(Ae&&!Ae.funciona)return console.log("[loadHorariosDisponiveis] Quadra no funciona neste dia da semana"),{slots:[],fechada:!0,motivo:"dia_semana",observacao:`Quadra fechada s ${["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"][$t]}s`};console.log("[loadHorariosDisponiveis] Quadra funciona normalmente na data selecionada")}const hr=ti(ke),Mr=Oa(hr,1);let qr=pe.from("agendamentos").select("inicio, fim, status").eq("codigo_empresa",n).eq("quadra_id",Ie).gte("inicio",hr.toISOString()).lt("inicio",Mr.toISOString()).neq("status","canceled");Je&&(qr=qr.neq("id",Je),console.log("[loadHorariosDisponiveis] Excluindo agendamento sendo editado:",Je));const{data:Or,error:Mt}=await qr;if(Mt)throw Mt;console.log("[loadHorariosDisponiveis] Agendamentos encontrados:",Or?.length||0);const Ir=parseInt(mt.hora_inicio?.split(":")[0]||"6");let Ar=parseInt(mt.hora_fim?.split(":")[0]||"24");Ar===0&&(Ar=24);const Zt=new Date,Kr=ti(ke).getTime()===ti(Zt).getTime(),Tr=[];for(let dn=Ir;dn<Ar;dn++)for(let Ae of[0,30]){const pt=j2(w2(ke,dn),Ae),Br=wye(pt,30);if(Kr&&pt<Zt)continue;Or?.some(Ur=>{const Zr=new Date(Ur.inicio),cn=new Date(Ur.fim),Tn=Math.floor(pt.getTime()/6e4),Qn=Math.floor(Br.getTime()/6e4),Sa=Math.floor(Zr.getTime()/6e4),ht=Math.floor(cn.getTime()/6e4);return Qn===Sa||Tn===ht?!1:Tn<ht&&Qn>Sa})||Tr.push({inicio:Xt(pt,"HH:mm"),fim:Xt(Br,"HH:mm"),inicioDate:pt,fimDate:Br})}return console.log("[loadHorariosDisponiveis] Total de slots disponveis:",Tr.length),E(Tr),{slots:Tr,fechada:!1,motivo:null,observacao:null}}catch(mt){return console.error("[loadHorariosDisponiveis] Erro ao carregar horrios:",mt),E([]),{slots:[],fechada:!1,motivo:"erro",observacao:"Erro ao carregar horrios"}}},at=Ie=>{if(Ie.length===0)return[];const ke=[];let Je={inicio:Ie[0].inicio,fim:Ie[0].fim};for(let Be=1;Be<Ie.length;Be++)Ie[Be].inicio===Je.fim?Je.fim=Ie[Be].fim:(ke.push(Je),Je={inicio:Ie[Be].inicio,fim:Ie[Be].fim});ke.push(Je);const mt=Be=>{const[$t,Ee]=Be.split(":").map(Number);return $t===0&&Ee===0?24*60:$t*60+Ee};return ke.filter(Be=>mt(Be.fim)-mt(Be.inicio)>=60)},yt=({inicio:Ie,fim:ke,esporte:Je})=>{const[mt,Be]=Ie.split(":").map(Number),[$t,Ee]=ke.split(":").map(Number),Ct=s.data,hr=j2(w2(Ct,mt),Be),Mr=$t===0&&Ee===0?j2(w2(Oa(Ct,1),0),0):j2(w2(Ct,$t),Ee),qr={inicio:Ie,fim:ke,inicioDate:hr,fimDate:Mr};if(d(`${qr.inicio} - ${qr.fim}  ${Je}`),console.log("[handleHorarioSubmit] Atualizando horrio:",qr),console.log("[handleHorarioSubmit] Atualizando esporte:",Je),h("horario",qr),h("esporte",Je),D(!1),i==="review"||F==="horario"){setTimeout(()=>{z(null),g("review"),ct(qr,Je)},600);return}const Or=[{nome:s.cliente.nome,cliente_id:s.cliente.id,principal:!0}];h("participantes",Or);const Mt=re(s.cliente.nome);l(`Perfeito! ${Mt}, voc j est na lista! `,800),l('Quer adicionar mais pessoas? Digite o nome e clique em "Adicionar" para cada um, ou finalize quando quiser.',1400),setTimeout(()=>{D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+600),g("participantes")},vt=Ie=>{if(!Ie||!Ie.trim())return;const ke=s.participantes||[],Je={nome:Ie.trim(),cliente_id:null,principal:!1},mt=[...ke,Je];h("participantes",mt)},Sr=Ie=>{if(!Array.isArray(Ie)||Ie.length===0)return;const ke=Mr=>String(Mr||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g," "),Je=s.cliente,mt=Je?.nome?String(Je.nome).trim():null,Be=mt?ke(mt):null,$t=s.participantes||[],Ee=$t.length>0?$t:mt&&Je?[{nome:mt,cliente_id:Je.id,principal:!0}]:[],Ct=new Set,hr=[];Ee.forEach(Mr=>{const qr=ke(Mr.nome);if(!qr||Ct.has(qr))return;Ct.add(qr);const Or=Be&&qr===Be;hr.push({...Mr,principal:Or})}),Ie.forEach(Mr=>{const qr=String(Mr||"").trim();if(!qr)return;const Or=ke(qr);!Or||Ct.has(Or)||Be&&Or===Be||(Ct.add(Or),hr.push({nome:qr,cliente_id:null,principal:!1}))}),hr.length===0&&mt&&Je&&hr.push({nome:mt,cliente_id:Je.id,principal:!0}),h("participantes",hr)},se=Ie=>{const ke=s.participantes||[];if(Ie===0)return;const Je=ke.filter((mt,Be)=>Be!==Ie);h("participantes",Je)},Ze=()=>{const Ie=s.participantes||[];if(Ie.length===0){l("Voc precisa ter pelo menos 1 participante!",400);return}D(!1);const ke=Ie.length;if(ke===1)d(" Apenas eu por enquanto");else{const Je=Ie.filter(mt=>!mt.principal).map(mt=>mt.nome).join(", ");d(` Eu + ${Je} (${ke} pessoas)`)}setTimeout(()=>{z(null),ct()},600)},ct=(Ie=null,ke=null,Je=!1,mt=null,Be=null,$t=null,Ee=null)=>{const Ct=Ie||s.horario,hr=ke||s.esporte,Mr=mt||s.quadra,qr=Be||s.data,Or=$t||s.participantes||[],Mt=Ee||q;if(console.log("[mostrarResumo] Selections atuais:",s),console.log("[mostrarResumo] Horrio usado:",Ct),console.log("[mostrarResumo] Esporte usado:",hr),console.log("[mostrarResumo] Quadra atual:",Mr),console.log("[mostrarResumo] Data atual:",qr),console.log("[mostrarResumo] Modo edio inicial:",Je),!qr||!Ct||!Mr){console.error("[mostrarResumo] Dados obrigatrios faltando:",{dataFinal:qr,horarioFinal:Ct,quadraFinal:Mr});return}if(!Je){const X=ev("reviewData");l(X,400)}const Ir=Or.map((X,nt)=>{const qe=nt===0?"":"",it=nt===0?" (voc)":"";return`${qe} ${X.nome}${it}`}).join(`
`),Ar=Xt(qr,"dd/MM/yyyy",{locale:aa}),Zt=Xt(qr,"EEEE",{locale:aa}),[Kr,Tr]=Ct.inicio.split(":").map(Number),[dn,Ae]=Ct.fim.split(":").map(Number);let pt=dn*60+Ae-(Kr*60+Tr);dn===0&&Ae===0&&(pt=24*60-(Kr*60+Tr));const Br=Math.floor(pt/60),Pr=pt%60,Ur=Pr>0?`${Br}h ${Pr}min`:`${Br}h`,Zr=Mr.valor||0,cn=pt/30,Tn=Math.round(Zr*cn*100)/100,Qn=Tn/Or.length;console.log("[mostrarResumo] Clculo do valor:"),console.log("- Valor por meia hora:",Zr),console.log("- Slots de 30min:",cn),console.log("- Durao em minutos:",pt),console.log("- Valor total:",Tn),console.log("- Participantes:",Or.length),console.log("- Valor dividido:",Qn);const Sa=s?.empresa?.endereco&&String(s.empresa.endereco).trim().length>0?String(s.empresa.endereco).trim():null,ht=Sa?`
 **Endereo**
${Sa}
`:"",Vt=X=>{if(!X)return"N/A";const nt=String(X).replace(/\D/g,"");return nt.length===11?`(${nt.slice(0,2)}) ${nt.slice(2,7)}-${nt.slice(7)}`:nt.length===10?`(${nt.slice(0,2)}) ${nt.slice(2,6)}-${nt.slice(6)}`:X},gr=s.cliente.telefone||s.cliente.whatsapp||null,Lt=Vt(gr),Pt=` **RESUMO DO AGENDAMENTO**

 **Quadra**
${Mr.nome}${ht}
 **Data**
${Ar} (${Zt})

 **Horrio**
${Ct.inicio} s ${Ct.fim}
 Durao: **${Ur}**

 **Modalidade**
${hr}

 **Participantes** (${Or.length})
${Ir}

 **Valor Total**
R$ **${Tn.toFixed(2).replace(".",",")}**
 **Valor Dividido**
R$ **${Qn.toFixed(2).replace(".",",")}** por pessoa

 **Responsvel**
${s.cliente.nome}
 ${Lt}`,Yr=Je?200:1e3,Ft=Pt.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:Pt,copyable:!0,copyText:Ft},Yr);const jr=[{label:Mt?"Salvar Alteraes":"Confirmar Agendamento",value:Mt?"confirm":"criar agendamento",icon:""}],ot=[];_.length>1&&ot.push({label:"Editar Quadra",value:"edit_quadra",icon:""}),ot.push({label:"Editar Data",value:"edit_data",icon:""}),ot.push({label:"Editar Horrio e Esporte",value:"edit_horario",icon:""}),ot.push({label:"Editar Participantes",value:"edit_participantes",icon:""}),Mt&&ot.push({label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""});const Kt=[...jr,...ot];c("Est tudo correto?",Kt,Je?400:1600),g("review")},Qt=(Ie,ke=!1)=>{l(ke?" **Perfeito!** Suas **alteraes** foram **salvas com sucesso!**":" **Pronto!** Seu **agendamento** foi **confirmado com sucesso!**",600,"green");const mt=s.participantes||[],Be=mt.map(Ur=>` ${Ur.nome}`).join(`
`),$t=Xt(s.data,"dd/MM/yyyy",{locale:aa}),Ee=Xt(s.data,"EEEE",{locale:aa}),[Ct,hr]=s.horario.inicio.split(":").map(Number),[Mr,qr]=s.horario.fim.split(":").map(Number);let Or=Mr*60+qr-(Ct*60+hr);Mr===0&&qr===0&&(Or=24*60-(Ct*60+hr));const Mt=Math.floor(Or/60),Ir=Or%60,Ar=Ir>0?`${Mt}h ${Ir}min`:`${Mt}h`,Zt=s.quadra.valor||0,Kr=Or/30,Tr=Math.round(Zt*Kr*100)/100,dn=s?.empresa?.endereco&&String(s.empresa.endereco).trim().length>0?String(s.empresa.endereco).trim():null,Ae=dn?`
 **Endereo**
${dn}
`:"",pt=` **AGENDAMENTO CONFIRMADO**

 **Cdigo:** #${Ie.codigo}

 **Local**
${s.quadra.nome}${Ae}

 **Quando**
${$t} (${Ee})
 ${s.horario.inicio} s ${s.horario.fim} **(${Ar})**

 **Modalidade**
${s.esporte}

 **Participantes** (${mt.length})
${Be}

 **Valor Total:** R$ **${Tr.toFixed(2).replace(".",",")}**

 **Responsvel:** ${s.cliente.nome}`,Br=pt.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:pt,copyable:!0,copyText:Br},1200),c("O que voc gostaria de fazer?",[{label:"Finalizar Atendimento",value:"finalizar",icon:""},{label:"Editar Agendamento",value:"editar_agendamento",icon:""},{label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""}],1800)},we=async Ie=>{if(Ie.quadra){await lt(Ie);return}if(Ie.date){await gt(Ie);return}if(Ie.agendamento){const ke=Xt(new Date(Ie.agendamento.inicio),"dd/MM/yyyy",{locale:aa}),Je=Xt(new Date(Ie.agendamento.inicio),"HH:mm"),mt=Xt(new Date(Ie.agendamento.fim),"HH:mm");d(`${ke}  ${Je}-${mt}`),await te(Ie.agendamento);return}switch(Ie.value){case"confirm":d(q?" Salvar Alteraes":" Confirmar Agendamento"),q?await Dt():await kt();break;case"criar agendamento":d(" Confirmar Agendamento"),await kt();break;case"edit_quadra":d(" Editar Quadra");const Je=_.map(Ir=>({label:Ir.nome,value:Ir.id,icon:"",subtitle:Ir.descricao||Ir.tipo||null,quadra:Ir}));c("Qual quadra voc quer?",Je,600);break;case"edit_data":d(" Editar Data");const mt=new Date,Be=Oa(mt,1),$t=[{label:`Hoje (${Xt(mt,"dd/MM")})`,value:Xt(mt,"yyyy-MM-dd"),icon:"",date:mt},{label:`Amanh (${Xt(Be,"dd/MM")})`,value:Xt(Be,"yyyy-MM-dd"),icon:"",date:Be},{label:"Outro dia...",value:"custom",icon:""}];c("Para qual dia?",$t,600);break;case"edit_horario":d(" Editar Horrio e Esporte"),D(!1),z("horario"),x(!0);const Ee=await Te(s.quadra.id,s.data,q?.id);if(x(!1),Ee.fechada){const Ir=Xt(s.data,"dd/MM/yyyy",{locale:aa}),Ar=Xt(s.data,"EEEE",{locale:aa});if(Ee.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${Ir}** (${Ar}). 

**Motivo:** ${Ee.observacao}`,800);else if(Ee.motivo==="dia_semana"){const Zt=Xt(s.data,"EEEE",{locale:aa});l(`**Ops!** A quadra no funciona ${Zt==="domingo"||Zt==="sbado"?"aos":"s"} **${Zt}s**. `,800)}setTimeout(()=>{l("No  possvel editar o horrio. Escolha **outra data** ou **quadra**:",1200),setTimeout(()=>{J()},400)},1600);return}const Ct=Ee.slots;if(Ct&&Ct.length>0){const Ir=at(Ct);let Ar="";Ir.length===1?Ar=`Tenho **horrios livres** das **${Ir[0].inicio}** s **${Ir[0].fim}**! `:Ar=`Tenho **horrios livres** ${Ir.map((Kr,Tr)=>Tr===Ir.length-1?`e das **${Kr.inicio}** s **${Kr.fim}**`:Tr===0?`das **${Kr.inicio}** s **${Kr.fim}**`:`das **${Kr.inicio}** s **${Kr.fim}**`).join(", ")}! `,l(Ar,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else l("Ops! No encontrei **horrios disponveis**. ");break;case"edit_participantes":d(" Editar Participantes"),D(!1),z("participantes"),l("Edite a lista de participantes:",600),setTimeout(()=>{D(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},800);break;case"finalizar":d(" Finalizar Atendimento");const hr=["Pronto! Seu agendamento est confirmado! ","Perfeito! Agendamento realizado com sucesso! ","Tudo certo! Seu horrio est garantido! ","Sucesso! Agendamento confirmado! "],Mr=hr[Math.floor(Math.random()*hr.length)];l(Mr,800),setTimeout(()=>{Pe()},1400);break;case"cancelar_agendamento":d(" Cancelar Agendamento");const qr=[{label:"Sim, cancelar",value:"confirmar_cancelamento",icon:""},{label:"No, voltar",value:"voltar_cancelamento",icon:""}],Or=["Tem certeza que deseja cancelar este agendamento?","Confirma o cancelamento do agendamento?","Realmente quer cancelar? Esta ao no pode ser desfeita.","Deseja mesmo cancelar este agendamento?"],Mt=Or[Math.floor(Math.random()*Or.length)];c(Mt,qr,600);break;case"confirmar_cancelamento":await $e();break;case"voltar_cancelamento":d(" Voltar"),l("Ok! Voltando ao resumo do agendamento.",400),setTimeout(()=>{ct(null,null,!0,null,null,null,q)},800);break;case"editar_agendamento":d(" Editar Agendamento"),l("Claro! O que voc gostaria de alterar?",600),setTimeout(()=>{ct(null,null,!0)},800);break;case"novo_agendamento":d(" Fazer Agendamento"),Ue();break;case"buscar_agendamento":d(" Editar Agendamento"),l("Vou buscar seus agendamentos...",600),ye();break;case"finalizar_atendimento":d(" Finalizar Atendimento"),Pe();break;default:console.warn("[Isis] Ao no reconhecida:",Ie.value)}},ye=async()=>{try{console.log("[buscarAgendamentosCliente] Iniciando busca de agendamentos...");const{data:Ie,error:ke}=await pe.from("agendamentos").select(`
          id,
          codigo,
          inicio,
          fim,
          modalidade,
          status,
          valor_total,
          quadras!inner(nome, descricao, valor)
        `).eq("codigo_empresa",n).eq("cliente_id",s.cliente.id).in("status",["scheduled","confirmed"]).gte("inicio",new Date().toISOString()).order("inicio",{ascending:!0});if(ke)throw ke;if(!Ie||Ie.length===0){l("No encontrei agendamentos futuros para voc. ",800),l("Que tal fazer um novo agendamento? ",1400),setTimeout(()=>{Ue()},2e3);return}if(Ie.length===1){const Je=Ie[0],mt=Xt(new Date(Je.inicio),"dd/MM/yyyy",{locale:aa}),Be=Xt(new Date(Je.inicio),"HH:mm"),$t=Xt(new Date(Je.fim),"HH:mm");l(`Encontrei seu agendamento para ${mt} das ${Be} s ${$t} - ${Je.modalidade}! `,800),setTimeout(()=>{te(Je)},1200)}else{l(`Encontrei ${Ie.length} agendamentos futuros! Qual voc quer editar?`,800);const Je=Ie.map(mt=>{const Be=new Date(mt.inicio),$t=Xt(Be,"dd/MM/yyyy",{locale:aa}),Ee=Xt(Be,"EEEE",{locale:aa}),Ct=Xt(Be,"HH:mm"),hr=Xt(new Date(mt.fim),"HH:mm"),Mr=(new Date(mt.fim)-Be)/(1e3*60),qr=Math.floor(Mr/60),Or=Mr%60;let Mt="";qr>0?Mt=Or>0?`${qr}h${Or}m`:`${qr}h`:Mt=`${Or}m`;const Ir=mt.quadras.valor||0,Ar=Mr/30,Kr=(Math.round(Ir*Ar*100)/100).toFixed(2).replace(".",","),Tr=new Date,dn=new Date(Tr);dn.setDate(Tr.getDate()+1);let Ae="";return Be.toDateString()===Tr.toDateString()?Ae="Hoje":Be.toDateString()===dn.toDateString()?Ae="Amanh":Ae=`${Ee.charAt(0).toUpperCase()+Ee.slice(1)}, ${$t}`,{label:`${Ae}  ${Ct}-${hr}`,value:`editar_agendamento_${mt.id}`,icon:"",subtitle:`${mt.quadras.nome}  ${mt.modalidade}  ${Mt}  R$ ${Kr}`,agendamento:mt}});setTimeout(()=>{c("Escolha o agendamento:",Je,600)},1200)}}catch(Ie){console.error("[Isis] Erro ao buscar agendamentos:",Ie),l("Ops! Tive um problema ao buscar seus agendamentos. ",800),l("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{Ue()},2e3)}},te=async Ie=>{try{console.log("[carregarAgendamentoParaEdicao] Iniciando carregamento do agendamento:",Ie.id),console.debug("[carregarAgendamentoParaEdicao] Iniciando JOIN: agendamentos  quadras, agendamento_participantes");const{data:ke,error:Je}=await pe.from("agendamentos").select(`
          *,
          quadras(id, nome, descricao, modalidades, valor),
          agendamento_participantes(nome, cliente_id)
        `).eq("id",Ie.id).single();if(console.debug("[carregarAgendamentoParaEdicao] Resultado JOIN:",{hasError:!!Je,error:Je?.message,code:Je?.code,participantes_len:Array.isArray(ke?.agendamento_participantes)?ke.agendamento_participantes.length:null}),Je)throw console.error("[Isis] Erro ao buscar agendamento:",Je),new Error(`Agendamento no encontrado ou inacessvel: ${Je.message}`);if(!ke)throw new Error("Agendamento no encontrado");const mt=new Date(ke.inicio),Be=Xt(mt,"HH:mm"),$t=Xt(new Date(ke.fim),"HH:mm");let Ee=ke.quadras||null;if(!Ee)try{const{data:Mt}=await pe.from("quadras").select("id, nome, descricao, modalidades, valor").eq("id",ke.quadra_id).single();Ee=Mt||null}catch{}h("quadra",Ee),h("data",mt),h("horario",{inicio:Be,fim:$t,inicioDate:new Date(ke.inicio),fimDate:new Date(ke.fim)}),h("esporte",ke.modalidade);const Ct=ke.cliente_id||s.cliente?.id||null;let hr=ke.agendamento_participantes||[];if(!hr||hr.length===0)try{console.debug("[carregarAgendamentoParaEdicao] JOIN sem participantes. Fazendo SELECT direto em agendamento_participantes...");const{data:Mt,error:Ir}=await pe.from("agendamento_participantes").select("nome, cliente_id, codigo_empresa").eq("agendamento_id",Ie.id);console.debug("[carregarAgendamentoParaEdicao] SELECT direto participantes:",{hasError:!!Ir,error:Ir?.message,code:Ir?.code,count:Array.isArray(Mt)?Mt.length:null}),Array.isArray(Mt)&&Mt.length>0&&(hr=Mt.map(Ar=>({nome:Ar.nome,cliente_id:Ar.cliente_id})))}catch(Mt){console.debug("[carregarAgendamentoParaEdicao] Falha no SELECT direto participantes:",Mt?.message||Mt)}let Mr=null;const qr=[];hr.forEach(Mt=>{const Ir=Ct&&Mt.cliente_id===Ct,Ar={nome:Mt.nome,cliente_id:Mt.cliente_id,principal:Ir};Ir&&!Mr?Mr=Ar:qr.push(Ar)});const Or=Mr?[Mr,...qr.map(Mt=>({...Mt,principal:!1}))]:hr.map((Mt,Ir)=>({nome:Mt.nome,cliente_id:Mt.cliente_id,principal:Ir===0}));h("participantes",Or),$(ke),l("Perfeito! Aqui esto os detalhes do seu agendamento:",600),setTimeout(()=>{const Mt={inicio:Be,fim:$t,inicioDate:new Date(ke.inicio),fimDate:new Date(ke.fim)};Ee?(ct(Mt,ke.modalidade,!0,Ee,mt,Or,ke),g("review")):(l("No consegui carregar os dados da quadra deste agendamento. Vamos escolher a quadra novamente?",800),setTimeout(()=>{const Ir=_.map(Ar=>({label:Ar.nome,value:Ar.id,icon:"",subtitle:Ar.descricao||Ar.tipo||null,quadra:Ar}));c("Qual quadra voc quer?",Ir,600)},1200))},1400)}catch(ke){console.error("[Isis] Erro ao carregar agendamento:",ke),ke.message.includes("no encontrado")?(l("Ops! Este agendamento no foi encontrado ou pode ter sido cancelado. ",800),l("Vou buscar seus agendamentos atualizados...",1400),setTimeout(()=>{ye()},2e3)):(l("Ops! Tive um problema ao carregar o agendamento. ",800),l("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{Ue()},2e3))}},$e=async()=>{if(!q){console.error("[Isis] Nenhum agendamento para cancelar");return}try{x(!0);const{error:Ie}=await pe.from("agendamentos").update({status:"canceled"}).eq("id",q.id);if(Ie)throw Ie;x(!1);const ke=[" Agendamento cancelado com sucesso!"," Pronto! Seu agendamento foi cancelado."," Cancelamento realizado! Agendamento removido."," Feito! O agendamento foi cancelado com sucesso."],Je=ke[Math.floor(Math.random()*ke.length)];l(Je,600),$(null),setTimeout(()=>{l("O que voc gostaria de fazer agora?",800),setTimeout(()=>{be()},1200)},1200)}catch(Ie){console.error("[Isis] Erro ao cancelar agendamento:",Ie),x(!1);const ke=ev("error");l(ke)}},Pe=()=>{u();const Ie=["Antes de finalizar, que tal me dar uma avaliao? ","Para finalizar, gostaria que avaliasse nosso atendimento! ","Quase pronto! Me ajuda com uma avaliao rpida? ","ltima etapa! Como foi nosso atendimento hoje? ","Para encerrar, que nota voc daria para nosso atendimento? ","Ei, que tal me contar como foi a experincia? ","Curiosa para saber: como voc avalia nosso atendimento? ","Rapidinho aqui: o que achou do nosso servio? ","Me conta a, como foi para voc hoje? ","Sua opinio  super importante! Como foi tudo? ","Sua avaliao nos ajuda a melhorar! Como foi? ","Para continuarmos evoluindo, como voc nos avalia? ","Queremos sempre melhorar! Que nota voc daria? ","Seu feedback  ouro para ns! Como foi o atendimento? ","Ajude-nos a ser ainda melhores! Qual sua avaliao? ","Espero ter te ajudado bem! Como voc me avalia? ","Fiz um bom trabalho hoje? Me conta sua opinio! ","Consegui resolver tudo certinho? Que tal uma avaliao? ","Antes de voc ir, me diz como foi nossa conversa? ","Sua experincia foi boa? Adoraria saber! ","Obrigada pela confiana! Como foi para voc? ","Foi um prazer te atender! Que nota voc daria? ","Agradeo pela pacincia! Como avalia nosso servio? ","Muito obrigada! Me conta como foi tudo? ","Pode ser sincero(a)! Como foi o atendimento? ","Sem papas na lngua: que nota voc daria? ","Honestamente, como voc nos avalia? ","Sua opinio real  importante! Como foi? ","Para finalizar o atendimento, preciso da sua avaliao! ","Processo quase concludo! Falta s sua avaliao! ","ltima etapa do nosso protocolo: sua opinio! ","Para encerrar com chave de ouro: como nos avalia? "],ke=Ie[Math.floor(Math.random()*Ie.length)];l(ke,800),setTimeout(()=>{D(!0),g("avaliacao"),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1200)},It=async Ie=>{try{const ke=`${Ie.rating} estrela${Ie.rating>1?"s":""}`,Je=Ie.comentario?` ${ke}
 "${Ie.comentario}"`:` ${ke}`;d(Je),D(!1),x(!0);const mt={rating:Ie.rating,comentario:Ie.comentario,cliente_nome:s.cliente?.nome,empresa_nome:w?.nome_fantasia||w?.razao_social||"Arena"};await Bit(mt),x(!1);const Be=w?.nome_fantasia||w?.razao_social||"a empresa",$t=new Date().getHours();let Ee;$t>=5&&$t<12?Ee="Tenha um timo dia! ":$t>=12&&$t<18?Ee="Tenha uma tima tarde! ":$t>=18&&$t<22?Ee="Tenha uma tima noite! ":Ee="Tenha uma boa noite! ";let Ct;if(Ie.rating>=4){const hr=[` **Muito obrigada pela avaliao!** A **${Be}** agradece imensamente! Foi um prazer te atender! ${Ee}`,` **Que bom que gostou!** A **${Be}** fica muito feliz! Volte sempre! ${Ee}`,` **Perfeito!** A **${Be}** agradece de corao! Espero ter ajudado! ${Ee}`,` **Adorei seu feedback!** A **${Be}** est muito grata! Nos vemos em breve! ${Ee}`,` **Excelente!** A **${Be}** agradece pela confiana! At a prxima! ${Ee}`,` **Uau, que nota incrvel!** A **${Be}** est nas nuvens! Obrigada! ${Ee}`,` **Voc  demais!** A **${Be}** adora clientes como voc! ${Ee}`,` **Top demais!** A **${Be}** se sente campe com seu feedback! ${Ee}`,` **Que alegria!** A **${Be}** fica radiante com sua avaliao! ${Ee}`,` **Sensacional!** A **${Be}** est celebrando sua nota! ${Ee}`,` **Amei sua avaliao!** Fico feliz em saber que te atendi bem! A **${Be}** agradece! ${Ee}`,` **Que feedback maravilhoso!** Me deixou super feliz! A **${Be}**  grata! ${Ee}`,` **Seu carinho me emociona!** A **${Be}** tem sorte de ter voc! ${Ee}`,` **Voc iluminou meu dia!** A **${Be}** agradece de todo corao! ${Ee}`,` **Nota mxima!** A **${Be}** te espera sempre de braos abertos! ${Ee}`,` **Cliente 5 estrelas!** A **${Be}** adora te ter aqui! Volte logo! ${Ee}`,` **Voc  especial!** A **${Be}** sempre ter um lugar especial para voc! ${Ee}`,` **Show de avaliao!** A **${Be}** te aguarda para a prxima apresentao! ${Ee}`];Ct=hr[Math.floor(Math.random()*hr.length)]}else if(Ie.rating===3){const hr=[` **Obrigada pelo feedback!** A **${Be}** vai melhorar ainda mais! ${Ee}`,` **Agradecemos sua avaliao!** A **${Be}** est trabalhando para evoluir! ${Ee}`,` **Obrigada!** A **${Be}** valoriza seu retorno! Foi um prazer te atender! ${Ee}`,` **Toda avaliao nos faz crescer!** A **${Be}** agradece sua sinceridade! ${Ee}`,` **Feedback valioso!** A **${Be}** usa cada retorno para evoluir! ${Ee}`,` **Obrigada pela nota!** A **${Be}** est sempre buscando melhorar! ${Ee}`,` **Seu retorno  importante!** A **${Be}** vai usar para aprimorar nosso servio! ${Ee}`,` **Agradecemos a oportunidade!** A **${Be}** espera te surpreender na prxima! ${Ee}`,` **Obrigada pela dica!** A **${Be}** vai trabalhar para te conquistar! ${Ee}`,` **Toda crtica construtiva  bem-vinda!** A **${Be}** agradece! ${Ee}`];Ct=hr[Math.floor(Math.random()*hr.length)]}else{const hr=[` **Obrigada pela sinceridade.** A **${Be}** vai trabalhar para melhorar! ${Ee}`,` **Agradecemos seu feedback.** A **${Be}** est comprometida em evoluir! ${Ee}`,` **Obrigada por compartilhar.** A **${Be}** vai usar seu retorno para melhorar! ${Ee}`,` **Lamentamos no ter atendido suas expectativas.** A **${Be}** vai se esforar mais! ${Ee}`,` **Sentimos muito pela experincia.** A **${Be}** levar isso muito a srio! ${Ee}`,` **Assumimos a responsabilidade.** A **${Be}** vai fazer melhor da prxima vez! ${Ee}`,` **Sua insatisfao nos preocupa.** A **${Be}** vai revisar todos os processos! ${Ee}`,` **Obrigada pelo alerta!** A **${Be}** espera uma nova chance de te impressionar! ${Ee}`,` **Vamos melhorar!** A **${Be}** promete que da prxima vez ser diferente! ${Ee}`,` **Seu feedback  nosso combustvel!** A **${Be}** vai usar para crescer! ${Ee}`,` **J estamos trabalhando nas melhorias!** A **${Be}** agradece sua pacincia! ${Ee}`,` **Sua honestidade  valiosa!** A **${Be}** prefere a verdade para evoluir! ${Ee}`,` **Crticas nos fazem crescer!** A **${Be}** agradece sua coragem de falar! ${Ee}`];Ct=hr[Math.floor(Math.random()*hr.length)]}l(Ct,600)}catch(ke){console.error("[Isis] Erro ao enviar avaliao:",ke),x(!1);const Je=w?.nome_fantasia||w?.razao_social||"a empresa",mt=new Date().getHours();let Be;mt>=5&&mt<12?Be="Tenha um timo dia! ":mt>=12&&mt<18?Be="Tenha uma tima tarde! ":mt>=18&&mt<22?Be="Tenha uma tima noite! ":Be="Tenha uma boa noite! ";const $t=[`Ops! Tive um problema ao salvar sua avaliao, mas a **${Je}** agradece muito seu feedback! ${Be}`,` No consegui salvar sua avaliao, mas a **${Je}** agradece imensamente! ${Be}`,` Deu uma travadinha aqui, mas sua opinio j ficou guardada no meu corao! A **${Je}** agradece! ${Be}`,` Ops, falhei na tecnologia, mas no falhei em te ouvir! A **${Je}** valoriza seu feedback! ${Be}`,` Parece que o sistema deu soluo, mas sua avaliao foi ouvida! A **${Je}** agradece! ${Be}`,` A internet no colaborou, mas sua opinio chegou at mim! A **${Je}**  grata! ${Be}`,` Problema tcnico aqui, mas o importante  que voc compartilhou! A **${Je}** agradece! ${Be}`,` O sistema travou, mas sua avaliao no passou despercebida! A **${Je}** valoriza! ${Be}`],Ee=$t[Math.floor(Math.random()*$t.length)];l(Ee,600)}},Dt=async()=>{if(!q){console.error("[Isis] Nenhum agendamento para atualizar");return}try{x(!0);const Ie=s.cliente,ke=s.participantes||[],{data:Je}=await pe.from("clientes").select("id").eq("codigo_empresa",n).eq("is_consumidor_final",!0).single(),mt=ke.find(pt=>pt.principal),Be=ke.filter(pt=>!pt.principal),$t=mt?[mt,...Be]:ke,Ee=$t.map(pt=>pt.nome),[Ct,hr]=s.horario.inicio.split(":").map(Number),[Mr,qr]=s.horario.fim.split(":").map(Number);let Or=Mr*60+qr-(Ct*60+hr);Mr===0&&qr===0&&(Or=24*60-(Ct*60+hr));const Mt=s.quadra.valor||0,Ir=Or/30,Ar=Math.round(Mt*Ir*100)/100,{data:Zt,error:Kr}=await pe.from("agendamentos").update({quadra_id:s.quadra.id,clientes:Ee,inicio:s.horario.inicioDate.toISOString(),fim:s.horario.fimDate.toISOString(),modalidade:s.esporte,valor_total:Ar}).eq("id",q.id).select().single();if(Kr)throw Kr;const{error:Tr}=await pe.from("agendamento_participantes").delete().eq("agendamento_id",q.id);if(Tr)throw Tr;const dn=$t.map((pt,Br)=>({agendamento_id:Zt.id,codigo_empresa:n,cliente_id:pt.cliente_id||Je?.id,nome:pt.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Br+1})),{error:Ae}=await pe.from("agendamento_participantes").insert(dn);if(Ae)throw Ae;x(!1),$(Zt),Qt(Zt,!0),g("confirmation")}catch(Ie){console.error("[Isis] Erro ao atualizar agendamento:",Ie),x(!1);const ke=ev("error");l(ke)}},kt=async()=>{try{x(!0);const Ie=s.cliente,ke=s.participantes||[],{data:Je}=await pe.from("clientes").select("id").eq("codigo_empresa",n).eq("is_consumidor_final",!0).single(),mt=ke.find(Pr=>Pr.principal),Be=ke.filter(Pr=>!Pr.principal),$t=mt?[mt,...Be]:ke,Ee=$t.map(Pr=>Pr.nome),[Ct,hr]=s.horario.inicio.split(":").map(Number),[Mr,qr]=s.horario.fim.split(":").map(Number);let Or=Mr*60+qr-(Ct*60+hr);Mr===0&&qr===0&&(Or=24*60-(Ct*60+hr));const Mt=s.quadra.valor||0,Ir=Or/30,Ar=Math.round(Mt*Ir*100)/100,{data:Zt}=await pe.from("agendamentos").select("codigo").eq("codigo_empresa",n).order("codigo",{ascending:!1}).limit(1).single();let Kr=Zt?Zt.codigo+1:1;console.log("[criarAgendamento] ltimo cdigo usado:",Zt?.codigo),console.log("[criarAgendamento] Prximo cdigo inicial:",Kr);let Tr,dn=0;const Ae=10;for(;!Tr&&dn<Ae;){dn++,console.log("[criarAgendamento] Tentativa",dn,"com cdigo:",Kr);const{data:Pr,error:Ur}=await pe.from("agendamentos").insert({codigo:Kr,codigo_empresa:n,quadra_id:s.quadra.id,cliente_id:Ie.id,clientes:Ee,inicio:s.horario.inicioDate.toISOString(),fim:s.horario.fimDate.toISOString(),modalidade:s.esporte,status:"scheduled",valor_total:Ar}).select("id, codigo").single();if(Ur)if(Ur.code==="23505")console.log("[criarAgendamento] Cdigo",Kr,"j existe, tentando prximo..."),Kr++;else throw Ur;else Tr=Pr,console.log("[criarAgendamento] Agendamento criado com cdigo:",Tr.codigo)}if(!Tr)throw new Error("No foi possvel gerar um cdigo nico aps "+Ae+" tentativas");try{const{data:Pr}=await pe.from("empresas").select("id").eq("codigo_empresa",n).single();Pr&&(await pe.from("empresa_counters").update({next_agendamento_codigo:Tr.codigo+1}).eq("empresa_id",Pr.id),console.log("[criarAgendamento] Counter atualizado para:",Tr.codigo+1))}catch(Pr){console.warn("[criarAgendamento] Erro ao atualizar counter:",Pr)}const pt=$t.map((Pr,Ur)=>({codigo_empresa:n,agendamento_id:Tr.id,cliente_id:Pr.principal?Ie.id:Je?.id||null,nome:Pr.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Ur+1})),{error:Br}=await pe.from("agendamento_participantes").insert(pt);if(Br)throw Br;x(!1),$(Tr),Qt(Tr),g("confirmation")}catch(Ie){console.error("[Isis] Erro ao criar agendamento:",Ie),x(!1);const ke=ev("error");l(ke),jj({title:"Erro ao criar agendamento",description:Ie.message||"Tente novamente",variant:"destructive"})}},cr=(Ie,ke)=>{if(u(),ke)try{m(ke)}catch{}switch(i){case"quadra":lt(Ie);break;case"data":gt(Ie);break;case"identificacao":we(Ie);break;case"review":we(Ie);break;case"confirmation":we(Ie);break;default:console.warn("[Isis] Nenhum handler para step:",i)}},Cr=()=>(console.log("[renderInput] currentStep:",i,"showInput:",I),I?i==="participantes"||i==="review"&&I&&F==="participantes"?(console.log("[renderInput] Renderizando IsisParticipantesInput"),o.jsx(Iit,{participantesAtuais:s.participantes||[],onAdicionar:vt,onRemover:se,onFinalizar:Ze,onAdicionarLote:Sr,selfName:s.cliente?.nome})):i==="identificacao"||C==="data_custom"?o.jsx(Oit,{tipo:C,onSubmit:G,onTrocarTipo:()=>{T(C==="telefone"?"email":"telefone")}}):i==="cadastro"?o.jsx(Tit,{onSubmit:Q,valorInicial:s.identificacao_valor,tipoInicial:s.identificacao_tipo||"telefone"}):i==="horario"||i==="review"&&I&&F==="horario"?(console.log("[renderInput] Renderizando IsisHorarioInput"),console.log("[renderInput] horariosDisponiveis:",k?.length||0),console.log("[renderInput] esportes:",s.quadra?.modalidades),o.jsx(kit,{onSubmit:yt,onMudarData:je,horariosDisponiveis:k,esportes:s.quadra?.modalidades||[]})):i==="avaliacao"?(console.log("[renderInput] Renderizando IsisAvaliacaoInput"),o.jsx(Dit,{onSubmit:It})):null:(console.log("[renderInput] showInput=false, retornando null"),null));return r?A?o.jsx(Mit,{message:"Preparando sua experincia..."}):w?o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(fr.header,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"bg-surface/70 backdrop-blur-xl border-b border-white/10 sticky top-0 z-20 shadow-lg",children:o.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-3 md:py-4 flex items-center justify-between gap-3 md:gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"transition-all duration-300 group-hover:scale-105",children:o.jsx(ud,{size:"md",variant:"header",className:"md:w-20 md:h-20"})}),o.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 md:w-4 md:h-4 bg-success rounded-full border-2 border-surface"})]}),o.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[o.jsx("h1",{className:"font-bold text-text-primary text-lg md:text-2xl tracking-tight leading-none",children:"sis"}),o.jsxs("div",{className:"relative group w-fit",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 blur-md opacity-60 group-hover:opacity-100 animate-pulse rounded-md"}),o.jsxs("div",{className:"relative px-2 py-0.5 md:px-2.5 md:py-1 bg-gradient-to-r from-cyan-500/20 via-purple-500/20 to-pink-500/20 backdrop-blur-sm border border-cyan-500/50 rounded-md flex items-center gap-1 md:gap-1.5 shadow-lg",children:[o.jsxs("svg",{className:"w-2.5 h-2.5 md:w-3 md:h-3 text-cyan-400",fill:"currentColor",viewBox:"0 0 20 20",children:[o.jsx("path",{d:"M13 7H7v6h6V7z"}),o.jsx("path",{fillRule:"evenodd",d:"M7 2a1 1 0 012 0v1h2V2a1 1 0 112 0v1h2a2 2 0 012 2v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v2a2 2 0 01-2 2h-2v1a1 1 0 11-2 0v-1H9v1a1 1 0 11-2 0v-1H5a2 2 0 01-2-2v-2H2a1 1 0 110-2h1V9H2a1 1 0 010-2h1V5a2 2 0 012-2h2V2zM5 5h10v10H5V5z",clipRule:"evenodd"})]}),o.jsx("span",{className:"text-[9px] md:text-[10px] font-bold bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"AI"}),o.jsxs("div",{className:"hidden md:flex gap-0.5",children:[o.jsx("span",{className:"w-1 h-1 bg-cyan-400 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),o.jsx("span",{className:"w-1 h-1 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),o.jsx("span",{className:"w-1 h-1 bg-pink-400 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]})]})]})]})]}),o.jsx("div",{className:"flex flex-1 justify-end md:justify-center",children:o.jsxs("div",{className:"group relative",children:[o.jsx("div",{className:"hidden md:block absolute inset-0 bg-gradient-to-r from-brand/20 via-brand/10 to-brand/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),o.jsxs("div",{className:"relative flex items-center gap-2.5 md:gap-3 px-4 py-2 md:px-5 md:py-2.5 bg-gradient-to-r from-surface via-surface-2 to-surface backdrop-blur-sm rounded-lg md:rounded-xl border border-brand/20 shadow-md md:shadow-lg",children:[o.jsxs("div",{className:"relative w-9 h-9 md:w-10 md:h-10 shrink-0 overflow-hidden rounded-lg border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)] group-hover:border-white/20 transition-colors duration-300",children:[fe?o.jsx("img",{src:fe,alt:"Logo da empresa",className:"w-full h-full object-cover",onError:Ie=>{Ie.target.style.display="none",Ie.target.nextSibling.style.display="block"}}):null,o.jsx(fN,{className:`w-5 h-5 md:w-6 md:h-6 opacity-80 ${fe?"hidden":"block"}`,strokeWidth:2})]}),o.jsx("h2",{className:"text-sm md:text-base font-bold text-text-primary tracking-wide truncate max-w-[140px] md:max-w-none",children:w.nome_fantasia||w.razao_social})]})]})}),o.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[o.jsx("div",{className:"w-12 h-12 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:o.jsx(nd,{className:"w-7 h-7 text-primary-foreground"})}),o.jsxs("div",{className:"hidden lg:flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})]})}),o.jsx("div",{className:"container mx-auto max-w-5xl pb-6 md:pb-6 mb-12 md:mb-0",children:o.jsx(Eit,{onButtonClick:cr,hideButtonTexts:i==="avaliacao",children:Cr()})}),o.jsx(fr.footer,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.3},className:"md:hidden fixed bottom-0 left-0 right-0 bg-surface/90 backdrop-blur-xl border-t border-white/10 z-20 shadow-lg",children:o.jsx("div",{className:"flex items-center justify-center py-2",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-6 h-6 bg-brand rounded-lg flex items-center justify-center",children:o.jsx(nd,{className:"w-4 h-4 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-sm",style:{color:"#B0B0B0"},children:" Arena"})]})]})})})]}):o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[o.jsx(fr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:o.jsxs("div",{className:"relative",children:[o.jsx(ud,{size:"xl",variant:"header"}),o.jsx(fr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[o.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[B(),"! Tentando Agendar? "]}),o.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:[o.jsx("p",{className:"text-xl text-text-primary mb-6 leading-relaxed",children:"Entre em contato com o dono da quadra e solicite o **link de agendamento**."}),o.jsxs("div",{className:"bg-surface-2/50 border border-white/5 rounded-xl p-6 mb-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-3 flex items-center gap-2",children:[o.jsx(fH,{className:"w-5 h-5 text-brand"}),"Formato do Link"]}),o.jsxs("div",{className:"bg-background/60 border border-white/10 rounded-lg p-4 font-mono text-sm",children:[o.jsx("span",{className:"text-text-muted",children:"fluxo7arena.com/agendar/"}),o.jsx("span",{className:"text-brand font-bold",children:"nome-da-empresa"})]})]})]})]}),o.jsx(fr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:o.jsx(nd,{className:"w-6 h-6 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})}):o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[o.jsx(fr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:o.jsxs("div",{className:"relative",children:[o.jsx(ud,{size:"xl",variant:"header"}),o.jsx(fr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[o.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[B(),"! Tentando Agendar?"]}),o.jsx("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:o.jsx("p",{className:"text-xl text-text-primary mb-4 leading-relaxed",children:"Entre em contato com o dono da quadra e solicite o link de agendamento."})})]}),o.jsx(fr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:o.jsx(nd,{className:"w-6 h-6 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})})};function SU(){return o.jsx(Cit,{children:o.jsx(qit,{})})}const Soe=!1,zit="",Uit="Estamos em manuteno no momento. Voltaremos em breve.",CU="f740028922";function PU(e){try{return Xt(e,"EEE, d 'de' MMM 's' HH:mm",{locale:aa})}catch{return""}}function AU(){const e=ki(),t=Fl(),r=!!Soe||typeof window<"u"&&localStorage.getItem("maintenance:active")==="true",[n,a]=p.useState(""),[i,s]=p.useState("");p.useEffect(()=>{try{a(localStorage.getItem("maintenance:end")||""),s(localStorage.getItem("maintenance:message")||"");const f=m=>{m.key==="maintenance:end"&&a(m.newValue||""),m.key==="maintenance:message"&&s(m.newValue||"")};return window.addEventListener("storage",f),()=>window.removeEventListener("storage",f)}catch{}},[]);const l=n||zit||{}.VITE_MAINTENANCE_END||"",c=i&&i.trim()?i:Uit,d=p.useMemo(()=>{if(!l)return null;const f=new Date(l);return isNaN(f.getTime())?null:f},[l]),u=p.useMemo(()=>c?.trim()?c:d?`Estamos em manuteno e voltaremos at ${PU(d)}.`:"Estamos em manuteno no momento. Voltaremos em breve.",[c,d]);return p.useEffect(()=>{try{window.f7MaintenanceBypass=f=>{const m=String(f||"")===CU;if(m){try{localStorage.setItem("maintenance:bypass","1")}catch{}try{sessionStorage.setItem("maintenance:bypass","1")}catch{}try{document.cookie="fx_maint_bypass=1; path=/; max-age=2592000"}catch{}try{sessionStorage.removeItem("auth:returnUrl")}catch{}t("/login",{replace:!0})}else console.warn("[Maintenance] Senha invlida.");return m},window.f7MaintenanceReset=()=>{try{localStorage.removeItem("maintenance:bypass")}catch{}console.info("[Maintenance] Bypass removido.")}}catch{}},[t]),p.useEffect(()=>{const m=String(e.pathname||"").split("/").filter(Boolean),h=m[m.length-1]||"",v=new URLSearchParams(e.search||""),x=v.get("senha")||v.get("pwd")||v.get("code")||""||h;if(x&&x===CU){try{localStorage.setItem("maintenance:bypass","1")}catch{}try{sessionStorage.setItem("maintenance:bypass","1")}catch{}try{document.cookie="fx_maint_bypass=1; path=/; max-age=2592000"}catch{}try{sessionStorage.removeItem("auth:returnUrl")}catch{}t("/login",{replace:!0})}},[e,t]),o.jsxs("div",{className:"min-h-screen relative overflow-hidden bg-gradient-to-b from-[#0f1324] via-[#0b0f1c] to-[#070a14] text-white",children:[o.jsx("div",{className:"pointer-events-none absolute -top-40 left-1/2 -translate-x-1/2 w-[90rem] h-[90rem] rounded-full opacity-30 blur-3xl",style:{background:"radial-gradient(50% 50% at 50% 50%, rgba(76,110,245,0.45) 0%, rgba(76,110,245,0.18) 40%, rgba(0,0,0,0) 70%)"}}),o.jsxs("div",{className:"relative z-10 mx-auto max-w-4xl px-6 py-16 md:py-24",children:[o.jsxs("div",{className:"mx-auto max-w-3xl rounded-3xl border border-white/10 bg-white/[0.02] backdrop-blur-xl shadow-[0_0_60px_-10px_rgba(76,110,245,0.5)] p-6 md:p-10",children:[o.jsx("div",{className:"text-center mb-8",children:o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx("div",{className:"w-16 h-16 bg-brand rounded-xl flex items-center justify-center mr-4",children:o.jsx(nd,{className:"w-8 h-8 text-primary-foreground"})}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-5xl font-extrabold",children:[o.jsx("span",{style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{style:{color:"#FFAA33"},children:"7"})]}),o.jsx("p",{className:"text-2xl font-semibold",style:{color:"#B0B0B0"},children:"Arena"})]})]})}),o.jsxs("div",{className:"flex items-center justify-center gap-3 text-red-400 mb-4",children:[o.jsx(BT,{className:"w-6 h-6"}),o.jsx("span",{className:"font-semibold tracking-wide",children:"Modo de Manuteno"})]}),o.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-8",children:[o.jsx("div",{className:"shrink-0",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute -inset-4 bg-brand/20 blur-2xl rounded-full"}),o.jsx("div",{className:"relative rounded-2xl p-1 bg-gradient-to-b from-brand/40 to-transparent",children:o.jsx(ud,{size:"xl",variant:"header"})})]})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h1",{className:"text-2xl md:text-3xl font-bold leading-tight",children:"Oi! Eu sou a Isis "}),o.jsx("p",{className:"text-white/80 mt-3 text-base md:text-lg leading-relaxed",children:u}),o.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-white/80",children:[d&&o.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/[0.03] px-3 py-2",children:[o.jsx(dd,{className:"w-4 h-4 text-brand"}),o.jsxs("span",{children:["Previso de retorno: ",o.jsx("strong",{className:"text-white/90",children:PU(d)})]})]}),o.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/[0.03] px-3 py-2",children:[o.jsx(gi,{className:"w-4 h-4 text-brand"}),o.jsx("span",{children:"Vamos cuidar de tudo para voc jogar melhor "})]})]})]})]})]}),o.jsx("p",{className:"mt-6 text-center text-white/50 text-sm",children:r?"Modo de manuteno ativo":"Modo de manuteno inativo"})]})]})}function Vit(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var Coe=p,Wit=Vit(Coe);function EU(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hit(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Git=!!(typeof window<"u"&&window.document&&window.document.createElement);function Kit(e,t,r){if(typeof e!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof t!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof r<"u"&&typeof r!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function n(a){return a.displayName||a.name||"Component"}return function(i){if(typeof i!="function")throw new Error("Expected WrappedComponent to be a React component.");var s=[],l;function c(){l=e(s.map(function(u){return u.props})),d.canUseDOM?t(l):r&&(l=r(l))}var d=function(u){Hit(f,u);function f(){return u.apply(this,arguments)||this}f.peek=function(){return l},f.rewind=function(){if(f.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var v=l;return l=void 0,s=[],v};var m=f.prototype;return m.UNSAFE_componentWillMount=function(){s.push(this),c()},m.componentDidUpdate=function(){c()},m.componentWillUnmount=function(){var v=s.indexOf(this);s.splice(v,1),c()},m.render=function(){return Wit.createElement(i,this.props)},f}(Coe.PureComponent);return EU(d,"displayName","SideEffect("+n(i)+")"),EU(d,"canUseDOM",Git),d}}var Yit=Kit;const Xit=Ba(Yit);var Jit=typeof Element<"u",Qit=typeof Map=="function",Zit=typeof Set=="function",est=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function Rj(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n,a;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!Rj(e[n],t[n]))return!1;return!0}var i;if(Qit&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;for(i=e.entries();!(n=i.next()).done;)if(!Rj(n.value[1],t.get(n.value[0])))return!1;return!0}if(Zit&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(est&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[n]))return!1;if(Jit&&e instanceof Element)return!1;for(n=r;n--!==0;)if(!((a[n]==="_owner"||a[n]==="__v"||a[n]==="__o")&&e.$$typeof)&&!Rj(e[a[n]],t[a[n]]))return!1;return!0}return e!==e&&t!==t}var tst=function(t,r){try{return Rj(t,r)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}};const rst=Ba(tst);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var kU=Object.getOwnPropertySymbols,nst=Object.prototype.hasOwnProperty,ast=Object.prototype.propertyIsEnumerable;function ost(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function ist(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(i){return t[i]});if(n.join("")!=="0123456789")return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(i){a[i]=i}),Object.keys(Object.assign({},a)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var sst=ist()?Object.assign:function(e,t){for(var r,n=ost(e),a,i=1;i<arguments.length;i++){r=Object(arguments[i]);for(var s in r)nst.call(r,s)&&(n[s]=r[s]);if(kU){a=kU(r);for(var l=0;l<a.length;l++)ast.call(r,a[l])&&(n[a[l]]=r[a[l]])}}return n};const lst=Ba(sst);var $p={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"},la={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(la).map(function(e){return la[e]});var $o={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src",TARGET:"target"},cS={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},R1={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},cst=Object.keys(cS).reduce(function(e,t){return e[cS[t]]=t,e},{}),dst=[la.NOSCRIPT,la.SCRIPT,la.STYLE],Hd="data-react-helmet",ust=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fst=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},mst=function(){function e(t,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hst=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},OU=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},pst=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},I4=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},gst=function(t){var r=Qv(t,la.TITLE),n=Qv(t,R1.TITLE_TEMPLATE);if(n&&r)return n.replace(/%s/g,function(){return Array.isArray(r)?r.join(""):r});var a=Qv(t,R1.DEFAULT_TITLE);return r||a||void 0},vst=function(t){return Qv(t,R1.ON_CHANGE_CLIENT_STATE)||function(){}},OE=function(t,r){return r.filter(function(n){return typeof n[t]<"u"}).map(function(n){return n[t]}).reduce(function(n,a){return _l({},n,a)},{})},xst=function(t,r){return r.filter(function(n){return typeof n[la.BASE]<"u"}).map(function(n){return n[la.BASE]}).reverse().reduce(function(n,a){if(!n.length)for(var i=Object.keys(a),s=0;s<i.length;s++){var l=i[s],c=l.toLowerCase();if(t.indexOf(c)!==-1&&a[c])return n.concat(a)}return n},[])},ly=function(t,r,n){var a={};return n.filter(function(i){return Array.isArray(i[t])?!0:(typeof i[t]<"u"&&jst("Helmet: "+t+' should be of type "Array". Instead found type "'+ust(i[t])+'"'),!1)}).map(function(i){return i[t]}).reverse().reduce(function(i,s){var l={};s.filter(function(m){for(var h=void 0,v=Object.keys(m),g=0;g<v.length;g++){var x=v[g],y=x.toLowerCase();r.indexOf(y)!==-1&&!(h===$o.REL&&m[h].toLowerCase()==="canonical")&&!(y===$o.REL&&m[y].toLowerCase()==="stylesheet")&&(h=y),r.indexOf(x)!==-1&&(x===$o.INNER_HTML||x===$o.CSS_TEXT||x===$o.ITEM_PROP)&&(h=x)}if(!h||!m[h])return!1;var b=m[h].toLowerCase();return a[h]||(a[h]={}),l[h]||(l[h]={}),a[h][b]?!1:(l[h][b]=!0,!0)}).reverse().forEach(function(m){return i.push(m)});for(var c=Object.keys(l),d=0;d<c.length;d++){var u=c[d],f=lst({},a[u],l[u]);a[u]=f}return i},[]).reverse()},Qv=function(t,r){for(var n=t.length-1;n>=0;n--){var a=t[n];if(a.hasOwnProperty(r))return a[r]}return null},yst=function(t){return{baseTag:xst([$o.HREF,$o.TARGET],t),bodyAttributes:OE($p.BODY,t),defer:Qv(t,R1.DEFER),encode:Qv(t,R1.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:OE($p.HTML,t),linkTags:ly(la.LINK,[$o.REL,$o.HREF],t),metaTags:ly(la.META,[$o.NAME,$o.CHARSET,$o.HTTPEQUIV,$o.PROPERTY,$o.ITEM_PROP],t),noscriptTags:ly(la.NOSCRIPT,[$o.INNER_HTML],t),onChangeClientState:vst(t),scriptTags:ly(la.SCRIPT,[$o.SRC,$o.INNER_HTML],t),styleTags:ly(la.STYLE,[$o.CSS_TEXT],t),title:gst(t),titleAttributes:OE($p.TITLE,t)}},D4=function(){var e=Date.now();return function(t){var r=Date.now();r-e>16?(e=r,t(r)):setTimeout(function(){D4(t)},0)}}(),TU=function(t){return clearTimeout(t)},bst=typeof window<"u"?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||D4:global.requestAnimationFrame||D4,wst=typeof window<"u"?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||TU:global.cancelAnimationFrame||TU,jst=function(t){return console&&typeof console.warn=="function"&&console.warn(t)},cy=null,Nst=function(t){cy&&wst(cy),t.defer?cy=bst(function(){IU(t,function(){cy=null})}):(IU(t),cy=null)},IU=function(t,r){var n=t.baseTag,a=t.bodyAttributes,i=t.htmlAttributes,s=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.onChangeClientState,u=t.scriptTags,f=t.styleTags,m=t.title,h=t.titleAttributes;M4(la.BODY,a),M4(la.HTML,i),_st(m,h);var v={baseTag:tv(la.BASE,n),linkTags:tv(la.LINK,s),metaTags:tv(la.META,l),noscriptTags:tv(la.NOSCRIPT,c),scriptTags:tv(la.SCRIPT,u),styleTags:tv(la.STYLE,f)},g={},x={};Object.keys(v).forEach(function(y){var b=v[y],w=b.newTags,j=b.oldTags;w.length&&(g[y]=w),j.length&&(x[y]=v[y].oldTags)}),r&&r(),d(t,g,x)},Poe=function(t){return Array.isArray(t)?t.join(""):t},_st=function(t,r){typeof t<"u"&&document.title!==t&&(document.title=Poe(t)),M4(la.TITLE,r)},M4=function(t,r){var n=document.getElementsByTagName(t)[0];if(n){for(var a=n.getAttribute(Hd),i=a?a.split(","):[],s=[].concat(i),l=Object.keys(r),c=0;c<l.length;c++){var d=l[c],u=r[d]||"";n.getAttribute(d)!==u&&n.setAttribute(d,u),i.indexOf(d)===-1&&i.push(d);var f=s.indexOf(d);f!==-1&&s.splice(f,1)}for(var m=s.length-1;m>=0;m--)n.removeAttribute(s[m]);i.length===s.length?n.removeAttribute(Hd):n.getAttribute(Hd)!==l.join(",")&&n.setAttribute(Hd,l.join(","))}},tv=function(t,r){var n=document.head||document.querySelector(la.HEAD),a=n.querySelectorAll(t+"["+Hd+"]"),i=Array.prototype.slice.call(a),s=[],l=void 0;return r&&r.length&&r.forEach(function(c){var d=document.createElement(t);for(var u in c)if(c.hasOwnProperty(u))if(u===$o.INNER_HTML)d.innerHTML=c.innerHTML;else if(u===$o.CSS_TEXT)d.styleSheet?d.styleSheet.cssText=c.cssText:d.appendChild(document.createTextNode(c.cssText));else{var f=typeof c[u]>"u"?"":c[u];d.setAttribute(u,f)}d.setAttribute(Hd,"true"),i.some(function(m,h){return l=h,d.isEqualNode(m)})?i.splice(l,1):s.push(d)}),i.forEach(function(c){return c.parentNode.removeChild(c)}),s.forEach(function(c){return n.appendChild(c)}),{oldTags:i,newTags:s}},Aoe=function(t){return Object.keys(t).reduce(function(r,n){var a=typeof t[n]<"u"?n+'="'+t[n]+'"':""+n;return r?r+" "+a:a},"")},Sst=function(t,r,n,a){var i=Aoe(n),s=Poe(r);return i?"<"+t+" "+Hd+'="true" '+i+">"+I4(s,a)+"</"+t+">":"<"+t+" "+Hd+'="true">'+I4(s,a)+"</"+t+">"},Cst=function(t,r,n){return r.reduce(function(a,i){var s=Object.keys(i).filter(function(d){return!(d===$o.INNER_HTML||d===$o.CSS_TEXT)}).reduce(function(d,u){var f=typeof i[u]>"u"?u:u+'="'+I4(i[u],n)+'"';return d?d+" "+f:f},""),l=i.innerHTML||i.cssText||"",c=dst.indexOf(t)===-1;return a+"<"+t+" "+Hd+'="true" '+s+(c?"/>":">"+l+"</"+t+">")},"")},Eoe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,a){return n[cS[a]||a]=t[a],n},r)},Pst=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,a){return n[cst[a]||a]=t[a],n},r)},Ast=function(t,r,n){var a,i=(a={key:r},a[Hd]=!0,a),s=Eoe(n,i);return[xe.createElement(la.TITLE,s,r)]},Est=function(t,r){return r.map(function(n,a){var i,s=(i={key:a},i[Hd]=!0,i);return Object.keys(n).forEach(function(l){var c=cS[l]||l;if(c===$o.INNER_HTML||c===$o.CSS_TEXT){var d=n.innerHTML||n.cssText;s.dangerouslySetInnerHTML={__html:d}}else s[c]=n[l]}),xe.createElement(t,s)})},sf=function(t,r,n){switch(t){case la.TITLE:return{toComponent:function(){return Ast(t,r.title,r.titleAttributes)},toString:function(){return Sst(t,r.title,r.titleAttributes,n)}};case $p.BODY:case $p.HTML:return{toComponent:function(){return Eoe(r)},toString:function(){return Aoe(r)}};default:return{toComponent:function(){return Est(t,r)},toString:function(){return Cst(t,r,n)}}}},koe=function(t){var r=t.baseTag,n=t.bodyAttributes,a=t.encode,i=t.htmlAttributes,s=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.scriptTags,u=t.styleTags,f=t.title,m=f===void 0?"":f,h=t.titleAttributes;return{base:sf(la.BASE,r,a),bodyAttributes:sf($p.BODY,n,a),htmlAttributes:sf($p.HTML,i,a),link:sf(la.LINK,s,a),meta:sf(la.META,l,a),noscript:sf(la.NOSCRIPT,c,a),script:sf(la.SCRIPT,d,a),style:sf(la.STYLE,u,a),title:sf(la.TITLE,{title:m,titleAttributes:h},a)}},kst=function(t){var r,n;return n=r=function(a){hst(i,a);function i(){return fst(this,i),pst(this,a.apply(this,arguments))}return i.prototype.shouldComponentUpdate=function(l){return!rst(this.props,l)},i.prototype.mapNestedChildrenToProps=function(l,c){if(!c)return null;switch(l.type){case la.SCRIPT:case la.NOSCRIPT:return{innerHTML:c};case la.STYLE:return{cssText:c}}throw new Error("<"+l.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},i.prototype.flattenArrayTypeChildren=function(l){var c,d=l.child,u=l.arrayTypeChildren,f=l.newChildProps,m=l.nestedChildren;return _l({},u,(c={},c[d.type]=[].concat(u[d.type]||[],[_l({},f,this.mapNestedChildrenToProps(d,m))]),c))},i.prototype.mapObjectTypeChildren=function(l){var c,d,u=l.child,f=l.newProps,m=l.newChildProps,h=l.nestedChildren;switch(u.type){case la.TITLE:return _l({},f,(c={},c[u.type]=h,c.titleAttributes=_l({},m),c));case la.BODY:return _l({},f,{bodyAttributes:_l({},m)});case la.HTML:return _l({},f,{htmlAttributes:_l({},m)})}return _l({},f,(d={},d[u.type]=_l({},m),d))},i.prototype.mapArrayTypeChildrenToProps=function(l,c){var d=_l({},c);return Object.keys(l).forEach(function(u){var f;d=_l({},d,(f={},f[u]=l[u],f))}),d},i.prototype.warnOnInvalidChildren=function(l,c){return!0},i.prototype.mapChildrenToProps=function(l,c){var d=this,u={};return xe.Children.forEach(l,function(f){if(!(!f||!f.props)){var m=f.props,h=m.children,v=OU(m,["children"]),g=Pst(v);switch(d.warnOnInvalidChildren(f,h),f.type){case la.LINK:case la.META:case la.NOSCRIPT:case la.SCRIPT:case la.STYLE:u=d.flattenArrayTypeChildren({child:f,arrayTypeChildren:u,newChildProps:g,nestedChildren:h});break;default:c=d.mapObjectTypeChildren({child:f,newProps:c,newChildProps:g,nestedChildren:h});break}}}),c=this.mapArrayTypeChildrenToProps(u,c),c},i.prototype.render=function(){var l=this.props,c=l.children,d=OU(l,["children"]),u=_l({},d);return c&&(u=this.mapChildrenToProps(c,u)),xe.createElement(t,u)},mst(i,null,[{key:"canUseDOM",set:function(l){t.canUseDOM=l}}]),i}(xe.Component),r.propTypes={base:Ln.object,bodyAttributes:Ln.object,children:Ln.oneOfType([Ln.arrayOf(Ln.node),Ln.node]),defaultTitle:Ln.string,defer:Ln.bool,encodeSpecialCharacters:Ln.bool,htmlAttributes:Ln.object,link:Ln.arrayOf(Ln.object),meta:Ln.arrayOf(Ln.object),noscript:Ln.arrayOf(Ln.object),onChangeClientState:Ln.func,script:Ln.arrayOf(Ln.object),style:Ln.arrayOf(Ln.object),title:Ln.string,titleAttributes:Ln.object,titleTemplate:Ln.string},r.defaultProps={defer:!0,encodeSpecialCharacters:!0},r.peek=t.peek,r.rewind=function(){var a=t.rewind();return a||(a=koe({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),a},n},Ost=function(){return null},Tst=Xit(yst,Nst,koe)(Ost),R4=kst(Tst);R4.renderStatic=R4.rewind;function Ist(){const[e,t]=p.useState(!0),[r,n]=p.useState(!1),a=()=>{t(c=>!c)},i=ki(),s=Fl(),l=i.pathname==="/agenda";return p.useEffect(()=>{const c=d=>{const u=String(d.target?.tagName||"").toLowerCase();if(!(["input","textarea","select"].includes(u)||d.target?.isContentEditable)&&!d.repeat){if(String(d.key).toLowerCase()==="b"){d.preventDefault();const f=String(i?.pathname||"").toLowerCase();console.log("[Global Hotkey B] Current path:",f),f.includes("balcao")?(console.log("[Global Hotkey B] Navigating to /vendas"),s("/vendas")):(console.log("[Global Hotkey B] Navigating to /balcao"),s("/balcao"));return}if(String(d.key).toLowerCase()==="h"){d.preventDefault(),s("/historico");return}}};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[i,s]),o.jsx(j1e,{children:o.jsx(p1e,{children:o.jsx(N1e,{children:o.jsxs("div",{className:"relative flex h-screen bg-background text-text-primary",children:[o.jsxs(R4,{children:[o.jsx("title",{children:"F7 Arena"}),o.jsx("meta",{name:"description",content:"Software para gesto de quadras esportivas."})]}),o.jsx(Hpe,{isVisible:e,setIsVisible:t,sidebarPinned:r}),e&&o.jsx("button",{type:"button",onClick:()=>t(!1),className:"md:hidden fixed inset-0 z-30 bg-black/40","aria-label":"Fechar menu lateral"}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsx(g1e,{onToggleSidebar:a,sidebarVisible:e,sidebarPinned:r}),o.jsx("main",{className:Jt("flex-1 overflow-x-hidden overflow-y-auto bg-background",l?"p-0 md:p-8":"p-8"),children:o.jsxs(pj,{children:[o.jsx(so,{path:"/",element:o.jsx(lze,{})}),o.jsx(so,{path:"/agenda",element:o.jsx(BQe,{sidebarVisible:e})}),o.jsx(so,{path:"/isis",element:o.jsx(pit,{})}),o.jsx(so,{path:"/vendas",element:o.jsx(Aat,{})}),o.jsx(so,{path:"/balcao",element:o.jsx(Eat,{})}),o.jsx(so,{path:"/produtos",element:o.jsx(eot,{})}),o.jsx(so,{path:"/compras",element:o.jsx(not,{})}),o.jsx(so,{path:"/clientes",element:o.jsx(lot,{})}),o.jsx(so,{path:"/equipe",element:o.jsx(mot,{})}),o.jsx(so,{path:"/financeiro",element:o.jsx(Zot,{})}),o.jsx(so,{path:"/caixa",element:o.jsx(nH,{to:"/financeiro?tab=caixa",replace:!0})}),o.jsx(so,{path:"/quadras",element:o.jsx(rit,{})}),o.jsx(so,{path:"/empresas",element:o.jsx(sit,{})}),o.jsx(so,{path:"/finalizadoras",element:o.jsx(cit,{})}),o.jsx(so,{path:"/test-page",element:o.jsx(dit,{})}),o.jsx(so,{path:"/historico",element:o.jsx(yit,{})}),o.jsx(so,{path:"/suporte",element:o.jsx(pot,{})})]})})]})]})})})})}function Dst(){ki();const[e,t]=p.useState(!1),[r,n]=p.useState(!1),a=String({}.VITE_MAINTENANCE_MODE||"").toLowerCase()==="true",i=xe.useMemo(()=>{try{if(typeof window>"u")return null;const c=window.location.host||"",d="f7arena.com";if(!c.endsWith(d))return null;const u=c.slice(0,-d.length).replace(/\.$/,"").toLowerCase();return!u||u==="www"?null:u}catch{return null}},[]);p.useEffect(()=>{try{const c=()=>{const u=localStorage.getItem("maintenance:active")==="true",f=localStorage.getItem("maintenance:end");return u&&f&&new Date>new Date(f)?(localStorage.removeItem("maintenance:active"),!1):u};t(localStorage.getItem("maintenance:bypass")==="1"),n(c());const d=u=>{if(!u||!u.key){n(c()),t(localStorage.getItem("maintenance:bypass")==="1");return}u.key==="maintenance:bypass"&&t(u.newValue==="1"),(u.key==="maintenance:active"||u.key==="maintenance:end")&&n(c())};return window.addEventListener("storage",d),()=>window.removeEventListener("storage",d)}catch{}},[]);const s=!!Soe||a||r,l=(()=>{try{const c=localStorage.getItem("maintenance:bypass")==="1",d=(()=>{try{return sessionStorage.getItem("maintenance:bypass")==="1"}catch{return!1}})(),u=(()=>{try{return document.cookie.split(";").some(f=>f.trim()==="fx_maint_bypass=1")}catch{return!1}})();return c||d||u}catch{return!1}})();return s&&!l?o.jsxs(pj,{children:[o.jsx(so,{path:"/maintenance",element:o.jsx(AU,{})}),o.jsx(so,{path:"*",element:o.jsx(nH,{to:"/maintenance",replace:!0})})]}):i?o.jsx(pj,{children:o.jsx(so,{path:"/*",element:o.jsx(SU,{})})}):o.jsxs(pj,{children:[o.jsx(so,{path:"/reset-password",element:o.jsx(mit,{})}),o.jsx(so,{path:"/40028922",element:o.jsx(Sit,{})}),o.jsx(so,{path:"/agendar/:nomeFantasia",element:o.jsx(SU,{})}),o.jsx(so,{path:"/maintenance",element:o.jsx(AU,{})}),o.jsx(so,{path:"/backenddeploy",element:o.jsx(uit,{})}),o.jsx(so,{path:"/print-comanda",element:o.jsx(iF,{children:o.jsx(bit,{})})}),o.jsx(so,{path:"/*",element:o.jsx(iF,{children:o.jsx(Ist,{})})})]})}var vR="ToastProvider",[xR,Mst,Rst]=XC("Toast"),[Ooe,Slt]=bd("Toast",[Rst]),[Lst,D5]=Ooe(vR),Toe=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:s}=e,[l,c]=p.useState(null),[d,u]=p.useState(0),f=p.useRef(!1),m=p.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${vR}\`. Expected non-empty \`string\`.`),o.jsx(xR.Provider,{scope:t,children:o.jsx(Lst,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:i,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>u(h=>h+1),[]),onToastRemove:p.useCallback(()=>u(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:m,children:s})})};Toe.displayName=vR;var Ioe="ToastViewport",$st=["F8"],L4="toast.viewportPause",$4="toast.viewportResume",Doe=p.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=$st,label:a="Notifications ({hotkey})",...i}=e,s=D5(Ioe,r),l=Mst(r),c=p.useRef(null),d=p.useRef(null),u=p.useRef(null),f=p.useRef(null),m=Ia(t,f,s.onViewportChange),h=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=s.toastCount>0;p.useEffect(()=>{const x=y=>{n.length!==0&&n.every(w=>y[w]||y.code===w)&&f.current?.focus()};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[n]),p.useEffect(()=>{const x=c.current,y=f.current;if(v&&x&&y){const b=()=>{if(!s.isClosePausedRef.current){const S=new CustomEvent(L4);y.dispatchEvent(S),s.isClosePausedRef.current=!0}},w=()=>{if(s.isClosePausedRef.current){const S=new CustomEvent($4);y.dispatchEvent(S),s.isClosePausedRef.current=!1}},j=S=>{!x.contains(S.relatedTarget)&&w()},_=()=>{x.contains(document.activeElement)||w()};return x.addEventListener("focusin",b),x.addEventListener("focusout",j),x.addEventListener("pointermove",b),x.addEventListener("pointerleave",_),window.addEventListener("blur",b),window.addEventListener("focus",w),()=>{x.removeEventListener("focusin",b),x.removeEventListener("focusout",j),x.removeEventListener("pointermove",b),x.removeEventListener("pointerleave",_),window.removeEventListener("blur",b),window.removeEventListener("focus",w)}}},[v,s.isClosePausedRef]);const g=p.useCallback(({tabbingDirection:x})=>{const b=l().map(w=>{const j=w.ref.current,_=[j,...Jst(j)];return x==="forwards"?_:_.reverse()});return(x==="forwards"?b.reverse():b).flat()},[l]);return p.useEffect(()=>{const x=f.current;if(x){const y=b=>{const w=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!w){const _=document.activeElement,S=b.shiftKey;if(b.target===x&&S){d.current?.focus();return}const A=g({tabbingDirection:S?"backwards":"forwards"}),M=A.findIndex(C=>C===_);TE(A.slice(M+1))?b.preventDefault():S?d.current?.focus():u.current?.focus()}};return x.addEventListener("keydown",y),()=>x.removeEventListener("keydown",y)}},[l,g]),o.jsxs(cge,{ref:c,role:"region","aria-label":a.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&o.jsx(F4,{ref:d,onFocusFromOutsideViewport:()=>{const x=g({tabbingDirection:"forwards"});TE(x)}}),o.jsx(xR.Slot,{scope:r,children:o.jsx(Hn.ol,{tabIndex:-1,...i,ref:m})}),v&&o.jsx(F4,{ref:u,onFocusFromOutsideViewport:()=>{const x=g({tabbingDirection:"backwards"});TE(x)}})]})});Doe.displayName=Ioe;var Moe="ToastFocusProxy",F4=p.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,i=D5(Moe,r);return o.jsx(iM,{tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:s=>{const l=s.relatedTarget;!i.viewport?.contains(l)&&n()}})});F4.displayName=Moe;var Ew="Toast",Fst="toast.swipeStart",Bst="toast.swipeMove",qst="toast.swipeCancel",zst="toast.swipeEnd",Roe=p.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:i,...s}=e,[l,c]=Df({prop:n,defaultProp:a??!0,onChange:i,caller:Ew});return o.jsx(Ac,{present:r||l,children:o.jsx(Wst,{open:l,...s,ref:t,onClose:()=>c(!1),onPause:$l(e.onPause),onResume:$l(e.onResume),onSwipeStart:Qr(e.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Qr(e.onSwipeMove,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Qr(e.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Qr(e.onSwipeEnd,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});Roe.displayName=Ew;var[Ust,Vst]=Ooe(Ew,{onClose(){}}),Wst=p.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:i,onClose:s,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:f,onSwipeCancel:m,onSwipeEnd:h,...v}=e,g=D5(Ew,r),[x,y]=p.useState(null),b=Ia(t,D=>y(D)),w=p.useRef(null),j=p.useRef(null),_=a||g.duration,S=p.useRef(0),k=p.useRef(_),E=p.useRef(0),{onToastAdd:A,onToastRemove:M}=g,C=$l(()=>{x?.contains(document.activeElement)&&g.viewport?.focus(),s()}),T=p.useCallback(D=>{!D||D===1/0||(window.clearTimeout(E.current),S.current=new Date().getTime(),E.current=window.setTimeout(C,D))},[C]);p.useEffect(()=>{const D=g.viewport;if(D){const F=()=>{T(k.current),d?.()},z=()=>{const q=new Date().getTime()-S.current;k.current=k.current-q,window.clearTimeout(E.current),c?.()};return D.addEventListener(L4,z),D.addEventListener($4,F),()=>{D.removeEventListener(L4,z),D.removeEventListener($4,F)}}},[g.viewport,_,c,d,T]),p.useEffect(()=>{i&&!g.isClosePausedRef.current&&T(_)},[i,_,g.isClosePausedRef,T]),p.useEffect(()=>(A(),()=>M()),[A,M]);const I=p.useMemo(()=>x?Uoe(x):null,[x]);return g.viewport?o.jsxs(o.Fragment,{children:[I&&o.jsx(Hst,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:I}),o.jsx(Ust,{scope:r,onClose:C,children:zf.createPortal(o.jsx(xR.ItemSlot,{scope:r,children:o.jsx(lge,{asChild:!0,onEscapeKeyDown:Qr(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||C(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:o.jsx(Hn.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...v,ref:b,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Qr(e.onKeyDown,D=>{D.key==="Escape"&&(l?.(D.nativeEvent),D.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,C()))}),onPointerDown:Qr(e.onPointerDown,D=>{D.button===0&&(w.current={x:D.clientX,y:D.clientY})}),onPointerMove:Qr(e.onPointerMove,D=>{if(!w.current)return;const F=D.clientX-w.current.x,z=D.clientY-w.current.y,q=!!j.current,$=["left","right"].includes(g.swipeDirection),K=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,ce=$?K(0,F):0,fe=$?0:K(0,z),B=D.pointerType==="touch"?10:2,L={x:ce,y:fe},V={originalEvent:D,delta:L};q?(j.current=L,rj(Bst,f,V,{discrete:!1})):DU(L,g.swipeDirection,B)?(j.current=L,rj(Fst,u,V,{discrete:!1}),D.target.setPointerCapture(D.pointerId)):(Math.abs(F)>B||Math.abs(z)>B)&&(w.current=null)}),onPointerUp:Qr(e.onPointerUp,D=>{const F=j.current,z=D.target;if(z.hasPointerCapture(D.pointerId)&&z.releasePointerCapture(D.pointerId),j.current=null,w.current=null,F){const q=D.currentTarget,$={originalEvent:D,delta:F};DU(F,g.swipeDirection,g.swipeThreshold)?rj(zst,h,$,{discrete:!0}):rj(qst,m,$,{discrete:!0}),q.addEventListener("click",K=>K.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),Hst=e=>{const{__scopeToast:t,children:r,...n}=e,a=D5(Ew,t),[i,s]=p.useState(!1),[l,c]=p.useState(!1);return Yst(()=>s(!0)),p.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:o.jsx(e0,{asChild:!0,children:o.jsx(iM,{...n,children:i&&o.jsxs(o.Fragment,{children:[a.label," ",r]})})})},Gst="ToastTitle",Loe=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return o.jsx(Hn.div,{...n,ref:t})});Loe.displayName=Gst;var Kst="ToastDescription",$oe=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return o.jsx(Hn.div,{...n,ref:t})});$oe.displayName=Kst;var Foe="ToastAction",Boe=p.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?o.jsx(zoe,{altText:r,asChild:!0,children:o.jsx(yR,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${Foe}\`. Expected non-empty \`string\`.`),null)});Boe.displayName=Foe;var qoe="ToastClose",yR=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=Vst(qoe,r);return o.jsx(zoe,{asChild:!0,children:o.jsx(Hn.button,{type:"button",...n,ref:t,onClick:Qr(e.onClick,a.onClose)})})});yR.displayName=qoe;var zoe=p.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return o.jsx(Hn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function Uoe(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),Xst(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const s=n.dataset.radixToastAnnounceAlt;s&&t.push(s)}else t.push(...Uoe(n))}}),t}function rj(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?pI(a,i):a.dispatchEvent(i)}var DU=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),i=n>a;return t==="left"||t==="right"?i&&n>r:!i&&a>r};function Yst(e=()=>{}){const t=$l(e);Ss(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function Xst(e){return e.nodeType===e.ELEMENT_NODE}function Jst(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function TE(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Qst=Toe,Voe=Doe,Woe=Roe,Hoe=Loe,Goe=$oe,Koe=Boe,Yoe=yR;const Zst=Qst,Xoe=xe.forwardRef(({className:e,...t},r)=>o.jsx(Voe,{ref:r,className:Jt("fixed z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Xoe.displayName=Voe.displayName;const elt=hI("group relative pointer-events-auto flex w-full items-start justify-between gap-4 overflow-hidden rounded-lg border p-4 pr-8 shadow-xl transition-all data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-warning text-black border-warning",destructive:"bg-danger text-white border-danger",success:"bg-success text-white border-success",info:"bg-info text-black border-info",warning:"bg-warning text-black border-warning"}},defaultVariants:{variant:"default"}}),Joe=xe.forwardRef(({className:e,variant:t,...r},n)=>o.jsx(Woe,{ref:n,className:Jt(elt({variant:t}),e),...r}));Joe.displayName=Woe.displayName;const tlt=xe.forwardRef(({className:e,...t},r)=>o.jsx(Koe,{ref:r,className:Jt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));tlt.displayName=Koe.displayName;const Qoe=xe.forwardRef(({className:e,...t},r)=>o.jsx(Yoe,{ref:r,className:Jt("absolute right-2 top-2 rounded-md p-1 text-white/80 transition-opacity hover:text-white focus:outline-none focus:ring-2 focus:ring-white/50 group-[.default]:text-black/70 group-[.default]:hover:text-black",e),...t,children:o.jsx(Dl,{className:"h-4 w-4"})}));Qoe.displayName=Yoe.displayName;const Zoe=xe.forwardRef(({className:e,...t},r)=>o.jsx(Hoe,{ref:r,className:Jt("text-sm font-semibold",e),...t}));Zoe.displayName=Hoe.displayName;const eie=xe.forwardRef(({className:e,...t},r)=>o.jsx(Goe,{ref:r,className:Jt("text-sm",e),...t}));eie.displayName=Goe.displayName;function rlt(){const{toasts:e}=ro();return o.jsxs(Zst,{children:[e.map(({id:t,title:r,description:n,action:a,dismiss:i,...s})=>o.jsxs(Joe,{...s,children:[o.jsxs("div",{className:"grid gap-1",children:[r&&o.jsx(Zoe,{children:r}),n&&o.jsx(eie,{children:n})]}),a,o.jsx(Qoe,{onClick:i})]},t)),o.jsx(Xoe,{})]})}function nlt(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(e=>{setInterval(()=>{e.update()},6e4),e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&window.confirm("Nova verso disponvel! Deseja atualizar agora?")&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload())})})}).catch(e=>{console.error("[SW] Erro ao registrar Service Worker:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})})}nlt();window.screen?.orientation?.lock&&window.screen.orientation.lock("portrait").catch(e=>{console.log("[Orientation] Lock no suportado ou j bloqueado:",e.message)});window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),window.__installPrompt=e},{passive:!1});window.addEventListener("appinstalled",()=>{window.__installPrompt=null});IE.createRoot(document.getElementById("root")).render(o.jsx(lde,{children:o.jsxs(pye,{children:[o.jsx(Dst,{}),o.jsx(rlt,{})]})}));export{Qbe as _,qs as c,Ba as g};
