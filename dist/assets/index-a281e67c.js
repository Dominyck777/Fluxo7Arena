var sie=Object.defineProperty;var oie=(e,t,r)=>t in e?sie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ls=(e,t,r)=>(oie(e,typeof t!="symbol"?t+"":t,r),r);function iie(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(n,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var Qi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ga(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function lie(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var iV={exports:{}},MS={},lV={exports:{}},Da={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1=Symbol.for("react.element"),cie=Symbol.for("react.portal"),die=Symbol.for("react.fragment"),uie=Symbol.for("react.strict_mode"),fie=Symbol.for("react.profiler"),mie=Symbol.for("react.provider"),hie=Symbol.for("react.context"),pie=Symbol.for("react.forward_ref"),gie=Symbol.for("react.suspense"),vie=Symbol.for("react.memo"),xie=Symbol.for("react.lazy"),cL=Symbol.iterator;function yie(e){return e===null||typeof e!="object"?null:(e=cL&&e[cL]||e["@@iterator"],typeof e=="function"?e:null)}var cV={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dV=Object.assign,uV={};function a0(e,t,r){this.props=e,this.context=t,this.refs=uV,this.updater=r||cV}a0.prototype.isReactComponent={};a0.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};a0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function fV(){}fV.prototype=a0.prototype;function i3(e,t,r){this.props=e,this.context=t,this.refs=uV,this.updater=r||cV}var l3=i3.prototype=new fV;l3.constructor=i3;dV(l3,a0.prototype);l3.isPureReactComponent=!0;var dL=Array.isArray,mV=Object.prototype.hasOwnProperty,c3={current:null},hV={key:!0,ref:!0,__self:!0,__source:!0};function pV(e,t,r){var n,s={},o=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)mV.call(t,n)&&!hV.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:r1,type:e,key:o,ref:i,props:s,_owner:c3.current}}function bie(e,t){return{$$typeof:r1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function d3(e){return typeof e=="object"&&e!==null&&e.$$typeof===r1}function wie(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var uL=/\/+/g;function vA(e,t){return typeof e=="object"&&e!==null&&e.key!=null?wie(""+e.key):t.toString(36)}function Aj(e,t,r,n,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case r1:case cie:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+vA(i,0):n,dL(s)?(r="",e!=null&&(r=e.replace(uL,"$&/")+"/"),Aj(s,t,r,"",function(d){return d})):s!=null&&(d3(s)&&(s=bie(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(uL,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",dL(e))for(var l=0;l<e.length;l++){o=e[l];var c=n+vA(o,l);i+=Aj(o,t,r,c,s)}else if(c=yie(e),typeof c=="function")for(e=c.call(e),l=0;!(o=e.next()).done;)o=o.value,c=n+vA(o,l++),i+=Aj(o,t,r,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function i2(e,t,r){if(e==null)return e;var n=[],s=0;return Aj(e,n,"","",function(o){return t.call(r,o,s++)}),n}function jie(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Cl={current:null},Pj={transition:null},_ie={ReactCurrentDispatcher:Cl,ReactCurrentBatchConfig:Pj,ReactCurrentOwner:c3};function gV(){throw Error("act(...) is not supported in production builds of React.")}Da.Children={map:i2,forEach:function(e,t,r){i2(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return i2(e,function(){t++}),t},toArray:function(e){return i2(e,function(t){return t})||[]},only:function(e){if(!d3(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Da.Component=a0;Da.Fragment=die;Da.Profiler=fie;Da.PureComponent=i3;Da.StrictMode=uie;Da.Suspense=gie;Da.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_ie;Da.act=gV;Da.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=dV({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=c3.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)mV.call(t,c)&&!hV.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:r1,type:e.type,key:s,ref:o,props:n,_owner:i}};Da.createContext=function(e){return e={$$typeof:hie,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:mie,_context:e},e.Consumer=e};Da.createElement=pV;Da.createFactory=function(e){var t=pV.bind(null,e);return t.type=e,t};Da.createRef=function(){return{current:null}};Da.forwardRef=function(e){return{$$typeof:pie,render:e}};Da.isValidElement=d3;Da.lazy=function(e){return{$$typeof:xie,_payload:{_status:-1,_result:e},_init:jie}};Da.memo=function(e,t){return{$$typeof:vie,type:e,compare:t===void 0?null:t}};Da.startTransition=function(e){var t=Pj.transition;Pj.transition={};try{e()}finally{Pj.transition=t}};Da.unstable_act=gV;Da.useCallback=function(e,t){return Cl.current.useCallback(e,t)};Da.useContext=function(e){return Cl.current.useContext(e)};Da.useDebugValue=function(){};Da.useDeferredValue=function(e){return Cl.current.useDeferredValue(e)};Da.useEffect=function(e,t){return Cl.current.useEffect(e,t)};Da.useId=function(){return Cl.current.useId()};Da.useImperativeHandle=function(e,t,r){return Cl.current.useImperativeHandle(e,t,r)};Da.useInsertionEffect=function(e,t){return Cl.current.useInsertionEffect(e,t)};Da.useLayoutEffect=function(e,t){return Cl.current.useLayoutEffect(e,t)};Da.useMemo=function(e,t){return Cl.current.useMemo(e,t)};Da.useReducer=function(e,t,r){return Cl.current.useReducer(e,t,r)};Da.useRef=function(e){return Cl.current.useRef(e)};Da.useState=function(e){return Cl.current.useState(e)};Da.useSyncExternalStore=function(e,t,r){return Cl.current.useSyncExternalStore(e,t,r)};Da.useTransition=function(){return Cl.current.useTransition()};Da.version="18.3.1";lV.exports=Da;var p=lV.exports;const Se=Ga(p),u3=iie({__proto__:null,default:Se},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nie=p,Sie=Symbol.for("react.element"),Cie=Symbol.for("react.fragment"),Aie=Object.prototype.hasOwnProperty,Pie=Nie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Eie={key:!0,ref:!0,__self:!0,__source:!0};function vV(e,t,r){var n,s={},o=null,i=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)Aie.call(t,n)&&!Eie.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:Sie,type:e,key:o,ref:i,props:s,_owner:Pie.current}}MS.Fragment=Cie;MS.jsx=vV;MS.jsxs=vV;iV.exports=MS;var a=iV.exports,nk={},xV={exports:{}},$c={},yV={exports:{}},bV={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t($,ee){var ve=$.length;$.push(ee);e:for(;0<ve;){var _e=ve-1>>>1,K=$[_e];if(0<s(K,ee))$[_e]=ee,$[ve]=K,ve=_e;else break e}}function r($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var ee=$[0],ve=$.pop();if(ve!==ee){$[0]=ve;e:for(var _e=0,K=$.length,q=K>>>1;_e<q;){var Y=2*(_e+1)-1,J=$[Y],fe=Y+1,Z=$[fe];if(0>s(J,ve))fe<K&&0>s(Z,J)?($[_e]=Z,$[fe]=ve,_e=fe):($[_e]=J,$[Y]=ve,_e=Y);else if(fe<K&&0>s(Z,ve))$[_e]=Z,$[fe]=ve,_e=fe;else break e}}return ee}function s($,ee){var ve=$.sortIndex-ee.sortIndex;return ve!==0?ve:$.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,f=null,h=3,m=!1,v=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w($){for(var ee=r(d);ee!==null;){if(ee.callback===null)n(d);else if(ee.startTime<=$)n(d),ee.sortIndex=ee.expirationTime,t(c,ee);else break;ee=r(d)}}function j($){if(g=!1,w($),!v)if(r(c)!==null)v=!0,z(_);else{var ee=r(d);ee!==null&&W(j,ee.startTime-$)}}function _($,ee){v=!1,g&&(g=!1,x(E),E=-1),m=!0;var ve=h;try{for(w(ee),f=r(c);f!==null&&(!(f.expirationTime>ee)||$&&!D());){var _e=f.callback;if(typeof _e=="function"){f.callback=null,h=f.priorityLevel;var K=_e(f.expirationTime<=ee);ee=e.unstable_now(),typeof K=="function"?f.callback=K:f===r(c)&&n(c),w(ee)}else n(c);f=r(c)}if(f!==null)var q=!0;else{var Y=r(d);Y!==null&&W(j,Y.startTime-ee),q=!1}return q}finally{f=null,h=ve,m=!1}}var C=!1,P=null,E=-1,A=5,F=-1;function D(){return!(e.unstable_now()-F<A)}function I(){if(P!==null){var $=e.unstable_now();F=$;var ee=!0;try{ee=P(!0,$)}finally{ee?R():(C=!1,P=null)}}else C=!1}var R;if(typeof b=="function")R=function(){b(I)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,U=M.port2;M.port1.onmessage=I,R=function(){U.postMessage(null)}}else R=function(){y(I,0)};function z($){P=$,C||(C=!0,R())}function W($,ee){E=y(function(){$(e.unstable_now())},ee)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,z(_))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function($){switch(h){case 1:case 2:case 3:var ee=3;break;default:ee=h}var ve=h;h=ee;try{return $()}finally{h=ve}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,ee){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ve=h;h=$;try{return ee()}finally{h=ve}},e.unstable_scheduleCallback=function($,ee,ve){var _e=e.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?_e+ve:_e):ve=_e,$){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ve+K,$={id:u++,callback:ee,priorityLevel:$,startTime:ve,expirationTime:K,sortIndex:-1},ve>_e?($.sortIndex=ve,t(d,$),r(c)===null&&$===r(d)&&(g?(x(E),E=-1):g=!0,W(j,ve-_e))):($.sortIndex=K,t(c,$),v||m||(v=!0,z(_))),$},e.unstable_shouldYield=D,e.unstable_wrapCallback=function($){var ee=h;return function(){var ve=h;h=ee;try{return $.apply(this,arguments)}finally{h=ve}}}})(bV);yV.exports=bV;var kie=yV.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iie=p,Lc=kie;function en(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wV=new Set,Nb={};function xg(e,t){dx(e,t),dx(e+"Capture",t)}function dx(e,t){for(Nb[e]=t,e=0;e<t.length;e++)wV.add(t[e])}var Ff=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ak=Object.prototype.hasOwnProperty,Oie=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fL={},mL={};function Tie(e){return ak.call(mL,e)?!0:ak.call(fL,e)?!1:Oie.test(e)?mL[e]=!0:(fL[e]=!0,!1)}function Die(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Mie(e,t,r,n){if(t===null||typeof t>"u"||Die(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Al(e,t,r,n,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var Di={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Di[e]=new Al(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Di[t]=new Al(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Di[e]=new Al(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Di[e]=new Al(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Di[e]=new Al(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Di[e]=new Al(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Di[e]=new Al(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Di[e]=new Al(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Di[e]=new Al(e,5,!1,e.toLowerCase(),null,!1,!1)});var f3=/[\-:]([a-z])/g;function m3(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(f3,m3);Di[t]=new Al(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(f3,m3);Di[t]=new Al(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(f3,m3);Di[t]=new Al(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Di[e]=new Al(e,1,!1,e.toLowerCase(),null,!1,!1)});Di.xlinkHref=new Al("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Di[e]=new Al(e,1,!1,e.toLowerCase(),null,!0,!0)});function h3(e,t,r,n){var s=Di.hasOwnProperty(t)?Di[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Mie(t,r,s,n)&&(r=null),n||s===null?Tie(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Zf=Iie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l2=Symbol.for("react.element"),yv=Symbol.for("react.portal"),bv=Symbol.for("react.fragment"),p3=Symbol.for("react.strict_mode"),sk=Symbol.for("react.profiler"),jV=Symbol.for("react.provider"),_V=Symbol.for("react.context"),g3=Symbol.for("react.forward_ref"),ok=Symbol.for("react.suspense"),ik=Symbol.for("react.suspense_list"),v3=Symbol.for("react.memo"),Pm=Symbol.for("react.lazy"),NV=Symbol.for("react.offscreen"),hL=Symbol.iterator;function V0(e){return e===null||typeof e!="object"?null:(e=hL&&e[hL]||e["@@iterator"],typeof e=="function"?e:null)}var so=Object.assign,xA;function _y(e){if(xA===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);xA=t&&t[1]||""}return`
`+xA+e}var yA=!1;function bA(e,t){if(!e||yA)return"";yA=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=n.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{yA=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?_y(e):""}function Rie(e){switch(e.tag){case 5:return _y(e.type);case 16:return _y("Lazy");case 13:return _y("Suspense");case 19:return _y("SuspenseList");case 0:case 2:case 15:return e=bA(e.type,!1),e;case 11:return e=bA(e.type.render,!1),e;case 1:return e=bA(e.type,!0),e;default:return""}}function lk(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case bv:return"Fragment";case yv:return"Portal";case sk:return"Profiler";case p3:return"StrictMode";case ok:return"Suspense";case ik:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case _V:return(e.displayName||"Context")+".Consumer";case jV:return(e._context.displayName||"Context")+".Provider";case g3:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case v3:return t=e.displayName||null,t!==null?t:lk(e.type)||"Memo";case Pm:t=e._payload,e=e._init;try{return lk(e(t))}catch{}}return null}function Lie(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lk(t);case 8:return t===p3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function bh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function SV(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Fie(e){var t=SV(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function c2(e){e._valueTracker||(e._valueTracker=Fie(e))}function CV(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=SV(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function o_(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ck(e,t){var r=t.checked;return so({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function pL(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=bh(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function AV(e,t){t=t.checked,t!=null&&h3(e,"checked",t,!1)}function dk(e,t){AV(e,t);var r=bh(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?uk(e,t.type,r):t.hasOwnProperty("defaultValue")&&uk(e,t.type,bh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function gL(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function uk(e,t,r){(t!=="number"||o_(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ny=Array.isArray;function Uv(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+bh(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function fk(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(en(91));return so({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function vL(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(en(92));if(Ny(r)){if(1<r.length)throw Error(en(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:bh(r)}}function PV(e,t){var r=bh(t.value),n=bh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function xL(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function EV(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mk(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?EV(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var d2,kV=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(d2=d2||document.createElement("div"),d2.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=d2.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Sb(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Dy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$ie=["Webkit","ms","Moz","O"];Object.keys(Dy).forEach(function(e){$ie.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Dy[t]=Dy[e]})});function IV(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Dy.hasOwnProperty(e)&&Dy[e]?(""+t).trim():t+"px"}function OV(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=IV(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var Bie=so({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hk(e,t){if(t){if(Bie[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(en(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(en(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(en(61))}if(t.style!=null&&typeof t.style!="object")throw Error(en(62))}}function pk(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gk=null;function x3(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vk=null,Vv=null,Wv=null;function yL(e){if(e=s1(e)){if(typeof vk!="function")throw Error(en(280));var t=e.stateNode;t&&(t=BS(t),vk(e.stateNode,e.type,t))}}function TV(e){Vv?Wv?Wv.push(e):Wv=[e]:Vv=e}function DV(){if(Vv){var e=Vv,t=Wv;if(Wv=Vv=null,yL(e),t)for(e=0;e<t.length;e++)yL(t[e])}}function MV(e,t){return e(t)}function RV(){}var wA=!1;function LV(e,t,r){if(wA)return e(t,r);wA=!0;try{return MV(e,t,r)}finally{wA=!1,(Vv!==null||Wv!==null)&&(RV(),DV())}}function Cb(e,t){var r=e.stateNode;if(r===null)return null;var n=BS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(en(231,t,typeof r));return r}var xk=!1;if(Ff)try{var W0={};Object.defineProperty(W0,"passive",{get:function(){xk=!0}}),window.addEventListener("test",W0,W0),window.removeEventListener("test",W0,W0)}catch{xk=!1}function qie(e,t,r,n,s,o,i,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var My=!1,i_=null,l_=!1,yk=null,zie={onError:function(e){My=!0,i_=e}};function Uie(e,t,r,n,s,o,i,l,c){My=!1,i_=null,qie.apply(zie,arguments)}function Vie(e,t,r,n,s,o,i,l,c){if(Uie.apply(this,arguments),My){if(My){var d=i_;My=!1,i_=null}else throw Error(en(198));l_||(l_=!0,yk=d)}}function yg(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function FV(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bL(e){if(yg(e)!==e)throw Error(en(188))}function Wie(e){var t=e.alternate;if(!t){if(t=yg(e),t===null)throw Error(en(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var o=s.alternate;if(o===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===r)return bL(s),e;if(o===n)return bL(s),t;o=o.sibling}throw Error(en(188))}if(r.return!==n.return)r=s,n=o;else{for(var i=!1,l=s.child;l;){if(l===r){i=!0,r=s,n=o;break}if(l===n){i=!0,n=s,r=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===r){i=!0,r=o,n=s;break}if(l===n){i=!0,n=o,r=s;break}l=l.sibling}if(!i)throw Error(en(189))}}if(r.alternate!==n)throw Error(en(190))}if(r.tag!==3)throw Error(en(188));return r.stateNode.current===r?e:t}function $V(e){return e=Wie(e),e!==null?BV(e):null}function BV(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=BV(e);if(t!==null)return t;e=e.sibling}return null}var qV=Lc.unstable_scheduleCallback,wL=Lc.unstable_cancelCallback,Hie=Lc.unstable_shouldYield,Gie=Lc.unstable_requestPaint,bo=Lc.unstable_now,Kie=Lc.unstable_getCurrentPriorityLevel,y3=Lc.unstable_ImmediatePriority,zV=Lc.unstable_UserBlockingPriority,c_=Lc.unstable_NormalPriority,Xie=Lc.unstable_LowPriority,UV=Lc.unstable_IdlePriority,RS=null,Bu=null;function Yie(e){if(Bu&&typeof Bu.onCommitFiberRoot=="function")try{Bu.onCommitFiberRoot(RS,e,void 0,(e.current.flags&128)===128)}catch{}}var nu=Math.clz32?Math.clz32:Zie,Jie=Math.log,Qie=Math.LN2;function Zie(e){return e>>>=0,e===0?32:31-(Jie(e)/Qie|0)|0}var u2=64,f2=4194304;function Sy(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function d_(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,o=e.pingedLanes,i=r&268435455;if(i!==0){var l=i&~s;l!==0?n=Sy(l):(o&=i,o!==0&&(n=Sy(o)))}else i=r&~s,i!==0?n=Sy(i):o!==0&&(n=Sy(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-nu(t),s=1<<r,n|=e[r],t&=~s;return n}function ele(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tle(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-nu(o),l=1<<i,c=s[i];c===-1?(!(l&r)||l&n)&&(s[i]=ele(l,t)):c<=t&&(e.expiredLanes|=l),o&=~l}}function bk(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function VV(){var e=u2;return u2<<=1,!(u2&4194240)&&(u2=64),e}function jA(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function n1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-nu(t),e[t]=r}function rle(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-nu(r),o=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~o}}function b3(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-nu(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var us=0;function WV(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var HV,w3,GV,KV,XV,wk=!1,m2=[],Jm=null,Qm=null,Zm=null,Ab=new Map,Pb=new Map,Tm=[],nle="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jL(e,t){switch(e){case"focusin":case"focusout":Jm=null;break;case"dragenter":case"dragleave":Qm=null;break;case"mouseover":case"mouseout":Zm=null;break;case"pointerover":case"pointerout":Ab.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pb.delete(t.pointerId)}}function H0(e,t,r,n,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},t!==null&&(t=s1(t),t!==null&&w3(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function ale(e,t,r,n,s){switch(t){case"focusin":return Jm=H0(Jm,e,t,r,n,s),!0;case"dragenter":return Qm=H0(Qm,e,t,r,n,s),!0;case"mouseover":return Zm=H0(Zm,e,t,r,n,s),!0;case"pointerover":var o=s.pointerId;return Ab.set(o,H0(Ab.get(o)||null,e,t,r,n,s)),!0;case"gotpointercapture":return o=s.pointerId,Pb.set(o,H0(Pb.get(o)||null,e,t,r,n,s)),!0}return!1}function YV(e){var t=bp(e.target);if(t!==null){var r=yg(t);if(r!==null){if(t=r.tag,t===13){if(t=FV(r),t!==null){e.blockedOn=t,XV(e.priority,function(){GV(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ej(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=jk(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);gk=n,r.target.dispatchEvent(n),gk=null}else return t=s1(r),t!==null&&w3(t),e.blockedOn=r,!1;t.shift()}return!0}function _L(e,t,r){Ej(e)&&r.delete(t)}function sle(){wk=!1,Jm!==null&&Ej(Jm)&&(Jm=null),Qm!==null&&Ej(Qm)&&(Qm=null),Zm!==null&&Ej(Zm)&&(Zm=null),Ab.forEach(_L),Pb.forEach(_L)}function G0(e,t){e.blockedOn===t&&(e.blockedOn=null,wk||(wk=!0,Lc.unstable_scheduleCallback(Lc.unstable_NormalPriority,sle)))}function Eb(e){function t(s){return G0(s,e)}if(0<m2.length){G0(m2[0],e);for(var r=1;r<m2.length;r++){var n=m2[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Jm!==null&&G0(Jm,e),Qm!==null&&G0(Qm,e),Zm!==null&&G0(Zm,e),Ab.forEach(t),Pb.forEach(t),r=0;r<Tm.length;r++)n=Tm[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Tm.length&&(r=Tm[0],r.blockedOn===null);)YV(r),r.blockedOn===null&&Tm.shift()}var Hv=Zf.ReactCurrentBatchConfig,u_=!0;function ole(e,t,r,n){var s=us,o=Hv.transition;Hv.transition=null;try{us=1,j3(e,t,r,n)}finally{us=s,Hv.transition=o}}function ile(e,t,r,n){var s=us,o=Hv.transition;Hv.transition=null;try{us=4,j3(e,t,r,n)}finally{us=s,Hv.transition=o}}function j3(e,t,r,n){if(u_){var s=jk(e,t,r,n);if(s===null)OA(e,t,n,f_,r),jL(e,n);else if(ale(s,e,t,r,n))n.stopPropagation();else if(jL(e,n),t&4&&-1<nle.indexOf(e)){for(;s!==null;){var o=s1(s);if(o!==null&&HV(o),o=jk(e,t,r,n),o===null&&OA(e,t,n,f_,r),o===s)break;s=o}s!==null&&n.stopPropagation()}else OA(e,t,n,null,r)}}var f_=null;function jk(e,t,r,n){if(f_=null,e=x3(n),e=bp(e),e!==null)if(t=yg(e),t===null)e=null;else if(r=t.tag,r===13){if(e=FV(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return f_=e,null}function JV(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Kie()){case y3:return 1;case zV:return 4;case c_:case Xie:return 16;case UV:return 536870912;default:return 16}default:return 16}}var Bm=null,_3=null,kj=null;function QV(){if(kj)return kj;var e,t=_3,r=t.length,n,s="value"in Bm?Bm.value:Bm.textContent,o=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[o-n];n++);return kj=s.slice(e,1<n?1-n:void 0)}function Ij(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function h2(){return!0}function NL(){return!1}function Bc(e){function t(r,n,s,o,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?h2:NL,this.isPropagationStopped=NL,this}return so(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=h2)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=h2)},persist:function(){},isPersistent:h2}),t}var s0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},N3=Bc(s0),a1=so({},s0,{view:0,detail:0}),lle=Bc(a1),_A,NA,K0,LS=so({},a1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:S3,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==K0&&(K0&&e.type==="mousemove"?(_A=e.screenX-K0.screenX,NA=e.screenY-K0.screenY):NA=_A=0,K0=e),_A)},movementY:function(e){return"movementY"in e?e.movementY:NA}}),SL=Bc(LS),cle=so({},LS,{dataTransfer:0}),dle=Bc(cle),ule=so({},a1,{relatedTarget:0}),SA=Bc(ule),fle=so({},s0,{animationName:0,elapsedTime:0,pseudoElement:0}),mle=Bc(fle),hle=so({},s0,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ple=Bc(hle),gle=so({},s0,{data:0}),CL=Bc(gle),vle={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xle={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yle={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ble(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=yle[e])?!!t[e]:!1}function S3(){return ble}var wle=so({},a1,{key:function(e){if(e.key){var t=vle[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ij(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xle[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:S3,charCode:function(e){return e.type==="keypress"?Ij(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ij(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jle=Bc(wle),_le=so({},LS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),AL=Bc(_le),Nle=so({},a1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:S3}),Sle=Bc(Nle),Cle=so({},s0,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ale=Bc(Cle),Ple=so({},LS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ele=Bc(Ple),kle=[9,13,27,32],C3=Ff&&"CompositionEvent"in window,Ry=null;Ff&&"documentMode"in document&&(Ry=document.documentMode);var Ile=Ff&&"TextEvent"in window&&!Ry,ZV=Ff&&(!C3||Ry&&8<Ry&&11>=Ry),PL=String.fromCharCode(32),EL=!1;function eW(e,t){switch(e){case"keyup":return kle.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tW(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var wv=!1;function Ole(e,t){switch(e){case"compositionend":return tW(t);case"keypress":return t.which!==32?null:(EL=!0,PL);case"textInput":return e=t.data,e===PL&&EL?null:e;default:return null}}function Tle(e,t){if(wv)return e==="compositionend"||!C3&&eW(e,t)?(e=QV(),kj=_3=Bm=null,wv=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ZV&&t.locale!=="ko"?null:t.data;default:return null}}var Dle={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kL(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Dle[e.type]:t==="textarea"}function rW(e,t,r,n){TV(n),t=m_(t,"onChange"),0<t.length&&(r=new N3("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ly=null,kb=null;function Mle(e){mW(e,0)}function FS(e){var t=Nv(e);if(CV(t))return e}function Rle(e,t){if(e==="change")return t}var nW=!1;if(Ff){var CA;if(Ff){var AA="oninput"in document;if(!AA){var IL=document.createElement("div");IL.setAttribute("oninput","return;"),AA=typeof IL.oninput=="function"}CA=AA}else CA=!1;nW=CA&&(!document.documentMode||9<document.documentMode)}function OL(){Ly&&(Ly.detachEvent("onpropertychange",aW),kb=Ly=null)}function aW(e){if(e.propertyName==="value"&&FS(kb)){var t=[];rW(t,kb,e,x3(e)),LV(Mle,t)}}function Lle(e,t,r){e==="focusin"?(OL(),Ly=t,kb=r,Ly.attachEvent("onpropertychange",aW)):e==="focusout"&&OL()}function Fle(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return FS(kb)}function $le(e,t){if(e==="click")return FS(t)}function Ble(e,t){if(e==="input"||e==="change")return FS(t)}function qle(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var lu=typeof Object.is=="function"?Object.is:qle;function Ib(e,t){if(lu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!ak.call(t,s)||!lu(e[s],t[s]))return!1}return!0}function TL(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function DL(e,t){var r=TL(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=TL(r)}}function sW(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?sW(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function oW(){for(var e=window,t=o_();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=o_(e.document)}return t}function A3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function zle(e){var t=oW(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&sW(r.ownerDocument.documentElement,r)){if(n!==null&&A3(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,o=Math.min(n.start,s);n=n.end===void 0?o:Math.min(n.end,s),!e.extend&&o>n&&(s=n,n=o,o=s),s=DL(r,o);var i=DL(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ule=Ff&&"documentMode"in document&&11>=document.documentMode,jv=null,_k=null,Fy=null,Nk=!1;function ML(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Nk||jv==null||jv!==o_(n)||(n=jv,"selectionStart"in n&&A3(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Fy&&Ib(Fy,n)||(Fy=n,n=m_(_k,"onSelect"),0<n.length&&(t=new N3("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=jv)))}function p2(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var _v={animationend:p2("Animation","AnimationEnd"),animationiteration:p2("Animation","AnimationIteration"),animationstart:p2("Animation","AnimationStart"),transitionend:p2("Transition","TransitionEnd")},PA={},iW={};Ff&&(iW=document.createElement("div").style,"AnimationEvent"in window||(delete _v.animationend.animation,delete _v.animationiteration.animation,delete _v.animationstart.animation),"TransitionEvent"in window||delete _v.transitionend.transition);function $S(e){if(PA[e])return PA[e];if(!_v[e])return e;var t=_v[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in iW)return PA[e]=t[r];return e}var lW=$S("animationend"),cW=$S("animationiteration"),dW=$S("animationstart"),uW=$S("transitionend"),fW=new Map,RL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Th(e,t){fW.set(e,t),xg(t,[e])}for(var EA=0;EA<RL.length;EA++){var kA=RL[EA],Vle=kA.toLowerCase(),Wle=kA[0].toUpperCase()+kA.slice(1);Th(Vle,"on"+Wle)}Th(lW,"onAnimationEnd");Th(cW,"onAnimationIteration");Th(dW,"onAnimationStart");Th("dblclick","onDoubleClick");Th("focusin","onFocus");Th("focusout","onBlur");Th(uW,"onTransitionEnd");dx("onMouseEnter",["mouseout","mouseover"]);dx("onMouseLeave",["mouseout","mouseover"]);dx("onPointerEnter",["pointerout","pointerover"]);dx("onPointerLeave",["pointerout","pointerover"]);xg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xg("onBeforeInput",["compositionend","keypress","textInput","paste"]);xg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hle=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cy));function LL(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Vie(n,t,void 0,e),e.currentTarget=null}function mW(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var i=n.length-1;0<=i;i--){var l=n[i],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;LL(s,l,d),o=c}else for(i=0;i<n.length;i++){if(l=n[i],c=l.instance,d=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;LL(s,l,d),o=c}}}if(l_)throw e=yk,l_=!1,yk=null,e}function $s(e,t){var r=t[Ek];r===void 0&&(r=t[Ek]=new Set);var n=e+"__bubble";r.has(n)||(hW(t,e,2,!1),r.add(n))}function IA(e,t,r){var n=0;t&&(n|=4),hW(r,e,n,t)}var g2="_reactListening"+Math.random().toString(36).slice(2);function Ob(e){if(!e[g2]){e[g2]=!0,wV.forEach(function(r){r!=="selectionchange"&&(Hle.has(r)||IA(r,!1,e),IA(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[g2]||(t[g2]=!0,IA("selectionchange",!1,t))}}function hW(e,t,r,n){switch(JV(t)){case 1:var s=ole;break;case 4:s=ile;break;default:s=j3}r=s.bind(null,t,r,e),s=void 0,!xk||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function OA(e,t,r,n,s){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;l!==null;){if(i=bp(l),i===null)return;if(c=i.tag,c===5||c===6){n=o=i;continue e}l=l.parentNode}}n=n.return}LV(function(){var d=o,u=x3(r),f=[];e:{var h=fW.get(e);if(h!==void 0){var m=N3,v=e;switch(e){case"keypress":if(Ij(r)===0)break e;case"keydown":case"keyup":m=jle;break;case"focusin":v="focus",m=SA;break;case"focusout":v="blur",m=SA;break;case"beforeblur":case"afterblur":m=SA;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=SL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=dle;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Sle;break;case lW:case cW:case dW:m=mle;break;case uW:m=Ale;break;case"scroll":m=lle;break;case"wheel":m=Ele;break;case"copy":case"cut":case"paste":m=ple;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=AL}var g=(t&4)!==0,y=!g&&e==="scroll",x=g?h!==null?h+"Capture":null:h;g=[];for(var b=d,w;b!==null;){w=b;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,x!==null&&(j=Cb(b,x),j!=null&&g.push(Tb(b,j,w)))),y)break;b=b.return}0<g.length&&(h=new m(h,v,null,r,u),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==gk&&(v=r.relatedTarget||r.fromElement)&&(bp(v)||v[$f]))break e;if((m||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=d,v=v?bp(v):null,v!==null&&(y=yg(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=d),m!==v)){if(g=SL,j="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=AL,j="onPointerLeave",x="onPointerEnter",b="pointer"),y=m==null?h:Nv(m),w=v==null?h:Nv(v),h=new g(j,b+"leave",m,r,u),h.target=y,h.relatedTarget=w,j=null,bp(u)===d&&(g=new g(x,b+"enter",v,r,u),g.target=w,g.relatedTarget=y,j=g),y=j,m&&v)t:{for(g=m,x=v,b=0,w=g;w;w=Fg(w))b++;for(w=0,j=x;j;j=Fg(j))w++;for(;0<b-w;)g=Fg(g),b--;for(;0<w-b;)x=Fg(x),w--;for(;b--;){if(g===x||x!==null&&g===x.alternate)break t;g=Fg(g),x=Fg(x)}g=null}else g=null;m!==null&&FL(f,h,m,g,!1),v!==null&&y!==null&&FL(f,y,v,g,!0)}}e:{if(h=d?Nv(d):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var _=Rle;else if(kL(h))if(nW)_=Ble;else{_=Fle;var C=Lle}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=$le);if(_&&(_=_(e,d))){rW(f,_,r,u);break e}C&&C(e,h,d),e==="focusout"&&(C=h._wrapperState)&&C.controlled&&h.type==="number"&&uk(h,"number",h.value)}switch(C=d?Nv(d):window,e){case"focusin":(kL(C)||C.contentEditable==="true")&&(jv=C,_k=d,Fy=null);break;case"focusout":Fy=_k=jv=null;break;case"mousedown":Nk=!0;break;case"contextmenu":case"mouseup":case"dragend":Nk=!1,ML(f,r,u);break;case"selectionchange":if(Ule)break;case"keydown":case"keyup":ML(f,r,u)}var P;if(C3)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else wv?eW(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(ZV&&r.locale!=="ko"&&(wv||E!=="onCompositionStart"?E==="onCompositionEnd"&&wv&&(P=QV()):(Bm=u,_3="value"in Bm?Bm.value:Bm.textContent,wv=!0)),C=m_(d,E),0<C.length&&(E=new CL(E,e,null,r,u),f.push({event:E,listeners:C}),P?E.data=P:(P=tW(r),P!==null&&(E.data=P)))),(P=Ile?Ole(e,r):Tle(e,r))&&(d=m_(d,"onBeforeInput"),0<d.length&&(u=new CL("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=P))}mW(f,t)})}function Tb(e,t,r){return{instance:e,listener:t,currentTarget:r}}function m_(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Cb(e,r),o!=null&&n.unshift(Tb(e,o,s)),o=Cb(e,t),o!=null&&n.push(Tb(e,o,s))),e=e.return}return n}function Fg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function FL(e,t,r,n,s){for(var o=t._reactName,i=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,s?(c=Cb(r,o),c!=null&&i.unshift(Tb(r,c,l))):s||(c=Cb(r,o),c!=null&&i.push(Tb(r,c,l)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Gle=/\r\n?/g,Kle=/\u0000|\uFFFD/g;function $L(e){return(typeof e=="string"?e:""+e).replace(Gle,`
`).replace(Kle,"")}function v2(e,t,r){if(t=$L(t),$L(e)!==t&&r)throw Error(en(425))}function h_(){}var Sk=null,Ck=null;function Ak(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Pk=typeof setTimeout=="function"?setTimeout:void 0,Xle=typeof clearTimeout=="function"?clearTimeout:void 0,BL=typeof Promise=="function"?Promise:void 0,Yle=typeof queueMicrotask=="function"?queueMicrotask:typeof BL<"u"?function(e){return BL.resolve(null).then(e).catch(Jle)}:Pk;function Jle(e){setTimeout(function(){throw e})}function TA(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Eb(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Eb(t)}function eh(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qL(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var o0=Math.random().toString(36).slice(2),Eu="__reactFiber$"+o0,Db="__reactProps$"+o0,$f="__reactContainer$"+o0,Ek="__reactEvents$"+o0,Qle="__reactListeners$"+o0,Zle="__reactHandles$"+o0;function bp(e){var t=e[Eu];if(t)return t;for(var r=e.parentNode;r;){if(t=r[$f]||r[Eu]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=qL(e);e!==null;){if(r=e[Eu])return r;e=qL(e)}return t}e=r,r=e.parentNode}return null}function s1(e){return e=e[Eu]||e[$f],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Nv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(en(33))}function BS(e){return e[Db]||null}var kk=[],Sv=-1;function Dh(e){return{current:e}}function Us(e){0>Sv||(e.current=kk[Sv],kk[Sv]=null,Sv--)}function Is(e,t){Sv++,kk[Sv]=e.current,e.current=t}var wh={},rl=Dh(wh),Xl=Dh(!1),Jp=wh;function ux(e,t){var r=e.type.contextTypes;if(!r)return wh;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in r)s[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Yl(e){return e=e.childContextTypes,e!=null}function p_(){Us(Xl),Us(rl)}function zL(e,t,r){if(rl.current!==wh)throw Error(en(168));Is(rl,t),Is(Xl,r)}function pW(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(en(108,Lie(e)||"Unknown",s));return so({},r,n)}function g_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wh,Jp=rl.current,Is(rl,e),Is(Xl,Xl.current),!0}function UL(e,t,r){var n=e.stateNode;if(!n)throw Error(en(169));r?(e=pW(e,t,Jp),n.__reactInternalMemoizedMergedChildContext=e,Us(Xl),Us(rl),Is(rl,e)):Us(Xl),Is(Xl,r)}var jf=null,qS=!1,DA=!1;function gW(e){jf===null?jf=[e]:jf.push(e)}function ece(e){qS=!0,gW(e)}function Mh(){if(!DA&&jf!==null){DA=!0;var e=0,t=us;try{var r=jf;for(us=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}jf=null,qS=!1}catch(s){throw jf!==null&&(jf=jf.slice(e+1)),qV(y3,Mh),s}finally{us=t,DA=!1}}return null}var Cv=[],Av=0,v_=null,x_=0,rd=[],nd=0,Qp=null,Cf=1,Af="";function ap(e,t){Cv[Av++]=x_,Cv[Av++]=v_,v_=e,x_=t}function vW(e,t,r){rd[nd++]=Cf,rd[nd++]=Af,rd[nd++]=Qp,Qp=e;var n=Cf;e=Af;var s=32-nu(n)-1;n&=~(1<<s),r+=1;var o=32-nu(t)+s;if(30<o){var i=s-s%5;o=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Cf=1<<32-nu(t)+s|r<<s|n,Af=o+e}else Cf=1<<o|r<<s|n,Af=e}function P3(e){e.return!==null&&(ap(e,1),vW(e,1,0))}function E3(e){for(;e===v_;)v_=Cv[--Av],Cv[Av]=null,x_=Cv[--Av],Cv[Av]=null;for(;e===Qp;)Qp=rd[--nd],rd[nd]=null,Af=rd[--nd],rd[nd]=null,Cf=rd[--nd],rd[nd]=null}var kc=null,Nc=null,Ks=!1,Jd=null;function xW(e,t){var r=fd(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function VL(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,kc=e,Nc=eh(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,kc=e,Nc=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Qp!==null?{id:Cf,overflow:Af}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=fd(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,kc=e,Nc=null,!0):!1;default:return!1}}function Ik(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ok(e){if(Ks){var t=Nc;if(t){var r=t;if(!VL(e,t)){if(Ik(e))throw Error(en(418));t=eh(r.nextSibling);var n=kc;t&&VL(e,t)?xW(n,r):(e.flags=e.flags&-4097|2,Ks=!1,kc=e)}}else{if(Ik(e))throw Error(en(418));e.flags=e.flags&-4097|2,Ks=!1,kc=e}}}function WL(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;kc=e}function x2(e){if(e!==kc)return!1;if(!Ks)return WL(e),Ks=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ak(e.type,e.memoizedProps)),t&&(t=Nc)){if(Ik(e))throw yW(),Error(en(418));for(;t;)xW(e,t),t=eh(t.nextSibling)}if(WL(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(en(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Nc=eh(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Nc=null}}else Nc=kc?eh(e.stateNode.nextSibling):null;return!0}function yW(){for(var e=Nc;e;)e=eh(e.nextSibling)}function fx(){Nc=kc=null,Ks=!1}function k3(e){Jd===null?Jd=[e]:Jd.push(e)}var tce=Zf.ReactCurrentBatchConfig;function X0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(en(309));var n=r.stateNode}if(!n)throw Error(en(147,e));var s=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(en(284));if(!r._owner)throw Error(en(290,e))}return e}function y2(e,t){throw e=Object.prototype.toString.call(t),Error(en(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function HL(e){var t=e._init;return t(e._payload)}function bW(e){function t(x,b){if(e){var w=x.deletions;w===null?(x.deletions=[b],x.flags|=16):w.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function s(x,b){return x=ah(x,b),x.index=0,x.sibling=null,x}function o(x,b,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<b?(x.flags|=2,b):w):(x.flags|=2,b)):(x.flags|=1048576,b)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,b,w,j){return b===null||b.tag!==6?(b=qA(w,x.mode,j),b.return=x,b):(b=s(b,w),b.return=x,b)}function c(x,b,w,j){var _=w.type;return _===bv?u(x,b,w.props.children,j,w.key):b!==null&&(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Pm&&HL(_)===b.type)?(j=s(b,w.props),j.ref=X0(x,b,w),j.return=x,j):(j=Fj(w.type,w.key,w.props,null,x.mode,j),j.ref=X0(x,b,w),j.return=x,j)}function d(x,b,w,j){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=zA(w,x.mode,j),b.return=x,b):(b=s(b,w.children||[]),b.return=x,b)}function u(x,b,w,j,_){return b===null||b.tag!==7?(b=Lp(w,x.mode,j,_),b.return=x,b):(b=s(b,w),b.return=x,b)}function f(x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=qA(""+b,x.mode,w),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case l2:return w=Fj(b.type,b.key,b.props,null,x.mode,w),w.ref=X0(x,null,b),w.return=x,w;case yv:return b=zA(b,x.mode,w),b.return=x,b;case Pm:var j=b._init;return f(x,j(b._payload),w)}if(Ny(b)||V0(b))return b=Lp(b,x.mode,w,null),b.return=x,b;y2(x,b)}return null}function h(x,b,w,j){var _=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:l(x,b,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case l2:return w.key===_?c(x,b,w,j):null;case yv:return w.key===_?d(x,b,w,j):null;case Pm:return _=w._init,h(x,b,_(w._payload),j)}if(Ny(w)||V0(w))return _!==null?null:u(x,b,w,j,null);y2(x,w)}return null}function m(x,b,w,j,_){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(w)||null,l(b,x,""+j,_);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case l2:return x=x.get(j.key===null?w:j.key)||null,c(b,x,j,_);case yv:return x=x.get(j.key===null?w:j.key)||null,d(b,x,j,_);case Pm:var C=j._init;return m(x,b,w,C(j._payload),_)}if(Ny(j)||V0(j))return x=x.get(w)||null,u(b,x,j,_,null);y2(b,j)}return null}function v(x,b,w,j){for(var _=null,C=null,P=b,E=b=0,A=null;P!==null&&E<w.length;E++){P.index>E?(A=P,P=null):A=P.sibling;var F=h(x,P,w[E],j);if(F===null){P===null&&(P=A);break}e&&P&&F.alternate===null&&t(x,P),b=o(F,b,E),C===null?_=F:C.sibling=F,C=F,P=A}if(E===w.length)return r(x,P),Ks&&ap(x,E),_;if(P===null){for(;E<w.length;E++)P=f(x,w[E],j),P!==null&&(b=o(P,b,E),C===null?_=P:C.sibling=P,C=P);return Ks&&ap(x,E),_}for(P=n(x,P);E<w.length;E++)A=m(P,x,E,w[E],j),A!==null&&(e&&A.alternate!==null&&P.delete(A.key===null?E:A.key),b=o(A,b,E),C===null?_=A:C.sibling=A,C=A);return e&&P.forEach(function(D){return t(x,D)}),Ks&&ap(x,E),_}function g(x,b,w,j){var _=V0(w);if(typeof _!="function")throw Error(en(150));if(w=_.call(w),w==null)throw Error(en(151));for(var C=_=null,P=b,E=b=0,A=null,F=w.next();P!==null&&!F.done;E++,F=w.next()){P.index>E?(A=P,P=null):A=P.sibling;var D=h(x,P,F.value,j);if(D===null){P===null&&(P=A);break}e&&P&&D.alternate===null&&t(x,P),b=o(D,b,E),C===null?_=D:C.sibling=D,C=D,P=A}if(F.done)return r(x,P),Ks&&ap(x,E),_;if(P===null){for(;!F.done;E++,F=w.next())F=f(x,F.value,j),F!==null&&(b=o(F,b,E),C===null?_=F:C.sibling=F,C=F);return Ks&&ap(x,E),_}for(P=n(x,P);!F.done;E++,F=w.next())F=m(P,x,E,F.value,j),F!==null&&(e&&F.alternate!==null&&P.delete(F.key===null?E:F.key),b=o(F,b,E),C===null?_=F:C.sibling=F,C=F);return e&&P.forEach(function(I){return t(x,I)}),Ks&&ap(x,E),_}function y(x,b,w,j){if(typeof w=="object"&&w!==null&&w.type===bv&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case l2:e:{for(var _=w.key,C=b;C!==null;){if(C.key===_){if(_=w.type,_===bv){if(C.tag===7){r(x,C.sibling),b=s(C,w.props.children),b.return=x,x=b;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Pm&&HL(_)===C.type){r(x,C.sibling),b=s(C,w.props),b.ref=X0(x,C,w),b.return=x,x=b;break e}r(x,C);break}else t(x,C);C=C.sibling}w.type===bv?(b=Lp(w.props.children,x.mode,j,w.key),b.return=x,x=b):(j=Fj(w.type,w.key,w.props,null,x.mode,j),j.ref=X0(x,b,w),j.return=x,x=j)}return i(x);case yv:e:{for(C=w.key;b!==null;){if(b.key===C)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(x,b.sibling),b=s(b,w.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=zA(w,x.mode,j),b.return=x,x=b}return i(x);case Pm:return C=w._init,y(x,b,C(w._payload),j)}if(Ny(w))return v(x,b,w,j);if(V0(w))return g(x,b,w,j);y2(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(x,b.sibling),b=s(b,w),b.return=x,x=b):(r(x,b),b=qA(w,x.mode,j),b.return=x,x=b),i(x)):r(x,b)}return y}var mx=bW(!0),wW=bW(!1),y_=Dh(null),b_=null,Pv=null,I3=null;function O3(){I3=Pv=b_=null}function T3(e){var t=y_.current;Us(y_),e._currentValue=t}function Tk(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Gv(e,t){b_=e,I3=Pv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wl=!0),e.firstContext=null)}function _d(e){var t=e._currentValue;if(I3!==e)if(e={context:e,memoizedValue:t,next:null},Pv===null){if(b_===null)throw Error(en(308));Pv=e,b_.dependencies={lanes:0,firstContext:e}}else Pv=Pv.next=e;return t}var wp=null;function D3(e){wp===null?wp=[e]:wp.push(e)}function jW(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,D3(t)):(r.next=s.next,s.next=r),t.interleaved=r,Bf(e,n)}function Bf(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Em=!1;function M3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _W(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Tf(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function th(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ya&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Bf(e,r)}return s=n.interleaved,s===null?(t.next=t,D3(n)):(t.next=s.next,s.next=t),n.interleaved=t,Bf(e,r)}function Oj(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,b3(e,r)}}function GL(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?s=o=i:o=o.next=i,r=r.next}while(r!==null);o===null?s=o=t:o=o.next=t}else s=o=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function w_(e,t,r,n){var s=e.updateQueue;Em=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,i===null?o=d:i.next=d,i=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==i&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(o!==null){var f=s.baseState;i=0,u=d=c=null,l=o;do{var h=l.lane,m=l.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(h=t,m=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){f=v.call(m,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,h=typeof v=="function"?v.call(m,f,h):v,h==null)break e;f=so({},f,h);break e;case 2:Em=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=m,c=f):u=u.next=m,i|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(1);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);eg|=i,e.lanes=i,e.memoizedState=f}}function KL(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(en(191,s));s.call(n)}}}var o1={},qu=Dh(o1),Mb=Dh(o1),Rb=Dh(o1);function jp(e){if(e===o1)throw Error(en(174));return e}function R3(e,t){switch(Is(Rb,t),Is(Mb,e),Is(qu,o1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:mk(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=mk(t,e)}Us(qu),Is(qu,t)}function hx(){Us(qu),Us(Mb),Us(Rb)}function NW(e){jp(Rb.current);var t=jp(qu.current),r=mk(t,e.type);t!==r&&(Is(Mb,e),Is(qu,r))}function L3(e){Mb.current===e&&(Us(qu),Us(Mb))}var eo=Dh(0);function j_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var MA=[];function F3(){for(var e=0;e<MA.length;e++)MA[e]._workInProgressVersionPrimary=null;MA.length=0}var Tj=Zf.ReactCurrentDispatcher,RA=Zf.ReactCurrentBatchConfig,Zp=0,no=null,Wo=null,ii=null,__=!1,$y=!1,Lb=0,rce=0;function zi(){throw Error(en(321))}function $3(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!lu(e[r],t[r]))return!1;return!0}function B3(e,t,r,n,s,o){if(Zp=o,no=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Tj.current=e===null||e.memoizedState===null?oce:ice,e=r(n,s),$y){o=0;do{if($y=!1,Lb=0,25<=o)throw Error(en(301));o+=1,ii=Wo=null,t.updateQueue=null,Tj.current=lce,e=r(n,s)}while($y)}if(Tj.current=N_,t=Wo!==null&&Wo.next!==null,Zp=0,ii=Wo=no=null,__=!1,t)throw Error(en(300));return e}function q3(){var e=Lb!==0;return Lb=0,e}function Au(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ii===null?no.memoizedState=ii=e:ii=ii.next=e,ii}function Nd(){if(Wo===null){var e=no.alternate;e=e!==null?e.memoizedState:null}else e=Wo.next;var t=ii===null?no.memoizedState:ii.next;if(t!==null)ii=t,Wo=e;else{if(e===null)throw Error(en(310));Wo=e,e={memoizedState:Wo.memoizedState,baseState:Wo.baseState,baseQueue:Wo.baseQueue,queue:Wo.queue,next:null},ii===null?no.memoizedState=ii=e:ii=ii.next=e}return ii}function Fb(e,t){return typeof t=="function"?t(e):t}function LA(e){var t=Nd(),r=t.queue;if(r===null)throw Error(en(311));r.lastRenderedReducer=e;var n=Wo,s=n.baseQueue,o=r.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}n.baseQueue=s=o,r.pending=null}if(s!==null){o=s.next,n=n.baseState;var l=i=null,c=null,d=o;do{var u=d.lane;if((Zp&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,i=n):c=c.next=f,no.lanes|=u,eg|=u}d=d.next}while(d!==null&&d!==o);c===null?i=n:c.next=l,lu(n,t.memoizedState)||(Wl=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do o=s.lane,no.lanes|=o,eg|=o,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function FA(e){var t=Nd(),r=t.queue;if(r===null)throw Error(en(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,o=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);lu(o,t.memoizedState)||(Wl=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function SW(){}function CW(e,t){var r=no,n=Nd(),s=t(),o=!lu(n.memoizedState,s);if(o&&(n.memoizedState=s,Wl=!0),n=n.queue,z3(EW.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||ii!==null&&ii.memoizedState.tag&1){if(r.flags|=2048,$b(9,PW.bind(null,r,n,s,t),void 0,null),fi===null)throw Error(en(349));Zp&30||AW(r,t,s)}return s}function AW(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=no.updateQueue,t===null?(t={lastEffect:null,stores:null},no.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function PW(e,t,r,n){t.value=r,t.getSnapshot=n,kW(t)&&IW(e)}function EW(e,t,r){return r(function(){kW(t)&&IW(e)})}function kW(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!lu(e,r)}catch{return!0}}function IW(e){var t=Bf(e,1);t!==null&&au(t,e,1,-1)}function XL(e){var t=Au();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fb,lastRenderedState:e},t.queue=e,e=e.dispatch=sce.bind(null,no,e),[t.memoizedState,e]}function $b(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=no.updateQueue,t===null?(t={lastEffect:null,stores:null},no.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function OW(){return Nd().memoizedState}function Dj(e,t,r,n){var s=Au();no.flags|=e,s.memoizedState=$b(1|t,r,void 0,n===void 0?null:n)}function zS(e,t,r,n){var s=Nd();n=n===void 0?null:n;var o=void 0;if(Wo!==null){var i=Wo.memoizedState;if(o=i.destroy,n!==null&&$3(n,i.deps)){s.memoizedState=$b(t,r,o,n);return}}no.flags|=e,s.memoizedState=$b(1|t,r,o,n)}function YL(e,t){return Dj(8390656,8,e,t)}function z3(e,t){return zS(2048,8,e,t)}function TW(e,t){return zS(4,2,e,t)}function DW(e,t){return zS(4,4,e,t)}function MW(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function RW(e,t,r){return r=r!=null?r.concat([e]):null,zS(4,4,MW.bind(null,t,e),r)}function U3(){}function LW(e,t){var r=Nd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&$3(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function FW(e,t){var r=Nd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&$3(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function $W(e,t,r){return Zp&21?(lu(r,t)||(r=VV(),no.lanes|=r,eg|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wl=!0),e.memoizedState=r)}function nce(e,t){var r=us;us=r!==0&&4>r?r:4,e(!0);var n=RA.transition;RA.transition={};try{e(!1),t()}finally{us=r,RA.transition=n}}function BW(){return Nd().memoizedState}function ace(e,t,r){var n=nh(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},qW(e))zW(t,r);else if(r=jW(e,t,r,n),r!==null){var s=Nl();au(r,e,n,s),UW(r,t,n)}}function sce(e,t,r){var n=nh(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(qW(e))zW(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,l=o(i,r);if(s.hasEagerState=!0,s.eagerState=l,lu(l,i)){var c=t.interleaved;c===null?(s.next=s,D3(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=jW(e,t,s,n),r!==null&&(s=Nl(),au(r,e,n,s),UW(r,t,n))}}function qW(e){var t=e.alternate;return e===no||t!==null&&t===no}function zW(e,t){$y=__=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function UW(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,b3(e,r)}}var N_={readContext:_d,useCallback:zi,useContext:zi,useEffect:zi,useImperativeHandle:zi,useInsertionEffect:zi,useLayoutEffect:zi,useMemo:zi,useReducer:zi,useRef:zi,useState:zi,useDebugValue:zi,useDeferredValue:zi,useTransition:zi,useMutableSource:zi,useSyncExternalStore:zi,useId:zi,unstable_isNewReconciler:!1},oce={readContext:_d,useCallback:function(e,t){return Au().memoizedState=[e,t===void 0?null:t],e},useContext:_d,useEffect:YL,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Dj(4194308,4,MW.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Dj(4194308,4,e,t)},useInsertionEffect:function(e,t){return Dj(4,2,e,t)},useMemo:function(e,t){var r=Au();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Au();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ace.bind(null,no,e),[n.memoizedState,e]},useRef:function(e){var t=Au();return e={current:e},t.memoizedState=e},useState:XL,useDebugValue:U3,useDeferredValue:function(e){return Au().memoizedState=e},useTransition:function(){var e=XL(!1),t=e[0];return e=nce.bind(null,e[1]),Au().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=no,s=Au();if(Ks){if(r===void 0)throw Error(en(407));r=r()}else{if(r=t(),fi===null)throw Error(en(349));Zp&30||AW(n,t,r)}s.memoizedState=r;var o={value:r,getSnapshot:t};return s.queue=o,YL(EW.bind(null,n,o,e),[e]),n.flags|=2048,$b(9,PW.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=Au(),t=fi.identifierPrefix;if(Ks){var r=Af,n=Cf;r=(n&~(1<<32-nu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Lb++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=rce++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ice={readContext:_d,useCallback:LW,useContext:_d,useEffect:z3,useImperativeHandle:RW,useInsertionEffect:TW,useLayoutEffect:DW,useMemo:FW,useReducer:LA,useRef:OW,useState:function(){return LA(Fb)},useDebugValue:U3,useDeferredValue:function(e){var t=Nd();return $W(t,Wo.memoizedState,e)},useTransition:function(){var e=LA(Fb)[0],t=Nd().memoizedState;return[e,t]},useMutableSource:SW,useSyncExternalStore:CW,useId:BW,unstable_isNewReconciler:!1},lce={readContext:_d,useCallback:LW,useContext:_d,useEffect:z3,useImperativeHandle:RW,useInsertionEffect:TW,useLayoutEffect:DW,useMemo:FW,useReducer:FA,useRef:OW,useState:function(){return FA(Fb)},useDebugValue:U3,useDeferredValue:function(e){var t=Nd();return Wo===null?t.memoizedState=e:$W(t,Wo.memoizedState,e)},useTransition:function(){var e=FA(Fb)[0],t=Nd().memoizedState;return[e,t]},useMutableSource:SW,useSyncExternalStore:CW,useId:BW,unstable_isNewReconciler:!1};function Hd(e,t){if(e&&e.defaultProps){t=so({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Dk(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:so({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var US={isMounted:function(e){return(e=e._reactInternals)?yg(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Nl(),s=nh(e),o=Tf(n,s);o.payload=t,r!=null&&(o.callback=r),t=th(e,o,s),t!==null&&(au(t,e,s,n),Oj(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Nl(),s=nh(e),o=Tf(n,s);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=th(e,o,s),t!==null&&(au(t,e,s,n),Oj(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Nl(),n=nh(e),s=Tf(r,n);s.tag=2,t!=null&&(s.callback=t),t=th(e,s,n),t!==null&&(au(t,e,n,r),Oj(t,e,n))}};function JL(e,t,r,n,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,i):t.prototype&&t.prototype.isPureReactComponent?!Ib(r,n)||!Ib(s,o):!0}function VW(e,t,r){var n=!1,s=wh,o=t.contextType;return typeof o=="object"&&o!==null?o=_d(o):(s=Yl(t)?Jp:rl.current,n=t.contextTypes,o=(n=n!=null)?ux(e,s):wh),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=US,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function QL(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&US.enqueueReplaceState(t,t.state,null)}function Mk(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},M3(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=_d(o):(o=Yl(t)?Jp:rl.current,s.context=ux(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Dk(e,t,o,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&US.enqueueReplaceState(s,s.state,null),w_(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function px(e,t){try{var r="",n=t;do r+=Rie(n),n=n.return;while(n);var s=r}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function $A(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Rk(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var cce=typeof WeakMap=="function"?WeakMap:Map;function WW(e,t,r){r=Tf(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){C_||(C_=!0,Hk=n),Rk(e,t)},r}function HW(e,t,r){r=Tf(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Rk(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){Rk(e,t),typeof n!="function"&&(rh===null?rh=new Set([this]):rh.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function ZL(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new cce;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=_ce.bind(null,e,t,r),t.then(e,e))}function eF(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function tF(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Tf(-1,1),t.tag=2,th(r,t,1))),r.lanes|=1),e)}var dce=Zf.ReactCurrentOwner,Wl=!1;function vl(e,t,r,n){t.child=e===null?wW(t,null,r,n):mx(t,e.child,r,n)}function rF(e,t,r,n,s){r=r.render;var o=t.ref;return Gv(t,s),n=B3(e,t,r,n,o,s),r=q3(),e!==null&&!Wl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,qf(e,t,s)):(Ks&&r&&P3(t),t.flags|=1,vl(e,t,n,s),t.child)}function nF(e,t,r,n,s){if(e===null){var o=r.type;return typeof o=="function"&&!J3(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,GW(e,t,o,n,s)):(e=Fj(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(r=r.compare,r=r!==null?r:Ib,r(i,n)&&e.ref===t.ref)return qf(e,t,s)}return t.flags|=1,e=ah(o,n),e.ref=t.ref,e.return=t,t.child=e}function GW(e,t,r,n,s){if(e!==null){var o=e.memoizedProps;if(Ib(o,n)&&e.ref===t.ref)if(Wl=!1,t.pendingProps=n=o,(e.lanes&s)!==0)e.flags&131072&&(Wl=!0);else return t.lanes=e.lanes,qf(e,t,s)}return Lk(e,t,r,n,s)}function KW(e,t,r){var n=t.pendingProps,s=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Is(kv,yc),yc|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Is(kv,yc),yc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Is(kv,yc),yc|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,Is(kv,yc),yc|=n;return vl(e,t,s,r),t.child}function XW(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Lk(e,t,r,n,s){var o=Yl(r)?Jp:rl.current;return o=ux(t,o),Gv(t,s),r=B3(e,t,r,n,o,s),n=q3(),e!==null&&!Wl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,qf(e,t,s)):(Ks&&n&&P3(t),t.flags|=1,vl(e,t,r,s),t.child)}function aF(e,t,r,n,s){if(Yl(r)){var o=!0;g_(t)}else o=!1;if(Gv(t,s),t.stateNode===null)Mj(e,t),VW(t,r,n),Mk(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,d=r.contextType;typeof d=="object"&&d!==null?d=_d(d):(d=Yl(r)?Jp:rl.current,d=ux(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==n||c!==d)&&QL(t,i,n,d),Em=!1;var h=t.memoizedState;i.state=h,w_(t,n,i,s),c=t.memoizedState,l!==n||h!==c||Xl.current||Em?(typeof u=="function"&&(Dk(t,r,u,n),c=t.memoizedState),(l=Em||JL(t,r,l,n,h,c,d))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=d,n=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,_W(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Hd(t.type,l),i.props=d,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=_d(c):(c=Yl(r)?Jp:rl.current,c=ux(t,c));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==f||h!==c)&&QL(t,i,n,c),Em=!1,h=t.memoizedState,i.state=h,w_(t,n,i,s);var v=t.memoizedState;l!==f||h!==v||Xl.current||Em?(typeof m=="function"&&(Dk(t,r,m,n),v=t.memoizedState),(d=Em||JL(t,r,d,n,h,v,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),i.props=n,i.state=v,i.context=c,n=d):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Fk(e,t,r,n,o,s)}function Fk(e,t,r,n,s,o){XW(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&UL(t,r,!1),qf(e,t,o);n=t.stateNode,dce.current=t;var l=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=mx(t,e.child,null,o),t.child=mx(t,null,l,o)):vl(e,t,l,o),t.memoizedState=n.state,s&&UL(t,r,!0),t.child}function YW(e){var t=e.stateNode;t.pendingContext?zL(e,t.pendingContext,t.pendingContext!==t.context):t.context&&zL(e,t.context,!1),R3(e,t.containerInfo)}function sF(e,t,r,n,s){return fx(),k3(s),t.flags|=256,vl(e,t,r,n),t.child}var $k={dehydrated:null,treeContext:null,retryLane:0};function Bk(e){return{baseLanes:e,cachePool:null,transitions:null}}function JW(e,t,r){var n=t.pendingProps,s=eo.current,o=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Is(eo,s&1),e===null)return Ok(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,o?(n=t.mode,o=t.child,i={mode:"hidden",children:i},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=HS(i,n,0,null),e=Lp(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Bk(r),t.memoizedState=$k,e):V3(t,i));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return uce(e,t,i,n,l,s,r);if(o){o=n.fallback,i=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=ah(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=ah(l,o):(o=Lp(o,i,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,i=e.child.memoizedState,i=i===null?Bk(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~r,t.memoizedState=$k,n}return o=e.child,e=o.sibling,n=ah(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function V3(e,t){return t=HS({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function b2(e,t,r,n){return n!==null&&k3(n),mx(t,e.child,null,r),e=V3(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function uce(e,t,r,n,s,o,i){if(r)return t.flags&256?(t.flags&=-257,n=$A(Error(en(422))),b2(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,s=t.mode,n=HS({mode:"visible",children:n.children},s,0,null),o=Lp(o,s,i,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&mx(t,e.child,null,i),t.child.memoizedState=Bk(i),t.memoizedState=$k,o);if(!(t.mode&1))return b2(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,o=Error(en(419)),n=$A(o,n,void 0),b2(e,t,i,n)}if(l=(i&e.childLanes)!==0,Wl||l){if(n=fi,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Bf(e,s),au(n,e,s,-1))}return Y3(),n=$A(Error(en(421))),b2(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Nce.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,Nc=eh(s.nextSibling),kc=t,Ks=!0,Jd=null,e!==null&&(rd[nd++]=Cf,rd[nd++]=Af,rd[nd++]=Qp,Cf=e.id,Af=e.overflow,Qp=t),t=V3(t,n.children),t.flags|=4096,t)}function oF(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Tk(e.return,t,r)}function BA(e,t,r,n,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=s)}function QW(e,t,r){var n=t.pendingProps,s=n.revealOrder,o=n.tail;if(vl(e,t,n.children,r),n=eo.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&oF(e,r,t);else if(e.tag===19)oF(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Is(eo,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&j_(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),BA(t,!1,s,r,o);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&j_(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}BA(t,!0,r,null,o);break;case"together":BA(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Mj(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qf(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),eg|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(en(153));if(t.child!==null){for(e=t.child,r=ah(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ah(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function fce(e,t,r){switch(t.tag){case 3:YW(t),fx();break;case 5:NW(t);break;case 1:Yl(t.type)&&g_(t);break;case 4:R3(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Is(y_,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Is(eo,eo.current&1),t.flags|=128,null):r&t.child.childLanes?JW(e,t,r):(Is(eo,eo.current&1),e=qf(e,t,r),e!==null?e.sibling:null);Is(eo,eo.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return QW(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Is(eo,eo.current),n)break;return null;case 22:case 23:return t.lanes=0,KW(e,t,r)}return qf(e,t,r)}var ZW,qk,eH,tH;ZW=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};qk=function(){};eH=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,jp(qu.current);var o=null;switch(r){case"input":s=ck(e,s),n=ck(e,n),o=[];break;case"select":s=so({},s,{value:void 0}),n=so({},n,{value:void 0}),o=[];break;case"textarea":s=fk(e,s),n=fk(e,n),o=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=h_)}hk(r,n);var i;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Nb.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in n){var c=n[d];if(l=s?.[d],n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(o||(o=[]),o.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Nb.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&$s("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}r&&(o=o||[]).push("style",r);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};tH=function(e,t,r,n){r!==n&&(t.flags|=4)};function Y0(e,t){if(!Ks)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ui(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function mce(e,t,r){var n=t.pendingProps;switch(E3(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ui(t),null;case 1:return Yl(t.type)&&p_(),Ui(t),null;case 3:return n=t.stateNode,hx(),Us(Xl),Us(rl),F3(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(x2(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Jd!==null&&(Xk(Jd),Jd=null))),qk(e,t),Ui(t),null;case 5:L3(t);var s=jp(Rb.current);if(r=t.type,e!==null&&t.stateNode!=null)eH(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(en(166));return Ui(t),null}if(e=jp(qu.current),x2(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Eu]=t,n[Db]=o,e=(t.mode&1)!==0,r){case"dialog":$s("cancel",n),$s("close",n);break;case"iframe":case"object":case"embed":$s("load",n);break;case"video":case"audio":for(s=0;s<Cy.length;s++)$s(Cy[s],n);break;case"source":$s("error",n);break;case"img":case"image":case"link":$s("error",n),$s("load",n);break;case"details":$s("toggle",n);break;case"input":pL(n,o),$s("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},$s("invalid",n);break;case"textarea":vL(n,o),$s("invalid",n)}hk(r,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?n.textContent!==l&&(o.suppressHydrationWarning!==!0&&v2(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&v2(n.textContent,l,e),s=["children",""+l]):Nb.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&$s("scroll",n)}switch(r){case"input":c2(n),gL(n,o,!0);break;case"textarea":c2(n),xL(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=h_)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=EV(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Eu]=t,e[Db]=n,ZW(e,t,!1,!1),t.stateNode=e;e:{switch(i=pk(r,n),r){case"dialog":$s("cancel",e),$s("close",e),s=n;break;case"iframe":case"object":case"embed":$s("load",e),s=n;break;case"video":case"audio":for(s=0;s<Cy.length;s++)$s(Cy[s],e);s=n;break;case"source":$s("error",e),s=n;break;case"img":case"image":case"link":$s("error",e),$s("load",e),s=n;break;case"details":$s("toggle",e),s=n;break;case"input":pL(e,n),s=ck(e,n),$s("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=so({},n,{value:void 0}),$s("invalid",e);break;case"textarea":vL(e,n),s=fk(e,n),$s("invalid",e);break;default:s=n}hk(r,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?OV(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&kV(e,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Sb(e,c):typeof c=="number"&&Sb(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Nb.hasOwnProperty(o)?c!=null&&o==="onScroll"&&$s("scroll",e):c!=null&&h3(e,o,c,i))}switch(r){case"input":c2(e),gL(e,n,!1);break;case"textarea":c2(e),xL(e);break;case"option":n.value!=null&&e.setAttribute("value",""+bh(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?Uv(e,!!n.multiple,o,!1):n.defaultValue!=null&&Uv(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=h_)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ui(t),null;case 6:if(e&&t.stateNode!=null)tH(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(en(166));if(r=jp(Rb.current),jp(qu.current),x2(t)){if(n=t.stateNode,r=t.memoizedProps,n[Eu]=t,(o=n.nodeValue!==r)&&(e=kc,e!==null))switch(e.tag){case 3:v2(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&v2(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Eu]=t,t.stateNode=n}return Ui(t),null;case 13:if(Us(eo),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ks&&Nc!==null&&t.mode&1&&!(t.flags&128))yW(),fx(),t.flags|=98560,o=!1;else if(o=x2(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(en(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(en(317));o[Eu]=t}else fx(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ui(t),o=!1}else Jd!==null&&(Xk(Jd),Jd=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||eo.current&1?Yo===0&&(Yo=3):Y3())),t.updateQueue!==null&&(t.flags|=4),Ui(t),null);case 4:return hx(),qk(e,t),e===null&&Ob(t.stateNode.containerInfo),Ui(t),null;case 10:return T3(t.type._context),Ui(t),null;case 17:return Yl(t.type)&&p_(),Ui(t),null;case 19:if(Us(eo),o=t.memoizedState,o===null)return Ui(t),null;if(n=(t.flags&128)!==0,i=o.rendering,i===null)if(n)Y0(o,!1);else{if(Yo!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=j_(e),i!==null){for(t.flags|=128,Y0(o,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Is(eo,eo.current&1|2),t.child}e=e.sibling}o.tail!==null&&bo()>gx&&(t.flags|=128,n=!0,Y0(o,!1),t.lanes=4194304)}else{if(!n)if(e=j_(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Y0(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Ks)return Ui(t),null}else 2*bo()-o.renderingStartTime>gx&&r!==1073741824&&(t.flags|=128,n=!0,Y0(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(r=o.last,r!==null?r.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=bo(),t.sibling=null,r=eo.current,Is(eo,n?r&1|2:r&1),t):(Ui(t),null);case 22:case 23:return X3(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?yc&1073741824&&(Ui(t),t.subtreeFlags&6&&(t.flags|=8192)):Ui(t),null;case 24:return null;case 25:return null}throw Error(en(156,t.tag))}function hce(e,t){switch(E3(t),t.tag){case 1:return Yl(t.type)&&p_(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return hx(),Us(Xl),Us(rl),F3(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return L3(t),null;case 13:if(Us(eo),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(en(340));fx()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Us(eo),null;case 4:return hx(),null;case 10:return T3(t.type._context),null;case 22:case 23:return X3(),null;case 24:return null;default:return null}}var w2=!1,Yi=!1,pce=typeof WeakSet=="function"?WeakSet:Set,Mn=null;function Ev(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){mo(e,t,n)}else r.current=null}function zk(e,t,r){try{r()}catch(n){mo(e,t,n)}}var iF=!1;function gce(e,t){if(Sk=u_,e=oW(),A3(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var m;f!==r||s!==0&&f.nodeType!==3||(l=i+s),f!==o||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++d===s&&(l=i),h===o&&++u===n&&(c=i),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ck={focusedElem:e,selectionRange:r},u_=!1,Mn=t;Mn!==null;)if(t=Mn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Mn=e;else for(;Mn!==null;){t=Mn;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,y=v.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:Hd(t.type,g),y);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(en(163))}}catch(j){mo(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,Mn=e;break}Mn=t.return}return v=iF,iF=!1,v}function By(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&zk(t,r,o)}s=s.next}while(s!==n)}}function VS(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Uk(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function rH(e){var t=e.alternate;t!==null&&(e.alternate=null,rH(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Eu],delete t[Db],delete t[Ek],delete t[Qle],delete t[Zle])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function nH(e){return e.tag===5||e.tag===3||e.tag===4}function lF(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||nH(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=h_));else if(n!==4&&(e=e.child,e!==null))for(Vk(e,t,r),e=e.sibling;e!==null;)Vk(e,t,r),e=e.sibling}function Wk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Wk(e,t,r),e=e.sibling;e!==null;)Wk(e,t,r),e=e.sibling}var ki=null,Gd=!1;function pm(e,t,r){for(r=r.child;r!==null;)aH(e,t,r),r=r.sibling}function aH(e,t,r){if(Bu&&typeof Bu.onCommitFiberUnmount=="function")try{Bu.onCommitFiberUnmount(RS,r)}catch{}switch(r.tag){case 5:Yi||Ev(r,t);case 6:var n=ki,s=Gd;ki=null,pm(e,t,r),ki=n,Gd=s,ki!==null&&(Gd?(e=ki,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ki.removeChild(r.stateNode));break;case 18:ki!==null&&(Gd?(e=ki,r=r.stateNode,e.nodeType===8?TA(e.parentNode,r):e.nodeType===1&&TA(e,r),Eb(e)):TA(ki,r.stateNode));break;case 4:n=ki,s=Gd,ki=r.stateNode.containerInfo,Gd=!0,pm(e,t,r),ki=n,Gd=s;break;case 0:case 11:case 14:case 15:if(!Yi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&zk(r,t,i),s=s.next}while(s!==n)}pm(e,t,r);break;case 1:if(!Yi&&(Ev(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){mo(r,t,l)}pm(e,t,r);break;case 21:pm(e,t,r);break;case 22:r.mode&1?(Yi=(n=Yi)||r.memoizedState!==null,pm(e,t,r),Yi=n):pm(e,t,r);break;default:pm(e,t,r)}}function cF(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new pce),t.forEach(function(n){var s=Sce.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function $d(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var o=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:ki=l.stateNode,Gd=!1;break e;case 3:ki=l.stateNode.containerInfo,Gd=!0;break e;case 4:ki=l.stateNode.containerInfo,Gd=!0;break e}l=l.return}if(ki===null)throw Error(en(160));aH(o,i,s),ki=null,Gd=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){mo(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)sH(t,e),t=t.sibling}function sH(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if($d(t,e),wu(e),n&4){try{By(3,e,e.return),VS(3,e)}catch(g){mo(e,e.return,g)}try{By(5,e,e.return)}catch(g){mo(e,e.return,g)}}break;case 1:$d(t,e),wu(e),n&512&&r!==null&&Ev(r,r.return);break;case 5:if($d(t,e),wu(e),n&512&&r!==null&&Ev(r,r.return),e.flags&32){var s=e.stateNode;try{Sb(s,"")}catch(g){mo(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=r!==null?r.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&AV(s,o),pk(l,i);var d=pk(l,o);for(i=0;i<c.length;i+=2){var u=c[i],f=c[i+1];u==="style"?OV(s,f):u==="dangerouslySetInnerHTML"?kV(s,f):u==="children"?Sb(s,f):h3(s,u,f,d)}switch(l){case"input":dk(s,o);break;case"textarea":PV(s,o);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?Uv(s,!!o.multiple,m,!1):h!==!!o.multiple&&(o.defaultValue!=null?Uv(s,!!o.multiple,o.defaultValue,!0):Uv(s,!!o.multiple,o.multiple?[]:"",!1))}s[Db]=o}catch(g){mo(e,e.return,g)}}break;case 6:if($d(t,e),wu(e),n&4){if(e.stateNode===null)throw Error(en(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(g){mo(e,e.return,g)}}break;case 3:if($d(t,e),wu(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Eb(t.containerInfo)}catch(g){mo(e,e.return,g)}break;case 4:$d(t,e),wu(e);break;case 13:$d(t,e),wu(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(G3=bo())),n&4&&cF(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Yi=(d=Yi)||u,$d(t,e),Yi=d):$d(t,e),wu(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(Mn=e,u=e.child;u!==null;){for(f=Mn=u;Mn!==null;){switch(h=Mn,m=h.child,h.tag){case 0:case 11:case 14:case 15:By(4,h,h.return);break;case 1:Ev(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){mo(n,r,g)}}break;case 5:Ev(h,h.return);break;case 22:if(h.memoizedState!==null){uF(f);continue}}m!==null?(m.return=h,Mn=m):uF(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=IV("display",i))}catch(g){mo(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){mo(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:$d(t,e),wu(e),n&4&&cF(e);break;case 21:break;default:$d(t,e),wu(e)}}function wu(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(nH(r)){var n=r;break e}r=r.return}throw Error(en(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Sb(s,""),n.flags&=-33);var o=lF(e);Wk(e,o,s);break;case 3:case 4:var i=n.stateNode.containerInfo,l=lF(e);Vk(e,l,i);break;default:throw Error(en(161))}}catch(c){mo(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function vce(e,t,r){Mn=e,oH(e)}function oH(e,t,r){for(var n=(e.mode&1)!==0;Mn!==null;){var s=Mn,o=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||w2;if(!i){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Yi;l=w2;var d=Yi;if(w2=i,(Yi=c)&&!d)for(Mn=s;Mn!==null;)i=Mn,c=i.child,i.tag===22&&i.memoizedState!==null?fF(s):c!==null?(c.return=i,Mn=c):fF(s);for(;o!==null;)Mn=o,oH(o),o=o.sibling;Mn=s,w2=l,Yi=d}dF(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,Mn=o):dF(e)}}function dF(e){for(;Mn!==null;){var t=Mn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Yi||VS(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Yi)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Hd(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&KL(t,o,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}KL(t,i,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Eb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(en(163))}Yi||t.flags&512&&Uk(t)}catch(h){mo(t,t.return,h)}}if(t===e){Mn=null;break}if(r=t.sibling,r!==null){r.return=t.return,Mn=r;break}Mn=t.return}}function uF(e){for(;Mn!==null;){var t=Mn;if(t===e){Mn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Mn=r;break}Mn=t.return}}function fF(e){for(;Mn!==null;){var t=Mn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{VS(4,t)}catch(c){mo(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){mo(t,s,c)}}var o=t.return;try{Uk(t)}catch(c){mo(t,o,c)}break;case 5:var i=t.return;try{Uk(t)}catch(c){mo(t,i,c)}}}catch(c){mo(t,t.return,c)}if(t===e){Mn=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Mn=l;break}Mn=t.return}}var xce=Math.ceil,S_=Zf.ReactCurrentDispatcher,W3=Zf.ReactCurrentOwner,xd=Zf.ReactCurrentBatchConfig,Ya=0,fi=null,To=null,Ti=0,yc=0,kv=Dh(0),Yo=0,Bb=null,eg=0,WS=0,H3=0,qy=null,ql=null,G3=0,gx=1/0,yf=null,C_=!1,Hk=null,rh=null,j2=!1,qm=null,A_=0,zy=0,Gk=null,Rj=-1,Lj=0;function Nl(){return Ya&6?bo():Rj!==-1?Rj:Rj=bo()}function nh(e){return e.mode&1?Ya&2&&Ti!==0?Ti&-Ti:tce.transition!==null?(Lj===0&&(Lj=VV()),Lj):(e=us,e!==0||(e=window.event,e=e===void 0?16:JV(e.type)),e):1}function au(e,t,r,n){if(50<zy)throw zy=0,Gk=null,Error(en(185));n1(e,r,n),(!(Ya&2)||e!==fi)&&(e===fi&&(!(Ya&2)&&(WS|=r),Yo===4&&Dm(e,Ti)),Jl(e,n),r===1&&Ya===0&&!(t.mode&1)&&(gx=bo()+500,qS&&Mh()))}function Jl(e,t){var r=e.callbackNode;tle(e,t);var n=d_(e,e===fi?Ti:0);if(n===0)r!==null&&wL(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&wL(r),t===1)e.tag===0?ece(mF.bind(null,e)):gW(mF.bind(null,e)),Yle(function(){!(Ya&6)&&Mh()}),r=null;else{switch(WV(n)){case 1:r=y3;break;case 4:r=zV;break;case 16:r=c_;break;case 536870912:r=UV;break;default:r=c_}r=hH(r,iH.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function iH(e,t){if(Rj=-1,Lj=0,Ya&6)throw Error(en(327));var r=e.callbackNode;if(Kv()&&e.callbackNode!==r)return null;var n=d_(e,e===fi?Ti:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=P_(e,n);else{t=n;var s=Ya;Ya|=2;var o=cH();(fi!==e||Ti!==t)&&(yf=null,gx=bo()+500,Rp(e,t));do try{wce();break}catch(l){lH(e,l)}while(1);O3(),S_.current=o,Ya=s,To!==null?t=0:(fi=null,Ti=0,t=Yo)}if(t!==0){if(t===2&&(s=bk(e),s!==0&&(n=s,t=Kk(e,s))),t===1)throw r=Bb,Rp(e,0),Dm(e,n),Jl(e,bo()),r;if(t===6)Dm(e,n);else{if(s=e.current.alternate,!(n&30)&&!yce(s)&&(t=P_(e,n),t===2&&(o=bk(e),o!==0&&(n=o,t=Kk(e,o))),t===1))throw r=Bb,Rp(e,0),Dm(e,n),Jl(e,bo()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(en(345));case 2:sp(e,ql,yf);break;case 3:if(Dm(e,n),(n&130023424)===n&&(t=G3+500-bo(),10<t)){if(d_(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Nl(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Pk(sp.bind(null,e,ql,yf),t);break}sp(e,ql,yf);break;case 4:if(Dm(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-nu(n);o=1<<i,i=t[i],i>s&&(s=i),n&=~o}if(n=s,n=bo()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*xce(n/1960))-n,10<n){e.timeoutHandle=Pk(sp.bind(null,e,ql,yf),n);break}sp(e,ql,yf);break;case 5:sp(e,ql,yf);break;default:throw Error(en(329))}}}return Jl(e,bo()),e.callbackNode===r?iH.bind(null,e):null}function Kk(e,t){var r=qy;return e.current.memoizedState.isDehydrated&&(Rp(e,t).flags|=256),e=P_(e,t),e!==2&&(t=ql,ql=r,t!==null&&Xk(t)),e}function Xk(e){ql===null?ql=e:ql.push.apply(ql,e)}function yce(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],o=s.getSnapshot;s=s.value;try{if(!lu(o(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Dm(e,t){for(t&=~H3,t&=~WS,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-nu(t),n=1<<r;e[r]=-1,t&=~n}}function mF(e){if(Ya&6)throw Error(en(327));Kv();var t=d_(e,0);if(!(t&1))return Jl(e,bo()),null;var r=P_(e,t);if(e.tag!==0&&r===2){var n=bk(e);n!==0&&(t=n,r=Kk(e,n))}if(r===1)throw r=Bb,Rp(e,0),Dm(e,t),Jl(e,bo()),r;if(r===6)throw Error(en(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,sp(e,ql,yf),Jl(e,bo()),null}function K3(e,t){var r=Ya;Ya|=1;try{return e(t)}finally{Ya=r,Ya===0&&(gx=bo()+500,qS&&Mh())}}function tg(e){qm!==null&&qm.tag===0&&!(Ya&6)&&Kv();var t=Ya;Ya|=1;var r=xd.transition,n=us;try{if(xd.transition=null,us=1,e)return e()}finally{us=n,xd.transition=r,Ya=t,!(Ya&6)&&Mh()}}function X3(){yc=kv.current,Us(kv)}function Rp(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Xle(r)),To!==null)for(r=To.return;r!==null;){var n=r;switch(E3(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&p_();break;case 3:hx(),Us(Xl),Us(rl),F3();break;case 5:L3(n);break;case 4:hx();break;case 13:Us(eo);break;case 19:Us(eo);break;case 10:T3(n.type._context);break;case 22:case 23:X3()}r=r.return}if(fi=e,To=e=ah(e.current,null),Ti=yc=t,Yo=0,Bb=null,H3=WS=eg=0,ql=qy=null,wp!==null){for(t=0;t<wp.length;t++)if(r=wp[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,o=r.pending;if(o!==null){var i=o.next;o.next=s,n.next=i}r.pending=n}wp=null}return e}function lH(e,t){do{var r=To;try{if(O3(),Tj.current=N_,__){for(var n=no.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}__=!1}if(Zp=0,ii=Wo=no=null,$y=!1,Lb=0,W3.current=null,r===null||r.return===null){Yo=1,Bb=t,To=null;break}e:{var o=e,i=r.return,l=r,c=t;if(t=Ti,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=eF(i);if(m!==null){m.flags&=-257,tF(m,i,l,o,t),m.mode&1&&ZL(o,d,t),t=m,c=d;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){ZL(o,d,t),Y3();break e}c=Error(en(426))}}else if(Ks&&l.mode&1){var y=eF(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),tF(y,i,l,o,t),k3(px(c,l));break e}}o=c=px(c,l),Yo!==4&&(Yo=2),qy===null?qy=[o]:qy.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var x=WW(o,c,t);GL(o,x);break e;case 1:l=c;var b=o.type,w=o.stateNode;if(!(o.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(rh===null||!rh.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t;var j=HW(o,l,t);GL(o,j);break e}}o=o.return}while(o!==null)}uH(r)}catch(_){t=_,To===r&&r!==null&&(To=r=r.return);continue}break}while(1)}function cH(){var e=S_.current;return S_.current=N_,e===null?N_:e}function Y3(){(Yo===0||Yo===3||Yo===2)&&(Yo=4),fi===null||!(eg&268435455)&&!(WS&268435455)||Dm(fi,Ti)}function P_(e,t){var r=Ya;Ya|=2;var n=cH();(fi!==e||Ti!==t)&&(yf=null,Rp(e,t));do try{bce();break}catch(s){lH(e,s)}while(1);if(O3(),Ya=r,S_.current=n,To!==null)throw Error(en(261));return fi=null,Ti=0,Yo}function bce(){for(;To!==null;)dH(To)}function wce(){for(;To!==null&&!Hie();)dH(To)}function dH(e){var t=mH(e.alternate,e,yc);e.memoizedProps=e.pendingProps,t===null?uH(e):To=t,W3.current=null}function uH(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=hce(r,t),r!==null){r.flags&=32767,To=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Yo=6,To=null;return}}else if(r=mce(r,t,yc),r!==null){To=r;return}if(t=t.sibling,t!==null){To=t;return}To=t=e}while(t!==null);Yo===0&&(Yo=5)}function sp(e,t,r){var n=us,s=xd.transition;try{xd.transition=null,us=1,jce(e,t,r,n)}finally{xd.transition=s,us=n}return null}function jce(e,t,r,n){do Kv();while(qm!==null);if(Ya&6)throw Error(en(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(en(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(rle(e,o),e===fi&&(To=fi=null,Ti=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||j2||(j2=!0,hH(c_,function(){return Kv(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=xd.transition,xd.transition=null;var i=us;us=1;var l=Ya;Ya|=4,W3.current=null,gce(e,r),sH(r,e),zle(Ck),u_=!!Sk,Ck=Sk=null,e.current=r,vce(r),Gie(),Ya=l,us=i,xd.transition=o}else e.current=r;if(j2&&(j2=!1,qm=e,A_=s),o=e.pendingLanes,o===0&&(rh=null),Yie(r.stateNode),Jl(e,bo()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(C_)throw C_=!1,e=Hk,Hk=null,e;return A_&1&&e.tag!==0&&Kv(),o=e.pendingLanes,o&1?e===Gk?zy++:(zy=0,Gk=e):zy=0,Mh(),null}function Kv(){if(qm!==null){var e=WV(A_),t=xd.transition,r=us;try{if(xd.transition=null,us=16>e?16:e,qm===null)var n=!1;else{if(e=qm,qm=null,A_=0,Ya&6)throw Error(en(331));var s=Ya;for(Ya|=4,Mn=e.current;Mn!==null;){var o=Mn,i=o.child;if(Mn.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Mn=d;Mn!==null;){var u=Mn;switch(u.tag){case 0:case 11:case 15:By(8,u,o)}var f=u.child;if(f!==null)f.return=u,Mn=f;else for(;Mn!==null;){u=Mn;var h=u.sibling,m=u.return;if(rH(u),u===d){Mn=null;break}if(h!==null){h.return=m,Mn=h;break}Mn=m}}}var v=o.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Mn=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Mn=i;else e:for(;Mn!==null;){if(o=Mn,o.flags&2048)switch(o.tag){case 0:case 11:case 15:By(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,Mn=x;break e}Mn=o.return}}var b=e.current;for(Mn=b;Mn!==null;){i=Mn;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Mn=w;else e:for(i=b;Mn!==null;){if(l=Mn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:VS(9,l)}}catch(_){mo(l,l.return,_)}if(l===i){Mn=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,Mn=j;break e}Mn=l.return}}if(Ya=s,Mh(),Bu&&typeof Bu.onPostCommitFiberRoot=="function")try{Bu.onPostCommitFiberRoot(RS,e)}catch{}n=!0}return n}finally{us=r,xd.transition=t}}return!1}function hF(e,t,r){t=px(r,t),t=WW(e,t,1),e=th(e,t,1),t=Nl(),e!==null&&(n1(e,1,t),Jl(e,t))}function mo(e,t,r){if(e.tag===3)hF(e,e,r);else for(;t!==null;){if(t.tag===3){hF(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(rh===null||!rh.has(n))){e=px(r,e),e=HW(t,e,1),t=th(t,e,1),e=Nl(),t!==null&&(n1(t,1,e),Jl(t,e));break}}t=t.return}}function _ce(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Nl(),e.pingedLanes|=e.suspendedLanes&r,fi===e&&(Ti&r)===r&&(Yo===4||Yo===3&&(Ti&130023424)===Ti&&500>bo()-G3?Rp(e,0):H3|=r),Jl(e,t)}function fH(e,t){t===0&&(e.mode&1?(t=f2,f2<<=1,!(f2&130023424)&&(f2=4194304)):t=1);var r=Nl();e=Bf(e,t),e!==null&&(n1(e,t,r),Jl(e,r))}function Nce(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),fH(e,r)}function Sce(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(en(314))}n!==null&&n.delete(t),fH(e,r)}var mH;mH=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xl.current)Wl=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Wl=!1,fce(e,t,r);Wl=!!(e.flags&131072)}else Wl=!1,Ks&&t.flags&1048576&&vW(t,x_,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Mj(e,t),e=t.pendingProps;var s=ux(t,rl.current);Gv(t,r),s=B3(null,t,n,e,s,r);var o=q3();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yl(n)?(o=!0,g_(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,M3(t),s.updater=US,t.stateNode=s,s._reactInternals=t,Mk(t,n,e,r),t=Fk(null,t,n,!0,o,r)):(t.tag=0,Ks&&o&&P3(t),vl(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Mj(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=Ace(n),e=Hd(n,e),s){case 0:t=Lk(null,t,n,e,r);break e;case 1:t=aF(null,t,n,e,r);break e;case 11:t=rF(null,t,n,e,r);break e;case 14:t=nF(null,t,n,Hd(n.type,e),r);break e}throw Error(en(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Hd(n,s),Lk(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Hd(n,s),aF(e,t,n,s,r);case 3:e:{if(YW(t),e===null)throw Error(en(387));n=t.pendingProps,o=t.memoizedState,s=o.element,_W(e,t),w_(t,n,null,r);var i=t.memoizedState;if(n=i.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=px(Error(en(423)),t),t=sF(e,t,n,r,s);break e}else if(n!==s){s=px(Error(en(424)),t),t=sF(e,t,n,r,s);break e}else for(Nc=eh(t.stateNode.containerInfo.firstChild),kc=t,Ks=!0,Jd=null,r=wW(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(fx(),n===s){t=qf(e,t,r);break e}vl(e,t,n,r)}t=t.child}return t;case 5:return NW(t),e===null&&Ok(t),n=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,Ak(n,s)?i=null:o!==null&&Ak(n,o)&&(t.flags|=32),XW(e,t),vl(e,t,i,r),t.child;case 6:return e===null&&Ok(t),null;case 13:return JW(e,t,r);case 4:return R3(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=mx(t,null,n,r):vl(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Hd(n,s),rF(e,t,n,s,r);case 7:return vl(e,t,t.pendingProps,r),t.child;case 8:return vl(e,t,t.pendingProps.children,r),t.child;case 12:return vl(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,Is(y_,n._currentValue),n._currentValue=i,o!==null)if(lu(o.value,i)){if(o.children===s.children&&!Xl.current){t=qf(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=Tf(-1,r&-r),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),Tk(o.return,r,t),l.lanes|=r;break}c=c.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(en(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Tk(i,r,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}vl(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Gv(t,r),s=_d(s),n=n(s),t.flags|=1,vl(e,t,n,r),t.child;case 14:return n=t.type,s=Hd(n,t.pendingProps),s=Hd(n.type,s),nF(e,t,n,s,r);case 15:return GW(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Hd(n,s),Mj(e,t),t.tag=1,Yl(n)?(e=!0,g_(t)):e=!1,Gv(t,r),VW(t,n,s),Mk(t,n,s,r),Fk(null,t,n,!0,e,r);case 19:return QW(e,t,r);case 22:return KW(e,t,r)}throw Error(en(156,t.tag))};function hH(e,t){return qV(e,t)}function Cce(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fd(e,t,r,n){return new Cce(e,t,r,n)}function J3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ace(e){if(typeof e=="function")return J3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===g3)return 11;if(e===v3)return 14}return 2}function ah(e,t){var r=e.alternate;return r===null?(r=fd(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Fj(e,t,r,n,s,o){var i=2;if(n=e,typeof e=="function")J3(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case bv:return Lp(r.children,s,o,t);case p3:i=8,s|=8;break;case sk:return e=fd(12,r,t,s|2),e.elementType=sk,e.lanes=o,e;case ok:return e=fd(13,r,t,s),e.elementType=ok,e.lanes=o,e;case ik:return e=fd(19,r,t,s),e.elementType=ik,e.lanes=o,e;case NV:return HS(r,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case jV:i=10;break e;case _V:i=9;break e;case g3:i=11;break e;case v3:i=14;break e;case Pm:i=16,n=null;break e}throw Error(en(130,e==null?e:typeof e,""))}return t=fd(i,r,t,s),t.elementType=e,t.type=n,t.lanes=o,t}function Lp(e,t,r,n){return e=fd(7,e,n,t),e.lanes=r,e}function HS(e,t,r,n){return e=fd(22,e,n,t),e.elementType=NV,e.lanes=r,e.stateNode={isHidden:!1},e}function qA(e,t,r){return e=fd(6,e,null,t),e.lanes=r,e}function zA(e,t,r){return t=fd(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Pce(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jA(0),this.expirationTimes=jA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jA(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Q3(e,t,r,n,s,o,i,l,c){return e=new Pce(e,t,r,l,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=fd(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},M3(o),e}function Ece(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yv,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function pH(e){if(!e)return wh;e=e._reactInternals;e:{if(yg(e)!==e||e.tag!==1)throw Error(en(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(en(171))}if(e.tag===1){var r=e.type;if(Yl(r))return pW(e,r,t)}return t}function gH(e,t,r,n,s,o,i,l,c){return e=Q3(r,n,!0,e,s,o,i,l,c),e.context=pH(null),r=e.current,n=Nl(),s=nh(r),o=Tf(n,s),o.callback=t??null,th(r,o,s),e.current.lanes=s,n1(e,s,n),Jl(e,n),e}function GS(e,t,r,n){var s=t.current,o=Nl(),i=nh(s);return r=pH(r),t.context===null?t.context=r:t.pendingContext=r,t=Tf(o,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=th(s,t,i),e!==null&&(au(e,s,i,o),Oj(e,s,i)),i}function E_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function pF(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Z3(e,t){pF(e,t),(e=e.alternate)&&pF(e,t)}function kce(){return null}var vH=typeof reportError=="function"?reportError:function(e){console.error(e)};function e4(e){this._internalRoot=e}KS.prototype.render=e4.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(en(409));GS(e,t,null,null)};KS.prototype.unmount=e4.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;tg(function(){GS(null,e,null,null)}),t[$f]=null}};function KS(e){this._internalRoot=e}KS.prototype.unstable_scheduleHydration=function(e){if(e){var t=KV();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Tm.length&&t!==0&&t<Tm[r].priority;r++);Tm.splice(r,0,e),r===0&&YV(e)}};function t4(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function XS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function gF(){}function Ice(e,t,r,n,s){if(s){if(typeof n=="function"){var o=n;n=function(){var d=E_(i);o.call(d)}}var i=gH(t,n,e,0,null,!1,!1,"",gF);return e._reactRootContainer=i,e[$f]=i.current,Ob(e.nodeType===8?e.parentNode:e),tg(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var d=E_(c);l.call(d)}}var c=Q3(e,0,!1,null,null,!1,!1,"",gF);return e._reactRootContainer=c,e[$f]=c.current,Ob(e.nodeType===8?e.parentNode:e),tg(function(){GS(t,c,r,n)}),c}function YS(e,t,r,n,s){var o=r._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var c=E_(i);l.call(c)}}GS(t,i,e,s)}else i=Ice(r,t,e,s,n);return E_(i)}HV=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Sy(t.pendingLanes);r!==0&&(b3(t,r|1),Jl(t,bo()),!(Ya&6)&&(gx=bo()+500,Mh()))}break;case 13:tg(function(){var n=Bf(e,1);if(n!==null){var s=Nl();au(n,e,1,s)}}),Z3(e,1)}};w3=function(e){if(e.tag===13){var t=Bf(e,134217728);if(t!==null){var r=Nl();au(t,e,134217728,r)}Z3(e,134217728)}};GV=function(e){if(e.tag===13){var t=nh(e),r=Bf(e,t);if(r!==null){var n=Nl();au(r,e,t,n)}Z3(e,t)}};KV=function(){return us};XV=function(e,t){var r=us;try{return us=e,t()}finally{us=r}};vk=function(e,t,r){switch(t){case"input":if(dk(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=BS(n);if(!s)throw Error(en(90));CV(n),dk(n,s)}}}break;case"textarea":PV(e,r);break;case"select":t=r.value,t!=null&&Uv(e,!!r.multiple,t,!1)}};MV=K3;RV=tg;var Oce={usingClientEntryPoint:!1,Events:[s1,Nv,BS,TV,DV,K3]},J0={findFiberByHostInstance:bp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tce={bundleType:J0.bundleType,version:J0.version,rendererPackageName:J0.rendererPackageName,rendererConfig:J0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=$V(e),e===null?null:e.stateNode},findFiberByHostInstance:J0.findFiberByHostInstance||kce,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_2.isDisabled&&_2.supportsFiber)try{RS=_2.inject(Tce),Bu=_2}catch{}}$c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Oce;$c.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t4(t))throw Error(en(200));return Ece(e,t,null,r)};$c.createRoot=function(e,t){if(!t4(e))throw Error(en(299));var r=!1,n="",s=vH;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Q3(e,1,!1,null,null,r,!1,n,s),e[$f]=t.current,Ob(e.nodeType===8?e.parentNode:e),new e4(t)};$c.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(en(188)):(e=Object.keys(e).join(","),Error(en(268,e)));return e=$V(t),e=e===null?null:e.stateNode,e};$c.flushSync=function(e){return tg(e)};$c.hydrate=function(e,t,r){if(!XS(t))throw Error(en(200));return YS(null,e,t,!0,r)};$c.hydrateRoot=function(e,t,r){if(!t4(e))throw Error(en(405));var n=r!=null&&r.hydratedSources||null,s=!1,o="",i=vH;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=gH(t,null,e,1,r??null,s,!1,o,i),e[$f]=t.current,Ob(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new KS(t)};$c.render=function(e,t,r){if(!XS(t))throw Error(en(200));return YS(null,e,t,!1,r)};$c.unmountComponentAtNode=function(e){if(!XS(e))throw Error(en(40));return e._reactRootContainer?(tg(function(){YS(null,null,e,!1,function(){e._reactRootContainer=null,e[$f]=null})}),!0):!1};$c.unstable_batchedUpdates=K3;$c.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!XS(r))throw Error(en(200));if(e==null||e._reactInternals===void 0)throw Error(en(38));return YS(e,t,r,!1,n)};$c.version="18.3.1-next-f1338f8080-20240426";function xH(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xH)}catch(e){console.error(e)}}xH(),xV.exports=$c;var em=xV.exports;const r4=Ga(em);var vF=em;nk.createRoot=vF.createRoot,nk.hydrateRoot=vF.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qb(){return qb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qb.apply(this,arguments)}var zm;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(zm||(zm={}));const xF="popstate";function Dce(e){e===void 0&&(e={});function t(n,s){let{pathname:o,search:i,hash:l}=n.location;return Yk("",{pathname:o,search:i,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:k_(s)}return Rce(t,r,null,e)}function ao(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function yH(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Mce(){return Math.random().toString(36).substr(2,8)}function yF(e,t){return{usr:e.state,key:e.key,idx:t}}function Yk(e,t,r,n){return r===void 0&&(r=null),qb({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?i0(t):t,{state:r,key:t&&t.key||n||Mce()})}function k_(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function i0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Rce(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:o=!1}=n,i=s.history,l=zm.Pop,c=null,d=u();d==null&&(d=0,i.replaceState(qb({},i.state,{idx:d}),""));function u(){return(i.state||{idx:null}).idx}function f(){l=zm.Pop;let y=u(),x=y==null?null:y-d;d=y,c&&c({action:l,location:g.location,delta:x})}function h(y,x){l=zm.Push;let b=Yk(g.location,y,x);r&&r(b,y),d=u()+1;let w=yF(b,d),j=g.createHref(b);try{i.pushState(w,"",j)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(j)}o&&c&&c({action:l,location:g.location,delta:1})}function m(y,x){l=zm.Replace;let b=Yk(g.location,y,x);r&&r(b,y),d=u();let w=yF(b,d),j=g.createHref(b);i.replaceState(w,"",j),o&&c&&c({action:l,location:g.location,delta:0})}function v(y){let x=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof y=="string"?y:k_(y);return b=b.replace(/ $/,"%20"),ao(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let g={get action(){return l},get location(){return e(s,i)},listen(y){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(xF,f),c=y,()=>{s.removeEventListener(xF,f),c=null}},createHref(y){return t(s,y)},createURL:v,encodeLocation(y){let x=v(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:m,go(y){return i.go(y)}};return g}var bF;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(bF||(bF={}));function Lce(e,t,r){return r===void 0&&(r="/"),Fce(e,t,r,!1)}function Fce(e,t,r,n){let s=typeof t=="string"?i0(t):t,o=vx(s.pathname||"/",r);if(o==null)return null;let i=bH(e);$ce(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let d=Yce(o);l=Kce(i[c],d,n)}return l}function bH(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(o,i,l)=>{let c={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(ao(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=sh([n,c.relativePath]),u=r.concat(c);o.children&&o.children.length>0&&(ao(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),bH(o.children,t,u,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:Hce(d,o.index),routesMeta:u})};return e.forEach((o,i)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,i);else for(let c of wH(o.path))s(o,i,c)}),t}function wH(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let i=wH(n.join("/")),l=[];return l.push(...i.map(c=>c===""?o:[o,c].join("/"))),s&&l.push(...i),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function $ce(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Gce(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Bce=/^:[\w-]+$/,qce=3,zce=2,Uce=1,Vce=10,Wce=-2,wF=e=>e==="*";function Hce(e,t){let r=e.split("/"),n=r.length;return r.some(wF)&&(n+=Wce),t&&(n+=zce),r.filter(s=>!wF(s)).reduce((s,o)=>s+(Bce.test(o)?qce:o===""?Uce:Vce),n)}function Gce(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function Kce(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,s={},o="/",i=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=o==="/"?t:t.slice(o.length)||"/",f=I_({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),h=c.route;if(!f&&d&&r&&!n[n.length-1].route.index&&(f=I_({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:sh([o,f.pathname]),pathnameBase:ede(sh([o,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(o=sh([o,f.pathnameBase]))}return i}function I_(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Xce(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((d,u,f)=>{let{paramName:h,isOptional:m}=u;if(h==="*"){let g=l[f]||"";i=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const v=l[f];return m&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:i,pattern:e}}function Xce(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),yH(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function Yce(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return yH(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function vx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Jce(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?i0(e):e;return{pathname:r?r.startsWith("/")?r:Qce(r,t):t,search:tde(n),hash:rde(s)}}function Qce(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function UA(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Zce(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function n4(e,t){let r=Zce(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function a4(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=i0(e):(s=qb({},e),ao(!s.pathname||!s.pathname.includes("?"),UA("?","pathname","search",s)),ao(!s.pathname||!s.pathname.includes("#"),UA("#","pathname","hash",s)),ao(!s.search||!s.search.includes("#"),UA("#","search","hash",s)));let o=e===""||s.pathname==="",i=o?"/":s.pathname,l;if(i==null)l=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=Jce(s,l),d=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const sh=e=>e.join("/").replace(/\/\/+/g,"/"),ede=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),tde=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,rde=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function nde(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const jH=["post","put","patch","delete"];new Set(jH);const ade=["get",...jH];new Set(ade);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zb(){return zb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zb.apply(this,arguments)}const JS=p.createContext(null),_H=p.createContext(null),tm=p.createContext(null),QS=p.createContext(null),rm=p.createContext({outlet:null,matches:[],isDataRoute:!1}),NH=p.createContext(null);function sde(e,t){let{relative:r}=t===void 0?{}:t;l0()||ao(!1);let{basename:n,navigator:s}=p.useContext(tm),{hash:o,pathname:i,search:l}=ZS(e,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:sh([n,i])),s.createHref({pathname:c,search:l,hash:o})}function l0(){return p.useContext(QS)!=null}function Lo(){return l0()||ao(!1),p.useContext(QS).location}function SH(e){p.useContext(tm).static||p.useLayoutEffect(e)}function Ri(){let{isDataRoute:e}=p.useContext(rm);return e?yde():ode()}function ode(){l0()||ao(!1);let e=p.useContext(JS),{basename:t,future:r,navigator:n}=p.useContext(tm),{matches:s}=p.useContext(rm),{pathname:o}=Lo(),i=JSON.stringify(n4(s,r.v7_relativeSplatPath)),l=p.useRef(!1);return SH(()=>{l.current=!0}),p.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let f=a4(d,JSON.parse(i),o,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:sh([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,i,o,e])}function ide(){let{matches:e}=p.useContext(rm),t=e[e.length-1];return t?t.params:{}}function ZS(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=p.useContext(tm),{matches:s}=p.useContext(rm),{pathname:o}=Lo(),i=JSON.stringify(n4(s,n.v7_relativeSplatPath));return p.useMemo(()=>a4(e,JSON.parse(i),o,r==="path"),[e,i,o,r])}function lde(e,t){return cde(e,t)}function cde(e,t,r,n){l0()||ao(!1);let{navigator:s}=p.useContext(tm),{matches:o}=p.useContext(rm),i=o[o.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=Lo(),u;if(t){var f;let y=typeof t=="string"?i0(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||ao(!1),u=y}else u=d;let h=u.pathname||"/",m=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=Lce(e,{pathname:m}),g=hde(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:sh([c,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:sh([c,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,r,n);return t&&g?p.createElement(QS.Provider,{value:{location:zb({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:zm.Pop}},g):g}function dde(){let e=xde(),t=nde(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),r?p.createElement("pre",{style:s},r):null,o)}const ude=p.createElement(dde,null);class fde extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?p.createElement(rm.Provider,{value:this.props.routeContext},p.createElement(NH.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mde(e){let{routeContext:t,match:r,children:n}=e,s=p.useContext(JS);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),p.createElement(rm.Provider,{value:t},n)}function hde(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var o;if(!r)return null;if(r.errors)e=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,l=(s=r)==null?void 0:s.errors;if(l!=null){let u=i.findIndex(f=>f.route.id&&l?.[f.route.id]!==void 0);u>=0||ao(!1),i=i.slice(0,Math.min(i.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<i.length;u++){let f=i[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=u),f.route.id){let{loaderData:h,errors:m}=r,v=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||v){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((u,f,h)=>{let m,v=!1,g=null,y=null;r&&(m=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||ude,c&&(d<0&&h===0?(bde("route-fallback",!1),v=!0,y=null):d===h&&(v=!0,y=f.route.hydrateFallbackElement||null)));let x=t.concat(i.slice(0,h+1)),b=()=>{let w;return m?w=g:v?w=y:f.route.Component?w=p.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,p.createElement(mde,{match:f,routeContext:{outlet:u,matches:x,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?p.createElement(fde,{location:r.location,revalidation:r.revalidation,component:g,error:m,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var CH=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(CH||{}),O_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(O_||{});function pde(e){let t=p.useContext(JS);return t||ao(!1),t}function gde(e){let t=p.useContext(_H);return t||ao(!1),t}function vde(e){let t=p.useContext(rm);return t||ao(!1),t}function AH(e){let t=vde(),r=t.matches[t.matches.length-1];return r.route.id||ao(!1),r.route.id}function xde(){var e;let t=p.useContext(NH),r=gde(O_.UseRouteError),n=AH(O_.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function yde(){let{router:e}=pde(CH.UseNavigateStable),t=AH(O_.UseNavigateStable),r=p.useRef(!1);return SH(()=>{r.current=!0}),p.useCallback(function(s,o){o===void 0&&(o={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,zb({fromRouteId:t},o)))},[e,t])}const jF={};function bde(e,t,r){!t&&!jF[e]&&(jF[e]=!0)}function wde(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function PH(e){let{to:t,replace:r,state:n,relative:s}=e;l0()||ao(!1);let{future:o,static:i}=p.useContext(tm),{matches:l}=p.useContext(rm),{pathname:c}=Lo(),d=Ri(),u=a4(t,n4(l,o.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(u);return p.useEffect(()=>d(JSON.parse(f),{replace:r,state:n,relative:s}),[d,f,s,r,n]),null}function rs(e){ao(!1)}function jde(e){let{basename:t="/",children:r=null,location:n,navigationType:s=zm.Pop,navigator:o,static:i=!1,future:l}=e;l0()&&ao(!1);let c=t.replace(/^\/*/,"/"),d=p.useMemo(()=>({basename:c,navigator:o,static:i,future:zb({v7_relativeSplatPath:!1},l)}),[c,l,o,i]);typeof n=="string"&&(n=i0(n));let{pathname:u="/",search:f="",hash:h="",state:m=null,key:v="default"}=n,g=p.useMemo(()=>{let y=vx(u,c);return y==null?null:{location:{pathname:y,search:f,hash:h,state:m,key:v},navigationType:s}},[c,u,f,h,m,v,s]);return g==null?null:p.createElement(tm.Provider,{value:d},p.createElement(QS.Provider,{children:r,value:g}))}function $j(e){let{children:t,location:r}=e;return lde(Jk(t),r)}new Promise(()=>{});function Jk(e,t){t===void 0&&(t=[]);let r=[];return p.Children.forEach(e,(n,s)=>{if(!p.isValidElement(n))return;let o=[...t,s];if(n.type===p.Fragment){r.push.apply(r,Jk(n.props.children,o));return}n.type!==rs&&ao(!1),!n.props.index||!n.props.children||ao(!1);let i={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Jk(n.props.children,o)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T_(){return T_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},T_.apply(this,arguments)}function EH(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,o;for(o=0;o<n.length;o++)s=n[o],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function _de(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Nde(e,t){return e.button===0&&(!t||t==="_self")&&!_de(e)}function Qk(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function Sde(e,t){let r=Qk(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(o=>{r.append(s,o)})}),r}const Cde=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ade=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Pde="6";try{window.__reactRouterVersion=Pde}catch{}const Ede=p.createContext({isTransitioning:!1}),kde="startTransition",_F=u3[kde];function Ide(e){let{basename:t,children:r,future:n,window:s}=e,o=p.useRef();o.current==null&&(o.current=Dce({window:s,v5Compat:!0}));let i=o.current,[l,c]=p.useState({action:i.action,location:i.location}),{v7_startTransition:d}=n||{},u=p.useCallback(f=>{d&&_F?_F(()=>c(f)):c(f)},[c,d]);return p.useLayoutEffect(()=>i.listen(u),[i,u]),p.useEffect(()=>wde(n),[n]),p.createElement(jde,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:i,future:n})}const Ode=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Tde=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,s4=p.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:o,replace:i,state:l,target:c,to:d,preventScrollReset:u,viewTransition:f}=t,h=EH(t,Cde),{basename:m}=p.useContext(tm),v,g=!1;if(typeof d=="string"&&Tde.test(d)&&(v=d,Ode))try{let w=new URL(window.location.href),j=d.startsWith("//")?new URL(w.protocol+d):new URL(d),_=vx(j.pathname,m);j.origin===w.origin&&_!=null?d=_+j.search+j.hash:g=!0}catch{}let y=sde(d,{relative:s}),x=Mde(d,{replace:i,state:l,target:c,preventScrollReset:u,relative:s,viewTransition:f});function b(w){n&&n(w),w.defaultPrevented||x(w)}return p.createElement("a",T_({},h,{href:v||y,onClick:g||o?n:b,ref:r,target:c}))}),Su=p.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:o="",end:i=!1,style:l,to:c,viewTransition:d,children:u}=t,f=EH(t,Ade),h=ZS(c,{relative:f.relative}),m=Lo(),v=p.useContext(_H),{navigator:g,basename:y}=p.useContext(tm),x=v!=null&&Rde(h)&&d===!0,b=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,w=m.pathname,j=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;s||(w=w.toLowerCase(),j=j?j.toLowerCase():null,b=b.toLowerCase()),j&&y&&(j=vx(j,y)||j);const _=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let C=w===b||!i&&w.startsWith(b)&&w.charAt(_)==="/",P=j!=null&&(j===b||!i&&j.startsWith(b)&&j.charAt(b.length)==="/"),E={isActive:C,isPending:P,isTransitioning:x},A=C?n:void 0,F;typeof o=="function"?F=o(E):F=[o,C?"active":null,P?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let D=typeof l=="function"?l(E):l;return p.createElement(s4,T_({},f,{"aria-current":A,className:F,ref:r,style:D,to:c,viewTransition:d}),typeof u=="function"?u(E):u)});var Zk;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Zk||(Zk={}));var NF;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(NF||(NF={}));function Dde(e){let t=p.useContext(JS);return t||ao(!1),t}function Mde(e,t){let{target:r,replace:n,state:s,preventScrollReset:o,relative:i,viewTransition:l}=t===void 0?{}:t,c=Ri(),d=Lo(),u=ZS(e,{relative:i});return p.useCallback(f=>{if(Nde(f,r)){f.preventDefault();let h=n!==void 0?n:k_(d)===k_(u);c(e,{replace:h,state:s,preventScrollReset:o,relative:i,viewTransition:l})}},[d,c,u,n,s,r,e,o,i,l])}function eC(e){let t=p.useRef(Qk(e)),r=p.useRef(!1),n=Lo(),s=p.useMemo(()=>Sde(n.search,r.current?null:t.current),[n.search]),o=Ri(),i=p.useCallback((l,c)=>{const d=Qk(typeof l=="function"?l(s):l);r.current=!0,o("?"+d,c)},[o,s]);return[s,i]}function Rde(e,t){t===void 0&&(t={});let r=p.useContext(Ede);r==null&&ao(!1);let{basename:n}=Dde(Zk.useViewTransitionState),s=ZS(e,{relative:t.relative});if(!r.isTransitioning)return!1;let o=vx(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=vx(r.nextLocation.pathname,n)||r.nextLocation.pathname;return I_(s.pathname,i)!=null||I_(s.pathname,o)!=null}function kH(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=kH(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ga(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=kH(e))&&(n&&(n+=" "),n+=t);return n}function Lde(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=IH(t))&&(n&&(n+=" "),n+=r);return n}function IH(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=IH(e[n]))&&(r&&(r+=" "),r+=t);return r}var o4="-";function Fde(e){var t=Bde(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,s=n===void 0?{}:n;function o(l){var c=l.split(o4);return c[0]===""&&c.length!==1&&c.shift(),OH(c,t)||$de(l)}function i(l,c){var d=r[l]||[];return c&&s[l]?[].concat(d,s[l]):d}return{getClassGroupId:o,getConflictingClassGroupIds:i}}function OH(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),s=n?OH(e.slice(1),n):void 0;if(s)return s;if(t.validators.length!==0){var o=e.join(o4);return t.validators.find(function(i){var l=i.validator;return l(o)})?.classGroupId}}var SF=/^\[(.+)\]$/;function $de(e){if(SF.test(e)){var t=SF.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function Bde(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},s=zde(Object.entries(e.classGroups),r);return s.forEach(function(o){var i=o[0],l=o[1];eI(l,n,i,t)}),n}function eI(e,t,r,n){e.forEach(function(s){if(typeof s=="string"){var o=s===""?t:CF(t,s);o.classGroupId=r;return}if(typeof s=="function"){if(qde(s)){eI(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(function(i){var l=i[0],c=i[1];eI(c,CF(t,l),r,n)})})}function CF(e,t){var r=e;return t.split(o4).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function qde(e){return e.isThemeGetter}function zde(e,t){return t?e.map(function(r){var n=r[0],s=r[1],o=s.map(function(i){return typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(function(l){var c=l[0],d=l[1];return[t+c,d]})):i});return[n,o]}):e}function Ude(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function s(o,i){r.set(o,i),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(i){var l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return s(i,l),l},set:function(i,l){r.has(i)?r.set(i,l):s(i,l)}}}var TH="!";function Vde(e){var t=e.separator||":",r=t.length===1,n=t[0],s=t.length;return function(i){for(var l=[],c=0,d=0,u,f=0;f<i.length;f++){var h=i[f];if(c===0){if(h===n&&(r||i.slice(f,f+s)===t)){l.push(i.slice(d,f)),d=f+s;continue}if(h==="/"){u=f;continue}}h==="["?c++:h==="]"&&c--}var m=l.length===0?i:i.substring(d),v=m.startsWith(TH),g=v?m.substring(1):m,y=u&&u>d?u-d:void 0;return{modifiers:l,hasImportantModifier:v,baseClassName:g,maybePostfixModifierPosition:y}}}function Wde(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var s=n[0]==="[";s?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function Hde(e){return{cache:Ude(e.cacheSize),splitModifiers:Vde(e),...Fde(e)}}var Gde=/\s+/;function Kde(e,t){var r=t.splitModifiers,n=t.getClassGroupId,s=t.getConflictingClassGroupIds,o=new Set;return e.trim().split(Gde).map(function(i){var l=r(i),c=l.modifiers,d=l.hasImportantModifier,u=l.baseClassName,f=l.maybePostfixModifierPosition,h=n(f?u.substring(0,f):u),m=!!f;if(!h){if(!f)return{isTailwindClass:!1,originalClassName:i};if(h=n(u),!h)return{isTailwindClass:!1,originalClassName:i};m=!1}var v=Wde(c).join(":"),g=d?v+TH:v;return{isTailwindClass:!0,modifierId:g,classGroupId:h,originalClassName:i,hasPostfixModifier:m}}).reverse().filter(function(i){if(!i.isTailwindClass)return!0;var l=i.modifierId,c=i.classGroupId,d=i.hasPostfixModifier,u=l+c;return o.has(u)?!1:(o.add(u),s(c,d).forEach(function(f){return o.add(l+f)}),!0)}).reverse().map(function(i){return i.originalClassName}).join(" ")}function Xde(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,s,o,i=l;function l(d){var u=t[0],f=t.slice(1),h=f.reduce(function(m,v){return v(m)},u());return n=Hde(h),s=n.cache.get,o=n.cache.set,i=c,c(d)}function c(d){var u=s(d);if(u)return u;var f=Kde(d,n);return o(d,f),f}return function(){return i(Lde.apply(null,arguments))}}function Fs(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var DH=/^\[(?:([a-z-]+):)?(.+)\]$/i,Yde=/^\d+\/\d+$/,Jde=new Set(["px","full","screen"]),Qde=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Zde=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,eue=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Bd(e){return _p(e)||Jde.has(e)||Yde.test(e)||tI(e)}function tI(e){return bg(e,"length",oue)}function tue(e){return bg(e,"size",MH)}function rue(e){return bg(e,"position",MH)}function nue(e){return bg(e,"url",iue)}function N2(e){return bg(e,"number",_p)}function _p(e){return!Number.isNaN(Number(e))}function aue(e){return e.endsWith("%")&&_p(e.slice(0,-1))}function Q0(e){return AF(e)||bg(e,"number",AF)}function Ra(e){return DH.test(e)}function Z0(){return!0}function gm(e){return Qde.test(e)}function sue(e){return bg(e,"",lue)}function bg(e,t,r){var n=DH.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function oue(e){return Zde.test(e)}function MH(){return!1}function iue(e){return e.startsWith("url(")}function AF(e){return Number.isInteger(Number(e))}function lue(e){return eue.test(e)}function cue(){var e=Fs("colors"),t=Fs("spacing"),r=Fs("blur"),n=Fs("brightness"),s=Fs("borderColor"),o=Fs("borderRadius"),i=Fs("borderSpacing"),l=Fs("borderWidth"),c=Fs("contrast"),d=Fs("grayscale"),u=Fs("hueRotate"),f=Fs("invert"),h=Fs("gap"),m=Fs("gradientColorStops"),v=Fs("gradientColorStopPositions"),g=Fs("inset"),y=Fs("margin"),x=Fs("opacity"),b=Fs("padding"),w=Fs("saturate"),j=Fs("scale"),_=Fs("sepia"),C=Fs("skew"),P=Fs("space"),E=Fs("translate"),A=function(){return["auto","contain","none"]},F=function(){return["auto","hidden","clip","visible","scroll"]},D=function(){return["auto",Ra,t]},I=function(){return[Ra,t]},R=function(){return["",Bd]},M=function(){return["auto",_p,Ra]},U=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},z=function(){return["solid","dashed","dotted","double","none"]},W=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},$=function(){return["start","end","center","between","around","evenly","stretch"]},ee=function(){return["","0",Ra]},ve=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},_e=function(){return[_p,N2]},K=function(){return[_p,Ra]};return{cacheSize:500,theme:{colors:[Z0],spacing:[Bd],blur:["none","",gm,Ra],brightness:_e(),borderColor:[e],borderRadius:["none","","full",gm,Ra],borderSpacing:I(),borderWidth:R(),contrast:_e(),grayscale:ee(),hueRotate:K(),invert:ee(),gap:I(),gradientColorStops:[e],gradientColorStopPositions:[aue,tI],inset:D(),margin:D(),opacity:_e(),padding:I(),saturate:_e(),scale:_e(),sepia:ee(),skew:K(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",Ra]}],container:["container"],columns:[{columns:[gm]}],"break-after":[{"break-after":ve()}],"break-before":[{"break-before":ve()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(U(),[Ra])}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Q0]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ra]}],grow:[{grow:ee()}],shrink:[{shrink:ee()}],order:[{order:["first","last","none",Q0]}],"grid-cols":[{"grid-cols":[Z0]}],"col-start-end":[{col:["auto",{span:["full",Q0]},Ra]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[Z0]}],"row-start-end":[{row:["auto",{span:[Q0]},Ra]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ra]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ra]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat($())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat($(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat($(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Ra,t]}],"min-w":[{"min-w":["min","max","fit",Ra,Bd]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[gm]},gm,Ra]}],h:[{h:[Ra,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Ra,Bd]}],"max-h":[{"max-h":[Ra,t,"min","max","fit"]}],"font-size":[{text:["base",gm,tI]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",N2]}],"font-family":[{font:[Z0]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ra]}],"line-clamp":[{"line-clamp":["none",_p,N2]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ra,Bd]}],"list-image":[{"list-image":["none",Ra]}],"list-style-type":[{list:["none","disc","decimal",Ra]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(z(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Bd]}],"underline-offset":[{"underline-offset":["auto",Ra,Bd]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ra]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ra]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(U(),[rue])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",tue]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},nue]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[].concat(z(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:z()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(z())}],"outline-offset":[{"outline-offset":[Ra,Bd]}],"outline-w":[{outline:[Bd]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:R()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Bd]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",gm,sue]}],"shadow-color":[{shadow:[Z0]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":W()}],"bg-blend":[{"bg-blend":W()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",gm,Ra]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ra]}],duration:[{duration:K()}],ease:[{ease:["linear","in","out","in-out",Ra]}],delay:[{delay:K()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ra]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[Q0,Ra]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ra]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ra]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ra]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Bd,N2]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var due=Xde(cue);function gr(...e){return due(ga(e))}const PF=["#3B82F6","#22C55E","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F43F5E","#10B981","#A855F7","#EAB308"];function uue(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return Math.abs(t)}function km(e){if(!e)return"#94A3B8";const t=uue(String(e))%PF.length;return PF[t]}var fue={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const mue=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Vr=(e,t)=>{const r=p.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:i,children:l,...c},d)=>p.createElement("svg",{ref:d,...fue,width:s,height:s,stroke:n,strokeWidth:i?Number(o)*24/Number(s):o,className:`lucide lucide-${mue(e)}`,...c},[...t.map(([u,f])=>p.createElement(u,f)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${e}`,r},Ic=Vr("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),zf=Vr("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),hue=Vr("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),Uy=Vr("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),S2=Vr("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),i4=Vr("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),l4=Vr("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),c4=Vr("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),Bj=Vr("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Vy=Vr("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),RH=Vr("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),pue=Vr("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]),D_=Vr("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),gue=Vr("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),tC=Vr("CalendarCheck",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),vue=Vr("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),d4=Vr("CalendarPlus",[["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"19",x2:"19",y1:"16",y2:"22",key:"1ttwzi"}],["line",{x1:"16",x2:"22",y1:"19",y2:"19",key:"1g9955"}]]),qj=Vr("CalendarX",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"10",x2:"14",y1:"14",y2:"18",key:"1g3qc0"}],["line",{x1:"14",x2:"10",y1:"14",y2:"18",key:"1az83m"}]]),Vs=Vr("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),C2=Vr("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Do=Vr("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Uf=Vr("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),wg=Vr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),LH=Vr("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),c0=Vr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),xue=Vr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),yue=Vr("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]),bue=Vr("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),wue=Vr("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]),yd=Vr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),FH=Vr("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Um=Vr("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Ko=Vr("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ho=Vr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Fp=Vr("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),rg=Vr("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),$g=Vr("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),Go=Vr("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),rI=Vr("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),jue=Vr("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),_ue=Vr("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),Nue=Vr("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),Sue=Vr("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),Cue=Vr("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Aue=Vr("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),Pue=Vr("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),$H=Vr("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Eue=Vr("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",key:"1kog09"}]]),kue=Vr("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),Iue=Vr("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),BH=Vr("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),qH=Vr("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),Oue=Vr("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),md=Vr("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),xx=Vr("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Tue=Vr("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),Due=Vr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),yx=Vr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),EF=Vr("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Mue=Vr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),VA=Vr("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Rue=Vr("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),kF=Vr("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Iv=Vr("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Lue=Vr("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),IF=Vr("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),Sd=Vr("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),xl=Vr("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Ub=Vr("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),zH=Vr("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),ns=Vr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),UH=Vr("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),$p=Vr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),OF=Vr("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Fue=Vr("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),to=Vr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),u4=Vr("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),bd=Vr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),TF=Vr("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),$ue=Vr("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Xv=Vr("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),i1=Vr("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),DF=Vr("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),WA=Vr("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),nI=Vr("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Bue=Vr("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),f4=Vr("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),A2=Vr("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),zu=Vr("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),que=Vr("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Vf=Vr("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Sc=Vr("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),zue=Vr("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),VH=Vr("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),m4=Vr("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Uue=Vr("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),Vue=Vr("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),Wue=Vr("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),WH=Vr("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Du=Vr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),yl=Vr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),HH=Vr("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),Bp=Vr("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),el=Vr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),tl=({size:e="md",variant:t="header",className:r=""})=>{const n={xs:"w-8 h-8",sm:"w-10 h-10",md:"w-14 h-14",lg:"w-20 h-20",xl:"w-24 h-24"},s={header:"/isis-profile.png",message:"/isis-profile-baloon.png"},o=s[t]||s.header,i=e==="lg"?"scale-125":e==="md"?"scale-110":"scale-100";return a.jsx("div",{className:`${n[e]||n.md} rounded-full overflow-hidden flex-shrink-0 ring-2 ring-brand ring-offset-0 ${r}`,children:a.jsx("img",{src:o,alt:"Assistente Virtual",className:`w-full h-full object-cover ${i}`,onError:l=>{l.target.style.display="none",l.target.parentElement.innerHTML=`
            <div class="w-full h-full bg-brand flex items-center justify-center">
              <span class="text-bg font-bold text-lg">A</span>
            </div>
          `}})})},GH=p.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),rC=p.createContext({}),nC=p.createContext(null),aC=typeof document<"u",h4=aC?p.useLayoutEffect:p.useEffect,KH=p.createContext({strict:!1}),p4=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Hue="framerAppearId",XH="data-"+p4(Hue);function Gue(e,t,r,n){const{visualElement:s}=p.useContext(rC),o=p.useContext(KH),i=p.useContext(nC),l=p.useContext(GH).reducedMotion,c=p.useRef();n=n||o.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:s,props:r,presenceContext:i,blockInitialAnimation:i?i.initial===!1:!1,reducedMotionConfig:l}));const d=c.current;p.useInsertionEffect(()=>{d&&d.update(r,i)});const u=p.useRef(!!(r[XH]&&!window.HandoffComplete));return h4(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),p.useEffect(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}function Ov(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Kue(e,t,r){return p.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Ov(r)&&(r.current=n))},[t])}function Vb(e){return typeof e=="string"||Array.isArray(e)}function sC(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const g4=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],v4=["initial",...g4];function oC(e){return sC(e.animate)||v4.some(t=>Vb(e[t]))}function YH(e){return!!(oC(e)||e.variants)}function Xue(e,t){if(oC(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Vb(r)?r:void 0,animate:Vb(n)?n:void 0}}return e.inherit!==!1?t:{}}function Yue(e){const{initial:t,animate:r}=Xue(e,p.useContext(rC));return p.useMemo(()=>({initial:t,animate:r}),[MF(t),MF(r)])}function MF(e){return Array.isArray(e)?e.join(" "):e}const RF={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Wb={};for(const e in RF)Wb[e]={isEnabled:t=>RF[e].some(r=>!!t[r])};function Jue(e){for(const t in e)Wb[t]={...Wb[t],...e[t]}}const x4=p.createContext({}),JH=p.createContext({}),Que=Symbol.for("motionComponentSymbol");function Zue({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:s}){e&&Jue(e);function o(l,c){let d;const u={...p.useContext(GH),...l,layoutId:efe(l)},{isStatic:f}=u,h=Yue(l),m=n(l,f);if(!f&&aC){h.visualElement=Gue(s,m,u,t);const v=p.useContext(JH),g=p.useContext(KH).strict;h.visualElement&&(d=h.visualElement.loadFeatures(u,g,e,v))}return p.createElement(rC.Provider,{value:h},d&&h.visualElement?p.createElement(d,{visualElement:h.visualElement,...u}):null,r(s,l,Kue(m,h.visualElement,c),m,f,h.visualElement))}const i=p.forwardRef(o);return i[Que]=s,i}function efe({layoutId:e}){const t=p.useContext(x4).id;return t&&e!==void 0?t+"-"+e:e}function tfe(e){function t(n,s={}){return Zue(e(n,s))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,s)=>(r.has(s)||r.set(s,t(s)),r.get(s))})}const rfe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function y4(e){return typeof e!="string"||e.includes("-")?!1:!!(rfe.indexOf(e)>-1||/[A-Z]/.test(e))}const M_={};function nfe(e){Object.assign(M_,e)}const l1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],jg=new Set(l1);function QH(e,{layout:t,layoutId:r}){return jg.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!M_[e]||e==="opacity")}const Zl=e=>!!(e&&e.getVelocity),afe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},sfe=l1.length;function ofe(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,s){let o="";for(let i=0;i<sfe;i++){const l=l1[i];if(e[l]!==void 0){const c=afe[l]||l;o+=`${c}(${e[l]}) `}}return t&&!e.z&&(o+="translateZ(0)"),o=o.trim(),s?o=s(e,n?"":o):r&&n&&(o="none"),o}const ZH=e=>t=>typeof t=="string"&&t.startsWith(e),eG=ZH("--"),aI=ZH("var(--"),ife=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,lfe=(e,t)=>t&&typeof e=="number"?t.transform(e):e,jh=(e,t,r)=>Math.min(Math.max(r,e),t),_g={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Wy={..._g,transform:e=>jh(0,1,e)},P2={..._g,default:1},Hy=e=>Math.round(e*1e5)/1e5,iC=/(-)?([\d]*\.?[\d])+/g,tG=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,cfe=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function c1(e){return typeof e=="string"}const d1=e=>({test:t=>c1(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Nm=d1("deg"),Uu=d1("%"),ia=d1("px"),dfe=d1("vh"),ufe=d1("vw"),LF={...Uu,parse:e=>Uu.parse(e)/100,transform:e=>Uu.transform(e*100)},FF={..._g,transform:Math.round},rG={borderWidth:ia,borderTopWidth:ia,borderRightWidth:ia,borderBottomWidth:ia,borderLeftWidth:ia,borderRadius:ia,radius:ia,borderTopLeftRadius:ia,borderTopRightRadius:ia,borderBottomRightRadius:ia,borderBottomLeftRadius:ia,width:ia,maxWidth:ia,height:ia,maxHeight:ia,size:ia,top:ia,right:ia,bottom:ia,left:ia,padding:ia,paddingTop:ia,paddingRight:ia,paddingBottom:ia,paddingLeft:ia,margin:ia,marginTop:ia,marginRight:ia,marginBottom:ia,marginLeft:ia,rotate:Nm,rotateX:Nm,rotateY:Nm,rotateZ:Nm,scale:P2,scaleX:P2,scaleY:P2,scaleZ:P2,skew:Nm,skewX:Nm,skewY:Nm,distance:ia,translateX:ia,translateY:ia,translateZ:ia,x:ia,y:ia,z:ia,perspective:ia,transformPerspective:ia,opacity:Wy,originX:LF,originY:LF,originZ:ia,zIndex:FF,fillOpacity:Wy,strokeOpacity:Wy,numOctaves:FF};function b4(e,t,r,n){const{style:s,vars:o,transform:i,transformOrigin:l}=e;let c=!1,d=!1,u=!0;for(const f in t){const h=t[f];if(eG(f)){o[f]=h;continue}const m=rG[f],v=lfe(h,m);if(jg.has(f)){if(c=!0,i[f]=v,!u)continue;h!==(m.default||0)&&(u=!1)}else f.startsWith("origin")?(d=!0,l[f]=v):s[f]=v}if(t.transform||(c||n?s.transform=ofe(e.transform,r,u,n):s.transform&&(s.transform="none")),d){const{originX:f="50%",originY:h="50%",originZ:m=0}=l;s.transformOrigin=`${f} ${h} ${m}`}}const w4=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function nG(e,t,r){for(const n in t)!Zl(t[n])&&!QH(n,r)&&(e[n]=t[n])}function ffe({transformTemplate:e},t,r){return p.useMemo(()=>{const n=w4();return b4(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function mfe(e,t,r){const n=e.style||{},s={};return nG(s,n,e),Object.assign(s,ffe(e,t,r)),e.transformValues?e.transformValues(s):s}function hfe(e,t,r){const n={},s=mfe(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=s,n}const pfe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function R_(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||pfe.has(e)}let aG=e=>!R_(e);function gfe(e){e&&(aG=t=>t.startsWith("on")?!R_(t):e(t))}try{gfe(require("@emotion/is-prop-valid").default)}catch{}function vfe(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(aG(s)||r===!0&&R_(s)||!t&&!R_(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}function $F(e,t,r){return typeof e=="string"?e:ia.transform(t+r*e)}function xfe(e,t,r){const n=$F(t,e.x,e.width),s=$F(r,e.y,e.height);return`${n} ${s}`}const yfe={offset:"stroke-dashoffset",array:"stroke-dasharray"},bfe={offset:"strokeDashoffset",array:"strokeDasharray"};function wfe(e,t,r=1,n=0,s=!0){e.pathLength=1;const o=s?yfe:bfe;e[o.offset]=ia.transform(-n);const i=ia.transform(t),l=ia.transform(r);e[o.array]=`${i} ${l}`}function j4(e,{attrX:t,attrY:r,attrScale:n,originX:s,originY:o,pathLength:i,pathSpacing:l=1,pathOffset:c=0,...d},u,f,h){if(b4(e,d,u,h),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:m,style:v,dimensions:g}=e;m.transform&&(g&&(v.transform=m.transform),delete m.transform),g&&(s!==void 0||o!==void 0||v.transform)&&(v.transformOrigin=xfe(g,s!==void 0?s:.5,o!==void 0?o:.5)),t!==void 0&&(m.x=t),r!==void 0&&(m.y=r),n!==void 0&&(m.scale=n),i!==void 0&&wfe(m,i,l,c,!1)}const sG=()=>({...w4(),attrs:{}}),_4=e=>typeof e=="string"&&e.toLowerCase()==="svg";function jfe(e,t,r,n){const s=p.useMemo(()=>{const o=sG();return j4(o,t,{enableHardwareAcceleration:!1},_4(n),e.transformTemplate),{...o.attrs,style:{...o.style}}},[t]);if(e.style){const o={};nG(o,e.style,e),s.style={...o,...s.style}}return s}function _fe(e=!1){return(r,n,s,{latestValues:o},i)=>{const c=(y4(r)?jfe:hfe)(n,o,i,r),u={...vfe(n,typeof r=="string",e),...c,ref:s},{children:f}=n,h=p.useMemo(()=>Zl(f)?f.get():f,[f]);return p.createElement(r,{...u,children:h})}}function oG(e,{style:t,vars:r},n,s){Object.assign(e.style,t,s&&s.getProjectionStyles(n));for(const o in r)e.style.setProperty(o,r[o])}const iG=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function lG(e,t,r,n){oG(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(iG.has(s)?s:p4(s),t.attrs[s])}function N4(e,t){const{style:r}=e,n={};for(const s in r)(Zl(r[s])||t.style&&Zl(t.style[s])||QH(s,e))&&(n[s]=r[s]);return n}function cG(e,t){const r=N4(e,t);for(const n in e)if(Zl(e[n])||Zl(t[n])){const s=l1.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[s]=e[n]}return r}function S4(e,t,r,n={},s={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),t}function dG(e){const t=p.useRef(null);return t.current===null&&(t.current=e()),t.current}const L_=e=>Array.isArray(e),Nfe=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),Sfe=e=>L_(e)?e[e.length-1]||0:e;function zj(e){const t=Zl(e)?e.get():e;return Nfe(t)?t.toValue():t}function Cfe({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,s,o){const i={latestValues:Afe(n,s,o,e),renderState:t()};return r&&(i.mount=l=>r(n,l,i)),i}const uG=e=>(t,r)=>{const n=p.useContext(rC),s=p.useContext(nC),o=()=>Cfe(e,t,n,s);return r?o():dG(o)};function Afe(e,t,r,n){const s={},o=n(e,{});for(const h in o)s[h]=zj(o[h]);let{initial:i,animate:l}=e;const c=oC(e),d=YH(e);t&&d&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),l===void 0&&(l=t.animate));let u=r?r.initial===!1:!1;u=u||i===!1;const f=u?l:i;return f&&typeof f!="boolean"&&!sC(f)&&(Array.isArray(f)?f:[f]).forEach(m=>{const v=S4(e,m);if(!v)return;const{transitionEnd:g,transition:y,...x}=v;for(const b in x){let w=x[b];if(Array.isArray(w)){const j=u?w.length-1:0;w=w[j]}w!==null&&(s[b]=w)}for(const b in g)s[b]=g[b]}),s}const go=e=>e;class BF{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function Pfe(e){let t=new BF,r=new BF,n=0,s=!1,o=!1;const i=new WeakSet,l={schedule:(c,d=!1,u=!1)=>{const f=u&&s,h=f?t:r;return d&&i.add(c),h.add(c)&&f&&s&&(n=t.order.length),c},cancel:c=>{r.remove(c),i.delete(c)},process:c=>{if(s){o=!0;return}if(s=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let d=0;d<n;d++){const u=t.order[d];u(c),i.has(u)&&(l.schedule(u),e())}s=!1,o&&(o=!1,l.process(c))}};return l}const E2=["prepare","read","update","preRender","render","postRender"],Efe=40;function kfe(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},o=E2.reduce((f,h)=>(f[h]=Pfe(()=>r=!0),f),{}),i=f=>o[f].process(s),l=()=>{const f=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(f-s.timestamp,Efe),1),s.timestamp=f,s.isProcessing=!0,E2.forEach(i),s.isProcessing=!1,r&&t&&(n=!1,e(l))},c=()=>{r=!0,n=!0,s.isProcessing||e(l)};return{schedule:E2.reduce((f,h)=>{const m=o[h];return f[h]=(v,g=!1,y=!1)=>(r||c(),m.schedule(v,g,y)),f},{}),cancel:f=>E2.forEach(h=>o[h].cancel(f)),state:s,steps:o}}const{schedule:Os,cancel:Wf,state:Ki,steps:HA}=kfe(typeof requestAnimationFrame<"u"?requestAnimationFrame:go,!0),Ife={useVisualState:uG({scrapeMotionValuesFromProps:cG,createRenderState:sG,onMount:(e,t,{renderState:r,latestValues:n})=>{Os.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),Os.render(()=>{j4(r,n,{enableHardwareAcceleration:!1},_4(t.tagName),e.transformTemplate),lG(t,r)})}})},Ofe={useVisualState:uG({scrapeMotionValuesFromProps:N4,createRenderState:w4})};function Tfe(e,{forwardMotionProps:t=!1},r,n){return{...y4(e)?Ife:Ofe,preloadedFeatures:r,useRender:_fe(t),createVisualElement:n,Component:e}}function Pf(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const fG=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function lC(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const Dfe=e=>t=>fG(t)&&e(t,lC(t));function Df(e,t,r,n){return Pf(e,t,Dfe(r),n)}const Mfe=(e,t)=>r=>t(e(r)),oh=(...e)=>e.reduce(Mfe);function mG(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const qF=mG("dragHorizontal"),zF=mG("dragVertical");function hG(e){let t=!1;if(e==="y")t=zF();else if(e==="x")t=qF();else{const r=qF(),n=zF();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function pG(){const e=hG(!0);return e?(e(),!1):!0}class Rh{constructor(t){this.isMounted=!1,this.node=t}update(){}}function UF(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),s=(o,i)=>{if(o.pointerType==="touch"||pG())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&Os.update(()=>l[n](o,i))};return Df(e.current,r,s,{passive:!e.getProps()[n]})}class Rfe extends Rh{mount(){this.unmount=oh(UF(this.node,!0),UF(this.node,!1))}unmount(){}}class Lfe extends Rh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=oh(Pf(this.node.current,"focus",()=>this.onFocus()),Pf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const gG=(e,t)=>t?e===t?!0:gG(e,t.parentElement):!1;function GA(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,lC(r))}class Ffe extends Rh{constructor(){super(...arguments),this.removeStartListeners=go,this.removeEndListeners=go,this.removeAccessibleListeners=go,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),o=Df(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:f}=this.node.getProps();Os.update(()=>{!f&&!gG(this.node.current,l.target)?u&&u(l,c):d&&d(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),i=Df(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=oh(o,i),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=o=>{if(o.key!=="Enter"||this.isPressing)return;const i=l=>{l.key!=="Enter"||!this.checkPressEnd()||GA("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&Os.update(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=Pf(this.node.current,"keyup",i),GA("down",(l,c)=>{this.startPress(l,c)})},r=Pf(this.node.current,"keydown",t),n=()=>{this.isPressing&&GA("cancel",(o,i)=>this.cancelPress(o,i))},s=Pf(this.node.current,"blur",n);this.removeAccessibleListeners=oh(r,s)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&Os.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!pG()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&Os.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=Df(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Pf(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=oh(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const sI=new WeakMap,KA=new WeakMap,$fe=e=>{const t=sI.get(e.target);t&&t(e)},Bfe=e=>{e.forEach($fe)};function qfe({root:e,...t}){const r=e||document;KA.has(r)||KA.set(r,{});const n=KA.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(Bfe,{root:e,...t})),n[s]}function zfe(e,t,r){const n=qfe(t);return sI.set(e,r),n.observe(e),()=>{sI.delete(e),n.unobserve(e)}}const Ufe={some:0,all:1};class Vfe extends Rh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:o}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:Ufe[s]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,o&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),h=d?u:f;h&&h(c)};return zfe(this.node.current,i,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(Wfe(t,r))&&this.startObserver()}unmount(){}}function Wfe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const Hfe={inView:{Feature:Vfe},tap:{Feature:Ffe},focus:{Feature:Lfe},hover:{Feature:Rfe}};function vG(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Gfe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function Kfe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function cC(e,t,r){const n=e.getProps();return S4(n,t,r!==void 0?r:n.custom,Gfe(e),Kfe(e))}let Xfe=go,C4=go;const ih=e=>e*1e3,Mf=e=>e/1e3,Yfe={current:!1},xG=e=>Array.isArray(e)&&typeof e[0]=="number";function yG(e){return!!(!e||typeof e=="string"&&bG[e]||xG(e)||Array.isArray(e)&&e.every(yG))}const Ay=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,bG={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ay([0,.65,.55,1]),circOut:Ay([.55,0,1,.45]),backIn:Ay([.31,.01,.66,-.59]),backOut:Ay([.33,1.53,.69,.99])};function wG(e){if(e)return xG(e)?Ay(e):Array.isArray(e)?e.map(wG):bG[e]}function Jfe(e,t,r,{delay:n=0,duration:s,repeat:o=0,repeatType:i="loop",ease:l,times:c}={}){const d={[t]:r};c&&(d.offset=c);const u=wG(l);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:s,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:o+1,direction:i==="reverse"?"alternate":"normal"})}function Qfe(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const jG=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Zfe=1e-7,eme=12;function tme(e,t,r,n,s){let o,i,l=0;do i=t+(r-t)/2,o=jG(i,n,s)-e,o>0?r=i:t=i;while(Math.abs(o)>Zfe&&++l<eme);return i}function u1(e,t,r,n){if(e===t&&r===n)return go;const s=o=>tme(o,0,1,e,r);return o=>o===0||o===1?o:jG(s(o),t,n)}const rme=u1(.42,0,1,1),nme=u1(0,0,.58,1),_G=u1(.42,0,.58,1),ame=e=>Array.isArray(e)&&typeof e[0]!="number",NG=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,SG=e=>t=>1-e(1-t),A4=e=>1-Math.sin(Math.acos(e)),CG=SG(A4),sme=NG(A4),AG=u1(.33,1.53,.69,.99),P4=SG(AG),ome=NG(P4),ime=e=>(e*=2)<1?.5*P4(e):.5*(2-Math.pow(2,-10*(e-1))),lme={linear:go,easeIn:rme,easeInOut:_G,easeOut:nme,circIn:A4,circInOut:sme,circOut:CG,backIn:P4,backInOut:ome,backOut:AG,anticipate:ime},VF=e=>{if(Array.isArray(e)){C4(e.length===4);const[t,r,n,s]=e;return u1(t,r,n,s)}else if(typeof e=="string")return lme[e];return e},E4=(e,t)=>r=>!!(c1(r)&&cfe.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),PG=(e,t,r)=>n=>{if(!c1(n))return n;const[s,o,i,l]=n.match(iC);return{[e]:parseFloat(s),[t]:parseFloat(o),[r]:parseFloat(i),alpha:l!==void 0?parseFloat(l):1}},cme=e=>jh(0,255,e),XA={..._g,transform:e=>Math.round(cme(e))},Np={test:E4("rgb","red"),parse:PG("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+XA.transform(e)+", "+XA.transform(t)+", "+XA.transform(r)+", "+Hy(Wy.transform(n))+")"};function dme(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const oI={test:E4("#"),parse:dme,transform:Np.transform},Tv={test:E4("hsl","hue"),parse:PG("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Uu.transform(Hy(t))+", "+Uu.transform(Hy(r))+", "+Hy(Wy.transform(n))+")"},hl={test:e=>Np.test(e)||oI.test(e)||Tv.test(e),parse:e=>Np.test(e)?Np.parse(e):Tv.test(e)?Tv.parse(e):oI.parse(e),transform:e=>c1(e)?e:e.hasOwnProperty("red")?Np.transform(e):Tv.transform(e)},ro=(e,t,r)=>-r*e+r*t+e;function YA(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function ume({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,o=0,i=0;if(!t)s=o=i=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;s=YA(c,l,e+1/3),o=YA(c,l,e),i=YA(c,l,e-1/3)}return{red:Math.round(s*255),green:Math.round(o*255),blue:Math.round(i*255),alpha:n}}const JA=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},fme=[oI,Np,Tv],mme=e=>fme.find(t=>t.test(e));function WF(e){const t=mme(e);let r=t.parse(e);return t===Tv&&(r=ume(r)),r}const EG=(e,t)=>{const r=WF(e),n=WF(t),s={...r};return o=>(s.red=JA(r.red,n.red,o),s.green=JA(r.green,n.green,o),s.blue=JA(r.blue,n.blue,o),s.alpha=ro(r.alpha,n.alpha,o),Np.transform(s))};function hme(e){var t,r;return isNaN(e)&&c1(e)&&(((t=e.match(iC))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(tG))===null||r===void 0?void 0:r.length)||0)>0}const kG={regex:ife,countKey:"Vars",token:"${v}",parse:go},IG={regex:tG,countKey:"Colors",token:"${c}",parse:hl.parse},OG={regex:iC,countKey:"Numbers",token:"${n}",parse:_g.parse};function QA(e,{regex:t,countKey:r,token:n,parse:s}){const o=e.tokenised.match(t);o&&(e["num"+r]=o.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...o.map(s)))}function F_(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&QA(r,kG),QA(r,IG),QA(r,OG),r}function TG(e){return F_(e).values}function DG(e){const{values:t,numColors:r,numVars:n,tokenised:s}=F_(e),o=t.length;return i=>{let l=s;for(let c=0;c<o;c++)c<n?l=l.replace(kG.token,i[c]):c<n+r?l=l.replace(IG.token,hl.transform(i[c])):l=l.replace(OG.token,Hy(i[c]));return l}}const pme=e=>typeof e=="number"?0:e;function gme(e){const t=TG(e);return DG(e)(t.map(pme))}const _h={test:hme,parse:TG,createTransformer:DG,getAnimatableNone:gme},MG=(e,t)=>r=>`${r>0?t:e}`;function RG(e,t){return typeof e=="number"?r=>ro(e,t,r):hl.test(e)?EG(e,t):e.startsWith("var(")?MG(e,t):FG(e,t)}const LG=(e,t)=>{const r=[...e],n=r.length,s=e.map((o,i)=>RG(o,t[i]));return o=>{for(let i=0;i<n;i++)r[i]=s[i](o);return r}},vme=(e,t)=>{const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=RG(e[s],t[s]));return s=>{for(const o in n)r[o]=n[o](s);return r}},FG=(e,t)=>{const r=_h.createTransformer(t),n=F_(e),s=F_(t);return n.numVars===s.numVars&&n.numColors===s.numColors&&n.numNumbers>=s.numNumbers?oh(LG(n.values,s.values),r):MG(e,t)},Hb=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},HF=(e,t)=>r=>ro(e,t,r);function xme(e){return typeof e=="number"?HF:typeof e=="string"?hl.test(e)?EG:FG:Array.isArray(e)?LG:typeof e=="object"?vme:HF}function yme(e,t,r){const n=[],s=r||xme(e[0]),o=e.length-1;for(let i=0;i<o;i++){let l=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||go:t;l=oh(c,l)}n.push(l)}return n}function $G(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const o=e.length;if(C4(o===t.length),o===1)return()=>t[0];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=yme(t,n,s),l=i.length,c=d=>{let u=0;if(l>1)for(;u<e.length-2&&!(d<e[u+1]);u++);const f=Hb(e[u],e[u+1],d);return i[u](f)};return r?d=>c(jh(e[0],e[o-1],d)):c}function bme(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Hb(0,t,n);e.push(ro(r,1,s))}}function wme(e){const t=[0];return bme(t,e.length-1),t}function jme(e,t){return e.map(r=>r*t)}function _me(e,t){return e.map(()=>t||_G).splice(0,e.length-1)}function $_({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=ame(n)?n.map(VF):VF(n),o={done:!1,value:t[0]},i=jme(r&&r.length===t.length?r:wme(t),e),l=$G(i,t,{ease:Array.isArray(s)?s:_me(t,s)});return{calculatedDuration:e,next:c=>(o.value=l(c),o.done=c>=e,o)}}function BG(e,t){return t?e*(1e3/t):0}const Nme=5;function qG(e,t,r){const n=Math.max(t-Nme,0);return BG(r-e(n),t-n)}const ZA=.001,Sme=.01,GF=10,Cme=.05,Ame=1;function Pme({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let s,o;Xfe(e<=ih(GF));let i=1-t;i=jh(Cme,Ame,i),e=jh(Sme,GF,Mf(e)),i<1?(s=d=>{const u=d*i,f=u*e,h=u-r,m=iI(d,i),v=Math.exp(-f);return ZA-h/m*v},o=d=>{const f=d*i*e,h=f*r+r,m=Math.pow(i,2)*Math.pow(d,2)*e,v=Math.exp(-f),g=iI(Math.pow(d,2),i);return(-s(d)+ZA>0?-1:1)*((h-m)*v)/g}):(s=d=>{const u=Math.exp(-d*e),f=(d-r)*e+1;return-ZA+u*f},o=d=>{const u=Math.exp(-d*e),f=(r-d)*(e*e);return u*f});const l=5/e,c=kme(s,o,l);if(e=ih(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:i*2*Math.sqrt(n*d),duration:e}}}const Eme=12;function kme(e,t,r){let n=r;for(let s=1;s<Eme;s++)n=n-e(n)/t(n);return n}function iI(e,t){return e*Math.sqrt(1-t*t)}const Ime=["duration","bounce"],Ome=["stiffness","damping","mass"];function KF(e,t){return t.some(r=>e[r]!==void 0)}function Tme(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!KF(e,Ome)&&KF(e,Ime)){const r=Pme(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function zG({keyframes:e,restDelta:t,restSpeed:r,...n}){const s=e[0],o=e[e.length-1],i={done:!1,value:s},{stiffness:l,damping:c,mass:d,duration:u,velocity:f,isResolvedFromDuration:h}=Tme({...n,velocity:-Mf(n.velocity||0)}),m=f||0,v=c/(2*Math.sqrt(l*d)),g=o-s,y=Mf(Math.sqrt(l/d)),x=Math.abs(g)<5;r||(r=x?.01:2),t||(t=x?.005:.5);let b;if(v<1){const w=iI(y,v);b=j=>{const _=Math.exp(-v*y*j);return o-_*((m+v*y*g)/w*Math.sin(w*j)+g*Math.cos(w*j))}}else if(v===1)b=w=>o-Math.exp(-y*w)*(g+(m+y*g)*w);else{const w=y*Math.sqrt(v*v-1);b=j=>{const _=Math.exp(-v*y*j),C=Math.min(w*j,300);return o-_*((m+v*y*g)*Math.sinh(C)+w*g*Math.cosh(C))/w}}return{calculatedDuration:h&&u||null,next:w=>{const j=b(w);if(h)i.done=w>=u;else{let _=m;w!==0&&(v<1?_=qG(b,w,j):_=0);const C=Math.abs(_)<=r,P=Math.abs(o-j)<=t;i.done=C&&P}return i.value=i.done?o:j,i}}}function XF({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:i,min:l,max:c,restDelta:d=.5,restSpeed:u}){const f=e[0],h={done:!1,value:f},m=E=>l!==void 0&&E<l||c!==void 0&&E>c,v=E=>l===void 0?c:c===void 0||Math.abs(l-E)<Math.abs(c-E)?l:c;let g=r*t;const y=f+g,x=i===void 0?y:i(y);x!==y&&(g=x-f);const b=E=>-g*Math.exp(-E/n),w=E=>x+b(E),j=E=>{const A=b(E),F=w(E);h.done=Math.abs(A)<=d,h.value=h.done?x:F};let _,C;const P=E=>{m(h.value)&&(_=E,C=zG({keyframes:[h.value,v(h.value)],velocity:qG(w,E,h.value),damping:s,stiffness:o,restDelta:d,restSpeed:u}))};return P(0),{calculatedDuration:null,next:E=>{let A=!1;return!C&&_===void 0&&(A=!0,j(E),P(E)),_!==void 0&&E>_?C.next(E-_):(!A&&j(E),h)}}}const Dme=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Os.update(t,!0),stop:()=>Wf(t),now:()=>Ki.isProcessing?Ki.timestamp:performance.now()}},YF=2e4;function JF(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<YF;)t+=r,n=e.next(t);return t>=YF?1/0:t}const Mme={decay:XF,inertia:XF,tween:$_,keyframes:$_,spring:zG};function B_({autoplay:e=!0,delay:t=0,driver:r=Dme,keyframes:n,type:s="keyframes",repeat:o=0,repeatDelay:i=0,repeatType:l="loop",onPlay:c,onStop:d,onComplete:u,onUpdate:f,...h}){let m=1,v=!1,g,y;const x=()=>{y=new Promise(_e=>{g=_e})};x();let b;const w=Mme[s]||$_;let j;w!==$_&&typeof n[0]!="number"&&(j=$G([0,100],n,{clamp:!1}),n=[0,100]);const _=w({...h,keyframes:n});let C;l==="mirror"&&(C=w({...h,keyframes:[...n].reverse(),velocity:-(h.velocity||0)}));let P="idle",E=null,A=null,F=null;_.calculatedDuration===null&&o&&(_.calculatedDuration=JF(_));const{calculatedDuration:D}=_;let I=1/0,R=1/0;D!==null&&(I=D+i,R=I*(o+1)-i);let M=0;const U=_e=>{if(A===null)return;m>0&&(A=Math.min(A,_e)),m<0&&(A=Math.min(_e-R/m,A)),E!==null?M=E:M=Math.round(_e-A)*m;const K=M-t*(m>=0?1:-1),q=m>=0?K<0:K>R;M=Math.max(K,0),P==="finished"&&E===null&&(M=R);let Y=M,J=_;if(o){const le=Math.min(M,R)/I;let ie=Math.floor(le),te=le%1;!te&&le>=1&&(te=1),te===1&&ie--,ie=Math.min(ie,o+1),!!(ie%2)&&(l==="reverse"?(te=1-te,i&&(te-=i/I)):l==="mirror"&&(J=C)),Y=jh(0,1,te)*I}const fe=q?{done:!1,value:n[0]}:J.next(Y);j&&(fe.value=j(fe.value));let{done:Z}=fe;!q&&D!==null&&(Z=m>=0?M>=R:M<=0);const ce=E===null&&(P==="finished"||P==="running"&&Z);return f&&f(fe.value),ce&&$(),fe},z=()=>{b&&b.stop(),b=void 0},W=()=>{P="idle",z(),g(),x(),A=F=null},$=()=>{P="finished",u&&u(),z(),g()},ee=()=>{if(v)return;b||(b=r(U));const _e=b.now();c&&c(),E!==null?A=_e-E:(!A||P==="finished")&&(A=_e),P==="finished"&&x(),F=A,E=null,P="running",b.start()};e&&ee();const ve={then(_e,K){return y.then(_e,K)},get time(){return Mf(M)},set time(_e){_e=ih(_e),M=_e,E!==null||!b||m===0?E=_e:A=b.now()-_e/m},get duration(){const _e=_.calculatedDuration===null?JF(_):_.calculatedDuration;return Mf(_e)},get speed(){return m},set speed(_e){_e===m||!b||(m=_e,ve.time=Mf(M))},get state(){return P},play:ee,pause:()=>{P="paused",E=M},stop:()=>{v=!0,P!=="idle"&&(P="idle",d&&d(),W())},cancel:()=>{F!==null&&U(F),W()},complete:()=>{P="finished"},sample:_e=>(A=0,U(_e))};return ve}function Rme(e){let t;return()=>(t===void 0&&(t=e()),t)}const Lme=Rme(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Fme=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),k2=10,$me=2e4,Bme=(e,t)=>t.type==="spring"||e==="backgroundColor"||!yG(t.ease);function qme(e,t,{onUpdate:r,onComplete:n,...s}){if(!(Lme()&&Fme.has(t)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let i=!1,l,c,d=!1;const u=()=>{c=new Promise(w=>{l=w})};u();let{keyframes:f,duration:h=300,ease:m,times:v}=s;if(Bme(t,s)){const w=B_({...s,repeat:0,delay:0});let j={done:!1,value:f[0]};const _=[];let C=0;for(;!j.done&&C<$me;)j=w.sample(C),_.push(j.value),C+=k2;v=void 0,f=_,h=C-k2,m="linear"}const g=Jfe(e.owner.current,t,f,{...s,duration:h,ease:m,times:v}),y=()=>{d=!1,g.cancel()},x=()=>{d=!0,Os.update(y),l(),u()};return g.onfinish=()=>{d||(e.set(Qfe(f,s)),n&&n(),x())},{then(w,j){return c.then(w,j)},attachTimeline(w){return g.timeline=w,g.onfinish=null,go},get time(){return Mf(g.currentTime||0)},set time(w){g.currentTime=ih(w)},get speed(){return g.playbackRate},set speed(w){g.playbackRate=w},get duration(){return Mf(h)},play:()=>{i||(g.play(),Wf(y))},pause:()=>g.pause(),stop:()=>{if(i=!0,g.playState==="idle")return;const{currentTime:w}=g;if(w){const j=B_({...s,autoplay:!1});e.setWithVelocity(j.sample(w-k2).value,j.sample(w).value,k2)}x()},complete:()=>{d||g.finish()},cancel:x}}function zme({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const s=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:go,pause:go,stop:go,then:o=>(o(),Promise.resolve()),cancel:go,complete:go});return t?B_({keyframes:[0,1],duration:0,delay:t,onComplete:s}):s()}const Ume={type:"spring",stiffness:500,damping:25,restSpeed:10},Vme=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Wme={type:"keyframes",duration:.8},Hme={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Gme=(e,{keyframes:t})=>t.length>2?Wme:jg.has(e)?e.startsWith("scale")?Vme(t[1]):Ume:Hme,lI=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(_h.test(t)||t==="0")&&!t.startsWith("url(")),Kme=new Set(["brightness","contrast","saturate","opacity"]);function Xme(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(iC)||[];if(!n)return e;const s=r.replace(n,"");let o=Kme.has(t)?1:0;return n!==r&&(o*=100),t+"("+o+s+")"}const Yme=/([a-z-]*)\(.*?\)/g,cI={..._h,getAnimatableNone:e=>{const t=e.match(Yme);return t?t.map(Xme).join(" "):e}},Jme={...rG,color:hl,backgroundColor:hl,outlineColor:hl,fill:hl,stroke:hl,borderColor:hl,borderTopColor:hl,borderRightColor:hl,borderBottomColor:hl,borderLeftColor:hl,filter:cI,WebkitFilter:cI},k4=e=>Jme[e];function UG(e,t){let r=k4(e);return r!==cI&&(r=_h),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const VG=e=>/^0[^.\s]+$/.test(e);function Qme(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||VG(e)}function Zme(e,t,r,n){const s=lI(t,r);let o;Array.isArray(r)?o=[...r]:o=[null,r];const i=n.from!==void 0?n.from:e.get();let l;const c=[];for(let d=0;d<o.length;d++)o[d]===null&&(o[d]=d===0?i:o[d-1]),Qme(o[d])&&c.push(d),typeof o[d]=="string"&&o[d]!=="none"&&o[d]!=="0"&&(l=o[d]);if(s&&c.length&&l)for(let d=0;d<c.length;d++){const u=c[d];o[u]=UG(t,l)}return o}function ehe({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:o,repeatType:i,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}function I4(e,t){return e[t]||e.default||e}const the={skipAnimations:!1},O4=(e,t,r,n={})=>s=>{const o=I4(n,e)||{},i=o.delay||n.delay||0;let{elapsed:l=0}=n;l=l-ih(i);const c=Zme(t,e,r,o),d=c[0],u=c[c.length-1],f=lI(e,d),h=lI(e,u);let m={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...o,delay:-l,onUpdate:v=>{t.set(v),o.onUpdate&&o.onUpdate(v)},onComplete:()=>{s(),o.onComplete&&o.onComplete()}};if(ehe(o)||(m={...m,...Gme(e,m)}),m.duration&&(m.duration=ih(m.duration)),m.repeatDelay&&(m.repeatDelay=ih(m.repeatDelay)),!f||!h||Yfe.current||o.type===!1||the.skipAnimations)return zme(m);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const v=qme(t,e,m);if(v)return v}return B_(m)};function q_(e){return!!(Zl(e)&&e.add)}const WG=e=>/^\-?\d*\.?\d+$/.test(e);function T4(e,t){e.indexOf(t)===-1&&e.push(t)}function D4(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class M4{constructor(){this.subscriptions=[]}add(t){return T4(this.subscriptions,t),()=>D4(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let o=0;o<s;o++){const i=this.subscriptions[o];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const rhe=e=>!isNaN(parseFloat(e));class nhe{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,s=!0)=>{this.prev=this.current,this.current=n;const{delta:o,timestamp:i}=Ki;this.lastUpdated!==i&&(this.timeDelta=o,this.lastUpdated=i,Os.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Os.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=rhe(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new M4);const n=this.events[t].add(r);return t==="change"?()=>{n(),Os.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?BG(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function bx(e,t){return new nhe(e,t)}const HG=e=>t=>t.test(e),ahe={test:e=>e==="auto",parse:e=>e},GG=[_g,ia,Uu,Nm,ufe,dfe,ahe],ey=e=>GG.find(HG(e)),she=[...GG,hl,_h],ohe=e=>she.find(HG(e));function ihe(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,bx(r))}function lhe(e,t){const r=cC(e,t);let{transitionEnd:n={},transition:s={},...o}=r?e.makeTargetAnimatable(r,!1):{};o={...o,...n};for(const i in o){const l=Sfe(o[i]);ihe(e,i,l)}}function che(e,t,r){var n,s;const o=Object.keys(t).filter(l=>!e.hasValue(l)),i=o.length;if(i)for(let l=0;l<i;l++){const c=o[l],d=t[c];let u=null;Array.isArray(d)&&(u=d[0]),u===null&&(u=(s=(n=r[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&s!==void 0?s:t[c]),u!=null&&(typeof u=="string"&&(WG(u)||VG(u))?u=parseFloat(u):!ohe(u)&&_h.test(d)&&(u=UG(c,d)),e.addValue(c,bx(u,{owner:e})),r[c]===void 0&&(r[c]=u),u!==null&&e.setBaseTarget(c,u))}}function dhe(e,t){return t?(t[e]||t.default||t).from:void 0}function uhe(e,t,r){const n={};for(const s in e){const o=dhe(s,t);if(o!==void 0)n[s]=o;else{const i=r.getValue(s);i&&(n[s]=i.get())}}return n}function fhe({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function mhe(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function KG(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:o=e.getDefaultTransition(),transitionEnd:i,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(o=n);const d=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const f in l){const h=e.getValue(f),m=l[f];if(!h||m===void 0||u&&fhe(u,f))continue;const v={delay:r,elapsed:0,...I4(o||{},f)};if(window.HandoffAppearAnimations){const x=e.getProps()[XH];if(x){const b=window.HandoffAppearAnimations(x,f,h,Os);b!==null&&(v.elapsed=b,v.isHandoff=!0)}}let g=!v.isHandoff&&!mhe(h,m);if(v.type==="spring"&&(h.getVelocity()||v.velocity)&&(g=!1),h.animation&&(g=!1),g)continue;h.start(O4(f,h,m,e.shouldReduceMotion&&jg.has(f)?{type:!1}:v));const y=h.animation;q_(c)&&(c.add(f),y.then(()=>c.remove(f))),d.push(y)}return i&&Promise.all(d).then(()=>{i&&lhe(e,i)}),d}function dI(e,t,r={}){const n=cC(e,t,r.custom);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const o=n?()=>Promise.all(KG(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:f}=s;return hhe(e,t,d+c,u,f,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,d]=l==="beforeChildren"?[o,i]:[i,o];return c().then(()=>d())}else return Promise.all([o(),i(r.delay)])}function hhe(e,t,r=0,n=0,s=1,o){const i=[],l=(e.variantChildren.size-1)*n,c=s===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(phe).forEach((d,u)=>{d.notify("AnimationStart",t),i.push(dI(d,t,{...o,delay:r+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(i)}function phe(e,t){return e.sortNodePosition(t)}function ghe(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(o=>dI(e,o,r));n=Promise.all(s)}else if(typeof t=="string")n=dI(e,t,r);else{const s=typeof t=="function"?cC(e,t,r.custom):t;n=Promise.all(KG(e,s,r))}return n.then(()=>e.notify("AnimationComplete",t))}const vhe=[...g4].reverse(),xhe=g4.length;function yhe(e){return t=>Promise.all(t.map(({animation:r,options:n})=>ghe(e,r,n)))}function bhe(e){let t=yhe(e);const r=jhe();let n=!0;const s=(c,d)=>{const u=cC(e,d);if(u){const{transition:f,transitionEnd:h,...m}=u;c={...c,...m,...h}}return c};function o(c){t=c(e)}function i(c,d){const u=e.getProps(),f=e.getVariantContext(!0)||{},h=[],m=new Set;let v={},g=1/0;for(let x=0;x<xhe;x++){const b=vhe[x],w=r[b],j=u[b]!==void 0?u[b]:f[b],_=Vb(j),C=b===d?w.isActive:null;C===!1&&(g=x);let P=j===f[b]&&j!==u[b]&&_;if(P&&n&&e.manuallyAnimateOnMount&&(P=!1),w.protectedKeys={...v},!w.isActive&&C===null||!j&&!w.prevProp||sC(j)||typeof j=="boolean")continue;let A=whe(w.prevProp,j)||b===d&&w.isActive&&!P&&_||x>g&&_,F=!1;const D=Array.isArray(j)?j:[j];let I=D.reduce(s,{});C===!1&&(I={});const{prevResolvedValues:R={}}=w,M={...R,...I},U=z=>{A=!0,m.has(z)&&(F=!0,m.delete(z)),w.needsAnimating[z]=!0};for(const z in M){const W=I[z],$=R[z];if(v.hasOwnProperty(z))continue;let ee=!1;L_(W)&&L_($)?ee=!vG(W,$):ee=W!==$,ee?W!==void 0?U(z):m.add(z):W!==void 0&&m.has(z)?U(z):w.protectedKeys[z]=!0}w.prevProp=j,w.prevResolvedValues=I,w.isActive&&(v={...v,...I}),n&&e.blockInitialAnimation&&(A=!1),A&&(!P||F)&&h.push(...D.map(z=>({animation:z,options:{type:b,...c}})))}if(m.size){const x={};m.forEach(b=>{const w=e.getBaseTarget(b);w!==void 0&&(x[b]=w)}),h.push({animation:x})}let y=!!h.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(y=!1),n=!1,y?t(h):Promise.resolve()}function l(c,d,u){var f;if(r[c].isActive===d)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(m=>{var v;return(v=m.animationState)===null||v===void 0?void 0:v.setActive(c,d)}),r[c].isActive=d;const h=i(u,c);for(const m in r)r[m].protectedKeys={};return h}return{animateChanges:i,setActive:l,setAnimateFunction:o,getState:()=>r}}function whe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!vG(t,e):!1}function Yh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function jhe(){return{animate:Yh(!0),whileInView:Yh(),whileHover:Yh(),whileTap:Yh(),whileDrag:Yh(),whileFocus:Yh(),exit:Yh()}}class _he extends Rh{constructor(t){super(t),t.animationState||(t.animationState=bhe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),sC(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let Nhe=0;class She extends Rh{constructor(){super(...arguments),this.id=Nhe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const o=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&o.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const Che={animation:{Feature:_he},exit:{Feature:She}},QF=(e,t)=>Math.abs(e-t);function Ahe(e,t){const r=QF(e.x,t.x),n=QF(e.y,t.y);return Math.sqrt(r**2+n**2)}class XG{constructor(t,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=tP(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=Ahe(f.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:v}=f,{timestamp:g}=Ki;this.history.push({...v,timestamp:g});const{onStart:y,onMove:x}=this.handlers;h||(y&&y(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=eP(h,this.transformPagePoint),Os.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:m,onSessionEnd:v,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=tP(f.type==="pointercancel"?this.lastMoveEventInfo:eP(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,y),v&&v(f,y)},!fG(t))return;this.dragSnapToOrigin=o,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const i=lC(t),l=eP(i,this.transformPagePoint),{point:c}=l,{timestamp:d}=Ki;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=r;u&&u(t,tP(l,this.history)),this.removeListeners=oh(Df(this.contextWindow,"pointermove",this.handlePointerMove),Df(this.contextWindow,"pointerup",this.handlePointerUp),Df(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Wf(this.updatePoint)}}function eP(e,t){return t?{point:t(e.point)}:e}function ZF(e,t){return{x:e.x-t.x,y:e.y-t.y}}function tP({point:e},t){return{point:e,delta:ZF(e,YG(t)),offset:ZF(e,Phe(t)),velocity:Ehe(t,.1)}}function Phe(e){return e[0]}function YG(e){return e[e.length-1]}function Ehe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=YG(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>ih(t)));)r--;if(!n)return{x:0,y:0};const o=Mf(s.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const i={x:(s.x-n.x)/o,y:(s.y-n.y)/o};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function Fc(e){return e.max-e.min}function uI(e,t=0,r=.01){return Math.abs(e-t)<=r}function e$(e,t,r,n=.5){e.origin=n,e.originPoint=ro(t.min,t.max,e.origin),e.scale=Fc(r)/Fc(t),(uI(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ro(r.min,r.max,e.origin)-e.originPoint,(uI(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Gy(e,t,r,n){e$(e.x,t.x,r.x,n?n.originX:void 0),e$(e.y,t.y,r.y,n?n.originY:void 0)}function t$(e,t,r){e.min=r.min+t.min,e.max=e.min+Fc(t)}function khe(e,t,r){t$(e.x,t.x,r.x),t$(e.y,t.y,r.y)}function r$(e,t,r){e.min=t.min-r.min,e.max=e.min+Fc(t)}function Ky(e,t,r){r$(e.x,t.x,r.x),r$(e.y,t.y,r.y)}function Ihe(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?ro(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?ro(r,e,n.max):Math.min(e,r)),e}function n$(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function Ohe(e,{top:t,left:r,bottom:n,right:s}){return{x:n$(e.x,r,s),y:n$(e.y,t,n)}}function a$(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function The(e,t){return{x:a$(e.x,t.x),y:a$(e.y,t.y)}}function Dhe(e,t){let r=.5;const n=Fc(e),s=Fc(t);return s>n?r=Hb(t.min,t.max-n,e.min):n>s&&(r=Hb(e.min,e.max-s,t.min)),jh(0,1,r)}function Mhe(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const fI=.35;function Rhe(e=fI){return e===!1?e=0:e===!0&&(e=fI),{x:s$(e,"left","right"),y:s$(e,"top","bottom")}}function s$(e,t,r){return{min:o$(e,t),max:o$(e,r)}}function o$(e,t){return typeof e=="number"?e:e[t]||0}const i$=()=>({translate:0,scale:1,origin:0,originPoint:0}),Dv=()=>({x:i$(),y:i$()}),l$=()=>({min:0,max:0}),Eo=()=>({x:l$(),y:l$()});function ed(e){return[e("x"),e("y")]}function JG({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function Lhe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Fhe(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function rP(e){return e===void 0||e===1}function mI({scale:e,scaleX:t,scaleY:r}){return!rP(e)||!rP(t)||!rP(r)}function op(e){return mI(e)||QG(e)||e.z||e.rotate||e.rotateX||e.rotateY}function QG(e){return c$(e.x)||c$(e.y)}function c$(e){return e&&e!=="0%"}function z_(e,t,r){const n=e-r,s=t*n;return r+s}function d$(e,t,r,n,s){return s!==void 0&&(e=z_(e,s,n)),z_(e,r,n)+t}function hI(e,t=0,r=1,n,s){e.min=d$(e.min,t,r,n,s),e.max=d$(e.max,t,r,n,s)}function ZG(e,{x:t,y:r}){hI(e.x,t.translate,t.scale,t.originPoint),hI(e.y,r.translate,r.scale,r.originPoint)}function $he(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let o,i;for(let l=0;l<s;l++){o=r[l],i=o.projectionDelta;const c=o.instance;c&&c.style&&c.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&Mv(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,ZG(e,i)),n&&op(o.latestValues)&&Mv(e,o.latestValues))}t.x=u$(t.x),t.y=u$(t.y)}function u$(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Im(e,t){e.min=e.min+t,e.max=e.max+t}function f$(e,t,[r,n,s]){const o=t[s]!==void 0?t[s]:.5,i=ro(e.min,e.max,o);hI(e,t[r],t[n],i,t.scale)}const Bhe=["x","scaleX","originX"],qhe=["y","scaleY","originY"];function Mv(e,t){f$(e.x,t,Bhe),f$(e.y,t,qhe)}function eK(e,t){return JG(Fhe(e.getBoundingClientRect(),t))}function zhe(e,t,r){const n=eK(e,r),{scroll:s}=t;return s&&(Im(n.x,s.offset.x),Im(n.y,s.offset.y)),n}const tK=({current:e})=>e?e.ownerDocument.defaultView:null,Uhe=new WeakMap;class Vhe{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Eo(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(lC(u,"page").point)},o=(u,f)=>{const{drag:h,dragPropagation:m,onDragStart:v}=this.getProps();if(h&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=hG(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ed(y=>{let x=this.getAxisMotionValue(y).get()||0;if(Uu.test(x)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[y];w&&(x=Fc(w)*(parseFloat(x)/100))}}this.originPoint[y]=x}),v&&Os.update(()=>v(u,f),!1,!0);const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},i=(u,f)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:v,onDrag:g}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:y}=f;if(m&&this.currentDirection===null){this.currentDirection=Whe(y),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,y),this.updateAxis("y",f.point,y),this.visualElement.render(),g&&g(u,f)},l=(u,f)=>this.stop(u,f),c=()=>ed(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new XG(t,{onSessionStart:s,onStart:o,onMove:i,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:tK(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:o}=this.getProps();o&&Os.update(()=>o(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!I2(t,s,this.currentDirection))return;const o=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=Ihe(i,this.constraints[t],this.elastic[t])),o.set(i)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,o=this.constraints;r&&Ov(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=Ohe(s.layoutBox,r):this.constraints=!1,this.elastic=Rhe(n),o!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&ed(i=>{this.getAxisMotionValue(i)&&(this.constraints[i]=Mhe(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Ov(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const o=zhe(n,s.root,this.visualElement.getTransformPagePoint());let i=The(s.layout.layoutBox,o);if(r){const l=r(Lhe(i));this.hasMutatedConstraints=!!l,l&&(i=JG(l))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:o,dragSnapToOrigin:i,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=ed(u=>{if(!I2(u,r,this.currentDirection))return;let f=c&&c[u]||{};i&&(f={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,v={type:"inertia",velocity:n?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...o,...f};return this.startAxisValueAnimation(u,v)});return Promise.all(d).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(O4(t,n,0,r))}stopAnimation(){ed(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ed(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){ed(r=>{const{drag:n}=this.getProps();if(!I2(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,o=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:l}=s.layout.layoutBox[r];o.set(t[r]-ro(i,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Ov(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ed(i=>{const l=this.getAxisMotionValue(i);if(l){const c=l.get();s[i]=Dhe({min:c,max:c},this.constraints[i])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ed(i=>{if(!I2(i,t,null))return;const l=this.getAxisMotionValue(i),{min:c,max:d}=this.constraints[i];l.set(ro(c,d,s[i]))})}addListeners(){if(!this.visualElement.current)return;Uhe.set(this.visualElement,this);const t=this.visualElement.current,r=Df(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Ov(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,o=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),n();const i=Pf(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(ed(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=c[u].translate,f.set(f.get()+c[u].translate))}),this.visualElement.render())});return()=>{i(),r(),o(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:o=!1,dragElastic:i=fI,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:o,dragElastic:i,dragMomentum:l}}}function I2(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function Whe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Hhe extends Rh{constructor(t){super(t),this.removeGroupControls=go,this.removeListeners=go,this.controls=new Vhe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||go}unmount(){this.removeGroupControls(),this.removeListeners()}}const m$=e=>(t,r)=>{e&&Os.update(()=>e(t,r))};class Ghe extends Rh{constructor(){super(...arguments),this.removePointerDownListener=go}onPointerDown(t){this.session=new XG(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:tK(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:m$(t),onStart:m$(r),onMove:n,onEnd:(o,i)=>{delete this.session,s&&Os.update(()=>s(o,i))}}}mount(){this.removePointerDownListener=Df(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Khe(){const e=p.useContext(nC);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,s=p.useId();return p.useEffect(()=>n(s),[]),!t&&r?[!1,()=>r&&r(s)]:[!0]}const Uj={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function h$(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ty={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ia.test(e))e=parseFloat(e);else return e;const r=h$(e,t.target.x),n=h$(e,t.target.y);return`${r}% ${n}%`}},Xhe={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=_h.parse(e);if(s.length>5)return n;const o=_h.createTransformer(e),i=typeof s[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=l,s[1+i]/=c;const d=ro(l,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=d),typeof s[3+i]=="number"&&(s[3+i]/=d),o(s)}};class Yhe extends Se.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:o}=t;nfe(Jhe),o&&(r.group&&r.group.add(o),n&&n.register&&s&&n.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Uj.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:o}=this.props,i=n.projection;return i&&(i.isPresent=o,s||t.layoutDependency!==r||r===void 0?i.willUpdate():this.safeToRemove(),t.isPresent!==o&&(o?i.promote():i.relegate()||Os.postRender(()=>{const l=i.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function rK(e){const[t,r]=Khe(),n=p.useContext(x4);return Se.createElement(Yhe,{...e,layoutGroup:n,switchLayoutGroup:p.useContext(JH),isPresent:t,safeToRemove:r})}const Jhe={borderRadius:{...ty,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ty,borderTopRightRadius:ty,borderBottomLeftRadius:ty,borderBottomRightRadius:ty,boxShadow:Xhe},nK=["TopLeft","TopRight","BottomLeft","BottomRight"],Qhe=nK.length,p$=e=>typeof e=="string"?parseFloat(e):e,g$=e=>typeof e=="number"||ia.test(e);function Zhe(e,t,r,n,s,o){s?(e.opacity=ro(0,r.opacity!==void 0?r.opacity:1,epe(n)),e.opacityExit=ro(t.opacity!==void 0?t.opacity:1,0,tpe(n))):o&&(e.opacity=ro(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let i=0;i<Qhe;i++){const l=`border${nK[i]}Radius`;let c=v$(t,l),d=v$(r,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||g$(c)===g$(d)?(e[l]=Math.max(ro(p$(c),p$(d),n),0),(Uu.test(d)||Uu.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||r.rotate)&&(e.rotate=ro(t.rotate||0,r.rotate||0,n))}function v$(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const epe=aK(0,.5,CG),tpe=aK(.5,.95,go);function aK(e,t,r){return n=>n<e?0:n>t?1:r(Hb(e,t,n))}function x$(e,t){e.min=t.min,e.max=t.max}function Kc(e,t){x$(e.x,t.x),x$(e.y,t.y)}function y$(e,t,r,n,s){return e-=t,e=z_(e,1/r,n),s!==void 0&&(e=z_(e,1/s,n)),e}function rpe(e,t=0,r=1,n=.5,s,o=e,i=e){if(Uu.test(t)&&(t=parseFloat(t),t=ro(i.min,i.max,t/100)-i.min),typeof t!="number")return;let l=ro(o.min,o.max,n);e===o&&(l-=t),e.min=y$(e.min,t,r,l,s),e.max=y$(e.max,t,r,l,s)}function b$(e,t,[r,n,s],o,i){rpe(e,t[r],t[n],t[s],t.scale,o,i)}const npe=["x","scaleX","originX"],ape=["y","scaleY","originY"];function w$(e,t,r,n){b$(e.x,t,npe,r?r.x:void 0,n?n.x:void 0),b$(e.y,t,ape,r?r.y:void 0,n?n.y:void 0)}function j$(e){return e.translate===0&&e.scale===1}function sK(e){return j$(e.x)&&j$(e.y)}function spe(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function oK(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function _$(e){return Fc(e.x)/Fc(e.y)}class ope{constructor(){this.members=[]}add(t){T4(this.members,t),t.scheduleRender()}remove(t){if(D4(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const o=this.members[s];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function N$(e,t,r){let n="";const s=e.x.translate/t.x,o=e.y.translate/t.y;if((s||o)&&(n=`translate3d(${s}px, ${o}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:d,rotateY:u}=r;c&&(n+=`rotate(${c}deg) `),d&&(n+=`rotateX(${d}deg) `),u&&(n+=`rotateY(${u}deg) `)}const i=e.x.scale*t.x,l=e.y.scale*t.y;return(i!==1||l!==1)&&(n+=`scale(${i}, ${l})`),n||"none"}const ipe=(e,t)=>e.depth-t.depth;class lpe{constructor(){this.children=[],this.isDirty=!1}add(t){T4(this.children,t),this.isDirty=!0}remove(t){D4(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(ipe),this.isDirty=!1,this.children.forEach(t)}}function cpe(e,t){const r=performance.now(),n=({timestamp:s})=>{const o=s-r;o>=t&&(Wf(n),e(o-t))};return Os.read(n,!0),()=>Wf(n)}function dpe(e){window.MotionDebug&&window.MotionDebug.record(e)}function upe(e){return e instanceof SVGElement&&e.tagName!=="svg"}function fpe(e,t,r){const n=Zl(e)?e:bx(e);return n.start(O4("",n,t,r)),n.animation}const S$=["","X","Y","Z"],mpe={visibility:"hidden"},C$=1e3;let hpe=0;const ip={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function iK({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},l=t?.()){this.id=hpe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ip.totalNodes=ip.resolvedTargetDeltas=ip.recalculatedProjection=0,this.nodes.forEach(vpe),this.nodes.forEach(jpe),this.nodes.forEach(_pe),this.nodes.forEach(xpe),dpe(ip)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new lpe)}addEventListener(i,l){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new M4),this.eventHandlers.get(i).add(l)}notifyListeners(i,...l){const c=this.eventHandlers.get(i);c&&c.notify(...l)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=upe(i),this.instance=i;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let f;const h=()=>this.root.updateBlockedByResize=!1;e(i,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=cpe(h,250),Uj.hasAnimatedSinceResize&&(Uj.hasAnimatedSinceResize=!1,this.nodes.forEach(P$))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:h,hasRelativeTargetChanged:m,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||Ppe,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=u.getProps(),b=!this.targetLayout||!oK(this.targetLayout,v)||m,w=!h&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||h&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,w);const j={...I4(g,"layout"),onPlay:y,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j)}else h||P$(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Wf(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Npe),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(A$);return}this.isUpdating||this.nodes.forEach(bpe),this.isUpdating=!1,this.nodes.forEach(wpe),this.nodes.forEach(ppe),this.nodes.forEach(gpe),this.clearAllSnapshots();const l=performance.now();Ki.delta=jh(0,1e3/60,l-Ki.timestamp),Ki.timestamp=l,Ki.isProcessing=!0,HA.update.process(Ki),HA.preRender.process(Ki),HA.render.process(Ki),Ki.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(ype),this.sharedNodes.forEach(Spe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Os.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Os.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Eo(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:i,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!sK(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;i&&(l||op(this.latestValues)||u)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return i&&(c=this.removeTransform(c)),Epe(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return Eo();const l=i.measureViewportBox(),{scroll:c}=this.root;return c&&(Im(l.x,c.offset.x),Im(l.y,c.offset.y)),l}removeElementScroll(i){const l=Eo();Kc(l,i);for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:f}=d;if(d!==this.root&&u&&f.layoutScroll){if(u.isRoot){Kc(l,i);const{scroll:h}=this.root;h&&(Im(l.x,-h.offset.x),Im(l.y,-h.offset.y))}Im(l.x,u.offset.x),Im(l.y,u.offset.y)}}return l}applyTransform(i,l=!1){const c=Eo();Kc(c,i);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Mv(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),op(u.latestValues)&&Mv(c,u.latestValues)}return op(this.latestValues)&&Mv(c,this.latestValues),c}removeTransform(i){const l=Eo();Kc(l,i);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!op(d.latestValues))continue;mI(d.latestValues)&&d.updateSnapshot();const u=Eo(),f=d.measurePageBox();Kc(u,f),w$(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return op(this.latestValues)&&w$(l,this.latestValues),l}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ki.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(i||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:h}=this.options;if(!(!this.layout||!(f||h))){if(this.resolvedRelativeTargetAt=Ki.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Eo(),this.relativeTargetOrigin=Eo(),Ky(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Kc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Eo(),this.targetWithTransforms=Eo()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),khe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Kc(this.target,this.layout.layoutBox),ZG(this.target,this.targetDelta)):Kc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Eo(),this.relativeTargetOrigin=Eo(),Ky(this.relativeTargetOrigin,this.target,m.target),Kc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ip.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||mI(this.parent.latestValues)||QG(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Ki.timestamp&&(d=!1),d)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;Kc(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;$he(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:v}=l;if(!v){this.projectionTransform&&(this.projectionDelta=Dv(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Dv(),this.projectionDeltaWithTransform=Dv());const g=this.projectionTransform;Gy(this.projectionDelta,this.layoutCorrected,v,this.latestValues),this.projectionTransform=N$(this.projectionDelta,this.treeScale),(this.projectionTransform!==g||this.treeScale.x!==h||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),ip.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(i,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},f=Dv();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=Eo(),m=c?c.source:void 0,v=this.layout?this.layout.source:void 0,g=m!==v,y=this.getStack(),x=!y||y.members.length<=1,b=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(Ape));this.animationProgress=0;let w;this.mixTargetDelta=j=>{const _=j/1e3;E$(f.x,i.x,_),E$(f.y,i.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ky(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Cpe(this.relativeTarget,this.relativeTargetOrigin,h,_),w&&spe(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=Eo()),Kc(w,this.relativeTarget)),g&&(this.animationValues=u,Zhe(u,d,this.latestValues,_,b,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Wf(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Os.update(()=>{Uj.hasAnimatedSinceResize=!0,this.currentAnimation=fpe(0,C$,{...i,onUpdate:l=>{this.mixTargetDelta(l),i.onUpdate&&i.onUpdate(l)},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(C$),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=i;if(!(!l||!c||!d)){if(this!==i&&this.layout&&d&&lK(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||Eo();const f=Fc(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const h=Fc(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}Kc(l,c),Mv(l,u),Gy(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(i,l){this.sharedNodes.has(i)||this.sharedNodes.set(i,new ope),this.sharedNodes.get(i).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:l}=this.options;return l?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:l}=this.options;return l?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetRotation(){const{visualElement:i}=this.options;if(!i)return;let l=!1;const{latestValues:c}=i;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const d={};for(let u=0;u<S$.length;u++){const f="rotate"+S$[u];c[f]&&(d[f]=c[f],i.setStaticValue(f,0))}i.render();for(const u in d)i.setStaticValue(u,d[u]);i.scheduleRender()}getProjectionStyles(i){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return mpe;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=zj(i?.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=zj(i?.pointerEvents)||""),this.hasProjected&&!op(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const h=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=N$(this.projectionDeltaWithTransform,this.treeScale,h),u&&(d.transform=u(h,d.transform));const{x:m,y:v}=this.projectionDelta;d.transformOrigin=`${m.origin*100}% ${v.origin*100}% 0`,f.animationValues?d.opacity=f===this?(c=(l=h.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:d.opacity=f===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const g in M_){if(h[g]===void 0)continue;const{correct:y,applyTo:x}=M_[g],b=d.transform==="none"?h[g]:y(h[g],f);if(x){const w=x.length;for(let j=0;j<w;j++)d[x[j]]=b}else d[g]=b}return this.options.layoutId&&(d.pointerEvents=f===this?zj(i?.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var l;return(l=i.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(A$),this.root.sharedNodes.clear()}}}function ppe(e){e.updateLayout()}function gpe(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=e.layout,{animationType:o}=e.options,i=r.source!==e.layout.source;o==="size"?ed(f=>{const h=i?r.measuredBox[f]:r.layoutBox[f],m=Fc(h);h.min=n[f].min,h.max=h.min+m}):lK(o,r.layoutBox,n)&&ed(f=>{const h=i?r.measuredBox[f]:r.layoutBox[f],m=Fc(n[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const l=Dv();Gy(l,n,r.layoutBox);const c=Dv();i?Gy(c,e.applyTransform(s,!0),r.measuredBox):Gy(c,n,r.layoutBox);const d=!sK(l);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const v=Eo();Ky(v,r.layoutBox,h.layoutBox);const g=Eo();Ky(g,n,m.layoutBox),oK(v,g)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=v,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function vpe(e){ip.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function xpe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function ype(e){e.clearSnapshot()}function A$(e){e.clearMeasurements()}function bpe(e){e.isLayoutDirty=!1}function wpe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function P$(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function jpe(e){e.resolveTargetDelta()}function _pe(e){e.calcProjection()}function Npe(e){e.resetRotation()}function Spe(e){e.removeLeadSnapshot()}function E$(e,t,r){e.translate=ro(t.translate,0,r),e.scale=ro(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function k$(e,t,r,n){e.min=ro(t.min,r.min,n),e.max=ro(t.max,r.max,n)}function Cpe(e,t,r,n){k$(e.x,t.x,r.x,n),k$(e.y,t.y,r.y,n)}function Ape(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Ppe={duration:.45,ease:[.4,0,.1,1]},I$=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),O$=I$("applewebkit/")&&!I$("chrome/")?Math.round:go;function T$(e){e.min=O$(e.min),e.max=O$(e.max)}function Epe(e){T$(e.x),T$(e.y)}function lK(e,t,r){return e==="position"||e==="preserve-aspect"&&!uI(_$(t),_$(r),.2)}const kpe=iK({attachResizeListener:(e,t)=>Pf(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),nP={current:void 0},cK=iK({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!nP.current){const e=new kpe({});e.mount(window),e.setOptions({layoutScroll:!0}),nP.current=e}return nP.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Ipe={pan:{Feature:Ghe},drag:{Feature:Hhe,ProjectionNode:cK,MeasureLayout:rK}},Ope=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Tpe(e){const t=Ope.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function pI(e,t,r=1){const[n,s]=Tpe(e);if(!n)return;const o=window.getComputedStyle(t).getPropertyValue(n);if(o){const i=o.trim();return WG(i)?parseFloat(i):i}else return aI(s)?pI(s,t,r+1):s}function Dpe(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(s=>{const o=s.get();if(!aI(o))return;const i=pI(o,n);i&&s.set(i)});for(const s in t){const o=t[s];if(!aI(o))continue;const i=pI(o,n);i&&(t[s]=i,r||(r={}),r[s]===void 0&&(r[s]=o))}return{target:t,transitionEnd:r}}const Mpe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),dK=e=>Mpe.has(e),Rpe=e=>Object.keys(e).some(dK),D$=e=>e===_g||e===ia,M$=(e,t)=>parseFloat(e.split(", ")[t]),R$=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/);if(s)return M$(s[1],t);{const o=n.match(/^matrix\((.+)\)$/);return o?M$(o[1],e):0}},Lpe=new Set(["x","y","z"]),Fpe=l1.filter(e=>!Lpe.has(e));function $pe(e){const t=[];return Fpe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const wx={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:R$(4,13),y:R$(5,14)};wx.translateX=wx.x;wx.translateY=wx.y;const Bpe=(e,t,r)=>{const n=t.measureViewportBox(),s=t.current,o=getComputedStyle(s),{display:i}=o,l={};i==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(d=>{l[d]=wx[d](n,o)}),t.render();const c=t.measureViewportBox();return r.forEach(d=>{const u=t.getValue(d);u&&u.jump(l[d]),e[d]=wx[d](c,o)}),e},qpe=(e,t,r={},n={})=>{t={...t},n={...n};const s=Object.keys(t).filter(dK);let o=[],i=!1;const l=[];if(s.forEach(c=>{const d=e.getValue(c);if(!e.hasValue(c))return;let u=r[c],f=ey(u);const h=t[c];let m;if(L_(h)){const v=h.length,g=h[0]===null?1:0;u=h[g],f=ey(u);for(let y=g;y<v&&h[y]!==null;y++)m?C4(ey(h[y])===m):m=ey(h[y])}else m=ey(h);if(f!==m)if(D$(f)&&D$(m)){const v=d.get();typeof v=="string"&&d.set(parseFloat(v)),typeof h=="string"?t[c]=parseFloat(h):Array.isArray(h)&&m===ia&&(t[c]=h.map(parseFloat))}else f?.transform&&m?.transform&&(u===0||h===0)?u===0?d.set(m.transform(u)):t[c]=f.transform(h):(i||(o=$pe(e),i=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],d.jump(h))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,d=Bpe(t,e,l);return o.length&&o.forEach(([u,f])=>{e.getValue(u).set(f)}),e.render(),aC&&c!==null&&window.scrollTo({top:c}),{target:d,transitionEnd:n}}else return{target:t,transitionEnd:n}};function zpe(e,t,r,n){return Rpe(t)?qpe(e,t,r,n):{target:t,transitionEnd:n}}const Upe=(e,t,r,n)=>{const s=Dpe(e,t,n);return t=s.target,n=s.transitionEnd,zpe(e,t,r,n)},gI={current:null},uK={current:!1};function Vpe(){if(uK.current=!0,!!aC)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>gI.current=e.matches;e.addListener(t),t()}else gI.current=!1}function Wpe(e,t,r){const{willChange:n}=t;for(const s in t){const o=t[s],i=r[s];if(Zl(o))e.addValue(s,o),q_(n)&&n.add(s);else if(Zl(i))e.addValue(s,bx(o,{owner:e})),q_(n)&&n.remove(s);else if(i!==o)if(e.hasValue(s)){const l=e.getValue(s);!l.hasAnimated&&l.set(o)}else{const l=e.getStaticValue(s);e.addValue(s,bx(l!==void 0?l:o,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const L$=new WeakMap,fK=Object.keys(Wb),Hpe=fK.length,F$=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Gpe=v4.length;class Kpe{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,visualState:o},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Os.render(this.render,!1,!0);const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=i,this.isControllingVariants=oC(r),this.isVariantNode=YH(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(r,{});for(const f in u){const h=u[f];l[f]!==void 0&&Zl(h)&&(h.set(l[f],!1),q_(d)&&d.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,L$.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),uK.current||Vpe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:gI.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){L$.delete(this.current),this.projection&&this.projection.unmount(),Wf(this.notifyUpdate),Wf(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=jg.has(t),s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Os.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),o=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{s(),o()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,s,o){let i,l;for(let c=0;c<Hpe;c++){const d=fK[c],{isEnabled:u,Feature:f,ProjectionNode:h,MeasureLayout:m}=Wb[d];h&&(i=h),u(r)&&(!this.features[d]&&f&&(this.features[d]=new f(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&i){this.projection=new i(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:d,drag:u,dragConstraints:f,layoutScroll:h,layoutRoot:m}=r;this.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!u||f&&Ov(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:o,layoutScroll:h,layoutRoot:m})}return l}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Eo()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<F$.length;n++){const s=F$[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const o=t["on"+s];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=Wpe(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<Gpe;n++){const s=v4[n],o=this.props[s];(Vb(o)||o===!1)&&(r[s]=o)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=bx(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,s=typeof n=="string"||typeof n=="object"?(r=S4(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&s!==void 0)return s;const o=this.getBaseTargetFromProps(this.props,t);return o!==void 0&&!Zl(o)?o:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new M4),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class mK extends Kpe{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:s},o){let i=uhe(n,t||{},this);if(s&&(r&&(r=s(r)),n&&(n=s(n)),i&&(i=s(i))),o){che(this,n,i);const l=Upe(this,n,i,r);r=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:r,...n}}}function Xpe(e){return window.getComputedStyle(e)}class Ype extends mK{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(jg.has(r)){const n=k4(r);return n&&n.default||0}else{const n=Xpe(t),s=(eG(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return eK(t,r)}build(t,r,n,s){b4(t,r,n,s.transformTemplate)}scrapeMotionValuesFromProps(t,r){return N4(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Zl(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,s){oG(t,r,n,s)}}class Jpe extends mK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(jg.has(r)){const n=k4(r);return n&&n.default||0}return r=iG.has(r)?r:p4(r),t.getAttribute(r)}measureInstanceViewportBox(){return Eo()}scrapeMotionValuesFromProps(t,r){return cG(t,r)}build(t,r,n,s){j4(t,r,n,this.isSVGTag,s.transformTemplate)}renderInstance(t,r,n,s){lG(t,r,n,s)}mount(t){this.isSVGTag=_4(t.tagName),super.mount(t)}}const Qpe=(e,t)=>y4(e)?new Jpe(t,{enableHardwareAcceleration:!1}):new Ype(t,{enableHardwareAcceleration:!0}),Zpe={layout:{ProjectionNode:cK,MeasureLayout:rK}},ege={...Che,...Hfe,...Ipe,...Zpe},jr=tfe((e,t)=>Tfe(e,t,ege,Qpe));function hK(){const e=p.useRef(!1);return h4(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function tge(){const e=hK(),[t,r]=p.useState(0),n=p.useCallback(()=>{e.current&&r(t+1)},[t]);return[p.useCallback(()=>Os.postRender(n),[n]),t]}class rge extends p.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function nge({children:e,isPresent:t}){const r=p.useId(),n=p.useRef(null),s=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:o,height:i,top:l,left:c}=s.current;if(t||!n.current||!o||!i)return;n.current.dataset.motionPopId=r;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${i}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),p.createElement(rge,{isPresent:t,childRef:n,sizeRef:s},p.cloneElement(e,{ref:n}))}const aP=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:o,mode:i})=>{const l=dG(age),c=p.useId(),d=p.useMemo(()=>({id:c,initial:t,isPresent:r,custom:s,onExitComplete:u=>{l.set(u,!0);for(const f of l.values())if(!f)return;n&&n()},register:u=>(l.set(u,!1),()=>l.delete(u))}),o?void 0:[r]);return p.useMemo(()=>{l.forEach((u,f)=>l.set(f,!1))},[r]),p.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),i==="popLayout"&&(e=p.createElement(nge,{isPresent:r},e)),p.createElement(nC.Provider,{value:d},e)};function age(){return new Map}function sge(e){return p.useEffect(()=>()=>e(),[])}const lp=e=>e.key||"";function oge(e,t){e.forEach(r=>{const n=lp(r);t.set(n,r)})}function ige(e){const t=[];return p.Children.forEach(e,r=>{p.isValidElement(r)&&t.push(r)}),t}const lge=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:s,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const l=p.useContext(x4).forceRender||tge()[0],c=hK(),d=ige(e);let u=d;const f=p.useRef(new Map).current,h=p.useRef(u),m=p.useRef(new Map).current,v=p.useRef(!0);if(h4(()=>{v.current=!1,oge(d,m),h.current=u}),sge(()=>{v.current=!0,m.clear(),f.clear()}),v.current)return p.createElement(p.Fragment,null,u.map(b=>p.createElement(aP,{key:lp(b),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:o,mode:i},b)));u=[...u];const g=h.current.map(lp),y=d.map(lp),x=g.length;for(let b=0;b<x;b++){const w=g[b];y.indexOf(w)===-1&&!f.has(w)&&f.set(w,void 0)}return i==="wait"&&f.size&&(u=[]),f.forEach((b,w)=>{if(y.indexOf(w)!==-1)return;const j=m.get(w);if(!j)return;const _=g.indexOf(w);let C=b;if(!C){const P=()=>{f.delete(w);const E=Array.from(m.keys()).filter(A=>!y.includes(A));if(E.forEach(A=>m.delete(A)),h.current=d.filter(A=>{const F=lp(A);return F===w||E.includes(F)}),!f.size){if(c.current===!1)return;l(),n&&n()}};C=p.createElement(aP,{key:lp(j),isPresent:!1,onExitComplete:P,custom:t,presenceAffectsLayout:o,mode:i},j),f.set(w,C)}u.splice(_,0,C)}),u=u.map(b=>{const w=b.key;return f.has(w)?b:p.createElement(aP,{key:lp(b),isPresent:!0,presenceAffectsLayout:o,mode:i},b)}),p.createElement(p.Fragment,null,f.size?u:u.map(b=>p.cloneElement(b)))};function $$(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function dC(...e){return t=>{let r=!1;const n=e.map(s=>{const o=$$(s,t);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let s=0;s<n.length;s++){const o=n[s];typeof o=="function"?o():$$(e[s],null)}}}}function za(...e){return p.useCallback(dC(...e),e)}function Nh(e){const t=dge(e),r=p.forwardRef((n,s)=>{const{children:o,...i}=n,l=p.Children.toArray(o),c=l.find(fge);if(c){const d=c.props.children,u=l.map(f=>f===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:f);return a.jsx(t,{...i,ref:s,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...i,ref:s,children:o})});return r.displayName=`${e}.Slot`,r}var cge=Nh("Slot");function dge(e){const t=p.forwardRef((r,n)=>{const{children:s,...o}=r;if(p.isValidElement(s)){const i=hge(s),l=mge(o,s.props);return s.type!==p.Fragment&&(l.ref=n?dC(n,i):i),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var pK=Symbol("radix.slottable");function uge(e){const t=({children:r})=>a.jsx(a.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=pK,t}function fge(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===pK}function mge(e,t){const r={...t};for(const n in t){const s=e[n],o=t[n];/^on[A-Z]/.test(n)?s&&o?r[n]=(...l)=>{const c=o(...l);return s(...l),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...o}:n==="className"&&(r[n]=[s,o].filter(Boolean).join(" "))}return{...e,...r}}function hge(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const B$=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,q$=ga,R4=(e,t)=>r=>{var n;if(t?.variants==null)return q$(e,r?.class,r?.className);const{variants:s,defaultVariants:o}=t,i=Object.keys(s).map(d=>{const u=r?.[d],f=o?.[d];if(u===null)return null;const h=B$(u)||B$(f);return s[d][h]}),l=r&&Object.entries(r).reduce((d,u)=>{let[f,h]=u;return h===void 0||(d[f]=h),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let{class:f,className:h,...m}=u;return Object.entries(m).every(v=>{let[g,y]=v;return Array.isArray(y)?y.includes({...o,...l}[g]):{...o,...l}[g]===y})?[...d,f,h]:d},[]);return q$(e,i,c,r?.class,r?.className)},Gb=R4("inline-flex items-center justify-center rounded-sm text-sm font-bold tracking-wide transition-all duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background active:scale-[0.98] disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-brand text-primary-foreground hover:bg-brand/90 shadow-lg shadow-brand/15",destructive:"bg-danger text-white hover:bg-danger/90 shadow-lg shadow-danger/15",outline:"border border-border bg-transparent hover:bg-accent hover:text-accent-foreground",secondary:"bg-surface-2 text-secondary-foreground hover:bg-surface-2/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-brand underline-offset-4 hover:underline",success:"bg-success text-white hover:bg-success/90 shadow-lg shadow-success/15"},size:{default:"h-10 px-5 py-2 gap-2",sm:"h-9 rounded-sm px-3 gap-1.5",lg:"h-12 rounded-md px-8 gap-2.5 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),me=Se.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},o)=>{const i=n?cge:"button";return a.jsx(i,{className:gr(Gb({variant:t,size:r,className:e})),ref:o,...s})});me.displayName="Button";const O2=[{to:"/",icon:Iue,label:"Painel Principal"},{to:"/agenda",icon:Vs,label:"Agenda"},{to:"/vendas",icon:i1,label:"Loja"},{to:"/financeiro",icon:HH,label:"Financeiro"},{to:"/fiscal",icon:c4,label:"Central Fiscal"}],Vj={hidden:{opacity:0,x:-20},visible:e=>({opacity:1,x:0,transition:{delay:e*.05+.3,duration:.3,ease:"easeOut"}})},pge=({to:e,icon:t,label:r,index:n,onNavigate:s})=>{const o="flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand w-full",i="flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent w-full";return a.jsx(jr.li,{custom:n,variants:Vj,initial:"hidden",animate:"visible",whileHover:{x:4},transition:{type:"spring",stiffness:300,damping:15},children:a.jsxs(Su,{to:e,onClick:s,className:({isActive:l})=>e==="/isis"&&l?"flex items-center h-[52px] px-4 rounded-sm font-bold text-white shadow-lg shadow-emerald-500/10 border-l-4 border-transparent bg-gradient-to-r from-fuchsia-600 via-violet-600 to-emerald-600 ring-1 ring-white/10":l?o:i,children:[e==="/isis"?a.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(tl,{size:"sm"})})}):a.jsx(t,{className:"h-5 w-5 mr-4 flex-shrink-0"}),a.jsx("span",{className:"text-base flex items-center gap-2",children:r})]})})};function gge({onNavigate:e,isVisible:t,setIsVisible:r,sidebarPinned:n}){const s=Ri(),o=Lo(),i=["/produtos","/compras","/clientes","/equipe","/quadras","/empresas","/finalizadoras"],l=p.useMemo(()=>i.includes(o.pathname),[o.pathname]),[c,d]=p.useState(l),u=p.useRef(null);p.useRef(null);const f=p.useRef(0),h=p.useRef(0),m=()=>{window.innerWidth<768&&r(!1)};return p.useEffect(()=>{const v=x=>{window.innerWidth>=768||(f.current=x.touches[0].clientX,h.current=x.touches[0].clientY)},g=x=>{if(window.innerWidth>=768)return;const b=x.touches[0].clientX,w=x.touches[0].clientY,j=b-f.current,_=Math.abs(w-h.current);f.current<50&&j>50&&_<50&&r(!0)},y=()=>{f.current=0,h.current=0};return window.addEventListener("touchstart",v,{passive:!0}),window.addEventListener("touchmove",g,{passive:!0}),window.addEventListener("touchend",y,{passive:!0}),()=>{window.removeEventListener("touchstart",v),window.removeEventListener("touchmove",g),window.removeEventListener("touchend",y)}},[t]),a.jsx(a.Fragment,{children:a.jsxs(jr.aside,{ref:u,initial:!1,animate:{width:n||t?280:0},className:`h-screen bg-surface flex flex-col border-r border-border shadow-xl shadow-black/20 overflow-hidden\r
                   fixed inset-y-0 left-0 z-40 md:static md:flex-shrink-0`,children:[a.jsxs(jr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"flex items-center px-6 pt-8 pb-6 h-[120px] flex-shrink-0",children:[a.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center mr-4",children:a.jsx(Sc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),a.jsx("nav",{className:"flex-1 overflow-y-auto px-6 py-2 scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent hover:scrollbar-thumb-border-hover",children:a.jsxs("ul",{className:"space-y-3",children:[O2.map((v,g)=>a.jsx(pge,{...v,index:g,onNavigate:m},v.to)),a.jsxs(jr.li,{custom:O2.length,variants:Vj,initial:"hidden",animate:"visible",children:[a.jsxs("button",{type:"button",onClick:()=>d(v=>!v),className:`w-full flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 ${l?"bg-brand text-primary-foreground font-bold border-brand":"border-transparent"}`,children:[a.jsx(_ue,{className:"h-5 w-5 mr-4 flex-shrink-0"}),a.jsx("span",{className:"text-base flex-1 text-left",children:"Cadastros"}),a.jsx(wg,{className:`h-4 w-4 transition-transform ${c?"rotate-180":""}`})]}),c&&a.jsxs("ul",{className:"mt-2 ml-8 space-y-2",children:[a.jsx("li",{children:a.jsxs(Su,{to:"/clientes",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(yl,{className:"h-4 w-4 mr-3"})," Clientes & Fornecedores"]})}),a.jsx("li",{children:a.jsxs(Su,{to:"/finalizadoras",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Um,{className:"h-4 w-4 mr-3"})," Finalizadoras"]})}),a.jsx("li",{children:a.jsxs(Su,{to:"/produtos",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Sd,{className:"h-4 w-4 mr-3"})," Produtos"]})}),a.jsx("li",{children:a.jsxs(Su,{to:"/compras",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Xv,{className:"h-4 w-4 mr-3"})," Compras"]})}),a.jsx("li",{children:a.jsxs(Su,{to:"/equipe",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Vue,{className:"h-4 w-4 mr-3"})," Equipe"]})}),a.jsx("li",{children:a.jsxs(Su,{to:"/quadras",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(kue,{className:"h-4 w-4 mr-3"})," Quadras"]})}),a.jsx("li",{children:a.jsxs(Su,{to:"/empresas",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(D_,{className:"h-4 w-4 mr-3"})," Empresa"]})})]})]}),a.jsx(jr.li,{custom:O2.length+1,variants:Vj,initial:"hidden",animate:"visible",className:"pt-4 border-t border-border/50 mt-4",children:a.jsxs(Su,{to:"/suporte",onClick:m,className:({isActive:v})=>v?"flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand":"flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent",children:[a.jsx(BH,{className:"h-5 w-5 mr-4 flex-shrink-0"}),a.jsx("span",{className:"text-base",children:"Suporte"})]})}),a.jsx(jr.li,{custom:O2.length+2,variants:Vj,initial:"hidden",animate:"visible",children:a.jsxs(Su,{to:"/isis",onClick:m,className:({isActive:v})=>v?"flex items-center h-[56px] px-4 rounded-sm font-extrabold text-text-primary bg-surface-2/80 border border-white/20 shadow-[inset_0_0_0_1px_rgba(255,255,255,0.06)]":"flex items-center h-[56px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border border-white/15",children:[a.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(tl,{size:"sm"})})}),a.jsx("span",{className:"text-lg font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300",children:"sis"}),a.jsx("button",{type:"button",title:"Dashboard analtica da sis",onClick:v=>{v.preventDefault(),v.stopPropagation(),s("/isis/analytics")},className:"ml-auto inline-flex items-center justify-center p-2.5 rounded-full text-text-secondary hover:text-text-primary hover:bg-white/10 transition-all border border-white/10 hover:border-white/20 cursor-pointer shadow-sm hover:shadow",children:a.jsx(bd,{className:"h-5 w-5"})})]})})]})})]})})}function jn(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),r===!1||!s.defaultPrevented)return t?.(s)}}function vge(e,t){const r=p.createContext(t),n=o=>{const{children:i,...l}=o,c=p.useMemo(()=>l,Object.values(l));return a.jsx(r.Provider,{value:c,children:i})};n.displayName=e+"Provider";function s(o){const i=p.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${o}\` must be used within \`${e}\``)}return[n,s]}function Ed(e,t=[]){let r=[];function n(o,i){const l=p.createContext(i),c=r.length;r=[...r,i];const d=f=>{const{scope:h,children:m,...v}=f,g=h?.[e]?.[c]||l,y=p.useMemo(()=>v,Object.values(v));return a.jsx(g.Provider,{value:y,children:m})};d.displayName=o+"Provider";function u(f,h){const m=h?.[e]?.[c]||l,v=p.useContext(m);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${o}\``)}return[d,u]}const s=()=>{const o=r.map(i=>p.createContext(i));return function(l){const c=l?.[e]||o;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[n,xge(s,...t)]}function xge(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const i=n.reduce((l,{useScope:c,scopeName:d})=>{const f=c(o)[`__scope${d}`];return{...l,...f}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}var yge=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],sa=yge.reduce((e,t)=>{const r=Nh(`Primitive.${t}`),n=p.forwardRef((s,o)=>{const{asChild:i,...l}=s,c=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:o})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function L4(e,t){e&&em.flushSync(()=>e.dispatchEvent(t))}function ec(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...r)=>t.current?.(...r),[])}function bge(e,t=globalThis?.document){const r=ec(e);p.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var wge="DismissableLayer",vI="dismissableLayer.update",jge="dismissableLayer.pointerDownOutside",_ge="dismissableLayer.focusOutside",z$,gK=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),d0=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:i,onDismiss:l,...c}=e,d=p.useContext(gK),[u,f]=p.useState(null),h=u?.ownerDocument??globalThis?.document,[,m]=p.useState({}),v=za(t,P=>f(P)),g=Array.from(d.layers),[y]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),x=g.indexOf(y),b=u?g.indexOf(u):-1,w=d.layersWithOutsidePointerEventsDisabled.size>0,j=b>=x,_=Sge(P=>{const E=P.target,A=[...d.branches].some(F=>F.contains(E));!j||A||(s?.(P),i?.(P),P.defaultPrevented||l?.())},h),C=Cge(P=>{const E=P.target;[...d.branches].some(F=>F.contains(E))||(o?.(P),i?.(P),P.defaultPrevented||l?.())},h);return bge(P=>{b===d.layers.size-1&&(n?.(P),!P.defaultPrevented&&l&&(P.preventDefault(),l()))},h),p.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(z$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),U$(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=z$)}},[u,h,r,d]),p.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),U$())},[u,d]),p.useEffect(()=>{const P=()=>m({});return document.addEventListener(vI,P),()=>document.removeEventListener(vI,P)},[]),a.jsx(sa.div,{...c,ref:v,style:{pointerEvents:w?j?"auto":"none":void 0,...e.style},onFocusCapture:jn(e.onFocusCapture,C.onFocusCapture),onBlurCapture:jn(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:jn(e.onPointerDownCapture,_.onPointerDownCapture)})});d0.displayName=wge;var Nge="DismissableLayerBranch",vK=p.forwardRef((e,t)=>{const r=p.useContext(gK),n=p.useRef(null),s=za(t,n);return p.useEffect(()=>{const o=n.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),a.jsx(sa.div,{...e,ref:s})});vK.displayName=Nge;function Sge(e,t=globalThis?.document){const r=ec(e),n=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const o=l=>{if(l.target&&!n.current){let c=function(){xK(jge,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Cge(e,t=globalThis?.document){const r=ec(e),n=p.useRef(!1);return p.useEffect(()=>{const s=o=>{o.target&&!n.current&&xK(_ge,r,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function U$(){const e=new CustomEvent(vI);document.dispatchEvent(e)}function xK(e,t,r,{discrete:n}){const s=r.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?L4(s,o):s.dispatchEvent(o)}var Age=d0,Pge=vK,sP=0;function uC(){p.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??V$()),document.body.insertAdjacentElement("beforeend",e[1]??V$()),sP++,()=>{sP===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),sP--}},[])}function V$(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var oP="focusScope.autoFocusOnMount",iP="focusScope.autoFocusOnUnmount",W$={bubbles:!1,cancelable:!0},Ege="FocusScope",f1=p.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:o,...i}=e,[l,c]=p.useState(null),d=ec(s),u=ec(o),f=p.useRef(null),h=za(t,g=>c(g)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(n){let g=function(w){if(m.paused||!l)return;const j=w.target;l.contains(j)?f.current=j:Sm(f.current,{select:!0})},y=function(w){if(m.paused||!l)return;const j=w.relatedTarget;j!==null&&(l.contains(j)||Sm(f.current,{select:!0}))},x=function(w){if(document.activeElement===document.body)for(const _ of w)_.removedNodes.length>0&&Sm(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const b=new MutationObserver(x);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),b.disconnect()}}},[n,l,m.paused]),p.useEffect(()=>{if(l){G$.add(m);const g=document.activeElement;if(!l.contains(g)){const x=new CustomEvent(oP,W$);l.addEventListener(oP,d),l.dispatchEvent(x),x.defaultPrevented||(kge(Mge(yK(l)),{select:!0}),document.activeElement===g&&Sm(l))}return()=>{l.removeEventListener(oP,d),setTimeout(()=>{const x=new CustomEvent(iP,W$);l.addEventListener(iP,u),l.dispatchEvent(x),x.defaultPrevented||Sm(g??document.body,{select:!0}),l.removeEventListener(iP,u),G$.remove(m)},0)}}},[l,d,u,m]);const v=p.useCallback(g=>{if(!r&&!n||m.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,x=document.activeElement;if(y&&x){const b=g.currentTarget,[w,j]=Ige(b);w&&j?!g.shiftKey&&x===j?(g.preventDefault(),r&&Sm(w,{select:!0})):g.shiftKey&&x===w&&(g.preventDefault(),r&&Sm(j,{select:!0})):x===b&&g.preventDefault()}},[r,n,m.paused]);return a.jsx(sa.div,{tabIndex:-1,...i,ref:h,onKeyDown:v})});f1.displayName=Ege;function kge(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Sm(n,{select:t}),document.activeElement!==r)return}function Ige(e){const t=yK(e),r=H$(t,e),n=H$(t.reverse(),e);return[r,n]}function yK(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function H$(e,t){for(const r of e)if(!Oge(r,{upTo:t}))return r}function Oge(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Tge(e){return e instanceof HTMLInputElement&&"select"in e}function Sm(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Tge(e)&&t&&e.select()}}var G$=Dge();function Dge(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=K$(e,t),e.unshift(t)},remove(t){e=K$(e,t),e[0]?.resume()}}}function K$(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function Mge(e){return e.filter(t=>t.tagName!=="A")}var Mi=globalThis?.document?p.useLayoutEffect:()=>{},Rge=u3[" useId ".trim().toString()]||(()=>{}),Lge=0;function su(e){const[t,r]=p.useState(Rge());return Mi(()=>{e||r(n=>n??String(Lge++))},[e]),e||(t?`radix-${t}`:"")}const Fge=["top","right","bottom","left"],Sh=Math.min,wc=Math.max,U_=Math.round,T2=Math.floor,Vu=e=>({x:e,y:e}),$ge={left:"right",right:"left",bottom:"top",top:"bottom"},Bge={start:"end",end:"start"};function xI(e,t,r){return wc(e,Sh(t,r))}function Hf(e,t){return typeof e=="function"?e(t):e}function Gf(e){return e.split("-")[0]}function u0(e){return e.split("-")[1]}function F4(e){return e==="x"?"y":"x"}function $4(e){return e==="y"?"height":"width"}const qge=new Set(["top","bottom"]);function Mu(e){return qge.has(Gf(e))?"y":"x"}function B4(e){return F4(Mu(e))}function zge(e,t,r){r===void 0&&(r=!1);const n=u0(e),s=B4(e),o=$4(s);let i=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=V_(i)),[i,V_(i)]}function Uge(e){const t=V_(e);return[yI(e),t,yI(t)]}function yI(e){return e.replace(/start|end/g,t=>Bge[t])}const X$=["left","right"],Y$=["right","left"],Vge=["top","bottom"],Wge=["bottom","top"];function Hge(e,t,r){switch(e){case"top":case"bottom":return r?t?Y$:X$:t?X$:Y$;case"left":case"right":return t?Vge:Wge;default:return[]}}function Gge(e,t,r,n){const s=u0(e);let o=Hge(Gf(e),r==="start",n);return s&&(o=o.map(i=>i+"-"+s),t&&(o=o.concat(o.map(yI)))),o}function V_(e){return e.replace(/left|right|bottom|top/g,t=>$ge[t])}function Kge(e){return{top:0,right:0,bottom:0,left:0,...e}}function bK(e){return typeof e!="number"?Kge(e):{top:e,right:e,bottom:e,left:e}}function W_(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function J$(e,t,r){let{reference:n,floating:s}=e;const o=Mu(t),i=B4(t),l=$4(i),c=Gf(t),d=o==="y",u=n.x+n.width/2-s.width/2,f=n.y+n.height/2-s.height/2,h=n[l]/2-s[l]/2;let m;switch(c){case"top":m={x:u,y:n.y-s.height};break;case"bottom":m={x:u,y:n.y+n.height};break;case"right":m={x:n.x+n.width,y:f};break;case"left":m={x:n.x-s.width,y:f};break;default:m={x:n.x,y:n.y}}switch(u0(t)){case"start":m[i]-=h*(r&&d?-1:1);break;case"end":m[i]+=h*(r&&d?-1:1);break}return m}const Xge=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:o=[],platform:i}=r,l=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let d=await i.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:f}=J$(d,n,c),h=n,m={},v=0;for(let g=0;g<l.length;g++){const{name:y,fn:x}=l[g],{x:b,y:w,data:j,reset:_}=await x({x:u,y:f,initialPlacement:n,placement:h,strategy:s,middlewareData:m,rects:d,platform:i,elements:{reference:e,floating:t}});u=b??u,f=w??f,m={...m,[y]:{...m[y],...j}},_&&v<=50&&(v++,typeof _=="object"&&(_.placement&&(h=_.placement),_.rects&&(d=_.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:s}):_.rects),{x:u,y:f}=J$(d,h,c)),g=-1)}return{x:u,y:f,placement:h,strategy:s,middlewareData:m}};async function Kb(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:o,rects:i,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:h=!1,padding:m=0}=Hf(t,e),v=bK(m),y=l[h?f==="floating"?"reference":"floating":f],x=W_(await o.getClippingRect({element:(r=await(o.isElement==null?void 0:o.isElement(y)))==null||r?y:y.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),b=f==="floating"?{x:n,y:s,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),j=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},_=W_(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:w,strategy:c}):b);return{top:(x.top-_.top+v.top)/j.y,bottom:(_.bottom-x.bottom+v.bottom)/j.y,left:(x.left-_.left+v.left)/j.x,right:(_.right-x.right+v.right)/j.x}}const Yge=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:o,platform:i,elements:l,middlewareData:c}=t,{element:d,padding:u=0}=Hf(e,t)||{};if(d==null)return{};const f=bK(u),h={x:r,y:n},m=B4(s),v=$4(m),g=await i.getDimensions(d),y=m==="y",x=y?"top":"left",b=y?"bottom":"right",w=y?"clientHeight":"clientWidth",j=o.reference[v]+o.reference[m]-h[m]-o.floating[v],_=h[m]-o.reference[m],C=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d));let P=C?C[w]:0;(!P||!await(i.isElement==null?void 0:i.isElement(C)))&&(P=l.floating[w]||o.floating[v]);const E=j/2-_/2,A=P/2-g[v]/2-1,F=Sh(f[x],A),D=Sh(f[b],A),I=F,R=P-g[v]-D,M=P/2-g[v]/2+E,U=xI(I,M,R),z=!c.arrow&&u0(s)!=null&&M!==U&&o.reference[v]/2-(M<I?F:D)-g[v]/2<0,W=z?M<I?M-I:M-R:0;return{[m]:h[m]+W,data:{[m]:U,centerOffset:M-U-W,...z&&{alignmentOffset:W}},reset:z}}}),Jge=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:o,rects:i,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...y}=Hf(e,t);if((r=o.arrow)!=null&&r.alignmentOffset)return{};const x=Gf(s),b=Mu(l),w=Gf(l)===l,j=await(c.isRTL==null?void 0:c.isRTL(d.floating)),_=h||(w||!g?[V_(l)]:Uge(l)),C=v!=="none";!h&&C&&_.push(...Gge(l,g,v,j));const P=[l,..._],E=await Kb(t,y),A=[];let F=((n=o.flip)==null?void 0:n.overflows)||[];if(u&&A.push(E[x]),f){const M=zge(s,i,j);A.push(E[M[0]],E[M[1]])}if(F=[...F,{placement:s,overflows:A}],!A.every(M=>M<=0)){var D,I;const M=(((D=o.flip)==null?void 0:D.index)||0)+1,U=P[M];if(U&&(!(f==="alignment"?b!==Mu(U):!1)||F.every($=>Mu($.placement)===b?$.overflows[0]>0:!0)))return{data:{index:M,overflows:F},reset:{placement:U}};let z=(I=F.filter(W=>W.overflows[0]<=0).sort((W,$)=>W.overflows[1]-$.overflows[1])[0])==null?void 0:I.placement;if(!z)switch(m){case"bestFit":{var R;const W=(R=F.filter($=>{if(C){const ee=Mu($.placement);return ee===b||ee==="y"}return!0}).map($=>[$.placement,$.overflows.filter(ee=>ee>0).reduce((ee,ve)=>ee+ve,0)]).sort(($,ee)=>$[1]-ee[1])[0])==null?void 0:R[0];W&&(z=W);break}case"initialPlacement":z=l;break}if(s!==z)return{reset:{placement:z}}}return{}}}};function Q$(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Z$(e){return Fge.some(t=>e[t]>=0)}const Qge=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=Hf(e,t);switch(n){case"referenceHidden":{const o=await Kb(t,{...s,elementContext:"reference"}),i=Q$(o,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Z$(i)}}}case"escaped":{const o=await Kb(t,{...s,altBoundary:!0}),i=Q$(o,r.floating);return{data:{escapedOffsets:i,escaped:Z$(i)}}}default:return{}}}}},wK=new Set(["left","top"]);async function Zge(e,t){const{placement:r,platform:n,elements:s}=e,o=await(n.isRTL==null?void 0:n.isRTL(s.floating)),i=Gf(r),l=u0(r),c=Mu(r)==="y",d=wK.has(i)?-1:1,u=o&&c?-1:1,f=Hf(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof v=="number"&&(m=l==="end"?v*-1:v),c?{x:m*u,y:h*d}:{x:h*d,y:m*u}}const eve=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:o,placement:i,middlewareData:l}=t,c=await Zge(t,e);return i===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:o+c.y,data:{...c,placement:i}}}}},tve=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:l={fn:y=>{let{x,y:b}=y;return{x,y:b}}},...c}=Hf(e,t),d={x:r,y:n},u=await Kb(t,c),f=Mu(Gf(s)),h=F4(f);let m=d[h],v=d[f];if(o){const y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",b=m+u[y],w=m-u[x];m=xI(b,m,w)}if(i){const y=f==="y"?"top":"left",x=f==="y"?"bottom":"right",b=v+u[y],w=v-u[x];v=xI(b,v,w)}const g=l.fn({...t,[h]:m,[f]:v});return{...g,data:{x:g.x-r,y:g.y-n,enabled:{[h]:o,[f]:i}}}}}},rve=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:o,middlewareData:i}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Hf(e,t),u={x:r,y:n},f=Mu(s),h=F4(f);let m=u[h],v=u[f];const g=Hf(l,t),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const w=h==="y"?"height":"width",j=o.reference[h]-o.floating[w]+y.mainAxis,_=o.reference[h]+o.reference[w]-y.mainAxis;m<j?m=j:m>_&&(m=_)}if(d){var x,b;const w=h==="y"?"width":"height",j=wK.has(Gf(s)),_=o.reference[f]-o.floating[w]+(j&&((x=i.offset)==null?void 0:x[f])||0)+(j?0:y.crossAxis),C=o.reference[f]+o.reference[w]+(j?0:((b=i.offset)==null?void 0:b[f])||0)-(j?y.crossAxis:0);v<_?v=_:v>C&&(v=C)}return{[h]:m,[f]:v}}}},nve=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:o,platform:i,elements:l}=t,{apply:c=()=>{},...d}=Hf(e,t),u=await Kb(t,d),f=Gf(s),h=u0(s),m=Mu(s)==="y",{width:v,height:g}=o.floating;let y,x;f==="top"||f==="bottom"?(y=f,x=h===(await(i.isRTL==null?void 0:i.isRTL(l.floating))?"start":"end")?"left":"right"):(x=f,y=h==="end"?"top":"bottom");const b=g-u.top-u.bottom,w=v-u.left-u.right,j=Sh(g-u[y],b),_=Sh(v-u[x],w),C=!t.middlewareData.shift;let P=j,E=_;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(E=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(P=b),C&&!h){const F=wc(u.left,0),D=wc(u.right,0),I=wc(u.top,0),R=wc(u.bottom,0);m?E=v-2*(F!==0||D!==0?F+D:wc(u.left,u.right)):P=g-2*(I!==0||R!==0?I+R:wc(u.top,u.bottom))}await c({...t,availableWidth:E,availableHeight:P});const A=await i.getDimensions(l.floating);return v!==A.width||g!==A.height?{reset:{rects:!0}}:{}}}};function fC(){return typeof window<"u"}function f0(e){return jK(e)?(e.nodeName||"").toLowerCase():"#document"}function Oc(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ef(e){var t;return(t=(jK(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function jK(e){return fC()?e instanceof Node||e instanceof Oc(e).Node:!1}function cu(e){return fC()?e instanceof Element||e instanceof Oc(e).Element:!1}function Ju(e){return fC()?e instanceof HTMLElement||e instanceof Oc(e).HTMLElement:!1}function e6(e){return!fC()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Oc(e).ShadowRoot}const ave=new Set(["inline","contents"]);function m1(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=du(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!ave.has(s)}const sve=new Set(["table","td","th"]);function ove(e){return sve.has(f0(e))}const ive=[":popover-open",":modal"];function mC(e){return ive.some(t=>{try{return e.matches(t)}catch{return!1}})}const lve=["transform","translate","scale","rotate","perspective"],cve=["transform","translate","scale","rotate","perspective","filter"],dve=["paint","layout","strict","content"];function q4(e){const t=z4(),r=cu(e)?du(e):e;return lve.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||cve.some(n=>(r.willChange||"").includes(n))||dve.some(n=>(r.contain||"").includes(n))}function uve(e){let t=Ch(e);for(;Ju(t)&&!jx(t);){if(q4(t))return t;if(mC(t))return null;t=Ch(t)}return null}function z4(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const fve=new Set(["html","body","#document"]);function jx(e){return fve.has(f0(e))}function du(e){return Oc(e).getComputedStyle(e)}function hC(e){return cu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ch(e){if(f0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||e6(e)&&e.host||ef(e);return e6(t)?t.host:t}function _K(e){const t=Ch(e);return jx(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ju(t)&&m1(t)?t:_K(t)}function Xb(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=_K(e),o=s===((n=e.ownerDocument)==null?void 0:n.body),i=Oc(s);if(o){const l=bI(i);return t.concat(i,i.visualViewport||[],m1(s)?s:[],l&&r?Xb(l):[])}return t.concat(s,Xb(s,[],r))}function bI(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function NK(e){const t=du(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=Ju(e),o=s?e.offsetWidth:r,i=s?e.offsetHeight:n,l=U_(r)!==o||U_(n)!==i;return l&&(r=o,n=i),{width:r,height:n,$:l}}function U4(e){return cu(e)?e:e.contextElement}function Yv(e){const t=U4(e);if(!Ju(t))return Vu(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:o}=NK(t);let i=(o?U_(r.width):r.width)/n,l=(o?U_(r.height):r.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!l||!Number.isFinite(l))&&(l=1),{x:i,y:l}}const mve=Vu(0);function SK(e){const t=Oc(e);return!z4()||!t.visualViewport?mve:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function hve(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Oc(e)?!1:t}function ng(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),o=U4(e);let i=Vu(1);t&&(n?cu(n)&&(i=Yv(n)):i=Yv(e));const l=hve(o,r,n)?SK(o):Vu(0);let c=(s.left+l.x)/i.x,d=(s.top+l.y)/i.y,u=s.width/i.x,f=s.height/i.y;if(o){const h=Oc(o),m=n&&cu(n)?Oc(n):n;let v=h,g=bI(v);for(;g&&n&&m!==v;){const y=Yv(g),x=g.getBoundingClientRect(),b=du(g),w=x.left+(g.clientLeft+parseFloat(b.paddingLeft))*y.x,j=x.top+(g.clientTop+parseFloat(b.paddingTop))*y.y;c*=y.x,d*=y.y,u*=y.x,f*=y.y,c+=w,d+=j,v=Oc(g),g=bI(v)}}return W_({width:u,height:f,x:c,y:d})}function V4(e,t){const r=hC(e).scrollLeft;return t?t.left+r:ng(ef(e)).left+r}function CK(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),s=n.left+t.scrollLeft-(r?0:V4(e,n)),o=n.top+t.scrollTop;return{x:s,y:o}}function pve(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const o=s==="fixed",i=ef(n),l=t?mC(t.floating):!1;if(n===i||l&&o)return r;let c={scrollLeft:0,scrollTop:0},d=Vu(1);const u=Vu(0),f=Ju(n);if((f||!f&&!o)&&((f0(n)!=="body"||m1(i))&&(c=hC(n)),Ju(n))){const m=ng(n);d=Yv(n),u.x=m.x+n.clientLeft,u.y=m.y+n.clientTop}const h=i&&!f&&!o?CK(i,c,!0):Vu(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+u.x+h.x,y:r.y*d.y-c.scrollTop*d.y+u.y+h.y}}function gve(e){return Array.from(e.getClientRects())}function vve(e){const t=ef(e),r=hC(e),n=e.ownerDocument.body,s=wc(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),o=wc(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+V4(e);const l=-r.scrollTop;return du(n).direction==="rtl"&&(i+=wc(t.clientWidth,n.clientWidth)-s),{width:s,height:o,x:i,y:l}}function xve(e,t){const r=Oc(e),n=ef(e),s=r.visualViewport;let o=n.clientWidth,i=n.clientHeight,l=0,c=0;if(s){o=s.width,i=s.height;const d=z4();(!d||d&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:o,height:i,x:l,y:c}}const yve=new Set(["absolute","fixed"]);function bve(e,t){const r=ng(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,o=Ju(e)?Yv(e):Vu(1),i=e.clientWidth*o.x,l=e.clientHeight*o.y,c=s*o.x,d=n*o.y;return{width:i,height:l,x:c,y:d}}function t6(e,t,r){let n;if(t==="viewport")n=xve(e,r);else if(t==="document")n=vve(ef(e));else if(cu(t))n=bve(t,r);else{const s=SK(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return W_(n)}function AK(e,t){const r=Ch(e);return r===t||!cu(r)||jx(r)?!1:du(r).position==="fixed"||AK(r,t)}function wve(e,t){const r=t.get(e);if(r)return r;let n=Xb(e,[],!1).filter(l=>cu(l)&&f0(l)!=="body"),s=null;const o=du(e).position==="fixed";let i=o?Ch(e):e;for(;cu(i)&&!jx(i);){const l=du(i),c=q4(i);!c&&l.position==="fixed"&&(s=null),(o?!c&&!s:!c&&l.position==="static"&&!!s&&yve.has(s.position)||m1(i)&&!c&&AK(e,i))?n=n.filter(u=>u!==i):s=l,i=Ch(i)}return t.set(e,n),n}function jve(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const i=[...r==="clippingAncestors"?mC(t)?[]:wve(t,this._c):[].concat(r),n],l=i[0],c=i.reduce((d,u)=>{const f=t6(t,u,s);return d.top=wc(f.top,d.top),d.right=Sh(f.right,d.right),d.bottom=Sh(f.bottom,d.bottom),d.left=wc(f.left,d.left),d},t6(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function _ve(e){const{width:t,height:r}=NK(e);return{width:t,height:r}}function Nve(e,t,r){const n=Ju(t),s=ef(t),o=r==="fixed",i=ng(e,!0,o,t);let l={scrollLeft:0,scrollTop:0};const c=Vu(0);function d(){c.x=V4(s)}if(n||!n&&!o)if((f0(t)!=="body"||m1(s))&&(l=hC(t)),n){const m=ng(t,!0,o,t);c.x=m.x+t.clientLeft,c.y=m.y+t.clientTop}else s&&d();o&&!n&&s&&d();const u=s&&!n&&!o?CK(s,l):Vu(0),f=i.left+l.scrollLeft-c.x-u.x,h=i.top+l.scrollTop-c.y-u.y;return{x:f,y:h,width:i.width,height:i.height}}function lP(e){return du(e).position==="static"}function r6(e,t){if(!Ju(e)||du(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return ef(e)===r&&(r=r.ownerDocument.body),r}function PK(e,t){const r=Oc(e);if(mC(e))return r;if(!Ju(e)){let s=Ch(e);for(;s&&!jx(s);){if(cu(s)&&!lP(s))return s;s=Ch(s)}return r}let n=r6(e,t);for(;n&&ove(n)&&lP(n);)n=r6(n,t);return n&&jx(n)&&lP(n)&&!q4(n)?r:n||uve(e)||r}const Sve=async function(e){const t=this.getOffsetParent||PK,r=this.getDimensions,n=await r(e.floating);return{reference:Nve(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Cve(e){return du(e).direction==="rtl"}const Ave={convertOffsetParentRelativeRectToViewportRelativeRect:pve,getDocumentElement:ef,getClippingRect:jve,getOffsetParent:PK,getElementRects:Sve,getClientRects:gve,getDimensions:_ve,getScale:Yv,isElement:cu,isRTL:Cve};function EK(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Pve(e,t){let r=null,n;const s=ef(e);function o(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function i(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),o();const d=e.getBoundingClientRect(),{left:u,top:f,width:h,height:m}=d;if(l||t(),!h||!m)return;const v=T2(f),g=T2(s.clientWidth-(u+h)),y=T2(s.clientHeight-(f+m)),x=T2(u),w={rootMargin:-v+"px "+-g+"px "+-y+"px "+-x+"px",threshold:wc(0,Sh(1,c))||1};let j=!0;function _(C){const P=C[0].intersectionRatio;if(P!==c){if(!j)return i();P?i(!1,P):n=setTimeout(()=>{i(!1,1e-7)},1e3)}P===1&&!EK(d,e.getBoundingClientRect())&&i(),j=!1}try{r=new IntersectionObserver(_,{...w,root:s.ownerDocument})}catch{r=new IntersectionObserver(_,w)}r.observe(e)}return i(!0),o}function Eve(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=U4(e),u=s||o?[...d?Xb(d):[],...Xb(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",r,{passive:!0}),o&&x.addEventListener("resize",r)});const f=d&&l?Pve(d,r):null;let h=-1,m=null;i&&(m=new ResizeObserver(x=>{let[b]=x;b&&b.target===d&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var w;(w=m)==null||w.observe(t)})),r()}),d&&!c&&m.observe(d),m.observe(t));let v,g=c?ng(e):null;c&&y();function y(){const x=ng(e);g&&!EK(g,x)&&r(),g=x,v=requestAnimationFrame(y)}return r(),()=>{var x;u.forEach(b=>{s&&b.removeEventListener("scroll",r),o&&b.removeEventListener("resize",r)}),f?.(),(x=m)==null||x.disconnect(),m=null,c&&cancelAnimationFrame(v)}}const kve=eve,Ive=tve,Ove=Jge,Tve=nve,Dve=Qge,n6=Yge,Mve=rve,Rve=(e,t,r)=>{const n=new Map,s={platform:Ave,...r},o={...s.platform,_c:n};return Xge(e,t,{...s,platform:o})};var Lve=typeof document<"u",Fve=function(){},Wj=Lve?p.useLayoutEffect:Fve;function H_(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!H_(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const o=s[n];if(!(o==="_owner"&&e.$$typeof)&&!H_(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function kK(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function a6(e,t){const r=kK(e);return Math.round(t*r)/r}function cP(e){const t=p.useRef(e);return Wj(()=>{t.current=e}),t}function $ve(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:o,floating:i}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,f]=p.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=p.useState(n);H_(h,n)||m(n);const[v,g]=p.useState(null),[y,x]=p.useState(null),b=p.useCallback($=>{$!==C.current&&(C.current=$,g($))},[]),w=p.useCallback($=>{$!==P.current&&(P.current=$,x($))},[]),j=o||v,_=i||y,C=p.useRef(null),P=p.useRef(null),E=p.useRef(u),A=c!=null,F=cP(c),D=cP(s),I=cP(d),R=p.useCallback(()=>{if(!C.current||!P.current)return;const $={placement:t,strategy:r,middleware:h};D.current&&($.platform=D.current),Rve(C.current,P.current,$).then(ee=>{const ve={...ee,isPositioned:I.current!==!1};M.current&&!H_(E.current,ve)&&(E.current=ve,em.flushSync(()=>{f(ve)}))})},[h,t,r,D,I]);Wj(()=>{d===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,f($=>({...$,isPositioned:!1})))},[d]);const M=p.useRef(!1);Wj(()=>(M.current=!0,()=>{M.current=!1}),[]),Wj(()=>{if(j&&(C.current=j),_&&(P.current=_),j&&_){if(F.current)return F.current(j,_,R);R()}},[j,_,R,F,A]);const U=p.useMemo(()=>({reference:C,floating:P,setReference:b,setFloating:w}),[b,w]),z=p.useMemo(()=>({reference:j,floating:_}),[j,_]),W=p.useMemo(()=>{const $={position:r,left:0,top:0};if(!z.floating)return $;const ee=a6(z.floating,u.x),ve=a6(z.floating,u.y);return l?{...$,transform:"translate("+ee+"px, "+ve+"px)",...kK(z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:ee,top:ve}},[r,l,z.floating,u.x,u.y]);return p.useMemo(()=>({...u,update:R,refs:U,elements:z,floatingStyles:W}),[u,R,U,z,W])}const Bve=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?n6({element:n.current,padding:s}).fn(r):{}:n?n6({element:n,padding:s}).fn(r):{}}}},qve=(e,t)=>({...kve(e),options:[e,t]}),zve=(e,t)=>({...Ive(e),options:[e,t]}),Uve=(e,t)=>({...Mve(e),options:[e,t]}),Vve=(e,t)=>({...Ove(e),options:[e,t]}),Wve=(e,t)=>({...Tve(e),options:[e,t]}),Hve=(e,t)=>({...Dve(e),options:[e,t]}),Gve=(e,t)=>({...Bve(e),options:[e,t]});var Kve="Arrow",IK=p.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...o}=e;return a.jsx(sa.svg,{...o,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});IK.displayName=Kve;var Xve=IK;function OK(e){const[t,r]=p.useState(void 0);return Mi(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const o=s[0];let i,l;if("borderBoxSize"in o){const c=o.borderBoxSize,d=Array.isArray(c)?c[0]:c;i=d.inlineSize,l=d.blockSize}else i=e.offsetWidth,l=e.offsetHeight;r({width:i,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var W4="Popper",[TK,m0]=Ed(W4),[Yve,DK]=TK(W4),MK=e=>{const{__scopePopper:t,children:r}=e,[n,s]=p.useState(null);return a.jsx(Yve,{scope:t,anchor:n,onAnchorChange:s,children:r})};MK.displayName=W4;var RK="PopperAnchor",LK=p.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,o=DK(RK,r),i=p.useRef(null),l=za(t,i),c=p.useRef(null);return p.useEffect(()=>{const d=c.current;c.current=n?.current||i.current,d!==c.current&&o.onAnchorChange(c.current)}),n?null:a.jsx(sa.div,{...s,ref:l})});LK.displayName=RK;var H4="PopperContent",[Jve,Qve]=TK(H4),FK=p.forwardRef((e,t)=>{const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:o="center",alignOffset:i=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:v,...g}=e,y=DK(H4,r),[x,b]=p.useState(null),w=za(t,Z=>b(Z)),[j,_]=p.useState(null),C=OK(j),P=C?.width??0,E=C?.height??0,A=n+(o!=="center"?"-"+o:""),F=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},D=Array.isArray(d)?d:[d],I=D.length>0,R={padding:F,boundary:D.filter(exe),altBoundary:I},{refs:M,floatingStyles:U,placement:z,isPositioned:W,middlewareData:$}=$ve({strategy:"fixed",placement:A,whileElementsMounted:(...Z)=>Eve(...Z,{animationFrame:m==="always"}),elements:{reference:y.anchor},middleware:[qve({mainAxis:s+E,alignmentAxis:i}),c&&zve({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?Uve():void 0,...R}),c&&Vve({...R}),Wve({...R,apply:({elements:Z,rects:ce,availableWidth:le,availableHeight:ie})=>{const{width:te,height:ue}=ce.reference,Te=Z.floating.style;Te.setProperty("--radix-popper-available-width",`${le}px`),Te.setProperty("--radix-popper-available-height",`${ie}px`),Te.setProperty("--radix-popper-anchor-width",`${te}px`),Te.setProperty("--radix-popper-anchor-height",`${ue}px`)}}),j&&Gve({element:j,padding:l}),txe({arrowWidth:P,arrowHeight:E}),h&&Hve({strategy:"referenceHidden",...R})]}),[ee,ve]=qK(z),_e=ec(v);Mi(()=>{W&&_e?.()},[W,_e]);const K=$.arrow?.x,q=$.arrow?.y,Y=$.arrow?.centerOffset!==0,[J,fe]=p.useState();return Mi(()=>{x&&fe(window.getComputedStyle(x).zIndex)},[x]),a.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:W?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:J,"--radix-popper-transform-origin":[$.transformOrigin?.x,$.transformOrigin?.y].join(" "),...$.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:a.jsx(Jve,{scope:r,placedSide:ee,onArrowChange:_,arrowX:K,arrowY:q,shouldHideArrow:Y,children:a.jsx(sa.div,{"data-side":ee,"data-align":ve,...g,ref:w,style:{...g.style,animation:W?void 0:"none"}})})})});FK.displayName=H4;var $K="PopperArrow",Zve={top:"bottom",right:"left",bottom:"top",left:"right"},BK=p.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,o=Qve($K,n),i=Zve[o.placedSide];return a.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:a.jsx(Xve,{...s,ref:r,style:{...s.style,display:"block"}})})});BK.displayName=$K;function exe(e){return e!==null}var txe=e=>({name:"transformOrigin",options:e,fn(t){const{placement:r,rects:n,middlewareData:s}=t,i=s.arrow?.centerOffset!==0,l=i?0:e.arrowWidth,c=i?0:e.arrowHeight,[d,u]=qK(r),f={start:"0%",center:"50%",end:"100%"}[u],h=(s.arrow?.x??0)+l/2,m=(s.arrow?.y??0)+c/2;let v="",g="";return d==="bottom"?(v=i?f:`${h}px`,g=`${-c}px`):d==="top"?(v=i?f:`${h}px`,g=`${n.floating.height+c}px`):d==="right"?(v=`${-c}px`,g=i?f:`${m}px`):d==="left"&&(v=`${n.floating.width+c}px`,g=i?f:`${m}px`),{data:{x:v,y:g}}}});function qK(e){const[t,r="center"]=e.split("-");return[t,r]}var G4=MK,pC=LK,K4=FK,X4=BK,rxe="Portal",h0=p.forwardRef((e,t)=>{const{container:r,...n}=e,[s,o]=p.useState(!1);Mi(()=>o(!0),[]);const i=r||s&&globalThis?.document?.body;return i?r4.createPortal(a.jsx(sa.div,{...n,ref:t}),i):null});h0.displayName=rxe;function nxe(e,t){return p.useReducer((r,n)=>t[r][n]??r,e)}var qc=e=>{const{present:t,children:r}=e,n=axe(t),s=typeof r=="function"?r({present:n.isPresent}):p.Children.only(r),o=za(n.ref,sxe(s));return typeof r=="function"||n.isPresent?p.cloneElement(s,{ref:o}):null};qc.displayName="Presence";function axe(e){const[t,r]=p.useState(),n=p.useRef(null),s=p.useRef(e),o=p.useRef("none"),i=e?"mounted":"unmounted",[l,c]=nxe(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const d=D2(n.current);o.current=l==="mounted"?d:"none"},[l]),Mi(()=>{const d=n.current,u=s.current;if(u!==e){const h=o.current,m=D2(d);e?c("MOUNT"):m==="none"||d?.display==="none"?c("UNMOUNT"):c(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),Mi(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,f=m=>{const g=D2(n.current).includes(CSS.escape(m.animationName));if(m.target===t&&g&&(c("ANIMATION_END"),!s.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},h=m=>{m.target===t&&(o.current=D2(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function D2(e){return e?.animationName||"none"}function sxe(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var oxe=u3[" useInsertionEffect ".trim().toString()]||Mi;function Kf({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,o,i]=ixe({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:s;{const u=p.useRef(e!==void 0);p.useEffect(()=>{const f=u.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,n])}const d=p.useCallback(u=>{if(l){const f=lxe(u)?u(e):u;f!==e&&i.current?.(f)}else o(u)},[l,e,o,i]);return[c,d]}function ixe({defaultProp:e,onChange:t}){const[r,n]=p.useState(e),s=p.useRef(r),o=p.useRef(t);return oxe(()=>{o.current=t},[t]),p.useEffect(()=>{s.current!==r&&(o.current?.(r),s.current=r)},[r,s]),[r,n,o]}function lxe(e){return typeof e=="function"}var cxe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Bg=new WeakMap,M2=new WeakMap,R2={},dP=0,zK=function(e){return e&&(e.host||zK(e.parentNode))},dxe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=zK(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},uxe=function(e,t,r,n){var s=dxe(t,Array.isArray(e)?e:[e]);R2[r]||(R2[r]=new WeakMap);var o=R2[r],i=[],l=new Set,c=new Set(s),d=function(f){!f||l.has(f)||(l.add(f),d(f.parentNode))};s.forEach(d);var u=function(f){!f||c.has(f)||Array.prototype.forEach.call(f.children,function(h){if(l.has(h))u(h);else try{var m=h.getAttribute(n),v=m!==null&&m!=="false",g=(Bg.get(h)||0)+1,y=(o.get(h)||0)+1;Bg.set(h,g),o.set(h,y),i.push(h),g===1&&v&&M2.set(h,!0),y===1&&h.setAttribute(r,"true"),v||h.setAttribute(n,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),l.clear(),dP++,function(){i.forEach(function(f){var h=Bg.get(f)-1,m=o.get(f)-1;Bg.set(f,h),o.set(f,m),h||(M2.has(f)||f.removeAttribute(n),M2.delete(f)),m||f.removeAttribute(r)}),dP--,dP||(Bg=new WeakMap,Bg=new WeakMap,M2=new WeakMap,R2={})}},gC=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=t||cxe(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),uxe(n,s,r,"aria-hidden")):function(){return null}},ku=function(){return ku=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},ku.apply(this,arguments)};function UK(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function fxe(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,o;n<s;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var Hj="right-scroll-bar-position",Gj="width-before-scroll-bar",mxe="with-scroll-bars-hidden",hxe="--removed-body-scroll-bar-size";function uP(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function pxe(e,t){var r=p.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var gxe=typeof window<"u"?p.useLayoutEffect:p.useEffect,s6=new WeakMap;function vxe(e,t){var r=pxe(t||null,function(n){return e.forEach(function(s){return uP(s,n)})});return gxe(function(){var n=s6.get(r);if(n){var s=new Set(n),o=new Set(e),i=r.current;s.forEach(function(l){o.has(l)||uP(l,null)}),o.forEach(function(l){s.has(l)||uP(l,i)})}s6.set(r,e)},[e]),r}function xxe(e){return e}function yxe(e,t){t===void 0&&(t=xxe);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(o){var i=t(o,n);return r.push(i),function(){r=r.filter(function(l){return l!==i})}},assignSyncMedium:function(o){for(n=!0;r.length;){var i=r;r=[],i.forEach(o)}r={push:function(l){return o(l)},filter:function(){return r}}},assignMedium:function(o){n=!0;var i=[];if(r.length){var l=r;r=[],l.forEach(o),i=r}var c=function(){var u=i;i=[],u.forEach(o)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(u){i.push(u),d()},filter:function(u){return i=i.filter(u),r}}}};return s}function bxe(e){e===void 0&&(e={});var t=yxe(null);return t.options=ku({async:!0,ssr:!1},e),t}var VK=function(e){var t=e.sideCar,r=UK(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return p.createElement(n,ku({},r))};VK.isSideCarExport=!0;function wxe(e,t){return e.useMedium(t),VK}var WK=bxe(),fP=function(){},vC=p.forwardRef(function(e,t){var r=p.useRef(null),n=p.useState({onScrollCapture:fP,onWheelCapture:fP,onTouchMoveCapture:fP}),s=n[0],o=n[1],i=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,u=e.enabled,f=e.shards,h=e.sideCar,m=e.noRelative,v=e.noIsolation,g=e.inert,y=e.allowPinchZoom,x=e.as,b=x===void 0?"div":x,w=e.gapMode,j=UK(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=h,C=vxe([r,t]),P=ku(ku({},j),s);return p.createElement(p.Fragment,null,u&&p.createElement(_,{sideCar:WK,removeScrollBar:d,shards:f,noRelative:m,noIsolation:v,inert:g,setCallbacks:o,allowPinchZoom:!!y,lockRef:r,gapMode:w}),i?p.cloneElement(p.Children.only(l),ku(ku({},P),{ref:C})):p.createElement(b,ku({},P,{className:c,ref:C}),l))});vC.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};vC.classNames={fullWidth:Gj,zeroRight:Hj};var o6,jxe=function(){if(o6)return o6;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function _xe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=jxe();return t&&e.setAttribute("nonce",t),e}function Nxe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Sxe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Cxe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=_xe())&&(Nxe(t,r),Sxe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Axe=function(){var e=Cxe();return function(t,r){p.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},HK=function(){var e=Axe(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},Pxe={left:0,top:0,right:0,gap:0},mP=function(e){return parseInt(e||"",10)||0},Exe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[mP(r),mP(n),mP(s)]},kxe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Pxe;var t=Exe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Ixe=HK(),Jv="data-scroll-locked",Oxe=function(e,t,r,n){var s=e.left,o=e.top,i=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(mxe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Jv,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Hj,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Gj,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Hj," .").concat(Hj,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Gj," .").concat(Gj,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Jv,`] {
    `).concat(hxe,": ").concat(l,`px;
  }
`)},i6=function(){var e=parseInt(document.body.getAttribute(Jv)||"0",10);return isFinite(e)?e:0},Txe=function(){p.useEffect(function(){return document.body.setAttribute(Jv,(i6()+1).toString()),function(){var e=i6()-1;e<=0?document.body.removeAttribute(Jv):document.body.setAttribute(Jv,e.toString())}},[])},Dxe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;Txe();var o=p.useMemo(function(){return kxe(s)},[s]);return p.createElement(Ixe,{styles:Oxe(o,!t,s,r?"":"!important")})},wI=!1;if(typeof window<"u")try{var L2=Object.defineProperty({},"passive",{get:function(){return wI=!0,!0}});window.addEventListener("test",L2,L2),window.removeEventListener("test",L2,L2)}catch{wI=!1}var qg=wI?{passive:!1}:!1,Mxe=function(e){return e.tagName==="TEXTAREA"},GK=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Mxe(e)&&r[t]==="visible")},Rxe=function(e){return GK(e,"overflowY")},Lxe=function(e){return GK(e,"overflowX")},l6=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=KK(e,n);if(s){var o=XK(e,n),i=o[1],l=o[2];if(i>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Fxe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},$xe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},KK=function(e,t){return e==="v"?Rxe(t):Lxe(t)},XK=function(e,t){return e==="v"?Fxe(t):$xe(t)},Bxe=function(e,t){return e==="h"&&t==="rtl"?-1:1},qxe=function(e,t,r,n,s){var o=Bxe(e,window.getComputedStyle(t).direction),i=o*n,l=r.target,c=t.contains(l),d=!1,u=i>0,f=0,h=0;do{if(!l)break;var m=XK(e,l),v=m[0],g=m[1],y=m[2],x=g-y-o*v;(v||x)&&KK(e,l)&&(f+=x,h+=v);var b=l.parentNode;l=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&(s&&Math.abs(f)<1||!s&&i>f)||!u&&(s&&Math.abs(h)<1||!s&&-i>h))&&(d=!0),d},F2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},c6=function(e){return[e.deltaX,e.deltaY]},d6=function(e){return e&&"current"in e?e.current:e},zxe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Uxe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Vxe=0,zg=[];function Wxe(e){var t=p.useRef([]),r=p.useRef([0,0]),n=p.useRef(),s=p.useState(Vxe++)[0],o=p.useState(HK)[0],i=p.useRef(e);p.useEffect(function(){i.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var g=fxe([e.lockRef.current],(e.shards||[]).map(d6),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!i.current.allowPinchZoom;var x=F2(g),b=r.current,w="deltaX"in g?g.deltaX:b[0]-x[0],j="deltaY"in g?g.deltaY:b[1]-x[1],_,C=g.target,P=Math.abs(w)>Math.abs(j)?"h":"v";if("touches"in g&&P==="h"&&C.type==="range")return!1;var E=l6(P,C);if(!E)return!0;if(E?_=P:(_=P==="v"?"h":"v",E=l6(P,C)),!E)return!1;if(!n.current&&"changedTouches"in g&&(w||j)&&(n.current=_),!_)return!0;var A=n.current||_;return qxe(A,y,g,A==="h"?w:j,!0)},[]),c=p.useCallback(function(g){var y=g;if(!(!zg.length||zg[zg.length-1]!==o)){var x="deltaY"in y?c6(y):F2(y),b=t.current.filter(function(_){return _.name===y.type&&(_.target===y.target||y.target===_.shadowParent)&&zxe(_.delta,x)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var w=(i.current.shards||[]).map(d6).filter(Boolean).filter(function(_){return _.contains(y.target)}),j=w.length>0?l(y,w[0]):!i.current.noIsolation;j&&y.cancelable&&y.preventDefault()}}},[]),d=p.useCallback(function(g,y,x,b){var w={name:g,delta:y,target:x,should:b,shadowParent:Hxe(x)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(j){return j!==w})},1)},[]),u=p.useCallback(function(g){r.current=F2(g),n.current=void 0},[]),f=p.useCallback(function(g){d(g.type,c6(g),g.target,l(g,e.lockRef.current))},[]),h=p.useCallback(function(g){d(g.type,F2(g),g.target,l(g,e.lockRef.current))},[]);p.useEffect(function(){return zg.push(o),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener("wheel",c,qg),document.addEventListener("touchmove",c,qg),document.addEventListener("touchstart",u,qg),function(){zg=zg.filter(function(g){return g!==o}),document.removeEventListener("wheel",c,qg),document.removeEventListener("touchmove",c,qg),document.removeEventListener("touchstart",u,qg)}},[]);var m=e.removeScrollBar,v=e.inert;return p.createElement(p.Fragment,null,v?p.createElement(o,{styles:Uxe(s)}):null,m?p.createElement(Dxe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Hxe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Gxe=wxe(WK,Wxe);var YK=p.forwardRef(function(e,t){return p.createElement(vC,ku({},e,{ref:t,sideCar:Gxe}))});YK.classNames=vC.classNames;const xC=YK;var yC="Popover",[JK,Flt]=Ed(yC,[m0]),h1=m0(),[Kxe,Lh]=JK(yC),QK=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:s,onOpenChange:o,modal:i=!1}=e,l=h1(t),c=p.useRef(null),[d,u]=p.useState(!1),[f,h]=Kf({prop:n,defaultProp:s??!1,onChange:o,caller:yC});return a.jsx(G4,{...l,children:a.jsx(Kxe,{scope:t,contentId:su(),triggerRef:c,open:f,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:d,onCustomAnchorAdd:p.useCallback(()=>u(!0),[]),onCustomAnchorRemove:p.useCallback(()=>u(!1),[]),modal:i,children:r})})};QK.displayName=yC;var ZK="PopoverAnchor",Xxe=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Lh(ZK,r),o=h1(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:l}=s;return p.useEffect(()=>(i(),()=>l()),[i,l]),a.jsx(pC,{...o,...n,ref:t})});Xxe.displayName=ZK;var eX="PopoverTrigger",tX=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Lh(eX,r),o=h1(r),i=za(t,s.triggerRef),l=a.jsx(sa.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":oX(s.open),...n,ref:i,onClick:jn(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:a.jsx(pC,{asChild:!0,...o,children:l})});tX.displayName=eX;var Y4="PopoverPortal",[Yxe,Jxe]=JK(Y4,{forceMount:void 0}),rX=e=>{const{__scopePopover:t,forceMount:r,children:n,container:s}=e,o=Lh(Y4,t);return a.jsx(Yxe,{scope:t,forceMount:r,children:a.jsx(qc,{present:r||o.open,children:a.jsx(h0,{asChild:!0,container:s,children:n})})})};rX.displayName=Y4;var _x="PopoverContent",nX=p.forwardRef((e,t)=>{const r=Jxe(_x,e.__scopePopover),{forceMount:n=r.forceMount,...s}=e,o=Lh(_x,e.__scopePopover);return a.jsx(qc,{present:n||o.open,children:o.modal?a.jsx(Zxe,{...s,ref:t}):a.jsx(e0e,{...s,ref:t})})});nX.displayName=_x;var Qxe=Nh("PopoverContent.RemoveScroll"),Zxe=p.forwardRef((e,t)=>{const r=Lh(_x,e.__scopePopover),n=p.useRef(null),s=za(t,n),o=p.useRef(!1);return p.useEffect(()=>{const i=n.current;if(i)return gC(i)},[]),a.jsx(xC,{as:Qxe,allowPinchZoom:!0,children:a.jsx(aX,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:jn(e.onCloseAutoFocus,i=>{i.preventDefault(),o.current||r.triggerRef.current?.focus()}),onPointerDownOutside:jn(e.onPointerDownOutside,i=>{const l=i.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;o.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:jn(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),e0e=p.forwardRef((e,t)=>{const r=Lh(_x,e.__scopePopover),n=p.useRef(!1),s=p.useRef(!1);return a.jsx(aX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{e.onCloseAutoFocus?.(o),o.defaultPrevented||(n.current||r.triggerRef.current?.focus(),o.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:o=>{e.onInteractOutside?.(o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=o.target;r.triggerRef.current?.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&s.current&&o.preventDefault()}})}),aX=p.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...f}=e,h=Lh(_x,r),m=h1(r);return uC(),a.jsx(f1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:o,children:a.jsx(d0,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>h.onOpenChange(!1),children:a.jsx(K4,{"data-state":oX(h.open),role:"dialog",id:h.contentId,...m,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),sX="PopoverClose",t0e=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Lh(sX,r);return a.jsx(sa.button,{type:"button",...n,ref:t,onClick:jn(e.onClick,()=>s.onOpenChange(!1))})});t0e.displayName=sX;var r0e="PopoverArrow",n0e=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=h1(r);return a.jsx(X4,{...s,...n,ref:t})});n0e.displayName=r0e;function oX(e){return e?"open":"closed"}var a0e=QK,s0e=tX,o0e=rX,iX=nX;const ci=a0e,di=s0e,Jo=Se.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},s)=>a.jsx(o0e,{container:document.body,children:a.jsx(iX,{ref:s,align:t,sideOffset:r,className:gr("z-[9999] w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Jo.displayName=iX.displayName;var bC="Dialog",[lX,cX]=Ed(bC),[i0e,pu]=lX(bC),dX=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:o,modal:i=!0}=e,l=p.useRef(null),c=p.useRef(null),[d,u]=Kf({prop:n,defaultProp:s??!1,onChange:o,caller:bC});return a.jsx(i0e,{scope:t,triggerRef:l,contentRef:c,contentId:su(),titleId:su(),descriptionId:su(),open:d,onOpenChange:u,onOpenToggle:p.useCallback(()=>u(f=>!f),[u]),modal:i,children:r})};dX.displayName=bC;var uX="DialogTrigger",fX=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=pu(uX,r),o=za(t,s.triggerRef);return a.jsx(sa.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Z4(s.open),...n,ref:o,onClick:jn(e.onClick,s.onOpenToggle)})});fX.displayName=uX;var J4="DialogPortal",[l0e,mX]=lX(J4,{forceMount:void 0}),hX=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,o=pu(J4,t);return a.jsx(l0e,{scope:t,forceMount:r,children:p.Children.map(n,i=>a.jsx(qc,{present:r||o.open,children:a.jsx(h0,{asChild:!0,container:s,children:i})}))})};hX.displayName=J4;var G_="DialogOverlay",pX=p.forwardRef((e,t)=>{const r=mX(G_,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,o=pu(G_,e.__scopeDialog);return o.modal?a.jsx(qc,{present:n||o.open,children:a.jsx(d0e,{...s,ref:t})}):null});pX.displayName=G_;var c0e=Nh("DialogOverlay.RemoveScroll"),d0e=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=pu(G_,r);return a.jsx(xC,{as:c0e,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(sa.div,{"data-state":Z4(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),ag="DialogContent",gX=p.forwardRef((e,t)=>{const r=mX(ag,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,o=pu(ag,e.__scopeDialog);return a.jsx(qc,{present:n||o.open,children:o.modal?a.jsx(u0e,{...s,ref:t}):a.jsx(f0e,{...s,ref:t})})});gX.displayName=ag;var u0e=p.forwardRef((e,t)=>{const r=pu(ag,e.__scopeDialog),n=p.useRef(null),s=za(t,r.contentRef,n);return p.useEffect(()=>{const o=n.current;if(o)return gC(o)},[]),a.jsx(vX,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:jn(e.onCloseAutoFocus,o=>{o.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:jn(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,l=i.button===0&&i.ctrlKey===!0;(i.button===2||l)&&o.preventDefault()}),onFocusOutside:jn(e.onFocusOutside,o=>o.preventDefault())})}),f0e=p.forwardRef((e,t)=>{const r=pu(ag,e.__scopeDialog),n=p.useRef(!1),s=p.useRef(!1);return a.jsx(vX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{e.onCloseAutoFocus?.(o),o.defaultPrevented||(n.current||r.triggerRef.current?.focus(),o.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:o=>{e.onInteractOutside?.(o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=o.target;r.triggerRef.current?.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&s.current&&o.preventDefault()}})}),vX=p.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:o,...i}=e,l=pu(ag,r),c=p.useRef(null),d=za(t,c);return uC(),a.jsxs(a.Fragment,{children:[a.jsx(f1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:o,children:a.jsx(d0,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":Z4(l.open),...i,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(h0e,{titleId:l.titleId}),a.jsx(g0e,{contentRef:c,descriptionId:l.descriptionId})]})]})}),Q4="DialogTitle",xX=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=pu(Q4,r);return a.jsx(sa.h2,{id:s.titleId,...n,ref:t})});xX.displayName=Q4;var yX="DialogDescription",bX=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=pu(yX,r);return a.jsx(sa.p,{id:s.descriptionId,...n,ref:t})});bX.displayName=yX;var wX="DialogClose",jX=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=pu(wX,r);return a.jsx(sa.button,{type:"button",...n,ref:t,onClick:jn(e.onClick,()=>s.onOpenChange(!1))})});jX.displayName=wX;function Z4(e){return e?"open":"closed"}var _X="DialogTitleWarning",[m0e,NX]=vge(_X,{contentName:ag,titleName:Q4,docsSlug:"dialog"}),h0e=({titleId:e})=>{const t=NX(_X),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return p.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},p0e="DialogDescriptionWarning",g0e=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${NX(p0e).contentName}}.`;return p.useEffect(()=>{const s=e.current?.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},SX=dX,v0e=fX,CX=hX,eD=pX,tD=gX,rD=xX,nD=bX,wC=jX;const xn=SX,x0e=CX,lh=wC,AX=Se.forwardRef(({className:e,disableAnimations:t,...r},n)=>{const s=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),o=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,i=(t??!1)||s||o;return a.jsx(eD,{ref:n,className:gr("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",i?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r})});AX.displayName=eD.displayName;const vn=Se.forwardRef(({className:e,children:t,overlayClassName:r,disableAnimations:n,alignTop:s,...o},i)=>{const l=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),c=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,d=(n??!1)||l||c;return a.jsxs(x0e,{children:[a.jsx(AX,{disableAnimations:d,className:r}),a.jsxs(tD,{ref:i,className:gr("fixed z-50 grid w-full max-w-lg gap-4 border border-border bg-surface p-6 shadow-lg duration-200 sm:rounded-lg",s?"left-1/2 top-[10%] -translate-x-1/2":"left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",d?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...o,children:[t,a.jsxs(wC,{className:"absolute right-3 top-3 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground p-1",children:[a.jsx(el,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]})});vn.displayName=tD.displayName;const pn=({className:e,...t})=>a.jsx("div",{className:gr("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});pn.displayName="DialogHeader";const ra=({className:e,...t})=>a.jsx("div",{className:gr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});ra.displayName="DialogFooter";const un=Se.forwardRef(({className:e,...t},r)=>a.jsx(rD,{ref:r,className:gr("text-lg font-semibold leading-none tracking-tight",e),...t}));un.displayName=rD.displayName;const Dn=Se.forwardRef(({className:e,...t},r)=>a.jsx(nD,{ref:r,className:gr("text-sm text-text-secondary",e),...t}));Dn.displayName=nD.displayName;const y0e=1;let hP=0;function b0e(){return hP=(hP+1)%Number.MAX_VALUE,hP.toString()}const pl={state:{toasts:[]},listeners:[],getState:()=>pl.state,setState:e=>{typeof e=="function"?pl.state=e(pl.state):pl.state={...pl.state,...e},pl.listeners.forEach(t=>t(pl.state))},subscribe:e=>(pl.listeners.push(e),()=>{pl.listeners=pl.listeners.filter(t=>t!==e)})},Kj=({...e})=>{const t=b0e(),r=s=>pl.setState(o=>({...o,toasts:o.toasts.map(i=>i.id===t?{...i,...s}:i)})),n=()=>pl.setState(s=>({...s,toasts:s.toasts.filter(o=>o.id!==t)}));return pl.setState(s=>({...s,toasts:[{...e,id:t,dismiss:n},...s.toasts].slice(0,y0e)})),{id:t,dismiss:n,update:r}};function as(){const[e,t]=p.useState(pl.getState());return p.useEffect(()=>pl.subscribe(n=>{t(n)}),[]),p.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const s=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(s)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:Kj,toasts:e.toasts}}const w0e="main",j0e={dev:{supabaseUrl:"https://xlbgopcindcsteymtwjp.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhsYmdvcGNpbmRjc3RleW10d2pwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3MDAwMTQsImV4cCI6MjA4MDI3NjAxNH0.0ydvsFW8j5ZKCyHalAlFWHjjK8QbcDC6mZQzVJ0lSnA"},main:{supabaseUrl:"https://dlfryxtyxqoacuunswuc.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY"}},_0e=Object.freeze(Object.defineProperty({__proto__:null,ACTIVE_TARGET:w0e,TARGETS:j0e},Symbol.toStringTag,{value:"Module"})),N0e=void 0,S0e=void 0,C0e=Object.freeze(Object.defineProperty({__proto__:null,ACTIVE_TARGET:N0e,TARGETS:S0e},Symbol.toStringTag,{value:"Module"})),A0e="modulepreload",P0e=function(e){return"/"+e},u6={},Wu=function(t,r,n){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=P0e(o),o in u6)return;u6[o]=!0;const i=o.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!n)for(let u=s.length-1;u>=0;u--){const f=s[u];if(f.href===o&&(!i||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":A0e,i||(d.as="script",d.crossOrigin=""),d.href=o,document.head.appendChild(d),i)return new Promise((u,f)=>{d.addEventListener("load",u),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})},E0e=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Wu(()=>Promise.resolve().then(()=>p0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class aD extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class f6 extends aD{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class m6 extends aD{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class h6 extends aD{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var jI;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(jI||(jI={}));var k0e=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class I0e{constructor(t,{headers:r={},customFetch:n,region:s=jI.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=E0e(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return k0e(this,arguments,void 0,function*(r,n={}){var s;try{const{headers:o,method:i,body:l,signal:c}=n;let d={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let h;l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(d["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(d["Content-Type"]="application/json",h=JSON.stringify(l)));const m=yield this.fetch(f.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:h,signal:c}).catch(x=>{throw x.name==="AbortError"?x:new f6(x)}),v=m.headers.get("x-relay-error");if(v&&v==="true")throw new m6(m);if(!m.ok)throw new h6(m);let g=((s=m.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),y;return g==="application/json"?y=yield m.json():g==="application/octet-stream"?y=yield m.blob():g==="text/event-stream"?y=m:g==="multipart/form-data"?y=yield m.formData():y=yield m.text(),{data:y,error:null,response:m}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new f6(o)}:{data:null,error:o,response:o instanceof h6||o instanceof m6?o.context:void 0}}})}}var zl={},sD={},jC={},p1={},_C={},NC={},O0e=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Nx=O0e();const T0e=Nx.fetch,PX=Nx.fetch.bind(Nx),EX=Nx.Headers,D0e=Nx.Request,M0e=Nx.Response,p0=Object.freeze(Object.defineProperty({__proto__:null,Headers:EX,Request:D0e,Response:M0e,default:PX,fetch:T0e},Symbol.toStringTag,{value:"Module"})),R0e=lie(p0);var SC={};Object.defineProperty(SC,"__esModule",{value:!0});let L0e=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};SC.default=L0e;var kX=Qi&&Qi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(NC,"__esModule",{value:!0});const F0e=kX(R0e),$0e=kX(SC);let B0e=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=F0e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var i,l,c,d;let u=null,f=null,h=null,m=o.status,v=o.statusText;if(o.ok){if(this.method!=="HEAD"){const b=await o.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?f=b:f=JSON.parse(b))}const y=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),x=(c=o.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");y&&x&&x.length>1&&(h=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,h=null,m=406,v="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const y=await o.text();try{u=JSON.parse(y),Array.isArray(u)&&o.status===404&&(f=[],u=null,m=200,v="OK")}catch{o.status===404&&y===""?(m=204,v="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((d=u?.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,m=200,v="OK"),u&&this.shouldThrowOnError)throw new $0e.default(u)}return{error:u,data:f,count:h,status:m,statusText:v}});return this.shouldThrowOnError||(s=s.catch(o=>{var i,l,c;return{error:{message:`${(i=o?.name)!==null&&i!==void 0?i:"FetchError"}: ${o?.message}`,details:`${(l=o?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=o?.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};NC.default=B0e;var q0e=Qi&&Qi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_C,"__esModule",{value:!0});const z0e=q0e(NC);let U0e=class extends z0e.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:o=s}={}){const i=o?`${o}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const o=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:o=!1,format:i="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,o?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${d}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};_C.default=U0e;var V0e=Qi&&Qi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(p1,"__esModule",{value:!0});const W0e=V0e(_C);let H0e=class extends W0e.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let o="";s==="plain"?o="pl":s==="phrase"?o="ph":s==="websearch"&&(o="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${o}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};p1.default=H0e;var G0e=Qi&&Qi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jC,"__esModule",{value:!0});const ry=G0e(p1);let K0e=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(t,r){const{head:n=!1,count:s}=r??{},o=n?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",l),s&&this.headers.append("Prefer",`count=${s}`),new ry.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var s;const o="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(i.length>0){const l=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ry.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:o=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new ry.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new ry.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new ry.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};jC.default=K0e;var IX=Qi&&Qi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sD,"__esModule",{value:!0});const X0e=IX(jC),Y0e=IX(p1);let J0e=class OX{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new X0e.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new OX(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:o}={}){var i;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([f,h])=>h!==void 0).map(([f,h])=>[f,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([f,h])=>{c.searchParams.append(f,h)})):(l="POST",d=r);const u=new Headers(this.headers);return o&&u.set("Prefer",`count=${o}`),new Y0e.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};sD.default=J0e;var g0=Qi&&Qi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zl,"__esModule",{value:!0});zl.PostgrestError=zl.PostgrestBuilder=zl.PostgrestTransformBuilder=zl.PostgrestFilterBuilder=zl.PostgrestQueryBuilder=zl.PostgrestClient=void 0;const TX=g0(sD);zl.PostgrestClient=TX.default;const DX=g0(jC);zl.PostgrestQueryBuilder=DX.default;const MX=g0(p1);zl.PostgrestFilterBuilder=MX.default;const RX=g0(_C);zl.PostgrestTransformBuilder=RX.default;const LX=g0(NC);zl.PostgrestBuilder=LX.default;const FX=g0(SC);zl.PostgrestError=FX.default;var Q0e=zl.default={PostgrestClient:TX.default,PostgrestQueryBuilder:DX.default,PostgrestFilterBuilder:MX.default,PostgrestTransformBuilder:RX.default,PostgrestBuilder:LX.default,PostgrestError:FX.default};const{PostgrestClient:Z0e,PostgrestQueryBuilder:Vlt,PostgrestFilterBuilder:Wlt,PostgrestTransformBuilder:Hlt,PostgrestBuilder:Glt,PostgrestError:Klt}=Q0e;class eye{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const tye="2.75.0",rye=`realtime-js/${tye}`,nye="1.0.0",_I=1e4,aye=1e3,sye=100;var Xy;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Xy||(Xy={}));var Vo;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Vo||(Vo={}));var Kd;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Kd||(Kd={}));var NI;(function(e){e.websocket="websocket"})(NI||(NI={}));var vp;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(vp||(vp={}));class oye{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),o=r.getUint8(2);let i=this.HEADER_LENGTH+2;const l=n.decode(t.slice(i,i+s));i=i+s;const c=n.decode(t.slice(i,i+o));i=i+o;const d=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class $X{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var As;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(As||(As={}));const p6=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((o,i)=>(o[i]=iye(i,e,t,s),o),{}):{}},iye=(e,t,r,n)=>{const s=t.find(l=>l.name===e),o=s?.type,i=r[e];return o&&!n.includes(o)?BX(o,i):SI(i)},BX=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return uye(t,r)}switch(e){case As.bool:return lye(t);case As.float4:case As.float8:case As.int2:case As.int4:case As.int8:case As.numeric:case As.oid:return cye(t);case As.json:case As.jsonb:return dye(t);case As.timestamp:return fye(t);case As.abstime:case As.date:case As.daterange:case As.int4range:case As.int8range:case As.money:case As.reltime:case As.text:case As.time:case As.timestamptz:case As.timetz:case As.tsrange:case As.tstzrange:return SI(t);default:return SI(t)}},SI=e=>e,lye=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},cye=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},dye=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},uye=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let o;const i=e.slice(1,r);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(l=>BX(t,l))}return e},fye=e=>typeof e=="string"?e.replace(" ","T"):e,qX=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class pP{constructor(t,r,n={},s=_I){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var g6;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(g6||(g6={}));class Yy{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Yy.syncState(this.state,s,o,i),this.pendingDiffs.forEach(c=>{this.state=Yy.syncDiff(this.state,c,o,i)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Yy.syncDiff(this.state,s,o,i),l())}),this.onJoin((s,o,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:i})}),this.onLeave((s,o,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const o=this.cloneDeep(t),i=this.transformState(r),l={},c={};return this.map(o,(d,u)=>{i[d]||(c[d]=u)}),this.map(i,(d,u)=>{const f=o[d];if(f){const h=u.map(y=>y.presence_ref),m=f.map(y=>y.presence_ref),v=u.filter(y=>m.indexOf(y.presence_ref)<0),g=f.filter(y=>h.indexOf(y.presence_ref)<0);v.length>0&&(l[d]=v),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(o,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:o,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(o,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const f=t[l].map(m=>m.presence_ref),h=u.filter(m=>f.indexOf(m.presence_ref)<0);t[l].unshift(...h)}n(l,u,c)}),this.map(i,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[l]=d,s(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var v6;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(v6||(v6={}));var Jy;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Jy||(Jy={}));var bf;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(bf||(bf={}));class oD{constructor(t,r={config:{}},n){var s,o;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Vo.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new pP(this,Kd.join,this.params,this.timeout),this.rejoinTimer=new $X(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Vo.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Vo.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Vo.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Vo.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Vo.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Kd.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new Yy(this),this.broadcastEndpointURL=qX(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Vo.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,d=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[Jy.PRESENCE]&&this.bindings[Jy.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>t?.(bf.CHANNEL_ERROR,m)),this._onClose(()=>t?.(bf.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var v;if(this.socket.setAuth(),m===void 0){t?.(bf.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(v=g?.length)!==null&&v!==void 0?v:0,x=[];for(let b=0;b<y;b++){const w=g[b],{filter:{event:j,schema:_,table:C,filter:P}}=w,E=m&&m[b];if(E&&E.event===j&&E.schema===_&&E.table===C&&E.filter===P)x.push(Object.assign(Object.assign({},w),{id:E.id}));else{this.unsubscribe(),this.state=Vo.errored,t?.(bf.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(bf.SUBSCRIBED);return}}).receive("error",m=>{this.state=Vo.errored,t?.(bf.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t?.(bf.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Vo.joined&&t===Jy.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Vo.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Kd.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new pP(this,Kd.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Vo.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,o=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(o),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new pP(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>sye){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,o;const i=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Kd;if(n&&[l,c,d,u].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var v,g,y;return((v=m.filter)===null||v===void 0?void 0:v.event)==="*"||((y=(g=m.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(m=>m.callback(h,n)):(o=this.bindings[i])===null||o===void 0||o.filter(m=>{var v,g,y,x,b,w;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const j=m.id,_=(v=m.filter)===null||v===void 0?void 0:v.event;return j&&((g=r.ids)===null||g===void 0?void 0:g.includes(j))&&(_==="*"||_?.toLocaleLowerCase()===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const j=(b=(x=m?.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return j==="*"||j===((w=r?.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:g,table:y,commit_timestamp:x,type:b,errors:w}=v;h=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:x,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(v))}m.callback(h,n)})}_isClosed(){return this.state===Vo.closed}_isJoined(){return this.state===Vo.joined}_isJoining(){return this.state===Vo.joining}_isLeaving(){return this.state===Vo.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),o={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&oD.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Kd.close,{},t)}_onError(t){this._on(Kd.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Vo.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=p6(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=p6(t.columns,t.old_record)),r}}const gP=()=>{},$2={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},mye=[1e3,2e3,5e3,1e4],hye=1e4,pye=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class gye{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=_I,this.transport=null,this.heartbeatIntervalMs=$2.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=gP,this.ref=0,this.reconnectTimer=null,this.logger=gP,this.conn=null,this.sendBuffer=[],this.serializer=new oye,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...i)=>Wu(()=>Promise.resolve().then(()=>p0),void 0).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...i)=>o(...i)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${NI.websocket}`,this.httpEndpoint=qX(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=eye.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:nye}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Xy.connecting:return vp.Connecting;case Xy.open:return vp.Open;case Xy.closing:return vp.Closing;default:return vp.Closed}}isConnected(){return this.connectionState()===vp.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(o=>o.topic===n);if(s)return s;{const o=new oD(`realtime:${t}`,r,this);return this.channels.push(o),o}}push(t){const{topic:r,event:n,payload:s,ref:o}=t,i=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${o})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(aye,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},$2.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:o,ref:i}=r,l=i?`(${i})`:"",c=o.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),o),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(s,o,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Kd.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([pye],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:rye};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Kd.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new $X(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$2.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,o,i,l,c,d,u;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:_I,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:$2.HEARTBEAT_INTERVAL,this.worker=(o=t?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=t?.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=t?.heartbeatCallback)!==null&&l!==void 0?l:gP,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:f=>mye[f-1]||hye,this.encode=(d=t?.encode)!==null&&d!==void 0?d:(f,h)=>h(JSON.stringify(f)),this.decode=(u=t?.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class iD extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Oo(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class vye extends iD{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class CI extends iD{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var xye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const zX=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Wu(()=>Promise.resolve().then(()=>p0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},yye=()=>xye(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Wu(()=>Promise.resolve().then(()=>p0),void 0)).Response:Response}),AI=e=>{if(Array.isArray(e))return e.map(r=>AI(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[s]=AI(n)}),t},bye=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Ng=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const vP=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),wye=(e,t,r)=>Ng(void 0,void 0,void 0,function*(){const n=yield yye();e instanceof n&&!r?.noResolveJson?e.json().then(s=>{const o=e.status||500,i=s?.statusCode||o+"";t(new vye(vP(s),o,i))}).catch(s=>{t(new CI(vP(s),s))}):t(new CI(vP(e),e))}),jye=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||!n?s:(bye(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(n)):s.body=n,t?.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function g1(e,t,r,n,s,o){return Ng(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(r,jye(t,n,s,o)).then(c=>{if(!c.ok)throw c;return n?.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>wye(c,l,n))})})}function K_(e,t,r,n){return Ng(this,void 0,void 0,function*(){return g1(e,"GET",t,r,n)})}function Pu(e,t,r,n,s){return Ng(this,void 0,void 0,function*(){return g1(e,"POST",t,n,s,r)})}function PI(e,t,r,n,s){return Ng(this,void 0,void 0,function*(){return g1(e,"PUT",t,n,s,r)})}function _ye(e,t,r,n){return Ng(this,void 0,void 0,function*(){return g1(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function UX(e,t,r,n,s){return Ng(this,void 0,void 0,function*(){return g1(e,"DELETE",t,n,s,r)})}var Nye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Sye{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Nye(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Oo(t))return{data:null,error:t};throw t}})}}var Cye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Aye{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}asStream(){return new Sye(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.execute().then(t,r)}execute(){return Cye(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Oo(t))return{data:null,error:t};throw t}})}}var Rl=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Pye={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},x6={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Eye{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=zX(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return Rl(this,void 0,void 0,function*(){try{let o;const i=Object.assign(Object.assign({},x6),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c))):(o=n,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s?.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield(t=="PUT"?PI:Pu)(this.fetch,`${this.url}/object/${u}`,o,Object.assign({headers:l},i?.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Oo(o))return{data:null,error:o};throw o}})}upload(t,r,n){return Rl(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Rl(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),i=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:x6.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield PI(this.fetch,l.toString(),c,{headers:u});return{data:{path:o,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Oo(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Rl(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r?.upsert&&(s["x-upsert"]="true");const o=yield Pu(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(this.url+o.url),l=i.searchParams.get("token");if(!l)throw new iD("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Oo(n))return{data:null,error:n};throw n}})}update(t,r,n){return Rl(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Rl(this,void 0,void 0,function*(){try{return{data:yield Pu(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Oo(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Rl(this,void 0,void 0,function*(){try{return{data:{path:(yield Pu(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Oo(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Rl(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),o=yield Pu(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Oo(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Rl(this,void 0,void 0,function*(){try{const s=yield Pu(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Oo(s))return{data:null,error:s};throw s}})}download(t,r){const s=typeof r?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(r?.transform||{}),i=o?`?${o}`:"",l=this._getFinalPath(t),c=()=>K_(this.fetch,`${this.url}/${s}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new Aye(c,this.shouldThrowOnError)}info(t){return Rl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield K_(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:AI(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Oo(n))return{data:null,error:n};throw n}})}exists(t){return Rl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield _ye(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Oo(n)&&n instanceof CI){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],o=r?.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&s.push(o);const l=typeof r?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(r?.transform||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return Rl(this,void 0,void 0,function*(){try{return{data:yield UX(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Oo(r))return{data:null,error:r};throw r}})}list(t,r,n){return Rl(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Pye),r),{prefix:t||""});return{data:yield Pu(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Oo(s))return{data:null,error:s};throw s}})}listV2(t,r){return Rl(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Pu(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Oo(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const kye="2.75.0",Iye={"X-Client-Info":`storage-js/${kye}`};var Ug=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Oye{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const o=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Iye),r),this.fetch=zX(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Ug(this,void 0,void 0,function*(){try{return{data:yield K_(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Oo(t))return{data:null,error:t};throw t}})}getBucket(t){return Ug(this,void 0,void 0,function*(){try{return{data:yield K_(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Oo(r))return{data:null,error:r};throw r}})}createBucket(t){return Ug(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Pu(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Oo(s))return{data:null,error:s};throw s}})}updateBucket(t,r){return Ug(this,void 0,void 0,function*(){try{return{data:yield PI(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Oo(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ug(this,void 0,void 0,function*(){try{return{data:yield Pu(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Oo(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ug(this,void 0,void 0,function*(){try{return{data:yield UX(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Oo(r))return{data:null,error:r};throw r}})}}class Tye extends Oye{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new Eye(this.url,this.headers,t,this.fetch)}}const Dye="2.75.0";let Py="";typeof Deno<"u"?Py="deno":typeof document<"u"?Py="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Py="react-native":Py="node";const Mye={"X-Client-Info":`supabase-js-${Py}/${Dye}`},Rye={headers:Mye},Lye={schema:"public"},Fye={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},$ye={};var Bye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const qye=e=>{let t;return e?t=e:typeof fetch>"u"?t=PX:t=fetch,(...r)=>t(...r)},zye=()=>typeof Headers>"u"?EX:Headers,Uye=(e,t,r)=>{const n=qye(r),s=zye();return(o,i)=>Bye(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new s(i?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(o,Object.assign(Object.assign({},i),{headers:d}))})};var Vye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function Wye(e){return e.endsWith("/")?e:e+"/"}function Hye(e,t){var r,n;const{db:s,auth:o,realtime:i,global:l}=e,{db:c,auth:d,realtime:u,global:f}=t,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),o),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f?.headers)!==null&&r!==void 0?r:{}),(n=l?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Vye(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function Gye(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Wye(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const VX="2.75.0",hv=30*1e3,EI=3,xP=EI*hv,Kye="http://localhost:9999",Xye="supabase.auth.token",Yye={"X-Client-Info":`gotrue-js/${VX}`},kI="X-Supabase-Api-Version",WX={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Jye=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Qye=10*60*1e3;class Yb extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Zn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Zye extends Yb{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function ebe(e){return Zn(e)&&e.name==="AuthApiError"}class xp extends Yb{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Fh extends Yb{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Cm extends Fh{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function tbe(e){return Zn(e)&&e.name==="AuthSessionMissingError"}class Vg extends Fh{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class B2 extends Fh{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class q2 extends Fh{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function rbe(e){return Zn(e)&&e.name==="AuthImplicitGrantRedirectError"}class y6 extends Fh{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class II extends Fh{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function yP(e){return Zn(e)&&e.name==="AuthRetryableFetchError"}class b6 extends Fh{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class OI extends Fh{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const X_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),w6=` 	
\r=`.split(""),nbe=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<w6.length;t+=1)e[w6[t].charCodeAt(0)]=-2;for(let t=0;t<X_.length;t+=1)e[X_[t].charCodeAt(0)]=t;return e})();function j6(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(X_[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(X_[n]),t.queuedBits-=6}}function HX(e,t,r){const n=nbe[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function _6(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=i=>{obe(i,n,r)};for(let i=0;i<e.length;i+=1)HX(e.charCodeAt(i),s,o);return t.join("")}function abe(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function sbe(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}abe(n,t)}}function obe(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Qv(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)HX(e.charCodeAt(s),r,n);return new Uint8Array(t)}function ibe(e){const t=[];return sbe(e,r=>t.push(r)),new Uint8Array(t)}function Sp(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>j6(s,r,n)),j6(null,r,n),t.join("")}function lbe(e){return Math.round(Date.now()/1e3)+e}function cbe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const pc=()=>typeof window<"u"&&typeof document<"u",Jh={tested:!1,writable:!1},GX=()=>{if(!pc())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Jh.tested)return Jh.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Jh.tested=!0,Jh.writable=!0}catch{Jh.tested=!0,Jh.writable=!1}return Jh.writable};function dbe(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,o)=>{t[o]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const KX=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Wu(()=>Promise.resolve().then(()=>p0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},ube=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",pv=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Qh=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},vm=async(e,t)=>{await e.removeItem(t)};class CC{constructor(){this.promise=new CC.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}CC.promiseConstructor=Promise;function bP(e){const t=e.split(".");if(t.length!==3)throw new OI("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Jye.test(t[n]))throw new OI("JWT not in base64url format");return{header:JSON.parse(_6(t[0])),payload:JSON.parse(_6(t[1])),signature:Qv(t[2]),raw:{header:t[0],payload:t[1]}}}async function fbe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function mbe(e,t){return new Promise((n,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await e(o);if(!t(o,null,i)){n(i);return}}catch(i){if(!t(o,i)){s(i);return}}})()})}function hbe(e){return("0"+e.toString(16)).substr(-2)}function pbe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let o=0;o<56;o++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,hbe).join("")}async function gbe(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function vbe(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await gbe(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wg(e,t,r=!1){const n=pbe();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await pv(e,`${t}-code-verifier`,s);const o=await vbe(n);return[o,n===o?"plain":"s256"]}const xbe=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ybe(e){const t=e.headers.get(kI);if(!t||!t.match(xbe))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function bbe(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function wbe(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const jbe=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hg(e){if(!jbe.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function wP(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function N6(e){return JSON.parse(JSON.stringify(e))}var _be=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const cp=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Nbe=[502,503,504];async function S6(e){var t;if(!ube(e))throw new II(cp(e),0);if(Nbe.includes(e.status))throw new II(cp(e),e.status);let r;try{r=await e.json()}catch(o){throw new xp(cp(o),o)}let n;const s=ybe(e);if(s&&s.getTime()>=WX["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new b6(cp(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Cm}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new b6(cp(r),e.status,r.weak_password.reasons);throw new Zye(cp(r),e.status||500,n)}const Sbe=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function wa(e,t,r,n){var s;const o=Object.assign({},n?.headers);o[kI]||(o[kI]=WX["2024-01-01"].name),n?.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const i=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(i.redirect_to=n.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await Cbe(e,t,r+l,{headers:o,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(c):{data:Object.assign({},c),error:null}}async function Cbe(e,t,r,n,s,o){const i=Sbe(t,n,s,o);let l;try{l=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new II(cp(c),0)}if(l.ok||await S6(l),n?.noResolveJson)return l;try{return await l.json()}catch(c){await S6(c)}}function Ud(e){var t;let r=null;Ebe(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=lbe(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function C6(e){const t=Ud(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Mm(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Abe(e){return{data:e,error:null}}function Pbe(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:o}=e,i=_be(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:o},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function A6(e){return e}function Ebe(e){return e.access_token&&e.refresh_token&&e.expires_in}const jP=["global","local","others"];var kbe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class Ibe{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=KX(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=jP[0]){if(jP.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${jP.join(", ")}`);try{return await wa(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Zn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await wa(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Mm})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=kbe(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await wa(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Pbe,redirectTo:r?.redirectTo})}catch(r){if(Zn(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await wa(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Mm})}catch(r){if(Zn(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await wa(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:A6});if(u.error)throw u.error;const f=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Zn(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Hg(t);try{return await wa(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Mm})}catch(r){if(Zn(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Hg(t);try{return await wa(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Mm})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Hg(t);try{return await wa(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Mm})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Hg(t.userId);try{const{data:r,error:n}=await wa(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Hg(t.userId),Hg(t.id);try{return{data:await wa(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await wa(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:A6});if(u.error)throw u.error;const f=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Zn(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await wa(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await wa(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await wa(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await wa(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}}function P6(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Gg={debug:!!(globalThis&&GX()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class XX extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Obe extends XX{}async function Tbe(e,t,r){Gg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Gg.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Gg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Gg.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Gg.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Obe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Gg.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Dbe(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function YX(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Mbe(e){return parseInt(e,16)}function Rbe(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function Lbe(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:o=new Date,nonce:i,notBefore:l,requestId:c,resources:d,scheme:u,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=YX(e.address),v=u?`${u}://${n}`:n,g=e.statement?`${e.statement}
`:"",y=`${v} wants you to sign in with your Ethereum account:
${m}

${g}`;let x=`URI: ${f}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${o.toISOString()}`;if(s&&(x+=`
Expiration Time: ${s.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),d){let b=`
Resources:`;for(const w of d){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);b+=`
- ${w}`}x+=b}return`${y}
${x}`}class Io extends Error{constructor({message:t,code:r,cause:n,name:s}){var o;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(o=s??(n instanceof Error?n.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class Y_ extends Io{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function Fbe({error:e,options:t}){var r,n,s;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Io({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Io({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Io({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Io({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Io({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Io({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Io({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Io({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(QX(i)){if(o.rp.id!==i)return new Io({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Io({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new Io({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Io({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Io({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function $be({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Io({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Io({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(QX(n)){if(r.rpId!==n)return new Io({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Io({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Io({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Io({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}var JX=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class Bbe{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const qbe=new Bbe;function zbe(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=JX(e,["challenge","user","excludeCredentials"]),o=Qv(t).buffer,i=Object.assign(Object.assign({},r),{id:Qv(r.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:o,user:i});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Qv(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function Ube(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=JX(e,["challenge","allowCredentials"]),s=Qv(t).buffer,o=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];o.allowCredentials[i]=Object.assign(Object.assign({},l),{id:Qv(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function Vbe(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Sp(new Uint8Array(e.response.attestationObject)),clientDataJSON:Sp(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Wbe(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Sp(new Uint8Array(s.authenticatorData)),clientDataJSON:Sp(new Uint8Array(s.clientDataJSON)),signature:Sp(new Uint8Array(s.signature)),userHandle:s.userHandle?Sp(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function QX(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function E6(){var e,t;return!!(pc()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Hbe(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Y_("Browser returned unexpected credential type",t)}:{data:null,error:new Y_("Empty credential response",t)}}catch(t){return{data:null,error:Fbe({error:t,options:e})}}}async function Gbe(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Y_("Browser returned unexpected credential type",t)}:{data:null,error:new Y_("Empty credential response",t)}}catch(t){return{data:null,error:$be({error:t,options:e})}}}const Kbe={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Xbe={userVerification:"preferred",hints:["security-key"]};function J_(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const o in s){const i=s[o];if(i!==void 0)if(Array.isArray(i))n[o]=i;else if(r(i))n[o]=i;else if(t(i)){const l=n[o];t(l)?n[o]=J_(l,i):n[o]=J_(i)}else n[o]=i}return n}function Ybe(e,t){return J_(Kbe,e,t||{})}function Jbe(e,t){return J_(Xbe,e,t||{})}class Qbe{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},o){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:l};const c=s??qbe.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=Ybe(i.webauthn.credential_options.publicKey,o?.create),{data:u,error:f}=await Hbe({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const d=Jbe(i.webauthn.credential_options.publicKey,o?.request),{data:u,error:f}=await Gbe(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(i){return Zn(i)?{data:null,error:i}:{data:null,error:new xp("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}},o){if(!r)return{data:null,error:new Yb("rpId is required for WebAuthn authentication")};try{if(!E6())return{data:null,error:new xp("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:o});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(i){return Zn(i)?{data:null,error:i}:{data:null,error:new xp("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s},o){if(!r)return{data:null,error:new Yb("rpId is required for WebAuthn registration")};try{if(!E6())return{data:null,error:new xp("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:o});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return Zn(i)?{data:null,error:i}:{data:null,error:new xp("Unexpected error in register",i)}}}}Dbe();const Zbe={url:Kye,storageKey:Xye,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Yye,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function k6(e,t,r){return await r()}const Kg={};class Jb{get jwks(){var t,r;return(r=(t=Kg[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Kg[this.storageKey]=Object.assign(Object.assign({},Kg[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Kg[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Kg[this.storageKey]=Object.assign(Object.assign({},Kg[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Jb.nextInstanceID,Jb.nextInstanceID+=1,this.instanceID>0&&pc()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Zbe),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Ibe({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=KX(s.fetch),this.lock=s.lock||k6,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:pc()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=Tbe:this.lock=k6,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Qbe(this)},this.persistSession?(s.storage?this.storage=s.storage:GX()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=P6(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=P6(this.memoryStorage)),pc()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${VX}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=dbe(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),pc()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:o}=await this._getSessionFromURL(r,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),rbe(o)){const c=(t=o.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Zn(r)?{error:r}:{error:new xp("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const o=await wa(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ud}),{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(o){if(Zn(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(t){var r,n,s;try{let o;if("email"in t){const{email:u,password:f,options:h}=t;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Wg(this.storage,this.storageKey)),o=await wa(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:u,password:f,data:(r=h?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:m,code_challenge_method:v},xform:Ud})}else if("phone"in t){const{phone:u,password:f,options:h}=t;o=await wa(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h?.data)!==null&&n!==void 0?n:{},channel:(s=h?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Ud})}else throw new B2("You must provide either an email or phone number and a password");const{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(o){if(Zn(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(t){try{let r;if("email"in t){const{email:o,password:i,options:l}=t;r=await wa(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:C6})}else if("phone"in t){const{phone:o,password:i,options:l}=t;r=await wa(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:C6})}else throw new B2("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Vg}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Zn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,o,i,l,c,d,u,f,h;let m,v;if("message"in t)m=t.message,v=t.signature;else{const{chain:g,wallet:y,statement:x,options:b}=t;let w;if(pc())if(typeof y=="object")w=y;else{const A=window;if("ethereum"in A&&typeof A.ethereum=="object"&&"request"in A.ethereum&&typeof A.ethereum.request=="function")w=A.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const j=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href),_=await w.request({method:"eth_requestAccounts"}).then(A=>A).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=YX(_[0]);let P=(n=b?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!P){const A=await w.request({method:"eth_chainId"});P=Mbe(A)}const E={domain:j.host,address:C,statement:x,uri:j.href,version:"1",chainId:P,nonce:(s=b?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(i=(o=b?.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=b?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=b?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=b?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=b?.signInWithEthereum)===null||u===void 0?void 0:u.resources};m=Lbe(E),v=await w.request({method:"personal_sign",params:[Rbe(m),C]})}try{const{data:g,error:y}=await wa(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:v},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Ud});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Vg}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(Zn(g))return{data:{user:null,session:null},error:g};throw g}}async signInWithSolana(t){var r,n,s,o,i,l,c,d,u,f,h,m;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:y,wallet:x,statement:b,options:w}=t;let j;if(pc())if(typeof x=="object")j=x;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))j=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=x}const _=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const C=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),b?{statement:b}:null));let P;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")P=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)P=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)v=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),g=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${_.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(s=(n=w?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=w?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((i=w?.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(u=w?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const C=await j.signMessage(new TextEncoder().encode(v),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=C}}try{const{data:y,error:x}=await wa(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Sp(g)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Ud});if(x)throw x;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Vg}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:x})}catch(y){if(Zn(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(t){const r=await Qh(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:o,error:i}=await wa(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ud});if(await vm(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Vg}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:i})}catch(o){if(Zn(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:o,nonce:i}=t,l=await wa(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Ud}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Vg}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Zn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,o,i;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Wg(this.storage,this.storageKey));const{error:f}=await wa(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await wa(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(i=c?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:u}}throw new B2("You must provide either an email or phone number.")}catch(l){if(Zn(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let s,o;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:l}=await wa(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:Ud});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(s){if(Zn(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let o=null,i=null;return this.flowType==="pkce"&&([o,i]=await Wg(this.storage,this.storageKey)),await wa(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:Abe})}catch(o){if(Zn(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Cm;const{error:s}=await wa(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Zn(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:o}=t,{error:i}=await wa(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:s,options:o}=t,{data:i,error:l}=await wa(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:l}}throw new B2("You must provide either an email or phone number and a type")}catch(r){if(Zn(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Qh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<xP:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await Qh(this.userStorage,this.storageKey+"-user");i?.user?t.user=i.user:t.user=wP()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!i&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{data:s,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await wa(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Mm}):await this._useSession(async r=>{var n,s,o;const{data:i,error:l}=r;if(l)throw l;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Cm}:await wa(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:Mm})})}catch(r){if(Zn(r))return tbe(r)&&(await this._removeSession(),await vm(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:o}=n;if(o)throw o;if(!s.session)throw new Cm;const i=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Wg(this.storage,this.storageKey));const{data:d,error:u}=await wa(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Mm});if(u)throw u;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Zn(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Cm;const r=Date.now()/1e3;let n=r,s=!0,o=null;const{payload:i}=bP(t.access_token);if(i.exp&&(n=i.exp,s=n<=r),s){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;o={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(Zn(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:l}=r;if(l)throw l;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Cm;const{data:s,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Zn(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!pc())throw new q2("No browser detected.");if(t.error||t.error_description||t.error_code)throw new q2(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new y6("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new q2("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new y6("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:o,refresh_token:i,expires_in:l,expires_at:c,token_type:d}=t;if(!o||!l||!i||!d)throw new q2("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let h=u+f;c&&(h=parseInt(c));const m=h-u;m*1e3<=hv&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const v=h-f;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,u);const{data:g,error:y}=await this._getUser(o);if(y)throw y;const x={provider_token:n,provider_refresh_token:s,access_token:o,expires_in:f,expires_at:h,refresh_token:i,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Zn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Qh(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:o}=r;if(o)return{error:o};const i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:l}=await this.admin.signOut(i,t);if(l&&!(ebe(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await vm(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=cbe(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:o},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Wg(this.storage,this.storageKey,!0));try{return await wa(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(Zn(o))return{data:null,error:o};throw o}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async o=>{var i,l,c,d,u;const{data:f,error:h}=o;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await wa(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return pc()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(Zn(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:o}}=r;if(s)throw s;const{options:i,provider:l,token:c,access_token:d,nonce:u}=t,f=await wa(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=o?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:Ud}),{data:h,error:m}=f;return m?{data:{user:null,session:null},error:m}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new Vg}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),{data:h,error:m})}catch(s){if(Zn(s))return{data:{user:null,session:null},error:s};throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:o,error:i}=r;if(i)throw i;return await wa(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await mbe(async s=>(s>0&&await fbe(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await wa(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ud})),(s,o)=>{const i=200*Math.pow(2,s);return o&&yP(o)&&Date.now()+i-n<hv})}catch(n){if(this._debug(r,"error",n),Zn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),pc()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Qh(this.storage,this.storageKey);if(s&&this.userStorage){let i=await Qh(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await pv(this.userStorage,this.storageKey+"-user",i)),s.user=(t=i?.user)!==null&&t!==void 0?t:wP()}else if(s&&!s.user&&!s.user){const i=await Qh(this.storage,this.storageKey+"-user");i&&i?.user?(s.user=i.user,await vm(this.storage,this.storageKey+"-user"),await pv(this.storage,this.storageKey,s)):s.user=wP()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const o=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<xP;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${xP}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),yP(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(s.access_token);!l&&i?.user?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Cm;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new CC;const{data:o,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!o.session)throw new Cm;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(s,"error",o),Zn(o)){const i={data:null,error:o};return yP(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){o.push(c)}});if(await Promise.all(i),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await pv(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const o=N6(s);await pv(this.storage,this.storageKey,o)}else{const s=N6(r);await pv(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await vm(this.storage,this.storageKey),await vm(this.storage,this.storageKey+"-code-verifier"),await vm(this.storage,this.storageKey+"-user"),this.userStorage&&await vm(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&pc()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),hv);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/hv);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${hv}ms, refresh threshold is ${EI} ticks`),s<=EI&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof XX)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pc()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,i]=await Wg(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(l.toString())}if(n?.queryParams){const o=new URLSearchParams(n.queryParams);s.push(o.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:o}=r;return o?{data:null,error:o}:await wa(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:o,error:i}=r;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await wa(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&c.type==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:o}=r;if(o)return{data:null,error:o};const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Vbe(t.webauthn.credential_response):Wbe(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await wa(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(r){if(Zn(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:o}=r;if(o)return{data:null,error:o};const i=await wa(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:zbe(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Ube(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Zn(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=r?.factors)!==null&&t!==void 0?t:[])s.all.push(o),o.status==="verified"&&s[o.factor_type].push(o);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:o}=t;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=bP(s.access_token);let l=null;i.aal&&(l=i.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=i.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+Qye>s)return n;const{data:o,error:i}=await wa(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,n=o.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:v}=await this.getSession();if(v||!m.session)return{data:null,error:v};n=m.session.access_token}const{header:s,payload:o,signature:i,raw:{header:l,payload:c}}=bP(n);r?.allowExpired||bbe(o.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:o,header:s,signature:i},error:null}}const u=wbe(s.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,i,ibe(`${l}.${c}`)))throw new OI("Invalid JWT signature");return{data:{claims:o,header:s,signature:i},error:null}}catch(n){if(Zn(n))return{data:null,error:n};throw n}}}Jb.nextInstanceID=0;const ewe=Jb;class twe extends ewe{constructor(t){super(t)}}var rwe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class nwe{constructor(t,r,n){var s,o,i;this.supabaseUrl=t,this.supabaseKey=r;const l=Gye(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:Lye,realtime:$ye,auth:Object.assign(Object.assign({},Fye),{storageKey:c}),global:Rye},u=Hye(n??{},d);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=u.global.headers)!==null&&o!==void 0?o:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=Uye(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Z0e(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Tye(this.storageUrl.href,this.headers,this.fetch,n?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new I0e(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return rwe(this,void 0,void 0,function*(){var t,r;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:o,storageKey:i,flowType:l,lock:c,debug:d},u,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new twe({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:o,flowType:l,lock:c,debug:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new gye(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ZX=(e,t,r)=>new nwe(e,t,r);function awe(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}awe()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const swe="https://dlfryxtyxqoacuunswuc.supabase.co",owe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY";function lD(){try{if(typeof window<"u"&&window.__SUPABASE_URL)return window.__SUPABASE_URL}catch{}return swe}function eY(){try{if(typeof window<"u"&&window.__SUPABASE_KEY)return window.__SUPABASE_KEY}catch{}return owe}function iwe(){try{return(new URL(lD()).host||"").split(".")[0]||""}catch{return""}}function lwe(){const e=iwe();return e?`sb-${e}-auth-token`:"sb-auth-token"}async function cwe(){try{const e=localStorage.getItem("custom-auth-token");if(e&&e.trim())return e.trim()}catch{}try{if(typeof ch<"u"&&ch?.auth?.getSession){const e=new Promise((s,o)=>setTimeout(()=>o(new Error("getSession timeout")),1e3)),t=ch.auth.getSession(),{data:r}=await Promise.race([t,e]),n=r?.session?.access_token;if(n)return console.debug("[Supabase Wrapper] Token obtido via getSession"),n}}catch(e){console.debug("[Supabase Wrapper] getSession falhou ou timeout:",e.message)}try{const e=lwe(),t=localStorage.getItem(e);if(t){const r=JSON.parse(t);if(r?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage"),r.access_token;if(r?.currentSession?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage (currentSession)"),r.currentSession.access_token}}catch(e){console.warn("[Supabase Wrapper] Erro ao ler localStorage:",e)}return console.warn("[Supabase Wrapper]  Nenhum token encontrado - usando anon key"),null}const dwe=e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([r,n])=>{n!=null&&(Array.isArray(n)?n.forEach(s=>t.append(r,String(s))):t.append(r,String(n)))}),t.toString()},tY=async(e,t={})=>{const{method:r="GET",body:n,headers:s={},params:o={},signal:i,timeoutMs:l=2e4}=t,c=dwe(o),u=`${lD()}/rest/v1/${e}${c?`?${c}`:""}`,h={apikey:eY(),"Content-Type":"application/json",Prefer:"return=representation",...s};try{const _=await cwe();_&&(h.Authorization=`Bearer ${_}`)}catch(_){console.warn("[Supabase Wrapper] Erro ao obter token de sesso:",_)}const m={method:r,headers:h};n&&(m.body=JSON.stringify(n)),i&&(m.signal=i);const v=new AbortController,g=setTimeout(()=>{console.warn(`[Supabase Wrapper]  Timeout (${l}ms) para ${e}`);try{v.abort("timeout")}catch{}},Math.max(5e3,l)),y=(()=>{if(!i)return v.signal;try{i.addEventListener("abort",()=>{try{v.abort("upstream-abort")}catch{}})}catch{}return v.signal})();m.signal=y;const x=Date.now();let b;try{b=await fetch(u,m)}finally{clearTimeout(g)}if(!b.ok){let _="";try{_=await b.text()}catch{}const C=Date.now()-x;let P=!1;try{const E=JSON.parse(_);P=b.status===401&&(E?.code==="PGRST303"||/jwt expired/i.test(E?.message||""))}catch{}if(P){try{window.dispatchEvent(new CustomEvent("auth:jwt-expired"))}catch{}try{localStorage.removeItem("custom-auth-token"),Object.keys(localStorage).filter(E=>E.startsWith("sb-")).forEach(E=>localStorage.removeItem(E)),Object.keys(sessionStorage).filter(E=>E.startsWith("sb-")).forEach(E=>sessionStorage.removeItem(E)),sessionStorage.setItem("auth:forceLogout","1"),window.location.replace("/")}catch{}}throw new Error(`[Supabase Wrapper] HTTP ${b.status} (${C}ms) - ${_||"unknown error"}`)}const w=Date.now()-x;let j;try{j=await b.json()}catch(_){throw console.error(`[Supabase Wrapper] Erro ao parsear JSON de ${e}:`,_),new Error(`[Supabase Wrapper] JSON parse error: ${_.message}`)}return w>3e3?console.warn(`[Supabase Wrapper]  fetch ${e} LENTO (${w}ms)`):console.debug(`[Supabase Wrapper] fetch ${e} OK (${w}ms)`),{data:j,error:null}};class uwe{constructor(t){this.table=t,this.params={},this.multiFilters={},this.selectColumns="*",this.signal=null}select(t="*"){return this.selectColumns=t,this.params.select=t,this}eq(t,r){return this._addFilter(t,`eq.${r}`),this}neq(t,r){return this.params[t]=`neq.${r}`,this}gt(t,r){return this.params[t]=`gt.${r}`,this}gte(t,r){return this._addFilter(t,`gte.${r}`),this}lt(t,r){return this.params[t]=`lt.${r}`,this}lte(t,r){return this._addFilter(t,`lte.${r}`),this}like(t,r){return this.params[t]=`like.${r}`,this}ilike(t,r){return this.params[t]=`ilike.${r}`,this}is(t,r){return this.params[t]=`is.${r}`,this}in(t,r){return this.params[t]=`in.(${r.join(",")})`,this}not(t,r,n){return this.params[t]=`not.${r}.${n}`,this}or(t){return this.params.or=`(${t})`,this}contains(t,r){return this.params[t]=`cs.{${r}}`,this}containedBy(t,r){return this.params[t]=`cd.{${r}}`,this}filter(t,r,n){return this._addFilter(t,`${r}.${n}`),this}order(t,r={}){const n=r.ascending===!1?"desc":"asc";return this.params.order=`${t}.${n}`,this}limit(t){return this.params.limit=t,this}range(t,r){return this.params.offset=t,this.params.limit=r-t+1,this}single(){return this.params.limit=1,this.isSingle=!0,this}maybeSingle(){return this.params.limit=1,this.isMaybeSingle=!0,this}abortSignal(t){return this.signal=t,this}_addFilter(t,r){this.multiFilters[t]||(this.multiFilters[t]=[]),this.multiFilters[t].push(r)}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([o,i])=>{i.length===1?n[o]=i[0]:i.length>1&&(n[o]=i)});const s=await tY(this.table,{method:"GET",params:n,signal:this.signal});this.isSingle&&s.data&&(s.data=s.data[0]||null),this.isMaybeSingle&&s.data&&(s.data=s.data[0]||null),t(s)}catch(n){r(n)}}}class fwe extends uwe{insert(t){return this.method="POST",this.body=Array.isArray(t)?t:[t],this}update(t){return this.method="PATCH",this.body=t,this}upsert(t,r={}){this.method="POST",this.body=Array.isArray(t)?t:[t];const n=r.ignoreDuplicates?"resolution=ignore-duplicates":"resolution=merge-duplicates",s=r.returning==="minimal"?"return=minimal":"return=representation";return this.headers={...this.headers||{},Prefer:`${n},${s}`},r.onConflict&&(this.params.on_conflict=r.onConflict),this}delete(){return this.method="DELETE",this}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([o,i])=>{i.length===1?n[o]=i[0]:i.length>1&&(n[o]=i)});const s=await tY(this.table,{method:this.method||"GET",body:this.body,params:n,signal:this.signal,headers:this.headers||{}});this.isSingle&&s.data&&(s.data=s.data[0]||null),this.isMaybeSingle&&s.data&&(s.data=s.data[0]||null),t(s)}catch(n){r(n)}}}const ch={from(e){return new fwe(e)},auth:null,supabaseUrl:lD(),supabaseKey:eY()};typeof window<"u"&&ch.from("empresas").select("id").limit(1).then(({data:e,error:t})=>{t&&console.error("[Supabase Wrapper]  ERRO:",t)}).catch(e=>{console.error("[Supabase Wrapper]  EXCEPTION:",e)});const I6="main";let Zv,Qy;try{const e=Object.assign({"./backendTargets.js":_0e,"./backendTargets.local.js":C0e}),t=e["./backendTargets.js"]||null,r=e["./backendTargets.local.js"]||null;t?.TARGETS&&(Qy=t.TARGETS),t?.ACTIVE_TARGET&&(Zv=t.ACTIVE_TARGET),r?.TARGETS&&(Qy=r.TARGETS),r?.ACTIVE_TARGET&&(Zv=r.ACTIVE_TARGET)}catch{}let hd=Qy&&Zv&&Qy[Zv]?Qy[Zv]:null,cD=Zv;!hd&&I6&&(cD=I6);let Ul=hd&&hd.supabaseUrl&&hd.supabaseUrl.trim()?hd.supabaseUrl:"",Vl=hd&&hd.supabaseAnonKey&&hd.supabaseAnonKey.trim()?hd.supabaseAnonKey:"";if(!Ul||!Vl){const e=(cD||"dev").toLowerCase(),t=e==="main"?{}.VITE_SUPABASE_URL_MAIN:{}.VITE_SUPABASE_URL_DEV,r=e==="main"?{}.VITE_SUPABASE_ANON_KEY_MAIN:{}.VITE_SUPABASE_ANON_KEY_DEV;Ul=Ul&&Ul.trim()?Ul:t,Vl=Vl&&Vl.trim()?Vl:r}(!Ul||!Vl)&&(Ul=Ul||"https://dlfryxtyxqoacuunswuc.supabase.co",Vl=Vl||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY");try{try{const e=cD||"dev";console.log(`[Target] Branch ativa: ${e}`);try{typeof window<"u"&&(window.__ACTIVE_TARGET=e)}catch{}const t=!!hd&&!!(hd.supabaseUrl||"").trim()&&!!(hd.supabaseAnonKey||"").trim(),r=!t&&(!!{}.VITE_SUPABASE_URL_DEV||!!{}.VITE_SUPABASE_URL_MAIN);console.info(`[Supabase] Backend target mode: ${t?"static config":r?"per-target env":"generic env"}`)}catch{}}catch{}if(!Ul||!Vl)throw console.error("[Supabase]  ERRO CRTICO: Variveis de ambiente ausentes!"),new Error("Supabase: Variveis de ambiente no configuradas!");const TI=Ul,DI=Vl,Vd=ZX(Ul,Vl,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:typeof window<"u"?window.localStorage:void 0},global:{headers:{"X-Client-Info":"fluxo7arena-web",apikey:Vl}}});try{typeof window<"u"&&ch&&(ch.auth=Vd.auth)}catch{}const he={from:e=>ch.from(e),auth:Vd.auth,storage:Vd.storage,functions:Vd.functions,rpc:(...e)=>Vd.rpc(...e),realtime:Vd.realtime,channel:(...e)=>Vd.channel(...e),removeChannel:(...e)=>Vd.removeChannel(...e),removeAllChannels:()=>Vd.removeAllChannels(),getChannels:()=>Vd.getChannels(),supabaseUrl:Ul,supabaseKey:Vl};if(typeof window<"u"){window.__supabase=he,window.__supabase_original=Vd,window.__supabase_wrapper=ch;try{window.__SUPABASE_URL=Ul}catch{}try{window.__SUPABASE_KEY=Vl}catch{}}try{if(typeof window<"u"){const e=()=>{try{const t=localStorage.getItem("custom-auth-token");if(t&&t.trim()){he.realtime.setAuth(t.trim());return}let r="";try{r=(new URL(Ul).host||"").split(".")[0]||""}catch{}const n=r?`sb-${r}-auth-token`:"sb-auth-token",s=localStorage.getItem(n);if(s){const o=JSON.parse(s),i=o?.access_token||o?.currentSession?.access_token;i&&he.realtime.setAuth(i)}}catch{}};e();try{window.addEventListener("storage",t=>{try{const r=t?.key||"";(r==="custom-auth-token"||r.startsWith("sb-"))&&e()}catch{}})}catch{}}}catch{}const rY=p.createContext({}),vs=()=>{const e=p.useContext(rY);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},mwe=({children:e})=>{const[t,r]=p.useState(null),[n,s]=p.useState(null),[o,i]=p.useState(null),[l,c]=p.useState(!0),[d,u]=p.useState(!1),f=p.useRef(null),h=p.useRef(!1),m=(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}})();p.useEffect(()=>{if((()=>{try{return sessionStorage.getItem("auth:forceLogout")==="1"}catch{return!1}})()){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),s(null),i(null),u(!0),c(!1);try{sessionStorage.removeItem("auth:forceLogout")}catch{}try{he.auth.signOut({scope:"global"}).catch(()=>{})}catch{}return}try{const E=localStorage.getItem("auth:userProfile"),A=localStorage.getItem("auth:company");E&&s(JSON.parse(E)),A&&i(JSON.parse(A)),(E||A)&&u(!0)}catch(E){console.warn("AuthContext: falha ao hidratar cache local:",E)}(async()=>{try{if(m)try{const F=localStorage.getItem("custom-auth-token");if(F&&F.trim()){const I=JSON.parse(atob(F.split(".")[1].replace(/-/g,"+").replace(/_/g,"/")))?.sub||null;if(I){r({id:I}),u(!0),await v(I),f.current=I,c(!1);return}}}catch{}const{data:{session:E},error:A}=await he.auth.getSession();A&&console.error("supabase.auth.getSession error:",A),E?.user?(r(E.user),u(!0),await v(E.user.id),f.current=E.user.id):u(!0)}catch(E){console.error("getSession exception:",E)}finally{c(!1)}})();const{data:C}=he.auth.onAuthStateChange(async(E,A)=>{console.log("[AuthContext] onAuthStateChange",{event:E,userId:A?.user?.id||null});try{if(E==="SIGNED_OUT"){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),s(null),i(null),f.current=null,h.current=!1,c(!1),u(!0);return}if(m){u(!0),c(!1);return}const F=A?.user||null;r(F),u(!0),F?.id&&(await v(F.id),f.current=F.id,c(!1))}catch(F){console.error("onAuthStateChange handler error:",F),c(!1),u(!0)}}),P=setTimeout(()=>{c(E=>E&&!1),u(E=>E||!0)},12e3);return()=>{clearTimeout(P),C.subscription.unsubscribe()}},[]),p.useEffect(()=>{(async()=>{try{if(!d||!t)return;const _=!n,C=!!n&&!o&&!!n.codigo_empresa;(_||C)&&(await v(t.id),f.current=t.id)}catch{}})()},[d,t?.id,!!n,n?.codigo_empresa,!!o]),p.useEffect(()=>{const j=()=>{try{const P=localStorage.getItem("auth:userProfile"),E=localStorage.getItem("auth:company");if(P){const A=JSON.parse(P);(!n||!n.codigo_empresa)&&s(A)}if(E){const A=JSON.parse(E);(!o||!o.codigo_empresa)&&i(A)}}catch{}},_=()=>{j(),t?.id&&v(t.id).catch(()=>{})},C=()=>{document.visibilityState==="visible"&&_()};return window.addEventListener("focus",_),document.addEventListener("visibilitychange",C),()=>{window.removeEventListener("focus",_),document.removeEventListener("visibilitychange",C)}},[t?.id]);const v=async j=>{if(h.current){console.log("[AuthDebug] loadUserProfile:skip (already running)");return}h.current=!0;try{const _=[300,800,1600,3e3],C=A=>new Promise(F=>setTimeout(F,A)),P=async(A,F)=>{let D;try{const I=new Promise(M=>{D=setTimeout(()=>M({__timeout:!0}),F)});return await Promise.race([A,I])}finally{clearTimeout(D)}},E=1200;for(let A=0;A<=_.length;A++){console.log("[AuthDebug] loadUserProfile:start",{userId:j,attempt:A});try{console.log("[AuthDebug] querying colaboradores",{userId:j});const F=he.from("colaboradores").select("*").eq("id",j).single(),D=await P(F,E);if(D&&D.__timeout){console.warn("[AuthDebug] colaboradores:timeout, using usuarios fallback (inline)");try{console.log("[AuthDebug] fallback-inline: querying usuarios by id");const{data:M,error:U}=await he.from("usuarios").select("*").eq("id",j).maybeSingle();if(!U&&M){let z=null;if(M.codigo_empresa){console.log("[AuthDebug] fallback-inline: querying empresas by codigo",{codigo_empresa:M.codigo_empresa});const{data:$,error:ee}=await he.from("empresas").select("*").eq("codigo_empresa",M.codigo_empresa).single();ee?console.warn("[AuthDebug] fallback-inline: empresa error",{status:ee.status,code:ee.code,message:ee.message}):(z=$,console.log("[AuthDebug] fallback-inline: empresa loaded"))}const W={id:j,nome:M.nome||null,cargo:M.papel||"user",codigo_empresa:M.codigo_empresa||null,_source:"usuarios"};s(W);try{localStorage.setItem("auth:userProfile",JSON.stringify(W))}catch{}if(z){i(z);try{localStorage.setItem("auth:company",JSON.stringify(z))}catch{}console.log("[AuthDebug] fallback-inline: set company from usuarios path")}else console.warn("[AuthDebug] fallback-inline: no company resolved; preserving previous company");return}U&&console.warn("[AuthDebug] fallback-inline: usuarios error",{status:U.status,code:U.code,message:U.message})}catch(M){console.warn("[AuthDebug] fallback-inline: unexpected error",M?.message||M)}if(A<_.length){await C(_[A]);continue}return}const{data:I,error:R}=D||{};if(console.log("[AuthDebug] colaboradores:success",{hasProfile:!!I,codigo_empresa:I?.codigo_empresa||null}),R){if(console.warn("[AuthDebug] colaboradores:error",{code:R.code,status:R.status,message:R.message}),R.code==="42P17"){if(A<_.length){await C(_[A]);continue}console.warn("RLS recursion (42P17) persistente ao carregar perfil. Prosseguindo sem alterar cache.");return}if([401,403].includes(Number(R.status))&&(console.warn("[AuthDebug] Erro de autorizao detectado, tentando fallback"),A<_.length)){await C(_[A]);continue}if(R.code==="PGRST116"){try{console.log("[AuthDebug] fallback: querying usuarios by id");const{data:U,error:z}=await he.from("usuarios").select("*").eq("id",j).maybeSingle();if(!z&&U){let W=null;if(U.codigo_empresa){console.log("[AuthDebug] fallback: querying empresas by codigo",{codigo_empresa:U.codigo_empresa});const{data:ee,error:ve}=await he.from("empresas").select("*").eq("codigo_empresa",U.codigo_empresa).single();ve?console.warn("[AuthDebug] fallback: empresa error",{status:ve.status,code:ve.code,message:ve.message}):(W=ee,console.log("[AuthDebug] fallback: empresa loaded"))}const $={id:j,nome:U.nome||null,cargo:U.papel||"user",codigo_empresa:U.codigo_empresa||null,_source:"usuarios"};s($);try{localStorage.setItem("auth:userProfile",JSON.stringify($))}catch{}if(W){i(W);try{localStorage.setItem("auth:company",JSON.stringify(W))}catch{}console.log("[AuthDebug] fallback: set company from usuarios path")}else console.warn("[AuthDebug] fallback: no company resolved; preserving previous company");return}z&&console.warn("[AuthDebug] fallback: usuarios error",{status:z.status,code:z.code,message:z.message})}catch{}console.warn("AuthContext: perfil no encontrado (PGRST116) e fallback falhou; mantendo cache atual.");return}if([401,403,406].includes(Number(R.status))&&A<_.length){await C(_[A]);continue}throw R}if(!I){if(A<_.length){await C(_[A]);continue}return}s(I);try{localStorage.setItem("auth:userProfile",JSON.stringify(I))}catch{}if(I?.codigo_empresa){console.log("[AuthDebug] company: querying empresas by codigo from colaboradores",{codigo_empresa:I.codigo_empresa});const{data:M,error:U}=await he.from("empresas").select("*").eq("codigo_empresa",I.codigo_empresa).single();if(U){if([401,403,406].includes(Number(U.status))&&A<_.length){await C(_[A]);continue}console.warn("[AuthDebug] company: load error; preserving previous company",{status:U.status,code:U.code,message:U.message});return}else{i(M);try{localStorage.setItem("auth:company",JSON.stringify(M))}catch{}console.log("[AuthDebug] company: set from colaboradores path")}}else console.warn("[AuthDebug] company: no codigo_empresa available on profile; preserving previous company");return}catch(F){if(console.error("[AuthDebug] loadUserProfile:unexpected error",{message:F?.message,code:F?.code,status:F?.status}),A<_.length){await C(_[A]);continue}console.error("Error loading user profile:",F);return}}}finally{h.current=!1}},w={user:t,userProfile:n,company:o,loading:l,authReady:d,signUp:async(j,_,C,P=null)=>{try{const{data:E,error:A}=await he.auth.signUp({email:j,password:_});if(A)throw A;if(E?.user&&P){const{data:F,error:D}=await he.from("empresas").select("id, codigo_empresa").eq("codigo_empresa",P).single();if(D)throw new Error("Cdigo de empresa invlido. Verifique o cdigo informado.");const{error:I}=await he.from("colaboradores").insert({id:E.user.id,codigo_empresa:F.codigo_empresa,nome:C,cargo:"user",ativo:!0});if(I)throw I}return{data:E,error:null}}catch(E){let A="No foi possvel cadastrar. Verifique os dados e tente novamente.";const F=(E?.message||"").toLowerCase();return F.includes("user already registered")||F.includes("already registered")||F.includes("user already exists")?A="Email j cadastrado. Tente entrar ou redefinir a senha.":F.includes("password")&&F.includes("length")&&(A="Senha muito curta. Use ao menos 6 caracteres."),{data:null,error:new Error(A)}}},signIn:async(j,_)=>{try{if(m){const E=TI,A=DI,F=await fetch(`${E}/rest/v1/rpc/auth_login_dev`,{method:"POST",headers:{"Content-Type":"application/json",apikey:A,Authorization:`Bearer ${A}`},body:JSON.stringify({p_email:j,p_password:_})});if(!F.ok){const M=await F.text().catch(()=>"");let U="No foi possvel entrar. Tente novamente.";return F.status===401&&(U="Email ou senha invlidos."),F.status===423&&(U="Usurio bloqueado temporariamente."),{data:null,error:new Error(U+(M?` (${M})`:""))}}const I=(await F.json())?.access_token||"",R=(()=>{try{return JSON.parse(atob(I.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"))).sub}catch{return null}})();try{localStorage.setItem("custom-auth-token",I)}catch{}return R&&(r({id:R}),u(!0),await v(R),f.current=R),{data:{user:R?{id:R}:null},error:null}}const{data:C,error:P}=await he.auth.signInWithPassword({email:j,password:_});if(P){let E="No foi possvel entrar. Tente novamente.";const A=(P.message||"").toLowerCase(),F=P.status;return A.includes("invalid login")||A.includes("invalid credentials")||F===400?E="Email ou senha invlidos.":A.includes("email not confirmed")||A.includes("not confirmed")?E="Email no confirmado. Verifique sua caixa de entrada.":F===429?E="Muitas tentativas. Aguarde alguns minutos e tente novamente.":F>=500&&(E="Servio indisponvel no momento. Tente novamente mais tarde."),{data:null,error:new Error(E)}}return C.user&&await he.from("colaboradores").select("id").eq("id",C.user.id).single(),{data:C,error:null}}catch(C){return{data:null,error:C}}},signOut:async()=>{try{localStorage.removeItem("custom-auth-token")}catch{}try{const j=he.auth.signOut({scope:"global"}),_=new Promise(C=>setTimeout(C,700));await Promise.race([j,_])}catch(j){console.warn("[AuthContext] signOut(): error during signOut",j?.message||j)}f.current=null,r(null),s(null),i(null),c(!1),u(!0);try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company"),localStorage.removeItem("clientes:list"),localStorage.removeItem("quadras:list"),localStorage.removeItem("agenda:courts"),localStorage.removeItem("agenda:selectedCourts"),localStorage.removeItem("agenda:viewFilter"),Object.keys(localStorage).filter(j=>j.startsWith("agenda:bookings:")).forEach(j=>localStorage.removeItem(j)),Object.keys(localStorage).filter(j=>j.startsWith("sb-")).forEach(j=>localStorage.removeItem(j)),Object.keys(sessionStorage).filter(j=>j.startsWith("sb-")).forEach(j=>sessionStorage.removeItem(j))}catch{}try{sessionStorage.setItem("auth:forceLogout","1")}catch{}try{window.location.replace("/")}catch{}return{error:null}},reloadCompany:async()=>{try{const j=n&&n.codigo_empresa?n.codigo_empresa:null;if(!j)return;const{data:_,error:C}=await he.from("empresas").select("*").eq("codigo_empresa",j).single();if(!C&&_){i(_);try{localStorage.setItem("auth:company",JSON.stringify(_))}catch{}}}catch{}}};return a.jsx(rY.Provider,{value:w,children:e})};function Fa(e){"@babel/helpers - typeof";return Fa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fa(e)}function vo(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Hn(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function ma(e){Hn(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||Fa(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function La(e,t){Hn(2,arguments);var r=ma(e),n=vo(t);return isNaN(n)?new Date(NaN):(n&&r.setDate(r.getDate()+n),r)}function uu(e,t){Hn(2,arguments);var r=ma(e),n=vo(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var s=r.getDate(),o=new Date(r.getTime());o.setMonth(r.getMonth()+n+1,0);var i=o.getDate();return s>=i?o:(r.setFullYear(o.getFullYear(),o.getMonth(),s),r)}function nY(e,t){Hn(2,arguments);var r=ma(e).getTime(),n=vo(t);return new Date(r+n)}var hwe={};function $h(){return hwe}function Cd(e,t){var r,n,s,o,i,l,c,d;Hn(1,arguments);var u=$h(),f=vo((r=(n=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=ma(e),m=h.getDay(),v=(m<f?7:0)+m-f;return h.setDate(h.getDate()-v),h.setHours(0,0,0,0),h}function sg(e){return Hn(1,arguments),Cd(e,{weekStartsOn:1})}function pwe(e){Hn(1,arguments);var t=ma(e),r=t.getFullYear(),n=new Date(0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);var s=sg(n),o=new Date(0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);var i=sg(o);return t.getTime()>=s.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function gwe(e){Hn(1,arguments);var t=pwe(e),r=new Date(0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);var n=sg(r);return n}function Qb(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function Es(e){Hn(1,arguments);var t=ma(e);return t.setHours(0,0,0,0),t}var vwe=864e5;function Ru(e,t){Hn(2,arguments);var r=Es(e),n=Es(t),s=r.getTime()-Qb(r),o=n.getTime()-Qb(n);return Math.round((s-o)/vwe)}var xwe=6e4;function ywe(e,t){Hn(2,arguments);var r=vo(t);return nY(e,r*xwe)}function MI(e,t){Hn(2,arguments);var r=vo(t),n=r*7;return La(e,n)}function bwe(e,t){Hn(2,arguments);var r=vo(t);return uu(e,r*12)}function wwe(e){Hn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Fa(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var s=ma(n);(r===void 0||r<s||isNaN(Number(s)))&&(r=s)}),r||new Date(NaN)}function jwe(e){Hn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Fa(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var s=ma(n);(r===void 0||r>s||isNaN(s.getDate()))&&(r=s)}),r||new Date(NaN)}var aY=6e4,sY=36e5;function Zi(e,t){Hn(2,arguments);var r=Es(e),n=Es(t);return r.getTime()===n.getTime()}function dD(e){return Hn(1,arguments),e instanceof Date||Fa(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function _we(e){if(Hn(1,arguments),!dD(e)&&typeof e!="number")return!1;var t=ma(e);return!isNaN(Number(t))}function Zb(e,t){Hn(2,arguments);var r=ma(e),n=ma(t),s=r.getFullYear()-n.getFullYear(),o=r.getMonth()-n.getMonth();return s*12+o}var Nwe=6048e5;function Swe(e,t,r){Hn(2,arguments);var n=Cd(e,r),s=Cd(t,r),o=n.getTime()-Qb(n),i=s.getTime()-Qb(s);return Math.round((o-i)/Nwe)}function O6(e,t){var r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function Cwe(e,t){Hn(2,arguments);var r=ma(e),n=ma(t),s=O6(r,n),o=Math.abs(Ru(r,n));r.setDate(r.getDate()-s*o);var i=+(O6(r,n)===-s),l=s*(o-i);return l===0?0:l}function Xj(e){Hn(1,arguments);var t=ma(e);return t.setHours(23,59,59,999),t}function AC(e){Hn(1,arguments);var t=ma(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Sl(e){Hn(1,arguments);var t=ma(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Awe(e){Hn(1,arguments);var t=ma(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function uD(e,t){var r,n,s,o,i,l,c,d;Hn(1,arguments);var u=$h(),f=vo((r=(n=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=ma(e),m=h.getDay(),v=(m<f?-7:0)+6-(m-f);return h.setDate(h.getDate()+v),h.setHours(23,59,59,999),h}function oY(e){return Hn(1,arguments),uD(e,{weekStartsOn:1})}function Pwe(e,t){Hn(2,arguments);var r=vo(t);return nY(e,-r)}var Ewe=864e5;function kwe(e){Hn(1,arguments);var t=ma(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),s=r-n;return Math.floor(s/Ewe)+1}function Q_(e){Hn(1,arguments);var t=1,r=ma(e),n=r.getUTCDay(),s=(n<t?7:0)+n-t;return r.setUTCDate(r.getUTCDate()-s),r.setUTCHours(0,0,0,0),r}function iY(e){Hn(1,arguments);var t=ma(e),r=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var s=Q_(n),o=new Date(0);o.setUTCFullYear(r,0,4),o.setUTCHours(0,0,0,0);var i=Q_(o);return t.getTime()>=s.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function Iwe(e){Hn(1,arguments);var t=iY(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var n=Q_(r);return n}var Owe=6048e5;function Twe(e){Hn(1,arguments);var t=ma(e),r=Q_(t).getTime()-Iwe(t).getTime();return Math.round(r/Owe)+1}function Z_(e,t){var r,n,s,o,i,l,c,d;Hn(1,arguments);var u=$h(),f=vo((r=(n=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=ma(e),m=h.getUTCDay(),v=(m<f?7:0)+m-f;return h.setUTCDate(h.getUTCDate()-v),h.setUTCHours(0,0,0,0),h}function lY(e,t){var r,n,s,o,i,l,c,d;Hn(1,arguments);var u=ma(e),f=u.getUTCFullYear(),h=$h(),m=vo((r=(n=(s=(o=t?.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&s!==void 0?s:h.firstWeekContainsDate)!==null&&n!==void 0?n:(c=h.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setUTCFullYear(f+1,0,m),v.setUTCHours(0,0,0,0);var g=Z_(v,t),y=new Date(0);y.setUTCFullYear(f,0,m),y.setUTCHours(0,0,0,0);var x=Z_(y,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=x.getTime()?f:f-1}function Dwe(e,t){var r,n,s,o,i,l,c,d;Hn(1,arguments);var u=$h(),f=vo((r=(n=(s=(o=t?.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&s!==void 0?s:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),h=lY(e,t),m=new Date(0);m.setUTCFullYear(h,0,f),m.setUTCHours(0,0,0,0);var v=Z_(m,t);return v}var Mwe=6048e5;function Rwe(e,t){Hn(1,arguments);var r=ma(e),n=Z_(r,t).getTime()-Dwe(r,t).getTime();return Math.round(n/Mwe)+1}function cs(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var Lwe={y:function(t,r){var n=t.getUTCFullYear(),s=n>0?n:1-n;return cs(r==="yy"?s%100:s,r.length)},M:function(t,r){var n=t.getUTCMonth();return r==="M"?String(n+1):cs(n+1,2)},d:function(t,r){return cs(t.getUTCDate(),r.length)},a:function(t,r){var n=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(t,r){return cs(t.getUTCHours()%12||12,r.length)},H:function(t,r){return cs(t.getUTCHours(),r.length)},m:function(t,r){return cs(t.getUTCMinutes(),r.length)},s:function(t,r){return cs(t.getUTCSeconds(),r.length)},S:function(t,r){var n=r.length,s=t.getUTCMilliseconds(),o=Math.floor(s*Math.pow(10,n-3));return cs(o,r.length)}};const xm=Lwe;var Xg={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Fwe={G:function(t,r,n){var s=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){var s=t.getUTCFullYear(),o=s>0?s:1-s;return n.ordinalNumber(o,{unit:"year"})}return xm.y(t,r)},Y:function(t,r,n,s){var o=lY(t,s),i=o>0?o:1-o;if(r==="YY"){var l=i%100;return cs(l,2)}return r==="Yo"?n.ordinalNumber(i,{unit:"year"}):cs(i,r.length)},R:function(t,r){var n=iY(t);return cs(n,r.length)},u:function(t,r){var n=t.getUTCFullYear();return cs(n,r.length)},Q:function(t,r,n){var s=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(s);case"QQ":return cs(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,r,n){var s=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(s);case"qq":return cs(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,r,n){var s=t.getUTCMonth();switch(r){case"M":case"MM":return xm.M(t,r);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,r,n){var s=t.getUTCMonth();switch(r){case"L":return String(s+1);case"LL":return cs(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,r,n,s){var o=Rwe(t,s);return r==="wo"?n.ordinalNumber(o,{unit:"week"}):cs(o,r.length)},I:function(t,r,n){var s=Twe(t);return r==="Io"?n.ordinalNumber(s,{unit:"week"}):cs(s,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):xm.d(t,r)},D:function(t,r,n){var s=kwe(t);return r==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):cs(s,r.length)},E:function(t,r,n){var s=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,r,n,s){var o=t.getUTCDay(),i=(o-s.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return cs(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});case"eeee":default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(t,r,n,s){var o=t.getUTCDay(),i=(o-s.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return cs(i,r.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});case"cccc":default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(t,r,n){var s=t.getUTCDay(),o=s===0?7:s;switch(r){case"i":return String(o);case"ii":return cs(o,r.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,r,n){var s=t.getUTCHours(),o=s/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,r,n){var s=t.getUTCHours(),o;switch(s===12?o=Xg.noon:s===0?o=Xg.midnight:o=s/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,r,n){var s=t.getUTCHours(),o;switch(s>=17?o=Xg.evening:s>=12?o=Xg.afternoon:s>=4?o=Xg.morning:o=Xg.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){var s=t.getUTCHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return xm.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):xm.H(t,r)},K:function(t,r,n){var s=t.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(s,{unit:"hour"}):cs(s,r.length)},k:function(t,r,n){var s=t.getUTCHours();return s===0&&(s=24),r==="ko"?n.ordinalNumber(s,{unit:"hour"}):cs(s,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):xm.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):xm.s(t,r)},S:function(t,r){return xm.S(t,r)},X:function(t,r,n,s){var o=s._originalDate||t,i=o.getTimezoneOffset();if(i===0)return"Z";switch(r){case"X":return D6(i);case"XXXX":case"XX":return dp(i);case"XXXXX":case"XXX":default:return dp(i,":")}},x:function(t,r,n,s){var o=s._originalDate||t,i=o.getTimezoneOffset();switch(r){case"x":return D6(i);case"xxxx":case"xx":return dp(i);case"xxxxx":case"xxx":default:return dp(i,":")}},O:function(t,r,n,s){var o=s._originalDate||t,i=o.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+T6(i,":");case"OOOO":default:return"GMT"+dp(i,":")}},z:function(t,r,n,s){var o=s._originalDate||t,i=o.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+T6(i,":");case"zzzz":default:return"GMT"+dp(i,":")}},t:function(t,r,n,s){var o=s._originalDate||t,i=Math.floor(o.getTime()/1e3);return cs(i,r.length)},T:function(t,r,n,s){var o=s._originalDate||t,i=o.getTime();return cs(i,r.length)}};function T6(e,t){var r=e>0?"-":"+",n=Math.abs(e),s=Math.floor(n/60),o=n%60;if(o===0)return r+String(s);var i=t||"";return r+String(s)+i+cs(o,2)}function D6(e,t){if(e%60===0){var r=e>0?"-":"+";return r+cs(Math.abs(e)/60,2)}return dp(e,t)}function dp(e,t){var r=t||"",n=e>0?"-":"+",s=Math.abs(e),o=cs(Math.floor(s/60),2),i=cs(s%60,2);return n+o+r+i}const $we=Fwe;var M6=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},cY=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},Bwe=function(t,r){var n=t.match(/(P+)(p+)?/)||[],s=n[1],o=n[2];if(!o)return M6(t,r);var i;switch(s){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",M6(s,r)).replace("{{time}}",cY(o,r))},qwe={p:cY,P:Bwe};const zwe=qwe;var Uwe=["D","DD"],Vwe=["YY","YYYY"];function Wwe(e){return Uwe.indexOf(e)!==-1}function Hwe(e){return Vwe.indexOf(e)!==-1}function R6(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Gwe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Kwe=function(t,r,n){var s,o=Gwe[t];return typeof o=="string"?s=o:r===1?s=o.one:s=o.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};const Xwe=Kwe;function ex(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var Ywe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Jwe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Qwe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Zwe={date:ex({formats:Ywe,defaultWidth:"full"}),time:ex({formats:Jwe,defaultWidth:"full"}),dateTime:ex({formats:Qwe,defaultWidth:"full"})};const e1e=Zwe;var t1e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},r1e=function(t,r,n,s){return t1e[t]};const n1e=r1e;function Iu(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",s;if(n==="formatting"&&e.formattingValues){var o=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):o;s=e.formattingValues[i]||e.formattingValues[o]}else{var l=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[c]||e.values[l]}var d=e.argumentCallback?e.argumentCallback(t):t;return s[d]}}var a1e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},s1e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},o1e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},i1e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},l1e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},c1e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},d1e=function(t,r){var n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},u1e={ordinalNumber:d1e,era:Iu({values:a1e,defaultWidth:"wide"}),quarter:Iu({values:s1e,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Iu({values:o1e,defaultWidth:"wide"}),day:Iu({values:i1e,defaultWidth:"wide"}),dayPeriod:Iu({values:l1e,defaultWidth:"wide",formattingValues:c1e,defaultFormattingWidth:"wide"})};const f1e=u1e;function Ou(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],o=t.match(s);if(!o)return null;var i=o[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?h1e(l,function(f){return f.test(i)}):m1e(l,function(f){return f.test(i)}),d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;var u=t.slice(i.length);return{value:d,rest:u}}}function m1e(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function h1e(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function dY(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var s=n[0],o=t.match(e.parsePattern);if(!o)return null;var i=e.valueCallback?e.valueCallback(o[0]):o[0];i=r.valueCallback?r.valueCallback(i):i;var l=t.slice(s.length);return{value:i,rest:l}}}var p1e=/^(\d+)(th|st|nd|rd)?/i,g1e=/\d+/i,v1e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},x1e={any:[/^b/i,/^(a|c)/i]},y1e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},b1e={any:[/1/i,/2/i,/3/i,/4/i]},w1e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},j1e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_1e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},N1e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},S1e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},C1e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},A1e={ordinalNumber:dY({matchPattern:p1e,parsePattern:g1e,valueCallback:function(t){return parseInt(t,10)}}),era:Ou({matchPatterns:v1e,defaultMatchWidth:"wide",parsePatterns:x1e,defaultParseWidth:"any"}),quarter:Ou({matchPatterns:y1e,defaultMatchWidth:"wide",parsePatterns:b1e,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Ou({matchPatterns:w1e,defaultMatchWidth:"wide",parsePatterns:j1e,defaultParseWidth:"any"}),day:Ou({matchPatterns:_1e,defaultMatchWidth:"wide",parsePatterns:N1e,defaultParseWidth:"any"}),dayPeriod:Ou({matchPatterns:S1e,defaultMatchWidth:"any",parsePatterns:C1e,defaultParseWidth:"any"})};const P1e=A1e;var E1e={code:"en-US",formatDistance:Xwe,formatLong:e1e,formatRelative:n1e,localize:f1e,match:P1e,options:{weekStartsOn:0,firstWeekContainsDate:1}};const uY=E1e;var k1e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,I1e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,O1e=/^'([^]*?)'?$/,T1e=/''/g,D1e=/[a-zA-Z]/;function ur(e,t,r){var n,s,o,i,l,c,d,u,f,h,m,v,g,y,x,b,w,j;Hn(2,arguments);var _=String(t),C=$h(),P=(n=(s=r?.locale)!==null&&s!==void 0?s:C.locale)!==null&&n!==void 0?n:uY,E=vo((o=(i=(l=(c=r?.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&l!==void 0?l:C.firstWeekContainsDate)!==null&&i!==void 0?i:(f=C.locale)===null||f===void 0||(h=f.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(E>=1&&E<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var A=vo((m=(v=(g=(y=r?.weekStartsOn)!==null&&y!==void 0?y:r==null||(x=r.locale)===null||x===void 0||(b=x.options)===null||b===void 0?void 0:b.weekStartsOn)!==null&&g!==void 0?g:C.weekStartsOn)!==null&&v!==void 0?v:(w=C.locale)===null||w===void 0||(j=w.options)===null||j===void 0?void 0:j.weekStartsOn)!==null&&m!==void 0?m:0);if(!(A>=0&&A<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!P.localize)throw new RangeError("locale must contain localize property");if(!P.formatLong)throw new RangeError("locale must contain formatLong property");var F=ma(e);if(!_we(F))throw new RangeError("Invalid time value");var D=Qb(F),I=Pwe(F,D),R={firstWeekContainsDate:E,weekStartsOn:A,locale:P,_originalDate:F},M=_.match(I1e).map(function(U){var z=U[0];if(z==="p"||z==="P"){var W=zwe[z];return W(U,P.formatLong)}return U}).join("").match(k1e).map(function(U){if(U==="''")return"'";var z=U[0];if(z==="'")return M1e(U);var W=$we[z];if(W)return!(r!=null&&r.useAdditionalWeekYearTokens)&&Hwe(U)&&R6(U,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&Wwe(U)&&R6(U,t,String(e)),W(I,U,P.localize,R);if(z.match(D1e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+z+"`");return U}).join("");return M}function M1e(e){var t=e.match(O1e);return t?t[1].replace(T1e,"'"):e}function R1e(e){Hn(1,arguments);var t=ma(e),r=t.getFullYear(),n=t.getMonth(),s=new Date(0);return s.setFullYear(r,n+1,0),s.setHours(0,0,0,0),s.getDate()}function ju(e){Hn(1,arguments);var t=ma(e),r=t.getHours();return r}var L1e=6048e5;function F1e(e){Hn(1,arguments);var t=ma(e),r=sg(t).getTime()-gwe(t).getTime();return Math.round(r/L1e)+1}function _u(e){Hn(1,arguments);var t=ma(e),r=t.getMinutes();return r}function $1e(e){Hn(1,arguments);var t=ma(e),r=t.getTime();return r}function B1e(e){return Hn(1,arguments),Math.floor($1e(e)/1e3)}function q1e(e,t){var r,n,s,o,i,l,c,d;Hn(1,arguments);var u=ma(e),f=u.getFullYear(),h=$h(),m=vo((r=(n=(s=(o=t?.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&s!==void 0?s:h.firstWeekContainsDate)!==null&&n!==void 0?n:(c=h.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setFullYear(f+1,0,m),v.setHours(0,0,0,0);var g=Cd(v,t),y=new Date(0);y.setFullYear(f,0,m),y.setHours(0,0,0,0);var x=Cd(y,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=x.getTime()?f:f-1}function z1e(e,t){var r,n,s,o,i,l,c,d;Hn(1,arguments);var u=$h(),f=vo((r=(n=(s=(o=t?.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&s!==void 0?s:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),h=q1e(e,t),m=new Date(0);m.setFullYear(h,0,f),m.setHours(0,0,0,0);var v=Cd(m,t);return v}var U1e=6048e5;function V1e(e,t){Hn(1,arguments);var r=ma(e),n=Cd(r,t).getTime()-z1e(r,t).getTime();return Math.round(n/U1e)+1}function W1e(e){Hn(1,arguments);var t=ma(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function H1e(e,t){return Hn(1,arguments),Swe(W1e(e),Sl(e),t)+1}function RI(e,t){Hn(2,arguments);var r=ma(e),n=ma(t);return r.getTime()>n.getTime()}function fY(e,t){Hn(2,arguments);var r=ma(e),n=ma(t);return r.getTime()<n.getTime()}function L6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function G1e(e,t){if(e){if(typeof e=="string")return L6(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L6(e,t):void 0}}function LI(e,t){return LI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},LI(e,t)}function K1e(e,t){if(Fa(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fa(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X1e(e){var t=K1e(e,"string");return Fa(t)=="symbol"?t:t+""}function Y1e(e,t,r){return(t=X1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fD(e,t){Hn(2,arguments);var r=ma(e),n=ma(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function J1e(e,t){Hn(2,arguments);var r=ma(e),n=ma(t);return r.getFullYear()===n.getFullYear()}function Zy(e,t){Hn(2,arguments);var r=vo(t);return La(e,-r)}function F6(e,t){var r;Hn(1,arguments);var n=vo((r=t?.additionalDigits)!==null&&r!==void 0?r:2);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var s=t2e(e),o;if(s.date){var i=r2e(s.date,n);o=n2e(i.restDateString,i.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);var l=o.getTime(),c=0,d;if(s.time&&(c=a2e(s.time),isNaN(c)))return new Date(NaN);if(s.timezone){if(d=s2e(s.timezone),isNaN(d))return new Date(NaN)}else{var u=new Date(l+c),f=new Date(0);return f.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),f.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),f}return new Date(l+c+d)}var z2={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Q1e=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Z1e=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,e2e=/^([+-])(\d{2})(?::?(\d{2}))?$/;function t2e(e){var t={},r=e.split(z2.dateTimeDelimiter),n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],z2.timeZoneDelimiter.test(t.date)&&(t.date=e.split(z2.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){var s=z2.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function r2e(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};var s=n[1]?parseInt(n[1]):null,o=n[2]?parseInt(n[2]):null;return{year:o===null?s:o*100,restDateString:e.slice((n[1]||n[2]).length)}}function n2e(e,t){if(t===null)return new Date(NaN);var r=e.match(Q1e);if(!r)return new Date(NaN);var n=!!r[4],s=ny(r[1]),o=ny(r[2])-1,i=ny(r[3]),l=ny(r[4]),c=ny(r[5])-1;if(n)return d2e(t,l,c)?o2e(t,l,c):new Date(NaN);var d=new Date(0);return!l2e(t,o,i)||!c2e(t,s)?new Date(NaN):(d.setUTCFullYear(t,o,Math.max(s,i)),d)}function ny(e){return e?parseInt(e):1}function a2e(e){var t=e.match(Z1e);if(!t)return NaN;var r=_P(t[1]),n=_P(t[2]),s=_P(t[3]);return u2e(r,n,s)?r*sY+n*aY+s*1e3:NaN}function _P(e){return e&&parseFloat(e.replace(",","."))||0}function s2e(e){if(e==="Z")return 0;var t=e.match(e2e);if(!t)return 0;var r=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return f2e(n,s)?r*(n*sY+s*aY):NaN}function o2e(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var s=n.getUTCDay()||7,o=(t-1)*7+r+1-s;return n.setUTCDate(n.getUTCDate()+o),n}var i2e=[31,null,31,30,31,30,31,31,30,31,30,31];function mY(e){return e%400===0||e%4===0&&e%100!==0}function l2e(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(i2e[t]||(mY(e)?29:28))}function c2e(e,t){return t>=1&&t<=(mY(e)?366:365)}function d2e(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function u2e(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function f2e(e,t){return t>=0&&t<=59}function NP(e,t){Hn(2,arguments);var r=ma(e),n=vo(t),s=r.getFullYear(),o=r.getDate(),i=new Date(0);i.setFullYear(s,n,15),i.setHours(0,0,0,0);var l=R1e(i);return r.setMonth(n,Math.min(o,l)),r}function U2(e,t){Hn(2,arguments);var r=ma(e),n=vo(t);return r.setHours(n),r}function V2(e,t){Hn(2,arguments);var r=ma(e),n=vo(t);return r.setMinutes(n),r}function $6(e,t){Hn(2,arguments);var r=ma(e),n=vo(t);return isNaN(r.getTime())?new Date(NaN):(r.setFullYear(n),r)}const hY=p.createContext(),m2e=({children:e})=>{const{userProfile:t}=vs(),r=Lo(),[n,s]=p.useState([]),[o,i]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(!1),f=p.useRef(r.pathname),h=p.useRef(!1),m=p.useRef(null),[v,g]=p.useState(null),y=p.useRef([]),x=p.useRef(null);p.useEffect(()=>{y.current=n},[n]);const b=p.useCallback(()=>document.querySelectorAll('[role="dialog"]').length>0,[]),w=p.useCallback(async()=>{if(t?.codigo_empresa)try{u(!0);const _=t.codigo_empresa,C=new Date,P=Es(C).toISOString(),E=Xj(C).toISOString(),A=[],{data:F}=await he.from("produtos").select("nome, estoque, estoque_minimo, status").eq("codigo_empresa",_).not("estoque_minimo","is",null),D=(F||[]).filter(Y=>{const J=Number(Y.estoque||0),fe=Number(Y.estoque_minimo||0);return J<=fe&&fe>0});D.length>0&&A.push({tipo:"estoque",icone:"Package",cor:"danger",mensagem:`${D.length} produto${D.length>1?"s":""} com estoque baixo`,link:"/produtos"});const{data:I}=await he.from("agendamento_participantes").select("id, agendamento_id").eq("codigo_empresa",_).eq("status_pagamento","Pendente");if(I&&I.length>0){const Y=[...new Set(I.map(ce=>ce.agendamento_id))],{data:J}=await he.from("agendamentos").select("id, inicio, status").in("id",Y).not("status","in","(canceled,absent)").order("inicio",{ascending:!0}),fe=new Set((J||[]).map(ce=>ce.id)),Z=I.filter(ce=>fe.has(ce.agendamento_id));if(Z.length>0){const ce=J?.[0],le=ur(ce?new Date(ce.inicio):C,"yyyy-MM-dd");A.push({tipo:"pagamento",icone:"DollarSign",cor:"warning",mensagem:`${Z.length} pagamento${Z.length>1?"s":""} pendente${Z.length>1?"s":""} em agendamentos`,link:`/agenda?date=${le}`})}}const R=new Date;R.setHours(R.getHours()-3);const{data:M}=await he.from("comandas").select("id, aberto_em, status").eq("codigo_empresa",_).eq("status","open").is("fechado_em",null).lte("aberto_em",R.toISOString());M&&M.length>0&&A.push({tipo:"comanda",icone:"Clock",cor:"warning",mensagem:`${M.length} comanda${M.length>1?"s":""} aberta${M.length>1?"s":""} h mais de 3 horas`,link:"/vendas"});const U=new Date;U.setHours(U.getHours()-12);const{data:z}=await he.from("caixa_sessoes").select("id, aberto_em").eq("codigo_empresa",_).eq("status","open").lte("aberto_em",U.toISOString()).limit(1);z&&z.length>0&&A.push({tipo:"caixa",icone:"ShoppingCart",cor:"danger",mensagem:"Caixa aberto h mais de 12 horas",link:"/vendas"});const{data:W}=await he.from("mesas").select("id, nome, numero").eq("codigo_empresa",_).eq("status","awaiting-payment");if(W&&W.length>0){const Y=W.map(fe=>fe.id),{data:J}=await he.from("comandas").select("id, mesa_id").eq("codigo_empresa",_).in("mesa_id",Y).eq("status","open");if(J&&J.length>0){const fe=J.map(ie=>ie.id),{data:Z}=await he.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",fe),ce={};(Z||[]).forEach(ie=>{const te=(Number(ie.quantidade)||0)*(Number(ie.preco_unitario)||0),ue=Number(ie.desconto)||0,Te=te-ue;ce[ie.comanda_id]=(ce[ie.comanda_id]||0)+Te});const le=Object.values(ce).filter(ie=>ie>100).length;le>0&&A.push({tipo:"mesa",icone:"Store",cor:"info",mensagem:`${le} mesa${le>1?"s":""} com saldo alto aguardando pagamento`,link:"/vendas"})}}const{data:$}=await he.from("clientes").select("id, nome, aniversario").eq("codigo_empresa",_).eq("status","Ativo").not("aniversario","is",null),ee=ur(C,"MM-dd"),ve=($||[]).filter(Y=>Y.aniversario?ur(new Date(Y.aniversario),"MM-dd")===ee:!1);ve.length>0&&A.push({tipo:"aniversario",icone:"Users",cor:"success",mensagem:` ${ve.length} aniversariante${ve.length>1?"s":""} hoje!`,link:"/clientes"});const _e=[];for(let Y=1;Y<=7;Y++){const J=new Date(C);J.setDate(J.getDate()+Y),_e.push(ur(J,"MM-dd"))}const K=($||[]).filter(Y=>{if(!Y.aniversario)return!1;const J=ur(new Date(Y.aniversario),"MM-dd");return _e.includes(J)});K.length>0&&A.push({tipo:"aniversario-semana",icone:"CalendarPlus",cor:"purple",mensagem:` ${K.length} aniversariante${K.length>1?"s":""} esta semana`,link:"/clientes"});const q=(y.current||[]).filter(Y=>Y&&Y.tipo==="isis-event");s([...q,...A]);try{if(!h.current&&A.length>0&&typeof document<"u"&&document.visibilityState==="visible"&&!b()){const J=(()=>{try{return typeof window<"u"&&window.innerWidth<768}catch{return!1}})(),fe=(()=>{try{return!!document.querySelector('button[aria-label="Fechar menu lateral"]')}catch{return!1}})();if(J&&fe){try{x.current&&clearInterval(x.current)}catch{}x.current=setInterval(()=>{try{if(h.current){clearInterval(x.current),x.current=null;return}if(!!!document.querySelector('button[aria-label="Fechar menu lateral"]')&&!b()){c(!0),h.current=!0;try{m.current&&clearTimeout(m.current)}catch{}m.current=setTimeout(()=>{c(!1)},5e3),clearInterval(x.current),x.current=null}}catch{}},250)}else setTimeout(()=>{if(!h.current){if(b()){h.current=!0;return}c(!0),h.current=!0;try{m.current&&clearTimeout(m.current)}catch{}m.current=setTimeout(()=>{c(!1)},5e3)}},350)}}catch{}}catch(_){console.error("[AlertsContext] Erro ao carregar alertas:",_)}finally{u(!1)}},[t?.codigo_empresa]);p.useEffect(()=>{if(o){h.current=!0;try{x.current&&(clearInterval(x.current),x.current=null)}catch{}}},[o]),p.useEffect(()=>()=>{try{m.current&&clearTimeout(m.current)}catch{}try{x.current&&clearInterval(x.current)}catch{}},[]);const j=p.useCallback(()=>{try{m.current&&clearTimeout(m.current)}catch{}c(!1),g(null)},[]);return p.useEffect(()=>{if(!t?.codigo_empresa)return;const _=t.codigo_empresa,C=he.channel(`isis-events:${_}`).on("postgres_changes",{event:"*",schema:"public",table:"agendamentos",filter:`codigo_empresa=eq.${_}`},P=>{try{const{eventType:E,new:A,old:F}=P||{};if(!(A||F)||!(A?.created_by_isis===!0||F?.created_by_isis===!0)||b())return;const R=A?.inicio||F?.inicio;let M="";try{if(R){const z=new Date(R);M=`/agenda?date=${`${z.getFullYear()}-${String(z.getMonth()+1).padStart(2,"0")}-${String(z.getDate()).padStart(2,"0")}`}`}}catch{}let U="";if(E==="INSERT")U="sis criou um agendamento";else if(E==="UPDATE"&&F?.status!=="canceled"&&A?.status==="canceled")U="sis cancelou um agendamento";else if(E==="DELETE")U="sis cancelou um agendamento";else return;g({message:U,link:M}),c(!0);try{m.current&&clearTimeout(m.current)}catch{}m.current=setTimeout(()=>{j()},5e3);try{s(z=>[{tipo:"isis-event",icone:E==="INSERT"?"CalendarPlus":"AlertTriangle",cor:E==="INSERT"?"info":"warning",mensagem:U,link:"/isis/analytics"},...Array.isArray(z)?z:[]])}catch{}}catch(E){console.warn("[AlertsContext] erro ao processar evento isis:",E)}}).subscribe();return()=>{try{he.removeChannel(C)}catch{}}},[t?.codigo_empresa,b,j]),p.useEffect(()=>{if(t?.codigo_empresa){w();const _=setInterval(()=>{w()},5*60*1e3);return()=>clearInterval(_)}},[t?.codigo_empresa,w]),p.useEffect(()=>{if(!t?.codigo_empresa)return;const _=()=>{if(document.visibilityState==="visible"){if(b())return;w()}},C=()=>{b()||w()};return document.addEventListener("visibilitychange",_),window.addEventListener("focus",C),()=>{document.removeEventListener("visibilitychange",_),window.removeEventListener("focus",C)}},[t?.codigo_empresa,w,b]),p.useEffect(()=>{if(t?.codigo_empresa){if(f.current===r.pathname)return;if(f.current=r.pathname,b()){console.log("[AlertsContext] Mudana de rota detectada, mas h modais abertos - ignorando recarga");return}console.log("[AlertsContext] Mudana de rota detectada - recarregando alertas"),w()}},[r.pathname,t?.codigo_empresa,w,b]),a.jsx(hY.Provider,{value:{alerts:n,setAlerts:s,showModal:o,setShowModal:i,showBalloon:l,setShowBalloon:c,eventBalloon:v,setEventBalloon:g,closeBalloon:j,loading:d,loadAlerts:w},children:e})},PC=()=>{const e=p.useContext(hY);if(!e)throw new Error("useAlerts must be used within AlertsProvider");return e};function h2e({onToggleSidebar:e,sidebarVisible:t,sidebarPinned:r}){const{toast:n}=as(),{signOut:s,userProfile:o,company:i,user:l}=vs(),{alerts:c,setAlerts:d,showModal:u,setShowModal:f,showBalloon:h,setShowBalloon:m,eventBalloon:v,closeBalloon:g}=PC(),y=Ri(),x=o?.nome||"Usurio",b=Se.useMemo(()=>{const $=x.trim().split(/\s+/);return $.length>=2?`${$[0]} ${$[1]}`:x},[x]),w=o?.cargo||o?.papel||"";let j="";try{const $=localStorage.getItem("auth:company");if($){const ee=JSON.parse($);j=ee?.nome_fantasia||ee?.razao_social||ee?.nome||ee?.codigoEmpresa||"";var _=ee?.logo_url||""}}catch{}const C=i?.nome_fantasia||i?.razao_social||i?.nome||i?.codigoEmpresa||j||"Empresa no vinculada",P=i?.logo_url||(typeof _<"u"?_:""),E=Se.useMemo(()=>i?.logo_url?`${i.logo_url}?v=${Date.now()}`:P||"",[i?.logo_url]),A=Se.useMemo(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}},[]),F=$=>({Package:Sd,DollarSign:Ko,CalendarCheck:tC,Clock:yd,ShoppingCart:i1,Store:f4,Users:yl,CalendarPlus:d4,AlertTriangle:zf,Info:$H})[$]||zf,D=$=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[$]||"text-warning",I=({alert:$,onClick:ee})=>{const ve=F($.icone),_e=D($.cor);return a.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:ee,children:[a.jsx(ve,{className:`w-4 h-4 flex-shrink-0 ${_e}`}),a.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:$.mensagem}),$.link&&a.jsx(i4,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})},R=async()=>{console.log("[Header] Logout button clicked",{at:new Date().toISOString(),userBefore:!!l});const{error:$}=await s();console.log("[Header] Logout completed",{error:$,userAfter:!!l}),n($?{title:"Erro ao sair",description:"Ocorreu um erro ao fazer logout. Tente novamente.",variant:"destructive"}:{title:"Logout realizado",description:"Voc foi desconectado com sucesso.",variant:"default"})};new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"});const M=Lo(),U=Se.useMemo(()=>{try{const $=String(M?.pathname||"");if($==="/"||$.startsWith("/dashboard"))return"";const ve=[{key:"/agenda",label:"Agenda"},{key:"/isis",label:"sis"},{key:"/clientes",label:"Clientes & Fornecedores"},{key:"/produtos",label:"Produtos"},{key:"/vendas",label:"Vendas"},{key:"/financeiro",label:"Financeiro"},{key:"/balcao",label:"Balco"},{key:"/cadastros",label:"Cadastros"},{key:"/quadras",label:"Quadras"},{key:"/equipe",label:"Equipe"},{key:"/finalizadoras",label:"Finalizadoras"},{key:"/empresas",label:"Empresas"},{key:"/configuracoes",label:"Configuraes"},{key:"/login",label:"Login"}].find(_e=>$.startsWith(_e.key));if(ve)return ve.label;if(typeof document<"u"){const _e=String(document.title||"");return(_e.includes(" - ")?_e.split(" - ")[0]:_e)||""}}catch{}return""},[M?.pathname]),z=Se.useMemo(()=>String(M?.pathname||"").startsWith("/isis"),[M?.pathname]),W=Se.useMemo(()=>{const $=i?.nome_fantasia||i?.nome||i?.razao_social||i?.codigoEmpresa||j||"";return String($).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"").trim()},[i?.nome_fantasia,i?.nome,i?.razao_social,i?.codigoEmpresa,j]);return Se.useMemo(()=>W?`https://${W}.f7arena.com`:"",[W]),a.jsxs(jr.header,{animate:{opacity:1,y:0},transition:{duration:.6,ease:[.22,1,.36,1]},className:"relative bg-surface/80 backdrop-blur-sm text-text-primary h-14 md:h-[72px] flex-shrink-0 flex items-center justify-between px-3 md:px-8 border-b border-border shadow-[0_1px_0_RGBA(255,255,255,0.04)]",children:[a.jsxs("div",{className:"flex items-center gap-2 md:gap-4 min-w-0 flex-1",children:[a.jsx(me,{variant:"ghost",size:"icon",onClick:e,"aria-label":t?"Ocultar barra lateral":"Mostrar barra lateral",className:"h-10 w-10 md:h-12 md:w-12 hover:bg-surface-2/60 transition-colors",children:a.jsx(Mue,{className:`w-6 h-6 md:w-7 md:h-7 transition-colors ${t?"text-brand":"text-text-primary"}`})}),a.jsxs("div",{className:"group mx-auto md:mx-0 pl-2 pr-3 md:pl-3 md:pr-5 py-1 md:py-1.5 border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary flex items-center gap-2 md:gap-4 shadow-sm hover:border-white/20 transition-colors overflow-hidden max-w-[60vw] md:max-w-[30vw] lg:max-w-[24vw]",title:C,children:[a.jsx("div",{className:"relative w-9 h-9 md:w-11 md:h-11 shrink-0 overflow-hidden border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)]",children:E?a.jsx("img",{src:E,alt:"Logo",className:"w-full h-full object-cover"}):a.jsx(gue,{className:"w-6 h-6 opacity-80"})}),a.jsx("span",{className:"tracking-tight truncate text-base leading-8 md:text-base md:leading-[44px] text-text-primary font-semibold flex-1 min-w-0 text-center md:text-left",children:C}),A&&a.jsx("span",{className:"ml-2 hidden md:inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-extrabold uppercase tracking-wider bg-red-600 text-white shadow animate-pulse",children:"Dev"})]})]}),z?a.jsx("div",{className:"pointer-events-none absolute z-10 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)] w-8 h-8",children:a.jsx("div",{className:"rounded-full overflow-hidden bg-background w-full h-full",children:a.jsx(tl,{size:"xs",className:"w-8 h-8"})})}),a.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:"sis"})]})}):U?a.jsx("div",{className:"pointer-events-none absolute z-10 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:a.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:U})}):null,a.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[!z&&a.jsxs(me,{variant:"ghost",onClick:()=>y("/isis"),className:"hidden md:inline-flex items-center gap-2 px-2.5 py-1.5 rounded-full border border-white/10 bg-surface/60 hover:bg-surface-2/70 hover:border-white/20 transition-all duration-200 hover:-translate-y-px hover:shadow-[0_4px_16px_rgba(0,0,0,0.25)]",children:[a.jsx("span",{className:"inline-flex items-center justify-center rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400",children:a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(tl,{size:"xs"})})}),a.jsx("span",{className:"text-sm font-semibold text-text-primary",children:"sis"})]}),a.jsxs(ci,{open:u?!1:h,onOpenChange:m,children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"ghost",size:"icon",onClick:()=>{m(!1),f(!0)},className:"relative text-text-secondary hover:text-text-primary transition-colors duration-200",children:[a.jsx(Vy,{className:"h-5 w-5"}),c.length>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-danger text-white text-[10px] font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:c.length})]})}),a.jsxs(Jo,{align:"end",sideOffset:8,className:"w-80 p-0 overflow-hidden bg-background border-white/10",children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Vy,{className:"h-4 w-4 text-brand"}),a.jsx("span",{className:"text-sm font-semibold",children:v?"Notificao":"Alertas"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[!v&&a.jsx(me,{size:"sm",variant:"ghost",onClick:()=>{m(!1),f(!0)},children:"Ver todos"}),a.jsx(me,{size:"icon",variant:"ghost",onClick:()=>{v?g():m(!1)},"aria-label":"Fechar",children:a.jsx(el,{className:"h-4 w-4"})})]})]}),a.jsx("div",{className:"p-2",children:v?a.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-surface-2",children:[a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(tl,{size:"xs"})}),a.jsx("span",{className:"text-sm text-text-secondary flex-1",children:v.message}),a.jsx(me,{size:"sm",variant:"ghost",className:"shrink-0",onClick:()=>{y("/isis/analytics");try{d($=>Array.isArray($)?$.filter(ee=>ee?.tipo!=="isis-event"):[])}catch{}g()},children:"Ver"})]}):c.length===0?a.jsx("p",{className:"text-sm text-text-muted text-center py-6",children:"Nenhum alerta no momento"}):a.jsx("ul",{className:"space-y-1 text-sm",children:c.slice(0,3).map(($,ee)=>a.jsx(I,{alert:$,onClick:()=>{if($.link&&y($.link),$?.tipo==="isis-event")try{d(ve=>Array.isArray(ve)?ve.filter(_e=>_e?.tipo!=="isis-event"):[])}catch{}m(!1)}},ee))})})]})]}),a.jsx(me,{variant:"ghost",size:"icon",onClick:R,className:"text-text-secondary hover:text-brand hover:bg-brand/10 transition-colors duration-200 shrink-0",children:a.jsx(Due,{className:"h-5 w-5"})}),a.jsx("div",{className:"hidden md:block w-px h-8 bg-border mx-1 md:mx-2"}),a.jsxs("div",{className:"hidden md:flex group pl-2 pr-3 md:pl-4 md:pr-4 py-1.5 rounded-full border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary items-center gap-2 md:gap-3 shadow-sm hover:border-white/20 transition-colors",title:`${b}  ${w}`,children:[a.jsx("span",{className:"text-xs md:text-sm font-semibold truncate max-w-[120px] md:max-w-[180px]",children:b}),a.jsx("span",{className:"text-[10px] md:text-[11px] px-1.5 md:px-2 py-0.5 rounded-full bg-brand/15 text-brand font-medium tracking-wide",children:w})]})]}),a.jsx(xn,{open:u,onOpenChange:f,children:a.jsxs(vn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[a.jsx(pn,{children:a.jsxs(un,{className:"flex items-center gap-2",children:[a.jsx(Vy,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",c.length,")"]})}),a.jsx("div",{className:"mt-4",children:c.length===0?a.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):a.jsx("ul",{className:"space-y-2 text-sm",children:c.map(($,ee)=>a.jsx(I,{alert:$,onClick:()=>{if($.link&&(y($.link),f(!1)),$?.tipo==="isis-event")try{d(ve=>Array.isArray(ve)?ve.filter(_e=>_e?.tipo!=="isis-event"):[])}catch{}}},ee))})})]})})]})}const Ye=Se.forwardRef(({className:e,type:t,...r},n)=>a.jsx("input",{type:t,className:gr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));Ye.displayName="Input";var p2e="Label",pY=p.forwardRef((e,t)=>a.jsx(sa.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));pY.displayName=p2e;var gY=pY;const g2e=R4("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Le=Se.forwardRef(({className:e,...t},r)=>a.jsx(gY,{ref:r,className:gr(g2e(),e),...t}));Le.displayName=gY.displayName;const v2e=e=>{const t={"Invalid login credentials":"Email ou senha incorretos","Email not confirmed":"Email no confirmado","User not found":"Usurio no encontrado","Invalid email":"Email invlido","Password should be at least 6 characters":"A senha deve ter pelo menos 6 caracteres","Unable to validate email address: invalid format":"Formato de email invlido","Email rate limit exceeded":"Muitas tentativas. Aguarde alguns minutos","Network request failed":"Erro de conexo. Verifique sua internet","Failed to fetch":"Erro de conexo. Verifique sua internet"};if(t[e])return t[e];for(const[r,n]of Object.entries(t))if(e.includes(r))return n;return"Erro ao fazer login. Verifique suas credenciais e tente novamente."},x2e=()=>{const[e,t]=p.useState(!1),[r,n]=p.useState(!1),[s,o]=p.useState(""),[i,l]=p.useState({email:"",password:""}),{signIn:c,user:d,authReady:u}=vs(),{toast:f}=as();p.useEffect(()=>{if(u&&d)try{const y=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const x=y||"/";console.log("[LoginPage] Redirecionando para:",x),window.location.replace(x)}catch{}},[u,!!d]);const h=y=>{l({...i,[y.target.name]:y.target.value}),s&&o("")},m=async y=>{y.preventDefault(),n(!0),o("");try{const x=await c(i.email,i.password);if(x.error)throw x.error;f({title:"Login realizado!",description:"Bem-vindo de volta!",variant:"default"});try{const b=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const w=b||"/";console.log("[LoginPage] Redirecionando aps login para:",w),window.location.replace(w)}catch{}}catch(x){const b=x.message||"Ocorreu um erro. Tente novamente.",w=v2e(b);o(w),f({title:"Erro",description:w,variant:"destructive"})}finally{n(!1)}},v={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}},g=(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}})();return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 sm:p-6 relative",children:[g&&a.jsx("div",{className:"pointer-events-none select-none absolute top-4 right-4 z-20",children:a.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-extrabold uppercase tracking-wider bg-red-600 text-white shadow animate-pulse",children:"Dev"})}),a.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.02] mix-blend-overlay"}),a.jsxs(jr.div,{variants:v,initial:"hidden",animate:"visible",className:"relative z-10 w-full max-w-md pb-20 sm:pb-0",children:[a.jsxs("div",{className:"fx-card",children:[a.jsx("div",{className:"text-center mb-6",children:a.jsxs("div",{className:"flex items-center justify-center mb-4",children:[a.jsx("div",{className:"w-16 h-16 bg-brand rounded-xl flex items-center justify-center mr-4",children:a.jsx(Sc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-5xl font-extrabold",children:[a.jsx("span",{style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{style:{color:"#FFAA33"},children:"7"})]}),a.jsx("p",{className:"text-2xl font-semibold",style:{color:"#B0B0B0"},children:"Arena"})]})]})}),a.jsxs("form",{onSubmit:m,className:"space-y-5 sm:space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Le,{htmlFor:"email",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[a.jsx(yx,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Email"]}),a.jsx(Ye,{id:"email",name:"email",type:"email",placeholder:"seu@email.com",value:i.email,onChange:h,required:!0,className:"placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Le,{htmlFor:"password",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[a.jsx(xx,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Senha"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ye,{id:"password",name:"password",type:e?"text":"password",placeholder:"Sua senha",value:i.password,onChange:h,required:!0,className:"pr-10 placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"}),a.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary transition-colors",children:e?a.jsx(Fp,{className:"w-5 h-5 sm:w-4 sm:h-4"}):a.jsx(rg,{className:"w-5 h-5 sm:w-4 sm:h-4"})})]})]}),s&&a.jsx(jr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 rounded-lg bg-destructive/10 border border-destructive/30 text-destructive text-sm",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:"flex-1",children:s})]})}),a.jsx(me,{type:"submit",className:"w-full h-12 sm:h-10 text-base sm:text-sm",disabled:r,children:r?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-primary-foreground border-t-transparent rounded-full animate-spin"}),"Entrando..."]}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Tue,{className:"w-4 h-4"}),"Entrar"]})})]})]}),a.jsx("p",{className:"mt-4 text-center text-xs text-text-muted opacity-70",children:" 2025 Fluxo7 Arena  Todos os direitos reservados."})]})]})})},B6=({children:e})=>{const{user:t,authReady:r}=vs(),n=Lo();return p.useEffect(()=>{if(r&&!t&&n.pathname!=="/login")try{sessionStorage.setItem("auth:returnUrl",n.pathname+n.search),console.log("[ProtectedRoute] Salvando rota de retorno:",n.pathname+n.search)}catch(s){console.warn("[ProtectedRoute] Erro ao salvar rota de retorno:",s)}},[r,t,n.pathname,n.search]),r?t?e:a.jsx(x2e,{}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-brand border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-text-primary font-medium",children:"Carregando..."})]})})},y2e=p.createContext(),b2e=({children:e})=>{const[t,r]=p.useState({payment:{open:!1,data:null},editParticipant:{open:!1,data:null}}),[n,s]=p.useState(new Set),o=p.useCallback((f,h=null)=>{console.log(" [MODALS] Abrindo modal:",f,h),r(m=>({...m,[f]:{open:!0,data:h}}))},[]),i=p.useCallback(f=>{if(n.has(f)){console.log(` [ModalsContext] Modal "${f}" est protegido, ignorando fechamento`);return}r(h=>({...h,[f]:{open:!1,data:{}}}))},[n]),l=p.useCallback(f=>t[f]?.open||!1,[t]),c=p.useCallback(f=>t[f]?.data||{},[t]),d=p.useCallback(f=>{console.log(` [ModalsContext] Protegendo modal "${f}"`),s(h=>new Set([...h,f]))},[]),u=p.useCallback(f=>{console.log(` [ModalsContext] Desprotegendo modal "${f}"`),s(h=>{const m=new Set(h);return m.delete(f),m})},[]);return a.jsx(y2e.Provider,{value:{openModal:o,closeModal:i,isModalOpen:l,getModalData:c,protectModal:d,unprotectModal:u},children:e})},vY=p.createContext(),eN=()=>{const e=p.useContext(vY);if(!e)throw new Error("useAgenda must be used within AgendaProvider");return e},w2e=({children:e})=>{const[t,r]=p.useState(!1),[n,s]=p.useState(!1),[o,i]=p.useState(!1),[l,c]=p.useState({participantId:null,participantName:""}),[d,u]=p.useState(null),[f,h]=p.useState([]),[m,v]=p.useState(""),[g,y]=p.useState([]),[x,b]=p.useState(null),[w,j]=p.useState([]),_=p.useRef({isProtected:!1,protectedUntil:0}),C=p.useRef(Date.now()),P=p.useRef(null),E=Lo(),A=p.useCallback((U=2e3)=>{const z=Date.now()+U;if(z>_.current.protectedUntil)_.current.isProtected=!0,_.current.protectedUntil=z;else return;setTimeout(()=>{Date.now()>=_.current.protectedUntil&&(_.current.isProtected=!1)},U)},[]),F=p.useCallback(()=>{r(!0)},[]),D=p.useCallback(()=>{const U=Date.now();if(_.current.isProtected&&U<_.current.protectedUntil){const W=_.current.protectedUntil-U;try{localStorage.getItem("debug:agenda")==="1"&&console.log(` [PaymentModal] Fechamento bloqueado por proteo (${W}ms restantes)`)}catch{}return!1}if(Date.now()-C.current<500){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechamento bloqueado por mudana de visibilidade recente")}catch{}return!1}try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechando modal (no protegido)")}catch{}return r(!1),!0},[]),I=p.useCallback((U,z)=>{c({participantId:U,participantName:z}),s(!0),A(3e3)},[A]),R=p.useCallback(()=>{s(!1),c({participantId:null,participantName:""})},[]);p.useEffect(()=>{if(!(E?.pathname||"").startsWith("/agenda"))return()=>{};const W=()=>{const ee=Date.now(),ve=document.hidden;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] visibilitychange:",{hidden:ve,timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(C.current=ee,!ve&&t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Aba restaurada com modal aberto - protegendo por 3s")}catch{}const _e=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=_e}},$=()=>{const ee=Date.now();try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] window focus:",{timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(C.current=ee,t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Janela ganhou foco com modal aberto - protegendo por 3s")}catch{}const ve=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=ve}};return document.addEventListener("visibilitychange",W),window.addEventListener("focus",$),()=>{document.removeEventListener("visibilitychange",W),window.removeEventListener("focus",$)}},[t,E?.pathname]);const M={isPaymentModalOpen:t,isEditParticipantModalOpen:n,isAddBookingModalOpen:o,openPaymentModal:F,closePaymentModal:D,openEditParticipantModal:I,closeEditParticipantModal:R,setIsAddBookingModalOpen:i,editParticipantData:l,editingBooking:d,setEditingBooking:u,participantsForm:f,setParticipantsForm:h,paymentTotal:m,setPaymentTotal:v,payMethods:g,setPayMethods:y,bookingForm:x,setBookingForm:b,localCustomers:w,setLocalCustomers:j,protectPaymentModal:A,onParticipantReplacedRef:P,get lastVisibilityChangeTime(){return C.current},get isModalProtected(){const U=Date.now();return _.current.isProtected&&U<_.current.protectedUntil}};return a.jsx(vY.Provider,{value:M,children:e})},j2e="https://guildthlqkfubbqoybys.supabase.co",_2e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1aWxkdGhscWtmdWJicW95YnlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3NTY2NjksImV4cCI6MjA4MTMzMjY2OX0.9--rqgkuDVLiwhU93RLV1YwEYVW6aRe9Qf5Mh80aVCg",xY=ZX(j2e,_2e,{auth:{persistSession:!1,storageKey:"isis-auth",storage:void 0,detectSessionInUrl:!1,autoRefreshToken:!1},global:{headers:{"X-Client-Info":"fluxo7-isis-web"}}}),yY=p.createContext(),EC=()=>{const e=p.useContext(yY);if(!e)throw new Error("useIsis deve ser usado dentro de IsisProvider");return e},bY=({children:e})=>{const[t,r]=p.useState("greeting"),[n,s]=p.useState([]),o=p.useRef((()=>{try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const te=[...Array(36)].map(()=>"x");return te[8]=te[13]=te[18]=te[23]="-",te[14]="4",te.map((ue,Te)=>{if(ue!=="x")return ue;const ne=Math.random()*16|0;return(Te===19?ne&3|8:ne).toString(16)}).join("")}catch{return"00000000-0000-4000-8000-000000000000"}})()),[i,l]=p.useState(o.current),[c,d]=p.useState({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),[u,f]=p.useState(!1),[h,m]=p.useState(!1),v=p.useRef(null),y=[["VITE_KEY_CHAT_ISIS",{}.VITE_KEY_CHAT_ISIS],["VITE-KEY-CHAT-ISIS",{VITE_JSONBIN_BIN_ID:"690605e5ae596e708f3c7bc5",VITE_JSONBIN_ISIS_BIN_ID:"6939b808ae596e708f90b843",VITE_JSONBIN_API_KEY:"$/XmOGvx8./SZzV3qMzQ5i.6FjBjS4toNbeaEFzX2D8QPUddyM6VR2",VITE_SUPABASE_URL:"https://dlfryxtyxqoacuunswuc.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY",VITE_SUPABASE_URL_ISIS:"https://guildthlqkfubbqoybys.supabase.co",VITE_SUPABASE_ANON_KEY_ISIS:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1aWxkdGhscWtmdWJicW95YnlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3NTY2NjksImV4cCI6MjA4MTMzMjY2OX0.9--rqgkuDVLiwhU93RLV1YwEYVW6aRe9Qf5Mh80aVCg",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}["VITE-KEY-CHAT-ISIS"]],["KEY_CHAT_ISIS",{}.KEY_CHAT_ISIS],["KEY-CHAT-ISIS",{VITE_JSONBIN_BIN_ID:"690605e5ae596e708f3c7bc5",VITE_JSONBIN_ISIS_BIN_ID:"6939b808ae596e708f90b843",VITE_JSONBIN_API_KEY:"$/XmOGvx8./SZzV3qMzQ5i.6FjBjS4toNbeaEFzX2D8QPUddyM6VR2",VITE_SUPABASE_URL:"https://dlfryxtyxqoacuunswuc.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY",VITE_SUPABASE_URL_ISIS:"https://guildthlqkfubbqoybys.supabase.co",VITE_SUPABASE_ANON_KEY_ISIS:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1aWxkdGhscWtmdWJicW95YnlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3NTY2NjksImV4cCI6MjA4MTMzMjY2OX0.9--rqgkuDVLiwhU93RLV1YwEYVW6aRe9Qf5Mh80aVCg",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}["KEY-CHAT-ISIS"]]].find(([te,ue])=>!!ue),x=y?.[1],b=y?.[0]||"none",w={}.VITE_JSONBIN_COLLECTION_ID||null,j="6939b808ae596e708f90b843",_="https://api.jsonbin.io/v3/b",C={}.VITE_ISIS_EDGE_SYNC==="1",[P,E]=p.useState(C?j:null);if(C&&typeof window<"u")try{console.info("[Isis][JSONBin] keySource=%s binId=%s",b,j||window.localStorage.getItem("ISIS_JSONBIN_BIN_ID")||"none")}catch{}const A=p.useCallback(async te=>{if(!C)return{ok:!1,data:null};if(!x){try{console.debug("[Isis][Edge] skipped (no JSONBIN key) mode=%s",te?.mode)}catch{}return{ok:!1,data:null}}try{const{data:ue,error:Te}=await he.functions.invoke("isis-chat",{body:te});if(Te){try{console.debug("[Isis][Edge] %s error=%o",te?.mode,Te)}catch{}return{ok:!1,data:null}}try{console.debug("[Isis][Edge] %s ok resp=%o",te?.mode,ue)}catch{}return{ok:!0,data:ue}}catch(ue){try{console.debug("[Isis][Edge] invoke exception:",ue)}catch{}return{ok:!1,data:null}}},[x,C]),F=p.useCallback(async te=>{if(!x)return null;const ue={"X-Master-Key":x,"X-Access-Key":x,"Content-Type":"application/json"};w&&(ue["X-Collection-Id"]=w);const Te=await fetch(`${_}`,{method:"POST",headers:ue,body:JSON.stringify(te||{projects:[{name:"F7 Arena"}],chat_sessions:[]})});if(!Te.ok)return null;const ne=await Te.json().catch(()=>null),de=ne?.metadata?.id||ne?.id||null;if(de){E(de);try{window?.localStorage?.setItem("ISIS_JSONBIN_BIN_ID",de)}catch{}}return de},[x]),D=p.useCallback(async()=>{if(!x||!P)return null;try{console.debug("[Isis][JSONBin] loadBin: GET %s/%s",_,P)}catch{}const te={"X-Master-Key":x,"X-Access-Key":x,"X-Bin-Meta":"false","Content-Type":"application/json"};w&&(te["X-Collection-Id"]=w);const ue=await fetch(`${_}/${P}`,{method:"GET",headers:te});try{console.debug("[Isis][JSONBin] loadBin: status=%s",ue?.status)}catch{}if(ue.status===401||ue.status===404){try{console.error("[Isis][JSONBin] GET unauthorized or not found. keySource=%s binId=%s status=%s",b,P,ue.status)}catch{}return await F()?{projects:[{name:"F7 Arena"}],chat_sessions:[]}:null}if(!ue.ok)return null;try{return await ue.json()}catch{return null}},[x,P,F]),I=p.useCallback(async te=>{if(!x||!P&&!await F(te))return!1;const ue=P||(typeof window<"u"?window.localStorage.getItem("ISIS_JSONBIN_BIN_ID"):null);try{console.debug("[Isis][JSONBin] saveBin: PUT %s/%s",_,ue)}catch{}const Te={"X-Master-Key":x,"X-Access-Key":x,"Content-Type":"application/json"};w&&(Te["X-Collection-Id"]=w);const ne=await fetch(`${_}/${ue}`,{method:"PUT",headers:Te,body:JSON.stringify(te)});try{console.debug("[Isis][JSONBin] saveBin: status=%s",ne?.status)}catch{}if(ne.status===401||ne.status===404){try{console.error("[Isis][JSONBin] PUT unauthorized or not found. keySource=%s binId=%s status=%s",b,ue,ne.status)}catch{}return!!await F(te)}return ne.ok},[x,P,F]),R=te=>!te||typeof te!="object"?{projects:[{name:"F7 Arena"}],chat_sessions:[]}:(Array.isArray(te.chat_sessions)||(te.chat_sessions=[]),te),M=(te,ue)=>(Array.isArray(te?.chat_sessions)?te.chat_sessions:[]).findIndex(ne=>(ne?.project||"").toString()===(ue.project||"").toString()&&(ne?.company?.code||"").toString()===(ue.companyCode||"").toString()&&(ne?.client_code||"").toString()===(ue.clientCode||"").toString()),U=p.useCallback(async()=>{if(i)return i;try{try{console.info("[Isis][Chat] ensureSession: start")}catch{}const te=c?.empresa||null,ue=te?{code:te.codigo_empresa||te.codigoEmpresa,name:te.nome_fantasia||te.nome}:null,Te=c?.cliente||null;let ne=await D();ne=R(ne),Array.isArray(ne.projects)||(ne.projects=[{name:"F7 Arena"}]);const de={project:"F7 Arena",companyCode:ue?.code||null,clientCode:Te?.id?String(Te.id):null};try{console.debug("[Isis][Chat] ensureSession: criteria=%o",de)}catch{}if(de.companyCode&&de.clientCode){const lt=M(ne,de);try{console.debug("[Isis][Chat] ensureSession: existingIndex=%s",lt)}catch{}lt===-1&&ne.chat_sessions.push({client_code:de.clientCode,client_name:Te?.nome||Te?.name||"",company:ue,project:de.project,conversation:[]})}await I(ne);try{console.info("[Isis][Chat] ensureSession: sessionId=%s",i)}catch{}return i}catch(te){try{console.error("[Isis][Chat] ensureSession: failed",te)}catch{}return null}},[i,c?.empresa,c?.cliente,D,I]),z=p.useCallback(async te=>{if(te)try{const ue=c?.empresa||null,Te=ue?{code:ue.codigo_empresa||ue.codigoEmpresa,name:ue.nome_fantasia||ue.nome}:null,ne=c?.cliente||null;let de=await D();if(!de)return;de=R(de);const lt={project:"F7 Arena",companyCode:Te?.code||null,clientCode:ne?.id?String(ne.id):null};try{console.debug("[Isis][Chat] tryUpdateSessionMeta: criteria=%o",lt)}catch{}if(!lt.companyCode&&!lt.clientCode)return;let Nt=M(de,lt);if(Nt===-1){de.chat_sessions.push({client_code:lt.clientCode,client_name:ne?.nome||ne?.name||"",company:Te,project:lt.project,conversation:[]}),Nt=de.chat_sessions.length-1;try{console.debug("[Isis][Chat] tryUpdateSessionMeta: created index=%s",Nt)}catch{}}else{ne?.id&&!de.chat_sessions[Nt].client_code&&(de.chat_sessions[Nt].client_code=String(ne.id)),ne?.nome&&!de.chat_sessions[Nt].client_name&&(de.chat_sessions[Nt].client_name=ne.nome),Te&&!de.chat_sessions[Nt].company&&(de.chat_sessions[Nt].company=Te);try{console.debug("[Isis][Chat] tryUpdateSessionMeta: updated index=%s",Nt)}catch{}}await I(de),Te?.name&&ne?.id&&await A({mode:"set_meta",cod_cliente:ne?.id?String(ne.id):"",nome_cliente:ne?.nome||ne?.name||"",empresa:Te.name,software:"F7 Arena"})}catch{}},[c?.empresa,c?.cliente,D,I,A]),W=p.useCallback(async te=>{try{try{console.info("[Isis][Chat] persistMessage: incoming=%o",{from:te.from,text:te.text})}catch{}const ue=c?.empresa||null,Te=ue?{code:ue.codigo_empresa||ue.codigoEmpresa,name:ue.nome_fantasia||ue.nome}:null,ne=c?.cliente||null;try{const de=te.from==="isis"?"assistant":"user",lt=Te?.name||ue?.nome_fantasia||ue?.nome||ue?.razao_social||"Desconhecida",Nt={id:`${Date.now()}${Math.random().toString(36).slice(2,10)}`,cod_cliente:ne?.id?String(ne.id):null,nome_cliente:ne?.nome||ne?.name||null,empresa:lt,projeto:"fluxo7arena",nota:null,comentario:null,conversa:JSON.stringify({session_id:i,from:de,text:String(te.text??"")}),timestamp:new Date().toISOString()},{error:at}=await xY.from("isis").insert(Nt);if(at)try{console.error("[Isis][Chat] supabase-isis insert error:",at)}catch{}else try{console.debug("[Isis][Chat] supabase-isis inserted")}catch{}}catch(de){try{console.error("[Isis][Chat] supabase-isis exception:",de)}catch{}}if(C&&await A({mode:"append_message",cod_cliente:ne?.id?String(ne.id):"_unknown",nome_cliente:ne?.nome||ne?.name||"",empresa:Te?.name||"",software:"F7 Arena",session_id:i,message:{from:te.from==="isis"?"assistant":"user",text:String(te.text??"")}}),C)try{const de=await U();if(!de)return;const lt=te.from==="isis"?"assistant":"user",Nt={ts:new Date().toISOString(),from:lt,text:String(te.text??"")};let at=await D();if(!at)return;at=R(at);const gt=c?.empresa||null,Pt=gt?{code:gt.codigo_empresa||gt.codigoEmpresa,name:gt.nome_fantasia||gt.nome}:null,yt=c?.cliente||null,Qe={project:"F7 Arena",companyCode:Pt?.code||null,clientCode:yt?.id?String(yt.id):null};let ge=M(at,Qe);ge===-1?at.chat_sessions.push({client_code:Qe.clientCode,client_name:yt?.nome||yt?.name||"",company:Pt,project:Qe.project,conversation:[Nt]}):(Array.isArray(at.chat_sessions[ge].conversation)||(at.chat_sessions[ge].conversation=[]),at.chat_sessions[ge].conversation.push(Nt)),await I(at),z(de)}catch{}}catch{}},[U,z,D,I,A,c?.empresa,c?.cliente,i]),$=p.useCallback(te=>{s(ue=>[...ue,{id:Date.now()+Math.random(),timestamp:new Date,...te}]),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth"})},100);try{W(te)}catch{}},[]),ee=p.useCallback((te,ue=2e3,Te=null)=>{m(!0),setTimeout(()=>{m(!1);const ne=te&&typeof te=="object"&&te.text?te:{text:te};$({from:"isis",text:ne.text,type:"text",color:ne.color??Te,copyable:!!ne.copyable,copyText:ne.copyText})},ue)},[$]),ve=p.useCallback((te,ue,Te=2e3)=>{m(!0),setTimeout(()=>{m(!1),s(ne=>ne.map(de=>de.type==="buttons"&&de.buttons&&de.buttons.length>0?{...de,disabled:!0}:de)),$({from:"isis",text:te,type:"buttons",buttons:ue,disabled:!1})},Te)},[$]),_e=p.useCallback(()=>{s(te=>te.map(ue=>ue.type==="buttons"&&ue.buttons&&ue.buttons.length>0&&!ue.disabled?{...ue,disabled:!0}:ue))},[]),K=p.useCallback(te=>{s(ue=>ue.filter(Te=>Te.id!==te))},[]),q=p.useCallback(te=>{s(ue=>ue.map(Te=>Te.id===te&&Te.type==="buttons"?{...Te,buttonsHidden:!0,disabled:!0}:Te))},[]),Y=p.useCallback(te=>{$({from:"user",text:te,type:"text"})},[$]),J=p.useCallback((te,ue)=>{if(d(Te=>({...Te,[te]:ue})),(te==="cliente"||te==="empresa")&&i)try{z(i)}catch{}},[]),fe=p.useCallback((te,ue)=>{d(Te=>({...Te,contato:{...Te.contato,[te]:ue}}))},[]),Z=p.useCallback(te=>{r(te)},[]),ce=p.useCallback(()=>{const te=["greeting","quadra","data","horario","modalidade","quantidade","nomes","contato","review","confirmation","avaliacao"],ue=te.indexOf(t);ue>0&&r(te[ue-1])},[t]),le=p.useCallback(()=>{r("greeting"),s([]),d({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),f(!1),m(!1),l(null)},[]),ie={currentStep:t,messages:n,selections:c,sessionId:i,isLoading:u,isTyping:h,chatEndRef:v,addMessage:$,addIsisMessage:ee,addIsisMessageWithButtons:ve,addUserMessage:Y,disableAllButtons:_e,removeMessageById:K,hideButtonsInMessage:q,updateSelection:J,updateContact:fe,nextStep:Z,previousStep:ce,resetConversation:le,setIsLoading:f,setIsTyping:m};return a.jsx(yY.Provider,{value:ie,children:e})};var N2e=Array.isArray,tc=N2e,S2e=typeof Qi=="object"&&Qi&&Qi.Object===Object&&Qi,wY=S2e,C2e=wY,A2e=typeof self=="object"&&self&&self.Object===Object&&self,P2e=C2e||A2e||Function("return this")(),tf=P2e,E2e=tf,k2e=E2e.Symbol,v1=k2e,q6=v1,jY=Object.prototype,I2e=jY.hasOwnProperty,O2e=jY.toString,ay=q6?q6.toStringTag:void 0;function T2e(e){var t=I2e.call(e,ay),r=e[ay];try{e[ay]=void 0;var n=!0}catch{}var s=O2e.call(e);return n&&(t?e[ay]=r:delete e[ay]),s}var D2e=T2e,M2e=Object.prototype,R2e=M2e.toString;function L2e(e){return R2e.call(e)}var F2e=L2e,z6=v1,$2e=D2e,B2e=F2e,q2e="[object Null]",z2e="[object Undefined]",U6=z6?z6.toStringTag:void 0;function U2e(e){return e==null?e===void 0?z2e:q2e:U6&&U6 in Object(e)?$2e(e):B2e(e)}var nm=U2e;function V2e(e){return e!=null&&typeof e=="object"}var am=V2e,W2e=nm,H2e=am,G2e="[object Symbol]";function K2e(e){return typeof e=="symbol"||H2e(e)&&W2e(e)==G2e}var v0=K2e,X2e=tc,Y2e=v0,J2e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q2e=/^\w*$/;function Z2e(e,t){if(X2e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Y2e(e)?!0:Q2e.test(e)||!J2e.test(e)||t!=null&&e in Object(t)}var mD=Z2e;function eje(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Bh=eje;const x0=Ga(Bh);var tje=nm,rje=Bh,nje="[object AsyncFunction]",aje="[object Function]",sje="[object GeneratorFunction]",oje="[object Proxy]";function ije(e){if(!rje(e))return!1;var t=tje(e);return t==aje||t==sje||t==nje||t==oje}var hD=ije;const na=Ga(hD);var lje=tf,cje=lje["__core-js_shared__"],dje=cje,SP=dje,V6=function(){var e=/[^.]+$/.exec(SP&&SP.keys&&SP.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function uje(e){return!!V6&&V6 in e}var fje=uje,mje=Function.prototype,hje=mje.toString;function pje(e){if(e!=null){try{return hje.call(e)}catch{}try{return e+""}catch{}}return""}var _Y=pje,gje=hD,vje=fje,xje=Bh,yje=_Y,bje=/[\\^$.*+?()[\]{}|]/g,wje=/^\[object .+?Constructor\]$/,jje=Function.prototype,_je=Object.prototype,Nje=jje.toString,Sje=_je.hasOwnProperty,Cje=RegExp("^"+Nje.call(Sje).replace(bje,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Aje(e){if(!xje(e)||vje(e))return!1;var t=gje(e)?Cje:wje;return t.test(yje(e))}var Pje=Aje;function Eje(e,t){return e?.[t]}var kje=Eje,Ije=Pje,Oje=kje;function Tje(e,t){var r=Oje(e,t);return Ije(r)?r:void 0}var Sg=Tje,Dje=Sg,Mje=Dje(Object,"create"),kC=Mje,W6=kC;function Rje(){this.__data__=W6?W6(null):{},this.size=0}var Lje=Rje;function Fje(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var $je=Fje,Bje=kC,qje="__lodash_hash_undefined__",zje=Object.prototype,Uje=zje.hasOwnProperty;function Vje(e){var t=this.__data__;if(Bje){var r=t[e];return r===qje?void 0:r}return Uje.call(t,e)?t[e]:void 0}var Wje=Vje,Hje=kC,Gje=Object.prototype,Kje=Gje.hasOwnProperty;function Xje(e){var t=this.__data__;return Hje?t[e]!==void 0:Kje.call(t,e)}var Yje=Xje,Jje=kC,Qje="__lodash_hash_undefined__";function Zje(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Jje&&t===void 0?Qje:t,this}var e_e=Zje,t_e=Lje,r_e=$je,n_e=Wje,a_e=Yje,s_e=e_e;function y0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}y0.prototype.clear=t_e;y0.prototype.delete=r_e;y0.prototype.get=n_e;y0.prototype.has=a_e;y0.prototype.set=s_e;var o_e=y0;function i_e(){this.__data__=[],this.size=0}var l_e=i_e;function c_e(e,t){return e===t||e!==e&&t!==t}var pD=c_e,d_e=pD;function u_e(e,t){for(var r=e.length;r--;)if(d_e(e[r][0],t))return r;return-1}var IC=u_e,f_e=IC,m_e=Array.prototype,h_e=m_e.splice;function p_e(e){var t=this.__data__,r=f_e(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():h_e.call(t,r,1),--this.size,!0}var g_e=p_e,v_e=IC;function x_e(e){var t=this.__data__,r=v_e(t,e);return r<0?void 0:t[r][1]}var y_e=x_e,b_e=IC;function w_e(e){return b_e(this.__data__,e)>-1}var j_e=w_e,__e=IC;function N_e(e,t){var r=this.__data__,n=__e(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var S_e=N_e,C_e=l_e,A_e=g_e,P_e=y_e,E_e=j_e,k_e=S_e;function b0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}b0.prototype.clear=C_e;b0.prototype.delete=A_e;b0.prototype.get=P_e;b0.prototype.has=E_e;b0.prototype.set=k_e;var OC=b0,I_e=Sg,O_e=tf,T_e=I_e(O_e,"Map"),gD=T_e,H6=o_e,D_e=OC,M_e=gD;function R_e(){this.size=0,this.__data__={hash:new H6,map:new(M_e||D_e),string:new H6}}var L_e=R_e;function F_e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var $_e=F_e,B_e=$_e;function q_e(e,t){var r=e.__data__;return B_e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var TC=q_e,z_e=TC;function U_e(e){var t=z_e(this,e).delete(e);return this.size-=t?1:0,t}var V_e=U_e,W_e=TC;function H_e(e){return W_e(this,e).get(e)}var G_e=H_e,K_e=TC;function X_e(e){return K_e(this,e).has(e)}var Y_e=X_e,J_e=TC;function Q_e(e,t){var r=J_e(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Z_e=Q_e,eNe=L_e,tNe=V_e,rNe=G_e,nNe=Y_e,aNe=Z_e;function w0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}w0.prototype.clear=eNe;w0.prototype.delete=tNe;w0.prototype.get=rNe;w0.prototype.has=nNe;w0.prototype.set=aNe;var vD=w0,NY=vD,sNe="Expected a function";function xD(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(sNe);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],o=r.cache;if(o.has(s))return o.get(s);var i=e.apply(this,n);return r.cache=o.set(s,i)||o,i};return r.cache=new(xD.Cache||NY),r}xD.Cache=NY;var SY=xD;const oNe=Ga(SY);var iNe=SY,lNe=500;function cNe(e){var t=iNe(e,function(n){return r.size===lNe&&r.clear(),n}),r=t.cache;return t}var dNe=cNe,uNe=dNe,fNe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mNe=/\\(\\)?/g,hNe=uNe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(fNe,function(r,n,s,o){t.push(s?o.replace(mNe,"$1"):n||r)}),t}),pNe=hNe;function gNe(e,t){for(var r=-1,n=e==null?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}var yD=gNe,G6=v1,vNe=yD,xNe=tc,yNe=v0,bNe=1/0,K6=G6?G6.prototype:void 0,X6=K6?K6.toString:void 0;function CY(e){if(typeof e=="string")return e;if(xNe(e))return vNe(e,CY)+"";if(yNe(e))return X6?X6.call(e):"";var t=e+"";return t=="0"&&1/e==-bNe?"-0":t}var wNe=CY,jNe=wNe;function _Ne(e){return e==null?"":jNe(e)}var AY=_Ne,NNe=tc,SNe=mD,CNe=pNe,ANe=AY;function PNe(e,t){return NNe(e)?e:SNe(e,t)?[e]:CNe(ANe(e))}var PY=PNe,ENe=v0,kNe=1/0;function INe(e){if(typeof e=="string"||ENe(e))return e;var t=e+"";return t=="0"&&1/e==-kNe?"-0":t}var DC=INe,ONe=PY,TNe=DC;function DNe(e,t){t=ONe(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[TNe(t[r++])];return r&&r==n?e:void 0}var bD=DNe,MNe=bD;function RNe(e,t,r){var n=e==null?void 0:MNe(e,t);return n===void 0?r:n}var EY=RNe;const Tc=Ga(EY);function LNe(e){return e==null}var FNe=LNe;const fa=Ga(FNe);var $Ne=nm,BNe=tc,qNe=am,zNe="[object String]";function UNe(e){return typeof e=="string"||!BNe(e)&&qNe(e)&&$Ne(e)==zNe}var VNe=UNe;const og=Ga(VNe);var kY={exports:{}},fs={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wD=Symbol.for("react.element"),jD=Symbol.for("react.portal"),MC=Symbol.for("react.fragment"),RC=Symbol.for("react.strict_mode"),LC=Symbol.for("react.profiler"),FC=Symbol.for("react.provider"),$C=Symbol.for("react.context"),WNe=Symbol.for("react.server_context"),BC=Symbol.for("react.forward_ref"),qC=Symbol.for("react.suspense"),zC=Symbol.for("react.suspense_list"),UC=Symbol.for("react.memo"),VC=Symbol.for("react.lazy"),HNe=Symbol.for("react.offscreen"),IY;IY=Symbol.for("react.module.reference");function kd(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case wD:switch(e=e.type,e){case MC:case LC:case RC:case qC:case zC:return e;default:switch(e=e&&e.$$typeof,e){case WNe:case $C:case BC:case VC:case UC:case FC:return e;default:return t}}case jD:return t}}}fs.ContextConsumer=$C;fs.ContextProvider=FC;fs.Element=wD;fs.ForwardRef=BC;fs.Fragment=MC;fs.Lazy=VC;fs.Memo=UC;fs.Portal=jD;fs.Profiler=LC;fs.StrictMode=RC;fs.Suspense=qC;fs.SuspenseList=zC;fs.isAsyncMode=function(){return!1};fs.isConcurrentMode=function(){return!1};fs.isContextConsumer=function(e){return kd(e)===$C};fs.isContextProvider=function(e){return kd(e)===FC};fs.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===wD};fs.isForwardRef=function(e){return kd(e)===BC};fs.isFragment=function(e){return kd(e)===MC};fs.isLazy=function(e){return kd(e)===VC};fs.isMemo=function(e){return kd(e)===UC};fs.isPortal=function(e){return kd(e)===jD};fs.isProfiler=function(e){return kd(e)===LC};fs.isStrictMode=function(e){return kd(e)===RC};fs.isSuspense=function(e){return kd(e)===qC};fs.isSuspenseList=function(e){return kd(e)===zC};fs.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===MC||e===LC||e===RC||e===qC||e===zC||e===HNe||typeof e=="object"&&e!==null&&(e.$$typeof===VC||e.$$typeof===UC||e.$$typeof===FC||e.$$typeof===$C||e.$$typeof===BC||e.$$typeof===IY||e.getModuleId!==void 0)};fs.typeOf=kd;kY.exports=fs;var GNe=kY.exports,KNe=nm,XNe=am,YNe="[object Number]";function JNe(e){return typeof e=="number"||XNe(e)&&KNe(e)==YNe}var OY=JNe;const QNe=Ga(OY);var ZNe=OY;function eSe(e){return ZNe(e)&&e!=+e}var tSe=eSe;const j0=Ga(tSe);var bl=function(t){return t===0?0:t>0?1:-1},Cp=function(t){return og(t)&&t.indexOf("%")===t.length-1},Zr=function(t){return QNe(t)&&!j0(t)},rSe=function(t){return fa(t)},Qo=function(t){return Zr(t)||og(t)},nSe=0,Cg=function(t){var r=++nSe;return"".concat(t||"").concat(r)},wl=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Zr(t)&&!og(t))return n;var o;if(Cp(t)){var i=t.indexOf("%");o=r*parseFloat(t.slice(0,i))/100}else o=+t;return j0(o)&&(o=n),s&&o>r&&(o=r),o},Rm=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},aSe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},s=0;s<r;s++)if(!n[t[s]])n[t[s]]=!0;else return!0;return!1},Xo=function(t,r){return Zr(t)&&Zr(r)?function(n){return t+n*(r-t)}:function(){return r}};function tN(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Tc(n,t))===r})}var sSe=function(t,r){return Zr(t)&&Zr(r)?t-r:og(t)&&og(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function tx(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function FI(e){"@babel/helpers - typeof";return FI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FI(e)}var oSe=["viewBox","children"],iSe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Y6=["points","pathLength"],CP={svg:oSe,polygon:Y6,polyline:Y6},_D=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],rN=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(p.isValidElement(t)&&(n=t.props),!x0(n))return null;var s={};return Object.keys(n).forEach(function(o){_D.includes(o)&&(s[o]=r||function(i){return n[o](n,i)})}),s},lSe=function(t,r,n){return function(s){return t(r,n,s),null}},ig=function(t,r,n){if(!x0(t)||FI(t)!=="object")return null;var s=null;return Object.keys(t).forEach(function(o){var i=t[o];_D.includes(o)&&typeof i=="function"&&(s||(s={}),s[o]=lSe(i,r,n))}),s},cSe=["children"],dSe=["children"];function J6(e,t){if(e==null)return{};var r=uSe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function $I(e){"@babel/helpers - typeof";return $I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$I(e)}var Q6={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Rf=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Z6=null,AP=null,ND=function e(t){if(t===Z6&&Array.isArray(AP))return AP;var r=[];return p.Children.forEach(t,function(n){fa(n)||(GNe.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),AP=r,Z6=t,r};function Dc(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(s){return Rf(s)}):n=[Rf(t)],ND(e).forEach(function(s){var o=Tc(s,"type.displayName")||Tc(s,"type.name");n.indexOf(o)!==-1&&r.push(s)}),r}function bc(e,t){var r=Dc(e,t);return r&&r[0]}var e8=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,s=r.height;return!(!Zr(n)||n<=0||!Zr(s)||s<=0)},fSe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],mSe=function(t){return t&&t.type&&og(t.type)&&fSe.indexOf(t.type)>=0},TY=function(t){return t&&$I(t)==="object"&&"clipDot"in t},hSe=function(t,r,n,s){var o,i=(o=CP?.[s])!==null&&o!==void 0?o:[];return r.startsWith("data-")||!na(t)&&(s&&i.includes(r)||iSe.includes(r))||n&&_D.includes(r)},Kn=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(p.isValidElement(t)&&(s=t.props),!x0(s))return null;var o={};return Object.keys(s).forEach(function(i){var l;hSe((l=s)===null||l===void 0?void 0:l[i],i,r,n)&&(o[i]=s[i])}),o},BI=function e(t,r){if(t===r)return!0;var n=p.Children.count(t);if(n!==p.Children.count(r))return!1;if(n===0)return!0;if(n===1)return t8(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var s=0;s<n;s++){var o=t[s],i=r[s];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!t8(o,i))return!1}return!0},t8=function(t,r){if(fa(t)&&fa(r))return!0;if(!fa(t)&&!fa(r)){var n=t.props||{},s=n.children,o=J6(n,cSe),i=r.props||{},l=i.children,c=J6(i,dSe);return s&&l?tx(o,c)&&BI(s,l):!s&&!l?tx(o,c):!1}return!1},r8=function(t,r){var n=[],s={};return ND(t).forEach(function(o,i){if(mSe(o))n.push(o);else if(o){var l=Rf(o.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!s[l])){var f=d(o,l,i);n.push(f),s[l]=!0}}}),n},pSe=function(t){var r=t&&t.type;return r&&Q6[r]?Q6[r]:null},gSe=function(t,r){return ND(r).indexOf(t)},vSe=["children","width","height","viewBox","className","style","title","desc"];function qI(){return qI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qI.apply(this,arguments)}function xSe(e,t){if(e==null)return{};var r=ySe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ySe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zI(e){var t=e.children,r=e.width,n=e.height,s=e.viewBox,o=e.className,i=e.style,l=e.title,c=e.desc,d=xSe(e,vSe),u=s||{width:r,height:n,x:0,y:0},f=ga("recharts-surface",o);return Se.createElement("svg",qI({},Kn(d,!0,"svg"),{className:f,width:r,height:n,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),Se.createElement("title",null,l),Se.createElement("desc",null,c),t)}var bSe=["children","className"];function UI(){return UI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UI.apply(this,arguments)}function wSe(e,t){if(e==null)return{};var r=jSe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Ta=Se.forwardRef(function(e,t){var r=e.children,n=e.className,s=wSe(e,bSe),o=ga("recharts-layer",n);return Se.createElement("g",UI({className:o},Kn(s,!0),{ref:t}),r)}),ou=function(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),o=2;o<n;o++)s[o-2]=arguments[o]};function _Se(e,t,r){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),r=r>s?s:r,r<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(s);++n<s;)o[n]=e[n+t];return o}var NSe=_Se,SSe=NSe;function CSe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:SSe(e,t,r)}var ASe=CSe,PSe="\\ud800-\\udfff",ESe="\\u0300-\\u036f",kSe="\\ufe20-\\ufe2f",ISe="\\u20d0-\\u20ff",OSe=ESe+kSe+ISe,TSe="\\ufe0e\\ufe0f",DSe="\\u200d",MSe=RegExp("["+DSe+PSe+OSe+TSe+"]");function RSe(e){return MSe.test(e)}var DY=RSe;function LSe(e){return e.split("")}var FSe=LSe,MY="\\ud800-\\udfff",$Se="\\u0300-\\u036f",BSe="\\ufe20-\\ufe2f",qSe="\\u20d0-\\u20ff",zSe=$Se+BSe+qSe,USe="\\ufe0e\\ufe0f",VSe="["+MY+"]",VI="["+zSe+"]",WI="\\ud83c[\\udffb-\\udfff]",WSe="(?:"+VI+"|"+WI+")",RY="[^"+MY+"]",LY="(?:\\ud83c[\\udde6-\\uddff]){2}",FY="[\\ud800-\\udbff][\\udc00-\\udfff]",HSe="\\u200d",$Y=WSe+"?",BY="["+USe+"]?",GSe="(?:"+HSe+"(?:"+[RY,LY,FY].join("|")+")"+BY+$Y+")*",KSe=BY+$Y+GSe,XSe="(?:"+[RY+VI+"?",VI,LY,FY,VSe].join("|")+")",YSe=RegExp(WI+"(?="+WI+")|"+XSe+KSe,"g");function JSe(e){return e.match(YSe)||[]}var QSe=JSe,ZSe=FSe,eCe=DY,tCe=QSe;function rCe(e){return eCe(e)?tCe(e):ZSe(e)}var nCe=rCe,aCe=ASe,sCe=DY,oCe=nCe,iCe=AY;function lCe(e){return function(t){t=iCe(t);var r=sCe(t)?oCe(t):void 0,n=r?r[0]:t.charAt(0),s=r?aCe(r,1).join(""):t.slice(1);return n[e]()+s}}var cCe=lCe,dCe=cCe,uCe=dCe("toUpperCase"),fCe=uCe;const WC=Ga(fCe);function ks(e){return function(){return e}}const qY=Math.cos,nN=Math.sin,gu=Math.sqrt,aN=Math.PI,HC=2*aN,HI=Math.PI,GI=2*HI,up=1e-6,mCe=GI-up;function zY(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function hCe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return zY;const r=10**t;return function(n){this._+=n[0];for(let s=1,o=n.length;s<o;++s)this._+=Math.round(arguments[s]*r)/r+n[s]}}class pCe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?zY:hCe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,s){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(t,r,n,s,o,i){this._append`C${+t},${+r},${+n},${+s},${this._x1=+o},${this._y1=+i}`}arcTo(t,r,n,s,o){if(t=+t,r=+r,n=+n,s=+s,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,l=this._y1,c=n-t,d=s-r,u=i-t,f=l-r,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>up)if(!(Math.abs(f*c-d*u)>up)||!o)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-i,v=s-l,g=c*c+d*d,y=m*m+v*v,x=Math.sqrt(g),b=Math.sqrt(h),w=o*Math.tan((HI-Math.acos((g+h-y)/(2*x*b)))/2),j=w/b,_=w/x;Math.abs(j-1)>up&&this._append`L${t+j*u},${r+j*f}`,this._append`A${o},${o},0,0,${+(f*m>u*v)},${this._x1=t+_*c},${this._y1=r+_*d}`}}arc(t,r,n,s,o,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(s),c=n*Math.sin(s),d=t+l,u=r+c,f=1^i,h=i?s-o:o-s;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>up||Math.abs(this._y1-u)>up)&&this._append`L${d},${u}`,n&&(h<0&&(h=h%GI+GI),h>mCe?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:h>up&&this._append`A${n},${n},0,${+(h>=HI)},${f},${this._x1=t+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(t,r,n,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function SD(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new pCe(t)}function CD(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function UY(e){this._context=e}UY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function GC(e){return new UY(e)}function VY(e){return e[0]}function WY(e){return e[1]}function HY(e,t){var r=ks(!0),n=null,s=GC,o=null,i=SD(l);e=typeof e=="function"?e:e===void 0?VY:ks(e),t=typeof t=="function"?t:t===void 0?WY:ks(t);function l(c){var d,u=(c=CD(c)).length,f,h=!1,m;for(n==null&&(o=s(m=i())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(f,d,c),+t(f,d,c));if(m)return o=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:ks(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:ks(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:ks(!!c),l):r},l.curve=function(c){return arguments.length?(s=c,n!=null&&(o=s(n)),l):s},l.context=function(c){return arguments.length?(c==null?n=o=null:o=s(n=c),l):n},l}function W2(e,t,r){var n=null,s=ks(!0),o=null,i=GC,l=null,c=SD(d);e=typeof e=="function"?e:e===void 0?VY:ks(+e),t=typeof t=="function"?t:ks(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?WY:ks(+r);function d(f){var h,m,v,g=(f=CD(f)).length,y,x=!1,b,w=new Array(g),j=new Array(g);for(o==null&&(l=i(b=c())),h=0;h<=g;++h){if(!(h<g&&s(y=f[h],h,f))===x)if(x=!x)m=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),v=h-1;v>=m;--v)l.point(w[v],j[v]);l.lineEnd(),l.areaEnd()}x&&(w[h]=+e(y,h,f),j[h]=+t(y,h,f),l.point(n?+n(y,h,f):w[h],r?+r(y,h,f):j[h]))}if(b)return l=null,b+""||null}function u(){return HY().defined(s).curve(i).context(o)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:ks(+f),n=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:ks(+f),d):e},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:ks(+f),d):n},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:ks(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:ks(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:ks(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(f){return arguments.length?(s=typeof f=="function"?f:ks(!!f),d):s},d.curve=function(f){return arguments.length?(i=f,o!=null&&(l=i(o)),d):i},d.context=function(f){return arguments.length?(f==null?o=l=null:l=i(o=f),d):o},d}class GY{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function gCe(e){return new GY(e,!0)}function vCe(e){return new GY(e,!1)}const AD={draw(e,t){const r=gu(t/aN);e.moveTo(r,0),e.arc(0,0,r,0,HC)}},xCe={draw(e,t){const r=gu(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},KY=gu(1/3),yCe=KY*2,bCe={draw(e,t){const r=gu(t/yCe),n=r*KY;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},wCe={draw(e,t){const r=gu(t),n=-r/2;e.rect(n,n,r,r)}},jCe=.8908130915292852,XY=nN(aN/10)/nN(7*aN/10),_Ce=nN(HC/10)*XY,NCe=-qY(HC/10)*XY,SCe={draw(e,t){const r=gu(t*jCe),n=_Ce*r,s=NCe*r;e.moveTo(0,-r),e.lineTo(n,s);for(let o=1;o<5;++o){const i=HC*o/5,l=qY(i),c=nN(i);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*s,c*n+l*s)}e.closePath()}},PP=gu(3),CCe={draw(e,t){const r=-gu(t/(PP*3));e.moveTo(0,r*2),e.lineTo(-PP*r,-r),e.lineTo(PP*r,-r),e.closePath()}},Xc=-.5,Yc=gu(3)/2,KI=1/gu(12),ACe=(KI/2+1)*3,PCe={draw(e,t){const r=gu(t/ACe),n=r/2,s=r*KI,o=n,i=r*KI+r,l=-o,c=i;e.moveTo(n,s),e.lineTo(o,i),e.lineTo(l,c),e.lineTo(Xc*n-Yc*s,Yc*n+Xc*s),e.lineTo(Xc*o-Yc*i,Yc*o+Xc*i),e.lineTo(Xc*l-Yc*c,Yc*l+Xc*c),e.lineTo(Xc*n+Yc*s,Xc*s-Yc*n),e.lineTo(Xc*o+Yc*i,Xc*i-Yc*o),e.lineTo(Xc*l+Yc*c,Xc*c-Yc*l),e.closePath()}};function ECe(e,t){let r=null,n=SD(s);e=typeof e=="function"?e:ks(e||AD),t=typeof t=="function"?t:ks(t===void 0?64:+t);function s(){let o;if(r||(r=o=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),o)return r=null,o+""||null}return s.type=function(o){return arguments.length?(e=typeof o=="function"?o:ks(o),s):e},s.size=function(o){return arguments.length?(t=typeof o=="function"?o:ks(+o),s):t},s.context=function(o){return arguments.length?(r=o??null,s):r},s}function sN(){}function oN(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function YY(e){this._context=e}YY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:oN(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:oN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kCe(e){return new YY(e)}function JY(e){this._context=e}JY.prototype={areaStart:sN,areaEnd:sN,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:oN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ICe(e){return new JY(e)}function QY(e){this._context=e}QY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:oN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function OCe(e){return new QY(e)}function ZY(e){this._context=e}ZY.prototype={areaStart:sN,areaEnd:sN,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function TCe(e){return new ZY(e)}function n8(e){return e<0?-1:1}function a8(e,t,r){var n=e._x1-e._x0,s=t-e._x1,o=(e._y1-e._y0)/(n||s<0&&-0),i=(r-e._y1)/(s||n<0&&-0),l=(o*s+i*n)/(n+s);return(n8(o)+n8(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(l))||0}function s8(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function EP(e,t,r){var n=e._x0,s=e._y0,o=e._x1,i=e._y1,l=(o-n)/3;e._context.bezierCurveTo(n+l,s+l*t,o-l,i-l*r,o,i)}function iN(e){this._context=e}iN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:EP(this,this._t0,s8(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,EP(this,s8(this,r=a8(this,e,t)),r);break;default:EP(this,this._t0,r=a8(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function eJ(e){this._context=new tJ(e)}(eJ.prototype=Object.create(iN.prototype)).point=function(e,t){iN.prototype.point.call(this,t,e)};function tJ(e){this._context=e}tJ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,s,o){this._context.bezierCurveTo(t,e,n,r,o,s)}};function DCe(e){return new iN(e)}function MCe(e){return new eJ(e)}function rJ(e){this._context=e}rJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=o8(e),s=o8(t),o=0,i=1;i<r;++o,++i)this._context.bezierCurveTo(n[0][o],s[0][o],n[1][o],s[1][o],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function o8(e){var t,r=e.length-1,n,s=new Array(r),o=new Array(r),i=new Array(r);for(s[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,o[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=s[t]/o[t-1],o[t]-=n,i[t]-=n*i[t-1];for(s[r-1]=i[r-1]/o[r-1],t=r-2;t>=0;--t)s[t]=(i[t]-s[t+1])/o[t];for(o[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-s[t+1];return[s,o]}function RCe(e){return new rJ(e)}function KC(e,t){this._context=e,this._t=t}KC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function LCe(e){return new KC(e,.5)}function FCe(e){return new KC(e,0)}function $Ce(e){return new KC(e,1)}function Sx(e,t){if((i=e.length)>1)for(var r=1,n,s,o=e[t[0]],i,l=o.length;r<i;++r)for(s=o,o=e[t[r]],n=0;n<l;++n)o[n][1]+=o[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function XI(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function BCe(e,t){return e[t]}function qCe(e){const t=[];return t.key=e,t}function zCe(){var e=ks([]),t=XI,r=Sx,n=BCe;function s(o){var i=Array.from(e.apply(this,arguments),qCe),l,c=i.length,d=-1,u;for(const f of o)for(l=0,++d;l<c;++l)(i[l][d]=[0,+n(f,i[l].key,d,o)]).data=f;for(l=0,u=CD(t(i));l<c;++l)i[u[l]].index=l;return r(i,u),i}return s.keys=function(o){return arguments.length?(e=typeof o=="function"?o:ks(Array.from(o)),s):e},s.value=function(o){return arguments.length?(n=typeof o=="function"?o:ks(+o),s):n},s.order=function(o){return arguments.length?(t=o==null?XI:typeof o=="function"?o:ks(Array.from(o)),s):t},s.offset=function(o){return arguments.length?(r=o??Sx,s):r},s}function UCe(e,t){if((n=e.length)>0){for(var r,n,s=0,o=e[0].length,i;s<o;++s){for(i=r=0;r<n;++r)i+=e[r][s][1]||0;if(i)for(r=0;r<n;++r)e[r][s][1]/=i}Sx(e,t)}}function VCe(e,t){if((s=e.length)>0){for(var r=0,n=e[t[0]],s,o=n.length;r<o;++r){for(var i=0,l=0;i<s;++i)l+=e[i][r][1]||0;n[r][1]+=n[r][0]=-l/2}Sx(e,t)}}function WCe(e,t){if(!(!((i=e.length)>0)||!((o=(s=e[t[0]]).length)>0))){for(var r=0,n=1,s,o,i;n<o;++n){for(var l=0,c=0,d=0;l<i;++l){for(var u=e[t[l]],f=u[n][1]||0,h=u[n-1][1]||0,m=(f-h)/2,v=0;v<l;++v){var g=e[t[v]],y=g[n][1]||0,x=g[n-1][1]||0;m+=y-x}c+=f,d+=m*f}s[n-1][1]+=s[n-1][0]=r,c&&(r-=d/c)}s[n-1][1]+=s[n-1][0]=r,Sx(e,t)}}function ew(e){"@babel/helpers - typeof";return ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ew(e)}var HCe=["type","size","sizeType"];function YI(){return YI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YI.apply(this,arguments)}function i8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function l8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i8(Object(r),!0).forEach(function(n){GCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GCe(e,t,r){return t=KCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KCe(e){var t=XCe(e,"string");return ew(t)=="symbol"?t:t+""}function XCe(e,t){if(ew(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ew(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YCe(e,t){if(e==null)return{};var r=JCe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var nJ={symbolCircle:AD,symbolCross:xCe,symbolDiamond:bCe,symbolSquare:wCe,symbolStar:SCe,symbolTriangle:CCe,symbolWye:PCe},QCe=Math.PI/180,ZCe=function(t){var r="symbol".concat(WC(t));return nJ[r]||AD},e5e=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var s=18*QCe;return 1.25*t*t*(Math.tan(s)-Math.tan(s*2)*Math.pow(Math.tan(s),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},t5e=function(t,r){nJ["symbol".concat(WC(t))]=r},PD=function(t){var r=t.type,n=r===void 0?"circle":r,s=t.size,o=s===void 0?64:s,i=t.sizeType,l=i===void 0?"area":i,c=YCe(t,HCe),d=l8(l8({},c),{},{type:n,size:o,sizeType:l}),u=function(){var y=ZCe(n),x=ECe().type(y).size(e5e(o,l,n));return x()},f=d.className,h=d.cx,m=d.cy,v=Kn(d,!0);return h===+h&&m===+m&&o===+o?Se.createElement("path",YI({},v,{className:ga("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(m,")"),d:u()})):null};PD.registerSymbol=t5e;function Cx(e){"@babel/helpers - typeof";return Cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cx(e)}function JI(){return JI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JI.apply(this,arguments)}function c8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function r5e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c8(Object(r),!0).forEach(function(n){tw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sJ(n.key),n)}}function a5e(e,t,r){return t&&d8(e.prototype,t),r&&d8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s5e(e,t,r){return t=lN(t),o5e(e,aJ()?Reflect.construct(t,r||[],lN(e).constructor):t.apply(e,r))}function o5e(e,t){if(t&&(Cx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return i5e(e)}function i5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aJ=function(){return!!e})()}function lN(e){return lN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lN(e)}function l5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QI(e,t)}function QI(e,t){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},QI(e,t)}function tw(e,t,r){return t=sJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sJ(e){var t=c5e(e,"string");return Cx(t)=="symbol"?t:t+""}function c5e(e,t){if(Cx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jc=32,ED=function(e){function t(){return n5e(this,t),s5e(this,t,arguments)}return l5e(t,e),a5e(t,[{key:"renderIcon",value:function(n){var s=this.props.inactiveColor,o=Jc/2,i=Jc/6,l=Jc/3,c=n.inactive?s:n.color;if(n.type==="plainline")return Se.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:o,x2:Jc,y2:o,className:"recharts-legend-icon"});if(n.type==="line")return Se.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(o,"h").concat(l,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*l,",").concat(o,`
            H`).concat(Jc,"M").concat(2*l,",").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(l,",").concat(o),className:"recharts-legend-icon"});if(n.type==="rect")return Se.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Jc/8,"h").concat(Jc,"v").concat(Jc*3/4,"h").concat(-Jc,"z"),className:"recharts-legend-icon"});if(Se.isValidElement(n.legendIcon)){var d=r5e({},n);return delete d.legendIcon,Se.cloneElement(n.legendIcon,d)}return Se.createElement(PD,{fill:c,cx:o,cy:o,size:Jc,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,s=this.props,o=s.payload,i=s.iconSize,l=s.layout,c=s.formatter,d=s.inactiveColor,u={x:0,y:0,width:Jc,height:Jc},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(m,v){var g=m.formatter||c,y=ga(tw(tw({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",m.inactive));if(m.type==="none")return null;var x=na(m.value)?null:m.value;ou(!na(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=m.inactive?d:m.color;return Se.createElement("li",JI({className:y,style:f,key:"legend-item-".concat(v)},ig(n.props,m,v)),Se.createElement(zI,{width:i,height:i,viewBox:u,style:h},n.renderIcon(m)),Se.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},g?g(x,m,v):x))})}},{key:"render",value:function(){var n=this.props,s=n.payload,o=n.layout,i=n.align;if(!s||!s.length)return null;var l={padding:0,margin:0,textAlign:o==="horizontal"?i:"left"};return Se.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(p.PureComponent);tw(ED,"displayName","Legend");tw(ED,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var d5e=OC;function u5e(){this.__data__=new d5e,this.size=0}var f5e=u5e;function m5e(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var h5e=m5e;function p5e(e){return this.__data__.get(e)}var g5e=p5e;function v5e(e){return this.__data__.has(e)}var x5e=v5e,y5e=OC,b5e=gD,w5e=vD,j5e=200;function _5e(e,t){var r=this.__data__;if(r instanceof y5e){var n=r.__data__;if(!b5e||n.length<j5e-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new w5e(n)}return r.set(e,t),this.size=r.size,this}var N5e=_5e,S5e=OC,C5e=f5e,A5e=h5e,P5e=g5e,E5e=x5e,k5e=N5e;function _0(e){var t=this.__data__=new S5e(e);this.size=t.size}_0.prototype.clear=C5e;_0.prototype.delete=A5e;_0.prototype.get=P5e;_0.prototype.has=E5e;_0.prototype.set=k5e;var oJ=_0,I5e="__lodash_hash_undefined__";function O5e(e){return this.__data__.set(e,I5e),this}var T5e=O5e;function D5e(e){return this.__data__.has(e)}var M5e=D5e,R5e=vD,L5e=T5e,F5e=M5e;function cN(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new R5e;++t<r;)this.add(e[t])}cN.prototype.add=cN.prototype.push=L5e;cN.prototype.has=F5e;var iJ=cN;function $5e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var lJ=$5e;function B5e(e,t){return e.has(t)}var cJ=B5e,q5e=iJ,z5e=lJ,U5e=cJ,V5e=1,W5e=2;function H5e(e,t,r,n,s,o){var i=r&V5e,l=e.length,c=t.length;if(l!=c&&!(i&&c>l))return!1;var d=o.get(e),u=o.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,m=r&W5e?new q5e:void 0;for(o.set(e,t),o.set(t,e);++f<l;){var v=e[f],g=t[f];if(n)var y=i?n(g,v,f,t,e,o):n(v,g,f,e,t,o);if(y!==void 0){if(y)continue;h=!1;break}if(m){if(!z5e(t,function(x,b){if(!U5e(m,b)&&(v===x||s(v,x,r,n,o)))return m.push(b)})){h=!1;break}}else if(!(v===g||s(v,g,r,n,o))){h=!1;break}}return o.delete(e),o.delete(t),h}var dJ=H5e,G5e=tf,K5e=G5e.Uint8Array,X5e=K5e;function Y5e(e){var t=-1,r=Array(e.size);return e.forEach(function(n,s){r[++t]=[s,n]}),r}var J5e=Y5e;function Q5e(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var kD=Q5e,u8=v1,f8=X5e,Z5e=pD,eAe=dJ,tAe=J5e,rAe=kD,nAe=1,aAe=2,sAe="[object Boolean]",oAe="[object Date]",iAe="[object Error]",lAe="[object Map]",cAe="[object Number]",dAe="[object RegExp]",uAe="[object Set]",fAe="[object String]",mAe="[object Symbol]",hAe="[object ArrayBuffer]",pAe="[object DataView]",m8=u8?u8.prototype:void 0,kP=m8?m8.valueOf:void 0;function gAe(e,t,r,n,s,o,i){switch(r){case pAe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case hAe:return!(e.byteLength!=t.byteLength||!o(new f8(e),new f8(t)));case sAe:case oAe:case cAe:return Z5e(+e,+t);case iAe:return e.name==t.name&&e.message==t.message;case dAe:case fAe:return e==t+"";case lAe:var l=tAe;case uAe:var c=n&nAe;if(l||(l=rAe),e.size!=t.size&&!c)return!1;var d=i.get(e);if(d)return d==t;n|=aAe,i.set(e,t);var u=eAe(l(e),l(t),n,s,o,i);return i.delete(e),u;case mAe:if(kP)return kP.call(e)==kP.call(t)}return!1}var vAe=gAe;function xAe(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}var uJ=xAe,yAe=uJ,bAe=tc;function wAe(e,t,r){var n=t(e);return bAe(e)?n:yAe(n,r(e))}var jAe=wAe;function _Ae(e,t){for(var r=-1,n=e==null?0:e.length,s=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[s++]=i)}return o}var NAe=_Ae;function SAe(){return[]}var CAe=SAe,AAe=NAe,PAe=CAe,EAe=Object.prototype,kAe=EAe.propertyIsEnumerable,h8=Object.getOwnPropertySymbols,IAe=h8?function(e){return e==null?[]:(e=Object(e),AAe(h8(e),function(t){return kAe.call(e,t)}))}:PAe,OAe=IAe;function TAe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var DAe=TAe,MAe=nm,RAe=am,LAe="[object Arguments]";function FAe(e){return RAe(e)&&MAe(e)==LAe}var $Ae=FAe,p8=$Ae,BAe=am,fJ=Object.prototype,qAe=fJ.hasOwnProperty,zAe=fJ.propertyIsEnumerable,UAe=p8(function(){return arguments}())?p8:function(e){return BAe(e)&&qAe.call(e,"callee")&&!zAe.call(e,"callee")},ID=UAe,dN={exports:{}};function VAe(){return!1}var WAe=VAe;dN.exports;(function(e,t){var r=tf,n=WAe,s=t&&!t.nodeType&&t,o=s&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===s,l=i?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(dN,dN.exports);var mJ=dN.exports,HAe=9007199254740991,GAe=/^(?:0|[1-9]\d*)$/;function KAe(e,t){var r=typeof e;return t=t??HAe,!!t&&(r=="number"||r!="symbol"&&GAe.test(e))&&e>-1&&e%1==0&&e<t}var OD=KAe,XAe=9007199254740991;function YAe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=XAe}var TD=YAe,JAe=nm,QAe=TD,ZAe=am,ePe="[object Arguments]",tPe="[object Array]",rPe="[object Boolean]",nPe="[object Date]",aPe="[object Error]",sPe="[object Function]",oPe="[object Map]",iPe="[object Number]",lPe="[object Object]",cPe="[object RegExp]",dPe="[object Set]",uPe="[object String]",fPe="[object WeakMap]",mPe="[object ArrayBuffer]",hPe="[object DataView]",pPe="[object Float32Array]",gPe="[object Float64Array]",vPe="[object Int8Array]",xPe="[object Int16Array]",yPe="[object Int32Array]",bPe="[object Uint8Array]",wPe="[object Uint8ClampedArray]",jPe="[object Uint16Array]",_Pe="[object Uint32Array]",Bs={};Bs[pPe]=Bs[gPe]=Bs[vPe]=Bs[xPe]=Bs[yPe]=Bs[bPe]=Bs[wPe]=Bs[jPe]=Bs[_Pe]=!0;Bs[ePe]=Bs[tPe]=Bs[mPe]=Bs[rPe]=Bs[hPe]=Bs[nPe]=Bs[aPe]=Bs[sPe]=Bs[oPe]=Bs[iPe]=Bs[lPe]=Bs[cPe]=Bs[dPe]=Bs[uPe]=Bs[fPe]=!1;function NPe(e){return ZAe(e)&&QAe(e.length)&&!!Bs[JAe(e)]}var SPe=NPe;function CPe(e){return function(t){return e(t)}}var hJ=CPe,uN={exports:{}};uN.exports;(function(e,t){var r=wY,n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,i=o&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=l})(uN,uN.exports);var APe=uN.exports,PPe=SPe,EPe=hJ,g8=APe,v8=g8&&g8.isTypedArray,kPe=v8?EPe(v8):PPe,pJ=kPe,IPe=DAe,OPe=ID,TPe=tc,DPe=mJ,MPe=OD,RPe=pJ,LPe=Object.prototype,FPe=LPe.hasOwnProperty;function $Pe(e,t){var r=TPe(e),n=!r&&OPe(e),s=!r&&!n&&DPe(e),o=!r&&!n&&!s&&RPe(e),i=r||n||s||o,l=i?IPe(e.length,String):[],c=l.length;for(var d in e)(t||FPe.call(e,d))&&!(i&&(d=="length"||s&&(d=="offset"||d=="parent")||o&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||MPe(d,c)))&&l.push(d);return l}var BPe=$Pe,qPe=Object.prototype;function zPe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||qPe;return e===r}var UPe=zPe;function VPe(e,t){return function(r){return e(t(r))}}var gJ=VPe,WPe=gJ,HPe=WPe(Object.keys,Object),GPe=HPe,KPe=UPe,XPe=GPe,YPe=Object.prototype,JPe=YPe.hasOwnProperty;function QPe(e){if(!KPe(e))return XPe(e);var t=[];for(var r in Object(e))JPe.call(e,r)&&r!="constructor"&&t.push(r);return t}var ZPe=QPe,eEe=hD,tEe=TD;function rEe(e){return e!=null&&tEe(e.length)&&!eEe(e)}var x1=rEe,nEe=BPe,aEe=ZPe,sEe=x1;function oEe(e){return sEe(e)?nEe(e):aEe(e)}var XC=oEe,iEe=jAe,lEe=OAe,cEe=XC;function dEe(e){return iEe(e,cEe,lEe)}var uEe=dEe,x8=uEe,fEe=1,mEe=Object.prototype,hEe=mEe.hasOwnProperty;function pEe(e,t,r,n,s,o){var i=r&fEe,l=x8(e),c=l.length,d=x8(t),u=d.length;if(c!=u&&!i)return!1;for(var f=c;f--;){var h=l[f];if(!(i?h in t:hEe.call(t,h)))return!1}var m=o.get(e),v=o.get(t);if(m&&v)return m==t&&v==e;var g=!0;o.set(e,t),o.set(t,e);for(var y=i;++f<c;){h=l[f];var x=e[h],b=t[h];if(n)var w=i?n(b,x,h,t,e,o):n(x,b,h,e,t,o);if(!(w===void 0?x===b||s(x,b,r,n,o):w)){g=!1;break}y||(y=h=="constructor")}if(g&&!y){var j=e.constructor,_=t.constructor;j!=_&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof _=="function"&&_ instanceof _)&&(g=!1)}return o.delete(e),o.delete(t),g}var gEe=pEe,vEe=Sg,xEe=tf,yEe=vEe(xEe,"DataView"),bEe=yEe,wEe=Sg,jEe=tf,_Ee=wEe(jEe,"Promise"),NEe=_Ee,SEe=Sg,CEe=tf,AEe=SEe(CEe,"Set"),vJ=AEe,PEe=Sg,EEe=tf,kEe=PEe(EEe,"WeakMap"),IEe=kEe,ZI=bEe,eO=gD,tO=NEe,rO=vJ,nO=IEe,xJ=nm,N0=_Y,y8="[object Map]",OEe="[object Object]",b8="[object Promise]",w8="[object Set]",j8="[object WeakMap]",_8="[object DataView]",TEe=N0(ZI),DEe=N0(eO),MEe=N0(tO),REe=N0(rO),LEe=N0(nO),fp=xJ;(ZI&&fp(new ZI(new ArrayBuffer(1)))!=_8||eO&&fp(new eO)!=y8||tO&&fp(tO.resolve())!=b8||rO&&fp(new rO)!=w8||nO&&fp(new nO)!=j8)&&(fp=function(e){var t=xJ(e),r=t==OEe?e.constructor:void 0,n=r?N0(r):"";if(n)switch(n){case TEe:return _8;case DEe:return y8;case MEe:return b8;case REe:return w8;case LEe:return j8}return t});var FEe=fp,IP=oJ,$Ee=dJ,BEe=vAe,qEe=gEe,N8=FEe,S8=tc,C8=mJ,zEe=pJ,UEe=1,A8="[object Arguments]",P8="[object Array]",H2="[object Object]",VEe=Object.prototype,E8=VEe.hasOwnProperty;function WEe(e,t,r,n,s,o){var i=S8(e),l=S8(t),c=i?P8:N8(e),d=l?P8:N8(t);c=c==A8?H2:c,d=d==A8?H2:d;var u=c==H2,f=d==H2,h=c==d;if(h&&C8(e)){if(!C8(t))return!1;i=!0,u=!1}if(h&&!u)return o||(o=new IP),i||zEe(e)?$Ee(e,t,r,n,s,o):BEe(e,t,c,r,n,s,o);if(!(r&UEe)){var m=u&&E8.call(e,"__wrapped__"),v=f&&E8.call(t,"__wrapped__");if(m||v){var g=m?e.value():e,y=v?t.value():t;return o||(o=new IP),s(g,y,r,n,o)}}return h?(o||(o=new IP),qEe(e,t,r,n,s,o)):!1}var HEe=WEe,GEe=HEe,k8=am;function yJ(e,t,r,n,s){return e===t?!0:e==null||t==null||!k8(e)&&!k8(t)?e!==e&&t!==t:GEe(e,t,r,n,yJ,s)}var DD=yJ,KEe=oJ,XEe=DD,YEe=1,JEe=2;function QEe(e,t,r,n){var s=r.length,o=s,i=!n;if(e==null)return!o;for(e=Object(e);s--;){var l=r[s];if(i&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<o;){l=r[s];var c=l[0],d=e[c],u=l[1];if(i&&l[2]){if(d===void 0&&!(c in e))return!1}else{var f=new KEe;if(n)var h=n(d,u,c,e,t,f);if(!(h===void 0?XEe(u,d,YEe|JEe,n,f):h))return!1}}return!0}var ZEe=QEe,eke=Bh;function tke(e){return e===e&&!eke(e)}var bJ=tke,rke=bJ,nke=XC;function ake(e){for(var t=nke(e),r=t.length;r--;){var n=t[r],s=e[n];t[r]=[n,s,rke(s)]}return t}var ske=ake;function oke(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var wJ=oke,ike=ZEe,lke=ske,cke=wJ;function dke(e){var t=lke(e);return t.length==1&&t[0][2]?cke(t[0][0],t[0][1]):function(r){return r===e||ike(r,e,t)}}var uke=dke;function fke(e,t){return e!=null&&t in Object(e)}var mke=fke,hke=PY,pke=ID,gke=tc,vke=OD,xke=TD,yke=DC;function bke(e,t,r){t=hke(t,e);for(var n=-1,s=t.length,o=!1;++n<s;){var i=yke(t[n]);if(!(o=e!=null&&r(e,i)))break;e=e[i]}return o||++n!=s?o:(s=e==null?0:e.length,!!s&&xke(s)&&vke(i,s)&&(gke(e)||pke(e)))}var wke=bke,jke=mke,_ke=wke;function Nke(e,t){return e!=null&&_ke(e,t,jke)}var Ske=Nke,Cke=DD,Ake=EY,Pke=Ske,Eke=mD,kke=bJ,Ike=wJ,Oke=DC,Tke=1,Dke=2;function Mke(e,t){return Eke(e)&&kke(t)?Ike(Oke(e),t):function(r){var n=Ake(r,e);return n===void 0&&n===t?Pke(r,e):Cke(t,n,Tke|Dke)}}var Rke=Mke;function Lke(e){return e}var S0=Lke;function Fke(e){return function(t){return t?.[e]}}var $ke=Fke,Bke=bD;function qke(e){return function(t){return Bke(t,e)}}var zke=qke,Uke=$ke,Vke=zke,Wke=mD,Hke=DC;function Gke(e){return Wke(e)?Uke(Hke(e)):Vke(e)}var Kke=Gke,Xke=uke,Yke=Rke,Jke=S0,Qke=tc,Zke=Kke;function eIe(e){return typeof e=="function"?e:e==null?Jke:typeof e=="object"?Qke(e)?Yke(e[0],e[1]):Xke(e):Zke(e)}var rf=eIe;function tIe(e,t,r,n){for(var s=e.length,o=r+(n?1:-1);n?o--:++o<s;)if(t(e[o],o,e))return o;return-1}var jJ=tIe;function rIe(e){return e!==e}var nIe=rIe;function aIe(e,t,r){for(var n=r-1,s=e.length;++n<s;)if(e[n]===t)return n;return-1}var sIe=aIe,oIe=jJ,iIe=nIe,lIe=sIe;function cIe(e,t,r){return t===t?lIe(e,t,r):oIe(e,iIe,r)}var dIe=cIe,uIe=dIe;function fIe(e,t){var r=e==null?0:e.length;return!!r&&uIe(e,t,0)>-1}var mIe=fIe;function hIe(e,t,r){for(var n=-1,s=e==null?0:e.length;++n<s;)if(r(t,e[n]))return!0;return!1}var pIe=hIe;function gIe(){}var vIe=gIe,OP=vJ,xIe=vIe,yIe=kD,bIe=1/0,wIe=OP&&1/yIe(new OP([,-0]))[1]==bIe?function(e){return new OP(e)}:xIe,jIe=wIe,_Ie=iJ,NIe=mIe,SIe=pIe,CIe=cJ,AIe=jIe,PIe=kD,EIe=200;function kIe(e,t,r){var n=-1,s=NIe,o=e.length,i=!0,l=[],c=l;if(r)i=!1,s=SIe;else if(o>=EIe){var d=t?null:AIe(e);if(d)return PIe(d);i=!1,s=CIe,c=new _Ie}else c=t?[]:l;e:for(;++n<o;){var u=e[n],f=t?t(u):u;if(u=r||u!==0?u:0,i&&f===f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),l.push(u)}else s(c,f,r)||(c!==l&&c.push(f),l.push(u))}return l}var IIe=kIe,OIe=rf,TIe=IIe;function DIe(e,t){return e&&e.length?TIe(e,OIe(t)):[]}var MIe=DIe;const I8=Ga(MIe);function _J(e,t,r){return t===!0?I8(e,r):na(t)?I8(e,t):e}function Ax(e){"@babel/helpers - typeof";return Ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ax(e)}var RIe=["ref"];function O8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ff(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O8(Object(r),!0).forEach(function(n){YC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SJ(n.key),n)}}function FIe(e,t,r){return t&&T8(e.prototype,t),r&&T8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ie(e,t,r){return t=fN(t),BIe(e,NJ()?Reflect.construct(t,r||[],fN(e).constructor):t.apply(e,r))}function BIe(e,t){if(t&&(Ax(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qIe(e)}function qIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NJ=function(){return!!e})()}function fN(e){return fN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fN(e)}function zIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},aO(e,t)}function YC(e,t,r){return t=SJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SJ(e){var t=UIe(e,"string");return Ax(t)=="symbol"?t:t+""}function UIe(e,t){if(Ax(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ax(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VIe(e,t){if(e==null)return{};var r=WIe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function HIe(e){return e.value}function GIe(e,t){if(Se.isValidElement(e))return Se.cloneElement(e,t);if(typeof e=="function")return Se.createElement(e,t);t.ref;var r=VIe(t,RIe);return Se.createElement(ED,r)}var D8=1,qp=function(e){function t(){var r;LIe(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=$Ie(this,t,[].concat(s)),YC(r,"lastBoundingBox",{width:-1,height:-1}),r}return zIe(t,e),FIe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,s=this.getBBox();s?(Math.abs(s.width-this.lastBoundingBox.width)>D8||Math.abs(s.height-this.lastBoundingBox.height)>D8)&&(this.lastBoundingBox.width=s.width,this.lastBoundingBox.height=s.height,n&&n(s)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ff({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var s=this.props,o=s.layout,i=s.align,l=s.verticalAlign,c=s.margin,d=s.chartWidth,u=s.chartHeight,f,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(i==="center"&&o==="vertical"){var m=this.getBBoxSnapshot();f={left:((d||0)-m.width)/2}}else f=i==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var v=this.getBBoxSnapshot();h={top:((u||0)-v.height)/2}}else h=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return ff(ff({},f),h)}},{key:"render",value:function(){var n=this,s=this.props,o=s.content,i=s.width,l=s.height,c=s.wrapperStyle,d=s.payloadUniqBy,u=s.payload,f=ff(ff({position:"absolute",width:i||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return Se.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(m){n.wrapperNode=m}},GIe(o,ff(ff({},this.props),{},{payload:_J(u,d,HIe)})))}}],[{key:"getWithHeight",value:function(n,s){var o=ff(ff({},this.defaultProps),n.props),i=o.layout;return i==="vertical"&&Zr(n.props.height)?{height:n.props.height}:i==="horizontal"?{width:n.props.width||s}:null}}])}(p.PureComponent);YC(qp,"displayName","Legend");YC(qp,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var M8=v1,KIe=ID,XIe=tc,R8=M8?M8.isConcatSpreadable:void 0;function YIe(e){return XIe(e)||KIe(e)||!!(R8&&e&&e[R8])}var JIe=YIe,QIe=uJ,ZIe=JIe;function CJ(e,t,r,n,s){var o=-1,i=e.length;for(r||(r=ZIe),s||(s=[]);++o<i;){var l=e[o];t>0&&r(l)?t>1?CJ(l,t-1,r,n,s):QIe(s,l):n||(s[s.length]=l)}return s}var AJ=CJ;function eOe(e){return function(t,r,n){for(var s=-1,o=Object(t),i=n(t),l=i.length;l--;){var c=i[e?l:++s];if(r(o[c],c,o)===!1)break}return t}}var tOe=eOe,rOe=tOe,nOe=rOe(),aOe=nOe,sOe=aOe,oOe=XC;function iOe(e,t){return e&&sOe(e,t,oOe)}var PJ=iOe,lOe=x1;function cOe(e,t){return function(r,n){if(r==null)return r;if(!lOe(r))return e(r,n);for(var s=r.length,o=t?s:-1,i=Object(r);(t?o--:++o<s)&&n(i[o],o,i)!==!1;);return r}}var dOe=cOe,uOe=PJ,fOe=dOe,mOe=fOe(uOe),MD=mOe,hOe=MD,pOe=x1;function gOe(e,t){var r=-1,n=pOe(e)?Array(e.length):[];return hOe(e,function(s,o,i){n[++r]=t(s,o,i)}),n}var EJ=gOe;function vOe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var xOe=vOe,L8=v0;function yOe(e,t){if(e!==t){var r=e!==void 0,n=e===null,s=e===e,o=L8(e),i=t!==void 0,l=t===null,c=t===t,d=L8(t);if(!l&&!d&&!o&&e>t||o&&i&&c&&!l&&!d||n&&i&&c||!r&&c||!s)return 1;if(!n&&!o&&!d&&e<t||d&&r&&s&&!n&&!o||l&&r&&s||!i&&s||!c)return-1}return 0}var bOe=yOe,wOe=bOe;function jOe(e,t,r){for(var n=-1,s=e.criteria,o=t.criteria,i=s.length,l=r.length;++n<i;){var c=wOe(s[n],o[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return e.index-t.index}var _Oe=jOe,TP=yD,NOe=bD,SOe=rf,COe=EJ,AOe=xOe,POe=hJ,EOe=_Oe,kOe=S0,IOe=tc;function OOe(e,t,r){t.length?t=TP(t,function(o){return IOe(o)?function(i){return NOe(i,o.length===1?o[0]:o)}:o}):t=[kOe];var n=-1;t=TP(t,POe(SOe));var s=COe(e,function(o,i,l){var c=TP(t,function(d){return d(o)});return{criteria:c,index:++n,value:o}});return AOe(s,function(o,i){return EOe(o,i,r)})}var TOe=OOe;function DOe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var MOe=DOe,ROe=MOe,F8=Math.max;function LOe(e,t,r){return t=F8(t===void 0?e.length-1:t,0),function(){for(var n=arguments,s=-1,o=F8(n.length-t,0),i=Array(o);++s<o;)i[s]=n[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=n[s];return l[t]=r(i),ROe(e,this,l)}}var FOe=LOe;function $Oe(e){return function(){return e}}var BOe=$Oe,qOe=Sg,zOe=function(){try{var e=qOe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),kJ=zOe,UOe=BOe,$8=kJ,VOe=S0,WOe=$8?function(e,t){return $8(e,"toString",{configurable:!0,enumerable:!1,value:UOe(t),writable:!0})}:VOe,HOe=WOe,GOe=800,KOe=16,XOe=Date.now;function YOe(e){var t=0,r=0;return function(){var n=XOe(),s=KOe-(n-r);if(r=n,s>0){if(++t>=GOe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var JOe=YOe,QOe=HOe,ZOe=JOe,eTe=ZOe(QOe),tTe=eTe,rTe=S0,nTe=FOe,aTe=tTe;function sTe(e,t){return aTe(nTe(e,t,rTe),e+"")}var oTe=sTe,iTe=pD,lTe=x1,cTe=OD,dTe=Bh;function uTe(e,t,r){if(!dTe(r))return!1;var n=typeof t;return(n=="number"?lTe(r)&&cTe(t,r.length):n=="string"&&t in r)?iTe(r[t],e):!1}var JC=uTe,fTe=AJ,mTe=TOe,hTe=oTe,B8=JC,pTe=hTe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&B8(e,t[0],t[1])?t=[]:r>2&&B8(t[0],t[1],t[2])&&(t=[t[0]]),mTe(e,fTe(t,1),[])}),gTe=pTe;const RD=Ga(gTe);function rw(e){"@babel/helpers - typeof";return rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rw(e)}function sO(){return sO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sO.apply(this,arguments)}function vTe(e,t){return wTe(e)||bTe(e,t)||yTe(e,t)||xTe()}function xTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yTe(e,t){if(e){if(typeof e=="string")return q8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q8(e,t)}}function q8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function wTe(e){if(Array.isArray(e))return e}function z8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function DP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z8(Object(r),!0).forEach(function(n){jTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jTe(e,t,r){return t=_Te(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Te(e){var t=NTe(e,"string");return rw(t)=="symbol"?t:t+""}function NTe(e,t){if(rw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function STe(e){return Array.isArray(e)&&Qo(e[0])&&Qo(e[1])?e.join(" ~ "):e}var CTe=function(t){var r=t.separator,n=r===void 0?" : ":r,s=t.contentStyle,o=s===void 0?{}:s,i=t.itemStyle,l=i===void 0?{}:i,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,f=t.formatter,h=t.itemSorter,m=t.wrapperClassName,v=t.labelClassName,g=t.label,y=t.labelFormatter,x=t.accessibilityLayer,b=x===void 0?!1:x,w=function(){if(u&&u.length){var I={padding:0,margin:0},R=(h?RD(u,h):u).map(function(M,U){if(M.type==="none")return null;var z=DP({display:"block",paddingTop:4,paddingBottom:4,color:M.color||"#000"},l),W=M.formatter||f||STe,$=M.value,ee=M.name,ve=$,_e=ee;if(W&&ve!=null&&_e!=null){var K=W($,ee,M,U,u);if(Array.isArray(K)){var q=vTe(K,2);ve=q[0],_e=q[1]}else ve=K}return Se.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(U),style:z},Qo(_e)?Se.createElement("span",{className:"recharts-tooltip-item-name"},_e):null,Qo(_e)?Se.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Se.createElement("span",{className:"recharts-tooltip-item-value"},ve),Se.createElement("span",{className:"recharts-tooltip-item-unit"},M.unit||""))});return Se.createElement("ul",{className:"recharts-tooltip-item-list",style:I},R)}return null},j=DP({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),_=DP({margin:0},d),C=!fa(g),P=C?g:"",E=ga("recharts-default-tooltip",m),A=ga("recharts-tooltip-label",v);C&&y&&u!==void 0&&u!==null&&(P=y(g,u));var F=b?{role:"status","aria-live":"assertive"}:{};return Se.createElement("div",sO({className:E,style:j},F),Se.createElement("p",{className:A,style:_},Se.isValidElement(P)?P:"".concat(P)),w())};function nw(e){"@babel/helpers - typeof";return nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nw(e)}function G2(e,t,r){return t=ATe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ATe(e){var t=PTe(e,"string");return nw(t)=="symbol"?t:t+""}function PTe(e,t){if(nw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sy="recharts-tooltip-wrapper",ETe={visibility:"hidden"};function kTe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return ga(sy,G2(G2(G2(G2({},"".concat(sy,"-right"),Zr(r)&&t&&Zr(t.x)&&r>=t.x),"".concat(sy,"-left"),Zr(r)&&t&&Zr(t.x)&&r<t.x),"".concat(sy,"-bottom"),Zr(n)&&t&&Zr(t.y)&&n>=t.y),"".concat(sy,"-top"),Zr(n)&&t&&Zr(t.y)&&n<t.y))}function U8(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,s=e.offsetTopLeft,o=e.position,i=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(o&&Zr(o[n]))return o[n];var u=r[n]-l-s,f=r[n]+s;if(t[n])return i[n]?u:f;if(i[n]){var h=u,m=c[n];return h<m?Math.max(f,c[n]):Math.max(u,c[n])}var v=f+l,g=c[n]+d;return v>g?Math.max(u,c[n]):Math.max(f,c[n])}function ITe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function OTe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,s=e.position,o=e.reverseDirection,i=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,u,f;return i.height>0&&i.width>0&&r?(u=U8({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:s,reverseDirection:o,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),f=U8({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:s,reverseDirection:o,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),d=ITe({translateX:u,translateY:f,useTranslate3d:l})):d=ETe,{cssProperties:d,cssClasses:kTe({translateX:u,translateY:f,coordinate:r})}}function Px(e){"@babel/helpers - typeof";return Px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Px(e)}function V8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function W8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V8(Object(r),!0).forEach(function(n){iO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OJ(n.key),n)}}function DTe(e,t,r){return t&&H8(e.prototype,t),r&&H8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MTe(e,t,r){return t=mN(t),RTe(e,IJ()?Reflect.construct(t,r||[],mN(e).constructor):t.apply(e,r))}function RTe(e,t){if(t&&(Px(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LTe(e)}function LTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IJ=function(){return!!e})()}function mN(e){return mN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mN(e)}function FTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},oO(e,t)}function iO(e,t,r){return t=OJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OJ(e){var t=$Te(e,"string");return Px(t)=="symbol"?t:t+""}function $Te(e,t){if(Px(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Px(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G8=1,BTe=function(e){function t(){var r;TTe(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=MTe(this,t,[].concat(s)),iO(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),iO(r,"handleKeyDown",function(i){if(i.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return FTe(t,e),DTe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>G8||Math.abs(n.height-this.state.lastBoundingBox.height)>G8)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,s;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,s=this.props,o=s.active,i=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,d=s.children,u=s.coordinate,f=s.hasPayload,h=s.isAnimationActive,m=s.offset,v=s.position,g=s.reverseDirection,y=s.useTranslate3d,x=s.viewBox,b=s.wrapperStyle,w=OTe({allowEscapeViewBox:i,coordinate:u,offsetTopLeft:m,position:v,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:x}),j=w.cssClasses,_=w.cssProperties,C=W8(W8({transition:h&&o?"transform ".concat(l,"ms ").concat(c):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&o&&f?"visible":"hidden",position:"absolute",top:0,left:0},b);return Se.createElement("div",{tabIndex:-1,className:j,style:C,ref:function(E){n.wrapperNode=E}},d)}}])}(p.PureComponent),qTe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},iu={isSsr:qTe(),get:function(t){return iu[t]},set:function(t,r){if(typeof t=="string")iu[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(s){iu[s]=t[s]})}}};function Ex(e){"@babel/helpers - typeof";return Ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ex(e)}function K8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function X8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K8(Object(r),!0).forEach(function(n){LD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DJ(n.key),n)}}function UTe(e,t,r){return t&&Y8(e.prototype,t),r&&Y8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VTe(e,t,r){return t=hN(t),WTe(e,TJ()?Reflect.construct(t,r||[],hN(e).constructor):t.apply(e,r))}function WTe(e,t){if(t&&(Ex(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HTe(e)}function HTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(TJ=function(){return!!e})()}function hN(e){return hN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hN(e)}function GTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},lO(e,t)}function LD(e,t,r){return t=DJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DJ(e){var t=KTe(e,"string");return Ex(t)=="symbol"?t:t+""}function KTe(e,t){if(Ex(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ex(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XTe(e){return e.dataKey}function YTe(e,t){return Se.isValidElement(e)?Se.cloneElement(e,t):typeof e=="function"?Se.createElement(e,t):Se.createElement(CTe,t)}var Bl=function(e){function t(){return zTe(this,t),VTe(this,t,arguments)}return GTe(t,e),UTe(t,[{key:"render",value:function(){var n=this,s=this.props,o=s.active,i=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,d=s.content,u=s.coordinate,f=s.filterNull,h=s.isAnimationActive,m=s.offset,v=s.payload,g=s.payloadUniqBy,y=s.position,x=s.reverseDirection,b=s.useTranslate3d,w=s.viewBox,j=s.wrapperStyle,_=v??[];f&&_.length&&(_=_J(v.filter(function(P){return P.value!=null&&(P.hide!==!0||n.props.includeHidden)}),g,XTe));var C=_.length>0;return Se.createElement(BTe,{allowEscapeViewBox:i,animationDuration:l,animationEasing:c,isAnimationActive:h,active:o,coordinate:u,hasPayload:C,offset:m,position:y,reverseDirection:x,useTranslate3d:b,viewBox:w,wrapperStyle:j},YTe(d,X8(X8({},this.props),{},{payload:_})))}}])}(p.PureComponent);LD(Bl,"displayName","Tooltip");LD(Bl,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!iu.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var JTe=tf,QTe=function(){return JTe.Date.now()},ZTe=QTe,e3e=/\s/;function t3e(e){for(var t=e.length;t--&&e3e.test(e.charAt(t)););return t}var r3e=t3e,n3e=r3e,a3e=/^\s+/;function s3e(e){return e&&e.slice(0,n3e(e)+1).replace(a3e,"")}var o3e=s3e,i3e=o3e,J8=Bh,l3e=v0,Q8=0/0,c3e=/^[-+]0x[0-9a-f]+$/i,d3e=/^0b[01]+$/i,u3e=/^0o[0-7]+$/i,f3e=parseInt;function m3e(e){if(typeof e=="number")return e;if(l3e(e))return Q8;if(J8(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=J8(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=i3e(e);var r=d3e.test(e);return r||u3e.test(e)?f3e(e.slice(2),r?2:8):c3e.test(e)?Q8:+e}var MJ=m3e,h3e=Bh,MP=ZTe,Z8=MJ,p3e="Expected a function",g3e=Math.max,v3e=Math.min;function x3e(e,t,r){var n,s,o,i,l,c,d=0,u=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(p3e);t=Z8(t)||0,h3e(r)&&(u=!!r.leading,f="maxWait"in r,o=f?g3e(Z8(r.maxWait)||0,t):o,h="trailing"in r?!!r.trailing:h);function m(C){var P=n,E=s;return n=s=void 0,d=C,i=e.apply(E,P),i}function v(C){return d=C,l=setTimeout(x,t),u?m(C):i}function g(C){var P=C-c,E=C-d,A=t-P;return f?v3e(A,o-E):A}function y(C){var P=C-c,E=C-d;return c===void 0||P>=t||P<0||f&&E>=o}function x(){var C=MP();if(y(C))return b(C);l=setTimeout(x,g(C))}function b(C){return l=void 0,h&&n?m(C):(n=s=void 0,i)}function w(){l!==void 0&&clearTimeout(l),d=0,n=c=s=l=void 0}function j(){return l===void 0?i:b(MP())}function _(){var C=MP(),P=y(C);if(n=arguments,s=this,c=C,P){if(l===void 0)return v(c);if(f)return clearTimeout(l),l=setTimeout(x,t),m(c)}return l===void 0&&(l=setTimeout(x,t)),i}return _.cancel=w,_.flush=j,_}var y3e=x3e,b3e=y3e,w3e=Bh,j3e="Expected a function";function _3e(e,t,r){var n=!0,s=!0;if(typeof e!="function")throw new TypeError(j3e);return w3e(r)&&(n="leading"in r?!!r.leading:n,s="trailing"in r?!!r.trailing:s),b3e(e,t,{leading:n,maxWait:t,trailing:s})}var N3e=_3e;const RJ=Ga(N3e);function aw(e){"@babel/helpers - typeof";return aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(e)}function eB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function K2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eB(Object(r),!0).forEach(function(n){S3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S3e(e,t,r){return t=C3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C3e(e){var t=A3e(e,"string");return aw(t)=="symbol"?t:t+""}function A3e(e,t){if(aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P3e(e,t){return O3e(e)||I3e(e,t)||k3e(e,t)||E3e()}function E3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k3e(e,t){if(e){if(typeof e=="string")return tB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tB(e,t)}}function tB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function I3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function O3e(e){if(Array.isArray(e))return e}var eb=p.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,s=n===void 0?{width:-1,height:-1}:n,o=e.width,i=o===void 0?"100%":o,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,f=e.minHeight,h=e.maxHeight,m=e.children,v=e.debounce,g=v===void 0?0:v,y=e.id,x=e.className,b=e.onResize,w=e.style,j=w===void 0?{}:w,_=p.useRef(null),C=p.useRef();C.current=b,p.useImperativeHandle(t,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var P=p.useState({containerWidth:s.width,containerHeight:s.height}),E=P3e(P,2),A=E[0],F=E[1],D=p.useCallback(function(R,M){F(function(U){var z=Math.round(R),W=Math.round(M);return U.containerWidth===z&&U.containerHeight===W?U:{containerWidth:z,containerHeight:W}})},[]);p.useEffect(function(){var R=function(ee){var ve,_e=ee[0].contentRect,K=_e.width,q=_e.height;D(K,q),(ve=C.current)===null||ve===void 0||ve.call(C,K,q)};g>0&&(R=RJ(R,g,{trailing:!0,leading:!1}));var M=new ResizeObserver(R),U=_.current.getBoundingClientRect(),z=U.width,W=U.height;return D(z,W),M.observe(_.current),function(){M.disconnect()}},[D,g]);var I=p.useMemo(function(){var R=A.containerWidth,M=A.containerHeight;if(R<0||M<0)return null;ou(Cp(i)||Cp(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),ou(!r||r>0,"The aspect(%s) must be greater than zero.",r);var U=Cp(i)?R:i,z=Cp(c)?M:c;r&&r>0&&(U?z=U/r:z&&(U=z*r),h&&z>h&&(z=h)),ou(U>0||z>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,U,z,i,c,u,f,r);var W=!Array.isArray(m)&&Rf(m.type).endsWith("Chart");return Se.Children.map(m,function($){return Se.isValidElement($)?p.cloneElement($,K2({width:U,height:z},W?{style:K2({height:"100%",width:"100%",maxHeight:z,maxWidth:U},$.props.style)}:{})):$})},[r,m,c,h,f,u,A,i]);return Se.createElement("div",{id:y?"".concat(y):void 0,className:ga("recharts-responsive-container",x),style:K2(K2({},j),{},{width:i,height:c,minWidth:u,minHeight:f,maxHeight:h}),ref:_},I)}),sw=function(t){return null};sw.displayName="Cell";function ow(e){"@babel/helpers - typeof";return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ow(e)}function rB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function cO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rB(Object(r),!0).forEach(function(n){T3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T3e(e,t,r){return t=D3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D3e(e){var t=M3e(e,"string");return ow(t)=="symbol"?t:t+""}function M3e(e,t){if(ow(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ow(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yg={widthCache:{},cacheCount:0},R3e=2e3,L3e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},nB="recharts_measurement_span";function F3e(e){var t=cO({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var tb=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||iu.isSsr)return{width:0,height:0};var n=F3e(r),s=JSON.stringify({text:t,copyStyle:n});if(Yg.widthCache[s])return Yg.widthCache[s];try{var o=document.getElementById(nB);o||(o=document.createElement("span"),o.setAttribute("id",nB),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var i=cO(cO({},L3e),n);Object.assign(o.style,i),o.textContent="".concat(t);var l=o.getBoundingClientRect(),c={width:l.width,height:l.height};return Yg.widthCache[s]=c,++Yg.cacheCount>R3e&&(Yg.cacheCount=0,Yg.widthCache={}),c}catch{return{width:0,height:0}}},$3e=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function iw(e){"@babel/helpers - typeof";return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(e)}function pN(e,t){return U3e(e)||z3e(e,t)||q3e(e,t)||B3e()}function B3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q3e(e,t){if(e){if(typeof e=="string")return aB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aB(e,t)}}function aB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function z3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function U3e(e){if(Array.isArray(e))return e}function V3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H3e(n.key),n)}}function W3e(e,t,r){return t&&sB(e.prototype,t),r&&sB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H3e(e){var t=G3e(e,"string");return iw(t)=="symbol"?t:t+""}function G3e(e,t){if(iw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oB=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,iB=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,K3e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,X3e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,LJ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Y3e=Object.keys(LJ),Rv="NaN";function J3e(e,t){return e*LJ[t]}var X2=function(){function e(t,r){V3e(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!K3e.test(r)&&(this.num=NaN,this.unit=""),Y3e.includes(r)&&(this.num=J3e(t,r),this.unit="px")}return W3e(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,s=(n=X3e.exec(r))!==null&&n!==void 0?n:[],o=pN(s,3),i=o[1],l=o[2];return new e(parseFloat(i),l??"")}}])}();function FJ(e){if(e.includes(Rv))return Rv;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=oB.exec(t))!==null&&r!==void 0?r:[],s=pN(n,4),o=s[1],i=s[2],l=s[3],c=X2.parse(o??""),d=X2.parse(l??""),u=i==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return Rv;t=t.replace(oB,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=iB.exec(t))!==null&&f!==void 0?f:[],m=pN(h,4),v=m[1],g=m[2],y=m[3],x=X2.parse(v??""),b=X2.parse(y??""),w=g==="+"?x.add(b):x.subtract(b);if(w.isNaN())return Rv;t=t.replace(iB,w.toString())}return t}var lB=/\(([^()]*)\)/;function Q3e(e){for(var t=e;t.includes("(");){var r=lB.exec(t),n=pN(r,2),s=n[1];t=t.replace(lB,FJ(s))}return t}function Z3e(e){var t=e.replace(/\s+/g,"");return t=Q3e(t),t=FJ(t),t}function e4e(e){try{return Z3e(e)}catch{return Rv}}function RP(e){var t=e4e(e.slice(5,-1));return t===Rv?"":t}var t4e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],r4e=["dx","dy","angle","className","breakAll"];function dO(){return dO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dO.apply(this,arguments)}function cB(e,t){if(e==null)return{};var r=n4e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function n4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function dB(e,t){return i4e(e)||o4e(e,t)||s4e(e,t)||a4e()}function a4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s4e(e,t){if(e){if(typeof e=="string")return uB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uB(e,t)}}function uB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function i4e(e){if(Array.isArray(e))return e}var $J=/[ \f\n\r\t\v\u2028\u2029]+/,BJ=function(t){var r=t.children,n=t.breakAll,s=t.style;try{var o=[];fa(r)||(n?o=r.toString().split(""):o=r.toString().split($J));var i=o.map(function(c){return{word:c,width:tb(c,s).width}}),l=n?0:tb("",s).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}},l4e=function(t,r,n,s,o){var i=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=Zr(i),f=l,h=function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U.reduce(function(z,W){var $=W.word,ee=W.width,ve=z[z.length-1];if(ve&&(s==null||o||ve.width+ee+n<Number(s)))ve.words.push($),ve.width+=ee+n;else{var _e={words:[$],width:ee};z.push(_e)}return z},[])},m=h(r),v=function(U){return U.reduce(function(z,W){return z.width>W.width?z:W})};if(!u)return m;for(var g="",y=function(U){var z=f.slice(0,U),W=BJ({breakAll:d,style:c,children:z+g}).wordsWithComputedWidth,$=h(W),ee=$.length>i||v($).width>Number(s);return[ee,$]},x=0,b=f.length-1,w=0,j;x<=b&&w<=f.length-1;){var _=Math.floor((x+b)/2),C=_-1,P=y(C),E=dB(P,2),A=E[0],F=E[1],D=y(_),I=dB(D,1),R=I[0];if(!A&&!R&&(x=_+1),A&&R&&(b=_-1),!A&&R){j=F;break}w++}return j||m},fB=function(t){var r=fa(t)?[]:t.toString().split($J);return[{words:r}]},c4e=function(t){var r=t.width,n=t.scaleToFit,s=t.children,o=t.style,i=t.breakAll,l=t.maxLines;if((r||n)&&!iu.isSsr){var c,d,u=BJ({breakAll:i,children:s,style:o});if(u){var f=u.wordsWithComputedWidth,h=u.spaceWidth;c=f,d=h}else return fB(s);return l4e({breakAll:i,children:s,maxLines:l,style:o},c,d,r,n)}return fB(s)},mB="#808080",lg=function(t){var r=t.x,n=r===void 0?0:r,s=t.y,o=s===void 0?0:s,i=t.lineHeight,l=i===void 0?"1em":i,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,f=u===void 0?!1:u,h=t.textAnchor,m=h===void 0?"start":h,v=t.verticalAnchor,g=v===void 0?"end":v,y=t.fill,x=y===void 0?mB:y,b=cB(t,t4e),w=p.useMemo(function(){return c4e({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:f,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,f,b.style,b.width]),j=b.dx,_=b.dy,C=b.angle,P=b.className,E=b.breakAll,A=cB(b,r4e);if(!Qo(n)||!Qo(o))return null;var F=n+(Zr(j)?j:0),D=o+(Zr(_)?_:0),I;switch(g){case"start":I=RP("calc(".concat(d,")"));break;case"middle":I=RP("calc(".concat((w.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:I=RP("calc(".concat(w.length-1," * -").concat(l,")"));break}var R=[];if(f){var M=w[0].width,U=b.width;R.push("scale(".concat((Zr(U)?U/M:1)/M,")"))}return C&&R.push("rotate(".concat(C,", ").concat(F,", ").concat(D,")")),R.length&&(A.transform=R.join(" ")),Se.createElement("text",dO({},Kn(A,!0),{x:F,y:D,className:ga("recharts-text",P),textAnchor:m,fill:x.includes("url")?mB:x}),w.map(function(z,W){var $=z.words.join(E?"":" ");return Se.createElement("tspan",{x:F,dy:W===0?I:l,key:"".concat($,"-").concat(W)},$)}))};function dh(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function d4e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function FD(e){let t,r,n;e.length!==2?(t=dh,r=(l,c)=>dh(e(l),c),n=(l,c)=>e(l)-c):(t=e===dh||e===d4e?e:u4e,r=e,n=e);function s(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){const f=s(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:s,center:i,right:o}}function u4e(){return 0}function qJ(e){return e===null?NaN:+e}function*f4e(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const m4e=FD(dh),h4e=m4e.right;FD(qJ).center;const y1=h4e;class hB extends Map{constructor(t,r=v4e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,s]of t)this.set(n,s)}get(t){return super.get(pB(this,t))}has(t){return super.has(pB(this,t))}set(t,r){return super.set(p4e(this,t),r)}delete(t){return super.delete(g4e(this,t))}}function pB({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function p4e({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function g4e({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function v4e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function x4e(e=dh){if(e===dh)return zJ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function zJ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const y4e=Math.sqrt(50),b4e=Math.sqrt(10),w4e=Math.sqrt(2);function gN(e,t,r){const n=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(n)),o=n/Math.pow(10,s),i=o>=y4e?10:o>=b4e?5:o>=w4e?2:1;let l,c,d;return s<0?(d=Math.pow(10,-s)/i,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,s)*i,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?gN(e,t,r*2):[l,c,d]}function uO(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[s,o,i]=n?gN(t,e,r):gN(e,t,r);if(!(o>=s))return[];const l=o-s+1,c=new Array(l);if(n)if(i<0)for(let d=0;d<l;++d)c[d]=(o-d)/-i;else for(let d=0;d<l;++d)c[d]=(o-d)*i;else if(i<0)for(let d=0;d<l;++d)c[d]=(s+d)/-i;else for(let d=0;d<l;++d)c[d]=(s+d)*i;return c}function fO(e,t,r){return t=+t,e=+e,r=+r,gN(e,t,r)[2]}function mO(e,t,r){t=+t,e=+e,r=+r;const n=t<e,s=n?fO(t,e,r):fO(e,t,r);return(n?-1:1)*(s<0?1/-s:s)}function gB(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let s of e)(s=t(s,++n,e))!=null&&(r<s||r===void 0&&s>=s)&&(r=s)}return r}function vB(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let s of e)(s=t(s,++n,e))!=null&&(r>s||r===void 0&&s>=s)&&(r=s)}return r}function UJ(e,t,r=0,n=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(s=s===void 0?zJ:x4e(s);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*f/c+h)),v=Math.min(n,Math.floor(t+(c-d)*f/c+h));UJ(e,t,m,v,s)}const o=e[t];let i=r,l=n;for(oy(e,r,t),s(e[n],o)>0&&oy(e,r,n);i<l;){for(oy(e,i,l),++i,--l;s(e[i],o)<0;)++i;for(;s(e[l],o)>0;)--l}s(e[r],o)===0?oy(e,r,l):(++l,oy(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function oy(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function j4e(e,t,r){if(e=Float64Array.from(f4e(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return vB(e);if(t>=1)return gB(e);var n,s=(n-1)*t,o=Math.floor(s),i=gB(UJ(e,o).subarray(0,o+1)),l=vB(e.subarray(o+1));return i+(l-i)*(s-o)}}function _4e(e,t,r=qJ){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,s=(n-1)*t,o=Math.floor(s),i=+r(e[o],o,e),l=+r(e[o+1],o+1,e);return i+(l-i)*(s-o)}}function N4e(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var n=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,o=new Array(s);++n<s;)o[n]=e+n*r;return o}function Id(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function sm(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const hO=Symbol("implicit");function $D(){var e=new hB,t=[],r=[],n=hO;function s(o){let i=e.get(o);if(i===void 0){if(n!==hO)return n;e.set(o,i=t.push(o)-1)}return r[i%r.length]}return s.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new hB;for(const i of o)e.has(i)||e.set(i,t.push(i)-1);return s},s.range=function(o){return arguments.length?(r=Array.from(o),s):r.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.copy=function(){return $D(t,r).unknown(n)},Id.apply(s,arguments),s}function lw(){var e=$D().unknown(void 0),t=e.domain,r=e.range,n=0,s=1,o,i,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var h=t().length,m=s<n,v=m?s:n,g=m?n:s;o=(g-v)/Math.max(1,h-c+d*2),l&&(o=Math.floor(o)),v+=(g-v-o*(h-c))*u,i=o*(1-c),l&&(v=Math.round(v),i=Math.round(i));var y=N4e(h).map(function(x){return v+o*x});return r(m?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,s]=h,n=+n,s=+s,f()):[n,s]},e.rangeRound=function(h){return[n,s]=h,n=+n,s=+s,l=!0,f()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,f()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.copy=function(){return lw(t(),[n,s]).round(l).paddingInner(c).paddingOuter(d).align(u)},Id.apply(f(),arguments)}function VJ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return VJ(t())},e}function rb(){return VJ(lw.apply(null,arguments).paddingInner(1))}function BD(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function WJ(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function b1(){}var cw=.7,vN=1/cw,rx="\\s*([+-]?\\d+)\\s*",dw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",S4e=/^#([0-9a-f]{3,8})$/,C4e=new RegExp(`^rgb\\(${rx},${rx},${rx}\\)$`),A4e=new RegExp(`^rgb\\(${Hu},${Hu},${Hu}\\)$`),P4e=new RegExp(`^rgba\\(${rx},${rx},${rx},${dw}\\)$`),E4e=new RegExp(`^rgba\\(${Hu},${Hu},${Hu},${dw}\\)$`),k4e=new RegExp(`^hsl\\(${dw},${Hu},${Hu}\\)$`),I4e=new RegExp(`^hsla\\(${dw},${Hu},${Hu},${dw}\\)$`),xB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};BD(b1,uw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:yB,formatHex:yB,formatHex8:O4e,formatHsl:T4e,formatRgb:bB,toString:bB});function yB(){return this.rgb().formatHex()}function O4e(){return this.rgb().formatHex8()}function T4e(){return HJ(this).formatHsl()}function bB(){return this.rgb().formatRgb()}function uw(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=S4e.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?wB(t):r===3?new Hl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Y2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Y2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=C4e.exec(e))?new Hl(t[1],t[2],t[3],1):(t=A4e.exec(e))?new Hl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=P4e.exec(e))?Y2(t[1],t[2],t[3],t[4]):(t=E4e.exec(e))?Y2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=k4e.exec(e))?NB(t[1],t[2]/100,t[3]/100,1):(t=I4e.exec(e))?NB(t[1],t[2]/100,t[3]/100,t[4]):xB.hasOwnProperty(e)?wB(xB[e]):e==="transparent"?new Hl(NaN,NaN,NaN,0):null}function wB(e){return new Hl(e>>16&255,e>>8&255,e&255,1)}function Y2(e,t,r,n){return n<=0&&(e=t=r=NaN),new Hl(e,t,r,n)}function D4e(e){return e instanceof b1||(e=uw(e)),e?(e=e.rgb(),new Hl(e.r,e.g,e.b,e.opacity)):new Hl}function pO(e,t,r,n){return arguments.length===1?D4e(e):new Hl(e,t,r,n??1)}function Hl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}BD(Hl,pO,WJ(b1,{brighter(e){return e=e==null?vN:Math.pow(vN,e),new Hl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?cw:Math.pow(cw,e),new Hl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Hl(zp(this.r),zp(this.g),zp(this.b),xN(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:jB,formatHex:jB,formatHex8:M4e,formatRgb:_B,toString:_B}));function jB(){return`#${Ap(this.r)}${Ap(this.g)}${Ap(this.b)}`}function M4e(){return`#${Ap(this.r)}${Ap(this.g)}${Ap(this.b)}${Ap((isNaN(this.opacity)?1:this.opacity)*255)}`}function _B(){const e=xN(this.opacity);return`${e===1?"rgb(":"rgba("}${zp(this.r)}, ${zp(this.g)}, ${zp(this.b)}${e===1?")":`, ${e})`}`}function xN(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function zp(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ap(e){return e=zp(e),(e<16?"0":"")+e.toString(16)}function NB(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new eu(e,t,r,n)}function HJ(e){if(e instanceof eu)return new eu(e.h,e.s,e.l,e.opacity);if(e instanceof b1||(e=uw(e)),!e)return new eu;if(e instanceof eu)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),o=Math.max(t,r,n),i=NaN,l=o-s,c=(o+s)/2;return l?(t===o?i=(r-n)/l+(r<n)*6:r===o?i=(n-t)/l+2:i=(t-r)/l+4,l/=c<.5?o+s:2-o-s,i*=60):l=c>0&&c<1?0:i,new eu(i,l,c,e.opacity)}function R4e(e,t,r,n){return arguments.length===1?HJ(e):new eu(e,t,r,n??1)}function eu(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}BD(eu,R4e,WJ(b1,{brighter(e){return e=e==null?vN:Math.pow(vN,e),new eu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?cw:Math.pow(cw,e),new eu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new Hl(LP(e>=240?e-240:e+120,s,n),LP(e,s,n),LP(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new eu(SB(this.h),J2(this.s),J2(this.l),xN(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=xN(this.opacity);return`${e===1?"hsl(":"hsla("}${SB(this.h)}, ${J2(this.s)*100}%, ${J2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function SB(e){return e=(e||0)%360,e<0?e+360:e}function J2(e){return Math.max(0,Math.min(1,e||0))}function LP(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const qD=e=>()=>e;function L4e(e,t){return function(r){return e+r*t}}function F4e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function $4e(e){return(e=+e)==1?GJ:function(t,r){return r-t?F4e(t,r,e):qD(isNaN(t)?r:t)}}function GJ(e,t){var r=t-e;return r?L4e(e,r):qD(isNaN(e)?t:e)}const CB=function e(t){var r=$4e(t);function n(s,o){var i=r((s=pO(s)).r,(o=pO(o)).r),l=r(s.g,o.g),c=r(s.b,o.b),d=GJ(s.opacity,o.opacity);return function(u){return s.r=i(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return n.gamma=e,n}(1);function B4e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),s;return function(o){for(s=0;s<r;++s)n[s]=e[s]*(1-o)+t[s]*o;return n}}function q4e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function z4e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,s=new Array(n),o=new Array(r),i;for(i=0;i<n;++i)s[i]=C0(e[i],t[i]);for(;i<r;++i)o[i]=t[i];return function(l){for(i=0;i<n;++i)o[i]=s[i](l);return o}}function U4e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function yN(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function V4e(e,t){var r={},n={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=C0(e[s],t[s]):n[s]=t[s];return function(o){for(s in r)n[s]=r[s](o);return n}}var gO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,FP=new RegExp(gO.source,"g");function W4e(e){return function(){return e}}function H4e(e){return function(t){return e(t)+""}}function G4e(e,t){var r=gO.lastIndex=FP.lastIndex=0,n,s,o,i=-1,l=[],c=[];for(e=e+"",t=t+"";(n=gO.exec(e))&&(s=FP.exec(t));)(o=s.index)>r&&(o=t.slice(r,o),l[i]?l[i]+=o:l[++i]=o),(n=n[0])===(s=s[0])?l[i]?l[i]+=s:l[++i]=s:(l[++i]=null,c.push({i,x:yN(n,s)})),r=FP.lastIndex;return r<t.length&&(o=t.slice(r),l[i]?l[i]+=o:l[++i]=o),l.length<2?c[0]?H4e(c[0].x):W4e(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function C0(e,t){var r=typeof t,n;return t==null||r==="boolean"?qD(t):(r==="number"?yN:r==="string"?(n=uw(t))?(t=n,CB):G4e:t instanceof uw?CB:t instanceof Date?U4e:q4e(t)?B4e:Array.isArray(t)?z4e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?V4e:yN)(e,t)}function zD(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function K4e(e,t){t===void 0&&(t=e,e=C0);for(var r=0,n=t.length-1,s=t[0],o=new Array(n<0?0:n);r<n;)o[r]=e(s,s=t[++r]);return function(i){var l=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return o[l](i-l)}}function X4e(e){return function(){return e}}function bN(e){return+e}var AB=[0,1];function jl(e){return e}function vO(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:X4e(isNaN(t)?NaN:.5)}function Y4e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function J4e(e,t,r){var n=e[0],s=e[1],o=t[0],i=t[1];return s<n?(n=vO(s,n),o=r(i,o)):(n=vO(n,s),o=r(o,i)),function(l){return o(n(l))}}function Q4e(e,t,r){var n=Math.min(e.length,t.length)-1,s=new Array(n),o=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)s[i]=vO(e[i],e[i+1]),o[i]=r(t[i],t[i+1]);return function(l){var c=y1(e,l,1,n)-1;return o[c](s[c](l))}}function w1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function QC(){var e=AB,t=AB,r=C0,n,s,o,i=jl,l,c,d;function u(){var h=Math.min(e.length,t.length);return i!==jl&&(i=Y4e(e[0],e[h-1])),l=h>2?Q4e:J4e,c=d=null,f}function f(h){return h==null||isNaN(h=+h)?o:(c||(c=l(e.map(n),t,r)))(n(i(h)))}return f.invert=function(h){return i(s((d||(d=l(t,e.map(n),yN)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,bN),u()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),u()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=zD,u()},f.clamp=function(h){return arguments.length?(i=h?!0:jl,u()):i!==jl},f.interpolate=function(h){return arguments.length?(r=h,u()):r},f.unknown=function(h){return arguments.length?(o=h,f):o},function(h,m){return n=h,s=m,u()}}function UD(){return QC()(jl,jl)}function Z4e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function wN(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function kx(e){return e=wN(Math.abs(e)),e?e[1]:NaN}function eDe(e,t){return function(r,n){for(var s=r.length,o=[],i=0,l=e[0],c=0;s>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),o.push(r.substring(s-=l,s+l)),!((c+=l+1)>n));)l=e[i=(i+1)%e.length];return o.reverse().join(t)}}function tDe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var rDe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fw(e){if(!(t=rDe.exec(e)))throw new Error("invalid format: "+e);var t;return new VD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}fw.prototype=VD.prototype;function VD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}VD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function nDe(e){e:for(var t=e.length,r=1,n=-1,s;r<t;++r)switch(e[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(s+1):e}var KJ;function aDe(e,t){var r=wN(e,t);if(!r)return e+"";var n=r[0],s=r[1],o=s-(KJ=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,i=n.length;return o===i?n:o>i?n+new Array(o-i+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+wN(e,Math.max(0,t+o-1))[0]}function PB(e,t){var r=wN(e,t);if(!r)return e+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const EB={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Z4e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>PB(e*100,t),r:PB,s:aDe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function kB(e){return e}var IB=Array.prototype.map,OB=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function sDe(e){var t=e.grouping===void 0||e.thousands===void 0?kB:eDe(IB.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?kB:tDe(IB.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=fw(f);var h=f.fill,m=f.align,v=f.sign,g=f.symbol,y=f.zero,x=f.width,b=f.comma,w=f.precision,j=f.trim,_=f.type;_==="n"?(b=!0,_="g"):EB[_]||(w===void 0&&(w=12),j=!0,_="g"),(y||h==="0"&&m==="=")&&(y=!0,h="0",m="=");var C=g==="$"?r:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",P=g==="$"?n:/[%p]/.test(_)?i:"",E=EB[_],A=/[defgprs%]/.test(_);w=w===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function F(D){var I=C,R=P,M,U,z;if(_==="c")R=E(D)+R,D="";else{D=+D;var W=D<0||1/D<0;if(D=isNaN(D)?c:E(Math.abs(D),w),j&&(D=nDe(D)),W&&+D==0&&v!=="+"&&(W=!1),I=(W?v==="("?v:l:v==="-"||v==="("?"":v)+I,R=(_==="s"?OB[8+KJ/3]:"")+R+(W&&v==="("?")":""),A){for(M=-1,U=D.length;++M<U;)if(z=D.charCodeAt(M),48>z||z>57){R=(z===46?s+D.slice(M+1):D.slice(M))+R,D=D.slice(0,M);break}}}b&&!y&&(D=t(D,1/0));var $=I.length+D.length+R.length,ee=$<x?new Array(x-$+1).join(h):"";switch(b&&y&&(D=t(ee+D,ee.length?x-R.length:1/0),ee=""),m){case"<":D=I+D+R+ee;break;case"=":D=I+ee+D+R;break;case"^":D=ee.slice(0,$=ee.length>>1)+I+D+R+ee.slice($);break;default:D=ee+I+D+R;break}return o(D)}return F.toString=function(){return f+""},F}function u(f,h){var m=d((f=fw(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(kx(h)/3)))*3,g=Math.pow(10,-v),y=OB[8+v/3];return function(x){return m(g*x)+y}}return{format:d,formatPrefix:u}}var Q2,WD,XJ;oDe({thousands:",",grouping:[3],currency:["$",""]});function oDe(e){return Q2=sDe(e),WD=Q2.format,XJ=Q2.formatPrefix,Q2}function iDe(e){return Math.max(0,-kx(Math.abs(e)))}function lDe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(kx(t)/3)))*3-kx(Math.abs(e)))}function cDe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,kx(t)-kx(e))+1}function YJ(e,t,r,n){var s=mO(e,t,r),o;switch(n=fw(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(o=lDe(s,i))&&(n.precision=o),XJ(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=cDe(s,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=iDe(s))&&(n.precision=o-(n.type==="%")*2);break}}return WD(n)}function qh(e){var t=e.domain;return e.ticks=function(r){var n=t();return uO(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var s=t();return YJ(s[0],s[s.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),s=0,o=n.length-1,i=n[s],l=n[o],c,d,u=10;for(l<i&&(d=i,i=l,l=d,d=s,s=o,o=d);u-- >0;){if(d=fO(i,l,r),d===c)return n[s]=i,n[o]=l,t(n);if(d>0)i=Math.floor(i/d)*d,l=Math.ceil(l/d)*d;else if(d<0)i=Math.ceil(i*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function jN(){var e=UD();return e.copy=function(){return w1(e,jN())},Id.apply(e,arguments),qh(e)}function JJ(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,bN),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return JJ(e).unknown(t)},e=arguments.length?Array.from(e,bN):[0,1],qh(r)}function QJ(e,t){e=e.slice();var r=0,n=e.length-1,s=e[r],o=e[n],i;return o<s&&(i=r,r=n,n=i,i=s,s=o,o=i),e[r]=t.floor(s),e[n]=t.ceil(o),e}function TB(e){return Math.log(e)}function DB(e){return Math.exp(e)}function dDe(e){return-Math.log(-e)}function uDe(e){return-Math.exp(-e)}function fDe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function mDe(e){return e===10?fDe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function hDe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function MB(e){return(t,r)=>-e(-t,r)}function HD(e){const t=e(TB,DB),r=t.domain;let n=10,s,o;function i(){return s=hDe(n),o=mDe(n),r()[0]<0?(s=MB(s),o=MB(o),e(dDe,uDe)):e(TB,DB),t}return t.base=function(l){return arguments.length?(n=+l,i()):n},t.domain=function(l){return arguments.length?(r(l),i()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let h=s(d),m=s(u),v,g;const y=l==null?10:+l;let x=[];if(!(n%1)&&m-h<y){if(h=Math.floor(h),m=Math.ceil(m),d>0){for(;h<=m;++h)for(v=1;v<n;++v)if(g=h<0?v/o(-h):v*o(h),!(g<d)){if(g>u)break;x.push(g)}}else for(;h<=m;++h)for(v=n-1;v>=1;--v)if(g=h>0?v/o(-h):v*o(h),!(g<d)){if(g>u)break;x.push(g)}x.length*2<y&&(x=uO(d,u,y))}else x=uO(h,m,Math.min(m-h,y)).map(o);return f?x.reverse():x},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=fw(c)).precision==null&&(c.trim=!0),c=WD(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let f=u/o(Math.round(s(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},t.nice=()=>r(QJ(r(),{floor:l=>o(Math.floor(s(l))),ceil:l=>o(Math.ceil(s(l)))})),t}function ZJ(){const e=HD(QC()).domain([1,10]);return e.copy=()=>w1(e,ZJ()).base(e.base()),Id.apply(e,arguments),e}function RB(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function LB(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function GD(e){var t=1,r=e(RB(t),LB(t));return r.constant=function(n){return arguments.length?e(RB(t=+n),LB(t)):t},qh(r)}function eQ(){var e=GD(QC());return e.copy=function(){return w1(e,eQ()).constant(e.constant())},Id.apply(e,arguments)}function FB(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function pDe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function gDe(e){return e<0?-e*e:e*e}function KD(e){var t=e(jl,jl),r=1;function n(){return r===1?e(jl,jl):r===.5?e(pDe,gDe):e(FB(r),FB(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,n()):r},qh(t)}function XD(){var e=KD(QC());return e.copy=function(){return w1(e,XD()).exponent(e.exponent())},Id.apply(e,arguments),e}function vDe(){return XD.apply(null,arguments).exponent(.5)}function $B(e){return Math.sign(e)*e*e}function xDe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function tQ(){var e=UD(),t=[0,1],r=!1,n;function s(o){var i=xDe(e(o));return isNaN(i)?n:r?Math.round(i):i}return s.invert=function(o){return e.invert($B(o))},s.domain=function(o){return arguments.length?(e.domain(o),s):e.domain()},s.range=function(o){return arguments.length?(e.range((t=Array.from(o,bN)).map($B)),s):t.slice()},s.rangeRound=function(o){return s.range(o).round(!0)},s.round=function(o){return arguments.length?(r=!!o,s):r},s.clamp=function(o){return arguments.length?(e.clamp(o),s):e.clamp()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.copy=function(){return tQ(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Id.apply(s,arguments),qh(s)}function rQ(){var e=[],t=[],r=[],n;function s(){var i=0,l=Math.max(1,t.length);for(r=new Array(l-1);++i<l;)r[i-1]=_4e(e,i/l);return o}function o(i){return i==null||isNaN(i=+i)?n:t[y1(r,i)]}return o.invertExtent=function(i){var l=t.indexOf(i);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let l of i)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(dh),s()},o.range=function(i){return arguments.length?(t=Array.from(i),s()):t.slice()},o.unknown=function(i){return arguments.length?(n=i,o):n},o.quantiles=function(){return r.slice()},o.copy=function(){return rQ().domain(e).range(t).unknown(n)},Id.apply(o,arguments)}function nQ(){var e=0,t=1,r=1,n=[.5],s=[0,1],o;function i(c){return c!=null&&c<=c?s[y1(n,c,0,r)]:o}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},i.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,l()):s.slice()},i.invertExtent=function(c){var d=s.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},i.unknown=function(c){return arguments.length&&(o=c),i},i.thresholds=function(){return n.slice()},i.copy=function(){return nQ().domain([e,t]).range(s).unknown(o)},Id.apply(qh(i),arguments)}function aQ(){var e=[.5],t=[0,1],r,n=1;function s(o){return o!=null&&o<=o?t[y1(e,o,0,n)]:r}return s.domain=function(o){return arguments.length?(e=Array.from(o),n=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(o){return arguments.length?(t=Array.from(o),n=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},s.unknown=function(o){return arguments.length?(r=o,s):r},s.copy=function(){return aQ().domain(e).range(t).unknown(r)},Id.apply(s,arguments)}const $P=new Date,BP=new Date;function Zo(e,t,r,n){function s(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return s.floor=o=>(e(o=new Date(+o)),o),s.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),s.round=o=>{const i=s(o),l=s.ceil(o);return o-i<l-o?i:l},s.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),s.range=(o,i,l)=>{const c=[];if(o=s.ceil(o),l=l==null?1:Math.floor(l),!(o<i)||!(l>0))return c;let d;do c.push(d=new Date(+o)),t(o,l),e(o);while(d<o&&o<i);return c},s.filter=o=>Zo(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,l)=>{if(i>=i)if(l<0)for(;++l<=0;)for(;t(i,-1),!o(i););else for(;--l>=0;)for(;t(i,1),!o(i););}),r&&(s.count=(o,i)=>($P.setTime(+o),BP.setTime(+i),e($P),e(BP),Math.floor(r($P,BP))),s.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?s.filter(n?i=>n(i)%o===0:i=>s.count(0,i)%o===0):s)),s}const _N=Zo(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);_N.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Zo(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):_N);_N.range;const Ef=1e3,pd=Ef*60,kf=pd*60,Xf=kf*24,YD=Xf*7,BB=Xf*30,qP=Xf*365,Pp=Zo(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ef)},(e,t)=>(t-e)/Ef,e=>e.getUTCSeconds());Pp.range;const JD=Zo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ef)},(e,t)=>{e.setTime(+e+t*pd)},(e,t)=>(t-e)/pd,e=>e.getMinutes());JD.range;const QD=Zo(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*pd)},(e,t)=>(t-e)/pd,e=>e.getUTCMinutes());QD.range;const ZD=Zo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ef-e.getMinutes()*pd)},(e,t)=>{e.setTime(+e+t*kf)},(e,t)=>(t-e)/kf,e=>e.getHours());ZD.range;const eM=Zo(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*kf)},(e,t)=>(t-e)/kf,e=>e.getUTCHours());eM.range;const j1=Zo(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*pd)/Xf,e=>e.getDate()-1);j1.range;const ZC=Zo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Xf,e=>e.getUTCDate()-1);ZC.range;const sQ=Zo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Xf,e=>Math.floor(e/Xf));sQ.range;function Ag(e){return Zo(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*pd)/YD)}const e5=Ag(0),NN=Ag(1),yDe=Ag(2),bDe=Ag(3),Ix=Ag(4),wDe=Ag(5),jDe=Ag(6);e5.range;NN.range;yDe.range;bDe.range;Ix.range;wDe.range;jDe.range;function Pg(e){return Zo(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/YD)}const t5=Pg(0),SN=Pg(1),_De=Pg(2),NDe=Pg(3),Ox=Pg(4),SDe=Pg(5),CDe=Pg(6);t5.range;SN.range;_De.range;NDe.range;Ox.range;SDe.range;CDe.range;const tM=Zo(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());tM.range;const rM=Zo(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());rM.range;const Yf=Zo(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Yf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Zo(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Yf.range;const Jf=Zo(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Jf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Zo(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Jf.range;function oQ(e,t,r,n,s,o){const i=[[Pp,1,Ef],[Pp,5,5*Ef],[Pp,15,15*Ef],[Pp,30,30*Ef],[o,1,pd],[o,5,5*pd],[o,15,15*pd],[o,30,30*pd],[s,1,kf],[s,3,3*kf],[s,6,6*kf],[s,12,12*kf],[n,1,Xf],[n,2,2*Xf],[r,1,YD],[t,1,BB],[t,3,3*BB],[e,1,qP]];function l(d,u,f){const h=u<d;h&&([d,u]=[u,d]);const m=f&&typeof f.range=="function"?f:c(d,u,f),v=m?m.range(d,+u+1):[];return h?v.reverse():v}function c(d,u,f){const h=Math.abs(u-d)/f,m=FD(([,,y])=>y).right(i,h);if(m===i.length)return e.every(mO(d/qP,u/qP,f));if(m===0)return _N.every(Math.max(mO(d,u,f),1));const[v,g]=i[h/i[m-1][2]<i[m][2]/h?m-1:m];return v.every(g)}return[l,c]}const[ADe,PDe]=oQ(Jf,rM,t5,sQ,eM,QD),[EDe,kDe]=oQ(Yf,tM,e5,j1,ZD,JD);function zP(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function UP(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function iy(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function IDe(e){var t=e.dateTime,r=e.date,n=e.time,s=e.periods,o=e.days,i=e.shortDays,l=e.months,c=e.shortMonths,d=ly(s),u=cy(s),f=ly(o),h=cy(o),m=ly(i),v=cy(i),g=ly(l),y=cy(l),x=ly(c),b=cy(c),w={a:W,A:$,b:ee,B:ve,c:null,d:HB,e:HB,f:eMe,g:dMe,G:fMe,H:JDe,I:QDe,j:ZDe,L:iQ,m:tMe,M:rMe,p:_e,q:K,Q:XB,s:YB,S:nMe,u:aMe,U:sMe,V:oMe,w:iMe,W:lMe,x:null,X:null,y:cMe,Y:uMe,Z:mMe,"%":KB},j={a:q,A:Y,b:J,B:fe,c:null,d:GB,e:GB,f:vMe,g:AMe,G:EMe,H:hMe,I:pMe,j:gMe,L:cQ,m:xMe,M:yMe,p:Z,q:ce,Q:XB,s:YB,S:bMe,u:wMe,U:jMe,V:_Me,w:NMe,W:SMe,x:null,X:null,y:CMe,Y:PMe,Z:kMe,"%":KB},_={a:F,A:D,b:I,B:R,c:M,d:VB,e:VB,f:GDe,g:UB,G:zB,H:WB,I:WB,j:UDe,L:HDe,m:zDe,M:VDe,p:A,q:qDe,Q:XDe,s:YDe,S:WDe,u:RDe,U:LDe,V:FDe,w:MDe,W:$De,x:U,X:z,y:UB,Y:zB,Z:BDe,"%":KDe};w.x=C(r,w),w.X=C(n,w),w.c=C(t,w),j.x=C(r,j),j.X=C(n,j),j.c=C(t,j);function C(le,ie){return function(te){var ue=[],Te=-1,ne=0,de=le.length,lt,Nt,at;for(te instanceof Date||(te=new Date(+te));++Te<de;)le.charCodeAt(Te)===37&&(ue.push(le.slice(ne,Te)),(Nt=qB[lt=le.charAt(++Te)])!=null?lt=le.charAt(++Te):Nt=lt==="e"?" ":"0",(at=ie[lt])&&(lt=at(te,Nt)),ue.push(lt),ne=Te+1);return ue.push(le.slice(ne,Te)),ue.join("")}}function P(le,ie){return function(te){var ue=iy(1900,void 0,1),Te=E(ue,le,te+="",0),ne,de;if(Te!=te.length)return null;if("Q"in ue)return new Date(ue.Q);if("s"in ue)return new Date(ue.s*1e3+("L"in ue?ue.L:0));if(ie&&!("Z"in ue)&&(ue.Z=0),"p"in ue&&(ue.H=ue.H%12+ue.p*12),ue.m===void 0&&(ue.m="q"in ue?ue.q:0),"V"in ue){if(ue.V<1||ue.V>53)return null;"w"in ue||(ue.w=1),"Z"in ue?(ne=UP(iy(ue.y,0,1)),de=ne.getUTCDay(),ne=de>4||de===0?SN.ceil(ne):SN(ne),ne=ZC.offset(ne,(ue.V-1)*7),ue.y=ne.getUTCFullYear(),ue.m=ne.getUTCMonth(),ue.d=ne.getUTCDate()+(ue.w+6)%7):(ne=zP(iy(ue.y,0,1)),de=ne.getDay(),ne=de>4||de===0?NN.ceil(ne):NN(ne),ne=j1.offset(ne,(ue.V-1)*7),ue.y=ne.getFullYear(),ue.m=ne.getMonth(),ue.d=ne.getDate()+(ue.w+6)%7)}else("W"in ue||"U"in ue)&&("w"in ue||(ue.w="u"in ue?ue.u%7:"W"in ue?1:0),de="Z"in ue?UP(iy(ue.y,0,1)).getUTCDay():zP(iy(ue.y,0,1)).getDay(),ue.m=0,ue.d="W"in ue?(ue.w+6)%7+ue.W*7-(de+5)%7:ue.w+ue.U*7-(de+6)%7);return"Z"in ue?(ue.H+=ue.Z/100|0,ue.M+=ue.Z%100,UP(ue)):zP(ue)}}function E(le,ie,te,ue){for(var Te=0,ne=ie.length,de=te.length,lt,Nt;Te<ne;){if(ue>=de)return-1;if(lt=ie.charCodeAt(Te++),lt===37){if(lt=ie.charAt(Te++),Nt=_[lt in qB?ie.charAt(Te++):lt],!Nt||(ue=Nt(le,te,ue))<0)return-1}else if(lt!=te.charCodeAt(ue++))return-1}return ue}function A(le,ie,te){var ue=d.exec(ie.slice(te));return ue?(le.p=u.get(ue[0].toLowerCase()),te+ue[0].length):-1}function F(le,ie,te){var ue=m.exec(ie.slice(te));return ue?(le.w=v.get(ue[0].toLowerCase()),te+ue[0].length):-1}function D(le,ie,te){var ue=f.exec(ie.slice(te));return ue?(le.w=h.get(ue[0].toLowerCase()),te+ue[0].length):-1}function I(le,ie,te){var ue=x.exec(ie.slice(te));return ue?(le.m=b.get(ue[0].toLowerCase()),te+ue[0].length):-1}function R(le,ie,te){var ue=g.exec(ie.slice(te));return ue?(le.m=y.get(ue[0].toLowerCase()),te+ue[0].length):-1}function M(le,ie,te){return E(le,t,ie,te)}function U(le,ie,te){return E(le,r,ie,te)}function z(le,ie,te){return E(le,n,ie,te)}function W(le){return i[le.getDay()]}function $(le){return o[le.getDay()]}function ee(le){return c[le.getMonth()]}function ve(le){return l[le.getMonth()]}function _e(le){return s[+(le.getHours()>=12)]}function K(le){return 1+~~(le.getMonth()/3)}function q(le){return i[le.getUTCDay()]}function Y(le){return o[le.getUTCDay()]}function J(le){return c[le.getUTCMonth()]}function fe(le){return l[le.getUTCMonth()]}function Z(le){return s[+(le.getUTCHours()>=12)]}function ce(le){return 1+~~(le.getUTCMonth()/3)}return{format:function(le){var ie=C(le+="",w);return ie.toString=function(){return le},ie},parse:function(le){var ie=P(le+="",!1);return ie.toString=function(){return le},ie},utcFormat:function(le){var ie=C(le+="",j);return ie.toString=function(){return le},ie},utcParse:function(le){var ie=P(le+="",!0);return ie.toString=function(){return le},ie}}}var qB={"-":"",_:" ",0:"0"},pi=/^\s*\d+/,ODe=/^%/,TDe=/[\\^$*+?|[\]().{}]/g;function Qa(e,t,r){var n=e<0?"-":"",s=(n?-e:e)+"",o=s.length;return n+(o<r?new Array(r-o+1).join(t)+s:s)}function DDe(e){return e.replace(TDe,"\\$&")}function ly(e){return new RegExp("^(?:"+e.map(DDe).join("|")+")","i")}function cy(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function MDe(e,t,r){var n=pi.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function RDe(e,t,r){var n=pi.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function LDe(e,t,r){var n=pi.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function FDe(e,t,r){var n=pi.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function $De(e,t,r){var n=pi.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function zB(e,t,r){var n=pi.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function UB(e,t,r){var n=pi.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function BDe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function qDe(e,t,r){var n=pi.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function zDe(e,t,r){var n=pi.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function VB(e,t,r){var n=pi.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function UDe(e,t,r){var n=pi.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function WB(e,t,r){var n=pi.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function VDe(e,t,r){var n=pi.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function WDe(e,t,r){var n=pi.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function HDe(e,t,r){var n=pi.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function GDe(e,t,r){var n=pi.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function KDe(e,t,r){var n=ODe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function XDe(e,t,r){var n=pi.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function YDe(e,t,r){var n=pi.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function HB(e,t){return Qa(e.getDate(),t,2)}function JDe(e,t){return Qa(e.getHours(),t,2)}function QDe(e,t){return Qa(e.getHours()%12||12,t,2)}function ZDe(e,t){return Qa(1+j1.count(Yf(e),e),t,3)}function iQ(e,t){return Qa(e.getMilliseconds(),t,3)}function eMe(e,t){return iQ(e,t)+"000"}function tMe(e,t){return Qa(e.getMonth()+1,t,2)}function rMe(e,t){return Qa(e.getMinutes(),t,2)}function nMe(e,t){return Qa(e.getSeconds(),t,2)}function aMe(e){var t=e.getDay();return t===0?7:t}function sMe(e,t){return Qa(e5.count(Yf(e)-1,e),t,2)}function lQ(e){var t=e.getDay();return t>=4||t===0?Ix(e):Ix.ceil(e)}function oMe(e,t){return e=lQ(e),Qa(Ix.count(Yf(e),e)+(Yf(e).getDay()===4),t,2)}function iMe(e){return e.getDay()}function lMe(e,t){return Qa(NN.count(Yf(e)-1,e),t,2)}function cMe(e,t){return Qa(e.getFullYear()%100,t,2)}function dMe(e,t){return e=lQ(e),Qa(e.getFullYear()%100,t,2)}function uMe(e,t){return Qa(e.getFullYear()%1e4,t,4)}function fMe(e,t){var r=e.getDay();return e=r>=4||r===0?Ix(e):Ix.ceil(e),Qa(e.getFullYear()%1e4,t,4)}function mMe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Qa(t/60|0,"0",2)+Qa(t%60,"0",2)}function GB(e,t){return Qa(e.getUTCDate(),t,2)}function hMe(e,t){return Qa(e.getUTCHours(),t,2)}function pMe(e,t){return Qa(e.getUTCHours()%12||12,t,2)}function gMe(e,t){return Qa(1+ZC.count(Jf(e),e),t,3)}function cQ(e,t){return Qa(e.getUTCMilliseconds(),t,3)}function vMe(e,t){return cQ(e,t)+"000"}function xMe(e,t){return Qa(e.getUTCMonth()+1,t,2)}function yMe(e,t){return Qa(e.getUTCMinutes(),t,2)}function bMe(e,t){return Qa(e.getUTCSeconds(),t,2)}function wMe(e){var t=e.getUTCDay();return t===0?7:t}function jMe(e,t){return Qa(t5.count(Jf(e)-1,e),t,2)}function dQ(e){var t=e.getUTCDay();return t>=4||t===0?Ox(e):Ox.ceil(e)}function _Me(e,t){return e=dQ(e),Qa(Ox.count(Jf(e),e)+(Jf(e).getUTCDay()===4),t,2)}function NMe(e){return e.getUTCDay()}function SMe(e,t){return Qa(SN.count(Jf(e)-1,e),t,2)}function CMe(e,t){return Qa(e.getUTCFullYear()%100,t,2)}function AMe(e,t){return e=dQ(e),Qa(e.getUTCFullYear()%100,t,2)}function PMe(e,t){return Qa(e.getUTCFullYear()%1e4,t,4)}function EMe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Ox(e):Ox.ceil(e),Qa(e.getUTCFullYear()%1e4,t,4)}function kMe(){return"+0000"}function KB(){return"%"}function XB(e){return+e}function YB(e){return Math.floor(+e/1e3)}var Jg,uQ,fQ;IMe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function IMe(e){return Jg=IDe(e),uQ=Jg.format,Jg.parse,fQ=Jg.utcFormat,Jg.utcParse,Jg}function OMe(e){return new Date(e)}function TMe(e){return e instanceof Date?+e:+new Date(+e)}function nM(e,t,r,n,s,o,i,l,c,d){var u=UD(),f=u.invert,h=u.domain,m=d(".%L"),v=d(":%S"),g=d("%I:%M"),y=d("%I %p"),x=d("%a %d"),b=d("%b %d"),w=d("%B"),j=d("%Y");function _(C){return(c(C)<C?m:l(C)<C?v:i(C)<C?g:o(C)<C?y:n(C)<C?s(C)<C?x:b:r(C)<C?w:j)(C)}return u.invert=function(C){return new Date(f(C))},u.domain=function(C){return arguments.length?h(Array.from(C,TMe)):h().map(OMe)},u.ticks=function(C){var P=h();return e(P[0],P[P.length-1],C??10)},u.tickFormat=function(C,P){return P==null?_:d(P)},u.nice=function(C){var P=h();return(!C||typeof C.range!="function")&&(C=t(P[0],P[P.length-1],C??10)),C?h(QJ(P,C)):u},u.copy=function(){return w1(u,nM(e,t,r,n,s,o,i,l,c,d))},u}function DMe(){return Id.apply(nM(EDe,kDe,Yf,tM,e5,j1,ZD,JD,Pp,uQ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function MMe(){return Id.apply(nM(ADe,PDe,Jf,rM,t5,ZC,eM,QD,Pp,fQ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function r5(){var e=0,t=1,r,n,s,o,i=jl,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:i(s===0?.5:(f=(o(f)-r)*s,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=o(e=+e),n=o(t=+t),s=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(i=f,d):i};function u(f){return function(h){var m,v;return arguments.length?([m,v]=h,i=f(m,v),d):[i(0),i(1)]}}return d.range=u(C0),d.rangeRound=u(zD),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return o=f,r=f(e),n=f(t),s=r===n?0:1/(n-r),d}}function zh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function mQ(){var e=qh(r5()(jl));return e.copy=function(){return zh(e,mQ())},sm.apply(e,arguments)}function hQ(){var e=HD(r5()).domain([1,10]);return e.copy=function(){return zh(e,hQ()).base(e.base())},sm.apply(e,arguments)}function pQ(){var e=GD(r5());return e.copy=function(){return zh(e,pQ()).constant(e.constant())},sm.apply(e,arguments)}function aM(){var e=KD(r5());return e.copy=function(){return zh(e,aM()).exponent(e.exponent())},sm.apply(e,arguments)}function RMe(){return aM.apply(null,arguments).exponent(.5)}function gQ(){var e=[],t=jl;function r(n){if(n!=null&&!isNaN(n=+n))return t((y1(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let s of n)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(dh),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,s)=>t(s/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(s,o)=>j4e(e,o/n))},r.copy=function(){return gQ(t).domain(e)},sm.apply(r,arguments)}function n5(){var e=0,t=.5,r=1,n=1,s,o,i,l,c,d=jl,u,f=!1,h;function m(g){return isNaN(g=+g)?h:(g=.5+((g=+u(g))-o)*(n*g<n*o?l:c),d(f?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([e,t,r]=g,s=u(e=+e),o=u(t=+t),i=u(r=+r),l=s===o?0:.5/(o-s),c=o===i?0:.5/(i-o),n=o<s?-1:1,m):[e,t,r]},m.clamp=function(g){return arguments.length?(f=!!g,m):f},m.interpolator=function(g){return arguments.length?(d=g,m):d};function v(g){return function(y){var x,b,w;return arguments.length?([x,b,w]=y,d=K4e(g,[x,b,w]),m):[d(0),d(.5),d(1)]}}return m.range=v(C0),m.rangeRound=v(zD),m.unknown=function(g){return arguments.length?(h=g,m):h},function(g){return u=g,s=g(e),o=g(t),i=g(r),l=s===o?0:.5/(o-s),c=o===i?0:.5/(i-o),n=o<s?-1:1,m}}function vQ(){var e=qh(n5()(jl));return e.copy=function(){return zh(e,vQ())},sm.apply(e,arguments)}function xQ(){var e=HD(n5()).domain([.1,1,10]);return e.copy=function(){return zh(e,xQ()).base(e.base())},sm.apply(e,arguments)}function yQ(){var e=GD(n5());return e.copy=function(){return zh(e,yQ()).constant(e.constant())},sm.apply(e,arguments)}function sM(){var e=KD(n5());return e.copy=function(){return zh(e,sM()).exponent(e.exponent())},sm.apply(e,arguments)}function LMe(){return sM.apply(null,arguments).exponent(.5)}const JB=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:lw,scaleDiverging:vQ,scaleDivergingLog:xQ,scaleDivergingPow:sM,scaleDivergingSqrt:LMe,scaleDivergingSymlog:yQ,scaleIdentity:JJ,scaleImplicit:hO,scaleLinear:jN,scaleLog:ZJ,scaleOrdinal:$D,scalePoint:rb,scalePow:XD,scaleQuantile:rQ,scaleQuantize:nQ,scaleRadial:tQ,scaleSequential:mQ,scaleSequentialLog:hQ,scaleSequentialPow:aM,scaleSequentialQuantile:gQ,scaleSequentialSqrt:RMe,scaleSequentialSymlog:pQ,scaleSqrt:vDe,scaleSymlog:eQ,scaleThreshold:aQ,scaleTime:DMe,scaleUtc:MMe,tickFormat:YJ},Symbol.toStringTag,{value:"Module"}));var FMe=v0;function $Me(e,t,r){for(var n=-1,s=e.length;++n<s;){var o=e[n],i=t(o);if(i!=null&&(l===void 0?i===i&&!FMe(i):r(i,l)))var l=i,c=o}return c}var a5=$Me;function BMe(e,t){return e>t}var bQ=BMe,qMe=a5,zMe=bQ,UMe=S0;function VMe(e){return e&&e.length?qMe(e,UMe,zMe):void 0}var WMe=VMe;const Vm=Ga(WMe);function HMe(e,t){return e<t}var wQ=HMe,GMe=a5,KMe=wQ,XMe=S0;function YMe(e){return e&&e.length?GMe(e,XMe,KMe):void 0}var JMe=YMe;const s5=Ga(JMe);var QMe=yD,ZMe=rf,eRe=EJ,tRe=tc;function rRe(e,t){var r=tRe(e)?QMe:eRe;return r(e,ZMe(t))}var nRe=rRe,aRe=AJ,sRe=nRe;function oRe(e,t){return aRe(sRe(e,t),1)}var iRe=oRe;const lRe=Ga(iRe);var cRe=DD;function dRe(e,t){return cRe(e,t)}var uRe=dRe;const cg=Ga(uRe);var A0=1e9,fRe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},iM,Xs=!0,Ad="[DecimalError] ",Up=Ad+"Invalid argument: ",oM=Ad+"Exponent out of range: ",P0=Math.floor,mp=Math.pow,mRe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,_c,oi=1e7,qs=7,jQ=9007199254740991,CN=P0(jQ/qs),Rn={};Rn.absoluteValue=Rn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Rn.comparedTo=Rn.cmp=function(e){var t,r,n,s,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(n=o.d.length,s=e.d.length,t=0,r=n<s?n:s;t<r;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return n===s?0:n>s^o.s<0?1:-1};Rn.decimalPlaces=Rn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*qs;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Rn.dividedBy=Rn.div=function(e){return Lf(this,new this.constructor(e))};Rn.dividedToIntegerBy=Rn.idiv=function(e){var t=this,r=t.constructor;return Ns(Lf(t,new r(e),0,1),r.precision)};Rn.equals=Rn.eq=function(e){return!this.cmp(e)};Rn.exponent=function(){return Mo(this)};Rn.greaterThan=Rn.gt=function(e){return this.cmp(e)>0};Rn.greaterThanOrEqualTo=Rn.gte=function(e){return this.cmp(e)>=0};Rn.isInteger=Rn.isint=function(){return this.e>this.d.length-2};Rn.isNegative=Rn.isneg=function(){return this.s<0};Rn.isPositive=Rn.ispos=function(){return this.s>0};Rn.isZero=function(){return this.s===0};Rn.lessThan=Rn.lt=function(e){return this.cmp(e)<0};Rn.lessThanOrEqualTo=Rn.lte=function(e){return this.cmp(e)<1};Rn.logarithm=Rn.log=function(e){var t,r=this,n=r.constructor,s=n.precision,o=s+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(_c))throw Error(Ad+"NaN");if(r.s<1)throw Error(Ad+(r.s?"NaN":"-Infinity"));return r.eq(_c)?new n(0):(Xs=!1,t=Lf(mw(r,o),mw(e,o),o),Xs=!0,Ns(t,s))};Rn.minus=Rn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?SQ(t,e):_Q(t,(e.s=-e.s,e))};Rn.modulo=Rn.mod=function(e){var t,r=this,n=r.constructor,s=n.precision;if(e=new n(e),!e.s)throw Error(Ad+"NaN");return r.s?(Xs=!1,t=Lf(r,e,0,1).times(e),Xs=!0,r.minus(t)):Ns(new n(r),s)};Rn.naturalExponential=Rn.exp=function(){return NQ(this)};Rn.naturalLogarithm=Rn.ln=function(){return mw(this)};Rn.negated=Rn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Rn.plus=Rn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?_Q(t,e):SQ(t,(e.s=-e.s,e))};Rn.precision=Rn.sd=function(e){var t,r,n,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Up+e);if(t=Mo(s)+1,n=s.d.length-1,r=n*qs+1,n=s.d[n],n){for(;n%10==0;n/=10)r--;for(n=s.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Rn.squareRoot=Rn.sqrt=function(){var e,t,r,n,s,o,i,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Ad+"NaN")}for(e=Mo(l),Xs=!1,s=Math.sqrt(+l),s==0||s==1/0?(t=Lu(l.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=P0((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(s.toString()),r=c.precision,s=i=r+3;;)if(o=n,n=o.plus(Lf(l,o,i+2)).times(.5),Lu(o.d).slice(0,i)===(t=Lu(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),s==i&&t=="4999"){if(Ns(o,r+1,0),o.times(o).eq(l)){n=o;break}}else if(t!="9999")break;i+=4}return Xs=!0,Ns(n,r)};Rn.times=Rn.mul=function(e){var t,r,n,s,o,i,l,c,d,u=this,f=u.constructor,h=u.d,m=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=h.length,d=m.length,c<d&&(o=h,h=m,m=o,i=c,c=d,d=i),o=[],i=c+d,n=i;n--;)o.push(0);for(n=d;--n>=0;){for(t=0,s=c+n;s>n;)l=o[s]+m[n]*h[s-n-1]+t,o[s--]=l%oi|0,t=l/oi|0;o[s]=(o[s]+t)%oi|0}for(;!o[--i];)o.pop();return t?++r:o.shift(),e.d=o,e.e=r,Xs?Ns(e,f.precision):e};Rn.toDecimalPlaces=Rn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Qu(e,0,A0),t===void 0?t=n.rounding:Qu(t,0,8),Ns(r,e+Mo(r)+1,t))};Rn.toExponential=function(e,t){var r,n=this,s=n.constructor;return e===void 0?r=dg(n,!0):(Qu(e,0,A0),t===void 0?t=s.rounding:Qu(t,0,8),n=Ns(new s(n),e+1,t),r=dg(n,!0,e+1)),r};Rn.toFixed=function(e,t){var r,n,s=this,o=s.constructor;return e===void 0?dg(s):(Qu(e,0,A0),t===void 0?t=o.rounding:Qu(t,0,8),n=Ns(new o(s),e+Mo(s)+1,t),r=dg(n.abs(),!1,e+Mo(n)+1),s.isneg()&&!s.isZero()?"-"+r:r)};Rn.toInteger=Rn.toint=function(){var e=this,t=e.constructor;return Ns(new t(e),Mo(e)+1,t.rounding)};Rn.toNumber=function(){return+this};Rn.toPower=Rn.pow=function(e){var t,r,n,s,o,i,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(_c);if(l=new c(l),!l.s){if(e.s<1)throw Error(Ad+"Infinity");return l}if(l.eq(_c))return l;if(n=c.precision,e.eq(_c))return Ns(l,n);if(t=e.e,r=e.d.length-1,i=t>=r,o=l.s,i){if((r=u<0?-u:u)<=jQ){for(s=new c(_c),t=Math.ceil(n/qs+4),Xs=!1;r%2&&(s=s.times(l),ZB(s.d,t)),r=P0(r/2),r!==0;)l=l.times(l),ZB(l.d,t);return Xs=!0,e.s<0?new c(_c).div(s):Ns(s,n)}}else if(o<0)throw Error(Ad+"NaN");return o=o<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Xs=!1,s=e.times(mw(l,n+d)),Xs=!0,s=NQ(s),s.s=o,s};Rn.toPrecision=function(e,t){var r,n,s=this,o=s.constructor;return e===void 0?(r=Mo(s),n=dg(s,r<=o.toExpNeg||r>=o.toExpPos)):(Qu(e,1,A0),t===void 0?t=o.rounding:Qu(t,0,8),s=Ns(new o(s),e,t),r=Mo(s),n=dg(s,e<=r||r<=o.toExpNeg,e)),n};Rn.toSignificantDigits=Rn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Qu(e,1,A0),t===void 0?t=n.rounding:Qu(t,0,8)),Ns(new n(r),e,t)};Rn.toString=Rn.valueOf=Rn.val=Rn.toJSON=Rn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Mo(e),r=e.constructor;return dg(e,t<=r.toExpNeg||t>=r.toExpPos)};function _Q(e,t){var r,n,s,o,i,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Xs?Ns(t,f):t;if(c=e.d,d=t.d,i=e.e,s=t.e,c=c.slice(),o=i-s,o){for(o<0?(n=c,o=-o,l=d.length):(n=d,s=i,l=c.length),i=Math.ceil(f/qs),l=i>l?i+1:l+1,o>l&&(o=l,n.length=1),n.reverse();o--;)n.push(0);n.reverse()}for(l=c.length,o=d.length,l-o<0&&(o=l,n=d,d=c,c=n),r=0;o;)r=(c[--o]=c[o]+d[o]+r)/oi|0,c[o]%=oi;for(r&&(c.unshift(r),++s),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=s,Xs?Ns(t,f):t}function Qu(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Up+e)}function Lu(e){var t,r,n,s=e.length-1,o="",i=e[0];if(s>0){for(o+=i,t=1;t<s;t++)n=e[t]+"",r=qs-n.length,r&&(o+=Om(r)),o+=n;i=e[t],n=i+"",r=qs-n.length,r&&(o+=Om(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return o+i}var Lf=function(){function e(n,s){var o,i=0,l=n.length;for(n=n.slice();l--;)o=n[l]*s+i,n[l]=o%oi|0,i=o/oi|0;return i&&n.unshift(i),n}function t(n,s,o,i){var l,c;if(o!=i)c=o>i?1:-1;else for(l=c=0;l<o;l++)if(n[l]!=s[l]){c=n[l]>s[l]?1:-1;break}return c}function r(n,s,o){for(var i=0;o--;)n[o]-=i,i=n[o]<s[o]?1:0,n[o]=i*oi+n[o]-s[o];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,o,i){var l,c,d,u,f,h,m,v,g,y,x,b,w,j,_,C,P,E,A=n.constructor,F=n.s==s.s?1:-1,D=n.d,I=s.d;if(!n.s)return new A(n);if(!s.s)throw Error(Ad+"Division by zero");for(c=n.e-s.e,P=I.length,_=D.length,m=new A(F),v=m.d=[],d=0;I[d]==(D[d]||0);)++d;if(I[d]>(D[d]||0)&&--c,o==null?b=o=A.precision:i?b=o+(Mo(n)-Mo(s))+1:b=o,b<0)return new A(0);if(b=b/qs+2|0,d=0,P==1)for(u=0,I=I[0],b++;(d<_||u)&&b--;d++)w=u*oi+(D[d]||0),v[d]=w/I|0,u=w%I|0;else{for(u=oi/(I[0]+1)|0,u>1&&(I=e(I,u),D=e(D,u),P=I.length,_=D.length),j=P,g=D.slice(0,P),y=g.length;y<P;)g[y++]=0;E=I.slice(),E.unshift(0),C=I[0],I[1]>=oi/2&&++C;do u=0,l=t(I,g,P,y),l<0?(x=g[0],P!=y&&(x=x*oi+(g[1]||0)),u=x/C|0,u>1?(u>=oi&&(u=oi-1),f=e(I,u),h=f.length,y=g.length,l=t(f,g,h,y),l==1&&(u--,r(f,P<h?E:I,h))):(u==0&&(l=u=1),f=I.slice()),h=f.length,h<y&&f.unshift(0),r(g,f,y),l==-1&&(y=g.length,l=t(I,g,P,y),l<1&&(u++,r(g,P<y?E:I,y))),y=g.length):l===0&&(u++,g=[0]),v[d++]=u,l&&g[0]?g[y++]=D[j]||0:(g=[D[j]],y=1);while((j++<_||g[0]!==void 0)&&b--)}return v[0]||v.shift(),m.e=c,Ns(m,i?o+Mo(m)+1:o)}}();function NQ(e,t){var r,n,s,o,i,l,c=0,d=0,u=e.constructor,f=u.precision;if(Mo(e)>16)throw Error(oM+Mo(e));if(!e.s)return new u(_c);for(t==null?(Xs=!1,l=f):l=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),d+=5;for(n=Math.log(mp(2,d))/Math.LN10*2+5|0,l+=n,r=s=o=new u(_c),u.precision=l;;){if(s=Ns(s.times(e),l),r=r.times(++c),i=o.plus(Lf(s,r,l)),Lu(i.d).slice(0,l)===Lu(o.d).slice(0,l)){for(;d--;)o=Ns(o.times(o),l);return u.precision=f,t==null?(Xs=!0,Ns(o,f)):o}o=i}}function Mo(e){for(var t=e.e*qs,r=e.d[0];r>=10;r/=10)t++;return t}function VP(e,t,r){if(t>e.LN10.sd())throw Xs=!0,r&&(e.precision=r),Error(Ad+"LN10 precision limit exceeded");return Ns(new e(e.LN10),t)}function Om(e){for(var t="";e--;)t+="0";return t}function mw(e,t){var r,n,s,o,i,l,c,d,u,f=1,h=10,m=e,v=m.d,g=m.constructor,y=g.precision;if(m.s<1)throw Error(Ad+(m.s?"NaN":"-Infinity"));if(m.eq(_c))return new g(0);if(t==null?(Xs=!1,d=y):d=t,m.eq(10))return t==null&&(Xs=!0),VP(g,d);if(d+=h,g.precision=d,r=Lu(v),n=r.charAt(0),o=Mo(m),Math.abs(o)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=Lu(m.d),n=r.charAt(0),f++;o=Mo(m),n>1?(m=new g("0."+r),o++):m=new g(n+"."+r.slice(1))}else return c=VP(g,d+2,y).times(o+""),m=mw(new g(n+"."+r.slice(1)),d-h).plus(c),g.precision=y,t==null?(Xs=!0,Ns(m,y)):m;for(l=i=m=Lf(m.minus(_c),m.plus(_c),d),u=Ns(m.times(m),d),s=3;;){if(i=Ns(i.times(u),d),c=l.plus(Lf(i,new g(s),d)),Lu(c.d).slice(0,d)===Lu(l.d).slice(0,d))return l=l.times(2),o!==0&&(l=l.plus(VP(g,d+2,y).times(o+""))),l=Lf(l,new g(f),d),g.precision=y,t==null?(Xs=!0,Ns(l,y)):l;l=c,s+=2}}function QB(e,t){var r,n,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(n,s),t){if(s-=n,r=r-n-1,e.e=P0(r/qs),e.d=[],n=(r+1)%qs,r<0&&(n+=qs),n<s){for(n&&e.d.push(+t.slice(0,n)),s-=qs;n<s;)e.d.push(+t.slice(n,n+=qs));t=t.slice(n),n=qs-t.length}else n-=s;for(;n--;)t+="0";if(e.d.push(+t),Xs&&(e.e>CN||e.e<-CN))throw Error(oM+r)}else e.s=0,e.e=0,e.d=[0];return e}function Ns(e,t,r){var n,s,o,i,l,c,d,u,f=e.d;for(i=1,o=f[0];o>=10;o/=10)i++;if(n=t-i,n<0)n+=qs,s=t,d=f[u=0];else{if(u=Math.ceil((n+1)/qs),o=f.length,u>=o)return e;for(d=o=f[u],i=1;o>=10;o/=10)i++;n%=qs,s=n-qs+i}if(r!==void 0&&(o=mp(10,i-s-1),l=d/o%10|0,c=t<0||f[u+1]!==void 0||d%o,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?s>0?d/mp(10,i-s):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(o=Mo(e),f.length=1,t=t-o-1,f[0]=mp(10,(qs-t%qs)%qs),e.e=P0(-t/qs)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,o=1,u--):(f.length=u+1,o=mp(10,qs-n),f[u]=s>0?(d/mp(10,i-s)%mp(10,s)|0)*o:0),c)for(;;)if(u==0){(f[0]+=o)==oi&&(f[0]=1,++e.e);break}else{if(f[u]+=o,f[u]!=oi)break;f[u--]=0,o=1}for(n=f.length;f[--n]===0;)f.pop();if(Xs&&(e.e>CN||e.e<-CN))throw Error(oM+Mo(e));return e}function SQ(e,t){var r,n,s,o,i,l,c,d,u,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Xs?Ns(t,m):t;if(c=e.d,f=t.d,n=t.e,d=e.e,c=c.slice(),i=d-n,i){for(u=i<0,u?(r=c,i=-i,l=f.length):(r=f,n=d,l=c.length),s=Math.max(Math.ceil(m/qs),l)+2,i>s&&(i=s,r.length=1),r.reverse(),s=i;s--;)r.push(0);r.reverse()}else{for(s=c.length,l=f.length,u=s<l,u&&(l=s),s=0;s<l;s++)if(c[s]!=f[s]){u=c[s]<f[s];break}i=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,s=f.length-l;s>0;--s)c[l++]=0;for(s=f.length;s>i;){if(c[--s]<f[s]){for(o=s;o&&c[--o]===0;)c[o]=oi-1;--c[o],c[s]+=oi}c[s]-=f[s]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Xs?Ns(t,m):t):new h(0)}function dg(e,t,r){var n,s=Mo(e),o=Lu(e.d),i=o.length;return t?(r&&(n=r-i)>0?o=o.charAt(0)+"."+o.slice(1)+Om(n):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(s<0?"e":"e+")+s):s<0?(o="0."+Om(-s-1)+o,r&&(n=r-i)>0&&(o+=Om(n))):s>=i?(o+=Om(s+1-i),r&&(n=r-s-1)>0&&(o=o+"."+Om(n))):((n=s+1)<i&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-i)>0&&(s+1===i&&(o+="."),o+=Om(n))),e.s<0?"-"+o:o}function ZB(e,t){if(e.length>t)return e.length=t,!0}function CQ(e){var t,r,n;function s(o){var i=this;if(!(i instanceof s))return new s(o);if(i.constructor=s,o instanceof s){i.s=o.s,i.e=o.e,i.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Up+o);if(o>0)i.s=1;else if(o<0)o=-o,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(o===~~o&&o<1e7){i.e=0,i.d=[o];return}return QB(i,o.toString())}else if(typeof o!="string")throw Error(Up+o);if(o.charCodeAt(0)===45?(o=o.slice(1),i.s=-1):i.s=1,mRe.test(o))QB(i,o);else throw Error(Up+o)}if(s.prototype=Rn,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=CQ,s.config=s.set=hRe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return s.config(e),s}function hRe(e){if(!e||typeof e!="object")throw Error(Ad+"Object expected");var t,r,n,s=["precision",1,A0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((n=e[r=s[t]])!==void 0)if(P0(n)===n&&n>=s[t+1]&&n<=s[t+2])this[r]=n;else throw Error(Up+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Up+r+": "+n);return this}var iM=CQ(fRe);_c=new iM(1);const gs=iM;function pRe(e){return yRe(e)||xRe(e)||vRe(e)||gRe()}function gRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vRe(e,t){if(e){if(typeof e=="string")return xO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(e,t)}}function xRe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function yRe(e){if(Array.isArray(e))return xO(e)}function xO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var bRe=function(t){return t},AQ={"@@functional/placeholder":!0},PQ=function(t){return t===AQ},eq=function(t){return function r(){return arguments.length===0||arguments.length===1&&PQ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},wRe=function e(t,r){return t===1?r:eq(function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];var i=s.filter(function(l){return l!==AQ}).length;return i>=t?r.apply(void 0,s):e(t-i,eq(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=s.map(function(f){return PQ(f)?c.shift():f});return r.apply(void 0,pRe(u).concat(c))}))})},o5=function(t){return wRe(t.length,t)},yO=function(t,r){for(var n=[],s=t;s<r;++s)n[s-t]=s;return n},jRe=o5(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),_Re=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return bRe;var s=r.reverse(),o=s[0],i=s.slice(1);return function(){return i.reduce(function(l,c){return c(l)},o.apply(void 0,arguments))}},bO=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},EQ=function(t){var r=null,n=null;return function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r&&o.every(function(l,c){return l===r[c]})||(r=o,n=t.apply(void 0,o)),n}};function NRe(e){var t;return e===0?t=1:t=Math.floor(new gs(e).abs().log(10).toNumber())+1,t}function SRe(e,t,r){for(var n=new gs(e),s=0,o=[];n.lt(t)&&s<1e5;)o.push(n.toNumber()),n=n.add(r),s++;return o}var CRe=o5(function(e,t,r){var n=+e,s=+t;return n+r*(s-n)}),ARe=o5(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),PRe=o5(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const i5={rangeStep:SRe,getDigitCount:NRe,interpolateNumber:CRe,uninterpolateNumber:ARe,uninterpolateTruncation:PRe};function wO(e){return IRe(e)||kRe(e)||kQ(e)||ERe()}function ERe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kRe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function IRe(e){if(Array.isArray(e))return jO(e)}function hw(e,t){return DRe(e)||TRe(e,t)||kQ(e,t)||ORe()}function ORe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kQ(e,t){if(e){if(typeof e=="string")return jO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jO(e,t)}}function jO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TRe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,s=!1,o=void 0;try{for(var i=e[Symbol.iterator](),l;!(n=(l=i.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){s=!0,o=c}finally{try{!n&&i.return!=null&&i.return()}finally{if(s)throw o}}return r}}function DRe(e){if(Array.isArray(e))return e}function IQ(e){var t=hw(e,2),r=t[0],n=t[1],s=r,o=n;return r>n&&(s=n,o=r),[s,o]}function OQ(e,t,r){if(e.lte(0))return new gs(0);var n=i5.getDigitCount(e.toNumber()),s=new gs(10).pow(n),o=e.div(s),i=n!==1?.05:.1,l=new gs(Math.ceil(o.div(i).toNumber())).add(r).mul(i),c=l.mul(s);return t?c:new gs(Math.ceil(c))}function MRe(e,t,r){var n=1,s=new gs(e);if(!s.isint()&&r){var o=Math.abs(e);o<1?(n=new gs(10).pow(i5.getDigitCount(e)-1),s=new gs(Math.floor(s.div(n).toNumber())).mul(n)):o>1&&(s=new gs(Math.floor(e)))}else e===0?s=new gs(Math.floor((t-1)/2)):r||(s=new gs(Math.floor(e)));var i=Math.floor((t-1)/2),l=_Re(jRe(function(c){return s.add(new gs(c-i).mul(n)).toNumber()}),yO);return l(0,t)}function TQ(e,t,r,n){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new gs(0),tickMin:new gs(0),tickMax:new gs(0)};var o=OQ(new gs(t).sub(e).div(r-1),n,s),i;e<=0&&t>=0?i=new gs(0):(i=new gs(e).add(t).div(2),i=i.sub(new gs(i).mod(o)));var l=Math.ceil(i.sub(e).div(o).toNumber()),c=Math.ceil(new gs(t).sub(i).div(o).toNumber()),d=l+c+1;return d>r?TQ(e,t,r,n,s+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:o,tickMin:i.sub(new gs(l).mul(o)),tickMax:i.add(new gs(c).mul(o))})}function RRe(e){var t=hw(e,2),r=t[0],n=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(s,2),l=IQ([r,n]),c=hw(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var f=u===1/0?[d].concat(wO(yO(0,s-1).map(function(){return 1/0}))):[].concat(wO(yO(0,s-1).map(function(){return-1/0})),[u]);return r>n?bO(f):f}if(d===u)return MRe(d,s,o);var h=TQ(d,u,i,o),m=h.step,v=h.tickMin,g=h.tickMax,y=i5.rangeStep(v,g.add(new gs(.1).mul(m)),m);return r>n?bO(y):y}function LRe(e,t){var r=hw(e,2),n=r[0],s=r[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=IQ([n,s]),l=hw(i,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[n,s];if(c===d)return[c];var u=Math.max(t,2),f=OQ(new gs(d).sub(c).div(u-1),o,0),h=[].concat(wO(i5.rangeStep(new gs(c),new gs(d).sub(new gs(.99).mul(f)),f)),[d]);return n>s?bO(h):h}var FRe=EQ(RRe),$Re=EQ(LRe),BRe=!0,WP="Invariant failed";function Ah(e,t){if(!e){if(BRe)throw new Error(WP);var r=typeof t=="function"?t():t,n=r?"".concat(WP,": ").concat(r):WP;throw new Error(n)}}var qRe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Tx(e){"@babel/helpers - typeof";return Tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tx(e)}function AN(){return AN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AN.apply(this,arguments)}function zRe(e,t){return HRe(e)||WRe(e,t)||VRe(e,t)||URe()}function URe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VRe(e,t){if(e){if(typeof e=="string")return tq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tq(e,t)}}function tq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function HRe(e){if(Array.isArray(e))return e}function GRe(e,t){if(e==null)return{};var r=KRe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function XRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RQ(n.key),n)}}function YRe(e,t,r){return t&&rq(e.prototype,t),r&&rq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JRe(e,t,r){return t=PN(t),QRe(e,DQ()?Reflect.construct(t,r||[],PN(e).constructor):t.apply(e,r))}function QRe(e,t){if(t&&(Tx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZRe(e)}function ZRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DQ=function(){return!!e})()}function PN(e){return PN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},PN(e)}function eLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_O(e,t)}function _O(e,t){return _O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},_O(e,t)}function MQ(e,t,r){return t=RQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RQ(e){var t=tLe(e,"string");return Tx(t)=="symbol"?t:t+""}function tLe(e,t){if(Tx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _1=function(e){function t(){return XRe(this,t),JRe(this,t,arguments)}return eLe(t,e),YRe(t,[{key:"render",value:function(){var n=this.props,s=n.offset,o=n.layout,i=n.width,l=n.dataKey,c=n.data,d=n.dataPointFormatter,u=n.xAxis,f=n.yAxis,h=GRe(n,qRe),m=Kn(h,!1);this.props.direction==="x"&&u.type!=="number"&&Ah(!1);var v=c.map(function(g){var y=d(g,l),x=y.x,b=y.y,w=y.value,j=y.errorVal;if(!j)return null;var _=[],C,P;if(Array.isArray(j)){var E=zRe(j,2);C=E[0],P=E[1]}else C=P=j;if(o==="vertical"){var A=u.scale,F=b+s,D=F+i,I=F-i,R=A(w-C),M=A(w+P);_.push({x1:M,y1:D,x2:M,y2:I}),_.push({x1:R,y1:F,x2:M,y2:F}),_.push({x1:R,y1:D,x2:R,y2:I})}else if(o==="horizontal"){var U=f.scale,z=x+s,W=z-i,$=z+i,ee=U(w-C),ve=U(w+P);_.push({x1:W,y1:ve,x2:$,y2:ve}),_.push({x1:z,y1:ee,x2:z,y2:ve}),_.push({x1:W,y1:ee,x2:$,y2:ee})}return Se.createElement(Ta,AN({className:"recharts-errorBar",key:"bar-".concat(_.map(function(_e){return"".concat(_e.x1,"-").concat(_e.x2,"-").concat(_e.y1,"-").concat(_e.y2)}))},m),_.map(function(_e){return Se.createElement("line",AN({},_e,{key:"line-".concat(_e.x1,"-").concat(_e.x2,"-").concat(_e.y1,"-").concat(_e.y2)}))}))});return Se.createElement(Ta,{className:"recharts-errorBars"},v)}}])}(Se.Component);MQ(_1,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});MQ(_1,"displayName","ErrorBar");function pw(e){"@babel/helpers - typeof";return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}function nq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Zh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nq(Object(r),!0).forEach(function(n){rLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rLe(e,t,r){return t=nLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nLe(e){var t=aLe(e,"string");return pw(t)=="symbol"?t:t+""}function aLe(e,t){if(pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LQ=function(t){var r=t.children,n=t.formattedGraphicalItems,s=t.legendWidth,o=t.legendContent,i=bc(r,qp);if(!i)return null;var l=qp.defaultProps,c=l!==void 0?Zh(Zh({},l),i.props):{},d;return i.props&&i.props.payload?d=i.props&&i.props.payload:o==="children"?d=(n||[]).reduce(function(u,f){var h=f.item,m=f.props,v=m.sectors||m.data||[];return u.concat(v.map(function(g){return{type:i.props.iconType||h.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):d=(n||[]).map(function(u){var f=u.item,h=f.type.defaultProps,m=h!==void 0?Zh(Zh({},h),f.props):{},v=m.dataKey,g=m.name,y=m.legendType,x=m.hide;return{inactive:x,dataKey:v,type:c.iconType||y||"square",color:lM(f),value:g||v,payload:m}}),Zh(Zh(Zh({},c),qp.getWithHeight(i,s)),{},{payload:d,item:i})};function gw(e){"@babel/helpers - typeof";return gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gw(e)}function aq(e){return lLe(e)||iLe(e)||oLe(e)||sLe()}function sLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oLe(e,t){if(e){if(typeof e=="string")return NO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NO(e,t)}}function iLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lLe(e){if(Array.isArray(e))return NO(e)}function NO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function po(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sq(Object(r),!0).forEach(function(n){nx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nx(e,t,r){return t=cLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cLe(e){var t=dLe(e,"string");return gw(t)=="symbol"?t:t+""}function dLe(e,t){if(gw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function No(e,t,r){return fa(e)||fa(t)?r:Qo(t)?Tc(e,t,r):na(t)?t(e):r}function nb(e,t,r,n){var s=lRe(e,function(l){return No(l,t)});if(r==="number"){var o=s.filter(function(l){return Zr(l)||parseFloat(l)});return o.length?[s5(o),Vm(o)]:[1/0,-1/0]}var i=n?s.filter(function(l){return!fa(l)}):s;return i.map(function(l){return Qo(l)||l instanceof Date?l:""})}var uLe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=-1,l=(r=n?.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(o&&o.axisType==="angleAxis"&&Math.abs(Math.abs(o.range[1]-o.range[0])-360)<=1e-6)for(var c=o.range,d=0;d<l;d++){var u=d>0?s[d-1].coordinate:s[l-1].coordinate,f=s[d].coordinate,h=d>=l-1?s[0].coordinate:s[d+1].coordinate,m=void 0;if(bl(f-u)!==bl(h-f)){var v=[];if(bl(h-f)===bl(c[1]-c[0])){m=h;var g=f+c[1]-c[0];v[0]=Math.min(g,(g+u)/2),v[1]=Math.max(g,(g+u)/2)}else{m=u;var y=h+c[1]-c[0];v[0]=Math.min(f,(y+f)/2),v[1]=Math.max(f,(y+f)/2)}var x=[Math.min(f,(m+f)/2),Math.max(f,(m+f)/2)];if(t>x[0]&&t<=x[1]||t>=v[0]&&t<=v[1]){i=s[d].index;break}}else{var b=Math.min(u,h),w=Math.max(u,h);if(t>(b+f)/2&&t<=(w+f)/2){i=s[d].index;break}}}else for(var j=0;j<l;j++)if(j===0&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j>0&&j<l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j===l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2){i=n[j].index;break}return i},lM=function(t){var r,n=t,s=n.type.displayName,o=(r=t.type)!==null&&r!==void 0&&r.defaultProps?po(po({},t.type.defaultProps),t.props):t.props,i=o.stroke,l=o.fill,c;switch(s){case"Line":c=i;break;case"Area":case"Radar":c=i&&i!=="none"?i:l;break;default:c=l;break}return c},fLe=function(t){var r=t.barSize,n=t.totalSize,s=t.stackGroups,o=s===void 0?{}:s;if(!o)return{};for(var i={},l=Object.keys(o),c=0,d=l.length;c<d;c++)for(var u=o[l[c]].stackGroups,f=Object.keys(u),h=0,m=f.length;h<m;h++){var v=u[f[h]],g=v.items,y=v.cateAxisId,x=g.filter(function(P){return Rf(P.type).indexOf("Bar")>=0});if(x&&x.length){var b=x[0].type.defaultProps,w=b!==void 0?po(po({},b),x[0].props):x[0].props,j=w.barSize,_=w[y];i[_]||(i[_]=[]);var C=fa(j)?r:j;i[_].push({item:x[0],stackList:x.slice(1),barSize:fa(C)?void 0:wl(C,n,0)})}}return i},mLe=function(t){var r=t.barGap,n=t.barCategoryGap,s=t.bandSize,o=t.sizeList,i=o===void 0?[]:o,l=t.maxBarSize,c=i.length;if(c<1)return null;var d=wl(r,s,0,!0),u,f=[];if(i[0].barSize===+i[0].barSize){var h=!1,m=s/c,v=i.reduce(function(j,_){return j+_.barSize||0},0);v+=(c-1)*d,v>=s&&(v-=(c-1)*d,d=0),v>=s&&m>0&&(h=!0,m*=.9,v=c*m);var g=(s-v)/2>>0,y={offset:g-d,size:0};u=i.reduce(function(j,_){var C={item:_.item,position:{offset:y.offset+y.size+d,size:h?m:_.barSize}},P=[].concat(aq(j),[C]);return y=P[P.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(E){P.push({item:E,position:y})}),P},f)}else{var x=wl(n,s,0,!0);s-2*x-(c-1)*d<=0&&(d=0);var b=(s-2*x-(c-1)*d)/c;b>1&&(b>>=0);var w=l===+l?Math.min(b,l):b;u=i.reduce(function(j,_,C){var P=[].concat(aq(j),[{item:_.item,position:{offset:x+(b+d)*C+(b-w)/2,size:w}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(E){P.push({item:E,position:P[P.length-1].position})}),P},f)}return u},hLe=function(t,r,n,s){var o=n.children,i=n.width,l=n.margin,c=i-(l.left||0)-(l.right||0),d=LQ({children:o,legendWidth:c});if(d){var u=s||{},f=u.width,h=u.height,m=d.align,v=d.verticalAlign,g=d.layout;if((g==="vertical"||g==="horizontal"&&v==="middle")&&m!=="center"&&Zr(t[m]))return po(po({},t),{},nx({},m,t[m]+(f||0)));if((g==="horizontal"||g==="vertical"&&m==="center")&&v!=="middle"&&Zr(t[v]))return po(po({},t),{},nx({},v,t[v]+(h||0)))}return t},pLe=function(t,r,n){return fa(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},FQ=function(t,r,n,s,o){var i=r.props.children,l=Dc(i,_1).filter(function(d){return pLe(s,o,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var f=No(u,n);if(fa(f))return d;var h=Array.isArray(f)?[s5(f),Vm(f)]:[f,f],m=c.reduce(function(v,g){var y=No(u,g,0),x=h[0]-Math.abs(Array.isArray(y)?y[0]:y),b=h[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(x,v[0]),Math.max(b,v[1])]},[1/0,-1/0]);return[Math.min(m[0],d[0]),Math.max(m[1],d[1])]},[1/0,-1/0])}return null},gLe=function(t,r,n,s,o){var i=r.map(function(l){return FQ(t,l,n,o,s)}).filter(function(l){return!fa(l)});return i&&i.length?i.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},$Q=function(t,r,n,s,o){var i=r.map(function(c){var d=c.props.dataKey;return n==="number"&&d&&FQ(t,c,d,s)||nb(t,d,n,o)});if(n==="number")return i.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return i.reduce(function(c,d){for(var u=0,f=d.length;u<f;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},BQ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},qQ=function(t,r,n,s){if(s)return t.map(function(c){return c.coordinate});var o,i,l=t.map(function(c){return c.coordinate===r&&(o=!0),c.coordinate===n&&(i=!0),c.coordinate});return o||l.push(r),i||l.push(n),l},If=function(t,r,n){if(!t)return null;var s=t.scale,o=t.duplicateDomain,i=t.type,l=t.range,c=t.realScaleType==="scaleBand"?s.bandwidth()/2:2,d=(r||n)&&i==="category"&&s.bandwidth?s.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&l?.length>=2?bl(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var h=o?o.indexOf(f):f;return{coordinate:s(h)+d,value:f,offset:d}});return u.filter(function(f){return!j0(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:s(f)+d,value:f,index:h,offset:d}}):s.ticks&&!n?s.ticks(t.tickCount).map(function(f){return{coordinate:s(f)+d,value:f,offset:d}}):s.domain().map(function(f,h){return{coordinate:s(f)+d,value:o?o[f]:f,index:h,offset:d}})},HP=new WeakMap,Z2=function(t,r){if(typeof r!="function")return t;HP.has(t)||HP.set(t,new WeakMap);var n=HP.get(t);if(n.has(r))return n.get(r);var s=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,s),s},zQ=function(t,r,n){var s=t.scale,o=t.type,i=t.layout,l=t.axisType;if(s==="auto")return i==="radial"&&l==="radiusAxis"?{scale:lw(),realScaleType:"band"}:i==="radial"&&l==="angleAxis"?{scale:jN(),realScaleType:"linear"}:o==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:rb(),realScaleType:"point"}:o==="category"?{scale:lw(),realScaleType:"band"}:{scale:jN(),realScaleType:"linear"};if(og(s)){var c="scale".concat(WC(s));return{scale:(JB[c]||rb)(),realScaleType:JB[c]?c:"point"}}return na(s)?{scale:s}:{scale:rb(),realScaleType:"point"}},oq=1e-4,UQ=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,s=t.range(),o=Math.min(s[0],s[1])-oq,i=Math.max(s[0],s[1])+oq,l=t(r[0]),c=t(r[n-1]);(l<o||l>i||c<o||c>i)&&t.domain([r[0],r[n-1]])}},vLe=function(t,r){if(!t)return null;for(var n=0,s=t.length;n<s;n++)if(t[n].item===r)return t[n].position;return null},xLe=function(t,r){if(!r||r.length!==2||!Zr(r[0])||!Zr(r[1]))return t;var n=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]),o=[t[0],t[1]];return(!Zr(t[0])||t[0]<n)&&(o[0]=n),(!Zr(t[1])||t[1]>s)&&(o[1]=s),o[0]>s&&(o[0]=s),o[1]<n&&(o[1]=n),o},yLe=function(t){var r=t.length;if(!(r<=0))for(var n=0,s=t[0].length;n<s;++n)for(var o=0,i=0,l=0;l<r;++l){var c=j0(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=o,t[l][n][1]=o+c,o=t[l][n][1]):(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1])}},bLe=function(t){var r=t.length;if(!(r<=0))for(var n=0,s=t[0].length;n<s;++n)for(var o=0,i=0;i<r;++i){var l=j0(t[i][n][1])?t[i][n][0]:t[i][n][1];l>=0?(t[i][n][0]=o,t[i][n][1]=o+l,o=t[i][n][1]):(t[i][n][0]=0,t[i][n][1]=0)}},wLe={sign:yLe,expand:UCe,none:Sx,silhouette:VCe,wiggle:WCe,positive:bLe},jLe=function(t,r,n){var s=r.map(function(l){return l.props.dataKey}),o=wLe[n],i=zCe().keys(s).value(function(l,c){return+No(l,c,0)}).order(XI).offset(o);return i(t)},_Le=function(t,r,n,s,o,i){if(!t)return null;var l=i?r.reverse():r,c={},d=l.reduce(function(f,h){var m,v=(m=h.type)!==null&&m!==void 0&&m.defaultProps?po(po({},h.type.defaultProps),h.props):h.props,g=v.stackId,y=v.hide;if(y)return f;var x=v[n],b=f[x]||{hasStack:!1,stackGroups:{}};if(Qo(g)){var w=b.stackGroups[g]||{numericAxisId:n,cateAxisId:s,items:[]};w.items.push(h),b.hasStack=!0,b.stackGroups[g]=w}else b.stackGroups[Cg("_stackId_")]={numericAxisId:n,cateAxisId:s,items:[h]};return po(po({},f),{},nx({},x,b))},c),u={};return Object.keys(d).reduce(function(f,h){var m=d[h];if(m.hasStack){var v={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(g,y){var x=m.stackGroups[y];return po(po({},g),{},nx({},y,{numericAxisId:n,cateAxisId:s,items:x.items,stackedData:jLe(t,x.items,o)}))},v)}return po(po({},f),{},nx({},h,m))},u)},VQ=function(t,r){var n=r.realScaleType,s=r.type,o=r.tickCount,i=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(o&&s==="number"&&i&&(i[0]==="auto"||i[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=FRe(d,o,l);return t.domain([s5(u),Vm(u)]),{niceTicks:u}}if(o&&s==="number"){var f=t.domain(),h=$Re(f,o,l);return{niceTicks:h}}return null};function EN(e){var t=e.axis,r=e.ticks,n=e.bandSize,s=e.entry,o=e.index,i=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!fa(s[t.dataKey])){var l=tN(r,"value",s[t.dataKey]);if(l)return l.coordinate+n/2}return r[o]?r[o].coordinate+n/2:null}var c=No(s,fa(i)?t.dataKey:i);return fa(c)?null:t.scale(c)}var iq=function(t){var r=t.axis,n=t.ticks,s=t.offset,o=t.bandSize,i=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+s:null;var c=No(i,r.dataKey,r.domain[l]);return fa(c)?null:r.scale(c)-o/2+s},NLe=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var s=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]);return s<=0&&o>=0?0:o<0?o:s}return n[0]},SLe=function(t,r){var n,s=(n=t.type)!==null&&n!==void 0&&n.defaultProps?po(po({},t.type.defaultProps),t.props):t.props,o=s.stackId;if(Qo(o)){var i=r[o];if(i){var l=i.items.indexOf(t);return l>=0?i.stackedData[l]:null}}return null},CLe=function(t){return t.reduce(function(r,n){return[s5(n.concat([r[0]]).filter(Zr)),Vm(n.concat([r[1]]).filter(Zr))]},[1/0,-1/0])},WQ=function(t,r,n){return Object.keys(t).reduce(function(s,o){var i=t[o],l=i.stackedData,c=l.reduce(function(d,u){var f=CLe(u.slice(r,n+1));return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]).map(function(s){return s===1/0||s===-1/0?0:s})},lq=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,cq=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,SO=function(t,r,n){if(na(t))return t(r,n);if(!Array.isArray(t))return r;var s=[];if(Zr(t[0]))s[0]=n?t[0]:Math.min(t[0],r[0]);else if(lq.test(t[0])){var o=+lq.exec(t[0])[1];s[0]=r[0]-o}else na(t[0])?s[0]=t[0](r[0]):s[0]=r[0];if(Zr(t[1]))s[1]=n?t[1]:Math.max(t[1],r[1]);else if(cq.test(t[1])){var i=+cq.exec(t[1])[1];s[1]=r[1]+i}else na(t[1])?s[1]=t[1](r[1]):s[1]=r[1];return s},kN=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var s=t.scale.bandwidth();if(!n||s>0)return s}if(t&&r&&r.length>=2){for(var o=RD(r,function(f){return f.coordinate}),i=1/0,l=1,c=o.length;l<c;l++){var d=o[l],u=o[l-1];i=Math.min((d.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0},dq=function(t,r,n){return!t||!t.length||cg(t,Tc(n,"type.defaultProps.domain"))?r:t},HQ=function(t,r){var n=t.type.defaultProps?po(po({},t.type.defaultProps),t.props):t.props,s=n.dataKey,o=n.name,i=n.unit,l=n.formatter,c=n.tooltipType,d=n.chartType,u=n.hide;return po(po({},Kn(t,!1)),{},{dataKey:s,unit:i,formatter:l,name:o||s,color:lM(t),value:No(r,s),type:c,payload:r,chartType:d,hide:u})};function vw(e){"@babel/helpers - typeof";return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(e)}function uq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function wf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uq(Object(r),!0).forEach(function(n){GQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GQ(e,t,r){return t=ALe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ALe(e){var t=PLe(e,"string");return vw(t)=="symbol"?t:t+""}function PLe(e,t){if(vw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ELe(e,t){return TLe(e)||OLe(e,t)||ILe(e,t)||kLe()}function kLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ILe(e,t){if(e){if(typeof e=="string")return fq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fq(e,t)}}function fq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function TLe(e){if(Array.isArray(e))return e}var IN=Math.PI/180,DLe=function(t){return t*180/Math.PI},Ts=function(t,r,n,s){return{x:t+Math.cos(-IN*s)*n,y:r+Math.sin(-IN*s)*n}},KQ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},MLe=function(t,r,n,s,o){var i=t.width,l=t.height,c=t.startAngle,d=t.endAngle,u=wl(t.cx,i,i/2),f=wl(t.cy,l,l/2),h=KQ(i,l,n),m=wl(t.innerRadius,h,0),v=wl(t.outerRadius,h,h*.8),g=Object.keys(r);return g.reduce(function(y,x){var b=r[x],w=b.domain,j=b.reversed,_;if(fa(b.range))s==="angleAxis"?_=[c,d]:s==="radiusAxis"&&(_=[m,v]),j&&(_=[_[1],_[0]]);else{_=b.range;var C=_,P=ELe(C,2);c=P[0],d=P[1]}var E=zQ(b,o),A=E.realScaleType,F=E.scale;F.domain(w).range(_),UQ(F);var D=VQ(F,wf(wf({},b),{},{realScaleType:A})),I=wf(wf(wf({},b),D),{},{range:_,radius:v,realScaleType:A,scale:F,cx:u,cy:f,innerRadius:m,outerRadius:v,startAngle:c,endAngle:d});return wf(wf({},y),{},GQ({},x,I))},{})},RLe=function(t,r){var n=t.x,s=t.y,o=r.x,i=r.y;return Math.sqrt(Math.pow(n-o,2)+Math.pow(s-i,2))},LLe=function(t,r){var n=t.x,s=t.y,o=r.cx,i=r.cy,l=RLe({x:n,y:s},{x:o,y:i});if(l<=0)return{radius:l};var c=(n-o)/l,d=Math.acos(c);return s>i&&(d=2*Math.PI-d),{radius:l,angle:DLe(d),angleInRadian:d}},FLe=function(t){var r=t.startAngle,n=t.endAngle,s=Math.floor(r/360),o=Math.floor(n/360),i=Math.min(s,o);return{startAngle:r-i*360,endAngle:n-i*360}},$Le=function(t,r){var n=r.startAngle,s=r.endAngle,o=Math.floor(n/360),i=Math.floor(s/360),l=Math.min(o,i);return t+l*360},mq=function(t,r){var n=t.x,s=t.y,o=LLe({x:n,y:s},r),i=o.radius,l=o.angle,c=r.innerRadius,d=r.outerRadius;if(i<c||i>d)return!1;if(i===0)return!0;var u=FLe(r),f=u.startAngle,h=u.endAngle,m=l,v;if(f<=h){for(;m>h;)m-=360;for(;m<f;)m+=360;v=m>=f&&m<=h}else{for(;m>f;)m-=360;for(;m<h;)m+=360;v=m>=h&&m<=f}return v?wf(wf({},r),{},{radius:i,angle:$Le(m,r)}):null},XQ=function(t){return!p.isValidElement(t)&&!na(t)&&typeof t!="boolean"?t.className:""};function xw(e){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(e)}var BLe=["offset"];function qLe(e){return WLe(e)||VLe(e)||ULe(e)||zLe()}function zLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ULe(e,t){if(e){if(typeof e=="string")return CO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CO(e,t)}}function VLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WLe(e){if(Array.isArray(e))return CO(e)}function CO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HLe(e,t){if(e==null)return{};var r=GLe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function GLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function hq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Uo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hq(Object(r),!0).forEach(function(n){KLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KLe(e,t,r){return t=XLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XLe(e){var t=YLe(e,"string");return xw(t)=="symbol"?t:t+""}function YLe(e,t){if(xw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yw(){return yw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yw.apply(this,arguments)}var JLe=function(t){var r=t.value,n=t.formatter,s=fa(t.children)?r:t.children;return na(n)?n(s):s},QLe=function(t,r){var n=bl(r-t),s=Math.min(Math.abs(r-t),360);return n*s},ZLe=function(t,r,n){var s=t.position,o=t.viewBox,i=t.offset,l=t.className,c=o,d=c.cx,u=c.cy,f=c.innerRadius,h=c.outerRadius,m=c.startAngle,v=c.endAngle,g=c.clockWise,y=(f+h)/2,x=QLe(m,v),b=x>=0?1:-1,w,j;s==="insideStart"?(w=m+b*i,j=g):s==="insideEnd"?(w=v-b*i,j=!g):s==="end"&&(w=v+b*i,j=g),j=x<=0?j:!j;var _=Ts(d,u,y,w),C=Ts(d,u,y,w+(j?1:-1)*359),P="M".concat(_.x,",").concat(_.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(j?0:1,`,
    `).concat(C.x,",").concat(C.y),E=fa(t.id)?Cg("recharts-radial-line-"):t.id;return Se.createElement("text",yw({},n,{dominantBaseline:"central",className:ga("recharts-radial-bar-label",l)}),Se.createElement("defs",null,Se.createElement("path",{id:E,d:P})),Se.createElement("textPath",{xlinkHref:"#".concat(E)},r))},eFe=function(t){var r=t.viewBox,n=t.offset,s=t.position,o=r,i=o.cx,l=o.cy,c=o.innerRadius,d=o.outerRadius,u=o.startAngle,f=o.endAngle,h=(u+f)/2;if(s==="outside"){var m=Ts(i,l,d+n,h),v=m.x,g=m.y;return{x:v,y:g,textAnchor:v>=i?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"end"};var y=(c+d)/2,x=Ts(i,l,y,h),b=x.x,w=x.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},tFe=function(t){var r=t.viewBox,n=t.parentViewBox,s=t.offset,o=t.position,i=r,l=i.x,c=i.y,d=i.width,u=i.height,f=u>=0?1:-1,h=f*s,m=f>0?"end":"start",v=f>0?"start":"end",g=d>=0?1:-1,y=g*s,x=g>0?"end":"start",b=g>0?"start":"end";if(o==="top"){var w={x:l+d/2,y:c-f*s,textAnchor:"middle",verticalAnchor:m};return Uo(Uo({},w),n?{height:Math.max(c-n.y,0),width:d}:{})}if(o==="bottom"){var j={x:l+d/2,y:c+u+h,textAnchor:"middle",verticalAnchor:v};return Uo(Uo({},j),n?{height:Math.max(n.y+n.height-(c+u),0),width:d}:{})}if(o==="left"){var _={x:l-y,y:c+u/2,textAnchor:x,verticalAnchor:"middle"};return Uo(Uo({},_),n?{width:Math.max(_.x-n.x,0),height:u}:{})}if(o==="right"){var C={x:l+d+y,y:c+u/2,textAnchor:b,verticalAnchor:"middle"};return Uo(Uo({},C),n?{width:Math.max(n.x+n.width-C.x,0),height:u}:{})}var P=n?{width:d,height:u}:{};return o==="insideLeft"?Uo({x:l+y,y:c+u/2,textAnchor:b,verticalAnchor:"middle"},P):o==="insideRight"?Uo({x:l+d-y,y:c+u/2,textAnchor:x,verticalAnchor:"middle"},P):o==="insideTop"?Uo({x:l+d/2,y:c+h,textAnchor:"middle",verticalAnchor:v},P):o==="insideBottom"?Uo({x:l+d/2,y:c+u-h,textAnchor:"middle",verticalAnchor:m},P):o==="insideTopLeft"?Uo({x:l+y,y:c+h,textAnchor:b,verticalAnchor:v},P):o==="insideTopRight"?Uo({x:l+d-y,y:c+h,textAnchor:x,verticalAnchor:v},P):o==="insideBottomLeft"?Uo({x:l+y,y:c+u-h,textAnchor:b,verticalAnchor:m},P):o==="insideBottomRight"?Uo({x:l+d-y,y:c+u-h,textAnchor:x,verticalAnchor:m},P):x0(o)&&(Zr(o.x)||Cp(o.x))&&(Zr(o.y)||Cp(o.y))?Uo({x:l+wl(o.x,d),y:c+wl(o.y,u),textAnchor:"end",verticalAnchor:"end"},P):Uo({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},P)},rFe=function(t){return"cx"in t&&Zr(t.cx)};function li(e){var t=e.offset,r=t===void 0?5:t,n=HLe(e,BLe),s=Uo({offset:r},n),o=s.viewBox,i=s.position,l=s.value,c=s.children,d=s.content,u=s.className,f=u===void 0?"":u,h=s.textBreakAll;if(!o||fa(l)&&fa(c)&&!p.isValidElement(d)&&!na(d))return null;if(p.isValidElement(d))return p.cloneElement(d,s);var m;if(na(d)){if(m=p.createElement(d,s),p.isValidElement(m))return m}else m=JLe(s);var v=rFe(o),g=Kn(s,!0);if(v&&(i==="insideStart"||i==="insideEnd"||i==="end"))return ZLe(s,m,g);var y=v?eFe(s):tFe(s);return Se.createElement(lg,yw({className:ga("recharts-label",f)},g,y,{breakAll:h}),m)}li.displayName="Label";var YQ=function(t){var r=t.cx,n=t.cy,s=t.angle,o=t.startAngle,i=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,f=t.x,h=t.y,m=t.top,v=t.left,g=t.width,y=t.height,x=t.clockWise,b=t.labelViewBox;if(b)return b;if(Zr(g)&&Zr(y)){if(Zr(f)&&Zr(h))return{x:f,y:h,width:g,height:y};if(Zr(m)&&Zr(v))return{x:m,y:v,width:g,height:y}}return Zr(f)&&Zr(h)?{x:f,y:h,width:0,height:0}:Zr(r)&&Zr(n)?{cx:r,cy:n,startAngle:o||s||0,endAngle:i||s||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:x}:t.viewBox?t.viewBox:{}},nFe=function(t,r){return t?t===!0?Se.createElement(li,{key:"label-implicit",viewBox:r}):Qo(t)?Se.createElement(li,{key:"label-implicit",viewBox:r,value:t}):p.isValidElement(t)?t.type===li?p.cloneElement(t,{key:"label-implicit",viewBox:r}):Se.createElement(li,{key:"label-implicit",content:t,viewBox:r}):na(t)?Se.createElement(li,{key:"label-implicit",content:t,viewBox:r}):x0(t)?Se.createElement(li,yw({viewBox:r},t,{key:"label-implicit"})):null:null},aFe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var s=t.children,o=YQ(t),i=Dc(s,li).map(function(c,d){return p.cloneElement(c,{viewBox:r||o,key:"label-".concat(d)})});if(!n)return i;var l=nFe(t.label,r||o);return[l].concat(qLe(i))};li.parseViewBox=YQ;li.renderCallByParent=aFe;function sFe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var oFe=sFe;const iFe=Ga(oFe);function bw(e){"@babel/helpers - typeof";return bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bw(e)}var lFe=["valueAccessor"],cFe=["data","dataKey","clockWise","id","textBreakAll"];function dFe(e){return hFe(e)||mFe(e)||fFe(e)||uFe()}function uFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fFe(e,t){if(e){if(typeof e=="string")return AO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AO(e,t)}}function mFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hFe(e){if(Array.isArray(e))return AO(e)}function AO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ON(){return ON=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ON.apply(this,arguments)}function pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function gq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pq(Object(r),!0).forEach(function(n){pFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pFe(e,t,r){return t=gFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gFe(e){var t=vFe(e,"string");return bw(t)=="symbol"?t:t+""}function vFe(e,t){if(bw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vq(e,t){if(e==null)return{};var r=xFe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var yFe=function(t){return Array.isArray(t.value)?iFe(t.value):t.value};function Gu(e){var t=e.valueAccessor,r=t===void 0?yFe:t,n=vq(e,lFe),s=n.data,o=n.dataKey,i=n.clockWise,l=n.id,c=n.textBreakAll,d=vq(n,cFe);return!s||!s.length?null:Se.createElement(Ta,{className:"recharts-label-list"},s.map(function(u,f){var h=fa(o)?r(u,f):No(u&&u.payload,o),m=fa(l)?{}:{id:"".concat(l,"-").concat(f)};return Se.createElement(li,ON({},Kn(u,!0),d,m,{parentViewBox:u.parentViewBox,value:h,textBreakAll:c,viewBox:li.parseViewBox(fa(i)?u:gq(gq({},u),{},{clockWise:i})),key:"label-".concat(f),index:f}))}))}Gu.displayName="LabelList";function bFe(e,t){return e?e===!0?Se.createElement(Gu,{key:"labelList-implicit",data:t}):Se.isValidElement(e)||na(e)?Se.createElement(Gu,{key:"labelList-implicit",data:t,content:e}):x0(e)?Se.createElement(Gu,ON({data:t},e,{key:"labelList-implicit"})):null:null}function wFe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,s=Dc(n,Gu).map(function(i,l){return p.cloneElement(i,{data:t,key:"labelList-".concat(l)})});if(!r)return s;var o=bFe(e.label,t);return[o].concat(dFe(s))}Gu.renderCallByParent=wFe;function ww(e){"@babel/helpers - typeof";return ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ww(e)}function PO(){return PO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PO.apply(this,arguments)}function xq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function yq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xq(Object(r),!0).forEach(function(n){jFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jFe(e,t,r){return t=_Fe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Fe(e){var t=NFe(e,"string");return ww(t)=="symbol"?t:t+""}function NFe(e,t){if(ww(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ww(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SFe=function(t,r){var n=bl(r-t),s=Math.min(Math.abs(r-t),359.999);return n*s},ej=function(t){var r=t.cx,n=t.cy,s=t.radius,o=t.angle,i=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+s,f=Math.asin(c/u)/IN,h=d?o:o+i*f,m=Ts(r,n,u,h),v=Ts(r,n,s,h),g=d?o-i*f:o,y=Ts(r,n,u*Math.cos(f*IN),g);return{center:m,circleTangency:v,lineTangency:y,theta:f}},JQ=function(t){var r=t.cx,n=t.cy,s=t.innerRadius,o=t.outerRadius,i=t.startAngle,l=t.endAngle,c=SFe(i,l),d=i+c,u=Ts(r,n,o,i),f=Ts(r,n,o,d),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(o,",").concat(o,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(i>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(s>0){var m=Ts(r,n,s,i),v=Ts(r,n,s,d);h+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(i<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},CFe=function(t){var r=t.cx,n=t.cy,s=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,f=bl(u-d),h=ej({cx:r,cy:n,radius:o,angle:d,sign:f,cornerRadius:i,cornerIsExternal:c}),m=h.circleTangency,v=h.lineTangency,g=h.theta,y=ej({cx:r,cy:n,radius:o,angle:u,sign:-f,cornerRadius:i,cornerIsExternal:c}),x=y.circleTangency,b=y.lineTangency,w=y.theta,j=c?Math.abs(d-u):Math.abs(d-u)-g-w;if(j<0)return l?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):JQ({cx:r,cy:n,innerRadius:s,outerRadius:o,startAngle:d,endAngle:u});var _="M ".concat(v.x,",").concat(v.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(o,",").concat(o,",0,").concat(+(j>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
  `);if(s>0){var C=ej({cx:r,cy:n,radius:s,angle:d,sign:f,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),P=C.circleTangency,E=C.lineTangency,A=C.theta,F=ej({cx:r,cy:n,radius:s,angle:u,sign:-f,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),D=F.circleTangency,I=F.lineTangency,R=F.theta,M=c?Math.abs(d-u):Math.abs(d-u)-A-R;if(M<0&&i===0)return"".concat(_,"L").concat(r,",").concat(n,"Z");_+="L".concat(I.x,",").concat(I.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(M>180),",").concat(+(f>0),",").concat(P.x,",").concat(P.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(E.x,",").concat(E.y,"Z")}else _+="L".concat(r,",").concat(n,"Z");return _},AFe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},cM=function(t){var r=yq(yq({},AFe),t),n=r.cx,s=r.cy,o=r.innerRadius,i=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,h=r.className;if(i<o||u===f)return null;var m=ga("recharts-sector",h),v=i-o,g=wl(l,v,0,!0),y;return g>0&&Math.abs(u-f)<360?y=CFe({cx:n,cy:s,innerRadius:o,outerRadius:i,cornerRadius:Math.min(g,v/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):y=JQ({cx:n,cy:s,innerRadius:o,outerRadius:i,startAngle:u,endAngle:f}),Se.createElement("path",PO({},Kn(r,!0),{className:m,d:y,role:"img"}))};function jw(e){"@babel/helpers - typeof";return jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jw(e)}function EO(){return EO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},EO.apply(this,arguments)}function bq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function wq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bq(Object(r),!0).forEach(function(n){PFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PFe(e,t,r){return t=EFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EFe(e){var t=kFe(e,"string");return jw(t)=="symbol"?t:t+""}function kFe(e,t){if(jw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jq={curveBasisClosed:ICe,curveBasisOpen:OCe,curveBasis:kCe,curveBumpX:gCe,curveBumpY:vCe,curveLinearClosed:TCe,curveLinear:GC,curveMonotoneX:DCe,curveMonotoneY:MCe,curveNatural:RCe,curveStep:LCe,curveStepAfter:$Ce,curveStepBefore:FCe},tj=function(t){return t.x===+t.x&&t.y===+t.y},dy=function(t){return t.x},uy=function(t){return t.y},IFe=function(t,r){if(na(t))return t;var n="curve".concat(WC(t));return(n==="curveMonotone"||n==="curveBump")&&r?jq["".concat(n).concat(r==="vertical"?"Y":"X")]:jq[n]||GC},OFe=function(t){var r=t.type,n=r===void 0?"linear":r,s=t.points,o=s===void 0?[]:s,i=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=IFe(n,l),f=d?o.filter(function(g){return tj(g)}):o,h;if(Array.isArray(i)){var m=d?i.filter(function(g){return tj(g)}):i,v=f.map(function(g,y){return wq(wq({},g),{},{base:m[y]})});return l==="vertical"?h=W2().y(uy).x1(dy).x0(function(g){return g.base.x}):h=W2().x(dy).y1(uy).y0(function(g){return g.base.y}),h.defined(tj).curve(u),h(v)}return l==="vertical"&&Zr(i)?h=W2().y(uy).x1(dy).x0(i):Zr(i)?h=W2().x(dy).y1(uy).y0(i):h=HY().x(dy).y(uy),h.defined(tj).curve(u),h(f)},Vp=function(t){var r=t.className,n=t.points,s=t.path,o=t.pathRef;if((!n||!n.length)&&!s)return null;var i=n&&n.length?OFe(t):s;return p.createElement("path",EO({},Kn(t,!1),rN(t),{className:ga("recharts-curve",r),d:i,ref:o}))},QQ={exports:{}},TFe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",DFe=TFe,MFe=DFe;function ZQ(){}function eZ(){}eZ.resetWarningCache=ZQ;var RFe=function(){function e(n,s,o,i,l,c){if(c!==MFe){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:eZ,resetWarningCache:ZQ};return r.PropTypes=r,r};QQ.exports=RFe();var LFe=QQ.exports;const Jn=Ga(LFe);var FFe=Object.getOwnPropertyNames,$Fe=Object.getOwnPropertySymbols,BFe=Object.prototype.hasOwnProperty;function _q(e,t){return function(n,s,o){return e(n,s,o)&&t(n,s,o)}}function rj(e){return function(r,n,s){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,s);var o=s.cache,i=o.get(r),l=o.get(n);if(i&&l)return i===n&&l===r;o.set(r,n),o.set(n,r);var c=e(r,n,s);return o.delete(r),o.delete(n),c}}function Nq(e){return FFe(e).concat($Fe(e))}var qFe=Object.hasOwn||function(e,t){return BFe.call(e,t)};function Eg(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var zFe="__v",UFe="__o",VFe="_owner",Sq=Object.getOwnPropertyDescriptor,Cq=Object.keys;function WFe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function HFe(e,t){return Eg(e.getTime(),t.getTime())}function GFe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function KFe(e,t){return e===t}function Aq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var s=new Array(n),o=e.entries(),i,l,c=0;(i=o.next())&&!i.done;){for(var d=t.entries(),u=!1,f=0;(l=d.next())&&!l.done;){if(s[f]){f++;continue}var h=i.value,m=l.value;if(r.equals(h[0],m[0],c,f,e,t,r)&&r.equals(h[1],m[1],h[0],m[0],e,t,r)){u=s[f]=!0;break}f++}if(!u)return!1;c++}return!0}var XFe=Eg;function YFe(e,t,r){var n=Cq(e),s=n.length;if(Cq(t).length!==s)return!1;for(;s-- >0;)if(!tZ(e,t,r,n[s]))return!1;return!0}function fy(e,t,r){var n=Nq(e),s=n.length;if(Nq(t).length!==s)return!1;for(var o,i,l;s-- >0;)if(o=n[s],!tZ(e,t,r,o)||(i=Sq(e,o),l=Sq(t,o),(i||l)&&(!i||!l||i.configurable!==l.configurable||i.enumerable!==l.enumerable||i.writable!==l.writable)))return!1;return!0}function JFe(e,t){return Eg(e.valueOf(),t.valueOf())}function QFe(e,t){return e.source===t.source&&e.flags===t.flags}function Pq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var s=new Array(n),o=e.values(),i,l;(i=o.next())&&!i.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!s[u]&&r.equals(i.value,l.value,i.value,l.value,e,t,r)){d=s[u]=!0;break}u++}if(!d)return!1}return!0}function ZFe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function e$e(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function tZ(e,t,r,n){return(n===VFe||n===UFe||n===zFe)&&(e.$$typeof||t.$$typeof)?!0:qFe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var t$e="[object Arguments]",r$e="[object Boolean]",n$e="[object Date]",a$e="[object Error]",s$e="[object Map]",o$e="[object Number]",i$e="[object Object]",l$e="[object RegExp]",c$e="[object Set]",d$e="[object String]",u$e="[object URL]",f$e=Array.isArray,Eq=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,kq=Object.assign,m$e=Object.prototype.toString.call.bind(Object.prototype.toString);function h$e(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,s=e.areFunctionsEqual,o=e.areMapsEqual,i=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(v,g,y){if(v===g)return!0;if(v==null||g==null)return!1;var x=typeof v;if(x!==typeof g)return!1;if(x!=="object")return x==="number"?i(v,g,y):x==="function"?s(v,g,y):!1;var b=v.constructor;if(b!==g.constructor)return!1;if(b===Object)return l(v,g,y);if(f$e(v))return t(v,g,y);if(Eq!=null&&Eq(v))return f(v,g,y);if(b===Date)return r(v,g,y);if(b===RegExp)return d(v,g,y);if(b===Map)return o(v,g,y);if(b===Set)return u(v,g,y);var w=m$e(v);return w===n$e?r(v,g,y):w===l$e?d(v,g,y):w===s$e?o(v,g,y):w===c$e?u(v,g,y):w===i$e?typeof v.then!="function"&&typeof g.then!="function"&&l(v,g,y):w===u$e?h(v,g,y):w===a$e?n(v,g,y):w===t$e?l(v,g,y):w===r$e||w===o$e||w===d$e?c(v,g,y):!1}}function p$e(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,s={areArraysEqual:n?fy:WFe,areDatesEqual:HFe,areErrorsEqual:GFe,areFunctionsEqual:KFe,areMapsEqual:n?_q(Aq,fy):Aq,areNumbersEqual:XFe,areObjectsEqual:n?fy:YFe,arePrimitiveWrappersEqual:JFe,areRegExpsEqual:QFe,areSetsEqual:n?_q(Pq,fy):Pq,areTypedArraysEqual:n?fy:ZFe,areUrlsEqual:e$e};if(r&&(s=kq({},s,r(s))),t){var o=rj(s.areArraysEqual),i=rj(s.areMapsEqual),l=rj(s.areObjectsEqual),c=rj(s.areSetsEqual);s=kq({},s,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:l,areSetsEqual:c})}return s}function g$e(e){return function(t,r,n,s,o,i,l){return e(t,r,l)}}function v$e(e){var t=e.circular,r=e.comparator,n=e.createState,s=e.equals,o=e.strict;if(n)return function(c,d){var u=n(),f=u.cache,h=f===void 0?t?new WeakMap:void 0:f,m=u.meta;return r(c,d,{cache:h,equals:s,meta:m,strict:o})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:s,meta:void 0,strict:o})};var i={cache:void 0,equals:s,meta:void 0,strict:o};return function(c,d){return r(c,d,i)}}var x$e=Uh();Uh({strict:!0});Uh({circular:!0});Uh({circular:!0,strict:!0});Uh({createInternalComparator:function(){return Eg}});Uh({strict:!0,createInternalComparator:function(){return Eg}});Uh({circular:!0,createInternalComparator:function(){return Eg}});Uh({circular:!0,createInternalComparator:function(){return Eg},strict:!0});function Uh(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,s=e.createState,o=e.strict,i=o===void 0?!1:o,l=p$e(e),c=h$e(l),d=n?n(c):g$e(c);return v$e({circular:r,comparator:c,createState:s,equals:d,strict:i})}function y$e(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Iq(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function s(o){r<0&&(r=o),o-r>t?(e(o),r=-1):y$e(s)};requestAnimationFrame(n)}function kO(e){"@babel/helpers - typeof";return kO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kO(e)}function b$e(e){return N$e(e)||_$e(e)||j$e(e)||w$e()}function w$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j$e(e,t){if(e){if(typeof e=="string")return Oq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Oq(e,t)}}function Oq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function N$e(e){if(Array.isArray(e))return e}function S$e(){var e={},t=function(){return null},r=!1,n=function s(o){if(!r){if(Array.isArray(o)){if(!o.length)return;var i=o,l=b$e(i),c=l[0],d=l.slice(1);if(typeof c=="number"){Iq(s.bind(null,d),c);return}s(c),Iq(s.bind(null,d));return}kO(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){r=!0},start:function(o){r=!1,n(o)},subscribe:function(o){return t=o,function(){t=function(){return null}}}}}function _w(e){"@babel/helpers - typeof";return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}function Tq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Dq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tq(Object(r),!0).forEach(function(n){rZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rZ(e,t,r){return t=C$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C$e(e){var t=A$e(e,"string");return _w(t)==="symbol"?t:String(t)}function A$e(e,t){if(_w(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_w(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P$e=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,s){return n.filter(function(o){return s.includes(o)})})},E$e=function(t){return t},k$e=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},ab=function(t,r){return Object.keys(r).reduce(function(n,s){return Dq(Dq({},n),{},rZ({},s,t(s,r[s])))},{})},Mq=function(t,r,n){return t.map(function(s){return"".concat(k$e(s)," ").concat(r,"ms ").concat(n)}).join(",")};function I$e(e,t){return D$e(e)||T$e(e,t)||nZ(e,t)||O$e()}function O$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function D$e(e){if(Array.isArray(e))return e}function M$e(e){return F$e(e)||L$e(e)||nZ(e)||R$e()}function R$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nZ(e,t){if(e){if(typeof e=="string")return IO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IO(e,t)}}function L$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function F$e(e){if(Array.isArray(e))return IO(e)}function IO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var TN=1e-4,aZ=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},sZ=function(t,r){return t.map(function(n,s){return n*Math.pow(r,s)}).reduce(function(n,s){return n+s})},Rq=function(t,r){return function(n){var s=aZ(t,r);return sZ(s,n)}},$$e=function(t,r){return function(n){var s=aZ(t,r),o=[].concat(M$e(s.map(function(i,l){return i*l}).slice(1)),[0]);return sZ(o,n)}},Lq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r[0],o=r[1],i=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":s=0,o=0,i=1,l=1;break;case"ease":s=.25,o=.1,i=.25,l=1;break;case"ease-in":s=.42,o=0,i=1,l=1;break;case"ease-out":s=.42,o=0,i=.58,l=1;break;case"ease-in-out":s=0,o=0,i=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),u=I$e(d,4);s=u[0],o=u[1],i=u[2],l=u[3]}}}var f=Rq(s,i),h=Rq(o,l),m=$$e(s,i),v=function(x){return x>1?1:x<0?0:x},g=function(x){for(var b=x>1?1:x,w=b,j=0;j<8;++j){var _=f(w)-b,C=m(w);if(Math.abs(_-b)<TN||C<TN)return h(w);w=v(w-_/C)}return h(w)};return g.isStepper=!1,g},B$e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,s=t.damping,o=s===void 0?8:s,i=t.dt,l=i===void 0?17:i,c=function(u,f,h){var m=-(u-f)*n,v=h*o,g=h+(m-v)*l/1e3,y=h*l/1e3+u;return Math.abs(y-f)<TN&&Math.abs(g)<TN?[f,0]:[y,g]};return c.isStepper=!0,c.dt=l,c},q$e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r[0];if(typeof s=="string")switch(s){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Lq(s);case"spring":return B$e();default:if(s.split("(")[0]==="cubic-bezier")return Lq(s)}return typeof s=="function"?s:null};function Nw(e){"@babel/helpers - typeof";return Nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nw(e)}function Fq(e){return V$e(e)||U$e(e)||oZ(e)||z$e()}function z$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function V$e(e){if(Array.isArray(e))return TO(e)}function $q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ei(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$q(Object(r),!0).forEach(function(n){OO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$q(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OO(e,t,r){return t=W$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W$e(e){var t=H$e(e,"string");return Nw(t)==="symbol"?t:String(t)}function H$e(e,t){if(Nw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function G$e(e,t){return Y$e(e)||X$e(e,t)||oZ(e,t)||K$e()}function K$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oZ(e,t){if(e){if(typeof e=="string")return TO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TO(e,t)}}function TO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function X$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function Y$e(e){if(Array.isArray(e))return e}var DN=function(t,r,n){return t+(r-t)*n},DO=function(t){var r=t.from,n=t.to;return r!==n},J$e=function e(t,r,n){var s=ab(function(o,i){if(DO(i)){var l=t(i.from,i.to,i.velocity),c=G$e(l,2),d=c[0],u=c[1];return Ei(Ei({},i),{},{from:d,velocity:u})}return i},r);return n<1?ab(function(o,i){return DO(i)?Ei(Ei({},i),{},{velocity:DN(i.velocity,s[o].velocity,n),from:DN(i.from,s[o].from,n)}):i},r):e(t,s,n-1)};const Q$e=function(e,t,r,n,s){var o=P$e(e,t),i=o.reduce(function(y,x){return Ei(Ei({},y),{},OO({},x,[e[x],t[x]]))},{}),l=o.reduce(function(y,x){return Ei(Ei({},y),{},OO({},x,{from:e[x],velocity:0,to:t[x]}))},{}),c=-1,d,u,f=function(){return null},h=function(){return ab(function(x,b){return b.from},l)},m=function(){return!Object.values(l).filter(DO).length},v=function(x){d||(d=x);var b=x-d,w=b/r.dt;l=J$e(r,l,w),s(Ei(Ei(Ei({},e),t),h())),d=x,m()||(c=requestAnimationFrame(f))},g=function(x){u||(u=x);var b=(x-u)/n,w=ab(function(_,C){return DN.apply(void 0,Fq(C).concat([r(b)]))},i);if(s(Ei(Ei(Ei({},e),t),w)),b<1)c=requestAnimationFrame(f);else{var j=ab(function(_,C){return DN.apply(void 0,Fq(C).concat([r(1)]))},i);s(Ei(Ei(Ei({},e),t),j))}};return f=r.isStepper?v:g,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function Dx(e){"@babel/helpers - typeof";return Dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dx(e)}var Z$e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function e6e(e,t){if(e==null)return{};var r=t6e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t6e(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,o;for(o=0;o<n.length;o++)s=n[o],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function GP(e){return s6e(e)||a6e(e)||n6e(e)||r6e()}function r6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n6e(e,t){if(e){if(typeof e=="string")return MO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MO(e,t)}}function a6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function s6e(e){if(Array.isArray(e))return MO(e)}function MO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function qd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bq(Object(r),!0).forEach(function(n){Ey(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ey(e,t,r){return t=iZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iZ(n.key),n)}}function i6e(e,t,r){return t&&qq(e.prototype,t),r&&qq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iZ(e){var t=l6e(e,"string");return Dx(t)==="symbol"?t:String(t)}function l6e(e,t){if(Dx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function c6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RO(e,t)}function RO(e,t){return RO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},RO(e,t)}function d6e(e){var t=u6e();return function(){var n=MN(e),s;if(t){var o=MN(this).constructor;s=Reflect.construct(n,arguments,o)}else s=n.apply(this,arguments);return LO(this,s)}}function LO(e,t){if(t&&(Dx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FO(e)}function FO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function MN(e){return MN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},MN(e)}var l5=function(e){c6e(r,e);var t=d6e(r);function r(n,s){var o;o6e(this,r),o=t.call(this,n,s);var i=o.props,l=i.isActive,c=i.attributeName,d=i.from,u=i.to,f=i.steps,h=i.children,m=i.duration;if(o.handleStyleChange=o.handleStyleChange.bind(FO(o)),o.changeStyle=o.changeStyle.bind(FO(o)),!l||m<=0)return o.state={style:{}},typeof h=="function"&&(o.state={style:u}),LO(o);if(f&&f.length)o.state={style:f[0].style};else if(d){if(typeof h=="function")return o.state={style:d},LO(o);o.state={style:c?Ey({},c,d):d}}else o.state={style:{}};return o}return i6e(r,[{key:"componentDidMount",value:function(){var s=this.props,o=s.isActive,i=s.canBegin;this.mounted=!0,!(!o||!i)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(s){var o=this.props,i=o.isActive,l=o.canBegin,c=o.attributeName,d=o.shouldReAnimate,u=o.to,f=o.from,h=this.state.style;if(l){if(!i){var m={style:c?Ey({},c,u):u};this.state&&h&&(c&&h[c]!==u||!c&&h!==u)&&this.setState(m);return}if(!(x$e(s.to,u)&&s.canBegin&&s.isActive)){var v=!s.canBegin||!s.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=v||d?f:s.to;if(this.state&&h){var y={style:c?Ey({},c,g):g};(c&&h[c]!==g||!c&&h!==g)&&this.setState(y)}this.runAnimation(qd(qd({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),s&&s()}},{key:"handleStyleChange",value:function(s){this.changeStyle(s)}},{key:"changeStyle",value:function(s){this.mounted&&this.setState({style:s})}},{key:"runJSAnimation",value:function(s){var o=this,i=s.from,l=s.to,c=s.duration,d=s.easing,u=s.begin,f=s.onAnimationEnd,h=s.onAnimationStart,m=Q$e(i,l,q$e(d),c,this.changeStyle),v=function(){o.stopJSAnimation=m()};this.manager.start([h,u,v,c,f])}},{key:"runStepAnimation",value:function(s){var o=this,i=s.steps,l=s.begin,c=s.onAnimationStart,d=i[0],u=d.style,f=d.duration,h=f===void 0?0:f,m=function(g,y,x){if(x===0)return g;var b=y.duration,w=y.easing,j=w===void 0?"ease":w,_=y.style,C=y.properties,P=y.onAnimationEnd,E=x>0?i[x-1]:y,A=C||Object.keys(_);if(typeof j=="function"||j==="spring")return[].concat(GP(g),[o.runJSAnimation.bind(o,{from:E.style,to:_,duration:b,easing:j}),b]);var F=Mq(A,b,j),D=qd(qd(qd({},E.style),_),{},{transition:F});return[].concat(GP(g),[D,b,P]).filter(E$e)};return this.manager.start([c].concat(GP(i.reduce(m,[u,Math.max(h,l)])),[s.onAnimationEnd]))}},{key:"runAnimation",value:function(s){this.manager||(this.manager=S$e());var o=s.begin,i=s.duration,l=s.attributeName,c=s.to,d=s.easing,u=s.onAnimationStart,f=s.onAnimationEnd,h=s.steps,m=s.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof d=="function"||typeof m=="function"||d==="spring"){this.runJSAnimation(s);return}if(h.length>1){this.runStepAnimation(s);return}var g=l?Ey({},l,c):c,y=Mq(Object.keys(g),i,d);v.start([u,o,qd(qd({},g),{},{transition:y}),i,f])}},{key:"render",value:function(){var s=this.props,o=s.children;s.begin;var i=s.duration;s.attributeName,s.easing;var l=s.isActive;s.steps,s.from,s.to,s.canBegin,s.onAnimationEnd,s.shouldReAnimate,s.onAnimationReStart;var c=e6e(s,Z$e),d=p.Children.count(o),u=this.state.style;if(typeof o=="function")return o(u);if(!l||d===0||i<=0)return o;var f=function(m){var v=m.props,g=v.style,y=g===void 0?{}:g,x=v.className,b=p.cloneElement(m,qd(qd({},c),{},{style:qd(qd({},y),u),className:x}));return b};return d===1?f(p.Children.only(o)):Se.createElement("div",null,p.Children.map(o,function(h){return f(h)}))}}]),r}(p.PureComponent);l5.displayName="Animate";l5.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};l5.propTypes={from:Jn.oneOfType([Jn.object,Jn.string]),to:Jn.oneOfType([Jn.object,Jn.string]),attributeName:Jn.string,duration:Jn.number,begin:Jn.number,easing:Jn.oneOfType([Jn.string,Jn.func]),steps:Jn.arrayOf(Jn.shape({duration:Jn.number.isRequired,style:Jn.object.isRequired,easing:Jn.oneOfType([Jn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Jn.func]),properties:Jn.arrayOf("string"),onAnimationEnd:Jn.func})),children:Jn.oneOfType([Jn.node,Jn.func]),isActive:Jn.bool,canBegin:Jn.bool,onAnimationEnd:Jn.func,shouldReAnimate:Jn.bool,onAnimationStart:Jn.func,onAnimationReStart:Jn.func};const Ph=l5;function ea(){return ea=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ea.apply(null,arguments)}function RN(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function lZ(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,LI(e,t)}function Sw(e){"@babel/helpers - typeof";return Sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sw(e)}function LN(){return LN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LN.apply(this,arguments)}function f6e(e,t){return g6e(e)||p6e(e,t)||h6e(e,t)||m6e()}function m6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h6e(e,t){if(e){if(typeof e=="string")return zq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zq(e,t)}}function zq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p6e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function g6e(e){if(Array.isArray(e))return e}function Uq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Vq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uq(Object(r),!0).forEach(function(n){v6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v6e(e,t,r){return t=x6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x6e(e){var t=y6e(e,"string");return Sw(t)=="symbol"?t:t+""}function y6e(e,t){if(Sw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wq=function(t,r,n,s,o){var i=Math.min(Math.abs(n)/2,Math.abs(s)/2),l=s>=0?1:-1,c=n>=0?1:-1,d=s>=0&&n>=0||s<0&&n<0?1:0,u;if(i>0&&o instanceof Array){for(var f=[0,0,0,0],h=0,m=4;h<m;h++)f[h]=o[h]>i?i:o[h];u="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(r)),u+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+l*f[1])),u+="L ".concat(t+n,",").concat(r+s-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+n-c*f[2],",").concat(r+s)),u+="L ".concat(t+c*f[3],",").concat(r+s),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+s-l*f[3])),u+="Z"}else if(i>0&&o===+o&&o>0){var v=Math.min(i,o);u="M ".concat(t,",").concat(r+l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+c*v,",").concat(r,`
            L `).concat(t+n-c*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n,",").concat(r+l*v,`
            L `).concat(t+n,",").concat(r+s-l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n-c*v,",").concat(r+s,`
            L `).concat(t+c*v,",").concat(r+s,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t,",").concat(r+s-l*v," Z")}else u="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(s," h ").concat(-n," Z");return u},b6e=function(t,r){if(!t||!r)return!1;var n=t.x,s=t.y,o=r.x,i=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(o,o+l),u=Math.max(o,o+l),f=Math.min(i,i+c),h=Math.max(i,i+c);return n>=d&&n<=u&&s>=f&&s<=h}return!1},w6e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},dM=function(t){var r=Vq(Vq({},w6e),t),n=p.useRef(),s=p.useState(-1),o=f6e(s,2),i=o[0],l=o[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var j=n.current.getTotalLength();j&&l(j)}catch{}},[]);var c=r.x,d=r.y,u=r.width,f=r.height,h=r.radius,m=r.className,v=r.animationEasing,g=r.animationDuration,y=r.animationBegin,x=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||u===0||f===0)return null;var w=ga("recharts-rectangle",m);return b?Se.createElement(Ph,{canBegin:i>0,from:{width:u,height:f,x:c,y:d},to:{width:u,height:f,x:c,y:d},duration:g,animationEasing:v,isActive:b},function(j){var _=j.width,C=j.height,P=j.x,E=j.y;return Se.createElement(Ph,{canBegin:i>0,from:"0px ".concat(i===-1?1:i,"px"),to:"".concat(i,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,isActive:x,easing:v},Se.createElement("path",LN({},Kn(r,!0),{className:w,d:Wq(P,E,_,C,h),ref:n})))}):Se.createElement("path",LN({},Kn(r,!0),{className:w,d:Wq(c,d,u,f,h)}))},j6e=["points","className","baseLinePoints","connectNulls"];function Lv(){return Lv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lv.apply(this,arguments)}function _6e(e,t){if(e==null)return{};var r=N6e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function N6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Hq(e){return P6e(e)||A6e(e)||C6e(e)||S6e()}function S6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C6e(e,t){if(e){if(typeof e=="string")return $O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $O(e,t)}}function A6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function P6e(e){if(Array.isArray(e))return $O(e)}function $O(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Gq=function(t){return t&&t.x===+t.x&&t.y===+t.y},E6e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){Gq(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),Gq(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},sb=function(t,r){var n=E6e(t);r&&(n=[n.reduce(function(o,i){return[].concat(Hq(o),Hq(i))},[])]);var s=n.map(function(o){return o.reduce(function(i,l,c){return"".concat(i).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(s,"Z"):s},k6e=function(t,r,n){var s=sb(t,n);return"".concat(s.slice(-1)==="Z"?s.slice(0,-1):s,"L").concat(sb(r.reverse(),n).slice(1))},I6e=function(t){var r=t.points,n=t.className,s=t.baseLinePoints,o=t.connectNulls,i=_6e(t,j6e);if(!r||!r.length)return null;var l=ga("recharts-polygon",n);if(s&&s.length){var c=i.stroke&&i.stroke!=="none",d=k6e(r,s,o);return Se.createElement("g",{className:l},Se.createElement("path",Lv({},Kn(i,!0),{fill:d.slice(-1)==="Z"?i.fill:"none",stroke:"none",d})),c?Se.createElement("path",Lv({},Kn(i,!0),{fill:"none",d:sb(r,o)})):null,c?Se.createElement("path",Lv({},Kn(i,!0),{fill:"none",d:sb(s,o)})):null)}var u=sb(r,o);return Se.createElement("path",Lv({},Kn(i,!0),{fill:u.slice(-1)==="Z"?i.fill:"none",className:l,d:u}))};function BO(){return BO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BO.apply(this,arguments)}var N1=function(t){var r=t.cx,n=t.cy,s=t.r,o=t.className,i=ga("recharts-dot",o);return r===+r&&n===+n&&s===+s?p.createElement("circle",BO({},Kn(t,!1),rN(t),{className:i,cx:r,cy:n,r:s})):null};function Cw(e){"@babel/helpers - typeof";return Cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cw(e)}var O6e=["x","y","top","left","width","height","className"];function qO(){return qO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qO.apply(this,arguments)}function Kq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function T6e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kq(Object(r),!0).forEach(function(n){D6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D6e(e,t,r){return t=M6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M6e(e){var t=R6e(e,"string");return Cw(t)=="symbol"?t:t+""}function R6e(e,t){if(Cw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L6e(e,t){if(e==null)return{};var r=F6e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function F6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var $6e=function(t,r,n,s,o,i){return"M".concat(t,",").concat(o,"v").concat(s,"M").concat(i,",").concat(r,"h").concat(n)},B6e=function(t){var r=t.x,n=r===void 0?0:r,s=t.y,o=s===void 0?0:s,i=t.top,l=i===void 0?0:i,c=t.left,d=c===void 0?0:c,u=t.width,f=u===void 0?0:u,h=t.height,m=h===void 0?0:h,v=t.className,g=L6e(t,O6e),y=T6e({x:n,y:o,top:l,left:d,width:f,height:m},g);return!Zr(n)||!Zr(o)||!Zr(f)||!Zr(m)||!Zr(l)||!Zr(d)?null:Se.createElement("path",qO({},Kn(y,!0),{className:ga("recharts-cross",v),d:$6e(n,o,f,m,l,d)}))},q6e=a5,z6e=bQ,U6e=rf;function V6e(e,t){return e&&e.length?q6e(e,U6e(t),z6e):void 0}var W6e=V6e;const H6e=Ga(W6e);var G6e=a5,K6e=rf,X6e=wQ;function Y6e(e,t){return e&&e.length?G6e(e,K6e(t),X6e):void 0}var J6e=Y6e;const Q6e=Ga(J6e);var Z6e=["cx","cy","angle","ticks","axisLine"],e8e=["ticks","tick","angle","tickFormatter","stroke"];function Mx(e){"@babel/helpers - typeof";return Mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mx(e)}function ob(){return ob=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ob.apply(this,arguments)}function Xq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ep(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xq(Object(r),!0).forEach(function(n){c5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yq(e,t){if(e==null)return{};var r=t8e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function r8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dZ(n.key),n)}}function n8e(e,t,r){return t&&Jq(e.prototype,t),r&&Jq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a8e(e,t,r){return t=FN(t),s8e(e,cZ()?Reflect.construct(t,r||[],FN(e).constructor):t.apply(e,r))}function s8e(e,t){if(t&&(Mx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o8e(e)}function o8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cZ=function(){return!!e})()}function FN(e){return FN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},FN(e)}function i8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},zO(e,t)}function c5(e,t,r){return t=dZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dZ(e){var t=l8e(e,"string");return Mx(t)=="symbol"?t:t+""}function l8e(e,t){if(Mx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d5=function(e){function t(){return r8e(this,t),a8e(this,t,arguments)}return i8e(t,e),n8e(t,[{key:"getTickValueCoord",value:function(n){var s=n.coordinate,o=this.props,i=o.angle,l=o.cx,c=o.cy;return Ts(l,c,s,i)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,s;switch(n){case"left":s="end";break;case"right":s="start";break;default:s="middle";break}return s}},{key:"getViewBox",value:function(){var n=this.props,s=n.cx,o=n.cy,i=n.angle,l=n.ticks,c=H6e(l,function(u){return u.coordinate||0}),d=Q6e(l,function(u){return u.coordinate||0});return{cx:s,cy:o,startAngle:i,endAngle:i,innerRadius:d.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,s=n.cx,o=n.cy,i=n.angle,l=n.ticks,c=n.axisLine,d=Yq(n,Z6e),u=l.reduce(function(v,g){return[Math.min(v[0],g.coordinate),Math.max(v[1],g.coordinate)]},[1/0,-1/0]),f=Ts(s,o,u[0],i),h=Ts(s,o,u[1],i),m=ep(ep(ep({},Kn(d,!1)),{},{fill:"none"},Kn(c,!1)),{},{x1:f.x,y1:f.y,x2:h.x,y2:h.y});return Se.createElement("line",ob({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var n=this,s=this.props,o=s.ticks,i=s.tick,l=s.angle,c=s.tickFormatter,d=s.stroke,u=Yq(s,e8e),f=this.getTickTextAnchor(),h=Kn(u,!1),m=Kn(i,!1),v=o.map(function(g,y){var x=n.getTickValueCoord(g),b=ep(ep(ep(ep({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(x.x,", ").concat(x.y,")")},h),{},{stroke:"none",fill:d},m),{},{index:y},x),{},{payload:g});return Se.createElement(Ta,ob({className:ga("recharts-polar-radius-axis-tick",XQ(i)),key:"tick-".concat(g.coordinate)},ig(n.props,g,y)),t.renderTickItem(i,b,c?c(g.value,y):g.value))});return Se.createElement(Ta,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var n=this.props,s=n.ticks,o=n.axisLine,i=n.tick;return!s||!s.length?null:Se.createElement(Ta,{className:ga("recharts-polar-radius-axis",this.props.className)},o&&this.renderAxisLine(),i&&this.renderTicks(),li.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,s,o){var i;return Se.isValidElement(n)?i=Se.cloneElement(n,s):na(n)?i=n(s):i=Se.createElement(lg,ob({},s,{className:"recharts-polar-radius-axis-tick-value"}),o),i}}])}(p.PureComponent);c5(d5,"displayName","PolarRadiusAxis");c5(d5,"axisType","radiusAxis");c5(d5,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Rx(e){"@babel/helpers - typeof";return Rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rx(e)}function yp(){return yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yp.apply(this,arguments)}function Qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function tp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qq(Object(r),!0).forEach(function(n){u5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fZ(n.key),n)}}function d8e(e,t,r){return t&&Zq(e.prototype,t),r&&Zq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u8e(e,t,r){return t=$N(t),f8e(e,uZ()?Reflect.construct(t,r||[],$N(e).constructor):t.apply(e,r))}function f8e(e,t){if(t&&(Rx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return m8e(e)}function m8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uZ=function(){return!!e})()}function $N(e){return $N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$N(e)}function h8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UO(e,t)}function UO(e,t){return UO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},UO(e,t)}function u5(e,t,r){return t=fZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fZ(e){var t=p8e(e,"string");return Rx(t)=="symbol"?t:t+""}function p8e(e,t){if(Rx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g8e=Math.PI/180,e7=1e-5,f5=function(e){function t(){return c8e(this,t),u8e(this,t,arguments)}return h8e(t,e),d8e(t,[{key:"getTickLineCoord",value:function(n){var s=this.props,o=s.cx,i=s.cy,l=s.radius,c=s.orientation,d=s.tickSize,u=d||8,f=Ts(o,i,l,n.coordinate),h=Ts(o,i,l+(c==="inner"?-1:1)*u,n.coordinate);return{x1:f.x,y1:f.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(n){var s=this.props.orientation,o=Math.cos(-n.coordinate*g8e),i;return o>e7?i=s==="outer"?"start":"end":o<-e7?i=s==="outer"?"end":"start":i="middle",i}},{key:"renderAxisLine",value:function(){var n=this.props,s=n.cx,o=n.cy,i=n.radius,l=n.axisLine,c=n.axisLineType,d=tp(tp({},Kn(this.props,!1)),{},{fill:"none"},Kn(l,!1));if(c==="circle")return Se.createElement(N1,yp({className:"recharts-polar-angle-axis-line"},d,{cx:s,cy:o,r:i}));var u=this.props.ticks,f=u.map(function(h){return Ts(s,o,i,h.coordinate)});return Se.createElement(I6e,yp({className:"recharts-polar-angle-axis-line"},d,{points:f}))}},{key:"renderTicks",value:function(){var n=this,s=this.props,o=s.ticks,i=s.tick,l=s.tickLine,c=s.tickFormatter,d=s.stroke,u=Kn(this.props,!1),f=Kn(i,!1),h=tp(tp({},u),{},{fill:"none"},Kn(l,!1)),m=o.map(function(v,g){var y=n.getTickLineCoord(v),x=n.getTickTextAnchor(v),b=tp(tp(tp({textAnchor:x},u),{},{stroke:"none",fill:d},f),{},{index:g,payload:v,x:y.x2,y:y.y2});return Se.createElement(Ta,yp({className:ga("recharts-polar-angle-axis-tick",XQ(i)),key:"tick-".concat(v.coordinate)},ig(n.props,v,g)),l&&Se.createElement("line",yp({className:"recharts-polar-angle-axis-tick-line"},h,y)),i&&t.renderTickItem(i,b,c?c(v.value,g):v.value))});return Se.createElement(Ta,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var n=this.props,s=n.ticks,o=n.radius,i=n.axisLine;return o<=0||!s||!s.length?null:Se.createElement(Ta,{className:ga("recharts-polar-angle-axis",this.props.className)},i&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,s,o){var i;return Se.isValidElement(n)?i=Se.cloneElement(n,s):na(n)?i=n(s):i=Se.createElement(lg,yp({},s,{className:"recharts-polar-angle-axis-tick-value"}),o),i}}])}(p.PureComponent);u5(f5,"displayName","PolarAngleAxis");u5(f5,"axisType","angleAxis");u5(f5,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var v8e=gJ,x8e=v8e(Object.getPrototypeOf,Object),y8e=x8e,b8e=nm,w8e=y8e,j8e=am,_8e="[object Object]",N8e=Function.prototype,S8e=Object.prototype,mZ=N8e.toString,C8e=S8e.hasOwnProperty,A8e=mZ.call(Object);function P8e(e){if(!j8e(e)||b8e(e)!=_8e)return!1;var t=w8e(e);if(t===null)return!0;var r=C8e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&mZ.call(r)==A8e}var E8e=P8e;const k8e=Ga(E8e);var I8e=nm,O8e=am,T8e="[object Boolean]";function D8e(e){return e===!0||e===!1||O8e(e)&&I8e(e)==T8e}var M8e=D8e;const R8e=Ga(M8e);function Aw(e){"@babel/helpers - typeof";return Aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aw(e)}function BN(){return BN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BN.apply(this,arguments)}function L8e(e,t){return q8e(e)||B8e(e,t)||$8e(e,t)||F8e()}function F8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $8e(e,t){if(e){if(typeof e=="string")return t7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t7(e,t)}}function t7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function q8e(e){if(Array.isArray(e))return e}function r7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function n7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r7(Object(r),!0).forEach(function(n){z8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z8e(e,t,r){return t=U8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U8e(e){var t=V8e(e,"string");return Aw(t)=="symbol"?t:t+""}function V8e(e,t){if(Aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a7=function(t,r,n,s,o){var i=n-s,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-i/2,",").concat(r+o),l+="L ".concat(t+n-i/2-s,",").concat(r+o),l+="L ".concat(t,",").concat(r," Z"),l},W8e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},H8e=function(t){var r=n7(n7({},W8e),t),n=p.useRef(),s=p.useState(-1),o=L8e(s,2),i=o[0],l=o[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&l(w)}catch{}},[]);var c=r.x,d=r.y,u=r.upperWidth,f=r.lowerWidth,h=r.height,m=r.className,v=r.animationEasing,g=r.animationDuration,y=r.animationBegin,x=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||h!==+h||u===0&&f===0||h===0)return null;var b=ga("recharts-trapezoid",m);return x?Se.createElement(Ph,{canBegin:i>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:d},to:{upperWidth:u,lowerWidth:f,height:h,x:c,y:d},duration:g,animationEasing:v,isActive:x},function(w){var j=w.upperWidth,_=w.lowerWidth,C=w.height,P=w.x,E=w.y;return Se.createElement(Ph,{canBegin:i>0,from:"0px ".concat(i===-1?1:i,"px"),to:"".concat(i,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,easing:v},Se.createElement("path",BN({},Kn(r,!0),{className:b,d:a7(P,E,j,_,C),ref:n})))}):Se.createElement("g",null,Se.createElement("path",BN({},Kn(r,!0),{className:b,d:a7(c,d,u,f,h)})))},G8e=["option","shapeType","propTransformer","activeClassName","isActive"];function Pw(e){"@babel/helpers - typeof";return Pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pw(e)}function K8e(e,t){if(e==null)return{};var r=X8e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function X8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function s7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function qN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s7(Object(r),!0).forEach(function(n){Y8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y8e(e,t,r){return t=J8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J8e(e){var t=Q8e(e,"string");return Pw(t)=="symbol"?t:t+""}function Q8e(e,t){if(Pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z8e(e,t){return qN(qN({},t),e)}function eBe(e,t){return e==="symbols"}function o7(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Se.createElement(dM,r);case"trapezoid":return Se.createElement(H8e,r);case"sector":return Se.createElement(cM,r);case"symbols":if(eBe(t))return Se.createElement(PD,r);break;default:return null}}function tBe(e){return p.isValidElement(e)?e.props:e}function hZ(e){var t=e.option,r=e.shapeType,n=e.propTransformer,s=n===void 0?Z8e:n,o=e.activeClassName,i=o===void 0?"recharts-active-shape":o,l=e.isActive,c=K8e(e,G8e),d;if(p.isValidElement(t))d=p.cloneElement(t,qN(qN({},c),tBe(t)));else if(na(t))d=t(c);else if(k8e(t)&&!R8e(t)){var u=s(t,c);d=Se.createElement(o7,{shapeType:r,elementProps:u})}else{var f=c;d=Se.createElement(o7,{shapeType:r,elementProps:f})}return l?Se.createElement(Ta,{className:i},d):d}function m5(e,t){return t!=null&&"trapezoids"in e.props}function h5(e,t){return t!=null&&"sectors"in e.props}function Ew(e,t){return t!=null&&"points"in e.props}function rBe(e,t){var r,n,s=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,o=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return s&&o}function nBe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function aBe(e,t){var r=e.x===t.x,n=e.y===t.y,s=e.z===t.z;return r&&n&&s}function sBe(e,t){var r;return m5(e,t)?r=rBe:h5(e,t)?r=nBe:Ew(e,t)&&(r=aBe),r}function oBe(e,t){var r;return m5(e,t)?r="trapezoids":h5(e,t)?r="sectors":Ew(e,t)&&(r="points"),r}function iBe(e,t){if(m5(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(h5(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Ew(e,t)?t.payload:{}}function lBe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,s=oBe(r,t),o=iBe(r,t),i=n.filter(function(c,d){var u=cg(o,c),f=r.props[s].filter(function(v){var g=sBe(r,t);return g(v,t)}),h=r.props[s].indexOf(f[f.length-1]),m=d===h;return u&&m}),l=n.indexOf(i[i.length-1]);return l}var Yj;function Lx(e){"@babel/helpers - typeof";return Lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lx(e)}function Fv(){return Fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fv.apply(this,arguments)}function i7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ps(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(r),!0).forEach(function(n){dd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gZ(n.key),n)}}function dBe(e,t,r){return t&&l7(e.prototype,t),r&&l7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uBe(e,t,r){return t=zN(t),fBe(e,pZ()?Reflect.construct(t,r||[],zN(e).constructor):t.apply(e,r))}function fBe(e,t){if(t&&(Lx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mBe(e)}function mBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pZ=function(){return!!e})()}function zN(e){return zN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zN(e)}function hBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VO(e,t)}function VO(e,t){return VO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},VO(e,t)}function dd(e,t,r){return t=gZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gZ(e){var t=pBe(e,"string");return Lx(t)=="symbol"?t:t+""}function pBe(e,t){if(Lx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zu=function(e){function t(r){var n;return cBe(this,t),n=uBe(this,t,[r]),dd(n,"pieRef",null),dd(n,"sectorRefs",[]),dd(n,"id",Cg("recharts-pie-")),dd(n,"handleAnimationEnd",function(){var s=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),na(s)&&s()}),dd(n,"handleAnimationStart",function(){var s=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),na(s)&&s()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return hBe(t,e),dBe(t,[{key:"isActiveIndex",value:function(n){var s=this.props.activeIndex;return Array.isArray(s)?s.indexOf(n)!==-1:n===s}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var o=this.props,i=o.label,l=o.labelLine,c=o.dataKey,d=o.valueKey,u=Kn(this.props,!1),f=Kn(i,!1),h=Kn(l,!1),m=i&&i.offsetRadius||20,v=n.map(function(g,y){var x=(g.startAngle+g.endAngle)/2,b=Ts(g.cx,g.cy,g.outerRadius+m,x),w=Ps(Ps(Ps(Ps({},u),g),{},{stroke:"none"},f),{},{index:y,textAnchor:t.getTextAnchor(b.x,g.cx)},b),j=Ps(Ps(Ps(Ps({},u),g),{},{fill:"none",stroke:g.fill},h),{},{index:y,points:[Ts(g.cx,g.cy,g.outerRadius,x),b]}),_=c;return fa(c)&&fa(d)?_="value":fa(c)&&(_=d),Se.createElement(Ta,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(y)},l&&t.renderLabelLineItem(l,j,"line"),t.renderLabelItem(i,w,No(g,_)))});return Se.createElement(Ta,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(n){var s=this,o=this.props,i=o.activeShape,l=o.blendStroke,c=o.inactiveShape;return n.map(function(d,u){if(d?.startAngle===0&&d?.endAngle===0&&n.length!==1)return null;var f=s.isActiveIndex(u),h=c&&s.hasActiveIndex()?c:null,m=f?i:h,v=Ps(Ps({},d),{},{stroke:l?d.fill:d.stroke,tabIndex:-1});return Se.createElement(Ta,Fv({ref:function(y){y&&!s.sectorRefs.includes(y)&&s.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},ig(s.props,d,u),{key:"sector-".concat(d?.startAngle,"-").concat(d?.endAngle,"-").concat(d.midAngle,"-").concat(u)}),Se.createElement(hZ,Fv({option:m,isActive:f,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,s=this.props,o=s.sectors,i=s.isAnimationActive,l=s.animationBegin,c=s.animationDuration,d=s.animationEasing,u=s.animationId,f=this.state,h=f.prevSectors,m=f.prevIsAnimationActive;return Se.createElement(Ph,{begin:l,duration:c,isActive:i,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var g=v.t,y=[],x=o&&o[0],b=x.startAngle;return o.forEach(function(w,j){var _=h&&h[j],C=j>0?Tc(w,"paddingAngle",0):0;if(_){var P=Xo(_.endAngle-_.startAngle,w.endAngle-w.startAngle),E=Ps(Ps({},w),{},{startAngle:b+C,endAngle:b+P(g)+C});y.push(E),b=E.endAngle}else{var A=w.endAngle,F=w.startAngle,D=Xo(0,A-F),I=D(g),R=Ps(Ps({},w),{},{startAngle:b+C,endAngle:b+I+C});y.push(R),b=R.endAngle}}),Se.createElement(Ta,null,n.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(n){var s=this;n.onkeydown=function(o){if(!o.altKey)switch(o.key){case"ArrowLeft":{var i=++s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[i].focus(),s.setState({sectorToFocus:i});break}case"ArrowRight":{var l=--s.state.sectorToFocus<0?s.sectorRefs.length-1:s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[l].focus(),s.setState({sectorToFocus:l});break}case"Escape":{s.sectorRefs[s.state.sectorToFocus].blur(),s.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,s=n.sectors,o=n.isAnimationActive,i=this.state.prevSectors;return o&&s&&s.length&&(!i||!cg(i,s))?this.renderSectorsWithAnimation():this.renderSectorsStatically(s)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,s=this.props,o=s.hide,i=s.sectors,l=s.className,c=s.label,d=s.cx,u=s.cy,f=s.innerRadius,h=s.outerRadius,m=s.isAnimationActive,v=this.state.isAnimationFinished;if(o||!i||!i.length||!Zr(d)||!Zr(u)||!Zr(f)||!Zr(h))return null;var g=ga("recharts-pie",l);return Se.createElement(Ta,{tabIndex:this.props.rootTabIndex,className:g,ref:function(x){n.pieRef=x}},this.renderSectors(),c&&this.renderLabels(i),li.renderCallByParent(this.props,null,!1),(!m||v)&&Gu.renderCallByParent(this.props,i,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return s.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:s.curSectors,isAnimationFinished:!0}:n.sectors!==s.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,s){return n>s?"start":n<s?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,s,o){if(Se.isValidElement(n))return Se.cloneElement(n,s);if(na(n))return n(s);var i=ga("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return Se.createElement(Vp,Fv({},s,{key:o,type:"linear",className:i}))}},{key:"renderLabelItem",value:function(n,s,o){if(Se.isValidElement(n))return Se.cloneElement(n,s);var i=o;if(na(n)&&(i=n(s),Se.isValidElement(i)))return i;var l=ga("recharts-pie-label-text",typeof n!="boolean"&&!na(n)?n.className:"");return Se.createElement(lg,Fv({},s,{alignmentBaseline:"middle",className:l}),i)}}])}(p.PureComponent);Yj=Zu;dd(Zu,"displayName","Pie");dd(Zu,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!iu.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});dd(Zu,"parseDeltaAngle",function(e,t){var r=bl(t-e),n=Math.min(Math.abs(t-e),360);return r*n});dd(Zu,"getRealPieData",function(e){var t=e.data,r=e.children,n=Kn(e,!1),s=Dc(r,sw);return t&&t.length?t.map(function(o,i){return Ps(Ps(Ps({payload:o},n),o),s&&s[i]&&s[i].props)}):s&&s.length?s.map(function(o){return Ps(Ps({},n),o.props)}):[]});dd(Zu,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,s=t.width,o=t.height,i=KQ(s,o),l=n+wl(e.cx,s,s/2),c=r+wl(e.cy,o,o/2),d=wl(e.innerRadius,i,0),u=wl(e.outerRadius,i,i*.8),f=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:l,cy:c,innerRadius:d,outerRadius:u,maxRadius:f}});dd(Zu,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?Ps(Ps({},t.type.defaultProps),t.props):t.props,s=Yj.getRealPieData(n);if(!s||!s.length)return null;var o=n.cornerRadius,i=n.startAngle,l=n.endAngle,c=n.paddingAngle,d=n.dataKey,u=n.nameKey,f=n.valueKey,h=n.tooltipType,m=Math.abs(n.minAngle),v=Yj.parseCoordinateOfPie(n,r),g=Yj.parseDeltaAngle(i,l),y=Math.abs(g),x=d;fa(d)&&fa(f)?(ou(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x="value"):fa(d)&&(ou(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x=f);var b=s.filter(function(E){return No(E,x,0)!==0}).length,w=(y>=360?b:b-1)*c,j=y-b*m-w,_=s.reduce(function(E,A){var F=No(A,x,0);return E+(Zr(F)?F:0)},0),C;if(_>0){var P;C=s.map(function(E,A){var F=No(E,x,0),D=No(E,u,A),I=(Zr(F)?F:0)/_,R;A?R=P.endAngle+bl(g)*c*(F!==0?1:0):R=i;var M=R+bl(g)*((F!==0?m:0)+I*j),U=(R+M)/2,z=(v.innerRadius+v.outerRadius)/2,W=[{name:D,value:F,payload:E,dataKey:x,type:h}],$=Ts(v.cx,v.cy,z,U);return P=Ps(Ps(Ps({percent:I,cornerRadius:o,name:D,tooltipPayload:W,midAngle:U,middleRadius:z,tooltipPosition:$},E),v),{},{value:No(E,x),startAngle:R,endAngle:M,payload:E,paddingAngle:bl(g)*c}),P})}return Ps(Ps({},v),{},{sectors:C,data:s})});var gBe=Math.ceil,vBe=Math.max;function xBe(e,t,r,n){for(var s=-1,o=vBe(gBe((t-e)/(r||1)),0),i=Array(o);o--;)i[n?o:++s]=e,e+=r;return i}var yBe=xBe,bBe=MJ,c7=1/0,wBe=17976931348623157e292;function jBe(e){if(!e)return e===0?e:0;if(e=bBe(e),e===c7||e===-c7){var t=e<0?-1:1;return t*wBe}return e===e?e:0}var vZ=jBe,_Be=yBe,NBe=JC,KP=vZ;function SBe(e){return function(t,r,n){return n&&typeof n!="number"&&NBe(t,r,n)&&(r=n=void 0),t=KP(t),r===void 0?(r=t,t=0):r=KP(r),n=n===void 0?t<r?1:-1:KP(n),_Be(t,r,n,e)}}var CBe=SBe,ABe=CBe,PBe=ABe(),EBe=PBe;const UN=Ga(EBe);function kw(e){"@babel/helpers - typeof";return kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kw(e)}function d7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function u7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d7(Object(r),!0).forEach(function(n){xZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xZ(e,t,r){return t=kBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kBe(e){var t=IBe(e,"string");return kw(t)=="symbol"?t:t+""}function IBe(e,t){if(kw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OBe=["Webkit","Moz","O","ms"],TBe=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(o){return o.toUpperCase()}),s=OBe.reduce(function(o,i){return u7(u7({},o),{},xZ({},i+n,r))},{});return s[t]=r,s};function Fx(e){"@babel/helpers - typeof";return Fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fx(e)}function VN(){return VN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VN.apply(this,arguments)}function f7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function XP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f7(Object(r),!0).forEach(function(n){gc(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bZ(n.key),n)}}function MBe(e,t,r){return t&&m7(e.prototype,t),r&&m7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RBe(e,t,r){return t=WN(t),LBe(e,yZ()?Reflect.construct(t,r||[],WN(e).constructor):t.apply(e,r))}function LBe(e,t){if(t&&(Fx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FBe(e)}function FBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yZ=function(){return!!e})()}function WN(e){return WN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WN(e)}function $Be(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WO(e,t)}function WO(e,t){return WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},WO(e,t)}function gc(e,t,r){return t=bZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bZ(e){var t=BBe(e,"string");return Fx(t)=="symbol"?t:t+""}function BBe(e,t){if(Fx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qBe=function(t){var r=t.data,n=t.startIndex,s=t.endIndex,o=t.x,i=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=rb().domain(UN(0,c)).range([o,o+i-l]),u=d.domain().map(function(f){return d(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(s),scale:d,scaleValues:u}},h7=function(t){return t.changedTouches&&!!t.changedTouches.length},$x=function(e){function t(r){var n;return DBe(this,t),n=RBe(this,t,[r]),gc(n,"handleDrag",function(s){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(s):n.state.isSlideMoving&&n.handleSlideDrag(s)}),gc(n,"handleTouchMove",function(s){s.changedTouches!=null&&s.changedTouches.length>0&&n.handleDrag(s.changedTouches[0])}),gc(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var s=n.props,o=s.endIndex,i=s.onDragEnd,l=s.startIndex;i?.({endIndex:o,startIndex:l})}),n.detachDragEndListener()}),gc(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),gc(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),gc(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),gc(n,"handleSlideDragStart",function(s){var o=h7(s)?s.changedTouches[0]:s;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return $Be(t,e),MBe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var s=n.startX,o=n.endX,i=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,f=Math.min(s,o),h=Math.max(s,o),m=t.getIndexInRange(i,f),v=t.getIndexInRange(i,h);return{startIndex:m-m%c,endIndex:v===u?u:v-v%c}}},{key:"getTextOfTick",value:function(n){var s=this.props,o=s.data,i=s.tickFormatter,l=s.dataKey,c=No(o[n],l,n);return na(i)?i(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var s=this.state,o=s.slideMoveStartX,i=s.startX,l=s.endX,c=this.props,d=c.x,u=c.width,f=c.travellerWidth,h=c.startIndex,m=c.endIndex,v=c.onChange,g=n.pageX-o;g>0?g=Math.min(g,d+u-f-l,d+u-f-i):g<0&&(g=Math.max(g,d-i,d-l));var y=this.getIndex({startX:i+g,endX:l+g});(y.startIndex!==h||y.endIndex!==m)&&v&&v(y),this.setState({startX:i+g,endX:l+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,s){var o=h7(s)?s.changedTouches[0]:s;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var s=this.state,o=s.brushMoveStartX,i=s.movingTravellerId,l=s.endX,c=s.startX,d=this.state[i],u=this.props,f=u.x,h=u.width,m=u.travellerWidth,v=u.onChange,g=u.gap,y=u.data,x={startX:this.state.startX,endX:this.state.endX},b=n.pageX-o;b>0?b=Math.min(b,f+h-m-d):b<0&&(b=Math.max(b,f-d)),x[i]=d+b;var w=this.getIndex(x),j=w.startIndex,_=w.endIndex,C=function(){var E=y.length-1;return i==="startX"&&(l>c?j%g===0:_%g===0)||l<c&&_===E||i==="endX"&&(l>c?_%g===0:j%g===0)||l>c&&_===E};this.setState(gc(gc({},i,d+b),"brushMoveStartX",n.pageX),function(){v&&C()&&v(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,s){var o=this,i=this.state,l=i.scaleValues,c=i.startX,d=i.endX,u=this.state[s],f=l.indexOf(u);if(f!==-1){var h=f+n;if(!(h===-1||h>=l.length)){var m=l[h];s==="startX"&&m>=d||s==="endX"&&m<=c||this.setState(gc({},s,m),function(){o.props.onChange(o.getIndex({startX:o.state.startX,endX:o.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,s=n.x,o=n.y,i=n.width,l=n.height,c=n.fill,d=n.stroke;return Se.createElement("rect",{stroke:d,fill:c,x:s,y:o,width:i,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,s=n.x,o=n.y,i=n.width,l=n.height,c=n.data,d=n.children,u=n.padding,f=p.Children.only(d);return f?Se.cloneElement(f,{x:s,y:o,width:i,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,s){var o,i,l=this,c=this.props,d=c.y,u=c.travellerWidth,f=c.height,h=c.traveller,m=c.ariaLabel,v=c.data,g=c.startIndex,y=c.endIndex,x=Math.max(n,this.props.x),b=XP(XP({},Kn(this.props,!1)),{},{x,y:d,width:u,height:f}),w=m||"Min value: ".concat((o=v[g])===null||o===void 0?void 0:o.name,", Max value: ").concat((i=v[y])===null||i===void 0?void 0:i.name);return Se.createElement(Ta,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[s],onTouchStart:this.travellerDragStartHandlers[s],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),l.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,s))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,b))}},{key:"renderSlide",value:function(n,s){var o=this.props,i=o.y,l=o.height,c=o.stroke,d=o.travellerWidth,u=Math.min(n,s)+d,f=Math.max(Math.abs(s-n)-d,0);return Se.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:i,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,s=n.startIndex,o=n.endIndex,i=n.y,l=n.height,c=n.travellerWidth,d=n.stroke,u=this.state,f=u.startX,h=u.endX,m=5,v={pointerEvents:"none",fill:d};return Se.createElement(Ta,{className:"recharts-brush-texts"},Se.createElement(lg,VN({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-m,y:i+l/2},v),this.getTextOfTick(s)),Se.createElement(lg,VN({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+c+m,y:i+l/2},v),this.getTextOfTick(o)))}},{key:"render",value:function(){var n=this.props,s=n.data,o=n.className,i=n.children,l=n.x,c=n.y,d=n.width,u=n.height,f=n.alwaysShowText,h=this.state,m=h.startX,v=h.endX,g=h.isTextActive,y=h.isSlideMoving,x=h.isTravellerMoving,b=h.isTravellerFocused;if(!s||!s.length||!Zr(l)||!Zr(c)||!Zr(d)||!Zr(u)||d<=0||u<=0)return null;var w=ga("recharts-brush",o),j=Se.Children.count(i)===1,_=TBe("userSelect","none");return Se.createElement(Ta,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(m,v),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(v,"endX"),(g||y||x||b||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var s=n.x,o=n.y,i=n.width,l=n.height,c=n.stroke,d=Math.floor(o+l/2)-1;return Se.createElement(Se.Fragment,null,Se.createElement("rect",{x:s,y:o,width:i,height:l,fill:c,stroke:"none"}),Se.createElement("line",{x1:s+1,y1:d,x2:s+i-1,y2:d,fill:"none",stroke:"#fff"}),Se.createElement("line",{x1:s+1,y1:d+2,x2:s+i-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,s){var o;return Se.isValidElement(n)?o=Se.cloneElement(n,s):na(n)?o=n(s):o=t.renderDefaultTraveller(s),o}},{key:"getDerivedStateFromProps",value:function(n,s){var o=n.data,i=n.width,l=n.x,c=n.travellerWidth,d=n.updateId,u=n.startIndex,f=n.endIndex;if(o!==s.prevData||d!==s.prevUpdateId)return XP({prevData:o,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:i},o&&o.length?qBe({data:o,width:i,x:l,travellerWidth:c,startIndex:u,endIndex:f}):{scale:null,scaleValues:null});if(s.scale&&(i!==s.prevWidth||l!==s.prevX||c!==s.prevTravellerWidth)){s.scale.range([l,l+i-c]);var h=s.scale.domain().map(function(m){return s.scale(m)});return{prevData:o,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:i,startX:s.scale(n.startIndex),endX:s.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,s){for(var o=n.length,i=0,l=o-1;l-i>1;){var c=Math.floor((i+l)/2);n[c]>s?l=c:i=c}return s>=n[l]?l:i}}])}(p.PureComponent);gc($x,"displayName","Brush");gc($x,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var zBe=MD;function UBe(e,t){var r;return zBe(e,function(n,s,o){return r=t(n,s,o),!r}),!!r}var VBe=UBe,WBe=lJ,HBe=rf,GBe=VBe,KBe=tc,XBe=JC;function YBe(e,t,r){var n=KBe(e)?WBe:GBe;return r&&XBe(e,t,r)&&(t=void 0),n(e,HBe(t))}var JBe=YBe;const QBe=Ga(JBe);var Ku=function(t,r){var n=t.alwaysShow,s=t.ifOverflow;return n&&(s="extendDomain"),s===r},p7=kJ;function ZBe(e,t,r){t=="__proto__"&&p7?p7(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var eqe=ZBe,tqe=eqe,rqe=PJ,nqe=rf;function aqe(e,t){var r={};return t=nqe(t),rqe(e,function(n,s,o){tqe(r,s,t(n,s,o))}),r}var sqe=aqe;const oqe=Ga(sqe);function iqe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var lqe=iqe,cqe=MD;function dqe(e,t){var r=!0;return cqe(e,function(n,s,o){return r=!!t(n,s,o),r}),r}var uqe=dqe,fqe=lqe,mqe=uqe,hqe=rf,pqe=tc,gqe=JC;function vqe(e,t,r){var n=pqe(e)?fqe:mqe;return r&&gqe(e,t,r)&&(t=void 0),n(e,hqe(t))}var xqe=vqe;const wZ=Ga(xqe);var yqe=["x","y"];function Iw(e){"@babel/helpers - typeof";return Iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iw(e)}function HO(){return HO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HO.apply(this,arguments)}function g7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function my(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g7(Object(r),!0).forEach(function(n){bqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bqe(e,t,r){return t=wqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wqe(e){var t=jqe(e,"string");return Iw(t)=="symbol"?t:t+""}function jqe(e,t){if(Iw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _qe(e,t){if(e==null)return{};var r=Nqe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Nqe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Sqe(e,t){var r=e.x,n=e.y,s=_qe(e,yqe),o="".concat(r),i=parseInt(o,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||s.height),u=parseInt(d,10),f="".concat(t.width||s.width),h=parseInt(f,10);return my(my(my(my(my({},t),s),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function v7(e){return Se.createElement(hZ,HO({shapeType:"rectangle",propTransformer:Sqe,activeClassName:"recharts-active-bar"},e))}var Cqe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,s){if(typeof t=="number")return t;var o=Zr(n)||rSe(n);return o?t(n,s):(o||Ah(!1),r)}},Aqe=["value","background"],jZ;function Bx(e){"@babel/helpers - typeof";return Bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bx(e)}function Pqe(e,t){if(e==null)return{};var r=Eqe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Eqe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function HN(){return HN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HN.apply(this,arguments)}function x7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ko(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x7(Object(r),!0).forEach(function(n){Wm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NZ(n.key),n)}}function Iqe(e,t,r){return t&&y7(e.prototype,t),r&&y7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oqe(e,t,r){return t=GN(t),Tqe(e,_Z()?Reflect.construct(t,r||[],GN(e).constructor):t.apply(e,r))}function Tqe(e,t){if(t&&(Bx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dqe(e)}function Dqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_Z=function(){return!!e})()}function GN(e){return GN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},GN(e)}function Mqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},GO(e,t)}function Wm(e,t,r){return t=NZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NZ(e){var t=Rqe(e,"string");return Bx(t)=="symbol"?t:t+""}function Rqe(e,t){if(Bx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kg=function(e){function t(){var r;kqe(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=Oqe(this,t,[].concat(s)),Wm(r,"state",{isAnimationFinished:!1}),Wm(r,"id",Cg("recharts-bar-")),Wm(r,"handleAnimationEnd",function(){var i=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),i&&i()}),Wm(r,"handleAnimationStart",function(){var i=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),i&&i()}),r}return Mqe(t,e),Iqe(t,[{key:"renderRectanglesStatically",value:function(n){var s=this,o=this.props,i=o.shape,l=o.dataKey,c=o.activeIndex,d=o.activeBar,u=Kn(this.props,!1);return n&&n.map(function(f,h){var m=h===c,v=m?d:i,g=ko(ko(ko({},u),f),{},{isActive:m,option:v,index:h,dataKey:l,onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd});return Se.createElement(Ta,HN({className:"recharts-bar-rectangle"},ig(s.props,f,h),{key:"rectangle-".concat(f?.x,"-").concat(f?.y,"-").concat(f?.value,"-").concat(h)}),Se.createElement(v7,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,s=this.props,o=s.data,i=s.layout,l=s.isAnimationActive,c=s.animationBegin,d=s.animationDuration,u=s.animationEasing,f=s.animationId,h=this.state.prevData;return Se.createElement(Ph,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var v=m.t,g=o.map(function(y,x){var b=h&&h[x];if(b){var w=Xo(b.x,y.x),j=Xo(b.y,y.y),_=Xo(b.width,y.width),C=Xo(b.height,y.height);return ko(ko({},y),{},{x:w(v),y:j(v),width:_(v),height:C(v)})}if(i==="horizontal"){var P=Xo(0,y.height),E=P(v);return ko(ko({},y),{},{y:y.y+y.height-E,height:E})}var A=Xo(0,y.width),F=A(v);return ko(ko({},y),{},{width:F})});return Se.createElement(Ta,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,s=n.data,o=n.isAnimationActive,i=this.state.prevData;return o&&s&&s.length&&(!i||!cg(i,s))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(s)}},{key:"renderBackground",value:function(){var n=this,s=this.props,o=s.data,i=s.dataKey,l=s.activeIndex,c=Kn(this.props.background,!1);return o.map(function(d,u){d.value;var f=d.background,h=Pqe(d,Aqe);if(!f)return null;var m=ko(ko(ko(ko(ko({},h),{},{fill:"#eee"},f),c),ig(n.props,d,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:i,index:u,className:"recharts-bar-background-rectangle"});return Se.createElement(v7,HN({key:"background-bar-".concat(u),option:n.props.background,isActive:u===l},m))})}},{key:"renderErrorBar",value:function(n,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,i=o.data,l=o.xAxis,c=o.yAxis,d=o.layout,u=o.children,f=Dc(u,_1);if(!f)return null;var h=d==="vertical"?i[0].height/2:i[0].width/2,m=function(y,x){var b=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:b,errorVal:No(y,x)}},v={clipPath:n?"url(#clipPath-".concat(s,")"):null};return Se.createElement(Ta,v,f.map(function(g){return Se.cloneElement(g,{key:"error-bar-".concat(s,"-").concat(g.props.dataKey),data:i,xAxis:l,yAxis:c,layout:d,offset:h,dataPointFormatter:m})}))}},{key:"render",value:function(){var n=this.props,s=n.hide,o=n.data,i=n.className,l=n.xAxis,c=n.yAxis,d=n.left,u=n.top,f=n.width,h=n.height,m=n.isAnimationActive,v=n.background,g=n.id;if(s||!o||!o.length)return null;var y=this.state.isAnimationFinished,x=ga("recharts-bar",i),b=l&&l.allowDataOverflow,w=c&&c.allowDataOverflow,j=b||w,_=fa(g)?this.id:g;return Se.createElement(Ta,{className:x},b||w?Se.createElement("defs",null,Se.createElement("clipPath",{id:"clipPath-".concat(_)},Se.createElement("rect",{x:b?d:d-f/2,y:w?u:u-h/2,width:b?f:f*2,height:w?h:h*2}))):null,Se.createElement(Ta,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(_,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,_),(!m||y)&&Gu.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:s.curData}:n.data!==s.curData?{curData:n.data}:null}}])}(p.PureComponent);jZ=kg;Wm(kg,"displayName","Bar");Wm(kg,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!iu.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Wm(kg,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,s=e.bandSize,o=e.xAxis,i=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=vLe(n,r);if(!m)return null;var v=t.layout,g=r.type.defaultProps,y=g!==void 0?ko(ko({},g),r.props):r.props,x=y.dataKey,b=y.children,w=y.minPointSize,j=v==="horizontal"?i:o,_=d?j.scale.domain():null,C=NLe({numericAxis:j}),P=Dc(b,sw),E=f.map(function(A,F){var D,I,R,M,U,z;d?D=xLe(d[u+F],_):(D=No(A,x),Array.isArray(D)||(D=[C,D]));var W=Cqe(w,jZ.defaultProps.minPointSize)(D[1],F);if(v==="horizontal"){var $,ee=[i.scale(D[0]),i.scale(D[1])],ve=ee[0],_e=ee[1];I=iq({axis:o,ticks:l,bandSize:s,offset:m.offset,entry:A,index:F}),R=($=_e??ve)!==null&&$!==void 0?$:void 0,M=m.size;var K=ve-_e;if(U=Number.isNaN(K)?0:K,z={x:I,y:i.y,width:M,height:i.height},Math.abs(W)>0&&Math.abs(U)<Math.abs(W)){var q=bl(U||W)*(Math.abs(W)-Math.abs(U));R-=q,U+=q}}else{var Y=[o.scale(D[0]),o.scale(D[1])],J=Y[0],fe=Y[1];if(I=J,R=iq({axis:i,ticks:c,bandSize:s,offset:m.offset,entry:A,index:F}),M=fe-J,U=m.size,z={x:o.x,y:R,width:o.width,height:U},Math.abs(W)>0&&Math.abs(M)<Math.abs(W)){var Z=bl(M||W)*(Math.abs(W)-Math.abs(M));M+=Z}}return ko(ko(ko({},A),{},{x:I,y:R,width:M,height:U,value:d?D:D[1],payload:A,background:z},P&&P[F]&&P[F].props),{},{tooltipPayload:[HQ(r,A)],tooltipPosition:{x:I+M/2,y:R+U/2}})});return ko({data:E,layout:v},h)});function Ow(e){"@babel/helpers - typeof";return Ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ow(e)}function Lqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SZ(n.key),n)}}function Fqe(e,t,r){return t&&b7(e.prototype,t),r&&b7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Xd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w7(Object(r),!0).forEach(function(n){p5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p5(e,t,r){return t=SZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SZ(e){var t=$qe(e,"string");return Ow(t)=="symbol"?t:t+""}function $qe(e,t){if(Ow(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ow(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uM=function(t,r,n,s,o){var i=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),f={left:n.left,leftMirror:n.left,right:i-n.right,rightMirror:i-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},h=!!bc(d,kg);return u.reduce(function(m,v){var g=r[v],y=g.orientation,x=g.domain,b=g.padding,w=b===void 0?{}:b,j=g.mirror,_=g.reversed,C="".concat(y).concat(j?"Mirror":""),P,E,A,F,D;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var I=x[1]-x[0],R=1/0,M=g.categoricalDomain.sort(sSe);if(M.forEach(function(Y,J){J>0&&(R=Math.min((Y||0)-(M[J-1]||0),R))}),Number.isFinite(R)){var U=R/I,z=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(P=U*z/2),g.padding==="no-gap"){var W=wl(t.barCategoryGap,U*z),$=U*z/2;P=$-W-($-W)/z*W}}}s==="xAxis"?E=[n.left+(w.left||0)+(P||0),n.left+n.width-(w.right||0)-(P||0)]:s==="yAxis"?E=c==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(P||0),n.top+n.height-(w.bottom||0)-(P||0)]:E=g.range,_&&(E=[E[1],E[0]]);var ee=zQ(g,o,h),ve=ee.scale,_e=ee.realScaleType;ve.domain(x).range(E),UQ(ve);var K=VQ(ve,Xd(Xd({},g),{},{realScaleType:_e}));s==="xAxis"?(D=y==="top"&&!j||y==="bottom"&&j,A=n.left,F=f[C]-D*g.height):s==="yAxis"&&(D=y==="left"&&!j||y==="right"&&j,A=f[C]-D*g.width,F=n.top);var q=Xd(Xd(Xd({},g),K),{},{realScaleType:_e,x:A,y:F,scale:ve,width:s==="xAxis"?n.width:g.width,height:s==="yAxis"?n.height:g.height});return q.bandSize=kN(q,K),!g.hide&&s==="xAxis"?f[C]+=(D?-1:1)*q.height:g.hide||(f[C]+=(D?-1:1)*q.width),Xd(Xd({},m),{},p5({},v,q))},{})},CZ=function(t,r){var n=t.x,s=t.y,o=r.x,i=r.y;return{x:Math.min(n,o),y:Math.min(s,i),width:Math.abs(o-n),height:Math.abs(i-s)}},Bqe=function(t){var r=t.x1,n=t.y1,s=t.x2,o=t.y2;return CZ({x:r,y:n},{x:s,y:o})},AZ=function(){function e(t){Lqe(this,e),this.scale=t}return Fqe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.bandAware,o=n.position;if(r!==void 0){if(o)switch(o){case"start":return this.scale(r);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+i}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(s){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),s=n[0],o=n[n.length-1];return s<=o?r>=s&&r<=o:r>=o&&r<=s}}],[{key:"create",value:function(r){return new e(r)}}])}();p5(AZ,"EPS",1e-4);var fM=function(t){var r=Object.keys(t).reduce(function(n,s){return Xd(Xd({},n),{},p5({},s,AZ.create(t[s])))},{});return Xd(Xd({},r),{},{apply:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=o.bandAware,l=o.position;return oqe(s,function(c,d){return r[d].apply(c,{bandAware:i,position:l})})},isInRange:function(s){return wZ(s,function(o,i){return r[i].isInRange(o)})}})};function qqe(e){return(e%180+180)%180}var zqe=function(t){var r=t.width,n=t.height,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=qqe(s),i=o*Math.PI/180,l=Math.atan(n/r),c=i>l&&i<Math.PI-l?n/Math.sin(i):r/Math.cos(i);return Math.abs(c)},Uqe=rf,Vqe=x1,Wqe=XC;function Hqe(e){return function(t,r,n){var s=Object(t);if(!Vqe(t)){var o=Uqe(r);t=Wqe(t),r=function(l){return o(s[l],l,s)}}var i=e(t,r,n);return i>-1?s[o?t[i]:i]:void 0}}var Gqe=Hqe,Kqe=vZ;function Xqe(e){var t=Kqe(e),r=t%1;return t===t?r?t-r:t:0}var Yqe=Xqe,Jqe=jJ,Qqe=rf,Zqe=Yqe,e7e=Math.max;function t7e(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var s=r==null?0:Zqe(r);return s<0&&(s=e7e(n+s,0)),Jqe(e,Qqe(t),s)}var r7e=t7e,n7e=Gqe,a7e=r7e,s7e=n7e(a7e),o7e=s7e;const i7e=Ga(o7e);var l7e=oNe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),mM=p.createContext(void 0),hM=p.createContext(void 0),PZ=p.createContext(void 0),EZ=p.createContext({}),kZ=p.createContext(void 0),IZ=p.createContext(0),OZ=p.createContext(0),j7=function(t){var r=t.state,n=r.xAxisMap,s=r.yAxisMap,o=r.offset,i=t.clipPathId,l=t.children,c=t.width,d=t.height,u=l7e(o);return Se.createElement(mM.Provider,{value:n},Se.createElement(hM.Provider,{value:s},Se.createElement(EZ.Provider,{value:o},Se.createElement(PZ.Provider,{value:u},Se.createElement(kZ.Provider,{value:i},Se.createElement(IZ.Provider,{value:d},Se.createElement(OZ.Provider,{value:c},l)))))))},c7e=function(){return p.useContext(kZ)},TZ=function(t){var r=p.useContext(mM);r==null&&Ah(!1);var n=r[t];return n==null&&Ah(!1),n},d7e=function(){var t=p.useContext(mM);return Rm(t)},u7e=function(){var t=p.useContext(hM),r=i7e(t,function(n){return wZ(n.domain,Number.isFinite)});return r||Rm(t)},DZ=function(t){var r=p.useContext(hM);r==null&&Ah(!1);var n=r[t];return n==null&&Ah(!1),n},f7e=function(){var t=p.useContext(PZ);return t},m7e=function(){return p.useContext(EZ)},pM=function(){return p.useContext(OZ)},gM=function(){return p.useContext(IZ)};function qx(e){"@babel/helpers - typeof";return qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qx(e)}function h7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RZ(n.key),n)}}function p7e(e,t,r){return t&&_7(e.prototype,t),r&&_7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function g7e(e,t,r){return t=KN(t),v7e(e,MZ()?Reflect.construct(t,r||[],KN(e).constructor):t.apply(e,r))}function v7e(e,t){if(t&&(qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x7e(e)}function x7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MZ=function(){return!!e})()}function KN(e){return KN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},KN(e)}function y7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KO(e,t)}function KO(e,t){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},KO(e,t)}function N7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function S7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N7(Object(r),!0).forEach(function(n){vM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vM(e,t,r){return t=RZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RZ(e){var t=b7e(e,"string");return qx(t)=="symbol"?t:t+""}function b7e(e,t){if(qx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function w7e(e,t){return S7e(e)||N7e(e,t)||_7e(e,t)||j7e()}function j7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _7e(e,t){if(e){if(typeof e=="string")return C7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C7(e,t)}}function C7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function S7e(e){if(Array.isArray(e))return e}function XO(){return XO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},XO.apply(this,arguments)}var C7e=function(t,r){var n;return Se.isValidElement(t)?n=Se.cloneElement(t,r):na(t)?n=t(r):n=Se.createElement("line",XO({},r,{className:"recharts-reference-line-line"})),n},A7e=function(t,r,n,s,o,i,l,c,d){var u=o.x,f=o.y,h=o.width,m=o.height;if(n){var v=d.y,g=t.y.apply(v,{position:i});if(Ku(d,"discard")&&!t.y.isInRange(g))return null;var y=[{x:u+h,y:g},{x:u,y:g}];return c==="left"?y.reverse():y}if(r){var x=d.x,b=t.x.apply(x,{position:i});if(Ku(d,"discard")&&!t.x.isInRange(b))return null;var w=[{x:b,y:f+m},{x:b,y:f}];return l==="top"?w.reverse():w}if(s){var j=d.segment,_=j.map(function(C){return t.apply(C,{position:i})});return Ku(d,"discard")&&QBe(_,function(C){return!t.isInRange(C)})?null:_}return null};function P7e(e){var t=e.x,r=e.y,n=e.segment,s=e.xAxisId,o=e.yAxisId,i=e.shape,l=e.className,c=e.alwaysShow,d=c7e(),u=TZ(s),f=DZ(o),h=f7e();if(!d||!h)return null;ou(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=fM({x:u.scale,y:f.scale}),v=Qo(t),g=Qo(r),y=n&&n.length===2,x=A7e(m,v,g,y,h,e.position,u.orientation,f.orientation,e);if(!x)return null;var b=w7e(x,2),w=b[0],j=w.x,_=w.y,C=b[1],P=C.x,E=C.y,A=Ku(e,"hidden")?"url(#".concat(d,")"):void 0,F=S7(S7({clipPath:A},Kn(e,!0)),{},{x1:j,y1:_,x2:P,y2:E});return Se.createElement(Ta,{className:ga("recharts-reference-line",l)},C7e(i,F),li.renderCallByParent(e,Bqe({x1:j,y1:_,x2:P,y2:E})))}var xM=function(e){function t(){return h7e(this,t),g7e(this,t,arguments)}return y7e(t,e),p7e(t,[{key:"render",value:function(){return Se.createElement(P7e,this.props)}}])}(Se.Component);vM(xM,"displayName","ReferenceLine");vM(xM,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function YO(){return YO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YO.apply(this,arguments)}function zx(e){"@babel/helpers - typeof";return zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zx(e)}function A7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function P7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A7(Object(r),!0).forEach(function(n){g5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function E7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FZ(n.key),n)}}function k7e(e,t,r){return t&&E7(e.prototype,t),r&&E7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I7e(e,t,r){return t=XN(t),O7e(e,LZ()?Reflect.construct(t,r||[],XN(e).constructor):t.apply(e,r))}function O7e(e,t){if(t&&(zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T7e(e)}function T7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LZ=function(){return!!e})()}function XN(e){return XN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},XN(e)}function D7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},JO(e,t)}function g5(e,t,r){return t=FZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FZ(e){var t=M7e(e,"string");return zx(t)=="symbol"?t:t+""}function M7e(e,t){if(zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R7e=function(t){var r=t.x,n=t.y,s=t.xAxis,o=t.yAxis,i=fM({x:s.scale,y:o.scale}),l=i.apply({x:r,y:n},{bandAware:!0});return Ku(t,"discard")&&!i.isInRange(l)?null:l},v5=function(e){function t(){return E7e(this,t),I7e(this,t,arguments)}return D7e(t,e),k7e(t,[{key:"render",value:function(){var n=this.props,s=n.x,o=n.y,i=n.r,l=n.alwaysShow,c=n.clipPathId,d=Qo(s),u=Qo(o);if(ou(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var f=R7e(this.props);if(!f)return null;var h=f.x,m=f.y,v=this.props,g=v.shape,y=v.className,x=Ku(this.props,"hidden")?"url(#".concat(c,")"):void 0,b=P7(P7({clipPath:x},Kn(this.props,!0)),{},{cx:h,cy:m});return Se.createElement(Ta,{className:ga("recharts-reference-dot",y)},t.renderDot(g,b),li.renderCallByParent(this.props,{x:h-i,y:m-i,width:2*i,height:2*i}))}}])}(Se.Component);g5(v5,"displayName","ReferenceDot");g5(v5,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});g5(v5,"renderDot",function(e,t){var r;return Se.isValidElement(e)?r=Se.cloneElement(e,t):na(e)?r=e(t):r=Se.createElement(N1,YO({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function QO(){return QO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},QO.apply(this,arguments)}function Ux(e){"@babel/helpers - typeof";return Ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ux(e)}function k7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function I7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(r),!0).forEach(function(n){x5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BZ(n.key),n)}}function F7e(e,t,r){return t&&O7(e.prototype,t),r&&O7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $7e(e,t,r){return t=YN(t),B7e(e,$Z()?Reflect.construct(t,r||[],YN(e).constructor):t.apply(e,r))}function B7e(e,t){if(t&&(Ux(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q7e(e)}function q7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($Z=function(){return!!e})()}function YN(e){return YN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},YN(e)}function z7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},ZO(e,t)}function x5(e,t,r){return t=BZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BZ(e){var t=U7e(e,"string");return Ux(t)=="symbol"?t:t+""}function U7e(e,t){if(Ux(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ux(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var V7e=function(t,r,n,s,o){var i=o.x1,l=o.x2,c=o.y1,d=o.y2,u=o.xAxis,f=o.yAxis;if(!u||!f)return null;var h=fM({x:u.scale,y:f.scale}),m={x:t?h.x.apply(i,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(c,{position:"start"}):h.y.rangeMin},v={x:r?h.x.apply(l,{position:"end"}):h.x.rangeMax,y:s?h.y.apply(d,{position:"end"}):h.y.rangeMax};return Ku(o,"discard")&&(!h.isInRange(m)||!h.isInRange(v))?null:CZ(m,v)},y5=function(e){function t(){return L7e(this,t),$7e(this,t,arguments)}return z7e(t,e),F7e(t,[{key:"render",value:function(){var n=this.props,s=n.x1,o=n.x2,i=n.y1,l=n.y2,c=n.className,d=n.alwaysShow,u=n.clipPathId;ou(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Qo(s),h=Qo(o),m=Qo(i),v=Qo(l),g=this.props.shape;if(!f&&!h&&!m&&!v&&!g)return null;var y=V7e(f,h,m,v,this.props);if(!y&&!g)return null;var x=Ku(this.props,"hidden")?"url(#".concat(u,")"):void 0;return Se.createElement(Ta,{className:ga("recharts-reference-area",c)},t.renderRect(g,I7(I7({clipPath:x},Kn(this.props,!0)),y)),li.renderCallByParent(this.props,y))}}])}(Se.Component);x5(y5,"displayName","ReferenceArea");x5(y5,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});x5(y5,"renderRect",function(e,t){var r;return Se.isValidElement(e)?r=Se.cloneElement(e,t):na(e)?r=e(t):r=Se.createElement(dM,QO({},t,{className:"recharts-reference-area-rect"})),r});function qZ(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],s=0;s<e.length;s+=t)if(r===void 0||r(e[s])===!0)n.push(e[s]);else return;return n}function W7e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return zqe(n,r)}function H7e(e,t,r){var n=r==="width",s=e.x,o=e.y,i=e.width,l=e.height;return t===1?{start:n?s:o,end:n?s+i:o+l}:{start:n?s+i:o+l,end:n?s:o}}function JN(e,t,r,n,s){if(e*t<e*n||e*t>e*s)return!1;var o=r();return e*(t-e*o/2-n)>=0&&e*(t+e*o/2-s)<=0}function G7e(e,t){return qZ(e,t+1)}function K7e(e,t,r,n,s){for(var o=(n||[]).slice(),i=t.start,l=t.end,c=0,d=1,u=i,f=function(){var v=n?.[c];if(v===void 0)return{v:qZ(n,d)};var g=c,y,x=function(){return y===void 0&&(y=r(v,g)),y},b=v.coordinate,w=c===0||JN(e,b,x,u,l);w||(c=0,u=i,d+=1),w&&(u=b+e*(x()/2+s),c+=d)},h;d<=o.length;)if(h=f(),h)return h.v;return[]}function Tw(e){"@babel/helpers - typeof";return Tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tw(e)}function T7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Xi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T7(Object(r),!0).forEach(function(n){X7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X7e(e,t,r){return t=Y7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y7e(e){var t=J7e(e,"string");return Tw(t)=="symbol"?t:t+""}function J7e(e,t){if(Tw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q7e(e,t,r,n,s){for(var o=(n||[]).slice(),i=o.length,l=t.start,c=t.end,d=function(h){var m=o[h],v,g=function(){return v===void 0&&(v=r(m,h)),v};if(h===i-1){var y=e*(m.coordinate+e*g()/2-c);o[h]=m=Xi(Xi({},m),{},{tickCoord:y>0?m.coordinate-y*e:m.coordinate})}else o[h]=m=Xi(Xi({},m),{},{tickCoord:m.coordinate});var x=JN(e,m.tickCoord,g,l,c);x&&(c=m.tickCoord-e*(g()/2+s),o[h]=Xi(Xi({},m),{},{isShow:!0}))},u=i-1;u>=0;u--)d(u);return o}function Z7e(e,t,r,n,s,o){var i=(n||[]).slice(),l=i.length,c=t.start,d=t.end;if(o){var u=n[l-1],f=r(u,l-1),h=e*(u.coordinate+e*f/2-d);i[l-1]=u=Xi(Xi({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate});var m=JN(e,u.tickCoord,function(){return f},c,d);m&&(d=u.tickCoord-e*(f/2+s),i[l-1]=Xi(Xi({},u),{},{isShow:!0}))}for(var v=o?l-1:l,g=function(b){var w=i[b],j,_=function(){return j===void 0&&(j=r(w,b)),j};if(b===0){var C=e*(w.coordinate-e*_()/2-c);i[b]=w=Xi(Xi({},w),{},{tickCoord:C<0?w.coordinate-C*e:w.coordinate})}else i[b]=w=Xi(Xi({},w),{},{tickCoord:w.coordinate});var P=JN(e,w.tickCoord,_,c,d);P&&(c=w.tickCoord+e*(_()/2+s),i[b]=Xi(Xi({},w),{},{isShow:!0}))},y=0;y<v;y++)g(y);return i}function yM(e,t,r){var n=e.tick,s=e.ticks,o=e.viewBox,i=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,f=e.angle;if(!s||!s.length||!n)return[];if(Zr(c)||iu.isSsr)return G7e(s,typeof c=="number"&&Zr(c)?c:0);var h=[],m=l==="top"||l==="bottom"?"width":"height",v=u&&m==="width"?tb(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(w,j){var _=na(d)?d(w.value,j):w.value;return m==="width"?W7e(tb(_,{fontSize:t,letterSpacing:r}),v,f):tb(_,{fontSize:t,letterSpacing:r})[m]},y=s.length>=2?bl(s[1].coordinate-s[0].coordinate):1,x=H7e(o,y,m);return c==="equidistantPreserveStart"?K7e(y,x,g,s,i):(c==="preserveStart"||c==="preserveStartEnd"?h=Z7e(y,x,g,s,i,c==="preserveStartEnd"):h=Q7e(y,x,g,s,i),h.filter(function(b){return b.isShow}))}var eze=["viewBox"],tze=["viewBox"],rze=["ticks"];function Vx(e){"@babel/helpers - typeof";return Vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vx(e)}function $v(){return $v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$v.apply(this,arguments)}function D7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function zo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D7(Object(r),!0).forEach(function(n){bM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YP(e,t){if(e==null)return{};var r=nze(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function aze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UZ(n.key),n)}}function sze(e,t,r){return t&&M7(e.prototype,t),r&&M7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oze(e,t,r){return t=QN(t),ize(e,zZ()?Reflect.construct(t,r||[],QN(e).constructor):t.apply(e,r))}function ize(e,t){if(t&&(Vx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lze(e)}function lze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zZ=function(){return!!e})()}function QN(e){return QN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QN(e)}function cze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eT(e,t)}function eT(e,t){return eT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},eT(e,t)}function bM(e,t,r){return t=UZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UZ(e){var t=dze(e,"string");return Vx(t)=="symbol"?t:t+""}function dze(e,t){if(Vx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E0=function(e){function t(r){var n;return aze(this,t),n=oze(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return cze(t,e),sze(t,[{key:"shouldComponentUpdate",value:function(n,s){var o=n.viewBox,i=YP(n,eze),l=this.props,c=l.viewBox,d=YP(l,tze);return!tx(o,c)||!tx(i,d)||!tx(s,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var s=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];s&&this.setState({fontSize:window.getComputedStyle(s).fontSize,letterSpacing:window.getComputedStyle(s).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var s=this.props,o=s.x,i=s.y,l=s.width,c=s.height,d=s.orientation,u=s.tickSize,f=s.mirror,h=s.tickMargin,m,v,g,y,x,b,w=f?-1:1,j=n.tickSize||u,_=Zr(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":m=v=n.coordinate,y=i+ +!f*c,g=y-w*j,b=g-w*h,x=_;break;case"left":g=y=n.coordinate,v=o+ +!f*l,m=v-w*j,x=m-w*h,b=_;break;case"right":g=y=n.coordinate,v=o+ +f*l,m=v+w*j,x=m+w*h,b=_;break;default:m=v=n.coordinate,y=i+ +f*c,g=y+w*j,b=g+w*h,x=_;break}return{line:{x1:m,y1:g,x2:v,y2:y},tick:{x,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,s=n.orientation,o=n.mirror,i;switch(s){case"left":i=o?"start":"end";break;case"right":i=o?"end":"start";break;default:i="middle";break}return i}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,s=n.orientation,o=n.mirror,i="end";switch(s){case"left":case"right":i="middle";break;case"top":i=o?"start":"end";break;default:i=o?"end":"start";break}return i}},{key:"renderAxisLine",value:function(){var n=this.props,s=n.x,o=n.y,i=n.width,l=n.height,c=n.orientation,d=n.mirror,u=n.axisLine,f=zo(zo(zo({},Kn(this.props,!1)),Kn(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var h=+(c==="top"&&!d||c==="bottom"&&d);f=zo(zo({},f),{},{x1:s,y1:o+h*l,x2:s+i,y2:o+h*l})}else{var m=+(c==="left"&&!d||c==="right"&&d);f=zo(zo({},f),{},{x1:s+m*i,y1:o,x2:s+m*i,y2:o+l})}return Se.createElement("line",$v({},f,{className:ga("recharts-cartesian-axis-line",Tc(u,"className"))}))}},{key:"renderTicks",value:function(n,s,o){var i=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,f=l.tickFormatter,h=l.unit,m=yM(zo(zo({},this.props),{},{ticks:n}),s,o),v=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),y=Kn(this.props,!1),x=Kn(u,!1),b=zo(zo({},y),{},{fill:"none"},Kn(c,!1)),w=m.map(function(j,_){var C=i.getTickLineCoord(j),P=C.line,E=C.tick,A=zo(zo(zo(zo({textAnchor:v,verticalAnchor:g},y),{},{stroke:"none",fill:d},x),E),{},{index:_,payload:j,visibleTicksCount:m.length,tickFormatter:f});return Se.createElement(Ta,$v({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},ig(i.props,j,_)),c&&Se.createElement("line",$v({},b,P,{className:ga("recharts-cartesian-axis-tick-line",Tc(c,"className"))})),u&&t.renderTickItem(u,A,"".concat(na(f)?f(j.value,_):j.value).concat(h||"")))});return Se.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,s=this.props,o=s.axisLine,i=s.width,l=s.height,c=s.ticksGenerator,d=s.className,u=s.hide;if(u)return null;var f=this.props,h=f.ticks,m=YP(f,rze),v=h;return na(c)&&(v=h&&h.length>0?c(this.props):c(m)),i<=0||l<=0||!v||!v.length?null:Se.createElement(Ta,{className:ga("recharts-cartesian-axis",d),ref:function(y){n.layerReference=y}},o&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),li.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,s,o){var i,l=ga(s.className,"recharts-cartesian-axis-tick-value");return Se.isValidElement(n)?i=Se.cloneElement(n,zo(zo({},s),{},{className:l})):na(n)?i=n(zo(zo({},s),{},{className:l})):i=Se.createElement(lg,$v({},s,{className:"recharts-cartesian-axis-tick-value"}),o),i}}])}(p.Component);bM(E0,"displayName","CartesianAxis");bM(E0,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var uze=["x1","y1","x2","y2","key"],fze=["offset"];function ug(e){"@babel/helpers - typeof";return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ug(e)}function R7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ji(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R7(Object(r),!0).forEach(function(n){mze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mze(e,t,r){return t=hze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hze(e){var t=pze(e,"string");return ug(t)=="symbol"?t:t+""}function pze(e,t){if(ug(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ug(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ep(){return Ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ep.apply(this,arguments)}function L7(e,t){if(e==null)return{};var r=gze(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function gze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var vze=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,s=t.x,o=t.y,i=t.width,l=t.height,c=t.ry;return Se.createElement("rect",{x:s,y:o,ry:c,width:i,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function VZ(e,t){var r;if(Se.isValidElement(e))r=Se.cloneElement(e,t);else if(na(e))r=e(t);else{var n=t.x1,s=t.y1,o=t.x2,i=t.y2,l=t.key,c=L7(t,uze),d=Kn(c,!1);d.offset;var u=L7(d,fze);r=Se.createElement("line",Ep({},u,{x1:n,y1:s,x2:o,y2:i,fill:"none",key:l}))}return r}function xze(e){var t=e.x,r=e.width,n=e.horizontal,s=n===void 0?!0:n,o=e.horizontalPoints;if(!s||!o||!o.length)return null;var i=o.map(function(l,c){var d=Ji(Ji({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return VZ(s,d)});return Se.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function yze(e){var t=e.y,r=e.height,n=e.vertical,s=n===void 0?!0:n,o=e.verticalPoints;if(!s||!o||!o.length)return null;var i=o.map(function(l,c){var d=Ji(Ji({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return VZ(s,d)});return Se.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function bze(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,s=e.y,o=e.width,i=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(h){return Math.round(h+s-s)}).sort(function(h,m){return h-m});s!==u[0]&&u.unshift(0);var f=u.map(function(h,m){var v=!u[m+1],g=v?s+i-h:u[m+1]-h;if(g<=0)return null;var y=m%t.length;return Se.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:g,width:o,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Se.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function wze(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,s=e.fillOpacity,o=e.x,i=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var u=d.map(function(h){return Math.round(h+o-o)}).sort(function(h,m){return h-m});o!==u[0]&&u.unshift(0);var f=u.map(function(h,m){var v=!u[m+1],g=v?o+l-h:u[m+1]-h;if(g<=0)return null;var y=m%n.length;return Se.createElement("rect",{key:"react-".concat(m),x:h,y:i,width:g,height:c,stroke:"none",fill:n[y],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return Se.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var jze=function(t,r){var n=t.xAxis,s=t.width,o=t.height,i=t.offset;return qQ(yM(Ji(Ji(Ji({},E0.defaultProps),n),{},{ticks:If(n,!0),viewBox:{x:0,y:0,width:s,height:o}})),i.left,i.left+i.width,r)},_ze=function(t,r){var n=t.yAxis,s=t.width,o=t.height,i=t.offset;return qQ(yM(Ji(Ji(Ji({},E0.defaultProps),n),{},{ticks:If(n,!0),viewBox:{x:0,y:0,width:s,height:o}})),i.top,i.top+i.height,r)},Qg={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function ZN(e){var t,r,n,s,o,i,l=pM(),c=gM(),d=m7e(),u=Ji(Ji({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Qg.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Qg.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Qg.horizontal,horizontalFill:(s=e.horizontalFill)!==null&&s!==void 0?s:Qg.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:Qg.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:Qg.verticalFill,x:Zr(e.x)?e.x:d.left,y:Zr(e.y)?e.y:d.top,width:Zr(e.width)?e.width:d.width,height:Zr(e.height)?e.height:d.height}),f=u.x,h=u.y,m=u.width,v=u.height,g=u.syncWithTicks,y=u.horizontalValues,x=u.verticalValues,b=d7e(),w=u7e();if(!Zr(m)||m<=0||!Zr(v)||v<=0||!Zr(f)||f!==+f||!Zr(h)||h!==+h)return null;var j=u.verticalCoordinatesGenerator||jze,_=u.horizontalCoordinatesGenerator||_ze,C=u.horizontalPoints,P=u.verticalPoints;if((!C||!C.length)&&na(_)){var E=y&&y.length,A=_({yAxis:w?Ji(Ji({},w),{},{ticks:E?y:w.ticks}):void 0,width:l,height:c,offset:d},E?!0:g);ou(Array.isArray(A),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(ug(A),"]")),Array.isArray(A)&&(C=A)}if((!P||!P.length)&&na(j)){var F=x&&x.length,D=j({xAxis:b?Ji(Ji({},b),{},{ticks:F?x:b.ticks}):void 0,width:l,height:c,offset:d},F?!0:g);ou(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(ug(D),"]")),Array.isArray(D)&&(P=D)}return Se.createElement("g",{className:"recharts-cartesian-grid"},Se.createElement(vze,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),Se.createElement(xze,Ep({},u,{offset:d,horizontalPoints:C,xAxis:b,yAxis:w})),Se.createElement(yze,Ep({},u,{offset:d,verticalPoints:P,xAxis:b,yAxis:w})),Se.createElement(bze,Ep({},u,{horizontalPoints:C})),Se.createElement(wze,Ep({},u,{verticalPoints:P})))}ZN.displayName="CartesianGrid";var Nze=["type","layout","connectNulls","ref"],Sze=["key"];function Wx(e){"@babel/helpers - typeof";return Wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wx(e)}function F7(e,t){if(e==null)return{};var r=Cze(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Cze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ib(){return ib=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ib.apply(this,arguments)}function $7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function hc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$7(Object(r),!0).forEach(function(n){Yd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zg(e){return kze(e)||Eze(e)||Pze(e)||Aze()}function Aze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pze(e,t){if(e){if(typeof e=="string")return tT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tT(e,t)}}function Eze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kze(e){if(Array.isArray(e))return tT(e)}function tT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ize(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HZ(n.key),n)}}function Oze(e,t,r){return t&&B7(e.prototype,t),r&&B7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tze(e,t,r){return t=eS(t),Dze(e,WZ()?Reflect.construct(t,r||[],eS(e).constructor):t.apply(e,r))}function Dze(e,t){if(t&&(Wx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mze(e)}function Mze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WZ=function(){return!!e})()}function eS(e){return eS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eS(e)}function Rze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rT(e,t)}function rT(e,t){return rT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},rT(e,t)}function Yd(e,t,r){return t=HZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HZ(e){var t=Lze(e,"string");return Wx(t)=="symbol"?t:t+""}function Lze(e,t){if(Wx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k0=function(e){function t(){var r;Ize(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=Tze(this,t,[].concat(s)),Yd(r,"state",{isAnimationFinished:!0,totalLength:0}),Yd(r,"generateSimpleStrokeDasharray",function(i,l){return"".concat(l,"px ").concat(i-l,"px")}),Yd(r,"getStrokeDasharray",function(i,l,c){var d=c.reduce(function(x,b){return x+b});if(!d)return r.generateSimpleStrokeDasharray(l,i);for(var u=Math.floor(i/d),f=i%d,h=l-i,m=[],v=0,g=0;v<c.length;g+=c[v],++v)if(g+c[v]>f){m=[].concat(Zg(c.slice(0,v)),[f-g]);break}var y=m.length%2===0?[0,h]:[h];return[].concat(Zg(t.repeat(c,u)),Zg(m),y).map(function(x){return"".concat(x,"px")}).join(", ")}),Yd(r,"id",Cg("recharts-line-")),Yd(r,"pathRef",function(i){r.mainCurve=i}),Yd(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Yd(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Rze(t,e),Oze(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,i=o.points,l=o.xAxis,c=o.yAxis,d=o.layout,u=o.children,f=Dc(u,_1);if(!f)return null;var h=function(g,y){return{x:g.x,y:g.y,value:g.value,errorVal:No(g.payload,y)}},m={clipPath:n?"url(#clipPath-".concat(s,")"):null};return Se.createElement(Ta,m,f.map(function(v){return Se.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:i,xAxis:l,yAxis:c,layout:d,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,s,o){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,u=l.dataKey,f=Kn(this.props,!1),h=Kn(c,!0),m=d.map(function(g,y){var x=hc(hc(hc({key:"dot-".concat(y),r:3},f),h),{},{index:y,cx:g.x,cy:g.y,value:g.value,dataKey:u,payload:g.payload,points:d});return t.renderDotItem(c,x)}),v={clipPath:n?"url(#clipPath-".concat(s?"":"dots-").concat(o,")"):null};return Se.createElement(Ta,ib({className:"recharts-line-dots",key:"dots"},v),m)}},{key:"renderCurveStatically",value:function(n,s,o,i){var l=this.props,c=l.type,d=l.layout,u=l.connectNulls;l.ref;var f=F7(l,Nze),h=hc(hc(hc({},Kn(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:s?"url(#clipPath-".concat(o,")"):null,points:n},i),{},{type:c,layout:d,connectNulls:u});return Se.createElement(Vp,ib({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,s){var o=this,i=this.props,l=i.points,c=i.strokeDasharray,d=i.isAnimationActive,u=i.animationBegin,f=i.animationDuration,h=i.animationEasing,m=i.animationId,v=i.animateNewValues,g=i.width,y=i.height,x=this.state,b=x.prevPoints,w=x.totalLength;return Se.createElement(Ph,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var _=j.t;if(b){var C=b.length/l.length,P=l.map(function(I,R){var M=Math.floor(R*C);if(b[M]){var U=b[M],z=Xo(U.x,I.x),W=Xo(U.y,I.y);return hc(hc({},I),{},{x:z(_),y:W(_)})}if(v){var $=Xo(g*2,I.x),ee=Xo(y/2,I.y);return hc(hc({},I),{},{x:$(_),y:ee(_)})}return hc(hc({},I),{},{x:I.x,y:I.y})});return o.renderCurveStatically(P,n,s)}var E=Xo(0,w),A=E(_),F;if(c){var D="".concat(c).split(/[,\s]+/gim).map(function(I){return parseFloat(I)});F=o.getStrokeDasharray(A,w,D)}else F=o.generateSimpleStrokeDasharray(w,A);return o.renderCurveStatically(l,n,s,{strokeDasharray:F})})}},{key:"renderCurve",value:function(n,s){var o=this.props,i=o.points,l=o.isAnimationActive,c=this.state,d=c.prevPoints,u=c.totalLength;return l&&i&&i.length&&(!d&&u>0||!cg(d,i))?this.renderCurveWithAnimation(n,s):this.renderCurveStatically(i,n,s)}},{key:"render",value:function(){var n,s=this.props,o=s.hide,i=s.dot,l=s.points,c=s.className,d=s.xAxis,u=s.yAxis,f=s.top,h=s.left,m=s.width,v=s.height,g=s.isAnimationActive,y=s.id;if(o||!l||!l.length)return null;var x=this.state.isAnimationFinished,b=l.length===1,w=ga("recharts-line",c),j=d&&d.allowDataOverflow,_=u&&u.allowDataOverflow,C=j||_,P=fa(y)?this.id:y,E=(n=Kn(i,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},A=E.r,F=A===void 0?3:A,D=E.strokeWidth,I=D===void 0?2:D,R=TY(i)?i:{},M=R.clipDot,U=M===void 0?!0:M,z=F*2+I;return Se.createElement(Ta,{className:w},j||_?Se.createElement("defs",null,Se.createElement("clipPath",{id:"clipPath-".concat(P)},Se.createElement("rect",{x:j?h:h-m/2,y:_?f:f-v/2,width:j?m:m*2,height:_?v:v*2})),!U&&Se.createElement("clipPath",{id:"clipPath-dots-".concat(P)},Se.createElement("rect",{x:h-z/2,y:f-z/2,width:m+z,height:v+z}))):null,!b&&this.renderCurve(C,P),this.renderErrorBar(C,P),(b||i)&&this.renderDots(C,U,P),(!g||x)&&Gu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:s.curPoints}:n.points!==s.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,s){for(var o=n.length%2!==0?[].concat(Zg(n),[0]):n,i=[],l=0;l<s;++l)i=[].concat(Zg(i),Zg(o));return i}},{key:"renderDotItem",value:function(n,s){var o;if(Se.isValidElement(n))o=Se.cloneElement(n,s);else if(na(n))o=n(s);else{var i=s.key,l=F7(s,Sze),c=ga("recharts-line-dot",typeof n!="boolean"?n.className:"");o=Se.createElement(N1,ib({key:i},l,{className:c}))}return o}}])}(p.PureComponent);Yd(k0,"displayName","Line");Yd(k0,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!iu.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Yd(k0,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,s=e.xAxisTicks,o=e.yAxisTicks,i=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,u=t.layout,f=c.map(function(h,m){var v=No(h,i);return u==="horizontal"?{x:EN({axis:r,ticks:s,bandSize:l,entry:h,index:m}),y:fa(v)?null:n.scale(v),value:v,payload:h}:{x:fa(v)?null:r.scale(v),y:EN({axis:n,ticks:o,bandSize:l,entry:h,index:m}),value:v,payload:h}});return hc({points:f,layout:u},d)});var Fze=["layout","type","stroke","connectNulls","isRange","ref"],$ze=["key"],GZ;function Hx(e){"@babel/helpers - typeof";return Hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hx(e)}function KZ(e,t){if(e==null)return{};var r=Bze(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Bze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kp(){return kp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kp.apply(this,arguments)}function q7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Am(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q7(Object(r),!0).forEach(function(n){Fu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YZ(n.key),n)}}function zze(e,t,r){return t&&z7(e.prototype,t),r&&z7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uze(e,t,r){return t=tS(t),Vze(e,XZ()?Reflect.construct(t,r||[],tS(e).constructor):t.apply(e,r))}function Vze(e,t){if(t&&(Hx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wze(e)}function Wze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XZ=function(){return!!e})()}function tS(e){return tS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tS(e)}function Hze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nT(e,t)}function nT(e,t){return nT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},nT(e,t)}function Fu(e,t,r){return t=YZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YZ(e){var t=Gze(e,"string");return Hx(t)=="symbol"?t:t+""}function Gze(e,t){if(Hx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vh=function(e){function t(){var r;qze(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=Uze(this,t,[].concat(s)),Fu(r,"state",{isAnimationFinished:!0}),Fu(r,"id",Cg("recharts-area-")),Fu(r,"handleAnimationEnd",function(){var i=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),na(i)&&i()}),Fu(r,"handleAnimationStart",function(){var i=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),na(i)&&i()}),r}return Hze(t,e),zze(t,[{key:"renderDots",value:function(n,s,o){var i=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(i&&!l)return null;var c=this.props,d=c.dot,u=c.points,f=c.dataKey,h=Kn(this.props,!1),m=Kn(d,!0),v=u.map(function(y,x){var b=Am(Am(Am({key:"dot-".concat(x),r:3},h),m),{},{index:x,cx:y.x,cy:y.y,dataKey:f,value:y.value,payload:y.payload,points:u});return t.renderDotItem(d,b)}),g={clipPath:n?"url(#clipPath-".concat(s?"":"dots-").concat(o,")"):null};return Se.createElement(Ta,kp({className:"recharts-area-dots"},g),v)}},{key:"renderHorizontalRect",value:function(n){var s=this.props,o=s.baseLine,i=s.points,l=s.strokeWidth,c=i[0].x,d=i[i.length-1].x,u=n*Math.abs(c-d),f=Vm(i.map(function(h){return h.y||0}));return Zr(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(Vm(o.map(function(h){return h.y||0})),f)),Zr(f)?Se.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(f+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var s=this.props,o=s.baseLine,i=s.points,l=s.strokeWidth,c=i[0].y,d=i[i.length-1].y,u=n*Math.abs(c-d),f=Vm(i.map(function(h){return h.x||0}));return Zr(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(Vm(o.map(function(h){return h.x||0})),f)),Zr(f)?Se.createElement("rect",{x:0,y:c<d?c:c-u,width:f+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(n){var s=this.props.layout;return s==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,s,o,i){var l=this.props,c=l.layout,d=l.type,u=l.stroke,f=l.connectNulls,h=l.isRange;l.ref;var m=KZ(l,Fze);return Se.createElement(Ta,{clipPath:o?"url(#clipPath-".concat(i,")"):null},Se.createElement(Vp,kp({},Kn(m,!0),{points:n,connectNulls:f,type:d,baseLine:s,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&Se.createElement(Vp,kp({},Kn(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:n})),u!=="none"&&h&&Se.createElement(Vp,kp({},Kn(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:s})))}},{key:"renderAreaWithAnimation",value:function(n,s){var o=this,i=this.props,l=i.points,c=i.baseLine,d=i.isAnimationActive,u=i.animationBegin,f=i.animationDuration,h=i.animationEasing,m=i.animationId,v=this.state,g=v.prevPoints,y=v.prevBaseLine;return Se.createElement(Ph,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var b=x.t;if(g){var w=g.length/l.length,j=l.map(function(E,A){var F=Math.floor(A*w);if(g[F]){var D=g[F],I=Xo(D.x,E.x),R=Xo(D.y,E.y);return Am(Am({},E),{},{x:I(b),y:R(b)})}return E}),_;if(Zr(c)&&typeof c=="number"){var C=Xo(y,c);_=C(b)}else if(fa(c)||j0(c)){var P=Xo(y,0);_=P(b)}else _=c.map(function(E,A){var F=Math.floor(A*w);if(y[F]){var D=y[F],I=Xo(D.x,E.x),R=Xo(D.y,E.y);return Am(Am({},E),{},{x:I(b),y:R(b)})}return E});return o.renderAreaStatically(j,_,n,s)}return Se.createElement(Ta,null,Se.createElement("defs",null,Se.createElement("clipPath",{id:"animationClipPath-".concat(s)},o.renderClipRect(b))),Se.createElement(Ta,{clipPath:"url(#animationClipPath-".concat(s,")")},o.renderAreaStatically(l,c,n,s)))})}},{key:"renderArea",value:function(n,s){var o=this.props,i=o.points,l=o.baseLine,c=o.isAnimationActive,d=this.state,u=d.prevPoints,f=d.prevBaseLine,h=d.totalLength;return c&&i&&i.length&&(!u&&h>0||!cg(u,i)||!cg(f,l))?this.renderAreaWithAnimation(n,s):this.renderAreaStatically(i,l,n,s)}},{key:"render",value:function(){var n,s=this.props,o=s.hide,i=s.dot,l=s.points,c=s.className,d=s.top,u=s.left,f=s.xAxis,h=s.yAxis,m=s.width,v=s.height,g=s.isAnimationActive,y=s.id;if(o||!l||!l.length)return null;var x=this.state.isAnimationFinished,b=l.length===1,w=ga("recharts-area",c),j=f&&f.allowDataOverflow,_=h&&h.allowDataOverflow,C=j||_,P=fa(y)?this.id:y,E=(n=Kn(i,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},A=E.r,F=A===void 0?3:A,D=E.strokeWidth,I=D===void 0?2:D,R=TY(i)?i:{},M=R.clipDot,U=M===void 0?!0:M,z=F*2+I;return Se.createElement(Ta,{className:w},j||_?Se.createElement("defs",null,Se.createElement("clipPath",{id:"clipPath-".concat(P)},Se.createElement("rect",{x:j?u:u-m/2,y:_?d:d-v/2,width:j?m:m*2,height:_?v:v*2})),!U&&Se.createElement("clipPath",{id:"clipPath-dots-".concat(P)},Se.createElement("rect",{x:u-z/2,y:d-z/2,width:m+z,height:v+z}))):null,b?null:this.renderArea(C,P),(i||b)&&this.renderDots(C,U,P),(!g||x)&&Gu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:s.curPoints,prevBaseLine:s.curBaseLine}:n.points!==s.curPoints||n.baseLine!==s.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(p.PureComponent);GZ=Vh;Fu(Vh,"displayName","Area");Fu(Vh,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!iu.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Fu(Vh,"getBaseValue",function(e,t,r,n){var s=e.layout,o=e.baseValue,i=t.props.baseValue,l=i??o;if(Zr(l)&&typeof l=="number")return l;var c=s==="horizontal"?n:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return l==="dataMin"?f:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});Fu(Vh,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,s=e.yAxis,o=e.xAxisTicks,i=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=t.layout,v=d&&d.length,g=GZ.getBaseValue(t,r,n,s),y=m==="horizontal",x=!1,b=f.map(function(j,_){var C;v?C=d[u+_]:(C=No(j,c),Array.isArray(C)?x=!0:C=[g,C]);var P=C[1]==null||v&&No(j,c)==null;return y?{x:EN({axis:n,ticks:o,bandSize:l,entry:j,index:_}),y:P?null:s.scale(C[1]),value:C,payload:j}:{x:P?null:n.scale(C[1]),y:EN({axis:s,ticks:i,bandSize:l,entry:j,index:_}),value:C,payload:j}}),w;return v||x?w=b.map(function(j){var _=Array.isArray(j.value)?j.value[0]:null;return y?{x:j.x,y:_!=null&&j.y!=null?s.scale(_):null}:{x:_!=null?n.scale(_):null,y:j.y}}):w=y?s.scale(g):n.scale(g),Am({points:b,baseLine:w,layout:m,isRange:x},h)});Fu(Vh,"renderDotItem",function(e,t){var r;if(Se.isValidElement(e))r=Se.cloneElement(e,t);else if(na(e))r=e(t);else{var n=ga("recharts-area-dot",typeof e!="boolean"?e.className:""),s=t.key,o=KZ(t,$ze);r=Se.createElement(N1,kp({},o,{key:s,className:n}))}return r});function Gx(e){"@babel/helpers - typeof";return Gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gx(e)}function Kze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZZ(n.key),n)}}function Xze(e,t,r){return t&&U7(e.prototype,t),r&&U7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yze(e,t,r){return t=rS(t),Jze(e,JZ()?Reflect.construct(t,r||[],rS(e).constructor):t.apply(e,r))}function Jze(e,t){if(t&&(Gx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qze(e)}function Qze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JZ=function(){return!!e})()}function rS(e){return rS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rS(e)}function Zze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aT(e,t)}function aT(e,t){return aT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},aT(e,t)}function QZ(e,t,r){return t=ZZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZZ(e){var t=e9e(e,"string");return Gx(t)=="symbol"?t:t+""}function e9e(e,t){if(Gx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sT(){return sT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sT.apply(this,arguments)}function t9e(e){var t=e.xAxisId,r=pM(),n=gM(),s=TZ(t);return s==null?null:p.createElement(E0,sT({},s,{className:ga("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(i){return If(i,!0)}}))}var Eh=function(e){function t(){return Kze(this,t),Yze(this,t,arguments)}return Zze(t,e),Xze(t,[{key:"render",value:function(){return p.createElement(t9e,this.props)}}])}(p.Component);QZ(Eh,"displayName","XAxis");QZ(Eh,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Kx(e){"@babel/helpers - typeof";return Kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kx(e)}function r9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ree(n.key),n)}}function n9e(e,t,r){return t&&V7(e.prototype,t),r&&V7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a9e(e,t,r){return t=nS(t),s9e(e,eee()?Reflect.construct(t,r||[],nS(e).constructor):t.apply(e,r))}function s9e(e,t){if(t&&(Kx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o9e(e)}function o9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eee=function(){return!!e})()}function nS(e){return nS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nS(e)}function i9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oT(e,t)}function oT(e,t){return oT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},oT(e,t)}function tee(e,t,r){return t=ree(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ree(e){var t=l9e(e,"string");return Kx(t)=="symbol"?t:t+""}function l9e(e,t){if(Kx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iT(){return iT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iT.apply(this,arguments)}var c9e=function(t){var r=t.yAxisId,n=pM(),s=gM(),o=DZ(r);return o==null?null:p.createElement(E0,iT({},o,{className:ga("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:s},ticksGenerator:function(l){return If(l,!0)}}))},kh=function(e){function t(){return r9e(this,t),a9e(this,t,arguments)}return i9e(t,e),n9e(t,[{key:"render",value:function(){return p.createElement(c9e,this.props)}}])}(p.Component);tee(kh,"displayName","YAxis");tee(kh,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function W7(e){return m9e(e)||f9e(e)||u9e(e)||d9e()}function d9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u9e(e,t){if(e){if(typeof e=="string")return lT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lT(e,t)}}function f9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function m9e(e){if(Array.isArray(e))return lT(e)}function lT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var cT=function(t,r,n,s,o){var i=Dc(t,xM),l=Dc(t,v5),c=[].concat(W7(i),W7(l)),d=Dc(t,y5),u="".concat(s,"Id"),f=s[0],h=r;if(c.length&&(h=c.reduce(function(g,y){if(y.props[u]===n&&Ku(y.props,"extendDomain")&&Zr(y.props[f])){var x=y.props[f];return[Math.min(g[0],x),Math.max(g[1],x)]}return g},h)),d.length){var m="".concat(f,"1"),v="".concat(f,"2");h=d.reduce(function(g,y){if(y.props[u]===n&&Ku(y.props,"extendDomain")&&Zr(y.props[m])&&Zr(y.props[v])){var x=y.props[m],b=y.props[v];return[Math.min(g[0],x,b),Math.max(g[1],x,b)]}return g},h)}return o&&o.length&&(h=o.reduce(function(g,y){return Zr(y)?[Math.min(g[0],y),Math.max(g[1],y)]:g},h)),h},nee={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function o(c,d,u,f,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,f||c,h),v=r?r+d:d;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],m]:c._events[v].push(m):(c._events[v]=m,c._eventsCount++),c}function i(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,v=new Array(m);h<m;h++)v[h]=f[h].fn;return v},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,h,m,v){var g=r?r+d:d;if(!this._events[g])return!1;var y=this._events[g],x=arguments.length,b,w;if(y.fn){switch(y.once&&this.removeListener(d,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,f),!0;case 4:return y.fn.call(y.context,u,f,h),!0;case 5:return y.fn.call(y.context,u,f,h,m),!0;case 6:return y.fn.call(y.context,u,f,h,m,v),!0}for(w=1,b=new Array(x-1);w<x;w++)b[w-1]=arguments[w];y.fn.apply(y.context,b)}else{var j=y.length,_;for(w=0;w<j;w++)switch(y[w].once&&this.removeListener(d,y[w].fn,void 0,!0),x){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,u);break;case 3:y[w].fn.call(y[w].context,u,f);break;case 4:y[w].fn.call(y[w].context,u,f,h);break;default:if(!b)for(_=1,b=new Array(x-1);_<x;_++)b[_-1]=arguments[_];y[w].fn.apply(y[w].context,b)}}return!0},l.prototype.on=function(d,u,f){return o(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return o(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,h){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return i(this,m),this;var v=this._events[m];if(v.fn)v.fn===u&&(!h||v.once)&&(!f||v.context===f)&&i(this,m);else{for(var g=0,y=[],x=v.length;g<x;g++)(v[g].fn!==u||h&&!v[g].once||f&&v[g].context!==f)&&y.push(v[g]);y.length?this._events[m]=y.length===1?y[0]:y:i(this,m)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&i(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(nee);var h9e=nee.exports;const p9e=Ga(h9e);var JP=new p9e,QP="recharts.syncMouseEvents";function Dw(e){"@babel/helpers - typeof";return Dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dw(e)}function g9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aee(n.key),n)}}function v9e(e,t,r){return t&&H7(e.prototype,t),r&&H7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZP(e,t,r){return t=aee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aee(e){var t=x9e(e,"string");return Dw(t)=="symbol"?t:t+""}function x9e(e,t){if(Dw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y9e=function(){function e(){g9e(this,e),ZP(this,"activeIndex",0),ZP(this,"coordinateList",[]),ZP(this,"layout","horizontal")}return v9e(e,[{key:"setDetails",value:function(r){var n,s=r.coordinateList,o=s===void 0?null:s,i=r.container,l=i===void 0?null:i,c=r.layout,d=c===void 0?null:c,u=r.offset,f=u===void 0?null:u,h=r.mouseHandlerCallback,m=h===void 0?null:h;this.coordinateList=(n=o??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=d??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var s=this.container.getBoundingClientRect(),o=s.x,i=s.y,l=s.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=o+c+d,h=i+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function b9e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e?.[0],s=e?.[1];if(n&&s&&Zr(n)&&Zr(s))return!0}return!1}function w9e(e,t,r,n){var s=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function see(e){var t=e.cx,r=e.cy,n=e.radius,s=e.startAngle,o=e.endAngle,i=Ts(t,r,n,s),l=Ts(t,r,n,o);return{points:[i,l],cx:t,cy:r,radius:n,startAngle:s,endAngle:o}}function j9e(e,t,r){var n,s,o,i;if(e==="horizontal")n=t.x,o=n,s=r.top,i=r.top+r.height;else if(e==="vertical")s=t.y,i=s,n=r.left,o=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,f=t.angle,h=Ts(l,c,d,f),m=Ts(l,c,u,f);n=h.x,s=h.y,o=m.x,i=m.y}else return see(t);return[{x:n,y:s},{x:o,y:i}]}function Mw(e){"@babel/helpers - typeof";return Mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mw(e)}function G7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function nj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G7(Object(r),!0).forEach(function(n){_9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _9e(e,t,r){return t=N9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N9e(e){var t=S9e(e,"string");return Mw(t)=="symbol"?t:t+""}function S9e(e,t){if(Mw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C9e(e){var t,r,n=e.element,s=e.tooltipEventType,o=e.isActive,i=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,u=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,m=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!m||!o||!i||h!=="ScatterChart"&&s!=="axis")return null;var v,g=Vp;if(h==="ScatterChart")v=i,g=B6e;else if(h==="BarChart")v=w9e(f,i,c,u),g=dM;else if(f==="radial"){var y=see(i),x=y.cx,b=y.cy,w=y.radius,j=y.startAngle,_=y.endAngle;v={cx:x,cy:b,startAngle:j,endAngle:_,innerRadius:w,outerRadius:w},g=cM}else v={points:j9e(f,i,c)},g=Vp;var C=nj(nj(nj(nj({stroke:"#ccc",pointerEvents:"none"},c),v),Kn(m,!1)),{},{payload:l,payloadIndex:d,className:ga("recharts-tooltip-cursor",m.className)});return p.isValidElement(m)?p.cloneElement(m,C):p.createElement(g,C)}var A9e=["item"],P9e=["children","className","width","height","style","compact","title","desc"];function Xx(e){"@babel/helpers - typeof";return Xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xx(e)}function Bv(){return Bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bv.apply(this,arguments)}function K7(e,t){return I9e(e)||k9e(e,t)||iee(e,t)||E9e()}function E9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k9e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function I9e(e){if(Array.isArray(e))return e}function X7(e,t){if(e==null)return{};var r=O9e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function O9e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function T9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lee(n.key),n)}}function D9e(e,t,r){return t&&Y7(e.prototype,t),r&&Y7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M9e(e,t,r){return t=aS(t),R9e(e,oee()?Reflect.construct(t,r||[],aS(e).constructor):t.apply(e,r))}function R9e(e,t){if(t&&(Xx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L9e(e)}function L9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oee=function(){return!!e})()}function aS(e){return aS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aS(e)}function F9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dT(e,t)}function dT(e,t){return dT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},dT(e,t)}function Yx(e){return q9e(e)||B9e(e)||iee(e)||$9e()}function $9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iee(e,t){if(e){if(typeof e=="string")return uT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uT(e,t)}}function B9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function q9e(e){if(Array.isArray(e))return uT(e)}function uT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Er(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J7(Object(r),!0).forEach(function(n){ta(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ta(e,t,r){return t=lee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lee(e){var t=z9e(e,"string");return Xx(t)=="symbol"?t:t+""}function z9e(e,t){if(Xx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U9e={xAxis:["bottom","top"],yAxis:["left","right"]},V9e={width:"100%",height:"100%"},cee={x:0,y:0};function aj(e){return e}var W9e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},H9e=function(t,r,n,s){var o=r.find(function(u){return u&&u.index===n});if(o){if(t==="horizontal")return{x:o.coordinate,y:s.y};if(t==="vertical")return{x:s.x,y:o.coordinate};if(t==="centric"){var i=o.coordinate,l=s.radius;return Er(Er(Er({},s),Ts(s.cx,s.cy,l,i)),{},{angle:i,radius:l})}var c=o.coordinate,d=s.angle;return Er(Er(Er({},s),Ts(s.cx,s.cy,c,d)),{},{angle:d,radius:c})}return cee},b5=function(t,r){var n=r.graphicalItems,s=r.dataStartIndex,o=r.dataEndIndex,i=(n??[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(Yx(l),Yx(d)):l},[]);return i.length>0?i:t&&t.length&&Zr(s)&&Zr(o)?t.slice(s,o+1):[]};function dee(e){return e==="number"?[0,"auto"]:void 0}var fT=function(t,r,n,s){var o=t.graphicalItems,i=t.tooltipAxis,l=b5(r,t);return n<0||!o||!o.length||n>=l.length?null:o.reduce(function(c,d){var u,f=(u=d.props.data)!==null&&u!==void 0?u:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(i.dataKey&&!i.allowDuplicatedCategory){var m=f===void 0?l:f;h=tN(m,i.dataKey,s)}else h=f&&f[n]||l[n];return h?[].concat(Yx(c),[HQ(d,h)]):c},[])},Q7=function(t,r,n,s){var o=s||{x:t.chartX,y:t.chartY},i=W9e(o,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=uLe(i,l,d,c);if(u>=0&&d){var f=d[u]&&d[u].value,h=fT(t,r,u,f),m=H9e(n,l,u,o);return{activeTooltipIndex:u,activeLabel:f,activePayload:h,activeCoordinate:m}}return null},G9e=function(t,r){var n=r.axes,s=r.graphicalItems,o=r.axisType,i=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=t.stackOffset,m=BQ(u,o);return n.reduce(function(v,g){var y,x=g.type.defaultProps!==void 0?Er(Er({},g.type.defaultProps),g.props):g.props,b=x.type,w=x.dataKey,j=x.allowDataOverflow,_=x.allowDuplicatedCategory,C=x.scale,P=x.ticks,E=x.includeHidden,A=x[i];if(v[A])return v;var F=b5(t.data,{graphicalItems:s.filter(function(K){var q,Y=i in K.props?K.props[i]:(q=K.type.defaultProps)===null||q===void 0?void 0:q[i];return Y===A}),dataStartIndex:c,dataEndIndex:d}),D=F.length,I,R,M;b9e(x.domain,j,b)&&(I=SO(x.domain,null,j),m&&(b==="number"||C!=="auto")&&(M=nb(F,w,"category")));var U=dee(b);if(!I||I.length===0){var z,W=(z=x.domain)!==null&&z!==void 0?z:U;if(w){if(I=nb(F,w,b),b==="category"&&m){var $=aSe(I);_&&$?(R=I,I=UN(0,D)):_||(I=dq(W,I,g).reduce(function(K,q){return K.indexOf(q)>=0?K:[].concat(Yx(K),[q])},[]))}else if(b==="category")_?I=I.filter(function(K){return K!==""&&!fa(K)}):I=dq(W,I,g).reduce(function(K,q){return K.indexOf(q)>=0||q===""||fa(q)?K:[].concat(Yx(K),[q])},[]);else if(b==="number"){var ee=gLe(F,s.filter(function(K){var q,Y,J=i in K.props?K.props[i]:(q=K.type.defaultProps)===null||q===void 0?void 0:q[i],fe="hide"in K.props?K.props.hide:(Y=K.type.defaultProps)===null||Y===void 0?void 0:Y.hide;return J===A&&(E||!fe)}),w,o,u);ee&&(I=ee)}m&&(b==="number"||C!=="auto")&&(M=nb(F,w,"category"))}else m?I=UN(0,D):l&&l[A]&&l[A].hasStack&&b==="number"?I=h==="expand"?[0,1]:WQ(l[A].stackGroups,c,d):I=$Q(F,s.filter(function(K){var q=i in K.props?K.props[i]:K.type.defaultProps[i],Y="hide"in K.props?K.props.hide:K.type.defaultProps.hide;return q===A&&(E||!Y)}),b,u,!0);if(b==="number")I=cT(f,I,A,o,P),W&&(I=SO(W,I,j));else if(b==="category"&&W){var ve=W,_e=I.every(function(K){return ve.indexOf(K)>=0});_e&&(I=ve)}}return Er(Er({},v),{},ta({},A,Er(Er({},x),{},{axisType:o,domain:I,categoricalDomain:M,duplicateDomain:R,originalDomain:(y=x.domain)!==null&&y!==void 0?y:U,isCategorical:m,layout:u})))},{})},K9e=function(t,r){var n=r.graphicalItems,s=r.Axis,o=r.axisType,i=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=b5(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),m=h.length,v=BQ(u,o),g=-1;return n.reduce(function(y,x){var b=x.type.defaultProps!==void 0?Er(Er({},x.type.defaultProps),x.props):x.props,w=b[i],j=dee("number");if(!y[w]){g++;var _;return v?_=UN(0,m):l&&l[w]&&l[w].hasStack?(_=WQ(l[w].stackGroups,c,d),_=cT(f,_,w,o)):(_=SO(j,$Q(h,n.filter(function(C){var P,E,A=i in C.props?C.props[i]:(P=C.type.defaultProps)===null||P===void 0?void 0:P[i],F="hide"in C.props?C.props.hide:(E=C.type.defaultProps)===null||E===void 0?void 0:E.hide;return A===w&&!F}),"number",u),s.defaultProps.allowDataOverflow),_=cT(f,_,w,o)),Er(Er({},y),{},ta({},w,Er(Er({axisType:o},s.defaultProps),{},{hide:!0,orientation:Tc(U9e,"".concat(o,".").concat(g%2),null),domain:_,originalDomain:j,isCategorical:v,layout:u})))}return y},{})},X9e=function(t,r){var n=r.axisType,s=n===void 0?"xAxis":n,o=r.AxisComp,i=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,f="".concat(s,"Id"),h=Dc(u,o),m={};return h&&h.length?m=G9e(t,{axes:h,graphicalItems:i,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):i&&i.length&&(m=K9e(t,{Axis:o,graphicalItems:i,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),m},Y9e=function(t){var r=Rm(t),n=If(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:RD(n,function(s){return s.coordinate}),tooltipAxis:r,tooltipAxisBandSize:kN(r,n)}},Z7=function(t){var r=t.children,n=t.defaultShowTooltip,s=bc(r,$x),o=0,i=0;return t.data&&t.data.length!==0&&(i=t.data.length-1),s&&s.props&&(s.props.startIndex>=0&&(o=s.props.startIndex),s.props.endIndex>=0&&(i=s.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:o,dataEndIndex:i,activeTooltipIndex:-1,isTooltipActive:!!n}},J9e=function(t){return!t||!t.length?!1:t.some(function(r){var n=Rf(r&&r.type);return n&&n.indexOf("Bar")>=0})},ez=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Q9e=function(t,r){var n=t.props,s=t.graphicalItems,o=t.xAxisMap,i=o===void 0?{}:o,l=t.yAxisMap,c=l===void 0?{}:l,d=n.width,u=n.height,f=n.children,h=n.margin||{},m=bc(f,$x),v=bc(f,qp),g=Object.keys(c).reduce(function(_,C){var P=c[C],E=P.orientation;return!P.mirror&&!P.hide?Er(Er({},_),{},ta({},E,_[E]+P.width)):_},{left:h.left||0,right:h.right||0}),y=Object.keys(i).reduce(function(_,C){var P=i[C],E=P.orientation;return!P.mirror&&!P.hide?Er(Er({},_),{},ta({},E,Tc(_,"".concat(E))+P.height)):_},{top:h.top||0,bottom:h.bottom||0}),x=Er(Er({},y),g),b=x.bottom;m&&(x.bottom+=m.props.height||$x.defaultProps.height),v&&r&&(x=hLe(x,s,n,r));var w=d-x.left-x.right,j=u-x.top-x.bottom;return Er(Er({brushBottom:b},x),{},{width:Math.max(w,0),height:Math.max(j,0)})},Z9e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},w5=function(t){var r=t.chartName,n=t.GraphicalChild,s=t.defaultTooltipEventType,o=s===void 0?"axis":s,i=t.validateTooltipEventTypes,l=i===void 0?["axis"]:i,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,f=t.defaultProps,h=function(x,b){var w=b.graphicalItems,j=b.stackGroups,_=b.offset,C=b.updateId,P=b.dataStartIndex,E=b.dataEndIndex,A=x.barSize,F=x.layout,D=x.barGap,I=x.barCategoryGap,R=x.maxBarSize,M=ez(F),U=M.numericAxisName,z=M.cateAxisName,W=J9e(w),$=[];return w.forEach(function(ee,ve){var _e=b5(x.data,{graphicalItems:[ee],dataStartIndex:P,dataEndIndex:E}),K=ee.type.defaultProps!==void 0?Er(Er({},ee.type.defaultProps),ee.props):ee.props,q=K.dataKey,Y=K.maxBarSize,J=K["".concat(U,"Id")],fe=K["".concat(z,"Id")],Z={},ce=c.reduce(function(yt,Qe){var ge=b["".concat(Qe.axisType,"Map")],rt=K["".concat(Qe.axisType,"Id")];ge&&ge[rt]||Qe.axisType==="zAxis"||Ah(!1);var pt=ge[rt];return Er(Er({},yt),{},ta(ta({},Qe.axisType,pt),"".concat(Qe.axisType,"Ticks"),If(pt)))},Z),le=ce[z],ie=ce["".concat(z,"Ticks")],te=j&&j[J]&&j[J].hasStack&&SLe(ee,j[J].stackGroups),ue=Rf(ee.type).indexOf("Bar")>=0,Te=kN(le,ie),ne=[],de=W&&fLe({barSize:A,stackGroups:j,totalSize:Z9e(ce,z)});if(ue){var lt,Nt,at=fa(Y)?R:Y,gt=(lt=(Nt=kN(le,ie,!0))!==null&&Nt!==void 0?Nt:at)!==null&&lt!==void 0?lt:0;ne=mLe({barGap:D,barCategoryGap:I,bandSize:gt!==Te?gt:Te,sizeList:de[fe],maxBarSize:at}),gt!==Te&&(ne=ne.map(function(yt){return Er(Er({},yt),{},{position:Er(Er({},yt.position),{},{offset:yt.position.offset-gt/2})})}))}var Pt=ee&&ee.type&&ee.type.getComposedData;Pt&&$.push({props:Er(Er({},Pt(Er(Er({},ce),{},{displayedData:_e,props:x,dataKey:q,item:ee,bandSize:Te,barPosition:ne,offset:_,stackedData:te,layout:F,dataStartIndex:P,dataEndIndex:E}))),{},ta(ta(ta({key:ee.key||"item-".concat(ve)},U,ce[U]),z,ce[z]),"animationId",C)),childIndex:gSe(ee,x.children),item:ee})}),$},m=function(x,b){var w=x.props,j=x.dataStartIndex,_=x.dataEndIndex,C=x.updateId;if(!e8({props:w}))return null;var P=w.children,E=w.layout,A=w.stackOffset,F=w.data,D=w.reverseStackOrder,I=ez(E),R=I.numericAxisName,M=I.cateAxisName,U=Dc(P,n),z=_Le(F,U,"".concat(R,"Id"),"".concat(M,"Id"),A,D),W=c.reduce(function(K,q){var Y="".concat(q.axisType,"Map");return Er(Er({},K),{},ta({},Y,X9e(w,Er(Er({},q),{},{graphicalItems:U,stackGroups:q.axisType===R&&z,dataStartIndex:j,dataEndIndex:_}))))},{}),$=Q9e(Er(Er({},W),{},{props:w,graphicalItems:U}),b?.legendBBox);Object.keys(W).forEach(function(K){W[K]=u(w,W[K],$,K.replace("Map",""),r)});var ee=W["".concat(M,"Map")],ve=Y9e(ee),_e=h(w,Er(Er({},W),{},{dataStartIndex:j,dataEndIndex:_,updateId:C,graphicalItems:U,stackGroups:z,offset:$}));return Er(Er({formattedGraphicalItems:_e,graphicalItems:U,offset:$,stackGroups:z},ve),W)},v=function(y){function x(b){var w,j,_;return T9e(this,x),_=M9e(this,x,[b]),ta(_,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ta(_,"accessibilityManager",new y9e),ta(_,"handleLegendBBoxUpdate",function(C){if(C){var P=_.state,E=P.dataStartIndex,A=P.dataEndIndex,F=P.updateId;_.setState(Er({legendBBox:C},m({props:_.props,dataStartIndex:E,dataEndIndex:A,updateId:F},Er(Er({},_.state),{},{legendBBox:C}))))}}),ta(_,"handleReceiveSyncEvent",function(C,P,E){if(_.props.syncId===C){if(E===_.eventEmitterSymbol&&typeof _.props.syncMethod!="function")return;_.applySyncEvent(P)}}),ta(_,"handleBrushChange",function(C){var P=C.startIndex,E=C.endIndex;if(P!==_.state.dataStartIndex||E!==_.state.dataEndIndex){var A=_.state.updateId;_.setState(function(){return Er({dataStartIndex:P,dataEndIndex:E},m({props:_.props,dataStartIndex:P,dataEndIndex:E,updateId:A},_.state))}),_.triggerSyncEvent({dataStartIndex:P,dataEndIndex:E})}}),ta(_,"handleMouseEnter",function(C){var P=_.getMouseInfo(C);if(P){var E=Er(Er({},P),{},{isTooltipActive:!0});_.setState(E),_.triggerSyncEvent(E);var A=_.props.onMouseEnter;na(A)&&A(E,C)}}),ta(_,"triggeredAfterMouseMove",function(C){var P=_.getMouseInfo(C),E=P?Er(Er({},P),{},{isTooltipActive:!0}):{isTooltipActive:!1};_.setState(E),_.triggerSyncEvent(E);var A=_.props.onMouseMove;na(A)&&A(E,C)}),ta(_,"handleItemMouseEnter",function(C){_.setState(function(){return{isTooltipActive:!0,activeItem:C,activePayload:C.tooltipPayload,activeCoordinate:C.tooltipPosition||{x:C.cx,y:C.cy}}})}),ta(_,"handleItemMouseLeave",function(){_.setState(function(){return{isTooltipActive:!1}})}),ta(_,"handleMouseMove",function(C){C.persist(),_.throttleTriggeredAfterMouseMove(C)}),ta(_,"handleMouseLeave",function(C){_.throttleTriggeredAfterMouseMove.cancel();var P={isTooltipActive:!1};_.setState(P),_.triggerSyncEvent(P);var E=_.props.onMouseLeave;na(E)&&E(P,C)}),ta(_,"handleOuterEvent",function(C){var P=pSe(C),E=Tc(_.props,"".concat(P));if(P&&na(E)){var A,F;/.*touch.*/i.test(P)?F=_.getMouseInfo(C.changedTouches[0]):F=_.getMouseInfo(C),E((A=F)!==null&&A!==void 0?A:{},C)}}),ta(_,"handleClick",function(C){var P=_.getMouseInfo(C);if(P){var E=Er(Er({},P),{},{isTooltipActive:!0});_.setState(E),_.triggerSyncEvent(E);var A=_.props.onClick;na(A)&&A(E,C)}}),ta(_,"handleMouseDown",function(C){var P=_.props.onMouseDown;if(na(P)){var E=_.getMouseInfo(C);P(E,C)}}),ta(_,"handleMouseUp",function(C){var P=_.props.onMouseUp;if(na(P)){var E=_.getMouseInfo(C);P(E,C)}}),ta(_,"handleTouchMove",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.throttleTriggeredAfterMouseMove(C.changedTouches[0])}),ta(_,"handleTouchStart",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.handleMouseDown(C.changedTouches[0])}),ta(_,"handleTouchEnd",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.handleMouseUp(C.changedTouches[0])}),ta(_,"handleDoubleClick",function(C){var P=_.props.onDoubleClick;if(na(P)){var E=_.getMouseInfo(C);P(E,C)}}),ta(_,"handleContextMenu",function(C){var P=_.props.onContextMenu;if(na(P)){var E=_.getMouseInfo(C);P(E,C)}}),ta(_,"triggerSyncEvent",function(C){_.props.syncId!==void 0&&JP.emit(QP,_.props.syncId,C,_.eventEmitterSymbol)}),ta(_,"applySyncEvent",function(C){var P=_.props,E=P.layout,A=P.syncMethod,F=_.state.updateId,D=C.dataStartIndex,I=C.dataEndIndex;if(C.dataStartIndex!==void 0||C.dataEndIndex!==void 0)_.setState(Er({dataStartIndex:D,dataEndIndex:I},m({props:_.props,dataStartIndex:D,dataEndIndex:I,updateId:F},_.state)));else if(C.activeTooltipIndex!==void 0){var R=C.chartX,M=C.chartY,U=C.activeTooltipIndex,z=_.state,W=z.offset,$=z.tooltipTicks;if(!W)return;if(typeof A=="function")U=A($,C);else if(A==="value"){U=-1;for(var ee=0;ee<$.length;ee++)if($[ee].value===C.activeLabel){U=ee;break}}var ve=Er(Er({},W),{},{x:W.left,y:W.top}),_e=Math.min(R,ve.x+ve.width),K=Math.min(M,ve.y+ve.height),q=$[U]&&$[U].value,Y=fT(_.state,_.props.data,U),J=$[U]?{x:E==="horizontal"?$[U].coordinate:_e,y:E==="horizontal"?K:$[U].coordinate}:cee;_.setState(Er(Er({},C),{},{activeLabel:q,activeCoordinate:J,activePayload:Y,activeTooltipIndex:U}))}else _.setState(C)}),ta(_,"renderCursor",function(C){var P,E=_.state,A=E.isTooltipActive,F=E.activeCoordinate,D=E.activePayload,I=E.offset,R=E.activeTooltipIndex,M=E.tooltipAxisBandSize,U=_.getTooltipEventType(),z=(P=C.props.active)!==null&&P!==void 0?P:A,W=_.props.layout,$=C.key||"_recharts-cursor";return Se.createElement(C9e,{key:$,activeCoordinate:F,activePayload:D,activeTooltipIndex:R,chartName:r,element:C,isActive:z,layout:W,offset:I,tooltipAxisBandSize:M,tooltipEventType:U})}),ta(_,"renderPolarAxis",function(C,P,E){var A=Tc(C,"type.axisType"),F=Tc(_.state,"".concat(A,"Map")),D=C.type.defaultProps,I=D!==void 0?Er(Er({},D),C.props):C.props,R=F&&F[I["".concat(A,"Id")]];return p.cloneElement(C,Er(Er({},R),{},{className:ga(A,R.className),key:C.key||"".concat(P,"-").concat(E),ticks:If(R,!0)}))}),ta(_,"renderPolarGrid",function(C){var P=C.props,E=P.radialLines,A=P.polarAngles,F=P.polarRadius,D=_.state,I=D.radiusAxisMap,R=D.angleAxisMap,M=Rm(I),U=Rm(R),z=U.cx,W=U.cy,$=U.innerRadius,ee=U.outerRadius;return p.cloneElement(C,{polarAngles:Array.isArray(A)?A:If(U,!0).map(function(ve){return ve.coordinate}),polarRadius:Array.isArray(F)?F:If(M,!0).map(function(ve){return ve.coordinate}),cx:z,cy:W,innerRadius:$,outerRadius:ee,key:C.key||"polar-grid",radialLines:E})}),ta(_,"renderLegend",function(){var C=_.state.formattedGraphicalItems,P=_.props,E=P.children,A=P.width,F=P.height,D=_.props.margin||{},I=A-(D.left||0)-(D.right||0),R=LQ({children:E,formattedGraphicalItems:C,legendWidth:I,legendContent:d});if(!R)return null;var M=R.item,U=X7(R,A9e);return p.cloneElement(M,Er(Er({},U),{},{chartWidth:A,chartHeight:F,margin:D,onBBoxUpdate:_.handleLegendBBoxUpdate}))}),ta(_,"renderTooltip",function(){var C,P=_.props,E=P.children,A=P.accessibilityLayer,F=bc(E,Bl);if(!F)return null;var D=_.state,I=D.isTooltipActive,R=D.activeCoordinate,M=D.activePayload,U=D.activeLabel,z=D.offset,W=(C=F.props.active)!==null&&C!==void 0?C:I;return p.cloneElement(F,{viewBox:Er(Er({},z),{},{x:z.left,y:z.top}),active:W,label:U,payload:W?M:[],coordinate:R,accessibilityLayer:A})}),ta(_,"renderBrush",function(C){var P=_.props,E=P.margin,A=P.data,F=_.state,D=F.offset,I=F.dataStartIndex,R=F.dataEndIndex,M=F.updateId;return p.cloneElement(C,{key:C.key||"_recharts-brush",onChange:Z2(_.handleBrushChange,C.props.onChange),data:A,x:Zr(C.props.x)?C.props.x:D.left,y:Zr(C.props.y)?C.props.y:D.top+D.height+D.brushBottom-(E.bottom||0),width:Zr(C.props.width)?C.props.width:D.width,startIndex:I,endIndex:R,updateId:"brush-".concat(M)})}),ta(_,"renderReferenceElement",function(C,P,E){if(!C)return null;var A=_,F=A.clipPathId,D=_.state,I=D.xAxisMap,R=D.yAxisMap,M=D.offset,U=C.type.defaultProps||{},z=C.props,W=z.xAxisId,$=W===void 0?U.xAxisId:W,ee=z.yAxisId,ve=ee===void 0?U.yAxisId:ee;return p.cloneElement(C,{key:C.key||"".concat(P,"-").concat(E),xAxis:I[$],yAxis:R[ve],viewBox:{x:M.left,y:M.top,width:M.width,height:M.height},clipPathId:F})}),ta(_,"renderActivePoints",function(C){var P=C.item,E=C.activePoint,A=C.basePoint,F=C.childIndex,D=C.isRange,I=[],R=P.props.key,M=P.item.type.defaultProps!==void 0?Er(Er({},P.item.type.defaultProps),P.item.props):P.item.props,U=M.activeDot,z=M.dataKey,W=Er(Er({index:F,dataKey:z,cx:E.x,cy:E.y,r:4,fill:lM(P.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},Kn(U,!1)),rN(U));return I.push(x.renderActiveDot(U,W,"".concat(R,"-activePoint-").concat(F))),A?I.push(x.renderActiveDot(U,Er(Er({},W),{},{cx:A.x,cy:A.y}),"".concat(R,"-basePoint-").concat(F))):D&&I.push(null),I}),ta(_,"renderGraphicChild",function(C,P,E){var A=_.filterFormatItem(C,P,E);if(!A)return null;var F=_.getTooltipEventType(),D=_.state,I=D.isTooltipActive,R=D.tooltipAxis,M=D.activeTooltipIndex,U=D.activeLabel,z=_.props.children,W=bc(z,Bl),$=A.props,ee=$.points,ve=$.isRange,_e=$.baseLine,K=A.item.type.defaultProps!==void 0?Er(Er({},A.item.type.defaultProps),A.item.props):A.item.props,q=K.activeDot,Y=K.hide,J=K.activeBar,fe=K.activeShape,Z=!!(!Y&&I&&W&&(q||J||fe)),ce={};F!=="axis"&&W&&W.props.trigger==="click"?ce={onClick:Z2(_.handleItemMouseEnter,C.props.onClick)}:F!=="axis"&&(ce={onMouseLeave:Z2(_.handleItemMouseLeave,C.props.onMouseLeave),onMouseEnter:Z2(_.handleItemMouseEnter,C.props.onMouseEnter)});var le=p.cloneElement(C,Er(Er({},A.props),ce));function ie(Qe){return typeof R.dataKey=="function"?R.dataKey(Qe.payload):null}if(Z)if(M>=0){var te,ue;if(R.dataKey&&!R.allowDuplicatedCategory){var Te=typeof R.dataKey=="function"?ie:"payload.".concat(R.dataKey.toString());te=tN(ee,Te,U),ue=ve&&_e&&tN(_e,Te,U)}else te=ee?.[M],ue=ve&&_e&&_e[M];if(fe||J){var ne=C.props.activeIndex!==void 0?C.props.activeIndex:M;return[p.cloneElement(C,Er(Er(Er({},A.props),ce),{},{activeIndex:ne})),null,null]}if(!fa(te))return[le].concat(Yx(_.renderActivePoints({item:A,activePoint:te,basePoint:ue,childIndex:M,isRange:ve})))}else{var de,lt=(de=_.getItemByXY(_.state.activeCoordinate))!==null&&de!==void 0?de:{graphicalItem:le},Nt=lt.graphicalItem,at=Nt.item,gt=at===void 0?C:at,Pt=Nt.childIndex,yt=Er(Er(Er({},A.props),ce),{},{activeIndex:Pt});return[p.cloneElement(gt,yt),null,null]}return ve?[le,null,null]:[le,null]}),ta(_,"renderCustomized",function(C,P,E){return p.cloneElement(C,Er(Er({key:"recharts-customized-".concat(E)},_.props),_.state))}),ta(_,"renderMap",{CartesianGrid:{handler:aj,once:!0},ReferenceArea:{handler:_.renderReferenceElement},ReferenceLine:{handler:aj},ReferenceDot:{handler:_.renderReferenceElement},XAxis:{handler:aj},YAxis:{handler:aj},Brush:{handler:_.renderBrush,once:!0},Bar:{handler:_.renderGraphicChild},Line:{handler:_.renderGraphicChild},Area:{handler:_.renderGraphicChild},Radar:{handler:_.renderGraphicChild},RadialBar:{handler:_.renderGraphicChild},Scatter:{handler:_.renderGraphicChild},Pie:{handler:_.renderGraphicChild},Funnel:{handler:_.renderGraphicChild},Tooltip:{handler:_.renderCursor,once:!0},PolarGrid:{handler:_.renderPolarGrid,once:!0},PolarAngleAxis:{handler:_.renderPolarAxis},PolarRadiusAxis:{handler:_.renderPolarAxis},Customized:{handler:_.renderCustomized}}),_.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:Cg("recharts"),"-clip"),_.throttleTriggeredAfterMouseMove=RJ(_.triggeredAfterMouseMove,(j=b.throttleDelay)!==null&&j!==void 0?j:1e3/60),_.state={},_}return F9e(x,y),D9e(x,[{key:"componentDidMount",value:function(){var w,j;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var w=this.props,j=w.children,_=w.data,C=w.height,P=w.layout,E=bc(j,Bl);if(E){var A=E.props.defaultIndex;if(!(typeof A!="number"||A<0||A>this.state.tooltipTicks.length-1)){var F=this.state.tooltipTicks[A]&&this.state.tooltipTicks[A].value,D=fT(this.state,_,A,F),I=this.state.tooltipTicks[A].coordinate,R=(this.state.offset.top+C)/2,M=P==="horizontal",U=M?{x:I,y:R}:{y:I,x:R},z=this.state.formattedGraphicalItems.find(function($){var ee=$.item;return ee.type.name==="Scatter"});z&&(U=Er(Er({},U),z.props.points[A].tooltipPosition),D=z.props.points[A].tooltipPayload);var W={activeTooltipIndex:A,isTooltipActive:!0,activeLabel:F,activePayload:D,activeCoordinate:U};this.setState(W),this.renderCursor(E),this.accessibilityManager.setIndex(A)}}}},{key:"getSnapshotBeforeUpdate",value:function(w,j){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==j.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==w.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==w.margin){var _,C;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0}})}return null}},{key:"componentDidUpdate",value:function(w){BI([bc(w.children,Bl)],[bc(this.props.children,Bl)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var w=bc(this.props.children,Bl);if(w&&typeof w.props.shared=="boolean"){var j=w.props.shared?"axis":"item";return l.indexOf(j)>=0?j:o}return o}},{key:"getMouseInfo",value:function(w){if(!this.container)return null;var j=this.container,_=j.getBoundingClientRect(),C=$3e(_),P={chartX:Math.round(w.pageX-C.left),chartY:Math.round(w.pageY-C.top)},E=_.width/j.offsetWidth||1,A=this.inRange(P.chartX,P.chartY,E);if(!A)return null;var F=this.state,D=F.xAxisMap,I=F.yAxisMap,R=this.getTooltipEventType(),M=Q7(this.state,this.props.data,this.props.layout,A);if(R!=="axis"&&D&&I){var U=Rm(D).scale,z=Rm(I).scale,W=U&&U.invert?U.invert(P.chartX):null,$=z&&z.invert?z.invert(P.chartY):null;return Er(Er({},P),{},{xValue:W,yValue:$},M)}return M?Er(Er({},P),M):null}},{key:"inRange",value:function(w,j){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=this.props.layout,P=w/_,E=j/_;if(C==="horizontal"||C==="vertical"){var A=this.state.offset,F=P>=A.left&&P<=A.left+A.width&&E>=A.top&&E<=A.top+A.height;return F?{x:P,y:E}:null}var D=this.state,I=D.angleAxisMap,R=D.radiusAxisMap;if(I&&R){var M=Rm(I);return mq({x:P,y:E},M)}return null}},{key:"parseEventsOfWrapper",value:function(){var w=this.props.children,j=this.getTooltipEventType(),_=bc(w,Bl),C={};_&&j==="axis"&&(_.props.trigger==="click"?C={onClick:this.handleClick}:C={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var P=rN(this.props,this.handleOuterEvent);return Er(Er({},P),C)}},{key:"addListener",value:function(){JP.on(QP,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){JP.removeListener(QP,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(w,j,_){for(var C=this.state.formattedGraphicalItems,P=0,E=C.length;P<E;P++){var A=C[P];if(A.item===w||A.props.key===w.key||j===Rf(A.item.type)&&_===A.childIndex)return A}return null}},{key:"renderClipPath",value:function(){var w=this.clipPathId,j=this.state.offset,_=j.left,C=j.top,P=j.height,E=j.width;return Se.createElement("defs",null,Se.createElement("clipPath",{id:w},Se.createElement("rect",{x:_,y:C,height:P,width:E})))}},{key:"getXScales",value:function(){var w=this.state.xAxisMap;return w?Object.entries(w).reduce(function(j,_){var C=K7(_,2),P=C[0],E=C[1];return Er(Er({},j),{},ta({},P,E.scale))},{}):null}},{key:"getYScales",value:function(){var w=this.state.yAxisMap;return w?Object.entries(w).reduce(function(j,_){var C=K7(_,2),P=C[0],E=C[1];return Er(Er({},j),{},ta({},P,E.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(w){var j;return(j=this.state.xAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getYScaleByAxisId",value:function(w){var j;return(j=this.state.yAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getItemByXY",value:function(w){var j=this.state,_=j.formattedGraphicalItems,C=j.activeItem;if(_&&_.length)for(var P=0,E=_.length;P<E;P++){var A=_[P],F=A.props,D=A.item,I=D.type.defaultProps!==void 0?Er(Er({},D.type.defaultProps),D.props):D.props,R=Rf(D.type);if(R==="Bar"){var M=(F.data||[]).find(function($){return b6e(w,$)});if(M)return{graphicalItem:A,payload:M}}else if(R==="RadialBar"){var U=(F.data||[]).find(function($){return mq(w,$)});if(U)return{graphicalItem:A,payload:U}}else if(m5(A,C)||h5(A,C)||Ew(A,C)){var z=lBe({graphicalItem:A,activeTooltipItem:C,itemData:I.data}),W=I.activeIndex===void 0?z:I.activeIndex;return{graphicalItem:Er(Er({},A),{},{childIndex:W}),payload:Ew(A,C)?I.data[z]:A.props.data[z]}}}return null}},{key:"render",value:function(){var w=this;if(!e8(this))return null;var j=this.props,_=j.children,C=j.className,P=j.width,E=j.height,A=j.style,F=j.compact,D=j.title,I=j.desc,R=X7(j,P9e),M=Kn(R,!1);if(F)return Se.createElement(j7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Se.createElement(zI,Bv({},M,{width:P,height:E,title:D,desc:I}),this.renderClipPath(),r8(_,this.renderMap)));if(this.props.accessibilityLayer){var U,z;M.tabIndex=(U=this.props.tabIndex)!==null&&U!==void 0?U:0,M.role=(z=this.props.role)!==null&&z!==void 0?z:"application",M.onKeyDown=function($){w.accessibilityManager.keyboardEvent($)},M.onFocus=function(){w.accessibilityManager.focus()}}var W=this.parseEventsOfWrapper();return Se.createElement(j7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Se.createElement("div",Bv({className:ga("recharts-wrapper",C),style:Er({position:"relative",cursor:"default",width:P,height:E},A)},W,{ref:function(ee){w.container=ee}}),Se.createElement(zI,Bv({},M,{width:P,height:E,title:D,desc:I,style:V9e}),this.renderClipPath(),r8(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(p.Component);ta(v,"displayName",r),ta(v,"defaultProps",Er({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),ta(v,"getDerivedStateFromProps",function(y,x){var b=y.dataKey,w=y.data,j=y.children,_=y.width,C=y.height,P=y.layout,E=y.stackOffset,A=y.margin,F=x.dataStartIndex,D=x.dataEndIndex;if(x.updateId===void 0){var I=Z7(y);return Er(Er(Er({},I),{},{updateId:0},m(Er(Er({props:y},I),{},{updateId:0}),x)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:C,prevLayout:P,prevStackOffset:E,prevMargin:A,prevChildren:j})}if(b!==x.prevDataKey||w!==x.prevData||_!==x.prevWidth||C!==x.prevHeight||P!==x.prevLayout||E!==x.prevStackOffset||!tx(A,x.prevMargin)){var R=Z7(y),M={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},U=Er(Er({},Q7(x,w,P)),{},{updateId:x.updateId+1}),z=Er(Er(Er({},R),M),U);return Er(Er(Er({},z),m(Er({props:y},z),x)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:C,prevLayout:P,prevStackOffset:E,prevMargin:A,prevChildren:j})}if(!BI(j,x.prevChildren)){var W,$,ee,ve,_e=bc(j,$x),K=_e&&(W=($=_e.props)===null||$===void 0?void 0:$.startIndex)!==null&&W!==void 0?W:F,q=_e&&(ee=(ve=_e.props)===null||ve===void 0?void 0:ve.endIndex)!==null&&ee!==void 0?ee:D,Y=K!==F||q!==D,J=!fa(w),fe=J&&!Y?x.updateId:x.updateId+1;return Er(Er({updateId:fe},m(Er(Er({props:y},x),{},{updateId:fe,dataStartIndex:K,dataEndIndex:q}),x)),{},{prevChildren:j,dataStartIndex:K,dataEndIndex:q})}return null}),ta(v,"renderActiveDot",function(y,x,b){var w;return p.isValidElement(y)?w=p.cloneElement(y,x):na(y)?w=y(x):w=Se.createElement(N1,x),Se.createElement(Ta,{className:"recharts-active-dot",key:b},w)});var g=p.forwardRef(function(x,b){return Se.createElement(v,Bv({},x,{ref:b}))});return g.displayName=v.displayName,g},uee=w5({chartName:"LineChart",GraphicalChild:k0,axisComponents:[{axisType:"xAxis",AxisComp:Eh},{axisType:"yAxis",AxisComp:kh}],formatAxisMap:uM}),eUe=w5({chartName:"BarChart",GraphicalChild:kg,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Eh},{axisType:"yAxis",AxisComp:kh}],formatAxisMap:uM}),tUe=w5({chartName:"PieChart",GraphicalChild:Zu,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:f5},{axisType:"radiusAxis",AxisComp:d5}],formatAxisMap:MLe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),rUe=w5({chartName:"AreaChart",GraphicalChild:Vh,axisComponents:[{axisType:"xAxis",AxisComp:Eh},{axisType:"yAxis",AxisComp:kh}],formatAxisMap:uM});const tz=({icon:e,title:t,value:r,trend:n,trendValue:s,color:o,className:i,loading:l})=>{const c=n==="up"?i4:hue,d=n==="up"?"text-success":"text-danger";return a.jsx(jr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col justify-between ${i}`,children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10",style:{color:`var(--${o})`},children:a.jsx(e,{className:"h-5 w-5"})}),!l&&n&&s&&a.jsxs("div",{className:`flex items-center text-xs font-bold ${d}`,children:[a.jsx(c,{className:"w-3.5 h-3.5 mr-1"}),a.jsx("span",{children:s})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-2",children:t}),l?a.jsx("div",{className:"h-9 bg-white/5 rounded animate-pulse"}):a.jsx("p",{className:"text-3xl font-bold text-text-primary tabular-nums tracking-tight",children:r})]})]})})},nUe=({alerts:e,className:t})=>{const r=Ri(),[n,s]=p.useState(!1),o=u=>({Package:Sd,DollarSign:Ko,CalendarCheck:tC,Clock:yd,ShoppingCart:i1,Store:f4,Users:yl,CalendarPlus:d4,AlertTriangle:zf,Info:$H})[u]||zf,i=u=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[u]||"text-warning",l=e.length>2?e.slice(0,2):e,c=e.length>2,d=({alert:u,onClick:f})=>{const h=o(u.icone),m=i(u.cor);return a.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:f,children:[a.jsx(h,{className:`w-4 h-4 flex-shrink-0 ${m}`}),a.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:u.mensagem}),u.link&&a.jsx(i4,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})};return a.jsxs(a.Fragment,{children:[a.jsxs(jr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card ${t||""}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h2",{className:"text-lg font-bold text-text-primary flex items-center",children:[a.jsx(Vy,{className:"mr-2 h-5 w-5 text-brand"})," Alertas do Dia"]}),c&&a.jsx(me,{variant:"ghost",size:"sm",className:"text-xs text-brand hover:text-brand/80",onClick:()=>s(!0),children:"Ver todos"})]}),e.length===0?a.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum alerta no momento! "}):a.jsx("ul",{className:"space-y-2 text-sm",children:l.map((u,f)=>a.jsx(d,{alert:u,onClick:()=>u.link&&r(u.link)},f))})]}),a.jsx(xn,{open:n,onOpenChange:s,children:a.jsxs(vn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[a.jsx(pn,{children:a.jsxs(un,{className:"flex items-center gap-2",children:[a.jsx(Vy,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",e.length,")"]})}),a.jsx("div",{className:"mt-4",children:e.length===0?a.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):a.jsx("ul",{className:"space-y-2 text-sm",children:e.map((u,f)=>a.jsx(d,{alert:u,onClick:()=>{u.link&&(r(u.link),s(!1))}},f))})})]})})]})},aUe=({title:e,icon:t,data:r,color:n,className:s,loading:o})=>{const i=r.reduce((d,u)=>d+(u.receita||0),0),l=r.reduce((d,u)=>d+(u.despesa||0),0),c=i-l;return a.jsxs(jr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group ${s||""}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:a.jsx(t,{className:"h-5 w-5"})}),a.jsx("h3",{className:"text-base font-bold text-text-primary flex-1",children:e}),a.jsx("div",{className:"text-xs font-semibold text-text-muted",children:"ltimos 14 dias"})]}),a.jsx("div",{className:"mb-2",children:a.jsx(eb,{width:"100%",height:90,children:a.jsxs(rUe,{data:r,margin:{top:4,right:0,left:0,bottom:0},children:[a.jsx(Bl,{cursor:{stroke:"var(--border)",strokeDasharray:"3 3"},contentStyle:{background:"rgba(10, 10, 10, 0.85)",borderColor:"var(--border)",color:"var(--text-primary)",borderRadius:"var(--radius-sm)"},formatter:(d,u)=>u==="saldo"?[`R$ ${d.toLocaleString("pt-BR")}`,"Saldo"]:d,labelFormatter:d=>d}),a.jsx(Vh,{type:"monotone",dataKey:"saldo",stroke:"var(--brand)",strokeWidth:2,fill:"var(--brand)",fillOpacity:.15})]})})}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary",children:"Receita"}),o?a.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):a.jsxs("p",{className:"font-bold text-success tabular-nums",children:["R$ ",i.toLocaleString("pt-BR")]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary",children:"Despesa"}),o?a.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):a.jsxs("p",{className:"font-bold text-danger tabular-nums",children:["R$ ",l.toLocaleString("pt-BR")]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary",children:"Saldo"}),o?a.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):a.jsxs("p",{className:"font-bold text-text-primary tabular-nums",children:["R$ ",c.toLocaleString("pt-BR")]})]})]})]})},sUe=({title:e,icon:t,data:r,color:n,className:s,loading:o})=>a.jsxs(jr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col ${s||""}`,children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:a.jsx(t,{className:"h-5 w-5"})}),a.jsx("h3",{className:"text-base font-bold text-text-primary",children:e})]}),a.jsx("div",{className:"space-y-3 mt-auto",children:o?Array.from({length:3}).map((i,l)=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("div",{className:"h-4 w-24 bg-white/5 rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-12 bg-white/5 rounded animate-pulse"})]},l)):r.map((i,l)=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:i.name}),a.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:i.value})]},l))})]}),oUe={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.1,delayChildren:.2}}},eE={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}};function iUe(){const{toast:e}=as(),{userProfile:t}=vs(),n=PC()?.alerts||[],s=Ri(),[o,i]=p.useState(!0),[l,c]=p.useState(0),[d,u]=p.useState({finalizados:0,total:0}),[f,h]=p.useState(0),[m,v]=p.useState(0),[g,y]=p.useState(0),[x,b]=p.useState(0),[w,j]=p.useState(0),[_,C]=p.useState(0),[P,E]=p.useState([]);p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa){console.log("[DashboardPage] Aguardando autenticao..."),i(!1);return}console.log("[DashboardPage] Iniciando carregamento de dados...");try{i(!0);const I=t.codigo_empresa,R=new Date,M=Es(R).toISOString(),U=Xj(R).toISOString();console.log("[Dashboard] 1. Buscando pagamentos...");const{data:z}=await he.from("pagamentos").select("valor, status").eq("codigo_empresa",I).gte("recebido_em",M).lte("recebido_em",U);console.log("[Dashboard]  Pagamentos carregados:",z?.length||0);const W=(z||[]).filter(ge=>!["Cancelado","Estornado"].includes(ge.status)).reduce((ge,rt)=>ge+Number(rt.valor||0),0);console.log("[Dashboard] 2. Buscando agendamentos de hoje...");const{data:$}=await he.from("agendamentos").select("id").eq("codigo_empresa",I).gte("inicio",M).lte("inicio",U);console.log("[Dashboard]  Agendamentos de hoje:",$?.length||0);let ee=0;if($&&$.length>0){console.log("[Dashboard] 3. Buscando participantes pagos...");const ge=$.map(pt=>pt.id),{data:rt}=await he.from("agendamento_participantes").select("valor_cota, status_pagamento, aplicar_taxa, finalizadora_id, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",I).in("agendamento_id",ge).eq("status_pagamento","Pago");console.log("[Dashboard]  Participantes pagos:",rt?.length||0),ee=(rt||[]).reduce((pt,We)=>{let Ze=Number(We.valor_cota||0);if(We.aplicar_taxa===!0){const Ne=Number(We.finalizadoras?.taxa_percentual||0);Ne>0&&(Ze=Ze/(1+Ne/100))}return pt+Ze},0)}const ve=W+ee;c(ve),console.log("[Dashboard] 4. Buscando agendamentos completos...");const{data:_e}=await he.from("agendamentos").select("id, status, inicio, fim").eq("codigo_empresa",I).gte("inicio",M).lte("inicio",U);console.log("[Dashboard]  Agendamentos completos:",_e?.length||0);const K=(_e||[]).filter(ge=>ge.status==="finished").length;u({finalizados:K,total:_e?.length||0});const q=new Date().toISOString(),Y=(_e||[]).filter(ge=>ge.inicio>q&&!["canceled","finished"].includes(ge.status)).length;h(Y);const J=(_e||[]).filter(ge=>ge.status==="in_progress").length;v(J),console.log("[Dashboard] 5. Buscando quadras...");const{data:fe}=await he.from("quadras").select("id").eq("codigo_empresa",I);console.log("[Dashboard]  Quadras:",fe?.length||0);const le=(fe?.length||0)*17;let ie=0;for(const ge of _e||[])if(!["canceled","no_show"].includes(ge.status))if(ge.inicio&&ge.fim){const rt=new Date(ge.inicio),Ze=(new Date(ge.fim)-rt)/(1e3*60*60);ie+=Ze}else ie+=1;const te=le>0?Math.round(ie/le*100):0;y(te),console.log("[Dashboard] 6. Buscando comandas abertas...");const{data:ue}=await he.from("comandas").select("id").eq("codigo_empresa",I).eq("status","open");console.log("[Dashboard]  Comandas abertas:",ue?.length||0),b(ue?.length||0),console.log("[Dashboard] 7. Buscando mesas...");const{data:Te}=await he.from("mesas").select("id, status").eq("codigo_empresa",I);console.log("[Dashboard]  Mesas:",Te?.length||0);const ne=(Te||[]).filter(ge=>["in-use","awaiting-payment"].includes(ge.status)).length;j(ne),console.log("[Dashboard] 8. Buscando vendas da loja...");const{data:de}=await he.from("comandas").select("id").eq("codigo_empresa",I).eq("status","closed").gte("fechado_em",M).lte("fechado_em",U);console.log("[Dashboard]  Vendas da loja:",de?.length||0),C(de?.length||0),console.log("[Dashboard] 9. Buscando dados dos ltimos 14 dias...");const lt=new Date;lt.setDate(lt.getDate()-13);const Nt=Es(lt).toISOString(),at=Xj(R).toISOString(),{data:gt}=await he.from("pagamentos").select("valor, status, recebido_em").eq("codigo_empresa",I).gte("recebido_em",Nt).lte("recebido_em",at);console.log("[Dashboard]  Pagamentos 14 dias:",gt?.length||0);const{data:Pt}=await he.from("agendamentos").select("id, inicio").eq("codigo_empresa",I).gte("inicio",Nt).lte("inicio",at);console.log("[Dashboard]  Agendamentos 14 dias:",Pt?.length||0);let yt=[];if(Pt&&Pt.length>0){const ge=Pt.map(pt=>pt.id),{data:rt}=await he.from("agendamento_participantes").select("valor_cota, agendamento_id").eq("codigo_empresa",I).in("agendamento_id",ge).eq("status_pagamento","Pago");yt=rt||[],console.log("[Dashboard]  Participantes pagos 14 dias:",yt.length)}const Qe=[];for(let ge=13;ge>=0;ge--){const rt=new Date;rt.setDate(rt.getDate()-ge);const pt=Es(rt),We=Xj(rt),Ze=(gt||[]).filter(mt=>{const Ft=new Date(mt.recebido_em);return Ft>=pt&&Ft<=We&&!["Cancelado","Estornado"].includes(mt.status)}).reduce((mt,Ft)=>mt+Number(Ft.valor||0),0),Ne=(Pt||[]).filter(mt=>{const Ft=new Date(mt.inicio);return Ft>=pt&&Ft<=We}).map(mt=>mt.id),ye=yt.filter(mt=>Ne.includes(mt.agendamento_id)).reduce((mt,Ft)=>mt+Number(Ft.valor_cota||0),0),Be=Ze+ye;Qe.push({name:ge===0?"Hoje":`${ge}d`,saldo:Math.round(Be),receita:Math.round(Be),despesa:0})}console.log("[Dashboard]  Dados de 14 dias carregados"),E(Qe)}catch(I){console.error("[DashboardPage]  Erro ao carregar dashboard:",I),e({title:"Erro ao carregar dashboard",description:I?.message||"Tente recarregar a pgina",variant:"destructive"})}finally{console.log("[DashboardPage]  Carregamento concludo"),i(!1)}})()},[t?.codigo_empresa]);const A=D=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(D||0)),F=[{name:"Comandas Abertas",value:x},{name:"Mesas Ocupadas",value:w},{name:"Vendas Hoje",value:_}];return a.jsx(a.Fragment,{children:a.jsxs(jr.div,{variants:oUe,initial:"hidden",animate:"visible",className:"space-y-4",children:[a.jsxs(jr.div,{variants:eE,className:"relative grid grid-cols-1 xl:grid-cols-12 gap-4 items-start",children:[a.jsx("div",{className:"xl:col-span-8",children:a.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm relative p-4 rounded-xl border border-white/10 overflow-hidden shadow-1",children:[a.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.03] mix-blend-overlay"}),a.jsxs("div",{className:"relative z-10 max-w-[720px]",children:[a.jsxs("h1",{className:"text-3xl font-black mb-2 text-text-primary tracking-tighter",children:["Bem-vindo de volta, ",a.jsxs("span",{className:"text-brand",children:[(t?.nome_exibicao||t?.nome||t?.email?.split("@")[0]||"Admin").split(" ")[0],"!"]})]}),a.jsx("p",{className:"text-text-secondary mb-3 max-w-[60ch] text-sm md:text-base font-normal",children:"Sua central de comando para uma gesto de sucesso. Monitore agendamentos, faturamento e clientes em um s lugar."}),a.jsxs("div",{className:"flex flex-wrap gap-2.5",children:[a.jsxs(me,{onClick:()=>s("/agenda",{state:{openModal:!0}}),size:"default",children:[a.jsx(d4,{className:"mr-2 h-4 w-4"}),"+ Agendamento"]}),a.jsxs(me,{onClick:()=>s("/clientes",{state:{openModal:!0}}),variant:"outline",size:"default",children:[a.jsx(yl,{className:"mr-2 h-4 w-4"}),"Adicionar Cliente"]})]})]})]})}),a.jsx("div",{className:"xl:col-span-4",children:a.jsxs("div",{className:"fx-card",children:[a.jsxs("h2",{className:"text-lg font-bold text-text-primary mb-3 flex items-center",children:[a.jsx(yd,{className:"mr-2 h-5 w-5 text-brand"})," Resumo do Dia"]}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Prximas Reservas"}),o?a.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):a.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:f})]}),a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Quadras em Uso"}),o?a.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):a.jsx("span",{className:"font-bold text-success tabular-nums",children:m})]}),a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Taxa de Ocupao"}),o?a.jsx("div",{className:"h-6 w-16 bg-white/5 rounded animate-pulse"}):a.jsxs("span",{className:`font-bold tabular-nums ${g>=70?"text-success":g>=40?"text-warning":"text-danger"}`,children:[g,"%"]})]})]})]})})]}),a.jsxs(jr.div,{variants:eE,className:"relative grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-12 gap-4 items-stretch",children:[a.jsx("div",{className:"xl:col-span-3",children:a.jsx(tz,{icon:Ko,title:"Faturamento do Dia",value:A(l),color:"success",className:"h-full",loading:o})}),a.jsx("div",{className:"xl:col-span-3",children:a.jsx(tz,{icon:tC,title:"Agend. Finalizados",value:`${d.finalizados} de ${d.total}`,color:"info",className:"h-full",loading:o})}),a.jsx("div",{className:"xl:col-span-3",children:a.jsx(nUe,{className:"h-full",alerts:n})}),a.jsx("div",{className:"xl:col-span-3",children:a.jsx(sUe,{icon:f4,title:"Informaes da Loja",data:F,color:"purple",className:"h-full",loading:o})})]}),a.jsx(jr.div,{variants:eE,className:"grid grid-cols-1 gap-4",children:a.jsx(aUe,{icon:Vf,title:"Resumo Financeiro",data:P,color:"brand",loading:o})})]})})}var lUe={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},cUe=function(t,r,n){var s,o=lUe[t];return typeof o=="string"?s=o:r===1?s=o.one:s=o.other.replace("{{count}}",String(r)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"em "+s:"h "+s:s};const dUe=cUe;var uUe={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},fUe={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},mUe={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hUe={date:ex({formats:uUe,defaultWidth:"full"}),time:ex({formats:fUe,defaultWidth:"full"}),dateTime:ex({formats:mUe,defaultWidth:"full"})};const pUe=hUe;var gUe={lastWeek:function(t){var r=t.getUTCDay(),n=r===0||r===6?"ltimo":"ltima";return"'"+n+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},vUe=function(t,r,n,s){var o=gUe[t];return typeof o=="function"?o(r):o};const xUe=vUe;var yUe={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},bUe={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},wUe={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},jUe={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},_Ue={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},NUe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},SUe=function(t,r){var n=Number(t);return r?.unit==="week"?n+"":n+""},CUe={ordinalNumber:SUe,era:Iu({values:yUe,defaultWidth:"wide"}),quarter:Iu({values:bUe,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Iu({values:wUe,defaultWidth:"wide"}),day:Iu({values:jUe,defaultWidth:"wide"}),dayPeriod:Iu({values:_Ue,defaultWidth:"wide",formattingValues:NUe,defaultFormattingWidth:"wide"})};const AUe=CUe;var PUe=/^(\d+)[o]?/i,EUe=/\d+/i,kUe={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},IUe={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},OUe={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},TUe={any:[/1/i,/2/i,/3/i,/4/i]},DUe={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},MUe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},RUe={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},LUe={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},FUe={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},$Ue={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},BUe={ordinalNumber:dY({matchPattern:PUe,parsePattern:EUe,valueCallback:function(t){return parseInt(t,10)}}),era:Ou({matchPatterns:kUe,defaultMatchWidth:"wide",parsePatterns:IUe,defaultParseWidth:"any"}),quarter:Ou({matchPatterns:OUe,defaultMatchWidth:"wide",parsePatterns:TUe,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Ou({matchPatterns:DUe,defaultMatchWidth:"wide",parsePatterns:MUe,defaultParseWidth:"any"}),day:Ou({matchPatterns:RUe,defaultMatchWidth:"wide",parsePatterns:LUe,defaultParseWidth:"any"}),dayPeriod:Ou({matchPatterns:FUe,defaultMatchWidth:"any",parsePatterns:$Ue,defaultParseWidth:"any"})};const qUe=BUe;var zUe={code:"pt-BR",formatDistance:dUe,formatLong:pUe,formatRelative:xUe,localize:AUe,match:qUe,options:{weekStartsOn:0,firstWeekContainsDate:1}};const la=zUe;var ca=function(){return ca=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},ca.apply(this,arguments)};function UUe(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function fee(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,o;n<s;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function S1(e){return e.mode==="multiple"}function C1(e){return e.mode==="range"}function j5(e){return e.mode==="single"}var VUe={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function WUe(e,t){return ur(e,"LLLL y",t)}function HUe(e,t){return ur(e,"d",t)}function GUe(e,t){return ur(e,"LLLL",t)}function KUe(e){return"".concat(e)}function XUe(e,t){return ur(e,"cccccc",t)}function YUe(e,t){return ur(e,"yyyy",t)}var JUe=Object.freeze({__proto__:null,formatCaption:WUe,formatDay:HUe,formatMonthCaption:GUe,formatWeekNumber:KUe,formatWeekdayName:XUe,formatYearCaption:YUe}),QUe=function(e,t,r){return ur(e,"do MMMM (EEEE)",r)},ZUe=function(){return"Month: "},eVe=function(){return"Go to next month"},tVe=function(){return"Go to previous month"},rVe=function(e,t){return ur(e,"cccc",t)},nVe=function(e){return"Week n. ".concat(e)},aVe=function(){return"Year: "},sVe=Object.freeze({__proto__:null,labelDay:QUe,labelMonthDropdown:ZUe,labelNext:eVe,labelPrevious:tVe,labelWeekNumber:nVe,labelWeekday:rVe,labelYearDropdown:aVe});function oVe(){var e="buttons",t=VUe,r=uY,n={},s={},o=1,i={},l=new Date;return{captionLayout:e,classNames:t,formatters:JUe,labels:sVe,locale:r,modifiersClassNames:n,modifiers:s,numberOfMonths:o,styles:i,today:l,mode:"default"}}function iVe(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,s=e.toMonth,o=e.fromDate,i=e.toDate;return n?o=Sl(n):t&&(o=new Date(t,0,1)),s?i=AC(s):r&&(i=new Date(r,11,31)),{fromDate:o?Es(o):void 0,toDate:i?Es(i):void 0}}var mee=p.createContext(void 0);function lVe(e){var t,r=e.initialProps,n=oVe(),s=iVe(r),o=s.fromDate,i=s.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;l!=="buttons"&&(!o||!i)&&(l="buttons");var c;(j5(r)||S1(r)||C1(r))&&(c=r.onSelect);var d=ca(ca(ca({},n),r),{captionLayout:l,classNames:ca(ca({},n.classNames),r.classNames),components:ca({},r.components),formatters:ca(ca({},n.formatters),r.formatters),fromDate:o,labels:ca(ca({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:ca(ca({},n.modifiers),r.modifiers),modifiersClassNames:ca(ca({},n.modifiersClassNames),r.modifiersClassNames),onSelect:c,styles:ca(ca({},n.styles),r.styles),toDate:i});return a.jsx(mee.Provider,{value:d,children:e.children})}function Ds(){var e=p.useContext(mee);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function hee(e){var t=Ds(),r=t.locale,n=t.classNames,s=t.styles,o=t.formatters.formatCaption;return a.jsx("div",{className:n.caption_label,style:s.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:o(e.displayMonth,{locale:r})})}function cVe(e){return a.jsx("svg",ca({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:a.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function pee(e){var t,r,n=e.onChange,s=e.value,o=e.children,i=e.caption,l=e.className,c=e.style,d=Ds(),u=(r=(t=d.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:cVe;return a.jsxs("div",{className:l,style:c,children:[a.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),a.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:s,onChange:n,children:o}),a.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[i,a.jsx(u,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function dVe(e){var t,r=Ds(),n=r.fromDate,s=r.toDate,o=r.styles,i=r.locale,l=r.formatters.formatMonthCaption,c=r.classNames,d=r.components,u=r.labels.labelMonthDropdown;if(!n)return a.jsx(a.Fragment,{});if(!s)return a.jsx(a.Fragment,{});var f=[];if(J1e(n,s))for(var h=Sl(n),m=n.getMonth();m<=s.getMonth();m++)f.push(NP(h,m));else for(var h=Sl(new Date),m=0;m<=11;m++)f.push(NP(h,m));var v=function(y){var x=Number(y.target.value),b=NP(Sl(e.displayMonth),x);e.onChange(b)},g=(t=d?.Dropdown)!==null&&t!==void 0?t:pee;return a.jsx(g,{name:"months","aria-label":u(),className:c.dropdown_month,style:o.dropdown_month,onChange:v,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:i}),children:f.map(function(y){return a.jsx("option",{value:y.getMonth(),children:l(y,{locale:i})},y.getMonth())})})}function uVe(e){var t,r=e.displayMonth,n=Ds(),s=n.fromDate,o=n.toDate,i=n.locale,l=n.styles,c=n.classNames,d=n.components,u=n.formatters.formatYearCaption,f=n.labels.labelYearDropdown,h=[];if(!s)return a.jsx(a.Fragment,{});if(!o)return a.jsx(a.Fragment,{});for(var m=s.getFullYear(),v=o.getFullYear(),g=m;g<=v;g++)h.push($6(Awe(new Date),g));var y=function(b){var w=$6(Sl(r),Number(b.target.value));e.onChange(w)},x=(t=d?.Dropdown)!==null&&t!==void 0?t:pee;return a.jsx(x,{name:"years","aria-label":f(),className:c.dropdown_year,style:l.dropdown_year,onChange:y,value:r.getFullYear(),caption:u(r,{locale:i}),children:h.map(function(b){return a.jsx("option",{value:b.getFullYear(),children:u(b,{locale:i})},b.getFullYear())})})}function fVe(e,t){var r=p.useState(e),n=r[0],s=r[1],o=t===void 0?n:t;return[o,s]}function mVe(e){var t=e.month,r=e.defaultMonth,n=e.today,s=t||r||n||new Date,o=e.toDate,i=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(o&&Zb(o,s)<0){var d=-1*(c-1);s=uu(o,d)}return i&&Zb(s,i)<0&&(s=i),Sl(s)}function hVe(){var e=Ds(),t=mVe(e),r=fVe(t,e.month),n=r[0],s=r[1],o=function(i){var l;if(!e.disableNavigation){var c=Sl(i);s(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[n,o]}function pVe(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,s=Sl(e),o=Sl(uu(s,n)),i=Zb(o,s),l=[],c=0;c<i;c++){var d=uu(s,c);l.push(d)}return r&&(l=l.reverse()),l}function gVe(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,s=t.numberOfMonths,o=s===void 0?1:s,i=n?o:1,l=Sl(e);if(!r)return uu(l,i);var c=Zb(r,e);if(!(c<o))return uu(l,i)}}function vVe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,s=t.numberOfMonths,o=s===void 0?1:s,i=n?o:1,l=Sl(e);if(!r)return uu(l,-i);var c=Zb(l,r);if(!(c<=0))return uu(l,-i)}}var gee=p.createContext(void 0);function xVe(e){var t=Ds(),r=hVe(),n=r[0],s=r[1],o=pVe(n,t),i=gVe(n,t),l=vVe(n,t),c=function(f){return o.some(function(h){return fD(f,h)})},d=function(f,h){c(f)||(h&&fY(f,h)?s(uu(f,1+t.numberOfMonths*-1)):s(f))},u={currentMonth:n,displayMonths:o,goToMonth:s,goToDate:d,previousMonth:l,nextMonth:i,isDateDisplayed:c};return a.jsx(gee.Provider,{value:u,children:e.children})}function A1(){var e=p.useContext(gee);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function rz(e){var t,r=Ds(),n=r.classNames,s=r.styles,o=r.components,i=A1().goToMonth,l=function(u){i(uu(u,e.displayIndex?-e.displayIndex:0))},c=(t=o?.CaptionLabel)!==null&&t!==void 0?t:hee,d=a.jsx(c,{id:e.id,displayMonth:e.displayMonth});return a.jsxs("div",{className:n.caption_dropdowns,style:s.caption_dropdowns,children:[a.jsx("div",{className:n.vhidden,children:d}),a.jsx(dVe,{onChange:l,displayMonth:e.displayMonth}),a.jsx(uVe,{onChange:l,displayMonth:e.displayMonth})]})}function yVe(e){return a.jsx("svg",ca({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function bVe(e){return a.jsx("svg",ca({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var sS=p.forwardRef(function(e,t){var r=Ds(),n=r.classNames,s=r.styles,o=[n.button_reset,n.button];e.className&&o.push(e.className);var i=o.join(" "),l=ca(ca({},s.button_reset),s.button);return e.style&&Object.assign(l,e.style),a.jsx("button",ca({},e,{ref:t,type:"button",className:i,style:l}))});function wVe(e){var t,r,n=Ds(),s=n.dir,o=n.locale,i=n.classNames,l=n.styles,c=n.labels,d=c.labelPrevious,u=c.labelNext,f=n.components;if(!e.nextMonth&&!e.previousMonth)return a.jsx(a.Fragment,{});var h=d(e.previousMonth,{locale:o}),m=[i.nav_button,i.nav_button_previous].join(" "),v=u(e.nextMonth,{locale:o}),g=[i.nav_button,i.nav_button_next].join(" "),y=(t=f?.IconRight)!==null&&t!==void 0?t:bVe,x=(r=f?.IconLeft)!==null&&r!==void 0?r:yVe;return a.jsxs("div",{className:i.nav,style:l.nav,children:[!e.hidePrevious&&a.jsx(sS,{name:"previous-month","aria-label":h,className:m,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:s==="rtl"?a.jsx(y,{className:i.nav_icon,style:l.nav_icon}):a.jsx(x,{className:i.nav_icon,style:l.nav_icon})}),!e.hideNext&&a.jsx(sS,{name:"next-month","aria-label":v,className:g,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:s==="rtl"?a.jsx(x,{className:i.nav_icon,style:l.nav_icon}):a.jsx(y,{className:i.nav_icon,style:l.nav_icon})})]})}function nz(e){var t=Ds().numberOfMonths,r=A1(),n=r.previousMonth,s=r.nextMonth,o=r.goToMonth,i=r.displayMonths,l=i.findIndex(function(v){return fD(e.displayMonth,v)}),c=l===0,d=l===i.length-1,u=t>1&&(c||!d),f=t>1&&(d||!c),h=function(){n&&o(n)},m=function(){s&&o(s)};return a.jsx(wVe,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:f,nextMonth:s,previousMonth:n,onPreviousClick:h,onNextClick:m})}function jVe(e){var t,r=Ds(),n=r.classNames,s=r.disableNavigation,o=r.styles,i=r.captionLayout,l=r.components,c=(t=l?.CaptionLabel)!==null&&t!==void 0?t:hee,d;return s?d=a.jsx(c,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?d=a.jsx(rz,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?d=a.jsxs(a.Fragment,{children:[a.jsx(rz,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),a.jsx(nz,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):d=a.jsxs(a.Fragment,{children:[a.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(nz,{displayMonth:e.displayMonth,id:e.id})]}),a.jsx("div",{className:n.caption,style:o.caption,children:d})}function _Ve(e){var t=Ds(),r=t.footer,n=t.styles,s=t.classNames.tfoot;return r?a.jsx("tfoot",{className:s,style:n.tfoot,children:a.jsx("tr",{children:a.jsx("td",{colSpan:8,children:r})})}):a.jsx(a.Fragment,{})}function NVe(e,t,r){for(var n=r?sg(new Date):Cd(new Date,{locale:e,weekStartsOn:t}),s=[],o=0;o<7;o++){var i=La(n,o);s.push(i)}return s}function SVe(){var e=Ds(),t=e.classNames,r=e.styles,n=e.showWeekNumber,s=e.locale,o=e.weekStartsOn,i=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,d=NVe(s,o,i);return a.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&a.jsx("td",{style:r.head_cell,className:t.head_cell}),d.map(function(u,f){return a.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":c(u,{locale:s}),children:l(u,{locale:s})},f)})]})}function CVe(){var e,t=Ds(),r=t.classNames,n=t.styles,s=t.components,o=(e=s?.HeadRow)!==null&&e!==void 0?e:SVe;return a.jsx("thead",{style:n.head,className:r.head,children:a.jsx(o,{})})}function AVe(e){var t=Ds(),r=t.locale,n=t.formatters.formatDay;return a.jsx(a.Fragment,{children:n(e.date,{locale:r})})}var wM=p.createContext(void 0);function PVe(e){if(!S1(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return a.jsx(wM.Provider,{value:t,children:e.children})}return a.jsx(EVe,{initialProps:e.initialProps,children:e.children})}function EVe(e){var t=e.initialProps,r=e.children,n=t.selected,s=t.min,o=t.max,i=function(d,u,f){var h,m;(h=t.onDayClick)===null||h===void 0||h.call(t,d,u,f);var v=!!(u.selected&&s&&n?.length===s);if(!v){var g=!!(!u.selected&&o&&n?.length===o);if(!g){var y=n?fee([],n,!0):[];if(u.selected){var x=y.findIndex(function(b){return Zi(d,b)});y.splice(x,1)}else y.push(d);(m=t.onSelect)===null||m===void 0||m.call(t,y,d,u,f)}}},l={disabled:[]};n&&l.disabled.push(function(d){var u=o&&n.length>o-1,f=n.some(function(h){return Zi(h,d)});return!!(u&&!f)});var c={selected:n,onDayClick:i,modifiers:l};return a.jsx(wM.Provider,{value:c,children:r})}function jM(){var e=p.useContext(wM);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function kVe(e,t){var r=t||{},n=r.from,s=r.to;return n&&s?Zi(s,e)&&Zi(n,e)?void 0:Zi(s,e)?{from:s,to:void 0}:Zi(n,e)?void 0:RI(n,e)?{from:e,to:s}:{from:n,to:e}:s?RI(e,s)?{from:s,to:e}:{from:e,to:s}:n?fY(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var _M=p.createContext(void 0);function IVe(e){if(!C1(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return a.jsx(_M.Provider,{value:t,children:e.children})}return a.jsx(OVe,{initialProps:e.initialProps,children:e.children})}function OVe(e){var t=e.initialProps,r=e.children,n=t.selected,s=n||{},o=s.from,i=s.to,l=t.min,c=t.max,d=function(m,v,g){var y,x;(y=t.onDayClick)===null||y===void 0||y.call(t,m,v,g);var b=kVe(m,n);(x=t.onSelect)===null||x===void 0||x.call(t,b,m,v,g)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(o?(u.range_start=[o],i?(u.range_end=[i],Zi(o,i)||(u.range_middle=[{after:o,before:i}])):u.range_end=[o]):i&&(u.range_start=[i],u.range_end=[i]),l&&(o&&!i&&u.disabled.push({after:Zy(o,l-1),before:La(o,l-1)}),o&&i&&u.disabled.push({after:o,before:La(o,l-1)}),!o&&i&&u.disabled.push({after:Zy(i,l-1),before:La(i,l-1)})),c){if(o&&!i&&(u.disabled.push({before:La(o,-c+1)}),u.disabled.push({after:La(o,c-1)})),o&&i){var f=Ru(i,o)+1,h=c-f;u.disabled.push({before:Zy(o,h)}),u.disabled.push({after:La(i,h)})}!o&&i&&(u.disabled.push({before:La(i,-c+1)}),u.disabled.push({after:La(i,c-1)}))}return a.jsx(_M.Provider,{value:{selected:n,onDayClick:d,modifiers:u},children:r})}function NM(){var e=p.useContext(_M);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function Jj(e){return Array.isArray(e)?fee([],e,!0):e!==void 0?[e]:[]}function TVe(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],s=r[1];t[n]=Jj(s)}),t}var fu;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(fu||(fu={}));var DVe=fu.Selected,mf=fu.Disabled,MVe=fu.Hidden,RVe=fu.Today,tE=fu.RangeEnd,rE=fu.RangeMiddle,nE=fu.RangeStart,LVe=fu.Outside;function FVe(e,t,r){var n,s=(n={},n[DVe]=Jj(e.selected),n[mf]=Jj(e.disabled),n[MVe]=Jj(e.hidden),n[RVe]=[e.today],n[tE]=[],n[rE]=[],n[nE]=[],n[LVe]=[],n);return e.fromDate&&s[mf].push({before:e.fromDate}),e.toDate&&s[mf].push({after:e.toDate}),S1(e)?s[mf]=s[mf].concat(t.modifiers[mf]):C1(e)&&(s[mf]=s[mf].concat(r.modifiers[mf]),s[nE]=r.modifiers[nE],s[rE]=r.modifiers[rE],s[tE]=r.modifiers[tE]),s}var vee=p.createContext(void 0);function $Ve(e){var t=Ds(),r=jM(),n=NM(),s=FVe(t,r,n),o=TVe(t.modifiers),i=ca(ca({},s),o);return a.jsx(vee.Provider,{value:i,children:e.children})}function xee(){var e=p.useContext(vee);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function BVe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function qVe(e){return!!(e&&typeof e=="object"&&"from"in e)}function zVe(e){return!!(e&&typeof e=="object"&&"after"in e)}function UVe(e){return!!(e&&typeof e=="object"&&"before"in e)}function VVe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function WVe(e,t){var r,n=t.from,s=t.to;if(n&&s){var o=Ru(s,n)<0;o&&(r=[s,n],n=r[0],s=r[1]);var i=Ru(e,n)>=0&&Ru(s,e)>=0;return i}return s?Zi(s,e):n?Zi(n,e):!1}function HVe(e){return dD(e)}function GVe(e){return Array.isArray(e)&&e.every(dD)}function KVe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(HVe(r))return Zi(e,r);if(GVe(r))return r.includes(e);if(qVe(r))return WVe(e,r);if(VVe(r))return r.dayOfWeek.includes(e.getDay());if(BVe(r)){var n=Ru(r.before,e),s=Ru(r.after,e),o=n>0,i=s<0,l=RI(r.before,r.after);return l?i&&o:o||i}return zVe(r)?Ru(e,r.after)>0:UVe(r)?Ru(r.before,e)>0:typeof r=="function"?r(e):!1})}function SM(e,t,r){var n=Object.keys(t).reduce(function(o,i){var l=t[i];return KVe(e,l)&&o.push(i),o},[]),s={};return n.forEach(function(o){return s[o]=!0}),r&&!fD(e,r)&&(s.outside=!0),s}function XVe(e,t){for(var r=Sl(e[0]),n=AC(e[e.length-1]),s,o,i=r;i<=n;){var l=SM(i,t),c=!l.disabled&&!l.hidden;if(!c){i=La(i,1);continue}if(l.selected)return i;l.today&&!o&&(o=i),s||(s=i),i=La(i,1)}return o||s}var YVe=365;function yee(e,t){var r=t.moveBy,n=t.direction,s=t.context,o=t.modifiers,i=t.retry,l=i===void 0?{count:0,lastFocused:e}:i,c=s.weekStartsOn,d=s.fromDate,u=s.toDate,f=s.locale,h={day:La,week:MI,month:uu,year:bwe,startOfWeek:function(y){return s.ISOWeek?sg(y):Cd(y,{locale:f,weekStartsOn:c})},endOfWeek:function(y){return s.ISOWeek?oY(y):uD(y,{locale:f,weekStartsOn:c})}},m=h[r](e,n==="after"?1:-1);n==="before"&&d?m=wwe([d,m]):n==="after"&&u&&(m=jwe([u,m]));var v=!0;if(o){var g=SM(m,o);v=!g.disabled&&!g.hidden}return v?m:l.count>YVe?l.lastFocused:yee(m,{moveBy:r,direction:n,context:s,modifiers:o,retry:ca(ca({},l),{count:l.count+1})})}var bee=p.createContext(void 0);function JVe(e){var t=A1(),r=xee(),n=p.useState(),s=n[0],o=n[1],i=p.useState(),l=i[0],c=i[1],d=XVe(t.displayMonths,r),u=s??(l&&t.isDateDisplayed(l))?l:d,f=function(){c(s),o(void 0)},h=function(y){o(y)},m=Ds(),v=function(y,x){if(s){var b=yee(s,{moveBy:y,direction:x,context:m,modifiers:r});Zi(s,b)||(t.goToDate(b,s),h(b))}},g={focusedDay:s,focusTarget:u,blur:f,focus:h,focusDayAfter:function(){return v("day","after")},focusDayBefore:function(){return v("day","before")},focusWeekAfter:function(){return v("week","after")},focusWeekBefore:function(){return v("week","before")},focusMonthBefore:function(){return v("month","before")},focusMonthAfter:function(){return v("month","after")},focusYearBefore:function(){return v("year","before")},focusYearAfter:function(){return v("year","after")},focusStartOfWeek:function(){return v("startOfWeek","before")},focusEndOfWeek:function(){return v("endOfWeek","after")}};return a.jsx(bee.Provider,{value:g,children:e.children})}function CM(){var e=p.useContext(bee);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function QVe(e,t){var r=xee(),n=SM(e,r,t);return n}var AM=p.createContext(void 0);function ZVe(e){if(!j5(e.initialProps)){var t={selected:void 0};return a.jsx(AM.Provider,{value:t,children:e.children})}return a.jsx(eWe,{initialProps:e.initialProps,children:e.children})}function eWe(e){var t=e.initialProps,r=e.children,n=function(o,i,l){var c,d,u;if((c=t.onDayClick)===null||c===void 0||c.call(t,o,i,l),i.selected&&!t.required){(d=t.onSelect)===null||d===void 0||d.call(t,void 0,o,i,l);return}(u=t.onSelect)===null||u===void 0||u.call(t,o,o,i,l)},s={selected:t.selected,onDayClick:n};return a.jsx(AM.Provider,{value:s,children:r})}function wee(){var e=p.useContext(AM);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function tWe(e,t){var r=Ds(),n=wee(),s=jM(),o=NM(),i=CM(),l=i.focusDayAfter,c=i.focusDayBefore,d=i.focusWeekAfter,u=i.focusWeekBefore,f=i.blur,h=i.focus,m=i.focusMonthBefore,v=i.focusMonthAfter,g=i.focusYearBefore,y=i.focusYearAfter,x=i.focusStartOfWeek,b=i.focusEndOfWeek,w=function(W){var $,ee,ve,_e;j5(r)?($=n.onDayClick)===null||$===void 0||$.call(n,e,t,W):S1(r)?(ee=s.onDayClick)===null||ee===void 0||ee.call(s,e,t,W):C1(r)?(ve=o.onDayClick)===null||ve===void 0||ve.call(o,e,t,W):(_e=r.onDayClick)===null||_e===void 0||_e.call(r,e,t,W)},j=function(W){var $;h(e),($=r.onDayFocus)===null||$===void 0||$.call(r,e,t,W)},_=function(W){var $;f(),($=r.onDayBlur)===null||$===void 0||$.call(r,e,t,W)},C=function(W){var $;($=r.onDayMouseEnter)===null||$===void 0||$.call(r,e,t,W)},P=function(W){var $;($=r.onDayMouseLeave)===null||$===void 0||$.call(r,e,t,W)},E=function(W){var $;($=r.onDayPointerEnter)===null||$===void 0||$.call(r,e,t,W)},A=function(W){var $;($=r.onDayPointerLeave)===null||$===void 0||$.call(r,e,t,W)},F=function(W){var $;($=r.onDayTouchCancel)===null||$===void 0||$.call(r,e,t,W)},D=function(W){var $;($=r.onDayTouchEnd)===null||$===void 0||$.call(r,e,t,W)},I=function(W){var $;($=r.onDayTouchMove)===null||$===void 0||$.call(r,e,t,W)},R=function(W){var $;($=r.onDayTouchStart)===null||$===void 0||$.call(r,e,t,W)},M=function(W){var $;($=r.onDayKeyUp)===null||$===void 0||$.call(r,e,t,W)},U=function(W){var $;switch(W.key){case"ArrowLeft":W.preventDefault(),W.stopPropagation(),r.dir==="rtl"?l():c();break;case"ArrowRight":W.preventDefault(),W.stopPropagation(),r.dir==="rtl"?c():l();break;case"ArrowDown":W.preventDefault(),W.stopPropagation(),d();break;case"ArrowUp":W.preventDefault(),W.stopPropagation(),u();break;case"PageUp":W.preventDefault(),W.stopPropagation(),W.shiftKey?g():m();break;case"PageDown":W.preventDefault(),W.stopPropagation(),W.shiftKey?y():v();break;case"Home":W.preventDefault(),W.stopPropagation(),x();break;case"End":W.preventDefault(),W.stopPropagation(),b();break}($=r.onDayKeyDown)===null||$===void 0||$.call(r,e,t,W)},z={onClick:w,onFocus:j,onBlur:_,onKeyDown:U,onKeyUp:M,onMouseEnter:C,onMouseLeave:P,onPointerEnter:E,onPointerLeave:A,onTouchCancel:F,onTouchEnd:D,onTouchMove:I,onTouchStart:R};return z}function rWe(){var e=Ds(),t=wee(),r=jM(),n=NM(),s=j5(e)?t.selected:S1(e)?r.selected:C1(e)?n.selected:void 0;return s}function nWe(e){return Object.values(fu).includes(e)}function aWe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var s=e.modifiersClassNames[n];if(s)r.push(s);else if(nWe(n)){var o=e.classNames["day_".concat(n)];o&&r.push(o)}}),r}function sWe(e,t){var r=ca({},e.styles.day);return Object.keys(t).forEach(function(n){var s;r=ca(ca({},r),(s=e.modifiersStyles)===null||s===void 0?void 0:s[n])}),r}function oWe(e,t,r){var n,s,o,i=Ds(),l=CM(),c=QVe(e,t),d=tWe(e,c),u=rWe(),f=!!(i.onDayClick||i.mode!=="default");p.useEffect(function(){var C;c.outside||l.focusedDay&&f&&Zi(l.focusedDay,e)&&((C=r.current)===null||C===void 0||C.focus())},[l.focusedDay,e,r,f,c.outside]);var h=aWe(i,c).join(" "),m=sWe(i,c),v=!!(c.outside&&!i.showOutsideDays||c.hidden),g=(o=(s=i.components)===null||s===void 0?void 0:s.DayContent)!==null&&o!==void 0?o:AVe,y=a.jsx(g,{date:e,displayMonth:t,activeModifiers:c}),x={style:m,className:h,children:y,role:"gridcell"},b=l.focusTarget&&Zi(l.focusTarget,e)&&!c.outside,w=l.focusedDay&&Zi(l.focusedDay,e),j=ca(ca(ca({},x),(n={disabled:c.disabled,role:"gridcell"},n["aria-selected"]=c.selected,n.tabIndex=w||b?0:-1,n)),d),_={isButton:f,isHidden:v,activeModifiers:c,selectedDays:u,buttonProps:j,divProps:x};return _}function iWe(e){var t=p.useRef(null),r=oWe(e.date,e.displayMonth,t);return r.isHidden?a.jsx("div",{role:"gridcell"}):r.isButton?a.jsx(sS,ca({name:"day",ref:t},r.buttonProps)):a.jsx("div",ca({},r.divProps))}function lWe(e){var t=e.number,r=e.dates,n=Ds(),s=n.onWeekNumberClick,o=n.styles,i=n.classNames,l=n.locale,c=n.labels.labelWeekNumber,d=n.formatters.formatWeekNumber,u=d(Number(t),{locale:l});if(!s)return a.jsx("span",{className:i.weeknumber,style:o.weeknumber,children:u});var f=c(Number(t),{locale:l}),h=function(m){s(t,r,m)};return a.jsx(sS,{name:"week-number","aria-label":f,className:i.weeknumber,style:o.weeknumber,onClick:h,children:u})}function cWe(e){var t,r,n=Ds(),s=n.styles,o=n.classNames,i=n.showWeekNumber,l=n.components,c=(t=l?.Day)!==null&&t!==void 0?t:iWe,d=(r=l?.WeekNumber)!==null&&r!==void 0?r:lWe,u;return i&&(u=a.jsx("td",{className:o.cell,style:s.cell,children:a.jsx(d,{number:e.weekNumber,dates:e.dates})})),a.jsxs("tr",{className:o.row,style:s.row,children:[u,e.dates.map(function(f){return a.jsx("td",{className:o.cell,style:s.cell,role:"presentation",children:a.jsx(c,{displayMonth:e.displayMonth,date:f})},B1e(f))})]})}function az(e,t,r){for(var n=r?.ISOWeek?oY(t):uD(t,r),s=r?.ISOWeek?sg(e):Cd(e,r),o=Ru(n,s),i=[],l=0;l<=o;l++)i.push(La(s,l));var c=i.reduce(function(d,u){var f=r?.ISOWeek?F1e(u):V1e(u,r),h=d.find(function(m){return m.weekNumber===f});return h?(h.dates.push(u),d):(d.push({weekNumber:f,dates:[u]}),d)},[]);return c}function dWe(e,t){var r=az(Sl(e),AC(e),t);if(t?.useFixedWeeks){var n=H1e(e,t);if(n<6){var s=r[r.length-1],o=s.dates[s.dates.length-1],i=MI(o,6-n),l=az(MI(o,1),i,t);r.push.apply(r,l)}}return r}function uWe(e){var t,r,n,s=Ds(),o=s.locale,i=s.classNames,l=s.styles,c=s.hideHead,d=s.fixedWeeks,u=s.components,f=s.weekStartsOn,h=s.firstWeekContainsDate,m=s.ISOWeek,v=dWe(e.displayMonth,{useFixedWeeks:!!d,ISOWeek:m,locale:o,weekStartsOn:f,firstWeekContainsDate:h}),g=(t=u?.Head)!==null&&t!==void 0?t:CVe,y=(r=u?.Row)!==null&&r!==void 0?r:cWe,x=(n=u?.Footer)!==null&&n!==void 0?n:_Ve;return a.jsxs("table",{id:e.id,className:i.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&a.jsx(g,{}),a.jsx("tbody",{className:i.tbody,style:l.tbody,children:v.map(function(b){return a.jsx(y,{displayMonth:e.displayMonth,dates:b.dates,weekNumber:b.weekNumber},b.weekNumber)})}),a.jsx(x,{displayMonth:e.displayMonth})]})}function fWe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var mWe=fWe()?p.useLayoutEffect:p.useEffect,aE=!1,hWe=0;function sz(){return"react-day-picker-".concat(++hWe)}function pWe(e){var t,r=e??(aE?sz():null),n=p.useState(r),s=n[0],o=n[1];return mWe(function(){s===null&&o(sz())},[]),p.useEffect(function(){aE===!1&&(aE=!0)},[]),(t=e??s)!==null&&t!==void 0?t:void 0}function gWe(e){var t,r,n=Ds(),s=n.dir,o=n.classNames,i=n.styles,l=n.components,c=A1().displayMonths,d=pWe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),u=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,f=[o.month],h=i.month,m=e.displayIndex===0,v=e.displayIndex===c.length-1,g=!m&&!v;s==="rtl"&&(t=[m,v],v=t[0],m=t[1]),m&&(f.push(o.caption_start),h=ca(ca({},h),i.caption_start)),v&&(f.push(o.caption_end),h=ca(ca({},h),i.caption_end)),g&&(f.push(o.caption_between),h=ca(ca({},h),i.caption_between));var y=(r=l?.Caption)!==null&&r!==void 0?r:jVe;return a.jsxs("div",{className:f.join(" "),style:h,children:[a.jsx(y,{id:d,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(uWe,{id:u,"aria-labelledby":d,displayMonth:e.displayMonth})]},e.displayIndex)}function vWe(e){var t=Ds(),r=t.classNames,n=t.styles;return a.jsx("div",{className:r.months,style:n.months,children:e.children})}function xWe(e){var t,r,n=e.initialProps,s=Ds(),o=CM(),i=A1(),l=p.useState(!1),c=l[0],d=l[1];p.useEffect(function(){s.initialFocus&&o.focusTarget&&(c||(o.focus(o.focusTarget),d(!0)))},[s.initialFocus,c,o.focus,o.focusTarget,o]);var u=[s.classNames.root,s.className];s.numberOfMonths>1&&u.push(s.classNames.multiple_months),s.showWeekNumber&&u.push(s.classNames.with_weeknumber);var f=ca(ca({},s.styles.root),s.style),h=Object.keys(n).filter(function(v){return v.startsWith("data-")}).reduce(function(v,g){var y;return ca(ca({},v),(y={},y[g]=n[g],y))},{}),m=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:vWe;return a.jsx("div",ca({className:u.join(" "),style:f,dir:s.dir,id:s.id,nonce:n.nonce,title:n.title,lang:n.lang},h,{children:a.jsx(m,{children:i.displayMonths.map(function(v,g){return a.jsx(gWe,{displayIndex:g,displayMonth:v},g)})})}))}function yWe(e){var t=e.children,r=UUe(e,["children"]);return a.jsx(lVe,{initialProps:r,children:a.jsx(xVe,{children:a.jsx(ZVe,{initialProps:r,children:a.jsx(PVe,{initialProps:r,children:a.jsx(IVe,{initialProps:r,children:a.jsx($Ve,{children:a.jsx(JVe,{children:t})})})})})})})}function mT(e){return a.jsx(yWe,ca({},e,{children:a.jsx(xWe,{initialProps:e})}))}function ui({className:e,classNames:t,showOutsideDays:r=!0,weekStartsOn:n=1,locale:s=la,...o}){const i=["dom","seg","ter","qua","qui","sex","sb"];return a.jsx(mT,{showOutsideDays:r,weekStartsOn:n,locale:s,className:gr("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:gr(Gb({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:gr(Gb({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"text-muted-foreground opacity-50",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},formatters:{formatWeekdayName:(l,c)=>i[l.getDay()]},components:{IconLeft:({...l})=>a.jsx(LH,{className:"h-4 w-4"}),IconRight:({...l})=>a.jsx(c0,{className:"h-4 w-4"})},...o})}ui.displayName="Calendar";var jee="AlertDialog",[bWe,Xlt]=Ed(jee,[cX]),om=cX(),_ee=e=>{const{__scopeAlertDialog:t,...r}=e,n=om(t);return a.jsx(SX,{...n,...r,modal:!0})};_ee.displayName=jee;var wWe="AlertDialogTrigger",Nee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=om(r);return a.jsx(v0e,{...s,...n,ref:t})});Nee.displayName=wWe;var jWe="AlertDialogPortal",See=e=>{const{__scopeAlertDialog:t,...r}=e,n=om(t);return a.jsx(CX,{...n,...r})};See.displayName=jWe;var _We="AlertDialogOverlay",Cee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=om(r);return a.jsx(eD,{...s,...n,ref:t})});Cee.displayName=_We;var ax="AlertDialogContent",[NWe,SWe]=bWe(ax),CWe=uge("AlertDialogContent"),Aee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...s}=e,o=om(r),i=p.useRef(null),l=za(t,i),c=p.useRef(null);return a.jsx(m0e,{contentName:ax,titleName:Pee,docsSlug:"alert-dialog",children:a.jsx(NWe,{scope:r,cancelRef:c,children:a.jsxs(tD,{role:"alertdialog",...o,...s,ref:l,onOpenAutoFocus:jn(s.onOpenAutoFocus,d=>{d.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[a.jsx(CWe,{children:n}),a.jsx(PWe,{contentRef:i})]})})})});Aee.displayName=ax;var Pee="AlertDialogTitle",Eee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=om(r);return a.jsx(rD,{...s,...n,ref:t})});Eee.displayName=Pee;var kee="AlertDialogDescription",Iee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=om(r);return a.jsx(nD,{...s,...n,ref:t})});Iee.displayName=kee;var AWe="AlertDialogAction",Oee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=om(r);return a.jsx(wC,{...s,...n,ref:t})});Oee.displayName=AWe;var Tee="AlertDialogCancel",Dee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:s}=SWe(Tee,r),o=om(r),i=za(t,s);return a.jsx(wC,{...o,...n,ref:i})});Dee.displayName=Tee;var PWe=({contentRef:e})=>{const t=`\`${ax}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ax}\` by passing a \`${kee}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ax}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},EWe=_ee,kWe=Nee,IWe=See,Mee=Cee,Ree=Aee,Lee=Oee,Fee=Dee,$ee=Eee,Bee=Iee;const Qd=EWe,Ip=kWe,OWe=IWe,qee=Se.forwardRef(({className:e,...t},r)=>a.jsx(Mee,{className:gr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));qee.displayName=Mee.displayName;const ad=Se.forwardRef(({className:e,...t},r)=>a.jsxs(OWe,{children:[a.jsx(qee,{}),a.jsx(Ree,{ref:r,className:gr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));ad.displayName=Ree.displayName;const sd=({className:e,...t})=>a.jsx("div",{className:gr("flex flex-col space-y-2 text-center sm:text-left",e),...t});sd.displayName="AlertDialogHeader";const od=({className:e,...t})=>a.jsx("div",{className:gr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});od.displayName="AlertDialogFooter";const id=Se.forwardRef(({className:e,...t},r)=>a.jsx($ee,{ref:r,className:gr("text-lg font-semibold",e),...t}));id.displayName=$ee.displayName;const ld=Se.forwardRef(({className:e,...t},r)=>a.jsx(Bee,{ref:r,className:gr("text-sm text-muted-foreground",e),...t}));ld.displayName=Bee.displayName;const Zd=Se.forwardRef(({className:e,...t},r)=>a.jsx(Lee,{ref:r,className:gr(Gb(),e),...t}));Zd.displayName=Lee.displayName;const cd=Se.forwardRef(({className:e,...t},r)=>a.jsx(Fee,{ref:r,className:gr(Gb({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));cd.displayName=Fee.displayName;function oz(e,[t,r]){return Math.min(r,Math.max(t,e))}function _5(e){const t=e+"CollectionProvider",[r,n]=Ed(t),[s,o]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=g=>{const{scope:y,children:x}=g,b=Se.useRef(null),w=Se.useRef(new Map).current;return a.jsx(s,{scope:y,itemMap:w,collectionRef:b,children:x})};i.displayName=t;const l=e+"CollectionSlot",c=Nh(l),d=Se.forwardRef((g,y)=>{const{scope:x,children:b}=g,w=o(l,x),j=za(y,w.collectionRef);return a.jsx(c,{ref:j,children:b})});d.displayName=l;const u=e+"CollectionItemSlot",f="data-radix-collection-item",h=Nh(u),m=Se.forwardRef((g,y)=>{const{scope:x,children:b,...w}=g,j=Se.useRef(null),_=za(y,j),C=o(u,x);return Se.useEffect(()=>(C.itemMap.set(j,{ref:j,...w}),()=>void C.itemMap.delete(j))),a.jsx(h,{[f]:"",ref:_,children:b})});m.displayName=u;function v(g){const y=o(e+"CollectionConsumer",g);return Se.useCallback(()=>{const b=y.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${f}]`));return Array.from(y.itemMap.values()).sort((C,P)=>w.indexOf(C.ref.current)-w.indexOf(P.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:i,Slot:d,ItemSlot:m},v,n]}var TWe=p.createContext(void 0);function N5(e){const t=p.useContext(TWe);return e||t||"ltr"}function zee(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Uee=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),DWe="VisuallyHidden",PM=p.forwardRef((e,t)=>a.jsx(sa.span,{...e,ref:t,style:{...Uee,...e.style}}));PM.displayName=DWe;var MWe=[" ","Enter","ArrowUp","ArrowDown"],RWe=[" ","Enter"],fg="Select",[S5,C5,LWe]=_5(fg),[I0,Ylt]=Ed(fg,[LWe,m0]),A5=m0(),[FWe,Wh]=I0(fg),[$We,BWe]=I0(fg),Vee=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:o,value:i,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:f,disabled:h,required:m,form:v}=e,g=A5(t),[y,x]=p.useState(null),[b,w]=p.useState(null),[j,_]=p.useState(!1),C=N5(d),[P,E]=Kf({prop:n,defaultProp:s??!1,onChange:o,caller:fg}),[A,F]=Kf({prop:i,defaultProp:l,onChange:c,caller:fg}),D=p.useRef(null),I=y?v||!!y.closest("form"):!0,[R,M]=p.useState(new Set),U=Array.from(R).map(z=>z.props.value).join(";");return a.jsx(G4,{...g,children:a.jsxs(FWe,{required:m,scope:t,trigger:y,onTriggerChange:x,valueNode:b,onValueNodeChange:w,valueNodeHasChildren:j,onValueNodeHasChildrenChange:_,contentId:su(),value:A,onValueChange:F,open:P,onOpenChange:E,dir:C,triggerPointerDownPosRef:D,disabled:h,children:[a.jsx(S5.Provider,{scope:t,children:a.jsx($We,{scope:e.__scopeSelect,onNativeOptionAdd:p.useCallback(z=>{M(W=>new Set(W).add(z))},[]),onNativeOptionRemove:p.useCallback(z=>{M(W=>{const $=new Set(W);return $.delete(z),$})},[]),children:r})}),I?a.jsxs(fte,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:f,value:A,onChange:z=>F(z.target.value),disabled:h,form:v,children:[A===void 0?a.jsx("option",{value:""}):null,Array.from(R)]},U):null]})})};Vee.displayName=fg;var Wee="SelectTrigger",Hee=p.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,o=A5(r),i=Wh(Wee,r),l=i.disabled||n,c=za(t,i.onTriggerChange),d=C5(r),u=p.useRef("touch"),[f,h,m]=hte(g=>{const y=d().filter(w=>!w.disabled),x=y.find(w=>w.value===i.value),b=pte(y,g,x);b!==void 0&&i.onValueChange(b.value)}),v=g=>{l||(i.onOpenChange(!0),m()),g&&(i.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return a.jsx(pC,{asChild:!0,...o,children:a.jsx(sa.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":mte(i.value)?"":void 0,...s,ref:c,onClick:jn(s.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&v(g)}),onPointerDown:jn(s.onPointerDown,g=>{u.current=g.pointerType;const y=g.target;y.hasPointerCapture(g.pointerId)&&y.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(v(g),g.preventDefault())}),onKeyDown:jn(s.onKeyDown,g=>{const y=f.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(y&&g.key===" ")&&MWe.includes(g.key)&&(v(),g.preventDefault())})})})});Hee.displayName=Wee;var Gee="SelectValue",Kee=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:o,placeholder:i="",...l}=e,c=Wh(Gee,r),{onValueNodeHasChildrenChange:d}=c,u=o!==void 0,f=za(t,c.onValueNodeChange);return Mi(()=>{d(u)},[d,u]),a.jsx(sa.span,{...l,ref:f,style:{pointerEvents:"none"},children:mte(c.value)?a.jsx(a.Fragment,{children:i}):o})});Kee.displayName=Gee;var qWe="SelectIcon",Xee=p.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return a.jsx(sa.span,{"aria-hidden":!0,...s,ref:t,children:n||""})});Xee.displayName=qWe;var zWe="SelectPortal",Yee=e=>a.jsx(h0,{asChild:!0,...e});Yee.displayName=zWe;var mg="SelectContent",Jee=p.forwardRef((e,t)=>{const r=Wh(mg,e.__scopeSelect),[n,s]=p.useState();if(Mi(()=>{s(new DocumentFragment)},[]),!r.open){const o=n;return o?em.createPortal(a.jsx(Qee,{scope:e.__scopeSelect,children:a.jsx(S5.Slot,{scope:e.__scopeSelect,children:a.jsx("div",{children:e.children})})}),o):null}return a.jsx(Zee,{...e,ref:t})});Jee.displayName=mg;var Wd=10,[Qee,Hh]=I0(mg),UWe="SelectContentImpl",VWe=Nh("SelectContent.RemoveScroll"),Zee=p.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:o,onPointerDownOutside:i,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:m,sticky:v,hideWhenDetached:g,avoidCollisions:y,...x}=e,b=Wh(mg,r),[w,j]=p.useState(null),[_,C]=p.useState(null),P=za(t,Z=>j(Z)),[E,A]=p.useState(null),[F,D]=p.useState(null),I=C5(r),[R,M]=p.useState(!1),U=p.useRef(!1);p.useEffect(()=>{if(w)return gC(w)},[w]),uC();const z=p.useCallback(Z=>{const[ce,...le]=I().map(ue=>ue.ref.current),[ie]=le.slice(-1),te=document.activeElement;for(const ue of Z)if(ue===te||(ue?.scrollIntoView({block:"nearest"}),ue===ce&&_&&(_.scrollTop=0),ue===ie&&_&&(_.scrollTop=_.scrollHeight),ue?.focus(),document.activeElement!==te))return},[I,_]),W=p.useCallback(()=>z([E,w]),[z,E,w]);p.useEffect(()=>{R&&W()},[R,W]);const{onOpenChange:$,triggerPointerDownPosRef:ee}=b;p.useEffect(()=>{if(w){let Z={x:0,y:0};const ce=ie=>{Z={x:Math.abs(Math.round(ie.pageX)-(ee.current?.x??0)),y:Math.abs(Math.round(ie.pageY)-(ee.current?.y??0))}},le=ie=>{Z.x<=10&&Z.y<=10?ie.preventDefault():w.contains(ie.target)||$(!1),document.removeEventListener("pointermove",ce),ee.current=null};return ee.current!==null&&(document.addEventListener("pointermove",ce),document.addEventListener("pointerup",le,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ce),document.removeEventListener("pointerup",le,{capture:!0})}}},[w,$,ee]),p.useEffect(()=>{const Z=()=>$(!1);return window.addEventListener("blur",Z),window.addEventListener("resize",Z),()=>{window.removeEventListener("blur",Z),window.removeEventListener("resize",Z)}},[$]);const[ve,_e]=hte(Z=>{const ce=I().filter(te=>!te.disabled),le=ce.find(te=>te.ref.current===document.activeElement),ie=pte(ce,Z,le);ie&&setTimeout(()=>ie.ref.current.focus())}),K=p.useCallback((Z,ce,le)=>{const ie=!U.current&&!le;(b.value!==void 0&&b.value===ce||ie)&&(A(Z),ie&&(U.current=!0))},[b.value]),q=p.useCallback(()=>w?.focus(),[w]),Y=p.useCallback((Z,ce,le)=>{const ie=!U.current&&!le;(b.value!==void 0&&b.value===ce||ie)&&D(Z)},[b.value]),J=n==="popper"?hT:ete,fe=J===hT?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:m,sticky:v,hideWhenDetached:g,avoidCollisions:y}:{};return a.jsx(Qee,{scope:r,content:w,viewport:_,onViewportChange:C,itemRefCallback:K,selectedItem:E,onItemLeave:q,itemTextRefCallback:Y,focusSelectedItem:W,selectedItemText:F,position:n,isPositioned:R,searchRef:ve,children:a.jsx(xC,{as:VWe,allowPinchZoom:!0,children:a.jsx(f1,{asChild:!0,trapped:b.open,onMountAutoFocus:Z=>{Z.preventDefault()},onUnmountAutoFocus:jn(s,Z=>{b.trigger?.focus({preventScroll:!0}),Z.preventDefault()}),children:a.jsx(d0,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:Z=>Z.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:a.jsx(J,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:Z=>Z.preventDefault(),...x,...fe,onPlaced:()=>M(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:jn(x.onKeyDown,Z=>{const ce=Z.ctrlKey||Z.altKey||Z.metaKey;if(Z.key==="Tab"&&Z.preventDefault(),!ce&&Z.key.length===1&&_e(Z.key),["ArrowUp","ArrowDown","Home","End"].includes(Z.key)){let ie=I().filter(te=>!te.disabled).map(te=>te.ref.current);if(["ArrowUp","End"].includes(Z.key)&&(ie=ie.slice().reverse()),["ArrowUp","ArrowDown"].includes(Z.key)){const te=Z.target,ue=ie.indexOf(te);ie=ie.slice(ue+1)}setTimeout(()=>z(ie)),Z.preventDefault()}})})})})})})});Zee.displayName=UWe;var WWe="SelectItemAlignedPosition",ete=p.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,o=Wh(mg,r),i=Hh(mg,r),[l,c]=p.useState(null),[d,u]=p.useState(null),f=za(t,P=>u(P)),h=C5(r),m=p.useRef(!1),v=p.useRef(!0),{viewport:g,selectedItem:y,selectedItemText:x,focusSelectedItem:b}=i,w=p.useCallback(()=>{if(o.trigger&&o.valueNode&&l&&d&&g&&y&&x){const P=o.trigger.getBoundingClientRect(),E=d.getBoundingClientRect(),A=o.valueNode.getBoundingClientRect(),F=x.getBoundingClientRect();if(o.dir!=="rtl"){const te=F.left-E.left,ue=A.left-te,Te=P.left-ue,ne=P.width+Te,de=Math.max(ne,E.width),lt=window.innerWidth-Wd,Nt=oz(ue,[Wd,Math.max(Wd,lt-de)]);l.style.minWidth=ne+"px",l.style.left=Nt+"px"}else{const te=E.right-F.right,ue=window.innerWidth-A.right-te,Te=window.innerWidth-P.right-ue,ne=P.width+Te,de=Math.max(ne,E.width),lt=window.innerWidth-Wd,Nt=oz(ue,[Wd,Math.max(Wd,lt-de)]);l.style.minWidth=ne+"px",l.style.right=Nt+"px"}const D=h(),I=window.innerHeight-Wd*2,R=g.scrollHeight,M=window.getComputedStyle(d),U=parseInt(M.borderTopWidth,10),z=parseInt(M.paddingTop,10),W=parseInt(M.borderBottomWidth,10),$=parseInt(M.paddingBottom,10),ee=U+z+R+$+W,ve=Math.min(y.offsetHeight*5,ee),_e=window.getComputedStyle(g),K=parseInt(_e.paddingTop,10),q=parseInt(_e.paddingBottom,10),Y=P.top+P.height/2-Wd,J=I-Y,fe=y.offsetHeight/2,Z=y.offsetTop+fe,ce=U+z+Z,le=ee-ce;if(ce<=Y){const te=D.length>0&&y===D[D.length-1].ref.current;l.style.bottom="0px";const ue=d.clientHeight-g.offsetTop-g.offsetHeight,Te=Math.max(J,fe+(te?q:0)+ue+W),ne=ce+Te;l.style.height=ne+"px"}else{const te=D.length>0&&y===D[0].ref.current;l.style.top="0px";const Te=Math.max(Y,U+g.offsetTop+(te?K:0)+fe)+le;l.style.height=Te+"px",g.scrollTop=ce-Y+g.offsetTop}l.style.margin=`${Wd}px 0`,l.style.minHeight=ve+"px",l.style.maxHeight=I+"px",n?.(),requestAnimationFrame(()=>m.current=!0)}},[h,o.trigger,o.valueNode,l,d,g,y,x,o.dir,n]);Mi(()=>w(),[w]);const[j,_]=p.useState();Mi(()=>{d&&_(window.getComputedStyle(d).zIndex)},[d]);const C=p.useCallback(P=>{P&&v.current===!0&&(w(),b?.(),v.current=!1)},[w,b]);return a.jsx(GWe,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:C,children:a.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:a.jsx(sa.div,{...s,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});ete.displayName=WWe;var HWe="SelectPopperPosition",hT=p.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=Wd,...o}=e,i=A5(r);return a.jsx(K4,{...i,...o,ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});hT.displayName=HWe;var[GWe,EM]=I0(mg,{}),pT="SelectViewport",tte=p.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...s}=e,o=Hh(pT,r),i=EM(pT,r),l=za(t,o.onViewportChange),c=p.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),a.jsx(S5.Slot,{scope:r,children:a.jsx(sa.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:jn(s.onScroll,d=>{const u=d.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:h}=i;if(h?.current&&f){const m=Math.abs(c.current-u.scrollTop);if(m>0){const v=window.innerHeight-Wd*2,g=parseFloat(f.style.minHeight),y=parseFloat(f.style.height),x=Math.max(g,y);if(x<v){const b=x+m,w=Math.min(v,b),j=b-w;f.style.height=w+"px",f.style.bottom==="0px"&&(u.scrollTop=j>0?j:0,f.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});tte.displayName=pT;var rte="SelectGroup",[KWe,XWe]=I0(rte),YWe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=su();return a.jsx(KWe,{scope:r,id:s,children:a.jsx(sa.div,{role:"group","aria-labelledby":s,...n,ref:t})})});YWe.displayName=rte;var nte="SelectLabel",ate=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=XWe(nte,r);return a.jsx(sa.div,{id:s.id,...n,ref:t})});ate.displayName=nte;var oS="SelectItem",[JWe,ste]=I0(oS),ote=p.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:o,...i}=e,l=Wh(oS,r),c=Hh(oS,r),d=l.value===n,[u,f]=p.useState(o??""),[h,m]=p.useState(!1),v=za(t,b=>c.itemRefCallback?.(b,n,s)),g=su(),y=p.useRef("touch"),x=()=>{s||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(JWe,{scope:r,value:n,disabled:s,textId:g,isSelected:d,onItemTextChange:p.useCallback(b=>{f(w=>w||(b?.textContent??"").trim())},[]),children:a.jsx(S5.ItemSlot,{scope:r,value:n,disabled:s,textValue:u,children:a.jsx(sa.div,{role:"option","aria-labelledby":g,"data-highlighted":h?"":void 0,"aria-selected":d&&h,"data-state":d?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...i,ref:v,onFocus:jn(i.onFocus,()=>m(!0)),onBlur:jn(i.onBlur,()=>m(!1)),onClick:jn(i.onClick,()=>{y.current!=="mouse"&&x()}),onPointerUp:jn(i.onPointerUp,()=>{y.current==="mouse"&&x()}),onPointerDown:jn(i.onPointerDown,b=>{y.current=b.pointerType}),onPointerMove:jn(i.onPointerMove,b=>{y.current=b.pointerType,s?c.onItemLeave?.():y.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:jn(i.onPointerLeave,b=>{b.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:jn(i.onKeyDown,b=>{c.searchRef?.current!==""&&b.key===" "||(RWe.includes(b.key)&&x(),b.key===" "&&b.preventDefault())})})})})});ote.displayName=oS;var ky="SelectItemText",ite=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...o}=e,i=Wh(ky,r),l=Hh(ky,r),c=ste(ky,r),d=BWe(ky,r),[u,f]=p.useState(null),h=za(t,x=>f(x),c.onItemTextChange,x=>l.itemTextRefCallback?.(x,c.value,c.disabled)),m=u?.textContent,v=p.useMemo(()=>a.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:g,onNativeOptionRemove:y}=d;return Mi(()=>(g(v),()=>y(v)),[g,y,v]),a.jsxs(a.Fragment,{children:[a.jsx(sa.span,{id:c.textId,...o,ref:h}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?em.createPortal(o.children,i.valueNode):null]})});ite.displayName=ky;var lte="SelectItemIndicator",cte=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return ste(lte,r).isSelected?a.jsx(sa.span,{"aria-hidden":!0,...n,ref:t}):null});cte.displayName=lte;var gT="SelectScrollUpButton",QWe=p.forwardRef((e,t)=>{const r=Hh(gT,e.__scopeSelect),n=EM(gT,e.__scopeSelect),[s,o]=p.useState(!1),i=za(t,n.onScrollButtonChange);return Mi(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;o(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?a.jsx(dte,{...e,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});QWe.displayName=gT;var vT="SelectScrollDownButton",ZWe=p.forwardRef((e,t)=>{const r=Hh(vT,e.__scopeSelect),n=EM(vT,e.__scopeSelect),[s,o]=p.useState(!1),i=za(t,n.onScrollButtonChange);return Mi(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;o(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?a.jsx(dte,{...e,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});ZWe.displayName=vT;var dte=p.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,o=Hh("SelectScrollButton",r),i=p.useRef(null),l=C5(r),c=p.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),Mi(()=>{l().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),a.jsx(sa.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:jn(s.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:jn(s.onPointerMove,()=>{o.onItemLeave?.(),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:jn(s.onPointerLeave,()=>{c()})})}),eHe="SelectSeparator",ute=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return a.jsx(sa.div,{"aria-hidden":!0,...n,ref:t})});ute.displayName=eHe;var xT="SelectArrow",tHe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=A5(r),o=Wh(xT,r),i=Hh(xT,r);return o.open&&i.position==="popper"?a.jsx(X4,{...s,...n,ref:t}):null});tHe.displayName=xT;var rHe="SelectBubbleInput",fte=p.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const s=p.useRef(null),o=za(n,s),i=zee(t);return p.useEffect(()=>{const l=s.current;if(!l)return;const c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==t&&u){const f=new Event("change",{bubbles:!0});u.call(l,t),l.dispatchEvent(f)}},[i,t]),a.jsx(sa.select,{...r,style:{...Uee,...r.style},ref:o,defaultValue:t})});fte.displayName=rHe;function mte(e){return e===""||e===void 0}function hte(e){const t=ec(e),r=p.useRef(""),n=p.useRef(0),s=p.useCallback(i=>{const l=r.current+i;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),o=p.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,o]}function pte(e,t,r){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,o=r?e.indexOf(r):-1;let i=nHe(e,Math.max(o,0));s.length===1&&(i=i.filter(d=>d!==r));const c=i.find(d=>d.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function nHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var aHe=Vee,gte=Hee,sHe=Kee,oHe=Xee,iHe=Yee,vte=Jee,lHe=tte,xte=ate,yte=ote,cHe=ite,dHe=cte,bte=ute;const Nn=aHe,Cn=sHe,bn=Se.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(gte,{ref:n,className:gr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground hover:bg-surface-2/30 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-150",e),...r,children:[t,a.jsx(oHe,{asChild:!0,children:a.jsx(wg,{className:"h-4 w-4 opacity-50"})})]}));bn.displayName=gte.displayName;const wn=Se.forwardRef(({className:e,children:t,position:r="popper",...n},s)=>a.jsx(iHe,{children:a.jsx(vte,{ref:s,className:gr("relative z-50 min-w-[8rem] max-h-[340px] overflow-auto fx-scroll rounded-md border bg-popover text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:a.jsx(lHe,{className:gr("p-1",r==="popper"&&"w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));wn.displayName=vte.displayName;const uHe=Se.forwardRef(({className:e,...t},r)=>a.jsx(xte,{ref:r,className:gr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));uHe.displayName=xte.displayName;const tt=Se.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(yte,{ref:n,className:gr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-surface-2/50 focus:bg-surface-2/50 data-[state=checked]:bg-surface-2/50 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 transition-colors",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(dHe,{children:a.jsx(Uf,{className:"h-4 w-4"})})}),a.jsx(cHe,{children:t})]}));tt.displayName=yte.displayName;const fHe=Se.forwardRef(({className:e,...t},r)=>a.jsx(bte,{ref:r,className:gr("-mx-1 my-1 h-px bg-muted",e),...t}));fHe.displayName=bte.displayName;var P5="Checkbox",[mHe,Jlt]=Ed(P5),[hHe,kM]=mHe(P5);function pHe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:s,disabled:o,form:i,name:l,onCheckedChange:c,required:d,value:u="on",internal_do_not_use_render:f}=e,[h,m]=Kf({prop:r,defaultProp:s??!1,onChange:c,caller:P5}),[v,g]=p.useState(null),[y,x]=p.useState(null),b=p.useRef(!1),w=v?!!i||!!v.closest("form"):!0,j={checked:h,disabled:o,setChecked:m,control:v,setControl:g,name:l,form:i,value:u,hasConsumerStoppedPropagationRef:b,required:d,defaultChecked:uh(s)?!1:s,isFormControl:w,bubbleInput:y,setBubbleInput:x};return a.jsx(hHe,{scope:t,...j,children:gHe(f)?f(j):n})}var wte="CheckboxTrigger",jte=p.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},s)=>{const{control:o,value:i,disabled:l,checked:c,required:d,setControl:u,setChecked:f,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:v}=kM(wte,e),g=za(s,u),y=p.useRef(c);return p.useEffect(()=>{const x=o?.form;if(x){const b=()=>f(y.current);return x.addEventListener("reset",b),()=>x.removeEventListener("reset",b)}},[o,f]),a.jsx(sa.button,{type:"button",role:"checkbox","aria-checked":uh(c)?"mixed":c,"aria-required":d,"data-state":Ate(c),"data-disabled":l?"":void 0,disabled:l,value:i,...n,ref:g,onKeyDown:jn(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:jn(r,x=>{f(b=>uh(b)?!0:!b),v&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});jte.displayName=wte;var IM=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:s,defaultChecked:o,required:i,disabled:l,value:c,onCheckedChange:d,form:u,...f}=e;return a.jsx(pHe,{__scopeCheckbox:r,checked:s,defaultChecked:o,disabled:l,required:i,onCheckedChange:d,name:n,form:u,value:c,internal_do_not_use_render:({isFormControl:h})=>a.jsxs(a.Fragment,{children:[a.jsx(jte,{...f,ref:t,__scopeCheckbox:r}),h&&a.jsx(Cte,{__scopeCheckbox:r})]})})});IM.displayName=P5;var _te="CheckboxIndicator",Nte=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...s}=e,o=kM(_te,r);return a.jsx(qc,{present:n||uh(o.checked)||o.checked===!0,children:a.jsx(sa.span,{"data-state":Ate(o.checked),"data-disabled":o.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});Nte.displayName=_te;var Ste="CheckboxBubbleInput",Cte=p.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:s,checked:o,defaultChecked:i,required:l,disabled:c,name:d,value:u,form:f,bubbleInput:h,setBubbleInput:m}=kM(Ste,e),v=za(r,m),g=zee(o),y=OK(n);p.useEffect(()=>{const b=h;if(!b)return;const w=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(w,"checked").set,C=!s.current;if(g!==o&&_){const P=new Event("click",{bubbles:C});b.indeterminate=uh(o),_.call(b,uh(o)?!1:o),b.dispatchEvent(P)}},[h,g,o,s]);const x=p.useRef(uh(o)?!1:o);return a.jsx(sa.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??x.current,required:l,disabled:c,name:d,value:u,form:f,...t,tabIndex:-1,ref:v,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Cte.displayName=Ste;function gHe(e){return typeof e=="function"}function uh(e){return e==="indeterminate"}function Ate(e){return uh(e)?"indeterminate":e?"checked":"unchecked"}const Ha=Se.forwardRef(({className:e,...t},r)=>a.jsx(IM,{ref:r,className:gr("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:a.jsx(Nte,{className:gr("flex items-center justify-center text-current"),children:a.jsx(Uf,{className:"h-4 w-4"})})}));Ha.displayName=IM.displayName;var sE="rovingFocusGroup.onEntryFocus",vHe={bubbles:!1,cancelable:!0},P1="RovingFocusGroup",[yT,Pte,xHe]=_5(P1),[yHe,E5]=Ed(P1,[xHe]),[bHe,wHe]=yHe(P1),Ete=p.forwardRef((e,t)=>a.jsx(yT.Provider,{scope:e.__scopeRovingFocusGroup,children:a.jsx(yT.Slot,{scope:e.__scopeRovingFocusGroup,children:a.jsx(jHe,{...e,ref:t})})}));Ete.displayName=P1;var jHe=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...f}=e,h=p.useRef(null),m=za(t,h),v=N5(o),[g,y]=Kf({prop:i,defaultProp:l??null,onChange:c,caller:P1}),[x,b]=p.useState(!1),w=ec(d),j=Pte(r),_=p.useRef(!1),[C,P]=p.useState(0);return p.useEffect(()=>{const E=h.current;if(E)return E.addEventListener(sE,w),()=>E.removeEventListener(sE,w)},[w]),a.jsx(bHe,{scope:r,orientation:n,dir:v,loop:s,currentTabStopId:g,onItemFocus:p.useCallback(E=>y(E),[y]),onItemShiftTab:p.useCallback(()=>b(!0),[]),onFocusableItemAdd:p.useCallback(()=>P(E=>E+1),[]),onFocusableItemRemove:p.useCallback(()=>P(E=>E-1),[]),children:a.jsx(sa.div,{tabIndex:x||C===0?-1:0,"data-orientation":n,...f,ref:m,style:{outline:"none",...e.style},onMouseDown:jn(e.onMouseDown,()=>{_.current=!0}),onFocus:jn(e.onFocus,E=>{const A=!_.current;if(E.target===E.currentTarget&&A&&!x){const F=new CustomEvent(sE,vHe);if(E.currentTarget.dispatchEvent(F),!F.defaultPrevented){const D=j().filter(z=>z.focusable),I=D.find(z=>z.active),R=D.find(z=>z.id===g),U=[I,R,...D].filter(Boolean).map(z=>z.ref.current);Ote(U,u)}}_.current=!1}),onBlur:jn(e.onBlur,()=>b(!1))})})}),kte="RovingFocusGroupItem",Ite=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:o,children:i,...l}=e,c=su(),d=o||c,u=wHe(kte,r),f=u.currentTabStopId===d,h=Pte(r),{onFocusableItemAdd:m,onFocusableItemRemove:v,currentTabStopId:g}=u;return p.useEffect(()=>{if(n)return m(),()=>v()},[n,m,v]),a.jsx(yT.ItemSlot,{scope:r,id:d,focusable:n,active:s,children:a.jsx(sa.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...l,ref:t,onMouseDown:jn(e.onMouseDown,y=>{n?u.onItemFocus(d):y.preventDefault()}),onFocus:jn(e.onFocus,()=>u.onItemFocus(d)),onKeyDown:jn(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const x=SHe(y,u.orientation,u.dir);if(x!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=h().filter(j=>j.focusable).map(j=>j.ref.current);if(x==="last")w.reverse();else if(x==="prev"||x==="next"){x==="prev"&&w.reverse();const j=w.indexOf(y.currentTarget);w=u.loop?CHe(w,j+1):w.slice(j+1)}setTimeout(()=>Ote(w))}}),children:typeof i=="function"?i({isCurrentTabStop:f,hasTabStop:g!=null}):i})})});Ite.displayName=kte;var _He={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function NHe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function SHe(e,t,r){const n=NHe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return _He[n]}function Ote(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function CHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Tte=Ete,Dte=Ite,bT=["Enter"," "],AHe=["ArrowDown","PageUp","Home"],Mte=["ArrowUp","PageDown","End"],PHe=[...AHe,...Mte],EHe={ltr:[...bT,"ArrowRight"],rtl:[...bT,"ArrowLeft"]},kHe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},E1="Menu",[Rw,IHe,OHe]=_5(E1),[Ig,Rte]=Ed(E1,[OHe,m0,E5]),k5=m0(),Lte=E5(),[THe,Og]=Ig(E1),[DHe,k1]=Ig(E1),Fte=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:s,onOpenChange:o,modal:i=!0}=e,l=k5(t),[c,d]=p.useState(null),u=p.useRef(!1),f=ec(o),h=N5(s);return p.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),a.jsx(G4,{...l,children:a.jsx(THe,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:d,children:a.jsx(DHe,{scope:t,onClose:p.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:h,modal:i,children:n})})})};Fte.displayName=E1;var MHe="MenuAnchor",OM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=k5(r);return a.jsx(pC,{...s,...n,ref:t})});OM.displayName=MHe;var TM="MenuPortal",[RHe,$te]=Ig(TM,{forceMount:void 0}),Bte=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:s}=e,o=Og(TM,t);return a.jsx(RHe,{scope:t,forceMount:r,children:a.jsx(qc,{present:r||o.open,children:a.jsx(h0,{asChild:!0,container:s,children:n})})})};Bte.displayName=TM;var wd="MenuContent",[LHe,DM]=Ig(wd),qte=p.forwardRef((e,t)=>{const r=$te(wd,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,o=Og(wd,e.__scopeMenu),i=k1(wd,e.__scopeMenu);return a.jsx(Rw.Provider,{scope:e.__scopeMenu,children:a.jsx(qc,{present:n||o.open,children:a.jsx(Rw.Slot,{scope:e.__scopeMenu,children:i.modal?a.jsx(FHe,{...s,ref:t}):a.jsx($He,{...s,ref:t})})})})}),FHe=p.forwardRef((e,t)=>{const r=Og(wd,e.__scopeMenu),n=p.useRef(null),s=za(t,n);return p.useEffect(()=>{const o=n.current;if(o)return gC(o)},[]),a.jsx(MM,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:jn(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),$He=p.forwardRef((e,t)=>{const r=Og(wd,e.__scopeMenu);return a.jsx(MM,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),BHe=Nh("MenuContent.ScrollLock"),MM=p.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:m,disableOutsideScroll:v,...g}=e,y=Og(wd,r),x=k1(wd,r),b=k5(r),w=Lte(r),j=IHe(r),[_,C]=p.useState(null),P=p.useRef(null),E=za(t,P,y.onContentChange),A=p.useRef(0),F=p.useRef(""),D=p.useRef(0),I=p.useRef(null),R=p.useRef("right"),M=p.useRef(0),U=v?xC:p.Fragment,z=v?{as:BHe,allowPinchZoom:!0}:void 0,W=ee=>{const ve=F.current+ee,_e=j().filter(Z=>!Z.disabled),K=document.activeElement,q=_e.find(Z=>Z.ref.current===K)?.textValue,Y=_e.map(Z=>Z.textValue),J=QHe(Y,ve,q),fe=_e.find(Z=>Z.textValue===J)?.ref.current;(function Z(ce){F.current=ce,window.clearTimeout(A.current),ce!==""&&(A.current=window.setTimeout(()=>Z(""),1e3))})(ve),fe&&setTimeout(()=>fe.focus())};p.useEffect(()=>()=>window.clearTimeout(A.current),[]),uC();const $=p.useCallback(ee=>R.current===I.current?.side&&eGe(ee,I.current?.area),[]);return a.jsx(LHe,{scope:r,searchRef:F,onItemEnter:p.useCallback(ee=>{$(ee)&&ee.preventDefault()},[$]),onItemLeave:p.useCallback(ee=>{$(ee)||(P.current?.focus(),C(null))},[$]),onTriggerLeave:p.useCallback(ee=>{$(ee)&&ee.preventDefault()},[$]),pointerGraceTimerRef:D,onPointerGraceIntentChange:p.useCallback(ee=>{I.current=ee},[]),children:a.jsx(U,{...z,children:a.jsx(f1,{asChild:!0,trapped:s,onMountAutoFocus:jn(o,ee=>{ee.preventDefault(),P.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:a.jsx(d0,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:m,children:a.jsx(Tte,{asChild:!0,...w,dir:x.dir,orientation:"vertical",loop:n,currentTabStopId:_,onCurrentTabStopIdChange:C,onEntryFocus:jn(c,ee=>{x.isUsingKeyboardRef.current||ee.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(K4,{role:"menu","aria-orientation":"vertical","data-state":nre(y.open),"data-radix-menu-content":"",dir:x.dir,...b,...g,ref:E,style:{outline:"none",...g.style},onKeyDown:jn(g.onKeyDown,ee=>{const _e=ee.target.closest("[data-radix-menu-content]")===ee.currentTarget,K=ee.ctrlKey||ee.altKey||ee.metaKey,q=ee.key.length===1;_e&&(ee.key==="Tab"&&ee.preventDefault(),!K&&q&&W(ee.key));const Y=P.current;if(ee.target!==Y||!PHe.includes(ee.key))return;ee.preventDefault();const fe=j().filter(Z=>!Z.disabled).map(Z=>Z.ref.current);Mte.includes(ee.key)&&fe.reverse(),YHe(fe)}),onBlur:jn(e.onBlur,ee=>{ee.currentTarget.contains(ee.target)||(window.clearTimeout(A.current),F.current="")}),onPointerMove:jn(e.onPointerMove,Lw(ee=>{const ve=ee.target,_e=M.current!==ee.clientX;if(ee.currentTarget.contains(ve)&&_e){const K=ee.clientX>M.current?"right":"left";R.current=K,M.current=ee.clientX}}))})})})})})})});qte.displayName=wd;var qHe="MenuGroup",RM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return a.jsx(sa.div,{role:"group",...n,ref:t})});RM.displayName=qHe;var zHe="MenuLabel",zte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return a.jsx(sa.div,{...n,ref:t})});zte.displayName=zHe;var iS="MenuItem",iz="menu.itemSelect",I5=p.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...s}=e,o=p.useRef(null),i=k1(iS,e.__scopeMenu),l=DM(iS,e.__scopeMenu),c=za(t,o),d=p.useRef(!1),u=()=>{const f=o.current;if(!r&&f){const h=new CustomEvent(iz,{bubbles:!0,cancelable:!0});f.addEventListener(iz,m=>n?.(m),{once:!0}),L4(f,h),h.defaultPrevented?d.current=!1:i.onClose()}};return a.jsx(Ute,{...s,ref:c,disabled:r,onClick:jn(e.onClick,u),onPointerDown:f=>{e.onPointerDown?.(f),d.current=!0},onPointerUp:jn(e.onPointerUp,f=>{d.current||f.currentTarget?.click()}),onKeyDown:jn(e.onKeyDown,f=>{const h=l.searchRef.current!=="";r||h&&f.key===" "||bT.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});I5.displayName=iS;var Ute=p.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...o}=e,i=DM(iS,r),l=Lte(r),c=p.useRef(null),d=za(t,c),[u,f]=p.useState(!1),[h,m]=p.useState("");return p.useEffect(()=>{const v=c.current;v&&m((v.textContent??"").trim())},[o.children]),a.jsx(Rw.ItemSlot,{scope:r,disabled:n,textValue:s??h,children:a.jsx(Dte,{asChild:!0,...l,focusable:!n,children:a.jsx(sa.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...o,ref:d,onPointerMove:jn(e.onPointerMove,Lw(v=>{n?i.onItemLeave(v):(i.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:jn(e.onPointerLeave,Lw(v=>i.onItemLeave(v))),onFocus:jn(e.onFocus,()=>f(!0)),onBlur:jn(e.onBlur,()=>f(!1))})})})}),UHe="MenuCheckboxItem",Vte=p.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...s}=e;return a.jsx(Xte,{scope:e.__scopeMenu,checked:r,children:a.jsx(I5,{role:"menuitemcheckbox","aria-checked":lS(r)?"mixed":r,...s,ref:t,"data-state":FM(r),onSelect:jn(s.onSelect,()=>n?.(lS(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Vte.displayName=UHe;var Wte="MenuRadioGroup",[VHe,WHe]=Ig(Wte,{value:void 0,onValueChange:()=>{}}),Hte=p.forwardRef((e,t)=>{const{value:r,onValueChange:n,...s}=e,o=ec(n);return a.jsx(VHe,{scope:e.__scopeMenu,value:r,onValueChange:o,children:a.jsx(RM,{...s,ref:t})})});Hte.displayName=Wte;var Gte="MenuRadioItem",Kte=p.forwardRef((e,t)=>{const{value:r,...n}=e,s=WHe(Gte,e.__scopeMenu),o=r===s.value;return a.jsx(Xte,{scope:e.__scopeMenu,checked:o,children:a.jsx(I5,{role:"menuitemradio","aria-checked":o,...n,ref:t,"data-state":FM(o),onSelect:jn(n.onSelect,()=>s.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});Kte.displayName=Gte;var LM="MenuItemIndicator",[Xte,HHe]=Ig(LM,{checked:!1}),Yte=p.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...s}=e,o=HHe(LM,r);return a.jsx(qc,{present:n||lS(o.checked)||o.checked===!0,children:a.jsx(sa.span,{...s,ref:t,"data-state":FM(o.checked)})})});Yte.displayName=LM;var GHe="MenuSeparator",Jte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return a.jsx(sa.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});Jte.displayName=GHe;var KHe="MenuArrow",Qte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=k5(r);return a.jsx(X4,{...s,...n,ref:t})});Qte.displayName=KHe;var XHe="MenuSub",[Qlt,Zte]=Ig(XHe),Iy="MenuSubTrigger",ere=p.forwardRef((e,t)=>{const r=Og(Iy,e.__scopeMenu),n=k1(Iy,e.__scopeMenu),s=Zte(Iy,e.__scopeMenu),o=DM(Iy,e.__scopeMenu),i=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=o,d={__scopeMenu:e.__scopeMenu},u=p.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return p.useEffect(()=>u,[u]),p.useEffect(()=>{const f=l.current;return()=>{window.clearTimeout(f),c(null)}},[l,c]),a.jsx(OM,{asChild:!0,...d,children:a.jsx(Ute,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":nre(r.open),...e,ref:dC(t,s.onTriggerChange),onClick:f=>{e.onClick?.(f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:jn(e.onPointerMove,Lw(f=>{o.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:jn(e.onPointerLeave,Lw(f=>{u();const h=r.content?.getBoundingClientRect();if(h){const m=r.content?.dataset.side,v=m==="right",g=v?-5:5,y=h[v?"left":"right"],x=h[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:f.clientX+g,y:f.clientY},{x:y,y:h.top},{x,y:h.top},{x,y:h.bottom},{x:y,y:h.bottom}],side:m}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(f),f.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:jn(e.onKeyDown,f=>{const h=o.searchRef.current!=="";e.disabled||h&&f.key===" "||EHe[n.dir].includes(f.key)&&(r.onOpenChange(!0),r.content?.focus(),f.preventDefault())})})})});ere.displayName=Iy;var tre="MenuSubContent",rre=p.forwardRef((e,t)=>{const r=$te(wd,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,o=Og(wd,e.__scopeMenu),i=k1(wd,e.__scopeMenu),l=Zte(tre,e.__scopeMenu),c=p.useRef(null),d=za(t,c);return a.jsx(Rw.Provider,{scope:e.__scopeMenu,children:a.jsx(qc,{present:n||o.open,children:a.jsx(Rw.Slot,{scope:e.__scopeMenu,children:a.jsx(MM,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:d,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{i.isUsingKeyboardRef.current&&c.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:jn(e.onFocusOutside,u=>{u.target!==l.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:jn(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:jn(e.onKeyDown,u=>{const f=u.currentTarget.contains(u.target),h=kHe[i.dir].includes(u.key);f&&h&&(o.onOpenChange(!1),l.trigger?.focus(),u.preventDefault())})})})})})});rre.displayName=tre;function nre(e){return e?"open":"closed"}function lS(e){return e==="indeterminate"}function FM(e){return lS(e)?"indeterminate":e?"checked":"unchecked"}function YHe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function JHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function QHe(e,t,r){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,o=r?e.indexOf(r):-1;let i=JHe(e,Math.max(o,0));s.length===1&&(i=i.filter(d=>d!==r));const c=i.find(d=>d.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function ZHe(e,t){const{x:r,y:n}=e;let s=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const l=t[o],c=t[i],d=l.x,u=l.y,f=c.x,h=c.y;u>n!=h>n&&r<(f-d)*(n-u)/(h-u)+d&&(s=!s)}return s}function eGe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return ZHe(r,t)}function Lw(e){return t=>t.pointerType==="mouse"?e(t):void 0}var tGe=Fte,rGe=OM,nGe=Bte,aGe=qte,sGe=RM,oGe=zte,iGe=I5,lGe=Vte,cGe=Hte,dGe=Kte,uGe=Yte,fGe=Jte,mGe=Qte,hGe=ere,pGe=rre,O5="DropdownMenu",[gGe,Zlt]=Ed(O5,[Rte]),Pl=Rte(),[vGe,are]=gGe(O5),sre=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:s,defaultOpen:o,onOpenChange:i,modal:l=!0}=e,c=Pl(t),d=p.useRef(null),[u,f]=Kf({prop:s,defaultProp:o??!1,onChange:i,caller:O5});return a.jsx(vGe,{scope:t,triggerId:su(),triggerRef:d,contentId:su(),open:u,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(h=>!h),[f]),modal:l,children:a.jsx(tGe,{...c,open:u,onOpenChange:f,dir:n,modal:l,children:r})})};sre.displayName=O5;var ore="DropdownMenuTrigger",ire=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=e,o=are(ore,r),i=Pl(r);return a.jsx(rGe,{asChild:!0,...i,children:a.jsx(sa.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:dC(t,o.triggerRef),onPointerDown:jn(e.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(o.onOpenToggle(),o.open||l.preventDefault())}),onKeyDown:jn(e.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&o.onOpenToggle(),l.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});ire.displayName=ore;var xGe="DropdownMenuPortal",lre=e=>{const{__scopeDropdownMenu:t,...r}=e,n=Pl(t);return a.jsx(nGe,{...n,...r})};lre.displayName=xGe;var cre="DropdownMenuContent",dre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=are(cre,r),o=Pl(r),i=p.useRef(!1);return a.jsx(aGe,{id:s.contentId,"aria-labelledby":s.triggerId,...o,...n,ref:t,onCloseAutoFocus:jn(e.onCloseAutoFocus,l=>{i.current||s.triggerRef.current?.focus(),i.current=!1,l.preventDefault()}),onInteractOutside:jn(e.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;(!s.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});dre.displayName=cre;var yGe="DropdownMenuGroup",bGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(sGe,{...s,...n,ref:t})});bGe.displayName=yGe;var wGe="DropdownMenuLabel",ure=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(oGe,{...s,...n,ref:t})});ure.displayName=wGe;var jGe="DropdownMenuItem",fre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(iGe,{...s,...n,ref:t})});fre.displayName=jGe;var _Ge="DropdownMenuCheckboxItem",mre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(lGe,{...s,...n,ref:t})});mre.displayName=_Ge;var NGe="DropdownMenuRadioGroup",SGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(cGe,{...s,...n,ref:t})});SGe.displayName=NGe;var CGe="DropdownMenuRadioItem",hre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(dGe,{...s,...n,ref:t})});hre.displayName=CGe;var AGe="DropdownMenuItemIndicator",pre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(uGe,{...s,...n,ref:t})});pre.displayName=AGe;var PGe="DropdownMenuSeparator",gre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(fGe,{...s,...n,ref:t})});gre.displayName=PGe;var EGe="DropdownMenuArrow",kGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(mGe,{...s,...n,ref:t})});kGe.displayName=EGe;var IGe="DropdownMenuSubTrigger",vre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(hGe,{...s,...n,ref:t})});vre.displayName=IGe;var OGe="DropdownMenuSubContent",xre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pl(r);return a.jsx(pGe,{...s,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});xre.displayName=OGe;var TGe=sre,DGe=ire,MGe=lre,yre=dre,bre=ure,wre=fre,jre=mre,_re=hre,Nre=pre,Sre=gre,Cre=vre,Are=xre;const lb=TGe,cb=DGe,RGe=Se.forwardRef(({className:e,inset:t,children:r,...n},s)=>a.jsxs(Cre,{ref:s,className:gr("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,a.jsx(c0,{className:"ml-auto h-4 w-4"})]}));RGe.displayName=Cre.displayName;const LGe=Se.forwardRef(({className:e,...t},r)=>a.jsx(Are,{ref:r,className:gr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));LGe.displayName=Are.displayName;const sx=Se.forwardRef(({className:e,sideOffset:t=4,...r},n)=>a.jsx(MGe,{children:a.jsx(yre,{ref:n,sideOffset:t,className:gr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));sx.displayName=yre.displayName;const gl=Se.forwardRef(({className:e,inset:t,...r},n)=>a.jsx(wre,{ref:n,className:gr("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));gl.displayName=wre.displayName;const FGe=Se.forwardRef(({className:e,children:t,checked:r,...n},s)=>a.jsxs(jre,{ref:s,className:gr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(Nre,{children:a.jsx(Uf,{className:"h-4 w-4"})})}),t]}));FGe.displayName=jre.displayName;const $Ge=Se.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(_re,{ref:n,className:gr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(Nre,{children:a.jsx(bue,{className:"h-2 w-2 fill-current"})})}),t]}));$Ge.displayName=_re.displayName;const wT=Se.forwardRef(({className:e,inset:t,...r},n)=>a.jsx(bre,{ref:n,className:gr("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));wT.displayName=bre.displayName;const Qj=Se.forwardRef(({className:e,...t},r)=>a.jsx(Sre,{ref:r,className:gr("-mx-1 my-1 h-px bg-muted",e),...t}));Qj.displayName=Sre.displayName;function aa(){try{const e=localStorage.getItem("auth:userProfile");if(e){const r=JSON.parse(e);if(r?.codigo_empresa)return r.codigo_empresa}const t=localStorage.getItem("auth:company");if(t){const r=JSON.parse(t);if(r?.codigo_empresa)return r.codigo_empresa;if(r?.codigo)return r.codigo}return typeof window<"u"&&window.__authProfile&&window.__authProfile.codigo_empresa?window.__authProfile.codigo_empresa:null}catch{return null}}async function Hm({somenteAtivas:e=!0,codigoEmpresa:t}={}){const r=t||aa();let n=he.from("finalizadoras").select("*").order("codigo_interno",{ascending:!0,nullsFirst:!1}).order("nome",{ascending:!0});r&&(n=n.eq("codigo_empresa",r)),e&&(n=n.eq("ativo",!0));const{data:s,error:o}=await n;if(o)throw o;const i=s||[];return i.sort((l,c)=>{const d=parseInt(l?.codigo_interno)||0,u=parseInt(c?.codigo_interno)||0;if(d!==u)return d-u;const f=(l?.nome||"").toLowerCase(),h=(c?.nome||"").toLowerCase();return f.localeCompare(h)}),i}async function BGe(e,t){const r=t||aa(),n={codigo_interno:e?.codigo_interno||null,codigo_sefaz:e?.codigo_sefaz||null,nome:(e?.nome||"").trim(),tipo:e?.tipo||"outros",ativo:e?.ativo??!0,taxa_percentual:e?.taxa_percentual==null?null:Number(e.taxa_percentual)};if(!n.nome)throw new Error("Nome  obrigatrio");r&&(n.codigo_empresa=r);const{data:s,error:o}=await he.from("finalizadoras").insert(n).select("*").single();if(o)throw o;return s}async function cS({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||aa();let n=he.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;const i=Array.isArray(s)?s[0]:s;if(!i)throw new Error("Sesso no encontrada");const l=i.aberto_em,c=i.fechado_em||new Date().toISOString(),d=await gd({from:l,to:c,codigoEmpresa:r});let u=0,f=0,h=0,m=0;try{let g=he.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",e);r&&(g=g.eq("codigo_empresa",r));const{data:y}=await g;for(const x of y||[]){const b=Number(x?.valor||0),w=String(x?.tipo||"").toLowerCase();w==="suprimento"?u+=b:w==="sangria"?f+=b:w==="ajuste"?h+=b:w==="troco"&&(m+=b)}}catch{}const v=u+h-f-m;return{...d,saldoInicial:Number(i.saldo_inicial||0),saldoFinal:i.saldo_final!=null?Number(i.saldo_final):null,movimentos:{suprimentos:u,sangrias:f,ajustes:h,troco:m,totalMovimentos:v}}}async function qGe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||aa(),s={codigo_interno:t?.codigo_interno||null,codigo_sefaz:t?.codigo_sefaz||null,nome:(t?.nome||"").trim(),tipo:t?.tipo||"outros",ativo:t?.ativo??!0,taxa_percentual:t?.taxa_percentual==null?null:Number(t.taxa_percentual)};if(!s.nome)throw new Error("Nome  obrigatrio");let o=he.from("finalizadoras").update(s).eq("id",e);n&&(o=o.eq("codigo_empresa",n));const{data:i,error:l}=await o.select("*").single();if(l)throw l;return i}async function zGe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||aa();let s=he.from("finalizadoras").update({ativo:!!t}).eq("id",e);n&&(s=s.eq("codigo_empresa",n));const{data:o,error:i}=await s.select("*").single();if(i)throw i;return o}async function $M({codigoEmpresa:e}={}){const t=e||aa();let r=he.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:s}=await r;if(s)throw s;if(!(Array.isArray(n)&&n.length>0)){const i=new Error(" necessrio abrir o caixa antes de criar comandas.");throw i.code="NO_OPEN_CASH_SESSION",i}return!0}async function jT(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||aa(),n=async i=>{let l=he.from("comanda_clientes").select(`comanda_id, cliente_id, nome_livre, clientes:clientes${i}(id, nome)`).in("comanda_id",e);return r&&(l=l.eq("codigo_empresa",r)),l};let s=[];try{const{data:i,error:l}=await n("!comanda_clientes_cliente_id_fkey");if(l)throw l;s=i||[]}catch{try{const{data:i,error:l}=await n("!fk_comanda_clientes_cliente");if(l)throw l;s=i||[]}catch{let i=he.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",e);r&&(i=i.eq("codigo_empresa",r));const{data:l}=await i;s=l||[]}}const o={};for(const i of s){const l=i.comanda_id,c=i.clientes?.nome||i.nome_livre||"";o[l]||(o[l]=[]),c&&o[l].push(c)}for(const i of Object.keys(o))o[i]=Array.from(new Set(o[i])).join(", ");return o}async function _T(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||aa();let n=he.from("pagamentos").select("comanda_id, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;const i={};for(const c of s||[]){if(!((c.status||"Pago")!=="Cancelado"&&(c.status||"Pago")!=="Estornado"))continue;const u=c.comanda_id,f=c?.finalizadoras?.nome||c.metodo||"Outros";i[u]||(i[u]=[]),i[u].push(f)}const l={};for(const[c,d]of Object.entries(i))d.length===0?l[c]="":d.length===1?l[c]=d[0]:l[c]=`${d[0]} +${d.length-1}`;return l}async function UGe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||aa();let n=he.from("comanda_itens").select("produto_id, quantidade").eq("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;const i=new Map;for(const m of s||[]){const v=m.produto_id,g=Number(m.quantidade||0);i.set(v,(i.get(v)||0)+g)}if(i.size===0)return!0;const l=Array.from(i.keys());let c=he.from("produtos").select("id, nome, estoque");c=c.in("id",l),r&&(c=c.eq("codigo_empresa",r));const{data:d,error:u}=await c;if(u)throw u;const f=new Map((d||[]).map(m=>[m.id,{nome:m.nome,estoque:Number(m.estoque||0)}])),h=[];for(const[m,v]of i.entries()){const g=f.get(m)||{nome:`Produto ${m}`,estoque:0};v>g.estoque&&h.push({id:m,name:g.nome,solicitado:v,estoque:g.estoque})}if(h.length>0){const m=h.map(g=>`${g.name}: solicitado ${g.solicitado}, estoque ${g.estoque}`).join("; "),v=new Error(`Estoque insuficiente para finalizar: ${m}`);throw v.code="INSUFFICIENT_STOCK_COMANDA",v.items=h,v}return!0}async function qv({codigoEmpresa:e}={}){const t=e||aa();let r=he.from("comandas").select("id,status,aberto_em").is("mesa_id",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:s}=await r;if(s)throw s;return n?.[0]||null}async function Zj({codigoEmpresa:e}={}){const t=e||aa();console.log("[getOrCreateComandaBalcao] Iniciando com codigo_empresa:",t),await $M({codigoEmpresa:t});const r=await qv({codigoEmpresa:t});if(r)return console.log("[getOrCreateComandaBalcao] Comanda existente encontrada:",r),r;const n={status:"open",mesa_id:null,aberto_em:new Date().toISOString()};console.log("[getOrCreateComandaBalcao] Criando nova comanda (codigo_empresa via DEFAULT):",n);const{data:s,error:o}=await he.from("comandas").insert(n).select("id,status,aberto_em,tipo,codigo_empresa").single();if(o)throw console.error("[getOrCreateComandaBalcao] ERRO ao criar comanda:",o),o;return console.log("[getOrCreateComandaBalcao] Comanda criada com sucesso:",s),console.log("[getOrCreateComandaBalcao] Codigo da comanda criada:",s?.codigo_empresa,"vs esperado:",t),await new Promise(i=>setTimeout(i,100)),s}async function lz({status:e,from:t,to:r,search:n="",limit:s=50,offset:o=0,codigoEmpresa:i}={}){const l=i||aa();let c=he.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").order("fechado_em",{ascending:!1,nullsFirst:!1}).order("aberto_em",{ascending:!1}).range(o,o+s-1);l&&(c=c.eq("codigo_empresa",l)),e&&Array.isArray(e)&&e.length?c=c.in("status",e):typeof e=="string"&&e!=="all"&&(e==="closed"?c=c.or("status.eq.closed,fechado_em.not.is.null").neq("status","cancelled"):c=c.eq("status",e));const d=y=>{if(!y)return null;if(typeof y=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(y)){const[x,b,w]=y.split("-").map(Number);return new Date(x,b-1,w,0,0,0,0)}return new Date(y)},u=y=>{if(!y)return null;if(typeof y=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(y)){const[x,b,w]=y.split("-").map(Number);return new Date(x,b-1,w,23,59,59,999)}return new Date(y)},f=d(t),h=u(r);f&&(c=c.gte("aberto_em",f.toISOString())),h&&(c=c.lte("aberto_em",h.toISOString()));const m=(n||"").trim();if(m){const y=/^\d+$/.test(m);if(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(m)){const b=he.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("id",m).eq("codigo_empresa",l),w=he.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("mesa_id",m).eq("codigo_empresa",l),[j,_]=await Promise.all([b,w]),C=j.data||[],P=_.data||[],E=[...C,...P];return Array.from(new Map(E.map(F=>[F.id,F])).values()).sort((F,D)=>new Date(D.fechado_em||D.aberto_em)-new Date(F.fechado_em||F.aberto_em))}else y?c=c.or(`id.eq.${m},status.ilike.%${m}%`):c=c.or(`status.ilike.%${m}%`)}const{data:v,error:g}=await c;if(g)throw g;return v||[]}async function gd({from:e,to:t,codigoEmpresa:r}={}){const n="[listarResumoPeriodo]",s=r||aa();console.log(`${n} Iniciando consulta`),console.log(`${n} Perodo: ${e||"SEM from"} at ${t||"SEM to"}`),console.log(`${n} codigo_empresa: ${s}`);let o=[];try{let h=he.from("comandas").select("id, fechado_em").eq("status","closed");s&&(h=h.eq("codigo_empresa",s)),e&&(h=h.gte("fechado_em",new Date(e).toISOString())),t&&(h=h.lte("fechado_em",new Date(t).toISOString()));const{data:m,error:v}=await h;if(v)throw v;o=m||[]}catch{o=[]}const i=(o||[]).map(h=>h.id);let l=0,c=0;if(i.length>0)try{let h=he.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",i);s&&(h=h.eq("codigo_empresa",s));const{data:m,error:v}=await h;if(v)throw v;for(const g of m||[]){const y=Number(g.quantidade||0)*Number(g.preco_unitario||0),x=Number(g.desconto||0);l+=y,c+=x}}catch{}const d=Math.max(0,l-c),u={};let f=0;try{let h=he.from("pagamentos").select("metodo, valor, recebido_em, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)");s&&(h=h.eq("codigo_empresa",s)),e&&(h=h.gte("recebido_em",new Date(e).toISOString())),t&&(h=h.lte("recebido_em",new Date(t).toISOString())),console.log(`${n} Consultando pagamentos de comandas...`);const{data:m,error:v}=await h;if(v)throw console.error(`${n}  Erro ao buscar pagamentos:`,v),v;console.log(`${n} Total de pagamentos de comandas encontrados: ${(m||[]).length}`);for(const g of m||[]){if(!((g.status||"Pago")!=="Cancelado"&&(g.status||"Pago")!=="Estornado"))continue;const x=g.finalizadoras?.nome||g.metodo||"outros",b=Number(g.valor||0);u[x]=(u[x]||0)+b,f+=b}console.log(`${n}  Resumo comandas por finalizadora:`,u)}catch(h){console.error(`${n}  Exception ao processar pagamentos de comandas:`,h)}try{let h=he.from("agendamentos").select("id, inicio");s&&(h=h.eq("codigo_empresa",s)),e&&(h=h.gte("inicio",new Date(e).toISOString())),t&&(h=h.lte("inicio",new Date(t).toISOString())),console.log(`${n} Consultando agendamentos no perodo...`);const{data:m,error:v}=await h;if(v)throw console.error(`${n}  Erro ao buscar agendamentos:`,v),v;if(console.log(`${n} Total de agendamentos encontrados: ${(m||[]).length}`),m&&m.length>0){const g=m.map(w=>w.id);let y=he.from("agendamento_participantes").select("valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(nome, taxa_percentual)").in("agendamento_id",g).eq("status_pagamento","Pago");s&&(y=y.eq("codigo_empresa",s)),console.log(`${n} Consultando participantes pagos...`);const{data:x,error:b}=await y;if(b)throw console.error(`${n}  Erro ao buscar participantes:`,b),b;console.log(`${n} Total de participantes pagos encontrados: ${(x||[]).length}`);for(const w of x||[]){const j=w.finalizadoras?.nome||"Outros";let _=Number(w.valor_cota||0);if(w.aplicar_taxa===!0){const C=Number(w.finalizadoras?.taxa_percentual||0);C>0&&(_=_/(1+C/100),console.log(`${n}  Participante com taxa: valor_cota=${w.valor_cota}, taxa=${C}%, valor_real=${_.toFixed(2)}`))}u[j]=(u[j]||0)+_,f+=_}console.log(`${n}  Resumo agendamentos por finalizadora:`,u)}}catch(h){console.error(`${n}  Exception ao processar pagamentos de agendamentos:`,h)}return console.log(`${n}  RESUMO FINAL por finalizadora:`,u),console.log(`${n} Total de entradas: R$ ${f.toFixed(2)}`),{from:e?new Date(e).toISOString():null,to:t?new Date(t).toISOString():null,totalPorFinalizadora:u,totalEntradas:f,totalVendasBrutas:l,totalDescontos:c,totalVendasLiquidas:d}}async function Fw({codigoEmpresa:e}={}){const t=e||aa();let r=null;try{let s=he.from("caixa_sessoes").select("aberto_em").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(s=s.eq("codigo_empresa",t));const{data:o,error:i}=await s;if(i)throw i;r=o?.[0]?.aberto_em||null}catch{}if(!r)return null;const n=new Date().toISOString();return gd({from:r,to:n,codigoEmpresa:t})}async function Pre({comandaId:e,codigoEmpresa:t}={}){const r=t||aa();let n=he.from("pagamentos").select("*, finalizadoras!pagamentos_finalizadora_id_fkey(id, nome, codigo_sefaz, codigo_interno)").order("recebido_em",{ascending:!0});e&&(n=n.eq("comanda_id",e)),r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;return s||[]}async function db({searchTerm:e="",limit:t=20,codigoEmpresa:r}={}){const n=r||aa();let s=he.from("clientes").select("*").eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0}).limit(t);n&&(s=s.eq("codigo_empresa",n));const o=(e||"").trim();o&&(/^\d+$/.test(o)?s=s.or(`codigo.eq.${o},nome.ilike.%${o}%,email.ilike.%${o}%,telefone.ilike.%${o}%`):s=s.or(`nome.ilike.%${o}%,email.ilike.%${o}%,telefone.ilike.%${o}%`));const{data:i,error:l}=await s;if(l)throw l;return i||[]}async function jc({codigoEmpresa:e}={}){const t="[listarComandasAbertas]",r=e||aa(),n=async()=>{const s=new Promise((c,d)=>setTimeout(()=>d(new Error("listarComandasAbertas timeout aps 30s")),3e4));let o=he.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, observacoes, observacoes_atualizadas_em").is("fechado_em",null).neq("status","cancelled").order("aberto_em",{ascending:!1}).limit(500);r&&(o=o.eq("codigo_empresa",r));const{data:i,error:l}=await Promise.race([o,s]);if(l)throw l;return i||[]};try{try{return await n()}catch(s){if(String(s?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw s}}catch(s){return console.error(`${t}  EXCEPTION:`,s?.message||s),[]}}async function dS(e=[],t){if(!e||e.length===0)return{};const r=t||aa();let n=he.from("comanda_itens").select("comanda_id, quantidade, preco_unitario").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;const i={};for(const l of s||[]){const c=l.comanda_id,d=Number(l.quantidade||0)*Number(l.preco_unitario||0);i[c]=(i[c]||0)+d}return i}async function Gm(e){const t="[listMesas]",r=e||aa(),n=async()=>{const s=new Promise((c,d)=>setTimeout(()=>d(new Error("listMesas timeout aps 30s")),3e4));let o=he.from("mesas").select("id, numero, nome, status").order("numero",{ascending:!0}).limit(200);r&&(o=o.eq("codigo_empresa",r));const{data:i,error:l}=await Promise.race([o,s]);if(l)throw l;return i||[]};try{try{return await n()}catch(s){if(String(s?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw s}}catch(s){return console.error(`${t}  EXCEPTION:`,s?.message||s),[]}}async function VGe({comandaId:e,status:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");let n=he.from("pagamentos").select("*").eq("comanda_id",e);t&&(n=n.eq("status",t)),n=n.order("created_at",{ascending:!0});const{data:s,error:o}=await n;if(o)throw o;return s||[]}async function sj({comandaId:e,linhas:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const n=r||aa();if(Array.isArray(t)){await he.from("pagamentos").delete().eq("comanda_id",e).eq("status","Pendente");for(const s of t){const o=Number(s?.valor||0);if(o<=0)continue;const i=s?.metodo||s?.metodoNome||"outros";await BM({comandaId:e,finalizadoraId:s?.finalizadoraId||s?.methodId||null,metodo:i,valor:o,status:"Pendente",codigoEmpresa:n,clienteId:s?.clienteId||s?.clientId||null})}}}async function WGe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||aa();let n=he.from("pagamentos").update({status:"Pago",recebido_em:new Date().toISOString()}).eq("comanda_id",e).eq("status","Pendente");r&&(n=n.eq("codigo_empresa",r));const{error:s}=await n;if(s)throw s;return!0}async function HGe({numero:e,nome:t,codigoEmpresa:r}={}){const n=r||aa();let s=e;if(!s){let i=he.from("mesas").select("numero").order("numero",{ascending:!1}).limit(1);n&&(i=i.eq("codigo_empresa",n));const{data:l,error:c}=await i;if(c)throw c;s=(l?.[0]?.numero||0)+1}const o={numero:s,status:"available"};t&&typeof t=="string"&&t.trim()&&(o.nome=t.trim()),n&&(o.codigo_empresa=n);try{const{data:i,error:l}=await he.from("mesas").insert(o).select("*").single();if(l)throw l;return i}catch(i){const l=String(i?.message||i||"");if(/column\s+\"?nome\"?\s+of\s+relation/i.test(l)||/column\s+\"?nome\"?\s+does not exist/i.test(l)){const c={numero:s,status:"available"};n&&(c.codigo_empresa=n);const{data:d,error:u}=await he.from("mesas").insert(c).select("*").single();if(u)throw u;return d}throw i}}async function Sf({saldoInicial:e=0,codigoEmpresa:t}={}){const r=t||aa();let n=he.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;if(s&&s.length>0){const d=s[0];try{const u=new Date(d.aberto_em),f=new Date;if(u.toDateString()!==f.toDateString()){try{const b=await jc({codigoEmpresa:r});if(Array.isArray(b)&&b.length>0)return console.warn("[ensureCaixaAberto] Sesso de dia anterior detectada, mas h comandas abertas. No fechar automaticamente."),d}catch{}const m=f.toISOString();let v=0,g=0;try{const b=await gd({from:d.aberto_em,to:m,codigoEmpresa:r});v=Number(b?.totalEntradas||0)}catch{}try{let b=he.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",d.id);r&&(b=b.eq("codigo_empresa",r));const{data:w}=await b;for(const j of w||[]){const _=Number(j?.valor||0),C=String(j?.tipo||"").toLowerCase();C==="suprimento"||C==="ajuste"?g+=_:(C==="sangria"||C==="troco")&&(g-=_)}}catch{}const y=Number(d?.saldo_inicial||0)+v+g;let x=he.from("caixa_sessoes").update({status:"closed",saldo_final:y,fechado_em:m}).eq("id",d.id).eq("status","open");r&&(x=x.eq("codigo_empresa",r)),await x;try{const b=await cS({caixaSessaoId:d.id,codigoEmpresa:r}).catch(async()=>await gd({from:d.aberto_em,to:m,codigoEmpresa:r})),w={codigo_empresa:r||aa(),caixa_sessao_id:d.id,periodo_de:b?.from||d.aberto_em,periodo_ate:b?.to||m,total_bruto:Number(b?.totalVendasBrutas||0),total_descontos:Number(b?.totalDescontos||0),total_liquido:Number(b?.totalVendasLiquidas||0),total_entradas:Number(b?.totalEntradas||0),por_finalizadora:b?.totalPorFinalizadora||{}},j=w.por_finalizadora;await he.from("caixa_resumos").insert({...w,por_finalizadora:j&&typeof j!="string"?JSON.stringify(j):j})}catch{}}else{try{if(d?.saldo_inicial==null&&e!=null){let m=he.from("caixa_sessoes").update({saldo_inicial:Number(e)||0}).eq("id",d.id);return r&&(m=m.eq("codigo_empresa",r)),await m,{...d,saldo_inicial:Number(e)||0}}}catch{}return d}}catch{}return d}const i={status:"open",saldo_inicial:e};r&&(i.codigo_empresa=r);const{data:l,error:c}=await he.from("caixa_sessoes").insert(i).select("id,status,aberto_em").single();if(c)throw c;return l}async function Km({codigoEmpresa:e}={}){const t=e||aa();let r=he.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:s}=await r;if(s)throw s;return n?.[0]||null}async function Ere({saldoFinal:e=null,valorFinalDinheiro:t=null,codigoEmpresa:r}={}){console.log("[fecharCaixa] Iniciando fechamento:",{valorFinalDinheiro:t,saldoFinal:e,codigoEmpresa:r});const n=r||aa();try{console.log("[fecharCaixa]  Limpeza preventiva: ajustando apenas comandas cancelled/closed sem fechado_em...");const{data:x}=await he.from("comandas").select("id, status, fechado_em").eq("codigo_empresa",n).is("fechado_em",null).in("status",["cancelled","closed"]);if(x&&x.length>0){console.log(`[fecharCaixa]  Encontradas ${x.length} comandas (cancelled/closed) sem fechado_em, ajustando...`);const b=new Date().toISOString();for(const w of x)try{await he.from("comandas").update({fechado_em:b}).eq("id",w.id).eq("codigo_empresa",n),console.log(`[fecharCaixa]  Comanda ${w.id} (status: ${w.status}) ajustada com fechado_em`)}catch{}}else console.log("[fecharCaixa]  Nenhuma comanda cancelled/closed sem fechado_em encontrada")}catch(x){console.warn("[fecharCaixa]  Erro na limpeza preventiva:",x?.message)}try{let x=await jc({codigoEmpresa:n});if(x=x||[],console.log(`[fecharCaixa]  Comandas abertas encontradas: ${x.length}`,x.map(w=>({id:w.id,status:w.status,mesa:w.mesa_id}))),x&&x.length>0){const w=x.map(j=>`${j.id}${j.mesa_id?`@mesa:${j.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${x.length} comanda(s) aberta(s). Feche todas as comandas antes de encerrar o caixa.`)}let b=0;for(;b<12&&(x=await jc({codigoEmpresa:n}),!(!x||x.length===0));)await new Promise(w=>setTimeout(w,250)),b++;if(x&&x.length>0){const w=x.map(P=>P.id);let j=new Map,_=new Map;try{if(w.length>0){let P=he.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",w);n&&(P=P.eq("codigo_empresa",n));const{data:E}=await P;j=new Map;for(const A of E||[]){const F=A.comanda_id,D=Number(A.quantidade||0);j.set(F,(j.get(F)||0)+D)}}}catch{}try{if(w.length>0){let P=he.from("pagamentos").select("comanda_id, status").in("comanda_id",w);n&&(P=P.eq("codigo_empresa",n));const{data:E}=await P;_=new Map;for(const A of E||[]){const F=String(A?.status||"Pago");if(F==="Cancelado"||F==="Estornado")continue;const D=A.comanda_id;_.set(D,(_.get(D)||0)+1)}}}catch{}for(const P of x){const E=Number(j.get(P.id)||0)>0,A=Number(_.get(P.id)||0)>0;if(!E&&!A)try{await Jx({comandaId:P.id,codigoEmpresa:n})}catch{}}let C=await jc({codigoEmpresa:n});if(C=C||[],C.length>0){const P=C.map(D=>D.id);let E=new Map,A=new Map;try{if(P.length>0){let D=he.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",P);n&&(D=D.eq("codigo_empresa",n));const{data:I}=await D;E=new Map;for(const R of I||[]){const M=R.comanda_id,U=Number(R.quantidade||0);E.set(M,(E.get(M)||0)+U)}}}catch{}try{if(P.length>0){let D=he.from("pagamentos").select("comanda_id, status").in("comanda_id",P);n&&(D=D.eq("codigo_empresa",n));const{data:I}=await D;A=new Map;for(const R of I||[]){const M=String(R?.status||"Pago");if(M==="Cancelado"||M==="Estornado")continue;const U=R.comanda_id;A.set(U,(A.get(U)||0)+1)}}}catch{}const F=C.filter(D=>Number(E.get(D.id)||0)>0||Number(A.get(D.id)||0)>0);if(F.length>0){const D=F.map(I=>`${I.id}${I.mesa_id?`@mesa:${I.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${F.length} comandas abertas. IDs: ${D}. Feche todas antes de encerrar o caixa.`)}}}}catch(x){if(x&&/Existem \d+ comandas/.test(x.message||""))throw x;const b=new Error("Falha ao validar comandas abertas. Tente novamente e verifique sua conexo.");throw b.code="CASH_CLOSE_VALIDATION_FAILED",b}let s=he.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);n&&(s=s.eq("codigo_empresa",n));const{data:o,error:i}=await s;if(i)throw i;const l=o?.[0]?.id||null,c=o?.[0]?.aberto_em||null,d=Number(o?.[0]?.saldo_inicial||0);if(!l)throw new Error("Nenhuma sesso de caixa aberta encontrada.");const u=new Date().toISOString();let f=0,h=0;try{const x=await gd({from:c,to:u,codigoEmpresa:n});f=Number(x?.totalEntradas||0)}catch{}try{let x=he.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",l);n&&(x=x.eq("codigo_empresa",n));const{data:b}=await x;for(const w of b||[]){const j=Number(w?.valor||0),_=String(w?.tipo||"").toLowerCase();_==="suprimento"||_==="ajuste"?h+=j:(_==="sangria"||_==="troco")&&(h-=j)}}catch{}const m=e!=null?Number(e):d+f+h;try{let x=await jc({codigoEmpresa:n});if(x=x||[],x.length>0){const b=x.map(C=>C.id);let w=new Map,j=new Map;try{if(b.length>0){let C=he.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",b);n&&(C=C.eq("codigo_empresa",n));const{data:P}=await C;w=new Map;for(const E of P||[]){const A=E.comanda_id,F=Number(E.quantidade||0);w.set(A,(w.get(A)||0)+F)}}}catch{}try{if(b.length>0){let C=he.from("pagamentos").select("comanda_id, status").in("comanda_id",b);n&&(C=C.eq("codigo_empresa",n));const{data:P}=await C;j=new Map;for(const E of P||[]){const A=String(E?.status||"Pago");if(A==="Cancelado"||A==="Estornado")continue;const F=E.comanda_id;j.set(F,(j.get(F)||0)+1)}}}catch{}for(const C of x){const P=Number(w.get(C.id)||0)>0,E=Number(j.get(C.id)||0)>0;if(!P&&!E)try{await Jx({comandaId:C.id,codigoEmpresa:n})}catch{}}let _=await jc({codigoEmpresa:n});if(_=_||[],_.length>0){const C=_.map(P=>`${P.id}${P.mesa_id?`@mesa:${P.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${_.length} comandas abertas. IDs: ${C}. Feche todas antes de encerrar o caixa.`)}}}catch(x){if(!(x&&x.message)){const b=new Error("Falha ao validar comandas abertas no momento do fechamento. Tente novamente.");throw b.code="CASH_CLOSE_FINAL_CHECK_FAILED",b}throw x}let v=he.from("caixa_sessoes").update({status:"closed",saldo_final:m,fechado_em:u}).eq("id",l).eq("status","open");n&&(v=v.eq("codigo_empresa",n));const{data:g,error:y}=await v.select("id,status,fechado_em,saldo_final").single();if(y){const x=String(y.message||"");if(x.toLowerCase().includes("row")||x.toLowerCase().includes("single")){let b=he.from("caixa_sessoes").select("id,status,fechado_em,saldo_final").eq("id",l).limit(1);n&&(b=b.eq("codigo_empresa",n));const{data:w}=await b;if(w&&w[0])return w[0]}throw y}try{if(c&&u&&g?.status==="closed"){let x;try{x=await cS({caixaSessaoId:l,codigoEmpresa:n})}catch{x=await gd({from:c,to:u,codigoEmpresa:n})}const b={codigo_empresa:n||aa(),caixa_sessao_id:l,periodo_de:x?.from||c,periodo_ate:x?.to||u,total_bruto:Number(x?.totalVendasBrutas||0),total_descontos:Number(x?.totalDescontos||0),total_liquido:Number(x?.totalVendasLiquidas||0),total_entradas:Number(x?.totalEntradas||0),por_finalizadora:x?.totalPorFinalizadora||{}},w=t!=null?Number(t):null,j=w!=null?w-Number(m||0):null;console.log("[fecharCaixa] Valores para snapshot:",{contado:w,diferenca:j,efetivoSaldoFinal:m,valorFinalDinheiroOriginal:t});const C=await(async P=>{const E={...P},A=E.por_finalizadora;A&&typeof A!="string"&&(E.por_finalizadora=JSON.stringify(A));let F=!0,D=!0;try{const W=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),$=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");W==="no"&&(F=!1),$==="no"&&(D=!1)}catch{}if(!F||!D)try{let W=he.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:$}=await W;if(!$){F=!0,D=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}if(!F&&!D)return await he.from("caixa_resumos").insert(E);let I={...E};F&&w!=null&&(I.valor_final_dinheiro=w),D&&j!=null&&(I.diferenca_dinheiro=j),console.log("[fecharCaixa] Tentando inserir snapshot com:",{supportValor:F,supportDif:D,contado:w,diferenca:j,hasValorFinalDinheiro:"valor_final_dinheiro"in I});const R=await he.from("caixa_resumos").insert(I);if(!R.error)return R;const M=`${R.error?.message||""} ${R.error?.details||""}`.toLowerCase(),U=R.error?.code;if(U==="42703"||U==="PGRST204"||M.includes("column")||M.includes("schema cache")){try{I.valor_final_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),I.diferenca_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}return await he.from("caixa_resumos").insert(E)}return R})(b);if(C.error)throw console.error("[fecharCaixa] Erro ao inserir snapshot:",C.error),C.error;console.log("[fecharCaixa]  Snapshot inserido com sucesso");try{const{data:P}=await he.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").eq("caixa_sessao_id",l).order("criado_em",{ascending:!1}).limit(1).single();console.log("[fecharCaixa] Verificao ps-insert:",P)}catch(P){console.warn("[fecharCaixa] Falha ao verificar snapshot:",P?.message)}}}catch(x){console.warn("[fecharCaixa] Falha ao gravar snapshot de fechamento:",x)}try{let x=he.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open");n&&(x=x.eq("codigo_empresa",n));const{data:b}=await x;if(Array.isArray(b)&&b.length>0)for(const w of b)try{const j=w?.aberto_em,_=Number(w?.saldo_inicial||0),C=new Date().toISOString();let P=0,E=0;try{const F=await gd({from:j,to:C,codigoEmpresa:n});P=Number(F?.totalEntradas||0)}catch{}try{let F=he.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",w.id);n&&(F=F.eq("codigo_empresa",n));const{data:D}=await F;for(const I of D||[]){const R=Number(I?.valor||0),M=String(I?.tipo||"").toLowerCase();M==="suprimento"||M==="ajuste"?E+=R:(M==="sangria"||M==="troco")&&(E-=R)}}catch{}const A=_+P+E;await he.from("caixa_sessoes").update({status:"closed",saldo_final:A,fechado_em:C}).eq("id",w.id).eq("status","open").eq(n?"codigo_empresa":"id",n||w.id);try{const F=await cS({caixaSessaoId:w.id,codigoEmpresa:n}).catch(async()=>await gd({from:j,to:C,codigoEmpresa:n})),D={codigo_empresa:n||aa(),caixa_sessao_id:w.id,periodo_de:F?.from||j,periodo_ate:F?.to||C,total_bruto:Number(F?.totalVendasBrutas||0),total_descontos:Number(F?.totalDescontos||0),total_liquido:Number(F?.totalVendasLiquidas||0),total_entradas:Number(F?.totalEntradas||0),por_finalizadora:F?.totalPorFinalizadora||{}},I=D.por_finalizadora;await he.from("caixa_resumos").insert({...D,por_finalizadora:I&&typeof I!="string"?JSON.stringify(I):I})}catch{}}catch(j){try{console.warn("[fecharCaixa] Saneamento: falhou ao fechar sesso remanescente",w?.id,j?.message||j)}catch{}}}catch{}return g}async function kre({from:e,to:t,limit:r=50,codigoEmpresa:n}={}){console.log("[listarFechamentosCaixa] Iniciando busca de fechamentos",{from:e,to:t,limit:r});const s=n||aa();let o=he.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final, status").eq("status","closed").order("fechado_em",{ascending:!1}).limit(r);s&&(o=o.eq("codigo_empresa",s)),e&&(o=o.gte("fechado_em",`${e}T00:00:00`)),t&&(o=o.lte("fechado_em",`${t}T23:59:59`));const{data:i,error:l}=await o;if(l)throw l;const c=Array.isArray(i)?i:[];if(console.log("[listarFechamentosCaixa] Sesses fechadas encontradas:",c.length),c.length===0)return[];const d=c.map(m=>m.id);let u=[];try{let m=!0,v=!0;try{const j=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),_=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");j==="no"&&(m=!1),_==="no"&&(v=!1)}catch{}if(!m||!v)try{let j=he.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:_}=await j;if(!_){m=!0,v=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const g=["caixa_sessao_id"];m&&g.push("valor_final_dinheiro"),v&&g.push("diferenca_dinheiro");const y=g.join(", ");let x=he.from("caixa_resumos").select(y).in("caixa_sessao_id",d).order("criado_em",{ascending:!1});s&&(x=x.eq("codigo_empresa",s));let{data:b,error:w}=await x;if(w){const j=w?.code,_=`${w?.message||""} ${w?.details||""}`.toLowerCase();if(j==="42703"||j==="PGRST204"||_.includes("column")||_.includes("schema cache")){try{m&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),v&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let P=he.from("caixa_resumos").select("caixa_sessao_id").in("caixa_sessao_id",d).order("criado_em",{ascending:!1});s&&(P=P.eq("codigo_empresa",s));const{data:E}=await P;u=E||[]}else throw w}else u=b||[]}catch(m){console.warn("[listarFechamentosCaixa] Erro ao buscar snapshots:",m?.message),u=[]}console.log("[listarFechamentosCaixa] Snapshots encontrados:",u.length,u);const f=new Map(u.map(m=>[m.caixa_sessao_id,m])),h=c.map(m=>{const v=f.get(m.id),g={...m,valor_final_dinheiro:v?.valor_final_dinheiro??null,diferenca_dinheiro:v?.diferenca_dinheiro??null};return v&&console.log(`[listarFechamentosCaixa] Sesso ${m.id} enriquecida com snapshot:`,{valor_final_dinheiro:v.valor_final_dinheiro,diferenca_dinheiro:v.diferenca_dinheiro}),g});return console.log("[listarFechamentosCaixa] Resultado final:",h.length,"sesses com dados enriquecidos"),h}async function uS({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||aa();let n=null;try{let s=!0,o=!0;try{const f=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),h=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");f==="no"&&(s=!1),h==="no"&&(o=!1)}catch{}if(!s||!o)try{let f=he.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:h}=await f;if(!h){s=!0,o=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const i=["caixa_sessao_id","periodo_de","periodo_ate","total_bruto","total_descontos","total_liquido","total_entradas","por_finalizadora"];s&&i.push("valor_final_dinheiro"),o&&i.push("diferenca_dinheiro");const l=i.join(", ");let c=he.from("caixa_resumos").select(l).eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(c=c.eq("codigo_empresa",r));let{data:d,error:u}=await c;if(u){const f=u?.code,h=`${u?.message||""} ${u?.details||""}`.toLowerCase();if(f==="42703"||f==="PGRST204"||h.includes("column")||h.includes("schema cache")){try{s&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),o&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let v=he.from("caixa_resumos").select("caixa_sessao_id, periodo_de, periodo_ate, total_bruto, total_descontos, total_liquido, total_entradas, por_finalizadora").eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(v=v.eq("codigo_empresa",r));const{data:g}=await v;n=g?.[0]||null}else throw u}else n=d?.[0]||null}catch(s){try{console.warn("[getCaixaResumo] Snapshot select falhou, usando fallback dinmico:",s?.message||s)}catch{}}if(!n||typeof n.saldo_inicial>"u"||typeof n.saldo_final>"u"){const s=await cS({caixaSessaoId:e,codigoEmpresa:r});let o=null;try{let i=he.from("caixa_sessoes").select("saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(i=i.eq("codigo_empresa",r));const{data:l}=await i;o=l?.[0]||null}catch{}n={codigo_empresa:r,caixa_sessao_id:e,periodo_de:s?.from||null,periodo_ate:s?.to||null,total_bruto:Number(s?.totalVendasBrutas||0),total_descontos:Number(s?.totalDescontos||0),total_liquido:Number(s?.totalVendasLiquidas||0),total_entradas:Number(s?.totalEntradas||0),por_finalizadora:s?.totalPorFinalizadora||{},saldo_inicial:Number(o?.saldo_inicial??s?.saldoInicial??0),saldo_final:o?.saldo_final!=null?Number(o.saldo_final):null,movimentos:s?.movimentos||{suprimentos:0,sangrias:0,ajustes:0,troco:0,totalMovimentos:0}}}else if(typeof n.por_finalizadora=="string")try{n.por_finalizadora=JSON.parse(n.por_finalizadora)}catch{n.por_finalizadora={}}return n}async function NT({tipo:e,valor:t,observacao:r="",caixaSessaoId:n,codigoEmpresa:s}={}){const o=s||aa();if(!e||!["sangria","suprimento","troco","ajuste"].includes(e))throw new Error("Tipo invlido de movimentao");let i=n;if(!i){let u=he.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);o&&(u=u.eq("codigo_empresa",o));const{data:f,error:h}=await u;if(h)throw h;i=f?.[0]?.id||null}if(!i)throw new Error("Sesso de caixa no encontrada para registrar movimentao");const l={codigo_empresa:o,caixa_sessao_id:i,tipo:e,valor:Math.max(0,Number(t)||0),observacao:(r||"").trim()||null},{data:c,error:d}=await he.from("caixa_movimentacoes").insert(l).select("*").single();if(d)throw d;return c}async function Wp({caixaSessaoId:e,codigoEmpresa:t}={}){const r=t||aa();if(!e)throw new Error("caixaSessaoId  obrigatrio");let n=he.from("caixa_movimentacoes").select("*").eq("caixa_sessao_id",e).order("criado_em",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;return s||[]}async function GGe({mesaId:e,codigoEmpresa:t}={}){const r=t||aa();await $M({codigoEmpresa:r}),console.log(`[abrirComandaParaMesa] Iniciando para mesaId: ${e}, codigo_empresa: ${r}`);try{const n={status:"open",aberto_em:new Date().toISOString()};e&&(n.mesa_id=e),console.log("[abrirComandaParaMesa] Payload (codigo_empresa via DEFAULT):",n);const{data:s,error:o}=await he.from("comandas").insert(n).select("*").single();if(o)throw console.error("[abrirComandaParaMesa] ERRO ao criar comanda:",o),o;return console.log("[abrirComandaParaMesa]  Comanda criada:",s),await new Promise(i=>setTimeout(i,100)),s}catch(n){throw console.error("[abrirComandaParaMesa] ERRO:",n),n}}async function KGe({mesaId:e,codigoEmpresa:t}){const r=t||aa();let n=he.from("comandas").select("id,status,aberto_em,fechado_em").eq("mesa_id",e).is("fechado_em",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;return s?.[0]||null}async function uo({comandaId:e,codigoEmpresa:t}){const r=t||aa();let n=he.from("comanda_itens").select("*").eq("comanda_id",e).order("created_at",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;return s||[]}async function Lm({codigoEmpresa:e}){const t=e||aa();let r=he.from("comandas").select("id").is("fechado_em",null);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:s}=await r;if(s)throw s;if(console.log("[listarItensDeTodasComandasAbertas] Comandas abertas:",n?.length||0,"IDs:",n?.map(d=>d.id)),!n||n.length===0)return console.log("[listarItensDeTodasComandasAbertas] Nenhuma comanda aberta encontrada"),[];const o=n.map(d=>d.id);let i=he.from("comanda_itens").select("produto_id, quantidade").in("comanda_id",o);t&&(i=i.eq("codigo_empresa",t));const{data:l,error:c}=await i;if(c)throw c;return console.log("[listarItensDeTodasComandasAbertas] Itens encontrados:",l?.length||0),l&&l.length>0&&console.log("[listarItensDeTodasComandasAbertas] Detalhes dos itens:",l),l||[]}const oj=new Map;async function XGe({mesaId:e,codigoEmpresa:t}={}){const r=`${e}:${t||aa()}`;if(oj.has(r))return console.log(`[getOrCreateComandaForMesa]  Operao j em andamento para mesa ${e}, aguardando...`),oj.get(r);const n=t||aa(),s=(async()=>{try{await $M({codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Criando nova comanda para mesa ${e}`);const o=await KGe({mesaId:e,codigoEmpresa:n});if(o){console.log(`[getOrCreateComandaForMesa]  Comanda existente ${o.id} encontrada, verificando se est vazia...`);let l=!1,c=!1;try{l=(await uo({comandaId:o.id,codigoEmpresa:n})||[]).length>0}catch{}try{const{data:d}=await he.from("pagamentos").select("id, status").eq("comanda_id",o.id).eq("codigo_empresa",n);c=(d||[]).filter(f=>{const h=String(f?.status||"Pago");return h!=="Cancelado"&&h!=="Estornado"}).length>0}catch{}if(!l&&!c){console.log(`[getOrCreateComandaForMesa]  Comanda ${o.id} est vazia, fechando automaticamente...`);try{await Jx({comandaId:o.id,codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Comanda ${o.id} fechada com sucesso`)}catch(d){console.warn(`[getOrCreateComandaForMesa]  Erro ao fechar comanda ${o.id}:`,d?.message)}}else console.log(`[getOrCreateComandaForMesa]  Comanda ${o.id} tem dados (itens: ${l}, pagamentos: ${c}), no ser fechada automaticamente`)}console.log(`[getOrCreateComandaForMesa]  Criando comanda zerada para mesa ${e}`);const i=await GGe({mesaId:e,codigoEmpresa:n});return console.log(`[getOrCreateComandaForMesa]  Comanda ${i.id} criada com sucesso`),i}finally{oj.delete(r),console.log(`[getOrCreateComandaForMesa]  Lock liberado para mesa ${e}`)}})();return oj.set(r,s),s}async function ub({comandaId:e,clienteIds:t=[],nomesLivres:r=[],codigoEmpresa:n,replace:s=!1}={}){const o=n||aa();if(!e)throw new Error("comandaId  obrigatrio");let i=[],l=[];try{i=Array.isArray(t)?t:t?[t]:[]}catch(m){console.warn("[adicionarClientesAComanda] Erro ao processar clienteIds:",m),i=[]}try{l=Array.isArray(r)?r:r?[r]:[]}catch(m){console.warn("[adicionarClientesAComanda] Erro ao processar nomesLivres:",m),l=[]}const c=i.map(m=>m&&typeof m=="object"?m.id||m.cliente_id||m.value:m).filter(Boolean),d=l.map(m=>m&&typeof m=="object"?m.nome||m.name||m.label:m).map(m=>String(m||"").trim()).filter(Boolean);if(console.log(`[adicionarClientesAComanda] Adicionando clientes  comanda ${e}:`,{clienteIds:c,nomesLivres:d,codigo:o,replace:s}),s){const{error:m}=await he.from("comanda_clientes").delete().eq("comanda_id",e);m&&console.warn("[adicionarClientesAComanda] Erro ao limpar clientes existentes:",m)}const u=[];if(Array.isArray(c)){let m=[];if(!s)try{const{data:g}=await he.from("comanda_clientes").select("cliente_id, nome_livre").eq("comanda_id",e);m=Array.isArray(g)?g:[]}catch{}const v=new Set((m||[]).map(g=>g.cliente_id).filter(Boolean));for(let g=0;g<c.length;g++){const y=c[g];y&&(!s&&v.has(y)||u.push({comanda_id:e,cliente_id:y}))}}if(Array.isArray(d))for(let m=0;m<d.length;m++){const g=(d[m]||"").trim();g&&u.push({comanda_id:e,nome_livre:g})}if(u.length===0)return console.log("[adicionarClientesAComanda] Nenhum cliente para adicionar"),!0;let f=[];Array.isArray(u)&&(f=u.map(m=>o?{...m,codigo_empresa:o}:m)),console.log("[adicionarClientesAComanda] Payload para insero:",f);const{error:h}=await he.from("comanda_clientes").insert(f);if(h)throw console.error("[adicionarClientesAComanda] ERRO ao inserir clientes:",h),h;return console.log("[adicionarClientesAComanda] Clientes adicionados com sucesso"),!0}async function ai({comandaId:e,codigoEmpresa:t}={}){if(t||aa(),!e)throw new Error("comandaId  obrigatrio");try{const{data:r,error:n}=await he.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!comanda_clientes_cliente_id_fkey(id, codigo, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(n)throw n;return(r||[]).map(s=>({id:s.id,tipo:s.cliente_id?"cadastrado":"livre",nome:s.clientes?.nome||s.nome_livre,cliente_id:s.cliente_id}))}catch{try{const{data:n,error:s}=await he.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!fk_comanda_clientes_cliente(id, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(s)throw s;return(n||[]).map(o=>({id:o.id,tipo:o.cliente_id?"cadastrado":"livre",nome:o.clientes?.nome||o.nome_livre,cliente_id:o.cliente_id}))}catch{const{data:s,error:o}=await he.from("comanda_clientes").select("id, cliente_id, nome_livre").eq("comanda_id",e).order("created_at",{ascending:!0});if(o)throw o;return(s||[]).map(i=>({id:i.id,tipo:i.cliente_id?"cadastrado":"livre",nome:i.nome_livre||"",cliente_id:i.cliente_id}))}}}async function ST({comandaId:e,produtoId:t,descricao:r,quantidade:n,precoUnitario:s,desconto:o=0,codigoEmpresa:i}){const l=i||aa();console.log(`[adicionarItem] Adicionando item  comanda ${e}:`,{produtoId:t,descricao:r,quantidade:n,precoUnitario:s,codigo:l});try{let f=he.from("produtos").select("id, estoque, estoque_minimo, nome").eq("id",t).limit(1);l&&(f=f.eq("codigo_empresa",l));const{data:h,error:m}=await f;if(m)throw m;const v=Array.isArray(h)?h[0]:h;if(v){const g=Number(v.estoque??0),y=Number(v.estoque_minimo??0),x=Number(n??1);if(g<=0){const P=new Error(`Produto sem estoque: ${v.nome||""}`.trim());throw P.code="OUT_OF_STOCK",P}let b=he.from("comanda_itens").select("quantidade").eq("comanda_id",e).eq("produto_id",t);l&&(b=b.eq("codigo_empresa",l));const{data:w,error:j}=await b;if(j)throw j;const _=Array.isArray(w)&&w.length?w.reduce((P,E)=>P+Number(E?.quantidade||0),0):0;if(_+x>g){const P=new Error(`Estoque insuficiente. Em comanda: ${_}, solicitado: +${x}, disponvel: ${g}`);throw P.code="INSUFFICIENT_STOCK",P}if(g<=y&&g>0)try{console.warn(`[adicionarItem] Aviso: estoque baixo para produto '${v.nome}' (estoque=${g}, minimo=${y})`)}catch{}}}catch(f){throw f}const c={comanda_id:e,produto_id:t,descricao:r,quantidade:n,preco_unitario:s,desconto:o};l&&(c.codigo_empresa=l);const{data:d,error:u}=await he.from("comanda_itens").insert(c).select("*").single();if(u)throw u;return d}async function td({itemId:e,quantidade:t,codigoEmpresa:r}){const n=r||aa();let s=he.from("comanda_itens").select("id, quantidade, produto_id, comanda_id").eq("id",e).limit(1);n&&(s=s.eq("codigo_empresa",n));const{data:o,error:i}=await s;if(i)throw i;const l=Array.isArray(o)?o[0]:o,c=Number(t||0);if(!l)throw new Error("Item no encontrado");const d=Number(l.quantidade||0);if(c-d>0){let v=he.from("produtos").select("id, estoque, nome, estoque_minimo").eq("id",l.produto_id).limit(1);n&&(v=v.eq("codigo_empresa",n));const{data:g,error:y}=await v;if(y)throw y;const x=Array.isArray(g)?g[0]:g;if(x){const b=Number(x.estoque??0);let w=he.from("comanda_itens").select("quantidade").eq("comanda_id",l.comanda_id).eq("produto_id",l.produto_id).neq("id",l.id);n&&(w=w.eq("codigo_empresa",n));const{data:j,error:_}=await w;if(_)throw _;const C=Array.isArray(j)&&j.length?j.reduce((F,D)=>F+Number(D?.quantidade||0),0):0;if(C+c>b){const F=new Error(`Estoque insuficiente. Em comanda (outros itens): ${C}, novo para este item: ${c}, disponvel: ${b}`);throw F.code="INSUFFICIENT_STOCK",F}const E=Number(x.estoque_minimo??0),A=b-(C+c);if(A<=E&&A>=0)try{console.warn(`[atualizarQuantidadeItem] Aviso: produto '${x.nome}' atingiu nvel de estoque baixo (restante=${A}, minimo=${E})`)}catch{}}}let f=he.from("comanda_itens").update({quantidade:c}).eq("id",e);n&&(f=f.eq("codigo_empresa",n));const{data:h,error:m}=await f.select("*").single();if(m)throw m;return h}async function zv({itemId:e,codigoEmpresa:t}){const r=t||aa();let n=he.from("comanda_itens").delete().eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n.select("id");if(o&&o.code!=="PGRST116")throw o;return Array.isArray(s)&&s.length>0}function YGe(e){if(!e)return!1;const t=e.code?String(e.code):"",r=[e.message,e.details,e.hint].filter(Boolean).join(" ").toLowerCase();return t==="22P02"||r.includes("invalid input value for enum")}async function BM({comandaId:e,finalizadoraId:t,metodo:r,valor:n,status:s="Pago",codigoEmpresa:o,clienteId:i=null}){const l=o||aa();if(!l)throw new Error("Empresa no identificada (codigo_empresa ausente).");const c=s&&["Pendente","Pago","Estornado","Cancelado"].includes(s)?s:"Pago",d=["dinheiro","credito","debito","pix","voucher","outros"],f=(m=>{if(!m)return"outros";const v=String(m).toLowerCase().trim(),y={"cartao credito":"credito","carto credito":"credito","cartao debito":"debito","carto debito":"debito","carto de credito":"credito","carto de dbito":"debito","cartao de credito":"credito","cartao de debito":"debito"}[v]||v;return d.includes(y)?y:"outros"})(r),h={comanda_id:e,finalizadora_id:t||null,metodo:f,valor:Math.max(0,Number(n)||0),status:c,recebido_em:new Date().toISOString(),codigo_empresa:l};i&&(h.cliente_id=i),console.log("[registrarPagamento] Iniciando registro de pagamento:",{comandaId:e,finalizadoraId:t,metodo:f,valor:h.valor,status:h.status,codigoEmpresa:l,payload:h});try{const{data:m,error:v}=await he.from("pagamentos").insert(h).select().single();if(v){console.warn("[registrarPagamento] Primeira tentativa falhou:",{code:v.code,message:v.message});const g=`${v?.message||""} ${v?.details||""}`.toLowerCase();if(v?.code==="42703"||g.includes("column")&&g.includes("cliente_id")){const{cliente_id:x,...b}=h;try{localStorage.setItem("schema:pagamentos:cliente_id","no")}catch{}const{data:w,error:j}=await he.from("pagamentos").insert(b).select().single();if(j)throw j;return console.log("[registrarPagamento] Pagamento registrado sem cliente_id:",w),w}if(YGe(v)){console.log("[registrarPagamento] Tentando abordagem alternativa sem status...");try{const x={...h};delete x.status;const{data:b,error:w}=await he.from("pagamentos").insert(x).select().single();if(w)throw w;return console.log("[registrarPagamento] Pagamento registrado com sucesso (abordagem alternativa):",b),b}catch(x){throw console.error("[registrarPagamento] Falha na abordagem alternativa:",x),new Error(`Falha ao processar pagamento: ${x.message}`)}}throw v}return console.log("[registrarPagamento] Pagamento registrado com sucesso:",m),m}catch(m){throw console.error("[registrarPagamento] Erro ao registrar pagamento:",{error:{message:m.message,code:m.code,details:m.details,hint:m.hint},comandaId:e,finalizadoraId:t,valor:h.valor,status:h.status,codigoEmpresa:l}),m}}async function Jx({comandaId:e,codigoEmpresa:t,diferencaPagamento:r}){const n=t||aa(),s="[fecharComandaEMesa]";try{console.group(s)}catch{}try{console.time?.(s)}catch{}try{console.log(`${s} Iniciando fechamento da comanda ${e}`),console.log(`${s} Obtendo dados da comanda...`);const{data:o,error:i}=await he.from("comandas").select("id, mesa_id, status, fechado_em").eq("id",e).single();if(i||!o)throw console.error(`${s} Erro ao buscar comanda:`,i?.message||"Comanda no encontrada"),i||new Error("Comanda no encontrada");if(o.fechado_em)return console.log(`${s} Comanda ${e} j est fechada em ${o.fechado_em}`),!0;const l=new Date().toISOString();console.log(`${s} Atualizando comanda...`);const c={status:"closed",fechado_em:l};typeof r=="number"&&Number.isFinite(r)&&(c.diferenca_pagamento=r),console.log(`${s} Fechando comanda com status closed + fechado_em${c.diferenca_pagamento!=null?" + diferenca_pagamento":""}...`);let{error:d}=await he.from("comandas").update(c).eq("id",e).eq("codigo_empresa",n);if(d&&d.code==="42703"){console.warn(`${s} Coluna diferenca_pagamento ausente no schema, tentando novamente sem ela...`);const u={status:"closed",fechado_em:l};({error:d}=await he.from("comandas").update(u).eq("id",e).eq("codigo_empresa",n))}if(d)throw console.error(`${s} Erro ao fechar comanda:`,d),d;if(console.log(`${s} Comanda ${e} fechada com sucesso`),o.mesa_id){console.log(`${s} Atualizando status da mesa ${o.mesa_id} para disponvel...`);try{const{error:u}=await he.from("mesas").update({status:"available"}).eq("id",o.mesa_id).select("id").single();u?console.error(`${s} Erro ao atualizar status da mesa:`,u):console.log(`${s} Mesa ${o.mesa_id} marcada como disponvel`)}catch(u){console.error(`${s} Exceo ao atualizar mesa:`,u)}}else console.log(`${s} Nenhuma mesa associada para liberar`);return console.log(`${s} Fechamento da comanda ${e} concludo com sucesso`),!0}catch(o){throw console.error(`${s} Erro fatal ao fechar comanda:`,o),o}finally{try{console.timeEnd?.(s)}catch{}try{console.groupEnd()}catch{}}}async function cz({comandaId:e,codigoEmpresa:t}){const r=t||aa(),n="[cancelarComandaEMesa]";try{console.group(n)}catch{}try{console.time?.(n)}catch{}try{if(!e)throw new Error("comandaId obrigatrio");if(!r)throw new Error("codigo_empresa obrigatrio");console.log(`${n} Cancelando comanda ${e}`);const{data:s}=await he.from("comandas").select("id, mesa_id").eq("id",e).single();try{await he.from("comanda_itens").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}try{await he.from("comanda_clientes").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}const o=new Date().toISOString(),{data:i,error:l}=await he.from("comandas").update({status:"cancelled",fechado_em:o}).eq("id",e).eq("codigo_empresa",r).select();if(l)throw console.error(`${n} Erro ao atualizar comanda:`,l),l;if(!i||i.length===0)throw console.error(`${n}  UPDATE no afetou nenhuma linha! Comanda ${e} no foi encontrada ou RLS bloqueou`),new Error("Comanda no encontrada ou sem permisso para cancelar");if(console.log(`${n}  Comanda atualizada:`,i[0]),s?.mesa_id){console.log(`${n} Liberando mesa ${s.mesa_id}`);try{await he.from("mesas").update({status:"available"}).eq("id",s.mesa_id)}catch(c){console.error(`${n} Erro ao liberar mesa:`,c)}}return console.log(`${n} Comanda ${e} cancelada com sucesso`),!0}catch(s){throw console.error(`${n} Falha:`,s),s}finally{try{console.timeEnd?.(n)}catch{}try{console.groupEnd?.(n)}catch{}}}async function JGe({itemId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:s}={}){const o=s||aa();if(!e)throw new Error("itemId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let i=he.from("comanda_itens").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);o&&(i=i.eq("codigo_empresa",o));const{data:l,error:c}=await i.select("*").single();if(c)throw c;return l}async function QGe({comandaId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:s}={}){const o=s||aa();if(!e)throw new Error("comandaId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let i=he.from("comandas").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);o&&(i=i.eq("codigo_empresa",o));const{data:l,error:c}=await i.select("*").single();if(c)throw c;return l}async function ZGe({itemId:e,codigoEmpresa:t}={}){const r=t||aa();if(!e)throw new Error("itemId  obrigatrio");let n=he.from("comanda_itens").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n.select("*").single();if(o)throw o;return s}async function eKe({comandaId:e,codigoEmpresa:t}={}){const r=t||aa();if(!e)throw new Error("comandaId  obrigatrio");let n=he.from("comandas").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n.select("*").single();if(o)throw o;return s}async function tKe({comandaId:e,observacoes:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const{error:n}=await he.from("comandas").update({observacoes:(t||"").trim()||null,observacoes_atualizadas_em:new Date().toISOString()}).eq("id",e);if(n)throw n;return{id:e}}var T5="Tabs",[rKe,ect]=Ed(T5,[E5]),Ire=E5(),[nKe,qM]=rKe(T5),Ore=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:o,orientation:i="horizontal",dir:l,activationMode:c="automatic",...d}=e,u=N5(l),[f,h]=Kf({prop:n,onChange:s,defaultProp:o??"",caller:T5});return a.jsx(nKe,{scope:r,baseId:su(),value:f,onValueChange:h,orientation:i,dir:u,activationMode:c,children:a.jsx(sa.div,{dir:u,"data-orientation":i,...d,ref:t})})});Ore.displayName=T5;var Tre="TabsList",Dre=p.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...s}=e,o=qM(Tre,r),i=Ire(r);return a.jsx(Tte,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:n,children:a.jsx(sa.div,{role:"tablist","aria-orientation":o.orientation,...s,ref:t})})});Dre.displayName=Tre;var Mre="TabsTrigger",Rre=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...o}=e,i=qM(Mre,r),l=Ire(r),c=$re(i.baseId,n),d=Bre(i.baseId,n),u=n===i.value;return a.jsx(Dte,{asChild:!0,...l,focusable:!s,active:u,children:a.jsx(sa.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...o,ref:t,onMouseDown:jn(e.onMouseDown,f=>{!s&&f.button===0&&f.ctrlKey===!1?i.onValueChange(n):f.preventDefault()}),onKeyDown:jn(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&i.onValueChange(n)}),onFocus:jn(e.onFocus,()=>{const f=i.activationMode!=="manual";!u&&!s&&f&&i.onValueChange(n)})})})});Rre.displayName=Mre;var Lre="TabsContent",Fre=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:s,children:o,...i}=e,l=qM(Lre,r),c=$re(l.baseId,n),d=Bre(l.baseId,n),u=n===l.value,f=p.useRef(u);return p.useEffect(()=>{const h=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(h)},[]),a.jsx(qc,{present:s||u,children:({present:h})=>a.jsx(sa.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!h,id:d,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:h&&o})})});Fre.displayName=Lre;function $re(e,t){return`${e}-trigger-${t}`}function Bre(e,t){return`${e}-content-${t}`}var aKe=Ore,qre=Dre,zre=Rre,Ure=Fre;const Cc=aKe,Gl=Se.forwardRef(({className:e,...t},r)=>a.jsx(qre,{ref:r,className:gr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Gl.displayName=qre.displayName;const da=Se.forwardRef(({className:e,...t},r)=>a.jsx(zre,{ref:r,className:gr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));da.displayName=zre.displayName;const ds=Se.forwardRef(({className:e,...t},r)=>a.jsx(Ure,{ref:r,className:gr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));ds.displayName=Ure.displayName;function Vre({open:e,onOpenChange:t,client:r,onSaved:n}){const{toast:s}=as(),{userProfile:o}=vs(),i=I=>({tipo_pessoa:I?.tipo_pessoa||"PF",tipo_cadastro:I?.tipo_cadastro||"cliente",nome:I?.nome||"",apelido:I?.apelido||"",cpf:I?.cpf||"",cnpj:I?.cnpj||"",rg:I?.rg||"",ie:I?.ie||"",email:I?.email||"",telefone:I?.telefone||"",fone2:I?.fone2||"",celular1:I?.celular1||"",celular2:I?.celular2||"",whatsapp:I?.whatsapp||"",cep:I?.cep||"",endereco:I?.endereco||"",numero:I?.numero||"",complemento:I?.complemento||"",bairro:I?.bairro||"",cidade:I?.cidade||"",uf:I?.uf||"",cidade_ibge:I?.cidade_ibge||"",limite_credito:I?.limite_credito??"",tipo_recebimento:I?.tipo_recebimento||"",regime_tributario:I?.regime_tributario||"",tipo_contribuinte:I?.tipo_contribuinte||"",aniversario:I?.aniversario?String(I.aniversario).slice(0,10):"",sexo:I?.sexo||"",estado_civil:I?.estado_civil||"",nome_mae:I?.nome_mae||"",nome_pai:I?.nome_pai||"",observacoes:I?.observacoes||"",status:I?.status||"active"}),[l,c]=p.useState(i(r)),[d,u]=p.useState("basicos"),[f,h]=p.useState(!1);p.useEffect(()=>{let I="cliente";r?.flag_cliente&&r?.flag_fornecedor?I="ambos":r?.flag_fornecedor&&(I="fornecedor"),c({tipo_pessoa:r?.tipo_pessoa||"PF",tipo_cadastro:I,nome:r?.nome||"",apelido:r?.apelido||"",cpf:r?.cpf||"",cnpj:r?.cnpj||"",rg:r?.rg||"",ie:r?.ie||"",email:r?.email||"",telefone:r?.telefone||"",fone2:r?.fone2||"",celular1:r?.celular1||"",celular2:r?.celular2||"",whatsapp:r?.whatsapp||"",cep:r?.cep||"",endereco:r?.endereco||"",numero:r?.numero||"",complemento:r?.complemento||"",bairro:r?.bairro||"",cidade:r?.cidade||"",uf:r?.uf||"",cidade_ibge:r?.cidade_ibge||"",limite_credito:r?.limite_credito??"",tipo_recebimento:r?.tipo_recebimento||"",regime_tributario:r?.regime_tributario||"",tipo_contribuinte:r?.tipo_contribuinte||"",aniversario:r?.aniversario?String(r.aniversario).slice(0,10):"",sexo:r?.sexo||"",estado_civil:r?.estado_civil||"",nome_mae:r?.nome_mae||"",nome_pai:r?.nome_pai||"",observacoes:r?.observacoes||"",status:r?.status||"active"})},[r]),p.useEffect(()=>{e?c(i(r||null)):r||c(i(null))},[e,!!r]);const m=I=>{const{id:R,value:M}=I.target;c(U=>({...U,[R]:M}))},v=async()=>{try{const I=x.digits(l.cnpj);if(!I||I.length!==14){s({title:"CNPJ invlido",description:"Informe 14 dgitos para buscar.",variant:"destructive"});return}const R=await fetch(`https://brasilapi.com.br/api/cnpj/v1/${I}`);if(!R.ok){let J="Falha ao consultar CNPJ";try{const fe=await R.json();fe?.message&&(J=fe.message)}catch{}throw new Error(J)}const M=await R.json();try{console.info("[clientes] BuscarCNPJ:payload",M)}catch{}const U=M.razao_social||M.nome||"",z=M.nome_fantasia||"",W=M.logradouro||"",$=String(M.numero||""),ee=M.complemento||"",ve=M.bairro||"",_e=M.municipio||M.localidade||"",K=M.uf||"",q=x.digits(M.cep||"");let Y="";try{if(_e&&K){const J=await fetch(`https://brasilapi.com.br/api/ibge/municipios/v1/${K}`);if(J.ok){const fe=await J.json(),Z=ie=>String(ie||"").normalize("NFD").replace(/\p{Diacritic}/gu,"").toLowerCase().trim(),ce=Z(_e),le=(fe||[]).find(ie=>Z(ie.nome)===ce);(le?.codigo_ibge||le?.codigo)&&(Y=String(le.codigo_ibge||le.codigo))}}}catch{}c(J=>({...J,nome:U,apelido:z||U,endereco:W,numero:$,complemento:ee,bairro:ve,cidade:_e,uf:K,cep:q,cidade_ibge:Y||J.cidade_ibge}));try{console.info("[clientes] BuscarCNPJ:setForm",{razao:U,fantasia:z,logradouro:W,numero:$,complemento:ee,bairro:ve,cidade:_e,uf:K,cep:q,codigoIBGE:Y})}catch{}s({title:"CNPJ carregado",description:"Dados preenchidos."})}catch(I){s({title:"Falha ao buscar CNPJ",description:I.message||"Tente novamente.",variant:"destructive"})}},g=I=>I===""?null:I,y=I=>{if(I==null)return null;if(typeof I=="number")return I;const R=String(I).trim();if(!R)return null;const M=R.replace(/\s+/g,"").replace(/\.(?=\d{3}(?:\D|$))/g,"").replace(/,/g,"."),U=Number(M);return Number.isFinite(U)?U:null},x=p.useMemo(()=>({digits:I=>(I||"").replace(/\D+/g,"")}),[]),b=I=>x.digits(I).slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),w=I=>x.digits(I).slice(0,14).replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d{1,2})$/,"$1-$2"),j=I=>x.digits(I).slice(0,8).replace(/(\d{5})(\d)/,"$1-$2"),_=I=>{const R=x.digits(I).slice(0,11);return R.length<=10?R.replace(/(\d{2})(\d{4})(\d{0,4})/,"($1) $2-$3").trim():R.replace(/(\d{2})(\d{5})(\d{0,4})/,"($1) $2-$3").trim()},C=I=>String(I||"").replace(/[^a-z]/gi,"").toUpperCase().slice(0,2),P=(I,R=6)=>x.digits(I).slice(0,R),E=I=>{const R=x.digits(I);return R?(Number(R)/100).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},A=(I,R)=>{let M=R;I==="cpf"&&(M=b(R)),I==="cnpj"&&(M=w(R)),I==="cep"&&(M=j(R)),["telefone","fone2","celular1","celular2","whatsapp"].includes(I)&&(M=_(R)),I==="uf"&&(M=C(R)),I==="numero"&&(M=P(R,8)),I==="cidade_ibge"&&(M=P(R,7)),I==="limite_credito"&&(M=E(R)),c(U=>({...U,[I]:M}))},F=async()=>{const I=x.digits(l.cep);if(!I||I.length!==8){s({title:"CEP invlido",description:"Informe 8 dgitos.",variant:"destructive"});return}try{h(!0),c(U=>({...U,endereco:"Buscando...",bairro:"Buscando...",cidade:"Buscando...",uf:""}));const M=await(await fetch(`https://viacep.com.br/ws/${I}/json/`)).json();if(M.erro)throw new Error("CEP no encontrado");c(U=>({...U,endereco:M.logradouro||"",bairro:M.bairro||"",cidade:M.localidade||"",uf:M.uf||"",cidade_ibge:M.ibge||""})),s({title:"CEP encontrado!",description:"Endereo preenchido automaticamente.",variant:"success"})}catch(R){c(M=>({...M,endereco:"",bairro:"",cidade:"",uf:""})),s({title:"Falha ao buscar CEP",description:R.message||"Tente novamente.",variant:"destructive"})}finally{h(!1)}},D=async I=>{I?.preventDefault?.(),window.__protectPaymentModal&&window.__protectPaymentModal(5e3);try{if(!l.nome||l.nome.trim().length<2)throw new Error("Informe o nome/razo social do cliente.");const R={tipo_pessoa:g(l.tipo_pessoa),nome:l.nome,apelido:g(l.apelido),cpf:g(l.cpf),cnpj:g(l.cnpj),rg:g(l.rg),ie:g(l.ie),email:g(l.email),telefone:g(l.telefone),fone2:g(l.fone2),celular1:g(l.celular1),celular2:g(l.celular2),whatsapp:g(l.whatsapp),cep:g(l.cep),endereco:g(l.endereco),numero:g(l.numero),complemento:g(l.complemento),bairro:g(l.bairro),cidade:g(l.cidade),uf:g(l.uf),cidade_ibge:g(l.cidade_ibge),limite_credito:y(l.limite_credito),tipo_recebimento:g(l.tipo_recebimento),regime_tributario:g(l.regime_tributario),tipo_contribuinte:g(l.tipo_contribuinte),aniversario:g(l.aniversario),sexo:g(l.sexo),estado_civil:g(l.estado_civil),nome_mae:g(l.nome_mae),nome_pai:g(l.nome_pai),observacoes:g(l.observacoes),flag_cliente:l.tipo_cadastro==="cliente"||l.tipo_cadastro==="ambos",flag_fornecedor:l.tipo_cadastro==="fornecedor"||l.tipo_cadastro==="ambos",flag_funcionario:!1,flag_administradora:!1,flag_parceiro:!1,flag_ccf_spc:!1,status:l.status};let M,U=null;if(r?.id){const{data:z,error:W}=await he.from("clientes").update(R).eq("id",r.id).select().single();M=W,U=z??null}else{const z=o?.codigo_empresa||null;if(!z)throw new Error("No foi possvel identificar a empresa do usurio (codigo_empresa). Tente recarregar a pgina ou entrar novamente.");const W={...R,codigo_empresa:z},{data:$,error:ee}=await he.from("clientes").insert(W).select().single();M=ee,U=$??null}if(M)throw M;s({title:"Cliente salvo!",description:"As informaes do cliente foram atualizadas.",variant:"success"}),n?.(U),setTimeout(()=>{t?.(!1)},50)}catch(R){const M=(R?.message||"").toLowerCase(),U=R?.code||"";let z="Erro ao salvar cliente",W=R.message;U==="23505"||M.includes("duplicate key")&&M.includes("uq_clientes_empresa_codigo")?(z="Cdigo j cadastrado",W="J existe um cliente com este cdigo na sua empresa. Deixe o campo cdigo em branco para gerar automaticamente ou escolha outro nmero."):M.includes("column")&&M.includes("does not exist")&&(W="Seu banco pode no estar migrado para os novos campos. Atualize o schema conforme estrutura_bd."),s({title:z,description:W,variant:"destructive"})}};return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto w-full",children:[a.jsxs(pn,{children:[a.jsx(un,{children:r?"Editar Cliente":"Novo Cliente"}),a.jsx(Dn,{children:"Preencha os dados cadastrais do cliente."})]}),a.jsx("form",{onSubmit:D,className:"grid gap-4 sm:gap-6 py-2",children:a.jsxs(Cc,{value:d,onValueChange:u,className:"w-full",children:[a.jsx("div",{className:"sm:hidden mb-4",children:a.jsxs(Nn,{value:d,onValueChange:u,children:[a.jsx(bn,{className:"w-full",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"basicos",children:"Dados Bsicos"}),a.jsx(tt,{value:"endereco",children:"Endereo"}),a.jsx(tt,{value:"financeiro",children:"Financeiro"}),a.jsx(tt,{value:"adicionais",children:"Adicionais"})]})]})}),a.jsxs(Gl,{className:"hidden sm:grid grid-cols-4 gap-2",children:[a.jsx(da,{value:"basicos",children:"Dados Bsicos"}),a.jsx(da,{value:"endereco",children:"Endereo"}),a.jsx(da,{value:"financeiro",children:"Financeiro"}),a.jsx(da,{value:"adicionais",children:"Adicionais"})]}),a.jsx(ds,{value:"basicos",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{children:"Tipo de Pessoa"}),a.jsxs(Nn,{value:l.tipo_pessoa,onValueChange:I=>c(R=>({...R,tipo_pessoa:I})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Pessoa"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"PF",children:"Fsica"}),a.jsx(tt,{value:"PJ",children:"Jurdica"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{children:"Tipo de Cadastro *"}),a.jsxs(Nn,{value:l.tipo_cadastro,onValueChange:I=>c(R=>({...R,tipo_cadastro:I})),required:!0,children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"cliente",children:"Cliente"}),a.jsx(tt,{value:"fornecedor",children:"Fornecedor"}),a.jsx(tt,{value:"ambos",children:"Cliente e Fornecedor"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(Le,{htmlFor:"nome",children:l.tipo_pessoa==="PJ"?"Razo Social":"Nome"}),a.jsx(Ye,{id:"nome",value:l.nome,onChange:m,required:!0})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(Le,{htmlFor:"apelido",children:l.tipo_pessoa==="PJ"?"Nome Fantasia":"Apelido"}),a.jsx(Ye,{id:"apelido",value:l.apelido,onChange:m})]}),l.tipo_pessoa==="PF"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"cpf",children:"CPF"}),a.jsx(Ye,{id:"cpf",value:l.cpf,onChange:I=>A("cpf",I.target.value),placeholder:"000.000.000-00"})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"rg",children:"RG"}),a.jsx(Ye,{id:"rg",value:l.rg,onChange:m})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"cnpj",children:"CNPJ"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{id:"cnpj",value:l.cnpj,onChange:I=>A("cnpj",I.target.value),placeholder:"00.000.000/0000-00"}),a.jsx(me,{type:"button",variant:"outline",onClick:v,children:"Buscar"})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"ie",children:"Inscrio Estadual (IE)"}),a.jsx(Ye,{id:"ie",value:l.ie,onChange:m})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(Le,{htmlFor:"email",children:"Email"}),a.jsx(Ye,{id:"email",type:"email",value:l.email,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"telefone",children:"Telefone"}),a.jsx(Ye,{id:"telefone",value:l.telefone,onChange:I=>A("telefone",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"celular1",children:"Celular"}),a.jsx(Ye,{id:"celular1",value:l.celular1,onChange:I=>A("celular1",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"whatsapp",children:"WhatsApp"}),a.jsx(Ye,{id:"whatsapp",value:l.whatsapp,onChange:I=>A("whatsapp",I.target.value),placeholder:"(DDD) 9...."})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"fone2",children:"Fone 2"}),a.jsx(Ye,{id:"fone2",value:l.fone2,onChange:I=>A("fone2",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"celular2",children:"Celular 2"}),a.jsx(Ye,{id:"celular2",value:l.celular2,onChange:I=>A("celular2",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"aniversario",children:"Nascimento"}),a.jsx(Ye,{id:"aniversario",type:"date",value:l.aniversario||"",onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{children:"Status"}),a.jsxs(Nn,{value:l.status,onValueChange:I=>c(R=>({...R,status:I})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Status"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"active",children:"Ativo"}),a.jsx(tt,{value:"inactive",children:"Inativo"})]})]})]})]})}),a.jsx(ds,{value:"endereco",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"cep",children:"CEP"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{id:"cep",value:l.cep,onChange:I=>A("cep",I.target.value),placeholder:"00000-000"}),a.jsx(me,{type:"button",variant:"outline",onClick:F,disabled:f,children:f?"Buscando...":"Buscar"})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(Le,{htmlFor:"endereco",children:"Endereo"}),a.jsx(Ye,{id:"endereco",value:l.endereco,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"numero",children:"Nmero"}),a.jsx(Ye,{id:"numero",value:l.numero,onChange:I=>A("numero",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(Le,{htmlFor:"complemento",children:"Complemento"}),a.jsx(Ye,{id:"complemento",value:l.complemento,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(Le,{htmlFor:"bairro",children:"Bairro"}),a.jsx(Ye,{id:"bairro",value:l.bairro,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"cidade",children:"Cidade"}),a.jsx(Ye,{id:"cidade",value:l.cidade,onChange:m})]}),a.jsxs("div",{className:"col-span-6 sm:col-span-1",children:[a.jsx(Le,{htmlFor:"uf",children:"UF"}),a.jsx(Ye,{id:"uf",value:l.uf,onChange:I=>A("uf",I.target.value),placeholder:"UF"})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"cidade_ibge",children:"Cd. IBGE"}),a.jsx(Ye,{id:"cidade_ibge",value:l.cidade_ibge,onChange:I=>A("cidade_ibge",I.target.value)})]})]})}),a.jsx(ds,{value:"financeiro",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{htmlFor:"limite_credito",children:"Limite de Crdito"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary text-sm",children:"R$"}),a.jsx(Ye,{id:"limite_credito",value:l.limite_credito,onChange:I=>A("limite_credito",I.target.value),placeholder:"0,00",className:"pl-10"})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{children:"Tipo de Recebimento"}),a.jsxs(Nn,{value:l.tipo_recebimento||"",onValueChange:I=>c(R=>({...R,tipo_recebimento:I})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"avista",children:" vista"}),a.jsx(tt,{value:"aprazo",children:"A prazo"}),a.jsx(tt,{value:"misto",children:"Misto"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{children:"Regime Tributrio"}),a.jsxs(Nn,{value:l.regime_tributario||"",onValueChange:I=>c(R=>({...R,regime_tributario:I})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"simples",children:"Simples"}),a.jsx(tt,{value:"lucro_presumido",children:"Lucro Presumido"}),a.jsx(tt,{value:"lucro_real",children:"Lucro Real"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(Le,{children:"Tipo de Contribuinte"}),a.jsxs(Nn,{value:l.tipo_contribuinte||"",onValueChange:I=>c(R=>({...R,tipo_contribuinte:I})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"nao_contribuinte",children:"No Contribuinte"}),a.jsx(tt,{value:"contribuinte",children:"Contribuinte"}),a.jsx(tt,{value:"isento",children:"Isento"})]})]})]})]})}),a.jsx(ds,{value:"adicionais",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(Le,{htmlFor:"sexo",children:"Sexo"}),a.jsxs(Nn,{value:l.sexo||"",onValueChange:I=>c(R=>({...R,sexo:I})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"m",children:"Masculino"}),a.jsx(tt,{value:"f",children:"Feminino"}),a.jsx(tt,{value:"o",children:"Outro"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(Le,{htmlFor:"estado_civil",children:"Estado Civil"}),a.jsxs(Nn,{value:l.estado_civil||"",onValueChange:I=>c(R=>({...R,estado_civil:I})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"solteiro",children:"Solteiro(a)"}),a.jsx(tt,{value:"casado",children:"Casado(a)"}),a.jsx(tt,{value:"divorciado",children:"Divorciado(a)"}),a.jsx(tt,{value:"viuvo",children:"Vivo(a)"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(Le,{htmlFor:"nome_mae",children:"Nome da Me"}),a.jsx(Ye,{id:"nome_mae",value:l.nome_mae,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(Le,{htmlFor:"nome_pai",children:"Nome do Pai"}),a.jsx(Ye,{id:"nome_pai",value:l.nome_pai,onChange:m})]}),a.jsxs("div",{className:"col-span-12",children:[a.jsx(Le,{htmlFor:"observacoes",children:"Observaes"}),a.jsx("textarea",{id:"observacoes",value:l.observacoes,onChange:m,rows:4,className:"w-full rounded-md border border-border bg-background p-2 text-sm"})]})]})})]})}),a.jsxs(ra,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[a.jsx(lh,{asChild:!0,children:a.jsx(me,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),a.jsx(me,{type:"submit",onClick:D,className:"w-full sm:w-auto",children:"Salvar Cliente"})]})]})})}function sKe(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),s=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(s),t&&(n.href=t),s.href=e,s.href}const oKe=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function fh(e){const t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}let ev=null;function Wre(e={}){return ev||(e.includeStyleProperties?(ev=e.includeStyleProperties,ev):(ev=fh(window.getComputedStyle(document.documentElement)),ev))}function fS(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function iKe(e){const t=fS(e,"border-left-width"),r=fS(e,"border-right-width");return e.clientWidth+t+r}function lKe(e){const t=fS(e,"border-top-width"),r=fS(e,"border-bottom-width");return e.clientHeight+t+r}function Hre(e,t={}){const r=t.width||iKe(e),n=t.height||lKe(e);return{width:r,height:n}}function cKe(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const fc=16384;function dKe(e){(e.width>fc||e.height>fc)&&(e.width>fc&&e.height>fc?e.width>e.height?(e.height*=fc/e.width,e.width=fc):(e.width*=fc/e.height,e.height=fc):e.width>fc?(e.height*=fc/e.width,e.width=fc):(e.width*=fc/e.height,e.height=fc))}function mS(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>t(n))})},n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function uKe(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function fKe(e,t,r){const n="http://www.w3.org/2000/svg",s=document.createElementNS(n,"svg"),o=document.createElementNS(n,"foreignObject");return s.setAttribute("width",`${t}`),s.setAttribute("height",`${r}`),s.setAttribute("viewBox",`0 0 ${t} ${r}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),s.appendChild(o),o.appendChild(e),uKe(s)}const Ql=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||Ql(r,t)};function mKe(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function hKe(e,t){return Wre(t).map(r=>{const n=e.getPropertyValue(r),s=e.getPropertyPriority(r);return`${r}: ${n}${s?" !important":""};`}).join(" ")}function pKe(e,t,r,n){const s=`.${e}:${t}`,o=r.cssText?mKe(r):hKe(r,n);return document.createTextNode(`${s}{${o}}`)}function dz(e,t,r,n){const s=window.getComputedStyle(e,r),o=s.getPropertyValue("content");if(o===""||o==="none")return;const i=oKe();try{t.className=`${t.className} ${i}`}catch{return}const l=document.createElement("style");l.appendChild(pKe(i,r,s,n)),t.appendChild(l)}function gKe(e,t,r){dz(e,t,":before",r),dz(e,t,":after",r)}const uz="application/font-woff",fz="image/jpeg",vKe={woff:uz,woff2:uz,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:fz,jpeg:fz,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function xKe(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function zM(e){const t=xKe(e).toLowerCase();return vKe[t]||""}function yKe(e){return e.split(/,/)[1]}function CT(e){return e.search(/^(data:)/)!==-1}function Gre(e,t){return`data:${t};base64,${e}`}async function Kre(e,t,r){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const s=await n.blob();return new Promise((o,i)=>{const l=new FileReader;l.onerror=i,l.onloadend=()=>{try{o(r({res:n,result:l.result}))}catch(c){i(c)}},l.readAsDataURL(s)})}const oE={};function bKe(e,t,r){let n=e.replace(/\?.*/,"");return r&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function UM(e,t,r){const n=bKe(e,t,r.includeQueryParams);if(oE[n]!=null)return oE[n];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const o=await Kre(e,r.fetchRequestInit,({res:i,result:l})=>(t||(t=i.headers.get("Content-Type")||""),yKe(l)));s=Gre(o,t)}catch(o){s=r.imagePlaceholder||"";let i=`Failed to fetch resource: ${e}`;o&&(i=typeof o=="string"?o:o.message),i&&console.warn(i)}return oE[n]=s,s}async function wKe(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):mS(t)}async function jKe(e,t){if(e.currentSrc){const o=document.createElement("canvas"),i=o.getContext("2d");o.width=e.clientWidth,o.height=e.clientHeight,i?.drawImage(e,0,0,o.width,o.height);const l=o.toDataURL();return mS(l)}const r=e.poster,n=zM(r),s=await UM(r,n,t);return mS(s)}async function _Ke(e,t){var r;try{if(!((r=e?.contentDocument)===null||r===void 0)&&r.body)return await D5(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function NKe(e,t){return Ql(e,HTMLCanvasElement)?wKe(e):Ql(e,HTMLVideoElement)?jKe(e,t):Ql(e,HTMLIFrameElement)?_Ke(e,t):e.cloneNode(Xre(e))}const SKe=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",Xre=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function CKe(e,t,r){var n,s;if(Xre(t))return t;let o=[];return SKe(e)&&e.assignedNodes?o=fh(e.assignedNodes()):Ql(e,HTMLIFrameElement)&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?o=fh(e.contentDocument.body.childNodes):o=fh(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),o.length===0||Ql(e,HTMLVideoElement)||await o.reduce((i,l)=>i.then(()=>D5(l,r)).then(c=>{c&&t.appendChild(c)}),Promise.resolve()),t}function AKe(e,t,r){const n=t.style;if(!n)return;const s=window.getComputedStyle(e);s.cssText?(n.cssText=s.cssText,n.transformOrigin=s.transformOrigin):Wre(r).forEach(o=>{let i=s.getPropertyValue(o);o==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),Ql(e,HTMLIFrameElement)&&o==="display"&&i==="inline"&&(i="block"),o==="d"&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),n.setProperty(o,i,s.getPropertyPriority(o))})}function PKe(e,t){Ql(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),Ql(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function EKe(e,t){if(Ql(e,HTMLSelectElement)){const r=t,n=Array.from(r.children).find(s=>e.value===s.getAttribute("value"));n&&n.setAttribute("selected","")}}function kKe(e,t,r){return Ql(t,Element)&&(AKe(e,t,r),gKe(e,t,r),PKe(e,t),EKe(e,t)),t}async function IKe(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const n={};for(let o=0;o<r.length;o++){const l=r[o].getAttribute("xlink:href");if(l){const c=e.querySelector(l),d=document.querySelector(l);!c&&d&&!n[l]&&(n[l]=await D5(d,t,!0))}}const s=Object.values(n);if(s.length){const o="http://www.w3.org/1999/xhtml",i=document.createElementNS(o,"svg");i.setAttribute("xmlns",o),i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.display="none";const l=document.createElementNS(o,"defs");i.appendChild(l);for(let c=0;c<s.length;c++)l.appendChild(s[c]);e.appendChild(i)}return e}async function D5(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>NKe(n,t)).then(n=>CKe(e,n,t)).then(n=>kKe(e,n,t)).then(n=>IKe(n,t))}const Yre=/url\((['"]?)([^'"]+?)\1\)/g,OKe=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,TKe=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function DKe(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function MKe(e){const t=[];return e.replace(Yre,(r,n,s)=>(t.push(s),r)),t.filter(r=>!CT(r))}async function RKe(e,t,r,n,s){try{const o=r?sKe(t,r):t,i=zM(t);let l;if(s){const c=await s(o);l=Gre(c,i)}else l=await UM(o,i,n);return e.replace(DKe(t),`$1${l}$3`)}catch{}return e}function LKe(e,{preferredFontFormat:t}){return t?e.replace(TKe,r=>{for(;;){const[n,,s]=OKe.exec(r)||[];if(!s)return"";if(s===t)return`src: ${n};`}}):e}function Jre(e){return e.search(Yre)!==-1}async function Qre(e,t,r){if(!Jre(e))return e;const n=LKe(e,r);return MKe(n).reduce((o,i)=>o.then(l=>RKe(l,i,t,r)),Promise.resolve(n))}async function tv(e,t,r){var n;const s=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(s){const o=await Qre(s,null,r);return t.style.setProperty(e,o,t.style.getPropertyPriority(e)),!0}return!1}async function FKe(e,t){await tv("background",e,t)||await tv("background-image",e,t),await tv("mask",e,t)||await tv("-webkit-mask",e,t)||await tv("mask-image",e,t)||await tv("-webkit-mask-image",e,t)}async function $Ke(e,t){const r=Ql(e,HTMLImageElement);if(!(r&&!CT(e.src))&&!(Ql(e,SVGImageElement)&&!CT(e.href.baseVal)))return;const n=r?e.src:e.href.baseVal,s=await UM(n,zM(n),t);await new Promise((o,i)=>{e.onload=o,e.onerror=t.onImageErrorHandler?(...c)=>{try{o(t.onImageErrorHandler(...c))}catch(d){i(d)}}:i;const l=e;l.decode&&(l.decode=o),l.loading==="lazy"&&(l.loading="eager"),r?(e.srcset="",e.src=s):e.href.baseVal=s})}async function BKe(e,t){const n=fh(e.childNodes).map(s=>Zre(s,t));await Promise.all(n).then(()=>e)}async function Zre(e,t){Ql(e,Element)&&(await FKe(e,t),await $Ke(e,t),await BKe(e,t))}function qKe(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(s=>{r[s]=n[s]}),e}const mz={};async function hz(e){let t=mz[e];if(t!=null)return t;const n=await(await fetch(e)).text();return t={url:e,cssText:n},mz[e]=t,t}async function pz(e,t){let r=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,o=(r.match(/url\([^)]+\)/g)||[]).map(async i=>{let l=i.replace(n,"$1");return l.startsWith("https://")||(l=new URL(l,e.url).href),Kre(l,t.fetchRequestInit,({result:c})=>(r=r.replace(i,`url(${c})`),[i,c]))});return Promise.all(o).then(()=>r)}function gz(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(r,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=s.exec(n);if(c===null)break;t.push(c[0])}n=n.replace(s,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",l=new RegExp(i,"gi");for(;;){let c=o.exec(n);if(c===null){if(c=l.exec(n),c===null)break;o.lastIndex=l.lastIndex}else l.lastIndex=o.lastIndex;t.push(c[0])}return t}async function zKe(e,t){const r=[],n=[];return e.forEach(s=>{if("cssRules"in s)try{fh(s.cssRules||[]).forEach((o,i)=>{if(o.type===CSSRule.IMPORT_RULE){let l=i+1;const c=o.href,d=hz(c).then(u=>pz(u,t)).then(u=>gz(u).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?l+=1:s.cssRules.length)}catch(h){console.error("Error inserting rule from remote css",{rule:f,error:h})}})).catch(u=>{console.error("Error loading remote css",u.toString())});n.push(d)}})}catch(o){const i=e.find(l=>l.href==null)||document.styleSheets[0];s.href!=null&&n.push(hz(s.href).then(l=>pz(l,t)).then(l=>gz(l).forEach(c=>{i.insertRule(c,i.cssRules.length)})).catch(l=>{console.error("Error loading remote stylesheet",l)})),console.error("Error inlining remote css file",o)}}),Promise.all(n).then(()=>(e.forEach(s=>{if("cssRules"in s)try{fh(s.cssRules||[]).forEach(o=>{r.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${s.href}`,o)}}),r))}function UKe(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>Jre(t.style.getPropertyValue("src")))}async function VKe(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=fh(e.ownerDocument.styleSheets),n=await zKe(r,t);return UKe(n)}function ene(e){return e.trim().replace(/["']/g,"")}function WKe(e){const t=new Set;function r(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(o=>{t.add(ene(o))}),Array.from(n.children).forEach(o=>{o instanceof HTMLElement&&r(o)})}return r(e),t}async function HKe(e,t){const r=await VKe(e,t),n=WKe(e);return(await Promise.all(r.filter(o=>n.has(ene(o.style.fontFamily))).map(o=>{const i=o.parentStyleSheet?o.parentStyleSheet.href:null;return Qre(o.cssText,i,t)}))).join(`
`)}async function GKe(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await HKe(e,t);if(r){const n=document.createElement("style"),s=document.createTextNode(r);n.appendChild(s),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function KKe(e,t={}){const{width:r,height:n}=Hre(e,t),s=await D5(e,t,!0);return await GKe(s,t),await Zre(s,t),qKe(s,t),await fKe(s,r,n)}async function XKe(e,t={}){const{width:r,height:n}=Hre(e,t),s=await KKe(e,t),o=await mS(s),i=document.createElement("canvas"),l=i.getContext("2d"),c=t.pixelRatio||cKe(),d=t.canvasWidth||r,u=t.canvasHeight||n;return i.width=d*c,i.height=u*c,t.skipAutoScale||dKe(i),i.style.width=`${d}`,i.style.height=`${u}`,t.backgroundColor&&(l.fillStyle=t.backgroundColor,l.fillRect(0,0,i.width,i.height)),l.drawImage(o,0,0,i.width,i.height),i}async function YKe(e,t={}){return(await XKe(e,t)).toDataURL()}var mu=Uint8Array,Ac=Uint16Array,VM=Int32Array,WM=new mu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),HM=new mu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),vz=new mu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),tne=function(e,t){for(var r=new Ac(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new VM(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)s[o]=o-r[n]<<5|n;return{b:r,r:s}},rne=tne(WM,2),JKe=rne.b,AT=rne.r;JKe[28]=258,AT[258]=28;var QKe=tne(HM,0),xz=QKe.r,PT=new Ac(32768);for(var zs=0;zs<32768;++zs){var ym=(zs&43690)>>1|(zs&21845)<<1;ym=(ym&52428)>>2|(ym&13107)<<2,ym=(ym&61680)>>4|(ym&3855)<<4,PT[zs]=((ym&65280)>>8|(ym&255)<<8)>>1}var fb=function(e,t,r){for(var n=e.length,s=0,o=new Ac(t);s<n;++s)e[s]&&++o[e[s]-1];var i=new Ac(t);for(s=1;s<t;++s)i[s]=i[s-1]+o[s-1]<<1;var l;if(r){l=new Ac(1<<t);var c=15-t;for(s=0;s<n;++s)if(e[s])for(var d=s<<4|e[s],u=t-e[s],f=i[e[s]-1]++<<u,h=f|(1<<u)-1;f<=h;++f)l[PT[f]>>c]=d}else for(l=new Ac(n),s=0;s<n;++s)e[s]&&(l[s]=PT[i[e[s]-1]++]>>15-e[s]);return l},hg=new mu(288);for(var zs=0;zs<144;++zs)hg[zs]=8;for(var zs=144;zs<256;++zs)hg[zs]=9;for(var zs=256;zs<280;++zs)hg[zs]=7;for(var zs=280;zs<288;++zs)hg[zs]=8;var hS=new mu(32);for(var zs=0;zs<32;++zs)hS[zs]=5;var ZKe=fb(hg,9,0),eXe=fb(hS,5,0),nne=function(e){return(e+7)/8|0},tXe=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new mu(e.subarray(t,r))},hf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},hy=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},iE=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,o=r.slice();if(!s)return{t:sne,l:0};if(s==1){var i=new mu(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(_,C){return _.f-C.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=s-1;)l=r[r[d].f<r[f].f?d++:f++],c=r[d!=u&&r[d].f<r[f].f?d++:f++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var h=o[0].s,n=1;n<s;++n)o[n].s>h&&(h=o[n].s);var m=new Ac(h+1),v=ET(r[u-1],m,0);if(v>t){var n=0,g=0,y=v-t,x=1<<y;for(o.sort(function(C,P){return m[P.s]-m[C.s]||C.f-P.f});n<s;++n){var b=o[n].s;if(m[b]>t)g+=x-(1<<v-m[b]),m[b]=t;else break}for(g>>=y;g>0;){var w=o[n].s;m[w]<t?g-=1<<t-m[w]++-1:++n}for(;n>=0&&g;--n){var j=o[n].s;m[j]==t&&(--m[j],++g)}v=t}return{t:new mu(m),l:v}},ET=function(e,t,r){return e.s==-1?Math.max(ET(e.l,t,r+1),ET(e.r,t,r+1)):t[e.s]=r},yz=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ac(++t),n=0,s=e[0],o=1,i=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==s&&l!=t)++o;else{if(!s&&o>2){for(;o>138;o-=138)i(32754);o>2&&(i(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(i(s),--o;o>6;o-=6)i(8304);o>2&&(i(o-3<<5|8208),o=0)}for(;o--;)i(s);o=1,s=e[l]}return{c:r.subarray(0,n),n:t}},py=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},ane=function(e,t,r){var n=r.length,s=nne(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var o=0;o<n;++o)e[s+o+4]=r[o];return(s+4+n)*8},bz=function(e,t,r,n,s,o,i,l,c,d,u){hf(t,u++,r),++s[256];for(var f=iE(s,15),h=f.t,m=f.l,v=iE(o,15),g=v.t,y=v.l,x=yz(h),b=x.c,w=x.n,j=yz(g),_=j.c,C=j.n,P=new Ac(19),E=0;E<b.length;++E)++P[b[E]&31];for(var E=0;E<_.length;++E)++P[_[E]&31];for(var A=iE(P,7),F=A.t,D=A.l,I=19;I>4&&!F[vz[I-1]];--I);var R=d+5<<3,M=py(s,hg)+py(o,hS)+i,U=py(s,h)+py(o,g)+i+14+3*I+py(P,F)+2*P[16]+3*P[17]+7*P[18];if(c>=0&&R<=M&&R<=U)return ane(t,u,e.subarray(c,c+d));var z,W,$,ee;if(hf(t,u,1+(U<M)),u+=2,U<M){z=fb(h,m,0),W=h,$=fb(g,y,0),ee=g;var ve=fb(F,D,0);hf(t,u,w-257),hf(t,u+5,C-1),hf(t,u+10,I-4),u+=14;for(var E=0;E<I;++E)hf(t,u+3*E,F[vz[E]]);u+=3*I;for(var _e=[b,_],K=0;K<2;++K)for(var q=_e[K],E=0;E<q.length;++E){var Y=q[E]&31;hf(t,u,ve[Y]),u+=F[Y],Y>15&&(hf(t,u,q[E]>>5&127),u+=q[E]>>12)}}else z=ZKe,W=hg,$=eXe,ee=hS;for(var E=0;E<l;++E){var J=n[E];if(J>255){var Y=J>>18&31;hy(t,u,z[Y+257]),u+=W[Y+257],Y>7&&(hf(t,u,J>>23&31),u+=WM[Y]);var fe=J&31;hy(t,u,$[fe]),u+=ee[fe],fe>3&&(hy(t,u,J>>5&8191),u+=HM[fe])}else hy(t,u,z[J]),u+=W[J]}return hy(t,u,z[256]),u+W[256]},rXe=new VM([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),sne=new mu(0),nXe=function(e,t,r,n,s,o){var i=o.z||e.length,l=new mu(n+i+5*(1+Math.ceil(i/7e3))+s),c=l.subarray(n,l.length-s),d=o.l,u=(o.r||0)&7;if(t){u&&(c[0]=o.r>>3);for(var f=rXe[t-1],h=f>>13,m=f&8191,v=(1<<r)-1,g=o.p||new Ac(32768),y=o.h||new Ac(v+1),x=Math.ceil(r/3),b=2*x,w=function(ne){return(e[ne]^e[ne+1]<<x^e[ne+2]<<b)&v},j=new VM(25e3),_=new Ac(288),C=new Ac(32),P=0,E=0,A=o.i||0,F=0,D=o.w||0,I=0;A+2<i;++A){var R=w(A),M=A&32767,U=y[R];if(g[M]=U,y[R]=M,D<=A){var z=i-A;if((P>7e3||F>24576)&&(z>423||!d)){u=bz(e,c,0,j,_,C,E,F,I,A-I,u),F=P=E=0,I=A;for(var W=0;W<286;++W)_[W]=0;for(var W=0;W<30;++W)C[W]=0}var $=2,ee=0,ve=m,_e=M-U&32767;if(z>2&&R==w(A-_e))for(var K=Math.min(h,z)-1,q=Math.min(32767,A),Y=Math.min(258,z);_e<=q&&--ve&&M!=U;){if(e[A+$]==e[A+$-_e]){for(var J=0;J<Y&&e[A+J]==e[A+J-_e];++J);if(J>$){if($=J,ee=_e,J>K)break;for(var fe=Math.min(_e,J-2),Z=0,W=0;W<fe;++W){var ce=A-_e+W&32767,le=g[ce],ie=ce-le&32767;ie>Z&&(Z=ie,U=ce)}}}M=U,U=g[M],_e+=M-U&32767}if(ee){j[F++]=268435456|AT[$]<<18|xz[ee];var te=AT[$]&31,ue=xz[ee]&31;E+=WM[te]+HM[ue],++_[257+te],++C[ue],D=A+$,++P}else j[F++]=e[A],++_[e[A]]}}for(A=Math.max(A,D);A<i;++A)j[F++]=e[A],++_[e[A]];u=bz(e,c,d,j,_,C,E,F,I,A-I,u),d||(o.r=u&7|c[u/8|0]<<3,u-=7,o.h=y,o.p=g,o.i=A,o.w=D)}else{for(var A=o.w||0;A<i+d;A+=65535){var Te=A+65535;Te>=i&&(c[u/8|0]=d,Te=i),u=ane(c,u+1,e.subarray(A,Te))}o.i=i}return tXe(l,0,n+nne(u)+s)},one=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,o=r.length|0,i=0;i!=o;){for(var l=Math.min(i+2655,o);i<l;++i)s+=n+=r[i];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},aXe=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var o=t.dictionary.subarray(-32768),i=new mu(o.length+e.length);i.set(o),i.set(e,o.length),e=i,s.w=o.length}return nXe(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},ine=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},sXe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=one();s.p(t.dictionary),ine(e,2,s.d())}};function kT(e,t){t||(t={});var r=one();r.p(e);var n=aXe(e,t,t.dictionary?6:2,4);return sXe(n,t),ine(n,n.length-4,r.d()),n}var oXe=typeof TextDecoder<"u"&&new TextDecoder,iXe=0;try{oXe.decode(sne,{stream:!0}),iXe=1}catch{}function lXe(e){if(Array.isArray(e))return e}function cXe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function dXe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wz(e,t){return lXe(e)||cXe(e,t)||G1e(e,t)||dXe()}function jz(e,t="utf8"){return new TextDecoder(t).decode(e)}const uXe=new TextEncoder;function fXe(e){return uXe.encode(e)}const mXe=1024*8,hXe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),lE={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class GM{constructor(t=mXe,r={}){ls(this,"buffer");ls(this,"byteLength");ls(this,"byteOffset");ls(this,"length");ls(this,"offset");ls(this,"lastWrittenByte");ls(this,"littleEndian");ls(this,"_data");ls(this,"_mark");ls(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,o=t.byteLength-s;let i=s;(ArrayBuffer.isView(t)||t instanceof GM)&&(t.byteLength!==t.buffer.byteLength&&(i=t.byteOffset+s),t=t.buffer),n?this.lastWrittenByte=o:this.lastWrittenByte=0,this.buffer=t,this.length=o,this.byteLength=o,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,o),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=lE[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,o=this.buffer.slice(s,s+n);if(this.littleEndian===hXe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new lE[r](l.buffer);return this.offset+=n,c.reverse(),c}const i=new lE[r](o);return this.offset+=n,i}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return jz(this.readBytes(t))}decodeText(t=1,r="utf8"){return jz(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(fXe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const pXe=4,_z=0,Nz=1,gXe=2;function O0(e){let t=e.length;for(;--t>=0;)e[t]=0}const vXe=0,lne=1,xXe=2,yXe=3,bXe=258,KM=29,I1=256,$w=I1+1+KM,ox=30,XM=19,cne=2*$w+1,Op=15,cE=16,wXe=7,YM=256,dne=16,une=17,fne=18,IT=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),e_=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),jXe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),mne=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_Xe=512,_f=new Array(($w+2)*2);O0(_f);const mb=new Array(ox*2);O0(mb);const Bw=new Array(_Xe);O0(Bw);const qw=new Array(bXe-yXe+1);O0(qw);const JM=new Array(KM);O0(JM);const pS=new Array(ox);O0(pS);function dE(e,t,r,n,s){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=s,this.has_stree=e&&e.length}let hne,pne,gne;function uE(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const vne=e=>e<256?Bw[e]:Bw[256+(e>>>7)],zw=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Kl=(e,t,r)=>{e.bi_valid>cE-r?(e.bi_buf|=t<<e.bi_valid&65535,zw(e,e.bi_buf),e.bi_buf=t>>cE-e.bi_valid,e.bi_valid+=r-cE):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Tu=(e,t,r)=>{Kl(e,r[t*2],r[t*2+1])},xne=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},NXe=e=>{e.bi_valid===16?(zw(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},SXe=(e,t)=>{const r=t.dyn_tree,n=t.max_code,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let d,u,f,h,m,v,g=0;for(h=0;h<=Op;h++)e.bl_count[h]=0;for(r[e.heap[e.heap_max]*2+1]=0,d=e.heap_max+1;d<cne;d++)u=e.heap[d],h=r[r[u*2+1]*2+1]+1,h>c&&(h=c,g++),r[u*2+1]=h,!(u>n)&&(e.bl_count[h]++,m=0,u>=l&&(m=i[u-l]),v=r[u*2],e.opt_len+=v*(h+m),o&&(e.static_len+=v*(s[u*2+1]+m)));if(g!==0){do{for(h=c-1;e.bl_count[h]===0;)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,g-=2}while(g>0);for(h=c;h!==0;h--)for(u=e.bl_count[h];u!==0;)f=e.heap[--d],!(f>n)&&(r[f*2+1]!==h&&(e.opt_len+=(h-r[f*2+1])*r[f*2],r[f*2+1]=h),u--)}},yne=(e,t,r)=>{const n=new Array(Op+1);let s=0,o,i;for(o=1;o<=Op;o++)s=s+r[o-1]<<1,n[o]=s;for(i=0;i<=t;i++){let l=e[i*2+1];l!==0&&(e[i*2]=xne(n[l]++,l))}},CXe=()=>{let e,t,r,n,s;const o=new Array(Op+1);for(r=0,n=0;n<KM-1;n++)for(JM[n]=r,e=0;e<1<<IT[n];e++)qw[r++]=n;for(qw[r-1]=n,s=0,n=0;n<16;n++)for(pS[n]=s,e=0;e<1<<e_[n];e++)Bw[s++]=n;for(s>>=7;n<ox;n++)for(pS[n]=s<<7,e=0;e<1<<e_[n]-7;e++)Bw[256+s++]=n;for(t=0;t<=Op;t++)o[t]=0;for(e=0;e<=143;)_f[e*2+1]=8,e++,o[8]++;for(;e<=255;)_f[e*2+1]=9,e++,o[9]++;for(;e<=279;)_f[e*2+1]=7,e++,o[7]++;for(;e<=287;)_f[e*2+1]=8,e++,o[8]++;for(yne(_f,$w+1,o),e=0;e<ox;e++)mb[e*2+1]=5,mb[e*2]=xne(e,5);hne=new dE(_f,IT,I1+1,$w,Op),pne=new dE(mb,e_,0,ox,Op),gne=new dE(new Array(0),jXe,0,XM,wXe)},bne=e=>{let t;for(t=0;t<$w;t++)e.dyn_ltree[t*2]=0;for(t=0;t<ox;t++)e.dyn_dtree[t*2]=0;for(t=0;t<XM;t++)e.bl_tree[t*2]=0;e.dyn_ltree[YM*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},wne=e=>{e.bi_valid>8?zw(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Sz=(e,t,r,n)=>{const s=t*2,o=r*2;return e[s]<e[o]||e[s]===e[o]&&n[t]<=n[r]},fE=(e,t,r)=>{const n=e.heap[r];let s=r<<1;for(;s<=e.heap_len&&(s<e.heap_len&&Sz(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!Sz(t,n,e.heap[s],e.depth));)e.heap[r]=e.heap[s],r=s,s<<=1;e.heap[r]=n},Cz=(e,t,r)=>{let n,s,o=0,i,l;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+o++]&255,n+=(e.pending_buf[e.sym_buf+o++]&255)<<8,s=e.pending_buf[e.sym_buf+o++],n===0?Tu(e,s,t):(i=qw[s],Tu(e,i+I1+1,t),l=IT[i],l!==0&&(s-=JM[i],Kl(e,s,l)),n--,i=vne(n),Tu(e,i,r),l=e_[i],l!==0&&(n-=pS[i],Kl(e,n,l)));while(o<e.sym_next);Tu(e,YM,t)},OT=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.elems;let i,l,c=-1,d;for(e.heap_len=0,e.heap_max=cne,i=0;i<o;i++)r[i*2]!==0?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):r[i*2+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=c<2?++c:0,r[d*2]=1,e.depth[d]=0,e.opt_len--,s&&(e.static_len-=n[d*2+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)fE(e,r,i);d=o;do i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],fE(e,r,1),l=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=l,r[d*2]=r[i*2]+r[l*2],e.depth[d]=(e.depth[i]>=e.depth[l]?e.depth[i]:e.depth[l])+1,r[i*2+1]=r[l*2+1]=d,e.heap[1]=d++,fE(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],SXe(e,t),yne(r,c,e.bl_count)},Az=(e,t,r)=>{let n,s=-1,o,i=t[0*2+1],l=0,c=7,d=4;for(i===0&&(c=138,d=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)o=i,i=t[(n+1)*2+1],!(++l<c&&o===i)&&(l<d?e.bl_tree[o*2]+=l:o!==0?(o!==s&&e.bl_tree[o*2]++,e.bl_tree[dne*2]++):l<=10?e.bl_tree[une*2]++:e.bl_tree[fne*2]++,l=0,s=o,i===0?(c=138,d=3):o===i?(c=6,d=3):(c=7,d=4))},Pz=(e,t,r)=>{let n,s=-1,o,i=t[0*2+1],l=0,c=7,d=4;for(i===0&&(c=138,d=3),n=0;n<=r;n++)if(o=i,i=t[(n+1)*2+1],!(++l<c&&o===i)){if(l<d)do Tu(e,o,e.bl_tree);while(--l!==0);else o!==0?(o!==s&&(Tu(e,o,e.bl_tree),l--),Tu(e,dne,e.bl_tree),Kl(e,l-3,2)):l<=10?(Tu(e,une,e.bl_tree),Kl(e,l-3,3)):(Tu(e,fne,e.bl_tree),Kl(e,l-11,7));l=0,s=o,i===0?(c=138,d=3):o===i?(c=6,d=3):(c=7,d=4)}},AXe=e=>{let t;for(Az(e,e.dyn_ltree,e.l_desc.max_code),Az(e,e.dyn_dtree,e.d_desc.max_code),OT(e,e.bl_desc),t=XM-1;t>=3&&e.bl_tree[mne[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},PXe=(e,t,r,n)=>{let s;for(Kl(e,t-257,5),Kl(e,r-1,5),Kl(e,n-4,4),s=0;s<n;s++)Kl(e,e.bl_tree[mne[s]*2+1],3);Pz(e,e.dyn_ltree,t-1),Pz(e,e.dyn_dtree,r-1)},EXe=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return _z;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Nz;for(r=32;r<I1;r++)if(e.dyn_ltree[r*2]!==0)return Nz;return _z};let Ez=!1;const kXe=e=>{Ez||(CXe(),Ez=!0),e.l_desc=new uE(e.dyn_ltree,hne),e.d_desc=new uE(e.dyn_dtree,pne),e.bl_desc=new uE(e.bl_tree,gne),e.bi_buf=0,e.bi_valid=0,bne(e)},jne=(e,t,r,n)=>{Kl(e,(vXe<<1)+(n?1:0),3),wne(e),zw(e,r),zw(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},IXe=e=>{Kl(e,lne<<1,3),Tu(e,YM,_f),NXe(e)},OXe=(e,t,r,n)=>{let s,o,i=0;e.level>0?(e.strm.data_type===gXe&&(e.strm.data_type=EXe(e)),OT(e,e.l_desc),OT(e,e.d_desc),i=AXe(e),s=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=s&&(s=o)):s=o=r+5,r+4<=s&&t!==-1?jne(e,t,r,n):e.strategy===pXe||o===s?(Kl(e,(lne<<1)+(n?1:0),3),Cz(e,_f,mb)):(Kl(e,(xXe<<1)+(n?1:0),3),PXe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),Cz(e,e.dyn_ltree,e.dyn_dtree)),bne(e),n&&wne(e)},TXe=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(qw[r]+I1+1)*2]++,e.dyn_dtree[vne(t)*2]++),e.sym_next===e.sym_end);var DXe=kXe,MXe=jne,RXe=OXe,LXe=TXe,FXe=IXe,$Xe={_tr_init:DXe,_tr_stored_block:MXe,_tr_flush_block:RXe,_tr_tally:LXe,_tr_align:FXe};const BXe=(e,t,r,n)=>{let s=e&65535|0,o=e>>>16&65535|0,i=0;for(;r!==0;){i=r>2e3?2e3:r,r-=i;do s=s+t[n++]|0,o=o+s|0;while(--i);s%=65521,o%=65521}return s|o<<16|0};var Uw=BXe;const qXe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},zXe=new Uint32Array(qXe()),UXe=(e,t,r,n)=>{const s=zXe,o=n+r;e^=-1;for(let i=n;i<o;i++)e=e>>>8^s[(e^t[i])&255];return e^-1};var si=UXe,Qx={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},O1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:VXe,_tr_stored_block:TT,_tr_flush_block:WXe,_tr_tally:mh,_tr_align:HXe}=$Xe,{Z_NO_FLUSH:hh,Z_PARTIAL_FLUSH:GXe,Z_FULL_FLUSH:KXe,Z_FINISH:ud,Z_BLOCK:kz,Z_OK:Ii,Z_STREAM_END:Iz,Z_STREAM_ERROR:Xu,Z_DATA_ERROR:XXe,Z_BUF_ERROR:mE,Z_DEFAULT_COMPRESSION:YXe,Z_FILTERED:JXe,Z_HUFFMAN_ONLY:ij,Z_RLE:QXe,Z_FIXED:ZXe,Z_DEFAULT_STRATEGY:eYe,Z_UNKNOWN:tYe,Z_DEFLATED:M5}=O1,rYe=9,nYe=15,aYe=8,sYe=29,oYe=256,DT=oYe+1+sYe,iYe=30,lYe=19,cYe=2*DT+1,dYe=15,qa=3,Xm=258,Yu=Xm+qa+1,uYe=32,Zx=42,QM=57,MT=69,RT=73,LT=91,FT=103,Tp=113,Oy=666,_l=1,T0=2,pg=3,D0=4,fYe=3,Dp=(e,t)=>(e.msg=Qx[t],t),Oz=e=>e*2-(e>4?9:0),Fm=e=>{let t=e.length;for(;--t>=0;)e[t]=0},mYe=e=>{let t,r,n,s=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=s?r-s:0;while(--t);t=s,n=t;do r=e.prev[--n],e.prev[n]=r>=s?r-s:0;while(--t)};let hYe=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,ph=hYe;const vc=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Pc=(e,t)=>{WXe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,vc(e.strm)},ts=(e,t)=>{e.pending_buf[e.pending++]=t},gy=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},$T=(e,t,r,n)=>{let s=e.avail_in;return s>n&&(s=n),s===0?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),r),e.state.wrap===1?e.adler=Uw(e.adler,t,s,r):e.state.wrap===2&&(e.adler=si(e.adler,t,s,r)),e.next_in+=s,e.total_in+=s,s)},_ne=(e,t)=>{let r=e.max_chain_length,n=e.strstart,s,o,i=e.prev_length,l=e.nice_match;const c=e.strstart>e.w_size-Yu?e.strstart-(e.w_size-Yu):0,d=e.window,u=e.w_mask,f=e.prev,h=e.strstart+Xm;let m=d[n+i-1],v=d[n+i];e.prev_length>=e.good_match&&(r>>=2),l>e.lookahead&&(l=e.lookahead);do if(s=t,!(d[s+i]!==v||d[s+i-1]!==m||d[s]!==d[n]||d[++s]!==d[n+1])){n+=2,s++;do;while(d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&n<h);if(o=Xm-(h-n),n=h-Xm,o>i){if(e.match_start=t,i=o,o>=l)break;m=d[n+i-1],v=d[n+i]}}while((t=f[t&u])>c&&--r!==0);return i<=e.lookahead?i:e.lookahead},e0=e=>{const t=e.w_size;let r,n,s;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Yu)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),mYe(e),n+=t),e.strm.avail_in===0)break;if(r=$T(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=qa)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=ph(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=ph(e,e.ins_h,e.window[s+qa-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<qa)););}while(e.lookahead<Yu&&e.strm.avail_in!==0)},Nne=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,s,o,i=0,l=e.strm.avail_in;do{if(n=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o||(o=e.strm.avail_out-o,s=e.strstart-e.block_start,n>s+e.strm.avail_in&&(n=s+e.strm.avail_in),n>o&&(n=o),n<r&&(n===0&&t!==ud||t===hh||n!==s+e.strm.avail_in)))break;i=t===ud&&n===s+e.strm.avail_in?1:0,TT(e,0,0,i),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,vc(e.strm),s&&(s>n&&(s=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,n-=s),n&&($T(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(i===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?D0:t!==hh&&t!==ud&&e.strm.avail_in===0&&e.strstart===e.block_start?T0:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&($T(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,r=o>e.w_size?e.w_size:o,s=e.strstart-e.block_start,(s>=r||(s||t===ud)&&t!==hh&&e.strm.avail_in===0&&s<=o)&&(n=s>o?o:s,i=t===ud&&e.strm.avail_in===0&&n===s?1:0,TT(e,e.block_start,n,i),e.block_start+=n,vc(e.strm)),i?pg:_l)},hE=(e,t)=>{let r,n;for(;;){if(e.lookahead<Yu){if(e0(e),e.lookahead<Yu&&t===hh)return _l;if(e.lookahead===0)break}if(r=0,e.lookahead>=qa&&(e.ins_h=ph(e,e.ins_h,e.window[e.strstart+qa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Yu&&(e.match_length=_ne(e,r)),e.match_length>=qa)if(n=mh(e,e.strstart-e.match_start,e.match_length-qa),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=qa){e.match_length--;do e.strstart++,e.ins_h=ph(e,e.ins_h,e.window[e.strstart+qa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=ph(e,e.ins_h,e.window[e.strstart+1]);else n=mh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Pc(e,!1),e.strm.avail_out===0))return _l}return e.insert=e.strstart<qa-1?e.strstart:qa-1,t===ud?(Pc(e,!0),e.strm.avail_out===0?pg:D0):e.sym_next&&(Pc(e,!1),e.strm.avail_out===0)?_l:T0},rv=(e,t)=>{let r,n,s;for(;;){if(e.lookahead<Yu){if(e0(e),e.lookahead<Yu&&t===hh)return _l;if(e.lookahead===0)break}if(r=0,e.lookahead>=qa&&(e.ins_h=ph(e,e.ins_h,e.window[e.strstart+qa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=qa-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Yu&&(e.match_length=_ne(e,r),e.match_length<=5&&(e.strategy===JXe||e.match_length===qa&&e.strstart-e.match_start>4096)&&(e.match_length=qa-1)),e.prev_length>=qa&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-qa,n=mh(e,e.strstart-1-e.prev_match,e.prev_length-qa),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=ph(e,e.ins_h,e.window[e.strstart+qa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=qa-1,e.strstart++,n&&(Pc(e,!1),e.strm.avail_out===0))return _l}else if(e.match_available){if(n=mh(e,0,e.window[e.strstart-1]),n&&Pc(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return _l}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=mh(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<qa-1?e.strstart:qa-1,t===ud?(Pc(e,!0),e.strm.avail_out===0?pg:D0):e.sym_next&&(Pc(e,!1),e.strm.avail_out===0)?_l:T0},pYe=(e,t)=>{let r,n,s,o;const i=e.window;for(;;){if(e.lookahead<=Xm){if(e0(e),e.lookahead<=Xm&&t===hh)return _l;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=qa&&e.strstart>0&&(s=e.strstart-1,n=i[s],n===i[++s]&&n===i[++s]&&n===i[++s])){o=e.strstart+Xm;do;while(n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&s<o);e.match_length=Xm-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=qa?(r=mh(e,1,e.match_length-qa),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=mh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Pc(e,!1),e.strm.avail_out===0))return _l}return e.insert=0,t===ud?(Pc(e,!0),e.strm.avail_out===0?pg:D0):e.sym_next&&(Pc(e,!1),e.strm.avail_out===0)?_l:T0},gYe=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(e0(e),e.lookahead===0)){if(t===hh)return _l;break}if(e.match_length=0,r=mh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Pc(e,!1),e.strm.avail_out===0))return _l}return e.insert=0,t===ud?(Pc(e,!0),e.strm.avail_out===0?pg:D0):e.sym_next&&(Pc(e,!1),e.strm.avail_out===0)?_l:T0};function Nu(e,t,r,n,s){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=s}const Ty=[new Nu(0,0,0,0,Nne),new Nu(4,4,8,4,hE),new Nu(4,5,16,8,hE),new Nu(4,6,32,32,hE),new Nu(4,4,16,16,rv),new Nu(8,16,32,32,rv),new Nu(8,16,128,128,rv),new Nu(8,32,128,256,rv),new Nu(32,128,258,1024,rv),new Nu(32,258,258,4096,rv)],vYe=e=>{e.window_size=2*e.w_size,Fm(e.head),e.max_lazy_match=Ty[e.level].max_lazy,e.good_match=Ty[e.level].good_length,e.nice_match=Ty[e.level].nice_length,e.max_chain_length=Ty[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=qa-1,e.match_available=0,e.ins_h=0};function xYe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=M5,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(cYe*2),this.dyn_dtree=new Uint16Array((2*iYe+1)*2),this.bl_tree=new Uint16Array((2*lYe+1)*2),Fm(this.dyn_ltree),Fm(this.dyn_dtree),Fm(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(dYe+1),this.heap=new Uint16Array(2*DT+1),Fm(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*DT+1),Fm(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const T1=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Zx&&t.status!==QM&&t.status!==MT&&t.status!==RT&&t.status!==LT&&t.status!==FT&&t.status!==Tp&&t.status!==Oy?1:0},Sne=e=>{if(T1(e))return Dp(e,Xu);e.total_in=e.total_out=0,e.data_type=tYe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?QM:t.wrap?Zx:Tp,e.adler=t.wrap===2?0:1,t.last_flush=-2,VXe(t),Ii},Cne=e=>{const t=Sne(e);return t===Ii&&vYe(e.state),t},yYe=(e,t)=>T1(e)||e.state.wrap!==2?Xu:(e.state.gzhead=t,Ii),Ane=(e,t,r,n,s,o)=>{if(!e)return Xu;let i=1;if(t===YXe&&(t=6),n<0?(i=0,n=-n):n>15&&(i=2,n-=16),s<1||s>rYe||r!==M5||n<8||n>15||t<0||t>9||o<0||o>ZXe||n===8&&i!==1)return Dp(e,Xu);n===8&&(n=9);const l=new xYe;return e.state=l,l.strm=e,l.status=Zx,l.wrap=i,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+qa-1)/qa),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=t,l.strategy=o,l.method=r,Cne(e)},bYe=(e,t)=>Ane(e,t,M5,nYe,aYe,eYe),wYe=(e,t)=>{if(T1(e)||t>kz||t<0)return e?Dp(e,Xu):Xu;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===Oy&&t!==ud)return Dp(e,e.avail_out===0?mE:Xu);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(vc(e),e.avail_out===0)return r.last_flush=-1,Ii}else if(e.avail_in===0&&Oz(t)<=Oz(n)&&t!==ud)return Dp(e,mE);if(r.status===Oy&&e.avail_in!==0)return Dp(e,mE);if(r.status===Zx&&r.wrap===0&&(r.status=Tp),r.status===Zx){let s=M5+(r.w_bits-8<<4)<<8,o=-1;if(r.strategy>=ij||r.level<2?o=0:r.level<6?o=1:r.level===6?o=2:o=3,s|=o<<6,r.strstart!==0&&(s|=uYe),s+=31-s%31,gy(r,s),r.strstart!==0&&(gy(r,e.adler>>>16),gy(r,e.adler&65535)),e.adler=1,r.status=Tp,vc(e),r.pending!==0)return r.last_flush=-1,Ii}if(r.status===QM){if(e.adler=0,ts(r,31),ts(r,139),ts(r,8),r.gzhead)ts(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),ts(r,r.gzhead.time&255),ts(r,r.gzhead.time>>8&255),ts(r,r.gzhead.time>>16&255),ts(r,r.gzhead.time>>24&255),ts(r,r.level===9?2:r.strategy>=ij||r.level<2?4:0),ts(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(ts(r,r.gzhead.extra.length&255),ts(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=si(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=MT;else if(ts(r,0),ts(r,0),ts(r,0),ts(r,0),ts(r,0),ts(r,r.level===9?2:r.strategy>=ij||r.level<2?4:0),ts(r,fYe),r.status=Tp,vc(e),r.pending!==0)return r.last_flush=-1,Ii}if(r.status===MT){if(r.gzhead.extra){let s=r.pending,o=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+o>r.pending_buf_size;){let l=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+l),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>s&&(e.adler=si(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex+=l,vc(e),r.pending!==0)return r.last_flush=-1,Ii;s=0,o-=l}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending+=o,r.gzhead.hcrc&&r.pending>s&&(e.adler=si(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=RT}if(r.status===RT){if(r.gzhead.name){let s=r.pending,o;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(e.adler=si(e.adler,r.pending_buf,r.pending-s,s)),vc(e),r.pending!==0)return r.last_flush=-1,Ii;s=0}r.gzindex<r.gzhead.name.length?o=r.gzhead.name.charCodeAt(r.gzindex++)&255:o=0,ts(r,o)}while(o!==0);r.gzhead.hcrc&&r.pending>s&&(e.adler=si(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=LT}if(r.status===LT){if(r.gzhead.comment){let s=r.pending,o;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(e.adler=si(e.adler,r.pending_buf,r.pending-s,s)),vc(e),r.pending!==0)return r.last_flush=-1,Ii;s=0}r.gzindex<r.gzhead.comment.length?o=r.gzhead.comment.charCodeAt(r.gzindex++)&255:o=0,ts(r,o)}while(o!==0);r.gzhead.hcrc&&r.pending>s&&(e.adler=si(e.adler,r.pending_buf,r.pending-s,s))}r.status=FT}if(r.status===FT){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(vc(e),r.pending!==0))return r.last_flush=-1,Ii;ts(r,e.adler&255),ts(r,e.adler>>8&255),e.adler=0}if(r.status=Tp,vc(e),r.pending!==0)return r.last_flush=-1,Ii}if(e.avail_in!==0||r.lookahead!==0||t!==hh&&r.status!==Oy){let s=r.level===0?Nne(r,t):r.strategy===ij?gYe(r,t):r.strategy===QXe?pYe(r,t):Ty[r.level].func(r,t);if((s===pg||s===D0)&&(r.status=Oy),s===_l||s===pg)return e.avail_out===0&&(r.last_flush=-1),Ii;if(s===T0&&(t===GXe?HXe(r):t!==kz&&(TT(r,0,0,!1),t===KXe&&(Fm(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),vc(e),e.avail_out===0))return r.last_flush=-1,Ii}return t!==ud?Ii:r.wrap<=0?Iz:(r.wrap===2?(ts(r,e.adler&255),ts(r,e.adler>>8&255),ts(r,e.adler>>16&255),ts(r,e.adler>>24&255),ts(r,e.total_in&255),ts(r,e.total_in>>8&255),ts(r,e.total_in>>16&255),ts(r,e.total_in>>24&255)):(gy(r,e.adler>>>16),gy(r,e.adler&65535)),vc(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Ii:Iz)},jYe=e=>{if(T1(e))return Xu;const t=e.state.status;return e.state=null,t===Tp?Dp(e,XXe):Ii},_Ye=(e,t)=>{let r=t.length;if(T1(e))return Xu;const n=e.state,s=n.wrap;if(s===2||s===1&&n.status!==Zx||n.lookahead)return Xu;if(s===1&&(e.adler=Uw(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){s===0&&(Fm(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(t.subarray(r-n.w_size,r),0),t=c,r=n.w_size}const o=e.avail_in,i=e.next_in,l=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,e0(n);n.lookahead>=qa;){let c=n.strstart,d=n.lookahead-(qa-1);do n.ins_h=ph(n,n.ins_h,n.window[c+qa-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--d);n.strstart=c,n.lookahead=qa-1,e0(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=qa-1,n.match_available=0,e.next_in=i,e.input=l,e.avail_in=o,n.wrap=s,Ii};var NYe=bYe,SYe=Ane,CYe=Cne,AYe=Sne,PYe=yYe,EYe=wYe,kYe=jYe,IYe=_Ye,OYe="pako deflate (from Nodeca project)",hb={deflateInit:NYe,deflateInit2:SYe,deflateReset:CYe,deflateResetKeep:AYe,deflateSetHeader:PYe,deflate:EYe,deflateEnd:kYe,deflateSetDictionary:IYe,deflateInfo:OYe};const TYe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var DYe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)TYe(r,n)&&(e[n]=r[n])}}return e},MYe=e=>{let t=0;for(let n=0,s=e.length;n<s;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,s=0,o=e.length;n<o;n++){let i=e[n];r.set(i,s),s+=i.length}return r},R5={assign:DYe,flattenChunks:MYe};let Pne=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Pne=!1}const Vw=new Uint8Array(256);for(let e=0;e<256;e++)Vw[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Vw[254]=Vw[254]=1;var RYe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,s,o,i=e.length,l=0;for(s=0;s<i;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),o=0,s=0;o<l;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|r&63):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|r&63):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|r&63);return t};const LYe=(e,t)=>{if(t<65534&&e.subarray&&Pne)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var FYe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,s;const o=new Array(r*2);for(s=0,n=0;n<r;){let i=e[n++];if(i<128){o[s++]=i;continue}let l=Vw[i];if(l>4){o[s++]=65533,n+=l-1;continue}for(i&=l===2?31:l===3?15:7;l>1&&n<r;)i=i<<6|e[n++]&63,l--;if(l>1){o[s++]=65533;continue}i<65536?o[s++]=i:(i-=65536,o[s++]=55296|i>>10&1023,o[s++]=56320|i&1023)}return LYe(o,s)},$Ye=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+Vw[e[r]]>t?r:t},Ww={string2buf:RYe,buf2string:FYe,utf8border:$Ye};function BYe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ene=BYe;const kne=Object.prototype.toString,{Z_NO_FLUSH:qYe,Z_SYNC_FLUSH:zYe,Z_FULL_FLUSH:UYe,Z_FINISH:VYe,Z_OK:gS,Z_STREAM_END:WYe,Z_DEFAULT_COMPRESSION:HYe,Z_DEFAULT_STRATEGY:GYe,Z_DEFLATED:KYe}=O1;function ZM(e){this.options=R5.assign({level:HYe,method:KYe,chunkSize:16384,windowBits:15,memLevel:8,strategy:GYe},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ene,this.strm.avail_out=0;let r=hb.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==gS)throw new Error(Qx[r]);if(t.header&&hb.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Ww.string2buf(t.dictionary):kne.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=hb.deflateSetDictionary(this.strm,n),r!==gS)throw new Error(Qx[r]);this._dict_set=!0}}ZM.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let s,o;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?VYe:qYe,typeof e=="string"?r.input=Ww.string2buf(e):kne.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===zYe||o===UYe)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(s=hb.deflate(r,o),s===WYe)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),s=hb.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===gS;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};ZM.prototype.onData=function(e){this.chunks.push(e)};ZM.prototype.onEnd=function(e){e===gS&&(this.result=R5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const lj=16209,XYe=16191;var YYe=function(t,r){let n,s,o,i,l,c,d,u,f,h,m,v,g,y,x,b,w,j,_,C,P,E,A,F;const D=t.state;n=t.next_in,A=t.input,s=n+(t.avail_in-5),o=t.next_out,F=t.output,i=o-(r-t.avail_out),l=o+(t.avail_out-257),c=D.dmax,d=D.wsize,u=D.whave,f=D.wnext,h=D.window,m=D.hold,v=D.bits,g=D.lencode,y=D.distcode,x=(1<<D.lenbits)-1,b=(1<<D.distbits)-1;e:do{v<15&&(m+=A[n++]<<v,v+=8,m+=A[n++]<<v,v+=8),w=g[m&x];t:for(;;){if(j=w>>>24,m>>>=j,v-=j,j=w>>>16&255,j===0)F[o++]=w&65535;else if(j&16){_=w&65535,j&=15,j&&(v<j&&(m+=A[n++]<<v,v+=8),_+=m&(1<<j)-1,m>>>=j,v-=j),v<15&&(m+=A[n++]<<v,v+=8,m+=A[n++]<<v,v+=8),w=y[m&b];r:for(;;){if(j=w>>>24,m>>>=j,v-=j,j=w>>>16&255,j&16){if(C=w&65535,j&=15,v<j&&(m+=A[n++]<<v,v+=8,v<j&&(m+=A[n++]<<v,v+=8)),C+=m&(1<<j)-1,C>c){t.msg="invalid distance too far back",D.mode=lj;break e}if(m>>>=j,v-=j,j=o-i,C>j){if(j=C-j,j>u&&D.sane){t.msg="invalid distance too far back",D.mode=lj;break e}if(P=0,E=h,f===0){if(P+=d-j,j<_){_-=j;do F[o++]=h[P++];while(--j);P=o-C,E=F}}else if(f<j){if(P+=d+f-j,j-=f,j<_){_-=j;do F[o++]=h[P++];while(--j);if(P=0,f<_){j=f,_-=j;do F[o++]=h[P++];while(--j);P=o-C,E=F}}}else if(P+=f-j,j<_){_-=j;do F[o++]=h[P++];while(--j);P=o-C,E=F}for(;_>2;)F[o++]=E[P++],F[o++]=E[P++],F[o++]=E[P++],_-=3;_&&(F[o++]=E[P++],_>1&&(F[o++]=E[P++]))}else{P=o-C;do F[o++]=F[P++],F[o++]=F[P++],F[o++]=F[P++],_-=3;while(_>2);_&&(F[o++]=F[P++],_>1&&(F[o++]=F[P++]))}}else if(j&64){t.msg="invalid distance code",D.mode=lj;break e}else{w=y[(w&65535)+(m&(1<<j)-1)];continue r}break}}else if(j&64)if(j&32){D.mode=XYe;break e}else{t.msg="invalid literal/length code",D.mode=lj;break e}else{w=g[(w&65535)+(m&(1<<j)-1)];continue t}break}}while(n<s&&o<l);_=v>>3,n-=_,v-=_<<3,m&=(1<<v)-1,t.next_in=n,t.next_out=o,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=o<l?257+(l-o):257-(o-l),D.hold=m,D.bits=v};const nv=15,Tz=852,Dz=592,Mz=0,pE=1,Rz=2,JYe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),QYe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ZYe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),eJe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),tJe=(e,t,r,n,s,o,i,l)=>{const c=l.bits;let d=0,u=0,f=0,h=0,m=0,v=0,g=0,y=0,x=0,b=0,w,j,_,C,P,E=null,A;const F=new Uint16Array(nv+1),D=new Uint16Array(nv+1);let I=null,R,M,U;for(d=0;d<=nv;d++)F[d]=0;for(u=0;u<n;u++)F[t[r+u]]++;for(m=c,h=nv;h>=1&&F[h]===0;h--);if(m>h&&(m=h),h===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<h&&F[f]===0;f++);for(m<f&&(m=f),y=1,d=1;d<=nv;d++)if(y<<=1,y-=F[d],y<0)return-1;if(y>0&&(e===Mz||h!==1))return-1;for(D[1]=0,d=1;d<nv;d++)D[d+1]=D[d]+F[d];for(u=0;u<n;u++)t[r+u]!==0&&(i[D[t[r+u]]++]=u);if(e===Mz?(E=I=i,A=20):e===pE?(E=JYe,I=QYe,A=257):(E=ZYe,I=eJe,A=0),b=0,u=0,d=f,P=o,v=m,g=0,_=-1,x=1<<m,C=x-1,e===pE&&x>Tz||e===Rz&&x>Dz)return 1;for(;;){R=d-g,i[u]+1<A?(M=0,U=i[u]):i[u]>=A?(M=I[i[u]-A],U=E[i[u]-A]):(M=32+64,U=0),w=1<<d-g,j=1<<v,f=j;do j-=w,s[P+(b>>g)+j]=R<<24|M<<16|U|0;while(j!==0);for(w=1<<d-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,u++,--F[d]===0){if(d===h)break;d=t[r+i[u]]}if(d>m&&(b&C)!==_){for(g===0&&(g=m),P+=f,v=d-g,y=1<<v;v+g<h&&(y-=F[v+g],!(y<=0));)v++,y<<=1;if(x+=1<<v,e===pE&&x>Tz||e===Rz&&x>Dz)return 1;_=b&C,s[_]=m<<24|v<<16|P-o|0}}return b!==0&&(s[P+b]=d-g<<24|64<<16|0),l.bits=m,0};var pb=tJe;const rJe=0,Ine=1,One=2,{Z_FINISH:Lz,Z_BLOCK:nJe,Z_TREES:cj,Z_OK:gg,Z_STREAM_END:aJe,Z_NEED_DICT:sJe,Z_STREAM_ERROR:Pd,Z_DATA_ERROR:Tne,Z_MEM_ERROR:Dne,Z_BUF_ERROR:oJe,Z_DEFLATED:Fz}=O1,L5=16180,$z=16181,Bz=16182,qz=16183,zz=16184,Uz=16185,Vz=16186,Wz=16187,Hz=16188,Gz=16189,vS=16190,pf=16191,gE=16192,Kz=16193,vE=16194,Xz=16195,Yz=16196,Jz=16197,Qz=16198,dj=16199,uj=16200,Zz=16201,e9=16202,t9=16203,r9=16204,n9=16205,xE=16206,a9=16207,s9=16208,Hs=16209,Mne=16210,Rne=16211,iJe=852,lJe=592,cJe=15,dJe=cJe,o9=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function uJe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Tg=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<L5||t.mode>Rne?1:0},Lne=e=>{if(Tg(e))return Pd;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=L5,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(iJe),t.distcode=t.distdyn=new Int32Array(lJe),t.sane=1,t.back=-1,gg},Fne=e=>{if(Tg(e))return Pd;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Lne(e)},$ne=(e,t)=>{let r;if(Tg(e))return Pd;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Pd:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Fne(e))},Bne=(e,t)=>{if(!e)return Pd;const r=new uJe;e.state=r,r.strm=e,r.window=null,r.mode=L5;const n=$ne(e,t);return n!==gg&&(e.state=null),n},fJe=e=>Bne(e,dJe);let i9=!0,yE,bE;const mJe=e=>{if(i9){yE=new Int32Array(512),bE=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(pb(Ine,e.lens,0,288,yE,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;pb(One,e.lens,0,32,bE,0,e.work,{bits:5}),i9=!1}e.lencode=yE,e.lenbits=9,e.distcode=bE,e.distbits=5},qne=(e,t,r,n)=>{let s;const o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>n&&(s=n),o.window.set(t.subarray(r-n,r-n+s),o.wnext),n-=s,n?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0},hJe=(e,t)=>{let r,n,s,o,i,l,c,d,u,f,h,m,v,g,y=0,x,b,w,j,_,C,P,E;const A=new Uint8Array(4);let F,D;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Tg(e)||!e.output||!e.input&&e.avail_in!==0)return Pd;r=e.state,r.mode===pf&&(r.mode=gE),i=e.next_out,s=e.output,c=e.avail_out,o=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,f=l,h=c,E=gg;e:for(;;)switch(r.mode){case L5:if(r.wrap===0){r.mode=gE;break}for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,A[0]=d&255,A[1]=d>>>8&255,r.check=si(r.check,A,2,0),d=0,u=0,r.mode=$z;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=Hs;break}if((d&15)!==Fz){e.msg="unknown compression method",r.mode=Hs;break}if(d>>>=4,u-=4,P=(d&15)+8,r.wbits===0&&(r.wbits=P),P>15||P>r.wbits){e.msg="invalid window size",r.mode=Hs;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?Gz:pf,d=0,u=0;break;case $z:for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.flags=d,(r.flags&255)!==Fz){e.msg="unknown compression method",r.mode=Hs;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Hs;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,r.check=si(r.check,A,2,0)),d=0,u=0,r.mode=Bz;case Bz:for(;u<32;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,A[2]=d>>>16&255,A[3]=d>>>24&255,r.check=si(r.check,A,4,0)),d=0,u=0,r.mode=qz;case qz:for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,r.check=si(r.check,A,2,0)),d=0,u=0,r.mode=zz;case zz:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,r.check=si(r.check,A,2,0)),d=0,u=0}else r.head&&(r.head.extra=null);r.mode=Uz;case Uz:if(r.flags&1024&&(m=r.length,m>l&&(m=l),m&&(r.head&&(P=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+m),P)),r.flags&512&&r.wrap&4&&(r.check=si(r.check,n,m,o)),l-=m,o+=m,r.length-=m),r.length))break e;r.length=0,r.mode=Vz;case Vz:if(r.flags&2048){if(l===0)break e;m=0;do P=n[o+m++],r.head&&P&&r.length<65536&&(r.head.name+=String.fromCharCode(P));while(P&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=si(r.check,n,m,o)),l-=m,o+=m,P)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Wz;case Wz:if(r.flags&4096){if(l===0)break e;m=0;do P=n[o+m++],r.head&&P&&r.length<65536&&(r.head.comment+=String.fromCharCode(P));while(P&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=si(r.check,n,m,o)),l-=m,o+=m,P)break e}else r.head&&(r.head.comment=null);r.mode=Hz;case Hz:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Hs;break}d=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=pf;break;case Gz:for(;u<32;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}e.adler=r.check=o9(d),d=0,u=0,r.mode=vS;case vS:if(r.havedict===0)return e.next_out=i,e.avail_out=c,e.next_in=o,e.avail_in=l,r.hold=d,r.bits=u,sJe;e.adler=r.check=1,r.mode=pf;case pf:if(t===nJe||t===cj)break e;case gE:if(r.last){d>>>=u&7,u-=u&7,r.mode=xE;break}for(;u<3;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}switch(r.last=d&1,d>>>=1,u-=1,d&3){case 0:r.mode=Kz;break;case 1:if(mJe(r),r.mode=dj,t===cj){d>>>=2,u-=2;break e}break;case 2:r.mode=Yz;break;case 3:e.msg="invalid block type",r.mode=Hs}d>>>=2,u-=2;break;case Kz:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Hs;break}if(r.length=d&65535,d=0,u=0,r.mode=vE,t===cj)break e;case vE:r.mode=Xz;case Xz:if(m=r.length,m){if(m>l&&(m=l),m>c&&(m=c),m===0)break e;s.set(n.subarray(o,o+m),i),l-=m,o+=m,c-=m,i+=m,r.length-=m;break}r.mode=pf;break;case Yz:for(;u<14;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.nlen=(d&31)+257,d>>>=5,u-=5,r.ndist=(d&31)+1,d>>>=5,u-=5,r.ncode=(d&15)+4,d>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Hs;break}r.have=0,r.mode=Jz;case Jz:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.lens[I[r.have++]]=d&7,d>>>=3,u-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,F={bits:r.lenbits},E=pb(rJe,r.lens,0,19,r.lencode,0,r.work,F),r.lenbits=F.bits,E){e.msg="invalid code lengths set",r.mode=Hs;break}r.have=0,r.mode=Qz;case Qz:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[d&(1<<r.lenbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(w<16)d>>>=x,u-=x,r.lens[r.have++]=w;else{if(w===16){for(D=x+2;u<D;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(d>>>=x,u-=x,r.have===0){e.msg="invalid bit length repeat",r.mode=Hs;break}P=r.lens[r.have-1],m=3+(d&3),d>>>=2,u-=2}else if(w===17){for(D=x+3;u<D;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}d>>>=x,u-=x,P=0,m=3+(d&7),d>>>=3,u-=3}else{for(D=x+7;u<D;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}d>>>=x,u-=x,P=0,m=11+(d&127),d>>>=7,u-=7}if(r.have+m>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Hs;break}for(;m--;)r.lens[r.have++]=P}}if(r.mode===Hs)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Hs;break}if(r.lenbits=9,F={bits:r.lenbits},E=pb(Ine,r.lens,0,r.nlen,r.lencode,0,r.work,F),r.lenbits=F.bits,E){e.msg="invalid literal/lengths set",r.mode=Hs;break}if(r.distbits=6,r.distcode=r.distdyn,F={bits:r.distbits},E=pb(One,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,F),r.distbits=F.bits,E){e.msg="invalid distances set",r.mode=Hs;break}if(r.mode=dj,t===cj)break e;case dj:r.mode=uj;case uj:if(l>=6&&c>=258){e.next_out=i,e.avail_out=c,e.next_in=o,e.avail_in=l,r.hold=d,r.bits=u,YYe(e,h),i=e.next_out,s=e.output,c=e.avail_out,o=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,r.mode===pf&&(r.back=-1);break}for(r.back=0;y=r.lencode[d&(1<<r.lenbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(b&&!(b&240)){for(j=x,_=b,C=w;y=r.lencode[C+((d&(1<<j+_)-1)>>j)],x=y>>>24,b=y>>>16&255,w=y&65535,!(j+x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=x,u-=x,r.back+=x,r.length=w,b===0){r.mode=n9;break}if(b&32){r.back=-1,r.mode=pf;break}if(b&64){e.msg="invalid literal/length code",r.mode=Hs;break}r.extra=b&15,r.mode=Zz;case Zz:if(r.extra){for(D=r.extra;u<D;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=e9;case e9:for(;y=r.distcode[d&(1<<r.distbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(!(b&240)){for(j=x,_=b,C=w;y=r.distcode[C+((d&(1<<j+_)-1)>>j)],x=y>>>24,b=y>>>16&255,w=y&65535,!(j+x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=x,u-=x,r.back+=x,b&64){e.msg="invalid distance code",r.mode=Hs;break}r.offset=w,r.extra=b&15,r.mode=t9;case t9:if(r.extra){for(D=r.extra;u<D;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Hs;break}r.mode=r9;case r9:if(c===0)break e;if(m=h-c,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Hs;break}m>r.wnext?(m-=r.wnext,v=r.wsize-m):v=r.wnext-m,m>r.length&&(m=r.length),g=r.window}else g=s,v=i-r.offset,m=r.length;m>c&&(m=c),c-=m,r.length-=m;do s[i++]=g[v++];while(--m);r.length===0&&(r.mode=uj);break;case n9:if(c===0)break e;s[i++]=r.length,c--,r.mode=uj;break;case xE:if(r.wrap){for(;u<32;){if(l===0)break e;l--,d|=n[o++]<<u,u+=8}if(h-=c,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?si(r.check,s,h,i-h):Uw(r.check,s,h,i-h)),h=c,r.wrap&4&&(r.flags?d:o9(d))!==r.check){e.msg="incorrect data check",r.mode=Hs;break}d=0,u=0}r.mode=a9;case a9:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Hs;break}d=0,u=0}r.mode=s9;case s9:E=aJe;break e;case Hs:E=Tne;break e;case Mne:return Dne;case Rne:default:return Pd}return e.next_out=i,e.avail_out=c,e.next_in=o,e.avail_in=l,r.hold=d,r.bits=u,(r.wsize||h!==e.avail_out&&r.mode<Hs&&(r.mode<xE||t!==Lz))&&qne(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?si(r.check,s,h,e.next_out-h):Uw(r.check,s,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===pf?128:0)+(r.mode===dj||r.mode===vE?256:0),(f===0&&h===0||t===Lz)&&E===gg&&(E=oJe),E},pJe=e=>{if(Tg(e))return Pd;let t=e.state;return t.window&&(t.window=null),e.state=null,gg},gJe=(e,t)=>{if(Tg(e))return Pd;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,gg):Pd},vJe=(e,t)=>{const r=t.length;let n,s,o;return Tg(e)||(n=e.state,n.wrap!==0&&n.mode!==vS)?Pd:n.mode===vS&&(s=1,s=Uw(s,t,r,0),s!==n.check)?Tne:(o=qne(e,t,r,r),o?(n.mode=Mne,Dne):(n.havedict=1,gg))};var xJe=Fne,yJe=$ne,bJe=Lne,wJe=fJe,jJe=Bne,_Je=hJe,NJe=pJe,SJe=gJe,CJe=vJe,AJe="pako inflate (from Nodeca project)",Nf={inflateReset:xJe,inflateReset2:yJe,inflateResetKeep:bJe,inflateInit:wJe,inflateInit2:jJe,inflate:_Je,inflateEnd:NJe,inflateGetHeader:SJe,inflateSetDictionary:CJe,inflateInfo:AJe};function PJe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var EJe=PJe;const zne=Object.prototype.toString,{Z_NO_FLUSH:kJe,Z_FINISH:IJe,Z_OK:Hw,Z_STREAM_END:wE,Z_NEED_DICT:jE,Z_STREAM_ERROR:OJe,Z_DATA_ERROR:l9,Z_MEM_ERROR:TJe}=O1;function D1(e){this.options=R5.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ene,this.strm.avail_out=0;let r=Nf.inflateInit2(this.strm,t.windowBits);if(r!==Hw)throw new Error(Qx[r]);if(this.header=new EJe,Nf.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Ww.string2buf(t.dictionary):zne.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Nf.inflateSetDictionary(this.strm,t.dictionary),r!==Hw)))throw new Error(Qx[r])}D1.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let o,i,l;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?IJe:kJe,zne.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=Nf.inflate(r,i),o===jE&&s&&(o=Nf.inflateSetDictionary(r,s),o===Hw?o=Nf.inflate(r,i):o===l9&&(o=jE));r.avail_in>0&&o===wE&&r.state.wrap>0&&e[r.next_in]!==0;)Nf.inflateReset(r),o=Nf.inflate(r,i);switch(o){case OJe:case l9:case jE:case TJe:return this.onEnd(o),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||o===wE))if(this.options.to==="string"){let c=Ww.utf8border(r.output,r.next_out),d=r.next_out-c,u=Ww.buf2string(r.output,c);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===Hw&&l===0)){if(o===wE)return o=Nf.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};D1.prototype.onData=function(e){this.chunks.push(e)};D1.prototype.onEnd=function(e){e===Hw&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=R5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function eR(e,t){const r=new D1(t);if(r.push(e),r.err)throw r.msg||Qx[r.err];return r.result}function DJe(e,t){return t=t||{},t.raw=!0,eR(e,t)}var MJe=D1,RJe=eR,LJe=DJe,FJe=eR,$Je=O1,BJe={Inflate:MJe,inflate:RJe,inflateRaw:LJe,ungzip:FJe,constants:$Je};const{Inflate:qJe,inflate:zJe,inflateRaw:tct,ungzip:rct}=BJe;var c9=qJe,UJe=zJe;const Une=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;Une[e]=t}const d9=4294967295;function VJe(e,t,r){let n=e;for(let s=0;s<r;s++)n=Une[(n^t[s])&255]^n>>>8;return n}function WJe(e,t){return(VJe(d9,e,t)^d9)>>>0}function u9(e,t,r){const n=e.readUint32(),s=WJe(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function Vne(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function Wne(e,t,r,n){let s=0;for(;s<n;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-n]&255}function Hne(e,t,r,n){let s=0;if(r.length===0)for(;s<n;s++)t[s]=e[s];else for(;s<n;s++)t[s]=e[s]+r[s]&255}function Gne(e,t,r,n,s){let o=0;if(r.length===0){for(;o<s;o++)t[o]=e[o];for(;o<n;o++)t[o]=e[o]+(t[o-s]>>1)&255}else{for(;o<s;o++)t[o]=e[o]+(r[o]>>1)&255;for(;o<n;o++)t[o]=e[o]+(t[o-s]+r[o]>>1)&255}}function Kne(e,t,r,n,s){let o=0;if(r.length===0){for(;o<s;o++)t[o]=e[o];for(;o<n;o++)t[o]=e[o]+t[o-s]&255}else{for(;o<s;o++)t[o]=e[o]+r[o]&255;for(;o<n;o++)t[o]=e[o]+HJe(t[o-s],r[o],r[o-s])&255}}function HJe(e,t,r){const n=e+t-r,s=Math.abs(n-e),o=Math.abs(n-t),i=Math.abs(n-r);return s<=o&&s<=i?e:o<=i?t:r}function GJe(e,t,r,n,s,o){switch(e){case 0:Vne(t,r,s);break;case 1:Wne(t,r,s,o);break;case 2:Hne(t,r,n,s);break;case 3:Gne(t,r,n,s,o);break;case 4:Kne(t,r,n,s,o);break;default:throw new Error(`Unsupported filter: ${e}`)}}const KJe=new Uint16Array([255]),XJe=new Uint8Array(KJe.buffer),YJe=XJe[0]===255;function JJe(e){const{data:t,width:r,height:n,channels:s,depth:o}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(o/8)*s,c=new Uint8Array(n*r*l);let d=0;for(let u=0;u<7;u++){const f=i[u],h=Math.ceil((r-f.x)/f.xStep),m=Math.ceil((n-f.y)/f.yStep);if(h<=0||m<=0)continue;const v=h*l,g=new Uint8Array(v);for(let y=0;y<m;y++){const x=t[d++],b=t.subarray(d,d+v);d+=v;const w=new Uint8Array(v);GJe(x,b,w,g,v,l),g.set(w);for(let j=0;j<h;j++){const _=f.x+j*f.xStep,C=f.y+y*f.yStep;if(!(_>=r||C>=n))for(let P=0;P<l;P++)c[(C*r+_)*l+P]=w[j*l+P]}}}if(o===16){const u=new Uint16Array(c.buffer);if(YJe)for(let f=0;f<u.length;f++)u[f]=QJe(u[f]);return u}else return c}function QJe(e){return(e&255)<<8|e>>8&255}const ZJe=new Uint16Array([255]),eQe=new Uint8Array(ZJe.buffer),tQe=eQe[0]===255,rQe=new Uint8Array(0);function f9(e){const{data:t,width:r,height:n,channels:s,depth:o}=e,i=Math.ceil(o/8)*s,l=Math.ceil(o/8*s*r),c=new Uint8Array(n*l);let d=rQe,u=0,f,h;for(let m=0;m<n;m++){switch(f=t.subarray(u+1,u+1+l),h=c.subarray(m*l,(m+1)*l),t[u]){case 0:Vne(f,h,l);break;case 1:Wne(f,h,l,i);break;case 2:Hne(f,h,d,l);break;case 3:Gne(f,h,d,l,i);break;case 4:Kne(f,h,d,l,i);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}d=h,u+=l+1}if(o===16){const m=new Uint16Array(c.buffer);if(tQe)for(let v=0;v<m.length;v++)m[v]=nQe(m[v]);return m}else return c}function nQe(e){return(e&255)<<8|e>>8&255}const t_=Uint8Array.of(137,80,78,71,13,10,26,10);function m9(e){if(!aQe(e.readBytes(t_.length)))throw new Error("wrong PNG signature")}function aQe(e){if(e.length<t_.length)return!1;for(let t=0;t<t_.length;t++)if(e[t]!==t_[t])return!1;return!0}const sQe="tEXt",oQe=0,Xne=new TextDecoder("latin1");function iQe(e){if(cQe(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const lQe=/^[\u0000-\u00FF]*$/;function cQe(e){if(!lQe.test(e))throw new Error("invalid latin1 text")}function dQe(e,t,r){const n=Yne(t);e[n]=uQe(t,r-n.length-1)}function Yne(e){for(e.mark();e.readByte()!==oQe;);const t=e.offset;e.reset();const r=Xne.decode(e.readBytes(t-e.offset-1));return e.skip(1),iQe(r),r}function uQe(e,t){return Xne.decode(e.readBytes(t))}const mc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},_E={UNKNOWN:-1,DEFLATE:0},h9={UNKNOWN:-1,ADAPTIVE:0},NE={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},fj={NONE:0,BACKGROUND:1,PREVIOUS:2},SE={SOURCE:0,OVER:1};class fQe extends GM{constructor(r,n={}){super(r);ls(this,"_checkCrc");ls(this,"_inflator");ls(this,"_png");ls(this,"_apng");ls(this,"_end");ls(this,"_hasPalette");ls(this,"_palette");ls(this,"_hasTransparency");ls(this,"_transparency");ls(this,"_compressionMethod");ls(this,"_filterMethod");ls(this,"_interlaceMethod");ls(this,"_colorType");ls(this,"_isAnimated");ls(this,"_numberOfFrames");ls(this,"_numberOfPlays");ls(this,"_frames");ls(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new c9,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=_E.UNKNOWN,this._filterMethod=h9.UNKNOWN,this._interlaceMethod=NE.UNKNOWN,this._colorType=mc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(m9(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(m9(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case sQe:dQe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?u9(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?u9(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=mQe(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case mc.GREYSCALE:s=1;break;case mc.TRUECOLOUR:s=3;break;case mc.INDEXED_COLOUR:s=1;break;case mc.GREYSCALE_ALPHA:s=2;break;case mc.TRUECOLOUR_ALPHA:s=4;break;case mc.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==_E.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let o=0;o<n;o++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case mc.GREYSCALE:case mc.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case mc.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case mc.UNKNOWN:case mc.GREYSCALE_ALPHA:case mc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Yne(this),s=this.readUint8();if(s!==_E.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const o=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:UJe(o)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=f9({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const o=this._apng.frames.at(r-1);this.disposeFrame(s,o,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case fj.NONE:break;case fj.BACKGROUND:for(let o=0;o<this._png.height;o++)for(let i=0;i<this._png.width;i++){const l=(o*r.width+i)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case fj.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,o=(i,l)=>{const c=((i+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,d=(i*n.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(n.blendOp){case SE.SOURCE:for(let i=0;i<n.height;i++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=o(i,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[d+u]}break;case SE.OVER:for(let i=0;i<n.height;i++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=o(i,l);for(let u=0;u<this._png.channels;u++){const f=n.data[d+this._png.channels-1]/s,h=u%(this._png.channels-1)===0?1:n.data[d+u],m=Math.floor(f*h+(1-f)*r.data[c+u]);r.data[c+u]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==h9.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===NE.NO_INTERLACE)this._png.data=f9({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===NE.ADAM7)this._png.data=JJe({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:fj.NONE,blendOp:SE.SOURCE,data:r}),this._inflator=new c9,this._writingDataChunks=!1}}function mQe(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var p9;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(p9||(p9={}));function hQe(e,t){return new fQe(e,t).decode()}var ua=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function CE(){ua.console&&typeof ua.console.log=="function"&&ua.console.log.apply(ua.console,arguments)}var _s={log:CE,warn:function(e){ua.console&&(typeof ua.console.warn=="function"?ua.console.warn.apply(ua.console,arguments):CE.call(null,arguments))},error:function(e){ua.console&&(typeof ua.console.error=="function"?ua.console.error.apply(ua.console,arguments):CE(e))}};function AE(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){hp(n.response,t,r)},n.onerror=function(){_s.error("could not download file")},n.send()}function g9(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function mj(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var hp=ua.saveAs||((typeof window>"u"?"undefined":Fa(window))!=="object"||window!==ua?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=ua.URL||ua.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?g9(s.href)?AE(e,t,r):mj(s,s.target="_blank"):mj(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){mj(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(g9(e))AE(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){mj(n)})}else navigator.msSaveOrOpenBlob(function(s,o){return o===void 0?o={autoBom:!1}:Fa(o)!=="object"&&(_s.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob([String.fromCharCode(65279),s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return AE(e,t,r);var s=e.type==="application/octet-stream",o=/constructor/i.test(ua.HTMLElement)||ua.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||s&&o)&&(typeof FileReader>"u"?"undefined":Fa(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=i?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(e)}else{var c=ua.URL||ua.webkitURL,d=c.createObjectURL(e);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Jne(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,o=r[n].process,i=s.exec(e);i&&(t=o(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var r_=ua.atob.bind(ua),v9=ua.btoa.bind(ua);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function PE(e,t){var r=e[0],n=e[1],s=e[2],o=e[3];r=Vi(r,n,s,o,t[0],7,-680876936),o=Vi(o,r,n,s,t[1],12,-389564586),s=Vi(s,o,r,n,t[2],17,606105819),n=Vi(n,s,o,r,t[3],22,-1044525330),r=Vi(r,n,s,o,t[4],7,-176418897),o=Vi(o,r,n,s,t[5],12,1200080426),s=Vi(s,o,r,n,t[6],17,-1473231341),n=Vi(n,s,o,r,t[7],22,-45705983),r=Vi(r,n,s,o,t[8],7,1770035416),o=Vi(o,r,n,s,t[9],12,-1958414417),s=Vi(s,o,r,n,t[10],17,-42063),n=Vi(n,s,o,r,t[11],22,-1990404162),r=Vi(r,n,s,o,t[12],7,1804603682),o=Vi(o,r,n,s,t[13],12,-40341101),s=Vi(s,o,r,n,t[14],17,-1502002290),r=Wi(r,n=Vi(n,s,o,r,t[15],22,1236535329),s,o,t[1],5,-165796510),o=Wi(o,r,n,s,t[6],9,-1069501632),s=Wi(s,o,r,n,t[11],14,643717713),n=Wi(n,s,o,r,t[0],20,-373897302),r=Wi(r,n,s,o,t[5],5,-701558691),o=Wi(o,r,n,s,t[10],9,38016083),s=Wi(s,o,r,n,t[15],14,-660478335),n=Wi(n,s,o,r,t[4],20,-405537848),r=Wi(r,n,s,o,t[9],5,568446438),o=Wi(o,r,n,s,t[14],9,-1019803690),s=Wi(s,o,r,n,t[3],14,-187363961),n=Wi(n,s,o,r,t[8],20,1163531501),r=Wi(r,n,s,o,t[13],5,-1444681467),o=Wi(o,r,n,s,t[2],9,-51403784),s=Wi(s,o,r,n,t[7],14,1735328473),r=Hi(r,n=Wi(n,s,o,r,t[12],20,-1926607734),s,o,t[5],4,-378558),o=Hi(o,r,n,s,t[8],11,-2022574463),s=Hi(s,o,r,n,t[11],16,1839030562),n=Hi(n,s,o,r,t[14],23,-35309556),r=Hi(r,n,s,o,t[1],4,-1530992060),o=Hi(o,r,n,s,t[4],11,1272893353),s=Hi(s,o,r,n,t[7],16,-155497632),n=Hi(n,s,o,r,t[10],23,-1094730640),r=Hi(r,n,s,o,t[13],4,681279174),o=Hi(o,r,n,s,t[0],11,-358537222),s=Hi(s,o,r,n,t[3],16,-722521979),n=Hi(n,s,o,r,t[6],23,76029189),r=Hi(r,n,s,o,t[9],4,-640364487),o=Hi(o,r,n,s,t[12],11,-421815835),s=Hi(s,o,r,n,t[15],16,530742520),r=Gi(r,n=Hi(n,s,o,r,t[2],23,-995338651),s,o,t[0],6,-198630844),o=Gi(o,r,n,s,t[7],10,1126891415),s=Gi(s,o,r,n,t[14],15,-1416354905),n=Gi(n,s,o,r,t[5],21,-57434055),r=Gi(r,n,s,o,t[12],6,1700485571),o=Gi(o,r,n,s,t[3],10,-1894986606),s=Gi(s,o,r,n,t[10],15,-1051523),n=Gi(n,s,o,r,t[1],21,-2054922799),r=Gi(r,n,s,o,t[8],6,1873313359),o=Gi(o,r,n,s,t[15],10,-30611744),s=Gi(s,o,r,n,t[6],15,-1560198380),n=Gi(n,s,o,r,t[13],21,1309151649),r=Gi(r,n,s,o,t[4],6,-145523070),o=Gi(o,r,n,s,t[11],10,-1120210379),s=Gi(s,o,r,n,t[2],15,718787259),n=Gi(n,s,o,r,t[9],21,-343485551),e[0]=Ym(r,e[0]),e[1]=Ym(n,e[1]),e[2]=Ym(s,e[2]),e[3]=Ym(o,e[3])}function F5(e,t,r,n,s,o){return t=Ym(Ym(t,e),Ym(n,o)),Ym(t<<s|t>>>32-s,r)}function Vi(e,t,r,n,s,o,i){return F5(t&r|~t&n,e,t,s,o,i)}function Wi(e,t,r,n,s,o,i){return F5(t&n|r&~n,e,t,s,o,i)}function Hi(e,t,r,n,s,o,i){return F5(t^r^n,e,t,s,o,i)}function Gi(e,t,r,n,s,o,i){return F5(r^(t|~n),e,t,s,o,i)}function Qne(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)PE(n,pQe(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(PE(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,PE(n,s),n}function pQe(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var x9="0123456789abcdef".split("");function gQe(e){for(var t="",r=0;r<4;r++)t+=x9[e>>8*r+4&15]+x9[e>>8*r&15];return t}function vQe(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function BT(e){return Qne(e).map(vQe).join("")}var xQe=function(e){for(var t=0;t<e.length;t++)e[t]=gQe(e[t]);return e.join("")}(Qne("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ym(e,t){if(xQe){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function qT(e,t){var r,n,s,o;if(e!==r){for(var i=(s=e,o=1+(256/e.length|0),new Array(o+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+i.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=e,n=l}else l=n;var f=t.length,h=0,m=0,v="";for(c=0;c<f;c++)m=(m+(u=l[h=(h+1)%256]))%256,l[h]=l[m],l[m]=u,i=l[(l[h]+l[m])%256],v+=String.fromCharCode(t.charCodeAt(c)^i);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var y9={print:4,modify:8,copy:16,"annot-forms":32};function gv(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(l){if(y9.perm!==void 0)throw new Error("Invalid permission: "+l);s+=y9[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,i),this.P=-(1+(255^s)),this.encryptionKey=BT(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=qT(this.encryptionKey,this.padding)}function vv(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[n]}return t}function b9(e){if(Fa(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var o=Math.random().toString(35);return t[r][o]=[n,!!s],o},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var o in t[r]){var i=t[r][o];try{i[0].apply(e,n)}catch(l){ua.console&&_s.error("jsPDF PubSub Error",l.message,l)}i[1]&&s.push(o)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Gw(e){if(!(this instanceof Gw))return new Gw(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Zne(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function $m(e,t,r,n,s){if(!(this instanceof $m))return new $m(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Zne.call(this,n,s)}function Mp(e,t,r,n,s){if(!(this instanceof Mp))return new Mp(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Zne.call(this,n,s)}function Wn(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],o=arguments[3],i=[],l=1,c=16,d="S",u=null;Fa(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,o=e.compress||e.compressPdf||o,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),i=e.filters||(o===!0?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,h={},m={internal:{},__private__:{}};m.__private__.PubSub=b9;var v="1.3",g=m.__private__.getPdfVersion=function(){return v};m.__private__.setPdfVersion=function(S){v=S};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return y};var x=m.__private__.getPageFormat=function(S){return y[S]};s=s||"a4";var b="compat",w="advanced",j=b;function _(){this.saveGraphicsState(),de(new Re(Be,0,0,-Be,0,Vt()*Be).toString()+" cm"),this.setFontSize(this.getFontSize()/Be),d="n",j=w}function C(){this.restoreGraphicsState(),d="S",j=b}var P=m.__private__.combineFontStyleAndFontWeight=function(S,G){if(S=="bold"&&G=="normal"||S=="bold"&&G==400||S=="normal"&&G=="italic"||S=="bold"&&G=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return G&&(S=G==400||G==="normal"?S==="italic"?"italic":"normal":G!=700&&G!=="bold"||S!=="normal"?(G==700?"bold":G)+""+S:"bold"),S};m.advancedAPI=function(S){var G=j===b;return G&&_.call(this),typeof S!="function"||(S(this),G&&C.call(this)),this},m.compatAPI=function(S){var G=j===w;return G&&C.call(this),typeof S!="function"||(S(this),G&&_.call(this)),this},m.isAdvancedAPI=function(){return j===w};var E,A=function(S){if(j!==w)throw new Error(S+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=m.roundToPrecision=m.__private__.roundToPrecision=function(S,G){var se=t||G;if(isNaN(S)||isNaN(se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return S.toFixed(se).replace(/0+$/,"")};E=m.hpf=m.__private__.hpf=typeof c=="number"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return F(S,c)}:c==="smart"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return F(S,S>-1&&S<1?16:5)}:function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return F(S,16)};var D=m.f2=m.__private__.f2=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f2");return F(S,2)},I=m.__private__.f3=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f3");return F(S,3)},R=m.scale=m.__private__.scale=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.scale");return j===b?S*Be:j===w?S:void 0},M=function(S){return R(function(G){return j===b?Vt()-G:j===w?G:void 0}(S))};m.__private__.setPrecision=m.setPrecision=function(S){typeof parseInt(S,10)=="number"&&(t=parseInt(S,10))};var U,z="00000000000000000000000000000000",W=m.__private__.getFileId=function(){return z},$=m.__private__.setFileId=function(S){return z=S!==void 0&&/^[a-fA-F0-9]{32}$/.test(S)?S.toUpperCase():z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(O=new gv(u.userPermissions,u.userPassword,u.ownerPassword,z)),z};m.setFileId=function(S){return $(S),this},m.getFileId=function(){return W()};var ee=m.__private__.convertDateToPDFDate=function(S){var G=S.getTimezoneOffset(),se=G<0?"+":"-",Ae=Math.floor(Math.abs(G/60)),V=Math.abs(G%60),oe=[se,Y(Ae),"'",Y(V),"'"].join("");return["D:",S.getFullYear(),Y(S.getMonth()+1),Y(S.getDate()),Y(S.getHours()),Y(S.getMinutes()),Y(S.getSeconds()),oe].join("")},ve=m.__private__.convertPDFDateToDate=function(S){var G=parseInt(S.substr(2,4),10),se=parseInt(S.substr(6,2),10)-1,Ae=parseInt(S.substr(8,2),10),V=parseInt(S.substr(10,2),10),oe=parseInt(S.substr(12,2),10),Pe=parseInt(S.substr(14,2),10);return new Date(G,se,Ae,V,oe,Pe,0)},_e=m.__private__.setCreationDate=function(S){var G;if(S===void 0&&(S=new Date),S instanceof Date)G=ee(S);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(S))throw new Error("Invalid argument passed to jsPDF.setCreationDate");G=S}return U=G},K=m.__private__.getCreationDate=function(S){var G=U;return S==="jsDate"&&(G=ve(U)),G};m.setCreationDate=function(S){return _e(S),this},m.getCreationDate=function(S){return K(S)};var q,Y=m.__private__.padd2=function(S){return("0"+parseInt(S)).slice(-2)},J=m.__private__.padd2Hex=function(S){return("00"+(S=S.toString())).substr(S.length)},fe=0,Z=[],ce=[],le=0,ie=[],te=[],ue=!1,Te=ce;m.__private__.setCustomOutputDestination=function(S){ue=!0,Te=S};var ne=function(S){ue||(Te=S)};m.__private__.resetCustomOutputDestination=function(){ue=!1,Te=ce};var de=m.__private__.out=function(S){return S=S.toString(),le+=S.length+1,Te.push(S),Te},lt=m.__private__.write=function(S){return de(arguments.length===1?S.toString():Array.prototype.join.call(arguments," "))},Nt=m.__private__.getArrayBuffer=function(S){for(var G=S.length,se=new ArrayBuffer(G),Ae=new Uint8Array(se);G--;)Ae[G]=S.charCodeAt(G);return se},at=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return at};var gt=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(S){return gt=j===w?S/Be:S,this};var Pt,yt=m.__private__.getFontSize=m.getFontSize=function(){return j===b?gt:gt*Be},Qe=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(S){return Qe=S,this},m.__private__.getR2L=m.getR2L=function(){return Qe};var ge,rt=m.__private__.setZoomMode=function(S){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(S))Pt=S;else if(isNaN(S)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(S)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+S+'" is not recognized.');Pt=S}else Pt=parseInt(S,10)};m.__private__.getZoomMode=function(){return Pt};var pt,We=m.__private__.setPageMode=function(S){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(S)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+S+'" is not recognized.');ge=S};m.__private__.getPageMode=function(){return ge};var Ze=m.__private__.setLayoutMode=function(S){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(S)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+S+'" is not recognized.');pt=S};m.__private__.getLayoutMode=function(){return pt},m.__private__.setDisplayMode=m.setDisplayMode=function(S,G,se){return rt(S),Ze(G),We(se),this};var Ne={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(S){if(Object.keys(Ne).indexOf(S)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ne[S]},m.__private__.getDocumentProperties=function(){return Ne},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(S){for(var G in Ne)Ne.hasOwnProperty(G)&&S[G]&&(Ne[G]=S[G]);return this},m.__private__.setDocumentProperty=function(S,G){if(Object.keys(Ne).indexOf(S)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ne[S]=G};var ye,Be,mt,Ft,fr,It={},Ut={},xe=[],st={},Ct={},ar={},pr={},Xt=null,yr=0,lr=[],Rr=new b9(m),Pn=e.hotfixes||[],De={},ke={},Ge=[],Re=function S(G,se,Ae,V,oe,Pe){if(!(this instanceof S))return new S(G,se,Ae,V,oe,Pe);isNaN(G)&&(G=1),isNaN(se)&&(se=0),isNaN(Ae)&&(Ae=0),isNaN(V)&&(V=1),isNaN(oe)&&(oe=0),isNaN(Pe)&&(Pe=0),this._matrix=[G,se,Ae,V,oe,Pe]};Object.defineProperty(Re.prototype,"sx",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(Re.prototype,"shy",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(Re.prototype,"shx",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(Re.prototype,"sy",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(Re.prototype,"tx",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(Re.prototype,"ty",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(Re.prototype,"a",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(Re.prototype,"b",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(Re.prototype,"c",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(Re.prototype,"d",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(Re.prototype,"e",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(Re.prototype,"f",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(Re.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Re.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Re.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Re.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Re.prototype.join=function(S){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(E).join(S)},Re.prototype.multiply=function(S){var G=S.sx*this.sx+S.shy*this.shx,se=S.sx*this.shy+S.shy*this.sy,Ae=S.shx*this.sx+S.sy*this.shx,V=S.shx*this.shy+S.sy*this.sy,oe=S.tx*this.sx+S.ty*this.shx+this.tx,Pe=S.tx*this.shy+S.ty*this.sy+this.ty;return new Re(G,se,Ae,V,oe,Pe)},Re.prototype.decompose=function(){var S=this.sx,G=this.shy,se=this.shx,Ae=this.sy,V=this.tx,oe=this.ty,Pe=Math.sqrt(S*S+G*G),qe=(S/=Pe)*se+(G/=Pe)*Ae;se-=S*qe,Ae-=G*qe;var He=Math.sqrt(se*se+Ae*Ae);return qe/=He,S*(Ae/=He)<G*(se/=He)&&(S=-S,G=-G,qe=-qe,Pe=-Pe),{scale:new Re(Pe,0,0,He,0,0),translate:new Re(1,0,0,1,V,oe),rotate:new Re(S,G,-G,S,0,0),skew:new Re(1,0,qe,1,0,0)}},Re.prototype.toString=function(S){return this.join(" ")},Re.prototype.inversed=function(){var S=this.sx,G=this.shy,se=this.shx,Ae=this.sy,V=this.tx,oe=this.ty,Pe=1/(S*Ae-G*se),qe=Ae*Pe,He=-G*Pe,Rt=-se*Pe,ut=S*Pe;return new Re(qe,He,Rt,ut,-qe*V-Rt*oe,-He*V-ut*oe)},Re.prototype.applyToPoint=function(S){var G=S.x*this.sx+S.y*this.shx+this.tx,se=S.x*this.shy+S.y*this.sy+this.ty;return new ys(G,se)},Re.prototype.applyToRectangle=function(S){var G=this.applyToPoint(S),se=this.applyToPoint(new ys(S.x+S.w,S.y+S.h));return new sf(G.x,G.y,se.x-G.x,se.y-G.y)},Re.prototype.clone=function(){var S=this.sx,G=this.shy,se=this.shx,Ae=this.sy,V=this.tx,oe=this.ty;return new Re(S,G,se,Ae,V,oe)},m.Matrix=Re;var bt=m.matrixMult=function(S,G){return G.multiply(S)},Qt=new Re(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=Qt;var ct=function(S,G){if(!Ct[S]){var se=(G instanceof $m?"Sh":"P")+(Object.keys(st).length+1).toString(10);G.id=se,Ct[S]=se,st[se]=G,Rr.publish("addPattern",G)}};m.ShadingPattern=$m,m.TilingPattern=Mp,m.addShadingPattern=function(S,G){return A("addShadingPattern()"),ct(S,G),this},m.beginTilingPattern=function(S){A("beginTilingPattern()"),Fo(S.boundingBox[0],S.boundingBox[1],S.boundingBox[2]-S.boundingBox[0],S.boundingBox[3]-S.boundingBox[1],S.matrix)},m.endTilingPattern=function(S,G){A("endTilingPattern()"),G.stream=te[q].join(`
`),ct(S,G),Rr.publish("endTilingPattern",G),Ge.pop().restore()};var xt,it=m.__private__.newObject=function(){var S=kt();return be(S,!0),S},kt=m.__private__.newObjectDeferred=function(){return fe++,Z[fe]=function(){return le},fe},be=function(S,G){return G=typeof G=="boolean"&&G,Z[S]=le,G&&de(S+" 0 obj"),S},dt=m.__private__.newAdditionalObject=function(){var S={objId:kt(),content:""};return ie.push(S),S},Lt=kt(),mr=kt(),tr=m.__private__.decodeColorString=function(S){var G=S.split(" ");if(G.length!==2||G[1]!=="g"&&G[1]!=="G")G.length!==5||G[4]!=="k"&&G[4]!=="K"||(G=[(1-G[0])*(1-G[3]),(1-G[1])*(1-G[3]),(1-G[2])*(1-G[3]),"r"]);else{var se=parseFloat(G[0]);G=[se,se,se,"r"]}for(var Ae="#",V=0;V<3;V++)Ae+=("0"+Math.floor(255*parseFloat(G[V])).toString(16)).slice(-2);return Ae},Or=m.__private__.encodeColorString=function(S){var G;typeof S=="string"&&(S={ch1:S});var se=S.ch1,Ae=S.ch2,V=S.ch3,oe=S.ch4,Pe=S.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof se=="string"&&se.charAt(0)!=="#"){var qe=new Jne(se);if(qe.ok)se=qe.toHex();else if(!/^\d*\.?\d*$/.test(se))throw new Error('Invalid color "'+se+'" passed to jsPDF.encodeColorString.')}if(typeof se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(se)&&(se="#"+se[1]+se[1]+se[2]+se[2]+se[3]+se[3]),typeof se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(se)){var He=parseInt(se.substr(1),16);se=He>>16&255,Ae=He>>8&255,V=255&He}if(Ae===void 0||oe===void 0&&se===Ae&&Ae===V)G=typeof se=="string"?se+" "+Pe[0]:S.precision===2?D(se/255)+" "+Pe[0]:I(se/255)+" "+Pe[0];else if(oe===void 0||Fa(oe)==="object"){if(oe&&!isNaN(oe.a)&&oe.a===0)return["1.","1.","1.",Pe[1]].join(" ");G=typeof se=="string"?[se,Ae,V,Pe[1]].join(" "):S.precision===2?[D(se/255),D(Ae/255),D(V/255),Pe[1]].join(" "):[I(se/255),I(Ae/255),I(V/255),Pe[1]].join(" ")}else G=typeof se=="string"?[se,Ae,V,oe,Pe[2]].join(" "):S.precision===2?[D(se),D(Ae),D(V),D(oe),Pe[2]].join(" "):[I(se),I(Ae),I(V),I(oe),Pe[2]].join(" ");return G},Lr=m.__private__.getFilters=function(){return i},sr=m.__private__.putStream=function(S){var G=(S=S||{}).data||"",se=S.filters||Lr(),Ae=S.alreadyAppliedFilters||[],V=S.addLength1||!1,oe=G.length,Pe=S.objectId,qe=function(_r){return _r};if(u!==null&&Pe===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(qe=O.encryptor(Pe,0));var He={};se===!0&&(se=["FlateEncode"]);var Rt=S.additionalKeyValues||[],ut=(He=Wn.API.processDataByFilters!==void 0?Wn.API.processDataByFilters(G,se):{data:G,reverseChain:[]}).reverseChain+(Array.isArray(Ae)?Ae.join(" "):Ae.toString());if(He.data.length!==0&&(Rt.push({key:"Length",value:He.data.length}),V===!0&&Rt.push({key:"Length1",value:oe})),ut.length!=0)if(ut.split("/").length-1==1)Rt.push({key:"Filter",value:ut});else{Rt.push({key:"Filter",value:"["+ut+"]"});for(var qt=0;qt<Rt.length;qt+=1)if(Rt[qt].key==="DecodeParms"){for(var Kt=[],At=0;At<He.reverseChain.split("/").length-1;At+=1)Kt.push("null");Kt.push(Rt[qt].value),Rt[qt].value="["+Kt.join(" ")+"]"}}de("<<");for(var kr=0;kr<Rt.length;kr++)de("/"+Rt[kr].key+" "+Rt[kr].value);de(">>"),He.data.length!==0&&(de("stream"),de(qe(He.data)),de("endstream"))},fn=m.__private__.putPage=function(S){var G=S.number,se=S.data,Ae=S.objId,V=S.contentsObjId;be(Ae,!0),de("<</Type /Page"),de("/Parent "+S.rootDictionaryObjId+" 0 R"),de("/Resources "+S.resourceDictionaryObjId+" 0 R"),de("/MediaBox ["+parseFloat(E(S.mediaBox.bottomLeftX))+" "+parseFloat(E(S.mediaBox.bottomLeftY))+" "+E(S.mediaBox.topRightX)+" "+E(S.mediaBox.topRightY)+"]"),S.cropBox!==null&&de("/CropBox ["+E(S.cropBox.bottomLeftX)+" "+E(S.cropBox.bottomLeftY)+" "+E(S.cropBox.topRightX)+" "+E(S.cropBox.topRightY)+"]"),S.bleedBox!==null&&de("/BleedBox ["+E(S.bleedBox.bottomLeftX)+" "+E(S.bleedBox.bottomLeftY)+" "+E(S.bleedBox.topRightX)+" "+E(S.bleedBox.topRightY)+"]"),S.trimBox!==null&&de("/TrimBox ["+E(S.trimBox.bottomLeftX)+" "+E(S.trimBox.bottomLeftY)+" "+E(S.trimBox.topRightX)+" "+E(S.trimBox.topRightY)+"]"),S.artBox!==null&&de("/ArtBox ["+E(S.artBox.bottomLeftX)+" "+E(S.artBox.bottomLeftY)+" "+E(S.artBox.topRightX)+" "+E(S.artBox.topRightY)+"]"),typeof S.userUnit=="number"&&S.userUnit!==1&&de("/UserUnit "+S.userUnit),Rr.publish("putPage",{objId:Ae,pageContext:lr[G],pageNumber:G,page:se}),de("/Contents "+V+" 0 R"),de(">>"),de("endobj");var oe=se.join(`
`);return j===w&&(oe+=`
Q`),be(V,!0),sr({data:oe,filters:Lr(),objectId:V}),de("endobj"),Ae},Tn=m.__private__.putPages=function(){var S,G,se=[];for(S=1;S<=yr;S++)lr[S].objId=kt(),lr[S].contentsObjId=kt();for(S=1;S<=yr;S++)se.push(fn({number:S,data:te[S],objId:lr[S].objId,contentsObjId:lr[S].contentsObjId,mediaBox:lr[S].mediaBox,cropBox:lr[S].cropBox,bleedBox:lr[S].bleedBox,trimBox:lr[S].trimBox,artBox:lr[S].artBox,userUnit:lr[S].userUnit,rootDictionaryObjId:Lt,resourceDictionaryObjId:mr}));be(Lt,!0),de("<</Type /Pages");var Ae="/Kids [";for(G=0;G<yr;G++)Ae+=se[G]+" 0 R ";de(Ae+"]"),de("/Count "+yr),de(">>"),de("endobj"),Rr.publish("postPutPages")},mn=function(S){Rr.publish("putFont",{font:S,out:de,newObject:it,putStream:sr}),S.isAlreadyPutted!==!0&&(S.objectNumber=it(),de("<<"),de("/Type /Font"),de("/BaseFont /"+vv(S.postScriptName)),de("/Subtype /Type1"),typeof S.encoding=="string"&&de("/Encoding /"+S.encoding),de("/FirstChar 32"),de("/LastChar 255"),de(">>"),de("endobj"))},zn=function(S){S.objectNumber=it();var G=[];G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Form"}),G.push({key:"BBox",value:"["+[E(S.x),E(S.y),E(S.x+S.width),E(S.y+S.height)].join(" ")+"]"}),G.push({key:"Matrix",value:"["+S.matrix.toString()+"]"});var se=S.pages[1].join(`
`);sr({data:se,additionalKeyValues:G,objectId:S.objectNumber}),de("endobj")},ot=function(S,G){G||(G=21);var se=it(),Ae=function(Pe,qe){var He,Rt=[],ut=1/(qe-1);for(He=0;He<1;He+=ut)Rt.push(He);if(Rt.push(1),Pe[0].offset!=0){var qt={offset:0,color:Pe[0].color};Pe.unshift(qt)}if(Pe[Pe.length-1].offset!=1){var Kt={offset:1,color:Pe[Pe.length-1].color};Pe.push(Kt)}for(var At="",kr=0,_r=0;_r<Rt.length;_r++){for(He=Rt[_r];He>Pe[kr+1].offset;)kr++;var nr=Pe[kr].offset,Wr=(He-nr)/(Pe[kr+1].offset-nr),Cr=Pe[kr].color,Yr=Pe[kr+1].color;At+=J(Math.round((1-Wr)*Cr[0]+Wr*Yr[0]).toString(16))+J(Math.round((1-Wr)*Cr[1]+Wr*Yr[1]).toString(16))+J(Math.round((1-Wr)*Cr[2]+Wr*Yr[2]).toString(16))}return At.trim()}(S.colors,G),V=[];V.push({key:"FunctionType",value:"0"}),V.push({key:"Domain",value:"[0.0 1.0]"}),V.push({key:"Size",value:"["+G+"]"}),V.push({key:"BitsPerSample",value:"8"}),V.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),V.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),sr({data:Ae,additionalKeyValues:V,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:se}),de("endobj"),S.objectNumber=it(),de("<< /ShadingType "+S.type),de("/ColorSpace /DeviceRGB");var oe="/Coords ["+E(parseFloat(S.coords[0]))+" "+E(parseFloat(S.coords[1]))+" ";S.type===2?oe+=E(parseFloat(S.coords[2]))+" "+E(parseFloat(S.coords[3])):oe+=E(parseFloat(S.coords[2]))+" "+E(parseFloat(S.coords[3]))+" "+E(parseFloat(S.coords[4]))+" "+E(parseFloat(S.coords[5])),de(oe+="]"),S.matrix&&de("/Matrix ["+S.matrix.toString()+"]"),de("/Function "+se+" 0 R"),de("/Extend [true true]"),de(">>"),de("endobj")},$t=function(S,G){var se=kt(),Ae=it();G.push({resourcesOid:se,objectOid:Ae}),S.objectNumber=Ae;var V=[];V.push({key:"Type",value:"/Pattern"}),V.push({key:"PatternType",value:"1"}),V.push({key:"PaintType",value:"1"}),V.push({key:"TilingType",value:"1"}),V.push({key:"BBox",value:"["+S.boundingBox.map(E).join(" ")+"]"}),V.push({key:"XStep",value:E(S.xStep)}),V.push({key:"YStep",value:E(S.yStep)}),V.push({key:"Resources",value:se+" 0 R"}),S.matrix&&V.push({key:"Matrix",value:"["+S.matrix.toString()+"]"}),sr({data:S.stream,additionalKeyValues:V,objectId:S.objectNumber}),de("endobj")},Yt=function(S){for(var G in S.objectNumber=it(),de("<<"),S)switch(G){case"opacity":de("/ca "+D(S[G]));break;case"stroke-opacity":de("/CA "+D(S[G]))}de(">>"),de("endobj")},Ht=function(S){be(S.resourcesOid,!0),de("<<"),de("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var G in de("/Font <<"),It)It.hasOwnProperty(G)&&(f===!1||f===!0&&h.hasOwnProperty(G))&&de("/"+G+" "+It[G].objectNumber+" 0 R");de(">>")}(),function(){if(Object.keys(st).length>0){for(var G in de("/Shading <<"),st)st.hasOwnProperty(G)&&st[G]instanceof $m&&st[G].objectNumber>=0&&de("/"+G+" "+st[G].objectNumber+" 0 R");Rr.publish("putShadingPatternDict"),de(">>")}}(),function(G){if(Object.keys(st).length>0){for(var se in de("/Pattern <<"),st)st.hasOwnProperty(se)&&st[se]instanceof m.TilingPattern&&st[se].objectNumber>=0&&st[se].objectNumber<G&&de("/"+se+" "+st[se].objectNumber+" 0 R");Rr.publish("putTilingPatternDict"),de(">>")}}(S.objectOid),function(){if(Object.keys(ar).length>0){var G;for(G in de("/ExtGState <<"),ar)ar.hasOwnProperty(G)&&ar[G].objectNumber>=0&&de("/"+G+" "+ar[G].objectNumber+" 0 R");Rr.publish("putGStateDict"),de(">>")}}(),function(){for(var G in de("/XObject <<"),De)De.hasOwnProperty(G)&&De[G].objectNumber>=0&&de("/"+G+" "+De[G].objectNumber+" 0 R");Rr.publish("putXobjectDict"),de(">>")}(),de(">>"),de("endobj")},Ot=function(S){Ut[S.fontName]=Ut[S.fontName]||{},Ut[S.fontName][S.fontStyle]=S.id},Xr=function(S,G,se,Ae,V){var oe={id:"F"+(Object.keys(It).length+1).toString(10),postScriptName:S,fontName:G,fontStyle:se,encoding:Ae,isStandardFont:V||!1,metadata:{}};return Rr.publish("addFont",{font:oe,instance:this}),It[oe.id]=oe,Ot(oe),oe.id},Je=m.__private__.pdfEscape=m.pdfEscape=function(S,G){return function(se,Ae){var V,oe,Pe,qe,He,Rt,ut,qt,Kt;if(Pe=(Ae=Ae||{}).sourceEncoding||"Unicode",He=Ae.outputEncoding,(Ae.autoencode||He)&&It[ye].metadata&&It[ye].metadata[Pe]&&It[ye].metadata[Pe].encoding&&(qe=It[ye].metadata[Pe].encoding,!He&&It[ye].encoding&&(He=It[ye].encoding),!He&&qe.codePages&&(He=qe.codePages[0]),typeof He=="string"&&(He=qe[He]),He)){for(ut=!1,Rt=[],V=0,oe=se.length;V<oe;V++)(qt=He[se.charCodeAt(V)])?Rt.push(String.fromCharCode(qt)):Rt.push(se[V]),Rt[V].charCodeAt(0)>>8&&(ut=!0);se=Rt.join("")}for(V=se.length;ut===void 0&&V!==0;)se.charCodeAt(V-1)>>8&&(ut=!0),V--;if(!ut)return se;for(Rt=Ae.noBOM?[]:[254,255],V=0,oe=se.length;V<oe;V++){if((Kt=(qt=se.charCodeAt(V))>>8)>>8)throw new Error("Character at position "+V+" of string '"+se+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Rt.push(Kt),Rt.push(qt-(Kt<<8))}return String.fromCharCode.apply(void 0,Rt)}(S,G).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},cr=m.__private__.beginPage=function(S){te[++yr]=[],lr[yr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(S[0]),topRightY:Number(S[1])}},Dr(yr),ne(te[q])},vt=function(S,G){var se,Ae,V;switch(r=G||r,typeof S=="string"&&(se=x(S.toLowerCase()),Array.isArray(se)&&(Ae=se[0],V=se[1])),Array.isArray(S)&&(Ae=S[0]*Be,V=S[1]*Be),isNaN(Ae)&&(Ae=s[0],V=s[1]),(Ae>14400||V>14400)&&(_s.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ae=Math.min(14400,Ae),V=Math.min(14400,V)),s=[Ae,V],r.substr(0,1)){case"l":V>Ae&&(s=[V,Ae]);break;case"p":Ae>V&&(s=[V,Ae])}cr(s),va(cn),de(vi),af!==0&&de(af+" J"),nc!==0&&de(nc+" j"),Rr.publish("addPage",{pageNumber:yr})},Tt=function(S){S>0&&S<=yr&&(te.splice(S,1),lr.splice(S,1),yr--,q>yr&&(q=yr),this.setPage(q))},Dr=function(S){S>0&&S<=yr&&(q=S)},an=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return te.length-1},Nr=function(S,G,se){var Ae,V=void 0;return se=se||{},S=S!==void 0?S:It[ye].fontName,G=G!==void 0?G:It[ye].fontStyle,Ae=S.toLowerCase(),Ut[Ae]!==void 0&&Ut[Ae][G]!==void 0?V=Ut[Ae][G]:Ut[S]!==void 0&&Ut[S][G]!==void 0?V=Ut[S][G]:se.disableWarning===!1&&_s.warn("Unable to look up font label for font '"+S+"', '"+G+"'. Refer to getFontList() for available fonts."),V||se.noFallback||(V=Ut.times[G])==null&&(V=Ut.times.normal),V},St=m.__private__.putInfo=function(){var S=it(),G=function(Ae){return Ae};for(var se in u!==null&&(G=O.encryptor(S,0)),de("<<"),de("/Producer ("+Je(G("jsPDF "+Wn.version))+")"),Ne)Ne.hasOwnProperty(se)&&Ne[se]&&de("/"+se.substr(0,1).toUpperCase()+se.substr(1)+" ("+Je(G(Ne[se]))+")");de("/CreationDate ("+Je(G(U))+")"),de(">>"),de("endobj")},Fr=m.__private__.putCatalog=function(S){var G=(S=S||{}).rootDictionaryObjId||Lt;switch(it(),de("<<"),de("/Type /Catalog"),de("/Pages "+G+" 0 R"),Pt||(Pt="fullwidth"),Pt){case"fullwidth":de("/OpenAction [3 0 R /FitH null]");break;case"fullheight":de("/OpenAction [3 0 R /FitV null]");break;case"fullpage":de("/OpenAction [3 0 R /Fit]");break;case"original":de("/OpenAction [3 0 R /XYZ null null 1]");break;default:var se=""+Pt;se.substr(se.length-1)==="%"&&(Pt=parseInt(Pt)/100),typeof Pt=="number"&&de("/OpenAction [3 0 R /XYZ null null "+D(Pt)+"]")}switch(pt||(pt="continuous"),pt){case"continuous":de("/PageLayout /OneColumn");break;case"single":de("/PageLayout /SinglePage");break;case"two":case"twoleft":de("/PageLayout /TwoColumnLeft");break;case"tworight":de("/PageLayout /TwoColumnRight")}ge&&de("/PageMode /"+ge),Rr.publish("putCatalog"),de(">>"),de("endobj")},zr=m.__private__.putTrailer=function(){de("trailer"),de("<<"),de("/Size "+(fe+1)),de("/Root "+fe+" 0 R"),de("/Info "+(fe-1)+" 0 R"),u!==null&&de("/Encrypt "+O.oid+" 0 R"),de("/ID [ <"+z+"> <"+z+"> ]"),de(">>")},ha=m.__private__.putHeader=function(){de("%PDF-"+v),de("%")},En=m.__private__.putXRef=function(){var S="0000000000";de("xref"),de("0 "+(fe+1)),de("0000000000 65535 f ");for(var G=1;G<=fe;G++)typeof Z[G]=="function"?de((S+Z[G]()).slice(-10)+" 00000 n "):Z[G]!==void 0?de((S+Z[G]).slice(-10)+" 00000 n "):de("0000000000 00000 n ")},ae=m.__private__.buildDocument=function(){var S;fe=0,le=0,ce=[],Z=[],ie=[],Lt=kt(),mr=kt(),ne(ce),Rr.publish("buildDocument"),ha(),Tn(),function(){Rr.publish("putAdditionalObjects");for(var se=0;se<ie.length;se++){var Ae=ie[se];be(Ae.objId,!0),de(Ae.content),de("endobj")}Rr.publish("postPutAdditionalObjects")}(),S=[],function(){for(var se in It)It.hasOwnProperty(se)&&(f===!1||f===!0&&h.hasOwnProperty(se))&&mn(It[se])}(),function(){var se;for(se in ar)ar.hasOwnProperty(se)&&Yt(ar[se])}(),function(){for(var se in De)De.hasOwnProperty(se)&&zn(De[se])}(),function(se){var Ae;for(Ae in st)st.hasOwnProperty(Ae)&&(st[Ae]instanceof $m?ot(st[Ae]):st[Ae]instanceof Mp&&$t(st[Ae],se))}(S),Rr.publish("putResources"),S.forEach(Ht),Ht({resourcesOid:mr,objectOid:Number.MAX_SAFE_INTEGER}),Rr.publish("postPutResources"),u!==null&&(O.oid=it(),de("<<"),de("/Filter /Standard"),de("/V "+O.v),de("/R "+O.r),de("/U <"+O.toHexString(O.U)+">"),de("/O <"+O.toHexString(O.O)+">"),de("/P "+O.P),de(">>"),de("endobj")),St(),Fr();var G=le;return En(),zr(),de("startxref"),de(""+G),de("%%EOF"),ne(te[q]),ce.join(`
`)},Me=m.__private__.getBlob=function(S){return new Blob([Nt(S)],{type:"application/pdf"})},et=m.output=m.__private__.output=(xt=function(S,G){switch(typeof(G=G||{})=="string"?G={filename:G}:G.filename=G.filename||"generated.pdf",S){case void 0:return ae();case"save":m.save(G.filename);break;case"arraybuffer":return Nt(ae());case"blob":return Me(ae());case"bloburi":case"bloburl":if(ua.URL!==void 0&&typeof ua.URL.createObjectURL=="function")return ua.URL&&ua.URL.createObjectURL(Me(ae()))||void 0;_s.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var se="",Ae=ae();try{se=v9(Ae)}catch{se=v9(unescape(encodeURIComponent(Ae)))}return"data:application/pdf;filename="+G.filename+";base64,"+se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ua)==="[object Window]"){var V="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",oe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';G.pdfObjectUrl&&(V=G.pdfObjectUrl,oe="");var Pe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+V+'"'+oe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(G)+");<\/script></body></html>",qe=ua.open();return qe!==null&&qe.document.write(Pe),qe}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ua)==="[object Window]"){var He='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(G.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+G.filename+'" width="500px" height="400px" /></body></html>',Rt=ua.open();if(Rt!==null){Rt.document.write(He);var ut=this;Rt.document.documentElement.querySelector("#pdfViewer").onload=function(){Rt.document.title=G.filename,Rt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ut.output("bloburl"))}}return Rt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ua)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var qt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",G)+'"></iframe></body></html>',Kt=ua.open();if(Kt!==null&&(Kt.document.write(qt),Kt.document.title=G.filename),Kt||typeof safari>"u")return Kt;break;case"datauri":case"dataurl":return ua.document.location.href=this.output("datauristring",G);default:return null}},xt.foo=function(){try{return xt.apply(this,arguments)}catch(se){var S=se.stack||"";~S.indexOf(" at ")&&(S=S.split(" at ")[1]);var G="Error in function "+S.split(`
`)[0].split("<")[0]+": "+se.message;if(!ua.console)throw new Error(G);ua.console.error(G,se),ua.alert&&alert(G)}},xt.foo.bar=xt,xt.foo),re=function(S){return Array.isArray(Pn)===!0&&Pn.indexOf(S)>-1};switch(n){case"pt":Be=1;break;case"mm":Be=72/25.4;break;case"cm":Be=72/2.54;break;case"in":Be=72;break;case"px":Be=re("px_scaling")==1?.75:96/72;break;case"pc":case"em":Be=12;break;case"ex":Be=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Be=n}var O=null;_e(),$();var T=m.__private__.getPageInfo=m.getPageInfo=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:lr[S].objId,pageNumber:S,pageContext:lr[S]}},X=m.__private__.getPageInfoByObjId=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var G in lr)if(lr[G].objId===S)break;return T(G)},H=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:lr[q].objId,pageNumber:q,pageContext:lr[q]}};m.addPage=function(){return vt.apply(this,arguments),this},m.setPage=function(){return Dr.apply(this,arguments),ne.call(this,te[q]),this},m.insertPage=function(S){return this.addPage(),this.movePage(q,S),this},m.movePage=function(S,G){var se,Ae;if(S>G){se=te[S],Ae=lr[S];for(var V=S;V>G;V--)te[V]=te[V-1],lr[V]=lr[V-1];te[G]=se,lr[G]=Ae,this.setPage(G)}else if(S<G){se=te[S],Ae=lr[S];for(var oe=S;oe<G;oe++)te[oe]=te[oe+1],lr[oe]=lr[oe+1];te[G]=se,lr[G]=Ae,this.setPage(G)}return this},m.deletePage=function(){return Tt.apply(this,arguments),this},m.__private__.text=m.text=function(S,G,se,Ae,V){var oe,Pe,qe,He,Rt,ut,qt,Kt,At,kr=(Ae=Ae||{}).scope||this;if(typeof S=="number"&&typeof G=="number"&&(typeof se=="string"||Array.isArray(se))){var _r=se;se=G,G=S,S=_r}if(arguments[3]instanceof Re==0?(qe=arguments[4],He=arguments[5],Fa(qt=arguments[3])==="object"&&qt!==null||(typeof qe=="string"&&(He=qe,qe=null),typeof qt=="string"&&(He=qt,qt=null),typeof qt=="number"&&(qe=qt,qt=null),Ae={flags:qt,angle:qe,align:He})):(A("The transform parameter of text() with a Matrix value"),At=V),isNaN(G)||isNaN(se)||S==null)throw new Error("Invalid arguments passed to jsPDF.text");if(S.length===0)return kr;var nr,Wr="",Cr=typeof Ae.lineHeightFactor=="number"?Ae.lineHeightFactor:kn,Yr=kr.internal.scaleFactor;function br(Ua){return Ua=Ua.split("	").join(Array(Ae.TabLen||9).join(" ")),Je(Ua,qt)}function ir(Ua){for(var Za,Rs=Ua.concat(),bs=[],Ys=Rs.length;Ys--;)typeof(Za=Rs.shift())=="string"?bs.push(Za):Array.isArray(Ua)&&(Za.length===1||Za[1]===void 0&&Za[2]===void 0)?bs.push(Za[0]):bs.push([Za[0],Za[1],Za[2]]);return bs}function ht(Ua,Za){var Rs;if(typeof Ua=="string")Rs=Za(Ua)[0];else if(Array.isArray(Ua)){for(var bs,Ys,ti=Ua.concat(),Md=[],Mg=ti.length;Mg--;)typeof(bs=ti.shift())=="string"?Md.push(Za(bs)[0]):Array.isArray(bs)&&typeof bs[0]=="string"&&(Ys=Za(bs[0],bs[1],bs[2]),Md.push([Ys[0],Ys[1],Ys[2]]));Rs=Md}return Rs}var Qr=!1,ln=!0;if(typeof S=="string")Qr=!0;else if(Array.isArray(S)){var Ia=S.concat();Pe=[];for(var Ca,dr=Ia.length;dr--;)(typeof(Ca=Ia.shift())!="string"||Array.isArray(Ca)&&typeof Ca[0]!="string")&&(ln=!1);Qr=ln}if(Qr===!1)throw new Error('Type of text must be string or Array. "'+S+'" is not recognized.');typeof S=="string"&&(S=S.match(/[\r?\n]/)?S.split(/\r\n|\r|\n/g):[S]);var wr=gt/kr.internal.scaleFactor,Br=wr*(Cr-1);switch(Ae.baseline){case"bottom":se-=Br;break;case"top":se+=wr-Br;break;case"hanging":se+=wr-2*Br;break;case"middle":se+=wr/2-Br}if((ut=Ae.maxWidth||0)>0&&(typeof S=="string"?S=kr.splitTextToSize(S,ut):Object.prototype.toString.call(S)==="[object Array]"&&(S=S.reduce(function(Ua,Za){return Ua.concat(kr.splitTextToSize(Za,ut))},[]))),oe={text:S,x:G,y:se,options:Ae,mutex:{pdfEscape:Je,activeFontKey:ye,fonts:It,activeFontSize:gt}},Rr.publish("preProcessText",oe),S=oe.text,qe=(Ae=oe.options).angle,At instanceof Re==0&&qe&&typeof qe=="number"){qe*=Math.PI/180,Ae.rotationDirection===0&&(qe=-qe),j===w&&(qe=-qe);var Gr=Math.cos(qe),dn=Math.sin(qe);At=new Re(Gr,dn,-dn,Gr,0,0)}else qe&&qe instanceof Re&&(At=qe);j!==w||At||(At=Qt),(Rt=Ae.charSpace||Li)!==void 0&&(Wr+=E(R(Rt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Kt=Ae.horizontalScale)!==void 0&&(Wr+=E(100*Kt)+` Tz
`),Ae.lang;var sn=-1,or=Ae.renderingMode!==void 0?Ae.renderingMode:Ae.stroke,rn=kr.internal.getCurrentPageInfo().pageContext;switch(or){case 0:case!1:case"fill":sn=0;break;case 1:case!0:case"stroke":sn=1;break;case 2:case"fillThenStroke":sn=2;break;case 3:case"invisible":sn=3;break;case 4:case"fillAndAddForClipping":sn=4;break;case 5:case"strokeAndAddPathForClipping":sn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":sn=6;break;case 7:case"addToPathForClipping":sn=7}var hr=rn.usedRenderingMode!==void 0?rn.usedRenderingMode:-1;sn!==-1?Wr+=sn+` Tr
`:hr!==-1&&(Wr+=`0 Tr
`),sn!==-1&&(rn.usedRenderingMode=sn),He=Ae.align||"left";var xr,Ur=gt*Cr,tn=kr.internal.pageSize.getWidth(),$r=It[ye];Rt=Ae.charSpace||Li,ut=Ae.maxWidth||0,qt=Object.assign({autoencode:!0,noBOM:!0},Ae.flags);var An=[],$n=function(Ua){return kr.getStringUnitWidth(Ua,{font:$r,charSpace:Rt,fontSize:gt,doKerning:!1})*gt/Yr};if(Object.prototype.toString.call(S)==="[object Array]"){var Jr;Pe=ir(S),He!=="left"&&(xr=Pe.map($n));var Bn,Aa=0;if(He==="right"){G-=xr[0],S=[],dr=Pe.length;for(var Ja=0;Ja<dr;Ja++)Ja===0?(Bn=oo(G),Jr=ss(se)):(Bn=R(Aa-xr[Ja]),Jr=-Ur),S.push([Pe[Ja],Bn,Jr]),Aa=xr[Ja]}else if(He==="center"){G-=xr[0]/2,S=[],dr=Pe.length;for(var hs=0;hs<dr;hs++)hs===0?(Bn=oo(G),Jr=ss(se)):(Bn=R((Aa-xr[hs])/2),Jr=-Ur),S.push([Pe[hs],Bn,Jr]),Aa=xr[hs]}else if(He==="left"){S=[],dr=Pe.length;for(var Td=0;Td<dr;Td++)S.push(Pe[Td])}else if(He==="justify"&&$r.encoding==="Identity-H"){S=[],dr=Pe.length,ut=ut!==0?ut:tn;for(var Vc=0,ps=0;ps<dr;ps++)if(Jr=ps===0?ss(se):-Ur,Bn=ps===0?oo(G):Vc,ps<dr-1){var lf=R((ut-xr[ps])/(Pe[ps].split(" ").length-1)),kl=Pe[ps].split(" ");S.push([kl[0]+" ",Bn,Jr]),Vc=0;for(var io=1;io<kl.length;io++){var ei=($n(kl[io-1]+" "+kl[io])-$n(kl[io]))*Yr+lf;io==kl.length-1?S.push([kl[io],ei,0]):S.push([kl[io]+" ",ei,0]),Vc-=ei}}else S.push([Pe[ps],Bn,Jr]);S.push(["",Vc,0])}else{if(He!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(S=[],dr=Pe.length,ut=ut!==0?ut:tn,ps=0;ps<dr;ps++){Jr=ps===0?ss(se):-Ur,Bn=ps===0?oo(G):0;var Kh=Pe[ps].split(" ").length-1,Wc=Kh>0?(ut-xr[ps])/Kh:0;ps<dr-1?An.push(E(R(Wc))):An.push(0),S.push([Pe[ps],Bn,Jr])}}}(typeof Ae.R2L=="boolean"?Ae.R2L:Qe)===!0&&(S=ht(S,function(Ua,Za,Rs){return[Ua.split("").reverse().join(""),Za,Rs]})),oe={text:S,x:G,y:se,options:Ae,mutex:{pdfEscape:Je,activeFontKey:ye,fonts:It,activeFontSize:gt}},Rr.publish("postProcessText",oe),S=oe.text,nr=oe.mutex.isHex||!1;var Dd=It[ye].encoding;Dd!=="WinAnsiEncoding"&&Dd!=="StandardEncoding"||(S=ht(S,function(Ua,Za,Rs){return[br(Ua),Za,Rs]})),Pe=ir(S),S=[];for(var al,bi,Ws,ac=Array.isArray(Pe[0])?1:0,Hc="",Il=function(Ua,Za,Rs){var bs="";return Rs instanceof Re?(Rs=typeof Ae.angle=="number"?bt(Rs,new Re(1,0,0,1,Ua,Za)):bt(new Re(1,0,0,1,Ua,Za),Rs),j===w&&(Rs=bt(new Re(1,0,0,-1,0,0),Rs)),bs=Rs.join(" ")+` Tm
`):bs=E(Ua)+" "+E(Za)+` Td
`,bs},Ol=0;Ol<Pe.length;Ol++){switch(Hc="",ac){case 1:Ws=(nr?"<":"(")+Pe[Ol][0]+(nr?">":")"),al=parseFloat(Pe[Ol][1]),bi=parseFloat(Pe[Ol][2]);break;case 0:Ws=(nr?"<":"(")+Pe[Ol]+(nr?">":")"),al=oo(G),bi=ss(se)}An!==void 0&&An[Ol]!==void 0&&(Hc=An[Ol]+` Tw
`),Ol===0?S.push(Hc+Il(al,bi,At)+Ws):ac===0?S.push(Hc+Ws):ac===1&&S.push(Hc+Il(al,bi,At)+Ws)}S=ac===0?S.join(` Tj
T* `):S.join(` Tj
`),S+=` Tj
`;var sc=`BT
/`;return sc+=ye+" "+gt+` Tf
`,sc+=E(gt*Cr)+` TL
`,sc+=xi+`
`,sc+=Wr,sc+=S,de(sc+="ET"),h[ye]=!0,kr};var L=m.__private__.clip=m.clip=function(S){return de(S==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return L("evenodd")},m.__private__.discardPath=m.discardPath=function(){return de("n"),this};var Fe=m.__private__.isValidStyle=function(S){var G=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(S)!==-1&&(G=!0),G};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(S){return Fe(S)&&(d=S),this};var nt=m.__private__.getStyle=m.getStyle=function(S){var G=d;switch(S){case"D":case"S":G="S";break;case"F":G="f";break;case"FD":case"DF":G="B";break;case"f":case"f*":case"B":case"B*":G=S}return G},ft=m.close=function(){return de("h"),this};m.stroke=function(){return de("S"),this},m.fill=function(S){return Bt("f",S),this},m.fillEvenOdd=function(S){return Bt("f*",S),this},m.fillStroke=function(S){return Bt("B",S),this},m.fillStrokeEvenOdd=function(S){return Bt("B*",S),this};var Bt=function(S,G){Fa(G)==="object"?Sr(G,S):de(S)},$e=function(S){S===null||j===w&&S===void 0||(S=nt(S),de(S))};function Dt(S,G,se,Ae,V){var oe=new Mp(G||this.boundingBox,se||this.xStep,Ae||this.yStep,this.gState,V||this.matrix);oe.stream=this.stream;var Pe=S+"$$"+this.cloneIndex+++"$$";return ct(Pe,oe),oe}var Sr=function(S,G){var se=Ct[S.key],Ae=st[se];if(Ae instanceof $m)de("q"),de(Pr(G)),Ae.gState&&m.setGState(Ae.gState),de(S.matrix.toString()+" cm"),de("/"+se+" sh"),de("Q");else if(Ae instanceof Mp){var V=new Re(1,0,0,-1,0,Vt());S.matrix&&(V=V.multiply(S.matrix||Qt),se=Dt.call(Ae,S.key,S.boundingBox,S.xStep,S.yStep,V).id),de("q"),de("/Pattern cs"),de("/"+se+" scn"),Ae.gState&&m.setGState(Ae.gState),de(G),de("Q")}},Pr=function(S){switch(S){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},vr=m.moveTo=function(S,G){return de(E(R(S))+" "+E(M(G))+" m"),this},yn=m.lineTo=function(S,G){return de(E(R(S))+" "+E(M(G))+" l"),this},On=m.curveTo=function(S,G,se,Ae,V,oe){return de([E(R(S)),E(M(G)),E(R(se)),E(M(Ae)),E(R(V)),E(M(oe)),"c"].join(" ")),this};m.__private__.line=m.line=function(S,G,se,Ae,V){if(isNaN(S)||isNaN(G)||isNaN(se)||isNaN(Ae)||!Fe(V))throw new Error("Invalid arguments passed to jsPDF.line");return j===b?this.lines([[se-S,Ae-G]],S,G,[1,1],V||"S"):this.lines([[se-S,Ae-G]],S,G,[1,1]).stroke()},m.__private__.lines=m.lines=function(S,G,se,Ae,V,oe){var Pe,qe,He,Rt,ut,qt,Kt,At,kr,_r,nr,Wr;if(typeof S=="number"&&(Wr=se,se=G,G=S,S=Wr),Ae=Ae||[1,1],oe=oe||!1,isNaN(G)||isNaN(se)||!Array.isArray(S)||!Array.isArray(Ae)||!Fe(V)||typeof oe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(vr(G,se),Pe=Ae[0],qe=Ae[1],Rt=S.length,_r=G,nr=se,He=0;He<Rt;He++)(ut=S[He]).length===2?(_r=ut[0]*Pe+_r,nr=ut[1]*qe+nr,yn(_r,nr)):(qt=ut[0]*Pe+_r,Kt=ut[1]*qe+nr,At=ut[2]*Pe+_r,kr=ut[3]*qe+nr,_r=ut[4]*Pe+_r,nr=ut[5]*qe+nr,On(qt,Kt,At,kr,_r,nr));return oe&&ft(),$e(V),this},m.path=function(S){for(var G=0;G<S.length;G++){var se=S[G],Ae=se.c;switch(se.op){case"m":vr(Ae[0],Ae[1]);break;case"l":yn(Ae[0],Ae[1]);break;case"c":On.apply(this,Ae);break;case"h":ft()}}return this},m.__private__.rect=m.rect=function(S,G,se,Ae,V){if(isNaN(S)||isNaN(G)||isNaN(se)||isNaN(Ae)||!Fe(V))throw new Error("Invalid arguments passed to jsPDF.rect");return j===b&&(Ae=-Ae),de([E(R(S)),E(M(G)),E(R(se)),E(R(Ae)),"re"].join(" ")),$e(V),this},m.__private__.triangle=m.triangle=function(S,G,se,Ae,V,oe,Pe){if(isNaN(S)||isNaN(G)||isNaN(se)||isNaN(Ae)||isNaN(V)||isNaN(oe)||!Fe(Pe))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[se-S,Ae-G],[V-se,oe-Ae],[S-V,G-oe]],S,G,[1,1],Pe,!0),this},m.__private__.roundedRect=m.roundedRect=function(S,G,se,Ae,V,oe,Pe){if(isNaN(S)||isNaN(G)||isNaN(se)||isNaN(Ae)||isNaN(V)||isNaN(oe)||!Fe(Pe))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var qe=4/3*(Math.SQRT2-1);return V=Math.min(V,.5*se),oe=Math.min(oe,.5*Ae),this.lines([[se-2*V,0],[V*qe,0,V,oe-oe*qe,V,oe],[0,Ae-2*oe],[0,oe*qe,-V*qe,oe,-V,oe],[2*V-se,0],[-V*qe,0,-V,-oe*qe,-V,-oe],[0,2*oe-Ae],[0,-oe*qe,V*qe,-oe,V,-oe]],S+V,G,[1,1],Pe,!0),this},m.__private__.ellipse=m.ellipse=function(S,G,se,Ae,V){if(isNaN(S)||isNaN(G)||isNaN(se)||isNaN(Ae)||!Fe(V))throw new Error("Invalid arguments passed to jsPDF.ellipse");var oe=4/3*(Math.SQRT2-1)*se,Pe=4/3*(Math.SQRT2-1)*Ae;return vr(S+se,G),On(S+se,G-Pe,S+oe,G-Ae,S,G-Ae),On(S-oe,G-Ae,S-se,G-Pe,S-se,G),On(S-se,G+Pe,S-oe,G+Ae,S,G+Ae),On(S+oe,G+Ae,S+se,G+Pe,S+se,G),$e(V),this},m.__private__.circle=m.circle=function(S,G,se,Ae){if(isNaN(S)||isNaN(G)||isNaN(se)||!Fe(Ae))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(S,G,se,se,Ae)},m.setFont=function(S,G,se){return se&&(G=P(G,se)),ye=Nr(S,G,{disableWarning:!1}),this};var Xn=m.__private__.getFont=m.getFont=function(){return It[Nr.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var S,G,se={};for(S in Ut)if(Ut.hasOwnProperty(S))for(G in se[S]=[],Ut[S])Ut[S].hasOwnProperty(G)&&se[S].push(G);return se},m.addFont=function(S,G,se,Ae,V){var oe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&oe.indexOf(arguments[3])!==-1?V=arguments[3]:arguments[3]&&oe.indexOf(arguments[3])==-1&&(se=P(se,Ae)),Xr.call(this,S,G,se,V=V||"Identity-H")};var kn,cn=e.lineWidth||.200025,Hr=m.__private__.getLineWidth=m.getLineWidth=function(){return cn},va=m.__private__.setLineWidth=m.setLineWidth=function(S){return cn=S,de(E(R(S))+" w"),this};m.__private__.setLineDash=Wn.API.setLineDash=Wn.API.setLineDashPattern=function(S,G){if(S=S||[],G=G||0,isNaN(G)||!Array.isArray(S))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return S=S.map(function(se){return E(R(se))}).join(" "),G=E(R(G)),de("["+S+"] "+G+" d"),this};var Ma=m.__private__.getLineHeight=m.getLineHeight=function(){return gt*kn};m.__private__.getLineHeight=m.getLineHeight=function(){return gt*kn};var xa=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(S){return typeof(S=S||1.15)=="number"&&(kn=S),this},$a=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return kn};xa(e.lineHeight);var oo=m.__private__.getHorizontalCoordinate=function(S){return R(S)},ss=m.__private__.getVerticalCoordinate=function(S){return j===w?S:lr[q].mediaBox.topRightY-lr[q].mediaBox.bottomLeftY-R(S)},xs=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(S){return E(oo(S))},So=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(S){return E(ss(S))},vi=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return tr(vi)},m.__private__.setStrokeColor=m.setDrawColor=function(S,G,se,Ae){return vi=Or({ch1:S,ch2:G,ch3:se,ch4:Ae,pdfColorType:"draw",precision:2}),de(vi),this};var Od=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return tr(Od)},m.__private__.setFillColor=m.setFillColor=function(S,G,se,Ae){return Od=Or({ch1:S,ch2:G,ch3:se,ch4:Ae,pdfColorType:"fill",precision:2}),de(Od),this};var xi=e.textColor||"0 g",Uc=m.__private__.getTextColor=m.getTextColor=function(){return tr(xi)};m.__private__.setTextColor=m.setTextColor=function(S,G,se,Ae){return xi=Or({ch1:S,ch2:G,ch3:se,ch4:Ae,pdfColorType:"text",precision:3}),this};var Li=e.charSpace,El=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Li||0)};m.__private__.setCharSpace=m.setCharSpace=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Li=S,this};var af=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(S){var G=m.CapJoinStyles[S];if(G===void 0)throw new Error("Line cap style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return af=G,de(G+" J"),this};var nc=0;m.__private__.setLineJoin=m.setLineJoin=function(S){var G=m.CapJoinStyles[S];if(G===void 0)throw new Error("Line join style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return nc=G,de(G+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(S){if(S=S||0,isNaN(S))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return de(E(R(S))+" M"),this},m.GState=Gw,m.setGState=function(S){(S=typeof S=="string"?ar[pr[S]]:Ms(null,S)).equals(Xt)||(de("/"+S.id+" gs"),Xt=S)};var Ms=function(S,G){if(!S||!pr[S]){var se=!1;for(var Ae in ar)if(ar.hasOwnProperty(Ae)&&ar[Ae].equals(G)){se=!0;break}if(se)G=ar[Ae];else{var V="GS"+(Object.keys(ar).length+1).toString(10);ar[V]=G,G.id=V}return S&&(pr[S]=G.id),Rr.publish("addGState",G),G}};m.addGState=function(S,G){return Ms(S,G),this},m.saveGraphicsState=function(){return de("q"),xe.push({key:ye,size:gt,color:xi}),this},m.restoreGraphicsState=function(){de("Q");var S=xe.pop();return ye=S.key,gt=S.size,xi=S.color,Xt=null,this},m.setCurrentTransformationMatrix=function(S){return de(S.toString()+" cm"),this},m.comment=function(S){return de("#"+S),this};var ys=function(S,G){var se=S||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return se},set:function(oe){isNaN(oe)||(se=parseFloat(oe))}});var Ae=G||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ae},set:function(oe){isNaN(oe)||(Ae=parseFloat(oe))}});var V="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return V},set:function(oe){V=oe.toString()}}),this},sf=function(S,G,se,Ae){ys.call(this,S,G),this.type="rect";var V=se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return V},set:function(Pe){isNaN(Pe)||(V=parseFloat(Pe))}});var oe=Ae||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return oe},set:function(Pe){isNaN(Pe)||(oe=parseFloat(Pe))}}),this},bu=function(){this.page=yr,this.currentPage=q,this.pages=te.slice(0),this.pagesContext=lr.slice(0),this.x=mt,this.y=Ft,this.matrix=fr,this.width=of(q),this.height=Ie(q),this.outputDestination=Te,this.id="",this.objectNumber=-1};bu.prototype.restore=function(){yr=this.page,q=this.currentPage,lr=this.pagesContext,te=this.pages,mt=this.x,Ft=this.y,fr=this.matrix,nl(q,this.width),Xe(q,this.height),Te=this.outputDestination};var Fo=function(S,G,se,Ae,V){Ge.push(new bu),yr=q=0,te=[],mt=S,Ft=G,fr=V,cr([se,Ae])};for(var yi in m.beginFormObject=function(S,G,se,Ae,V){return Fo(S,G,se,Ae,V),this},m.endFormObject=function(S){return function(G){if(ke[G])Ge.pop().restore();else{var se=new bu,Ae="Xo"+(Object.keys(De).length+1).toString(10);se.id=Ae,ke[G]=Ae,De[Ae]=se,Rr.publish("addFormObject",se),Ge.pop().restore()}}(S),this},m.doFormObject=function(S,G){var se=De[ke[S]];return de("q"),de(G.toString()+" cm"),de("/"+se.id+" Do"),de("Q"),this},m.getFormObject=function(S){var G=De[ke[S]];return{x:G.x,y:G.y,width:G.width,height:G.height,matrix:G.matrix}},m.save=function(S,G){return S=S||"generated.pdf",(G=G||{}).returnPromise=G.returnPromise||!1,G.returnPromise===!1?(hp(Me(ae()),S),typeof hp.unload=="function"&&ua.setTimeout&&setTimeout(hp.unload,911),this):new Promise(function(se,Ae){try{var V=hp(Me(ae()),S);typeof hp.unload=="function"&&ua.setTimeout&&setTimeout(hp.unload,911),se(V)}catch(oe){Ae(oe.message)}})},Wn.API)Wn.API.hasOwnProperty(yi)&&(yi==="events"&&Wn.API.events.length?function(S,G){var se,Ae,V;for(V=G.length-1;V!==-1;V--)se=G[V][0],Ae=G[V][1],S.subscribe.apply(S,[se].concat(typeof Ae=="function"?[Ae]:Ae))}(Rr,Wn.API.events):m[yi]=Wn.API[yi]);function of(S){return lr[S].mediaBox.topRightX-lr[S].mediaBox.bottomLeftX}function nl(S,G){lr[S].mediaBox.topRightX=G+lr[S].mediaBox.bottomLeftX}function Ie(S){return lr[S].mediaBox.topRightY-lr[S].mediaBox.bottomLeftY}function Xe(S,G){lr[S].mediaBox.topRightY=G+lr[S].mediaBox.bottomLeftY}var rr=m.getPageWidth=function(S){return of(S=S||q)/Be},Gt=m.setPageWidth=function(S,G){nl(S,G*Be)},Vt=m.getPageHeight=function(S){return Ie(S=S||q)/Be},Mt=m.setPageHeight=function(S,G){Xe(S,G*Be)};return m.internal={pdfEscape:Je,getStyle:nt,getFont:Xn,getFontSize:yt,getCharSpace:El,getTextColor:Uc,getLineHeight:Ma,getLineHeightFactor:$a,getLineWidth:Hr,write:lt,getHorizontalCoordinate:oo,getVerticalCoordinate:ss,getCoordinateString:xs,getVerticalCoordinateString:So,collections:{},newObject:it,newAdditionalObject:dt,newObjectDeferred:kt,newObjectDeferredBegin:be,getFilters:Lr,putStream:sr,events:Rr,scaleFactor:Be,pageSize:{getWidth:function(){return rr(q)},setWidth:function(S){Gt(q,S)},getHeight:function(){return Vt(q)},setHeight:function(S){Mt(q,S)}},encryptionOptions:u,encryption:O,getEncryptor:function(S){return u!==null?O.encryptor(S,0):function(G){return G}},output:et,getNumberOfPages:an,pages:te,out:de,f2:D,f3:I,getPageInfo:T,getPageInfoByObjId:X,getCurrentPageInfo:H,getPDFVersion:g,Point:ys,Rectangle:sf,Matrix:Re,hasHotfix:re},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return rr(q)},set:function(S){Gt(q,S)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Vt(q)},set:function(S){Mt(q,S)},enumerable:!0,configurable:!0}),function(S){for(var G=0,se=at.length;G<se;G++){var Ae=Xr.call(this,S[G][0],S[G][1],S[G][2],at[G][3],!0);f===!1&&(h[Ae]=!0);var V=S[G][0].split("-");Ot({id:Ae,fontName:V[0],fontStyle:V[1]||""})}Rr.publish("addFonts",{fonts:It,dictionary:Ut})}.call(m,at),ye="F1",vt(s,r),Rr.publish("initialized"),m}gv.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},gv.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},gv.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},gv.prototype.processOwnerPassword=function(e,t){return qT(BT(t).substr(0,5),e)},gv.prototype.encryptor=function(e,t){var r=BT(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return qT(r,n)}},Gw.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Fa(e)!==Fa(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Wn.API={events:[]},Wn.version="3.0.3";var fo=Wn.API,tR=1,Dg=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},av=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ba=function(e){return e.toFixed(2)},bm=function(e){return e.toFixed(5)};fo.__acroform__={};var rc=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},w9=function(e){return e*tR},Cu=function(e){var t=new tae,r=Fn.internal.getHeight(e)||0,n=Fn.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ba(n)),Number(ba(r))],t},yQe=fo.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},bQe=fo.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},wQe=fo.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},wo=fo.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return wQe(e,t-1)},jo=fo.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return yQe(e,t-1)},_o=fo.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return bQe(e,t-1)},jQe=fo.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],o=e[1],i=e[2],l=e[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(o+l)||0,c.upperRight_X=r(s+i)||0,c.upperRight_Y=n(o)||0,[Number(ba(c.lowerLeft_X)),Number(ba(c.lowerLeft_Y)),Number(ba(c.upperRight_X)),Number(ba(c.upperRight_Y))]},_Qe=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=zT(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+ba(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var o=Cu(e);return o.scope=e.scope,o.stream=t.join(`
`),o}},zT=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(D){return D.split(`
`)}):s.map(function(D){return[D]});var o=r,i=Fn.internal.getHeight(e)||0;i=i<0?-i:i;var l=Fn.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(D,I,R){if(D+1<s.length){var M=I+" "+s[D+1][0];return hj(M,e,R).width<=l-4}return!1};o++;e:for(;o>0;){t="",o--;var d,u,f=hj("3",e,o).height,h=e.multiline?i-o:(i-f)/2,m=h+=2,v=0,g=0,y=0;if(o<=0){t=`(...) Tj
`,t+="% Width of Text: "+hj(t,e,o=12).width+", FieldWidth:"+l+`
`;break}for(var x="",b=0,w=0;w<s.length;w++)if(s.hasOwnProperty(w)){var j=!1;if(s[w].length!==1&&y!==s[w].length-1){if((f+2)*(b+2)+2>i)continue e;x+=s[w][y],j=!0,g=w,w--}else{x=(x+=s[w][y]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var _=parseInt(w),C=c(_,x,o),P=w>=s.length-1;if(C&&!P){x+=" ",y=0;continue}if(C||P){if(P)g=_;else if(e.multiline&&(f+2)*(b+2)+2>i)continue e}else{if(!e.multiline||(f+2)*(b+2)+2>i)continue e;g=_}}for(var E="",A=v;A<=g;A++){var F=s[A];if(e.multiline){if(A===g){E+=F[y]+" ",y=(y+1)%F.length;continue}if(A===v){E+=F[F.length-1]+" ";continue}}E+=F[0]+" "}switch(E=E.substr(E.length-1)==" "?E.substr(0,E.length-1):E,u=hj(E,e,o).width,e.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}t+=ba(d)+" "+ba(m)+` Td
`,t+="("+Dg(E)+`) Tj
`,t+=-ba(d)+` 0 Td
`,m=-(o+2),u=0,v=j?g:g+1,b++,x=""}break}return n.text=t,n.fontSize=o,n},hj=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},NQe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},SQe=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},CQe=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(vu.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(NQe)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");tR=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new rae,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];o.objId=void 0,o.hasAnnotation&&SQe(o,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var o=!n;for(var i in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var l=n[i],c=[],d=l.Rect;if(l.Rect&&(l.Rect=jQe(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Fn.createDefaultAppearanceStream(l),Fa(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=_Qe(l);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var f="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var m=l.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var i in m)if(m.hasOwnProperty(i)){var v=m[i];typeof v=="function"&&(v=v.call(s,l)),f+="/"+i+" "+v+" ",s.internal.acroformPlugin.xForms.indexOf(v)>=0||s.internal.acroformPlugin.xForms.push(v)}}else typeof(v=m)=="function"&&(v=v.call(s,l)),f+="/"+i+" "+v,s.internal.acroformPlugin.xForms.indexOf(v)>=0||s.internal.acroformPlugin.xForms.push(v);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}o&&function(g,y){for(var x in g)if(g.hasOwnProperty(x)){var b=x,w=g[x];y.internal.newObjectDeferredBegin(w.objId,!0),Fa(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[b]}}(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},eae=fo.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(i){return i};if(Array.isArray(e)){for(var s="[",o=0;o<e.length;o++)switch(o!==0&&(s+=" "),Fa(e[o])){case"boolean":case"number":case"object":s+=e[o].toString();break;case"string":e[o].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+Dg(n(e[o].toString()))+")"):s+=e[o].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},EE=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Dg(n(e))+")"},$u=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};$u.prototype.toString=function(){return this.objId+" 0 R"},$u.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},$u.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:eae(s,this.objId,this.scope)}):s instanceof $u?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var tae=function(){$u.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};rc(tae,$u);var rae=function(){$u.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Dg(r(e))+")"}},set:function(r){e=r}})};rc(rae,$u);var vu=function e(){$u.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!wo(t,3)},set:function(x){x?this.F=jo(t,3):this.F=_o(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof xS)return;o="FieldObject"+e.FieldNum++}var x=function(b){return b};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Dg(x(o))+")"},set:function(x){o=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(x){o=x}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(x){i=x}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/tR:d},set:function(x){d=x}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(x){u=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof xS||this instanceof gh))return EE(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Ho==0?EE(h,this.objId,this.scope):h},set:function(x){x=x.toString(),h=this instanceof Ho==0?x.substr(0,1)==="("?av(x.substr(1,x.length-2)):av(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ho==1?av(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof Ho==1?"/"+x:x}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Ho==0?EE(m,this.objId,this.scope):m},set:function(x){x=x.toString(),m=this instanceof Ho==0?x.substr(0,1)==="("?av(x.substr(1,x.length-2)):av(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ho==1?av(m.substr(1,m.length-1)):m},set:function(x){x=x.toString(),m=this instanceof Ho==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(x){x=!!x,g=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(x){v=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,1)},set:function(x){x?this.Ff=jo(this.Ff,1):this.Ff=_o(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,2)},set:function(x){x?this.Ff=jo(this.Ff,2):this.Ff=_o(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,3)},set:function(x){x?this.Ff=jo(this.Ff,3):this.Ff=_o(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');y=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(y){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};rc(vu,$u);var Hp=function(){vu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return eae(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(o,i,l){l||(l=1);for(var c,d=[];c=i.exec(o);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,18)},set:function(r){r?this.Ff=jo(this.Ff,18):this.Ff=_o(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=jo(this.Ff,19):this.Ff=_o(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,20)},set:function(r){r?(this.Ff=jo(this.Ff,20),t.sort()):this.Ff=_o(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,22)},set:function(r){r?this.Ff=jo(this.Ff,22):this.Ff=_o(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,23)},set:function(r){r?this.Ff=jo(this.Ff,23):this.Ff=_o(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,27)},set:function(r){r?this.Ff=jo(this.Ff,27):this.Ff=_o(this.Ff,27)}}),this.hasAppearanceStream=!1};rc(Hp,vu);var Gp=function(){Hp.call(this),this.fontName="helvetica",this.combo=!1};rc(Gp,Hp);var Kp=function(){Gp.call(this),this.combo=!0};rc(Kp,Gp);var gb=function(){Kp.call(this),this.edit=!0};rc(gb,Kp);var Ho=function(){vu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,15)},set:function(r){r?this.Ff=jo(this.Ff,15):this.Ff=_o(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,16)},set:function(r){r?this.Ff=jo(this.Ff,16):this.Ff=_o(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,17)},set:function(r){r?this.Ff=jo(this.Ff,17):this.Ff=_o(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,26)},set:function(r){r?this.Ff=jo(this.Ff,26):this.Ff=_o(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+Dg(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Fa(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};rc(Ho,vu);var vb=function(){Ho.call(this),this.pushButton=!0};rc(vb,Ho);var Xp=function(){Ho.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};rc(Xp,Ho);var xS=function(){var e,t;vu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var o,i=[];for(o in i.push("<<"),n)i.push("/"+o+" ("+Dg(s(n[o]))+")");return i.push(">>"),i.join(`
`)},set:function(s){Fa(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Fn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};rc(xS,vu),Xp.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Xp.prototype.createOption=function(e){var t=new xS;return t.Parent=this,t.optionName=e,this.Kids.push(t),AQe.call(this.scope,t),t};var xb=function(){Ho.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Fn.CheckBox.createAppearanceStream()};rc(xb,Ho);var gh=function(){vu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,13)},set:function(t){t?this.Ff=jo(this.Ff,13):this.Ff=_o(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,21)},set:function(t){t?this.Ff=jo(this.Ff,21):this.Ff=_o(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,23)},set:function(t){t?this.Ff=jo(this.Ff,23):this.Ff=_o(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,24)},set:function(t){t?this.Ff=jo(this.Ff,24):this.Ff=_o(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,25)},set:function(t){t?this.Ff=jo(this.Ff,25):this.Ff=_o(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,26)},set:function(t){t?this.Ff=jo(this.Ff,26):this.Ff=_o(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};rc(gh,vu);var yb=function(){gh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!wo(this.Ff,14)},set:function(e){e?this.Ff=jo(this.Ff,14):this.Ff=_o(this.Ff,14)}}),this.password=!0};rc(yb,gh);var Fn={CheckBox:{createAppearanceStream:function(){return{N:{On:Fn.CheckBox.YesNormal},D:{On:Fn.CheckBox.YesPushDown,Off:Fn.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Cu(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),o=zT(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+ba(Fn.internal.getWidth(e))+" "+ba(Fn.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+ba(o.fontSize)+" Tf "+s),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Cu(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],o=Fn.internal.getHeight(e),i=Fn.internal.getWidth(e),l=zT(e,e.caption);return s.push("1 g"),s.push("0 0 "+ba(i)+" "+ba(o)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+ba(i-1)+" "+ba(o-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+ba(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=Cu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ba(Fn.internal.getWidth(e))+" "+ba(Fn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Fn.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Fn.RadioButton.Circle.YesNormal,t.D[e]=Fn.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Cu(e);t.scope=e.scope;var r=[],n=Fn.internal.getWidth(e)<=Fn.internal.getHeight(e)?Fn.internal.getWidth(e)/4:Fn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Fn.internal.Bezier_C,o=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+bm(Fn.internal.getWidth(e)/2)+" "+bm(Fn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Cu(e);t.scope=e.scope;var r=[],n=Fn.internal.getWidth(e)<=Fn.internal.getHeight(e)?Fn.internal.getWidth(e)/4:Fn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*Fn.internal.Bezier_C).toFixed(5)),i=Number((n*Fn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+bm(Fn.internal.getWidth(e)/2)+" "+bm(Fn.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),r.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),r.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),r.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+bm(Fn.internal.getWidth(e)/2)+" "+bm(Fn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Cu(e);t.scope=e.scope;var r=[],n=Fn.internal.getWidth(e)<=Fn.internal.getHeight(e)?Fn.internal.getWidth(e)/4:Fn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*Fn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+bm(Fn.internal.getWidth(e)/2)+" "+bm(Fn.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),r.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),r.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),r.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Fn.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Fn.RadioButton.Cross.YesNormal,t.D[e]=Fn.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Cu(e);t.scope=e.scope;var r=[],n=Fn.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+ba(Fn.internal.getWidth(e)-2)+" "+ba(Fn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ba(n.x1.x)+" "+ba(n.x1.y)+" m"),r.push(ba(n.x2.x)+" "+ba(n.x2.y)+" l"),r.push(ba(n.x4.x)+" "+ba(n.x4.y)+" m"),r.push(ba(n.x3.x)+" "+ba(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Cu(e);t.scope=e.scope;var r=Fn.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+ba(Fn.internal.getWidth(e))+" "+ba(Fn.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ba(Fn.internal.getWidth(e)-2)+" "+ba(Fn.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(ba(r.x1.x)+" "+ba(r.x1.y)+" m"),n.push(ba(r.x2.x)+" "+ba(r.x2.y)+" l"),n.push(ba(r.x4.x)+" "+ba(r.x4.y)+" m"),n.push(ba(r.x3.x)+" "+ba(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Cu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ba(Fn.internal.getWidth(e))+" "+ba(Fn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Fn.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Fn.internal.getWidth(e),r=Fn.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},Fn.internal.getWidth=function(e){var t=0;return Fa(e)==="object"&&(t=w9(e.Rect[2])),t},Fn.internal.getHeight=function(e){var t=0;return Fa(e)==="object"&&(t=w9(e.Rect[3])),t};var AQe=fo.addField=function(e){if(CQe(this,e),!(e instanceof vu))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};fo.AcroFormChoiceField=Hp,fo.AcroFormListBox=Gp,fo.AcroFormComboBox=Kp,fo.AcroFormEditBox=gb,fo.AcroFormButton=Ho,fo.AcroFormPushButton=vb,fo.AcroFormRadioButton=Xp,fo.AcroFormCheckBox=xb,fo.AcroFormTextField=gh,fo.AcroFormPasswordField=yb,fo.AcroFormAppearance=Fn,fo.AcroForm={ChoiceField:Hp,ListBox:Gp,ComboBox:Kp,EditBox:gb,Button:Ho,PushButton:vb,RadioButton:Xp,CheckBox:xb,TextField:gh,PasswordField:yb,Appearance:Fn},Wn.AcroForm={ChoiceField:Hp,ListBox:Gp,ComboBox:Kp,EditBox:gb,Button:Ho,PushButton:vb,RadioButton:Xp,CheckBox:xb,TextField:gh,PasswordField:yb,Appearance:Fn};var PQe=Wn.AcroForm;function nae(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(D,I){var R,M,U,z,W,$=r;if((I=I||r)==="RGBA"||D.data!==void 0&&D.data instanceof Uint8ClampedArray&&"height"in D&&"width"in D)return"RGBA";if(C(D))for(W in n)for(U=n[W],R=0;R<U.length;R+=1){for(z=!0,M=0;M<U[R].length;M+=1)if(U[R][M]!==void 0&&U[R][M]!==D[M]){z=!1;break}if(z===!0){$=W;break}}else for(W in n)for(U=n[W],R=0;R<U.length;R+=1){for(z=!0,M=0;M<U[R].length;M+=1)if(U[R][M]!==void 0&&U[R][M]!==D.charCodeAt(M)){z=!1;break}if(z===!0){$=W;break}}return $===r&&I!==r&&($=I),$},o=function D(I){for(var R=this.internal.write,M=this.internal.putStream,U=(0,this.internal.getFilters)();U.indexOf("FlateEncode")!==-1;)U.splice(U.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var z=[];if(z.push({key:"Type",value:"/XObject"}),z.push({key:"Subtype",value:"/Image"}),z.push({key:"Width",value:I.width}),z.push({key:"Height",value:I.height}),I.colorSpace===x.INDEXED?z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(z.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===x.DEVICE_CMYK&&z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),z.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&z.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)&&I.transparency.length>0){for(var W="",$=0,ee=I.transparency.length;$<ee;$++)W+=I.transparency[$]+" "+I.transparency[$]+" ";z.push({key:"Mask",value:"["+W+"]"})}I.sMask!==void 0&&z.push({key:"SMask",value:I.objectId+1+" 0 R"});var ve=I.filter!==void 0?["/"+I.filter]:void 0;if(M({data:I.data,additionalKeyValues:z,alreadyAppliedFilters:ve,objectId:I.objectId}),R("endobj"),"sMask"in I&&I.sMask!==void 0){var _e,K=(_e=I.sMaskBitsPerComponent)!==null&&_e!==void 0?_e:I.bitsPerComponent,q={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:K,data:I.sMask};"filter"in I&&(q.decodeParameters="/Predictor ".concat(I.predictor," /Colors 1 /BitsPerComponent ").concat(K," /Columns ").concat(I.width),q.filter=I.filter),D.call(this,q)}if(I.colorSpace===x.INDEXED){var Y=this.internal.newObject();M({data:E(new Uint8Array(I.palette)),objectId:Y}),R("endobj")}},i=function(){var D=this.internal.collections[t+"images"];for(var I in D)o.call(this,D[I])},l=function(){var D,I=this.internal.collections[t+"images"],R=this.internal.write;for(var M in I)R("/I"+(D=I[M]).index,D.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var D=this.internal.collections[t+"images"];return c.call(this),D},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(D){return typeof e["process"+D.toUpperCase()]=="function"},h=function(D){return Fa(D)==="object"&&D.nodeType===1},m=function(D,I){if(D.nodeName==="IMG"&&D.hasAttribute("src")){var R=""+D.getAttribute("src");if(R.indexOf("data:image/")===0)return r_(unescape(R).split("base64,").pop());var M=e.loadFile(R,!0);if(M!==void 0)return M}if(D.nodeName==="CANVAS"){if(D.width===0||D.height===0)throw new Error("Given canvas must have data. Canvas width: "+D.width+", height: "+D.height);var U;switch(I){case"PNG":U="image/png";break;case"WEBP":U="image/webp";break;default:U="image/jpeg"}return r_(D.toDataURL(U,1).split("base64,").pop())}},v=function(D){var I=this.internal.collections[t+"images"];if(I){for(var R in I)if(D===I[R].alias)return I[R]}},g=function(D,I,R){return D||I||(D=-96,I=-96),D<0&&(D=-1*R.width*72/D/this.internal.scaleFactor),I<0&&(I=-1*R.height*72/I/this.internal.scaleFactor),D===0&&(D=I*R.width/R.height),I===0&&(I=D*R.height/R.width),[D,I]},y=function(D,I,R,M,U,z){var W=g.call(this,R,M,U),$=this.internal.getCoordinateString,ee=this.internal.getVerticalCoordinateString,ve=d.call(this);if(R=W[0],M=W[1],ve[U.index]=U,z){z*=Math.PI/180;var _e=Math.cos(z),K=Math.sin(z),q=function(J){return J.toFixed(4)},Y=[q(_e),q(K),q(-1*K),q(_e),0,0,"cm"]}this.internal.write("q"),z?(this.internal.write([1,"0","0",1,$(D),ee(I+M),"cm"].join(" ")),this.internal.write(Y.join(" ")),this.internal.write([$(R),"0","0",$(M),"0","0","cm"].join(" "))):this.internal.write([$(R),"0","0",$(M),$(D),ee(I+M),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+U.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(D){var I,R,M=0;if(typeof D=="string")for(R=D.length,I=0;I<R;I++)M=(M<<5)-M+D.charCodeAt(I),M|=0;else if(C(D))for(R=D.byteLength/2,I=0;I<R;I++)M=(M<<5)-M+D[I],M|=0;return M},j=e.__addimage__.validateStringAsBase64=function(D){(D=D||"").toString().trim();var I=!0;return D.length===0&&(I=!1),D.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(D.substr(0,D.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(D.substr(-2))===!1&&(I=!1),I},_=e.__addimage__.extractImageFromDataUrl=function(D){if(D==null||!(D=D.trim()).startsWith("data:"))return null;var I=D.indexOf(",");return I<0?null:D.substring(0,I).trim().endsWith("base64")?D.substring(I+1):null};e.__addimage__.isArrayBuffer=function(D){return D instanceof ArrayBuffer};var C=e.__addimage__.isArrayBufferView=function(D){return D instanceof Int8Array||D instanceof Uint8Array||D instanceof Uint8ClampedArray||D instanceof Int16Array||D instanceof Uint16Array||D instanceof Int32Array||D instanceof Uint32Array||D instanceof Float32Array||D instanceof Float64Array},P=e.__addimage__.binaryStringToUint8Array=function(D){for(var I=D.length,R=new Uint8Array(I),M=0;M<I;M++)R[M]=D.charCodeAt(M);return R},E=e.__addimage__.arrayBufferToBinaryString=function(D){for(var I="",R=C(D)?D:new Uint8Array(D),M=0;M<R.length;M+=8192)I+=String.fromCharCode.apply(null,R.subarray(M,M+8192));return I};e.addImage=function(){var D,I,R,M,U,z,W,$,ee;if(typeof arguments[1]=="number"?(I=r,R=arguments[1],M=arguments[2],U=arguments[3],z=arguments[4],W=arguments[5],$=arguments[6],ee=arguments[7]):(I=arguments[1],R=arguments[2],M=arguments[3],U=arguments[4],z=arguments[5],W=arguments[6],$=arguments[7],ee=arguments[8]),Fa(D=arguments[0])==="object"&&!h(D)&&"imageData"in D){var ve=D;D=ve.imageData,I=ve.format||I||r,R=ve.x||R||0,M=ve.y||M||0,U=ve.w||ve.width||U,z=ve.h||ve.height||z,W=ve.alias||W,$=ve.compression||$,ee=ve.rotation||ve.angle||ee}var _e=this.internal.getFilters();if($===void 0&&_e.indexOf("FlateEncode")!==-1&&($="SLOW"),isNaN(R)||isNaN(M))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var K=A.call(this,D,I,W,$);return y.call(this,R,M,U,z,K,ee),this};var A=function(D,I,R,M){var U,z,W;if(typeof D=="string"&&s(D)===r){D=unescape(D);var $=F(D,!1);($!==""||($=e.loadFile(D,!0))!==void 0)&&(D=$)}if(h(D)&&(D=m(D,I)),I=s(D,I),!f(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((W=R)==null||W.length===0)&&(R=function(ee){return typeof ee=="string"||C(ee)?w(ee):C(ee.data)?w(ee.data):null}(D)),(U=v.call(this,R))||(D instanceof Uint8Array||I==="RGBA"||(z=D,D=P(D)),U=this["process"+I.toUpperCase()](D,u.call(this),R,function(ee){return ee&&typeof ee=="string"&&(ee=ee.toUpperCase()),ee in e.image_compression?ee:b.NONE}(M),z)),!U)throw new Error("An unknown error occurred whilst processing the image.");return U},F=e.__addimage__.convertBase64ToBinaryString=function(D,I){I=typeof I!="boolean"||I;var R,M="";if(typeof D=="string"){var U;R=(U=_(D))!==null&&U!==void 0?U:D;try{M=r_(R)}catch(z){if(I)throw j(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return M};e.getImageProperties=function(D){var I,R,M="";if(h(D)&&(D=m(D)),typeof D=="string"&&s(D)===r&&((M=F(D,!1))===""&&(M=e.loadFile(D)||""),D=M),R=s(D),!f(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(D instanceof Uint8Array||(D=P(D)),!(I=this["process"+R.toUpperCase()](D)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=R,I}})(Wn.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Wn.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,o,i=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,f=0;f<d.length&&!u;f++)switch((n=d[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var h=0;h<d.length;h++){n=d[h];var m=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(g.objId),b=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(s="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(x(n.contents))+")",o+=" /Popup "+y.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+m(x(b))+") >>",g.content=o;var w=g.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+i(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(o+=" /Open true"),o+=" >>",y.content=o,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":s="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(v(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var _=this.annotations._nameMap[n.options.name];n.options.pageNumber=_.page,n.options.top=_.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;default:var C=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+C+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,o,i){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+s),h:d(n+o)},options:i,type:"link"})},e.textWithLink=function(r,n,s,o){var i,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){l=o.maxWidth;var u=this.splitTextToSize(r,l).length;i=Math.ceil(d*u)}else l=c,i=d;return this.text(r,n,s,o),s+=.2*d,o.align==="center"&&(n-=c/2),o.align==="right"&&(n-=c),this.link(n,s-d,l,i,o),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Wn.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var o=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},i=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return i(g)&&s.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,x=r,b="",w=0;for(y=0;y<g.length;y+=1)x[g.charCodeAt(y)]!==void 0?(w++,typeof(x=x[g.charCodeAt(y)])=="number"&&(b+=String.fromCharCode(x),x=r,w=0),y===g.length-1&&(x=r,b+=g.charAt(y-(w-1)),y-=w-1,w=0)):(x=r,b+=g.charAt(y-w),y-=w,w=0);return b};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var h=e.__arabicParser__.getCorrectForm=function(g,y,x){return i(g)?o(g)===!1?-1:!d(g)||!i(y)&&!i(x)||!i(x)&&l(y)||l(g)&&!i(y)||l(g)&&c(y)||l(g)&&l(y)?0:u(g)&&i(y)&&!l(y)&&i(x)&&d(x)?3:l(g)||!i(x)?1:2:-1},m=function(g){var y=0,x=0,b=0,w="",j="",_="",C=(g=g||"").split("\\s+"),P=[];for(y=0;y<C.length;y+=1){for(P.push(""),x=0;x<C[y].length;x+=1)w=C[y][x],j=C[y][x-1],_=C[y][x+1],i(w)?(b=h(w,j,_),P[y]+=b!==-1?String.fromCharCode(t[w.charCodeAt(0)][b]):w):P[y]+=w;P[y]=f(P[y])}return P.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(y)){var b=0;for(x=[],b=0;b<y.length;b+=1)Array.isArray(y[b])?x.push([m(y[b][0]),y[b][1],y[b][2]]):x.push([m(y[b])]);g=x}else g=m(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",v])}(Wn.API),Wn.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(l){o=l}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(l){i=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Wn.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(g){v=g}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),f=d.font||this.getFont(),h=d.scaleFactor||this.internal.scaleFactor,m=0,v=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=d.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,j){return w.concat(y.splitTextToSize(j,x))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)m<(g=this.getStringUnitWidth(c[b],{font:f})*u)&&(m=g);return m!==0&&(v=c.length),{w:m/=h,h:Math.max((v*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/h,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,h=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,m&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,d,u,f,h){if(n.call(this),!u)throw new Error("No data for PDF table.");var m,v,g,y,x=[],b=[],w=[],j={},_={},C=[],P=[],E=(h=h||{}).autoSize||!1,A=h.printHeaders!==!1,F=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,D=h.margins||Object.assign({width:this.getPageWidth()},t),I=typeof h.padding=="number"?h.padding:3,R=h.headerBackgroundColor||"#c8c8c8",M=h.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=D,this.internal.__cell__.table_font_size=F,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=M,this.setFontSize(F),f==null)b=x=Object.keys(u[0]),w=x.map(function(){return"left"});else if(Array.isArray(f)&&Fa(f[0])==="object")for(x=f.map(function(ve){return ve.name}),b=f.map(function(ve){return ve.prompt||ve.name||""}),w=f.map(function(ve){return ve.align||"left"}),m=0;m<f.length;m+=1)_[f[m].name]=.7499990551181103*f[m].width;else Array.isArray(f)&&typeof f[0]=="string"&&(b=x=f,w=x.map(function(){return"left"}));if(E||Array.isArray(f)&&typeof f[0]=="string")for(m=0;m<x.length;m+=1){for(j[y=x[m]]=u.map(function(ve){return ve[y]}),this.setFont(void 0,"bold"),C.push(this.getTextDimensions(b[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=j[y],this.setFont(void 0,"normal"),g=0;g<v.length;g+=1)C.push(this.getTextDimensions(v[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);_[y]=Math.max.apply(null,C)+I+I,C=[]}if(A){var U={};for(m=0;m<x.length;m+=1)U[x[m]]={},U[x[m]].text=b[m],U[x[m]].align=w[m];var z=l.call(this,U,_);P=x.map(function(ve){return new o(c,d,_[ve],z,U[ve].text,void 0,U[ve].align)}),this.setTableHeaderRow(P),this.printHeaderRow(1,!1)}var W=f.reduce(function(ve,_e){return ve[_e.name]=_e.align,ve},{});for(m=0;m<u.length;m+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:m,data:u[m]},this);var $=l.call(this,u[m],_);for(g=0;g<x.length;g+=1){var ee=u[m][x[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:m,col:g,data:ee},this),i.call(this,new o(c,d,_[x[g]],$,ee,m+2,W[x[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(m){var v=c[m];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,d[m]-u-u)},this).map(function(m){return this.getLineHeightFactor()*m.length*f/h+u+u},this).reduce(function(m,v){return Math.max(m,v)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){u=this.internal.__cell__.tableHeaderRow[m].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,h.push(u)),u.lineNumber=c;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,u),this.setTextColor(v)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(Wn.API);var aae={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},sae=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],UT=nae(sae),oae=[100,200,300,400,500,600,700,800,900],EQe=nae(oae);function kE(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return aae[o=o||"normal"]?o:"normal"}(e.style),n=function(o){return o?typeof o=="number"?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):o==="bold"?700:400:400}(e.weight),s=function(o){return typeof UT[o=o||"normal"]=="number"?o:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function j9(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var kQe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},_9={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function N9(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function S9(e){return e.trimLeft()}function IQe(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function OQe(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var pj,C9,A9,sv,gj,P9,E9,k9,IE=["times"];function I9(e,t,r,n,s){var o=4,i=T9;switch(s){case Wn.API.image_compression.FAST:o=1,i=O9;break;case Wn.API.image_compression.MEDIUM:o=6,i=D9;break;case Wn.API.image_compression.SLOW:o=9,i=M9}e=function(c,d,u,f){for(var h,m=c.length/d,v=new Uint8Array(c.length+m),g=[TQe,O9,T9,D9,M9],y=0;y<m;y+=1){var x=y*d,b=c.subarray(x,x+d);if(f)v.set(f(b,u,h),x+y);else{for(var w=g.length,j=[],_=0;_<w;_+=1)j[_]=g[_](b,u,h);var C=MQe(j.concat());v.set(j[C],x+y)}h=b}return v}(e,t,Math.ceil(r*n/8),i);var l=kT(e,{level:o});return Wn.API.__addimage__.arrayBufferToBinaryString(l)}function TQe(e){var t=Array.apply([],e);return t.unshift(0),t}function O9(e,t){var r=e.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var o=e[s-t]||0;n[s+1]=e[s]-o+256&255}return n}function T9(e,t,r){var n=e.length,s=[];s[0]=2;for(var o=0;o<n;o+=1){var i=r&&r[o]||0;s[o+1]=e[o]-i+256&255}return s}function D9(e,t,r){var n=e.length,s=[];s[0]=3;for(var o=0;o<n;o+=1){var i=e[o-t]||0,l=r&&r[o]||0;s[o+1]=e[o]+256-(i+l>>>1)&255}return s}function M9(e,t,r){var n=e.length,s=[];s[0]=4;for(var o=0;o<n;o+=1){var i=DQe(e[o-t]||0,r&&r[o]||0,r&&r[o-t]||0);s[o+1]=e[o]-i+256&255}return s}function DQe(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),s=Math.abs(e-r),o=Math.abs(e+t-r-r);return n<=s&&n<=o?e:s<=o?t:r}function MQe(e){var t=e.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function OE(e,t,r){var n=t*r,s=Math.floor(n/8),o=16-(n-8*s+r),i=(1<<r)-1;return iae(e,s)>>o&i}function R9(e,t,r,n){var s=r*n,o=Math.floor(s/8),i=16-(s-8*o+n),l=(1<<n)-1,c=(t&l)<<i;(function(d,u,f){if(u+1<d.byteLength)d.setUint16(u,f,!1);else{var h=f>>8&255;d.setUint8(u,h)}})(e,o,iae(e,o)&~(l<<i)&65535|c)}function iae(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function RQe(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],o=s>>7,i=1<<1+(7&s);e[t++],e[t++];var l=null,c=null;o&&(l=t,c=i,t+=3*i);var d=!0,u=[],f=0,h=null,m=0,v=null;for(this.width=r,this.height=n;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((D=e[t++])>=0))throw Error("Invalid block size");if(D===0)break;t+=D}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,h=e[t++],1&g||(h=null),m=g>>2&7,t++;break;case 254:for(;;){if(!((D=e[t++])>=0))throw Error("Invalid block size");if(D===0)break;t+=D}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,j=e[t++],_=j>>6&1,C=1<<1+(7&j),P=l,E=c,A=!1;j>>7&&(A=!0,P=t,E=C,t+=3*C);var F=t;for(t++;;){var D;if(!((D=e[t++])>=0))throw Error("Invalid block size");if(D===0)break;t+=D}u.push({x:y,y:x,width:b,height:w,has_local_palette:A,palette_offset:P,palette_size:E,data_offset:F,data_length:t-F,transparent_index:h,interlaced:!!_,delay:f,disposal:m});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return v},this.frameInfo=function(I){if(I<0||I>=u.length)throw new Error("Frame index out of range.");return u[I]},this.decodeAndBlitFrameBGRA=function(I,R){var M=this.frameInfo(I),U=M.width*M.height,z=new Uint8Array(U);L9(e,M.data_offset,z,U);var W=M.palette_offset,$=M.transparent_index;$===null&&($=256);var ee=M.width,ve=r-ee,_e=ee,K=4*(M.y*r+M.x),q=4*((M.y+M.height)*r+M.x),Y=K,J=4*ve;M.interlaced===!0&&(J+=4*r*7);for(var fe=8,Z=0,ce=z.length;Z<ce;++Z){var le=z[Z];if(_e===0&&(_e=ee,(Y+=J)>=q&&(J=4*ve+4*r*(fe-1),Y=K+(ee+ve)*(fe<<1),fe>>=1)),le===$)Y+=4;else{var ie=e[W+3*le],te=e[W+3*le+1],ue=e[W+3*le+2];R[Y++]=ue,R[Y++]=te,R[Y++]=ie,R[Y++]=255}--_e}},this.decodeAndBlitFrameRGBA=function(I,R){var M=this.frameInfo(I),U=M.width*M.height,z=new Uint8Array(U);L9(e,M.data_offset,z,U);var W=M.palette_offset,$=M.transparent_index;$===null&&($=256);var ee=M.width,ve=r-ee,_e=ee,K=4*(M.y*r+M.x),q=4*((M.y+M.height)*r+M.x),Y=K,J=4*ve;M.interlaced===!0&&(J+=4*r*7);for(var fe=8,Z=0,ce=z.length;Z<ce;++Z){var le=z[Z];if(_e===0&&(_e=ee,(Y+=J)>=q&&(J=4*ve+4*r*(fe-1),Y=K+(ee+ve)*(fe<<1),fe>>=1)),le===$)Y+=4;else{var ie=e[W+3*le],te=e[W+3*le+1],ue=e[W+3*le+2];R[Y++]=ie,R[Y++]=te,R[Y++]=ue,R[Y++]=255}--_e}}}function L9(e,t,r,n){for(var s=e[t++],o=1<<s,i=o+1,l=i+1,c=s+1,d=(1<<c)-1,u=0,f=0,h=0,m=e[t++],v=new Int32Array(4096),g=null;;){for(;u<16&&m!==0;)f|=e[t++]<<u,u+=8,m===1?m=e[t++]:--m;if(u<c)break;var y=f&d;if(f>>=c,u-=c,y!==o){if(y===i)break;for(var x=y<l?y:g,b=0,w=x;w>o;)w=v[w]>>8,++b;var j=w;if(h+b+(x!==y?1:0)>n)return void _s.log("Warning, gif stream longer than expected.");r[h++]=j;var _=h+=b;for(x!==y&&(r[h++]=j),w=x;b--;)w=v[w],r[--_]=255&w,w>>=8;g!==null&&l<4096&&(v[l++]=g<<8|j,l>=d+1&&c<12&&(++c,d=d<<1|1)),g=y}else l=i+1,d=(1<<(c=s+1))-1,g=null}return h!==n&&_s.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function TE(e){var t,r,n,s,o,i=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),f=new Array(65535),h=new Array(65535),m=new Array(64),v=new Array(64),g=[],y=0,x=7,b=new Array(64),w=new Array(64),j=new Array(64),_=new Array(256),C=new Array(2048),P=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function z(K,q){for(var Y=0,J=0,fe=new Array,Z=1;Z<=16;Z++){for(var ce=1;ce<=K[Z];ce++)fe[q[J]]=[],fe[q[J]][0]=Y,fe[q[J]][1]=Z,J++,Y++;Y*=2}return fe}function W(K){for(var q=K[0],Y=K[1]-1;Y>=0;)q&1<<Y&&(y|=1<<x),Y--,--x<0&&(y==255?($(255),$(0)):$(y),x=7,y=0)}function $(K){g.push(K)}function ee(K){$(K>>8&255),$(255&K)}function ve(K,q,Y,J,fe){for(var Z,ce=fe[0],le=fe[240],ie=function(gt,Pt){var yt,Qe,ge,rt,pt,We,Ze,Ne,ye,Be,mt=0;for(ye=0;ye<8;++ye){yt=gt[mt],Qe=gt[mt+1],ge=gt[mt+2],rt=gt[mt+3],pt=gt[mt+4],We=gt[mt+5],Ze=gt[mt+6];var Ft=yt+(Ne=gt[mt+7]),fr=yt-Ne,It=Qe+Ze,Ut=Qe-Ze,xe=ge+We,st=ge-We,Ct=rt+pt,ar=rt-pt,pr=Ft+Ct,Xt=Ft-Ct,yr=It+xe,lr=It-xe;gt[mt]=pr+yr,gt[mt+4]=pr-yr;var Rr=.707106781*(lr+Xt);gt[mt+2]=Xt+Rr,gt[mt+6]=Xt-Rr;var Pn=.382683433*((pr=ar+st)-(lr=Ut+fr)),De=.5411961*pr+Pn,ke=1.306562965*lr+Pn,Ge=.707106781*(yr=st+Ut),Re=fr+Ge,bt=fr-Ge;gt[mt+5]=bt+De,gt[mt+3]=bt-De,gt[mt+1]=Re+ke,gt[mt+7]=Re-ke,mt+=8}for(mt=0,ye=0;ye<8;++ye){yt=gt[mt],Qe=gt[mt+8],ge=gt[mt+16],rt=gt[mt+24],pt=gt[mt+32],We=gt[mt+40],Ze=gt[mt+48];var Qt=yt+(Ne=gt[mt+56]),ct=yt-Ne,xt=Qe+Ze,it=Qe-Ze,kt=ge+We,be=ge-We,dt=rt+pt,Lt=rt-pt,mr=Qt+dt,tr=Qt-dt,Or=xt+kt,Lr=xt-kt;gt[mt]=mr+Or,gt[mt+32]=mr-Or;var sr=.707106781*(Lr+tr);gt[mt+16]=tr+sr,gt[mt+48]=tr-sr;var fn=.382683433*((mr=Lt+be)-(Lr=it+ct)),Tn=.5411961*mr+fn,mn=1.306562965*Lr+fn,zn=.707106781*(Or=be+it),ot=ct+zn,$t=ct-zn;gt[mt+40]=$t+Tn,gt[mt+24]=$t-Tn,gt[mt+8]=ot+mn,gt[mt+56]=ot-mn,mt++}for(ye=0;ye<64;++ye)Be=gt[ye]*Pt[ye],m[ye]=Be>0?Be+.5|0:Be-.5|0;return m}(K,q),te=0;te<64;++te)v[P[te]]=ie[te];var ue=v[0]-Y;Y=v[0],ue==0?W(J[0]):(W(J[h[Z=32767+ue]]),W(f[Z]));for(var Te=63;Te>0&&v[Te]==0;)Te--;if(Te==0)return W(ce),Y;for(var ne,de=1;de<=Te;){for(var lt=de;v[de]==0&&de<=Te;)++de;var Nt=de-lt;if(Nt>=16){ne=Nt>>4;for(var at=1;at<=ne;++at)W(le);Nt&=15}Z=32767+v[de],W(fe[(Nt<<4)+h[Z]]),W(f[Z]),de++}return Te!=63&&W(ce),Y}function _e(K){K=Math.min(Math.max(K,1),100),o!=K&&(function(q){for(var Y=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],J=0;J<64;J++){var fe=i((Y[J]*q+50)/100);fe=Math.min(Math.max(fe,1),255),l[P[J]]=fe}for(var Z=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ce=0;ce<64;ce++){var le=i((Z[ce]*q+50)/100);le=Math.min(Math.max(le,1),255),c[P[ce]]=le}for(var ie=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],te=0,ue=0;ue<8;ue++)for(var Te=0;Te<8;Te++)d[te]=1/(l[P[te]]*ie[ue]*ie[Te]*8),u[te]=1/(c[P[te]]*ie[ue]*ie[Te]*8),te++}(K<50?Math.floor(5e3/K):Math.floor(200-2*K)),o=K)}this.encode=function(K,q){q&&_e(q),g=new Array,y=0,x=7,ee(65496),ee(65504),ee(16),$(74),$(70),$(73),$(70),$(0),$(1),$(1),$(0),ee(1),ee(1),$(0),$(0),function(){ee(65499),ee(132),$(0);for(var Qe=0;Qe<64;Qe++)$(l[Qe]);$(1);for(var ge=0;ge<64;ge++)$(c[ge])}(),function(Qe,ge){ee(65472),ee(17),$(8),ee(ge),ee(Qe),$(3),$(1),$(17),$(0),$(2),$(17),$(1),$(3),$(17),$(1)}(K.width,K.height),function(){ee(65476),ee(418),$(0);for(var Qe=0;Qe<16;Qe++)$(E[Qe+1]);for(var ge=0;ge<=11;ge++)$(A[ge]);$(16);for(var rt=0;rt<16;rt++)$(F[rt+1]);for(var pt=0;pt<=161;pt++)$(D[pt]);$(1);for(var We=0;We<16;We++)$(I[We+1]);for(var Ze=0;Ze<=11;Ze++)$(R[Ze]);$(17);for(var Ne=0;Ne<16;Ne++)$(M[Ne+1]);for(var ye=0;ye<=161;ye++)$(U[ye])}(),ee(65498),ee(12),$(3),$(1),$(0),$(2),$(17),$(3),$(17),$(0),$(63),$(0);var Y=0,J=0,fe=0;y=0,x=7,this.encode.displayName="_encode_";for(var Z,ce,le,ie,te,ue,Te,ne,de,lt=K.data,Nt=K.width,at=K.height,gt=4*Nt,Pt=0;Pt<at;){for(Z=0;Z<gt;){for(te=gt*Pt+Z,Te=-1,ne=0,de=0;de<64;de++)ue=te+(ne=de>>3)*gt+(Te=4*(7&de)),Pt+ne>=at&&(ue-=gt*(Pt+1+ne-at)),Z+Te>=gt&&(ue-=Z+Te-gt+4),ce=lt[ue++],le=lt[ue++],ie=lt[ue++],b[de]=(C[ce]+C[le+256|0]+C[ie+512|0]>>16)-128,w[de]=(C[ce+768|0]+C[le+1024|0]+C[ie+1280|0]>>16)-128,j[de]=(C[ce+1280|0]+C[le+1536|0]+C[ie+1792|0]>>16)-128;Y=ve(b,d,Y,t,n),J=ve(w,u,J,r,s),fe=ve(j,u,fe,r,s),Z+=32}Pt+=8}if(x>=0){var yt=[];yt[1]=x+1,yt[0]=(1<<x+1)-1,W(yt)}return ee(65497),new Uint8Array(g)},e=e||50,function(){for(var K=String.fromCharCode,q=0;q<256;q++)_[q]=K(q)}(),t=z(E,A),r=z(I,R),n=z(F,D),s=z(M,U),function(){for(var K=1,q=2,Y=1;Y<=15;Y++){for(var J=K;J<q;J++)h[32767+J]=Y,f[32767+J]=[],f[32767+J][1]=Y,f[32767+J][0]=J;for(var fe=-(q-1);fe<=-K;fe++)h[32767+fe]=Y,f[32767+fe]=[],f[32767+fe][1]=Y,f[32767+fe][0]=q-1+fe;K<<=1,q<<=1}}(),function(){for(var K=0;K<256;K++)C[K]=19595*K,C[K+256|0]=38470*K,C[K+512|0]=7471*K+32768,C[K+768|0]=-11059*K,C[K+1024|0]=-21709*K,C[K+1280|0]=32768*K+8421375,C[K+1536|0]=-27439*K,C[K+1792|0]=-5329*K}(),_e(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function zd(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function F9(e){function t(A){if(!A)throw Error("assert :P")}function r(A,F,D){for(var I=0;4>I;I++)if(A[F+I]!=D.charCodeAt(I))return!0;return!1}function n(A,F,D,I,R){for(var M=0;M<R;M++)A[F+M]=D[I+M]}function s(A,F,D,I){for(var R=0;R<I;R++)A[F+R]=D}function o(A){return new Int32Array(A)}function i(A,F){for(var D=[],I=0;I<A;I++)D.push(new F);return D}function l(A,F){var D=[];return function I(R,M,U){for(var z=U[M],W=0;W<z&&(R.push(U.length>M+1?[]:new F),!(U.length<M+1));W++)I(R[W],M+1,U)}(D,0,A),D}var c=function(){var A=this;function F(N,k){for(var B=1<<k-1>>>0;N&B;)B>>>=1;return B?(N&B-1)+B:N}function D(N,k,B,Q,pe){t(!(Q%B));do N[k+(Q-=B)]=pe;while(0<Q)}function I(N,k,B,Q,pe){if(t(2328>=pe),512>=pe)var je=o(512);else if((je=o(pe))==null)return 0;return function(Ce,Ee,Oe,ze,_t,Zt){var Ue,Et,zt=Ee,Ar=1<<Oe,Jt=o(16),Ir=o(16);for(t(_t!=0),t(ze!=null),t(Ce!=null),t(0<Oe),Et=0;Et<_t;++Et){if(15<ze[Et])return 0;++Jt[ze[Et]]}if(Jt[0]==_t)return 0;for(Ir[1]=0,Ue=1;15>Ue;++Ue){if(Jt[Ue]>1<<Ue)return 0;Ir[Ue+1]=Ir[Ue]+Jt[Ue]}for(Et=0;Et<_t;++Et)Ue=ze[Et],0<ze[Et]&&(Zt[Ir[Ue]++]=Et);if(Ir[15]==1)return(ze=new R).g=0,ze.value=Zt[0],D(Ce,zt,1,Ar,ze),Ar;var Tr,Kr=-1,qr=Ar-1,Gn=0,Ln=1,Na=1,Un=1<<Oe;for(Et=0,Ue=1,_t=2;Ue<=Oe;++Ue,_t<<=1){if(Ln+=Na<<=1,0>(Na-=Jt[Ue]))return 0;for(;0<Jt[Ue];--Jt[Ue])(ze=new R).g=Ue,ze.value=Zt[Et++],D(Ce,zt+Gn,_t,Un,ze),Gn=F(Gn,Ue)}for(Ue=Oe+1,_t=2;15>=Ue;++Ue,_t<<=1){if(Ln+=Na<<=1,0>(Na-=Jt[Ue]))return 0;for(;0<Jt[Ue];--Jt[Ue]){if(ze=new R,(Gn&qr)!=Kr){for(zt+=Un,Tr=1<<(Kr=Ue)-Oe;15>Kr&&!(0>=(Tr-=Jt[Kr]));)++Kr,Tr<<=1;Ar+=Un=1<<(Tr=Kr-Oe),Ce[Ee+(Kr=Gn&qr)].g=Tr+Oe,Ce[Ee+Kr].value=zt-Ee-Kr}ze.g=Ue-Oe,ze.value=Zt[Et++],D(Ce,zt+(Gn>>Oe),_t,Un,ze),Gn=F(Gn,Ue)}}return Ln!=2*Ir[15]-1?0:Ar}(N,k,B,Q,pe,je)}function R(){this.value=this.g=0}function M(){this.value=this.g=0}function U(){this.G=i(5,R),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i($n,M)}function z(N,k,B,Q){t(N!=null),t(k!=null),t(2147483648>Q),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=k,N.pa=B,N.Jd=k,N.Yc=B+Q,N.Zc=4<=Q?B+Q-4+1:B,ce(N)}function W(N,k){for(var B=0;0<k--;)B|=ie(N,128)<<k;return B}function $(N,k){var B=W(N,k);return le(N)?-B:B}function ee(N,k,B,Q){var pe,je=0;for(t(N!=null),t(k!=null),t(4294967288>Q),N.Sb=Q,N.Ra=0,N.u=0,N.h=0,4<Q&&(Q=4),pe=0;pe<Q;++pe)je+=k[B+pe]<<8*pe;N.Ra=je,N.bb=Q,N.oa=k,N.pa=B}function ve(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<Aa-8>>>0,++N.bb,N.u-=8;J(N)&&(N.h=1,N.u=0)}function _e(N,k){if(t(0<=k),!N.h&&k<=Bn){var B=Y(N)&Jr[k];return N.u+=k,ve(N),B}return N.h=1,N.u=0}function K(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function q(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Y(N){return N.Ra>>>(N.u&Aa-1)>>>0}function J(N){return t(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>Aa}function fe(N,k){N.u=k,N.h=J(N)}function Z(N){N.u>=Ja&&(t(N.u>=Ja),ve(N))}function ce(N){t(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(t(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function le(N){return W(N,1)}function ie(N,k){var B=N.Ca;0>N.b&&ce(N);var Q=N.b,pe=B*k>>>8,je=(N.I>>>Q>pe)+0;for(je?(B-=pe,N.I-=pe+1<<Q>>>0):B=pe+1,Q=B,pe=0;256<=Q;)pe+=8,Q>>=8;return Q=7^pe+hs[Q],N.b-=Q,N.Ca=(B<<Q)-1,je}function te(N,k,B){N[k+0]=B>>24&255,N[k+1]=B>>16&255,N[k+2]=B>>8&255,N[k+3]=255&B}function ue(N,k){return N[k+0]|N[k+1]<<8}function Te(N,k){return ue(N,k)|N[k+2]<<16}function ne(N,k){return ue(N,k)|ue(N,k+2)<<16}function de(N,k){var B=1<<k;return t(N!=null),t(0<k),N.X=o(B),N.X==null?0:(N.Mb=32-k,N.Xa=k,1)}function lt(N,k){t(N!=null),t(k!=null),t(N.Xa==k.Xa),n(k.X,0,N.X,0,1<<k.Xa)}function Nt(){this.X=[],this.Xa=this.Mb=0}function at(N,k,B,Q){t(B!=null),t(Q!=null);var pe=B[0],je=Q[0];return pe==0&&(pe=(N*je+k/2)/k),je==0&&(je=(k*pe+N/2)/N),0>=pe||0>=je?0:(B[0]=pe,Q[0]=je,1)}function gt(N,k){return N+(1<<k)-1>>>k}function Pt(N,k){return((4278255360&N)+(4278255360&k)>>>0&4278255360)+((16711935&N)+(16711935&k)>>>0&16711935)>>>0}function yt(N,k){A[k]=function(B,Q,pe,je,Ce,Ee,Oe){var ze;for(ze=0;ze<Ce;++ze){var _t=A[N](Ee[Oe+ze-1],pe,je+ze);Ee[Oe+ze]=Pt(B[Q+ze],_t)}}}function Qe(){this.ud=this.hd=this.jd=0}function ge(N,k){return((4278124286&(N^k))>>>1)+(N&k)>>>0}function rt(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function pt(N,k){return rt(N+(N-k+.5>>1))}function We(N,k,B){return Math.abs(k-B)-Math.abs(N-B)}function Ze(N,k,B,Q,pe,je,Ce){for(Q=je[Ce-1],B=0;B<pe;++B)je[Ce+B]=Q=Pt(N[k+B],Q)}function Ne(N,k,B,Q,pe){var je;for(je=0;je<B;++je){var Ce=N[k+je],Ee=Ce>>8&255,Oe=16711935&(Oe=(Oe=16711935&Ce)+((Ee<<16)+Ee));Q[pe+je]=(4278255360&Ce)+Oe>>>0}}function ye(N,k){k.jd=255&N,k.hd=N>>8&255,k.ud=N>>16&255}function Be(N,k,B,Q,pe,je){var Ce;for(Ce=0;Ce<Q;++Ce){var Ee=k[B+Ce],Oe=Ee>>>8,ze=Ee,_t=255&(_t=(_t=Ee>>>16)+((N.jd<<24>>24)*(Oe<<24>>24)>>>5));ze=255&(ze=(ze+=(N.hd<<24>>24)*(Oe<<24>>24)>>>5)+((N.ud<<24>>24)*(_t<<24>>24)>>>5)),pe[je+Ce]=(4278255360&Ee)+(_t<<16)+ze}}function mt(N,k,B,Q,pe){A[k]=function(je,Ce,Ee,Oe,ze,_t,Zt,Ue,Et){for(Oe=Zt;Oe<Ue;++Oe)for(Zt=0;Zt<Et;++Zt)ze[_t++]=pe(Ee[Q(je[Ce++])])},A[N]=function(je,Ce,Ee,Oe,ze,_t,Zt){var Ue=8>>je.b,Et=je.Ea,zt=je.K[0],Ar=je.w;if(8>Ue)for(je=(1<<je.b)-1,Ar=(1<<Ue)-1;Ce<Ee;++Ce){var Jt,Ir=0;for(Jt=0;Jt<Et;++Jt)Jt&je||(Ir=Q(Oe[ze++])),_t[Zt++]=pe(zt[Ir&Ar]),Ir>>=Ue}else A["VP8LMapColor"+B](Oe,ze,zt,Ar,_t,Zt,Ce,Ee,Et)}}function Ft(N,k,B,Q,pe){for(B=k+B;k<B;){var je=N[k++];Q[pe++]=je>>16&255,Q[pe++]=je>>8&255,Q[pe++]=255&je}}function fr(N,k,B,Q,pe){for(B=k+B;k<B;){var je=N[k++];Q[pe++]=je>>16&255,Q[pe++]=je>>8&255,Q[pe++]=255&je,Q[pe++]=je>>24&255}}function It(N,k,B,Q,pe){for(B=k+B;k<B;){var je=(Ce=N[k++])>>16&240|Ce>>12&15,Ce=240&Ce|Ce>>28&15;Q[pe++]=je,Q[pe++]=Ce}}function Ut(N,k,B,Q,pe){for(B=k+B;k<B;){var je=(Ce=N[k++])>>16&248|Ce>>13&7,Ce=Ce>>5&224|Ce>>3&31;Q[pe++]=je,Q[pe++]=Ce}}function xe(N,k,B,Q,pe){for(B=k+B;k<B;){var je=N[k++];Q[pe++]=255&je,Q[pe++]=je>>8&255,Q[pe++]=je>>16&255}}function st(N,k,B,Q,pe,je){if(je==0)for(B=k+B;k<B;)te(Q,((je=N[k++])[0]>>24|je[1]>>8&65280|je[2]<<8&16711680|je[3]<<24)>>>0),pe+=32;else n(Q,pe,N,k,B)}function Ct(N,k){A[k][0]=A[N+"0"],A[k][1]=A[N+"1"],A[k][2]=A[N+"2"],A[k][3]=A[N+"3"],A[k][4]=A[N+"4"],A[k][5]=A[N+"5"],A[k][6]=A[N+"6"],A[k][7]=A[N+"7"],A[k][8]=A[N+"8"],A[k][9]=A[N+"9"],A[k][10]=A[N+"10"],A[k][11]=A[N+"11"],A[k][12]=A[N+"12"],A[k][13]=A[N+"13"],A[k][14]=A[N+"0"],A[k][15]=A[N+"0"]}function ar(N){return N==pa||N==Ea||N==Fi||N==es}function pr(){this.eb=[],this.size=this.A=this.fb=0}function Xt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function yr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new pr,this.f.kb=new Xt,this.sd=null}function lr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Rr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Pn(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function De(N,k){var B=N.T,Q=k.ba.f.RGBA,pe=Q.eb,je=Q.fb+N.ka*Q.A,Ce=Gc[k.ba.S],Ee=N.y,Oe=N.O,ze=N.f,_t=N.N,Zt=N.ea,Ue=N.W,Et=k.cc,zt=k.dc,Ar=k.Mc,Jt=k.Nc,Ir=N.ka,Tr=N.ka+N.T,Kr=N.U,qr=Kr+1>>1;for(Ir==0?Ce(Ee,Oe,null,null,ze,_t,Zt,Ue,ze,_t,Zt,Ue,pe,je,null,null,Kr):(Ce(k.ec,k.fc,Ee,Oe,Et,zt,Ar,Jt,ze,_t,Zt,Ue,pe,je-Q.A,pe,je,Kr),++B);Ir+2<Tr;Ir+=2)Et=ze,zt=_t,Ar=Zt,Jt=Ue,_t+=N.Rc,Ue+=N.Rc,je+=2*Q.A,Ce(Ee,(Oe+=2*N.fa)-N.fa,Ee,Oe,Et,zt,Ar,Jt,ze,_t,Zt,Ue,pe,je-Q.A,pe,je,Kr);return Oe+=N.fa,N.j+Tr<N.o?(n(k.ec,k.fc,Ee,Oe,Kr),n(k.cc,k.dc,ze,_t,qr),n(k.Mc,k.Nc,Zt,Ue,qr),B--):1&Tr||Ce(Ee,Oe,null,null,ze,_t,Zt,Ue,ze,_t,Zt,Ue,pe,je+Q.A,null,null,Kr),B}function ke(N,k,B){var Q=N.F,pe=[N.J];if(Q!=null){var je=N.U,Ce=k.ba.S,Ee=Ce==ya||Ce==Fi;k=k.ba.f.RGBA;var Oe=[0],ze=N.ka;Oe[0]=N.T,N.Kb&&(ze==0?--Oe[0]:(--ze,pe[0]-=N.width),N.j+N.ka+N.T==N.o&&(Oe[0]=N.o-N.j-ze));var _t=k.eb;ze=k.fb+ze*k.A,N=Rg(Q,pe[0],N.width,je,Oe,_t,ze+(Ee?0:3),k.A),t(B==Oe),N&&ar(Ce)&&im(_t,ze,Ee,je,Oe,k.A)}return 0}function Ge(N){var k=N.ma,B=k.ba.S,Q=11>B,pe=B==_n||B==oa||B==ya||B==Pa||B==12||ar(B);if(k.memory=null,k.Ib=null,k.Jb=null,k.Nd=null,!tn(k.Oa,N,pe?11:12))return 0;if(pe&&ar(B)&&br(),N.da)alert("todo:use_scaling");else{if(Q){if(k.Ib=Pn,N.Kb){if(B=N.U+1>>1,k.memory=o(N.U+2*B),k.memory==null)return 0;k.ec=k.memory,k.fc=0,k.cc=k.ec,k.dc=k.fc+N.U,k.Mc=k.cc,k.Nc=k.dc+B,k.Ib=De,br()}}else alert("todo:EmitYUV");pe&&(k.Jb=ke,Q&&Cr())}if(Q&&!XR){for(N=0;256>N;++N)Boe[N]=89858*(N-128)+Q1>>J1,Uoe[N]=-22014*(N-128)+Q1,zoe[N]=-45773*(N-128),qoe[N]=113618*(N-128)+Q1>>J1;for(N=B0;N<lA;++N)k=76283*(N-16)+Q1>>J1,Voe[N-B0]=sn(k,255),Woe[N-B0]=sn(k+8>>4,15);XR=1}return 1}function Re(N){var k=N.ma,B=N.U,Q=N.T;return t(!(1&N.ka)),0>=B||0>=Q?0:(B=k.Ib(N,k),k.Jb!=null&&k.Jb(N,k,B),k.Dc+=B,1)}function bt(N){N.ma.memory=null}function Qt(N,k,B,Q){return _e(N,8)!=47?0:(k[0]=_e(N,14)+1,B[0]=_e(N,14)+1,Q[0]=_e(N,1),_e(N,3)!=0?0:!N.h)}function ct(N,k){if(4>N)return N+1;var B=N-2>>1;return(2+(1&N)<<B)+_e(k,B)+1}function xt(N,k){return 120<k?k-120:1<=(B=((B=ka[k-1])>>4)*N+(8-(15&B)))?B:1;var B}function it(N,k,B){var Q=Y(B),pe=N[k+=255&Q].g-8;return 0<pe&&(fe(B,B.u+8),Q=Y(B),k+=N[k].value,k+=Q&(1<<pe)-1),fe(B,B.u+N[k].g),N[k].value}function kt(N,k,B){return B.g+=N.g,B.value+=N.value<<k>>>0,t(8>=B.g),N.g}function be(N,k,B){var Q=N.xc;return t((k=Q==0?0:N.vc[N.md*(B>>Q)+(k>>Q)])<N.Wb),N.Ya[k]}function dt(N,k,B,Q){var pe=N.ab,je=N.c*k,Ce=N.C;k=Ce+k;var Ee=B,Oe=Q;for(Q=N.Ta,B=N.Ua;0<pe--;){var ze=N.gc[pe],_t=Ce,Zt=k,Ue=Ee,Et=Oe,zt=(Oe=Q,Ee=B,ze.Ea);switch(t(_t<Zt),t(Zt<=ze.nc),ze.hc){case 2:ps(Ue,Et,(Zt-_t)*zt,Oe,Ee);break;case 0:var Ar=_t,Jt=Zt,Ir=Oe,Tr=Ee,Kr=(Un=ze).Ea;Ar==0&&(Td(Ue,Et,null,null,1,Ir,Tr),Ze(Ue,Et+1,0,0,Kr-1,Ir,Tr+1),Et+=Kr,Tr+=Kr,++Ar);for(var qr=1<<Un.b,Gn=qr-1,Ln=gt(Kr,Un.b),Na=Un.K,Un=Un.w+(Ar>>Un.b)*Ln;Ar<Jt;){var Ba=Na,$o=Un,Sa=1;for(Vc(Ue,Et,Ir,Tr-Kr,1,Ir,Tr);Sa<Kr;){var Vn=(Sa&~Gn)+qr;Vn>Kr&&(Vn=Kr),(0,Kh[Ba[$o++]>>8&15])(Ue,Et+ +Sa,Ir,Tr+Sa-Kr,Vn-Sa,Ir,Tr+Sa),Sa=Vn}Et+=Kr,Tr+=Kr,++Ar&Gn||(Un+=Ln)}Zt!=ze.nc&&n(Oe,Ee-zt,Oe,Ee+(Zt-_t-1)*zt,zt);break;case 1:for(zt=Ue,Jt=Et,Kr=(Ue=ze.Ea)-(Tr=Ue&~(Ir=(Et=1<<ze.b)-1)),Ar=gt(Ue,ze.b),qr=ze.K,ze=ze.w+(_t>>ze.b)*Ar;_t<Zt;){for(Gn=qr,Ln=ze,Na=new Qe,Un=Jt+Tr,Ba=Jt+Ue;Jt<Un;)ye(Gn[Ln++],Na),Wc(Na,zt,Jt,Et,Oe,Ee),Jt+=Et,Ee+=Et;Jt<Ba&&(ye(Gn[Ln++],Na),Wc(Na,zt,Jt,Kr,Oe,Ee),Jt+=Kr,Ee+=Kr),++_t&Ir||(ze+=Ar)}break;case 3:if(Ue==Oe&&Et==Ee&&0<ze.b){for(Jt=Oe,Ue=zt=Ee+(Zt-_t)*zt-(Tr=(Zt-_t)*gt(ze.Ea,ze.b)),Et=Oe,Ir=Ee,Ar=[],Tr=(Kr=Tr)-1;0<=Tr;--Tr)Ar[Tr]=Et[Ir+Tr];for(Tr=Kr-1;0<=Tr;--Tr)Jt[Ue+Tr]=Ar[Tr];lf(ze,_t,Zt,Oe,zt,Oe,Ee)}else lf(ze,_t,Zt,Ue,Et,Oe,Ee)}Ee=Q,Oe=B}Oe!=B&&n(Q,B,Ee,Oe,je)}function Lt(N,k){var B=N.V,Q=N.Ba+N.c*N.C,pe=k-N.C;if(t(k<=N.l.o),t(16>=pe),0<pe){var je=N.l,Ce=N.Ta,Ee=N.Ua,Oe=je.width;if(dt(N,pe,B,Q),pe=Ee=[Ee],t((B=N.C)<(Q=k)),t(je.v<je.va),Q>je.o&&(Q=je.o),B<je.j){var ze=je.j-B;B=je.j,pe[0]+=ze*Oe}if(B>=Q?B=0:(pe[0]+=4*je.v,je.ka=B-je.j,je.U=je.va-je.v,je.T=Q-B,B=1),B){if(Ee=Ee[0],11>(B=N.ca).S){var _t=B.f.RGBA,Zt=(Q=B.S,pe=je.U,je=je.T,ze=_t.eb,_t.A),Ue=je;for(_t=_t.fb+N.Ma*_t.A;0<Ue--;){var Et=Ce,zt=Ee,Ar=pe,Jt=ze,Ir=_t;switch(Q){case In:Dd(Et,zt,Ar,Jt,Ir);break;case _n:al(Et,zt,Ar,Jt,Ir);break;case pa:al(Et,zt,Ar,Jt,Ir),im(Jt,Ir,0,Ar,1,0);break;case nn:ac(Et,zt,Ar,Jt,Ir);break;case oa:st(Et,zt,Ar,Jt,Ir,1);break;case Ea:st(Et,zt,Ar,Jt,Ir,1),im(Jt,Ir,0,Ar,1,0);break;case ya:st(Et,zt,Ar,Jt,Ir,0);break;case Fi:st(Et,zt,Ar,Jt,Ir,0),im(Jt,Ir,1,Ar,1,0);break;case Pa:bi(Et,zt,Ar,Jt,Ir);break;case es:bi(Et,zt,Ar,Jt,Ir),$0(Jt,Ir,Ar,1,0);break;case Js:Ws(Et,zt,Ar,Jt,Ir);break;default:t(0)}Ee+=Oe,_t+=Zt}N.Ma+=je}else alert("todo:EmitRescaledRowsYUVA");t(N.Ma<=B.height)}}N.C=k,t(N.C<=N.i)}function mr(N){var k;if(0<N.ua)return 0;for(k=0;k<N.Wb;++k){var B=N.Ya[k].G,Q=N.Ya[k].H;if(0<B[1][Q[1]+0].g||0<B[2][Q[2]+0].g||0<B[3][Q[3]+0].g)return 0}return 1}function tr(N,k,B,Q,pe,je){if(N.Z!=0){var Ce=N.qd,Ee=N.rd;for(t(dm[N.Z]!=null);k<B;++k)dm[N.Z](Ce,Ee,Q,pe,Q,pe,je),Ce=Q,Ee=pe,pe+=je;N.qd=Ce,N.rd=Ee}}function Or(N,k){var B=N.l.ma,Q=B.Z==0||B.Z==1?N.l.j:N.C;if(Q=N.C<Q?Q:N.C,t(k<=N.l.o),k>Q){var pe=N.l.width,je=B.ca,Ce=B.tb+pe*Q,Ee=N.V,Oe=N.Ba+N.c*Q,ze=N.gc;t(N.ab==1),t(ze[0].hc==3),io(ze[0],Q,k,Ee,Oe,je,Ce),tr(B,Q,k,je,Ce,pe)}N.C=N.Ma=k}function Lr(N,k,B,Q,pe,je,Ce){var Ee=N.$/Q,Oe=N.$%Q,ze=N.m,_t=N.s,Zt=B+N.$,Ue=Zt;pe=B+Q*pe;var Et=B+Q*je,zt=280+_t.ua,Ar=N.Pb?Ee:16777216,Jt=0<_t.ua?_t.Wa:null,Ir=_t.wc,Tr=Zt<Et?be(_t,Oe,Ee):null;t(N.C<je),t(Et<=pe);var Kr=!1;e:for(;;){for(;Kr||Zt<Et;){var qr=0;if(Ee>=Ar){var Gn=Zt-B;t((Ar=N).Pb),Ar.wd=Ar.m,Ar.xd=Gn,0<Ar.s.ua&&lt(Ar.s.Wa,Ar.s.vb),Ar=Ee+Zs}if(Oe&Ir||(Tr=be(_t,Oe,Ee)),t(Tr!=null),Tr.Qb&&(k[Zt]=Tr.qb,Kr=!0),!Kr)if(Z(ze),Tr.jc){qr=ze,Gn=k;var Ln=Zt,Na=Tr.pd[Y(qr)&$n-1];t(Tr.jc),256>Na.g?(fe(qr,qr.u+Na.g),Gn[Ln]=Na.value,qr=0):(fe(qr,qr.u+Na.g-256),t(256<=Na.value),qr=Na.value),qr==0&&(Kr=!0)}else qr=it(Tr.G[0],Tr.H[0],ze);if(ze.h)break;if(Kr||256>qr){if(!Kr)if(Tr.nd)k[Zt]=(Tr.qb|qr<<8)>>>0;else{if(Z(ze),Kr=it(Tr.G[1],Tr.H[1],ze),Z(ze),Gn=it(Tr.G[2],Tr.H[2],ze),Ln=it(Tr.G[3],Tr.H[3],ze),ze.h)break;k[Zt]=(Ln<<24|Kr<<16|qr<<8|Gn)>>>0}if(Kr=!1,++Zt,++Oe>=Q&&(Oe=0,++Ee,Ce!=null&&Ee<=je&&!(Ee%16)&&Ce(N,Ee),Jt!=null))for(;Ue<Zt;)qr=k[Ue++],Jt.X[(506832829*qr&4294967295)>>>Jt.Mb]=qr}else if(280>qr){if(qr=ct(qr-256,ze),Gn=it(Tr.G[4],Tr.H[4],ze),Z(ze),Gn=xt(Q,Gn=ct(Gn,ze)),ze.h)break;if(Zt-B<Gn||pe-Zt<qr)break e;for(Ln=0;Ln<qr;++Ln)k[Zt+Ln]=k[Zt+Ln-Gn];for(Zt+=qr,Oe+=qr;Oe>=Q;)Oe-=Q,++Ee,Ce!=null&&Ee<=je&&!(Ee%16)&&Ce(N,Ee);if(t(Zt<=pe),Oe&Ir&&(Tr=be(_t,Oe,Ee)),Jt!=null)for(;Ue<Zt;)qr=k[Ue++],Jt.X[(506832829*qr&4294967295)>>>Jt.Mb]=qr}else{if(!(qr<zt))break e;for(Kr=qr-280,t(Jt!=null);Ue<Zt;)qr=k[Ue++],Jt.X[(506832829*qr&4294967295)>>>Jt.Mb]=qr;qr=Zt,t(!(Kr>>>(Gn=Jt).Xa)),k[qr]=Gn.X[Kr],Kr=!0}Kr||t(ze.h==J(ze))}if(N.Pb&&ze.h&&Zt<pe)t(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&lt(N.s.vb,N.s.Wa);else{if(ze.h)break e;Ce?.(N,Ee>je?je:Ee),N.a=0,N.$=Zt-B}return 1}return N.a=3,0}function sr(N){t(N!=null),N.vc=null,N.yc=null,N.Ya=null;var k=N.Wa;k!=null&&(k.X=null),N.vb=null,t(N!=null)}function fn(){var N=new He;return N==null?null:(N.a=0,N.xb=UR,Ct("Predictor","VP8LPredictors"),Ct("Predictor","VP8LPredictors_C"),Ct("PredictorAdd","VP8LPredictorsAdd"),Ct("PredictorAdd","VP8LPredictorsAdd_C"),ps=Ne,Wc=Be,Dd=Ft,al=fr,bi=It,Ws=Ut,ac=xe,A.VP8LMapColor32b=kl,A.VP8LMapColor8b=ei,N)}function Tn(N,k,B,Q,pe){var je=1,Ce=[N],Ee=[k],Oe=Q.m,ze=Q.s,_t=null,Zt=0;e:for(;;){if(B)for(;je&&_e(Oe,1);){var Ue=Ce,Et=Ee,zt=Q,Ar=1,Jt=zt.m,Ir=zt.gc[zt.ab],Tr=_e(Jt,2);if(zt.Oc&1<<Tr)je=0;else{switch(zt.Oc|=1<<Tr,Ir.hc=Tr,Ir.Ea=Ue[0],Ir.nc=Et[0],Ir.K=[null],++zt.ab,t(4>=zt.ab),Tr){case 0:case 1:Ir.b=_e(Jt,3)+2,Ar=Tn(gt(Ir.Ea,Ir.b),gt(Ir.nc,Ir.b),0,zt,Ir.K),Ir.K=Ir.K[0];break;case 3:var Kr,qr=_e(Jt,8)+1,Gn=16<qr?0:4<qr?1:2<qr?2:3;if(Ue[0]=gt(Ir.Ea,Gn),Ir.b=Gn,Kr=Ar=Tn(qr,1,0,zt,Ir.K)){var Ln,Na=qr,Un=Ir,Ba=1<<(8>>Un.b),$o=o(Ba);if($o==null)Kr=0;else{var Sa=Un.K[0],Vn=Un.w;for($o[0]=Un.K[0][0],Ln=1;Ln<1*Na;++Ln)$o[Ln]=Pt(Sa[Vn+Ln],$o[Ln-1]);for(;Ln<4*Ba;++Ln)$o[Ln]=0;Un.K[0]=null,Un.K[0]=$o,Kr=1}}Ar=Kr;break;case 2:break;default:t(0)}je=Ar}}if(Ce=Ce[0],Ee=Ee[0],je&&_e(Oe,1)&&!(je=1<=(Zt=_e(Oe,4))&&11>=Zt)){Q.a=3;break e}var gn;if(gn=je)t:{var xo,ja,Va,Ls=Q,_i=Ce,sl=Ee,lo=Zt,qi=B,ol=Ls.m,Bo=Ls.s,Ka=[null],os=1,co=0,is=ri[lo];r:for(;;){if(qi&&_e(ol,1)){var Ni=_e(ol,3)+2,Ld=gt(_i,Ni),yo=gt(sl,Ni),Dl=Ld*yo;if(!Tn(Ld,yo,0,Ls,Ka))break r;for(Ka=Ka[0],Bo.xc=Ni,xo=0;xo<Dl;++xo){var js=Ka[xo]>>8&65535;Ka[xo]=js,js>=os&&(os=js+1)}}if(ol.h)break r;for(ja=0;5>ja;++ja){var qo=Qs[ja];!ja&&0<lo&&(qo+=1<<lo),co<qo&&(co=qo)}var ic=i(os*is,R),il=os,lc=i(il,U);if(lc==null)var cc=null;else t(65536>=il),cc=lc;var Ml=o(co);if(cc==null||Ml==null||ic==null){Ls.a=1;break r}var dc=ic;for(xo=Va=0;xo<os;++xo){var Cs=cc[xo],uc=Cs.G,Fd=Cs.H,Xh=0,df=1,Si=0;for(ja=0;5>ja;++ja){qo=Qs[ja],uc[ja]=dc,Fd[ja]=Va,!ja&&0<lo&&(qo+=1<<lo);a:{var e2,cA=qo,t2=Ls,q0=Ml,Koe=dc,Xoe=Va,dA=0,um=t2.m,Yoe=_e(um,1);if(s(q0,0,0,cA),Yoe){var Joe=_e(um,1)+1,Qoe=_e(um,1),QR=_e(um,Qoe==0?1:8);q0[QR]=1,Joe==2&&(q0[QR=_e(um,8)]=1);var r2=1}else{var ZR=o(19),eL=_e(um,4)+4;if(19<eL){t2.a=3;var n2=0;break a}for(e2=0;e2<eL;++e2)ZR[wi[e2]]=_e(um,3);var uA=void 0,z0=void 0,tL=t2,Zoe=ZR,a2=cA,rL=q0,fA=0,fm=tL.m,nL=8,aL=i(128,R);n:for(;I(aL,0,7,Zoe,19);){if(_e(fm,1)){var eie=2+2*_e(fm,3);if((uA=2+_e(fm,eie))>a2)break n}else uA=a2;for(z0=0;z0<a2&&uA--;){Z(fm);var sL=aL[0+(127&Y(fm))];fe(fm,fm.u+sL.g);var Lg=sL.value;if(16>Lg)rL[z0++]=Lg,Lg!=0&&(nL=Lg);else{var tie=Lg==16,oL=Lg-16,rie=ws[oL],iL=_e(fm,$i[oL])+rie;if(z0+iL>a2)break n;for(var nie=tie?nL:0;0<iL--;)rL[z0++]=nie}}fA=1;break n}fA||(tL.a=3),r2=fA}(r2=r2&&!um.h)&&(dA=I(Koe,Xoe,8,q0,cA)),r2&&dA!=0?n2=dA:(t2.a=3,n2=0)}if(n2==0)break r;if(df&&Bi[ja]==1&&(df=dc[Va].g==0),Xh+=dc[Va].g,Va+=n2,3>=ja){var U0,mA=Ml[0];for(U0=1;U0<qo;++U0)Ml[U0]>mA&&(mA=Ml[U0]);Si+=mA}}if(Cs.nd=df,Cs.Qb=0,df&&(Cs.qb=(uc[3][Fd[3]+0].value<<24|uc[1][Fd[1]+0].value<<16|uc[2][Fd[2]+0].value)>>>0,Xh==0&&256>uc[0][Fd[0]+0].value&&(Cs.Qb=1,Cs.qb+=uc[0][Fd[0]+0].value<<8)),Cs.jc=!Cs.Qb&&6>Si,Cs.jc){var s2,uf=Cs;for(s2=0;s2<$n;++s2){var mm=s2,hm=uf.pd[mm],o2=uf.G[0][uf.H[0]+mm];256<=o2.value?(hm.g=o2.g+256,hm.value=o2.value):(hm.g=0,hm.value=0,mm>>=kt(o2,8,hm),mm>>=kt(uf.G[1][uf.H[1]+mm],16,hm),mm>>=kt(uf.G[2][uf.H[2]+mm],0,hm),kt(uf.G[3][uf.H[3]+mm],24,hm))}}}Bo.vc=Ka,Bo.Wb=os,Bo.Ya=cc,Bo.yc=ic,gn=1;break t}gn=0}if(!(je=gn)){Q.a=3;break e}if(0<Zt){if(ze.ua=1<<Zt,!de(ze.Wa,Zt)){Q.a=1,je=0;break e}}else ze.ua=0;var hA=Q,lL=Ce,aie=Ee,pA=hA.s,gA=pA.xc;if(hA.c=lL,hA.i=aie,pA.md=gt(lL,gA),pA.wc=gA==0?-1:(1<<gA)-1,B){Q.xb=Moe;break e}if((_t=o(Ce*Ee))==null){Q.a=1,je=0;break e}je=(je=Lr(Q,_t,0,Ce,Ee,Ee,null))&&!Oe.h;break e}return je?(pe!=null?pe[0]=_t:(t(_t==null),t(B)),Q.$=0,B||sr(ze)):sr(ze),je}function mn(N,k){var B=N.c*N.i,Q=B+k+16*k;return t(N.c<=k),N.V=o(Q),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+B+k,1)}function zn(N,k){var B=N.C,Q=k-B,pe=N.V,je=N.Ba+N.c*B;for(t(k<=N.l.o);0<Q;){var Ce=16<Q?16:Q,Ee=N.l.ma,Oe=N.l.width,ze=Oe*Ce,_t=Ee.ca,Zt=Ee.tb+Oe*B,Ue=N.Ta,Et=N.Ua;dt(N,Ce,pe,je),lm(Ue,Et,_t,Zt,ze),tr(Ee,B,B+Ce,_t,Zt,Oe),Q-=Ce,pe+=Ce*N.c,B+=Ce}t(B==k),N.C=N.Ma=k}function ot(){this.ub=this.yd=this.td=this.Rb=0}function $t(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Yt(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Ht(){this.Yb=function(){var N=[];return function k(B,Q,pe){for(var je=pe[Q],Ce=0;Ce<je&&(B.push(pe.length>Q+1?[]:0),!(pe.length<Q+1));Ce++)k(B[Ce],Q+1,pe)}(N,0,[3,11]),N}()}function Ot(){this.jb=o(3),this.Wc=l([4,8],Ht),this.Xc=l([4,17],Ht)}function Xr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function Je(){this.ld=this.La=this.dd=this.tc=0}function cr(){this.Na=this.la=0}function vt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Tt(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Dr(){this.uc=this.M=this.Nb=0,this.wa=Array(new Je),this.Y=0,this.ya=Array(new Tt),this.aa=0,this.l=new St}function an(){this.y=o(16),this.f=o(8),this.ea=o(8)}function Nr(){this.cb=this.a=0,this.sc="",this.m=new K,this.Od=new ot,this.Kc=new $t,this.ed=new Xr,this.Qa=new Yt,this.Ic=this.$c=this.Aa=0,this.D=new Dr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,K),this.ia=0,this.pb=i(4,vt),this.Pa=new Ot,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new an),this.Hd=0,this.rb=Array(new cr),this.sb=0,this.wa=Array(new Je),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Tt),this.L=this.aa=0,this.gd=l([4,2],Je),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function St(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Fr(){var N=new Nr;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,Tl||(Tl=ae)),N}function zr(N,k,B){return N.a==0&&(N.a=k,N.sc=B,N.cb=0),0}function ha(N,k,B){return 3<=B&&N[k+0]==157&&N[k+1]==1&&N[k+2]==42}function En(N,k){if(N==null)return 0;if(N.a=0,N.sc="OK",k==null)return zr(N,2,"null VP8Io passed to VP8GetHeaders()");var B=k.data,Q=k.w,pe=k.ha;if(4>pe)return zr(N,7,"Truncated header.");var je=B[Q+0]|B[Q+1]<<8|B[Q+2]<<16,Ce=N.Od;if(Ce.Rb=!(1&je),Ce.td=je>>1&7,Ce.yd=je>>4&1,Ce.ub=je>>5,3<Ce.td)return zr(N,3,"Incorrect keyframe parameters.");if(!Ce.yd)return zr(N,4,"Frame not displayable.");Q+=3,pe-=3;var Ee=N.Kc;if(Ce.Rb){if(7>pe)return zr(N,7,"cannot parse picture header");if(!ha(B,Q,pe))return zr(N,3,"Bad code word");Ee.c=16383&(B[Q+4]<<8|B[Q+3]),Ee.Td=B[Q+4]>>6,Ee.i=16383&(B[Q+6]<<8|B[Q+5]),Ee.Ud=B[Q+6]>>6,Q+=7,pe-=7,N.za=Ee.c+15>>4,N.Ub=Ee.i+15>>4,k.width=Ee.c,k.height=Ee.i,k.Da=0,k.j=0,k.v=0,k.va=k.width,k.o=k.height,k.da=0,k.ib=k.width,k.hb=k.height,k.U=k.width,k.T=k.height,s((je=N.Pa).jb,0,255,je.jb.length),t((je=N.Qa)!=null),je.Cb=0,je.Bb=0,je.Fb=1,s(je.Zb,0,0,je.Zb.length),s(je.Lb,0,0,je.Lb)}if(Ce.ub>pe)return zr(N,7,"bad partition length");z(je=N.m,B,Q,Ce.ub),Q+=Ce.ub,pe-=Ce.ub,Ce.Rb&&(Ee.Ld=le(je),Ee.Kd=le(je)),Ee=N.Qa;var Oe,ze=N.Pa;if(t(je!=null),t(Ee!=null),Ee.Cb=le(je),Ee.Cb){if(Ee.Bb=le(je),le(je)){for(Ee.Fb=le(je),Oe=0;4>Oe;++Oe)Ee.Zb[Oe]=le(je)?$(je,7):0;for(Oe=0;4>Oe;++Oe)Ee.Lb[Oe]=le(je)?$(je,6):0}if(Ee.Bb)for(Oe=0;3>Oe;++Oe)ze.jb[Oe]=le(je)?W(je,8):255}else Ee.Bb=0;if(je.Ka)return zr(N,3,"cannot parse segment header");if((Ee=N.ed).zd=le(je),Ee.Tb=W(je,6),Ee.wb=W(je,3),Ee.Pc=le(je),Ee.Pc&&le(je)){for(ze=0;4>ze;++ze)le(je)&&(Ee.vd[ze]=$(je,6));for(ze=0;4>ze;++ze)le(je)&&(Ee.od[ze]=$(je,6))}if(N.L=Ee.Tb==0?0:Ee.zd?1:2,je.Ka)return zr(N,3,"cannot parse filter header");var _t=pe;if(pe=Oe=Q,Q=Oe+_t,Ee=_t,N.Xb=(1<<W(N.m,2))-1,_t<3*(ze=N.Xb))B=7;else{for(Oe+=3*ze,Ee-=3*ze,_t=0;_t<ze;++_t){var Zt=B[pe+0]|B[pe+1]<<8|B[pe+2]<<16;Zt>Ee&&(Zt=Ee),z(N.Jc[+_t],B,Oe,Zt),Oe+=Zt,Ee-=Zt,pe+=3}z(N.Jc[+ze],B,Oe,Ee),B=Oe<Q?0:5}if(B!=0)return zr(N,B,"cannot parse partitions");for(B=W(Oe=N.m,7),pe=le(Oe)?$(Oe,4):0,Q=le(Oe)?$(Oe,4):0,Ee=le(Oe)?$(Oe,4):0,ze=le(Oe)?$(Oe,4):0,Oe=le(Oe)?$(Oe,4):0,_t=N.Qa,Zt=0;4>Zt;++Zt){if(_t.Cb){var Ue=_t.Zb[Zt];_t.Fb||(Ue+=B)}else{if(0<Zt){N.pb[Zt]=N.pb[0];continue}Ue=B}var Et=N.pb[Zt];Et.Sc[0]=Co[sn(Ue+pe,127)],Et.Sc[1]=ji[sn(Ue+0,127)],Et.Eb[0]=2*Co[sn(Ue+Q,127)],Et.Eb[1]=101581*ji[sn(Ue+Ee,127)]>>16,8>Et.Eb[1]&&(Et.Eb[1]=8),Et.Qc[0]=Co[sn(Ue+ze,117)],Et.Qc[1]=ji[sn(Ue+Oe,127)],Et.lc=Ue+Oe}if(!Ce.Rb)return zr(N,4,"Not a key frame.");for(le(je),Ce=N.Pa,B=0;4>B;++B){for(pe=0;8>pe;++pe)for(Q=0;3>Q;++Q)for(Ee=0;11>Ee;++Ee)ze=ie(je,Toe[B][pe][Q][Ee])?W(je,8):Ioe[B][pe][Q][Ee],Ce.Wc[B][pe].Yb[Q][Ee]=ze;for(pe=0;17>pe;++pe)Ce.Xc[B][pe]=Ce.Wc[B][Doe[pe]]}return N.kc=le(je),N.kc&&(N.Bd=W(je,8)),N.cb=1}function ae(N,k,B,Q,pe,je,Ce){var Ee=k[pe].Yb[B];for(B=0;16>pe;++pe){if(!ie(N,Ee[B+0]))return pe;for(;!ie(N,Ee[B+1]);)if(Ee=k[++pe].Yb[0],B=0,pe==16)return 16;var Oe=k[pe+1].Yb;if(ie(N,Ee[B+2])){var ze=N,_t=0;if(ie(ze,(Ue=Ee)[(Zt=B)+3]))if(ie(ze,Ue[Zt+6])){for(Ee=0,Zt=2*(_t=ie(ze,Ue[Zt+8]))+(Ue=ie(ze,Ue[Zt+9+_t])),_t=0,Ue=Eoe[Zt];Ue[Ee];++Ee)_t+=_t+ie(ze,Ue[Ee]);_t+=3+(8<<Zt)}else ie(ze,Ue[Zt+7])?(_t=7+2*ie(ze,165),_t+=ie(ze,145)):_t=5+ie(ze,159);else _t=ie(ze,Ue[Zt+4])?3+ie(ze,Ue[Zt+5]):2;Ee=Oe[2]}else _t=1,Ee=Oe[1];Oe=Ce+koe[pe],0>(ze=N).b&&ce(ze);var Zt,Ue=ze.b,Et=(Zt=ze.Ca>>1)-(ze.I>>Ue)>>31;--ze.b,ze.Ca+=Et,ze.Ca|=1,ze.I-=(Zt+1&Et)<<Ue,je[Oe]=((_t^Et)-Et)*Q[(0<pe)+0]}return 16}function Me(N){var k=N.rb[N.sb-1];k.la=0,k.Na=0,s(N.zc,0,0,N.zc.length),N.ja=0}function et(N,k,B,Q,pe){pe=N[k+B+32*Q]+(pe>>3),N[k+B+32*Q]=-256&pe?0>pe?0:255:pe}function re(N,k,B,Q,pe,je){et(N,k,0,B,Q+pe),et(N,k,1,B,Q+je),et(N,k,2,B,Q-je),et(N,k,3,B,Q-pe)}function O(N){return(20091*N>>16)+N}function T(N,k,B,Q){var pe,je=0,Ce=o(16);for(pe=0;4>pe;++pe){var Ee=N[k+0]+N[k+8],Oe=N[k+0]-N[k+8],ze=(35468*N[k+4]>>16)-O(N[k+12]),_t=O(N[k+4])+(35468*N[k+12]>>16);Ce[je+0]=Ee+_t,Ce[je+1]=Oe+ze,Ce[je+2]=Oe-ze,Ce[je+3]=Ee-_t,je+=4,k++}for(pe=je=0;4>pe;++pe)Ee=(N=Ce[je+0]+4)+Ce[je+8],Oe=N-Ce[je+8],ze=(35468*Ce[je+4]>>16)-O(Ce[je+12]),et(B,Q,0,0,Ee+(_t=O(Ce[je+4])+(35468*Ce[je+12]>>16))),et(B,Q,1,0,Oe+ze),et(B,Q,2,0,Oe-ze),et(B,Q,3,0,Ee-_t),je++,Q+=32}function X(N,k,B,Q){var pe=N[k+0]+4,je=35468*N[k+4]>>16,Ce=O(N[k+4]),Ee=35468*N[k+1]>>16;re(B,Q,0,pe+Ce,N=O(N[k+1]),Ee),re(B,Q,1,pe+je,N,Ee),re(B,Q,2,pe-je,N,Ee),re(B,Q,3,pe-Ce,N,Ee)}function H(N,k,B,Q,pe){T(N,k,B,Q),pe&&T(N,k+16,B,Q+4)}function L(N,k,B,Q){Il(N,k+0,B,Q,1),Il(N,k+32,B,Q+128,1)}function Fe(N,k,B,Q){var pe;for(N=N[k+0]+4,pe=0;4>pe;++pe)for(k=0;4>k;++k)et(B,Q,k,pe,N)}function nt(N,k,B,Q){N[k+0]&&Ua(N,k+0,B,Q),N[k+16]&&Ua(N,k+16,B,Q+4),N[k+32]&&Ua(N,k+32,B,Q+128),N[k+48]&&Ua(N,k+48,B,Q+128+4)}function ft(N,k,B,Q){var pe,je=o(16);for(pe=0;4>pe;++pe){var Ce=N[k+0+pe]+N[k+12+pe],Ee=N[k+4+pe]+N[k+8+pe],Oe=N[k+4+pe]-N[k+8+pe],ze=N[k+0+pe]-N[k+12+pe];je[0+pe]=Ce+Ee,je[8+pe]=Ce-Ee,je[4+pe]=ze+Oe,je[12+pe]=ze-Oe}for(pe=0;4>pe;++pe)Ce=(N=je[0+4*pe]+3)+je[3+4*pe],Ee=je[1+4*pe]+je[2+4*pe],Oe=je[1+4*pe]-je[2+4*pe],ze=N-je[3+4*pe],B[Q+0]=Ce+Ee>>3,B[Q+16]=ze+Oe>>3,B[Q+32]=Ce-Ee>>3,B[Q+48]=ze-Oe>>3,Q+=64}function Bt(N,k,B){var Q,pe=k-32,je=er,Ce=255-N[pe-1];for(Q=0;Q<B;++Q){var Ee,Oe=je,ze=Ce+N[k-1];for(Ee=0;Ee<B;++Ee)N[k+Ee]=Oe[ze+N[pe+Ee]];k+=32}}function $e(N,k){Bt(N,k,4)}function Dt(N,k){Bt(N,k,8)}function Sr(N,k){Bt(N,k,16)}function Pr(N,k){var B;for(B=0;16>B;++B)n(N,k+32*B,N,k-32,16)}function vr(N,k){var B;for(B=16;0<B;--B)s(N,k,N[k-1],16),k+=32}function yn(N,k,B){var Q;for(Q=0;16>Q;++Q)s(k,B+32*Q,N,16)}function On(N,k){var B,Q=16;for(B=0;16>B;++B)Q+=N[k-1+32*B]+N[k+B-32];yn(Q>>5,N,k)}function Xn(N,k){var B,Q=8;for(B=0;16>B;++B)Q+=N[k-1+32*B];yn(Q>>4,N,k)}function kn(N,k){var B,Q=8;for(B=0;16>B;++B)Q+=N[k+B-32];yn(Q>>4,N,k)}function cn(N,k){yn(128,N,k)}function Hr(N,k,B){return N+2*k+B+2>>2}function va(N,k){var B,Q=k-32;for(Q=new Uint8Array([Hr(N[Q-1],N[Q+0],N[Q+1]),Hr(N[Q+0],N[Q+1],N[Q+2]),Hr(N[Q+1],N[Q+2],N[Q+3]),Hr(N[Q+2],N[Q+3],N[Q+4])]),B=0;4>B;++B)n(N,k+32*B,Q,0,Q.length)}function Ma(N,k){var B=N[k-1],Q=N[k-1+32],pe=N[k-1+64],je=N[k-1+96];te(N,k+0,16843009*Hr(N[k-1-32],B,Q)),te(N,k+32,16843009*Hr(B,Q,pe)),te(N,k+64,16843009*Hr(Q,pe,je)),te(N,k+96,16843009*Hr(pe,je,je))}function xa(N,k){var B,Q=4;for(B=0;4>B;++B)Q+=N[k+B-32]+N[k-1+32*B];for(Q>>=3,B=0;4>B;++B)s(N,k+32*B,Q,4)}function $a(N,k){var B=N[k-1+0],Q=N[k-1+32],pe=N[k-1+64],je=N[k-1-32],Ce=N[k+0-32],Ee=N[k+1-32],Oe=N[k+2-32],ze=N[k+3-32];N[k+0+96]=Hr(Q,pe,N[k-1+96]),N[k+1+96]=N[k+0+64]=Hr(B,Q,pe),N[k+2+96]=N[k+1+64]=N[k+0+32]=Hr(je,B,Q),N[k+3+96]=N[k+2+64]=N[k+1+32]=N[k+0+0]=Hr(Ce,je,B),N[k+3+64]=N[k+2+32]=N[k+1+0]=Hr(Ee,Ce,je),N[k+3+32]=N[k+2+0]=Hr(Oe,Ee,Ce),N[k+3+0]=Hr(ze,Oe,Ee)}function oo(N,k){var B=N[k+1-32],Q=N[k+2-32],pe=N[k+3-32],je=N[k+4-32],Ce=N[k+5-32],Ee=N[k+6-32],Oe=N[k+7-32];N[k+0+0]=Hr(N[k+0-32],B,Q),N[k+1+0]=N[k+0+32]=Hr(B,Q,pe),N[k+2+0]=N[k+1+32]=N[k+0+64]=Hr(Q,pe,je),N[k+3+0]=N[k+2+32]=N[k+1+64]=N[k+0+96]=Hr(pe,je,Ce),N[k+3+32]=N[k+2+64]=N[k+1+96]=Hr(je,Ce,Ee),N[k+3+64]=N[k+2+96]=Hr(Ce,Ee,Oe),N[k+3+96]=Hr(Ee,Oe,Oe)}function ss(N,k){var B=N[k-1+0],Q=N[k-1+32],pe=N[k-1+64],je=N[k-1-32],Ce=N[k+0-32],Ee=N[k+1-32],Oe=N[k+2-32],ze=N[k+3-32];N[k+0+0]=N[k+1+64]=je+Ce+1>>1,N[k+1+0]=N[k+2+64]=Ce+Ee+1>>1,N[k+2+0]=N[k+3+64]=Ee+Oe+1>>1,N[k+3+0]=Oe+ze+1>>1,N[k+0+96]=Hr(pe,Q,B),N[k+0+64]=Hr(Q,B,je),N[k+0+32]=N[k+1+96]=Hr(B,je,Ce),N[k+1+32]=N[k+2+96]=Hr(je,Ce,Ee),N[k+2+32]=N[k+3+96]=Hr(Ce,Ee,Oe),N[k+3+32]=Hr(Ee,Oe,ze)}function xs(N,k){var B=N[k+0-32],Q=N[k+1-32],pe=N[k+2-32],je=N[k+3-32],Ce=N[k+4-32],Ee=N[k+5-32],Oe=N[k+6-32],ze=N[k+7-32];N[k+0+0]=B+Q+1>>1,N[k+1+0]=N[k+0+64]=Q+pe+1>>1,N[k+2+0]=N[k+1+64]=pe+je+1>>1,N[k+3+0]=N[k+2+64]=je+Ce+1>>1,N[k+0+32]=Hr(B,Q,pe),N[k+1+32]=N[k+0+96]=Hr(Q,pe,je),N[k+2+32]=N[k+1+96]=Hr(pe,je,Ce),N[k+3+32]=N[k+2+96]=Hr(je,Ce,Ee),N[k+3+64]=Hr(Ce,Ee,Oe),N[k+3+96]=Hr(Ee,Oe,ze)}function So(N,k){var B=N[k-1+0],Q=N[k-1+32],pe=N[k-1+64],je=N[k-1+96];N[k+0+0]=B+Q+1>>1,N[k+2+0]=N[k+0+32]=Q+pe+1>>1,N[k+2+32]=N[k+0+64]=pe+je+1>>1,N[k+1+0]=Hr(B,Q,pe),N[k+3+0]=N[k+1+32]=Hr(Q,pe,je),N[k+3+32]=N[k+1+64]=Hr(pe,je,je),N[k+3+64]=N[k+2+64]=N[k+0+96]=N[k+1+96]=N[k+2+96]=N[k+3+96]=je}function vi(N,k){var B=N[k-1+0],Q=N[k-1+32],pe=N[k-1+64],je=N[k-1+96],Ce=N[k-1-32],Ee=N[k+0-32],Oe=N[k+1-32],ze=N[k+2-32];N[k+0+0]=N[k+2+32]=B+Ce+1>>1,N[k+0+32]=N[k+2+64]=Q+B+1>>1,N[k+0+64]=N[k+2+96]=pe+Q+1>>1,N[k+0+96]=je+pe+1>>1,N[k+3+0]=Hr(Ee,Oe,ze),N[k+2+0]=Hr(Ce,Ee,Oe),N[k+1+0]=N[k+3+32]=Hr(B,Ce,Ee),N[k+1+32]=N[k+3+64]=Hr(Q,B,Ce),N[k+1+64]=N[k+3+96]=Hr(pe,Q,B),N[k+1+96]=Hr(je,pe,Q)}function Od(N,k){var B;for(B=0;8>B;++B)n(N,k+32*B,N,k-32,8)}function xi(N,k){var B;for(B=0;8>B;++B)s(N,k,N[k-1],8),k+=32}function Uc(N,k,B){var Q;for(Q=0;8>Q;++Q)s(k,B+32*Q,N,8)}function Li(N,k){var B,Q=8;for(B=0;8>B;++B)Q+=N[k+B-32]+N[k-1+32*B];Uc(Q>>4,N,k)}function El(N,k){var B,Q=4;for(B=0;8>B;++B)Q+=N[k+B-32];Uc(Q>>3,N,k)}function af(N,k){var B,Q=4;for(B=0;8>B;++B)Q+=N[k-1+32*B];Uc(Q>>3,N,k)}function nc(N,k){Uc(128,N,k)}function Ms(N,k,B){var Q=N[k-B],pe=N[k+0],je=3*(pe-Q)+Mr[1020+N[k-2*B]-N[k+B]],Ce=Wt[112+(je+4>>3)];N[k-B]=er[255+Q+Wt[112+(je+3>>3)]],N[k+0]=er[255+pe-Ce]}function ys(N,k,B,Q){var pe=N[k+0],je=N[k+B];return hn[255+N[k-2*B]-N[k-B]]>Q||hn[255+je-pe]>Q}function sf(N,k,B,Q){return 4*hn[255+N[k-B]-N[k+0]]+hn[255+N[k-2*B]-N[k+B]]<=Q}function bu(N,k,B,Q,pe){var je=N[k-3*B],Ce=N[k-2*B],Ee=N[k-B],Oe=N[k+0],ze=N[k+B],_t=N[k+2*B],Zt=N[k+3*B];return 4*hn[255+Ee-Oe]+hn[255+Ce-ze]>Q?0:hn[255+N[k-4*B]-je]<=pe&&hn[255+je-Ce]<=pe&&hn[255+Ce-Ee]<=pe&&hn[255+Zt-_t]<=pe&&hn[255+_t-ze]<=pe&&hn[255+ze-Oe]<=pe}function Fo(N,k,B,Q){var pe=2*Q+1;for(Q=0;16>Q;++Q)sf(N,k+Q,B,pe)&&Ms(N,k+Q,B)}function yi(N,k,B,Q){var pe=2*Q+1;for(Q=0;16>Q;++Q)sf(N,k+Q*B,1,pe)&&Ms(N,k+Q*B,1)}function of(N,k,B,Q){var pe;for(pe=3;0<pe;--pe)Fo(N,k+=4*B,B,Q)}function nl(N,k,B,Q){var pe;for(pe=3;0<pe;--pe)yi(N,k+=4,B,Q)}function Ie(N,k,B,Q,pe,je,Ce,Ee){for(je=2*je+1;0<pe--;){if(bu(N,k,B,je,Ce))if(ys(N,k,B,Ee))Ms(N,k,B);else{var Oe=N,ze=k,_t=B,Zt=Oe[ze-2*_t],Ue=Oe[ze-_t],Et=Oe[ze+0],zt=Oe[ze+_t],Ar=Oe[ze+2*_t],Jt=27*(Tr=Mr[1020+3*(Et-Ue)+Mr[1020+Zt-zt]])+63>>7,Ir=18*Tr+63>>7,Tr=9*Tr+63>>7;Oe[ze-3*_t]=er[255+Oe[ze-3*_t]+Tr],Oe[ze-2*_t]=er[255+Zt+Ir],Oe[ze-_t]=er[255+Ue+Jt],Oe[ze+0]=er[255+Et-Jt],Oe[ze+_t]=er[255+zt-Ir],Oe[ze+2*_t]=er[255+Ar-Tr]}k+=Q}}function Xe(N,k,B,Q,pe,je,Ce,Ee){for(je=2*je+1;0<pe--;){if(bu(N,k,B,je,Ce))if(ys(N,k,B,Ee))Ms(N,k,B);else{var Oe=N,ze=k,_t=B,Zt=Oe[ze-_t],Ue=Oe[ze+0],Et=Oe[ze+_t],zt=Wt[112+(4+(Ar=3*(Ue-Zt))>>3)],Ar=Wt[112+(Ar+3>>3)],Jt=zt+1>>1;Oe[ze-2*_t]=er[255+Oe[ze-2*_t]+Jt],Oe[ze-_t]=er[255+Zt+Ar],Oe[ze+0]=er[255+Ue-zt],Oe[ze+_t]=er[255+Et-Jt]}k+=Q}}function rr(N,k,B,Q,pe,je){Ie(N,k,B,1,16,Q,pe,je)}function Gt(N,k,B,Q,pe,je){Ie(N,k,1,B,16,Q,pe,je)}function Vt(N,k,B,Q,pe,je){var Ce;for(Ce=3;0<Ce;--Ce)Xe(N,k+=4*B,B,1,16,Q,pe,je)}function Mt(N,k,B,Q,pe,je){var Ce;for(Ce=3;0<Ce;--Ce)Xe(N,k+=4,1,B,16,Q,pe,je)}function S(N,k,B,Q,pe,je,Ce,Ee){Ie(N,k,pe,1,8,je,Ce,Ee),Ie(B,Q,pe,1,8,je,Ce,Ee)}function G(N,k,B,Q,pe,je,Ce,Ee){Ie(N,k,1,pe,8,je,Ce,Ee),Ie(B,Q,1,pe,8,je,Ce,Ee)}function se(N,k,B,Q,pe,je,Ce,Ee){Xe(N,k+4*pe,pe,1,8,je,Ce,Ee),Xe(B,Q+4*pe,pe,1,8,je,Ce,Ee)}function Ae(N,k,B,Q,pe,je,Ce,Ee){Xe(N,k+4,1,pe,8,je,Ce,Ee),Xe(B,Q+4,1,pe,8,je,Ce,Ee)}function V(){this.ba=new yr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Rr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function oe(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Pe(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function qe(){this.ua=0,this.Wa=new Nt,this.vb=new Nt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new U,this.yc=new R}function He(){this.xb=this.a=0,this.l=new St,this.ca=new yr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new q,this.Pb=0,this.wd=new q,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new qe,this.ab=0,this.gc=i(4,Pe),this.Oc=0}function Rt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new St,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ut(N,k,B,Q,pe,je,Ce){for(N=N==null?0:N[k+0],k=0;k<Ce;++k)pe[je+k]=N+B[Q+k]&255,N=pe[je+k]}function qt(N,k,B,Q,pe,je,Ce){var Ee;if(N==null)ut(null,null,B,Q,pe,je,Ce);else for(Ee=0;Ee<Ce;++Ee)pe[je+Ee]=N[k+Ee]+B[Q+Ee]&255}function Kt(N,k,B,Q,pe,je,Ce){if(N==null)ut(null,null,B,Q,pe,je,Ce);else{var Ee,Oe=N[k+0],ze=Oe,_t=Oe;for(Ee=0;Ee<Ce;++Ee)ze=_t+(Oe=N[k+Ee])-ze,_t=B[Q+Ee]+(-256&ze?0>ze?0:255:ze)&255,ze=Oe,pe[je+Ee]=_t}}function At(N,k,B,Q){var pe=k.width,je=k.o;if(t(N!=null&&k!=null),0>B||0>=Q||B+Q>je)return null;if(!N.Cc){if(N.ga==null){var Ce;if(N.ga=new Rt,(Ce=N.ga==null)||(Ce=k.width*k.o,t(N.Gb.length==0),N.Gb=o(Ce),N.Uc=0,N.Gb==null?Ce=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,Ce=1),Ce=!Ce),!Ce){Ce=N.ga;var Ee=N.Fa,Oe=N.P,ze=N.qc,_t=N.mb,Zt=N.nb,Ue=Oe+1,Et=ze-1,zt=Ce.l;if(t(Ee!=null&&_t!=null&&k!=null),dm[0]=null,dm[1]=ut,dm[2]=qt,dm[3]=Kt,Ce.ca=_t,Ce.tb=Zt,Ce.c=k.width,Ce.i=k.height,t(0<Ce.c&&0<Ce.i),1>=ze)k=0;else if(Ce.$a=3&Ee[Oe+0],Ce.Z=Ee[Oe+0]>>2&3,Ce.Lc=Ee[Oe+0]>>4&3,Oe=Ee[Oe+0]>>6&3,0>Ce.$a||1<Ce.$a||4<=Ce.Z||1<Ce.Lc||Oe)k=0;else if(zt.put=Re,zt.ac=Ge,zt.bc=bt,zt.ma=Ce,zt.width=k.width,zt.height=k.height,zt.Da=k.Da,zt.v=k.v,zt.va=k.va,zt.j=k.j,zt.o=k.o,Ce.$a)e:{t(Ce.$a==1),k=fn();t:for(;;){if(k==null){k=0;break e}if(t(Ce!=null),Ce.mc=k,k.c=Ce.c,k.i=Ce.i,k.l=Ce.l,k.l.ma=Ce,k.l.width=Ce.c,k.l.height=Ce.i,k.a=0,ee(k.m,Ee,Ue,Et),!Tn(Ce.c,Ce.i,1,k,null)||(k.ab==1&&k.gc[0].hc==3&&mr(k.s)?(Ce.ic=1,Ee=k.c*k.i,k.Ta=null,k.Ua=0,k.V=o(Ee),k.Ba=0,k.V==null?(k.a=1,k=0):k=1):(Ce.ic=0,k=mn(k,Ce.c)),!k))break t;k=1;break e}Ce.mc=null,k=0}else k=Et>=Ce.c*Ce.i;Ce=!k}if(Ce)return null;N.ga.Lc!=1?N.Ga=0:Q=je-B}t(N.ga!=null),t(B+Q<=je);e:{if(k=(Ee=N.ga).c,je=Ee.l.o,Ee.$a==0){if(Ue=N.rc,Et=N.Vc,zt=N.Fa,Oe=N.P+1+B*k,ze=N.mb,_t=N.nb+B*k,t(Oe<=N.P+N.qc),Ee.Z!=0)for(t(dm[Ee.Z]!=null),Ce=0;Ce<Q;++Ce)dm[Ee.Z](Ue,Et,zt,Oe,ze,_t,k),Ue=ze,Et=_t,_t+=k,Oe+=k;else for(Ce=0;Ce<Q;++Ce)n(ze,_t,zt,Oe,k),Ue=ze,Et=_t,_t+=k,Oe+=k;N.rc=Ue,N.Vc=Et}else{if(t(Ee.mc!=null),k=B+Q,t((Ce=Ee.mc)!=null),t(k<=Ce.i),Ce.C>=k)k=1;else if(Ee.ic||Cr(),Ee.ic){Ee=Ce.V,Ue=Ce.Ba,Et=Ce.c;var Ar=Ce.i,Jt=(zt=1,Oe=Ce.$/Et,ze=Ce.$%Et,_t=Ce.m,Zt=Ce.s,Ce.$),Ir=Et*Ar,Tr=Et*k,Kr=Zt.wc,qr=Jt<Tr?be(Zt,ze,Oe):null;t(Jt<=Ir),t(k<=Ar),t(mr(Zt));t:for(;;){for(;!_t.h&&Jt<Tr;){if(ze&Kr||(qr=be(Zt,ze,Oe)),t(qr!=null),Z(_t),256>(Ar=it(qr.G[0],qr.H[0],_t)))Ee[Ue+Jt]=Ar,++Jt,++ze>=Et&&(ze=0,++Oe<=k&&!(Oe%16)&&Or(Ce,Oe));else{if(!(280>Ar)){zt=0;break t}Ar=ct(Ar-256,_t);var Gn,Ln=it(qr.G[4],qr.H[4],_t);if(Z(_t),!(Jt>=(Ln=xt(Et,Ln=ct(Ln,_t)))&&Ir-Jt>=Ar)){zt=0;break t}for(Gn=0;Gn<Ar;++Gn)Ee[Ue+Jt+Gn]=Ee[Ue+Jt+Gn-Ln];for(Jt+=Ar,ze+=Ar;ze>=Et;)ze-=Et,++Oe<=k&&!(Oe%16)&&Or(Ce,Oe);Jt<Tr&&ze&Kr&&(qr=be(Zt,ze,Oe))}t(_t.h==J(_t))}Or(Ce,Oe>k?k:Oe);break t}!zt||_t.h&&Jt<Ir?(zt=0,Ce.a=_t.h?5:3):Ce.$=Jt,k=zt}else k=Lr(Ce,Ce.V,Ce.Ba,Ce.c,Ce.i,k,zn);if(!k){Q=0;break e}}B+Q>=je&&(N.Cc=1),Q=1}if(!Q)return null;if(N.Cc&&((Q=N.ga)!=null&&(Q.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+B*pe}function kr(N,k,B,Q,pe,je){for(;0<pe--;){var Ce,Ee=N,Oe=k+(B?1:0),ze=N,_t=k+(B?0:3);for(Ce=0;Ce<Q;++Ce){var Zt=ze[_t+4*Ce];Zt!=255&&(Zt*=32897,Ee[Oe+4*Ce+0]=Ee[Oe+4*Ce+0]*Zt>>23,Ee[Oe+4*Ce+1]=Ee[Oe+4*Ce+1]*Zt>>23,Ee[Oe+4*Ce+2]=Ee[Oe+4*Ce+2]*Zt>>23)}k+=je}}function _r(N,k,B,Q,pe){for(;0<Q--;){var je;for(je=0;je<B;++je){var Ce=N[k+2*je+0],Ee=15&(ze=N[k+2*je+1]),Oe=4369*Ee,ze=(240&ze|ze>>4)*Oe>>16;N[k+2*je+0]=(240&Ce|Ce>>4)*Oe>>16&240|(15&Ce|Ce<<4)*Oe>>16>>4&15,N[k+2*je+1]=240&ze|Ee}k+=pe}}function nr(N,k,B,Q,pe,je,Ce,Ee){var Oe,ze,_t=255;for(ze=0;ze<pe;++ze){for(Oe=0;Oe<Q;++Oe){var Zt=N[k+Oe];je[Ce+4*Oe]=Zt,_t&=Zt}k+=B,Ce+=Ee}return _t!=255}function Wr(N,k,B,Q,pe){var je;for(je=0;je<pe;++je)B[Q+je]=N[k+je]>>8}function Cr(){im=kr,$0=_r,Rg=nr,lm=Wr}function Yr(N,k,B){A[N]=function(Q,pe,je,Ce,Ee,Oe,ze,_t,Zt,Ue,Et,zt,Ar,Jt,Ir,Tr,Kr){var qr,Gn=Kr-1>>1,Ln=Ee[Oe+0]|ze[_t+0]<<16,Na=Zt[Ue+0]|Et[zt+0]<<16;t(Q!=null);var Un=3*Ln+Na+131074>>2;for(k(Q[pe+0],255&Un,Un>>16,Ar,Jt),je!=null&&(Un=3*Na+Ln+131074>>2,k(je[Ce+0],255&Un,Un>>16,Ir,Tr)),qr=1;qr<=Gn;++qr){var Ba=Ee[Oe+qr]|ze[_t+qr]<<16,$o=Zt[Ue+qr]|Et[zt+qr]<<16,Sa=Ln+Ba+Na+$o+524296,Vn=Sa+2*(Ba+Na)>>3;Un=Vn+Ln>>1,Ln=(Sa=Sa+2*(Ln+$o)>>3)+Ba>>1,k(Q[pe+2*qr-1],255&Un,Un>>16,Ar,Jt+(2*qr-1)*B),k(Q[pe+2*qr-0],255&Ln,Ln>>16,Ar,Jt+(2*qr-0)*B),je!=null&&(Un=Sa+Na>>1,Ln=Vn+$o>>1,k(je[Ce+2*qr-1],255&Un,Un>>16,Ir,Tr+(2*qr-1)*B),k(je[Ce+2*qr+0],255&Ln,Ln>>16,Ir,Tr+(2*qr+0)*B)),Ln=Ba,Na=$o}1&Kr||(Un=3*Ln+Na+131074>>2,k(Q[pe+Kr-1],255&Un,Un>>16,Ar,Jt+(Kr-1)*B),je!=null&&(Un=3*Na+Ln+131074>>2,k(je[Ce+Kr-1],255&Un,Un>>16,Ir,Tr+(Kr-1)*B)))}}function br(){Gc[In]=Roe,Gc[_n]=VR,Gc[nn]=Loe,Gc[oa]=WR,Gc[ya]=HR,Gc[Pa]=GR,Gc[Js]=Foe,Gc[pa]=VR,Gc[Ea]=WR,Gc[Fi]=HR,Gc[es]=GR}function ir(N){return N&~$oe?0>N?0:255:N>>KR}function ht(N,k){return ir((19077*N>>8)+(26149*k>>8)-14234)}function Qr(N,k,B){return ir((19077*N>>8)-(6419*k>>8)-(13320*B>>8)+8708)}function ln(N,k){return ir((19077*N>>8)+(33050*k>>8)-17685)}function Ia(N,k,B,Q,pe){Q[pe+0]=ht(N,B),Q[pe+1]=Qr(N,k,B),Q[pe+2]=ln(N,k)}function Ca(N,k,B,Q,pe){Q[pe+0]=ln(N,k),Q[pe+1]=Qr(N,k,B),Q[pe+2]=ht(N,B)}function dr(N,k,B,Q,pe){var je=Qr(N,k,B);k=je<<3&224|ln(N,k)>>3,Q[pe+0]=248&ht(N,B)|je>>5,Q[pe+1]=k}function wr(N,k,B,Q,pe){var je=240&ln(N,k)|15;Q[pe+0]=240&ht(N,B)|Qr(N,k,B)>>4,Q[pe+1]=je}function Br(N,k,B,Q,pe){Q[pe+0]=255,Ia(N,k,B,Q,pe+1)}function Gr(N,k,B,Q,pe){Ca(N,k,B,Q,pe),Q[pe+3]=255}function dn(N,k,B,Q,pe){Ia(N,k,B,Q,pe),Q[pe+3]=255}function sn(N,k){return 0>N?0:N>k?k:N}function or(N,k,B){A[N]=function(Q,pe,je,Ce,Ee,Oe,ze,_t,Zt){for(var Ue=_t+(-2&Zt)*B;_t!=Ue;)k(Q[pe+0],je[Ce+0],Ee[Oe+0],ze,_t),k(Q[pe+1],je[Ce+0],Ee[Oe+0],ze,_t+B),pe+=2,++Ce,++Oe,_t+=2*B;1&Zt&&k(Q[pe+0],je[Ce+0],Ee[Oe+0],ze,_t)}}function rn(N,k,B){return B==0?N==0?k==0?6:5:k==0?4:0:B}function hr(N,k,B,Q,pe){switch(N>>>30){case 3:Il(k,B,Q,pe,0);break;case 2:Ol(k,B,Q,pe);break;case 1:Ua(k,B,Q,pe)}}function xr(N,k){var B,Q,pe=k.M,je=k.Nb,Ce=N.oc,Ee=N.pc+40,Oe=N.oc,ze=N.pc+584,_t=N.oc,Zt=N.pc+600;for(B=0;16>B;++B)Ce[Ee+32*B-1]=129;for(B=0;8>B;++B)Oe[ze+32*B-1]=129,_t[Zt+32*B-1]=129;for(0<pe?Ce[Ee-1-32]=Oe[ze-1-32]=_t[Zt-1-32]=129:(s(Ce,Ee-32-1,127,21),s(Oe,ze-32-1,127,9),s(_t,Zt-32-1,127,9)),Q=0;Q<N.za;++Q){var Ue=k.ya[k.aa+Q];if(0<Q){for(B=-1;16>B;++B)n(Ce,Ee+32*B-4,Ce,Ee+32*B+12,4);for(B=-1;8>B;++B)n(Oe,ze+32*B-4,Oe,ze+32*B+4,4),n(_t,Zt+32*B-4,_t,Zt+32*B+4,4)}var Et=N.Gd,zt=N.Hd+Q,Ar=Ue.ad,Jt=Ue.Hc;if(0<pe&&(n(Ce,Ee-32,Et[zt].y,0,16),n(Oe,ze-32,Et[zt].f,0,8),n(_t,Zt-32,Et[zt].ea,0,8)),Ue.Za){var Ir=Ce,Tr=Ee-32+16;for(0<pe&&(Q>=N.za-1?s(Ir,Tr,Et[zt].y[15],4):n(Ir,Tr,Et[zt+1].y,0,4)),B=0;4>B;B++)Ir[Tr+128+B]=Ir[Tr+256+B]=Ir[Tr+384+B]=Ir[Tr+0+B];for(B=0;16>B;++B,Jt<<=2)Ir=Ce,Tr=Ee+YR[B],Rd[Ue.Ob[B]](Ir,Tr),hr(Jt,Ar,16*+B,Ir,Tr)}else if(Ir=rn(Q,pe,Ue.Ob[0]),cm[Ir](Ce,Ee),Jt!=0)for(B=0;16>B;++B,Jt<<=2)hr(Jt,Ar,16*+B,Ce,Ee+YR[B]);for(B=Ue.Gc,Ir=rn(Q,pe,Ue.Dd),cf[Ir](Oe,ze),cf[Ir](_t,Zt),Jt=Ar,Ir=Oe,Tr=ze,255&(Ue=0|B)&&(170&Ue?sc(Jt,256,Ir,Tr):Za(Jt,256,Ir,Tr)),Ue=_t,Jt=Zt,255&(B>>=8)&&(170&B?sc(Ar,320,Ue,Jt):Za(Ar,320,Ue,Jt)),pe<N.Ub-1&&(n(Et[zt].y,0,Ce,Ee+480,16),n(Et[zt].f,0,Oe,ze+224,8),n(Et[zt].ea,0,_t,Zt+224,8)),B=8*je*N.B,Et=N.sa,zt=N.ta+16*Q+16*je*N.R,Ar=N.qa,Ue=N.ra+8*Q+B,Jt=N.Ha,Ir=N.Ia+8*Q+B,B=0;16>B;++B)n(Et,zt+B*N.R,Ce,Ee+32*B,16);for(B=0;8>B;++B)n(Ar,Ue+B*N.B,Oe,ze+32*B,8),n(Jt,Ir+B*N.B,_t,Zt+32*B,8)}}function Ur(N,k,B,Q,pe,je,Ce,Ee,Oe){var ze=[0],_t=[0],Zt=0,Ue=Oe!=null?Oe.kd:0,Et=Oe??new oe;if(N==null||12>B)return 7;Et.data=N,Et.w=k,Et.ha=B,k=[k],B=[B],Et.gb=[Et.gb];e:{var zt=k,Ar=B,Jt=Et.gb;if(t(N!=null),t(Ar!=null),t(Jt!=null),Jt[0]=0,12<=Ar[0]&&!r(N,zt[0],"RIFF")){if(r(N,zt[0]+8,"WEBP")){Jt=3;break e}var Ir=ne(N,zt[0]+4);if(12>Ir||4294967286<Ir){Jt=3;break e}if(Ue&&Ir>Ar[0]-8){Jt=7;break e}Jt[0]=Ir,zt[0]+=12,Ar[0]-=12}Jt=0}if(Jt!=0)return Jt;for(Ir=0<Et.gb[0],B=B[0];;){e:{var Tr=N;Ar=k,Jt=B;var Kr=ze,qr=_t,Gn=zt=[0];if((Un=Zt=[Zt])[0]=0,8>Jt[0])Jt=7;else{if(!r(Tr,Ar[0],"VP8X")){if(ne(Tr,Ar[0]+4)!=10){Jt=3;break e}if(18>Jt[0]){Jt=7;break e}var Ln=ne(Tr,Ar[0]+8),Na=1+Te(Tr,Ar[0]+12);if(2147483648<=Na*(Tr=1+Te(Tr,Ar[0]+15))){Jt=3;break e}Gn!=null&&(Gn[0]=Ln),Kr!=null&&(Kr[0]=Na),qr!=null&&(qr[0]=Tr),Ar[0]+=18,Jt[0]-=18,Un[0]=1}Jt=0}}if(Zt=Zt[0],zt=zt[0],Jt!=0)return Jt;if(Ar=!!(2&zt),!Ir&&Zt)return 3;if(je!=null&&(je[0]=!!(16&zt)),Ce!=null&&(Ce[0]=Ar),Ee!=null&&(Ee[0]=0),Ce=ze[0],zt=_t[0],Zt&&Ar&&Oe==null){Jt=0;break}if(4>B){Jt=7;break}if(Ir&&Zt||!Ir&&!Zt&&!r(N,k[0],"ALPH")){B=[B],Et.na=[Et.na],Et.P=[Et.P],Et.Sa=[Et.Sa];e:{Ln=N,Jt=k,Ir=B;var Un=Et.gb;Kr=Et.na,qr=Et.P,Gn=Et.Sa,Na=22,t(Ln!=null),t(Ir!=null),Tr=Jt[0];var Ba=Ir[0];for(t(Kr!=null),t(Gn!=null),Kr[0]=null,qr[0]=null,Gn[0]=0;;){if(Jt[0]=Tr,Ir[0]=Ba,8>Ba){Jt=7;break e}var $o=ne(Ln,Tr+4);if(4294967286<$o){Jt=3;break e}var Sa=8+$o+1&-2;if(Na+=Sa,0<Un&&Na>Un){Jt=3;break e}if(!r(Ln,Tr,"VP8 ")||!r(Ln,Tr,"VP8L")){Jt=0;break e}if(Ba[0]<Sa){Jt=7;break e}r(Ln,Tr,"ALPH")||(Kr[0]=Ln,qr[0]=Tr+8,Gn[0]=$o),Tr+=Sa,Ba-=Sa}}if(B=B[0],Et.na=Et.na[0],Et.P=Et.P[0],Et.Sa=Et.Sa[0],Jt!=0)break}B=[B],Et.Ja=[Et.Ja],Et.xa=[Et.xa];e:if(Un=N,Jt=k,Ir=B,Kr=Et.gb[0],qr=Et.Ja,Gn=Et.xa,Ln=Jt[0],Tr=!r(Un,Ln,"VP8 "),Na=!r(Un,Ln,"VP8L"),t(Un!=null),t(Ir!=null),t(qr!=null),t(Gn!=null),8>Ir[0])Jt=7;else{if(Tr||Na){if(Un=ne(Un,Ln+4),12<=Kr&&Un>Kr-12){Jt=3;break e}if(Ue&&Un>Ir[0]-8){Jt=7;break e}qr[0]=Un,Jt[0]+=8,Ir[0]-=8,Gn[0]=Na}else Gn[0]=5<=Ir[0]&&Un[Ln+0]==47&&!(Un[Ln+4]>>5),qr[0]=Ir[0];Jt=0}if(B=B[0],Et.Ja=Et.Ja[0],Et.xa=Et.xa[0],k=k[0],Jt!=0)break;if(4294967286<Et.Ja)return 3;if(Ee==null||Ar||(Ee[0]=Et.xa?2:1),Ce=[Ce],zt=[zt],Et.xa){if(5>B){Jt=7;break}Ee=Ce,Ue=zt,Ar=je,N==null||5>B?N=0:5<=B&&N[k+0]==47&&!(N[k+4]>>5)?(Ir=[0],Un=[0],Kr=[0],ee(qr=new q,N,k,B),Qt(qr,Ir,Un,Kr)?(Ee!=null&&(Ee[0]=Ir[0]),Ue!=null&&(Ue[0]=Un[0]),Ar!=null&&(Ar[0]=Kr[0]),N=1):N=0):N=0}else{if(10>B){Jt=7;break}Ee=zt,N==null||10>B||!ha(N,k+3,B-3)?N=0:(Ue=N[k+0]|N[k+1]<<8|N[k+2]<<16,Ar=16383&(N[k+7]<<8|N[k+6]),N=16383&(N[k+9]<<8|N[k+8]),1&Ue||3<(Ue>>1&7)||!(Ue>>4&1)||Ue>>5>=Et.Ja||!Ar||!N?N=0:(Ce&&(Ce[0]=Ar),Ee&&(Ee[0]=N),N=1))}if(!N||(Ce=Ce[0],zt=zt[0],Zt&&(ze[0]!=Ce||_t[0]!=zt)))return 3;Oe!=null&&(Oe[0]=Et,Oe.offset=k-Oe.w,t(4294967286>k-Oe.w),t(Oe.offset==Oe.ha-B));break}return Jt==0||Jt==7&&Zt&&Oe==null?(je!=null&&(je[0]|=Et.na!=null&&0<Et.na.length),Q!=null&&(Q[0]=Ce),pe!=null&&(pe[0]=zt),0):Jt}function tn(N,k,B){var Q=k.width,pe=k.height,je=0,Ce=0,Ee=Q,Oe=pe;if(k.Da=N!=null&&0<N.Da,k.Da&&(Ee=N.cd,Oe=N.bd,je=N.v,Ce=N.j,11>B||(je&=-2,Ce&=-2),0>je||0>Ce||0>=Ee||0>=Oe||je+Ee>Q||Ce+Oe>pe))return 0;if(k.v=je,k.j=Ce,k.va=je+Ee,k.o=Ce+Oe,k.U=Ee,k.T=Oe,k.da=N!=null&&0<N.da,k.da){if(!at(Ee,Oe,B=[N.ib],je=[N.hb]))return 0;k.ib=B[0],k.hb=je[0]}return k.ob=N!=null&&N.ob,k.Kb=N==null||!N.Sd,k.da&&(k.ob=k.ib<3*Q/4&&k.hb<3*pe/4,k.Kb=0),1}function $r(N){if(N==null)return 2;if(11>N.S){var k=N.f.RGBA;k.fb+=(N.height-1)*k.A,k.A=-k.A}else k=N.f.kb,N=N.height,k.O+=(N-1)*k.fa,k.fa=-k.fa,k.N+=(N-1>>1)*k.Ab,k.Ab=-k.Ab,k.W+=(N-1>>1)*k.Db,k.Db=-k.Db,k.F!=null&&(k.J+=(N-1)*k.lb,k.lb=-k.lb);return 0}function An(N,k,B,Q){if(Q==null||0>=N||0>=k)return 2;if(B!=null){if(B.Da){var pe=B.cd,je=B.bd,Ce=-2&B.v,Ee=-2&B.j;if(0>Ce||0>Ee||0>=pe||0>=je||Ce+pe>N||Ee+je>k)return 2;N=pe,k=je}if(B.da){if(!at(N,k,pe=[B.ib],je=[B.hb]))return 2;N=pe[0],k=je[0]}}Q.width=N,Q.height=k;e:{var Oe=Q.width,ze=Q.height;if(N=Q.S,0>=Oe||0>=ze||!(N>=In&&13>N))N=2;else{if(0>=Q.Rd&&Q.sd==null){Ce=je=pe=k=0;var _t=(Ee=Oe*JR[N])*ze;if(11>N||(je=(ze+1)/2*(k=(Oe+1)/2),N==12&&(Ce=(pe=Oe)*ze)),(ze=o(_t+2*je+Ce))==null){N=1;break e}Q.sd=ze,11>N?((Oe=Q.f.RGBA).eb=ze,Oe.fb=0,Oe.A=Ee,Oe.size=_t):((Oe=Q.f.kb).y=ze,Oe.O=0,Oe.fa=Ee,Oe.Fd=_t,Oe.f=ze,Oe.N=0+_t,Oe.Ab=k,Oe.Cd=je,Oe.ea=ze,Oe.W=0+_t+je,Oe.Db=k,Oe.Ed=je,N==12&&(Oe.F=ze,Oe.J=0+_t+2*je),Oe.Tc=Ce,Oe.lb=pe)}if(k=1,pe=Q.S,je=Q.width,Ce=Q.height,pe>=In&&13>pe)if(11>pe)N=Q.f.RGBA,k&=(Ee=Math.abs(N.A))*(Ce-1)+je<=N.size,k&=Ee>=je*JR[pe],k&=N.eb!=null;else{N=Q.f.kb,Ee=(je+1)/2,_t=(Ce+1)/2,Oe=Math.abs(N.fa),ze=Math.abs(N.Ab);var Zt=Math.abs(N.Db),Ue=Math.abs(N.lb),Et=Ue*(Ce-1)+je;k&=Oe*(Ce-1)+je<=N.Fd,k&=ze*(_t-1)+Ee<=N.Cd,k=(k&=Zt*(_t-1)+Ee<=N.Ed)&Oe>=je&ze>=Ee&Zt>=Ee,k&=N.y!=null,k&=N.f!=null,k&=N.ea!=null,pe==12&&(k&=Ue>=je,k&=Et<=N.Tc,k&=N.F!=null)}else k=0;N=k?0:2}}return N!=0||B!=null&&B.fd&&(N=$r(Q)),N}var $n=64,Jr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Bn=24,Aa=32,Ja=8,hs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];yt("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(N){return N},A.Predictor2=function(N,k,B){return k[B+0]},A.Predictor3=function(N,k,B){return k[B+1]},A.Predictor4=function(N,k,B){return k[B-1]},A.Predictor5=function(N,k,B){return ge(ge(N,k[B+1]),k[B+0])},A.Predictor6=function(N,k,B){return ge(N,k[B-1])},A.Predictor7=function(N,k,B){return ge(N,k[B+0])},A.Predictor8=function(N,k,B){return ge(k[B-1],k[B+0])},A.Predictor9=function(N,k,B){return ge(k[B+0],k[B+1])},A.Predictor10=function(N,k,B){return ge(ge(N,k[B-1]),ge(k[B+0],k[B+1]))},A.Predictor11=function(N,k,B){var Q=k[B+0];return 0>=We(Q>>24&255,N>>24&255,(k=k[B-1])>>24&255)+We(Q>>16&255,N>>16&255,k>>16&255)+We(Q>>8&255,N>>8&255,k>>8&255)+We(255&Q,255&N,255&k)?Q:N},A.Predictor12=function(N,k,B){var Q=k[B+0];return(rt((N>>24&255)+(Q>>24&255)-((k=k[B-1])>>24&255))<<24|rt((N>>16&255)+(Q>>16&255)-(k>>16&255))<<16|rt((N>>8&255)+(Q>>8&255)-(k>>8&255))<<8|rt((255&N)+(255&Q)-(255&k)))>>>0},A.Predictor13=function(N,k,B){var Q=k[B-1];return(pt((N=ge(N,k[B+0]))>>24&255,Q>>24&255)<<24|pt(N>>16&255,Q>>16&255)<<16|pt(N>>8&255,Q>>8&255)<<8|pt(255&N,255&Q))>>>0};var Td=A.PredictorAdd0;A.PredictorAdd1=Ze,yt("Predictor2","PredictorAdd2"),yt("Predictor3","PredictorAdd3"),yt("Predictor4","PredictorAdd4"),yt("Predictor5","PredictorAdd5"),yt("Predictor6","PredictorAdd6"),yt("Predictor7","PredictorAdd7"),yt("Predictor8","PredictorAdd8"),yt("Predictor9","PredictorAdd9"),yt("Predictor10","PredictorAdd10"),yt("Predictor11","PredictorAdd11"),yt("Predictor12","PredictorAdd12"),yt("Predictor13","PredictorAdd13");var Vc=A.PredictorAdd2;mt("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),mt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var ps,lf=A.ColorIndexInverseTransform,kl=A.MapARGB,io=A.VP8LColorIndexInverseTransformAlpha,ei=A.MapAlpha,Kh=A.VP8LPredictorsAdd=[];Kh.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var Wc,Dd,al,bi,Ws,ac,Hc,Il,Ol,sc,Ua,Za,Rs,bs,Ys,ti,Md,Mg,oc,F0,G1,K1,X1,Y1,im,$0,Rg,lm,we=o(511),Ve=o(2041),Ke=o(225),jt=o(767),wt=0,Mr=Ve,Wt=Ke,er=jt,hn=we,In=0,_n=1,nn=2,oa=3,ya=4,Pa=5,Js=6,pa=7,Ea=8,Fi=9,es=10,$i=[2,3,7],ws=[3,3,11],Qs=[280,256,256,256,40],Bi=[0,1,1,1,0],wi=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ka=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ri=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Zs=8,Co=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ji=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Tl=null,Eoe=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],koe=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],zR=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Ioe=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ooe=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Toe=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Doe=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],cm=[],Rd=[],cf=[],Moe=1,UR=2,dm=[],Gc=[];Yr("UpsampleRgbLinePair",Ia,3),Yr("UpsampleBgrLinePair",Ca,3),Yr("UpsampleRgbaLinePair",dn,4),Yr("UpsampleBgraLinePair",Gr,4),Yr("UpsampleArgbLinePair",Br,4),Yr("UpsampleRgba4444LinePair",wr,2),Yr("UpsampleRgb565LinePair",dr,2);var Roe=A.UpsampleRgbLinePair,Loe=A.UpsampleBgrLinePair,VR=A.UpsampleRgbaLinePair,WR=A.UpsampleBgraLinePair,HR=A.UpsampleArgbLinePair,GR=A.UpsampleRgba4444LinePair,Foe=A.UpsampleRgb565LinePair,J1=16,Q1=1<<J1-1,B0=-227,lA=482,KR=6,$oe=(256<<KR)-1,XR=0,Boe=o(256),qoe=o(256),zoe=o(256),Uoe=o(256),Voe=o(lA-B0),Woe=o(lA-B0);or("YuvToRgbRow",Ia,3),or("YuvToBgrRow",Ca,3),or("YuvToRgbaRow",dn,4),or("YuvToBgraRow",Gr,4),or("YuvToArgbRow",Br,4),or("YuvToRgba4444Row",wr,2),or("YuvToRgb565Row",dr,2);var YR=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Z1=[0,2,8],Hoe=[8,7,6,4,4,2,2,2,1,1,1,1],Goe=1;this.WebPDecodeRGBA=function(N,k,B,Q,pe){var je=_n,Ce=new V,Ee=new yr;Ce.ba=Ee,Ee.S=je,Ee.width=[Ee.width],Ee.height=[Ee.height];var Oe=Ee.width,ze=Ee.height,_t=new lr;if(_t==null||N==null)var Zt=2;else t(_t!=null),Zt=Ur(N,k,B,_t.width,_t.height,_t.Pd,_t.Qd,_t.format,null);if(Zt!=0?Oe=0:(Oe!=null&&(Oe[0]=_t.width[0]),ze!=null&&(ze[0]=_t.height[0]),Oe=1),Oe){Ee.width=Ee.width[0],Ee.height=Ee.height[0],Q!=null&&(Q[0]=Ee.width),pe!=null&&(pe[0]=Ee.height);e:{if(Q=new St,(pe=new oe).data=N,pe.w=k,pe.ha=B,pe.kd=1,k=[0],t(pe!=null),((N=Ur(pe.data,pe.w,pe.ha,null,null,null,k,null,pe))==0||N==7)&&k[0]&&(N=4),(k=N)==0){if(t(Ce!=null),Q.data=pe.data,Q.w=pe.w+pe.offset,Q.ha=pe.ha-pe.offset,Q.put=Re,Q.ac=Ge,Q.bc=bt,Q.ma=Ce,pe.xa){if((N=fn())==null){Ce=1;break e}if(function(Ue,Et){var zt=[0],Ar=[0],Jt=[0];t:for(;;){if(Ue==null)return 0;if(Et==null)return Ue.a=2,0;if(Ue.l=Et,Ue.a=0,ee(Ue.m,Et.data,Et.w,Et.ha),!Qt(Ue.m,zt,Ar,Jt)){Ue.a=3;break t}if(Ue.xb=UR,Et.width=zt[0],Et.height=Ar[0],!Tn(zt[0],Ar[0],1,Ue,null))break t;return 1}return t(Ue.a!=0),0}(N,Q)){if(Q=(k=An(Q.width,Q.height,Ce.Oa,Ce.ba))==0){t:{Q=N;r:for(;;){if(Q==null){Q=0;break t}if(t(Q.s.yc!=null),t(Q.s.Ya!=null),t(0<Q.s.Wb),t((B=Q.l)!=null),t((pe=B.ma)!=null),Q.xb!=0){if(Q.ca=pe.ba,Q.tb=pe.tb,t(Q.ca!=null),!tn(pe.Oa,B,oa)){Q.a=2;break r}if(!mn(Q,B.width)||B.da)break r;if((B.da||ar(Q.ca.S))&&Cr(),11>Q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Q.ca.f.kb.F!=null&&Cr()),Q.Pb&&0<Q.s.ua&&Q.s.vb.X==null&&!de(Q.s.vb,Q.s.Wa.Xa)){Q.a=1;break r}Q.xb=0}if(!Lr(Q,Q.V,Q.Ba,Q.c,Q.i,B.o,Lt))break r;pe.Dc=Q.Ma,Q=1;break t}t(Q.a!=0),Q=0}Q=!Q}Q&&(k=N.a)}else k=N.a}else{if((N=new Fr)==null){Ce=1;break e}if(N.Fa=pe.na,N.P=pe.P,N.qc=pe.Sa,En(N,Q)){if((k=An(Q.width,Q.height,Ce.Oa,Ce.ba))==0){if(N.Aa=0,B=Ce.Oa,t((pe=N)!=null),B!=null){if(0<(Oe=0>(Oe=B.Md)?0:100<Oe?255:255*Oe/100)){for(ze=_t=0;4>ze;++ze)12>(Zt=pe.pb[ze]).lc&&(Zt.ia=Oe*Hoe[0>Zt.lc?0:Zt.lc]>>3),_t|=Zt.ia;_t&&(alert("todo:VP8InitRandom"),pe.ia=1)}pe.Ga=B.Id,100<pe.Ga?pe.Ga=100:0>pe.Ga&&(pe.Ga=0)}(function(Ue,Et){if(Ue==null)return 0;if(Et==null)return zr(Ue,2,"NULL VP8Io parameter in VP8Decode().");if(!Ue.cb&&!En(Ue,Et))return 0;if(t(Ue.cb),Et.ac==null||Et.ac(Et)){Et.ob&&(Ue.L=0);var zt=Z1[Ue.L];if(Ue.L==2?(Ue.yb=0,Ue.zb=0):(Ue.yb=Et.v-zt>>4,Ue.zb=Et.j-zt>>4,0>Ue.yb&&(Ue.yb=0),0>Ue.zb&&(Ue.zb=0)),Ue.Va=Et.o+15+zt>>4,Ue.Hb=Et.va+15+zt>>4,Ue.Hb>Ue.za&&(Ue.Hb=Ue.za),Ue.Va>Ue.Ub&&(Ue.Va=Ue.Ub),0<Ue.L){var Ar=Ue.ed;for(zt=0;4>zt;++zt){var Jt;if(Ue.Qa.Cb){var Ir=Ue.Qa.Lb[zt];Ue.Qa.Fb||(Ir+=Ar.Tb)}else Ir=Ar.Tb;for(Jt=0;1>=Jt;++Jt){var Tr=Ue.gd[zt][Jt],Kr=Ir;if(Ar.Pc&&(Kr+=Ar.vd[0],Jt&&(Kr+=Ar.od[0])),0<(Kr=0>Kr?0:63<Kr?63:Kr)){var qr=Kr;0<Ar.wb&&(qr=4<Ar.wb?qr>>2:qr>>1)>9-Ar.wb&&(qr=9-Ar.wb),1>qr&&(qr=1),Tr.dd=qr,Tr.tc=2*Kr+qr,Tr.ld=40<=Kr?2:15<=Kr?1:0}else Tr.tc=0;Tr.La=Jt}}}zt=0}else zr(Ue,6,"Frame setup failed"),zt=Ue.a;if(zt=zt==0){if(zt){Ue.$c=0,0<Ue.Aa||(Ue.Ic=Goe);t:{zt=Ue.Ic,Ar=4*(qr=Ue.za);var Gn=32*qr,Ln=qr+1,Na=0<Ue.L?qr*(0<Ue.Aa?2:1):0,Un=(Ue.Aa==2?2:1)*qr;if((Tr=Ar+832+(Jt=3*(16*zt+Z1[Ue.L])/2*Gn)+(Ir=Ue.Fa!=null&&0<Ue.Fa.length?Ue.Kc.c*Ue.Kc.i:0))!=Tr)zt=0;else{if(Tr>Ue.Vb){if(Ue.Vb=0,Ue.Ec=o(Tr),Ue.Fc=0,Ue.Ec==null){zt=zr(Ue,1,"no memory during frame initialization.");break t}Ue.Vb=Tr}Tr=Ue.Ec,Kr=Ue.Fc,Ue.Ac=Tr,Ue.Bc=Kr,Kr+=Ar,Ue.Gd=i(Gn,an),Ue.Hd=0,Ue.rb=i(Ln+1,cr),Ue.sb=1,Ue.wa=Na?i(Na,Je):null,Ue.Y=0,Ue.D.Nb=0,Ue.D.wa=Ue.wa,Ue.D.Y=Ue.Y,0<Ue.Aa&&(Ue.D.Y+=qr),t(!0),Ue.oc=Tr,Ue.pc=Kr,Kr+=832,Ue.ya=i(Un,Tt),Ue.aa=0,Ue.D.ya=Ue.ya,Ue.D.aa=Ue.aa,Ue.Aa==2&&(Ue.D.aa+=qr),Ue.R=16*qr,Ue.B=8*qr,qr=(Gn=Z1[Ue.L])*Ue.R,Gn=Gn/2*Ue.B,Ue.sa=Tr,Ue.ta=Kr+qr,Ue.qa=Ue.sa,Ue.ra=Ue.ta+16*zt*Ue.R+Gn,Ue.Ha=Ue.qa,Ue.Ia=Ue.ra+8*zt*Ue.B+Gn,Ue.$c=0,Kr+=Jt,Ue.mb=Ir?Tr:null,Ue.nb=Ir?Kr:null,t(Kr+Ir<=Ue.Fc+Ue.Vb),Me(Ue),s(Ue.Ac,Ue.Bc,0,Ar),zt=1}}if(zt){if(Et.ka=0,Et.y=Ue.sa,Et.O=Ue.ta,Et.f=Ue.qa,Et.N=Ue.ra,Et.ea=Ue.Ha,Et.Vd=Ue.Ia,Et.fa=Ue.R,Et.Rc=Ue.B,Et.F=null,Et.J=0,!wt){for(zt=-255;255>=zt;++zt)we[255+zt]=0>zt?-zt:zt;for(zt=-1020;1020>=zt;++zt)Ve[1020+zt]=-128>zt?-128:127<zt?127:zt;for(zt=-112;112>=zt;++zt)Ke[112+zt]=-16>zt?-16:15<zt?15:zt;for(zt=-255;510>=zt;++zt)jt[255+zt]=0>zt?0:255<zt?255:zt;wt=1}Hc=ft,Il=H,sc=L,Ua=Fe,Za=nt,Ol=X,Rs=rr,bs=Gt,Ys=S,ti=G,Md=Vt,Mg=Mt,oc=se,F0=Ae,G1=Fo,K1=yi,X1=of,Y1=nl,Rd[0]=xa,Rd[1]=$e,Rd[2]=va,Rd[3]=Ma,Rd[4]=$a,Rd[5]=ss,Rd[6]=oo,Rd[7]=xs,Rd[8]=vi,Rd[9]=So,cm[0]=On,cm[1]=Sr,cm[2]=Pr,cm[3]=vr,cm[4]=Xn,cm[5]=kn,cm[6]=cn,cf[0]=Li,cf[1]=Dt,cf[2]=Od,cf[3]=xi,cf[4]=af,cf[5]=El,cf[6]=nc,zt=1}else zt=0}zt&&(zt=function(Ba,$o){for(Ba.M=0;Ba.M<Ba.Va;++Ba.M){var Sa,Vn=Ba.Jc[Ba.M&Ba.Xb],gn=Ba.m,xo=Ba;for(Sa=0;Sa<xo.za;++Sa){var ja=gn,Va=xo,Ls=Va.Ac,_i=Va.Bc+4*Sa,sl=Va.zc,lo=Va.ya[Va.aa+Sa];if(Va.Qa.Bb?lo.$b=ie(ja,Va.Pa.jb[0])?2+ie(ja,Va.Pa.jb[2]):ie(ja,Va.Pa.jb[1]):lo.$b=0,Va.kc&&(lo.Ad=ie(ja,Va.Bd)),lo.Za=!ie(ja,145)+0,lo.Za){var qi=lo.Ob,ol=0;for(Va=0;4>Va;++Va){var Bo,Ka=sl[0+Va];for(Bo=0;4>Bo;++Bo){Ka=Ooe[Ls[_i+Bo]][Ka];for(var os=zR[ie(ja,Ka[0])];0<os;)os=zR[2*os+ie(ja,Ka[os])];Ka=-os,Ls[_i+Bo]=Ka}n(qi,ol,Ls,_i,4),ol+=4,sl[0+Va]=Ka}}else Ka=ie(ja,156)?ie(ja,128)?1:3:ie(ja,163)?2:0,lo.Ob[0]=Ka,s(Ls,_i,Ka,4),s(sl,0,Ka,4);lo.Dd=ie(ja,142)?ie(ja,114)?ie(ja,183)?1:3:2:0}if(xo.m.Ka)return zr(Ba,7,"Premature end-of-partition0 encountered.");for(;Ba.ja<Ba.za;++Ba.ja){if(xo=Vn,ja=(gn=Ba).rb[gn.sb-1],Ls=gn.rb[gn.sb+gn.ja],Sa=gn.ya[gn.aa+gn.ja],_i=gn.kc?Sa.Ad:0)ja.la=Ls.la=0,Sa.Za||(ja.Na=Ls.Na=0),Sa.Hc=0,Sa.Gc=0,Sa.ia=0;else{var co,is;if(ja=Ls,Ls=xo,_i=gn.Pa.Xc,sl=gn.ya[gn.aa+gn.ja],lo=gn.pb[sl.$b],Va=sl.ad,qi=0,ol=gn.rb[gn.sb-1],Ka=Bo=0,s(Va,qi,0,384),sl.Za)var Ni=0,Ld=_i[3];else{os=o(16);var yo=ja.Na+ol.Na;if(yo=Tl(Ls,_i[1],yo,lo.Eb,0,os,0),ja.Na=ol.Na=(0<yo)+0,1<yo)Hc(os,0,Va,qi);else{var Dl=os[0]+3>>3;for(os=0;256>os;os+=16)Va[qi+os]=Dl}Ni=1,Ld=_i[0]}var js=15&ja.la,qo=15&ol.la;for(os=0;4>os;++os){var ic=1&qo;for(Dl=is=0;4>Dl;++Dl)js=js>>1|(ic=(yo=Tl(Ls,Ld,yo=ic+(1&js),lo.Sc,Ni,Va,qi))>Ni)<<7,is=is<<2|(3<yo?3:1<yo?2:Va[qi+0]!=0),qi+=16;js>>=4,qo=qo>>1|ic<<7,Bo=(Bo<<8|is)>>>0}for(Ld=js,Ni=qo>>4,co=0;4>co;co+=2){for(is=0,js=ja.la>>4+co,qo=ol.la>>4+co,os=0;2>os;++os){for(ic=1&qo,Dl=0;2>Dl;++Dl)yo=ic+(1&js),js=js>>1|(ic=0<(yo=Tl(Ls,_i[2],yo,lo.Qc,0,Va,qi)))<<3,is=is<<2|(3<yo?3:1<yo?2:Va[qi+0]!=0),qi+=16;js>>=2,qo=qo>>1|ic<<5}Ka|=is<<4*co,Ld|=js<<4<<co,Ni|=(240&qo)<<co}ja.la=Ld,ol.la=Ni,sl.Hc=Bo,sl.Gc=Ka,sl.ia=43690&Ka?0:lo.ia,_i=!(Bo|Ka)}if(0<gn.L&&(gn.wa[gn.Y+gn.ja]=gn.gd[Sa.$b][Sa.Za],gn.wa[gn.Y+gn.ja].La|=!_i),xo.Ka)return zr(Ba,7,"Premature end-of-file encountered.")}if(Me(Ba),gn=$o,xo=1,Sa=(Vn=Ba).D,ja=0<Vn.L&&Vn.M>=Vn.zb&&Vn.M<=Vn.Va,Vn.Aa==0)t:{if(Sa.M=Vn.M,Sa.uc=ja,xr(Vn,Sa),xo=1,Sa=(is=Vn.D).Nb,ja=(Ka=Z1[Vn.L])*Vn.R,Ls=Ka/2*Vn.B,os=16*Sa*Vn.R,Dl=8*Sa*Vn.B,_i=Vn.sa,sl=Vn.ta-ja+os,lo=Vn.qa,Va=Vn.ra-Ls+Dl,qi=Vn.Ha,ol=Vn.Ia-Ls+Dl,qo=(js=is.M)==0,Bo=js>=Vn.Va-1,Vn.Aa==2&&xr(Vn,is),is.uc)for(ic=(yo=Vn).D.M,t(yo.D.uc),is=yo.yb;is<yo.Hb;++is){Ni=is,Ld=ic;var il=(lc=(Si=yo).D).Nb;co=Si.R;var lc=lc.wa[lc.Y+Ni],cc=Si.sa,Ml=Si.ta+16*il*co+16*Ni,dc=lc.dd,Cs=lc.tc;if(Cs!=0)if(t(3<=Cs),Si.L==1)0<Ni&&K1(cc,Ml,co,Cs+4),lc.La&&Y1(cc,Ml,co,Cs),0<Ld&&G1(cc,Ml,co,Cs+4),lc.La&&X1(cc,Ml,co,Cs);else{var uc=Si.B,Fd=Si.qa,Xh=Si.ra+8*il*uc+8*Ni,df=Si.Ha,Si=Si.Ia+8*il*uc+8*Ni;il=lc.ld,0<Ni&&(bs(cc,Ml,co,Cs+4,dc,il),ti(Fd,Xh,df,Si,uc,Cs+4,dc,il)),lc.La&&(Mg(cc,Ml,co,Cs,dc,il),F0(Fd,Xh,df,Si,uc,Cs,dc,il)),0<Ld&&(Rs(cc,Ml,co,Cs+4,dc,il),Ys(Fd,Xh,df,Si,uc,Cs+4,dc,il)),lc.La&&(Md(cc,Ml,co,Cs,dc,il),oc(Fd,Xh,df,Si,uc,Cs,dc,il))}}if(Vn.ia&&alert("todo:DitherRow"),gn.put!=null){if(is=16*js,js=16*(js+1),qo?(gn.y=Vn.sa,gn.O=Vn.ta+os,gn.f=Vn.qa,gn.N=Vn.ra+Dl,gn.ea=Vn.Ha,gn.W=Vn.Ia+Dl):(is-=Ka,gn.y=_i,gn.O=sl,gn.f=lo,gn.N=Va,gn.ea=qi,gn.W=ol),Bo||(js-=Ka),js>gn.o&&(js=gn.o),gn.F=null,gn.J=null,Vn.Fa!=null&&0<Vn.Fa.length&&is<js&&(gn.J=At(Vn,gn,is,js-is),gn.F=Vn.mb,gn.F==null&&gn.F.length==0)){xo=zr(Vn,3,"Could not decode alpha data.");break t}is<gn.j&&(Ka=gn.j-is,is=gn.j,t(!(1&Ka)),gn.O+=Vn.R*Ka,gn.N+=Vn.B*(Ka>>1),gn.W+=Vn.B*(Ka>>1),gn.F!=null&&(gn.J+=gn.width*Ka)),is<js&&(gn.O+=gn.v,gn.N+=gn.v>>1,gn.W+=gn.v>>1,gn.F!=null&&(gn.J+=gn.v),gn.ka=is-gn.j,gn.U=gn.va-gn.v,gn.T=js-is,xo=gn.put(gn))}Sa+1!=Vn.Ic||Bo||(n(Vn.sa,Vn.ta-ja,_i,sl+16*Vn.R,ja),n(Vn.qa,Vn.ra-Ls,lo,Va+8*Vn.B,Ls),n(Vn.Ha,Vn.Ia-Ls,qi,ol+8*Vn.B,Ls))}if(!xo)return zr(Ba,6,"Output aborted.")}return 1}(Ue,Et)),Et.bc!=null&&Et.bc(Et),zt&=1}return zt?(Ue.cb=0,zt):0})(N,Q)||(k=N.a)}}else k=N.a}k==0&&Ce.Oa!=null&&Ce.Oa.fd&&(k=$r(Ce.ba))}Ce=k}je=Ce!=0?null:11>je?Ee.f.RGBA.eb:Ee.f.kb.y}else je=null;return je};var JR=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(A,F){for(var D="",I=0;I<4;I++)D+=String.fromCharCode(A[F++]);return D}function u(A,F){return A[F+0]|A[F+1]<<8}function f(A,F){return(A[F+0]|A[F+1]<<8|A[F+2]<<16)>>>0}function h(A,F){return(A[F+0]|A[F+1]<<8|A[F+2]<<16|A[F+3]<<24)>>>0}new c;var m=[0],v=[0],g=[],y=new c,x=e,b=function(A,F){var D={},I=0,R=!1,M=0,U=0;if(D.frames=[],!function(K,q){for(var Y=0;Y<4;Y++)if(K[q+Y]!="RIFF".charCodeAt(Y))return!0;return!1}(A,F)){for(h(A,F+=4),F+=8;F<A.length;){var z=d(A,F),W=h(A,F+=4);F+=4;var $=W+(1&W);switch(z){case"VP8 ":case"VP8L":D.frames[I]===void 0&&(D.frames[I]={}),(_e=D.frames[I]).src_off=R?U:F-8,_e.src_size=M+W+8,I++,R&&(R=!1,M=0,U=0);break;case"VP8X":(_e=D.header={}).feature_flags=A[F];var ee=F+4;_e.canvas_width=1+f(A,ee),ee+=3,_e.canvas_height=1+f(A,ee),ee+=3;break;case"ALPH":R=!0,M=$+8,U=F-8;break;case"ANIM":(_e=D.header).bgcolor=h(A,F),ee=F+4,_e.loop_count=u(A,ee),ee+=2;break;case"ANMF":var ve,_e;(_e=D.frames[I]={}).offset_x=2*f(A,F),F+=3,_e.offset_y=2*f(A,F),F+=3,_e.width=1+f(A,F),F+=3,_e.height=1+f(A,F),F+=3,_e.duration=f(A,F),F+=3,ve=A[F++],_e.dispose=1&ve,_e.blend=ve>>1&1}z!="ANMF"&&(F+=$)}return D}}(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var w=b.header?b.header:null,j=b.frames?b.frames:null;if(w){w.loop_counter=w.loop_count,m=[w.canvas_height],v=[w.canvas_width];for(var _=0;_<j.length&&j[_].blend!=0;_++);}var C=j[0],P=y.WebPDecodeRGBA(x,C.src_off,C.src_size,v,m);C.rgba=P,C.imgwidth=v[0],C.imgheight=m[0];for(var E=0;E<v[0]*m[0]*4;E++)g[E]=P[E];return this.width=v,this.height=m,this.data=g,this}(function(e){var t,r,n,s,o,i,l,c,d,u=function(K){return K=K||{},this.isStrokeTransparent=K.isStrokeTransparent||!1,this.strokeOpacity=K.strokeOpacity||1,this.strokeStyle=K.strokeStyle||"#000000",this.fillStyle=K.fillStyle||"#000000",this.isFillTransparent=K.isFillTransparent||!1,this.fillOpacity=K.fillOpacity||1,this.font=K.font||"10px sans-serif",this.textBaseline=K.textBaseline||"alphabetic",this.textAlign=K.textAlign||"left",this.lineWidth=K.lineWidth||1,this.lineJoin=K.lineJoin||"miter",this.lineCap=K.lineCap||"butt",this.path=K.path||[],this.transform=K.transform!==void 0?K.transform.clone():new c,this.globalCompositeOperation=K.globalCompositeOperation||"normal",this.globalAlpha=K.globalAlpha||1,this.clip_path=K.clip_path||[],this.currentPoint=K.currentPoint||new i,this.miterLimit=K.miterLimit||10,this.lastPoint=K.lastPoint||new i,this.lineDashOffset=K.lineDashOffset||0,this.lineDash=K.lineDash||[],this.margin=K.margin||[0,0,0,0],this.prevPageLastElemOffset=K.prevPageLastElemOffset||0,this.ignoreClearRect=typeof K.ignoreClearRect!="boolean"||K.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,i=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var f=function(K){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var q=K;Object.defineProperty(this,"pdf",{get:function(){return q}});var Y=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Y},set:function(ne){Y=!!ne}});var J=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return J},set:function(ne){J=!!ne}});var fe=0;Object.defineProperty(this,"posX",{get:function(){return fe},set:function(ne){isNaN(ne)||(fe=ne)}});var Z=0;Object.defineProperty(this,"posY",{get:function(){return Z},set:function(ne){isNaN(ne)||(Z=ne)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(ne){var de;typeof ne=="number"?de=[ne,ne,ne,ne]:((de=new Array(4))[0]=ne[0],de[1]=ne.length>=2?ne[1]:de[0],de[2]=ne.length>=3?ne[2]:de[0],de[3]=ne.length>=4?ne[3]:de[1]),d.margin=de}});var ce=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ce},set:function(ne){ce=ne}});var le=0;Object.defineProperty(this,"lastBreak",{get:function(){return le},set:function(ne){le=ne}});var ie=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ie},set:function(ne){ie=ne}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(ne){ne instanceof u&&(d=ne)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(ne){d.path=ne}});var te=[];Object.defineProperty(this,"ctxStack",{get:function(){return te},set:function(ne){te=ne}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ne){var de;de=h(ne),this.ctx.fillStyle=de.style,this.ctx.isFillTransparent=de.a===0,this.ctx.fillOpacity=de.a,this.pdf.setFillColor(de.r,de.g,de.b,{a:de.a}),this.pdf.setTextColor(de.r,de.g,de.b,{a:de.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ne){var de=h(ne);this.ctx.strokeStyle=de.style,this.ctx.isStrokeTransparent=de.a===0,this.ctx.strokeOpacity=de.a,de.a===0?this.pdf.setDrawColor(255,255,255):(de.a,this.pdf.setDrawColor(de.r,de.g,de.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ne){["butt","round","square"].indexOf(ne)!==-1&&(this.ctx.lineCap=ne,this.pdf.setLineCap(ne))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ne){isNaN(ne)||(this.ctx.lineWidth=ne,this.pdf.setLineWidth(ne))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ne){["bevel","round","miter"].indexOf(ne)!==-1&&(this.ctx.lineJoin=ne,this.pdf.setLineJoin(ne))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ne){isNaN(ne)||(this.ctx.miterLimit=ne,this.pdf.setMiterLimit(ne))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ne){this.ctx.textBaseline=ne}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ne){["right","end","center","left","start"].indexOf(ne)!==-1&&(this.ctx.textAlign=ne)}});var ue=null,Te=null;Object.defineProperty(this,"fontFaces",{get:function(){return Te},set:function(ne){ue=null,Te=ne}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ne){var de;if(this.ctx.font=ne,(de=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ne))!==null){var lt=de[1];de[2];var Nt=de[3],at=de[4];de[5];var gt=de[6],Pt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(at)[2];at=Math.floor(Pt==="px"?parseFloat(at)*this.pdf.internal.scaleFactor:Pt==="em"?parseFloat(at)*this.pdf.getFontSize():parseFloat(at)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(at);var yt=function(Be){var mt,Ft,fr=[],It=Be.trim();if(It==="")return IE;if(It in _9)return[_9[It]];for(;It!=="";){switch(Ft=null,mt=(It=S9(It)).charAt(0)){case'"':case"'":Ft=IQe(It.substring(1),mt);break;default:Ft=OQe(It)}if(Ft===null||(fr.push(Ft[0]),(It=S9(Ft[1]))!==""&&It.charAt(0)!==","))return IE;It=It.replace(/^,/,"")}return fr}(gt);if(this.fontFaces){var Qe=function(Be,mt){if(ue===null){var Ft=function(fr){var It=[];return Object.keys(fr).forEach(function(Ut){fr[Ut].forEach(function(xe){var st=null;switch(xe){case"bold":st={family:Ut,weight:"bold"};break;case"italic":st={family:Ut,style:"italic"};break;case"bolditalic":st={family:Ut,weight:"bold",style:"italic"};break;case"":case"normal":st={family:Ut}}st!==null&&(st.ref={name:Ut,style:xe},It.push(st))})}),It}(Be.getFontList());ue=function(fr){for(var It={},Ut=0;Ut<fr.length;++Ut){var xe=kE(fr[Ut]),st=xe.family,Ct=xe.stretch,ar=xe.style,pr=xe.weight;It[st]=It[st]||{},It[st][Ct]=It[st][Ct]||{},It[st][Ct][ar]=It[st][Ct][ar]||{},It[st][Ct][ar][pr]=xe}return It}(Ft.concat(mt))}return ue}(this.pdf,this.fontFaces),ge=yt.map(function(Be){return{family:Be,stretch:"normal",weight:Nt,style:lt}}),rt=function(Be,mt,Ft){for(var fr=(Ft=Ft||{}).defaultFontFamily||"times",It=Object.assign({},kQe,Ft.genericFontFamilies||{}),Ut=null,xe=null,st=0;st<mt.length;++st)if(It[(Ut=kE(mt[st])).family]&&(Ut.family=It[Ut.family]),Be.hasOwnProperty(Ut.family)){xe=Be[Ut.family];break}if(!(xe=xe||Be[fr]))throw new Error("Could not find a font-family for the rule '"+N9(Ut)+"' and default family '"+fr+"'.");if(xe=function(Ct,ar){if(ar[Ct])return ar[Ct];var pr=UT[Ct],Xt=pr<=UT.normal?-1:1,yr=j9(ar,sae,pr,Xt);if(!yr)throw new Error("Could not find a matching font-stretch value for "+Ct);return yr}(Ut.stretch,xe),xe=function(Ct,ar){if(ar[Ct])return ar[Ct];for(var pr=aae[Ct],Xt=0;Xt<pr.length;++Xt)if(ar[pr[Xt]])return ar[pr[Xt]];throw new Error("Could not find a matching font-style for "+Ct)}(Ut.style,xe),!(xe=function(Ct,ar){if(ar[Ct])return ar[Ct];if(Ct===400&&ar[500])return ar[500];if(Ct===500&&ar[400])return ar[400];var pr=EQe[Ct],Xt=j9(ar,oae,pr,Ct<400?-1:1);if(!Xt)throw new Error("Could not find a matching font-weight for value "+Ct);return Xt}(Ut.weight,xe)))throw new Error("Failed to resolve a font for the rule '"+N9(Ut)+"'.");return xe}(Qe,ge);this.pdf.setFont(rt.ref.name,rt.ref.style)}else{var pt="";(Nt==="bold"||parseInt(Nt,10)>=700||lt==="bold")&&(pt="bold"),lt==="italic"&&(pt+="italic"),pt.length===0&&(pt="normal");for(var We="",Ze={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ne=0;Ne<yt.length;Ne++){if(this.pdf.internal.getFont(yt[Ne],pt,{noFallback:!0,disableWarning:!0})!==void 0){We=yt[Ne];break}if(pt==="bolditalic"&&this.pdf.internal.getFont(yt[Ne],"bold",{noFallback:!0,disableWarning:!0})!==void 0)We=yt[Ne],pt="bold";else if(this.pdf.internal.getFont(yt[Ne],"normal",{noFallback:!0,disableWarning:!0})!==void 0){We=yt[Ne],pt="normal";break}}if(We===""){for(var ye=0;ye<yt.length;ye++)if(Ze[yt[ye]]){We=Ze[yt[ye]];break}}We=We===""?"Times":We,this.pdf.setFont(We,pt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ne){this.ctx.globalCompositeOperation=ne}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ne){this.ctx.globalAlpha=ne}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ne){this.ctx.lineDashOffset=ne,_e.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ne){this.ctx.lineDash=ne,_e.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ne){this.ctx.ignoreClearRect=!!ne}})};f.prototype.setLineDash=function(K){this.lineDash=K},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){j.call(this,"fill",!1)},f.prototype.stroke=function(){j.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(K,q){if(isNaN(K)||isNaN(q))throw _s.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Y=this.ctx.transform.applyToPoint(new i(K,q));this.path.push({type:"mt",x:Y.x,y:Y.y}),this.ctx.lastPoint=new i(K,q)},f.prototype.closePath=function(){var K=new i(0,0),q=0;for(q=this.path.length-1;q!==-1;q--)if(this.path[q].type==="begin"&&Fa(this.path[q+1])==="object"&&typeof this.path[q+1].x=="number"){K=new i(this.path[q+1].x,this.path[q+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(K.x,K.y)},f.prototype.lineTo=function(K,q){if(isNaN(K)||isNaN(q))throw _s.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Y=this.ctx.transform.applyToPoint(new i(K,q));this.path.push({type:"lt",x:Y.x,y:Y.y}),this.ctx.lastPoint=new i(Y.x,Y.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},f.prototype.quadraticCurveTo=function(K,q,Y,J){if(isNaN(Y)||isNaN(J)||isNaN(K)||isNaN(q))throw _s.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var fe=this.ctx.transform.applyToPoint(new i(Y,J)),Z=this.ctx.transform.applyToPoint(new i(K,q));this.path.push({type:"qct",x1:Z.x,y1:Z.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new i(fe.x,fe.y)},f.prototype.bezierCurveTo=function(K,q,Y,J,fe,Z){if(isNaN(fe)||isNaN(Z)||isNaN(K)||isNaN(q)||isNaN(Y)||isNaN(J))throw _s.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ce=this.ctx.transform.applyToPoint(new i(fe,Z)),le=this.ctx.transform.applyToPoint(new i(K,q)),ie=this.ctx.transform.applyToPoint(new i(Y,J));this.path.push({type:"bct",x1:le.x,y1:le.y,x2:ie.x,y2:ie.y,x:ce.x,y:ce.y}),this.ctx.lastPoint=new i(ce.x,ce.y)},f.prototype.arc=function(K,q,Y,J,fe,Z){if(isNaN(K)||isNaN(q)||isNaN(Y)||isNaN(J)||isNaN(fe))throw _s.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Z=!!Z,!this.ctx.transform.isIdentity){var ce=this.ctx.transform.applyToPoint(new i(K,q));K=ce.x,q=ce.y;var le=this.ctx.transform.applyToPoint(new i(0,Y)),ie=this.ctx.transform.applyToPoint(new i(0,0));Y=Math.sqrt(Math.pow(le.x-ie.x,2)+Math.pow(le.y-ie.y,2))}Math.abs(fe-J)>=2*Math.PI&&(J=0,fe=2*Math.PI),this.path.push({type:"arc",x:K,y:q,radius:Y,startAngle:J,endAngle:fe,counterclockwise:Z})},f.prototype.arcTo=function(K,q,Y,J,fe){throw new Error("arcTo not implemented.")},f.prototype.rect=function(K,q,Y,J){if(isNaN(K)||isNaN(q)||isNaN(Y)||isNaN(J))throw _s.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(K,q),this.lineTo(K+Y,q),this.lineTo(K+Y,q+J),this.lineTo(K,q+J),this.lineTo(K,q),this.lineTo(K+Y,q),this.lineTo(K,q)},f.prototype.fillRect=function(K,q,Y,J){if(isNaN(K)||isNaN(q)||isNaN(Y)||isNaN(J))throw _s.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var fe={};this.lineCap!=="butt"&&(fe.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(fe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(K,q,Y,J),this.fill(),fe.hasOwnProperty("lineCap")&&(this.lineCap=fe.lineCap),fe.hasOwnProperty("lineJoin")&&(this.lineJoin=fe.lineJoin)}},f.prototype.strokeRect=function(K,q,Y,J){if(isNaN(K)||isNaN(q)||isNaN(Y)||isNaN(J))throw _s.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(K,q,Y,J),this.stroke())},f.prototype.clearRect=function(K,q,Y,J){if(isNaN(K)||isNaN(q)||isNaN(Y)||isNaN(J))throw _s.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(K,q,Y,J))},f.prototype.save=function(K){K=typeof K!="boolean"||K;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,Y=0;Y<this.pdf.internal.getNumberOfPages();Y++)this.pdf.setPage(Y+1),this.pdf.internal.out("q");if(this.pdf.setPage(q),K){this.ctx.fontSize=this.pdf.internal.getFontSize();var J=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=J}},f.prototype.restore=function(K){K=typeof K!="boolean"||K;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,Y=0;Y<this.pdf.internal.getNumberOfPages();Y++)this.pdf.setPage(Y+1),this.pdf.internal.out("Q");this.pdf.setPage(q),K&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(K){var q,Y,J,fe;if(K.isCanvasGradient===!0&&(K=K.getColor()),!K)return{r:0,g:0,b:0,a:0,style:K};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(K))q=0,Y=0,J=0,fe=0;else{var Z=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(K);if(Z!==null)q=parseInt(Z[1]),Y=parseInt(Z[2]),J=parseInt(Z[3]),fe=1;else if((Z=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(K))!==null)q=parseInt(Z[1]),Y=parseInt(Z[2]),J=parseInt(Z[3]),fe=parseFloat(Z[4]);else{if(fe=1,typeof K=="string"&&K.charAt(0)!=="#"){var ce=new Jne(K);K=ce.ok?ce.toHex():"#000000"}K.length===4?(q=K.substring(1,2),q+=q,Y=K.substring(2,3),Y+=Y,J=K.substring(3,4),J+=J):(q=K.substring(1,3),Y=K.substring(3,5),J=K.substring(5,7)),q=parseInt(q,16),Y=parseInt(Y,16),J=parseInt(J,16)}}return{r:q,g:Y,b:J,a:fe,style:K}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(K,q,Y,J){if(isNaN(q)||isNaN(Y)||typeof K!="string")throw _s.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(J=isNaN(J)?void 0:J,!m.call(this)){var fe=$(this.ctx.transform.rotation),Z=this.ctx.transform.scaleX;I.call(this,{text:K,x:q,y:Y,scale:Z,angle:fe,align:this.textAlign,maxWidth:J})}},f.prototype.strokeText=function(K,q,Y,J){if(isNaN(q)||isNaN(Y)||typeof K!="string")throw _s.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){J=isNaN(J)?void 0:J;var fe=$(this.ctx.transform.rotation),Z=this.ctx.transform.scaleX;I.call(this,{text:K,x:q,y:Y,scale:Z,renderingMode:"stroke",angle:fe,align:this.textAlign,maxWidth:J})}},f.prototype.measureText=function(K){if(typeof K!="string")throw _s.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var q=this.pdf,Y=this.pdf.internal.scaleFactor,J=q.internal.getFontSize(),fe=q.getStringUnitWidth(K)*J/q.internal.scaleFactor;return new function(Z){var ce=(Z=Z||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ce}}),this}({width:fe*=Math.round(96*Y/72*1e4)/1e4})},f.prototype.scale=function(K,q){if(isNaN(K)||isNaN(q))throw _s.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Y=new c(K,0,0,q,0,0);this.ctx.transform=this.ctx.transform.multiply(Y)},f.prototype.rotate=function(K){if(isNaN(K))throw _s.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var q=new c(Math.cos(K),Math.sin(K),-Math.sin(K),Math.cos(K),0,0);this.ctx.transform=this.ctx.transform.multiply(q)},f.prototype.translate=function(K,q){if(isNaN(K)||isNaN(q))throw _s.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Y=new c(1,0,0,1,K,q);this.ctx.transform=this.ctx.transform.multiply(Y)},f.prototype.transform=function(K,q,Y,J,fe,Z){if(isNaN(K)||isNaN(q)||isNaN(Y)||isNaN(J)||isNaN(fe)||isNaN(Z))throw _s.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ce=new c(K,q,Y,J,fe,Z);this.ctx.transform=this.ctx.transform.multiply(ce)},f.prototype.setTransform=function(K,q,Y,J,fe,Z){K=isNaN(K)?1:K,q=isNaN(q)?0:q,Y=isNaN(Y)?0:Y,J=isNaN(J)?1:J,fe=isNaN(fe)?0:fe,Z=isNaN(Z)?0:Z,this.ctx.transform=new c(K,q,Y,J,fe,Z)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(K,q,Y,J,fe,Z,ce,le,ie){var te=this.pdf.getImageProperties(K),ue=1,Te=1,ne=1,de=1;J!==void 0&&le!==void 0&&(ne=le/J,de=ie/fe,ue=te.width/J*le/J,Te=te.height/fe*ie/fe),Z===void 0&&(Z=q,ce=Y,q=0,Y=0),J!==void 0&&le===void 0&&(le=J,ie=fe),J===void 0&&le===void 0&&(le=te.width,ie=te.height);for(var lt,Nt=this.ctx.transform.decompose(),at=$(Nt.rotate.shx),gt=new c,Pt=(gt=(gt=(gt=gt.multiply(Nt.translate)).multiply(Nt.skew)).multiply(Nt.scale)).applyToRectangle(new l(Z-q*ne,ce-Y*de,J*ue,fe*Te)),yt=y.call(this,Pt),Qe=[],ge=0;ge<yt.length;ge+=1)Qe.indexOf(yt[ge])===-1&&Qe.push(yt[ge]);if(w(Qe),this.autoPaging)for(var rt=Qe[0],pt=Qe[Qe.length-1],We=rt;We<pt+1;We++){this.pdf.setPage(We);var Ze=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ne=We===1?this.posY+this.margin[0]:this.margin[0],ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Be=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],mt=We===1?0:ye+(We-2)*Be;if(this.ctx.clip_path.length!==0){var Ft=this.path;lt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(lt,this.posX+this.margin[3],-mt+Ne+this.ctx.prevPageLastElemOffset),_.call(this,"fill",!0),this.path=Ft}var fr=JSON.parse(JSON.stringify(Pt));fr=b([fr],this.posX+this.margin[3],-mt+Ne+this.ctx.prevPageLastElemOffset)[0];var It=(We>rt||We<pt)&&g.call(this);It&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ze,Be,null).clip().discardPath()),this.pdf.addImage(K,"JPEG",fr.x,fr.y,fr.w,fr.h,null,null,at),It&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(K,"JPEG",Pt.x,Pt.y,Pt.w,Pt.h,null,null,at)};var y=function(K,q,Y){var J=[];q=q||this.pdf.internal.pageSize.width,Y=Y||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var fe=this.posY+this.ctx.prevPageLastElemOffset;switch(K.type){default:case"mt":case"lt":J.push(Math.floor((K.y+fe)/Y)+1);break;case"arc":J.push(Math.floor((K.y+fe-K.radius)/Y)+1),J.push(Math.floor((K.y+fe+K.radius)/Y)+1);break;case"qct":var Z=ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,K.x1,K.y1,K.x,K.y);J.push(Math.floor((Z.y+fe)/Y)+1),J.push(Math.floor((Z.y+Z.h+fe)/Y)+1);break;case"bct":var ce=ve(this.ctx.lastPoint.x,this.ctx.lastPoint.y,K.x1,K.y1,K.x2,K.y2,K.x,K.y);J.push(Math.floor((ce.y+fe)/Y)+1),J.push(Math.floor((ce.y+ce.h+fe)/Y)+1);break;case"rect":J.push(Math.floor((K.y+fe)/Y)+1),J.push(Math.floor((K.y+K.h+fe)/Y)+1)}for(var le=0;le<J.length;le+=1)for(;this.pdf.internal.getNumberOfPages()<J[le];)x.call(this);return J},x=function(){var K=this.fillStyle,q=this.strokeStyle,Y=this.font,J=this.lineCap,fe=this.lineWidth,Z=this.lineJoin;this.pdf.addPage(),this.fillStyle=K,this.strokeStyle=q,this.font=Y,this.lineCap=J,this.lineWidth=fe,this.lineJoin=Z},b=function(K,q,Y){for(var J=0;J<K.length;J++)switch(K[J].type){case"bct":K[J].x2+=q,K[J].y2+=Y;case"qct":K[J].x1+=q,K[J].y1+=Y;default:K[J].x+=q,K[J].y+=Y}return K},w=function(K){return K.sort(function(q,Y){return q-Y})},j=function(K,q){for(var Y,J,fe=this.fillStyle,Z=this.strokeStyle,ce=this.lineCap,le=this.lineWidth,ie=Math.abs(le*this.ctx.transform.scaleX),te=this.lineJoin,ue=JSON.parse(JSON.stringify(this.path)),Te=JSON.parse(JSON.stringify(this.path)),ne=[],de=0;de<Te.length;de++)if(Te[de].x!==void 0)for(var lt=y.call(this,Te[de]),Nt=0;Nt<lt.length;Nt+=1)ne.indexOf(lt[Nt])===-1&&ne.push(lt[Nt]);for(var at=0;at<ne.length;at++)for(;this.pdf.internal.getNumberOfPages()<ne[at];)x.call(this);if(w(ne),this.autoPaging)for(var gt=ne[0],Pt=ne[ne.length-1],yt=gt;yt<Pt+1;yt++){this.pdf.setPage(yt),this.fillStyle=fe,this.strokeStyle=Z,this.lineCap=ce,this.lineWidth=ie,this.lineJoin=te;var Qe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ge=yt===1?this.posY+this.margin[0]:this.margin[0],rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],We=yt===1?0:rt+(yt-2)*pt;if(this.ctx.clip_path.length!==0){var Ze=this.path;Y=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(Y,this.posX+this.margin[3],-We+ge+this.ctx.prevPageLastElemOffset),_.call(this,K,!0),this.path=Ze}if(J=JSON.parse(JSON.stringify(ue)),this.path=b(J,this.posX+this.margin[3],-We+ge+this.ctx.prevPageLastElemOffset),q===!1||yt===0){var Ne=(yt>gt||yt<Pt)&&g.call(this);Ne&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Qe,pt,null).clip().discardPath()),_.call(this,K,q),Ne&&this.pdf.restoreGraphicsState()}this.lineWidth=le}else this.lineWidth=ie,_.call(this,K,q),this.lineWidth=le;this.path=ue},_=function(K,q){if((K!=="stroke"||q||!v.call(this))&&(K==="stroke"||q||!m.call(this))){for(var Y,J,fe=[],Z=this.path,ce=0;ce<Z.length;ce++){var le=Z[ce];switch(le.type){case"begin":fe.push({begin:!0});break;case"close":fe.push({close:!0});break;case"mt":fe.push({start:le,deltas:[],abs:[]});break;case"lt":var ie=fe.length;if(Z[ce-1]&&!isNaN(Z[ce-1].x)&&(Y=[le.x-Z[ce-1].x,le.y-Z[ce-1].y],ie>0)){for(;ie>=0;ie--)if(fe[ie-1].close!==!0&&fe[ie-1].begin!==!0){fe[ie-1].deltas.push(Y),fe[ie-1].abs.push(le);break}}break;case"bct":Y=[le.x1-Z[ce-1].x,le.y1-Z[ce-1].y,le.x2-Z[ce-1].x,le.y2-Z[ce-1].y,le.x-Z[ce-1].x,le.y-Z[ce-1].y],fe[fe.length-1].deltas.push(Y);break;case"qct":var te=Z[ce-1].x+2/3*(le.x1-Z[ce-1].x),ue=Z[ce-1].y+2/3*(le.y1-Z[ce-1].y),Te=le.x+2/3*(le.x1-le.x),ne=le.y+2/3*(le.y1-le.y),de=le.x,lt=le.y;Y=[te-Z[ce-1].x,ue-Z[ce-1].y,Te-Z[ce-1].x,ne-Z[ce-1].y,de-Z[ce-1].x,lt-Z[ce-1].y],fe[fe.length-1].deltas.push(Y);break;case"arc":fe.push({deltas:[],abs:[],arc:!0}),Array.isArray(fe[fe.length-1].abs)&&fe[fe.length-1].abs.push(le)}}J=q?null:K==="stroke"?"stroke":"fill";for(var Nt=!1,at=0;at<fe.length;at++)if(fe[at].arc)for(var gt=fe[at].abs,Pt=0;Pt<gt.length;Pt++){var yt=gt[Pt];yt.type==="arc"?E.call(this,yt.x,yt.y,yt.radius,yt.startAngle,yt.endAngle,yt.counterclockwise,void 0,q,!Nt):R.call(this,yt.x,yt.y),Nt=!0}else if(fe[at].close===!0)this.pdf.internal.out("h"),Nt=!1;else if(fe[at].begin!==!0){var Qe=fe[at].start.x,ge=fe[at].start.y;M.call(this,fe[at].deltas,Qe,ge),Nt=!0}J&&A.call(this,J),q&&F.call(this)}},C=function(K){var q=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Y=q*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return K-Y;case"top":return K+q-Y;case"hanging":return K+q-2*Y;case"middle":return K+q/2-Y;default:return K}},P=function(K){return K+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var K=function(){};return K.colorStops=[],K.addColorStop=function(q,Y){this.colorStops.push([q,Y])},K.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},K.isCanvasGradient=!0,K},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var E=function(K,q,Y,J,fe,Z,ce,le,ie){for(var te=z.call(this,Y,J,fe,Z),ue=0;ue<te.length;ue++){var Te=te[ue];ue===0&&(ie?D.call(this,Te.x1+K,Te.y1+q):R.call(this,Te.x1+K,Te.y1+q)),U.call(this,K,q,Te.x2,Te.y2,Te.x3,Te.y3,Te.x4,Te.y4)}le?F.call(this):A.call(this,ce)},A=function(K){switch(K){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F=function(){this.pdf.clip(),this.pdf.discardPath()},D=function(K,q){this.pdf.internal.out(r(K)+" "+n(q)+" m")},I=function(K){var q;switch(K.align){case"right":case"end":q="right";break;case"center":q="center";break;default:q="left"}var Y=this.pdf.getTextDimensions(K.text),J=C.call(this,K.y),fe=P.call(this,J)-Y.h,Z=this.ctx.transform.applyToPoint(new i(K.x,J)),ce=this.ctx.transform.decompose(),le=new c;le=(le=(le=le.multiply(ce.translate)).multiply(ce.skew)).multiply(ce.scale);for(var ie,te,ue,Te=this.ctx.transform.applyToRectangle(new l(K.x,J,Y.w,Y.h)),ne=le.applyToRectangle(new l(K.x,fe,Y.w,Y.h)),de=y.call(this,ne),lt=[],Nt=0;Nt<de.length;Nt+=1)lt.indexOf(de[Nt])===-1&&lt.push(de[Nt]);if(w(lt),this.autoPaging)for(var at=lt[0],gt=lt[lt.length-1],Pt=at;Pt<gt+1;Pt++){this.pdf.setPage(Pt);var yt=Pt===1?this.posY+this.margin[0]:this.margin[0],Qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ge=this.pdf.internal.pageSize.height-this.margin[2],rt=ge-this.margin[0],pt=this.pdf.internal.pageSize.width-this.margin[1],We=pt-this.margin[3],Ze=Pt===1?0:Qe+(Pt-2)*rt;if(this.ctx.clip_path.length!==0){var Ne=this.path;ie=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ie,this.posX+this.margin[3],-1*Ze+yt),_.call(this,"fill",!0),this.path=Ne}var ye=b([JSON.parse(JSON.stringify(ne))],this.posX+this.margin[3],-Ze+yt+this.ctx.prevPageLastElemOffset)[0];K.scale>=.01&&(te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(te*K.scale),ue=this.lineWidth,this.lineWidth=ue*K.scale);var Be=this.autoPaging!=="text";if(Be||ye.y+ye.h<=ge){if(Be||ye.y>=yt&&ye.x<=pt){var mt=Be?K.text:this.pdf.splitTextToSize(K.text,K.maxWidth||pt-ye.x)[0],Ft=b([JSON.parse(JSON.stringify(Te))],this.posX+this.margin[3],-Ze+yt+this.ctx.prevPageLastElemOffset)[0],fr=Be&&(Pt>at||Pt<gt)&&g.call(this);fr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],We,rt,null).clip().discardPath()),this.pdf.text(mt,Ft.x,Ft.y,{angle:K.angle,align:q,renderingMode:K.renderingMode}),fr&&this.pdf.restoreGraphicsState()}}else ye.y<ge&&(this.ctx.prevPageLastElemOffset+=ge-ye.y);K.scale>=.01&&(this.pdf.setFontSize(te),this.lineWidth=ue)}else K.scale>=.01&&(te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(te*K.scale),ue=this.lineWidth,this.lineWidth=ue*K.scale),this.pdf.text(K.text,Z.x+this.posX,Z.y+this.posY,{angle:K.angle,align:q,renderingMode:K.renderingMode,maxWidth:K.maxWidth}),K.scale>=.01&&(this.pdf.setFontSize(te),this.lineWidth=ue)},R=function(K,q,Y,J){Y=Y||0,J=J||0,this.pdf.internal.out(r(K+Y)+" "+n(q+J)+" l")},M=function(K,q,Y){return this.pdf.lines(K,q,Y,null,null)},U=function(K,q,Y,J,fe,Z,ce,le){this.pdf.internal.out([t(s(Y+K)),t(o(J+q)),t(s(fe+K)),t(o(Z+q)),t(s(ce+K)),t(o(le+q)),"c"].join(" "))},z=function(K,q,Y,J){for(var fe=2*Math.PI,Z=Math.PI/2;q>Y;)q-=fe;var ce=Math.abs(Y-q);ce<fe&&J&&(ce=fe-ce);for(var le=[],ie=J?-1:1,te=q;ce>1e-5;){var ue=te+ie*Math.min(ce,Z);le.push(W.call(this,K,te,ue)),ce-=Math.abs(ue-te),te=ue}return le},W=function(K,q,Y){var J=(Y-q)/2,fe=K*Math.cos(J),Z=K*Math.sin(J),ce=fe,le=-Z,ie=ce*ce+le*le,te=ie+ce*fe+le*Z,ue=4/3*(Math.sqrt(2*ie*te)-te)/(ce*Z-le*fe),Te=ce-ue*le,ne=le+ue*ce,de=Te,lt=-ne,Nt=J+q,at=Math.cos(Nt),gt=Math.sin(Nt);return{x1:K*Math.cos(q),y1:K*Math.sin(q),x2:Te*at-ne*gt,y2:Te*gt+ne*at,x3:de*at-lt*gt,y3:de*gt+lt*at,x4:K*Math.cos(Y),y4:K*Math.sin(Y)}},$=function(K){return 180*K/Math.PI},ee=function(K,q,Y,J,fe,Z){var ce=K+.5*(Y-K),le=q+.5*(J-q),ie=fe+.5*(Y-fe),te=Z+.5*(J-Z),ue=Math.min(K,fe,ce,ie),Te=Math.max(K,fe,ce,ie),ne=Math.min(q,Z,le,te),de=Math.max(q,Z,le,te);return new l(ue,ne,Te-ue,de-ne)},ve=function(K,q,Y,J,fe,Z,ce,le){var ie,te,ue,Te,ne,de,lt,Nt,at,gt,Pt,yt,Qe,ge,rt=Y-K,pt=J-q,We=fe-Y,Ze=Z-J,Ne=ce-fe,ye=le-Z;for(te=0;te<41;te++)at=(lt=(ue=K+(ie=te/40)*rt)+ie*((ne=Y+ie*We)-ue))+ie*(ne+ie*(fe+ie*Ne-ne)-lt),gt=(Nt=(Te=q+ie*pt)+ie*((de=J+ie*Ze)-Te))+ie*(de+ie*(Z+ie*ye-de)-Nt),te==0?(Pt=at,yt=gt,Qe=at,ge=gt):(Pt=Math.min(Pt,at),yt=Math.min(yt,gt),Qe=Math.max(Qe,at),ge=Math.max(ge,gt));return new l(Math.round(Pt),Math.round(yt),Math.round(Qe-Pt),Math.round(ge-yt))},_e=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var K,q,Y=(K=this.ctx.lineDash,q=this.ctx.lineDashOffset,JSON.stringify({lineDash:K,lineDashOffset:q}));this.prevLineDash!==Y&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Y)}}})(Wn.API),function(e){var t=function(i){var l,c,d,u,f,h,m,v,g,y;for(c=[],d=0,u=(i+=l="\0\0\0\0".slice(i.length%4||4)).length;u>d;d+=4)(f=(i.charCodeAt(d)<<24)+(i.charCodeAt(d+1)<<16)+(i.charCodeAt(d+2)<<8)+i.charCodeAt(d+3))!==0?(h=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(v=f%85))/85)-(m=f%85))/85)%85,c.push(h+33,m+33,v+33,g+33,y+33)):c.push(122);return function(x,b){for(var w=b;w>0;w--)x.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(i){var l,c,d,u,f,h=String,m="length",v=255,g="charCodeAt",y="slice",x="replace";for(i[y](-2),i=i[y](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),d=[],u=0,f=(i+=l="uuuuu"[y](i[m]%5||5))[m];f>u;u+=5)c=52200625*(i[g](u)-33)+614125*(i[g](u+1)-33)+7225*(i[g](u+2)-33)+85*(i[g](u+3)-33)+(i[g](u+4)-33),d.push(v&c>>24,v&c>>16,v&c>>8,v&c);return function(b,w){for(var j=w;j>0;j--)b.pop()}(d,l[m]),h.fromCharCode.apply(h,d)},n=function(i){return i.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(i){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),l.test(i)===!1)return"";for(var c="",d=0;d<i.length;d+=2)c+=String.fromCharCode("0x"+(i[d]+i[d+1]));return c},o=function(i){for(var l=new Uint8Array(i.length),c=i.length;c--;)l[c]=i.charCodeAt(c);return(l=kT(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};e.processDataByFilters=function(i,l){var c=0,d=i||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=s(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=o(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(Wn.API),function(e){e.loadFile=function(t,r,n){return function(s,o,i){o=o!==!1,i=typeof i=="function"?i:function(){};var l=void 0;try{l=function(c,d,u){var f=new XMLHttpRequest,h=0,m=function(v){var g=v.length,y=[],x=String.fromCharCode;for(h=0;h<g;h+=1)y.push(x(255&v.charCodeAt(h)));return y.join("")};if(f.open("GET",c,!d),f.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(f.onload=function(){f.status===200?u(m(this.responseText)):u(void 0)}),f.send(null),d&&f.status===200)return m(f.responseText)}(s,o,i)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Wn.API),function(e){function t(){return(ua.html2canvas?Promise.resolve(ua.html2canvas):Wu(()=>import("./html2canvas.esm-f16e60ff.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(ua.DOMPurify?Promise.resolve(ua.DOMPurify):Wu(()=>import("./purify.es-fd086bfc.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Fa(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},o=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(l(f,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},i=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(l,c){return l.__proto__=c||i.prototype,l},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:s("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},i.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=o(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var m=0;m<u.length;++m){var v=u[m],g=v.src.find(function(y){return y.format==="truetype"});g&&d.addFont(g.url,v.ref.name,v.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,d.context2d.save(!0),c(this.prop.container,h)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},i.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},i.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},i.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in i.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},i.prototype.get=function(l,c){return this.then(function(){var d=l in i.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},i.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},i.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||Wn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},i.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,f){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(h){return d.updateProgress(null,u),h}).then(u,f).then(function(h){return d.updateProgress(1),h})})},i.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:i.convert(Object.assign({},u),Promise.prototype),h=d.call(f,l,c);return i.convert(h,u.__proto__)},i.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},i.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},i.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return i.convert(c,this)},i.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},i.prototype.error=function(l){return this.then(function(){throw new Error(l)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Wn.getPageSize=function(l,c,d){if(Fa(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var f,h=(""+d).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var v,g=0,y=0;if(m.hasOwnProperty(h))g=m[h][1]/f,y=m[h][0]/f;else try{g=d[1],y=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",y>g&&(v=y,y=g,g=v);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(v=y,y=g,g=v)}return{width:y,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(kE):null;var d=new i(c);return c.worker?d:d.from(l).doCallback()}}(Wn.API),Wn.API.addJS=function(e){return A9=e,this.internal.events.subscribe("postPutResources",function(){pj=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(pj+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),C9=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+A9+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){pj!==void 0&&C9!==void 0&&this.internal.out("/Names <</JavaScript "+pj+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),o=0;o<s.length;o++){var i=s[o],l=n.exec(i);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(i)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(o=0;o<d;o++){var f=r.internal.newObject();u.push(f);var h=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<u.length;o++)r.internal.write("(page_"+(o+1)+")"+u[o]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,o){var i={title:s,options:o,children:[]};return n==null&&(n=this.root),n.children.push(i),i},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var i=n.children[o];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var l=this.count=this.count_r({count:0},i);if(l>0&&this.line("/Count "+l),i.options&&i.options.pageNumber){var c=r.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var o=0;o<s.children.length;o++)n.count++,this.count_r(n,s.children[o]);return n.count}}])}(Wn.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,o,i,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=i||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var h,m=256*f.charCodeAt(4)+f.charCodeAt(5),v=f.length,g={width:0,height:0,numcomponents:1},y=4;y<v;y+=2){if(y+=m,t.indexOf(f.charCodeAt(y+1))!==-1){h=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:h,numcomponents:f.charCodeAt(y+9)};break}m=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:s}}return u}}(Wn.API),Wn.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,o=hQe(e,{checkCrc:!0}),i=o.width,l=o.height,c=o.channels,d=o.palette,u=o.depth;s=d&&c===1?function(E){for(var A=E.width,F=E.height,D=E.data,I=E.palette,R=E.depth,M=!1,U=[],z=[],W=void 0,$=!1,ee=0,ve=0;ve<I.length;ve++){var _e=wz(I[ve],4),K=_e[0],q=_e[1],Y=_e[2],J=_e[3];U.push(K,q,Y),J!=null&&(J===0?(ee++,z.length<1&&z.push(ve)):J<255&&($=!0))}if($||ee>1){M=!0,z=void 0;var fe=A*F;W=new Uint8Array(fe);for(var Z=new DataView(D.buffer),ce=0;ce<fe;ce++){var le=OE(Z,ce,R),ie=wz(I[le],4)[3];W[ce]=ie}}else ee===0&&(z=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:M?8:void 0,colorBytes:D,alphaBytes:W,needSMask:M,palette:U,mask:z}}(o):c===2||c===4?function(E){for(var A=E.data,F=E.width,D=E.height,I=E.channels,R=E.depth,M=I===2?"DeviceGray":"DeviceRGB",U=I-1,z=F*D,W=U,$=z*W,ee=1*z,ve=Math.ceil($*R/8),_e=Math.ceil(ee*R/8),K=new Uint8Array(ve),q=new Uint8Array(_e),Y=new DataView(A.buffer),J=new DataView(K.buffer),fe=new DataView(q.buffer),Z=!1,ce=0;ce<z;ce++){for(var le=ce*I,ie=0;ie<W;ie++)R9(J,OE(Y,le+ie,R),ce*W+ie,R);var te=OE(Y,le+W,R);te<(1<<R)-1&&(Z=!0),R9(fe,te,1*ce,R)}return{colorSpace:M,colorsPerPixel:U,sMaskBitsPerComponent:Z?R:void 0,colorBytes:K,alphaBytes:q,needSMask:Z}}(o):function(E){var A=E.data,F=E.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:F,colorsPerPixel:F==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?function(D){for(var I=D.length,R=new Uint8Array(2*I),M=new DataView(R.buffer,R.byteOffset,R.byteLength),U=0;U<I;U++)M.setUint16(2*U,D[U],!1);return R}(A):A,needSMask:!1}}(o);var f,h,m,v=s,g=v.colorSpace,y=v.colorsPerPixel,x=v.sMaskBitsPerComponent,b=v.colorBytes,w=v.alphaBytes,j=v.needSMask,_=v.palette,C=v.mask,P=null;return n!==Wn.API.image_compression.NONE&&typeof kT=="function"?(P=function(E){var A;switch(E){case Wn.API.image_compression.FAST:A=11;break;case Wn.API.image_compression.MEDIUM:A=13;break;case Wn.API.image_compression.SLOW:A=14;break;default:A=12}return A}(n),f=this.decode.FLATE_DECODE,h="/Predictor ".concat(P," /Colors ").concat(y," /BitsPerComponent ").concat(u," /Columns ").concat(i),e=I9(b,Math.ceil(i*y*u/8),y,u,n),j&&(m=I9(w,Math.ceil(i*x/8),1,x,n))):(f=void 0,h=void 0,e=b,j&&(m=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:r,data:e,index:t,filter:f,decodeParameters:h,transparency:C,palette:_,sMask:m,predictor:P,width:i,height:l,bitsPerComponent:u,sMaskBitsPerComponent:x,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,s){var o=new RQe(t),i=o.width,l=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:i,height:l},u=new TE(100).encode(d,100);return e.processJPEG.call(this,u,r,n,s)},e.processGIF87A=e.processGIF89A}(Wn.API),zd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},zd.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){_s.log("bit decode error:"+r)}},zd.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var o=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[o>>7-l&1];this.data[i+4*l]=c.blue,this.data[i+4*l+1]=c.green,this.data[i+4*l+2]=c.red,this.data[i+4*l+3]=255}r!==0&&(this.pos+=4-r)}},zd.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var o=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*s*4,l=o>>4,c=15&o,d=this.palette[l];if(this.data[i]=d.blue,this.data[i+1]=d.green,this.data[i+2]=d.red,this.data[i+3]=255,2*s+1>=this.width)break;d=this.palette[c],this.data[i+4]=d.blue,this.data[i+4+1]=d.green,this.data[i+4+2]=d.red,this.data[i+4+3]=255}t!==0&&(this.pos+=4-t)}},zd.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(s<this.palette.length){var i=this.palette[s];this.data[o]=i.red,this.data[o+1]=i.green,this.data[o+2]=i.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}e!==0&&(this.pos+=4-e)}},zd.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(o&t)/t*255|0,l=(o>>5&t)/t*255|0,c=(o>>10&t)/t*255|0,d=o>>15?255:0,u=n*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=i,this.data[u+3]=d}this.pos+=e}},zd.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&t)/t*255|0,c=(i>>5&r)/r*255|0,d=(i>>11)/t*255|0,u=s*this.width*4+4*o;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=e}},zd.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=o,this.data[i+1]=s,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},zd.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=o,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=i}},zd.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var o=new zd(t,!1),i=o.width,l=o.height,c={data:o.getData(),width:i,height:l},d=new TE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,s)}}(Wn.API),F9.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var o=new F9(t),i=o.width,l=o.height,c={data:o.getData(),width:i,height:l},d=new TE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,s)}}(Wn.API),Wn.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,o=new Uint8Array(s/4*3),i=new Uint8Array(s/4),l=0,c=0,d=0;d<s;d+=4){var u=n[d],f=n[d+1],h=n[d+2],m=n[d+3];o[l++]=u,o[l++]=f,o[l++]=h,i[c++]=m}var v=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Wn.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},sv=Wn.API,gj=sv.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),o=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,d=t.kerning?t.kerning:s.metadata.Unicode.kerning,u=d.fof?d.fof:1,f=t.doKerning!==!1,h=0,m=e.length,v=0,g=l[0]||c,y=[];for(r=0;r<m;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?y.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+i*(1e3/o)||0)/1e3):(h=f&&Fa(d[n])==="object"&&!isNaN(parseInt(d[n][v],10))?d[n][v]/u:0,y.push((l[n]||g)/c+h)),v=n;return y},P9=sv.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return sv.processArabic&&(e=sv.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:gj.apply(this,arguments).reduce(function(o,i){return o+i},0)},E9=function(e,t,r,n){for(var s=[],o=0,i=e.length,l=0;o!==i&&l+t[o]<r;)l+=t[o],o++;s.push(e.slice(0,o));var c=o;for(l=0;o!==i;)l+t[o]>n&&(s.push(e.slice(c,o)),l=0,c=o),l+=t[o],o++;return c!==o&&s.push(e.slice(c,o)),s},k9=function(e,t,r){r||(r={});var n,s,o,i,l,c,d,u=[],f=[u],h=r.textIndent||0,m=0,v=0,g=e.split(" "),y=gj.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var x=Array(c).join(" "),b=[];g.map(function(j){(j=j.split(/\s*\n/)).length>1?b=b.concat(j.map(function(_,C){return(C&&_.length?`
`:"")+_})):b.push(j[0])}),g=b,c=P9.apply(this,[x,r])}for(o=0,i=g.length;o<i;o++){var w=0;if(n=g[o],c&&n[0]==`
`&&(n=n.substr(1),w=1),h+m+(v=(s=gj.apply(this,[n,r])).reduce(function(j,_){return j+_},0))>t||w){if(v>t){for(l=E9.apply(this,[n,s,t-(h+m),t]),u.push(l.shift()),u=[l.pop()];l.length;)f.push([l.shift()]);v=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(j,_){return j+_},0)}else u=[n];f.push(u),h=v+c,m=y}else u.push(n),h+=m+v,m=y}return d=c?function(j,_){return(_?x:"")+j.join(" ")}:function(j){return j.join(" ")},f.map(d)},sv.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),o=function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),h="Unicode";return f.metadata[h]?{widths:f.metadata[h].widths||{0:1},kerning:f.metadata[h].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/s;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,o.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(k9.apply(this,[n[l],i,o]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},o=0;o<16;o++)n[r[o]]=t[o],s[t[o]]=r[o];var i=function(h){return"0x"+parseInt(h,10).toString(16)},l=e.__fontmetrics__.compress=function(h){var m,v,g,y,x=["{"];for(var b in h){if(m=h[b],isNaN(parseInt(b,10))?v="'"+b+"'":(b=parseInt(b,10),v=(v=i(b).slice(2)).slice(0,-1)+s[v.slice(-1)]),typeof m=="number")m<0?(g=i(m).slice(3),y="-"):(g=i(m).slice(2),y=""),g=y+g.slice(0,-1)+s[g.slice(-1)];else{if(Fa(m)!=="object")throw new Error("Don't know what to do with value type "+Fa(m)+".");g=l(m)}x.push(v+g)}return x.push("}"),x.join("")},c=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,v,g,y,x={},b=1,w=x,j=[],_="",C="",P=h.length-1,E=1;E<P;E+=1)(y=h[E])=="'"?m?(g=m.join(""),m=void 0):m=[]:m?m.push(y):y=="{"?(j.push([w,g]),w={},g=void 0):y=="}"?((v=j.pop())[0][v[1]]=w,g=void 0,w=v[0]):y=="-"?b=-1:g===void 0?n.hasOwnProperty(y)?(_+=n[y],g=parseInt(_,16)*b,b=1,_=""):_+=y:n.hasOwnProperty(y)?(C+=n[y],w[g]=parseInt(C,16)*b,b=1,g=void 0,C=""):C+=y;return x},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var m=h.font,v=f.Unicode[m.postScriptName];v&&(m.metadata.Unicode={},m.metadata.Unicode.widths=v.widths,m.metadata.Unicode.kerning=v.kerning);var g=u.Unicode[m.postScriptName];g&&(m.metadata.Unicode.encoding=g,m.encoding=g.codePages[0])}])}(Wn.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),o=0;o<n;o++)s[o]=r.charCodeAt(o);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,o=r.instance;if(!s.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=o.existsFileInVFS(s.postScriptName)===!1?o.loadFile(s.postScriptName):o.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(i,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(r_(l)),i.metadata=e.API.TTFFont.open(l),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(s,n)}}])}(Wn),Wn.API.addSvgAsImage=function(e,t,r,n,s,o,i,l){if(isNaN(t)||isNaN(r))throw _s.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw _s.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(ua.canvg?Promise.resolve(ua.canvg):Wu(()=>import("./index.es-783f9875.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(u)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,s,i,l)})},Wn.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},Wn.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,o,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(i),c=[],d=0,u=0,f=0;function h(v,g){var y,x=!1;for(y=0;y<v.length;y+=1)v[y]===g&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var m=l.length;for(f=0;f<m;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Fa(e)==="object"){for(s in e)if(o=e[s],h(l,s)&&o!==void 0){if(r[s].type==="boolean"&&typeof o=="boolean")r[s].value=o;else if(r[s].type==="name"&&h(r[s].valueSet,o))r[s].value=o;else if(r[s].type==="integer"&&Number.isInteger(o))r[s].value=o;else if(r[s].type==="array"){for(d=0;d<o.length;d+=1)if(n=!0,o[d].length===1&&typeof o[d][0]=="number")c.push(String(o[d]-1));else if(o[d].length>1){for(u=0;u<o[d].length;u+=1)typeof o[d][u]!="number"&&(n=!1);n===!0&&c.push([o[d][0]-1,o[d][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,g=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?g.push("/"+v+" /"+r[v].value):g.push("/"+v+" "+r[v].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=o.length+i.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(s+o+i+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Wn.API),function(e){var t=e.API,r=t.pdfEscape16=function(o,i){for(var l,c=i.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],f=0,h=o.length;f<h;++f){if(l=i.metadata.characterToGlyph(o.charCodeAt(f)),i.metadata.glyIdsUsed.push(l),i.metadata.toUnicode[l]=o.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(i.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(o){var i,l,c,d,u,f,h;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,h=(l=Object.keys(o).sort(function(m,v){return m-v})).length;f<h;f++)i=l[f],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[i]!==void 0&&o[i]!==null&&typeof o[i].toString=="function"&&(d=("0000"+o[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),c.push("<"+i+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(o){(function(i){var l=i.font,c=i.out,d=i.newObject,u=i.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",v=0;v<h.length;v++)m+=String.fromCharCode(h[v]);var g=d();u({data:m,addLength1:!0,objectId:g}),c("endobj");var y=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var x=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+vv(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+vv(l.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+vv(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]),t.events.push(["putFont",function(o){(function(i){var l=i.font,c=i.out,d=i.newObject,u=i.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,h="",m=0;m<f.length;m++)h+=String.fromCharCode(f[m]);var v=d();u({data:h,addLength1:!0,objectId:v}),c("endobj");var g=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+v+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+vv(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var x=0;x<l.metadata.hmtx.widths.length;x++)l.metadata.hmtx.widths[x]=parseInt(l.metadata.hmtx.widths[x]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+vv(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]);var s=function(o){var i,l=o.text||"",c=o.x,d=o.y,u=o.options||{},f=o.mutex||{},h=f.pdfEscape,m=f.activeFontKey,v=f.fonts,g=m,y="",x=0,b="",w=v[g].encoding;if(v[g].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:f};for(b=l,g=m,Array.isArray(l)&&(b=l[0]),x=0;x<b.length;x+=1)v[g].metadata.hasOwnProperty("cmap")&&(i=v[g].metadata.cmap.unicode.codeMap[b[x].charCodeAt(0)]),i||b[x].charCodeAt(0)<256&&v[g].metadata.hasOwnProperty("Unicode")?y+=b[x]:y+="";var j="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?j=h(y,g).split("").map(function(_){return _.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(j=r(y,v[g])),f.isHex=!0,{text:j,x:c,y:d,options:u,mutex:f}};t.events.push(["postProcessText",function(o){var i=o.text||"",l=[],c={text:i,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(i)){var d=0;for(d=0;d<i.length;d+=1)Array.isArray(i[d])&&i[d].length===3?l.push([s(Object.assign({},c,{text:i[d][0]})).text,i[d][1],i[d][2]]):l.push(s(Object.assign({},c,{text:i[d]})).text);o.text=l}else o.text=s(Object.assign({},c,{text:i})).text}])}(Wn),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Wn.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,o,i,l,c,d,u,f=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var j=function(D){var I=D.charCodeAt(),R=I>>8,M=g[R];return M!==void 0?f[256*M+(255&I)]:R===252||R===253?"AL":x.test(R)?"L":R===8?"R":"N"},_=function(D){for(var I,R=0;R<D.length;R++){if((I=j(D.charAt(R)))==="L")return!1;if(I==="R")return!0}return!1},C=function(D,I,R,M){var U,z,W,$,ee=I[M];switch(ee){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"N":case"AN":break;case"EN":b&&(ee="AN");break;case"AL":b=!0,ee="R";break;case"WS":case"BN":ee="N";break;case"CS":M<1||M+1>=I.length||(U=R[M-1])!=="EN"&&U!=="AN"||(z=I[M+1])!=="EN"&&z!=="AN"?ee="N":b&&(z="AN"),ee=z===U?z:"N";break;case"ES":ee=(U=M>0?R[M-1]:"B")==="EN"&&M+1<I.length&&I[M+1]==="EN"?"EN":"N";break;case"ET":if(M>0&&R[M-1]==="EN"){ee="EN";break}if(b){ee="N";break}for(W=M+1,$=I.length;W<$&&I[W]==="ET";)W++;ee=W<$&&I[W]==="EN"?"EN":"N";break;case"NSM":if(i&&!l){for($=I.length,W=M+1;W<$&&I[W]==="NSM";)W++;if(W<$){var ve=D[M],_e=ve>=1425&&ve<=2303||ve===64286;if(U=I[W],_e&&(U==="R"||U==="AL")){ee="R";break}}}ee=M<1||(U=I[M-1])==="B"?"N":R[M-1];break;case"B":b=!1,s=!0,ee=w;break;case"S":o=!0,ee="N"}return ee},P=function(D,I,R){var M=D.split("");return R&&E(M,R,{hiLevel:w}),M.reverse(),I&&I.reverse(),M.join("")},E=function(D,I,R){var M,U,z,W,$,ee=-1,ve=D.length,_e=0,K=[],q=w?m:h,Y=[];for(b=!1,s=!1,o=!1,U=0;U<ve;U++)Y[U]=j(D[U]);for(z=0;z<ve;z++){if($=_e,K[z]=C(D,Y,K,z),M=240&(_e=q[$][v[K[z]]]),_e&=15,I[z]=W=q[_e][5],M>0)if(M===16){for(U=ee;U<z;U++)I[U]=1;ee=-1}else ee=-1;if(q[_e][6])ee===-1&&(ee=z);else if(ee>-1){for(U=ee;U<z;U++)I[U]=W;ee=-1}Y[z]==="B"&&(I[z]=0),R.hiLevel|=W}o&&function(J,fe,Z){for(var ce=0;ce<Z;ce++)if(J[ce]==="S"){fe[ce]=w;for(var le=ce-1;le>=0&&J[le]==="WS";le--)fe[le]=w}}(Y,I,ve)},A=function(D,I,R,M,U){if(!(U.hiLevel<D)){if(D===1&&w===1&&!s)return I.reverse(),void(R&&R.reverse());for(var z,W,$,ee,ve=I.length,_e=0;_e<ve;){if(M[_e]>=D){for($=_e+1;$<ve&&M[$]>=D;)$++;for(ee=_e,W=$-1;ee<W;ee++,W--)z=I[ee],I[ee]=I[W],I[W]=z,R&&(z=R[ee],R[ee]=R[W],R[W]=z);_e=$}_e++}}},F=function(D,I,R){var M=D.split(""),U={hiLevel:w};return R||(R=[]),E(M,R,U),function(z,W,$){if($.hiLevel!==0&&u)for(var ee,ve=0;ve<z.length;ve++)W[ve]===1&&(ee=y.indexOf(z[ve]))>=0&&(z[ve]=y[ee+1])}(M,R,U),A(2,M,I,R,U),A(1,M,I,R,U),M.join("")};return this.__bidiEngine__.doBidiReorder=function(D,I,R){if(function(U,z){if(z)for(var W=0;W<U.length;W++)z[W]=W;l===void 0&&(l=_(U)),d===void 0&&(d=_(U))}(D,I),i||!c||d)if(i&&c&&l^d)w=l?1:0,D=P(D,I,R);else if(!i&&c&&d)w=l?1:0,D=F(D,I,R),D=P(D,I);else if(!i||l||c||d){if(i&&!c&&l^d)D=P(D,I),l?(w=0,D=F(D,I,R)):(w=1,D=F(D,I,R),D=P(D,I));else if(i&&l&&!c&&d)w=1,D=F(D,I,R),D=P(D,I);else if(!i&&!c&&l^d){var M=u;l?(w=1,D=F(D,I,R),w=0,u=!1,D=F(D,I,R),u=M):(w=0,D=F(D,I,R),D=P(D,I),w=1,u=!1,D=F(D,I,R),u=M,D=P(D,I))}}else w=0,D=F(D,I,R);else w=l?1:0,D=F(D,I,R);return D},this.__bidiEngine__.setOptions=function(D){D&&(i=D.isInputVisual,c=D.isOutputVisual,l=D.isInputRtl,d=D.isOutputRtl,u=D.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var i=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(i=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?i.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):i.push([r.doBidiReorder(s[l])]);n.text=i}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(Wn),Wn.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Ih(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new JQe(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new LQe(this.contents),this.head=new $Qe(this),this.name=new VQe(this),this.cmap=new lae(this),this.toUnicode={},this.hhea=new BQe(this),this.maxp=new WQe(this),this.hmtx=new HQe(this),this.post=new zQe(this),this.os2=new qQe(this),this.loca=new YQe(this),this.glyf=new GQe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var i,l,c,d;for(d=[],i=0,l=(c=this.bbox).length;i<l;i++)t=c[i],d.push(Math.round(t*this.scaleFactor));return d}.call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,o,i,l;for(i=0,o=0,l=(t=""+t).length;0<=l?o<l:o>l;o=0<=l?++o:--o)s=t.charCodeAt(o),i+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return i*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var xu,Ih=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,o,i,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),i=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^o)+65536*(255^i)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*o+65536*i+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,o;for(o=[],n=0,s=t.length;n<s;n++)r=t[n],o.push(this.writeByte(r));return o},e}(),LQe=function(){var e;function t(r){var n,s,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,o=this.tableCount;0<=o?s<o:s>o;s=0<=o?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,o,i,l,c,d,u,f,h,m,v,g;for(g in m=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(m)/c),i=Math.floor(f/c),u=16*m-f,(s=new Ih).writeInt(this.scalarType),s.writeShort(m),s.writeShort(f),s.writeShort(i),s.writeShort(u),o=16*m,d=s.pos+o,l=null,v=[],r)for(h=r[g],s.writeString(g),s.writeInt(e(h)),s.writeInt(d),s.writeInt(h.length),v=v.concat(h),g==="head"&&(l=d),d+=h.length;d%4;)v.push(0),d++;return s.write(v),n=2981146554-e(s.data),s.pos=l+8,s.writeUInt32(n),s.data},e=function(r){var n,s,o,i;for(r=cae.call(r);r.length%4;)r.push(0);for(o=new Ih(r),s=0,n=0,i=r.length;n<i;n=n+=4)s+=o.readUInt32();return 4294967295&s},t}(),FQe={}.hasOwnProperty,nf=function(e,t){for(var r in t)FQe.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};xu=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var $Qe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Ih).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),$9=function(){function e(t,r){var n,s,o,i,l,c,d,u,f,h,m,v,g,y,x,b,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(m=t.readUInt16(),h=m/2,t.pos+=6,o=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),t.pos+=2,g=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),d=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),u=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),s=(this.length-t.pos+this.offset)/2,l=function(){var j,_;for(_=[],c=j=0;0<=s?j<s:j>s;c=0<=s?++j:--j)_.push(t.readUInt16());return _}(),c=x=0,w=o.length;x<w;c=++x)for(y=o[c],n=b=v=g[c];v<=y?b<=y:b>=y;n=v<=y?++b:--b)u[c]===0?i=n+d[c]:(i=l[u[c]/2+(n-v)-(h-c)]||0)!==0&&(i+=d[c]),this.codeMap[n]=65535&i}t.pos=f}return e.encode=function(t,r){var n,s,o,i,l,c,d,u,f,h,m,v,g,y,x,b,w,j,_,C,P,E,A,F,D,I,R,M,U,z,W,$,ee,ve,_e,K,q,Y,J,fe,Z,ce,le,ie,te,ue;switch(M=new Ih,i=Object.keys(t).sort(function(Te,ne){return Te-ne}),r){case"macroman":for(g=0,y=function(){var Te=[];for(v=0;v<256;++v)Te.push(0);return Te}(),b={0:0},o={},U=0,ee=i.length;U<ee;U++)b[le=t[s=i[U]]]==null&&(b[le]=++g),o[s]={old:t[s],new:b[t[s]]},y[s]=b[t[s]];return M.writeUInt16(1),M.writeUInt16(0),M.writeUInt32(12),M.writeUInt16(0),M.writeUInt16(262),M.writeUInt16(0),M.write(y),{charMap:o,subtable:M.data,maxGlyphID:g+1};case"unicode":for(I=[],f=[],w=0,b={},n={},x=d=null,z=0,ve=i.length;z<ve;z++)b[_=t[s=i[z]]]==null&&(b[_]=++w),n[s]={old:_,new:b[_]},l=b[_]-s,x!=null&&l===d||(x&&f.push(x),I.push(s),d=l),x=s;for(x&&f.push(x),f.push(65535),I.push(65535),F=2*(A=I.length),E=2*Math.pow(Math.log(A)/Math.LN2,2),h=Math.log(E/2)/Math.LN2,P=2*A-E,c=[],C=[],m=[],v=W=0,_e=I.length;W<_e;v=++W){if(D=I[v],u=f[v],D===65535){c.push(0),C.push(0);break}if(D-(R=n[D].new)>=32768)for(c.push(0),C.push(2*(m.length+A-v)),s=$=D;D<=u?$<=u:$>=u;s=D<=u?++$:--$)m.push(n[s].new);else c.push(R-D),C.push(0)}for(M.writeUInt16(3),M.writeUInt16(1),M.writeUInt32(12),M.writeUInt16(4),M.writeUInt16(16+8*A+2*m.length),M.writeUInt16(0),M.writeUInt16(F),M.writeUInt16(E),M.writeUInt16(h),M.writeUInt16(P),Z=0,K=f.length;Z<K;Z++)s=f[Z],M.writeUInt16(s);for(M.writeUInt16(0),ce=0,q=I.length;ce<q;ce++)s=I[ce],M.writeUInt16(s);for(ie=0,Y=c.length;ie<Y;ie++)l=c[ie],M.writeUInt16(l);for(te=0,J=C.length;te<J;te++)j=C[te],M.writeUInt16(j);for(ue=0,fe=m.length;ue<fe;ue++)g=m[ue],M.writeUInt16(g);return{charMap:n,subtable:M.data,maxGlyphID:w+1}}},e}(),lae=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new $9(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,s;return r==null&&(r="macroman"),n=$9.encode(t,r),(s=new Ih).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e}(),BQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),qQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),zQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var o;for(n=t.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=function(){var i,l,c;for(c=[],o=i=0,l=this.file.maxp.numGlyphs;0<=l?i<l:i>l;o=0<=l?++i:--i)c.push(t.readUInt32());return c}.call(this)}},e}(),UQe=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},VQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,s,o,i,l,c,d,u,f,h;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},o=u=0,f=n.length;u<f;o=++u)s=n[o],t.pos=s.offset,d=t.readString(s.length),i=new UQe(d,s),c[h=s.nameID]==null&&(c[h]=[]),c[s.nameID].push(i);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),WQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),HQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,s,o,i,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],r=d=0;0<=s?d<s:d>s;r=0<=s?++d:--d)u.push(t.readInt16());return u}(),this.widths=function(){var d,u,f,h;for(h=[],d=0,u=(f=this.metrics).length;d<u;d++)o=f[d],h.push(o.advance);return h}.call(this),n=this.widths[this.widths.length-1],c=[],r=i=0;0<=s?i<s:i>s;r=0<=s?++i:--i)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),cae=[].slice,GQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,s,o,i,l,c,d,u,f;return t in this.cache?this.cache[t]:(o=this.file.loca,r=this.file.contents,n=o.indexOf(t),(s=o.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,i=(l=new Ih(r.read(s))).readShort(),d=l.readShort(),f=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[t]=i===-1?new XQe(l,d,f,c,u):new KQe(l,i,d,f,c,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var s,o,i,l,c;for(i=[],o=[],l=0,c=r.length;l<c;l++)s=t[r[l]],o.push(i.length),s&&(i=i.concat(s.encode(n)));return o.push(i.length),{table:i,offsets:o}},e}(),KQe=function(){function e(t,r,n,s,o,i){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=o,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),XQe=function(){function e(t,r,n,s,o){var i,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;l=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&l;)i.pos+=1&l?4:2,128&l?i.pos+=8:64&l?i.pos+=4:8&l&&(i.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Ih(cae.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),YQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nf(e,xu),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=2)o.push(2*t.readUInt16());return o}.call(this):function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=4)o.push(t.readUInt32());return o}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),s=0,o=0,i=0;i<n.length;++i)if(n[i]=s,o<r.length&&r[o]==i){++o,n[i]=s;var l=this.offsets[i],c=this.offsets[i+1]-l;c>0&&(s+=c)}for(var d=new Array(4*n.length),u=0;u<n.length;++u)d[4*u+3]=255&n[u],d[4*u+2]=(65280&n[u])>>8,d[4*u+1]=(16711680&n[u])>>16,d[4*u]=(4278190080&n[u])>>24;return d},e}(),JQe=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,o;for(r in s=this.font.cmap.tables[0].codeMap,t={},o=this.subset)n=o[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,o,i,l,c;for(s={},i=0,l=t.length;i<l;i++)s[o=t[i]]=this.font.glyf.glyphFor(o);for(o in r=[],s)(n=s[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in c=this.glyphsFor(r))n=c[o],s[o]=n;return s},e.prototype.encode=function(t,r){var n,s,o,i,l,c,d,u,f,h,m,v,g,y,x;for(s in n=lae.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(t),m={0:0},x=n.charMap)m[(c=x[s]).old]=c.new;for(v in h=n.maxGlyphID,i)v in m||(m[v]=h++);return u=function(b){var w,j;for(w in j={},b)j[b[w]]=w;return j}(m),f=Object.keys(u).sort(function(b,w){return b-w}),g=function(){var b,w,j;for(j=[],b=0,w=f.length;b<w;b++)l=f[b],j.push(u[l]);return j}(),o=this.font.glyf.encode(i,g,m),d=this.font.loca.encode(o.offsets,g),y={cmap:this.font.cmap.raw(),glyf:o.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Wn.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,o,i;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(t.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in o=["<<"],r)i=r[s],o.push("/"+s+" "+t.convert(i));return o.push(">>"),o.join(`
`)}return""+r},t}();const QQe=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:PQe,AcroFormAppearance:Fn,AcroFormButton:Ho,AcroFormCheckBox:xb,AcroFormChoiceField:Hp,AcroFormComboBox:Kp,AcroFormEditBox:gb,AcroFormListBox:Gp,AcroFormPasswordField:yb,AcroFormPushButton:vb,AcroFormRadioButton:Xp,AcroFormTextField:gh,GState:Gw,ShadingPattern:$m,TilingPattern:Mp,default:Wn,jsPDF:Wn},Symbol.toStringTag,{value:"Module"})),Ao=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,s]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${s}`},Ci=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function ZQe({setIsModalOpen:e,setBookings:t,form:r,setForm:n,localCustomers:s,onOpenClientModal:o,onClientModalSuccess:i}){const{toast:l}=as(),{userProfile:c}=vs(),{loadAlerts:d}=PC(),{isPaymentModalOpen:u,closePaymentModal:f,editingBooking:h,paymentTotal:m,setPaymentTotal:v,participantsForm:g,setParticipantsForm:y,payMethods:x,openEditParticipantModal:b,protectPaymentModal:w,onParticipantReplacedRef:j,lastVisibilityChangeTime:_,isModalProtected:C}=eN();window.__protectPaymentModal=w,p.useEffect(()=>(u&&(document.body.style.overflow="auto",document.body.style.pointerEvents="auto"),()=>{document.body.style.overflow="",document.body.style.pointerEvents=""}),[u]);const[P,E]=p.useState(""),[A,F]=p.useState([]);p.useState(null);const[D,I]=p.useState(null),[R,M]=p.useState(!1),[U,z]=p.useState(""),[W,$]=p.useState(!1),[ee,ve]=p.useState([]);p.useState(null);const[_e,K]=p.useState(0),[q,Y]=p.useState(!1),[J,fe]=p.useState(""),[Z,ce]=p.useState([]),[le,ie]=p.useState([]),te=p.useRef({}),ue=p.useRef({}),Te=p.useRef({}),[ne,de]=p.useState(null),[lt,Nt]=p.useState(null),[at,gt]=p.useState(!1),[Pt,yt]=p.useState("downloading"),[Qe,ge]=p.useState(0),[rt,pt]=p.useState(null),[We,Ze]=p.useState(""),[Ne,ye]=p.useState(null),Be=p.useRef(null),mt=p.useRef(null),Ft=p.useRef(null),fr=p.useRef(null),It=p.useRef([]),Ut=p.useRef(null),xe=p.useRef(null),st=p.useRef(null),Ct=p.useRef(!1),[ar,pr]=p.useState(!1),Xt=p.useRef(null),yr=p.useRef([]),[lr,Rr]=p.useState({isOpen:!1,participantIndex:null,currentStatus:null}),Pn=p.useRef(!1),De=p.useCallback((ot,$t)=>{ie(Yt=>{const Ht=[...Yt];return ot>=0&&ot<Ht.length&&($t===""&&Ht[ot].nome?Te.current[ot]=Ht[ot].nome:$t!==""&&delete Te.current[ot],Ht[ot]={...Ht[ot],nome:$t}),y(Ht),Ht})},[y]),ke=p.useCallback(ot=>{const $t=Te.current[ot];$t&&(ie(Yt=>{const Ht=[...Yt];return ot>=0&&ot<Ht.length&&(Ht[ot]={...Ht[ot],nome:$t}),delete Te.current[ot],y(Ht),Ht}),setTimeout(()=>{te.current[ot]?.focus()},0))},[y]),Ge=p.useCallback((ot,$t,Yt)=>{if($t==="Pago"){const Ht=Ci(Yt);if(Number.isFinite(Ht)&&Ht>0)return}Pn.current=!0,console.log(" [StatusConfirmation] Modal protegido por 3 segundos"),setTimeout(()=>{Pn.current=!1,console.log(" [StatusConfirmation] Proteo removida")},3e3),Rr({isOpen:!0,participantIndex:ot,currentStatus:$t})},[]),Re=p.useCallback(ot=>{const{participantIndex:$t}=lr;$t!==null&&(ie(Yt=>{const Ht=[...Yt];return $t>=0&&$t<Ht.length&&(Ht[$t]={...Ht[$t],status_pagamento:ot}),y(Ht),Ht}),Ct.current=!0,xe.current&&clearTimeout(xe.current),xe.current=setTimeout(()=>{console.log(" [StatusChange] Salvando mudana de status...")},100),setTimeout(()=>{console.log(" [StatusChange] Recarregando alertas..."),d().catch(Yt=>{console.error(" [StatusChange] Erro ao recarregar alertas:",Yt)})},500)),Rr({isOpen:!1,participantIndex:null,currentStatus:null})},[lr,y,d]),bt=p.useCallback(ot=>!s||!Array.isArray(s)?!1:s.find(Yt=>Yt.id===ot)?.is_consumidor_final===!0,[s]),Qt=p.useCallback(()=>{const ot=A||[],$t=(le||[]).map((Ot,Xr)=>({...Ot,_originalIndex:Xr})).filter(Ot=>!ot.includes(Ot._originalIndex)),Yt=$t.find(Ot=>bt(Ot.cliente_id)&&Ot.nome&&Ot.nome.toLowerCase().includes("cliente consumidor"));return Yt?Yt._originalIndex:$t.find(Ot=>bt(Ot.cliente_id)&&Ot.nome)?._originalIndex??null},[le,A,bt]),ct=p.useCallback(ot=>{const $t=A||[],Ht=(le||[]).map((Xr,Je)=>({...Xr,_originalIndex:Je})).filter(Xr=>!$t.includes(Xr._originalIndex)).filter(Xr=>bt(Xr.cliente_id));if(Ht.length===0)return null;const Ot=Ht.findIndex(Xr=>Xr._originalIndex===ot);return Ot!==-1?Ot<Ht.length-1?Ht[Ot+1]._originalIndex:Ht[0]._originalIndex:null},[le,A,bt]),xt=p.useCallback(ot=>{const $t=A||[],Ht=(le||[]).map((Xr,Je)=>({...Xr,_originalIndex:Je})).filter(Xr=>!$t.includes(Xr._originalIndex)).filter(Xr=>bt(Xr.cliente_id)),Ot=Ht.findIndex(Xr=>Xr._originalIndex===ot);return Ot>0?Ht[Ot-1]._originalIndex:null},[le,A,bt]),it=p.useCallback(()=>{if(!x||x.length===0)return null;const ot=x.find($t=>$t.codigo_interno==="01");return ot||x[0]},[x]),kt=p.useMemo(()=>{const ot=le||[],$t=A||[];return ot.filter((Yt,Ht)=>!$t.includes(Ht)).length},[le,A]),be=p.useMemo(()=>{const ot=le||[],$t=A||[],Yt=ot.filter((Tt,Dr)=>!$t.includes(Dr)),Ht=Ci(m);let Ot=0,Xr=0,Je=0,cr=!1;Yt.forEach(Tt=>{let Dr=Ci(Tt?.valor_cota);if(Tt?.aplicar_taxa===!0&&Number.isFinite(Dr)){const Nr=x.find(Fr=>String(Fr.id)===String(Tt.finalizadora_id)),St=Number(Nr?.taxa_percentual||0);St>0&&(Dr=Dr/(1+St/100),cr=!0)}Number.isFinite(Dr)&&(Ot+=Dr),(Tt?.status_pagamento||"Pendente")==="Pago"?Xr++:Je++});const vt=Number.isFinite(Ht)?Ot-Ht:0;return{totalTarget:Ht,totalAssigned:Ot,diff:vt,paid:Xr,pending:Je,temTaxaAplicada:cr}},[le,A,m,x]),dt=()=>{const ot=Ci(m);if(!Number.isFinite(ot)||kt===0)return;const $t=ot/kt,Yt=Ao(String($t.toFixed(2)));ie(Ht=>{const Ot=[...Ht];return Ot.forEach((Xr,Je)=>{Ot[Je]={...Ot[Je],valor_cota:Yt,status_pagamento:"Pago",aplicar_taxa:!1}}),Ot})},Lt=()=>{ie(ot=>{const $t=[...ot];return $t.forEach((Yt,Ht)=>{$t[Ht]={...$t[Ht],valor_cota:"",status_pagamento:"Pendente",aplicar_taxa:!1}}),$t})},mr=()=>{ie(ot=>{const $t=[...ot];return $t.forEach((Yt,Ht)=>{const Ot=Ci(Yt.valor_cota);if(Ot>0){const Je=x.find(vt=>String(vt.id)===String(Yt.finalizadora_id)),cr=Number(Je?.taxa_percentual||0);if(cr>0&&!Yt.aplicar_taxa){const vt=Ot*(1+cr/100);$t[Ht]={...$t[Ht],aplicar_taxa:!0,valor_cota:Ao(vt.toFixed(2))}}}}),$t})},tr=(ot,$t)=>{b(ot,$t)},Or=()=>{fe(m||""),Y(!0)},Lr=()=>{v(J),Y(!1)},sr=()=>{fe(""),Y(!1)},fn=async(ot={})=>{const{autoSave:$t=!1}=ot;try{if(R)return;M(!0);const Yt=h?.id,Ht=c?.codigo_empresa;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [SAVE-PAYMENTS] Iniciando salvamento",{autoSave:$t,agendamentoId:Yt,timestamp:new Date().toISOString()})}catch{}if(!Yt||!Ht){l({title:"Erro ao salvar pagamentos",description:"Agendamento ou empresa indisponvel.",variant:"destructive"});return}const Ot=(le||[]).filter((St,Fr)=>!(A||[]).includes(Fr)),Xr=Ot.reduce((St,Fr)=>{const zr=Fr.status_pagamento||"Pendente";return St+(zr!=="Pago"?1:0)},0);try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Dados a salvar:",{totalParticipantes:Ot.length,pendentes:Xr}),console.log("[ORDER-SAVE] savingIds:",Ot.map(St=>St.cliente_id)))}catch{}const Je=new Date().toISOString();try{localStorage.getItem("debug:agenda")==="1"&&console.log(`

========== SALVAMENTO INICIADO ${Je} ==========`)}catch{}const{data:cr,error:vt}=await he.from("agendamento_participantes").select("*").eq("codigo_empresa",Ht).eq("agendamento_id",Yt).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(vt)throw console.error(" Erro ao buscar participantes originais:",vt),vt;try{localStorage.getItem("debug:agenda")==="1"&&(console.log(` Participantes originais no banco: ${cr?.length||0}`),console.log("[ORDER-SAVE] originalIds:",(cr||[]).map(St=>St.cliente_id)))}catch{}Ot.forEach((St,Fr)=>{console.log(`  #${Fr+1} (novo): ${St.nome}`)}),console.log(" Fazendo substituio inteligente por posio");for(let St=0;St<cr.length;St++){const Fr=cr[St],zr=Ot[St];if(!zr){console.log(` Posio #${St+1}: Sem participante novo, pulando update`);continue}const ha=Ci(zr.valor_cota),En=it(),ae=zr.finalizadora_id||(En?.id?String(En.id):null);console.log(` Atualizando posio #${St+1}: ${Fr.nome}  ${zr.nome}`);const{error:Me}=await he.from("agendamento_participantes").update({cliente_id:zr.cliente_id,nome:zr.nome,valor_cota:Number.isFinite(ha)?ha:0,status_pagamento:zr.status_pagamento||"Pendente",finalizadora_id:ae,aplicar_taxa:zr.aplicar_taxa||!1,ordem:St+1}).eq("id",Fr.id);if(Me)throw console.error(` Erro ao atualizar posio #${St+1}:`,Me),Me}const Tt=cr.length;if(Ot.length<Tt){const St=cr.slice(Ot.length).map(Fr=>Fr.id);if(St.length>0){console.log(" Removendo participantes excedentes:",St.length);const{error:Fr}=await he.from("agendamento_participantes").delete().in("id",St).eq("codigo_empresa",Ht).eq("agendamento_id",Yt);if(Fr)throw console.error(" Erro ao remover participantes excedentes:",Fr),Fr}}if(Ot.length>Tt){console.log(" Inserindo participantes adicionais:",Ot.length-Tt);const St=Ot.slice(Tt).map((zr,ha)=>{const En=Ci(zr.valor_cota),ae=it(),Me=zr.finalizadora_id||(ae?.id?String(ae.id):null);return{codigo_empresa:Ht,agendamento_id:Yt,cliente_id:zr.cliente_id,nome:zr.nome,valor_cota:Number.isFinite(En)?En:0,status_pagamento:zr.status_pagamento||"Pendente",finalizadora_id:Me,aplicar_taxa:zr.aplicar_taxa||!1,ordem:Tt+ha+1}}),{error:Fr}=await he.from("agendamento_participantes").insert(St);if(Fr)throw console.error(" Erro ao inserir novos participantes:",Fr),Fr}console.log(" Substituio inteligente concluda"),console.log(`========== SALVAMENTO CONCLUDO ==========

`);const Dr=Ot.map(St=>({id:St.cliente_id,nome:St.nome,codigo:St.codigo!==null&&St.codigo!==void 0?St.codigo:null})),an=Dr[0]||null,Nr=Dr.map(St=>St?.nome).filter(Boolean);await he.from("agendamentos").update({cliente_id:an?.id??null,clientes:Nr}).eq("codigo_empresa",Ht).eq("id",Yt),n(St=>({...St,selectedClients:Dr})),t(St=>St.map(Fr=>Fr.id===Yt?{...Fr,customer:an?.nome||Fr.customer,cliente_id:an?.id??null,clientes:Nr}:Fr)),ie(Ot),F([]),$t||(Xr>0?l({title:"Pagamentos salvos",description:`${Xr} ${Xr===1?"pendente":"pendentes"}`,variant:"warning"}):l({title:"Pagamentos salvos",variant:"success"})),I(null),y(Ot);try{window.dispatchEvent(new CustomEvent("payments:saved",{detail:{agendamentoId:Yt,participants:Ot}}))}catch{}d().catch(St=>{console.error("[PaymentModal] Erro ao recarregar alertas:",St)});try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Salvamento concludo com sucesso"),console.log(" [SAVE-PAYMENTS] Contagem final de pendentes:",Xr))}catch{}console.log(" [LOG 2 - FECHAR PAYMENT MODAL] Dados salvos no banco:"),console.log("   Total:",Ot.length),console.log("   Pendentes:",Xr),Ot.forEach((St,Fr)=>{console.log(`   #${Fr+1}: ${St.nome} | Status: ${St.status_pagamento} | Valor: ${St.valor_cota}`)}),$t?console.log(" [SAVE-PAYMENTS] Auto-save concludo - modal permanece aberto"):(console.log(" [SAVE-PAYMENTS] Fechando modal de pagamentos (no  auto-save)"),f(),e(!1))}catch(Yt){console.error(" [SAVE-PAYMENTS] Erro ao salvar:",Yt),l({title:"Erro ao salvar pagamentos",description:"Tente novamente.",variant:"destructive"})}finally{M(!1)}};p.useEffect(()=>{const ot=$t=>{if(u&&!W&&!at&&($t.key==="Escape"&&($t.preventDefault(),console.log(" [Auto-save Payments] Salvando ao fechar modal (ESC)..."),xe.current&&clearTimeout(xe.current),fn({autoSave:!0}).then(()=>{console.log(" [Auto-save Payments] Salvo ao fechar (ESC)!"),f()}).catch(Yt=>{console.error(" [Auto-save Payments] Erro ao salvar ao fechar (ESC):",Yt),f()})),$t.key==="F8"&&($t.preventDefault(),m&&kt>0&&dt()),$t.key==="F9"&&($t.preventDefault(),kt>0&&mr()),$t.key==="F10"&&($t.preventDefault(),kt>0&&Lt()),$t.key==="Delete")){const Yt=document.activeElement;if(!(Yt&&Yt.tagName==="INPUT")){$t.preventDefault();const Ot=Qt();Ot!==null&&(De(Ot,""),setTimeout(()=>{te.current[Ot]?.focus()},0))}}};return window.addEventListener("keydown",ot),()=>window.removeEventListener("keydown",ot)},[u,W,at,m,kt,dt,mr,Lt,R,fn,f,le,A,bt,De,Qt]),p.useEffect(()=>{if(u){const ot=Qt();de(ot)}},[u,le,A,Qt]),p.useEffect(()=>{if(u){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Modal aberto - payMethods:",x?.length||0,"initializedRef:",mt.current)}catch{}Ft.current=setTimeout(()=>{try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Timeout de 3s acionado - initializedRef:",mt.current,"payMethods:",x?.length||0)}catch{}if(!mt.current&&(!x||x.length===0)){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Inicializando com timeout (sem finalizadoras)")}catch{}const ot=(r?.selectedClients||[]).map($t=>{let Yt=$t.codigo;if(Yt==null&&s&&Array.isArray(s)){const Ht=s.find(Ot=>Ot.id===$t.id);Yt=Ht?.codigo!==null&&Ht?.codigo!==void 0?Ht.codigo:null}return{cliente_id:$t.id,nome:$t.nome,codigo:Yt,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:null,aplicar_taxa:!1}});ie(ot),mt.current=Date.now()}},3e3),!mt.current&&x&&x.length>0&&(Ft.current&&(clearTimeout(Ft.current),Ft.current=null),(async()=>{const{defaultMethod:$t,defaultFinalizadoraId:Yt,defaultAplicarTaxa:Ht}=(()=>{const cr=it(),vt=cr?.id?String(cr.id):null,Tt=Number(cr?.taxa_percentual||0)>0;return{defaultMethod:cr,defaultFinalizadoraId:vt,defaultAplicarTaxa:Tt}})();let Ot=[],Xr="nenhuma";if(h?.id)try{const{data:cr,error:vt}=await he.from("agendamento_participantes").select("*").eq("agendamento_id",h.id).eq("codigo_empresa",c?.codigo_empresa).order("ordem",{ascending:!0}).order("id",{ascending:!0});vt?console.error(" Erro ao buscar participantes:",vt):cr&&cr.length>0?(Ot=cr.map(Tt=>({cliente_id:Tt.cliente_id,nome:Tt.nome,codigo:null,valor_cota:Tt.valor_cota?Ao(String(Number(Tt.valor_cota).toFixed(2))):"0,00",status_pagamento:Tt.status_pagamento||"Pendente",finalizadora_id:Tt.finalizadora_id?String(Tt.finalizadora_id):Yt,aplicar_taxa:Tt.aplicar_taxa||!1})),Xr="banco de dados"):Xr="banco vazio"}catch(cr){console.error(" Erro ao buscar participantes:",cr)}Ot.length===0&&g&&g.length>0?(Ot=g,Xr="participantsForm (contexto)"):Ot.length===0&&r?.selectedClients&&r.selectedClients.length>0&&(Ot=(r?.selectedClients||[]).map(cr=>{let vt=cr.codigo;if(vt==null&&s&&Array.isArray(s)){const Tt=s.find(Dr=>Dr.id===cr.id);vt=Tt?.codigo!==null&&Tt?.codigo!==void 0?Tt.codigo:null}return{cliente_id:cr.id,nome:cr.nome,codigo:vt,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:Yt,aplicar_taxa:Ht}}),Xr="form.selectedClients");let Je=Ot.map(cr=>{let vt=cr.codigo;if(vt==null&&s&&Array.isArray(s)){const Dr=s.find(an=>an.id===cr.cliente_id);vt=Dr?.codigo!==null&&Dr?.codigo!==void 0?Dr.codigo:null}let Tt=cr.finalizadora_id;if(!Tt){const Dr=it();Tt=Dr?.id?String(Dr.id):null}return{...cr,codigo:vt??cr.codigo,finalizadora_id:Tt}});try{const cr=(r?.selectedClients||[]).slice();if(cr.length>0&&Je.length>0){const vt=new Map;Je.forEach(St=>{const Fr=vt.get(St.cliente_id)||[];Fr.push(St),vt.set(St.cliente_id,Fr)});const Tt=new Map,Dr=[];for(const St of cr){const Fr=Tt.get(St.id)||0,ha=(vt.get(St.id)||[])[Fr];if(ha)Dr.push(ha),Tt.set(St.id,Fr+1);else{const En=it(),ae=En?.id?String(En.id):null;Dr.push({cliente_id:St.id,nome:St.nome,codigo:St.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:ae,aplicar_taxa:Number(En?.taxa_percentual||0)>0})}}const an=new Map(Tt),Nr=[];vt.forEach((St,Fr)=>{const zr=an.get(Fr)||0;for(let ha=zr;ha<St.length;ha++)Nr.push(St[ha])}),Ot=Dr.concat(Nr);try{const St=Ot.findIndex(Fr=>String(Fr?.nome||"").toLowerCase()!=="cliente consumidor");if(St>0){const Fr=Ot.splice(St,1)[0];Ot.unshift(Fr),localStorage.getItem("debug:agenda")==="1"&&console.log("[REP] Promovido a representante:",Fr?.nome)}}catch{}Xr=Xr+" (reordenado pelos chips)"}}catch(cr){console.error("[PaymentModal] Falha ao reordenar por chips:",cr)}if(Je=Ot.map(cr=>{let vt=cr.codigo;if(vt==null&&s&&Array.isArray(s)){const Tt=s.find(Dr=>Dr.id===cr.cliente_id);vt=Tt?.codigo!==null&&Tt?.codigo!==void 0?Tt.codigo:null}return{...cr,codigo:vt??cr.codigo,finalizadora_id:cr.finalizadora_id||(()=>{const Tt=it();return Tt?.id?String(Tt.id):null})()}}),Je.length===0&&h?.id){console.error(" ALERTA CRTICO: Nenhum participante encontrado em NENHUMA fonte!"),console.error(" Agendamento ID:",h.id),console.error(" Empresa:",c?.codigo_empresa),console.error(" Isso pode indicar perda de dados!");try{const{data:cr,error:vt}=await he.from("agendamento_participantes").select("*").eq("agendamento_id",h.id);console.error(" Busca sem filtro de empresa:",{encontrados:cr?.length||0,dados:cr,erro:vt})}catch(cr){console.error(" Erro na busca de debug:",cr)}}if(Je.length>0||!h?.id){ie(Je),mt.current=Date.now();try{if(localStorage.getItem("debug:agenda")==="1"){console.log(" [LOG 1 - ABRIR PAYMENT MODAL] Participantes carregados:"),console.log("   Total:",Je.length),console.log("   Fonte:",Xr),Je.forEach((Tt,Dr)=>{console.log(`   #${Dr+1}: ${Tt.nome} | Status: ${Tt.status_pagamento} | Valor: ${Tt.valor_cota}`)});const cr=(r?.selectedClients||[]).map(Tt=>Tt.id),vt=Je.map(Tt=>Tt.cliente_id);console.log("[ORDER] chipsIds:",cr),console.log("[ORDER] finalIds:",vt)}}catch{}}else console.error(" BLOQUEADO: No vou sobrescrever com array vazio!"),console.error(" Mantendo dados anteriores para evitar perda.")})())}else Ft.current&&(clearTimeout(Ft.current),Ft.current=null),E(""),I(null),F([]),ie([]);return()=>{Ft.current&&clearTimeout(Ft.current)}},[u,x,it,g,r?.selectedClients,s]),p.useEffect(()=>{if(!u)return;const ot=(le||[]).length;if(Xt.current==null){Xt.current=ot,yr.current=Array.isArray(le)?le:[];return}const $t=ot<Xt.current;let Yt=[];try{const Ht=Array.isArray(yr.current)?yr.current:[],Ot=Array.isArray(le)?le:[],Xr=cr=>`${cr?.cliente_id??""}|${(cr?.nome??"").toLowerCase()}`,Je=new Set(Ot.map(Xr));Yt=Ht.filter(cr=>!Je.has(Xr(cr)))}catch{}Xt.current=ot,yr.current=Array.isArray(le)?le:[],$t&&h?.id&&(xe.current&&(clearTimeout(xe.current),xe.current=null),Ct.current=!0,(async()=>{try{const Ht=Yt.map(Xr=>Xr?.nome).filter(Boolean),Ot=Yt.length;console.log(" [PaymentModal] Participante(s) removido(s):",Ht),console.log(" [Auto-save imediato] Remoo detectada, salvando agora...");try{window.dispatchEvent(new CustomEvent("payments:participant-removed",{detail:{agendamentoId:h?.id,removed:Yt}}))}catch{}await fn({autoSave:!0}),console.log(" [Auto-save imediato] Remoo salva")}catch(Ht){console.error(" [Auto-save imediato] Erro ao salvar aps remoo:",Ht)}})())},[u,le,h?.id,fn]),p.useEffect(()=>{if(!u)return;const ot=p.useRef.__prevHidden=p.useRef.__prevHidden||{len:0},$t=(A||[]).length,Yt=$t>(ot.len||0);if(ot.len=$t,Yt&&h?.id){try{console.log(" [PaymentModal] ndices ocultados (remoo lgica):",A)}catch{}xe.current&&(clearTimeout(xe.current),xe.current=null),Ct.current=!0,fn({autoSave:!0}).catch(Ht=>console.error(" [PaymentModal] Erro ao salvar remoo imediata:",Ht))}},[A,u,h?.id,fn]),p.useEffect(()=>{mt.current=null},[h?.id]),p.useEffect(()=>(j.current=ot=>{ce([ot]),setTimeout(()=>{ce([])},1e3)},()=>{j.current=null}),[j]);const Tn=p.useCallback(ot=>{ie(ot)},[]);p.useEffect(()=>(u&&(y.updateLocal=Tn,y.getLocal=()=>le),()=>{y.updateLocal&&(delete y.updateLocal,delete y.getLocal)}),[u,Tn,le]),p.useLayoutEffect(()=>{if(!u)return;const ot=(r?.selectedClients||[]).slice();if(ot.length!==0&&!(!le||le.length===0))try{const $t=new Map;le.forEach(vt=>{const Tt=$t.get(vt.cliente_id)||[];Tt.push(vt),$t.set(vt.cliente_id,Tt)});const Yt=new Map,Ht=[];for(const vt of ot){const Tt=Yt.get(vt.id)||0,an=($t.get(vt.id)||[])[Tt];an?(Ht.push(an),Yt.set(vt.id,Tt+1)):Ht.push({cliente_id:vt.id,nome:vt.nome,codigo:vt.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:it()?.id?String(it().id):null,aplicar_taxa:Number(it()?.taxa_percentual||0)>0})}const Ot=new Map(Yt),Xr=[];$t.forEach((vt,Tt)=>{const Dr=Ot.get(Tt)||0;for(let an=Dr;an<vt.length;an++)Xr.push(vt[an])});const Je=Ht.concat(Xr);if(Je.length!==le.length||Je.some((vt,Tt)=>vt.cliente_id!==le[Tt]?.cliente_id||vt.nome!==le[Tt]?.nome)){try{if(localStorage.getItem("debug:agenda")==="1"){const vt=ot.map(Dr=>Dr.nome),Tt=Je.map(Dr=>Dr.nome);console.log("[ORDER] chipsNames:",vt),console.log("[ORDER] finalNames (next):",Tt)}}catch{}ie(Je)}}catch($t){console.error("[PaymentModal] Falha ao reordenar aps mudana de chips:",$t)}},[u,r?.selectedClients]),p.useEffect(()=>{W||(ve([]),z("")),K(0)},[W]),p.useEffect(()=>{W&&It.current[_e]&&It.current[_e]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[_e,W]),p.useEffect(()=>{const ot=$t=>{if(W&&($t.key==="Escape"&&($t.preventDefault(),$(!1),z(""),ve([])),$t.key==="Enter"&&$t.target.tagName!=="INPUT"&&ee.length>0)){$t.preventDefault();const Yt=ee.map(Ht=>({cliente_id:Ht.id,nome:Ht.nome,codigo:Ht.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const Ot=it();return Ot?.id?String(Ot.id):null})(),aplicar_taxa:(()=>{const Ot=it();return Number(Ot?.taxa_percentual||0)>0})()}));ie(Ht=>{const Ot=Ht.length,Xr=Yt.map((Je,cr)=>Ot+cr);return ce(Xr),setTimeout(()=>{ce([])},1e3),[...Ht,...Yt]}),$(!1),ve([]),z("")}};return window.addEventListener("keydown",ot),()=>window.removeEventListener("keydown",ot)},[W,ee,it,ie,l,z,$,ve]),p.useEffect(()=>{const ot=async()=>{try{if(!u)return;xe.current&&(clearTimeout(xe.current),xe.current=null),R||await fn({autoSave:!0})}catch($t){console.error("[PaymentModal] save-and-close erro:",$t)}finally{f();try{window.dispatchEvent(new Event("paymentmodal:closed"))}catch{}}};return window.addEventListener("paymentmodal:save-and-close",ot),()=>window.removeEventListener("paymentmodal:save-and-close",ot)},[u,fn,f]),p.useEffect(()=>{if(!u){console.log(" [AUTO-SAVE] Modal de pagamentos fechado - desabilitando auto-save"),console.log(" [AUTO-SAVE] Estado final ao fechar:",{localParticipantsForm:le.map($t=>({nome:$t.nome,status:$t.status_pagamento,valor:$t.valor_cota})),timestamp:new Date().toISOString()}),Ct.current=!1,st.current=null;return}if(!Ct.current){console.log(" [AUTO-SAVE] Inicializando auto-save (aguardando 500ms)");const $t=setTimeout(()=>{Ct.current=!0,st.current=JSON.stringify(le),console.log(" [AUTO-SAVE] Auto-save habilitado")},500);return()=>clearTimeout($t)}const ot=JSON.stringify(le);if(ot!==st.current)return console.log(" [AUTO-SAVE] Mudana detectada - agendando salvamento em 1.5s"),xe.current&&(console.log(" [AUTO-SAVE] Cancelando auto-save anterior"),clearTimeout(xe.current)),xe.current=setTimeout(async()=>{console.log(" [AUTO-SAVE] Iniciando auto-save AGORA"),console.log(" [AUTO-SAVE] Participantes a salvar:",le.length),pr(!0);try{await fn({autoSave:!0}),st.current=ot,console.log(" [AUTO-SAVE] Salvo com sucesso!")}catch($t){console.error(" [AUTO-SAVE] Erro ao salvar:",$t)}finally{pr(!1)}},1500),()=>{xe.current&&clearTimeout(xe.current)}},[u,le,fn]),p.useEffect(()=>{!at&&Ne&&(console.log(" [PDF] Revogando URL do blob ao fechar modal"),URL.revokeObjectURL(Ne),ye(null))},[at,Ne]);const mn=p.useRef(null),zn=async()=>{try{if(console.log(" [PDF] Iniciando gerao do PDF"),!mn.current)throw new Error("Elemento do relatrio no encontrado");console.log(" [PDF] Abrindo modal de download"),Ne&&URL.revokeObjectURL(Ne),gt(!0),yt("downloading"),ge(0),pt(null),ye(null),Ze("");const ot=(le||[]).filter((ae,Me)=>!(A||[]).includes(Me)),$t=20,Yt=Math.ceil(ot.length/$t);ge(5);const Ht=new Wn({orientation:"landscape",unit:"mm",format:"a4",compress:!0}),Ot=297,Xr=210;for(let ae=0;ae<Yt;ae++){const Me=ae*$t,et=Math.min(Me+$t,ot.length),re=ot.slice(Me,et),O=10+Math.floor(ae/Yt*80);ge(O);const T=mn.current;if(!T)throw new Error("Elemento do relatrio no encontrado durante a gerao");console.log(` [PDF] Capturando pgina ${ae+1}/${Yt} (participantes ${Me+1}-${et})`);const X={visibility:T.style.visibility,opacity:T.style.opacity};T.style.visibility="visible",T.style.opacity="1",console.log(` [PDF] Elemento innerHTML length: ${T.innerHTML.length}`),console.log(` [PDF] Elemento scrollHeight: ${T.scrollHeight}`),console.log(` [PDF] Elemento scrollWidth: ${T.scrollWidth}`);const H=T.querySelector('div[style*="borderBottom"]'),L=T.querySelectorAll('div[style*="borderBottom"]')[1];ae>0?(H&&(H.style.display="none"),L&&(L.style.display="none")):(H&&(H.style.display="block"),L&&(L.style.display="flex"));const Fe=T.querySelectorAll("tbody tr");console.log(` [PDF] Total de linhas na tabela: ${Fe.length}`),Fe.forEach((Sr,Pr)=>{Sr.style.display=Pr>=Me&&Pr<et?"table-row":"none"});const nt=T.querySelector("#page-indicator");nt&&(nt.textContent=`Pgina ${ae+1} de ${Yt}`),console.log(" [PDF] Forando reflow..."),T.offsetHeight,T.getBoundingClientRect(),T.scrollHeight,T.offsetWidth,T.clientHeight,console.log(" [PDF] Aguardando renderizao..."),await new Promise(Sr=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(Sr,2e3)})})})}),console.log(" [PDF] Renderizao completa, iniciando captura...");const ft=T.querySelectorAll("tbody tr");if(console.log(` [PDF] Linhas da tabela encontradas: ${ft.length}`),ft.forEach((Sr,Pr)=>{const vr=Sr.querySelectorAll("td"),yn=Array.from(vr).map(On=>On.textContent.trim()).join(" | ");console.log(` [PDF] Linha ${Pr+1}: ${yn}`)}),ft.length===0){console.warn(" [PDF] AVISO: Nenhuma linha de tabela encontrada! Verificando estrutura...");const Sr=T.querySelector("tbody");console.log(" [PDF] tbody existe:",!!Sr),Sr&&console.log(" [PDF] innerHTML do tbody:",Sr.innerHTML.substring(0,500))}let Bt;try{const Sr=T.scrollHeight,Pr=T.scrollWidth;if(console.log(` [PDF] Dimenses reais: width=${Pr}px, height=${Sr}px`),Bt=await YKe(T,{pixelRatio:2,backgroundColor:"#ffffff",cacheBust:!0,skipFonts:!1}),!Bt||Bt.length===0)throw new Error("Canvas vazio retornado pela captura");console.log(` [PDF] Pgina ${ae+1} capturada (${Bt.length} bytes, ${Sr}px altura, ${ft.length} linhas)`)}catch(Sr){throw console.error(` [PDF] Erro ao capturar pgina ${ae+1}:`,Sr),T.style.visibility=X.visibility,T.style.opacity=X.opacity,new Error(`Falha ao capturar pgina ${ae+1}: ${Sr.message}`)}T.style.visibility=X.visibility,T.style.opacity=X.opacity,ae>0&&Ht.addPage();const $e=Ot,Dt=T.scrollHeight/T.scrollWidth*Ot;Ht.addImage(Bt,"PNG",0,0,$e,Dt,"","MEDIUM"),console.log(` [PDF] Pgina ${ae+1} adicionada ao PDF (${$e}mm x ${Dt}mm)`)}if(mn.current){mn.current.querySelectorAll("tbody tr").forEach(et=>{et.style.display="table-row"});const Me=mn.current.querySelector("#page-indicator");Me&&(Me.textContent="")}ge(95);const Je=Yt>1?` (${Yt} pginas)`:"",cr=(le||[]).filter((ae,Me)=>!(A||[]).includes(Me));let vt=cr.find(ae=>!s?.find(et=>et.id===ae.cliente_id)?.is_consumidor_final);!vt&&cr.length>0&&(vt=cr[0]);const Dr=(vt?.nome||"sem-nome").trim().split(/\s+/),an=Dr[0]||"sem",Nr=Dr.length>1?Dr[Dr.length-1]:"nome",Fr=`rel-${`${an}-${Nr}`.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+|-+$/g,"")}-${h?.code||"0"}${Je}.pdf`,zr=Ht.output("blob"),ha=URL.createObjectURL(zr);pt(zr),ye(ha),Ze(Fr),ge(100);const En=document.createElement("a");En.href=ha,En.download=Fr,En.click(),await new Promise(ae=>setTimeout(ae,500)),console.log(" [PDF] PDF gerado com sucesso! Modal de download deve permanecer aberto."),console.log(" [PDF] isPaymentModalOpen deve continuar true"),yt("success"),console.log(" [PDF] Status atualizado para success")}catch(ot){console.error(" [PDF] Erro ao gerar PDF:",ot),gt(!1),l({title:"Erro ao gerar PDF",description:ot?.message||"No foi possvel gerar o PDF.",variant:"destructive"})}};return a.jsxs(a.Fragment,{children:[a.jsx(xn,{open:u,onOpenChange:ot=>{if(console.log(" [PaymentModal] onOpenChange chamado:",{open:ot,isDownloadModalOpen:at}),!ot){if(console.log(" [PaymentModal] Tentando fechar modal de pagamentos"),at){console.log(" [PaymentModal] BLOQUEADO: Modal de download est aberto");return}console.log(" [PaymentModal] Fechando modal de pagamentos"),f()}},children:a.jsx(vn,{forceMount:!0,className:"w-full max-w-[95vw] sm:max-w-[1100px] max-h-[90vh] overflow-y-auto overflow-x-hidden",onOpenAutoFocus:ot=>ot.preventDefault(),onInteractOutside:async ot=>{const $t=Date.now(),Yt=mt.current?$t-mt.current:0,Ht=$t-_;if(console.log(" [PaymentModal] onInteractOutside disparado:",{target:ot.target?.tagName,className:ot.target?.className?.substring?.(0,50),timeSinceInit:`${Yt}ms`,timeSinceVisibility:`${Ht}ms`,isAddParticipantOpen:W,isDownloadModalOpen:at,statusConfirmationOpen:lr.isOpen,isModalProtected:C,timestamp:new Date().toISOString()}),lr.isOpen){console.log(" [PaymentModal] Bloqueado: modal de confirmao de status est aberto"),ot.preventDefault();return}if(at){console.log(" [PaymentModal] Bloqueado: modal de download est aberto"),ot.preventDefault();return}if(C){console.log(" [PaymentModal] Bloqueado: modal protegido (protectPaymentModal ativo)"),ot.preventDefault();return}if(W){console.log(" [PaymentModal] Bloqueado: modal de adicionar participante aberto"),ot.preventDefault();return}if(mt.current&&Yt<500){console.log(" [PaymentModal] Bloqueado: modal abriu recentemente"),ot.preventDefault();return}if(Ht<3e3){console.log(` [PaymentModal] Bloqueado: mudana de visibilidade recente (${Ht}ms atrs)`),ot.preventDefault();return}ot.preventDefault(),console.log(" [Auto-save Payments] Salvando ao clicar fora do modal...");try{if(xe.current&&(console.log(" [Auto-save Payments] Cancelando auto-save pendente antes de salvar ao clicar fora"),clearTimeout(xe.current),xe.current=null),R){console.log(" [Auto-save Payments] J est salvando - ignorando novo salvamento ao clicar fora"),f();return}await fn({autoSave:!0}),console.log(" [Auto-save Payments] Salvo ao clicar fora!")}catch(Ot){console.error(" [Auto-save Payments] Erro ao salvar ao clicar fora:",Ot)}finally{f()}},onEscapeKeyDown:ot=>{ot.preventDefault()},children:!x||x.length===0?mt.current?a.jsxs(a.Fragment,{children:[a.jsxs(pn,{className:"sr-only",children:[a.jsx(un,{children:"Aviso"}),a.jsx(Dn,{children:"Nenhuma forma de pagamento cadastrada"})]}),a.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[a.jsx(zf,{className:"w-12 h-12 text-amber-500"}),a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("p",{className:"font-semibold text-amber-500",children:"Nenhuma forma de pagamento cadastrada"}),a.jsx("p",{className:"text-sm text-text-muted",children:"Cadastre pelo menos uma finalizadora para gerenciar pagamentos."})]}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsx(me,{type:"button",variant:"outline",onClick:f,children:"Fechar"}),a.jsx(s4,{to:"/finalizadoras",children:a.jsx(me,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:f,children:"Cadastrar Finalizadora"})})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs(pn,{className:"sr-only",children:[a.jsx(un,{children:"Carregando"}),a.jsx(Dn,{children:"Carregando formas de pagamento"})]}),a.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"}),a.jsx("p",{className:"text-sm text-text-muted",children:"Carregando formas de pagamento..."})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(pn,{className:"relative pb-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-3 sm:gap-4",children:[a.jsxs("div",{className:"flex-1 w-full sm:w-auto",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(un,{children:"Registrar pagamento"}),ar&&a.jsxs("span",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs bg-blue-600/10 text-blue-400 border-blue-700/30",children:[a.jsxs("svg",{className:"w-3 h-3 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]})]}),a.jsx(Dn,{children:"As alteraes so salvas automaticamente enquanto voc edita."})]}),a.jsxs(me,{type:"button",variant:"outline",size:"sm",onClick:zn,className:"flex-shrink-0 gap-2 w-full sm:w-auto mt-2 sm:mt-0",title:"Baixar relatrio como imagem",children:[a.jsx(ho,{className:"w-4 h-4"}),a.jsx("span",{children:"Baixar Relatrio"})]})]})}),a.jsxs("div",{className:"space-y-3 sm:space-y-6",children:[a.jsxs("div",{className:"sm:hidden space-y-2 max-w-md mx-auto",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"p-2 rounded-lg bg-emerald-600/10 border border-emerald-500/30 min-w-0 relative group",children:[a.jsx("div",{className:"text-[10px] text-emerald-300/80 mb-1 truncate",children:"Total"}),q?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ye,{type:"text",value:J,onChange:ot=>fe(Ao(ot.target.value)),className:"w-full h-6 text-xs text-center font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300 px-1",placeholder:"0,00",autoFocus:!0,onKeyDown:ot=>{ot.key==="Enter"&&J!==m?Lr():ot.key==="Escape"&&sr()},onBlur:()=>{J!==m?Lr():sr()}}),J!==m&&a.jsx("button",{onMouseDown:ot=>ot.preventDefault(),onClick:Lr,className:"p-0.5 rounded hover:bg-emerald-500/20 transition-colors flex-shrink-0",title:"Confirmar",children:a.jsx(Uf,{className:"w-3 h-3 text-emerald-400"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-bold text-emerald-400 truncate",children:Ao(m)||"R$ 0,00"}),a.jsx("button",{onClick:Or,className:"absolute right-1 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-emerald-500/20 transition-colors",title:"Editar",children:a.jsx(xl,{className:"w-3 h-3 text-emerald-400"})})]})]}),a.jsxs("div",{className:`p-2 rounded-lg border min-w-0 ${be.diff===0?"bg-emerald-600/10 border-emerald-500/30":be.diff>0?"bg-amber-600/10 border-amber-500/30":"bg-rose-600/10 border-rose-500/30"}`,children:[a.jsx("div",{className:`text-[10px] mb-1 truncate ${be.diff===0?"text-emerald-300/80":be.diff>0?"text-amber-300/80":"text-rose-300/80"}`,children:"Diferena"}),a.jsxs("div",{className:`text-sm font-bold truncate ${be.diff===0?"text-emerald-400":be.diff>0?"text-amber-400":"text-rose-400"}`,children:[be.diff>0?"+":"",Ao(String(Math.abs(be.diff).toFixed(2)))]})]})]}),a.jsxs("div",{className:"flex gap-1.5 text-xs justify-center",children:[a.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[a.jsx("span",{className:"text-text-secondary",children:"Participantes:"})," ",a.jsx("strong",{children:kt})]}),a.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[a.jsx("span",{className:"text-text-secondary",children:"Atribudo:"})," ",a.jsxs("strong",{children:["R$ ",be.totalAssigned.toFixed(2)]})]}),a.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[a.jsx("span",{className:"text-text-secondary",children:"Alvo:"})," ",a.jsxs("strong",{children:["R$ ",be.totalTarget.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx(me,{type:"button",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white text-xs h-8 px-3",onClick:dt,disabled:!m||kt===0,children:(()=>{const ot=Ci(m);if(Number.isFinite(ot)&&kt>0){const $t=ot/kt;return`Dividir (${Ao(String($t.toFixed(2)))})`}return"Dividir"})()}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(me,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 text-xs h-8 px-3 flex-1",onClick:mr,disabled:kt===0,children:"Aplicar taxas"}),a.jsx(me,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 text-xs h-8 px-3 flex-1",onClick:Lt,disabled:kt===0,children:"Zerar"})]})]})]}),a.jsx("div",{className:"hidden sm:block p-4 rounded-lg border border-border bg-gradient-to-br from-surface-2 to-surface shadow-md",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-start gap-3 w-full",children:[a.jsxs("div",{className:"flex flex-row gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Le,{className:"font-bold text-base text-white",children:"Valor total a receber"}),a.jsx("div",{className:"w-[180px] px-3 py-2 rounded-md bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-2 border-emerald-500/40 shadow-lg flex items-center justify-center gap-2 relative group",children:q?a.jsxs(a.Fragment,{children:[a.jsx(Ye,{type:"text",value:J,onChange:ot=>fe(Ao(ot.target.value)),className:"w-full h-8 text-center text-lg font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300",placeholder:"0,00",autoFocus:!0,onKeyDown:ot=>{ot.key==="Enter"&&J!==m?Lr():ot.key==="Escape"&&sr()},onBlur:()=>{J!==m?Lr():sr()}}),J!==m&&a.jsx("button",{onMouseDown:ot=>ot.preventDefault(),onClick:Lr,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors",title:"Confirmar (Enter)",children:a.jsx(Uf,{className:"w-4 h-4 text-emerald-400"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-xl font-bold text-emerald-400",children:Ao(m)||"R$ 0,00"}),a.jsx("button",{onClick:Or,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors opacity-0 group-hover:opacity-100",title:"Editar valor total",children:a.jsx(xl,{className:"w-4 h-4 text-emerald-400"})})]})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Le,{className:"font-bold text-base text-white",children:"Diferena"}),a.jsx("div",{className:`w-[180px] px-3 py-2 rounded-md border-2 shadow-lg flex items-center justify-center ${be.diff===0?"bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-emerald-500/40":be.diff>0?"bg-gradient-to-br from-amber-600/20 to-amber-700/20 border-amber-500/40":"bg-gradient-to-br from-rose-600/20 to-rose-700/20 border-rose-500/40"}`,children:a.jsxs("span",{className:`text-xl font-bold ${be.diff===0?"text-emerald-400":be.diff>0?"text-amber-400":"text-rose-400"}`,children:[be.diff>0?"+":"",Ao(String(Math.abs(be.diff).toFixed(2)))]})})]})]}),a.jsxs("div",{className:"ml-auto flex flex-col gap-3 items-end",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[a.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),a.jsx("strong",{children:kt})]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[a.jsx("span",{className:"text-text-secondary",children:"Atribudo:"}),a.jsxs("strong",{children:["R$ ",be.totalAssigned.toFixed(2)]})]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[a.jsx("span",{className:"text-text-secondary",children:"Alvo:"}),a.jsxs("strong",{children:["R$ ",be.totalTarget.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsx(me,{type:"button",variant:"secondary",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white flex-shrink-0",onClick:dt,disabled:!m||kt===0,children:(()=>{const ot=Ci(m);if(Number.isFinite(ot)&&kt>0){const $t=ot/kt;return a.jsxs(a.Fragment,{children:["Dividir igualmente (",Ao(String($t.toFixed(2)))," cada)",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})}return a.jsxs(a.Fragment,{children:["Dividir igualmente",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})})()}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(me,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 flex-1 sm:flex-initial whitespace-nowrap",onClick:mr,disabled:kt===0,children:["Aplicar taxas",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-amber-700/50 rounded border border-amber-500/30",children:"F9"})]}),a.jsxs(me,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 flex-1 sm:flex-initial",onClick:Lt,disabled:kt===0,children:["Zerar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"F10"})]})]})]})]})]})}),(r.selectedClients||[]).length===0?a.jsx("div",{className:"text-xs text-text-muted italic",children:'Nenhum participante neste agendamento. Adicione participantes no campo "Clientes" do modal principal.'}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs("div",{className:"relative flex-1 min-w-0",children:[a.jsx(Ye,{ref:Be,type:"text",placeholder:"Buscar participante...",value:P,onChange:ot=>E(ot.target.value),className:"pr-16"}),a.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-amber-400 hover:text-amber-300",onClick:()=>{E(""),Be.current?.focus()},children:"limpar"})]}),a.jsxs(me,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md flex-shrink-0",onClick:ot=>{ot.preventDefault(),ot.stopPropagation(),w(2e3),$(!0)},children:[a.jsx("span",{className:"hidden sm:inline",children:"Adicionar participante +"}),a.jsx("span",{className:"sm:hidden",children:"Participante +"})]})]}),D?.type==="pending"&&a.jsxs("div",{role:"alert",className:"mb-2 rounded-md border border-amber-600/40 bg-amber-500/10 px-3 py-2 text-amber-200 flex items-start gap-3",children:[a.jsx(zf,{className:"w-4 h-4 text-amber-300 mt-0.5"}),a.jsxs("div",{className:"flex-1 text-sm",children:[a.jsx("strong",{children:"Ateno:"})," Existem ",a.jsx("strong",{children:D.count})," participante(s) com status ",a.jsx("strong",{children:"Pendente"}),"."]}),a.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded bg-amber-500/20 hover:bg-amber-500/30 border border-amber-600/40",onClick:()=>I(null),children:"Entendi"})]}),a.jsx("div",{className:"border border-border rounded-md overflow-hidden",children:a.jsx("div",{className:"divide-y divide-border max-h-[50vh] overflow-y-scroll",children:(()=>{const ot=P.trim().toLowerCase(),$t=A||[],Ht=(le||[]).map((Ot,Xr)=>({...Ot,_originalIndex:Xr})).filter(Ot=>!$t.includes(Ot._originalIndex)).filter(Ot=>!ot||String(Ot?.nome||"").toLowerCase().includes(ot));return Ht.length===0?a.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum participante com esse nome"}):Ht.map(Ot=>{const Xr=`participant-${Ot._originalIndex}`,Je=Ot._originalIndex,cr=Z.includes(Je);return a.jsxs("div",{className:`p-2 sm:p-3 border-b last:border-b-0 transition-all duration-500 ease-out ${cr?"bg-white/10":""}`,children:[a.jsxs("div",{className:"sm:hidden space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[Ot.codigo!==null&&Ot.codigo!==void 0&&a.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${Ot.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",Ot.codigo]}),bt(Ot.cliente_id)?a.jsxs("div",{className:"relative flex-1 min-w-0",children:[a.jsx("input",{ref:vt=>{vt&&(te.current[Je]=vt)},type:"text",value:Ot.nome||"",onChange:vt=>De(Je,vt.target.value),onFocus:()=>Nt(Je),onKeyDown:vt=>{if(vt.key==="Enter"){vt.preventDefault();const Tt=ct(Je);Tt!==null&&setTimeout(()=>{te.current[Tt]?.focus()},0)}else if(vt.key==="Delete"&&Ot.nome&&vt.target===document.activeElement)vt.preventDefault(),vt.stopPropagation(),De(Je,""),setTimeout(()=>{te.current[Je]?.focus()},0);else if(vt.key==="ArrowDown"){vt.preventDefault();const Tt=ct(Je);Tt!==null&&setTimeout(()=>{te.current[Tt]?.focus()},0)}else if(vt.key==="ArrowUp"){vt.preventDefault();const Tt=xt(Je);Tt!==null&&setTimeout(()=>{te.current[Tt]?.focus()},0)}},onBlur:async()=>{Nt(null),!Ot.nome&&Te.current[Je]&&ke(Je);try{xe.current&&clearTimeout(xe.current),await fn({autoSave:!0})}catch(vt){console.error("[PaymentModal] Erro ao salvar ao sair do nome consumidor (compacto):",vt)}},placeholder:"Nome do cliente...",className:"font-medium text-sm bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded px-2 py-0.5 pr-11 focus:border-white/30 focus:outline-none focus:ring-1 focus:ring-white/20 w-full",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),Ot.nome?a.jsx("button",{type:"button",onClick:()=>{De(Je,""),setTimeout(()=>{te.current[Je]?.focus()},0)},className:`absolute right-1 top-1/2 -translate-y-1/2 px-1.5 py-0.5 text-[10px] font-bold border rounded transition-all ${lt===Je||!lt&&ne===Je?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/20":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20"}`,title:lt===Je||!lt&&ne===Je?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):Te.current[Je]?a.jsx("button",{type:"button",onClick:()=>ke(Je),className:"absolute right-1 top-1/2 -translate-y-1/2 p-1 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all",title:"Restaurar ltimo nome",children:a.jsx(OF,{className:"w-3 h-3"})}):null]}):a.jsx("span",{className:"font-medium text-sm truncate",children:Ot.nome})]}),a.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[a.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>tr(Je,Ot.nome),title:"Trocar",children:a.jsx(xl,{className:"w-4 h-4"})}),a.jsx(me,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400 h-6 w-6 p-0",onClick:()=>{F(vt=>[...vt,Je])},children:""})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{children:[a.jsx(Le,{className:"text-[10px] text-text-muted",children:"Mtodo"}),a.jsxs(Nn,{value:String(Ot.finalizadora_id||""),onValueChange:vt=>{ie(Tt=>{const Dr=[...Tt];if(Je>=0&&Je<Dr.length){const an=x.find(St=>String(St.id)===String(vt)),Nr=Number(an?.taxa_percentual||0)>0;Dr[Je]={...Dr[Je],finalizadora_id:vt,aplicar_taxa:Nr?Dr[Je].aplicar_taxa??!0:!1}}return Dr})},children:[a.jsx(bn,{className:"h-8 text-xs",children:a.jsx(Cn,{placeholder:"Mtodo"})}),a.jsx(wn,{children:x.map(vt=>a.jsx(tt,{value:String(vt.id),children:vt.nome||vt.tipo||"Outros"},vt.id))})]}),(()=>{const vt=x.find(Nr=>String(Nr.id)===String(Ot.finalizadora_id)),Tt=Number(vt?.taxa_percentual||0);if(Tt<=0)return a.jsx("div",{className:"h-4 mt-1"});const Dr=Ci(Ot.valor_cota),an=Number.isFinite(Dr)&&Dr>0;return a.jsxs("label",{className:`flex items-center gap-1.5 mt-1 text-[11px] ${an?"cursor-pointer":"cursor-not-allowed opacity-50"}`,title:an?`Taxa de ${Tt.toFixed(2)}%`:"Informe o valor primeiro",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:!!Ot.aplicar_taxa,disabled:!an,onChange:Nr=>{if(!an){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}ie(St=>{const Fr=[...St];if(Je>=0&&Je<Fr.length){const zr=Nr.target.checked;let ha=Dr;zr?ha=Dr*(1+Tt/100):ha=Dr/(1+Tt/100),Fr[Je]={...Fr[Je],aplicar_taxa:zr,valor_cota:Ao(ha.toFixed(2))}}return Fr})},style:{accentColor:"#f59e0b"}}),a.jsxs("span",{className:"text-amber-500 font-medium",children:["Taxa (",Tt.toFixed(2),"%)"]})]})})()]}),a.jsxs("div",{className:"isolate",children:[a.jsx(Le,{className:"text-[10px] text-text-muted",children:"Valor"}),a.jsx(Ye,{ref:vt=>{vt&&(ue.current[Je]=vt)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:Ao(Ot.valor_cota),onChange:vt=>{const Tt=Ao(vt.target.value),Dr=Ci(Tt),an=Number.isFinite(Dr)&&Dr>0?"Pago":"Pendente";ie(Nr=>{const St=[...Nr];return Je>=0&&Je<St.length&&(St[Je]={...St[Je],valor_cota:Tt,status_pagamento:an,aplicar_taxa:Tt===""||Dr<=0?!1:St[Je].aplicar_taxa}),St})},className:"h-8 text-xs text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})]})]}),a.jsx("div",{className:"flex justify-end",children:(()=>{const vt=Ot.status_pagamento==="Pago",Tt=Number.isFinite(Ci(Ot.valor_cota))&&Ci(Ot.valor_cota)>0,Dr=vt&&Tt;return a.jsx("button",{type:"button",onClick:()=>Ge(Je,Ot.status_pagamento,Ot.valor_cota),disabled:Dr,className:`inline-flex items-center justify-center px-3 py-0.5 rounded text-xs font-medium border transition-all ${vt&&Tt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":vt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:Dr?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:vt?"Pago":"Pendente"})})()})]}),a.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex items-center gap-2",children:[Ot.codigo!==null&&Ot.codigo!==void 0&&a.jsxs("span",{className:`text-sm font-bold rounded-md px-2.5 py-1 shadow-sm ${Ot.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",Ot.codigo]}),bt(Ot.cliente_id)?a.jsxs("div",{className:"relative",children:[a.jsx("input",{ref:vt=>{vt&&(te.current[Je]=vt)},type:"text",value:Ot.nome||"",onChange:vt=>De(Je,vt.target.value),onFocus:()=>Nt(Je),onKeyDown:vt=>{if(vt.key==="Enter"){vt.preventDefault();const Tt=ct(Je);Tt!==null&&setTimeout(()=>{te.current[Tt]?.focus()},0)}else if(vt.key==="Delete"&&Ot.nome&&vt.target===document.activeElement)vt.preventDefault(),vt.stopPropagation(),De(Je,""),setTimeout(()=>{te.current[Je]?.focus()},0);else if(vt.key==="ArrowDown"){vt.preventDefault();const Tt=ct(Je);Tt!==null&&setTimeout(()=>{te.current[Tt]?.focus()},0)}else if(vt.key==="ArrowUp"){vt.preventDefault();const Tt=xt(Je);Tt!==null&&setTimeout(()=>{te.current[Tt]?.focus()},0)}},onBlur:async()=>{Nt(null),!Ot.nome&&Te.current[Je]&&ke(Je);try{xe.current&&clearTimeout(xe.current),await fn({autoSave:!0})}catch(vt){console.error("[PaymentModal] Erro ao salvar ao sair do nome consumidor (normal):",vt)}},placeholder:"Nome do cliente...",className:"font-medium text-base bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded-md px-3 py-1.5 pr-14 focus:border-white/30 focus:outline-none focus:ring-2 focus:ring-white/20 min-w-[200px] max-w-[300px]",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),Ot.nome?a.jsx("button",{type:"button",onClick:()=>{De(Je,""),setTimeout(()=>{te.current[Je]?.focus()},0)},className:`absolute right-2 top-1/2 -translate-y-1/2 px-2 py-1 text-xs font-bold border rounded transition-all ${lt===Je||!lt&&ne===Je?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/30":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20 shadow-sm"}`,title:lt===Je||!lt&&ne===Je?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):Te.current[Je]?a.jsx("button",{type:"button",onClick:()=>ke(Je),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all shadow-sm",title:"Restaurar ltimo nome",children:a.jsx(OF,{className:"w-4 h-4"})}):null]}):a.jsx("span",{className:"font-medium text-base",children:Ot.nome}),a.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>tr(Je,Ot.nome),title:"Trocar participante",children:a.jsx(xl,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"isolate",children:a.jsx(Ye,{ref:vt=>{vt&&(ue.current[Je]=vt)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:Ao(Ot.valor_cota),onChange:vt=>{const Tt=Ao(vt.target.value),Dr=Ci(Tt),an=Number.isFinite(Dr)&&Dr>0?"Pago":"Pendente";ie(Nr=>{const St=[...Nr];return Je>=0&&Je<St.length&&(St[Je]={...St[Je],valor_cota:Tt,status_pagamento:an,aplicar_taxa:Tt===""||Dr<=0?!1:St[Je].aplicar_taxa}),St})},className:"w-28 text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})}),a.jsxs("div",{className:"flex items-center gap-2 min-w-[240px] isolate",children:[a.jsxs(Nn,{value:String(Ot.finalizadora_id||""),onValueChange:vt=>{ie(Tt=>{const Dr=[...Tt];if(Je>=0&&Je<Dr.length){const an=x.find(St=>String(St.id)===String(vt)),Nr=Number(an?.taxa_percentual||0)>0;Dr[Je]={...Dr[Je],finalizadora_id:vt,aplicar_taxa:Nr?Dr[Je].aplicar_taxa??!0:!1}}return Dr})},children:[a.jsx(bn,{className:"w-[140px] flex-shrink-0",children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsx(wn,{children:x.map(vt=>a.jsx(tt,{value:String(vt.id),children:vt.nome||vt.tipo||"Outros"},vt.id))})]}),a.jsx("div",{className:"flex-1 min-w-0 isolate",children:(()=>{const vt=x.find(Nr=>String(Nr.id)===String(Ot.finalizadora_id)),Tt=Number(vt?.taxa_percentual||0);if(Tt<=0)return a.jsx("div",{className:"h-5"});const Dr=Ci(Ot.valor_cota),an=Dr>0;return a.jsxs("label",{className:`flex items-center gap-1.5 text-xs transition-colors ${an?"cursor-pointer hover:text-text-primary":"cursor-not-allowed opacity-50"}`,title:an?`Taxa de ${Tt.toFixed(2)}%`:"Informe o valor primeiro",children:[a.jsx("input",{type:"checkbox",checked:!!Ot.aplicar_taxa,disabled:!an,onChange:Nr=>{if(!an){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}ie(St=>{const Fr=[...St];if(Je>=0&&Je<Fr.length){const zr=Nr.target.checked;let ha=Dr;zr?ha=Dr*(1+Tt/100):ha=Dr/(1+Tt/100),Fr[Je]={...Fr[Je],aplicar_taxa:zr,valor_cota:Ao(ha.toFixed(2))}}return Fr})},className:`w-4 h-4 rounded border-2 border-amber-500 checked:bg-amber-500 checked:border-amber-500 focus:ring-2 focus:ring-amber-500 focus:ring-offset-1 ${an?"cursor-pointer":"cursor-not-allowed"}`,style:{accentColor:"#f59e0b"}}),a.jsxs("span",{className:"whitespace-nowrap text-amber-500 font-medium",children:["Taxa (",Tt.toFixed(2),"%)"]})]})})()})]}),(()=>{const vt=Ot.status_pagamento==="Pago",Tt=Number.isFinite(Ci(Ot.valor_cota))&&Ci(Ot.valor_cota)>0,Dr=vt&&Tt;return a.jsx("button",{type:"button",onClick:()=>Ge(Je,Ot.status_pagamento,Ot.valor_cota),disabled:Dr,className:`inline-flex items-center justify-center w-[90px] px-3 py-1 rounded text-sm font-medium border transition-all ${vt&&Tt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":vt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:Dr?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:vt?"Pago":"Pendente"})})(),a.jsx(me,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400",onClick:()=>{F(vt=>[...vt,Je])},children:"Remover"})]})]},Xr)})})()})})]})]}),a.jsx(ra,{className:"gap-2",children:a.jsxs(me,{type:"button",variant:"ghost",className:"border border-white/10",onClick:async()=>{console.log(" [Auto-save Payments] Salvando ao fechar modal...");try{xe.current&&clearTimeout(xe.current),await fn({autoSave:!0}),console.log(" [Auto-save Payments] Salvo ao fechar!")}catch(ot){console.error(" [Auto-save Payments] Erro ao salvar ao fechar:",ot)}f()},children:["Fechar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]})})]})})}),a.jsxs("div",{ref:mn,style:{position:"fixed",left:"0",top:"0",width:"900px",minHeight:"auto",padding:"30px",backgroundColor:"#ffffff !important",color:"#000000 !important",fontFamily:"Arial, sans-serif",opacity:"0",visibility:"hidden",zIndex:"-9999",pointerEvents:"none",overflow:"hidden"},children:[a.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"6px",borderBottom:"2px solid #000",backgroundColor:"#fff",color:"#000"},children:[a.jsx("h1",{style:{fontSize:"18px",fontWeight:"bold",margin:"0 0 6px 0",color:"#000",letterSpacing:"0.5px",textAlign:"center"},children:"RELATRIO DE PAGAMENTOS"}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"10px",color:"#000",fontWeight:"600"},children:[a.jsxs("div",{style:{display:"flex",gap:"20px",flex:1},children:[a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Data:"}),a.jsx("span",{style:{marginLeft:"4px"},children:h?.start?new Date(h.start).toLocaleDateString("pt-BR"):"-"})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Quadra:"}),a.jsx("span",{style:{marginLeft:"4px"},children:h?.court||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Cdigo:"}),a.jsx("span",{style:{marginLeft:"4px"},children:h?.code?`#${h.code}`:"-"})]})]}),a.jsxs("div",{style:{display:"flex",gap:"30px",textAlign:"right"},children:[a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Total:"}),a.jsxs("strong",{style:{marginLeft:"4px",color:"#000",fontSize:"11px",display:"inline"},children:["R$ ",Ao(m||0)]})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Diferena:"}),a.jsxs("strong",{style:{marginLeft:"4px",color:be.diff<0?"#dc2626":"#16a34a",fontSize:"11px",display:"inline"},children:[be.diff<0?"-":"","R$ ",Ao(Math.abs(be.diff).toFixed(2))]})]})]})]})]}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"8px",fontSize:"10px",backgroundColor:"#fff",fontFamily:"Arial, sans-serif",border:"1px solid #000",tableLayout:"fixed"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#cccccc",borderBottom:"1px solid #000"},children:[a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"5%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"N"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"35%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Nome"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"10%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Cdigo"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Valor"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"20%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Forma"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Status"})]})}),a.jsx("tbody",{children:(()=>(le||[]).filter(($t,Yt)=>!(A||[]).includes(Yt)).map(($t,Yt)=>{const Ht=x?.find(Dr=>String(Dr.id)===String($t.finalizadora_id)),Ot=$t.status_pagamento==="Pago",Je=s?.find(Dr=>Dr.id===$t.cliente_id)?.is_consumidor_final,vt=($t.nome||"Sem nome").trim().split(/\s+/).slice(0,2).join(" "),Tt=Je?"0":$t.codigo||"N/A";return a.jsxs("tr",{"data-participant-index":Yt,style:{backgroundColor:"#fff"},children:[a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:Yt+1}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"left",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word",overflow:"hidden"},children:vt}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Tt}),a.jsxs("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:["R$ ",Ao($t.valor_cota||0)]}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Ht?.nome||"N/D"}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:Ot?"#16a34a":"#ca8a04",fontSize:"10px",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Ot?" Pago":" Pendente"})]},`participant-${Yt}-${$t.cliente_id}`)}))()})]}),a.jsx("div",{style:{height:"2px",backgroundColor:"#fff"}}),a.jsxs("div",{style:{marginTop:"2px",textAlign:"center",fontSize:"10px",color:"#000",borderTop:"1px solid #000",paddingTop:"2px",display:"flex",justifyContent:"space-between",backgroundColor:"#fff"},children:[a.jsxs("div",{style:{color:"#000",fontWeight:"500"},children:["Gerado em: ",new Date().toLocaleString("pt-BR")]}),a.jsx("div",{id:"page-indicator",style:{fontSize:"10px",fontWeight:"bold",color:"#000"}})]})]}),a.jsx(xn,{open:W,onOpenChange:ot=>{ot||(ve([]),z("")),$(ot)},children:a.jsxs(vn,{className:"sm:max-w-[500px]",onInteractOutside:ot=>{ot.preventDefault(),w(2e3),$(!1)},children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Adicionar Participante"}),a.jsx(Dn,{children:"Selecione um cliente para adicionar aos pagamentos."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{ref:fr,placeholder:"Buscar por cdigo ou nome...",value:U,onChange:ot=>{z(ot.target.value),K(0)},onKeyDown:ot=>{const $t=U.toLowerCase().trim(),Yt=(s||[]).filter(cr=>{if(!$t)return!0;const vt=String(cr.codigo||""),Tt=(cr.nome||"").toLowerCase();return vt.includes($t)||Tt.includes($t)}),Ht=Yt.find(cr=>cr?.is_consumidor_final===!0),Xr=Yt.filter(cr=>cr?.is_consumidor_final!==!0).sort((cr,vt)=>{const Tt=cr.codigo||0,Dr=vt.codigo||0;return Tt-Dr}),Je=Ht?[Ht,...Xr]:Xr;if(ot.key==="ArrowDown")ot.preventDefault(),K(cr=>Math.min(cr+1,Je.length-1));else if(ot.key==="ArrowUp")ot.preventDefault(),K(cr=>Math.max(cr-1,0));else if(ot.key==="Enter"&&Je[_e]){ot.preventDefault();const vt={...Je[_e],timestamp:Date.now()};ve(Tt=>[...Tt,vt])}},className:"pl-10 pr-10"}),U&&a.jsx("button",{type:"button",onClick:()=>z(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text",children:a.jsx(el,{className:"h-4 w-4"})})]}),a.jsx(me,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md",onClick:()=>{o&&(w(15e3),o(()=>{$(!0)}),$(!1),z(""))},children:"+Novo"})]}),a.jsx("div",{ref:Ut,className:"border rounded-md max-h-[400px] overflow-y-auto",children:(()=>{const ot=U.toLowerCase().trim(),$t=(s||[]).filter(Je=>{if(!ot)return!0;const cr=String(Je.codigo||""),vt=(Je.nome||"").toLowerCase();return cr.includes(ot)||vt.includes(ot)}),Yt=$t.find(Je=>Je?.is_consumidor_final===!0),Ot=$t.filter(Je=>Je?.is_consumidor_final!==!0).sort((Je,cr)=>{const vt=Je.codigo||0,Tt=cr.codigo||0;return vt-Tt}),Xr=Yt?[Yt,...Ot]:Ot;return Xr.length===0?a.jsx("div",{className:"p-8 text-center text-text-muted",children:"Nenhum cliente encontrado."}):Xr.map((Je,cr)=>{const vt=Je?.is_consumidor_final===!0,Tt=ee.filter(an=>an.id===Je.id).length,Dr=cr===_e;return a.jsxs("div",{ref:an=>{It.current[cr]=an},role:"button",tabIndex:0,className:`w-full px-4 py-3 text-left transition-all border-b border-border last:border-0 flex items-center gap-3 cursor-pointer ${Dr?"ring-2 ring-blue-500 ring-inset z-10":""} ${vt?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":Tt>0?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>K(cr),onClick:an=>{an.preventDefault(),an.stopPropagation();const Nr={...Je,timestamp:Date.now()};ve(St=>[...St,Nr])},onKeyDown:an=>{if(an.key==="Enter"||an.key===" "){an.preventDefault();const Nr={...Je,timestamp:Date.now()};ve(St=>[...St,Nr])}},children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[(()=>Je.codigo!==null&&Je.codigo!==void 0?a.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${vt?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",Je.codigo]}):null)(),a.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[a.jsx("span",{className:`font-medium ${vt?"text-amber-100/90":""}`,children:Je.nome}),vt&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),Tt>0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:an=>{an.preventDefault(),an.stopPropagation(),ve(Nr=>{const St=Nr.findIndex(Fr=>Fr.id===Je.id);if(St!==-1){const Fr=[...Nr];return Fr.splice(St,1),Fr}return Nr})},children:"-"}),a.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:Tt}),a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:an=>{an.preventDefault(),an.stopPropagation();const Nr={...Je,timestamp:Date.now()};ve(St=>[...St,Nr])},children:"+"})]})]},Je.id)})})()})]}),a.jsxs(ra,{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-sm text-text-muted",children:ee.length>0&&a.jsxs("span",{className:"font-medium",children:[ee.length," ",ee.length===1?"participante selecionado":"participantes selecionados"]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(me,{type:"button",variant:"ghost",className:"border border-border",onClick:ot=>{ot.preventDefault(),ot.stopPropagation(),w(1e3),$(!1),z(""),ve([])},children:["Cancelar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),a.jsxs(me,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",disabled:ee.length===0,onClick:ot=>{console.log("[AddParticipant] Boto Salvar clicado"),ot.preventDefault(),ot.stopPropagation(),console.log("[AddParticipant] Protegendo modal de pagamentos (3000ms)"),w(3e3),console.log("[AddParticipant] Adicionando participantes:",ee.length);const $t=ee.map(Yt=>({cliente_id:Yt.id,nome:Yt.nome,codigo:Yt.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const Ht=it();return Ht?.id?String(Ht.id):null})(),aplicar_taxa:(()=>{const Ht=it();return Number(Ht?.taxa_percentual||0)>0})()}));ie(Yt=>{const Ht=Yt.length,Ot=$t.map((Xr,Je)=>Ht+Je);return ce(Ot),setTimeout(()=>{ce([])},1e3),[...Yt,...$t]}),console.log("[AddParticipant] Fechando modal de adicionar participante"),$(!1),z(""),ve([]),console.log("[AddParticipant] Concludo")},children:["Confirmar (",ee.length,")",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})]})}),a.jsx(xn,{open:at,onOpenChange:ot=>{console.log(" [DownloadModal] onOpenChange chamado:",{open:ot,downloadStatus:Pt}),!ot&&Pt==="success"?(console.log(" [DownloadModal] Fechando modal de download (sucesso)"),gt(!1)):ot||console.log(" [DownloadModal] BLOQUEADO: Ainda baixando")},children:a.jsxs(vn,{className:"sm:max-w-md",onPointerDownOutside:ot=>{Pt==="downloading"&&ot.preventDefault()},onEscapeKeyDown:ot=>{Pt==="downloading"&&ot.preventDefault()},children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-center",children:Pt==="downloading"?"Gerando PDF...":"PDF Gerado com Sucesso!"}),a.jsx(Dn,{className:"sr-only",children:Pt==="downloading"?"Aguarde enquanto o relatrio de pagamentos est sendo gerado":"Relatrio de pagamentos gerado e baixado com sucesso"})]}),a.jsx("div",{className:"flex flex-col items-center justify-center py-6 space-y-4",children:Pt==="downloading"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-500"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Gerando seu relatrio..."}),a.jsxs("div",{className:"w-full max-w-xs",children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[a.jsx("span",{children:"Progresso"}),a.jsxs("span",{children:[Qe,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:a.jsx("div",{className:"bg-green-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${Qe}%`}})})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"rounded-full bg-green-100 p-3",children:a.jsx("svg",{className:"w-12 h-12 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Relatrio baixado com sucesso!"}),a.jsx("p",{className:"text-xs text-gray-400 text-center",children:We})]})}),Pt==="success"&&a.jsxs("div",{className:"flex flex-col gap-2",children:[navigator.share&&navigator.canShare&&navigator.canShare({files:[]})&&a.jsxs(me,{onClick:async()=>{if(!rt){l({title:"Arquivo no disponvel",description:"Tente gerar o PDF novamente.",variant:"destructive"});return}try{console.log(" [PDF] Compartilhando via Web Share API...");const ot=new File([rt],We,{type:"application/pdf"});await navigator.share({files:[ot],title:"Relatrio de Pagamentos",text:"Confira o relatrio de pagamentos"}),console.log(" [PDF] Compartilhado com sucesso"),l({title:"Compartilhado com sucesso!",variant:"success"})}catch(ot){if(ot.name==="AbortError"){console.log(" [PDF] Compartilhamento cancelado");return}console.error(" [PDF] Erro ao compartilhar:",ot),l({title:"Erro ao compartilhar",description:ot.message,variant:"destructive"})}},className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Compartilhar"]}),a.jsxs(me,{onClick:()=>{Ne?(console.log(" [PDF] Abrindo PDF em nova aba:",Ne),window.open(Ne,"_blank")):(console.error(" [PDF] URL do blob no disponvel"),l({title:"Erro ao abrir PDF",description:"URL do PDF no est disponvel.",variant:"destructive"}))},className:"w-full bg-green-600 hover:bg-green-700",children:[a.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Abrir PDF"]}),a.jsx("p",{className:"text-xs text-center text-gray-500 px-2",children:"O PDF foi baixado. Abra-o para visualizar, imprimir ou compartilhar."}),a.jsx(me,{onClick:()=>gt(!1),variant:"ghost",className:"w-full",children:"Fechar"})]})]})}),a.jsx(xn,{open:lr.isOpen,onOpenChange:ot=>{if(!ot&&Pn.current){console.log(" [StatusConfirmation] Bloqueado onOpenChange (protegido)");return}ot||(console.log(" [StatusConfirmation] Fechando modal via onOpenChange"),Rr({isOpen:!1,participantIndex:null,currentStatus:null}))},children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[400px]",onInteractOutside:ot=>{Pn.current&&(console.log(" [StatusConfirmation] Bloqueado clique fora"),ot.preventDefault())},onEscapeKeyDown:ot=>{Pn.current&&(console.log(" [StatusConfirmation] Bloqueado ESC"),ot.preventDefault())},children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Alterar Status de Pagamento"}),a.jsx(Dn,{children:lr.currentStatus==="Pago"?a.jsxs(a.Fragment,{children:["Tem certeza que deseja marcar este participante como ",a.jsx("strong",{children:"Pendente"}),"?"]}):a.jsxs(a.Fragment,{children:["Tem certeza que deseja marcar este participante como ",a.jsx("strong",{children:"Pago"})," mesmo sem valor registrado?"]})})]}),a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"p-3 rounded-lg bg-amber-500/10 border border-amber-500/30",children:a.jsx("p",{className:"text-sm text-amber-400",children:lr.currentStatus==="Pago"?a.jsx(a.Fragment,{children:" Esta ao marcar o participante como pendente novamente para refazer o pagamento."}):a.jsx(a.Fragment,{children:" Esta ao marcar o participante como pago sem um valor especfico."})})})}),a.jsxs(ra,{className:"gap-2",children:[a.jsx(me,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{Rr({isOpen:!1,participantIndex:null,currentStatus:null})},children:"Cancelar"}),a.jsx(me,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>Re(lr.currentStatus==="Pago"?"Pendente":"Pago"),children:"Confirmar"})]})]})})]})}function eZe({form:e,setForm:t,localCustomers:r}){as(),vs();const{isEditParticipantModalOpen:n,closeEditParticipantModal:s,editParticipantData:o,participantsForm:i,setParticipantsForm:l,payMethods:c,protectPaymentModal:d,onParticipantReplacedRef:u}=eN(),[f,h]=p.useState(""),[m,v]=p.useState(!1),[g,y]=p.useState(0),x=Se.useRef(null),b=Se.useRef([]),w=Se.useRef(null),j=D=>{const I=o.participantId;if(i[I]?.cliente_id===D.id)return;console.log(" [EditParticipantModal] Substituindo participante:",{de:o.participantName,para:D.nome,indice:I,id_para:D.id});const R=i[I];if(l.updateLocal&&l.getLocal){const M=l.getLocal();if(I>=0&&I<M.length){const U={cliente_id:D.id,nome:D.nome,codigo:D.codigo,valor_cota:R?.valor_cota||"",status_pagamento:R?.status_pagamento||"Pendente",finalizadora_id:R?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:R?.aplicar_taxa||!1},z=[...M];z[I]=U,l.updateLocal(z)}}else l(M=>{if(I<0||I>=M.length)return M;const U={cliente_id:D.id,nome:D.nome,codigo:D.codigo,valor_cota:R?.valor_cota||"",status_pagamento:R?.status_pagamento||"Pendente",finalizadora_id:R?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:R?.aplicar_taxa||!1},z=[...M];return z[I]=U,z});d(3e3),s(),h(""),u?.current&&u.current(I)};if(p.useEffect(()=>{n&&(h(""),v(!1),y(0))},[n]),p.useEffect(()=>{n&&b.current[g]&&b.current[g]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[g,n]),!n)return null;const _=f.trim().toLowerCase(),C=(r||[]).filter(D=>_?String(D?.nome||"").toLowerCase().includes(_):!0),P=C.find(D=>D?.is_consumidor_final===!0),A=C.filter(D=>D?.is_consumidor_final!==!0).sort((D,I)=>{const R=Number(D?.codigo),M=Number(I?.codigo);return Number.isFinite(R)&&Number.isFinite(M)?R-M:String(D?.nome||"").localeCompare(String(I?.nome||""))}),F=P?[P,...A]:A;return a.jsx(xn,{open:n,onOpenChange:D=>{console.log("[EditParticipantModal] onOpenChange:",D),D||(console.log("[EditParticipantModal] Protegendo modal de pagamentos"),d(2e3),s(),h(""))},modal:!0,children:a.jsxs(vn,{className:"sm:max-w-[500px]",onPointerDownOutside:D=>{console.log(" [EditParticipantModal] onPointerDownOutside - prevenindo"),D.preventDefault(),D.stopPropagation()},onInteractOutside:D=>{console.log(" [EditParticipantModal] onInteractOutside - prevenindo"),D.preventDefault(),D.stopPropagation(),d(2e3)},children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Trocar Participante"}),a.jsxs(Dn,{children:["Substituindo: ",a.jsx("strong",{children:o.participantName})]})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"edit-participant-search",children:"Buscar cliente"}),a.jsx(Ye,{ref:x,id:"edit-participant-search",type:"text",placeholder:"Digite o nome do cliente...",value:f,onChange:D=>{h(D.target.value),y(0)},onKeyDown:D=>{if(D.key==="ArrowDown")D.preventDefault(),y(I=>Math.min(I+1,F.length-1));else if(D.key==="ArrowUp")D.preventDefault(),y(I=>Math.max(I-1,0));else if(D.key==="Enter"&&F[g]){D.preventDefault();const I=F[g],R=o.participantId;i[R]?.cliente_id===I.id||(d(2e3),j(I))}},className:"mt-1",autoFocus:!0})]}),a.jsx("div",{ref:w,className:"border border-border rounded-md max-h-[300px] overflow-y-auto",children:m?a.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Carregando clientes..."}):F.length===0?a.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:_?"Nenhum cliente encontrado":"Nenhum cliente cadastrado"}):F.map((D,I)=>{const R=o.participantId,M=i[R]?.cliente_id===D.id,U=D?.is_consumidor_final===!0,z=I===g;return a.jsxs("button",{ref:W=>{b.current[I]=W},type:"button",className:gr(z&&"ring-2 ring-blue-500 ring-inset z-10","w-full px-4 py-3 text-left transition-all","border-b border-border last:border-b-0","flex items-center gap-3",M&&"bg-brand/10 cursor-not-allowed opacity-60",!M&&U&&"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40",!M&&!U&&"hover:bg-surface-2"),disabled:M,onMouseEnter:()=>y(I),onClick:W=>{W.preventDefault(),W.stopPropagation(),console.log("[EditParticipantModal] Cliente selecionado - protegendo modal"),d(2e3),j(D)},children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[D.codigo!==null&&D.codigo!==void 0&&a.jsxs("span",{className:gr("inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors",U&&"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20",!U&&"bg-emerald-600/20 text-emerald-400"),children:["#",D.codigo]}),a.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[a.jsx("span",{className:gr("font-medium",U&&"text-amber-100/90"),children:D.nome}),U&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),M&&a.jsx("span",{className:"text-xs text-brand font-medium",children:"Atual"})]},D.id)})})]}),a.jsx(ra,{children:a.jsx(me,{type:"button",variant:"ghost",className:"border border-white/10",onClick:D=>{console.log(" [EditParticipantModal] ========== BOTO CANCELAR CLICADO =========="),console.log(" [EditParticipantModal] preventDefault()"),D.preventDefault(),console.log(" [EditParticipantModal] stopPropagation()"),D.stopPropagation(),console.log(" [EditParticipantModal] Protegendo modal de pagamentos (2000ms)"),d(2e3),console.log(" [EditParticipantModal] Fechando modal de editar participante"),s(),console.log(" [EditParticipantModal] Limpando busca"),h(""),console.log(" [EditParticipantModal] ========== CANCELAR CONCLUDO ==========")},children:"Cancelar"})})]})})}const tZe=e=>e?e.trim().split(/\s+/).slice(0,2).join(" "):"",wm=56,DE=30,rZe=6,nZe=24;function aZe({weekStart:e,weekBookings:t,activeCourtFilter:r,courtsMap:n,participantsByAgendamento:s,onBookingClick:o,onSlotClick:i,statusConfig:l,dayStartHour:c=rZe,dayEndHourExclusive:d=nZe,weekDiasFuncionamento:u={},sidebarVisible:f=!1}){const h=p.useRef(null),m=p.useRef(null),[v,g]=Se.useState(0),[y,x]=Se.useState(window.innerWidth<768);Se.useEffect(()=>{const E=()=>{x(window.innerWidth<768)};return window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const b=p.useMemo(()=>Array.from({length:7},(E,A)=>La(e,A)),[e]);p.useEffect(()=>{const E=()=>{m.current&&h.current&&(h.current.scrollLeft=m.current.scrollLeft)},A=()=>{h.current&&m.current&&(m.current.scrollLeft=h.current.scrollLeft)},F=()=>{if(m.current){const R=m.current.scrollHeight>m.current.clientHeight;g(R?17:0)}},D=m.current,I=h.current;return D&&D.addEventListener("scroll",E),I&&I.addEventListener("scroll",A),F(),window.addEventListener("resize",F),()=>{D&&D.removeEventListener("scroll",E),I&&I.removeEventListener("scroll",A),window.removeEventListener("resize",F)}},[]);const w=p.useMemo(()=>{if(r&&n[r]){const E=n[r],A=E.hora_inicio||`${c}:00:00`,F=E.hora_fim||`${d}:00:00`,[D]=String(A).split(":").map(Number),[I,R]=String(F).split(":").map(Number);let M=I===0&&R===0?24:I;return R>0&&M<24&&(M+=1),{start:D||c,end:M||d}}return{start:c,end:d}},[r,n,c,d]),j=p.useMemo(()=>Array.from({length:Math.max(0,w.end-w.start)},(E,A)=>w.start+A),[w]),_=p.useMemo(()=>Math.max(0,w.end-w.start)*(60/DE)*wm,[w]),C=p.useMemo(()=>{const E={};return b.forEach(A=>{E[ur(A,"yyyy-MM-dd")]=[]}),t.forEach(A=>{const F=ur(Es(A.start),"yyyy-MM-dd");E[F]&&E[F].push(A)}),E},[b,t]),P=(E,A)=>{const F=E.start.getHours()*60+E.start.getMinutes(),I=E.end.getHours()*60+E.end.getMinutes()-F,R=w.start*60,M=(F-R)/DE*wm,U=I/DE*wm,W=l[E.status]||{hex:"#888",text:"text-gray-400",label:"Unknown",icon:null},$=W.icon,ee=40,ve=Math.max(ee,U-4),_e=Math.min(1.3,ve/55),K=Math.max(11,Math.round(13*_e)),q=Math.max(10,Math.round(11*_e)),Y=Math.max(9,Math.round(10*_e)),J=Math.max(14,Math.round(16*_e)),fe=A?.[E.id]||[],Z=fe.filter(ie=>String(ie.status_pagamento||"").toLowerCase()==="pago").length,ce=fe.length,le=I===30;return a.jsx("div",{id:`booking-${E.id}`,className:"absolute left-0.5 right-0.5 rounded-md border-2 bg-surface cursor-pointer transition-all hover:bg-surface-2 hover:shadow-md overflow-hidden",style:{top:`${M}px`,height:`${Math.max(ee,U)}px`,borderColor:W.hex||"#888",borderLeftWidth:"3px",zIndex:5},onClick:()=>o(E),children:a.jsxs("div",{className:"h-full flex flex-col justify-center px-2 py-1",children:[a.jsx("div",{className:"flex items-center gap-1.5 mb-0.5",children:a.jsx("p",{className:"font-semibold truncate",style:{fontSize:`${K}px`,lineHeight:1.1,color:"#e2e8f0"},children:tZe(E.customer)})}),le&&(E.modality||ce>0)&&a.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",style:{lineHeight:1},children:[E.modality&&a.jsx("span",{className:"text-xs font-bold text-white bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm flex-shrink-0",style:{fontSize:Math.max(7,Y-1)},children:E.modality}),ce>0&&a.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${Z===ce?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,Y-1)},children:[a.jsx(Ko,{style:{width:Math.max(10,Y-1),height:Math.max(10,Y-1)}}),a.jsxs("span",{children:[Z,"/",ce]})]})]}),le&&a.jsxs("div",{className:"flex items-center gap-1.5 justify-between",children:[a.jsxs("span",{className:"font-semibold whitespace-nowrap",style:{fontSize:`${q}px`,color:"#999",lineHeight:1},children:[ur(E.start,"HH:mm"),"",ur(E.end,"HH:mm")]}),$&&a.jsxs("div",{className:"flex items-center gap-0.5",children:[!f&&!y&&a.jsx($,{style:{width:Math.max(12,J-2),height:Math.max(12,J-2),color:W.hex}}),a.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${q}px`,color:W.hex,lineHeight:1},children:W.label})]})]}),!le&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"truncate",style:{fontSize:`${q}px`,color:"#999",lineHeight:1,marginBottom:"2px"},children:[ur(E.start,"HH:mm"),"",ur(E.end,"HH:mm")]}),E.modality&&a.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm mb-0.5",style:{fontSize:Math.max(7,Y-1),display:"inline-block",width:"fit-content"},children:E.modality}),a.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",children:[$&&a.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[!f&&!y&&a.jsx($,{style:{width:J,height:J,color:W.hex}}),a.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${Y}px`,color:W.hex,lineHeight:1},children:E.status==="in_progress"?"Andamento":W.label})]}),ce>0&&a.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${Z===ce?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,Y-1)},children:[a.jsx(Ko,{style:{width:Math.max(12,Y),height:Math.max(12,Y)}}),a.jsxs("span",{children:[Z,"/",ce]})]})]})]})]})},E.id)};return a.jsxs("div",{className:"flex-1 bg-surface rounded-lg border border-border flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex sticky top-0 z-20 bg-surface border-b border-border",children:[a.jsx("div",{className:"w-20 flex-shrink-0 flex items-center justify-center font-semibold text-sm border-r border-border bg-surface",children:"Horrios"}),a.jsxs("div",{ref:h,"data-header-scroll":!0,className:"flex flex-1 overflow-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none",paddingRight:`${v}px`,minWidth:0},children:[a.jsx("style",{children:`
            [data-header-scroll]::-webkit-scrollbar {
              display: none;
            }
          `}),b.map(E=>a.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] flex flex-col items-center justify-center py-3 border-r border-border bg-surface-2/50 text-center",children:[a.jsx("div",{className:"text-xs font-semibold text-text-muted",children:ur(E,"EEE",{locale:la}).toUpperCase()}),a.jsx("div",{className:"text-sm font-bold text-text-primary",children:ur(E,"dd")})]},ur(E,"yyyy-MM-dd")))]})]}),a.jsxs("div",{ref:m,className:"flex flex-1 overflow-auto",style:{minWidth:0},children:[a.jsxs("div",{className:"w-20 flex-shrink-0 bg-surface sticky left-0 z-10 flex flex-col relative",style:{borderRight:"1px solid var(--color-border)",minHeight:`${_}px`},children:[j.map(E=>a.jsxs(Se.Fragment,{children:[a.jsx("div",{className:gr("relative border-b border-border/60",E%2===1&&"bg-surface-2/30"),style:{height:wm},children:a.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(E).padStart(2,"0"),":00"]})}),a.jsx("div",{className:gr("relative border-b border-border/60",E%2===1&&"bg-surface-2/30"),style:{height:wm},children:a.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(E).padStart(2,"0"),":30"]})})]},`time-${E}`)),a.jsx("div",{className:"absolute right-0 top-0 w-px bg-border pointer-events-none",style:{height:`${_}px`}})]}),b.map(E=>{const A=ur(E,"yyyy-MM-dd"),F=C[A]||[],D=u[A]||{},I=r&&D[r]&&!D[r].funciona;return a.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] relative border-r border-border bg-surface-2/10",style:{minHeight:`${_}px`},children:[j.map(R=>a.jsx("div",{className:gr("border-b border-border/60",R%2===1&&"bg-surface-2/5"),style:{height:wm*2},children:I?a.jsx("div",{className:"w-full h-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/60 transition-colors",onClick:M=>M.preventDefault(),children:a.jsxs("div",{className:"text-center pointer-events-none",children:[a.jsx(l4,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),a.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),D[r]?.observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:D[r].observacao})]})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:wm},onClick:()=>{const M=new Date(E.getTime());M.setHours(R,0,0,0),console.log("Slot :00 clicked",{day:E,hour:R,slotDate:M,activeCourtFilter:r}),i?.(M,r)}}),a.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:wm},onClick:()=>{const M=new Date(E.getTime());M.setHours(R,30,0,0),console.log("Slot :30 clicked",{day:E,hour:R,slotDate:M,activeCourtFilter:r}),i?.(M,r)}})]})},`${A}-${R}`)),F.map(R=>P(R,s))]},A)})]})]})}const Oa=30,ov=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,s]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${s}`},gf=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function B9(e){const t=String(e||"").trim().split(/\s+/).filter(Boolean);return t.length===0?"":t.length===1?t[0]:`${t[0]} ${t[1]}`}const Ai=56,sZe=6,VT=6,dae=24;Array.from({length:(dae-VT)*(60/Oa)},(e,t)=>{const r=VT*60+t*Oa,n=Math.floor(r/60),s=r%60;return{time:`${String(n).padStart(2,"0")}:${String(s).padStart(2,"0")}`,isHourMark:s===0}});const rp=["Futebol","Beach Tennis","Futevlei","Treino"];function pp(e){return Cd(e,{weekStartsOn:1})}function oZe(e){const t=pp(e),r=La(t,6);return t.getMonth()===r.getMonth()?`${ur(t,"dd")}-${ur(r,"dd")} de ${ur(r,"MMMM",{locale:la})} de ${ur(r,"yyyy")}`:`${ur(t,"dd")} de ${ur(t,"MMMM",{locale:la})} - ${ur(r,"dd")} de ${ur(r,"MMMM",{locale:la})} de ${ur(r,"yyyy")}`}const ni={scheduled:{label:"Agendado",accent:"bg-[#3B82F6]",text:"text-[#3B82F6]",border:"border-[#3B82F6]",hex:"#3B82F6",icon:Vs},confirmed:{label:"Confirmado",accent:"bg-[#22C55E]",text:"text-[#22C55E]",border:"border-[#22C55E]",hex:"#22C55E",icon:Do},in_progress:{label:"Em andamento",accent:"bg-[#FACC15]",text:"text-[#FACC15]",border:"border-[#FACC15]",hex:"#FACC15",icon:zH},finished:{label:"Finalizado",accent:"bg-[#6B7280]",text:"text-[#6B7280]",border:"border-[#6B7280]",hex:"#6B7280",icon:jue},canceled:{label:"Cancelado",accent:"bg-[#EF4444]",text:"text-[#EF4444]",border:"border-[#EF4444]",hex:"#EF4444",icon:Bp},absent:{label:"Ausente",accent:"bg-[#F97316]",text:"text-[#F97316]",border:"border-[#F97316]",hex:"#F97316",icon:WH}},iZe={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},q9={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},z9=e=>{let t=Math.floor(e/60);const r=e%60;return t>=24&&(t=t%24),`${String(t).padStart(2,"0")}:${String(r).padStart(2,"0")}`};function lZe({sidebarVisible:e=!1}){const{toast:t}=as(),{loadAlerts:r}=PC(),n=Lo(),{isPaymentModalOpen:s,openPaymentModal:o,closePaymentModal:i,isEditParticipantModalOpen:l,openEditParticipantModal:c,closeEditParticipantModal:d,editParticipantData:u,editingBooking:f,setEditingBooking:h,participantsForm:m,setParticipantsForm:v,paymentTotal:g,setPaymentTotal:y,payMethods:x,setPayMethods:b}=eN(),w=p.useMemo(()=>{try{return typeof window<"u"&&localStorage.getItem("debug:agenda")==="1"}catch{return!1}},[]),j=p.useCallback((...Ie)=>{if(w)try{console.log("[AgendaDbg]",...Ie)}catch{}},[w]);p.useEffect(()=>{try{yr.current=Date.now()+2500,j("runAutomation:startup grace set",{until:yr.current}),setTimeout(()=>{try{$a()}catch{}},2500+200)}catch{}const Ie=console.log,Xe=console.info,rr=console.debug,Gt=console.warn,Vt=console.error,Mt=S=>{const G=String(S||"");return G.startsWith("[AgendaDbg]")||!1||G.startsWith("[PulseDump]")||G.startsWith("[Clientes:load]")||G.startsWith("[AgendaSettings]")||G.startsWith("[Auto]")||G.startsWith("[DEBUG-PaymentModal]")||G.startsWith(" EditGuard")};return console.log=(...S)=>{try{if(Mt(S[0]))return}catch{}return Ie(...S)},console.info=(...S)=>{try{if(Mt(S[0]))return}catch{}return Xe(...S)},console.debug=(...S)=>{try{if(Mt(S[0]))return}catch{}return rr(...S)},console.warn=(...S)=>{try{if(Mt(S[0]))return}catch{}return Gt(...S)},console.error=(...S)=>{try{if(Mt(S[0]))return}catch{}return Vt(...S)},()=>{console.log=Ie,console.info=Xe,console.debug=rr,console.warn=Gt,console.error=Vt}},[]);const _=p.useRef({active:!1,tag:"",start:0,timer:null,events:[]}),C=p.useCallback((Ie,Xe)=>{if(w)try{const rr=Date.now(),Gt=_.current&&_.current.active?rr-(_.current.start||rr):0;_.current.events.push({t:rr,ms:Gt,event:Ie,data:Xe})}catch{}},[w]),P=p.useCallback(Ie=>{if(w){try{if(!_.current.active)return;const{tag:Xe,start:rr,events:Gt}=_.current,Vt=`[PulseDump] tag=${Xe} dur=${Date.now()-rr}ms reason=${Ie}`;console.groupCollapsed(Vt);for(const Mt of Gt)console.log(` +${String(Mt.ms).padStart(4," ")}ms`,Mt.event,Mt.data||{});console.groupEnd()}catch{}try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!1,tag:"",start:0,timer:null,events:[]}}},[w]),E=p.useCallback((Ie,Xe=5e3)=>{if(w){try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!0,tag:Ie,start:Date.now(),timer:null,events:[]},_.current.timer=setTimeout(()=>P("timeout"),Xe),j("PulseStart",{tag:Ie,timeoutMs:Xe})}},[w,P,j]),{userProfile:A,authReady:F,company:D}=vs(),[I,R]=eC(),[M,U]=p.useState(new Date),[z,W]=p.useState("day"),[$,ee]=p.useState(!1),[ve,_e]=p.useState({}),[K,q]=p.useState(!1),[Y,J]=p.useState({}),fe=p.useMemo(()=>{const Ie=D?.nome_fantasia||D?.nome||D?.razao_social||D?.codigoEmpresa||"";return String(Ie).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"").trim()},[D?.nome_fantasia,D?.nome,D?.razao_social,D?.codigoEmpresa]),Z=p.useMemo(()=>fe?`https://${fe}.f7arena.com`:"",[fe]),ce=p.useCallback(async Ie=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(Ie);else{const Xe=document.createElement("textarea");Xe.value=Ie,Xe.style.position="fixed",Xe.style.top="0",Xe.style.left="0",Xe.style.opacity="0",document.body.appendChild(Xe),Xe.focus(),Xe.select(),document.execCommand("copy"),document.body.removeChild(Xe)}return!0}catch{return!1}},[]);p.useEffect(()=>{const Ie=Xe=>{if(Xe.key==="Escape"&&$){ee(!1);return}if(Xe.key==="F10"){try{Xe.preventDefault()}catch{}ee(rr=>!rr)}};return window.addEventListener("keydown",Ie),()=>window.removeEventListener("keydown",Ie)},[$]),p.useEffect(()=>{if($&&window.innerWidth<768)if(screen.orientation&&screen.orientation.lock)screen.orientation.lock("landscape").catch(()=>{const Ie=document.getElementById("screen-orientation-meta");Ie&&Ie.setAttribute("content","landscape")});else{const Ie=document.getElementById("screen-orientation-meta");Ie&&Ie.setAttribute("content","landscape")}else if(!$&&window.innerWidth<768){screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock();const Ie=document.getElementById("screen-orientation-meta");Ie&&Ie.setAttribute("content","portrait-primary")}},[$]),p.useEffect(()=>{const Ie=I.get("date");if(Ie)try{const Xe=new Date(Ie+"T00:00:00");isNaN(Xe.getTime())||(U(Xe),I.delete("date"),R(I,{replace:!0}))}catch(Xe){console.error("[AgendaPage] Erro ao parsear date da URL:",Xe)}},[I,R]);const[le,ie]=p.useState([]),[te,ue]=p.useState(!1),[Te,ne]=p.useState(!1),de=p.useRef(!1);p.useEffect(()=>{de.current||!F||!A?.codigo_empresa||M&&(de.current=!0,(async()=>{try{const Ie=Es(M),Xe=La(Ie,1),{data:rr,error:Gt}=await he.from("agendamentos").select("id, codigo, inicio, fim, status, modalidade, quadra_id, cliente_id, auto_disabled, clientes").eq("codigo_empresa",A.codigo_empresa).gte("inicio",Ie.toISOString()).lt("inicio",Xe.toISOString()).order("inicio",{ascending:!0});if(Gt)return;const Vt=(rr||[]).map(Mt=>({id:Mt.id,code:Mt.codigo,start:new Date(Mt.inicio),end:new Date(Mt.fim),status:Mt.status||"scheduled",modality:Mt.modalidade||"",customer:Array.isArray(Mt.clientes)&&Mt.clientes.length>0?Mt.clientes[0]:"",court:String(Mt.quadra_id||""),court_id:Mt.quadra_id,auto_disabled:!!Mt.auto_disabled}));ie(Mt=>Array.isArray(Mt)&&Mt.length>0?Mt:Vt)}catch{}})())},[F,A?.codigo_empresa,M,he]);const[lt,Nt]=p.useState(4),[at,gt]=p.useState(!1),[Pt,yt]=p.useState(!1),Qe=f,ge=h,[rt,pt]=p.useState({}),We=p.useRef(0),Ze=p.useRef("");p.useEffect(()=>{const Ie=Xe=>{try{const rr=Xe?.detail||{},Gt=rr.agendamentoId,Vt=rr.participants;if(!Gt||!Array.isArray(Vt))return;pt(Mt=>{const S=Mt[Gt]||[],G=Vt.map((se,Ae)=>{const V=S[Ae]||{};return{...V,cliente_id:se.cliente_id,nome:se.nome,codigo:V.codigo!==void 0?V.codigo:se.codigo??null,valor_cota:typeof se.valor_cota=="string"?se.valor_cota:V.valor_cota??"",status_pagamento:se.status_pagamento||V.status_pagamento||"Pendente",finalizadora_id:se.finalizadora_id??V.finalizadora_id??null,aplicar_taxa:se.aplicar_taxa??V.aplicar_taxa??!1,ordem:V.ordem??Ae+1}});return{...Mt,[Gt]:G}})}catch{}};return window.addEventListener("payments:saved",Ie),()=>window.removeEventListener("payments:saved",Ie)},[]);const Ne=p.useRef(!1);p.useEffect(()=>{Ne.current=te,j("Modal state change:",{isModalOpen:te}),C("modal",{open:te})},[te,j]);const ye=p.useRef("init"),Be=p.useRef(0),mt=p.useRef(!1),Ft=p.useRef(0),fr=p.useRef(!1),It=p.useRef(0),[Ut,xe]=p.useState(!1),st=p.useRef(0),Ct=p.useRef(!1),ar=p.useRef(0),pr=p.useCallback((Ie=800)=>{ar.current=Date.now()+Ie,j("UI:busy set",{ms:Ie})},[j]),Xt=p.useCallback(()=>Date.now()<ar.current,[]),yr=p.useRef(0),lr=p.useRef(0),Rr=p.useRef(!1),Pn=p.useCallback(()=>{const Ie=Date.now();te||Ie-lr.current<350||(lr.current=Ie,ue(!0),Rr.current=!0)},[te]),De=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!te&&!De.current&&(De.current=!0,Pn(),window.history.replaceState({},document.title))},[n.state?.openModal,te,Pn]);const[ke,Ge]=p.useState({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),[Re,bt]=p.useState(null),[Qt,ct]=p.useState(!0),xt=p.useMemo(()=>Object.fromEntries((Re??[]).map(Ie=>[Ie.nome,Ie])),[Re]),it=p.useMemo(()=>(Re??[]).map(Ie=>Ie.nome),[Re]),[kt,be]=p.useState([]),dt=A?.codigo_empresa,Lt=p.useMemo(()=>dt?`quadras:list:${dt}`:"quadras:list",[dt]),mr=p.useMemo(()=>dt?`agenda:selectedCourts:${dt}`:"agenda:selectedCourts",[dt]),tr=p.useMemo(()=>dt?`agenda:viewFilter:${dt}`:"agenda:viewFilter",[dt]),[Or,Lr]=p.useState(null),[sr,fn]=p.useState(0);p.useEffect(()=>{kt.length>0&&Or===null&&Lr(kt[0])},[kt,Or]);const[Tn,mn]=p.useState([]),zn=p.useRef(null),ot=p.useRef({scheduled:!0,canceledOnly:!1}),[$t,Yt]=p.useState(null),[Ht,Ot]=p.useState(""),Xr=p.useRef(0),Je=p.useRef(!1),cr=p.useRef(!1),[vt,Tt]=p.useState(!1),[Dr,an]=p.useState(()=>{try{return localStorage.getItem("agenda:hideCanceledInfo")==="1"}catch{return!1}});p.useEffect(()=>{try{localStorage.setItem("agenda:hideCanceledInfo",Dr?"1":"0")}catch{}},[Dr]);const Nr=p.useMemo(()=>{if(!A?.codigo_empresa)return null;const Ie=ur(z==="week"?pp(M):M,"yyyy-MM-dd"),Xe=z==="week"?"week":"day";return`agenda:bookings:${A.codigo_empresa}:${Xe}:${Ie}`},[A?.codigo_empresa,M,z]),St=p.useMemo(()=>{if(!A?.codigo_empresa)return null;const Ie=ur(M,"yyyy-MM-dd");return`agenda:participants:${A.codigo_empresa}:${Ie}`},[A?.codigo_empresa,M]),[Fr,zr]=p.useState(!1),ha=p.useMemo(()=>({autoConfirmEnabled:!1,autoConfirmMinutesBefore:120,autoStartEnabled:!0,autoFinishEnabled:!0}),[]),[En,ae]=p.useState(ha),[Me,et]=p.useState(ha),[re,O]=p.useState(!1),[T,X]=p.useState(0),H=p.useCallback(()=>Date.now()+(Number.isFinite(T)?T:0),[T]),[L,Fe]=p.useState(null);p.useEffect(()=>{(async()=>{if(console.log("[AgendaSettings][LOAD] Iniciando carregamento...",{authReady:F,company_id:D?.id}),!F||!D?.id){console.warn("[AgendaSettings][LOAD] Aguardando autenticao...");return}try{console.log("[AgendaSettings][LOAD] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][LOAD] Buscando para empresa_id:",D.id);const{data:Xe,error:rr}=await he.from("agenda_settings").select("*").eq("empresa_id",D.id).maybeSingle();if(console.log("[AgendaSettings][LOAD] Resultado da query:",{data:Xe,error:rr}),console.log("[AgendaSettings][LOAD] Data type:",Xe===null?"null":typeof Xe),rr){console.error("[AgendaSettings][LOAD] ERRO ao carregar:",rr);return}if(!Xe){console.warn("[AgendaSettings][LOAD] Nenhum registro encontrado (ainda no criado)");return}console.log("[AgendaSettings][LOAD]  Registro encontrado:",Xe);const Gt={autoConfirmEnabled:!!Xe.auto_confirm_enabled,autoConfirmMinutesBefore:Xe.auto_confirm_enabled&&Number.isFinite(Number(Xe.auto_confirm_hours))?Number(Xe.auto_confirm_hours)*60:ha.autoConfirmMinutesBefore,autoStartEnabled:!!Xe.auto_start_enabled,autoFinishEnabled:!!Xe.auto_finish_enabled};console.log("[AgendaSettings][LOAD]  Estado mapeado:",Gt),ae(Vt=>({...Vt,...Gt})),et(Gt),console.log("[AgendaSettings][LOAD]  Estados atualizados com sucesso!")}catch(Xe){console.warn("[AgendaSettings] unexpected load error",Xe)}})()},[F,D?.id]),p.useEffect(()=>{let Ie=!0,Xe=null,rr=!1;const Gt=async()=>{try{const{data:Vt,error:Mt}=await he.functions.invoke("time-br",{body:{}});if(!Mt&&Vt&&Ie){const S=Number(Vt.nowMs);if(Number.isFinite(S)){const G=S-Date.now();X(G),Fe(Date.now());return}}if(!rr){rr=!0;try{console.warn("[TimeSync] time-br sem dados vlidos; usando relgio local.")}catch{}}}catch{if(!rr){rr=!0;try{console.warn("[TimeSync] time-br falhou; usando relgio local.")}catch{}}}};return Gt(),Xe=setInterval(Gt,5*60*1e3),()=>{Ie=!1,Xe&&clearInterval(Xe)}},[]);const[nt,ft]=p.useState({}),Bt=2*60*60*1e3,$e=p.useCallback(Ie=>{ft(Xe=>({...Xe,[Ie]:Date.now()}))},[]),Dt=p.useCallback(Ie=>{ft(Xe=>{if(!Xe||!(Ie in Xe))return Xe;const rr={...Xe};return delete rr[Ie],rr})},[]),Sr=p.useCallback(Ie=>{const Xe=nt?.[Ie];return typeof Xe=="number"&&Date.now()-Xe<Bt},[nt]),[Pr,vr]=p.useState(null),yn=p.useCallback(()=>new Promise(Ie=>{vr({resolve:Ie})}),[]),On=p.useRef(new Map),Xn=async()=>{console.log(" [AgendaSettings][SAVE] FUNO CHAMADA! "),console.log("[AgendaSettings][SAVE] Linha 509 - Antes do try");try{if(console.log("[AgendaSettings][SAVE] Linha 511 - Dentro do try"),console.log("[AgendaSettings][SAVE] authReady:",F),console.log("[AgendaSettings][SAVE] company:",D),!F||!D?.id){console.error("[AgendaSettings][SAVE] ERRO: No autenticado",{authReady:F,company:D}),t({title:"No autenticado",description:"Faa login para salvar as configuraes.",variant:"destructive"});return}console.log("[AgendaSettings][SAVE]  Autenticado! Preparando payload..."),console.log("[AgendaSettings][SAVE] automation atual:",En),O(!0);const Ie={empresa_id:D.id,auto_confirm_enabled:!!En.autoConfirmEnabled,auto_confirm_hours:En.autoConfirmEnabled?Math.max(0,Math.round(Number(En.autoConfirmMinutesBefore||0)/60)):null,auto_start_enabled:!!En.autoStartEnabled,auto_finish_enabled:!!En.autoFinishEnabled};console.log("[AgendaSettings][SAVE] Payload preparado:",Ie),console.log("[AgendaSettings][SAVE] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][SAVE] Supabase client type:",typeof he.from);const{data:Xe,error:rr}=await he.from("agenda_settings").upsert(Ie,{onConflict:"empresa_id"}).select();if(console.log("[AgendaSettings][SAVE] Resultado do upsert:",{data:Xe,error:rr}),console.log("[AgendaSettings][SAVE] Data type:",Array.isArray(Xe)?"array":typeof Xe),console.log("[AgendaSettings][SAVE] Data length:",Xe?.length),rr)throw console.error("[AgendaSettings][SAVE]  ERRO no upsert:",rr),rr;!Xe||Xe.length===0?console.error("[AgendaSettings][SAVE]  AVISO: Upsert no retornou dados!"):console.log("[AgendaSettings][SAVE]  Dados salvos com sucesso:",Xe[0]),et(En),console.log("[AgendaSettings][SAVE]  savedAutomation atualizado:",En),t({title:"Configuraes salvas",description:"As automaes da agenda foram atualizadas com sucesso."}),zr(!1),console.log("[AgendaSettings][SAVE]  Salvamento concludo!")}catch(Ie){console.error(" [AgendaSettings][SAVE] ERRO CAPTURADO:",Ie),console.error("[AgendaSettings][SAVE] Stack:",Ie?.stack),console.error("[AgendaSettings][SAVE] Message:",Ie?.message);const Xe=Ie?.message||"Falha ao salvar as configuraes.";t({title:"Erro ao salvar",description:Xe,variant:"destructive"})}finally{console.log("[AgendaSettings][SAVE] Finally executado"),O(!1)}},kn=p.useCallback(async(Ie,Xe,rr="user")=>{try{const Gt=["canceled","finished","absent"],Vt=["scheduled","confirmed","in_progress"],Mt=Gt.includes(Xe);let S=!1;if(rr==="user"&&Vt.includes(Xe)){const Ae=(le||[]).find(Pe=>Pe.id===Ie),V=Ae?Gt.includes(Ae.status):!1,oe=Ae?!!Ae.auto_disabled:!1;(V||oe)&&(S=!!await yn())}const G=Mt?{status:Xe,auto_disabled:!0}:S?{status:Xe,auto_disabled:!1}:{status:Xe},{error:se}=await he.from("agendamentos").update(G).eq("codigo_empresa",A.codigo_empresa).eq("id",Ie).select("id");if(se)throw se;ie(Ae=>Ae.map(V=>{if(V.id!==Ie)return V;const oe={...V,status:Xe,customer:V.customer||""};return Mt?oe.auto_disabled=!0:S&&(oe.auto_disabled=!1),oe}));try{On.current.set(Ie,{status:Xe,ts:Date.now(),src:rr})}catch{}try{const Ae=JSON.parse(localStorage.getItem(Nr)||"[]");if(Array.isArray(Ae)&&Ae.length>0){const V=Array.isArray(Ae)?Ae.map(oe=>{if(oe.id!==Ie)return oe;const Pe={...oe,status:Xe,customer:oe.customer||""};return Mt?Pe.auto_disabled=!0:S&&(Pe.auto_disabled=!1),Pe}):Ae;localStorage.setItem(Nr,JSON.stringify(V))}}catch{}if(rr==="user")try{S?Dt(Ie):$e(Ie)}catch{}}catch(Gt){console.error("Auto-status: falha ao atualizar",Ie,Xe,Gt)}},[le,Nr,$e,Dt,yn,ke]),cn=p.useRef(!1),Hr=p.useRef(null),va=p.useRef(null),Ma=p.useRef(!1),xa=p.useCallback(()=>{try{Hr.current&&(clearTimeout(Hr.current),Hr.current=null)}catch{}},[]),$a=p.useCallback(()=>{if(!F||!A?.codigo_empresa)return;if(Date.now()<(yr.current||0)){console.log("[AutoDiag] scheduleNextAutomation:deferred returning-from-hidden"),setTimeout(()=>$a(),1500);return}if(!Ma.current){j("scheduleNextAutomation:skipped (initial data not ready)"),setTimeout(()=>$a(),800);return}if(Ne.current){j("scheduleNextAutomation:skipped (modal open)");return}C("auto:schedule"),xa();const Xe=H();let rr=1/0;const Gt=Vt=>{Number.isFinite(Vt)&&Vt>Xe&&Vt<rr&&(rr=Vt)};try{for(const Vt of le||[]){if(!Vt||Vt.auto_disabled||Sr(Vt.id))continue;const Mt=Vt.start instanceof Date?Vt.start.getTime():new Date(Vt.start).getTime(),S=Vt.end instanceof Date?Vt.end.getTime():new Date(Vt.end).getTime();if(Vt.status==="scheduled"&&Me.autoConfirmEnabled){const G=Number(Me.autoConfirmMinutesBefore||0)*6e4;Gt(Mt-G),Me.autoFinishEnabled&&Gt(S)}Vt.status==="confirmed"&&(Me.autoStartEnabled&&Gt(Mt),Me.autoFinishEnabled&&Gt(S)),Vt.status==="in_progress"&&Me.autoFinishEnabled&&Gt(S)}}catch{}if(rr!==1/0){const Vt=Math.max(0,Math.min(rr-Xe+250,6e5));try{console.debug("[Auto] next schedule in ms",Vt)}catch{}try{af(rr)}catch{}Hr.current=setTimeout(()=>{try{va.current&&va.current()}catch{}},Vt)}},[F,A?.codigo_empresa,le,Me,Sr,xa,H]),oo=p.useCallback(async Ie=>{try{if(!(typeof L=="number"&&Date.now()-L<6e5))try{const{data:Gt}=await he.functions.invoke("time-br",{body:{}}),Vt=Number(Gt?.nowMs);Number.isFinite(Vt)&&(X(Vt-Date.now()),Fe(Date.now()))}catch{}try{$a()}catch{}let rr=null;if(Ie?.id&&A?.codigo_empresa){const{data:Gt}=await he.from("agendamentos").select("id, inicio, fim, status, modalidade, quadra_id, cliente_id, auto_disabled").eq("codigo_empresa",A.codigo_empresa).eq("id",Ie.id).single();if(Gt){const Vt={...Ie,start:new Date(Gt.inicio),end:new Date(Gt.fim),status:Gt.status||Ie.status,modality:Gt.modalidade||Ie.modality,auto_disabled:!!Gt.auto_disabled,customer:Ie.customer||""};rr=Vt,ie(Mt=>Mt.map(S=>S.id===Ie.id?Vt:S))}}try{const Gt=rr||Ie;if(Gt&&Gt.id){const Vt=H(),Mt=Gt.start instanceof Date?Gt.start.getTime():new Date(Gt.start).getTime(),S=Gt.end instanceof Date?Gt.end.getTime():new Date(Gt.end).getTime();if(!Gt.auto_disabled&&!Sr(Gt.id))if(Gt.status==="in_progress"&&Me.autoFinishEnabled&&Number.isFinite(S)&&Vt>=S)await kn(Gt.id,"finished","automation");else if(Gt.status==="scheduled"&&Me.autoStartEnabled&&Number.isFinite(Mt)&&Vt>=Mt)await kn(Gt.id,"in_progress","automation");else if(Gt.status==="confirmed"&&Me.autoStartEnabled&&Number.isFinite(Mt)&&Vt>=Mt)await kn(Gt.id,"in_progress","automation");else if(Gt.status==="scheduled"&&Me.autoConfirmEnabled&&Number.isFinite(Mt)){const se=Number(Me.autoConfirmMinutesBefore||0)*6e4;Vt>=Mt-se&&await kn(Gt.id,"confirmed","automation")}else(Gt.status==="scheduled"||Gt.status==="confirmed")&&Me.autoFinishEnabled&&Number.isFinite(S)&&Vt>=S&&await kn(Gt.id,"finished","automation")}}catch{}try{va.current&&va.current()}catch{}try{console.log(" EditGuard | ok | tempo=",typeof L=="number"?"Servidor":"Local")}catch{}return{booking:rr}}catch(Xe){try{console.warn(" EditGuard | falha leve",Xe?.message||Xe)}catch{}return{booking:null}}},[L,he,A,ie,$a,H,En,Sr,kn]);p.useEffect(()=>{if(!(!F||!A?.codigo_empresa)&&L&&!Ma.current){Ma.current=!0,j("initial-data:ready",{at:L});try{$a()}catch{}}},[L,F,A,$a,j]);const ss=p.useCallback(async()=>{if(!(!F||!A?.codigo_empresa)){if(Ne.current){j("runAutomation:skipped (modal open)");return}if(Date.now()<(yr.current||0)){j("runAutomation:skipped (returning-from-hidden grace)");try{$a()}catch{}return}if(!Ma.current){j("runAutomation:skipped (initial data not ready)");try{$a()}catch{}return}if(!cn.current){cn.current=!0;try{try{console.debug("[Auto] tick")}catch{}C("auto:tick");const Ie=H(),Xe=new Date(Ie),rr=ur(Xe,"yyyy-MM-dd");let Gt=(le||[]).filter(Mt=>ur(Mt.start,"yyyy-MM-dd")===rr);if(Gt.length===0)try{const Mt=Es(Xe),S=La(Mt,1),{data:G,error:se}=await he.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",A.codigo_empresa).gte("inicio",Mt.toISOString()).lt("inicio",S.toISOString());!se&&Array.isArray(G)&&(Gt=G.map(Ae=>({id:Ae.id,start:new Date(Ae.inicio),end:new Date(Ae.fim),status:Ae.status||"scheduled",auto_disabled:!!Ae.auto_disabled})))}catch{}try{const{data:Mt,error:S}=await he.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",A.codigo_empresa).lt("fim",Xe.toISOString()).in("status",["scheduled","confirmed","in_progress"]);if(!S&&Array.isArray(Mt)&&Mt.length>0){const G=Mt.map(Ae=>({id:Ae.id,start:new Date(Ae.inicio),end:new Date(Ae.fim),status:Ae.status||"scheduled",auto_disabled:!!Ae.auto_disabled})),se=new Map(Gt.map(Ae=>[Ae.id,Ae]));for(const Ae of G)se.has(Ae.id)||se.set(Ae.id,Ae);Gt=Array.from(se.values())}}catch{}let Vt=!1;for(const Mt of Gt){if(Mt.auto_disabled||Sr(Mt.id))continue;const S=Mt.start instanceof Date?Mt.start.getTime():new Date(Mt.start).getTime(),G=Mt.end instanceof Date?Mt.end.getTime():new Date(Mt.end).getTime();if(Mt.status==="in_progress"&&Me.autoFinishEnabled&&Ie>=G){try{console.debug("[Auto] finish",{id:Mt.id})}catch{}await kn(Mt.id,"finished","automation"),Vt=!0;continue}if(Mt.status==="scheduled"&&Me.autoStartEnabled&&Ie>=S){try{console.debug("[Auto] start-direct (skip confirm)",{id:Mt.id})}catch{}await kn(Mt.id,"in_progress","automation"),Vt=!0;continue}if(Mt.status==="confirmed"&&Me.autoStartEnabled&&Ie>=S){try{console.debug("[Auto] start",{id:Mt.id})}catch{}await kn(Mt.id,"in_progress","automation"),Vt=!0;continue}if(Mt.status==="scheduled"&&Me.autoConfirmEnabled){const se=Number(Me.autoConfirmMinutesBefore||0)*6e4;if(Ie>=S-se){try{console.debug("[Auto] confirm",{id:Mt.id})}catch{}await kn(Mt.id,"confirmed","automation"),Vt=!0;continue}}if((Mt.status==="scheduled"||Mt.status==="confirmed")&&Me.autoFinishEnabled&&Ie>=G){try{console.debug("[Auto] catchup-finish",{id:Mt.id})}catch{}await kn(Mt.id,"finished","automation"),Vt=!0;continue}}if(Vt)try{setTimeout(()=>{try{xs()}catch{}},800)}catch{}try{$a()}catch{}}finally{cn.current=!1}}}},[F,A?.codigo_empresa,le,Me,kn,Sr,$a,H]);p.useEffect(()=>{va.current=ss},[ss]),p.useEffect(()=>{const Ie=setInterval(ss,1e4);try{va.current&&va.current()}catch{}try{$a()}catch{}return()=>clearInterval(Ie)},[ss]),p.useEffect(()=>{const Ie=setInterval(()=>{try{if(!!!(Me?.autoConfirmEnabled||Me?.autoStartEnabled||Me?.autoFinishEnabled))return;va.current&&(console.debug("[Auto][Watchdog] forcing periodic automation run"),va.current())}catch{}},18e5);return()=>clearInterval(Ie)},[Me]),p.useEffect(()=>{if(Nr)try{const Ie=JSON.parse(localStorage.getItem(Nr)||"[]");if(Array.isArray(Ie)&&Ie.length>0){const Xe=Ie.map(rr=>({...rr,start:new Date(rr.start),end:new Date(rr.end),customer:rr.customer||""}));j("cache:bookings:hydrate",{count:Xe.length,sample:Xe[0]}),C("cache:hydrate",{count:Xe.length}),ie(rr=>rr&&rr.length>0?rr:Xe),pr(1200)}}catch{}},[Nr,j]),p.useEffect(()=>{const Ie=()=>{try{const Gt=new Date().toISOString();if(document.visibilityState==="visible"){const Vt=Date.now();yr.current=Vt+800}}catch{}},Xe=()=>{try{const Gt=new Date().toISOString()}catch{}},rr=()=>{try{const Gt=new Date().toISOString()}catch{}};return document.addEventListener("visibilitychange",Ie),window.addEventListener("focus",Xe),window.addEventListener("blur",rr),()=>{document.removeEventListener("visibilitychange",Ie),window.removeEventListener("focus",Xe),window.removeEventListener("blur",rr)}},[te,le]),p.useEffect(()=>{try{$a()}catch{}return()=>{try{xa()}catch{}}},[le,En,$a,xa]),p.useEffect(()=>{if(St)try{const Ie=JSON.parse(localStorage.getItem(St)||"{}");Ie&&typeof Ie=="object"&&(pt(Ie),Ze.current=ur(M,"yyyy-MM-dd"))}catch{}},[St]);const xs=p.useCallback(async()=>{if(!F||!A?.codigo_empresa||te)return;j("fetchBookings:start",{date:ur(M,"yyyy-MM-dd"),empresa:A?.codigo_empresa}),C("fetch:start",{day:ur(M,"yyyy-MM-dd")});const Ie=Es(M),Xe=z==="week"?pp(M):Ie,rr=z==="week"?La(Xe,7):La(Xe,1),{data:Gt,error:Vt}=await he.from("agendamentos").select(`
        id, codigo, codigo_empresa, quadra_id, cliente_id, clientes, inicio, fim, modalidade, status, auto_disabled,
        quadra:quadra_id ( nome )
      `).eq("codigo_empresa",A.codigo_empresa).gte("inicio",Xe.toISOString()).lt("inicio",rr.toISOString()).order("inicio",{ascending:!0});if(Vt){j("fetchBookings:error",{message:Vt?.message,code:Vt?.code,status:Vt?.status}),C("fetch:error",{message:Vt?.message,code:Vt?.code,status:Vt?.status}),t({title:"Erro ao carregar agendamentos",description:Vt.message,variant:"destructive"}),Je.current||(Je.current=!0,setTimeout(xs,900));return}if(!Gt||Gt.length===0){j("fetchBookings:empty-first-hit"),C("fetch:empty-first");let G=!1;try{const se=Nr?JSON.parse(localStorage.getItem(Nr)||"[]"):[];G=Array.isArray(se)&&se.length>0}catch{}if(!Je.current&&(Je.current=!0,G)){setTimeout(xs,700);return}}Je.current=!1;const Mt=Date.now(),S=(Gt||[]).map(G=>{const se=new Date(G.inicio),Ae=new Date(G.fim),V=G.quadra?.[0]?.nome||G.quadra?.nome||Object.values(xt).find(He=>He.id===G.quadra_id)?.nome||"";let oe="";if(rt[G.id]){const He=rt[G.id];Array.isArray(He)&&He.length>0&&(oe=He[0]?.nome||"")}if(!oe&&G.clientes)try{const He=typeof G.clientes=="string"?JSON.parse(G.clientes):G.clientes;Array.isArray(He)&&He.length>0&&(oe=He[0]?.nome||He[0]||"")}catch{}const Pe=On.current.get(G.id),qe=Pe&&Mt-Pe.ts<4e3;return{id:G.id,code:G.codigo,court:V,customer:oe,start:se,end:Ae,status:qe?Pe.status:G.status||"scheduled",modality:G.modalidade||"",auto_disabled:!!G.auto_disabled}});ie(S);try{if(Nr){const G=S.map(se=>({id:se.id,code:se.code,court:se.court,customer:se.customer,start:se.start.toISOString(),end:se.end.toISOString(),status:se.status,modality:se.modality,auto_disabled:se.auto_disabled}));localStorage.setItem(Nr,JSON.stringify(G))}}catch{}},[F,A?.codigo_empresa,M,xt,Nr,t,j,w,rt]);p.useEffect(()=>{if(w)try{const Ie=(le||[]).map(Xe=>`${Xe.id}:${ur(Xe.start,"HH:mm")}-${ur(Xe.end,"HH:mm")}:${Xe.status}`).join(" | ");console.log("[AgendaDbg] bookings:changed",{count:Array.isArray(le)?le.length:0,summary:Ie})}catch{}},[le,w]),p.useEffect(()=>{try{const Ie=Date.now()+1800;Ft.current=Ie,j("Picker:suppressClose window set",{until:Ie})}catch{}},[le]),p.useEffect(()=>{F&&A?.codigo_empresa&&xs()},[F,A?.codigo_empresa,M,xt,Nr]);const So=p.useRef(null),[vi,Od]=p.useState("idle"),[xi,Uc]=p.useState(null),Li=p.useRef(!1);p.useEffect(()=>{if(!F||!A?.codigo_empresa)return;const Ie=Es(M),Xe=La(Ie,1),rr=se=>{try{const Ae=new Date(se);return Ae>=Ie&&Ae<Xe}catch{return!1}},Gt=se=>{const Ae=se?.new||se?.old;if(Ae&&Ae.codigo_empresa===A.codigo_empresa&&(rr(Ae.inicio)||rr(Ae.fim))){try{console.debug("[Realtime] agendamentos change",{event:se.eventType,id:Ae.id})}catch{}So.current&&clearTimeout(So.current);try{Uc(Date.now())}catch{}if(Ne.current){j("Realtime:onChange deferred due to modal open"),Li.current=!0,C("rt:change:deferred",{id:Ae.id,event:se.eventType});return}j("Realtime:onChange scheduling fetchBookings"),C("rt:change",{id:Ae.id,event:se.eventType}),So.current=setTimeout(()=>{try{j("Realtime:debounced fetchBookings fire"),C("rt:debounced:fire"),pr(300),xs()}catch{}},400)}},Vt=se=>{const Ae=se?.new||se?.old;if(Ae&&Ae.codigo_empresa===A.codigo_empresa){try{console.debug("[Realtime] agendamento_participantes change",{event:se.eventType,agendamento_id:Ae.agendamento_id})}catch{}So.current&&clearTimeout(So.current);try{Uc(Date.now())}catch{}if(Ne.current){j("Realtime:onParticipantsChange deferred due to modal open"),Li.current=!0,C("rt:participants:deferred",{agendamento_id:Ae.agendamento_id,event:se.eventType});return}j("Realtime:onParticipantsChange scheduling fetchBookings"),C("rt:participants",{agendamento_id:Ae.agendamento_id,event:se.eventType}),So.current=setTimeout(()=>{try{j("Realtime:participants debounced fetchBookings fire"),C("rt:participants:debounced:fire"),pr(300),xs()}catch{}},400)}},Mt=he.channel(`agendamentos:${A.codigo_empresa}`).on("postgres_changes",{event:"*",schema:"public",table:"agendamentos",filter:`codigo_empresa=eq.${A.codigo_empresa}`},Gt).subscribe(se=>{try{console.debug("[Realtime] channel status",se)}catch{}try{Od(String(se||"unknown"))}catch{}}),S=he.channel(`agendamento_participantes:${A.codigo_empresa}`).on("postgres_changes",{event:"*",schema:"public",table:"agendamento_participantes",filter:`codigo_empresa=eq.${A.codigo_empresa}`},Vt).subscribe(),G=setInterval(()=>{Ne.current||xs()},3e4);return()=>{try{So.current&&clearTimeout(So.current)}catch{}try{he.removeChannel(Mt)}catch{}try{he.removeChannel(S)}catch{}try{clearInterval(G)}catch{}try{Od("polling")}catch{}}},[F,A?.codigo_empresa,M,xs]),p.useEffect(()=>{if(!te&&Li.current){Li.current=!1;try{j("Modal closed: flushing pending realtime refresh"),C("rt:flushAfterModalClose"),xs()}catch{}}},[te,xs,j]);const[El,af]=p.useState(null),nc=p.useRef("");p.useEffect(()=>{try{const Ie=typeof L=="number"&&Date.now()-L<6e5,Xe=Ae=>typeof Ae=="number"?ur(new Date(Ae),"HH:mm:ss",{locale:la}):"",rr=Ae=>typeof Ae=="number"?ur(new Date(Ae),"HH:mm",{locale:la}):"",Gt=Ie?"":"",Mt=String(vi).toUpperCase()==="SUBSCRIBED"||String(vi).toLowerCase()==="polling"?"":"",S=typeof El=="number"?"":"",G=Array.isArray(le)?le.length:0,se=` Agenda | ${Gt} Tempo=${Ie?"Servidor":"Local"} (${Math.round(T)}ms, sync ${Xe(L)}) |  Realtime=${Mt} ${vi}${xi?` (${Xe(xi)})`:""} | ${S} Prximo=${rr(El)} |  Agendamentos=${G}`;nc.current!==se&&(nc.current=se,console.log(se)),typeof window<"u"&&(window.__AgendaConn={usingServer:Ie,serverOffsetMs:T,lastTimeSyncAtMs:L,realtimeStatus:vi,lastRealtimeEventAtMs:xi,nextAutoAtMs:El})}catch{}},[T,L,vi,xi,En,El,A?.codigo_empresa,M,Array.isArray(le)?le.length:0]),p.useEffect(()=>{const Ie=setInterval(()=>{try{const Xe=Date.now();if(Xe<(yr.current||0)){console.log("[AutoDiag] reconcile:skipped returning-from-hidden");return}if(te){console.log("[AutoDiag] reconcile:skipped modal-open");return}const rr=String(vi||"").toUpperCase()==="SUBSCRIBED",Gt=typeof xi=="number"?Xe-xi:1/0,Vt=!rr||Gt>7*60*1e3,Mt=typeof El=="number"?Xe>El+60*1e3:!1;if(Vt||Mt){console.debug("[Reconcile] forcing fetchBookings (stale=",Vt," tickDue=",Mt,")"),xs();try{$a()}catch{}}}catch{}},3e5);return()=>clearInterval(Ie)},[vi,xi,El,xs,$a]),p.useEffect(()=>{(async()=>{if(!F||!A?.codigo_empresa||Date.now()<(yr.current||0))return;if(Ne.current){j("Participants:skipped (modal open)");return}j("Participants:load start"),C("parts:start");const Xe=(le||[]).map(G=>G.id).filter(Boolean),rr=ur(M,"yyyy-MM-dd");if(!Xe.length){if(Ze.current!==rr){pt({});try{St&&localStorage.setItem(St,"{}")}catch{}}Ze.current=rr;return}const Gt=++We.current,{data:Vt,error:Mt}=await he.from("agendamento_participantes").select("id, agendamento_id, codigo_empresa, cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, ordem, cliente:clientes!agendamento_participantes_cliente_id_fkey(nome, codigo)").in("agendamento_id",Xe).order("ordem",{ascending:!0});if(We.current!==Gt)return;if(Mt){console.warn("[Participants] load error",Mt),j("Participants:error",{message:Mt?.message,code:Mt?.code,status:Mt?.status}),C("parts:error",{code:Mt?.code});return}const S={};for(const G of Vt||[]){const se=G.agendamento_id;S[se]||(S[se]=[]);const Ae=G.nome||(Array.isArray(G.cliente)?G.cliente[0]?.nome:G.cliente?.nome)||"",V=(Array.isArray(G.cliente)?G.cliente[0]?.codigo:G.cliente?.codigo)||null;S[se].push({...G,nome:Ae,codigo:V})}j("Participants:loaded",{bookings:Xe.length,rows:(Vt||[]).length}),C("parts:loaded",{rows:(Vt||[]).length}),Ze.current=rr,pt(G=>{const se={...G};for(const Ae of Xe)se[Ae]=S[Ae]||[];try{St&&localStorage.setItem(St,JSON.stringify(se))}catch{}return j("Participants:set state for ids",{ids:Xe}),C("parts:set",{idsCount:Xe.length}),se})})()},[F,A?.codigo_empresa,le,M,St,j]),p.useEffect(()=>{(async()=>{if(!(!F||!A?.codigo_empresa||!it.length)){q(!0);try{const Xe=ur(M,"yyyy-MM-dd"),rr=M.getDay(),{data:Gt,error:Vt}=await he.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",A.codigo_empresa).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${Xe}),and(tipo.eq.dia_semana,dia_semana.eq.${rr})`);if(Vt){console.error("Erro ao carregar dias de funcionamento:",Vt);return}const Mt={};it.forEach(S=>{const G=xt[S];if(!G)return;const se=Gt?.find(V=>V.quadra_id===G.id&&V.tipo==="data_fechamento"&&V.data_fechamento===Xe);if(se&&!se.funciona){Mt[S]={funciona:!1,motivo:"data_especifica",observacao:se.observacao||"Fechamento especial"};return}const Ae=Gt?.find(V=>V.quadra_id===G.id&&V.tipo==="dia_semana"&&V.dia_semana===rr);Ae?Mt[S]={funciona:Ae.funciona,motivo:Ae.funciona?"normal":"dia_semana",observacao:Ae.funciona?null:"Fechado neste dia da semana"}:Mt[S]={funciona:!0,motivo:"normal",observacao:null}}),_e(Mt)}catch(Xe){console.error("Erro ao verificar dias de funcionamento:",Xe)}finally{q(!1)}}})()},[F,A?.codigo_empresa,M,it,xt]),p.useEffect(()=>{if(!F||!A?.codigo_empresa||it.length===0)return;(async()=>{try{const Xe=new Date(M);Xe.setDate(Xe.getDate()-Xe.getDay());const{data:rr,error:Gt}=await he.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",A.codigo_empresa);if(Gt){console.error("Erro ao carregar funcionamento da semana:",Gt);return}const Vt={};for(let Mt=0;Mt<7;Mt++){const S=new Date(Xe);S.setDate(S.getDate()+Mt);const G=ur(S,"yyyy-MM-dd"),se=S.getDay(),Ae={};it.forEach(V=>{const oe=xt[V];if(!oe)return;const Pe=rr?.find(He=>He.quadra_id===oe.id&&He.tipo==="data_fechamento"&&He.data_fechamento===G);if(Pe&&!Pe.funciona){Ae[V]={funciona:!1,motivo:"data_especifica",observacao:Pe.observacao||"Fechamento especial"};return}const qe=rr?.find(He=>He.quadra_id===oe.id&&He.tipo==="dia_semana"&&He.dia_semana===se);qe?Ae[V]={funciona:qe.funciona,motivo:qe.funciona?"normal":"dia_semana",observacao:qe.funciona?null:"Fechado neste dia da semana"}:Ae[V]={funciona:!0,motivo:"normal",observacao:null}}),Vt[G]=Ae}J(Vt)}catch(Xe){console.error("Erro ao carregar funcionamento da semana:",Xe)}})()},[F,A?.codigo_empresa,M,it,xt]),p.useEffect(()=>{Object.values(ve).some(Xe=>!Xe.funciona)&&zn.current},[ve]),p.useEffect(()=>{if(dt)try{const Ie=JSON.parse(localStorage.getItem(Lt)||"[]");Array.isArray(Ie)&&Ie.length&&(!Re||Re.length===0)&&(bt(Ie),ct(!1))}catch{}},[dt,Lt]),p.useEffect(()=>{const Ie=async()=>{if(!A?.codigo_empresa)return;try{const Vt=JSON.parse(localStorage.getItem(Lt)||"[]");if(Array.isArray(Vt)&&Vt.length>0){const Mt=Vt[0]?.codigo_empresa;if(Mt&&Mt!==A.codigo_empresa){console.warn(" [Cache Limpo] Quadras de outra empresa detectadas e removidas"),localStorage.removeItem(Lt),localStorage.removeItem(mr),bt([]);try{be([])}catch{}try{Lr(null)}catch{}try{setForm(S=>({...S,court:""}))}catch{}}}}catch{}(!Re||Re.length===0)&&ct(!0);const{data:Xe,error:rr}=await he.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status").eq("codigo_empresa",A.codigo_empresa).eq("status","Ativa").order("nome",{ascending:!0});if(rr){t({title:"Erro ao carregar quadras",description:rr.message}),cr.current?ct(!1):(cr.current=!0,setTimeout(Ie,900));return}const Gt=Xe||[];if(Gt.length===0){let Vt=0;try{const Mt=JSON.parse(localStorage.getItem("quadras:list")||"[]");Vt=Array.isArray(Mt)?Mt.length:0}catch{}if(Vt>0&&!cr.current){cr.current=!0,ct(!1),setTimeout(Ie,700);return}}cr.current=!1,bt(Gt);try{localStorage.setItem(Lt,JSON.stringify(Gt))}catch{}ct(!1)};F&&A?.codigo_empresa&&Ie()},[F,A?.codigo_empresa,Lt,mr]),p.useEffect(()=>{try{if(Qt)return;const Ie=it||[];form?.court&&!Ie.includes(form.court)&&setForm(Xe=>({...Xe,court:Ie[0]||""})),(!form?.court||form.court==="")&&Ie.length>0&&setForm(Xe=>({...Xe,court:Ie[0]}))}catch{}},[Qt,it,A?.codigo_empresa]),p.useEffect(()=>{if(Qt)return;const Ie=(()=>{try{return JSON.parse(localStorage.getItem(mr)||"[]")}catch{return[]}})(),Xe=(()=>{try{return JSON.parse(localStorage.getItem(tr)||"{}")}catch{return{}}})(),rr=Ie.filter(Gt=>it.includes(Gt));rr.length>0?be(rr):kt.length===0&&be(it),Xe&&typeof Xe=="object"&&Ge(Gt=>({...Gt,canceledOnly:!1,...Xe}))},[Qt,it.length]),p.useEffect(()=>{try{localStorage.setItem(mr,JSON.stringify(kt))}catch{}},[kt,mr]),p.useEffect(()=>{try{localStorage.setItem(tr,JSON.stringify(ke))}catch{}},[ke,tr]);const Ms=p.useMemo(()=>{const Ie=kt.map(rr=>xt[rr]?.hora_inicio||"06:00:00").map(rr=>{const[Gt,Vt]=String(rr).split(":").map(Number);return(Gt||0)*60+(Vt||0)});if(!Ie.length)return VT;const Xe=Math.min(...Ie);return Math.floor(Xe/60)},[kt,xt]),ys=p.useMemo(()=>{const Ie=kt.map(rr=>xt[rr]?.hora_fim||"24:00:00").map(rr=>{const[Gt,Vt]=String(rr).split(":").map(Number);return(Gt===0&&Vt===0?24:Gt||0)*60+(Vt||0)});if(!Ie.length)return dae;const Xe=Math.max(...Ie);return Math.ceil(Xe/60)},[kt,xt]);p.useEffect(()=>{const Ie=new Date,Xe=ju(Ie),rr=_u(Ie);setTimeout(()=>{if(!zn.current)return;const Vt=Math.max(0,(Xe-Ms)*60+rr)/Oa;zn.current.scrollTop=Math.max(0,Vt*Ai-120)},150)},[Ms]);const sf=({booking:Ie,courtGridStart:Xe,courtGridEnd:rr})=>{const Gt=Ai,Vt=Ur=>{const tn=ju(Ur),$r=_u(Ur);return tn===0&&$r===0?1440:tn*60+$r},Mt=Vt(Ie.start),S=Vt(Ie.end),G=Xe!==void 0?Xe:Or?nl.start*60:Ms*60,se=rr!==void 0?rr:Or?nl.end*60:ys*60,Ae=Mt-G,V=(se-G)/Oa;let oe=Math.floor(Ae/Oa);const Pe=Math.max(0,S-Mt),qe=Math.max(1,Math.ceil(Pe/Oa));let He=oe+qe;oe=Math.max(0,Math.min(oe,V-1)),He=Math.max(0,Math.min(He,V)),He<=oe&&(He=oe+1),He=Math.min(He,V);const Rt=oe*Gt;let ut=(He-oe)*Gt;const qt=ni[Ie.status]||ni.confirmed,Kt=qt.icon,At=qt.border,kr=qe===1,nr=kr?4:sZe,Wr=Rt+nr,Cr=Math.max(kr?40:32,ut-nr*2),Yr=Pe>=90,br=2,ir=1.15,ht=Yr?(()=>{const Ur=Math.min(Math.max((Pe-90)/90,0),1);return Math.min(ir+Ur*(br-ir),br)})():1,Qr=16,ln=14,Ia=kr?16:24,Ca=Math.round(Qr*(Yr?ht:1)),dr=Math.round(ln*(Yr?ht:1)),wr=Math.round(Ia*(Yr?ht:1)),Br=kr?12:16,Gr=kr?12:16,dn=Yr?Math.min(ht,1.3):1,sn=Math.round(Br*dn),or=Math.round(Gr*dn),rn=rt[Ie.id]||[],hr=rn.filter(Ur=>String(Ur.status_pagamento||"").toLowerCase()==="pago").length,xr=rn.length;return a.jsxs(jr.div,{layout:te?!1:"position",initial:te?!1:{opacity:0,y:6},animate:te?!1:{opacity:1,y:0},exit:te?!1:{opacity:0,y:6},id:`booking-${Ie.id}`,className:gr("absolute left-2 right-2 rounded-md border-2 bg-surface text-sm shadow-sm z-0 cursor-pointer",At,"overflow-hidden transition-all duration-150 hover:bg-surface-2 hover:shadow-md"),style:{top:`${Wr}px`,height:`${Cr}px`},onClick:async()=>{const Ur=oo(Ie),tn=new Promise($n=>setTimeout($n,600));let $r=null;try{$r=await Promise.race([Ur,tn])}catch{}const An=$r&&$r.booking||le.find($n=>$n.id===Ie.id)||Ie;try{const $n=rt[Ie.id]||[];console.log("[ORDER:CLICK] booking",{id:Ie.id,customer:An?.customer||Ie.customer,partsCount:$n.length}),$n.length>0&&console.table($n.map((Jr,Bn)=>({idx:Bn+1,ordem:Jr?.ordem,nome:Jr?.nome,cliente_id:Jr?.cliente_id}))),console.log("[ORDER:CLICK] agendamento.clientes",An?.clientes??"(sem campo clientes)")}catch{}ge(An),Pn()},children:[a.jsx("div",{className:gr("absolute left-0 top-0 h-full w-[6px] rounded-l-md",qt.accent)}),a.jsx("div",{className:gr("h-full flex",kr?"px-3 py-3":"px-4 py-4"),style:{paddingLeft:sn,paddingRight:sn,paddingTop:or,paddingBottom:or},children:a.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("p",{className:"font-semibold text-text-primary truncate text-base",style:{fontSize:Ca,lineHeight:1.15},children:B9(Ie.customer)}),kr&&a.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2 py-0.5 whitespace-nowrap shadow-md",style:{fontSize:dr},children:Ie.modality})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:gr("text-text-muted font-semibold text-base whitespace-nowrap"),style:{fontSize:Ca},children:[ur(Ie.start,"HH:mm"),"",ur(Ie.end,"HH:mm")]}),kr&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Kt,{className:gr(qt.text),style:{width:wr,height:wr}}),a.jsx("span",{className:gr("truncate font-semibold",qt.text,"text-base"),style:{fontSize:Ca},children:qt.label})]}),kr&&xr>0&&a.jsxs("span",{className:`text-xs font-semibold rounded-full px-2 py-0.5 border ${hr===xr?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(11,Math.round(11*(Yr?ht:1)))},children:[hr,"/",xr]})]}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2 flex-wrap",children:[!kr&&a.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2.5 py-1 shadow-md",style:{fontSize:dr},children:Ie.modality}),!kr&&a.jsxs("div",{className:"flex items-center gap-1.5 text-base flex-wrap justify-end",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Kt,{className:gr(qt.text),style:{width:wr,height:wr}}),a.jsx("span",{className:gr("truncate font-semibold",qt.text),style:{fontSize:Ca},children:(()=>typeof window<"u"&&window.innerWidth<768&&Ie.status==="in_progress"?"Andamento":qt.label)()})]}),xr>0&&(()=>{const Ur=typeof window<"u"&&window.innerWidth<768;return a.jsxs("span",{className:gr("font-bold rounded-full border flex items-center gap-1 whitespace-nowrap",kr?"px-2 py-0.5 text-xs":"px-2.5 py-1 text-sm",hr===xr?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"),style:{fontSize:Math.max(kr?11:13,Math.round((kr?11:13)*(Yr?ht:1)))},children:[a.jsx(Ko,{className:"w-3 h-3 flex-shrink-0"}),a.jsxs("span",{className:"whitespace-nowrap",children:[hr,"/",xr,Ur?"":" pagos"]})]})})()]})]})]})})]})},bu=()=>{p.useRef(Math.random().toString(36).slice(2)),eN();const Ie=p.useRef(0),Xe=p.useRef(""),rr=we=>{if(!we)return"";if(typeof we=="string")return we;const Ve=we.nome||we.name||"",Ke=we.codigo??we.code;return Ke!=null?`[${Ke}] ${Ve}`:Ve},Gt=we=>we?typeof we=="string"?we:we.nome||we.name||"":"",Vt=we=>{const Ve=xt[we];if(!Ve)return{start:Ms*60,end:ys*60};const[Ke,jt]=String(Ve.hora_inicio||"06:00:00").split(":").map(Number),[wt,Mr]=String(Ve.hora_fim||"24:00:00").split(":").map(Number),Wt=wt===0&&Mr===0?24:wt;return{start:Ke*60+(jt||0),end:Wt*60+(Mr||0)}},Mt=()=>{const we=ju(new Date),Ve=_u(new Date),Ke=we*60+Ve,jt=it[0]||"",wt=Vt(jt);return Math.max(wt.start,Math.min(wt.end-Oa,Math.round(Ke/Oa)*Oa))},[S,G]=p.useState(()=>{let we=[];try{const Ke=sessionStorage.getItem("agenda:customerPicker:closingAt"),jt=Ke?Number(Ke):0,wt=jt&&Date.now()-jt<1e4,Mr=sessionStorage.getItem(ln),Wt=Mr?JSON.parse(Mr):[];if(wt&&Array.isArray(Wt)&&Wt.length>0?we=Wt:Array.isArray(wr)&&wr.length>0?we=wr:Array.isArray(ht.current)&&ht.current.length>0&&(we=ht.current),we.length>0)try{Ae.current=!0}catch{}}catch{}return{selectedClients:we,court:(()=>it.find(jt=>!ve[jt]||ve[jt].funciona)||it[0]||"")(),modality:rp[0],status:"scheduled",date:M,startMinutes:Mt(),endMinutes:Mt()+60}}),se=p.useRef([]),Ae=p.useRef(!1),V=p.useRef(null);p.useEffect(()=>{se.current=Array.isArray(S.selectedClients)?S.selectedClients:[];try{(se.current||[]).length>0&&(Ae.current=!0)}catch{}},[S.selectedClients]);const[oe,Pe]=p.useState(!1),[qe,He]=p.useState(""),Rt=p.useRef(!1);p.useEffect(()=>{try{if(!te||!Qe?.id||Rt.current)return;const we=rt[Qe.id]||[];if(!Array.isArray(we)||we.length===0)return;const Ve=we.map(wt=>({id:wt.cliente_id,nome:wt.nome,codigo:wt.codigo??null})),Ke=Array.isArray(S.selectedClients)?S.selectedClients:[];if(!(Ke.length===Ve.length&&Ke.every((wt,Mr)=>wt&&Ve[Mr]&&wt.id===Ve[Mr].id))){G(wt=>({...wt,selectedClients:Ve}));try{ht.current=Ve}catch{}try{Gr(Ve)}catch{}try{Ae.current=!0}catch{}try{sessionStorage.setItem(ln,JSON.stringify(Ve))}catch{}try{st.current=Date.now()+1500}catch{}try{console.log("[ORDER:OPEN_MODAL] chips (aplicados)",Ve.map(wt=>wt.nome)),console.table(we.map((wt,Mr)=>({idx:Mr+1,ordem:wt?.ordem,nome:wt?.nome,cliente_id:wt?.cliente_id})))}catch{}}Rt.current=!0}catch{}},[te,Qe?.id,rt]),p.useEffect(()=>{try{if(!te||!Qe?.id)return;const we=rt[Qe.id]||[];if(!Array.isArray(we)||we.length===0)return;const Ve=we.map(Wt=>Wt.cliente_id),Ke=Array.isArray(S.selectedClients)?S.selectedClients:[];if(Ke.length===0)return;const jt=new Map(Ve.map((Wt,er)=>[Wt,er])),wt=[...Ke].sort((Wt,er)=>{const hn=jt.has(Wt.id)?jt.get(Wt.id):Number.MAX_SAFE_INTEGER,In=jt.has(er.id)?jt.get(er.id):Number.MAX_SAFE_INTEGER;return hn-In});if(wt.length===Ke.length&&wt.some((Wt,er)=>Wt?.id!==Ke[er]?.id)){console.log("[ORDER:ENFORCE] Ajustando chips ->",wt.map(Wt=>Wt.nome)),G(Wt=>({...Wt,selectedClients:wt}));try{ht.current=wt}catch{}try{Gr(wt)}catch{}try{sessionStorage.setItem(ln,JSON.stringify(wt))}catch{}}}catch{}},[te,Qe?.id,rt,S.selectedClients]),p.useEffect(()=>{try{if(!te)return;const we=Array.isArray(S.selectedClients)?S.selectedClients:[];we.length>0&&console.log("[ORDER:CHIPS] atual:",we.map(Ve=>Ve.nome))}catch{}},[te,S.selectedClients]);const[ut,qt]=p.useState(0),Kt=p.useRef(0),At=p.useRef(!1);p.useEffect(()=>{const we=()=>{try{if(document.visibilityState==="hidden"){At.current=!!(Ut||oe);const Ve=Date.now();try{st.current=Ve+1200}catch{}try{Ft.current=Ve+1200}catch{}try{Kt.current=Ve+800}catch{}}else if(document.visibilityState==="visible"){const Ve=At.current;At.current=!1;const Ke=Date.now();try{st.current=Math.max(st.current||0,Ke+600)}catch{}try{Ft.current=Math.max(Ft.current||0,Ke+600)}catch{}try{Kt.current=Math.max(Kt.current||0,Ke+400)}catch{}Ve&&!Ne.current&&setTimeout(()=>{Ne.current||(Pe(!0),xe(!0))},60)}}catch{}};return document.addEventListener("visibilitychange",we),()=>document.removeEventListener("visibilitychange",we)},[Ut,oe,te]),p.useEffect(()=>{},[oe,Ut]);const kr=p.useRef(0);p.useEffect(()=>{const we=Array.isArray(S.selectedClients)?S.selectedClients.length:-1,Ve=kr.current;we!==Ve&&(kr.current=we)},[S.selectedClients,oe,Ut]);const[_r,nr]=p.useState(!1),[Wr,Cr]=p.useState(null),[Yr,br]=p.useState(!1),ir=p.useRef(!1),ht=p.useRef([]),Qr=p.useRef("init"),ln=p.useMemo(()=>{try{return`agenda:lastSelection:${A?.codigo_empresa||"no-company"}`}catch{return"agenda:lastSelection:no-company"}},[A?.codigo_empresa]),Ia=p.useCallback(we=>{try{sessionStorage.setItem(ln,JSON.stringify(we||[]))}catch{}},[ln]),Ca=p.useCallback(()=>{try{const we=sessionStorage.getItem(ln);if(we){const Ve=JSON.parse(we);Array.isArray(Ve)&&(ht.current=Ve)}}catch{}},[ln]),dr=p.useRef(!1),[wr,Br]=p.useState([]),Gr=p.useCallback(we=>{Br(we)},[]),dn=p.useRef(null),sn=p.useRef(null),or=p.useRef([]);p.useEffect(()=>{Ut&&or.current[ut]&&or.current[ut]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[ut,Ut]),p.useEffect(()=>{Ut&&qt(0)},[Ut]);const[rn,hr]=p.useState(!1),[xr,Ur]=p.useState(!1);p.useState(!1);const[tn,$r]=p.useState(!1),[An,$n]=p.useState(!1),Jr=p.useRef(null),Bn=p.useRef(null),Aa=p.useRef(!1);p.useEffect(()=>{if(!s)return;let we=!1;return(async()=>{try{if(!F||!A?.codigo_empresa)return;const Ve=await Hm({somenteAtivas:!0,codigoEmpresa:A.codigo_empresa});we||b(Array.isArray(Ve)?Ve:[])}catch{}})(),()=>{we=!0}},[s,F,A?.codigo_empresa]),p.useEffect(()=>{if(!s||!Array.isArray(x)||x.length===0)return;const we=String(x[0].id);v(Ve=>Ve.length===0&&Array.isArray(S.selectedClients)&&S.selectedClients.length>0?S.selectedClients.map(wt=>({cliente_id:wt.id,nome:wt.nome,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:we})):Ve.map(jt=>({...jt,finalizadora_id:jt.finalizadora_id&&jt.finalizadora_id!==""?jt.finalizadora_id:we})))},[s,x]);const Ja=p.useCallback((we,Ve)=>{try{const Ke=Date.now(),jt=Ke<(Xr.current||0)||Ke<(Ft.current||0),wt=!Ut,Mr=!!dr.current;let Wt=Array.isArray(Ve)?Ve:[];if(Wt.length===0&&wt&&jt&&!Mr){const er=Array.isArray(ht.current)?ht.current:[];er.length>0&&(Wt=er)}try{if(!Qe&&Array.isArray(Wt)&&Wt.length>0&&V.current){const er=Wt.findIndex(hn=>hn&&hn.id===V.current);er>0&&(Wt=[Wt[er],...Wt.filter((In,_n)=>_n!==er)])}}catch{}try{if(Qe?.id){const er=rt[Qe.id]||[];if(Array.isArray(er)&&er.length>0){const hn=er.map(_n=>_n.cliente_id),In=new Map(hn.map((_n,nn)=>[_n,nn]));Wt=[...Wt].sort((_n,nn)=>{const oa=In.has(_n.id)?In.get(_n.id):Number.MAX_SAFE_INTEGER,ya=In.has(nn.id)?In.get(nn.id):Number.MAX_SAFE_INTEGER;return oa-ya}),console.log("[ORDER:APPLY] Ajustado por ordem persistida ->",Wt.map(_n=>_n.nome))}}}catch{}if(G(er=>({...er,selectedClients:Wt})),Array.isArray(Wt)&&Wt.length>0){ht.current=Wt,Gr(Wt);try{sessionStorage.setItem(ln,JSON.stringify(Wt))}catch{}dr.current=!1}try{Qr.current=we}catch{}}catch{}},[Ut,G,Gr,ln]);p.useState(""),p.useRef(null),p.useEffect(()=>{try{Be.current=Date.now()}catch{}},[oe,xr]),p.useEffect(()=>{if(w){if(mt.current=oe,oe)E("customer-picker",6e3),C("picker:open"),fr.current=!0,xe(!0);else if(C("picker:close"),P("picker-close"),Li.current){Li.current=!1;try{j("Picker closed: flushing pending refresh"),C("picker:flush"),xs()}catch{}}}},[oe]);const hs=p.useCallback((we,Ve={})=>{if(w)try{const Ke=new Date().toISOString(),jt=ye.current,wt=!!fr.current,Mr=!!ir.current}catch{}},[w,te,oe,Ut,xr,_r]);p.useEffect(()=>{w&&hs("state-change",{isCustomerPickerOpen:oe,effectiveCustomerPickerOpen:Ut})},[w,oe,Ut]),p.useEffect(()=>{if(!te||Ut)return;const we=Array.isArray(S.selectedClients)?S.selectedClients:[],Ve=Array.isArray(ht.current)?ht.current:[],Ke=Date.now()<(st.current||0);if(we.length===0&&Ve.length>0&&!dr.current&&Ke)Qr.current="global:restore",G(jt=>({...jt,selectedClients:Ve}));else if(we.length===0&&Ve.length>0&&dr.current&&!Ke)try{ht.current=[]}catch{}},[te,Ut,S.selectedClients]),p.useEffect(()=>{if(!te)return;let we=fr.current;try{const Ke=localStorage.getItem("agenda:customerPicker:desiredAt");if(Ke){const jt=Number(Ke);Number.isFinite(jt)&&Date.now()-jt<3e3&&(we=!0)}}catch{}if(!we||oe||Date.now()<Ft.current||Xt())return;const Ve=Date.now();Ve-It.current<800||(It.current=Ve,ye.current="open",Pe(!0),xe(!0))},[oe,te]),p.useEffect(()=>{const we=Array.isArray(S.selectedClients)?S.selectedClients:[];we.length>0&&(ht.current=we,Ia(we),Gr(we))},[S.selectedClients,Ia]);const Td=p.useRef(""),Vc=p.useRef(!1);p.useEffect(()=>{try{if(!te||!Qe?.id)return;const we=Array.isArray(S.selectedClients)?S.selectedClients:[],Ve=JSON.stringify(we.map(Ke=>({id:Ke?.id,nome:Ke?.nome||null,codigo:Ke?.codigo??null})));if(Ve===Td.current)return;Td.current=Ve,(async()=>{if(!Vc.current){Vc.current=!0;try{const Ke=Qe.id,jt=A?.codigo_empresa;if(!Ke||!jt)return;if(we.length===0){console.log(" [EDIT-MODAL] seleo vazia detectada (skip persist)");return}try{const In=Array.isArray(rt?.[Ke])?rt[Ke]:[];if(In.length===we.length&&In.every((oa,ya)=>String(oa?.cliente_id)===String(we[ya]?.id))){console.log(" [EDIT-MODAL] seleo igual ao banco (skip persist)");return}}catch{}console.log(" [EDIT-MODAL] Mudana em selectedClients detectada. Salvando participantes...");const{data:wt}=await he.from("agendamento_participantes").select("*").eq("codigo_empresa",jt).eq("agendamento_id",Ke).order("ordem",{ascending:!0}).order("id",{ascending:!0}),Mr=wt||[];if(await he.from("agendamento_participantes").delete().eq("codigo_empresa",jt).eq("agendamento_id",Ke),we.length>0){const In=we.map((_n,nn)=>{const oa=Mr[nn],ya=oa&&oa.cliente_id===_n.id;return{codigo_empresa:jt,agendamento_id:Ke,cliente_id:_n.id,nome:_n.nome,ordem:nn+1,valor_cota:ya?oa.valor_cota??0:0,status_pagamento:ya?oa.status_pagamento??"Pendente":"Pendente",finalizadora_id:ya?oa.finalizadora_id??null:null,aplicar_taxa:ya?oa.aplicar_taxa??!1:!1}});await he.from("agendamento_participantes").insert(In)}const Wt=we[0]||null,er=we.map(In=>In?.nome).filter(Boolean);await he.from("agendamentos").update({cliente_id:Wt?.id??null,clientes:er}).eq("codigo_empresa",jt).eq("id",Ke),ie(In=>In.map(_n=>_n.id===Ke?{..._n,customer:Wt?.nome||_n.customer,cliente_id:Wt?.id??null,clientes:er}:_n));const hn=we.map((In,_n)=>{const nn=Mr[_n],oa=nn&&nn.cliente_id===In.id;return{cliente_id:In.id,nome:In.nome,codigo:In.codigo??null,valor_cota:oa?nn.valor_cota??0:0,status_pagamento:oa?nn.status_pagamento??"Pendente":"Pendente",finalizadora_id:oa?nn.finalizadora_id??null:null,aplicar_taxa:oa?nn.aplicar_taxa??!1:!1,ordem:_n+1}});pt(In=>({...In,[Ke]:hn})),v(hn),console.log(" [EDIT-MODAL] Participantes salvos imediatamente")}catch(Ke){console.error(" [EDIT-MODAL] Falha ao salvar mudana de chips:",Ke)}finally{Vc.current=!1}}})()}catch{}},[te,Qe?.id,S.selectedClients]),p.useEffect(()=>{if(!te||(Ca(),Ut)||fr.current)return;const we=Array.isArray(S.selectedClients)?S.selectedClients:[],Ve=(()=>{const Ke=Array.isArray(ht.current)?ht.current:[];if(Ke&&Ke.length>0)return Ke;try{const jt=sessionStorage.getItem(ln),wt=jt?JSON.parse(jt):[];return Array.isArray(wt)?wt:[]}catch{return[]}})();we.length===0&&Ve.length>0&&!dr.current&&(G(Ke=>({...Ke,selectedClients:Ve})),ir.current=!1)},[Ut,te,Ca,ln]);const ps=p.useRef(0);p.useEffect(()=>{try{const we=Date.now(),Ve=Array.isArray(se.current)?se.current:[],Ke=Array.isArray(ht.current)?ht.current:[];if(we-ps.current>300&&(ps.current=we),te&&!Ut&&Ve.length===0&&Ke.length>0&&!dr.current){try{Xr.current=Date.now()+2e3}catch{}try{const jt=Ft?.current||0,wt={ts:new Date().toISOString(),reason:"empty-after-close",modalOpen:te,pickerOpen:Ut,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Ve.length,lastLen:Ke.length,clearedByUser:!!dr?.current,lastAction:Qr?.current,chipsLen:Array.isArray(wr)?wr.length:NaN,clientsLoading:!!xr,suppressUntil:jt}}catch{}Gr(Ke);try{sessionStorage.setItem(ln,JSON.stringify(Ke))}catch{}G(jt=>({...jt,selectedClients:[...Ke]}));try{Promise.resolve().then(()=>{G(jt=>({...jt,selectedClients:[...ht.current]}))})}catch{}try{requestAnimationFrame(()=>{G(jt=>({...jt,selectedClients:[...ht.current||[]]}))})}catch{}setTimeout(()=>{const jt=Array.isArray(se.current)?se.current:[],wt=Array.isArray(ht.current)?ht.current:[];jt.length===0&&wt.length>0&&G(Mr=>({...Mr,selectedClients:[...wt]}))},25),setTimeout(()=>{const jt=Array.isArray(se.current)?se.current:[],wt=Array.isArray(ht.current)?ht.current:[];jt.length===0&&wt.length>0&&G(Mr=>({...Mr,selectedClients:[...wt]}))},120),setTimeout(()=>{const jt=Array.isArray(se.current)?se.current:[],wt=Array.isArray(ht.current)?ht.current:[];jt.length===0&&wt.length>0&&G(Mr=>({...Mr,selectedClients:[...wt]}))},240)}}catch{}},[S.selectedClients,Ut,te]),p.useEffect(()=>{try{const we=now<(Xr.current||0),Ve=Array.isArray(se.current)?se.current:[],Ke=Array.isArray(ht.current)?ht.current:[],jt=now<(st.current||0);if(te&&!Ut&&(we||jt)&&Ve.length===0&&Ke.length>0&&!dr.current){Br(Ke);try{sessionStorage.setItem(ln,JSON.stringify(Ke))}catch{}G(wt=>({...wt,selectedClients:[...Ke]}));try{requestAnimationFrame(()=>G(wt=>({...wt,selectedClients:[...ht.current||[]]})))}catch{}setTimeout(()=>G(wt=>({...wt,selectedClients:[...ht.current||[]]})),32),setTimeout(()=>G(wt=>({...wt,selectedClients:[...ht.current||[]]})),96)}}catch{}},[S.selectedClients,Ut,te]),p.useEffect(()=>{const we=Date.now();if(we<(yr.current||0)||!te||Ut||we>=(st.current||0))return;const Ve=Array.isArray(S.selectedClients)?S.selectedClients:[],Ke=Array.isArray(ht.current)?ht.current:[];if(Ve.length===0&&Ke.length>0){Br(Ke);try{sessionStorage.setItem(ln,JSON.stringify(Ke))}catch{}G(jt=>({...jt,selectedClients:[...Ke]})),Promise.resolve().then(()=>G(jt=>({...jt,selectedClients:[...ht.current||[]]}))),setTimeout(()=>G(jt=>({...jt,selectedClients:[...ht.current||[]]})),24),setTimeout(()=>G(jt=>({...jt,selectedClients:[...ht.current||[]]})),80),setTimeout(()=>G(jt=>({...jt,selectedClients:[...ht.current||[]]})),240)}},[S.selectedClients,te,Ut]);const[lf,kl]=p.useState([]);p.useEffect(()=>{s&&kl([])},[s]);const io=p.useRef(!1),ei=p.useRef(!1),[Kh,Wc]=p.useState(null);p.useState(null);const Dd=p.useRef(!1);p.useEffect(()=>{const we=Array.isArray(S.selectedClients)?S.selectedClients:[],Ve=Kh,Ke=Ve&&we.some(jt=>jt&&jt.id===Ve);we.length>0&&!Ke?Wc(we[0]?.id||null):we.length===0&&Ve&&Wc(null)},[S.selectedClients,te,Qe]);const al=p.useRef(!1),bi=p.useRef(!1),[Ws,ac]=p.useState(Tn),Hc=p.useRef(0);p.useEffect(()=>{if(!(Date.now()<(yr.current||0)))if(xr){Hc.current||(Hc.current=Date.now());const Ve=setTimeout(()=>{xr&&(!Array.isArray(Ws)||Ws.length===0)&&Ur(!1)},2e3);return()=>clearTimeout(Ve)}else Hc.current=0},[xr,Ws]);const Il=p.useMemo(()=>Array.isArray(S.selectedClients)?S.selectedClients:[],[S.selectedClients]),Ol=p.useMemo(()=>{const we=Il||[];if(we.length===0)return"Adicionar clientes";const Ve=we[0]?.nome||"Cliente",Ke=we.length-1;return Ke>0?`${Ve} +${Ke}`:Ve},[Il]),sc=p.useMemo(()=>{const we=Array.isArray(S.selectedClients)?S.selectedClients:[],Ve=Array.isArray(se.current)?se.current:[],Ke=Array.isArray(ht.current)?ht.current:[],jt=Array.isArray(wr)?wr:[];return we.length>0&&we.every(wt=>wt?.nome)?we:we.length>0?we.map(wt=>{if(wt?.nome)return wt;const Mr=Ve.find(In=>In?.id===wt?.id),Wt=Ke.find(In=>In?.id===wt?.id),er=jt.find(In=>In?.id===wt?.id),hn=(Ws||[]).find(In=>In?.id===wt?.id);return{...wt,nome:Mr?.nome||Wt?.nome||er?.nome||hn?.nome||wt?.nome||"Cliente"}}):Ve.length>0&&Ve.every(wt=>wt?.nome)?Ve:jt.length>0&&jt.every(wt=>wt?.nome)?jt:Ke.length>0&&Ke.every(wt=>wt?.nome)?Ke:we},[S.selectedClients,wr,Ws]);p.useEffect(()=>{if(!(Date.now()<(yr.current||0)))try{j("Chips:effective change",{effectiveLen:Array.isArray(Il)?Il.length:0,formLen:Array.isArray(S.selectedClients)?S.selectedClients.length:0,lastLen:Array.isArray(ht.current)?ht.current.length:0,pickerOpen:oe})}catch{}},[Il,S.selectedClients,oe]);const Ua=p.useRef(null),Za=p.useRef(!1);p.useEffect(()=>{if(te){Array.isArray(Tn)&&Tn.length>0&&ac(Tn);try{if(!Ws||Ws.length===0){const we=A?.codigo_empresa?`clientes:list:${A.codigo_empresa}`:null;if(we){const Ve=JSON.parse(localStorage.getItem(we)||"[]");Array.isArray(Ve)&&Ve.length>0&&ac(Ve)}}}catch{}}},[te,Tn]),p.useEffect(()=>{te||(Ua.current=null,Ur(!1))},[te]),p.useEffect(()=>{te||(io.current=!1,ei.current=!1,$r(!1),bi.current=!1)},[te]);const Rs=p.useRef(!1);p.useEffect(()=>{if(te&&!Rs.current){Rs.current=!0;try{const we=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",Ve=sessionStorage.getItem("agenda:customerPicker:closingAt"),Ke=Ve?Number(Ve):0,jt=Ke&&Date.now()-Ke<1e4;we&&jt?Xe.current=we:Xe.current||(Xe.current=`${Date.now()}-${Math.random().toString(36).slice(2)}`),sessionStorage.setItem("agenda:modal:sessionId",Xe.current)}catch{}if(!Qe){try{const we=sessionStorage.getItem("agenda:customerPicker:closingAt"),Ve=we?Number(we):0,Ke=Ve&&Date.now()-Ve<1e4,jt=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",wt=sessionStorage.getItem("agenda:modal:sessionId")||"",Mr=sessionStorage.getItem(ln),Wt=Mr?JSON.parse(Mr):[];if(Ke&&Array.isArray(Wt)&&Wt.length>0&&jt&&wt&&jt===wt){try{Ae.current=!0}catch{}G(er=>({...er,selectedClients:Wt})),ht.current=Wt,Gr(Wt);try{dr.current=!1}catch{}try{Promise.resolve().then(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})))}catch{}try{requestAnimationFrame(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})))}catch{}setTimeout(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})),24),setTimeout(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})),96);return}if(Ke&&Array.isArray(Wt)&&Wt.length>0){try{Ae.current=!0}catch{}G(er=>({...er,selectedClients:Wt})),ht.current=Wt,Gr(Wt);try{dr.current=!1}catch{}try{Promise.resolve().then(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})))}catch{}try{requestAnimationFrame(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})))}catch{}setTimeout(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})),24),setTimeout(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})),96);return}}catch{}try{if(Date.now()<(Ie.current||0))return}catch{}try{fr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{const we=sessionStorage.getItem(ln),Ve=we?JSON.parse(we):[],Ke=Array.isArray(ht.current)?ht.current:[];if(!(Array.isArray(Ve)&&Ve.length>0||Array.isArray(Ke)&&Ke.length>0)){try{ht.current=[]}catch{}try{Br([])}catch{}try{dr.current=!1}catch{}G(jt=>({...jt,selectedClients:[]}))}}catch{try{ht.current=[]}catch{}try{Br([])}catch{}try{dr.current=!1}catch{}G(we=>({...we,selectedClients:[]}))}}}else!te&&Rs.current;if(Qe)bs.current=!1;else{if(bs.current)return;bs.current=!0;try{const we=sessionStorage.getItem("agenda:customerPicker:closingAt"),Ve=we?Number(we):0,Ke=Ve&&Date.now()-Ve<5e3,jt=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",wt=sessionStorage.getItem("agenda:modal:sessionId")||"",Mr=sessionStorage.getItem(ln),Wt=Mr?JSON.parse(Mr):[];if(Ke&&Array.isArray(Wt)&&Wt.length>0&&jt&&wt&&jt===wt){try{Ae.current=!0}catch{}G(er=>({...er,selectedClients:Wt})),ht.current=Wt,Gr(Wt);try{dr.current=!1}catch{}try{Promise.resolve().then(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})))}catch{}try{requestAnimationFrame(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})))}catch{}setTimeout(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})),24),setTimeout(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})),96);return}if(Ke&&Array.isArray(Wt)&&Wt.length>0){try{Ae.current=!0}catch{}G(er=>({...er,selectedClients:Wt})),ht.current=Wt,Gr(Wt);try{dr.current=!1}catch{}try{Promise.resolve().then(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})))}catch{}try{requestAnimationFrame(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})))}catch{}setTimeout(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})),24),setTimeout(()=>G(er=>({...er,selectedClients:[...ht.current||[]]})),96);return}}catch{}try{if(Date.now()<(Ie.current||0))return}catch{}try{fr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{dr.current=!1}catch{}try{const we=sessionStorage.getItem(ln),Ve=we?JSON.parse(we):[],Ke=Array.isArray(ht.current)?ht.current:[];if(!(Array.isArray(Ve)&&Ve.length>0||Array.isArray(Ke)&&Ke.length>0)){try{ht.current=[]}catch{}try{Br([])}catch{}G(jt=>({...jt,selectedClients:[]}))}}catch{try{ht.current=[]}catch{}try{Br([])}catch{}G(we=>({...we,selectedClients:[]}))}}},[te,Qe]);const bs=p.useRef(!1);p.useEffect(()=>{if(!te){bs.current=!1;try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt"),sessionStorage.removeItem("agenda:customerPicker:sessionId"),sessionStorage.removeItem("agenda:modal:sessionId"),Xe.current="",sessionStorage.removeItem(ln);try{ht.current=[]}catch{}try{Br([])}catch{}try{Ae.current=!1}catch{}try{Ie.current=0}catch{}try{st.current=0}catch{}ne(!1),Nt(4);try{Ft.current=0}catch{}try{ye.current=null}catch{}try{fr.current=!1}catch{}G(we=>({...we,selectedClients:[]})),Wc(null)}catch{}return}if(Qe)bs.current=!1;else{if(bs.current)return;bs.current=!0;try{if(Date.now()<(Ie.current||0))return}catch{}try{fr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{dr.current=!1}catch{}try{const we=sessionStorage.getItem(ln),Ve=we?JSON.parse(we):[],Ke=Array.isArray(ht.current)?ht.current:[];if(!(Array.isArray(Ve)&&Ve.length>0||Array.isArray(Ke)&&Ke.length>0)){try{ht.current=[]}catch{}try{Br([])}catch{}G(jt=>({...jt,selectedClients:[]}))}}catch{try{ht.current=[]}catch{}try{Br([])}catch{}G(we=>({...we,selectedClients:[]}))}}},[te,Qe]);const Ys=p.useCallback(async(we={})=>{const{autoSave:Ve=!1}=we;if(!tn){$r(!0);try{const Ke=xt[S.court];if(!Ke){t({title:"Selecione uma quadra",variant:"destructive"}),io.current=!1,ei.current=!1;return}const jt=S.startMinutes,wt=S.endMinutes;if(!(Number.isFinite(jt)&&Number.isFinite(wt)&&wt>jt)){t({title:"Horrio invlido",variant:"destructive"}),io.current=!1,ei.current=!1;return}if(!oc(jt,wt)){t({title:"Conflito de horrio",description:"O horrio selecionado est ocupado.",variant:"destructive"}),io.current=!1,ei.current=!1;return}const Wt=(pa,Ea)=>new Date(pa.getFullYear(),pa.getMonth(),pa.getDate(),Math.floor(Ea/60),Ea%60,0,0),er=Wt(S.date,jt),hn=Wt(S.date,wt);let In=Array.isArray(S.selectedClients)&&S.selectedClients.length>0?S.selectedClients:Array.isArray(se.current)?se.current:[];if((!In||In.length===0)&&Qe?.id)try{const pa=Array.isArray(ht.current)?ht.current:[];pa&&pa.length>0&&(In=pa,G(Ea=>({...Ea,selectedClients:pa})))}catch{}const _n=[...In];console.log(" [FIX] selNowSnapshot criado:",_n.length,"participantes"),console.log(" [FIX] form.selectedClients:",S.selectedClients?.length||0),console.log(" [FIX] editingBooking.id:",Qe?.id),console.log(" [LOG 3 - FECHAR MODAL AGENDAMENTO] Estado ao salvar:"),console.log("   Participantes selecionados:",_n.length),_n.forEach((pa,Ea)=>{console.log(`   #${Ea+1}: ${pa.nome}`)}),console.log("   participantsForm (contexto):",(m||[]).length),(m||[]).forEach((pa,Ea)=>{console.log(`   #${Ea+1}: ${pa.nome} | Status: ${pa.status_pagamento} | Valor: ${pa.valor_cota}`)});let nn=_n,oa=!1;if(Qe?.id){const pa=_n.map(es=>es.nome).sort().join("|");let Ea="";const Fi=rt[Qe.id]||[];if(Fi.length>0&&(Ea=Fi.map(es=>es.nome).sort().join("|")),oa=pa!==Ea,console.log(" [DEBUG] Comparao de nomes:"),console.log("   nomesAtuais:",pa),console.log("   nomesOriginais:",Ea),console.log("   editingBooking.clientes:",Qe.clientes),console.log("   houveMudancaDeParticipantes:",oa),!oa){let es=[];if(Qe.clientes)try{es=Array.isArray(Qe.clientes)?Qe.clientes:JSON.parse(Qe.clientes)}catch{es=(rt[Qe.id]||[]).map(ws=>ws.nome)}else es=(rt[Qe.id]||[]).map(ws=>ws.nome);es.length>0&&(nn=[...In].sort(($i,ws)=>{const Qs=es.findIndex(wi=>wi===$i.nome),Bi=es.findIndex(wi=>wi===ws.nome);return Qs!==-1&&Bi!==-1?Qs-Bi:Qs!==-1?-1:Bi!==-1?1:0}))}}const ya=nn[0],Pa=nn.map(Gt).filter(Boolean);if(!Qe?.id&&!ya?.id){t({title:"Selecione um cliente",description:"Para criar um agendamento, selecione pelo menos um cliente.",variant:"destructive"});return}if(Qe?.id){const pa=Qe.status,Ea=S.status!==pa,Fi={quadra_id:Ke.id,cliente_id:ya?.id??null,clientes:Pa,inicio:er.toISOString(),fim:hn.toISOString(),modalidade:S.modality};if(!Ea){let ka=S.status;try{const ri=H(),Zs=er.getTime();if(!!En?.autoConfirmEnabled&&Number.isFinite(Number(En?.autoConfirmMinutesBefore))){const ji=Number(En.autoConfirmMinutesBefore)*6e4,Tl=Zs-ji;ka==="confirmed"&&ri<Tl?ka="scheduled":ka==="scheduled"&&ri>=Tl&&(ka="confirmed")}}catch{}Fi.status=ka}const{error:es}=await he.from("agendamentos").update(Fi).eq("codigo_empresa",A.codigo_empresa).eq("id",Qe.id);if(es)throw es;const{data:$i}=await he.from("agendamento_participantes").select("*").eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",Qe.id).order("ordem",{ascending:!0}).order("id",{ascending:!0}),ws=$i||[];if(console.log(" [SAVE-BOOKING] houveMudancaDeParticipantes:",oa),console.log(" [SAVE-BOOKING] currentArray.length:",ws.length),console.log(" [SAVE-BOOKING] selNowFinal.length:",nn.length),oa){if(!nn||nn.length===0)console.error(" [SAVE-BOOKING] PROTEO ACIONADA: No vou deletar participantes com selNowFinal vazio!"),console.error(" [SAVE-BOOKING] Isso evita perda de dados. Verifique por que selNowFinal est vazio.");else{console.log(" [SAVE-BOOKING] Deletando e recriando participantes...");const{error:ka}=await he.from("agendamento_participantes").delete().eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",Qe.id);ka&&console.error("Erro ao deletar participantes:",ka)}if(nn&&nn.length>0){const ka=nn.map((Zs,Co)=>{const ji=ws[Co],Tl=ji&&ji.cliente_id===Zs.id;return{codigo_empresa:A.codigo_empresa,agendamento_id:Qe.id,cliente_id:Zs.id,nome:Zs.nome,ordem:Co+1,valor_cota:Tl?ji.valor_cota??0:0,status_pagamento:Tl?ji.status_pagamento??"Pendente":"Pendente",finalizadora_id:Tl?ji.finalizadora_id??null:null,aplicar_taxa:Tl?ji.aplicar_taxa??!1:!1,pago_em:Tl?ji.pago_em??null:null}}),{error:ri}=await he.from("agendamento_participantes").insert(ka);ri&&console.error("Erro ao inserir participantes:",ri)}}const Qs=ya?.nome||ya?.name||Gt(ya)||Pa[0]||Qe.customer,Bi={...Qe,court:S.court,customer:Qs,start:er,end:hn,modality:S.modality,...Ea?{}:{status:Fi.status??S.status}};if(ie(ka=>ka.map(ri=>ri.id===Qe.id?Bi:ri)),ge(Bi),Ea)try{ue(!1),await kn(Qe.id,S.status,"user")}catch{}Ve||t({title:"Agendamento atualizado"}),ei.current=!0,io.current=!1;const wi=In.map((ka,ri)=>{const Zs=ws.find(ji=>ji.cliente_id===ka.id),Co=!!Zs;return{cliente_id:ka.id,nome:ka.nome,codigo:ka.codigo||null,valor_cota:Co?Zs.valor_cota??0:0,status_pagamento:Co?Zs.status_pagamento??"Pendente":"Pendente",finalizadora_id:Co?Zs.finalizadora_id??null:null,aplicar_taxa:Co?Zs.aplicar_taxa??!1:!1,ordem:ri+1}});if(pt(ka=>({...ka,[Qe.id]:wi})),console.log(" [FIX] houveMudancaDeParticipantes =",oa),oa?(console.log(" [FIX] Mudana de participantes detectada - reconstruindo participantsForm"),v(wi.map(ka=>({cliente_id:ka.cliente_id,nome:ka.nome,codigo:ka.codigo,valor_cota:ka.valor_cota?ov(String(Number(ka.valor_cota).toFixed(2))):"",status_pagamento:ka.status_pagamento,finalizadora_id:ka.finalizadora_id?String(ka.finalizadora_id):x?.[0]?.id?String(x[0].id):null,aplicar_taxa:ka.aplicar_taxa})))):(console.log(" [FIX] Sem mudana de participantes - preservando dados de pagamento do contexto"),v(ka=>{const ri=(ka||[]).map(Zs=>{const Co=wi.find(ji=>ji.cliente_id===Zs.cliente_id);return Co?{cliente_id:Zs.cliente_id,nome:Zs.nome||Co.nome,codigo:Zs.codigo??Co.codigo,valor_cota:Zs.valor_cota||Co.valor_cota,status_pagamento:Zs.status_pagamento||Co.status_pagamento,finalizadora_id:Zs.finalizadora_id??Co.finalizadora_id,aplicar_taxa:Zs.aplicar_taxa??Co.aplicar_taxa}:Zs});return console.log(" [FIX] Dados de pagamento preservados:",ri),ri.length>0?ri:wi})),console.log(" [LOG 3 - RESULTADO FINAL] participantsForm aps atualizao:"),console.log("   Total:",wi.length),wi.forEach((ka,ri)=>{console.log(`   #${ri+1}: ${ka.nome} | Status: ${ka.status_pagamento} | Valor: ${ka.valor_cota}`)}),r().catch(ka=>{console.error("[AgendaPage] Erro ao recarregar alertas:",ka)}),!Ve){try{ht.current=[]}catch{}try{Br([])}catch{}try{sessionStorage.removeItem(ln)}catch{}ue(!1)}return}let Js=null;try{const{data:pa}=await he.from("agendamentos").select("id, status, codigo").eq("codigo_empresa",A.codigo_empresa).eq("quadra_id",Ke.id).eq("inicio",er.toISOString()).eq("fim",hn.toISOString()).limit(1);Array.isArray(pa)&&pa.length>0&&(Js=pa[0])}catch{}if(Js?.id&&Js.status!=="canceled"){const pa={id:Js.id,code:Js.codigo,court:S.court,customer:ya?.nome||Pa[0]||"",start:er,end:hn,status:S.status,modality:S.modality};ie(Ea=>Ea.some(es=>es.id===Js.id)?Ea:[...Ea,pa]),t({title:"Agendamento confirmado"}),ei.current=!0,ue(!1);return}if(Te&&lt>1){const pa=[],Ea=[];for(let ws=0;ws<lt;ws++){const Qs=La(S.date,ws*7),Bi=new Date(Qs);Bi.setHours(Math.floor(S.startMinutes/60),S.startMinutes%60,0,0);const wi=new Date(Qs);wi.setHours(Math.floor(S.endMinutes/60),S.endMinutes%60,0,0),pa.push({codigo_empresa:A.codigo_empresa,quadra_id:Ke.id,cliente_id:ya?.id??null,clientes:Pa,inicio:Bi.toISOString(),fim:wi.toISOString(),modalidade:S.modality,status:S.status})}const{data:Fi,error:es}=await he.from("agendamentos").insert(pa).select("id, codigo, inicio, fim");if(es)throw es;const $i=[];for(const ws of Fi){const Qs=nn.map((Bi,wi)=>({codigo_empresa:A.codigo_empresa,agendamento_id:ws.id,cliente_id:Bi.id,nome:Bi.nome,valor_cota:0,status_pagamento:"Pendente",ordem:wi+1}));$i.push(...Qs),Ea.push({id:ws.id,code:ws.codigo,court:S.court,customer:ya?.nome||Pa[0]||"",start:new Date(ws.inicio),end:new Date(ws.fim),status:S.status,modality:S.modality})}$i.length>0&&await he.from("agendamento_participantes").insert($i),ie(ws=>[...ws,...Ea]),t({title:`${lt} Agendamentos criados!`,description:"Agendamentos recorrentes criados com sucesso.",variant:"success"}),ne(!1),Nt(4)}else{const{data:pa,error:Ea}=await he.from("agendamentos").insert({codigo_empresa:A.codigo_empresa,quadra_id:Ke.id,cliente_id:ya?.id??null,clientes:Pa,inicio:er.toISOString(),fim:hn.toISOString(),modalidade:S.modality,status:S.status}).select("id, codigo").single();if(Ea)throw Ea;const Fi={id:pa.id,code:pa.codigo,court:S.court,customer:ya?.nome||Pa[0]||"",start:er,end:hn,status:S.status,modality:S.modality};ie(es=>[...es,Fi]),t({title:"Agendamento criado",variant:"success",duration:2e3}),r().catch(es=>{console.error("[AgendaPage] Erro ao recarregar alertas:",es)});try{const es=nn.map(($i,ws)=>({codigo_empresa:A.codigo_empresa,agendamento_id:pa.id,cliente_id:$i.id,nome:$i.nome,valor_cota:0,status_pagamento:"Pendente",ordem:ws+1}));if(es.length>0){const{error:$i}=await he.from("agendamento_participantes").insert(es);if(!$i){const ws=es.map(Qs=>({agendamento_id:Qs.agendamento_id,cliente_id:Qs.cliente_id,nome:Qs.nome,codigo:nn.find(Bi=>Bi.id===Qs.cliente_id)?.codigo||null,valor_cota:Qs.valor_cota,status_pagamento:Qs.status_pagamento,ordem:Qs.ordem}));pt(Qs=>({...Qs,[pa.id]:ws}))}}}catch{}}ei.current=!0,io.current=!1;try{ht.current=[]}catch{}try{Br([])}catch{}try{sessionStorage.removeItem(ln)}catch{}ue(!1)}catch(Ke){t({title:"Erro ao salvar agendamento",description:Ke?.message||"Tentando novamente automaticamente",variant:"destructive"})}finally{$r(!1)}}},[tn,xt,S,Qe,A,oc,ie,t,ue,kn]);p.useEffect(()=>{if(!Qe?.id){Aa.current=!1,Bn.current=null;return}if(!bi.current||!Aa.current){const Ve=setTimeout(()=>{bi.current&&(Aa.current=!0,Bn.current=JSON.stringify({court:S.court,startMinutes:S.startMinutes,endMinutes:S.endMinutes,modality:S.modality,status:S.status,selectedClients:S.selectedClients}))},500);return()=>clearTimeout(Ve)}const we=JSON.stringify({court:S.court,startMinutes:S.startMinutes,endMinutes:S.endMinutes,modality:S.modality,status:S.status,selectedClients:S.selectedClients});if(we!==Bn.current)return Jr.current&&clearTimeout(Jr.current),Jr.current=setTimeout(async()=>{if(!xt[S.court])return;const Ke=S.startMinutes,jt=S.endMinutes;if(!(Number.isFinite(Ke)&&Number.isFinite(jt)&&jt>Ke)||!oc(Ke,jt))return;const Mr=Bn.current?JSON.parse(Bn.current).selectedClients:[],Wt=S.selectedClients||[],er=JSON.stringify(Mr)!==JSON.stringify(Wt);console.log(er?" [Auto-save] Salvando alteraes (participantes modificados)...":" [Auto-save] Salvando alteraes..."),$n(!0);try{await Ys({autoSave:!0}),Bn.current=we,console.log(er?" [Auto-save] Participantes salvos no banco! Disponveis no modal de pagamentos.":" [Auto-save] Salvo com sucesso!")}catch(hn){console.error(" [Auto-save] Erro ao salvar:",hn)}finally{$n(!1)}},1500),()=>{Jr.current&&clearTimeout(Jr.current)}},[Qe?.id,S.court,S.startMinutes,S.endMinutes,S.modality,S.status,S.selectedClients,xt,oc,Ys]),p.useEffect(()=>{const we=async()=>{if(!te||!A?.codigo_empresa)return;const Ve=String(A.codigo_empresa);if(Ua.current!==Ve)try{Ur(!0);try{const wt=`clientes:list:${A.codigo_empresa}`,Mr=JSON.parse(localStorage.getItem(wt)||"[]");if(Array.isArray(Mr)&&Mr.length>0){ac(Mr);try{mn(Wt=>JSON.stringify(Wt)===JSON.stringify(Mr)?Wt:Mr)}catch{}}}catch{}const{data:Ke,error:jt}=await he.from("clientes").select("id, nome, codigo, email, telefone, status, codigo_empresa, is_consumidor_final").eq("codigo_empresa",A.codigo_empresa).eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0});if(jt){console.error("Falha ao carregar clientes:",jt);return}if(Array.isArray(Ke)){if(Ke.length===0){let wt=0;try{const Mr=`clientes:list:${A.codigo_empresa}`,Wt=JSON.parse(localStorage.getItem(Mr)||"[]");wt=Array.isArray(Wt)?Wt.length:0}catch{}if(wt>0&&!Za.current){Za.current=!0,setTimeout(we,700);return}}Za.current=!1,Ua.current=Ve,ac(Ke);try{const wt=`clientes:list:${A.codigo_empresa}`;localStorage.setItem(wt,JSON.stringify(Ke))}catch{}try{mn(wt=>JSON.stringify(wt)===JSON.stringify(Ke)?wt:Ke)}catch{}}}catch{}finally{Ur(!1)}};we()},[te,A?.codigo_empresa]),p.useEffect(()=>{const we=xt[S.court];if(!we)return;const Ve=Number(we.valor||0);if(!Number.isFinite(Ve)||Ve<=0)return;const Ke=Math.max(0,S.endMinutes-S.startMinutes);if(Ke<=0)return;const jt=Ke/Oa,wt=Math.round(Ve*jt*100)/100;y(ov(String(wt.toFixed(2))))},[xt,S.court,S.startMinutes,S.endMinutes]),p.useEffect(()=>{if(te&&!bi.current)if(Qe){const we=ju(Qe.start)*60+_u(Qe.start),Ve=ju(Qe.end)*60+_u(Qe.end),Ke=rt[Qe.id]||[],jt=Ke.filter(Wt=>Wt&&Wt.cliente_id).map(Wt=>({id:Wt.cliente_id,nome:Wt.nome,codigo:Wt.codigo||null})),wt=xt[Qe.court]?.modalidades||rp,Mr=wt.includes(Qe.modality)?Qe.modality:wt[0]||"";G({selectedClients:jt,court:Qe.court,modality:Mr,status:Qe.status,date:Es(Qe.start),startMinutes:we,endMinutes:Ve}),al.current=!0,v(Ke.map(Wt=>({cliente_id:Wt.cliente_id,nome:Wt.nome,codigo:Wt.codigo,valor_cota:(()=>{const er=Number.isFinite(Number(Wt.valor_cota))?Number(Wt.valor_cota):gf(Wt.valor_cota);return ov(String((Number.isFinite(er)?er:0).toFixed(2)))})(),status_pagamento:Wt.status_pagamento||"Pendente",finalizadora_id:Wt.finalizadora_id?String(Wt.finalizadora_id):null,aplicar_taxa:Wt.aplicar_taxa||!1}))),Wc(jt[0]?.id||null),(async()=>{try{const{data:Wt,error:er}=await he.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, cliente:clientes!agendamento_participantes_cliente_id_fkey ( nome, codigo )").eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",Qe.id).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(!er&&Array.isArray(Wt)){const hn=(S?.selectedClients||[]).slice();let In=Wt.slice();if(hn.length>0){const nn=new Map;Wt.forEach(Pa=>{const Js=nn.get(Pa.cliente_id)||[];Js.push(Pa),nn.set(Pa.cliente_id,Js)});const oa=new Map,ya=[];for(const Pa of hn){const Js=oa.get(Pa.id)||0,Ea=(nn.get(Pa.id)||[])[Js];Ea&&(ya.push(Ea),oa.set(Pa.id,Js+1))}ya.length===hn.length&&(In=ya)}else if(Array.isArray(Qe?.clientes)&&Qe.clientes.length>0){const nn=new Map;Wt.forEach(Pa=>{const Js=Pa.nome||Pa.cliente?.nome||"",pa=nn.get(Js)||[];pa.push(Pa),nn.set(Js,pa)});const oa=new Map,ya=[];for(const Pa of Qe.clientes){const Js=oa.get(Pa)||0,Ea=(nn.get(Pa)||[])[Js];Ea&&(ya.push(Ea),oa.set(Pa,Js+1))}ya.length===Wt.length&&(In=ya)}try{const nn=In.findIndex(oa=>String(oa?.nome||"").toLowerCase()!=="cliente consumidor");if(nn>0){const oa=In.splice(nn,1)[0];In.unshift(oa)}}catch{}const _n=In.filter(nn=>nn&&nn.cliente_id).map(nn=>({id:nn.cliente_id,nome:nn.nome||nn.cliente?.nome||"",codigo:nn.cliente?.codigo||null}));G(nn=>({...nn,selectedClients:_n})),v(In.map(nn=>({cliente_id:nn.cliente_id,nome:nn.nome||nn.cliente?.nome||"",codigo:nn.cliente?.codigo||null,valor_cota:(()=>{const oa=Number.isFinite(Number(nn.valor_cota))?Number(nn.valor_cota):gf(nn.valor_cota);return ov(String((Number.isFinite(oa)?oa:0).toFixed(2)))})(),status_pagamento:nn.status_pagamento||"Pendente",finalizadora_id:nn.finalizadora_id?String(nn.finalizadora_id):null,aplicar_taxa:nn.aplicar_taxa||!1}))),Wc(_n[0]?.id||null)}}catch(Wt){console.error("Falha ao carregar participantes (refresh)",Wt)}})(),bi.current=!0,Bn.current=JSON.stringify({court:Qe.court,startMinutes:we,endMinutes:Ve,modality:Mr,status:Qe.status,selectedClients:jt})}else if($t){const we=(it||[]).includes($t.court)?$t.court:(it||[])[0]||"",Ve={selectedClients:Ae.current?Array.isArray(S.selectedClients)?S.selectedClients:[]:[],court:we,modality:(()=>(xt[we]?.modalidades||rp)[0]||"")(),status:"scheduled",date:$t.date??M,startMinutes:$t.startMinutes??Mt(),endMinutes:$t.endMinutes??Mt()+60};G(Ve),v([]),al.current=!0,bi.current=!0}else{const we=it[0]||"",Ve=xt[we]?.modalidades||rp,Ke=Array.isArray(wr)?wr:[],jt=Ae.current?Array.isArray(S.selectedClients)?S.selectedClients:[]:Ke.length>0?Ke:[];if(!Ae.current&&Ke.length>0)try{Ae.current=!0}catch{}G({selectedClients:jt,court:we,modality:Ve[0]||"",status:"scheduled",date:M,startMinutes:Mt(),endMinutes:Mt()+60}),v([]),al.current=!0,bi.current=!0}},[te,Qe,M,$t,it,rp,rt]),p.useEffect(()=>{if(te&&Qe){bi.current=!1,Dd.current=!1,Ae.current||G(we=>({...we,selectedClients:[]}));try{dr.current=!1}catch{}}},[Qe,te]),p.useEffect(()=>{if(te)try{Dd.current=!1}catch{}},[te]),p.useEffect(()=>{if(!te||!Qe||Dd.current||Aa.current)return;const we=rt[Qe.id]||[];if(!we.length)return;let Ve=we.slice();const Ke=(S?.selectedClients||[]).slice();if(Ke.length>0){const wt=new Map;we.forEach(er=>{const hn=wt.get(er.cliente_id)||[];hn.push(er),wt.set(er.cliente_id,hn)});const Mr=new Map,Wt=[];for(const er of Ke){const hn=Mr.get(er.id)||0,_n=(wt.get(er.id)||[])[hn];_n&&(Wt.push(_n),Mr.set(er.id,hn+1))}Wt.length===Ke.length&&(Ve=Wt)}else if(Array.isArray(Qe?.clientes)&&Qe.clientes.length>0){const wt=new Map;we.forEach(er=>{const hn=er.nome||"",In=wt.get(hn)||[];In.push(er),wt.set(hn,In)});const Mr=new Map,Wt=[];for(const er of Qe.clientes){const hn=Mr.get(er)||0,_n=(wt.get(er)||[])[hn];_n&&(Wt.push(_n),Mr.set(er,hn+1))}Wt.length===we.length&&(Ve=Wt)}try{const wt=Ve.findIndex(Mr=>String(Mr?.nome||"").toLowerCase()!=="cliente consumidor");if(wt>0){const Mr=Ve.splice(wt,1)[0];Ve.unshift(Mr)}}catch{}const jt=Ve.filter(wt=>wt&&wt.cliente_id).map(wt=>({id:wt.cliente_id,nome:wt.nome,codigo:wt.codigo||null}));if(jt.length>0){try{localStorage.getItem("debug:agenda")==="1"&&(console.log("[ORDER-AGENDA] chipsIdsNow:",Ke.map(wt=>wt.id)),console.log("[ORDER-AGENDA] selectedFromPartsIds:",jt.map(wt=>wt.id)))}catch{}G(wt=>({...wt,selectedClients:jt})),v(Ve.map(wt=>({cliente_id:wt.cliente_id,nome:wt.nome,codigo:wt.codigo||null,valor_cota:(()=>{const Mr=Number.isFinite(Number(wt.valor_cota))?Number(wt.valor_cota):gf(wt.valor_cota);return ov(String((Number.isFinite(Mr)?Mr:0).toFixed(2)))})(),status_pagamento:wt.status_pagamento||"Pendente",finalizadora_id:wt.finalizadora_id||null,aplicar_taxa:wt.aplicar_taxa||!1}))),Wc(jt[0]?.id||null),Dd.current=!0}},[te,Qe,rt]),p.useEffect(()=>{const we=Ve=>{if(te&&!s){if(Ve.key==="Escape"){if(Ve.preventDefault(),Qe?.id){console.log(" [Auto-save] Salvando ao fechar modal (ESC)..."),Jr.current&&clearTimeout(Jr.current),Ys({autoSave:!0}).then(()=>{console.log(" [Auto-save] Salvo ao fechar (ESC)!"),ue(!1)}).catch(Ke=>{console.error(" [Auto-save] Erro ao salvar ao fechar (ESC):",Ke),ue(!1)});return}ue(!1)}Ve.key==="Enter"&&!["INPUT","TEXTAREA"].includes(Ve.target.tagName)&&(Ve.preventDefault(),!io.current&&!ei.current&&(io.current=!0,ei.current=!1,Ys().catch(()=>{}))),Qe&&(Ve.key==="F3"&&(Ve.preventDefault(),hr(!0)),Ve.key==="F4"&&(Ve.preventDefault(),o()))}};return window.addEventListener("keydown",we),()=>window.removeEventListener("keydown",we)},[te,Qe,s,o,hr,Ys,io,ei,ue,S]);const ti=p.useMemo(()=>{const we=xt[S.court];if(!we)return{start:Ms*60,end:ys*60};const[Ve,Ke]=String(we.hora_inicio||"06:00:00").split(":").map(Number),[jt,wt]=String(we.hora_fim||"24:00:00").split(":").map(Number),Mr=jt===0&&wt===0?24:jt;return{start:Ve*60+(Ke||0),end:Mr*60+(wt||0)}},[xt,S.court,Ms,ys]),Md=p.useMemo(()=>{const we=ur(S.date,"yyyy-MM-dd"),Ve=Ke=>{const jt=ju(Ke),wt=_u(Ke);return jt===0&&wt===0?1440:jt*60+wt};return le.filter(Ke=>Ke.court===S.court&&ur(Ke.start,"yyyy-MM-dd")===we&&Ke.status!=="canceled"&&(!Qe||Ke.id!==Qe.id)).map(Ke=>[Ve(Ke.start),Ve(Ke.end)]).sort((Ke,jt)=>Ke[0]-jt[0])},[le,S.court,S.date,Qe]),Mg=(we,Ve,Ke,jt)=>we<jt&&Ke<Ve;function oc(we,Ve){if(Ve<=we||we<ti.start||Ve>ti.end)return!1;for(const[Ke,jt]of Md)if(Mg(we,Ve,Ke,jt))return!1;return!0}const F0=we=>{let Ve=we+Oa;if(!oc(we,Ve))return null;for(;Ve+Oa<=ti.end&&oc(we,Ve+Oa);)Ve+=Oa;return Ve},G1=p.useMemo(()=>{const we=ti,Ve=[];for(let Ke=we.start;Ke<=we.end;Ke+=Oa){const jt=oc(Ke,Ke+Oa);let wt=Math.floor(Ke/60);const Mr=Ke%60;wt>=24&&Ke===1440&&(wt=0),Ve.push({value:Ke,label:`${String(wt).padStart(2,"0")}:${String(Mr).padStart(2,"0")}`,available:jt})}return Ve},[ti,Md]),K1=p.useMemo(()=>{const we=F0(S.startMinutes),Ve=[];for(let Ke=S.startMinutes+Oa;Ke<=ti.end;Ke+=Oa){const jt=!!we&&Ke<=we;let wt=Math.floor(Ke/60);const Mr=Ke%60;wt>=24&&(wt=wt%24),Ve.push({value:Ke,label:`${String(wt).padStart(2,"0")}:${String(Mr).padStart(2,"0")}`,available:jt})}return Ve},[S.startMinutes,Md,ti]);p.useEffect(()=>{if(al.current){al.current=!1;return}const Ve=(()=>{if(oc(S.startMinutes,S.startMinutes+Oa))return S.startMinutes;for(let wt=Math.max(ti.start,S.startMinutes);wt<=ti.end-Oa;wt+=Oa)if(oc(wt,wt+Oa))return wt;for(let wt=ti.start;wt<=ti.end-Oa;wt+=Oa)if(oc(wt,wt+Oa))return wt;return S.startMinutes})();if(Ve!==S.startMinutes){G(wt=>({...wt,startMinutes:Ve}));return}const Ke=F0(Ve);if(!Ke)return;let jt=S.endMinutes;(!Number.isFinite(jt)||jt<=Ve||jt>Ke)&&(jt=Math.min(Ve+60,Ke),jt<Ve+Oa&&(jt=Ve+Oa),G(wt=>({...wt,endMinutes:jt})))},[S.startMinutes,S.court,S.date,Md,ti]);const X1=p.useMemo(()=>xt[S.court]?.modalidades||rp,[xt,S.court]);p.useEffect(()=>{const we=xt[S.court]?.modalidades||rp;we.includes(S.modality)||G(Ve=>({...Ve,modality:we[0]||""}))},[S.court,xt]),p.useEffect(()=>{if(al.current||!Zi(S.date,M))return;if(ve[S.court]&&!ve[S.court].funciona){const Ke=it.find(jt=>!ve[jt]||ve[jt].funciona);Ke&&G(jt=>({...jt,court:Ke}))}},[S.court,S.date,ve,it,M]);const Y1=p.useMemo(()=>{const we=Math.max(0,S.endMinutes-S.startMinutes),Ve=Math.floor(we/60),Ke=we%60;return Ve>0&&Ke>0?`${Ve}h ${Ke}min`:Ve>0?`${Ve}h`:`${Ke}min`},[S.startMinutes,S.endMinutes]),im=p.useMemo(()=>{if(!te)return"";const we=new Date,Ve=ju(we)*60+_u(we),Ke=Number(S.startMinutes),jt=Number(S.endMinutes),wt=Mr=>{let Wt=Math.floor(Mr/60);const er=Mr%60;return Wt>=24&&(Wt=Wt%24),`${String(Wt).padStart(2,"0")}:${String(er).padStart(2,"0")}`};if(En.autoConfirmEnabled&&S.status==="scheduled"){const Mr=Math.max(0,Ke-Number(En.autoConfirmMinutesBefore||0));if(Ve<Mr)return`Este agendamento est com automao ativa (Confirmar automaticamente s ${wt(Mr)})`}return En.autoStartEnabled&&S.status==="confirmed"&&Ve<Ke?`Este agendamento est com automao ativa (Iniciar automaticamente s ${wt(Ke)})`:En.autoFinishEnabled&&S.status==="in_progress"&&Ve<jt?`Este agendamento est com automao ativa (Finalizar automaticamente s ${wt(jt)})`:""},[te,S.startMinutes,S.endMinutes,S.status,En]),$0=p.useMemo(()=>(m||[]).length,[m]),Rg=p.useMemo(()=>{const Ve=(m||[]).map(er=>{const hn=gf(er?.valor_cota);return Number.isFinite(hn)?hn:0}).reduce((er,hn)=>er+hn,0),Ke=gf(g),jt=Number.isFinite(Ke)?Ke:0,wt=Number((jt-Ve).toFixed(2));let Mr=0,Wt=0;for(const er of m||[])(er?.status_pagamento||"Pendente")==="Pago"?Mr++:Wt++;return{totalAssigned:Ve,totalTarget:jt,diff:wt,paid:Mr,pending:Wt}},[m,g]);p.useEffect(()=>{const we=gf(g);if(!Number.isFinite(we)||we<=0)return;(m||[]).some(Ke=>gf(Ke?.valor_cota)>=we)&&(m||[]).some(Ke=>Ke.status_pagamento!=="Pago")&&v(Ke=>Ke.map(jt=>({...jt,status_pagamento:"Pago"})))},[m,g]),p.useCallback(()=>{const we=(S.selectedClients||[]).length;if(!we)return;const Ve=gf(g);if(!Number.isFinite(Ve)||Ve<0)return;const Ke=Math.round(Ve*100),jt=Math.floor(Ke/we);let wt=Ke-jt*we;v(Mr=>{const Wt=(S.selectedClients||[]).slice(),er=new Map,hn=new Map;return(Mr||[]).forEach(_n=>{const nn=hn.get(_n.cliente_id)||[];nn.push(_n),hn.set(_n.cliente_id,nn)}),Wt.map(_n=>{const nn=er.get(_n.id)||0,ya=(hn.get(_n.id)||[])[nn];er.set(_n.id,nn+1);const Pa=jt+(wt>0?1:0);wt>0&&wt--;const Js=(Pa/100).toFixed(2),pa=ov(String(Js)),Ea=gf(pa);return{cliente_id:_n.id,nome:_n.nome,codigo:ya?.codigo??_n.codigo??null,valor_cota:pa,status_pagamento:Number.isFinite(Ea)&&Ea>0?"Pago":"Pendente",finalizadora_id:ya?.finalizadora_id??null,aplicar_taxa:ya?.aplicar_taxa??!1}})})},[S.selectedClients,g,v]),p.useCallback(()=>{v(we=>we.map(Ve=>({...Ve,valor_cota:"",status_pagamento:"Pendente"})))},[v]);const lm=p.useCallback(async()=>{try{fr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{ye.current="close"}catch{}try{Pe(!1),xe(!1)}catch{}if(Qe?.id&&Aa.current)try{Jr.current&&clearTimeout(Jr.current),console.log(" [CustomerPicker] Salvando participantes ao fechar..."),await Ys({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(we){console.error(" [CustomerPicker] Erro ao salvar:",we)}},[Qe?.id,Ys]);return a.jsxs(a.Fragment,{children:[Pr&&a.jsx(xn,{open:!0,onOpenChange:we=>{if(!we&&Pr){try{Pr.resolve(!1)}catch{}vr(null)}},children:a.jsxs(vn,{onOpenAutoFocus:we=>we.preventDefault(),children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Reativar automao?"}),a.jsx(Dn,{children:"Ao reativar, este agendamento voltar a ser atualizado automaticamente (incio e trmino) pelas regras da agenda."})]}),a.jsx(ra,{children:a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx(me,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{try{Pr?.resolve(!1)}catch{}vr(null)},children:"Cancelar"}),a.jsx(me,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>{try{Pr?.resolve(!0)}catch{}vr(null)},children:"Reativar"})]})})]})}),te&&a.jsx(xn,{open:!0,onOpenChange:async we=>{if(we)ue(!0);else{try{const Ve=Date.now()<(Ft.current||0);if(Ut||_r||Ve){try{const Ke={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(blocked)",effectiveCustomerPickerOpen:Ut,isClientFormOpen:_r,suppressUntil:Ft.current,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(se.current)?se.current.length:NaN,lastLen:Array.isArray(ht.current)?ht.current.length:NaN};console.warn("[CustomerPicker][DIALOG:block-close]",Ke)}catch{}return}}catch{}try{const Ve={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(allow-close)",effectiveCustomerPickerOpen:Ut,isClientFormOpen:_r,suppressUntil:Ft.current,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(se.current)?se.current.length:NaN,lastLen:Array.isArray(ht.current)?ht.current.length:NaN};console.warn("[CustomerPicker][DIALOG:allow-close]",Ve)}catch{}if(s&&console.log("[Dialog] Fechamento solicitado com PaymentModal aberto - iniciando coordenao"),console.log(" [FLUXO CRTICO] Solicitao de fechamento do modal de agendamento recebida"),console.log(" Estado atual:",{isPaymentModalOpen:s,editingBooking:Qe?.id,timestamp:new Date().toISOString()}),s&&typeof window<"u"){console.log(" [FLUXO CRTICO] PaymentModal aberto - solicitando save-and-close");try{await new Promise(Ve=>{const Ke=()=>{window.removeEventListener("paymentmodal:closed",Ke),console.log(" [FLUXO CRTICO] PaymentModal confirmou fechamento"),Ve()},jt=setTimeout(()=>{window.removeEventListener("paymentmodal:closed",Ke),console.warn(" [FLUXO CRTICO] Timeout aguardando PaymentModal fechar"),Ve()},3e3),wt=()=>{clearTimeout(jt),Ke()};window.addEventListener("paymentmodal:closed",wt,{once:!0}),window.dispatchEvent(new Event("paymentmodal:save-and-close"))})}catch{}}ue(!1),ge(null),Yt(null),Dd.current=!1,console.log(" [FLUXO CRTICO] Modal de agendamento fechado"),ne(!1),Nt(4)}},children:a.jsxs(vn,{forceMount:!0,disableAnimations:!0,alignTop:!0,className:"sm:max-w-[960px] max-h-[85vh] min-h-[360px] flex flex-col p-0",onOpenAutoFocus:we=>we.preventDefault(),onInteractOutside:async we=>{try{const Ve=Date.now()<(Ft.current||0);if(s||Ut||_r||Ve){try{const Ke={ts:new Date().toISOString(),hook:"DialogContent:onInteractOutside(blocked)",effectiveCustomerPickerOpen:Ut,isClientFormOpen:_r,isPaymentModalOpen:s,suppressUntil:Ft.current,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(se.current)?se.current.length:NaN,lastLen:Array.isArray(ht.current)?ht.current.length:NaN}}catch{}we.preventDefault();return}if(Qe?.id){we.preventDefault(),console.log(" [Auto-save] Salvando ao clicar fora do modal...");try{Jr.current&&clearTimeout(Jr.current),await Ys({autoSave:!0}),console.log(" [Auto-save] Salvo ao clicar fora!")}catch(Ke){console.error(" [Auto-save] Erro ao salvar ao clicar fora:",Ke)}finally{ue(!1)}return}}catch{}},onEscapeKeyDown:we=>{try{const Ve=Date.now()<(Ft.current||0);if(s||Ut||_r||Ve){we.preventDefault();return}}catch{}},children:[a.jsxs(pn,{className:"px-6 pt-6 pb-4 flex-shrink-0",children:[a.jsxs(un,{className:"flex items-center justify-between gap-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{children:Qe?(()=>{const we=Qe?.code,Ve=typeof we=="number"?String(we).padStart(3,"0"):null;return Ve?`Editar agendamento - ${Ve}`:"Editar Agendamento"})():"Novo Agendamento"}),An&&a.jsxs("span",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs bg-blue-600/10 text-blue-400 border-blue-700/30",children:[a.jsxs("svg",{className:"w-3 h-3 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]})]}),Qe&&(()=>{Rg?.pending===0&&$0>0;const we=(Rg?.pending||0)>0,Ve="inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs",Ke="bg-emerald-600/10 text-emerald-400 border-emerald-700/30",jt="bg-amber-600/15 text-amber-400 border-amber-700/30",wt=Mr=>a.jsx("span",{"aria-hidden":!0,className:`inline-block w-2 h-2 rounded-full ${Mr}`});return a.jsxs("span",{className:`${Ve} ${we?jt:Ke}`,title:we?"H pagamentos pendentes":"Todos participantes pagos","aria-live":"polite",children:[wt(we?"bg-amber-400":"bg-emerald-400"),a.jsx("span",{className:"tracking-wide",children:"Pagos"}),a.jsx("strong",{className:"text-base font-semibold tabular-nums",children:Rg?.paid||0}),a.jsx("span",{className:"opacity-60",children:"/"}),a.jsx("span",{className:"text-base font-semibold tabular-nums",children:$0})]})})(),a.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-md border text-sm bg-white/5 border-white/10 text-text-primary",title:"Data do agendamento",children:[a.jsx(Vs,{className:"w-4 h-4 opacity-80"}),a.jsxs("span",{className:"font-semibold",children:[ur(S.date,"dd/MM/yyyy"),(()=>{const we=Number(S?.startMinutes),Ve=Number(S?.endMinutes);if(!(Number.isFinite(we)&&Number.isFinite(Ve)&&Ve>we))return"";const jt=wt=>{let Mr=Math.floor(wt/60);const Wt=wt%60;return Mr>=24&&(Mr=Mr%24),`${String(Mr).padStart(2,"0")}:${String(Wt).padStart(2,"0")}`};return`  ${jt(we)}${jt(Ve)}`})()]})]})]}),a.jsx(Dn,{children:Qe?"As alteraes so salvas automaticamente enquanto voc edita.":"Preencha os detalhes para criar uma nova reserva."})]}),a.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 pb-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"clientes-field",className:"font-bold",children:"Clientes"}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsxs(ci,{modal:!1,open:Ut,onOpenChange:we=>{const Ve=Date.now(),Ke=Ve<(st.current||0)||Ve<(Ft.current||0)||Ve<(Kt.current||0)||Xt();if(!((_r||xr)&&we===!1)){if(!we&&Ke){hs("onOpenChange:blocked:guard-window");return}if(!we&&ye.current!=="close"){hs("onOpenChange:blocked:sticky-close");return}if(we){fr.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}xe(!0),hs("open:accepted")}else{fr.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{const jt=Array.isArray(se.current)?[...se.current]:[];if(jt.length>0){Qr.current="onOpenChange:close:preserve";try{sessionStorage.setItem(ln,JSON.stringify(jt))}catch{}Gr(jt),Ja("onOpenChange:close:preserve",jt)}else dr.current||(Qr.current="onOpenChange:close:empty",Ja("onOpenChange:close:empty",[]))}catch{}try{Ft.current=Date.now()+1500}catch{}try{const jt={ts:new Date().toISOString(),hook:"onOpenChange(false)",formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(se.current)?se.current.length:NaN,lastLen:Array.isArray(ht.current)?ht.current.length:NaN,chipsLen:Array.isArray(wr)?wr.length:NaN,clientsLoading:!!xr,lastAction:Qr?.current,clearedByUser:!!dr?.current,suppressUntil:Ft.current};console.warn("[CustomerPicker][CLOSE:onOpenChange]",jt)}catch{}xe(!1),hs("close:accepted")}!we&&ir.current&&(br(!0),ir.current=!1,setTimeout(()=>br(!1),1200)),ye.current=we?"open":"close",Pe(we)}},children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{type:"button",variant:"outline",className:gr("min-w-[180px] justify-between",Yr&&"ring-2 ring-emerald-500/40 ring-offset-2 ring-offset-transparent transition-shadow"),onClick:()=>{hs("trigger:click");try{ye.current="open"}catch{}try{fr.current=!0,localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}Pe(!0),xe(!0),setTimeout(()=>{Pe(!0),xe(!0),hs("trigger:reassert-open")},30),hs("trigger:after-set-open")},children:[Ol,a.jsx(wg,{className:"w-4 h-4 ml-2 opacity-60"})]})}),a.jsx(Jo,{forceMount:!0,side:"bottom",align:"start",className:"w-[360px] p-2 z-[9999]",onPointerDownOutside:we=>{const Ve=Date.now();if(Ve<(st.current||0)||Ve<(Ft.current||0)||Ve<(Kt.current||0)||Xt()){we.preventDefault();return}if(_r||xr){we.preventDefault();return}try{const jt=Array.isArray(se.current)?[...se.current]:[];if(jt.length>0){Qr.current="outside:close:snapshot",ht.current=jt;try{sessionStorage.setItem(ln,JSON.stringify(jt))}catch{}Gr(jt),Ja("outside:close:apply",jt),dr.current=!1}else{if(Qr.current="outside:close:empty",dr.current){ht.current=[];try{sessionStorage.removeItem(ln)}catch{}console.warn("[CustomerPicker][outside:close:empty:cleared]",{ts:new Date().toISOString()})}Ja("outside:close:empty",[])}}catch{}try{Ft.current=Date.now()+1500}catch{}try{const jt={ts:new Date().toISOString(),hook:"onPointerDownOutside",formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(se.current)?se.current.length:NaN,lastLen:Array.isArray(ht.current)?ht.current.length:NaN,chipsLen:Array.isArray(wr)?wr.length:NaN,clientsLoading:!!xr,lastAction:Qr?.current,clearedByUser:!!dr?.current,suppressUntil:Ft.current}}catch{}ir.current=!0,ye.current="close",fr.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}Pe(!1),xe(!1),Qe?.id&&Aa.current&&(async()=>{try{Jr.current&&clearTimeout(Jr.current),console.log(" [CustomerPicker] Salvando participantes (clique fora)..."),await Ys({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(jt){console.error(" [CustomerPicker] Erro ao salvar:",jt)}})()},onFocusOutside:we=>{hs("focusOutside"),(_r||xr)&&we.preventDefault()},onEscapeKeyDown:we=>{hs("escapeKeyDown"),(_r||xr)&&we.preventDefault()},children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{ref:dn,placeholder:"Buscar por cdigo ou nome...",value:qe,onChange:we=>{He(we.target.value),qt(0)},onKeyDown:we=>{if(we.key==="ArrowDown"||we.key==="ArrowUp"){we.preventDefault();const Ve=(Ws||[]).filter(Wt=>{const er=qe.trim().toLowerCase();return er?String(rr(Wt)||"").toLowerCase().includes(er):!0}),Ke=Ve.find(Wt=>Wt?.is_consumidor_final===!0),wt=Ve.filter(Wt=>Wt?.is_consumidor_final!==!0).slice().sort((Wt,er)=>{const hn=typeof Wt=="object"&&Number.isFinite(Number(Wt?.codigo))?Number(Wt.codigo):1/0,In=typeof er=="object"&&Number.isFinite(Number(er?.codigo))?Number(er.codigo):1/0;if(hn!==In)return hn-In;const _n=String(Gt(Wt)||"").toLowerCase(),nn=String(Gt(er)||"").toLowerCase();return _n.localeCompare(nn)}),Mr=Ke?[Ke,...wt]:wt;we.key==="ArrowDown"?qt(Wt=>Math.min(Wt+1,Mr.length-1)):qt(Wt=>Math.max(Wt-1,0))}if(we.key==="Enter"){we.preventDefault();const Ve=(Ws||[]).filter(er=>{const hn=qe.trim().toLowerCase();return hn?String(rr(er)||"").toLowerCase().includes(hn):!0}),Ke=Ve.find(er=>er?.is_consumidor_final===!0),wt=Ve.filter(er=>er?.is_consumidor_final!==!0).slice().sort((er,hn)=>{const In=typeof er=="object"&&Number.isFinite(Number(er?.codigo))?Number(er.codigo):1/0,_n=typeof hn=="object"&&Number.isFinite(Number(hn?.codigo))?Number(hn.codigo):1/0;if(In!==_n)return In-_n;const nn=String(Gt(er)||"").toLowerCase(),oa=String(Gt(hn)||"").toLowerCase();return nn.localeCompare(oa)}),Wt=(Ke?[Ke,...wt]:wt)[ut];if(Wt){const er=Wt.id,hn=Gt(Wt),In=Wt.codigo,_n={id:er,nome:hn,codigo:In},nn=[...Array.isArray(se.current)?se.current:[],_n];try{(se.current||[]).length===0&&(V.current=er||null)}catch{}try{dr.current=!1}catch{}try{nn.length>0&&(ht.current=nn)}catch{}try{se.current=nn}catch{}Ja("keyboard:enter",nn),fr.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}}}},className:"pl-10 pr-10"}),qe&&a.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary p-1 rounded hover:bg-white/10",onClick:()=>{He(""),dn.current?.focus()},children:a.jsx(el,{className:"w-4 h-4"})})]}),a.jsxs("div",{ref:sn,className:"max-h-[260px] overflow-y-auto divide-y divide-border rounded-md border border-border",onWheel:we=>{we.stopPropagation()},onTouchMove:we=>{we.stopPropagation()},style:{overscrollBehavior:"contain"},children:[xr&&(Ws||[]).length===0&&a.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Carregando clientes"}),!xr&&(Ws||[]).length===0&&a.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum cliente encontrado"}),!xr&&(()=>{const we=(Ws||[]).filter(Mr=>{const Wt=qe.trim().toLowerCase();return Wt?String(rr(Mr)||"").toLowerCase().includes(Wt):!0}),Ve=we.find(Mr=>Mr?.is_consumidor_final===!0),jt=we.filter(Mr=>Mr?.is_consumidor_final!==!0).slice().sort((Mr,Wt)=>{const er=typeof Mr=="object"&&Number.isFinite(Number(Mr?.codigo))?Number(Mr.codigo):1/0,hn=typeof Wt=="object"&&Number.isFinite(Number(Wt?.codigo))?Number(Wt.codigo):1/0;if(er!==hn)return er-hn;const In=String(Gt(Mr)||"").toLowerCase(),_n=String(Gt(Wt)||"").toLowerCase();return In.localeCompare(_n)});return Ve?[Ve,...jt]:jt})().map((we,Ve)=>{const Ke=we?.is_consumidor_final===!0,jt=typeof we=="object"?we.id:null,wt=Gt(we),Mr=typeof we=="object"?we.codigo:null,Wt=String(wt||"").toLowerCase(),er=_n=>_n.id&&jt?_n.id===jt:String(_n.nome||"").toLowerCase()===Wt,hn=(S.selectedClients||[]).some(er),In=Ve===ut;return a.jsxs("button",{ref:_n=>{or.current[Ve]=_n},type:"button",className:`w-full text-left py-3 px-4 flex items-center gap-3 transition-all border-b border-border last:border-0 ${In?"ring-2 ring-blue-500 ring-inset z-10":""} ${Ke?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":hn?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>qt(Ve),onMouseDown:_n=>{_n.stopPropagation()},role:"option","aria-checked":hn,onClick:()=>{const _n={id:jt,nome:wt,codigo:Mr},nn=[...Array.isArray(se.current)?se.current:[],_n];try{(se.current||[]).length===0&&(V.current=jt||null)}catch{}try{dr.current=!1}catch{}try{nn.length>0&&(ht.current=nn)}catch{}try{se.current=nn}catch{}Ja("list:add",nn),fr.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}},children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[Mr!=null&&a.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${Ke?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",Mr]}),a.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[a.jsx("span",{className:`font-medium truncate ${Ke?"text-amber-100/90":""}`,children:wt}),Ke&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),(()=>{const _n=(S.selectedClients||[]).filter(nn=>er(nn)).length;return _n>0?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:nn=>{nn.stopPropagation();const oa=Array.isArray(se.current)?se.current:[],ya=oa.findIndex(Pa=>er(Pa));if(ya!==-1){const Pa=[...oa];Pa.splice(ya,1);try{dr.current=Pa.length===0}catch{}try{Pa.length===0&&(V.current=null)}catch{}try{Pa.length>0&&(ht.current=Pa)}catch{}try{se.current=Pa}catch{}Ja("list:remove-one",Pa)}},children:"-"}),a.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:_n}),a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:nn=>{nn.stopPropagation();const oa={id:jt,nome:wt,codigo:Mr},ya=[...Array.isArray(se.current)?se.current:[],oa];try{(se.current||[]).length===0&&(V.current=jt||null)}catch{}try{dr.current=!1}catch{}try{ya.length>0&&(ht.current=ya)}catch{}try{se.current=ya}catch{}Ja("list:add-one",ya)},children:"+"})]}):null})()]},jt||Wt)})]}),a.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a.jsx(me,{type:"button",size:"sm",className:"bg-emerald-600 hover:bg-emerald-500 text-white shadow-md ring-2 ring-emerald-400/40 ring-offset-2 ring-offset-transparent",onMouseDown:we=>{try{Ft.current=Date.now()+3e3}catch{}try{st.current=Date.now()+3500}catch{}try{Ie.current=Date.now()+5e3}catch{}try{ye.current="close"}catch{}try{fr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{sessionStorage.setItem("agenda:customerPicker:closing","1"),sessionStorage.setItem("agenda:customerPicker:closingAt",String(Date.now()));const Ve=Xe.current||sessionStorage.getItem("agenda:modal:sessionId")||"";Ve&&sessionStorage.setItem("agenda:customerPicker:sessionId",Ve);const Ke=Array.isArray(se.current)?se.current:[];Ke.length>0&&sessionStorage.setItem(ln,JSON.stringify(Ke));try{const jt={ts:new Date().toISOString(),hook:"conclude:mousedown",modalSessionId:Ve,closingAt:sessionStorage.getItem("agenda:customerPicker:closingAt"),selLen:Array.isArray(Ke)?Ke.length:NaN,formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,lockUntil:st.current,suppressUntil:Ft.current,isPickerOpen:!!Ut,isModalOpen:!!te}}catch{}}catch{}we.stopPropagation()},onClick:()=>{ye.current="close",fr.current=!1;try{Ie.current=Date.now()+5e3}catch{}try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}Ct.current=!0;const Ve=Array.isArray(se.current)?[...se.current]:[];try{Ve.length>0&&(Qr.current="conclude:close:snapshot",ht.current=Ve,sessionStorage.setItem(ln,JSON.stringify(Ve)))}catch{}Gr(Ve);try{st.current=Date.now()+3e3}catch{}Ja("conclude:close:apply",Ve),G(Ke=>({...Ke,selectedClients:[...Ve]}));try{dr.current=!1}catch{}try{Ft.current=Date.now()+2500}catch{}Pe(!1),xe(!1),setTimeout(()=>{try{Ft.current=Date.now()+2500}catch{}Pe(!1),xe(!1)},15),setTimeout(()=>{try{Ft.current=Date.now()+2500}catch{}Pe(!1),xe(!1)},120),Qe?.id&&Aa.current&&(async()=>{try{Jr.current&&clearTimeout(Jr.current),console.log(" [CustomerPicker] Salvando participantes (Concluir)..."),await Ys({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(Ke){console.error(" [CustomerPicker] Erro ao salvar:",Ke)}})();try{Ft.current=Date.now()+2500}catch{}try{const Ke={ts:new Date().toISOString(),hook:"conclude:click",formLen:Array.isArray(S?.selectedClients)?S.selectedClients.length:NaN,curLen:Array.isArray(se.current)?se.current.length:NaN,lastLen:Array.isArray(ht.current)?ht.current.length:NaN,chipsLen:Array.isArray(wr)?wr.length:NaN,clientsLoading:!!xr,lastAction:Qr?.current,clearedByUser:!!dr?.current,suppressUntil:Ft.current,selectionLockUntil:st.current,restoreGuardUntil:Xr.current,modalSessionId:Xe.current||sessionStorage.getItem("agenda:modal:sessionId")||"",closingAt:sessionStorage.getItem("agenda:customerPicker:closingAt"),pickerOpen:!!Ut,modalOpen:!!te}}catch{}setTimeout(()=>{try{Ct.current=!1}catch{}},3e3)},children:"Concluir"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("span",{className:"text-xs text-text-muted",children:[(Il||[]).length," selecionado(s)"]})})]})]})})]}),a.jsx(me,{type:"button",onClick:()=>{try{const we=Array.isArray(se.current)?se.current:[];we.length>0&&(ht.current=we,sessionStorage.setItem(ln,JSON.stringify(we)),Gr(we),console.warn("[CustomerPicker][+Novo:save-selection]",{savedCount:we.length}))}catch{}fr.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}ye.current="close",Pe(!1),xe(!1),Cr(null),nr(!0)},children:"+ Novo"})]}),sc.length>0?a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:sc.map((we,Ve)=>{const Ke=String(we?.nome||"").toLowerCase(),jt=`${we?.id||Ke}-${Ve}`,wt=we?.id||`__name:${Ke}`;return a.jsxs("span",{className:"text-sm font-medium bg-white/5 border border-white/10 rounded px-2 py-1 flex items-center gap-2",children:[B9(we.nome),a.jsxs("button",{type:"button","aria-label":"Remover cliente",title:"Remover cliente",className:"text-text-muted hover:text-red-400 p-1 rounded hover:bg-red-500/10",onClick:()=>{j("CustomerPicker:chip:remove",{token:wt,chipIdx:Ve});const Mr=(Array.isArray(se.current)?se.current:[]).filter((Wt,er)=>er!==Ve);try{dr.current=Mr.length===0}catch{}try{ht.current=Mr,Mr.length===0&&(sessionStorage.removeItem(ln),console.warn("[CustomerPicker][chip:remove:cleared-all]",{ts:new Date().toISOString()}))}catch{}try{se.current=Mr}catch{}Ja("chips:remove",Mr)},children:[a.jsx(el,{className:"w-5 h-5"}),a.jsx("span",{className:"sr-only",children:"Remover"})]})]},jt)})}):null]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"quadra-select",className:"font-bold",children:"Quadra"}),a.jsxs(Nn,{value:S.court,onValueChange:we=>G(Ve=>({...Ve,court:we})),children:[a.jsx(bn,{className:"mt-1",onMouseDown:()=>{Ut&&setTimeout(lm,0)},children:a.jsx(Cn,{children:S.court&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:km(S.court)}}),a.jsx("span",{children:S.court})]})})}),a.jsx(wn,{className:"z-[60]",children:it.map(we=>{const Ve=ur(S.date,"yyyy-MM-dd"),Ke=Y[Ve]||{},jt=Ke[we]&&!Ke[we].funciona;return a.jsx(tt,{value:we,disabled:jt,className:jt?"opacity-50 cursor-not-allowed":"",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:km(we)}}),a.jsx("span",{children:we}),jt&&a.jsx("span",{className:"text-xs text-text-muted ml-auto",children:"(Fechada)"})]})},we)})})]})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"modalidade-select",className:"font-bold",children:"Modalidade"}),a.jsxs(Nn,{value:S.modality,onValueChange:we=>G(Ve=>({...Ve,modality:we})),children:[a.jsx(bn,{className:"mt-1",onMouseDown:()=>{Ut&&setTimeout(lm,0)},children:a.jsx(Cn,{})}),a.jsx(wn,{children:(X1||[]).map(we=>a.jsx(tt,{value:we,children:we},we))})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"status-select",className:"font-bold",children:"Status"}),a.jsxs(Nn,{value:S.status,onValueChange:we=>G(Ve=>({...Ve,status:we})),children:[a.jsx(bn,{className:"mt-1",onMouseDown:()=>{Ut&&setTimeout(lm,0)},children:a.jsx(Cn,{})}),a.jsx(wn,{children:Object.keys(ni).map(we=>a.jsx(tt,{value:we,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{"aria-hidden":!0,className:`inline-block h-4 w-1 rounded ${ni[we].accent}`}),ni[we].label]})},we))})]}),im&&a.jsx("div",{className:"mt-1.5 text-xs text-text-primary font-medium bg-brand/5 border border-brand/20 rounded px-2 py-1.5",children:im})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"horario-inicio",className:"font-bold",children:"Horrio"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsxs(Nn,{value:String(S.startMinutes),onValueChange:we=>G(Ve=>({...Ve,startMinutes:Number(we)})),children:[a.jsx(bn,{className:"w-32","aria-label":"Hora incio",onMouseDown:()=>{Ut&&setTimeout(lm,0)},children:a.jsx(Cn,{})}),a.jsx(wn,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:G1.map(we=>a.jsx(tt,{value:String(we.value),disabled:!we.available,className:gr(!we.available&&"opacity-60"),children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[we.available?a.jsx(yd,{className:"w-4 h-4 opacity-80"}):a.jsx(xx,{className:"w-4 h-4 opacity-80"}),we.label]})},we.value))})]}),a.jsxs(Nn,{value:String(S.endMinutes),onValueChange:we=>G(Ve=>({...Ve,endMinutes:Number(we)})),children:[a.jsx(bn,{className:"w-32","aria-label":"Hora fim",onMouseDown:()=>{Ut&&setTimeout(lm,0)},children:a.jsx(Cn,{})}),a.jsx(wn,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:K1.map(we=>a.jsx(tt,{value:String(we.value),disabled:!we.available,className:gr(!we.available&&"opacity-60"),children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[we.available?a.jsx(yd,{className:"w-4 h-4 opacity-80"}):a.jsx(xx,{className:"w-4 h-4 opacity-80"}),we.label]})},we.value))})]})]}),a.jsxs("div",{className:"mt-1 inline-block text-xs font-semibold text-text-secondary bg-white/5 border border-white/10 rounded px-2 py-0.5",children:["Durao: ",Y1]})]}),!Qe&&a.jsxs("div",{className:"border-t border-border pt-4 mt-4",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",id:"is-recorrente",checked:Te,onChange:we=>ne(we.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-brand focus:ring-brand"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"is-recorrente",className:"font-semibold text-text-primary cursor-pointer",children:"Agendamento Fixo (Recorrente)"}),a.jsx("p",{className:"text-xs text-text-secondary mt-0.5",children:"Criar este agendamento automaticamente nas prximas semanas, no mesmo dia e horrio"})]})]}),Te&&a.jsxs("div",{className:"ml-7 mt-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"quantidade-semanas",className:"text-sm font-medium",children:"Repetir por quantas semanas?"}),a.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[a.jsxs("div",{className:"flex items-center border border-border rounded-md bg-surface-2",children:[a.jsx("button",{type:"button",onClick:()=>Nt(we=>Math.max(2,(we||2)-1)),className:"px-3 py-2 hover:bg-surface-3 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:lt<=2,children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),a.jsx("div",{className:"px-4 py-2 min-w-[60px] text-center font-semibold border-x border-border",children:lt}),a.jsx("button",{type:"button",onClick:()=>Nt(we=>(we||2)+1),className:"px-3 py-2 hover:bg-surface-3 transition-colors",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),a.jsxs("span",{className:"text-sm text-text-secondary",children:["semanas (",lt," agendamentos)"]})]})]}),S.date&&lt>=2&&a.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[a.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:"Datas que sero criadas:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:lt}).map((we,Ve)=>{const Ke=La(S.date,Ve*7);return a.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-slate-700/50 border border-slate-600 rounded px-2 py-1",children:[a.jsx("svg",{className:"w-3.5 h-3.5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("span",{className:"text-xs font-medium text-white",children:ur(Ke,"dd/MM/yyyy '('EEEE')'",{locale:la})})]},Ve)})})]}),a.jsx("div",{className:"bg-slate-800/50 border-l-4 border-blue-600 rounded-r-lg p-3",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"text-xs text-gray-300",children:[a.jsx("p",{className:"font-semibold mb-1 text-blue-300",children:"Importante: Revise os dados antes de salvar"}),a.jsxs("p",{children:["Sero criados ",a.jsxs("strong",{className:"text-white",children:[lt," agendamentos"]})," incluindo a data selecionada e as prximas ",lt-1," semanas. Editar ou cancelar depois exigir alterar cada agendamento individualmente."]})]})]})})]})]})]})]})}),a.jsx(ra,{className:"flex-shrink-0 border-t border-border bg-surface px-6 py-3",children:a.jsxs("div",{className:"w-full flex flex-col gap-3 sm:flex-row sm:items-center",children:[Qe&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:mr-auto w-full sm:w-auto",children:[a.jsxs(me,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white border border-red-700 w-full sm:w-auto justify-center",onClick:()=>hr(!0),children:[a.jsx(Bp,{className:"w-4 h-4 mr-2 opacity-90"}),"Cancelar agendamento",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-red-700/50 rounded border border-red-500/30",children:"F3"})]}),a.jsxs(me,{type:"button",variant:"secondary",className:"bg-teal-600 hover:bg-teal-500 text-white border-teal-700 w-full sm:w-auto justify-center",onClick:()=>{o()},children:[a.jsx(Ko,{className:"w-4 h-4 mr-2 opacity-90"}),a.jsx("span",{className:"hidden sm:inline",children:"Gerenciar Pagamentos"}),a.jsx("span",{className:"sm:hidden",children:"Pagamentos"}),a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-teal-700/50 rounded border border-teal-500/30",children:"F4"})]})]}),a.jsx(Qd,{open:rn,onOpenChange:hr,children:a.jsxs(ad,{children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Cancelar agendamento?"}),a.jsx(ld,{children:'Ao cancelar, este agendamento deixar de aparecer na agenda padro. Ele s ser visvel ao selecionar o filtro "Cancelados".'})]}),a.jsxs(od,{children:[a.jsx(cd,{children:"Voltar"}),a.jsx(Zd,{className:"bg-red-600 hover:bg-red-500",onClick:async()=>{try{hr(!1),ue(!1),await kn(Qe.id,"canceled","user"),t({title:"Agendamento cancelado"})}catch(we){t({title:"Erro ao cancelar",description:we?.message||"Tente novamente."})}},children:"Confirmar cancelamento"})]})]})})]}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[a.jsxs(me,{type:"button",variant:"ghost",className:"border border-white/10 flex-1 sm:flex-none",onClick:async()=>{if(Qe?.id){console.log(" [Auto-save] Salvando ao fechar modal...");try{Jr.current&&clearTimeout(Jr.current),await Ys({autoSave:!0}),console.log(" [Auto-save] Salvo ao fechar!")}catch(we){console.error(" [Auto-save] Erro ao salvar ao fechar:",we)}}ue(!1)},children:["Fechar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),!Qe?.id&&a.jsxs(me,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white disabled:opacity-60 disabled:cursor-not-allowed flex-1 sm:flex-none",disabled:tn,onClick:async()=>{try{if(tn)return;if(Te&&!Qe){gt(!0);return}io.current=!0,ei.current=!1,await Ys()}catch{}},children:["Salvar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})})]})}),a.jsx(Qd,{open:at,onOpenChange:gt,children:a.jsxs(ad,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(sd,{children:[a.jsxs(id,{className:"flex items-center gap-3 text-xl",children:[a.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-orange-600/20 border border-orange-600/40",children:a.jsx("svg",{className:"w-6 h-6 text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),"Confirmar Criao de Agendamentos Recorrentes"]}),a.jsxs(ld,{className:"space-y-4 mt-4",children:[S.date&&lt>=2&&a.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[a.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:" Datas que sero criadas:"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:Array.from({length:lt}).map((we,Ve)=>{const Ke=La(S.date,Ve*7);return a.jsxs("div",{className:"flex items-center gap-2 bg-slate-700/50 border border-slate-600 rounded px-2 py-1.5",children:[a.jsxs("span",{className:"text-xs font-semibold text-slate-400",children:["#",Ve+1]}),a.jsx("span",{className:"text-xs font-medium text-white",children:ur(Ke,"dd/MM/yyyy '('EEEE')'",{locale:la})})]},Ve)})})]}),a.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-3 uppercase tracking-wide",children:"Resumo do Agendamento"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Quadra"}),a.jsx("span",{className:"font-semibold text-white",children:xt[S.court]?.name||S.court})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Horrio"}),a.jsxs("span",{className:"font-semibold text-white font-mono",children:[z9(S.startMinutes)," - ",z9(S.endMinutes)]})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Modalidade"}),a.jsx("span",{className:"font-semibold text-white",children:S.modality})]}),a.jsxs("div",{className:"flex items-start justify-between py-2",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Participantes"}),a.jsx("div",{className:"text-right max-w-xs",children:S.selectedClients?.length>0?a.jsxs("div",{className:"font-semibold text-white",children:[Pt?S.selectedClients.map(we=>we.nome).join(", "):S.selectedClients.slice(0,3).map(we=>we.nome).join(", "),!Pt&&S.selectedClients.length>3&&a.jsxs("span",{className:"text-slate-400",children:[" +",S.selectedClients.length-3]}),S.selectedClients.length>3&&a.jsxs(a.Fragment,{children:[" ",a.jsx("button",{type:"button",onClick:()=>yt(!Pt),className:"text-xs text-blue-400 hover:text-blue-300 underline inline",children:Pt?"Ver menos":"Ver todos"})]})]}):a.jsx("span",{className:"font-semibold text-white",children:"Nenhum participante"})})]})]})]}),a.jsx("div",{className:"bg-red-900/30 border-l-4 border-red-600 rounded-r-lg p-4",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"w-5 h-5 text-red-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsx("div",{children:a.jsxs("p",{className:"text-sm text-gray-300",children:[a.jsx("strong",{className:"text-red-300",children:"Importante:"})," Aps criar, editar ou cancelar exigir alterar cada agendamento individualmente. Certifique-se de que todos os dados esto corretos!"]})})]})})]})]}),a.jsxs(od,{className:"gap-2",children:[a.jsx(cd,{onClick:()=>{gt(!1),yt(!1)},className:"border-slate-600 hover:bg-slate-800",children:"Cancelar e Revisar"}),a.jsxs(Zd,{className:"bg-emerald-700 hover:bg-emerald-600 text-white font-semibold",onClick:async()=>{gt(!1),yt(!1),io.current=!0,ei.current=!1,await Ys()},children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Confirmar e Criar ",lt," Agendamentos"]})]})]})}),_r&&a.jsx(Vre,{open:_r,onOpenChange:we=>{nr(we),we||(Cr(null),window.__paymentModalCallback&&(window.__paymentModalCallback=null))},client:Wr,onSaved:we=>{try{if(we&&typeof we=="object"){console.warn("[CustomerPicker][onSaved:START]",{clientId:we.id,clientName:we.nome,currentSelection:Array.isArray(se.current)?se.current.length:0});try{Ie.current=Date.now()+3e3,st.current=Date.now()+3e3,Xr.current=Date.now()+3e3}catch{}(Ws||[]).some(Ke=>typeof Ke=="object"?Ke.id===we.id:!1)||(ac(Ke=>[...Ke||[],we]),mn(Ke=>[...Ke||[],we])),G(Ke=>{const jt=Array.isArray(Ke.selectedClients)?Ke.selectedClients:[],wt={id:we.id,nome:we.nome||we.name||Gt(we),codigo:we.codigo},Mr=jt.filter(er=>er.id!==we.id),Wt=[wt,...Mr];try{se.current=Wt}catch{}try{ht.current=Wt}catch{}try{Gr(Wt)}catch{}try{sessionStorage.setItem(ln,JSON.stringify(Wt))}catch{}try{dr.current=!1}catch{}return console.warn("[CustomerPicker][onSaved:COMPLETE]",{newClientId:we.id,newClientName:we.nome,totalSelected:Wt.length,refsSynced:!0,protectionActive:!0}),{...Ke,selectedClients:Wt}}),Promise.resolve().then(()=>{try{const Ke=Array.isArray(se.current)?se.current:[];Ke.length>0&&(G(jt=>({...jt,selectedClients:[...Ke]})),console.warn("[CustomerPicker][onSaved:REASSERT]",{count:Ke.length}))}catch{}})}if(window.__paymentModalCallback&&typeof window.__paymentModalCallback=="function")try{window.__protectPaymentModal&&window.__protectPaymentModal(3e3),window.__paymentModalCallback(),window.__paymentModalCallback=null}catch(Ve){console.error("[PaymentModal][callback:ERROR]",Ve)}}catch(Ve){console.error("[CustomerPicker][onSaved:ERROR]",Ve)}}}),s&&a.jsx(ZQe,{setIsModalOpen:ue,setBookings:ie,form:S,setForm:G,localCustomers:Ws,onOpenClientModal:we=>{nr(!0),window.__paymentModalCallback=we}}),l&&a.jsx(eZe,{form:S,setForm:G,localCustomers:Ws})]})},Fo=p.useMemo(()=>{const Ie=ur(M,"yyyy-MM-dd");let Xe=le.filter(Vt=>ur(Vt.start,"yyyy-MM-dd")===Ie);if(!!!L){if(Xe=Xe.filter(Vt=>Vt.status!=="canceled"),Ht.trim()){const Vt=Ht.trim().toLowerCase();Xe=Xe.filter(Mt=>(Mt.customer||"").toLowerCase().includes(Vt)||(Mt.court||"").toLowerCase().includes(Vt)||(ni[Mt.status]?.label||"").toLowerCase().includes(Vt))}return Xe}let Gt=ke.canceledOnly?Xe.filter(Vt=>Vt.status==="canceled"):Xe.filter(Vt=>Vt.status!=="canceled");if(ke.pendingPayments&&(Gt=Gt.filter(Vt=>{const Mt=rt[Vt.id]||[];return Mt.some(G=>String(G.status_pagamento||"").toLowerCase()!=="pago")&&Mt.length>0})),Ht.trim()){const Vt=Ht.trim().toLowerCase();Gt=Gt.filter(Mt=>(Mt.customer||"").toLowerCase().includes(Vt)||(Mt.court||"").toLowerCase().includes(Vt)||(ni[Mt.status]?.label||"").toLowerCase().includes(Vt))}try{const Vt=Date.now(),Mt=(le||[]).filter(G=>ur(G.start,"yyyy-MM-dd")===Ie).filter(G=>G.status!=="canceled").filter(G=>{const se=On.current.get(G.id);return se&&se.src==="automation"&&Vt-se.ts<2e3}),S=new Map(Gt.map(G=>[G.id,G]));for(const G of Mt)S.has(G.id)||S.set(G.id,G);Gt=Array.from(S.values())}catch{}return Gt},[le,M,ke.scheduled,ke.canceledOnly,ke.pendingPayments,Ht,rt,L]),yi=p.useMemo(()=>{const Ie=ur(M,"yyyy-MM-dd"),Xe=Or||kt[0],rr=le.filter(Vt=>ur(Vt.start,"yyyy-MM-dd")===Ie&&Vt.status!=="canceled"&&Vt.court===Xe);let Gt=0;return rr.forEach(Vt=>{const S=(rt[Vt.id]||[]).filter(G=>String(G.status_pagamento||"").toLowerCase()!=="pago").length;Gt+=S}),{totalBookings:rr.length,totalPendingPayments:Gt}},[le,M,rt,Or,kt]),of=p.useMemo(()=>{const Ie=pp(M),Xe=La(Ie,6);let rr=le.filter(Mt=>{const S=Es(Mt.start),G=Es(Ie),se=Es(Xe);return S>=G&&S<=se});if(!!!L){if(rr=rr.filter(Mt=>Mt.status!=="canceled"),Ht.trim()){const Mt=Ht.trim().toLowerCase();rr=rr.filter(S=>(S.customer||"").toLowerCase().includes(Mt)||(S.court||"").toLowerCase().includes(Mt)||(ni[S.status]?.label||"").toLowerCase().includes(Mt))}return rr}let Vt=ke.canceledOnly?rr.filter(Mt=>Mt.status==="canceled"):rr.filter(Mt=>Mt.status!=="canceled");if(ke.pendingPayments&&(Vt=Vt.filter(Mt=>{const S=rt[Mt.id]||[];return S.some(se=>String(se.status_pagamento||"").toLowerCase()!=="pago")&&S.length>0})),Ht.trim()){const Mt=Ht.trim().toLowerCase();Vt=Vt.filter(S=>(S.customer||"").toLowerCase().includes(Mt)||(S.court||"").toLowerCase().includes(Mt)||(ni[S.status]?.label||"").toLowerCase().includes(Mt))}try{const Mt=Date.now(),S=(le||[]).filter(se=>{const Ae=Es(se.start);return Ae>=Es(Ie)&&Ae<=Es(Xe)}).filter(se=>se.status!=="canceled").filter(se=>{const Ae=On.current.get(se.id);return Ae&&Ae.src==="automation"&&Mt-Ae.ts<2e3}),G=new Map(Vt.map(se=>[se.id,se]));for(const se of S)G.has(se.id)||G.set(se.id,se);Vt=Array.from(G.values())}catch{}return Vt},[le,M,ke.scheduled,ke.canceledOnly,ke.pendingPayments,Ht,rt,L]);p.useEffect(()=>{if(!Ht.trim()||!(ke.scheduled||ke.canceledOnly||ke.pendingPayments)||!Fo||Fo.length===0)return;const Ie=[...Fo].sort((rr,Gt)=>rr.start-Gt.start)[0];if(!Ie?.id)return;const Xe=document.getElementById(`booking-${Ie.id}`);Xe?.scrollIntoView&&Xe.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},[Ht,Fo,ke.scheduled,ke.canceledOnly,ke.pendingPayments]),p.useEffect(()=>{const Ie=zn.current,Xe=ot.current||{},rr=ke.canceledOnly&&!Xe.canceledOnly,Gt=ke.scheduled&&!Xe.scheduled&&!ke.canceledOnly,Vt=ke.pendingPayments&&!Xe.pendingPayments;if(!Ie||!rr&&!Gt&&!Vt){ot.current={scheduled:ke.scheduled,canceledOnly:ke.canceledOnly,pendingPayments:ke.pendingPayments};return}const Mt=Fo||[];if(Mt.length===0){ot.current={scheduled:ke.scheduled,canceledOnly:ke.canceledOnly,pendingPayments:ke.pendingPayments};return}const S=Ie.getBoundingClientRect();if(!Mt.some(se=>{const Ae=document.getElementById(`booking-${se.id}`);if(!Ae)return!1;const V=Ae.getBoundingClientRect();return V.bottom>S.top&&V.top<S.bottom})){const se=[...Mt].sort((V,oe)=>V.start-oe.start)[0],Ae=se&&document.getElementById(`booking-${se.id}`);Ae?.scrollIntoView&&Ae.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}ot.current={scheduled:ke.scheduled,canceledOnly:ke.canceledOnly,pendingPayments:ke.pendingPayments}},[ke.scheduled,ke.canceledOnly,ke.pendingPayments,Fo]);const nl=p.useMemo(()=>{if(!Or||!xt[Or])return{start:Ms,end:ys};const Ie=xt[Or],Xe=Ie.hora_inicio||`${Ms}:00:00`,rr=Ie.hora_fim||`${ys}:00:00`,[Gt,Vt]=String(Xe).split(":").map(Number),[Mt,S]=String(rr).split(":").map(Number),G=Mt===0&&S===0?24:Mt,se=G*60+(S||0);return{start:Gt||Ms,end:G||ys,startMinutes:(Gt||0)*60+(Vt||0),endMinutes:se}},[Or,xt,Ms,ys]);return p.useMemo(()=>{const Ie=nl.start,Xe=nl.end;return Array.from({length:Math.max(0,Xe-Ie)},(rr,Gt)=>Ie+Gt)},[nl]),p.useMemo(()=>{const Ie=nl.start,Xe=nl.end;return Math.max(0,Xe-Ie)*(60/Oa)*Ai},[nl]),a.jsxs(a.Fragment,{children:[a.jsxs(jr.div,{variants:te?void 0:iZe,initial:te?!1:"hidden",animate:te?!1:"visible",className:gr("h-full w-full flex flex-col md:px-0",$&&"fixed inset-0 z-40 bg-surface"),children:[a.jsx(jr.div,{variants:q9,className:"p-3 bg-surface mb-6 md:rounded-lg",children:a.jsxs("div",{className:"max-w-[1200px] mx-auto w-full flex flex-col gap-3 md:flex-row md:items-center md:gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(me,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>U(z==="day"?Zy(M,1):Zy(M,7)),children:a.jsx(LH,{className:"h-5 w-5"})}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"ghost",className:"w-full sm:w-auto max-w-full justify-center text-base font-semibold whitespace-nowrap truncate",children:[a.jsx(Vs,{className:"mr-2 h-5 w-5"}),z==="day"?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:ur(M,"EEE, dd 'de' MMMM 'de' yyyy",{locale:la})}),a.jsx("span",{className:"sm:hidden",children:ur(M,"EEE, dd/MM/yyyy",{locale:la})})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:oZe(M)}),a.jsxs("span",{className:"sm:hidden",children:[ur(pp(M),"dd/MM/yyyy")," - ",ur(La(pp(M),6),"dd/MM/yyyy")]})]})]})}),a.jsx(Jo,{className:"w-auto p-0",children:a.jsx(ui,{mode:"single",selected:M,onSelect:Ie=>Ie&&U(Ie),initialFocus:!0})})]}),a.jsx(me,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>U(z==="day"?La(M,1):La(M,7)),children:a.jsx(c0,{className:"h-5 w-5"})})]}),kt.length>0&&a.jsx("div",{className:"hidden md:flex md:justify-center md:flex-1",children:kt.length===1?a.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:km(kt[0])}}),a.jsx("span",{className:"font-semibold text-sm",children:kt[0]})]}):a.jsxs(Nn,{value:Or||kt[0],onValueChange:Ie=>{Lr(Ie)},children:[a.jsx(bn,{className:"w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:a.jsx(Cn,{placeholder:"Selecionar quadra"})}),a.jsx(wn,{className:"border-brand/30",children:kt.map(Ie=>{const Xe=km(Ie);return a.jsx(tt,{value:Ie,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:Xe}}),a.jsx("span",{className:"font-semibold",children:Ie})]})},Ie)})})]})}),a.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto md:ml-auto",children:[a.jsxs("div",{className:"flex items-center gap-3 justify-center md:hidden",children:[a.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[a.jsx(me,{variant:z==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>W("day"),children:"Dia"}),a.jsx(me,{variant:z==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>W("week"),children:"Semana"})]}),a.jsxs(lb,{children:[a.jsx(cb,{asChild:!0,children:a.jsxs(me,{variant:"outline",size:"sm",className:"gap-2",disabled:it.length===0,children:[a.jsx(DF,{className:"h-4 w-4"})," Filtros"]})}),a.jsxs(sx,{align:"end",className:"w-64",children:[a.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[a.jsx(wT,{className:"p-0",children:"Exibio"}),a.jsx(me,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>Ge({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),a.jsx(Qj,{}),a.jsx(gl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Vs,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Agendados"})]}),a.jsx(Ha,{checked:ke.scheduled,onCheckedChange:Ie=>Ge(Xe=>({...Xe,scheduled:!!Ie,canceledOnly:Ie?!1:Xe.canceledOnly}))})]})}),a.jsx(gl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nI,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Livres"})]}),a.jsx(Ha,{checked:ke.available,onCheckedChange:Ie=>Ge(Xe=>({...Xe,available:!!Ie,canceledOnly:Ie?!1:Xe.canceledOnly}))})]})}),a.jsx(gl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Bp,{className:"h-4 w-4 text-rose-400"}),a.jsx("span",{children:"Cancelados"})]}),a.jsx(Ha,{checked:ke.canceledOnly,onCheckedChange:Ie=>{const Xe=!!Ie;Ge(rr=>({...rr,canceledOnly:Xe,scheduled:Xe?!1:rr.scheduled,available:Xe?!1:rr.available})),Xe&&!Dr&&Tt(!0)}})]})}),a.jsx(gl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ko,{className:"h-4 w-4 text-warning"}),a.jsx("span",{children:"Pagamentos Pendentes"})]}),a.jsx(Ha,{checked:ke.pendingPayments,onCheckedChange:Ie=>Ge(Xe=>({...Xe,pendingPayments:!!Ie}))})]})})]})]}),a.jsxs("div",{className:"relative inline-block group",children:[a.jsx(me,{variant:$?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ee(!$),"aria-label":$?"Minimizar grid":"Expandir grid",children:$?a.jsx(kF,{className:"h-4 w-4"}):a.jsx(EF,{className:"h-4 w-4"})}),a.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:a.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:$?"Minimizar (F10)":"Expandir (F10)"})})]}),a.jsx(me,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>zr(!0),disabled:it.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:a.jsx(bd,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"flex items-center gap-3 justify-end flex-shrink-0",children:[a.jsxs("div",{className:"relative w-full sm:w-56",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar agendamento...",className:"pl-9",value:Ht,onChange:Ie=>Ot(Ie.target.value),onBlur:()=>Ot("")}),Ht&&a.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 px-2 py-0.5 rounded text-xs font-medium text-primary hover:bg-surface-2",onClick:()=>Ot(""),children:"Limpar"})]}),a.jsxs(me,{size:"sm",onClick:()=>{ge(null),Yt(null);try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}Pn()},"aria-label":"Novo agendamento",className:"gap-2",disabled:it.length===0||kt.every(Ie=>ve[Ie]&&!ve[Ie].funciona),children:[a.jsx(ns,{className:"h-4 w-4"})," Agendar"]})]}),kt.length>0&&a.jsx("div",{className:"md:hidden flex justify-center",children:kt.length===1?a.jsxs("div",{className:"inline-flex items-center justify-center gap-3 px-4 py-2 rounded-lg w-auto h-10 max-w-full border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:km(kt[0])}}),a.jsx("span",{className:"font-semibold text-sm text-center whitespace-nowrap truncate",children:kt[0]})]}):a.jsxs(Nn,{value:kt[sr%kt.length],onValueChange:Ie=>{const Xe=kt.indexOf(Ie);Xe!==-1&&fn(Xe)},children:[a.jsx(bn,{className:"w-48 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:a.jsx(Cn,{placeholder:"Selecionar quadra"})}),a.jsx(wn,{className:"border-brand/30",children:kt.map(Ie=>{const Xe=km(Ie);return a.jsx(tt,{value:Ie,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:Xe}}),a.jsx("span",{className:"font-semibold",children:Ie})]})},Ie)})})]})}),a.jsxs("div",{className:"hidden md:flex items-center gap-3 justify-end",children:[a.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[a.jsx(me,{variant:z==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>W("day"),children:"Dia"}),a.jsx(me,{variant:z==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>W("week"),children:"Semana"})]}),a.jsxs(lb,{children:[a.jsx(cb,{asChild:!0,children:a.jsxs(me,{variant:"outline",size:"sm",className:"gap-2",disabled:it.length===0,children:[a.jsx(DF,{className:"h-4 w-4"})," Filtros"]})}),a.jsxs(sx,{align:"end",className:"w-64",children:[a.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[a.jsx(wT,{className:"p-0",children:"Exibio"}),a.jsx(me,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>Ge({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),a.jsx(Qj,{}),a.jsx(gl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Vs,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Agendados"})]}),a.jsx(Ha,{checked:ke.scheduled,onCheckedChange:Ie=>Ge(Xe=>({...Xe,scheduled:!!Ie,canceledOnly:Ie?!1:Xe.canceledOnly}))})]})}),a.jsx(gl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nI,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Livres"})]}),a.jsx(Ha,{checked:ke.available,onCheckedChange:Ie=>Ge(Xe=>({...Xe,available:!!Ie,canceledOnly:Ie?!1:Xe.canceledOnly}))})]})}),a.jsx(gl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Bp,{className:"h-4 w-4 text-rose-400"}),a.jsx("span",{children:"Cancelados"})]}),a.jsx(Ha,{checked:ke.canceledOnly,onCheckedChange:Ie=>{const Xe=!!Ie;Ge(rr=>({...rr,canceledOnly:Xe,scheduled:Xe?!1:rr.scheduled,available:Xe?!1:rr.available})),Xe&&!Dr&&Tt(!0)}})]})}),a.jsx(gl,{onClick:Ie=>Ie.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ko,{className:"h-4 w-4 text-warning"}),a.jsx("span",{children:"Pagamentos Pendentes"})]}),a.jsx(Ha,{checked:ke.pendingPayments,onCheckedChange:Ie=>Ge(Xe=>({...Xe,pendingPayments:!!Ie}))})]})})]})]}),a.jsxs("div",{className:"relative inline-block group",children:[a.jsx(me,{variant:$?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ee(!$),"aria-label":$?"Minimizar grid":"Expandir grid",children:$?a.jsx(kF,{className:"h-4 w-4"}):a.jsx(EF,{className:"h-4 w-4"})}),a.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:a.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:$?"Minimizar (F10)":"Expandir (F10)"})})]}),a.jsx(me,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>zr(!0),disabled:it.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:a.jsx(bd,{className:"h-5 w-5"})})]})]})]})}),a.jsx(xn,{open:Fr,onOpenChange:Ie=>{Ie||ae(Me),zr(Ie)},children:a.jsxs(vn,{className:"sm:max-w-[680px]",onOpenAutoFocus:Ie=>Ie.preventDefault(),children:[a.jsx(pn,{className:"pb-3 border-b border-border bg-surface-2/40 rounded-t-lg px-2 -mx-2 -mt-2",children:a.jsx(un,{className:"text-base font-semibold tracking-tight",children:"Configuraes da Agenda"})}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[a.jsx(Do,{className:"h-4 w-4",style:{color:ni.confirmed.hex}}),a.jsx("span",{className:"text-sm font-medium",children:"Confirmao automtica"})]}),a.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-3",style:{borderLeftWidth:3,borderLeftColor:ni.confirmed.hex},children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"autoConfirmEnabled",checked:En.autoConfirmEnabled,onCheckedChange:Ie=>ae(Xe=>({...Xe,autoConfirmEnabled:!!Ie}))}),a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:ni.confirmed.hex}}),a.jsx(Le,{htmlFor:"autoConfirmEnabled",className:"font-medium",children:"Confirmao automtica"})]})]})}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Le,{htmlFor:"autoconfirm-hours",className:"text-sm text-text-muted",children:"Confirmar se faltar"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Nn,{value:String(Math.max(0,Math.round((En.autoConfirmMinutesBefore||0)/60))),onValueChange:Ie=>ae(Xe=>({...Xe,autoConfirmMinutesBefore:Math.max(0,Number(Ie))*60})),disabled:!En.autoConfirmEnabled,children:[a.jsx(bn,{className:"w-32",children:a.jsx(Cn,{placeholder:"Horas"})}),a.jsxs(wn,{align:"start",children:[a.jsx(tt,{value:"0",children:"Imediato"}),a.jsx(tt,{value:"1",children:"1 h"}),a.jsx(tt,{value:"2",children:"2 h"}),a.jsx(tt,{value:"3",children:"3 h"}),a.jsx(tt,{value:"4",children:"4 h"}),a.jsx(tt,{value:"6",children:"6 h"}),a.jsx(tt,{value:"8",children:"8 h"}),a.jsx(tt,{value:"12",children:"12 h"}),a.jsx(tt,{value:"24",children:"24 h"})]})]}),a.jsx("span",{className:"text-sm text-text-muted",children:"antes"})]})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[a.jsx(zH,{className:"h-4 w-4",style:{color:ni.in_progress.hex}}),a.jsx("span",{className:"text-sm font-medium",children:"Transies automticas"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:ni.in_progress.hex},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"autoStartEnabled",checked:En.autoStartEnabled,onCheckedChange:Ie=>ae(Xe=>({...Xe,autoStartEnabled:!!Ie}))}),a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:ni.in_progress.hex}}),a.jsx(Le,{htmlFor:"autoStartEnabled",className:"font-medium",children:"Iniciar no horrio"})]})]}),a.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Confirmado  Em andamento no horrio de incio."})]}),a.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:ni.finished.hex},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"autoFinishEnabled",checked:En.autoFinishEnabled,onCheckedChange:Ie=>ae(Xe=>({...Xe,autoFinishEnabled:!!Ie}))}),a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:ni.finished.hex}}),a.jsx(Le,{htmlFor:"autoFinishEnabled",className:"font-medium",children:"Finalizar ao trmino"})]})]}),a.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Em andamento  Finalizado no horrio de trmino."})]})]})]})]}),a.jsxs(ra,{className:"mt-2 gap-2",children:[a.jsx(me,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>zr(!1),children:"Cancelar"}),a.jsx(me,{type:"button",variant:"default",onClick:()=>{console.log(" BOTO SALVAR CLICADO!"),Xn()},disabled:re,children:re?"Salvando":"Salvar"})]})]})}),a.jsx(xn,{open:vt,onOpenChange:Tt,children:a.jsxs(vn,{className:"sm:max-w-[520px]",onOpenAutoFocus:Ie=>Ie.preventDefault(),children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Sobre agendamentos cancelados"}),a.jsx(Dn,{children:"Agendamentos cancelados no aparecem na agenda quando o filtro no est selecionado e no ocupam horrio."})]}),a.jsxs("div",{className:"flex items-start gap-3 mt-2",children:[a.jsx(Ha,{id:"hide-canceled-info",checked:Dr,onCheckedChange:Ie=>an(!!Ie),className:"mt-0.5"}),a.jsx(Le,{htmlFor:"hide-canceled-info",className:"text-sm cursor-pointer text-text-secondary",children:"No mostrar novamente"})]}),a.jsx(ra,{className:"mt-4",children:a.jsx(me,{type:"button",onClick:()=>Tt(!1),children:"Entendi"})})]})}),!Qt&&it.length===0&&a.jsxs("div",{className:"mb-4 p-4 rounded-lg border border-border bg-surface text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Nenhuma quadra encontrada"}),a.jsx("div",{className:"text-text-muted",children:"Cadastre suas quadras para comear a usar a agenda."})]}),a.jsx(me,{asChild:!0,className:"w-full sm:w-auto",children:a.jsxs(s4,{to:"/quadras",children:[a.jsx("span",{className:"hidden sm:inline",children:"Ir para Cadastros  Quadras"}),a.jsx("span",{className:"sm:hidden",children:"Adicionar"})]})})]}),kt.length>0&&z==="week"&&(()=>{const Ie=Or||kt[0],Xe=L?of.filter(rr=>{const Gt=rr.court===Ie,Vt=xt?.[Ie]||{},Mt=String(Vt.id||Vt.codigo||""),S=Mt&&String(rr.court_id||"")===Mt;return Gt||S}):of;return a.jsx(a.Fragment,{children:a.jsx(aZe,{weekStart:pp(M),weekBookings:Xe,activeCourtFilter:Ie,courtsMap:xt,participantsByAgendamento:rt,onBookingClick:rr=>{ge(rr),ue(!0)},onSlotClick:(rr,Gt)=>{ge(null);const Vt=rr.getHours()*60+rr.getMinutes(),Mt=Gt||Or||kt[0],S=ur(rr,"yyyy-MM-dd"),G=(()=>{try{return(le||[]).filter(Pe=>Pe.court===Mt&&ur(Pe.start,"yyyy-MM-dd")===S&&Pe.status!=="canceled").map(Pe=>ju(Pe.start)*60+_u(Pe.start)).filter(Pe=>Pe>Vt).sort((Pe,qe)=>Pe-qe)[0]}catch{}})(),se=(()=>{const Pe=xt[Mt]?.hora_fim;if(!Pe)return ys*60;const[qe,He]=String(Pe).split(":").map(Number);return(qe===0&&(He||0)===0?24:qe)*60+(He||0)})(),Ae=typeof G=="number"?G:se;let V=Math.min(Vt+60,Ae);V-Vt<30&&(Ae-30>=Vt?V=Ae:V=Math.min(se,Vt+30));const oe={date:Es(rr),court:Mt,startMinutes:Vt,endMinutes:V};console.log("onSlotClick in AgendaPage - BEFORE setPrefill",{slotDate:rr,court:Gt,activeCourtFilter:Or,selectedCourts:kt,startMinutes:Vt,endMinutes:V,prefillData:oe}),Yt(oe),console.log("onSlotClick in AgendaPage - AFTER setPrefill (state not updated yet)");try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}Pn()},statusConfig:ni,dayStartHour:Ms,dayEndHourExclusive:ys,weekDiasFuncionamento:Y,sidebarVisible:e},`weekly-${Ie}`)})})(),kt.length>0&&z==="day"&&(()=>{const Ie=typeof window<"u"&&window.innerWidth<768,Xe=Ie?[kt[sr%kt.length]]:Or?[Or]:kt,rr=Ie?Xe[0]:Or,Gt=(()=>{if(rr&&xt[rr]){const S=xt[rr],G=S.hora_inicio||`${Ms}:00:00`,se=S.hora_fim||`${ys}:00:00`,[Ae]=String(G).split(":").map(Number),[V,oe]=String(se).split(":").map(Number);let Pe=V===0&&oe===0?24:V;return oe>0&&Pe<24&&(Pe+=1),{start:Ae||Ms,end:Pe||ys}}return{start:Ms,end:ys}})(),Vt=Array.from({length:Math.max(0,Gt.end-Gt.start)},(S,G)=>Gt.start+G),Mt=Math.max(0,Gt.end-Gt.start)*(60/Oa)*Ai;return Xe.some(S=>ve[S]&&!ve[S].funciona),a.jsx(a.Fragment,{children:a.jsx(jr.div,{variants:te?void 0:q9,className:gr("bg-surface fx-scroll","overflow-auto",Ie?"":"rounded-lg border border-border"),ref:zn,style:{flex:"1 1 auto",minWidth:0},children:a.jsxs("div",{className:gr("grid",!Ie&&"mx-auto"),style:{gridTemplateColumns:Ie?"60px 1fr":Xe.length===1?"120px 760px":Xe.length===2?"120px repeat(2, 520px)":`120px repeat(${Xe.length}, 1fr)`,width:Ie?"100%":Xe.length<=2?"fit-content":void 0,columnGap:Ie?"4px":"16px"},children:[a.jsxs("div",{className:"sticky left-0 bg-surface z-20",children:[a.jsx("div",{className:"sticky top-0 z-20 h-14 border-b border-r border-border bg-surface flex items-center justify-center px-2",children:a.jsxs(lb,{children:[a.jsx(cb,{asChild:!0,children:a.jsx(me,{size:"sm",variant:"ghost",className:"hover:bg-surface-2/50 text-lg font-semibold",children:Zi(M,new Date)?"Hoje":ur(M,"EEEE",{locale:la})})}),a.jsxs(sx,{align:"center",children:[a.jsx(gl,{onClick:()=>U(new Date),children:"Hoje"}),a.jsx(Qj,{}),(()=>{const S=["Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],G=Cd(M,{weekStartsOn:1,locale:la});return S.map((se,Ae)=>a.jsx(gl,{onClick:()=>U(La(G,Ae)),children:se},se))})()]})]})}),Vt.map(S=>a.jsxs("div",{className:gr("border-r border-border",S%2===1&&"bg-surface-2/30"),children:[a.jsx("div",{className:"relative border-b border-border/80",style:{height:Ai},children:a.jsxs("span",{className:gr("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",Ie?"px-1 text-sm":"px-2 text-lg"),children:[String(S).padStart(2,"0"),":00"]})}),a.jsx("div",{className:"relative border-b border-border/80",style:{height:Ai},children:a.jsxs("span",{className:gr("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",Ie?"px-1 text-sm":"px-2 text-lg"),children:[String(S).padStart(2,"0"),":30"]})})]},`time-${S}`))]}),Xe.map((S,G)=>a.jsxs("div",{className:"relative border-r border-border",children:[a.jsx("div",{className:"h-14 border-b border-border sticky top-0 bg-surface z-10 flex items-center justify-center",children:G===0&&a.jsxs("div",{className:"flex items-center justify-center gap-4 px-3",children:[yi.totalBookings>0&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[a.jsx("span",{className:"text-lg",children:""}),a.jsx("span",{className:"font-bold text-text-primary",children:yi.totalBookings}),a.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["agendamento",yi.totalBookings!==1?"s":""]})]}),yi.totalPendingPayments>0&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[a.jsx("span",{className:"text-lg",children:""}),a.jsx("span",{className:"font-bold text-text-primary",children:yi.totalPendingPayments}),a.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["pendente",yi.totalPendingPayments!==1?"s":""]})]}),Z&&a.jsxs("button",{type:"button",onClick:async()=>{const se=await ce(Z),Ae=Z.replace(/^https?:\/\//,"");try{navigator.vibrate&&navigator.vibrate(50)}catch{}if(se)if(typeof window<"u"&&window.innerWidth<640)try{alert(`Link copiado: ${Ae}`)}catch{}else t({title:"Link copiado",description:Ae});else t({title:"No foi possvel copiar",description:Ae,variant:"destructive"})},className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md text-xs border border-white/10 bg-surface/60 hover:bg-surface-2/70 hover:border-white/20 transition-colors","aria-label":"Copiar link de agendamento",title:"Copiar link de agendamento",children:[a.jsx(Oue,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"link Agendamento"}),a.jsx("span",{className:"sm:hidden",children:a.jsx(FH,{className:"w-4 h-4"})})]})]})}),a.jsxs("div",{className:gr("relative"),style:{height:Mt},children:[ve[S]&&!ve[S].funciona?(()=>Vt.map(se=>a.jsx("div",{className:"absolute w-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/30 transition-colors",style:{height:Ai*2,top:Vt.indexOf(se)*Ai*2},children:a.jsxs("div",{className:"text-center pointer-events-none",children:[a.jsx(l4,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),a.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),ve[S].observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:ve[S].observacao})]})},`closed-${S}-${se}`)))():null,(ke.scheduled||ke.canceledOnly||ke.pendingPayments)&&(()=>{const se=Gt.start*60,Ae=Gt.end*60,V=(()=>{const At=xt[S]?.hora_inicio,kr=xt[S]?.hora_fim,[_r,nr]=String(At||`${Gt.start}:00:00`).split(":").map(Number),[Wr,Cr]=String(kr||`${Gt.end}:00:00`).split(":").map(Number),Yr=Wr===0&&Cr===0?24:Wr||0;return{start:(_r||0)*60+(nr||0),end:Yr*60+(Cr||0)}})(),oe=Math.max(V.start,se),Pe=Math.min(V.end,Ae),qe=Math.max(0,Math.floor((oe-se)/Oa)),He=Math.max(qe,Math.ceil((Pe-se)/Oa)),Rt=Math.max(0,(Ae-se)/Oa),ut=qe*Ai,qt=Math.min(Rt,Math.max(0,He-qe)),Kt=Math.max(0,(Rt-He)*Ai);return a.jsxs(a.Fragment,{children:[ut>0&&a.jsx("div",{style:{height:ut}}),Array.from({length:qt},(At,kr)=>{const _r=qe+kr,Wr=(Math.floor(_r/(60/Oa))+Math.floor(se/60))%2===1;return a.jsx("div",{className:gr("border-b border-border/80",Wr&&"bg-surface-2/30"),style:{height:Ai}},`base-${S}-slot-${_r}`)}),Kt>0&&a.jsx("div",{style:{height:Kt}})]})})(),Fo.filter(se=>{if(!L)return!0;const Ae=se.court===S,V=xt?.[S]||{},oe=String(V.id||V.codigo||""),Pe=oe&&String(se.court_id||"")===oe;return Ae||Pe}).map(se=>a.jsx(sf,{booking:se,courtGridStart:Gt.start*60,courtGridEnd:Gt.end*60},se.id)),ke.available&&!(ve[S]&&!ve[S].funciona)&&(()=>{const se=(()=>{const ut=xt[S]?.hora_inicio;if(!ut)return Ms*60;const[qt,Kt]=String(ut).split(":").map(Number);return qt*60+(Kt||0)})(),Ae=(()=>{const ut=xt[S]?.hora_fim;if(!ut)return ys*60;const[qt,Kt]=String(ut).split(":").map(Number);return(qt===0&&Kt===0?24:qt)*60+(Kt||0)})(),V=ut=>{const qt=ju(ut),Kt=_u(ut);return qt===0&&Kt===0?1440:qt*60+Kt},oe=ur(M,"yyyy-MM-dd"),Pe=le.filter(ut=>ut.court===S&&ur(ut.start,"yyyy-MM-dd")===oe&&ut.status!=="canceled").map(ut=>[V(ut.start),V(ut.end)]).sort((ut,qt)=>ut[0]-qt[0]),qe=[];let He=se;for(const[ut,qt]of Pe)ut>He&&qe.push([He,ut]),He=Math.max(He,qt);He<Ae&&qe.push([He,Ae]);const Rt=({startM:ut,endM:qt})=>{const[Kt,At]=p.useState(null),kr=Gt.start*60,_r=Math.floor((ut-kr)/Oa),nr=Math.max(1,Math.ceil((qt-ut)/Oa)),Wr=_r+nr,Cr=_r*Ai-1,Yr=(Wr-_r)*Ai+2;let br=Math.floor(ut/60),ir=Math.floor(qt/60);br>=24&&(br=br%24),ir>=24&&(ir=ir%24);const ht=`${String(br).padStart(2,"0")}:${String(ut%60).padStart(2,"0")}`,Qr=`${String(ir).padStart(2,"0")}:${String(qt%60).padStart(2,"0")}`;return a.jsxs("div",{className:gr("absolute left-2 right-2 rounded-md border-2 border-dashed text-sm z-0 cursor-pointer","border-[#10B981]","bg-transparent hover:border-[#10B981]/80 hover:shadow-sm"),style:{top:`${Cr}px`,height:`${Yr}px`},onMouseMove:ln=>{const Ia=ln.currentTarget.getBoundingClientRect(),Ca=Math.min(Math.max(0,ln.clientY-Ia.top),Ia.height);let dr=Math.floor(Ca/Ai);dr=Math.max(0,Math.min(dr,nr-1)),At(dr)},onMouseLeave:()=>At(null),onClick:ln=>{const Ia=ln.currentTarget.getBoundingClientRect(),Ca=Math.min(Math.max(0,ln.clientY-Ia.top),Ia.height),dr=Math.floor(Ca/Ai);let wr=ut+dr*Oa;wr=Math.max(ut,Math.min(wr,qt-Oa));const Br=(()=>le.filter(or=>or.court===S&&ur(or.start,"yyyy-MM-dd")===oe).map(or=>ju(or.start)*60+_u(or.start)).filter(or=>or>wr).sort((or,rn)=>or-rn)[0])(),Gr=typeof Br=="number"?Br:Ae;let dn=Math.min(wr+60,Gr);if(dn-wr<30){const sn=Gr-30;sn>=ut?(wr=Math.max(ut,Math.min(wr,sn)),dn=Gr):(wr=ut,dn=Math.min(Gr,qt))}ge(null);{const sn=it||[],or=sn.includes(S)?S:sn[0]||"";Yt({court:or,date:M,startMinutes:wr,endMinutes:dn})}try{lastNonEmptySelectionRef.current=[],setChipsSnapshot([]),sessionStorage.removeItem(persistLastKey),sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}Pn()},title:`Livre: ${ht}${Qr}`,children:[Kt!==null&&a.jsx("div",{className:"pointer-events-none absolute left-[6px] right-[6px] rounded-md border border-white/10 bg-white/5",style:{top:`${Kt*Ai}px`,height:`${Ai}px`}}),a.jsxs("div",{className:"h-full px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"font-medium text-[#10B981]",children:"Livre"}),a.jsxs("span",{className:"text-text-muted",children:[ht,"",Qr]})]})]})};return qe.map(([ut,qt],Kt)=>a.jsx(Rt,{startM:ut,endM:qt},`free-${S}-${Kt}`))})()]})]},S))]})})})})()]}),bu()]})}function U9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function V9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U9(Object(r),!0).forEach(function(n){Y1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $l(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var W9=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),ME=function(){return Math.random().toString(36).substring(7).split("").join(".")},H9={INIT:"@@redux/INIT"+ME(),REPLACE:"@@redux/REPLACE"+ME(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ME()}};function cZe(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function uae(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error($l(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error($l(1));return r(uae)(e,t)}if(typeof e!="function")throw new Error($l(2));var s=e,o=t,i=[],l=i,c=!1;function d(){l===i&&(l=i.slice())}function u(){if(c)throw new Error($l(3));return o}function f(g){if(typeof g!="function")throw new Error($l(4));if(c)throw new Error($l(5));var y=!0;return d(),l.push(g),function(){if(y){if(c)throw new Error($l(6));y=!1,d();var b=l.indexOf(g);l.splice(b,1),i=null}}}function h(g){if(!cZe(g))throw new Error($l(7));if(typeof g.type>"u")throw new Error($l(8));if(c)throw new Error($l(9));try{c=!0,o=s(o,g)}finally{c=!1}for(var y=i=l,x=0;x<y.length;x++){var b=y[x];b()}return g}function m(g){if(typeof g!="function")throw new Error($l(10));s=g,h({type:H9.REPLACE})}function v(){var g,y=f;return g={subscribe:function(b){if(typeof b!="object"||b===null)throw new Error($l(11));function w(){b.next&&b.next(u())}w();var j=y(w);return{unsubscribe:j}}},g[W9]=function(){return this},g}return h({type:H9.INIT}),n={dispatch:h,subscribe:f,getState:u,replaceReducer:m},n[W9]=v,n}function G9(e,t){return function(){return t(e.apply(this,arguments))}}function K9(e,t){if(typeof e=="function")return G9(e,t);if(typeof e!="object"||e===null)throw new Error($l(16));var r={};for(var n in e){var s=e[n];typeof s=="function"&&(r[n]=G9(s,t))}return r}function fae(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,s){return function(){return n(s.apply(void 0,arguments))}})}function dZe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var s=n.apply(void 0,arguments),o=function(){throw new Error($l(15))},i={getState:s.getState,dispatch:function(){return o.apply(void 0,arguments)}},l=t.map(function(c){return c(i)});return o=fae.apply(void 0,l)(s.dispatch),V9(V9({},s),{},{dispatch:o})}}}var mae=Se.createContext(null);function uZe(e){e()}var hae=uZe,fZe=function(t){return hae=t},mZe=function(){return hae};function hZe(){var e=mZe(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var s=t;s;)s.callback(),s=s.next})},get:function(){for(var s=[],o=t;o;)s.push(o),o=o.next;return s},subscribe:function(s){var o=!0,i=r={callback:s,next:null,prev:r};return i.prev?i.prev.next=i:t=i,function(){!o||t===null||(o=!1,i.next?i.next.prev=i.prev:r=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var X9={notify:function(){},get:function(){return[]}};function pae(e,t){var r,n=X9;function s(f){return c(),n.subscribe(f)}function o(){n.notify()}function i(){u.onStateChange&&u.onStateChange()}function l(){return!!r}function c(){r||(r=t?t.addNestedSub(i):e.subscribe(i),n=hZe())}function d(){r&&(r(),r=void 0,n.clear(),n=X9)}var u={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:i,isSubscribed:l,trySubscribe:c,tryUnsubscribe:d,getListeners:function(){return n}};return u}var gae=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect;function pZe(e){var t=e.store,r=e.context,n=e.children,s=p.useMemo(function(){var l=pae(t);return{store:t,subscription:l}},[t]),o=p.useMemo(function(){return t.getState()},[t]);gae(function(){var l=s.subscription;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==t.getState()&&l.notifyNestedSubs(),function(){l.tryUnsubscribe(),l.onStateChange=null}},[s,o]);var i=r||mae;return Se.createElement(i.Provider,{value:s},n)}var vae={exports:{}},ms={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gi=typeof Symbol=="function"&&Symbol.for,rR=gi?Symbol.for("react.element"):60103,nR=gi?Symbol.for("react.portal"):60106,$5=gi?Symbol.for("react.fragment"):60107,B5=gi?Symbol.for("react.strict_mode"):60108,q5=gi?Symbol.for("react.profiler"):60114,z5=gi?Symbol.for("react.provider"):60109,U5=gi?Symbol.for("react.context"):60110,aR=gi?Symbol.for("react.async_mode"):60111,V5=gi?Symbol.for("react.concurrent_mode"):60111,W5=gi?Symbol.for("react.forward_ref"):60112,H5=gi?Symbol.for("react.suspense"):60113,gZe=gi?Symbol.for("react.suspense_list"):60120,G5=gi?Symbol.for("react.memo"):60115,K5=gi?Symbol.for("react.lazy"):60116,vZe=gi?Symbol.for("react.block"):60121,xZe=gi?Symbol.for("react.fundamental"):60117,yZe=gi?Symbol.for("react.responder"):60118,bZe=gi?Symbol.for("react.scope"):60119;function zc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case rR:switch(e=e.type,e){case aR:case V5:case $5:case q5:case B5:case H5:return e;default:switch(e=e&&e.$$typeof,e){case U5:case W5:case K5:case G5:case z5:return e;default:return t}}case nR:return t}}}function xae(e){return zc(e)===V5}ms.AsyncMode=aR;ms.ConcurrentMode=V5;ms.ContextConsumer=U5;ms.ContextProvider=z5;ms.Element=rR;ms.ForwardRef=W5;ms.Fragment=$5;ms.Lazy=K5;ms.Memo=G5;ms.Portal=nR;ms.Profiler=q5;ms.StrictMode=B5;ms.Suspense=H5;ms.isAsyncMode=function(e){return xae(e)||zc(e)===aR};ms.isConcurrentMode=xae;ms.isContextConsumer=function(e){return zc(e)===U5};ms.isContextProvider=function(e){return zc(e)===z5};ms.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===rR};ms.isForwardRef=function(e){return zc(e)===W5};ms.isFragment=function(e){return zc(e)===$5};ms.isLazy=function(e){return zc(e)===K5};ms.isMemo=function(e){return zc(e)===G5};ms.isPortal=function(e){return zc(e)===nR};ms.isProfiler=function(e){return zc(e)===q5};ms.isStrictMode=function(e){return zc(e)===B5};ms.isSuspense=function(e){return zc(e)===H5};ms.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===$5||e===V5||e===q5||e===B5||e===H5||e===gZe||typeof e=="object"&&e!==null&&(e.$$typeof===K5||e.$$typeof===G5||e.$$typeof===z5||e.$$typeof===U5||e.$$typeof===W5||e.$$typeof===xZe||e.$$typeof===yZe||e.$$typeof===bZe||e.$$typeof===vZe)};ms.typeOf=zc;vae.exports=ms;var wZe=vae.exports,sR=wZe,jZe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},_Ze={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},NZe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},yae={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},oR={};oR[sR.ForwardRef]=NZe;oR[sR.Memo]=yae;function Y9(e){return sR.isMemo(e)?yae:oR[e.$$typeof]||jZe}var SZe=Object.defineProperty,CZe=Object.getOwnPropertyNames,J9=Object.getOwnPropertySymbols,AZe=Object.getOwnPropertyDescriptor,PZe=Object.getPrototypeOf,Q9=Object.prototype;function bae(e,t,r){if(typeof t!="string"){if(Q9){var n=PZe(t);n&&n!==Q9&&bae(e,n,r)}var s=CZe(t);J9&&(s=s.concat(J9(t)));for(var o=Y9(e),i=Y9(t),l=0;l<s.length;++l){var c=s[l];if(!_Ze[c]&&!(r&&r[c])&&!(i&&i[c])&&!(o&&o[c])){var d=AZe(t,c);try{SZe(e,c,d)}catch{}}}}return e}var EZe=bae;const Z9=Ga(EZe);var wae={exports:{}},Ss={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X5=60103,Y5=60106,M1=60107,R1=60108,L1=60114,F1=60109,$1=60110,B1=60112,q1=60113,iR=60120,z1=60115,U1=60116,jae=60121,_ae=60122,Nae=60117,Sae=60129,Cae=60131;if(typeof Symbol=="function"&&Symbol.for){var Pi=Symbol.for;X5=Pi("react.element"),Y5=Pi("react.portal"),M1=Pi("react.fragment"),R1=Pi("react.strict_mode"),L1=Pi("react.profiler"),F1=Pi("react.provider"),$1=Pi("react.context"),B1=Pi("react.forward_ref"),q1=Pi("react.suspense"),iR=Pi("react.suspense_list"),z1=Pi("react.memo"),U1=Pi("react.lazy"),jae=Pi("react.block"),_ae=Pi("react.server.block"),Nae=Pi("react.fundamental"),Sae=Pi("react.debug_trace_mode"),Cae=Pi("react.legacy_hidden")}function yu(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case X5:switch(e=e.type,e){case M1:case L1:case R1:case q1:case iR:return e;default:switch(e=e&&e.$$typeof,e){case $1:case B1:case U1:case z1:case F1:return e;default:return t}}case Y5:return t}}}var kZe=F1,IZe=X5,OZe=B1,TZe=M1,DZe=U1,MZe=z1,RZe=Y5,LZe=L1,FZe=R1,$Ze=q1;Ss.ContextConsumer=$1;Ss.ContextProvider=kZe;Ss.Element=IZe;Ss.ForwardRef=OZe;Ss.Fragment=TZe;Ss.Lazy=DZe;Ss.Memo=MZe;Ss.Portal=RZe;Ss.Profiler=LZe;Ss.StrictMode=FZe;Ss.Suspense=$Ze;Ss.isAsyncMode=function(){return!1};Ss.isConcurrentMode=function(){return!1};Ss.isContextConsumer=function(e){return yu(e)===$1};Ss.isContextProvider=function(e){return yu(e)===F1};Ss.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===X5};Ss.isForwardRef=function(e){return yu(e)===B1};Ss.isFragment=function(e){return yu(e)===M1};Ss.isLazy=function(e){return yu(e)===U1};Ss.isMemo=function(e){return yu(e)===z1};Ss.isPortal=function(e){return yu(e)===Y5};Ss.isProfiler=function(e){return yu(e)===L1};Ss.isStrictMode=function(e){return yu(e)===R1};Ss.isSuspense=function(e){return yu(e)===q1};Ss.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===M1||e===L1||e===Sae||e===R1||e===q1||e===iR||e===Cae||typeof e=="object"&&e!==null&&(e.$$typeof===U1||e.$$typeof===z1||e.$$typeof===F1||e.$$typeof===$1||e.$$typeof===B1||e.$$typeof===Nae||e.$$typeof===jae||e[0]===_ae)};Ss.typeOf=yu;wae.exports=Ss;var BZe=wae.exports,qZe=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],zZe=["reactReduxForwardedRef"],UZe=[],VZe=[null,null];function WZe(e,t){var r=e[1];return[t.payload,r+1]}function eU(e,t,r){gae(function(){return e.apply(void 0,t)},r)}function HZe(e,t,r,n,s,o,i){e.current=n,t.current=s,r.current=!1,o.current&&(o.current=null,i())}function GZe(e,t,r,n,s,o,i,l,c,d){if(e){var u=!1,f=null,h=function(){if(!u){var g=t.getState(),y,x;try{y=n(g,s.current)}catch(b){x=b,f=b}x||(f=null),y===o.current?i.current||c():(o.current=y,l.current=y,i.current=!0,d({type:"STORE_UPDATED",payload:{error:x}}))}};r.onStateChange=h,r.trySubscribe(),h();var m=function(){if(u=!0,r.tryUnsubscribe(),r.onStateChange=null,f)throw f};return m}}var KZe=function(){return[null,0]};function XZe(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,s=n===void 0?function(w){return"ConnectAdvanced("+w+")"}:n,o=r.methodName,i=o===void 0?"connectAdvanced":o,l=r.renderCountProp,c=l===void 0?void 0:l,d=r.shouldHandleStateChanges,u=d===void 0?!0:d,f=r.storeKey,h=f===void 0?"store":f;r.withRef;var m=r.forwardRef,v=m===void 0?!1:m,g=r.context,y=g===void 0?mae:g,x=RN(r,qZe),b=y;return function(j){var _=j.displayName||j.name||"Component",C=s(_),P=ea({},x,{getDisplayName:s,methodName:i,renderCountProp:c,shouldHandleStateChanges:u,storeKey:h,displayName:C,wrappedComponentName:_,WrappedComponent:j}),E=x.pure;function A(M){return e(M.dispatch,P)}var F=E?p.useMemo:function(M){return M()};function D(M){var U=p.useMemo(function(){var gt=M.reactReduxForwardedRef,Pt=RN(M,zZe);return[M.context,gt,Pt]},[M]),z=U[0],W=U[1],$=U[2],ee=p.useMemo(function(){return z&&z.Consumer&&BZe.isContextConsumer(Se.createElement(z.Consumer,null))?z:b},[z,b]),ve=p.useContext(ee),_e=!!M.store&&!!M.store.getState&&!!M.store.dispatch;ve&&ve.store;var K=_e?M.store:ve.store,q=p.useMemo(function(){return A(K)},[K]),Y=p.useMemo(function(){if(!u)return VZe;var gt=pae(K,_e?null:ve.subscription),Pt=gt.notifyNestedSubs.bind(gt);return[gt,Pt]},[K,_e,ve]),J=Y[0],fe=Y[1],Z=p.useMemo(function(){return _e?ve:ea({},ve,{subscription:J})},[_e,ve,J]),ce=p.useReducer(WZe,UZe,KZe),le=ce[0],ie=le[0],te=ce[1];if(ie&&ie.error)throw ie.error;var ue=p.useRef(),Te=p.useRef($),ne=p.useRef(),de=p.useRef(!1),lt=F(function(){return ne.current&&$===Te.current?ne.current:q(K.getState(),$)},[K,ie,$]);eU(HZe,[Te,ue,de,$,lt,ne,fe]),eU(GZe,[u,K,J,q,Te,ue,de,ne,fe,te],[K,J,q]);var Nt=p.useMemo(function(){return Se.createElement(j,ea({},lt,{ref:W}))},[W,j,lt]),at=p.useMemo(function(){return u?Se.createElement(ee.Provider,{value:Z},Nt):Nt},[ee,Nt,Z]);return at}var I=E?Se.memo(D):D;if(I.WrappedComponent=j,I.displayName=D.displayName=C,v){var R=Se.forwardRef(function(U,z){return Se.createElement(I,ea({},U,{reactReduxForwardedRef:z}))});return R.displayName=C,R.WrappedComponent=j,Z9(R,j)}return Z9(I,j)}}function tU(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function RE(e,t){if(tU(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(t,r[s])||!tU(e[r[s]],t[r[s]]))return!1;return!0}function YZe(e,t){var r={},n=function(i){var l=e[i];typeof l=="function"&&(r[i]=function(){return t(l.apply(void 0,arguments))})};for(var s in e)n(s);return r}function lR(e){return function(r,n){var s=e(r,n);function o(){return s}return o.dependsOnOwnProps=!1,o}}function rU(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function Aae(e,t){return function(n,s){s.displayName;var o=function(l,c){return o.dependsOnOwnProps?o.mapToProps(l,c):o.mapToProps(l)};return o.dependsOnOwnProps=!0,o.mapToProps=function(l,c){o.mapToProps=e,o.dependsOnOwnProps=rU(e);var d=o(l,c);return typeof d=="function"&&(o.mapToProps=d,o.dependsOnOwnProps=rU(d),d=o(l,c)),d},o}}function JZe(e){return typeof e=="function"?Aae(e):void 0}function QZe(e){return e?void 0:lR(function(t){return{dispatch:t}})}function ZZe(e){return e&&typeof e=="object"?lR(function(t){return YZe(e,t)}):void 0}const eet=[JZe,QZe,ZZe];function tet(e){return typeof e=="function"?Aae(e):void 0}function ret(e){return e?void 0:lR(function(){return{}})}const net=[tet,ret];function aet(e,t,r){return ea({},r,e,t)}function set(e){return function(r,n){n.displayName;var s=n.pure,o=n.areMergedPropsEqual,i=!1,l;return function(d,u,f){var h=e(d,u,f);return i?(!s||!o(h,l))&&(l=h):(i=!0,l=h),l}}}function oet(e){return typeof e=="function"?set(e):void 0}function iet(e){return e?void 0:function(){return aet}}const cet=[oet,iet];var det=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function uet(e,t,r,n){return function(o,i){return r(e(o,i),t(n,i),i)}}function fet(e,t,r,n,s){var o=s.areStatesEqual,i=s.areOwnPropsEqual,l=s.areStatePropsEqual,c=!1,d,u,f,h,m;function v(w,j){return d=w,u=j,f=e(d,u),h=t(n,u),m=r(f,h,u),c=!0,m}function g(){return f=e(d,u),t.dependsOnOwnProps&&(h=t(n,u)),m=r(f,h,u),m}function y(){return e.dependsOnOwnProps&&(f=e(d,u)),t.dependsOnOwnProps&&(h=t(n,u)),m=r(f,h,u),m}function x(){var w=e(d,u),j=!l(w,f);return f=w,j&&(m=r(f,h,u)),m}function b(w,j){var _=!i(j,u),C=!o(w,d,j,u);return d=w,u=j,_&&C?g():_?y():C?x():m}return function(j,_){return c?b(j,_):v(j,_)}}function met(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,s=t.initMergeProps,o=RN(t,det),i=r(e,o),l=n(e,o),c=s(e,o),d=o.pure?fet:uet;return d(i,l,c,e,o)}var het=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function LE(e,t,r){for(var n=t.length-1;n>=0;n--){var s=t[n](e);if(s)return s}return function(o,i){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+i.wrappedComponentName+".")}}function pet(e,t){return e===t}function get(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?XZe:r,s=t.mapStateToPropsFactories,o=s===void 0?net:s,i=t.mapDispatchToPropsFactories,l=i===void 0?eet:i,c=t.mergePropsFactories,d=c===void 0?cet:c,u=t.selectorFactory,f=u===void 0?met:u;return function(m,v,g,y){y===void 0&&(y={});var x=y,b=x.pure,w=b===void 0?!0:b,j=x.areStatesEqual,_=j===void 0?pet:j,C=x.areOwnPropsEqual,P=C===void 0?RE:C,E=x.areStatePropsEqual,A=E===void 0?RE:E,F=x.areMergedPropsEqual,D=F===void 0?RE:F,I=RN(x,het),R=LE(m,o,"mapStateToProps"),M=LE(v,l,"mapDispatchToProps"),U=LE(g,d,"mergeProps");return n(f,ea({methodName:"connect",getDisplayName:function(W){return"Connect("+W+")"},shouldHandleStateChanges:!!m,initMapStateToProps:R,initMapDispatchToProps:M,initMergeProps:U,pure:w,areStatesEqual:_,areOwnPropsEqual:P,areStatePropsEqual:A,areMergedPropsEqual:D},I))}}const Pae=get();fZe(em.unstable_batchedUpdates);function vet(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Eae(e,t){var r=p.useState(function(){return{inputs:t,result:e()}})[0],n=p.useRef(!0),s=p.useRef(r),o=n.current||!!(t&&s.current.inputs&&vet(t,s.current.inputs)),i=o?s.current:{inputs:t,result:e()};return p.useEffect(function(){n.current=!1,s.current=i},[i]),i.result}function xet(e,t){return Eae(function(){return e},t)}var Xa=Eae,Yn=xet,tu=function(t){var r=t.top,n=t.right,s=t.bottom,o=t.left,i=n-o,l=s-r,c={top:r,right:n,bottom:s,left:o,width:i,height:l,x:o,y:r,center:{x:(n+o)/2,y:(s+r)/2}};return c},cR=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},nU=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},yet=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},FE={top:0,right:0,bottom:0,left:0},dR=function(t){var r=t.borderBox,n=t.margin,s=n===void 0?FE:n,o=t.border,i=o===void 0?FE:o,l=t.padding,c=l===void 0?FE:l,d=tu(cR(r,s)),u=tu(nU(r,i)),f=tu(nU(u,c));return{marginBox:d,borderBox:tu(r),paddingBox:u,contentBox:f,margin:s,border:i,padding:c}},Qc=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var s=Number(r);return isNaN(s)&&Ah(!1),s},bet=function(){return{x:window.pageXOffset,y:window.pageYOffset}},yS=function(t,r){var n=t.borderBox,s=t.border,o=t.margin,i=t.padding,l=yet(n,r);return dR({borderBox:l,border:s,margin:o,padding:i})},bS=function(t,r){return r===void 0&&(r=bet()),yS(t,r)},kae=function(t,r){var n={top:Qc(r.marginTop),right:Qc(r.marginRight),bottom:Qc(r.marginBottom),left:Qc(r.marginLeft)},s={top:Qc(r.paddingTop),right:Qc(r.paddingRight),bottom:Qc(r.paddingBottom),left:Qc(r.paddingLeft)},o={top:Qc(r.borderTopWidth),right:Qc(r.borderRightWidth),bottom:Qc(r.borderBottomWidth),left:Qc(r.borderLeftWidth)};return dR({borderBox:t,margin:n,padding:s,border:o})},Iae=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return kae(r,n)},aU=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function wet(e,t){return!!(e===t||aU(e)&&aU(t))}function jet(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!wet(e[r],t[r]))return!1;return!0}function mi(e,t){t===void 0&&(t=jet);var r,n=[],s,o=!1;function i(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return o&&r===this&&t(l,n)||(s=e.apply(this,l),o=!0,r=this,n=l),s}return i}var _et=function(t){var r=[],n=null,s=function(){for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return s.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},s};const Kw=_et;function Oae(e,t){}Oae.bind(null,"warn");Oae.bind(null,"error");function vh(){}function Net(e,t){return ea({},e,{},t)}function vd(e,t,r){var n=t.map(function(s){var o=Net(r,s.options);return e.addEventListener(s.eventName,s.fn,o),function(){e.removeEventListener(s.eventName,s.fn,o)}});return function(){n.forEach(function(o){o()})}}var Cet="Invariant failed";function wS(e){this.message=e}wS.prototype.toString=function(){return this.message};function on(e,t){if(!e)throw new wS(Cet)}var Aet=function(e){lZ(t,e);function t(){for(var n,s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,n.callbacks=null,n.unbind=vh,n.onWindowError=function(l){var c=n.getCallbacks();c.isDragging()&&c.tryAbort();var d=l.error;d instanceof wS&&l.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(l){n.callbacks=l},n}var r=t.prototype;return r.componentDidMount=function(){this.unbind=vd(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(s){if(s instanceof wS){this.setState({});return}throw s},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(Se.Component),Pet=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,jS=function(t){return t+1},Eet=function(t){return`
  You have lifted an item in position `+jS(t.source.index)+`
`},Tae=function(t,r){var n=t.droppableId===r.droppableId,s=jS(t.index),o=jS(r.index);return n?`
      You have moved the item from position `+s+`
      to position `+o+`
    `:`
    You have moved the item from position `+s+`
    in list `+t.droppableId+`
    to list `+r.droppableId+`
    in position `+o+`
  `},Dae=function(t,r,n){var s=r.droppableId===n.droppableId;return s?`
      The item `+t+`
      has been combined with `+n.draggableId:`
      The item `+t+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},ket=function(t){var r=t.destination;if(r)return Tae(t.source,r);var n=t.combine;return n?Dae(t.draggableId,t.source,n):"You are over an area that cannot be dropped on"},sU=function(t){return`
  The item has returned to its starting position
  of `+jS(t.index)+`
`},Iet=function(t){if(t.reason==="CANCEL")return`
      Movement cancelled.
      `+sU(t.source)+`
    `;var r=t.destination,n=t.combine;return r?`
      You have dropped the item.
      `+Tae(t.source,r)+`
    `:n?`
      You have dropped the item.
      `+Dae(t.draggableId,t.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+sU(t.source)+`
  `},n_={dragHandleUsageInstructions:Pet,onDragStart:Eet,onDragUpdate:ket,onDragEnd:Iet},hi={x:0,y:0},Oi=function(t,r){return{x:t.x+r.x,y:t.y+r.y}},Ec=function(t,r){return{x:t.x-r.x,y:t.y-r.y}},xh=function(t,r){return t.x===r.x&&t.y===r.y},M0=function(t){return{x:t.x!==0?-t.x:0,y:t.y!==0?-t.y:0}},vg=function(t,r,n){var s;return n===void 0&&(n=0),s={},s[t]=r,s[t==="x"?"y":"x"]=n,s},Xw=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))},oU=function(t,r){return Math.min.apply(Math,r.map(function(n){return Xw(t,n)}))},Mae=function(t){return function(r){return{x:t(r.x),y:t(r.y)}}},Oet=function(e,t){var r=tu({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r},V1=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},iU=function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}]},Tet={top:0,right:0,bottom:0,left:0},Det=function(t,r){return r?V1(t,r.scroll.diff.displacement):t},Met=function(t,r,n){if(n&&n.increasedBy){var s;return ea({},t,(s={},s[r.end]=t[r.end]+n.increasedBy[r.line],s))}return t},Ret=function(t,r){return r&&r.shouldClipSubject?Oet(r.pageMarginBox,t):tu(t)},t0=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,s=e.frame,o=Det(t.marginBox,s),i=Met(o,n,r),l=Ret(i,s);return{page:t,withPlaceholder:r,active:l}},uR=function(e,t){e.frame||on(!1);var r=e.frame,n=Ec(t,r.scroll.initial),s=M0(n),o=ea({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:s},max:r.scroll.max}}),i=t0({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:o}),l=ea({},e,{frame:o,subject:i});return l};function _S(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})}function fR(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function Gh(e,t){if(e.find)return e.find(t);var r=fR(e,t);if(r!==-1)return e[r]}function Rae(e){return Array.prototype.slice.call(e)}var Lae=mi(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),Fae=mi(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),J5=mi(function(e){return _S(e)}),Let=mi(function(e){return _S(e)}),R0=mi(function(e,t){var r=Let(t).filter(function(n){return e===n.descriptor.droppableId}).sort(function(n,s){return n.descriptor.index-s.descriptor.index});return r});function mR(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function Q5(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var Z5=mi(function(e,t){return t.filter(function(r){return r.descriptor.id!==e.descriptor.id})}),Fet=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,s=e.insideDestination,o=e.previousImpact;if(!n.isCombineEnabled)return null;var i=mR(o);if(!i)return null;function l(g){var y={type:"COMBINE",combine:{draggableId:g,droppableId:n.descriptor.id}};return ea({},o,{at:y})}var c=o.displaced.all,d=c.length?c[0]:null;if(t)return d?l(d):null;var u=Z5(r,s);if(!d){if(!u.length)return null;var f=u[u.length-1];return l(f.descriptor.id)}var h=fR(u,function(g){return g.descriptor.id===d});h===-1&&on(!1);var m=h-1;if(m<0)return null;var v=u[m];return l(v.descriptor.id)},L0=function(e,t){return e.descriptor.droppableId===t.descriptor.id},$ae={point:hi,value:0},Yw={invisible:{},visible:{},all:[]},$et={displaced:Yw,displacedBy:$ae,at:null},jd=function(e,t){return function(r){return e<=r&&r<=t}},Bae=function(e){var t=jd(e.top,e.bottom),r=jd(e.left,e.right);return function(n){var s=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);if(s)return!0;var o=t(n.top)||t(n.bottom),i=r(n.left)||r(n.right),l=o&&i;if(l)return!0;var c=n.top<e.top&&n.bottom>e.bottom,d=n.left<e.left&&n.right>e.right,u=c&&d;if(u)return!0;var f=c&&i||d&&o;return f}},Bet=function(e){var t=jd(e.top,e.bottom),r=jd(e.left,e.right);return function(n){var s=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);return s}},hR={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},qae={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},qet=function(e){return function(t){var r=jd(t.top,t.bottom),n=jd(t.left,t.right);return function(s){return e===hR?r(s.top)&&r(s.bottom):n(s.left)&&n(s.right)}}},zet=function(t,r){var n=r.frame?r.frame.scroll.diff.displacement:hi;return V1(t,n)},Uet=function(t,r,n){return r.subject.active?n(r.subject.active)(t):!1},Vet=function(t,r,n){return n(r)(t)},pR=function(t){var r=t.target,n=t.destination,s=t.viewport,o=t.withDroppableDisplacement,i=t.isVisibleThroughFrameFn,l=o?zet(r,n):r;return Uet(l,n,i)&&Vet(l,s,i)},Wet=function(t){return pR(ea({},t,{isVisibleThroughFrameFn:Bae}))},zae=function(t){return pR(ea({},t,{isVisibleThroughFrameFn:Bet}))},Het=function(t){return pR(ea({},t,{isVisibleThroughFrameFn:qet(t.destination.axis)}))},Get=function(t,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var s=r.invisible,o=r.visible;if(s[t])return!1;var i=o[t];return i?i.shouldAnimate:!0};function Ket(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return tu(cR(r,n))}function Jw(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,s=e.viewport,o=e.forceShouldAnimate,i=e.last;return t.reduce(function(c,d){var u=Ket(d,n),f=d.descriptor.id;c.all.push(f);var h=Wet({target:u,destination:r,viewport:s,withDroppableDisplacement:!0});if(!h)return c.invisible[d.descriptor.id]=!0,c;var m=Get(f,i,o),v={draggableId:f,shouldAnimate:m};return c.visible[f]=v,c},{all:[],visible:{},invisible:{}})}function Xet(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function lU(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,s=e.destination,o=Xet(t,{inHomeList:r});return{displaced:Yw,displacedBy:n,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:o}}}}function NS(e){var t=e.draggable,r=e.insideDestination,n=e.destination,s=e.viewport,o=e.displacedBy,i=e.last,l=e.index,c=e.forceShouldAnimate,d=L0(t,n);if(l==null)return lU({insideDestination:r,inHomeList:d,displacedBy:o,destination:n});var u=Gh(r,function(g){return g.descriptor.index===l});if(!u)return lU({insideDestination:r,inHomeList:d,displacedBy:o,destination:n});var f=Z5(t,r),h=r.indexOf(u),m=f.slice(h),v=Jw({afterDragging:m,destination:n,displacedBy:o,last:i,viewport:s.frame,forceShouldAnimate:c});return{displaced:v,displacedBy:o,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function Oh(e,t){return!!t.effected[e]}var Yet=function(e){var t=e.isMovingForward,r=e.destination,n=e.draggables,s=e.combine,o=e.afterCritical;if(!r.isCombineEnabled)return null;var i=s.draggableId,l=n[i],c=l.descriptor.index,d=Oh(i,o);return d?t?c:c-1:t?c+1:c},Jet=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,s=e.location;if(!n.length)return null;var o=s.index,i=t?o+1:o-1,l=n[0].descriptor.index,c=n[n.length-1].descriptor.index,d=r?c:c+1;return i<l||i>d?null:i},Qet=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,s=e.draggables,o=e.destination,i=e.insideDestination,l=e.previousImpact,c=e.viewport,d=e.afterCritical,u=l.at;if(u||on(!1),u.type==="REORDER"){var f=Jet({isMovingForward:t,isInHomeList:r,location:u.destination,insideDestination:i});return f==null?null:NS({draggable:n,insideDestination:i,destination:o,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:f})}var h=Yet({isMovingForward:t,destination:o,displaced:l.displaced,draggables:s,combine:u.combine,afterCritical:d});return h==null?null:NS({draggable:n,insideDestination:i,destination:o,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:h})},Zet=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,s=e.displacedBy,o=!!(t.visible[n]||t.invisible[n]);return Oh(n,r)?o?hi:M0(s.point):o?s.point:hi},ett=function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,s=Q5(r);s||on(!1);var o=s.draggableId,i=n[o].page.borderBox.center,l=Zet({displaced:r.displaced,afterCritical:t,combineWith:o,displacedBy:r.displacedBy});return Oi(i,l)},Uae=function(t,r){return r.margin[t.start]+r.borderBox[t.size]/2},ttt=function(t,r){return r.margin[t.end]+r.borderBox[t.size]/2},gR=function(t,r,n){return r[t.crossAxisStart]+n.margin[t.crossAxisStart]+n.borderBox[t.crossAxisSize]/2},cU=function(t){var r=t.axis,n=t.moveRelativeTo,s=t.isMoving;return vg(r.line,n.marginBox[r.end]+Uae(r,s),gR(r,n.marginBox,s))},dU=function(t){var r=t.axis,n=t.moveRelativeTo,s=t.isMoving;return vg(r.line,n.marginBox[r.start]-ttt(r,s),gR(r,n.marginBox,s))},rtt=function(t){var r=t.axis,n=t.moveInto,s=t.isMoving;return vg(r.line,n.contentBox[r.start]+Uae(r,s),gR(r,n.contentBox,s))},ntt=function(e){var t=e.impact,r=e.draggable,n=e.draggables,s=e.droppable,o=e.afterCritical,i=R0(s.descriptor.id,n),l=r.page,c=s.axis;if(!i.length)return rtt({axis:c,moveInto:s.page,isMoving:l});var d=t.displaced,u=t.displacedBy,f=d.all[0];if(f){var h=n[f];if(Oh(f,o))return dU({axis:c,moveRelativeTo:h.page,isMoving:l});var m=yS(h.page,u.point);return dU({axis:c,moveRelativeTo:m,isMoving:l})}var v=i[i.length-1];if(v.descriptor.id===r.descriptor.id)return l.borderBox.center;if(Oh(v.descriptor.id,o)){var g=yS(v.page,M0(o.displacedBy.point));return cU({axis:c,moveRelativeTo:g,isMoving:l})}return cU({axis:c,moveRelativeTo:v.page,isMoving:l})},WT=function(e,t){var r=e.frame;return r?Oi(t,r.scroll.diff.displacement):t},att=function(t){var r=t.impact,n=t.draggable,s=t.droppable,o=t.draggables,i=t.afterCritical,l=n.page.borderBox.center,c=r.at;return!s||!c?l:c.type==="REORDER"?ntt({impact:r,draggable:n,draggables:o,droppable:s,afterCritical:i}):ett({impact:r,draggables:o,afterCritical:i})},eA=function(e){var t=att(e),r=e.droppable,n=r?WT(r,t):t;return n},Vae=function(e,t){var r=Ec(t,e.scroll.initial),n=M0(r),s=tu({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),o={frame:s,scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}};return o};function uU(e,t){return e.map(function(r){return t[r]})}function stt(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}var ott=function(e){var t=e.impact,r=e.viewport,n=e.destination,s=e.draggables,o=e.maxScrollChange,i=Vae(r,Oi(r.scroll.current,o)),l=n.frame?uR(n,Oi(n.frame.scroll.current,o)):n,c=t.displaced,d=Jw({afterDragging:uU(c.all,s),destination:n,displacedBy:t.displacedBy,viewport:i.frame,last:c,forceShouldAnimate:!1}),u=Jw({afterDragging:uU(c.all,s),destination:l,displacedBy:t.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),f={},h={},m=[c,d,u];c.all.forEach(function(g){var y=stt(g,m);if(y){h[g]=y;return}f[g]=!0});var v=ea({},t,{displaced:{all:c.all,invisible:f,visible:h}});return v},itt=function(e,t){return Oi(e.scroll.diff.displacement,t)},vR=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=e.viewport,s=itt(n,t),o=Ec(s,r.page.borderBox.center);return Oi(r.client.borderBox.center,o)},Wae=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,s=e.viewport,o=e.withDroppableDisplacement,i=e.onlyOnMainAxis,l=i===void 0?!1:i,c=Ec(n,t.page.borderBox.center),d=V1(t.page.borderBox,c),u={target:d,destination:r,withDroppableDisplacement:o,viewport:s};return l?Het(u):zae(u)},ltt=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,s=e.draggables,o=e.previousImpact,i=e.viewport,l=e.previousPageBorderBoxCenter,c=e.previousClientSelection,d=e.afterCritical;if(!n.isEnabled)return null;var u=R0(n.descriptor.id,s),f=L0(r,n),h=Fet({isMovingForward:t,draggable:r,destination:n,insideDestination:u,previousImpact:o})||Qet({isMovingForward:t,isInHomeList:f,draggable:r,draggables:s,destination:n,insideDestination:u,previousImpact:o,viewport:i,afterCritical:d});if(!h)return null;var m=eA({impact:h,draggable:r,droppable:n,draggables:s,afterCritical:d}),v=Wae({draggable:r,destination:n,newPageBorderBoxCenter:m,viewport:i.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(v){var g=vR({pageBorderBoxCenter:m,draggable:r,viewport:i});return{clientSelection:g,impact:h,scrollJumpRequest:null}}var y=Ec(m,l),x=ott({impact:h,viewport:i,destination:n,draggables:s,maxScrollChange:y});return{clientSelection:c,impact:x,scrollJumpRequest:y}},ll=function(t){var r=t.subject.active;return r||on(!1),r},ctt=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,s=e.droppables,o=e.viewport,i=n.subject.active;if(!i)return null;var l=n.axis,c=jd(i[l.start],i[l.end]),d=J5(s).filter(function(f){return f!==n}).filter(function(f){return f.isEnabled}).filter(function(f){return!!f.subject.active}).filter(function(f){return Bae(o.frame)(ll(f))}).filter(function(f){var h=ll(f);return t?i[l.crossAxisEnd]<h[l.crossAxisEnd]:h[l.crossAxisStart]<i[l.crossAxisStart]}).filter(function(f){var h=ll(f),m=jd(h[l.start],h[l.end]);return c(h[l.start])||c(h[l.end])||m(i[l.start])||m(i[l.end])}).sort(function(f,h){var m=ll(f)[l.crossAxisStart],v=ll(h)[l.crossAxisStart];return t?m-v:v-m}).filter(function(f,h,m){return ll(f)[l.crossAxisStart]===ll(m[0])[l.crossAxisStart]});if(!d.length)return null;if(d.length===1)return d[0];var u=d.filter(function(f){var h=jd(ll(f)[l.start],ll(f)[l.end]);return h(r[l.line])});return u.length===1?u[0]:u.length>1?u.sort(function(f,h){return ll(f)[l.start]-ll(h)[l.start]})[0]:d.sort(function(f,h){var m=oU(r,iU(ll(f))),v=oU(r,iU(ll(h)));return m!==v?m-v:ll(f)[l.start]-ll(h)[l.start]})[0]},fU=function(t,r){var n=t.page.borderBox.center;return Oh(t.descriptor.id,r)?Ec(n,r.displacedBy.point):n},dtt=function(t,r){var n=t.page.borderBox;return Oh(t.descriptor.id,r)?V1(n,M0(r.displacedBy.point)):n},utt=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,s=e.insideDestination,o=e.afterCritical,i=s.filter(function(l){return zae({target:dtt(l,o),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(l,c){var d=Xw(t,WT(n,fU(l,o))),u=Xw(t,WT(n,fU(c,o)));return d<u?-1:u<d?1:l.descriptor.index-c.descriptor.index});return i[0]||null},W1=mi(function(t,r){var n=r[t.line];return{value:n,point:vg(t.line,n)}}),ftt=function(t,r,n){var s=t.axis;if(t.descriptor.mode==="virtual")return vg(s.line,r[s.line]);var o=t.subject.page.contentBox[s.size],i=R0(t.descriptor.id,n),l=i.reduce(function(u,f){return u+f.client.marginBox[s.size]},0),c=l+r[s.line],d=c-o;return d<=0?null:vg(s.line,d)},Hae=function(t,r){return ea({},t,{scroll:ea({},t.scroll,{max:r})})},Gae=function(t,r,n){var s=t.frame;L0(r,t)&&on(!1),t.subject.withPlaceholder&&on(!1);var o=W1(t.axis,r.displaceBy).point,i=ftt(t,o,n),l={placeholderSize:o,increasedBy:i,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!s){var c=t0({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:t.frame});return ea({},t,{subject:c})}var d=i?Oi(s.scroll.max,i):s.scroll.max,u=Hae(s,d),f=t0({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:u});return ea({},t,{subject:f,frame:u})},mtt=function(t){var r=t.subject.withPlaceholder;r||on(!1);var n=t.frame;if(!n){var s=t0({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return ea({},t,{subject:s})}var o=r.oldFrameMaxScroll;o||on(!1);var i=Hae(n,o),l=t0({page:t.subject.page,axis:t.axis,frame:i,withPlaceholder:null});return ea({},t,{subject:l,frame:i})},htt=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,s=e.draggable,o=e.draggables,i=e.destination,l=e.viewport,c=e.afterCritical;if(!r){if(n.length)return null;var d={displaced:Yw,displacedBy:$ae,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:0}}},u=eA({impact:d,draggable:s,droppable:i,draggables:o,afterCritical:c}),f=L0(s,i)?i:Gae(i,s,o),h=Wae({draggable:s,destination:f,newPageBorderBoxCenter:u,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return h?d:null}var m=t[i.axis.line]<=r.page.borderBox.center[i.axis.line],v=function(){var y=r.descriptor.index;return r.descriptor.id===s.descriptor.id||m?y:y+1}(),g=W1(i.axis,s.displaceBy);return NS({draggable:s,insideDestination:n,destination:i,viewport:l,displacedBy:g,last:Yw,index:v})},ptt=function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,s=e.isOver,o=e.draggables,i=e.droppables,l=e.viewport,c=e.afterCritical,d=ctt({isMovingForward:t,pageBorderBoxCenter:r,source:s,droppables:i,viewport:l});if(!d)return null;var u=R0(d.descriptor.id,o),f=utt({pageBorderBoxCenter:r,viewport:l,destination:d,insideDestination:u,afterCritical:c}),h=htt({previousPageBorderBoxCenter:r,destination:d,draggable:n,draggables:o,moveRelativeTo:f,insideDestination:u,viewport:l,afterCritical:c});if(!h)return null;var m=eA({impact:h,draggable:n,droppable:d,draggables:o,afterCritical:c}),v=vR({pageBorderBoxCenter:m,draggable:n,viewport:l});return{clientSelection:v,impact:h,scrollJumpRequest:null}},Mc=function(e){var t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null},gtt=function(t,r){var n=Mc(t);return n?r[n]:null},vtt=function(e){var t=e.state,r=e.type,n=gtt(t.impact,t.dimensions.droppables),s=!!n,o=t.dimensions.droppables[t.critical.droppable.id],i=n||o,l=i.axis.direction,c=l==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||l==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(c&&!s)return null;var d=r==="MOVE_DOWN"||r==="MOVE_RIGHT",u=t.dimensions.draggables[t.critical.draggable.id],f=t.current.page.borderBoxCenter,h=t.dimensions,m=h.draggables,v=h.droppables;return c?ltt({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,destination:i,draggables:m,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):ptt({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,isOver:i,draggables:m,droppables:v,viewport:t.viewport,afterCritical:t.afterCritical})};function gp(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function Kae(e){var t=jd(e.top,e.bottom),r=jd(e.left,e.right);return function(s){return t(s.y)&&r(s.x)}}function xtt(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function ytt(e){var t=e.pageBorderBox,r=e.draggable,n=e.candidates,s=r.page.borderBox.center,o=n.map(function(i){var l=i.axis,c=vg(i.axis.line,t.center[l.line],i.page.borderBox.center[l.crossAxisLine]);return{id:i.descriptor.id,distance:Xw(s,c)}}).sort(function(i,l){return l.distance-i.distance});return o[0]?o[0].id:null}function btt(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,s=J5(n).filter(function(o){if(!o.isEnabled)return!1;var i=o.subject.active;if(!i||!xtt(t,i))return!1;if(Kae(i)(t.center))return!0;var l=o.axis,c=i.center[l.crossAxisLine],d=t[l.crossAxisStart],u=t[l.crossAxisEnd],f=jd(i[l.crossAxisStart],i[l.crossAxisEnd]),h=f(d),m=f(u);return!h&&!m?!0:h?d<c:u>c});return s.length?s.length===1?s[0].descriptor.id:ytt({pageBorderBox:t,draggable:r,candidates:s}):null}var Xae=function(t,r){return tu(V1(t,r))},wtt=function(e,t){var r=e.frame;return r?Xae(t,r.scroll.diff.value):t};function Yae(e){var t=e.displaced,r=e.id;return!!(t.visible[r]||t.invisible[r])}function jtt(e){var t=e.draggable,r=e.closest,n=e.inHomeList;return r?n&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var _tt=function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,s=e.insideDestination,o=e.last,i=e.viewport,l=e.afterCritical,c=n.axis,d=W1(n.axis,r.displaceBy),u=d.value,f=t[c.start],h=t[c.end],m=Z5(r,s),v=Gh(m,function(y){var x=y.descriptor.id,b=y.page.borderBox.center[c.line],w=Oh(x,l),j=Yae({displaced:o,id:x});return w?j?h<=b:f<b-u:j?h<=b+u:f<b}),g=jtt({draggable:r,closest:v,inHomeList:L0(r,n)});return NS({draggable:r,insideDestination:s,destination:n,viewport:i,last:o,displacedBy:d,index:g})},Ntt=4,Stt=function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,s=e.destination,o=e.insideDestination,i=e.afterCritical;if(!s.isCombineEnabled)return null;var l=s.axis,c=W1(s.axis,t.displaceBy),d=c.value,u=r[l.start],f=r[l.end],h=Z5(t,o),m=Gh(h,function(g){var y=g.descriptor.id,x=g.page.borderBox,b=x[l.size],w=b/Ntt,j=Oh(y,i),_=Yae({displaced:n.displaced,id:y});return j?_?f>x[l.start]+w&&f<x[l.end]-w:u>x[l.start]-d+w&&u<x[l.end]-d-w:_?f>x[l.start]+d+w&&f<x[l.end]+d-w:u>x[l.start]+w&&u<x[l.end]-w});if(!m)return null;var v={displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:s.descriptor.id}}};return v},Jae=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,s=e.droppables,o=e.previousImpact,i=e.viewport,l=e.afterCritical,c=Xae(r.page.borderBox,t),d=btt({pageBorderBox:c,draggable:r,droppables:s});if(!d)return $et;var u=s[d],f=R0(u.descriptor.id,n),h=wtt(u,c);return Stt({pageBorderBoxWithDroppableScroll:h,draggable:r,previousImpact:o,destination:u,insideDestination:f,afterCritical:l})||_tt({pageBorderBoxWithDroppableScroll:h,draggable:r,destination:u,insideDestination:f,last:o.displaced,viewport:i,afterCritical:l})},xR=function(e,t){var r;return ea({},e,(r={},r[t.descriptor.id]=t,r))},Ctt=function(t){var r=t.previousImpact,n=t.impact,s=t.droppables,o=Mc(r),i=Mc(n);if(!o||o===i)return s;var l=s[o];if(!l.subject.withPlaceholder)return s;var c=mtt(l);return xR(s,c)},Att=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,s=e.previousImpact,o=e.impact,i=Ctt({previousImpact:s,impact:o,droppables:n}),l=Mc(o);if(!l)return i;var c=n[l];if(L0(t,c)||c.subject.withPlaceholder)return i;var d=Gae(c,t,r);return xR(i,d)},bb=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,s=e.viewport,o=e.impact,i=e.scrollJumpRequest,l=s||t.viewport,c=n||t.dimensions,d=r||t.current.client.selection,u=Ec(d,t.initial.client.selection),f={offset:u,selection:d,borderBoxCenter:Oi(t.initial.client.borderBoxCenter,u)},h={selection:Oi(f.selection,l.scroll.current),borderBoxCenter:Oi(f.borderBoxCenter,l.scroll.current),offset:Oi(f.offset,l.scroll.diff.value)},m={client:f,page:h};if(t.phase==="COLLECTING")return ea({phase:"COLLECTING"},t,{dimensions:c,viewport:l,current:m});var v=c.draggables[t.critical.draggable.id],g=o||Jae({pageOffset:h.offset,draggable:v,draggables:c.draggables,droppables:c.droppables,previousImpact:t.impact,viewport:l,afterCritical:t.afterCritical}),y=Att({draggable:v,impact:g,previousImpact:t.impact,draggables:c.draggables,droppables:c.droppables}),x=ea({},t,{current:m,dimensions:{draggables:c.draggables,droppables:y},impact:g,viewport:l,scrollJumpRequest:i||null,forceShouldAnimate:i?!1:null});return x};function Ptt(e,t){return e.map(function(r){return t[r]})}var Qae=function(e){var t=e.impact,r=e.viewport,n=e.draggables,s=e.destination,o=e.forceShouldAnimate,i=t.displaced,l=Ptt(i.all,n),c=Jw({afterDragging:l,destination:s,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:o,last:i});return ea({},t,{displaced:c})},Zae=function(e){var t=e.impact,r=e.draggable,n=e.droppable,s=e.draggables,o=e.viewport,i=e.afterCritical,l=eA({impact:t,draggable:r,draggables:s,droppable:n,afterCritical:i});return vR({pageBorderBoxCenter:l,draggable:r,viewport:o})},ese=function(e){var t=e.state,r=e.dimensions,n=e.viewport;t.movementMode!=="SNAP"&&on(!1);var s=t.impact,o=n||t.viewport,i=r||t.dimensions,l=i.draggables,c=i.droppables,d=l[t.critical.draggable.id],u=Mc(s);u||on(!1);var f=c[u],h=Qae({impact:s,viewport:o,destination:f,draggables:l}),m=Zae({impact:h,draggable:d,droppable:f,draggables:l,viewport:o,afterCritical:t.afterCritical});return bb({impact:h,clientSelection:m,state:t,dimensions:i,viewport:o})},Ett=function(e){return{index:e.index,droppableId:e.droppableId}},tse=function(e){var t=e.draggable,r=e.home,n=e.draggables,s=e.viewport,o=W1(r.axis,t.displaceBy),i=R0(r.descriptor.id,n),l=i.indexOf(t);l===-1&&on(!1);var c=i.slice(l+1),d=c.reduce(function(m,v){return m[v.descriptor.id]=!0,m},{}),u={inVirtualList:r.descriptor.mode==="virtual",displacedBy:o,effected:d},f=Jw({afterDragging:c,destination:r,displacedBy:o,last:null,viewport:s.frame,forceShouldAnimate:!1}),h={displaced:f,displacedBy:o,at:{type:"REORDER",destination:Ett(t.descriptor)}};return{impact:h,afterCritical:u}},ktt=function(e,t){return{draggables:e.draggables,droppables:xR(e.droppables,t)}},Itt=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,s=yS(t.client,r),o=bS(s,n),i=ea({},t,{placeholder:ea({},t.placeholder,{client:s}),client:s,page:o});return i},Ott=function(e){var t=e.frame;return t||on(!1),t},Ttt=function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,s=n.scroll.diff.value;return t.map(function(o){var i=o.descriptor.droppableId,l=r[i],c=Ott(l),d=c.scroll.diff.value,u=Oi(s,d),f=Itt({draggable:o,offset:u,initialWindowScroll:n.scroll.initial});return f})},Dtt=function(e){var t=e.state,r=e.published,n=r.modified.map(function(w){var j=t.dimensions.droppables[w.droppableId],_=uR(j,w.scroll);return _}),s=ea({},t.dimensions.droppables,{},Lae(n)),o=Fae(Ttt({additions:r.additions,updatedDroppables:s,viewport:t.viewport})),i=ea({},t.dimensions.draggables,{},o);r.removals.forEach(function(w){delete i[w]});var l={droppables:s,draggables:i},c=Mc(t.impact),d=c?l.droppables[c]:null,u=l.draggables[t.critical.draggable.id],f=l.droppables[t.critical.droppable.id],h=tse({draggable:u,home:f,draggables:i,viewport:t.viewport}),m=h.impact,v=h.afterCritical,g=d&&d.isCombineEnabled?t.impact:m,y=Jae({pageOffset:t.current.page.offset,draggable:l.draggables[t.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:g,viewport:t.viewport,afterCritical:v}),x=ea({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:y,onLiftImpact:m,dimensions:l,afterCritical:v,forceShouldAnimate:!1});if(t.phase==="COLLECTING")return x;var b=ea({phase:"DROP_PENDING"},x,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1});return b},HT=function(t){return t.movementMode==="SNAP"},$E=function(t,r,n){var s=ktt(t.dimensions,r);return!HT(t)||n?bb({state:t,dimensions:s}):ese({state:t,dimensions:s})};function BE(e){return e.isDragging&&e.movementMode==="SNAP"?ea({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var mU={phase:"IDLE",completed:null,shouldFlush:!1},Mtt=function(e,t){if(e===void 0&&(e=mU),t.type==="FLUSH")return ea({},mU,{shouldFlush:!0});if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&on(!1);var r=t.payload,n=r.critical,s=r.clientSelection,o=r.viewport,i=r.dimensions,l=r.movementMode,c=i.draggables[n.draggable.id],d=i.droppables[n.droppable.id],u={selection:s,borderBoxCenter:c.client.borderBox.center,offset:hi},f={client:u,page:{selection:Oi(u.selection,o.scroll.initial),borderBoxCenter:Oi(u.selection,o.scroll.initial),offset:Oi(u.selection,o.scroll.diff.value)}},h=J5(i.droppables).every(function(te){return!te.isFixedOnPage}),m=tse({draggable:c,home:d,draggables:i.draggables,viewport:o}),v=m.impact,g=m.afterCritical,y={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:i,initial:f,current:f,isWindowScrollAllowed:h,impact:v,afterCritical:g,onLiftImpact:v,viewport:o,scrollJumpRequest:null,forceShouldAnimate:null};return y}if(t.type==="COLLECTION_STARTING"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&on(!1);var x=ea({phase:"COLLECTING"},e,{phase:"COLLECTING"});return x}if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||on(!1),Dtt({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;gp(e)||on(!1);var b=t.payload.client;return xh(b,e.current.client.selection)?e:bb({state:e,clientSelection:b,impact:HT(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return BE(e);gp(e)||on(!1);var w=t.payload,j=w.id,_=w.newScroll,C=e.dimensions.droppables[j];if(!C)return e;var P=uR(C,_);return $E(e,P,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;gp(e)||on(!1);var E=t.payload,A=E.id,F=E.isEnabled,D=e.dimensions.droppables[A];D||on(!1),D.isEnabled===F&&on(!1);var I=ea({},D,{isEnabled:F});return $E(e,I,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;gp(e)||on(!1);var R=t.payload,M=R.id,U=R.isCombineEnabled,z=e.dimensions.droppables[M];z||on(!1),z.isCombineEnabled===U&&on(!1);var W=ea({},z,{isCombineEnabled:U});return $E(e,W,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;gp(e)||on(!1),e.isWindowScrollAllowed||on(!1);var $=t.payload.newScroll;if(xh(e.viewport.scroll.current,$))return BE(e);var ee=Vae(e.viewport,$);return HT(e)?ese({state:e,viewport:ee}):bb({state:e,viewport:ee})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!gp(e))return e;var ve=t.payload.maxScroll;if(xh(ve,e.viewport.scroll.max))return e;var _e=ea({},e.viewport,{scroll:ea({},e.viewport.scroll,{max:ve})});return ea({phase:"DRAGGING"},e,{viewport:_e})}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&on(!1);var K=vtt({state:e,type:t.type});return K?bb({state:e,impact:K.impact,clientSelection:K.clientSelection,scrollJumpRequest:K.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){var q=t.payload.reason;e.phase!=="COLLECTING"&&on(!1);var Y=ea({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:q});return Y}if(t.type==="DROP_ANIMATE"){var J=t.payload,fe=J.completed,Z=J.dropDuration,ce=J.newHomeClientOffset;e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||on(!1);var le={phase:"DROP_ANIMATING",completed:fe,dropDuration:Z,newHomeClientOffset:ce,dimensions:e.dimensions};return le}if(t.type==="DROP_COMPLETE"){var ie=t.payload.completed;return{phase:"IDLE",completed:ie,shouldFlush:!1}}return e},Rtt=function(t){return{type:"BEFORE_INITIAL_CAPTURE",payload:t}},Ltt=function(t){return{type:"LIFT",payload:t}},Ftt=function(t){return{type:"INITIAL_PUBLISH",payload:t}},$tt=function(t){return{type:"PUBLISH_WHILE_DRAGGING",payload:t}},Btt=function(){return{type:"COLLECTION_STARTING",payload:null}},qtt=function(t){return{type:"UPDATE_DROPPABLE_SCROLL",payload:t}},ztt=function(t){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}},Utt=function(t){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}},rse=function(t){return{type:"MOVE",payload:t}},Vtt=function(t){return{type:"MOVE_BY_WINDOW_SCROLL",payload:t}},Wtt=function(t){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}},Htt=function(){return{type:"MOVE_UP",payload:null}},Gtt=function(){return{type:"MOVE_DOWN",payload:null}},Ktt=function(){return{type:"MOVE_RIGHT",payload:null}},Xtt=function(){return{type:"MOVE_LEFT",payload:null}},yR=function(){return{type:"FLUSH",payload:null}},Ytt=function(t){return{type:"DROP_ANIMATE",payload:t}},bR=function(t){return{type:"DROP_COMPLETE",payload:t}},nse=function(t){return{type:"DROP",payload:t}},Jtt=function(t){return{type:"DROP_PENDING",payload:t}},ase=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},Qtt=function(e){return function(t){var r=t.getState,n=t.dispatch;return function(s){return function(o){if(o.type!=="LIFT"){s(o);return}var i=o.payload,l=i.id,c=i.clientSelection,d=i.movementMode,u=r();u.phase==="DROP_ANIMATING"&&n(bR({completed:u.completed})),r().phase!=="IDLE"&&on(!1),n(yR()),n(Rtt({draggableId:l,movementMode:d}));var f={shouldPublishImmediately:d==="SNAP"},h={draggableId:l,scrollOptions:f},m=e.startPublishing(h),v=m.critical,g=m.dimensions,y=m.viewport;n(Ftt({critical:v,dimensions:g,clientSelection:c,movementMode:d,viewport:y}))}}}},Ztt=function(e){return function(){return function(t){return function(r){r.type==="INITIAL_PUBLISH"&&e.dragging(),r.type==="DROP_ANIMATE"&&e.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&e.resting(),t(r)}}}},wR={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},Qw={opacity:{drop:0,combining:.7},scale:{drop:.75}},jR={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},np=jR.outOfTheWay+"s "+wR.outOfTheWay,wb={fluid:"opacity "+np,snap:"transform "+np+", opacity "+np,drop:function(t){var r=t+"s "+wR.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+np,placeholder:"height "+np+", width "+np+", margin "+np},hU=function(t){return xh(t,hi)?null:"translate("+t.x+"px, "+t.y+"px)"},GT={moveTo:hU,drop:function(t,r){var n=hU(t);return n?r?n+" scale("+Qw.scale.drop+")":n:null}},KT=jR.minDropTime,sse=jR.maxDropTime,ert=sse-KT,pU=1500,trt=.6,rrt=function(e){var t=e.current,r=e.destination,n=e.reason,s=Xw(t,r);if(s<=0)return KT;if(s>=pU)return sse;var o=s/pU,i=KT+ert*o,l=n==="CANCEL"?i*trt:i;return Number(l.toFixed(2))},nrt=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,s=e.viewport,o=e.afterCritical,i=n.draggables,l=n.droppables,c=Mc(t),d=c?l[c]:null,u=l[r.descriptor.droppableId],f=Zae({impact:t,draggable:r,draggables:i,afterCritical:o,droppable:d||u,viewport:s}),h=Ec(f,r.client.borderBox.center);return h},art=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,s=e.home,o=e.viewport,i=e.onLiftImpact;if(!n.at||r!=="DROP"){var l=Qae({draggables:t,impact:i,destination:s,viewport:o,forceShouldAnimate:!0});return{impact:l,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var c=ea({},n,{displaced:Yw});return{impact:c,didDropInsideDroppable:!0}},srt=function(e){var t=e.getState,r=e.dispatch;return function(n){return function(s){if(s.type!=="DROP"){n(s);return}var o=t(),i=s.payload.reason;if(o.phase==="COLLECTING"){r(Jtt({reason:i}));return}if(o.phase!=="IDLE"){var l=o.phase==="DROP_PENDING"&&o.isWaiting;l&&on(!1),o.phase==="DRAGGING"||o.phase==="DROP_PENDING"||on(!1);var c=o.critical,d=o.dimensions,u=d.draggables[o.critical.draggable.id],f=art({reason:i,lastImpact:o.impact,afterCritical:o.afterCritical,onLiftImpact:o.onLiftImpact,home:o.dimensions.droppables[o.critical.droppable.id],viewport:o.viewport,draggables:o.dimensions.draggables}),h=f.impact,m=f.didDropInsideDroppable,v=m?mR(h):null,g=m?Q5(h):null,y={index:c.draggable.index,droppableId:c.droppable.id},x={draggableId:u.descriptor.id,type:u.descriptor.type,source:y,reason:i,mode:o.movementMode,destination:v,combine:g},b=nrt({impact:h,draggable:u,dimensions:d,viewport:o.viewport,afterCritical:o.afterCritical}),w={critical:o.critical,afterCritical:o.afterCritical,result:x,impact:h},j=!xh(o.current.client.offset,b)||!!x.combine;if(!j){r(bR({completed:w}));return}var _=rrt({current:o.current.client.offset,destination:b,reason:i}),C={newHomeClientOffset:b,dropDuration:_,completed:w};r(Ytt(C))}}}},ose=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function ort(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||e()}}}function irt(e){var t=e.onWindowScroll;function r(){t(ose())}var n=Kw(r),s=ort(n),o=vh;function i(){return o!==vh}function l(){i()&&on(!1),o=vd(window,[s])}function c(){i()||on(!1),n.cancel(),o(),o=vh}return{start:l,stop:c,isActive:i}}var lrt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},crt=function(e){var t=irt({onWindowScroll:function(n){e.dispatch(Vtt({newScroll:n}))}});return function(r){return function(n){!t.isActive()&&n.type==="INITIAL_PUBLISH"&&t.start(),t.isActive()&&lrt(n)&&t.stop(),r(n)}}},drt=function(e){var t=!1,r=!1,n=setTimeout(function(){r=!0}),s=function(i){t||r||(t=!0,e(i),clearTimeout(n))};return s.wasCalled=function(){return t},s},urt=function(){var e=[],t=function(o){var i=fR(e,function(d){return d.timerId===o});i===-1&&on(!1);var l=e.splice(i,1),c=l[0];c.callback()},r=function(o){var i=setTimeout(function(){return t(i)}),l={timerId:i,callback:o};e.push(l)},n=function(){if(e.length){var o=[].concat(e);e.length=0,o.forEach(function(i){clearTimeout(i.timerId),i.callback()})}};return{add:r,flush:n}},frt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.droppableId===r.droppableId&&t.index===r.index},mrt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.draggableId===r.draggableId&&t.droppableId===r.droppableId},hrt=function(t,r){if(t===r)return!0;var n=t.draggable.id===r.draggable.id&&t.draggable.droppableId===r.draggable.droppableId&&t.draggable.type===r.draggable.type&&t.draggable.index===r.draggable.index,s=t.droppable.id===r.droppable.id&&t.droppable.type===r.droppable.type;return n&&s},vy=function(t,r){r()},vj=function(t,r){return{draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:r}},qE=function(t,r,n,s){if(!t){n(s(r));return}var o=drt(n),i={announce:o};t(r,i),o.wasCalled()||n(s(r))},prt=function(e,t){var r=urt(),n=null,s=function(h,m){n&&on(!1),vy("onBeforeCapture",function(){var v=e().onBeforeCapture;if(v){var g={draggableId:h,mode:m};v(g)}})},o=function(h,m){n&&on(!1),vy("onBeforeDragStart",function(){var v=e().onBeforeDragStart;v&&v(vj(h,m))})},i=function(h,m){n&&on(!1);var v=vj(h,m);n={mode:m,lastCritical:h,lastLocation:v.source,lastCombine:null},r.add(function(){vy("onDragStart",function(){return qE(e().onDragStart,v,t,n_.onDragStart)})})},l=function(h,m){var v=mR(m),g=Q5(m);n||on(!1);var y=!hrt(h,n.lastCritical);y&&(n.lastCritical=h);var x=!frt(n.lastLocation,v);x&&(n.lastLocation=v);var b=!mrt(n.lastCombine,g);if(b&&(n.lastCombine=g),!(!y&&!x&&!b)){var w=ea({},vj(h,n.mode),{combine:g,destination:v});r.add(function(){vy("onDragUpdate",function(){return qE(e().onDragUpdate,w,t,n_.onDragUpdate)})})}},c=function(){n||on(!1),r.flush()},d=function(h){n||on(!1),n=null,vy("onDragEnd",function(){return qE(e().onDragEnd,h,t,n_.onDragEnd)})},u=function(){if(n){var h=ea({},vj(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});d(h)}};return{beforeCapture:s,beforeStart:o,start:i,update:l,flush:c,drop:d,abort:u}},grt=function(e,t){var r=prt(e,t);return function(n){return function(s){return function(o){if(o.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(o.payload.draggableId,o.payload.movementMode);return}if(o.type==="INITIAL_PUBLISH"){var i=o.payload.critical;r.beforeStart(i,o.payload.movementMode),s(o),r.start(i,o.payload.movementMode);return}if(o.type==="DROP_COMPLETE"){var l=o.payload.completed.result;r.flush(),s(o),r.drop(l);return}if(s(o),o.type==="FLUSH"){r.abort();return}var c=n.getState();c.phase==="DRAGGING"&&r.update(c.critical,c.impact)}}}},vrt=function(e){return function(t){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){t(r);return}var n=e.getState();n.phase!=="DROP_ANIMATING"&&on(!1),e.dispatch(bR({completed:n.completed}))}}},xrt=function(e){var t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return function(s){return function(o){if((o.type==="FLUSH"||o.type==="DROP_COMPLETE"||o.type==="DROP_ANIMATION_FINISHED")&&n(),s(o),o.type==="DROP_ANIMATE"){var i={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var c=e.getState();c.phase==="DROP_ANIMATING"&&e.dispatch(ase())}};r=requestAnimationFrame(function(){r=null,t=vd(window,[i])})}}}},yrt=function(e){return function(){return function(t){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&e.stopPublishing(),t(r)}}}},brt=function(e){var t=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(n.type==="FLUSH"){t=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){t=!1;var s=n.payload.completed.result;s.combine&&e.tryShiftRecord(s.draggableId,s.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}},wrt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},jrt=function(e){return function(t){return function(r){return function(n){if(wrt(n)){e.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var s=t.getState();s.phase!=="DRAGGING"&&on(!1),e.start(s);return}r(n),e.scroll(t.getState())}}}},_rt=function(e){return function(t){return function(r){if(t(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(nse({reason:n.reason})))}}}},Nrt=fae,Srt=function(e){var t=e.dimensionMarshal,r=e.focusMarshal,n=e.styleMarshal,s=e.getResponders,o=e.announce,i=e.autoScroller;return uae(Mtt,Nrt(dZe(Ztt(n),yrt(t),Qtt(t),srt,vrt,xrt,_rt,jrt(i),crt,brt(r),grt(s,o))))},zE=function(){return{additions:{},removals:{},modified:{}}};function Crt(e){var t=e.registry,r=e.callbacks,n=zE(),s=null,o=function(){s||(r.collectionStarting(),s=requestAnimationFrame(function(){s=null;var u=n,f=u.additions,h=u.removals,m=u.modified,v=Object.keys(f).map(function(x){return t.draggable.getById(x).getDimension(hi)}).sort(function(x,b){return x.descriptor.index-b.descriptor.index}),g=Object.keys(m).map(function(x){var b=t.droppable.getById(x),w=b.callbacks.getScrollWhileDragging();return{droppableId:x,scroll:w}}),y={additions:v,removals:Object.keys(h),modified:g};n=zE(),r.publish(y)}))},i=function(u){var f=u.descriptor.id;n.additions[f]=u,n.modified[u.descriptor.droppableId]=!0,n.removals[f]&&delete n.removals[f],o()},l=function(u){var f=u.descriptor;n.removals[f.id]=!0,n.modified[f.droppableId]=!0,n.additions[f.id]&&delete n.additions[f.id],o()},c=function(){s&&(cancelAnimationFrame(s),s=null,n=zE())};return{add:i,remove:l,stop:c}}var ise=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,s=e.width,o=Ec({x:r,y:t},{x:s,y:n}),i={x:Math.max(0,o.x),y:Math.max(0,o.y)};return i},lse=function(){var e=document.documentElement;return e||on(!1),e},cse=function(){var e=lse(),t=ise({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight});return t},Art=function(){var e=ose(),t=cse(),r=e.y,n=e.x,s=lse(),o=s.clientWidth,i=s.clientHeight,l=n+o,c=r+i,d=tu({top:r,left:n,right:l,bottom:c}),u={frame:d,scroll:{initial:e,current:e,max:t,diff:{value:hi,displacement:hi}}};return u},Prt=function(e){var t=e.critical,r=e.scrollOptions,n=e.registry,s=Art(),o=s.scroll.current,i=t.droppable,l=n.droppable.getAllByType(i.type).map(function(f){return f.callbacks.getDimensionAndWatchScroll(o,r)}),c=n.draggable.getAllByType(t.draggable.type).map(function(f){return f.getDimension(o)}),d={draggables:Fae(c),droppables:Lae(l)},u={dimensions:d,critical:t,viewport:s};return u};function gU(e,t,r){if(r.descriptor.id===t.id||r.descriptor.type!==t.type)return!1;var n=e.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var Ert=function(e,t){var r=null,n=Crt({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),s=function(m,v){e.droppable.exists(m)||on(!1),r&&t.updateDroppableIsEnabled({id:m,isEnabled:v})},o=function(m,v){r&&(e.droppable.exists(m)||on(!1),t.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:v}))},i=function(m,v){r&&(e.droppable.exists(m)||on(!1),t.updateDroppableScroll({id:m,newScroll:v}))},l=function(m,v){r&&e.droppable.getById(m).callbacks.scroll(v)},c=function(){if(r){n.stop();var m=r.critical.droppable;e.droppable.getAllByType(m.type).forEach(function(v){return v.callbacks.dragStopped()}),r.unsubscribe(),r=null}},d=function(m){r||on(!1);var v=r.critical.draggable;m.type==="ADDITION"&&gU(e,v,m.value)&&n.add(m.value),m.type==="REMOVAL"&&gU(e,v,m.value)&&n.remove(m.value)},u=function(m){r&&on(!1);var v=e.draggable.getById(m.draggableId),g=e.droppable.getById(v.descriptor.droppableId),y={draggable:v.descriptor,droppable:g.descriptor},x=e.subscribe(d);return r={critical:y,unsubscribe:x},Prt({critical:y,registry:e,scrollOptions:m.scrollOptions})},f={updateDroppableIsEnabled:s,updateDroppableIsCombineEnabled:o,scrollDroppable:l,updateDroppableScroll:i,startPublishing:u,stopPublishing:c};return f},dse=function(e,t){return e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP"},krt=function(e){window.scrollBy(e.x,e.y)},Irt=mi(function(e){return J5(e).filter(function(t){return!(!t.isEnabled||!t.frame)})}),Ort=function(t,r){var n=Gh(Irt(r),function(s){return s.frame||on(!1),Kae(s.frame.pageMarginBox)(t)});return n},Trt=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var s=n[r];return s.frame?s:null}var o=Ort(t,n);return o},yh={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(t){return Math.pow(t,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},Drt=function(e,t){var r=e[t.size]*yh.startFromPercentage,n=e[t.size]*yh.maxScrollAtPercentage,s={startScrollingFrom:r,maxScrollValueAt:n};return s},use=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,s=r-t;if(s===0)return 0;var o=n-t,i=o/s;return i},_R=1,Mrt=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return yh.maxPixelScroll;if(e===t.startScrollingFrom)return _R;var r=use({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=1-r,s=yh.maxPixelScroll*yh.ease(n);return Math.ceil(s)},vU=yh.durationDampening.accelerateAt,xU=yh.durationDampening.stopDampeningAt,Rrt=function(e,t){var r=t,n=xU,s=Date.now(),o=s-r;if(o>=xU)return e;if(o<vU)return _R;var i=use({startOfRange:vU,endOfRange:n,current:o}),l=e*yh.ease(i);return Math.ceil(l)},yU=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,s=e.shouldUseTimeDampening,o=Mrt(t,r);return o===0?0:s?Math.max(Rrt(o,n),_R):o},bU=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,s=e.axis,o=e.shouldUseTimeDampening,i=Drt(t,s),l=r[s.end]<r[s.start];return l?yU({distanceToEdge:r[s.end],thresholds:i,dragStartTime:n,shouldUseTimeDampening:o}):-1*yU({distanceToEdge:r[s.start],thresholds:i,dragStartTime:n,shouldUseTimeDampening:o})},Lrt=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,s=r.height>t.height,o=r.width>t.width;return!o&&!s?n:o&&s?null:{x:o?0:n.x,y:s?0:n.y}},Frt=Mae(function(e){return e===0?0:e}),fse=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,s=e.center,o=e.shouldUseTimeDampening,i={top:s.y-r.top,right:r.right-s.x,bottom:r.bottom-s.y,left:s.x-r.left},l=bU({container:r,distanceToEdges:i,dragStartTime:t,axis:hR,shouldUseTimeDampening:o}),c=bU({container:r,distanceToEdges:i,dragStartTime:t,axis:qae,shouldUseTimeDampening:o}),d=Frt({x:c,y:l});if(xh(d,hi))return null;var u=Lrt({container:r,subject:n,proposedScroll:d});return u?xh(u,hi)?null:u:null},$rt=Mae(function(e){return e===0?0:e>0?1:-1}),NR=function(){var e=function(r,n){return r<0?r:r>n?r-n:0};return function(t){var r=t.current,n=t.max,s=t.change,o=Oi(r,s),i={x:e(o.x,n.x),y:e(o.y,n.y)};return xh(i,hi)?null:i}}(),mse=function(t){var r=t.max,n=t.current,s=t.change,o={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},i=$rt(s),l=NR({max:o,current:n,change:i});return!l||i.x!==0&&l.x===0||i.y!==0&&l.y===0},SR=function(t,r){return mse({current:t.scroll.current,max:t.scroll.max,change:r})},Brt=function(t,r){if(!SR(t,r))return null;var n=t.scroll.max,s=t.scroll.current;return NR({current:s,max:n,change:r})},CR=function(t,r){var n=t.frame;return n?mse({current:n.scroll.current,max:n.scroll.max,change:r}):!1},qrt=function(t,r){var n=t.frame;return!n||!CR(t,r)?null:NR({current:n.scroll.current,max:n.scroll.max,change:r})},zrt=function(e){var t=e.viewport,r=e.subject,n=e.center,s=e.dragStartTime,o=e.shouldUseTimeDampening,i=fse({dragStartTime:s,container:t.frame,subject:r,center:n,shouldUseTimeDampening:o});return i&&SR(t,i)?i:null},Urt=function(e){var t=e.droppable,r=e.subject,n=e.center,s=e.dragStartTime,o=e.shouldUseTimeDampening,i=t.frame;if(!i)return null;var l=fse({dragStartTime:s,container:i.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:o});return l&&CR(t,l)?l:null},wU=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,s=e.scrollWindow,o=e.scrollDroppable,i=t.current.page.borderBoxCenter,l=t.dimensions.draggables[t.critical.draggable.id],c=l.page.marginBox;if(t.isWindowScrollAllowed){var d=t.viewport,u=zrt({dragStartTime:r,viewport:d,subject:c,center:i,shouldUseTimeDampening:n});if(u){s(u);return}}var f=Trt({center:i,destination:Mc(t.impact),droppables:t.dimensions.droppables});if(f){var h=Urt({dragStartTime:r,droppable:f,subject:c,center:i,shouldUseTimeDampening:n});h&&o(f.descriptor.id,h)}},Vrt=function(e){var t=e.scrollWindow,r=e.scrollDroppable,n=Kw(t),s=Kw(r),o=null,i=function(u){o||on(!1);var f=o,h=f.shouldUseTimeDampening,m=f.dragStartTime;wU({state:u,scrollWindow:n,scrollDroppable:s,dragStartTime:m,shouldUseTimeDampening:h})},l=function(u){o&&on(!1);var f=Date.now(),h=!1,m=function(){h=!0};wU({state:u,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m}),o={dragStartTime:f,shouldUseTimeDampening:h},h&&i(u)},c=function(){o&&(n.cancel(),s.cancel(),o=null)};return{start:l,stop:c,scroll:i}},Wrt=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow,s=function(d,u){var f=Oi(d.current.client.selection,u);t({client:f})},o=function(d,u){if(!CR(d,u))return u;var f=qrt(d,u);if(!f)return r(d.descriptor.id,u),null;var h=Ec(u,f);r(d.descriptor.id,h);var m=Ec(u,h);return m},i=function(d,u,f){if(!d||!SR(u,f))return f;var h=Brt(u,f);if(!h)return n(f),null;var m=Ec(f,h);n(m);var v=Ec(f,m);return v},l=function(d){var u=d.scrollJumpRequest;if(u){var f=Mc(d.impact);f||on(!1);var h=o(d.dimensions.droppables[f],u);if(h){var m=d.viewport,v=i(d.isWindowScrollAllowed,m,h);v&&s(d,v)}}};return l},Hrt=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,s=Vrt({scrollWindow:r,scrollDroppable:t}),o=Wrt({move:n,scrollWindow:r,scrollDroppable:t}),i=function(d){if(d.phase==="DRAGGING"){if(d.movementMode==="FLUID"){s.scroll(d);return}d.scrollJumpRequest&&o(d)}},l={scroll:i,start:s.start,stop:s.stop};return l},r0="data-rbd",n0=function(){var e=r0+"-drag-handle";return{base:e,draggableId:e+"-draggable-id",contextId:e+"-context-id"}}(),XT=function(){var e=r0+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Grt=function(){var e=r0+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),jU={contextId:r0+"-scroll-container-context-id"},Krt=function(t){return function(r){return"["+r+'="'+t+'"]'}},xy=function(t,r){return t.map(function(n){var s=n.styles[r];return s?n.selector+" { "+s+" }":""}).join(" ")},Xrt="pointer-events: none;",Yrt=function(e){var t=Krt(e),r=function(){var l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(n0.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:Xrt,dropAnimating:l}}}(),n=function(){var l=`
      transition: `+wb.outOfTheWay+`;
    `;return{selector:t(XT.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}}(),s={selector:t(Grt.contextId),styles:{always:"overflow-anchor: none;"}},o={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},i=[n,r,s,o];return{always:xy(i,"always"),resting:xy(i,"resting"),dragging:xy(i,"dragging"),dropAnimating:xy(i,"dropAnimating"),userCancel:xy(i,"userCancel")}},Rc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,UE=function(){var t=document.querySelector("head");return t||on(!1),t},_U=function(t){var r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.type="text/css",r};function Jrt(e,t){var r=Xa(function(){return Yrt(e)},[e]),n=p.useRef(null),s=p.useRef(null),o=Yn(mi(function(f){var h=s.current;h||on(!1),h.textContent=f}),[]),i=Yn(function(f){var h=n.current;h||on(!1),h.textContent=f},[]);Rc(function(){!n.current&&!s.current||on(!1);var f=_U(t),h=_U(t);return n.current=f,s.current=h,f.setAttribute(r0+"-always",e),h.setAttribute(r0+"-dynamic",e),UE().appendChild(f),UE().appendChild(h),i(r.always),o(r.resting),function(){var m=function(g){var y=g.current;y||on(!1),UE().removeChild(y),g.current=null};m(n),m(s)}},[t,i,o,r.always,r.resting,e]);var l=Yn(function(){return o(r.dragging)},[o,r.dragging]),c=Yn(function(f){if(f==="DROP"){o(r.dropAnimating);return}o(r.userCancel)},[o,r.dropAnimating,r.userCancel]),d=Yn(function(){s.current&&o(r.resting)},[o,r.resting]),u=Xa(function(){return{dragging:l,dropping:c,resting:d}},[l,c,d]);return u}var hse=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function tA(e){return e instanceof hse(e).HTMLElement}function Qrt(e,t){var r="["+n0.contextId+'="'+e+'"]',n=Rae(document.querySelectorAll(r));if(!n.length)return null;var s=Gh(n,function(o){return o.getAttribute(n0.draggableId)===t});return!s||!tA(s)?null:s}function Zrt(e){var t=p.useRef({}),r=p.useRef(null),n=p.useRef(null),s=p.useRef(!1),o=Yn(function(h,m){var v={id:h,focus:m};return t.current[h]=v,function(){var y=t.current,x=y[h];x!==v&&delete y[h]}},[]),i=Yn(function(h){var m=Qrt(e,h);m&&m!==document.activeElement&&m.focus()},[e]),l=Yn(function(h,m){r.current===h&&(r.current=m)},[]),c=Yn(function(){n.current||s.current&&(n.current=requestAnimationFrame(function(){n.current=null;var h=r.current;h&&i(h)}))},[i]),d=Yn(function(h){r.current=null;var m=document.activeElement;m&&m.getAttribute(n0.draggableId)===h&&(r.current=h)},[]);Rc(function(){return s.current=!0,function(){s.current=!1;var h=n.current;h&&cancelAnimationFrame(h)}},[]);var u=Xa(function(){return{register:o,tryRecordFocus:d,tryRestoreFocusRecorded:c,tryShiftRecord:l}},[o,d,c,l]);return u}function ent(){var e={draggables:{},droppables:{}},t=[];function r(f){return t.push(f),function(){var m=t.indexOf(f);m!==-1&&t.splice(m,1)}}function n(f){t.length&&t.forEach(function(h){return h(f)})}function s(f){return e.draggables[f]||null}function o(f){var h=s(f);return h||on(!1),h}var i={register:function(h){e.draggables[h.descriptor.id]=h,n({type:"ADDITION",value:h})},update:function(h,m){var v=e.draggables[m.descriptor.id];v&&v.uniqueId===h.uniqueId&&(delete e.draggables[m.descriptor.id],e.draggables[h.descriptor.id]=h)},unregister:function(h){var m=h.descriptor.id,v=s(m);v&&h.uniqueId===v.uniqueId&&(delete e.draggables[m],n({type:"REMOVAL",value:h}))},getById:o,findById:s,exists:function(h){return!!s(h)},getAllByType:function(h){return _S(e.draggables).filter(function(m){return m.descriptor.type===h})}};function l(f){return e.droppables[f]||null}function c(f){var h=l(f);return h||on(!1),h}var d={register:function(h){e.droppables[h.descriptor.id]=h},unregister:function(h){var m=l(h.descriptor.id);m&&h.uniqueId===m.uniqueId&&delete e.droppables[h.descriptor.id]},getById:c,findById:l,exists:function(h){return!!l(h)},getAllByType:function(h){return _S(e.droppables).filter(function(m){return m.descriptor.type===h})}};function u(){e.draggables={},e.droppables={},t.length=0}return{draggable:i,droppable:d,subscribe:r,clean:u}}function tnt(){var e=Xa(ent,[]);return p.useEffect(function(){return function(){requestAnimationFrame(e.clean)}},[e]),e}var AR=Se.createContext(null),SS=function(){var e=document.body;return e||on(!1),e},rnt={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},nnt=function(t){return"rbd-announcement-"+t};function ant(e){var t=Xa(function(){return nnt(e)},[e]),r=p.useRef(null);p.useEffect(function(){var o=document.createElement("div");return r.current=o,o.id=t,o.setAttribute("aria-live","assertive"),o.setAttribute("aria-atomic","true"),ea(o.style,rnt),SS().appendChild(o),function(){setTimeout(function(){var c=SS();c.contains(o)&&c.removeChild(o),o===r.current&&(r.current=null)})}},[t]);var n=Yn(function(s){var o=r.current;if(o){o.textContent=s;return}},[]);return n}var snt=0,ont={separator:"::"};function PR(e,t){return t===void 0&&(t=ont),Xa(function(){return""+e+t.separator+snt++},[t.separator,e])}function int(e){var t=e.contextId,r=e.uniqueId;return"rbd-hidden-text-"+t+"-"+r}function lnt(e){var t=e.contextId,r=e.text,n=PR("hidden-text",{separator:"-"}),s=Xa(function(){return int({contextId:t,uniqueId:n})},[n,t]);return p.useEffect(function(){var i=document.createElement("div");return i.id=s,i.textContent=r,i.style.display="none",SS().appendChild(i),function(){var c=SS();c.contains(i)&&c.removeChild(i)}},[s,r]),s}var rA=Se.createContext(null);function pse(e){var t=p.useRef(e);return p.useEffect(function(){t.current=e}),t}function cnt(){var e=null;function t(){return!!e}function r(i){return i===e}function n(i){e&&on(!1);var l={abandon:i};return e=l,l}function s(){e||on(!1),e=null}function o(){e&&(e.abandon(),s())}return{isClaimed:t,isActive:r,claim:n,release:s,tryAbandon:o}}var dnt=9,unt=13,ER=27,gse=32,fnt=33,mnt=34,hnt=35,pnt=36,gnt=37,vnt=38,xnt=39,ynt=40,xj,bnt=(xj={},xj[unt]=!0,xj[dnt]=!0,xj),vse=function(e){bnt[e.keyCode]&&e.preventDefault()},nA=function(){var e="visibilitychange";if(typeof document>"u")return e;var t=[e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],r=Gh(t,function(n){return"on"+n in document});return r||e}(),xse=0,NU=5;function wnt(e,t){return Math.abs(t.x-e.x)>=NU||Math.abs(t.y-e.y)>=NU}var SU={type:"IDLE"};function jnt(e){var t=e.cancel,r=e.completed,n=e.getPhase,s=e.setPhase;return[{eventName:"mousemove",fn:function(i){var l=i.button,c=i.clientX,d=i.clientY;if(l===xse){var u={x:c,y:d},f=n();if(f.type==="DRAGGING"){i.preventDefault(),f.actions.move(u);return}f.type!=="PENDING"&&on(!1);var h=f.point;if(wnt(h,u)){i.preventDefault();var m=f.actions.fluidLift(u);s({type:"DRAGGING",actions:m})}}}},{eventName:"mouseup",fn:function(i){var l=n();if(l.type!=="DRAGGING"){t();return}i.preventDefault(),l.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(i){n().type==="DRAGGING"&&i.preventDefault(),t()}},{eventName:"keydown",fn:function(i){var l=n();if(l.type==="PENDING"){t();return}if(i.keyCode===ER){i.preventDefault(),t();return}vse(i)}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&t()}},{eventName:"webkitmouseforcedown",fn:function(i){var l=n();if(l.type==="IDLE"&&on(!1),l.actions.shouldRespectForcePress()){t();return}i.preventDefault()}},{eventName:nA,fn:t}]}function _nt(e){var t=p.useRef(SU),r=p.useRef(vh),n=Xa(function(){return{eventName:"mousedown",fn:function(f){if(!f.defaultPrevented&&f.button===xse&&!(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)){var h=e.findClosestDraggableId(f);if(h){var m=e.tryGetLock(h,i,{sourceEvent:f});if(m){f.preventDefault();var v={x:f.clientX,y:f.clientY};r.current(),d(m,v)}}}}}},[e]),s=Xa(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(f){if(!f.defaultPrevented){var h=e.findClosestDraggableId(f);if(h){var m=e.findOptionsForDraggable(h);m&&(m.shouldRespectForcePress||e.canGetLock(h)&&f.preventDefault())}}}}},[e]),o=Yn(function(){var f={passive:!1,capture:!0};r.current=vd(window,[s,n],f)},[s,n]),i=Yn(function(){var u=t.current;u.type!=="IDLE"&&(t.current=SU,r.current(),o())},[o]),l=Yn(function(){var u=t.current;i(),u.type==="DRAGGING"&&u.actions.cancel({shouldBlockNextClick:!0}),u.type==="PENDING"&&u.actions.abort()},[i]),c=Yn(function(){var f={capture:!0,passive:!1},h=jnt({cancel:l,completed:i,getPhase:function(){return t.current},setPhase:function(v){t.current=v}});r.current=vd(window,h,f)},[l,i]),d=Yn(function(f,h){t.current.type!=="IDLE"&&on(!1),t.current={type:"PENDING",point:h,actions:f},c()},[c]);Rc(function(){return o(),function(){r.current()}},[o])}var iv;function Nnt(){}var Snt=(iv={},iv[mnt]=!0,iv[fnt]=!0,iv[pnt]=!0,iv[hnt]=!0,iv);function Cnt(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:function(o){if(o.keyCode===ER){o.preventDefault(),r();return}if(o.keyCode===gse){o.preventDefault(),n();return}if(o.keyCode===ynt){o.preventDefault(),e.moveDown();return}if(o.keyCode===vnt){o.preventDefault(),e.moveUp();return}if(o.keyCode===xnt){o.preventDefault(),e.moveRight();return}if(o.keyCode===gnt){o.preventDefault(),e.moveLeft();return}if(Snt[o.keyCode]){o.preventDefault();return}vse(o)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:nA,fn:r}]}function Ant(e){var t=p.useRef(Nnt),r=Xa(function(){return{eventName:"keydown",fn:function(o){if(o.defaultPrevented||o.keyCode!==gse)return;var i=e.findClosestDraggableId(o);if(!i)return;var l=e.tryGetLock(i,u,{sourceEvent:o});if(!l)return;o.preventDefault();var c=!0,d=l.snapLift();t.current();function u(){c||on(!1),c=!1,t.current(),n()}t.current=vd(window,Cnt(d,u),{capture:!0,passive:!1})}}},[e]),n=Yn(function(){var o={passive:!1,capture:!0};t.current=vd(window,[r],o)},[r]);Rc(function(){return n(),function(){t.current()}},[n])}var VE={type:"IDLE"},Pnt=120,Ent=.15;function knt(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(s){s.preventDefault()}},{eventName:"keydown",fn:function(s){if(r().type!=="DRAGGING"){t();return}s.keyCode===ER&&s.preventDefault(),t()}},{eventName:nA,fn:t}]}function Int(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(o){var i=n();if(i.type!=="DRAGGING"){t();return}i.hasMoved=!0;var l=o.touches[0],c=l.clientX,d=l.clientY,u={x:c,y:d};o.preventDefault(),i.actions.move(u)}},{eventName:"touchend",fn:function(o){var i=n();if(i.type!=="DRAGGING"){t();return}o.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(o){if(n().type!=="DRAGGING"){t();return}o.preventDefault(),t()}},{eventName:"touchforcechange",fn:function(o){var i=n();i.type==="IDLE"&&on(!1);var l=o.touches[0];if(l){var c=l.force>=Ent;if(c){var d=i.actions.shouldRespectForcePress();if(i.type==="PENDING"){d&&t();return}if(d){if(i.hasMoved){o.preventDefault();return}t();return}o.preventDefault()}}}},{eventName:nA,fn:t}]}function Ont(e){var t=p.useRef(VE),r=p.useRef(vh),n=Yn(function(){return t.current},[]),s=Yn(function(m){t.current=m},[]),o=Xa(function(){return{eventName:"touchstart",fn:function(m){if(!m.defaultPrevented){var v=e.findClosestDraggableId(m);if(v){var g=e.tryGetLock(v,l,{sourceEvent:m});if(g){var y=m.touches[0],x=y.clientX,b=y.clientY,w={x,y:b};r.current(),f(g,w)}}}}}},[e]),i=Yn(function(){var m={capture:!0,passive:!1};r.current=vd(window,[o],m)},[o]),l=Yn(function(){var h=t.current;h.type!=="IDLE"&&(h.type==="PENDING"&&clearTimeout(h.longPressTimerId),s(VE),r.current(),i())},[i,s]),c=Yn(function(){var h=t.current;l(),h.type==="DRAGGING"&&h.actions.cancel({shouldBlockNextClick:!0}),h.type==="PENDING"&&h.actions.abort()},[l]),d=Yn(function(){var m={capture:!0,passive:!1},v={cancel:c,completed:l,getPhase:n},g=vd(window,Int(v),m),y=vd(window,knt(v),m);r.current=function(){g(),y()}},[c,n,l]),u=Yn(function(){var m=n();m.type!=="PENDING"&&on(!1);var v=m.actions.fluidLift(m.point);s({type:"DRAGGING",actions:v,hasMoved:!1})},[n,s]),f=Yn(function(m,v){n().type!=="IDLE"&&on(!1);var g=setTimeout(u,Pnt);s({type:"PENDING",point:v,actions:m,longPressTimerId:g}),d()},[d,n,s,u]);Rc(function(){return i(),function(){r.current();var v=n();v.type==="PENDING"&&(clearTimeout(v.longPressTimerId),s(VE))}},[n,i,s]),Rc(function(){var m=vd(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return m},[])}var Tnt={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function yse(e,t){if(t==null)return!1;var r=!!Tnt[t.tagName.toLowerCase()];if(r)return!0;var n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:yse(e,t.parentElement)}function Dnt(e,t){var r=t.target;return tA(r)?yse(e,r):!1}var Mnt=function(e){return tu(e.getBoundingClientRect()).center};function Rnt(e){return e instanceof hse(e).Element}var Lnt=function(){var e="matches";if(typeof document>"u")return e;var t=[e,"msMatchesSelector","webkitMatchesSelector"],r=Gh(t,function(n){return n in Element.prototype});return r||e}();function bse(e,t){return e==null?null:e[Lnt](t)?e:bse(e.parentElement,t)}function Fnt(e,t){return e.closest?e.closest(t):bse(e,t)}function $nt(e){return"["+n0.contextId+'="'+e+'"]'}function Bnt(e,t){var r=t.target;if(!Rnt(r))return null;var n=$nt(e),s=Fnt(r,n);return!s||!tA(s)?null:s}function qnt(e,t){var r=Bnt(e,t);return r?r.getAttribute(n0.draggableId):null}function znt(e,t){var r="["+XT.contextId+'="'+e+'"]',n=Rae(document.querySelectorAll(r)),s=Gh(n,function(o){return o.getAttribute(XT.id)===t});return!s||!tA(s)?null:s}function Unt(e){e.preventDefault()}function yj(e){var t=e.expected,r=e.phase,n=e.isLockActive;return e.shouldWarn,!(!n()||t!==r)}function wse(e){var t=e.lockAPI,r=e.store,n=e.registry,s=e.draggableId;if(t.isClaimed())return!1;var o=n.draggable.findById(s);return!(!o||!o.options.isEnabled||!dse(r.getState(),s))}function Vnt(e){var t=e.lockAPI,r=e.contextId,n=e.store,s=e.registry,o=e.draggableId,i=e.forceSensorStop,l=e.sourceEvent,c=wse({lockAPI:t,store:n,registry:s,draggableId:o});if(!c)return null;var d=s.draggable.getById(o),u=znt(r,d.descriptor.id);if(!u||l&&!d.options.canDragInteractiveElements&&Dnt(u,l))return null;var f=t.claim(i||vh),h="PRE_DRAG";function m(){return d.options.shouldRespectForcePress}function v(){return t.isActive(f)}function g(C,P){yj({expected:C,phase:h,isLockActive:v,shouldWarn:!0})&&n.dispatch(P())}var y=g.bind(null,"DRAGGING");function x(C){function P(){t.release(),h="COMPLETED"}h!=="PRE_DRAG"&&(P(),h!=="PRE_DRAG"&&on(!1)),n.dispatch(Ltt(C.liftActionArgs)),h="DRAGGING";function E(A,F){if(F===void 0&&(F={shouldBlockNextClick:!1}),C.cleanup(),F.shouldBlockNextClick){var D=vd(window,[{eventName:"click",fn:Unt,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(D)}P(),n.dispatch(nse({reason:A}))}return ea({isActive:function(){return yj({expected:"DRAGGING",phase:h,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:m,drop:function(F){return E("DROP",F)},cancel:function(F){return E("CANCEL",F)}},C.actions)}function b(C){var P=Kw(function(A){y(function(){return rse({client:A})})}),E=x({liftActionArgs:{id:o,clientSelection:C,movementMode:"FLUID"},cleanup:function(){return P.cancel()},actions:{move:P}});return ea({},E,{move:P})}function w(){var C={moveUp:function(){return y(Htt)},moveRight:function(){return y(Ktt)},moveDown:function(){return y(Gtt)},moveLeft:function(){return y(Xtt)}};return x({liftActionArgs:{id:o,clientSelection:Mnt(u),movementMode:"SNAP"},cleanup:vh,actions:C})}function j(){var C=yj({expected:"PRE_DRAG",phase:h,isLockActive:v,shouldWarn:!0});C&&t.release()}var _={isActive:function(){return yj({expected:"PRE_DRAG",phase:h,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:m,fluidLift:b,snapLift:w,abort:j};return _}var Wnt=[_nt,Ant,Ont];function Hnt(e){var t=e.contextId,r=e.store,n=e.registry,s=e.customSensors,o=e.enableDefaultSensors,i=[].concat(o?Wnt:[],s||[]),l=p.useState(function(){return cnt()})[0],c=Yn(function(b,w){b.isDragging&&!w.isDragging&&l.tryAbandon()},[l]);Rc(function(){var b=r.getState(),w=r.subscribe(function(){var j=r.getState();c(b,j),b=j});return w},[l,r,c]),Rc(function(){return l.tryAbandon},[l.tryAbandon]);for(var d=Yn(function(x){return wse({lockAPI:l,registry:n,store:r,draggableId:x})},[l,n,r]),u=Yn(function(x,b,w){return Vnt({lockAPI:l,registry:n,contextId:t,store:r,draggableId:x,forceSensorStop:b,sourceEvent:w&&w.sourceEvent?w.sourceEvent:null})},[t,l,n,r]),f=Yn(function(x){return qnt(t,x)},[t]),h=Yn(function(x){var b=n.draggable.findById(x);return b?b.options:null},[n.draggable]),m=Yn(function(){l.isClaimed()&&(l.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(yR()))},[l,r]),v=Yn(l.isClaimed,[l]),g=Xa(function(){return{canGetLock:d,tryGetLock:u,findClosestDraggableId:f,findOptionsForDraggable:h,tryReleaseLock:m,isLockClaimed:v}},[d,u,f,h,m,v]),y=0;y<i.length;y++)i[y](g)}var Gnt=function(t){return{onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}};function yy(e){return e.current||on(!1),e.current}function Knt(e){var t=e.contextId,r=e.setCallbacks,n=e.sensors,s=e.nonce,o=e.dragHandleUsageInstructions,i=p.useRef(null),l=pse(e),c=Yn(function(){return Gnt(l.current)},[l]),d=ant(t),u=lnt({contextId:t,text:o}),f=Jrt(t,s),h=Yn(function(A){yy(i).dispatch(A)},[]),m=Xa(function(){return K9({publishWhileDragging:$tt,updateDroppableScroll:qtt,updateDroppableIsEnabled:ztt,updateDroppableIsCombineEnabled:Utt,collectionStarting:Btt},h)},[h]),v=tnt(),g=Xa(function(){return Ert(v,m)},[v,m]),y=Xa(function(){return Hrt(ea({scrollWindow:krt,scrollDroppable:g.scrollDroppable},K9({move:rse},h)))},[g.scrollDroppable,h]),x=Zrt(t),b=Xa(function(){return Srt({announce:d,autoScroller:y,dimensionMarshal:g,focusMarshal:x,getResponders:c,styleMarshal:f})},[d,y,g,x,c,f]);i.current=b;var w=Yn(function(){var A=yy(i),F=A.getState();F.phase!=="IDLE"&&A.dispatch(yR())},[]),j=Yn(function(){var A=yy(i).getState();return A.isDragging||A.phase==="DROP_ANIMATING"},[]),_=Xa(function(){return{isDragging:j,tryAbort:w}},[j,w]);r(_);var C=Yn(function(A){return dse(yy(i).getState(),A)},[]),P=Yn(function(){return gp(yy(i).getState())},[]),E=Xa(function(){return{marshal:g,focus:x,contextId:t,canLift:C,isMovementAllowed:P,dragHandleUsageInstructionsId:u,registry:v}},[t,g,u,x,C,P,v]);return Hnt({contextId:t,store:b,registry:v,customSensors:n,enableDefaultSensors:e.enableDefaultSensors!==!1}),p.useEffect(function(){return w},[w]),Se.createElement(rA.Provider,{value:E},Se.createElement(pZe,{context:AR,store:b},e.children))}var Xnt=0;function Ynt(){return Xa(function(){return""+Xnt++},[])}function Jnt(e){var t=Ynt(),r=e.dragHandleUsageInstructions||n_.dragHandleUsageInstructions;return Se.createElement(Aet,null,function(n){return Se.createElement(Knt,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)})}var jse=function(t){return function(r){return t===r}},Qnt=jse("scroll"),Znt=jse("auto"),CU=function(t,r){return r(t.overflowX)||r(t.overflowY)},eat=function(t){var r=window.getComputedStyle(t),n={overflowX:r.overflowX,overflowY:r.overflowY};return CU(n,Qnt)||CU(n,Znt)},tat=function(){return!1},rat=function e(t){return t==null?null:t===document.body?tat()?t:null:t===document.documentElement?null:eat(t)?t:e(t.parentElement)},YT=function(e){return{x:e.scrollLeft,y:e.scrollTop}},nat=function e(t){if(!t)return!1;var r=window.getComputedStyle(t);return r.position==="fixed"?!0:e(t.parentElement)},aat=function(e){var t=rat(e),r=nat(e);return{closestScrollable:t,isFixedOnPage:r}},sat=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,s=e.isFixedOnPage,o=e.direction,i=e.client,l=e.page,c=e.closest,d=function(){if(!c)return null;var m=c.scrollSize,v=c.client,g=ise({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:v.paddingBox.height,width:v.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:v,scrollSize:m,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:g,diff:{value:hi,displacement:hi}}}}(),u=o==="vertical"?hR:qae,f=t0({page:l,withPlaceholder:null,axis:u,frame:d}),h={descriptor:t,isCombineEnabled:n,isFixedOnPage:s,axis:u,isEnabled:r,client:i,page:l,frame:d,subject:f};return h},oat=function(t,r){var n=Iae(t);if(!r||t!==r)return n;var s=n.paddingBox.top-r.scrollTop,o=n.paddingBox.left-r.scrollLeft,i=s+r.scrollHeight,l=o+r.scrollWidth,c={top:s,right:l,bottom:i,left:o},d=cR(c,n.border),u=dR({borderBox:d,margin:n.margin,border:n.border,padding:n.padding});return u},iat=function(e){var t=e.ref,r=e.descriptor,n=e.env,s=e.windowScroll,o=e.direction,i=e.isDropDisabled,l=e.isCombineEnabled,c=e.shouldClipSubject,d=n.closestScrollable,u=oat(t,d),f=bS(u,s),h=function(){if(!d)return null;var v=Iae(d),g={scrollHeight:d.scrollHeight,scrollWidth:d.scrollWidth};return{client:v,page:bS(v,s),scroll:YT(d),scrollSize:g,shouldClipSubject:c}}(),m=sat({descriptor:r,isEnabled:!i,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:o,client:u,page:f,closest:h});return m},lat={passive:!1},cat={passive:!0},AU=function(e){return e.shouldPublishImmediately?lat:cat};function CS(e){var t=p.useContext(e);return t||on(!1),t}var bj=function(t){return t&&t.env.closestScrollable||null};function dat(e){var t=p.useRef(null),r=CS(rA),n=PR("droppable"),s=r.registry,o=r.marshal,i=pse(e),l=Xa(function(){return{id:e.droppableId,type:e.type,mode:e.mode}},[e.droppableId,e.mode,e.type]),c=p.useRef(l),d=Xa(function(){return mi(function(j,_){t.current||on(!1);var C={x:j,y:_};o.updateDroppableScroll(l.id,C)})},[l.id,o]),u=Yn(function(){var j=t.current;return!j||!j.env.closestScrollable?hi:YT(j.env.closestScrollable)},[]),f=Yn(function(){var j=u();d(j.x,j.y)},[u,d]),h=Xa(function(){return Kw(f)},[f]),m=Yn(function(){var j=t.current,_=bj(j);j&&_||on(!1);var C=j.scrollOptions;if(C.shouldPublishImmediately){f();return}h()},[h,f]),v=Yn(function(j,_){t.current&&on(!1);var C=i.current,P=C.getDroppableRef();P||on(!1);var E=aat(P),A={ref:P,descriptor:l,env:E,scrollOptions:_};t.current=A;var F=iat({ref:P,descriptor:l,env:E,windowScroll:j,direction:C.direction,isDropDisabled:C.isDropDisabled,isCombineEnabled:C.isCombineEnabled,shouldClipSubject:!C.ignoreContainerClipping}),D=E.closestScrollable;return D&&(D.setAttribute(jU.contextId,r.contextId),D.addEventListener("scroll",m,AU(A.scrollOptions))),F},[r.contextId,l,m,i]),g=Yn(function(){var j=t.current,_=bj(j);return j&&_||on(!1),YT(_)},[]),y=Yn(function(){var j=t.current;j||on(!1);var _=bj(j);t.current=null,_&&(h.cancel(),_.removeAttribute(jU.contextId),_.removeEventListener("scroll",m,AU(j.scrollOptions)))},[m,h]),x=Yn(function(j){var _=t.current;_||on(!1);var C=bj(_);C||on(!1),C.scrollTop+=j.y,C.scrollLeft+=j.x},[]),b=Xa(function(){return{getDimensionAndWatchScroll:v,getScrollWhileDragging:g,dragStopped:y,scroll:x}},[y,v,g,x]),w=Xa(function(){return{uniqueId:n,descriptor:l,callbacks:b}},[b,l,n]);Rc(function(){return c.current=w.descriptor,s.droppable.register(w),function(){t.current&&y(),s.droppable.unregister(w)}},[b,l,y,w,o,s.droppable]),Rc(function(){t.current&&o.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,o]),Rc(function(){t.current&&o.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,o])}function WE(){}var PU={width:0,height:0,margin:Tet},uat=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,s=t.animate;return r||s==="close"?PU:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},fat=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,s=t.animate,o=uat({isAnimatingOpenOnMount:r,placeholder:n,animate:s});return{display:n.display,boxSizing:"border-box",width:o.width,height:o.height,marginTop:o.margin.top,marginRight:o.margin.right,marginBottom:o.margin.bottom,marginLeft:o.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:s!=="none"?wb.placeholder:null}};function mat(e){var t=p.useRef(null),r=Yn(function(){t.current&&(clearTimeout(t.current),t.current=null)},[]),n=e.animate,s=e.onTransitionEnd,o=e.onClose,i=e.contextId,l=p.useState(e.animate==="open"),c=l[0],d=l[1];p.useEffect(function(){return c?n!=="open"?(r(),d(!1),WE):t.current?WE:(t.current=setTimeout(function(){t.current=null,d(!1)}),r):WE},[n,c,r]);var u=Yn(function(h){h.propertyName==="height"&&(s(),n==="close"&&o())},[n,o,s]),f=fat({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return Se.createElement(e.placeholder.tagName,{style:f,"data-rbd-placeholder-context-id":i,onTransitionEnd:u,ref:e.innerRef})}var hat=Se.memo(mat),kR=Se.createContext(null),pat=function(e){lZ(t,e);function t(){for(var n,s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}t.getDerivedStateFromProps=function(s,o){return s.shouldAnimate?s.on?{isVisible:!0,data:s.on,animate:"open"}:o.isVisible?{isVisible:!0,data:o.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!s.on,data:s.on,animate:"none"}};var r=t.prototype;return r.render=function(){if(!this.state.isVisible)return null;var s={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(s)},t}(Se.PureComponent),EU={dragging:5e3,dropAnimating:4500},gat=function(t,r){return r?wb.drop(r.duration):t?wb.snap:wb.fluid},vat=function(t,r){return t?r?Qw.opacity.drop:Qw.opacity.combining:null},xat=function(t){return t.forceShouldAnimate!=null?t.forceShouldAnimate:t.mode==="SNAP"};function yat(e){var t=e.dimension,r=t.client,n=e.offset,s=e.combineWith,o=e.dropping,i=!!s,l=xat(e),c=!!o,d=c?GT.drop(n,i):GT.moveTo(n),u={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:gat(l,o),transform:d,opacity:vat(i,c),zIndex:c?EU.dropAnimating:EU.dragging,pointerEvents:"none"};return u}function bat(e){return{transform:GT.moveTo(e.offset),transition:e.shouldAnimateDisplacement?null:"none"}}function wat(e){return e.type==="DRAGGING"?yat(e):bat(e)}function jat(e,t,r){r===void 0&&(r=hi);var n=window.getComputedStyle(t),s=t.getBoundingClientRect(),o=kae(s,n),i=bS(o,r),l={client:o,tagName:t.tagName.toLowerCase(),display:n.display},c={x:o.marginBox.width,y:o.marginBox.height},d={descriptor:e,placeholder:l,displaceBy:c,client:o,page:i};return d}function _at(e){var t=PR("draggable"),r=e.descriptor,n=e.registry,s=e.getDraggableRef,o=e.canDragInteractiveElements,i=e.shouldRespectForcePress,l=e.isEnabled,c=Xa(function(){return{canDragInteractiveElements:o,shouldRespectForcePress:i,isEnabled:l}},[o,l,i]),d=Yn(function(m){var v=s();return v||on(!1),jat(r,v,m)},[r,s]),u=Xa(function(){return{uniqueId:t,descriptor:r,options:c,getDimension:d}},[r,d,c,t]),f=p.useRef(u),h=p.useRef(!0);Rc(function(){return n.draggable.register(f.current),function(){return n.draggable.unregister(f.current)}},[n.draggable]),Rc(function(){if(h.current){h.current=!1;return}var m=f.current;f.current=u,n.draggable.update(u,m)},[u,n.draggable])}function Nat(e){e.preventDefault()}function Sat(e){var t=p.useRef(null),r=Yn(function(A){t.current=A},[]),n=Yn(function(){return t.current},[]),s=CS(rA),o=s.contextId,i=s.dragHandleUsageInstructionsId,l=s.registry,c=CS(kR),d=c.type,u=c.droppableId,f=Xa(function(){return{id:e.draggableId,index:e.index,type:d,droppableId:u}},[e.draggableId,e.index,d,u]),h=e.children,m=e.draggableId,v=e.isEnabled,g=e.shouldRespectForcePress,y=e.canDragInteractiveElements,x=e.isClone,b=e.mapped,w=e.dropAnimationFinished;if(!x){var j=Xa(function(){return{descriptor:f,registry:l,getDraggableRef:n,canDragInteractiveElements:y,shouldRespectForcePress:g,isEnabled:v}},[f,l,n,y,g,v]);_at(j)}var _=Xa(function(){return v?{tabIndex:0,role:"button","aria-describedby":i,"data-rbd-drag-handle-draggable-id":m,"data-rbd-drag-handle-context-id":o,draggable:!1,onDragStart:Nat}:null},[o,i,m,v]),C=Yn(function(A){b.type==="DRAGGING"&&b.dropping&&A.propertyName==="transform"&&w()},[w,b]),P=Xa(function(){var A=wat(b),F=b.type==="DRAGGING"&&b.dropping?C:null,D={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":o,"data-rbd-draggable-id":m,style:A,onTransitionEnd:F},dragHandleProps:_};return D},[o,_,m,b,C,r]),E=Xa(function(){return{draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}},[f.droppableId,f.id,f.index,f.type]);return h(P,b.snapshot,E)}var _se=function(e,t){return e===t},Nse=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null},Cat=function(t){return t.combine?t.combine.draggableId:null},Aat=function(t){return t.at&&t.at.type==="COMBINE"?t.at.combine.draggableId:null};function Pat(){var e=mi(function(s,o){return{x:s,y:o}}),t=mi(function(s,o,i,l,c){return{isDragging:!0,isClone:o,isDropAnimating:!!c,dropAnimation:c,mode:s,draggingOver:i,combineWith:l,combineTargetFor:null}}),r=mi(function(s,o,i,l,c,d,u){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:d,mode:o,offset:s,dimension:i,forceShouldAnimate:u,snapshot:t(o,l,c,d,null)}}}),n=function(o,i){if(o.isDragging){if(o.critical.draggable.id!==i.draggableId)return null;var l=o.current.client.offset,c=o.dimensions.draggables[i.draggableId],d=Mc(o.impact),u=Aat(o.impact),f=o.forceShouldAnimate;return r(e(l.x,l.y),o.movementMode,c,i.isClone,d,u,f)}if(o.phase==="DROP_ANIMATING"){var h=o.completed;if(h.result.draggableId!==i.draggableId)return null;var m=i.isClone,v=o.dimensions.draggables[i.draggableId],g=h.result,y=g.mode,x=Nse(g),b=Cat(g),w=o.dropDuration,j={duration:w,curve:wR.drop,moveTo:o.newHomeClientOffset,opacity:b?Qw.opacity.drop:null,scale:b?Qw.scale.drop:null};return{mapped:{type:"DRAGGING",offset:o.newHomeClientOffset,dimension:v,dropping:j,draggingOver:x,combineWith:b,mode:y,forceShouldAnimate:null,snapshot:t(y,m,x,b,j)}}}return null};return n}function Sse(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var Eat={mapped:{type:"SECONDARY",offset:hi,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:Sse(null)}};function kat(){var e=mi(function(i,l){return{x:i,y:l}}),t=mi(Sse),r=mi(function(i,l,c){return l===void 0&&(l=null),{mapped:{type:"SECONDARY",offset:i,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:t(l)}}}),n=function(l){return l?r(hi,l,!0):null},s=function(l,c,d,u){var f=d.displaced.visible[l],h=!!(u.inVirtualList&&u.effected[l]),m=Q5(d),v=m&&m.draggableId===l?c:null;if(!f){if(!h)return n(v);if(d.displaced.invisible[l])return null;var g=M0(u.displacedBy.point),y=e(g.x,g.y);return r(y,v,!0)}if(h)return n(v);var x=d.displacedBy.point,b=e(x.x,x.y);return r(b,v,f.shouldAnimate)},o=function(l,c){if(l.isDragging)return l.critical.draggable.id===c.draggableId?null:s(c.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){var d=l.completed;return d.result.draggableId===c.draggableId?null:s(c.draggableId,d.result.draggableId,d.impact,d.afterCritical)}return null};return o}var Iat=function(){var t=Pat(),r=kat(),n=function(o,i){return t(o,i)||r(o,i)||Eat};return n},Oat={dropAnimationFinished:ase},Tat=Pae(Iat,Oat,null,{context:AR,pure:!0,areStatePropsEqual:_se})(Sat);function Cse(e){var t=CS(kR),r=t.isUsingCloneFor;return r===e.draggableId&&!e.isClone?null:Se.createElement(Tat,e)}function Dat(e){var t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return Se.createElement(Cse,ea({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function Mat(e){var t=p.useContext(rA);t||on(!1);var r=t.contextId,n=t.isMovementAllowed,s=p.useRef(null),o=p.useRef(null),i=e.children,l=e.droppableId,c=e.type,d=e.mode,u=e.direction,f=e.ignoreContainerClipping,h=e.isDropDisabled,m=e.isCombineEnabled,v=e.snapshot,g=e.useClone,y=e.updateViewportMaxScroll,x=e.getContainerForClone,b=Yn(function(){return s.current},[]),w=Yn(function(D){s.current=D},[]);Yn(function(){return o.current},[]);var j=Yn(function(D){o.current=D},[]),_=Yn(function(){n()&&y({maxScroll:cse()})},[n,y]);dat({droppableId:l,type:c,mode:d,direction:u,isDropDisabled:h,isCombineEnabled:m,ignoreContainerClipping:f,getDroppableRef:b});var C=Se.createElement(pat,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},function(D){var I=D.onClose,R=D.data,M=D.animate;return Se.createElement(hat,{placeholder:R,onClose:I,innerRef:j,animate:M,contextId:r,onTransitionEnd:_})}),P=Xa(function(){return{innerRef:w,placeholder:C,droppableProps:{"data-rbd-droppable-id":l,"data-rbd-droppable-context-id":r}}},[r,l,C,w]),E=g?g.dragging.draggableId:null,A=Xa(function(){return{droppableId:l,type:c,isUsingCloneFor:E}},[l,E,c]);function F(){if(!g)return null;var D=g.dragging,I=g.render,R=Se.createElement(Cse,{draggableId:D.draggableId,index:D.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(M,U){return I(M,U,D)});return r4.createPortal(R,x())}return Se.createElement(kR.Provider,{value:A},i(P,v),F())}var HE=function(t,r){return t===r.droppable.type},kU=function(t,r){return r.draggables[t.draggable.id]},Rat=function(){var t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=ea({},t,{shouldAnimatePlaceholder:!1}),n=mi(function(i){return{draggableId:i.id,type:i.type,source:{index:i.index,droppableId:i.droppableId}}}),s=mi(function(i,l,c,d,u,f){var h=u.descriptor.id,m=u.descriptor.droppableId===i;if(m){var v=f?{render:f,dragging:n(u.descriptor)}:null,g={isDraggingOver:c,draggingOverWith:c?h:null,draggingFromThisWith:h,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!1,snapshot:g,useClone:v}}if(!l)return r;if(!d)return t;var y={isDraggingOver:c,draggingOverWith:h,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!0,snapshot:y,useClone:null}}),o=function(l,c){var d=c.droppableId,u=c.type,f=!c.isDropDisabled,h=c.renderClone;if(l.isDragging){var m=l.critical;if(!HE(u,m))return r;var v=kU(m,l.dimensions),g=Mc(l.impact)===d;return s(d,f,g,g,v,h)}if(l.phase==="DROP_ANIMATING"){var y=l.completed;if(!HE(u,y.critical))return r;var x=kU(y.critical,l.dimensions);return s(d,f,Nse(y.result)===d,Mc(y.impact)===d,x,h)}if(l.phase==="IDLE"&&l.completed&&!l.shouldFlush){var b=l.completed;if(!HE(u,b.critical))return r;var w=Mc(b.impact)===d,j=!!(b.impact.at&&b.impact.at.type==="COMBINE"),_=b.critical.droppable.id===d;return w?j?t:r:_?t:r}return r};return o},Lat={updateViewportMaxScroll:Wtt};function Fat(){return document.body||on(!1),document.body}var $at={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Fat},Ase=Pae(Rat,Lat,null,{context:AR,pure:!0,areStatePropsEqual:_se})(Mat);Ase.defaultProps=$at;function lv({className:e,...t}){return a.jsx("div",{className:gr("animate-pulse rounded-md bg-muted/20",e),...t})}function aA(e){return{id:e.id,code:e.codigo_produto??"",name:e.nome,category:e.categoria??"",type:e.tipo_produto==="uso_interno"?"Uso Interno":"Venda",cost:Number(e.valor_custo??e.preco_custo??0),price:Number(e.valor_venda??e.preco_venda??0),stock:Number(e.estoque??e.estoque_atual??0),minStock:Number(e.estoque_minimo??0),status:e.status??(e.ativo===!1||Number(e.estoque??0)===0?"inactive":Number(e.estoque??0)>0&&Number(e.estoque??0)<=Number(e.estoque_minimo??0)?"low_stock":"active"),validade:e.validade?new Date(e.validade):null,barcode:e.codigo_barras??"",barcodeBox:e.codigo_barras_caixa??"",reference:e.referencia??"",brand:e.marca??"",group:e.grupo??"",unit:e.unidade??"UN",initialStock:Number(e.estoque_inicial??0),currentStock:Number(e.estoque_atual??e.estoque??0),weight:e.peso!=null?Number(e.peso):null,buyPrice:e.preco_compra!=null?Number(e.preco_compra):null,costsPercent:e.custos_percent!=null?Number(e.custos_percent):null,costPrice:e.preco_custo!=null?Number(e.preco_custo):null,marginPercent:e.lucro_percent!=null?Number(e.lucro_percent):null,salePrice:e.preco_venda!=null?Number(e.preco_venda):null,wholesaleQty:e.qtd_atacado!=null?Number(e.qtd_atacado):null,wholesalePrice:e.preco_atacado!=null?Number(e.preco_atacado):null,commissionPercent:e.comissao_percent!=null?Number(e.comissao_percent):null,discountPercent:e.desconto_percent!=null?Number(e.desconto_percent):null,cfopInterno:e.cfop_interno??"",cstIcmsInterno:e.cst_icms_interno??"",csosnInterno:e.csosn_interno??"",aliqIcmsInterno:e.aliquota_icms_interno!=null?Number(e.aliquota_icms_interno):null,cfopExterno:e.cfop_externo??"",cstIcmsExterno:e.cst_icms_externo??"",csosnExterno:e.csosn_externo??"",aliqIcmsExterno:e.aliquota_icms_externo!=null?Number(e.aliquota_icms_externo):null,cstPisEntrada:e.cst_pis_entrada??"",cstPisSaida:e.cst_pis_saida??"",aliqPisPercent:e.aliquota_pis_percent!=null?Number(e.aliquota_pis_percent):null,aliqCofinsPercent:e.aliquota_cofins_percent!=null?Number(e.aliquota_cofins_percent):null,cstIpi:e.cst_ipi??"",aliqIpiPercent:e.aliquota_ipi_percent!=null?Number(e.aliquota_ipi_percent):null,fcpPercent:e.fcp_percent!=null?Number(e.fcp_percent):null,mvaPercent:e.mva_percent!=null?Number(e.mva_percent):null,baseReduzidaPercent:e.base_reduzida_percent!=null?Number(e.base_reduzida_percent):null,ncm:e.ncm??"",ncmDescription:e.descricao_ncm??"",cest:e.cest??"",active:e.ativo??!0,allowSale:e.permite_venda??!0,payCommission:e.paga_comissao??!1,variablePrice:e.preco_variavel??!1,composition:e.composicao??!1,service:e.servico??!1,hasGrid:e.grade??!1,usePriceTable:e.usar_tabela_preco??!1,fuel:e.combustivel??!1,useImei:e.usa_imei??!1,stockByGrid:e.controle_estoque_por_grade??!1,showInApp:e.mostrar_no_app??!1,dataImportacao:e.data_importacao?new Date(e.data_importacao):null,importadoViaXml:e.importado_via_xml??!1}}async function Bat({from:e,to:t,codigoEmpresa:r,limit:n=1e3}={}){if(!e||!t)throw new Error("Perodo invlido");const s=(e instanceof Date?e:new Date(e)).toISOString(),o=(t instanceof Date?t:new Date(t)).toISOString(),{data:i,error:l}=await Ro(v=>{let g=he.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",s).lte("created_at",o).limit(n).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},2e4,"Timeout getSoldProductsByPeriod (20s)");if(l)throw l;const c=new Map;for(const v of i||[]){const g=v.produto_id,y=Number(v.quantidade||0);c.set(g,(c.get(g)||0)+y)}const d=Array.from(c.entries()).sort((v,g)=>g[1]-v[1]);if(d.length===0)return[];const u=d.map(([v])=>v),{data:f,error:h}=await Ro(v=>{let g=he.from("produtos").select("id, nome").in("id",u).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},15e3,"Timeout getSoldProductsByPeriod:produtos (15s)");if(h)throw h;const m=new Map((f||[]).map(v=>[v.id,v.nome]));return d.map(([v,g])=>({id:v,name:m.get(v)||String(v),total:g}))}async function ix({productId:e,delta:t,codigoEmpresa:r}){const n=Number(t);if(!e||!Number.isFinite(n)||n===0)throw new Error("Parmetros invlidos para ajuste de estoque");const{data:s,error:o}=await Ro(d=>{let u=he.from("produtos").select("id, estoque, estoque_atual").eq("id",e).single().abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout get current stock (10s)");if(o)throw o;const l=Number(s?.estoque??s?.estoque_atual??0)+n,{error:c}=await Ro(d=>{let u=he.from("produtos").update({estoque:l,estoque_atual:l}).eq("id",e).abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout update stock (10s)");if(c)throw c;return{id:e,stock:l}}async function qat({limit:e=5,codigoEmpresa:t}={}){const r=new Date;r.setHours(0,0,0,0);const n=r.toISOString(),{data:s,error:o}=await Ro(h=>{let m=he.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",n).abortSignal(h);return t&&(m=m.eq("codigo_empresa",t)),m},15e3,"Timeout getMostSoldProductsToday (15s)");if(o)throw o;const i=new Map;for(const h of s||[]){const m=h.produto_id,v=Number(h.quantidade||0);i.set(m,(i.get(m)||0)+v)}const l=Array.from(i.entries()).sort((h,m)=>m[1]-h[1]).slice(0,e);if(l.length===0)return[];const c=l.map(([h])=>h),{data:d,error:u}=await Ro(h=>{let m=he.from("produtos").select("id, nome").in("id",c).abortSignal(h);return t&&(m=m.eq("codigo_empresa",t)),m},15e3,"Timeout getMostSoldProductsToday:produtos (15s)");if(u)throw u;const f=new Map((d||[]).map(h=>[h.id,h.nome]));return l.map(([h,m])=>({id:h,name:f.get(h)||String(h),total:m}))}async function IU({codigoEmpresa:e}={}){if(!e)throw new Error("codigoEmpresa  obrigatrio");const{data:t,error:r}=await Ro(l=>he.from("produtos").select("codigo_produto").eq("codigo_empresa",e).order("codigo_produto",{ascending:!0}).abortSignal(l),15e3,"Timeout getNextProductCode (15s)");if(r)throw r;const n=new Set;for(const l of t||[]){const c=(l.codigo_produto||"").trim();if(/^\d+$/.test(c)){const d=parseInt(c,10);Number.isFinite(d)&&d>0&&n.add(d)}}let s=1;const o=(n.size||0)+1e3;let i=0;for(;n.has(s)&&i<o;)s+=1,i+=1;return(!Number.isFinite(s)||s<=0)&&(s=1),String(s).padStart(4,"0")}function Pse(e){return{codigo_produto:e.code||null,nome:e.name,categoria:e.category||null,tipo_produto:e.type==="Uso Interno"?"uso_interno":"venda",valor_custo:e.cost!=null?Number(e.cost):0,valor_venda:e.price!=null?Number(e.price):0,estoque:e.stock!=null?Number(e.stock):0,estoque_minimo:e.minStock!=null?Number(e.minStock):0,status:e.status||null,validade:e.validade?new Date(e.validade).toISOString().slice(0,10):null,codigo_barras:e.barcode||null,codigo_barras_caixa:e.barcodeBox||null,referencia:e.reference||null,marca:e.brand||null,grupo:e.group||null,unidade:e.unit||null,estoque_inicial:e.initialStock!=null?Number(e.initialStock):null,estoque_atual:e.currentStock!=null?Number(e.currentStock):null,peso:e.weight!=null?Number(e.weight):null,preco_compra:e.buyPrice!=null?Number(e.buyPrice):null,custos_percent:e.costsPercent!=null?Number(e.costsPercent):null,preco_custo:e.costPrice!=null?Number(e.costPrice):null,lucro_percent:e.marginPercent!=null?Number(e.marginPercent):null,preco_venda:e.salePrice!=null?Number(e.salePrice):null,qtd_atacado:e.wholesaleQty!=null?Number(e.wholesaleQty):null,preco_atacado:e.wholesalePrice!=null?Number(e.wholesalePrice):null,comissao_percent:e.commissionPercent!=null?Number(e.commissionPercent):null,desconto_percent:e.discountPercent!=null?Number(e.discountPercent):null,cfop_interno:e.cfopInterno||null,cst_icms_interno:e.cstIcmsInterno||null,csosn_interno:e.csosnInterno||null,aliquota_icms_interno:e.aliqIcmsInterno!=null?Number(e.aliqIcmsInterno):null,cfop_externo:e.cfopExterno||null,cst_icms_externo:e.cstIcmsExterno||null,csosn_externo:e.csosnExterno||null,aliquota_icms_externo:e.aliqIcmsExterno!=null?Number(e.aliqIcmsExterno):null,cst_pis_entrada:e.cstPisEntrada||null,cst_pis_saida:e.cstPisSaida||null,aliquota_pis_percent:e.aliqPisPercent!=null?Number(e.aliqPisPercent):null,aliquota_cofins_percent:e.aliqCofinsPercent!=null?Number(e.aliqCofinsPercent):null,cst_ipi:e.cstIpi||null,aliquota_ipi_percent:e.aliqIpiPercent!=null?Number(e.aliqIpiPercent):null,fcp_percent:e.fcpPercent!=null?Number(e.fcpPercent):null,mva_percent:e.mvaPercent!=null?Number(e.mvaPercent):null,base_reduzida_percent:e.baseReduzidaPercent!=null?Number(e.baseReduzidaPercent):null,ncm:e.ncm||null,descricao_ncm:e.ncmDescription||null,cest:e.cest||null,ativo:e.active!=null?!!e.active:!0,permite_venda:e.allowSale!=null?!!e.allowSale:!0,paga_comissao:e.payCommission!=null?!!e.payCommission:!1,preco_variavel:e.variablePrice!=null?!!e.variablePrice:!1,composicao:e.composition!=null?!!e.composition:!1,servico:e.service!=null?!!e.service:!1,grade:e.hasGrid!=null?!!e.hasGrid:!1,usar_tabela_preco:e.usePriceTable!=null?!!e.usePriceTable:!1,combustivel:e.fuel!=null?!!e.fuel:!1,usa_imei:e.useImei!=null?!!e.useImei:!1,controle_estoque_por_grade:e.stockByGrid!=null?!!e.stockByGrid:!1,mostrar_no_app:e.showInApp!=null?!!e.showInApp:!1,importado_via_xml:e.importedViaXML===!0,data_importacao:e.dataImportacao?e.dataImportacao instanceof Date?e.dataImportacao.toISOString():new Date(e.dataImportacao).toISOString():null,xml_chave:e.xmlChave||null,xml_numero:e.xmlNumero||null,xml_serie:e.xmlSerie||null,xml_emissao:e.xmlEmissao?new Date(e.xmlEmissao).toISOString():null}}async function hu(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n}=e;console.log("[products.api] ====== listProducts INICIO ======"),console.log("[products.api] Parametros:",{includeInactive:t,search:r,codigoEmpresa:n});const{data:s,error:o}=await Ro(c=>{let d=he.from("produtos").select("*").eq("codigo_empresa",n).order("nome",{ascending:!0}).abortSignal(c);if(t||(d=d.neq("status","inactive"),d=d.or("ativo.is.null,ativo.eq.true"),console.log("[products.api] Filtro aplicado: status != inactive AND (ativo IS NULL OR ativo = true)")),r&&r.trim().length>0){const u=r.trim();d=d.or(`nome.ilike.%${u}%,codigo_produto.ilike.%${u}%`)}return d},15e3,"Timeout listProducts (15s)");if(o)throw console.error("[products.api] listProducts:error",o),o;const i=(s||[]).map(aA);console.log("[products.api] listProducts RETORNOU:",i.length,"produtos"),console.log("[products.api] includeInactive:",t),console.log("[products.api] Produtos:",i.map(c=>({id:c.id,name:c.name,code:c.code})));const l=i.filter(c=>!c.code||c.code.trim()==="");return console.log("[products.api] Produtos SEM cdigo:",l.length),l.length>0&&l.forEach(c=>{console.log("  -",c.name,"| active:",c.active,"| status:",c.status,"| code:",c.code||"NULL")}),i}async function zat(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n,page:s=1,pageSize:o=100}=e;if(!n)return{data:[],count:0};const i=s>0?s:1,l=o>0?o:100,c=(i-1)*l,d=c+l-1;console.log("[products.api] ====== listProductsPaged INICIO ======",{includeInactive:t,search:r,codigoEmpresa:n,page:i,pageSize:l});try{const{data:u,error:f,count:h}=await Ro(v=>{let g=he.from("produtos").select("*",{count:"exact"}).eq("codigo_empresa",n).order("nome",{ascending:!0}).range(c,d).abortSignal(v);if(t||(g=g.neq("status","inactive"),g=g.or("ativo.is.null,ativo.eq.true")),r&&r.trim().length>0){const y=r.trim();g=g.or(`nome.ilike.%${y}%,codigo_produto.ilike.%${y}%`)}return g},2e4,"Timeout listProductsPaged (20s)");if(f)throw console.error("[products.api] listProductsPaged:error",f),f;const m=(u||[]).map(aA);return console.log("[products.api] listProductsPaged RETORNOU:",m.length,"produtos de",h||0),{data:m,count:h||0}}catch(u){return console.error("[products.api] listProductsPaged:exception",u),{data:[],count:0}}}async function AS(e,t={}){const{codigoEmpresa:r}=t,n=Pse(e);r&&(n.codigo_empresa=r),console.info("[products.api] createProduct: payload",n);const s=async()=>Ro(d=>he.from("produtos").insert(n).select("*").single().abortSignal(d),15e3,"Timeout createProduct (15s)"),o=d=>{if(!d)return!1;if(d.code&&String(d.code)==="23505")return!0;const u=[d.message,d.details,d.hint].filter(Boolean).join(" ").toLowerCase();return u.includes("duplicate key")||u.includes("unique constraint")||u.includes("ux_produtos_empresa_codigo_produto")||u.includes("codigo_produto")};let i,l;if({data:i,error:l}=await s(),l&&o(l)&&n.codigo_produto){console.warn("[products.api] createProduct: duplicate code, trying to free code from inactive product");const{data:d,error:u}=await Ro(h=>he.from("produtos").select("id,status").eq("codigo_produto",n.codigo_produto).eq("status","inactive").limit(1).abortSignal(h),15e3,"Timeout find duplicate product (15s)"),f=Array.isArray(d)&&d.length>0?d[0]:null;if(!u&&f&&f.status==="inactive"){const{error:h}=await Ro(m=>he.from("produtos").update({codigo_produto:null}).eq("id",f.id).abortSignal(m),15e3,"Timeout clear duplicate code (15s)");h||({data:i,error:l}=await s())}else{const h=n.codigo_produto;n.codigo_produto=null,console.warn("[products.api] createProduct: no inactive found for duplicate code, retrying with codigo_produto = null (original:",h,")"),{data:i,error:l}=await s()}}if(l)throw console.error("[products.api] createProduct:error",l),l;const c=aA(i);return console.info("[products.api] createProduct: ok",c),c}async function Zw(e,t,r={}){const n=Pse(t);n.data_importacao=null,console.info("[products.api] updateProduct: id",e,"payload",n);const{data:s,error:o}=await Ro(l=>he.from("produtos").update(n).eq("id",e).select("*").single().abortSignal(l),15e3,"Timeout updateProduct (15s)");if(o)throw console.error("[products.api] updateProduct:error",o),o;const i=aA(s);return console.info("[products.api] updateProduct: ok",i),i}async function Ro(e,t,r){const n=new AbortController,s=setTimeout(()=>n.abort(new Error(r)),t);try{return await e(n.signal)}catch(o){throw o?.name==="AbortError"?new Error(r):o}finally{clearTimeout(s)}}async function IR(e){console.info("[products.api] deleteProduct (soft): id",e);const{error:t}=await Ro(r=>he.from("produtos").update({status:"inactive",codigo_produto:null}).eq("id",e).abortSignal(r),15e3,"Timeout deleteProduct (15s)");if(t)throw console.error("[products.api] deleteProduct:error",t),t;return console.info("[products.api] deleteProduct: ok (inativado)"),!0}async function Uat({ids:e,status:t}){const r=Array.isArray(e)?e.filter(Boolean):[];if(!r.length)throw new Error("Nenhum produto selecionado para atualizao em massa");if(!["active","inactive","low_stock"].includes(t))throw new Error("Status invlido para atualizao em massa");const n=t!=="inactive";console.info("[products.api] bulkUpdateProductStatus:start",{count:r.length,status:t});const{error:s}=await Ro(o=>he.from("produtos").update({status:t,ativo:n}).in("id",r).abortSignal(o),2e4,"Timeout bulkUpdateProductStatus (20s)");if(s)throw console.error("[products.api] bulkUpdateProductStatus:error",s),s;return console.info("[products.api] bulkUpdateProductStatus:ok",{count:r.length,status:t}),!0}async function Vat({ids:e}){const t=Array.isArray(e)?e.filter(Boolean):[];if(!t.length)throw new Error("Nenhum produto selecionado para limpar flag de novo");console.info("[products.api] bulkClearNewFlag:start",{count:t.length});const{error:r}=await Ro(n=>he.from("produtos").update({data_importacao:null}).in("id",t).abortSignal(n),2e4,"Timeout bulkClearNewFlag (20s)");if(r)throw console.error("[products.api] bulkClearNewFlag:error",r),r;return console.info("[products.api] bulkClearNewFlag:ok",{count:t.length}),!0}async function OU(e={}){const{codigoEmpresa:t}=e;console.info("[products.api] listCategories: start");const{data:r,error:n}=await Ro(i=>{let l=he.from("produto_categorias").select("nome").eq("ativa",!0).order("nome",{ascending:!0}).abortSignal(i);return t&&(l=l.eq("codigo_empresa",t)),l},15e3,"Timeout listCategories (15s)");if(n)throw console.error("[products.api] listCategories:error",n),n;const s=[],o=new Set;for(const i of r||[]){const l=(i?.nome||"").trim();if(!l)continue;const c=l.toLowerCase();o.has(c)||(o.add(c),s.push(l))}return console.info("[products.api] listCategories: ok",{count:s.length}),s}async function Wat(e,t={}){const{codigoEmpresa:r}=t,n=String(e||"").trim();if(!n)throw new Error("Nome da categoria invlido");console.info("[products.api] createCategory:",n);const s={nome:n};r&&(s.codigo_empresa=r);const{data:o,error:i}=await Ro(l=>he.from("produto_categorias").insert(s).select("nome").single().abortSignal(l),15e3,"Timeout createCategory (15s)");if(i)throw console.error("[products.api] createCategory:error",i),i;return o?.nome||n}async function Hat(e,t={}){const{codigoEmpresa:r}=t,n=String(e||"").trim();if(!n)throw new Error("Nome da categoria invlido");console.info("[products.api] removeCategory:",n);const{count:s,error:o}=await Ro(d=>{let u=he.from("produtos").select("id",{count:"exact",head:!0}).eq("categoria",n).neq("status","inactive").abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},15e3,"Timeout removeCategory:count (15s)");if(o)throw console.error("[products.api] removeCategory:count:error",o),o;if((s??0)>0){const d=new Error("Categoria possui produtos ativos vinculados");throw console.warn("[products.api] removeCategory: blocked by active products",{nome:n,prodCount:s}),d}const{data:i,error:l}=await Ro(d=>{let u=he.from("produto_categorias").update({ativa:!1}).eq("nome",n).select("nome").abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},15e3,"Timeout removeCategory (15s)");if(l)throw console.error("[products.api] removeCategory:error",l),l;if((Array.isArray(i)?i.length:0)===0){const d=new Error("Categoria no encontrada para desativar");throw console.warn("[products.api] removeCategory: no rows affected",{nome:n}),d}return!0}function Gat({item:e,onApply:t,onClose:r,codigoEmpresa:n}){const{toast:s}=as(),[o,i]=p.useState(e?.desconto_tipo||"percentual"),[l,c]=p.useState(e?.desconto_valor||0),[d,u]=p.useState(e?.desconto_motivo||""),[f,h]=p.useState(!1);if(!e)return null;const m=Number(e.price||e.preco_unitario||0),v=Number(e.quantity||e.quantidade||1),g=m*v,y=o==="percentual"?g*(1-l/100):g-l,x=async()=>{try{if(h(!0),l<0){s({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(o==="percentual"&&l>100){s({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}console.log("Aplicando desconto:",{itemId:e.id,desconto_tipo:o,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});const w=await JGe({itemId:e.id,desconto_tipo:o,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});console.log("Resultado:",w),s({title:"Sucesso",description:"Desconto aplicado!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao aplicar desconto:",w),s({title:"Erro",description:w.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{h(!1)}},b=async()=>{try{h(!0),await ZGe({itemId:e.id,codigoEmpresa:n}),s({title:"Sucesso",description:"Desconto removido!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao remover desconto:",w),s({title:"Erro",description:w.message||"Falha ao remover desconto",variant:"destructive"})}finally{h(!1)}};return a.jsx(xn,{open:!0,onOpenChange:r,children:a.jsxs(vn,{overlayClassName:"z-[90]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[91]",children:[a.jsx(pn,{children:a.jsxs(un,{className:"text-lg font-bold",children:["Desconto - ",e.name]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Le,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(me,{variant:o==="percentual"?"default":"outline",onClick:()=>i("percentual"),disabled:f,className:"flex-1",children:"Percentual (%)"}),a.jsx(me,{variant:o==="fixo"?"default":"outline",onClick:()=>i("fixo"),disabled:f,className:"flex-1",children:"Fixo (R$)"})]})]}),a.jsxs("div",{children:[a.jsxs(Le,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",o==="percentual"?"(%)":"(R$)"]}),a.jsxs("div",{className:"relative mt-1",children:[a.jsx(Ye,{id:"desconto-valor",type:"text",value:o==="percentual"?l===0?"":l:l===0?"":`R$ ${l.toFixed(2)}`,onChange:w=>{let j=w.target.value.trim();if(j===""){c(0);return}o==="fixo"&&(j=j.replace(/[^\d.,]/g,"").replace(",","."));let _=Number(j);isNaN(_)&&(_=0),o==="percentual"&&_>100&&(_=100),_<0&&(_=0),c(_)},placeholder:o==="percentual"?"0":"0,00",disabled:f,className:"mt-1"}),o==="percentual"&&a.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),a.jsxs("select",{id:"desconto-motivo",value:d,onChange:w=>u(w.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:f,children:[a.jsx("option",{value:"",children:"Selecione um motivo..."}),a.jsx("option",{value:"Promoo",children:"Promoo"}),a.jsx("option",{value:"Meia entrada",children:"Meia entrada"}),a.jsx("option",{value:"Cortesia",children:"Cortesia"}),a.jsx("option",{value:"Ajuste",children:"Ajuste"}),a.jsx("option",{value:"Outro",children:"Outro"})]})]}),a.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:"Preo Original:"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",g.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[a.jsx("span",{children:"Desconto:"}),a.jsxs("span",{children:["-R$ ",(g-y).toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[a.jsx("span",{children:"Total do Item:"}),a.jsxs("span",{className:"text-brand",children:["R$ ",Math.max(0,y).toFixed(2)]})]})]}),d&&a.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[a.jsx("strong",{children:"Motivo:"})," ",d]})]}),a.jsxs(ra,{className:"flex gap-2",children:[a.jsx(me,{variant:"outline",onClick:r,disabled:f,children:"Cancelar"}),e.desconto_valor>0&&a.jsxs(me,{variant:"destructive",onClick:b,disabled:f,size:"sm",className:"gap-2",children:[a.jsx(zu,{className:"w-4 h-4"}),"Remover"]}),a.jsx(me,{onClick:x,disabled:f,className:"gap-2",children:f?"Aplicando...":"Aplicar Desconto"})]})]})})}function Kat({comanda:e,subtotal:t,onApply:r,onClose:n,codigoEmpresa:s}){const{toast:o}=as(),[i,l]=p.useState(e?.desconto_tipo||"percentual"),[c,d]=p.useState(e?.desconto_valor||0),[u,f]=p.useState(e?.desconto_motivo||""),[h,m]=p.useState(!1);if(!e)return null;const v=i==="percentual"?t*c/100:c,g=Math.max(0,t-v),y=async()=>{try{if(m(!0),c<0){o({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(i==="percentual"&&c>100){o({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}if(v>t){o({title:"Erro",description:"Desconto no pode ser maior que o subtotal",variant:"destructive"});return}console.log("Aplicando desconto comanda:",{comandaId:e.id,desconto_tipo:i,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:s});const b=await QGe({comandaId:e.id,desconto_tipo:i,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:s});console.log("Resultado comanda:",b),o({title:"Sucesso",description:"Desconto aplicado na comanda!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao aplicar desconto:",b),o({title:"Erro",description:b.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{m(!1)}},x=async()=>{try{m(!0),await eKe({comandaId:e.id,codigoEmpresa:s}),o({title:"Sucesso",description:"Desconto removido!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao remover desconto:",b),o({title:"Erro",description:b.message||"Falha ao remover desconto",variant:"destructive"})}finally{m(!1)}};return a.jsx(xn,{open:!0,onOpenChange:n,children:a.jsxs(vn,{className:"sm:max-w-[420px]",children:[a.jsx(pn,{children:a.jsx(un,{className:"text-lg font-bold",children:"Desconto da Comanda"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Le,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(me,{variant:i==="percentual"?"default":"outline",onClick:()=>l("percentual"),disabled:h,className:"flex-1",children:"Percentual (%)"}),a.jsx(me,{variant:i==="fixo"?"default":"outline",onClick:()=>l("fixo"),disabled:h,className:"flex-1",children:"Fixo (R$)"})]})]}),a.jsxs("div",{children:[a.jsxs(Le,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",i==="percentual"?"(%)":"(R$)"]}),a.jsxs("div",{className:"relative mt-1",children:[a.jsx(Ye,{id:"desconto-valor",type:"text",name:"desconto-valor",autoComplete:"off",autoCorrect:"off",spellCheck:!1,value:i==="percentual"?c===0?"":c:c===0?"":`R$ ${c.toFixed(2)}`,onChange:b=>{let w=b.target.value.trim();if(w===""){d(0);return}i==="fixo"&&(w=w.replace(/[^\d.,]/g,"").replace(",","."));let j=Number(w);isNaN(j)&&(j=0),i==="percentual"&&j>100&&(j=100),j<0&&(j=0),d(j)},placeholder:i==="percentual"?"0":"0,00",disabled:h,className:"mt-1"}),i==="percentual"&&a.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),a.jsxs("select",{id:"desconto-motivo",value:u,onChange:b=>f(b.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:h,children:[a.jsx("option",{value:"",children:"Selecione um motivo..."}),a.jsx("option",{value:"Promoo",children:"Promoo"}),a.jsx("option",{value:"Cortesia",children:"Cortesia"}),a.jsx("option",{value:"Ajuste",children:"Ajuste"}),a.jsx("option",{value:"Outro",children:"Outro"})]})]}),a.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:"Subtotal:"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",t.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[a.jsx("span",{children:"Desconto:"}),a.jsxs("span",{children:["-R$ ",v.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[a.jsx("span",{children:"Total da Comanda:"}),a.jsxs("span",{className:"text-brand",children:["R$ ",g.toFixed(2)]})]})]}),u&&a.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[a.jsx("strong",{children:"Motivo:"})," ",u]})]}),a.jsxs(ra,{className:"flex gap-2",children:[a.jsx(me,{variant:"outline",onClick:n,disabled:h,children:"Cancelar"}),e.desconto_valor>0&&a.jsxs(me,{variant:"destructive",onClick:x,disabled:h,size:"sm",className:"gap-2",children:[a.jsx(zu,{className:"w-4 h-4"}),"Remover"]}),a.jsx(me,{onClick:y,disabled:h,className:"gap-2",children:h?"Aplicando...":"Aplicar Desconto"})]})]})})}const Xat={available:{label:"Livre",color:"border-success/50 bg-success/10 text-success",icon:Do},"in-use":{label:"Em Uso",color:"border-warning/50 bg-warning/10 text-warning",icon:yd},"awaiting-payment":{label:"Pagamento",color:"border-info/50 bg-info/10 text-info",icon:Go}};function Yat(){const{toast:e}=as(),{userProfile:t,authReady:r}=vs(),n=Ri(),[s,o]=p.useState([]),[i,l]=p.useState(null),[c,d]=p.useState(!1),[u,f]=p.useState(0);p.useRef(!1);const[h,m]=p.useState(!1);p.useState([]);const[v,g]=p.useState(!1),[y,x]=p.useState(new Map),[b,w]=p.useState(!1);p.useRef(null),p.useRef(null);const j=p.useRef([]),_=p.useRef(null),[C,P]=p.useState(0),[E,A]=p.useState("tables");p.useRef(null);const[F,D]=p.useState("order");p.useRef(null),p.useRef(null),p.useState(!1);const[I,R]=p.useState(null),[M,U]=p.useState(null),[z,W]=p.useState(!1),[$,ee]=p.useState(!1),[ve,_e]=p.useState(!1),[K,q]=p.useState(null),[Y,J]=p.useState(!1),[fe,Z]=p.useState([]),[ce,le]=p.useState(!1),[ie,te]=p.useState(!1),[ue,Te]=p.useState(!1),[ne,de]=p.useState(!1),[lt,Nt]=p.useState(!1),[at,gt]=p.useState(!1),[Pt,yt]=p.useState(!1),[Qe,ge]=p.useState(null),[rt,pt]=p.useState(""),[We,Ze]=p.useState(!1),[Ne,ye]=p.useState(!1),[Be,mt]=p.useState([]),[Ft,fr]=p.useState(null),[It,Ut]=p.useState(null),[xe,st]=p.useState(!1),Ct=p.useRef(""),[ar,pr]=p.useState(!1),[Xt,yr]=p.useState(!1),[lr,Rr]=p.useState("order"),[Pn,De]=p.useState(!1),[ke,Ge]=p.useState(""),[Re,bt]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}}),[Qt,ct]=p.useState(null),[xt,it]=p.useState(null),[kt,be]=p.useState(!1);p.useEffect(()=>{const V=t?.codigo_empresa;V&&(async()=>{try{if(Array.isArray(Be)&&Be.length>0)return;const oe=await Hm({somenteAtivas:!0,codigoEmpresa:V});mt(Array.isArray(oe)?oe:[])}catch{}})()},[t?.codigo_empresa]);const dt=p.useMemo(()=>{const V=new Map,oe=i?.order||[];for(const Pe of oe){const qe=String(Pe.productId);V.set(qe,(V.get(qe)||0)+Number(Pe.quantity||0))}return V},[i?.order]),Lt=async V=>{try{const oe=i?.order||[],Pe=oe.find(nr=>String(nr.productId)===String(V.id));if(!Pe)return;const qe=Number(Pe.quantity||0)-1;if(String(Pe.id||"").startsWith("tmp-")){const nr=qe>0?oe.map(Yr=>Yr.id===Pe.id?{...Yr,quantity:qe}:Yr):oe.filter(Yr=>Yr.id!==Pe.id),Wr=nr.reduce((Yr,br)=>Yr+Number(br.price||0)*Number(br.quantity||0),0),Cr={...i,order:nr,totalHint:Wr};l(Cr),o(Yr=>Yr.map(br=>br.id===Cr.id?{...br,totalHint:Wr}:br)),setTimeout(async()=>{try{const br=(await uo({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Qr=>({id:Qr.id,productId:Qr.produto_id,name:Qr.descricao||"Item",price:Number(Qr.preco_unitario||0),quantity:Number(Qr.quantidade||1)})),ir=(br||[]).reduce((Qr,ln)=>Qr+Number(ln.price||0)*Number(ln.quantity||0),0),ht={...i,order:br,totalHint:ir};l(ht),o(Qr=>Qr.map(ln=>ln.id===ht.id?{...ln,totalHint:ir}:ln))}catch{}},300);return}const Rt=i,ut=s,qt=qe>0?oe.map(nr=>nr.id===Pe.id?{...nr,quantity:qe}:nr):oe.filter(nr=>nr.id!==Pe.id),Kt=qt.reduce((nr,Wr)=>nr+Number(Wr.price||0)*Number(Wr.quantity||0),0),At={...i,order:qt,totalHint:Kt};l(At),o(nr=>nr.map(Wr=>Wr.id===At.id?{...Wr,totalHint:Kt}:Wr));try{qe>0?await td({itemId:Pe.id,quantidade:qe,codigoEmpresa:t?.codigo_empresa}):await zv({itemId:Pe.id,codigoEmpresa:t?.codigo_empresa})}catch(nr){throw l(Rt),o(ut),nr}const kr=Math.max(qe,0);let _r=!1;for(let nr=0;nr<3&&!_r;nr++){const Cr=(await uo({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(br=>({id:br.id,productId:br.produto_id,name:br.descricao||"Item",price:Number(br.preco_unitario||0),quantity:Number(br.quantidade||1)}));if((Cr.find(br=>String(br.productId)===String(V.id))?.quantity||0)===kr){const br=Cr.reduce((ht,Qr)=>ht+Number(Qr.price||0)*Number(Qr.quantity||0),0),ir={...i,order:Cr,totalHint:br};l(ir),o(ht=>ht.map(Qr=>Qr.id===ir.id?ir:Qr)),_r=!0;break}await new Promise(br=>setTimeout(br,180*(nr+1)))}try{const nr=await Lm({codigoEmpresa:t?.codigo_empresa}),Wr=new Map;for(const Cr of nr||[]){const Yr=String(Cr.produto_id),br=Number(Cr.quantidade||0);Wr.set(Yr,(Wr.get(Yr)||0)+br)}x(Wr)}catch(nr){console.error("[decProduct] Erro ao atualizar estoque reservado:",nr)}}catch(oe){console.error("[decProduct] Erro:",oe),e({title:"Falha ao alterar quantidade",description:oe?.message||"Tente novamente",variant:"destructive"})}},mr=p.useRef(null),tr=p.useCallback(()=>{try{const V=mr.current;if(!V)return 1;const Pe=window.getComputedStyle(V).gridTemplateColumns||"";if(Pe){const He=Pe.split(" ").filter(Boolean).length;if(He>0)return He}const qe=V.querySelector("[data-table-id]");if(qe){const He=qe.getBoundingClientRect().width,Rt=V.getBoundingClientRect().width;if(He>0)return Math.max(1,Math.floor(Rt/He))}return 1}catch{return 1}},[]),[Or,Lr]=p.useState(!1),sr=p.useRef(!1);p.useEffect(()=>{sr.current=We},[We]);const fn=p.useRef(0),Tn=p.useRef(null),mn=p.useRef(null),zn=p.useRef(null),ot=p.useRef(null),$t=p.useRef([]);p.useRef(null);const Yt=p.useRef(!1),Ht=p.useRef(null),Ot=p.useRef(null);Lo();const Xr=p.useMemo(()=>(s||[]).find(V=>V.status==="available")?.id||null,[s]),Je=ie||ne||$||v||We||xe||h||z||Xt||ve||b||!1,cr=async V=>{try{if(!V)return;if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}if(Ne)return;if(ye(!0),l(oe=>!oe||oe.id!==V.id?V:oe),V.status==="available"||!V.comandaId){ge(V),de(!0);return}try{await et(V)}catch{try{const qe=(await uo({comandaId:V.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(ut=>({id:ut.id,productId:ut.produto_id,name:ut.descricao||"Item",price:Number(ut.preco_unitario||0),quantity:Number(ut.quantidade||1)}));let He=null;try{const qt=(await ai({comandaId:V.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Kt=>Kt?.nome).filter(Boolean);He=qt.length?qt.join(", "):null}catch{}const Rt={...V,order:qe,customer:He};l(Rt),o(ut=>ut.map(qt=>qt.id===Rt.id?Rt:qt))}catch{}}}finally{ye(!1)}};p.useEffect(()=>{const V=()=>{try{bt(typeof window<"u"&&window.innerWidth<=640)}catch{bt(!1)}};return V(),window.addEventListener("resize",V),()=>window.removeEventListener("resize",V)},[]),p.useEffect(()=>{const V=async oe=>{try{if(b)return;const Pe=String(oe.target?.tagName||"").toLowerCase();if(["input","textarea","select"].includes(Pe)||oe.target?.isContentEditable||Je)return;if(oe.key==="F1"){oe.preventDefault();try{const He=(s||[]).filter(Rt=>Rt.status==="available");He.length>0?(l(He[0]),ge?.(He[0])):!i&&Array.isArray(s)&&s.length>0&&(l(s[0]),ge?.(s[0]))}catch{}de(!0);return}if(oe.key==="F2"){oe.preventDefault(),i?.comandaId?await zr():e({title:"Nenhuma comanda selecionada",description:"Selecione uma mesa com comanda aberta antes de fechar.",variant:"warning"});return}if(oe.key==="F10"){oe.preventDefault(),c?e({title:"Caixa j est aberto",description:"Use F11 para ver detalhes do caixa.",variant:"info"}):st(!0);return}if(oe.key==="F11"){oe.preventDefault(),g(!0);return}if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(oe.key)){if(E!=="tables"||!i||!Array.isArray(s)||s.length===0)return;oe.preventDefault(),oe.stopPropagation();let He=Math.max(0,s.findIndex(At=>At.id===i?.id));He<0&&(He=0);let Rt=tr(),ut=He;oe.key==="ArrowRight"&&(ut=He+1),oe.key==="ArrowLeft"&&(ut=He-1),oe.key==="ArrowDown"&&(ut=He+Rt),oe.key==="ArrowUp"&&(ut=He-Rt);const qt=s.length;ut=(ut%qt+qt)%qt;const Kt=s[ut];Kt&&Kt.id!==i?.id&&(l(Kt),setTimeout(()=>{try{document.querySelector(`[data-table-id="${Kt.id}"]`)?.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}catch{}},0));return}if(oe.key==="Enter"){if(E!=="tables")return;oe.preventDefault(),oe.stopPropagation(),i&&!Ne&&await cr(i);return}if(oe.key==="Escape"){if(oe.preventDefault(),i&&(F==="products"||lr==="products")){D("order"),Rr("order");return}if(i){l(null);return}return}if(oe.key==="p"||oe.key==="P"){if(oe.preventDefault(),h){setTimeout(()=>{try{_.current?.focus()}catch{}},0);return}if(i){w(!0);try{yr(!1)}catch{}return}m(!0),setTimeout(()=>{try{_.current?.focus()}catch{}},50);return}}catch{}};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[Je,i?.id,s,tr,b]),p.useEffect(()=>{try{i?.id&&t?.codigo_empresa&&localStorage.setItem(`vendas:selected:${t.codigo_empresa}`,String(i.id))}catch{}},[i?.id,t?.codigo_empresa]),p.useEffect(()=>{(async()=>{try{if(!i&&t?.codigo_empresa&&Array.isArray(s)&&s.length>0){const oe=localStorage.getItem(`vendas:selected:${t.codigo_empresa}`);if(oe){const Pe=s.find(qe=>String(qe.id)===String(oe));if(Pe)if(A("tables"),Pe.comandaId)try{await et(Pe),A("tables")}catch(qe){console.error("[Restore Selection] Erro ao carregar detalhes:",qe),localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}else localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}}}catch(oe){console.error("[Restore Selection] Erro:",oe)}})()},[s,i,t?.codigo_empresa]);const vt=p.useCallback(async()=>{try{const V=await Km({codigoEmpresa:t?.codigo_empresa});d(!!(V&&(V.id||V?.length)))}catch{d(!1)}},[t?.codigo_empresa]),Tt=async()=>{const V=t?.codigo_empresa||null;try{if(!V)return;const[oe,Pe]=await Promise.all([Fw({codigoEmpresa:V}).catch(()=>null),Km({codigoEmpresa:V}).catch(()=>null)]);if(!Pe?.id){R(null);return}let qe=0,He=[];try{He=await Wp({caixaSessaoId:Pe.id,codigoEmpresa:V}),qe=(He||[]).filter(ut=>(ut?.tipo||"")==="sangria").reduce((ut,qt)=>ut+Number(qt?.valor||0),0)}catch{}const Rt={saldo_inicial:Pe.saldo_inicial||0,totalPorFinalizadora:oe?.totalPorFinalizadora||oe?.porFinalizadora||{},totalEntradas:oe?.totalEntradas||oe?.entradas||0,totalSangria:qe,totalSaidas:qe,sessaoId:Pe.id,movimentacoes:He};Se.startTransition(()=>{R(Rt)})}catch{Se.startTransition(()=>{R(null)})}finally{}},Dr=p.useRef(!1);p.useEffect(()=>{v&&!Dr.current?(Dr.current=!0,Tt().catch(()=>{})):v||(Dr.current=!1)},[v]);const an=p.useRef(!0);p.useEffect(()=>(an.current=!0,()=>{an.current=!1}),[]);const Nr=p.useRef(0),St=p.useRef(0),Fr=p.useRef(0);p.useEffect(()=>{const V=t?.codigo_empresa||null,oe=V?`vendas:tables:${V}`:null,Pe=()=>{try{if(!oe)return;const He=JSON.parse(localStorage.getItem(oe)||"[]");Array.isArray(He)&&He.length>0&&o(He)}catch{}};V&&Pe();const qe=async()=>{try{if(!r||!V)return;const He=++Fr.current,Rt=setTimeout(()=>{an.current&&Pe()},2e3),ut=setTimeout(()=>{an.current&&Fr.current===He&&Pe()},1e4),[qt,Kt]=await Promise.all([Gm(V),Lm({codigoEmpresa:V}).catch(()=>[])]);if(an.current&&Fr.current===He){const ir=new Map;for(const ht of Kt||[]){const Qr=String(ht.produto_id),ln=Number(ht.quantidade||0);ir.set(Qr,(ir.get(Qr)||0)+ln)}x(ir)}let At=[];try{At=await jc({codigoEmpresa:V})}catch(ir){console.error("[VendasPage:load] Erro ao carregar comandas abertas:",ir)}const kr=await(async()=>{try{return await dS((At||[]).map(ir=>ir.id),V)}catch{return{}}})(),_r=await(async()=>{try{const ir=await Promise.all((At||[]).map(async ht=>{try{const ln=(await ai({comandaId:ht.id,codigoEmpresa:V})||[]).map(Ia=>Ia?.nome).filter(Boolean);return[ht.id,ln.length?ln.join(", "):null]}catch{return[ht.id,null]}}));return Object.fromEntries(ir)}catch{return{}}})(),nr=new Map;(At||[]).forEach(ir=>nr.set(ir.mesa_id,ir));const Cr=(qt||[]).map(ir=>{const ht=nr.get(ir.id);let Qr,ln=null,Ia=null,Ca=0,dr=null;return ht?(Qr=ht.status==="awaiting-payment"||ht.status==="awaiting_payment"?"awaiting-payment":"in-use",ln=ht.id,Ia=_r[ht.id]||null,Ca=kr[ht.id]||0,dr=ht.aberto_em||null):Qr="available",{id:ir.id,number:ir.numero,name:ir.nome||null,status:Qr,order:[],customer:Ia,comandaId:ln,totalHint:Ca,aberto_em:dr}}).map(ir=>i&&ir.id===i.id?{...ir,order:i.order||[],customer:i.customer||ir.customer}:ir);if(!an.current||Fr.current!==He){clearTimeout(Rt),clearTimeout(ut);return}if(o(Cr),(Cr||[]).length===0)try{oe&&localStorage.removeItem(oe)}catch{}else try{oe&&localStorage.setItem(oe,JSON.stringify(Cr))}catch{}const Yr=V?`vendas:selected:${V}`:null;if(Yr)try{const ir=localStorage.getItem(Yr);if(ir){const ht=Cr.find(Qr=>String(Qr.id)===String(ir));ht&&!ht.comandaId&&localStorage.removeItem(Yr)}}catch{}St.current=Array.isArray(Cr)?Cr.length:0,Nr.current=Date.now();let br=null;try{const ir=V?`vendas:selected:${V}`:null,ht=ir?localStorage.getItem(ir):null;if(ht){const Qr=Cr.find(ln=>String(ln.id)===String(ht));Qr&&(br=Qr)}}catch{}br?We||l(ir=>!ir||ir.id!==br.id?br:{...br,order:ir.order||br.order||[],customer:ir.customer||br.customer||null,observacoes:ir.observacoes??br.observacoes??null,desconto_tipo:ir.desconto_tipo??br.desconto_tipo??null,desconto_valor:ir.desconto_valor??br.desconto_valor??0,desconto_motivo:ir.desconto_motivo??br.desconto_motivo??null}):We||l(ir=>{const ht=ir?Cr.find(ln=>ln.id===ir.id):null;return ht?{...ht,order:ir.order||ht.order||[],customer:ir.customer||ht.customer||null,observacoes:ir.observacoes??ht.observacoes??null,desconto_tipo:ir.desconto_tipo??ht.desconto_tipo??null,desconto_valor:ir.desconto_valor??ht.desconto_valor??0,desconto_motivo:ir.desconto_motivo??ht.desconto_motivo??null}:Cr[0]||null});try{const ir=await hu({includeInactive:!1,codigoEmpresa:V});Z(ir||[])}catch(ir){console.warn("Falha ao carregar produtos:",ir?.message||ir)}clearTimeout(Rt),clearTimeout(ut)}catch(He){console.error("Erro ao carregar mesas:",He)}};return Pe(),r&&V&&qe(),()=>{}},[r,t?.codigo_empresa,Je]),p.useEffect(()=>{!r||!t?.codigo_empresa||vt()},[r,t?.codigo_empresa,vt]),p.useEffect(()=>{let V=!0;return(async()=>{try{if(!t?.codigo_empresa){V&&f(0);return}const oe=await jc({codigoEmpresa:t?.codigo_empresa});if(!V)return;f(Array.isArray(oe)?oe.length:0)}catch{V&&f(0)}})(),()=>{V=!1}},[t?.codigo_empresa,s.length]),p.useEffect(()=>{const V=t?.codigo_empresa||null,oe=V?`vendas:selected:${V}`:null;try{oe&&i?.id&&localStorage.setItem(oe,String(i.id))}catch{}i?.comandaId&&(!i.order||i.order.length===0)&&et(i)},[i?.id,i?.comandaId]),p.useEffect(()=>()=>{},[i?.comandaId,Je,ve]);const zr=async()=>{try{if(!i?.comandaId){e({title:"Selecione uma mesa com comanda aberta",variant:"warning"});return}await Sf({codigoEmpresa:t?.codigo_empresa});try{const qe=(await uo({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Rt=>({id:Rt.id,productId:Rt.produto_id,name:Rt.descricao||"Item",price:Number(Rt.preco_unitario||0),quantity:Number(Rt.quantidade||1),desconto_tipo:Rt.desconto_tipo||null,desconto_valor:Number(Rt.desconto_valor||0),desconto_motivo:Rt.desconto_motivo||null})),He={...i,order:qe};l(He),o(Rt=>Rt.map(ut=>ut.id===He.id?He:ut))}catch{}const V=await Hm({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});mt(V||[]);const oe=V&&V[0]&&V[0].id?V[0].id:null;fr(oe),Ut(oe),Ze(!0)}catch(V){e({title:"Falha ao carregar finalizadoras",description:V?.message||"Tente novamente",variant:"destructive"})}},ha=V=>{if(!V.destination)return;const oe=Array.from(s),[Pe]=oe.splice(V.source.index,1);oe.splice(V.destination.index,0,Pe),o(oe),e({title:"Layout das mesas atualizado!",description:"As posies foram salvas temporariamente.",variant:"success"})},En=(V,oe)=>{let Pe=0;for(const He of V||[]){let Rt=(He.price||0)*(He.quantity||1);He.desconto_tipo==="percentual"&&He.desconto_valor>0?Rt*=1-He.desconto_valor/100:He.desconto_tipo==="fixo"&&He.desconto_valor>0&&(Rt-=He.desconto_valor),Pe+=Math.max(0,Rt)}let qe=Pe;return oe?.desconto_tipo==="percentual"&&oe?.desconto_valor>0?qe*=1-oe.desconto_valor/100:oe?.desconto_tipo==="fixo"&&oe?.desconto_valor>0&&(qe-=oe.desconto_valor),Math.max(0,qe)},ae=V=>{if(!V)return"";const oe=V.trim().split(/\s+/);return oe.length<=2?V:oe.slice(0,2).join(" ")},Me=V=>{if(!V)return"";const oe=qe=>String(qe).replace(/^\s*[\[]+\s*/g,"").replace(/\s*[\]]+\s*$/g,"").trim(),Pe=V.split(",").map(qe=>oe(qe)).filter(Boolean);return Pe.length===0?"":Pe.length===1?ae(Pe[0]):`${ae(Pe[0])} +${Pe.length-1}`},et=async V=>{try{if(!V?.comandaId)return;const Pe=(await uo({comandaId:V.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(ut=>({id:ut.id,productId:ut.produto_id,name:ut.descricao||"Item",price:Number(ut.preco_unitario||0),quantity:Number(ut.quantidade||1),desconto_tipo:ut.desconto_tipo||null,desconto_valor:Number(ut.desconto_valor||0),desconto_motivo:ut.desconto_motivo||null}));let qe=V.customer||null;try{const qt=(await ai({comandaId:V.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Kt=>Kt?.nome).filter(Boolean);qe=qt.length?qt.join(", "):null}catch{}let He=V;try{const qt=(await jc({codigoEmpresa:t?.codigo_empresa}))?.find(Kt=>Kt.id===V.comandaId);qt&&(He={...V,desconto_tipo:qt.desconto_tipo||null,desconto_valor:Number(qt.desconto_valor||0),desconto_motivo:qt.desconto_motivo||null,observacoes:qt.observacoes||null})}catch{}const Rt={...He,status:V.status==="awaiting-payment"?"awaiting-payment":"in-use",order:Pe,customer:qe};l(Rt),o(ut=>ut.map(qt=>qt.id===Rt.id?Rt:qt))}catch(oe){console.warn("[VendasPage] Falha ao recarregar detalhes da mesa selecionada:",oe)}},re=async({showToast:V=!1}={})=>{try{const oe=t?.codigo_empresa;if(!oe)return;const Pe=await Gm(oe);let qe=[];try{qe=await jc({codigoEmpresa:oe})}catch(At){console.error("[refreshTablesLight] Erro ao carregar comandas:",At)}const He=new Map((qe||[]).map(At=>[At.mesa_id,At])),Rt={},ut={};try{const At=(qe||[]).map(nr=>nr.id);(await Promise.all(At.map(async nr=>{try{return{id:nr,vinculos:await ai({comandaId:nr,codigoEmpresa:oe})}}catch{return{id:nr,vinculos:[]}}}))).forEach(({id:nr,vinculos:Wr})=>{const Cr=(Wr||[]).map(Yr=>Yr?.nome).filter(Boolean);Rt[nr]=Cr.length?Cr.join(", "):null}),(await Promise.all(At.map(async nr=>{try{const Cr=(await uo({comandaId:nr,codigoEmpresa:oe})||[]).reduce((Yr,br)=>{const ir=(br.quantidade||0)*(br.preco_unitario||0)-(br.desconto||0);return Yr+ir},0);return{comandaId:nr,total:Cr}}catch(Wr){return console.error(`[refreshTablesLight] Erro ao buscar itens da comanda ${nr}:`,Wr),{comandaId:nr,total:0}}}))).forEach(({comandaId:nr,total:Wr})=>{ut[nr]=Wr})}catch(At){console.error("[refreshTablesLight] Erro ao carregar clientes/totais:",At)}const Kt=(Pe||[]).map(At=>{const kr=He.get(At.id);let _r,nr=null,Wr=null,Cr=0;return kr?(_r=kr.status==="awaiting-payment"||kr.status==="awaiting_payment"?"awaiting-payment":"in-use",nr=kr.id,Wr=Rt[kr.id]||null,Cr=ut[kr.id]||0):_r="available",{id:At.id,number:At.numero,name:At.nome||null,status:_r,order:[],customer:Wr,comandaId:nr,totalHint:Cr}}).map(At=>{if(i&&At.id===i.id)return i.status==="available"?{...At,status:"available",comandaId:null,order:[],customer:null,totalHint:0}:At.comandaId?{...At,order:i.order||[],customer:i.customer||At.customer}:{...At,order:[],customer:null};try{const kr=L.current.get(At.id);if(kr&&Date.now()-kr<3e4)return{...At,status:"available",comandaId:null,order:[],customer:null,totalHint:0}}catch{}return At});if(o(Kt),i){const At=Kt.find(kr=>kr.id===i.id);At&&!At.comandaId&&l({...At,order:[],customer:null})}}catch(oe){console.error("[refreshTablesLight] Erro fatal:",oe),V&&e({title:"Erro ao atualizar mesas",description:"Recarregue a pgina se o problema persistir",variant:"destructive"})}},O=p.useRef(null);p.useEffect(()=>{O.current=i},[i]);const T=p.useRef(null),X=p.useRef(null),H=p.useRef(null),L=p.useRef(new Map);p.useEffect(()=>{const V=t?.codigo_empresa;if(!V)return;try{const qe=typeof window<"u"?window.localStorage.getItem("custom-auth-token"):null;if(qe&&qe.trim())he.realtime.setAuth(qe.trim());else{let He="";try{He=(new URL(he.supabaseUrl||"").host||"").split(".")[0]||""}catch{}const Rt=He?`sb-${He}-auth-token`:"sb-auth-token",ut=typeof window<"u"?window.localStorage.getItem(Rt):null;if(ut)try{const qt=JSON.parse(ut),Kt=qt?.access_token||qt?.currentSession?.access_token;Kt&&he.realtime.setAuth(Kt)}catch{}}}catch{}const oe=he.channel(`loja:${V}`),Pe=qe=>{const He=qe?.table||qe?.table_name||"",Rt=qe?.new||qe?.old||{},ut=qe?.eventType||qe?.type||qe?.event||"";let qt=!0;if(He!=="comanda_itens"&&He!=="comanda_clientes"){const Kt=Rt?.codigo_empresa;Kt!=null&&Kt!==""&&(qt=String(Kt)===String(V||""))}if(!qt){try{console.log("[Realtime][Vendas] IGNORADO por empresa",{t:He,evt:ut,rowEmpresa:Rt?.codigo_empresa,codigoEmpresa:V})}catch{}return}try{console.log("[Realtime][Vendas] payload recebido",{t:He,evt:ut,row:Rt,codigoEmpresa:V})}catch{}(async()=>{try{await re({showToast:!1})}catch{}})()};if(oe.on("postgres_changes",{event:"*",schema:"public",table:"comandas"},Pe).on("postgres_changes",{event:"*",schema:"public",table:"comanda_itens"},Pe).on("postgres_changes",{event:"*",schema:"public",table:"comanda_clientes"},Pe).on("postgres_changes",{event:"*",schema:"public",table:"pagamentos",filter:`codigo_empresa=eq.${V}`},Pe).on("postgres_changes",{event:"*",schema:"public",table:"mesas"},Pe).subscribe(),T.current=oe,H.current)try{clearInterval(H.current)}catch{}return H.current=setInterval(async()=>{if(!sr.current)try{await re({showToast:!1})}catch{}},6e4),()=>{if(T.current){try{he.removeChannel(T.current)}catch{}T.current=null}if(X.current){try{clearTimeout(X.current)}catch{}X.current=null}if(H.current){try{clearInterval(H.current)}catch{}H.current=null}}},[t?.codigo_empresa]);const Fe=({table:V,provided:oe,isDragging:Pe})=>{const qe=Xat[V.status],He=qe.icon,Rt=Array.isArray(V.order)?V.order:[],ut=Rt.filter(nr=>String(nr.id||"").startsWith("tmp-")).reduce((nr,Wr)=>nr+Number(Wr.quantity||0)*Number(Wr.price||0),0),qt=Rt.filter(nr=>!String(nr.id||"").startsWith("tmp-")).reduce((nr,Wr)=>nr+Number(Wr.quantity||0)*Number(Wr.price||0),0),Kt=Number(V.totalHint||0);Me(V.customer);const At=V.status==="available"&&V.id===Xr,kr=V.status==="in-use"||V.status==="awaiting-payment"?(Kt>0?Kt:qt)+ut:0,_r=V.status==="available"?"text-success bg-success/10 border-success/30":V.status==="in-use"?"text-warning bg-warning/10 border-warning/30":"text-info bg-info/10 border-info/30";return a.jsxs("div",{ref:oe?.innerRef,"data-table-id":V.id,...oe?.draggableProps||{},className:gr("p-4 rounded-lg border bg-surface flex flex-col relative h-44 shadow-sm min-w-[240px]",Pe&&"shadow-lg",E==="tables"&&i?.id===V.id&&"ring-2 ring-brand/60 bg-surface-2",c?"cursor-pointer":"cursor-not-allowed opacity-60"),onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}cr(V)},children:[a.jsx("div",{...oe?.dragHandleProps||{},className:"absolute top-2 right-2 text-text-muted opacity-60 hover:opacity-100",children:a.jsx(Sue,{size:14})}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(He,{className:"w-5 h-5 text-text-secondary"}),a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("span",{className:"text-lg font-semibold text-text-primary truncate",children:V.name?V.name:`Mesa ${V.number}`}),At&&a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(V.status==="in-use"||V.status==="awaiting-payment")&&V.aberto_em&&a.jsxs("div",{className:"flex items-center gap-0.5 text-xs text-text-secondary",children:[a.jsx(yd,{className:"w-3.5 h-3.5 text-text-muted"}),a.jsx("span",{className:"font-medium",children:(()=>{try{const nr=new Date(V.aberto_em),Cr=new Date-nr,Yr=Math.floor(Cr/6e4),br=Math.floor(Yr/60),ir=Yr%60;return Yr<1?"agora":br===0?`${ir}m`:br>0&&ir===0?`${br}h`:`${br}h${ir}m`}catch{return""}})()})]}),a.jsx("span",{className:gr("text-[11px] font-medium px-2 py-0.5 rounded-full border flex-shrink-0",_r),children:qe.label})]})]}),a.jsx("div",{className:gr("flex-1 flex items-center justify-center"),children:V.status==="available"?a.jsx("img",{src:"/mesalivre.png",alt:"Mesa livre",className:gr("w-16 h-16 object-contain opacity-80",i?.id===V.id&&"opacity-100")}):V.status==="in-use"?a.jsx("img",{src:"/mesaocupada.png",alt:"Mesa ocupada",className:gr("w-16 h-16 object-contain opacity-80",i?.id===V.id&&"opacity-100")}):a.jsx("div",{className:gr("w-16 h-16 rounded-lg bg-info/20 border-2 border-info/40 flex items-center justify-center",i?.id===V.id&&"bg-info/30 border-info/60"),children:a.jsx(Go,{className:"w-8 h-8 text-info"})})}),a.jsx("div",{className:"w-full mt-auto",children:V.status==="in-use"||V.status==="awaiting-payment"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[a.jsx(yl,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),a.jsx("div",{className:"text-sm sm:text-base font-medium text-text-primary truncate",title:V.customer||"",children:Me(V.customer)||""})]}),a.jsxs("div",{className:"flex items-center gap-1 justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ko,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),a.jsxs("div",{className:"text-sm font-bold text-text-secondary",children:["R$ ",kr.toFixed(2)]})]}),a.jsx("button",{onClick:nr=>{nr.stopPropagation(),n(`/historico?mesa=${V.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:a.jsx(Go,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-xs text-text-muted",children:"Sem comanda"}),a.jsx("button",{onClick:nr=>{nr.stopPropagation(),n(`/historico?mesa=${V.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:a.jsx(Go,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})})]})},nt=()=>{const V=i?En(i.order,i):0,[oe,Pe]=p.useState(!1),[qe,He]=p.useState([]),[Rt,ut]=p.useState(1),[qt,Kt]=p.useState([]),At=p.useRef(new Map),kr=typeof window<"u"&&window.innerWidth<=640,_r=p.useRef(!1),nr=wr=>{const Br=String(wr||"").replace(/\D/g,"");return Br?Number(Br)/100:0},Wr=wr=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.max(0,Number(wr)||0)),Cr=wr=>{const Br=(Be||[]).find(dn=>String(dn.id)===String(wr.methodId)),Gr=Br&&Br.taxa_percentual!=null?Number(Br.taxa_percentual):0;return Number.isFinite(Gr)?Gr/100:0},Yr=()=>(qe||[]).reduce((wr,Br)=>wr+nr(Br.value),0);p.useEffect(()=>(mn.current=He,zn.current=ut,ot.current=i?.comandaId||null,()=>{mn.current=null,zn.current=null,ot.current=null}),[i?.comandaId]),p.useEffect(()=>{$t.current=qe||[]},[qe]);const br=(wr,Br)=>{try{if(kr)return;const Gr=(qe||[]).findIndex(dn=>dn.id===Br);if(Gr>=0){const dn=(qe||[])[Gr+1]||null;if(dn&&At.current.get(dn.id)){const sn=At.current.get(dn.id);setTimeout(()=>{try{sn.focus(),sn.select?.()}catch{}},0);return}}if(wr&&wr instanceof HTMLElement){const dn=Array.from(document.querySelectorAll('input[data-pay-value="1"]')),sn=dn.indexOf(wr);if(sn>=0&&dn[sn+1]){const or=dn[sn+1];setTimeout(()=>{try{or.focus(),or.select?.()}catch{}},0);return}}_r.current=!0,He(dn=>{const sn=qt[0]?.id||"",or=Be&&Be[0]&&Be[0].id?Be[0].id:null,rn=Rt,hr=[...dn,{id:rn,clientId:sn,methodId:or,value:"",chargeFee:!0}];return ut(xr=>xr+1),kr||setTimeout(()=>{const xr=At.current.get(rn);if(xr)try{xr.focus(),xr.select?.()}catch{}},0),hr})}catch{}};p.useEffect(()=>{let wr=!0;return(async()=>{try{if(!We||!i?.comandaId)return;let Gr=[],dn=[];try{const[$r,An]=await Promise.all([VGe({comandaId:i.comandaId,status:"Pendente",codigoEmpresa:t?.codigo_empresa}).catch(()=>[]),ai({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa}).catch(()=>[])]);Gr=Array.isArray($r)?$r:[],dn=(Array.isArray(An)?An:[]).map(Jr=>{const Bn=Jr?.cliente_id??Jr?.clientes?.id??Jr?.id??null,Aa=Jr?.clientes?.nome??Jr?.nome??Jr?.nome_livre??"";return!Bn&&Aa?{id:`livre-${Jr?.id||Math.random()}`,nome:Aa}:Bn?{id:Bn,nome:Aa}:null}).filter(Boolean)}catch{}if(!wr)return;if(Kt(dn),Array.isArray(Gr)&&Gr.length>0){const $r=Gr.map((An,$n)=>{const Jr=Number(An.valor||0),Aa={id:$n+1,clientId:An.cliente_id||null,methodId:An.finalizadora_id||null,chargeFee:!0},Ja=Cr(Aa),hs=Jr,Td=Aa.chargeFee!==!1?hs*(1+Ja):hs;return{...Aa,baseValue:hs,value:Wr(Td)}});He($r),ut($r.length+1),_r.current=!1;return}let sn=Be&&Be[0]&&Be[0].id?Be[0].id:null,or=dn[0]?.id||null,rn="";try{const An=(await uo({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).reduce(($n,Jr)=>$n+Number(Jr.quantidade||0)*Number(Jr.preco_unitario||0),0);An>0&&(rn=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(An))}catch{}const hr=nr(rn),xr={id:1,clientId:or,methodId:sn,baseValue:hr,chargeFee:!0},Ur=Cr(xr),tn=xr.chargeFee?hr*(1+Ur):hr;He([{...xr,value:Wr(tn)}]),ut(2),_r.current=!1}catch(Gr){console.error(Gr)}})(),()=>{wr=!1}},[We,i?.comandaId]),p.useEffect(()=>{if(!We||!i?.comandaId||!Array.isArray(qe)||qe.length===0||!_r.current)return;Tn.current&&clearTimeout(Tn.current);const wr=setTimeout(async()=>{if(_r.current)try{const Br=(qe||[]).map(Gr=>{const dn=Number(Gr.baseValue||0),sn=(Be||[]).find(rn=>String(rn.id)===String(Gr.methodId)),or=sn?.tipo||sn?.nome||"outros";return{clienteId:Gr.clientId||null,finalizadoraId:Gr.methodId||null,metodo:or,valor:dn}});fn.current=Date.now(),await sj({comandaId:i.comandaId,linhas:Br,codigoEmpresa:t?.codigo_empresa})}catch(Br){console.warn("[PayDialog] Falha ao salvar rascunho de pagamentos (debounced):",Br)}},400);return Tn.current=wr,()=>{clearTimeout(wr),Tn.current===wr&&(Tn.current=null)}},[We,i?.comandaId,qe,Be,t?.codigo_empresa]),p.useEffect(()=>{let wr=!0;return(async()=>{try{if(!We||Array.isArray(Be)&&Be.length>0)return;const Gr=await Hm({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});if(!wr)return;mt(Gr||[])}catch{}})(),()=>{wr=!1}},[We]),p.useEffect(()=>{We&&(!Array.isArray(Be)||Be.length===0||He(wr=>{if(!Array.isArray(wr)||wr.length===0)return wr;const Br=Be&&Be[0]&&Be[0].id?Be[0].id:null;if(!Br)return wr;let Gr=!1;const dn=wr.map(sn=>{if(!sn.methodId){Gr=!0;const or={...sn,methodId:Br},rn=Cr(or),hr=or.chargeFee!==!1?Number(or.baseValue||0)*(1+rn):Number(or.baseValue||0);return{...or,value:Wr(hr)}}return sn});return Gr?dn:wr}))},[We,Be]);const ir=async()=>{try{if(!i?.comandaId)return;const wr=t?.codigo_empresa;if(!wr){e({title:"Empresa no definida",variant:"destructive"});return}if(!Array.isArray(qe)||qe.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const $r of qe){if(!$r.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(nr($r.value)<=0){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}yt(!0);const Br=V>0?V:0,Gr=(qe||[]).reduce(($r,An)=>$r+nr(An.value),0),dn=(qe||[]).reduce(($r,An)=>{const $n=Number(An.baseValue||0),Jr=Cr(An);return $r+(An.chargeFee!==!1&&Jr>0?$n*Jr:0)},0),sn=Br+dn,or=Gr-sn,rn=Math.abs(or),hr=i.comandaId,xr=i.id;o($r=>$r.map(An=>An.id===xr?{...An,status:"available",order:[],comandaId:null,customer:null,totalHint:0}:An)),l($r=>$r&&$r.id===xr?null:$r),Ze(!1);try{yr(!1)}catch{}let Ur=V;if(Ur<=0)try{Ur=(await uo({comandaId:hr,codigoEmpresa:t?.codigo_empresa})||[]).reduce(($n,Jr)=>$n+Number(Jr.quantidade||0)*Number(Jr.preco_unitario||0),0)}catch{}Pe(!0),yt(!0),await Sf({codigoEmpresa:t?.codigo_empresa});try{const $r=(qe||[]).map(An=>{const $n=Number(An.baseValue||0),Jr=(Be||[]).find(Aa=>String(Aa.id)===String(An.methodId)),Bn=Jr?.tipo||Jr?.nome||"outros";return{clienteId:An.clientId||null,finalizadoraId:An.methodId||null,metodo:Bn,valor:$n}});await sj({comandaId:hr,linhas:$r,codigoEmpresa:wr})}catch($r){console.warn("[PayDialog] Falha ao salvar rascunho antes de promover:",$r)}await WGe({comandaId:hr,codigoEmpresa:wr}),await Jx({comandaId:hr,codigoEmpresa:t?.codigo_empresa,diferencaPagamento:or});try{t?.codigo_empresa&&localStorage.removeItem(`vendas:tables:${t.codigo_empresa}`)}catch{}try{const $r=await Gm(t?.codigo_empresa),An=await jc({codigoEmpresa:t?.codigo_empresa}),$n={};await Promise.all((An||[]).map(async Bn=>{try{const Ja=(await ai({comandaId:Bn.id,codigoEmpresa:t?.codigo_empresa})||[]).map(hs=>hs?.nome).filter(Boolean);$n[Bn.id]=Ja.length?Ja.join(", "):null}catch{$n[Bn.id]=null}}));const Jr=($r||[]).map(Bn=>{const Aa=(An||[]).find(Ja=>Ja.mesa_id===Bn.id);return{id:Bn.id,name:Bn.nome||`Mesa ${Bn.numero}`,status:Aa?"in-use":"available",comandaId:Aa?.id||null,customer:Aa?$n[Aa.id]:null,order:[],totalHint:0,aberto_em:Aa?.aberto_em||null}});o(Jr)}catch{}const tn=rn>.009?or>0?` | Diferena cobrada a mais: R$ ${rn.toFixed(2)}`:` | Diferena cobrada a menos: R$ ${rn.toFixed(2)}`:"";e({title:"Pagamento registrado",description:`Total itens R$ ${Ur.toFixed(2)} | Pagamentos R$ ${Gr.toFixed(2)}${tn}`,variant:"success"})}catch(wr){e({title:"Falha ao registrar pagamento",description:wr?.message||"Tente novamente",variant:"destructive"})}finally{Pe(!1),yt(!1)}};qe&&qe.length>0;const ht=V>0?V:0,Qr=(qe||[]).reduce((wr,Br)=>wr+nr(Br.value),0),ln=(qe||[]).reduce((wr,Br)=>{const Gr=Number(Br.baseValue||0),dn=Cr(Br);return wr+(Br.chargeFee!==!1&&dn>0?Gr*dn:0)},0),Ia=ht+ln,Ca=Qr-Ia,dr=Math.abs(Ca);return a.jsx(xn,{open:We,onOpenChange:Ze,children:a.jsxs(vn,{className:"sm:max-w-xl w-[92vw] h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:wr=>wr.stopPropagation(),onKeyDownCapture:wr=>wr.stopPropagation(),onPointerDownOutside:wr=>wr.stopPropagation(),onInteractOutside:wr=>wr.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-2xl font-bold",children:"Fechar Conta"}),a.jsx(Dn,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),a.jsxs("div",{className:"space-y-2",children:[(()=>{let wr=0,Br=0,Gr=0;for(const or of i?.order||[]){const rn=(or.price||0)*(or.quantity||1);wr+=rn,or.desconto_tipo==="percentual"&&or.desconto_valor>0?Br+=rn*(or.desconto_valor/100):or.desconto_tipo==="fixo"&&or.desconto_valor>0&&(Br+=or.desconto_valor)}const dn=wr-Br;i?.desconto_tipo==="percentual"&&i?.desconto_valor>0?Gr=dn*(i.desconto_valor/100):i?.desconto_tipo==="fixo"&&i?.desconto_valor>0&&(Gr=i.desconto_valor);const sn=Br+Gr;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-8 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-secondary",children:"Subtotal"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",wr.toFixed(2)]})]}),sn>0&&a.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[a.jsx("span",{children:"Descontos"}),a.jsxs("span",{className:"font-semibold",children:["-R$ ",sn.toFixed(2)]})]})]}),a.jsxs("div",{className:"border-t border-border pt-1 flex items-center justify-between",children:[a.jsx("div",{className:"font-semibold",children:"Total"}),a.jsxs("div",{className:"font-bold text-lg",children:["R$ ",V.toFixed(2)]})]})]})})(),a.jsxs("div",{className:"flex items-center gap-8 text-xs text-text-muted pt-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"Pagamentos"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",Qr.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"Diferena"}),a.jsx("span",{className:dr>.009?Ca>0?"font-semibold text-emerald-600":"font-semibold text-amber-600":"font-semibold",children:dr>.009?`${Ca>0?"+":"-"} R$ ${dr.toFixed(2)}`:"R$ 0,00"})]})]}),a.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1",children:[a.jsx(Le,{className:"block",children:"Pagamentos"}),(qe||[]).map((wr,Br)=>{const Gr=or=>{if(!or)return"Cliente";const rn=(qt||[]).find(hr=>String(hr.id)===String(or));return rn?.nome?rn.nome:"Cliente"},dn=(qt||[]).length>1,sn=(qt||[])[0]||null;return(qt||[]).filter(or=>String(or.id)!==String(sn?.id||"")),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-center",children:[a.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:qe.length>1&&Br>0&&a.jsx(me,{type:"button",variant:"outline",size:"sm",className:"h-8 w-8",onClick:()=>{_r.current=!0,He(or=>{const rn=or.filter(tn=>tn.id!==wr.id);if(rn.length===0)return[];const hr=V>0?V:0,xr=Math.floor(hr/rn.length*100)/100,Ur=hr-xr*rn.length;return rn.map((tn,$r)=>{const An=$r===rn.length-1?xr+Ur:xr,$n={...tn},Jr=Cr($n),Aa=$n.chargeFee!==!1&&Jr>0?An/(1+Jr):An;return{...$n,baseValue:Aa,value:Wr(An)}})})},children:""})}),Br===0?a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:Gr(sn?.id||wr.clientId)})}):dn?a.jsx("div",{className:"sm:col-span-4",children:a.jsxs(Nn,{value:wr.clientId||"",onValueChange:or=>He(rn=>rn.map(hr=>hr.id===wr.id?{...hr,clientId:or}:hr)),children:[a.jsx(bn,{className:"w-full truncate",children:a.jsx(Cn,{placeholder:"Cliente"})}),a.jsx(wn,{children:(qt||[]).map(or=>a.jsx(tt,{value:or.id,children:or.nome},or.id))})]})}):a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:Gr(sn?.id||wr.clientId)})}),a.jsx("div",{className:"sm:col-span-4",children:a.jsxs(Nn,{value:String(wr.methodId||""),onValueChange:or=>{_r.current=!0;const rn=(qe||[]).map(hr=>{if(hr.id!==wr.id)return hr;const xr=String(or),Ur={...hr,methodId:xr},tn=Cr(Ur),$r=Ur.chargeFee!==!1?Number(Ur.baseValue||0)*(1+tn):Number(Ur.baseValue||0);return{...Ur,value:Wr($r)}});He(rn);try{const hr=i?.comandaId,xr=t?.codigo_empresa;if(hr&&xr){const Ur=rn.map(tn=>{const $r=Number(tn.baseValue||0),An=(Be||[]).find(Jr=>String(Jr.id)===String(tn.methodId)),$n=An?.tipo||An?.nome||"outros";return{clienteId:tn.clientId||null,finalizadoraId:tn.methodId||null,metodo:$n,valor:$r}});fn.current=Date.now(),sj({comandaId:hr,linhas:Ur,codigoEmpresa:xr}).then(()=>{}).catch(tn=>{console.warn("[PayDialog] Falha ao salvar rascunho aps troca de finalizadora (bg):",tn),_r.current=!0}),_r.current=!1}}catch(hr){console.warn("[PayDialog] Falha ao salvar rascunho aps troca de finalizadora:",hr)}},children:[a.jsx(bn,{className:"w-full truncate",children:a.jsx(Cn,{placeholder:"Forma de pagamento"})}),a.jsx(wn,{children:(Be||[]).map(or=>a.jsx(tt,{value:String(or.id),children:or.nome},String(or.id)))})]})}),a.jsx("div",{className:"sm:col-span-3",children:a.jsx(Ye,{placeholder:"0,00",inputMode:"numeric",value:wr.value,"data-pay-value":"1",ref:or=>{or?At.current.set(wr.id,or):At.current.delete(wr.id)},onChange:or=>{_r.current=!0;const rn=(or.target.value||"").replace(/\D/g,""),hr=rn?Number(rn)/100:0;He(xr=>xr.map(Ur=>{if(Ur.id!==wr.id)return Ur;const tn=Cr(Ur),$r=Ur.chargeFee!==!1&&tn>0?hr/(1+tn):hr,An=Ur.chargeFee!==!1?$r*(1+tn):$r;return{...Ur,baseValue:$r,value:Wr(An)}}))},onKeyDown:or=>{if(or.stopPropagation(),or.key==="Enter"){or.preventDefault(),br(or.currentTarget,wr.id);return}["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(or.key)||/^[0-9]$/.test(or.key)||or.preventDefault()},onBeforeInput:or=>{const rn=or.data??"";rn&&/\D/.test(rn)&&or.preventDefault()}})}),a.jsx("div",{className:"sm:col-span-12 -mt-1 pl-1",children:(()=>{const or=Cr(wr),rn=or*100,hr=wr.chargeFee!==!1,xr=wr.baseValue!=null?Number(wr.baseValue):(()=>{const $r=(wr.value||"").toString().replace(/\D/g,""),An=$r?Number($r)/100:0;return hr&&or>0?An/(1+or):An})();if(!rn||rn<=0||!Number.isFinite(xr)||xr<=0)return null;const Ur=hr?xr*or:0;return a.jsxs("button",{type:"button",onClick:async()=>{_r.current=!0;const tn=(qe||[]).map($r=>{if($r.id!==wr.id)return $r;const An=Cr($r),$n=$r.chargeFee!==!1,Jr=$r.baseValue!=null?Number($r.baseValue):nr($r.value),Bn=$n?Jr:Jr*(1+An);return{...$r,chargeFee:!$n,baseValue:Jr,value:Wr(Bn)}});He(tn);try{const $r=i?.comandaId,An=t?.codigo_empresa;if($r&&An){const $n=tn.map(Jr=>({clienteId:Jr.clientId||null,finalizadoraId:Jr.methodId||null,metodo:(Be||[]).find(Bn=>String(Bn.id)===String(Jr.methodId))?.tipo||(Be||[]).find(Bn=>String(Bn.id)===String(Jr.methodId))?.nome||"outros",valor:Number(Jr.baseValue||0)}));fn.current=Date.now(),await sj({comandaId:$r,linhas:$n,codigoEmpresa:An}),_r.current=!1}}catch($r){console.warn("[PayDialog] Falha ao salvar rascunho aps alternar taxa:",$r)}},className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",hr?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:hr?"Desmarcar taxa":"Cobrar taxa",children:[a.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",hr?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),a.jsxs("span",{children:["Taxa R$ ",Ur.toFixed(2)]})]})})()})]},wr.id)}),a.jsx("div",{children:a.jsx(me,{type:"button",variant:"secondary",size:"sm",className:"pointer-events-auto",onPointerUp:wr=>{wr.preventDefault(),wr.stopPropagation(),_r.current=!0,He(Br=>{const Gr=qt[0]?.id||"",dn=Be&&Be[0]&&Be[0].id?Be[0].id:null,sn=[...Br,{id:Rt,clientId:Gr,methodId:dn,value:"",chargeFee:!0}],or=V>0?V:0,rn=Math.floor(or/sn.length*100)/100,hr=or-rn*sn.length;return sn.map((xr,Ur)=>{const tn=Ur===sn.length-1?rn+hr:rn,$r=Cr(xr),$n=xr.chargeFee!==!1&&$r>0?tn/(1+$r):tn;return{...xr,baseValue:$n,value:Wr(tn)}})}),ut(Br=>Br+1)},children:"Adicionar forma"})}),(()=>{const wr=Yr(),Br=(qe||[]).reduce((sn,or)=>{const rn=Number(or.baseValue||0),hr=Cr(or);return sn+(or.chargeFee!==!1&&hr>0?rn*hr:0)},0),dn=(V>0?V:0)+Br-wr;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[a.jsx("span",{children:"Soma"}),a.jsxs("span",{children:["R$ ",wr.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[a.jsx("span",{children:"Restante"}),a.jsxs("span",{className:Math.abs(dn)<.005?"text-success":"text-warning",children:["R$ ",dn.toFixed(2)]})]})]})})()]})]}),a.jsxs(ra,{className:"sticky bottom-0 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/75",children:[a.jsx(me,{type:"button",variant:"outline",onClick:()=>Ze(!1),disabled:oe,children:"Cancelar"}),a.jsx(me,{type:"button",onClick:ir,disabled:!(qe&&qe.length>0&&!oe),children:oe?"Processando...":"Confirmar Pagamento"})]})]})})},ft=Se.memo(({open:V,onOpenChange:oe,cashSummary:Pe})=>{const qe=ht=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(ht||0)),[He,Rt]=p.useState(!0);p.useEffect(()=>{Rt(!!V)},[V]);const ut=p.useMemo(()=>{const ht=Number(Pe?.saldo_inicial??Pe?.saldoInicial??0),Qr=Pe?.totalPorFinalizadora||Pe?.porFinalizadora||{},ln=Number(Pe?.totalEntradas??Pe?.entradas??0),Ia=ln>0?ln:Object.values(Qr||{}).reduce((Br,Gr)=>Br+Number(Gr||0),0),Ca=Number(Pe?.sangria??Pe?.totalSangria??0),dr=Number(Pe?.totalSaidas??Pe?.saidas??Ca),wr=Math.max(0,ht+Ia-dr);return{saldoInicial:ht,porFinalizadora:Qr,entradasInformadas:ln,entradasCalc:Ia,sangriaVal:Ca,saidas:dr,saldoAtual:wr}},[Pe]);p.useEffect(()=>{if(V&&Pe){const ht=setTimeout(()=>Rt(!1),50);return()=>clearTimeout(ht)}},[V,Pe]);const{porFinalizadora:qt,sangriaVal:Kt}=ut,[At,kr]=p.useState(!1),[_r,nr]=p.useState(""),[Wr,Cr]=p.useState(""),[Yr,br]=p.useState(!1),ir=async()=>{try{br(!0);const ht=String(_r||"").replace(/\D/g,""),Qr=ht?Number(ht)/100:0;if(Qr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await Sf({codigoEmpresa:t?.codigo_empresa}),await NT({tipo:"sangria",valor:Qr,observacao:Wr,codigoEmpresa:t?.codigo_empresa}),kr(!1),nr(""),Cr(""),await Tt(),e({title:"Sangria registrada",variant:"success"})}catch(ht){e({title:"Falha ao registrar sangria",description:ht?.message||"Tente novamente",variant:"destructive"})}finally{br(!1)}};return a.jsx(xn,{open:V,onOpenChange:oe,children:a.jsxs(vn,{forceMount:!0,className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:ht=>ht.preventDefault(),onKeyDown:ht=>ht.stopPropagation(),onKeyDownCapture:ht=>ht.stopPropagation(),onPointerDownOutside:ht=>ht.stopPropagation(),onInteractOutside:ht=>ht.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),a.jsx(Dn,{children:"Resumo da sesso atual do caixa."})]}),He||!Pe?a.jsxs("div",{className:"px-4 space-y-3",children:[a.jsx(lv,{className:"h-16 w-full"}),a.jsx(lv,{className:"h-16 w-full"}),a.jsx(lv,{className:"h-12 w-full"})]}):a.jsxs("div",{className:"px-1",children:[Object.keys(qt).length===0?a.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):a.jsxs(a.Fragment,{children:[a.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(qt).map(([ht,Qr])=>a.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(ht)}),a.jsx("span",{className:"text-sm font-semibold tabular-nums",children:qe(Qr)})]},ht))}),a.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),a.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:qe(Kt)})]})]}),a.jsx("div",{className:"mt-3 text-xs text-text-muted leading-relaxed px-1",children:'Sadas incluem sangrias e ajustes. Use "Registrar Sangria" para lanar uma retirada.'})]}),a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"mr-auto"}),a.jsx(me,{variant:"destructive",onClick:()=>kr(!0),children:"Registrar Sangria"}),a.jsx(me,{variant:"secondary",onClick:()=>oe(!1),children:"Fechar"})]}),a.jsx(xn,{open:At,onOpenChange:kr,children:a.jsxs(vn,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:ht=>ht.stopPropagation(),onKeyDownCapture:ht=>ht.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-xl font-bold",children:"Registrar Sangria"}),a.jsx(Dn,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"sangria-valor",children:"Valor"}),a.jsx(Ye,{id:"sangria-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:_r,onChange:ht=>{const Qr=(ht.target.value||"").replace(/\D/g,""),ln=Qr?Number(Qr)/100:0,Ia=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(ln);nr(Ia)},onKeyDown:ht=>{ht.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(ht.key)&&(/^[0-9]$/.test(ht.key)||ht.preventDefault())},onBeforeInput:ht=>{const Qr=ht.data??"";Qr&&/\D/.test(Qr)&&ht.preventDefault()}})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"sangria-obs",children:"Observao"}),a.jsx(Ye,{id:"sangria-obs",placeholder:"Opcional",value:Wr,onChange:ht=>Cr(ht.target.value)})]})]}),a.jsxs(ra,{children:[a.jsx(me,{variant:"outline",onClick:()=>kr(!1),disabled:Yr,children:"Cancelar"}),a.jsx(me,{onClick:ir,disabled:Yr,children:Yr?"Registrando...":"Confirmar"})]})]})})]})})}),Bt=()=>{const V=async()=>{if(K)try{await zv({itemId:K.id,codigoEmpresa:t?.codigo_empresa});try{await et(i)}catch{}e({title:"Item removido",description:K.name,variant:"warning"})}catch(oe){e({title:"Falha ao remover item",description:oe?.message||"Tente novamente",variant:"destructive"})}finally{J(!1),q(null)}};return a.jsx(Qd,{open:Y,onOpenChange:J,children:a.jsxs(ad,{children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Remover item?"}),a.jsxs(ld,{children:['Tem certeza que deseja remover "',K?.name,'" da comanda? Esta ao no pode ser desfeita.']})]}),a.jsxs(od,{children:[a.jsx(cd,{children:"Cancelar"}),a.jsx(Zd,{onClick:V,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})})},$e=()=>{const V=i,oe=V?.order||[],Pe=V?En(oe):0;return a.jsx(xn,{open:$,onOpenChange:ee,children:a.jsxs(vn,{className:"sm:max-w-xl w-[92vw] animate-none",onKeyDown:qe=>qe.stopPropagation(),onKeyDownCapture:qe=>qe.stopPropagation(),onPointerDownOutside:qe=>qe.stopPropagation(),onInteractOutside:qe=>qe.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsxs(un,{className:"text-2xl font-bold",children:["Comanda da Mesa ",V?.number??""]}),a.jsx(Dn,{children:V?.customer?`Cliente: ${V.customer}`:"Sem cliente vinculado"})]}),a.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto thin-scroll",children:oe.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhum item na comanda."}):a.jsx("ul",{className:"divide-y divide-border",children:oe.map(qe=>a.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:qe.name}),a.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",qe.quantity,"  Unit: R$ ",Number(qe.price||0).toFixed(2)]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("div",{className:"font-semibold",children:["R$ ",(Number(qe.price||0)*Number(qe.quantity||0)).toFixed(2)]})})]},qe.id))})}),a.jsxs(ra,{children:[a.jsxs("div",{className:"mr-auto text-sm font-semibold",children:["Total: R$ ",Pe.toFixed(2)]}),a.jsx(me,{variant:"secondary",onClick:()=>ee(!1),children:"Fechar"}),V?.comandaId&&a.jsxs(me,{variant:"outline",onClick:()=>window.open(`/print-comanda?comanda=${V.comandaId}`,"_blank"),children:[a.jsx(UH,{className:"mr-2 h-4 w-4"})," Imprimir"]}),a.jsxs(me,{onClick:async()=>{ee(!1),await zr()},disabled:!V||oe.length===0,children:[a.jsx(Ko,{className:"mr-2 h-4 w-4"})," Fechar Conta",a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]})})},Dt=p.useMemo(()=>$e,[i?.id,$]),Sr=({table:V})=>{const[oe,Pe]=p.useState(""),[qe,He]=p.useState(!1),[Rt,ut]=p.useState(!1),qt=async()=>{if(!(!V?.comandaId||qe))try{He(!0),await tKe({comandaId:V.comandaId,observacoes:oe,codigoEmpresa:Number(t?.codigo_empresa)}),e({title:"Observaes salvas",description:"As observaes da comanda foram atualizadas."});try{await et(V)}catch(Kt){console.error("Erro ao recarregar detalhes da comanda aps salvar observaes:",Kt)}}catch(Kt){Kt?.code!=="42804"&&(console.error("Erro ao salvar observao:",Kt),e({title:"Erro ao salvar observaes",description:"Tente novamente mais tarde.",variant:"destructive"}))}finally{He(!1)}};return p.useEffect(()=>{if(!V?.comandaId){Pe("");return}Pe(V.observacoes||"")},[V?.comandaId,V?.observacoes]),V?a.jsxs("div",{className:"flex flex-col h-full p-4 space-y-4 overflow-y-auto thin-scroll",children:[V.order&&V.order.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Le,{className:"text-sm font-semibold",children:"Descontos por Item"}),a.jsx(me,{size:"xs",variant:"ghost",className:"h-6 px-2 text-[11px]",onClick:()=>ut(Kt=>!Kt),children:Rt?"Esconder":`Mostrar (${V.order.length})`})]}),Rt&&a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:V.order.map(Kt=>a.jsx("button",{onClick:()=>it(Kt),className:"w-full p-3 rounded border border-border bg-surface hover:bg-surface-2 transition text-left",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-sm font-semibold truncate",children:Kt.name}),a.jsxs("p",{className:"text-xs text-text-secondary",children:["Qtd: ",Kt.quantity,"  R$ ",(Kt.price||0).toFixed(2)]})]}),a.jsx("div",{className:"text-right flex-shrink-0",children:Kt.desconto_valor>0?a.jsxs("span",{className:"text-xs font-bold text-destructive",children:["-",Kt.desconto_tipo==="percentual"?Kt.desconto_valor+"%":"R$"+(Kt.desconto_valor||0).toFixed(2)]}):a.jsx("span",{className:"text-xs text-text-muted",children:"Sem desconto"})})]})},Kt.id))})]}),V.comandaId&&a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx(Le,{className:"text-sm font-semibold",children:"Observaes"}),qe&&a.jsx("span",{className:"text-[11px] text-text-secondary",children:"Salvando..."})]}),a.jsx("textarea",{className:"border border-border rounded p-3 text-sm resize-none bg-background min-h-20",placeholder:"Ex: sem cebola, urgente, etc.",value:oe,onChange:Kt=>{const At=Kt.target.value;Pe(At)},onKeyDown:async Kt=>{Kt.key==="Enter"&&!Kt.shiftKey&&(Kt.preventDefault(),await qt())}})]}),V.comandaId&&a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{className:"text-sm font-semibold",children:"Desconto da Comanda"}),a.jsx(me,{size:"sm",variant:V.desconto_valor>0?"default":"outline",onClick:()=>be(!0),className:"w-full gap-2",children:V.desconto_valor>0?a.jsxs(a.Fragment,{children:[a.jsx("span",{children:"Desconto Ativo:"}),a.jsxs("span",{className:"font-bold",children:["-",V.desconto_tipo==="percentual"?V.desconto_valor+"%":"R$"+V.desconto_valor.toFixed(2)]})]}):"Aplicar Desconto"}),V.desconto_motivo&&a.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded border border-border",children:[a.jsx("strong",{children:"Motivo:"})," ",V.desconto_motivo]})]})]}):a.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Go,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),a.jsx("p",{children:"Selecione uma mesa"})]})})},Pr=({table:V})=>{if(!V)return a.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Xv,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),a.jsx("p",{children:"Selecione uma mesa para ver a comanda"})]})});if(Or)return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[a.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(me,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}ge(V),de(!0)},children:"Abrir Mesa"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:[a.jsx(lv,{className:"h-20 w-full"}),a.jsx(lv,{className:"h-20 w-full"}),a.jsx(lv,{className:"h-20 w-full"})]}),a.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[a.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary mb-2",children:[a.jsx("span",{children:"Total"}),a.jsx("span",{children:"R$ 0,00"})]}),a.jsx(me,{size:"lg",className:"w-full",disabled:!c,children:"Fechar Conta"})]})]});const oe=En(V.order,V),Pe=Me(V.customer),qe=async()=>{if(!V?.comandaId)return;const qt=(await uo({comandaId:V.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(_r=>({id:_r.id,productId:_r.produto_id,name:_r.descricao||"Item",price:Number(_r.preco_unitario||0),quantity:Number(_r.quantidade||1)})),Kt=(qt||[]).reduce((_r,nr)=>_r+Number(nr.price||0)*Number(nr.quantity||0),0);let At=V.customer||null;try{const nr=(await ai({comandaId:V.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Wr=>Wr?.nome).filter(Boolean);At=nr.length?nr.join(", "):null}catch{}const kr={...V,order:qt,customer:At,totalHint:Kt};l(kr),o(_r=>_r.map(nr=>nr.id===kr.id?kr:nr))},He=async(ut,qt)=>{try{const At=Number(ut.quantity||1)+qt;if(At<=0){q(ut),J(!0),setTimeout(async()=>{Y||await qe()},100);return}const kr=Number(ut.price||0)*Number(qt||0);kr&&(l(_r=>_r&&{..._r,totalHint:Math.max(0,Number(_r.totalHint||0)+kr)}),o(_r=>_r.map(nr=>nr.id===i?.id?{...nr,totalHint:Math.max(0,Number(nr.totalHint||0)+kr)}:nr))),await td({itemId:ut.id,quantidade:At,codigoEmpresa:t?.codigo_empresa}),await qe(),e({title:"Quantidade atualizada",description:`${ut.name}: ${At}`,variant:"success"})}catch(Kt){e({title:"Falha ao atualizar quantidade",description:Kt?.message||"Tente novamente",variant:"destructive"})}},Rt=async ut=>{q(ut),J(!0),setTimeout(async()=>{Y||await qe()},100)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col h-full",onMouseDown:ut=>{ut.target===ut.currentTarget&&ut.preventDefault()},children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-center md:justify-between gap-2",children:[Pe?a.jsx("div",{className:"hidden sm:block text-sm font-medium text-text-primary leading-none truncate",title:V.customer||"",children:Pe}):a.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),a.jsx("div",{className:"flex items-center gap-2",children:V.comandaId?a.jsxs(a.Fragment,{children:[a.jsxs(me,{size:"sm",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all flex items-center",onClick:()=>{_e(!0);try{w(!1)}catch{}try{W(!1)}catch{}try{Ze(!1)}catch{}try{yr(!1)}catch{}try{ee(!1)}catch{}},children:[a.jsx(yl,{size:12,className:"text-white/80 mr-1.5"}),"Clientes"]}),a.jsxs(me,{size:"sm",variant:"outline",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all",onClick:()=>ee(!0),children:[a.jsx("span",{className:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-black/40 border border-white/10 mr-1.5",children:a.jsx(Go,{size:12,className:"text-white/80"})}),"Comanda"]}),a.jsxs(Qd,{children:[a.jsx(Ip,{asChild:!0,children:a.jsx(me,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",children:"Cancelar"})}),a.jsxs(ad,{className:"sm:max-w-[420px] animate-none",onKeyDown:ut=>ut.stopPropagation(),children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Cancelar comanda?"}),a.jsx(ld,{children:"Esta ao no pode ser desfeita. Os itens sero descartados e a mesa voltar a ficar livre."})]}),a.jsxs(od,{children:[a.jsx(cd,{children:"Voltar"}),a.jsx(Zd,{disabled:at,onClick:async ut=>{const qt=ut.currentTarget.closest('[role="alertdialog"]');qt&&qt.querySelector("[data-radix-collection-item]")?.click();try{gt(!0);const Kt=t?.codigo_empresa;if(Kt)try{localStorage.removeItem(`vendas:selected:${Kt}`),localStorage.removeItem(`vendas:tables:${Kt}`)}catch{}await cz({comandaId:V.comandaId,codigoEmpresa:Kt}),l(null);try{yr(!1)}catch{}await re({showToast:!1}),e({title:"Comanda cancelada",variant:"success"})}catch(Kt){console.error("[Cancelar Comanda] Erro:",Kt),e({title:"Falha ao cancelar comanda",description:Kt?.message||"Tente novamente",variant:"destructive"});try{await re({showToast:!1})}catch(At){console.error("[Cancelar Comanda] Erro ao recarregar aps falha:",At)}}finally{gt(!1)}},children:"Confirmar Cancelamento"})]})]})]})]}):a.jsx(me,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}ge(V),de(!0)},children:"Abrir Mesa"})})]}),a.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-3 thin-scroll",children:V.order.length===0?a.jsx("div",{className:"text-center text-text-muted pt-16",children:a.jsx("p",{children:"Comanda vazia. Adicione produtos na aba ao lado."})}):a.jsx("ul",{className:"space-y-3",children:V.order.map(ut=>a.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("p",{className:"text-sm font-semibold text-text-primary truncate",title:ut.name,children:ut.name})}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(me,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>He(ut,-1),children:a.jsx(Iv,{size:12})}),a.jsx("span",{className:"w-7 text-center font-semibold text-sm",children:ut.quantity}),a.jsx(me,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>He(ut,1),children:a.jsx(ns,{size:12})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"text-right flex-1",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsxs("span",{className:"font-bold text-text-primary",children:["R$ ",(ut.price*ut.quantity).toFixed(2)]}),ut.desconto_valor>0&&a.jsxs("span",{className:"text-xs font-semibold text-destructive",children:["-",ut.desconto_tipo==="percentual"?ut.desconto_valor+"%":"R$"+(ut.desconto_valor||0).toFixed(2)]})]})}),a.jsx(me,{variant:"ghost",size:"icon",className:"text-danger/80 hover:text-danger h-7 w-7",onClick:()=>Rt(ut),children:a.jsx(zu,{size:14})})]})]})]},ut.id))})}),a.jsxs("div",{className:"p-3 border-t border-border mt-auto space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",oe.toFixed(2)]})]}),a.jsxs(me,{size:"lg",className:"w-full",onClick:zr,children:[a.jsx(Ko,{className:"mr-2"})," Fechar Conta",a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]}),a.jsx(nt,{})]})},vr=()=>{const[V,oe]=p.useState(""),[Pe,qe]=p.useState(""),He=async()=>{try{if(ce)return;le(!0);const Rt=(V??"").toString().trim(),ut=Rt?Number(Rt):void 0;if(ut!==void 0&&(Number.isNaN(ut)||ut<=0)){e({title:"Nmero invlido",description:"Informe um nmero positivo.",variant:"warning"});return}const qt=await HGe({numero:ut,nome:(Pe||"").trim()||void 0,codigoEmpresa:t?.codigo_empresa}),Kt={id:qt.id,number:qt.numero,name:qt.nome,status:"available",order:[],customer:null,comandaId:null,totalHint:0};o(At=>(At.some(nr=>nr.id===Kt.id)?At.map(nr=>nr.id===Kt.id?Kt:nr):[...At,Kt]).slice().sort((nr,Wr)=>Number(nr.number)-Number(Wr.number))),Se.startTransition(()=>{l(Kt),Te(!1)}),e({title:"Mesa criada",description:`Mesa ${qt.numero} adicionada`,variant:"success"}),oe(""),qe("")}catch(Rt){e({title:"Falha ao criar mesa",description:Rt?.message||"Tente novamente",variant:"destructive"})}finally{le(!1)}};return a.jsx(xn,{open:ue,onOpenChange:Rt=>{Te(Rt),Rt||(oe(""),qe(""))},children:a.jsxs(vn,{className:"sm:max-w-md w-[92vw]",children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-2xl font-bold",children:"Nova Mesa"}),a.jsx(Dn,{children:"Informe o nome da mesa. Se deixar em branco, ser criada com numerao automtica."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(Le,{htmlFor:"nova-mesa-nome",children:"Nome da mesa"}),a.jsx(Ye,{id:"nova-mesa-nome",type:"text",placeholder:"Ex: Mesa 1, Varanda, etc.",value:Pe,onChange:Rt=>qe(Rt.target.value),onKeyDown:Rt=>{Rt.stopPropagation(),Rt.key==="Enter"&&!ce&&(Rt.preventDefault(),He())},onKeyPress:Rt=>Rt.stopPropagation()})]}),a.jsxs(ra,{children:[a.jsx(me,{type:"button",variant:"outline",onClick:()=>Te(!1),disabled:ce,children:"Cancelar"}),a.jsx(me,{type:"button",onClick:He,disabled:ce,children:ce?"Criando...":"Criar Mesa"})]})]})})},yn=async V=>{try{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}if(!i?.comandaId){e({title:"Selecione uma mesa",description:"Abra a comanda clicando na mesa primeiro.",variant:"destructive"});return}const oe=Number(V.stock??V.currentStock??0),Pe=y.get(String(V.id))||0,qe=Math.max(0,oe-Pe);if(((i?.order||[]).find(Cr=>String(Cr.productId)===String(V.id))?.quantity||0)+1>qe){e({title:"Estoque insuficiente",description:`${V.name} - Estoque disponvel: ${qe} (${oe} total, ${Pe} reservado em outras comandas)`,variant:"destructive"});return}const ut=Number(V.salePrice??V.price??0),Kt=(await uo({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).find(Cr=>String(Cr.produto_id)===String(V.id));let At;if(Kt){const Cr=Number(Kt.quantidade||0);await td({itemId:Kt.id,quantidade:Cr+1,codigoEmpresa:t?.codigo_empresa}),At={id:Kt.id,productId:Kt.produto_id,name:Kt.descricao||V.name,price:ut,quantity:Cr+1}}else At=await ST({comandaId:i.comandaId,produtoId:V.id,descricao:V.name,quantidade:1,precoUnitario:ut,codigoEmpresa:t?.codigo_empresa});const _r=(await uo({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Cr=>({id:Cr.id,productId:Cr.produto_id,name:Cr.descricao||"Item",price:Number(Cr.preco_unitario||0),quantity:Number(Cr.quantidade||1)})),nr=(_r||[]).reduce((Cr,Yr)=>Cr+Number(Yr.price||0)*Number(Yr.quantity||0),0),Wr={...i,order:_r,totalHint:nr};l(Wr),o(Cr=>Cr.map(Yr=>Yr.id===Wr.id?Wr:Yr));try{const Cr=await Lm({codigoEmpresa:t?.codigo_empresa}),Yr=new Map;for(const br of Cr||[]){const ir=String(br.produto_id),ht=Number(br.quantidade||0);Yr.set(ir,(Yr.get(ir)||0)+ht)}x(Yr)}catch(Cr){console.error("[addProductToComanda] Erro ao atualizar estoque reservado:",Cr)}ct(V.id),setTimeout(()=>{ct(Cr=>Cr===V.id?null:Cr)},500),e({title:"Produto adicionado",variant:"success"})}catch(oe){console.error("[addProductToComanda] EXCEPTION:",oe),e({title:"Falha ao adicionar produto",description:oe?.message||"Tente novamente",variant:"destructive"})}},On=()=>{const[V,oe]=p.useState(""),[Pe,qe]=p.useState("all"),He=p.useRef(null),Rt=p.useRef(0),ut=p.useRef(null),Kt=(fe||[]).slice().sort((At,kr)=>{const _r=At.code||"",nr=kr.code||"";return/^\d+$/.test(_r)&&/^\d+$/.test(nr)?parseInt(_r,10)-parseInt(nr,10):_r.localeCompare(nr)}).filter(At=>{const kr=V.trim().toLowerCase(),_r=!kr||(At.name||"").toLowerCase().includes(kr)||String(At.code||"").toLowerCase().includes(kr);if(Pe==="all")return _r;const nr=Number(At.stock??At.currentStock??0),Wr=y.get(String(At.id))||0,Cr=Math.max(0,nr-Wr);return Pe==="available"?_r&&Cr>0:Pe==="low"?_r&&Cr>0&&Cr<=5:Pe==="out"?_r&&Cr<=0:_r});return i?a.jsx(xn,{open:b,onOpenChange:At=>{if(w(At),A(At?"panel":"tables"),At)try{yr(!1)}catch{}},children:a.jsxs(vn,{overlayClassName:"z-[88]",className:"w-[95vw] sm:max-w-4xl max-h-[80vh] sm:max-h-[85vh] flex flex-col p-0 gap-0 focus:outline-none focus-visible:outline-none !overflow-visible z-[89]",style:{scrollBehavior:"auto"},onOpenAutoFocus:At=>{At.preventDefault(),A("panel")},onWheel:At=>{At.stopPropagation()},onKeyDown:At=>{const kr=At.target,_r=kr&&(kr.tagName==="INPUT"||kr.closest("input")),nr=kr&&kr.closest("[data-product-card]");if(!["ArrowDown","ArrowUp","Home","End","Enter","Delete","Escape"].includes(At.key)||_r||nr)return;At.preventDefault(),At.stopPropagation();const Wr=C||0,Cr=Kt.length;if(At.key==="ArrowDown"){const Yr=Math.min(Wr+1,Cr-1);P(Yr),Rt.current=Yr,requestAnimationFrame(()=>j.current[Yr]?.focus());return}if(At.key==="ArrowUp"){const Yr=Math.max(Wr-1,0);P(Yr),Rt.current=Yr,requestAnimationFrame(()=>j.current[Yr]?.focus());return}if(At.key==="Home"){P(0),Rt.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(At.key==="End"){const Yr=Math.max(0,Cr-1);P(Yr),Rt.current=Yr,requestAnimationFrame(()=>j.current[Yr]?.focus());return}if(At.key==="Escape"){w(!1);return}},children:[a.jsxs(pn,{className:"px-6 py-4 border-b border-border",children:[a.jsxs(un,{className:"text-2xl font-bold flex items-center gap-3",children:[a.jsx(Xv,{className:"w-6 h-6 text-brand"}),"Adicionar Produtos"]}),a.jsxs(Dn,{className:"text-base mt-2",children:["Mesa ",i.number,"  ",Me(i.customer)||"Sem cliente"]})]}),a.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-border bg-surface/50",children:[a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted"}),a.jsx("input",{ref:He,type:"text",className:"w-full pl-10 pr-4 py-3 text-base rounded-lg bg-background border-2 border-border focus:border-brand focus:ring-2 focus:ring-brand/20 transition-all outline-none",placeholder:"Digite o nome ou cdigo do produto...",value:V,onChange:At=>oe(At.target.value),onClick:At=>{At.stopPropagation(),At.currentTarget.focus(),A("panel")},onFocus:At=>{At.stopPropagation(),A("panel")},onKeyDown:At=>{if(At.stopPropagation(),At.nativeEvent&&typeof At.nativeEvent.stopImmediatePropagation=="function"&&At.nativeEvent.stopImmediatePropagation(),A("panel"),["ArrowDown","ArrowUp","Home","End","Escape"].includes(At.key)){At.preventDefault();const kr=C||0,_r=Kt.length;if(At.key==="ArrowDown"){P(Math.min(kr+1,_r-1));return}if(At.key==="ArrowUp"){P(Math.max(kr-1,0));return}if(At.key==="Home"){P(0);return}if(At.key==="End"){P(_r-1);return}if(At.key==="Escape"){w(!1);return}}}})]}),a.jsxs("div",{className:"flex items-center justify-between gap-4 mt-3",children:[a.jsx("button",{onClick:()=>qe("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${Pe==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),a.jsx("button",{onClick:()=>qe("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${Pe==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),a.jsx("button",{onClick:()=>qe("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${Pe==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),a.jsx("button",{onClick:()=>qe("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${Pe==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"}),a.jsxs("div",{className:"hidden sm:flex items-center gap-2 ml-auto text-xs text-text-muted flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:""}),a.jsx("span",{children:"Navegar"})]}),a.jsx("div",{className:"w-px h-3 bg-border"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:"Esc"}),a.jsx("span",{children:"Fechar"})]})]})]})]}),a.jsx("div",{ref:ut,className:"flex-1 overflow-y-auto px-6 py-4 focus:outline-none",tabIndex:-1,onKeyDown:At=>{["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(At.key)&&(At.preventDefault(),At.stopPropagation(),At.nativeEvent&&typeof At.nativeEvent.stopImmediatePropagation=="function"&&At.nativeEvent.stopImmediatePropagation()),At.stopPropagation();const kr=At.target,_r=kr&&(kr.tagName==="INPUT"||kr.closest("input"));if(!["ArrowDown","ArrowUp","Home","End","Escape"].includes(At.key)||_r)return;const nr=C||0,Wr=Kt.length;if(At.key==="ArrowDown"){const Cr=Math.min(nr+1,Wr-1);P(Cr),Rt.current=Cr,requestAnimationFrame(()=>j.current[Cr]?.focus());return}if(At.key==="ArrowUp"){const Cr=Math.max(nr-1,0);P(Cr),Rt.current=Cr,requestAnimationFrame(()=>j.current[Cr]?.focus());return}if(At.key==="Home"){P(0),Rt.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(At.key==="End"){const Cr=Math.max(0,Wr-1);P(Cr),Rt.current=Cr,requestAnimationFrame(()=>j.current[Cr]?.focus());return}if(At.key==="Escape"){w(!1);return}},children:Kt.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[a.jsx(Xv,{className:"w-16 h-16 text-text-muted mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto encontrado"}),a.jsx("p",{className:"text-text-muted mb-4",children:"Tente ajustar sua busca ou cadastre novos produtos"}),a.jsxs(me,{onClick:()=>{w(!1),n("/produtos")},children:[a.jsx(ns,{className:"w-4 h-4 mr-2"}),"Cadastrar Produtos"]})]}):a.jsx("div",{className:"flex flex-col gap-1.5",children:Kt.map((At,kr)=>{const _r=(i?.order||[]).reduce((ir,ht)=>ir+(String(ht.productId)===String(At.id)?Number(ht.quantity||0):0),0),nr=Number(At.stock??At.currentStock??0),Wr=y.get(String(At.id))||0,Cr=Math.max(0,nr-Wr),Yr=kr===C,br=At.id===Qt;return a.jsxs("div",{ref:ir=>{j.current[kr]=ir},"data-product-card":!0,className:gr("flex items-center gap-2 sm:gap-4 p-2.5 sm:p-3 rounded-lg border-2 transition-colors duration-500 outline-none focus:outline-none focus-visible:outline-none",Cr===0&&_r===0?"opacity-50 cursor-not-allowed bg-surface-2 border-border":"cursor-pointer",Yr?"border-brand bg-brand/5 shadow-md":Cr>0?"border-border bg-surface hover:border-brand/50 hover:bg-surface-2":_r>0?"border-border bg-surface":"border-border",br&&"bg-brand/8"),tabIndex:Cr>0||_r>0?0:-1,onKeyDown:ir=>{if(["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(ir.key)&&(ir.preventDefault(),ir.stopPropagation(),ir.nativeEvent&&typeof ir.nativeEvent.stopImmediatePropagation=="function"&&ir.nativeEvent.stopImmediatePropagation()),!["ArrowDown","ArrowUp","Home","End","Escape"].includes(ir.key))return;ir.stopPropagation();const ht=Kt.length;if(ir.key==="ArrowDown"){const Qr=Math.min(kr+1,ht-1);P(Qr),Rt.current=Qr,requestAnimationFrame(()=>j.current[Qr]?.focus());return}if(ir.key==="ArrowUp"){const Qr=Math.max(kr-1,0);P(Qr),Rt.current=Qr,requestAnimationFrame(()=>j.current[Qr]?.focus());return}if(ir.key==="Home"){P(0),Rt.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(ir.key==="End"){const Qr=Math.max(0,ht-1);P(Qr),Rt.current=Qr,requestAnimationFrame(()=>j.current[Qr]?.focus());return}if(ir.key==="Escape"){w(!1);return}},onClick:()=>{Cr===0&&_r===0||(P(kr),Rt.current=kr,requestAnimationFrame(()=>j.current[kr]?.focus()))},onMouseDown:ir=>{if(Cr===0&&_r===0){ir.preventDefault();return}ir.currentTarget.focus()},children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[At.code&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-mono font-semibold bg-surface-2 border border-border rounded",children:At.code}),a.jsx("h4",{className:"font-semibold text-sm sm:text-base text-text-primary truncate",children:At.name})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px] sm:text-xs mt-0.5",children:[a.jsx("span",{className:gr("font-bold",Cr===0?"text-text-muted":"text-brand"),children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(At.salePrice??At.price??0))}),a.jsxs("span",{className:"text-text-muted whitespace-nowrap",children:["Estoque: ",a.jsx("span",{className:gr("font-semibold",Cr<=5?"text-destructive":"text-text-secondary"),children:Cr})]}),_r>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-brand/10 text-brand text-[11px] font-semibold rounded whitespace-nowrap",children:[_r,"x na comanda"]})]})]}),a.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[a.jsx(me,{size:"icon",variant:"outline",onClick:ir=>{ir.stopPropagation(),Lt(At)},disabled:_r===0,className:"h-8 w-8 p-0",children:a.jsx(Iv,{className:"w-4 h-4"})}),a.jsx(me,{size:"icon",onClick:ir=>{ir.stopPropagation(),yn(At)},disabled:Cr===0,className:"h-8 w-8 p-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",children:a.jsx(ns,{className:"w-4 h-4"})})]})]},At.id)})},(i?.order||[]).map(At=>`${String(At.productId)}:${Number(At.quantity||0)}`).join("|"))}),a.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t border-border bg-surface/50",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2",children:[a.jsxs("div",{className:"hidden sm:block text-sm text-text-muted",children:[Kt.length," produto",Kt.length!==1?"s":"","  ",(i.order||[]).length," ite",(i.order||[]).length!==1?"ns":"m"," na comanda"]}),a.jsxs("div",{className:"flex items-center justify-end gap-3 w-full sm:w-auto",children:[a.jsxs("div",{className:"text-left sm:text-right",children:[a.jsx("div",{className:"text-xs text-text-muted",children:"Total"}),a.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i.totalHint||0)})]}),a.jsx(me,{onClick:()=>w(!1),className:"px-4 sm:px-6 min-w-[96px] sm:min-w-[120px]",size:"sm",children:"Concluir"})]})]})})]})]})}):null},[Xn,kn]=p.useState(null),[cn,Hr]=p.useState([]),[va,Ma]=p.useState(!1),[xa,$a]=p.useState(""),[oo,ss]=p.useState(!1),[xs,So]=p.useState([]),[vi,Od]=p.useState(!1),[xi,Uc]=p.useState(null),[Li,El]=p.useState([]),[af,nc]=p.useState(!1),[Ms,ys]=p.useState(null),sf=p.useRef(null);p.useEffect(()=>{sf.current=Xn},[Xn]);const bu=p.useMemo(()=>{const V=new Map;for(const oe of cn||[]){const Pe=oe.productId,qe=Number(oe.quantity||0);V.set(Pe,(V.get(Pe)||0)+qe)}return V},[cn]),Fo=async V=>{if(!V)return;const Pe=(await uo({comandaId:V,codigoEmpresa:t?.codigo_empresa})||[]).map(qe=>({id:qe.id,productId:qe.produto_id,name:qe.descricao||"Item",price:Number(qe.preco_unitario||0),quantity:Number(qe.quantidade||1)}));Hr(Pe)},yi=async V=>{try{const oe=t?.codigo_empresa;if(!oe){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}let Pe=Xn;if(!Pe){if(Pe=(await Zj({codigoEmpresa:oe}))?.id,!Pe){e({title:"Falha ao iniciar venda no balco",description:"No foi possvel criar ou recuperar a comanda.",variant:"destructive"});return}kn(Pe)}const qe=Number(V.salePrice??V.price??0);await ST({comandaId:Pe,produtoId:V.id,descricao:V.name,quantidade:1,precoUnitario:qe,codigoEmpresa:oe}),await Fo(Pe),e({title:"Produto adicionado (balco)",description:V.name,variant:"success"})}catch(oe){e({title:"Falha ao adicionar produto (balco)",description:oe?.message||"Tente novamente",variant:"destructive"})}},of=async V=>{if(!(!Xn||!V)){ss(!1);try{await ub({comandaId:Xn,clienteIds:[V],nomesLivres:[],codigoEmpresa:t?.codigo_empresa}),Uc(V),El(oe=>{const Pe=new Set((oe||[]).map(qe=>String(qe)));return Pe.add(String(V)),Array.from(Pe)}),$a(""),So([]),e({title:"Cliente associado",variant:"success"})}catch(oe){e({title:"Falha ao associar cliente",description:oe?.message||"Tente novamente",variant:"destructive"}),ss(!0)}}},nl=async()=>{if(Xn)try{const V=En(cn,null);if(V<=0){e({title:"Sem itens",description:"Adicione itens antes de pagar.",variant:"warning"});return}Ma(!0),await Sf({codigoEmpresa:t?.codigo_empresa});let oe=Be;if(!Array.isArray(oe)||oe.length===0)try{oe=await Hm({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa}),mt(oe)}catch{}const Pe=oe?.[0],qe=Pe?.tipo||Pe?.nome||"outros";await BM({comandaId:Xn,finalizadoraId:Pe?.id,metodo:qe,valor:V,codigoEmpresa:t?.codigo_empresa}),await Jx({comandaId:Xn,codigoEmpresa:t?.codigo_empresa}),e({title:"Pagamento registrado (balco)",description:`R$ ${V.toFixed(2)}`,variant:"success"}),Hr([]),kn(null),m(!1)}catch(V){e({title:"Falha no pagamento (balco)",description:V?.message||"Tente novamente",variant:"destructive"})}finally{Ma(!1)}},Ie=()=>{p.useEffect(()=>{let oe=!0;return(async()=>{if(h)try{Ma(!0);const qe=t?.codigo_empresa;if(!qe){oe&&e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}const He=await qv({codigoEmpresa:qe});if(!oe)return;if(He?.id){kn(He.id),await Fo(He.id);try{const Rt=await ai({comandaId:He.id,codigoEmpresa:qe}),ut=(Rt||[]).map(Kt=>Kt?.cliente_id).filter(Boolean).map(Kt=>String(Kt));El(ut);const qt=Array.isArray(Rt)&&Rt.length>0?Rt[0]:null;qt?.cliente_id&&Uc(qt.cliente_id)}catch{}}else kn(null),Hr([])}catch(qe){oe&&e({title:"Falha ao abrir Modo Balco",description:qe?.message||"Tente novamente",variant:"destructive"})}finally{oe&&Ma(!1)}})(),()=>{oe=!1}},[h]),p.useEffect(()=>{if(!oo)return;let oe=!0;const qe=setTimeout(async()=>{try{Od(!0);const He=await db({searchTerm:xa,limit:20,codigoEmpresa:t?.codigo_empresa});oe&&So(He||[])}catch{oe&&So([])}finally{oe&&Od(!1)}},250);return()=>{oe=!1,clearTimeout(qe)}},[oo,xa]);const V=En(cn,null);return a.jsx(xn,{open:h,onOpenChange:m,children:a.jsxs(vn,{className:"max-w-4xl h-[90vh]",onKeyDown:oe=>oe.stopPropagation(),onKeyDownCapture:oe=>oe.stopPropagation(),onPointerDownOutside:oe=>oe.stopPropagation(),onInteractOutside:oe=>oe.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-2xl font-bold",children:"Modo Balco"}),a.jsx(Dn,{children:"Venda rpida para clientes sem mesa."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-6 h-full overflow-hidden pt-4",children:[a.jsxs("div",{className:"col-span-1 flex flex-col border-r border-border pr-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Catlogo de Produtos"}),a.jsx(me,{variant:"outline",size:"sm",onClick:()=>ss(!0),children:xi?a.jsxs(a.Fragment,{children:[a.jsx(Do,{className:"mr-1 h-4 w-4 text-success"})," Cliente"]}):"Cliente"})]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar produto...",className:"pl-9",value:xa,onChange:oe=>$a(oe.target.value),ref:_})]}),a.jsx("div",{className:"flex-1 overflow-y-auto -mr-4 pr-4 thin-scroll",children:a.jsxs("ul",{className:"space-y-2",children:[(fe||[]).filter(oe=>{const Pe=xa.trim().toLowerCase();return Pe?(oe.name||"").toLowerCase().includes(Pe)||(oe.code||"").toLowerCase().includes(Pe):!0}).sort((oe,Pe)=>{const qe=oe.code||"",He=Pe.code||"";return/^\d+$/.test(qe)&&/^\d+$/.test(He)?parseInt(qe,10)-parseInt(He,10):qe.localeCompare(He)}).map(oe=>{const Pe=(cn||[]).reduce((ut,qt)=>ut+(String(qt.productId)===String(oe.id)?Number(qt.quantity||0):0),0),qe=Number(oe.stock??oe.currentStock??0),He=y.get(String(oe.id))||0,Rt=Math.max(0,qe-He);return a.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors",onClick:()=>{ys(oe),nc(!0)},children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("p",{className:"font-semibold truncate",title:`${oe.code?`[${oe.code}] `:""}${oe.name}`,children:[oe.code&&a.jsxs("span",{className:"text-text-muted",children:["[",oe.code,"]"]})," ",oe.name]}),Pe>0&&a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",Pe]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Number(oe.salePrice??oe.price??0).toFixed(2)]}),a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",Rt]})]})]}),a.jsx(me,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:ut=>{ut.stopPropagation(),yi(oe)},"aria-label":`Adicionar ${oe.name}`,children:a.jsx(ns,{size:16})})]},oe.id)}),(!fe||fe.length===0)&&a.jsxs("li",{className:"text-center text-text-muted py-8",children:[a.jsx("div",{className:"mb-3",children:"Nenhum produto cadastrado. Cadastre produtos para vender no balco."}),a.jsx(me,{size:"sm",onClick:()=>n("/produtos"),children:"Cadastrar Produtos"})]})]})})]}),a.jsxs("div",{className:"col-span-1 flex flex-col",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Comanda do Balco"}),a.jsx("div",{className:"flex-1 overflow-y-auto bg-surface-2 rounded-lg p-4 thin-scroll",children:cn.length===0?a.jsx("p",{className:"text-center text-text-muted pt-16",children:"Adicione produtos  comanda."}):a.jsx("ul",{className:"divide-y divide-border",children:cn.map(oe=>a.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:oe.name}),a.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",oe.quantity,"  Unit: R$ ",Number(oe.price||0).toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"font-semibold mr-2",children:["R$ ",(Number(oe.price||0)*Number(oe.quantity||0)).toFixed(2)]}),a.jsx(me,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{const Pe=Number(oe.quantity||1)-1;if(Pe<=0)q(oe),J(!0),setTimeout(async()=>{Y||await Fo(Xn)},100);else try{await td({itemId:oe.id,quantidade:Pe,codigoEmpresa:t?.codigo_empresa}),await Fo(Xn)}catch(qe){e({title:"Falha ao atualizar",description:qe?.message||"Tente novamente",variant:"destructive"})}},children:a.jsx(Iv,{size:14})}),a.jsx("span",{className:"w-8 text-center font-semibold",children:oe.quantity}),a.jsx(me,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{try{await td({itemId:oe.id,quantidade:Number(oe.quantity||1)+1,codigoEmpresa:t?.codigo_empresa}),await Fo(Xn)}catch(Pe){e({title:"Falha ao atualizar",description:Pe?.message||"Tente novamente",variant:"destructive"})}},children:a.jsx(ns,{size:14})})]})]},oe.id))})}),a.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[a.jsxs("div",{className:"flex justify-between items-center text-xl font-bold mb-4",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",V.toFixed(2)]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(Qd,{children:[a.jsx(Ip,{asChild:!0,children:a.jsx(me,{size:"lg",className:"flex-1 bg-red-600 hover:bg-red-500 text-white border border-red-600/70",children:"Cancelar"})}),a.jsxs(ad,{className:"sm:max-w-[420px] animate-none",onKeyDown:oe=>oe.stopPropagation(),children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Cancelar comanda do balco?"}),a.jsx(ld,{children:"Os itens sero descartados e o balco ser limpo. Esta ao no pode ser desfeita."})]}),a.jsxs(od,{children:[a.jsx(cd,{children:"Voltar"}),a.jsx(Zd,{onClick:async()=>{try{if(!Xn){m(!1);return}await cz({comandaId:Xn,codigoEmpresa:t?.codigo_empresa}),Hr([]),kn(null),m(!1),e({title:"Comanda cancelada (balco)",variant:"success"})}catch(oe){e({title:"Falha ao cancelar",description:oe?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Cancelamento"})]})]})]}),a.jsxs(me,{size:"lg",className:"flex-1",onClick:nl,disabled:va||V<=0,children:[a.jsx(Ko,{className:"mr-2"})," Finalizar Pagamento"]})]})]})]})]}),oo&&a.jsx("div",{className:"absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center",onClick:oe=>{oe.target===oe.currentTarget&&ss(!1)},onKeyDown:oe=>{oe.key==="Escape"&&ss(!1)},children:a.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-lg w-full max-w-md p-4",role:"dialog","aria-modal":"true",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Selecionar Cliente"}),a.jsx(me,{variant:"ghost",size:"sm",onClick:()=>ss(!1),children:"Fechar"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:xa,onChange:oe=>$a(oe.target.value)})]}),a.jsx("div",{className:"max-h-64 overflow-auto thin-scroll border rounded-md",children:vi?a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Carregando clientes..."}):xs.length>0?a.jsx("ul",{children:xs.map(oe=>{const Pe=Array.isArray(Li)&&Li.includes(String(oe.id));return a.jsxs("li",{className:gr("p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2",Pe&&"bg-surface-2"),onClick:()=>of(oe.id),children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium",children:[oe.codigo!=null?String(oe.codigo)+" - ":"",oe.nome]})}),Pe&&a.jsx(Do,{size:16,className:"text-success"})]},oe.id)})}):a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum cliente encontrado."})})]})})]})})},Xe=()=>{const V=Ms,oe=V&&bu.get(V.id)||0,Pe=V?Number(V.salePrice??V.price??0):0,qe=He=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(He||0));return a.jsx(xn,{open:af,onOpenChange:He=>{nc(He),He||ys(null)},children:a.jsxs(vn,{className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[61]",onKeyDown:He=>He.stopPropagation(),onPointerDownOutside:He=>He.stopPropagation(),onInteractOutside:He=>He.stopPropagation(),onEscapeKeyDown:He=>{He.preventDefault(),He.stopPropagation()},children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-xl font-bold break-words",title:V?.name||"",children:V?.name||"Produto"}),a.jsx(Dn,{children:"Detalhes do produto (Balco)."})]}),V?a.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),a.jsx("span",{className:"text-sm font-semibold",children:qe(Pe)})]}),V.category?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),a.jsx("span",{className:"text-sm font-medium",children:V.category})]}):null,a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof V.stock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),a.jsx("div",{className:"text-base font-semibold",children:V.stock})]}),typeof V.minStock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),a.jsx("div",{className:"text-base font-semibold",children:V.minStock})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),a.jsxs("div",{className:"text-base font-semibold",children:["x",oe]})]})]})]}):null,a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsxs(me,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{V&&n("/produtos",{state:{productId:V.id,productName:V.name}})},children:[a.jsx(Go,{className:"w-4 h-4"}),a.jsx("span",{children:"Info"})]}),a.jsx(me,{variant:"outline",onClick:()=>{nc(!1),ys(null)},children:"Fechar"}),a.jsx(me,{onClick:async()=>{V&&(await yi(V),nc(!1),ys(null))},children:"Adicionar"})]})]})})},rr=()=>{const[V,oe]=p.useState(""),[Pe,qe]=p.useState(!1),[He,Rt]=p.useState([]),[ut,qt]=p.useState([]),[Kt,At]=p.useState(0),[kr,_r]=p.useState(!1),[nr,Wr]=p.useState(0),Cr=p.useRef([]),Yr=p.useRef(null),br=p.useRef(null),ir=p.useRef(null),ht=p.useRef(null),Qr=p.useRef(0),ln=p.useRef(0);p.useEffect(()=>{let dr=!0;return(async()=>{try{qe(!0);const Br=await db({searchTerm:V,limit:20});if(!dr)return;const Gr=(Br||[]).slice(),dn=String(V||"").trim().toLowerCase(),sn=or=>{const rn=String(or?.nome||"").toLowerCase();return dn?rn.startsWith(dn)?0:rn.includes(dn)?1:2:2};Gr.sort((or,rn)=>{const hr=sn(or),xr=sn(rn);if(hr!==xr)return hr-xr;const Ur=Number(or?.codigo||0),tn=Number(rn?.codigo||0);return Ur-tn}),Rt(Gr),Wr(0)}catch{if(!dr)return;Rt([])}finally{dr&&qe(!1)}})(),()=>{dr=!1}},[V]);const Ia=p.useRef(!1);p.useEffect(()=>{try{ne&&!Ia.current&&(Ia.current=!0,ir.current&&(ir.current.scrollTop=0),Yr.current&&(Yr.current.scrollTop=0),br.current&&(br.current.scrollTop=0)),ne||(Ia.current=!1)}catch{}},[ne]),p.useEffect(()=>{try{ne&&Array.isArray(He)&&He.length>0&&(Wr(0),setTimeout(()=>{try{Yr.current?.focus(),br.current&&(br.current.scrollTop=0)}catch{}},0))}catch{}},[ne,He.length]);const Ca=async(dr=null)=>{try{if(!Qe)return;Nt(!0);const wr=await XGe({mesaId:Qe.id,codigoEmpresa:t?.codigo_empresa}),Gr=Array.isArray(dr)?dr:ut,dn=Array.isArray(Gr)?Array.from(new Set(Gr)):[];let sn=[],or=Math.max(0,Number(Kt||0));dn.length===0&&or===0&&(or=1);for(let xr=0;xr<or;xr++)sn.push("Consumidor");await ub({comandaId:wr.id,clienteIds:dn,nomesLivres:sn,codigoEmpresa:t?.codigo_empresa,replace:!0});let rn=null;try{const xr=await ai({comandaId:wr.id,codigoEmpresa:t?.codigo_empresa}),tn=(Array.isArray(xr)?xr:[]).map($r=>$r?.nome).filter(Boolean);rn=tn.length?tn.join(", "):null}catch(xr){console.error("[confirmOpen] Erro ao buscar vnculos:",xr)}if(!rn){const xr=Array.isArray(dn)?dn:[],Ur=Array.isArray(He)?He:[];rn=xr.length?xr.map(tn=>Ur.find($r=>$r.id===tn)?.nome).filter(Boolean).join(", "):sn.length>0?sn.join(", "):""}const hr={...Qe,comandaId:wr.id,status:"in-use",customer:rn||null,order:[]};l(hr),o(xr=>xr.map(Ur=>Ur.id===hr.id?hr:Ur)),await new Promise(xr=>setTimeout(xr,500));try{const xr=await Gm(t?.codigo_empresa),Ur=await jc({codigoEmpresa:t?.codigo_empresa}),tn={},$r={},An=Array.isArray(Ur)?Ur:[];await Promise.all(An.map(async Jr=>{try{const Bn=await ai({comandaId:Jr.id,codigoEmpresa:t?.codigo_empresa}),Ja=(Array.isArray(Bn)?Bn:[]).map(ps=>ps?.nome).filter(Boolean);tn[Jr.id]=Ja.length?Ja.join(", "):null;const hs=await uo({comandaId:Jr.id,codigoEmpresa:t?.codigo_empresa}),Vc=(Array.isArray(hs)?hs:[]).reduce((ps,lf)=>{const kl=(lf.quantidade||0)*(lf.preco_unitario||0)-(lf.desconto||0);return ps+kl},0);$r[Jr.id]=Vc}catch(Bn){console.error("[confirmOpen] Erro ao buscar dados da comanda:",Bn),tn[Jr.id]=null,$r[Jr.id]=0}}));const $n=(xr||[]).map(Jr=>{const Bn=(Ur||[]).find(Ja=>Ja.mesa_id===Jr.id),Aa=Bn?tn[Bn.id]!==null?tn[Bn.id]:rn:null;return{id:Jr.id,name:Jr.nome||`Mesa ${Jr.numero}`,status:Bn?"in-use":"available",comandaId:Bn?.id||null,customer:Aa,order:[],totalHint:Bn&&$r[Bn.id]||0,aberto_em:Bn?.aberto_em||null}});o($n)}catch(xr){console.error("[confirmOpen] Erro ao atualizar mesas:",xr)}de(!1),ge(null),pt(""),qt([]),At(0),_r(!1),e({title:"Mesa aberta",description:rn?`Comanda criada para: ${rn}`:"Comanda criada.",variant:"success"})}catch(wr){console.error("[confirmOpen] Falha ao abrir mesa:",wr?.message||wr,wr?.stack),e({title:"Falha ao abrir mesa",description:wr?.message||"Tente novamente",variant:"destructive"})}finally{Nt(!1)}};return a.jsx(xn,{open:ne,onOpenChange:dr=>{de(dr),dr||(ge(null),pt(""),qt([]),At(0),_r(!1))},children:a.jsxs(vn,{className:"w-[95vw] max-w-md h-[560px] max-h-[75vh] flex flex-col animate-none overflow-hidden",onOpenAutoFocus:dr=>dr.preventDefault(),onPointerDownOutside:dr=>{dr.preventDefault(),dr.stopPropagation()},onInteractOutside:dr=>{dr.preventDefault(),dr.stopPropagation()},onEscapeKeyDown:dr=>{dr.preventDefault(),de(!1)},onKeyDown:dr=>{dr.key==="Escape"&&(dr.preventDefault(),dr.stopPropagation(),de(!1))},ref:ir,children:[a.jsxs(pn,{className:"flex-shrink-0",children:[a.jsxs(un,{className:"text-xl font-bold",children:["Abrir Mesa ",Qe?`#${Qe.number}`:""]}),a.jsx(Dn,{className:"text-sm",children:"Selecione um ou mais clientes para a mesa."})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto thin-scroll min-h-0 space-y-2 py-2",ref:br,children:[a.jsxs("div",{children:[a.jsx(Le,{className:"text-sm font-medium mb-1.5 block",children:"Buscar cliente"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(to,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Nome, telefone ou cdigo",className:"pl-8 h-9 text-sm",value:V,ref:ht,onChange:dr=>{ln.current=Date.now(),oe(dr.target.value)},onKeyDown:dr=>{if(dr.key==="Enter"){dr.preventDefault();try{if(Array.isArray(He)&&He.length>0){const wr=Math.min(Math.max(nr||0,0),He.length-1),Br=He[wr];Br?.id&&qt(Gr=>Gr.includes(Br.id)?Gr.filter(dn=>dn!==Br.id):[...Gr,Br.id])}}catch{}oe(""),setTimeout(()=>{try{Yr.current?.focus()}catch{}},0)}else ln.current=Date.now()}})]}),a.jsx(me,{type:"button",size:"icon",title:"Cadastrar cliente",className:"h-9 w-9 flex-shrink-0 bg-brand text-black hover:bg-brand/90",onClick:()=>{window.location.href="/clientes"},children:a.jsx(ns,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mt-1.5 text-[12px] text-text-muted flex items-center gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," seleciona"]}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," desmarca"]}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:"Enter"})," confirma"]}),a.jsx("span",{className:"inline-flex items-center gap-1",children:"Digite para buscar"})]})]}),a.jsx("div",{className:"min-h-[8px]",children:ut.length>0&&a.jsxs("div",{className:"bg-success/10 border border-success/30 rounded-md p-2.5",children:[a.jsxs("div",{className:"text-xs font-medium text-success mb-1",children:[ut.length," cliente",ut.length>1?"s":""," selecionado",ut.length>1?"s":""]}),a.jsx("div",{className:"text-sm text-text-primary",children:He.filter(dr=>ut.includes(dr.id)).map(dr=>dr.nome).join(", ")})]})}),a.jsx("div",{className:"border rounded-md focus:outline-none focus:ring-0 focus-visible:outline-none focus-visible:ring-0",role:"listbox","aria-label":"Clientes","aria-activedescendant":He&&He.length>0&&He[nr]&&He[nr].id?`ot-option-${He[nr].id}`:void 0,ref:Yr,tabIndex:0,onKeyDown:dr=>{try{if(dr.key&&dr.key.length===1&&!dr.ctrlKey&&!dr.metaKey&&!dr.altKey||dr.key==="Backspace"){dr.preventDefault(),dr.stopPropagation();let Br=String(V||"");dr.key==="Backspace"?Br=Br.slice(0,-1):Br+=dr.key,oe(Br),ln.current=Date.now();try{br.current&&(br.current.scrollTop=0)}catch{}setTimeout(()=>{try{if(ht.current){ht.current.focus();const Gr=Br.length;ht.current.setSelectionRange?.(Gr,Gr)}}catch{}},0);return}if(["ArrowDown","ArrowUp","Home","End","ArrowRight","ArrowLeft"," "].includes(dr.key)){let Br=nr||0;const Gr=He.length;dr.key==="ArrowDown"&&(Br=Math.min(Br+1,Gr-1)),dr.key==="ArrowUp"&&(Br=Math.max(Br-1,0)),dr.key==="Home"&&(Br=0),dr.key==="End"&&(Br=Gr-1),Wr(Br),setTimeout(()=>{try{Cr.current[Br]?.scrollIntoView({block:"nearest"})}catch{}},0);const dn=He[Br],sn=dn?.codigo===0;if(dr.key==="ArrowRight"&&dn?.id&&(sn?(_r(!0),At(or=>or+1)):(pt(""),qt(or=>or.includes(dn.id)?or:[...or,dn.id]))),dr.key==="ArrowLeft"&&dn?.id)if(sn){const or=Math.max(0,Kt-1);At(or),or===0&&_r(!1)}else qt(or=>or.filter(rn=>rn!==dn.id));dr.key===" "&&dn?.id&&(pt(""),qt(or=>or.includes(dn.id)?or.filter(rn=>rn!==dn.id):[...or,dn.id]));return}if(dr.key==="Enter"){dr.preventDefault();const Br=Math.min(Math.max(nr||0,0),He.length-1),Gr=He[Br];if(Date.now()-ln.current<600||document.activeElement===ht.current||V&&V.length>0){Gr?.id&&(pt(""),qt(or=>or.includes(Gr.id)?or.filter(rn=>rn!==Gr.id):[...or,Gr.id])),oe(""),setTimeout(()=>{try{Yr.current?.focus(),br.current&&(br.current.scrollTop=0)}catch{}},0);return}if(Gr?.id){const or=ut.includes(Gr.id)?ut:[...ut,Gr.id];ut.includes(Gr.id)||qt(rn=>[...rn,Gr.id]),setTimeout(()=>{try{Ca(or)}catch{}},0);return}setTimeout(()=>{try{Ca(ut)}catch{}},0);return}}catch{}},children:Pe?a.jsx("div",{className:"p-3 text-center text-sm text-text-muted",children:"Carregando..."}):He.length>0?a.jsx("ul",{className:"divide-y divide-border",children:He.map((dr,wr)=>{const Br=dr.codigo===0,Gr=ut.includes(dr.id),dn=wr===(nr||0),sn=Br?Kt:0;return a.jsxs("li",{id:`ot-option-${dr.id}`,ref:or=>{Cr.current[wr]=or},role:"option","aria-selected":dn,className:gr("p-2.5 flex items-center gap-2 cursor-pointer transition-colors outline-none focus:outline-none focus-visible:outline-none border border-transparent",Br?"bg-amber-500/5 border-l-2 border-l-amber-500/40":"",Gr&&!Br?"bg-success/10 hover:bg-success/15":"hover:bg-surface-2",kr&&Br?"bg-amber-500/10":"",dn?"bg-brand/10":""),onClick:()=>{Br?kr||(_r(!0),At(1)):(pt(""),qt(or=>or.includes(dr.id)?or.filter(rn=>rn!==dr.id):[...or,dr.id]))},onDoubleClick:()=>{if(!Br){const or=ut.includes(dr.id)?ut:[...ut,dr.id];qt(or),setTimeout(()=>{try{Ca(or)}catch{}},0)}},onMouseEnter:()=>{Date.now()-(Qr.current||0)>300&&Wr(wr)},tabIndex:-1,children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[!Br&&a.jsx("span",{className:gr("w-2 h-2 rounded-full flex-shrink-0",Gr?"bg-success":dn?"bg-brand":"bg-border")}),a.jsxs("div",{className:"font-medium text-sm truncate",children:[dr.codigo!=null&&dr.codigo!==0?`${dr.codigo} - `:"",dr.nome,Br&&a.jsx("span",{className:"ml-2 text-xs text-amber-600",children:"Cliente Padro"})]})]}),Br?kr?a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[a.jsx(me,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-red-500/10",onClick:or=>{or.stopPropagation();const rn=Math.max(0,Kt-1);At(rn),rn===0&&_r(!1)},children:a.jsx(Iv,{className:"h-4 w-4"})}),a.jsx("div",{className:"w-8 h-7 flex items-center justify-center bg-surface-2 rounded text-sm font-medium",children:sn}),a.jsx(me,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-500/10",onClick:or=>{or.stopPropagation(),At(rn=>rn+1)},children:a.jsx(ns,{className:"h-4 w-4"})})]}):null:a.jsx("div",{className:"ml-2 flex-shrink-0",children:Gr?a.jsx(Do,{size:18,className:"text-success"}):a.jsx("div",{className:"w-[18px] h-[18px] rounded-full border-2 border-border"})})]},dr.id)})}):a.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Nenhum cliente encontrado"})})]}),a.jsxs(ra,{className:"flex-shrink-0 pt-3",children:[a.jsx(me,{type:"button",variant:"outline",onClick:()=>{de(!1),ge(null),pt(""),qt([])},children:"Cancelar"}),a.jsx(me,{onClick:()=>Ca(),disabled:!Qe||lt,children:lt?"Abrindo...":"Confirmar Abertura"})]})]})})},Gt=()=>{const[V,oe]=p.useState("");return p.useEffect(()=>{Ct.current&&oe(Ct.current)},[]),a.jsxs(a.Fragment,{children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Abrir Caixa"}),a.jsx(ld,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(Le,{htmlFor:"initial-value",children:"Valor Inicial"}),a.jsxs("div",{className:"relative mt-2",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted",children:"R$"}),a.jsx(Ye,{id:"initial-value",type:"text",inputMode:"numeric",pattern:"[0-9.,]*",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:!1,name:"cash-open-initial",placeholder:"0,00",className:"pl-9 font-semibold",value:V,onChange:Pe=>{const qe=(Pe.target.value||"").replace(/\D/g,""),He=qe?Number(qe)/100:0,Rt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(He);oe(Rt),Ct.current=Rt},onKeyDown:Pe=>{Pe.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(Pe.key)&&(/^[0-9]$/.test(Pe.key)||Pe.preventDefault())},onBeforeInput:Pe=>{const qe=Pe.data??"";qe&&/\D/.test(qe)&&Pe.preventDefault()},onMouseDown:Pe=>Pe.stopPropagation()})]})]}),a.jsxs(od,{children:[a.jsx(cd,{onClick:()=>st(!1),children:"Cancelar"}),a.jsx(Zd,{onClick:async()=>{if(!ar){pr(!0);try{const Pe=String(V).replace(/\./g,"").replace(",","."),qe=Number(Pe)||0;try{localStorage.setItem("cash:opening",String(Date.now()))}catch{}await Sf({saldoInicial:qe,codigoEmpresa:t?.codigo_empresa}),await vt(),await re({showToast:!1}),st(!1),e({title:"Caixa aberto com sucesso!",variant:"success"}),Ct.current="",oe("")}catch(Pe){e({title:"Falha ao abrir caixa",description:Pe?.message||"Tente novamente",variant:"destructive"})}finally{try{localStorage.removeItem("cash:opening")}catch{}pr(!1)}}},children:"Confirmar Abertura"})]})]})},Vt=()=>a.jsxs(Qd,{open:xe,onOpenChange:st,children:[a.jsx(Ip,{asChild:!0,children:a.jsxs(me,{variant:"success",size:"sm",disabled:c||ar,onClick:()=>st(!0),className:"px-3",children:[a.jsx(VH,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"}),a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-emerald-700 border border-emerald-800 rounded shadow-sm",children:"F10"})]})}),a.jsx(ad,{className:"sm:max-w-[425px] animate-none",onKeyDown:V=>V.stopPropagation(),onKeyDownCapture:V=>V.stopPropagation(),onEscapeKeyDown:V=>V.preventDefault(),onPointerDownOutside:V=>{V.preventDefault(),V.stopPropagation()},onInteractOutside:V=>{V.preventDefault(),V.stopPropagation()},children:a.jsx(Gt,{})})]}),Mt=()=>{const[V,oe]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[Pe,qe]=p.useState(!1),[He,Rt]=p.useState(!1),[ut,qt]=p.useState(!1),[Kt,At]=p.useState(!1),[kr,_r]=p.useState(""),nr=async()=>{try{oe({loading:!0,saldoInicial:0,resumo:null});const br=await Km({codigoEmpresa:t?.codigo_empresa}),ir=await Fw({codigoEmpresa:t?.codigo_empresa});oe({loading:!1,saldoInicial:Number(br?.saldo_inicial||0),resumo:ir||{totalPorFinalizadora:{}}})}catch{oe({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},Wr=V?.resumo?.totalPorFinalizadora||{},Cr=Object.values(Wr).reduce((br,ir)=>br+Number(ir||0),0),Yr=Number(V.saldoInicial||0)+Cr;return a.jsxs(a.Fragment,{children:[a.jsxs(Qd,{open:Pe,onOpenChange:br=>{qe(br),br&&nr()},children:[a.jsx(Ip,{asChild:!0,children:a.jsxs(me,{variant:"destructive",size:"sm",disabled:!c,onClick:()=>qe(!0),className:"px-3",children:[a.jsx(xx,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Fechar"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Fechar Caixa"})]})}),a.jsxs(ad,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:br=>br.preventDefault(),onKeyDown:br=>br.stopPropagation(),onKeyDownCapture:br=>br.stopPropagation(),onPointerDownOutside:br=>{br.preventDefault(),br.stopPropagation()},onInteractOutside:br=>{br.preventDefault(),br.stopPropagation()},children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Fechar Caixa"}),a.jsx(ld,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),ut&&a.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[a.jsx(Ic,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),V.loading?a.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):a.jsxs("div",{className:"py-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Inicial:"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(V.saldoInicial||0).toFixed(2)]})]}),Object.keys(Wr).length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):Object.entries(Wr).map(([br,ir])=>a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-text-secondary",children:[String(br),":"]})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(ir||0).toFixed(2)]})]},br)),a.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[a.jsx("span",{className:"text-text-primary",children:"Total em Caixa:"})," ",a.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(Yr||0).toFixed(2)]})]})]}),a.jsxs(od,{children:[a.jsx(cd,{onClick:()=>qe(!1),disabled:Kt,children:"Cancelar"}),a.jsx(Zd,{onClick:()=>{Rt(!0)},disabled:Kt,children:"Continuar"})]})]})]}),a.jsx(Qd,{open:He,onOpenChange:br=>{Kt||Rt(br)},children:a.jsxs(ad,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:br=>br.preventDefault(),onEscapeKeyDown:br=>{Kt||br.preventDefault()},onKeyDown:br=>br.stopPropagation(),onKeyDownCapture:br=>br.stopPropagation(),onPointerDownOutside:br=>{Kt||(br.preventDefault(),br.stopPropagation())},onInteractOutside:br=>{Kt||(br.preventDefault(),br.stopPropagation())},children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Confirmar Fechamento do Caixa"}),a.jsx(ld,{children:"Informe o saldo final para finalizar o fechamento."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(Le,{htmlFor:"valor-contado-final",className:"text-sm font-medium text-text-primary mb-2 block",children:"Saldo Final (opcional)"}),a.jsx("input",{id:"valor-contado-final",type:"text",placeholder:"R$ 0,00",value:kr,onChange:br=>{let ir=br.target.value.replace(/\D/g,"");ir.length>0&&(ir=(Number(ir)/100).toFixed(2),ir=ir.replace(".",","),ir="R$ "+ir),_r(ir)},className:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),a.jsxs(od,{children:[a.jsx(cd,{onClick:()=>{Rt(!1)},disabled:Kt,children:"Voltar"}),a.jsx(Zd,{onClick:async()=>{try{if(Kt)return;At(!0);const br=Number(V.saldoInicial||0)+Cr,ir=kr?Number(kr.replace(/[^0-9,]/g,"").replace(",",".")):null;await Ere({saldoFinal:br,valorFinalDinheiro:ir,codigoEmpresa:t?.codigo_empresa}),d(!1),typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{Rt(!1),qe(!1),_r(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${br.toFixed(2)}`,duration:4e3})}):(Rt(!1),qe(!1),_r(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${br.toFixed(2)}`,duration:4e3})),setTimeout(async()=>{try{await Km({codigoEmpresa:t?.codigo_empresa})}catch{}},0)}catch(br){console.error(br);const ir=br?.message||"Tente novamente";if(Re){Ge(ir.includes("Existem")?ir:`Falha ao fechar caixa: ${ir}`);try{Rt(!1),qe(!1)}catch{}typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{De(!0)}):De(!0),setTimeout(()=>De(!1),2600)}else e({title:"Falha ao fechar caixa",description:ir,variant:"destructive"})}finally{At(!1)}},children:"Confirmar Fechamento"})]})]})})]})},S=()=>{const[V,oe]=p.useState(""),[Pe,qe]=p.useState([]),[He,Rt]=p.useState([]),[ut,qt]=p.useState(!1),[Kt,At]=p.useState(new Set),kr=p.useRef([]),_r=p.useRef(!1),[nr,Wr]=p.useState(0);p.useRef([]);const Cr=p.useRef(null);p.useRef(0);const[Yr,br]=p.useState(!1),[ir,ht]=p.useState(null),[Qr,ln]=p.useState(null),[Ia,Ca]=p.useState("");p.useEffect(()=>{let hr=!0;const xr=async()=>{if(!(!ve||!i?.comandaId)&&!(_r.current&&V===""))try{qt(!0);const Ur=await ai({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa});if(!hr)return;const tn=(Ur||[]).map($n=>({id:$n.id,cliente_id:$n.cliente_id,nome:$n.nome||"",tipo:$n.tipo||($n.cliente_id?"cadastrado":"livre")}));Rt(tn),kr.current=JSON.parse(JSON.stringify(tn)),At(new Set);const $r=await db({searchTerm:V,limit:50,codigoEmpresa:t?.codigo_empresa});if(!hr)return;const An=($r||[]).slice().sort(($n,Jr)=>Number($n?.codigo||0)-Number(Jr?.codigo||0));qe(An),Wr(0),_r.current=!0}catch(Ur){console.error("Erro ao carregar clientes:",Ur)}finally{hr&&qt(!1)}};return ve?(xr(),()=>{hr=!1}):(_r.current=!1,oe(""),()=>{hr=!1})},[ve,i?.comandaId]),p.useEffect(()=>{ve&&Array.isArray(Pe)&&Pe.length>0&&(Wr(0),setTimeout(()=>{try{const hr=document.querySelector('[role="dialog"]');if(hr){const xr=hr.querySelector(".overflow-y-auto");xr&&(xr.scrollTop=0)}}catch{}},0))},[ve,Pe.length]),p.useEffect(()=>(ve&&i?.comandaId?(Yt.current=!0,Ht.current=i.comandaId,Ot.current=hr=>{Rt(hr||[]),dr(hr||[])}):ve||Yt.current&&Ht.current===i?.comandaId&&(Yt.current=!1,Ht.current=null,Ot.current=null),()=>{ve||(Yt.current=!1,Ht.current=null,Ot.current=null)}),[ve,i?.comandaId]);const dr=hr=>{try{if(!i?.id)return;const xr=(hr||[]).map(tn=>tn?.nome).filter(Boolean),Ur=xr.length?xr.join(", "):null;l(tn=>tn&&tn.id===i.id?{...tn,customer:Ur}:tn),o(tn=>tn.map($r=>$r.id===i.id?{...$r,customer:Ur}:$r))}catch(xr){console.error("[ManageClientsDialog] Erro ao sincronizar nomes na mesa:",xr)}},wr=()=>{try{console.log("[ManageClientsDialog] addConsumidor clicado")}catch{}i?.comandaId&&(async()=>{try{qt(!0);const{data:hr,error:xr}=await he.from("comanda_clientes").insert({comanda_id:i.comandaId,nome_livre:"Consumidor",codigo_empresa:t?.codigo_empresa}).select("id, cliente_id, nome_livre").single();if(xr)throw xr;const Ur={id:hr.id,cliente_id:hr.cliente_id,nome:hr.nome_livre||"Consumidor",tipo:"livre"};Rt(tn=>{const $r=[...tn,Ur];return dr($r),$r}),ln(Ur.id),Ca(Ur.nome||"Consumidor")}catch(hr){console.error("[ManageClientsDialog] Erro ao adicionar consumidor:",hr),e({title:"Falha ao adicionar consumidor",description:hr?.message||"Tente novamente",variant:"destructive"})}finally{qt(!1)}})()},Br=hr=>{try{console.log("[ManageClientsDialog] addClientFromModal clicado:",hr)}catch{}if(!i?.comandaId)return;const xr=Pe.find(Ur=>Ur.id===hr);xr&&(async()=>{try{qt(!0);const{data:Ur,error:tn}=await he.from("comanda_clientes").insert({comanda_id:i.comandaId,cliente_id:hr,codigo_empresa:t?.codigo_empresa}).select("id, cliente_id").single();if(tn)throw tn;const $r={id:Ur.id,cliente_id:Ur.cliente_id,nome:xr.nome,tipo:"cadastrado"};Rt(An=>{const $n=[...An,$r];return dr($n),$n}),br(!1)}catch(Ur){console.error("[ManageClientsDialog] Erro ao adicionar cliente:",Ur),e({title:"Falha ao adicionar cliente",description:Ur?.message||"Tente novamente",variant:"destructive"})}finally{qt(!1)}})()},Gr=(hr,xr)=>{const Ur=Pe.find($r=>$r.id===xr);!Ur||!He.find($r=>$r.id===hr)||(async()=>{try{if(qt(!0),String(hr).startsWith("temp-")){const{data:$r,error:An}=await he.from("comanda_clientes").insert({comanda_id:i.comandaId,cliente_id:xr,codigo_empresa:t?.codigo_empresa}).select("id, cliente_id").single();if(An)throw An;const $n={id:$r.id,cliente_id:$r.cliente_id,nome:Ur.nome,tipo:"cadastrado"};Rt(Jr=>{const Bn=[...Jr.filter(Aa=>Aa.id!==hr),$n];return dr(Bn),Bn})}else{const{error:$r}=await he.from("comanda_clientes").update({cliente_id:xr,nome_livre:null}).eq("id",hr).eq("codigo_empresa",t?.codigo_empresa);if($r)throw $r;Rt(An=>{const $n=An.map(Jr=>Jr.id===hr?{...Jr,cliente_id:xr,nome:Ur.nome,tipo:"cadastrado"}:Jr);return dr($n),$n})}ht(null),br(!1)}catch($r){console.error("[ManageClientsDialog] Erro ao trocar cliente:",$r),e({title:"Falha ao trocar cliente",description:$r?.message||"Tente novamente",variant:"destructive"})}finally{qt(!1)}})()},dn=hr=>{if(He.find(Ur=>Ur.id===hr)){if(String(hr).startsWith("temp-")||!i?.comandaId){Rt(Ur=>{const tn=Ur.filter($r=>$r.id!==hr);return dr(tn),tn});return}(async()=>{try{qt(!0);const{error:Ur}=await he.from("comanda_clientes").delete().eq("id",hr).eq("codigo_empresa",t?.codigo_empresa);if(Ur)throw Ur;Rt(tn=>{const $r=tn.filter(An=>An.id!==hr);return dr($r),$r})}catch(Ur){console.error("[ManageClientsDialog] Erro ao remover cliente:",Ur),e({title:"Falha ao remover cliente",description:Ur?.message||"Tente novamente",variant:"destructive"})}finally{qt(!1)}})()}},sn=hr=>{try{console.log("[ManageClientsDialog] startEditConsumidor clicado:",hr)}catch{}const xr=He.find(Ur=>Ur.id===hr);xr&&(ln(hr),Ca(xr.nome||"Consumidor"))},or=()=>{if(!Qr||!i?.comandaId)return;const hr=Ia.trim()||"Consumidor";(async()=>{try{if(qt(!0),!String(Qr).startsWith("temp-")){const{error:xr}=await he.from("comanda_clientes").update({nome_livre:hr}).eq("id",Qr).eq("codigo_empresa",t?.codigo_empresa);if(xr)throw xr}Rt(xr=>{const Ur=xr.map(tn=>tn.id===Qr?{...tn,nome:hr}:tn);return dr(Ur),Ur})}catch(xr){console.error("[ManageClientsDialog] Erro ao salvar consumidor:",xr),e({title:"Falha ao salvar cliente",description:xr?.message||"Tente novamente",variant:"destructive"})}finally{qt(!1),ln(null),Ca("")}})()},rn=async()=>{_e(!1)};return a.jsxs(xn,{open:ve,onOpenChange:_e,children:[a.jsxs(vn,{className:"sm:max-w-[480px] w-[92vw] max-h-[85vh] h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:hr=>hr.preventDefault(),onPointerDownOutside:hr=>{hr.preventDefault(),hr.stopPropagation()},onInteractOutside:hr=>{hr.preventDefault(),hr.stopPropagation()},onEscapeKeyDown:hr=>hr.preventDefault(),children:[a.jsxs(pn,{className:"flex-shrink-0",children:[a.jsx(un,{children:"Gerenciar Clientes da Mesa"}),a.jsx(Dn,{children:"Gerencie os clientes vinculados a esta mesa."})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-4 thin-scroll",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"text-sm font-medium text-text-primary",children:["Clientes vinculados (",He.length,"):"]}),He.length===0?a.jsx("div",{className:"p-4 text-center text-sm text-text-muted border border-dashed rounded-md",children:"Nenhum cliente vinculado ainda"}):a.jsx("div",{className:"space-y-2",children:He.map(hr=>{const xr=hr.tipo==="livre",Ur=Qr===hr.id;return a.jsx("div",{className:gr("flex items-center gap-2 p-2 rounded-md border",xr?"bg-amber-500/10 border-amber-500/30":"bg-surface-2 border-border"),children:Ur?a.jsxs(a.Fragment,{children:[a.jsx(Ye,{value:Ia,onChange:tn=>Ca(tn.target.value),onKeyDown:tn=>{tn.key==="Enter"&&or(),tn.key==="Escape"&&(ln(null),Ca("")),tn.stopPropagation()},className:"flex-1 h-8",autoFocus:!0}),a.jsx(me,{size:"sm",onClick:or,className:"h-8 px-2",children:a.jsx(Do,{className:"h-4 w-4"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:gr("flex-1 text-sm truncate p-1 rounded",xr?"cursor-pointer hover:bg-amber-500/10":"cursor-default"),onClick:()=>xr&&sn(hr.id),title:xr?"Clique para editar":"",children:[a.jsx("span",{children:hr.nome}),xr&&a.jsx("span",{className:"ml-2 text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30 align-middle",children:"Cliente Padro"})]}),!xr&&a.jsx(me,{size:"sm",variant:"ghost",onClick:()=>{ht(hr.id),br(!0)},className:"h-7 px-2",title:"Trocar cliente",children:a.jsx(xl,{className:"h-4 w-4"})}),a.jsx(me,{size:"sm",variant:"ghost",onClick:()=>dn(hr.id),className:"h-7 px-2 text-destructive hover:text-destructive",children:a.jsx(el,{className:"h-4 w-4"})})]})},hr.id)})})]}),a.jsxs(me,{onClick:()=>{ht(null),br(!0)},className:"w-full",size:"sm",children:[a.jsx(ns,{className:"h-4 w-4 mr-2"}),"Adicionar Cliente"]})]}),a.jsxs(ra,{children:[a.jsx(me,{variant:"outline",onClick:()=>_e(!1),disabled:ut,children:"Cancelar"}),a.jsx(me,{onClick:rn,disabled:ut,children:ut?"Salvando...":`Confirmar ${Kt.size>0?`(${Kt.size} alteraes)`:""}`})]})]}),a.jsx(xn,{open:Yr,onOpenChange:br,children:a.jsxs(vn,{className:"sm:max-w-[500px] max-h-[80vh] flex flex-col",children:[a.jsxs(pn,{children:[a.jsx(un,{children:ir?"Trocar Cliente":"Adicionar Cliente"}),a.jsx(Dn,{children:"Selecione um cliente da lista"})]}),a.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col gap-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar cliente...",className:"pl-9",value:V,onChange:hr=>oe(hr.target.value)})]}),a.jsx("div",{className:"flex-1 border rounded-md overflow-y-auto thin-scroll",role:"listbox","aria-label":"Clientes disponveis",ref:Cr,tabIndex:0,children:ut?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Carregando..."}):Pe.length===0?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhum cliente encontrado"}):a.jsx("ul",{className:"divide-y divide-border",children:Pe.map(hr=>{const xr=hr.codigo===0,Ur=He.some(tn=>tn.cliente_id===hr.id&&tn.tipo==="cadastrado");return a.jsxs("li",{className:gr("p-3 cursor-pointer transition-colors flex items-center justify-between",xr?"bg-amber-500/5 hover:bg-amber-500/10":"hover:bg-surface-2"),onClick:()=>{xr?ir?(ht(null),br(!1)):(wr(),br(!1)):ir?Gr(ir,hr.id):Br(hr.id)},children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"font-medium truncate flex items-center gap-2",children:[xr?"Cliente Consumidor":`${hr?.codigo?`${hr.codigo} - `:""}${hr?.nome||""}`,xr&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30",children:"Cliente Padro"})]}),!xr&&hr.telefone&&a.jsx("div",{className:"text-xs text-text-muted",children:hr.telefone}),xr&&a.jsx("div",{className:"text-xs text-text-muted",children:"Clique para adicionar consumidor"})]}),Ur&&!xr&&a.jsx(Do,{className:"h-5 w-5 text-success ml-2 flex-shrink-0"})]},hr.id)})})})]}),a.jsx(ra,{children:a.jsx(me,{variant:"outline",onClick:()=>br(!1),children:"Cancelar"})})]})})]})},G=()=>{const V=oe=>oe==="available"?"bg-success/10 border-success/30 text-success":oe==="in-use"?"bg-warning/10 border-warning/30 text-warning":oe==="awaiting-payment"?"bg-info/10 border-info/30 text-info":"bg-surface-2 border-border text-text-secondary";return a.jsx("div",{className:"md:hidden space-y-2",children:s.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"text-text-muted mb-4",children:a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),a.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),a.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear"})]}):s.map(oe=>{const Pe=En(oe.order||[],oe),qe=oe.totalHint>0?oe.totalHint:Pe;return a.jsx("div",{onClick:async()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}await cr(oe),oe.status!=="available"&&yr(!0)},className:gr("p-3 rounded-lg border-2 bg-surface transition-all active:scale-[0.98]",V(oe.status),i?.id===oe.id&&"ring-2 ring-brand/60",c?"cursor-pointer":"cursor-not-allowed opacity-60"),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex items-center gap-2 mb-1",children:a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("h3",{className:"font-bold text-base truncate",children:oe.name||`Mesa ${oe.number}`}),oe.status==="available"&&oe.id===Xr&&a.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-gray-400 bg-transparent border border-gray-300/50 rounded flex-shrink-0",children:"F1"})]})}),oe.status==="in-use"||oe.status==="awaiting-payment"?a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-text-secondary",children:[a.jsx(yl,{className:"w-3.5 h-3.5 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:Me(oe.customer)||"Sem cliente"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 text-sm font-semibold text-text-primary",children:[a.jsx(Ko,{className:"w-3.5 h-3.5 flex-shrink-0"}),a.jsxs("span",{children:["R$ ",qe.toFixed(2)]})]})]}):a.jsx("div",{className:"text-xs text-text-muted",children:"Mesa disponvel"})]}),a.jsx("div",{className:"w-12 flex items-center justify-center ml-1 mr-1",children:oe.status==="available"?a.jsx("img",{src:"/mesalivre.png",alt:"Mesa livre",className:"w-10 h-10 object-contain opacity-80"}):a.jsx("img",{src:"/mesaocupada.png",alt:"Mesa ocupada",className:"w-10 h-10 object-contain opacity-80"})}),a.jsx(c0,{className:"w-5 h-5 text-text-muted flex-shrink-0 ml-1"})]})},oe.id)})})},se=()=>i?a.jsx(xn,{open:Xt,modal:!z,onOpenChange:V=>{!V&&z||(yr(V),V||it(null),V&&A("tables"))},children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-2xl max-h-[85vh] flex flex-col p-0 gap-0 animate-none",children:[a.jsxs("div",{className:"p-4 border-b border-border bg-surface-2",children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx(un,{className:"text-xl font-bold",children:i.name||`Mesa ${i.number}`})}),a.jsx(Dn,{className:"sr-only",children:"Visualizao da comanda e produtos da mesa selecionada"}),(i.status==="in-use"||i.status==="awaiting-payment")&&a.jsxs("div",{className:"flex items-center gap-4 text-sm text-text-secondary",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(yl,{className:"w-4 h-4"}),a.jsx("span",{children:Me(i.customer)||"Sem cliente"})]}),i.order&&i.order.length>0&&a.jsxs("div",{className:"flex items-center gap-1 font-semibold text-text-primary",children:[a.jsx(Ko,{className:"w-4 h-4"}),a.jsxs("span",{children:["R$ ",(i.totalHint>0?i.totalHint:En(i.order||[])).toFixed(2)]})]})]})]}),a.jsxs(Cc,{value:lr,onValueChange:V=>{if(Rr(V),it(null),V==="products"&&i){w(!0);try{yr(!1)}catch{}Rr("order")}},className:"flex flex-col flex-1 min-h-0",children:[a.jsxs(Gl,{className:"grid w-full grid-cols-3 m-2 rounded-lg",children:[a.jsx(da,{value:"order",className:"text-sm flex items-center justify-center gap-2",children:"Comanda"}),a.jsx(da,{value:"details",className:"text-sm flex items-center justify-center gap-2",children:"Detalhes"}),a.jsxs(da,{value:"products",className:"text-sm flex items-center justify-center gap-2",onClick:()=>{if(i){w(!0);try{yr(!1)}catch{}}},children:["Produtos",a.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),a.jsx(ds,{value:"order",className:"flex-1 overflow-hidden min-h-0 m-0",onKeyDown:V=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(V.key)&&A("tables")},children:a.jsx(Pr,{table:i})}),a.jsx(ds,{value:"details",className:"flex-1 overflow-hidden min-h-0 m-0",children:a.jsx(Sr,{table:i})})]})]})}):null,Ae=()=>{const V=M,oe=V&&dt.get(V.id)||0,Pe=V?Number(V.salePrice??V.price??0):0,qe=He=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(He||0));return a.jsx(xn,{open:z,onOpenChange:He=>{W(He),He||U(null)},children:a.jsxs(vn,{overlayClassName:"z-[70]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[71]",onOpenAutoFocus:He=>{},onKeyDown:He=>He.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-xl font-bold break-words",title:V?.name||"",children:V?.name||"Produto"}),a.jsx(Dn,{children:"Detalhes do produto e aes rpidas."})]}),V?a.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),a.jsx("span",{className:"text-sm font-semibold",children:qe(Pe)})]}),V.category?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),a.jsx("span",{className:"text-sm font-medium",children:V.category})]}):null,a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof V.stock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),a.jsx("div",{className:"text-base font-semibold",children:V.stock})]}),typeof V.minStock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),a.jsx("div",{className:"text-base font-semibold",children:V.minStock})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),a.jsxs("div",{className:"text-base font-semibold",children:["x",oe]})]})]})]}):null,a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsxs(me,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{V&&n("/produtos",{state:{productId:V.id,productName:V.name}})},children:[a.jsx(Go,{className:"w-4 h-4"}),a.jsx("span",{children:"Info"})]}),a.jsx(me,{variant:"outline",onClick:()=>{W(!1),U(null)},children:"Fechar"}),a.jsx(me,{onClick:async()=>{V&&(await yn(V),W(!1),U(null))},children:"Adicionar"})]})]})})};return a.jsxs(a.Fragment,{children:[a.jsx(Ae,{}),a.jsx(Xe,{}),a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsx("div",{className:"md:hidden mb-2 w-full",children:a.jsx(Cc,{value:"mesas",onValueChange:V=>{V==="mesas"&&n("/vendas"),V==="balcao"&&n("/balcao"),V==="historico"&&n("/historico")},children:a.jsxs(Gl,{className:"grid w-full grid-cols-3",children:[a.jsx(da,{value:"mesas",className:"text-xs",title:"Pressione B para alternar",children:"Mesas"}),a.jsx(da,{value:"balcao",className:"text-xs",title:"Pressione B para alternar",children:"Balco"}),a.jsx(da,{value:"historico",className:"text-xs",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[a.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:a.jsx(Cc,{value:"mesas",onValueChange:V=>{V==="mesas"&&n("/vendas"),V==="balcao"&&n("/balcao"),V==="historico"&&n("/historico")},children:a.jsxs(Gl,{className:"inline-flex",children:[a.jsx(da,{value:"mesas",className:"text-sm",title:"Pressione B para alternar",children:"Mesas"}),a.jsx(da,{value:"balcao",className:"text-sm",title:"Pressione B para alternar",children:"Balco"}),a.jsx(da,{value:"historico",className:"text-sm",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 flex-shrink-0",children:[a.jsx(Vt,{}),a.jsx(Mt,{}),a.jsxs(me,{variant:"outline",size:"sm",onClick:()=>g(!0),className:"px-3",children:[a.jsx(c4,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"}),a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F11"})]}),a.jsx("div",{className:"hidden md:block w-px h-6 bg-border mx-1"}),a.jsxs(me,{onClick:()=>Te(!0),className:"hidden md:flex",size:"sm",children:[a.jsx(ns,{className:"mr-2 h-4 w-4"})," Nova Mesa",a.jsx("kbd",{className:"ml-2 px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]})]})]}),!c&&u>0&&a.jsxs("div",{className:"md:hidden mb-3 text-[11px] text-warning flex items-center gap-2",children:[a.jsx(Ic,{className:"h-3 w-3"}),"H comandas abertas, mas o caixa parece fechado.",a.jsx(me,{size:"sm",variant:"outline",className:"h-6 px-2 text-[11px]",onClick:()=>st(!0),children:"Reabrir sesso"})]}),a.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 overflow-visible min-h-0",children:[a.jsxs("div",{className:"lg:col-span-2 bg-surface rounded-lg border border-border p-4 md:p-6 overflow-y-auto thin-scroll min-h-0",tabIndex:0,onKeyDown:V=>{E==="tables"&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(V.key)&&V.preventDefault()},onClick:V=>{V.stopPropagation(),V.preventDefault(),A("tables"),!i&&s.length>0&&l(s[0]),V.currentTarget.focus()},onFocus:()=>{A("tables"),!i&&s.length>0&&l(s[0])},style:{outline:E==="tables"?"2px solid rgba(148, 163, 184, 0.4)":"none",outlineOffset:"-2px",transition:"outline 0.15s ease"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4 gap-4",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Mapa de Mesas"}),a.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-text-muted flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:""}),a.jsx("span",{children:"Navegar"})]}),a.jsx("div",{className:"w-px h-3 bg-border"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"Enter"}),a.jsx("span",{children:"Selecionar"})]})]}),a.jsx(me,{type:"button",className:"md:hidden h-9 w-9 p-0 bg-amber-400 text-black hover:bg-amber-300 flex-shrink-0",size:"icon",title:"Nova Mesa",onClick:()=>Te(!0),children:a.jsx(ns,{className:"h-5 w-5"})})]}),a.jsx(G,{}),a.jsx("div",{className:"hidden md:block",children:a.jsx(Jnt,{onDragEnd:ha,children:a.jsx(Ase,{droppableId:"tables",children:V=>a.jsxs("div",{...V.droppableProps,ref:oe=>{V.innerRef(oe),mr.current=oe},role:"grid","aria-label":"Lista de mesas",className:"grid gap-5 grid-cols-[repeat(auto-fit,minmax(240px,1fr))]",children:[s.length===0?a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"text-text-muted mb-4",children:a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),a.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),a.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear a receber pedidos"}),a.jsxs(me,{onClick:()=>Te(!0),className:"flex items-center gap-2",children:[a.jsx(ns,{size:16}),"Criar Nova Mesa"]})]}):s.map((oe,Pe)=>a.jsx(Dat,{draggableId:oe.id,index:Pe,children:(qe,He)=>a.jsx(Fe,{table:oe,provided:qe,isDragging:He.isDragging})},oe.id)),V.placeholder]})})})})]}),a.jsx("div",{className:"hidden md:flex bg-surface rounded-lg border border-border flex-col min-h-0 transition-all overflow-hidden",style:{boxShadow:E==="panel"?"inset 0 0 0 2px rgba(148, 163, 184, 0.4)":"none"},children:a.jsxs(Cc,{value:F,onValueChange:V=>{D(V),V==="products"&&i&&(w(!0),D("order"))},className:"flex flex-col h-full",children:[a.jsxs(Gl,{className:"grid w-full grid-cols-3 m-2",children:[a.jsx(da,{value:"order",className:"flex items-center justify-center gap-2 text-xs",children:"Comanda"}),a.jsx(da,{value:"details",className:"flex items-center justify-center gap-2 text-xs",children:"Detalhes"}),a.jsxs(da,{value:"products",onClick:()=>{i&&w(!0)},className:"flex items-center justify-center gap-2 text-xs",children:["Produtos",a.jsx("kbd",{className:"hidden md:inline px-1 py-0.5 text-[10px] font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),a.jsx(ds,{value:"order",className:"flex-1 overflow-hidden min-h-0",children:a.jsx(Pr,{table:i})}),a.jsx(ds,{value:"details",className:"flex-1 overflow-hidden min-h-0",children:a.jsx(Sr,{table:i})})]})})]})]}),a.jsx(se,{}),a.jsx(Ie,{}),a.jsx(ft,{open:v,onOpenChange:g,cashSummary:I}),a.jsx(Dt,{}),a.jsx(Bt,{}),ve?a.jsx(S,{}):null,a.jsx(rr,{}),a.jsx(vr,{}),Pn&&a.jsx("div",{className:"fixed left-3 right-3 z-[9999]",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:a.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[a.jsx(Ic,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),a.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:ke||"Ateno"})]})}),xt&&a.jsx(Gat,{item:xt,onApply:()=>{i&&et(i)},onClose:()=>{it(null)},codigoEmpresa:t?.codigo_empresa}),i&&kt&&a.jsx(Kat,{comanda:i,subtotal:En(i.order||[],i),onApply:()=>{i&&et(i)},onClose:()=>be(!1),codigoEmpresa:t?.codigo_empresa}),(lt||at||Pt)&&a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80",children:a.jsxs("div",{className:"px-8 py-6 rounded-xl bg-surface border border-border shadow-2xl flex flex-col items-center gap-4 max-w-sm w-[85vw] text-center",children:[a.jsx("div",{className:"w-8 h-8 rounded-full border-4 border-brand border-t-transparent animate-spin","aria-hidden":"true"}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block text-base font-semibold text-text-primary",children:lt?"Abrindo mesa...":at?"Cancelando comanda...":"Fechando conta..."}),a.jsx("span",{className:"block text-xs text-text-muted",children:lt?"Aguarde, estamos criando a comanda e sincronizando com os outros dispositivos.":at?"Aguarde, estamos cancelando a comanda e liberando a mesa em todos os dispositivos.":"Aguarde, estamos registrando os pagamentos e liberando a mesa em todos os dispositivos."})]})]})}),p.useMemo(()=>a.jsx(On,{},(i?.order||[]).map(V=>`${String(V.productId)}:${Number(V.quantity||0)}`).join("|")),[b,i?.id,i?.order])]})}function Jat(){const{toast:e}=as(),t=Ri(),{userProfile:r}=vs(),[n,s]=p.useState(null),[o,i]=p.useState([]),[l,c]=p.useState([]),[d,u]=p.useState(!0),[f,h]=p.useState(!1),[m,v]=p.useState(!1),[g,y]=p.useState(!1),[x,b]=p.useState(""),[w,j]=p.useState(""),[_,C]=p.useState(null),[P,E]=p.useState(null),[A,F]=p.useState(!1),D=p.useRef(!1),[I,R]=p.useState(new Map),[M,U]=p.useState(!1),[z,W]=p.useState(!1),[$,ee]=p.useState(!1),[ve,_e]=p.useState(!1),[K,q]=p.useState(null),[Y,J]=p.useState(!1),[fe,Z]=p.useState(!1),[ce,le]=p.useState([]);p.useState(null);const[ie,te]=p.useState(!1),[ue,Te]=p.useState([]),[ne,de]=p.useState(1),[lt,Nt]=p.useState([]),[at,gt]=p.useState(null),[Pt,yt]=p.useState(!1),[Qe,ge]=p.useState(null),[rt,pt]=p.useState(!1),[We,Ze]=p.useState(""),[Ne,ye]=p.useState(!1),[Be,mt]=p.useState(""),[Ft,fr]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}});p.useEffect(()=>{const re=()=>{try{fr(typeof window<"u"&&window.innerWidth<=640)}catch{fr(!1)}};return re(),window.addEventListener("resize",re),()=>window.removeEventListener("resize",re)},[]),p.useState("cadastrado");const[It,Ut]=p.useState(""),[xe,st]=p.useState([]),[Ct,ar]=p.useState([]);p.useState(!1),p.useState(!1);const[pr,Xt]=p.useState(!1),[yr,lr]=p.useState(!1),[Rr,Pn]=p.useState(0),[De,ke]=p.useState("all"),[Ge,Re]=p.useState(()=>{try{return localStorage.getItem("balcao_sort_order")||"code"}catch{return"code"}}),bt=p.useRef([]),Qt=p.useRef(null),[ct,xt]=p.useState(()=>{try{const re=localStorage.getItem("balcao_left_panel_width");return re?parseFloat(re):50}catch{return 50}}),[it,kt]=p.useState(!1),be=p.useRef(null),dt=p.useRef(0),Lt=p.useRef([]);p.useEffect(()=>{Lt.current=l},[l]);const mr=p.useRef(!1);p.useEffect(()=>(mr.current=!0,()=>{mr.current=!1}),[]);const tr=p.useRef(null),Or=p.useRef(null),Lr=p.useRef(null),sr=p.useRef(null);p.useEffect(()=>{sr.current=n},[n]),p.useEffect(()=>{const re=r?.codigo_empresa;if(!re)return;try{const X=typeof window<"u"?window.localStorage.getItem("custom-auth-token"):null;if(X&&X.trim())he.realtime.setAuth(X.trim());else{let H="";try{H=(new URL(he.supabaseUrl||"").host||"").split(".")[0]||""}catch{}const L=H?`sb-${H}-auth-token`:"sb-auth-token",Fe=typeof window<"u"?window.localStorage.getItem(L):null;if(Fe)try{const nt=JSON.parse(Fe),ft=nt?.access_token||nt?.currentSession?.access_token;ft&&he.realtime.setAuth(ft)}catch{}}}catch{}const O=he.channel(`loja:${re}`),T=async X=>{const H=X?.table||X?.table_name||"",L=X?.new||X?.old||{},Fe=X?.eventType||X?.type||X?.event||"";try{if(H==="comanda_itens"){const nt=X?.new?.comanda_id||X?.old?.comanda_id||L?.comanda_id||null;if(nt){const ft=sr.current;if(ft&&String(ft)===String(nt)){try{await Fr(ft,2)}catch{}try{const Bt=await Lm({codigoEmpresa:re}),$e=new Map;for(const Dt of Bt||[])$e.set(Dt.produto_id,($e.get(Dt.produto_id)||0)+Number(Dt.quantidade||0));R($e)}catch{}return}try{const Bt=await qv({codigoEmpresa:re});if(Bt?.id&&String(Bt.id)===String(nt)){s(Bt.id);try{await Fr(Bt.id,2)}catch{}try{const $e=await Lm({codigoEmpresa:re}),Dt=new Map;for(const Sr of $e||[])Dt.set(Sr.produto_id,(Dt.get(Sr.produto_id)||0)+Number(Sr.quantidade||0));R(Dt)}catch{}return}}catch{}}}if(H==="comanda_clientes"){const nt=X?.new?.comanda_id||X?.old?.comanda_id||L?.comanda_id||null;if(nt&&sr.current&&String(sr.current)===String(nt)){try{await Fr(nt,2)}catch{}return}}if(H==="comandas"){const nt=L?.mesa_id,ft=L?.id||X?.old?.id||null,Bt=String(L?.status||"").toLowerCase(),$e=String(Fe||"").toUpperCase()==="DELETE"||Bt.includes("fechad")||Bt.includes("closed")||Bt.includes("encerr"),Dt=String(Fe||"").toUpperCase()==="INSERT";if($e&&nt==null&&sr.current&&ft&&String(sr.current)===String(ft)){c([]),s(null),ar([]),b(""),lr(!1);try{localStorage.removeItem(St.comandaId),localStorage.removeItem(St.items),localStorage.removeItem(St.customerName),localStorage.removeItem(St.pendingClientIds),localStorage.removeItem(St.clientChosen)}catch{}}if(Dt&&nt==null&&["open","awaiting-payment","awaiting_payment"].includes(Bt)){s(ft);try{await Fr(ft,2)}catch{}}}}catch{}if(Or.current)try{clearTimeout(Or.current)}catch{}Or.current=setTimeout(async()=>{const nt=sr.current;if(nt)try{await Fr(nt,2)}catch{}else try{const ft=await qv({codigoEmpresa:re});if(ft?.id){s(ft.id);try{await Fr(ft.id,2)}catch{}}}catch{}},250)};if(O.on("postgres_changes",{event:"*",schema:"public",table:"comandas",filter:`codigo_empresa=eq.${re}`},T).on("postgres_changes",{event:"*",schema:"public",table:"comanda_itens"},T).on("postgres_changes",{event:"*",schema:"public",table:"comanda_clientes"},T).subscribe(),tr.current=O,Lr.current)try{clearInterval(Lr.current)}catch{}return Lr.current=setInterval(async()=>{const X=sr.current;if(X)try{await Fr(X,1)}catch{}else try{const H=await qv({codigoEmpresa:re});if(H?.id){s(H.id);try{await Fr(H.id,1)}catch{}}}catch{}},6e4),()=>{if(tr.current){try{he.removeChannel(tr.current)}catch{}tr.current=null}if(Or.current){try{clearTimeout(Or.current)}catch{}Or.current=null}if(Lr.current){try{clearInterval(Lr.current)}catch{}Lr.current=null}}},[r?.codigo_empresa]),p.useEffect(()=>{(l||[]).length>0&&(D.current=!0)},[l]),p.useEffect(()=>{n&&D.current&&(l||[]).length===0&&Fr(n,2)},[n,l?.length]),p.useEffect(()=>{if(Y)return;let re=!0;return(async()=>{try{const O=await Km({codigoEmpresa:r?.codigo_empresa});re&&U(!!O)}catch{re&&U(!1)}})(),()=>{re=!1}},[r?.codigo_empresa,Y]);const fn=async()=>{const re=r?.codigo_empresa||null;try{if(!re)return;_e(!0);const[O,T]=await Promise.all([Fw({codigoEmpresa:re}).catch(()=>null),Km({codigoEmpresa:re}).catch(()=>null)]);if(!T?.id){q(null);return}let X=0,H=0,L=[];try{L=await Wp({caixaSessaoId:T.id,codigoEmpresa:re}),X=(L||[]).filter(nt=>String(nt?.tipo||"").toLowerCase()==="sangria").reduce((nt,ft)=>nt+Number(ft?.valor||0),0),H=(L||[]).filter(nt=>String(nt?.tipo||"").toLowerCase()==="suprimento").reduce((nt,ft)=>nt+Number(ft?.valor||0),0)}catch{}const Fe={saldo_inicial:T.saldo_inicial||0,totalPorFinalizadora:O?.totalPorFinalizadora||O?.porFinalizadora||{},totalEntradas:O?.totalEntradas||O?.entradas||0,totalSangria:X,totalSuprimento:H,totalSaidas:X,sessaoId:T.id,movimentacoes:L};q(Fe)}catch{q(null)}finally{_e(!1)}};p.useEffect(()=>{let re=!0;return(async()=>{try{if(!fe||!n)return;const T=r?.codigo_empresa;let X=[];try{const Fe=await ai({comandaId:n,codigoEmpresa:T});X=(Array.isArray(Fe)?Fe:[]).map(ft=>{const Bt=ft?.clientes?.id??ft?.cliente_id??ft?.id??null,$e=ft?.clientes?.nome??ft?.nome??ft?.nome_livre??"";return Bt?{id:Bt,nome:$e}:null}).filter(Boolean)}catch{X=[]}if(!re)return;Nt(X);const L=Array.isArray(Ct)&&Ct.length>0?Ct:X.map(Fe=>Fe.id);if(!Array.isArray(L)||L.length===0)return;Te(Fe=>{let nt=Fe&&Fe.length?[...Fe]:[{id:1,clientId:L[0],methodId:ce[0]?.id||"",value:""}];nt[0]||(nt[0]={id:1,clientId:L[0],methodId:ce[0]?.id||"",value:""}),nt[0].clientId=L[0];const ft=new Set([nt[0].clientId].filter(Boolean));for(let Bt=1;Bt<nt.length;Bt++){if(!nt[Bt].clientId||ft.has(nt[Bt].clientId)){const $e=(L||[]).find(Dt=>!ft.has(Dt));nt[Bt].clientId=$e||L[0]}ft.add(nt[Bt].clientId)}return nt})}catch{}})(),()=>{re=!1}},[fe,Ct,n,r?.codigo_empresa]);const Tn=re=>{const O=String(re||"").replace(/\D/g,"");return O?Number(O)/100:0},mn=re=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(re),zn=re=>(ce||[]).find(O=>String(O.id)===String(re)),ot=re=>Number(zn(re.methodId)?.taxa_percentual||0),$t=re=>{const O=Tn(re.value),T=ot(re);return!re.chargeFee||!T?O:O/(1+T/100)},Yt=re=>{const O=$t(re),T=ot(re);return!re.chargeFee||!T||O<=0?0:O*(T/100)},Ht=(re,O)=>{const T=ot(re);if(re.chargeFee&&T>0){const X=O*(1+T/100);return{...re,value:mn(X)}}return{...re,value:mn(O)}},Ot=()=>(ue||[]).reduce((re,O)=>re+$t(O),0),Xr=()=>(ue||[]).reduce((re,O)=>re+Yt(O),0),Je=()=>Ot()+Xr();p.useEffect(()=>{try{if(!fe)return;let re=0;try{re=(l||[]).reduce((X,H)=>X+Number(H.quantity||0)*Number(H.price||0),0)}catch{}const O=Ot(),T=re-O;Math.abs(T)>.009&&Math.abs(T)<=.05&&Array.isArray(ue)&&ue.length>0&&Te(X=>X.map((H,L,Fe)=>{if(L!==Fe.length-1)return H;const nt=$t(H)+T;return Ht(H,nt)}))}catch{}},[ue,fe]);const cr=async()=>{try{if(y(!0),!n){e({title:"Nenhuma comanda aberta",description:"Adicione itens para abrir uma comanda.",variant:"warning"});return}const re=r?.codigo_empresa;if(!re){e({title:"Empresa no definida",variant:"destructive"});return}try{const{data:H,error:L}=await he.from("comandas").select("id").eq("id",n).eq("codigo_empresa",re).single();if(L||!H){console.error("[confirmPay] Comanda no encontrada no banco:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Criando nova comanda...",variant:"warning"}),s(null),c([]);try{localStorage.removeItem(St.comandaId),localStorage.removeItem(St.items)}catch{}await zr();return}}catch(H){console.error("[confirmPay] Erro ao validar comanda:",H),e({title:"Erro de validao",description:"No foi possvel validar a comanda.",variant:"destructive"});return}if(!Array.isArray(ue)||ue.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const H of ue){if(!H.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(!String(H.value||"").replace(/\D/g,"")){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}let O=0;try{O=(await uo({comandaId:n,codigoEmpresa:re})||[]).reduce((L,Fe)=>L+Number(Fe.quantidade||0)*Number(Fe.preco_unitario||0),0)}catch{}const T=Ot(),X=Math.abs(T-O);if(X>.009&&X<=.05){const H=O-T;Te(L=>L.map((Fe,nt,ft)=>{if(nt!==ft.length-1)return Fe;const Bt=$t(Fe)+H;return Ht(Fe,Bt)}))}else if(X>.05){const H=O-T;H>0?e({title:"Valor insuficiente",description:`Faltam R$ ${H.toFixed(2)} para fechar o total.`,variant:"warning"}):e({title:"Valor excedente",description:`Excedeu em R$ ${Math.abs(H).toFixed(2)}. Ajuste os valores.`,variant:"warning"});return}te(!0),await Sf({codigoEmpresa:re});for(const H of ue){const L=Tn(H.value),Fe=ce.find(ft=>String(ft.id)===String(H.methodId)),nt=Fe?.nome||Fe?.tipo||"outros";await BM({comandaId:n,finalizadoraId:H.methodId,metodo:nt,valor:L,status:"Pago",codigoEmpresa:re,clienteId:H.clientId||null})}await Jx({comandaId:n,codigoEmpresa:re}),s(null),c([]),ar([]),b(""),lr(!1),Te([]);try{localStorage.removeItem(St.comandaId),localStorage.removeItem(St.items),localStorage.removeItem(St.customerName)}catch{}e({title:"Pagamento concludo",description:`Total R$ ${O.toFixed(2)}`,variant:"success"}),Z(!1)}catch(re){e({title:"Falha ao concluir",description:re?.message||"Tente novamente",variant:"destructive"})}finally{te(!1),y(!1)}};p.useEffect(()=>{(async()=>{try{if(!z)return;await fn()}catch{}})()},[z,r?.codigo_empresa]);const vt=()=>{const[re,O]=p.useState(""),T=p.useRef(null);return p.useEffect(()=>{if(typeof window<"u"&&window.innerWidth<=640)return;const H=setTimeout(()=>{try{T.current?.focus()}catch{}},0);return()=>clearTimeout(H)},[]),a.jsxs(a.Fragment,{children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Abrir Caixa"}),a.jsx(ld,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(Le,{className:"mb-2 block",htmlFor:"open-cash-initial",children:"Saldo inicial"}),a.jsx(Ye,{id:"open-cash-initial",ref:T,type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:re,onChange:X=>{const H=(X.target.value||"").replace(/\D/g,""),L=H?Number(H)/100:0,Fe=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(L);O(Fe)},onKeyDown:X=>{X.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(X.key)&&(/^[0-9]$/.test(X.key)||X.preventDefault())},onBeforeInput:X=>{const H=X.data??"";H&&/\D/.test(H)&&X.preventDefault()}}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Digite nmeros; a mscara formata em reais automaticamente."})]}),a.jsxs(od,{children:[a.jsx(cd,{onClick:()=>ee(!1),children:"Cancelar"}),a.jsx(Zd,{onClick:async()=>{try{const X=String(re||"").replace(/\D/g,""),H=X?Number(X)/100:0;await Sf({saldoInicial:H,codigoEmpresa:r?.codigo_empresa}),U(!0),ee(!1),e({title:"Caixa aberto com sucesso!",variant:"success"})}catch(X){e({title:"Falha ao abrir caixa",description:X?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Abertura"})]})]})},Tt=()=>a.jsxs(Qd,{open:$,onOpenChange:ee,children:[a.jsx(Ip,{asChild:!0,children:a.jsxs(me,{variant:"success",size:"sm",disabled:M,onClick:()=>ee(!0),className:"px-3",children:[a.jsx(VH,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"})]})}),a.jsx(ad,{className:"sm:max-w-[425px] w-[92vw] animate-none",onKeyDown:re=>re.stopPropagation(),onEscapeKeyDown:re=>{re.preventDefault(),re.stopPropagation()},onPointerDownOutside:re=>{re.preventDefault(),re.stopPropagation()},onFocusOutside:re=>{re.preventDefault(),re.stopPropagation()},onInteractOutside:re=>{re.preventDefault(),re.stopPropagation()},onOpenAutoFocus:re=>{re.preventDefault()},onCloseAutoFocus:re=>{re.preventDefault()},children:a.jsx(vt,{})})]}),Dr=()=>{const[re,O]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[T,X]=p.useState(!1),[H,L]=p.useState(""),[Fe,nt]=p.useState(!1),ft=async()=>{try{O({loading:!0,saldoInicial:0,resumo:null});const vr=await Km({codigoEmpresa:r?.codigo_empresa}),yn=await Fw({codigoEmpresa:r?.codigo_empresa});O({loading:!1,saldoInicial:Number(vr?.saldo_inicial||0),resumo:yn||{totalPorFinalizadora:{}}})}catch{O({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},Bt=re?.resumo?.totalPorFinalizadora||{},$e=Object.values(Bt).reduce((vr,yn)=>vr+Number(yn||0),0),Dt=Number(re.saldoInicial||0)+$e,Sr=Number(K?.totalSuprimento||0),Pr=Number(K?.totalSangria||0);return a.jsxs(Qd,{open:Y,onOpenChange:vr=>{vr&&(J(!0),nt(!1),ft())},children:[a.jsx(Ip,{asChild:!0,children:a.jsxs(me,{variant:"destructive",size:"sm",disabled:!M,onClick:()=>{J(!0)},className:"px-3",children:[a.jsx(xx,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2",children:"Fechar Caixa"})]})}),a.jsxs(ad,{className:"sm-max-w-[425px] animate-none",onKeyDown:vr=>vr.stopPropagation(),onEscapeKeyDown:vr=>{vr.preventDefault(),vr.stopPropagation()},onPointerDownOutside:vr=>{vr.preventDefault(),vr.stopPropagation()},onFocusOutside:vr=>{vr.preventDefault(),vr.stopPropagation()},onInteractOutside:vr=>{vr.preventDefault(),vr.stopPropagation()},onOpenAutoFocus:vr=>{vr.preventDefault()},onCloseAutoFocus:vr=>{vr.preventDefault()},children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Fechar Caixa"}),a.jsx(ld,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),T&&a.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[a.jsx(Ic,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),re.loading?a.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):a.jsx("div",{className:"py-4 space-y-2",children:Fe?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(re.saldoInicial||0).toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Final"})," ",a.jsx("span",{className:"font-mono",children:(()=>{const vr=String(H||"").replace(/\D/g,""),yn=vr?Number(vr)/100:0;return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(yn)})()})]})]}),a.jsxs("div",{className:"mt-2",children:[a.jsx(Le,{className:"mb-1 block",children:"Saldo Final (opcional)"}),a.jsx(Ye,{type:"text",inputMode:"numeric",placeholder:"0,00",value:H,onChange:vr=>{const yn=(vr.target.value||"").replace(/\D/g,""),On=yn?Number(yn)/100:0,Xn=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(On);L(Xn)},onKeyDown:vr=>{vr.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(vr.key)&&(/^[0-9]$/.test(vr.key)||vr.preventDefault())},onBeforeInput:vr=>{const yn=vr.data??"";yn&&/\D/.test(yn)&&vr.preventDefault()}})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Resumo"}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(re.saldoInicial||0).toFixed(2)]})]}),Object.keys(Bt).length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):a.jsx("div",{className:"space-y-1",children:Object.entries(Bt).map(([vr,yn])=>a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:String(vr)})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(yn||0).toFixed(2)]})]},vr))}),a.jsx("div",{className:"my-2 h-px bg-border"}),a.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Conferncia"}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Suprimentos"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Sr.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Sangrias"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Pr.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between font-medium text-base",children:[a.jsx("span",{className:"text-text-secondary",children:"Total em Caixa"})," ",a.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(Dt||0).toFixed(2)]})]})]})}),a.jsx(od,{children:Fe?a.jsxs(a.Fragment,{children:[a.jsx(me,{variant:"outline",onClick:()=>nt(!1),children:"Voltar"}),a.jsx(me,{onClick:async()=>{try{try{const On=await jc({codigoEmpresa:r?.codigo_empresa});if(Array.isArray(On)&&On.length>0){Ft?(X(!0),e({title:"Fechamento bloqueado",description:`Existem ${On.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning"})):e({title:"Fechamento bloqueado",description:`Existem ${On.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning",duration:2500});return}}catch{}const vr=String(H||"").replace(/\D/g,""),yn=vr?Number(vr)/100:0;await Ere({codigoEmpresa:r?.codigo_empresa,valorFinalDinheiro:yn}),U(!1),J(!1),e({title:"Caixa fechado!",description:"Fechamento registrado com sucesso.",variant:"success"})}catch(vr){e({title:"Falha ao fechar caixa",description:vr?.message||"Tente novamente",variant:"destructive"})}},children:"Fechar Caixa"})]}):a.jsxs(a.Fragment,{children:[a.jsx(cd,{onClick:()=>J(!1),children:"Cancelar"}),a.jsx(me,{onClick:()=>nt(!0),children:"Confirmar Fechamento"})]})})]})]})},an=()=>{const re=cn=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(cn||0)),[O,T]=p.useState(!1),[X,H]=p.useState(!1),[L,Fe]=p.useState(""),[nt,ft]=p.useState(""),[Bt,$e]=p.useState(!1),Dt=async()=>{try{$e(!0);const cn=String(L||"").replace(/\D/g,""),Hr=cn?Number(cn)/100:0;if(Hr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await Sf({codigoEmpresa:r?.codigo_empresa}),await NT({tipo:"sangria",valor:Hr,observacao:nt,codigoEmpresa:r?.codigo_empresa}),T(!1),Fe(""),ft(""),await fn(),e({title:"Sangria registrada",variant:"success"})}catch(cn){e({title:"Falha ao registrar sangria",description:cn?.message||"Tente novamente",variant:"destructive"})}finally{$e(!1)}},[Sr,Pr]=p.useState(""),[vr,yn]=p.useState(""),[On,Xn]=p.useState(!1),kn=async()=>{try{Xn(!0);const cn=String(Sr||"").replace(/\D/g,""),Hr=cn?Number(cn)/100:0;if(Hr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await Sf({codigoEmpresa:r?.codigo_empresa}),await NT({tipo:"suprimento",valor:Hr,observacao:vr,codigoEmpresa:r?.codigo_empresa}),H(!1),Pr(""),yn(""),await fn(),e({title:"Suprimento registrado",variant:"success"})}catch(cn){e({title:"Falha ao registrar suprimento",description:cn?.message||"Tente novamente",variant:"destructive"})}finally{Xn(!1)}};return a.jsx(xn,{open:z,onOpenChange:W,children:a.jsxs(vn,{className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:cn=>cn.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),a.jsx(Dn,{children:ve?"Carregando resumo...":K?"Resumo da sesso atual do caixa.":"Nenhuma sesso de caixa aberta."})]}),K?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-1 overflow-y-auto pr-1",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Inicial"}),a.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:re(K.saldo_inicial)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Entradas"}),a.jsx("div",{className:"text-base md:text-lg font-bold text-success tabular-nums leading-tight",children:re(K.totalEntradas)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Sadas"}),a.jsx("div",{className:"text-base md:text-lg font-bold text-danger tabular-nums leading-tight",children:re(K.totalSangria)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Atual"}),a.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:re((K.saldo_inicial||0)+(K.totalEntradas||0)-(K.totalSangria||0))})]})]}),a.jsxs("div",{className:"mt-5",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("h4",{className:"text-sm font-semibold text-text-secondary",children:"Totais por Finalizadora"})}),Object.keys(K.totalPorFinalizadora||{}).length===0?a.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):a.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(K.totalPorFinalizadora||{}).map(([cn,Hr])=>a.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(cn)}),a.jsx("span",{className:"text-sm font-semibold tabular-nums",children:re(Hr)})]},cn))}),a.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Suprimentos"}),a.jsx("span",{className:"text-sm font-semibold tabular-nums text-success",children:re(K.totalSuprimento||0)})]}),a.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),a.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:re(K.totalSangria||0)})]})]})]}),a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"mr-auto"}),a.jsx(me,{variant:"outline",onClick:()=>H(!0),children:"Registrar Suprimento"}),a.jsx(me,{variant:"destructive",onClick:()=>T(!0),children:"Registrar Sangria"}),a.jsx(me,{variant:"secondary",onClick:()=>W(!1),children:"Fechar"})]}),a.jsx(xn,{open:X,onOpenChange:H,children:a.jsxs(vn,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:cn=>cn.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-xl font-bold",children:"Registrar Suprimento"}),a.jsx(Dn,{children:"Informe o valor de entrada no caixa e, opcionalmente, uma observao."})]}),a.jsxs("div",{className:"flex-1 flex flex-col space-y-3",children:[a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"r-valor",children:"Valor"}),a.jsx(Ye,{id:"r-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:Sr,onChange:cn=>{const Hr=(cn.target.value||"").replace(/\D/g,""),va=Hr?Number(Hr)/100:0,Ma=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(va);Pr(Ma)},onKeyDown:cn=>{cn.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(cn.key)&&(/^[0-9]$/.test(cn.key)||cn.preventDefault())},onBeforeInput:cn=>{const Hr=cn.data??"";Hr&&/\D/.test(Hr)&&cn.preventDefault()}})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"r-obs",children:"Observao"}),a.jsx(Ye,{id:"r-obs",placeholder:"Opcional",value:vr,onChange:cn=>yn(cn.target.value)})]})]}),a.jsxs(ra,{children:[a.jsx(me,{variant:"outline",onClick:()=>H(!1),disabled:On,children:"Cancelar"}),a.jsx(me,{onClick:kn,disabled:On,children:On?"Registrando...":"Confirmar"})]})]})}),a.jsx(xn,{open:O,onOpenChange:T,children:a.jsxs(vn,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:cn=>cn.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-xl font-bold",children:"Registrar Sangria"}),a.jsx(Dn,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"s-valor",children:"Valor"}),a.jsx(Ye,{id:"s-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:L,onChange:cn=>{const Hr=(cn.target.value||"").replace(/\D/g,""),va=Hr?Number(Hr)/100:0,Ma=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(va);Fe(Ma)},onKeyDown:cn=>{cn.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(cn.key)&&(/^[0-9]$/.test(cn.key)||cn.preventDefault())},onBeforeInput:cn=>{const Hr=cn.data??"";Hr&&/\D/.test(Hr)&&cn.preventDefault()}})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"s-obs",children:"Observao"}),a.jsx(Ye,{id:"s-obs",placeholder:"Opcional",value:nt,onChange:cn=>ft(cn.target.value)})]})]}),a.jsxs(ra,{children:[a.jsx(me,{variant:"outline",onClick:()=>T(!1),disabled:Bt,children:"Cancelar"}),a.jsx(me,{onClick:Dt,disabled:Bt,children:Bt?"Registrando...":"Confirmar"})]})]})})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma sesso de caixa aberta."})]})})},Nr=r?.codigo_empresa||"anon",St={comandaId:`balcao:comandaId:${Nr}`,items:`balcao:items:${Nr}`,customerName:`balcao:customer:${Nr}`,clientChosen:`balcao:clientChosen:${Nr}`,pendingClientIds:`balcao:pendingClientIds:${Nr}`,missCount:`balcao:missCount:${Nr}`,lastMissTs:`balcao:lastMissTs:${Nr}`},Fr=async(re,O=3)=>{if(!re)return;const T=r?.codigo_empresa,X=++dt.current;for(let H=0;H<O;H++)try{const L=await uo({comandaId:re,codigoEmpresa:T});if(X!==dt.current)return;const Fe=(L||[]).map(nt=>({id:nt.id,productId:nt.produto_id,name:nt.descricao||"Item",price:Number(nt.preco_unitario||0),quantity:Number(nt.quantidade||1)}));c(Fe);try{const nt=await ai({comandaId:re,codigoEmpresa:T});if(X!==dt.current)return;const ft=(nt||[]).map(Dt=>Dt?.nome).filter(Boolean),Bt=ft.length?ft.join(", "):"";b(Bt),lr(!!Bt);const $e=Array.from(new Set((nt||[]).map(Dt=>Dt?.cliente_id).filter(Boolean)));$e.length>0&&ar($e)}catch{b(""),lr(!1)}break}catch(L){if(H===O-1)e({title:"Falha ao atualizar itens",description:L?.message||"Tente novamente",variant:"destructive"});else{const Fe=350*(H+1),nt=Math.floor(Math.random()*120);await new Promise(ft=>setTimeout(ft,Fe+nt))}}},zr=async()=>{try{u(!0);let re=setTimeout(()=>{mr.current&&u(!1)},1e4);const O=r?.codigo_empresa;if(!O){mr.current&&u(!1);return}try{const L=localStorage.getItem(St.comandaId),Fe=JSON.parse(localStorage.getItem(St.items)||"[]"),nt=localStorage.getItem(St.customerName)||"",ft=localStorage.getItem(St.clientChosen),Bt=JSON.parse(localStorage.getItem(St.pendingClientIds)||"[]");L&&s(Number.isNaN(+L)?L:Number(L)),Array.isArray(Fe)&&Fe.length>0&&c(Fe),nt&&b(nt),ft==="true"&&lr(!0),Array.isArray(Bt)&&Bt.length>0&&ar(Bt)}catch{}const T=localStorage.getItem(St.comandaId),X=T?Number.isNaN(+T)?T:Number(T):null,H=await qv({codigoEmpresa:O}).catch(()=>null);if(H?.id)s(H.id),await Fr(H.id);else if(X)s(X),await Fr(X,3);else{let L=0,Fe=0;try{L=Number(localStorage.getItem(St.missCount)||"0"),Fe=Number(localStorage.getItem(St.lastMissTs)||"0")}catch{}const nt=Date.now(),Bt=nt-Fe<9e4?L+1:1;try{localStorage.setItem(St.missCount,String(Bt)),localStorage.setItem(St.lastMissTs,String(nt))}catch{}try{const $e=localStorage.getItem(St.customerName)||"",Dt=localStorage.getItem(St.clientChosen)==="true",Sr=JSON.parse(localStorage.getItem(St.pendingClientIds)||"[]");b($e||""),lr(!!Dt),ar(Array.isArray(Sr)?Sr:[])}catch{}if(s(null),Bt>=2){c([]);try{localStorage.removeItem(St.comandaId),localStorage.removeItem(St.items)}catch{}}else try{const $e=JSON.parse(localStorage.getItem(St.items)||"[]");Array.isArray($e)&&$e.length>0&&c($e)}catch{}}try{const L=await hu({includeInactive:!1,search:w?.trim()||void 0,codigoEmpresa:O});mr.current&&i(L||[])}catch{i([])}clearTimeout(re)}catch(re){e({title:"Falha ao carregar Modo Balco",description:re?.message||"Tente novamente",variant:"destructive"})}finally{mr.current&&u(!1)}},ha=async()=>{try{F(!0),v(!0);const re=r?.codigo_empresa;if(n&&re)try{try{await he.from("comanda_itens").delete().eq("comanda_id",n).eq("codigo_empresa",re)}catch{}try{await he.from("comanda_clientes").delete().eq("comanda_id",n).eq("codigo_empresa",re)}catch{}await he.from("comandas").delete().eq("id",n).eq("codigo_empresa",re)}catch{}}finally{s(null),c([]),ar([]),b(""),lr(!1),E(null);try{localStorage.removeItem(St.comandaId),localStorage.removeItem(St.items),localStorage.removeItem(St.customerName)}catch{}F(!1),e({title:"Venda cancelada",variant:"success"}),v(!1)}};p.useEffect(()=>{let re=!1;(async()=>{await zr(),!re&&mr.current&&!n&&(Lt.current||[]).length===0&&(re=!0,setTimeout(()=>{mr.current&&zr()},700))})()},[r?.codigo_empresa]),p.useEffect(()=>{try{n&&localStorage.setItem(St.comandaId,String(n)),localStorage.setItem(St.items,JSON.stringify(l||[])),localStorage.setItem(St.customerName,x||""),localStorage.setItem(St.clientChosen,yr?"true":"false"),n?localStorage.removeItem(St.pendingClientIds):localStorage.setItem(St.pendingClientIds,JSON.stringify(Ct||[]))}catch{}},[n,l,x,yr,Ct]),p.useEffect(()=>{const re=()=>{n&&Fr(n,2)},O=()=>{document.visibilityState==="visible"&&n&&Fr(n,2)};return window.addEventListener("focus",re),document.addEventListener("visibilitychange",O),()=>{window.removeEventListener("focus",re),document.removeEventListener("visibilitychange",O)}},[n]),p.useEffect(()=>{const re=O=>{const T=O.target;if(!(T&&(T.tagName==="INPUT"||T.tagName==="TEXTAREA"))){if(O.key==="p"||O.key==="P"){O.preventDefault(),Qt.current?.focus();return}if((O.key==="c"||O.key==="C")&&M&&yr){O.preventDefault(),Xt(!0);return}if(O.key==="Escape"){if(rt){pt(!1);return}if(pr){Xt(!1);return}if(fe){Z(!1);return}if(Pt){yt(!1);return}}}};return window.addEventListener("keydown",re),()=>window.removeEventListener("keydown",re)},[M,yr,rt,pr,fe,Pt]),p.useEffect(()=>{const re=T=>{if(!it||!be.current)return;const H=be.current.getBoundingClientRect(),L=18;H.width-L;const nt=(T.clientX-H.left)/H.width*100;nt>=20&&nt<=80&&xt(nt)},O=()=>{if(it){kt(!1);try{localStorage.setItem("balcao_left_panel_width",String(ct))}catch{}}};return it&&(document.addEventListener("mousemove",re),document.addEventListener("mouseup",O),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",O),document.body.style.cursor="",document.body.style.userSelect=""}},[it,ct]),p.useEffect(()=>{let re=!0;const O=setTimeout(async()=>{try{const T=await hu({includeInactive:!1,search:w?.trim()||void 0,codigoEmpresa:r?.codigo_empresa});if(!re)return;let X=T||[];if(w?.trim()){const H=w.trim().toLowerCase();X=X.filter(L=>(L.name||"").toLowerCase().includes(H)||(L.code||"").toLowerCase().includes(H))}X.sort((H,L)=>{const Fe=H.code||"",nt=L.code||"";return/^\d+$/.test(Fe)&&/^\d+$/.test(nt)?parseInt(Fe,10)-parseInt(nt,10):Fe.localeCompare(nt)}),i(X)}catch{re&&i([])}},300);return()=>{re=!1,clearTimeout(O)}},[w]),p.useEffect(()=>{if(Y)return;let re=!0;const O=async()=>{try{const X=r?.codigo_empresa;if(!X)return;const H=await Lm({codigoEmpresa:X});if(!re)return;const L=new Map;for(const Fe of H||[]){const nt=Fe.produto_id,ft=Number(Fe.quantidade||0);L.set(nt,(L.get(nt)||0)+ft)}R(L)}catch(X){console.error("[BalcaoPage] Erro ao buscar estoque reservado:",X),re&&R(new Map)}};O();const T=setInterval(O,5e3);return()=>{re=!1,clearInterval(T)}},[r?.codigo_empresa,l,Y]),p.useEffect(()=>{if(Y)return;let re=!0;const O=setTimeout(async()=>{try{const T=await db({searchTerm:It,limit:20,codigoEmpresa:r?.codigo_empresa});if(!re)return;const X=(T||[]).slice().sort((H,L)=>Number(H?.codigo||0)-Number(L?.codigo||0));if(st(X),!n&&!yr&&pr&&(!Ct||Ct.length===0)){const H=X?.find(L=>L?.codigo===0);if(H){ar([H.id]);try{localStorage.setItem(St.pendingClientIds,JSON.stringify([H.id]))}catch{}}}}catch{re&&st([])}},250);return()=>{re=!1,clearTimeout(O)}},[It,pr,Y]);const En=p.useMemo(()=>l.reduce((re,O)=>re+Number(O.price||0)*Number(O.quantity||0),0),[l]),ae=p.useMemo(()=>{const re=new Map;for(const O of l||[]){const T=O.productId;if(!T)continue;const X=Number(O.quantity||0);re.set(T,(re.get(T)||0)+X)}return re},[l]),Me=async(re,O={})=>{try{if(!M){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}if(!yr&&!O.skipClientCheck){E(re),Xt(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de vender.",variant:"warning"});return}const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}if(_)return;const X=Number(re.stock??re.currentStock??0),H=I.get(re.id)||0,L=Math.max(0,X-H),Fe=Number(re.minStock??0);if(L<=0){e({title:"Sem estoque disponvel",description:`Produto "${re.name}" est sem estoque (${X} total, ${H} reservado em outras comandas).`,variant:"destructive"});return}C(re.id);let nt=n;const ft=!nt;if(!nt)try{h(!0);const Dt=await Zj({codigoEmpresa:T});nt=Dt.id,s(Dt.id),await new Promise(Pr=>setTimeout(Pr,300));const{data:Sr}=await he.from("comandas").select("id").eq("id",nt).eq("codigo_empresa",T).single();if(!Sr)throw new Error("Comanda criada mas no acessvel via RLS")}catch(Dt){if(Dt?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para vender",description:"Voc precisa abrir o caixa antes de iniciar uma comanda no Balco.",variant:"warning"});return}throw Dt}finally{h(!1)}const Bt=Number(re.salePrice??re.price??0),$e=(Lt.current||[]).find(Dt=>Dt.productId===re.id);$e?await td({itemId:$e.id,quantidade:Number($e.quantity||0)+1,codigoEmpresa:T}):await ST({comandaId:nt,produtoId:re.id,descricao:re.name,quantidade:1,precoUnitario:Bt,codigoEmpresa:T}),await Fr(nt);try{const Dt=await Lm({codigoEmpresa:T}),Sr=new Map;for(const Pr of Dt||[]){const vr=Pr.produto_id,yn=Number(Pr.quantidade||0);Sr.set(vr,(Sr.get(vr)||0)+yn)}R(Sr)}catch(Dt){console.error("[BalcaoPage:addProduct] Erro ao atualizar estoque reservado:",Dt)}if(ft)try{const Dt=Array.from(new Set(Ct||[]));if(Dt.length>0){await ub({comandaId:nt,clienteIds:Dt,nomesLivres:[],codigoEmpresa:T,replace:!0}),await Fr(nt);const Pr=(await ai({comandaId:nt,codigoEmpresa:T})||[]).map(vr=>vr?.nome).filter(Boolean);b(Pr.length?Pr.join(", "):""),lr(!0);try{localStorage.removeItem(St.pendingClientIds),localStorage.setItem(St.customerName,Pr.length?Pr.join(", "):""),localStorage.setItem(St.clientChosen,"true")}catch(vr){console.error("Erro ao atualizar cache local:",vr)}}}catch(Dt){console.error("Erro ao associar clientes:",Dt)}X-1<=0?e({title:"ltima unidade vendida",description:`"${re.name}" esgotou aps esta venda.`,variant:"warning"}):X-1<=Fe?e({title:"Estoque baixo",description:`"${re.name}" atingiu nvel de estoque baixo.`,variant:"warning"}):e({title:"Produto adicionado",description:re.name,variant:"success"})}catch(T){const X=String(T?.message||"").toLowerCase();T?.code==="OUT_OF_STOCK"||X.includes("sem estoque")?e({title:"Sem estoque",description:"Este produto est sem estoque.",variant:"destructive"}):T?.code==="INSUFFICIENT_STOCK"||X.includes("insuficiente")?e({title:"Estoque insuficiente",description:T?.message||"Quantidade maior que o disponvel.",variant:"destructive"}):e({title:"Falha ao adicionar",description:T?.message||"Tente novamente",variant:"destructive"})}finally{C(null)}},et=async()=>{try{if(te(!0),!yr){Xt(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de pagar.",variant:"warning"}),te(!1);return}const re=r?.codigo_empresa;if(!re){e({title:"Empresa no definida",variant:"destructive"});return}if(!n)try{h(!0);const Dt=await Zj({codigoEmpresa:re});if(!Dt?.id){e({title:"Comanda no encontrada",description:"Abra uma comanda antes de pagar.",variant:"destructive"}),te(!1);return}s(Dt.id)}catch(Dt){if(Dt?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),te(!1);return}throw Dt}finally{h(!1)}try{await UGe({comandaId:n,codigoEmpresa:re})}catch(Dt){const Sr=Array.isArray(Dt?.items)&&Dt.items.length?Dt.items.map(Pr=>`${Pr.name} (solicitado ${Pr.solicitado}, estoque ${Pr.estoque})`).join("; "):Dt?.message||"Estoque insuficiente na comanda";e({title:"Estoque insuficiente",description:Sr,variant:"destructive",duration:7e3}),te(!1);return}const O=await Hm({somenteAtivas:!0,codigoEmpresa:re});le(O||[]);let T=[];try{const Dt=await ai({comandaId:n,codigoEmpresa:re});T=(Array.isArray(Dt)?Dt:[]).map(Pr=>{const vr=Pr?.cliente_id??Pr?.clientes?.id??null,yn=Pr?.clientes?.nome??Pr?.nome??Pr?.nome_livre??"";return vr?{id:vr,nome:yn}:null}).filter(Boolean)}catch{T=[]}Nt(T);const X=O&&O[0]&&O[0].id?O[0].id:null,H=Ct&&Ct.length>0?Ct[0]:T[0]?.id||null;let L=0;try{L=(await uo({comandaId:n,codigoEmpresa:re})||[]).reduce((Sr,Pr)=>Sr+Number(Pr.quantidade||0)*Number(Pr.preco_unitario||0),0)}catch{}const Fe=(O||[]).find(Dt=>String(Dt.id)===String(X)),nt=Number(Fe?.taxa_percentual||0),ft=nt>0,Bt=ft?L*(1+nt/100):L,$e=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Bt);Te([{id:1,clientId:H,methodId:X,value:$e,chargeFee:ft}]),de(2),Z(!0),te(!1);return}catch(re){if(re?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),te(!1);return}e({title:"Falha ao iniciar pagamento",description:re?.message||"Tente novamente",variant:"destructive"})}finally{te(!1)}};return a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsx("div",{className:"md:hidden mb-2 w-full",children:a.jsx(Cc,{value:"balcao",onValueChange:re=>{re==="mesas"&&t("/vendas"),re==="balcao"&&t("/balcao"),re==="historico"&&t("/historico")},children:a.jsxs(Gl,{className:"grid w-full grid-cols-3",children:[a.jsx(da,{value:"mesas",className:"text-xs",children:"Mesas"}),a.jsx(da,{value:"balcao",className:"text-xs",children:"Balco"}),a.jsx(da,{value:"historico",className:"text-xs",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[a.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:a.jsx(Cc,{value:"balcao",onValueChange:re=>{re==="mesas"&&t("/vendas"),re==="balcao"&&t("/balcao"),re==="historico"&&t("/historico")},children:a.jsxs(Gl,{className:"inline-flex",children:[a.jsx(da,{value:"mesas",className:"text-sm",children:"Mesas"}),a.jsx(da,{value:"balcao",className:"text-sm",children:"Balco"}),a.jsx(da,{value:"historico",className:"text-sm",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 md:ml-auto",children:[a.jsx(Tt,{}),a.jsx(Dr,{}),a.jsxs(me,{variant:"outline",size:"sm",onClick:()=>W(!0),className:"px-3",children:[a.jsx(c4,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"})]})]})]}),a.jsx("div",{className:"md:hidden flex-1 flex flex-col",children:a.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden bg-surface flex-1 min-h-0",children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),a.jsx("div",{className:"text-base font-bold truncate",children:"Balco"}),yr&&x&&a.jsx("div",{className:"text-[11px] text-text-muted truncate mt-0.5",children:x})]}),a.jsx("div",{className:"flex flex-col items-end gap-1",children:yr?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(me,{size:"sm",className:"h-8 px-2 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!M,onClick:()=>{if(!M){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}pt(!0)},children:[a.jsx(ns,{className:"h-4 w-4 mr-1"})," Produto"]}),a.jsx(me,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs",onClick:()=>Xt(!0),children:"+ Cliente"})]}),a.jsxs("span",{className:"text-xs text-text-muted whitespace-nowrap",children:["Total: R$ ",En.toFixed(2)]})]}):a.jsx(me,{size:"sm",className:"h-8 px-3 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!M,onClick:()=>{if(!M){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Xt(!0)},children:"Iniciar venda"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-3 thin-scroll min-h-0",children:yr?l.length===0?a.jsxs("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:[a.jsx("div",{children:"Comanda criada para o cliente."}),a.jsxs("div",{children:["Use o boto ",a.jsx("span",{className:"font-semibold",children:"Produto"})," para adicionar itens."]})]}):a.jsx("ul",{className:"space-y-2",children:l.map(re=>a.jsxs("li",{className:"p-2 rounded-md border border-border/40 bg-surface-2",children:[a.jsx("div",{className:"text-sm font-medium truncate",title:re.name,children:re.name}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(me,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async O=>{O.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const X=Number(re.quantity||1)-1;try{X<=0?(await zv({itemId:re.id,codigoEmpresa:T}),c(H=>H.filter(L=>L.id!==re.id))):(await td({itemId:re.id,quantidade:X,codigoEmpresa:T}),c(H=>H.map(L=>L.id===re.id?{...L,quantity:X}:L)))}catch(H){e({title:"Falha ao atualizar item",description:H?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),a.jsx("span",{className:"w-7 text-center text-sm font-semibold",children:re.quantity}),a.jsx(me,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async O=>{O.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const X=Number(re.quantity||1)+1;try{await td({itemId:re.id,quantidade:X,codigoEmpresa:T}),c(H=>H.map(L=>L.id===re.id?{...L,quantity:X}:L))}catch(H){e({title:"Falha ao atualizar item",description:H?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),a.jsxs("span",{className:"text-sm font-semibold whitespace-nowrap",children:["R$ ",(Number(re.quantity)*Number(re.price)).toFixed(2)]})]})]},re.id))}):a.jsx("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:a.jsxs("div",{children:["Para comear, toque em ",a.jsx("span",{className:"font-semibold",children:"Iniciar venda"})," e selecione o cliente."]})})}),a.jsx("div",{className:"p-3 border-t border-border flex gap-2",children:yr?a.jsxs(a.Fragment,{children:[a.jsx(me,{className:"flex-1",variant:"outline",size:"sm",onClick:ha,disabled:A,children:"Cancelar"}),a.jsx(me,{className:"flex-1",size:"sm",disabled:En<=0,onClick:et,children:"Finalizar"})]}):a.jsx(me,{className:"flex-1",size:"sm",variant:"outline",disabled:!M,onClick:()=>{if(!M){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Xt(!0)},children:"Iniciar venda"})})]})}),a.jsx(an,{}),a.jsx(xn,{open:Pt,onOpenChange:re=>{yt(re),re||gt(null)},children:a.jsxs(vn,{className:"sm:max-w-[420px] w-full max-h-[85vh] flex flex-col animate-none",onKeyDown:re=>re.stopPropagation(),onPointerDownOutside:re=>re.stopPropagation(),onInteractOutside:re=>re.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-xl font-bold break-words",title:at?.name||"",children:at?.name||"Produto"}),a.jsx(Dn,{children:"Detalhes do produto e aes rpidas."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),a.jsx("span",{className:"text-sm font-semibold",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(at?.price??at?.salePrice??0))})]}),at?.category?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),a.jsx("span",{className:"text-sm font-medium",children:at.category})]}):null,a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof at?.stock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),a.jsx("div",{className:"text-base font-semibold",children:at.stock})]}),typeof at?.minStock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),a.jsx("div",{className:"text-base font-semibold",children:at.minStock})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),a.jsxs("div",{className:"text-base font-semibold",children:["x",ae.get(at?.id)||0]})]})]})]}),a.jsxs(ra,{className:"flex items-center justify-between gap-2",children:[a.jsxs(me,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{at&&t("/produtos",{state:{productId:at.id,productName:at.name}})},children:[a.jsx(Go,{className:"w-4 h-4"}),a.jsx("span",{children:"Info"})]}),a.jsx(me,{variant:"outline",onClick:()=>{yt(!1),gt(null)},children:"Fechar"}),a.jsx(me,{onClick:async()=>{at&&(await Me(at,{skipClientCheck:!1}),yt(!1),gt(null))},children:"Adicionar"})]})]})}),(f||m||g)&&a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80",children:a.jsxs("div",{className:"px-8 py-6 rounded-xl bg-surface border border-border shadow-2xl flex flex-col items-center gap-4 max-w-sm w-[85vw] text-center",children:[a.jsx("div",{className:"w-8 h-8 rounded-full border-4 border-brand border-t-transparent animate-spin","aria-hidden":"true"}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block text-base font-semibold text-text-primary",children:f?"Abrindo venda...":m?"Cancelando venda...":"Fechando conta..."}),a.jsx("span",{className:"block text-xs text-text-muted",children:f?"Aguarde, estamos iniciando a venda e sincronizando com os dispositivos.":m?"Aguarde, estamos cancelando a venda e limpando os itens.":"Aguarde, estamos registrando o pagamento e encerrando a venda."})]})]})}),a.jsx(xn,{open:rt,onOpenChange:pt,children:a.jsxs(vn,{className:"sm:max-w-xl w-[92vw] max-h-[85vh] flex flex-col overflow-hidden animate-none",onOpenAutoFocus:re=>re.preventDefault(),onKeyDown:re=>re.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-xl font-bold",children:"Adicionar Produtos"}),a.jsx(Dn,{children:"Busque e adicione produtos  comanda do balco."})]}),a.jsx("div",{className:"p-4 pt-0",children:a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar produto...",className:"pl-9",value:We,onChange:re=>Ze(re.target.value)})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4 thin-scroll",children:[a.jsx("ul",{className:"space-y-2",children:(o||[]).filter(re=>{const O=(We||"").toLowerCase();if(!O)return!0;const T=String(re.name||re.descricao||"").toLowerCase(),X=String(re.code||re.codigo||"").toLowerCase();return T.includes(O)||X.includes(O)}).sort((re,O)=>{const T=re.code?parseInt(re.code,10):999999,X=O.code?parseInt(O.code,10):999999;return T-X}).map(re=>{const O=ae.get(re.id)||0,T=Number(re.stock??re.currentStock??0),X=Math.max(0,T-O),H=Number(re.salePrice??re.price??0);return a.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors border border-border/40",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("p",{className:"font-semibold truncate max-w-[200px]",title:`${re.code?`[${re.code}] `:""}${re.name}`,children:[re.code&&a.jsxs("span",{className:"text-text-muted",children:["[",re.code,"]"]})," ",re.name]}),O>0&&a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",O]}),a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",X]})]}),a.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",H.toFixed(2)]})]}),a.jsx(me,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:async()=>{await Me(re)},"aria-label":`Adicionar ${re.name}`,children:a.jsx(ns,{className:"h-4 w-4"})})]},re.id)})}),Array.isArray(o)&&o.length===0&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(Xv,{className:"w-16 h-16 text-text-muted mb-4"}),a.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum produto encontrado."})]})]}),a.jsx(ra,{children:a.jsx(me,{variant:"outline",onClick:()=>pt(!1),children:"Fechar"})})]})}),a.jsxs("div",{ref:be,className:"hidden md:flex gap-0 h-full overflow-hidden relative",children:[a.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${ct}%`},children:[a.jsxs("div",{className:"p-4 border-b border-border space-y-3 cursor-pointer",onClick:re=>{re.target.tagName==="INPUT"||re.target.tagName==="BUTTON"||re.target.closest("button")||Qt.current?.focus()},children:[a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar produto...",className:"pl-9",value:w,onChange:re=>j(re.target.value),onKeyDown:re=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(re.key)&&re.stopPropagation()}})]}),a.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("button",{onClick:()=>ke("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${De==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),a.jsx("button",{onClick:()=>ke("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${De==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),a.jsx("button",{onClick:()=>ke("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${De==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),a.jsx("button",{onClick:()=>ke("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${De==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{Re("code");try{localStorage.setItem("balcao_sort_order","code")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Ge==="code"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por cdigo",children:"Cdigo"}),a.jsx("button",{onClick:()=>{Re("name");try{localStorage.setItem("balcao_sort_order","name")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Ge==="name"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por nome",children:"A-Z"})]})]}),a.jsx("div",{className:"flex items-center gap-4 text-sm text-text-muted cursor-pointer",onClick:()=>Qt.current?.focus(),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("kbd",{className:"px-2 py-1 bg-surface border border-border rounded text-xs font-mono",children:""}),a.jsx("span",{children:"Navegar"})]})})]}),a.jsx("div",{ref:Qt,className:"flex-1 overflow-y-auto p-4 thin-scroll focus:outline-none focus:ring-2 focus:ring-brand/20",tabIndex:0,onClick:()=>Qt.current?.focus(),onKeyDown:re=>{const O=o.filter(H=>{const L=w.trim().toLowerCase(),Fe=!L||(H.name||"").toLowerCase().includes(L)||String(H.code||"").toLowerCase().includes(L);if(De==="all")return Fe;const nt=I.get(H.id)||0,ft=Number(H.stock??H.currentStock??0),Bt=Math.max(0,ft-nt);return De==="available"?Fe&&Bt>0:De==="low"?Fe&&Bt>0&&Bt<=5:De==="out"?Fe&&Bt<=0:Fe}).sort((H,L)=>{if(Ge==="name"){const Fe=(H.name||"").toLowerCase(),nt=(L.name||"").toLowerCase();return Fe.localeCompare(nt)}else{const Fe=H.code?parseInt(H.code,10):999999,nt=L.code?parseInt(L.code,10):999999;return Fe-nt}});if(!["ArrowDown","ArrowUp","Home","End"].includes(re.key))return;re.preventDefault();const T=Rr||0,X=O.length;if(re.key==="ArrowDown"){const H=Math.min(T+1,X-1);Pn(H),requestAnimationFrame(()=>bt.current[H]?.scrollIntoView({block:"nearest"}))}if(re.key==="ArrowUp"){const H=Math.max(T-1,0);Pn(H),requestAnimationFrame(()=>bt.current[H]?.scrollIntoView({block:"nearest"}))}if(re.key==="Home"&&(Pn(0),requestAnimationFrame(()=>bt.current[0]?.scrollIntoView({block:"nearest"}))),re.key==="End"){const H=Math.max(0,X-1);Pn(H),requestAnimationFrame(()=>bt.current[H]?.scrollIntoView({block:"nearest"}))}},children:(o||[]).length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12",children:[a.jsx(Xv,{className:"w-16 h-16 text-text-muted mb-4"}),a.jsx("p",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto cadastrado"}),a.jsx("p",{className:"text-sm text-text-muted mb-6 text-center",children:"Cadastre produtos para comear a vender"}),a.jsxs(me,{onClick:()=>t("/produtos"),children:[a.jsx(ns,{className:"mr-2 h-4 w-4"}),"Cadastrar Produto"]})]}):a.jsx("ul",{className:"space-y-2",children:o.filter(re=>{const O=w.trim().toLowerCase(),T=!O||(re.name||"").toLowerCase().includes(O)||String(re.code||"").toLowerCase().includes(O);if(De==="all")return T;const X=I.get(re.id)||0,H=Number(re.stock??re.currentStock??0),L=Math.max(0,H-X);return De==="available"?T&&L>0:De==="low"?T&&L>0&&L<=5:De==="out"?T&&L<=0:T}).sort((re,O)=>{if(Ge==="name"){const T=(re.name||"").toLowerCase(),X=(O.name||"").toLowerCase();return T.localeCompare(X)}else{const T=re.code?parseInt(re.code,10):999999,X=O.code?parseInt(O.code,10):999999;return T-X}}).map((re,O)=>{const T=ae.get(re.id)||0,X=I.get(re.id)||0,H=Number(re.stock??re.currentStock??0),L=Math.max(0,H-X),Fe=Number(re.salePrice??re.price??0),nt=O===Rr;return a.jsx(Se.Fragment,{children:a.jsxs("li",{ref:ft=>{bt.current[O]=ft},className:`flex items-center gap-3 p-2 rounded-md transition-colors border-2 ${nt?"border-brand bg-brand/5":"border-transparent hover:bg-surface-2"} ${L===0&&T===0?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{Pn(O),Qt.current?.focus()},children:[a.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:ft=>{ft.stopPropagation(),gt({...re,qty:T,remaining:L,price:Fe}),yt(!0)},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsxs("p",{className:"font-semibold truncate",title:`${re.code?`[${re.code}] `:""}${re.name}`,children:[re.code&&a.jsxs("span",{className:"text-text-muted",children:["[",re.code,"]"]})," ",re.name]}),T>0&&a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",T]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Fe.toFixed(2)]}),a.jsxs("span",{className:`text-xs font-medium whitespace-nowrap ${L<=0?"text-destructive":L<=5?"text-warning":"text-text-secondary"}`,children:["Estoque: ",L]})]})]}),a.jsx(me,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:ft=>{ft.stopPropagation(),Me(re)},disabled:L===0,"aria-label":`Adicionar ${re.name}`,children:a.jsx(ns,{className:"h-4 w-4"})})]})},re.id)})})})]}),a.jsx("div",{className:"w-2 bg-border hover:bg-brand cursor-col-resize transition-colors flex-shrink-0 mx-2",onMouseDown:()=>kt(!0),title:"Arraste para redimensionar"}),a.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${100-ct}%`},children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2 flex-wrap",children:[a.jsxs("div",{className:"min-w-0 flex-shrink",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"text-base font-bold whitespace-nowrap",children:"Balco"}),x?a.jsx("span",{className:"truncate text-[11px] px-2 py-0.5 rounded-full border border-border bg-surface-2 text-text-secondary",children:x}):null]})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap",children:[a.jsxs(me,{size:"sm",className:"md:hidden h-8 px-2 text-xs whitespace-nowrap bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!M,onClick:()=>{if(!M){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}pt(!0)},title:"Adicionar produto",children:[a.jsx(ns,{className:"h-4 w-4 mr-1"}),"Produto"]}),yr&&a.jsx(me,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs whitespace-nowrap",disabled:!M,onClick:()=>{if(!M){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar clientes.",variant:"warning"});return}Xt(!0)},children:"+ Cliente"}),yr?a.jsxs(Qd,{children:[a.jsx(Ip,{asChild:!0,children:a.jsx(me,{size:"sm",className:"h-8 px-2 text-xs whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",disabled:A,children:A?"Cancelando...":"Cancelar"})}),a.jsxs(ad,{className:"sm:max-w-[420px] animate-none",onKeyDown:re=>re.stopPropagation(),children:[a.jsxs(sd,{children:[a.jsx(id,{children:"Cancelar venda do balco?"}),a.jsx(ld,{children:"Os itens sero descartados e a venda ser limpa. Esta ao no pode ser desfeita."})]}),a.jsxs(od,{children:[a.jsx(cd,{children:"Voltar"}),a.jsx(Zd,{onClick:ha,children:"Confirmar Cancelamento"})]})]})]}):a.jsx(me,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs opacity-60 cursor-not-allowed whitespace-nowrap",disabled:!0,children:"Cancelar"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:yr?l.length===0?a.jsx("div",{className:"text-center text-text-muted pt-16",children:'Comanda vazia. Use o boto "+" para adicionar produtos.'}):a.jsx("ul",{className:"space-y-3 pr-1",children:l.map(re=>a.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface hover:bg-surface-2 transition-colors",children:[a.jsx("div",{className:"min-w-0 flex-1",children:a.jsx("div",{className:"font-medium truncate",title:re.name,children:re.name})}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(me,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async O=>{O.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const X=Number(re.quantity||1)-1;try{X<=0?(await zv({itemId:re.id,codigoEmpresa:T}),c(H=>H.filter(L=>L.id!==re.id))):(await td({itemId:re.id,quantidade:X,codigoEmpresa:T}),c(H=>H.map(L=>L.id===re.id?{...L,quantity:X}:L)));try{const H=await Lm({codigoEmpresa:T}),L=new Map;for(const Fe of H||[]){const nt=Fe.produto_id,ft=Number(Fe.quantidade||0);L.set(nt,(L.get(nt)||0)+ft)}R(L)}catch(H){console.error("[BalcaoPage:removeItem] Erro ao atualizar estoque reservado:",H)}}catch(H){const L=String(H?.message||"").toLowerCase();H?.code==="INSUFFICIENT_STOCK"||L.includes("insuficiente")?e({title:"Estoque insuficiente",description:H?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:H?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),a.jsx("span",{className:"w-7 text-center font-semibold",children:re.quantity}),a.jsx(me,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async O=>{O.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const X=Number(re.quantity||1)+1;try{await td({itemId:re.id,quantidade:X,codigoEmpresa:T}),c(H=>H.map(L=>L.id===re.id?{...L,quantity:X}:L))}catch(H){const L=String(H?.message||"").toLowerCase();H?.code==="INSUFFICIENT_STOCK"||L.includes("insuficiente")?e({title:"Estoque insuficiente",description:H?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:H?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"font-semibold whitespace-nowrap",children:["R$ ",(Number(re.quantity)*Number(re.price)).toFixed(2)]}),a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface text-text-secondary border border-border",children:["x",re.quantity]})]})]})]},re.id))}):a.jsxs("div",{className:"text-center pt-12",children:[a.jsx("div",{className:"text-sm text-text-secondary mb-3",children:"Para comear, inicie uma nova venda e selecione o cliente."}),a.jsx(me,{disabled:!M,onClick:()=>{if(!M){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Xt(!0)},children:"Iniciar nova venda"})]})}),a.jsxs("div",{className:"p-4 border-t border-border",children:[a.jsxs("div",{className:"flex justify-between items-center text-lg font-bold mb-3",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",En.toFixed(2)]})]}),a.jsx(me,{size:"lg",className:"w-full",onClick:et,disabled:En<=0,children:"Finalizar Pagamento"})]})]})]}),a.jsx(xn,{open:fe,onOpenChange:Z,children:a.jsxs(vn,{className:"sm:max-w-xl w-[92vw] max-h-[90vh] flex flex-col overflow-hidden animate-none",onKeyDown:re=>re.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-2xl font-bold",children:"Fechar Conta"}),a.jsx(Dn,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",En.toFixed(2)]})]}),a.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1",children:[a.jsx(Le,{className:"block",children:"Pagamentos"}),(()=>null)(),(()=>null)(),(ue||[]).map((re,O)=>{const T=L=>{if(!L)return x||"Cliente";const Fe=String(L),nt=(lt||[]).find(Bt=>String(Bt.id)===Fe);if(nt?.nome)return nt.nome;const ft=(xe||[]).find(Bt=>String(Bt.id)===Fe);return ft?.nome?ft.nome:x||"Cliente"},X=(lt||[]).length>1,H=(lt||[])[0]||null;return(lt||[]).filter(L=>String(L.id)!==String(H?.id||"")),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-start",children:[a.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:ue.length>1&&O>0&&a.jsx(me,{type:"button",variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{Te(L=>{const Fe=L.filter($e=>$e.id!==re.id);if(Fe.length===0)return[];const nt=(l||[]).reduce(($e,Dt)=>$e+Number(Dt.quantity||0)*Number(Dt.price||0),0),ft=Math.floor(nt/Fe.length*100)/100,Bt=nt-ft*Fe.length;return Fe.map(($e,Dt)=>{const Sr=Dt===Fe.length-1?ft+Bt:ft;return Ht($e,Sr)})})},children:a.jsx(el,{className:"h-4 w-4"})})}),O===0?a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:T(H?.id||re.clientId)})}):X?a.jsx("div",{className:"sm:col-span-4",children:a.jsxs(Nn,{value:re.clientId||"",onValueChange:L=>Te(Fe=>Fe.map(nt=>nt.id===re.id?{...nt,clientId:L}:nt)),children:[a.jsx(bn,{className:"w-full truncate",children:a.jsx(Cn,{placeholder:"Cliente"})}),a.jsx(wn,{children:(lt||[]).map(L=>a.jsx(tt,{value:L.id,children:L.nome},L.id))})]})}):a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:T(H?.id||re.clientId)})}),a.jsxs("div",{className:"sm:col-span-4",children:[a.jsxs(Nn,{value:re.methodId||"",onValueChange:L=>Te(Fe=>Fe.map(nt=>{if(nt.id!==re.id)return nt;const ft=zn(L),Bt=Number(ft?.taxa_percentual||0);if(Bt>0){const Dt=$t(nt)*(1+Bt/100);return{...nt,methodId:L,chargeFee:!0,value:mn(Dt)}}else{const $e=$t(nt);return{...nt,methodId:L,chargeFee:!1,value:mn($e)}}})),children:[a.jsx(bn,{className:"w-full h-9 truncate",children:a.jsx(Cn,{placeholder:"Forma de pagamento"})}),a.jsx(wn,{children:(ce||[]).map(L=>a.jsx(tt,{value:L.id,children:L.nome},L.id))})]}),(()=>{const L=ot(re);if(!L)return null;const Fe=Yt(re),nt=!!re.chargeFee;return a.jsx("div",{className:"mt-1",children:a.jsxs("button",{type:"button",onClick:()=>Te(ft=>ft.map(Bt=>{if(Bt.id!==re.id)return Bt;const $e=$t(Bt);if(!nt){const Dt=$e*(1+L/100);return{...Bt,chargeFee:!0,value:mn(Dt)}}return{...Bt,chargeFee:!1,value:mn($e)}})),className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",nt?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:nt?"Desmarcar taxa":"Cobrar taxa",children:[a.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",nt?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),a.jsxs("span",{children:["Taxa R$ ",Fe.toFixed(2)]})]})})})()]}),a.jsx("div",{className:"sm:col-span-3",children:a.jsx(Ye,{placeholder:"0,00",inputMode:"numeric",value:re.value,className:"h-9",onChange:L=>{const Fe=(L.target.value||"").replace(/\D/g,""),nt=Fe?Number(Fe)/100:0,ft=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(nt);Te(Bt=>Bt.map($e=>$e.id===re.id?{...$e,value:ft}:$e))},onKeyDown:L=>{L.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(L.key)&&(/^[0-9]$/.test(L.key)||L.preventDefault())},onBeforeInput:L=>{const Fe=L.data??"";Fe&&/\D/.test(Fe)&&L.preventDefault()}})})]},re.id)}),a.jsx("div",{children:a.jsx(me,{type:"button",variant:"secondary",size:"sm",onClick:()=>{Te(re=>{const T=Array.isArray(Ct)&&Ct.length>0?Ct:(lt||[]).map(Pr=>Pr.id),X=new Set(re.map(Pr=>Pr.clientId).filter(Boolean)),L=(T||[]).filter(Pr=>!X.has(Pr))[0]||T[0]||"",Fe=ce[0]?.id||"",nt=zn(Fe),ft=Number(nt?.taxa_percentual||0)>0,Bt=[...re,{id:ne,clientId:L,methodId:Fe,value:"",chargeFee:ft}],$e=(l||[]).reduce((Pr,vr)=>Pr+Number(vr.quantity||0)*Number(vr.price||0),0),Dt=Math.floor($e/Bt.length*100)/100,Sr=$e-Dt*Bt.length;return Bt.map((Pr,vr)=>{const yn=vr===Bt.length-1?Dt+Sr:Dt;return Ht(Pr,yn)})}),de(re=>re+1)},children:"Adicionar forma"})}),(()=>{const re=Je(),O=Xr(),H=(l||[]).reduce((L,Fe)=>L+Number(Fe.quantity||0)*Number(Fe.price||0),0)+O-re;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[a.jsx("span",{children:"Soma"}),a.jsxs("span",{children:["R$ ",re.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[a.jsx("span",{children:"Taxas"}),a.jsxs("span",{children:["R$ ",O.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[a.jsx("span",{children:"Restante"}),a.jsxs("span",{className:Math.abs(H)<.005?"text-success":"text-warning",children:["R$ ",H.toFixed(2)]})]})]})})()]})]}),a.jsxs(ra,{children:[a.jsx(me,{variant:"outline",onClick:()=>Z(!1),disabled:ie,children:"Cancelar"}),a.jsx(me,{onClick:cr,disabled:ie,children:ie?"Processando...":"Confirmar Pagamento"})]})]})}),a.jsx(xn,{open:pr,onOpenChange:re=>Xt(re),children:a.jsxs(vn,{className:"max-w-lg",onOpenAutoFocus:re=>re.preventDefault(),onKeyDown:re=>re.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-2xl font-bold",children:"Identificar Cliente"}),a.jsx(Dn,{children:"Selecione um cliente cadastrado para esta venda."})]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"w-full",children:[a.jsx(Le,{className:"mb-1 block",children:"Buscar cliente"}),a.jsxs("div",{className:"flex items-center gap-2 justify-between",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:It,onChange:re=>Ut(re.target.value),onKeyDown:re=>re.stopPropagation()})]}),a.jsx(me,{type:"button",size:"icon",title:"Cadastrar cliente",className:"ml-2 bg-brand text-black hover:bg-brand/90 border border-brand",onClick:()=>{window.location.href="/clientes"},children:a.jsx(ns,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"mt-2 max-h-48 overflow-auto border rounded-md thin-scroll",children:a.jsxs("ul",{children:[(xe||[]).map(re=>{const O=(Ct||[]).includes(re.id);return a.jsxs("li",{className:`p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2 ${re?.codigo===0?"bg-warning/10 border-l-4 border-warning":""} ${O?"bg-surface-2":""}`,onClick:()=>{ar(T=>{const X=new Set(T||[]);X.has(re.id)?X.delete(re.id):X.add(re.id);const H=Array.from(X);try{localStorage.setItem(St.pendingClientIds,JSON.stringify(H))}catch{}return H})},children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium",children:[re.codigo!=null?String(re.codigo)+" - ":"",re.nome,re?.codigo===0&&a.jsx("span",{className:"ml-2 text-xs text-warning",children:"(Padro)"})]})}),a.jsx(Do,{size:16,className:O?"text-success":"text-text-muted opacity-40"})]},re.id)}),(!xe||xe.length===0)&&a.jsx("li",{className:"p-2 text-sm text-text-muted",children:"Nenhum cliente encontrado."})]})})]})}),a.jsxs(ra,{children:[a.jsx(me,{variant:"outline",onClick:()=>Xt(!1),children:"Fechar"}),a.jsx(me,{onClick:async()=>{try{const re=Array.from(new Set(Ct||[]));if(re.length===0){e({title:"Selecione pelo menos um cliente",variant:"warning"});return}const O=r?.codigo_empresa;if(n){try{const{data:H,error:L}=await he.from("comandas").select("id").eq("id",n).eq("codigo_empresa",O).single();if(L||!H){console.error("[ClientWizard] Comanda no encontrada:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Reiniciando...",variant:"warning"}),s(null),c([]),lr(!1),b("");try{localStorage.removeItem(St.comandaId),localStorage.removeItem(St.items),localStorage.removeItem(St.customerName),localStorage.removeItem(St.clientChosen)}catch{}Xt(!1);return}}catch(H){console.error("[ClientWizard] Erro ao validar comanda:",H),e({title:"Erro de validao",variant:"destructive"});return}try{await ub({comandaId:n,clienteIds:re,nomesLivres:[],codigoEmpresa:O,replace:!0})}catch(H){if(H?.message?.includes("violates foreign key")){console.error("[ClientWizard] Foreign key error, limpando cache:",H),s(null),c([]);try{localStorage.removeItem(St.comandaId),localStorage.removeItem(St.items)}catch{}e({title:"Comanda invlida",description:"Reinicie a venda.",variant:"destructive"}),Xt(!1);return}if(!H?.message?.includes("duplicate"))throw H}const X=(await ai({comandaId:n,codigoEmpresa:O})||[]).map(H=>H?.nome).filter(Boolean);b(X.length?X.join(", "):""),lr(!0),Xt(!1)}else{if(!O){e({title:"Empresa no definida",variant:"destructive"});return}try{h(!0);const T=await Zj({codigoEmpresa:O});if(!T?.id){e({title:"Falha ao abrir venda",description:"No foi possvel criar a comanda.",variant:"destructive"});return}const X=T.id;await ub({comandaId:X,clienteIds:re,nomesLivres:[],codigoEmpresa:O,replace:!0}),s(X);const H=(xe||[]).filter(Fe=>re.includes(Fe.id)).map(Fe=>Fe?.nome).filter(Boolean),L=H.length?H.join(", "):"";b(L),lr(!0);try{localStorage.setItem(St.comandaId,String(X)),localStorage.setItem(St.customerName,L||""),localStorage.setItem(St.clientChosen,"true"),localStorage.removeItem(St.pendingClientIds)}catch{}try{await Fr(X,2)}catch{}Xt(!1)}catch(T){console.error("[ClientWizard] Erro ao criar comanda de balco:",T),e({title:"Falha ao iniciar venda",description:T?.message||"Tente novamente.",variant:"destructive"});return}finally{h(!1)}}if(P){const T=P;E(null),await Me(T,{skipClientCheck:!0})}}catch(re){e({title:"Falha ao iniciar venda",description:re?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar"})]})]})}),a.jsx(xn,{open:!!Qe,onOpenChange:re=>!re&&ge(null),children:a.jsx(vn,{className:"sm:max-w-[425px]",children:Qe&&a.jsxs(a.Fragment,{children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-lg",children:Qe.name}),a.jsx(Dn,{className:"text-sm",children:"Detalhes do item"})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Preo Unitrio"}),a.jsxs("p",{className:"text-lg font-bold",children:["R$ ",Number(Qe.price).toFixed(2)]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Quantidade"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(me,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async re=>{re.stopPropagation();const O=r?.codigo_empresa;if(!O){e({title:"Empresa no definida",variant:"destructive"});return}const T=Math.max(0,Qe.quantity-1);try{T<=0?(await zv({itemId:Qe.id,codigoEmpresa:O}),ge(null)):(await td({itemId:Qe.id,quantidade:T,codigoEmpresa:O}),ge({...Qe,quantity:T}));const X=await uo({comandaId:n,codigoEmpresa:O});c((X||[]).map(H=>({id:H.id,productId:H.produto_id,name:H.descricao||"Item",price:Number(H.preco_unitario||0),quantity:Number(H.quantidade||1)})))}catch(X){e({title:"Erro ao atualizar quantidade",description:X?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),a.jsx("span",{className:"w-8 text-center font-semibold",children:Qe.quantity}),a.jsx(me,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async re=>{re.stopPropagation();const O=r?.codigo_empresa;if(!O){e({title:"Empresa no definida",variant:"destructive"});return}const T=Qe.quantity+1;try{await td({itemId:Qe.id,quantidade:T,codigoEmpresa:O}),ge({...Qe,quantity:T});const X=await uo({comandaId:n,codigoEmpresa:O});c((X||[]).map(H=>({id:H.id,productId:H.produto_id,name:H.descricao||"Item",price:Number(H.preco_unitario||0),quantity:Number(H.quantidade||1)})))}catch(X){e({title:"Erro ao atualizar quantidade",description:X?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Subtotal"}),a.jsxs("p",{className:"text-lg font-bold",children:["R$ ",(Qe.quantity*Qe.price).toFixed(2)]})]})]}),a.jsx(ra,{children:a.jsx(me,{variant:"destructive",onClick:async()=>{try{const re=r?.codigo_empresa;if(!re){e({title:"Empresa no definida",variant:"destructive"});return}await zv({itemId:Qe.id,codigoEmpresa:re});const O=await uo({comandaId:n,codigoEmpresa:re});c((O||[]).map(T=>({id:T.id,productId:T.produto_id,name:T.descricao||"Item",price:Number(T.preco_unitario||0),quantity:Number(T.quantidade||1)}))),ge(null),e({title:"Item removido",variant:"success"})}catch(re){e({title:"Falha ao remover item",description:re?.message||"Tente novamente",variant:"destructive"})}},children:"Remover Item"})})]})})}),Ne&&a.jsx("div",{className:"fixed left-3 right-3 z-[9999] md:hidden",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:a.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[a.jsx(Ic,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),a.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:Be||"Ateno"})]})})]})}async function Ese({userId:e,scope:t}){if(!e||!t)return null;try{const{data:r,error:n}=await he.from("user_ui_settings").select("settings").eq("user_id",e).eq("scope",t).maybeSingle();return n?(console.error("[user_ui_settings] getUserUISettings:error",n),null):r?.settings||null}catch(r){return console.error("[user_ui_settings] getUserUISettings:exception",r),null}}async function kse({userId:e,scope:t,settings:r}){if(!(!e||!t))try{const n={user_id:e,scope:t,settings:r||{},updated_at:new Date().toISOString()},{error:s}=await he.from("user_ui_settings").upsert(n,{onConflict:"user_id,scope"});s&&console.error("[user_ui_settings] saveUserUISettings:error",s)}catch(n){console.error("[user_ui_settings] saveUserUISettings:exception",n)}}function PS(e){try{const r=new DOMParser().parseFromString(e,"text/xml"),n=r.querySelector("parsererror");if(n)throw new Error("XML invlido: "+n.textContent);const s=Qat(r),o=Zat(r),i=est(r),l=tst(r),c=i.reduce((u,f)=>u+(f.valorTotal||0),0),d={produtos:i,fornecedor:o,pagamentos:l,nfe:{...s,totalNota:c},success:!0};return console.log("[XMLParser] Resultado final:",d),{data:d,success:!0}}catch(t){return console.error("[XMLParser] Erro ao fazer parse do XML:",t),{produtos:[],fornecedor:null,nfe:null,success:!1,error:t.message}}}function Qat(e){const t=e.querySelector("ide");if(!t)return null;let r="";const n=e.querySelector("chNFe");if(n&&(r=n.textContent.trim()),!r){const s=e.querySelector("infNFe");if(s){const o=s.getAttribute("Id");o&&(r=o.replace("NFe",""))}}return{numero:Qn(t,"nNF"),serie:Qn(t,"serie"),dataEmissao:Qn(t,"dhEmi"),chaveAcesso:r,tipo:Qn(t,"tpNF")==="0"?"Entrada":"Sada",naturezaOperacao:Qn(t,"natOp"),modelo:Qn(t,"mod")||null}}function Zat(e){const t=e.querySelector("emit");return t?{cnpj:Qn(t,"CNPJ"),razaoSocial:Qn(t,"xNome"),nomeFantasia:Qn(t,"xFant"),endereco:{logradouro:Qn(t,"xLgr"),numero:Qn(t,"nro"),bairro:Qn(t,"xBairro"),cidade:Qn(t,"xMun"),uf:Qn(t,"UF"),cep:Qn(t,"CEP"),codigoIBGE:Qn(t,"cMun"),fone:Qn(t,"fone")},ie:Qn(t,"IE"),iest:Qn(t,"IEST"),im:Qn(t,"IM"),crt:Qn(t,"CRT")}:null}function est(e){const t=e.querySelectorAll("det"),r=new Map;return t.forEach((n,s)=>{const o=n.querySelector("prod"),i=n.querySelector("imposto");if(!o)return;const l=Qn(o,"cProd"),c=Qn(o,"cEAN"),d=Qn(o,"xProd"),u=parseFloat(Qn(o,"qCom")||"0"),f=c&&c!=="SEM GTIN"?`ean:${c}`:l?`cod:${l}`:`nome:${d.toLowerCase().trim()}`;if(r.has(f)){const h=r.get(f);h.quantidade+=u,h.valorTotal+=parseFloat(Qn(o,"vProd")||"0")}else{const h={codigo:l,ean:c,nome:d,ncm:Qn(o,"NCM"),cest:Qn(o,"CEST"),cfop:Qn(o,"CFOP"),unidade:Qn(o,"uCom"),quantidade:u,valorUnitario:parseFloat(Qn(o,"vUnCom")||"0"),precoVenda:parseFloat(Qn(o,"vUnCom")||"0"),valorTotal:parseFloat(Qn(o,"vProd")||"0"),desconto:parseFloat(Qn(o,"vDesc")||"0"),impostos:nst(i),descricao:d,origem:s+1};r.set(f,h)}}),Array.from(r.values())}function tst(e){const t=e.querySelectorAll("pag"),r=[];return t.forEach(n=>{const s=Qn(n,"tPag"),o=parseFloat(Qn(n,"vPag")||"0");s&&r.push({codigoSefaz:s,valor:o,nome:rst(s)})}),console.log("[XMLParser] Pagamentos extrados:",r),r}function rst(e){return{"01":"Dinheiro","02":"Cheque","03":"Carto de Crdito","04":"Carto de Dbito","05":"Carto da Loja",10:"Vale Alimentao",11:"Vale Refeio",12:"Vale Presente",13:"Vale Combustvel",14:"Duplicata Mercantil",15:"Boleto Bancrio",16:"Depsito Bancrio",17:"PIX Dinmico",18:"Transferncia Bancria",19:"Programa de Fidelidade",20:"PIX Esttico",21:"Crdito em Loja",22:"Pagamento Eletrnico",90:"Sem Pagamento",99:"Outros"}[e]||"Outros"}function nst(e){if(!e)return{};const t={},r=e.querySelector("ICMS");if(r){const i=r.children[0];i&&(t.icms={cst:Qn(i,"CST"),csosn:Qn(i,"CSOSN"),aliquota:parseFloat(Qn(i,"pICMS")||"0"),valor:parseFloat(Qn(i,"vICMS")||"0"),orig:Qn(i,"orig"),fcpAliquota:parseFloat(Qn(i,"pFCP")||"0"),mva:parseFloat(Qn(i,"pMVAST")||"0"),pRedBC:parseFloat(Qn(i,"pRedBC")||"0")})}const n=e.querySelector("PIS");if(n){const i=n.children[0];i&&(t.pis={cst:Qn(i,"CST"),aliquota:parseFloat(Qn(i,"pPIS")||"0"),valor:parseFloat(Qn(i,"vPIS")||"0")})}const s=e.querySelector("COFINS");if(s){const i=s.children[0];i&&(t.cofins={cst:Qn(i,"CST"),aliquota:parseFloat(Qn(i,"pCOFINS")||"0"),valor:parseFloat(Qn(i,"vCOFINS")||"0")})}const o=e.querySelector("IPI");if(o){const i=o.querySelector("IPITrib");i&&(t.ipi={cst:Qn(i,"CST"),aliquota:parseFloat(Qn(i,"pIPI")||"0"),valor:parseFloat(Qn(i,"vIPI")||"0")})}return t}function Qn(e,t){if(!e)return"";const r=e.querySelector(t);return r?r.textContent.trim():""}function ES(e,t){const r=e.unidade?.toUpperCase().trim()||"";if(e.ean&&e.ean!=="SEM GTIN"){const s=t.find(i=>{const l=i.unit?.toUpperCase().trim()||"";return i.barcode===e.ean&&l===r});if(s)return s;const o=t.find(i=>i.barcode===e.ean);o&&console.log("[xmlParser] EAN igual mas unidade diferente (no considerar o mesmo produto):",{ean:e.ean,unidadeXML:r,unidadeSistema:(o.unit||"").toUpperCase()})}if(e.codigo){const s=t.find(i=>{const l=i.unit?.toUpperCase().trim()||"";return i.code===e.codigo&&l===r});if(s)return s;const o=t.find(i=>i.code===e.codigo);o&&console.log("[xmlParser] Cdigo igual mas unidade diferente (no considerar o mesmo produto):",{codigo:e.codigo,unidadeXML:r,unidadeSistema:(o.unit||"").toUpperCase()})}const n=e.nome?.toLowerCase().trim()||"";if(n){const s=t.find(o=>{const i=o.name?.toLowerCase().trim()||"",l=o.unit?.toUpperCase().trim()||"",c=i===n,d=l===r,u=c&&d;return c&&!d&&(console.log("[xmlParser] Nome igual mas UNIDADE diferente - NO  o mesmo produto:"),console.log("  Nome XML:",n,"| Unidade XML:",r),console.log("  Nome Sistema:",i,"| Unidade Sistema:",l)),u&&(console.log("[xmlParser] MATCH ENCONTRADO (nome + unidade):"),console.log("  XML:",n,"| Unidade:",r),console.log("  Sistema:",i,"| Unidade:",l),console.log("  Produto:",o)),u});if(s)return console.log("[xmlParser] Produto existente encontrado por nome + unidade:",s.name,s.unit),s}return console.log("[xmlParser] Nenhum produto encontrado para:",n,"| Unidade:",r),null}function JT(e,t){const r=e.valorUnitario||0,n=30,s=r>0?r/(1-n/100):0;return{code:e.codigo||"",name:e.nome||"",barcode:e.ean&&e.ean!=="SEM GTIN"?e.ean:"",ncm:e.ncm||"",cest:e.cest||"",unit:e.unidade||"UN",costPrice:r,salePrice:s,price:s,stock:0,minStock:0,status:"active",active:!0,type:"Venda",category:"Importados",cfopInterno:e.cfop||"",cstIcmsInterno:e.impostos?.icms?.cst||"",csosnInterno:e.impostos?.icms?.csosn||"",aliqIcmsInterno:e.impostos?.icms?.aliquota||0,fcpPercent:e.impostos?.icms?.fcpAliquota||0,mvaPercent:e.impostos?.icms?.mva||0,baseReduzidaPercent:e.impostos?.icms?.pRedBC||0,cstPisEntrada:e.impostos?.pis?.cst||"",aliqPisPercent:e.impostos?.pis?.aliquota||0,aliqCofinsPercent:e.impostos?.cofins?.aliquota||0,cstIpi:e.impostos?.ipi?.cst||"",aliqIpiPercent:e.impostos?.ipi?.aliquota||0,codigo_empresa:t,importedViaXML:!0,dataImportacao:new Date,xmlChave:e?.xmlChave||null,xmlNumero:e?.xmlNumero||null,xmlSerie:e?.xmlSerie||null,xmlEmissao:e?.xmlEmissao||null}}async function ast(e,t){if(!e||!t)return null;const r=e.replace(/\D/g,"");try{const{data:n,error:s}=await he.from("clientes").select("*").eq("codigo_empresa",t).eq("cnpj",r).eq("flag_fornecedor",!0).maybeSingle();if(s)throw s;return n}catch(n){throw console.error("[Suppliers] Erro ao buscar fornecedor:",n),n}}async function sst(e,t){if(!e||!t)throw new Error("Dados do fornecedor e cdigo da empresa so obrigatrios");const r=e.cnpj?.replace(/\D/g,"")||"";if(!r)throw new Error("CNPJ do fornecedor no encontrado no XML");const n={codigo_empresa:t,tipo_pessoa:"PJ",cnpj:r,nome:e.razaoSocial||"Fornecedor Importado",apelido:e.nomeFantasia||e.razaoSocial,flag_fornecedor:!0,flag_cliente:!1,status:"active",endereco:e.endereco?.logradouro||null,numero:e.endereco?.numero||null,complemento:e.endereco?.complemento||null,bairro:e.endereco?.bairro||null,cidade:e.endereco?.cidade||null,uf:e.endereco?.uf||null,cep:e.endereco?.cep?.replace(/\D/g,"")||null,cidade_ibge:e.endereco?.codigoIBGE||null,telefone:e.endereco?.fone||null,ie:e.ie||null,iest:e.iest||null,im:e.im||null};try{const{data:s,error:o}=await he.from("clientes").insert(n).select().single();if(o)throw o;return console.log("[Suppliers] Fornecedor criado:",s),s}catch(s){throw console.error("[Suppliers] Erro ao criar fornecedor:",s),s}}async function ost(e,t){if(!e?.cnpj)throw new Error("CNPJ do fornecedor no encontrado no XML");try{const r=await ast(e.cnpj,t);if(r){console.log("[Suppliers] Fornecedor encontrado:",r.razao_social||r.nome);const s={},o=e.endereco||{},i=l=>l==null||String(l).trim()===""?null:l;return!i(r.ie)&&i(e.ie)&&(s.ie=e.ie),!i(r.iest)&&i(e.iest)&&(s.iest=e.iest),!i(r.im)&&i(e.im)&&(s.im=e.im),!i(r.endereco)&&i(o.logradouro)&&(s.endereco=o.logradouro),!i(r.numero)&&i(o.numero)&&(s.numero=o.numero),!i(r.complemento)&&i(o.complemento)&&(s.complemento=o.complemento),!i(r.bairro)&&i(o.bairro)&&(s.bairro=o.bairro),!i(r.cidade)&&i(o.cidade)&&(s.cidade=o.cidade),!i(r.uf)&&i(o.uf)&&(s.uf=o.uf),!i(r.cep)&&i(o.cep)&&(s.cep=String(o.cep).replace(/\D/g,"")),!i(r.cidade_ibge)&&i(o.codigoIBGE)&&(s.cidade_ibge=o.codigoIBGE),!i(r.telefone)&&i(o.fone)&&(s.telefone=o.fone),!i(r.nome)&&i(e.razaoSocial)&&(s.nome=e.razaoSocial),!i(r.apelido)&&(i(e.nomeFantasia)||i(e.razaoSocial))&&(s.apelido=e.nomeFantasia||e.razaoSocial),Object.keys(s).length>0?(await he.from("clientes").update(s).eq("id",r.id),console.log("[Suppliers] Fornecedor atualizado com campos faltantes:",s),{...r,...s}):r}return console.log("[Suppliers] Criando novo fornecedor:",e.razaoSocial),await sst(e,t)}catch(r){throw console.error("[Suppliers] Erro ao buscar/criar fornecedor:",r),r}}async function ist(e){if(!e)return[];try{const{data:t,error:r}=await he.from("clientes").select("*").eq("codigo_empresa",e).eq("flag_fornecedor",!0).order("nome",{ascending:!0});if(r)throw r;return t||[]}catch(t){return console.error("[Suppliers] Erro ao listar fornecedores:",t),[]}}async function lst(e,t){if(!e||!t)return null;try{const{data:r,error:n}=await he.from("compras").select("*").eq("codigo_empresa",t).eq("chave_nfe",e).order("ativo",{ascending:!1}).maybeSingle();if(n)throw n;return r}catch(r){throw console.error("[Purchases] Erro ao buscar compra:",r),r}}async function cst(e){const t={codigo_empresa:e.codigoEmpresa,fornecedor_id:e.fornecedorId,chave_nfe:e.chaveNfe,numero_nfe:e.numeroNfe,serie_nfe:e.serieNfe,data_emissao:e.dataEmissao,tipo_operacao:e.tipoOperacao,natureza_operacao:e.naturezaOperacao,valor_produtos:e.valorProdutos,valor_total:e.valorTotal,forma_pagamento:e.formaPagamento||null,status:"processada",observacoes:e.observacoes||null,xml_completo:e.xmlCompleto||null};try{const{data:r,error:n}=await he.from("compras").insert(t).select().single();if(n)throw n;return console.log("[Purchases] Compra criada:",r.numero_nfe,"ID:",r.id),r}catch(r){throw console.error("[Purchases] Erro ao criar compra:",r),r}}async function Ise(e,t){if(!e||!t||t.length===0)throw new Error("ID da compra e itens so obrigatrios");const r=t.map(n=>({compra_id:e,produto_id:n.produtoId||null,codigo_produto_xml:n.codigoProdutoXML||null,nome_produto_xml:n.nomeProdutoXML,ean_xml:n.eanXML||null,ncm_xml:n.ncmXML||null,cfop_xml:n.cfopXML||null,unidade_xml:n.unidadeXML||null,quantidade:n.quantidade,valor_unitario:n.valorUnitario,valor_total:n.valorTotal,valor_desconto:n.valorDesconto||0,valor_frete:n.valorFrete||0,valor_seguro:n.valorSeguro||0,valor_outras_despesas:n.valorOutrasDespesas||0,icms_aliquota:n.icmsAliquota||null,icms_valor:n.icmsValor||null,ipi_aliquota:n.ipiAliquota||null,ipi_valor:n.ipiValor||null,pis_aliquota:n.pisAliquota||null,pis_valor:n.pisValor||null,cofins_aliquota:n.cofinsAliquota||null,cofins_valor:n.cofinsValor||null,vinculado_manualmente:n.vinculadoManualmente||!1,observacoes:n.observacoes||null,selecionado_na_importacao:n.selecionadoNaImportacao||!1}));try{const{data:n,error:s}=await he.from("compras_itens").insert(r).select();if(s)throw s;return console.log("[Purchases] Itens criados:",n.length),n}catch(n){throw console.error("[Purchases] Erro ao criar itens:",n),n}}async function dst(e,t={}){if(!e)return{data:[],count:0};try{const r=t.page&&t.page>0?t.page:1,n=t.pageSize&&t.pageSize>0?t.pageSize:100,s=(r-1)*n,o=s+n-1;let i=he.from("compras").select("*,fornecedor:clientes!compras_fornecedor_id_fkey(id,nome,cnpj)",{count:"exact"}).eq("codigo_empresa",e);t.apenasInativas?i=i.eq("ativo",!1):t.incluirInativas||(i=i.eq("ativo",!0)),t.status&&(i=i.eq("status",t.status)),t.fornecedorId&&(i=i.eq("fornecedor_id",t.fornecedorId)),t.dataInicio&&(i=i.gte("data_emissao",t.dataInicio)),t.dataFim&&(i=i.lte("data_emissao",t.dataFim)),i=i.order("data_emissao",{ascending:!1}).range(s,o);const{data:l,error:c,count:d}=await i;if(c)throw c;return{data:l||[],count:d??0}}catch(r){return console.error("[Purchases] Erro ao listar compras:",r),{data:[],count:0}}}async function Ose(e){try{const{data:t,error:r}=await he.from("compras_itens").select(`
        *,
        produto:produto_id(id, nome, codigo_produto, codigo_barras, data_importacao)
      `).eq("compra_id",e).order("criado_em",{ascending:!0});if(r)throw console.error("[Purchases] Erro ao buscar itens:",r),r;return t}catch(t){throw console.error("[Purchases] Erro ao buscar itens:",t),t}}async function ust(e,t,r){if(!e||!t)throw new Error("ID da compra e motivo so obrigatrios");try{const{data:n,error:s}=await he.from("compras").update({ativo:!1,motivo_inativacao:t,inativado_em:new Date().toISOString(),inativado_por:r}).eq("id",e).select().single();if(s)throw s;return console.log("[Purchases] Compra inativada:",e),n}catch(n){throw console.error("[Purchases] Erro ao inativar compra:",n),n}}async function fst(e){try{console.log("[Purchases] Deletando itens da compra:",e);const{error:t}=await he.from("compras_itens").delete().eq("compra_id",e);if(t)throw console.error("[Purchases] Erro ao deletar itens:",t),t;return console.log("[Purchases] Itens deletados com sucesso"),!0}catch(t){throw console.error("[Purchases] Erro ao deletar itens:",t),t}}async function mst(e,t){try{return console.log("[Purchases] Reprocessando XML da compra:",e),await fst(e),await Ise(e,t),console.log("[Purchases] XML reprocessado com sucesso"),!0}catch(r){throw console.error("[Purchases] Erro ao reprocessar XML:",r),r}}async function hst(e,t){try{console.log("[Purchases] Atualizando compra:",e,t);const{data:r,error:n}=await he.from("compras").update({fornecedor_id:t.fornecedorId,numero_nfe:t.numeroNfe,serie_nfe:t.serieNfe,data_emissao:t.dataEmissao,tipo_operacao:t.tipoOperacao,natureza_operacao:t.naturezaOperacao,valor_produtos:t.valorProdutos,valor_total:t.valorTotal,forma_pagamento:t.formaPagamento,observacoes:t.observacoes,atualizado_em:new Date().toISOString()}).eq("id",e).select().single();if(n)throw console.error("[Purchases] Erro ao atualizar compra:",n),n;return console.log("[Purchases] Compra atualizada:",r),r}catch(r){throw console.error("[Purchases] Erro ao atualizar compra:",r),r}}function Tse({isOpen:e,onClose:t,onSelect:r,currentProduct:n}){const{userProfile:s}=vs(),[o,i]=p.useState([]),[l,c]=p.useState(!0),[d,u]=p.useState(""),[f,h]=p.useState(null);p.useEffect(()=>{e&&s?.codigo_empresa&&m()},[e,s?.codigo_empresa]);const m=async()=>{try{c(!0),console.log("[ProductSelectionModal] Carregando produtos para empresa:",s.codigo_empresa);const x=await hu({codigoEmpresa:s.codigo_empresa,includeInactive:!1,search:""});console.log("[ProductSelectionModal] Produtos carregados:",x?.length||0),console.log("[ProductSelectionModal] Primeiro produto:",x?.[0]),console.log("[ProductSelectionModal] Estrutura do produto:",Object.keys(x?.[0]||{})),i(x||[])}catch(x){console.error("[ProductSelectionModal] Erro ao carregar produtos:",x),i([])}finally{c(!1)}},v=p.useMemo(()=>{if(console.log("[ProductSelectionModal] Filtrando produtos. Total:",o.length,"Busca:",d),!d.trim())return o;const x=d.toLowerCase().trim(),b=o.filter(w=>(w.name||w.nome)?.toLowerCase().includes(x)||(w.code||w.codigo_produto)?.toLowerCase().includes(x)||(w.barcode||w.codigo_barras)?.toLowerCase().includes(x));return console.log("[ProductSelectionModal] Produtos filtrados:",b.length),b},[o,d]),g=()=>{f?(console.log("[ProductSelectionModal] Produto selecionado para vinculao:",f),console.log("[ProductSelectionModal] ID do produto:",f.id),console.log("[ProductSelectionModal] Nome do produto:",f.name),r(f),y()):console.log("[ProductSelectionModal] ERRO: Nenhum produto selecionado")},y=()=>{u(""),h(null),t()};return a.jsx(xn,{open:e,onOpenChange:y,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-3xl max-h-[80vh] overflow-hidden flex flex-col bg-black text-white border border-neutral-700",children:[a.jsxs(pn,{className:"bg-neutral-900 -mx-6 -mt-6 mb-4 px-6 py-4 border-b border-neutral-600",children:[a.jsxs(un,{className:"flex items-center gap-2 text-white",children:[a.jsx(Sd,{className:"h-5 w-5 text-yellow-500"}),"Selecionar Produto para Vinculao"]}),a.jsx(Dn,{className:"text-neutral-300",children:"Busque e selecione um produto cadastrado para vincular ao item do XML"})]}),a.jsx("div",{className:"px-6 pb-4",children:a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400"}),a.jsx(Ye,{placeholder:"Buscar por nome, cdigo do produto ou cdigo de barras...",value:d,onChange:x=>u(x.target.value),className:"pl-10 bg-neutral-900 border-neutral-600 text-white placeholder-neutral-400 focus:border-yellow-500",autoFocus:!0})]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex flex-col px-6",children:l?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500 mb-4"}),a.jsx("p",{className:"text-neutral-400",children:"Carregando produtos..."})]})}):v.length===0?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Sd,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),a.jsx("p",{className:"text-neutral-400",children:d?"Nenhum produto encontrado":"Nenhum produto cadastrado"}),d&&a.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"Tente buscar por nome, cdigo ou cdigo de barras"})]})}):a.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:a.jsx("ul",{className:"space-y-2",children:v.map(x=>{const b=x.code||x.codigo_produto,w=x.name||x.nome||"Produto sem nome",j=x.stock||x.estoque||0,_=Number(x.salePrice||x.preco_venda||0),C=f?.id===x.id;return a.jsxs("li",{className:`flex items-center gap-3 p-3 rounded-lg transition-all cursor-pointer border-2 ${C?"border-yellow-500 bg-yellow-500/10":"border-neutral-600 bg-black hover:border-yellow-400 hover:bg-neutral-900"}`,onClick:()=>h(x),children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex items-center gap-2 mb-1",children:a.jsxs("p",{className:"font-semibold text-white truncate",title:`${b?`[${b}] `:""}${w}`,children:[b&&a.jsxs("span",{className:"text-neutral-400",children:["[",b,"]"]})," ",w]})}),a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("p",{className:"text-sm text-neutral-300",children:["R$ ",_.toFixed(2)]}),a.jsxs("span",{className:"text-xs font-medium text-neutral-400 whitespace-nowrap",children:["Estoque: ",j]})]})]}),C&&a.jsx(Uf,{className:"h-5 w-5 text-yellow-500 flex-shrink-0"})]},x.id)})})})}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-neutral-600 px-6 pb-6",children:[a.jsxs("div",{className:"text-sm text-neutral-400",children:[v.length," produto",v.length!==1?"s":"",d&&` encontrado${v.length!==1?"s":""}`]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(me,{variant:"outline",onClick:y,className:"border-neutral-600 text-neutral-300 hover:bg-neutral-700",children:"Cancelar"}),a.jsxs(me,{onClick:g,disabled:!f,className:"gap-2 bg-yellow-600 hover:bg-yellow-700 text-black",children:[a.jsx(Uf,{className:"h-4 w-4"}),"Vincular Produto"]})]})]})]})})}function Dse({isOpen:e,onClose:t,onConfirm:r,products:n,editedProducts:s,isReprocess:o=!1,allProducts:i=[]}){if(!e||!n)return null;const l=n.filter(d=>d.selected),c=l.reduce((d,u,f)=>{const h=u.originalIndex!==void 0?u.originalIndex:f,m=s[h]||{},v=m.linkedProductId,g=m.updatePrice,y=Number(m.quantity||m.qty||u.xml?.quantidade||0);let x=0;if(m.salePrice!=null?x=Number(m.salePrice):m.margin!=null&&u.xml?.valorUnitario?x=Number(u.xml.valorUnitario)*(1+m.margin/100):u.xml?.precoVenda&&(x=Number(u.xml.precoVenda)),u.isNew&&!v)d.newProducts.push({name:m.name||u.xml?.nome,quantity:y,price:x,total:y*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome});else if(v||u.existing){const b=v&&i.find(P=>P.id===v)||u.existing,w=Number(b?.stock||0),j=Number(b?.preco_venda||b?.salePrice||b?.price||0),_=o?0:y,C=o?w:w+y;d.updatedProducts.push({name:b?.name||m.name||u.xml?.nome,currentStock:w,newStock:C,stockChange:_,currentPrice:j,newPrice:g?x:j,priceChange:g?x-j:0,willUpdatePrice:g,total:y*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome,isLinked:!!v,linkedProductId:v,linkedProductName:v?b?.name:null})}else v&&d.linkedProducts.push({xmlName:u.xml?.nome,linkedName:m.name||u.xml?.nome,quantity:y,total:y*(u.xml?.valorUnitario||0),linkedProductId:v});return d.totalValue+=y*(u.xml?.valorUnitario||0),d.totalItems+=y,d},{newProducts:[],updatedProducts:[],linkedProducts:[],totalValue:0,totalItems:0});return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsx(pn,{children:a.jsxs(un,{className:"flex items-center gap-2",children:[a.jsx(zf,{className:"h-5 w-5 text-warning"}),"Confirmar ",o?"Reprocessamento":"Importao"]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[a.jsx(Sd,{className:"h-4 w-4 text-warning"}),a.jsx("span",{className:"font-medium",children:"Total de Produtos"})]}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:l.length})]}),a.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[a.jsx(Cue,{className:"h-4 w-4 text-warning"}),a.jsx("span",{className:"font-medium",children:"Total de Itens"})]}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:c.totalItems})]}),a.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[a.jsx(Ko,{className:"h-4 w-4 text-warning"}),a.jsx("span",{className:"font-medium",children:"Valor Total"})]}),a.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:["R$ ",c.totalValue.toFixed(2)]})]})]}),!o&&c.newProducts.length>0&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(ns,{className:"h-4 w-4 text-success"}),"Produtos que sero criados (",c.newProducts.length,")"]})}),a.jsx("div",{className:"p-4 space-y-3",children:c.newProducts.map((d,u)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-text-primary",children:d.name}),a.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",d.quantity,"  Preo unit.: R$ ",(d.total/d.quantity).toFixed(2),"  Total: R$ ",d.total.toFixed(2)]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})})]},u))})]}),!o&&c.updatedProducts.length>0&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx($p,{className:"h-4 w-4 text-info"}),"Produtos que sero atualizados (",c.updatedProducts.length,")"]})}),a.jsx("div",{className:"p-4 space-y-3",children:c.updatedProducts.map((d,u)=>a.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[d.isLinked?a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(qH,{className:"h-4 w-4 text-warning"}),a.jsxs("p",{className:"font-medium text-text-primary",children:[d.xmlName,"  ",d.linkedProductName||d.name]})]}):a.jsx("p",{className:"font-medium text-text-primary",children:d.name}),a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[o?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Estoque:"}),a.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),a.jsx("span",{className:"text-text-muted",children:"(sem alterao no reprocesso)"})]}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Estoque:"}),a.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),a.jsx(Vf,{className:"h-3 w-3 text-success"}),a.jsx("span",{className:"font-medium text-success",children:d.newStock}),a.jsxs("span",{className:"text-success",children:["(+",d.stockChange,")"]})]}),d.willUpdatePrice&&d.priceChange!==0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Preo:"}),a.jsxs("span",{className:"font-medium text-text-primary",children:["R$ ",d.currentPrice.toFixed(2)]}),d.priceChange>0?a.jsx(Vf,{className:"h-3 w-3 text-success"}):a.jsx(que,{className:"h-3 w-3 text-destructive"}),a.jsxs("span",{className:`font-medium ${d.priceChange>0?"text-success":"text-destructive"}`,children:["R$ ",d.newPrice.toFixed(2)]}),a.jsxs("span",{className:d.priceChange>0?"text-success":"text-destructive",children:["(",d.priceChange>0?"+":"","R$ ",d.priceChange.toFixed(2),")"]})]})]})]}),a.jsxs("div",{className:"text-right",children:[o?a.jsxs("p",{className:"text-xs text-text-muted",children:["Total NF-e (custo): R$ ",d.total.toFixed(2)]}):a.jsxs("p",{className:"text-xs text-text-muted",children:["Unit.: R$ ",(d.total/d.stockChange).toFixed(2)]}),a.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})]})]})},u))})]}),o&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx($p,{className:"h-4 w-4 text-info"}),"Itens da NF-e que sero reprocessados (",l.length,")"]})}),a.jsx("div",{className:"p-4 space-y-3",children:l.map((d,u)=>{const f=d.originalIndex!==void 0?d.originalIndex:u,h=s[f]||{},m=Number(h.quantity||h.qty||d.xml?.quantidade||0),v=Number(d.xml?.valorUnitario||0),g=m*v;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-text-primary",children:d.xml?.nome}),a.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",m,"  Valor unit.: R$ ",v.toFixed(2),"  Total: R$ ",g.toFixed(2)]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"font-medium text-warning",children:["R$ ",g.toFixed(2)]})})]},u)})})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(zf,{className:"h-5 w-5 text-warning flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-warning mb-2",children:o?"Ateno - Reprocessamento":"Ateno - Importao"}),a.jsxs("ul",{className:"text-sm text-text-muted space-y-1",children:[o?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:" Os itens atuais da compra sero substitudos pelos selecionados"}),a.jsx("li",{children:" As quantidades de estoque sero ajustadas conforme as mudanas"}),a.jsx("li",{children:" Esta ao no pode ser desfeita automaticamente"})]}):a.jsxs(a.Fragment,{children:[a.jsx("li",{children:" Os produtos selecionados sero criados ou atualizados no sistema"}),a.jsx("li",{children:" As quantidades sero adicionadas ao estoque atual"}),a.jsx("li",{children:" Uma nova compra ser registrada no histrico"})]}),a.jsx("li",{children:" Verifique cuidadosamente as informaes antes de confirmar"})]})]})]})})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[a.jsxs("div",{className:"text-sm text-text-muted",children:[l.length," produto",l.length!==1?"s":""," selecionado",l.length!==1?"s":""]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(me,{variant:"outline",onClick:t,children:"Cancelar"}),a.jsxs(me,{onClick:r,className:"gap-2",children:[a.jsx($p,{className:"h-4 w-4"}),"Confirmar ",o?"Reprocessamento":"Importao"]})]})]})]})})}function pst({open:e,onOpenChange:t,products:r,codigoEmpresa:n,onSuccess:s}){const{toast:o}=as(),[i,l]=p.useState("upload"),[c,d]=p.useState(null),[u,f]=p.useState(null),[h,m]=p.useState([]),[v,g]=p.useState(!1),[y,x]=p.useState({created:0,updated:0,errors:0,details:[]}),[b,w]=p.useState({}),[j,_]=p.useState({}),[C,P]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[E,A]=p.useState({isOpen:!1}),F=()=>{const q=u?.nfe?.modelo;return q==="55"?"NF-e":q==="65"?"NFC-e":"NF-e / NFC-e"},D=async q=>{const Y=q.target.files?.[0];if(!Y){console.log("[XMLImport] Nenhum arquivo selecionado");return}if(console.log("[XMLImport] Arquivo selecionado:",Y.name),!Y.name.endsWith(".xml")){o({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}d(Y);try{console.log("[XMLImport] Lendo contedo do arquivo...");const J=await Y.text();console.log("[XMLImport] Arquivo lido, parseando XML...");const fe=PS(J);if(console.log("[XMLImport] XML parseado:",fe),!fe.success){o({title:"Erro ao ler XML",description:fe.error||"XML invlido",variant:"destructive"});return}if(!fe.data?.produtos||fe.data.produtos.length===0){o({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}f(fe.data);let Z=r;try{Z=await hu({search:"",codigoEmpresa:n,includeInactive:!0})||r,console.log("[XMLImport] Produtos carregados para validao:",Z.length),console.log("[XMLImport] Nomes dos produtos:",Z.map(te=>te.name))}catch(ie){console.warn("[XMLImport] No foi possvel carregar lista completa, usando cache:",ie)}const ce=fe.data.produtos.map((ie,te)=>{const ue=ES(ie,Z),Te={...ie};if(ie.impostos){const{icms:ne,pis:de,cofins:lt,ipi:Nt}=ie.impostos;ne&&(Te.icmsAliquota=ne.aliquota??Te.icmsAliquota,Te.icmsValor=ne.valor??Te.icmsValor),Nt&&(Te.ipiAliquota=Nt.aliquota??Te.ipiAliquota,Te.ipiValor=Nt.valor??Te.ipiValor),de&&(Te.pisAliquota=de.aliquota??Te.pisAliquota,Te.pisValor=de.valor??Te.pisValor),lt&&(Te.cofinsAliquota=lt.aliquota??Te.cofinsAliquota,Te.cofinsValor=lt.valor??Te.cofinsValor)}return{xml:Te,existing:ue,isNew:!ue,willCreate:!ue,willUpdate:!!ue,selected:!0,index:te}});m(ce);const le={};ce.forEach((ie,te)=>{ie.xml.precoVenda&&(le[te]={salePrice:Number(ie.xml.precoVenda)})}),console.log("[XMLImport] Pr-populando editedProducts:",le),w(le),console.log("[XMLImport] Preview preparado, mudando para step preview. Total produtos:",ce.length),l("preview")}catch(J){console.error("[XMLImport] Erro ao processar arquivo:",J),o({title:"Erro ao processar XML",description:J.message,variant:"destructive"})}},I=()=>{A({isOpen:!0})},R=async()=>{A({isOpen:!1});let q="";if(c)try{q=await c.text()}catch(Z){console.error("[XMLImport] Erro ao ler XML:",Z),o({title:"Erro ao ler XML",description:"No foi possvel ler o arquivo XML.",variant:"destructive"});return}l("processing"),g(!0);const Y={created:0,updated:0,errors:0,skipped:0,details:[],supplierId:null},J=h.filter(Z=>Z.selected);if(J.length===0){o({title:"Nenhum produto selecionado",description:"Selecione ao menos um produto para importar.",variant:"warning"}),g(!1),l("preview");return}let fe=null;if(u?.fornecedor)try{fe=await ost(u.fornecedor,n),Y.supplierId=fe.id,console.log("[XMLImport] Fornecedor processado:",fe.razao_social,"ID:",fe.id)}catch(Z){console.error("[XMLImport] Erro ao processar fornecedor:",Z),o({title:"Aviso",description:"No foi possvel criar/vincular o fornecedor, mas os produtos sero importados.",variant:"warning"})}console.log("[XMLImport] Processando apenas produtos selecionados:",J.length);for(const Z of J){const ce=b[Z.index]||{},le=ce.name||Z.xml.nome,ie=ce.qty!==void 0?ce.qty:Number(Z.xml.quantidade),te=ce.margin,ue=ce.salePrice,Te=ce.linkedProductId;try{if(Te&&Te!=="force-new"){ie>0&&await ix({productId:Te,delta:ie,codigoEmpresa:n}),Y.updated++,Y.details.push({produto:le,acao:`Vinculado - Estoque atualizado (+${ie})`,status:"success"});continue}if(Z.isNew||Te==="force-new"){const ne=JT(Z.xml,n);if(ce.name&&(ne.name=ce.name),ue!=null)ne.salePrice=ue,ne.price=ue;else if(te!=null&&te>0){const de=ne.costPrice||0;if(de>0){const lt=de*(1+te/100);ne.salePrice=lt,ne.price=lt}}else ne.salePrice!=null&&ne.price==null&&(ne.price=ne.salePrice);ne.stock=ie,ne.initialStock=ie,ne.currentStock=ie,ne.importedViaXML=!0,ne.category="Importados",u?.nfe&&(ne.xmlChave=u.nfe.chaveAcesso||null,ne.xmlNumero=u.nfe.numero||null,ne.xmlSerie=u.nfe.serie||null,ne.xmlEmissao=u.nfe.dataEmissao||null);try{await AS(ne,{codigoEmpresa:n}),Y.created++,Y.details.push({produto:le,acao:"Criado",status:"success"})}catch(de){if(de.message?.includes("duplicate")||de.message?.includes("unique constraint")){console.warn("[XMLImport] Produto j existe, tentando atualizar estoque:",Z.xml.nome);const Nt=(await hu({search:Z.xml.nome,codigoEmpresa:n,includeInactive:!0})).find(at=>{const gt=(at.name||"").toLowerCase().trim()===(Z.xml.nome||"").toLowerCase().trim(),Pt=(at.unit||"").toUpperCase().trim()===(Z.xml.unidade||"").toUpperCase().trim(),yt=(at.barcode||"")===(Z.xml.ean||""),Qe=(at.code||"")===(Z.xml.codigo||""),ge=gt&&Pt||yt&&Pt||Qe&&Pt;return!ge&&(yt||Qe)&&!Pt&&console.log("[XMLImport] Encontrado mesmo EAN/Cdigo porm unidade diferente. NO unir:",{nomeSistema:at.name,unidadeSistema:at.unit,nomeXML:Z.xml.nome,unidadeXML:Z.xml.unidade,ean:Z.xml.ean,codigo:Z.xml.codigo}),ge});if(Nt&&Number(Z.xml.quantidade)>0)await ix({productId:Nt.id,delta:Number(Z.xml.quantidade)||0,codigoEmpresa:n}),Y.updated++,Y.details.push({produto:Z.xml.nome,acao:"J existe - Estoque atualizado",status:"success"});else if(Nt)Y.skipped++,Y.details.push({produto:Z.xml.nome,acao:"Sem quantidade para ajustar",status:"warning"});else try{console.log("[XMLImport] Duplicate report mas no encontrou por nome+unidade/EAN+unidade/cdigo+unidade. Tentando criar novo produto.");const at=JT(Z.xml,n);at.salePrice!=null&&at.price==null&&(at.price=at.salePrice);const gt=Number(Z.xml.quantidade)||0;at.stock=gt,at.initialStock=gt,at.currentStock=gt,await AS(at,{codigoEmpresa:n}),Y.created++,Y.details.push({produto:Z.xml.nome,acao:"Criado aps checagem",status:"success"})}catch(at){console.warn("[XMLImport] Falhou ao criar aps duplicate:",at),Y.skipped++,Y.details.push({produto:Z.xml.nome,acao:"Falha ao criar aps duplicate",status:"warning"})}}else throw de}}else{const ne=Number(Z.xml.quantidade)||0;if(ne>0&&await ix({productId:Z.existing.id,delta:ne,codigoEmpresa:n}),ce.updatePrice===!0){const lt=Number(Z.xml.valorUnitario)||0;if(lt>0)try{const Nt={costPrice:lt};if(ue!=null)Nt.salePrice=ue,Nt.price=ue;else if(te!=null&&te>0){const at=lt*(1+te/100);Nt.salePrice=at,Nt.price=at}await Zw(Z.existing.id,Nt)}catch(Nt){console.warn("[XMLImport] Falha ao atualizar preo do produto existente",Nt)}}try{const lt=Z.existing||{},Nt=Z.xml.impostos||{},at=Nt.icms||{},gt=Nt.pis||{},Pt=Nt.cofins||{},yt=Nt.ipi||{},Qe={},ge=rt=>rt==null||typeof rt=="string"&&rt.trim()==="";ge(lt.ncm)&&Z.xml.ncm&&(Qe.ncm=Z.xml.ncm),ge(lt.cfopInterno)&&Z.xml.cfop&&(Qe.cfopInterno=Z.xml.cfop),ge(lt.cstIcmsInterno)&&at.cst&&(Qe.cstIcmsInterno=at.cst),ge(lt.csosnInterno)&&at.csosn&&(Qe.csosnInterno=at.csosn),ge(lt.cstIpi)&&yt.cst&&(Qe.cstIpi=yt.cst),ge(lt.cstPisEntrada)&&gt.cst&&(Qe.cstPisEntrada=gt.cst),lt.aliqIcmsInterno==null&&Number(at.aliquota||0)>0&&(Qe.aliqIcmsInterno=Number(at.aliquota)),lt.aliqIpiPercent==null&&Number(yt.aliquota||0)>=0&&(Qe.aliqIpiPercent=Number(yt.aliquota)),lt.aliqPisPercent==null&&Number(gt.aliquota||0)>=0&&(Qe.aliqPisPercent=Number(gt.aliquota)),lt.aliqCofinsPercent==null&&Number(Pt.aliquota||0)>=0&&(Qe.aliqCofinsPercent=Number(Pt.aliquota)),lt.fcpPercent==null&&Number(at.fcpAliquota||0)>0&&(Qe.fcpPercent=Number(at.fcpAliquota)),lt.mvaPercent==null&&Number(at.mva||0)>0&&(Qe.mvaPercent=Number(at.mva)),lt.baseReduzidaPercent==null&&Number(at.pRedBC||0)>0&&(Qe.baseReduzidaPercent=Number(at.pRedBC)),Object.keys(Qe).length>0&&(await Zw(Z.existing.id,Qe),console.log("[XMLImport] Produto existente atualizado com fiscais faltantes",{id:Z.existing.id,patch:Qe}))}catch(lt){console.warn("[XMLImport] Falha ao completar fiscais no produto existente",lt)}Y.updated++,Y.details.push({produto:Z.xml.nome,acao:ne>0?`Estoque +${ne} (somado)`:"Verificado",status:"success"})}}catch(ne){console.error("[XMLImport] Erro ao processar produto:",Z.xml.nome,ne),Y.errors++,Y.details.push({produto:Z.xml.nome,acao:"Erro",status:"error",error:ne.message})}}if(u?.nfe?.chaveAcesso&&fe)try{const Z=await lst(u.nfe.chaveAcesso,n);let ce=Z;if(!Z||!Z.ativo){const ie={codigoEmpresa:n,fornecedorId:fe.id,chaveNfe:u.nfe.chaveAcesso,numeroNfe:u.nfe.numero,serieNfe:u.nfe.serie,dataEmissao:u.nfe.dataEmissao,tipoOperacao:u.nfe.tipo||"Entrada",naturezaOperacao:u.nfe.naturezaOperacao,valorProdutos:u.nfe.totalNota||0,valorTotal:u.nfe.totalNota||0,xmlCompleto:q,formaPagamento:u.pagamentos&&u.pagamentos.length>0?u.pagamentos.map(te=>te.nome).join(", "):null};ce=await cst(ie),console.log("[XMLImport] Nova compra registrada:",ce.numero_nfe)}else console.log("[XMLImport] NF-e j existe, adicionando novos itens:",Z.numero_nfe),Y.purchaseAlreadyExists=!0;const le=J.map(ie=>{const te=b[ie.index]||{},ue=te.linkedProductId;let Te=null;return ue&&ue!=="force-new"?Te=ue:ie.existing&&!ue&&(Te=ie.existing.id),{produtoId:Te,codigoProdutoXML:ie.xml.codigo,nomeProdutoXML:ie.xml.nome,eanXML:ie.xml.ean,ncmXML:ie.xml.ncm,cfopXML:ie.xml.cfop,unidadeXML:ie.xml.unidade,quantidade:te.qty!==void 0?te.qty:Number(ie.xml.quantidade),valorUnitario:Number(ie.xml.valorUnitario)||0,valorTotal:Number(ie.xml.valorTotal)||0,valorDesconto:ie.xml.valorDesconto||0,valorFrete:ie.xml.valorFrete||0,valorSeguro:ie.xml.valorSeguro||0,valorOutrasDespesas:ie.xml.valorOutrasDespesas||0,icmsAliquota:ie.xml.icmsAliquota,icmsValor:ie.xml.icmsValor,ipiAliquota:ie.xml.ipiAliquota,ipiValor:ie.xml.ipiValor,pisAliquota:ie.xml.pisAliquota,pisValor:ie.xml.pisValor,cofinsAliquota:ie.xml.cofinsAliquota,cofinsValor:ie.xml.cofinsValor,vinculadoManualmente:!!te.linkedProductId,observacoes:te.observacoes||null,selecionadoNaImportacao:ie.selected}});await Ise(ce.id,le),console.log("[XMLImport] Itens adicionados  compra:",le.length),Y.purchaseId=ce.id}catch(Z){console.error("[XMLImport] Erro ao registrar compra:",Z)}x(Y),g(!1),l("done"),Y.purchaseAlreadyExists?o({title:"NF-e j importada!",description:`Esta NF-e j existe no sistema. ${Y.created} produto(s) criado(s), ${Y.updated} atualizado(s).`,variant:"warning"}):Y.errors===0?o({title:"Importao concluda!",description:`${Y.created} produto(s) criado(s), ${Y.updated} atualizado(s).`,variant:"success"}):o({title:"Importao concluda com erros",description:`${Y.created} criado(s), ${Y.updated} atualizado(s), ${Y.errors} erro(s).`,variant:"warning"}),s&&s()},M=()=>{console.log("[XMLImport] Fechando modal"),l("upload"),d(null),f(null),m([]),w({}),_({}),x({created:0,updated:0,errors:0,details:[]}),t(!1)};Se.useEffect(()=>{e&&console.log("[XMLImport] Modal aberto. Step atual:",i)},[e,i]);const U=()=>{l("upload"),d(null),f(null),m([]),w({}),_({})},z=q=>{m(Y=>Y.map((J,fe)=>fe===q?{...J,selected:!J.selected}:J))},W=()=>{const q=h.every(Y=>Y.selected);m(Y=>Y.map(J=>({...J,selected:!q})))},$=(q,Y,J)=>{w(fe=>({...fe,[q]:{...fe[q],[Y]:J}}))},ee=(q,Y)=>{console.log("[XMLImportModal] handleLinkProduct chamado:",{index:q,productId:Y}),console.log("[XMLImportModal] Estado editedProducts completo antes:",b),console.log("[XMLImportModal] Estado editedProducts[index] antes:",b[q]),w(J=>{console.log("[XMLImportModal] Estado prev no setEditedProducts:",J);const fe={...J,[q]:{...J[q],linkedProductId:Y}};return console.log("[XMLImportModal] Novo estado editedProducts:",fe),fe})},ve=(q,Y)=>!q||!Y?0:q*(1+Y/100),_e=(q,Y,J)=>b[q]?.[Y]??J,K=q=>{_(Y=>({...Y,[q]:!Y[q]}))};return a.jsxs(xn,{open:e,onOpenChange:M,children:[a.jsxs(vn,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] flex flex-col",children:[a.jsxs(pn,{className:"flex-shrink-0",children:[a.jsxs(un,{className:"flex items-center gap-2 text-2xl font-bold",children:[a.jsx("span",{children:"Importar XML de Compra"}),u?.nfe&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:F()})]}),a.jsxs(Dn,{children:[i==="upload"&&"Selecione o arquivo XML da nota fiscal de entrada",i==="preview"&&"Revise os produtos que sero importados",i==="processing"&&"Processando produtos...",i==="done"&&"Importao finalizada"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-2 py-1",children:[i==="upload"&&a.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:a.jsx("div",{className:"w-full max-w-md",children:a.jsxs("label",{htmlFor:"xml-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[a.jsx(m4,{className:"w-12 h-12 mb-4 text-text-muted"}),a.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Arquivo XML de NF-e (Nota Fiscal Eletrnica)"})]}),a.jsx("input",{id:"xml-upload",type:"file",accept:".xml",className:"hidden",onChange:D})]})})}),i==="preview"&&a.jsxs("div",{className:"space-y-4",children:[u?.nfe&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"font-semibold mb-2",children:["Informaes da ",F()]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",a.jsx("span",{className:"font-mono",children:u.nfe.numero})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",a.jsx("span",{className:"font-mono",children:u.nfe.serie})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",a.jsx("span",{children:u.nfe.tipo})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",a.jsx("span",{children:u.fornecedor?.razaoSocial})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-2 min-w-[200px]",children:[a.jsxs("div",{className:"bg-brand/10 rounded-lg p-3 border border-brand/20",children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Valor Total NF-e"}),a.jsxs("p",{className:"text-xl font-bold text-brand",children:["R$ ",Number(u.nfe.totalNota||0).toFixed(2)]})]}),u.pagamentos&&u.pagamentos.length>0&&a.jsxs("div",{className:"bg-success/10 rounded-lg p-2.5 border border-success/20",children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento"}),a.jsx("p",{className:"text-sm font-semibold text-success",children:u.pagamentos.map(q=>q.nome).join(", ")})]})]})]}),u.nfe.chaveAcesso&&a.jsxs("div",{className:"mt-2 pt-2 border-t border-border",children:[a.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),a.jsx("p",{className:"font-mono text-xs break-all",children:u.nfe.chaveAcesso})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-4 px-2",children:[a.jsx(me,{variant:"outline",size:"sm",onClick:W,children:h.every(q=>q.selected)?"Desmarcar Todos":"Selecionar Todos"}),a.jsxs("span",{className:"text-sm text-text-muted",children:[h.filter(q=>q.selected).length," de ",h.length," selecionados"]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3 text-base",children:"Produtos Encontrados"}),a.jsx("div",{className:"space-y-2",children:h.map((q,Y)=>{const J=_e(Y,"linkedProductId",null),fe=_e(Y,"name",q.xml.nome),Z=_e(Y,"quantity",q.xml.quantidade),ce=_e(Y,"margin",q.xml.margem),le=_e(Y,"salePrice",null),ie=q.xml.valorUnitario||0;let te=le;te==null&&!q.isNew&&q.existing&&(te=Number(q.existing.preco_venda||q.existing.salePrice||q.existing.price||0)),te==null&&ce!=null&&(te=ve(ie,ce)),te==null&&q.xml.precoVenda&&(te=Number(q.xml.precoVenda));let ue=null;if(ce!=null)ue=ce;else if(te!=null&&ie>0&&te>0){const ne=(te-ie)/ie*100;ue=Math.max(-999,Math.min(9999,ne))}const Te=j[Y];return a.jsxs("div",{className:gr("rounded-lg border transition-all",q.selected?q.isNew?"bg-success/10 border-success/30":"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[a.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("input",{type:"checkbox",checked:q.selected,onChange:()=>z(Y),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),a.jsx("button",{onClick:()=>K(Y),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:Te?a.jsx(wg,{className:"w-4 h-4 text-text-muted"}):a.jsx(c0,{className:"w-4 h-4 text-text-muted"})}),a.jsx("div",{children:q.isNew?a.jsx(ns,{className:"w-5 h-5 text-success"}):a.jsx($p,{className:"w-5 h-5 text-info"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm truncate",children:fe}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[q.xml.codigo&&a.jsxs("span",{className:"flex-shrink-0",children:["#",q.xml.codigo]}),a.jsxs("span",{children:["Qtd: ",Z]})]})]}),a.jsx("div",{className:"flex-shrink-0 ml-2",children:q.isNew?a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-success/20 text-success font-medium",children:"Novo"}):a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),a.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[a.jsxs("span",{children:["R$ ",Number(ie).toFixed(2),te?`  R$ ${te.toFixed(2)}`:""]}),ue!=null&&a.jsxs("span",{className:"ml-2 "+(ue>0?"text-success":ue<0?"text-destructive":"text-text-muted"),children:[ue.toFixed(1),"%"]})]})]})]}),Te&&a.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),a.jsx("input",{type:"text",value:fe,onChange:ne=>$(Y,"name",ne.target.value),disabled:!q.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{type:"button",onClick:()=>$(Y,"qty",Math.max(0,Z-1)),disabled:!q.selected||Z<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:a.jsx(Iv,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",value:Z,onChange:ne=>{const de=ne.target.value.replace(/\D/g,"");$(Y,"qty",de===""?0:Number(de))},disabled:!q.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),a.jsx("button",{type:"button",onClick:()=>$(Y,"qty",Z+1),disabled:!q.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:a.jsx(ns,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:(()=>{const ne=_e(Y,"margin",null);if(ne!=null)return String(ne);if(!q.isNew&&q.existing&&ie>0){const de=Number(q.existing.preco_venda||q.existing.salePrice||q.existing.price||0);if(de>0)return((de-ie)/ie*100).toFixed(1)}return""})(),onChange:ne=>{const de=ne.target.value;if(de===""){$(Y,"margin",null);return}const lt=de.replace(/[^0-9.,\-]/g,"").replace(",",".");if(lt==="."||lt==="-"||lt==="-.")return;const Nt=parseFloat(lt);if(!isNaN(Nt)&&($(Y,"margin",Nt),ie>0)){const at=ve(ie,Nt);$(Y,"salePrice",at)}},disabled:!q.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),a.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),a.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:a.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",ie.toFixed(2)]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),a.jsx("input",{type:"text",value:(()=>{const ne=_e(Y,"salePrice",te);return ne==null?"":Number(ne).toFixed(2).replace(".",",")})(),onChange:ne=>{const de=ne.target.value.replace(/\D/g,"");if(de===""){$(Y,"salePrice",null);return}const lt=Number(de)/100;if($(Y,"salePrice",lt),lt>0&&ie>0){const Nt=(lt-ie)/ie*100;$(Y,"margin",Math.round(Nt*100)/100)}},disabled:!q.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:q.isNew?"Vincular a Produto Existente (Opcional)":"Ao para este Produto"}),a.jsx("div",{className:"flex gap-2",children:a.jsxs(Nn,{value:J==="force-new"?"force-new":J||(q.isNew?"new":q.existing?.id||"new"),onValueChange:ne=>{ne==="new"||ne===q.existing?.id?ee(Y,null):ne==="search"?P({isOpen:!0,productIndex:Y,currentProduct:q}):ee(Y,ne)},disabled:!q.selected,children:[a.jsx(bn,{className:"flex-1 hover:bg-white/5 transition-colors text-xs sm:text-sm",children:a.jsx(Cn,{placeholder:q.isNew?"Criar novo":"Atualizar existente",children:J&&J!=="force-new"&&J!=="new"?(()=>{const ne=r?.find(de=>de.id===J);return ne?`Vinculado: ${ne.name}`:q.isNew?"Criar novo":"Atualizar existente"})():J==="force-new"?"Criar novo (ignorar)":q.isNew?"Criar novo":"Atualizar existente"})}),a.jsxs(wn,{className:"max-h-[300px] overflow-y-auto text-xs sm:text-sm",children:[q.isNew?a.jsx(tt,{value:"new",children:"Criar novo produto"}):a.jsxs(tt,{value:q.existing?.id||"new",children:["Atualizar: ",q.existing?.name," (Estoque: ",q.existing?.stock||0,")"]}),!q.isNew&&a.jsx(tt,{value:"force-new",children:"Criar novo (ignorar existente)"}),a.jsx(tt,{value:"search",children:"Buscar produto para vincular"})]})]})})]}),!q.isNew&&a.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:_e(Y,"updatePrice",!1),onChange:ne=>$(Y,"updatePrice",ne.target.checked),disabled:!q.selected,className:"w-4 h-4 rounded border-border bg-surface text-brand focus:ring-2 focus:ring-brand/50 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:"text-text-secondary",children:"Atualizar preo de custo e venda deste produto"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[q.xml.codigo&&a.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Cdigo: ",q.xml.codigo]}),q.xml.ean&&q.xml.ean!=="SEM GTIN"&&a.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["EAN: ",q.xml.ean]}),a.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Unidade: ",q.xml.unidade]})]})]})]},Y)})})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-success"}),a.jsxs("span",{children:[h.filter(q=>q.isNew&&q.selected).length," novos"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-info"}),a.jsxs("span",{children:[h.filter(q=>!q.isNew&&q.selected).length," existentes"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-warning"}),a.jsxs("span",{children:[h.filter(q=>b[q.index]?.linkedProductId).length," vinculados"]})]})]})]}),i==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(md,{className:"w-12 h-12 animate-spin text-warning mb-4"}),a.jsx("p",{className:"text-lg font-semibold",children:"Processando produtos..."}),a.jsx("p",{className:"text-sm text-text-muted",children:"Aguarde enquanto importamos os produtos"})]}),i==="done"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:[a.jsx(Do,{className:"w-16 h-16 text-success mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Importao Concluda!"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-success",children:y.created}),a.jsx("p",{className:"text-sm text-text-muted",children:"Criados"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-info",children:y.updated}),a.jsx("p",{className:"text-sm text-text-muted",children:"Atualizados"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-danger",children:y.errors}),a.jsx("p",{className:"text-sm text-text-muted",children:"Erros"})]})]})]}),y.details.length>0&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Detalhes"}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:y.details.map((q,Y)=>a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[q.status==="success"?a.jsx(Do,{className:"w-4 h-4 text-success flex-shrink-0"}):a.jsx(Ic,{className:"w-4 h-4 text-danger flex-shrink-0"}),a.jsx("span",{className:"flex-1 truncate",children:q.produto}),a.jsx("span",{className:gr("text-xs px-2 py-1 rounded",q.status==="success"?"bg-success/20 text-success":"bg-danger/20 text-danger"),children:q.acao})]},Y))})]})]})]}),a.jsxs(ra,{children:[i==="upload"&&a.jsx(me,{variant:"outline",onClick:M,children:"Cancelar"}),i==="preview"&&a.jsxs(a.Fragment,{children:[a.jsx(me,{variant:"outline",onClick:U,children:"Voltar"}),a.jsxs(me,{onClick:I,disabled:h.filter(q=>q.selected).length===0,children:["Confirmar Importao (",h.filter(q=>q.selected).length," de ",h.length," produtos)"]})]}),i==="done"&&a.jsx(me,{onClick:M,children:"Fechar"})]})]}),a.jsx(Tse,{isOpen:C.isOpen,onClose:()=>P({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:q=>{console.log("[XMLImportModal] onSelect chamado com produto:",q),console.log("[XMLImportModal] Index do produto:",C.productIndex),ee(C.productIndex,q.id),P({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:C.currentProduct}),a.jsx(Dse,{isOpen:E.isOpen,onClose:()=>A({isOpen:!1}),onConfirm:R,products:h.map((q,Y)=>({...q,originalIndex:Y})),editedProducts:b,allProducts:r,isReprocess:!1})]})}const gst=[],vst=[],xst={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},QT={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},TU="produtosPage:settings";function yst(e){const t=["Cdigo","Produto","Categoria","Tipo","Unidade","Preo Custo","Preo Venda","% Lucro","Estoque","Estoque Mn.","Validade","Status","Ativo","EAN-13","EAN-13 Caixa","Referncia","Marca","Grupo","NCM","Descrio NCM","CEST","Usar CSOSN","CFOP Interno","CST ICMS Interno","CSOSN Interno","Aliq ICMS Interno (%)","CFOP Externo","CST ICMS Externo","CSOSN Externo","Aliq ICMS Externo (%)","CST PIS Entrada","CST PIS Sada","Aliq PIS (%)","Aliq COFINS (%)","CST IPI","Aliq IPI (%)","FCP (%)","MVA (%)","Base Reduzida (%)"],r=";",n=g=>{const y=Number(g??0);return Number.isFinite(y)?y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):"0,00"},s=g=>`R$ ${n(g)}`,o=g=>{const y=Number(g??0);return Number.isFinite(y)?y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},i=g=>{if(!g)return"";try{if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g)){const[x,b,w]=g.split("-");return`${w}/${b}/${x}`}const y=new Date(g);if(!isNaN(y)){const x=String(y.getDate()).padStart(2,"0"),b=String(y.getMonth()+1).padStart(2,"0"),w=y.getFullYear();return`${x}/${b}/${w}`}}catch{}return String(g)},l=g=>g==="active"?"Ativo":g==="low_stock"?"Estoque Baixo":g==="inactive"?"Inativo":"",c=g=>g?"Sim":"No",d=g=>g??"",u=g=>{const y=g==null?"":String(g);return/[";\n]/.test(y)?`"${y.replace(/"/g,'""')}"`:y},f=[];f.push("\uFEFF"+t.join(r));for(const g of e){const y=[d(g.code),d(g.name),d(g.category),d(g.type),d(g.unit),s(g.costPrice),s(g.price??g.salePrice),o(g.marginPercent),Number(g.stock??0),Number(g.minStock??0),i(g.validade),l(g.status),c(g.active!==!1),d(g.barcode),d(g.barcodeBox),d(g.reference),d(g.brand),d(g.group),d(g.ncm),d(g.ncmDescription),d(g.cest),g.useCsosn?"Sim":"",d(g.cfopInterno),d(g.cstIcmsInterno),d(g.csosnInterno),o(g.aliqIcmsInterno),d(g.cfopExterno),d(g.cstIcmsExterno),d(g.csosnExterno),o(g.aliqIcmsExterno),d(g.cstPisEntrada),d(g.cstPisSaida),o(g.aliqPisPercent),o(g.aliqCofinsPercent),d(g.cstIpi),o(g.aliqIpiPercent),o(g.fcpPercent),o(g.mvaPercent),o(g.baseReduzidaPercent)].map(u).join(r);f.push(y)}const h=new Blob([f.join(`
`)],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(h),v=document.createElement("a");v.href=m,v.download="produtos.csv",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(m)}function xc(e,{action:t}={}){const r=String(e?.message||e||"").toLowerCase();if(r.includes("categoria possui produtos ativos vinculados"))return{title:"No  possvel remover",description:"Existem produtos ativos vinculados a esta categoria. Inative ou recategoriz-os antes."};if(r.includes("categoria no encontrada"))return{title:"Categoria no encontrada",description:"No foi possvel localizar a categoria para desativao."};if(r.includes("duplicate key")&&r.includes("ux_produtos_empresa_codigo_produto"))return{title:"Cdigo j cadastrado",description:"J existe um produto com este cdigo na sua empresa. Informe outro cdigo."};if(r.includes("duplicate key")&&r.includes("unique constraint"))return{title:"Registro j existe",description:"J existe um registro com estes dados."};if(r.includes("permission denied")||r.includes("violates row-level security")||r.includes("rls"))return{title:"Sem permisso",description:"Voc no tem permisso para executar esta ao."};const n=r.match(/null value in column "([^"]+)" violates not-null constraint/);return n?{title:"Campo obrigatrio",description:`Preencha o campo "${n[1].replace(/_/g," ")}".`}:r.includes("invalid input syntax")||r.includes("invalid input value")?{title:"Valor invlido",description:"Revise os valores informados (formato invlido)."}:r.includes("violates check constraint")?{title:"Valor invlido",description:"Os dados informados no atendem s regras do sistema."}:r.includes("violates foreign key constraint")?r.includes("update or delete on table")?{title:"No  possvel excluir",description:"Existem registros vinculados que impedem a excluso."}:{title:"Relao invlida",description:"O registro relacionado no foi encontrado ou  invlido."}:r.includes("failed to fetch")||r.includes("networkerror")||r.includes("network error")?{title:"Falha de conexo",description:"Verifique sua internet e tente novamente."}:r.includes("timeout")?{title:"Tempo esgotado",description:"A operao demorou demais. Tente novamente."}:r.includes("rate limit")||r.includes("too many requests")||r.includes("status code 429")?{title:"Muitas solicitaes",description:"Aguarde alguns segundos e tente novamente."}:t==="save"?{title:"Falha ao salvar",description:"No foi possvel salvar o produto. Tente novamente."}:t==="delete"?{title:"Falha ao inativar",description:"No foi possvel inativar o produto."}:t==="fetch"?{title:"Erro ao carregar",description:"No foi possvel atualizar a lista de produtos."}:t==="export"?{title:"Falha ao exportar",description:"No foi possvel gerar o arquivo."}:{title:"Erro",description:e?.message||"Ocorreu um erro."}}const GE=({icon:e,title:t,value:r,subtitle:n,color:s,onClick:o,isActive:i})=>{const l=e;return a.jsxs(jr.div,{variants:QT,className:gr("bg-surface rounded-2xl border-2 p-3 sm:p-4 flex flex-col justify-between gap-2 cursor-pointer transition-all duration-300",i?`${s}/30 border-${s}`:"border-border hover:border-border-hover"),onClick:o,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 min-w-0",children:[a.jsx("p",{className:"text-text-secondary text-xs sm:text-sm font-semibold leading-snug whitespace-nowrap overflow-hidden text-ellipsis",children:t}),a.jsx(l,{className:gr("w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",s)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold text-text-primary leading-tight whitespace-nowrap overflow-hidden text-ellipsis",children:r}),a.jsx("p",{className:"hidden sm:block text-xs text-text-muted",children:n})]})]})};function bst({open:e,onOpenChange:t,product:r,onSave:n,categories:s,onCreateCategory:o,suggestedCode:i,onRefreshProducts:l,products:c}){const{toast:d}=as(),{userProfile:u}=vs(),[f,h]=p.useState("dados"),[m,v]=p.useState(r?.code||""),[g,y]=p.useState(r?.name||""),[x,b]=p.useState(r?.category||""),[w,j]=p.useState(r?.type||"Venda"),[_,C]=p.useState(r?.unit||"UN"),[P,E]=p.useState(r?.active??!0),[A,F]=p.useState(r?.barcode||""),[D,I]=p.useState(r?.barcodeBox||""),[R,M]=p.useState(r?.reference||""),[U,z]=p.useState(r?.brand||""),[W,$]=p.useState(r?.group||""),[ee,ve]=p.useState(!!r?.allowSale),[_e,K]=p.useState(!!r?.payCommission),[q,Y]=p.useState(!!r?.variablePrice),[J,fe]=p.useState(!!r?.composition),[Z,ce]=p.useState(!!r?.service),[le,ie]=p.useState(!!r?.hasGrid),[te,ue]=p.useState(!!r?.usePriceTable),[Te,ne]=p.useState(!!r?.fuel),[de,lt]=p.useState(!!r?.useImei),[Nt,at]=p.useState(!!r?.stockByGrid),[gt,Pt]=p.useState(!!r?.showInApp),[yt,Qe]=p.useState(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[ge,rt]=p.useState(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[pt,We]=p.useState(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),[Ze,Ne]=p.useState(r?.stock?String(r.stock):""),[ye,Be]=p.useState(r?.minStock?String(r.minStock):""),[mt,Ft]=p.useState(r?.status||"active"),[fr,It]=p.useState(r?.validade||null),[Ut,xe]=p.useState(!1),[st,Ct]=p.useState(!1),[ar,pr]=p.useState(""),[Xt,yr]=p.useState(!0),[lr,Rr]=p.useState(!!(r?.csosnInterno||r?.csosnExterno)),[Pn,De]=p.useState(r?.cfopInterno||""),[ke,Ge]=p.useState(r?.cstIcmsInterno||""),[Re,bt]=p.useState(r?.csosnInterno||""),[Qt,ct]=p.useState(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),[xt,it]=p.useState(r?.cfopExterno||""),[kt,be]=p.useState(r?.cstIcmsExterno||""),[dt,Lt]=p.useState(r?.csosnExterno||""),[mr,tr]=p.useState(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),[Or,Lr]=p.useState(r?.cstPisEntrada||""),[sr,fn]=p.useState(r?.cstPisSaida||""),[Tn,mn]=p.useState(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),[zn,ot]=p.useState(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),[$t,Yt]=p.useState(r?.cstIpi||""),[Ht,Ot]=p.useState(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),[Xr,Je]=p.useState(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),[cr,vt]=p.useState(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),[Tt,Dr]=p.useState(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),[an,Nr]=p.useState(r?.ncm||""),[St,Fr]=p.useState(r?.ncmDescription||""),[zr,ha]=p.useState(r?.cest||""),[En,ae]=p.useState(!1),[Me,et]=p.useState(!1),re=$e=>{const Dt=String($e||"").replace(/\D/g,"");return(Dt?Number(Dt)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},O=$e=>{if(!$e)return 0;const Dt=String($e).replace(/\./g,"").replace(",","."),Sr=Number(Dt);return Number.isFinite(Sr)?Sr:0},T=$e=>{const Dt=String($e||"").replace(/[^\d,]/g,"");return Dt?`% ${Dt}`:""},X=$e=>{if($e==null||$e==="")return 0;const Dt=String($e).replace(/\./g,"").replace(",","."),Sr=Number(Dt);return Number.isFinite(Sr)?Sr:0},H=$e=>String($e||"").replace(/\D/g,"").slice(0,13),L=$e=>String($e||"").replace(/\D/g,"").slice(0,4),Fe=$e=>String($e||"").replace(/\D/g,"").slice(0,8),nt=$e=>String($e||"").replace(/\D/g,"").slice(0,7);p.useEffect(()=>{v(r?.code||""),y(r?.name||""),b(r?.category||""),j(r?.type||"Venda"),C(r?.unit||"UN"),E(r?.active??!0),F(r?.barcode||""),I(r?.barcodeBox||""),M(r?.reference||""),z(r?.brand||""),$(r?.group||""),ve(!!r?.allowSale),K(!!r?.payCommission),Y(!!r?.variablePrice),fe(!!r?.composition),ce(!!r?.service),ie(!!r?.hasGrid),ue(!!r?.usePriceTable),ne(!!r?.fuel),lt(!!r?.useImei),at(!!r?.stockByGrid),Pt(!!r?.showInApp),Qe(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),rt(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),We(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),Ne(r?.stock?String(r.stock):""),Be(r?.minStock?String(r.minStock):""),Ft(r?.status||"active"),It(r?.validade||null),Rr(!!(r?.csosnInterno||r?.csosnExterno)),De(r?.cfopInterno||""),Ge(r?.cstIcmsInterno||""),bt(r?.csosnInterno||""),ct(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),it(r?.cfopExterno||""),be(r?.cstIcmsExterno||""),Lt(r?.csosnExterno||""),tr(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),Lr(r?.cstPisEntrada||""),fn(r?.cstPisSaida||""),mn(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),ot(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),Yt(r?.cstIpi||""),Ot(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),Je(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),vt(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),Dr(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),Nr(r?.ncm||""),Fr(r?.ncmDescription||""),ha(r?.cest||""),yr(!0),!r&&i&&!m&&v(i),ae(!1),et(!1)},[r,e]);const ft=p.useRef("salePrice");p.useEffect(()=>{if(ft.current==="salePrice"){const $e=O(yt),Dt=O(ge);if(Dt>0){const Sr=(Dt-$e)/Dt*100;We(Sr.toFixed(2).replace(".",","))}else We("")}},[yt,ge]),p.useEffect(()=>{if(ft.current==="marginPercent"){const $e=setTimeout(()=>{const Dt=O(yt),Sr=X(pt);if(console.log("[Margem] Custo:",Dt,"Margem:",Sr),Dt>0&&Sr>0)if(Sr>=100){const Pr=Dt*(1+Sr/100);console.log("[Margem] Preo calculado (markup):",Pr),rt(Pr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const Pr=Dt/(1-Sr/100);console.log("[Margem] Preo calculado (margem):",Pr),rt(Pr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}},500);return()=>clearTimeout($e)}},[pt,yt]);const Bt=async $e=>{if($e.preventDefault(),Ut)return;const Dt=[];if(g?.trim()||Dt.push("Descrio"),_?.trim()||Dt.push("Unidade"),w||Dt.push("Tipo de Produto"),O(ge)<=0&&Dt.push("Preo de Venda"),Dt.length){d({title:"Preencha os campos obrigatrios",description:Dt.join(", "),variant:"destructive"});return}console.log("[ProdutosPage] handleSave - Estado active antes de salvar:",P);let Sr=mt;P?mt==="inactive"&&P&&(Sr="active"):Sr="inactive",console.log("[ProdutosPage] handleSave - Status ajustado:",Sr);const Pr={id:r?.id,code:m?.trim()||"",name:g,category:x,type:w,stock:Number(Ze||0),minStock:Number(ye||0),status:Sr,validade:fr,unit:_,active:P,barcode:H(A),barcodeBox:H(D),reference:R?.trim()||null,brand:U?.trim()||null,group:W?.trim()||null,cost:O(yt),price:O(ge),buyPrice:null,costsPercent:null,costPrice:O(yt),salePrice:O(ge),marginPercent:X(pt),allowSale:ee,payCommission:_e,variablePrice:q,composition:J,service:Z,hasGrid:le,usePriceTable:te,fuel:Te,useImei:de,stockByGrid:Nt,showInApp:gt,cfopInterno:L(Pn)||null,cstIcmsInterno:lr?null:ke||null,csosnInterno:lr&&Re||null,aliqIcmsInterno:X(Qt),cfopExterno:L(xt)||null,cstIcmsExterno:lr?null:kt||null,csosnExterno:lr&&dt||null,aliqIcmsExterno:X(mr),cstPisEntrada:Or||null,cstPisSaida:sr||null,aliqPisPercent:X(Tn),aliqCofinsPercent:X(zn),cstIpi:$t||null,aliqIpiPercent:X(Ht),fcpPercent:X(Xr),mvaPercent:X(cr),baseReduzidaPercent:X(Tt),ncm:Fe(an)||null,ncmDescription:St||null,cest:nt(zr)||null};try{xe(!0),console.log("[Produtos] Salvando produto",Pr);const vr=2e4,yn=new Promise((On,Xn)=>setTimeout(()=>Xn(new Error("Timeout ao salvar produto (20s)")),vr));await Promise.race([n(Pr),yn]),d({title:"Produto salvo",description:"O produto foi salvo com sucesso.",variant:"success",duration:4e3,className:"bg-amber-500 text-black shadow-xl"}),t(!1)}catch(vr){console.error("[Produtos] Erro ao salvar",vr);const yn=xc(vr,{action:"save"});d({title:yn.title,description:yn.description,variant:"destructive",duration:6e3})}finally{xe(!1)}};return p.useEffect(()=>{e||xe(!1)},[e]),a.jsxs(xn,{open:e,onOpenChange:t,children:[a.jsxs(vn,{className:"w-[90vw] sm:max-w-[780px] max-h-[80vh] sm:max-h-[85vh] flex flex-col",onKeyDown:$e=>{$e.key==="F5"&&($e.preventDefault(),Bt($e)),$e.key==="Escape"&&($e.preventDefault(),t(!1))},children:[a.jsx(pn,{children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx(un,{className:"text-lg sm:text-xl",children:r?"Detalhes do Produto":"Novo Produto"}),a.jsx(Dn,{className:"text-xs sm:text-sm",children:"Preencha as informaes e use as abas para navegar."})]})})}),a.jsx("form",{onSubmit:Bt,className:"grid gap-4 py-2 flex-1 overflow-y-auto pr-1 fx-scroll",children:a.jsxs(Cc,{value:f,onValueChange:h,className:"w-full",children:[a.jsx("div",{className:"sm:hidden mb-4",children:a.jsxs(Nn,{value:f,onValueChange:h,children:[a.jsx(bn,{className:"w-full",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"dados",children:"Dados"}),a.jsx(tt,{value:"estoque",children:"Estoque"}),a.jsx(tt,{value:"preco",children:"Preo e Lucro"}),a.jsx(tt,{value:"impostos",children:"Impostos"}),a.jsx(tt,{value:"outras",children:"Outras Info"})]})]})}),a.jsxs(Gl,{className:"hidden sm:grid grid-cols-5 gap-1",children:[a.jsx(da,{value:"dados",children:"Dados"}),a.jsx(da,{value:"estoque",children:"Estoque"}),a.jsx(da,{value:"preco",children:"Preo e Lucro"}),a.jsx(da,{value:"impostos",children:"Impostos"}),a.jsx(da,{value:"outras",children:"Outras Info"})]}),a.jsx("div",{className:"mt-2 text-[10px] sm:text-[11px] text-text-muted",children:"* Campo obrigatrio"}),a.jsxs(ds,{value:"dados",className:"space-y-3 mt-2",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(Le,{htmlFor:"code",className:"text-left sm:text-right text-xs sm:text-sm",children:["Cdigo ",a.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(auto)"})]}),a.jsx(Ye,{id:"code",value:m,onChange:$e=>v($e.target.value.replace(/\D/g,"")),className:"col-span-1 sm:col-span-3 text-sm",placeholder:i||"Ex.: 0001",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(Le,{htmlFor:"name",className:"text-left sm:text-right text-xs sm:text-sm",children:["Descrio ",!g?.trim()&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(Ye,{id:"name",value:g,onChange:$e=>y($e.target.value),className:"col-span-1 sm:col-span-3 text-sm",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{htmlFor:"category",className:"text-left sm:text-right text-xs sm:text-sm",children:"Categoria"}),a.jsxs("div",{className:"col-span-3 flex gap-2 items-center",children:[a.jsxs(Nn,{value:x,onValueChange:$e=>Xt&&b($e),children:[a.jsx(bn,{className:"w-full",disabled:!Xt,children:a.jsx(Cn,{placeholder:"Selecione..."})}),a.jsx(wn,{children:s.map($e=>a.jsx(tt,{value:$e,children:$e},$e))})]}),a.jsxs(me,{type:"button",onClick:()=>Ct($e=>!$e),className:"bg-amber-500 hover:bg-amber-400 text-black inline-flex items-center gap-2 whitespace-nowrap px-3",title:st?"Fechar":"Adicionar nova categoria",disabled:!Xt,children:[a.jsx("span",{className:"font-bold",children:"+"}),a.jsx("span",{children:"Novo"})]})]})]}),st&&a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-3 flex gap-2",children:[a.jsx(Ye,{value:ar,onChange:$e=>pr($e.target.value),placeholder:"Nome da nova categoria"}),a.jsx(me,{type:"button",onClick:async()=>{const $e=ar.trim();if($e)try{if(s.includes($e)){d({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}await o?.($e),b($e),pr(""),Ct(!1),d({title:"Categoria adicionada",description:"Ela j est selecionada no formulrio.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(Dt){console.error("[Produto] add category inline:error",Dt);const Sr=xc(Dt,{action:"save"});d({title:Sr.title,description:Sr.description,variant:"destructive"})}},children:"Adicionar"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(Le,{htmlFor:"unit",className:"text-left sm:text-right text-xs sm:text-sm",children:["Unidade ",!_?.trim()&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(Nn,{value:_,onValueChange:$e=>Xt&&C($e),children:[a.jsx(bn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!Xt,children:a.jsx(Cn,{placeholder:"Selecione a unidade"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"UN",children:"UN - Unidade"}),a.jsx(tt,{value:"CX",children:"CX - Caixa"}),a.jsx(tt,{value:"PC",children:"PC - Pea"}),a.jsx(tt,{value:"KG",children:"KG - Quilograma"}),a.jsx(tt,{value:"G",children:"G - Grama"}),a.jsx(tt,{value:"L",children:"L - Litro"}),a.jsx(tt,{value:"ML",children:"ML - Mililitro"}),a.jsx(tt,{value:"M",children:"M - Metro"}),a.jsx(tt,{value:"M2",children:"M - Metro Quadrado"}),a.jsx(tt,{value:"M3",children:"M - Metro Cbico"}),a.jsx(tt,{value:"PAR",children:"PAR - Par"}),a.jsx(tt,{value:"DZ",children:"DZ - Dzia"}),a.jsx(tt,{value:"FD",children:"FD - Fardo"}),a.jsx(tt,{value:"SC",children:"SC - Saco"}),a.jsx(tt,{value:"PT",children:"PT - Pacote"}),a.jsx(tt,{value:"SERV",children:"SERV - Servio"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(Le,{className:"text-left sm:text-right text-xs sm:text-sm",children:["Tipo ",!w&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(Nn,{value:w,onValueChange:$e=>Xt&&j($e),children:[a.jsx(bn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!Xt,children:a.jsx(Cn,{placeholder:"Selecione o tipo"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"Venda",children:"Produto para Venda"}),a.jsx(tt,{value:"Uso Interno",children:"Produto de Uso Interno"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-left sm:text-right text-xs sm:text-sm",children:"Ativo"}),a.jsx("div",{className:"col-span-1 sm:col-span-3",children:r?a.jsxs(a.Fragment,{children:[a.jsx(Ha,{checked:P,onCheckedChange:$e=>{console.log("[ProdutosPage] Checkbox active mudou para:",$e),E(!!$e)},disabled:!Xt}),a.jsx("span",{className:"ml-2 text-xs sm:text-sm",children:"Ativo"})]}):a.jsxs(Nn,{value:P?"ativo":"inativo",onValueChange:$e=>{console.log("[ProdutosPage] Select active mudou para:",$e),E($e==="ativo")},children:[a.jsx(bn,{className:"w-full sm:w-48 text-sm",disabled:!Xt,children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"ativo",children:"Ativo"}),a.jsx(tt,{value:"inativo",children:"Inativo"})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{htmlFor:"barcode",className:"text-left sm:text-right text-xs sm:text-sm",children:"EAN-13"}),a.jsx(Ye,{id:"barcode",value:A,onChange:$e=>F(H($e.target.value)),className:"col-span-1 sm:col-span-3 text-sm",placeholder:"789...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(Le,{htmlFor:"validade",className:"text-left sm:text-right text-xs sm:text-sm",children:["Validade ",a.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(Opcional)"})]}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"outline",className:gr("col-span-1 sm:col-span-3 justify-start text-left font-normal text-xs sm:text-sm",!fr&&"text-muted-foreground"),disabled:!Xt,children:[a.jsx(qj,{className:"mr-2 h-3 w-3 sm:h-4 sm:w-4"}),fr?ur(fr,"dd/MM/yyyy"):a.jsx("span",{children:"Selecione a data"})]})}),a.jsx(Jo,{className:"p-0 w-[280px] sm:w-[300px]",children:a.jsx("div",{className:"w-[280px] sm:w-[300px] min-h-[300px] sm:min-h-[332px]",children:a.jsx(ui,{mode:"single",selected:fr,onSelect:It,initialFocus:!0,fixedWeeks:!0})})})]})]})]}),a.jsx(ds,{value:"estoque",className:"space-y-3 mt-2",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"grid grid-cols-2 items-center gap-2",children:[a.jsx(Le,{htmlFor:"stock",className:"text-right",children:"Estoque"}),a.jsx(Ye,{id:"stock",value:Ze,onChange:$e=>Ne($e.target.value.replace(/[^0-9]/g,"")),disabled:!Xt,className:"col-span-1",inputMode:"numeric"})]}),a.jsxs("div",{className:"grid grid-cols-2 items-center gap-4",children:[a.jsx(Le,{htmlFor:"minStock",className:"text-right",children:"Estoque Mn."}),a.jsx(Ye,{id:"minStock",value:ye,onChange:$e=>Be($e.target.value.replace(/[^0-9]/g,"")),disabled:!Xt,inputMode:"numeric"})]})]})}),a.jsxs(ds,{value:"preco",className:"space-y-3 mt-2",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{htmlFor:"costPrice",className:"text-xs sm:text-right",children:"Preo de Custo (R$)"}),a.jsx(Ye,{id:"costPrice",inputMode:"numeric",placeholder:"Ex.: 10,00",value:`R$ ${yt||"0,00"}`,onChange:$e=>{Qe(re($e.target.value))},disabled:!Xt,className:"sm:col-span-3 text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(Le,{htmlFor:"salePrice",className:"text-xs sm:text-right",children:["Preo de Venda (R$) ",(!ge||O(ge)<=0)&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(Ye,{id:"salePrice",inputMode:"numeric",placeholder:"Ex.: 15,00",value:`R$ ${ge||"0,00"}`,onChange:$e=>{ft.current="salePrice",rt(re($e.target.value))},disabled:!Xt,className:"sm:col-span-3 text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{htmlFor:"marginPercent",className:"text-xs sm:text-right",children:"% de Lucro (Margem)"}),a.jsx(Ye,{id:"marginPercent",type:"text",placeholder:"Ex.: 40",value:pt?`% ${pt}`:"",onChange:$e=>{ft.current="marginPercent";const Dt=$e.target.value.replace(/[^\d,]/g,"");We(Dt)},onBlur:()=>{if(ft.current==="marginPercent"){const $e=O(yt),Dt=X(pt);if($e>0&&Dt>0)if(Dt>=100){const Sr=$e*(1+Dt/100);rt(Sr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const Sr=$e/(1-Dt/100);rt(Sr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}}},disabled:!Xt,className:"sm:col-span-3 text-xs sm:text-sm"})]})]}),a.jsxs(ds,{value:"impostos",className:"space-y-4 mt-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ha,{id:"useCsosn",checked:lr,onCheckedChange:$e=>Rr(!!$e),disabled:!Xt}),a.jsx(Le,{htmlFor:"useCsosn",className:"cursor-pointer text-xs sm:text-sm",children:"Usar CSOSN (Simples Nacional)"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Interna"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CFOP"}),a.jsx(Ye,{value:Pn,onChange:$e=>De(L($e.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"5102",disabled:!Xt})]}),!lr&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CST"}),a.jsx(Ye,{value:ke,onChange:$e=>Ge($e.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!Xt})]}),lr&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CSOSN"}),a.jsx(Ye,{value:Re,onChange:$e=>bt($e.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),a.jsx(Ye,{value:`${Qt||""}`,onChange:$e=>ct(T($e.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!Xt})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Externa"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CFOP"}),a.jsx(Ye,{value:xt,onChange:$e=>it(L($e.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"6102",disabled:!Xt})]}),!lr&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CST"}),a.jsx(Ye,{value:kt,onChange:$e=>be($e.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!Xt})]}),lr&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CSOSN"}),a.jsx(Ye,{value:dt,onChange:$e=>Lt($e.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),a.jsx(Ye,{value:`${mr||""}`,onChange:$e=>tr(T($e.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!Xt})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"PIS/COFINS"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CST PIS Entrada"}),a.jsx(Ye,{value:Or,onChange:$e=>Lr($e.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 70...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CST PIS Sada"}),a.jsx(Ye,{value:sr,onChange:$e=>fn($e.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"01, 04...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"Alquota PIS (%)"}),a.jsx(Ye,{value:`${Tn||""}`,onChange:$e=>mn(T($e.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,65",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"Alquota COFINS (%)"}),a.jsx(Ye,{value:`${zn||""}`,onChange:$e=>ot(T($e.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"3,00",disabled:!Xt})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"IPI"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CST IPI"}),a.jsx(Ye,{value:$t,onChange:$e=>Yt($e.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 99...",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"Alquota IPI (%)"}),a.jsx(Ye,{value:`${Ht||""}`,onChange:$e=>Ot(T($e.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!Xt})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"FCP (%)"}),a.jsx(Ye,{value:`${Xr||""}`,onChange:$e=>Je(T($e.target.value)),placeholder:"2,00",disabled:!Xt,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"MVA (%)"}),a.jsx(Ye,{value:`${cr||""}`,onChange:$e=>vt(T($e.target.value)),placeholder:"40,00",disabled:!Xt,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"Base Reduzida (%)"}),a.jsx(Ye,{value:`${Tt||""}`,onChange:$e=>Dr(T($e.target.value)),placeholder:"0,00",disabled:!Xt,className:"text-xs sm:text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"NCM"}),a.jsx(Ye,{value:an,onChange:$e=>Nr(Fe($e.target.value)),placeholder:"00000000",disabled:!Xt,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"CEST"}),a.jsx(Ye,{value:zr,onChange:$e=>ha(nt($e.target.value)),placeholder:"0000000",disabled:!Xt,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4 sm:col-span-1",children:[a.jsx(Le,{className:"text-xs sm:text-right",children:"Descrio NCM"}),a.jsx(Ye,{value:St,onChange:$e=>Fr($e.target.value),placeholder:"Descrio do NCM",disabled:!Xt,className:"text-xs sm:text-sm"})]})]})]}),a.jsxs(ds,{value:"outras",className:"space-y-3 mt-2",children:[r&&a.jsxs("div",{className:"pb-4 mb-4 border-b border-border",children:[a.jsx(me,{type:"button",onClick:()=>ae(!0),disabled:!Xt,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:"Desmembrar e Unir Produto"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{htmlFor:"barcode2",className:"text-xs sm:text-right",children:"Cdigo de Barras"}),a.jsx(Ye,{id:"barcode2",value:A,onChange:$e=>F(H($e.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{htmlFor:"barcodeBox",className:"text-xs sm:text-right",children:"Cdigo Barras (Caixa)"}),a.jsx(Ye,{id:"barcodeBox",value:D,onChange:$e=>I(H($e.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13 da caixa",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{htmlFor:"reference",className:"text-xs sm:text-right",children:"Referncia"}),a.jsx(Ye,{id:"reference",value:R,onChange:$e=>M($e.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: REF-123",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{htmlFor:"brand",className:"text-xs sm:text-right",children:"Marca"}),a.jsx(Ye,{id:"brand",value:U,onChange:$e=>z($e.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Nike",disabled:!Xt})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(Le,{htmlFor:"group",className:"text-xs sm:text-right",children:"Grupo"}),a.jsx(Ye,{id:"group",value:W,onChange:$e=>$($e.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Calados",disabled:!Xt})]})]}),!1]})}),a.jsxs(ra,{children:[a.jsx(lh,{asChild:!0,children:a.jsx(me,{type:"button",variant:"secondary",children:"Cancelar"})}),a.jsx(me,{type:"button",onClick:Bt,disabled:Ut||!Xt,title:"F5 para salvar",children:Ut?"Salvando...":"Salvar Produto"})]})]}),a.jsx(wst,{open:En,onOpenChange:ae,product:r,currentPrice:ge,allProducts:c,userProfile:u,onApply:async($e,Dt,Sr,Pr)=>{if(!Sr)rt($e),Ne(Dt),ae(!1),d({title:"Preo desmembrado!",description:`Preo unitrio: R$ ${O($e).toFixed(2)} | Estoque: ${Dt}`,variant:"success"});else try{const vr=Number(Dt),yn=await ix({productId:Sr.id,delta:vr,codigoEmpresa:u?.codigo_empresa}),On=Number(yn?.stock??Number(Sr.stock||0)+vr);if(Pr){const Xn={...Sr,stock:On,salePrice:O($e),price:O($e)};await Zw(Sr.id,Xn)}await IR(r.id),d({title:"Produto desmembrado e unido!",description:`${Sr.name}: novo estoque = ${On} | preo unitrio = R$ ${O($e).toFixed(2)}`,variant:"success"}),ae(!1),t(!1);try{typeof l=="function"&&l()}catch{}}catch(vr){console.error("[Desmembrar e Unir] Erro:",vr),d({title:"Erro ao processar",description:vr?.message||"Tente novamente",variant:"destructive"})}}})]})}function wst({open:e,onOpenChange:t,product:r,currentPrice:n,allProducts:s,userProfile:o,onApply:i}){const[l,c]=p.useState(""),[d,u]=p.useState(""),[f,h]=p.useState(!1),[m,v]=p.useState(""),[g,y]=p.useState(null),[x,b]=p.useState(!1),w=E=>{const A=String(E||"").replace(/\D/g,"");return(A?Number(A)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},j=E=>{if(!E)return 0;const A=String(E).replace(/\./g,"").replace(",","."),F=Number(A);return Number.isFinite(F)?F:0};p.useEffect(()=>{e&&n&&(c(n),u(""),h(!1),v(""),y(null),b(!1))},[e,n]);const _=l&&d&&Number(d)>0?j(l)/Number(d):0,C=(s||[]).filter(E=>{if(!r||E.id===r.id)return!1;if(!m.trim())return!0;const A=m.toLowerCase();return(E.name||"").toLowerCase().includes(A)||(E.code||"").toLowerCase().includes(A)}).slice(0,10),P=g?Number(d||0)+Number(g.stock||0):0;return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[650px] max-h-[85vh] flex flex-col overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Desmembrar e Unir Produto"}),a.jsx(Dn,{children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"1. Desmembrar Preo"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{children:"Valor Total (R$)"}),a.jsx(Ye,{inputMode:"numeric",placeholder:"0,00",value:`R$ ${l||"0,00"}`,onChange:E=>c(w(E.target.value))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{children:"Quantidade de Unidades"}),a.jsx(Ye,{type:"text",inputMode:"numeric",placeholder:"0",value:d,onChange:E=>u(E.target.value.replace(/[^0-9]/g,""))})]}),_>0&&a.jsx("div",{className:"bg-muted/50 border border-border p-3 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Preo Unitrio:"}),a.jsxs("span",{className:"text-lg font-bold",children:["R$ ",_.toFixed(2)]})]})})]}),_>0&&a.jsxs("div",{className:"space-y-3 border-t pt-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"wantToMerge",checked:f,onCheckedChange:E=>{h(!!E),E||(y(null),v(""),b(!1))}}),a.jsx(Le,{htmlFor:"wantToMerge",className:"cursor-pointer text-sm font-semibold",children:"2. Unir com outro produto (opcional)"})]}),f&&a.jsxs("div",{className:"space-y-3 ml-6",children:[a.jsx("div",{className:"bg-muted/30 border border-border p-3 rounded-lg",children:a.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.jsx("strong",{children:"Produto atual:"})," ",r?.name," (ser inativado aps unio)"]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{children:"Buscar Produto Destino"}),a.jsx(Ye,{placeholder:"Digite o nome ou cdigo...",value:m,onChange:E=>v(E.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Le,{className:"text-xs",children:["Produtos Disponveis (",C.length,")"]}),a.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1 border border-border rounded-lg p-2",children:C.length===0?a.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:"Nenhum produto encontrado"}):C.map(E=>a.jsx("div",{onClick:()=>y(E),className:gr("p-2 rounded-md cursor-pointer border transition-colors",g?.id===E.id?"bg-primary/10 border-primary":"bg-background hover:bg-muted/50 border-transparent"),children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:E.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[E.code&&`Cdigo: ${E.code}  `,"Estoque: ",E.stock||0,"  R$ ",Number(E.price||E.salePrice||0).toFixed(2)]})]}),g?.id===E.id&&a.jsx(Do,{className:"w-4 h-4 text-primary flex-shrink-0"})]})},E.id))})]}),g&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"bg-primary/5 border border-primary/20 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs font-medium mb-1",children:"Resumo da Unio:"}),a.jsxs("div",{className:"text-xs space-y-0.5 text-muted-foreground",children:[a.jsxs("p",{children:[" Destino: ",a.jsx("strong",{children:g.name})]}),a.jsxs("p",{children:[" Estoque atual: ",g.stock||0]}),a.jsxs("p",{children:[" Estoque a somar: +",d]}),a.jsxs("p",{className:"text-primary font-bold",children:[" Novo estoque: ",P]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"updatePrice",checked:x,onCheckedChange:E=>b(!!E)}),a.jsxs(Le,{htmlFor:"updatePrice",className:"cursor-pointer text-xs",children:["Atualizar preo do destino para R$ ",_.toFixed(2)]})]})]})]})]})]}),a.jsxs(ra,{children:[a.jsx(me,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),a.jsx(me,{onClick:()=>{if(_>0){const E=_.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});i(E,d,f?g:null,x)}},disabled:_<=0||f&&!g,children:f&&g?"Desmembrar e Unir":"Aplicar Desmembramento"})]})]})})}function jst({open:e,onOpenChange:t,categories:r,onAddCategory:n,onRemoveCategory:s}){const{toast:o}=as(),[i,l]=p.useState(""),[c,d]=p.useState(!1),u=async()=>{const h=i.trim();if(h){if(r.includes(h)){o({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}try{d(!0),await n(h),l(""),o({title:"Categoria adicionada",description:"Ela j aparece na lista.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(m){console.error("[Categorias] add:error",m);const v=xc(m,{action:"save"});o({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}}},f=async h=>{try{d(!0),await s(h),o({title:"Categoria desativada",description:"A categoria foi marcada como inativa.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(m){console.error("[Categorias] remove:error",m);const v=xc(m,{action:"save"});o({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}};return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-[480px]",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Gerenciar Categorias"}),a.jsx(Dn,{children:"Adicione ou remova categorias de produtos."})]}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{value:i,onChange:h=>l(h.target.value),placeholder:"Nome da nova categoria"}),a.jsx(me,{onClick:u,disabled:c,children:c?"Processando...":"Adicionar"})]}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.map(h=>a.jsxs("div",{className:"flex items-center justify-between bg-surface-2 p-2 rounded-md",children:[a.jsx("span",{className:"font-semibold",children:h}),a.jsx(me,{variant:"ghost",size:"icon",className:"h-8 w-8 text-danger/80 hover:text-danger",onClick:()=>f(h),disabled:c,children:a.jsx(zu,{size:14})})]},h))})]})]})})}function _st(){const{toast:e}=as(),{userProfile:t,authReady:r}=vs();Lo();const[n,s]=p.useState(gst),[o,i]=p.useState(vst),[l,c]=p.useState([]),[d,u]=p.useState("");p.useState("list");const[f,h]=p.useState(!0),[m,v]=p.useState(null),[g,y]=p.useState(!1),[x,b]=p.useState(!1),[w,j]=p.useState("all"),[_,C]=p.useState(""),[P,E]=p.useState({type:"all",category:"all",status:"active",newOnly:!1}),[A,F]=p.useState(!1),[D,I]=p.useState(!1),[R,M]=p.useState(!1),[U,z]=p.useState(null),[W,$]=p.useState({by:"code",dir:"asc"}),ee=p.useRef(!0),ve=p.useRef(0),_e=p.useRef(0);p.useRef(!1);const[K,q]=p.useState(!1),[Y,J]=p.useState("paged"),fe=Y==="paged",[Z,ce]=p.useState(1),[le]=p.useState(100),[ie,te]=p.useState(0);p.useEffect(()=>(ee.current=!0,()=>{ee.current=!1}),[]),p.useEffect(()=>{try{const be=localStorage.getItem(TU);if(!be)return;const dt=JSON.parse(be);dt&&typeof dt=="object"&&((dt.listMode==="paged"||dt.listMode==="all")&&J(dt.listMode),typeof dt.showStats=="boolean"&&h(dt.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa||!t?.id&&!t?.user_id)return;const dt=t.id||t.user_id,Lt=`produtos:${t.codigo_empresa}`,mr=await Ese({userId:dt,scope:Lt});mr&&((mr.listMode==="paged"||mr.listMode==="all")&&J(mr.listMode),typeof mr.showStats=="boolean"&&h(mr.showStats))})()},[t?.codigo_empresa,t?.id]),p.useEffect(()=>{try{const be={listMode:Y,showStats:f};localStorage.setItem(TU,JSON.stringify(be))}catch{}if(t?.codigo_empresa&&(t?.id||t?.user_id)){const be=t.id||t.user_id,dt=`produtos:${t.codigo_empresa}`;kse({userId:be,scope:dt,settings:{listMode:Y,showStats:f}})}},[Y,f,t?.codigo_empresa,t?.id]);const ue=async()=>{const be=t?.codigo_empresa||null;if(!r||!be)return;const dt=`produtos:list:${be}`;F(!0);const Lt=setTimeout(()=>{if(ee.current)try{const mr=JSON.parse(localStorage.getItem(dt)||"[]");Array.isArray(mr)&&mr.length>0&&(console.warn("[Produtos] slow fallback: using cached snapshot"),s(mr))}catch{}},2e3);try{const mr=P.status==="all"||P.status==="inactive";let tr=[];if(fe){console.log("[Produtos] refetchProducts - modo paginado - Filtro status:",P.status,"includeInactive:",mr,"page:",Z,"pageSize:",le);const Or=await zat({includeInactive:mr,search:_,codigoEmpresa:be,page:Z,pageSize:le});if(!ee.current)return;tr=Or?.data||[];const Lr=Or?.count||0;console.log("[Produtos] refetchProducts - Produtos carregados (paginado):",tr.length,"de",Lr),s(tr),te(Lr)}else{if(console.log("[Produtos] refetchProducts - modo TODOS - Filtro status:",P.status,"includeInactive:",mr),tr=await hu({includeInactive:mr,search:_,codigoEmpresa:be}),!ee.current)return;console.log("[Produtos] refetchProducts - Produtos carregados (todos):",tr.length),s(tr),te(tr.length)}try{localStorage.setItem(dt,JSON.stringify(tr))}catch{}_e.current=tr.length,ve.current=Date.now()}catch(mr){console.error("[Produtos] refetchProducts:error",mr);const tr=xc(mr,{action:"fetch"});e({title:tr.title,description:tr.description,variant:"destructive"})}finally{clearTimeout(Lt),F(!1)}};p.useEffect(()=>{const be=(()=>{try{const Or=localStorage.getItem("auth:userProfile");return Or&&JSON.parse(Or)?.codigo_empresa||null}catch{return null}})(),dt=t?.codigo_empresa||be;if(!dt)return;const Lt=`produtos:list:${dt}`,mr=(()=>{try{return JSON.parse(localStorage.getItem(Lt)||"[]")}catch{return[]}})();Array.isArray(mr)&&mr.length>0&&(s(mr),_e.current=mr.length);const tr=async(Or=3)=>{for(let Lr=0;Lr<Or;Lr++)try{if(ee.current){await ue();break}}catch(sr){console.warn(`[ProdutosPage] Tentativa ${Lr+1} falhou:`,sr),Lr===Or-1?console.error("[ProdutosPage] Todas as tentativas falharam"):await new Promise(fn=>setTimeout(fn,1e3*(Lr+1)))}};try{const Or=JSON.parse(localStorage.getItem(`produtos:cats:${dt}`)||"[]");Array.isArray(Or)&&Or.length>0&&i(Or)}catch{}if(r&&t?.codigo_empresa){const Or=setTimeout(()=>tr(),100);return(async()=>{try{const Lr=await OU({codigoEmpresa:t.codigo_empresa});if(!ee.current)return;i(Lr);try{localStorage.setItem(`produtos:cats:${t.codigo_empresa}`,JSON.stringify(Lr))}catch{}}catch(Lr){console.error("[Categorias] load on mount:error",Lr)}})(),()=>clearTimeout(Or)}},[r,t?.codigo_empresa]),p.useEffect(()=>{const be=()=>{(Date.now()-(ve.current||0)>3e4||_e.current===0)&&ue()},dt=()=>{document.visibilityState==="visible"&&(Date.now()-(ve.current||0)>3e4||_e.current===0)&&ue()};return window.addEventListener("focus",be),document.addEventListener("visibilitychange",dt),()=>{window.removeEventListener("focus",be),document.removeEventListener("visibilitychange",dt)}},[r,t?.codigo_empresa]),p.useEffect(()=>{ce(1),r&&ue()},[P.status,r]),p.useEffect(()=>{const be=setTimeout(()=>{ce(1),r&&ue()},300);return()=>clearTimeout(be)},[_,r]),p.useEffect(()=>{ce(1),r&&ue()},[Y,r]);const[Te,ne]=p.useState("N/A");p.useEffect(()=>{let be=!0;return(async()=>{try{const dt=await qat({limit:1,codigoEmpresa:t?.codigo_empresa});if(!be)return;if(Array.isArray(dt)&&dt.length>0){const Lt=dt[0];ne(`${Lt.name} (${Lt.total})`)}else ne("")}catch{be&&ne("N/A")}})(),()=>{be=!1}},[t?.codigo_empresa]);const[de,lt]=p.useState(!1),[Nt,at]=p.useState(()=>{const be=new Date;return be.setHours(0,0,0,0),be}),[gt,Pt]=p.useState(!1),[yt,Qe]=p.useState(()=>new Date),[ge,rt]=p.useState(!1),[pt,We]=p.useState([]),[Ze,Ne]=p.useState(!1),ye=async()=>{try{rt(!0);const be=await Bat({from:Nt,to:yt,codigoEmpresa:t?.codigo_empresa});We(be||[])}catch(be){e({title:"Falha ao carregar vendas do perodo",description:be?.message||"Tente novamente",variant:"destructive"})}finally{rt(!1)}},Be=p.useMemo(()=>{const be=new Date;return{mostSold:Te,lowStock:n.filter(dt=>dt.status==="low_stock"||dt.stock>0&&dt.stock<=dt.minStock).length,expired:n.filter(dt=>dt.validade&&dt.validade<be).length}},[n,Te]),mt=p.useMemo(()=>{const be=new Date;return n.filter(dt=>{const Lt=w==="all"?!0:w==="low_stock"?dt.status==="low_stock"||dt.stock>0&&dt.stock<=dt.minStock:w==="expired"?dt.validade&&dt.validade<be:!1,mr=P.status==="all"?!0:dt.status===P.status,tr=P.type==="all"||dt.type===P.type,Or=P.category==="all"||dt.category===P.category,Lr=!P.newOnly||dt.dataImportacao&&(()=>Math.floor((new Date-dt.dataImportacao)/864e5)<=7)();return Lt&&mr&&tr&&Or&&Lr})},[n,w,P]),Ft=be=>be?.dataImportacao?Math.floor((new Date-be.dataImportacao)/(1e3*60*60*24))<=7:!1,fr=p.useMemo(()=>{const be=[...mt],dt=W.dir==="asc"?1:-1,Lt=(tr,Or)=>Number.isFinite(tr)?tr:Or,mr=tr=>{if(!tr)return NaN;if(tr instanceof Date)return tr.getTime();const Or=new Date(tr);return Number.isNaN(Or.getTime())?NaN:Or.getTime()};return be.sort((tr,Or)=>{if(W.by==="code"){const Lr=Lt(parseInt((tr.code||"").trim(),10),1/0),sr=Lt(parseInt((Or.code||"").trim(),10),1/0);return Lr===sr?0:Lr>sr?dt:-dt}if(W.by==="name"){const Lr=(tr.name||"").toString(),sr=(Or.name||"").toString();return Lr.localeCompare(sr,"pt-BR",{sensitivity:"base"})*dt}if(W.by==="validade"){const Lr=Lt(mr(tr.validade),1/0),sr=Lt(mr(Or.validade),1/0);return Lr===sr?0:Lr>sr?dt:-dt}return 0}),be},[mt,W]),It=p.useMemo(()=>{if(!le)return 1;const be=Math.ceil((ie||0)/le);return be>0?be:1},[ie,le]),Ut=be=>{$(dt=>dt.by===be?{by:be,dir:dt.dir==="asc"?"desc":"asc"}:{by:be,dir:"asc"})},xe=be=>{j(dt=>dt===be?"all":be)},st=()=>{at(()=>{const be=new Date;return be.setHours(0,0,0,0),be}),Qe(new Date),lt(!0),setTimeout(ye,0)},Ct=(be,dt)=>{E(Lt=>({...Lt,[be]:dt}))},ar=async()=>{v(null);const be=t?.codigo_empresa||null;let dt="";if(be)try{dt=await IU({codigoEmpresa:be})}catch(Lt){console.error("[Produtos] handleAddNew: falha ao obter prximo cdigo",Lt)}u(dt||""),y(!0)},pr=be=>{v(be),y(!0)},Xt=()=>{try{yst(fr),e({title:"Exportao concluda",description:`${fr.length} produto(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(be){console.error("[Produtos] export:error",be);const dt=xc(be,{action:"export"});e({title:dt.title,description:dt.description,variant:"destructive"})}},yr=be=>{c(dt=>dt.includes(be)?dt.filter(Lt=>Lt!==be):[...dt,be])},lr=()=>{const be=fr.map(dt=>dt.id);be.length&&c(be)},Rr=()=>{c([])},Pn=be=>{be?lr():Rr()},De=p.useMemo(()=>fr.filter(be=>l.includes(be.id)),[fr,l]),ke=p.useMemo(()=>De.some(Ft),[De]),Ge=async be=>{if(l.length)try{await Uat({ids:l,status:be}),await ue(),Rr(),e({title:be==="inactive"?"Produtos inativados":"Produtos atualizados",description:`${l.length} produto(s) atualizado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(dt){const Lt=xc(dt,{action:"save"});e({title:Lt.title,description:Lt.description,variant:"destructive"})}},Re=async()=>{if(!(!l.length||!ke))try{await Vat({ids:l}),await ue(),Rr(),e({title:"Novos removidos",description:"A etiqueta de novo foi removida dos produtos selecionados.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(be){const dt=xc(be,{action:"save"});e({title:dt.title,description:dt.description,variant:"destructive"})}},bt=async()=>{const be=t?.codigo_empresa||null;if(!(!r||!be))try{const dt=await OU({codigoEmpresa:be});if(!ee.current)return;i(dt);try{localStorage.setItem(`produtos:cats:${be}`,JSON.stringify(dt))}catch{}}catch(dt){console.error("[Categorias] load on mount:error",dt)}},Qt=async be=>{i(dt=>{if(dt.includes(be))return dt;const Lt=[...dt,be];return Lt.sort((mr,tr)=>mr.localeCompare(tr,"pt-BR")),Lt});try{await Wat(be,{codigoEmpresa:t?.codigo_empresa}),await bt()}catch(dt){i(mr=>mr.filter(tr=>tr!==be)),console.error("[Categorias] add:error",dt);const Lt=xc(dt,{action:"save"});e({title:Lt.title,description:Lt.description,variant:"destructive"})}},ct=async be=>{if(n.some(mr=>mr.category===be&&mr.status!=="inactive"))throw new Error("Categoria possui produtos ativos vinculados");const Lt=o;i(mr=>mr.filter(tr=>tr!==be));try{await Hat(be,{codigoEmpresa:t?.codigo_empresa}),await bt()}catch(mr){i(Lt),console.error("[Categorias] remove:error",mr);const tr=xc(mr,{action:"save"});e({title:tr.title,description:tr.description,variant:"destructive"})}},xt=async be=>{try{if(console.log("[Produtos] handleSaveProduct",be),!be||typeof be!="object"){console.warn("[Produtos] handleSaveProduct chamado sem payload vlido. Ignorando.");return}const dt=t?.codigo_empresa||null;if(!be.code&&dt)try{const mr=await IU({codigoEmpresa:dt});be.code=mr}catch(mr){console.error("[Produtos] Falha ao obter prximo cdigo automtico",mr)}const Lt=async mr=>{const Or=new Promise((Lr,sr)=>setTimeout(()=>sr(new Error("Timeout update/create (12s)")),12e3));return Promise.race([mr,Or])};if(be.id){const mr=await Lt(Zw(be.id,be,{codigoEmpresa:dt}));console.log("[Produtos] Produto atualizado - active:",mr.active,"status:",mr.status),s(tr=>tr.map(Or=>Or.id===mr.id?mr:Or)),await ue(),console.log("[Produtos] Refetch concludo aps update")}else{be.dataImportacao||(be.dataImportacao=new Date);const mr=await Lt(AS(be,{codigoEmpresa:dt}));console.log("[Produtos] Produto criado",mr),s(tr=>[mr,...tr]),setTimeout(()=>{ue().catch(tr=>console.error("[Produtos] refetch ps-create falhou",tr))},0)}}catch(dt){console.error("[Produtos] Erro no handleSaveProduct",dt);const Lt=xc(dt,{action:"save"});throw e({title:Lt.title,description:Lt.description,variant:"destructive"}),dt}},it=be=>{z(be),I(!0)},kt=async()=>{if(U?.id)try{M(!0),await IR(U.id),s(dt=>dt.filter(Lt=>Lt.id!==U.id)),await ue();const be=xc(null,{action:"delete"});e({variant:"success",title:be.title,description:`Produto "${U.name}" foi inativado com sucesso.`})}catch(be){const dt=xc(be,{action:"delete"});e({variant:"destructive",...dt})}finally{M(!1),I(!1),z(null)}};return a.jsxs(a.Fragment,{children:[a.jsxs(jr.div,{variants:xst,initial:"hidden",animate:"visible",className:"flex flex-col",children:[a.jsxs(jr.div,{variants:QT,className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Produtos"}),a.jsx("p",{className:"text-text-secondary hidden md:block",children:"Controle total sobre seu inventrio e estoque."})]}),a.jsx(me,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full hidden md:flex items-center justify-center",onClick:()=>q(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:a.jsx(bd,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-wrap",children:[a.jsx(me,{variant:"outline",size:"icon",onClick:()=>h(be=>!be),title:f?"Ocultar resumo":"Mostrar resumo","aria-label":f?"Ocultar resumo":"Mostrar resumo",children:f?a.jsx(Fp,{className:"h-4 w-4"}):a.jsx(rg,{className:"h-4 w-4"})}),a.jsxs(me,{variant:"outline",onClick:Xt,children:[a.jsx(ho,{className:"mr-2 h-4 w-4"})," Exportar"]}),a.jsxs(me,{variant:"secondary",onClick:()=>Pt(!0),children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Importar XML"]}),a.jsxs(me,{onClick:ar,children:[a.jsx(ns,{className:"mr-2 h-4 w-4"})," Novo Produto"]})]}),a.jsxs("div",{className:"mt-2 flex md:hidden items-center gap-2",children:[a.jsxs(me,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:Xt,title:"Exportar CSV","aria-label":"Exportar CSV",children:[a.jsx(ho,{className:"h-4 w-4"}),a.jsx("span",{children:"CSV"})]}),a.jsxs(me,{variant:"secondary",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>Pt(!0),title:"Importar XML","aria-label":"Importar XML",children:[a.jsx(Go,{className:"h-4 w-4"}),a.jsx("span",{children:"XML"})]}),a.jsxs(me,{className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:ar,title:"Novo Produto","aria-label":"Novo Produto",children:[a.jsx(ns,{className:"h-4 w-4"}),a.jsx("span",{children:"Prod"})]}),a.jsxs(me,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>b(!0),title:"Gerenciar categorias","aria-label":"Gerenciar categorias",children:[a.jsx(A2,{className:"h-4 w-4"}),a.jsx("span",{children:"Cat."})]}),a.jsx(me,{variant:"outline",size:"icon",className:"h-9 w-9 rounded-xl flex items-center justify-center ml-auto",onClick:()=>q(!0),title:"Configuraes da aba","aria-label":"Configuraes da aba",children:a.jsx(bd,{className:"h-4 w-4"})}),a.jsx(me,{variant:"outline",size:"icon",className:"h-10 w-10 rounded-xl flex items-center justify-center ml-auto",onClick:()=>h(be=>!be),title:f?"Ocultar resumo":"Mostrar resumo","aria-label":f?"Ocultar resumo":"Mostrar resumo",children:f?a.jsx(Fp,{className:"h-5 w-5"}):a.jsx(rg,{className:"h-5 w-5"})})]})]}),f&&a.jsxs("div",{className:"grid grid-cols-3 gap-3 md:gap-6 mb-6",children:[a.jsx(GE,{icon:Sc,title:a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden md:inline",children:"Mais Vendido (Dia)"}),a.jsx("span",{className:"md:hidden",children:"+ vendidos"})]}),value:Be.mostSold,subtitle:"Produto com mais sadas hoje",color:"text-brand",onClick:st}),a.jsx(GE,{icon:zf,title:a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden md:inline",children:"Estoque Baixo"}),a.jsx("span",{className:"md:hidden",children:"Est. baixo"})]}),value:Be.lowStock,subtitle:"Produtos precisando de reposio",color:"text-warning",onClick:()=>xe("low_stock"),isActive:w==="low_stock"}),a.jsx(GE,{icon:qj,title:a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden md:inline",children:"Vendidos"}),a.jsx("span",{className:"md:hidden",children:"Vencidos"})]}),value:Be.expired,subtitle:"Produtos fora da data de validade",color:"text-danger",onClick:()=>xe("expired"),isActive:w==="expired"})]}),a.jsx(xn,{open:de,onOpenChange:lt,children:a.jsxs(vn,{className:"max-w-2xl",onKeyDown:be=>be.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-xl font-bold",children:"Vendas por Perodo"}),a.jsx(Dn,{children:"Selecione o intervalo de datas e visualize os produtos vendidos."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[a.jsxs("div",{children:[a.jsx(Le,{className:"mb-1 block",children:"Incio"}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"outline",className:"w-full justify-start",children:[a.jsx(qj,{className:"mr-2 h-4 w-4"}),Nt?ur(Nt,"dd/MM/yyyy"):"Incio"]})}),a.jsx(Jo,{className:"p-0 w-[300px]",children:a.jsx("div",{className:"w-[300px] min-h-[332px]",children:a.jsx(ui,{mode:"single",selected:Nt,onSelect:be=>be&&at(be),initialFocus:!0,fixedWeeks:!0})})})]})]}),a.jsxs("div",{children:[a.jsx(Le,{className:"mb-1 block",children:"Fim"}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"outline",className:"w-full justify-start",children:[a.jsx(qj,{className:"mr-2 h-4 w-4"}),yt?ur(yt,"dd/MM/yyyy"):"Fim"]})}),a.jsx(Jo,{className:"p-0 w-[300px]",children:a.jsx("div",{className:"w-[300px] min-h-[332px]",children:a.jsx(ui,{mode:"single",selected:yt,onSelect:be=>be&&Qe(be),initialFocus:!0,fixedWeeks:!0})})})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(me,{type:"button",onClick:ye,disabled:ge,className:"w-full",children:ge?"Carregando...":"Aplicar"}),a.jsx(me,{type:"button",variant:"secondary",onClick:()=>{try{const be=pt||[],dt=";",Lt=()=>{const Lr=["Produto;Quantidade"];for(const sr of be)Lr.push(`${(sr.name||"").replace(/;/g,",")}${dt}${Number(sr.total||0)}`);return Lr.join(`
`)},mr=new Blob(["\uFEFF"+Lt()],{type:"text/csv;charset=utf-8;"}),tr=URL.createObjectURL(mr),Or=document.createElement("a");Or.href=tr,Or.download="vendas-periodo.csv",document.body.appendChild(Or),Or.click(),document.body.removeChild(Or),URL.revokeObjectURL(tr),e({title:"Exportao concluda",description:`${be.length} linha(s)`,variant:"success"})}catch(be){e({title:"Falha ao exportar",description:be?.message||"Tente novamente",variant:"destructive"})}},children:"Exportar CSV"})]})]}),a.jsx("div",{className:"mt-3 border rounded-md max-h-[50vh] overflow-auto thin-scroll",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-surface-2",children:[a.jsx("th",{className:"text-left p-2",children:"Produto"}),a.jsx("th",{className:"text-right p-2",children:"Quantidade"})]})}),a.jsxs("tbody",{children:[(pt||[]).length===0&&!ge&&a.jsx("tr",{children:a.jsx("td",{colSpan:2,className:"p-3 text-text-muted",children:"Nenhum item no perodo."})}),(pt||[]).map(be=>a.jsxs("tr",{className:"border-t border-border",children:[a.jsx("td",{className:"p-2",children:be.name}),a.jsx("td",{className:"p-2 text-right font-mono",children:Number(be.total||0)})]},be.id))]})]})}),a.jsx(ra,{children:a.jsx(lh,{asChild:!0,children:a.jsx(me,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),a.jsx(xn,{open:K,onOpenChange:q,children:a.jsxs(vn,{className:"max-w-2xl",children:[a.jsx(pn,{children:a.jsx(un,{children:"Configuraes da aba"})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-text-muted",children:"Modo de listagem"}),a.jsxs(Nn,{value:Y,onValueChange:J,children:[a.jsx(bn,{className:"w-[200px] h-8 text-xs",children:a.jsx(Cn,{placeholder:"Paginado"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"paged",children:"Paginado (100 por pgina)"}),a.jsx(tt,{value:"all",children:"Todos (sem paginao)"})]})]})]}),a.jsx("div",{className:"flex items-center justify-between pt-1",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"produtos-show-stats",checked:f,onCheckedChange:h}),a.jsx("label",{htmlFor:"produtos-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de resumo no topo"})]})})]}),a.jsx(ra,{children:a.jsx(lh,{asChild:!0,children:a.jsx(me,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),a.jsxs(jr.div,{variants:QT,className:"bg-surface rounded-lg border border-border flex flex-col",children:[a.jsxs("div",{className:"p-3 pb-4 sm:p-4 border-b border-border space-y-3 flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar por nome ou cdigo...",className:"pl-9 text-sm",value:_,onChange:be=>C(be.target.value)})]}),a.jsx(me,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>Ne(!0),"aria-label":"Abrir filtros",title:"Filtros",children:a.jsx(rI,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"hidden md:flex w-full items-center gap-3",children:[a.jsx("div",{className:"flex-1 min-w-[120px]",children:a.jsxs(Nn,{value:P.type,onValueChange:be=>Ct("type",be),children:[a.jsx(bn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Tipos"}),a.jsx(tt,{value:"Venda",children:"Venda"}),a.jsx(tt,{value:"Uso Interno",children:"Uso Interno"})]})]})}),a.jsx("div",{className:"flex-1 min-w-[140px]",children:a.jsxs(Nn,{value:P.category,onValueChange:be=>Ct("category",be),children:[a.jsx(bn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Categorias"}),o.map(be=>a.jsx(tt,{value:be,children:be},be))]})]})}),a.jsx("div",{className:"flex-1 max-w-[180px]",children:a.jsxs(Nn,{value:P.status,onValueChange:be=>Ct("status",be),children:[a.jsx(bn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Status"}),a.jsx(tt,{value:"active",children:"Ativo"}),a.jsx(tt,{value:"low_stock",children:"Estoque Baixo"}),a.jsx(tt,{value:"inactive",children:"Inativo"})]})]})}),a.jsxs("div",{className:"flex-1 flex justify-end gap-2 min-w-[160px]",children:[a.jsxs(me,{variant:"outline",onClick:()=>Ct("newOnly",!P.newOnly),className:gr("text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",P.newOnly&&"bg-amber-500 text-black border-amber-500 hover:bg-amber-400"),size:"sm",children:[a.jsx("span",{className:"mr-1",children:""}),a.jsx("span",{children:"Novos"})]}),a.jsxs(me,{variant:"outline",onClick:()=>b(!0),className:"text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",size:"sm",children:[a.jsx(A2,{className:"h-3 w-3 sm:h-4 sm:w-4"}),a.jsx("span",{children:"Categorias"})]}),a.jsx(me,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>q(be=>!be),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:a.jsx(bd,{className:"h-4 w-4"})})]})]})]}),l.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"px-3 sm:px-4 py-2.5 border-b border-border flex md:hidden items-center gap-2 text-xs",children:[a.jsxs("span",{className:"font-medium mr-2",children:[l.length," sel."]}),a.jsxs("button",{type:"button",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-border bg-surface-2",onClick:()=>{const be=fr.length>0&&fr.every(dt=>l.includes(dt.id));Pn(!be)},children:[a.jsx(Ha,{checked:fr.length>0&&fr.every(be=>l.includes(be.id)),className:"h-4 w-4"}),a.jsx("span",{children:"Todos"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 ml-auto",children:[a.jsx(me,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>Ge("active"),children:a.jsx(Do,{className:"h-4 w-4"})}),a.jsx(me,{variant:"outline",size:"icon",className:"h-8 w-8 text-danger border-danger/60 hover:bg-danger/10",onClick:()=>Ge("inactive"),children:a.jsx(zu,{className:"h-4 w-4"})}),ke&&a.jsx(me,{variant:"outline",size:"icon",className:"h-8 w-8 border-amber-500/70 text-amber-700 hover:bg-amber-500/10",onClick:Re,children:a.jsx(A2,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"hidden md:flex px-4 py-2 border-b border-border items-center gap-3 text-xs",children:[a.jsx("span",{className:"font-medium text-text-secondary whitespace-nowrap",children:l.length===0?"Nenhum item selecionado":`${l.length} produto${l.length>1?"s":""} selecionado${l.length>1?"s":""}`}),a.jsxs("div",{className:"flex flex-1 flex-wrap items-center justify-end gap-2",children:[a.jsxs(me,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:lr,children:[a.jsx(Do,{className:"h-3 w-3"}),a.jsx("span",{children:"Marcar filtrados"})]}),a.jsxs(me,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:Rr,children:[a.jsx(rI,{className:"h-3 w-3"}),a.jsx("span",{children:"Limpar seleo"})]}),a.jsxs(me,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-emerald-500/70 text-emerald-300 bg-emerald-500/10 hover:bg-emerald-500/20 flex items-center gap-1",onClick:()=>Ge("active"),children:[a.jsx(Do,{className:"h-3 w-3"}),a.jsx("span",{children:"Ativar itens"})]}),a.jsxs(me,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full text-danger border-danger/60 hover:bg-danger/10 flex items-center gap-1",onClick:()=>Ge("inactive"),children:[a.jsx(Fp,{className:"h-3 w-3"}),a.jsx("span",{children:"Desativar itens"})]}),ke&&a.jsxs(me,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-amber-500/70 text-amber-500 hover:bg-amber-500/10 flex items-center gap-1",onClick:Re,children:[a.jsx(A2,{className:"h-3 w-3"}),a.jsx("span",{children:'Limpar tag "Novo"'})]})]})]})]}),a.jsx("div",{children:fr.length===0?a.jsxs("div",{className:"p-10 text-center text-text-secondary",children:[a.jsx("p",{className:"text-lg mb-3",children:"Nenhum produto cadastrado."}),a.jsxs(me,{onClick:ar,children:[a.jsx(ns,{className:"mr-2 h-4 w-4"}),"Cadastrar primeiro produto"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden p-3 space-y-3",children:fr.map(be=>{const dt=l.includes(be.id);return a.jsxs("div",{className:gr("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer",dt?"border-brand/70 bg-brand/5":"border-border"),onClick:()=>pr(be),children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsx("button",{type:"button",className:"pt-1 pr-2 -ml-1 flex items-center justify-center w-9 h-9",onClick:Lt=>{Lt.stopPropagation(),yr(be.id)},children:a.jsx(Ha,{checked:dt,className:"h-5 w-5 border-2"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",title:be.name,children:be.name}),be.dataImportacao&&(()=>Math.floor((new Date-be.dataImportacao)/864e5)<=7?a.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Novo"})]}):null)()]}),a.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:be.category||"Sem categoria"})]}),a.jsx("span",{className:gr("inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0",be.status==="active"&&"bg-emerald-50/5 border-emerald-500/30 text-emerald-400",be.status==="low_stock"&&"bg-amber-50/5 border-amber-500/30 text-amber-400",be.status==="inactive"&&"bg-surface-2 border-border text-text-muted"),children:be.status==="active"?"Ativo":be.status==="low_stock"?"Estoque Baixo":"Inativo"})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-text-muted",children:[be.code&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"Cd."}),a.jsx("span",{className:"font-mono text-text-primary text-xs",children:be.code})]}),a.jsx("span",{className:"mx-1 text-text-muted",children:""}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"R$"}),a.jsx("span",{className:"font-semibold text-text-primary",children:be.price.toFixed(2)})]}),a.jsx("span",{className:"mx-1 text-text-muted",children:""}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"Est."}),a.jsx("span",{className:"font-medium text-text-primary",children:be.stock})]}),be.validade&&a.jsx("span",{className:"mx-1 text-text-muted",children:""}),be.validade&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"Val."}),a.jsx("span",{className:"text-text-primary",children:(()=>{const Lt=be.validade instanceof Date?be.validade:F6(String(be.validade));return isNaN(Lt)?"-":ur(Lt,"dd/MM/yy")})()})]}),a.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[a.jsx(me,{variant:"outline",size:"icon",onClick:Lt=>{Lt.stopPropagation(),pr(be)},className:"h-7 w-7",children:a.jsx(xl,{className:"h-3.5 w-3.5"})}),a.jsx(me,{variant:"outline",size:"icon",onClick:Lt=>{Lt.stopPropagation(),it(be)},className:"h-7 w-7 text-danger hover:text-danger",children:a.jsx(zu,{className:"h-3.5 w-3.5"})})]})]})]},be.id)})}),a.jsx("div",{className:"hidden md:block rounded-lg border border-border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm bg-surface table-fixed",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{className:"border-b border-border",children:[a.jsx("th",{className:"p-3 w-10 text-center",children:a.jsx(Ha,{checked:fr.length>0&&fr.every(be=>l.includes(be.id)),onCheckedChange:be=>Pn(!!be)})}),a.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[110px]",onClick:()=>Ut("code"),children:["Cdigo ",W.by==="code"?W.dir==="asc"?"":"":""]}),a.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[40%]",onClick:()=>Ut("name"),children:["Produto ",W.by==="name"?W.dir==="asc"?"":"":""]}),a.jsx("th",{className:"p-3 text-left font-semibold whitespace-nowrap w-[18%]",children:"Categoria"}),a.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[120px]",children:"Preo"}),a.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[110px]",children:"Estoque"}),a.jsxs("th",{className:"p-3 text-center font-semibold select-none cursor-pointer whitespace-nowrap w-[120px]",onClick:()=>Ut("validade"),children:["Validade ",W.by==="validade"?W.dir==="asc"?"":"":""]}),a.jsx("th",{className:"p-3 text-center font-semibold whitespace-nowrap w-[140px]",children:"Status"}),a.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[90px]",children:"Aes"})]})}),a.jsx("tbody",{className:"text-text-primary divide-y divide-border",children:fr.map(be=>a.jsxs("tr",{className:"hover:bg-surface-2 transition-colors group cursor-pointer align-middle",children:[a.jsx("td",{className:"p-3 text-center align-middle",children:a.jsx(Ha,{checked:l.includes(be.id),onCheckedChange:()=>yr(be.id)})}),a.jsx("td",{className:"p-3 font-mono text-sm text-text-secondary align-middle whitespace-nowrap",onClick:()=>pr(be),children:be.code||"-"}),a.jsx("td",{className:"p-3 font-semibold align-middle text-text-primary whitespace-nowrap overflow-hidden text-ellipsis",onClick:()=>pr(be),title:be.name,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"truncate",children:be.name}),be.dataImportacao&&(()=>Math.floor((new Date-be.dataImportacao)/864e5)<=7?a.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Novo"})]}):null)()]})}),a.jsx("td",{className:"p-3 text-text-secondary align-middle whitespace-nowrap",onClick:()=>pr(be),children:be.category}),a.jsxs("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>pr(be),children:["R$ ",be.price.toFixed(2)]}),a.jsx("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>pr(be),children:be.stock}),a.jsx("td",{className:"p-3 text-center font-mono tabular-nums whitespace-nowrap",onClick:()=>pr(be),children:(()=>{if(!be.validade)return"-";const dt=be.validade instanceof Date?be.validade:F6(String(be.validade));return isNaN(dt)?"-":ur(dt,"dd/MM/yy")})()}),a.jsx("td",{className:"p-3 text-center whitespace-nowrap",onClick:()=>pr(be),children:a.jsx("span",{className:gr("px-2 py-1 text-xs font-bold rounded-full",be.status==="active"&&"bg-success/10 text-success",be.status==="low_stock"&&"bg-warning/10 text-warning",be.status==="inactive"&&"bg-danger/10 text-danger"),children:be.status==="active"?"Ativo":be.status==="low_stock"?"Estoque Baixo":"Inativo"})}),a.jsx("td",{className:"p-3 whitespace-nowrap",children:a.jsx("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(me,{variant:"ghost",size:"icon",className:"h-8 w-8 text-text-muted hover:text-danger",onClick:dt=>{dt.stopPropagation(),it(be)},children:a.jsx(zu,{size:14})})})})]},be.id))})]})})]})}),fe&&a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted px-3 sm:px-4 pb-3",children:[a.jsxs("span",{children:["Pgina ",Z," de ",It," (",ie," produto(s))"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(me,{type:"button",variant:"outline",size:"sm",onClick:()=>ce(be=>Math.max(1,be-1)),disabled:Z<=1,children:"Anterior"}),a.jsx(me,{type:"button",variant:"outline",size:"sm",onClick:()=>ce(be=>Math.min(It,be+1)),disabled:Z>=It,children:"Prxima"})]})]})]})]}),a.jsx(bst,{open:g,onOpenChange:y,product:m,categories:o,onSave:xt,onCreateCategory:Qt,suggestedCode:m?void 0:d,onRefreshProducts:ue,products:n}),a.jsx(xn,{open:D,onOpenChange:I,children:a.jsxs(vn,{className:"sm:max-w-[480px]",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Excluir produto"}),a.jsxs(Dn,{children:["Tem certeza que deseja excluir o produto",U?` "${U.name}"`:"","? Esta ao no pode ser desfeita."]})]}),a.jsxs(ra,{children:[a.jsx(lh,{asChild:!0,children:a.jsx(me,{type:"button",variant:"secondary",disabled:R,children:"Cancelar"})}),a.jsx(me,{type:"button",variant:"destructive",onClick:kt,disabled:R,children:R?"Excluindo...":"Excluir"})]})]})}),a.jsx(pst,{open:gt,onOpenChange:Pt,products:n,codigoEmpresa:t?.codigo_empresa,onSuccess:()=>{ue(),Pt(!1)}}),a.jsx(xn,{open:Ze,onOpenChange:Ne,children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-[420px]",children:[a.jsx(pn,{children:a.jsx(un,{className:"text-base",children:"Filtros de Produtos"})}),a.jsxs("div",{className:"space-y-3 py-2 text-xs",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Le,{className:"text-xs",children:"Tipo"}),a.jsxs(Nn,{value:P.type,onValueChange:be=>Ct("type",be),children:[a.jsx(bn,{className:"text-xs",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Todos"}),a.jsx(tt,{value:"Venda",children:"Venda"}),a.jsx(tt,{value:"Uso Interno",children:"Uso Interno"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Le,{className:"text-xs",children:"Categoria"}),a.jsxs(Nn,{value:P.category,onValueChange:be=>Ct("category",be),children:[a.jsx(bn,{className:"text-xs",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Todas"}),o.map(be=>a.jsx(tt,{value:be,children:be},be))]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Le,{className:"text-xs",children:"Status"}),a.jsxs(Nn,{value:P.status,onValueChange:be=>Ct("status",be),children:[a.jsx(bn,{className:"text-xs",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Todos"}),a.jsx(tt,{value:"active",children:"Ativo"}),a.jsx(tt,{value:"low_stock",children:"Estoque Baixo"}),a.jsx(tt,{value:"inactive",children:"Inativo"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[a.jsx(Ha,{id:"mobileNewOnly",checked:!!P.newOnly,onCheckedChange:be=>Ct("newOnly",!!be)}),a.jsx(Le,{htmlFor:"mobileNewOnly",className:"text-xs flex items-center gap-1",children:a.jsx("span",{children:"Somente Novos"})})]})]}),a.jsxs(ra,{className:"flex justify-between mt-2",children:[a.jsx(me,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:()=>{E({type:"all",category:"all",status:"active",newOnly:!1}),Ne(!1)},children:"Limpar"}),a.jsx(me,{type:"button",size:"sm",className:"text-xs",onClick:()=>Ne(!1),children:"Aplicar"})]})]})}),a.jsx(jst,{open:x,onOpenChange:b,categories:o,onAddCategory:Qt,onRemoveCategory:ct})]})}function Nst({purchase:e,items:t,onClose:r,onEdit:n,onReprocess:s,onDownloadXML:o,onInactivate:i}){if(!e)return null;const l=t.reduce((d,u)=>d+Number(u.valor_total||0),0),c=d=>d?.data_importacao?Cwe(new Date,new Date(d.data_importacao))<=7:!1;return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-3 py-4 bg-black/60 backdrop-blur-sm",children:a.jsxs("div",{className:"relative w-[95vw] sm:w-full sm:max-w-4xl max-h-[85vh] bg-surface rounded-xl shadow-2xl border border-border overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"relative bg-surface border-b border-border p-4",children:[a.jsx("button",{onClick:r,className:"absolute top-3 right-3 p-1.5 hover:bg-surface-2 rounded-lg transition-colors",children:a.jsx(el,{className:"h-4 w-4 text-text-muted"})}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4 pr-0 sm:pr-10",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"p-2 bg-brand/10 rounded-lg",children:a.jsx(Go,{className:"h-5 w-5 text-brand"})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-bold text-text-primary mb-0.5",children:["NF-e ",e.numero_nfe,e.serie_nfe&&` / Srie ${e.serie_nfe}`]}),a.jsx("p",{className:"text-text-muted text-xs",children:e.natureza_operacao||"Nota Fiscal Eletrnica"})]})]}),a.jsxs("div",{className:"mt-3 sm:mt-0 sm:text-right",children:[a.jsx("p",{className:"text-text-muted text-xs mb-0.5",children:"Valor Total"}),a.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-success whitespace-nowrap",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-6",children:a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-surface-2 rounded-lg border border-border p-4",children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.jsx(Du,{className:"h-4 w-4 text-brand"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs font-medium text-text-muted mb-0.5",children:"Fornecedor"}),a.jsx("p",{className:"font-semibold text-base text-text-primary leading-snug break-words",children:e.fornecedor?.nome||"No identificado"}),e.fornecedor?.cnpj&&a.jsxs("p",{className:"text-xs text-text-muted mt-0.5",children:["CNPJ: ",e.fornecedor.cnpj]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Vs,{className:"h-3.5 w-3.5 text-info"}),a.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Emisso"})]}),a.jsx("p",{className:"font-semibold text-text-primary",children:e.data_emissao?ur(new Date(e.data_emissao),"dd/MM/yyyy",{locale:la}):"No informada"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(zue,{className:"h-3.5 w-3.5 text-warning"}),a.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Operao"})]}),a.jsx("p",{className:"font-semibold text-text-primary",children:e.tipo_operacao||"Entrada"})]}),e.forma_pagamento&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Um,{className:"h-3.5 w-3.5 text-success"}),a.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Pagamento"})]}),a.jsx("p",{className:"font-semibold text-text-primary",children:e.forma_pagamento})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor dos Produtos"}),a.jsxs("p",{className:"font-semibold text-text-primary",children:["R$ ",l.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor Total NF-e"}),a.jsxs("p",{className:"font-semibold text-brand",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-base font-semibold text-text-primary flex items-center gap-2 mb-3",children:[a.jsx(Sd,{className:"h-4 w-4 text-brand"}),"Produtos da NF-e",a.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-brand/10 text-brand font-medium ml-2",children:t.length})]}),a.jsx("div",{className:"space-y-2",children:t.map((d,u)=>a.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border hover:border-brand/30 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center mt-0.5",children:u+1}),a.jsxs("div",{className:"flex-1",children:[d.produto?.nome?a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"font-medium text-base text-text-primary mb-0.5",children:["Produto atual: ",d.produto.nome]}),d.nome_produto_xml&&a.jsxs("p",{className:"text-xs text-text-muted mb-1",children:["XML original: ",a.jsx("span",{className:"font-medium text-text-primary",children:d.nome_produto_xml})]})]}):a.jsx("p",{className:"font-medium text-sm text-text-primary mb-1",children:d.nome_produto_xml}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-text-muted mb-1.5",children:[(d.produto?.codigo_produto||d.codigo_produto_xml)&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"Cd:"})," ",d.produto?.codigo_produto||d.codigo_produto_xml]}),d.ean_xml&&d.ean_xml!=="SEM GTIN"&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"EAN:"})," ",d.ean_xml]}),d.ncm_xml&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"NCM:"})," ",d.ncm_xml]}),d.unidade_xml&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"Un:"})," ",d.unidade_xml]}),d.produto&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-success/20 text-success font-medium",children:" Cadastrado"}),d.produto&&c(d.produto)&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand font-medium",children:[a.jsx(nI,{className:"h-3 w-3"}),"Novo"]}),d.vinculado_manualmente&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-warning/20 text-warning font-medium",children:" Vinculado"}),!d.produto&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-text-muted/20 text-text-muted font-medium",children:" No importado"})]})]})]})}),a.jsxs("div",{className:"flex-shrink-0 text-right",children:[a.jsxs("div",{className:"mb-1.5",children:[a.jsx("span",{className:"text-xs text-text-muted mr-1",children:"Qtd:"}),a.jsx("span",{className:"font-bold text-base text-warning",children:d.quantidade})]}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: ",a.jsxs("span",{className:"font-semibold text-success",children:["R$ ",Number(d.valor_unitario||0).toFixed(2)]})]}),a.jsxs("p",{className:"text-sm font-bold text-text-primary",children:["Total: R$ ",Number(d.valor_total||0).toFixed(2)]})]})]})]})},u))})]}),e.chave_nfe&&a.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("p",{className:"text-xs font-medium text-text-muted mb-1.5 flex items-center gap-1.5",children:[a.jsx(Go,{className:"h-3 w-3"}),"Chave de Acesso NF-e:"]}),a.jsx("p",{className:"font-mono text-xs text-text-primary break-all leading-relaxed select-all",children:e.chave_nfe})]})]})}),a.jsxs("div",{className:"p-3 sm:p-4 bg-surface-2 border-t border-border flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[a.jsx("div",{className:"flex flex-wrap gap-2",children:e.ativo&&a.jsxs(a.Fragment,{children:[a.jsxs(me,{onClick:()=>n?.(e),size:"sm",variant:"outline",className:"gap-2",children:[a.jsx(xl,{className:"h-4 w-4"}),"Editar"]}),a.jsxs(me,{onClick:()=>s?.(e),size:"sm",variant:"outline",className:"gap-2",disabled:!e.xml_completo,children:[a.jsx($p,{className:"h-4 w-4"}),"Reprocessar"]}),e.xml_completo&&a.jsx(a.Fragment,{children:a.jsxs(me,{onClick:()=>o?.(e),size:"sm",variant:"outline",className:"gap-2",children:[a.jsx(ho,{className:"h-4 w-4"}),"XML"]})}),a.jsxs(me,{onClick:()=>i?.(e),size:"sm",variant:"outline",className:"gap-2 text-destructive hover:text-destructive",children:[a.jsx(zu,{className:"h-4 w-4"}),"Inativar"]})]})}),a.jsx(me,{onClick:r,variant:"outline",className:"w-full sm:w-auto",children:"Fechar"})]})]})})}function Sst({open:e,onOpenChange:t,purchase:r,products:n,codigoEmpresa:s,onSuccess:o,autoFile:i}){const{toast:l}=as(),[c,d]=p.useState("upload"),[u,f]=p.useState(null),[h,m]=p.useState(null),[v,g]=p.useState([]),[y,x]=p.useState(!1),[b,w]=p.useState({created:0,updated:0,errors:0,details:[]}),[j,_]=p.useState({}),[C,P]=p.useState({}),[E,A]=p.useState({}),[F,D]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[I,R]=p.useState({isOpen:!1}),M=()=>{const Z=h?.nfe?.modelo||r?.modelo_nfe;return Z==="55"?"NF-e":Z==="65"?"NFC-e":"NF-e / NFC-e"},U=(Z,ce,le)=>j[Z]?.[ce]??le,z=(Z,ce)=>!Z||!ce?0:Z*(1+ce/100),W=Z=>{P(ce=>({...ce,[Z]:!ce[Z]}))},$=(Z,ce,le)=>{console.log("[XMLReprocessModal] handleEditProduct chamado:",{index:Z,field:ce,value:le}),_(ie=>{const te={...ie,[Z]:{...ie[Z],[ce]:le}};return console.log("[XMLReprocessModal] Novo estado editedProducts:",te),te})},ee=Z=>{g(ce=>ce.map((le,ie)=>{if(ie===Z){const te=!le.selected;return A(ue=>({...ue,[Z]:te})),{...le,selected:te}}return le}))},ve=(Z,ce)=>{console.log("[XMLReprocessModal] handleLinkProduct chamado:",{index:Z,productId:ce}),console.log("[XMLReprocessModal] Estado editedProducts antes:",j[Z]),$(Z,"linkedProductId",ce),console.log("[XMLReprocessModal] Estado editedProducts depois:",{...j,[Z]:{...j[Z],linkedProductId:ce}})};p.useEffect(()=>{i&&e&&_e(i)},[i,e]);const _e=async Z=>{f(Z);try{console.log("[XMLReprocess] Processando arquivo automtico..."),console.log("[XMLReprocess] Purchase data:",r);const le=await Z.text();console.log("[XMLReprocess] XML content length:",le.length);const ie=PS(le);if(!ie.success){l({title:"Erro ao ler XML",description:ie.error||"XML invlido",variant:"destructive"});return}console.log("[XMLReprocess] Dados parseados:",ie.data),console.log("[XMLReprocess] Produtos encontrados:",ie.data?.produtos?.length||0),console.log("[XMLReprocess] Comparando chaves:",{xmlChave:ie.data?.nfe?.chaveAcesso,purchaseChave:r?.chave_nfe,match:ie.data?.nfe?.chaveAcesso===r?.chave_nfe}),m(ie.data);const te=await Ose(r.id);console.log("[XMLReprocess] Itens da compra original:",te.length);const ue=ie.data?.produtos?.map((ne,de)=>{const lt=ES(ne,n),Nt=!lt,at=te.find(yt=>ne.codigo&&yt.codigo_produto_xml?yt.codigo_produto_xml===ne.codigo:yt.nome_produto_xml===ne.nome),gt=!!at,Pt=at?.selecionado_na_importacao||!1;return console.log(`[XMLReprocess] Produto ${de+1}: ${ne.nome}`),console.log(`  - Cdigo XML: ${ne.codigo}`),console.log("  - originalItem encontrado:",at?`${at.nome_produto_xml} (cdigo: ${at.codigo_produto_xml})`:"NO ENCONTRADO"),console.log(`  - wasImported: ${gt}`),console.log(`  - wasSelectedInOriginalImport: ${Pt}`),{index:de,xml:ne,existing:lt,isNew:Nt,wasImported:gt,selected:E[de]!==void 0?E[de]:gt}})||[];console.log("[XMLReprocess] Preview preparado:",ue.length,"produtos"),console.log("[XMLReprocess] Produtos marcados:",ue.filter(ne=>ne.selected).length),console.log("[XMLReprocess] Produtos importados originalmente:",ue.filter(ne=>ne.wasImported).length),console.log("[XMLReprocess] Items da compra original detalhado:"),te.forEach((ne,de)=>{console.log(`  ${de+1}. ${ne.nome_produto_xml} (cdigo: ${ne.codigo_produto_xml}) - selecionado_na_importacao: ${ne.selecionado_na_importacao}`)}),g(ue);const Te={};ue.forEach((ne,de)=>{ne.xml.precoVenda&&(Te[de]={salePrice:Number(ne.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Te),_(Te),d("preview")}catch(le){console.error("[XMLReprocess] Erro ao processar arquivo automtico:",le),l({title:"Erro",description:"Erro ao processar o XML salvo.",variant:"destructive"})}},K=async Z=>{const ce=Z.target.files?.[0];if(!ce){console.log("[XMLReprocess] Nenhum arquivo selecionado");return}if(console.log("[XMLReprocess] Arquivo selecionado:",ce.name),!ce.name.endsWith(".xml")){l({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}f(ce);try{console.log("[XMLReprocess] Lendo contedo do arquivo...");const le=await ce.text();console.log("[XMLReprocess] Arquivo lido, parseando XML...");const ie=PS(le);if(console.log("[XMLReprocess] XML parseado:",ie),!ie.success){l({title:"Erro ao ler XML",description:ie.error||"XML invlido",variant:"destructive"});return}if(!ie.data?.produtos||ie.data.produtos.length===0){l({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(ie.data?.nfe?.chaveAcesso!==r?.chave_nfe){l({title:"XML incompatvel",description:"Este XML no corresponde  NF-e selecionada. Verifique a chave de acesso.",variant:"destructive"});return}m(ie.data);let te=n;try{te=await hu({search:"",codigoEmpresa:s,includeInactive:!0})||n,console.log("[XMLReprocess] Produtos carregados para validao:",te.length)}catch(ne){console.warn("[XMLReprocess] No foi possvel carregar lista completa, usando cache:",ne)}const ue=ie.data.produtos.map((ne,de)=>{const lt=ES(ne,te);return{xml:ne,existing:lt,isNew:!lt,willCreate:!lt,willUpdate:!!lt,selected:!0,index:de}});g(ue);const Te={};ue.forEach((ne,de)=>{ne.xml.precoVenda&&(Te[de]={salePrice:Number(ne.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Te),_(Te),console.log("[XMLReprocess] Preview preparado, mudando para step preview. Total produtos:",ue.length),d("preview")}catch(le){console.error("[XMLReprocess] Erro ao processar arquivo:",le),l({title:"Erro",description:"Erro ao processar o arquivo XML.",variant:"destructive"})}},q=()=>{R({isOpen:!0})},Y=async()=>{if(R({isOpen:!1}),!h||!r){l({title:"Erro",description:"Dados insuficientes para reprocessamento.",variant:"destructive"});return}x(!0),d("processing");const Z={created:0,updated:0,removed:0,errors:0,details:[]},ce=v.filter(ie=>ie.selected),le=v.filter(ie=>!ie.selected);console.log("[XMLReprocess] Iniciando reprocessamento para compra:",r.id),console.log("[XMLReprocess] Produtos selecionados:",ce.length),console.log("[XMLReprocess] Produtos desmarcados:",le.length);try{for(const ie of le){const ue=(j[ie.index]||{}).name||ie.xml.nome,Te=Number(ie.xml.quantidade);try{if(ie.isNew){const ne=ie.existing;ne&&(await IR(ne.id),Z.removed++,Z.details.push({produto:ue,acao:"Produto removido (era novo e foi desmarcado)",status:"success"}))}else{const ne=ie.existing;ne&&Te>0&&(await ix({productId:ne.id,delta:-Te,codigoEmpresa:r.codigo_empresa}),Z.updated++,Z.details.push({produto:ue,acao:`Estoque revertido -${Te}`,status:"success"}))}}catch(ne){console.error(`[XMLReprocess] Erro ao processar produto desmarcado: ${ue}`,ne),Z.errors++,Z.details.push({produto:ue,acao:`Erro ao reverter: ${ne.message}`,status:"error"})}}for(const ie of ce){const te=j[ie.index]||{},ue=te.name||ie.xml.nome,Te=te.qty!==void 0?te.qty:Number(ie.xml.quantidade),ne=te.margin,de=te.salePrice,lt=te.linkedProductId;try{if(ie.isNew&&(!lt||lt==="new")){const Nt=JT(ie.xml,r.codigo_empresa);if(ue&&(Nt.name=ue),de!=null)Nt.salePrice=de,Nt.price=de;else if(ne!=null&&ne>0){const gt=Nt.costPrice||0;if(gt>0){const Pt=gt*(1+ne/100);Nt.salePrice=Pt,Nt.price=Pt}}else Nt.salePrice!=null&&Nt.price==null&&(Nt.price=Nt.salePrice);const at=await AS(Nt,{codigoEmpresa:r.codigo_empresa});Te>0&&await ix({productId:at.id,delta:Te,codigoEmpresa:r.codigo_empresa}),Z.created++,Z.details.push({produto:ue,acao:Te>0?`Criado com estoque ${Te}`:"Criado",status:"success"})}else{const Nt=lt&&lt!=="force-new"&&lt!=="new"?n.find(at=>at.id===lt):ie.existing;if(te.updatePrice&&Nt){const at=Number(ie.xml.valorUnitario)||0,gt={};if(at>0&&(gt.costPrice=at),de!=null)gt.salePrice=de,gt.price=de;else if(ne!=null&&ne>0&&at>0){const Pt=at*(1+ne/100);gt.salePrice=Pt,gt.price=Pt}await Zw(Nt.id,gt)}Z.updated++,Z.details.push({produto:ue,acao:te.updatePrice?"Preo atualizado":"Mantido sem alteraes",status:"success"})}}catch(Nt){console.error(`[XMLReprocess] Erro ao processar produto: ${ue}`,Nt),Z.errors++,Z.details.push({produto:ue,acao:`Erro: ${Nt.message}`,status:"error"})}}}catch(ie){console.error("[XMLReprocess] Erro geral no reprocessamento:",ie),Z.errors++,Z.details.push({produto:"Sistema",acao:`Erro geral: ${ie.message}`,status:"error",error:ie.message})}try{const ie=ce.map(te=>{const ue=j[te.index]||{},Te=ue.linkedProductId;let ne=null;return Te&&Te!=="force-new"?ne=Te:!te.isNew&&Te!=="force-new"&&(ne=te.existing?.id||null),{produtoId:ne,codigoProdutoXML:te.xml.codigo,nomeProdutoXML:te.xml.nome,eanXML:te.xml.ean,ncmXML:te.xml.ncm,cfopXML:te.xml.cfop,unidadeXML:te.xml.unidade,quantidade:ue.qty!==void 0?ue.qty:Number(te.xml.quantidade),valorUnitario:Number(te.xml.valorUnitario)||0,valorTotal:Number(te.xml.valorTotal)||0,vinculadoManualmente:!!Te&&Te!=="force-new"}});await mst(r.id,ie),console.log("[XMLReprocess] Itens reprocessados:",ie.length)}catch(ie){console.error("[XMLReprocess] Erro ao reprocessar itens da compra:",ie),Z.errors++,Z.details.push({produto:"Itens da NF-e",acao:"Erro ao reprocessar",status:"error",error:ie.message})}w(Z),x(!1),d("done"),Z.errors===0?l({title:"Reprocessamento concludo!",description:`${Z.created} produto(s) criado(s), ${Z.updated} atualizado(s).`,variant:"success"}):l({title:"Reprocessamento com erros",description:`${Z.errors} erro(s) encontrado(s). Verifique os detalhes.`,variant:"destructive"}),o&&o()};p.useEffect(()=>{e||(d("upload"),f(null),m(null),g([]),_({}),P({}),w({created:0,updated:0,errors:0,details:[]}),x(!1),A({}))},[e]);const J=()=>{t(!1)},fe=v.filter(Z=>Z.selected).length;return a.jsxs(xn,{open:e,onOpenChange:J,children:[a.jsxs(vn,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] overflow-hidden flex flex-col",children:[a.jsxs(pn,{children:[a.jsxs(un,{className:"flex items-center gap-2",children:[a.jsx($p,{className:"h-5 w-5"}),a.jsx("span",{children:"Reprocessar XML"}),a.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:M()}),a.jsx("span",{className:"text-sm text-text-muted",children:r?.numero_nfe})]}),a.jsx(Dn,{children:"Reimporte o XML para atualizar os produtos e itens desta NF-e. Os itens atuais sero substitudos pelos novos."})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[c==="upload"&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-8 text-center",children:[a.jsx(m4,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selecione o arquivo XML"}),a.jsxs("p",{className:"text-text-muted mb-4",children:["Faa upload do XML da NF-e ",r?.numero_nfe," para reprocessar os produtos"]}),a.jsx("input",{type:"file",accept:".xml",onChange:K,className:"hidden",id:"xml-reprocess-upload"}),a.jsx("label",{htmlFor:"xml-reprocess-upload",children:a.jsx(me,{asChild:!0,children:a.jsx("span",{children:"Selecionar XML"})})})]})}),c==="preview"&&h&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Informaes da NF-e"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",h.nfe.numero]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",h.nfe.serie]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Modelo:"})," ",M()]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",h.fornecedor?.nome]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Total:"})," R$ ",Number(h.nfe.totalNota||0).toFixed(2)]})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-semibold text-base",children:"Produtos Encontrados"}),a.jsxs("span",{className:"text-sm text-text-muted",children:[v.filter(Z=>Z.selected).length," de ",v.length," selecionados"]})]}),a.jsx("div",{className:"space-y-2",children:v.map((Z,ce)=>{const le=U(ce,"name",Z.xml.nome),ie=U(ce,"qty",Number(Z.xml.quantidade)),te=U(ce,"linkedProductId",null),ue=Z.xml.valorUnitario||0,Te=U(ce,"margin",null);let de=U(ce,"salePrice",null);de==null&&!Z.isNew&&Z.existing&&(de=Number(Z.existing.preco_venda||Z.existing.salePrice||Z.existing.price||0)),de==null&&Te!=null&&(de=z(ue,Te)),de==null&&Z.xml.precoVenda&&(de=Number(Z.xml.precoVenda));let lt=null;if(Te!=null)lt=Te;else if(de!=null&&ue>0&&de>0){const at=(de-ue)/ue*100;lt=Math.max(-999,Math.min(9999,at))}const Nt=C[ce];return a.jsxs("div",{className:gr("rounded-lg border transition-all",Z.selected?"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[a.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("input",{type:"checkbox",checked:Z.selected,onChange:()=>ee(ce),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),a.jsx("button",{onClick:()=>W(ce),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:Nt?a.jsx(wg,{className:"w-4 h-4 text-text-muted"}):a.jsx(c0,{className:"w-4 h-4 text-text-muted"})}),a.jsx("div",{children:te?a.jsx(qH,{className:"w-5 h-5 text-warning"}):a.jsx($p,{className:"w-5 h-5 text-info"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm truncate",children:te&&te!=="force-new"&&te!=="new"?(()=>{const at=n.find(gt=>gt.id===te);return at?at.name:le})():le}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[Z.xml.codigo&&a.jsxs("span",{className:"flex-shrink-0",children:["#",Z.xml.codigo]}),a.jsxs("span",{children:["Qtd: ",ie]})]})]}),a.jsx("div",{className:"flex-shrink-0 ml-2",children:te?a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-warning/20 text-warning font-medium",children:"Vinculado"}):a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),a.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[a.jsxs("span",{children:["R$ ",ue.toFixed(2),de?`  R$ ${de.toFixed(2)}`:""]}),lt!=null&&a.jsxs("span",{className:"ml-2 "+(lt>0?"text-success":lt<0?"text-destructive":"text-text-muted"),children:[lt.toFixed(1),"%"]})]})]})]}),Nt&&a.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),a.jsx("input",{type:"text",value:le,onChange:at=>$(ce,"name",at.target.value),disabled:!Z.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{type:"button",onClick:()=>$(ce,"qty",Math.max(0,ie-1)),disabled:!Z.selected||ie<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:a.jsx(Iv,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",value:ie,onChange:at=>{const gt=at.target.value.replace(/\D/g,"");$(ce,"qty",gt===""?0:Number(gt))},disabled:!Z.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),a.jsx("button",{type:"button",onClick:()=>$(ce,"qty",ie+1),disabled:!Z.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:a.jsx(ns,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:(()=>{const at=U(ce,"margin",null);return at!=null?String(at):""})(),onChange:at=>{const gt=at.target.value;if(gt===""){$(ce,"margin",null),$(ce,"salePrice",null);return}const Pt=gt.replace(/[^0-9.,\-]/g,"").replace(",",".");if(Pt==="."||Pt==="-"||Pt==="-.")return;const yt=parseFloat(Pt);if(!isNaN(yt)&&($(ce,"margin",yt),ue>0)){const Qe=z(ue,yt);$(ce,"salePrice",Qe)}},disabled:!Z.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),a.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),a.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:a.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",ue.toFixed(2)]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),a.jsx("input",{type:"text",value:(()=>{const at=U(ce,"salePrice",de);return at==null?"":Number(at).toFixed(2).replace(".",",")})(),onChange:at=>{const gt=at.target.value.replace(/\D/g,"");if(gt===""){$(ce,"salePrice",null);return}const Pt=Number(gt)/100;if($(ce,"salePrice",Pt),Pt>0&&ue>0){const yt=(Pt-ue)/ue*100;$(ce,"margin",Math.round(yt*100)/100)}},disabled:!Z.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[a.jsx("input",{type:"checkbox",id:`update-price-${ce}`,checked:U(ce,"updatePrice",!1),onChange:at=>$(ce,"updatePrice",at.target.checked),disabled:!Z.selected,className:"w-4 h-4 text-brand bg-surface border-border rounded focus:ring-brand focus:ring-2 disabled:opacity-50"}),a.jsx("label",{htmlFor:`update-price-${ce}`,className:"text-sm text-text-primary select-none cursor-pointer",children:"Atualizar preo do produto no sistema"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Vincular a Produto Existente (Opcional)"}),a.jsxs(Nn,{value:te==="force-new"?"force-new":te||(Z.isNew?"new":Z.existing?.id||"new"),onValueChange:at=>{at==="new"||at===Z.existing?.id?ve(ce,null):at==="search"?D({isOpen:!0,productIndex:ce,currentProduct:Z}):ve(ce,at)},disabled:!Z.selected,children:[a.jsx(bn,{className:"w-full hover:bg-white/5 transition-colors",children:a.jsx(Cn,{placeholder:Z.isNew?" Criar como novo produto":" Atualizar produto existente"})}),a.jsxs(wn,{className:"max-h-[300px] overflow-y-auto",children:[Z.isNew?a.jsx(tt,{value:"new",children:" Criar como novo produto"}):a.jsxs(tt,{value:Z.existing?.id||"new",children:[" Atualizar: ",Z.existing?.name," (Estoque atual: ",Z.existing?.stock||0,")"]}),!Z.isNew&&a.jsx(tt,{value:"force-new",children:" Criar como novo produto (ignorar existente)"}),a.jsx(tt,{value:"search",children:" Buscar produto para vincular..."})]})]})]})]})]},ce)})})]})]}),c==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(md,{className:"h-12 w-12 animate-spin text-brand mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Reprocessando XML..."}),a.jsx("p",{className:"text-text-muted",children:"Atualizando produtos e itens da NF-e"})]}),c==="done"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center py-6",children:[b.errors===0?a.jsx(Do,{className:"h-12 w-12 text-success mx-auto mb-4"}):a.jsx(Ic,{className:"h-12 w-12 text-warning mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:b.errors===0?"Reprocessamento Concludo!":"Reprocessamento com Erros"}),a.jsxs("div",{className:"text-text-muted",children:[b.created," produto(s) criado(s), ",b.updated," atualizado(s)",b.errors>0&&`, ${b.errors} erro(s)`]})]}),b.details.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-3",children:"Detalhes do Reprocessamento"}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:b.details.map((Z,ce)=>a.jsxs("div",{className:gr("flex items-center gap-3 p-2 rounded",Z.status==="success"?"bg-green-50 text-green-800":Z.status==="error"?"bg-red-50 text-red-800":"bg-gray-50 text-gray-800"),children:[Z.status==="success"?a.jsx(Do,{className:"h-4 w-4 flex-shrink-0"}):a.jsx(Ic,{className:"h-4 w-4 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:Z.produto}),a.jsx("div",{className:"text-xs",children:Z.acao}),Z.error&&a.jsx("div",{className:"text-xs mt-1 opacity-75",children:Z.error})]})]},ce))})]})]})]}),a.jsxs(ra,{children:[c==="upload"&&a.jsx(me,{variant:"outline",onClick:J,children:"Cancelar"}),c==="preview"&&a.jsxs(a.Fragment,{children:[a.jsx(me,{variant:"outline",onClick:()=>d("upload"),children:"Voltar"}),a.jsxs(me,{onClick:q,disabled:fe===0,children:["Reprocessar (",fe," produtos)"]})]}),c==="done"&&a.jsx(me,{onClick:J,children:"Fechar"})]})]}),a.jsx(Tse,{isOpen:F.isOpen,onClose:()=>D({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:Z=>{console.log("[XMLReprocessModal] onSelect chamado com produto:",Z),console.log("[XMLReprocessModal] Index do produto:",F.productIndex),ve(F.productIndex,Z.id),D({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:F.currentProduct}),a.jsx(Dse,{isOpen:I.isOpen,onClose:()=>R({isOpen:!1}),onConfirm:Y,products:v.map((Z,ce)=>({...Z,originalIndex:ce})),editedProducts:j,allProducts:n,isReprocess:!0})]})}const DU="comprasPage:settings";function Cst(){const{user:e,userProfile:t}=vs(),[r,n]=p.useState([]),[s,o]=p.useState(!0),[i,l]=p.useState(""),[c,d]=p.useState(null),[u,f]=p.useState([]),[h,m]=p.useState(!1),[v,g]=p.useState(()=>Sl(new Date)),[y,x]=p.useState(()=>AC(new Date)),[b,w]=p.useState("all"),[j,_]=p.useState(!0),[C,P]=p.useState(!1),[E,A]=p.useState("active"),[F,D]=p.useState({show:!1,purchase:null}),[I,R]=p.useState(""),[M,U]=p.useState({show:!1,purchase:null}),[z,W]=p.useState({}),[$,ee]=p.useState({show:!1,purchase:null}),[ve,_e]=p.useState([]),[K,q]=p.useState(!1),[Y,J]=p.useState(!1),[fe,Z]=p.useState("paged"),ce=fe==="paged",[le,ie]=p.useState(1),[te]=p.useState(100),[ue,Te]=p.useState(0),ne=ye=>{const Be=String(ye||"").replace(/\D/g,"");return(Be?Number(Be)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},de=ye=>{if(!ye.xml_completo){alert("XML no disponvel para esta NF-e");return}const Be=new Blob([ye.xml_completo],{type:"text/xml;charset=utf-8"}),mt=URL.createObjectURL(Be),Ft=document.createElement("a");Ft.href=mt,Ft.download=`${ye.chave_nfe}.xml`,document.body.appendChild(Ft),Ft.click(),document.body.removeChild(Ft),URL.revokeObjectURL(mt)},lt=async ye=>{if(!ye.xml_completo){alert("XML no disponvel para reprocessamento automtico");return}if(confirm("Deseja reprocessar esta NF-e? Isso substituir todos os itens atuais pelos dados do XML original."))try{console.log("[ComprasPage] Iniciando reprocessamento para purchase:",ye),console.log("[ComprasPage] Chave NF-e:",ye.chave_nfe),console.log("[ComprasPage] XML disponvel:",!!ye.xml_completo);const Be=new Blob([ye.xml_completo],{type:"text/xml"}),mt=new File([Be],`${ye.chave_nfe}.xml`,{type:"text/xml"});ee({show:!0,purchase:ye,autoFile:mt})}catch(Be){console.error("Erro no reprocessamento automtico:",Be),alert("Erro ao iniciar reprocessamento automtico")}},Nt=ye=>{if(!ye)return 0;const Be=String(ye).replace(/\./g,"").replace(",",".");return parseFloat(Be)||0};p.useEffect(()=>{try{const ye=localStorage.getItem(DU);if(!ye)return;const Be=JSON.parse(ye);Be&&typeof Be=="object"&&((Be.listMode==="paged"||Be.listMode==="all")&&Z(Be.listMode),typeof Be.showStats=="boolean"&&_(Be.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!e?.id||!t?.codigo_empresa)return;const Be=`compras:${t.codigo_empresa}`,mt=await Ese({userId:e.id,scope:Be});mt&&((mt.listMode==="paged"||mt.listMode==="all")&&Z(mt.listMode),typeof mt.showStats=="boolean"&&_(mt.showStats))})()},[e?.id,t?.codigo_empresa]),p.useEffect(()=>{try{const ye={listMode:fe,showStats:j};localStorage.setItem(DU,JSON.stringify(ye))}catch{}if(e?.id&&t?.codigo_empresa){const ye=`compras:${t.codigo_empresa}`;kse({userId:e.id,scope:ye,settings:{listMode:fe,showStats:j}})}},[fe,j,e?.id,t?.codigo_empresa]),p.useEffect(()=>{t?.codigo_empresa&&(gt(),at())},[t,E,b,v,y,le,fe]),p.useEffect(()=>{ie(1)},[E,b,v,y,fe]);const at=async()=>{try{const ye=await hu({codigoEmpresa:t.codigo_empresa});_e(ye||[])}catch(ye){console.error("[Compras] Erro ao carregar produtos:",ye)}},gt=async()=>{try{o(!0);let ye=null,Be=null;if(v){const Ut=new Date(v);Ut.setHours(0,0,0,0),ye=Ut.toISOString()}if(y){const Ut=new Date(y);Ut.setHours(23,59,59,999),Be=Ut.toISOString()}const fr={incluirInativas:E==="all"||E==="inactive",apenasInativas:E==="inactive",fornecedorId:b!=="all"?b:void 0,dataInicio:ye,dataFim:Be,page:ce?le:1,pageSize:ce?te:1e4},It=await dst(t.codigo_empresa,fr);n(It?.data||[]),Te(It?.count||0)}catch(ye){console.error("[Compras] Erro ao carregar compras:",ye)}finally{o(!1)}},Pt=async ye=>{d(ye),m(!0);try{const Be=await Ose(ye.id);f(Be||[])}catch(Be){console.error("[Compras] Erro ao carregar itens:",Be),f([])}finally{m(!1)}},yt=()=>{d(null),f([])},Qe=ye=>{U({show:!0,purchase:ye}),W({numeroNfe:ye.numero_nfe||"",serieNfe:ye.serie_nfe||"",dataEmissao:ye.data_emissao?ye.data_emissao.split("T")[0]:"",tipoOperacao:ye.tipo_operacao||"",naturezaOperacao:ye.natureza_operacao||"",valorProdutos:ne((ye.valor_produtos||0)*100),valorTotal:ne((ye.valor_total||0)*100),formaPagamento:ye.forma_pagamento||"",observacoes:ye.observacoes||""})},ge=async()=>{try{await hst(M.purchase.id,{...z,valorProdutos:Nt(z.valorProdutos),valorTotal:Nt(z.valorTotal),fornecedorId:M.purchase.fornecedor_id}),await gt(),U({show:!1,purchase:null}),W({}),console.log("Compra editada com sucesso!")}catch(ye){console.error("Erro ao editar compra:",ye)}},rt=p.useMemo(()=>{const ye=new Map;return r.forEach(Be=>{Be.fornecedor?.id&&ye.set(Be.fornecedor.id,Be.fornecedor)}),Array.from(ye.values())},[r]),pt=p.useMemo(()=>r.filter(ye=>{if(i){const Be=i.toLowerCase();if(!(ye.numero_nfe?.toLowerCase().includes(Be)||ye.fornecedor?.nome?.toLowerCase().includes(Be)||ye.chave_nfe?.toLowerCase().includes(Be)))return!1}return!0}),[r,i]),We=p.useMemo(()=>{const ye=pt.reduce((It,Ut)=>It+Number(Ut.valor_total||0),0),Be=pt.length,mt=Be>0?ye/Be:0,Ft={};pt.forEach(It=>{const Ut=It.fornecedor?.id||"unknown",xe=It.fornecedor?.nome||"No identificado";Ft[Ut]||(Ft[Ut]={name:xe,total:0,count:0}),Ft[Ut].total+=Number(It.valor_total||0),Ft[Ut].count+=1});const fr=Object.values(Ft).sort((It,Ut)=>Ut.total-It.total).slice(0,5);return{total:ye,count:Be,avgTicket:mt,topSuppliers:fr}},[pt]),Ze=p.useMemo(()=>{if(!te)return 1;const ye=Math.ceil((ue||0)/te);return ye>0?ye:1},[ue,te]),Ne=()=>{const ye=["NF-e","Serie","Data Emissao","Fornecedor","CNPJ","Tipo","Valor Total","Valor Produtos","Forma Pagamento"],Be=pt.map(It=>[It.numero_nfe||"",It.serie_nfe||"",It.data_emissao?ur(new Date(It.data_emissao),"dd/MM/yyyy"):"",(It.fornecedor?.nome||"").replace(/,/g," "),It.fornecedor?.cnpj||"",It.tipo_operacao||"",Number(It.valor_total||0).toFixed(2),Number(It.valor_produtos||0).toFixed(2),(It.forma_pagamento||"").replace(/,/g," ")]),mt=[ye,...Be].map(It=>It.join(";")).join(`
`),Ft=new Blob(["\uFEFF"+mt],{type:"text/csv;charset=utf-8;"}),fr=document.createElement("a");fr.href=URL.createObjectURL(Ft),fr.download=`compras_${ur(new Date,"yyyy-MM-dd")}.csv`,fr.click()};return a.jsxs("div",{className:"px-3 py-4 md:p-6 max-w-7xl mx-auto",children:[a.jsx("div",{className:"mb-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3 md:gap-4 mb-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:"Compras (NF-e)"}),a.jsx(me,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>J(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:a.jsx(bd,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex flex-row flex-wrap items-end gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-[140px]",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Inicial"}),a.jsxs(ci,{modal:!0,children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[a.jsx(Vs,{className:"mr-2 h-4 w-4"}),v?ur(v,"dd/MM/yyyy"):a.jsx("span",{children:"Selecionar"})]})}),a.jsx(Jo,{className:"w-auto p-0 z-50",align:"end",children:a.jsx(ui,{mode:"single",selected:v,onSelect:g,locale:la})})]})]}),a.jsxs("div",{className:"flex-1 min-w-[140px]",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Final"}),a.jsxs(ci,{modal:!0,children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[a.jsx(Vs,{className:"mr-2 h-4 w-4"}),y?ur(y,"dd/MM/yyyy"):a.jsx("span",{children:"Selecionar"})]})}),a.jsx(Jo,{className:"w-auto p-0 z-50",align:"end",children:a.jsx(ui,{mode:"single",selected:y,onSelect:x,locale:la})})]})]}),(v||y)&&a.jsx(me,{variant:"ghost",size:"sm",onClick:()=>{g(null),x(null)},className:"h-8 px-3 text-xs",children:"Limpar"})]})]})}),j&&pt.length>0&&a.jsxs("div",{className:"mb-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[a.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[a.jsx(Go,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"NF-es"})]}),a.jsx("p",{className:"text-lg md:text-2xl font-bold text-text-primary leading-none",children:We.count})]}),a.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[a.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[a.jsx(Ko,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Total"})]}),a.jsxs("p",{className:"text-base md:text-2xl font-bold text-success leading-none whitespace-nowrap",children:["R$ ",We.total.toFixed(2)]})]}),a.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[a.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[a.jsx(Du,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Fornec."})]}),a.jsx("p",{className:"text-lg md:text-2xl font-bold text-info leading-none",children:rt.length})]})]}),We.topSuppliers.length>0&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(Bj,{className:"h-4 w-4"}),"Top 5 Fornecedores"]}),a.jsx(me,{variant:"ghost",size:"sm",onClick:()=>P(!0),className:"text-xs",children:"Ver Todos"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:We.topSuppliers.map((ye,Be)=>{const mt=ye.total/We.total*100;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsx("span",{className:"text-text-primary font-medium truncate flex-1",title:ye.name,children:ye.name}),a.jsxs("span",{className:"text-text-muted text-xs ml-2 flex-shrink-0",children:["R$ ",ye.total.toFixed(2)]})]}),a.jsx("div",{className:"w-full bg-surface-2 rounded-full h-1.5",children:a.jsx("div",{className:"bg-brand rounded-full h-1.5 transition-all",style:{width:`${mt}%`}})})]},Be)})})]})]}),a.jsx("div",{className:"mb-6 space-y-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-4 md:flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2 w-full md:flex-1 md:min-w-[250px]",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar por NF-e, fornecedor ou chave...",value:i,onChange:ye=>l(ye.target.value),className:"pl-10"})]}),a.jsx(me,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>q(ye=>!ye),"aria-label":"Filtros",children:a.jsx(rI,{className:"h-4 w-4"})})]}),K&&a.jsxs("div",{className:"md:hidden mt-1 space-y-3 px-0.5",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Fornecedor"}),a.jsxs(Nn,{value:b,onValueChange:w,children:[a.jsxs(bn,{className:"w-full text-sm",children:[a.jsx(Du,{className:"h-4 w-4 mr-2 flex-shrink-0"}),a.jsx("div",{className:"truncate",children:a.jsx(Cn,{placeholder:"Todos"})})]}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Todos"}),rt.map(ye=>a.jsx(tt,{value:ye.id,children:a.jsx("div",{className:"truncate max-w-[220px]",title:ye.nome,children:ye.nome})},ye.id))]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Status"}),a.jsxs(Nn,{value:E,onValueChange:A,children:[a.jsx(bn,{className:"w-full text-sm",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"active",children:"Apenas ativas"}),a.jsx(tt,{value:"all",children:"Todas"}),a.jsx(tt,{value:"inactive",children:"Apenas inativas"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1 border-t border-border/60",children:[a.jsxs(me,{type:"button",variant:"ghost",size:"sm",className:"gap-2 text-xs px-2",onClick:()=>_(!j),children:[a.jsx(Bj,{className:"h-4 w-4"}),j?"Ocultar estatsticas":"Mostrar estatsticas"]}),a.jsxs(me,{type:"button",variant:"outline",size:"sm",onClick:Ne,disabled:pt.length===0,className:"gap-1 text-xs px-3",children:[a.jsx(ho,{className:"h-4 w-4"}),"CSV"]})]})]}),a.jsxs("div",{className:"hidden md:flex md:items-center md:gap-4 md:flex-wrap w-full",children:[a.jsxs(Nn,{value:b,onValueChange:w,children:[a.jsxs(bn,{className:"w-full md:w-[220px]",children:[a.jsx(Du,{className:"h-4 w-4 mr-2 flex-shrink-0"}),a.jsx("div",{className:"truncate",children:a.jsx(Cn,{placeholder:"Fornecedor"})})]}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Todos"}),rt.map(ye=>a.jsx(tt,{value:ye.id,children:a.jsx("div",{className:"truncate max-w-[180px]",title:ye.nome,children:ye.nome})},ye.id))]})]}),a.jsxs(me,{variant:"outline",onClick:Ne,disabled:pt.length===0,className:"gap-2 w-full sm:w-auto justify-center",children:[a.jsx(ho,{className:"h-4 w-4"}),"Exportar CSV"]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(me,{variant:"ghost",size:"sm",onClick:()=>_(!j),className:"gap-2",children:[a.jsx(Bj,{className:"h-4 w-4"}),j?"Ocultar":"Mostrar"]}),a.jsxs(Nn,{value:E,onValueChange:A,children:[a.jsx(bn,{className:"w-[140px]",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"active",children:"Apenas ativas"}),a.jsx(tt,{value:"all",children:"Todas"}),a.jsx(tt,{value:"inactive",children:"Apenas inativas"})]})]})]})]})]})}),s?a.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-border",children:[a.jsx(Sd,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),a.jsx("p",{className:"text-text-muted",children:i?"Nenhuma compra encontrada":"Nenhuma NF-e importada ainda"}),a.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Importe XMLs de NF-e na pgina de Produtos"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid gap-3",children:pt.map(ye=>a.jsx("div",{className:`rounded-lg border overflow-hidden transition-all hover:shadow-lg ${ye.ativo===!1?"bg-gray-900/60 border-red-500 shadow-red-500/20":"bg-surface border-border hover:border-brand/50"}`,onClick:()=>Pt(ye),children:a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",children:a.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx(Go,{className:"h-6 w-6 text-brand mt-0.5 flex-shrink-0"}),a.jsx("div",{className:"min-w-0",children:a.jsxs("h3",{className:`font-semibold text-sm md:text-base leading-snug ${ye.ativo===!1?"text-red-600":"text-text-primary"}`,children:["NF-e ",ye.numero_nfe," / Srie ",ye.serie_nfe,ye.ativo===!1&&a.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 bg-red-100 text-red-700 text-[10px] rounded-full font-medium align-middle",children:"INATIVA"})]})})]}),a.jsx("div",{className:"sm:hidden flex items-center",children:a.jsxs("span",{className:"text-success font-semibold text-xs whitespace-nowrap pr-2",children:["R$ ",Number(ye.valor_total||0).toFixed(2)]})})]}),a.jsxs("div",{className:"space-y-2.5",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx(Du,{className:"h-5 w-5 flex-shrink-0 text-brand"}),a.jsx("span",{className:"font-medium text-text-primary text-sm md:text-base overflow-hidden truncate",title:ye.fornecedor?.nome||"Fornecedor no identificado",children:ye.fornecedor?.nome||"Fornecedor no identificado"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1.5 text-xs md:text-sm text-text-muted",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Vs,{className:"h-4 w-4"}),a.jsx("span",{children:ye.data_emissao?ur(new Date(ye.data_emissao),"dd/MM/yyyy",{locale:la}):"Data no informada"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Sd,{className:"h-4 w-4"}),a.jsx("span",{children:ye.tipo_operacao||"Entrada"})]}),ye.chave_nfe&&a.jsxs("div",{className:"text-[10px] md:text-xs max-w-[180px] md:max-w-xs overflow-hidden whitespace-nowrap truncate",children:[a.jsx("span",{className:"font-medium",children:"Chave:"})," ",ye.chave_nfe.length>20?ye.chave_nfe.slice(0,20)+"...":ye.chave_nfe]})]}),ye.natureza_operacao&&a.jsx("p",{className:"text-[10px] md:text-xs text-text-muted overflow-hidden whitespace-nowrap truncate",title:ye.natureza_operacao,children:ye.natureza_operacao})]})]}),a.jsxs("div",{className:"hidden sm:flex sm:flex-col sm:gap-3 sm:mt-0 sm:w-auto",children:[a.jsx("div",{className:"w-full flex justify-end",children:a.jsxs("div",{className:"text-right text-text-muted",children:[a.jsxs("span",{className:"text-success font-semibold text-base md:text-lg whitespace-nowrap",children:["R$ ",Number(ye.valor_total||0).toFixed(2)]}),a.jsxs("p",{className:"text-[11px] md:text-xs mt-0.5",children:["Produtos: R$ ",Number(ye.valor_produtos||0).toFixed(2)]})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full justify-end",children:[a.jsxs(me,{onClick:Be=>{Be.stopPropagation(),Pt(ye)},size:"sm",className:"gap-2 w-full justify-center",children:[a.jsx(rg,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs sm:text-sm",children:"Detalhes"})]}),ye.ativo&&a.jsxs(me,{onClick:Be=>{Be.stopPropagation(),Qe(ye)},size:"sm",variant:"outline",className:"gap-2 w-full justify-center",children:[a.jsx(xl,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs sm:text-sm",children:"Editar"})]})]})]})]})})})},ye.id))}),ce&&a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted",children:[a.jsxs("span",{children:["Pgina ",le," de ",Ze," (",ue," NF-es)"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(me,{type:"button",variant:"outline",size:"sm",onClick:()=>ie(ye=>Math.max(1,ye-1)),disabled:le<=1,children:"Anterior"}),a.jsx(me,{type:"button",variant:"outline",size:"sm",onClick:()=>ie(ye=>Math.min(Ze,ye+1)),disabled:le>=Ze,children:"Prxima"})]})]})]}),a.jsx(xn,{open:Y,onOpenChange:J,children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-md max-h-[80vh] flex flex-col",children:[a.jsx(pn,{children:a.jsx(un,{children:"Configuraes de Compras"})}),a.jsxs("div",{className:"space-y-4 text-sm",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Modo de listagem"}),a.jsxs(Nn,{value:fe,onValueChange:Z,children:[a.jsx(bn,{className:"w-full h-9 text-sm",children:a.jsx(Cn,{placeholder:"Paginado"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"paged",children:"Paginado (100 por pgina)"}),a.jsx(tt,{value:"all",children:"Todos (sem paginao)"})]})]})]}),a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"compras-show-stats",checked:j,onCheckedChange:_}),a.jsx("label",{htmlFor:"compras-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de estatsticas"})]})})]})]})}),a.jsx(xn,{open:F.show,onOpenChange:ye=>D({show:ye,purchase:null}),children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-md",children:[a.jsx(pn,{children:a.jsx(un,{children:"Inativar NF-e"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-text-muted",children:["Tem certeza que deseja inativar a NF-e ",a.jsx("strong",{children:F.purchase?.numero_nfe}),"?"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Motivo da inativao:"}),a.jsx(Ye,{value:I,onChange:ye=>R(ye.target.value),placeholder:"Ex: NF-e duplicada, erro na importao...",className:"w-full"})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(me,{variant:"outline",onClick:()=>{D({show:!1,purchase:null}),R("")},children:"Cancelar"}),a.jsx(me,{variant:"destructive",onClick:async()=>{if(!I.trim()){alert("Por favor, informe o motivo da inativao");return}try{await ust(F.purchase.id,I.trim(),t.id),D({show:!1,purchase:null}),R(""),gt()}catch(ye){console.error("Erro ao inativar compra:",ye),alert("Erro ao inativar NF-e. Tente novamente.")}},disabled:!I.trim(),children:"Inativar"})]})]})]})}),c&&a.jsx(Nst,{purchase:c,items:h?[]:u,onClose:yt,onEdit:Qe,onReprocess:lt,onDownloadXML:de,onInactivate:ye=>D({show:!0,purchase:ye})}),a.jsx(xn,{open:C,onOpenChange:P,children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[a.jsx(pn,{children:a.jsx(un,{children:"Todos os Fornecedores"})}),a.jsx("div",{className:"px-6 py-3 bg-surface-2 border-y border-border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-muted",children:"Valor Total Geral"}),a.jsxs("span",{className:"text-2xl font-bold text-success",children:["R$ ",We.total.toFixed(2)]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsx("div",{className:"space-y-3 pr-2",children:Object.entries(pt.reduce((ye,Be)=>{const mt=Be.fornecedor?.id||"unknown",Ft=Be.fornecedor?.nome||"No identificado";return ye[mt]||(ye[mt]={name:Ft,total:0,count:0}),ye[mt].total+=Number(Be.valor_total||0),ye[mt].count+=1,ye},{})).sort(([,ye],[,Be])=>Be.total-ye.total).map(([ye,Be],mt)=>{const Ft=Be.total/We.total*100;return a.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center",children:mt+1}),a.jsx("span",{className:"font-medium text-text-primary",children:Be.name})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-success",children:["R$ ",Be.total.toFixed(2)]}),a.jsxs("p",{className:"text-xs text-text-muted",children:[Be.count," NF-es"]})]})]}),a.jsx("div",{className:"w-full bg-surface rounded-full h-2",children:a.jsx("div",{className:"bg-brand rounded-full h-2 transition-all",style:{width:`${Ft}%`}})})]},ye)})})})]})}),a.jsx(xn,{open:M.show,onOpenChange:ye=>U({show:ye,purchase:null}),children:a.jsxs(vn,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] flex flex-col",onOpenAutoFocus:ye=>ye.preventDefault(),children:[a.jsx(pn,{children:a.jsx(un,{children:"Editar NF-e"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Nmero NF-e"}),a.jsx(Ye,{value:z.numeroNfe||"",onChange:ye=>W(Be=>({...Be,numeroNfe:ye.target.value})),placeholder:"Nmero da NF-e"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Srie"}),a.jsx(Ye,{value:z.serieNfe||"",onChange:ye=>W(Be=>({...Be,serieNfe:ye.target.value})),placeholder:"Srie"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Data de Emisso"}),a.jsx(Ye,{type:"date",value:z.dataEmissao||"",onChange:ye=>W(Be=>({...Be,dataEmissao:ye.target.value}))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Tipo de Operao"}),a.jsxs(Nn,{value:z.tipoOperacao||"",onValueChange:ye=>W(Be=>({...Be,tipoOperacao:ye})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione o tipo"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"Entrada",children:"0 - Entrada"}),a.jsx(tt,{value:"Sada",children:"1 - Sada"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Natureza da Operao"}),a.jsxs(Nn,{value:z.naturezaOperacao||"",onValueChange:ye=>W(Be=>({...Be,naturezaOperacao:ye})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione a natureza"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"Compra para comercializao",children:"Compra para comercializao"}),a.jsx(tt,{value:"Compra para industrializao",children:"Compra para industrializao"}),a.jsx(tt,{value:"Compra para uso ou consumo",children:"Compra para uso ou consumo"}),a.jsx(tt,{value:"Compra de ativo imobilizado",children:"Compra de ativo imobilizado"}),a.jsx(tt,{value:"Compra de material para uso ou consumo",children:"Compra de material para uso ou consumo"}),a.jsx(tt,{value:"Devoluo de venda de produo do estabelecimento",children:"Devoluo de venda de produo do estabelecimento"}),a.jsx(tt,{value:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros",children:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros"}),a.jsx(tt,{value:"Remessa de mercadoria por conta e ordem de terceiros",children:"Remessa de mercadoria por conta e ordem de terceiros"}),a.jsx(tt,{value:"Retorno de mercadoria remetida por conta e ordem de terceiros",children:"Retorno de mercadoria remetida por conta e ordem de terceiros"}),a.jsx(tt,{value:"Remessa para industrializao por encomenda",children:"Remessa para industrializao por encomenda"}),a.jsx(tt,{value:"Retorno de mercadoria remetida para industrializao por encomenda",children:"Retorno de mercadoria remetida para industrializao por encomenda"}),a.jsx(tt,{value:"Transferncia de produo do estabelecimento",children:"Transferncia de produo do estabelecimento"}),a.jsx(tt,{value:"Transferncia de mercadoria adquirida ou recebida de terceiros",children:"Transferncia de mercadoria adquirida ou recebida de terceiros"})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Valor dos Produtos"}),a.jsx(Ye,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${z.valorProdutos||"0,00"}`,onChange:ye=>W(Be=>({...Be,valorProdutos:ne(ye.target.value)}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Valor Total"}),a.jsx(Ye,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${z.valorTotal||"0,00"}`,onChange:ye=>W(Be=>({...Be,valorTotal:ne(ye.target.value)}))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Forma de Pagamento"}),a.jsxs(Nn,{value:z.formaPagamento||"",onValueChange:ye=>W(Be=>({...Be,formaPagamento:ye})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione a forma de pagamento"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"01 - Dinheiro",children:"01 - Dinheiro"}),a.jsx(tt,{value:"02 - Cheque",children:"02 - Cheque"}),a.jsx(tt,{value:"03 - Carto de Crdito",children:"03 - Carto de Crdito"}),a.jsx(tt,{value:"04 - Carto de Dbito",children:"04 - Carto de Dbito"}),a.jsx(tt,{value:"05 - Carto da Loja (Private Label)",children:"05 - Carto da Loja (Private Label)"}),a.jsx(tt,{value:"10 - Vale Alimentao",children:"10 - Vale Alimentao"}),a.jsx(tt,{value:"11 - Vale Refeio",children:"11 - Vale Refeio"}),a.jsx(tt,{value:"12 - Vale Presente",children:"12 - Vale Presente"}),a.jsx(tt,{value:"13 - Vale Combustvel",children:"13 - Vale Combustvel"}),a.jsx(tt,{value:"14 - Duplicata Mercantil",children:"14 - Duplicata Mercantil"}),a.jsx(tt,{value:"15 - Boleto Bancrio",children:"15 - Boleto Bancrio"}),a.jsx(tt,{value:"16 - Depsito Bancrio",children:"16 - Depsito Bancrio"}),a.jsx(tt,{value:"17 - PIX Dinmico (QR-Code)",children:"17 - PIX Dinmico (QR-Code)"}),a.jsx(tt,{value:"18 - Transferncia Bancria / Carteira Digital",children:"18 - Transferncia Bancria / Carteira Digital"}),a.jsx(tt,{value:"19 - Programa de Fidelidade / Cashback",children:"19 - Programa de Fidelidade / Cashback"}),a.jsx(tt,{value:"20 - PIX Esttico",children:"20 - PIX Esttico"}),a.jsx(tt,{value:"21 - Crdito em Loja",children:"21 - Crdito em Loja"}),a.jsx(tt,{value:"22 - Pagamento Eletrnico no Informado",children:"22 - Pagamento Eletrnico no Informado"}),a.jsx(tt,{value:"90 - Sem Pagamento",children:"90 - Sem Pagamento"}),a.jsx(tt,{value:"99 - Outros",children:"99 - Outros"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Observaes"}),a.jsx(Ye,{value:z.observacoes||"",onChange:ye=>W(Be=>({...Be,observacoes:ye.target.value})),placeholder:"Observaes adicionais"})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(me,{variant:"outline",onClick:()=>U({show:!1,purchase:null}),children:"Cancelar"}),a.jsx(me,{onClick:ge,children:"Salvar Alteraes"})]})]})]})}),a.jsx(Sst,{open:$.show,onOpenChange:ye=>ee({show:ye,purchase:null}),purchase:$.purchase,products:ve,codigoEmpresa:t?.codigo_empresa,autoFile:$.autoFile,onSuccess:()=>{gt(),ee({show:!1,purchase:null})}})]})}const ul=Se.forwardRef(({className:e,...t},r)=>a.jsx("div",{className:"relative w-full overflow-auto",children:a.jsx("table",{ref:r,className:gr("w-full caption-bottom text-sm",e),...t})}));ul.displayName="Table";const fl=Se.forwardRef(({className:e,...t},r)=>a.jsx("thead",{ref:r,className:gr("[&_tr]:border-b",e),...t}));fl.displayName="TableHeader";const ml=Se.forwardRef(({className:e,...t},r)=>a.jsx("tbody",{ref:r,className:gr("[&_tr:last-child]:border-0",e),...t}));ml.displayName="TableBody";const Ast=Se.forwardRef(({className:e,...t},r)=>a.jsx("tfoot",{ref:r,className:gr("bg-primary font-medium text-primary-foreground",e),...t}));Ast.displayName="TableFooter";const Wa=Se.forwardRef(({className:e,...t},r)=>a.jsx("tr",{ref:r,className:gr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Wa.displayName="TableRow";const qn=Se.forwardRef(({className:e,...t},r)=>a.jsx("th",{ref:r,className:gr("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));qn.displayName="TableHead";const Sn=Se.forwardRef(({className:e,...t},r)=>a.jsx("td",{ref:r,className:gr("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Sn.displayName="TableCell";const Pst=Se.forwardRef(({className:e,...t},r)=>a.jsx("caption",{ref:r,className:gr("mt-4 text-sm text-muted-foreground",e),...t}));Pst.displayName="TableCaption";const Est={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Mse={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},wj=({icon:e,title:t,value:r,color:n,onClick:s,isActive:o})=>{const i=e;return a.jsxs(jr.div,{variants:Mse,className:gr("bg-surface rounded-lg border p-4 flex items-center gap-4 cursor-pointer transition-all duration-200",o?"border-brand ring-2 ring-brand/50":"border-border hover:border-brand/50"),onClick:s,children:[a.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:a.jsx(i,{className:`w-6 h-6 ${n}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function kst({open:e,onOpenChange:t,client:r,onEdit:n,onInactivate:s,codigoEmpresa:o}){const{toast:i}=as(),l={scheduled:{bg:"bg-[#3B82F6]/10",text:"text-[#3B82F6]",border:"border-[#3B82F6]/30"},confirmed:{bg:"bg-[#22C55E]/10",text:"text-[#22C55E]",border:"border-[#22C55E]/30"},in_progress:{bg:"bg-[#FACC15]/10",text:"text-[#FACC15]",border:"border-[#FACC15]/30"},finished:{bg:"bg-[#6B7280]/10",text:"text-[#6B7280]",border:"border-[#6B7280]/30"},canceled:{bg:"bg-[#EF4444]/10",text:"text-[#EF4444]",border:"border-[#EF4444]/30"},absent:{bg:"bg-[#F97316]/10",text:"text-[#F97316]",border:"border-[#F97316]/30"}},c=({label:R,value:M})=>a.jsxs("div",{className:"grid grid-cols-12 items-start gap-3 py-2 border-b border-border/50",children:[a.jsx("div",{className:"col-span-5 sm:col-span-4",children:a.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-text-muted font-semibold",children:R})}),a.jsx("div",{className:"col-span-7 sm:col-span-8",children:a.jsx("span",{className:"block text-sm font-medium text-text-primary break-words",children:M})})]}),[d,u]=p.useState(!1),[f,h]=p.useState([]),[m,v]=p.useState(!1),[g,y]=p.useState([]),x=p.useRef(!1),b=p.useRef(!1),[w,j]=p.useState(!1),[_,C]=p.useState(null),[P,E]=p.useState(!1),[A,F]=p.useState(null),D=p.useMemo(()=>{try{const R=(f||[]).map(U=>({kind:"comanda",ts:new Date(U.aberto_em||U.created_at||0).getTime(),data:U})),M=(g||[]).map(U=>({kind:"agendamento",ts:new Date(U.inicio||0).getTime(),data:U}));return[...R,...M].sort((U,z)=>z.ts-U.ts).slice(0,10)}catch{return[]}},[f,g]),I=async R=>{try{if(j(!0),C(R?.kind||null),E(!0),F(null),R?.kind==="comanda"){const M=R?.data?.comanda_id;if(!M){E(!1);return}let U=he.from("comanda_itens").select("id, quantidade, preco_unitario, desconto, produto:produtos!comanda_itens_produto_id_fkey ( nome )").eq("comanda_id",M);o&&(U=U.eq("codigo_empresa",o));const{data:z}=await U,W=(z||[]).map(Z=>({id:Z.id,quantidade:Z.quantidade,preco_unitario:Z.preco_unitario,desconto:Z.desconto,produto_nome:Z.produto?.[0]?.nome||Z.produto?.nome||"Item"}));let $=he.from("pagamentos").select("id, valor, status, recebido_em, metodo").eq("comanda_id",M);o&&($=$.eq("codigo_empresa",o));const{data:ee}=await $,ve=ee||[];let _e=he.from("comanda_clientes").select("cliente:clientes!comanda_clientes_cliente_id_fkey ( id, nome, email, telefone )").eq("comanda_id",M);o&&(_e=_e.eq("codigo_empresa",o));const{data:K}=await _e,q=(K||[]).map(Z=>Z.cliente?.[0]||Z.cliente).filter(Boolean),Y=(W||[]).reduce((Z,ce)=>Z+(Number(ce.quantidade||0)*Number(ce.preco_unitario||0)-Number(ce.desconto||0)),0),J=(ve||[]).filter(Z=>(Z.status||"Pago")!=="Cancelado"&&(Z.status||"Pago")!=="Estornado").reduce((Z,ce)=>Z+Number(ce.valor||0),0),fe=Math.max(0,Y-J);F({comandaId:M,mesa_title:R?.data?.mesa_title||"Balco",status:R?.data?.status||"open",itens:W||[],pagamentos:ve||[],clientes:q,totalItens:Y,totalPagos:J,saldo:fe,aberto_em:R?.data?.aberto_em||R?.data?.created_at||null,fechado_em:R?.data?.fechado_em||null})}else if(R?.kind==="agendamento"){const M=R?.data?.id;if(!M){E(!1);return}let U=[];try{const{data:$}=await he.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento").eq("agendamento_id",M).limit(200);U=$||[]}catch{U=[]}const z=Array.from(new Set((U||[]).map($=>$.cliente_id).filter(Boolean)));let W=[];if(W=(U||[]).map($=>({id:$.cliente_id,nome:$.nome||null,email:null,telefone:null,codigo:null,valor_cota:$.valor_cota??null,status_pagamento:$.status_pagamento||null})),z.length>0)try{const{data:$}=await he.from("clientes").select("id,nome,email,telefone,codigo").in("id",z),ee=new Map(($||[]).map(ve=>[String(ve.id),ve]));W=W.map(ve=>{const _e=ee.get(String(ve.id));return _e?{...ve,nome:ve.nome||_e.nome,email:_e.email,telefone:_e.telefone,codigo:_e.codigo}:ve})}catch{}F({id:M,inicio:R?.data?.inicio||null,fim:R?.data?.fim||null,status:R?.data?.status||null,modalidade:R?.data?.modalidade||null,quadra_nome:R?.data?.quadra_nome||null,participantes:W})}}catch{}finally{E(!1)}};return p.useEffect(()=>{let R=!1;if(e&&(x.current=!1,b.current=!1),e&&r?.id&&!o)return u(!1),v(!1),()=>{R=!0};const M=async()=>{if(!e||!r?.id)return;u(!0);const z=Number(r?.codigo??-1)===0;let W=he.from("comanda_clientes").select("comanda_id, created_at");z?W=W.is("cliente_id",null):W=W.eq("cliente_id",r.id),W=W.order("created_at",{ascending:!1}).limit(50),o&&(W=W.eq("codigo_empresa",o));const{data:$,error:ee}=await W;if(ee)throw ee;const ve=Array.from(new Set(($||[]).map(J=>J.comanda_id).filter(Boolean)));let _e=[];if(!z){let J=he.from("comandas").select("id, status, aberto_em, fechado_em").eq("cliente_id",r.id).order("aberto_em",{ascending:!1}).limit(10);o&&(J=J.eq("codigo_empresa",o));const{data:fe,error:Z}=await J;if(Z)throw Z;_e=fe||[]}const K=Array.from(new Set((_e||[]).map(J=>J.id))),q=Array.from(new Set([...ve,...K]));if(q.length===0){h([]),u(!1);return}let Y;try{Y=setTimeout(()=>u(!1),1e4)}catch{}try{let J=he.from("comandas").select("id,status,aberto_em,fechado_em, mesa:mesas!comandas_mesa_id_fkey ( nome, numero )").in("id",q);o&&(J=J.eq("codigo_empresa",o));const{data:fe,error:Z}=await J;if(Z)throw Z;const ce=new Map((fe||[]).map(yt=>[yt.id,yt]));let le=he.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",q);o&&(le=le.eq("codigo_empresa",o));const{data:ie,error:te}=await le;if(te)throw te;const ue={};for(const yt of ie||[]){const Qe=Number(yt.quantidade||0)*Number(yt.preco_unitario||0),ge=Number(yt.desconto||0);ue[yt.comanda_id]=(ue[yt.comanda_id]||0)+Math.max(0,Qe-ge)}let Te=he.from("pagamentos").select("comanda_id, valor, status, recebido_em, metodo").in("comanda_id",q);o&&(Te=Te.eq("codigo_empresa",o));const{data:ne,error:de}=await Te;if(de)throw de;const lt={};for(const yt of ne||[])(yt.status||"Pago")!=="Cancelado"&&(yt.status||"Pago")!=="Estornado"&&(lt[yt.comanda_id]=(lt[yt.comanda_id]||0)+Number(yt.valor||0));const Nt=(yt,Qe=null)=>{const ge=ce.get(yt)||{},rt=Number(ue[yt]||0),pt=Number(lt[yt]||0),We=Math.max(0,rt-pt),Ze=ge.mesa?.[0]?.nome||ge.mesa?.nome||null,Ne=ge.mesa?.[0]?.numero||ge.mesa?.numero||null,ye=Ze||(Ne!=null?`Mesa ${Ne}`:"Balco");return{comanda_id:yt,created_at:Qe,aberto_em:ge.aberto_em||null,fechado_em:ge.fechado_em||null,status:ge.status||"open",total:rt,pago:pt,saldo:We,mesa_title:ye}},at=($||[]).map(yt=>Nt(yt.comanda_id,yt.created_at)),gt=(_e||[]).filter(yt=>!(ve||[]).includes(yt.id)).map(yt=>Nt(yt.id,yt.aberto_em)),Pt=[...at,...gt].sort((yt,Qe)=>{const ge=new Date(yt.aberto_em||yt.created_at||0).getTime();return new Date(Qe.aberto_em||Qe.created_at||0).getTime()-ge}).slice(0,10);if(!R&&Pt.length===0&&!x.current){x.current=!0,console.debug("[ClientDetailsModal] loadHistory: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&M()},700);return}R||h(Pt)}catch(J){i({title:"Falha ao carregar histrico do cliente",description:J?.message||"Tente novamente",variant:"destructive"})}finally{try{clearTimeout(Y)}catch{}R||u(!1)}},U=async()=>{if(!e||!r?.id)return;v(!0);let z;try{z=setTimeout(()=>v(!1),1e4)}catch{}try{console.debug("[ClientDetailsModal] loadBookings: start",{clientId:r.id,codigoEmpresa:o});let W=he.from("agendamentos").select(`
            id, inicio, fim, status, modalidade,
            quadra:quadra_id ( nome )
          `).eq("cliente_id",r.id).order("inicio",{ascending:!1}).limit(10);o&&(W=W.eq("codigo_empresa",o));const{data:$,error:ee}=await W;if(ee)throw ee;const ve=($||[]).map(le=>({id:le.id,inicio:le.inicio,fim:le.fim,status:le.status,modalidade:le.modalidade,quadra_nome:le.quadra?.[0]?.nome||le.quadra?.nome||null}));let _e=he.from("v_agendamento_participantes").select("agendamento_id").eq("cliente_id",r.id).limit(30);const{data:K,error:q}=await _e;if(q)throw q;const Y=Array.from(new Set((K||[]).map(le=>le.agendamento_id).filter(Boolean))),J=new Set((ve||[]).map(le=>le.id)),fe=Y.filter(le=>!J.has(le));let Z=[];if(fe.length>0){let le=he.from("agendamentos").select(`
              id, inicio, fim, status, modalidade,
              quadra:quadra_id ( nome )
            `).in("id",fe);o&&(le=le.eq("codigo_empresa",o));const{data:ie,error:te}=await le;if(te)throw te;Z=(ie||[]).map(ue=>({id:ue.id,inicio:ue.inicio,fim:ue.fim,status:ue.status,modalidade:ue.modalidade,quadra_nome:ue.quadra?.[0]?.nome||ue.quadra?.nome||null}))}const ce=[...ve,...Z].sort((le,ie)=>new Date(ie.inicio)-new Date(le.inicio)).slice(0,10);if(!R&&ce.length===0&&!b.current){b.current=!0,console.debug("[ClientDetailsModal] loadBookings: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&U()},700);return}R||y(ce)}catch(W){console.warn("[ClientDetailsModal] Falha ao carregar agendamentos do cliente:",W)}finally{try{clearTimeout(z)}catch{}R||v(!1)}};return M(),U(),()=>{R=!0,e||(u(!1),v(!1))}},[e,r?.id,o]),r?a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto w-full",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Detalhes do Cliente"}),a.jsx(Dn,{children:"Informaes cadastrais e histrico recente deste cliente."})]}),a.jsxs("div",{className:"p-4 sm:p-6 space-y-6 sm:space-y-8",children:[a.jsx("div",{className:"overflow-hidden",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:a.jsxs("div",{className:"min-w-0",children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-extrabold tracking-tight text-text-primary truncate",children:r.nome}),a.jsxs("div",{className:"mt-2 flex items-center flex-wrap gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",a.jsx("span",{className:"text-text-primary font-mono",children:r.codigo})]}),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold border ${r.status==="active"?"bg-emerald-500/10 text-emerald-400 border-emerald-400/30":"bg-rose-500/10 text-rose-400 border-rose-400/30"}`,children:r.status==="active"?"Ativo":"Inativo"}),r.flag_cliente&&a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),r.flag_fornecedor&&a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),a.jsx("span",{className:"mt-2 block text-sm text-text-secondary truncate",children:r.email||""})]})})}),a.jsx("div",{className:"grid grid-cols-1 gap-8",children:a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-text-secondary mb-2",children:"Informaes Cadastrais"}),a.jsxs("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg space-y-1",children:[a.jsx(c,{label:"Cdigo",value:r.codigo}),a.jsx(c,{label:"CPF/CNPJ",value:r.cpf||r.cnpj||""}),a.jsx(c,{label:"Telefone",value:r.telefone||""}),a.jsx(c,{label:"Aniversrio",value:r.aniversario?new Date(r.aniversario).toLocaleDateString("pt-BR"):""}),a.jsx(c,{label:"Email",value:r.email||""}),a.jsx(c,{label:"Status",value:r.status==="active"?"Ativo":"Inativo"})]})]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary",children:[a.jsx(Aue,{className:"w-5 h-5 text-text-secondary"}),a.jsx("h4",{className:"font-semibold",children:"Histrico Recente"})]}),a.jsx("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg",children:d&&m?a.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Carregando histrico..."}):D&&D.length>0?a.jsx("div",{className:"max-h-64 overflow-y-auto thin-scroll pr-1",children:a.jsx("div",{className:"space-y-3",children:D.map((R,M)=>a.jsxs("div",{className:"group flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3 p-3 rounded-md border border-border/60 bg-background cursor-pointer transition-colors transition-shadow hover:bg-surface-2/60 hover:shadow-md hover:border-brand/30",title:"Clique para ver detalhes",onClick:()=>I(R),children:[a.jsx("div",{className:"min-w-0",children:R.kind==="comanda"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:R.data.mesa_title||"Balco"}),a.jsx("div",{className:"text-xs text-text-secondary truncate",children:(()=>{const U=R.data;return U.aberto_em?new Date(U.aberto_em).toLocaleString("pt-BR"):new Date(U.created_at).toLocaleString("pt-BR")})()})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:R.data.modalidade||"Agendamento"}),a.jsxs("div",{className:"text-xs text-text-secondary truncate",children:[new Date(R.data.inicio).toLocaleString("pt-BR"),"  ",R.data.quadra_nome||"Quadra"]})]})}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:R.kind==="comanda"?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:gr("px-2 py-1 text-[11px] font-semibold rounded-full border",R.data.status==="closed"||R.data.fechado_em?"bg-success/10 text-success border-success/30":R.data.status==="awaiting-payment"?"bg-info/10 text-info border-info/30":"bg-warning/10 text-warning border-warning/30"),children:R.data.status==="closed"||R.data.fechado_em?"Fechada":R.data.status==="awaiting-payment"?"Pagamento":"Em uso"}),a.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:gr("px-2 py-1 text-[11px] font-semibold rounded-full border",(()=>{const U=String(R.data.status||"").toLowerCase(),z=l[U]||l.scheduled;return`${z.bg} ${z.text} ${z.border}`})()),children:(()=>{switch(R.data.status){case"finished":return"Finalizado";case"canceled":return"Cancelado";case"in_progress":return"Em andamento";case"confirmed":return"Confirmado";case"absent":return"Ausente";case"scheduled":default:return"Agendado"}})()}),a.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]})})]},`${R.kind}-${M}`))})}):a.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Sem registros recentes para este cliente."})})]}),a.jsx(xn,{open:w,onOpenChange:j,children:a.jsxs(vn,{className:"sm:max-w-[700px] w-full max-h-[85vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:_==="comanda"?A?.mesa_title||"Detalhes da Comanda":"Detalhes do Agendamento"}),a.jsx(Dn,{children:_==="comanda"?"Itens e pagamentos desta comanda.":"Informaes do agendamento e participantes."}),a.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"text-xs text-text-secondary",children:"Cliente:"}),a.jsx("span",{className:"text-sm font-medium text-text-primary",children:r?.nome||""}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",a.jsx("span",{className:"text-text-primary font-mono",children:r?.codigo??""})]})]})]}),a.jsx("div",{className:"space-y-4",children:P?a.jsx("div",{className:"text-sm text-text-muted",children:"Carregando detalhes..."}):_==="comanda"&&A?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Status"}),a.jsx("p",{className:"font-semibold",children:(()=>{const R=String(A.status||"").toLowerCase();return R==="closed"||A.fechado_em?"Fechada":R==="awaiting-payment"?"Aguardando pagamento":"Aberta"})()})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Abertura"}),a.jsx("p",{className:"font-semibold",children:A.aberto_em?new Date(A.aberto_em).toLocaleString("pt-BR"):""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Fechamento"}),a.jsx("p",{className:"font-semibold",children:A.fechado_em?new Date(A.fechado_em).toLocaleString("pt-BR"):""})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Itens"}),a.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(A.itens||[]).map(R=>a.jsxs("div",{className:"p-2 flex flex-col sm:grid sm:grid-cols-12 gap-1 sm:gap-2 text-sm",children:[a.jsx("div",{className:"sm:col-span-6 font-medium",children:R.produto_nome||"Item"}),a.jsxs("div",{className:"sm:col-span-2 sm:text-right text-text-muted",children:["Qtd: ",Number(R.quantidade||0)]}),a.jsxs("div",{className:"sm:col-span-2 sm:text-right",children:["R$ ",Number(R.preco_unitario||0).toFixed(2)]}),a.jsx("div",{className:"sm:col-span-2 sm:text-right text-text-secondary",children:Number(R.desconto||0)?`- R$ ${Number(R.desconto||0).toFixed(2)}`:""})]},R.id)),(!A.itens||A.itens.length===0)&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum item."})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Pagamentos"}),a.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(A.pagamentos||[]).map(R=>a.jsxs("div",{className:"p-2 flex items-center justify-between text-sm",children:[a.jsxs("span",{className:"truncate",children:[R.metodo||""," ",R.status?`(${R.status})`:""]}),a.jsxs("span",{className:"font-semibold",children:["R$ ",Number(R.valor||0).toFixed(2)]})]},R.id)),(!A.pagamentos||A.pagamentos.length===0)&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum pagamento registrado."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Total de Itens"}),a.jsxs("p",{className:"font-bold",children:["R$ ",Number(A.totalItens||0).toFixed(2)]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Total Pago"}),a.jsxs("p",{className:"font-bold text-success",children:["R$ ",Number(A.totalPagos||0).toFixed(2)]})]})]})]}):_==="agendamento"&&A?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Modalidade"}),a.jsx("p",{className:"font-semibold",children:A.modalidade||""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Quadra"}),a.jsx("p",{className:"font-semibold",children:A.quadra_nome||""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Incio"}),a.jsx("p",{className:"font-semibold",children:A.inicio?new Date(A.inicio).toLocaleString("pt-BR"):""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Fim"}),a.jsx("p",{className:"font-semibold",children:A.fim?new Date(A.fim).toLocaleString("pt-BR"):""})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Participantes"}),a.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(A.participantes||[]).map((R,M)=>a.jsxs("div",{className:"p-2 text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3",children:[a.jsx("div",{className:"min-w-0",children:a.jsxs("div",{className:"flex items-center gap-2",children:[R.codigo!==null&&R.codigo!==void 0&&a.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${String(R.status_pagamento||"").toLowerCase()==="pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",R.codigo]}),a.jsx("span",{className:"font-medium truncate",children:R.nome||"Participante"})]})}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:[R.valor_cota!=null&&a.jsxs("span",{className:"text-xs font-semibold text-text-secondary",children:["R$ ",Number(R.valor_cota||0).toFixed(2)]}),a.jsx("span",{className:`text-[11px] font-semibold rounded-full px-2 py-0.5 border ${String(R.status_pagamento||"").toLowerCase()==="pago"?"bg-success/10 text-success border-success/30":"bg-warning/10 text-warning border-warning/30"}`,children:String(R.status_pagamento||R.status_pagamento_text||"Pendente")})]})]},`${R.id}-${M}`)),(!A.participantes||A.participantes.length===0)&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum participante encontrado."})]})]})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma informao para exibir."})}),a.jsx(ra,{children:a.jsx(me,{variant:"outline",onClick:()=>j(!1),children:"Fechar"})})]})})]}),a.jsxs(ra,{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-0 sm:justify-between",children:[!r?.is_consumidor_final&&a.jsx("div",{className:"w-full sm:flex-1",children:a.jsxs(me,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white w-full sm:w-auto",onClick:()=>s?.(r),children:[a.jsx(WH,{className:"mr-2 h-4 w-4"})," Inativar Cliente"]})}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[a.jsx(lh,{asChild:!0,children:a.jsx(me,{type:"button",variant:"secondary",className:"flex-1 sm:flex-none",children:"Fechar"})}),!r?.is_consumidor_final&&a.jsxs(me,{onClick:()=>n(r),className:"flex-1 sm:flex-none",children:[a.jsx(xl,{className:"mr-2 h-4 w-4"})," Editar Cliente"]})]})]})]})}):null}function Ist(){const{toast:e}=as(),{userProfile:t,authReady:r}=vs(),n=Lo(),[s,o]=p.useState(()=>{try{const q=localStorage.getItem("auth:userProfile"),Y=q&&JSON.parse(q)?.codigo_empresa||null,J=Y?`clientes:list:${Y}`:"clientes:list",fe=JSON.parse(localStorage.getItem(J)||"[]");return Array.isArray(fe)?fe:[]}catch{return[]}}),[i,l]=p.useState(!1),[c,d]=p.useState(!0),[u,f]=p.useState(!1),[h,m]=p.useState(!1),[v,g]=p.useState(null),[y,x]=p.useState(null),[b,w]=p.useState({searchTerm:"",status:"all",tipo:"todos"}),j=p.useRef(!1),_=p.useRef(0),C=p.useRef(0),P=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!u&&!P.current&&(P.current=!0,f(!0),window.history.replaceState({},document.title))},[n.state?.openModal,u]);const E=async()=>{try{const q=s&&s.length>0;if(q||l(!0),!t?.codigo_empresa)return;const Y=`clientes:list:${t.codigo_empresa}`;let J=he.from("clientes").select("*, is_consumidor_final").eq("codigo_empresa",t.codigo_empresa).order("codigo",{ascending:!0});if(b.searchTerm.trim()!==""){const ie=b.searchTerm.trim();/^\d+$/.test(ie)?J=J.or(`codigo.eq.${ie},nome.ilike.%${ie}%,email.ilike.%${ie}%,telefone.ilike.%${ie}%`):J=J.or(`nome.ilike.%${ie}%,email.ilike.%${ie}%,telefone.ilike.%${ie}%`)}b.status!=="all"&&(J=J.eq("status",b.status));const fe=setTimeout(()=>{try{if(!q){const ie=JSON.parse(localStorage.getItem(Y)||"[]");Array.isArray(ie)&&ie.length>0&&(console.warn("[Clientes] slow fallback: using cached snapshot"),o(ie),C.current=ie.length)}}catch{}},2e3),{data:Z,error:ce}=await J;if(ce){if(!j.current){j.current=!0,setTimeout(E,900);return}throw ce}const le=Z||[];if(le.length===0&&q&&!j.current){j.current=!0,setTimeout(E,700);return}j.current=!1,o(le);try{localStorage.setItem(Y,JSON.stringify(le))}catch{}C.current=le.length,_.current=Date.now()}catch(q){e({title:"Erro ao carregar clientes",description:q.message,variant:"destructive"})}finally{l(!1);try{clearTimeout(slowFallback)}catch{}}};p.useEffect(()=>{try{const q=localStorage.getItem("auth:userProfile"),Y=t?.codigo_empresa||q&&JSON.parse(q)?.codigo_empresa||null;if(Y){const J=`clientes:list:${Y}`,fe=JSON.parse(localStorage.getItem(J)||"[]");Array.isArray(fe)&&fe.length&&s.length===0&&(o(fe),C.current=fe.length)}}catch{}if(r&&t?.codigo_empresa){const q=setTimeout(E,50);return()=>clearTimeout(q)}return()=>{}},[r,t?.codigo_empresa]),p.useEffect(()=>{if(r&&t?.codigo_empresa){const q=setTimeout(E,200);return()=>clearTimeout(q)}return()=>{}},[b.searchTerm,b.status,r,t?.codigo_empresa]),p.useEffect(()=>{const q=()=>{(Date.now()-(_.current||0)>3e4||C.current===0)&&r&&t?.codigo_empresa&&E()},Y=()=>{document.visibilityState==="visible"&&(Date.now()-(_.current||0)>3e4||C.current===0)&&r&&t?.codigo_empresa&&E()};return window.addEventListener("focus",q),document.addEventListener("visibilitychange",Y),()=>{window.removeEventListener("focus",q),document.removeEventListener("visibilitychange",Y)}},[r,t?.codigo_empresa]);const A=p.useMemo(()=>{const Y=new Date().getMonth();return{total:s.length,birthdays:s.filter(J=>J.aniversario&&new Date(J.aniversario).getMonth()===Y).length,active:s.filter(J=>J.status==="active").length}},[s]);function F(q){const Y=["Cdigo","Tipo Pessoa","Nome/Razo Social","Apelido/Nome Fantasia","CPF","CNPJ","RG","IE","Email","Telefone","Fone 2","Celular 1","Celular 2","WhatsApp","CEP","Endereo","Nmero","Complemento","Bairro","Cidade","UF","Cidade IBGE","Limite Crdito","Tipo Recebimento","Regime Tributrio","Tipo Contribuinte","Aniversrio","Sexo","Estado Civil","Nome da Me","Nome do Pai","Observaes"," Cliente"," Fornecedor"," Funcionrio"," Administradora"," Parceiro","CCF/SPC","Status"],J=";",fe=ne=>{if(!ne)return"";try{const de=new Date(ne);if(!isNaN(de)){const lt=String(de.getDate()).padStart(2,"0"),Nt=String(de.getMonth()+1).padStart(2,"0"),at=de.getFullYear();return`${lt}/${Nt}/${at}`}}catch{}return String(ne)},Z=ne=>{const de=Number(ne??0);return Number.isFinite(de)?de.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},ce=ne=>ne?"Sim":"No",le=ne=>{const de=ne==null?"":String(ne);return/[";\n]/.test(de)?`"${de.replace(/"/g,'""')}"`:de},ie=[];ie.push("\uFEFF"+Y.join(J));for(const ne of q){const de=[ne.codigo??"",ne.tipo_pessoa||"",ne.nome||"",ne.apelido||"",ne.cpf||"",ne.cnpj||"",ne.rg||"",ne.ie||"",ne.email||"",ne.telefone||"",ne.fone2||"",ne.celular1||"",ne.celular2||"",ne.whatsapp||"",ne.cep||"",ne.endereco||"",ne.numero||"",ne.complemento||"",ne.bairro||"",ne.cidade||"",ne.uf||"",ne.cidade_ibge||"",Z(ne.limite_credito),ne.tipo_recebimento||"",ne.regime_tributario||"",ne.tipo_contribuinte||"",fe(ne.aniversario),ne.sexo||"",ne.estado_civil||"",ne.nome_mae||"",ne.nome_pai||"",ne.observacoes||"",ce(!!ne.flag_cliente),ce(!!ne.flag_fornecedor),ce(!!ne.flag_funcionario),ce(!!ne.flag_administradora),ce(!!ne.flag_parceiro),ce(!!ne.flag_ccf_spc),ne.status==="active"?"Ativo":"Inativo"].map(le).join(J);ie.push(de)}const te=new Blob([ie.join(`
`)],{type:"text/csv;charset=utf-8;"}),ue=URL.createObjectURL(te),Te=document.createElement("a");Te.href=ue,Te.download="clientes.csv",document.body.appendChild(Te),Te.click(),document.body.removeChild(Te),URL.revokeObjectURL(ue)}const D=()=>{try{F(I),e({title:"Exportao concluda",description:`${I.length} cliente(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(q){e({title:"Falha ao exportar",description:q?.message||"No foi possvel gerar o arquivo.",variant:"destructive"})}},I=p.useMemo(()=>(new Date().getMonth(),s.filter(Y=>{const J=b.searchTerm.toLowerCase()===""||(Y.nome||"").toLowerCase().includes(b.searchTerm.toLowerCase())||(Y.cpf||"").includes(b.searchTerm)||(Y.telefone||"").includes(b.searchTerm),fe=b.status==="all"||Y.status===b.status;let Z=!0;return b.tipo==="clientes"?Z=Y.flag_cliente===!0:b.tipo==="fornecedores"?Z=Y.flag_fornecedor===!0:b.tipo==="ambos"&&(Z=Y.flag_cliente===!0&&Y.flag_fornecedor===!0),J&&fe&&Z})),[s,b]),[R,M]=p.useState({by:"codigo",dir:"asc"}),U=q=>{M(Y=>Y.by===q&&Y.dir==="asc"?{by:q,dir:"desc"}:{by:q,dir:"asc"})},z=p.useMemo(()=>{const q=I.find(ce=>ce?.is_consumidor_final===!0),J=[...I.filter(ce=>ce?.is_consumidor_final!==!0)],fe=R.dir==="asc"?1:-1,Z=(ce,le)=>Number.isFinite(ce)?ce:le;return J.sort((ce,le)=>{if(R.by==="codigo"){const ie=Z(parseInt(String(ce.codigo||"").trim(),10),1/0),te=Z(parseInt(String(le.codigo||"").trim(),10),1/0);return ie===te?0:ie>te?fe:-fe}if(R.by==="nome"){const ie=(ce.nome||"").toString(),te=(le.nome||"").toString();return ie.localeCompare(te,"pt-BR",{sensitivity:"base"})*fe}return 0}),q?[q,...J]:J},[I,R]),W=q=>{g(q),m(!0)},$=()=>{x(null),f(!0)},ee=q=>{m(!1),x(q),f(!0)},ve=async q=>{try{const{error:Y}=await he.from("clientes").update({status:"inactive"}).eq("id",q.id);if(Y)throw Y;m(!1),e({title:"Cliente inativado",description:`${q.nome} foi marcado como inativo.`}),E()}catch(Y){e({title:"Erro ao inativar cliente",description:Y.message,variant:"destructive"})}},_e=()=>{w({searchTerm:"",status:"all",tipo:"todos"})},K=b.searchTerm!==""||b.status!=="all"||b.tipo!=="todos";return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-full flex flex-col",children:a.jsxs(jr.div,{variants:Est,initial:"hidden",animate:"visible",children:[a.jsxs(jr.div,{variants:Mse,className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Clientes & Fornecedores"}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa de clientes e fornecedores"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[a.jsx(me,{variant:"outline",size:"icon",onClick:()=>d(q=>!q),title:c?"Ocultar resumo":"Mostrar resumo","aria-label":c?"Ocultar resumo":"Mostrar resumo",className:"flex-shrink-0",children:c?a.jsx(Fp,{className:"h-4 w-4"}):a.jsx(rg,{className:"h-4 w-4"})}),a.jsxs(me,{variant:"outline",onClick:D,className:"text-sm",children:[a.jsx(ho,{className:"mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Exportar"}),a.jsx("span",{className:"sm:hidden",children:"CSV"})]}),a.jsxs(me,{onClick:$,className:"text-sm",children:[a.jsx(ns,{className:"mr-2 h-4 w-4"})," ",a.jsx("span",{className:"hidden xs:inline",children:"Novo"}),a.jsx("span",{className:"xs:hidden",children:"Novo"})]})]})]}),c&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[a.jsx(wj,{icon:yl,title:"Total de Clientes",value:s.filter(q=>q.flag_cliente).length,color:"text-brand",onClick:()=>w(q=>({...q,tipo:"clientes"})),isActive:b.tipo==="clientes"}),a.jsx(wj,{icon:yl,title:"Total de Fornecedores",value:s.filter(q=>q.flag_fornecedor).length,color:"text-purple-500",onClick:()=>w(q=>({...q,tipo:"fornecedores"})),isActive:b.tipo==="fornecedores"}),a.jsx(wj,{icon:Nue,title:"Aniversariantes do Ms",value:A.birthdays,color:"text-info",onClick:()=>w(q=>({...q,tipo:"todos"})),isActive:b.tipo==="todos"}),a.jsx(wj,{icon:Vf,title:"Ativos",value:A.active,color:"text-success",onClick:()=>w(q=>({...q,status:"active"})),isActive:b.status==="active"})]}),a.jsx(jr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsxs("div",{className:"p-4 border-b border-border flex flex-col gap-4",children:[a.jsxs("div",{className:"relative w-full",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar por nome, CPF ou telefone...",className:"pl-9",value:b.searchTerm,onChange:q=>w(Y=>({...Y,searchTerm:q.target.value}))})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(Nn,{value:b.tipo,onValueChange:q=>w(Y=>({...Y,tipo:q})),children:[a.jsx(bn,{className:"w-full sm:w-[200px]",children:a.jsx(Cn,{placeholder:"Tipo"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"todos",children:"Todos"}),a.jsx(tt,{value:"clientes",children:"Apenas Clientes"}),a.jsx(tt,{value:"fornecedores",children:"Apenas Fornecedores"}),a.jsx(tt,{value:"ambos",children:"Clientes e Fornecedores"})]})]}),a.jsxs(Nn,{value:b.status,onValueChange:q=>w(Y=>({...Y,status:q})),children:[a.jsx(bn,{className:"w-full sm:w-[180px]",children:a.jsx(Cn,{placeholder:"Status"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Todos os Status"}),a.jsx(tt,{value:"active",children:"Ativos"}),a.jsx(tt,{value:"inactive",children:"Inativos"})]})]}),K&&a.jsxs(me,{variant:"ghost",onClick:_e,className:"w-full sm:w-auto",children:[a.jsx(Bp,{className:"mr-2 h-4 w-4"}),"Limpar Filtros"]})]})]}),a.jsx("div",{className:"md:hidden space-y-3 p-4",children:i?a.jsx("div",{className:"text-center py-8 text-text-muted",children:"Carregando..."}):z.length>0?z.map(q=>{const Y=q?.is_consumidor_final===!0;return a.jsxs("div",{className:gr("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer transition-all",Y?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-4 border-l-amber-500/40 border-t-border border-r-border border-b-border":"border-border hover:border-brand/50"),onClick:()=>W(q),children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx("span",{className:gr("font-mono text-sm font-semibold",Y?"text-amber-300/90":"text-text-primary"),children:q.codigo}),a.jsx("span",{className:gr("px-2 py-0.5 text-xs font-semibold rounded-full flex-shrink-0",q.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:q.status==="active"?"Ativo":"Inativo"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:gr("font-semibold text-base mb-1",Y?"text-amber-100/90":"text-text-primary"),children:q.nome||""}),Y&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium mb-1",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),a.jsx("p",{className:"text-sm text-text-muted",children:q.cpf&&`CPF: ${q.cpf}`||q.cnpj&&`CNPJ: ${q.cnpj}`||(q.apelido?`Apelido: ${q.apelido}`:" ")})]}),a.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[q.flag_cliente&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),q.flag_fornecedor&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),(q.telefone||q.email)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Contato"}),a.jsx("span",{className:"text-sm font-medium",children:q.telefone||q.email})]}),a.jsx("div",{className:"text-xs text-text-muted text-center pt-2 border-t border-border/50",children:"Toque para ver detalhes"})]},q.id)}):a.jsx("div",{className:"text-center py-8 text-text-muted",children:"Nenhum cliente encontrado com os filtros aplicados."})}),a.jsx("div",{className:"hidden md:block",children:a.jsxs(ul,{children:[a.jsx(fl,{className:"sticky top-0 bg-surface-2 z-10",children:a.jsxs(Wa,{className:"border-b border-border",children:[a.jsxs(qn,{className:"select-none cursor-pointer text-text-secondary",onClick:()=>U("codigo"),title:"Ordenar por cdigo",children:["Cdigo ",R.by==="codigo"?R.dir==="asc"?"":"":""]}),a.jsxs(qn,{className:"text-text-secondary select-none cursor-pointer",onClick:()=>U("nome"),title:"Ordenar por nome",children:["Cliente ",R.by==="nome"?R.dir==="asc"?"":"":""]}),a.jsx(qn,{className:"text-text-secondary",children:"Contato"}),a.jsx(qn,{className:"text-text-secondary",children:"Tipo"}),a.jsx(qn,{className:"text-text-secondary",children:"Status"})]})}),a.jsx(ml,{children:i?a.jsx(Wa,{children:a.jsx(Sn,{colSpan:5,className:"h-24 text-center",children:"Carregando..."})}):z.length>0?z.map(q=>{const Y=q?.is_consumidor_final===!0;return a.jsxs(Wa,{className:gr("cursor-pointer transition-all",Y?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":"hover:bg-surface-2"),onClick:()=>W(q),children:[a.jsx(Sn,{className:gr("font-mono text-base font-semibold",Y?"text-amber-300/90":"text-text-primary"),children:q.codigo}),a.jsx(Sn,{children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:gr("text-base font-semibold truncate",Y?"text-amber-100/90":"text-text-primary"),children:q.nome||""}),Y&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),a.jsx("span",{className:"text-xs text-text-muted truncate",children:q.cpf&&`CPF: ${q.cpf}`||q.cnpj&&`CNPJ: ${q.cnpj}`||(q.apelido?`Apelido: ${q.apelido}`:" ")})]})}),a.jsx(Sn,{children:a.jsx("div",{className:"flex flex-col",children:a.jsx("span",{className:"text-sm truncate",children:q.telefone||q.email||""})})}),a.jsx(Sn,{children:a.jsxs("div",{className:"flex flex-wrap gap-1",children:[q.flag_cliente&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),q.flag_fornecedor&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]})}),a.jsx(Sn,{children:a.jsx("span",{className:gr("px-2 py-1 text-xs font-semibold rounded-full",q.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:q.status==="active"?"Ativo":"Inativo"})})]},q.id)}):a.jsx(Wa,{children:a.jsx(Sn,{colSpan:5,className:"h-24 text-center",children:"Nenhum cliente encontrado com os filtros aplicados."})})})]})})]})})]})}),a.jsx(Vre,{open:u,onOpenChange:f,client:y,onSaved:E}),a.jsx(kst,{open:h,onOpenChange:m,client:v,onEdit:ee,onInactivate:ve,codigoEmpresa:t?.codigo_empresa})]})}const Ost=[],Tst={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Rse={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},KE=({icon:e,title:t,value:r,color:n})=>{const s=e;return a.jsxs(jr.div,{variants:Rse,className:"bg-surface rounded-lg border border-border p-4 flex items-center gap-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:a.jsx(s,{className:`w-6 h-6 ${n}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function Dst({open:e,onOpenChange:t,member:r,onEdit:n}){return r?a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"sm:max-w-[500px] w-full",children:[a.jsx(pn,{children:a.jsx(un,{children:"Detalhes do Funcionrio"})}),a.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-bold",children:r.name}),a.jsx("p",{className:"text-brand font-semibold",children:r.role})]}),a.jsxs("div",{className:"bg-surface-2 p-8 rounded-lg text-center border border-border",children:[a.jsx("p",{className:"text-lg font-semibold text-text-secondary",children:" Em desenvolvimento"}),a.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Detalhes completos do funcionrio estaro disponveis em breve."})]})]}),a.jsxs(ra,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[a.jsx(lh,{asChild:!0,children:a.jsx(me,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Fechar"})}),a.jsxs(me,{onClick:()=>n(r),className:"w-full sm:w-auto",children:[a.jsx(xl,{className:"mr-2 h-4 w-4"})," Editar"]})]})]})}):null}function Mst({open:e,onOpenChange:t,member:r,onSave:n,loading:s}){const{toast:o}=as(),[i,l]=p.useState(r?.name||""),[c,d]=p.useState(r?.role||"");p.useEffect(()=>{e&&(l(r?.name||""),d(r?.role||""))},[r,e]);const u=async f=>{if(f.preventDefault(),!i.trim()){o({title:"Nome  obrigatrio",variant:"destructive"});return}await n({name:i.trim(),role:c.trim()})};return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"sm:max-w-[700px] w-full",children:[a.jsxs(pn,{children:[a.jsx(un,{children:r?"Editar Funcionrio":"Novo Funcionrio"}),a.jsx(Dn,{children:"Informe apenas nome e cargo. O cargo  livre (texto)."})]}),a.jsx("form",{onSubmit:u,className:"py-2",children:a.jsx("div",{className:"bg-surface-2 border border-border rounded-lg p-4 space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{htmlFor:"name",children:"Nome"}),a.jsxs("div",{className:"relative",children:[a.jsx(Du,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{id:"name",value:i,onChange:f=>l(f.target.value),className:"pl-9",placeholder:"Ex.: Maria Silva"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{htmlFor:"role",children:"Cargo"}),a.jsxs("div",{className:"relative",children:[a.jsx(Eue,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{id:"role",value:c,onChange:f=>d(f.target.value),className:"pl-9",placeholder:"Ex.: Gerente, Caixa, ..."})]})]})]})})}),a.jsxs(ra,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[a.jsx(lh,{asChild:!0,children:a.jsx(me,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),a.jsx(me,{type:"submit",onClick:u,disabled:!!s,className:"w-full sm:w-auto",children:s?"Salvando...":"Salvar"})]})]})})}function Rst(){const{company:e,authReady:t,userProfile:r}=vs(),{toast:n}=as(),[s,o]=p.useState(Ost),[i,l]=p.useState(!1),[c,d]=p.useState(!1),[u,f]=p.useState(null),[h,m]=p.useState(null),[v,g]=p.useState(""),[y,x]=p.useState(!1),b=p.useRef(!1),w=p.useRef(!0);p.useEffect(()=>(w.current=!0,()=>{w.current=!1}),[]);const j=async()=>{try{const R=e?.codigo_empresa||null;if(!R&&!e?.id)return;const M=R?`team:list:${R}`:"team:list",U=setTimeout(()=>{if(w.current)try{const K=localStorage.getItem(M),q=K?JSON.parse(K):[];Array.isArray(q)&&q.length>0&&(console.warn("[Equipe] slow fallback: using cached snapshot"),o(q))}catch{}},5e3);let z=he.from("colaboradores").select("*").order("nome",{ascending:!0});R&&(z=z.eq("codigo_empresa",R));const{data:W,error:$}=await z;if($){if(!b.current){b.current=!0,setTimeout(j,800);return}throw $}let ve=(W||[]).map(K=>({id:K.id,name:K.nome||"",role:K.cargo||"user",status:K.ativo===!1?"inactive":"active",online:!1,permissions:{}}));const _e=r?.codigo_empresa&&e?.codigo_empresa&&r.codigo_empresa===e.codigo_empresa;if(r?.id&&_e&&(ve.some(q=>q.id===r.id)||(ve=[{id:r.id,name:r.nome||"Voc",role:r.cargo||"user",status:"active",online:!1,permissions:{}},...ve])),!w.current)return;o(ve);try{localStorage.setItem(M,JSON.stringify(ve))}catch{}}catch(R){console.error("Falha ao carregar equipe:",R);const M=e?.codigo_empresa||null,U=M?`team:list:${M}`:"team:list";try{const z=localStorage.getItem(U);z&&w.current&&o(JSON.parse(z))}catch{}}finally{b.current=!1}};p.useEffect(()=>{const R=e?.codigo_empresa||null;if(!(!t||!R)){try{const M=localStorage.getItem(`team:list:${R}`),U=M?JSON.parse(M):[];Array.isArray(U)&&U.length>0&&o(U)}catch{}j()}},[t,e?.codigo_empresa]),p.useEffect(()=>{const R=()=>{document.visibilityState==="visible"&&t&&(e?.codigo_empresa||e?.id)&&j()},M=()=>{t&&(e?.codigo_empresa||e?.id)&&j()};return document.addEventListener("visibilitychange",R),window.addEventListener("focus",M),()=>{document.removeEventListener("visibilitychange",R),window.removeEventListener("focus",M)}},[t,e?.codigo_empresa,e?.id]);const _=p.useMemo(()=>({total:s.length,active:s.filter(R=>R.status==="active").length,inactive:s.filter(R=>R.status==="inactive").length}),[s]),C=p.useMemo(()=>s.filter(R=>R.name.toLowerCase().includes(v.toLowerCase())||R.role.toLowerCase().includes(v.toLowerCase())),[s,v]),P=R=>{f(R),d(!0)},E=()=>{m(null),l(!0)},A=R=>{d(!1),m(R),l(!0)},F=R=>{m(R),l(!0)},D=async({name:R,role:M})=>{try{if(x(!0),!e?.codigo_empresa&&!e?.id)throw new Error("Empresa no encontrada para o usurio atual.");let U=e?.codigo_empresa||null;if(!U&&e?.id){const{data:z}=await he.from("empresas").select("codigo_empresa").eq("id",e.id).single();U=z?.codigo_empresa||null}if(!U)throw new Error("Empresa sem cdigo. Defina o cdigo da empresa antes de adicionar colaboradores.");if(h){const{error:z}=await he.from("colaboradores").update({nome:R,cargo:M}).eq("id",h.id);if(z)throw z;n({title:"Funcionrio atualizado",description:h.name,variant:"default"})}else{const{error:z}=await he.from("colaboradores").insert({codigo_empresa:U,nome:R,cargo:M,ativo:!0});if(z)throw z;n({title:"Funcionrio criado com sucesso",description:R,variant:"success"})}await j(),l(!1),m(null)}catch(U){n({title:"Erro ao salvar funcionrio",description:U.message||String(U),variant:"destructive"})}finally{x(!1)}},I=async R=>{try{if(!(e?.id||e?.codigo_empresa))return;const M=s[0]?.id;if(R.id===M){n({title:"Ao no permitida",description:"No  possvel desativar o primeiro funcionrio.",variant:"destructive"});return}if(r?.id&&R.id===r.id){n({title:"Ao no permitida",description:"Voc no pode desativar o seu prprio usurio.",variant:"destructive"});return}if(s.filter(z=>z.status==="active").length<=1){n({title:"Ao no permitida",description:"Deve haver pelo menos um funcionrio ativo.",variant:"destructive"});return}const{error:U}=await he.from("colaboradores").update({ativo:!1}).eq("id",R.id);if(U)throw U;n({title:"Funcionrio desativado",description:R.name}),await j()}catch(M){n({title:"Erro ao desativar",description:M.message||String(M),variant:"destructive"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-full flex flex-col",children:a.jsxs(jr.div,{variants:Tst,initial:"hidden",animate:"visible",children:[a.jsxs(jr.div,{variants:Rse,className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Gesto de Equipe"}),a.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"Controle de funcionrios, permisses e logs."})]}),a.jsxs(me,{onClick:E,disabled:!t||!e?.codigo_empresa,title:t?e?.codigo_empresa?"":"Empresa sem cdigo. Defina o cdigo da empresa antes.":"Aguardando autenticao...",children:[a.jsx(ns,{className:"mr-2 h-4 w-4"})," Novo Funcionrio"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsx(KE,{icon:yl,title:"Total",value:_.total,color:"text-brand"}),a.jsx(KE,{icon:Uue,title:"Ativos",value:_.active,color:"text-success"}),a.jsx(KE,{icon:$ue,title:"Desativados",value:_.inactive,color:"text-danger"})]}),a.jsx(jr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar por nome ou cargo...",className:"pl-9",value:v,onChange:R=>g(R.target.value)})]})}),a.jsx("div",{className:"md:hidden p-4 space-y-3",children:C.length===0?a.jsx("div",{className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."}):C.map((R,M)=>a.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",onClick:()=>P(R),children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",children:R.name}),a.jsx("p",{className:"text-sm text-text-muted mt-0.5",children:R.role})]}),a.jsx("span",{className:gr("inline-flex px-2 py-0.5 rounded-full text-xs font-semibold flex-shrink-0",R.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:R.status==="active"?"Ativo":"Inativo"})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx(me,{variant:"outline",size:"sm",onClick:U=>{U.stopPropagation(),P(R)},className:"flex-1",children:"Ver Detalhes"}),a.jsx(me,{variant:"outline",size:"sm",onClick:U=>{U.stopPropagation(),F(R)},children:a.jsx(xl,{className:"h-3 w-3"})}),a.jsxs(lb,{children:[a.jsx(cb,{asChild:!0,children:a.jsx(me,{variant:"outline",size:"sm",onClick:U=>U.stopPropagation(),children:a.jsx(IF,{className:"h-3 w-3"})})}),a.jsx(sx,{align:"end",children:a.jsx(gl,{className:"text-danger",disabled:M===0||s.filter(U=>U.status==="active").length<=1||r?.id&&R.id===r.id,onClick:U=>{U.stopPropagation(),I(R)},children:"Desativar"})})]})]})]},R.id))}),a.jsx("div",{className:"hidden md:block",children:a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Funcionrio"}),a.jsx(qn,{children:"Cargo"}),a.jsx(qn,{children:"Status"}),a.jsx(qn,{className:"w-[80px] text-center",children:"Aes"})]})}),a.jsxs(ml,{children:[C.length===0&&a.jsx(Wa,{children:a.jsx(Sn,{colSpan:4,className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."})}),C.map((R,M)=>a.jsxs(Wa,{className:"cursor-pointer",onClick:()=>P(R),children:[a.jsx(Sn,{className:"font-medium",children:a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("span",{children:R.name})})}),a.jsx(Sn,{children:R.role}),a.jsx(Sn,{children:a.jsx("span",{className:gr("px-2 py-1 text-xs font-semibold rounded-full",R.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:R.status==="active"?"Ativo":"Inativo"})}),a.jsx(Sn,{className:"text-center",children:a.jsxs(lb,{children:[a.jsx(cb,{asChild:!0,children:a.jsx(me,{variant:"ghost",className:"h-8 w-8 p-0 mx-auto",onClick:U=>U.stopPropagation(),children:a.jsx(IF,{className:"h-4 w-4"})})}),a.jsxs(sx,{align:"end",children:[a.jsx(gl,{onClick:U=>{U.stopPropagation(),P(R)},children:"Ver Detalhes"}),a.jsx(gl,{onClick:U=>{U.stopPropagation(),F(R)},children:"Editar"}),a.jsx(gl,{className:"text-danger",disabled:M===0||s.filter(U=>U.status==="active").length<=1||r?.id&&R.id===r.id,onClick:U=>{U.stopPropagation(),I(R)},children:"Desativar"})]})]})})]},R.id))]})]})})]})})]})}),a.jsx(Mst,{open:i,onOpenChange:l,member:h,onSave:D,loading:y}),a.jsx(Dst,{open:c,onOpenChange:d,member:u,onEdit:A})]})}const Lst="v2.0.0";function jm({title:e,icon:t,children:r,className:n="",collapsible:s=!1,defaultOpen:o=!0}){return s?a.jsx("div",{className:`bg-surface rounded-lg border border-border shadow-sm ${n}`,children:a.jsxs("details",{className:"group",open:o,children:[a.jsxs("summary",{className:"list-none cursor-pointer select-none p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t&&a.jsx(t,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"text-base font-semibold",children:e})]}),a.jsx("span",{className:"text-xs text-text-secondary group-open:rotate-180 transition-transform",children:""})]}),a.jsx("div",{className:"px-4 pb-4",children:r})]})}):a.jsxs("div",{className:`bg-surface rounded-lg border border-border shadow-sm p-4 ${n}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t&&a.jsx(t,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"text-base font-semibold",children:e})]}),r]})}function _m({label:e,value:t}){return a.jsxs("div",{className:"flex items-center justify-between gap-3 py-1 text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:e}),a.jsx("span",{className:"font-medium truncate",children:t||""})]})}function Fst(){const{userProfile:e,company:t,authReady:r,loading:n}=vs();Lo();const[s,o]=p.useState("Agenda"),[i,l]=p.useState("Mdia"),[c,d]=p.useState(""),[u,f]=p.useState(""),[h,m]=p.useState(!0),[v,g]=p.useState(()=>window.__installPrompt||null),[y,x]=p.useState(!1),[b,w]=p.useState(!1),[j,_]=p.useState(!1),[C,P]=p.useState("unknown"),E="Fluxo7 Arena",A="fluxo7team@gmail.com",F="https://wa.me/5534998936088",D="tel:+5534998936088",I="+55 (34) 99893-6088";p.useEffect(()=>{try{const ee=window.matchMedia("(pointer:fine)"),ve=()=>m(ee.matches);return ve(),ee.addEventListener?.("change",ve),()=>ee.removeEventListener?.("change",ve)}catch{m(!0)}},[]),p.useEffect(()=>{const ee=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;w(ee);const ve=navigator.userAgent;ve.includes("Chrome")&&!ve.includes("Edg")?P("chrome"):ve.includes("Edg")?P("edge"):ve.includes("Firefox")?P("firefox"):ve.includes("Safari")&&!ve.includes("Chrome")?P("safari"):P("other"),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&x(!0),window.__installPrompt&&!v&&g(window.__installPrompt);const _e=()=>{x(!0),g(null),_(!1)};return window.addEventListener("appinstalled",_e),()=>{window.removeEventListener("appinstalled",_e)}},[v]);const R=async()=>{if(v)try{await v.prompt();const{outcome:ee}=await v.userChoice;ee==="accepted"?(x(!0),_(!1)):_(!0),g(null),window.__installPrompt=null}catch(ee){console.error("Erro ao mostrar prompt de instalao:",ee),_(!0)}else _(!0)},M=()=>{navigator.share?navigator.share({title:"F7 Arena",text:"Adicione F7 Arena  sua tela inicial",url:window.location.href}).catch(()=>{alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)}):alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)},U=p.useMemo(()=>{try{return{empresa:t?.nome||t?.fantasia||t?.razao_social||t?.razaoSocial||t?.displayName||t?.codigo_empresa||"",usuario:e?.nome||e?.name||e?.email||"",dataHora:new Date().toLocaleString("pt-BR")}}catch{return{empresa:"",usuario:"",dataHora:new Date().toLocaleString("pt-BR")}}},[t?.nome,t?.fantasia,t?.razao_social,t?.razaoSocial,t?.displayName,t?.codigo_empresa,e?.nome,e?.name,e?.email]),z=p.useMemo(()=>[`[${E} - Suporte]`,`Assunto: ${c||"(sem assunto)"} `,`Categoria: ${s} `,`Severidade: ${i}`,"","Descrio:",(u||"(adicione uma descrio detalhada, passos para reproduzir, prints se possvel)")+`
`," Dados ",`Empresa: ${U.empresa}`,`Usurio: ${U.usuario}`,`Data e Hora: ${U.dataHora}`].join(`
`),[c,s,i,u,U]),W=`${F}?text=${encodeURIComponent(z)}`,$=`mailto:${A}?subject=${encodeURIComponent(`[Suporte] ${c||"Assunto"}`)}&body=${encodeURIComponent(z)}`;return a.jsxs("div",{className:"px-4 md:px-6 lg:px-8 py-4 md:py-6",children:[a.jsxs("div",{className:"bg-surface rounded-xl border border-border p-5 md:p-6 mb-6",children:[a.jsxs("div",{className:"flex items-start md:items-center justify-between gap-4 flex-col md:flex-row",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand/10 border border-brand/30 flex items-center justify-center",children:a.jsx(BH,{className:"w-5 h-5 text-brand"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"Suporte"}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Precisa de ajuda? Fale com a gente ou consulte as respostas rpidas abaixo."})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center",children:a.jsx(Sc,{className:"w-6 h-6 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-base md:text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),a.jsxs("div",{className:"text-xs text-text-secondary mt-1",children:["Verso ",Lst]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[a.jsx(jm,{title:"Status",icon:C2,children:a.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[a.jsx(_m,{label:"Empresa",value:U.empresa}),a.jsx(_m,{label:"Usurio",value:`${U.usuario}`})]})}),a.jsx(jm,{title:"Fale com a gente",icon:VA,children:a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("a",{href:F,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[a.jsx(VA,{className:"w-4 h-4"})," WhatsApp"]}),a.jsxs("a",{href:`mailto:${A}`,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(yx,{className:"w-4 h-4"})," E-mail"]}),a.jsxs("a",{href:D,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(Ub,{className:"w-4 h-4"})," ",h?I:"Telefone"]})]})}),!y&&b&&a.jsx(jm,{title:"Adicionar  Tela Inicial",icon:WA,children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-sm text-text-secondary",children:"Crie um atalho do F7 Arena na sua tela inicial para acesso rpido."}),a.jsxs("button",{onClick:M,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[a.jsx(TF,{className:"w-4 h-4"})," Criar Atalho"]}),a.jsxs("details",{className:"text-xs text-text-muted",children:[a.jsx("summary",{className:"cursor-pointer hover:text-text-secondary",children:"Como fazer manualmente?"}),a.jsxs("div",{className:"mt-2 space-y-1 pl-2",children:[a.jsxs("p",{children:["1. Toque no boto ",a.jsx(TF,{className:"inline w-3 h-3"})," (Compartilhar)"]}),a.jsx("p",{children:'2. Role para baixo e toque em "Adicionar  Tela de Incio"'}),a.jsx("p",{children:'3. Toque em "Adicionar"'})]})]})]})}),!y&&!b&&a.jsx(jm,{title:"Instalar Aplicativo",icon:WA,children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm text-text-secondary",children:"Instale o F7 Arena no seu dispositivo para acesso rpido e experincia completa de aplicativo."}),a.jsxs("button",{onClick:R,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[a.jsx(ho,{className:"w-4 h-4"})," Instalar App"]}),a.jsx("p",{className:"text-xs text-text-muted text-center",children:"Pode demorar alguns segundos. Se no aparecer nada, veja as instrues no tutorial."})]})}),y&&a.jsx(jm,{title:"Aplicativo Instalado",icon:C2,children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-success",children:[a.jsx(C2,{className:"w-4 h-4"}),a.jsx("span",{children:"F7 Arena est instalado no seu dispositivo!"})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-2 space-y-3",children:a.jsx(jm,{title:"Perguntas Frequentes (FAQ)",children:a.jsxs("div",{className:"divide-y divide-border/60",children:[a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como abrir comanda de balco?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o caixa antes. A tela de balco utiliza uma comanda sem mesa (mesa_id nulo). Se no existir, o sistema cria ao abrir o balco; caso o caixa esteja fechado, a abertura da comanda  bloqueada."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Por que no consigo fechar o caixa?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"O fechamento  bloqueado se houver comandas com itens em aberto (inclui balco e mesas). Finalize ou feche as comandas pendentes antes de encerrar o caixa."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como adicionar participantes no agendamento?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"No modal de agendamento, selecione um ou mais clientes. Aps salvar, o chip de pagamentos  atualizado imediatamente. Se no visualizar, recarregue os dados da agenda."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ver o histrico completo do cliente?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o cliente e utilize o Histrico Recente, que combina comandas e agendamentos em uma nica timeline com totais e status."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ajustar estoque mnimo e ver mais vendidos?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Na aba de Produtos voc pode gerenciar estoque, preos e relatrios. Utilize filtros e exportaes para anlise."})]})]})})}),a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"space-y-3 lg:sticky lg:top-6",children:[a.jsx(jm,{title:"Reportar um problema",icon:pue,collapsible:!0,defaultOpen:!1,children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Categoria"}),a.jsxs("select",{value:s,onChange:ee=>o(ee.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[a.jsx("option",{children:"Agenda"}),a.jsx("option",{children:"Vendas"}),a.jsx("option",{children:"Clientes"}),a.jsx("option",{children:"Produtos"}),a.jsx("option",{children:"Financeiro"}),a.jsx("option",{children:"Outros"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Severidade"}),a.jsxs("select",{value:i,onChange:ee=>l(ee.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[a.jsx("option",{children:"Baixa"}),a.jsx("option",{children:"Mdia"}),a.jsx("option",{children:"Alta"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Assunto"}),a.jsx("input",{value:c,onChange:ee=>d(ee.target.value),placeholder:"Ex.: Erro ao salvar agendamento",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Descrio"}),a.jsx("textarea",{value:u,onChange:ee=>f(ee.target.value),rows:4,placeholder:"Descreva o que aconteceu, passos para reproduzir, expectativa.",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border resize-y"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 pt-1",children:[a.jsxs("a",{href:W,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[a.jsx(VA,{className:"w-4 h-4"})," Enviar no WhatsApp"]}),a.jsxs("a",{href:$,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(yx,{className:"w-4 h-4"})," Enviar por E-mail"]}),a.jsxs("a",{href:D,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(Ub,{className:"w-4 h-4"})," ",h?I:"Ligar agora"]})]})]})}),a.jsx(jm,{title:"Diagnstico",icon:wue,children:a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsx(_m,{label:"Empresa",value:U.empresa}),a.jsx(_m,{label:"Usurio",value:`${U.usuario}`}),a.jsx(_m,{label:"Data/Hora",value:U.dataHora}),a.jsx(_m,{label:"Canal - WhatsApp",value:"(34) 99893-6088"}),a.jsx(_m,{label:"Canal - E-mail",value:"fluxo7team@gmail.com"}),a.jsx(_m,{label:"Canal - Telefone",value:"(34) 99893-6088"})]})})]})})]}),a.jsx(xn,{open:j,onOpenChange:_,children:a.jsxs(vn,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[a.jsx(pn,{children:a.jsxs(un,{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-brand/10 border border-brand/30 flex items-center justify-center",children:a.jsx(ho,{className:"w-6 h-6 text-brand"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Como Instalar o F7 Arena"}),a.jsx("p",{className:"text-sm text-text-secondary font-normal",children:"Siga as instrues para o seu navegador"})]})]})}),a.jsxs("div",{className:"mt-6 space-y-6",children:[(C==="chrome"||C==="edge")&&a.jsxs("div",{className:"bg-gradient-to-br from-brand/10 to-brand/5 rounded-xl p-6 border-2 border-brand/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand flex items-center justify-center",children:a.jsx(yue,{className:"w-6 h-6 text-black"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Chrome (Celular)"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"1"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",a.jsx("span",{className:"text-2xl",children:""})]}),a.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"No canto superior direito da tela"}),a.jsx("div",{className:"bg-background/50 rounded-md p-3 border border-border/50",children:a.jsx("p",{className:"text-xs text-text-muted",children:" Os 3 pontinhos ficam ao lado da barra de endereo"})})]})]})}),a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"2"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),a.jsxs("div",{className:"space-y-2 mb-3",children:[a.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar aplicativo"'})}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[a.jsx("div",{className:"h-px bg-border flex-1"}),a.jsx("span",{children:"OU"}),a.jsx("div",{className:"h-px bg-border flex-1"})]}),a.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Toque em qualquer uma dessas opes no menu"})]})]})}),a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"3"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold mb-2",children:"Confirme a instalao"}),a.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Aparecer uma janela perguntando se deseja instalar"}),a.jsx("div",{className:"bg-success/10 rounded-md p-3 border border-success/30",children:a.jsx("p",{className:"text-sm font-medium text-center",children:' Toque em "Instalar"'})})]})]})}),a.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[a.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),a.jsx("p",{className:"text-xs text-text-secondary",children:"O app aparecer na sua tela inicial e voc poder abri-lo como qualquer outro aplicativo!"})]})]})]}),C==="firefox"&&a.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-orange-500/5 rounded-xl p-6 border-2 border-orange-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500 flex items-center justify-center",children:a.jsx(Lue,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Firefox (Celular)"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"1"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",a.jsx("span",{className:"text-2xl",children:""})]}),a.jsx("p",{className:"text-sm text-text-secondary",children:"No canto inferior direito da tela"})]})]})}),a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"2"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar"'})}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[a.jsx("div",{className:"h-px bg-border flex-1"}),a.jsx("span",{children:"OU"}),a.jsx("div",{className:"h-px bg-border flex-1"})]}),a.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]})]})]})}),a.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[a.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),a.jsx("p",{className:"text-xs text-text-secondary",children:"O app ser adicionado  sua tela inicial!"})]})]})]}),(C==="safari"||C==="other")&&a.jsxs("div",{className:"bg-gradient-to-br from-purple-500/10 to-purple-500/5 rounded-xl p-6 border-2 border-purple-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500 flex items-center justify-center",children:a.jsx(WA,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Outros Navegadores"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Instrues gerais"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[a.jsx("p",{className:"font-semibold mb-3",children:"Procure no menu do navegador:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:a.jsx("p",{className:"font-medium",children:' "Instalar aplicativo"'})}),a.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:a.jsx("p",{className:"font-medium",children:' "Adicionar  tela inicial"'})}),a.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:a.jsx("p",{className:"font-medium",children:' "Criar atalho"'})})]})]}),a.jsx("div",{className:"bg-background/50 rounded-lg p-4 border border-border/50",children:a.jsx("p",{className:"text-sm text-text-muted",children:" Geralmente a opo est no menu de 3 pontos ou 3 linhas do navegador"})})]})]}),a.jsxs("div",{className:"bg-brand/5 rounded-lg p-4 border border-brand/20",children:[a.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[a.jsx(C2,{className:"w-5 h-5 text-brand"}),"Benefcios do App Instalado"]}),a.jsxs("ul",{className:"space-y-1.5 text-sm text-text-secondary",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Acesso rpido direto da rea de trabalho ou menu iniciar"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Funciona em tela cheia, sem barras do navegador"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Notificaes e atualizaes automticas"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Melhor desempenho e experincia de uso"]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2.5 rounded-md bg-surface-2 hover:bg-surface text-text-primary font-medium transition",children:"Entendi"})})]})]})})]})}function Lse(e,t,r,n,s){n=n||{};var o=1.15,i=s.internal.scaleFactor,l=s.internal.getFontSize()/i,c=s.getLineHeightFactor?s.getLineHeightFactor():o,d=l*c,u=/\r\n|\r|\n/g,f="",h=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(u):e,h=f.length||1),r+=l*(2-o),n.valign==="middle"?r-=h/2*d:n.valign==="bottom"&&(r-=h*d),n.halign==="center"||n.halign==="right"){var m=l;if(n.halign==="center"&&(m*=.5),f&&h>=1){for(var v=0;v<f.length;v++)s.text(f[v],t-s.getStringUnitWidth(f[v])*m,r),r+=d;return s}t-=s.getStringUnitWidth(e)*m}return n.halign==="justify"?s.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(e,t,r),s}var MU={},lx=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:MU=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,s,o;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),l=i.fontStyle,c=i.fontName;if(t.font&&(c=t.font),t.fontStyle){l=t.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=e.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=e.unifyColor(t.textColor),u&&(s=this.jsPDFDocument).setTextColor.apply(s,u),u=e.unifyColor(t.lineColor),u&&(o=this.jsPDFDocument).setDrawColor.apply(o,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,s,o){return this.jsPDFDocument.rect(t,r,n,s,o)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return MU||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),ZT=function(e,t){return ZT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},ZT(e,t)};function Fse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ZT(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var $se=function(e){Fse(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function $st(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Bst(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function kS(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],s=n.map(function(o){return r.getTextWidth(o)}).reduce(function(o,i){return Math.max(o,i)},0);return s}function Bse(e,t,r,n){var s=t.settings.tableLineWidth,o=t.settings.tableLineColor;e.applyStyles({lineWidth:s,lineColor:o});var i=qse(s,!1);i&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,i)}function qse(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function sA(e,t){var r,n,s,o;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(s=e.right)!==null&&s!==void 0?s:t,bottom:(o=e.bottom)!==null&&o!==void 0?o:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function zse(e,t){var r=sA(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function qst(e,t,r,n,s){var o={},i=1.3333333333333333,l=XE(t,function(w){return s.getComputedStyle(w).backgroundColor});l!=null&&(o.fillColor=l);var c=XE(t,function(w){return s.getComputedStyle(w).color});c!=null&&(o.textColor=c);var d=Ust(n,r);d&&(o.cellPadding=d);var u="borderTopColor",f=i*r,h=n.borderTopWidth;if(n.borderBottomWidth===h&&n.borderRightWidth===h&&n.borderLeftWidth===h){var m=(parseFloat(h)||0)/f;m&&(o.lineWidth=m)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},o.lineWidth.top||(o.lineWidth.right?u="borderRightColor":o.lineWidth.bottom?u="borderBottomColor":o.lineWidth.left&&(u="borderLeftColor"));var v=XE(t,function(w){return s.getComputedStyle(w)[u]});v!=null&&(o.lineColor=v);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var y=parseInt(n.fontSize||"");isNaN(y)||(o.fontSize=y/i);var x=zst(n);x&&(o.fontStyle=x);var b=(n.fontFamily||"").toLowerCase();return e.indexOf(b)!==-1&&(o.font=b),o}function zst(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function XE(e,t){var r=Use(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function Use(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:Use(e.parentElement,t):r}function Ust(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),s=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,o=r.map(function(l){return parseInt(l||"0")/n}),i=sA(o,0);return s>i.top&&(i.top=s),s>i.bottom&&(i.bottom=s),i}function Vse(e,t,r,n,s){var o,i;n===void 0&&(n=!1),s===void 0&&(s=!1);var l;typeof t=="string"?l=r.document.querySelector(t):l=t;var c=Object.keys(e.getFontList()),d=e.scaleFactor(),u=[],f=[],h=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:u,body:f,foot:h};for(var m=0;m<l.rows.length;m++){var v=l.rows[m],g=(i=(o=v?.parentElement)===null||o===void 0?void 0:o.tagName)===null||i===void 0?void 0:i.toLowerCase(),y=Vst(c,d,r,v,n,s);y&&(g==="thead"?u.push(y):g==="tfoot"?h.push(y):f.push(y))}return{head:u,body:f,foot:h}}function Vst(e,t,r,n,s,o){for(var i=new $se(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(s||d.display!=="none"){var u=void 0;o&&(u=qst(e,c,t,d,r)),i.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:Wst(c)})}}var f=r.getComputedStyle(n);if(i.length>0&&(s||f.display!=="none"))return i}function Wst(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Hst(e,t,r){for(var n=0,s=[e,t,r];n<s.length;n++){var o=s[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function Of(e,t,r,n,s){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),i=1;i<arguments.length;i++){var l=arguments[i];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(o[c]=l[c])}return o}function OR(e,t){var r=new lx(e),n=r.getDocumentOptions(),s=r.getGlobalOptions();Hst(s,n,t);var o=Of({},s,n,t),i;typeof window<"u"&&(i=window);var l=Gst(s,n,t),c=Kst(s,n,t),d=Xst(r,o),u=Jst(r,o,i);return{id:t.tableId,content:u,hooks:c,styles:l,settings:d}}function Gst(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(c){if(c==="columnStyles"){var d=e[c],u=t[c],f=r[c];n.columnStyles=Of({},d,u,f)}else{var h=[e,t,r],m=h.map(function(v){return v[c]||{}});n[c]=Of({},m[0],m[1],m[2])}},o=0,i=Object.keys(n);o<i.length;o++){var l=i[o];s(l)}return n}function Kst(e,t,r){for(var n=[e,t,r],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,i=n;o<i.length;o++){var l=i[o];l.didParseCell&&s.didParseCell.push(l.didParseCell),l.willDrawCell&&s.willDrawCell.push(l.willDrawCell),l.didDrawCell&&s.didDrawCell.push(l.didDrawCell),l.willDrawPage&&s.willDrawPage.push(l.willDrawPage),l.didDrawPage&&s.didDrawPage.push(l.didDrawPage)}return s}function Xst(e,t){var r,n,s,o,i,l,c,d,u,f,h,m,v=sA(t.margin,40/e.scaleFactor()),g=(r=Yst(e,t.startY))!==null&&r!==void 0?r:v.top,y;t.showFoot===!0?y="everyPage":t.showFoot===!1?y="never":y=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var x;t.showHead===!0?x="everyPage":t.showHead===!1?x="never":x=(s=t.showHead)!==null&&s!==void 0?s:"everyPage";var b=(o=t.useCss)!==null&&o!==void 0?o:!1,w=t.theme||(b?"plain":"striped"),j=!!t.horizontalPageBreak,_=(i=t.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(l=t.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:b,theme:w,startY:g,margin:v,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=t.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:x,showFoot:y,tableLineWidth:(f=t.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(h=t.tableLineColor)!==null&&h!==void 0?h:200,horizontalPageBreak:j,horizontalPageBreakRepeat:_,horizontalPageBreakBehaviour:(m=t.horizontalPageBreakBehaviour)!==null&&m!==void 0?m:"afterAllRows"}}function Yst(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),s=e.pageNumber(),o=!1;if(r&&r.startPageNumber){var i=r.startPageNumber+r.pageNumber-1;o=i===s}return typeof t=="number"?t:(t==null||t===!1)&&o&&r?.finalY!=null?r.finalY+20/n:null}function Jst(e,t,r){var n=t.head||[],s=t.body||[],o=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(r){var l=Vse(e,t.html,r,i,t.useCss)||{};n=l.head||n,s=l.body||n,o=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||Qst(n,s,o);return{columns:c,head:n,body:s,foot:o}}function Qst(e,t,r){var n=e[0]||t[0]||r[0]||[],s=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var i=1,l;Array.isArray(n)?l=n[parseInt(o)]:l=n[o],typeof l=="object"&&!Array.isArray(l)&&(i=l?.colSpan||1);for(var c=0;c<i;c++){var d=void 0;Array.isArray(n)?d=s.length:d=o+(c>0?"_".concat(c):"");var u={dataKey:d};s.push(u)}}),s}var IS=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),Wse=function(e){Fse(t,e);function t(r,n,s,o,i,l){var c=e.call(this,r,n,l)||this;return c.cell=s,c.row=o,c.column=i,c.section=o.section,c}return t}(IS),Hse=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,s,o,i){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new Wse(t,this,n,s,o,i),f=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var o=s[n];o(new IS(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var o=s[n];o(new IS(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(s,o){return s+o.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),TR=function(){function e(t,r,n,s,o){o===void 0&&(o=!1),this.height=0,this.raw=t,t instanceof $se&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=s,this.spansMultiplePages=o}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,s){var o;return Math.max(n,((o=r.cells[s.index])===null||o===void 0?void 0:o.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var s=r.cells[n.index];return s?s.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(s,o){var i=n.cells[o.index];if(!i)return 0;var l=r.getLineHeight(i.styles.fontSize),c=i.padding("vertical"),d=c+l;return d>s?d:s},0)},e}(),DR=function(){function e(t,r,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var o=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,o=(s=t.content)!==null&&s!==void 0?s:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var i=o!=null?""+o:"",l=/\r\n|\r|\n/g;this.text=i.split(l)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/t*r,o=n*s+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=sA(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),Gse=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,s=t.allRows();n<s.length;n++){var o=s[n],i=o.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(r=Math.max(r,i.styles.cellWidth))}return r},e}();function Zst(e,t){eot(e,t);var r=[],n=0;t.columns.forEach(function(o){var i=o.getMaxCustomCellWidth(t);i?o.width=i:(o.width=o.wrappedWidth,r.push(o)),n+=o.width});var s=t.getWidth(e.pageSize().width)-n;s&&(s=e3(r,s,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),s&&(s=e3(r,s,function(o){return o.minWidth})),s=Math.abs(s),!t.settings.horizontalPageBreak&&s>.1/e.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),rot(t),not(t,e),tot(t)}function eot(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,s=zse(e,t);t.allRows().forEach(function(o){for(var i=0,l=t.columns;i<l.length;i++){var c=l[i],d=o.cells[c.index];if(d){var u=t.hooks.didParseCell;t.callCellHooks(e,u,d,o,c,null);var f=d.padding("horizontal");d.contentWidth=kS(d.text,d.styles,e)+f;var h=kS(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,e);if(d.minReadableWidth=h+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>s?(d.minWidth=s,d.wrappedWidth=s):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var m=10/r;d.minWidth=d.styles.minCellWidth||m,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),t.allRows().forEach(function(o){for(var i=0,l=t.columns;i<l.length;i++){var c=l[i],d=o.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},f=u.cellWidth||u.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function e3(e,t,r){for(var n=t,s=e.reduce(function(m,v){return m+v.wrappedWidth},0),o=0;o<e.length;o++){var i=e[o],l=i.wrappedWidth/s,c=n*l,d=i.width+c,u=r(i),f=d<u?u:d;t-=f-i.width,i.width=f}if(t=Math.round(t*1e10)/1e10,t){var h=e.filter(function(m){return t<0?m.width>r(m):!0});h.length&&(t=e3(h,t,r))}return t}function tot(e){for(var t={},r=1,n=e.allRows(),s=0;s<n.length;s++)for(var o=n[s],i=0,l=e.columns;i<l.length;i++){var c=l[i],d=t[c.index];if(r>1)r--,delete o.cells[c.index];else if(d)d.cell.height+=o.height,r=d.cell.colSpan,delete o.cells[c.index],d.left--,d.left<=1&&delete t[c.index];else{var u=o.cells[c.index];if(!u)continue;if(u.height=o.height,u.rowSpan>1){var f=n.length-s,h=u.rowSpan>f?f:u.rowSpan;t[c.index]={cell:u,left:h,row:o}}}}}function rot(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],s=null,o=0,i=0,l=0;l<e.columns.length;l++){var c=e.columns[l];if(i-=1,i>1&&e.columns[l+1])o+=c.width,delete n.cells[c.index];else if(s){var d=s;delete n.cells[c.index],s=null,d.width=c.width+o}else{var d=n.cells[c.index];if(!d)continue;if(i=d.colSpan,o=0,d.colSpan>1){s=d,o+=c.width;continue}d.width=c.width+o}}}function not(e,t){for(var r={count:0,height:0},n=0,s=e.allRows();n<s.length;n++){for(var o=s[n],i=0,l=e.columns;i<l.length;i++){var c=l[i],d=o.cells[c.index];if(d){t.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=t.splitTextToSize(d.text,u+1/t.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=RU(d.text,u,d.styles,t,"...");else if(d.styles.overflow==="hidden")d.text=RU(d.text,u,d.styles,t,"");else if(typeof d.styles.overflow=="function"){var f=d.styles.overflow(d.text,u);typeof f=="string"?d.text=[f]:d.text=f}d.contentHeight=d.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var h=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<h*d.rowSpan?r={height:h,count:d.rowSpan}:r&&r.count>0&&r.height>h&&(h=r.height),h>o.height&&(o.height=h)}}r.count--}}function RU(e,t,r,n,s){return e.map(function(o){return aot(o,t,r,n,s)})}function aot(e,t,r,n,s){var o=1e4*n.scaleFactor();if(t=Math.ceil(t*o)/o,t>=kS(e,r,n))return e;for(;t<kS(e+s,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+s}function MR(e,t){var r=new lx(e),n=sot(t,r.scaleFactor()),s=new Hse(t,n);return Zst(r,s),r.applyStyles(r.userStyles),s}function sot(e,t){var r=e.content,n=iot(r.columns);if(r.head.length===0){var s=LU(n,"head");s&&r.head.push(s)}if(r.foot.length===0){var s=LU(n,"foot");s&&r.foot.push(s)}var o=e.settings.theme,i=e.styles;return{columns:n,head:YE("head",r.head,n,i,o,t),body:YE("body",r.body,n,i,o,t),foot:YE("foot",r.foot,n,i,o,t)}}function YE(e,t,r,n,s,o){var i={},l=t.map(function(c,d){for(var u=0,f={},h=0,m=0,v=0,g=r;v<g.length;v++){var y=g[v];if(i[y.index]==null||i[y.index].left===0)if(m===0){var x=void 0;Array.isArray(c)?x=c[y.index-h-u]:x=c[y.dataKey];var b={};typeof x=="object"&&!Array.isArray(x)&&(b=x?.styles||{});var w=lot(e,y,d,s,n,o,b),j=new DR(x,w,e);f[y.dataKey]=j,f[y.index]=j,m=j.colSpan-1,i[y.index]={left:j.rowSpan-1,times:m}}else m--,h++;else i[y.index].left--,m=i[y.index].times,u++}return new TR(c,d,e,f)});return l}function LU(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var s=oot(t,n.raw);s!=null&&(r[n.dataKey]=s)}}),Object.keys(r).length>0?r:null}function oot(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function iot(e){return e.map(function(t,r){var n,s;return typeof t=="object"?s=(n=t.dataKey)!==null&&n!==void 0?n:r:s=r,new Gse(s,t,r)})}function lot(e,t,r,n,s,o,i){var l=Bst(n),c;e==="head"?c=s.headStyles:e==="body"?c=s.bodyStyles:e==="foot"&&(c=s.footStyles);var d=Of({},l.table,l[e],s.styles,c),u=s.columnStyles[t.dataKey]||s.columnStyles[t.index]||{},f=e==="body"?u:{},h=e==="body"&&r%2===0?Of({},l.alternateRow,s.alternateRowStyles):{},m=$st(o),v=Of({},m,d,h,f);return Of(v,i)}function cot(e,t,r){var n;r===void 0&&(r={});var s=zse(e,t),o=new Map,i=[],l=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(h){var m=t.columns.find(function(v){return v.dataKey===h||v.index===h});m&&!o.has(m.index)&&(o.set(m.index,!0),i.push(m.index),l.push(t.columns[m.index]),s-=m.wrappedWidth)});for(var d=!0,u=(n=r?.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(o.has(u)){u++;continue}var f=t.columns[u].wrappedWidth;if(d||s>=f)d=!1,i.push(u),l.push(t.columns[u]),s-=f;else break;u++}return{colIndexes:i,columns:l,lastIndex:u-1}}function dot(e,t){for(var r=[],n=0;n<t.columns.length;n++){var s=cot(e,t,{start:n});s.columns.length&&(r.push(s),n=s.lastIndex)}return r}function RR(e,t){var r=t.settings,n=r.startY,s=r.margin,o={x:s.left,y:n},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=n+s.bottom+i;if(r.pageBreak==="avoid"){var c=t.body,d=c.reduce(function(h,m){return h+m.height},0);l+=d}var u=new lx(e);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(Xse(u),o.y=s.top),t.callWillDrawPageHooks(u,o);var f=Of({},o);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?uot(u,t,f,o):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(h){return Qf(u,t,h,o,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(h,m){var v=m===t.body.length-1;OS(u,t,h,v,f,o,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(h){return Qf(u,t,h,o,t.columns)})),Bse(u,t,f,o),t.callEndPageHooks(u,o),t.finalY=o.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function uot(e,t,r,n){var s=dot(e,t),o=t.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(d,u){e.applyStyles(e.userStyles),u>0?jb(e,t,r,n,d.columns,!0):FU(e,t,n,d.columns),fot(e,t,r,n,d.columns),JE(e,t,n,d.columns)});else for(var i=-1,l=s[0],c=function(){var d=i;if(l){e.applyStyles(e.userStyles);var u=l.columns;i>=0?jb(e,t,r,n,u,!0):FU(e,t,n,u),d=$U(e,t,i+1,n,u),JE(e,t,n,u)}var f=d-i;s.slice(1).forEach(function(h){e.applyStyles(e.userStyles),jb(e,t,r,n,h.columns,!0),$U(e,t,i+1,n,h.columns,f),JE(e,t,n,h.columns)}),i=d};i<t.body.length-1;)c()}function FU(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&t.head.forEach(function(o){return Qf(e,t,o,r,n)})}function fot(e,t,r,n,s){e.applyStyles(e.userStyles),t.body.forEach(function(o,i){var l=i===t.body.length-1;OS(e,t,o,l,r,n,s)})}function $U(e,t,r,n,s,o){e.applyStyles(e.userStyles),o=o??t.body.length;var i=Math.min(r+o,t.body.length),l=-1;return t.body.slice(r,i).forEach(function(c,d){var u=r+d===t.body.length-1,f=Kse(e,t,u,n);c.canEntireRowFit(f,s)&&(Qf(e,t,c,n,s),l=r+d)}),l}function JE(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&t.foot.forEach(function(o){return Qf(e,t,o,r,n)})}function mot(e,t,r){var n=r.getLineHeight(e.styles.fontSize),s=e.padding("vertical"),o=Math.floor((t-s)/n);return Math.max(0,o)}function hot(e,t,r,n){var s={};e.spansMultiplePages=!0,e.height=0;for(var o=0,i=0,l=r.columns;i<l.length;i++){var c=l[i],d=e.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new DR(d.raw,d.styles,d.section);u=Of(u,d),u.text=[];var f=mot(d,t,n);d.text.length>f&&(u.text=d.text.splice(f,d.text.length));var h=n.scaleFactor(),m=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(h,m),d.contentHeight>=t&&(d.contentHeight=t,u.styles.minCellHeight-=t),d.contentHeight>e.height&&(e.height=d.contentHeight),u.contentHeight=u.getContentHeight(h,m),u.contentHeight>o&&(o=u.contentHeight),s[c.index]=u}}var v=new TR(e.raw,-1,e.section,s,!0);v.height=o;for(var g=0,y=r.columns;g<y.length;g++){var c=y[g],u=v.cells[c.index];u&&(u.height=v.height);var d=e.cells[c.index];d&&(d.height=e.height)}return v}function pot(e,t,r,n){var s=e.pageSize().height,o=n.settings.margin,i=o.top+o.bottom,l=s-i;t.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,e),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=t.hasRowSpan(n.columns),f=t.getMaxCellHeight(n.columns)>l;return f?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function OS(e,t,r,n,s,o,i){var l=Kse(e,t,n,o);if(r.canEntireRowFit(l,i))Qf(e,t,r,o,i);else if(pot(e,r,l,t)){var c=hot(r,l,t,e);Qf(e,t,r,o,i),jb(e,t,s,o,i),OS(e,t,c,n,s,o,i)}else jb(e,t,s,o,i),OS(e,t,r,n,s,o,i)}function Qf(e,t,r,n,s){n.x=t.settings.margin.left;for(var o=0,i=s;o<i.length;o++){var l=i[o],c=r.cells[l.index];if(!c){n.x+=l.width;continue}e.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=t.callCellHooks(e,t.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}got(e,c,n);var u=c.getTextPos();Lse(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function got(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=qse(n.lineWidth,n.fillColor);s&&e.rect(t.x,r.y,t.width,t.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),vot(e,t,r,n.lineWidth))}function vot(e,t,r,n){var s,o,i,l;n.top&&(s=r.x,o=r.y,i=r.x+t.width,l=r.y,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.top,s,o,i,l)),n.bottom&&(s=r.x,o=r.y+t.height,i=r.x+t.width,l=r.y+t.height,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.bottom,s,o,i,l)),n.left&&(s=r.x,o=r.y,i=r.x,l=r.y+t.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,s,o,i,l)),n.right&&(s=r.x+t.width,o=r.y,i=r.x+t.width,l=r.y+t.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,s,o,i,l));function c(d,u,f,h,m){e.getDocument().setLineWidth(d),e.getDocument().line(u,f,h,m,"S")}}function Kse(e,t,r,n){var s=t.settings.margin.bottom,o=t.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&r)&&(s+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-s}function jb(e,t,r,n,s,o){s===void 0&&(s=[]),o===void 0&&(o=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!o&&t.foot.forEach(function(l){return Qf(e,t,l,n,s)}),t.callEndPageHooks(e,n);var i=t.settings.margin;Bse(e,t,r,n),Xse(e),t.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(l){return Qf(e,t,l,n,s)}),e.applyStyles(e.userStyles))}function Xse(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function Yse(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],s=OR(this,n),o=MR(this,s);return RR(this,o),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,s){Lse(t,r,n,s,this)},e.API.autoTableSetDefaults=function(t){return lx.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){lx.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new lx(this),o=Vse(s,t,window,r,!1),i=o.head,l=o.body,c=((n=i[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var QE;function BU(e,t){var r=OR(e,t),n=MR(e,r);RR(e,n)}function xot(e,t){var r=OR(e,t);return MR(e,r)}function yot(e,t){RR(e,t)}try{if(typeof window<"u"&&window){var qU=window,zU=qU.jsPDF||((QE=qU.jspdf)===null||QE===void 0?void 0:QE.jsPDF);zU&&Yse(zU)}}catch(e){console.error("Could not apply autoTable plugin",e)}const bot=Object.freeze(Object.defineProperty({__proto__:null,Cell:DR,CellHookData:Wse,Column:Gse,HookData:IS,Row:TR,Table:Hse,__createTable:xot,__drawTable:yot,applyPlugin:Yse,autoTable:BU,default:BU},Symbol.toStringTag,{value:"Module"})),wot={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.08,delayChildren:.1}}},dl={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function jj({icon:e,label:t,value:r,delta:n,positive:s=!0,color:o="brand"}){return a.jsxs(jr.div,{variants:dl,className:"fx-card border-0 ring-0 outline-none shadow-none",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[a.jsx(e,{className:`w-4 h-4 text-${o}`}),a.jsx("span",{children:t})]}),n!=null&&a.jsxs("div",{className:`text-xs font-bold ${s?"text-success":"text-danger"}`,children:[s?"+":"",n]})]}),a.jsx("div",{className:"text-3xl font-bold text-text-primary tabular-nums",children:r})]})}function jot(){const{toast:e}=as(),{userProfile:t}=vs(),[r,n]=eC(),[s,o]=p.useState(r.get("tab")||"visao-geral"),[i,l]=p.useState(!1),[c,d]=p.useState(()=>{const ae=new Date;return new Date(ae.getFullYear(),ae.getMonth(),1).toISOString().slice(0,10)}),[u,f]=p.useState(()=>new Date().toISOString().slice(0,10)),[h,m]=p.useState(null),[v,g]=p.useState(0),[y,x]=p.useState(0),[b,w]=p.useState([]),[j,_]=p.useState([]),[C,P]=p.useState([]),[E,A]=p.useState([]),[F,D]=p.useState([]),[I,R]=p.useState(0),[M,U]=p.useState(0),[z,W]=p.useState(!1),[$,ee]=p.useState(!1),[ve,_e]=p.useState(null),[K,q]=p.useState([]),[Y,J]=p.useState(!1),[fe,Z]=p.useState(!1),[ce,le]=p.useState(!1),[ie,te]=p.useState(null),[ue,Te]=p.useState([]),[ne,de]=p.useState([]);p.useState({open:!1,tipo:"suprimento",valor:"",observacao:"",loading:!1});const[lt,Nt]=p.useState(!1),[at,gt]=p.useState(!1),[Pt,yt]=p.useState(null),[Qe,ge]=p.useState([]),[rt,pt]=p.useState(""),[We,Ze]=p.useState("all"),[Ne,ye]=p.useState("all"),[Be,mt]=p.useState([]),[Ft,fr]=p.useState(""),[It,Ut]=p.useState("all"),[xe,st]=p.useState("all"),[Ct,ar]=p.useState(new Set),[pr,Xt]=p.useState(!1),[yr,lr]=p.useState(!1),[Rr,Pn]=p.useState(null),[De,ke]=p.useState([]),[Ge,Re]=p.useState(!1),[bt,Qt]=p.useState([]);p.useState("");const ct=ae=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(ae||0)),xt=ae=>Number(ae||0).toFixed(2),it=async(ae,Me,et,re)=>{try{const{default:O}=await Wu(()=>Promise.resolve().then(()=>QQe),void 0);await Wu(()=>Promise.resolve().then(()=>bot),void 0);const T=new O("p","mm","a4"),X=T.internal.pageSize.getWidth();if(T.setFontSize(20),T.setTextColor(245,158,11),T.text(ae,14,20),T.setDrawColor(245,158,11),T.setLineWidth(.5),T.line(14,23,X-14,23),T.setFontSize(10),T.setTextColor(100,100,100),T.text(`Perodo: ${c||"N/A"} at ${u||"N/A"}`,14,30),T.text(`Gerado em: ${new Date().toLocaleString("pt-BR")}`,14,35),typeof T.autoTable=="function"){T.autoTable({head:[Me],body:et,startY:42,theme:"striped",headStyles:{fillColor:[245,158,11],textColor:[255,255,255],fontStyle:"bold",fontSize:11},bodyStyles:{fontSize:10,textColor:[50,50,50]},alternateRowStyles:{fillColor:[249,249,249]},margin:{top:42,left:14,right:14}});const H=T.lastAutoTable.finalY||50;T.setFontSize(8),T.setTextColor(150,150,150),T.text("Relatrio gerado por Fluxo7Arena - Sistema de Gesto de Quadras Esportivas",X/2,H+15,{align:"center"})}else{let H=45;T.setFontSize(11),T.setTextColor(0,0,0),Me.forEach((L,Fe)=>{const nt=14+Fe*60;T.text(L,nt,H)}),H+=7,T.setFontSize(10),et.forEach(L=>{L.forEach((Fe,nt)=>{const ft=14+nt*60;T.text(String(Fe),ft,H)}),H+=6})}T.save(`${re}_${ur(new Date,"yyyy-MM-dd")}.pdf`),e({title:"PDF baixado com sucesso!",description:"O arquivo foi salvo na sua pasta de downloads"})}catch(O){console.error("Erro ao gerar PDF:",O),e({title:"Erro ao gerar PDF",description:O.message,variant:"destructive"})}},kt=async()=>{try{const ae=["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"],Me=(ne||[]).map(et=>[et?.aberto_em?new Date(et.aberto_em).toLocaleString("pt-BR"):"-",et?.fechado_em?new Date(et.fechado_em).toLocaleString("pt-BR"):"-",ct(et?.saldo_inicial||0),et?.saldo_final!=null?ct(et.saldo_final):ct(0),et?.valor_final_dinheiro!=null?ct(et.valor_final_dinheiro):"",et?.diferenca_dinheiro!=null?ct(et.diferenca_dinheiro):"",String(et?.status||"").toUpperCase()]);await it("Fechamentos de Caixa",ae,Me,"fechamentos_caixa")}catch(ae){e({title:"Erro ao exportar PDF",description:ae?.message||"Tente novamente",variant:"destructive"})}},be=()=>{try{const ae=";",et=[["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"].join(ae)];(ne||[]).forEach(X=>{const H=X?.aberto_em?new Date(X.aberto_em).toLocaleString("pt-BR"):"-",L=X?.fechado_em?new Date(X.fechado_em).toLocaleString("pt-BR"):"-",Fe=Number(X?.saldo_inicial||0).toFixed(2).replace(".",","),nt=(X?.saldo_final!=null?Number(X.saldo_final):0).toFixed(2).replace(".",","),ft=X?.valor_final_dinheiro!=null?Number(X.valor_final_dinheiro):null,Bt=X?.diferenca_dinheiro!=null?Number(X.diferenca_dinheiro):null,$e=String(X?.status||"").toUpperCase();et.push([H,L,Fe,nt,ft!=null?ft.toFixed(2).replace(".",","):"",Bt!=null?Bt.toFixed(2).replace(".",","):"",$e].join(ae))});const re=new Blob(["\uFEFF"+et.join(`
`)],{type:"text/csv;charset=utf-8;"}),O=URL.createObjectURL(re),T=document.createElement("a");T.href=O,T.download=`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(O),e({title:"CSV baixado com sucesso!"})}catch(ae){e({title:"Erro ao exportar CSV",description:ae?.message||"Tente novamente",variant:"destructive"})}},dt=({cx:ae,cy:Me,midAngle:et,outerRadius:re,percent:O})=>{const T=Math.PI/180,X=(re||0)+12,H=ae+X*Math.cos(-et*T),L=Me+X*Math.sin(-et*T);return a.jsx("text",{x:H,y:L,fill:"#fff",textAnchor:H>ae?"start":"end",dominantBaseline:"central",style:{pointerEvents:"none",fontSize:15,fontWeight:700},children:`${Math.round((O||0)*100)}%`})},Lt=ae=>{const Me=ot!=null&&ot!==ae;return{transition:"opacity 320ms ease-in-out, filter 320ms ease-in-out",opacity:Me?.25:1,filter:Me?"grayscale(15%)":"none",cursor:"pointer"}};p.useEffect(()=>{(async()=>{if(!yr||!Rr||Rr.origem!=="Comanda"||!Rr.comanda_id){ke([]),Qt([]);return}try{Re(!0);const Me=t?.codigo_empresa;let et=he.from("comanda_itens").select("descricao, quantidade, preco_unitario").eq("comanda_id",Rr.comanda_id);Me&&(et=et.eq("codigo_empresa",Me));const{data:re}=await et;ke(re||[]);let O=he.from("pagamentos").select("id, valor, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("comanda_id",Rr.comanda_id);Me&&(O=O.eq("codigo_empresa",Me));const{data:T}=await O;Qt(T||[])}catch(Me){console.warn("[Financeiro][RecebimentoModal] Falha ao carregar itens da comanda:",Me?.message),ke([]),Qt([])}finally{Re(!1)}})()},[yr,Rr,t?.codigo_empresa]);const mr=async()=>{try{l(!0);const ae=sr(c)||void 0,Me=fn(u)||void 0,et=t?.codigo_empresa;console.debug("[Financeiro][VisaoGeral] Carregando com perodo:",{fromISO:ae,toISO:Me,codigo:et});const re=await gd({from:ae,to:Me}).catch(()=>null);m(re||{totalPorFinalizadora:{},totalEntradas:0,totalVendasBrutas:0,totalDescontos:0,totalVendasLiquidas:0}),console.debug("[Financeiro][VisaoGeral] Resumo calculado:",re);try{let O=he.from("pagamentos").select("valor, status").eq("codigo_empresa",et);ae&&(O=O.gte("recebido_em",ae)),Me&&(O=O.lte("recebido_em",Me));const{data:T}=await O,X=(T||[]).reduce((nt,ft)=>{const Bt=ft.status||"Pago";return Bt==="Cancelado"||Bt==="Estornado"?nt:nt+Number(ft.valor||0)},0);g(X);let H=he.from("agendamentos").select("id").eq("codigo_empresa",et);ae&&(H=H.gte("inicio",ae)),Me&&(H=H.lte("inicio",Me));const{data:L}=await H;let Fe=0;if(L&&L.length>0){const nt=L.map(Bt=>Bt.id),{data:ft}=await he.from("agendamento_participantes").select("valor_cota, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",et).in("agendamento_id",nt).eq("status_pagamento","Pago");Fe=(ft||[]).reduce((Bt,$e)=>{let Dt=Number($e.valor_cota||0);if($e.aplicar_taxa===!0){const Sr=Number($e.finalizadoras?.taxa_percentual||0);Sr>0&&(Dt=Dt/(1+Sr/100))}return Bt+Dt},0)}x(Fe),console.debug("[Financeiro][VisaoGeral] Receitas por origem:",{totalComandas:X,totalAg:Fe})}catch(O){console.warn("[Financeiro][VisaoGeral] Falha ao calcular KPIs por origem:",O?.message),g(0),x(0)}try{let O=he.from("pagamentos").select("valor, status, origem").eq("codigo_empresa",et).eq("origem","xml");ae&&(O=O.gte("recebido_em",ae)),Me&&(O=O.lte("recebido_em",Me));const{data:T}=await O,X=(T||[]).reduce((L,Fe)=>["Cancelado","Estornado"].includes(Fe.status)?L:L+Number(Fe.valor||0),0);R(X);const{count:H}=await he.from("produtos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",et).or("importado_via_xml.is.true,categoria.ilike.Importados").gte("criado_em",ae).lte("criado_em",Me);U(H||0)}catch(O){console.warn("[Financeiro][VisaoGeral] Falha KPIs XML:",O?.message),R(0),U(0)}if(et){let O=he.from("comandas").select("id").eq("status","closed");et&&(O=O.eq("codigo_empresa",et)),ae&&(O=O.gte("fechado_em",ae)),Me&&(O=O.lte("fechado_em",Me));const{data:T,error:X}=await O;if(X)throw X;const H=(T||[]).map(ft=>ft.id);console.debug("[Financeiro][VisaoGeral] Comandas fechadas:",H.length);let L=[];if(H.length>0){let ft=he.from("comanda_itens").select("produto_id, quantidade, preco_unitario, produtos!comanda_itens_produto_id_fkey(nome)").in("comanda_id",H);et&&(ft=ft.eq("codigo_empresa",et));const{data:Bt}=await ft;L=Bt||[]}const Fe={};(L||[]).forEach(ft=>{const Bt=ft.produtos?.nome||"Produto sem nome",$e=Number(ft.quantidade||0),Dt=$e*Number(ft.preco_unitario||0);Fe[Bt]||(Fe[Bt]={quantidade:0,valor:0}),Fe[Bt].quantidade+=$e,Fe[Bt].valor+=Dt});const nt=Object.entries(Fe).map(([ft,Bt])=>({nome:ft,quantidade:Bt.quantidade,valor:Bt.valor})).sort((ft,Bt)=>Bt.valor-ft.valor);P(nt),w(nt.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Produtos agregados:",{total:nt.length,top5:nt.slice(0,5)})}if(et)try{let O=he.from("pagamentos").select("comanda_id, valor, status").eq("codigo_empresa",et).neq("status","Cancelado").neq("status","Estornado");ae&&(O=O.gte("recebido_em",ae)),Me&&(O=O.lte("recebido_em",Me));const{data:T}=await O;console.debug("[Financeiro][VisaoGeral] Pagamentos carregados:",(T||[]).length);const X=Array.from(new Set((T||[]).map($e=>$e.comanda_id).filter(Boolean)));let H=[];if(X.length>0){let $e=he.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",X).eq("codigo_empresa",et);const{data:Dt}=await $e;H=Dt||[]}console.debug("[Financeiro][VisaoGeral] Vinculos comanda_clientes:",H.length);const L=Array.from(new Set(H.map($e=>$e.cliente_id).filter(Boolean))),Fe={};if(L.length>0){const{data:$e}=await he.from("clientes").select("id, nome").in("id",L).eq("codigo_empresa",et);($e||[]).forEach(Dt=>{Fe[Dt.id]=Dt.nome})}const nt={};H.forEach($e=>{const Dt=$e.nome_livre||Fe[$e.cliente_id]||`Cliente ${$e.cliente_id||""}`;nt[$e.comanda_id]||(nt[$e.comanda_id]=new Set),Dt&&nt[$e.comanda_id].add(Dt)});const ft={};(T||[]).forEach($e=>{const Dt=Array.from(nt[$e.comanda_id]||[]),Sr=Number($e.valor||0);if(Dt.length===0){const Pr="Sem cliente";ft[Pr]||(ft[Pr]={id:null,nome:Pr,valor:0}),ft[Pr].valor+=Sr}else Dt.forEach(Pr=>{ft[Pr]||(ft[Pr]={id:null,nome:Pr,valor:0}),ft[Pr].valor+=Sr})});try{const $e=new Map(Object.values(Fe).map((kn,cn)=>[Object.keys(Fe)[cn],kn]));let Dt=he.from("v_agendamento_participantes").select("agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text");et&&(Dt=Dt.eq("codigo_empresa",et));let{data:Sr}=await Dt;Sr=Sr||[];const Pr=Array.from(new Set(Sr.map(kn=>kn.agendamento_id).filter(Boolean)));let vr=new Set;if(Pr.length>0){let kn=he.from("agendamentos").select("id, inicio").in("id",Pr);et&&(kn=kn.eq("codigo_empresa",et));const{data:cn}=await kn,Hr=ae?new Date(ae).getTime():null,va=Me?new Date(Me).getTime():null;(cn||[]).forEach(Ma=>{const xa=Ma?.inicio?new Date(Ma.inicio).getTime():null;xa!=null&&(Hr==null||xa>=Hr)&&(va==null||xa<=va)&&vr.add(Ma.id)})}const yn=Sr.filter(kn=>vr.has(kn.agendamento_id));console.debug("[Financeiro][Agendamentos] participantes no perodo (by agendamento.inicio):",yn.length);const Xn=Array.from(new Set((yn||[]).map(kn=>kn.cliente_id).filter(Boolean).map(String))).filter(kn=>!$e.has(kn));if(Xn.length>0){const{data:kn}=await he.from("clientes").select("id,nome").in("id",Xn);(kn||[]).forEach(cn=>$e.set(String(cn.id),cn.nome))}(yn||[]).forEach(kn=>{const cn=String(kn.status_pagamento||kn.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(cn))return;const Hr=kn.cliente_id,va=Hr?$e.get(String(Hr))||`Cliente ${Hr}`:null;if(!va)return;const Ma=Number(kn.valor_cota||0);ft[va]||(ft[va]={id:Hr||null,nome:va,valor:0}),ft[va].valor+=Ma})}catch{}const Bt=Object.values(ft).sort(($e,Dt)=>Dt.valor-$e.valor);A(Bt),_(Bt.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Clientes agregados:",{total:Bt.length,top5:Bt.slice(0,5)})}catch(O){console.error("Erro ao carregar top clientes:",O),_([]),A([])}if(et&&ae&&Me)try{let O=he.from("pagamentos").select("recebido_em, valor, status").eq("codigo_empresa",et).gte("recebido_em",ae).lte("recebido_em",Me).order("recebido_em",{ascending:!0});const{data:T}=await O;let X=he.from("v_agendamentos_detalhado").select("inicio, valor_pago, status_pagamento").eq("codigo_empresa",et).eq("status_pagamento","Pago").gte("inicio",ae).lte("inicio",Me).order("inicio",{ascending:!0});const{data:H}=await X,L={};(T||[]).forEach(nt=>{if(["Cancelado","Estornado"].includes(nt.status))return;const ft=new Date(nt.recebido_em).toLocaleDateString("pt-BR");L[ft]=(L[ft]||0)+Number(nt.valor||0)}),(H||[]).forEach(nt=>{const ft=new Date(nt.inicio).toLocaleDateString("pt-BR");L[ft]=(L[ft]||0)+Number(nt.valor_pago||0)});const Fe=Object.entries(L).map(([nt,ft])=>({data:nt,valor:ft})).sort((nt,ft)=>{const[Bt,$e,Dt]=nt.data.split("/").map(Number),[Sr,Pr,vr]=ft.data.split("/").map(Number);return new Date(Dt,$e-1,Bt).getTime()-new Date(vr,Pr-1,Sr).getTime()});D(Fe),console.debug("[Financeiro][VisaoGeral] Evoluo diria:",Fe.length,"dias")}catch(O){console.warn("[Financeiro][VisaoGeral] Falha ao calcular evoluo diria:",O?.message),D([])}else D([])}catch(ae){e({title:"Falha ao carregar viso geral",description:ae?.message||"Tente novamente",variant:"destructive"})}finally{l(!1)}},tr=async()=>{try{const ae=t?.codigo_empresa,Me=await Km({codigoEmpresa:ae});if(le(!!Me),Me){const[re,O]=await Promise.all([Fw({codigoEmpresa:ae}),Wp({caixaSessaoId:Me.id,codigoEmpresa:ae})]);te(re||null),Te(O||[])}else te(null),Te([]);const et=await kre({limit:50,codigoEmpresa:ae});if(console.log("[FinanceiroPage][loadCaixa] Histrico recebido de listarFechamentosCaixa:",et?.length,"sesses"),et&&et.length>0){console.log("[FinanceiroPage][loadCaixa] Primeira sesso do histrico:",et[0]);const re=et.filter(O=>O.valor_final_dinheiro!=null);console.log("[FinanceiroPage][loadCaixa] Sesses com valor_final_dinheiro:",re.length,"/",et.length)}de(et||[])}catch(ae){e({title:"Falha ao carregar caixa",description:ae?.message,variant:"destructive"})}},Or=async()=>{try{l(!0);const ae=t?.codigo_empresa,Me=sr(c)||void 0,et=fn(u)||void 0;let re=he.from("pagamentos").select("id, comanda_id, valor, status, metodo, recebido_em, origem, xml_chave, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("codigo_empresa",ae).order("recebido_em",{ascending:!1});Me&&(re=re.gte("recebido_em",Me)),et&&(re=re.lte("recebido_em",et));const{data:O}=await re;let T=new Map,X=new Map;try{const ft=Array.from(new Set((O||[]).map(Bt=>Bt.comanda_id).filter(Boolean)));if(ft.length>0){const{data:Bt}=await he.from("comandas").select("id, cliente_id, tipo").in("id",ft).eq("codigo_empresa",ae),$e=Array.from(new Set((Bt||[]).map(Pr=>Pr.cliente_id).filter(Boolean)));let Dt=new Map;if($e.length>0){const{data:Pr}=await he.from("clientes").select("id, nome").in("id",$e).eq("codigo_empresa",ae);Dt=new Map((Pr||[]).map(vr=>[vr.id,vr.nome]))}for(const Pr of Bt||[]){if(!Pr)continue;const vr=Dt.get(Pr.cliente_id)||null;T.set(Pr.id,vr),X.set(Pr.id,Pr.tipo||null)}const Sr=(Bt||[]).filter(Pr=>!Pr?.cliente_id).map(Pr=>Pr.id);if(Sr.length>0)try{const{data:Pr}=await he.from("comanda_clientes").select("comanda_id, cliente_id").in("comanda_id",Sr).eq("codigo_empresa",ae),vr=Array.from(new Set((Pr||[]).map(yn=>yn.cliente_id).filter(Boolean)));if(vr.length>0){const{data:yn}=await he.from("clientes").select("id, nome").in("id",vr).eq("codigo_empresa",ae),On=new Map((yn||[]).map(Xn=>[Xn.id,Xn.nome]));for(const Xn of Pr||[]){const kn=On.get(Xn.cliente_id)||null;kn&&!T.get(Xn.comanda_id)&&T.set(Xn.comanda_id,kn)}}}catch{console.debug("[Financeiro][Recebimentos] comanda_clientes indisponvel (ok)")}}}catch(ft){console.warn("[Financeiro][Recebimentos] Falha ao buscar clientes de comandas:",ft?.message)}let H=he.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, quadra_nome, participante_nome, valor_cota, status_pagamento, finalizadora_nome").eq("codigo_empresa",ae).eq("status_pagamento","Pago").order("inicio",{ascending:!1});Me&&(H=H.gte("inicio",Me)),et&&(H=H.lte("inicio",et));const{data:L}=await H,Fe=(O||[]).map(ft=>({id:ft.id,origem:X.get(ft.comanda_id||"")==="balcao"?"Balco":"Comanda",comanda_id:ft.comanda_id||null,recebido_em:ft.recebido_em,finalizadoras:ft.finalizadoras,metodo:ft.metodo,valor:ft.valor,status:ft.status,descricao:T.get(ft.comanda_id||"")||null,fonte:ft.origem||"manual",xml_chave:ft.xml_chave||null})),nt=(L||[]).map((ft,Bt)=>({id:`ag-${ft.agendamento_id}-${Bt}`,origem:"Agendamento",recebido_em:ft.inicio,finalizadoras:ft.finalizadora_nome?{nome:ft.finalizadora_nome}:null,metodo:ft.finalizadora_nome||null,valor:ft.valor_cota,status:ft.status_pagamento,descricao:`#${ft.agendamento_codigo} - ${ft.participante_nome} (${ft.quadra_nome||""})`,agendamento_codigo:ft.agendamento_codigo,quadra_nome:ft.quadra_nome,participante_nome:ft.participante_nome,fonte:null}));ge([...Fe,...nt])}catch(ae){e({title:"Falha ao carregar recebimentos",description:ae?.message,variant:"destructive"})}finally{l(!1)}},Lr=async()=>{try{l(!0);const ae=t?.codigo_empresa,Me=sr(c)||void 0,et=fn(u)||void 0;let re=he.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, fim, quadra_nome, participante_nome, cliente_id, valor_cota, finalizadora_nome, status_pagamento").eq("codigo_empresa",ae).order("inicio",{ascending:!1});Me&&(re=re.gte("inicio",Me)),et&&(re=re.lte("inicio",et));const{data:O}=await re,T=[...new Set((O||[]).map(L=>L.cliente_id).filter(Boolean))];let X={};if(T.length>0){const{data:L}=await he.from("clientes").select("id, is_consumidor_final, codigo").in("id",T).eq("codigo_empresa",ae);L&&(X=Object.fromEntries(L.map(Fe=>[Fe.id,Fe])))}const H=(O||[]).map(L=>({...L,is_consumidor_final:X[L.cliente_id]?.is_consumidor_final||!1,cliente_codigo:X[L.cliente_id]?.codigo||null}));mt(H)}catch(ae){e({title:"Falha ao carregar agendamentos",description:ae?.message,variant:"destructive"})}finally{l(!1)}};p.useEffect(()=>{n({tab:s})},[s]);const sr=ae=>{if(!ae)return null;if(typeof ae=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(ae)){const[Me,et,re]=ae.split("-").map(Number);return new Date(Me,et-1,re,0,0,0,0).toISOString()}return new Date(ae).toISOString()},fn=ae=>{if(!ae)return null;if(typeof ae=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(ae)){const[Me,et,re]=ae.split("-").map(Number);return new Date(Me,et-1,re,23,59,59,999).toISOString()}return new Date(ae).toISOString()};p.useEffect(()=>{t?.codigo_empresa&&(s==="visao-geral"||s==="relatorios"?mr():s==="caixa"?tr():s==="recebimentos"?Or():s==="agendamentos"&&Lr())},[s,c,u,t?.codigo_empresa]);const Tn=p.useMemo(()=>{const ae=h?.totalPorFinalizadora||{},Me=Object.entries(ae).map(([et,re])=>({name:et,valor:Number(re||0)}));return Me.sort((et,re)=>re.valor-et.valor),Me},[h]),[mn,zn]=p.useState(null),[ot,$t]=p.useState(null),Yt={start:90,end:-270},Ht=(ae,Me,et)=>ae+(Me-ae)*et,Ot=ae=>ae<.5?4*ae*ae*ae:1-Math.pow(-2*ae+2,3)/2,Xr=ae=>{const Me=Number(v||0),et=Number(y||0),re=Math.max(1e-4,Me+et),O=360*(Me/re);return ae===0?{a:Yt.start,b:Yt.start-O}:{a:Yt.start-O,b:Yt.end}},[Je,cr]=p.useState({from:null,to:null,t:1}),vt=ot??mn;p.useEffect(()=>{if(vt==null)return;const ae=Xr(vt);cr(T=>({from:T.to||ae,to:ae,t:0}));let Me;const et=performance.now(),re=380,O=T=>{const X=Math.min(1,(T-et)/re),H=Ot(X);cr(L=>({...L,t:H})),X<1&&(Me=requestAnimationFrame(O))};return Me=requestAnimationFrame(O),()=>Me&&cancelAnimationFrame(Me)},[vt,v,y]);const Tt=86,Dr=94,an=80,[Nr,St]=p.useState({from:[Tt,Tt],to:[Tt,Tt],t:1});p.useEffect(()=>{const ae=vt===0?[Dr,an]:vt===1?[an,Dr]:[Tt,Tt];St(T=>({from:T.to||ae,to:ae,t:0}));let Me;const et=performance.now(),re=380,O=T=>{const X=Math.min(1,(T-et)/re),H=Ot(X);St(L=>({...L,t:H})),X<1&&(Me=requestAnimationFrame(O))};return Me=requestAnimationFrame(O),()=>Me&&cancelAnimationFrame(Me)},[vt]);const Fr=({cx:ae,cy:Me,outerRadius:et})=>{if(!Je.from||!Je.to)return null;const re=Ht(Je.from.a,Je.to.a,Je.t),O=Ht(Je.from.b,Je.to.b,Je.t),T=vt===0?"#22C55E":"#F59E0B";return a.jsx(cM,{cx:ae,cy:Me,innerRadius:0,outerRadius:(et||0)+4,startAngle:re,endAngle:O,fill:T,fillOpacity:.18,stroke:"transparent"})},zr=p.useMemo(()=>{let ae=Qe;if(rt){const Me=rt.toLowerCase();ae=ae.filter(et=>(et.descricao||"").toLowerCase().includes(Me)||(et.finalizadoras?.nome||"").toLowerCase().includes(Me)||String(et.valor||"").includes(Me)||(et.origem||"").toLowerCase().includes(Me))}return We!=="all"&&(ae=ae.filter(Me=>(Me.finalizadoras?.nome||Me.metodo)===We)),Ne!=="all"&&(ae=ae.filter(Me=>(Me.fonte||"manual")===Ne)),ae},[Qe,rt,We,Ne]),ha=p.useMemo(()=>{const ae={};return(Be||[]).forEach(Me=>{const et=Me.agendamento_id||Me.agendamento_codigo;ae[et]||(ae[et]={agendamento_id:Me.agendamento_id,agendamento_codigo:Me.agendamento_codigo,inicio:Me.inicio,fim:Me.fim,quadra_nome:Me.quadra_nome,participantes:[],total:0,totalPago:0,totalPendente:0,statusGeral:"Pendente",representante:"",representanteClienteId:null,representanteCodigo:null,isRepresentanteConsumidor:!1}),ae[et].participantes.push(Me),ae[et].total+=Number(Me.valor_cota||0),Me.status_pagamento==="Pago"?ae[et].totalPago+=Number(Me.valor_cota||0):ae[et].totalPendente+=Number(Me.valor_cota||0)}),Object.values(ae).forEach(Me=>{const et=Me.participantes.every(O=>O.status_pagamento==="Pago");if(Me.participantes.every(O=>O.status_pagamento==="Cancelado")?Me.statusGeral="Cancelado":et?Me.statusGeral="Pago":Me.statusGeral="Pendente",Me.participantes.length>0){let O=Me.participantes.find(X=>!X.is_consumidor_final);O||(O=Me.participantes[0]);let T=O?.participante_nome||"";O?.is_consumidor_final&&T&&(T.toLowerCase().includes("cliente consumidor")||(T=T)),Me.representante=T,Me.representanteClienteId=O?.cliente_id||null,Me.representanteCodigo=O?.is_consumidor_final?0:O?.cliente_codigo??null,Me.isRepresentanteConsumidor=O?.is_consumidor_final||!1}}),Object.values(ae).sort((Me,et)=>new Date(et.inicio)-new Date(Me.inicio))},[Be]),En=p.useMemo(()=>{const ae=Ft.toLowerCase().trim();return ha.filter(Me=>{if(It!=="all"&&(It==="Pago"&&Me.statusGeral!=="Pago"||It==="Pendente"&&Me.statusGeral!=="Pendente"||It==="Cancelado"&&Me.statusGeral!=="Cancelado")||xe!=="all"&&!Me.participantes.some(X=>X.finalizadora_nome===xe))return!1;if(!ae)return!0;const et=String(Me.agendamento_codigo||""),re=String(Me.quadra_nome||"").toLowerCase(),O=Me.participantes.map(T=>String(T.participante_nome||"").toLowerCase()).join(" ");return et.includes(ae)||re.includes(ae)||O.includes(ae)})},[ha,Ft,It,xe]);return a.jsx(a.Fragment,{children:a.jsxs(jr.div,{variants:wot,initial:"hidden",animate:"visible",className:"space-y-6",children:[a.jsx(jr.div,{variants:dl,className:"fx-card p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Financeiro"}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa das finanas da empresa"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap items-stretch sm:items-center gap-3 w-full sm:w-auto",children:[a.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[a.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Incio"}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[a.jsx(Vs,{className:"h-5 w-5 text-warning flex-shrink-0"}),a.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:c?ur(new Date(c+"T00:00:00"),"dd/MM/yyyy",{locale:la}):"Selecione"})]})}),a.jsx(Jo,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:a.jsx(ui,{mode:"single",selected:c?new Date(c+"T00:00:00"):void 0,onSelect:ae=>ae&&d(ur(ae,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]}),a.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[a.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Fim"}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[a.jsx(Vs,{className:"h-5 w-5 text-warning flex-shrink-0"}),a.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:u?ur(new Date(u+"T00:00:00"),"dd/MM/yyyy",{locale:la}):"Selecione"})]})}),a.jsx(Jo,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:a.jsx(ui,{mode:"single",selected:u?new Date(u+"T00:00:00"):void 0,onSelect:ae=>ae&&f(ur(ae,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]})]})]})}),a.jsxs(Cc,{value:s,onValueChange:o,children:[a.jsx("div",{className:"md:hidden mb-4",children:a.jsxs(Nn,{value:s,onValueChange:o,children:[a.jsx(bn,{className:"w-full h-11 bg-black border-warning/40 text-white",children:a.jsx(Cn,{placeholder:"Selecione uma aba"})}),a.jsxs(wn,{className:"bg-black text-white border-warning/40",children:[a.jsx(tt,{value:"visao-geral",children:"Viso Geral"}),a.jsx(tt,{value:"caixa",children:"Caixa"}),a.jsx(tt,{value:"recebimentos",children:"Recebimentos"}),a.jsx(tt,{value:"agendamentos",children:"Agendamentos"}),a.jsx(tt,{value:"relatorios",children:"Relatrios"})]})]})}),a.jsxs(Gl,{className:"hidden md:grid w-full grid-cols-5",children:[a.jsx(da,{value:"visao-geral",children:"Viso Geral"}),a.jsx(da,{value:"caixa",children:"Caixa"}),a.jsx(da,{value:"recebimentos",children:"Recebimentos"}),a.jsx(da,{value:"agendamentos",children:"Agendamentos"}),a.jsx(da,{value:"relatorios",children:"Relatrios"})]}),a.jsxs(ds,{value:"visao-geral",className:"space-y-6 mt-6",children:[a.jsxs(jr.div,{variants:dl,className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[a.jsx(jj,{icon:HH,label:"Total Geral",value:ct(Number(v||0)+Number(y||0)),color:"brand"}),a.jsx(jj,{icon:i1,label:"Comandas",value:ct(v),color:"success"}),a.jsx(jj,{icon:Vs,label:"Agendamentos",value:ct(y),color:"success"}),a.jsx(jj,{icon:Um,label:"XML (Recebimentos)",value:ct(I),color:"success"})]}),a.jsxs(jr.div,{variants:dl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[a.jsx(Um,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Proporo de Receita"})]})}),Number(v||0)+Number(y||0)===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem receitas no perodo."}):a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[a.jsx("div",{className:"w-full md:flex-1 h-[280px]",children:a.jsx(eb,{width:"100%",height:"100%",children:a.jsxs(tUe,{children:[a.jsxs(Zu,{data:function(){const ae=Ht(Nr.from?.[0]??Tt,Nr.to?.[0]??Tt,Nr.t),Me=Ht(Nr.from?.[1]??Tt,Nr.to?.[1]??Tt,Nr.t);return[{name:"Comandas",value:Number(v||0),fill:"#22C55E",outerRadius:ae},{name:"Agendamentos",value:Number(y||0),fill:"#F59E0B",outerRadius:Me}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:!1,labelLine:!1,isAnimationActive:!0,animationBegin:50,animationDuration:500,startAngle:Yt.start,endAngle:Yt.end,activeIndex:vt,activeShape:void 0,onMouseEnter:(ae,Me)=>zn(Me),onMouseLeave:()=>zn(null),onClick:(ae,Me)=>{$t(et=>et===Me?null:Me),zn(Me)},children:[a.jsx(sw,{fill:"#22C55E",style:Lt(0)},"c"),a.jsx(sw,{fill:"#F59E0B",style:Lt(1)},"a")]}),Fr({cx:"50%",cy:"50%",outerRadius:92}),a.jsx(Zu,{data:function(){const ae=Ht(Nr.from?.[0]??Tt,Nr.to?.[0]??Tt,Nr.t),Me=Ht(Nr.from?.[1]??Tt,Nr.to?.[1]??Tt,Nr.t);return[{name:"Comandas",value:Number(v||0),fill:"transparent",outerRadius:ae},{name:"Agendamentos",value:Number(y||0),fill:"transparent",outerRadius:Me}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:dt,labelLine:!1,isAnimationActive:!1,startAngle:Yt.start,endAngle:Yt.end}),a.jsx(Bl,{formatter:ae=>ct(ae),contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 10px",color:"#fff"},labelStyle:{color:"#fff"},itemStyle:{color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.06)"}})]})})}),a.jsx("div",{className:"w-full md:w-64 space-y-3 md:pr-2",children:[{name:"Comandas",value:Number(v||0),color:"#22C55E"},{name:"Agendamentos",value:Number(y||0),color:"#F59E0B"}].map((ae,Me)=>a.jsxs("div",{className:`flex items-center justify-between px-3 py-2 rounded-md transition-all duration-200 ${mn===Me?"bg-white/5":"hover:bg-white/5"} cursor-pointer ${ot!=null&&ot!==Me?"opacity-60":""}`,onMouseEnter:()=>zn(Me),onMouseLeave:()=>zn(null),onClick:()=>$t(et=>et===Me?null:Me),role:"button",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm",style:{backgroundColor:ae.color}}),a.jsx("span",{className:"text-sm text-text-secondary",children:ae.name})]}),a.jsx("div",{className:`text-sm font-semibold ${ot!=null&&ot!==Me?"opacity-70":""}`,children:ct(ae.value)})]},ae.name))})]})]}),a.jsxs(jr.div,{variants:dl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[a.jsx(Um,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Entradas por Finalizadora"})]})}),Tn.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos no perodo."}):a.jsx("div",{className:"h-[280px]",children:a.jsx(eb,{width:"100%",height:"100%",children:a.jsxs(eUe,{data:Tn,margin:{top:8,right:8,left:8,bottom:8},children:[a.jsx(ZN,{strokeDasharray:"3 3",stroke:"#333"}),a.jsx(Eh,{dataKey:"name",stroke:"#aaa"}),a.jsx(kh,{stroke:"#aaa",tickFormatter:ae=>ct(ae),width:80}),a.jsx(Bl,{formatter:ae=>ct(ae),labelFormatter:ae=>`Finalizadora: ${ae}`,contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 12px",color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.1)"}}),a.jsx(qp,{}),a.jsx(kg,{dataKey:"valor",name:"Valor",fill:"#fbbf24"})]})})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[a.jsxs(jr.div,{variants:dl,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>W(!0),children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[a.jsx(Sd,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Produtos mais vendidos"}),C.length>5&&a.jsx(me,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>W(!0),children:"Ver todos"})]}),b.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):a.jsx("div",{className:"space-y-2",children:b.map((ae,Me)=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border last:border-0",children:[a.jsxs("span",{className:"text-sm text-text-primary",children:[Me+1,". ",ae.nome]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-text-secondary",children:ct(ae.valor)}),a.jsxs("span",{className:"text-sm font-bold text-brand",children:["x",ae.quantidade]})]})]},Me))})]}),a.jsxs(jr.div,{variants:dl,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>ee(!0),children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[a.jsx(yl,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Clientes (por valor pago)"}),E.length>5&&a.jsx(me,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>ee(!0),children:"Ver todos"})]}),j.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):a.jsx("div",{className:"space-y-2",children:j.map((ae,Me)=>a.jsxs("button",{className:"w-full flex items-center justify-between py-2 border-b border-border last:border-0 hover:bg-surface-2 rounded-sm px-2 text-left",onClick:()=>{_e(ae),ee(!0)},children:[a.jsxs("span",{className:"text-sm text-text-primary",children:[Me+1,". ",ae.nome]}),a.jsx("span",{className:"text-sm font-bold text-success",children:ct(ae.valor)})]},Me))})]})]})]}),a.jsx(ds,{value:"agendamentos",className:"space-y-6 mt-6",children:a.jsxs(jr.div,{variants:dl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:"Agendamentos (Pagamentos por Participante)"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center",children:[a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar (#cdigo, participante, quadra)",value:Ft,onChange:ae=>fr(ae.target.value),className:"pl-10 pr-10 w-full md:w-[260px] bg-black border-warning/40 text-white placeholder:text-white/60"}),a.jsxs(ci,{open:pr,onOpenChange:Xt,children:[a.jsx(di,{asChild:!0,children:a.jsx(me,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7 p-0 hover:bg-warning/20",title:"Selecionar cliente",children:a.jsx("svg",{className:"h-4 w-4 text-warning",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})}),a.jsx(Jo,{className:"w-[280px] p-2 bg-surface border-border",align:"end",children:a.jsxs("div",{className:"space-y-1 max-h-[300px] overflow-y-auto",children:[a.jsx("div",{className:"text-xs font-semibold text-text-secondary px-2 py-1 sticky top-0 bg-surface z-10",children:"Selecionar Cliente"}),(()=>{const ae=new Map;Be.forEach(et=>{const re=et.participante_nome;re&&!ae.has(re)&&ae.set(re,{nome:re,codigo:et.cliente_codigo||0,is_consumidor:et.is_consumidor_final||!1})});const Me=Array.from(ae.values()).sort((et,re)=>et.is_consumidor!==re.is_consumidor?et.is_consumidor?1:-1:et.nome.localeCompare(re.nome));return Me.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-4",children:"Nenhum participante encontrado"}):Me.map((et,re)=>a.jsxs("button",{onClick:()=>{fr(et.nome),Xt(!1)},className:"w-full flex items-center gap-2 px-2 py-2 hover:bg-surface-2 rounded text-left transition-colors",children:[a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-5 px-1 rounded text-[10px] font-bold ${et.codigo===0?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",et.codigo]}),a.jsx("span",{className:"text-sm text-text-primary flex-1 truncate",children:et.nome})]},re))})()]})})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[a.jsxs(Nn,{value:It,onValueChange:Ut,children:[a.jsx(bn,{className:"w-full md:w-[170px] h-9 bg-black border-warning/40 text-white",children:a.jsx(Cn,{placeholder:"Todos os Status"})}),a.jsxs(wn,{className:"bg-black text-white border-warning/40",children:[a.jsx(tt,{value:"all",children:"Todos os Status"}),a.jsx(tt,{value:"Pago",children:"Pago"}),a.jsx(tt,{value:"Pendente",children:"Pendente"}),a.jsx(tt,{value:"Cancelado",children:"Cancelado"})]})]}),a.jsxs(Nn,{value:xe,onValueChange:st,children:[a.jsx(bn,{className:"w-full md:w-[220px] h-9 bg-black border-warning/40 text-white",children:a.jsx(Cn,{placeholder:"Todas as Finalizadoras"})}),a.jsxs(wn,{className:"bg-black text-white border-warning/40",children:[a.jsx(tt,{value:"all",children:"Todas as Finalizadoras"}),[...new Set((Be||[]).map(ae=>ae.finalizadora_nome).filter(Boolean))].map(ae=>a.jsx(tt,{value:ae,children:ae},ae))]})]})]}),a.jsxs(me,{variant:"outline",size:"sm",onClick:()=>{try{const ae=";",et=[["Data","Horrio","Cdigo","Representante","Quadra","Participantes","Total","Pago","Pendente","Status"].join(ae)];En.forEach(Fe=>{const nt=Fe.inicio?new Date(Fe.inicio).toLocaleDateString("pt-BR"):"",ft=Fe.inicio&&Fe.fim?`${new Date(Fe.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}-${new Date(Fe.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:"",Bt=Fe.participantes.length,$e=Fe.participantes.filter(vr=>vr.status_pagamento==="Pago").length,Dt=Fe.participantes.filter(vr=>vr.status_pagamento==="Pendente").length,Sr=String(xt(Fe.total)).replace(".",","),Pr=[nt,ft,Fe.agendamento_codigo??"",(Fe.representante??"").replace(/"/g,'""'),(Fe.quadra_nome??"").replace(/"/g,'""'),Bt,Sr,$e,Dt,Fe.statusGeral??""].map(vr=>`"${vr}"`).join(ae);et.push(Pr)});const re="\uFEFF"+et.join(`
`),O=new Blob([re],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(O),X=document.createElement("a");X.href=T;const H=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"",L=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"";X.download=`agendamentos_${H}_a_${L}.csv`,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(T),e({title:"CSV exportado com sucesso!"})}catch(ae){e({title:"Falha ao exportar CSV",description:ae?.message,variant:"destructive"})}},children:[a.jsx(ho,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),i?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),a.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):En.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"w-12"}),a.jsx(qn,{children:"Data/Hora"}),a.jsx(qn,{children:"Cdigo"}),a.jsx(qn,{children:"Representante"}),a.jsx(qn,{children:"Quadra"}),a.jsx(qn,{className:"text-right",children:"Participantes"}),a.jsx(qn,{className:"text-right",children:"Total"}),a.jsx(qn,{children:"Status"})]})}),a.jsx(ml,{children:En.map(ae=>{const Me=Ct.has(ae.agendamento_id||ae.agendamento_codigo);return a.jsxs(Se.Fragment,{children:[a.jsxs(Wa,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{const et=ae.agendamento_id||ae.agendamento_codigo;ar(re=>{const O=new Set(re);return O.has(et)?O.delete(et):O.add(et),O})},children:[a.jsx(Sn,{children:a.jsx("div",{className:`transition-transform ${Me?"rotate-90":""}`,children:""})}),a.jsx(Sn,{children:ae.inicio?a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-text-secondary",children:new Date(ae.inicio).toLocaleDateString("pt-BR")}),a.jsxs("span",{className:"font-medium",children:[new Date(ae.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),ae.fim&&` - ${new Date(ae.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`]})]}):""}),a.jsxs(Sn,{className:"font-semibold",children:["#",ae.agendamento_codigo||""]}),a.jsx(Sn,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[ae.representanteCodigo!==null&&ae.representanteCodigo!==void 0&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[32px] h-6 px-1.5 rounded text-xs font-bold ${ae.representanteCodigo===0||ae.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",ae.representanteCodigo]}),a.jsx("span",{className:"text-text-primary",children:ae.representante||""})]})}),a.jsx(Sn,{children:ae.quadra_nome||""}),a.jsx(Sn,{className:"text-right",children:ae.participantes.length}),a.jsx(Sn,{className:"text-right font-semibold",children:ct(ae.total)}),a.jsx(Sn,{children:a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${ae.statusGeral==="Pago"?"bg-success/20 text-success":ae.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:ae.statusGeral==="Parcial"?"Pendente":ae.statusGeral})})]}),Me&&ae.participantes.map((et,re)=>{const O=et.is_consumidor_final?0:et.cliente_codigo??null;return a.jsxs(Wa,{className:"bg-surface-2/30 hover:bg-surface-2/50 transition-colors",children:[a.jsx(Sn,{}),a.jsx(Sn,{colSpan:2}),a.jsx(Sn,{className:"pl-8 text-sm text-text-secondary",children:a.jsxs("div",{className:"flex items-center gap-2",children:[O!=null&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${O===0||O==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",O]}),a.jsx("span",{children:et.participante_nome||""})]})}),a.jsx(Sn,{className:"text-sm text-text-secondary",children:et.finalizadora_nome||""}),a.jsx(Sn,{}),a.jsx(Sn,{className:"text-right text-sm font-medium",children:ct(et.valor_cota)}),a.jsx(Sn,{className:"text-sm",children:a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs ${et.status_pagamento==="Pago"?"bg-success/20 text-success":et.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:et.status_pagamento||"Pendente"})})]},`${ae.agendamento_codigo}-${re}`)})]},ae.agendamento_id||ae.agendamento_codigo)})})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:En.map(ae=>{const Me=Ct.has(ae.agendamento_id||ae.agendamento_codigo);return a.jsxs("div",{className:"bg-surface-2 rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"p-4 cursor-pointer",onClick:()=>{const et=ae.agendamento_id||ae.agendamento_codigo;ar(re=>{const O=new Set(re);return O.has(et)?O.delete(et):O.add(et),O})},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`transition-transform text-text-secondary ${Me?"rotate-90":""}`,children:""}),a.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["#",ae.agendamento_codigo||""]})]}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${ae.statusGeral==="Pago"?"bg-success/20 text-success":ae.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:ae.statusGeral==="Parcial"?"Pendente":ae.statusGeral})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Data:"}),a.jsx("span",{className:"text-text-primary",children:ae.inicio?new Date(ae.inicio).toLocaleDateString("pt-BR"):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Horrio:"}),a.jsx("span",{className:"text-text-primary font-medium",children:ae.inicio&&ae.fim?`${new Date(ae.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})} - ${new Date(ae.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:""})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Representante:"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ae.representanteCodigo!==null&&ae.representanteCodigo!==void 0&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${ae.representanteCodigo===0||ae.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",ae.representanteCodigo]}),a.jsx("span",{className:"text-text-primary font-medium",children:ae.representante||""})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Quadra:"}),a.jsx("span",{className:"text-text-primary font-medium",children:ae.quadra_nome||""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),a.jsx("span",{className:"text-text-primary",children:ae.participantes.length})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[a.jsx("span",{className:"text-text-secondary",children:"Total:"}),a.jsx("span",{className:"font-bold text-lg text-success",children:ct(ae.total)})]})]})]}),Me&&a.jsx("div",{className:"border-t border-border/50 bg-surface-2/20",children:ae.participantes.map((et,re)=>{const O=et.is_consumidor_final?0:et.cliente_codigo??null;return a.jsxs("div",{className:"px-4 py-3 border-b border-border/30 last:border-b-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[O!=null&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-4 px-1 rounded text-[9px] font-bold ${O===0||O==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",O]}),a.jsx("div",{className:"font-medium text-sm",children:et.participante_nome||""})]}),a.jsx("div",{className:`text-xs px-2 py-0.5 rounded-full ${et.status_pagamento==="Pago"?"bg-success/20 text-success":et.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:et.status_pagamento||"Pendente"})]}),a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-text-secondary",children:et.finalizadora_nome||""}),a.jsx("span",{className:"font-semibold text-success",children:ct(et.valor_cota)})]})]},re)})})]},ae.agendamento_id||ae.agendamento_codigo)})})]})]})}),a.jsx(ds,{value:"caixa",className:"space-y-6 mt-6",children:a.jsxs(jr.div,{variants:dl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[a.jsx("h3",{className:"text-base font-bold",children:"Fechamentos Anteriores"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(me,{variant:"outline",size:"sm",onClick:be,children:[a.jsx(ho,{className:"h-4 w-4 mr-2"})," CSV"]}),a.jsxs(me,{variant:"outline",size:"sm",onClick:kt,children:[a.jsx($g,{className:"h-4 w-4 mr-2"})," PDF"]})]})]}),ne.length===0?a.jsx("div",{className:"text-sm text-text-secondary",children:"Nenhum fechamento encontrado."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Aberto em"}),a.jsx(qn,{children:"Fechado em"}),a.jsx(qn,{className:"text-right",children:"Saldo Inicial"}),a.jsx(qn,{className:"text-right",children:"Saldo Final (contado)"}),a.jsx(qn,{children:"Status"})]})}),a.jsxs(ml,{children:[(()=>{console.log("[FinanceiroPage][Render] Renderizando histrico, total de sesses:",ne.length);const ae=ne.filter(Me=>Me.valor_final_dinheiro!=null);return console.log("[FinanceiroPage][Render] Sesses com valor_final_dinheiro no render:",ae.length),ne.length>0&&console.log("[FinanceiroPage][Render] Primeira sesso no array history:",ne[0]),null})(),ne.map(ae=>a.jsxs(Wa,{className:"cursor-pointer hover:bg-surface-2",onClick:async()=>{Nt(!0),gt(!0),yt(null);try{const Me=t?.codigo_empresa,et=typeof performance<"u"&&performance.now?performance.now():Date.now();console.log("[Caixa][Fechamento][Open]",{sessaoId:ae.id,from:ae.aberto_em,to:ae.fechado_em,codigo:Me});let re=await uS({caixaSessaoId:ae.id,codigoEmpresa:Me}),T=(yn=>{if(!yn)return null;if(yn.total_bruto!=null||yn.por_finalizadora!=null){let On=yn.por_finalizadora;if(On&&typeof On=="string")try{On=JSON.parse(On)}catch{On={}}return{from:yn.periodo_de||null,to:yn.periodo_ate||null,totalPorFinalizadora:On||{},totalEntradas:Number(yn.total_entradas||0),totalVendasBrutas:Number(yn.total_bruto||0),totalDescontos:Number(yn.total_descontos||0),totalVendasLiquidas:Number(yn.total_liquido||0)}}return yn})(re);T||(console.log("[Caixa][Fechamento] Snapshot ausente, calculando resumo por perodo..."),T=await gd({from:ae.aberto_em,to:ae.fechado_em||new Date().toISOString(),codigoEmpresa:Me}));const X={...ae,saldo_inicial:re&&typeof re.saldo_inicial<"u"?Number(re.saldo_inicial):ae.saldo_inicial,saldo_final:re&&typeof re.saldo_final<"u"?Number(re.saldo_final):ae.saldo_final};if(!T||!T.totalPorFinalizadora||Object.keys(T.totalPorFinalizadora).length===0)try{const yn=ae.aberto_em,On=ae.fechado_em||new Date().toISOString();let Xn=he.from("pagamentos").select("metodo, valor, status, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",yn).lte("recebido_em",On);Me&&(Xn=Xn.eq("codigo_empresa",Me));const{data:kn}=await Xn,cn={};let Hr=0;for(const va of kn||[]){if(!((va.status||"Pago")!=="Cancelado"&&(va.status||"Pago")!=="Estornado"))continue;const xa=va.finalizadoras?.nome||va.metodo||"Outros",$a=Number(va.valor||0);cn[xa]=(cn[xa]||0)+$a,Hr+=$a}T={...T||{},totalPorFinalizadora:cn,totalEntradas:Number(T?.totalEntradas||0)||Hr},console.log("[Caixa][Fechamento][FallbackPF]",{methods:Object.keys(cn).length})}catch{}const L=await Wp({caixaSessaoId:ae.id,codigoEmpresa:Me}),Fe=re&&re.movimentos?re.movimentos:null,nt=ae.aberto_em,ft=ae.fechado_em||new Date().toISOString();let Bt=he.from("pagamentos").select("id, valor, status, metodo, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",nt).lte("recebido_em",ft).order("recebido_em",{ascending:!1});Me&&(Bt=Bt.eq("codigo_empresa",Me));const{data:$e}=await Bt;console.log("[Caixa][Fechamento][Pays]",{count:($e||[]).length});const Dt=re&&typeof re.valor_final_dinheiro<"u"?Number(re.valor_final_dinheiro):null;yt({resumo:T,movimentacoes:L,movimentosAgg:Fe,pagamentos:$e||[],sessao:X,valorFinalContado:Dt});const Sr=typeof performance<"u"&&performance.now?performance.now():Date.now(),Pr=Array.isArray(L)?L.length:0,vr=T&&T.totalPorFinalizadora?Object.keys(T.totalPorFinalizadora).length:0;console.log("[Caixa][Fechamento][Loaded]",{sessaoId:ae.id,finCount:vr,movCount:Pr,ms:Math.round(Sr-et)})}catch(Me){console.error("[Caixa][Fechamento][Error]",{sessaoId:ae.id,message:Me?.message,code:Me?.code}),e({title:"Falha ao carregar fechamento",description:Me?.message||"Tente novamente",variant:"destructive"})}finally{gt(!1)}},children:[a.jsx(Sn,{children:ae.aberto_em?new Date(ae.aberto_em).toLocaleString("pt-BR"):""}),a.jsx(Sn,{children:ae.fechado_em?new Date(ae.fechado_em).toLocaleString("pt-BR"):""}),a.jsx(Sn,{className:"text-right",children:ct(ae.saldo_inicial)}),a.jsx(Sn,{className:"text-right",children:ae.valor_final_dinheiro!=null?ct(ae.valor_final_dinheiro):""}),a.jsx(Sn,{children:String(ae.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]},ae.id))]})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:ne.map(ae=>a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:async()=>{Nt(!0),gt(!0),yt(null);try{const Me=t?.codigo_empresa;let et=await uS({caixaSessaoId:ae.id,codigoEmpresa:Me}),O=(Fe=>{if(!Fe)return null;if(Fe.total_bruto!=null||Fe.por_finalizadora!=null){let nt=Fe.por_finalizadora;if(nt&&typeof nt=="string")try{nt=JSON.parse(nt)}catch{nt={}}return{from:Fe.periodo_de||null,to:Fe.periodo_ate||null,totalPorFinalizadora:nt||{},totalEntradas:Number(Fe.total_entradas||0),totalVendasBrutas:Number(Fe.total_bruto||0),totalDescontos:Number(Fe.total_descontos||0),totalVendasLiquidas:Number(Fe.total_liquido||0)}}return Fe})(et);O||(O=await gd({from:ae.aberto_em,to:ae.fechado_em||new Date().toISOString(),codigoEmpresa:Me}));const T={...ae,saldo_inicial:et&&typeof et.saldo_inicial<"u"?Number(et.saldo_inicial):ae.saldo_inicial,saldo_final:et&&typeof et.saldo_final<"u"?Number(et.saldo_final):ae.saldo_final},X=await Wp({caixaSessaoId:ae.id,codigoEmpresa:Me}),H=et&&et.movimentos?et.movimentos:null,L=et&&typeof et.valor_final_dinheiro<"u"?Number(et.valor_final_dinheiro):null;yt({resumo:O,movimentacoes:X,movimentosAgg:H,sessao:T,pagamentos:[],valorFinalContado:L})}catch(Me){console.error("[Caixa][Fechamento][Error]",Me),e({title:"Erro ao carregar detalhes",description:Me?.message,variant:"destructive"})}finally{gt(!1)}},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["Sesso #",ae.id]}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${ae.status==="fechado"?"bg-success/20 text-success":"bg-warning/20 text-warning"}`,children:String(ae.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Aberto em:"}),a.jsx("span",{className:"text-text-primary",children:ae.aberto_em?new Date(ae.aberto_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Fechado em:"}),a.jsx("span",{className:"text-text-primary",children:ae.fechado_em?new Date(ae.fechado_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Saldo Inicial:"}),a.jsx("span",{className:"font-semibold text-info",children:ct(ae.saldo_inicial)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Saldo Final (contado):"}),a.jsx("span",{className:"font-semibold text-success",children:ae.valor_final_dinheiro!=null?ct(ae.valor_final_dinheiro):""})]})]}),a.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},ae.id))})]})]})}),a.jsx(ds,{value:"recebimentos",className:"space-y-6 mt-6",children:a.jsxs(jr.div,{variants:dl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:"Todos os Recebimentos"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar...",value:rt,onChange:ae=>pt(ae.target.value),className:"pl-10 w-full md:w-[200px]"})]}),a.jsxs(Nn,{value:Ne,onValueChange:ye,children:[a.jsx(bn,{className:"w-full md:w-[160px] h-9 bg-black border-warning/40 text-white",children:a.jsx(Cn,{placeholder:"Todas as Fontes"})}),a.jsxs(wn,{className:"bg-black text-white border-warning/40",children:[a.jsx(tt,{value:"all",children:"Todas as Fontes"}),a.jsx(tt,{value:"manual",children:"Manual"}),a.jsx(tt,{value:"xml",children:"XML"})]})]}),a.jsxs(me,{variant:"outline",size:"sm",onClick:()=>{try{const ae=zr||[],et=[["Data/Hora","Origem","Fonte","Descrio","Finalizadora","Valor","Status"].join(";")];for(const Fe of ae){const nt=[Fe.recebido_em?new Date(Fe.recebido_em).toLocaleString("pt-BR"):"",Fe.origem??"",Fe.fonte??"",(Fe.descricao??"").replaceAll('"','""'),(Fe.finalizadoras?.nome||Fe.metodo||"").replaceAll('"','""'),String(xt(Fe.valor)).replace(".",","),Fe.status??""].map(ft=>`"${String(ft)}"`).join(";");et.push(nt)}const re="\uFEFF"+et.join(`
`),O=new Blob([re],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(O),X=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR"):"",H=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR"):"",L=document.createElement("a");L.href=T,L.download=`recebimentos_${X}_a_${H}.csv`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(T)}catch(ae){e({title:"Falha ao exportar CSV",description:ae?.message,variant:"destructive"})}},children:[a.jsx(ho,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),i?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),a.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):zr.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Data/Hora"}),a.jsx(qn,{children:"Origem"}),a.jsx(qn,{children:"Fonte"}),a.jsx(qn,{children:"Descrio"}),a.jsx(qn,{children:"Finalizadora"}),a.jsx(qn,{className:"text-right",children:"Valor"}),a.jsx(qn,{children:"Status"})]})}),a.jsx(ml,{children:zr.map(ae=>a.jsxs(Wa,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{Pn(ae),lr(!0)},children:[a.jsx(Sn,{children:ae.recebido_em?new Date(ae.recebido_em).toLocaleString("pt-BR"):""}),a.jsx(Sn,{children:ae.origem||""}),a.jsx(Sn,{children:ae.fonte?ae.fonte.toUpperCase():""}),a.jsx(Sn,{className:"truncate max-w-[260px]",title:ae.descricao||"",children:ae.descricao||""}),a.jsx(Sn,{children:ae.finalizadoras?.nome||ae.metodo||""}),a.jsx(Sn,{className:"text-right font-semibold",children:ct(ae.valor)}),a.jsx(Sn,{children:ae.status||""})]},ae.id))})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:zr.map(ae=>a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:()=>{Pn(ae),lr(!0)},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary",children:ae.origem||"Recebimento"}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${ae.status==="Pago"?"bg-success/20 text-success":ae.status==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:ae.status||"Pendente"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Data/Hora:"}),a.jsx("span",{className:"text-text-primary",children:ae.recebido_em?new Date(ae.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Fonte:"}),a.jsx("span",{className:"text-text-primary font-medium",children:ae.fonte?ae.fonte.toUpperCase():""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Finalizadora:"}),a.jsx("span",{className:"text-text-primary",children:ae.finalizadoras?.nome||ae.metodo||""})]}),ae.descricao&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:"text-text-secondary",children:"Descrio:"}),a.jsx("span",{className:"text-text-primary text-xs bg-surface/50 p-2 rounded",children:ae.descricao})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor:"}),a.jsx("span",{className:"font-bold text-lg text-success",children:ct(ae.valor)})]})]}),a.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},ae.id))})]})]})}),a.jsxs(ds,{value:"relatorios",className:"space-y-6 mt-6",children:[a.jsxs(jr.div,{variants:dl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Ko,{className:"w-5 h-5 text-success"}),"Faturamento Consolidado"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Resumo geral das receitas no perodo"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(me,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const Me=[["Mtrica","Valor"],["Receita de Comandas",ct(v)],["Receita de Agendamentos",ct(y)],["Receita Total",ct(Number(v||0)+Number(y||0))],["Perodo",`${c||"N/A"} at ${u||"N/A"}`]].map(T=>T.map(X=>`"${X}"`).join(";")).join(`
`),et=new Blob(["\uFEFF"+Me],{type:"text/csv;charset=utf-8;"}),re=URL.createObjectURL(et),O=document.createElement("a");O.href=re,O.download=`faturamento_consolidado_${ur(new Date,"yyyy-MM-dd")}.csv`,O.click(),URL.revokeObjectURL(re),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ho,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(me,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const ae=[["Receita de Comandas",ct(v)],["Receita de Agendamentos",ct(y)],["Receita Total",ct(Number(v||0)+Number(y||0))]];it("Faturamento Consolidado",["Mtrica","Valor"],ae,"faturamento_consolidado")},children:[a.jsx($g,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-success/5 border border-success/20 rounded-lg",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Comandas"}),a.jsx("div",{className:"text-2xl font-bold text-success",children:ct(v)}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Vendas no perodo"})]}),a.jsxs("div",{className:"p-4 bg-purple-500/5 border border-purple-500/20 rounded-lg",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Agendamentos"}),a.jsx("div",{className:"text-2xl font-bold text-purple-400",children:ct(y)}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Reservas pagas"})]}),a.jsxs("div",{className:"p-4 bg-brand/5 border border-brand/20 rounded-lg",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Total"}),a.jsx("div",{className:"text-2xl font-bold text-brand",children:ct(Number(v||0)+Number(y||0))}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Perodo selecionado"})]})]})]}),a.jsxs(jr.div,{variants:dl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Um,{className:"w-5 h-5 text-info"}),"Pagamentos por Mtodo"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Distribuio por finalizadora"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(me,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const ae=h?.totalPorFinalizadora||{},Me=Object.entries(ae).map(([L,Fe])=>[L,ct(Fe)]).sort((L,Fe)=>{const nt=Number(String(L[1]).replace(/[^\d,]/g,"").replace(",","."));return Number(String(Fe[1]).replace(/[^\d,]/g,"").replace(",","."))-nt}),et=Object.values(ae).reduce((L,Fe)=>L+Fe,0),O=[["Mtodo de Pagamento","Valor","% do Total"],...Me.map(([L,Fe])=>{const ft=((Object.entries(ae).find(([Bt])=>Bt===L)?.[1]||0)/et*100).toFixed(1)+"%";return[L,Fe,ft]}),["TOTAL",ct(et),"100%"]].map(L=>L.map(Fe=>`"${Fe}"`).join(";")).join(`
`),T=new Blob(["\uFEFF"+O],{type:"text/csv;charset=utf-8;"}),X=URL.createObjectURL(T),H=document.createElement("a");H.href=X,H.download=`pagamentos_por_metodo_${ur(new Date,"yyyy-MM-dd")}.csv`,H.click(),URL.revokeObjectURL(X),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ho,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(me,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const ae=h?.totalPorFinalizadora||{},Me=Object.values(ae).reduce((re,O)=>re+O,0),et=Object.entries(ae).sort(([,re],[,O])=>O-re).map(([re,O])=>[re,ct(O),(O/Me*100).toFixed(1)+"%"]);et.push(["TOTAL",ct(Me),"100%"]),it("Pagamentos por Mtodo",["Mtodo","Valor","% do Total"],et,"pagamentos_por_metodo")},children:[a.jsx($g,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),Object.keys(h?.totalPorFinalizadora||{}).length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Mtodo de Pagamento"}),a.jsx(qn,{className:"text-right",children:"Valor"}),a.jsx(qn,{className:"text-right",children:"% do Total"})]})}),a.jsxs(ml,{children:[Object.entries(h?.totalPorFinalizadora||{}).sort(([,ae],[,Me])=>Me-ae).map(([ae,Me])=>{const et=Object.values(h?.totalPorFinalizadora||{}).reduce((O,T)=>O+T,0),re=(Me/et*100).toFixed(1);return a.jsxs(Wa,{children:[a.jsx(Sn,{className:"font-medium",children:ae}),a.jsx(Sn,{className:"text-right font-semibold",children:ct(Me)}),a.jsxs(Sn,{className:"text-right text-text-secondary",children:[re,"%"]})]},ae)}),a.jsxs(Wa,{className:"bg-surface-2 font-bold",children:[a.jsx(Sn,{children:"TOTAL"}),a.jsx(Sn,{className:"text-right",children:ct(Object.values(h?.totalPorFinalizadora||{}).reduce((ae,Me)=>ae+Me,0))}),a.jsx(Sn,{className:"text-right",children:"100%"})]})]})]})})]}),a.jsxs(jr.div,{variants:dl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Sd,{className:"w-5 h-5 text-purple-400"}),"Produtos Mais Vendidos"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Top produtos por faturamento"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(me,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const Me=[["Posio","Produto","Faturamento"],...C.slice(0,50).map((T,X)=>[X+1,T.nome,ct(T.valor)])].map(T=>T.map(X=>`"${X}"`).join(";")).join(`
`),et=new Blob(["\uFEFF"+Me],{type:"text/csv;charset=utf-8;"}),re=URL.createObjectURL(et),O=document.createElement("a");O.href=re,O.download=`produtos_vendidos_${ur(new Date,"yyyy-MM-dd")}.csv`,O.click(),URL.revokeObjectURL(re),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ho,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(me,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const ae=C.slice(0,50).map((Me,et)=>[et+1,Me.nome,ct(Me.valor)]);it("Produtos Mais Vendidos",["#","Produto","Faturamento"],ae,"produtos_vendidos")},children:[a.jsx($g,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),C.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem produtos vendidos no perodo."}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"w-16",children:"#"}),a.jsx(qn,{children:"Produto"}),a.jsx(qn,{className:"text-right",children:"Faturamento"})]})}),a.jsx(ml,{children:C.slice(0,20).map((ae,Me)=>a.jsxs(Wa,{children:[a.jsx(Sn,{className:"text-text-secondary font-mono",children:Me+1}),a.jsx(Sn,{className:"font-medium",children:ae.nome}),a.jsx(Sn,{className:"text-right font-semibold",children:ct(ae.valor)})]},`${ae.nome}-${Me}`))})]}),C.length>20&&a.jsx("div",{className:"text-center mt-4",children:a.jsxs(me,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>W(!0),children:["Ver todos os ",C.length," produtos"]})})]})]}),a.jsxs(jr.div,{variants:dl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(yl,{className:"w-5 h-5 text-warning"}),"Clientes que Mais Consomem"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Ranking por faturamento total"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(me,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const Me=[["Posio","Cliente","Faturamento"],...E.slice(0,50).map((T,X)=>[X+1,T.nome,ct(T.valor)])].map(T=>T.map(X=>`"${X}"`).join(";")).join(`
`),et=new Blob(["\uFEFF"+Me],{type:"text/csv;charset=utf-8;"}),re=URL.createObjectURL(et),O=document.createElement("a");O.href=re,O.download=`clientes_top_${ur(new Date,"yyyy-MM-dd")}.csv`,O.click(),URL.revokeObjectURL(re),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ho,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(me,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const ae=E.slice(0,50).map((Me,et)=>[et+1,Me.nome,ct(Me.valor)]);it("Clientes que Mais Consomem",["#","Cliente","Total Gasto"],ae,"clientes_top")},children:[a.jsx($g,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),E.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de clientes no perodo."}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"w-16",children:"#"}),a.jsx(qn,{children:"Cliente"}),a.jsx(qn,{className:"text-right",children:"Total Gasto"})]})}),a.jsx(ml,{children:E.slice(0,20).map((ae,Me)=>a.jsxs(Wa,{children:[a.jsx(Sn,{className:"text-text-secondary font-mono",children:Me+1}),a.jsx(Sn,{className:"font-medium",children:ae.nome}),a.jsx(Sn,{className:"text-right font-semibold",children:ct(ae.valor)})]},`${ae.nome}-${Me}`))})]}),E.length>20&&a.jsx("div",{className:"text-center mt-4",children:a.jsxs(me,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>ee(!0),children:["Ver todos os ",E.length," clientes"]})})]})]}),a.jsxs(jr.div,{variants:dl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Vf,{className:"w-5 h-5 text-success"}),"Evoluo Diria de Receitas"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Faturamento dia a dia no perodo"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(me,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const Me=[["Data","Receita"],...F.map(T=>[T.data,ct(T.valor)])].map(T=>T.map(X=>`"${X}"`).join(";")).join(`
`),et=new Blob(["\uFEFF"+Me],{type:"text/csv;charset=utf-8;"}),re=URL.createObjectURL(et),O=document.createElement("a");O.href=re,O.download=`evolucao_diaria_${ur(new Date,"yyyy-MM-dd")}.csv`,O.click(),URL.revokeObjectURL(re),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(ho,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(me,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const ae=F.map(Me=>[Me.data,ct(Me.valor)]);it("Evoluo Diria de Receitas",["Data","Receita"],ae,"evolucao_diaria")},children:[a.jsx($g,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),F.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de evoluo no perodo."}):a.jsx("div",{className:"h-80",children:a.jsx(eb,{width:"100%",height:"100%",children:a.jsxs(uee,{data:F,margin:{top:5,right:20,bottom:5,left:0},children:[a.jsx(ZN,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),a.jsx(Eh,{dataKey:"data",stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:ae=>{const Me=ae.split("/");return`${Me[0]}/${Me[1]}`}}),a.jsx(kh,{stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:ae=>`R$ ${(ae/1e3).toFixed(0)}k`}),a.jsx(Bl,{contentStyle:{backgroundColor:"#1a1a1a",border:"1px solid #333",borderRadius:"8px"},labelStyle:{color:"#fff"},itemStyle:{color:"#22C55E"},formatter:ae=>[ct(ae),"Receita"]}),a.jsx(k0,{type:"monotone",dataKey:"valor",stroke:"#22C55E",strokeWidth:2,dot:{fill:"#22C55E",r:4},activeDot:{r:6}})]})})})]})]})]}),a.jsx(xn,{open:yr,onOpenChange:lr,children:a.jsxs(vn,{className:"max-w-lg",children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-xl font-bold",children:"Detalhes do Recebimento"}),a.jsx(Dn,{children:Rr?.origem==="Comanda"?"Operao de comanda":Rr?.origem==="Agendamento"?"Operao de agendamento":"Operao"})]}),Rr&&a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Data/Hora"}),a.jsx("div",{className:"font-medium",children:Rr.recebido_em?new Date(Rr.recebido_em).toLocaleString("pt-BR"):""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Valor"}),a.jsx("div",{className:"font-semibold",children:ct(Rr.valor)})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Origem"}),a.jsx("div",{children:Rr.origem||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Fonte"}),a.jsx("div",{children:Rr.fonte?Rr.fonte.toUpperCase():""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Finalizadora"}),a.jsx("div",{children:Rr.finalizadoras?.nome||Rr.metodo||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Status"}),a.jsx("div",{children:Rr.status||""})]})]}),Rr.origem==="Comanda"&&a.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[a.jsx("div",{className:"font-semibold mb-2",children:"Comanda"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Cliente"}),a.jsx("div",{children:Rr.descricao||""})]})}),a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"text-text-muted mb-1",children:"Produtos"}),Ge?a.jsx("div",{className:"text-xs text-text-muted",children:"Carregando itens..."}):De.length===0?a.jsx("div",{className:"text-xs text-text-muted",children:"Sem itens encontrados."}):a.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:De.map((ae,Me)=>a.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[a.jsxs("div",{className:"truncate",children:[a.jsx("span",{className:"font-mono",children:xt(ae.quantidade)}),a.jsx("span",{children:" x "}),a.jsx("span",{className:"font-medium",children:ae.descricao})]}),a.jsx("div",{className:"whitespace-nowrap",children:ct(Number(ae.preco_unitario||0)*Number(ae.quantidade||0))})]},Me))})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{className:"text-text-muted mb-1",children:"Pagamentos"}),bt.length===0?a.jsx("div",{className:"text-xs text-text-muted",children:"Sem pagamentos adicionais."}):a.jsxs("div",{className:"space-y-1",children:[bt.map((ae,Me)=>a.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[a.jsx("div",{className:"truncate",children:a.jsx("span",{className:"font-medium",children:ae.finalizadoras?.nome||ae.metodo||""})}),a.jsx("div",{className:"whitespace-nowrap",children:ct(ae.valor)})]},ae.id||Me)),a.jsxs("div",{className:"text-xs flex justify-between gap-3 pt-2 border-t border-border",children:[a.jsx("div",{className:"font-semibold",children:"Total"}),a.jsx("div",{className:"font-semibold",children:ct(bt.reduce((ae,Me)=>ae+Number(Me.valor||0),0))})]})]})]})]}),Rr.origem==="Agendamento"&&a.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[a.jsx("div",{className:"font-semibold mb-2",children:"Agendamento"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Cdigo"}),a.jsxs("div",{className:"font-mono",children:["#",Rr.agendamento_codigo]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Participante"}),a.jsx("div",{children:Rr.participante_nome})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("div",{className:"text-text-muted",children:"Quadra"}),a.jsx("div",{children:Rr.quadra_nome||""})]})]})]})]})]})}),a.jsx(xn,{open:z,onOpenChange:W,children:a.jsxs(vn,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Todos os Produtos"}),a.jsx(Dn,{children:"Ordenados por valor de vendas"})]}),a.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Produto"}),a.jsx(qn,{className:"text-center",children:"Quantidade"}),a.jsx(qn,{className:"text-right",children:"Valor Total"})]})}),a.jsx(ml,{children:C.map((ae,Me)=>a.jsxs(Wa,{children:[a.jsxs(Sn,{children:[Me+1,". ",ae.nome]}),a.jsxs(Sn,{className:"text-center",children:["x",ae.quantidade]}),a.jsx(Sn,{className:"text-right font-semibold",children:ct(ae.valor)})]},`${ae.nome}-${Me}`))})]})})]})}),a.jsx(xn,{open:lt,onOpenChange:Nt,children:a.jsxs(vn,{className:"sm:max-w-[900px] w-full max-h-[85vh] overflow-y-auto bg-surface text-text-primary border-0",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Fechamento do Caixa"}),a.jsxs(Dn,{children:[Pt?.sessao?.aberto_em?`${new Date(Pt.sessao.aberto_em).toLocaleString("pt-BR")}`:"",Pt?.sessao?.fechado_em?`  ${new Date(Pt.sessao.fechado_em).toLocaleString("pt-BR")}`:""]})]}),at?a.jsx("div",{className:"text-sm text-text-muted",children:"Carregando..."}):Pt?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),a.jsx("p",{className:"text-2xl font-bold tabular-nums",children:ct(Pt.sessao?.saldo_inicial)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Total do Dia"}),a.jsx("p",{className:"text-2xl font-bold text-success tabular-nums",children:(()=>{const ae=Number(Pt.resumo?.totalEntradas||0),Me=Array.isArray(Pt.movimentacoes)?Pt.movimentacoes:[];let et=0,re=0,O=0,T=0;for(const H of Me){const L=String(H?.tipo||"").toLowerCase(),Fe=Number(H?.valor||0);L==="suprimento"?et+=Fe:L==="sangria"?re+=Fe:L==="troco"?O+=Fe:L==="ajuste"&&(T+=Fe)}const X=ae+et+T-re-O;return ct(X)})()})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),a.jsx("p",{className:"text-2xl font-bold tabular-nums",children:(()=>{const ae=Pt&&typeof Pt.valorFinalContado=="number"?Pt.valorFinalContado:null;return ae!=null?ct(ae):""})()})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),a.jsx("p",{className:"text-2xl font-bold text-warning tabular-nums",children:ct(Pt.resumo?.totalDescontos)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),a.jsx("p",{className:"text-2xl font-bold tabular-nums",children:ct(Pt.resumo?.totalVendasLiquidas)})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Entradas por Finalizadora"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:Pt.resumo?.totalPorFinalizadora&&Object.keys(Pt.resumo.totalPorFinalizadora).length>0?Object.entries(Pt.resumo.totalPorFinalizadora).map(([ae,Me])=>a.jsxs("div",{className:"bg-surface-2 rounded-md p-2 border border-border flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate",children:String(ae)}),a.jsx("span",{className:"text-sm font-semibold",children:ct(Me)})]},ae)):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos."})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Movimentaes"}),!Pt.movimentacoes||Pt.movimentacoes.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes nesta sesso."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Data"}),a.jsx(qn,{children:"Tipo"}),a.jsx(qn,{children:"Obs"}),a.jsx(qn,{className:"text-right",children:"Valor"})]})}),a.jsx(ml,{children:Pt.movimentacoes.map(ae=>a.jsxs(Wa,{children:[a.jsx(Sn,{children:ae.created_at?new Date(ae.created_at).toLocaleString("pt-BR"):""}),a.jsx(Sn,{className:"capitalize",children:ae.tipo||""}),a.jsx(Sn,{className:"truncate max-w-[280px]",title:ae.observacao||"",children:ae.observacao||""}),a.jsx(Sn,{className:"text-right font-semibold",children:ct(ae.valor)})]},ae.id))})]})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Recebimentos"}),!Pt.pagamentos||Pt.pagamentos.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem recebimentos no perodo deste caixa."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Data/Hora"}),a.jsx(qn,{children:"Finalizadora"}),a.jsx(qn,{className:"text-right",children:"Valor"}),a.jsx(qn,{children:"Status"})]})}),a.jsx(ml,{children:Pt.pagamentos.map(ae=>a.jsxs(Wa,{children:[a.jsx(Sn,{children:ae.recebido_em?new Date(ae.recebido_em).toLocaleString("pt-BR"):""}),a.jsx(Sn,{children:ae.finalizadoras?.nome||ae.metodo||""}),a.jsx(Sn,{className:"text-right font-semibold",children:ct(ae.valor)}),a.jsx(Sn,{children:ae.status||""})]},ae.id))})]})})]})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados."})]})}),a.jsx(xn,{open:$,onOpenChange:ae=>{ee(ae),ae||(_e(null),q([]))},children:a.jsxs(vn,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Clientes"}),a.jsx(Dn,{children:"Ordenados por valor pago no perodo selecionado"})]}),a.jsx("div",{className:"max-h-[60vh] overflow-y-auto border border-border rounded-md",children:a.jsxs(ul,{children:[a.jsx(fl,{children:a.jsxs(Wa,{children:[a.jsx(qn,{children:"Cliente"}),a.jsx(qn,{className:"text-right",children:"Pago"})]})}),a.jsx(ml,{children:E.map((ae,Me)=>a.jsxs(Wa,{className:"cursor-pointer hover:bg-brand/10",onClick:async()=>{Z(!0),_e(ae),J(!0);try{const et=sr(c),re=fn(u),O=(ae.nome||"").trim(),T=t?.codigo_empresa;let X=he.from("clientes").select("id, nome").eq("codigo_empresa",T).ilike("nome",`%${O}%`);const{data:H}=await X,L=new Set((H||[]).map(On=>On.id));let Fe=he.from("comanda_clientes").select("comanda_id").eq("codigo_empresa",T).ilike("nome_livre",`%${O}%`);const{data:nt}=await Fe;let ft=new Set((nt||[]).map(On=>On.comanda_id));if(L.size>0){let On=he.from("comanda_clientes").select("comanda_id, cliente_id").eq("codigo_empresa",T).in("cliente_id",Array.from(L));const{data:Xn}=await On;(Xn||[]).forEach(kn=>ft.add(kn.comanda_id))}const Bt=Array.from(ft);let $e=he.from("pagamentos").select("id, valor, recebido_em, metodo, finalizadoras!pagamentos_finalizadora_id_fkey(nome), comanda_id, status").in("comanda_id",Bt).neq("status","Cancelado").neq("status","Estornado").order("recebido_em",{ascending:!1}).limit(50);et&&($e=$e.gte("recebido_em",et)),re&&($e=$e.lte("recebido_em",re));const{data:Dt}=await $e,Sr=Dt||[],Pr=Array.from(new Set(Sr.map(On=>On.comanda_id).filter(Boolean))),vr={};if(Pr.length>0){let On=he.from("comandas").select("id, tipo, mesa_id").in("id",Pr);const{data:Xn}=await On,kn=Array.from(new Set((Xn||[]).map(Hr=>Hr.mesa_id).filter(Boolean))),cn={};if(kn.length>0){let Hr=he.from("mesas").select("id, numero, nome").in("id",kn);const{data:va}=await Hr;(va||[]).forEach(Ma=>{cn[Ma.id]=(Ma.nome||`Mesa ${Ma.numero||""}`).trim()})}(Xn||[]).forEach(Hr=>{let va="";const Ma=String(Hr?.tipo||"").toLowerCase();Ma==="balcao"||Ma==="balco"?va="Balco":Ma==="mesa"||Hr.mesa_id?va=cn[Hr.mesa_id]||"Mesa":Ma==="agendamento"&&(va="Agendamento"),vr[Hr.id]=va})}let yn=Sr.map(On=>({...On,origem:On.comanda_id&&vr[On.comanda_id]||""}));try{const On=t?.codigo_empresa;let Xn=[];if(L&&L.size>0){let xa=he.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(L));On&&(xa=xa.eq("codigo_empresa",On));const{data:$a}=await xa;if(Xn=$a||[],Xn.length===0&&On){let oo=he.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(L));const{data:ss}=await oo;Xn=ss||[]}}let kn=[...Xn];const cn=Array.from(new Set(kn.map(xa=>xa.agendamento_id).filter(Boolean)));let Hr=new Set;const va={};if(cn.length>0){let xa=he.from("agendamentos").select("id, inicio").in("id",cn);On&&(xa=xa.eq("codigo_empresa",On));const{data:$a}=await xa,oo=et?new Date(et).getTime():null,ss=re?new Date(re).getTime():null;($a||[]).forEach(xs=>{const So=xs?.inicio?new Date(xs.inicio).getTime():null;So!=null&&(oo==null||So>=oo)&&(ss==null||So<=ss)&&Hr.add(xs.id),xs?.id&&(va[xs.id]=xs.inicio||null)})}kn=kn.filter(xa=>Hr.has(xa.agendamento_id));const Ma=new Set;console.debug("[Financeiro][Agendamentos][Detalhe] encontrados:",kn.length),kn.forEach(xa=>{const $a=`${xa.id}`;if(Ma.has($a))return;Ma.add($a);const oo=String(xa.status_pagamento||xa.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(oo))return;const ss=xa.finalizadora_nome||xa.metodo||xa.metodo_pagamento||xa.forma_pagamento||"Agendamento";yn.push({id:`ag-${xa.id}`,recebido_em:va[xa.agendamento_id]||null,finalizadoras:ss?{nome:ss}:null,metodo:ss,origem:"Agendamento",valor:xa.valor_cota})})}catch{}q(yn)}finally{J(!1)}},children:[a.jsx(Sn,{children:ae.nome}),a.jsx(Sn,{className:"text-right font-semibold",children:ct(ae.valor)})]},`${ae.nome}-${Me}`))})]})})]})}),a.jsx(xn,{open:fe,onOpenChange:Z,children:a.jsxs(vn,{className:"max-w-5xl w-[95vw] md:w-[90vw] max-h-[85vh] bg-surface text-text-primary border-0 overflow-hidden flex flex-col",children:[a.jsxs(pn,{className:"flex-shrink-0",children:[a.jsx(un,{className:"text-lg md:text-xl",children:"Detalhes do Cliente"}),a.jsx(Dn,{className:"text-sm md:text-base",children:ve?.nome})]}),ve?a.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 bg-surface-2 rounded-lg flex-shrink-0",children:[a.jsx("span",{className:"text-sm md:text-base text-text-secondary",children:"Total Pago no Perodo"}),a.jsx("span",{className:"text-lg md:text-2xl font-bold text-success",children:ct(ve.valor)})]}),Y?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Carregando detalhes..."}):K.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo selecionado."}):a.jsx("div",{className:"flex-1 overflow-auto border border-border rounded-md",children:a.jsxs(ul,{children:[a.jsx(fl,{className:"sticky top-0 bg-surface z-10",children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:"Data"}),a.jsx(qn,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:"Finaliz."}),a.jsx(qn,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:"Origem"}),a.jsx(qn,{className:"text-right text-xs md:text-sm w-[70px] md:w-auto",children:"Valor"})]})}),a.jsx(ml,{children:K.map(ae=>a.jsxs(Wa,{children:[a.jsx(Sn,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:a.jsx("div",{className:"text-[10px] md:text-xs leading-tight",children:ae.recebido_em?new Date(ae.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):""})}),a.jsx(Sn,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:a.jsx("div",{className:"truncate max-w-[80px] md:max-w-[200px] text-[10px] md:text-xs",title:ae.finalizadoras?.nome||ae.metodo||"",children:ae.finalizadoras?.nome||ae.metodo||""})}),a.jsx(Sn,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:a.jsx("div",{className:"truncate max-w-[60px] md:max-w-[150px] text-[10px] md:text-xs",title:ae.origem||"",children:ae.origem||""})}),a.jsx(Sn,{className:"text-right font-semibold text-xs md:text-sm w-[70px] md:w-auto",children:a.jsx("div",{className:"text-[10px] md:text-xs whitespace-nowrap",children:ct(ae.valor)})})]},ae.id))})]})})]}):a.jsx("div",{className:"text-sm text-text-muted py-8 text-center",children:"Nenhum cliente selecionado"})]})})]})})}const _ot={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},LR={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function Not({children:e,className:t=""}){return a.jsx(jr.div,{variants:LR,className:`fx-card ${t}`,children:e})}const ZE=({icon:e,title:t,value:r,subtitle:n,color:s})=>{const o=e;return a.jsxs(jr.div,{variants:LR,className:"bg-surface rounded-lg border-2 border-border hover:border-border-hover p-4 flex flex-col justify-between gap-2 transition-all duration-300",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-text-secondary text-sm font-semibold",children:t}),a.jsx(o,{className:`w-5 h-5 ${s}`})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r}),a.jsx("p",{className:"text-xs text-text-muted",children:n})]})]})};function UU({label:e,...t}){return a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:e}),a.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function Sot(){const{toast:e}=as(),{userProfile:t,authReady:r}=vs(),n=p.useRef(!1),[s,o]=p.useState(()=>{try{const ge=JSON.parse(localStorage.getItem("quadras:list")||"[]");return Array.isArray(ge)?ge:[]}catch{return[]}}),[i,l]=p.useState(()=>{try{const ge=JSON.parse(localStorage.getItem("quadras:list")||"[]");return!(Array.isArray(ge)&&ge.length>0)}catch{return!0}}),[c,d]=p.useState(!1),[u,f]=p.useState(!1),[h,m]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[v,g]=p.useState(""),[y,x]=p.useState(!1),[b,w]=p.useState(null),[j,_]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[C,P]=p.useState(""),[E,A]=p.useState(!0),[F,D]=p.useState({mostUsed:"-",topClient:"-",totalBookings:"-"}),[I,R]=p.useState(!1),[M,U]=p.useState(null),[z,W]=p.useState({0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0}),[$,ee]=p.useState([]),[ve,_e]=p.useState(""),[K,q]=p.useState(""),[Y,J]=p.useState(!1),fe=ge=>{if(!ge)return null;const[rt,pt]=String(ge).split(":");return`${rt.padStart(2,"0")}:${pt.padStart(2,"0")}:00`},Z=ge=>{const rt=String(ge??"").replace(/\D/g,"");if(!rt)return"";const pt=(Number(rt)/100).toFixed(2),[We,Ze]=pt.split(".");return`${We.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${Ze}`},ce=ge=>{if(ge==null||ge==="")return NaN;const rt=String(ge).replace(/\./g,"").replace(",","."),pt=parseFloat(rt);return Number.isFinite(pt)?pt:NaN},le=(ge,rt=!1)=>{if(ge==null||!Number.isFinite(Number(ge)))return"-";const We=Number(ge).toFixed(2).split("."),Ze=We[0],Ne=We[1],Be=`${Ze.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${Ne}`;return rt?`R$ ${Be}`:Be},ie=ge=>{if(!ge)return"";const[rt,pt]=String(ge).split(":");return`${String(rt).padStart(2,"0")}:${String(pt).padStart(2,"0")}`},te=ge=>{if(!ge)return 0;const[rt,pt]=String(ge).split(":").map(Number);return(rt===0&&pt===0?24:rt||0)*60+(pt||0)},ue=ge=>{if(!ge)return!1;const rt=String(ge).split(":");if(rt.length<2)return!1;const pt=Number(rt[1]);return pt===0||pt===30},Te=ge=>{if(!ge)return"";const[rt,pt]=String(ge).split(":");let We=Math.max(0,Math.min(23,parseInt(rt||"0",10))),Ze=Math.max(0,Math.min(59,parseInt(pt||"0",10)));const Ne=Math.round(Ze/30);if(Ne>=2?(We+=1,Ze=0):Ze=Ne*30,We>=24)return"23:59";const ye=String(We).padStart(2,"0"),Be=String(Ze).padStart(2,"0");return`${ye}:${Be}`};p.useEffect(()=>{if(!c)return;const ge=setTimeout(()=>{console.error("[Quadras] add/update stuck >15s",{route:"/quadras",codigo_empresa:t?.codigo_empresa,editingId:b,formQuadra:h,editForm:j})},15e3);return()=>clearTimeout(ge)},[c,t?.codigo_empresa,b,h,j]);const ne=async()=>{if(!t?.codigo_empresa)return;const ge=s&&s.length>0;ge||l(!0);const{data:rt,error:pt}=await he.from("quadras").select("*").eq("codigo_empresa",t.codigo_empresa).order("nome",{ascending:!0});if(pt){if(!n.current){n.current=!0,setTimeout(ne,800),ge||l(!1);return}e({title:"Erro ao carregar quadras",description:pt.message}),ge||l(!1);return}const We=rt||[];if(We.length===0&&ge&&!n.current){n.current=!0,setTimeout(ne,600),ge||l(!1);return}n.current=!1,o(We);try{localStorage.setItem("quadras:list",JSON.stringify(We))}catch{}ge||l(!1)},de=ge=>{w(ge.id),_({nome:ge.nome||"",descricao:ge.descricao||"",modalidades:Array.isArray(ge.modalidades)?ge.modalidades:ge.modalidades?[ge.modalidades]:[],tipo:ge.tipo||"Descoberta",status:ge.status||"Ativa",hora_inicio:ie(ge.hora_inicio||"06:00:00"),hora_fim:ie(ge.hora_fim||"24:00:00")||"23:59",valor_hora:ge.valor!=null&&ge.valor!==""?Z(String((Number(ge.valor)*2).toFixed(2))):""}),P(""),x(!0)},lt=async()=>{if(!j.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."});return}if(!j.hora_inicio||!j.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!ue(j.hora_inicio)||!ue(j.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(te(j.hora_fim)<=te(j.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!j.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!t?.codigo_empresa||!b){e({title:"Atualizao indisponvel",description:"Dados insuficientes para atualizar."});return}d(!0);const ge={nome:j.nome.trim(),descricao:j.descricao?.trim()||null,modalidades:j.modalidades,tipo:j.tipo,status:j.status,hora_inicio:fe(j.hora_inicio),hora_fim:fe(j.hora_fim==="24:00"?"23:59":j.hora_fim)};if(j.valor_hora!=null&&String(j.valor_hora).trim()!==""){const Ze=ce(j.valor_hora);!Number.isNaN(Ze)&&Number.isFinite(Ze)&&(ge.valor=Math.round(Ze/2*100)/100)}else ge.valor=null;const rt=(Ze,Ne)=>Promise.race([Ze,new Promise((ye,Be)=>setTimeout(()=>Be(new Error("Timeout ao atualizar quadra (>12s)")),Ne))]);let pt,We;try{({data:pt,error:We}=await rt(he.from("quadras").update(ge).eq("codigo_empresa",t.codigo_empresa).eq("id",b).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch(Ze){console.error("update timeout/error",Ze),e({title:"Tempo excedido",description:"Sem resposta do servidor ao atualizar. Verifique conexo e tente novamente."}),d(!1);return}if(d(!1),We){e({title:"Erro ao atualizar quadra",description:We.message});return}if(!pt){await ne(),e({title:"Quadra atualizada",description:`${ge.nome} foi atualizada.`}),x(!1),w(null),P("");return}e({title:"Quadra atualizada",description:`${pt.nome} foi atualizada.`}),x(!1),w(null),P(""),o(Ze=>Ze.map(Ne=>Ne.id===pt.id?pt:Ne).sort((Ne,ye)=>Ne.nome.localeCompare(ye.nome)))};p.useEffect(()=>{try{const ge=JSON.parse(localStorage.getItem("quadras:list")||"[]");Array.isArray(ge)&&ge.length&&s.length===0&&(o(ge),l(!1))}catch{}},[]),p.useEffect(()=>{r&&t?.codigo_empresa&&(ne(),Nt())},[r,t?.codigo_empresa]);const Nt=async()=>{if(t?.codigo_empresa)try{const ge=new Date;ge.setDate(ge.getDate()-30);const{data:rt}=await he.from("agendamentos").select("quadra_id, cliente_id, quadras!inner(nome), clientes(nome, codigo)").eq("codigo_empresa",t.codigo_empresa).gte("inicio",ge.toISOString()).neq("status","canceled");if(!rt||rt.length===0){D({mostUsed:"Sem dados",topClient:"Sem dados",totalBookings:"0"});return}const pt={};rt.forEach(ye=>{const Be=ye.quadras?.nome||"Sem nome";pt[Be]=(pt[Be]||0)+1});const We=Object.entries(pt).sort((ye,Be)=>Be[1]-ye[1])[0],Ze={};rt.forEach(ye=>{if(ye.cliente_id&&ye.clientes?.nome){const Be=ye.clientes?.codigo;if(Be===0||Be==="0")return;const mt=ye.clientes.nome;Ze[mt]=(Ze[mt]||0)+1}});const Ne=Object.entries(Ze).sort((ye,Be)=>Be[1]-ye[1])[0];D({mostUsed:We?`${We[0]} (${We[1]})`:"Sem dados",topClient:Ne?`${Ne[0]} (${Ne[1]})`:"Sem dados",totalBookings:rt.length.toString()})}catch(ge){console.error("Erro ao carregar stats:",ge),D({mostUsed:"Erro",topClient:"Erro",totalBookings:"0"})}},at=async()=>{if(console.groupCollapsed("[Quadras] addQuadra: CLICK"),console.time("[Quadras] addQuadra duration"),console.log("pre-validate",{codigo_empresa:t?.codigo_empresa,formQuadra:h}),!h.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."}),console.warn("validation: missing nome"),console.groupEnd();return}if(!h.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!h.hora_inicio||!h.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!ue(h.hora_inicio)||!ue(h.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(te(h.hora_fim)<=te(h.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!t?.codigo_empresa){e({title:"Empresa no localizada",description:"Associe o usurio a uma empresa para cadastrar quadras."});return}d(!0),console.log("validated, building payload");const ge={codigo_empresa:t.codigo_empresa,nome:h.nome.trim(),descricao:h.descricao?.trim()||null,modalidades:h.modalidades,tipo:h.tipo,status:h.status,hora_inicio:fe(h.hora_inicio),hora_fim:fe(h.hora_fim==="24:00"?"23:59":h.hora_fim)};if(h.valor_hora!=null&&String(h.valor_hora).trim()!==""){const Ze=ce(h.valor_hora);!Number.isNaN(Ze)&&Number.isFinite(Ze)&&(ge.valor=Math.round(Ze/2*100)/100)}console.log("payload",ge);const rt=(Ze,Ne)=>Promise.race([Ze,new Promise((ye,Be)=>setTimeout(()=>Be(new Error("Timeout ao inserir quadra (>12s)")),Ne))]);let pt,We;try{({data:pt,error:We}=await rt(he.from("quadras").insert(ge).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch(Ze){d(!1),console.error("insert timeout/error",Ze),e({title:"Tempo excedido",description:"Sem resposta do servidor ao cadastrar. Verifique conexo e tente novamente."}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(d(!1),We){e({title:"Erro ao cadastrar quadra",description:We.message}),console.error("insert error",{code:We.code,message:We.message,details:We.details}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(!pt){console.warn("insert success sem representao; recarregando lista"),await ne(),e({title:"Quadra adicionada",description:`${ge.nome} foi cadastrada.`}),m({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}console.log("insert success",{id:pt?.id,nome:pt?.nome}),e({title:"Quadra adicionada",description:`${pt.nome} foi cadastrada.`}),m({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),o(Ze=>[pt,...Ze].sort((Ne,ye)=>Ne.nome.localeCompare(ye.nome))),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd()},gt=async ge=>{U(ge),J(!0);try{const{data:rt,error:pt}=await he.from("quadras_dias_funcionamento").select("*").eq("quadra_id",ge.id).eq("codigo_empresa",t.codigo_empresa);if(pt)throw pt;const We={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0},Ze=[];rt?.forEach(Ne=>{Ne.tipo==="dia_semana"?We[Ne.dia_semana]=Ne.funciona:Ne.tipo==="data_fechamento"&&Ze.push(Ne)}),W(We),ee(Ze),R(!0)}catch(rt){console.error("Erro ao carregar dias de funcionamento:",rt),e({title:"Erro",description:"No foi possvel carregar as configuraes."})}finally{J(!1)}},Pt=async()=>{if(M){J(!0);try{await he.from("quadras_dias_funcionamento").delete().eq("quadra_id",M.id).eq("tipo","dia_semana");const ge=Object.entries(z).map(([pt,We])=>({quadra_id:M.id,codigo_empresa:t.codigo_empresa,tipo:"dia_semana",dia_semana:parseInt(pt),funciona:We,observacao:"Configurao de dias da semana"})),{error:rt}=await he.from("quadras_dias_funcionamento").insert(ge);if(rt)throw rt;e({title:"Sucesso",description:"Dias da semana salvos com sucesso!"})}catch(ge){console.error("Erro ao salvar dias da semana:",ge),e({title:"Erro",description:"No foi possvel salvar as configuraes."})}finally{J(!1)}}},yt=async()=>{if(!(!M||!ve)){J(!0);try{const{data:ge,error:rt}=await he.from("quadras_dias_funcionamento").insert({quadra_id:M.id,codigo_empresa:t.codigo_empresa,tipo:"data_fechamento",data_fechamento:ve,funciona:!1,observacao:K||"Fechamento especial"}).select().single();if(rt)throw rt;ee(pt=>[...pt,ge]),_e(""),q(""),e({title:"Sucesso",description:"Data de fechamento adicionada!"})}catch(ge){console.error("Erro ao adicionar data de fechamento:",ge),e({title:"Erro",description:"No foi possvel adicionar a data de fechamento."})}finally{J(!1)}}},Qe=async ge=>{J(!0);try{const{error:rt}=await he.from("quadras_dias_funcionamento").delete().eq("id",ge);if(rt)throw rt;ee(pt=>pt.filter(We=>We.id!==ge)),e({title:"Sucesso",description:"Data de fechamento removida!"})}catch(rt){console.error("Erro ao remover data de fechamento:",rt),e({title:"Erro",description:"No foi possvel remover a data de fechamento."})}finally{J(!1)}};return a.jsx(a.Fragment,{children:a.jsxs(jr.div,{variants:_ot,initial:"hidden",animate:"visible",className:"space-y-6",children:[a.jsxs(jr.div,{variants:LR,className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Quadras"}),a.jsx("p",{className:"text-text-secondary",children:"Gerencie as quadras e horrios disponveis."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(me,{variant:"outline",size:"icon",onClick:()=>A(ge=>!ge),title:E?"Ocultar resumo":"Mostrar resumo","aria-label":E?"Ocultar resumo":"Mostrar resumo",children:E?a.jsx(Fp,{className:"h-4 w-4"}):a.jsx(rg,{className:"h-4 w-4"})}),a.jsx(me,{onClick:()=>f(!0),className:"shadow-sm",children:"Adicionar Quadra"})]})]}),E&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsx(ZE,{icon:Sc,title:"Quadra Mais Usada",value:F.mostUsed,subtitle:"ltimos 30 dias",color:"text-brand"}),a.jsx(ZE,{icon:yl,title:"Cliente Top",value:F.topClient,subtitle:"Mais agendamentos no ms",color:"text-purple"}),a.jsx(ZE,{icon:Vf,title:"Total de Agendamentos",value:F.totalBookings,subtitle:"ltimos 30 dias",color:"text-success"})]}),a.jsxs(Not,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-text-primary",children:"Quadras"}),a.jsx("div",{className:"text-xs text-text-muted",children:i?"Carregando...":`${s.length} registro(s)`})]}),!i&&s.length===0?a.jsxs("div",{className:"text-sm text-text-muted py-8 text-center",children:[a.jsx("div",{className:"font-medium mb-1",children:"Nenhuma quadra cadastrada"}),a.jsx("div",{className:"mb-4",children:'Clique em "Adicionar Quadra" para cadastrar a primeira.'}),a.jsx(me,{onClick:()=>f(!0),children:"Adicionar Quadra"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden space-y-3",children:s.map(ge=>a.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:km(ge.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),a.jsx("span",{className:"font-semibold text-base text-text-primary truncate",children:ge.nome})]}),a.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0 ${ge.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":ge.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:ge.status})]}),Array.isArray(ge.modalidades)&&ge.modalidades.length>0&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted mb-1 block",children:"Modalidades"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:ge.modalidades.map(rt=>a.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-xs",children:rt},rt))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Valor/hora"}),a.jsx("span",{className:"text-sm font-medium",children:ge.valor==null||ge.valor===""?"-":le(Number(ge.valor)*2,!0)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Funcionamento"}),a.jsxs("span",{className:"text-sm font-medium",children:[ie(ge.hora_inicio)," - ",ie(ge.hora_fim==="24:00:00"?"23:59:00":ge.hora_fim)]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs(me,{variant:"outline",size:"sm",onClick:()=>gt(ge),className:"flex items-center gap-1",children:[a.jsx(Vs,{className:"h-3 w-3"}),"Dias"]}),a.jsx(me,{variant:"outline",size:"sm",onClick:()=>de(ge),children:"Editar"})]})]},ge.id))}),a.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-border bg-surface-0",children:a.jsxs(ul,{children:[a.jsx(fl,{className:"bg-surface-2/60 backdrop-blur supports-[backdrop-filter]:bg-surface-2/70",children:a.jsxs(Wa,{children:[a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Nome"}),a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Modalidades"}),a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Valor por hora"}),a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Funcionamento"}),a.jsx(qn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Status"}),a.jsx(qn,{className:"text-right text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Aes"})]})}),a.jsx(ml,{children:s.map(ge=>a.jsxs(Wa,{className:"hover:bg-surface-2/40 transition-colors",children:[a.jsx(Sn,{className:"font-medium text-sm md:text-base text-text-primary",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:km(ge.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),a.jsx("span",{children:ge.nome})]})}),a.jsx(Sn,{className:"text-sm md:text-base",children:Array.isArray(ge.modalidades)&&ge.modalidades.length>0?a.jsx("div",{className:"flex flex-wrap gap-1",children:ge.modalidades.map(rt=>a.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:rt},rt))}):ge.modalidades||""}),a.jsx(Sn,{className:"text-sm md:text-base",children:ge.valor==null||ge.valor===""?"-":a.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:le(Number(ge.valor)*2,!0)})}),a.jsxs(Sn,{className:"text-sm md:text-base",children:[ie(ge.hora_inicio)," - ",ie(ge.hora_fim==="24:00:00"?"23:59:00":ge.hora_fim)]}),a.jsx(Sn,{className:"text-sm md:text-base",children:a.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-[11px] md:text-xs border ${ge.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":ge.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:ge.status})}),a.jsx(Sn,{className:"text-right",children:a.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[a.jsxs(me,{variant:"outline",size:"sm",onClick:()=>gt(ge),className:"text-sm",children:[a.jsx(Vs,{className:"h-3 w-3 mr-1"}),"Dias"]}),a.jsx(me,{variant:"outline",size:"sm",onClick:()=>de(ge),className:"text-sm",children:"Editar"})]})})]},ge.id))})]})})]})]}),a.jsx(xn,{open:u,onOpenChange:f,children:a.jsxs(vn,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Adicionar Quadra"}),a.jsx(Dn,{children:"Cadastre uma nova quadra da sua empresa."})]}),a.jsxs("div",{className:"grid gap-4 py-2",children:[a.jsx(UU,{label:"Nome",value:h.nome,onChange:ge=>m({...h,nome:ge.target.value}),placeholder:"Ex.: Quadra Society 2"}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),a.jsx("textarea",{value:h.descricao,onChange:ge=>m({...h,descricao:ge.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),a.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:v,onChange:ge=>g(ge.target.value),onKeyDown:ge=>{if(ge.key==="Enter"){ge.preventDefault();const rt=v.trim();if(!rt)return;m(pt=>pt.modalidades.some(Ze=>Ze.toLowerCase()===rt.toLowerCase())?pt:{...pt,modalidades:[...pt.modalidades,rt]}),g("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),a.jsx(me,{type:"button",variant:"secondary",className:"bg-amber-500 hover:bg-amber-400 text-black disabled:opacity-50 disabled:cursor-not-allowed",disabled:!v.trim(),onClick:()=>{const ge=v.trim();ge&&(m(rt=>rt.modalidades.some(We=>We.toLowerCase()===ge.toLowerCase())?rt:{...rt,modalidades:[...rt.modalidades,ge]}),g(""))},"aria-label":"Adicionar modalidade",title:"Adicionar modalidade",children:"+"})]}),h.modalidades.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:h.modalidades.map(ge=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[a.jsx("span",{className:"px-0.5",children:ge}),a.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>m(rt=>({...rt,modalidades:rt.modalidades.filter(pt=>pt!==ge)})),"aria-label":`Remover ${ge}`,title:`Remover ${ge}`,children:""})]},ge))})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),a.jsxs("select",{value:h.tipo,onChange:ge=>m({...h,tipo:ge.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Descoberta"}),a.jsx("option",{children:"Coberta"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:h.valor_hora,onChange:ge=>m({...h,valor_hora:Z(ge.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),a.jsx("input",{type:"time",step:"1800",value:h.hora_inicio,onChange:ge=>m({...h,hora_inicio:ge.target.value}),onBlur:ge=>m(rt=>({...rt,hora_inicio:Te(ge.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),a.jsx("input",{type:"time",step:"1800",value:h.hora_fim,onChange:ge=>m({...h,hora_fim:ge.target.value}),onBlur:ge=>m(rt=>({...rt,hora_fim:Te(ge.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),a.jsxs("select",{value:h.status,onChange:ge=>m({...h,status:ge.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Ativa"}),a.jsx("option",{children:"Inativa"}),a.jsx("option",{children:"Manuteno"})]})]})]}),a.jsx(ra,{children:a.jsx(me,{onClick:at,disabled:c||h.modalidades.length===0,children:c?"Adicionando...":"Salvar"})})]})}),a.jsx(xn,{open:y,onOpenChange:x,children:a.jsxs(vn,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Editar Quadra"}),a.jsx(Dn,{children:"Atualize os dados da quadra selecionada."})]}),a.jsxs("div",{className:"grid gap-4 py-2",children:[a.jsx(UU,{label:"Nome",value:j.nome,onChange:ge=>_({...j,nome:ge.target.value}),placeholder:"Ex.: Quadra Society 2"}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),a.jsx("textarea",{value:j.descricao,onChange:ge=>_({...j,descricao:ge.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),a.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:C,onChange:ge=>P(ge.target.value),onKeyDown:ge=>{if(ge.key==="Enter"){ge.preventDefault();const rt=C.trim();if(!rt)return;_(pt=>pt.modalidades.some(Ze=>Ze.toLowerCase()===rt.toLowerCase())?pt:{...pt,modalidades:[...pt.modalidades,rt]}),P("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),a.jsx(me,{type:"button",variant:"secondary",onClick:()=>{const ge=C.trim();ge&&(_(rt=>rt.modalidades.some(We=>We.toLowerCase()===ge.toLowerCase())?rt:{...rt,modalidades:[...rt.modalidades,ge]}),P(""))},children:"+"})]}),j.modalidades.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:j.modalidades.map(ge=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[a.jsx("span",{className:"px-0.5",children:ge}),a.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>_(rt=>({...rt,modalidades:rt.modalidades.filter(pt=>pt!==ge)})),"aria-label":`Remover ${ge}`,title:`Remover ${ge}`,children:""})]},ge))})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),a.jsxs("select",{value:j.tipo,onChange:ge=>_({...j,tipo:ge.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Descoberta"}),a.jsx("option",{children:"Coberta"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:j.valor_hora,onChange:ge=>_({...j,valor_hora:Z(ge.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),a.jsx("input",{type:"time",step:"1800",value:j.hora_inicio,onChange:ge=>_({...j,hora_inicio:ge.target.value}),onBlur:ge=>_(rt=>({...rt,hora_inicio:Te(ge.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),a.jsx("input",{type:"time",step:"1800",value:j.hora_fim,onChange:ge=>_({...j,hora_fim:ge.target.value}),onBlur:ge=>_(rt=>({...rt,hora_fim:Te(ge.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),a.jsxs("select",{value:j.status,onChange:ge=>_({...j,status:ge.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Ativa"}),a.jsx("option",{children:"Inativa"}),a.jsx("option",{children:"Manuteno"})]})]})]}),a.jsx(ra,{children:a.jsx(me,{onClick:lt,disabled:c||j.modalidades.length===0,children:c?"Salvando...":"Salvar alteraes"})})]})}),a.jsx(xn,{open:I,onOpenChange:R,children:a.jsxs(vn,{className:"sm:max-w-[600px] max-h-[90vh] overflow-hidden pointer-events-none",children:[a.jsx("div",{className:"fixed inset-0 z-50 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto",children:a.jsx("div",{className:"rounded-2xl border border-white/30 bg-slate-900 shadow-2xl max-w-sm w-full text-center mx-4",children:a.jsxs("div",{className:"px-8 py-10",children:[a.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[a.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(Sc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline select-none",children:[a.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-3xl",style:{color:"#FFFFFF"},children:" Arena"})]})]}),a.jsx("div",{className:"text-2xl font-bold text-white mb-3",children:"Em Desenvolvimento"}),a.jsx("p",{className:"text-base text-gray-200",children:"Esta funcionalidade est sendo desenvolvida e em breve estar disponvel."}),a.jsx("div",{className:"mt-8 flex items-center justify-center",children:a.jsx(me,{variant:"outline",onClick:()=>R(!1),children:"Fechar"})})]})})}),a.jsxs(pn,{children:[a.jsxs(un,{className:"flex items-center gap-2",children:[a.jsx(Vs,{className:"h-5 w-5"}),"Dias de Funcionamento - ",M?.nome]}),a.jsx(Dn,{children:"Configure os dias da semana que a quadra funciona e adicione datas especficas de fechamento."})]}),Y?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"text-sm text-text-muted",children:"Carregando configuraes..."})}):a.jsxs("div",{className:"space-y-6 py-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Dias da Semana"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[{key:0,label:"Domingo",short:"Dom"},{key:1,label:"Segunda",short:"Seg"},{key:2,label:"Tera",short:"Ter"},{key:3,label:"Quarta",short:"Qua"},{key:4,label:"Quinta",short:"Qui"},{key:5,label:"Sexta",short:"Sex"},{key:6,label:"Sbado",short:"Sb"}].map(ge=>a.jsxs("label",{className:"flex items-center gap-2 p-3 rounded-lg border border-border hover:bg-surface-2/50 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:z[ge.key],onChange:rt=>W(pt=>({...pt,[ge.key]:rt.target.checked})),className:"w-4 h-4 text-primary bg-surface-2 border-border rounded focus:ring-primary focus:ring-2"}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-sm font-medium text-text-primary",children:ge.short}),a.jsx("span",{className:"text-xs text-text-muted hidden sm:block",children:ge.label})]})]},ge.key))}),a.jsx("div",{className:"mt-4",children:a.jsx(me,{onClick:Pt,disabled:Y,size:"sm",children:Y?"Salvando...":"Salvar Dias da Semana"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Datas de Fechamento"}),a.jsx("div",{className:"bg-surface-2/30 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Data"}),a.jsx("input",{type:"date",value:ve,onChange:ge=>_e(ge.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Observao"}),a.jsx("input",{type:"text",placeholder:"Ex: Feriado, Manuteno",value:K,onChange:ge=>q(ge.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsx("div",{className:"flex items-end",children:a.jsx(me,{onClick:yt,disabled:!ve||Y,size:"sm",className:"w-full sm:w-auto",children:"Adicionar"})})]})}),$.length>0?a.jsx("div",{className:"space-y-2",children:$.map(ge=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2/50 rounded-lg border border-border",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(yd,{className:"h-4 w-4 text-text-muted"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-text-primary",children:new Date(ge.data_fechamento+"T00:00:00").toLocaleDateString("pt-BR")}),ge.observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:ge.observacao})]})]}),a.jsx(me,{variant:"outline",size:"sm",onClick:()=>Qe(ge.id),disabled:Y,className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:a.jsx(el,{className:"h-3 w-3"})})]},ge.id))}):a.jsx("div",{className:"text-center py-6 text-sm text-text-muted",children:"Nenhuma data de fechamento configurada"})]})]}),a.jsx(ra,{children:a.jsx(me,{variant:"outline",onClick:()=>R(!1),children:"Fechar"})})]})})]})})}async function FR({url:e,body:t}){const r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await r.text();let s;try{s=n?JSON.parse(n):null}catch{s={raw:n}}if(!r.ok){const o=s?.message||s?.erro||r.statusText||"Erro na API Transmite Nota",i=new Error(o);throw i.status=r.status,i.response=s??n,i}return s}function oA(e,t){const r=String(e||"").replace(/\/$/,""),n=t.startsWith("/")?t:`/${t}`;return`${r}${n}`}async function Cot({baseUrl:e,apiKey:t,cnpj:r}){const n=oA(e,"/ConsultarEmissaoNotaNfce/");try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ApiKey:t||"",Cnpj:(r||"").replace(/\D/g,""),Dados:{}})}),o=await s.text();let i;try{i=o?JSON.parse(o):null}catch{}const l=s.status;return l===200?{reachable:!0,authorized:!0,status:l,response:i??o}:l===400?{reachable:!0,authorized:!0,status:l,response:i??o}:l===401||l===403?{reachable:!0,authorized:!1,status:l,response:i??o}:l===404?{reachable:!1,authorized:!1,status:l,response:i??o}:{reachable:!0,authorized:null,status:l,response:i??o}}catch(s){return{reachable:!1,authorized:!1,error:s?.message||String(s)}}}async function Aot({baseUrl:e,apiKey:t,cnpj:r,dados:n}){if(!e)throw new Error("baseUrl obrigatrio");if(!t)throw new Error("apiKey obrigatrio");if(!r)throw new Error("cnpj obrigatrio");if(!n)throw new Error("dados obrigatrio");const s=oA(e,"/EnviarNfce/");return FR({url:s,body:{ApiKey:t,Cnpj:r,Dados:n}})}async function VU({baseUrl:e,apiKey:t,cnpj:r,dados:n}){const s=oA(e,"/ConsultarEmissaoNotaNfce/");return FR({url:s,body:{ApiKey:t,Cnpj:r,Dados:n}})}async function Pot({baseUrl:e,apiKey:t,cnpj:r,dados:n}){const s=oA(e,"/CancelarNfce/");return FR({url:s,body:{ApiKey:t,Cnpj:r,Dados:n}})}function _j(e){const r=(e?.ambiente||"homologacao").toLowerCase()==="producao",n=r?e?.transmitenota_base_url_prod||e?.transmitenota_base_url||"":e?.transmitenota_base_url_hml||e?.transmitenota_base_url||"",s=r?e?.transmitenota_apikey_prod||e?.transmitenota_apikey||"":e?.transmitenota_apikey_hml||e?.transmitenota_apikey||"";return{baseUrl:n,apiKey:s,cnpj:(e?.cnpj||"").replace(/\D/g,"")}}const Eot={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},kot={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function WU({children:e,className:t=""}){return a.jsx(jr.div,{variants:kot,className:`fx-card ${t}`,children:e})}function Po({label:e,...t}){return a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:e}),a.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function Iot(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function Oot(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,15)}function vf(e){return String(e||"").replace(/\D/g,"")}function Tot(){const{toast:e}=as(),{company:t,userProfile:r,reloadCompany:n}=vs(),[s,o]=p.useState(!1),[i,l]=p.useState({razao_social:"",nome_fantasia:"",cnpj:"",email:"",telefone:"",endereco:"",logo_url:"",inscricao_estadual:"",regime_tributario:"",ambiente:"homologacao",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:"",nfce_serie:"1",nfce_numeracao:"1",nfce_itoken:"",nfe_serie:"",nfe_numeracao:"",transmitenota_apikey:"",transmitenota_base_url:"",transmitenota_base_url_hml:"",transmitenota_apikey_hml:"",transmitenota_base_url_prod:"",transmitenota_apikey_prod:""}),c=p.useRef(null),[d,u]=p.useState(""),f=p.useRef(!0);p.useEffect(()=>(f.current=!0,()=>{f.current=!1}),[]),p.useEffect(()=>{(async()=>{try{const x=r?.codigo_empresa||null;if(!x)return;const b=`empresa:form:${x}`;try{const P=localStorage.getItem(b);if(P){const E=JSON.parse(P);E&&typeof E=="object"&&(l(A=>({...A,...E})),E.logo_url&&u(`${E.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}const w=setTimeout(()=>{if(f.current)try{const P=localStorage.getItem(b);if(P){const E=JSON.parse(P);E&&typeof E=="object"&&(console.warn("[Empresas] slow fallback: using cached form"),l(A=>({...A,...E})),E.logo_url&&u(`${E.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}},5e3),{data:j,error:_}=await he.from("empresas").select("*").eq("codigo_empresa",x).single();if(clearTimeout(w),_)throw _;if(!f.current)return;const C={razao_social:j?.razao_social||"",nome_fantasia:j?.nome_fantasia||j?.nome||"",cnpj:j?.cnpj||"",email:j?.email||"",telefone:j?.telefone||"",endereco:j?.endereco||"",logo_url:j?.logo_url||"",inscricao_estadual:j?.inscricao_estadual||"",regime_tributario:j?.regime_tributario!=null?String(j.regime_tributario):"",ambiente:j?.ambiente||"homologacao",logradouro:j?.logradouro||"",numero:j?.numero||"",complemento:j?.complemento||"",bairro:j?.bairro||"",cidade:j?.cidade||"",uf:j?.uf||"",cep:j?.cep||"",codigo_municipio_ibge:j?.codigo_municipio_ibge||"",nfce_serie:j?.nfce_serie!=null?String(j.nfce_serie):"1",nfce_numeracao:j?.nfce_numeracao!=null?String(j.nfce_numeracao):"1",nfce_itoken:j?.nfce_itoken||"",nfe_serie:j?.nfe_serie!=null?String(j.nfe_serie):"",nfe_numeracao:j?.nfe_numeracao!=null?String(j.nfe_numeracao):"",transmitenota_apikey:j?.transmitenota_apikey||"",transmitenota_base_url:j?.transmitenota_base_url||"",transmitenota_base_url_hml:j?.transmitenota_base_url_hml||"",transmitenota_apikey_hml:j?.transmitenota_apikey_hml||"",transmitenota_base_url_prod:j?.transmitenota_base_url_prod||"",transmitenota_apikey_prod:j?.transmitenota_apikey_prod||""};l(C),u(C.logo_url?`${C.logo_url.split("?")[0]}?v=${Date.now()}`:"");try{localStorage.setItem(b,JSON.stringify(C))}catch{}}catch(x){console.warn("Falha ao carregar empresa:",x)}})()},[r?.codigo_empresa]),p.useEffect(()=>{if(!i.logo_url){u("");return}const y=i.logo_url.split("?")[0];u(`${y}?v=${Date.now()}`)},[i.logo_url]);const h=async y=>{if(y.preventDefault(),!s){if(!i.razao_social?.trim()||!i.cnpj?.trim()){e({title:"Campos obrigatrios",description:"Preencha Razo Social e CNPJ."});return}if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"No foi possvel identificar a empresa do usurio para salvar."});return}try{o(!0);const x={nome:i.nome_fantasia||i.razao_social||"Empresa",razao_social:i.razao_social||null,nome_fantasia:i.nome_fantasia||null,cnpj:i.cnpj?.replace(/\D/g,"")||null,email:i.email||null,telefone:i.telefone||null,endereco:i.endereco||null,logo_url:i.logo_url||null,inscricao_estadual:i.inscricao_estadual?.trim()||null,regime_tributario:i.regime_tributario?Number(i.regime_tributario):null,ambiente:i.ambiente||"homologacao",logradouro:i.logradouro?.trim()||null,numero:i.numero?.trim()||null,complemento:i.complemento?.trim()||null,bairro:i.bairro?.trim()||null,cidade:i.cidade?.trim()||null,uf:(i.uf||"").toUpperCase().slice(0,2)||null,cep:vf(i.cep)||null,codigo_municipio_ibge:i.codigo_municipio_ibge?.trim()||null,nfce_serie:i.nfce_serie?Number(i.nfce_serie):null,nfce_numeracao:i.nfce_numeracao?Number(i.nfce_numeracao):null,nfce_itoken:i.nfce_itoken?.trim()||null,nfe_serie:i.nfe_serie?Number(i.nfe_serie):null,nfe_numeracao:i.nfe_numeracao?Number(i.nfe_numeracao):null,transmitenota_apikey:i.transmitenota_apikey?.trim()||null,transmitenota_base_url:i.transmitenota_base_url?.trim()||null,transmitenota_base_url_hml:i.transmitenota_base_url_hml?.trim()||null,transmitenota_apikey_hml:i.transmitenota_apikey_hml?.trim()||null,transmitenota_base_url_prod:i.transmitenota_base_url_prod?.trim()||null,transmitenota_apikey_prod:i.transmitenota_apikey_prod?.trim()||null},b=async(w,j=1)=>{try{const{error:_}=await he.from("empresas").upsert({codigo_empresa:r.codigo_empresa,...w},{onConflict:"codigo_empresa"}).select("id").single();if(_)throw _;return!0}catch(_){const P=String(_?.message||"").match(/the '([^']+)' column|column\s+"([^"]+)"\s+of/i),E=P&&(P[1]||P[2])?P[1]||P[2]:null;if(E&&w.hasOwnProperty(E)&&j<=5){console.warn("[Empresas] Removendo coluna inexistente e tentando novamente:",E);const A={...w};return delete A[E],await b(A,j+1)}throw _}};await b(x),await n?.(),e({title:"Dados salvos",description:"As informaes da empresa foram atualizadas."})}catch(x){console.error(x);const b=(x?.message||x?.hint||"").toString()||"No foi possvel salvar os dados. Verifique as permisses e tente novamente.";e({title:"Erro ao salvar",description:b})}finally{o(!1)}}},m=async y=>{try{const x=y.target.files?.[0];if(!x)return;if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"Seu usurio no est associado a uma empresa."});return}const b=x.name.split(".").pop()?.toLowerCase()||"png",w=`${r.codigo_empresa}/logo.${b}`,j=(()=>{try{return(localStorage.getItem("custom-auth-token")||"").trim()}catch{return""}})();if(j){const P=`${TI}/storage/v1/object/logos/${w}`,E=await fetch(P,{method:"POST",headers:{Authorization:`Bearer ${j}`,apikey:DI,"x-upsert":"true","Content-Type":x.type||"application/octet-stream"},body:x});if(!E.ok){const A=await E.text();let F;try{F=A?JSON.parse(A):null}catch{}const D=F?.message||F?.error||E.statusText||"Falha no upload",I=new Error(D);throw I.status=E.status,I.response=F||A,I}}else{const{data:{session:P}}=await he.auth.getSession(),E=P?.access_token||"";if(E){const A=`${TI}/storage/v1/object/logos/${w}`,F=await fetch(A,{method:"POST",headers:{Authorization:`Bearer ${E}`,apikey:DI,"x-upsert":"true","Content-Type":x.type||"application/octet-stream"},body:x});if(!F.ok){const D=await F.text();let I;try{I=D?JSON.parse(D):null}catch{}const R=I?.message||I?.error||F.statusText||"Falha no upload",M=new Error(R);throw M.status=F.status,M.response=I||D,M}}else{const{error:A}=await he.storage.from("logos").upload(w,x,{upsert:!0,contentType:x.type||void 0});if(A)throw A}}const{data:_}=he.storage.from("logos").getPublicUrl(w),C=_?.publicUrl||"";l(P=>({...P,logo_url:C})),u(C?`${C}?v=${Date.now()}`:""),e({title:"Logo enviada",description:"A imagem foi carregada com sucesso. Lembre-se de salvar."})}catch(x){console.error("Falha no upload da logo:",x),e({title:"Erro no upload",description:"No foi possvel enviar a logo. Tente outro arquivo."})}finally{c.current&&(c.current.value="")}};function v(y){return String(y||"").normalize("NFD").replace(/\p{Diacritic}/gu,"").toLowerCase().trim()}async function g(){const y=vf(i.cnpj);if(y.length!==14){e({title:"CNPJ invlido",description:"Informe 14 dgitos para buscar.",variant:"destructive"});return}try{o(!0);const x=await fetch(`https://brasilapi.com.br/api/cnpj/v1/${y}`);if(!x.ok){let M="Falha ao consultar CNPJ";try{const U=await x.json();U?.message&&(M=U.message)}catch{}throw new Error(M)}const b=await x.json();try{console.info("[empresas] BuscarCNPJ:payload",b)}catch{}const w=b.razao_social||b.nome||"",j=b.nome_fantasia||"",_=b.logradouro||"",C=(b.numero||"").toString(),P=b.complemento||"",E=b.bairro||"",A=b.municipio||b.localidade||"",F=b.uf||"",D=vf(b.cep);let I="";try{if(A&&F){const M=await fetch(`https://brasilapi.com.br/api/ibge/municipios/v1/${F}`);if(M.ok){const U=await M.json(),z=v(A),W=(U||[]).find($=>v($.nome)===z);(W?.codigo_ibge||W?.codigo)&&(I=String(W.codigo_ibge||W.codigo))}}}catch{}const R=`${_}${C?", "+C:""}${E?" - "+E:""}${A||F?" - "+A+"/"+F:""}`;l(M=>({...M,razao_social:w,nome_fantasia:j||w,logradouro:_,numero:C,complemento:P,bairro:E,cidade:A,uf:F,cep:D,endereco:R||M.endereco,codigo_municipio_ibge:I||""}));try{console.info("[empresas] BuscarCNPJ:setForm",{razao:w,fantasia:j,logradouro:_,numero:C,complemento:P,bairro:E,cidade:A,uf:F,cep:D,codigoIBGE:I,enderecoFull:R})}catch{}e({title:"CNPJ carregado",description:"Dados preenchidos automaticamente."})}catch(x){e({title:"Falha ao buscar CNPJ",description:x.message||"Tente novamente.",variant:"destructive"})}finally{o(!1)}}return a.jsx(a.Fragment,{children:a.jsxs(jr.div,{variants:Eot,initial:"hidden",animate:"visible",className:"space-y-6",children:[a.jsx(WU,{children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Cadastros  Empresa"})})}),a.jsxs(WU,{children:[a.jsx("h2",{className:"text-lg font-bold text-text-primary mb-4",children:"Dados da Empresa"}),a.jsxs("form",{onSubmit:h,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx(Po,{label:"Razo Social",value:i.razao_social,onChange:y=>l({...i,razao_social:y.target.value}),placeholder:"Ex.: Fluxo7 Arena LTDA"}),a.jsx(Po,{label:"Nome Fantasia",value:i.nome_fantasia,onChange:y=>l({...i,nome_fantasia:y.target.value}),placeholder:"Ex.: Fluxo7 Arena"}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("div",{className:"flex-1",children:a.jsx(Po,{label:"CNPJ",type:"text",inputMode:"numeric",value:i.cnpj,onChange:y=>l({...i,cnpj:Iot(y.target.value)}),placeholder:"00.000.000/0000-00"})}),a.jsx(me,{type:"button",variant:"outline",onClick:g,disabled:s,children:"Buscar CNPJ"})]}),a.jsx(Po,{label:"Email",type:"email",value:i.email,onChange:y=>l({...i,email:y.target.value}),placeholder:"contato@empresa.com"}),a.jsx(Po,{label:"Telefone",type:"tel",inputMode:"tel",value:i.telefone,onChange:y=>l({...i,telefone:Oot(y.target.value)}),placeholder:"(11) 99999-9999"}),a.jsx(Po,{label:"Endereo",value:i.endereco,onChange:y=>l({...i,endereco:y.target.value}),placeholder:"Rua, nmero, bairro, cidade",className:"md:col-span-2 lg:col-span-2"}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(Po,{label:"Inscrio Estadual",value:i.inscricao_estadual,onChange:y=>l({...i,inscricao_estadual:y.target.value})}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Regime Tributrio (CRT)"}),a.jsxs("select",{value:i.regime_tributario,onChange:y=>l({...i,regime_tributario:y.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"Selecione"}),a.jsx("option",{value:"1",children:"1 - Simples Nacional"}),a.jsx("option",{value:"2",children:"2 - Simples (excesso sublimite)"}),a.jsx("option",{value:"3",children:"3 - Regime Normal"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Ambiente"}),a.jsxs("select",{value:i.ambiente,onChange:y=>l({...i,ambiente:y.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"homologacao",children:"Homologao"}),a.jsx("option",{value:"producao",children:"Produo"})]})]})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-6 gap-4",children:[a.jsx("div",{className:"md:col-span-3",children:a.jsx(Po,{label:"Logradouro",value:i.logradouro,onChange:y=>l({...i,logradouro:y.target.value})})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(Po,{label:"Nmero",value:i.numero,onChange:y=>l({...i,numero:y.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(Po,{label:"Complemento",value:i.complemento,onChange:y=>l({...i,complemento:y.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(Po,{label:"Bairro",value:i.bairro,onChange:y=>l({...i,bairro:y.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(Po,{label:"Cidade",value:i.cidade,onChange:y=>l({...i,cidade:y.target.value})})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(Po,{label:"UF",value:i.uf,onChange:y=>l({...i,uf:(y.target.value||"").toUpperCase().slice(0,2)}),placeholder:"UF"})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(Po,{label:"CEP",value:i.cep,onChange:y=>l({...i,cep:vf(y.target.value).slice(0,8)}),placeholder:"00000000"})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(Po,{label:"Cdigo IBGE Municpio (cMun)",value:i.codigo_municipio_ibge,onChange:y=>l({...i,codigo_municipio_ibge:vf(y.target.value).slice(0,7)})})})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(Po,{label:"NFC-e Srie",value:i.nfce_serie,onChange:y=>l({...i,nfce_serie:vf(y.target.value).slice(0,3)})}),a.jsx(Po,{label:"NFC-e Numerao Inicial",value:i.nfce_numeracao,onChange:y=>l({...i,nfce_numeracao:vf(y.target.value).slice(0,9)})}),a.jsx(Po,{label:"NFC-e IToken (CSC)",value:i.nfce_itoken,onChange:y=>l({...i,nfce_itoken:y.target.value})})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(Po,{label:"NF-e Srie (opcional)",value:i.nfe_serie,onChange:y=>l({...i,nfe_serie:vf(y.target.value).slice(0,3)})}),a.jsx(Po,{label:"NF-e Numerao (opcional)",value:i.nfe_numeracao,onChange:y=>l({...i,nfe_numeracao:vf(y.target.value).slice(0,9)})})]}),!1,a.jsx("div",{className:"md:col-span-2 lg:col-span-2 grid grid-cols-1 gap-3",children:a.jsxs("div",{className:"flex items-center gap-4",children:[d||i.logo_url?a.jsx("img",{src:d||i.logo_url,alt:"Logo da empresa",className:"w-16 h-16 rounded-md object-cover border border-border"}):a.jsx("div",{className:"w-16 h-16 rounded-md border border-dashed border-border/60 bg-surface-2/40 flex items-center justify-center text-xs text-text-muted",children:"Sem logo"}),a.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Upload da Logo"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(me,{type:"button",variant:"outline",onClick:()=>c.current?.click(),className:"px-3",children:"Escolher imagem"}),a.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:m,className:"hidden"}),(d||i.logo_url)&&a.jsx("span",{className:"text-xs text-text-muted truncate max-w-[260px]",title:i.logo_url||d,children:"Logo selecionada"})]}),a.jsx("span",{className:"text-[11px] text-text-muted",children:"Formatos: PNG/JPG. Tamanho recomendado: 256x256."})]})]})}),a.jsx("div",{className:"flex items-end",children:a.jsx(me,{type:"submit",className:"w-full md:w-auto",disabled:s,children:s?"Salvando...":"Salvar"})})]})]})]})})}const Dot={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},a_={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},HU=[{codigo:"01",nome:"Dinheiro"},{codigo:"02",nome:"Cheque"},{codigo:"03",nome:"Carto de Crdito"},{codigo:"04",nome:"Carto de Dbito"},{codigo:"05",nome:"Carto da Loja (Private Label)"},{codigo:"10",nome:"Vale Alimentao"},{codigo:"11",nome:"Vale Refeio"},{codigo:"12",nome:"Vale Presente"},{codigo:"13",nome:"Vale Combustvel"},{codigo:"14",nome:"Duplicata Mercantil"},{codigo:"15",nome:"Boleto Bancrio"},{codigo:"16",nome:"Depsito Bancrio"},{codigo:"17",nome:"PIX Dinmico (QR-Code)"},{codigo:"18",nome:"Transferncia Bancria / Carteira Digital"},{codigo:"19",nome:"Programa de Fidelidade / Cashback"},{codigo:"20",nome:"PIX Esttico"},{codigo:"21",nome:"Crdito em Loja"},{codigo:"22",nome:"Pagamento Eletrnico no Informado"},{codigo:"90",nome:"Sem Pagamento"},{codigo:"99",nome:"Outros"}],ek=({icon:e,title:t,value:r,subtitle:n,color:s,onClick:o,isActive:i})=>a.jsx(jr.div,{variants:a_,onClick:o,className:gr("bg-surface rounded-lg border md:border-2 p-3 md:p-4 transition-all text-center h-[90px] md:h-auto",o?"cursor-pointer hover:shadow-md":"",i?`border-${s} bg-${s}/5`:"border-border",o&&!i?"hover:border-border-hover":""),children:a.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 md:flex-row md:items-center md:gap-3 h-full",children:[a.jsx("div",{className:gr("p-1.5 md:p-2 rounded-lg",`bg-${s}/10`),children:a.jsx(e,{className:gr("w-4 h-4 md:w-5 md:h-5",`text-${s}`)})}),a.jsxs("div",{className:"flex-1 md:text-left",children:[a.jsx("p",{className:"text-base md:text-2xl font-bold text-text-primary leading-none",children:r}),a.jsx("p",{className:"text-[10px] md:text-xs font-semibold text-text-secondary md:mt-0.5",children:t}),a.jsx("p",{className:"hidden md:block text-xs text-text-muted",children:n})]})]})});function Mot(){const{toast:e}=as(),{userProfile:t,authReady:r}=vs(),[n,s]=p.useState([]),[o,i]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(""),[f,h]=p.useState("all"),[m,v]=p.useState("all"),[g,y]=p.useState(!0),[x,b]=p.useState(null),[w,j]=p.useState(!1),[_,C]=p.useState(null),[P,E]=p.useState({codigo_interno:"",codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),[A,F]=p.useState(!1),[D,I]=p.useState(""),[R,M]=p.useState(!1),[U,z]=p.useState(null),[W,$]=p.useState(null),[ee,ve]=p.useState(!1),[_e,K]=p.useState("mes"),[q,Y]=p.useState(!1),[J,fe]=p.useState([]),[Z,ce]=p.useState("customizado"),[le,ie]=p.useState(""),[te,ue]=p.useState(""),[Te,ne]=p.useState(!1),[de,lt]=p.useState(!1);p.useEffect(()=>{const Ne=()=>{try{lt(typeof window<"u"&&window.innerWidth<=640)}catch{}};return Ne(),window.addEventListener("resize",Ne),()=>window.removeEventListener("resize",Ne)},[]);const Nt=async()=>{try{i(!0);const Ne=t?.codigo_empresa;if(!Ne)return;const ye=await Hm({somenteAtivas:!1,codigoEmpresa:Ne});console.log(" Finalizadoras carregadas:",ye),console.log(" Primeira finalizadora:",ye?.[0]),s(Array.isArray(ye)?ye:[])}catch(Ne){e({title:"Erro ao carregar",description:Ne?.message,variant:"destructive"})}finally{i(!1)}},at=p.useMemo(()=>{const Ne=n.length,ye=n.filter(fr=>fr.ativo).length,Be=n.length>0?n.reduce((fr,It)=>{const Ut=It.nome||"Sem nome";return fr[Ut]=(fr[Ut]||0)+1,fr},{}):{},mt=Object.entries(Be).sort((fr,It)=>It[1]-fr[1])[0],Ft=mt?mt[0]:"-";return{total:Ne,ativas:ye,maisUsada:Ft}},[n]),gt=p.useMemo(()=>{let Ne=[...n];if(d){const ye=d.toLowerCase();Ne=Ne.filter(Be=>{const mt=String(Be.tipo||"").toLowerCase(),Ft=String(Be.nome||"").toLowerCase(),fr=String(Be.codigo_interno||"").toLowerCase(),It=ye.replace(/\D/g,""),Ut=String(Be.codigo_interno||"").replace(/\D/g,"");return mt.includes(ye)||Ft.includes(ye)||fr.includes(ye)||!!It&&Ut===It})}return f!=="all"&&(Ne=Ne.filter(ye=>ye.tipo===f)),m!=="all"&&(Ne=Ne.filter(ye=>m==="active"?ye.ativo:!ye.ativo)),x==="ativas"&&(Ne=Ne.filter(ye=>ye.ativo)),Ne.sort((ye,Be)=>{const mt=parseInt(ye.codigo_interno)||0,Ft=parseInt(Be.codigo_interno)||0;return mt-Ft}),Ne},[n,d,f,m,x]),Pt=()=>{C(null);const Ne=n.reduce((Be,mt)=>{const Ft=parseInt(mt.codigo_interno)||0;return Ft>Be?Ft:Be},0),ye=String(Ne+1).padStart(2,"0");E({codigo_interno:ye,codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),j(!0)},yt=Ne=>{C(Ne),E({codigo_interno:Ne.codigo_interno||"",codigo_sefaz:Ne.codigo_sefaz||"",nome:Ne.nome||"",taxa_percentual:Ne.taxa_percentual!=null?String(Ne.taxa_percentual):"",ativo:Ne.ativo!==!1}),j(!0)},Qe=async(Ne,ye="mes")=>{try{ve(!0);const Be=t?.codigo_empresa;if(!Be)return;const mt=new Date;let Ft,fr=mt.toISOString();switch(ye){case"hoje":Ft=new Date(mt.setHours(0,0,0,0)).toISOString();break;case"semana":Ft=new Date(mt.setDate(mt.getDate()-7)).toISOString();break;case"mes":Ft=new Date(mt.setMonth(mt.getMonth()-1)).toISOString();break;default:Ft=new Date(mt.setMonth(mt.getMonth()-1)).toISOString()}const{data:It,error:Ut}=await he.from("pagamentos").select("valor, recebido_em, status").eq("finalizadora_id",Ne).eq("codigo_empresa",Be).gte("recebido_em",Ft).lte("recebido_em",fr).neq("status","Cancelado").neq("status","Estornado");if(Ut)throw Ut;const xe=It?.length||0,st=It?.reduce((pr,Xt)=>pr+(Number(Xt.valor)||0),0)||0,Ct=xe>0?st/xe:0,ar=It?.[It.length-1]?.recebido_em||null;$({transacoes:xe,faturamento:st,ticketMedio:Ct,ultimaUtilizacao:ar})}catch(Be){console.error("Erro ao carregar estatsticas:",Be),e({title:"Erro ao carregar estatsticas",description:Be?.message,variant:"destructive"})}finally{ve(!1)}},ge=async(Ne="customizado",ye=null,Be=null)=>{try{ne(!0);const mt=t?.codigo_empresa;if(!mt)return;let Ft,fr;if(Ne==="customizado"&&ye&&Be)Ft=new Date(ye).toISOString(),fr=new Date(Be+"T23:59:59").toISOString();else{const Ct=new Date;switch(fr=Ct.toISOString(),Ne){case"hoje":Ft=new Date(Ct.setHours(0,0,0,0)).toISOString();break;case"semana":Ft=new Date(Ct.setDate(Ct.getDate()-7)).toISOString();break;case"mes":Ft=new Date(Ct.setMonth(Ct.getMonth()-1)).toISOString();break;default:Ft=new Date(Ct.setMonth(Ct.getMonth()-1)).toISOString()}}const{data:It,error:Ut}=await he.from("pagamentos").select("finalizadora_id, valor, finalizadoras!pagamentos_finalizadora_id_fkey(id, codigo_interno, nome)").eq("codigo_empresa",mt).gte("recebido_em",Ft).lte("recebido_em",fr).neq("status","Cancelado").neq("status","Estornado");if(Ut)throw Ut;const xe={};It?.forEach(Ct=>{const ar=Ct.finalizadora_id;ar&&(xe[ar]||(xe[ar]={id:ar,codigo:Ct.finalizadoras?.codigo_interno||"-",nome:Ct.finalizadoras?.nome||"Sem nome",total:0,transacoes:0}),xe[ar].total+=Number(Ct.valor)||0,xe[ar].transacoes+=1)});const st=Object.values(xe).sort((Ct,ar)=>ar.total-Ct.total);fe(st)}catch(mt){console.error("Erro ao carregar ranking:",mt),e({title:"Erro ao carregar ranking",description:mt?.message,variant:"destructive"})}finally{ne(!1)}},rt=()=>{Y(!0),ce("customizado");const Ne=new Date,ye=new Date;ye.setMonth(ye.getMonth()-1),ie(ye.toISOString().split("T")[0]),ue(Ne.toISOString().split("T")[0]),ge("customizado",ye.toISOString().split("T")[0],Ne.toISOString().split("T")[0])},pt=Ne=>{z(Ne),M(!0),K("mes"),Qe(Ne.id,"mes")},We=async()=>{try{if(!P.nome?.trim()){e({title:"Nome  obrigatrio",variant:"warning"});return}if(!P.codigo_sefaz){e({title:"Cdigo SEFAZ  obrigatrio",variant:"warning"});return}if(P.codigo_interno?.trim()&&n.some(mt=>mt.codigo_interno===P.codigo_interno.trim()&&(!_||mt.id!==_.id))){e({title:"Cdigo j existe",description:"Este cdigo interno j est em uso por outra finalizadora",variant:"warning"});return}c(!0);const Ne=t?.codigo_empresa,ye={codigo_interno:P.codigo_interno?.trim()||null,codigo_sefaz:P.codigo_sefaz,nome:P.nome.trim(),tipo:"outros",taxa_percentual:P.taxa_percentual===""?null:Number(P.taxa_percentual),ativo:P.ativo};_?(await qGe(_.id,ye,Ne),e({title:"Finalizadora atualizada!",variant:"success"})):(await BGe(ye,Ne),e({title:"Finalizadora criada!",variant:"success"})),j(!1),await Nt()}catch(Ne){e({title:"Erro ao salvar",description:Ne?.message,variant:"destructive"})}finally{c(!1)}},Ze=async Ne=>{try{await zGe(Ne.id,!Ne.ativo,t?.codigo_empresa),e({title:Ne.ativo?"Desativada":"Ativada",variant:"success"}),await Nt()}catch(ye){e({title:"Erro ao alterar status",description:ye?.message,variant:"destructive"})}};return p.useEffect(()=>{r&&t?.codigo_empresa&&Nt()},[r,t?.codigo_empresa]),a.jsxs(a.Fragment,{children:[a.jsxs(jr.div,{variants:Dot,initial:"hidden",animate:"visible",className:"flex-1 space-y-6 p-4 md:p-6",children:[a.jsxs(jr.div,{variants:a_,className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"min-w-0",children:a.jsx("h1",{className:"text-2xl md:text-3xl font-black text-text-primary tracking-tight leading-tight",children:"Finalizadoras"})}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(me,{variant:"ghost",size:"icon",onClick:()=>y(!g),className:"h-9 w-9",children:g?a.jsx(Fp,{className:"h-5 w-5"}):a.jsx(rg,{className:"h-5 w-5"})}),a.jsxs(me,{onClick:Pt,className:"gap-2 h-9 px-3 whitespace-nowrap",children:[a.jsx(ns,{className:"h-4 w-4"}),a.jsx("span",{className:"md:hidden",children:"Nova"}),a.jsx("span",{className:"hidden md:inline",children:"Nova Finalizadora"})]})]})]}),g&&a.jsxs("div",{className:"grid grid-cols-3 gap-3 md:grid-cols-3 md:gap-6",children:[a.jsx(ek,{icon:Um,title:"Total",value:at.total,subtitle:"Finalizadoras cadastradas",color:"brand"}),a.jsx(ek,{icon:Ko,title:"Ativas",value:at.ativas,subtitle:"Disponveis para uso",color:"success",onClick:()=>b(x==="ativas"?null:"ativas"),isActive:x==="ativas"}),a.jsx(ek,{icon:Vf,title:"Mais Usada",value:at.maisUsada,subtitle:"Mtodo mais popular",color:"warning",onClick:rt})]}),a.jsx(jr.div,{variants:a_,className:"bg-surface rounded-lg border border-border p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative min-w-0 basis-0 flex-grow",children:[a.jsx(to,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar finalizadora...",value:d,onChange:Ne=>u(Ne.target.value),className:"pl-10 h-11"})]}),a.jsxs(Nn,{value:m,onValueChange:v,children:[a.jsx(bn,{className:"w-[110px] md:w-[180px]",children:a.jsx(Cn,{placeholder:"Filtrar por status"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Todos"}),a.jsx(tt,{value:"active",children:"Ativas"}),a.jsx(tt,{value:"inactive",children:"Inativas"})]})]})]})}),a.jsx(jr.div,{variants:a_,className:"bg-surface rounded-lg border border-border overflow-hidden",children:o?a.jsxs("div",{className:"p-12 text-center",children:[a.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),a.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):gt.length===0?a.jsxs("div",{className:"p-12 text-center text-text-muted",children:[a.jsx(Um,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Nenhuma finalizadora encontrada"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden divide-y divide-border",children:gt.map(Ne=>a.jsxs("div",{className:"p-3 flex flex-col gap-2 hover:bg-surface-2/50 cursor-pointer",onClick:()=>pt(Ne),children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"px-2 py-0.5 rounded-md bg-surface-2 border border-border font-mono text-xs text-text-secondary",children:Ne.codigo_interno||"-"}),a.jsx("span",{className:"font-semibold text-sm text-text-primary truncate",title:Ne.nome,children:Ne.nome})]}),a.jsxs("span",{className:gr("inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[11px] font-medium",Ne.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[a.jsx("span",{className:gr("w-1.5 h-1.5 rounded-full",Ne.ativo?"bg-success":"bg-muted")}),Ne.ativo?"Ativa":"Inativa"]})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-text-secondary",children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("span",{children:["Taxa: ",Ne.taxa_percentual?`${Ne.taxa_percentual}%`:"-"]})}),a.jsxs("div",{className:"flex items-center gap-2",onClick:ye=>ye.stopPropagation(),children:[a.jsx(me,{variant:"ghost",size:"sm",className:"h-7 px-2",onClick:()=>yt(Ne),children:a.jsx(xl,{className:"h-4 w-4"})}),a.jsx(me,{variant:Ne.ativo?"ghost":"default",size:"sm",className:"h-7 px-2",onClick:()=>Ze(Ne),children:Ne.ativo?"Desativar":"Ativar"})]})]})]},Ne.id))}),a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-surface-2 border-b border-border",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Cdigo"}),a.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Descrio"}),a.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Taxa (%)"}),a.jsx("th",{className:"text-center px-6 py-4 text-sm font-semibold text-text-secondary",children:"Status"}),a.jsx("th",{className:"text-right px-6 py-4 text-sm font-semibold text-text-secondary",children:"Aes"})]})}),a.jsx("tbody",{className:"divide-y divide-border",children:gt.map(Ne=>a.jsxs("tr",{className:"hover:bg-surface-2/50 transition-colors cursor-pointer",onClick:()=>pt(Ne),children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"font-mono text-sm text-text-primary",children:Ne.codigo_interno||"-"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"font-semibold text-text-primary",children:Ne.nome})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"text-text-secondary",children:Ne.taxa_percentual?`${Ne.taxa_percentual}%`:"-"})}),a.jsx("td",{className:"px-6 py-4 text-center",children:a.jsxs("span",{className:gr("inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium",Ne.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[a.jsx("span",{className:gr("w-2 h-2 rounded-full",Ne.ativo?"bg-success":"bg-muted")}),Ne.ativo?"Ativa":"Inativa"]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex justify-end gap-2",onClick:ye=>ye.stopPropagation(),children:[a.jsx(me,{variant:"ghost",size:"sm",onClick:()=>yt(Ne),children:a.jsx(xl,{className:"h-4 w-4"})}),a.jsx(me,{variant:Ne.ativo?"ghost":"default",size:"sm",onClick:()=>Ze(Ne),children:Ne.ativo?"Desativar":"Ativar"})]})})]},Ne.id))})]})})]})})]}),a.jsx(xn,{open:w,onOpenChange:j,children:a.jsxs(vn,{className:"sm:max-w-[500px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:_?"Editar Finalizadora":"Nova Finalizadora"}),a.jsx(Dn,{children:_?"Atualize as informaes da finalizadora":"Adicione um novo mtodo de pagamento"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{htmlFor:"codigo_interno",children:"Cdigo Finalizadora"}),a.jsx(Ye,{id:"codigo_interno",type:"text",placeholder:"Ex: 01, 02, 03...",value:P.codigo_interno,onChange:Ne=>E({...P,codigo_interno:Ne.target.value})}),a.jsx("p",{className:"text-xs text-text-muted",children:"Gerado automaticamente, mas pode ser editado"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{htmlFor:"nome",children:"Descrio *"}),a.jsx(Ye,{id:"nome",placeholder:"Ex: PIX, Dinheiro, Carto de Crdito...",value:P.nome,onChange:Ne=>E({...P,nome:Ne.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{htmlFor:"codigo_sefaz",children:"Forma de Pagamento NF-e/NFC-e *"}),a.jsx(me,{type:"button",variant:"outline",className:"justify-between w-full",onClick:()=>F(!0),children:P.codigo_sefaz?`${P.codigo_sefaz} - ${HU.find(Ne=>Ne.codigo===P.codigo_sefaz)?.nome||""}`:"Selecione a forma de pagamento"}),a.jsx("p",{className:"text-xs text-text-muted",children:"A lista abrir em um modal com rolagem."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{htmlFor:"taxa",children:"Taxa"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ye,{id:"taxa",inputMode:"decimal",placeholder:"0,00",className:"pr-10",value:P.taxa_percentual,onChange:Ne=>{const ye=String(Ne.target.value).replace(/[^0-9.,]/g,"").replace(/,/g,".");if(ye===""){E({...P,taxa_percentual:""});return}const Be=Number(ye);if(Number.isFinite(Be)){const mt=Math.max(0,Math.min(100,Be));E({...P,taxa_percentual:String(mt)})}},onBlur:()=>{const Ne=String(P.taxa_percentual||"").replace(/,/g,".");if(Ne==="")return;const ye=Number(Ne);if(Number.isFinite(ye)){const Be=Math.max(0,Math.min(100,ye));E(mt=>({...mt,taxa_percentual:Be.toFixed(2)}))}}}),a.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-muted text-sm",children:"%"})]}),a.jsx("p",{className:"text-xs text-text-muted",children:"Deixe vazio se no houver taxa"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"ativo",checked:P.ativo,onChange:Ne=>E({...P,ativo:Ne.target.checked}),className:"h-4 w-4 rounded border-border"}),a.jsx(Le,{htmlFor:"ativo",className:"text-sm font-normal cursor-pointer",children:"Finalizadora ativa"})]})]}),a.jsxs(ra,{children:[a.jsx(me,{variant:"outline",onClick:()=>j(!1),disabled:l,children:"Cancelar"}),a.jsx(me,{onClick:We,disabled:l,children:l?"Salvando...":"Salvar"})]})]})}),a.jsx(xn,{open:A,onOpenChange:F,children:a.jsxs(vn,{className:"sm:max-w-[520px] w-[92vw]",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Selecionar Forma de Pagamento (SEFAZ)"}),a.jsx(Dn,{children:"Busque por cdigo ou nome"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(Ye,{placeholder:"Ex.: 03, crdito, pix...",value:D,onChange:Ne=>I(Ne.target.value)}),a.jsx("div",{className:"max-h-[420px] overflow-auto fx-scroll rounded-md border border-border",children:a.jsx("ul",{className:"divide-y divide-border",children:HU.filter(Ne=>{const ye=(D||"").toLowerCase();return ye?Ne.codigo.includes(ye)||String(Ne.nome).toLowerCase().includes(ye):!0}).map(Ne=>a.jsx("li",{children:a.jsxs("button",{type:"button",className:`w-full text-left px-3 py-2 hover:bg-surface-2 ${P.codigo_sefaz===Ne.codigo?"bg-surface-2":""}`,onClick:()=>{E(ye=>({...ye,codigo_sefaz:Ne.codigo})),F(!1)},children:[a.jsx("span",{className:"font-mono mr-2 text-text-secondary",children:Ne.codigo}),a.jsx("span",{children:Ne.nome})]})},Ne.codigo))})})]})]})}),a.jsx(xn,{open:R,onOpenChange:M,children:a.jsxs(vn,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Detalhes da Finalizadora"}),a.jsx(Dn,{children:"Estatsticas e informaes completas"})]}),U&&a.jsxs("div",{className:"space-y-6 py-4",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Informaes"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Cdigo Finalizadora"}),a.jsx("p",{className:"font-mono text-sm text-text-primary",children:U.codigo_interno||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento NF-e/NFC-e"}),a.jsx("p",{className:"font-mono text-sm text-text-primary",children:U.codigo_sefaz||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Descrio"}),a.jsx("p",{className:"font-medium text-text-primary",children:U.nome})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Taxa"}),a.jsx("p",{className:"font-medium text-text-primary",children:U.taxa_percentual?`${U.taxa_percentual}%`:"Sem taxa"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Status"}),a.jsxs("span",{className:gr("inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs font-medium",U.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[a.jsx("span",{className:gr("w-2 h-2 rounded-full",U.ativo?"bg-success":"bg-muted")}),U.ativo?"Ativa":"Inativa"]})]})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Perodo de Anlise"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(me,{variant:_e==="hoje"?"default":"outline",size:"sm",onClick:()=>{K("hoje"),Qe(U.id,"hoje")},children:"Hoje"}),a.jsx(me,{variant:_e==="semana"?"default":"outline",size:"sm",onClick:()=>{K("semana"),Qe(U.id,"semana")},children:"7 Dias"}),a.jsx(me,{variant:_e==="mes"?"default":"outline",size:"sm",onClick:()=>{K("mes"),Qe(U.id,"mes")},children:"30 Dias"})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Estatsticas de Uso"}),ee?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-brand border-t-transparent"})}):W?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Total de Transaes"}),a.jsx("span",{className:"font-semibold text-text-primary",children:W.transacoes})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Faturamento Total"}),a.jsxs("span",{className:"font-semibold text-success",children:["R$ ",W.faturamento.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Ticket Mdio"}),a.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",W.ticketMedio.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"ltima Utilizao"}),a.jsx("span",{className:"font-medium text-text-muted",children:W.ultimaUtilizacao?new Date(W.ultimaUtilizacao).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Nunca utilizada"})]})]}):a.jsx("div",{className:"text-center py-8 text-text-muted",children:a.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel"})})]})]}),a.jsxs(ra,{children:[a.jsx(me,{variant:"outline",onClick:()=>M(!1),children:"Fechar"}),a.jsxs(me,{onClick:()=>{M(!1),yt(U)},children:[a.jsx(xl,{className:"h-4 w-4 mr-2"}),"Editar"]})]})]})}),a.jsx(xn,{open:q,onOpenChange:Y,children:a.jsxs(vn,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Ranking de Finalizadoras"}),a.jsx(Dn,{children:"Faturamento por forma de pagamento"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx(me,{variant:Z==="hoje"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{ce("hoje"),ge("hoje")},children:"Hoje"}),a.jsx(me,{variant:Z==="semana"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{ce("semana"),ge("semana")},children:"7 Dias"}),a.jsx(me,{variant:Z==="mes"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{ce("mes"),ge("mes")},children:"30 Dias"}),a.jsx(me,{variant:Z==="customizado"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>ce("customizado"),children:"Perodo"})]}),Z==="customizado"&&(de?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx(Le,{className:"text-xs",children:"Data Inicial"}),a.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:le,onChange:Ne=>ie(Ne.target.value)})]}),a.jsxs("div",{children:[a.jsx(Le,{className:"text-xs",children:"Data Final"}),a.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:te,onChange:Ne=>ue(Ne.target.value)})]})]}),a.jsx(me,{className:"w-full",onClick:()=>ge("customizado",le,te),disabled:!le||!te||Te,children:Te?"Buscando...":"Buscar"})]}):a.jsxs("div",{className:"flex gap-3 items-end",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx(Le,{children:"Data Inicial"}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"outline",className:gr("w-full justify-start text-left font-normal",!le&&"text-text-muted"),children:[a.jsx(Vs,{className:"mr-2 h-4 w-4"}),le?new Date(le+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),a.jsx(Jo,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:a.jsx(mT,{mode:"single",selected:le?new Date(le+"T12:00:00"):void 0,onSelect:Ne=>{if(Ne){const ye=Ne.getFullYear(),Be=String(Ne.getMonth()+1).padStart(2,"0"),mt=String(Ne.getDate()).padStart(2,"0");ie(`${ye}-${Be}-${mt}`)}},className:"p-3"})})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx(Le,{children:"Data Final"}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{variant:"outline",className:gr("w-full justify-start text-left font-normal",!te&&"text-text-muted"),children:[a.jsx(Vs,{className:"mr-2 h-4 w-4"}),te?new Date(te+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),a.jsx(Jo,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:a.jsx(mT,{mode:"single",selected:te?new Date(te+"T12:00:00"):void 0,onSelect:Ne=>{if(Ne){const ye=Ne.getFullYear(),Be=String(Ne.getMonth()+1).padStart(2,"0"),mt=String(Ne.getDate()).padStart(2,"0");ue(`${ye}-${Be}-${mt}`)}},className:"p-3"})})]})]}),a.jsx(me,{onClick:()=>ge("customizado",le,te),disabled:!le||!te||Te,children:"Buscar"})]}))]}),Te?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand border-t-transparent"})}):J.length===0?a.jsx("div",{className:"text-center py-12 text-text-muted",children:a.jsx("p",{children:"Nenhuma transao no perodo selecionado"})}):a.jsx("div",{className:"space-y-3",children:J.map((Ne,ye)=>a.jsx("div",{className:"bg-surface-2 rounded-lg p-3 md:p-4 border border-border",children:a.jsxs("div",{className:"flex items-start md:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-start md:items-center gap-2 md:gap-3 flex-1 min-w-0",children:[a.jsxs("div",{className:gr("flex items-center justify-center w-7 h-7 md:w-8 md:h-8 rounded-full font-bold text-xs md:text-sm flex-shrink-0",ye===0?"bg-warning/20 text-warning":ye===1?"bg-info/20 text-info":ye===2?"bg-success/20 text-success":"bg-muted/20 text-muted"),children:[ye+1,""]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[a.jsx("span",{className:"font-mono text-[10px] md:text-xs text-text-muted",children:Ne.codigo}),a.jsx("span",{className:"font-semibold text-sm md:text-base text-text-primary truncate",children:Ne.nome})]}),a.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted",children:[Ne.transacoes," transaes"]})]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsxs("p",{className:"text-base md:text-lg font-bold text-success whitespace-nowrap",children:["R$ ",Ne.total.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),a.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted whitespace-nowrap",children:["Mdia: R$ ",(Ne.total/Ne.transacoes).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})},Ne.id))})]}),a.jsx(ra,{children:a.jsx(me,{variant:"outline",onClick:()=>Y(!1),children:"Fechar"})})]})})]})}function Rot(){return a.jsxs("div",{className:"p-8",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Pgina de Teste"}),a.jsx("p",{children:"Esta  uma pgina de teste para verificar se o roteamento est funcionando corretamente."})]})}function Lot(){const[e,t]=p.useState(!1),[r,n]=p.useState(""),[s,o]=p.useState("Manuteno em andamento. Volte em breve!"),[i,l]=p.useState(!1),[c,d]=p.useState("");p.useEffect(()=>{try{const h=localStorage.getItem("maintenance:active")==="false",m=localStorage.getItem("maintenance:end")||"",v=localStorage.getItem("maintenance:message")||"Manuteno em andamento. Volte em breve!";t(h),n(m),o(v)}catch{}},[]);const u=h=>{if(h?.preventDefault(),e&&!r){alert("Defina uma data de trmino para a manuteno");return}localStorage.setItem("maintenance:active",e),localStorage.setItem("maintenance:end",r),localStorage.setItem("maintenance:message",s),window.dispatchEvent(new Event("storage")),l(!1),d(" Configuraes salvas!"),setTimeout(()=>d(""),3e3)},f=()=>{const h=!e;if(t(h),localStorage.setItem("maintenance:active",String(h)),h&&!r){const m=new Date;m.setDate(m.getDate()+1);const v=m.toISOString().slice(0,16);n(v),localStorage.setItem("maintenance:end",v)}window.dispatchEvent(new Event("storage")),d(h?" Modo manuteno ATIVADO":" Modo manuteno DESATIVADO"),setTimeout(()=>d(""),3e3)};return a.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg mt-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Controle de Manuteno"}),a.jsx("button",{onClick:f,className:`inline-flex items-center px-4 py-2 rounded-md font-medium ${e?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:e?"Manuteno ATIVA":"Manuteno INATIVA"})]}),e&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"font-medium text-lg",children:"Configuraes"}),a.jsxs("button",{onClick:()=>l(!i),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 text-sm",children:[a.jsx(xl,{className:"w-4 h-4"}),i?"Ocultar":"Editar"]})]}),i?a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Trmino"}),a.jsx("div",{className:"relative",children:a.jsx("input",{type:"datetime-local",value:r,onChange:h=>n(h.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:new Date().toISOString().slice(0,16),required:!0})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensagem de Manuteno"}),a.jsx("textarea",{value:s,onChange:h=>o(h.target.value),rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Ex: Estamos em manuteno programada. Volte em breve!",required:!0})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[a.jsx(Fue,{className:"inline w-4 h-4 mr-1"}),"Salvar"]})]})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Trmino:"}),a.jsx("p",{className:"text-gray-900",children:r?new Date(r).toLocaleString():"No definido"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mensagem:"}),a.jsx("p",{className:"text-gray-900 whitespace-pre-line",children:s})]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Como usar:"}),a.jsxs("ol",{className:"list-decimal pl-5 space-y-1",children:[a.jsx("li",{children:"Ative/desative o boto no topo"}),a.jsx("li",{children:"Defina a data de trmino e uma mensagem amigvel"}),a.jsx("li",{children:"Salve as configuraes"}),a.jsx("li",{children:"Para acessar durante a manuteno, use a senha no link"})]})]}),c&&a.jsx("div",{className:"fixed bottom-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded shadow-lg",children:c})]})}function Fot(e){const t=new URLSearchParams(e.startsWith("#")?e.slice(1):e),r=t.get("access_token"),n=t.get("refresh_token");return{access_token:r,refresh_token:n}}const $ot=()=>{const{toast:e}=as(),t=Ri(),[r,n]=p.useState(""),[s,o]=p.useState(""),[i,l]=p.useState(!1),[c,d]=p.useState(!1),u=p.useMemo(()=>Fot(window.location.hash),[]);p.useEffect(()=>{(async()=>{const{data:{session:m}}=await he.auth.getSession();if(m){d(!0);return}if(u.access_token&&u.refresh_token){const{data:v,error:g}=await he.auth.setSession({access_token:u.access_token,refresh_token:u.refresh_token});g&&e({title:"Link invlido ou expirado",description:"Abra o link do email novamente.",variant:"destructive"}),d(!!v?.session)}else e({title:"Link invlido",description:"Abra o link de redefinio enviado por email.",variant:"destructive"})})()},[]);const f=async h=>{if(h.preventDefault(),r.length<6){e({title:"Senha muito curta",description:"A senha deve ter pelo menos 6 caracteres.",variant:"destructive"});return}if(r!==s){e({title:"Senhas no conferem",description:"As senhas digitadas so diferentes.",variant:"destructive"});return}l(!0);const{data:m,error:v}=await he.auth.updateUser({password:r});if(l(!1),v){e({title:"Erro ao redefinir senha",description:v.message||"Tente novamente.",variant:"destructive"});return}e({title:"Senha redefinida",description:"Voc j pode acessar o sistema.",variant:"default"}),t("/")};return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-6",children:a.jsxs("div",{className:"w-full max-w-md bg-surface rounded-xl border border-border p-6 shadow",children:[a.jsx("h1",{className:"text-2xl font-semibold mb-2 text-text-primary",children:"Redefinir senha"}),a.jsx("p",{className:"text-sm text-text-secondary mb-6",children:"Defina uma nova senha para sua conta."}),a.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Nova senha"}),a.jsx(Ye,{type:"password",value:r,onChange:h=>n(h.target.value),placeholder:"",disabled:!c||i})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Confirmar nova senha"}),a.jsx(Ye,{type:"password",value:s,onChange:h=>o(h.target.value),placeholder:"",disabled:!c||i})]}),a.jsx(me,{type:"submit",className:"w-full",disabled:!c||i,children:i?"Salvando...":"Salvar nova senha"})]})]})})};function Bot(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var Jse=p,qot=Bot(Jse);function GU(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zot(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Uot=!!(typeof window<"u"&&window.document&&window.document.createElement);function Vot(e,t,r){if(typeof e!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof t!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof r<"u"&&typeof r!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function n(s){return s.displayName||s.name||"Component"}return function(o){if(typeof o!="function")throw new Error("Expected WrappedComponent to be a React component.");var i=[],l;function c(){l=e(i.map(function(u){return u.props})),d.canUseDOM?t(l):r&&(l=r(l))}var d=function(u){zot(f,u);function f(){return u.apply(this,arguments)||this}f.peek=function(){return l},f.rewind=function(){if(f.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var v=l;return l=void 0,i=[],v};var h=f.prototype;return h.UNSAFE_componentWillMount=function(){i.push(this),c()},h.componentDidUpdate=function(){c()},h.componentWillUnmount=function(){var v=i.indexOf(this);i.splice(v,1),c()},h.render=function(){return qot.createElement(o,this.props)},f}(Jse.PureComponent);return GU(d,"displayName","SideEffect("+n(o)+")"),GU(d,"canUseDOM",Uot),d}}var Wot=Vot;const Hot=Ga(Wot);var Got=typeof Element<"u",Kot=typeof Map=="function",Xot=typeof Set=="function",Yot=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function s_(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n,s;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!s_(e[n],t[n]))return!1;return!0}var o;if(Kot&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(o=e.entries();!(n=o.next()).done;)if(!t.has(n.value[0]))return!1;for(o=e.entries();!(n=o.next()).done;)if(!s_(n.value[1],t.get(n.value[0])))return!1;return!0}if(Xot&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(o=e.entries();!(n=o.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(Yot&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[n]))return!1;if(Got&&e instanceof Element)return!1;for(n=r;n--!==0;)if(!((s[n]==="_owner"||s[n]==="__v"||s[n]==="__o")&&e.$$typeof)&&!s_(e[s[n]],t[s[n]]))return!1;return!0}return e!==e&&t!==t}var Jot=function(t,r){try{return s_(t,r)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}};const Qot=Ga(Jot);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var KU=Object.getOwnPropertySymbols,Zot=Object.prototype.hasOwnProperty,eit=Object.prototype.propertyIsEnumerable;function tit(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function rit(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(o){return t[o]});if(n.join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(o){s[o]=o}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var nit=rit()?Object.assign:function(e,t){for(var r,n=tit(e),s,o=1;o<arguments.length;o++){r=Object(arguments[o]);for(var i in r)Zot.call(r,i)&&(n[i]=r[i]);if(KU){s=KU(r);for(var l=0;l<s.length;l++)eit.call(r,s[l])&&(n[s[l]]=r[s[l]])}}return n};const ait=Ga(nit);var Yp={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"},_a={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(_a).map(function(e){return _a[e]});var Gs={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src",TARGET:"target"},TS={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},e1={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},sit=Object.keys(TS).reduce(function(e,t){return e[TS[t]]=t,e},{}),oit=[_a.NOSCRIPT,_a.SCRIPT,_a.STYLE],ru="data-react-helmet",iit=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lit=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},cit=function(){function e(t,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Fl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dit=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},XU=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},uit=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},t3=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},fit=function(t){var r=cx(t,_a.TITLE),n=cx(t,e1.TITLE_TEMPLATE);if(n&&r)return n.replace(/%s/g,function(){return Array.isArray(r)?r.join(""):r});var s=cx(t,e1.DEFAULT_TITLE);return r||s||void 0},mit=function(t){return cx(t,e1.ON_CHANGE_CLIENT_STATE)||function(){}},tk=function(t,r){return r.filter(function(n){return typeof n[t]<"u"}).map(function(n){return n[t]}).reduce(function(n,s){return Fl({},n,s)},{})},hit=function(t,r){return r.filter(function(n){return typeof n[_a.BASE]<"u"}).map(function(n){return n[_a.BASE]}).reverse().reduce(function(n,s){if(!n.length)for(var o=Object.keys(s),i=0;i<o.length;i++){var l=o[i],c=l.toLowerCase();if(t.indexOf(c)!==-1&&s[c])return n.concat(s)}return n},[])},by=function(t,r,n){var s={};return n.filter(function(o){return Array.isArray(o[t])?!0:(typeof o[t]<"u"&&xit("Helmet: "+t+' should be of type "Array". Instead found type "'+iit(o[t])+'"'),!1)}).map(function(o){return o[t]}).reverse().reduce(function(o,i){var l={};i.filter(function(h){for(var m=void 0,v=Object.keys(h),g=0;g<v.length;g++){var y=v[g],x=y.toLowerCase();r.indexOf(x)!==-1&&!(m===Gs.REL&&h[m].toLowerCase()==="canonical")&&!(x===Gs.REL&&h[x].toLowerCase()==="stylesheet")&&(m=x),r.indexOf(y)!==-1&&(y===Gs.INNER_HTML||y===Gs.CSS_TEXT||y===Gs.ITEM_PROP)&&(m=y)}if(!m||!h[m])return!1;var b=h[m].toLowerCase();return s[m]||(s[m]={}),l[m]||(l[m]={}),s[m][b]?!1:(l[m][b]=!0,!0)}).reverse().forEach(function(h){return o.push(h)});for(var c=Object.keys(l),d=0;d<c.length;d++){var u=c[d],f=ait({},s[u],l[u]);s[u]=f}return o},[]).reverse()},cx=function(t,r){for(var n=t.length-1;n>=0;n--){var s=t[n];if(s.hasOwnProperty(r))return s[r]}return null},pit=function(t){return{baseTag:hit([Gs.HREF,Gs.TARGET],t),bodyAttributes:tk(Yp.BODY,t),defer:cx(t,e1.DEFER),encode:cx(t,e1.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:tk(Yp.HTML,t),linkTags:by(_a.LINK,[Gs.REL,Gs.HREF],t),metaTags:by(_a.META,[Gs.NAME,Gs.CHARSET,Gs.HTTPEQUIV,Gs.PROPERTY,Gs.ITEM_PROP],t),noscriptTags:by(_a.NOSCRIPT,[Gs.INNER_HTML],t),onChangeClientState:mit(t),scriptTags:by(_a.SCRIPT,[Gs.SRC,Gs.INNER_HTML],t),styleTags:by(_a.STYLE,[Gs.CSS_TEXT],t),title:fit(t),titleAttributes:tk(Yp.TITLE,t)}},r3=function(){var e=Date.now();return function(t){var r=Date.now();r-e>16?(e=r,t(r)):setTimeout(function(){r3(t)},0)}}(),YU=function(t){return clearTimeout(t)},git=typeof window<"u"?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||r3:global.requestAnimationFrame||r3,vit=typeof window<"u"?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||YU:global.cancelAnimationFrame||YU,xit=function(t){return console&&typeof console.warn=="function"&&console.warn(t)},wy=null,yit=function(t){wy&&vit(wy),t.defer?wy=git(function(){JU(t,function(){wy=null})}):(JU(t),wy=null)},JU=function(t,r){var n=t.baseTag,s=t.bodyAttributes,o=t.htmlAttributes,i=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.onChangeClientState,u=t.scriptTags,f=t.styleTags,h=t.title,m=t.titleAttributes;n3(_a.BODY,s),n3(_a.HTML,o),bit(h,m);var v={baseTag:cv(_a.BASE,n),linkTags:cv(_a.LINK,i),metaTags:cv(_a.META,l),noscriptTags:cv(_a.NOSCRIPT,c),scriptTags:cv(_a.SCRIPT,u),styleTags:cv(_a.STYLE,f)},g={},y={};Object.keys(v).forEach(function(x){var b=v[x],w=b.newTags,j=b.oldTags;w.length&&(g[x]=w),j.length&&(y[x]=v[x].oldTags)}),r&&r(),d(t,g,y)},Qse=function(t){return Array.isArray(t)?t.join(""):t},bit=function(t,r){typeof t<"u"&&document.title!==t&&(document.title=Qse(t)),n3(_a.TITLE,r)},n3=function(t,r){var n=document.getElementsByTagName(t)[0];if(n){for(var s=n.getAttribute(ru),o=s?s.split(","):[],i=[].concat(o),l=Object.keys(r),c=0;c<l.length;c++){var d=l[c],u=r[d]||"";n.getAttribute(d)!==u&&n.setAttribute(d,u),o.indexOf(d)===-1&&o.push(d);var f=i.indexOf(d);f!==-1&&i.splice(f,1)}for(var h=i.length-1;h>=0;h--)n.removeAttribute(i[h]);o.length===i.length?n.removeAttribute(ru):n.getAttribute(ru)!==l.join(",")&&n.setAttribute(ru,l.join(","))}},cv=function(t,r){var n=document.head||document.querySelector(_a.HEAD),s=n.querySelectorAll(t+"["+ru+"]"),o=Array.prototype.slice.call(s),i=[],l=void 0;return r&&r.length&&r.forEach(function(c){var d=document.createElement(t);for(var u in c)if(c.hasOwnProperty(u))if(u===Gs.INNER_HTML)d.innerHTML=c.innerHTML;else if(u===Gs.CSS_TEXT)d.styleSheet?d.styleSheet.cssText=c.cssText:d.appendChild(document.createTextNode(c.cssText));else{var f=typeof c[u]>"u"?"":c[u];d.setAttribute(u,f)}d.setAttribute(ru,"true"),o.some(function(h,m){return l=m,d.isEqualNode(h)})?o.splice(l,1):i.push(d)}),o.forEach(function(c){return c.parentNode.removeChild(c)}),i.forEach(function(c){return n.appendChild(c)}),{oldTags:o,newTags:i}},Zse=function(t){return Object.keys(t).reduce(function(r,n){var s=typeof t[n]<"u"?n+'="'+t[n]+'"':""+n;return r?r+" "+s:s},"")},wit=function(t,r,n,s){var o=Zse(n),i=Qse(r);return o?"<"+t+" "+ru+'="true" '+o+">"+t3(i,s)+"</"+t+">":"<"+t+" "+ru+'="true">'+t3(i,s)+"</"+t+">"},jit=function(t,r,n){return r.reduce(function(s,o){var i=Object.keys(o).filter(function(d){return!(d===Gs.INNER_HTML||d===Gs.CSS_TEXT)}).reduce(function(d,u){var f=typeof o[u]>"u"?u:u+'="'+t3(o[u],n)+'"';return d?d+" "+f:f},""),l=o.innerHTML||o.cssText||"",c=oit.indexOf(t)===-1;return s+"<"+t+" "+ru+'="true" '+i+(c?"/>":">"+l+"</"+t+">")},"")},eoe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,s){return n[TS[s]||s]=t[s],n},r)},_it=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,s){return n[sit[s]||s]=t[s],n},r)},Nit=function(t,r,n){var s,o=(s={key:r},s[ru]=!0,s),i=eoe(n,o);return[Se.createElement(_a.TITLE,i,r)]},Sit=function(t,r){return r.map(function(n,s){var o,i=(o={key:s},o[ru]=!0,o);return Object.keys(n).forEach(function(l){var c=TS[l]||l;if(c===Gs.INNER_HTML||c===Gs.CSS_TEXT){var d=n.innerHTML||n.cssText;i.dangerouslySetInnerHTML={__html:d}}else i[c]=n[l]}),Se.createElement(t,i)})},xf=function(t,r,n){switch(t){case _a.TITLE:return{toComponent:function(){return Nit(t,r.title,r.titleAttributes)},toString:function(){return wit(t,r.title,r.titleAttributes,n)}};case Yp.BODY:case Yp.HTML:return{toComponent:function(){return eoe(r)},toString:function(){return Zse(r)}};default:return{toComponent:function(){return Sit(t,r)},toString:function(){return jit(t,r,n)}}}},toe=function(t){var r=t.baseTag,n=t.bodyAttributes,s=t.encode,o=t.htmlAttributes,i=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.scriptTags,u=t.styleTags,f=t.title,h=f===void 0?"":f,m=t.titleAttributes;return{base:xf(_a.BASE,r,s),bodyAttributes:xf(Yp.BODY,n,s),htmlAttributes:xf(Yp.HTML,o,s),link:xf(_a.LINK,i,s),meta:xf(_a.META,l,s),noscript:xf(_a.NOSCRIPT,c,s),script:xf(_a.SCRIPT,d,s),style:xf(_a.STYLE,u,s),title:xf(_a.TITLE,{title:h,titleAttributes:m},s)}},Cit=function(t){var r,n;return n=r=function(s){dit(o,s);function o(){return lit(this,o),uit(this,s.apply(this,arguments))}return o.prototype.shouldComponentUpdate=function(l){return!Qot(this.props,l)},o.prototype.mapNestedChildrenToProps=function(l,c){if(!c)return null;switch(l.type){case _a.SCRIPT:case _a.NOSCRIPT:return{innerHTML:c};case _a.STYLE:return{cssText:c}}throw new Error("<"+l.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},o.prototype.flattenArrayTypeChildren=function(l){var c,d=l.child,u=l.arrayTypeChildren,f=l.newChildProps,h=l.nestedChildren;return Fl({},u,(c={},c[d.type]=[].concat(u[d.type]||[],[Fl({},f,this.mapNestedChildrenToProps(d,h))]),c))},o.prototype.mapObjectTypeChildren=function(l){var c,d,u=l.child,f=l.newProps,h=l.newChildProps,m=l.nestedChildren;switch(u.type){case _a.TITLE:return Fl({},f,(c={},c[u.type]=m,c.titleAttributes=Fl({},h),c));case _a.BODY:return Fl({},f,{bodyAttributes:Fl({},h)});case _a.HTML:return Fl({},f,{htmlAttributes:Fl({},h)})}return Fl({},f,(d={},d[u.type]=Fl({},h),d))},o.prototype.mapArrayTypeChildrenToProps=function(l,c){var d=Fl({},c);return Object.keys(l).forEach(function(u){var f;d=Fl({},d,(f={},f[u]=l[u],f))}),d},o.prototype.warnOnInvalidChildren=function(l,c){return!0},o.prototype.mapChildrenToProps=function(l,c){var d=this,u={};return Se.Children.forEach(l,function(f){if(!(!f||!f.props)){var h=f.props,m=h.children,v=XU(h,["children"]),g=_it(v);switch(d.warnOnInvalidChildren(f,m),f.type){case _a.LINK:case _a.META:case _a.NOSCRIPT:case _a.SCRIPT:case _a.STYLE:u=d.flattenArrayTypeChildren({child:f,arrayTypeChildren:u,newChildProps:g,nestedChildren:m});break;default:c=d.mapObjectTypeChildren({child:f,newProps:c,newChildProps:g,nestedChildren:m});break}}}),c=this.mapArrayTypeChildrenToProps(u,c),c},o.prototype.render=function(){var l=this.props,c=l.children,d=XU(l,["children"]),u=Fl({},d);return c&&(u=this.mapChildrenToProps(c,u)),Se.createElement(t,u)},cit(o,null,[{key:"canUseDOM",set:function(l){t.canUseDOM=l}}]),o}(Se.Component),r.propTypes={base:Jn.object,bodyAttributes:Jn.object,children:Jn.oneOfType([Jn.arrayOf(Jn.node),Jn.node]),defaultTitle:Jn.string,defer:Jn.bool,encodeSpecialCharacters:Jn.bool,htmlAttributes:Jn.object,link:Jn.arrayOf(Jn.object),meta:Jn.arrayOf(Jn.object),noscript:Jn.arrayOf(Jn.object),onChangeClientState:Jn.func,script:Jn.arrayOf(Jn.object),style:Jn.arrayOf(Jn.object),title:Jn.string,titleAttributes:Jn.object,titleTemplate:Jn.string},r.defaultProps={defer:!0,encodeSpecialCharacters:!0},r.peek=t.peek,r.rewind=function(){var s=t.rewind();return s||(s=toe({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),s},n},Ait=function(){return null},Pit=Hot(pit,yit,toe)(Ait),t1=Cit(Pit);t1.renderStatic=t1.rewind;function cl(e){return e??""}function Nj(e){return String(e||"").replace(/\D/g,"")}function Eit(){const{userProfile:e}=vs(),{toast:t}=as(),r=Ri(),[n,s]=p.useState(!0),[o,i]=p.useState(!1),[l,c]=p.useState(null),[d,u]=p.useState({inscricao_estadual:"",regime_tributario:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:"",nfce_serie:"1",nfce_numeracao:"1",nfce_itoken:"",nfe_serie:"",nfe_numeracao:"",ambiente:"homologacao",transmitenota_apikey:"",transmitenota_base_url:"",transmitenota_base_url_hml:"",transmitenota_apikey_hml:"",transmitenota_base_url_prod:"",transmitenota_apikey_prod:""});p.useEffect(()=>{async function v(){if(!e?.codigo_empresa)return;s(!0);const{data:g,error:y}=await he.from("empresas").select("*").eq("codigo_empresa",e.codigo_empresa).single();y?t({title:"Erro ao carregar",description:y.message,variant:"destructive"}):g&&(c(g),u({inscricao_estadual:cl(g.inscricao_estadual),regime_tributario:g.regime_tributario?String(g.regime_tributario):"",logradouro:cl(g.logradouro),numero:cl(g.numero),complemento:cl(g.complemento),bairro:cl(g.bairro),cidade:cl(g.cidade),uf:cl(g.uf),cep:Nj(g.cep),codigo_municipio_ibge:cl(g.codigo_municipio_ibge),nfce_serie:g.nfce_serie!=null?String(g.nfce_serie):"1",nfce_numeracao:g.nfce_numeracao!=null?String(g.nfce_numeracao):"1",nfce_itoken:cl(g.nfce_itoken),nfe_serie:g.nfe_serie!=null?String(g.nfe_serie):"",nfe_numeracao:g.nfe_numeracao!=null?String(g.nfe_numeracao):"",ambiente:g.ambiente||"homologacao",transmitenota_apikey:cl(g.transmitenota_apikey),transmitenota_base_url:cl(g.transmitenota_base_url),transmitenota_base_url_hml:cl(g.transmitenota_base_url_hml),transmitenota_apikey_hml:cl(g.transmitenota_apikey_hml),transmitenota_base_url_prod:cl(g.transmitenota_base_url_prod),transmitenota_apikey_prod:cl(g.transmitenota_apikey_prod)})),s(!1)}v()},[e?.codigo_empresa]);const f=v=>g=>{const y=g?.target?g.target.value:g;u(x=>({...x,[v]:y}))};async function h(v){if(v?.preventDefault?.(),!e?.codigo_empresa)return;const g={inscricao_estadual:d.inscricao_estadual?.trim()||null,regime_tributario:d.regime_tributario?Number(d.regime_tributario):null,logradouro:d.logradouro?.trim()||null,numero:d.numero?.trim()||null,complemento:d.complemento?.trim()||null,bairro:d.bairro?.trim()||null,cidade:d.cidade?.trim()||null,uf:d.uf?.trim().toUpperCase()||null,cep:Nj(d.cep)||null,codigo_municipio_ibge:d.codigo_municipio_ibge?.trim()||null,nfce_serie:d.nfce_serie?Number(d.nfce_serie):null,nfce_numeracao:d.nfce_numeracao?Number(d.nfce_numeracao):null,nfce_itoken:d.nfce_itoken?.trim()||null,nfe_serie:d.nfe_serie?Number(d.nfe_serie):null,nfe_numeracao:d.nfe_numeracao?Number(d.nfe_numeracao):null,ambiente:d.ambiente||"homologacao",transmitenota_apikey:d.transmitenota_apikey?.trim()||null,transmitenota_base_url:d.transmitenota_base_url?.trim()||null,transmitenota_base_url_hml:d.transmitenota_base_url_hml?.trim()||null,transmitenota_apikey_hml:d.transmitenota_apikey_hml?.trim()||null,transmitenota_base_url_prod:d.transmitenota_base_url_prod?.trim()||null,transmitenota_apikey_prod:d.transmitenota_apikey_prod?.trim()||null};try{i(!0);const{error:y}=await he.from("empresas").update(g).eq("codigo_empresa",e.codigo_empresa).select("id").single();if(y)throw y;t({title:"Configuraes salvas",description:"Dados fiscais atualizados."})}catch(y){t({title:"Erro ao salvar",description:y.message,variant:"destructive"})}finally{i(!1)}}async function m(v){const g=Nj(l?.cnpj||"");if(g.length!==14){t({title:"CNPJ invlido",description:"Salve um CNPJ vlido (14 dgitos) nos dados da empresa.",variant:"destructive"});return}const y=v==="prod",x=y?d.transmitenota_base_url_prod||"":d.transmitenota_base_url_hml||"",b=y?d.transmitenota_apikey_prod||"":d.transmitenota_apikey_hml||"";if(!x||!b){t({title:"Configurao incompleta",description:"Preencha Base URL e ApiKey do ambiente selecionado.",variant:"destructive"});return}try{const w=await Cot({baseUrl:x,apiKey:b,cnpj:g});if(!w.reachable){t({title:"Sem conexo",description:w.error||`Endpoint inacessvel (${w.status||"sem status"})`,variant:"destructive"});return}if(w.authorized===!1){t({title:"Credenciais invlidas",description:`HTTP ${w.status}. Verifique ApiKey e CNPJ.`,variant:"destructive"});return}const j=w.status===200?"OK":w.status===400?"Conectado (dados mnimos ausentes, mas credenciais e URL vlidas)":`Conectado (HTTP ${w.status})`;t({title:`Conexo ${y?"PROD":"HML"}: sucesso`,description:j})}catch(w){t({title:"Falha no teste",description:w.message||"Erro inesperado",variant:"destructive"})}}return a.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-6",children:[a.jsx(t1,{children:a.jsx("title",{children:"Configurao Fiscal"})}),a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx(me,{type:"button",variant:"outline",size:"sm",onClick:()=>r(-1),children:"Voltar"}),a.jsxs("div",{className:"text-right",children:[a.jsx("h1",{className:"text-2xl font-semibold leading-tight",children:"Configurao Fiscal"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Dados que sero usados na emisso de NFC-e/NF-e."})]})]}),a.jsxs("form",{onSubmit:h,className:"grid gap-6 bg-surface border border-border rounded-lg p-4 shadow-sm",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Inscrio Estadual"}),a.jsx(Ye,{value:d.inscricao_estadual,onChange:f("inscricao_estadual")})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Regime Tributrio (CRT)"}),a.jsxs(Nn,{value:d.regime_tributario,onValueChange:f("regime_tributario"),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"1",children:"1 - Simples Nacional"}),a.jsx(tt,{value:"2",children:"2 - Simples Nacional (excesso sublimite)"}),a.jsx(tt,{value:"3",children:"3 - Regime Normal"})]})]})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Ambiente"}),a.jsxs(Nn,{value:d.ambiente,onValueChange:f("ambiente"),children:[a.jsx(bn,{children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"homologacao",children:"Homologao"}),a.jsx(tt,{value:"producao",children:"Produo"})]})]})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"sm:col-span-3",children:[a.jsx(Le,{children:"Logradouro"}),a.jsx(Ye,{value:d.logradouro,onChange:f("logradouro")})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Nmero"}),a.jsx(Ye,{value:d.numero,onChange:f("numero")})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx(Le,{children:"Complemento"}),a.jsx(Ye,{value:d.complemento,onChange:f("complemento")})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Bairro"}),a.jsx(Ye,{value:d.bairro,onChange:f("bairro")})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"CEP"}),a.jsx(Ye,{value:d.cep,onChange:v=>f("cep")({target:{value:Nj(v.target.value)}})})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx(Le,{children:"Cidade"}),a.jsx(Ye,{value:d.cidade,onChange:f("cidade")})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"UF"}),a.jsx(Ye,{value:d.uf,onChange:v=>f("uf")({target:{value:String(v.target.value||"").toUpperCase().slice(0,2)}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Cdigo IBGE Municpio (cMun)"}),a.jsx(Ye,{value:d.codigo_municipio_ibge,onChange:f("codigo_municipio_ibge")})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"NFC-e Srie"}),a.jsx(Ye,{value:d.nfce_serie,onChange:f("nfce_serie")})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"NFC-e Numerao Inicial"}),a.jsx(Ye,{value:d.nfce_numeracao,onChange:f("nfce_numeracao")})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"NFC-e IToken (CSC)"}),a.jsx(Ye,{value:d.nfce_itoken,onChange:f("nfce_itoken")})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"NF-e Srie (opcional)"}),a.jsx(Ye,{value:d.nfe_serie,onChange:f("nfe_serie")})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"NF-e Numerao (opcional)"}),a.jsx(Ye,{value:d.nfe_numeracao,onChange:f("nfe_numeracao")})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ApiKey Transmite Nota (opcional)"}),a.jsx(Ye,{value:d.transmitenota_apikey,onChange:f("transmitenota_apikey")})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"border border-border rounded-md p-3",children:[a.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Transmite Nota  Homologao"}),a.jsx(Le,{className:"text-xs",children:"Base URL (HML)"}),a.jsx(Ye,{value:d.transmitenota_base_url_hml,onChange:f("transmitenota_base_url_hml"),placeholder:"https://..."}),a.jsx("div",{className:"mt-3"}),a.jsx(Le,{className:"text-xs",children:"ApiKey (HML)"}),a.jsx(Ye,{value:d.transmitenota_apikey_hml,onChange:f("transmitenota_apikey_hml")}),a.jsx("div",{className:"mt-3",children:a.jsx(me,{type:"button",variant:"outline",size:"sm",onClick:()=>m("hml"),disabled:o||n,children:n?"Testando...":"Testar conexo HML"})})]}),a.jsxs("div",{className:"border border-border rounded-md p-3",children:[a.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Transmite Nota  Produo"}),a.jsx(Le,{className:"text-xs",children:"Base URL (PROD)"}),a.jsx(Ye,{value:d.transmitenota_base_url_prod,onChange:f("transmitenota_base_url_prod"),placeholder:"https://..."}),a.jsx("div",{className:"mt-3"}),a.jsx(Le,{className:"text-xs",children:"ApiKey (PROD)"}),a.jsx(Ye,{value:d.transmitenota_apikey_prod,onChange:f("transmitenota_apikey_prod")}),a.jsx("div",{className:"mt-3",children:a.jsx(me,{type:"button",variant:"outline",size:"sm",onClick:()=>m("prod"),disabled:o||n,children:n?"Testando...":"Testar conexo PROD"})})]})]}),a.jsx("div",{className:"flex gap-3 mt-4",children:a.jsx(me,{type:"submit",disabled:o||n,children:o?"Salvando...":"Salvar Configuraes"})})]})]})}function _b(e){return String(e||"").replace(/\D/g,"")}function dv(e){const t=Number(e??0);return Number.isFinite(t)?t.toFixed(2):"0.00"}function kit(e){return e==null?"":String(e)}function Iit(e){return e?.length,0}function Oit(e,t){if(!e?.length)return"90";const r=e[0];return t.find(s=>s.id===r.finalizadora_id)?.codigo_sefaz||"99"}function Tit(e,t){if(t){const r=_b(t.cpf||t.cnpj||t.cpf_cnpj||t.cpf_cnpj_limpo);return{nome:t.nome||t.nome_completo||t.razao_social||"",cpf_cnpj:r||void 0,ie:t.inscricao_estadual||void 0,email:t.email||void 0,telefone:_b(t.telefone)||void 0,endereco:{logradouro:t.logradouro||t.endereco||"",numero:kit(t.numero||""),complemento:t.complemento||"",bairro:t.bairro||"",municipio:t.municipio||t.cidade||"",uf:t.uf||"",cep:_b(t.cep),codigo_cidade:t.codigo_municipio||t.codigo_municipio_ibge||void 0,pais:t.pais||"Brasil"},indicador_ie_destinatario:t.indicador_ie_destinatario||9}}return null}async function xv({comandaId:e,codigoEmpresa:t}){if(!e)throw new Error("comandaId obrigatrio");if(!t)throw new Error("codigoEmpresa obrigatrio");const{data:r,error:n}=await he.from("empresas").select("*").eq("codigo_empresa",t).single();if(n)throw n;const{data:s,error:o}=await he.from("comandas").select("*").eq("codigo_empresa",t).eq("id",e).single();if(o)throw o;let i=null;if(s.cliente_id){const{data:_}=await he.from("clientes").select("*").eq("id",s.cliente_id).single();i=_||null}else{const{data:_}=await he.from("comanda_clientes").select("clientes:clientes!comanda_clientes_cliente_id_fkey(*)").eq("comanda_id",s.id).limit(1),C=Array.isArray(_)&&_.length?_[0]:null;C?.clientes&&(i=C.clientes)}const{data:l,error:c}=await he.from("comanda_itens").select("*").eq("comanda_id",s.id);if(c)throw c;const d=Array.from(new Set(l.map(_=>_.produto_id).filter(Boolean)));let u=new Map;if(d.length){const{data:_}=await he.from("produtos").select("*").in("id",d);(_||[]).forEach(C=>u.set(C.id,C))}const{data:f}=await he.from("pagamentos").select("*").eq("comanda_id",s.id),h=Array.from(new Set((f||[]).map(_=>_.finalizadora_id).filter(Boolean)));let m=[];if(h.length){const{data:_}=await he.from("finalizadoras").select("*").in("id",h);m=_||[]}const v=l.reduce((_,C)=>_+Number(C.quantidade||0)*Number(C.preco_unitario||0),0),g=l.reduce((_,C)=>_+Number(C.desconto||0),0),y=v-g,x=Tit(s,i),b={tipo_operacao:1,natureza_operacao:"Venda de mercadoria",forma_pagamento:Iit(f),meio_pagamento:Oit(f,m),data_emissao:new Date(s.fechado_em||s.updated_at||Date.now()).toLocaleDateString("pt-BR"),data_saida_entrada:new Date(s.fechado_em||Date.now()).toLocaleDateString("pt-BR"),hora_saida_entrada:new Date(s.fechado_em||Date.now()).toTimeString().slice(0,8),finalidade_emissao:1,valor_frete:"0",valor_seguro:"0",valor_ipi:"0",valor_total:dv(y),valor_total_sem_desconto:dv(v),...x?{nome_destinatario:x.nome,cnpj_destinatario:x.cpf_cnpj,inscricao_estadual_destinatario:x.ie,email_destinatario:x.email,telefone_destinatario:x.telefone,logradouro_destinatario:x.endereco.logradouro,numero_destinatario:x.endereco.numero,complemento_destinatario:x.endereco.complemento,bairro_destinatario:x.endereco.bairro,municipio_destinatario:x.endereco.municipio,codigo_cidade:x.endereco.codigo_cidade,uf_destinatario:x.endereco.uf,pais_destinatario:x.endereco.pais,cep_destinatario:x.endereco.cep,indicador_ie_destinatario:x.indicador_ie_destinatario}:{},Itens:l.map((_,C)=>{const P=u.get(_.produto_id)||{},E=Number(_.quantidade||0),A=Number(_.preco_unitario||0),F=Number(_.desconto||0),D=E*A-F,I=P.cfop_interno||P.cfop||5102,R=(P.ncm||"").replace(/\D/g,"").slice(0,8)||"",M=P.unidade||P.unit||"UN",U=P.csosn_interno||P.csosn||null;P.cst_icms_interno||P.cstIcmsInterno;const z=P.cst_pis_saida||P.cstPisSaida||"07",W=P.cst_cofins_saida||P.cstCofinsSaida||"07",$=P.icms_origem??0;return{numero_item:C+1,codigo_produto:P.code||P.codigo||P.id,descricao:P.name||P.descricao||_.descricao||"Item",cfop:Number(I),unidade_comercial:M,quantidade_comercial:E,valor_unitario_comercial:dv(A),codigo_ncm:R,valor_desconto:F?dv(F):"",valor_frete:"",valor_seguro:"",valor_outras_despesas:"",valor_total:dv(D),valor_total_sem_desconto:dv(E*A),icms_csosn:U?Number(U):void 0,icms_orig:Number($)||0,pis_situacao_tributaria:z,base_calculo_pis:"",aliquota_pis:"",valor_pis:"",cofins_situacao_tributaria:W,base_calculo_cofins:"",aliquota_cofins:"",valor_cofins:""}})},w=[];r?.inscricao_estadual||w.push("Inscrio Estadual (empresa)"),r?.regime_tributario||w.push("CRT/Regime Tributrio (empresa)"),(!r?.cidade||!r?.uf)&&w.push("Cidade/UF (empresa)"),r?.codigo_municipio_ibge||w.push("Cdigo IBGE do municpio (empresa)"),r?.nfce_serie||w.push("NFC-e Srie (empresa)"),!r?.nfce_itoken&&r?.ambiente==="producao"&&w.push("NFC-e IToken/CSC (produo)"),_b(r?.cnpj)||w.push("CNPJ da empresa"),l.forEach(_=>{const C=u.get(_.produto_id)||{};C.ncm||w.push(`Produto ${C.name||C.id}: NCM`),!C.cfop_interno&&!C.cfop&&w.push(`Produto ${C.name||C.id}: CFOP interno`)});const j={ApiKey:r?.transmitenota_apikey||"",Cnpj:_b(r?.cnpj),Dados:b};return{empresa:r,comanda:s,cliente:i,itens:l,pagamentos:f,finalizadoras:m,payload:j,missing:w}}async function Dit({comandaId:e,codigoEmpresa:t,modelo:r="65",overrides:n={}}){if(!e)throw new Error("ID da comanda  obrigatrio");if(!t)throw new Error("Cdigo da empresa  obrigatrio");const{data:s,error:o}=await he.from("vendas").select("*").eq("id",e).eq("codigo_empresa",t).single();if(o)throw new Error(`Erro ao buscar comanda: ${o.message}`);if(!s)throw new Error("Comanda no encontrada");const{data:i,error:l}=await he.from("itens_venda").select(`
      *,
      produtos!itens_venda_produto_id_fkey (
        id,
        nome,
        codigo,
        ncm,
        cest,
        cfopInterno,
        cfopExterno,
        cstIcmsInterno,
        cstIcmsExterno,
        csosnInterno,
        csosnExterno,
        aliqIcmsInterno,
        aliqIcmsExterno,
        cstPisEntrada,
        cstPisSaida,
        aliqPisPercent,
        aliqCofinsPercent,
        cstIpi,
        aliqIpiPercent
      )
    `).eq("comanda_id",e).eq("codigo_empresa",t);if(l)throw new Error(`Erro ao buscar itens: ${l.message}`);const{data:c,error:d}=await he.from("pagamentos").select(`
      *,
      finalizadoras!pagamentos_finalizadora_id_fkey (
        id,
        codigo_sefaz,
        nome
      )
    `).eq("comanda_id",e).eq("codigo_empresa",t).neq("status","Cancelado").neq("status","Estornado");if(d)throw new Error(`Erro ao buscar pagamentos: ${d.message}`);const{data:u,error:f}=await he.from("empresas").select("*").eq("codigo_empresa",t).single();if(f)throw new Error(`Erro ao buscar empresa: ${f.message}`);let h=null;if(s.cliente_id){const{data:m}=await he.from("clientes").select("*").eq("id",s.cliente_id).eq("codigo_empresa",t).single();h=m}return roe({comanda:s,itens:i||[],pagamentos:c||[],empresa:u,cliente:h,modelo:r,overrides:n})}async function Mit({codigoEmpresa:e,empresa:t,cliente:r,itens:n,pagamentos:s,modelo:o="55",overrides:i={}}){let l=t;if(!l){if(!e)throw new Error("codigoEmpresa obrigatrio quando empresa no for fornecida");const{data:f,error:h}=await he.from("empresas").select("*").eq("codigo_empresa",e).single();if(h)throw new Error(`Erro ao buscar empresa: ${h.message}`);l=f}const c={numero:i?.nNF||"1",desconto:0},d=Array.isArray(n)?n.map(f=>({preco_unitario:Number(f.preco_unitario)||0,quantidade:Number(f.quantidade)||1,preco_total:Number(f.preco_total!=null?f.preco_total:(Number(f.preco_unitario)||0)*(Number(f.quantidade)||1)),produtos:f.produtos||{id:f.produto_id||f.id,nome:f.nome||f.descricao||"Produto",codigo:f.codigo||String(f.produto_id||f.id||""),ncm:f.ncm||"",cest:f.cest||"",cfopInterno:f.cfop||f.cfopInterno,cstIcmsInterno:f.cstIcmsInterno,csosnInterno:f.csosnInterno,aliqIcmsInterno:f.aliqIcmsInterno,cstPisSaida:f.cstPisSaida,aliqPisPercent:f.aliqPisPercent,aliqCofinsPercent:f.aliqCofinsPercent}})):[],u=Array.isArray(s)&&s.length?s:[{finalizadoras:{codigo_sefaz:"99"},valor:d.reduce((f,h)=>f+(Number(h.preco_total)||0),0)}];return roe({comanda:c,itens:d,pagamentos:u,empresa:l,cliente:r,modelo:o,overrides:i})}function roe({comanda:e,itens:t,pagamentos:r,empresa:n,cliente:s,modelo:o="65",overrides:i={}}){const c=new Date().toISOString(),d=String(i.nNF||e.numero||"1"),u=o==="55"?"55":"65",f=u==="55"?"NF-e":"NFC-e",h=t.reduce((M,U)=>M+(Number(U.preco_total)||0),0),m=Number(e.desconto)||0,v=h-m,g=String(i.natOp||"VENDA"),y=String(i.serie||"1"),x=String(i.tpAmb||(n.ambiente==="producao"?"1":"2")),b=String(i.tpNF||"1"),w=String(i.indFinal||"1"),j=String(i.indPres||"1"),_=s&&s.uf&&n.uf&&s.uf!==n.uf?"2":"1",C=String(i.idDest||_),E=String({AC:"12",AL:"27",AM:"13",AP:"16",BA:"29",CE:"23",DF:"53",ES:"32",GO:"52",MA:"21",MG:"31",MS:"50",MT:"51",PA:"15",PB:"25",PE:"26",PI:"22",PR:"41",RJ:"33",RN:"24",RO:"11",RR:"14",RS:"43",SC:"42",SE:"28",SP:"35",TO:"17"}[(n.uf||"").toUpperCase()]||n.codigo_uf||"35"),A=String(n.codigo_municipio_ibge||n.codigo_municipio||""),F=s?`
    <dest>
      <${s.tipo_pessoa==="PJ"?"CNPJ":"CPF"}>${s.cpf_cnpj||""}</${s.tipo_pessoa==="PJ"?"CNPJ":"CPF"}>
      <xNome>${Ll(s.nome||s.razao_social||"")}</xNome>
      <enderDest>
        <xLgr>${Ll(s.logradouro||"")}</xLgr>
        <nro>${Ll(s.numero||"S/N")}</nro>
        <xBairro>${Ll(s.bairro||"")}</xBairro>
        <cMun>${s.codigo_municipio||s.codigo_municipio_ibge||""}</cMun>
        <xMun>${Ll(s.municipio||s.cidade||"")}</xMun>
        <UF>${s.uf||""}</UF>
        <CEP>${(s.cep||"").replace(/\D/g,"")}</CEP>
        <cPais>1058</cPais>
        <xPais>BRASIL</xPais>
      </enderDest>
      <indIEDest>9</indIEDest>
      ${s.email?`<email>${Ll(s.email)}</email>`:""}
    </dest>`:`
    <dest>
      <indIEDest>9</indIEDest>
    </dest>`,D=t.map((M,U)=>{const z=M.produtos||{},W=Number(M.preco_unitario)||0,$=Number(M.quantidade)||1,ee=Number(M.preco_total)||W*$;return`
    <det nItem="${U+1}">
      <prod>
        <cProd>${Ll(z.codigo||M.produto_id)}</cProd>
        <cEAN>SEM GTIN</cEAN>
        <xProd>${Ll(z.nome||"Produto")}</xProd>
        <NCM>${z.ncm||"00000000"}</NCM>
        ${z.cest?`<CEST>${z.cest}</CEST>`:""}
        <CFOP>${z.cfopInterno||"5102"}</CFOP>
        <uCom>UN</uCom>
        <qCom>${$.toFixed(4)}</qCom>
        <vUnCom>${W.toFixed(10)}</vUnCom>
        <vProd>${ee.toFixed(2)}</vProd>
        <cEANTrib>SEM GTIN</cEANTrib>
        <uTrib>UN</uTrib>
        <qTrib>${$.toFixed(4)}</qTrib>
        <vUnTrib>${W.toFixed(10)}</vUnTrib>
        <indTot>1</indTot>
      </prod>
      <imposto>
        <ICMS>
          ${z.csosnInterno?`
          <ICMSSN102>
            <orig>0</orig>
            <CSOSN>${z.csosnInterno}</CSOSN>
          </ICMSSN102>`:`
          <ICMS00>
            <orig>0</orig>
            <CST>${z.cstIcmsInterno||"00"}</CST>
            <modBC>3</modBC>
            <vBC>${ee.toFixed(2)}</vBC>
            <pICMS>${z.aliqIcmsInterno||"0.00"}</pICMS>
            <vICMS>${(ee*(Number(z.aliqIcmsInterno)||0)/100).toFixed(2)}</vICMS>
          </ICMS00>`}
        </ICMS>
        <PIS>
          <PISAliq>
            <CST>${z.cstPisSaida||"01"}</CST>
            <vBC>${ee.toFixed(2)}</vBC>
            <pPIS>${z.aliqPisPercent||"0.00"}</pPIS>
            <vPIS>${(ee*(Number(z.aliqPisPercent)||0)/100).toFixed(2)}</vPIS>
          </PISAliq>
        </PIS>
        <COFINS>
          <COFINSAliq>
            <CST>${z.cstPisSaida||"01"}</CST>
            <vBC>${ee.toFixed(2)}</vBC>
            <pCOFINS>${z.aliqCofinsPercent||"0.00"}</pCOFINS>
            <vCOFINS>${(ee*(Number(z.aliqCofinsPercent)||0)/100).toFixed(2)}</vCOFINS>
          </COFINSAliq>
        </COFINS>
      </imposto>
    </det>`}).join(""),I=r.map(M=>{const U=M.finalizadoras?.codigo_sefaz||"99",z=Number(M.valor)||0;return`
    <pag>
      <detPag>
        <tPag>${U}</tPag>
        <vPag>${z.toFixed(2)}</vPag>
      </detPag>
    </pag>`}).join("");return`<?xml version="1.0" encoding="UTF-8"?>
<nfeProc versao="4.00" xmlns="http://www.portalfiscal.inf.br/nfe">
  <NFe xmlns="http://www.portalfiscal.inf.br/nfe">
    <infNFe versao="4.00" Id="NFe${n.cnpj||""}${d.padStart(9,"0")}">
      <ide>
        <cUF>${E}</cUF>
        <cNF>${d.padStart(8,"0")}</cNF>
        <natOp>${g}</natOp>
        <mod>${u}</mod>
        <serie>${y}</serie>
        <nNF>${d}</nNF>
        <dhEmi>${c}</dhEmi>
        <tpNF>${b}</tpNF>
        <idDest>${C}</idDest>
        <cMunFG>${A}</cMunFG>
        <tpImp>4</tpImp>
        <tpEmis>1</tpEmis>
        <tpAmb>${x}</tpAmb>
        <finNFe>1</finNFe>
        <indFinal>${w}</indFinal>
        <indPres>${j}</indPres>
        <procEmi>0</procEmi>
        <verProc>1.0.0</verProc>
      </ide>
      <emit>
        <CNPJ>${n.cnpj||""}</CNPJ>
        <xNome>${Ll(n.razao_social||n.nome_fantasia||"")}</xNome>
        <xFant>${Ll(n.nome_fantasia||"")}</xFant>
        <enderEmit>
          <xLgr>${Ll(n.logradouro||"")}</xLgr>
          <nro>${Ll(n.numero||"S/N")}</nro>
          <xBairro>${Ll(n.bairro||"")}</xBairro>
          <cMun>${n.codigo_municipio_ibge||n.codigo_municipio||""}</cMun>
          <xMun>${Ll(n.municipio||n.cidade||"")}</xMun>
          <UF>${n.uf||""}</UF>
          <CEP>${(n.cep||"").replace(/\D/g,"")}</CEP>
          <cPais>1058</cPais>
          <xPais>BRASIL</xPais>
          <fone>${(n.telefone||"").replace(/\D/g,"")}</fone>
        </enderEmit>
        <IE>${n.inscricao_estadual||""}</IE>
        <CRT>${n.regime_tributario||"1"}</CRT>
      </emit>
      ${F}
      ${D}
      <total>
        <ICMSTot>
          <vBC>0.00</vBC>
          <vICMS>0.00</vICMS>
          <vICMSDeson>0.00</vICMSDeson>
          <vFCP>0.00</vFCP>
          <vBCST>0.00</vBCST>
          <vST>0.00</vST>
          <vFCPST>0.00</vFCPST>
          <vFCPSTRet>0.00</vFCPSTRet>
          <vProd>${h.toFixed(2)}</vProd>
          <vFrete>0.00</vFrete>
          <vSeg>0.00</vSeg>
          <vDesc>${m.toFixed(2)}</vDesc>
          <vII>0.00</vII>
          <vIPI>0.00</vIPI>
          <vIPIDevol>0.00</vIPIDevol>
          <vPIS>0.00</vPIS>
          <vCOFINS>0.00</vCOFINS>
          <vOutro>0.00</vOutro>
          <vNF>${v.toFixed(2)}</vNF>
        </ICMSTot>
      </total>
      <transp>
        <modFrete>9</modFrete>
      </transp>
      ${I}
      <infAdic>
        <infCpl>Comanda: ${e.id} | Modelo: ${f}</infCpl>
      </infAdic>
    </infNFe>
  </NFe>
</nfeProc>`}function Ll(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}const QU=[{code:"1102",desc:"Compra para industrializao, comercializao ou prestao de servios"},{code:"5101",desc:"Venda de produo do estabelecimento"},{code:"5102",desc:"Venda de mercadoria adquirida de terceiros"},{code:"5103",desc:"Venda de produo do estabelecimento, efetuada fora do estabelecimento"},{code:"5104",desc:"Venda de mercadoria adquirida de terceiros, efetuada fora do estabelecimento"},{code:"5405",desc:"Venda de mercadoria adquirida de terceiros, sujeita a ST"},{code:"5949",desc:"Outras sadas de mercadorias no especificadas"},{code:"5915",desc:"Remessa em bonificao, doao ou brinde"},{code:"5109",desc:"Venda de produo do estabelecimento, destinada a no contribuinte"},{code:"5110",desc:"Venda de mercadoria adquirida de terceiros, destinada a no contribuinte"},{code:"5401",desc:"Venda de produo do estabelecimento, sujeita a ST"},{code:"5403",desc:"Venda de mercadoria, de terceiros, sujeita a ST, efetuada pelo industrial substituto"},{code:"2102",desc:"Compra para industrializao, comercializao ou prestao de servios (fora do estado)"},{code:"6101",desc:"Venda de produo do estabelecimento (fora do estado)"},{code:"6102",desc:"Venda de mercadoria adquirida de terceiros (fora do estado)"},{code:"6403",desc:"Venda de produo do estabelecimento, sujeita a ST (fora do estado)"},{code:"6915",desc:"Remessa em bonificao, doao ou brinde (fora do estado)"}],DS=!1,Rit="",Lit="Estamos em manuteno no momento. Voltaremos em breve.";function Zc(e){return Number(e||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}function ZU(e){if(!e)return"";try{return new Date(e).toLocaleString("pt-BR")}catch{return""}}function uv({label:e,value:t,onChange:r}){const[n,s]=Se.useState(!1),o=Se.useRef(null),i=Se.useRef(null),[l,c]=Se.useState({top:0,left:0}),d=m=>{try{const[v,g,y]=String(m||"").split("-").map(Number);return v&&g&&y?new Date(v,g-1,y):null}catch{return null}},u=m=>{const v=g=>String(g).padStart(2,"0");return`${m.getFullYear()}-${v(m.getMonth()+1)}-${v(m.getDate())}`},f=Se.useCallback(()=>{if(!i.current)return;const m=i.current.getBoundingClientRect(),v=320,g=Math.min(Math.max(8,m.left),window.innerWidth-v-8),y=Math.min(m.bottom+6,window.innerHeight-8-300);c({top:y,left:g})},[]);Se.useEffect(()=>{const m=v=>{n&&o.current&&!o.current.contains(v.target)&&s(!1)};return window.addEventListener("mousedown",m),()=>window.removeEventListener("mousedown",m)},[n]),Se.useEffect(()=>{if(!n)return;f();const m=()=>f(),v=()=>f();return window.addEventListener("scroll",m,!0),window.addEventListener("resize",v),()=>{window.removeEventListener("scroll",m,!0),window.removeEventListener("resize",v)}},[n,f]);const h=d(t);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"relative",ref:o,children:a.jsx("button",{ref:i,type:"button",className:"h-7 px-2 rounded-md bg-surface border border-border text-xs",onClick:()=>s(m=>!m),children:t?new Date(t+"T00:00:00").toLocaleDateString("pt-BR"):e})}),n&&r4.createPortal(a.jsx("div",{className:"fixed z-[1000] p-2 bg-black text-white border border-warning/40 rounded-md shadow-xl",style:{top:l.top,left:l.left},children:a.jsx(ui,{mode:"single",selected:h||void 0,onSelect:m=>{m&&(r(u(m)),s(!1))},showOutsideDays:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}),document.body)]})}function Fit(){const{userProfile:e}=vs(),t=e?.codigo_empresa,{toast:r}=as(),n=Ri(),[s,o]=p.useState([]),[i,l]=p.useState(!1),[c,d]=p.useState(""),[u,f]=p.useState("all"),h=O=>String(O).padStart(2,"0"),m=new Date,v=m.getFullYear(),g=m.getMonth()+1,y=`${v}-${h(g)}-01`,x=`${v}-${h(g)}-${h(new Date(v,g,0).getDate())}`,[b,w]=p.useState(y),[j,_]=p.useState(x),[C,P]=p.useState(!1),[E,A]=p.useState(null),[F,D]=p.useState("nfce"),[I,R]=p.useState(!1),[M,U]=p.useState(!1);p.useEffect(()=>{try{const O=String({}.VITE_MAINTENANCE_MODE||"").toLowerCase()==="true",T=localStorage.getItem("maintenance:active")==="true",X=localStorage.getItem("maintenance:end"),H=X?new Date>new Date(X):!1,L=(!!DS||O||T)&&!H,Fe=(()=>{try{const nt=localStorage.getItem("maintenance:bypass")==="1",ft=sessionStorage.getItem("maintenance:bypass")==="1",Bt=document.cookie.split(";").some($e=>$e.trim()==="fx_maint_bypass=1");return nt||ft||Bt}catch{return!1}})();R(L),U(Fe)}catch{R(!!DS),U(!1)}},[]);const[z,W]=p.useState(!1),[$,ee]=p.useState(!1),[ve,_e]=p.useState(null),[K,q]=p.useState([]),[Y,J]=p.useState([]),[fe,Z]=p.useState(!1),[ce,le]=p.useState(!1),[ie,te]=p.useState(""),[ue,Te]=p.useState(null),[ne,de]=p.useState({natOp:"VENDA",serie:"1",nNF:"",indFinal:"1",indPres:"1",idDest:""}),[lt,Nt]=p.useState(!1),[at,gt]=p.useState(!1),[Pt,yt]=p.useState(""),[Qe,ge]=p.useState(!1),rt=new Date,pt=`${rt.getFullYear()}-${h(rt.getMonth()+1)}-${h(rt.getDate())}`,[We,Ze]=p.useState({natOp:"VENDA",serie:"1",nNF:"",indFinal:"1",indPres:"1",idDest:"",finNFe:"1",data_emissao:pt,data_saida:pt,tipo_nota:"saida",baixar_estoque:!0,destacar_st:!1,cfop_padrao:"5102",indIntermed:"0",intermediador_cnpj:"",intermediador_id:"",parte_tipo:"cliente",party_id:"",party_codigo:"",tipo_pessoa:"PJ",cpf_cnpj:"",nome:"",email:"",telefone:"",inscricao_estadual:"",ie_isento:!1,logradouro:"",numero:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:"",itens:[{descricao:"",codigo:"",cod_barras:"",ncm:"",cest:"",cfop:"5102",unidade:"UN",quantidade:"1",preco_unitario:"0.00",desconto_valor:"0.00",desconto_percent:"",acrescimos_valor:"0.00",frete_valor:"0.00",seguro_valor:"0.00",obs:"",dest_icms:!1,dest_icms_info:!1,benef_fiscal:!1,impostos:{origem:"",icms:{cst:"",csosn:"",base:"",aliquota:"",valor:"",desonerado_valor:"",desoneracao_motivo:"",operacao_valor:"",aliq_diferimento:"",valor_diferido:"",reducao_percent:"",reducao_motivo:"",ad_rem:"",ad_rem_retencao:"",monofasico_bc:"",monofasico_valor:"",mono_retencao_bc:"",mono_retencao_valor:"",mono_cobrado_ant_bc:"",mono_cobrado_ant_valor:"",proprio_devido_valor:""},icmsst:{base:"",aliquota:"",valor:""},fcp:{base:"",aliquota:"",valor:""},fcpst:{base:"",aliquota:"",valor:""},pis:{cst:"",aliquota:"",valor:""},cofins:{cst:"",aliquota:"",valor:""},ipi:{cst:"",aliquota:"",valor:"",tipo_calculo:"nenhum",valor_unit:""},combustivel:{uf:"",perc_origem_uf:"",indicador_importacao:""},cide:{base:"",aliq:"",valor:""},iss:{aliquota:"",valor:""}}}],totais:{desconto_geral:"0.00",frete:"0.00",outras_despesas:"0.00"},pagamentos:[{tipo:"Dinheiro",bandeira:"",cnpj_credenciadora:"",valor:"",parcelas:"",troco:""}],transporte:{tipo_frete:"",transportadora:"",placa:"",volumes:"",peso_liquido:"",peso_bruto:""},adicionais:{obs_gerais:"",info_fisco:"",info_cliente:"",referencia_doc:""}}),[Ne,ye]=p.useState("cliente"),[Be,mt]=p.useState(!1),[Ft,fr]=p.useState(""),[It,Ut]=p.useState([]),[xe,st]=p.useState(""),[Ct,ar]=p.useState(null),[pr,Xt]=p.useState(!1),[yr,lr]=p.useState(null),[Rr,Pn]=p.useState(!1);p.useState(!1);const[De,ke]=p.useState(""),[Ge,Re]=p.useState([]),[bt,Qt]=p.useState("cliente"),[ct,xt]=p.useState([]),[it,kt]=p.useState(null),[be,dt]=p.useState(""),[Lt,mr]=p.useState(!1);p.useState(!1),p.useState("");const[tr,Or]=p.useState(!0),Lr=O=>String(O||"").replace(/\D/g,""),sr=O=>{const T=String(O??"").replace(/\./g,"").replace(",","."),X=Number(T);return Number.isFinite(X)?X:0};p.useEffect(()=>{Ze(O=>({...O,baixar_estoque:O.tipo_nota!=="entrada"}))},[We.tipo_nota]),p.useEffect(()=>{Ze(O=>({...O,cfop_padrao:$t(O.uf)}))},[We.tipo_nota,Ft,We.uf]);const fn=p.useRef(We.cfop_padrao);p.useEffect(()=>{const O=fn.current,T=We.cfop_padrao||"";fn.current=T,!(!tr||!T)&&Ze(X=>{const H=X.itens||[];let L=!1;const Fe=H.map(nt=>{const ft=String(nt.cfop||"");return ft===""||O&&ft===O?(L=!0,{...nt,cfop:T}):nt});return L?{...X,itens:Fe}:X})},[We.cfop_padrao,tr]);const Tn=O=>T=>{const X=String(T?.target?.tagName||"").toLowerCase();["input","select","button","svg","path","textarea"].includes(X)||kt(it===O?null:O)},mn=O=>{const T=String(O||"").replace(/\D/g,"");if(!T)return"";const X=T.slice(0,Math.max(1,T.length-2)),H=T.slice(-2).padStart(2,"0");return`${Number(X).toLocaleString("pt-BR")},${H}`},zn=Array.isArray(QU)?QU:[];p.useEffect(()=>{let O=!1;async function T(){if(t)try{const{data:X}=await he.from("empresas").select("uf").eq("codigo_empresa",t).single();O||fr(X?.uf||"")}catch{}}return T(),()=>{O=!0}},[t]),p.useEffect(()=>{let O=!0;async function T(){if(!(!at||!t))try{const X=await hu({includeInactive:!1,codigoEmpresa:t});O&&Ut(X||[])}catch{O&&Ut([])}}return T(),()=>{O=!1}},[at,t]);const ot=p.useMemo(()=>{const O=(xe||"").trim().toLowerCase();return O?It.filter(T=>(T.name||"").toLowerCase().includes(O)||(T.code||"").toLowerCase().includes(O)).slice(0,100):It.slice(0,100)},[It,xe]),$t=(O,T=We.tipo_nota)=>{const X=String(Ft||"").toUpperCase(),H=String(O||"").toUpperCase(),Fe=!!X&&!!H?H===X:!0;return T!=="entrada"?Fe?"5102":"6102":Fe?"1102":"2102"},Yt=O=>{const X=(zn.find(H=>H.code===O)?.desc||"").toLowerCase();return We.tipo_nota==="entrada"&&(X.includes("compra")||X.includes("entrada"))?"COMPRA":X.includes("venda")?"VENDA":X.includes("devolu")?"DEVOLUCAO":X.includes("transfer")?"TRANSFERENCIA":X.includes("bonifica")?"BONIFICACAO":X.includes("remessa")?"REMESSA":X.includes("demonstra")?"DEMONSTRACAO":We.natOp||"VENDA"},Ht=(O,T)=>{Ze(X=>{const H=[...X.itens],L=T?.cfopInterno||T?.cfopExterno||$t(X.uf),Fe=Number(T?.price??T?.salePrice??0)||0,nt=String(X.uf||"").toUpperCase()===String(Ft||"").toUpperCase(),ft=nt?T?.cstIcmsInterno||"":T?.cstIcmsExterno||"",Bt=nt?T?.csosnInterno||"":T?.csosnExterno||"",$e=nt?T?.aliqIcmsInterno??null:T?.aliqIcmsExterno??null,Dt=T?.cstPisSaida||((T?.aliqPisPercent??null)!=null?"01":""),Sr=T?.aliqPisPercent??null,Pr=(T?.aliqCofinsPercent??null)!=null?"01":"",vr=T?.aliqCofinsPercent??null,yn=T?.cstIpi||"",On=T?.aliqIpiPercent??null;H[O]={...H[O],descricao:T?.name||H[O].descricao,codigo:T?.code||H[O].codigo,cod_barras:T?.barcode||T?.ean||T?.gtin||T?.bar_code||H[O].cod_barras,unidade:(T?.unit||"UN").toString().toUpperCase(),ncm:T?.ncm||H[O].ncm,cest:T?.cest||H[O].cest,cfop:L||H[O].cfop,preco_unitario:Fe?Fe.toFixed(2):H[O].preco_unitario,impostos:{...H[O].impostos||{},icms:{...H[O].impostos?.icms||{},cst:ft||H[O].impostos?.icms?.cst||"",csosn:Bt||H[O].impostos?.icms?.csosn||"",aliquota:$e!=null?String($e):H[O].impostos?.icms?.aliquota||""},pis:{...H[O].impostos?.pis||{},cst:Dt||H[O].impostos?.pis?.cst||"",aliquota:Sr!=null?String(Sr):H[O].impostos?.pis?.aliquota||""},cofins:{...H[O].impostos?.cofins||{},cst:Pr||H[O].impostos?.cofins?.cst||"",aliquota:vr!=null?String(vr):H[O].impostos?.cofins?.aliquota||""},ipi:{...H[O].impostos?.ipi||{},cst:yn||H[O].impostos?.ipi?.cst||"",aliquota:On!=null?String(On):H[O].impostos?.ipi?.aliquota||""}}};const Xn=Yt(L||H[O].cfop);return{...X,itens:H,natOp:Xn}}),ar(null)};p.useEffect(()=>{let O=!0;async function T(){if(Rr)try{if(bt==="fornecedor"){const X=await ist(t);O&&Re(X||[])}else{const X=await db({searchTerm:De,limit:50,codigoEmpresa:t});O&&Re(X||[])}}catch{O&&Re([])}}return T(),()=>{O=!1}},[Rr,De,bt,t]);const Ot=p.useMemo(()=>{const O=(De||"").trim().toLowerCase();return O?(Ge||[]).filter(T=>{const X=String(T.codigo||T.codigo_cliente||T.codigo_fornecedor||T.code||"").toLowerCase(),H=String(T.nome||T.razao_social||T.apelido||"").toLowerCase(),L=String(T.cnpj||T.cpf||"").toLowerCase();return X.includes(O)||H.includes(O)||L.includes(O)}):Ge||[]},[Ge,De]),Xr=async O=>{const T=String(O||"").replace(/\D/g,"");if(!(!T||!t))try{let X=he.from("clientes").select("*").eq("codigo_empresa",t).eq("codigo",Number(T)).limit(1);We.tipo_nota==="entrada"&&(X=X.eq("is_fornecedor",!0));const{data:H}=await X.single();H&&Je(H)}catch{}},Je=O=>{if(!O)return;const T=(O.tipo_pessoa||"PJ")==="PJ"||!!O.cnpj;Ze(X=>({...X,parte_tipo:bt,party_id:O.id||"",party_codigo:String(O.codigo||O.codigo_cliente||O.codigo_fornecedor||O.code||""),tipo_pessoa:T?"PJ":"PF",cpf_cnpj:(O.cnpj||O.cpf||"").toString(),nome:O.nome||O.razao_social||O.apelido||"",email:O.email||"",telefone:O.telefone||"",logradouro:O.endereco||O.logradouro||"",numero:O.numero||"",bairro:O.bairro||"",cidade:O.cidade||"",uf:O.uf||"",cep:O.cep||"",codigo_municipio_ibge:O.cidade_ibge||O.codigo_municipio_ibge||"",inscricao_estadual:O.ie||O.inscricao_estadual||"",ie_isento:O.ie==="ISENTO"||!1})),Pn(!1)};p.useEffect(()=>{let O=!0;async function T(){if(!(!at||Ne!=="pagamento"))try{const X=await Hm({somenteAtivas:!0,codigoEmpresa:t});O&&xt(Array.isArray(X)?X:[])}catch{O&&xt([])}}return T(),()=>{O=!1}},[at,Ne,t]);const cr=O=>/.+@.+\..+/.test(String(O||"")),vt=async O=>{const T=Lr(O);if(T.length===8)try{mt(!0);let X=null;try{const H=await fetch(`https://brasilapi.com.br/api/cep/v2/${T}`);H.ok&&(X=await H.json())}catch{}if(!X)try{const H=await fetch(`https://viacep.com.br/ws/${T}/json/`);H.ok&&(X=await H.json())}catch{}if(X){const H=X.street||X.logradouro||"",L=X.neighborhood||X.bairro||"",Fe=X.city||X.localidade||"",nt=(X.state||X.uf||"").toString().toUpperCase().slice(0,2),ft=X.city_ibge_code||X.ibge||"";Ze(Bt=>({...Bt,logradouro:H||Bt.logradouro,bairro:L||Bt.bairro,cidade:Fe||Bt.cidade,uf:nt||Bt.uf,codigo_municipio_ibge:ft||Bt.codigo_municipio_ibge}))}}finally{mt(!1)}},Tt=()=>{try{const O=localStorage.getItem("auth:userProfile");return O&&JSON.parse(O)?.codigo_empresa||null}catch{return null}},Dr=()=>{let O=null,T=null;if(b&&(O=new Date(b+"T00:00:00").toISOString()),j){const X=new Date(j+"T00:00:00");X.setDate(X.getDate()+1),T=X.toISOString()}return{fromISO:O,toISOExclusive:T}},an=async()=>{if(t){l(!0);try{let O=he.from("comandas").select("*").eq("codigo_empresa",t).not("fechado_em","is",null).neq("status","cancelled").order("aberto_em",{ascending:!1}).limit(300);const{fromISO:T,toISOExclusive:X}=Dr();T&&(O=O.gte("aberto_em",T)),X&&(O=O.lt("aberto_em",X));const{data:H,error:L}=await O;if(L)throw L;const Fe=H||[],nt=Fe.map(vr=>vr.id);let ft={};if(nt.length)try{ft=await dS(nt,t)}catch{ft={}}let Bt=[];try{Bt=await Gm(t)}catch{Bt=[]}const $e=new Map((Bt||[]).map(vr=>[vr.id,vr.numero]));let Dt={},Sr={};try{Dt=await jT(nt)}catch{Dt={}}try{Sr=await _T(nt)}catch{Sr={}}const Pr=Fe.map(vr=>({...vr,total:Number(ft[vr.id]||0),mesaNumero:$e.get(vr.mesa_id),clientesStr:Array.isArray(Dt[vr.id])?Dt[vr.id].join(", "):Dt[vr.id]||"",finalizadorasStr:Array.isArray(Sr[vr.id])?Sr[vr.id].join(", "):Sr[vr.id]||""}));o(Pr)}catch(O){r({title:"Erro ao carregar",description:O.message,variant:"destructive"})}finally{l(!1)}}};p.useEffect(()=>{an()},[t,b,j]),p.useEffect(()=>{let O=!1;async function T(){if(t)try{const{data:X}=await he.from("empresas").select("cnpj, inscricao_estadual, regime_tributario, cidade, uf, codigo_municipio_ibge, nfce_serie, nfce_itoken, ambiente, transmitenota_apikey, transmitenota_base_url, transmitenota_apikey_hml, transmitenota_base_url_hml, transmitenota_apikey_prod, transmitenota_base_url_prod").eq("codigo_empresa",t).single();if(O)return;const H=[],L=$e=>String($e||"").replace(/\D/g,"");(!L(X?.cnpj)||L(X?.cnpj).length!==14)&&H.push("CNPJ"),X?.inscricao_estadual||H.push("Inscrio Estadual"),X?.regime_tributario||H.push("CRT"),(!X?.cidade||!X?.uf)&&H.push("Cidade/UF"),X?.codigo_municipio_ibge||H.push("cMun IBGE"),X?.nfce_serie||H.push("Srie NFC-e");const Fe=String(X?.ambiente||"homologacao");Fe==="producao"&&!X?.nfce_itoken&&H.push("CSC/IToken");const nt=Fe==="producao",ft=nt?!!X?.transmitenota_apikey_prod||!!X?.transmitenota_apikey:!!X?.transmitenota_apikey_hml||!!X?.transmitenota_apikey,Bt=nt?!!X?.transmitenota_base_url_prod||!!X?.transmitenota_base_url:!!X?.transmitenota_base_url_hml||!!X?.transmitenota_base_url;ft||H.push(nt?"ApiKey (PROD)":"ApiKey (HML)"),Bt||H.push(nt?"Base URL (PROD)":"Base URL (HML)"),J(H)}catch{}}return T(),()=>{O=!0}},[t]),p.useEffect(()=>{if(!t)return;const O=setInterval(()=>{an()},2e4);return()=>clearInterval(O)},[t,b,j]);const Nr=p.useMemo(()=>{const O=(c||"").trim().toLowerCase(),T=X=>{const H=X.nf_status||"pendente";return C?H==="pendente"||H==="rejeitada":u==="all"?!0:H===u};return(s||[]).filter(X=>T(X)).filter(X=>O?(X.xml_chave||"").toLowerCase().includes(O)||String(X.nf_numero||"").includes(O):!0)},[s,c,u,C]),St=O=>{const T=(O||"pendente").toLowerCase(),X={pendente:"bg-amber-500/15 text-amber-400 border border-amber-400/30",processando:"bg-blue-500/15 text-blue-400 border border-blue-400/30",autorizada:"bg-emerald-500/15 text-emerald-400 border border-emerald-400/30",rejeitada:"bg-red-500/15 text-red-400 border border-red-400/30",cancelada:"bg-gray-500/15 text-gray-400 border border-gray-400/30"};return X[T]||X.pendente},Fr=async O=>{try{ee(!0);const T=t||Tt(),{payload:X,missing:H}=await xv({comandaId:O,codigoEmpresa:T});_e(X),q(H||[]),W(!0)}catch(T){r({title:"Falha ao gerar prvia",description:T.message,variant:"destructive"})}finally{ee(!1)}},zr=async(O,T)=>{await he.from("comandas").update(T).eq("id",O).eq("codigo_empresa",t)},ha=async O=>{Te(O);try{const{data:T}=await he.from("empresas").select("nfe_serie, ambiente, uf").eq("codigo_empresa",t).single();de(X=>({...X,serie:String(T?.nfe_serie||"1")}))}catch{}te(""),Z(!0)},En=async()=>{if(ue)try{le(!0);const O=await Dit({comandaId:ue,codigoEmpresa:t,modelo:"55",overrides:ne});te(O),r({title:"XML NF-e gerado"})}catch(O){r({title:"Falha ao gerar XML",description:O.message,variant:"destructive"})}finally{le(!1)}},ae=async()=>{if(!(!ie||!ue))try{Nt(!0);const O=`nfe/${t}/${ue}-${Date.now()}.xml`,T=new Blob([ie],{type:"text/xml;charset=utf-8"}),{error:X}=await he.storage.from("fiscal").upload(O,T,{contentType:"text/xml"});if(X)throw X;const{data:H}=await he.storage.from("fiscal").getPublicUrl(O),L=H?.publicUrl||null;await he.from("comandas").update({nf_xml_url:L||O,nf_status:"pendente"}).eq("id",ue).eq("codigo_empresa",t);try{const Fe=s.find(ft=>ft.id===ue),nt=Number(Fe?.total||0);await he.from("notas_fiscais").insert({codigo_empresa:t,origem:"comanda",comanda_id:ue,modelo:"55",numero:ne.nNF?Number(ne.nNF):null,serie:ne.serie?Number(ne.serie):null,status:"pendente",xml_url:L||O,pdf_url:null,valor_total:isFinite(nt)?nt:null,destinatario:null})}catch{}r({title:"XML salvo",description:L?"Link pblico gerado.":"Arquivo salvo no Storage."}),await an()}catch(O){r({title:"Falha ao salvar XML",description:O.message,variant:"destructive"})}finally{Nt(!1)}},Me=async O=>{try{l(!0);const{empresa:T,payload:X,missing:H}=await xv({comandaId:O,codigoEmpresa:t});if(H&&H.length){r({title:"Pendncias para emisso",description:H.join(", "),variant:"destructive"});return}const L=_j(T);if(!L.cnpj||L.cnpj.length!==14){r({title:"CNPJ invlido",description:"CNPJ da empresa est ausente ou invlido (14 dgitos).",variant:"destructive"});return}if(!L.apiKey||!L.baseUrl){r({title:"Configurao fiscal incompleta",description:"Preencha Base URL e ApiKey do ambiente atual nas Configuraes.",variant:"destructive"});return}await zr(O,{nf_status:"processando"});let Fe;try{Fe=await Aot({baseUrl:L.baseUrl,apiKey:L.apiKey,cnpj:L.cnpj,dados:X.Dados})}catch(vr){throw await zr(O,{nf_status:"rejeitada"}),vr}const nt=Fe?.chave||Fe?.Chave||Fe?.chaveAcesso||null,ft=Fe?.numero||Fe?.Numero||null,Bt=Fe?.serie||Fe?.Serie||null,$e=Fe?.pdf_url||Fe?.PdfUrl||null,Dt=Fe?.xml_url||Fe?.XmlUrl||null,Sr=Fe?.protocolo||Fe?.Protocolo||null,Pr=!!(Fe?.autorizada||Fe?.Autorizada||Fe?.sucesso||Fe?.Sucesso||nt);await zr(O,{nf_status:Pr?"autorizada":"processando",xml_chave:nt,nf_numero:ft,nf_serie:Bt,nf_pdf_url:$e,nf_xml_url:Dt,xml_protocolo:Sr}),r({title:Pr?"NFC-e autorizada":"Emisso enviada",description:Pr?"Documento autorizado.":"Aguardando autorizao."}),await an()}catch(T){r({title:"Falha ao emitir",description:T.message,variant:"destructive"})}finally{l(!1)}},et=async O=>{try{l(!0);const T=s.find(Pr=>Pr.id===O);if(!T)return;const{empresa:X}=await xv({comandaId:O,codigoEmpresa:t}),H=_j(X),L=T.xml_chave?{chave:T.xml_chave}:{numero:T.nf_numero,serie:T.nf_serie},Fe=await VU({baseUrl:H.baseUrl,apiKey:H.apiKey,cnpj:H.cnpj,dados:L}),nt=Fe?.status||Fe?.Status||(Fe?.autorizada?"autorizada":T.nf_status),ft=Fe?.pdf_url||Fe?.PdfUrl||T.nf_pdf_url,Bt=Fe?.xml_url||Fe?.XmlUrl||T.nf_xml_url,$e=Fe?.chave||Fe?.Chave||T.xml_chave,Dt=Fe?.numero||Fe?.Numero||T.nf_numero,Sr=Fe?.serie||Fe?.Serie||T.nf_serie;await zr(O,{nf_status:nt,nf_pdf_url:ft,nf_xml_url:Bt,xml_chave:$e,nf_numero:Dt,nf_serie:Sr}),r({title:"Consulta concluda"}),await an()}catch(T){r({title:"Falha ao consultar",description:T.message,variant:"destructive"})}finally{l(!1)}},re=async O=>{try{const T=window.prompt("Informe o motivo do cancelamento:");if(!T)return;l(!0);const{empresa:X}=await xv({comandaId:O,codigoEmpresa:t}),H=_j(X),L=s.find(nt=>nt.id===O),Fe=L.xml_chave?{chave:L.xml_chave,motivo:T}:{numero:L.nf_numero,serie:L.nf_serie,motivo:T};await Pot({baseUrl:H.baseUrl,apiKey:H.apiKey,cnpj:H.cnpj,dados:Fe}),await zr(O,{nf_status:"cancelada"}),r({title:"NFC-e cancelada"}),await an()}catch(T){r({title:"Falha ao cancelar",description:T.message,variant:"destructive"})}finally{l(!1)}};return a.jsxs("div",{className:"relative p-4",children:[a.jsx(t1,{children:a.jsx("title",{children:"Central Fiscal"})}),a.jsxs("div",{className:"absolute inset-0 z-[10] flex justify-center items-start pt-10 pb-8 pointer-events-auto",children:[a.jsx("div",{className:"absolute inset-0 bg-black/85 backdrop-blur-md"}),a.jsxs("div",{className:"relative max-w-xl w-[min(92vw,640px)] rounded-2xl border border-warning/50 bg-gradient-to-br from-surface via-surface-2 to-surface shadow-2xl px-6 py-7 text-center flex flex-col items-center gap-4",children:[a.jsxs("div",{className:"inline-flex items-center gap-3 px-3 py-1 rounded-full bg-warning/10 border border-warning/40 text-warning text-xs font-semibold uppercase tracking-wide",children:[a.jsx("span",{className:"w-5 h-5 rounded-full bg-warning text-black flex items-center justify-center text-[11px] font-black",children:"NF"}),a.jsx("span",{children:"Central Fiscal em desenvolvimento"})]}),a.jsx("div",{className:"flex items-center justify-center w-14 h-14 rounded-2xl bg-warning/15 border border-warning/50 text-warning shadow-lg",children:a.jsx(Go,{className:"w-7 h-7"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Em breve: painel fiscal completo diretamente no F7 Arena"}),a.jsx("p",{className:"text-sm text-text-secondary leading-relaxed",children:"Estamos construindo a nova Central Fiscal para acompanhar emisses de NFC-e e NF-e, revisar pendncias e acessar detalhes das notas em um s lugar."})]}),a.jsxs("div",{className:"w-full text-left text-xs md:text-sm text-text-secondary bg-surface/70 border border-white/5 rounded-xl p-4 space-y-2",children:[a.jsx("p",{className:"font-semibold text-text-primary mb-1",children:"Enquanto isso, voc pode:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:["Ajustar as configuraes fiscais da empresa na aba ",a.jsx("strong",{children:"Configurao Fiscal"}),";"]}),a.jsx("li",{children:"Validar CNPJ, inscrio estadual e parmetros da NFC-e/NF-e;"}),a.jsx("li",{children:"Integrar ou revisar os dados da API de emisso fiscal."})]})]}),a.jsx("p",{className:"text-[11px] text-text-muted",children:"Esta aba est em modo de desenvolvimento e ainda no deve ser utilizada em produo."})]})]}),a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Central Fiscal"}),a.jsx(me,{type:"button",variant:"outline",size:"sm",className:"rounded-full",onClick:()=>n("/configuracao-fiscal"),title:"Configurao Fiscal",children:a.jsx(bd,{className:"w-4 h-4"})})]}),Y.length>0&&a.jsx("div",{className:"mb-4 p-3 rounded-md border border-warning/40 bg-warning/10 text-warning",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-sm",children:"Pendncias fiscais da empresa"}),a.jsxs("p",{className:"text-xs",children:["Preencha: ",Y.join(", "),"."]})]}),a.jsx(me,{size:"sm",className:"bg-warning text-black hover:bg-warning/90",onClick:()=>n("/configuracao-fiscal"),children:"Corrigir agora"})]})}),a.jsxs(Cc,{value:F,onValueChange:D,className:"w-full",children:[a.jsxs(Gl,{className:"mb-3",children:[a.jsx(da,{value:"nfce",children:"NFC-e"}),a.jsx(da,{value:"nfe",children:"NF-e"})]}),a.jsxs(ds,{value:"nfce",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Le,{className:"text-sm",children:"Buscar"}),a.jsx(Ye,{value:c,onChange:O=>d(O.target.value),placeholder:"Chave, nmero...",className:"w-60"})]}),a.jsx(Le,{className:"text-sm ml-1",children:"Status"}),a.jsxs(Nn,{value:u,onValueChange:f,children:[a.jsx(bn,{className:"w-[170px] rounded-full",children:a.jsx(Cn,{placeholder:"Selecionar status"})}),a.jsxs(wn,{className:"rounded-xl",children:[a.jsx(tt,{value:"all",children:"Todos"}),a.jsx(tt,{value:"pendente",children:"Pendente"}),a.jsx(tt,{value:"processando",children:"Em andamento"}),a.jsx(tt,{value:"autorizada",children:"Autorizada"}),a.jsx(tt,{value:"rejeitada",children:"Rejeitada"}),a.jsx(tt,{value:"cancelada",children:"Cancelada"})]})]}),a.jsx(Le,{className:"text-sm ml-2",children:"Perodo"}),a.jsxs("div",{className:"inline-flex items-center gap-2",children:[a.jsx(uv,{label:"Perodo inicial",value:b,onChange:w}),a.jsx("span",{className:"text-text-secondary",children:"at"}),a.jsx(uv,{label:"Perodo final",value:j,onChange:_})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 ml-2 text-sm",children:[a.jsx(Ha,{checked:C,onCheckedChange:P,className:"rounded-full border-warning data-[state=checked]:bg-warning"}),a.jsx("span",{children:"Somente pendentes/rejeitadas"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(me,{size:"sm",variant:"outline",disabled:!E,onClick:()=>(async()=>{const O=s.find(T=>T.id===E);if(O){if(O.nf_pdf_url){window.open(O.nf_pdf_url,"_blank");return}try{l(!0);const{empresa:T}=await xv({comandaId:O.id,codigoEmpresa:t}),X=_j(T),H=O.xml_chave?{chave:O.xml_chave}:{numero:O.nf_numero,serie:O.nf_serie},L=await VU({baseUrl:X.baseUrl,apiKey:X.apiKey,cnpj:X.cnpj,dados:H}),Fe=L?.pdf_url||L?.PdfUrl;Fe?(await he.from("comandas").update({nf_pdf_url:Fe}).eq("id",O.id).eq("codigo_empresa",t),window.open(Fe,"_blank")):r({title:"Sem PDF disponvel",description:"Documento ainda no possui DANFE.",variant:"destructive"}),await an()}catch(T){r({title:"Falha ao visualizar",description:T.message,variant:"destructive"})}finally{l(!1)}}})(),children:"Visualizar"}),a.jsx(me,{size:"sm",disabled:!E||!["pendente","rejeitada"].includes(s.find(O=>O.id===E)?.nf_status||"pendente"),onClick:()=>Me(E),children:"Emitir"}),a.jsx(me,{size:"sm",variant:"outline",disabled:!E||s.find(O=>O.id===E)?.nf_status!=="processando",onClick:()=>et(E),children:"Consultar"}),a.jsx(me,{size:"sm",variant:"destructive",disabled:!E||s.find(O=>O.id===E)?.nf_status!=="autorizada",onClick:()=>re(E),children:"Cancelar"})]}),a.jsx("div",{className:"bg-surface rounded border border-border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Abertura"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Status"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Chave"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Total"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Aes"})]})}),a.jsxs("tbody",{children:[(!Nr||Nr.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-text-muted",children:i?"Carregando...":"Nada por aqui"})}),Nr.map(O=>{const T=O.nf_status||"pendente";return a.jsxs("tr",{className:`border-t border-border/60 transition-colors ${E===O.id?"bg-surface-2 ring-2 ring-[#FF7A1A]/60 rounded-md":"hover:bg-surface-2/50"}`,onClick:()=>A(O.id),children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:ZU(O.aberto_em)}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${St(T)}`,children:T})}),a.jsx("td",{className:"px-3 py-2 break-all max-w-[380px]",children:O.xml_chave||""}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap",children:["R$ ",Zc(O.total||O.total_com_desconto)]}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap flex gap-2 justify-end",children:[(T==="pendente"||T==="rejeitada")&&a.jsxs(a.Fragment,{children:[a.jsx(me,{size:"sm",variant:"outline",onClick:()=>Fr(O.id),children:"Pr-Emisso"}),a.jsx(me,{size:"sm",onClick:()=>Me(O.id),children:"Emitir"})]}),T==="processando"&&a.jsx(me,{size:"sm",variant:"outline",onClick:()=>et(O.id),children:"Consultar"}),T==="autorizada"&&a.jsx(me,{size:"sm",variant:"destructive",onClick:()=>re(O.id),children:"Cancelar"}),O.nf_pdf_url&&a.jsx("a",{className:"inline-flex",href:O.nf_pdf_url,target:"_blank",rel:"noreferrer",children:a.jsx(me,{size:"sm",variant:"outline",children:"DANFE"})}),O.nf_xml_url&&a.jsx("a",{className:"inline-flex",href:O.nf_xml_url,target:"_blank",rel:"noreferrer",children:a.jsx(me,{size:"sm",variant:"outline",children:"XML"})})]})]},O.id)})]})]})})]}),a.jsxs(ds,{value:"nfe",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Le,{className:"text-sm",children:"Buscar"}),a.jsx(Ye,{value:c,onChange:O=>d(O.target.value),placeholder:"Chave, nmero...",className:"w-60"})]}),a.jsx(Le,{className:"text-sm ml-1",children:"Status"}),a.jsxs(Nn,{value:u,onValueChange:f,children:[a.jsx(bn,{className:"w-[170px] rounded-full",children:a.jsx(Cn,{placeholder:"Selecionar status"})}),a.jsxs(wn,{className:"rounded-xl",children:[a.jsx(tt,{value:"all",children:"Todos"}),a.jsx(tt,{value:"pendente",children:"Pendente"}),a.jsx(tt,{value:"processando",children:"Em andamento"}),a.jsx(tt,{value:"autorizada",children:"Autorizada"}),a.jsx(tt,{value:"rejeitada",children:"Rejeitada"}),a.jsx(tt,{value:"cancelada",children:"Cancelada"})]})]}),a.jsx(Le,{className:"text-sm ml-2",children:"Perodo"}),a.jsxs("div",{className:"inline-flex items-center gap-2",children:[a.jsx(uv,{label:"Perodo inicial",value:b,onChange:w}),a.jsx("span",{className:"text-text-secondary",children:"at"}),a.jsx(uv,{label:"Perodo final",value:j,onChange:_})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 ml-2 text-sm",children:[a.jsx(Ha,{checked:C,onCheckedChange:P,className:"rounded-full border-warning data-[state=checked]:bg-warning"}),a.jsx("span",{children:"Somente pendentes/rejeitadas"})]}),a.jsx("div",{className:"ml-auto",children:a.jsx(me,{size:"sm",onClick:()=>{yt(""),gt(!0)},children:"Nova NF-e"})})]}),a.jsx("div",{className:"bg-surface rounded border border-border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Abertura"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Status"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Chave"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Total"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Aes"})]})}),a.jsxs("tbody",{children:[(!Nr||Nr.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-text-muted",children:i?"Carregando...":"Nada por aqui"})}),Nr.map(O=>{const T=O.nf_status||"pendente";return a.jsxs("tr",{className:`border-t border-border/60 transition-colors ${E===O.id?"bg-surface-2 ring-2 ring-[#FF7A1A]/60 rounded-md":"hover:bg-surface-2/50"}`,onClick:()=>A(O.id),children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:ZU(O.aberto_em)}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${St(T)}`,children:T})}),a.jsx("td",{className:"px-3 py-2 break-all max-w-[380px]",children:O.xml_chave||""}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap",children:["R$ ",Zc(O.total||O.total_com_desconto)]}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap flex gap-2 justify-end",children:[a.jsx(me,{size:"sm",onClick:()=>ha(O.id),children:"Gerar XML NF-e"}),a.jsx(me,{size:"sm",variant:"outline",disabled:!0,children:"Emitir via API (em breve)"}),O.nf_xml_url&&a.jsx("a",{className:"inline-flex",href:O.nf_xml_url,target:"_blank",rel:"noreferrer",children:a.jsx(me,{size:"sm",variant:"outline",children:"XML"})})]})]},O.id)})]})]})})]})]}),a.jsx(xn,{open:z,onOpenChange:W,children:a.jsxs(vn,{className:"max-w-[800px]",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Pr-Emisso NFC-e"}),a.jsx(Dn,{children:"Revise os dados e pendncias antes de emitir."})]}),$?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Gerando prvia"}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"JSON (EnviarNfce)"}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto",children:ve?JSON.stringify(ve,null,2):""})]}),a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Pendncias"}),!K||K.length===0?a.jsx("div",{className:"text-sm text-emerald-500",children:"Nenhuma pendncia encontrada."}):a.jsx("ul",{className:"list-disc pl-5 text-sm",children:K.map((O,T)=>a.jsx("li",{children:O},T))})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(me,{variant:"outline",onClick:()=>W(!1),children:"Fechar"}),a.jsx(me,{disabled:!0,children:"Emitir (desabilitado)"})]})]})}),a.jsx(xn,{open:Rr,onOpenChange:Pn,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsxs(un,{children:["Selecionar ",bt==="fornecedor"?"fornecedor":"cliente"]}),a.jsx(Dn,{children:"Busque pelo cdigo, nome ou documento e escolha a parte."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(me,{size:"sm",variant:bt==="cliente"?"default":"outline",onClick:()=>Qt("cliente"),children:"Clientes"}),a.jsx(me,{size:"sm",variant:bt==="fornecedor"?"default":"outline",onClick:()=>Qt("fornecedor"),children:"Fornecedores"})]}),a.jsx("div",{className:"flex-1 min-w-[200px]",children:a.jsx(Ye,{placeholder:"Buscar por cdigo, nome ou documento",value:De,onChange:O=>ke(O.target.value)})}),a.jsxs("span",{className:"text-xs text-text-secondary",children:[Ot.length," itens"]})]}),a.jsxs("div",{className:"border border-border rounded-md divide-y divide-border",children:[Ot.map(O=>a.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 hover:bg-surface-2 cursor-pointer",onClick:()=>Je(O),children:[a.jsx("div",{className:"col-span-2 text-xs font-medium",children:String(O.codigo||O.codigo_cliente||O.codigo_fornecedor||O.code||"")}),a.jsx("div",{className:"col-span-6 text-sm truncate",title:O.nome||O.razao_social||"",children:O.nome||O.razao_social||"Sem nome"}),a.jsxs("div",{className:"col-span-4 text-xs text-text-secondary text-right",children:[(O.cnpj||O.cpf||"").toString()," ",O.cidade?` ${O.cidade}/${O.uf||""}`:""]})]},O.id)),Ot.length===0&&a.jsx("div",{className:"text-xs text-text-secondary px-3 py-2",children:"Nenhum registro encontrado"})]}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx(me,{variant:"outline",onClick:()=>Pn(!1),children:"Fechar"})})]})}),a.jsx(xn,{open:pr,onOpenChange:Xt,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Selecionar produto"}),a.jsx(Dn,{children:"Busque pelo nome ou cdigo para preencher o item."})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Ye,{placeholder:"Buscar produto por nome ou cdigo",value:xe,onChange:O=>st(O.target.value)}),a.jsxs("span",{className:"text-xs text-text-secondary",children:[ot.length," itens"]})]}),a.jsxs("div",{className:"border border-border rounded-md divide-y divide-border",children:[ot.map(O=>a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 hover:bg-surface-2 cursor-pointer",onClick:()=>{yr!=null&&Ht(yr,O),Xt(!1)},children:[a.jsxs("div",{className:"text-sm",children:[O.name," ",a.jsx("span",{className:"text-text-secondary",children:O.code?`(${O.code})`:""})]}),a.jsxs("div",{className:"text-xs text-text-secondary",children:["NCM ",O.ncm||"","  UN ",String(O.unit||"UN").toUpperCase(),"  R$ ",Zc(O.price??O.salePrice??0)]})]},O.id)),ot.length===0&&a.jsx("div",{className:"text-xs text-text-secondary px-3 py-2",children:"Nenhum produto encontrado"})]}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx(me,{variant:"outline",onClick:()=>Xt(!1),children:"Fechar"})})]})}),a.jsx(xn,{open:at,onOpenChange:gt,children:a.jsxs(vn,{className:"w-[960px] max-w-[96vw] h-[85vh] overflow-hidden flex flex-col",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Criar NF-e (manual)"}),a.jsx(Dn,{children:"Preencha os dados nas abas para gerar o XML."})]}),a.jsxs(Cc,{value:Ne,onValueChange:ye,className:"w-full flex-1 overflow-hidden flex flex-col",children:[a.jsxs(Gl,{className:"mb-3 w-full flex flex-wrap justify-start gap-1",children:[a.jsx(da,{value:"cliente",children:"Cabealho"}),a.jsx(da,{value:"itens",children:"Produtos"}),a.jsx(da,{value:"impostos",children:"Impostos"}),a.jsx(da,{value:"totais",children:"Totais"}),a.jsx(da,{value:"pagamento",children:"Pagamento"}),a.jsx(da,{value:"transporte",children:"Transporte"}),a.jsx(da,{value:"adicionais",children:"Informaes"}),a.jsx(da,{value:"rastreabilidade",children:"Rastreabilidade"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto pr-1",children:[Ne==="cliente"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Tipo da Nota"}),a.jsxs(Nn,{value:We.tipo_nota,onValueChange:O=>Ze(T=>({...T,tipo_nota:O,natOp:O==="entrada"?"COMPRA":T.natOp||"VENDA"})),children:[a.jsx(bn,{className:"h-9",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"saida",children:"Sada"}),a.jsx(tt,{value:"entrada",children:"Entrada"})]})]})]}),a.jsxs("div",{children:[a.jsxs(Le,{children:[We.tipo_nota==="entrada"?"Fornecedor":"Cliente"," (cdigo)"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ye,{className:"h-9 w-[110px]",inputMode:"numeric",value:We.party_codigo,onChange:O=>Ze(T=>({...T,party_codigo:O.target.value.replace(/\D/g,"")})),onKeyDown:O=>{O.key==="Enter"&&(O.preventDefault(),Xr(We.party_codigo))},onBlur:()=>Xr(We.party_codigo),placeholder:""}),a.jsx(me,{type:"button",size:"icon",variant:"ghost",title:"Selecionar",onClick:()=>{ke(""),Qt(We.tipo_nota==="entrada"?"fornecedor":"cliente"),Pn(!0)},children:a.jsx(to,{className:"h-4 w-4"})}),(We.party_codigo||We.nome||We.cpf_cnpj)&&a.jsx(me,{type:"button",size:"icon",variant:"ghost",title:"Limpar",onClick:()=>Ze(O=>({...O,party_id:"",party_codigo:"",tipo_pessoa:"PJ",cpf_cnpj:"",nome:"",email:"",telefone:"",inscricao_estadual:"",ie_isento:!1,logradouro:"",numero:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:""})),children:a.jsx(el,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Data Emisso"}),a.jsx(uv,{label:"Data Emisso",value:We.data_emissao,onChange:O=>Ze(T=>({...T,data_emissao:O}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Data Sada"}),a.jsx(uv,{label:"Data Sada",value:We.data_saida,onChange:O=>Ze(T=>({...T,data_saida:O}))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Natureza (natOp)"}),a.jsx(Ye,{className:"h-8",list:"natop-list",value:We.natOp,onChange:O=>Ze(T=>({...T,natOp:O.target.value}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Srie"}),a.jsx(Ye,{className:"h-8",value:We.serie,onChange:O=>Ze(T=>({...T,serie:O.target.value}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Nmero (nNF)"}),a.jsx(Ye,{className:"h-8",value:We.nNF,onChange:O=>Ze(T=>({...T,nNF:O.target.value}))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Finalidade da NF"}),a.jsxs(Nn,{value:We.finNFe,onValueChange:O=>Ze(T=>({...T,finNFe:O})),children:[a.jsx(bn,{className:"h-9",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"1",children:"Normal"}),a.jsx(tt,{value:"2",children:"Complementar"}),a.jsx(tt,{value:"3",children:"Ajuste"}),a.jsx(tt,{value:"4",children:"Devoluo"})]})]})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Local de Destino"}),a.jsxs(Nn,{value:We.idDest,onValueChange:O=>Ze(T=>({...T,idDest:O})),children:[a.jsx(bn,{className:"h-9",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"1",children:"Operao Interna"}),a.jsx(tt,{value:"2",children:"Interestadual"}),a.jsx(tt,{value:"3",children:"Exterior"})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Indicador de presena"}),a.jsxs(Nn,{value:We.indPres,onValueChange:O=>Ze(T=>({...T,indPres:O})),children:[a.jsx(bn,{className:"h-9",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"0",children:"No se aplica"}),a.jsx(tt,{value:"1",children:"Operao presencial"}),a.jsx(tt,{value:"2",children:"No presencial (internet)"}),a.jsx(tt,{value:"3",children:"No presencial (teleatendimento)"}),a.jsx(tt,{value:"4",children:"Entrega a domiclio"}),a.jsx(tt,{value:"9",children:"Outros"})]})]})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Intermediador/Marketplace"}),a.jsxs(Nn,{value:We.indIntermed,onValueChange:O=>Ze(T=>({...T,indIntermed:O})),children:[a.jsx(bn,{className:"h-9",children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"0",children:"Sem intermediador"}),a.jsx(tt,{value:"1",children:"Com intermediador"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:We.indFinal==="1",onCheckedChange:O=>Ze(T=>({...T,indFinal:O?"1":"0"}))}),a.jsx("span",{className:"text-sm",children:"Consumidor Final"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!We.baixar_estoque,onCheckedChange:O=>Ze(T=>({...T,baixar_estoque:!!O}))}),a.jsx("span",{className:"text-sm",children:"Baixar Estoque"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!We.destacar_st,onCheckedChange:O=>Ze(T=>({...T,destacar_st:!!O}))}),a.jsx("span",{className:"text-sm",children:"Destacar Substituio Trib."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{id:"autoApplyCfop",checked:!!tr,onCheckedChange:O=>Or(!!O)}),a.jsx(Le,{htmlFor:"autoApplyCfop",className:"text-xs",children:"Aplicar CFOP padro automaticamente aos itens"})]})]}),We.indIntermed==="1"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"CNPJ Intermediador"}),a.jsx(Ye,{inputMode:"numeric",placeholder:"Somente nmeros",value:We.intermediador_cnpj,onChange:O=>Ze(T=>({...T,intermediador_cnpj:Lr(O.target.value)}))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Identificador no Intermediador"}),a.jsx(Ye,{value:We.intermediador_id,onChange:O=>Ze(T=>({...T,intermediador_id:O.target.value}))})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"CFOP padro"}),a.jsxs(Nn,{value:We.cfop_padrao||"",onValueChange:O=>{dt(""),Ze(T=>({...T,cfop_padrao:O,natOp:Yt(O)}))},children:[a.jsx(bn,{className:"mt-1 w-full truncate h-8 text-xs",children:a.jsx(Cn,{placeholder:"Selecionar CFOP"})}),a.jsxs(wn,{className:"max-h-[300px] overflow-auto w-[360px] sm:w-[420px]",children:[a.jsx("div",{className:"sticky top-0 z-10 p-2 bg-background",children:a.jsx(Ye,{className:"h-8 text-xs",placeholder:"Filtrar CFOP ou descrio",value:be,onChange:O=>dt(O.target.value)})}),zn.filter(O=>{const T=be.trim().toLowerCase();return T?O.code.toLowerCase().includes(T)||(O.desc||"").toLowerCase().includes(T):!0}).map(O=>a.jsx(tt,{value:O.code,title:`${O.code}  ${O.desc}`,children:`${O.code} - ${(O.desc||"").slice(0,60)}`},O.code))]})]})]})})]}),a.jsx(ds,{value:"cliente",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Tipo pessoa"}),a.jsxs(Nn,{value:We.tipo_pessoa,onValueChange:O=>Ze(T=>({...T,tipo_pessoa:O})),children:[a.jsx(bn,{children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"PJ",children:"PJ"}),a.jsx(tt,{value:"PF",children:"PF"})]})]})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"CPF/CNPJ"}),a.jsx(Ye,{inputMode:"numeric",placeholder:"Somente nmeros",value:We.cpf_cnpj,onChange:O=>Ze(T=>({...T,cpf_cnpj:Lr(O.target.value)}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Nome/Razo"}),a.jsx(Ye,{value:We.nome,onChange:O=>Ze(T=>({...T,nome:O.target.value}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Inscrio Estadual"}),a.jsx(Ye,{value:We.inscricao_estadual,onChange:O=>Ze(T=>({...T,inscricao_estadual:O.target.value})),disabled:We.ie_isento})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[a.jsx(Ha,{checked:We.ie_isento,onCheckedChange:O=>Ze(T=>({...T,ie_isento:!!O,inscricao_estadual:O?"ISENTO":T.inscricao_estadual}))}),a.jsx("span",{className:"text-sm",children:"IE Isento"})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Telefone"}),a.jsx(Ye,{inputMode:"numeric",placeholder:"(DD) 9XXXX-XXXX",value:We.telefone,onChange:O=>Ze(T=>({...T,telefone:Lr(O.target.value)}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Email"}),a.jsx(Ye,{value:We.email,onChange:O=>Ze(T=>({...T,email:O.target.value}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Logradouro"}),a.jsx(Ye,{value:We.logradouro,onChange:O=>Ze(T=>({...T,logradouro:O.target.value}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Nmero"}),a.jsx(Ye,{value:We.numero,onChange:O=>Ze(T=>({...T,numero:O.target.value}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Bairro"}),a.jsx(Ye,{value:We.bairro,onChange:O=>Ze(T=>({...T,bairro:O.target.value}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Cidade"}),a.jsx(Ye,{value:We.cidade,onChange:O=>Ze(T=>({...T,cidade:O.target.value}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"UF"}),a.jsx(Ye,{value:We.uf,onChange:O=>Ze(T=>({...T,uf:O.target.value.toUpperCase().slice(0,2)}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"CEP"}),a.jsx(Ye,{inputMode:"numeric",placeholder:"00000000",value:We.cep,onChange:O=>Ze(T=>({...T,cep:Lr(O.target.value).slice(0,8)})),onBlur:()=>vt(We.cep)}),Be&&a.jsx("div",{className:"text-xs text-text-secondary mt-1",children:"Buscando endereo"})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"cMun IBGE"}),a.jsx(Ye,{inputMode:"numeric",placeholder:"Cdigo do municpio (IBGE)",value:We.codigo_municipio_ibge,onChange:O=>Ze(T=>({...T,codigo_municipio_ibge:Lr(O.target.value)}))})]})]})}),a.jsx(ds,{value:"itens",children:a.jsxs("div",{className:"space-y-2",children:[We.itens.map((O,T)=>a.jsxs("div",{className:"space-y-1 border border-border rounded-md p-2",onClick:Tn(T),children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-1 items-start",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Cdigo"}),a.jsx(Ye,{className:"h-8 text-xs",value:O.codigo,onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],codigo:X.target.value},{...H,itens:L}}),onKeyDown:X=>{if(X.key==="Enter"){const H=(It||[]).find(L=>String(L.code||"")===String((O.codigo||"").trim()));H&&Ht(T,H)}},onBlur:()=>{const X=(It||[]).find(H=>String(H.code||"")===String((O.codigo||"").trim()));X&&Ht(T,X)}})]}),a.jsxs("div",{className:"md:col-span-3 min-w-0",children:[a.jsx(Le,{children:"Descrio"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ye,{className:"h-8 text-xs flex-1",value:O.descricao,onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],descricao:X.target.value},{...H,itens:L}})}),a.jsx(me,{type:"button",size:"icon",variant:"ghost",title:"Buscar produto",onClick:()=>{lr(T),st(""),Xt(!0)},children:a.jsx(to,{className:"h-4 w-4"})}),a.jsx(me,{type:"button",size:"icon",variant:"ghost",className:"text-text-secondary hover:text-red-500",title:"Remover item",onClick:()=>Ze(X=>({...X,itens:X.itens.filter((H,L)=>L!==T)})),children:a.jsx(zu,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"md:col-span-2 min-w-0",children:[a.jsx(Le,{children:"CFOP"}),a.jsxs(Nn,{value:O.cfop||"",onValueChange:X=>{dt(""),Ze(H=>{const L=[...H.itens];return L[T]={...L[T],cfop:X},{...H,itens:L,natOp:Yt(X)}})},children:[a.jsx(bn,{className:"mt-1 w-full truncate h-8 text-xs",children:a.jsx(Cn,{placeholder:"Selecionar CFOP"})}),a.jsxs(wn,{className:"max-h-[300px] overflow-auto w-[360px] sm:w-[420px]",children:[a.jsx("div",{className:"sticky top-0 z-10 p-2 bg-background",children:a.jsx(Ye,{className:"h-8 text-xs",placeholder:"Filtrar CFOP ou descrio",value:be,onChange:X=>dt(X.target.value)})}),zn.filter(X=>{const H=be.trim().toLowerCase();return H?X.code.toLowerCase().includes(H)||(X.desc||"").toLowerCase().includes(H):!0}).map(X=>a.jsx(tt,{value:X.code,title:`${X.code}  ${X.desc}`,children:`${X.code} - ${(X.desc||"").slice(0,60)}`},X.code))]})]})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx(Le,{children:"Unid."}),a.jsx(Ye,{className:"h-8 text-xs",list:"unid-list",placeholder:"UN, KG, LT",value:O.unidade,onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],unidade:X.target.value.toUpperCase().slice(0,5)},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx(Le,{children:"Cd. Barras"}),a.jsx(Ye,{className:"h-8 text-xs",value:O.cod_barras||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],cod_barras:X.target.value},{...H,itens:L}}),onKeyDown:X=>{if(X.key==="Enter"){const H=String((O.cod_barras||"").trim()),L=(It||[]).find(Fe=>[Fe.barcode,Fe.ean,Fe.gtin,Fe.bar_code].some(nt=>String(nt||"")===H));L&&Ht(T,L)}},onBlur:()=>{const X=String((O.cod_barras||"").trim()),H=(It||[]).find(L=>[L.barcode,L.ean,L.gtin,L.bar_code].some(Fe=>String(Fe||"")===X));H&&Ht(T,H)}})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx(Le,{children:"Qtd"}),a.jsx(Ye,{className:"h-8 text-xs",inputMode:"decimal",value:O.quantidade,onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],quantidade:X.target.value.replace(/[^0-9.,]/g,"")},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Preo"}),a.jsx(Ye,{className:"h-8 text-xs",inputMode:"decimal",value:O.preco_unitario,onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],preco_unitario:mn(X.target.value)},{...H,itens:L}})})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-text-secondary mt-1",children:[a.jsx("div",{className:"truncate",children:`Item ${T+1}: ${O.codigo?O.codigo+" - ":""}${O.descricao||""}`}),a.jsx("div",{children:`Total item: R$ ${Zc((sr(O.preco_unitario)||0)*(sr(O.quantidade)||1)-(sr(O.desconto_percent)?(sr(O.preco_unitario)||0)*(sr(O.quantidade)||1)*(sr(O.desconto_percent)||0)/100:sr(O.desconto_valor)||0)+(sr(O.acrescimos_valor)||0)+(sr(O.frete_valor)||0)+(sr(O.seguro_valor)||0))}`})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!O.dest_icms,onCheckedChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],dest_icms:!!X},{...H,itens:L}})}),a.jsx("span",{className:"text-xs",children:"Destacar ICMS"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!O.dest_icms_info,onCheckedChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],dest_icms_info:!!X},{...H,itens:L}})}),a.jsx("span",{className:"text-xs",children:"ICMS na Info. Adicional"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ha,{checked:!!O.benef_fiscal,onCheckedChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],benef_fiscal:!!X},{...H,itens:L}})}),a.jsx("span",{className:"text-xs",children:"Benefcio Fiscal"})]})]}),it===T&&a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-12 gap-1",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"NCM"}),a.jsx(Ye,{className:"h-8 text-xs",inputMode:"numeric",placeholder:"8 dgitos",value:O.ncm,onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],ncm:Lr(X.target.value).slice(0,8)},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"CEST"}),a.jsx(Ye,{className:"h-8 text-xs",value:O.cest||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],cest:X.target.value},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Desc. (R$)"}),a.jsx(Ye,{className:"h-8 text-xs",inputMode:"decimal",value:O.desconto_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],desconto_valor:mn(X.target.value)},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Desc. (%)"}),a.jsx(Ye,{className:"h-8 text-xs",inputMode:"decimal",value:O.desconto_percent||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],desconto_percent:X.target.value.replace(/[^0-9.,]/g,"")},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Acrscimos"}),a.jsx(Ye,{className:"h-8 text-xs",inputMode:"decimal",value:O.acrescimos_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],acrescimos_valor:mn(X.target.value)},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Frete (R$)"}),a.jsx(Ye,{className:"h-8 text-xs",inputMode:"decimal",value:O.frete_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],frete_valor:mn(X.target.value)},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Seguro (R$)"}),a.jsx(Ye,{className:"h-8 text-xs",inputMode:"decimal",value:O.seguro_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],seguro_valor:mn(X.target.value)},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-12",children:[a.jsx(Le,{children:"Observaes"}),a.jsx(Ye,{className:"h-8 text-xs",value:O.obs||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],obs:X.target.value},{...H,itens:L}})})]})]})]},T)),a.jsx("div",{className:"flex justify-start",children:a.jsx(me,{size:"sm",variant:"outline",onClick:()=>{Ze(O=>{const T={descricao:"",codigo:"",cod_barras:"",ncm:"",cest:"",cfop:O.cfop_padrao||"5102",unidade:"UN",quantidade:"1",preco_unitario:"0.00",desconto_valor:"0.00",desconto_percent:"",acrescimos_valor:"0.00",frete_valor:"0.00",seguro_valor:"0.00",obs:"",dest_icms:!1,dest_icms_info:!1,benef_fiscal:!1,impostos:{origem:"",icms:{cst:"",csosn:"",base:"",aliquota:"",valor:"",desonerado_valor:"",desoneracao_motivo:"",operacao_valor:"",aliq_diferimento:"",valor_diferido:""},icmsst:{base:"",aliquota:"",valor:""},fcp:{base:"",aliquota:"",valor:""},fcpst:{base:"",aliquota:"",valor:""},pis:{cst:"",aliquota:"",valor:""},cofins:{cst:"",aliquota:"",valor:""},ipi:{cst:"",aliquota:"",valor:"",tipo_calculo:"nenhum",valor_unit:""},iss:{aliquota:"",valor:""}}};return{...O,itens:[...O.itens,T]}})},children:"Adicionar item"})}),a.jsx("div",{className:"mt-2 overflow-x-auto border border-border rounded",children:a.jsxs("table",{className:"min-w-full text-[11px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-text-secondary",children:[a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Item"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Produto"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Descrio"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"UN"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"CST"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Qtde"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. Unit"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. ICMS"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. ICMS-ST"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. FCP"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Total Item"})]})}),a.jsx("tbody",{children:We.itens.map((O,T)=>{const X=sr(O.preco_unitario)||0,H=sr(O.quantidade)||1,L=X*H,Fe=sr(O.desconto_percent)||0,nt=sr(O.desconto_valor)||0,ft=sr(O.acrescimos_valor)||0,Bt=Fe?L*Fe/100:nt,$e=L-Bt+ft+(sr(O.frete_valor)||0)+(sr(O.seguro_valor)||0),Dt=O.impostos?.icms?.cst||O.impostos?.icms?.csosn||"",Sr=sr(O.impostos?.icms?.valor)||0,Pr=sr(O.impostos?.icmsst?.valor)||0,vr=sr(O.impostos?.fcp?.valor)||0;return a.jsxs("tr",{className:"border-t border-border/60",children:[a.jsx("td",{className:"px-2 py-1",children:T+1}),a.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:O.codigo||""}),a.jsx("td",{className:"px-2 py-1 truncate max-w-[320px]",children:O.descricao||""}),a.jsx("td",{className:"px-2 py-1",children:O.unidade||"UN"}),a.jsx("td",{className:"px-2 py-1",children:Dt||""}),a.jsx("td",{className:"px-2 py-1 text-right",children:Zc(H)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Zc(X)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Zc(Sr)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Zc(Pr)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Zc(vr)}),a.jsx("td",{className:"px-2 py-1 text-right",children:Zc($e)})]},T)})})]})})]})}),a.jsx(ds,{value:"impostos",children:a.jsx("div",{className:"space-y-3",children:We.itens.map((O,T)=>a.jsxs("div",{className:"border border-border rounded-md p-2 cursor-pointer",onClick:Tn(T),children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"text-sm font-medium truncate",children:["Item ",T+1,": ",O.codigo?`${O.codigo} - `:"",O.descricao||""]}),a.jsxs("div",{className:"text-xs text-text-secondary flex gap-3",children:[a.jsxs("span",{children:["ICMS ",O.impostos?.icms?.cst||O.impostos?.icms?.csosn||"","/",O.impostos?.icms?.aliquota||"","%"]}),a.jsxs("span",{children:["PIS ",O.impostos?.pis?.cst||"","/",O.impostos?.pis?.aliquota||"","%"]}),a.jsxs("span",{children:["COFINS ",O.impostos?.cofins?.cst||"","/",O.impostos?.cofins?.aliquota||"","%"]}),a.jsxs("span",{children:["FCP ",O.impostos?.fcp?.aliquota||"","%"]}),a.jsxs("span",{children:["IPI ",O.impostos?.ipi?.cst||"","/",O.impostos?.ipi?.aliquota||"","%"]}),a.jsx("span",{children:`Total R$ ${Zc((sr(O.preco_unitario)||0)*(sr(O.quantidade)||1)-(sr(O.desconto_percent)?(sr(O.preco_unitario)||0)*(sr(O.quantidade)||1)*(sr(O.desconto_percent)||0)/100:sr(O.desconto_valor)||0)+(sr(O.acrescimos_valor)||0)+(sr(O.frete_valor)||0)+(sr(O.seguro_valor)||0))}`})]})]}),it===T&&a.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Origem"}),a.jsx(Ye,{value:O.impostos?.origem||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,origem:X.target.value}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ICMS CST"}),a.jsx(Ye,{value:O.impostos?.icms?.cst||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,cst:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"CSOSN"}),a.jsx(Ye,{value:O.impostos?.icms?.csosn||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,csosn:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Base ICMS"}),a.jsx(Ye,{value:O.impostos?.icms?.base||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,base:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Alquota ICMS (%)"}),a.jsx(Ye,{value:O.impostos?.icms?.aliquota||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,aliquota:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Valor ICMS"}),a.jsx(Ye,{value:O.impostos?.icms?.valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Base ICMS-ST"}),a.jsx(Ye,{value:O.impostos?.icmsst?.base||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icmsst:{...L[T].impostos.icmsst,base:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Alquota ICMS-ST (%)"}),a.jsx(Ye,{value:O.impostos?.icmsst?.aliquota||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icmsst:{...L[T].impostos.icmsst,aliquota:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Valor ICMS-ST"}),a.jsx(Ye,{value:O.impostos?.icmsst?.valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icmsst:{...L[T].impostos.icmsst,valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"FCP Base"}),a.jsx(Ye,{value:O.impostos?.fcp?.base||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,fcp:{...L[T].impostos.fcp,base:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"FCP Alquota (%)"}),a.jsx(Ye,{value:O.impostos?.fcp?.aliquota||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,fcp:{...L[T].impostos.fcp,aliquota:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"FCP Valor"}),a.jsx(Ye,{value:O.impostos?.fcp?.valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,fcp:{...L[T].impostos.fcp,valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"FCP-ST Base"}),a.jsx(Ye,{value:O.impostos?.fcpst?.base||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,fcpst:{...L[T].impostos.fcpst,base:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"FCP-ST Alquota (%)"}),a.jsx(Ye,{value:O.impostos?.fcpst?.aliquota||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,fcpst:{...L[T].impostos.fcpst,aliquota:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"FCP-ST Valor"}),a.jsx(Ye,{value:O.impostos?.fcpst?.valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,fcpst:{...L[T].impostos.fcpst,valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ICMS Desonerado (R$)"}),a.jsx(Ye,{value:O.impostos?.icms?.desonerado_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,desonerado_valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Motivo da Desonerao"}),a.jsx(Ye,{value:O.impostos?.icms?.desoneracao_motivo||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,desoneracao_motivo:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ICMS Operao (R$)"}),a.jsx(Ye,{value:O.impostos?.icms?.operacao_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,operacao_valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Alquota Diferimento (%)"}),a.jsx(Ye,{value:O.impostos?.icms?.aliq_diferimento||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,aliq_diferimento:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Valor ICMS Diferido"}),a.jsx(Ye,{value:O.impostos?.icms?.valor_diferido||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,valor_diferido:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"PIS CST"}),a.jsx(Ye,{value:O.impostos?.pis?.cst||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,pis:{...L[T].impostos.pis,cst:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"PIS Alquota (%)"}),a.jsx(Ye,{value:O.impostos?.pis?.aliquota||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,pis:{...L[T].impostos.pis,aliquota:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"PIS Valor"}),a.jsx(Ye,{value:O.impostos?.pis?.valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,pis:{...L[T].impostos.pis,valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"COFINS CST"}),a.jsx(Ye,{value:O.impostos?.cofins?.cst||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,cofins:{...L[T].impostos.cofins,cst:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"COFINS Alquota (%)"}),a.jsx(Ye,{value:O.impostos?.cofins?.aliquota||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,cofins:{...L[T].impostos.cofins,aliquota:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"COFINS Valor"}),a.jsx(Ye,{value:O.impostos?.cofins?.valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,cofins:{...L[T].impostos.cofins,valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"IPI CST"}),a.jsx(Ye,{value:O.impostos?.ipi?.cst||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,ipi:{...L[T].impostos.ipi,cst:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"IPI - Tipo de Clculo"}),a.jsxs(Nn,{value:O.impostos?.ipi?.tipo_calculo||"nenhum",onValueChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,ipi:{...L[T].impostos.ipi,tipo_calculo:X}}},{...H,itens:L}}),children:[a.jsx(bn,{className:"h-8 text-xs"}),a.jsxs(wn,{children:[a.jsx(tt,{value:"aliquota",children:"Alquota"}),a.jsx(tt,{value:"valor_unit",children:"Vl Unit."}),a.jsx(tt,{value:"nenhum",children:"Nenhum"})]})]})]}),(O.impostos?.ipi?.tipo_calculo||"nenhum")==="aliquota"&&a.jsxs("div",{children:[a.jsx(Le,{children:"IPI Alquota (%)"}),a.jsx(Ye,{value:O.impostos?.ipi?.aliquota||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,ipi:{...L[T].impostos.ipi,aliquota:X.target.value}}},{...H,itens:L}})})]}),(O.impostos?.ipi?.tipo_calculo||"nenhum")==="valor_unit"&&a.jsxs("div",{children:[a.jsx(Le,{children:"IPI Valor Unitrio"}),a.jsx(Ye,{value:O.impostos?.ipi?.valor_unit||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,ipi:{...L[T].impostos.ipi,valor_unit:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"IPI Valor"}),a.jsx(Ye,{value:O.impostos?.ipi?.valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,ipi:{...L[T].impostos.ipi,valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ISS Alquota (%)"}),a.jsx(Ye,{value:O.impostos?.iss?.aliquota||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,iss:{...L[T].impostos.iss,aliquota:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ISS Valor"}),a.jsx(Ye,{value:O.impostos?.iss?.valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,iss:{...L[T].impostos.iss,valor:X.target.value}}},{...H,itens:L}})})]}),a.jsx("div",{className:"md:col-span-6",children:a.jsxs("details",{children:[a.jsx("summary",{className:"text-xs text-text-secondary cursor-pointer select-none",children:"Impostos 2 (Avanado)"}),a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"AD Rem"}),a.jsx(Ye,{value:O.impostos?.icms?.ad_rem||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,ad_rem:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"AD Rem Reteno"}),a.jsx(Ye,{value:O.impostos?.icms?.ad_rem_retencao||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,ad_rem_retencao:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"BC Monofsico"}),a.jsx(Ye,{value:O.impostos?.icms?.monofasico_bc||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,monofasico_bc:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ICMS Monofsico"}),a.jsx(Ye,{value:O.impostos?.icms?.monofasico_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,monofasico_valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"BC Mono Reteno"}),a.jsx(Ye,{value:O.impostos?.icms?.mono_retencao_bc||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,mono_retencao_bc:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ICMS Mono Reteno"}),a.jsx(Ye,{value:O.impostos?.icms?.mono_retencao_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,mono_retencao_valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"% Reduo"}),a.jsx(Ye,{value:O.impostos?.icms?.reducao_percent||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,reducao_percent:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Motivo da Reduo"}),a.jsx(Ye,{value:O.impostos?.icms?.reducao_motivo||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,reducao_motivo:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"BC Mono Cobrado Ant."}),a.jsx(Ye,{value:O.impostos?.icms?.mono_cobrado_ant_bc||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,mono_cobrado_ant_bc:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ICMS Mono Cobrado Ant."}),a.jsx(Ye,{value:O.impostos?.icms?.mono_cobrado_ant_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,mono_cobrado_ant_valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"ICMS Prprio Devido"}),a.jsx(Ye,{value:O.impostos?.icms?.proprio_devido_valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,icms:{...L[T].impostos.icms,proprio_devido_valor:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-6 border-t border-border/40 pt-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Grupo indicador da origem do combustvel"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"UF"}),a.jsx(Ye,{value:O.impostos?.combustivel?.uf||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,combustivel:{...L[T].impostos.combustivel,uf:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"% origem UF"}),a.jsx(Ye,{value:O.impostos?.combustivel?.perc_origem_uf||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,combustivel:{...L[T].impostos.combustivel,perc_origem_uf:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{children:"Indicador de importao"}),a.jsx(Ye,{value:O.impostos?.combustivel?.indicador_importacao||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,combustivel:{...L[T].impostos.combustivel,indicador_importacao:X.target.value}}},{...H,itens:L}})})]})]})]}),a.jsxs("div",{className:"md:col-span-6 border-t border-border/40 pt-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"CIDE"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Aliq. CIDE"}),a.jsx(Ye,{value:O.impostos?.cide?.aliq||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,cide:{...L[T].impostos.cide,aliq:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"BC CIDE"}),a.jsx(Ye,{value:O.impostos?.cide?.base||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,cide:{...L[T].impostos.cide,base:X.target.value}}},{...H,itens:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Vl. CIDE"}),a.jsx(Ye,{value:O.impostos?.cide?.valor||"",onChange:X=>Ze(H=>{const L=[...H.itens];return L[T]={...L[T],impostos:{...L[T].impostos,cide:{...L[T].impostos.cide,valor:X.target.value}}},{...H,itens:L}})})]})]})]})]})]})})]})]},T))})}),a.jsx(ds,{value:"totais",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Desconto Geral (R$)"}),a.jsx(Ye,{value:We.totais.desconto_geral,onChange:O=>Ze(T=>({...T,totais:{...T.totais,desconto_geral:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Frete (R$)"}),a.jsx(Ye,{value:We.totais.frete,onChange:O=>Ze(T=>({...T,totais:{...T.totais,frete:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Outras Despesas (R$)"}),a.jsx(Ye,{value:We.totais.outras_despesas,onChange:O=>Ze(T=>({...T,totais:{...T.totais,outras_despesas:O.target.value}}))})]}),a.jsxs("div",{className:"mt-6 text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:"Total itens: "}),Zc(We.itens.reduce((O,T)=>{const X=sr(T.preco_unitario),H=sr(T.quantidade)||1,L=sr(T.desconto_percent)||0,Fe=sr(T.desconto_valor)||0,nt=sr(T.acrescimos_valor)||0,ft=X*H,Bt=L?ft*L/100:Fe;return O+(ft-Bt+nt)},0))]})]})}),a.jsx(ds,{value:"pagamento",children:a.jsxs("div",{className:"space-y-3",children:[We.pagamentos.map((O,T)=>a.jsxs("div",{className:"grid grid-cols-1 gap-2 items-end md:[grid-template-columns:2fr_1fr_1fr_1fr_auto]",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Finalizadora"}),a.jsxs(Nn,{value:O.finalizadora_id||"",onValueChange:X=>Ze(H=>{const L=[...H.pagamentos],Fe=(ct||[]).find(nt=>String(nt.id)===String(X));return L[T]={...L[T],finalizadora_id:X,tipo:Fe?.nome||L[T].tipo},{...H,pagamentos:L}}),children:[a.jsx(bn,{className:"h-9",children:a.jsx(Cn,{placeholder:ct.length?"Selecionar":"Carregando"})}),a.jsx(wn,{children:ct.map(X=>a.jsx(tt,{value:X.id,children:`${X?.codigo_interno!=null&&String(X.codigo_interno).trim()!==""?String(X.codigo_interno).padStart(2,"0")+" - ":""}${X?.nome||""}`},X.id))})]})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Valor"}),a.jsx(Ye,{className:"h-9",inputMode:"decimal",value:O.valor||"",onChange:X=>Ze(H=>{const L=[...H.pagamentos];return L[T]={...L[T],valor:mn(X.target.value)},{...H,pagamentos:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Parcelas"}),a.jsx(Ye,{className:"h-9",inputMode:"numeric",value:O.parcelas||"",onChange:X=>Ze(H=>{const L=[...H.pagamentos];return L[T]={...L[T],parcelas:Lr(X.target.value)},{...H,pagamentos:L}})})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Troco"}),a.jsx(Ye,{className:"h-9",inputMode:"decimal",value:O.troco||"",onChange:X=>Ze(H=>{const L=[...H.pagamentos];return L[T]={...L[T],troco:mn(X.target.value)},{...H,pagamentos:L}})})]}),a.jsx("div",{className:"flex items-end justify-end",children:a.jsx(me,{type:"button",size:"icon",variant:"ghost",className:"text-red-500 hover:text-red-600",title:"Remover pagamento",onClick:()=>Ze(X=>({...X,pagamentos:X.pagamentos.filter((H,L)=>L!==T)})),children:a.jsx(zu,{className:"h-4 w-4"})})})]},T)),a.jsx("div",{className:"flex justify-start",children:a.jsx(me,{size:"sm",variant:"outline",onClick:()=>Ze(O=>{const T=(ct||[])[0];return{...O,pagamentos:[...O.pagamentos,{finalizadora_id:T?.id||"",tipo:T?.nome||"Dinheiro",valor:""}]}}),children:"Adicionar pagamento"})})]})}),a.jsx(ds,{value:"transporte",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Tipo do frete"}),a.jsx(Ye,{value:We.transporte.tipo_frete,onChange:O=>Ze(T=>({...T,transporte:{...T.transporte,tipo_frete:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Transportadora"}),a.jsx(Ye,{value:We.transporte.transportadora,onChange:O=>Ze(T=>({...T,transporte:{...T.transporte,transportadora:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Placa"}),a.jsx(Ye,{value:We.transporte.placa,onChange:O=>Ze(T=>({...T,transporte:{...T.transporte,placa:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Volumes"}),a.jsx(Ye,{value:We.transporte.volumes,onChange:O=>Ze(T=>({...T,transporte:{...T.transporte,volumes:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Peso lquido"}),a.jsx(Ye,{value:We.transporte.peso_liquido,onChange:O=>Ze(T=>({...T,transporte:{...T.transporte,peso_liquido:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Peso bruto"}),a.jsx(Ye,{value:We.transporte.peso_bruto,onChange:O=>Ze(T=>({...T,transporte:{...T.transporte,peso_bruto:O.target.value}}))})]})]})}),a.jsx(ds,{value:"adicionais",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Observaes gerais"}),a.jsx(Ye,{value:We.adicionais.obs_gerais,onChange:O=>Ze(T=>({...T,adicionais:{...T.adicionais,obs_gerais:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Info para o Fisco"}),a.jsx(Ye,{value:We.adicionais.info_fisco,onChange:O=>Ze(T=>({...T,adicionais:{...T.adicionais,info_fisco:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Info para o Cliente"}),a.jsx(Ye,{value:We.adicionais.info_cliente,onChange:O=>Ze(T=>({...T,adicionais:{...T.adicionais,info_cliente:O.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Referncia documento"}),a.jsx(Ye,{value:We.adicionais.referencia_doc,onChange:O=>Ze(T=>({...T,adicionais:{...T.adicionais,referencia_doc:O.target.value}}))})]})]})}),a.jsx(ds,{value:"rastreabilidade",children:a.jsx("div",{className:"text-sm text-text-secondary",children:"Rastreabilidade de Produtos"})})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(me,{variant:"outline",onClick:()=>gt(!1),children:"Fechar"}),a.jsx(me,{onClick:async()=>{try{const O=[],T=Lr(We.cpf_cnpj);We.tipo_pessoa==="PF"&&T&&T.length!==11&&O.push("CPF deve ter 11 dgitos"),We.tipo_pessoa==="PJ"&&T&&T.length!==14&&O.push("CNPJ deve ter 14 dgitos"),We.nome||O.push("Nome/Razo no informado"),We.email&&!cr(We.email)&&O.push("Email invlido"),We.uf&&We.uf.length!==2&&O.push("UF deve ter 2 letras"),We.cep&&Lr(We.cep).length!==8&&O.push("CEP deve ter 8 dgitos"),We.codigo_municipio_ibge||O.push("Cdigo IBGE do municpio  obrigatrio");const X=[];if(We.itens.forEach(($e,Dt)=>{$e.descricao||X.push(`Item ${Dt+1}: descrio obrigatria`),(!$e.ncm||Lr($e.ncm).length!==8)&&X.push(`Item ${Dt+1}: NCM deve ter 8 dgitos`),(!$e.cfop||Lr($e.cfop).length!==4)&&X.push(`Item ${Dt+1}: CFOP deve ter 4 dgitos`),sr($e.quantidade)<=0&&X.push(`Item ${Dt+1}: quantidade deve ser > 0`),sr($e.preco_unitario)<=0&&X.push(`Item ${Dt+1}: preo deve ser > 0`)}),O.push(...X),O.length){r({title:"Pendncias para gerar XML",description:O.join(`
`),variant:"destructive"});return}const H=We.itens.map($e=>{const Dt=sr($e.preco_unitario)||0,Sr=sr($e.quantidade)||1,Pr=Dt*Sr,vr=sr($e.desconto_percent)||0,yn=sr($e.desconto_valor)||0,On=sr($e.acrescimos_valor)||0,Xn=vr?Pr*vr/100:yn,kn=Pr-Xn+On;return{preco_unitario:Dt,quantidade:Sr,preco_total:kn,produtos:{nome:$e.descricao||"Produto",codigo:$e.codigo||"",ncm:$e.ncm||"",cfopInterno:$e.cfop||"5102"}}}),Fe=H.reduce(($e,Dt)=>$e+(Number(Dt.preco_total)||0),0)-(sr(We.totais.desconto_geral)||0)+(sr(We.totais.frete)||0)+(sr(We.totais.outras_despesas)||0),nt={tipo_pessoa:We.tipo_pessoa,cpf_cnpj:Lr(We.cpf_cnpj),nome:We.nome,email:We.email,logradouro:We.logradouro,numero:We.numero,bairro:We.bairro,cidade:We.cidade,uf:We.uf,cep:Lr(We.cep),codigo_municipio_ibge:We.codigo_municipio_ibge,inscricao_estadual:We.ie_isento?"ISENTO":We.inscricao_estadual,telefone:We.telefone},ft=We.pagamentos&&We.pagamentos.length?We.pagamentos.map($e=>({finalizadoras:{codigo_sefaz:(ct||[]).find(Pr=>String(Pr.id)===String($e.finalizadora_id))?.codigo_sefaz||"99"},valor:sr($e.valor)||0})):[{finalizadoras:{codigo_sefaz:"99"},valor:Fe}],Bt=await Mit({codigoEmpresa:t,cliente:nt,itens:H,pagamentos:ft,modelo:"55",overrides:{natOp:We.natOp,serie:We.serie,nNF:We.nNF,indFinal:We.indFinal,indPres:We.indPres,idDest:We.idDest,tpNF:We.tipo_nota==="entrada"?"0":"1"}});yt(Bt),mr(!0),r({title:"XML NF-e gerado"})}catch(O){r({title:"Falha ao gerar XML",description:O.message,variant:"destructive"})}},children:"Gerar XML"})]}),!1]})}),a.jsx(xn,{open:Lt,onOpenChange:mr,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[800px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"XML gerado"}),a.jsx(Dn,{children:"Faa o download ou salve no Supabase."})]}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Prvia do XML"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(me,{size:"sm",variant:"outline",onClick:()=>eV(`nfe-manual-${Date.now()}.xml`,Pt),children:"Baixar XML"}),a.jsx(me,{size:"sm",onClick:async()=>{try{ge(!0);const O=`nfe/${t}/manual-${Date.now()}.xml`,T=new Blob([Pt],{type:"text/xml;charset=utf-8"}),{error:X}=await he.storage.from("fiscal").upload(O,T,{contentType:"text/xml"});if(X)throw X;r({title:"XML salvo no Supabase"})}catch(O){r({title:"Falha ao salvar",description:O.message,variant:"destructive"})}finally{ge(!1)}},disabled:Qe,children:Qe?"Salvando...":"Salvar no Supabase"})]})]}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto border border-border rounded p-2 bg-surface-2",children:Pt})]})}),a.jsx(xn,{open:fe,onOpenChange:Z,children:a.jsxs(vn,{className:"w-[95vw] sm:max-w-[680px] md:max-w-[860px] lg:max-w-[900px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Emisso NF-e (XML offline)"}),a.jsx(Dn,{children:"Preencha os campos abaixo e gere o XML da NF-e. Transmisso para SEFAZ ficar para a prxima etapa."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{children:"Natureza da Operao (natOp)"}),a.jsx(Ye,{value:ne.natOp,onChange:O=>de(T=>({...T,natOp:O.target.value})),placeholder:"VENDA"})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Srie"}),a.jsx(Ye,{value:ne.serie,onChange:O=>de(T=>({...T,serie:O.target.value}))})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Nmero (nNF)"}),a.jsx(Ye,{value:ne.nNF,onChange:O=>de(T=>({...T,nNF:O.target.value})),placeholder:"(opcional)"})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Destino da Operao (idDest)"}),a.jsxs(Nn,{value:ne.idDest||"",onValueChange:O=>de(T=>({...T,idDest:O})),children:[a.jsx(bn,{children:a.jsx(Cn,{placeholder:"Automtico"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"",children:"Automtico"}),a.jsx(tt,{value:"1",children:"Interna (mesmo estado)"}),a.jsx(tt,{value:"2",children:"Interestadual"}),a.jsx(tt,{value:"3",children:"Exterior"})]})]})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Consumidor Final (indFinal)"}),a.jsxs(Nn,{value:ne.indFinal,onValueChange:O=>de(T=>({...T,indFinal:O})),children:[a.jsx(bn,{children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"1",children:"Sim"}),a.jsx(tt,{value:"0",children:"No"})]})]})]}),a.jsxs("div",{children:[a.jsx(Le,{children:"Presena do Comprador (indPres)"}),a.jsxs(Nn,{value:ne.indPres,onValueChange:O=>de(T=>({...T,indPres:O})),children:[a.jsx(bn,{children:a.jsx(Cn,{})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"1",children:"Operao presencial"}),a.jsx(tt,{value:"2",children:"No presencial, internet"}),a.jsx(tt,{value:"4",children:"Entrega em domiclio"}),a.jsx(tt,{value:"9",children:"No se aplica"})]})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(me,{variant:"outline",onClick:()=>Z(!1),children:"Fechar"}),a.jsx(me,{onClick:En,disabled:ce,children:ce?"Gerando...":"Gerar XML"})]}),ie&&a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Prvia do XML Gerado"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(me,{size:"sm",variant:"outline",onClick:()=>eV(`nfe-${ue||"doc"}.xml`,ie),children:"Baixar XML"}),a.jsx(me,{size:"sm",onClick:ae,disabled:lt,children:lt?"Salvando...":"Salvar no Supabase"})]})]}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto border border-border rounded p-2 bg-surface-2",children:ie})]})]})})]})}function eV(e,t){try{const r=new Blob([t],{type:"text/xml;charset=utf-8"}),n=URL.createObjectURL(r),s=document.createElement("a");s.href=n,s.download=e,document.body.appendChild(s),s.click(),s.remove(),URL.revokeObjectURL(n)}catch{}}const $it=(e,t,r)=>e.split(/(\*\*.*?\*\*)/g).map((s,o)=>{if(s.startsWith("**")&&s.endsWith("**")){const i=s.slice(2,-2);return a.jsx("strong",{className:`font-black ${t?r?"text-white":"text-[#000000]":"text-white"}`,style:{fontWeight:900,textShadow:t?r?"0 0 1px rgba(0,0,0,0.25)":"0 0 1px rgba(0,0,0,0.3)":"0 0 1px rgba(255,255,255,0.5)"},children:i},o)}return s}),noe=({message:e})=>{const t=e.from==="isis",r=t&&e?.color==="green",n=t&&e?.color==="system",[s,o]=p.useState(!1),{selections:i}=EC(),{clientIdentified:l,userInitial:c}=p.useMemo(()=>{const u=i?.contato?.nome||i?.cliente?.nome||"",f=String(u).trim(),h=f?f[0]:"",m=h&&/[A-Za-z---]/.test(h)?h.toUpperCase():"U";return{clientIdentified:!!u,userInitial:m}},[i?.contato?.nome,i?.cliente?.nome]),d=async u=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(u);else{const f=document.createElement("textarea");f.value=u,f.style.position="fixed",f.style.top="0",f.style.left="0",f.style.opacity="0",document.body.appendChild(f),f.focus(),f.select(),document.execCommand("copy"),document.body.removeChild(f)}o(!0),setTimeout(()=>o(!1),1800)}catch{}};return a.jsx(jr.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,ease:[.22,1,.36,1]},className:`flex ${t?"justify-start":"justify-end"} mb-4 md:mb-6`,children:a.jsxs("div",{className:`flex items-end gap-2 md:gap-3 max-w-[90%] md:max-w-[85%] lg:max-w-[75%] ${!t&&"flex-row-reverse"}`,children:[t?a.jsx(tl,{size:"sm",variant:"message",className:"md:w-14 md:h-14"}):l?a.jsx("div",{className:"w-10 h-10 md:w-14 md:h-14 rounded-full flex items-center justify-center flex-shrink-0 bg-brand/10 text-brand ring-2 ring-brand/60",children:a.jsx("span",{className:"font-extrabold text-base md:text-lg leading-none select-none",children:c})}):a.jsx("div",{className:"w-10 h-10 md:w-14 md:h-14 rounded-full flex items-center justify-center flex-shrink-0 bg-surface border border-white/10 text-text-muted",children:a.jsx(Du,{className:"w-5 h-5 md:w-6 md:h-6"})}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:`relative px-3 py-2.5 md:px-5 md:py-3.5 backdrop-blur-sm transition-all duration-300 ${t?r?"bg-emerald-600/90 border border-emerald-400 text-white rounded-2xl rounded-bl-sm shadow-lg shadow-emerald-600/30":n?"bg-surface/70 border border-white/10 text-text-muted rounded-2xl rounded-bl-sm":"bg-brand border border-brand text-[#0A0A0A] rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20":"bg-surface/70 border border-white/10 text-text-primary rounded-2xl rounded-br-sm"}`,children:[a.jsx("p",{className:"text-[15px] md:text-[15px] font-bold leading-relaxed whitespace-pre-wrap tracking-wide relative",children:$it(e.text,t,r)}),e.copyable&&a.jsx("button",{type:"button",onClick:()=>d(e.copyText||(typeof e.text=="string"?e.text:"")),className:`absolute right-2 bottom-2 p-1.5 md:p-2 rounded-full border shadow-sm transition ${t?"bg-white/80 border-white/40 text-[#0A0A0A] hover:bg-white":"bg-white/10 border-white/10 text-text-primary hover:bg-white/20"}`,"aria-label":"Copiar texto",children:s?a.jsx(Uf,{className:"w-4 h-4"}):a.jsx(FH,{className:"w-4 h-4"})})]}),a.jsx("p",{className:`text-[10px] md:text-[10px] text-text-muted px-2 ${t?"text-left":"text-right"}`,children:ur(e.timestamp,"HH:mm")})]})]})})};function Bit(){const[e,t]=p.useState([]),[r,n]=p.useState(""),[s,o]=p.useState(!1),[i,l]=p.useState(""),[c,d]=p.useState(!0),u=p.useRef(null),{company:f,userProfile:h,user:m}=vs();p.useEffect(()=>{const b={id:Date.now()+Math.random(),from:"isis",text:"Ol! Eu sou a verso Premium da sis, integrada  OpenAI. Em que posso ajudar? ",timestamp:new Date};t([b])},[]),p.useEffect(()=>{const b=setTimeout(()=>{u.current?.scrollIntoView({behavior:"smooth",block:"end"})},100);return()=>clearTimeout(b)},[e,s]);const v=b=>{t(w=>[...w,{id:Date.now()+Math.random(),timestamp:new Date,...b}])},g=b=>{const w=String(b||"").toLowerCase();return w?w.includes("agend")||w.includes("agenda")?w.includes("hoje")?"Consultando os agendamentos de hoje...":w.includes("amanh")?"Consultando os agendamentos de amanh...":"Consultando seus agendamentos...":w.includes("cliente")?"Buscando informaes de clientes...":w.includes("caixa")||w.includes("faturamento")||w.includes("financeiro")||w.includes("venda")||w.includes("pagamento")?"Analisando movimentaes da sua arena...":w.includes("quadra")||w.includes("reserva")?"Verificando horrios e quadras disponveis...":"...":"..."},y=async(b,w)=>{try{const j=f?.codigoEmpresa||f?.codigo_empresa||null,_=h?.id||m?.id||null,C=h?.nome||m?.email||null,P=h?.cargo||null,E=new Date,A=new Date(E.getFullYear(),E.getMonth(),E.getDate(),0,0,0,0),F=new Date(A);F.setDate(F.getDate()+1);const D=A.toISOString(),I=F.toISOString(),R=Array.isArray(w)?w.map($=>({role:$.from==="isis"?"assistant":"user",content:$.text})):[],{data:M,error:U}=await he.functions.invoke("chat-proxy",{body:{message:b,empresaCodigo:j,usuarioId:_,usuarioNome:C,usuarioCargo:P,data_inicio:D,data_fim:I,history:R}});if(U)throw U;const z=typeof M?.reply=="string"&&M.reply.trim().length>0?M.reply:"Certo! (resposta provisria)";let W=Array.isArray(M?.replies)?M.replies.filter($=>typeof $=="string"&&$.trim().length>0):[];if(W.length===0&&(W=[z]),console.log("[sis][response]",{replies:W,raw:M}),M)try{console.log("[sis][response raw JSON]",JSON.stringify(M,null,2))}catch{}for(let $=0;$<W.length;$++){const ee=W[$];v({from:"isis",text:ee}),$<W.length-1&&await new Promise(ve=>setTimeout(ve,600))}o(!1),l("")}catch{v({from:"isis",text:"No momento, estou operando em modo de demonstrao. Em breve estarei 100% conectada  OpenAI aqui na aba Premium! "}),o(!1),l("")}},x=async b=>{b.preventDefault();const w=r.trim();if(!w)return;const j=[...e];console.log("[sis][question]",{message:w}),v({from:"user",text:w}),n(""),o(!0),l(g(w)),await y(w,j)};return a.jsxs("div",{className:"flex h-full w-full relative",children:[a.jsxs("div",{className:"flex-1 flex flex-col pointer-events-none",children:[a.jsxs("div",{className:"flex-1 overflow-y-auto px-3 md:px-6 py-4 md:py-6",children:[e.map(b=>a.jsx(noe,{message:b},b.id)),s&&a.jsx(jr.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start mb-4",children:a.jsx("div",{className:"px-4 py-2 rounded-2xl bg-brand border border-brand text-[#0A0A0A] flex items-center gap-2 animate-pulse",children:i&&i!=="..."?a.jsxs(a.Fragment,{children:[a.jsx("span",{role:"img","aria-label":"pensando",children:""}),a.jsx("span",{children:i})]}):a.jsx("span",{className:"font-semibold tracking-widest",children:"..."})})}),a.jsx("div",{ref:u})]}),a.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:a.jsxs("form",{onSubmit:x,className:"flex items-center gap-2 bg-surface/70 border border-white/10 rounded-xl px-3 py-2.5",children:[a.jsx(RH,{className:"w-5 h-5 text-text-muted"}),a.jsx("input",{value:r,onChange:b=>n(b.target.value),placeholder:"Escreva aqui",className:"flex-1 bg-transparent outline-none text-sm"}),a.jsxs("button",{type:"submit",disabled:!r.trim(),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-semibold transition ${r.trim()?"bg-brand text-bg":"bg-surface/40 text-text-muted cursor-not-allowed"}`,children:[a.jsx(u4,{className:"w-4 h-4"}),"Enviar"]})]})})]}),c&&a.jsx("div",{className:"absolute inset-0 z-10 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto rounded-lg overflow-hidden",children:a.jsx(jr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},transition:{duration:.5,ease:[.22,1,.36,1]},className:"rounded-2xl border border-white/30 bg-gradient-to-br from-slate-900 via-slate-900 to-slate-800 shadow-2xl max-w-sm w-full text-center mx-4 overflow-hidden",children:a.jsxs("div",{className:"px-8 py-10",children:[a.jsx(jr.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.2,duration:.4},className:"flex items-center justify-center mb-8",children:a.jsx("div",{className:"w-24 h-24 rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_20px_rgba(168,85,247,0.5)] overflow-hidden",children:a.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-background flex items-center justify-center",children:a.jsx(tl,{size:"lg"})})})}),a.jsxs(jr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},children:[a.jsx("div",{className:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300 mb-4",children:"sis"}),a.jsx("p",{className:"text-sm text-gray-300 mb-6 leading-relaxed",children:"Em breve sua assistente IA vai estar pronta para revolucionar a gesto da sua arena. "}),a.jsxs("div",{className:"space-y-3 text-left",children:[a.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[a.jsx("span",{className:"text-emerald-400 font-bold mt-0.5",children:""}),a.jsx("span",{children:"Gerencie agendamentos com inteligncia artificial"})]}),a.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[a.jsx("span",{className:"text-violet-400 font-bold mt-0.5",children:""}),a.jsx("span",{children:"Otimize sua agenda e maximize ocupao"})]}),a.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[a.jsx("span",{className:"text-fuchsia-400 font-bold mt-0.5",children:""}),a.jsx("span",{children:"Insights inteligentes sobre sua arena"})]})]})]})]})})})]})}function qit(){const{company:e}=vs(),t=e?.codigo_empresa||e?.codigoEmpresa||null,[r,n]=p.useState(!0),[s,o]=p.useState(null),[i,l]=p.useState(!1),[c,d]=p.useState(null),[u,f]=p.useState(""),[h,m]=p.useState(""),[v,g]=p.useState(!1),[y,x]=p.useState(!1),[b,w]=p.useState(!1),[j,_]=p.useState(""),[C,P]=p.useState(""),[E,A]=p.useState(""),[F,D]=p.useState(!1),[I,R]=p.useState({agendamentosIsisTotal:0,agendamentosIsisHoje:0,agendamentosIsis7d:0,agendamentosTotal7d:0,cancelamentosIsis7d:0,perDay7d:[],topQuadras30d:[],ultimasInteracoes:[]}),[M,U]=p.useState({}),z=J=>{if(!J)return"";const fe=J instanceof Date?J:new Date(J);if(isNaN(fe.getTime()))return"";const Z=fe.getFullYear(),ce=String(fe.getMonth()+1).padStart(2,"0"),le=String(fe.getDate()).padStart(2,"0");return`${Z}-${ce}-${le}`},W=J=>{if(!J)return null;const fe=new Date(`${J}T00:00:00`);return isNaN(fe.getTime())?null:fe},$=J=>{try{if(!J)return"";const fe=J instanceof Date?J:new Date(J);return isNaN(fe.getTime())?"":fe.toLocaleDateString("pt-BR")}catch{return""}};p.useEffect(()=>{if(!t||u||h)return;const J=new Date,fe=new Date;fe.setDate(fe.getDate()-6);const Z=z(fe),ce=z(J);try{console.log("[IsisAnalytics] Init default range (auto-fill):",{startYmd:Z,endYmd:ce})}catch{}f(Z),m(ce)},[t]),p.useEffect(()=>{!v||!e?.id||(async()=>{try{x(!0);const{data:J,error:fe}=await he.from("agenda_settings").select("isis_cancel_min_hours_before, isis_subdomain, isis_display_name").eq("empresa_id",e.id).single();if(fe&&fe.code!=="PGRST116")throw fe;if(J)_(J.isis_cancel_min_hours_before??""),P(J.isis_subdomain||""),A(J.isis_display_name||"");else{const Z=(e.nome_fantasia||"").toLowerCase().replace(/[^a-z0-9]+/g,"");P(Z),A(e.nome_fantasia||"")}}catch(J){console.error("[IsisSettings] Erro ao carregar:",J)}finally{x(!1)}})()},[v,e?.id,e?.nome_fantasia]);const ee=async()=>{if(e?.id)try{w(!0);const J=j===""?null:parseInt(j,10);if(J!==null&&(isNaN(J)||J<0)){alert("Horas de cancelamento deve ser um nmero >= 0"),w(!1);return}const fe=(C||"").toLowerCase().replace(/[^a-z0-9]+/g,"");if(!fe){alert("Subdomnio no pode estar vazio"),w(!1);return}const Z=(E||"").trim();if(!Z){alert("Nome de exibio no pode estar vazio"),w(!1);return}const{error:ce}=await he.from("agenda_settings").upsert({empresa_id:e.id,isis_cancel_min_hours_before:J,isis_subdomain:fe,isis_display_name:Z},{onConflict:"empresa_id"});if(ce)throw ce;P(fe),A(Z),D(!1),g(!1)}catch(J){console.error("[IsisSettings] Erro ao salvar:",J),alert("Erro ao salvar configuraes: "+(J?.message||"desconhecido"))}finally{w(!1)}},ve={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.1,delayChildren:.15}}},_e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}},K=({icon:J,title:fe,value:Z,color:ce="brand"})=>a.jsxs(jr.div,{variants:_e,className:"fx-card",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5",style:{color:`var(--${ce})`},children:a.jsx(J,{className:"h-5 w-5"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-2",children:fe}),a.jsx("p",{className:"text-3xl font-bold text-text-primary tabular-nums tracking-tight",children:Z})]})]}),q=p.useMemo(()=>(I.perDay7d||[]).map(J=>({name:new Date(J.date).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"}),total:J.total,isis:J.isis})),[I.perDay7d]);p.useEffect(()=>{let J=!0;return(async()=>{try{n(!0),o(null);const fe=xe=>{const st=new Date(xe);return st.setHours(0,0,0,0),st},Z=xe=>{const st=new Date(xe);return st.setHours(23,59,59,999),st},ce=fe(new Date),le=Z(new Date),ie=new Date;ie.setDate(ie.getDate()-6);const te=fe(ie),ue=le,Te=new Date;Te.setDate(Te.getDate()-29);const ne=fe(Te);console.log("[IsisAnalytics] codigoEmpresa:",t,"company obj:",e);const{count:de,error:lt}=await he.from("agendamentos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",t).eq("created_by_isis",!0);if(lt)throw lt;console.log("[IsisAnalytics] HOJE intervalo criado_em:",ce.toISOString(),"->",le.toISOString());let at=(await he.from("agendamentos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",t).eq("created_by_isis",!0).gte("criado_em",ce.toISOString()).lte("criado_em",le.toISOString()))?.count??null;if(at==null){const{data:xe}=await he.from("agendamentos").select("id").eq("codigo_empresa",t).eq("created_by_isis",!0).gte("criado_em",ce.toISOString()).lte("criado_em",le.toISOString());at=(xe||[]).length}console.log("[IsisAnalytics] agIsisHoje (count resolved):",at),console.log("[IsisAnalytics] 7d intervalo criado_em:",te.toISOString(),"->",ue.toISOString());const{data:gt}=await he.from("agendamentos").select("id, criado_em").eq("codigo_empresa",t).eq("created_by_isis",!0).gte("criado_em",te.toISOString()).lte("criado_em",ue.toISOString());console.log("[IsisAnalytics] agIsis7dRows length:",(gt||[]).length);const{data:Pt}=await he.from("agendamentos").select("id, inicio").eq("codigo_empresa",t).gte("inicio",te.toISOString()).lte("inicio",ue.toISOString());let Qe=(await he.from("agendamentos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",t).eq("canceled_by","isis").gte("canceled_at",te.toISOString()).lte("canceled_at",ue.toISOString()))?.count??null;if(Qe==null){const{data:xe}=await he.from("agendamentos").select("id").eq("codigo_empresa",t).eq("canceled_by","isis").gte("canceled_at",te.toISOString()).lte("canceled_at",ue.toISOString());Qe=(xe||[]).length}console.log("[IsisAnalytics] cancelamentosIsis7d (count resolved - canceled_by=isis):",Qe);const ge=Array.isArray(gt)?gt.length:0,rt=Array.isArray(Pt)?Pt.length:0,pt=xe=>{const st=new Date(xe);return st.setHours(0,0,0,0),st.toISOString().slice(0,10)},We={};for(let xe=0;xe<7;xe++){const st=new Date(te);st.setDate(te.getDate()+xe),We[pt(st)]={date:new Date(st),isis:0,total:0}}(Pt||[]).forEach(xe=>{const st=pt(xe.inicio);We[st]&&(We[st].total+=1)}),(gt||[]).forEach(xe=>{const st=xe.inicio||xe.criado_em,Ct=pt(st);We[Ct]&&(We[Ct].isis+=1)});const Ze=Object.values(We),{data:Ne}=await he.from("agendamentos").select("quadra_id").eq("codigo_empresa",t).eq("created_by_isis",!0).gte("inicio",ne.toISOString()).lte("inicio",le.toISOString()),ye=new Map;(Ne||[]).forEach(xe=>{xe?.quadra_id&&ye.set(xe.quadra_id,(ye.get(xe.quadra_id)||0)+1)});const Be=Array.from(ye.keys());let mt={};if(Be.length>0){const{data:xe}=await he.from("quadras").select("id, nome").in("id",Be);(xe||[]).forEach(st=>{mt[st.id]=st.nome})}const Ft=Array.from(ye.entries()).map(([xe,st])=>({id:xe,nome:mt[xe]||"Quadra",count:st})).sort((xe,st)=>st.count-xe.count).slice(0,5),{data:fr}=await he.from("agendamentos").select("modalidade").eq("codigo_empresa",t).eq("created_by_isis",!0).gte("inicio",ne.toISOString()).lte("inicio",le.toISOString()),It=new Map;(fr||[]).forEach(xe=>{const st=(xe?.modalidade||"").trim();st&&It.set(st,(It.get(st)||0)+1)});const Ut=Array.from(It.entries()).map(([xe,st])=>({nome:xe,count:st})).sort((xe,st)=>st.count-xe.count).slice(0,5);if(!J)return;R(xe=>({...xe,agendamentosIsisTotal:de||0,agendamentosIsisHoje:at||0,agendamentosIsis7d:ge,agendamentosTotal7d:rt,cancelamentosIsis7d:Qe||0,perDay7d:Ze,topQuadras30d:Ft,topModalidades30d:Ut})),n(!1)}catch(fe){if(!J)return;o(fe?.message||"Erro ao carregar mtricas"),n(!1)}})(),()=>{J=!1}},[t,e?.nome_fantasia,e?.razao_social]),p.useEffect(()=>{let J=!0;return(async()=>{if(t)try{l(!0),d(null);const fe=rt=>{const pt=new Date(rt);return pt.setHours(0,0,0,0),pt},Z=rt=>{const pt=new Date(rt);return pt.setHours(23,59,59,999),pt},le=z(new Date),ie=new Date;ie.setDate(ie.getDate()-6);const te=z(ie),ue=u||te,Te=h||le;let ne=he.from("agendamentos").select("id, codigo, inicio, fim, criado_em, status, cliente_id, clientes, quadra_id").eq("codigo_empresa",t).eq("created_by_isis",!0).order("criado_em",{ascending:!1});const de=!!(ue||Te);if(ue){const rt=fe(new Date(ue));ne=ne.gte("criado_em",rt.toISOString())}if(Te){const rt=Z(new Date(Te));ne=ne.lte("criado_em",rt.toISOString())}ne=ne.limit(de?200:10);try{console.log("[IsisAnalytics] Fetch lastAgs with range (effective):",{effStart:ue,effEnd:Te,hasAnyFilter:de,limit:de?200:10})}catch{}const{data:lt,error:Nt}=await ne;if(Nt){try{console.error("[IsisAnalytics] lastAgs query error:",Nt)}catch{}throw Nt}try{console.log("[IsisAnalytics] lastAgs length:",(lt||[]).length)}catch{}const at=Array.from(new Set((lt||[]).map(rt=>rt.cliente_id).filter(Boolean)));let gt={};if(at.length>0){const{data:rt}=await he.from("clientes").select("id, nome").in("id",at);(rt||[]).forEach(pt=>{gt[pt.id]=pt.nome})}const Pt=Array.from(new Set((lt||[]).map(rt=>rt.quadra_id).filter(Boolean)));let yt={};if(Pt.length>0){const{data:rt}=await he.from("quadras").select("id, nome").in("id",Pt);(rt||[]).forEach(pt=>{yt[pt.id]=pt.nome})}const Qe=(lt||[]).map(rt=>rt.id);let ge={};if(Qe.length>0){const{data:rt}=await he.from("agendamento_participantes").select("agendamento_id, nome, status_pagamento, valor_cota").in("agendamento_id",Qe).order("agendamento_id",{ascending:!0});(rt||[]).forEach(pt=>{ge[pt.agendamento_id]||(ge[pt.agendamento_id]=[]),ge[pt.agendamento_id].push(pt)})}if(!J)return;U({}),R(rt=>({...rt,ultimasInteracoes:(lt||[]).map(pt=>({...pt,cliente_nome:gt[pt.cliente_id]||null,participantes:ge[pt.id]||[],quadra_nome:yt[pt.quadra_id]||null}))})),l(!1)}catch(fe){if(!J)return;d(fe?.message||"Erro ao carregar agendamentos"),l(!1)}})(),()=>{J=!1}},[t,u,h]);const Y=p.useMemo(()=>e?.nome_fantasia||e?.razao_social||"sua arena",[e]);return a.jsxs(jr.div,{variants:ve,initial:"hidden",animate:"visible",className:"space-y-4",children:[a.jsxs(jr.div,{variants:_e,className:"bg-surface/70 backdrop-blur-sm relative p-4 md:p-6 rounded-xl border border-white/10 overflow-hidden shadow-1",children:[a.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.03] mix-blend-overlay"}),a.jsxs("div",{className:"relative z-10 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)] flex-shrink-0",children:a.jsx("div",{className:"rounded-full overflow-hidden bg-background w-10 h-10 sm:w-12 sm:h-12 grid place-items-center",children:a.jsx(tl,{size:"xs",className:"w-10 h-10 sm:w-12 sm:h-12"})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-black text-text-primary tracking-tight flex items-center gap-2 flex-wrap",children:[a.jsx(Bj,{className:"h-5 w-5 sm:h-6 sm:w-6 text-brand flex-shrink-0"}),a.jsx("span",{className:"truncate",children:"Anlises da sis"})]}),a.jsxs("p",{className:"text-xs sm:text-sm text-text-secondary mt-1 line-clamp-2",children:["Como a sis est ajudando ",Y," a converter conversas em reservas."]})]})]}),a.jsx("button",{type:"button",onClick:()=>g(!0),className:"inline-flex items-center justify-center w-10 h-10 sm:w-11 sm:h-11 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-text-secondary hover:text-text-primary flex-shrink-0 self-end sm:self-auto",title:"Configuraes da sis",children:a.jsx(bd,{className:"h-5 w-5"})})]})]}),r?a.jsxs(jr.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center py-20 gap-4",children:[a.jsx("div",{className:"relative",children:a.jsx("div",{className:"rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_20px_rgba(168,85,247,0.4)] animate-pulse",children:a.jsx("div",{className:"rounded-full overflow-hidden bg-background w-20 h-20 grid place-items-center",children:a.jsx(tl,{size:"sm",className:"w-20 h-20"})})})}),a.jsxs("div",{className:"flex items-center gap-2 text-text-muted",children:[a.jsx(md,{className:"h-5 w-5 animate-spin"}),a.jsx("span",{className:"text-sm font-medium",children:"Carregando anlises da sis..."})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-4 w-full max-w-md",children:[a.jsx("div",{className:"h-24 bg-white/5 rounded-lg animate-pulse"}),a.jsx("div",{className:"h-24 bg-white/5 rounded-lg animate-pulse"}),a.jsx("div",{className:"h-24 bg-white/5 rounded-lg animate-pulse"})]})]}):s?a.jsx("div",{className:"text-danger text-sm",children:s}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(K,{icon:tC,title:"Agendamentos feitos (hoje)",value:I.agendamentosIsisHoje,color:"success"}),a.jsx(K,{icon:Vf,title:"Agendamentos feitos (7 dias)",value:I.agendamentosIsis7d,color:"info"}),a.jsx(K,{icon:Bp,title:"Cancelamentos",value:I.cancelamentosIsis7d,color:"danger"})]}),a.jsxs(jr.div,{variants:_e,className:"fx-card",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("h2",{className:"text-base font-bold text-text-primary flex items-center",children:[a.jsx(Vf,{className:"mr-2 h-5 w-5 text-brand"}),"Distribuio  ltimos 7 dias"]})}),a.jsx("div",{className:"px-1 pb-2",children:a.jsx(eb,{width:"100%",height:220,children:a.jsxs(uee,{data:q,margin:{top:8,right:12,left:0,bottom:0},children:[a.jsx(ZN,{strokeDasharray:"3 3",stroke:"var(--border)",opacity:.5}),a.jsx(Eh,{dataKey:"name",tick:{fontSize:11,fill:"var(--text-muted)"},tickLine:!1,axisLine:{stroke:"var(--border)"}}),a.jsx(kh,{allowDecimals:!1,tick:{fontSize:11,fill:"var(--text-muted)"},tickLine:!1,axisLine:{stroke:"var(--border)"},width:28}),a.jsx(Bl,{cursor:{stroke:"var(--border)",strokeDasharray:"3 3"},contentStyle:{background:"rgba(10,10,10,0.85)",borderColor:"var(--border)",color:"var(--text-primary)",borderRadius:"8px"},formatter:J=>[J,"sis (feitos)"]}),a.jsx(k0,{type:"monotone",dataKey:"isis",name:"sis (feitos)",stroke:"var(--brand)",strokeWidth:2.2,dot:{r:3,strokeWidth:1.5,stroke:"var(--brand)",fill:"var(--background)"},activeDot:{r:5}})]})})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs(jr.div,{variants:_e,className:"fx-card",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("h2",{className:"text-base font-bold text-text-primary",children:"Top quadras  ltimos 30 dias (sis)"})}),I.topQuadras30d.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhum agendamento nos ltimos 30 dias."}):a.jsx("ul",{className:"divide-y divide-border",children:I.topQuadras30d.map(J=>a.jsxs("li",{className:"py-2 text-sm flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:J.nome}),a.jsx("span",{className:"text-text-muted",children:J.count})]},J.id))})]}),a.jsxs(jr.div,{variants:_e,className:"fx-card",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("h2",{className:"text-base font-bold text-text-primary",children:"Top modalidades  ltimos 30 dias (sis)"})}),!I.topModalidades30d||I.topModalidades30d.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados recentes."}):a.jsx("ul",{className:"divide-y divide-border",children:I.topModalidades30d.map((J,fe)=>a.jsxs("li",{className:"py-2 text-sm flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:J.nome}),a.jsx("span",{className:"text-text-muted",children:J.count})]},`${J.nome}-${fe}`))})]})]})]}),!r&&a.jsxs(jr.div,{variants:_e,className:"fx-card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-sm sm:text-base font-bold text-text-primary",children:"ltimos agendamentos criados pela sis"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{type:"button",variant:"ghost",className:"h-9 px-3 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-xs font-semibold text-text-primary",title:"Data incio (criado em)",children:[a.jsx(Vs,{className:"h-4 w-4 text-text-secondary"}),a.jsx("span",{children:u?$(W(u)):"Incio"})]})}),a.jsx(Jo,{className:"w-auto p-0",children:a.jsx(ui,{mode:"single",selected:W(u)||void 0,onSelect:J=>f(J?z(J):""),locale:la,initialFocus:!0})})]}),a.jsx("span",{className:"text-xs text-text-secondary select-none",children:"at"}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{type:"button",variant:"ghost",className:"h-9 px-3 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-xs font-semibold text-text-primary",title:"Data fim (criado em)",children:[a.jsx(Vs,{className:"h-4 w-4 text-text-secondary"}),a.jsx("span",{children:h?$(W(h)):"Fim"})]})}),a.jsx(Jo,{className:"w-auto p-0",children:a.jsx(ui,{mode:"single",selected:W(h)||void 0,onSelect:J=>m(J?z(J):""),locale:la,initialFocus:!0})})]})]}),null]})]}),a.jsxs("div",{className:"sm:hidden mb-3 rounded-lg border border-white/10 bg-white/5 p-2",children:[a.jsxs("div",{className:"grid [grid-template-columns:1fr_auto_1fr] gap-2 mb-2",children:[a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{type:"button",variant:"ghost",className:"w-full h-9 px-3 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-xs font-semibold text-text-primary justify-between",title:"Data incio (criado em)",children:[a.jsx(Vs,{className:"h-4 w-4 text-text-secondary"}),a.jsx("span",{className:"truncate",children:u?$(W(u)):"Incio"})]})}),a.jsx(Jo,{className:"w-auto p-0",children:a.jsx(ui,{mode:"single",selected:W(u)||void 0,onSelect:J=>f(J?z(J):""),locale:la,initialFocus:!0})})]}),a.jsx("div",{className:"flex items-center justify-center text-xs text-text-secondary select-none",children:"at"}),a.jsxs(ci,{children:[a.jsx(di,{asChild:!0,children:a.jsxs(me,{type:"button",variant:"ghost",className:"w-full h-9 px-3 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-xs font-semibold text-text-primary justify-between",title:"Data fim (criado em)",children:[a.jsx(Vs,{className:"h-4 w-4 text-text-secondary"}),a.jsx("span",{className:"truncate",children:h?$(W(h)):"Fim"})]})}),a.jsx(Jo,{className:"w-auto p-0",children:a.jsx(ui,{mode:"single",selected:W(h)||void 0,onSelect:J=>m(J?z(J):""),locale:la,initialFocus:!0})})]})]}),null]}),i?a.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm py-6",children:[a.jsx(md,{className:"h-4 w-4 animate-spin"}),a.jsx("span",{children:"Carregando agendamentos..."})]}):c?a.jsx("div",{className:"text-danger text-sm",children:c}):I.ultimasInteracoes.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhum agendamento recente."}):a.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:a.jsx("div",{className:"inline-block min-w-full align-middle",children:a.jsx("div",{className:"overflow-hidden",children:a.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-text-secondary border-b border-white/10",children:[a.jsx("th",{className:"w-8 py-2 pl-4 sm:pl-0"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap",children:"Cdigo"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap",children:"Cliente"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap hidden sm:table-cell",children:"Quadra"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap",children:"Data"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap hidden md:table-cell",children:"Horrio"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap",children:"Status"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap hidden lg:table-cell",children:"Participantes"}),a.jsx("th",{className:"text-left py-2 pr-4 sm:pr-2 whitespace-nowrap hidden xl:table-cell",children:"Criado em"})]})}),a.jsx("tbody",{children:I.ultimasInteracoes.map(J=>{const fe=J.inicio?new Date(J.inicio):null,Z=J.fim?new Date(J.fim):null,ce=fe?fe.toLocaleDateString():"-",le=fe&&Z?`${fe.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})} - ${Z.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:"-",ie=Array.isArray(J.participantes)?J.participantes.length:Array.isArray(J.clientes)?J.clientes.length:0,te=!!M[J.id],ue=()=>U(lt=>({...lt,[J.id]:!lt[J.id]})),Te=String(J.status||"").toLowerCase(),de={scheduled:{label:"Agendado",cls:"bg-info/15 text-info border border-info/20"},confirmed:{label:"Confirmado",cls:"bg-success/15 text-success border border-success/20"},in_progress:{label:"Em andamento",cls:"bg-brand/15 text-brand border border-brand/20"},finished:{label:"Finalizado",cls:"bg-success/15 text-success border border-success/20"},canceled:{label:"Cancelado",cls:"bg-danger/15 text-danger border border-danger/20"},no_show:{label:"No-show",cls:"bg-warning/15 text-warning border border-warning/20"}}[Te]||{label:J.status||"",cls:"bg-white/10 text-text-secondary border border-white/15"};return a.jsxs(a.Fragment,{children:[a.jsxs("tr",{className:`border-b border-white/10 align-top ${te?"bg-white/[0.03]":"hover:bg-white/[0.02]"} transition-colors`,children:[a.jsx("td",{className:"py-2 pl-4 sm:pl-0",children:a.jsx("button",{type:"button","aria-label":te?"Recolher":"Expandir",onClick:lt=>{lt.stopPropagation(),ue()},className:`inline-flex items-center justify-center w-6 h-6 rounded-md border border-white/10 hover:bg-white/5 transition-colors ${te?"rotate-180":""}`,children:a.jsx(wg,{className:"w-3 h-3 sm:w-4 sm:h-4 text-text-secondary"})})}),a.jsxs("td",{className:"py-2 pr-2 font-semibold text-text-primary whitespace-nowrap",children:["#",J.codigo]}),a.jsx("td",{className:"py-2 pr-2 max-w-[120px] truncate",children:J.cliente_nome||Array.isArray(J.clientes)&&J.clientes[0]||""}),a.jsx("td",{className:"py-2 pr-2 hidden sm:table-cell max-w-[100px] truncate",children:J.quadra_nome||""}),a.jsx("td",{className:"py-2 pr-2 whitespace-nowrap",children:ce}),a.jsx("td",{className:"py-2 pr-2 hidden md:table-cell whitespace-nowrap text-xs",children:le}),a.jsx("td",{className:"py-2 pr-2",children:a.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 rounded-full text-[10px] sm:text-[11px] font-bold tracking-wide whitespace-nowrap ${de.cls}`,children:de.label})}),a.jsx("td",{className:"py-2 pr-2 hidden lg:table-cell",children:a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white/10 text-text-primary text-xs font-semibold",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand/70"}),ie]})}),a.jsx("td",{className:"py-2 pr-4 sm:pr-2 hidden xl:table-cell text-xs whitespace-nowrap",children:J.criado_em?new Date(J.criado_em).toLocaleString():"-"})]},J.id),te&&a.jsx("tr",{children:a.jsxs("td",{colSpan:9,className:"p-3 sm:p-4 bg-white/[0.035] border-b border-white/10",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider text-text-muted",children:"Criado em"}),a.jsx("div",{className:"font-medium text-text-primary text-xs sm:text-sm",children:J.criado_em?new Date(J.criado_em).toLocaleString():"-"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider text-text-muted",children:"Incio"}),a.jsx("div",{className:"font-medium text-text-primary text-xs sm:text-sm",children:J.inicio?new Date(J.inicio).toLocaleString():"-"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider text-text-muted",children:"Trmino"}),a.jsx("div",{className:"font-medium text-text-primary text-xs sm:text-sm",children:J.fim?new Date(J.fim).toLocaleString():"-"})]})]}),a.jsxs("div",{className:"sm:hidden mb-3 grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wider text-text-muted",children:"Quadra"}),a.jsx("div",{className:"font-medium text-text-primary text-xs truncate",children:J.quadra_nome||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wider text-text-muted",children:"Horrio"}),a.jsx("div",{className:"font-medium text-text-primary text-xs",children:le})]})]}),a.jsxs("div",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider text-text-muted mb-2",children:["Participantes (",ie,")"]}),Array.isArray(J.participantes)&&J.participantes.length>0?a.jsx("ul",{className:"grid grid-cols-1 gap-1.5",children:J.participantes.map((lt,Nt)=>a.jsxs("li",{className:"flex items-center justify-between py-1.5 px-2 sm:px-3 rounded-md border border-white/10 bg-white/5 gap-2",children:[a.jsx("span",{className:"text-text-primary font-medium text-xs sm:text-sm truncate flex-1",children:lt.nome}),a.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 rounded-full text-[10px] sm:text-[11px] font-bold tracking-wide whitespace-nowrap flex-shrink-0 ${lt.status_pagamento==="Pago"?"bg-success/15 text-success border border-success/20":"bg-warning/15 text-warning border border-warning/20"}`,children:lt.status_pagamento})]},Nt))}):a.jsx("div",{className:"text-text-muted text-xs sm:text-sm",children:"Sem participantes cadastrados"})]})})]})})})]})})})})]}),v&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>g(!1),children:a.jsxs(jr.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-surface border border-white/10 rounded-xl shadow-2xl w-full max-w-lg p-6 space-y-4",onClick:J=>J.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h2",{className:"text-xl font-bold text-text-primary flex items-center gap-2",children:[a.jsx(bd,{className:"h-5 w-5 text-brand"})," Configuraes da sis"]}),a.jsx("button",{type:"button",onClick:()=>g(!1),className:"inline-flex items-center justify-center w-8 h-8 rounded-lg hover:bg-white/10 transition-colors text-text-secondary hover:text-text-primary",children:a.jsx(Bp,{className:"h-5 w-5"})})]}),y?a.jsxs("div",{className:"flex items-center gap-2 text-text-muted py-8 justify-center",children:[a.jsx(md,{className:"h-5 w-5 animate-spin"})," Carregando..."]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-text-primary",children:"Cancelamento (horas antes)"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Tempo mnimo (em horas) antes do agendamento para permitir cancelamento via sis."}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"number",min:"0",step:"1",value:j,onChange:J=>_(J.target.value),placeholder:"Ex: 2",className:"w-24 px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-text-primary text-center placeholder:text-text-muted focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-all"}),a.jsx("span",{className:"text-sm text-text-muted",children:"horas"})]}),a.jsx("p",{className:"text-xs text-text-muted italic",children:"Deixe vazio para permitir cancelamento a qualquer momento."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-text-primary",children:"Nome de exibio"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Nome que aparecer no header da pgina de agendamento da sis."}),a.jsx("input",{type:"text",value:E,onChange:J=>A(J.target.value),placeholder:"Arena Palace",className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder:text-text-muted focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-all"}),a.jsx("p",{className:"text-xs text-text-muted italic",children:"Este  o nome que seus clientes vero ao acessar a sis."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-text-primary",children:"Link de agendamento"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Personalize o subdomnio do link de agendamento da sis."}),F?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:C,onChange:J=>P(J.target.value.toLowerCase().replace(/[^a-z0-9]+/g,"")),placeholder:"arenapalace",autoFocus:!0,className:"flex-1 px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder:text-text-muted focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-all"}),a.jsx("span",{className:"text-sm text-text-muted",children:".f7arena.com"})]}):a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white/5 border border-white/10 rounded-lg group hover:border-white/20 transition-all cursor-pointer",onClick:()=>D(!0),children:[a.jsxs("span",{className:"flex-1 text-text-primary font-mono",children:[C||"arenapalace",".f7arena.com"]}),a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-md hover:bg-white/10 transition-colors text-text-muted group-hover:text-text-primary",title:"Editar subdomnio",children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),a.jsx("path",{d:"m15 5 4 4"})]})})]})]}),a.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{g(!1),D(!1)},disabled:b,className:"flex-1 px-4 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 transition-colors text-text-secondary hover:text-text-primary font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),a.jsx("button",{type:"button",onClick:ee,disabled:b,className:"flex-1 px-4 py-2 rounded-lg bg-brand hover:bg-brand/90 transition-colors text-white font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:b?a.jsxs(a.Fragment,{children:[a.jsx(md,{className:"h-4 w-4 animate-spin"})," Salvando..."]}):"Salvar"})]})]})]})})]})}function zit({open:e,onOpenChange:t,codigoEmpresa:r,onSuccess:n}){const{toast:s}=as(),[o,i]=p.useState("upload"),[l,c]=p.useState(null),[d,u]=p.useState(null),[f,h]=p.useState(!1),[m,v]=p.useState({success:!1,comandaId:null,error:null}),g=async j=>{const _=j.target.files?.[0];if(_){if(!_.name.endsWith(".xml")){s({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}c(_);try{const C=await _.text(),P=PS(C);if(!P.success){s({title:"Erro ao ler XML",description:P.error||"XML invlido",variant:"destructive"});return}if(!P.produtos||P.produtos.length===0){s({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(P.nfe?.tipo!=="Sada"){s({title:"Tipo de nota incorreto",description:"Este XML  de entrada. Use a importao em Produtos para notas de entrada.",variant:"warning"});return}u(P),i("preview")}catch(C){console.error("[XMLSalesImport] Erro ao processar arquivo:",C),s({title:"Erro ao processar XML",description:C.message,variant:"destructive"})}}},y=async()=>{i("processing"),h(!0);try{const j=await hu({searchTerm:"",limit:1e4,codigoEmpresa:r}),_=d.nfe?.dataEmissao?new Date(d.nfe.dataEmissao):new Date,C=d.nfe?.chaveAcesso||"",{data:P,error:E}=await he.from("comandas").insert({codigo_empresa:r,mesa_id:null,status:"closed",aberto_em:_.toISOString(),fechado_em:_.toISOString(),observacao:`Importado de XML - NF-e ${d.nfe?.numero||""}${C?`
Chave: ${C}`:""}`,origem:"xml",xml_chave:C||null}).select().single();if(E)throw E;const A=[],F=[];for(const I of d.produtos){const R=ES(I,j);if(R){A.push({comanda_id:P.id,produto_id:R.id,descricao:I.nome,quantidade:I.quantidade,preco_unitario:I.valorUnitario,desconto:I.desconto||0,codigo_empresa:r});const M=Math.max(0,(R.stock||R.estoque||0)-I.quantidade);await he.from("produtos").update({estoque:M}).eq("id",R.id).eq("codigo_empresa",r)}else F.push(I.nome)}if(A.length>0){const{error:I}=await he.from("comanda_itens").insert(A);if(I)throw I}const D=d.pagamentos||[];if(D.length>0){const{data:I}=await he.from("finalizadoras").select("id, codigo_sefaz, nome").eq("codigo_empresa",r).eq("ativo",!0),R=new Map((I||[]).map(z=>[z.codigo_sefaz,z])),M=D.map(z=>{const W=R.get(z.codigoSefaz);return{comanda_id:P.id,finalizadora_id:W?.id||null,metodo:z.descricao.toLowerCase(),valor:z.valor,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:C||null}}),{error:U}=await he.from("pagamentos").insert(M);if(U)throw U}else{const I=d.produtos.reduce((M,U)=>M+(U.valorTotal||0),0),{error:R}=await he.from("pagamentos").insert({comanda_id:P.id,finalizadora_id:null,metodo:"outros",valor:I,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:C||null});if(R)throw R}console.log("[XMLSalesImport] Venda importada com sucesso. Comanda ID:",P.id),F.length>0?s({title:"Venda importada com avisos",description:`${A.length} produto(s) registrado(s), ${F.length} no encontrado(s).`,variant:"warning",duration:5e3}):s({title:"Venda importada com sucesso!",description:`${A.length} produto(s) registrado(s). Total: R$ ${w.toFixed(2)}`,variant:"success"}),v({success:!0,comandaId:P.id,error:null,produtosNaoEncontrados:F,totalItens:A.length,totalVenda:w,dataEmissao:_.toISOString().slice(0,10)}),i("done"),n&&n(_.toISOString().slice(0,10))}catch(j){console.error("[XMLSalesImport] Erro ao importar:",j),v({success:!1,comandaId:null,error:j.message}),i("done"),s({title:"Erro ao importar XML",description:j.message,variant:"destructive"})}finally{h(!1)}},x=()=>{i("upload"),c(null),u(null),v({success:!1,comandaId:null,error:null}),t(!1)},b=()=>{i("upload"),c(null),u(null)},w=d?.produtos?.reduce((j,_)=>j+(_.valorTotal||0),0)||0;return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(vn,{className:"max-w-3xl max-h-[90vh] flex flex-col overflow-hidden",children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-2xl font-bold",children:"Importar XML de Venda (NF-e)"}),a.jsxs(Dn,{children:[o==="upload"&&"Selecione o arquivo XML da nota fiscal de sada",o==="preview"&&"Revise os dados da venda que ser importada",o==="processing"&&"Processando venda...",o==="done"&&"Importao finalizada"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-1",children:[o==="upload"&&a.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("label",{htmlFor:"xml-sales-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[a.jsx(m4,{className:"w-12 h-12 mb-4 text-text-muted"}),a.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),a.jsx("p",{className:"text-xs text-text-muted",children:"XML de NF-e de Sada (Venda)"})]}),a.jsx("input",{id:"xml-sales-upload",type:"file",accept:".xml",className:"hidden",onChange:g})]}),l&&a.jsxs("div",{className:"mt-4 p-3 bg-surface-2 rounded-lg flex items-center gap-2",children:[a.jsx(Go,{className:"w-5 h-5 text-success"}),a.jsx("span",{className:"text-sm text-text-primary",children:l.name})]})]})}),o==="preview"&&a.jsxs("div",{className:"space-y-4",children:[d?.nfe&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Informaes da NF-e"}),d.fornecedor&&a.jsxs("div",{className:"mb-3 pb-3 border-b border-border",children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary mb-1",children:d.fornecedor.razaoSocial||d.fornecedor.nomeFantasia||"Fornecedor"}),a.jsxs("div",{className:"text-xs text-text-muted",children:[d.fornecedor.cnpj&&`CNPJ: ${d.fornecedor.cnpj}`,d.fornecedor.endereco?.cidade&&d.fornecedor.endereco?.uf&&`  ${d.fornecedor.endereco.cidade}/${d.fornecedor.endereco.uf}`]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",a.jsx("span",{className:"font-mono",children:d.nfe.numero})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",a.jsx("span",{className:"font-mono",children:d.nfe.serie})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",a.jsx("span",{className:"text-warning font-semibold",children:d.nfe.tipo})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Data:"})," ",a.jsx("span",{children:new Date(d.nfe.dataEmissao).toLocaleDateString("pt-BR")})]})]}),d.nfe.naturezaOperacao&&a.jsxs("div",{className:"mb-2 text-sm",children:[a.jsx("span",{className:"text-text-muted",children:"Natureza:"})," ",a.jsx("span",{className:"font-medium",children:d.nfe.naturezaOperacao})]}),d.nfe.totalNota!==void 0&&a.jsxs("div",{className:"mb-3 text-sm",children:[a.jsx("span",{className:"text-text-muted",children:"Total da Nota:"})," ",a.jsxs("span",{className:"font-mono font-semibold text-lg text-success",children:["R$ ",d.nfe.totalNota.toFixed(2)]})]}),d.nfe.chaveAcesso&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[a.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),a.jsx("p",{className:"font-mono text-xs break-all",children:d.nfe.chaveAcesso})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("h3",{className:"font-semibold mb-3",children:["Produtos da Venda (",d.produtos.length,")"]}),a.jsx("div",{className:"space-y-2",children:d.produtos.map((j,_)=>a.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-start gap-3",children:[a.jsx(i1,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm truncate",children:j.nome}),a.jsxs("p",{className:"text-xs text-text-muted",children:[j.codigo&&`Cdigo: ${j.codigo}  `,"Qtd: ",j.quantidade," ",j.unidade]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valorTotal.toFixed(2)]}),a.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: R$ ",j.valorUnitario.toFixed(2)]})]})]})})]},_))})]}),d.pagamentos&&d.pagamentos.length>0&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("h3",{className:"font-semibold mb-3",children:["Formas de Pagamento (",d.pagamentos.length,")"]}),a.jsx("div",{className:"space-y-2",children:d.pagamentos.map((j,_)=>a.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-sm",children:j.descricao}),a.jsxs("p",{className:"text-xs text-text-muted",children:["Cdigo SEFAZ: ",j.codigoSefaz]})]}),a.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valor.toFixed(2)]})]},_))})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Ic,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm mb-1",children:"Ateno: Venda Externa"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Esta venda ser registrada no histrico como uma venda externa (importada de XML). O estoque dos produtos ser subtrado automaticamente."})]})]})}),a.jsxs("div",{className:"flex items-center justify-between text-lg font-bold",children:[a.jsx("span",{children:"Total da Venda:"}),a.jsxs("span",{className:"text-success",children:["R$ ",w.toFixed(2)]})]})]}),o==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(md,{className:"w-12 h-12 animate-spin text-warning mb-4"}),a.jsx("p",{className:"text-lg font-semibold",children:"Processando venda..."}),a.jsx("p",{className:"text-sm text-text-muted",children:"Criando comanda e atualizando estoque"})]}),o==="done"&&a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:m.success?a.jsxs(a.Fragment,{children:[a.jsx(Do,{className:"w-16 h-16 text-success mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Venda Importada com Sucesso!"}),a.jsx("p",{className:"text-sm text-text-muted mb-4",children:"A venda foi registrada no histrico"}),m.produtosNaoEncontrados&&m.produtosNaoEncontrados.length>0&&a.jsxs("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-3 text-left",children:[a.jsx("p",{className:"text-sm font-semibold mb-2",children:" Produtos no encontrados:"}),a.jsx("ul",{className:"text-xs text-text-muted space-y-1",children:m.produtosNaoEncontrados.map((j,_)=>a.jsxs("li",{children:[" ",j]},_))})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(Ic,{className:"w-16 h-16 text-danger mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Erro na Importao"}),a.jsx("p",{className:"text-sm text-text-muted",children:m.error||"Ocorreu um erro ao importar a venda"})]})})})]}),a.jsxs(ra,{children:[o==="upload"&&a.jsx(me,{variant:"outline",onClick:x,children:"Cancelar"}),o==="preview"&&a.jsxs(a.Fragment,{children:[a.jsx(me,{variant:"outline",onClick:b,children:"Voltar"}),a.jsx(me,{onClick:y,children:"Confirmar Importao"})]}),o==="done"&&a.jsx(me,{onClick:x,children:"Fechar"})]})]})})}const Uit={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},jy={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function Vit(e,t=300){const[r,n]=p.useState(e);return p.useEffect(()=>{const s=setTimeout(()=>n(e),t);return()=>clearTimeout(s)},[e,t]),r}function Sj({value:e,onChange:t}){const[r,n]=p.useState(!1),s=p.useRef(null),o=p.useRef(null),i=p.useRef(null),[l,c]=p.useState({top:0,left:0,width:0,center:!1,mode:"fixed"});p.useEffect(()=>{function g(b){const w=b.target,j=s.current&&s.current.contains(w),_=i.current&&i.current.contains(w);!j&&!_&&n(!1)}function y(b){b.key==="Escape"&&n(!1)}function x(){r&&d()}return window.addEventListener("mousedown",g),window.addEventListener("keydown",y),window.addEventListener("scroll",x,!0),window.addEventListener("resize",x),()=>{window.removeEventListener("mousedown",g),window.removeEventListener("keydown",y),window.removeEventListener("scroll",x,!0),window.removeEventListener("resize",x)}},[r]),p.useEffect(()=>{if(r){const g=requestAnimationFrame(()=>{d();const y=requestAnimationFrame(()=>d());return()=>cancelAnimationFrame(y)});return()=>cancelAnimationFrame(g)}},[r]),p.useEffect(()=>{if(r&&l.mode==="overlay"){const g=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=g}}},[r,l.mode]);const d=()=>{try{const g=o.current;if(!g)return;const y=g.getBoundingClientRect(),x=window.innerWidth,b=window.innerHeight,w=8,j=Math.max(y.width,280),_=Math.min(x-w*2,360),C=Math.min(j,_);let P=320;if(i.current)try{P=i.current.getBoundingClientRect().height||P}catch{}if(x<=640){c({top:0,left:0,width:Math.min(x-w*2,360),center:!0,mode:"overlay"});return}const E=s.current,A=E?E.getBoundingClientRect():y,F=y.bottom-A.top+6,D=Math.max(y.width,280);c({top:F,left:0,width:D,center:!1,mode:"anchor"})}catch{}},u=g=>{try{const[y,x,b]=String(g||"").split("-").map(Number);return!y||!x||!b?null:new Date(y,x-1,b)}catch{return null}},f=g=>{const y=x=>String(x).padStart(2,"0");return`${g.getFullYear()}-${y(g.getMonth()+1)}-${y(g.getDate())}`},h=g=>{const y=x=>String(x).padStart(2,"0");return`${y(g.getDate())}/${y(g.getMonth()+1)}/${g.getFullYear()}`},m=u(e),v=m?h(m):"";return a.jsxs("div",{className:"relative",ref:s,children:[a.jsx("button",{type:"button",className:"absolute left-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-warning/10 focus:outline-none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},"aria-label":"Abrir calendrio",children:a.jsx(vue,{className:"h-4 w-4 text-warning"})}),typeof window<"u"&&window.innerWidth<=640?a.jsx("button",{type:"button",ref:o,onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(!0),setTimeout(d,0)},className:"pl-9 pr-3 h-10 w-full text-left bg-surface text-text-primary border border-warning/40 rounded-md",children:v||"Selecionar data"}):a.jsx(Ye,{type:"text",readOnly:!0,ref:o,inputMode:"none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},className:"pl-9 pr-3 w-full bg-surface text-text-primary border border-warning/40 focus-visible:ring-warning focus-visible:border-warning",value:v}),r&&(l.mode==="overlay"?a.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",onClick:g=>{g.target===g.currentTarget&&n(!1)},children:a.jsx("div",{ref:i,className:"bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 w-[92vw] max-w-[360px]",children:a.jsx(ui,{mode:"single",selected:m||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})})}):l.mode==="anchor"?a.jsx("div",{ref:i,className:"absolute z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 left-0",style:{top:`${l.top}px`,minWidth:`${l.width}px`,maxWidth:"92vw"},children:a.jsx(ui,{mode:"single",selected:m||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}):a.jsx("div",{ref:i,className:"fixed z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2",style:{top:`${l.top}px`,left:`${l.left}px`,width:`${l.width}px`,maxWidth:"92vw"},children:a.jsx(ui,{mode:"single",selected:m||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}))]})}function Wit(){const{toast:e}=as(),t=Ri(),{userProfile:r}=vs(),[n]=eC(),s=n.get("mesa"),[o,i]=p.useState(!1),[l,c]=p.useState([]),[d,u]=p.useState(()=>s?"":new Date().toISOString().slice(0,10)),[f,h]=p.useState(()=>s?"":new Date().toISOString().slice(0,10)),[m,v]=p.useState(()=>s?"all":"closed"),[g,y]=p.useState(""),x=Vit(g,350),[b,w]=p.useState("all"),[j,_]=p.useState("comandas"),[C,P]=p.useState(!1),[E,A]=p.useState(""),[F,D]=p.useState(null),[I,R]=p.useState({loading:!1,itens:[],pagamentos:[]}),[M,U]=p.useState(null),[z,W]=p.useState({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null},movs:[]}),[$,ee]=p.useState(!1),[ve,_e]=p.useState(!1),[K,q]=p.useState(null),[Y,J]=p.useState([]),fe=async xe=>{try{_e(!0);const st=rt();if(!st)throw new Error("Empresa no detectada");const{payload:Ct,missing:ar}=await xv({comandaId:xe,codigoEmpresa:st});q(Ct),J(ar||[]),ee(!0)}catch(st){e({title:"Falha ao gerar prvia",description:st?.message||"Tente novamente",variant:"destructive"})}finally{_e(!1)}},[Z,ce]=p.useState(!1),[le,ie]=p.useState(!1),[te,ue]=p.useState(!1),Te=async()=>{try{e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"});const xe=await lz({status:m,from:d||void 0,to:f||void 0,search:x||"",limit:1e4,offset:0});if(!xe||xe.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const st=xe.map(Re=>Re.id),Ct=await dS(st,r?.codigo_empresa),ar=await Gm(r?.codigo_empresa),pr=new Map(ar.map(Re=>[Re.id,Re.numero])),Xt=await jT(st),yr=await _T(st),lr=xe.map(Re=>{const bt=Re.mesa_id?`Mesa ${pr.get(Re.mesa_id)||"?"}`:"Balco",Qt=Xt[Re.id]||"Sem cliente",ct=yr[Re.id],xt=Array.isArray(ct)?ct.join(", "):ct||"No informado",it=Re.fechado_em?"Fechada":"Aberta";return{Tipo:Re.tipo==="balcao"?"Balco":"Mesa","Mesa/Local":bt,"Cliente(s)":Qt,Status:it,Abertura:new Date(Re.aberto_em).toLocaleString("pt-BR"),Fechamento:Re.fechado_em?new Date(Re.fechado_em).toLocaleString("pt-BR"):"-","Total (R$)":Number(Ct[Re.id]||0).toFixed(2),"Forma(s) Pagamento":xt,Observaes:Re.observacao||"-"}}),Rr=Object.keys(lr[0]),Pn=[Rr.join(";"),...lr.map(Re=>Rr.map(bt=>{const Qt=Re[bt]||"";return`"${String(Qt).replace(/"/g,'""')}"`}).join(";"))].join(`
`),De=new Blob(["\uFEFF"+Pn],{type:"text/csv;charset=utf-8;"}),ke=document.createElement("a"),Ge=URL.createObjectURL(De);ke.setAttribute("href",Ge),ke.setAttribute("download",`historico_comandas_${new Date().toISOString().slice(0,10)}.csv`),ke.style.visibility="hidden",document.body.appendChild(ke),ke.click(),document.body.removeChild(ke),e({title:"CSV exportado!",description:`${lr.length} comandas exportadas`,variant:"success"})}catch(xe){console.error("Erro ao exportar CSV:",xe),e({title:"Erro ao exportar",description:xe.message,variant:"destructive"})}},ne=async()=>{try{if(e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"}),!l||l.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const xe=l.map(yr=>{const lr=yr.status==="open"?"Aberto":yr.status==="closed"?"Fechado":yr.status;return{"Data Abertura":yr.aberto_em?new Date(yr.aberto_em).toLocaleString("pt-BR"):"-","Data Fechamento":yr.fechado_em?new Date(yr.fechado_em).toLocaleString("pt-BR"):"-",Status:lr,"Saldo Inicial (R$)":Number(yr.saldo_inicial||0).toFixed(2),"Saldo Final (R$)":Number(yr.saldo_final||0).toFixed(2),"Valor Contado (R$)":yr.valor_final_dinheiro?Number(yr.valor_final_dinheiro).toFixed(2):"-","Diferena (R$)":yr.diferenca_dinheiro?Number(yr.diferenca_dinheiro).toFixed(2):"-"}}),st=Object.keys(xe[0]),Ct=[st.join(";"),...xe.map(yr=>st.map(lr=>{const Rr=yr[lr]||"";return`"${String(Rr).replace(/"/g,'""')}"`}).join(";"))].join(`
`),ar=new Blob(["\uFEFF"+Ct],{type:"text/csv;charset=utf-8;"}),pr=document.createElement("a"),Xt=URL.createObjectURL(ar);pr.setAttribute("href",Xt),pr.setAttribute("download",`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`),pr.style.visibility="hidden",document.body.appendChild(pr),pr.click(),document.body.removeChild(pr),e({title:"CSV exportado!",description:`${xe.length} fechamentos exportados`,variant:"success"})}catch(xe){console.error("Erro ao exportar CSV:",xe),e({title:"Erro ao exportar",description:xe.message,variant:"destructive"})}},de=100,[lt,Nt]=p.useState(0),[at,gt]=p.useState(!1),Pt=p.useRef(!1),yt=p.useRef(0),Qe=p.useRef(0),ge=p.useRef(!1),rt=()=>{try{const xe=localStorage.getItem("auth:userProfile");return xe&&JSON.parse(xe)?.codigo_empresa||null}catch{return null}},pt=p.useMemo(()=>`hist:comandas:${rt()||"na"}:${d}:${f}:${m}:${b}:${(x||"").trim()}`,[d,f,m,b,x]),We=async({append:xe=!1,skipCacheWrite:st=!1}={})=>{try{i(!0);const Ct=rt();if(!Ct){i(!1);return}const ar=setTimeout(()=>i(!1),1e4);if(j==="comandas"){const pr=!!(x&&x.trim()),Xt=pr?1e3:de,yr=pr?0:lt;console.log("[HistoricoComandasPage] Carregando com:",{status:m,from:d,to:f,search:x,mesaId:s,searching:pr,effLimit:Xt});const lr=await lz({status:m,from:d,to:f,search:s||x,limit:Xt,offset:yr});console.log("[HistoricoComandasPage] Resultado:",lr?.length||0,"comandas");const Rr=(lr||[]).map(Qt=>Qt.id);let Pn={};if(Rr.length>0)try{Pn=await dS(Rr,Ct)}catch{Pn={}}let De=[];try{De=await Gm(Ct)}catch{De=[]}const ke=new Map((De||[]).map(Qt=>[Qt.id,Qt.numero]));let Ge={},Re={};try{Ge=await jT(Rr)}catch{Ge={}}try{Re=await _T(Rr)}catch{Re={}}const bt=(lr||[]).map(Qt=>{const ct=Ge[Qt.id],xt=Re[Qt.id];return{...Qt,statusDerived:Qt.status==="cancelled"?"cancelled":Qt.fechado_em?"closed":Qt.status||"open",total:Number(Pn[Qt.id]||0),mesaNumero:ke.get(Qt.mesa_id),clientesStr:Array.isArray(ct)?ct.join(", "):ct||"",finalizadorasStr:Array.isArray(xt)?xt.join(", "):xt||""}});if(gt(pr?!1:(lr||[]).length===de),c(xe?Qt=>[...Qt,...bt]:bt),!st)try{localStorage.setItem(pt,JSON.stringify({ts:Date.now(),rows:bt}))}catch{}}else{const pr=await kre({from:d,to:f,limit:100,offset:0,codigoEmpresa:Ct});c(pr||[])}clearTimeout(ar)}catch(Ct){e({title:"Falha ao carregar histrico",description:Ct?.message||"Tente novamente",variant:"destructive"})}finally{i(!1),yt.current=Date.now()}};p.useEffect(()=>{s&&(async()=>{try{const Ct=(await Gm(r?.codigo_empresa)||[]).find(ar=>ar.id===s);Ct&&A(`Mesa ${Ct.numero}`)}catch{}})()},[s,r?.codigo_empresa]),p.useEffect(()=>{if(Pt.current=!0,j==="comandas")try{const xe=localStorage.getItem(pt);if(xe){const st=JSON.parse(xe);st&&Array.isArray(st.rows)&&Date.now()-Number(st.ts||0)<12e4&&c(st.rows)}}catch{}return()=>{Pt.current=!1}},[pt,j]),p.useEffect(()=>{j==="comandas"&&(Nt(0),gt(!1)),We({append:!1})},[m,x,d,f,j]),p.useEffect(()=>{if(!o&&j==="comandas"&&l.length===0){const xe=setTimeout(()=>{Pt.current&&We({append:!1,skipCacheWrite:!1})},1500);return()=>clearTimeout(xe)}},[l.length,o,j]),p.useEffect(()=>{const xe=()=>{document.visibilityState==="visible"&&Date.now()-(yt.current||0)>3e4&&We({append:!1})},st=()=>{Date.now()-(yt.current||0)>3e4&&We({append:!1})};return window.addEventListener("visibilitychange",xe),window.addEventListener("focus",st),()=>{window.removeEventListener("visibilitychange",xe),window.removeEventListener("focus",st)}},[pt,j]);const Ze=async xe=>{D(xe),R({loading:!0,itens:[],pagamentos:[]});const st=rt();ge.current=!0;const Ct=++Qe.current,ar=setTimeout(()=>{Qe.current===Ct&&ge.current&&R(pr=>({...pr,loading:!1}))},1e4);if(!st){clearTimeout(ar),Qe.current===Ct&&ge.current&&R({loading:!1,itens:[],pagamentos:[]});return}try{const pr=(l||[]).find(Xt=>Xt.id===xe)||null;if(pr){const Xt=pr.mesa_id==null?"Balco":pr.mesaNumero!=null?`Mesa ${pr.mesaNumero}`:"Comanda";U({mesaLabel:Xt,clientesStr:pr.clientesStr||"",aberto_em:pr.aberto_em||null,fechado_em:pr.fechado_em||null,tipo:pr.mesa_id==null?"balcao":"comanda",status:pr.statusDerived||pr.status||"open",diferenca_pagamento:typeof pr.diferenca_pagamento=="number"?pr.diferenca_pagamento:0})}else U(null)}catch{U(null)}try{const pr=async()=>{const[yr,lr]=await Promise.all([uo({comandaId:xe,codigoEmpresa:st}),Pre({comandaId:xe,codigoEmpresa:st})]);let Rr=[];try{Rr=await ai({comandaId:xe,codigoEmpresa:st})}catch{}console.log("[openDetail] clientesVinc:",Rr);const Pn=new Map((Rr||[]).map(Ge=>{const Re=Ge?.cliente_id??Ge?.clientes?.id??null,bt=Ge?.clientes?.nome??Ge?.nome??Ge?.nome_livre??"";return console.log(`[openDetail] Mapeando cliente: cid=${Re}, nome=${bt}`),Re?[String(Re),bt]:null}).filter(Boolean));console.log("[openDetail] nomeById map:",Array.from(Pn.entries()));const De=[...Array.from(Pn.values()),...(Rr||[]).filter(Ge=>!Ge?.cliente_id&&(Ge?.nome_livre||Ge?.nome)).map(Ge=>Ge?.nome_livre||Ge?.nome||"Consumidor")];console.log("[openDetail] clientesDisponiveis:",De),console.log("[openDetail] pagamentos:",lr);const ke=(lr||[]).map((Ge,Re)=>{let bt="";return Ge?.cliente_id?(bt=Pn.get(String(Ge.cliente_id))||"",!bt&&De.length>0&&(bt=De[Re%De.length])):De.length>0&&(bt=De[Re%De.length]),console.log(`[openDetail] Pagamento ${Re}: cliente_id=${Ge?.cliente_id}, clienteNome=${bt}`),{...Ge,cliente_nome:bt,finalizadora_nome:Ge?.finalizadoras?.nome||Ge?.metodo||""}});return{itens:yr||[],pagamentos:ke}};let Xt=await pr();Xt.itens.length===0&&Xt.pagamentos.length===0&&(await new Promise(yr=>setTimeout(yr,700)),Xt=await pr()),Qe.current===Ct&&ge.current&&R({loading:!1,itens:Xt.itens,pagamentos:Xt.pagamentos})}catch(pr){Qe.current===Ct&&ge.current&&R({loading:!1,itens:[],pagamentos:[]}),e({title:"Falha ao carregar detalhes",description:pr?.message||"Tente novamente",variant:"destructive"})}finally{clearTimeout(ar),Qe.current===Ct&&ge.current&&R(pr=>({...pr,loading:!1}))}},Ne=p.useMemo(()=>({sum:l.reduce((st,Ct)=>st+Number(Ct.total||0),0)}),[l]),ye=xe=>(xe||"").toString().toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,""),Be=p.useMemo(()=>{const xe=(x||"").trim(),st=ye(xe),ar=l.filter(pr=>{const Xt=pr.mesa_id==null;return!(b==="balcao"&&!Xt||b==="comanda"&&Xt)}).filter(pr=>{const Xt=pr.statusDerived||(pr.status==="cancelled"?"cancelled":pr.fechado_em?"closed":pr.status||"open");return m==="closed"?Xt==="closed":m==="open"?Xt==="open":m==="awaiting-payment"?Xt==="awaiting-payment":m==="cancelled"?Xt==="cancelled":!0});return st?ar.filter(pr=>{const Xt=pr.mesaNumero!=null?String(pr.mesaNumero):"",yr=pr.mesa_id==null?"balcao":`mesa ${Xt}`;return[Xt,yr,pr.clientesStr||"",pr.finalizadorasStr||"",pr.mesa_id==null?"balcao":"comanda",pr.statusDerived||pr.status||""].map(ye).join(" | ").includes(st)}):ar},[l,x,b,m]),mt=xe=>xe==="open"?"Aberta":xe==="awaiting-payment"?"Pagamento":xe==="closed"?"Fechada":xe==="cancelled"?"Cancelada":xe||"",Ft=xe=>{if(!xe)return"";try{return new Date(xe).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}},fr=xe=>{const st=String(xe||"").toLowerCase();return st==="open"?"Aberto":st==="closed"?"Fechado":""},It=xe=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(xe||0)),Ut=xe=>xe==="open"?"text-info bg-info/10 border-info/30":xe==="awaiting-payment"?"text-warning bg-warning/10 border-warning/30":xe==="closed"?"text-success bg-success/10 border-success/30":xe==="cancelled"?"text-red-400 bg-red-500/10 border-red-500/30":"text-text-secondary bg-transparent border-border/50";return a.jsxs(jr.div,{variants:Uit,initial:"hidden",animate:"visible",className:"min-h-screen flex flex-col",children:[a.jsxs(jr.div,{variants:jy,className:"mb-6 gap-3 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsx(Cc,{value:"historico",onValueChange:xe=>{xe==="mesas"&&t("/vendas"),xe==="balcao"&&t("/balcao"),xe==="historico"&&t("/historico")},children:a.jsxs(Gl,{className:"grid w-full sm:w-auto grid-cols-3 sm:inline-flex",children:[a.jsx(da,{value:"mesas",children:"Mesas"}),a.jsx(da,{value:"balcao",children:"Balco"}),a.jsx(da,{value:"historico",children:"Histrico"})]})}),a.jsxs("div",{className:"w-full flex items-center gap-2 sm:gap-3",children:[a.jsxs("div",{className:"flex sm:hidden items-center gap-2 w-full",children:[a.jsxs(Nn,{value:j,onValueChange:_,children:[a.jsx(bn,{className:"w-[160px] text-sm",children:a.jsx(Cn,{placeholder:"Selecionar"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"comandas",children:"Comandas"}),a.jsx(tt,{value:"fechamentos",children:"Fechamentos"})]})]}),a.jsxs("div",{className:"ml-auto text-xs text-text-secondary whitespace-nowrap",children:["Total: ",a.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",Ne.sum.toFixed(2)]})]}),j==="comandas"&&a.jsx(me,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:()=>ie(!0),title:"Aes",children:a.jsx(ho,{className:"h-4 w-4"})}),j==="fechamentos"&&a.jsx(me,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:ne,title:"Exportar",children:a.jsx(ho,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"hidden sm:flex items-center gap-2 sm:gap-3 ml-auto",children:a.jsx(Cc,{value:j,onValueChange:_,className:"w-full sm:w-auto",children:a.jsxs(Gl,{className:"w-full grid grid-cols-2 sm:w-auto sm:inline-flex text-sm",children:[a.jsx(da,{value:"comandas",className:"text-sm",children:"Comandas"}),a.jsx(da,{value:"fechamentos",className:"text-sm",children:"Fechamentos"})]})})})]}),a.jsxs("div",{className:"hidden sm:flex w-full sm:w-auto items-center gap-2 sm:gap-3",children:[j==="comandas"&&a.jsxs(a.Fragment,{children:[a.jsxs(me,{variant:"secondary",size:"sm",className:"hidden sm:inline-flex",onClick:()=>ce(!0),children:[a.jsx(Go,{className:"mr-2 h-4 w-4"}),"Importar XML"]}),a.jsxs(me,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:Te,children:[a.jsx(ho,{className:"mr-1 h-3 w-3"}),"Exportar"]}),a.jsx("button",{className:"hidden sm:inline-block text-xs text-text-muted hover:text-text-primary transition-colors",onClick:()=>{if(te){const xe=new Date().toISOString().slice(0,10);u(xe),h(xe),ue(!1)}else u(""),h(""),ue(!0);Nt(0)},title:te?"Voltar ao filtro de hoje":"Mostrar todas as comandas",children:te?"":""}),a.jsxs("div",{className:"text-sm text-text-secondary whitespace-nowrap ml-auto",children:["Total: ",a.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",Ne.sum.toFixed(2)]})]})]}),j==="fechamentos"&&a.jsxs(me,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:ne,children:[a.jsx(ho,{className:"mr-1 h-3 w-3"}),"Exportar"]})]})]}),a.jsx(xn,{open:le,onOpenChange:ie,children:a.jsxs(vn,{className:"sm:hidden w-[92vw] max-w-[360px] p-2",onOpenAutoFocus:xe=>xe.preventDefault(),onKeyDown:xe=>xe.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{className:"text-base",children:"Aes"}),a.jsx(Dn,{children:"Escolha uma ao para Comandas"})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs(me,{variant:"secondary",onClick:()=>{ie(!1),ce(!0)},children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Importar XML"]}),a.jsxs(me,{variant:"outline",onClick:()=>{ie(!1),Te()},children:[a.jsx(ho,{className:"mr-2 h-4 w-4"})," Exportar CSV"]})]})]})}),j==="comandas"&&a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsxs("div",{className:"text-xs text-text-secondary",children:["Carregadas ",l.length," ",l.length===1?"comanda":"comandas"]}),at&&a.jsx(me,{size:"sm",variant:"outline",disabled:o,onClick:async()=>{const xe=lt+de;Nt(xe),await We({append:!0})},children:"Carregar mais"})]}),j==="comandas"&&a.jsxs("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Buscar...",className:"pl-9 h-9 text-sm",value:g,onChange:xe=>y(xe.target.value)})]}),a.jsx(me,{size:"sm",variant:"outline",className:"h-9",onClick:()=>P(xe=>!xe),children:C?"Ocultar":"Filtros"})]}),a.jsxs("div",{className:"mt-1 text-[11px] text-text-secondary truncate",children:[d||"","  ",f||""]})]}),j==="comandas"&&a.jsx(jr.div,{variants:jy,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${C?"":"hidden"} sm:block`,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{className:"mb-1 block",children:"Perodo Inicial"}),a.jsx(Sj,{value:d,onChange:u})]}),a.jsxs("div",{children:[a.jsx(Le,{className:"mb-1 block",children:"Perodo Final"}),a.jsx(Sj,{value:f,onChange:h})]}),a.jsxs("div",{className:"md:col-span-2 hidden sm:block",children:[a.jsxs(Le,{className:"mb-1 block",children:["Busca ",E&&a.jsxs("span",{className:"text-xs text-warning ml-1",children:["(",E,")"]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(to,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(Ye,{placeholder:"Mesa, status (fechada/aberta) ou cliente",className:"pl-9 pr-12",value:g,onChange:xe=>y(xe.target.value)}),s&&a.jsx(me,{size:"sm",variant:"ghost",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 text-xs",onClick:()=>{t("/historico")},children:" Limpar"})]})]}),a.jsxs("div",{children:[a.jsx(Le,{className:"mb-1 block",children:"Status"}),a.jsxs(Nn,{value:m,onValueChange:v,children:[a.jsx(bn,{className:"w-full text-xs",children:a.jsx(Cn,{placeholder:"Selecionar status"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"closed",children:"Fechadas"}),a.jsx(tt,{value:"open",children:"Abertas"}),a.jsx(tt,{value:"awaiting-payment",children:"Pagamento"}),a.jsx(tt,{value:"cancelled",children:"Canceladas"})]})]})]}),a.jsxs("div",{children:[a.jsx(Le,{className:"mb-1 block",children:"Tipo"}),a.jsxs(Nn,{value:b,onValueChange:w,children:[a.jsx(bn,{className:"w-full text-xs",children:a.jsx(Cn,{placeholder:"Selecionar tipo"})}),a.jsxs(wn,{children:[a.jsx(tt,{value:"all",children:"Todos"}),a.jsx(tt,{value:"comanda",children:"Comandas"}),a.jsx(tt,{value:"balcao",children:"Balco"})]})]})]})]})}),j==="comandas"&&a.jsxs(jr.div,{variants:jy,className:"bg-surface rounded-lg border border-border p-0 overflow-hidden",children:[a.jsx("div",{className:"hidden sm:block overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Local"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Clientes"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Finalizadora"}),a.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Abertura"}),a.jsx("th",{className:"text-right px-4 py-3 whitespace-nowrap",children:"Diferena"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Total"}),a.jsx("th",{className:"text-right px-4 py-3 whitespace-nowrap",children:"Fiscal"})]})}),a.jsxs("tbody",{children:[Be.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-6 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."})}),Be.map(xe=>a.jsxs("tr",{className:"border-t border-border/70 hover:bg-warning/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:()=>Ze(xe.id),children:[a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:xe.mesa_id==null?"Balco":xe.mesaNumero!=null?`Mesa ${xe.mesaNumero}`:""}),a.jsx("td",{className:"px-4 py-2 break-words",title:xe.clientesStr||"",children:xe.clientesStr||""}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("span",{className:gr("inline-flex items-center text-[11px] font-medium px-2 py-0.5 rounded-full border",Ut(xe.statusDerived||xe.status)),children:mt(xe.statusDerived||xe.status)})}),a.jsx("td",{className:"px-4 py-2 break-words",title:xe.finalizadorasStr||"",children:xe.finalizadorasStr||""}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:Ft(xe.aberto_em)}),a.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:(()=>{const st=typeof xe.diferenca_pagamento=="number"?xe.diferenca_pagamento:0;if(Math.abs(st)<.005)return a.jsx("span",{className:"text-xs text-text-muted",children:"R$ 0,00"});const Ct=st>0?"text-emerald-500":"text-amber-500",ar=st>0?"+":"-";return a.jsx("span",{className:`text-xs font-semibold ${Ct}`,children:`${ar} R$ ${Math.abs(st).toFixed(2)}`})})()}),a.jsx("td",{className:"px-4 py-2 text-right font-semibold whitespace-nowrap",children:It(xe.total)}),a.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:xe.fechado_em&&(!xe.nf_status||xe.nf_status==="rejeitada")&&a.jsx(me,{size:"sm",variant:"outline",onClick:st=>{st.stopPropagation(),fe(xe.id)},children:"Pr-Emisso"})})]},xe.id))]})]})}),a.jsxs("div",{className:"sm:hidden divide-y divide-border",children:[Be.length===0&&a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."}),Be.map(xe=>a.jsxs("button",{className:"w-full text-left p-3 active:bg-warning/10",onClick:()=>Ze(xe.id),children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:xe.mesa_id==null?"Balco":xe.mesaNumero!=null?`Mesa ${xe.mesaNumero}`:"Comanda"}),a.jsx("div",{className:"font-semibold truncate max-w-[220px]",children:xe.clientesStr||"Sem cliente"})]}),a.jsx("div",{children:a.jsx("div",{className:gr("inline-flex items-center text-[10px] font-medium px-2 py-0.5 rounded-full border",Ut(xe.statusDerived||xe.status)),children:mt(xe.statusDerived||xe.status)})})]}),a.jsx("div",{className:"mt-1 text-xs text-text-secondary truncate",children:xe.finalizadorasStr||""}),a.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0 text-[11px] text-text-muted truncate pr-2",children:[Ft(xe.aberto_em),xe.fechado_em?`  ${Ft(xe.fechado_em)}`:""]}),a.jsxs("div",{className:"flex-shrink-0 text-right min-w-[84px]",children:[a.jsx("div",{className:"text-[11px]",children:(()=>{const st=typeof xe.diferenca_pagamento=="number"?xe.diferenca_pagamento:0;if(Math.abs(st)<.005)return a.jsx("span",{className:"text-text-muted",children:"Dif.: R$ 0,00"});const Ct=st>0?"text-emerald-500":"text-amber-500",ar=st>0?"+":"-";return a.jsx("span",{className:Ct,children:`Dif.: ${ar} R$ ${Math.abs(st).toFixed(2)}`})})()}),a.jsx("div",{className:"font-mono font-semibold whitespace-nowrap",children:It(xe.total)})]})]}),xe.fechado_em&&(!xe.nf_status||xe.nf_status==="rejeitada")&&a.jsx("div",{className:"mt-2 flex justify-end",children:a.jsx(me,{size:"sm",variant:"outline",onClick:st=>{st.preventDefault(),st.stopPropagation(),fe(xe.id)},children:"Pr-Emisso"})})]},xe.id))]})]}),a.jsx(xn,{open:$,onOpenChange:ee,children:a.jsxs(vn,{className:"max-w-[800px]",children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Pr-Emisso NFC-e"}),a.jsx(Dn,{children:"Revise os dados e pendncias antes de emitir."})]}),ve?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Gerando prvia"}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"JSON (EnviarNfce)"}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto",children:K?JSON.stringify(K,null,2):""})]}),a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Pendncias"}),!Y||Y.length===0?a.jsx("div",{className:"text-sm text-emerald-500",children:"Nenhuma pendncia encontrada."}):a.jsx("ul",{className:"list-disc pl-5 text-sm",children:Y.map((xe,st)=>a.jsx("li",{children:xe},st))})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(me,{variant:"outline",onClick:()=>ee(!1),children:"Fechar"}),a.jsx(me,{disabled:!0,children:"Emitir (desabilitado)"})]})]})}),j==="fechamentos"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"text-sm font-medium",children:"Filtros"}),a.jsx(me,{size:"sm",variant:"outline",onClick:()=>P(xe=>!xe),children:C?"Ocultar filtros":"Mostrar filtros"})]})}),a.jsx(jr.div,{variants:jy,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${C?"":"hidden"} sm:block`,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx(Le,{className:"mb-1 block",children:"Perodo Inicial"}),a.jsx(Sj,{value:d,onChange:u})]}),a.jsxs("div",{children:[a.jsx(Le,{className:"mb-1 block",children:"Perodo Final"}),a.jsx(Sj,{value:f,onChange:h})]})]})}),a.jsxs(jr.div,{variants:jy,className:"bg-surface rounded-lg border border-border p-4 overflow-hidden",children:[a.jsxs("div",{className:"sm:hidden space-y-2",children:[o&&(!l||l.length===0)&&a.jsxs("div",{className:"px-2 py-3 text-center text-text-muted",children:[a.jsx(md,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]}),(!l||l.length===0)&&!o&&a.jsx("div",{className:"px-2 py-3 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."}),(l||[]).map(xe=>a.jsxs("button",{onClick:async()=>{try{W({open:!0,loading:!0,resumo:null,periodo:{from:xe.aberto_em,to:xe.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:xe?.saldo_inicial??null,final:xe?.saldo_final??null}});const st=rt(),[Ct,ar]=await Promise.all([uS({caixaSessaoId:xe.id,codigoEmpresa:st}).catch(()=>null),Wp({caixaSessaoId:xe.id,codigoEmpresa:st}).catch(()=>[])]);let pr=Ct?.movimentos||null;if(!pr&&Array.isArray(ar)){const yr={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const lr of ar){const Rr=String(lr?.tipo||"").toLowerCase(),Pn=Number(lr?.valor||0);Rr==="suprimento"?yr.suprimentos+=Pn:Rr==="sangria"?yr.sangrias+=Pn:Rr==="ajuste"?yr.ajustes+=Pn:Rr==="troco"&&(yr.troco+=Pn)}pr=yr}const Xt=Ct?{totalDescontos:Number(Ct.total_descontos||0),totalVendasLiquidas:Number(Ct.total_liquido||0),totalEntradas:Number(Ct.total_entradas||0),totalPorFinalizadora:Ct.por_finalizadora||{}}:null;W({open:!0,loading:!1,resumo:Xt,periodo:{from:Ct?.periodo_de||xe.aberto_em,to:Ct?.periodo_ate||xe.fechado_em},movs:ar||[],movimentosAgg:pr,saldos:{inicial:xe?.saldo_inicial??null,final:xe?.saldo_final??null}})}catch{W({open:!0,loading:!1,resumo:null,periodo:{from:xe.aberto_em,to:xe.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:xe?.saldo_inicial??null,final:xe?.saldo_final??null}})}},className:"w-full text-left p-3 rounded-lg border border-border hover:bg-surface-2 transition",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"text-xs text-text-secondary",children:[Ft(xe.aberto_em),a.jsx("span",{className:"mx-1",children:""}),Ft(xe.fechado_em)]}),a.jsx("div",{className:"text-[11px] px-2 py-0.5 rounded-full border bg-success/10 text-success border-success/30",children:fr(xe.status)})]}),a.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[a.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Inicial"}),a.jsx("div",{className:"font-semibold",children:xe?.saldo_inicial!=null?It(xe.saldo_inicial):""})]}),a.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[a.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Final (contado)"}),a.jsx("div",{className:"font-semibold",children:xe?.valor_final_dinheiro!=null?It(xe.valor_final_dinheiro):""})]})]})]},xe.id))]}),a.jsx("div",{className:"hidden sm:block overflow-x-auto max-h-[60vh] overflow-y-auto pr-2 sm:pr-3",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3",children:"Abertura"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Fechamento"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Inicial"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Final (contado)"})]})}),a.jsxs("tbody",{children:[o&&(!l||l.length===0)&&a.jsx("tr",{children:a.jsxs("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:[a.jsx(md,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]})}),(!l||l.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."})}),(l||[]).map(xe=>a.jsxs("tr",{className:"border-t border-border/70 hover:bg-success/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:async()=>{try{W({open:!0,loading:!0,resumo:null,periodo:{from:xe.aberto_em,to:xe.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:xe?.saldo_inicial??null,final:xe?.saldo_final??null}});const st=async()=>{const pr=rt(),[Xt,yr]=await Promise.all([uS({caixaSessaoId:xe.id,codigoEmpresa:pr}).catch(()=>null),Wp({caixaSessaoId:xe.id,codigoEmpresa:pr}).catch(()=>[])]);return{snap:Xt,movs:yr}};let{snap:Ct,movs:ar}=await st();if(Ct||(await new Promise(pr=>setTimeout(pr,700)),{snap:Ct,movs:ar}=await st()),Ct){const pr={totalDescontos:Number(Ct.total_descontos||0),totalVendasLiquidas:Number(Ct.total_liquido||0),totalEntradas:Number(Ct.total_entradas||0),totalPorFinalizadora:Ct.por_finalizadora||{}};let Xt=Ct.movimentos||null;if(!Xt&&Array.isArray(ar)){const yr={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const lr of ar){const Rr=String(lr?.tipo||"").toLowerCase(),Pn=Number(lr?.valor||0);Rr==="suprimento"?yr.suprimentos+=Pn:Rr==="sangria"?yr.sangrias+=Pn:Rr==="ajuste"?yr.ajustes+=Pn:Rr==="troco"&&(yr.troco+=Pn)}Xt=yr}W({open:!0,loading:!1,resumo:pr,periodo:{from:Ct.periodo_de||xe.aberto_em,to:Ct.periodo_ate||xe.fechado_em},movs:ar||[],movimentosAgg:Xt,saldos:{inicial:typeof Ct.saldo_inicial<"u"?Number(Ct.saldo_inicial):xe?.saldo_inicial??null,final:typeof Ct.valor_final_dinheiro<"u"?Number(Ct.valor_final_dinheiro):xe?.valor_final_dinheiro??null}})}else{const pr=rt(),Xt=await gd({from:xe.aberto_em,to:xe.fechado_em||new Date().toISOString(),codigoEmpresa:pr});let yr=null;if(Array.isArray(ar)){const lr={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const Rr of ar){const Pn=String(Rr?.tipo||"").toLowerCase(),De=Number(Rr?.valor||0);Pn==="suprimento"?lr.suprimentos+=De:Pn==="sangria"?lr.sangrias+=De:Pn==="ajuste"?lr.ajustes+=De:Pn==="troco"&&(lr.troco+=De)}yr=lr}W({open:!0,loading:!1,resumo:Xt||null,periodo:{from:xe.aberto_em,to:xe.fechado_em},movs:ar||[],movimentosAgg:yr,saldos:{inicial:xe?.saldo_inicial??null,final:xe?.valor_final_dinheiro??null}})}}catch{W({open:!0,loading:!1,resumo:null,periodo:{from:xe.aberto_em,to:xe.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:xe?.saldo_inicial??null,final:xe?.valor_final_dinheiro??null}})}},children:[a.jsx("td",{className:"px-4 py-2",children:Ft(xe.aberto_em)}),a.jsx("td",{className:"px-4 py-2",children:Ft(xe.fechado_em)}),a.jsx("td",{className:"px-4 py-2",children:fr(xe.status)}),a.jsx("td",{className:"px-4 py-2 text-right",children:xe?.saldo_inicial!=null?It(xe.saldo_inicial):""}),a.jsx("td",{className:"px-4 py-2 text-right",children:xe?.valor_final_dinheiro!=null?It(xe.valor_final_dinheiro):""})]},xe.id))]})]})})]})]}),j==="comandas"&&a.jsx(xn,{open:!!F,onOpenChange:xe=>{xe?ge.current=!0:(ge.current=!1,D(null),R({loading:!1,itens:[],pagamentos:[]}),U(null))},children:a.jsxs(vn,{className:"sm:max-w-4xl w-[92vw] max-h-[90vh] overflow-hidden flex flex-col animate-none",onKeyDown:xe=>xe.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsxs(un,{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{children:M?a.jsxs("span",{children:[M.mesaLabel,M.clientesStr?a.jsxs("span",{className:"text-text-secondary",children:["  ",M.clientesStr]}):null]}):a.jsxs(a.Fragment,{children:["Comanda #",F||""]})}),M&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("span",{className:gr("text-xs px-2 py-0.5 rounded-full border",Ut(M.status)),children:M.status==="closed"?"Fechada":M.status==="open"?"Aberta":"Cancelada"}),a.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full border bg-info/10 text-info border-info/30",children:M.tipo==="balcao"?"Balco":M.tipo==="comanda"?"Mesa":"Importada"})]})]}),a.jsx(Dn,{className:"space-y-1",children:M?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[M.aberto_em?a.jsxs(a.Fragment,{children:["Abertura: ",Ft(M.aberto_em)]}):"",M.fechado_em&&a.jsxs(a.Fragment,{children:[" ",""," ","Fechamento: ",Ft(M.fechado_em),(()=>{const xe=new Date(M.aberto_em),Ct=new Date(M.fechado_em)-xe,ar=Math.floor(Ct/6e4),pr=Math.floor(ar/60),Xt=ar%60;return ar>0?a.jsxs("span",{className:"text-text-muted",children:[" (",pr>0?`${pr}h `:"",Xt,"min)"]}):null})()]})]}),M.observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:M.observacao.includes("Importado de XML")?a.jsxs("span",{className:"text-warning",children:[" ",M.observacao.split(`
`)[0]]}):a.jsxs("span",{children:["Obs: ",M.observacao]})})]}):a.jsx(a.Fragment,{children:"Itens e pagamentos registrados."})})]}),I.loading?a.jsxs("div",{className:"p-6 text-center text-text-muted",children:[a.jsx(md,{className:"mr-2 inline h-4 w-4 animate-spin"})," Carregando..."]}):a.jsxs("div",{className:"space-y-4 overflow-y-auto flex-1 px-1",children:[(()=>{const xe=I.itens.reduce((yr,lr)=>yr+Number(lr.quantidade||0)*Number(lr.preco_unitario||0),0),st=I.itens.reduce((yr,lr)=>yr+Number(lr.desconto||0),0),Ct=xe-st,ar=I.pagamentos.reduce((yr,lr)=>yr+Number(lr.valor||0),0),pr=typeof M?.diferenca_pagamento=="number"?M.diferenca_pagamento:null,Xt=pr??ar-Ct;return a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Resumo Financeiro"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Subtotal"}),a.jsxs("span",{className:"font-mono font-semibold",children:["R$ ",xe.toFixed(2)]})]}),st>0&&a.jsxs("div",{className:"flex items-center gap-2 text-warning",children:[a.jsx("span",{children:"Desconto"}),a.jsxs("span",{className:"font-mono font-semibold",children:["-R$ ",st.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex justify-between font-semibold pt-2 border-t border-border",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{className:"font-mono text-lg",children:["R$ ",Ct.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2 text-success",children:[a.jsx("span",{children:"Pagamentos"}),a.jsxs("span",{className:"font-mono",children:["R$ ",ar.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-secondary",children:"Diferena"}),a.jsx("span",{className:gr("font-semibold",Math.abs(Xt)<.005?"text-text-muted":Xt>0?"text-emerald-500":"text-amber-500"),children:Math.abs(Xt)<.005?"R$ 0,00":`${Xt>0?"+":"-"} R$ ${Math.abs(Xt).toFixed(2)}`})]})]})]})]})})(),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"border rounded-md p-3",children:[a.jsxs("div",{className:"font-semibold mb-2",children:["Itens (",I.itens.length,")"]}),I.itens.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem itens."}):a.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:I.itens.map(xe=>{const st=Number(xe.quantidade||0)*Number(xe.preco_unitario||0),Ct=Number(xe.desconto||0),ar=st-Ct;return a.jsx("li",{className:"border-b border-border/50 pb-2 last:border-0",children:a.jsxs("div",{className:"flex justify-between items-start gap-2",children:[a.jsxs("span",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:xe.descricao}),a.jsxs("div",{className:"text-xs text-text-muted",children:[xe.quantidade," x R$ ",Number(xe.preco_unitario||0).toFixed(2),Ct>0&&a.jsxs("span",{className:"text-warning",children:[" (desc: R$ ",Ct.toFixed(2),")"]})]})]}),a.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",ar.toFixed(2)]})]})},xe.id)})})]}),a.jsxs("div",{className:"border rounded-md p-3",children:[a.jsxs("div",{className:"font-semibold mb-2",children:["Pagamentos (",I.pagamentos.length,")"]}),I.pagamentos.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros."}):a.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:I.pagamentos.map(xe=>a.jsxs("li",{className:"flex justify-between gap-2 border-b border-border/50 pb-2 last:border-0",children:[a.jsxs("span",{className:"pr-2 break-words flex-1",children:[xe.cliente_nome?a.jsx("div",{className:"font-medium",children:xe.cliente_nome}):a.jsx("div",{className:"text-text-muted",children:"Sem cliente"}),a.jsx("div",{className:"text-xs text-text-secondary",children:xe.finalizadora_nome||"Outros"})]}),a.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",Number(xe.valor||0).toFixed(2)]})]},xe.id))})]})]})]}),a.jsx(ra,{children:a.jsx(me,{size:"sm",variant:"secondary",onClick:()=>{D(null)},children:"Fechar"})})]})}),j==="fechamentos"&&a.jsx(xn,{open:z.open,onOpenChange:xe=>{xe||W({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null}})},children:a.jsxs(vn,{className:"sm:max-w-2xl w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden overflow-x-hidden",onKeyDown:xe=>xe.stopPropagation(),children:[a.jsxs(pn,{children:[a.jsx(un,{children:"Fechamento do Perodo"}),a.jsxs(Dn,{children:[z.periodo.from?Ft(z.periodo.from):""," ","at"," ",z.periodo.to?Ft(z.periodo.to):""]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:z.loading?a.jsxs("div",{className:"p-3 sm:p-4 text-text-muted",children:[a.jsx(md,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando resumo"]}):a.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),a.jsx("p",{className:"text-xl font-bold",children:It(z?.saldos?.inicial??0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Entradas (pagamentos)"}),a.jsx("p",{className:"text-xl font-bold text-success",children:It(z.resumo?.totalEntradas||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border col-span-2 sm:col-span-1",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),a.jsx("p",{className:"text-xl font-bold",children:z?.saldos?.final!=null?It(z.saldos.final):""})]})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),a.jsx("p",{className:"text-xl font-bold text-warning",children:It(z.resumo?.totalDescontos||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),a.jsx("p",{className:"text-xl font-bold",children:It(z.resumo?.totalVendasLiquidas||0)})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-1",children:"Por Finalizadora"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:z.resumo?.totalPorFinalizadora&&Object.keys(z.resumo.totalPorFinalizadora).length>0?Object.entries(z.resumo.totalPorFinalizadora).map(([xe,st])=>a.jsxs("div",{className:"flex items-center justify-between bg-surface-2 rounded-md p-2 border border-border",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:String(xe)}),a.jsx("span",{className:"text-sm font-semibold",children:It(st)})]},xe)):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados de finalizadoras"})})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-1",children:"Resumo de Movimentaes"}),z.movimentosAgg?a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Suprimentos"}),a.jsx("p",{className:"text-lg font-bold text-success",children:It(z.movimentosAgg?.suprimentos||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Sangrias"}),a.jsx("p",{className:"text-lg font-bold text-danger",children:It(z.movimentosAgg?.sangrias||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Ajustes"}),a.jsx("p",{className:"text-lg font-bold",children:It(z.movimentosAgg?.ajustes||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Troco"}),a.jsx("p",{className:"text-lg font-bold",children:It(z.movimentosAgg?.troco||0)})]})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes agregadas nesta sesso."})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-1",children:"Movimentaes"}),!z.movs||z.movs.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma movimentao registrada"}):a.jsxs(a.Fragment,{children:[a.jsx("ul",{className:"sm:hidden divide-y divide-border rounded-md border border-border overflow-hidden",children:z.movs.map((xe,st)=>a.jsxs("li",{className:"px-3 py-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-xs text-text-secondary whitespace-nowrap",children:Ft(xe.criado_em)}),a.jsx("span",{className:"text-sm font-semibold whitespace-nowrap",children:It(xe.valor||0)})]}),a.jsxs("div",{className:"mt-0.5 flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded bg-surface-2 border border-border text-text-secondary whitespace-nowrap",children:String(xe.tipo||"").toUpperCase()}),a.jsx("span",{className:"text-xs text-text-primary whitespace-normal break-words flex-1",children:xe.observacao||""})]})]},st))}),a.jsx("div",{className:"hidden sm:block rounded-md border border-border overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Data"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Tipo"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Obs"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Valor"})]})}),a.jsx("tbody",{children:z.movs.map((xe,st)=>a.jsxs("tr",{className:"border-t border-border/60",children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:Ft(xe.criado_em)}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:String(xe.tipo||"").toUpperCase()}),a.jsx("td",{className:"px-3 py-2 whitespace-normal break-words",children:xe.observacao||""}),a.jsx("td",{className:"px-3 py-2 text-right font-semibold whitespace-nowrap",children:It(xe.valor||0)})]},st))})]})})]})]})]})})]})}),a.jsx(zit,{open:Z,onOpenChange:ce,codigoEmpresa:r?.codigo_empresa,onSuccess:async xe=>{ce(!1),xe&&(u(xe),h(xe)),await new Promise(st=>setTimeout(st,500)),Nt(0),await We({append:!1})}})]})}function Hit(){const{userProfile:e}=vs(),[t]=eC(),r=t.get("comanda"),[n,s]=p.useState(!0),[o,i]=p.useState(null),[l,c]=p.useState([]),[d,u]=p.useState([]),[f,h]=p.useState([]),[m,v]=p.useState(null),[g,y]=p.useState(""),[x,b]=p.useState("");p.useEffect(()=>{(async()=>{try{if(!r||!e?.codigo_empresa)return;try{const{data:R,error:M}=await he.from("empresas").select("nome_fantasia, nome").eq("codigo_empresa",e.codigo_empresa).single();if(M&&console.warn("[PrintComandaPage] Erro ao buscar empresa:",M.message),R){const U=R.nome_fantasia||R.nome||"";console.log("[PrintComandaPage] Empresa carregada:",R,"-> nome exibido:",U),b(U)}else console.warn("[PrintComandaPage] Empresa no encontrada para codigo_empresa:",e.codigo_empresa)}catch(R){console.warn("[PrintComandaPage] Exceo ao carregar empresa:",R)}const{data:P}=await he.from("comandas").select("mesa_id, observacoes").eq("id",r).eq("codigo_empresa",e.codigo_empresa).single();if(P?.mesa_id){const{data:R}=await he.from("mesas").select("numero").eq("id",P.mesa_id).eq("codigo_empresa",e.codigo_empresa).single();v(R)}y(P?.observacoes||"");const[E,A,F]=await Promise.all([uo({comandaId:r,codigoEmpresa:e.codigo_empresa}),ai({comandaId:r,codigoEmpresa:e.codigo_empresa}),Pre({comandaId:r,codigoEmpresa:e.codigo_empresa})]);c(E||[]),u(A||[]),h(F||[]);const D=(E||[]).reduce((R,M)=>R+Number(M.quantidade||0)*Number(M.preco_unitario||0),0),I=(F||[]).reduce((R,M)=>R+Number(M.valor||0),0);i({id:r,totalItens:D,totalPagamentos:I,diferenca:I-D})}catch(P){console.error("Erro ao carregar comanda:",P)}finally{s(!1)}})()},[r,e?.codigo_empresa]);const w=()=>{window.print()},j=()=>{window.history.back()};if(n)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand mx-auto mb-4"}),a.jsx("p",{className:"text-text-muted",children:"Carregando comanda..."})]})});if(!o)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-text-muted mb-4",children:"Comanda no encontrada"}),a.jsxs(me,{onClick:j,variant:"outline",children:[a.jsx(Uy,{className:"mr-2 h-4 w-4"}),"Voltar"]})]})});const _=(d||[]).map(C=>C?.nome||C?.nome_livre||"").filter(Boolean).join(", ")||"Sem cliente";return o.totalItens,o.totalPagamentos,a.jsxs("div",{className:"w-screen h-screen bg-gray-100 flex flex-col print:bg-white print:p-0",children:[a.jsxs("div",{className:"flex gap-2 p-4 bg-white border-b border-gray-200 print:hidden",children:[a.jsxs(me,{onClick:j,size:"sm",className:"bg-black text-white hover:bg-black/80 border border-black shadow-sm",children:[a.jsx(Uy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsxs(me,{onClick:w,size:"sm",className:"ml-auto",children:[a.jsx(UH,{className:"mr-2 h-4 w-4"}),"Imprimir"]})]}),a.jsx("div",{className:"flex-1 overflow-auto flex items-start justify-center p-4 print:p-0 print:overflow-visible print:flex-none",children:a.jsxs("div",{className:"w-80 border border-black p-6 bg-white print:border-0 print:p-0 print:w-full",children:[a.jsxs("div",{className:"text-center mb-4 border-b border-black pb-3",children:[a.jsx("p",{className:"text-xs font-semibold text-black mb-2",children:x||" "}),a.jsx("h1",{className:"text-xl font-bold text-black",children:"COMANDA"}),m&&a.jsxs("p",{className:"text-xs text-black mt-1",children:["Mesa ",m.numero]}),a.jsx("p",{className:"text-xs text-black mt-1",children:new Date().toLocaleString("pt-BR")})]}),a.jsxs("div",{className:"mb-6 pb-4 border-b border-black",children:[a.jsx("p",{className:"text-sm font-semibold text-black",children:"CLIENTE:"}),a.jsx("p",{className:"text-sm text-black",children:_})]}),a.jsx("div",{className:"mb-6 pb-4 border-b border-black",children:a.jsx("div",{className:"space-y-2",children:l.map((C,P)=>{const E=Number(C.quantidade||0)*Number(C.preco_unitario||0);return a.jsxs("div",{className:"flex justify-between text-sm text-black",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{children:C.descricao||"Item"}),a.jsxs("span",{className:"ml-2 text-xs",children:["x",C.quantidade]})]}),a.jsxs("span",{className:"font-semibold",children:["R$ ",E.toFixed(2)]})]},P)})})}),g&&a.jsxs("div",{className:"mb-4 pb-3",children:[a.jsx("p",{className:"text-xs font-semibold text-black mb-1",children:"OBS:"}),a.jsx("p",{className:"text-xs text-black border-b border-black pb-3",children:g})]}),a.jsx("div",{className:"text-center pt-4",children:a.jsxs("p",{className:"text-lg font-bold text-black mt-2",children:["TOTAL: R$ ",o.totalItens.toFixed(2)]})}),a.jsxs("div",{className:"text-center mt-8 pt-4 border-t border-black text-xs text-black",children:[a.jsx("p",{children:"Obrigado pela preferncia!"}),a.jsx("p",{className:"mt-2",children:"Fluxo7Arena"})]})]})}),a.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            background: white;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:border-0 {
            border: none !important;
          }
          .print\\:p-0 {
            padding: 0 !important;
          }
        }
      `})]})}const Git="18810778",fv={hidden:{opacity:0,x:20},visible:{opacity:1,x:0,transition:{duration:.3}},exit:{opacity:0,x:-20,transition:{duration:.2}}};function Kit(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function Xit(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2").substring(0,15)}async function Yit(){try{const{data:e,error:t}=await he.from("empresas").select("codigo_empresa").order("codigo_empresa",{ascending:!1}).limit(100);if(t)return console.warn("Erro ao buscar cdigos:",t),"1";let r=0;return e&&e.length>0&&e.forEach(n=>{const s=parseInt(n.codigo_empresa);!isNaN(s)&&s>r&&(r=s)}),(r+1).toString()}catch(e){return console.warn("Erro ao gerar cdigo:",e),"1"}}function Jit(){const{toast:e}=as(),t=Ri(),[r,n]=p.useState(1),[s,o]=p.useState(!1),[i,l]=p.useState(!1),[c,d]=p.useState(""),[u,f]=p.useState({email:"",nomeUsuario:"",cargo:"",razaoSocial:"",nomeFantasia:"",cnpj:"",emailEmpresa:"",telefone:"",endereco:"",quadras:[],mesas:[],categorias:[]}),[h,m]=p.useState(null),v=W=>{W.preventDefault(),c===Git?(l(!0),n(2),e({title:"Acesso liberado",description:"Bem-vindo ao formulrio de criao de empresa."})):(e({title:"Senha incorreta",description:"Tente novamente.",variant:"destructive"}),d(""))},g=()=>!0,y=()=>u.razaoSocial.trim()?u.nomeFantasia.trim()?!0:(e({title:"Nome Fantasia obrigatrio",variant:"destructive"}),!1):(e({title:"Razo Social obrigatria",variant:"destructive"}),!1),x=()=>{r===2&&!g()||r===3&&!y()||n(r+1)},b=()=>{n(r-1)},w=()=>{const W=u.quadras.length+1;f({...u,quadras:[...u.quadras,{nome:`Quadra ${W}`}]})},j=W=>{f({...u,quadras:u.quadras.filter(($,ee)=>ee!==W)})},_=()=>{const W=u.mesas.length+1;f({...u,mesas:[...u.mesas,{numero:W,nome:`Mesa ${W}`}]})},C=W=>{f({...u,mesas:u.mesas.filter(($,ee)=>ee!==W)})},P=()=>{const W=prompt("Digite o nome da categoria:");W&&W.trim()&&f({...u,categorias:[...u.categorias,{nome:W.trim(),descricao:""}]})},E=W=>{f({...u,categorias:u.categorias.filter(($,ee)=>ee!==W)})},A=async()=>{try{o(!0);try{const K={user:{email:u.email?.trim()||null,nome:u.nomeUsuario?.trim()||null,cargo:u.cargo?.trim()||"admin"},empresa:{razao_social:u.razaoSocial?.trim()||null,nome_fantasia:u.nomeFantasia?.trim()||null,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa?.trim()||null,telefone:u.telefone?.trim()||null,endereco:u.endereco?.trim()||null},quadras:u.quadras||[],mesas:u.mesas||[],categorias:u.categorias||[]},{data:q,error:Y}=await he.rpc("create_company_full",{payload:K});if(!Y&&q&&q.codigo_empresa){m({success:!0,codigoEmpresa:q.codigo_empresa,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:(u.quadras||[]).length,numMesas:(u.mesas||[]).length,numCategorias:(u.categorias||[]).length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${q.codigo_empresa}`});return}else Y&&console.warn("RPC create_company_full indisponvel/erro. Usando fluxo local.",Y?.message||Y)}catch(K){console.warn("Falha ao tentar RPC create_company_full. Usando fluxo local.",K?.message||K)}let W=null;u.email.trim()&&(console.log("Email fornecido:",u.email),console.log("Nota: O vnculo com o usurio ser criado no primeiro login"),W=null);const $=await Yit();console.log("Cdigo da empresa gerado:",$);const{data:ee,error:ve}=await he.from("empresas").insert({codigo_empresa:$,nome:u.nomeFantasia,razao_social:u.razaoSocial,nome_fantasia:u.nomeFantasia,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa||null,telefone:u.telefone||null,endereco:u.endereco||null}).select().single();if(ve)throw new Error("Erro ao criar empresa: "+ve.message);const{error:_e}=await he.from("empresa_counters").insert({empresa_id:ee.id,next_cliente_codigo:1,next_agendamento_codigo:1});if(_e&&console.warn("Erro ao criar contador:",_e),u.email.trim()||u.nomeUsuario.trim())try{const K="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(J){const fe=Math.random()*16|0;return(J==="x"?fe:fe&3|8).toString(16)}),{error:q}=await he.from("usuarios").insert({id:K,email:u.email||null,nome:u.nomeUsuario||null,papel:u.cargo||"admin",codigo_empresa:$});q&&console.warn("Aviso ao criar usurio:",q.message);const{error:Y}=await he.from("colaboradores").insert({id:K,nome:u.nomeUsuario||"Administrador",cargo:u.cargo||"admin",ativo:!0,codigo_empresa:$});Y&&console.warn("Aviso ao criar colaborador:",Y.message),u.email&&(console.log(" APS O PRIMEIRO LOGIN, execute este SQL no Supabase:"),console.log(`
-- Atualizar ID do colaborador com o ID real do auth.users
UPDATE public.colaboradores 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${$}' AND id = '${K}';

-- Atualizar ID do usurio
UPDATE public.usuarios 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${$}' AND id = '${K}';
            `))}catch(K){console.warn("Erro ao criar registros de usurio:",K)}try{await he.from("agenda_settings").insert({empresa_id:ee.id,auto_confirm_enabled:!1,auto_start_enabled:!0,auto_finish_enabled:!0})}catch(K){console.warn("Aviso: no foi possvel criar agenda_settings agora (provvel RLS). Ser configurado aps o primeiro login.",K?.message||K)}if(u.quadras.length>0){const K=u.quadras.map(q=>({nome:q.nome,codigo_empresa:$}));await he.from("quadras").insert(K)}if(u.mesas.length>0){const K=u.mesas.map(q=>({numero:q.numero,nome:q.nome,codigo_empresa:$,status:"available"}));await he.from("mesas").insert(K)}if(u.categorias.length>0){const K=u.categorias.map(q=>({nome:q.nome,descricao:q.descricao||null,codigo_empresa:$,ativa:!0}));await he.from("produto_categorias").insert(K)}m({success:!0,codigoEmpresa:$,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:u.quadras.length,numMesas:u.mesas.length,numCategorias:u.categorias.length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${$}`})}catch(W){console.error("Erro ao criar empresa:",W),e({title:"Erro ao criar empresa",description:W.message,variant:"destructive"})}finally{o(!1)}},F=()=>{if(r===1||r===6)return null;const W=(r-1)/4*100;return a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("span",{className:"text-sm text-text-muted",children:["Etapa ",r-1," de 4"]}),a.jsxs("span",{className:"text-sm text-text-muted",children:[Math.round(W),"%"]})]}),a.jsx("div",{className:"h-2 bg-surface-2 rounded-full overflow-hidden",children:a.jsx(jr.div,{className:"h-full bg-brand",initial:{width:0},animate:{width:`${W}%`},transition:{duration:.3}})})]})},D=()=>a.jsxs(jr.div,{variants:fv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-md mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(xx,{className:"w-8 h-8 text-brand"})}),a.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"rea Restrita"}),a.jsx("p",{className:"text-text-muted",children:"Digite a senha para acessar"})]}),a.jsxs("form",{onSubmit:v,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"senha",children:"Senha de Acesso"}),a.jsx(Ye,{id:"senha",type:"password",value:c,onChange:W=>d(W.target.value),placeholder:"Digite a senha",className:"text-center text-lg tracking-widest",autoFocus:!0})]}),a.jsxs(me,{type:"submit",className:"w-full",children:["Acessar",a.jsx(S2,{className:"ml-2 h-4 w-4"})]})]})]},"step1"),I=()=>a.jsxs(jr.div,{variants:fv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(Du,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Primeiro Usurio"}),a.jsx("p",{className:"text-text-muted",children:"Informaes do administrador da empresa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"email",children:"Email cadastrado no Supabase Auth"}),a.jsx(Ye,{id:"email",type:"email",value:u.email,onChange:W=>f({...u,email:W.target.value}),placeholder:"usuario@email.com"}),a.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Este email j deve estar cadastrado no Supabase Auth"})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"nomeUsuario",children:"Nome Completo"}),a.jsx(Ye,{id:"nomeUsuario",type:"text",value:u.nomeUsuario,onChange:W=>f({...u,nomeUsuario:W.target.value}),placeholder:"Joo Silva"})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"cargo",children:"Cargo na Empresa"}),a.jsx(Ye,{id:"cargo",type:"text",value:u.cargo,onChange:W=>f({...u,cargo:W.target.value}),placeholder:"Ex: Proprietrio, Gerente, Administrador, Scio, etc."}),a.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Digite o cargo que voc ocupa na empresa"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(me,{type:"button",variant:"outline",onClick:()=>t("/"),className:"flex-1",children:"Cancelar"}),a.jsxs(me,{type:"button",onClick:x,className:"flex-1",children:["Prximo",a.jsx(S2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step2"),R=()=>a.jsxs(jr.div,{variants:fv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(D_,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Dados da Empresa"}),a.jsx("p",{className:"text-text-muted",children:"Informaes cadastrais da empresa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{htmlFor:"razaoSocial",children:"Razo Social *"}),a.jsx(Ye,{id:"razaoSocial",type:"text",value:u.razaoSocial,onChange:W=>f({...u,razaoSocial:W.target.value}),placeholder:"Empresa LTDA"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{htmlFor:"nomeFantasia",children:"Nome Fantasia *"}),a.jsx(Ye,{id:"nomeFantasia",type:"text",value:u.nomeFantasia,onChange:W=>f({...u,nomeFantasia:W.target.value}),placeholder:"Minha Empresa"}),a.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Como a empresa aparecer no sistema"})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"cnpj",children:"CNPJ"}),a.jsx(Ye,{id:"cnpj",type:"text",value:u.cnpj,onChange:W=>f({...u,cnpj:Kit(W.target.value)}),placeholder:"00.000.000/0000-00"})]}),a.jsxs("div",{children:[a.jsx(Le,{htmlFor:"telefone",children:"Telefone"}),a.jsx(Ye,{id:"telefone",type:"tel",value:u.telefone,onChange:W=>f({...u,telefone:Xit(W.target.value)}),placeholder:"(11) 99999-9999"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{htmlFor:"emailEmpresa",children:"Email da Empresa"}),a.jsx(Ye,{id:"emailEmpresa",type:"email",value:u.emailEmpresa,onChange:W=>f({...u,emailEmpresa:W.target.value}),placeholder:"contato@empresa.com"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(Le,{htmlFor:"endereco",children:"Endereo Completo (opcional)"}),a.jsx(Ye,{id:"endereco",type:"text",value:u.endereco,onChange:W=>f({...u,endereco:W.target.value}),placeholder:"Rua X, 123, Bairro, Cidade - UF"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(me,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[a.jsx(Uy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsxs(me,{type:"button",onClick:x,className:"flex-1",children:["Prximo",a.jsx(S2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step3"),M=()=>a.jsxs(jr.div,{variants:fv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(bd,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Configurao Inicial"}),a.jsx("p",{className:"text-text-muted",children:"Adicione dados iniciais ou pule esta etapa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Pue,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"font-semibold text-text-primary",children:"Quadras Esportivas"})]}),a.jsxs(me,{type:"button",onClick:w,size:"sm",className:"gap-2",children:[a.jsx(ns,{className:"w-4 h-4"}),"Adicionar Quadra"]})]}),u.quadras.length>0?a.jsx("div",{className:"space-y-2",children:u.quadras.map((W,$)=>a.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[a.jsx("span",{className:"text-sm text-text-primary",children:W.nome}),a.jsx(me,{type:"button",variant:"ghost",size:"sm",onClick:()=>j($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:a.jsx(el,{className:"w-4 h-4"})})]},$))}):a.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma quadra adicionada"})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(yl,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"font-semibold text-text-primary",children:"Mesas da Loja"})]}),a.jsxs(me,{type:"button",onClick:_,size:"sm",className:"gap-2",children:[a.jsx(ns,{className:"w-4 h-4"}),"Adicionar Mesa"]})]}),u.mesas.length>0?a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:u.mesas.map((W,$)=>a.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[a.jsx("span",{className:"text-sm text-text-primary",children:W.nome}),a.jsx(me,{type:"button",variant:"ghost",size:"sm",onClick:()=>C($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:a.jsx(el,{className:"w-4 h-4"})})]},$))}):a.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma mesa adicionada"})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Sd,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"font-semibold text-text-primary",children:"Categorias de Produtos"})]}),a.jsxs(me,{type:"button",onClick:P,size:"sm",className:"gap-2",children:[a.jsx(ns,{className:"w-4 h-4"}),"Adicionar Categoria"]})]}),u.categorias.length>0?a.jsx("div",{className:"space-y-2",children:u.categorias.map((W,$)=>a.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[a.jsx("span",{className:"text-sm text-text-primary",children:W.nome}),a.jsx(me,{type:"button",variant:"ghost",size:"sm",onClick:()=>E($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:a.jsx(el,{className:"w-4 h-4"})})]},$))}):a.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma categoria adicionada"})]}),a.jsx("div",{className:"bg-info/10 border border-info/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Ic,{className:"w-5 h-5 text-info mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Configuraes Opcionais"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Voc pode adicionar quadras, mesas e categorias agora ou configurar depois no sistema."})]})]})}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(me,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[a.jsx(Uy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsxs(me,{type:"button",onClick:x,className:"flex-1",children:["Prximo",a.jsx(S2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step4"),U=()=>a.jsxs(jr.div,{variants:fv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(Do,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Reviso Final"}),a.jsx("p",{className:"text-text-muted",children:"Confira os dados antes de criar a empresa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[a.jsx(Du,{className:"w-5 h-5"}),"Primeiro Usurio"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Email:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.email})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Nome:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.nomeUsuario})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Cargo:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.cargo})]})]})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[a.jsx(D_,{className:"w-5 h-5"}),"Empresa"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Razo Social:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.razaoSocial})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Nome Fantasia:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.nomeFantasia})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"CNPJ:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.cnpj})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Email:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.emailEmpresa})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Telefone:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.telefone})]}),u.endereco&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Endereo:"}),a.jsx("span",{className:"text-text-primary font-medium text-right",children:u.endereco})]})]})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[a.jsx(bd,{className:"w-5 h-5"}),"Configuraes Iniciais"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Quadras:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.quadras.length})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Mesas:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.mesas.length})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Categorias de Produtos:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.categorias.length})]})]})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Ic,{className:"w-5 h-5 text-warning mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Ateno"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Esta ao criar a empresa no banco de dados. Certifique-se de que todos os dados esto corretos."})]})]})}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(me,{type:"button",variant:"outline",onClick:b,className:"flex-1",disabled:s,children:[a.jsx(Uy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsx(me,{type:"button",onClick:A,className:"flex-1 bg-emerald-600 hover:bg-emerald-500",disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx(md,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):a.jsx(a.Fragment,{children:" Criar Empresa"})})]})]})]},"step5"),z=()=>a.jsxs(jr.div,{variants:fv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-success/10 rounded-full mb-6",children:a.jsx(Do,{className:"w-12 h-12 text-success"})}),a.jsx("h2",{className:"text-3xl font-bold text-text-primary mb-2",children:" Empresa Criada!"}),a.jsx("p",{className:"text-text-muted",children:"Tudo pronto para comear a usar o sistema"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-brand/10 border border-brand/30 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-text-muted mb-2",children:"Cdigo da Empresa"}),a.jsx("p",{className:"text-3xl font-bold text-brand font-mono",children:h?.codigoEmpresa})]})}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados de Acesso"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Email:"}),a.jsx("span",{className:"text-text-primary font-medium",children:h?.email})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Senha:"}),a.jsx("span",{className:"text-text-primary font-medium",children:"(a que voc definiu no Supabase)"})]})]})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados Criados"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),a.jsx("div",{className:"text-xs text-text-muted",children:"Empresa"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),a.jsx("div",{className:"text-xs text-text-muted",children:"Configuraes"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:h?.numQuadras}),a.jsx("div",{className:"text-xs text-text-muted",children:"Quadras"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:h?.numMesas}),a.jsx("div",{className:"text-xs text-text-muted",children:"Mesas"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:h?.numCategorias}),a.jsx("div",{className:"text-xs text-text-muted",children:"Categorias"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),a.jsx("div",{className:"text-xs text-text-muted",children:"Pronto para Uso"})]})]})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Ic,{className:"w-5 h-5 text-warning mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-text-primary mb-2",children:" IMPORTANTE: Execute o SQL Antes de Fazer Login"}),a.jsxs("div",{className:"space-y-2 text-xs text-text-muted",children:[a.jsx("p",{className:"font-semibold text-text-primary",children:"Para vincular seu usurio  empresa, siga estes passos:"}),a.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[a.jsxs("li",{children:["Abra o ",a.jsx("strong",{children:"Console do Navegador"})," (pressione F12)"]}),a.jsxs("li",{children:["Procure pela mensagem ",a.jsx("strong",{children:'" APS O PRIMEIRO LOGIN, execute este SQL"'})]}),a.jsx("li",{children:"Copie o comando SQL que aparece no console"}),a.jsxs("li",{children:["Acesse o ",a.jsx("strong",{children:"Supabase  SQL Editor"})]}),a.jsx("li",{children:"Cole e execute o SQL"}),a.jsx("li",{children:"Agora sim, faa login normalmente"})]}),a.jsx("p",{className:"mt-2 text-warning font-medium",children:' Se no executar o SQL, voc ver o erro "Empresa no vinculada"'})]})]})]})}),a.jsx("div",{className:"pt-4",children:a.jsx(me,{type:"button",onClick:()=>t("/"),className:"w-full bg-brand hover:bg-brand/90",children:"Ir para Login"})})]})]},"step6");return a.jsx(a.Fragment,{children:a.jsx("div",{className:"min-h-screen bg-background text-text-primary p-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[F(),a.jsxs(lge,{mode:"wait",children:[r===1&&D(),r===2&&I(),r===3&&R(),r===4&&M(),r===5&&U(),r===6&&z()]})]})})})}const Qit=()=>a.jsx(jr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-start mb-6",children:a.jsxs("div",{className:"flex items-end gap-3 max-w-[85%] md:max-w-[75%]",children:[a.jsx(tl,{size:"md",variant:"message"}),a.jsx("div",{className:"px-4 py-3 bg-brand border border-brand backdrop-blur-sm rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20",children:a.jsx("div",{className:"flex gap-1.5",children:[0,1,2].map(e=>a.jsx(jr.div,{className:"w-2.5 h-2.5 md:w-2 md:h-2 bg-[#0A0A0A] rounded-full",animate:{y:[0,-6,0],opacity:[.4,1,.4]},transition:{duration:.8,repeat:1/0,delay:e*.2,ease:"easeInOut"}},e))})})]})}),Zit=({buttons:e,onSelect:t,disabled:r=!1,hideText:n=!1,hidden:s=!1})=>a.jsx(jr.div,{initial:{opacity:0,y:10,gridTemplateRows:"1fr"},animate:{opacity:s?0:1,y:s?-8:0,gridTemplateRows:s?"0fr":"1fr"},transition:{duration:.6,ease:[.16,1,.3,1]},className:`grid ml-12 md:ml-[68px] overflow-hidden transition-all duration-500 ${s?"mb-0 md:mb-0 pointer-events-none":"mb-2 md:mb-3"}`,children:a.jsx("div",{className:"flex flex-wrap gap-2 md:gap-2.5",children:e.map((o,i)=>a.jsx(jr.button,{initial:{opacity:0,scale:.92,y:4,filter:"blur(2px)"},animate:{opacity:s||n?0:1,scale:s?.96:1,y:s?-8:0,filter:s?"blur(3.5px)":"blur(0px)"},transition:{duration:s?.4:.45,delay:s?i*.03:.2+i*.05,ease:[.16,1,.3,1]},whileHover:{scale:r?1:1.02,y:r?0:-2},whileTap:{scale:r?1:.98},onClick:()=>!r&&t(o),disabled:r,className:`
              group relative px-5 py-3.5 md:px-6 md:py-4 rounded-xl font-semibold text-[15px] md:text-[15px]
              transition-all duration-300 ease-out
              ${r?"bg-surface/30 text-text-muted cursor-not-allowed border border-white/5":"bg-surface/70 backdrop-blur-sm text-text-primary border border-white/10 hover:border-brand/70 hover:bg-brand/10 hover:text-brand hover:shadow-lg hover:shadow-brand/20 shadow-md"}
              ${n?"opacity-0 pointer-events-none":""}
            `,children:a.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1 relative z-10",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[o.icon&&!n&&a.jsx("span",{className:`text-base md:text-lg transition-transform duration-300 ${!r&&"group-hover:scale-110"}`,children:o.icon}),!n&&a.jsx("span",{className:"font-semibold",children:o.label})]}),o.subtitle&&!n&&a.jsx("span",{className:"text-[12px] md:text-xs opacity-70 pl-6 md:pl-7 font-normal",children:o.subtitle})]})},o.value||i))})}),elt=({children:e,onButtonClick:t,hideButtonTexts:r=!1})=>{const{messages:n,isTyping:s,chatEndRef:o}=EC(),[i,l]=p.useState(0),[c,d]=p.useState(void 0);return p.useEffect(()=>{const u=f=>{const h=!!f?.detail?.expanded,m=typeof window<"u"&&window.innerWidth<768,v=m?280:320,g=140,y=m?8:20,x=Math.max(0,v-g+y);l(h?x:0),d(h&&m?0:void 0)};try{window.addEventListener("isis-participantes-expand",u)}catch{}return()=>{try{window.removeEventListener("isis-participantes-expand",u)}catch{}}},[]),a.jsxs("div",{className:"flex flex-col min-h-full",children:[a.jsxs("div",{className:"flex-1 px-3 md:px-6 py-4 md:py-8",style:{paddingBottom:i,paddingTop:c},children:[n.map(u=>a.jsxs(jr.div,{layout:"position",transition:{duration:.35,ease:[.16,1,.3,1]},children:[a.jsx(noe,{message:u}),u.type==="buttons"&&u.buttons&&a.jsx("div",{className:`overflow-hidden transition-all duration-500 ${u.buttonsHidden?"max-h-0 mb-0 md:mb-0":"max-h-[480px]"}`,children:a.jsx(Zit,{buttons:u.buttons,onSelect:f=>(t||u.onButtonClick)?.(f,u.id),disabled:u.disabled,hideText:r,hidden:!!u.buttonsHidden})})]},u.id)),s&&a.jsx(Qit,{}),a.jsx("div",{ref:o})]}),a.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:e})]})},tlt=({onSubmit:e,onMudarData:t,onMudarQuadra:r,hasMultipleQuadras:n=!1,disabled:s=!1,horariosDisponiveis:o=[],esportes:i=[]})=>{const[l,c]=p.useState(""),[d,u]=p.useState(""),[f,h]=p.useState(""),m=o.map((g,y)=>{let x=o[y].fim,b=0,w=y+1;for(;w<o.length&&o[w].inicio===x;)b++,x=o[w].fim,w++;const j=b>=1;return{value:g.inicio,label:g.inicio,available:j}}),v=(()=>{if(!l)return[];const g=o.findIndex(w=>w.inicio===l);if(g===-1)return[];const y=[];let x=o[g].fim,b=0;for(let w=g+1;w<o.length;w++){const j=o[w];if(j.inicio!==x)break;b++,b>=1&&y.push({value:j.fim,label:j.fim,available:!0}),x=j.fim}return y})();return p.useEffect(()=>{l&&d&&f&&!s&&e({inicio:l,fim:d,esporte:f})},[l,d,f]),p.useEffect(()=>{l&&u("")},[l]),a.jsxs(jr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-sm md:text-xs",children:[a.jsx(yd,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium",children:"Horrio desejado"})]}),a.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"horario-inicio",className:"text-xs text-text-muted mb-1 block",children:"Incio"}),a.jsxs(Nn,{value:l,onValueChange:c,disabled:s,children:[a.jsx(bn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsx(wn,{className:"max-h-[300px] z-[60]",children:m.filter(g=>g.available).map(g=>a.jsx(tt,{value:g.value,children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(yd,{className:"w-4 h-4 opacity-80"}),g.label]})},g.value))})]})]}),a.jsx("div",{className:"text-text-muted font-bold text-lg pt-5",children:""}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"horario-fim",className:"text-xs text-text-muted mb-1 block",children:"Trmino"}),a.jsxs(Nn,{value:d,onValueChange:u,disabled:!l||s,children:[a.jsx(bn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:a.jsx(Cn,{placeholder:"Selecione"})}),a.jsx(wn,{className:"max-h-[300px] z-[60]",children:v.filter(g=>g.available).map(g=>a.jsx(tt,{value:g.value,children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(yd,{className:"w-4 h-4 opacity-80"}),g.label]})},g.value))})]})]})]}),a.jsxs("div",{className:"flex items-end gap-2 md:gap-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"esporte",className:"text-xs text-text-muted mb-1 block",children:"Esporte"}),a.jsxs(Nn,{value:f,onValueChange:h,disabled:s,children:[a.jsx(bn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:a.jsx(Cn,{placeholder:"Selecione o esporte"})}),a.jsx(wn,{className:"max-h-[300px] z-[60]",children:i.map(g=>a.jsx(tt,{value:g,children:g},g))})]})]}),t&&a.jsxs(jr.button,{type:"button",onClick:t,disabled:s,whileHover:{scale:s?1:1.05},whileTap:{scale:s?1:.95},className:`
              px-4 py-2.5 rounded-xl font-medium text-sm
              transition-all duration-300 shrink-0
              flex items-center gap-2
              ${s?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/70 backdrop-blur-sm border border-white/10 text-text-primary hover:bg-surface/90 hover:border-white/20"}
            `,children:[a.jsx(Vs,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden md:inline",children:"Mudar Data"}),a.jsx("span",{className:"md:hidden",children:"data"})]}),n&&r&&a.jsxs(jr.button,{type:"button",onClick:r,disabled:s,whileHover:{scale:s?1:1.05},whileTap:{scale:s?1:.95},className:`
              px-4 py-2.5 rounded-xl font-medium text-sm
              transition-all duration-300 shrink-0
              flex items-center gap-2
              ${s?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/70 backdrop-blur-sm border border-white/10 text-text-primary hover:bg-surface/90 hover:border-white/20"}
            `,children:[a.jsx(Sc,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden md:inline",children:"Mudar Quadra"}),a.jsx("span",{className:"md:hidden",children:"Quadra"})]})]})]})},rlt=({onSubmit:e,tipo:t,onTrocarTipo:r,disabled:n=!1,mostrarBotaoTrocar:s=!0})=>{const[o,i]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(!1);p.useEffect(()=>{i("")},[t]);const f=w=>{if(w){const j=ur(w,"dd/MM/yyyy",{locale:la});i(j),u(!1)}},h=w=>{const j=w.replace(/\D/g,"");return j.length<=2?`(${j}`:j.length<=7?`(${j.slice(0,2)}) ${j.slice(2)}`:j.length===10?`(${j.slice(0,2)}) ${j.slice(2,6)}-${j.slice(6)}`:j.length===11?`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7)}`:`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7,11)}`},m=w=>{const j=w.replace(/\D/g,"");return j.length<=2?j:j.length<=4?`${j.slice(0,2)}/${j.slice(2)}`:j.length<=8?`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4)}`:`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4,8)}`},v=w=>{const j=w.target.value;if(t==="telefone"){const _=h(j);i(_)}else if(t==="data_custom"){const _=m(j);i(_)}else i(j)},g=w=>{if(w.preventDefault(),!(!o.trim()||n))if(t==="telefone"){const j=o.replace(/\D/g,"");j.length===11&&(e(j),i(""))}else t==="data_custom"?o.trim()&&(e(o.trim()),i("")):o.includes("@")&&o.includes(".")&&(e(o.trim()),i(""))},y=w=>{w.key==="Enter"&&(w.preventDefault(),g(w))},x=w=>{if(w.length!==10)return{valida:!1,erro:"Data incompleta"};const j=/^(\d{2})\/(\d{2})\/(\d{4})$/,_=w.match(j);if(!_)return{valida:!1,erro:"Formato invlido"};const[,C,P,E]=_,A=new Date(parseInt(E),parseInt(P)-1,parseInt(C));if(isNaN(A.getTime())||A.getDate()!==parseInt(C)||A.getMonth()!==parseInt(P)-1||A.getFullYear()!==parseInt(E))return{valida:!1,erro:"Data invlida"};const F=new Date;return F.setHours(0,0,0,0),A.setHours(0,0,0,0),A<F?{valida:!1,erro:"Data no passado"}:{valida:!0,erro:null}},b=()=>t==="telefone"?o.replace(/\D/g,"").length===11:t==="data_custom"?x(o).valida:o.includes("@")&&o.includes(".");return a.jsxs(jr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:g,className:"flex flex-col gap-3 max-w-md mx-auto",children:[a.jsx("div",{className:"relative",children:a.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${l?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[t!=="data_custom"&&a.jsx("div",{className:`
              shrink-0 transition-colors duration-300
              ${l?"text-brand":"text-text-muted"}
            `,children:t==="telefone"?a.jsx(Ub,{className:"w-4 h-4"}):a.jsx(yx,{className:"w-4 h-4"})}),a.jsxs("div",{className:"flex-1 relative flex items-center",children:[a.jsx("input",{type:t==="data_custom"?"text":t==="telefone"?"tel":"email",value:o,onChange:v,onKeyDown:y,onFocus:()=>c(!0),onBlur:()=>c(!1),placeholder:t==="telefone"?"(00) 00000-0000":t==="data_custom"?"DD/MM/AAAA":"email@exemplo.com",disabled:n,className:`
                w-full bg-transparent text-text-primary placeholder:text-text-muted
                outline-none text-[17px] md:text-base font-medium
                ${t==="data_custom"?"pr-12":""}
                ${n?"opacity-50 cursor-not-allowed":""}
              `}),t==="data_custom"&&a.jsxs(ci,{open:d,onOpenChange:u,children:[a.jsx(di,{asChild:!0,children:a.jsx(jr.button,{type:"button",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:n,className:`
                      absolute right-1 w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-300
                      bg-brand/10 text-brand hover:bg-brand hover:text-white
                      border border-brand/20 hover:border-brand/40
                      shadow-md hover:shadow-lg hover:shadow-brand/30
                      ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
                    `,children:a.jsx(Vs,{className:"w-5 h-5"})})}),a.jsx(Jo,{className:"w-auto p-0",align:"end",children:a.jsx(ui,{mode:"single",selected:o?(()=>{try{const[w,j,_]=o.split("/");return new Date(parseInt(_),parseInt(j)-1,parseInt(w))}catch{return}})():void 0,onSelect:f,disabled:w=>{const j=new Date;return j.setHours(0,0,0,0),w<j},initialFocus:!0})})]})]}),a.jsx(jr.button,{type:"submit",whileHover:{scale:b()?1.1:1},whileTap:{scale:b()?.9:1},disabled:!b()||n,className:`
              shrink-0 w-9 h-9 rounded-full flex items-center justify-center transition-all duration-300
              ${b()?"bg-brand text-bg shadow-md hover:shadow-lg hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:a.jsx(u4,{className:"w-4 h-4"})})]})}),t==="telefone"&&o&&a.jsx("div",{className:"text-xs text-center",children:(()=>{const w=o.replace(/\D/g,""),j=w.length===11,_=w.length>0&&!j;return j?a.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Telefone vlido"}):_?a.jsxs("span",{className:"text-yellow-400 flex items-center justify-center gap-1",children:[" Digite todos os dgitos (",w.length,"/11)"]}):null})()}),t==="data_custom"&&o&&a.jsx("div",{className:"text-xs text-center",children:(()=>{const w=x(o);return w.valida?a.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Data vlida"}):o.length>0?a.jsxs("span",{className:"text-red-400 flex items-center justify-center gap-1",children:[" ",w.erro]}):null})()}),s&&t!=="data_custom"&&a.jsx("button",{type:"button",onClick:r,className:"text-sm text-brand/80 hover:text-brand hover:underline self-center py-1 px-3 rounded-lg hover:bg-brand/5 transition-all",children:t==="telefone"?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(yx,{className:"w-4 h-4"}),"Prefiro usar e-mail"]}):a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Ub,{className:"w-4 h-4"}),"Prefiro usar telefone"]})})]})},nlt=({onSubmit:e,disabled:t=!1,valorInicial:r=null,tipoInicial:n="telefone",onCorrigirTelefone:s,onCorrigirEmail:o})=>{const[i,l]=p.useState(""),[c,d]=p.useState(n==="telefone"&&r||""),[u,f]=p.useState(n==="email"&&r||""),[h,m]=p.useState(null),v=b=>{const w=b.replace(/\D/g,"");return w.length<=2?`(${w}`:w.length<=7?`(${w.slice(0,2)}) ${w.slice(2)}`:w.length<=11?`(${w.slice(0,2)}) ${w.slice(2,7)}-${w.slice(7,11)}`:`(${w.slice(0,2)}) ${w.slice(2,7)}-${w.slice(7,11)}`},g=b=>{const w=v(b.target.value);d(w)},y=b=>{if(b.preventDefault(),!i.trim())return;const w=c.replace(/\D/g,"").length>=10,j=u.trim().includes("@")&&u.trim().includes(".");if(!w&&!j)return;const _={nome:i.trim(),telefone:w?c.replace(/\D/g,""):null,email:j?u.trim():null};e(_)},x=()=>{if(!i.trim())return!1;const b=c.replace(/\D/g,"").length>=10,w=u.trim().includes("@")&&u.trim().includes(".");return b||w};return a.jsxs(jr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:y,className:"flex flex-col gap-3",children:[a.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${h==="nome"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[a.jsx(Du,{className:`w-5 h-5 transition-colors ${h==="nome"?"text-brand":"text-text-muted"}`}),a.jsx("input",{type:"text",value:i,onChange:b=>l(b.target.value),onFocus:()=>m("nome"),onBlur:()=>m(null),placeholder:"Seu nome completo",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),a.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${h==="telefone"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[a.jsx(Ub,{className:`w-5 h-5 transition-colors ${h==="telefone"?"text-brand":"text-text-muted"}`}),a.jsx("input",{type:"tel",value:c,onChange:g,onFocus:()=>m("telefone"),onBlur:()=>m(null),placeholder:"(00) 00000-0000",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),a.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${h==="email"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[a.jsx(yx,{className:`w-5 h-5 transition-colors ${h==="email"?"text-brand":"text-text-muted"}`}),a.jsx("input",{type:"email",value:u,onChange:b=>f(b.target.value),onFocus:()=>m("email"),onBlur:()=>m(null),placeholder:"email@exemplo.com (opcional)",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),(s||o)&&a.jsx("div",{className:"-mt-1 mb-1",children:n==="email"&&o?a.jsx("button",{type:"button",onClick:o,className:"text-xs text-brand/80 hover:text-brand underline underline-offset-4 px-1 py-0.5 rounded-md hover:bg-brand/5",children:"Informei o e-mail errado"}):s&&a.jsx("button",{type:"button",onClick:s,className:"text-xs text-brand/80 hover:text-brand underline underline-offset-4 px-1 py-0.5 rounded-md hover:bg-brand/5",children:"Informei o telefone errado"})}),a.jsxs(jr.button,{type:"submit",whileHover:{scale:x()?1.02:1},whileTap:{scale:x()?.98:1},disabled:!x()||t,className:`
          flex items-center justify-center gap-2 py-3 px-6 rounded-2xl
          font-semibold text-base transition-all duration-300
          ${x()?"bg-brand text-bg shadow-lg shadow-brand/20 hover:shadow-xl hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
        `,children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}),"Continuar"]}),a.jsx("p",{className:"text-xs text-text-muted text-center",children:"Preencha pelo menos telefone ou e-mail"})]})},alt=({participantesAtuais:e=[],onAdicionar:t,onRemover:r,onFinalizar:n,disabled:s=!1,onAdicionarLote:o,selfName:i,onFixedRolesDetected:l,initialModalidade:c="",modalidadeOptions:d=[]})=>{const[u,f]=p.useState(""),[h,m]=p.useState(!1),[v,g]=p.useState(!1),y=p.useRef(null),[x,b]=p.useState(!1),[w,j]=p.useState(""),[_,C]=p.useState(!1),[P,E]=p.useState([]),[A,F]=p.useState([]),[D,I]=p.useState({}),[R,M]=p.useState(!1),[U,z]=p.useState(!1),[W,$]=p.useState(null),[ee,ve]=p.useState(!1),_e=p.useRef(null),K=p.useRef(null),[q,Y]=p.useState(c||"");p.useEffect(()=>{Y(c||"")},[c]),p.useEffect(()=>{const Ne=()=>{g(window.innerWidth<768)};return Ne(),window.addEventListener("resize",Ne),()=>window.removeEventListener("resize",Ne)},[]),p.useEffect(()=>{if(x){const Ne=document.body.style.overflow;return document.body.style.overflow="hidden",E([]),F([]),I({}),M(!1),z(!1),$(null),()=>{document.body.style.overflow=Ne}}},[x]),p.useEffect(()=>{if(x&&ne&&(!P||P.length===0)){const Ne=fe(ne);E([ne]),I({[Ne]:!0}),$(Ne),z(!0),M(!0)}},[x]);const J=Ne=>Ne.normalize("NFD").replace(/[\u0300-\u036f]/g,""),fe=Ne=>J(String(Ne||"").trim().toLowerCase()).replace(/\s+/g," "),Z=Ne=>String(Ne||"").replace(/^\s*[*-]+/g,"").replace(/^\s*\d+\s*[\-\)\.]\s*/g,"").replace(/^[\W_]+|[\W_]+$/g,"").replace(//g,"").replace(/@[\S]+/g,"").replace(/\(\s*[mf]\s*\)/gi,"").replace(/\(\s*[mf][^)]*\)?/gi,"").replace(/\s{2,}/g," ").trim(),ce=Ne=>/^(espera|lista\s+de\s+espera)\b/i.test(J(String(Ne||"").trim().toLowerCase())),le=Ne=>/^(jogador|jogadores|goleiro|goleiros|convocado|convocados|jogadore?s)\b/i.test(J(String(Ne||"").trim().toLowerCase())),ie=Ne=>{const ye=J(String(Ne||"")).trim().toLowerCase();return/^(jogador|jogadores|goleiro|goleiros|convocado|convocados|levantador|levantadores)\b/.test(ye)||/^(lista\s+de\s+espera|convidad\w*)\b/.test(ye)},te=Ne=>{const ye=String(Ne||"").split(/\r?\n/);let Be=!1,mt=!1;const Ft=[];for(const Ut of ye){const xe=String(Ut||"").trim();if(!xe)continue;if(ce(xe)){Be=!0;continue}if(Be)continue;if(le(xe)){mt=!0;continue}if(!mt)continue;const st=Z(xe),Ct=/[A-Za-z---]/.test(st);st&&st.length>=2&&st.length<=60&&Ct&&!/[0-9@]/.test(st)&&Ft.push(st.split(/\s+/).map(pr=>pr&&pr[0].toUpperCase()+pr.slice(1).toLowerCase()).join(" "))}const fr=new Set,It=[];for(const Ut of Ft){const xe=fe(Ut);!xe||fr.has(xe)||(fr.add(xe),It.push(Ut))}return It},ue=Ne=>/^(reservas?)\b/i.test(J(String(Ne||"").trim().toLowerCase())),Te=Ne=>{const ye=String(Ne||"").split(/\r?\n/),Be=[];let mt=!1,Ft=!1;for(const fr of ye){const It=String(fr||"").trim();if(!It)continue;if(ce(It)){mt=!0,Ft=!1;continue}if(le(It)||ue(It)){mt=!1,Ft=!0;continue}if(mt||!Ft)continue;const Ut=Z(It),xe=/[A-Za-z---]/.test(Ut);if(!(Ut&&Ut.length>=2&&Ut.length<=60&&xe&&!/[0-9@]/.test(Ut)))continue;const Ct=Ut.split(/\s+/).map(ar=>ar&&ar[0].toUpperCase()+ar.slice(1).toLowerCase()).join(" ");ie(Ct)||Be.push(Ct)}return Be};new Set((e||[]).map(Ne=>fe(Ne.nome)));const ne=i?String(i).trim():e&&e[0]&&e[0].nome?String(e[0].nome).trim():null,de=ne?fe(ne):null,lt=Ne=>J(String(Ne||"").toLowerCase()).split(/\s+/).map(ye=>ye.trim()).filter(ye=>ye.length>=3),Nt=Ne=>{if(!ne)return!1;const ye=String(Ne||"").trim();if(!ye)return!1;if(fe(ye)===de)return!0;const Be=lt(ne),mt=lt(ye);return Be.length===0||mt.length===0?!1:mt.some(Ft=>Be.includes(Ft))},at=Ne=>{const ye=new Set;if(!Ne)return ye;const Be=String(Ne).split(/\r?\n/);let mt=!1;for(let Ft of Be){const fr=J(String(Ft||"")).toLowerCase().trim();if(!mt){/^\s*[*\-]?\s*((lista\s+de\s+)?espera|convidad\w*)\b[\s:]*$/i.test(fr)&&(mt=!0);continue}if(/^\s*\*\s*\w+|^\s*(convocad|jogad|levanta|goleir)\w*/i.test(J(Ft))){mt=!1;continue}const It=String(Ft).replace(/^\s*[*\-]+\s*/g,"").replace(/^\s*\d+\)?\s*/g,"").replace(/^[\W_]+/,"").trim(),Ut=/[A-Za-z---]/.test(It);It&&Ut&&!/[0-9@]/.test(It)&&It.length>=2&&It.length<=60&&ye.add(fe(It))}return ye},gt=Ne=>{const ye=String(Ne||"").split(/\r?\n/),Be={levantadores:[],goleiros:[]};let mt=null;for(let Ft of ye){const fr=J(String(Ft||"")).toLowerCase().trim();if(/^\s*[*\-]?\s*levanta(dor|dores|dor(es)?)\b/i.test(fr)){mt="levantadores";continue}if(/^\s*[*\-]?\s*goleir(o|os|a|as)\b/i.test(fr)){mt="goleiros";continue}if(mt){if(/(^|\s)jogador(e|es)\b/.test(fr)){mt=null;continue}if(/^\s*[*\-]?\s*(convocad|lista\s+de\s+(espera|reserva)|convidad)\b/i.test(fr)){mt=null;continue}if(/^\s*[*_]{1,3}\s*[a-z-]+/i.test(fr)){mt=null;continue}if(/^\s*[*\-]?\s*(levanta|goleir)\b/i.test(fr)){mt=null;continue}}if(!mt)continue;const It=String(Ft).replace(/^\s*[*\-]+\s*/g,"").replace(/^\s*\d+\)?\s*/g,"").replace(/^[\W_]+/,"").trim(),Ut=/[A-Za-z---]/.test(It);if(!(It&&Ut&&!/[0-9@]/.test(It)&&It.length>=2&&It.length<=60))continue;const st=It.toLowerCase().split(/\s+/).map(ar=>ar&&ar[0].toUpperCase()+ar.slice(1)).join(" "),Ct=fe(st);mt==="levantadores"?Be.levantadores.some(ar=>fe(ar)===Ct)||Be.levantadores.push(st):mt==="goleiros"&&(Be.goleiros.some(ar=>fe(ar)===Ct)||Be.goleiros.push(st))}return Be},Pt=Ne=>{Ne.preventDefault(),!(!u.trim()||s)&&(t(u.trim()),f(""),setTimeout(()=>{y.current?.focus()},100))},yt=Ne=>{Ne.key==="Enter"&&!v&&(Ne.preventDefault(),Ne.shiftKey?n&&n(q):Pt(Ne))},Qe=async()=>{if(w.trim()){C(!0),E([]),F([]),I({});try{try{console.group("[Isis Import] start"),console.debug("[Isis Import] input.length=%s preview=%o",w.length,w.slice(0,180))}catch{}const{data:Ne,error:ye}=await he.functions.invoke("parse-participants",{body:{text:w,locale:"pt-BR"}});if(ye)throw ye;if(Ne&&typeof Ne.source=="string"){console.log("[Isis Import] source=",Ne.source);try{console.debug("[Isis Import] edge.meta keys=%o",Object.keys(Ne||{}))}catch{}}const Be=at(w);try{console.debug("[Isis Import] waitlist.count=%s sample=%o",Be.size,Array.from(Be).slice(0,8))}catch{}const mt=Array.isArray(Ne?.roles?.levantadores)?Ne.roles.levantadores:[],Ft=Array.isArray(Ne?.roles?.goleiros)?Ne.roles.goleiros:[],fr=mt.length||Ft.length?{levantadores:mt,goleiros:Ft}:gt(w);try{console.debug("[Isis Import] roles.edge lev=%s gol=%s",mt.length,Ft.length)}catch{}try{mt.length||Ft.length||console.debug("[Isis Import] roles.local lev=%s gol=%s",fr.levantadores.length,fr.goleiros.length)}catch{}const It=Array.isArray(Ne?.extracted)?Ne.extracted:[];let Ut=It.filter(De=>!Be.has(fe(De)));Ut=Ut.filter(De=>!ie(De));try{console.debug("[Isis Import] extracted.raw=%s filtered=%s sample=%o",It.length,Ut.length,Ut.slice(0,10))}catch{}try{if(Ut.length<6&&/(goleir|jogador)/i.test(J(w))){const ke=te(w);try{console.debug("[Isis Import] local.mainOnly=%s sample=%o",ke.length,ke.slice(0,10))}catch{}const Ge=[...Ut],Re=new Set(Ge.map(fe));for(const bt of ke){const Qt=fe(bt);!Qt||Re.has(Qt)||Be.has(Qt)||(Re.add(Qt),Ge.push(bt))}Ut=Ge.filter(bt=>!ie(bt));try{console.debug("[Isis Import] boosted.count=%s",Ut.length)}catch{}}}catch{}const xe=Ut.some(De=>Nt(De)),st=Array.isArray(Ne?.invalid)?Ne.invalid:[],Ct=[],ar=new Set;for(const De of Ut){const ke=Z(De);if(!ke)continue;const Ge=fe(ke);if(!Ge||ar.has(Ge))continue;ar.add(Ge);const Re=ke.split(/\s+/).map(bt=>bt&&bt[0].toUpperCase()+bt.slice(1).toLowerCase()).join(" ");Ct.push(Re)}try{console.debug("[Isis Import] uniques.count=%s sample=%o",Ct.length,Ct.slice(0,12))}catch{}try{console.debug("[Isis Import] invalid.count=%s sample=%o",st.length,st.slice(0,6))}catch{}try{console.debug("[Isis Import] detectedSelf=%s self=%o",xe,ne)}catch{}const pr=te(w),Xt=new Map(pr.map((De,ke)=>[fe(De),ke])),yr=Te(w);let lr=yr&&yr.length?yr.slice(0,200):(()=>{const De=Ct.map((ke,Ge)=>({n:ke,i:Ge}));return De.sort((ke,Ge)=>{const Re=Xt.has(fe(ke.n))?Xt.get(fe(ke.n)):Number.MAX_SAFE_INTEGER,bt=Xt.has(fe(Ge.n))?Xt.get(fe(Ge.n)):Number.MAX_SAFE_INTEGER;return Re!==bt?Re-bt:ke.i-Ge.i}),De.map(ke=>ke.n).slice(0,50)})(),Rr=lr.findIndex(De=>Nt(De));if(Rr>=0){const De=lr[Rr];$(fe(De)),lr=[De,...lr.filter((ke,Ge)=>Ge!==Rr)]}else if(ne){const De=fe(ne);$(De),z(!0),lr=[ne,...lr]}else $(null);E(lr),F(st);const Pn={};ne&&(Pn[fe(ne)]=!0),Ct.slice(0,50).forEach(De=>{Pn[fe(De)]=!0}),I(Pn),M(!0),z(xe||!!ne);try{typeof l=="function"?l(fr):window.dispatchEvent(new CustomEvent("isis:fixed-roles",{detail:fr}))}catch{}try{console.debug("[Isis Import] final.suggested.count=%s sample=%o",lr.length,lr.slice(0,12))}catch{}try{console.groupEnd?.()}catch{}}catch(Ne){try{console.error("[Isis Import] error=%o",Ne)}catch{}const ye=at(w),Be=gt(w),mt=w.split(/[\n,;]+/).map(st=>st.trim()).filter(Boolean),Ft=mt.some(st=>{const Ct=st.replace(/^[\W_]+|[\W_]+$/g,"");return Nt(Ct)}),fr=[],It=new Set;for(const st of mt){const Ct=st.replace(/^[\W_]+|[\W_]+$/g,""),ar=fe(Ct),pr=/[A-Za-z---]/.test(Ct);if(!(Ct.length>=2&&Ct.length<=60&&pr&&!/[0-9@]/.test(Ct))||!ar||ye.has(ar)||It.has(ar))continue;It.add(ar);const yr=Ct.toLowerCase().split(/\s+/).map(lr=>lr&&lr[0].toUpperCase()+lr.slice(1)).join(" ");fr.push(yr)}let Ut=fr.slice(0,50);if(ne){const st=fe(ne);$(st),z(!0),Ut=[ne,...Ut]}E(Ut);const xe={};ne&&(xe[fe(ne)]=!0),fr.slice(0,50).forEach(st=>{xe[fe(st)]=!0}),I(xe),M(!0),z(Ft||!!ne);try{typeof l=="function"?l(Be):window.dispatchEvent(new CustomEvent("isis:fixed-roles",{detail:Be}))}catch{}}finally{C(!1)}}},ge=Ne=>{const ye=fe(Ne);I(Be=>({...Be,[ye]:!Be[ye]}))},rt=()=>{const Ne={...D};P.forEach(ye=>{Ne[fe(ye)]=!0}),I(Ne)},pt=()=>{const Ne={...D};P.forEach(ye=>{Ne[fe(ye)]=!1}),I(Ne)},We=()=>{const Ne=P.filter(ye=>{const Be=fe(ye);return W&&Be===W?!1:D[Be]});Ne.length!==0&&(typeof o=="function"?o(Ne):Ne.forEach(ye=>t(ye)),b(!1),j(""),E([]),F([]),I({}))},Ze=()=>{j(""),E([]),F([]),I({}),M(!1),z(!1),$(null)};return a.jsxs(jr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3 w-full",children:[a.jsxs("div",{ref:K,className:"flex items-center justify-end gap-2 scroll-mt-24 md:scroll-mt-28",children:[a.jsx("button",{type:"button",disabled:s,onClick:()=>b(!0),className:`px-3 py-1.5 rounded-lg text-sm font-semibold transition-all ${s?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/80 hover:bg-surface/60 border border-white/10 text-text-primary"}`,children:"Importar lista"}),a.jsx("div",{className:"relative",children:a.jsxs(Nn,{value:q,onValueChange:Y,disabled:s,children:[a.jsx(bn,{className:"min-w-[160px] bg-surface/70 backdrop-blur-sm border-white/10 text-sm",children:a.jsx(Cn,{placeholder:"Modalidade"})}),a.jsxs(wn,{className:"max-h-[300px] z-[70]",children:[(Array.isArray(d)?d:[]).map(Ne=>a.jsx(tt,{value:String(Ne),children:String(Ne)},String(Ne))),(!d||d.length===0)&&a.jsx(tt,{value:"",children:"Selecionar modalidade"})]})]})}),a.jsx("button",{type:"button",onClick:()=>{ve(Ne=>{const ye=!Ne;try{window.dispatchEvent(new CustomEvent("isis-participantes-expand",{detail:{expanded:ye}}))}catch{}return ye}),setTimeout(()=>{try{K.current?.scrollIntoView({behavior:"smooth",block:"start"})}catch{}},50)},className:`p-2 rounded-lg border transition-all ${ee?"bg-white/10 border-brand/40 text-brand shadow-sm":"hover:bg-white/10 border-white/10"}`,"aria-label":ee?"Recolher lista":"Expandir lista","aria-pressed":ee,children:ee?a.jsx(wg,{className:"w-4 h-4"}):a.jsx(xue,{className:"w-4 h-4"})})]}),e.length>0&&a.jsx("div",{ref:_e,className:`flex flex-col gap-1.5 ${ee?"max-h-[360px] md:max-h-[320px]":"max-h-[140px]"} overflow-y-auto px-1 transition-all`,children:e.map((Ne,ye)=>a.jsxs(jr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm ${Ne.principal?"bg-brand/10 border border-brand/30":"bg-surface/50 border border-white/10"}`,children:[a.jsx("span",{className:"w-7 shrink-0",children:a.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold ${Ne.principal?"bg-brand/20 text-brand":"bg-white/10 text-text-primary"}`,children:ye+1})}),a.jsx("span",{className:"text-base shrink-0",children:Ne.principal?"":""}),a.jsxs("span",{className:`flex-1 font-medium truncate ${Ne.principal?"text-brand":"text-text-primary"}`,children:[Ne.nome,Ne.principal&&a.jsx("span",{className:"ml-1.5 text-xs opacity-70",children:"(voc)"})]}),!Ne.principal&&r&&a.jsx(jr.button,{type:"button",onClick:()=>r(ye),whileHover:{scale:1.1},whileTap:{scale:.9},className:"shrink-0 p-1 rounded-full hover:bg-red-500/20 text-red-400 hover:text-red-300 transition-colors",title:"Remover participante",children:a.jsx(el,{className:"w-4 h-4"})})]},ye))}),a.jsxs("form",{onSubmit:Pt,className:"flex flex-col gap-2",children:[a.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${h?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[a.jsx(Wue,{className:`w-4 h-4 shrink-0 transition-colors ${h?"text-brand":"text-text-muted"}`}),a.jsx("input",{ref:y,type:"text",value:u,onChange:Ne=>f(Ne.target.value),onKeyDown:yt,onFocus:()=>m(!0),onBlur:()=>m(!1),placeholder:v?"Nome":"Nome do participante",disabled:s,autoComplete:"off",className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base font-medium min-w-0"}),a.jsx(jr.button,{type:"submit",whileHover:{scale:u.trim()?1.05:1},whileTap:{scale:u.trim()?.95:1},disabled:!u.trim()||s,className:`
              px-3 py-1.5 rounded-lg transition-all duration-300 text-sm font-semibold shrink-0
              ${u.trim()?"bg-brand text-bg shadow-md":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:"Adicionar"})]}),a.jsx(jr.button,{type:"button",onClick:()=>n&&n(q),disabled:s,whileHover:{scale:s?1:1.05},whileTap:{scale:s?1:.95},className:`
            w-full px-6 py-3.5 rounded-xl font-bold text-base
            transition-all duration-300
            ${s?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-brand text-bg shadow-lg hover:shadow-xl hover:shadow-brand/30"}
          `,children:a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsx(Uf,{className:"w-5 h-5"}),"Confirmar Participantes (",e.length,")"]})}),!v&&a.jsxs("p",{className:"text-xs text-text-muted text-center mt-1",children:[" ",a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Enter"})," adiciona  ",a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Shift+Enter"})," confirma"]})]}),x&&typeof document<"u"&&em.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[9999] overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black/75 backdrop-blur-sm",onClick:()=>!_&&b(!1)}),a.jsx("div",{className:"min-h-screen flex items-start justify-center pt-24 md:pt-16 pb-8 px-3",children:a.jsxs("div",{className:"relative w-[96vw] max-w-5xl bg-gradient-to-br from-surface via-background to-surface border border-white/10 rounded-3xl shadow-2xl flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"sticky top-0 z-10 px-5 py-4 border-b border-white/10 bg-surface/70 backdrop-blur flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(tl,{size:"sm",variant:"header"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-base md:text-lg font-extrabold text-text-primary leading-tight",children:P.length>0?"Sugestes encontradas":"Importar participantes"}),a.jsx("p",{className:"text-[11px] md:text-xs text-text-muted",children:P.length>0?`Selecione os nomes para adicionar (${P.length})`:"Cole sua lista e processe com IA"})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("button",{type:"button",disabled:_,onClick:()=>b(!1),className:"p-2 rounded-lg hover:bg-white/10",children:a.jsx(el,{className:"w-5 h-5"})})})]}),a.jsx("div",{className:"flex-1 max-h-[70vh] overflow-y-auto p-4 md:p-5",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-full",children:[a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsx("label",{className:"text-xs text-text-muted mb-2",children:"Sua lista"}),a.jsx("textarea",{value:w,onChange:Ne=>j(Ne.target.value),disabled:_,placeholder:`Exemplo:
1) Joo Silva
2) Maria Clara
3) Pedro Henrique

Dica: nomes sob os cabealhos 'Lista de espera', 'Lista de reserva' ou 'Convidados' sero ignorados.

Cole sua lista (um por linha ou separados por vrgula) e clique em Processar com sis`,className:"w-full min-h-[320px] max-h-[320px] resize-none overflow-y-auto bg-surface border border-white/10 rounded-xl p-3 outline-none text-sm focus:ring-2 focus:ring-brand/40"}),a.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",onClick:Ze,disabled:_&&!w.trim(),className:"px-4 py-2 rounded-xl font-semibold bg-surface border border-white/10 text-text-primary hover:bg-white/10 disabled:opacity-60",children:"Apagar"}),a.jsx("button",{type:"button",onClick:Qe,disabled:_||!w.trim(),className:"px-5 py-2.5 rounded-xl font-semibold shadow-lg transition bg-gradient-to-r from-brand to-emerald-500 text-white hover:shadow-emerald-500/30 disabled:opacity-60 disabled:cursor-not-allowed",children:_?"Processando":"Processar com sis"})]})]}),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[a.jsx("span",{children:"Sugeridos"}),a.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:P.length})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:rt,disabled:_,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Selecionar todos"}),a.jsx("button",{type:"button",onClick:pt,disabled:_,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Limpar"})]})]}),a.jsx("div",{className:"min-h-[320px] max-h-[320px] overflow-y-auto border border-white/10 rounded-xl bg-surface",children:_?a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative w-5 h-5",children:[a.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-tr from-brand to-emerald-500 opacity-30"}),a.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-transparent [border-image:linear-gradient(to_right,var(--tw-gradient-from),var(--tw-gradient-to))_1] animate-spin"})]}),a.jsx("span",{className:"text-xs font-semibold text-text-primary",children:"Processando com IA"})]}),a.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-white/10 text-text-muted",children:"Premium"})]}),a.jsx("div",{className:"space-y-2",children:Array.from({length:10}).map((Ne,ye)=>a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded-lg bg-white/[0.03] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0 w-full",children:[a.jsx("span",{className:"w-7 shrink-0",children:a.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold bg-white/10 text-text-muted",children:ye+1})}),a.jsx("div",{className:"relative h-3 w-full max-w-[220px] rounded bg-white/10 overflow-hidden",children:a.jsx("div",{className:"absolute inset-0 -translate-x-full animate-[shimmer_1.2s_infinite] bg-gradient-to-r from-transparent via-white/20 to-transparent"})})]}),a.jsx("div",{className:"h-4 w-4 rounded bg-white/10"})]},ye))}),a.jsx("style",{children:"@keyframes shimmer{100%{transform:translateX(100%);}}"})]}):a.jsx("ul",{className:"divide-y divide-white/5",children:P.map((Ne,ye)=>{const Be=fe(Ne),mt=R&&U&&W&&Be===W;return a.jsxs("li",{className:`flex items-center justify-between px-3 py-2 ${mt?"bg-white/5":""}`,children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"w-7 shrink-0",children:a.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold ${mt?"bg-emerald-600/25 text-emerald-400":"bg-white/10 text-text-primary"}`,children:ye+1})}),a.jsx("span",{className:"text-sm truncate pr-1",children:Ne}),mt&&a.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-emerald-600/20 text-emerald-400 border border-emerald-500/30 shrink-0",children:"Voc"})]}),a.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:mt?!0:!!D[Be],onChange:()=>!mt&&ge(Ne),disabled:mt})]},`${Be}-${ye}`)})})}),R&&P.length===0&&w.trim()&&!_&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum nome novo encontrado."}),A.length>0&&a.jsxs("div",{className:"mt-2 text-xs text-text-muted flex items-center gap-2",children:[a.jsx("span",{children:"Ignorados"}),a.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:A.length})]}),a.jsx("div",{className:"mt-3 flex items-center justify-end",children:a.jsx("button",{type:"button",onClick:We,disabled:_||P.filter(Ne=>D[fe(Ne)]).length===0,className:`px-5 py-2.5 rounded-xl font-semibold ${_||P.filter(Ne=>D[fe(Ne)]).length===0?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-emerald-600 text-white shadow-lg hover:shadow-emerald-600/30 transition"}`,children:(()=>`Adicionar selecionados (${P.reduce((ye,Be)=>{const mt=fe(Be);return R&&U&&W&&mt===W?ye+1:ye+(D[mt]?1:0)},0)})`)()})})]})]})})]})})]}),document.body)]})},slt=({onSubmit:e,disabled:t=!1})=>{const[r,n]=p.useState(0),[s,o]=p.useState(0),[i,l]=p.useState(""),[c,d]=p.useState(!1),u=g=>{g.preventDefault(),!(r===0||t)&&e({rating:r,comentario:i.trim()||null,timestamp:new Date().toISOString()})},f=g=>{t||n(g)},h=g=>{t||o(g)},m=()=>{t||o(0)},v=s||r;return a.jsx(jr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"w-full mb-8 md:mb-4",children:a.jsx("div",{className:"bg-background/98 backdrop-blur-3xl border-2 border-white/50 rounded-3xl p-6 md:p-8 shadow-2xl relative z-50",children:a.jsxs("form",{onSubmit:u,className:"flex flex-col gap-6",children:[a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(g=>a.jsx(jr.button,{type:"button",onClick:()=>f(g),onMouseEnter:()=>h(g),onMouseLeave:m,disabled:t,whileHover:{scale:t?1:1.2},whileTap:{scale:t?1:.9},className:`
                    p-2 transition-all duration-200 rounded-full
                    ${t?"cursor-not-allowed":"cursor-pointer hover:bg-brand/10"}
                  `,children:a.jsx(Bue,{className:`w-8 h-8 md:w-10 md:h-10 transition-all duration-200 ${g<=v?"fill-yellow-400 text-yellow-400 drop-shadow-lg":"text-text-muted hover:text-yellow-300"}`})},g))}),r>0&&a.jsx(jr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:a.jsxs("p",{className:"text-base font-semibold text-text-primary",children:[r===1&&" Muito ruim",r===2&&" Ruim",r===3&&" Regular",r===4&&" Bom",r===5&&" Excelente"]})})]}),r>0&&a.jsx("div",{className:"w-full h-px bg-white/10 my-2"}),r>0&&a.jsxs(jr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3,delay:.2},className:"flex flex-col gap-4",children:[a.jsxs("label",{className:"text-base font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(Rue,{className:"w-5 h-5 text-brand"}),"Comentrio (opcional)"]}),a.jsx("div",{className:`
                flex items-start gap-2 px-4 py-3 rounded-xl
                bg-background/60 backdrop-blur-sm
                border-2 transition-all duration-300
                ${c?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
              `,children:a.jsx("textarea",{value:i,onChange:g=>l(g.target.value),onFocus:()=>d(!0),onBlur:()=>d(!1),placeholder:"Conte-nos mais sobre sua experincia...",disabled:t,rows:3,maxLength:500,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base resize-none min-w-0"})}),a.jsxs("div",{className:"text-sm text-text-muted text-right",children:[i.length,"/500"]})]}),r>0&&a.jsx(jr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},className:"mt-2 mb-4",children:a.jsxs(jr.button,{type:"submit",disabled:t,whileHover:{scale:t?1:1.02},whileTap:{scale:t?1:.98},className:`
                w-full px-6 py-4 rounded-2xl font-bold text-lg
                transition-all duration-300 flex items-center justify-center gap-3
                shadow-xl border-2
                ${t?"bg-surface text-text-muted cursor-not-allowed border-white/10":"bg-gradient-to-r from-brand to-brand/90 text-white shadow-brand/30 hover:shadow-2xl hover:shadow-brand/40 border-brand/20 hover:from-brand/90 hover:to-brand"}
              `,children:[a.jsx(u4,{className:"w-6 h-6"}),"Enviar Avaliao"]})})]})})})},olt=({message:e="Carregando..."})=>{const t=[" sis IA iniciando..."," Processando dados em tempo real..."," IA analisando disponibilidade..."," sis aprendendo suas preferncias..."," Assistente virtual ativando..."," IA otimizando seu agendamento..."," sis calculando melhores opes..."," Sincronizando com IA..."," Inteligncia artificial carregando..."," sis processando informaes..."],r=t[Math.floor(Math.random()*t.length)];return a.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-surface/30 to-background",children:a.jsx(jr.div,{className:"absolute inset-0 opacity-20",animate:{background:["radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 80% 50%, #FFAA33 0%, transparent 50%)","radial-gradient(circle at 50% 20%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}})}),a.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(6)].map((n,s)=>a.jsx(jr.div,{className:"absolute w-2 h-2 rounded-full",style:{background:s%2===0?"#FF6600":"#FFAA33",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[-20,-100,-20],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},s))}),a.jsxs(jr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.8,ease:[.22,1,.36,1]},className:"relative z-10 text-center",children:[a.jsxs("div",{className:"mb-8 flex flex-col items-center gap-6",children:[a.jsxs(jr.div,{className:"relative",animate:{rotateY:[0,360]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:[a.jsx(jr.div,{className:"absolute inset-0 rounded-2xl blur-xl opacity-60",style:{background:"#FFAA33"},animate:{scale:[1,1.2,1],opacity:[.4,.8,.4]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),a.jsx(jr.div,{className:"relative w-20 h-20 md:w-24 md:h-24 rounded-2xl flex items-center justify-center",style:{background:"#FFAA33"},whileHover:{scale:1.05},children:a.jsx(Sc,{className:"w-12 h-12 md:w-14 md:h-14 text-white",strokeWidth:2})})]}),a.jsxs(jr.div,{className:"flex items-baseline gap-1",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3},children:[a.jsx(jr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FF6600"},animate:{textShadow:["0 0 10px rgba(255, 102, 0, 0.5)","0 0 20px rgba(255, 102, 0, 0.8)","0 0 10px rgba(255, 102, 0, 0.5)"]},transition:{duration:2,repeat:1/0},children:"Fluxo"}),a.jsx(jr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FFAA33"},animate:{textShadow:["0 0 10px rgba(255, 170, 51, 0.5)","0 0 20px rgba(255, 170, 51, 0.8)","0 0 10px rgba(255, 170, 51, 0.5)"]},transition:{duration:2,repeat:1/0,delay:.1},children:"7"}),a.jsx(jr.span,{className:"font-medium text-4xl md:text-5xl ml-2",style:{color:"#B0B0B0"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.6},children:"Arena"})]})]}),a.jsx("div",{className:"w-64 md:w-80 mx-auto mb-6",children:a.jsx("div",{className:"h-1 bg-surface/30 rounded-full overflow-hidden",children:a.jsx(jr.div,{className:"h-full rounded-full",style:{background:"linear-gradient(90deg, #FFAA33, #FFD700, #FFAA33)"},animate:{x:[-100,300]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},initial:{x:-100}})})}),a.jsxs(jr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.8},className:"space-y-3",children:[a.jsx(jr.p,{className:"text-base md:text-lg font-medium text-text-primary px-4",animate:{opacity:[.7,1,.7]},transition:{duration:1.5,repeat:1/0},children:r}),a.jsx("div",{className:"flex justify-center gap-1",children:[0,1,2].map(n=>a.jsx(jr.div,{className:"w-2 h-2 rounded-full",style:{background:"#FFAA33"},animate:{scale:[.8,1.2,.8],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:n*.2}},n))})]})]})]})},ilt={greeting:["Ol! Eu sou a Isis  Vou te ajudar a agendar sua quadra! Qual voc prefere?","Oi! Sou a Isis!  Vamos agendar? Me diz, qual quadra voc quer?","E a! Isis aqui! Bora marcar sua partida? Qual quadra te interessa?","Ol!  Prazer, sou a Isis! Qual quadra voc quer reservar?","Opa! Isis na rea! Vamos agendar sua quadra? Qual delas?","Seja bem-vindo! Sou a Isis e vou facilitar sua reserva! Qual quadra?"],afterQuadra:["Boa escolha! {quadra}  tima!  Para qual dia?","Perfeito! {quadra}  top! Qual dia voc quer?","{quadra} confirmada!  Me diz, que dia?","Show! {quadra}  sucesso aqui! Qual o dia?","Anotado! {quadra}  Agora me fala o dia:","Excelente! {quadra}  uma das melhores! Para quando?"],afterData:["Beleza! {data} anotado!  Qual horrio voc prefere?","timo! {data} t disponvel! Que horas?","{data}  logo ali!  Me diz o horrio:","Confirmado {data}! Qual horrio te atende melhor?","Perfeito! {data}  Agora escolhe o horrio:","Show! {data} t livre! Qual o melhor horrio pra voc?"],afterHorario:["{horario}  seu!  Qual modalidade?","Reservado {horario}!  Vai ser qual modalidade?","Fechou {horario}! Qual esporte?","{horario} confirmado! Me diz a modalidade:","Show! {horario}  E a modalidade ...?","Perfeito! {horario} garantido! Qual modalidade?"],afterModalidade:["{modalidade}! Massa!  Quantas pessoas vo jogar?","Vai ser {modalidade}! Legal! Quantos jogadores?","{modalidade}  bom demais!  Quantas pessoas?","Top! {modalidade}  Me diz quantas pessoas:","{modalidade} confirmado! Quantos vo jogar?","timo! {modalidade}  show! Quantos participantes?"],askNames:["Agora preciso dos nomes! Digite cada um (um por linha):","Beleza! Me manda os nomes dos participantes:","Show! Lista os nomes pra mim:","timo! Quais so os nomes?","Perfeito! Me passa os nomes de todo mundo:","Legal! Agora os nomes dos jogadores:"],askContact:["ltimos dados! Qual seu nome completo?","Agora preciso do seu nome e telefone:","Quase l! Me passa seu nome e WhatsApp:","Beleza! Seus dados para contato:","Falta pouco! Nome completo e telefone:","ltima etapa! Qual seu nome e telefone?"],reviewData:["timo! Vamos conferir tudo antes de confirmar:","Perfeito! Revisa comigo os dados:","Show! Confirma se t tudo certo:","Beleza! D uma olhada se est correto:","Legal! Vamos revisar juntos:","Massa! Confere os detalhes aqui:"],confirmation:[" Tudo certo! Agendamento #{codigo} confirmado!"," Pronto! Seu agendamento #{codigo} est garantido!"," Feito! Cdigo #{codigo} confirmado!"," Sucesso! Agendamento #{codigo} t na agenda!"," Confirmado! #{codigo}  seu!"," Show! Agendamento #{codigo} marcado!"],thankYou:["Obrigada por agendar conosco! At logo! ","Valeu! Te vejo no jogo! ","Brigada! Bom jogo! ","Obrigada! At a partida! ","Valeu pela preferncia! At breve! ","Obrigada! Qualquer coisa,  s voltar aqui! "],loading:["Deixa eu verificar...","S um momento...","Aguarda um pouquinho...","Consultando aqui...","Verificando pra voc..."],error:["Ops! Algo deu errado. Vamos tentar de novo?","Eita! Tive um problema aqui. Podemos recomear?","Putz! Deu erro. Tenta novamente?","Opa! Algo no funcionou. Vamos de novo?","Caramba! Erro aqui. Pode tentar novamente?"],noAvailability:["Puts... esse horrio j foi reservado.  Escolhe outro?","Eita! Esse j est ocupado. Que tal outro horrio?","Opa! Esse horrio acabou de ser reservado. Tem outro?","Poxa! Algum reservou esse agora mesmo. Outro horrio?","Xiii! Esse j foi. Bora escolher outro?"]},mv=(e,t={})=>{const r=ilt[e];if(!r||r.length===0)return console.warn(`[Isis] Nenhuma variao encontrada para step: ${e}`),"Ol! Como posso ajudar?";const n=Math.floor(Math.random()*r.length);let s=r[n];return Object.keys(t).forEach(o=>{const i=new RegExp(`\\{${o}\\}`,"g");s=s.replace(i,t[o])}),s},tV=e=>{try{const t=JSON.parse(localStorage.getItem("isis-feedbacks")||"[]");return t.push(e),localStorage.setItem("isis-feedbacks",JSON.stringify(t)),console.log("[ISIS Feedback] Salvo localmente como fallback:",e.id),e}catch(t){return console.error("[ISIS Feedback] Erro ao salvar localmente:",t),e}},llt=async e=>{const t={id:Date.now()+Math.random().toString(36).substr(2,9),timestamp:new Date().toISOString(),estrelas:e?.rating??null,nome_cliente:e?.cliente_nome??null,empresa:e?.empresa_nome??null,projeto:"fluxo7arena",comentario:e?.comentario??null};try{const r={id:t.id,cod_cliente:e?.cliente_codigo??e?.cliente_id??e?.cod_cliente??null,nome_cliente:e?.cliente_nome||null,empresa:e?.empresa_nome||null,projeto:"fluxo7arena",nota:e?.rating??null,comentario:e?.comentario||null,conversa:Array.isArray(e?.conversaArray)?JSON.stringify(e.conversaArray):typeof e?.conversa=="string"?e.conversa:null,timestamp:t.timestamp},{error:n}=await xY.from("isis").insert(r);return n?(console.error("[Supabase ISIS] Erro ao inserir feedback:",n),tV({...t,projeto:"fluxo7arena"})):(console.log("[Supabase ISIS] Feedback inserido com sucesso:",r.id),t)}catch(r){return console.error("[Supabase ISIS] Exceo ao inserir feedback, salvando localmente:",r),tV(t)}},clt=()=>{const{nomeFantasia:e}=ide(),t=Se.useMemo(()=>{try{if(typeof window>"u")return null;const De=window.location.host||"",ke="f7arena.com";if(!De.endsWith(ke))return null;const Ge=De.slice(0,-ke.length).replace(/\.$/,"");if(!Ge)return null;const Re=Ge.toLowerCase();return Re==="www"?null:Re}catch{return null}},[]),r=e||t;Ri();const[n,s]=p.useState(null),{currentStep:o,selections:i,addIsisMessage:l,addIsisMessageWithButtons:c,addUserMessage:d,disableAllButtons:u,removeMessageById:f,hideButtonsInMessage:h,updateSelection:m,updateContact:v,nextStep:g,setIsLoading:y,setIsTyping:x,chatEndRef:b,sessionId:w,messages:j}=EC(),[_,C]=p.useState(null),[P,E]=p.useState([]),[A,F]=p.useState([]),[D,I]=p.useState(!0),[R,M]=p.useState("telefone"),[U,z]=p.useState(!1),[W,$]=p.useState(null),[ee,ve]=p.useState(null),[_e,K]=p.useState(!1),[q,Y]=p.useState(null),[J,fe]=p.useState(null);if(typeof window<"u"&&new URLSearchParams(window.location.search||"").get("crash")==="1")throw new Error("Isis forced crash test");const Z=De=>De?De.replace(/([A-Z])/g," $1").replace(/([0-9]+)/g," $1").trim().split(/[\s_-]+/).filter(Boolean).map(Ge=>Ge.charAt(0).toUpperCase()+Ge.slice(1).toLowerCase()).join(" "):"",ce=Se.useMemo(()=>_?_.isis_display_name?_.isis_display_name:r?Z(r):_.nome_fantasia?_.nome_fantasia:_.razao_social?_.razao_social:"Arena":"",[_,r]),le=Se.useMemo(()=>_?.logo_url?`${_.logo_url}?v=${Date.now()}`:_?.logo_url||"",[_?.logo_url]);p.useEffect(()=>{(async()=>{if(!r){I(!1);return}try{const Ge=decodeURIComponent(r).toLowerCase().replace(/[\s\-_]+/g,"").trim();let Re=null,bt=null;try{const{data:xt}=await he.from("agenda_settings").select("empresa_id, isis_subdomain, isis_display_name, empresas(codigo_empresa, nome_fantasia, razao_social, nome, logo_url, telefone, id)").eq("isis_subdomain",Ge).single();xt?.empresas&&(Re=xt.empresas,bt=xt.isis_display_name)}catch{}if(!Re){let xt=null;try{const{data:it,error:kt}=await he.rpc("get_empresa_public_by_slug",{p_slug:Ge});!kt&&it&&it.length>0&&(xt=it[0])}catch{}Re=xt||null}if(!Re){const{data:xt,error:it}=await he.from("empresas").select("codigo_empresa, nome_fantasia, razao_social, nome, logo_url, id");if(!it&&Array.isArray(xt)){const kt=xt.find(be=>[be?.nome_fantasia||"",be?.razao_social||"",be?.nome||""].some(Lt=>Lt.toLowerCase().replace(/[\s\-_]+/g,"").trim()===Ge));kt&&(Re=kt)}}const Qt=Re?.id||Re?.codigo_empresa;if(Re&&!bt&&Qt)try{let xt=null,it=null;if(Re.id){const kt=await he.from("agenda_settings").select("isis_subdomain, empresa_id").eq("empresa_id",Re.id).single();xt=kt.data,it=kt.error}else if(Re.codigo_empresa){const{data:kt}=await he.from("empresas").select("id").eq("codigo_empresa",Re.codigo_empresa).single();if(kt?.id){const be=await he.from("agenda_settings").select("isis_subdomain, empresa_id").eq("empresa_id",kt.id).single();xt=be.data,it=be.error}}if(xt?.isis_subdomain){console.error("[Isis] Acesso bloqueado. Use o subdomnio configurado."),s(null),I(!1);return}}catch{}if(!Re){console.error("[Isis] Empresa no encontrada"),s(null),I(!1);return}if(!bt&&Re.id)try{const{data:xt}=await he.from("agenda_settings").select("isis_display_name").eq("empresa_id",Re.id).single();xt?.isis_display_name&&(bt=xt.isis_display_name)}catch{}const ct={...Re,isis_display_name:bt};C(ct),s(Re.codigo_empresa),I(!1)}catch(ke){console.error("[Isis] Erro ao buscar empresa:",ke),s(null),I(!1)}})()},[r]),p.useEffect(()=>{const De=ke=>{try{ke.preventDefault()}catch{}Y(ke)};return window.addEventListener("beforeinstallprompt",De),()=>window.removeEventListener("beforeinstallprompt",De)},[]),p.useEffect(()=>{try{if(!(new URLSearchParams(window.location.search||"").get("install")==="1"))return;const Ge=window.__installPrompt||q,Re=()=>{const bt=[" Como instalar o app:",""," Chrome (Android/PC):","  1) Toque nos 3 pontinhos () do navegador",'  2) Escolha "Instalar app" ou "Adicionar  tela inicial"','  3) Confirme em "Instalar"',""," Safari (iPhone/iPad):","  1) Toque no boto Compartilhar (quadrado com seta )",'  2) Selecione "Adicionar  Tela de Incio"','  3) Toque em "Adicionar"'].join(`
`);l(bt,400),setTimeout(()=>{l("Beleza! O que voc gostaria de fazer agora?",600),setTimeout(()=>{try{Pt()}catch{}},800)},700)};(async()=>{try{Ge?.prompt&&(Ge===q&&Y(null),Ge===window.__installPrompt&&(window.__installPrompt=null),await Ge.prompt(),await Ge.userChoice)}catch{}Re()})()}catch{}},[q]),p.useEffect(()=>{!n||D||!i.cliente&&!_e&&(K(!0),setTimeout(()=>{te()},2500))},[n,D,i.cliente,_e]),p.useEffect(()=>{(async()=>{if(!n){I(!1);return}try{console.log("[useEffect] Definindo empresa atual para RLS:",n),await he.rpc("set_current_empresa",{empresa_codigo:String(n)}),await Qe()}catch(ke){console.error("[useEffect] Erro ao definir empresa para RLS:",ke),await Qe()}})()},[n]);const ie=()=>{const ke=new Date().getHours();return ke>=5&&ke<12?"Bom dia":ke>=12&&ke<18?"Boa tarde":"Boa noite"},te=()=>{console.log("[DEBUG] iniciarIdentificacao INICIOU:",{loadingEmpresa:D,empresa:_?.nome_fantasia,timestamp:new Date().toISOString()}),M("telefone"),z(!1);const De=ie(),ke=[`**${De}!** Tudo bem? 

Sou a **sis**, assistente virtual da **${ce}** e estou aqui para tornar seu **agendamento** super fcil!

Para comear, qual seu **telefone** ou **e-mail**?`,`Hey! **${De}!**  **sis** na rea!

Sou a assistente virtual da **${ce}** e vim facilitar sua vida.

Bora **agendar**? Me passa seu **telefone** ou **e-mail**:`,`**${De}!** Prazer em te atender! 

Sou a **sis** da **${ce}**, sua assistente virtual para **agendamentos**.

Para comear, preciso do seu **telefone** ou **e-mail**:`,`Opa! **${De}!**  **sis** aqui, sua assistente virtual da **${ce}**!

Vamos **marcar seu horrio**?  rapidinho!

Me informa seu **telefone** ou **e-mail**:`,`**${De}!** Seja bem-vindo! 

Eu sou a **sis**, sua assistente virtual aqui na **${ce}**.

Vou te ajudar a **agendar seu horrio** rapidinho!

Informe seu **telefone** ou **e-mail**:`],Ge=Math.floor(Math.random()*ke.length);console.log("[DEBUG] Mostrando indicador de digitao primeiro:",{loadingEmpresa:D,timestamp:new Date().toISOString()}),x(!0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll inicial para mostrar indicador de digitao"),b.current?.scrollIntoView({behavior:"smooth",block:"end"})},300),setTimeout(()=>{console.log("[DEBUG] Enviando mensagem da Isis aps indicador de digitao"),x(!1),l(ke[Ge],0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll aps mensagem aparecer"),b.current?.scrollIntoView({behavior:"smooth",block:"end"})},100)},3500),setTimeout(()=>{console.log("[DEBUG] Mostrando input"),z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"end"})},200)},3500+600),g("identificacao")},ue=async De=>{try{console.log("[DEBUG] Buscando cliente com valor:",De),console.log("[DEBUG] Cdigo empresa:",n);const ke=De.replace(/\D/g,"");if(ke.length>=10){console.log("[DEBUG] Buscando telefone:",ke);const{data:bt,error:Qt}=await he.from("clientes").select("id, nome, email, telefone, whatsapp, celular1, codigo").eq("codigo_empresa",n).eq("status","active");if(Qt)throw Qt;console.log("[DEBUG] Total de clientes ativos:",bt?.length);const ct=bt?.find(xt=>{const it=(xt.telefone||"").replace(/\D/g,""),kt=(xt.whatsapp||"").replace(/\D/g,""),be=(xt.celular1||"").replace(/\D/g,"");return it.includes(ke)||kt.includes(ke)||be.includes(ke)});return console.log("[DEBUG] Cliente encontrado:",ct),ct||null}const{data:Ge,error:Re}=await he.from("clientes").select("id, nome, email, telefone, whatsapp, codigo").eq("codigo_empresa",n).eq("status","active").ilike("email",`%${De}%`);if(Re)throw Re;return Ge?.[0]||null}catch(ke){return console.error("Erro ao buscar cliente:",ke),null}},Te=De=>{const ke=De.trim().split(" ").filter(Ge=>Ge);return ke.length===1?ke[0]:ke.length>=2?`${ke[0]} ${ke[1]}`:ke[0]},ne=async De=>{if(!De){l("Por favor, informe a data desejada.",400);return}const ke=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,Ge=De.match(ke);if(!Ge){l("**Formato invlido!** Por favor, use o formato DD/MM/AAAA (exemplo: 15/12/2024)",400);return}const[,Re,bt,Qt]=Ge,ct=new Date(parseInt(Qt),parseInt(bt)-1,parseInt(Re));if(isNaN(ct.getTime())||ct.getDate()!==parseInt(Re)||ct.getMonth()!==parseInt(bt)-1||ct.getFullYear()!==parseInt(Qt)){l("**Data invlida!** Verifique se o dia, ms e ano esto corretos.",400);return}const xt=new Date;if(xt.setHours(0,0,0,0),ct.setHours(0,0,0,0),ct<xt){l("**Data no passado!** Por favor, escolha uma data de hoje em diante.",400);return}d(De);const it=ur(ct,"dd/MM/yyyy",{locale:la}),kt=ur(ct,"EEEE",{locale:la});y(!0);const be=await We(i.quadra.id,ct);if(y(!1),be.fechada){if(be.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${it}** (${kt}). 

**Motivo:** ${be.observacao}`,800);else if(be.motivo==="dia_semana"){const tr=ur(ct,"EEEE",{locale:la});l(`**Ops!** A quadra no funciona ${tr==="domingo"||tr==="sbado"?"aos":"s"} **${tr}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{l("Digite **outra data** no formato DD/MM/AAAA:",1200),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},400)},1200);return}m("data",ct),z(!1),M("telefone"),l(`**Perfeito!** Data escolhida: **${it}** (${kt}) `,600);const dt=be.slots;if(dt.length===0){l("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outra data?",800),setTimeout(()=>{perguntarData()},1200);return}const Lt=Ze(dt);let mr="";Lt.length===1?mr=`Tenho **horrios livres** das **${Lt[0].inicio}** s **${Lt[0].fim}**! `:mr=`Tenho **horrios livres** ${Lt.map((Or,Lr)=>Lr===Lt.length-1?`e das **${Or.inicio}** s **${Or.fim}**`:Lr===0?`das **${Or.inicio}** s **${Or.fim}**`:`das **${Or.inicio}** s **${Or.fim}**`).join(", ")}! `,l(mr,1e3),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",1200),g("horario"),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},1600)},de=async De=>{if(R==="data_custom")return await ne(De);if(!De){l("Por favor, informe seu telefone ou e-mail.",400);return}const ke=R==="telefone"?`(${De.slice(0,2)}) ${De.slice(2,7)}-${De.slice(7)}`:De;d(ke);const Ge=await ue(De);if(Ge){m("cliente",Ge),z(!1);const Re=Te(Ge.nome),bt=[`**${Re}!** `,`Opa, **${Re}!** `,`E a, **${Re}!** `,`**${Re}!** Que bom te ver! `,`Fala, **${Re}!** `,`**${Re}!** Tudo bem? `,`Hey, **${Re}!** `],Qt=Math.floor(Math.random()*bt.length);l(bt[Qt],600);let ct="telefone";try{ct=i?.identificacao_tipo||R||"telefone",fe(ct==="email"?"email":"telefone")}catch{}const xt=ct==="email"?"email":"telefone";setTimeout(()=>{Pt(xt)},600)}else m("identificacao_valor",ke),m("identificacao_tipo",R),z(!1),l("No encontrei seu cadastro. Sem problemas! Vamos fazer rapidinho. ",800),l("Preciso de algumas informaes:",1400),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+800),g("cadastro")},lt=async De=>{let ke=`Nome: ${De.nome}`;if(De.telefone){const Ge=`(${De.telefone.slice(0,2)}) ${De.telefone.slice(2,7)}-${De.telefone.slice(7)}`;ke+=`
Telefone: ${Ge}`}De.email&&(ke+=`
E-mail: ${De.email}`),d(ke),z(!1),await Nt(De.nome,De.email,De.telefone)},Nt=async(De,ke,Ge)=>{try{y(!0);try{if(Ge){const xt=String(Ge||"").replace(/\D/g,""),{data:it,error:kt}=await he.from("clientes").select("id, nome, email, telefone, whatsapp, celular1, codigo").eq("codigo_empresa",n).eq("status","active");if(!kt&&Array.isArray(it)){const be=it.find(dt=>{const Lt=(dt.telefone||"").replace(/\D/g,""),mr=(dt.whatsapp||"").replace(/\D/g,""),tr=(dt.celular1||"").replace(/\D/g,"");return Lt===xt||mr===xt||tr===xt});if(be){y(!1),m("cliente_sugerido",be),c(`Encontrei um cadastro existente para este telefone: **${Te(be.nome)}**.  voc?`,[{label:" Sim, sou eu",value:"confirm_cliente_existente"},{label:" No, quero corrigir",value:"corrigir_cadastro"}],200),z(!1),g("confirmar_cliente_existente");return}}}if(ke){const xt=String(ke||"").trim().toLowerCase(),{data:it,error:kt}=await he.from("clientes").select("id, nome, email, telefone, whatsapp, codigo").eq("codigo_empresa",n).eq("status","active").ilike("email",xt);if(!kt&&Array.isArray(it)&&it.length>0){const be=it.find(dt=>String(dt.email||"").trim().toLowerCase()===xt)||null;if(be){y(!1),m("cliente_sugerido",be),c(`Este e-mail j possui cadastro: **${Te(be.nome)}**.  voc?`,[{label:" Sim, sou eu",value:"confirm_cliente_existente"},{label:" No, quero corrigir",value:"corrigir_cadastro"}],200),z(!1),g("confirmar_cliente_existente");return}}}}catch{}l(mv("loading"));const{data:Re}=await he.from("empresa_counters").select("next_cliente_codigo").eq("empresa_id",_?.id).single(),bt=Re?.next_cliente_codigo||1,{data:Qt,error:ct}=await he.from("clientes").insert({codigo_empresa:n,codigo:bt,nome:De,email:ke||null,telefone:Ge,whatsapp:Ge,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(ct){if(ct.code==="23505"&&ct.message.includes("uq_clientes_empresa_codigo")){console.log("[Isis] Cdigo duplicado, tentando prximo cdigo...");const{data:xt,error:it}=await he.from("clientes").insert({codigo_empresa:n,codigo:bt+1,nome:De,email:ke||null,telefone:Ge,whatsapp:Ge,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(it)throw it;await he.from("empresa_counters").update({next_cliente_codigo:bt+2}).eq("empresa_id",_?.id),y(!1),z(!1),m("cliente",xt),l(`Pronto, ${De}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{yt()},1400);return}throw ct}await he.from("empresa_counters").update({next_cliente_codigo:bt+1}).eq("empresa_id",_?.id),y(!1),z(!1),m("cliente",Qt),l(`Pronto, ${De}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{yt()},1400)}catch(Re){console.error("Erro ao criar cliente:",Re),y(!1),l("Ops! Erro ao criar cadastro. Tente novamente.",400)}},at=()=>{const De=new Date,ke=La(De,1),Ge=[{label:`Hoje (${ur(De,"dd/MM")})`,value:ur(De,"yyyy-MM-dd"),icon:"",date:De},{label:`Amanh (${ur(ke,"dd/MM")})`,value:ur(ke,"yyyy-MM-dd"),icon:"",date:ke},{label:"Outro dia...",value:"custom",icon:""}];Array.isArray(P)&&P.length>1&&Ge.push({label:"Mudar quadra",value:"mudar_quadra",icon:""}),Ge.push({label:" Menu",value:"menu",action:"menu"}),c("Para qual dia voc gostaria de agendar?",Ge,600),g("data")},gt=()=>{d(" Mudar Data"),z(!1),setTimeout(()=>{at()},400)},Pt=(De=null)=>{const ke=["O que voc gostaria de fazer hoje?","Como posso te ajudar?","Qual  o plano para hoje?","O que vamos fazer?","Em que posso te auxiliar?","Qual sua necessidade hoje?","Como posso ser til?"],Ge=ke[Math.floor(Math.random()*ke.length)];let Re=[{label:"Fazer Agendamento",value:"novo_agendamento",icon:""},{label:"Editar Agendamento",value:"buscar_agendamento",icon:""},{label:"Finalizar Atendimento",value:"finalizar_atendimento",icon:""}];const bt=De||J;bt==="telefone"?Re=[Re[0],Re[1],{label:"Informei o telefone errado",value:"corrigir_telefone",icon:""},Re[2]]:bt==="email"&&(Re=[Re[0],Re[1],{label:"Informei o e-mail errado",value:"corrigir_email",icon:""},Re[2]]),c(Ge,Re,600),J&&setTimeout(()=>fe(null),0)},yt=async()=>{let De=P,ke=_;if(!De||De.length===0){const Ge=await Qe(!1);if(De=Ge.quadras,ke=Ge.empresa,!De||De.length===0){console.error("[iniciarAgendamento] Quadras ainda no disponveis aps carregar!"),l("Ops! No consegui carregar as quadras. Tente novamente.",600);return}}if(!ke){console.error("[iniciarAgendamento] Empresa no disponvel!"),l("Ops! No consegui carregar os dados da empresa. Tente novamente.",600);return}setTimeout(()=>{ge(De,ke,!0)},800)},Qe=async(De=!0)=>{try{De&&I(!0);const ke=Date.now(),Ge=3500,{data:Re,error:bt}=await he.from("empresas").select("*").eq("codigo_empresa",n).single();if(bt)throw bt;if(!Re)return Kj({title:"Empresa no encontrada",description:"Verifique o cdigo e tente novamente",variant:"destructive"}),{empresa:null,quadras:[]};C(kt=>({...Re,isis_display_name:kt?.isis_display_name||Re.isis_display_name})),m("empresa",Re);const{data:Qt,error:ct}=await he.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status, descricao").eq("codigo_empresa",String(n)).eq("status","Ativa").order("nome",{ascending:!0});if(ct)throw console.error("[loadEmpresa] Erro ao buscar quadras:",ct),ct;if(!Qt||Qt.length===0){console.warn("[loadEmpresa] Nenhuma quadra encontrada devido a RLS. Criando quadra temporria.");const kt=[{id:"temp-quadra-1004",nome:"Quadra Principal",modalidades:["Futebol","Futsal"],hora_inicio:"07:00:00",hora_fim:"22:00:00",valor:30,codigo_empresa:String(n),status:"Ativa",descricao:"Quadra temporria (problema de permisso)"}];return E(kt),{empresa:Re,quadras:kt}}E(Qt||[]);const xt=Date.now()-ke,it=Math.max(0,Ge-xt);return it>0&&await new Promise(kt=>setTimeout(kt,it)),{empresa:Re,quadras:Qt||[]}}catch(ke){console.error("[Isis] Erro ao carregar empresa:",ke);const Ge=Date.now()-startTime,Re=Math.max(0,minLoadingTime-Ge);return Re>0&&await new Promise(bt=>setTimeout(bt,Re)),Kj({title:"Erro ao carregar",description:"No foi possvel carregar os dados da empresa",variant:"destructive"}),{empresa:null,quadras:[]}}finally{De&&I(!1)}},ge=(De,ke,Ge=!1)=>{if(ie(),De.length===1){const Qt=De[0];if(Ge){const ct=[`Perfeito! Agora vamos **agendar** seu horrio na **${Qt.nome}!** `,`timo! Vou te ajudar a **marcar sua partida** na **${Qt.nome}!** `,`Show! Bora **agendar** a **${Qt.nome}?** `,`Perfeito! Vamos **marcar sua reserva** na **${Qt.nome}!** `],xt=Math.floor(Math.random()*ct.length),it=ct[xt];l(it)}m("quadra",Qt),setTimeout(()=>{const ct=new Date,xt=La(ct,1),it=[{label:`Hoje (${ur(ct,"dd/MM")})`,value:ur(ct,"yyyy-MM-dd"),icon:"",date:ct},{label:`Amanh (${ur(xt,"dd/MM")})`,value:ur(xt,"yyyy-MM-dd"),icon:"",date:xt},{label:"Outro dia...",value:"custom",icon:""},{label:" Menu",value:"menu",action:"menu"}];c("Para qual dia voc gostaria de agendar?",it,800),g("data")},1200);return}let Re;if(Ge){const Qt=["Qual quadra voc quer reservar? ","Qual quadra te interessa? ","Me diz, qual quadra? ","Qual quadra voc prefere? ","Bora escolher a quadra? Qual delas? "],ct=Math.floor(Math.random()*Qt.length);Re=Qt[ct]}else return;const bt=De.map(Qt=>({label:Qt.nome,subtitle:Qt.descricao||null,value:Qt.id,icon:"",quadra:Qt}));bt.push({label:" Menu",value:"menu",action:"menu"}),c(Re,bt),g("quadra")},rt=async De=>{if(De.action==="menu"){d(" Menu");try{ve(null)}catch{}try{m("editing_agendamento",null)}catch{}try{m("quadra",null)}catch{}try{m("data",null)}catch{}try{m("horario",null)}catch{}try{m("modalidade",null)}catch{}try{m("quantidade",null)}catch{}try{m("nomes",[])}catch{}try{m("participantes",[])}catch{}try{m("levantadores",[])}catch{}try{m("goleiros",[])}catch{}try{m("fixos",[])}catch{}try{m("fixoRoles",{})}catch{}try{$(null)}catch{}try{z(!1)}catch{}g("identificacao"),setTimeout(()=>{Pt()},400);return}const ke=De.quadra;if(!ke){console.error("[handleQuadraSelection] Quadra no encontrada no boto:",De);return}if(d(ke.nome),m("quadra",ke),o==="review"){z(!1),$("horario"),y(!0);const ct=await We(ke.id,i.data,ee?.id);if(y(!1),ct.fechada){const it=ur(i.data,"dd/MM/yyyy",{locale:la}),kt=ur(i.data,"EEEE",{locale:la});if(ct.motivo==="data_especifica")l(`**Ops!** A **${ke.nome}** estar **fechada** no dia **${it}** (${kt}). 

**Motivo:** ${ct.observacao}`,800);else if(ct.motivo==="dia_semana"){const be=ur(i.data,"EEEE",{locale:la}),dt=be==="domingo"||be==="sbado"?"aos":"s";l(`**Ops!** A **${ke.nome}** no funciona ${dt} **${be}s**. `,800)}setTimeout(()=>{l("Escolha **outra quadra** ou **mude a data**:",1200),setTimeout(()=>{at()},400)},1600);return}const xt=ct.slots;if(xt&&xt.length>0){const it=Ze(xt);let kt="";it.length===1?kt=`Tenho **horrios livres** das **${it[0].inicio}** s **${it[0].fim}**! `:kt=`Tenho **horrios livres** ${it.map((dt,Lt)=>Lt===it.length-1?`e das **${dt.inicio}** s **${dt.fim}**`:Lt===0?`das **${dt.inicio}** s **${dt.fim}**`:`das **${dt.inicio}** s **${dt.fim}**`).join(", ")}! `,console.log("[handleQuadraSelection] Mostrando horrios disponveis e input de horrio"),l(kt,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleQuadraSelection] Ativando showInput=true"),z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleQuadraSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia. "),setTimeout(()=>{l("Que tal tentar **outra data**? ",800),setTimeout(()=>{at()},400)},1200);return}console.log("[handleQuadraSelection] Fluxo normal (no edio)");const Ge=mv("afterQuadra",{quadra:ke.nome});l(Ge,600);const Re=new Date,bt=La(Re,1),Qt=[{label:`Hoje (${ur(Re,"dd/MM")})`,value:ur(Re,"yyyy-MM-dd"),icon:"",date:Re},{label:`Amanh (${ur(bt,"dd/MM")})`,value:ur(bt,"yyyy-MM-dd"),icon:"",date:bt},{label:"Outro dia...",value:"custom",icon:""},{label:" Menu",value:"menu",action:"menu"}];c("Para qual dia voc gostaria de agendar?",Qt,1e3),g("data")},pt=async De=>{if(console.log("[handleDataSelection] Iniciando...",{button:De,currentStep:o}),De.action==="menu"){d(" Menu");try{ve(null)}catch{}try{m("editing_agendamento",null)}catch{}try{m("quadra",null)}catch{}try{m("data",null)}catch{}try{m("horario",null)}catch{}try{m("modalidade",null)}catch{}try{m("quantidade",null)}catch{}try{m("nomes",[])}catch{}try{m("participantes",[])}catch{}try{m("levantadores",[])}catch{}try{m("goleiros",[])}catch{}try{m("fixos",[])}catch{}try{m("fixoRoles",{})}catch{}try{$(null)}catch{}try{z(!1)}catch{}g("identificacao"),setTimeout(()=>{Pt()},400);return}if(De.value==="custom"){d(" Outro dia..."),l("**Perfeito!** Me informe a **data desejada** no formato DD/MM/AAAA:",600),M("data_custom"),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},800);return}const ke=De.date;if(!ke){console.error("[handleDataSelection] Data no encontrada no boto:",De);return}if(d(De.label),m("data",ke),!!i?.editing_agendamento||!!ee){console.log("[handleDataSelection] Modo edio detectado - recarregando horrios"),console.log("[handleDataSelection] Quadra ID:",i.quadra?.id),console.log("[handleDataSelection] Nova Data:",ke),z(!1),$("horario"),y(!0);const xt=await We(i.quadra.id,ke,ee?.id);if(console.log("[handleDataSelection] Resultado:",xt),y(!1),xt.fechada){const kt=ur(ke,"dd/MM/yyyy",{locale:la}),be=ur(ke,"EEEE",{locale:la});if(xt.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${kt}** (${be}). 

**Motivo:** ${xt.observacao}`,800);else if(xt.motivo==="dia_semana"){const dt=ur(ke,"EEEE",{locale:la});l(`**Ops!** A quadra no funciona ${dt==="domingo"||dt==="sbado"?"aos":"s"} **${dt}s**. `,800)}setTimeout(()=>{l("Escolha **outra data**:",1200),setTimeout(()=>{at()},400)},1600);return}const it=xt.slots;if(it&&it.length>0){const kt=Ze(it);let be="";kt.length===1?be=`Tenho **horrios livres** das **${kt[0].inicio}** s **${kt[0].fim}**! `:be=`Tenho **horrios livres** ${kt.map((Lt,mr)=>mr===kt.length-1?`e das **${Lt.inicio}** s **${Lt.fim}**`:mr===0?`das **${Lt.inicio}** s **${Lt.fim}**`:`das **${Lt.inicio}** s **${Lt.fim}**`).join(", ")}! `,console.log("[handleDataSelection] Mostrando horrios disponveis e input"),l(be,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleDataSelection] Ativando showInput=true"),z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleDataSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia.  Tente outra data.");return}console.log("[handleDataSelection] Fluxo normal (no edio)"),y(!0);const Re=await We(i.quadra.id,ke);if(console.log("[handleDataSelection] Resultado (fluxo normal):",Re),y(!1),Re.fechada){const xt=ur(ke,"dd/MM/yyyy",{locale:la}),it=ur(ke,"EEEE",{locale:la});if(Re.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${xt}** (${it}). 

**Motivo:** ${Re.observacao}`,800);else if(Re.motivo==="dia_semana"){const kt=ur(ke,"EEEE",{locale:la});l(`**Ops!** A quadra no funciona ${kt==="domingo"||kt==="sbado"?"aos":"s"} **${kt}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{l("Que tal tentar **outra data**? ",1200),setTimeout(()=>{at()},400)},1600);return}const bt=Re.slots;if(bt.length===0){console.log("[handleDataSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outro dia?"),setTimeout(()=>{l("Escolha **outra data**:",800),setTimeout(()=>{at()},400)},1200);return}const Qt=Ze(bt);let ct="";Qt.length===1?ct=`Tenho **horrios livres** das **${Qt[0].inicio}** s **${Qt[0].fim}**! `:ct=`Tenho **horrios livres** ${Qt.map((it,kt)=>kt===Qt.length-1?`e das **${it.inicio}** s **${it.fim}**`:kt===0?`das **${it.inicio}** s **${it.fim}**`:`das **${it.inicio}** s **${it.fim}**`).join(", ")}! `,l(ct,800),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",1e3),g("horario"),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},1e3)},1e3+600)},1400)},We=async(De,ke,Ge=null)=>{try{console.log("[loadHorariosDisponiveis] quadraId:",De),console.log("[loadHorariosDisponiveis] data:",ke);const Re=P.find(fn=>fn.id===De);if(!Re)return console.error("[loadHorariosDisponiveis] Quadra no encontrada:",De),[];console.log("[loadHorariosDisponiveis] Quadra encontrada:",Re.nome),console.log("[loadHorariosDisponiveis] Horrio funcionamento:",Re.hora_inicio,"-",Re.hora_fim);const bt=ur(ke,"yyyy-MM-dd"),Qt=ke.getDay();console.log("[loadHorariosDisponiveis] Verificando funcionamento para:",bt,"dia da semana:",Qt);const{data:ct,error:xt}=await he.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",n).eq("quadra_id",De).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${bt}),and(tipo.eq.dia_semana,dia_semana.eq.${Qt})`);if(xt)console.error("[loadHorariosDisponiveis] Erro ao buscar configuraes de funcionamento:",xt);else{console.log("[loadHorariosDisponiveis] Configuraes encontradas:",ct?.length||0);const fn=ct?.find(mn=>mn.tipo==="data_fechamento"&&mn.data_fechamento===bt);if(fn&&!fn.funciona)return console.log("[loadHorariosDisponiveis] Quadra fechada em data especfica:",fn.observacao),{slots:[],fechada:!0,motivo:"data_especifica",observacao:fn.observacao||"Fechamento especial"};const Tn=ct?.find(mn=>mn.tipo==="dia_semana"&&mn.dia_semana===Qt);if(Tn&&!Tn.funciona)return console.log("[loadHorariosDisponiveis] Quadra no funciona neste dia da semana"),{slots:[],fechada:!0,motivo:"dia_semana",observacao:`Quadra fechada s ${["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"][Qt]}s`};console.log("[loadHorariosDisponiveis] Quadra funciona normalmente na data selecionada")}const it=Es(ke),kt=La(it,1);let be=he.from("agendamentos").select("inicio, fim, status").eq("codigo_empresa",n).eq("quadra_id",De).gte("inicio",it.toISOString()).lt("inicio",kt.toISOString()).neq("status","canceled");Ge&&(be=be.neq("id",Ge),console.log("[loadHorariosDisponiveis] Excluindo agendamento sendo editado:",Ge));const{data:dt,error:Lt}=await be;if(Lt)throw Lt;console.log("[loadHorariosDisponiveis] Agendamentos encontrados:",dt?.length||0);const mr=parseInt(Re.hora_inicio?.split(":")[0]||"6");let tr=parseInt(Re.hora_fim?.split(":")[0]||"24");tr===0&&(tr=24);const Or=new Date,Lr=Es(ke).getTime()===Es(Or).getTime(),sr=[];for(let fn=mr;fn<tr;fn++)for(let Tn of[0,30]){const mn=V2(U2(ke,fn),Tn),zn=ywe(mn,30);if(Lr&&mn<Or)continue;dt?.some($t=>{const Yt=new Date($t.inicio),Ht=new Date($t.fim),Ot=Math.floor(mn.getTime()/6e4),Xr=Math.floor(zn.getTime()/6e4),Je=Math.floor(Yt.getTime()/6e4),cr=Math.floor(Ht.getTime()/6e4);return Xr===Je||Ot===cr?!1:Ot<cr&&Xr>Je})||sr.push({inicio:ur(mn,"HH:mm"),fim:ur(zn,"HH:mm"),inicioDate:mn,fimDate:zn})}return console.log("[loadHorariosDisponiveis] Total de slots disponveis:",sr.length),F(sr),{slots:sr,fechada:!1,motivo:null,observacao:null}}catch(Re){return console.error("[loadHorariosDisponiveis] Erro ao carregar horrios:",Re),F([]),{slots:[],fechada:!1,motivo:"erro",observacao:"Erro ao carregar horrios"}}},Ze=De=>{if(De.length===0)return[];const ke=[];let Ge={inicio:De[0].inicio,fim:De[0].fim};for(let bt=1;bt<De.length;bt++)De[bt].inicio===Ge.fim?Ge.fim=De[bt].fim:(ke.push(Ge),Ge={inicio:De[bt].inicio,fim:De[bt].fim});ke.push(Ge);const Re=bt=>{const[Qt,ct]=bt.split(":").map(Number);return Qt===0&&ct===0?24*60:Qt*60+ct};return ke.filter(bt=>Re(bt.fim)-Re(bt.inicio)>=60)},Ne=({inicio:De,fim:ke,esporte:Ge})=>{const[Re,bt]=De.split(":").map(Number),[Qt,ct]=ke.split(":").map(Number),xt=i.data,it=V2(U2(xt,Re),bt),kt=Qt===0&&ct===0?V2(U2(La(xt,1),0),0):V2(U2(xt,Qt),ct),be={inicio:De,fim:ke,inicioDate:it,fimDate:kt};if(d(`${be.inicio} - ${be.fim}  ${Ge}`),console.log("[handleHorarioSubmit] Atualizando horrio:",be),console.log("[handleHorarioSubmit] Atualizando esporte:",Ge),m("horario",be),m("esporte",Ge),z(!1),o==="review"||W==="horario"){setTimeout(()=>{$(null),g("review"),fr(be,Ge)},600);return}const dt=[{nome:i.cliente.nome,cliente_id:i.cliente.id,principal:!0}];m("participantes",dt);const Lt=Te(i.cliente.nome);l(`Perfeito! ${Lt}, voc j est na lista! `,800),l('Quer adicionar mais pessoas? Digite o nome e clique em "Adicionar" para cada um, ou finalize quando quiser.',1400),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+600),g("participantes")},ye=De=>{if(!De||!De.trim())return;const ke=i.participantes||[],Ge={nome:De.trim(),cliente_id:null,principal:!1},Re=[...ke,Ge];m("participantes",Re)},Be=De=>{if(!Array.isArray(De)||De.length===0)return;const ke=kt=>String(kt||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g," "),Ge=i.cliente,Re=Ge?.nome?String(Ge.nome).trim():null,bt=Re?ke(Re):null,Qt=i.participantes||[],ct=Qt.length>0?Qt:Re&&Ge?[{nome:Re,cliente_id:Ge.id,principal:!0}]:[],xt=[];if(!!i?.editing_agendamento){let kt=ct.find(be=>be.principal)||(Re&&Ge?{nome:Re,cliente_id:Ge.id,principal:!0}:null);kt&&xt.push({...kt,principal:!0}),De.forEach(be=>{const dt=String(be||"").trim();if(!dt)return;const Lt=ke(dt);bt&&Lt===bt||xt.push({nome:dt,cliente_id:null,principal:!1})})}else ct.forEach(kt=>{const be=ke(kt.nome),dt=bt&&be===bt;xt.push({...kt,principal:dt})}),De.forEach(kt=>{const be=String(kt||"").trim();if(!be)return;const dt=ke(be);bt&&dt===bt||xt.push({nome:be,cliente_id:null,principal:!1})});xt.length===0&&Re&&Ge&&xt.push({nome:Re,cliente_id:Ge.id,principal:!0}),m("participantes",xt)},mt=De=>{const ke=i.participantes||[];if(De===0)return;const Ge=ke.filter((Re,bt)=>bt!==De);m("participantes",Ge)},Ft=De=>{const ke=i.participantes||[];if(ke.length===0){l("Voc precisa ter pelo menos 1 participante!",400);return}try{const Re=(De||"").trim();Re&&Re!==i.esporte&&m("esporte",Re)}catch{}z(!1);const Ge=ke.length;if(Ge===1)d(" Apenas eu por enquanto");else{const Re=ke.filter(bt=>!bt.principal).map(bt=>bt.nome).join(", ");d(` Eu + ${Re} (${Ge} pessoas)`)}setTimeout(()=>{$(null);try{const Re=(De||"").trim();fr(null,Re||null)}catch{fr()}},600)},fr=(De=null,ke=null,Ge=!1,Re=null,bt=null,Qt=null,ct=null)=>{const xt=De||i.horario,it=ke||i.esporte,kt=Re||i.quadra,be=bt||i.data,dt=Qt||i.participantes||[],Lt=!!(ct||i?.editing_agendamento||ee);if(console.log("[mostrarResumo] Selections atuais:",i),console.log("[mostrarResumo] Horrio usado:",xt),console.log("[mostrarResumo] Esporte usado:",it),console.log("[mostrarResumo] Quadra atual:",kt),console.log("[mostrarResumo] Data atual:",be),console.log("[mostrarResumo] Modo edio inicial:",Ge),!be||!xt||!kt){console.error("[mostrarResumo] Dados obrigatrios faltando:",{dataFinal:be,horarioFinal:xt,quadraFinal:kt});return}if(!Ge){const Me=mv("reviewData");l(Me,400)}const mr=dt.map((Me,et)=>{const re=et===0?"":"",O=et===0?" (voc)":"";return`${re} ${Me.nome}${O}`}).join(`
`),tr=ur(be,"dd/MM/yyyy",{locale:la}),Or=ur(be,"EEEE",{locale:la}),[Lr,sr]=xt.inicio.split(":").map(Number),[fn,Tn]=xt.fim.split(":").map(Number);let mn=fn*60+Tn-(Lr*60+sr);fn===0&&Tn===0&&(mn=24*60-(Lr*60+sr));const zn=Math.floor(mn/60),ot=mn%60,$t=ot>0?`${zn}h ${ot}min`:`${zn}h`,Yt=kt.valor||0,Ht=mn/30,Ot=Math.round(Yt*Ht*100)/100,Xr=Ot/dt.length;console.log("[mostrarResumo] Clculo do valor:"),console.log("- Valor por meia hora:",Yt),console.log("- Slots de 30min:",Ht),console.log("- Durao em minutos:",mn),console.log("- Valor total:",Ot),console.log("- Participantes:",dt.length),console.log("- Valor dividido:",Xr);const Je=i?.empresa?.endereco&&String(i.empresa.endereco).trim().length>0?String(i.empresa.endereco).trim():null,cr=Je?`
 **Endereo**
${Je}
`:"",vt=Me=>{if(!Me)return"N/A";const et=String(Me).replace(/\D/g,"");return et.length===11?`(${et.slice(0,2)}) ${et.slice(2,7)}-${et.slice(7)}`:et.length===10?`(${et.slice(0,2)}) ${et.slice(2,6)}-${et.slice(6)}`:Me},Tt=i.cliente.telefone||i.cliente.whatsapp||null,Dr=vt(Tt),an=` **RESUMO DO AGENDAMENTO**

 **Quadra**
${kt.nome}${cr}
 **Data**
${tr} (${Or})

 **Horrio**
${xt.inicio} s ${xt.fim}
 Durao: **${$t}**

 **Modalidade**
${it}

 **Participantes** (${dt.length})
${mr}

 **Valor Total**
R$ **${Ot.toFixed(2).replace(".",",")}**
 **Valor Dividido**
R$ **${Xr.toFixed(2).replace(".",",")}** por pessoa

 **Responsvel**
${i.cliente.nome}
 ${Dr}`,Nr=Ge?200:1e3,St=an.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:an,copyable:!0,copyText:St},Nr);const Fr=[{label:Lt?"Salvar Alteraes":"Confirmar Agendamento",value:Lt?"confirm":"criar agendamento",icon:""}],zr=[];P.length>1&&zr.push({label:"Editar Quadra",value:"edit_quadra",icon:""}),zr.push({label:"Editar Data",value:"edit_data",icon:""}),zr.push({label:"Editar Horrio e Esporte",value:"edit_horario",icon:""}),zr.push({label:"Editar Participantes",value:"edit_participantes",icon:""}),(Ge||Lt&&!i?.editing_agendamento)&&zr.push({label:"Gerar Times",value:"gerar_times",icon:""}),Lt&&zr.push({label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""});const En=[...Fr,...zr];En.push({label:" Menu",value:"menu",action:"menu"}),c("Est tudo correto?",En,Ge?400:1600),g("review")},It=(De,ke=!1)=>{l(ke?" **Perfeito!** Suas **alteraes** foram **salvas com sucesso!**":" **Pronto!** Seu **agendamento** foi **confirmado com sucesso!**",600,"green");const Re=i.participantes||[],bt=Re.map(Yt=>` ${Yt.nome}`).join(`
`),Qt=ur(i.data,"dd/MM/yyyy",{locale:la}),ct=ur(i.data,"EEEE",{locale:la}),[xt,it]=i.horario.inicio.split(":").map(Number),[kt,be]=i.horario.fim.split(":").map(Number);let dt=kt*60+be-(xt*60+it);kt===0&&be===0&&(dt=24*60-(xt*60+it));const Lt=Math.floor(dt/60),mr=dt%60,tr=mr>0?`${Lt}h ${mr}min`:`${Lt}h`,Or=i.quadra.valor||0,Lr=dt/30,sr=Math.round(Or*Lr*100)/100,fn=Re.length>0?sr/Re.length:0,Tn=i?.empresa?.endereco&&String(i.empresa.endereco).trim().length>0?String(i.empresa.endereco).trim():null,mn=Tn?`
 **Endereo**
${Tn}
`:"",zn=` **AGENDAMENTO CONFIRMADO**

 **Cdigo:** #${De.codigo}

 **Local**
${i.quadra.nome}${mn}

 **Quando**
${Qt} (${ct})
 ${i.horario.inicio} s ${i.horario.fim} **(${tr})**

 **Modalidade**
${i.esporte}

 **Participantes** (${Re.length})
${bt}

 **Valor Total:** R$ **${sr.toFixed(2).replace(".",",")}**
 **Valor Dividido:** R$ **${fn.toFixed(2).replace(".",",")}** por pessoa

 **Responsvel:** ${i.cliente.nome}`,ot=zn.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:zn,copyable:!0,copyText:ot},1200),c("O que voc gostaria de fazer?",[{label:"Gerar Times",value:"gerar_times",icon:""},{label:"Editar Agendamento",value:"editar_agendamento",icon:""},{label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""},{label:"Finalizar Atendimento",value:"finalizar",icon:""}],1800)},Ut=async()=>{try{x(!0)}catch{}try{const De=(i.participantes||[]).map(Je=>String(Je?.nome||"").trim()).filter(Boolean);if(!De||De.length===0){l("No h participantes suficientes para formar times.");return}const ke=String(i?.esporte||i?.quadra?.tipo||"").toLowerCase();let Ge=0,Re="unknown";try{console.log("[Teams] Start generation modalidade=%o",ke)}catch{}try{const{data:Je}=await he.functions.invoke("infer-team-size",{body:{modalidade:ke,quadra:i?.quadra||null,totalPlayers:(i.participantes||[]).length}});try{console.log("[Teams] Edge infer-team-size response=%o",Je)}catch{}Je&&Number(Je.teamSize)>0&&(Ge=Number(Je.teamSize),Re="edge")}catch{}if(!Ge)if(/(praia|areia)/i.test(ke)){Ge=5,Re="fallback:beach";try{console.log("[Teams] Fallback matched: praia/areia -> teamSize=5")}catch{}}else if(/(v[o]lei|voleibol)/i.test(ke)){Ge=6,Re="fallback:volley";try{console.log("[Teams] Fallback matched: volei/voleibol -> teamSize=6")}catch{}}else if(/(hand|handebol)/i.test(ke)){Ge=7,Re="fallback:hand";try{console.log("[Teams] Fallback matched: handebol -> teamSize=7")}catch{}}else if(/(futsal|society)/i.test(ke)){Ge=5,Re="fallback:futsal";try{console.log("[Teams] Fallback matched: futsal/society -> teamSize=5")}catch{}}else if(/(futebol|campo)/i.test(ke)){Ge=11,Re="fallback:campo";try{console.log("[Teams] Fallback matched: futebol/campo -> teamSize=11")}catch{}}else{Ge=5,Re="fallback:default";try{console.log("[Teams] Fallback matched: default -> teamSize=5")}catch{}}{const Je=String(ke||"").toLowerCase(),cr=/(v[o]lei|voleibol)/.test(Je),vt=/(praia|areia)/.test(Je),Tt=Ge;cr&&(Ge=vt?5:6),cr&&(Re=vt?"forced:beach":"forced:volley");try{console.log("[Teams] Normalization: isVolley=%s isBeach=%s before=%s after=%s source=%s",cr,vt,Tt,Ge,Re)}catch{}}const bt=Je=>String(Je||"").trim().toLowerCase(),Qt=Array.isArray(i?.fixos)?i.fixos:[],ct=Array.isArray(i?.goleiros)?i.goleiros:[],xt=Array.isArray(i?.levantadores)?i.levantadores:[],it=new Set([...Qt,...ct,...xt].map(bt).filter(Boolean)),kt=Je=>it.has(bt(Je)),be=(()=>{const Je={},cr=i?.fixoRoles;if(cr&&typeof cr=="object")for(const vt of Object.keys(cr))Je[vt]=cr[vt];return ct.forEach(vt=>{Je[bt(vt)]="Goleiro"}),xt.forEach(vt=>{Je[bt(vt)]="Levantador"}),Je})(),dt=Je=>kt(Je)?` (${be[bt(Je)]||"Fixo"})`:"",Lt=De.filter(kt),tr=De.filter(Je=>!kt(Je)).slice();for(let Je=tr.length-1;Je>0;Je--){const cr=Math.floor(Math.random()*(Je+1));[tr[Je],tr[cr]]=[tr[cr],tr[Je]]}Ge<2&&(Ge=2);const Or=Je=>Je.map((cr,vt)=>`${vt+1}) ${cr}${dt(cr)}`).join(`
`)||"",Lr=De.length;let sr=0;if(Lr>=2*Ge){sr=Math.max(2,Math.floor(Lr/Ge));try{console.log("[Teams] Brute rule: canMakeTwoBase=true -> teamCount=%s teamSize=%s",sr,Ge)}catch{}}else{const Je=Ge;Ge>5&&(Ge=5),sr=Math.ceil(Lr/Ge);try{console.log("[Teams] Brute rule: canMakeTwoBase=false -> forceSize %s->%s, teamCount=%s",Je,Ge,sr)}catch{}}let mn=` **Times gerados (${ke?ke[0].toUpperCase()+ke.slice(1):"modalidade"})**`;const zn=["","","","","",""],ot=(ke||"").toLowerCase(),$t=/(fut|society|sal[a]o)/.test(ot),Yt=/(v[o]lei|volei|voleibol)/.test(ot);try{console.log("[Teams] teamSize=%s totalPlayers=%s teamCount=%s isVolleyLike=%s isSoccerLike=%s source=%s",Ge,Lr,sr,Yt,$t,Re)}catch{}if(sr>=2){const Je=Array.from({length:sr},()=>[]);if($t&&ct.length>0)for(let Nr=0;Nr<sr;Nr++){const St=ct[Nr%ct.length],Fr=Je[Nr].some(zr=>ct.includes(zr));Je[Nr].length<Ge&&!Fr&&!Je[Nr].includes(St)&&Je[Nr].push(St)}if(Yt&&xt.length>0)for(let Nr=0;Nr<sr;Nr++){const St=xt[Nr%xt.length],Fr=Je[Nr].some(zr=>xt.includes(zr));Je[Nr].length<Ge&&!Fr&&!Je[Nr].includes(St)&&Je[Nr].push(St)}const cr=Lt.filter(Nr=>!ct.includes(Nr)&&!xt.includes(Nr));if(cr.length>0){let Nr=0;for(const St of cr){let Fr=0;for(;Fr<sr&&Je[Nr].length>=Ge;)Nr=(Nr+1)%sr,Fr++;Je[Nr].length<Ge&&Je[Nr].push(St),Nr=(Nr+1)%sr}}for(const Nr of tr){let St=0,Fr=1/0;for(let zr=0;zr<Je.length;zr++)Je[zr].length<Fr&&Je[zr].length<Ge&&(Fr=Je[zr].length,St=zr);Je[St].length<Ge&&Je[St].push(Nr)}for(let Nr=0;Nr<Je.length;Nr++)for(;Je[Nr].length<Ge;)if($t&&ct.length>0){if(Je[Nr].some(zr=>ct.includes(zr)))break;const Fr=ct.find(zr=>!Je[Nr].includes(zr));if(Fr)Je[Nr].push(Fr);else break}else if(Yt&&xt.length>0){if(Je[Nr].some(zr=>xt.includes(zr)))break;const Fr=xt.find(zr=>!Je[Nr].includes(zr));if(Fr)Je[Nr].push(Fr);else break}else break;const vt=sr*Ge,Tt=Lr>vt?[...Lt,...tr].slice(vt):[];$t&&ct.length>0?Tt.some(St=>ct.includes(St))||Tt.unshift(ct[0]):Yt&&xt.length>0&&(Tt.some(St=>xt.includes(St))||Tt.unshift(xt[0]));try{const Nr=Je.map(St=>St.length);console.log("[Teams] Final distribution teamSize=%s teams=%o reservas=%o",Ge,Nr,Tt)}catch{}const Dr=[];for(;Tt.length>=Ge;)Dr.push(Tt.splice(0,Ge));Je.concat(Dr).forEach((Nr,St)=>{const Fr=zn[St%zn.length];mn+=`

**${Fr} Time ${St+1} (${Nr.length})**:
${Or(Nr)}`}),Tt.length&&(mn+=`

** Reservas (${Tt.length})**:
${Or(Tt)}`)}else{const Je=[...Lt,...tr];if(Je.length===0){l("No h participantes suficientes para formar times.");return}if(Je.length===1)mn+=`

 Ainda no h jogadores suficientes para formar 2 times. Adicione mais participantes.`,mn+=`

** Time 1 (1)**:
1) ${Je[0]}${dt(Je[0])}`;else{const cr=Math.min(Ge,Math.ceil(Je.length/2)),vt=Math.min(Ge,Je.length-cr),Tt=Je.slice(0,cr),Dr=Je.slice(cr,cr+vt);mn+=`

 Jogadores insuficientes para 2 equipes completas de ${Ge}. Montei 2 times balanceados de ${Tt.length} e ${Dr.length}.`,mn+=`

** Time 1 (${Tt.length})**:
${Or(Tt)}`,mn+=`

** Time 2 (${Dr.length})**:
${Or(Dr)}`}}const Ht=mn.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:mn,copyable:!0,copyText:Ht},600);const Xr=[...!0?[{label:"Gerar novamente",value:"gerar_times_again",icon:""}]:[],{label:"Concluir",value:"aceitar_times",icon:""}];c("Tudo certo com os times?",Xr,1400)}catch{l("No foi possvel gerar times agora. Tente novamente.")}},xe=async De=>{if(De.action==="menu"){d(" Menu");try{ve(null)}catch{}try{m("editing_agendamento",null)}catch{}try{m("quadra",null)}catch{}try{m("data",null)}catch{}try{m("horario",null)}catch{}try{m("modalidade",null)}catch{}try{m("quantidade",null)}catch{}try{m("nomes",[])}catch{}try{m("participantes",[])}catch{}try{m("levantadores",[])}catch{}try{m("goleiros",[])}catch{}try{m("fixos",[])}catch{}try{m("fixoRoles",{})}catch{}try{$(null)}catch{}try{z(!1)}catch{}g("identificacao"),setTimeout(()=>{Pt()},400);return}if(De.quadra){await rt(De);return}if(De.date){await pt(De);return}if(De.agendamento){const ke=ur(new Date(De.agendamento.inicio),"dd/MM/yyyy",{locale:la}),Ge=ur(new Date(De.agendamento.inicio),"HH:mm"),Re=ur(new Date(De.agendamento.fim),"HH:mm");d(`${ke}  ${Ge}-${Re}`),await Ct(De.agendamento);return}switch(De.value){case"novo_agendamento":{d(" Fazer Agendamento");try{ve(null)}catch{}try{m("editing_agendamento",null)}catch{}try{m("quadra",null)}catch{}try{m("data",null)}catch{}try{m("horario",null)}catch{}try{m("modalidade",null)}catch{}try{m("quantidade",null)}catch{}try{m("nomes",[])}catch{}try{m("participantes",[])}catch{}try{m("levantadores",[])}catch{}try{m("goleiros",[])}catch{}try{m("fixos",[])}catch{}try{m("fixoRoles",{})}catch{}try{$(null)}catch{}try{z(!1)}catch{}await yt();break}case"buscar_agendamento":{d(" Editar Agendamento"),l("Vou buscar seus agendamentos...",600),st();break}case"finalizar_atendimento":{d(" Finalizar Atendimento");try{resetConversation()}catch{}l("Atendimento finalizado. Se precisar,  s me chamar de novo! ",400);break}case"corrigir_telefone":{d(" Informei o telefone errado"),m("cliente",null),m("identificacao_valor",null),M("telefone"),z(!0),g("identificacao");break}case"corrigir_email":{d(" Informei o e-mail errado"),m("cliente",null),m("identificacao_valor",null),M("email"),z(!0),g("identificacao");break}case"continuar_fluxo":{Pt();break}case"gerar_times":case"gerar_times_again":{d(De.value==="gerar_times_again"?" Gerar novamente":" Gerar Times"),await Ut();break}case"aceitar_times":{d(" Concluir"),l("Beleza! O que voc gostaria de fazer agora?",400),setTimeout(()=>{Pt()},800);break}case"confirm":const ke=!!i?.editing_agendamento||!!ee;d(ke?" Salvar Alteraes":" Confirmar Agendamento"),ke?await yr():await lr();break;case"criar agendamento":d(" Confirmar Agendamento"),await lr();break;case"edit_quadra":d(" Editar Quadra");const Re=P.map(tr=>({label:tr.nome,value:tr.id,icon:"",subtitle:tr.descricao||tr.tipo||null,quadra:tr}));c("Qual quadra voc quer?",Re,600);break;case"edit_data":d(" Editar Data");const bt=new Date,Qt=La(bt,1),ct=[{label:`Hoje (${ur(bt,"dd/MM")})`,value:ur(bt,"yyyy-MM-dd"),icon:"",date:bt},{label:`Amanh (${ur(Qt,"dd/MM")})`,value:ur(Qt,"yyyy-MM-dd"),icon:"",date:Qt},{label:"Outro dia...",value:"custom",icon:""}];c("Para qual dia?",ct,600),g("data");break;case"edit_horario":d(" Editar Horrio e Esporte"),z(!1),$("horario"),y(!0);const xt=await We(i.quadra.id,i.data,ee?.id);if(y(!1),xt.fechada){const tr=ur(i.data,"dd/MM/yyyy",{locale:la}),Or=ur(i.data,"EEEE",{locale:la});if(xt.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${tr}** (${Or}). 

**Motivo:** ${xt.observacao}`,800);else if(xt.motivo==="dia_semana"){const Lr=ur(i.data,"EEEE",{locale:la});l(`**Ops!** A quadra no funciona ${Lr==="domingo"||Lr==="sbado"?"aos":"s"} **${Lr}s**. `,800)}setTimeout(()=>{l("No  possvel editar o horrio. Escolha **outra data** ou **quadra**:",1200),setTimeout(()=>{at()},400)},1600);return}const it=xt.slots;if(it&&it.length>0){const tr=Ze(it);let Or="";tr.length===1?Or=`Tenho **horrios livres** das **${tr[0].inicio}** s **${tr[0].fim}**! `:Or=`Tenho **horrios livres** ${tr.map((sr,fn)=>fn===tr.length-1?`e das **${sr.inicio}** s **${sr.fim}**`:fn===0?`das **${sr.inicio}** s **${sr.fim}**`:`das **${sr.inicio}** s **${sr.fim}**`).join(", ")}! `,l(Or,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else l("Ops! No encontrei **horrios disponveis**. ");break;case"edit_participantes":d(" Editar Participantes"),z(!1),$("participantes"),l("Edite a lista de participantes:",600),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},800);break;case"finalizar":d(" Finalizar Atendimento");const kt=["Pronto! Seu agendamento est confirmado! ","Perfeito! Agendamento realizado com sucesso! ","Tudo certo! Seu horrio est garantido! ","Sucesso! Agendamento confirmado! "],be=kt[Math.floor(Math.random()*kt.length)];l(be,800),setTimeout(()=>{pr()},1400);break;case"cancelar_agendamento":d(" Cancelar Agendamento");const dt=[{label:"Sim, cancelar",value:"confirmar_cancelamento",icon:""},{label:"No, voltar",value:"voltar_cancelamento",icon:""}],Lt=["Tem certeza que deseja cancelar este agendamento?","Confirma o cancelamento do agendamento?","Realmente quer cancelar? Esta ao no pode ser desfeita.","Deseja mesmo cancelar este agendamento?"],mr=Lt[Math.floor(Math.random()*Lt.length)];c(mr,dt,600);break;case"confirmar_cancelamento":await ar();break;case"voltar_cancelamento":d(" Voltar"),l("Ok! Voltando ao resumo do agendamento.",400),setTimeout(()=>{fr(null,null,!0,null,null,null,ee)},800);break;case"editar_agendamento":d(" Editar Agendamento"),l("Claro! O que voc gostaria de alterar?",600),setTimeout(()=>{fr(null,null,!0)},800);break;case"novo_agendamento":d(" Fazer Agendamento"),yt();break;case"buscar_agendamento":d(" Editar Agendamento"),l("Vou buscar seus agendamentos...",600),st();break;case"finalizar_atendimento":d(" Finalizar Atendimento"),pr();break;default:console.warn("[Isis] Ao no reconhecida:",De.value)}},st=async()=>{try{console.log("[buscarAgendamentosCliente] Iniciando busca de agendamentos...");const{data:De,error:ke}=await he.from("agendamentos").select(`
          id,
          codigo,
          inicio,
          fim,
          modalidade,
          status,
          valor_total,
          quadras!inner(nome, descricao, valor)
        `).eq("codigo_empresa",n).eq("cliente_id",i.cliente.id).in("status",["scheduled","confirmed"]).gte("inicio",new Date().toISOString()).order("inicio",{ascending:!0});if(ke)throw ke;if(!De||De.length===0){l("No encontrei agendamentos futuros para voc. ",800),l("Que tal fazer um novo agendamento? ",1400),setTimeout(()=>{yt()},2e3);return}if(De.length===1){const Ge=De[0],Re=ur(new Date(Ge.inicio),"dd/MM/yyyy",{locale:la}),bt=ur(new Date(Ge.inicio),"HH:mm"),Qt=ur(new Date(Ge.fim),"HH:mm");l(`Encontrei seu agendamento para ${Re} das ${bt} s ${Qt} - ${Ge.modalidade}! `,800),setTimeout(()=>{Ct(Ge)},1200)}else{l(`Encontrei ${De.length} agendamentos futuros! Qual voc quer editar?`,800);const Ge=De.map(Re=>{const bt=new Date(Re.inicio),Qt=ur(bt,"dd/MM/yyyy",{locale:la}),ct=ur(bt,"EEEE",{locale:la}),xt=ur(bt,"HH:mm"),it=ur(new Date(Re.fim),"HH:mm"),kt=(new Date(Re.fim)-bt)/(1e3*60),be=Math.floor(kt/60),dt=kt%60;let Lt="";be>0?Lt=dt>0?`${be}h${dt}m`:`${be}h`:Lt=`${dt}m`;const mr=Number(Re.quadras?.valor??0),tr=kt/30,Lr=(Math.round(mr*tr*100)/100).toFixed(2).replace(".",","),sr=new Date,fn=new Date(sr);fn.setDate(sr.getDate()+1);let Tn="";return bt.toDateString()===sr.toDateString()?Tn="Hoje":bt.toDateString()===fn.toDateString()?Tn="Amanh":Tn=`${ct.charAt(0).toUpperCase()+ct.slice(1)}, ${Qt}`,{label:`${Tn}  ${xt}-${it}`,value:`editar_agendamento_${Re.id}`,icon:"",subtitle:`${Re.quadras?.nome||"Quadra"}  ${Re.modalidade||""}  ${Lt}`,agendamento:Re}});setTimeout(()=>{c("Escolha o agendamento:",Ge,600)},1200)}}catch(De){console.error("[Isis] Erro ao buscar agendamentos:",De),l("Ops! Tive um problema ao buscar seus agendamentos. ",800),l("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{yt()},2e3)}},Ct=async De=>{try{console.log("[carregarAgendamentoParaEdicao] Iniciando carregamento do agendamento:",De.id),console.debug("[carregarAgendamentoParaEdicao] Iniciando JOIN: agendamentos  quadras, agendamento_participantes");const{data:ke,error:Ge}=await he.from("agendamentos").select(`
          *,
          quadras(id, nome, descricao, modalidades, valor),
          agendamento_participantes(nome, cliente_id)
        `).eq("id",De.id).single();if(console.debug("[carregarAgendamentoParaEdicao] Resultado JOIN:",{hasError:!!Ge,error:Ge?.message,code:Ge?.code,participantes_len:Array.isArray(ke?.agendamento_participantes)?ke.agendamento_participantes.length:null}),Ge)throw console.error("[Isis] Erro ao buscar agendamento:",Ge),new Error(`Agendamento no encontrado ou inacessvel: ${Ge.message}`);if(!ke)throw new Error("Agendamento no encontrado");const Re=new Date(ke.inicio),bt=ur(Re,"HH:mm"),Qt=ur(new Date(ke.fim),"HH:mm");let ct=ke.quadras||null;if(!ct)try{const{data:Lt}=await he.from("quadras").select("id, nome, descricao, modalidades, valor").eq("id",ke.quadra_id).single();ct=Lt||null}catch{}m("quadra",ct),m("data",Re),m("horario",{inicio:bt,fim:Qt,inicioDate:new Date(ke.inicio),fimDate:new Date(ke.fim)}),m("esporte",ke.modalidade);const xt=ke.cliente_id||i.cliente?.id||null;let it=ke.agendamento_participantes||[];if(!it||it.length===0)try{console.debug("[carregarAgendamentoParaEdicao] JOIN sem participantes. Fazendo SELECT direto em agendamento_participantes...");const{data:Lt,error:mr}=await he.from("agendamento_participantes").select("nome, cliente_id, codigo_empresa").eq("agendamento_id",De.id);console.debug("[carregarAgendamentoParaEdicao] SELECT direto participantes:",{hasError:!!mr,error:mr?.message,code:mr?.code,count:Array.isArray(Lt)?Lt.length:null}),Array.isArray(Lt)&&Lt.length>0&&(it=Lt.map(tr=>({nome:tr.nome,cliente_id:tr.cliente_id})))}catch(Lt){console.debug("[carregarAgendamentoParaEdicao] Falha no SELECT direto participantes:",Lt?.message||Lt)}let kt=null;const be=[];it.forEach(Lt=>{const mr=xt&&Lt.cliente_id===xt,tr={nome:Lt.nome,cliente_id:Lt.cliente_id,principal:mr};mr&&!kt?kt=tr:be.push(tr)});const dt=kt?[kt,...be.map(Lt=>({...Lt,principal:!1}))]:it.map((Lt,mr)=>({nome:Lt.nome,cliente_id:Lt.cliente_id,principal:mr===0}));m("participantes",dt);try{m("editing_agendamento",!0)}catch{}try{const Lt=ke?.meta_roles||null;if(Lt&&typeof Lt=="object"){const mr=Array.isArray(Lt.levantadores)?Lt.levantadores:[],tr=Array.isArray(Lt.goleiros)?Lt.goleiros:[],Or=Array.isArray(Lt.fixos)?Lt.fixos:Array.from(new Set([...mr,...tr])),Lr=Lt.fixoRoles&&typeof Lt.fixoRoles=="object"?Lt.fixoRoles:{};m("levantadores",mr),m("goleiros",tr),m("fixos",Or),m("fixoRoles",Lr)}else{const mr=`f7a:fixos:${ke.id}`,tr=JSON.parse(localStorage.getItem(mr)||"null");if(tr&&typeof tr=="object"){const Or=Array.isArray(tr.levantadores)?tr.levantadores:[],Lr=Array.isArray(tr.goleiros)?tr.goleiros:[],sr=Array.isArray(tr.fixos)?tr.fixos:Array.from(new Set([...Or,...Lr])),fn=tr.fixoRoles&&typeof tr.fixoRoles=="object"?tr.fixoRoles:{};m("levantadores",Or),m("goleiros",Lr),m("fixos",sr),m("fixoRoles",fn)}}}catch{}ve(ke),l("Perfeito! Aqui esto os detalhes do seu agendamento:",600),setTimeout(()=>{const Lt={inicio:bt,fim:Qt,inicioDate:new Date(ke.inicio),fimDate:new Date(ke.fim)};ct?(fr(Lt,ke.modalidade,!0,ct,Re,dt,ke),g("review")):(l("No consegui carregar os dados da quadra deste agendamento. Vamos escolher a quadra novamente?",800),setTimeout(()=>{const mr=P.map(tr=>({label:tr.nome,value:tr.id,icon:"",subtitle:tr.descricao||tr.tipo||null,quadra:tr}));c("Qual quadra voc quer?",mr,600)},1200))},1400)}catch(ke){console.error("[Isis] Erro ao carregar agendamento:",ke),ke.message.includes("no encontrado")?(l("Ops! Este agendamento no foi encontrado ou pode ter sido cancelado. ",800),l("Vou buscar seus agendamentos atualizados...",1400),setTimeout(()=>{st()},2e3)):(l("Ops! Tive um problema ao carregar o agendamento. ",800),l("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{yt()},2e3))}},ar=async()=>{if(!ee){console.error("[Isis] Nenhum agendamento para cancelar");return}try{y(!0);const{data:De}=await he.from("agenda_settings").select("isis_cancel_min_hours_before").eq("empresa_id",_?.id).single(),ke=De?.isis_cancel_min_hours_before;if(ke!=null&&(new Date(ee.inicio)-new Date)/(1e3*60*60)<ke){y(!1);const kt=_?.telefone||"a arena",be=_?.isis_display_name||_?.nome_fantasia||_?.razao_social||"a arena",dt=[` Ops! S  possvel cancelar com ${ke} hora${ke>1?"s":""} de antecedncia. Este agendamento est muito prximo.`,` Desculpe! O cancelamento s pode ser feito com ${ke} hora${ke>1?"s":""} de antecedncia. Seu agendamento j est prximo demais.`],mr=`${dt[Math.floor(Math.random()*dt.length)]}

 Para mais informaes ou cancelamento de ltima hora, entre em contato diretamente com a ${be}: ${kt}`;l(mr,600),setTimeout(()=>{l("O que voc gostaria de fazer agora?",800),setTimeout(()=>{Pt()},1200)},1200);return}const{error:Ge}=await he.from("agendamentos").update({status:"canceled",canceled_by:"isis",canceled_at:new Date().toISOString()}).eq("id",ee.id);if(Ge)throw Ge;y(!1);const Re=[" Agendamento cancelado com sucesso!"," Pronto! Seu agendamento foi cancelado."," Cancelamento realizado! Agendamento removido."," Feito! O agendamento foi cancelado com sucesso."],bt=Re[Math.floor(Math.random()*Re.length)];l(bt,600),ve(null),setTimeout(()=>{l("O que voc gostaria de fazer agora?",800),setTimeout(()=>{Pt()},1200)},1200)}catch(De){console.error("[Isis] Erro ao cancelar agendamento:",De),y(!1);const ke=mv("error");l(ke)}},pr=()=>{u();const De=["Antes de finalizar, que tal me dar uma avaliao? ","Para finalizar, gostaria que avaliasse nosso atendimento! ","Quase pronto! Me ajuda com uma avaliao rpida? ","ltima etapa! Como foi nosso atendimento hoje? ","Para encerrar, que nota voc daria para nosso atendimento? ","Ei, que tal me contar como foi a experincia? ","Curiosa para saber: como voc avalia nosso atendimento? ","Rapidinho aqui: o que achou do nosso servio? ","Me conta a, como foi para voc hoje? ","Sua opinio  super importante! Como foi tudo? ","Sua avaliao nos ajuda a melhorar! Como foi? ","Para continuarmos evoluindo, como voc nos avalia? ","Queremos sempre melhorar! Que nota voc daria? ","Seu feedback  ouro para ns! Como foi o atendimento? ","Ajude-nos a ser ainda melhores! Qual sua avaliao? ","Espero ter te ajudado bem! Como voc me avalia? ","Fiz um bom trabalho hoje? Me conta sua opinio! ","Consegui resolver tudo certinho? Que tal uma avaliao? ","Antes de voc ir, me diz como foi nossa conversa? ","Sua experincia foi boa? Adoraria saber! ","Obrigada pela confiana! Como foi para voc? ","Foi um prazer te atender! Que nota voc daria? ","Agradeo pela pacincia! Como avalia nosso servio? ","Muito obrigada! Me conta como foi tudo? ","Pode ser sincero(a)! Como foi o atendimento? ","Sem papas na lngua: que nota voc daria? ","Honestamente, como voc nos avalia? ","Sua opinio real  importante! Como foi? ","Para finalizar o atendimento, preciso da sua avaliao! ","Processo quase concludo! Falta s sua avaliao! ","ltima etapa do nosso protocolo: sua opinio! ","Para encerrar com chave de ouro: como nos avalia? "],ke=De[Math.floor(Math.random()*De.length)];l(ke,800),setTimeout(()=>{z(!0),g("avaliacao"),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1200)},Xt=async De=>{try{const ke=Array.isArray(j)?[...j]:[],Ge=`${De.rating} estrela${De.rating>1?"s":""}`,Re=De.comentario?` ${Ge}
 "${De.comentario}"`:` ${Ge}`;d(Re),z(!1),y(!0);const bt=ke.map(be=>({ts:be.timestamp instanceof Date?be.timestamp.toISOString():new Date(be.timestamp||Date.now()).toISOString(),from:be.from==="isis"?"assistant":"user",text:String(be.text??"")}));let Qt=-1;for(let be=bt.length-1;be>=0;be--)if(bt[be].from==="assistant"){Qt=be;break}const ct=Qt>=0?bt.slice(0,Qt+1):bt;await llt({rating:Number(De.rating),comentario:De.comentario||null,cliente_codigo:i?.cliente?.codigo??null,cliente_nome:i?.cliente?.nome||i?.cliente?.name||null,empresa_nome:_?.nome_fantasia||_?.razao_social||"Desconhecida",conversaArray:ct}),y(!1);const xt=new Date().getHours();let it;xt>=5&&xt<12?it="Tenha um timo dia! ":xt>=12&&xt<18?it="Tenha uma tima tarde! ":xt>=18&&xt<22?it="Tenha uma tima noite! ":it="Tenha uma boa noite! ";let kt;if(De.rating>=4){const be=[` **Muito obrigada pela avaliao!** A **${ce}** agradece imensamente! Foi um prazer te atender! ${it}`,` **Que bom que gostou!** A **${ce}** fica muito feliz! Volte sempre! ${it}`,` **Perfeito!** A **${ce}** agradece de corao! Espero ter ajudado! ${it}`,` **Adorei seu feedback!** A **${ce}** est muito grata! Nos vemos em breve! ${it}`,` **Excelente!** A **${ce}** agradece pela confiana! At a prxima! ${it}`,` **Uau, que nota incrvel!** A **${ce}** est nas nuvens! Obrigada! ${it}`,` **Voc  demais!** A **${ce}** adora clientes como voc! ${it}`,` **Top demais!** A **${ce}** se sente campe com seu feedback! ${it}`,` **Que alegria!** A **${ce}** fica radiante com sua avaliao! ${it}`,` **Sensacional!** A **${ce}** est celebrando sua nota! ${it}`,` **Amei sua avaliao!** Fico feliz em saber que te atendi bem! A **${ce}** agradece! ${it}`,` **Que feedback maravilhoso!** Me deixou super feliz! A **${ce}**  grata! ${it}`,` **Seu carinho me emociona!** A **${ce}** tem sorte de ter voc! ${it}`,` **Voc iluminou meu dia!** A **${ce}** agradece de todo corao! ${it}`,` **Nota mxima!** A **${ce}** te espera sempre de braos abertos! ${it}`,` **Cliente 5 estrelas!** A **${ce}** adora te ter aqui! Volte logo! ${it}`,` **Voc  especial!** A **${ce}** sempre ter um lugar especial para voc! ${it}`,` **Show de avaliao!** A **${ce}** te aguarda para a prxima apresentao! ${it}`];kt=be[Math.floor(Math.random()*be.length)]}else if(De.rating===3){const be=[` **Obrigada pelo feedback!** A **${ce}** vai melhorar ainda mais! ${it}`,` **Agradecemos sua avaliao!** A **${ce}** est trabalhando para evoluir! ${it}`,` **Obrigada!** A **${ce}** valoriza seu retorno! Foi um prazer te atender! ${it}`,` **Toda avaliao nos faz crescer!** A **${ce}** agradece sua sinceridade! ${it}`,` **Feedback valioso!** A **${ce}** usa cada retorno para evoluir! ${it}`,` **Obrigada pela nota!** A **${ce}** est sempre buscando melhorar! ${it}`,` **Seu retorno  importante!** A **${ce}** vai usar para aprimorar nosso servio! ${it}`,` **Agradecemos a oportunidade!** A **${ce}** espera te surpreender na prxima! ${it}`,` **Obrigada pela dica!** A **${ce}** vai trabalhar para te conquistar! ${it}`,` **Toda crtica construtiva  bem-vinda!** A **${ce}** agradece! ${it}`];kt=be[Math.floor(Math.random()*be.length)]}else{const be=[` **Obrigada pela sinceridade.** A **${ce}** vai trabalhar para melhorar! ${it}`,` **Agradecemos seu feedback.** A **${ce}** est comprometida em evoluir! ${it}`,` **Obrigada por compartilhar.** A **${ce}** vai usar seu retorno para melhorar! ${it}`,` **Lamentamos no ter atendido suas expectativas.** A **${ce}** vai se esforar mais! ${it}`,` **Sentimos muito pela experincia.** A **${ce}** levar isso muito a srio! ${it}`,` **Assumimos a responsabilidade.** A **${ce}** vai fazer melhor da prxima vez! ${it}`,` **Sua insatisfao nos preocupa.** A **${ce}** vai revisar todos os processos! ${it}`,` **Obrigada pelo alerta!** A **${ce}** espera uma nova chance de te impressionar! ${it}`,` **Vamos melhorar!** A **${ce}** promete que da prxima vez ser diferente! ${it}`,` **Seu feedback  nosso combustvel!** A **${ce}** vai usar para crescer! ${it}`,` **J estamos trabalhando nas melhorias!** A **${ce}** agradece sua pacincia! ${it}`,` **Sua honestidade  valiosa!** A **${ce}** prefere a verdade para evoluir! ${it}`,` **Crticas nos fazem crescer!** A **${ce}** agradece sua coragem de falar! ${it}`];kt=be[Math.floor(Math.random()*be.length)]}l(kt,600),setTimeout(()=>{l("Atendimento finalizado.",0,"system")},1200)}catch(ke){console.error("[Isis] Erro ao enviar avaliao:",ke),y(!1);const Ge=new Date().getHours();let Re;Ge>=5&&Ge<12?Re="Tenha um timo dia! ":Ge>=12&&Ge<18?Re="Tenha uma tima tarde! ":Ge>=18&&Ge<22?Re="Tenha uma tima noite! ":Re="Tenha uma boa noite! ";const bt=[`Ops! Tive um problema ao salvar sua avaliao, mas a **${ce}** agradece muito seu feedback! ${Re}`,` No consegui salvar sua avaliao, mas a **${ce}** agradece imensamente! ${Re}`,` Deu uma travadinha aqui, mas sua opinio j ficou guardada no meu corao! A **${ce}** agradece! ${Re}`,` Ops, falhei na tecnologia, mas no falhei em te ouvir! A **${ce}** valoriza seu feedback! ${Re}`,` Parece que o sistema deu soluo, mas sua avaliao foi ouvida! A **${ce}** agradece! ${Re}`,` A internet no colaborou, mas sua opinio chegou at mim! A **${ce}**  grata! ${Re}`,` Problema tcnico aqui, mas o importante  que voc compartilhou! A **${ce}** agradece! ${Re}`,` O sistema travou, mas sua avaliao no passou despercebida! A **${ce}** valoriza! ${Re}`],Qt=bt[Math.floor(Math.random()*bt.length)];l(Qt,600),setTimeout(()=>{l("Atendimento finalizado.",0,"system")},1200)}},yr=async()=>{if(!ee){console.error("[Isis] Nenhum agendamento para atualizar");return}try{y(!0);const De=i.cliente,ke=i.participantes||[],{data:Ge}=await he.from("clientes").select("id").eq("codigo_empresa",n).eq("is_consumidor_final",!0).single(),Re=ke.find(zn=>zn.principal),bt=ke.filter(zn=>!zn.principal),Qt=Re?[Re,...bt]:ke,ct=Qt.map(zn=>zn.nome),[xt,it]=i.horario.inicio.split(":").map(Number),[kt,be]=i.horario.fim.split(":").map(Number);let dt=kt*60+be-(xt*60+it);kt===0&&be===0&&(dt=24*60-(xt*60+it));const Lt=i.quadra.valor||0,mr=dt/30,tr=Math.round(Lt*mr*100)/100,Or={levantadores:Array.isArray(i.levantadores)?i.levantadores:[],goleiros:Array.isArray(i.goleiros)?i.goleiros:[],fixos:Array.isArray(i.fixos)?i.fixos:[],fixoRoles:i.fixoRoles&&typeof i.fixoRoles=="object"?i.fixoRoles:{}},{data:Lr,error:sr}=await he.from("agendamentos").update({quadra_id:i.quadra.id,clientes:ct,inicio:i.horario.inicioDate.toISOString(),fim:i.horario.fimDate.toISOString(),modalidade:i.esporte,valor_total:tr,meta_roles:Or}).eq("id",ee.id).select().single();if(sr)throw sr;const{error:fn}=await he.from("agendamento_participantes").delete().eq("agendamento_id",ee.id);if(fn)throw fn;const Tn=Qt.map((zn,ot)=>({agendamento_id:Lr.id,codigo_empresa:n,cliente_id:zn.cliente_id||Ge?.id,nome:zn.nome,valor_cota:0,status_pagamento:"Pendente",ordem:ot+1})),{error:mn}=await he.from("agendamento_participantes").insert(Tn);if(mn)throw mn;y(!1),ve(Lr);try{const zn=`f7a:fixos:${Lr.id}`,ot={levantadores:i.levantadores||[],goleiros:i.goleiros||[],fixos:i.fixos||[],fixoRoles:i.fixoRoles||{}};localStorage.setItem(zn,JSON.stringify(ot))}catch{}It(Lr,!0),g("confirmation")}catch(De){console.error("[Isis] Erro ao atualizar agendamento:",De),y(!1);const ke=mv("error");l(ke)}},lr=async()=>{try{y(!0);const De=i.cliente,ke=i.participantes||[],{data:Ge}=await he.from("clientes").select("id").eq("codigo_empresa",n).eq("is_consumidor_final",!0).single(),Re=ke.find(Yt=>Yt.principal),bt=ke.filter(Yt=>!Yt.principal),Qt=Re?[Re,...bt]:ke,ct=Qt.map(Yt=>Yt.nome),[xt,it]=i.horario.inicio.split(":").map(Number),[kt,be]=i.horario.fim.split(":").map(Number);let dt=kt*60+be-(xt*60+it);kt===0&&be===0&&(dt=24*60-(xt*60+it));const Lt=i.quadra.valor||0,mr=dt/30,tr=Math.round(Lt*mr*100)/100,Or={levantadores:Array.isArray(i.levantadores)?i.levantadores:[],goleiros:Array.isArray(i.goleiros)?i.goleiros:[],fixos:Array.isArray(i.fixos)?i.fixos:[],fixoRoles:i.fixoRoles&&typeof i.fixoRoles=="object"?i.fixoRoles:{}};let Lr=null;try{const Yt=String(w||"").trim();/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(Yt)&&(Lr=Yt)}catch{}const{data:sr}=await he.from("agendamentos").select("codigo").eq("codigo_empresa",n).order("codigo",{ascending:!1}).limit(1).single();let fn=sr?sr.codigo+1:1;console.log("[criarAgendamento] ltimo cdigo usado:",sr?.codigo),console.log("[criarAgendamento] Prximo cdigo inicial:",fn);let Tn,mn=0;const zn=10;for(;!Tn&&mn<zn;){mn++,console.log("[criarAgendamento] Tentativa",mn,"com cdigo:",fn);const Yt={codigo:fn,codigo_empresa:n,quadra_id:i.quadra.id,cliente_id:De.id,clientes:ct,inicio:i.horario.inicioDate.toISOString(),fim:i.horario.fimDate.toISOString(),modalidade:i.esporte,status:"scheduled",valor_total:tr,meta_roles:Or,created_by_isis:!0};if(Lr)try{const{data:Xr}=await he.from("isis_chat_sessions").select("id").eq("id",Lr).single();Xr?.id&&(Yt.isis_session_id=Lr)}catch{}const{data:Ht,error:Ot}=await he.from("agendamentos").insert(Yt).select("id, codigo").single();if(Ot)if(Ot.code==="23505")console.log("[criarAgendamento] Cdigo",fn,"j existe, tentando prximo..."),fn++;else throw Ot;else Tn=Ht,console.log("[criarAgendamento] Agendamento criado com cdigo:",Tn.codigo)}if(!Tn)throw new Error("No foi possvel gerar um cdigo nico aps "+zn+" tentativas");try{const{data:Yt}=await he.from("empresas").select("id").eq("codigo_empresa",n).single();Yt&&(await he.from("empresa_counters").update({next_agendamento_codigo:Tn.codigo+1}).eq("empresa_id",Yt.id),console.log("[criarAgendamento] Counter atualizado para:",Tn.codigo+1))}catch(Yt){console.warn("[criarAgendamento] Erro ao atualizar counter:",Yt)}const ot=Qt.map((Yt,Ht)=>({codigo_empresa:n,agendamento_id:Tn.id,cliente_id:Yt.principal?De.id:Ge?.id||null,nome:Yt.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Ht+1})),{error:$t}=await he.from("agendamento_participantes").insert(ot);if($t)throw $t;y(!1),ve(Tn);try{const Yt=`f7a:fixos:${Tn.id}`,Ht={levantadores:i.levantadores||[],goleiros:i.goleiros||[],fixos:i.fixos||[],fixoRoles:i.fixoRoles||{}};localStorage.setItem(Yt,JSON.stringify(Ht))}catch{}It(Tn),g("confirmation")}catch(De){console.error("[Isis] Erro ao criar agendamento:",De),y(!1);const ke=mv("error");l(ke),Kj({title:"Erro ao criar agendamento",description:De.message||"Tente novamente",variant:"destructive"})}},Rr=(De,ke)=>{if(u(),ke)try{h(ke)}catch{}switch(o){case"quadra":rt(De);break;case"data":{if((De?.value||"").toString()==="mudar_quadra"){try{z(!1);const Re=(P||[]).map(bt=>({label:bt.nome,value:bt.id,icon:"",subtitle:bt.descricao||bt.tipo||null,quadra:bt}));Re.length>0&&(c("Qual quadra voc quer?",Re,400),g("quadra"))}catch{}break}pt(De)}break;case"identificacao":xe(De);break;case"review":xe(De);break;case"confirmation":xe(De);break;case"confirmar_cliente_existente":{const Ge=(De?.value||"").toString();if(Ge==="confirm_cliente_existente"){const Re=i?.cliente_sugerido||null;if(Re){m("cliente",Re),m("cliente_sugerido",null);const bt=Te(Re.nome||"");l(`Perfeito, **${bt}**! `,300),z(!1),setTimeout(()=>{try{Pt()}catch{}},700)}else z(!0),g("identificacao")}else Ge==="corrigir_cadastro"&&(l("Sem problemas! Vamos corrigir seus dados. ",300),z(!0),g("cadastro"));break}default:console.warn("[Isis] Nenhum handler para step:",o)}},Pn=()=>U?o==="participantes"||o==="review"&&U&&W==="participantes"?a.jsx(alt,{participantesAtuais:i.participantes||[],onAdicionar:ye,onRemover:mt,onFinalizar:Ft,onAdicionarLote:Be,selfName:i.cliente?.nome,initialModalidade:i.esporte||"",modalidadeOptions:Array.isArray(i.quadra?.modalidades)&&i.quadra.modalidades.length>0?i.quadra.modalidades:i.esporte?[i.esporte]:[],onFixedRolesDetected:De=>{try{const ke=Array.isArray(De?.levantadores)?De.levantadores:[],Ge=Array.isArray(De?.goleiros)?De.goleiros:[],Re=ct=>String(ct||"").trim().toLowerCase(),bt=Array.from(new Set([...ke,...Ge])),Qt={};ke.forEach(ct=>{Qt[Re(ct)]="Levantador"}),Ge.forEach(ct=>{Qt[Re(ct)]="Goleiro"}),m("levantadores",ke),m("goleiros",Ge),m("fixos",bt),m("fixoRoles",Qt),ee?.id&&(async()=>{try{const ct={levantadores:ke,goleiros:Ge,fixos:bt,fixoRoles:Qt};await he.from("agendamentos").update({meta_roles:ct}).eq("id",ee.id)}catch(ct){console.debug("[Isis] Falha ao persistir meta_roles imediatos:",ct?.message||ct)}})()}catch{}}}):o==="identificacao"||R==="data_custom"?a.jsx(rlt,{tipo:R,onSubmit:de,onTrocarTipo:()=>{M(R==="telefone"?"email":"telefone")}}):o==="cadastro"?a.jsx(nlt,{onSubmit:lt,valorInicial:i.identificacao_valor,tipoInicial:i.identificacao_tipo||"telefone",onCorrigirTelefone:()=>{try{l("Sem problemas! Informe seu telefone novamente:",400)}catch{}m("cliente",null),m("identificacao_valor",null),M("telefone"),g("identificacao"),z(!0)},onCorrigirEmail:()=>{try{l("Sem problemas! Informe seu e-mail novamente:",400)}catch{}m("cliente",null),m("identificacao_valor",null),M("email"),g("identificacao"),z(!0)}}):o==="horario"||o==="review"&&U&&W==="horario"?a.jsx(tlt,{onSubmit:Ne,onMudarData:gt,onMudarQuadra:()=>{try{z(!1),$("horario"),g("review");const De=(P||[]).map(ke=>({label:ke.nome,value:ke.id,icon:"",subtitle:ke.descricao||ke.tipo||null,quadra:ke}));De.length>0&&c("Qual quadra voc quer?",De,600)}catch{}},hasMultipleQuadras:(P||[]).length>1,horariosDisponiveis:A,esportes:i.quadra?.modalidades||[]}):o==="avaliacao"?a.jsx(slt,{onSubmit:Xt}):null:null;return r?D?a.jsx(olt,{message:"Preparando sua experincia..."}):_?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(jr.header,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"bg-surface/70 backdrop-blur-xl border-b border-white/10 sticky top-0 z-20 shadow-lg",children:a.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-3 md:py-4 flex items-center justify-between gap-3 md:gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"transition-all duration-300 group-hover:scale-105",children:a.jsx(tl,{size:"md",variant:"header",className:"md:w-20 md:h-20"})}),a.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 md:w-4 md:h-4 bg-success rounded-full border-2 border-surface"})]}),a.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[a.jsx("h1",{className:"font-bold text-text-primary text-lg md:text-2xl tracking-tight leading-none",children:"sis"}),a.jsxs("div",{className:"relative group w-fit",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 blur-md opacity-60 group-hover:opacity-100 animate-pulse rounded-md"}),a.jsxs("div",{className:"relative px-2 py-0.5 md:px-2.5 md:py-1 bg-gradient-to-r from-cyan-500/20 via-purple-500/20 to-pink-500/20 backdrop-blur-sm border border-cyan-500/50 rounded-md flex items-center gap-1 md:gap-1.5 shadow-lg",children:[a.jsxs("svg",{className:"w-2.5 h-2.5 md:w-3 md:h-3 text-cyan-400",fill:"currentColor",viewBox:"0 0 20 20",children:[a.jsx("path",{d:"M13 7H7v6h6V7z"}),a.jsx("path",{fillRule:"evenodd",d:"M7 2a1 1 0 012 0v1h2V2a1 1 0 112 0v1h2a2 2 0 012 2v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v2a2 2 0 01-2 2h-2v1a1 1 0 11-2 0v-1H9v1a1 1 0 11-2 0v-1H5a2 2 0 01-2-2v-2H2a1 1 0 110-2h1V9H2a1 1 0 010-2h1V5a2 2 0 012-2h2V2zM5 5h10v10H5V5z",clipRule:"evenodd"})]}),a.jsx("span",{className:"text-[9px] md:text-[10px] font-bold bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"chat"}),a.jsxs("div",{className:"hidden md:flex gap-0.5",children:[a.jsx("span",{className:"w-1 h-1 bg-cyan-400 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),a.jsx("span",{className:"w-1 h-1 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),a.jsx("span",{className:"w-1 h-1 bg-pink-400 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]})]})]})]})]}),a.jsx("div",{className:"flex flex-1 justify-end md:justify-center",children:a.jsxs("div",{className:"group relative",children:[a.jsx("div",{className:"hidden md:block absolute inset-0 bg-gradient-to-r from-brand/20 via-brand/10 to-brand/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),a.jsxs("div",{className:"relative flex items-center gap-2.5 md:gap-3 px-4 py-2 md:px-5 md:py-2.5 bg-gradient-to-r from-surface via-surface-2 to-surface backdrop-blur-sm rounded-lg md:rounded-xl border border-brand/20 shadow-md md:shadow-lg",children:[a.jsxs("div",{className:"relative w-9 h-9 md:w-10 md:h-10 shrink-0 overflow-hidden rounded-lg border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)] group-hover:border-white/20 transition-colors duration-300",children:[le?a.jsx("img",{src:le,alt:"Logo da empresa",className:"w-full h-full object-cover",onError:De=>{De.target.style.display="none",De.target.nextSibling.style.display="block"}}):null,a.jsx(D_,{className:`w-5 h-5 md:w-6 md:h-6 opacity-80 ${le?"hidden":"block"}`,strokeWidth:2})]}),a.jsx("h2",{className:"text-sm md:text-base font-bold text-text-primary tracking-wide truncate max-w-[140px] md:max-w-none",children:ce})]})]})}),a.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(Sc,{className:"w-7 h-7 text-primary-foreground"})}),a.jsxs("div",{className:"hidden lg:flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})]})}),a.jsx("div",{className:"container mx-auto max-w-5xl pb-6 md:pb-6 mb-12 md:mb-0",children:a.jsx(elt,{onButtonClick:Rr,hideButtonTexts:o==="avaliacao",children:Pn()})}),a.jsx(jr.footer,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.3},className:"md:hidden fixed bottom-0 left-0 right-0 bg-surface/90 backdrop-blur-xl border-t border-white/10 z-20 shadow-lg",children:a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-6 h-6 bg-brand rounded-lg flex items-center justify-center",children:a.jsx(Sc,{className:"w-4 h-4 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-sm",style:{color:"#B0B0B0"},children:" Arena"})]})]})})})]}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:a.jsxs(jr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[a.jsx(jr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:a.jsxs("div",{className:"relative",children:[a.jsx(tl,{size:"xl",variant:"header"}),a.jsx(jr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),a.jsxs(jr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[a.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[ie(),"! Tentando Agendar? "]}),a.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:[a.jsxs("p",{className:"text-xl text-text-primary mb-6 leading-relaxed",children:["Entre em contato com o dono da quadra e solicite o ",a.jsx("strong",{children:"link de agendamento"}),"."]}),a.jsxs("div",{className:"bg-surface-2/50 border border-white/5 rounded-xl p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-3 flex items-center gap-2",children:[a.jsx(RH,{className:"w-5 h-5 text-brand"}),"Formato do Link"]}),a.jsxs("div",{className:"bg-background/60 border border-white/10 rounded-lg p-4 font-mono text-base md:text-lg",children:[a.jsx("span",{className:"text-brand font-bold",children:"nomedaempresa"}),a.jsx("span",{className:"text-text-muted",children:".f7arena.com"})]}),a.jsx("p",{className:"mt-2 text-xs text-text-muted",children:"(sem traos)"})]})]})]}),a.jsx(jr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:a.jsx(Sc,{className:"w-6 h-6 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:a.jsxs(jr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[a.jsx(jr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:a.jsxs("div",{className:"relative",children:[a.jsx(tl,{size:"xl",variant:"header"}),a.jsx(jr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),a.jsxs(jr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[a.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[ie(),"! Tentando Agendar?"]}),a.jsx("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:a.jsx("p",{className:"text-xl text-text-primary mb-4 leading-relaxed",children:"Entre em contato com o dono da quadra e solicite o link de agendamento."})})]}),a.jsx(jr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:a.jsx(Sc,{className:"w-6 h-6 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})})};function rV(){return a.jsx(aoe,{children:a.jsx(bY,{children:a.jsx(dlt,{children:a.jsx(clt,{})})})})}function dlt({children:e}){const{selections:t}=EC(),[r,n]=Se.useState({name:"",phone:"",source:"init"});return Se.useEffect(()=>{const s=()=>{try{const c=t?.empresa||null;if(c){const d=c.isis_display_name||c.nome_fantasia||c.razao_social||c.nome||"",u=c.telefone||"";if(d||u)return{name:d,phone:u}}}catch{}return null},o=()=>{try{const c=window.location.host||"",d=window.location.pathname||"",u="f7arena.com";if(c.endsWith(u)){const h=c.slice(0,-u.length).replace(/\.$/,"").toLowerCase();if(h&&h!=="www")return h}const f=d.match(/\/agendar\/([^\/?#]+)/i);if(f&&f[1])return decodeURIComponent(f[1])}catch{}return null},i=s();if(i){try{console.info("[IsisError][Meta] Using context data",{name:!!i.name,phone:!!i.phone})}catch{}n({name:i.name,phone:i.phone,source:"context"});return}const l=o();if(!l){try{console.warn("[IsisError][Meta] No slug inferred from URL")}catch{}n(c=>c.name||c.phone?c:{name:"",phone:"",source:"none"});return}(async()=>{try{try{console.info("[IsisError][Meta] Start fetch by slug",{slug:l})}catch{}const c=String(l||"").toLowerCase().replace(/[\s\-_]+/g,"").trim();let d="",u="",f="";try{const{data:g,error:y}=await he.rpc("get_empresa_public_by_slug",{p_slug:c});if(!y&&Array.isArray(g)&&g.length>0){const x=g[0]||{};d=x.isis_display_name||x.nome_fantasia||x.razao_social||x.nome||"",x.telefone&&(u=x.telefone,f="rpc.telefone");try{console.info("[IsisError][Meta] RPC result",{hasName:!!d,phoneSource:f,hasPhone:!!u})}catch{}}}catch{}if(!d||!u)try{const{data:g}=await he.from("agenda_settings").select("isis_display_name, empresas(nome_fantasia, razao_social, nome, telefone)").eq("isis_subdomain",c).single(),y=g?.empresas||{};d=d||g?.isis_display_name||y?.nome_fantasia||y?.razao_social||y?.nome||"",!u&&y?.telefone&&(u=y.telefone,f="settings.telefone");try{console.info("[IsisError][Meta] Settings result",{hasName:!!d,phoneSource:f,hasPhone:!!u})}catch{}}catch{}const m=d||(g=>{try{return String(g||"").replace(/[\s_\-]+/g," ").trim().split(" ").filter(Boolean).map(x=>x.charAt(0).toUpperCase()+x.slice(1).toLowerCase()).join(" ")}catch{return g}})(l),v=u||"";try{console.info("[IsisError][Meta] Final",{finalName:m,hasPhone:!!v,phoneSource:f||"none"})}catch{}n({name:m,phone:v,source:f||"computed"})}catch(c){try{console.error("[IsisError][Meta] Exception during meta fetch",c)}catch{}n({name:l,phone:"",source:"error"})}})()},[t?.empresa]),a.jsx(aoe,{companyName:r.name,companyPhone:r.phone,children:e})}class aoe extends Se.Component{constructor(t){super(t),this.state={hasError:!1,companyName:"",companyPhone:""}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,r){try{console.error("[Isis] Uncaught error:",t,r)}catch{}(!this.props.companyName||!this.props.companyPhone)&&(async()=>{try{const n=()=>{try{const d=typeof window<"u"&&window.location.host||"",u=typeof window<"u"&&window.location.pathname||"",f="f7arena.com";if(d&&d.endsWith(f)){const m=d.slice(0,-f.length).replace(/\.$/,"").toLowerCase();if(m&&m!=="www")return m}const h=u.match(/\/agendar\/([^\/?#]+)/i);if(h&&h[1])return decodeURIComponent(h[1])}catch{}return null},s=d=>{try{return String(d||"").replace(/[\s_\-]+/g," ").trim().split(" ").filter(Boolean).map(f=>f.charAt(0).toUpperCase()+f.slice(1).toLowerCase()).join(" ")}catch{return d}},o=n();if(!o)return;const i=String(o).toLowerCase().replace(/[\s\-_]+/g,"").trim();let l="",c="";try{const{data:d,error:u}=await he.rpc("get_empresa_public_by_slug",{p_slug:i});if(!u&&Array.isArray(d)&&d.length>0){const f=d[0]||{};l=f.isis_display_name||f.nome_fantasia||f.razao_social||f.nome||"",f.telefone&&(c=f.telefone);try{console.info("[IsisError][Outer] RPC",{hasName:!!l,hasPhone:!!c})}catch{}}}catch{}if(!l||!c)try{const{data:d}=await he.from("agenda_settings").select("isis_display_name, empresas(nome_fantasia, razao_social, nome, telefone)").eq("isis_subdomain",i).single(),u=d?.empresas||{};l=l||d?.isis_display_name||u?.nome_fantasia||u?.razao_social||u?.nome||"",!c&&u?.telefone&&(c=u.telefone);try{console.info("[IsisError][Outer] Settings",{hasName:!!l,hasPhone:!!c})}catch{}}catch{}this.setState({companyName:l||s(o),companyPhone:c||""})}catch(n){try{console.error("[IsisError][Outer] meta fetch failed",n)}catch{}}})()}render(){if(this.state.hasError){try{console.info("[IsisError][Render] Props",{companyName:this.props.companyName,companyPhone:this.props.companyPhone})}catch{}const t=()=>{try{const i=typeof window<"u"&&window.location.host||"",l=typeof window<"u"&&window.location.pathname||"",c="f7arena.com";if(i&&i.endsWith(c)){const u=i.slice(0,-c.length).replace(/\.$/,"").toLowerCase();if(u&&u!=="www")return u}const d=l.match(/\/agendar\/([^\/?#]+)/i);if(d&&d[1])return decodeURIComponent(d[1])}catch{}return null},r=i=>{try{const l=String(i||"").replace(/\D/g,"");return l.length>=11?`(${l.slice(0,2)}) ${l.slice(2,7)}-${l.slice(7,11)}`:l.length>=10?`(${l.slice(0,2)}) ${l.slice(2,6)}-${l.slice(6,10)}`:i||""}catch{return i||""}},n=t(),s=this.props.companyName||this.state.companyName||n||"a arena",o=r(this.props.companyPhone||this.state.companyPhone||"");return a.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-background text-text-primary p-6",children:a.jsxs("div",{className:"w-full max-w-xl mx-auto rounded-3xl border border-white/10 bg-surface/80 backdrop-blur-md shadow-2xl p-8 text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx(tl,{size:"xl"})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold tracking-tight mb-3",children:" Ops, ocorreu um erro!"}),a.jsxs("p",{className:"text-base md:text-lg opacity-90 leading-relaxed mb-3",children:["Pode ser um ",a.jsx("span",{className:"font-semibold",children:"problema no seu dispositivo"})," ou na sua ",a.jsx("span",{className:"font-semibold",children:"conexo de rede"}),"."]}),a.jsxs("p",{className:"text-base md:text-lg opacity-90 leading-relaxed mb-6",children:[a.jsx("span",{className:"font-semibold",children:"Tente novamente"}),", experimente ",a.jsx("span",{className:"font-semibold",children:"outro navegador"})," ou ",a.jsx("span",{className:"font-semibold",children:"outra rede"}),"."]}),a.jsxs("p",{className:"text-base md:text-lg leading-relaxed mb-6",children:["Se persistir, ",a.jsx("span",{className:"font-semibold",children:"entre em contato"})," com ",a.jsx("span",{className:"font-semibold",children:s}),o?a.jsxs(a.Fragment,{children:[" ","pelo nmero ",a.jsx("span",{className:"font-semibold font-mono",children:o}),"."]}):"."]}),a.jsx("div",{className:"flex items-center justify-center gap-3",children:a.jsx("button",{onClick:()=>{try{window.location.reload()}catch{}},className:"inline-flex items-center justify-center rounded-xl px-5 py-3 bg-brand text-bg font-semibold shadow-lg shadow-brand/20 hover:shadow-xl hover:shadow-brand/30 transition-all",children:" Recarregar pgina"})})]})})}return this.props.children}}const nV="f740028922";function aV(e){try{return ur(e,"EEE, d 'de' MMM 's' HH:mm",{locale:la})}catch{return""}}function sV(){const e=Lo(),t=Ri(),r=!!DS||typeof window<"u"&&localStorage.getItem("maintenance:active")==="true",[n,s]=p.useState(""),[o,i]=p.useState("");p.useEffect(()=>{try{s(localStorage.getItem("maintenance:end")||""),i(localStorage.getItem("maintenance:message")||"");const f=h=>{h.key==="maintenance:end"&&s(h.newValue||""),h.key==="maintenance:message"&&i(h.newValue||"")};return window.addEventListener("storage",f),()=>window.removeEventListener("storage",f)}catch{}},[]);const l=n||Rit||{}.VITE_MAINTENANCE_END||"",c=o&&o.trim()?o:Lit,d=p.useMemo(()=>{if(!l)return null;const f=new Date(l);return isNaN(f.getTime())?null:f},[l]),u=p.useMemo(()=>c?.trim()?c:d?`Estamos em manuteno e voltaremos at ${aV(d)}.`:"Estamos em manuteno no momento. Voltaremos em breve.",[c,d]);return p.useEffect(()=>{try{window.f7MaintenanceBypass=f=>{const h=String(f||"")===nV;if(h){try{localStorage.setItem("maintenance:bypass","1")}catch{}try{sessionStorage.setItem("maintenance:bypass","1")}catch{}try{document.cookie="fx_maint_bypass=1; path=/; max-age=2592000"}catch{}try{sessionStorage.removeItem("auth:returnUrl")}catch{}t("/login",{replace:!0})}else console.warn("[Maintenance] Senha invlida.");return h},window.f7MaintenanceReset=()=>{try{localStorage.removeItem("maintenance:bypass")}catch{}console.info("[Maintenance] Bypass removido.")}}catch{}},[t]),p.useEffect(()=>{const h=String(e.pathname||"").split("/").filter(Boolean),m=h[h.length-1]||"",v=new URLSearchParams(e.search||""),y=v.get("senha")||v.get("pwd")||v.get("code")||""||m;if(y&&y===nV){try{localStorage.setItem("maintenance:bypass","1")}catch{}try{sessionStorage.setItem("maintenance:bypass","1")}catch{}try{document.cookie="fx_maint_bypass=1; path=/; max-age=2592000"}catch{}try{sessionStorage.removeItem("auth:returnUrl")}catch{}t("/login",{replace:!0})}},[e,t]),a.jsxs("div",{className:"min-h-screen relative overflow-hidden bg-gradient-to-b from-[#0f1324] via-[#0b0f1c] to-[#070a14] text-white",children:[a.jsx("div",{className:"pointer-events-none absolute -top-40 left-1/2 -translate-x-1/2 w-[90rem] h-[90rem] rounded-full opacity-30 blur-3xl",style:{background:"radial-gradient(50% 50% at 50% 50%, rgba(76,110,245,0.45) 0%, rgba(76,110,245,0.18) 40%, rgba(0,0,0,0) 70%)"}}),a.jsxs("div",{className:"relative z-10 mx-auto max-w-4xl px-6 py-16 md:py-24",children:[a.jsxs("div",{className:"mx-auto max-w-3xl rounded-3xl border border-white/10 bg-white/[0.02] backdrop-blur-xl shadow-[0_0_60px_-10px_rgba(76,110,245,0.5)] p-6 md:p-10",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"w-16 h-16 bg-brand rounded-xl flex items-center justify-center mr-4",children:a.jsx(Sc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-5xl font-extrabold",children:[a.jsx("span",{style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{style:{color:"#FFAA33"},children:"7"})]}),a.jsx("p",{className:"text-2xl font-semibold",style:{color:"#B0B0B0"},children:"Arena"})]})]})}),a.jsxs("div",{className:"flex items-center justify-center gap-3 text-red-400 mb-4",children:[a.jsx(l4,{className:"w-6 h-6"}),a.jsx("span",{className:"font-semibold tracking-wide",children:"Modo de Manuteno"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-8",children:[a.jsx("div",{className:"shrink-0",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute -inset-4 bg-brand/20 blur-2xl rounded-full"}),a.jsx("div",{className:"relative rounded-2xl p-1 bg-gradient-to-b from-brand/40 to-transparent",children:a.jsx(tl,{size:"xl",variant:"header"})})]})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold leading-tight",children:"Oi! Eu sou a Isis "}),a.jsx("p",{className:"text-white/80 mt-3 text-base md:text-lg leading-relaxed",children:u}),a.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-white/80",children:[d&&a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/[0.03] px-3 py-2",children:[a.jsx(yd,{className:"w-4 h-4 text-brand"}),a.jsxs("span",{children:["Previso de retorno: ",a.jsx("strong",{className:"text-white/90",children:aV(d)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/[0.03] px-3 py-2",children:[a.jsx(Vs,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Vamos cuidar de tudo para voc jogar melhor "})]})]})]})]})]}),a.jsx("p",{className:"mt-6 text-center text-white/50 text-sm",children:r?"Modo de manuteno ativo":"Modo de manuteno inativo"})]})]})}function ult(){const[e,t]=p.useState(!0),[r,n]=p.useState(!1),s=()=>{t(d=>!d)},o=Lo(),i=Ri(),l=o.pathname==="/agenda",c=o.pathname==="/isis/analytics";return p.useEffect(()=>{const d=u=>{const f=String(u.target?.tagName||"").toLowerCase();if(!(["input","textarea","select"].includes(f)||u.target?.isContentEditable)&&!u.repeat){if(String(u.key).toLowerCase()==="b"){u.preventDefault();const h=String(o?.pathname||"").toLowerCase();console.log("[Global Hotkey B] Current path:",h),h.includes("balcao")?(console.log("[Global Hotkey B] Navigating to /vendas"),i("/vendas")):(console.log("[Global Hotkey B] Navigating to /balcao"),i("/balcao"));return}if(String(u.key).toLowerCase()==="h"){u.preventDefault(),i("/historico");return}}};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[o,i]),p.useEffect(()=>{try{typeof window<"u"&&window.innerWidth<768&&c&&t(!1)}catch{}},[c]),a.jsx(b2e,{children:a.jsx(m2e,{children:a.jsx(w2e,{children:a.jsxs("div",{className:"relative flex h-screen bg-background text-text-primary",children:[a.jsxs(t1,{children:[a.jsx("title",{children:"F7 Arena"}),a.jsx("meta",{name:"description",content:"Software para gesto de quadras esportivas."})]}),a.jsx(gge,{isVisible:e,setIsVisible:t,sidebarPinned:r}),e&&a.jsx("button",{type:"button",onClick:()=>t(!1),className:"md:hidden fixed inset-0 z-30 bg-black/40","aria-label":"Fechar menu lateral"}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsx(h2e,{onToggleSidebar:s,sidebarVisible:e,sidebarPinned:r}),a.jsx("main",{className:gr("flex-1 overflow-x-hidden overflow-y-auto bg-background",l?"p-0 md:p-8":"p-8"),children:a.jsxs($j,{children:[a.jsx(rs,{path:"/",element:a.jsx(iUe,{})}),a.jsx(rs,{path:"/agenda",element:a.jsx(lZe,{sidebarVisible:e})}),a.jsx(rs,{path:"/isis",element:a.jsx(bY,{children:a.jsx(Bit,{})})}),a.jsx(rs,{path:"/isis/analytics",element:a.jsx(qit,{})}),a.jsx(rs,{path:"/vendas",element:a.jsx(Yat,{})}),a.jsx(rs,{path:"/balcao",element:a.jsx(Jat,{})}),a.jsx(rs,{path:"/produtos",element:a.jsx(_st,{})}),a.jsx(rs,{path:"/compras",element:a.jsx(Cst,{})}),a.jsx(rs,{path:"/clientes",element:a.jsx(Ist,{})}),a.jsx(rs,{path:"/equipe",element:a.jsx(Rst,{})}),a.jsx(rs,{path:"/financeiro",element:a.jsx(jot,{})}),a.jsx(rs,{path:"/caixa",element:a.jsx(PH,{to:"/financeiro?tab=caixa",replace:!0})}),a.jsx(rs,{path:"/quadras",element:a.jsx(Sot,{})}),a.jsx(rs,{path:"/empresas",element:a.jsx(Tot,{})}),a.jsx(rs,{path:"/finalizadoras",element:a.jsx(Mot,{})}),a.jsx(rs,{path:"/configuracao-fiscal",element:a.jsx(Eit,{})}),a.jsx(rs,{path:"/fiscal",element:a.jsx(Fit,{})}),a.jsx(rs,{path:"/test-page",element:a.jsx(Rot,{})}),a.jsx(rs,{path:"/historico",element:a.jsx(Wit,{})}),a.jsx(rs,{path:"/suporte",element:a.jsx(Fst,{})})]})})]})]})})})})}function flt(){Lo();const[e,t]=p.useState(!1),[r,n]=p.useState(!1),s=String({}.VITE_MAINTENANCE_MODE||"").toLowerCase()==="true",o=Se.useMemo(()=>{try{if(typeof window>"u")return null;const c=window.location.host||"",d="f7arena.com";if(!c.endsWith(d))return null;const u=c.slice(0,-d.length).replace(/\.$/,"").toLowerCase();return!u||u==="www"?null:u}catch{return null}},[]);p.useEffect(()=>{try{const c=()=>{const u=localStorage.getItem("maintenance:active")==="true",f=localStorage.getItem("maintenance:end");return u&&f&&new Date>new Date(f)?(localStorage.removeItem("maintenance:active"),!1):u};t(localStorage.getItem("maintenance:bypass")==="1"),n(c());const d=u=>{if(!u||!u.key){n(c()),t(localStorage.getItem("maintenance:bypass")==="1");return}u.key==="maintenance:bypass"&&t(u.newValue==="1"),(u.key==="maintenance:active"||u.key==="maintenance:end")&&n(c())};return window.addEventListener("storage",d),()=>window.removeEventListener("storage",d)}catch{}},[]);const i=!!DS||s||r,l=(()=>{try{const c=localStorage.getItem("maintenance:bypass")==="1",d=(()=>{try{return sessionStorage.getItem("maintenance:bypass")==="1"}catch{return!1}})(),u=(()=>{try{return document.cookie.split(";").some(f=>f.trim()==="fx_maint_bypass=1")}catch{return!1}})();return c||d||u}catch{return!1}})();return i&&!l?a.jsxs($j,{children:[a.jsx(rs,{path:"/maintenance",element:a.jsx(sV,{})}),a.jsx(rs,{path:"*",element:a.jsx(PH,{to:"/maintenance",replace:!0})})]}):o?a.jsx($j,{children:a.jsx(rs,{path:"/*",element:a.jsx(rV,{})})}):a.jsxs($j,{children:[a.jsx(rs,{path:"/reset-password",element:a.jsx($ot,{})}),a.jsx(rs,{path:"/40028922",element:a.jsx(Jit,{})}),a.jsx(rs,{path:"/agendar/:nomeFantasia",element:a.jsx(rV,{})}),a.jsx(rs,{path:"/maintenance",element:a.jsx(sV,{})}),a.jsx(rs,{path:"/backenddeploy",element:a.jsx(Lot,{})}),a.jsx(rs,{path:"/print-comanda",element:a.jsx(B6,{children:a.jsx(Hit,{})})}),a.jsx(rs,{path:"/*",element:a.jsx(B6,{children:a.jsx(ult,{})})})]})}var $R="ToastProvider",[BR,mlt,hlt]=_5("Toast"),[soe,nct]=Ed("Toast",[hlt]),[plt,iA]=soe($R),ooe=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:o=50,children:i}=e,[l,c]=p.useState(null),[d,u]=p.useState(0),f=p.useRef(!1),h=p.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${$R}\`. Expected non-empty \`string\`.`),a.jsx(BR.Provider,{scope:t,children:a.jsx(plt,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:o,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>u(m=>m+1),[]),onToastRemove:p.useCallback(()=>u(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:h,children:i})})};ooe.displayName=$R;var ioe="ToastViewport",glt=["F8"],a3="toast.viewportPause",s3="toast.viewportResume",loe=p.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=glt,label:s="Notifications ({hotkey})",...o}=e,i=iA(ioe,r),l=mlt(r),c=p.useRef(null),d=p.useRef(null),u=p.useRef(null),f=p.useRef(null),h=za(t,f,i.onViewportChange),m=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=i.toastCount>0;p.useEffect(()=>{const y=x=>{n.length!==0&&n.every(w=>x[w]||x.code===w)&&f.current?.focus()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[n]),p.useEffect(()=>{const y=c.current,x=f.current;if(v&&y&&x){const b=()=>{if(!i.isClosePausedRef.current){const C=new CustomEvent(a3);x.dispatchEvent(C),i.isClosePausedRef.current=!0}},w=()=>{if(i.isClosePausedRef.current){const C=new CustomEvent(s3);x.dispatchEvent(C),i.isClosePausedRef.current=!1}},j=C=>{!y.contains(C.relatedTarget)&&w()},_=()=>{y.contains(document.activeElement)||w()};return y.addEventListener("focusin",b),y.addEventListener("focusout",j),y.addEventListener("pointermove",b),y.addEventListener("pointerleave",_),window.addEventListener("blur",b),window.addEventListener("focus",w),()=>{y.removeEventListener("focusin",b),y.removeEventListener("focusout",j),y.removeEventListener("pointermove",b),y.removeEventListener("pointerleave",_),window.removeEventListener("blur",b),window.removeEventListener("focus",w)}}},[v,i.isClosePausedRef]);const g=p.useCallback(({tabbingDirection:y})=>{const b=l().map(w=>{const j=w.ref.current,_=[j,...Elt(j)];return y==="forwards"?_:_.reverse()});return(y==="forwards"?b.reverse():b).flat()},[l]);return p.useEffect(()=>{const y=f.current;if(y){const x=b=>{const w=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!w){const _=document.activeElement,C=b.shiftKey;if(b.target===y&&C){d.current?.focus();return}const A=g({tabbingDirection:C?"backwards":"forwards"}),F=A.findIndex(D=>D===_);rk(A.slice(F+1))?b.preventDefault():C?d.current?.focus():u.current?.focus()}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[l,g]),a.jsxs(Pge,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&a.jsx(o3,{ref:d,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});rk(y)}}),a.jsx(BR.Slot,{scope:r,children:a.jsx(sa.ol,{tabIndex:-1,...o,ref:h})}),v&&a.jsx(o3,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});rk(y)}})]})});loe.displayName=ioe;var coe="ToastFocusProxy",o3=p.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,o=iA(coe,r);return a.jsx(PM,{tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:i=>{const l=i.relatedTarget;!o.viewport?.contains(l)&&n()}})});o3.displayName=coe;var H1="Toast",vlt="toast.swipeStart",xlt="toast.swipeMove",ylt="toast.swipeCancel",blt="toast.swipeEnd",doe=p.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:o,...i}=e,[l,c]=Kf({prop:n,defaultProp:s??!0,onChange:o,caller:H1});return a.jsx(qc,{present:r||l,children:a.jsx(_lt,{open:l,...i,ref:t,onClose:()=>c(!1),onPause:ec(e.onPause),onResume:ec(e.onResume),onSwipeStart:jn(e.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:jn(e.onSwipeMove,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:jn(e.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:jn(e.onSwipeEnd,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});doe.displayName=H1;var[wlt,jlt]=soe(H1,{onClose(){}}),_lt=p.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:o,onClose:i,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:f,onSwipeCancel:h,onSwipeEnd:m,...v}=e,g=iA(H1,r),[y,x]=p.useState(null),b=za(t,M=>x(M)),w=p.useRef(null),j=p.useRef(null),_=s||g.duration,C=p.useRef(0),P=p.useRef(_),E=p.useRef(0),{onToastAdd:A,onToastRemove:F}=g,D=ec(()=>{y?.contains(document.activeElement)&&g.viewport?.focus(),i()}),I=p.useCallback(M=>{!M||M===1/0||(window.clearTimeout(E.current),C.current=new Date().getTime(),E.current=window.setTimeout(D,M))},[D]);p.useEffect(()=>{const M=g.viewport;if(M){const U=()=>{I(P.current),d?.()},z=()=>{const W=new Date().getTime()-C.current;P.current=P.current-W,window.clearTimeout(E.current),c?.()};return M.addEventListener(a3,z),M.addEventListener(s3,U),()=>{M.removeEventListener(a3,z),M.removeEventListener(s3,U)}}},[g.viewport,_,c,d,I]),p.useEffect(()=>{o&&!g.isClosePausedRef.current&&I(_)},[o,_,g.isClosePausedRef,I]),p.useEffect(()=>(A(),()=>F()),[A,F]);const R=p.useMemo(()=>y?voe(y):null,[y]);return g.viewport?a.jsxs(a.Fragment,{children:[R&&a.jsx(Nlt,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:R}),a.jsx(wlt,{scope:r,onClose:D,children:em.createPortal(a.jsx(BR.ItemSlot,{scope:r,children:a.jsx(Age,{asChild:!0,onEscapeKeyDown:jn(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||D(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(sa.li,{tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":g.swipeDirection,...v,ref:b,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:jn(e.onKeyDown,M=>{M.key==="Escape"&&(l?.(M.nativeEvent),M.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:jn(e.onPointerDown,M=>{M.button===0&&(w.current={x:M.clientX,y:M.clientY})}),onPointerMove:jn(e.onPointerMove,M=>{if(!w.current)return;const U=M.clientX-w.current.x,z=M.clientY-w.current.y,W=!!j.current,$=["left","right"].includes(g.swipeDirection),ee=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,ve=$?ee(0,U):0,_e=$?0:ee(0,z),K=M.pointerType==="touch"?10:2,q={x:ve,y:_e},Y={originalEvent:M,delta:q};W?(j.current=q,Cj(xlt,f,Y,{discrete:!1})):oV(q,g.swipeDirection,K)?(j.current=q,Cj(vlt,u,Y,{discrete:!1}),M.target.setPointerCapture(M.pointerId)):(Math.abs(U)>K||Math.abs(z)>K)&&(w.current=null)}),onPointerUp:jn(e.onPointerUp,M=>{const U=j.current,z=M.target;if(z.hasPointerCapture(M.pointerId)&&z.releasePointerCapture(M.pointerId),j.current=null,w.current=null,U){const W=M.currentTarget,$={originalEvent:M,delta:U};oV(U,g.swipeDirection,g.swipeThreshold)?Cj(blt,m,$,{discrete:!0}):Cj(ylt,h,$,{discrete:!0}),W.addEventListener("click",ee=>ee.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),Nlt=e=>{const{__scopeToast:t,children:r,...n}=e,s=iA(H1,t),[o,i]=p.useState(!1),[l,c]=p.useState(!1);return Alt(()=>i(!0)),p.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:a.jsx(h0,{asChild:!0,children:a.jsx(PM,{...n,children:o&&a.jsxs(a.Fragment,{children:[s.label," ",r]})})})},Slt="ToastTitle",uoe=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return a.jsx(sa.div,{...n,ref:t})});uoe.displayName=Slt;var Clt="ToastDescription",foe=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return a.jsx(sa.div,{...n,ref:t})});foe.displayName=Clt;var moe="ToastAction",hoe=p.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?a.jsx(goe,{altText:r,asChild:!0,children:a.jsx(qR,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${moe}\`. Expected non-empty \`string\`.`),null)});hoe.displayName=moe;var poe="ToastClose",qR=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=jlt(poe,r);return a.jsx(goe,{asChild:!0,children:a.jsx(sa.button,{type:"button",...n,ref:t,onClick:jn(e.onClick,s.onClose)})})});qR.displayName=poe;var goe=p.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return a.jsx(sa.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function voe(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),Plt(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",o=n.dataset.radixToastAnnounceExclude==="";if(!s)if(o){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...voe(n))}}),t}function Cj(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?L4(s,o):s.dispatchEvent(o)}var oV=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),o=n>s;return t==="left"||t==="right"?o&&n>r:!o&&s>r};function Alt(e=()=>{}){const t=ec(e);Mi(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function Plt(e){return e.nodeType===e.ELEMENT_NODE}function Elt(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function rk(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var klt=ooe,xoe=loe,yoe=doe,boe=uoe,woe=foe,joe=hoe,_oe=qR;const Ilt=klt,Noe=Se.forwardRef(({className:e,...t},r)=>a.jsx(xoe,{ref:r,className:gr("fixed z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Noe.displayName=xoe.displayName;const Olt=R4("group relative pointer-events-auto flex w-full items-start justify-between gap-4 overflow-hidden rounded-lg border p-4 pr-8 shadow-xl transition-all data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-warning text-black border-warning",destructive:"bg-danger text-white border-danger",success:"bg-success text-white border-success",info:"bg-info text-black border-info",warning:"bg-warning text-black border-warning"}},defaultVariants:{variant:"default"}}),Soe=Se.forwardRef(({className:e,variant:t,...r},n)=>a.jsx(yoe,{ref:n,className:gr(Olt({variant:t}),e),...r}));Soe.displayName=yoe.displayName;const Tlt=Se.forwardRef(({className:e,...t},r)=>a.jsx(joe,{ref:r,className:gr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));Tlt.displayName=joe.displayName;const Coe=Se.forwardRef(({className:e,...t},r)=>a.jsx(_oe,{ref:r,className:gr("absolute right-2 top-2 rounded-md p-1 text-white/80 transition-opacity hover:text-white focus:outline-none focus:ring-2 focus:ring-white/50 group-[.default]:text-black/70 group-[.default]:hover:text-black",e),...t,children:a.jsx(el,{className:"h-4 w-4"})}));Coe.displayName=_oe.displayName;const Aoe=Se.forwardRef(({className:e,...t},r)=>a.jsx(boe,{ref:r,className:gr("text-sm font-semibold",e),...t}));Aoe.displayName=boe.displayName;const Poe=Se.forwardRef(({className:e,...t},r)=>a.jsx(woe,{ref:r,className:gr("text-sm",e),...t}));Poe.displayName=woe.displayName;function Dlt(){const{toasts:e}=as();return a.jsxs(Ilt,{children:[e.map(({id:t,title:r,description:n,action:s,dismiss:o,...i})=>a.jsxs(Soe,{...i,children:[a.jsxs("div",{className:"grid gap-1",children:[r&&a.jsx(Aoe,{children:r}),n&&a.jsx(Poe,{children:n})]}),s,a.jsx(Coe,{onClick:o})]},t)),a.jsx(Noe,{})]})}function Mlt(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(e=>{setInterval(()=>{e.update()},6e4),e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&window.confirm("Nova verso disponvel! Deseja atualizar agora?")&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload())})})}).catch(e=>{console.error("[SW] Erro ao registrar Service Worker:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})})}Mlt();window.screen?.orientation?.lock&&window.screen.orientation.lock("portrait").catch(e=>{console.log("[Orientation] Lock no suportado ou j bloqueado:",e.message)});window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),window.__installPrompt=e},{passive:!1});window.addEventListener("appinstalled",()=>{window.__installPrompt=null});nk.createRoot(document.getElementById("root")).render(a.jsx(Ide,{children:a.jsxs(mwe,{children:[a.jsx(flt,{}),a.jsx(Dlt,{})]})}));export{Y1e as _,Qi as c,Ga as g};
